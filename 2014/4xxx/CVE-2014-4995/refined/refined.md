Based on the provided content, here's an analysis of CVE-2014-4995:

**Root Cause of Vulnerability:**

The vulnerability stems from the way the `VladTheEnterprising` Ruby gem handles temporary MySQL configuration files. Specifically, the gem creates a temporary file named `/tmp/my.cnf.#{target_host}` to store MySQL root credentials. This filename is predictable and based on the provided `target_host`. The gem does not properly sanitize the `target_host` input before using it in the file path.

**Weaknesses/Vulnerabilities Present:**

1.  **Insecure Temporary File Creation:** The gem writes MySQL root credentials (host, user, and password) to a temporary file with a predictable name based on the user-supplied target\_host. This file is created in the world-readable `/tmp` directory.
2.  **Race Condition:** A local user can read the contents of `/tmp/my.cnf.#{target_host}` if they access the file between the time it's written and the time it's deleted.
3.  **Symlink Attack:** Because the filename is predictable and not randomly generated, a local attacker can create a symlink with the same name pointing to a file they control before the legitimate temporary file is created. When the gem attempts to write the file, it will write to the attacker's controlled location instead. This allows them to clobber files owned by the gem's user process.
4.  **Command Injection:** If the gem is used in a context (e.g., a Rails application) where a user can influence the `target_host`, they could inject shell meta-characters into the filename. Because the gem executes `rm /tmp/my.cnf.#{target_host}` via backticks ``, the injected characters can lead to arbitrary command execution.

**Impact of Exploitation:**

*   **Information Disclosure:** A local attacker can gain access to MySQL root credentials, potentially leading to unauthorized database access.
*   **Arbitrary File Clobbering:** An attacker can overwrite files owned by the gem's user process, potentially disrupting service or escalating privileges.
*   **Command Execution:** In certain use cases, an attacker may be able to execute arbitrary code on the server, potentially taking full control.

**Attack Vectors:**

*   **Local Access:** A local user can exploit the race condition or symlink vulnerability to read the credentials or overwrite files.
*   **Remote Access (Conditional):** If the gem is used in a context where a user-supplied `target_host` is possible (e.g. Rails application with user provided input), a remote attacker could achieve command injection.

**Required Attacker Capabilities/Position:**

*   **Local User:** A local user on the system where the gem is executed can exploit the race condition, the symlink attack, or the command injection if they can influence target\_host.
*   **Remote User (Conditional):** In scenarios where the gem is used in a web app where target\_host can be influenced through user input, a remote user could potentially perform command injection.

**Additional Details:**

*   The issue is in `VladTheEnterprising-0.2/lib/vlad/dba/mysql.rb`, specifically around line 394.
*   The `target_host` variable is used to form the temporary file name.
*   The advisory includes an OSVDB identifier (108728)

The provided information gives a more detailed explanation of the vulnerability and its attack vectors than the standard CVE description.