=== Content from github.com_f601a974_20250126_002816.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fansible%2Fansible%2Fcommit%2F62a1295a3e08cb6c3e9f1b2a1e6e5dcaeab32527)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fansible%2Fansible%2Fcommit%2F62a1295a3e08cb6c3e9f1b2a1e6e5dcaeab32527)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ansible%2Fansible)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ansible](/ansible)
/
**[ansible](/ansible/ansible)**
Public

* [Notifications](/login?return_to=%2Fansible%2Fansible) You must be signed in to change notification settings
* [Fork
  24k](/login?return_to=%2Fansible%2Fansible)
* [Star
   63.8k](/login?return_to=%2Fansible%2Fansible)

* [Code](/ansible/ansible)
* [Issues
  541](/ansible/ansible/issues)
* [Pull requests
  330](/ansible/ansible/pulls)
* [Projects
  6](/ansible/ansible/projects)
* [Security](/ansible/ansible/security)
* [Insights](/ansible/ansible/pulse)

Additional navigation options

* [Code](/ansible/ansible)
* [Issues](/ansible/ansible/issues)
* [Pull requests](/ansible/ansible/pulls)
* [Projects](/ansible/ansible/projects)
* [Security](/ansible/ansible/security)
* [Insights](/ansible/ansible/pulse)

## Commit

[Permalink](/ansible/ansible/commit/62a1295a3e08cb6c3e9f1b2a1e6e5dcaeab32527)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Security fixes:

[Browse files](/ansible/ansible/tree/62a1295a3e08cb6c3e9f1b2a1e6e5dcaeab32527)
Browse the repository at this point in the history

```
* Strip lookup calls out of inventory variables and clean unsafe data
  returned from lookup plugins ([CVE-2014-4966](https://github.com/advisories/GHSA-wqq5-c89p-3wc3 "CVE-2014-4966"))
* Make sure vars don't insert extra parameters into module args and prevent
  duplicate params from superseding previous params ([CVE-2014-4967](https://github.com/advisories/GHSA-64cw-m57j-65xj "CVE-2014-4967"))
```

* Loading branch information

[![@jimi-c](https://avatars.githubusercontent.com/u/26403?s=40&v=4)](/jimi-c)

[jimi-c](/ansible/ansible/commits?author=jimi-c "View all commits by jimi-c")
committed
Jul 21, 2014

1 parent
[69d85c2](/ansible/ansible/commit/69d85c22c7475ccf8169b6ec9dee3ee28c92a314)

commit 62a1295

 Show file tree

 Hide file tree

Showing
**8 changed files**
with
**178 additions**
and
**65 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib/ansible

  + module\_utils

    - lib/ansible/module\_utils/basic.py
      [basic.py](#diff-f349dd7dd94c979d979664b11f27222e562b7444ec38407a4a511614fc5248ed)
  + runner

    - lib/ansible/runner/\_\_init\_\_.py
      [\_\_init\_\_.py](#diff-47214fb32133fcbf989bc10f0d201d8f31619564dfcf680a0f6ebae716bd10aa)
    - action\_plugins

      * lib/ansible/runner/action\_plugins/assemble.py
        [assemble.py](#diff-1b49fa0d334311da909b9b3b7e7b3298453000d0a0db8ca832543a1c34c0a3ef)
      * lib/ansible/runner/action\_plugins/copy.py
        [copy.py](#diff-6e80f9320964906e91f624416f7a455b5d56954cd760cf9035e1df1ca1bfdbe5)
      * lib/ansible/runner/action\_plugins/template.py
        [template.py](#diff-eeae41f3d7184f0d8a126b290bfd4fe3e16cd8cc16fd14331b6e6ef92a7e7828)
  + utils

    - lib/ansible/utils/\_\_init\_\_.py
      [\_\_init\_\_.py](#diff-f74cf7ef0d2258d4f078bee1a61459de40806bfd26c068615ac50392c46f8879)
* library/commands

  + library/commands/command
    [command](#diff-c2ad7e9c8bd010a1fbaf6037bf6d81af90ff2fd62e21d656a38ced6350b0694a)
* test/integration/roles/test\_iterators/tasks

  + test/integration/roles/test\_iterators/tasks/main.yml
    [main.yml](#diff-1a647c3832fc8bbf28843e508889cc17b323d79f00b4cdc25cbaff7462d35189)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[lib/ansible/module\_utils/basic.py](#diff-f349dd7dd94c979d979664b11f27222e562b7444ec38407a4a511614fc5248ed "lib/ansible/module_utils/basic.py")

Show comments

[View file](/ansible/ansible/blob/62a1295a3e08cb6c3e9f1b2a1e6e5dcaeab32527/lib/ansible/module_utils/basic.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -772,6 +772,8 @@ def \_load\_params(self): |
|  |  | (k, v) = x.split("=",1) |
|  |  | except Exception, e: |
|  |  | self.fail\_json(msg="this module requires key=value arguments (%s)" % (items)) |
|  |  | if k in params: |
|  |  | self.fail\_json(msg="duplicate parameter: %s (value=%s)" % (k, v)) |
|  |  | params[k] = v |
|  |  | params2 = json.loads(MODULE\_COMPLEX\_ARGS) |
|  |  | params2.update(params) |
| Expand Down | |  |

46 changes: 46 additions & 0 deletions

46
[lib/ansible/runner/\_\_init\_\_.py](#diff-47214fb32133fcbf989bc10f0d201d8f31619564dfcf680a0f6ebae716bd10aa "lib/ansible/runner/__init__.py")

Show comments

[View file](/ansible/ansible/blob/62a1295a3e08cb6c3e9f1b2a1e6e5dcaeab32527/lib/ansible/runner/__init__.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,6 +31,7 @@ |
|  |  | import pipes |
|  |  | import jinja2 |
|  |  | import subprocess |
|  |  | import shlex |
|  |  | import getpass |
|  |  |  |
|  |  | import ansible.constants as C |
| Expand Down  Expand Up | | @@ -394,6 +395,35 @@ def \_compute\_delegate\_user(self, host, inject): |
|  |  |  |
|  |  | return actual\_user |
|  |  |  |
|  |  | def \_count\_module\_args(self, args): |
|  |  | ''' |
|  |  | Count the number of k=v pairs in the supplied module args. This is |
|  |  | basically a specialized version of parse\_kv() from utils with a few |
|  |  | minor changes. |
|  |  | ''' |
|  |  | options = {} |
|  |  | if args is not None: |
|  |  | args = args.encode('utf-8') |
|  |  | try: |
|  |  | lexer = shlex.shlex(args, posix=True) |
|  |  | lexer.whitespace\_split = True |
|  |  | lexer.quotes = '"' |
|  |  | lexer.ignore\_quotes = "'" |
|  |  | vargs = list(lexer) |
|  |  | except ValueError, ve: |
|  |  | if 'no closing quotation' in str(ve).lower(): |
|  |  | raise errors.AnsibleError("error parsing argument string '%s', try quoting the entire line." % args) |
|  |  | else: |
|  |  | raise |
|  |  | vargs = [x.decode('utf-8') for x in vargs] |
|  |  | for x in vargs: |
|  |  | if "=" in x: |
|  |  | k, v = x.split("=",1) |
|  |  | if k in options: |
|  |  | raise errors.AnsibleError("a duplicate parameter was found in the argument string (%s)" % k) |
|  |  | options[k] = v |
|  |  | return len(options) |
|  |  |  |
|  |  |  |
|  |  | # \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  |  |
| Expand Down  Expand Up | | @@ -612,6 +642,9 @@ def \_executor\_internal(self, host, new\_stdin): |
|  |  | items\_terms = self.module\_vars.get('items\_lookup\_terms', '') |
|  |  | items\_terms = template.template(basedir, items\_terms, inject) |
|  |  | items = utils.plugins.lookup\_loader.get(items\_plugin, runner=self, basedir=basedir).run(items\_terms, inject=inject) |
|  |  | # strip out any jinja2 template syntax within |
|  |  | # the data returned by the lookup plugin |
|  |  | items = utils.\_clean\_data\_struct(items, from\_remote=True) |
|  |  | if type(items) != list: |
|  |  | raise errors.AnsibleError("lookup plugins have to return a list: %r" % items) |
|  |  |  |
| Expand Down  Expand Up | | @@ -823,7 +856,20 @@ def \_executor\_internal\_inner(self, host, module\_name, module\_args, inject, port, |
|  |  |  |
|  |  | # render module\_args and complex\_args templates |
|  |  | try: |
|  |  | # When templating module\_args, we need to be careful to ensure |
|  |  | # that no variables inadvertantly (or maliciously) add params |
|  |  | # to the list of args. We do this by counting the number of k=v |
|  |  | # pairs before and after templating. |
|  |  | num\_args\_pre = self.\_count\_module\_args(module\_args) |
|  |  | module\_args = template.template(self.basedir, module\_args, inject, fail\_on\_undefined=self.error\_on\_undefined\_vars) |
|  |  | num\_args\_post = self.\_count\_module\_args(module\_args) |
|  |  | if num\_args\_pre != num\_args\_post: |
|  |  | raise errors.AnsibleError("A variable inserted a new parameter into the module args. " + \ |
|  |  | "Be sure to quote variables if they contain equal signs (for example: \"{{var}}\").") |
|  |  | # And we also make sure nothing added in special flags for things |
|  |  | # like the command/shell module (ie. #USE\_SHELL) |
|  |  | if '#USE\_SHELL' in module\_args: |
|  |  | raise errors.AnsibleError("A variable tried to add #USE\_SHELL to the module arguments.") |
|  |  | complex\_args = template.template(self.basedir, complex\_args, inject, fail\_on\_undefined=self.error\_on\_undefined\_vars) |
|  |  | except jinja2.exceptions.UndefinedError, e: |
|  |  | raise errors.AnsibleUndefinedVariable("One or more undefined variables: %s" % str(e)) |
| Expand Down | |  |

19 changes: 15 additions & 4 deletions

19
[lib/ansible/runner/action\_plugins/assemble.py](#diff-1b49fa0d334311da909b9b3b7e7b3298453000d0a0db8ca832543a1c34c0a3ef "lib/ansible/runner/action_plugins/assemble.py")

Show comments

[View file](/ansible/ansible/blob/62a1295a3e08cb6c3e9f1b2a1e6e5dcaeab32527/lib/ansible/runner/action_plugins/assemble.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -122,14 +122,25 @@ def run(self, conn, tmp, module\_name, module\_args, inject, complex\_args=None, \*\* |
|  |  | self.runner.\_low\_level\_exec\_command(conn, "chmod a+r %s" % xfered, tmp) |
|  |  |  |
|  |  | # run the copy module |
|  |  | module\_args = "%s src=%s dest=%s original\_basename=%s" % (module\_args, pipes.quote(xfered), pipes.quote(dest), pipes.quote(os.path.basename(src))) |
|  |  | new\_module\_args = dict( |
|  |  | src=xfered, |
|  |  | dest=dest, |
|  |  | original\_basename=os.path.basename(src), |
|  |  | ) |
|  |  | module\_args\_tmp = utils.merge\_module\_args(module\_args, new\_module\_args) |
|  |  |  |
|  |  | if self.runner.noop\_on\_check(inject): |
|  |  | return ReturnData(conn=conn, comm\_ok=True, result=dict(changed=True), diff=dict(before\_header=dest, after\_header=src, after=resultant)) |
|  |  | else: |
|  |  | res = self.runner.\_execute\_module(conn, tmp, 'copy', module\_args, inject=inject) |
|  |  | res = self.runner.\_execute\_module(conn, tmp, 'copy', module\_args\_tmp, inject=inject) |
|  |  | res.diff = dict(after=resultant) |
|  |  | return res |
|  |  | else: |
|  |  | module\_args = "%s src=%s dest=%s original\_basename=%s" % (module\_args, pipes.quote(xfered), pipes.quote(dest), pipes.quote(os.path.basename(src))) |
|  |  | return self.runner.\_execute\_module(conn, tmp, 'file', module\_args, inject=inject) |
|  |  | new\_module\_args = dict( |
|  |  | src=xfered, |
|  |  | dest=dest, |
|  |  | original\_basename=os.path.basename(src), |
|  |  | ) |
|  |  | module\_args\_tmp = utils.merge\_module\_args(module\_args, new\_module\_args) |
|  |  |  |
|  |  | return self.runner.\_execute\_module(conn, tmp, 'file', module\_args\_tmp, inject=inject) |

23 changes: 16 additions & 7 deletions

23
[lib/ansible/runner/action\_plugins/copy.py](#diff-6e80f9320964906e91f624416f7a455b5d56954cd760cf9035e1df1ca1bfdbe5 "lib/ansible/runner/action_plugins/copy.py")

Show comments

[View file](/ansible/ansible/blob/62a1295a3e08cb6c3e9f1b2a1e6e5dcaeab32527/lib/ansible/runner/action_plugins/copy.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -238,11 +238,16 @@ def run(self, conn, tmp\_path, module\_name, module\_args, inject, complex\_args=Non |
|  |  |  |
|  |  | # src and dest here come after original and override them |
|  |  | # we pass dest only to make sure it includes trailing slash in case of recursive copy |
|  |  | module\_args\_tmp = "%s src=%s dest=%s original\_basename=%s" % (module\_args, |
|  |  | pipes.quote(tmp\_src), pipes.quote(dest), pipes.quote(source\_rel)) |
|  |  | new\_module\_args = dict( |
|  |  | src=tmp\_src, |
|  |  | dest=dest, |
|  |  | original\_basename=source\_rel |
|  |  | ) |
|  |  |  |
|  |  | if self.runner.no\_log: |
|  |  | module\_args\_tmp = "%s NO\_LOG=True" % module\_args\_tmp |
|  |  | new\_module\_args['NO\_LOG'] = True |
|  |  |  |
|  |  | module\_args\_tmp = utils.merge\_module\_args(module\_args, new\_module\_args) |
|  |  |  |
|  |  | module\_return = self.runner.\_execute\_module(conn, tmp\_path, 'copy', module\_args\_tmp, inject=inject, complex\_args=complex\_args, delete\_remote\_tmp=delete\_remote\_tmp) |
|  |  | module\_executed = True |
| Expand All | | @@ -260,12 +265,16 @@ def run(self, conn, tmp\_path, module\_name, module\_args, inject, complex\_args=Non |
|  |  | tmp\_src = tmp\_path + source\_rel |
|  |  |  |
|  |  | # Build temporary module\_args. |
|  |  | module\_args\_tmp = "%s src=%s original\_basename=%s" % (module\_args, |
|  |  | pipes.quote(tmp\_src), pipes.quote(source\_rel)) |
|  |  | new\_module\_args = dict( |
|  |  | src=tmp\_src, |
|  |  | dest=dest, |
|  |  | ) |
|  |  | if self.runner.noop\_on\_check(inject): |
|  |  | module\_args\_tmp = "%s CHECKMODE=True" % module\_args\_tmp |
|  |  | new\_module\_args['CHECKMODE'] = True |
|  |  | if self.runner.no\_log: |
|  |  | module\_args\_tmp = "%s NO\_LOG=True" % module\_args\_tmp |
|  |  | new\_module\_args['NO\_LOG'] = True |
|  |  |  |
|  |  | module\_args\_tmp = utils.merge\_module\_args(module\_args, new\_module\_args) |
|  |  |  |
|  |  | # Execute the file module. |
|  |  | module\_return = self.runner.\_execute\_module(conn, tmp\_path, 'file', module\_args\_tmp, inject=inject, complex\_args=complex\_args, delete\_remote\_tmp=delete\_remote\_tmp) |
| Expand Down | |  |

9 changes: 7 additions & 2 deletions

9
[lib/ansible/runner/action\_plugins/template.py](#diff-eeae41f3d7184f0d8a126b290bfd4fe3e16cd8cc16fd14331b6e6ef92a7e7828 "lib/ansible/runner/action_plugins/template.py")

Show comments

[View file](/ansible/ansible/blob/62a1295a3e08cb6c3e9f1b2a1e6e5dcaeab32527/lib/ansible/runner/action_plugins/template.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -117,12 +117,17 @@ def run(self, conn, tmp, module\_name, module\_args, inject, complex\_args=None, \*\* |
|  |  | self.runner.\_low\_level\_exec\_command(conn, "chmod a+r %s" % xfered, tmp) |
|  |  |  |
|  |  | # run the copy module |
|  |  | module\_args = "%s src=%s dest=%s original\_basename=%s" % (module\_args, pipes.quote(xfered), pipes.quote(dest), pipes.quote(os.path.basename(source))) |
|  |  | new\_module\_args = dict( |
|  |  | src=xfered, |
|  |  | dest=dest, |
|  |  | original\_basename=os.path.basename(source), |
|  |  | ) |
|  |  | module\_args\_tmp = utils.merge\_module\_args(module\_args, new\_module\_args) |
|  |  |  |
|  |  | if self.runner.noop\_on\_check(inject): |
|  |  | return ReturnData(conn=conn, comm\_ok=True, result=dict(changed=True), diff=dict(before\_header=dest, after\_header=source, before=dest\_contents, after=resultant)) |
|  |  | else: |
|  |  | res = self.runner.\_execute\_module(conn, tmp, 'copy', module\_args, inject=inject, complex\_args=complex\_args) |
|  |  | res = self.runner.\_execute\_module(conn, tmp, 'copy', module\_args\_tmp, inject=inject, complex\_args=complex\_args) |
|  |  | if res.result.get('changed', False): |
|  |  | res.diff = dict(before=dest\_contents, after=resultant) |
|  |  | return res |
| Expand Down | |  |

62 changes: 48 additions & 14 deletions

62
[lib/ansible/utils/\_\_init\_\_.py](#diff-f74cf7ef0d2258d4f078bee1a61459de40806bfd26c068615ac50392c46f8879 "lib/ansible/utils/__init__.py")

Show comments

[View file](/ansible/ansible/blob/62a1295a3e08cb6c3e9f1b2a1e6e5dcaeab32527/lib/ansible/utils/__init__.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -51,6 +51,10 @@ |
|  |  |  |
|  |  | MAX\_FILE\_SIZE\_FOR\_DIFF=1\*1024\*1024 |
|  |  |  |
|  |  | # caching the compilation of the regex used |
|  |  | # to check for lookup calls within data |
|  |  | LOOKUP\_REGEX=re.compile(r'lookup\s\*\(') |
|  |  |  |
|  |  | try: |
|  |  | import json |
|  |  | except ImportError: |
| Expand Down  Expand Up | | @@ -313,38 +317,44 @@ def json\_loads(data): |
|  |  |  |
|  |  | return json.loads(data) |
|  |  |  |
|  |  | def \_clean\_data(orig\_data): |
|  |  | def \_clean\_data(orig\_data, from\_remote=False, from\_inventory=False): |
|  |  | ''' remove template tags from a string ''' |
|  |  | data = orig\_data |
|  |  | if isinstance(orig\_data, basestring): |
|  |  | for pattern,replacement in (('{{','{#'), ('}}','#}'), ('{%','{#'), ('%}','#}')): |
|  |  | sub\_list = [('{%','{#'), ('%}','#}')] |
|  |  | if from\_remote or (from\_inventory and '{{' in data and LOOKUP\_REGEX.search(data)): |
|  |  | # if from a remote, we completely disable any jinja2 blocks |
|  |  | sub\_list.extend([('{{','{#'), ('}}','#}')]) |
|  |  | for pattern,replacement in sub\_list: |
|  |  | data = data.replace(pattern, replacement) |
|  |  | return data |
|  |  |  |
|  |  | def \_clean\_data\_struct(orig\_data): |
|  |  | def \_clean\_data\_struct(orig\_data, from\_remote=False, from\_inventory=False): |
|  |  | ''' |
|  |  | walk a complex data structure, and use \_clean\_data() to |
|  |  | remove any template tags that may exist |
|  |  | ''' |
|  |  | if not from\_remote and not from\_inventory: |
|  |  | raise errors.AnsibleErrors("when cleaning data, you must specify either from\_remote or from\_inventory") |
|  |  | if isinstance(orig\_data, dict): |
|  |  | data = orig\_data.copy() |
|  |  | for key in data: |
|  |  | new\_key = \_clean\_data\_struct(key) |
|  |  | new\_val = \_clean\_data\_struct(data[key]) |
|  |  | new\_key = \_clean\_data\_struct(key, from\_remote, from\_inventory) |
|  |  | new\_val = \_clean\_data\_struct(data[key], from\_remote, from\_inventory) |
|  |  | if key != new\_key: |
|  |  | del data[key] |
|  |  | data[new\_key] = new\_val |
|  |  | elif isinstance(orig\_data, list): |
|  |  | data = orig\_data[:] |
|  |  | for i in range(0, len(data)): |
|  |  | data[i] = \_clean\_data\_struct(data[i]) |
|  |  | data[i] = \_clean\_data\_struct(data[i], from\_remote, from\_inventory) |
|  |  | elif isinstance(orig\_data, basestring): |
|  |  | data = \_clean\_data(orig\_data) |
|  |  | data = \_clean\_data(orig\_data, from\_remote, from\_inventory) |
|  |  | else: |
|  |  | data = orig\_data |
|  |  | return data |
|  |  |  |
|  |  | def parse\_json(raw\_data, from\_remote=False): |
|  |  | def parse\_json(raw\_data, from\_remote=False, from\_inventory=False): |
|  |  | ''' this version for module return data only ''' |
|  |  |  |
|  |  | orig\_data = raw\_data |
| Expand Down  Expand Up | | @@ -379,10 +389,31 @@ def parse\_json(raw\_data, from\_remote=False): |
|  |  | return { "failed" : True, "parsed" : False, "msg" : orig\_data } |
|  |  |  |
|  |  | if from\_remote: |
|  |  | results = \_clean\_data\_struct(results) |
|  |  | results = \_clean\_data\_struct(results, from\_remote, from\_inventory) |
|  |  |  |
|  |  | return results |
|  |  |  |
|  |  | def merge\_module\_args(current\_args, new\_args): |
|  |  | ''' |
|  |  | merges either a dictionary or string of k=v pairs with another string of k=v pairs, |
|  |  | and returns a new k=v string without duplicates. |
|  |  | ''' |
|  |  | if not isinstance(current\_args, basestring): |
|  |  | raise errors.AnsibleError("expected current\_args to be a basestring") |
|  |  | # we use parse\_kv to split up the current args into a dictionary |
|  |  | final\_args = parse\_kv(current\_args) |
|  |  | if isinstance(new\_args, dict): |
|  |  | final\_args.update(new\_args) |
|  |  | elif isinstance(new\_args, basestring): |
|  |  | new\_args\_kv = parse\_kv(new\_args) |
|  |  | final\_args.update(new\_args\_kv) |
|  |  | # then we re-assemble into a string |
|  |  | module\_args = "" |
|  |  | for (k,v) in final\_args.iteritems(): |
|  |  | if isinstance(v, basestring): |
|  |  | module\_args = "%s=%s %s" % (k, pipes.quote(v), module\_args) |
|  |  | return module\_args.strip() |
|  |  |  |
|  |  | def smush\_braces(data): |
|  |  | ''' smush Jinaj2 braces so unresolved templates like {{ foo }} don't get parsed weird by key=value code ''' |
|  |  | while '{{ ' in data: |
| Expand Down  Expand Up | | @@ -615,7 +646,7 @@ def parse\_kv(args): |
|  |  | for x in vargs: |
|  |  | if "=" in x: |
|  |  | k, v = x.split("=",1) |
|  |  | options[k]=v |
|  |  | options[k] = v |
|  |  | return options |
|  |  |  |
|  |  | def merge\_hash(a, b): |
| Expand Down  Expand Up | | @@ -1062,11 +1093,14 @@ def list\_intersection(a, b): |
|  |  |  |
|  |  | def safe\_eval(expr, locals={}, include\_exceptions=False): |
|  |  | ''' |
|  |  | this is intended for allowing things like: |
|  |  | This is intended for allowing things like: |
|  |  | with\_items: a\_list\_variable |
|  |  | where Jinja2 would return a string |
|  |  | but we do not want to allow it to call functions (outside of Jinja2, where |
|  |  | the env is constrained) |
|  |  |  |
|  |  | Where Jinja2 would return a string but we do not want to allow it to |
|  |  | call functions (outside of Jinja2, where the env is constrained). If |
|  |  | the input data to this function came from an untrusted (remote) source, |
|  |  | it should first be run through \_clean\_data\_struct() to ensure the data |
|  |  | is further sanitized prior to evaluation. |
|  |  |  |
|  |  | Based on: |
|  |  | http://stackoverflow.com/questions/12523516/using-ast-and-whitelists-to-make-pythons-eval-safe |
| Expand Down | |  |

61 changes: 34 additions & 27 deletions

61
[library/commands/command](#diff-c2ad7e9c8bd010a1fbaf6037bf6d81af90ff2fd62e21d656a38ced6350b0694a "library/commands/command")

Show comments

[View file](/ansible/ansible/blob/62a1295a3e08cb6c3e9f1b2a1e6e5dcaeab32527/library/commands/command)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -176,38 +176,45 @@ class CommandModule(AnsibleModule): |
|  |  | ''' read the input and return a dictionary and the arguments string ''' |
|  |  | args = MODULE\_ARGS |
|  |  | params = {} |
|  |  | params['chdir'] = None |
|  |  | params['creates'] = None |
|  |  | params['removes'] = None |
|  |  | params['shell'] = False |
|  |  | params['chdir']  = None |
|  |  | params['creates']  = None |
|  |  | params['removes']  = None |
|  |  | params['shell']  = False |
|  |  | params['executable'] = None |
|  |  | if "#USE\_SHELL" in args: |
|  |  | args = args.replace("#USE\_SHELL", "") |
|  |  | params['shell'] = True |
|  |  |  |
|  |  | r = re.compile(r'(^|\s)(creates|removes|chdir|executable|NO\_LOG)=(?P<quote>[\'"])?(.\*?)(?(quote)(?<!\\)(?P=quote))((?<!\\)(?=\s)|$)') |
|  |  | for m in r.finditer(args): |
|  |  | v = m.group(4).replace("\\", "") |
|  |  | if m.group(2) == "creates": |
|  |  | params['creates'] = v |
|  |  | elif m.group(2) == "removes": |
|  |  | params['removes'] = v |
|  |  | elif m.group(2) == "chdir": |
|  |  | v = os.path.expanduser(v) |
|  |  | v = os.path.abspath(v) |
|  |  | if not (os.path.exists(v) and os.path.isdir(v)): |
|  |  | self.fail\_json(rc=258, msg="cannot change to directory '%s': path does not exist" % v) |
|  |  | params['chdir'] = v |
|  |  | elif m.group(2) == "executable": |
|  |  | v = os.path.expanduser(v) |
|  |  | v = os.path.abspath(v) |
|  |  | if not (os.path.exists(v)): |
|  |  | self.fail\_json(rc=258, msg="cannot use executable '%s': file does not exist" % v) |
|  |  | params['executable'] = v |
|  |  | elif m.group(2) == "NO\_LOG": |
|  |  | params['NO\_LOG'] = self.boolean(v) |
|  |  | args = r.sub("", args) |
|  |  | params['args'] = args |
|  |  | # use shlex to split up the args, while being careful to preserve |
|  |  | # single quotes so they're not removed accidentally |
|  |  | lexer = shlex.shlex(args, posix=True) |
|  |  | lexer.whitespace\_split = True |
|  |  | lexer.quotes = '"' |
|  |  | lexer.ignore\_quotes = "'" |
|  |  | items = list(lexer) |
|  |  |  |
|  |  | command\_args = '' |
|  |  | for x in items: |
|  |  | if '=' in x: |
|  |  | # check to see if this is a special parameter for the command |
|  |  | k, v = x.split('=', 1) |
|  |  | if k in ('creates', 'removes', 'chdir', 'executable', 'NO\_LOG'): |
|  |  | if k == "chdir": |
|  |  | v = os.path.abspath(os.path.expanduser(v)) |
|  |  | if not (os.path.exists(v) and os.path.isdir(v)): |
|  |  | self.fail\_json(rc=258, msg="cannot change to directory '%s': path does not exist" % v) |
|  |  | elif k == "executable": |
|  |  | v = os.path.abspath(os.path.expanduser(v)) |
|  |  | if not (os.path.exists(v)): |
|  |  | self.fail\_json(rc=258, msg="cannot use executable '%s': file does not exist" % v) |
|  |  | params[k] = v |
|  |  | else: |
|  |  | # this isn't a valid parameter, so just append it back to the list of arguments |
|  |  | command\_args = "%s %s" % (command\_args, x) |
|  |  | else: |
|  |  | # not a param, so just append it to the list of arguments |
|  |  | command\_args = "%s %s" % (command\_args, x) |
|  |  | params['args'] = command\_args.strip() |
|  |  | return (params, params['args']) |
|  |  |  |
|  |  | main() |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `62a1295`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fansible%2Fansible%2Fcommit%2F62a1295a3e08cb6c3e9f1b2a1e6e5dcaeab32527) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.ocert.org_f4dced33_20250126_002811.html ===


**oCERT-2014-004 Ansible input sanitization errors**

**Description**:

The [Ansible](http://www.ansible.com) project is an
open source configuration management platform.

The Ansible platform suffers from input sanitization errors that allow
arbitrary code execution as well as information leak, in case an attacker is
able to control certain playbook variables.

The first vulnerability involves the escalation of a local permission
access level into arbitrary code execution. The code execution can be triggered
by interpolation of file names maliciously crafted as lookup plugin commands,
in combination with its pipe feature.

The second vulnerability concerns the unsafe parsing of action arguments
in the face of an attacker controlling variable data (whether fact data,
with\_fileglob data, or other sources), allowing an attacker to supply their own
options to an action. The impact of this is dependent on the action module the
attacker targets. For example, an attacker controlling variables passed to the
copy or template actions would be able to trigger arbitrary code execution (in
addition to simple information leakage) via the validate option's acceptance of
arbitrary shell code.

**Affected version**:

[Ansible](http://www.ansible.com) <= 1.6.6

**Fixed version**:

[Ansible](http://www.ansible.com) >= 1.6.7

**Credit**: vulnerability report received from Brian Harring <ferringb AT gmail.com>.

**CVE**: [CVE-2014-4966](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-4966) (lookup function),
[CVE-2014-4967](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-4967) (action arguments)

**Timeline**:

2014-07-01: vulnerability report received

2014-07-02: contacted Ansible maintainers

2014-07-02: disclosure coordinated on 2014-07-17

2014-07-15: assigned CVEs

2014-07-06: maintainer provides patch for review

2014-07-17: maintainer provides updated patch based on reporter's feedback

2014-07-17: embargo date lifted due to ongoing evaluations of patch effectiveness and additional reporter feedback

2014-07-17: maintainer provides updated patch which provides solutions for additional findings

2014-07-18: disclosure date updated to 2014-07-21

2014-07-18: maintainer provides updated patch for review

2014-07-20: maintainer provides updated patch indicating all reported issues as closed

2014-07-20: contacted affected vendors

2014-07-21: advisory release

**References**:

<http://www.ansible.com>



=== Content from github.com_7a9290eb_20250126_130634.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-64cw-m57j-65xj)

**CVE-2014-4967**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-64cw-m57j-65xj)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2014-4967](/advisories/GHSA-64cw-m57j-65xj)

## Ansible Arbitrary Code Execution

Critical severity

GitHub Reviewed

Published
May 17, 2022
to the GitHub Advisory Database
•
Updated Sep 10, 2024

[Vulnerability details](/advisories/GHSA-64cw-m57j-65xj)
[Dependabot alerts
0](/advisories/GHSA-64cw-m57j-65xj/dependabot)

## Package

pip

ansible
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

< 1.6.7

## Patched versions

1.6.7

## Description

Multiple argument injection vulnerabilities in Ansible before 1.6.7 allow remote attackers to execute arbitrary code by leveraging access to an Ansible managed host and providing a crafted fact, as demonstrated by a fact with (1) a trailing " src=" clause, (2) a trailing " temp=" clause, or (3) a trailing " validate=" clause accompanied by a shell command.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2014-4967>
* [ansible/ansible@62a1295](https://github.com/ansible/ansible/commit/62a1295a3e08cb6c3e9f1b2a1e6e5dcaeab32527)
* <http://www.ocert.org/advisories/ocert-2014-004.html>
* <https://github.com/pypa/advisory-database/tree/main/vulns/ansible/PYSEC-2020-205.yaml>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2014-4967)
Feb 18, 2020

Published to the GitHub Advisory Database
May 17, 2022

Reviewed
Jan 30, 2024

Last updated
Sep 10, 2024

### Severity

Critical

9.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector
Network

Attack Complexity
Low

Attack Requirements
None

Privileges Required
None

User interaction
None
##### Vulnerable System Impact Metrics

Confidentiality
High

Integrity
High

Availability
High
##### Subsequent System Impact Metrics

Confidentiality
None

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector:
This metric reflects the context by which vulnerability exploitation is possible. This metric value (and consequently the resulting severity) will be larger the more remote (logically, and physically) an attacker can be in order to exploit the vulnerable system. The assumption is that the number of potential attackers for a vulnerability that could be exploited from across a network is larger than the number of potential attackers that could exploit a vulnerability requiring physical access to a device, and therefore warrants a greater severity.

Attack Complexity:
This metric captures measurable actions that must be taken by the attacker to actively evade or circumvent existing built-in security-enhancing conditions in order to obtain a working exploit. These are conditions whose primary purpose is to increase security and/or increase exploit engineering complexity. A vulnerability exploitable without a target-specific variable has a lower complexity than a vulnerability that would require non-trivial customization. This metric is meant to capture security mechanisms utilized by the vulnerable system.

Attack Requirements:
This metric captures the prerequisite deployment and execution conditions or variables of the vulnerable system that enable the attack. These differ from security-enhancing techniques/technologies (ref Attack Complexity) as the primary purpose of these conditions is not to explicitly mitigate attacks, but rather, emerge naturally as a consequence of the deployment and execution of the vulnerable system.

Privileges Required:
This metric describes the level of privileges an attacker must possess prior to successfully exploiting the vulnerability. The method by which the attacker obtains privileged credentials prior to the attack (e.g., free trial accounts), is outside the scope of this metric. Generally, self-service provisioned accounts do not constitute a privilege requirement if the attacker can grant themselves privileges as part of the attack.

User interaction:
This metric captures the requirement for a human user, other than the attacker, to participate in the successful compromise of the vulnerable system. This metric determines whether the vulnerability can be exploited solely at the will of the attacker, or whether a separate user (or user-initiated process) must participate in some manner.
##### Vulnerable System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the VULNERABLE SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the VULNERABLE SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the VULNERABLE SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.
##### Subsequent System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the SUBSEQUENT SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the SUBSEQUENT SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the SUBSEQUENT SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.

 CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N

### EPSS score

0.722%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (81st percentile)

### Weaknesses

[CWE-74](/advisories?query=cwe%3A74)

### CVE ID

CVE-2014-4967

### GHSA ID

GHSA-64cw-m57j-65xj

### Source code

No known source code

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-64cw-m57j-65xj/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_de475e21_20250126_130634.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-wqq5-c89p-3wc3)

**CVE-2014-4966**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-wqq5-c89p-3wc3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2014-4966](/advisories/GHSA-wqq5-c89p-3wc3)

## Ansible Arbitrary Code Execution

Critical severity

GitHub Reviewed

Published
May 17, 2022
to the GitHub Advisory Database
•
Updated Sep 10, 2024

[Vulnerability details](/advisories/GHSA-wqq5-c89p-3wc3)
[Dependabot alerts
0](/advisories/GHSA-wqq5-c89p-3wc3/dependabot)

## Package

pip

ansible
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

< 1.6.7

## Patched versions

1.6.7

## Description

Ansible before 1.6.7 does not prevent inventory data with "{{" and "lookup" substrings, and does not prevent remote data with "{{" substrings, which allows remote attackers to execute arbitrary code via (1) crafted lookup('pipe') calls or (2) crafted Jinja2 data.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2014-4966>
* [ansible/ansible@62a1295](https://github.com/ansible/ansible/commit/62a1295a3e08cb6c3e9f1b2a1e6e5dcaeab32527)
* <http://www.ocert.org/advisories/ocert-2014-004.html>
* <https://github.com/pypa/advisory-database/tree/main/vulns/ansible/PYSEC-2020-204.yaml>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2014-4966)
Feb 18, 2020

Published to the GitHub Advisory Database
May 17, 2022

Reviewed
Jan 30, 2024

Last updated
Sep 10, 2024

### Severity

Critical

9.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector
Network

Attack Complexity
Low

Attack Requirements
None

Privileges Required
None

User interaction
None
##### Vulnerable System Impact Metrics

Confidentiality
High

Integrity
High

Availability
High
##### Subsequent System Impact Metrics

Confidentiality
None

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector:
This metric reflects the context by which vulnerability exploitation is possible. This metric value (and consequently the resulting severity) will be larger the more remote (logically, and physically) an attacker can be in order to exploit the vulnerable system. The assumption is that the number of potential attackers for a vulnerability that could be exploited from across a network is larger than the number of potential attackers that could exploit a vulnerability requiring physical access to a device, and therefore warrants a greater severity.

Attack Complexity:
This metric captures measurable actions that must be taken by the attacker to actively evade or circumvent existing built-in security-enhancing conditions in order to obtain a working exploit. These are conditions whose primary purpose is to increase security and/or increase exploit engineering complexity. A vulnerability exploitable without a target-specific variable has a lower complexity than a vulnerability that would require non-trivial customization. This metric is meant to capture security mechanisms utilized by the vulnerable system.

Attack Requirements:
This metric captures the prerequisite deployment and execution conditions or variables of the vulnerable system that enable the attack. These differ from security-enhancing techniques/technologies (ref Attack Complexity) as the primary purpose of these conditions is not to explicitly mitigate attacks, but rather, emerge naturally as a consequence of the deployment and execution of the vulnerable system.

Privileges Required:
This metric describes the level of privileges an attacker must possess prior to successfully exploiting the vulnerability. The method by which the attacker obtains privileged credentials prior to the attack (e.g., free trial accounts), is outside the scope of this metric. Generally, self-service provisioned accounts do not constitute a privilege requirement if the attacker can grant themselves privileges as part of the attack.

User interaction:
This metric captures the requirement for a human user, other than the attacker, to participate in the successful compromise of the vulnerable system. This metric determines whether the vulnerability can be exploited solely at the will of the attacker, or whether a separate user (or user-initiated process) must participate in some manner.
##### Vulnerable System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the VULNERABLE SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the VULNERABLE SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the VULNERABLE SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.
##### Subsequent System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the SUBSEQUENT SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the SUBSEQUENT SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the SUBSEQUENT SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.

 CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N

### EPSS score

1.872%

# Exploit Prediction Scoring System (EPSS)

This score estimates the probability of this vulnerability being exploited within the next 30 days.
Data provided by [FIRST](https://www.first.org/epss/user-guide).

 (88th percentile)

### Weaknesses

[CWE-74](/advisories?query=cwe%3A74)

### CVE ID

CVE-2014-4966

### GHSA ID

GHSA-wqq5-c89p-3wc3

### Source code

No known source code

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-wqq5-c89p-3wc3/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


