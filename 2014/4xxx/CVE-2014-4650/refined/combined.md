=== Content from openwall.com_cfe3d570_20250125_091728.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](../../../2014/06/23/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <201406260024.s5Q0ONr5001579@linus.mitre.org>
Date: Wed, 25 Jun 2014 20:24:23 -0400 (EDT)
From: cve-assign@...re.org
To: till.maas@...team-pentesting.de
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE ID Request for Python CGIHTTPServer File Disclosure

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

> <http://bugs.python.org/issue21766>

Use CVE-2014-4650 for the "does not properly handle URL-encoded path
separators in URLs" issue, with the two impacts of "gain access to the
contents of CGI binaries or the source code of CGI scripts" and
"execute code that was not intended to be executed."

This CVE request was somewhat confusing in that it only mentioned
file disclosure, but many CVE consumers would consider the
code execution to be more important. If there is a complication --
for example, if the code execution CVE request was being handled
separately -- please let us know.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (SunOS)

iQEcBAEBAgAGBQJTq2fSAAoJEKllVAevmvmsJ3wH/inxD0wVRzEdhXpu5Yr3kG8n
WS4yvEjFKC+ev04Y6SM2K5JckJF3miA0VCURZ1075VRUiNESP2eseWEe6YGPC/OE
OixE+pNfVv2Ex3HcHTkYyMRx5CJL1yCCOaeiYeqi2vIAa0fLbLbHqUiMSoSXPWfx
IOMUF9IcMI3sovE3MQLQjhoiZnd4MErIhuEGRRdeg8P+F3mU+v67blwi7bfHqoH4
JcaLiOCjs8HQ0zbqrOTjh6ucVNIDwThlOJnhEJBCoajOLW4Y3RR5ev4TXLyRZzgQ
FC76zDC1xwfsVxel5Ld4kLtEvI2weUDKf4R+kp88E6ORg2hTyywM3SFfAffx01g=
=dclN
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from access.redhat.com_f87be75e_20250125_091728.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugs.python.org_0a4c603e_20250125_091727.html ===

# [homepage](.)

open

all

* [Python Home](https://www.python.org/ "Go to the Python homepage")
* [About](https://www.python.org/about/ "About The Python Language")
* [News](https://www.python.org/blogs/)
* [Documentation](https://www.python.org/doc/)
* [Downloads](https://www.python.org/downloads/)
* [Community](https://www.python.org/community/)
* [Foundation](https://www.python.org/psf/ "Python Software Foundation")
* [Developer's Guide](https://devguide.python.org/ "Python Developer's Guide")
* [Issue Tracker](. "Python Issue Tracker")
  + **Issues**
    - [Search](issue?@template=search&status=1)
    - [Random Issue](issue?@action=random)
  + **Summaries**
    - [Issues with patch](issue?status=1&@sort=-activity&@columns=id%2Cgithub%2Cactivity%2Ctitle%2Ccreator%2Cstatus&@dispname=Issues%20with%20patch&@startwith=0&@group=priority&keywords=2&@action=search&@filter=&@pagesize=50)
    - [Easy issues](issue?status=1&@sort=-activity&@columns=id%2Cgithub%2Cactivity%2Ctitle%2Ccreator%2Cstatus&@dispname=Easy%20issues&@startwith=0&@group=priority&keywords=6&@action=search&@filter=&@pagesize=50)
    - [Stats](issue?@template=stats)
  + **User**
    - Login

      Remember me?
    - [Lost your login?](user?@template=forgotten)
  + **Administration**
    - [User List](user?@sort=username)
    - [Committer List](user?iscommitter=1&@action=search&@sort=username&@pagesize=300)
  + **Help**
    - [Tracker Documentation](http://docs.python.org/devguide/triaging.html)
    - [Tracker Development](http://wiki.python.org/moin/TrackerDevelopment)
    - [Report Tracker Problem](https://github.com/python/psf-infra-meta/issues)

Issue21766

![](@@file/python-logo-small.png)
➜
[![](@@file/gh-icon.png)](https://github.com/python/cpython/issues)

This issue tracker **has been migrated to [GitHub](https://github.com/python/cpython/issues)**,
and is currently **read-only**.

For more information, [see the GitHub FAQs in the Python's Developer Guide.](https://devguide.python.org/gh-faq/ "GitHub FAQs")

[![](@@file/gh-icon.png)

This issue has been migrated to GitHub:
https://github.com/python/cpython/issues/65965](https://github.com/python/cpython/issues/65965)

classification

| [Title](http://docs.python.org/devguide/triaging.html#title): | CGIHTTPServer File Disclosure | | |
| --- | --- | --- | --- |
| [Type](http://docs.python.org/devguide/triaging.html#type): | security | [Stage](http://docs.python.org/devguide/triaging.html#stage): | resolved |
| [Components](http://docs.python.org/devguide/triaging.html#components): | Library (Lib) | [Versions](http://docs.python.org/devguide/triaging.html#versions): | Python 3.2, Python 3.3, Python 3.4, Python 3.5, Python 2.7 |

process

| [Status](http://docs.python.org/devguide/triaging.html#status): | closed | [Resolution](http://docs.python.org/devguide/triaging.html#resolution): | fixed |
| --- | --- | --- | --- |
| [Dependencies](http://docs.python.org/devguide/triaging.html#dependencies): |  | [Superseder](http://docs.python.org/devguide/triaging.html#superseder): |  |
| [Assigned To](http://docs.python.org/devguide/triaging.html#assigned-to): |  | [Nosy List](http://docs.python.org/devguide/triaging.html#nosy-list): | Arfrever, benjamin.peterson, python-dev |
| [Priority](http://docs.python.org/devguide/triaging.html#priority): | critical | [Keywords](http://docs.python.org/devguide/triaging.html#keywords): |  |

Created on **2014-06-15 01:33** by **benjamin.peterson**, last changed **2022-04-11 14:58** by **admin**. This issue is now **closed**.

| Messages (2) | | | |
| --- | --- | --- | --- |
| [msg220603](#msg220603) - [(view)](msg220603) | Author: Benjamin Peterson (benjamin.peterson) \* (Python committer) | Date: 2014-06-15 01:33 |
| ``` From the security list:  The CGIHTTPServer Python module does not properly handle URL-encoded path separators in URLs. This may enable attackers to disclose a CGI script's source code or execute arbitrary scripts in the server's document root.  Details =======  Product: Python CGIHTTPServer Affected Versions: 2.7.5, 3.3.4 (possibly others) Fixed Versions: <FIXED-VERSIONS> Vulnerability Type: File Disclosure, Directory Traversal Security Risk: high Vendor URL: <https://docs.python.org/2/library/cgihttpserver.html> Vendor Status: notified Advisory URL: <https://www.redteam-pentesting.de/advisories/rt-sa-2014-008> Advisory Status: private CVE: GENERIC-MAP-NOMATCH CVE URL: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=GENERIC-MAP-NOMATCH>   Introduction ============  The CGIHTTPServer module defines a request-handler class, interface compatible with BaseHTTPServer. BaseHTTPRequestHandler and inherits behavior from SimpleHTTPServer. SimpleHTTPRequestHandler but can also run CGI scripts.  (from the Python documentation)  More Details ============  The CGIHTTPServer module can be used to set up a simple HTTP server with CGI scripts. A sample server script in Python may look like the following:  ------------------------------------------------------------------------ #!/usr/bin/env python2  import CGIHTTPServer import BaseHTTPServer  if __name__ == "__main__":     server = BaseHTTPServer.HTTPServer     handler = CGIHTTPServer.CGIHTTPRequestHandler     server_address = ("", 8000)     # Note that only /cgi-bin will work:     handler.cgi_directories = ["/cgi-bin", "/cgi-bin/subdir"]     httpd = server(server_address, handler)     httpd.serve_forever() ------------------------------------------------------------------------  This server should execute any scripts located in the subdirectory "cgi-bin". A sample CGI script can be placed in that directory, for example a script like the following:  ------------------------------------------------------------------------ #!/usr/bin/env python2 import json import sys  db_credentials = "SECRET" sys.stdout.write("Content-type: text/json\r\n\r\n") sys.stdout.write(json.dumps({"text": "This is a Test"})) ------------------------------------------------------------------------  The Python library CGIHTTPServer.py implements the CGIHTTPRequestHandler class which inherits from SimpleHTTPServer.SimpleHTTPRequestHandler:  class SimpleHTTPRequestHandler(BaseHTTPServer.BaseHTTPRequestHandler): [...]     def do_GET(self):         """Serve a GET request."""         f = self.send_head()         if f:             try:                 self.copyfile(f, self.wfile)             finally:                 f.close()      def do_HEAD(self):         """Serve a HEAD request."""         f = self.send_head()         if f:             f.close()      def translate_path(self, path):     [...]         path = posixpath.normpath(urllib.unquote(path))         words = path.split('/')         words = filter(None, words)         path = os.getcwd()         [...]  The CGIHTTPRequestHandler class inherits, among others, the methods do_GET() and do_HEAD() for handling HTTP GET and HTTP HEAD requests. The class overrides send_head() and implements several new methods, such as do_POST(), is_cgi() and run_cgi():  class CGIHTTPRequestHandler(SimpleHTTPServer.SimpleHTTPRequestHandler): [...]     def do_POST(self):         [...]         if self.is_cgi():             self.run_cgi()         else:             self.send_error(501, "Can only POST to CGI scripts")      def send_head(self):         """Version of send_head that support CGI scripts"""         if self.is_cgi():             return self.run_cgi()         else:             return SimpleHTTPServer.SimpleHTTPRequestHandler.send_head(self)      def is_cgi(self):         [...]         collapsed_path = _url_collapse_path(self.path)         dir_sep = collapsed_path.find('/', 1)         head, tail = collapsed_path[:dir_sep], collapsed_path[dir_sep+1:]         if head in self.cgi_directories:             self.cgi_info = head, tail             return True         return False [...]     def run_cgi(self):         """Execute a CGI script."""         dir, rest = self.cgi_info          [...]          # dissect the part after the directory name into a script name &         # a possible additional path, to be stored in PATH_INFO.         i = rest.find('/')         if i >= 0:             script, rest = rest[:i], rest[i:]         else:             script, rest = rest, ''          scriptname = dir + '/' + script         scriptfile = self.translate_path(scriptname)         if not os.path.exists(scriptfile):             self.send_error(404, "No such CGI script (%r)" % scriptname)             return         if not os.path.isfile(scriptfile):             self.send_error(403, "CGI script is not a plain file (%r)" %                             scriptname)             return         [...] [...]  For HTTP GET requests, do_GET() first invokes send_head(). That method calls is_cgi() to determine whether the requested path is to be executed as a CGI script. The is_cgi() method uses _url_collapse_path() to normalize the path, i.e. remove extraneous slashes (/),current directory (.), or parent directory (..) elements, taking care not to permit directory traversal below the document root. The is_cgi() function returns True when the first path element is contained in the cgi_directories list. As _url_collaps_path() and is_cgi() never URL decode the path, replacing the forward slash after the CGI directory in the URL to a CGI script with the URL encoded variant %2f leads to is_cgi() returning False. This will make CGIHTTPRequestHandler's send_head() then invoke its parent's send_head() method which translates the URL path to a file system path using the translate_path() method and then outputs the file's contents raw. As translate_path() URL decodes the path, this then succeeds and discloses the CGI script's file contents:  $ curl [http://localhost:8000/cgi-bin%2ftest.py](http://localhost:8000/cgi-bin/test.py) #!/usr/bin/env python2 import json import sys  db_credentials = "SECRET" sys.stdout.write("Content-type: text/json\r\n\r\n") sys.stdout.write(json.dumps({"text": "This is a Test"}))  Similarly, the CGIHTTPRequestHandler can be tricked into executing CGI scripts that would normally not be executable. The class normally only allows executing CGI scripts that are direct children of one of the directories listed in cgi_directories. Furthermore, only direct subdirectories of the document root (the current working directory) can be valid CGI directories.  This can be seen in the following example. Even though the sample server shown above includes "/cgi-bin/subdir" as part of the request handler's cgi_directories, a CGI script named test.py in that directory is not executed:  $ curl <http://localhost:8000/cgi-bin/subdir/test.py> [...] <p>Error code 403. <p>Message: CGI script is not a plain file ('/cgi-bin/subdir'). [...]  Here, is_cgi() set self.cgi_info to ('/cgi-bin', 'subdir/test.py') and returned True. Next, run_cgi() further dissected these paths to perform some sanity checks, thereby mistakenly assuming subdir to be the executable script's filename and test.py to be path info. As subdir is not an executable file, run_cgi() returns an error message. However, if the forward slash between subdir and test.py is replaced with %2f, invoking the script succeeds:  $ curl [http://localhost:8000/cgi-bin/subdir%2ftest.py](http://localhost:8000/cgi-bin/subdir/test.py) {"text": "This is a Test"}  This is because neither is_cgi() nor run_cgi() URL decode the path during processing until run_cgi() tries to determine whether the target script is an executable file. More specifically, as subdir%2ftest.py does not contain a forward slash, it is not split into the script name subdir and path info test.py, as in the previous example.  Similarly, using URL encoded forward slashes, executables outside of a CGI directory can be executed:  $ curl [http://localhost:8000/cgi-bin/..%2ftraversed.py](http://localhost:8000/cgi-bin/../traversed.py) {"text": "This is a Test"}  Workaround ==========  Subclass CGIHTTPRequestHandler and override the is_cgi() method  with a variant that first URL decodes the supplied path, for example:  class FixedCGIHTTPRequestHandler(CGIHTTPServer.CGIHTTPRequestHandler):     def is_cgi(self):         self.path = urllib.unquote(self.path)         return CGIHTTPServer.CGIHTTPRequestHandler.is_cgi(self)  Fix ===  <FIX>   Security Risk =============  The vulnerability can be used to gain access to the contents of CGI binaries or the source code of CGI scripts. This may reveal sensitve information, for example access credentials. This can greatly help attackers in mounting further attacks and is therefore considered to pose a high risk. Furthermore attackers may be able to execute code that was not intended to be executed.   The CGIHTTPServer code does contain this warning: "SECURITY WARNING: DON'T USE THIS CODE UNLESS YOU ARE INSIDE A FIREWALL" Even when used on a local computer this may allow other local users to execute code in the context of another user. ``` | | | |
| [msg220604](#msg220604) - [(view)](msg220604) | Author: Roundup Robot (python-dev) (Python triager) | Date: 2014-06-15 01:41 |
| ``` New changeset [b4bab0788768](https://hg.python.org/lookup/b4bab0788768) by Benjamin Peterson in branch '2.7': url unquote the path before checking if it refers to a CGI script (closes [#21766](issue21766 "[closed] CGIHTTPServer File Disclosure")) <http://hg.python.org/cpython/rev/b4bab0788768>  New changeset [e47422855841](https://hg.python.org/lookup/e47422855841) by Benjamin Peterson in branch '3.2': url unquote the path before checking if it refers to a CGI script (closes [#21766](issue21766 "[closed] CGIHTTPServer File Disclosure")) <http://hg.python.org/cpython/rev/e47422855841>  New changeset [5676797f3a3e](https://hg.python.org/lookup/5676797f3a3e) by Benjamin Peterson in branch '3.3': merge 3.2 ([#21766](issue21766 "[closed] CGIHTTPServer File Disclosure")) <http://hg.python.org/cpython/rev/5676797f3a3e>  New changeset [847e288d6e93](https://hg.python.org/lookup/847e288d6e93) by Benjamin Peterson in branch '3.4': merge 3.3 ([#21766](issue21766 "[closed] CGIHTTPServer File Disclosure")) <http://hg.python.org/cpython/rev/847e288d6e93>  New changeset [f8b3bb5eb190](https://hg.python.org/lookup/f8b3bb5eb190) by Benjamin Peterson in branch 'default': merge 3.4 ([#21766](issue21766 "[closed] CGIHTTPServer File Disclosure")) <http://hg.python.org/cpython/rev/f8b3bb5eb190> ``` | | | |

| History | | | |
| --- | --- | --- | --- |
| Date | User | Action | Args |
| 2022-04-11 14:58:04 | admin | set | github: 65965 |
| 2014-06-22 08:22:51 | Arfrever | set | nosy: + [Arfrever](user9138) |
| 2014-06-15 01:41:56 | python-dev | set | status: open -> closednosy: + [python-dev](user13902)messages: + <msg220604>resolution: fixedstage: resolved |
| 2014-06-15 01:33:28 | benjamin.peterson | create |  |

Supported by [The Python Software Foundation](https://python.org/psf-landing/ "The Python Software Foundation"),

Powered by [Roundup](http://roundup.sourceforge.net "Powered by the Roundup Issue Tracker")

Copyright © 1990-2022, [Python Software Foundation](http://python.org/psf)


