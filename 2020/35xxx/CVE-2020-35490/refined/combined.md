=== Content from medium.com_2f2ac3ae_20250119_134011.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F54cd0d6e8062&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fcowtowncoder.medium.com%2Fon-jackson-cves-dont-panic-here-is-what-you-need-to-know-54cd0d6e8062&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fcowtowncoder.medium.com%2Fon-jackson-cves-dont-panic-here-is-what-you-need-to-know-54cd0d6e8062&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# On Jackson CVEs: Don’t Panic — Here is what you need to know

## Addendums (19-May-2020, 28-Sep-2019):

[![@cowtowncoder](https://miro.medium.com/v2/resize:fill:88:88/1*egRHuiA609Ln_WTBcsg-4A.jpeg)](/?source=post_page---byline--54cd0d6e8062--------------------------------)

[@cowtowncoder](/?source=post_page---byline--54cd0d6e8062--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb9b3ec1cfbf7&operation=register&redirect=https%3A%2F%2Fcowtowncoder.medium.com%2Fon-jackson-cves-dont-panic-here-is-what-you-need-to-know-54cd0d6e8062&user=%40cowtowncoder&userId=b9b3ec1cfbf7&source=post_page-b9b3ec1cfbf7--byline--54cd0d6e8062---------------------post_header-----------)

8 min read·Dec 22, 2017

--

5

Listen

Share

Important notes:

* Jackson 2.11 added `MapperFeature.BLOCK_UNSAFE_POLYMORPHIC_BASE_TYPES` which can be enabled to prevent use of potentially unsafe 2.10-deprecated legacy methods: read more on “[Jackson 2.11 Features](https://medium.com/%40cowtowncoder/jackson-2-11-features-40cdc1d2bdf3)” blog post.
* Jackson 2.10 supports new “Safe Default Typing” via `activateDefaultTyping()` (instead of deprecated `enableDefaultTyping()`): read more on “[Jackson 2.10 Features](https://medium.com/%40cowtowncoder/jackson-2-10-features-cd880674d8a2)” blog post.

# Background

During 2017 many vulnerabilities based on so-called “serialization gadgets” (or just “gadgets”) were reported. Reports cover many different Java serialization frameworks and libraries, including Jackson.

Gadgets are classes that allow calling otherwise non-accessible methods or accessing non-accessible data, when instantiated and modified via setters and/or assignments to fields (necessary during reading of data into Objects, aka deserialization; or during writing of Objects as data, aka Serialization).
With proper initialization they will perform operations as side effects: operations that may for example allow remote execution of commands or scripts, or that expose data from the file system of server handling deserialization.

As a hypothetical example let’s consider class `Bomb` with method `setTimeToDetonate(int seconds)`, calling of which shuts down JVM (or Operating System) after specific delay. If serialization system allows construction of `Bomb` and calling of `setTimeToDetonate` (for example by passing property “timeToDetonate”) this is a valid attack vector for denial-of-service attack. Most gadgets require calling of one or more setter methods in specific order, and then allow either reading of a system file, execution of a command, or sometimes execution of code specified in payload (as byte code possibly encoded as Base64).

Originally research started with focus on default JDK serialization. A good overview is this article from 2015:

* <http://frohoff.github.io/appseccali-marshalling-pickles/>

which covers tools that is still being developed, updated with new exploits:

* <https://github.com/frohoff/ysoserial>

# Currently Published State of the Art Gadgets

A more recent take, covering many other libraries/frameworks, can be found from:

* <https://github.com/mbechler/marshalsec>

(there’s a link to pdf presentation in README: repo itself contains sample exploit(s))

This project documents about two dozen potential, commonly available gadgets over a dozen frameworks, including Jackson. Report is good reading in general so I encourage you to read (or at least skim) it if at all interested in security aspects of Object serialization.

There is also at least one existing Jackson-specific article:

* <https://adamcaudill.com/2017/10/04/exploiting-jackson-rce-cve-2017-7525/>

which explains specific exploit applicable against Jackson quite well (if not in deep detail); but I thought it would make sense to explain exact requirements (applicability of exploit) in bit more detail because the exploit described can only be used under specific circumstances and is NOT generally available just because Jackson is being used for serialization.

# Am I Affected if I Use Jackson for JSON?

As usual, the full answer is “It Depends”. But the likely answer is “probably not”. The reason for this is that for exploit to work, multiple things must be true and commonly at least one pre-requisite is not true.

But let’s look at these pre-requisite.

# What is Required for a Jackson-based “gadget” Exploit?

Simply put, exploit can work if all of these conditions are true, if your system:

1. Accepts JSON content sent by untrusted client (composed manually or by code you did not write and have no visibility or control over) — meaning that you can not constrain JSON itself that is being sent
2. Has at least one specific “gadget” class to exploit in the Java classpath: and specifically class from these that works with Jackson (most gadgets only work with specific library or libraries — most commonly reported ones for example only work with JDK serialization)
3. Enable polymorphic type handling for properties with nominal type of `java.lang.Object` (or one of small number of “permissive” tag interfaces; `java.util.Serializable`, `java.util.Comparable`)
4. Use version of Jackson that does not (yet) block “gadget” class in question (set of published exploits grows over time so it is a race between exploits and patches)

Of these, (1) means that if you control both endpoints, this exploit is not available — but this is presumed to be the starting point since without attacker there will not be attacks (although it is worth noting that in multi-phase attack internal communication may be compromised and attacker gains access).

Point (2) simply means that some of the exploits rely on libraries that your application / service has dependencies on. Since some of “gadgets” are included in JDK itself, it is likely that you may well have at least one such type accessible.

So the main points to cover here are (3) and (4).

# What Does Polymorphic Typing Even Mean?

Let’s start with the definition of “polymorphic handling”. By default, specific types used have to be declared by POJO or caller, so you use classes like:

```
public class Person {
  public String name;
  public int age;
  public PhoneNumber phone; // embedded POJO
}
public class PhoneNumber {
  public int areaCode;
  public int local;
  // ... and so forth; not including optional getters/setters
}
```

and deserializer knows how to handle values for matching JSON values. Incoming JSON might look something like:

```
{ "name" : "Bob",
  "age" : 28.
  "phone" : {
     "areaCode" : 555,
     "local" : 1234567
  }
}
```

But in Object-Oriented Programming, you often use polymorphism: certain base type has multiple alternative implementations.
In above example we could, say, define different kinds of phone numbers (international? Cell phone?). So you could have (and yes, example is contrived — but humor me):

```
abstract class PhoneNumber {
   public int areaCode, local;
}
public class InternationalNumber extends PhoneNumber {
   public int countryCode;
}
public class DomesticNumber extends PhoneNumber { }
```

Serializing (writing out) of `Person` instances would not be problematic, as type is available and be introspected for properties. But trying to read values back would give us an exception because `Person` is an abstract type and you can not create instances of abstract types; you must use a concrete subtype. And deserializer does not know which subtype to use without further information.

Jackson can support this if we allow/require addition of “type id”: value that allows deserializer to know which subtype to create instance of. Easiest way is to use annotation `@JsonTypeInfo`, using one of two mechanisms:

```
// enable polymorphic handling for every PhoneNumber-valued property
@JsonTypeInfo(use = Id.CLASS)
// note: there are other ways to register subtypes, too
@JsonSubTypes({ InternationalNumber.class, DomesticNumber.class })
abstract class PhoneNumber {
}// or:
public class Person {
   @JsonTypeInfo(...) // only enable for this property!
   public PhoneNumber phone;
}
```

When doing this, serializer will add a type identifier in JSON (depending on configuration can be additional property, or array or object structure “wrapping” value); and deserializer, conversely, knows to expect this. We will see something like:

```
{ "phone" : {
   "@class" : "package.InternationalNumber",
   "areaCode" : 555,
   ...
  }
}
```

Note that this is just one of the options, regarding type id to include, and mechanism for inclusion. For more information on usage you may want to read:

* <http://www.baeldung.com/jackson-annotations>
* <http://programmerbruce.blogspot.com/2011/05/deserialize-json-with-jackson-into.html>
* <http://www.studytrails.com/java/json/java-jackson-serialization-polymorphism/>

The key part here is that if (and only if!) class name is used as the type id, then sender could send any class name they want to: within limits of type compatibility Jackson deserializer will (try to) create an instance of that type and initialize it by calling setter methods and/or setting values to fields.

# Another Way to Enable Polymorphic Handling in Jackson

So, this is the most common way to enable polymorphic handling for specific properties. But it requires annotating either all polymorphic value types, or all properties (or some combination thereof). This may not be practical, especially with 3rd party value types (although even in those cases it is possible to use this approach, with “mix-in” annotations).

Because of this reason, there is one other way to enable polymorphic handling: “Default Typing”.
Default typing is enabled via `ObjectMapper`:

```
ObjectMapper mapper = new ObjectMapper();
mapper.enableDefaultTyping(); // or one of variants
```

and what it does is equivalent to adding:

```
@JsonTypeInfo(use = Id.CLASS, include = As.WRAPPER_ARRAY)
```

on every property that matches inclusion criteria (which, by default, is `DefaultTyping.OBJECT_AND_NON_CONCRETE`). In our case it would apply this to all properties with `abstract` type value, including `PhoneNumber`.

# So Is Polymorphic Handling Always Dangerous?

So far so good. With polymorphic handling attacker can potentially produce types of values that service did not mean to allow. However, this does NOT yet mean she can use actual Gadget types — remember that type to use MUST match base type. This particular case is not yet problematic, unless you happen to find a sub-class of `PhoneNumber` that is a serialization gadget — which is unlikely (or more importantly, unlikely that attacker would know such a class is available).

So we have to make another change to declaration:

```
public class Person {
  @JsonTypeInfo(use = Id.CLASS)
  public Object phone;
}
```

Why is this important? Because all Java classes are instances of `Object`, so now attacker can select from a wide selection of documented “gadgets”. Although only from a set that works with Jackson’s setter/field assignment (some attacks only work against JDK serialization, or against other serialization frameworks).

Also note that some other “tag” types can be similarly problematic:

* `java.util.Serializable` is implemented by many types (including many Gadget classes)
* `java.util.Comparable` and `java.lang.Cloneable` are also commonly implemented by various classes

# Is There Anything Jackson Does to Protect You?

So now we know the first 3 pre-requisites for successful exploit. But there is one more requirement.

Given that there is active research to find gadget types, Jackson databind module is being updated, incrementally, to prevent use of these types.
This means, simply put, that deserialization of a set of “well-known” Gadget types is blocked: they can not be read in via polymorphic handling (or actually even with explicit type).

Since inclusion of checks requires releasing of new versions, it is important to try to keep your Jackson version as up-to-date as possible. As of February 2019, latest versions are:

* `2.8.11`
* `2.9.8`

and these have the most recent updates.

To learn more about active development, you may also want to check out issues reported:

* <https://github.com/FasterXML/jackson-databind/labels/CVE>

(note: you may want to include `closed` issues as well as open ones)

# What to do to Protect My System?

Knowing all of above, we know something about general applicability.
So here are some suggestions for further reduce likelihood of successful attacks:

1. Try to keep up with updated versions of Jackson (`jackson-databind`): it should always be safe to upgrade to the latest patch version of given minor version (safest in the sense they should be no breaking changes to functionality)
2. If possible, AVOID enabling default typing (since it is usually class name based). It is better to be explicit about specifying where polymorphism is needed.
3. AVOID using `java.lang.Object` (or, `java.util.Serializable`) as the nominal type of polymorphic values, regardless of whether you use per-type, per-property, or Default Typing
4. If possible USE “type name” and NOT classname as type id: `@JsonTypeInfo(use = Id.NAME)` — this may require annotation of type name (see `@JsonTypeName` and `@JsonSubTypes`)

Especially consider the fact that if you can do either (3) or (4), you will prevent use of this class of exploits.

[Programming](https://medium.com/tag/programming?source=post_page-----54cd0d6e8062--------------------------------)[Java](https://medium.com/tag/java?source=post_page-----54cd0d6e8062--------------------------------)[Security](https://medium.com/tag/security?source=post_page-----54cd0d6e8062--------------------------------)[Cve](https://medium.com/tag/cve?source=post_page-----54cd0d6e8062--------------------------------)[Jackson](https://medium.com/tag/jackson?source=post_page-----54cd0d6e8062--------------------------------)

--

--

5

[![@cowtowncoder](https://miro.medium.com/v2/resize:fill:96:96/1*egRHuiA609Ln_WTBcsg-4A.jpeg)](/?source=post_page---post_author_info--54cd0d6e8062--------------------------------)[![@cowtowncoder](https://miro.medium.com/v2/resize:fill:128:128/1*egRHuiA609Ln_WTBcsg-4A.jpeg)](/?source=post_page---post_author_info--54cd0d6e8062--------------------------------)Follow[## Written by @cowtowncoder](/?source=post_page---post_author_info--54cd0d6e8062--------------------------------)[519 Followers](/followers?source=post_page---post_author_info--54cd0d6e8062--------------------------------)·[21 Following](/following?source=post_page---post_author_info--54cd0d6e8062--------------------------------)

Open Source developer, most known for Jackson data processor (nee “JSON library”), author of many, many other OSS libraries for Java, from ClassMate to Woodstox

Follow
## Responses (5)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----54cd0d6e8062--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----54cd0d6e8062--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----54cd0d6e8062--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----54cd0d6e8062--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----54cd0d6e8062--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----54cd0d6e8062--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----54cd0d6e8062--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----54cd0d6e8062--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----54cd0d6e8062--------------------------------)[Teams](https://medium.com/business?source=post_page-----54cd0d6e8062--------------------------------)



=== Content from security.netapp.com_d8217e61_20250119_115435.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [December 2020 FasterXML jackson-databind Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20210122-0005)

## December 2020 FasterXML jackson-databind Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20210122-0005 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20210122-0005 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20210122-0005 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20210122-0005 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20210122-0005
**Version:**
9.0

**Last updated:**
01/06/2022

**Status:**
Final.

**CVEs:** CVE-2020-35490, CVE-2020-35491

Overview
#### Summary

Multiple NetApp products incorporate FasterXML jackson-databind. FasterXML jackson-databind versions 2.x prior to 2.9.10.8 are susceptible to vulnerabilities which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2020-35490](https://nvd.nist.gov/vuln/detail/CVE-2020-35490) | 8.1 (HIGH) | CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2020-35491](https://nvd.nist.gov/vuln/detail/CVE-2020-35491) | 8.1 (HIGH) | CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://github.com/FasterXML/jackson-databind/issues/2986>

Affected Products
#### Affected Products

* Element Plug-in for vCenter Server
* NetApp Cloud Backup (formerly AltaVault)
* NetApp Service Level Manager

#### Products Not Affected

* 7-Mode Transition Tool
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Trident
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Python SDK
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM6 SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Performance Analyzer
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SANtricity Cloud Connector
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* OnCommand API Services
* OnCommand Insight
* OnCommand Unified Manager Core Package
* OnCommand Workflow Automation
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* System Manager 9.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **Element Plug-in for vCenter Server** | <https://mysupport.netapp.com/site/products/all/details/mgmtservices/downloads-tab/download/63086/2.18.91> |
| **NetApp Cloud Backup (formerly AltaVault)** | NetApp Cloud Backup (formerly AltaVault) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2880179.html) for more information. |
| **NetApp Service Level Manager** | NetApp Service Level Manager has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2861371.html) for more information. |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20210122-0005>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20210122 | Initial Public Release |
| 2.0 | 20210127 | OnCommand Cloud Manager moved to Products Not Affected |
| 3.0 | 20210201 | NetApp Service Level Manager moved to Won't Fix status |
| 4.0 | 20210208 | NetApp E-Series Performance Analyzer moved to Products Not Affected |
| 5.0 | 20210323 | Active IQ Unified Manager for Linux, Active IQ Unified Manager for Microsoft Windows, and Active IQ Unified Manager for VMware vSphere moved to Products Not Affected |
| 6.0 | 20210325 | Brocade SAN Navigator (SANnav) moved to Products Not Affected |
| 7.0 | 20210608 | Element Plug-in for vCenter Server added to Software Versions and Fixes |
| 8.0 | 20210713 | NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO) moved to Products Not Affected |
| 9.0 | 20220106 | NetApp Cloud Backup (formerly AltaVault) moved to Won't Fix status, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from github.com_8ea3b782_20250119_134012.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFasterXML%2Fjackson-databind%2Fissues%3Fq%3Dstate%253Aopen%2520label%253A%2522CVE%2522)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

state:open label:"CVE"

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFasterXML%2Fjackson-databind%2Fissues%3Fq%3Dstate%253Aopen%2520label%253A%2522CVE%2522)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fissues%2Findex&source=header-repo&source_repo=FasterXML%2Fjackson-databind)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[FasterXML](/FasterXML)
/
**[jackson-databind](/FasterXML/jackson-databind)**
Public

* [Notifications](/login?return_to=%2FFasterXML%2Fjackson-databind) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2FFasterXML%2Fjackson-databind)
* [Star
   3.5k](/login?return_to=%2FFasterXML%2Fjackson-databind)

* [Code](/FasterXML/jackson-databind)
* [Issues
  445](/FasterXML/jackson-databind/issues)
* [Pull requests
  12](/FasterXML/jackson-databind/pulls)
* [Discussions](/FasterXML/jackson-databind/discussions)
* [Actions](/FasterXML/jackson-databind/actions)
* [Projects
  0](/FasterXML/jackson-databind/projects)
* [Wiki](/FasterXML/jackson-databind/wiki)
* [Security](/FasterXML/jackson-databind/security)
* [Insights](/FasterXML/jackson-databind/pulse)

Additional navigation options

* [Code](/FasterXML/jackson-databind)
* [Issues](/FasterXML/jackson-databind/issues)
* [Pull requests](/FasterXML/jackson-databind/pulls)
* [Discussions](/FasterXML/jackson-databind/discussions)
* [Actions](/FasterXML/jackson-databind/actions)
* [Projects](/FasterXML/jackson-databind/projects)
* [Wiki](/FasterXML/jackson-databind/wiki)
* [Security](/FasterXML/jackson-databind/security)
* [Insights](/FasterXML/jackson-databind/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_34afd60c_20250119_134013.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-r3gr-cxrf-hg25)

**CVE-2020-35491**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-r3gr-cxrf-hg25)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2020-35491](/advisories/GHSA-r3gr-cxrf-hg25)

## Serialization gadgets exploit in jackson-databind

High severity

GitHub Reviewed

Published
Dec 9, 2021
to the GitHub Advisory Database
•
Updated Jun 25, 2024

[Vulnerability details](/advisories/GHSA-r3gr-cxrf-hg25)
[Dependabot alerts
0](/advisories/GHSA-r3gr-cxrf-hg25/dependabot)

## Package

maven

com.fasterxml.jackson.core:jackson-databind
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

>= 2.0.0, <= 2.9.10.7

## Patched versions

2.9.10.8

## Description

FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the interaction between serialization gadgets and typing, related to org.apache.commons.dbcp2.datasources.SharedPoolDataSource.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-35491>
* [FasterXML/jackson-databind#2986](https://github.com/FasterXML/jackson-databind/issues/2986)
* <https://cowtowncoder.medium.com/on-jackson-cves-dont-panic-here-is-what-you-need-to-know-54cd0d6e8062>
* <https://lists.debian.org/debian-lts-announce/2021/04/msg00025.html>
* <https://www.oracle.com/security-alerts/cpuApr2021.html>
* <https://www.oracle.com//security-alerts/cpujul2021.html>
* <https://www.oracle.com/security-alerts/cpuoct2021.html>
* <https://www.oracle.com/security-alerts/cpujan2022.html>
* <https://www.oracle.com/security-alerts/cpuapr2022.html>
* <https://www.oracle.com/security-alerts/cpujul2022.html>
* [FasterXML/jackson-databind@41b8bdb](https://github.com/FasterXML/jackson-databind/commit/41b8bdb5ccc1d8edb71acf1c8234da235a24249d)
* <https://security.netapp.com/advisory/ntap-20210122-0005>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-35491)
Dec 17, 2020

Reviewed
Apr 8, 2021

Published to the GitHub Advisory Database
Dec 9, 2021

Last updated
Jun 25, 2024

### Severity

High

8.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.305%
 (70th percentile)

### Weaknesses

[CWE-502](/advisories?query=cwe%3A502) [CWE-913](/advisories?query=cwe%3A913)

### CVE ID

CVE-2020-35491

### GHSA ID

GHSA-r3gr-cxrf-hg25

### Source code

[FasterXML/jackson-databind](https://github.com/FasterXML/jackson-databind)

### Credits

* [![@mpihelgas](https://avatars.githubusercontent.com/u/16393030?s=40&v=4)](/mpihelgas)
  [mpihelgas](/mpihelgas)
  Analyst

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-r3gr-cxrf-hg25/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from cowtowncoder.medium.com_669ae1e8_20250119_115432.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F54cd0d6e8062&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fcowtowncoder.medium.com%2Fon-jackson-cves-dont-panic-here-is-what-you-need-to-know-54cd0d6e8062&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fcowtowncoder.medium.com%2Fon-jackson-cves-dont-panic-here-is-what-you-need-to-know-54cd0d6e8062&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# On Jackson CVEs: Don’t Panic — Here is what you need to know

## Addendums (19-May-2020, 28-Sep-2019):

[![@cowtowncoder](https://miro.medium.com/v2/resize:fill:88:88/1*egRHuiA609Ln_WTBcsg-4A.jpeg)](/?source=post_page---byline--54cd0d6e8062--------------------------------)

[@cowtowncoder](/?source=post_page---byline--54cd0d6e8062--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fb9b3ec1cfbf7&operation=register&redirect=https%3A%2F%2Fcowtowncoder.medium.com%2Fon-jackson-cves-dont-panic-here-is-what-you-need-to-know-54cd0d6e8062&user=%40cowtowncoder&userId=b9b3ec1cfbf7&source=post_page-b9b3ec1cfbf7--byline--54cd0d6e8062---------------------post_header-----------)

8 min read·Dec 22, 2017

--

5

Listen

Share

Important notes:

* Jackson 2.11 added `MapperFeature.BLOCK_UNSAFE_POLYMORPHIC_BASE_TYPES` which can be enabled to prevent use of potentially unsafe 2.10-deprecated legacy methods: read more on “[Jackson 2.11 Features](https://medium.com/%40cowtowncoder/jackson-2-11-features-40cdc1d2bdf3)” blog post.
* Jackson 2.10 supports new “Safe Default Typing” via `activateDefaultTyping()` (instead of deprecated `enableDefaultTyping()`): read more on “[Jackson 2.10 Features](https://medium.com/%40cowtowncoder/jackson-2-10-features-cd880674d8a2)” blog post.

# Background

During 2017 many vulnerabilities based on so-called “serialization gadgets” (or just “gadgets”) were reported. Reports cover many different Java serialization frameworks and libraries, including Jackson.

Gadgets are classes that allow calling otherwise non-accessible methods or accessing non-accessible data, when instantiated and modified via setters and/or assignments to fields (necessary during reading of data into Objects, aka deserialization; or during writing of Objects as data, aka Serialization).
With proper initialization they will perform operations as side effects: operations that may for example allow remote execution of commands or scripts, or that expose data from the file system of server handling deserialization.

As a hypothetical example let’s consider class `Bomb` with method `setTimeToDetonate(int seconds)`, calling of which shuts down JVM (or Operating System) after specific delay. If serialization system allows construction of `Bomb` and calling of `setTimeToDetonate` (for example by passing property “timeToDetonate”) this is a valid attack vector for denial-of-service attack. Most gadgets require calling of one or more setter methods in specific order, and then allow either reading of a system file, execution of a command, or sometimes execution of code specified in payload (as byte code possibly encoded as Base64).

Originally research started with focus on default JDK serialization. A good overview is this article from 2015:

* <http://frohoff.github.io/appseccali-marshalling-pickles/>

which covers tools that is still being developed, updated with new exploits:

* <https://github.com/frohoff/ysoserial>

# Currently Published State of the Art Gadgets

A more recent take, covering many other libraries/frameworks, can be found from:

* <https://github.com/mbechler/marshalsec>

(there’s a link to pdf presentation in README: repo itself contains sample exploit(s))

This project documents about two dozen potential, commonly available gadgets over a dozen frameworks, including Jackson. Report is good reading in general so I encourage you to read (or at least skim) it if at all interested in security aspects of Object serialization.

There is also at least one existing Jackson-specific article:

* <https://adamcaudill.com/2017/10/04/exploiting-jackson-rce-cve-2017-7525/>

which explains specific exploit applicable against Jackson quite well (if not in deep detail); but I thought it would make sense to explain exact requirements (applicability of exploit) in bit more detail because the exploit described can only be used under specific circumstances and is NOT generally available just because Jackson is being used for serialization.

# Am I Affected if I Use Jackson for JSON?

As usual, the full answer is “It Depends”. But the likely answer is “probably not”. The reason for this is that for exploit to work, multiple things must be true and commonly at least one pre-requisite is not true.

But let’s look at these pre-requisite.

# What is Required for a Jackson-based “gadget” Exploit?

Simply put, exploit can work if all of these conditions are true, if your system:

1. Accepts JSON content sent by untrusted client (composed manually or by code you did not write and have no visibility or control over) — meaning that you can not constrain JSON itself that is being sent
2. Has at least one specific “gadget” class to exploit in the Java classpath: and specifically class from these that works with Jackson (most gadgets only work with specific library or libraries — most commonly reported ones for example only work with JDK serialization)
3. Enable polymorphic type handling for properties with nominal type of `java.lang.Object` (or one of small number of “permissive” tag interfaces; `java.util.Serializable`, `java.util.Comparable`)
4. Use version of Jackson that does not (yet) block “gadget” class in question (set of published exploits grows over time so it is a race between exploits and patches)

Of these, (1) means that if you control both endpoints, this exploit is not available — but this is presumed to be the starting point since without attacker there will not be attacks (although it is worth noting that in multi-phase attack internal communication may be compromised and attacker gains access).

Point (2) simply means that some of the exploits rely on libraries that your application / service has dependencies on. Since some of “gadgets” are included in JDK itself, it is likely that you may well have at least one such type accessible.

So the main points to cover here are (3) and (4).

# What Does Polymorphic Typing Even Mean?

Let’s start with the definition of “polymorphic handling”. By default, specific types used have to be declared by POJO or caller, so you use classes like:

```
public class Person {
  public String name;
  public int age;
  public PhoneNumber phone; // embedded POJO
}
public class PhoneNumber {
  public int areaCode;
  public int local;
  // ... and so forth; not including optional getters/setters
}
```

and deserializer knows how to handle values for matching JSON values. Incoming JSON might look something like:

```
{ "name" : "Bob",
  "age" : 28.
  "phone" : {
     "areaCode" : 555,
     "local" : 1234567
  }
}
```

But in Object-Oriented Programming, you often use polymorphism: certain base type has multiple alternative implementations.
In above example we could, say, define different kinds of phone numbers (international? Cell phone?). So you could have (and yes, example is contrived — but humor me):

```
abstract class PhoneNumber {
   public int areaCode, local;
}
public class InternationalNumber extends PhoneNumber {
   public int countryCode;
}
public class DomesticNumber extends PhoneNumber { }
```

Serializing (writing out) of `Person` instances would not be problematic, as type is available and be introspected for properties. But trying to read values back would give us an exception because `Person` is an abstract type and you can not create instances of abstract types; you must use a concrete subtype. And deserializer does not know which subtype to use without further information.

Jackson can support this if we allow/require addition of “type id”: value that allows deserializer to know which subtype to create instance of. Easiest way is to use annotation `@JsonTypeInfo`, using one of two mechanisms:

```
// enable polymorphic handling for every PhoneNumber-valued property
@JsonTypeInfo(use = Id.CLASS)
// note: there are other ways to register subtypes, too
@JsonSubTypes({ InternationalNumber.class, DomesticNumber.class })
abstract class PhoneNumber {
}// or:
public class Person {
   @JsonTypeInfo(...) // only enable for this property!
   public PhoneNumber phone;
}
```

When doing this, serializer will add a type identifier in JSON (depending on configuration can be additional property, or array or object structure “wrapping” value); and deserializer, conversely, knows to expect this. We will see something like:

```
{ "phone" : {
   "@class" : "package.InternationalNumber",
   "areaCode" : 555,
   ...
  }
}
```

Note that this is just one of the options, regarding type id to include, and mechanism for inclusion. For more information on usage you may want to read:

* <http://www.baeldung.com/jackson-annotations>
* <http://programmerbruce.blogspot.com/2011/05/deserialize-json-with-jackson-into.html>
* <http://www.studytrails.com/java/json/java-jackson-serialization-polymorphism/>

The key part here is that if (and only if!) class name is used as the type id, then sender could send any class name they want to: within limits of type compatibility Jackson deserializer will (try to) create an instance of that type and initialize it by calling setter methods and/or setting values to fields.

# Another Way to Enable Polymorphic Handling in Jackson

So, this is the most common way to enable polymorphic handling for specific properties. But it requires annotating either all polymorphic value types, or all properties (or some combination thereof). This may not be practical, especially with 3rd party value types (although even in those cases it is possible to use this approach, with “mix-in” annotations).

Because of this reason, there is one other way to enable polymorphic handling: “Default Typing”.
Default typing is enabled via `ObjectMapper`:

```
ObjectMapper mapper = new ObjectMapper();
mapper.enableDefaultTyping(); // or one of variants
```

and what it does is equivalent to adding:

```
@JsonTypeInfo(use = Id.CLASS, include = As.WRAPPER_ARRAY)
```

on every property that matches inclusion criteria (which, by default, is `DefaultTyping.OBJECT_AND_NON_CONCRETE`). In our case it would apply this to all properties with `abstract` type value, including `PhoneNumber`.

# So Is Polymorphic Handling Always Dangerous?

So far so good. With polymorphic handling attacker can potentially produce types of values that service did not mean to allow. However, this does NOT yet mean she can use actual Gadget types — remember that type to use MUST match base type. This particular case is not yet problematic, unless you happen to find a sub-class of `PhoneNumber` that is a serialization gadget — which is unlikely (or more importantly, unlikely that attacker would know such a class is available).

So we have to make another change to declaration:

```
public class Person {
  @JsonTypeInfo(use = Id.CLASS)
  public Object phone;
}
```

Why is this important? Because all Java classes are instances of `Object`, so now attacker can select from a wide selection of documented “gadgets”. Although only from a set that works with Jackson’s setter/field assignment (some attacks only work against JDK serialization, or against other serialization frameworks).

Also note that some other “tag” types can be similarly problematic:

* `java.util.Serializable` is implemented by many types (including many Gadget classes)
* `java.util.Comparable` and `java.lang.Cloneable` are also commonly implemented by various classes

# Is There Anything Jackson Does to Protect You?

So now we know the first 3 pre-requisites for successful exploit. But there is one more requirement.

Given that there is active research to find gadget types, Jackson databind module is being updated, incrementally, to prevent use of these types.
This means, simply put, that deserialization of a set of “well-known” Gadget types is blocked: they can not be read in via polymorphic handling (or actually even with explicit type).

Since inclusion of checks requires releasing of new versions, it is important to try to keep your Jackson version as up-to-date as possible. As of February 2019, latest versions are:

* `2.8.11`
* `2.9.8`

and these have the most recent updates.

To learn more about active development, you may also want to check out issues reported:

* <https://github.com/FasterXML/jackson-databind/labels/CVE>

(note: you may want to include `closed` issues as well as open ones)

# What to do to Protect My System?

Knowing all of above, we know something about general applicability.
So here are some suggestions for further reduce likelihood of successful attacks:

1. Try to keep up with updated versions of Jackson (`jackson-databind`): it should always be safe to upgrade to the latest patch version of given minor version (safest in the sense they should be no breaking changes to functionality)
2. If possible, AVOID enabling default typing (since it is usually class name based). It is better to be explicit about specifying where polymorphism is needed.
3. AVOID using `java.lang.Object` (or, `java.util.Serializable`) as the nominal type of polymorphic values, regardless of whether you use per-type, per-property, or Default Typing
4. If possible USE “type name” and NOT classname as type id: `@JsonTypeInfo(use = Id.NAME)` — this may require annotation of type name (see `@JsonTypeName` and `@JsonSubTypes`)

Especially consider the fact that if you can do either (3) or (4), you will prevent use of this class of exploits.

[Programming](https://medium.com/tag/programming?source=post_page-----54cd0d6e8062--------------------------------)[Java](https://medium.com/tag/java?source=post_page-----54cd0d6e8062--------------------------------)[Security](https://medium.com/tag/security?source=post_page-----54cd0d6e8062--------------------------------)[Cve](https://medium.com/tag/cve?source=post_page-----54cd0d6e8062--------------------------------)[Jackson](https://medium.com/tag/jackson?source=post_page-----54cd0d6e8062--------------------------------)

--

--

5

[![@cowtowncoder](https://miro.medium.com/v2/resize:fill:96:96/1*egRHuiA609Ln_WTBcsg-4A.jpeg)](/?source=post_page---post_author_info--54cd0d6e8062--------------------------------)[![@cowtowncoder](https://miro.medium.com/v2/resize:fill:128:128/1*egRHuiA609Ln_WTBcsg-4A.jpeg)](/?source=post_page---post_author_info--54cd0d6e8062--------------------------------)Follow[## Written by @cowtowncoder](/?source=post_page---post_author_info--54cd0d6e8062--------------------------------)[519 Followers](/followers?source=post_page---post_author_info--54cd0d6e8062--------------------------------)·[21 Following](/following?source=post_page---post_author_info--54cd0d6e8062--------------------------------)

Open Source developer, most known for Jackson data processor (nee “JSON library”), author of many, many other OSS libraries for Java, from ClassMate to Woodstox

Follow
## Responses (5)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----54cd0d6e8062--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----54cd0d6e8062--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----54cd0d6e8062--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----54cd0d6e8062--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----54cd0d6e8062--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----54cd0d6e8062--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----54cd0d6e8062--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----54cd0d6e8062--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----54cd0d6e8062--------------------------------)[Teams](https://medium.com/business?source=post_page-----54cd0d6e8062--------------------------------)



=== Content from github.com_596c5252_20250119_134013.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-wh8g-3j2c-rqj5)

**CVE-2020-35490**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-wh8g-3j2c-rqj5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2020-35490](/advisories/GHSA-wh8g-3j2c-rqj5)

## Serialization gadgets exploit in jackson-databind

High severity

GitHub Reviewed

Published
Dec 9, 2021
to the GitHub Advisory Database
•
Updated Mar 15, 2024

[Vulnerability details](/advisories/GHSA-wh8g-3j2c-rqj5)
[Dependabot alerts
0](/advisories/GHSA-wh8g-3j2c-rqj5/dependabot)

## Package

maven

com.fasterxml.jackson.core:jackson-databind
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

>= 2.0.0, <= 2.9.10.7

## Patched versions

2.9.10.8

## Description

FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the interaction between serialization gadgets and typing, related to org.apache.commons.dbcp2.datasources.PerUserPoolDataSource.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-35490>
* [FasterXML/jackson-databind#2986](https://github.com/FasterXML/jackson-databind/issues/2986)
* <https://cowtowncoder.medium.com/on-jackson-cves-dont-panic-here-is-what-you-need-to-know-54cd0d6e8062>
* <https://lists.debian.org/debian-lts-announce/2021/04/msg00025.html>
* <https://www.oracle.com/security-alerts/cpuApr2021.html>
* <https://www.oracle.com//security-alerts/cpujul2021.html>
* <https://www.oracle.com/security-alerts/cpuoct2021.html>
* <https://www.oracle.com/security-alerts/cpujan2022.html>
* <https://www.oracle.com/security-alerts/cpuapr2022.html>
* <https://www.oracle.com/security-alerts/cpujul2022.html>
* [FasterXML/jackson-databind@41b8bdb](https://github.com/FasterXML/jackson-databind/commit/41b8bdb5ccc1d8edb71acf1c8234da235a24249d)
* <https://security.netapp.com/advisory/ntap-20210122-0005>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-35490)
Dec 17, 2020

Reviewed
Apr 8, 2021

Published to the GitHub Advisory Database
Dec 9, 2021

Last updated
Mar 15, 2024

### Severity

High

8.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.305%
 (70th percentile)

### Weaknesses

[CWE-502](/advisories?query=cwe%3A502)

### CVE ID

CVE-2020-35490

### GHSA ID

GHSA-wh8g-3j2c-rqj5

### Source code

[FasterXML/jackson-databind](https://github.com/FasterXML/jackson-databind)

### Credits

* [![@sunSUNQ](https://avatars.githubusercontent.com/u/33311698?s=40&v=4)](/sunSUNQ)
  [sunSUNQ](/sunSUNQ)
  Analyst

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-wh8g-3j2c-rqj5/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_4edeccbe_20250119_115434.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFasterXML%2Fjackson-databind%2Fissues%2F2986)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FFasterXML%2Fjackson-databind%2Fissues%2F2986)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=FasterXML%2Fjackson-databind)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[FasterXML](/FasterXML)
/
**[jackson-databind](/FasterXML/jackson-databind)**
Public

* [Notifications](/login?return_to=%2FFasterXML%2Fjackson-databind) You must be signed in to change notification settings
* [Fork
  1.4k](/login?return_to=%2FFasterXML%2Fjackson-databind)
* [Star
   3.5k](/login?return_to=%2FFasterXML%2Fjackson-databind)

* [Code](/FasterXML/jackson-databind)
* [Issues
  445](/FasterXML/jackson-databind/issues)
* [Pull requests
  12](/FasterXML/jackson-databind/pulls)
* [Discussions](/FasterXML/jackson-databind/discussions)
* [Actions](/FasterXML/jackson-databind/actions)
* [Projects
  0](/FasterXML/jackson-databind/projects)
* [Wiki](/FasterXML/jackson-databind/wiki)
* [Security](/FasterXML/jackson-databind/security)
* [Insights](/FasterXML/jackson-databind/pulse)

Additional navigation options

* [Code](/FasterXML/jackson-databind)
* [Issues](/FasterXML/jackson-databind/issues)
* [Pull requests](/FasterXML/jackson-databind/pulls)
* [Discussions](/FasterXML/jackson-databind/discussions)
* [Actions](/FasterXML/jackson-databind/actions)
* [Projects](/FasterXML/jackson-databind/projects)
* [Wiki](/FasterXML/jackson-databind/wiki)
* [Security](/FasterXML/jackson-databind/security)
* [Insights](/FasterXML/jackson-databind/pulse)

# Block 2 more gadget types (commons-dbcp2, CVE-2020-35490/CVE-2020-35491) #2986

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Block 2 more gadget types (commons-dbcp2, CVE-2020-35490/CVE-2020-35491)](#top)#2986Copy linkLabels[CVEIssues related to public CVEs (security vuln reports)](https://github.com/FasterXML/jackson-databind/issues?q=state%3Aopen%20label%3A%22CVE%22)Issues related to public CVEs (security vuln reports)Milestone[2.9.10.8](https://github.com/FasterXML/jackson-databind/milestone/125)![@cowtowncoder](https://avatars.githubusercontent.com/u/55065?u=fdce6737a39cbda5176c8aa3bda56c2bf95190f0&v=4&size=80)
## Description

![@cowtowncoder](https://avatars.githubusercontent.com/u/55065?u=fdce6737a39cbda5176c8aa3bda56c2bf95190f0&v=4&size=48)[cowtowncoder](https://github.com/cowtowncoder)opened [on Dec 14, 2020](https://github.com/FasterXML/jackson-databind/issues/2986#issue-766957739)

Another gadget type(s) reported regarding class(es) of `org.apache.commons:commons-dbcp2`. library.

See [https://medium.com/@cowtowncoder/on-jackson-cves-dont-panic-here-is-what-you-need-to-know-54cd0d6e8062](https://medium.com/%40cowtowncoder/on-jackson-cves-dont-panic-here-is-what-you-need-to-know-54cd0d6e8062) for description of the general problem.

Reporter(s): Al1ex@knownsec

Mitre ids:

\* [CVE-2020-35490](https://github.com/advisories/GHSA-wh8g-3j2c-rqj5 "CVE-2020-35490")

\* [CVE-2020-35491](https://github.com/advisories/GHSA-r3gr-cxrf-hg25 "CVE-2020-35491")

Fix is included in:

* 2.9.10.8 (usable via `jackson-bom` version `2.9.10.20210106`)
* 2.6.7.5
* Not considered valid CVE for Jackson 2.10.0 and later (see [https://medium.com/@cowtowncoder/jackson-2-10-safe-default-typing-2d018f0ce2ba](https://medium.com/%40cowtowncoder/jackson-2-10-safe-default-typing-2d018f0ce2ba))
## Metadata

### Assignees

No one assigned

### Labels

[CVEIssues related to public CVEs (security vuln reports)](https://github.com/FasterXML/jackson-databind/issues?q=state%3Aopen%20label%3A%22CVE%22)Issues related to public CVEs (security vuln reports)
### Type

No type
### Projects

No projects
### Milestone

* [2.9.10.8](https://github.com/FasterXML/jackson-databind/milestone/125)
### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_142bf956_20250119_115434.html ===


---

[[Date Prev](msg00024.html)][[Date Next](msg00026.html)]
[[Thread Prev](msg00024.html)][[Thread Next](msg00026.html)]
[[Date Index](maillist.html#00025)]
[[Thread Index](threads.html#00025)]

# [SECURITY] [DLA 2638-1] jackson-databind security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2638-1] jackson-databind security update
* *From*: Utkarsh Gupta <utkarsh@debian.org>
* *Date*: Sun, 25 Apr 2021 02:20:12 +0530
* *Message-id*: <[[🔎]](/msgid-search/CAPP0f979Yy-G86fyfk0kgftijqUxaun1UmwFk_Y-3H%2BQDaiRLw%40mail.gmail.com) [CAPP0f979Yy-G86fyfk0kgftijqUxaun1UmwFk\_Y-3H+QDaiRLw@mail.gmail.com](msg00025.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -----------------------------------------------------------------------
Debian LTS Advisory DLA-2638-1              debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Utkarsh Gupta
April 25, 2021                              <https://wiki.debian.org/LTS>
- -----------------------------------------------------------------------

Package        : jackson-databind
Version        : 2.8.6-1+deb9u9
CVE ID         : CVE-2020-24616 CVE-2020-24750 CVE-2020-35490
                 CVE-2020-35491 CVE-2020-35728 CVE-2020-36179
                 CVE-2020-36180 CVE-2020-36181 CVE-2020-36182
                 CVE-2020-36183 CVE-2020-36184 CVE-2020-36185
                 CVE-2020-36186 CVE-2020-36187 CVE-2020-36188
                 CVE-2020-36189 CVE-2021-20190

Multiple security vulnerabilities were found in Jackson Databind.

CVE-2020-24616

     FasterXML jackson-databind 2.x before 2.9.10.6 mishandles the
     interaction between serialization gadgets and typing, related
     to br.com.anteros.dbcp.AnterosDBCPDataSource (aka Anteros-DBCP).

CVE-2020-24750

    FasterXML jackson-databind 2.x before 2.9.10.6 mishandles the
    interaction between serialization gadgets and typing, related
    to com.pastdev.httpcomponents.configuration.JndiConfiguration.

CVE-2020-25649

    A flaw was found in FasterXML Jackson Databind, where it did not
    have entity expansion secured properly. This flaw allows
    vulnerability to XML external entity (XXE) attacks. The highest
    threat from this vulnerability is data integrity.

CVE-2020-35490

    FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the
    interaction between serialization gadgets and typing, related
    to org.apache.commons.dbcp2.datasources.PerUserPoolDataSource.

CVE-2020-35491

    FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the
    interaction between serialization gadgets and typing, related
    to org.apache.commons.dbcp2.datasources.SharedPoolDataSource.

CVE-2020-35728

    FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the
    interaction between serialization gadgets and typing, related to
    com.oracle.wls.shaded.org.apache.xalan.lib.sql.JNDIConnectionPool
    (aka embedded Xalan in org.glassfish.web/javax.servlet.jsp.jstl).

CVE-2020-36179

    FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the
    interaction between serialization gadgets and typing, related
    to oadd.org.apache.commons.dbcp.cpdsadapter.DriverAdapterCPDS.

CVE-2020-36180

    FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the
    interaction between serialization gadgets and typing, related
    to org.apache.commons.dbcp2.cpdsadapter.DriverAdapterCPDS.

CVE-2020-36181

    FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the
    interaction between serialization gadgets and typing, related
    to org.apache.tomcat.dbcp.dbcp.cpdsadapter.DriverAdapterCPDS.

CVE-2020-36182

    FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the
    interaction between serialization gadgets and typing, related
    to org.apache.tomcat.dbcp.dbcp2.cpdsadapter.DriverAdapterCPDS.

CVE-2020-36183

    FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the
    interaction between serialization gadgets and typing, related
    to org.docx4j.org.apache.xalan.lib.sql.JNDIConnectionPool.

CVE-2020-36184

    FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the
    interaction between serialization gadgets and typing, related to
    org.apache.tomcat.dbcp.dbcp2.datasources.PerUserPoolDataSource.

CVE-2020-36185

    FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the
    interaction between serialization gadgets and typing, related to
    org.apache.tomcat.dbcp.dbcp2.datasources.SharedPoolDataSource.

CVE-2020-36186

    FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the
    interaction between serialization gadgets and typing, related to
    org.apache.tomcat.dbcp.dbcp.datasources.PerUserPoolDataSource.

CVE-2020-36187

    FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the
    interaction between serialization gadgets and typing, related to
    org.apache.tomcat.dbcp.dbcp.datasources.SharedPoolDataSource.

CVE-2020-36188

    FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the
    interaction between serialization gadgets and typing, related to
    com.newrelic.agent.deps.ch.qos.logback.core.db.JNDICS.

CVE-2020-36189

    FasterXML jackson-databind 2.x before 2.9.10.8 mishandles the
    interaction between serialization gadgets and typing, related to
    com.newrelic.agent.deps.ch.qos.logback.core.db.DMCS.

CVE-2021-20190

    A flaw was found in jackson-databind before 2.9.10.7. FasterXML
    mishandles the interaction between serialization gadgets and
    typing. The highest threat from this vulnerability is to data
    confidentiality and integrity as well as system availability.

For Debian 9 stretch, these problems have been fixed in version
2.8.6-1+deb9u9.

We recommend that you upgrade your jackson-databind packages.

For the detailed security status of jackson-databind please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/jackson-databind>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEbJ0QSEqa5Mw4X3xxgj6WdgbDS5YFAmCEhEQACgkQgj6WdgbD
S5b0phAArpP2x7hIraTYxLJZNipQ+fLfO/psFKiJYMcajpEJ58KOm12m2wDYYDOx
PqWdE4xYDHC9A2voXAf2kOzEssJffYfquM7drKJx2Pi2PoHF0KK56l41buPxFGf5
yA/99egR6itnpmnDsQy1bhbfJS1C1PMJVFr+U0HygQmfWYzbf3YVGYsgz5W0ReJ8
ywSxCkDrEnRW19UL25DvIAb8lldtT3iV9RUGomV1e0Bpy/lQa3QLNfS/K1f61a3U
dsIa+ImqZnNH6zoagiJyFmoOkmpwoAp3QUhQ+fBu/9Lk1ImtpH1ResyDLlp538t6
VjDC0Ib9Nm9s4QOvaW9ut/0pHHVtyGuoZQKmwXSy7Y69mQA/P3fVgCugoIDRBMbE
EkJGyjHLYDPAQmrF9FsBVj+Di181Dv4ALlKUjbvvCZjyA9YGPHd8XpHqmrAW0b9s
ybBGAz0MhgZNlH+ZErLRWPHa+2d0jIp4yKTJPQRDHY+HDeG+q8/lFXYKnDFtLC18
bwXu1ExFGBW16bmdjIiaR7x2OcIBP/hXWSpga+O2Qs1ojfA2NIoM6BKpJw8ZIwtR
jCcgMNmPsc6V47J0zuY/yuBO8FgOq3rjScUpGs+wevaxKx/2hge2jogP8bnth8P6
GAgG7VlQ2VXbPzzHdskzqZqtmLqVZGURBD+qgT9DV1jVLRrnIo0=
=pfKI
-----END PGP SIGNATURE-----

```

---


