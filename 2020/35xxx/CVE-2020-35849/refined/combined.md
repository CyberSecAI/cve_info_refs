=== Content from github.com_81b62cd6_20250119_133331.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fe9fd168c519a46c2cd0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fe9fd168c519a46c2cd0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  77](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/e9fd168c519a46c2cd0f3cb835e9ce5dba77fc4d)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Deny access to revisions if not authorized

[Browse files](/mantisbt/mantisbt/tree/e9fd168c519a46c2cd0f3cb835e9ce5dba77fc4d)
Browse the repository at this point in the history

```
If user is not allowed to view a revisions' parent bug or bugnote,
bug_revision_view_page.php now shows an Access Denied error, instead
of showing the bug Id and Summary (information disclosure).

Fixes #27370
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Dec 30, 2020

1 parent
[57e9b01](/mantisbt/mantisbt/commit/57e9b01ada3ff3fad81294c11e88f2216c802ae5)

commit e9fd168

Showing
**1 changed file**
with
**29 additions**
and
**14 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

43 changes: 29 additions & 14 deletions

43
[bug\_revision\_view\_page.php](#diff-f272267a66d500e1f25877aab6c76abe2c85abfeb10487c630e5860384628d58 "bug_revision_view_page.php")

Show comments

[View file](/mantisbt/mantisbt/blob/e9fd168c519a46c2cd0f3cb835e9ce5dba77fc4d/bug_revision_view_page.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -62,29 +62,30 @@ |
|  |  | $t\_title = ''; |
|  |  |  |
|  |  | if( $f\_bug\_id ) { |
|  |  | $t\_bug\_id = $f\_bug\_id; |
|  |  | $t\_bug\_data = bug\_get( $t\_bug\_id, true ); |
|  |  | $t\_bug\_id = (int)$f\_bug\_id; |
|  |  | $t\_bugnote\_id = false; |
|  |  | $t\_bug\_revisions = bug\_revision\_list( $t\_bug\_id ); |
|  |  |  |
|  |  | $t\_title = lang\_get( 'issue\_id' ) . $t\_bug\_id; |
|  |  |  |
|  |  | } else if( $f\_bugnote\_id ) { |
|  |  | $t\_bug\_id = bugnote\_get\_field( $f\_bugnote\_id, 'bug\_id' ); |
|  |  | $t\_bug\_data = bug\_get( $t\_bug\_id, true ); |
|  |  | } elseif( $f\_bugnote\_id ) { |
|  |  | $t\_bugnote\_id = (int)$f\_bugnote\_id; |
|  |  | $t\_bug\_id = bugnote\_get\_field( $t\_bugnote\_id, 'bug\_id' ); |
|  |  |  |
|  |  | $t\_bug\_revisions = bug\_revision\_list( $t\_bug\_id, REV\_ANY, $f\_bugnote\_id ); |
|  |  |  |
|  |  | $t\_title = lang\_get( 'bugnote' ) . ' ' . $f\_bugnote\_id; |
|  |  |  |
|  |  | } else if( $f\_rev\_id ) { |
|  |  | } elseif( $f\_rev\_id ) { |
|  |  | $t\_bug\_revisions = bug\_revision\_like( $f\_rev\_id ); |
|  |  |  |
|  |  | if( count( $t\_bug\_revisions ) < 1 ) { |
|  |  | trigger\_error( ERROR\_GENERIC, ERROR ); |
|  |  | } |
|  |  |  |
|  |  | $t\_bug\_id = $t\_bug\_revisions[$f\_rev\_id]['bug\_id']; |
|  |  | $t\_bug\_data = bug\_get( $t\_bug\_id, true ); |
|  |  | $t\_rev = $t\_bug\_revisions[$f\_rev\_id]; |
|  |  | $t\_bug\_id = $t\_rev['bug\_id']; |
|  |  | $t\_bugnote\_id = $t\_rev['bugnote\_id']; |
|  |  |  |
|  |  | $t\_title = lang\_get( 'issue\_id' ) . $t\_bug\_id; |
|  |  |  |
| Expand All | | @@ -93,15 +94,33 @@ |
|  |  | exit; |
|  |  | } |
|  |  |  |
|  |  | $t\_bug\_data = bug\_get( $t\_bug\_id, true ); |
|  |  | $t\_project\_id = $t\_bug\_data->project\_id; |
|  |  |  |
|  |  | $t\_view\_bug\_threshold = config\_get( 'view\_bug\_threshold', null, null, $t\_project\_id ); |
|  |  |  |
|  |  | # Make sure user is allowed to view revisions |
|  |  | # If processing a bugnote, we don't need to check bug-level access as it is |
|  |  | # already done at the lower level, and in fact we must not do it as a user may |
|  |  | # be allowed to view their own bugnote's history, but not the parent issue's. |
|  |  | if( $t\_bugnote\_id ) { |
|  |  | if( !access\_can\_view\_bugnote\_revisions( $t\_bugnote\_id ) ) { |
|  |  | access\_denied(); |
|  |  | } |
|  |  | } elseif( $t\_bug\_id && !access\_can\_view\_bug\_revisions( $t\_bug\_id ) ) { |
|  |  | access\_denied(); |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Show Bug revision |
|  |  | \* |
|  |  | \* @param array $p\_revision Bug Revision Data. |
|  |  | \* @return null |
|  |  | \*/ |
|  |  | function show\_revision( array $p\_revision ) { |
|  |  | global $t\_view\_bug\_threshold; |
|  |  | static $s\_can\_drop = null; |
|  |  | static $s\_user\_access = null; |
|  |  |  |
|  |  | if( is\_null( $s\_can\_drop ) ) { |
|  |  | $s\_can\_drop = access\_has\_bug\_level( config\_get( 'bug\_revision\_drop\_threshold' ), $p\_revision['bug\_id'] ); |
| Expand All | | @@ -118,11 +137,7 @@ function show\_revision( array $p\_revision ) { |
|  |  | $t\_label = lang\_get( 'additional\_information' ); |
|  |  | break; |
|  |  | case REV\_BUGNOTE: |
|  |  | if( is\_null( $s\_user\_access ) ) { |
|  |  | $s\_user\_access = access\_has\_bug\_level( config\_get( 'private\_bugnote\_threshold' ), $p\_revision['bug\_id'] ); |
|  |  | } |
|  |  |  |
|  |  | if( !$s\_user\_access ) { |
|  |  | if( !access\_has\_bugnote\_level( $t\_view\_bug\_threshold, $p\_revision['bugnote\_id'] ) ) { |
|  |  | return null; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e9fd168`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fe9fd168c519a46c2cd0) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_60de93ee_20250119_133332.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fe9fd168c519a46c2cd0f3cb835e9ce5dba77fc4d)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fe9fd168c519a46c2cd0f3cb835e9ce5dba77fc4d)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  77](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/e9fd168c519a46c2cd0f3cb835e9ce5dba77fc4d)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Deny access to revisions if not authorized

[Browse files](/mantisbt/mantisbt/tree/e9fd168c519a46c2cd0f3cb835e9ce5dba77fc4d)
Browse the repository at this point in the history

```
If user is not allowed to view a revisions' parent bug or bugnote,
bug_revision_view_page.php now shows an Access Denied error, instead
of showing the bug Id and Summary (information disclosure).

Fixes #27370
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Dec 30, 2020

1 parent
[57e9b01](/mantisbt/mantisbt/commit/57e9b01ada3ff3fad81294c11e88f2216c802ae5)

commit e9fd168

Showing
**1 changed file**
with
**29 additions**
and
**14 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

43 changes: 29 additions & 14 deletions

43
[bug\_revision\_view\_page.php](#diff-f272267a66d500e1f25877aab6c76abe2c85abfeb10487c630e5860384628d58 "bug_revision_view_page.php")

Show comments

[View file](/mantisbt/mantisbt/blob/e9fd168c519a46c2cd0f3cb835e9ce5dba77fc4d/bug_revision_view_page.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -62,29 +62,30 @@ |
|  |  | $t\_title = ''; |
|  |  |  |
|  |  | if( $f\_bug\_id ) { |
|  |  | $t\_bug\_id = $f\_bug\_id; |
|  |  | $t\_bug\_data = bug\_get( $t\_bug\_id, true ); |
|  |  | $t\_bug\_id = (int)$f\_bug\_id; |
|  |  | $t\_bugnote\_id = false; |
|  |  | $t\_bug\_revisions = bug\_revision\_list( $t\_bug\_id ); |
|  |  |  |
|  |  | $t\_title = lang\_get( 'issue\_id' ) . $t\_bug\_id; |
|  |  |  |
|  |  | } else if( $f\_bugnote\_id ) { |
|  |  | $t\_bug\_id = bugnote\_get\_field( $f\_bugnote\_id, 'bug\_id' ); |
|  |  | $t\_bug\_data = bug\_get( $t\_bug\_id, true ); |
|  |  | } elseif( $f\_bugnote\_id ) { |
|  |  | $t\_bugnote\_id = (int)$f\_bugnote\_id; |
|  |  | $t\_bug\_id = bugnote\_get\_field( $t\_bugnote\_id, 'bug\_id' ); |
|  |  |  |
|  |  | $t\_bug\_revisions = bug\_revision\_list( $t\_bug\_id, REV\_ANY, $f\_bugnote\_id ); |
|  |  |  |
|  |  | $t\_title = lang\_get( 'bugnote' ) . ' ' . $f\_bugnote\_id; |
|  |  |  |
|  |  | } else if( $f\_rev\_id ) { |
|  |  | } elseif( $f\_rev\_id ) { |
|  |  | $t\_bug\_revisions = bug\_revision\_like( $f\_rev\_id ); |
|  |  |  |
|  |  | if( count( $t\_bug\_revisions ) < 1 ) { |
|  |  | trigger\_error( ERROR\_GENERIC, ERROR ); |
|  |  | } |
|  |  |  |
|  |  | $t\_bug\_id = $t\_bug\_revisions[$f\_rev\_id]['bug\_id']; |
|  |  | $t\_bug\_data = bug\_get( $t\_bug\_id, true ); |
|  |  | $t\_rev = $t\_bug\_revisions[$f\_rev\_id]; |
|  |  | $t\_bug\_id = $t\_rev['bug\_id']; |
|  |  | $t\_bugnote\_id = $t\_rev['bugnote\_id']; |
|  |  |  |
|  |  | $t\_title = lang\_get( 'issue\_id' ) . $t\_bug\_id; |
|  |  |  |
| Expand All | | @@ -93,15 +94,33 @@ |
|  |  | exit; |
|  |  | } |
|  |  |  |
|  |  | $t\_bug\_data = bug\_get( $t\_bug\_id, true ); |
|  |  | $t\_project\_id = $t\_bug\_data->project\_id; |
|  |  |  |
|  |  | $t\_view\_bug\_threshold = config\_get( 'view\_bug\_threshold', null, null, $t\_project\_id ); |
|  |  |  |
|  |  | # Make sure user is allowed to view revisions |
|  |  | # If processing a bugnote, we don't need to check bug-level access as it is |
|  |  | # already done at the lower level, and in fact we must not do it as a user may |
|  |  | # be allowed to view their own bugnote's history, but not the parent issue's. |
|  |  | if( $t\_bugnote\_id ) { |
|  |  | if( !access\_can\_view\_bugnote\_revisions( $t\_bugnote\_id ) ) { |
|  |  | access\_denied(); |
|  |  | } |
|  |  | } elseif( $t\_bug\_id && !access\_can\_view\_bug\_revisions( $t\_bug\_id ) ) { |
|  |  | access\_denied(); |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Show Bug revision |
|  |  | \* |
|  |  | \* @param array $p\_revision Bug Revision Data. |
|  |  | \* @return null |
|  |  | \*/ |
|  |  | function show\_revision( array $p\_revision ) { |
|  |  | global $t\_view\_bug\_threshold; |
|  |  | static $s\_can\_drop = null; |
|  |  | static $s\_user\_access = null; |
|  |  |  |
|  |  | if( is\_null( $s\_can\_drop ) ) { |
|  |  | $s\_can\_drop = access\_has\_bug\_level( config\_get( 'bug\_revision\_drop\_threshold' ), $p\_revision['bug\_id'] ); |
| Expand All | | @@ -118,11 +137,7 @@ function show\_revision( array $p\_revision ) { |
|  |  | $t\_label = lang\_get( 'additional\_information' ); |
|  |  | break; |
|  |  | case REV\_BUGNOTE: |
|  |  | if( is\_null( $s\_user\_access ) ) { |
|  |  | $s\_user\_access = access\_has\_bug\_level( config\_get( 'private\_bugnote\_threshold' ), $p\_revision['bug\_id'] ); |
|  |  | } |
|  |  |  |
|  |  | if( !$s\_user\_access ) { |
|  |  | if( !access\_has\_bugnote\_level( $t\_view\_bug\_threshold, $p\_revision['bugnote\_id'] ) ) { |
|  |  | return null; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e9fd168`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2Fe9fd168c519a46c2cd0f3cb835e9ce5dba77fc4d) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from mantisbt.org_7f6a801f_20250119_114607.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D27370)
[Signup for a new account](/bugs/signup_page.php)

#### View Issue Details

[Wiki](wiki.php?id=27370)[Related Changesets](#changesets)[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0027370 | mantisbt | security | public | 2020-10-02 03:29 | 2023-10-02 11:24 |
|  | | | | | |
|
| Reporter | [d3vpoo1](https://mantisbt.org/bugs/view_user_page.php?id=49593) | Assigned To | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) |  | |
| Priority | high | Severity | major | Reproducibility | always |
| Status | closed | Resolution | fixed |  | |
| Platform | Windows | OS | Windows | OS Version | Windows10 |
| Product Version | 2.24.3 |  | | | |
| Target Version | 2.24.4 | Fixed in Version | 2.24.4 |  | |
|  | | | | | |
|
| Summary | 0027370: CVE-2020-35849: Revisions allow viewing private bugnotes id and summary | | | | |
| Description | I recheck my old reports/issue and I observe that in default MantisBT instance the developer can only edit the revision `$g_update_bugnote_threshold = DEVELOPER;` which means the developer can edit the bugnote submitted by reporter. However other role can view (and even developer) a private `bugnote` included on a private project.  **Note :** I create a new instance of MantisBT again to prevent/stop my old configuration  This is almost the same as the report that I submitted before however this one disclose the `bugnote` | | | | |
| Steps To Reproduce | * As admin create two project, one private and a public project * Report an issue to a private project * add a new bugnote, its up to you if you will set this `bugnote` to `private` however at this point other user with non-admin role shouldn't access this because its a private project (for this scenario I will just set the `bugnote` to private which can help us "double" the status of view) * as a reporter,report an issue to our public project * add a bugnote  Exploit  * go to your developer account and edit that `bugnote` submitted by reporter   **Request**  ``` POST /test/bugnote_update.php HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 119 Origin: http://localhost Connection: close Referer: http://localhost/test/bugnote_edit_page.php Cookie: MANTIS_secure_session=1; PHPSESSID=d1eb6er2hsedj13e2pi6tjqde9; MANTIS_STRING_COOKIE=S7B36suzGTmS3fWaoJskDFJK2HKV4ugkq7hcA3GX6JEATGrijwA5ce94ic6ZJlxm; MANTIS_PROJECT_COOKIE=2 Upgrade-Insecure-Requests: 1  bugnote_update_token=20201002r_0p5xlSfr-c2RSyBuBuqD71SD2hvVLJ&bugnote_id=1&bugnote_text=I+will+edit+this+as+a+developer ```  **Response**  ``` HTTP/1.1 302 Found Date: Fri, 02 Oct 2020 06:58:43 GMT Server: Apache/2.4.41 (Win64) OpenSSL/1.0.2s PHP/7.1.33 X-Powered-By: PHP/7.1.33 Cache-Control: no-store, no-cache, must-revalidate Last-Modified: Fri, 02 Oct 2020 06:58:43 GMT X-Content-Type-Options: nosniff Expires: Fri, 02 Oct 2020 06:58:43 GMT X-Frame-Options: DENY Content-Security-Policy: default-src 'self'; frame-ancestors 'none'; style-src 'self' 'unsafe-inline'; script-src 'self'; img-src 'self' 'self' data: Location: http://localhost/test/view.php?id=1#bugnotes Vary: Accept-Encoding Content-Length: 0 Connection: close Content-Type: text/html; charset=utf-8 ```  * After that, the "View all revisions" will appear * Click it * Now you will redirect to `/bug_revision_view_page.php?bugnote_id=<SOME_ID>` * change the value of <SOME\_ID> to anything and you will successfully disclose the `private bugnotes`  Verification method  * to verify more I use other role like `viewer`, `reporter`, `manager` (possible the other role too) and they can access the `bug_note` | | | | |
| Additional Information | I ran diff on default config file and to my testing config file and no result produce   * Will follow up a PoC script | | | | |
| Tags | No tags attached. | | | | |
|  | | | | | |
|

#### Relationships

[Relationship Graph](bug_relationship_graph.php?bug_id=27370&graph=relation)[Dependency Graph](bug_relationship_graph.php?bug_id=27370&graph=dependency)

| related to | [0020690](view.php?id=20690) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | inconsistent UI for view bugnote revision |
| --- | --- | --- | --- | --- |
| related to | [0032980](view.php?id=32980) | closed |  | Information leakage: summary on bug revision note |

#### Activities

| [d3vpoo1](https://mantisbt.org/bugs/view_user_page.php?id=49593)   [d3vpoo1](https://mantisbt.org/bugs/view_user_page.php?id=49593)  2020-10-02 06:14  reporter    [~0064516](view.php?id=27370#c64516 "Direct link to note") | Hi ! After observing this and comparing to my last report, this only allows the attacker to disclose the summary and not the bug note. This is not duplicate issue of previous report because this can be found on different endpoint.. I get confused I thought the one that I disclose is the `bugnote` but I just disclose the `summary` via `bug_revision_view_page.php?bugnote_id=<VULN>` apologize |
| --- | --- |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2020-11-22 19:35  developer    [~0064683](view.php?id=27370#c64683 "Direct link to note") | this only allows the attacker to disclose the summary and not the bug note  Confirmed.  When you refer to "my last report", considering you have reported more than 10 of them, I guess you mean [0027039](/bugs/view.php?id=27039 "[closed] CVE-2020-25781: Access to private bug note attachments") ? |
|  | |
| [d3vpoo1](https://mantisbt.org/bugs/view_user_page.php?id=49593)   [d3vpoo1](https://mantisbt.org/bugs/view_user_page.php?id=49593)  2020-11-22 21:08  reporter    [~0064684](view.php?id=27370#c64684 "Direct link to note") | I forgot which issue but I guess I refer it to <https://mantisbt.org/bugs/view.php?id=27357> |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2020-12-05 21:12  developer    [~0064749](view.php?id=27370#c64749 "Direct link to note")  Last edited: 2020-12-06 06:46 | While working on the fix for this issue, I realized that low-privileged users can view the revisions when accessing bug\_revision\_view\_page.php directly, but they are not shown the *View Revisions* link on bugnote page, because the ability to view bugnote revisions is driven by *private\_bugnote\_threshold* config.  This inconsistency was previously reported in [0020690](/bugs/view.php?id=20690 "[closed] inconsistent UI for view bugnote revision"), so now is a good time to fix this. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2020-12-06 11:08  developer    [~0064757](view.php?id=27370#c64757 "Direct link to note") | That one was a bit more complex to fix than I had anticipated... |
|  | |
| [d3vpoo1](https://mantisbt.org/bugs/view_user_page.php?id=49593)   [d3vpoo1](https://mantisbt.org/bugs/view_user_page.php?id=49593)  2020-12-11 10:21  reporter    [~0064786](view.php?id=27370#c64786 "Direct link to note") | Is this one getting a CVE? |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2020-12-30 05:03  developer    [~0064865](view.php?id=27370#c64865 "Direct link to note") | CVE-2020-35849 assigned via request 1007235 |
|  | |

#### Related Changesets

| MantisBT: master e9fd168c  2020-12-06 05:32  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=25424) [Diff](https://github.com/mantisbt/mantisbt/commit/e9fd168c519a46c2cd0f3cb835e9ce5dba77fc4d) | Deny access to revisions if not authorized | | Affected Issues[0027370](/bugs/view.php?id=27370 "[closed] CVE-2020-35849: Revisions allow viewing private bugnotes id and summary") |
| --- | --- | --- | --- |
| mod - bug\_revision\_view\_page.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/e9fd168c519a46c2cd0f3cb835e9ce5dba77fc4d) [File](https://github.com/mantisbt/mantisbt/blob/e9fd168c519a46c2cd0f3cb835e9ce5dba77fc4d/bug_revision_view_page.php) |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1850 seconds



=== Content from mantisbt.org_7b46b536_20250119_133333.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview_user_page.php%3Fid%3D17784)
[Signup for a new account](/bugs/signup_page.php)

#### User Information

| Username | dregad |
| --- | --- |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1565 seconds


