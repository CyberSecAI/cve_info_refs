Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2020-35125:

**Root Cause of Vulnerability:**

*   The vulnerability stems from the way Mautic handles and displays referrer information. Specifically, the application captures the HTTP Referer header when a user downloads an asset or submits a form, and this data is later displayed in various reports within the Mautic admin interface.
*   The application does not properly sanitize the referrer information, allowing an attacker to inject malicious JavaScript code via the HTTP Referer header or the `mautic[return]` form variable.

**Weaknesses/Vulnerabilities Present:**

*   **Cross-Site Scripting (XSS):** The core vulnerability is a stored XSS flaw. An attacker can inject malicious scripts through the Referer header or the `mautic[return]` form variable, which is then stored in the database. When a legitimate admin user views reports that display this data, the injected script executes in their browser session.
*   **Insecure Direct Object Reference (IDOR):** While not directly the cause of the XSS, the ability to easily enumerate assets and forms using incrementing integer IDs allows an attacker to target specific forms and assets for XSS attacks, making the attack surface larger.

**Impact of Exploitation:**

*   **Unauthorized Admin Access:** By exploiting the XSS vulnerability, an attacker can execute arbitrary JavaScript code in the context of a legitimate Mautic admin user's session. This enables the attacker to perform actions within the Mautic application with admin privileges, including creating new admin users, which was the specific example provided.
*   **Remote Code Execution (RCE):**  After obtaining admin access, an attacker can upload a malicious custom theme containing PHP code, leading to arbitrary code execution on the server hosting the application.
*   **Data Manipulation:** With admin access, an attacker could alter marketing campaigns, manipulate lead data, and potentially exfiltrate sensitive information.

**Attack Vectors:**

*   **HTTP Referer Header Manipulation:** An attacker can manipulate the HTTP Referer header when requesting an asset download, injecting the XSS payload.
*  **Form Submission with Malicious `mautic[return]` Parameter:** An attacker can submit a form with a malicious XSS payload in the `mautic[return]` variable.
*   **Direct Interaction with Mautic:** The attacker doesn't need to be authenticated, they just need to make requests to the vulnerable endpoints (asset download links or forms)

**Required Attacker Capabilities/Position:**

*   **No Authentication Required:** The attacker does not need any credentials to exploit the XSS vulnerability. The attacker simply needs to make requests to the publicly accessible asset download links or forms.
*   **Basic Web Request Skills:** The attacker must be able to send HTTP requests with custom headers (for the Referer attack) or craft a form submission with a malicious `mautic[return]` value.
*   **Knowledge of Mautic or basic enumeration skills:** The attacker needs to find a valid asset ID or form ID, but these are easily discovered through enumeration due to IDOR.

**Additional Notes:**

* The vulnerability was reported by Naveen Sunkavally at Horizon3.ai.
* Patches were released in Mautic versions 2.16.5 and 3.2.4.
* The exploit could be chained into RCE by creating an admin account via XSS and then uploading a malicious theme.
* The report also included searches that could be performed to identify possible exploit attempts.
* The vulnerability is considered "Highly Critical" due to the ease of exploitation and the potential for complete system compromise.