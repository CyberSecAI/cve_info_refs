## CVE-2020-35944

The provided content discusses a Cross-Site Request Forgery (CSRF) to Stored Cross-Site Scripting (XSS) vulnerability in the PageLayer WordPress plugin.

**Root Cause:**

*   The PageLayer plugin's settings update function lacked CSRF protection. While the function checked for user capabilities to ensure the user had permission to make changes, it did not verify the legitimacy of the request itself.

**Vulnerability:**

*   **CSRF:** Absence of CSRF protection in the settings update function.
*   **Stored XSS:** Lack of sanitization on the address and telephone number settings within the "Information" tab of the plugin's settings. These settings allowed administrators (who have the `unfiltered_html` capability) to inject JavaScript.

**Attack Vectors:**

*   An attacker could trick a site administrator into submitting a crafted request that modified the PageLayer settings (CSRF).
*   The malicious request would inject JavaScript code into the address or telephone number settings.

**Impact:**

*   Successful exploitation allowed attackers to inject malicious scripts into the website.
*   The injected scripts could execute whenever someone browsed to a page containing a widget that used the vulnerable settings or when an administrator started editing and inserting the widget.
*   The impact includes potential actions like creating new administrative accounts or redirecting users to malicious sites.

**Attacker Capabilities:**

*   The attacker needs to trick an administrator into clicking a malicious link or visiting a malicious website while logged into the WordPress admin panel. This is a standard CSRF attack scenario.

**Affected Versions:**

*   <= 1.1.1

**Patched Version:**

*   1.1.2

**Patch Details:**

*   The developers implemented CSRF protection by adding a WordPress nonce and verifying it when updating settings.