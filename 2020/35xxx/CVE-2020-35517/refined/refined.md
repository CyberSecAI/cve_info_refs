Based on the provided content, here's an analysis of CVE-2020-35517:

**1. Verification of CVE relevance:**

The provided content directly references CVE-2020-35517 and describes a vulnerability in the virtiofsd component of QEMU, which aligns with the official descriptions of this CVE.

**2. Root cause of the vulnerability:**
The root cause is the lack of proper checks in virtiofsd when opening files through FUSE. Specifically, the daemon was not verifying if the inode being opened was a regular file or directory, leading to the possibility of opening special files, such as device nodes, from the guest.

**3. Weaknesses/vulnerabilities present:**
- **Insecure File Opening:** virtiofsd failed to validate the type of inode before opening it, allowing the opening of special files.
- **Lack of Input Validation:** The daemon lacked input validation on file opening requests from the guest.

**4. Impact of exploitation:**
- **Host Privilege Escalation:** A malicious guest user could create a device special file in a shared directory, then use it to access host devices. This allows for potentially arbitrary read/write access to host files.
- **Denial of Service (DoS):** Exploiting this vulnerability may lead to a denial-of-service scenario on the host system.
- **Data Confidentiality and Integrity Compromise**: The guest might gain access to sensitive host data or be able to modify data.
- **System Availability Impact**: Arbitrary access to host files can cause DoS scenarios, impacting system availability.

**5. Attack vectors:**

- **FUSE Interface:** The vulnerability is exposed through the FUSE interface, where the guest interacts with the host's virtiofsd.
- **Modified Guest Device Driver:** A modified guest device driver can be used to send malicious FUSE requests.

**6. Required attacker capabilities/position:**
- **Privileged Guest Access:** The attacker must have privileged access within the guest operating system to exploit this vulnerability.
- **Ability to send crafted FUSE requests:** The attacker must be able to control and modify the FUSE requests sent to virtiofsd.

**Additional details:**

*   The vulnerability exists because, in the past, the daemon created a temporary directory where /proc/self/fd was bind-mounted to avoid /proc/self/fd escapes, but this workaround failed when the file system was read-only. This led to bind-mounting /proc/self/fd over /proc, which introduced the vulnerability when the checks on the inode type were not implemented.
*   The initial fix, described in the provided patch, involves adding checks to prevent virtiofsd from opening special files, especially through the FUSE\_OPEN operation.
*   A long-term solution involves mounting the shared directory with `nodev`, `nosuid`, and `noexec` options. It's also suggested to modify libvirt and Kata Containers to explicitly set these mount options. Virtiofsd should then check for these options at startup and refuse to start if they are missing, making the security requirements explicit.
*   User namespaces are also suggested for an unprivileged/privilege-separated mode, although with some security xattrs limitations.

**In summary,** CVE-2020-35517 is a significant vulnerability in QEMU's virtiofsd, allowing a privileged guest user to potentially perform a privilege escalation on the host by creating and opening special files in a shared directory, accessing host resources directly. The vulnerability stems from improper file type validation in the FUSE interface, which can be exploited by crafting specific FUSE requests.