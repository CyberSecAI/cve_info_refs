```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability is caused by unsanitized user input in the `helper_ensure_confirmed` function. Specifically, the custom field name, which is user-controlled, is not sanitized before being used in the `helper_ensure_confirmed` function. This lack of sanitization allows for the injection of malicious HTML or JavaScript code.",
    "weaknesses": [
      "Cross-Site Scripting (XSS)",
      "Lack of input sanitization"
    ],
    "impact": "Successful exploitation of the vulnerability allows an attacker to inject arbitrary HTML or JavaScript code into the web page, potentially leading to: session hijacking, phishing attacks, defacement of the website, or other malicious actions on behalf of the user.",
    "attack_vectors": "The vulnerability can be exploited through the `manage_custom_field_update.php` page, where the custom field name, which is user-controlled, is passed to the vulnerable `helper_ensure_confirmed` function without sanitization. The custom field name can be manipulated to include malicious scripts.",
    "required_capabilities": "An attacker needs to have the ability to manipulate custom field names within the MantisBT application. This likely requires an authenticated user account with permissions to manage custom fields."
  },
  "additional_notes": "The provided content references a related issue ([0027779](view.php?id=27779)) which is specifically opened to track this XSS vulnerability with the CVE identifier CVE-2020-35571. The vulnerability was discovered during code review of a fix for another issue. The vulnerable code is present in the `helper_ensure_confirmed` function. The fix for this vulnerability is included in a commit merged to the master branch. The content also mentions that the vulnerability exists in `manage_custom_field_update.php`, where the custom field name is not sanitized before being passed to `helper_ensure_confirmed`."
}
```