=== Content from downloads.asterisk.org_8e87520d_20250119_125726.html ===


Asterisk
Project Security Advisory - AST-2020-004

| **Product** | Asterisk |
| **Summary** | Remote crash in res\_pjsip\_diversion |
| **Nature of Advisory** | Denial of service |
| **Susceptibility** | Remote authenticated sessions |
| **Severity** | Moderate |
| **Exploits Known** | No |
| **Reported On** | December 02, 2020 |
| **Reported By** | Mikhail Ivanov |
| **Posted On** | December 22, 2020 |
| **Last Updated On** | December 23, 2020 |
| **Advisory Contact** | kharwell AT sangoma DOT com |
| **CVE Name** | CVE-2020-35652 |

| **Description** | A crash can occur in Asterisk when a SIP 181 response is received that has a Diversion header, which contains a tel-uri. |
| **Modules Affected** | res\_pjsip\_diversion.c |

| **Resolution** | Asterisk now ensures that if it receives a SIP 181 response with a Diversion header that contains a tel-uri a crash does not occur. |

| **Affected Versions** | | |
| **Product** | **Release Series** |  |
| Asterisk Open Source | 13.X | 13.38.0 |
| Asterisk Open Source | 16.X | 16.15.0 |
| Asterisk Open Source | 17.X | 17.9.0 |
| Asterisk Open Source | 18.X | 18.1.0 |

| **Corrected In** | |
| **Product** | **Release** |
| Asterisk Open Source | 13.38.1, 16.15.1, 17.9.1, 18.1.1 |
|  |  |

| **Patches** | |
| **SVN URL** | **Revision** |
| The associated patches for AST-2020-003 also fix this issue. | Asterisk 13, 16, 17, 18 |

| **Links** | https://issues.asterisk.org/jira/browse/ASTERISK-29191 |
|  | https://downloads.asterisk.org/pub/security/AST-2020-003.html |

| Asterisk Project Security Advisories are posted at <http://www.asterisk.org/security>  This document may be superseded by later versions; if so, the latest version will be posted at http://downloads.digium.com/pub/security/AST-2020-004.pdf and http://downloads.digium.com/pub/security/AST-2020-004.html |

| **Revision History** | | |
| **Date** | **Editor** | **Revisions Made** |
| December 22, 2020 | Kevin Harwell | Initial revision |
| December 23, 2020 | Kevin Harwell | Added CVE |

Asterisk Project Security
Advisory - AST-2020-004

Copyright
Â© 2020
Digium, Inc. All Rights Reserved.

Permission is hereby granted
to distribute and publish this advisory in its original, unaltered
form.



=== Content from downloads.asterisk.org_d0e93a46_20250119_125726.html ===


Asterisk
Project Security Advisory - AST-2020-003

| **Product** | Asterisk |
| **Summary** | Remote crash in res\_pjsip\_diversion |
| **Nature of Advisory** | Denial of service |
| **Susceptibility** | Remote authenticated sessions |
| **Severity** | Moderate |
| **Exploits Known** | Yes |
| **Reported On** | December 22, 2020 |
| **Reported By** | Torrey Searle |
| **Posted On** | December 22, 2020 |
| **Last Updated On** | December 23, 2020 |
| **Advisory Contact** | kharwell AT sangoma DOT com |
| **CVE Name** | CVE-2020-35652 |

| **Description** | A crash can occur in Asterisk when a SIP message is received that has a History-Info header, which contains a tel-uri.    Note, the remote client must be authenticated, or Asterisk must be configured for anonymous calling in order for this problem to manifest. |
| **Modules Affected** | res\_pjsip\_diversion.c |

| **Resolution** | Asterisk now ensures that if it receives a SIP message with a History-Info header that contains a tel-uri the redirecting cause is simply set to unknown. |

| **Affected Versions** | | |
| **Product** | **Release Series** |  |
| Asterisk Open Source | 13.X | 13.38.0 |
| Asterisk Open Source | 16.X | 16.15.0 |
| Asterisk Open Source | 17.X | 17.9.0 |
| Asterisk Open Source | 18.X | 18.1.0 |

| **Corrected In** | |
| **Product** | **Release** |
| Asterisk Open Source | 13.38.1, 16.15.1, 17.9.1, 18.1.1 |
|  |  |

| **Patches** | |
| **SVN URL** | **Revision** |
| https://downloads.asterisk.org/pub/security/AST-2020-003-13.diff | Asterisk 13 |
| https://downloads.asterisk.org/pub/security/AST-2020-003-16.diff | Asterisk 16 |
| https://downloads.asterisk.org/pub/security/AST-2020-003-17.diff | Asterisk 17 |
| https://downloads.asterisk.org/pub/security/AST-2020-003-18.diff | Asterisk 18 |

| **Links** | https://issues.asterisk.org/jira/browse/ASTERISK-29219 |

| Asterisk Project Security Advisories are posted at <http://www.asterisk.org/security>  This document may be superseded by later versions; if so, the latest version will be posted at http://downloads.digium.com/pub/security/AST-2020-003.pdf and http://downloads.digium.com/pub/security/AST-2020-003.html |

| **Revision History** | | |
| **Date** | **Editor** | **Revisions Made** |
| December 22, 2020 | Kevin Harwell | Initial revision |
| December 23. 2020 | Kevin Harwell | Added CVE |

Asterisk Project Security
Advisory - AST-2020-003

Copyright
Â© 2020
Digium, Inc. All Rights Reserved.

Permission is hereby granted
to distribute and publish this advisory in its original, unaltered
form.



=== Content from issues.asterisk.org_b4a79844_20250119_125728.html ===

[[Home](/)]

| Summary: | ASTERISK-29191: tel: URI in Diversion header causes crash | | |
| --- | --- | --- | --- |
| Reporter: | Mikhail Ivanov (mivanov@lanta-net.ru) | Labels: |  |
| Date Opened: | 2020-12-02 08:23:02.000-0600 | Date Closed: | 2020-12-22 16:49:08.000-0600 |
| Priority: | Major | Regression? |  |
| Status: | Closed/Complete | Components: | pjproject/pjsip Resources/res\_pjsip\_diversion |
| Versions: | 16.15.0 | Frequency ofOccurrence | Occasional |
| RelatedIssues: | | is related to | [ASTERISK-29219](/ASTERISK-29219) res\_pjsip\_diversion: Crash if Tel URI contains History-Info | | --- | --- | | | |
| Environment: |  | Attachments: |  |
| Description: | Asterisk crashed sometimes (randomly) | | |
| Comments: | By: Asterisk Team (asteriskteam) 2020-12-02 08:23:03.998-0600Thanks for creating a report! The issue has entered the triage process. That means the issue will wait in this status until a Bug Marshal has an opportunity to review the issue. Once the issue has been reviewed you will receive comments regarding the next steps towards resolution. Please note that log messages and other files should not be sent to the Sangoma Asterisk Team unless explicitly asked for. All files should be placed on this issue in a sanitized fashion as needed.   A good first step is for you to review the [Asterisk Issue Guidelines|https://wiki.asterisk.org/wiki/display/AST/Asterisk+Issue+Guidelines] if you haven't already. The guidelines detail what is expected from an Asterisk issue report.   Then, if you are submitting a patch, please review the [Patch Contribution Process|https://wiki.asterisk.org/wiki/display/AST/Patch+Contribution+Process].   Please note that once your issue enters an open state it has been accepted. As Asterisk is an open source project there is no guarantee or timeframe on when your issue will be looked into. If you need expedient resolution you will need to find and pay a suitable developer. Asking for an update on your issue will not yield any progress on it and will not result in a response. All updates are posted to the issue when they occur.   Please note that by submitting data, code, or documentation to Sangoma through JIRA, you accept the Terms of Use present at [https://www.asterisk.org/terms-of-use/|https://www.asterisk.org/terms-of-use/].  ---   By: Mikhail Ivanov (mivanov@lanta-net.ru) 2020-12-02 08:27:33.495-0600crashdump  ---   By: Sean Bright (seanbright) 2020-12-02 10:37:15.109-0600Diversion header in the response has a {{tel}} URI which causes the crash:   {noformat}  SIP/2.0 181 Call Is Being Forwarded  Via: SIP/2.0/UDP 192.168.51.205:5060;branch=z9hG4bKPjfec9fa52-fc33-4475-8f35-698aa568f3b0;received=192.168.51.205;rport=5060  From: <sip:74752429999@37.235.174.246>;tag=ebc0f9df-6d62-443d-9bfe-7b0dcc913905  To: <sip:74752718801@192.168.51.201>;tag=i801p0D659D0u8  Call-ID: d17fc6e4-278f-4613-9c4c-85840c517a0f  CSeq: 3552 INVITE  Contact: <sip:74752718801@192.168.51.201:5060>  Supported: replaces  Allow: INVITE, ACK, BYE, CANCEL, PRACK, REGISTER, INFO, REFER, NOTIFY, OPTIONS, UPDATE  Diversion: <tel:4952761626>;reason=no-answer;privacy=off  User-Agent: smg\_pa\_sip smg\_pa\_sip-3.10.1.22  Content-Length: 0  {noformat}  ---   By: Kevin Harwell (kharwell) 2020-12-02 16:26:19.224-0600[~seanbright] A most excellent find!   To easily replicate simply alter [this line|https://github.com/asterisk/testsuite/blob/master/tests/channels/pjsip/diversion/diversion\_response\_181/sipp/user2.xml#L15] in the associated testsuite test to contain a \_tel\_ URI and execute.  --- | | |



=== Content from issues.asterisk.org_ed593ff6_20250119_125728.html ===

[[Home](/)]

| Summary: | ASTERISK-29219: res\_pjsip\_diversion: Crash if Tel URI contains History-Info | | |
| --- | --- | --- | --- |
| Reporter: | Torrey Searle (tsearle) | Labels: | security |
| Date Opened: | 2020-12-22 02:33:56.000-0600 | Date Closed: | 2020-12-22 16:49:01.000-0600 |
| Priority: | Blocker | Regression? | Yes |
| Status: | Closed/Complete | Components: | Resources/res\_pjsip\_diversion |
| Versions: | 16.7.0 | Frequency ofOccurrence |  |
| RelatedIssues: | | is related to | [ASTERISK-29191](/ASTERISK-29191) tel: URI in Diversion header causes crash | | --- | --- | | | |
| Environment: |  | Attachments: |  |
| Description: | asterisk does not support tel-uri without reason or cause in History-Info   receiving such a header will result in asterisk crashing.  This patch will check if a tel URI is received and sets the reason to unknown instead of crashing | | |
| Comments: | By: Asterisk Team (asteriskteam) 2020-12-22 02:33:58.749-0600Thanks for creating a report! The issue has entered the triage process. That means the issue will wait in this status until a Bug Marshal has an opportunity to review the issue. Once the issue has been reviewed you will receive comments regarding the next steps towards resolution. Please note that log messages and other files should not be sent to the Sangoma Asterisk Team unless explicitly asked for. All files should be placed on this issue in a sanitized fashion as needed.   A good first step is for you to review the [Asterisk Issue Guidelines|https://wiki.asterisk.org/wiki/display/AST/Asterisk+Issue+Guidelines] if you haven't already. The guidelines detail what is expected from an Asterisk issue report.   Then, if you are submitting a patch, please review the [Patch Contribution Process|https://wiki.asterisk.org/wiki/display/AST/Patch+Contribution+Process].   Please note that once your issue enters an open state it has been accepted. As Asterisk is an open source project there is no guarantee or timeframe on when your issue will be looked into. If you need expedient resolution you will need to find and pay a suitable developer. Asking for an update on your issue will not yield any progress on it and will not result in a response. All updates are posted to the issue when they occur.   Please note that by submitting data, code, or documentation to Sangoma through JIRA, you accept the Terms of Use present at [https://www.asterisk.org/terms-of-use/|https://www.asterisk.org/terms-of-use/].  ---   By: Asterisk Team (asteriskteam) 2020-12-22 02:34:00.653-0600This issue has been automatically restricted and set to a blocker due to being a security type issue. If this is not a security vulnerability issue it will be moved to the appropriate issue type when triaged.  ---   By: Joshua C. Colp (jcolp) 2020-12-22 03:56:24.230-0600Welp, this is already disclosed now since it's up for code review in public.  --- | | |


