Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**

The vulnerability stems from the Widgets extension's use of Smarty templating engine without proper security restrictions. The extension allows users with 'editwidgets' permission to embed Smarty code within widget pages. This, combined with the lack of input sanitization or output escaping, allows them to call arbitrary static functions of any PHP class.

**Weaknesses/Vulnerabilities Present:**

*   **Remote Code Execution (RCE):** The primary vulnerability is the ability to execute arbitrary PHP code by calling static functions on available classes. This can lead to complete control of the server running the vulnerable application.
*   **Missing Authorization (Vuln-MissingAuthz):** The permission 'editwidgets' was not appropriately restricted, allowing users with this permission to perform highly privileged actions.
*   **Direct Object Reference (Vuln-DirectObjectReference):** The vulnerability directly leverages the capability to call static methods, which is an example of a direct object reference.
*  **Insecure Template Handling:** The Smarty templating engine was not configured securely, which allowed for arbitrary code execution.

**Impact of Exploitation:**

An attacker could exploit this vulnerability to:

*   **Exfiltrate sensitive user data:** By calling appropriate functions to access and leak stored data.
*   **Change user passwords:** By modifying user data through function calls.
*   **Read/write arbitrary files on the filesystem:** Enabling access to files and modification of the system.
*   **Run arbitrary shell commands:** Leading to complete server compromise by executing system level commands.
*   **Achieve additional levels of code execution:** By exploiting file write/shell execution capabilities to establish persistence and escalate privileges.

**Attack Vectors:**

*   **Malicious Widget Creation:** An attacker would create a malicious widget page in the `Widget:` namespace with embedded Smarty code, calling a static function to perform a malicious action.
*   **Widget Invocation:** The malicious widget would be invoked on another page using `{{#widget:malicious_widget}}` causing the embedded code to execute when the page is rendered.

**Required Attacker Capabilities/Position:**

*   **'editwidgets' Permission:** The attacker must have the 'editwidgets' permission. This is typically granted to sysops and users in a "widget editors" group.
*   **Knowledge of PHP and MediaWiki:** The attacker must have some knowledge of PHP and MediaWiki in order to craft an effective attack by calling specific methods.

**Additional Details:**

*   The vulnerability is present in the `Widgets` extension for MediaWiki.
*   The provided proof of concept uses `<!--{\MediaWiki\Shell\Shell::command('pwd')->execute()->getStdout()}-->` to demonstrate command execution.
*   The fix involves implementing a `WidgetSecurity` class that extends `Smarty_Security` and applies restrictions to the Smarty template engine, preventing calls to arbitrary static methods.
*   The issue affects multiple third-party wiki farms such as Fandom/Gamepedia.
* Patches were created and merged for `master`, `REL1_35` and `REL1_31` branches of the MediaWiki Widgets extension.

This information provides more specific details than a typical CVE description.