=== Content from discourse.pi-hole.net_7ef647d6_20250119_115614.html ===


![Pi-hole Userspace](data:image/svg;base64...)
Loading

[Pi-hole Userspace](/)

# [Announcements](/c/announcements/5)

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [About the Announcements category](https://discourse.pi-hole.net/t/about-the-announcements-category/17) |  | 0 | 8354 | September 25, 2016 |
| [Preparing for the v6 release](https://discourse.pi-hole.net/t/preparing-for-the-v6-release/71809) |  | 0 | 10523 | August 18, 2024 |
| [Thank You for Being Part of the V6 Beta!](https://discourse.pi-hole.net/t/thank-you-for-being-part-of-the-v6-beta/72113) |  | 0 | 1932 | September 2, 2024 |
| [Pi-hole Core v5.18 released to fix an Authenticated Arbitrary File Read with root privileges vulnerability](https://discourse.pi-hole.net/t/pi-hole-core-v5-18-released-to-fix-an-authenticated-arbitrary-file-read-with-root-privileges-vulnerability/69221) |  | 1 | 2003 | March 27, 2024 |
| [Fixing two new DNSSEC vulnerabilities](https://discourse.pi-hole.net/t/fixing-two-new-dnssec-vulnerabilities/68318) |  | 2 | 2404 | February 14, 2024 |
| [Pi-hole FTL v5.24, and Core v5.17.3 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-24-and-core-v5-17-3-released/67486) |  | 0 | 2752 | January 8, 2024 |
| [Pi-hole V6 Beta Testing](https://discourse.pi-hole.net/t/pi-hole-v6-beta-testing/65413) |  | 1 | 23145 | October 9, 2023 |
| [PSA: Renaming the web repo](https://discourse.pi-hole.net/t/psa-renaming-the-web-repo/65353) |  | 0 | 1531 | October 6, 2023 |
| [Pi-hole FTL v5.23, Web v5.20 and Core v5.17 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-23-web-v5-20-and-core-v5-17-released/63153) |  | 0 | 5887 | May 28, 2023 |
| [Pi-hole FTL v5.22, Web v5.19 and Core v5.16.1 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-22-web-v5-19-and-core-v5-16-1-released/61999) |  | 0 | 3629 | March 22, 2023 |
| [Pi-hole FTL v5.21, Web v5.18.4 and Core v5.15.5 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-21-web-v5-18-4-and-core-v5-15-5-released/61096) |  | 0 | 2505 | February 10, 2023 |
| [Pi-hole Web v5.18.2 and Core v5.15.1 released](https://discourse.pi-hole.net/t/pi-hole-web-v5-18-2-and-core-v5-15-1-released/60695) |  | 0 | 1959 | January 22, 2023 |
| [Pi-hole FTL v5.20.1, Web v5.18.1 and Core v5.15 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-20-1-web-v5-18-1-and-core-v5-15-released/60495) |  | 0 | 2942 | January 15, 2023 |
| [Pi-hole FTL v5.20 and Web v5.18 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-20-and-web-v5-18-released/59959) |  | 0 | 2160 | December 21, 2022 |
| [Upcoming changes: authentication for more API endpoints required](https://discourse.pi-hole.net/t/upcoming-changes-authentication-for-more-api-endpoints-required/59315) |  | 0 | 2334 | November 18, 2022 |
| [Pi-hole FTL v5.19.1, Web v5.17 and Core v5.14.1 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-19-1-web-v5-17-and-core-v5-14-1-released/59224) |  | 0 | 2191 | November 14, 2022 |
| [Pi-hole FTL v5.18.2, Web v5.16 and Core v5.13 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-18-2-web-v5-16-and-core-v5-13-released/58457) |  | 0 | 2473 | October 10, 2022 |
| [Pi-hole FTL v5.18.1, Web v5.15.1 and Core v5.12.2 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-18-1-web-v5-15-1-and-core-v5-12-2-released/58022) |  | 0 | 2007 | September 19, 2022 |
| [Pi-hole FTL v5.18, Web v5.15 and Core v5.12.1 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-18-web-v5-15-and-core-v5-12-1-released/57894) |  | 0 | 1744 | September 14, 2022 |
| [Pi-hole FTL v5.17, Web v5.14 and Core v5.12 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-17-web-v5-14-and-core-v5-12-released/57497) |  | 22 | 4012 | September 5, 2022 |
| [PSA: Dropping Support for Ubuntu 18.04](https://discourse.pi-hole.net/t/psa-dropping-support-for-ubuntu-18-04/57523) |  | 0 | 1923 | September 3, 2022 |
| [Upcoming Pi-hole changes](https://discourse.pi-hole.net/t/upcoming-pi-hole-changes/57402) |  | 0 | 4429 | August 29, 2022 |
| [Pi-hole FTL v5.16, Web v5.13 and Core v5.11.1 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-16-web-v5-13-and-core-v5-11-1-released/56384) |  | 2 | 3113 | July 7, 2022 |
| [Pi-hole FTL v5.15, Web v5.12 and Core v5.10 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-15-web-v5-12-and-core-v5-10-released/54987) |  | 5 | 2881 | June 25, 2022 |
| [Pi-hole FTL v5.14, Web v5.11 and Core v5.9 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-14-web-v5-11-and-core-v5-9-released/53529) |  | 9 | 5631 | April 19, 2022 |
| [Pi-hole FTL v5.13, Web v5.10 and Core v5.8 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-13-web-v5-10-and-core-v5-8-released/52254) |  | 5 | 2832 | April 19, 2022 |
| [Pi-hole FTL v5.12, Web v5.9 and Core v5.7 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-12-web-v5-9-and-core-v5-7-released/51795) |  | 7 | 3459 | December 25, 2021 |
| [Understanding DNSSEC validation using Pi-hole's Query Log](https://discourse.pi-hole.net/t/understanding-dnssec-validation-using-pi-holes-query-log/51574) |  | 8 | 3685 | December 21, 2021 |
| [Pi-hole FTL v5.11, Web v5.8 and Core v5.6 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-11-web-v5-8-and-core-v5-6-released/50566) |  | 0 | 7373 | October 23, 2021 |
| [Pi-hole FTL v5.10.1, Web v5.7 and Core v5.5 released](https://discourse.pi-hole.net/t/pi-hole-ftl-v5-10-1-web-v5-7-and-core-v5-5-released/50009) |  | 6 | 3731 | October 4, 2021 |

**[next page →](/c/announcements/5?page=1)**

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from pi-hole.net_0cf3c0ea_20250119_134132.html ===


[Skip to content](#page-content)
[![Pi-hole](https://pi-hole.net/wp-content/uploads/2023/05/pihole-logo-horizontal-white-e1683321640117.png)](https://pi-hole.net/)

* [GitHub](https://github.com/pi-hole)
  + [Core](https://github.com/pi-hole/pi-hole)
  + [Web](https://github.com/pi-hole/AdminLTE)
  + [FTL](https://github.com/pi-hole/FTL)
  + [Docker](https://github.com/pi-hole/docker-pi-hole)
* Community
  + [Discourse](https://discourse.pi-hole.net/)
  + [Reddit](http://reddit.com/r/pihole/)
  + [Twitter](https://twitter.com/The_Pi_Hole)
* [About](https://discourse.pi-hole.net/about)
  + [Documentation](https://docs.pi-hole.net/)
  + [Contact](https://pi-hole.net/contact/)
  + [Privacy](https://pi-hole.net/privacy/)
  + [Brand Guidelines](https://pi-hole.net/trademark-rules-and-brand-guidelines/)
  + [Developing Apps For Pi-hole](https://pi-hole.net/developing-apps-for-pi-hole/)
* [Blog](https://pi-hole.net/landing/blog/)
* [Shop](https://pi-hole.net/shop/)
* ## Cart

# Pi-hole FTL v5.7 and Web v5.4 released

## Pi-hole FTL v5.7 and Web v5.4 released

Today, we release Pi-hole FTL v5.7 and Web v5.4. This release improves the security and reliability of your Pi-hole. The most important enhancements are summarized below:

#### Fix security flaws on the web interface

Thanks to Veno Eivazian who pointed us to three security flaws in the web interface. They could have been used to run JavaScript code in the user browser and to “steal” the login session. The latter shouldn’t cause any headaches for you as one should never run a Pi-hole open to the web. However, a possible malicious client *inside your home network* could have exploited them.

We have mitigated the three raised security issues by regenerating session ID on successful login (to prevent session fixation), by restricting PHP sessions to be cookie-only, by restricting the session cookie to be kept secret from possible malicious JavaScript code, and by encoding a message after failed [cross-origin resource sharing (CORS)](https://en.wikipedia.org/wiki/Cross-origin_resource_sharing) checking.

#### Inbuilt enhanced Denial-of-Service (DoS) protection

A DoS attack is a type of cyber attack in which a malicious actor attempts to make a service inaccessible to its intended users by disrupting the normal function of the device. DoS attacks typically work by **overwhelming** (flooding) a target with requests until normal traffic can no longer be processed. For other users, it then results in a denial of service. When facing the Internet, services have to be hardened against malicious attacks such as [Denial-of-Service (DoS) attacks](https://en.wikipedia.org/wiki/Denial-of-service_attack). Defensive responses to denial-of-service attacks typically involve special DoS protection systems but can also involve routers ([Access control list (ACL)](https://en.wikipedia.org/wiki/Access_control_list "Access control list") capabilities) and firewall rules (rate-limiting).

However, inside your local home network, you typically don’t set up proper countermeasures. This is perfectly fine as they are typically not needed. Nevertheless, we see quite often that “the Internet was taken down” (DNS resolution went unavailable) when a rogue client starting to hammer a blocked domain thousands of time every second, or, when an (accidentally) created DNS loop exists, e.g., between the router and your Pi-hole.

It is an interesting question how this should be solved and the simplest approach seems to be firewalling them away. However, we thought that this is not the best way to handle this because

1. Users may already have configured a firewall and checking which firewall was used together with foreseeing any possible conflicts with existing rules is next to impossible.
2. Simply blocking them seems counter-intuitive as the clients requesting clients never see that something is wrong.

Hence, we decided to implement a customizable rate-limiting into FTL itself. It defaults to the rather conservative limit of allowing no more than **1000 queries in a 60 seconds window for each client**. Afterwards, any further queries are replied to with empty replies with the status set to `REFUSED`. Both the number of queries within the window as well as the window size can be configured by the user. It is important to note that rate-limiting is happening on a *per-client* basis. Other clients can continue to use FTL while rate-limited clients are short-circuited at the same time.

Rate-limiting can easily be disabled by setting `RATE_LIMIT=0/0` in `/etc/pihole/pihole-FTL.conf`. If I want, say, to set a rate limit of 1 query per hour, the option should look like `RATE_LIMIT=1/3600`.

1000 queries in 60 seconds still permits more than one million queries *per device* in 24 hours. Hence, we believe this is not really a breaking change but should still prevent your Pi-hole from being DoSed away.

#### Improve interoperability with `systemd-resolved`

We implemented a mitigation for a long-standing [bug in `systemd-resolved`](https://github.com/systemd/systemd/issues/11849) that can lead to up to 5 seconds of artificial DNS resolution delay on respective clients. With the new version of FTL, `systemd-resolved` accepts blocked queries without any artificial delay.

#### Improve shared memory robustness

Our FTL engine is a heavily multi-threaded application using both threads and forks to give you the best and fastest DNS service. To communicate between individual forks, it uses shared memory. If multiple independent processes work on the same shared memory at the same time this can easily lead to issues with memory being written to / resized in an undefined manner. This new version of FTL detects if already existing shared memory blocks are in use by other processes and refuses to start in this case. This ensures that inconsistent shared memory cannot occur.

#### Other fixes, tweaks, and improvements

Furthermore, we address a few minor glitches, e.g., with [percentages not exactly adding up to 100%](https://discourse.pi-hole.net/t/wrong-percent-calculation-in-pie-chart/44277) or incorrect warnings in Pi-hole’s log files.

## Post navigation

[Previous: Previous post: Pi-hole FTL v5.6 released](https://pi-hole.net/blog/2021/01/27/pi-hole-ftl-v5-6-released/)[Next: Next post: Help us test FTL v5.8 / dnsmasq v2.85](https://pi-hole.net/blog/2021/03/31/help-us-test-ftl-v5-8-dnsmasq-v2-85/)

Comments are closed.

## Search

Search for:

## Archives

* [September 2024](https://pi-hole.net/blog/2024/09/) (1)
* [August 2024](https://pi-hole.net/blog/2024/08/) (1)
* [March 2024](https://pi-hole.net/blog/2024/03/) (1)
* [February 2024](https://pi-hole.net/blog/2024/02/) (2)
* [January 2024](https://pi-hole.net/blog/2024/01/) (1)
* [October 2023](https://pi-hole.net/blog/2023/10/) (2)
* [May 2023](https://pi-hole.net/blog/2023/05/) (1)
* [March 2023](https://pi-hole.net/blog/2023/03/) (1)
* [February 2023](https://pi-hole.net/blog/2023/02/) (1)
* [January 2023](https://pi-hole.net/blog/2023/01/) (2)
* [December 2022](https://pi-hole.net/blog/2022/12/) (1)
* [November 2022](https://pi-hole.net/blog/2022/11/) (2)
* [October 2022](https://pi-hole.net/blog/2022/10/) (1)
* [September 2022](https://pi-hole.net/blog/2022/09/) (4)
* [August 2022](https://pi-hole.net/blog/2022/08/) (1)
* [July 2022](https://pi-hole.net/blog/2022/07/) (1)
* [April 2022](https://pi-hole.net/blog/2022/04/) (1)
* [February 2022](https://pi-hole.net/blog/2022/02/) (1)
* [January 2022](https://pi-hole.net/blog/2022/01/) (1)
* [December 2021](https://pi-hole.net/blog/2021/12/) (2)
* [October 2021](https://pi-hole.net/blog/2021/10/) (1)
* [September 2021](https://pi-hole.net/blog/2021/09/) (3)
* [August 2021](https://pi-hole.net/blog/2021/08/) (1)
* [July 2021](https://pi-hole.net/blog/2021/07/) (1)
* [April 2021](https://pi-hole.net/blog/2021/04/) (2)
* [March 2021](https://pi-hole.net/blog/2021/03/) (1)
* [February 2021](https://pi-hole.net/blog/2021/02/) (1)
* [January 2021](https://pi-hole.net/blog/2021/01/) (3)
* [December 2020](https://pi-hole.net/blog/2020/12/) (2)
* [November 2020](https://pi-hole.net/blog/2020/11/) (1)
* [August 2020](https://pi-hole.net/blog/2020/08/) (1)
* [July 2020](https://pi-hole.net/blog/2020/07/) (1)
* [May 2020](https://pi-hole.net/blog/2020/05/) (1)
* [April 2020](https://pi-hole.net/blog/2020/04/) (1)
* [January 2020](https://pi-hole.net/blog/2020/01/) (1)
* [September 2019](https://pi-hole.net/blog/2019/09/) (1)
* [May 2019](https://pi-hole.net/blog/2019/05/) (1)
* [February 2019](https://pi-hole.net/blog/2019/02/) (2)
* [December 2018](https://pi-hole.net/blog/2018/12/) (2)
* [November 2018](https://pi-hole.net/blog/2018/11/) (1)
* [September 2018](https://pi-hole.net/blog/2018/09/) (3)
* [August 2018](https://pi-hole.net/blog/2018/08/) (1)
* [June 2018](https://pi-hole.net/blog/2018/06/) (2)
* [May 2018](https://pi-hole.net/blog/2018/05/) (6)
* [April 2018](https://pi-hole.net/blog/2018/04/) (4)
* [March 2018](https://pi-hole.net/blog/2018/03/) (2)
* [February 2018](https://pi-hole.net/blog/2018/02/) (3)
* [January 2018](https://pi-hole.net/blog/2018/01/) (4)
* [December 2017](https://pi-hole.net/blog/2017/12/) (2)
* [November 2017](https://pi-hole.net/blog/2017/11/) (1)
* [October 2017](https://pi-hole.net/blog/2017/10/) (1)
* [September 2017](https://pi-hole.net/blog/2017/09/) (3)
* [August 2017](https://pi-hole.net/blog/2017/08/) (3)
* [July 2017](https://pi-hole.net/blog/2017/07/) (4)
* [May 2017](https://pi-hole.net/blog/2017/05/) (6)
* [March 2017](https://pi-hole.net/blog/2017/03/) (4)
* [February 2017](https://pi-hole.net/blog/2017/02/) (2)
* [January 2017](https://pi-hole.net/blog/2017/01/) (2)
* [December 2016](https://pi-hole.net/blog/2016/12/) (2)
* [November 2016](https://pi-hole.net/blog/2016/11/) (1)
* [October 2016](https://pi-hole.net/blog/2016/10/) (2)
* [September 2016](https://pi-hole.net/blog/2016/09/) (1)
* [August 2016](https://pi-hole.net/blog/2016/08/) (3)
* [July 2016](https://pi-hole.net/blog/2016/07/) (6)
* [June 2016](https://pi-hole.net/blog/2016/06/) (3)
* [May 2016](https://pi-hole.net/blog/2016/05/) (3)
* [April 2016](https://pi-hole.net/blog/2016/04/) (4)
* [March 2016](https://pi-hole.net/blog/2016/03/) (2)
* [February 2016](https://pi-hole.net/blog/2016/02/) (4)
* [January 2016](https://pi-hole.net/blog/2016/01/) (1)
* [December 2015](https://pi-hole.net/blog/2015/12/) (1)
* [November 2015](https://pi-hole.net/blog/2015/11/) (1)
* [October 2015](https://pi-hole.net/blog/2015/10/) (1)
* [July 2015](https://pi-hole.net/blog/2015/07/) (1)
* [June 2015](https://pi-hole.net/blog/2015/06/) (3)
* [May 2015](https://pi-hole.net/blog/2015/05/) (1)
* [April 2015](https://pi-hole.net/blog/2015/04/) (1)
* [March 2015](https://pi-hole.net/blog/2015/03/) (1)

©  2025 Pi-hole.



=== Content from n4nj0.github.io_18fd5bc3_20250119_115614.html ===

# [The Tales of N4nj0](/)

* [Advisories](/advisories/)
* [CVEs](/cves/)
* [Posts](/posts/)
* [whoami](/whoami/)

# Pi-hole - Multiple Vulnerabilities

* Feb 18, 2021
* 4 minutes read

[![]()](https://n4nj0.github.io/advisories/pi-hole-multiple-vulnerabilities-i/ "Pi-hole - Multiple Vulnerabilities")
## TL;DR

**1 - Reflected Cross-site Scripting**: A remote user is able to inject arbitrary web script or HTML due to incorrect sanitization of Origin header and achieve a Reflected Cross-Site Scripting attack against other users and steal the session cookie.

**2 - Session Fixation**: Session fixation vulnerability allows remote attackers to hijack web sessions via the PHPSESSID parameter.

## Product Information

* **Product Name:** Pi-hole
* **Vulnerable Version:** 5.0, 5.1, 5.1.1
* **Organization Name:** Pi-hole, LLC
* **Product Web Page:** <https://pi-hole.net/>
* **Email:** [disclosure@pi-hole.net](disclosure%40pi-hole.net)
* **Vulnerability Disclosure Info Web Page:** <https://pi-hole.net/contact/>

Pi-hole is a Linux network-level advertisement and Internet tracker blocking application which acts as a DNS sinkhole and optionally a DHCP server, intended for use on a private network.

During a security auditing of the product, I have found two issues. The first is a Reflected XSS, the second is a Session Fixation. Those issues can be combined to steal a valid administrative session.

The fixes were implemented by the owners after my vulnerability notification.

It is recommended to apply the latest update Pi-hole FTL v5.7 and Web v5.4: <https://pi-hole.net/2021/02/16/pi-hole-ftl-v5-7-and-web-v5-4-released/>

## Vulnerability Details

### **1 - Reflected Cross-site Scripting - Improper Neutralization of Input During Web Page Generation (Cross-site Scripting) - CWE-79**

* **Summary:** A remote user is able to inject arbitrary web script or HTML due to incorrect sanitization of user-supplied data and achieve a Reflected Cross-Site Scripting attack against other users and steal the session cookie.
* **Prerequisites:** No special configuration is required to reproduce the issue.
* **CVE and CVSS Score:** [CVE-2020-35592](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-35592) | [**5.4** (Medium)](https://nvd.nist.gov/vuln/detail/CVE-2020-35592)

**Step-by-step instructions and PoC**

An attacker is able to craft an HTTP request and send it to a user, authenticated to Pi-hole, to inject arbitrary web script or HTML into the HTTP **Origin** header, which reflect the user input.

**Affected Endpoints**

* **URL:** <http://hostname/admin>
* **HTTP Parameter:** Origin header

Below are the evidences with the vulnerability details and the payloads used.

Payload used to exploit the vulnerability:

```
GET /admin/ HTTP/1.1
Host: hostname
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Origin: aaa<script>alert(document.cookie)</script>

```

The user is invited to click on a malicious page that have JavaScript code to execute the following HTTP request on the browser of the victim:

![XSS - 1](/images/2fd0bb523d7946e780a209ca11be71bf.png)

The XSS payload gets reflected to the screen.

![XSS - 2](/images/ab243615327c43a12270942a75db8cd1.png)

It is important to note that the **PHPSESSID** session cookie does not have the **HttpOnly** flag, when first assigned to the user:

![XSS - 3](/images/8f425467cc188b93240a89e81fcb0525.png)

**Security Impact**

By exploiting this issue an attacker is able to target an application user with several type of direct or indirect impacts such as, credentials stealing, integrity compromising and different type of phishing attacks. This type of reflected XSS does require user interaction.

### **2 - Session Fixation - CWE-384**

* **Summary:** Session fixation vulnerability allows remote attackers to hijack web sessions via the PHPSESSID parameter.
* **Prerequisites:** No special configuration is required to reproduce the issue.
* **CVE and CVSS Score:** [CVE-2020-35591](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-35591) | [**5.4** (Medium)](https://nvd.nist.gov/vuln/detail/CVE-2020-35591)

**Step-by-step instructions and PoC**

The application does not generate new session cookie after the user is logged in. A malicious user is able to create a new session cookie value and inject it to a victim. After the victim logs in, the injected cookie becomes valid, giving the attacker access to the user’s account through the active session.

**Affected Endpoints**

* **URL:** <http://hostname/admin/index.php?login>
* **HTTP Parameter:** PHPSESSID cookie

Below are the evidences with the vulnerability details and the payload used.

By leveraging the previously found XSS vulnerability, the malicious user can create a request to inject an arbitrary PHPSESSID value to the victim browser:

```
GET /admin/ HTTP/1.1
Host: hostname
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Origin: aaa<script>document.cookie = "PHPSESSID"+"="+escape("mosmbqsp3lh7pf1ar2djcjmk5v")</script>
Cookie: PHPSESSID=mosmbqsp3lh7pf1ar2djcjmk5v

```

![Session Fixation - 1](/images/bcccc0b7b7861c28e3371dc3a25ff77b.png)

The following is the response of the payload and the new cookie added to the browser cookie storage:

![Session Fixation - 2](/images/055224568ea3762d5b13c06d082a4475.png)

Then, when the user performs a login, the new PHPSESSID becomes valid. The attacker can add it to its browser to autenticate to the web application:

![Session Fixation - 3](/images/c42617cec0dd8eafd509108ec94230c9.png)

Indeed, after a user login, there is no a new generation of PHPSESSID:

![Session Fixation - 4](/images/a94a5c151aed793c9d78fab3032fe36e.png)

**Security Impact**

By exploiting this issue, an attacker is able to obtain a valid user session of the application. This type
of attack does require user interaction.

## Timeline

* **15/12/2020**: First disclosure via e-mail to [disclosure@pi-hole.net](disclosure%40pi-hole.net)
* **22/12/2020**: Acknowledge e-mail from the product owner!
* **31/12/2020**: Trying to collaborate with product owner by suggesting some remediation code. I’m really glad to collaborate with them!
* **16/02/2020**: Released the fixed versions and added a news with advisory and credits: <https://pi-hole.net/2021/02/16/pi-hole-ftl-v5-7-and-web-v5-4-released/>
* **26/02/2021**: NVD scored [CVE-2020-35591](https://nvd.nist.gov/vuln/detail/CVE-2020-35591) and [CVE-2020-35592](https://nvd.nist.gov/vuln/detail/CVE-2020-35592) as **5.4** (Medium).

* [NeDi 1.9C - Multiple Vulnerabilities](https://n4nj0.github.io/advisories/nedi-multiple-vulnerabilities-i/)
* [WordPress Plugin WP File Manager - Reflected XSS](https://n4nj0.github.io/advisories/wordpress-plugin-wp-file-manager-i/)

###### © 2020 Veno Eivazian. [Some rights reserved](https://creativecommons.org/licenses/by/3.0/ "Creative Commons Attribution"); please attribute properly and link back.


