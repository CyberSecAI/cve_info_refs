=== Content from packetstormsecurity.com_20794751_20250119_112957.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from issues.asterisk.org_ad776834_20250119_113000.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fasterisk%2Fasterisk%2Fissues)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fasterisk%2Fasterisk%2Fissues)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fissues%2Findex&source=header-repo&source_repo=asterisk%2Fasterisk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[asterisk](/asterisk)
/
**[asterisk](/asterisk/asterisk)**
Public

* [Notifications](/login?return_to=%2Fasterisk%2Fasterisk) You must be signed in to change notification settings
* [Fork
  991](/login?return_to=%2Fasterisk%2Fasterisk)
* [Star
   2.4k](/login?return_to=%2Fasterisk%2Fasterisk)

* [Code](/asterisk/asterisk)
* [Issues
  102](/asterisk/asterisk/issues)
* [Pull requests
  18](/asterisk/asterisk/pulls)
* [Actions](/asterisk/asterisk/actions)
* [Security](/asterisk/asterisk/security)
* [Insights](/asterisk/asterisk/pulse)

Additional navigation options

* [Code](/asterisk/asterisk)
* [Issues](/asterisk/asterisk/issues)
* [Pull requests](/asterisk/asterisk/pulls)
* [Actions](/asterisk/asterisk/actions)
* [Security](/asterisk/asterisk/security)
* [Insights](/asterisk/asterisk/pulse)

Preview
# Issues

Search Issuesis:issue state:openSearch

[Labels](labels)[Milestones](milestones)[New issue](/login?return_to=)
## Search results

OpenClosedAuthorLabelsProjectsMilestonesAssigneesTypesNewest

* ### [[bug]: MoH stopped when HOLD reINVITE causes codec change and client sends audio](/asterisk/asterisk/issues/1027)

  [bug](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Abug)[support-level-coreFunctionality with core support level](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Asupport-level-core)Functionality with core support levelStatus: Open.#1027 In asterisk/asterisk;· [SipSeb](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20author%3ASipSeb)  opened on Dec 11, 2024
* ### [[bug]: Periodically wrapuptime (pause after conversation) in application queue ends earlier than set in the configuration file queue.conf](/asterisk/asterisk/issues/1006)

  [bug](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Abug)[support-level-coreFunctionality with core support level](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Asupport-level-core)Functionality with core support levelStatus: Open.#1006 In asterisk/asterisk;· [Viperjump](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20author%3AViperjump)  opened on Nov 27, 2024
* ### [[improvement]: PJSIP support for Real Time Text](/asterisk/asterisk/issues/997)

  [improvement](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Aimprovement)[support-level-extendedFunctionality with extended support level](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Asupport-level-extended)Functionality with extended support levelStatus: Open.#997 In asterisk/asterisk;· [bnandaku](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20author%3Abnandaku)  opened on Nov 18, 2024
* ### [[bug]: When there is no audio stream on the spyee channel, the spyer channel could not hangup by Hangup action.](/asterisk/asterisk/issues/978)

  [bug](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Abug)[support-level-coreFunctionality with core support level](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Asupport-level-core)Functionality with core support levelStatus: Open.#978 In asterisk/asterisk;· [Tinet-mucw](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20author%3ATinet-mucw)  opened on Nov 6, 2024
* ### [[bug]: ooh323 does not work if dtmfmode=rfc2833](/asterisk/asterisk/issues/968)

  [bug](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Abug)[support-level-extendedFunctionality with extended support level](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Asupport-level-extended)Functionality with extended support levelStatus: Open.#968 In asterisk/asterisk;· [slesru](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20author%3Aslesru)  opened on Oct 30, 2024
* ### [[bug]: missing hangup cause for ARI ChannelDestroyed when Dial times out](/asterisk/asterisk/issues/963)

  [bug](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Abug)[support-level-coreFunctionality with core support level](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Asupport-level-core)Functionality with core support levelStatus: Open.#963 In asterisk/asterisk;· [crazybolillo](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20author%3Acrazybolillo)  opened on Oct 26, 2024
* ### [[bug]: weird info PJSIP 6830e8e8-506c-4faa-9184-b14db7052433](/asterisk/asterisk/issues/957)

  [bug](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Abug)[support-level-coreFunctionality with core support level](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Asupport-level-core)Functionality with core support levelStatus: Open.#957 In asterisk/asterisk;· [Bloodpack](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20author%3ABloodpack)  opened on Oct 19, 2024
* ### [[bug]: No audio in call between 2 pjsip endpoints using opus codec](/asterisk/asterisk/issues/950)

  [bug](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Abug)[support-level-coreFunctionality with core support level](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Asupport-level-core)Functionality with core support levelStatus: Open.#950 In asterisk/asterisk;· [Dhanapathy](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20author%3ADhanapathy)  opened on Oct 17, 2024
* ### [[bug]: res\_pjsip\_refer.c: crash that lead to deadlock during transfer](/asterisk/asterisk/issues/930)

  [bug](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Abug)[support-level-coreFunctionality with core support level](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Asupport-level-core)Functionality with core support levelStatus: Open.#930 In asterisk/asterisk;· [n2p-litvinov](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20author%3An2p-litvinov)  opened on Oct 2, 2024
* ### [[bug]: Asterisk crashes constantly and unexpectedly](/asterisk/asterisk/issues/899)

  [bug](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Abug)[support-level-coreFunctionality with core support level](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Asupport-level-core)Functionality with core support levelStatus: Open.#899 In asterisk/asterisk;· [lHumanizado](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20author%3AlHumanizado)  opened on Sep 24, 2024
* ### [[bug]: Sometimes occurs mutex deadlock during pickup](/asterisk/asterisk/issues/891)

  [bug](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Abug)[support-level-coreFunctionality with core support level](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Asupport-level-core)Functionality with core support levelStatus: Open.#891 In asterisk/asterisk;· [ruslan-voip](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20author%3Aruslan-voip)  opened on Sep 19, 2024
* ### [[bug]: CHANNEL(PJSIP,local\_addr) and CHANNEL(PJSIP,remote\_addr) not available on outgoing channels](/asterisk/asterisk/issues/871)

  [bug](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Abug)[support-level-coreFunctionality with core support level](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20label%3Asupport-level-core)Functionality with core support levelStatus: Open.#871 In asterisk/asterisk;· [Uberseer](/asterisk/asterisk/issues?q=is%3Aissue%20state%3Aopen%20author%3AUberseer)  opened on Sep 6, 2024

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from seclists.org_0033f2eb_20250119_112958.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](56)
[By Date](date.html#57)
[![Next](/images/right-icon-16x16.png)](58)

[![Previous](/images/left-icon-16x16.png)](56)
[By Thread](index.html#57)
[![Next](/images/right-icon-16x16.png)](58)

![](/shared/images/nst-icons.svg#search)

# AST-2021-001: Remote crash in res\_pjsip\_diversion

---

*From*: "Asterisk Security Team" <security () asterisk org>

*Date*: Thu, 18 Feb 2021 11:36:53 -0600

---

```
               Asterisk Project Security Advisory - AST-2021-001

          Product         Asterisk
          Summary         Remote crash in res_pjsip_diversion
     Nature of Advisory   Denial of service
       Susceptibility     Remote authenticated sessions
          Severity        Moderate
       Exploits Known     No
        Reported On       December 28 2020
        Reported By       Ivan Poddubny
         Posted On        January 04 2021
      Last Updated On     January 04 2021
      Advisory Contact    gjoseph AT sangoma DOT com
          CVE Name        CVE-2020-35776

      Description     If a registered user is tricked into dialing a
                      malicious  number that sends lots of 181 responses to
                      Asterisk, each one will cause a 181 to be sent back to
                      the original caller with an increasing number of
                      entries in the âSupportedâ header. Eventually the
                      number of entries in the header exceeds the size of
                      the entry array and causes a crash.
    Modules Affected  res_pjsip_diversion.c

    Resolution  Before updating the âSupportedâ header with a new entry,
                Asterisk now checks that the entry doesnât already exist and
                that adding an entry wonât exceed the size of the entry
                array.

                               Affected Versions
                 Product               Release Series
          Asterisk Open Source              13.X       13.38.1
          Asterisk Open Source              16.X       16.15.1
          Asterisk Open Source              17.X       17.9.1
          Asterisk Open Source              18.X       18.1.1

                                  Corrected In
               Product                              Release
        Asterisk Open Source           13.38.2, 16.16.1, 17.9.2, 18.2.1

                                    Patches
                              Patch URL                             Revision
    <https://downloads.digium.com/pub/security/AST-2021-001-13.diff>  13.38.2
    <https://downloads.digium.com/pub/security/AST-2021-001-16.diff>  16.16.1
    <https://downloads.digium.com/pub/security/AST-2021-001-17.diff>  17.9.2
    <https://downloads.digium.com/pub/security/AST-2021-001-18.diff>  18.2.1

     Links   <https://issues.asterisk.org/jira/browse/ASTERISK-29227>
             <https://downloads.asterisk.org/pub/security/AST-2021-001.html>

    Asterisk Project Security Advisories are posted at
    <http://www.asterisk.org/security>

    This document may be superseded by later versions; if so, the latest
    version will be posted at
    <https://downloads.digium.com/pub/security/AST-2021-001.pdf> and
    <https://downloads.digium.com/pub/security/AST-2021-001.html>

                                Revision History
             Date                 Editor               Revisions Made
    December 29, 2020       George Joseph        Initial revision

               Asterisk Project Security Advisory - AST-2021-001
               Copyright Â© 2020 Digium, Inc. All Rights Reserved.
  Permission is hereby granted to distribute and publish this advisory in its
                           original, unaltered form.

```
```

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](56)
[By Date](date.html#57)
[![Next](/images/right-icon-16x16.png)](58)

[![Previous](/images/left-icon-16x16.png)](56)
[By Thread](index.html#57)
[![Next](/images/right-icon-16x16.png)](58)

### Current thread:

* **AST-2021-001: Remote crash in res\_pjsip\_diversion** *Asterisk Security Team (Feb 18)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from downloads.asterisk.org_a0211955_20250119_112958.html ===


Asterisk
Project Security Advisory - AST-2021-001

| **Product** | Asterisk |
| **Summary** | Remote crash in res\_pjsip\_diversion |
| **Nature of Advisory** | Denial of service |
| **Susceptibility** | Remote authenticated sessions |
| **Severity** | Moderate |
| **Exploits Known** | No |
| **Reported On** | December 28 2020 |
| **Reported By** | Ivan Poddubny |
| **Posted On** | January 04 2021 |
| **Last Updated On** | January 04 2021 |
| **Advisory Contact** | gjoseph AT sangoma DOT com |
| **CVE Name** | CVE-2020-35776 |

| **Description** | If a registered user is tricked into dialing a malicious number that sends lots of 181 responses to Asterisk, each one will cause a 181 to be sent back to the original caller with an increasing number of entries in the âSupportedâ header. Eventually the number of entries in the header exceeds the size of the entry array and causes a crash. |
| **Modules Affected** | res\_pjsip\_diversion.c |

| **Resolution** | Before updating the âSupportedâ header with a new entry, Asterisk now checks that the entry doesnât already exist and that adding an entry wonât exceed the size of the entry array. |

| **Affected Versions** | | |
| **Product** | **Release Series** |  |
| Asterisk Open Source | 13.X | 13.38.1 |
| Asterisk Open Source | 16.X | 16.15.1 |
| Asterisk Open Source | 17.X | 17.9.1 |
| Asterisk Open Source | 18.X | 18.1.1 |

| **Corrected In** | |
| **Product** | **Release** |
| Asterisk Open Source | 13.38.2, 16.16.1, 17.9.2, 18.2.1 |
|  |  |

| **Patches** | |
| **Patch URL** | **Revision** |
| https://downloads.digium.com/pub/security/AST-2021-001-13.diff | 13.38.2 |
| https://downloads.digium.com/pub/security/AST-2021-001-16.diff | 16.16.1 |
| https://downloads.digium.com/pub/security/AST-2021-001-17.diff | 17.9.2 |
| https://downloads.digium.com/pub/security/AST-2021-001-18.diff | 18.2.1 |

| **Links** | https://issues.asterisk.org/jira/browse/ASTERISK-29227 |
|  | https://downloads.asterisk.org/pub/security/AST-2021-001.html |

| Asterisk Project Security Advisories are posted at <http://www.asterisk.org/security>  This document may be superseded by later versions; if so, the latest version will be posted at https://downloads.digium.com/pub/security/AST-2021-001.pdf and https://downloads.digium.com/pub/security/AST-2021-001.html |

| **Revision History** | | |
| **Date** | **Editor** | **Revisions Made** |
| December 29, 2020 | George Joseph | Initial revision |
|  |  |  |
|  |  |  |
|  |  |  |

Asterisk Project Security
Advisory - AST-2021-001

Copyright
Â© 2020
Digium, Inc. All Rights Reserved.

Permission is hereby granted
to distribute and publish this advisory in its original, unaltered
form.



=== Content from issues.asterisk.org_9bb3685b_20250119_113001.html ===

[[Home](/)]

| Summary: | ASTERISK-29227: res\_pjsip\_diversion: sending multiple 181 responses causes memory corruption and crash | | |
| --- | --- | --- | --- |
| Reporter: | Ivan Poddubny (ipoddubny) | Labels: | patch security |
| Date Opened: | 2020-12-28 07:03:32.000-0600 | Date Closed: | 2021-02-18 10:37:02.000-0600 |
| Priority: | Blocker | Regression? | No |
| Status: | Closed/Complete | Components: | pjproject/pjsip |
| Versions: | 13.38.0 13.38.1 16.15.0 16.15.1 17.9.0 17.9.1 18.1.0 18.1.1 | Frequency ofOccurrence |  |
| RelatedIssues: |  | | |
| Environment: |  | Attachments: | ( 0) [0001-res\_pjsip\_diversion-Fix-adding-more-than-one-histinf.patch](../attachments/29/ASTERISK-29227/00-0001-res_pjsip_diversion-Fix-adding-more-than-one-histinf.patch) |
| Description: | Every time Asterisk/chan\_pjsip transmits a "181 Call is being forwarded" packet, res\_pjsip\_diversion adds a "histinfo" element to Supported header. It doesn't check if "histinfo" has already been added, nor it performs a bounds check, thus making it possible to overwrite/corrupt memory past the PJSIP\_GENERIC\_ARRAY\_MAX\_COUNT elements that pjsip\_supported\_hdr can contain.   h4. How to reproduce   Make a call from a pjsip endpoint to this diaplan:  {quote}  exten => 181,1,NoOp  same => n,Set(i=9000)  same => n,While($[ $\{DEC\(i)} != 0])  same => n,Set(REDIRECTING(from-num)=$\{i})  same => n,EndWhile  {quote}    h4. How to crash Asterisk remotely   Use Dial application on an unanswered incoming PJSIP channel to connect to a channel indicating AST\_CONTROL\_REDIRECTING more than PJSIP\_GENERIC\_ARRAY\_MAX\_COUNT times (32 by default).  Example:  \*  2 PJSIP endpoints \[alice] and \[bob]  \*   PJSIP/alice-00000001 executes Dial(PJSIP/bob)  \*   PJSIP/bob-00000002 sends an INVITE to bob  \*   bob sends 100 Trying, followed by repeating "181 Call Is Being Forwarded"  \*   Asterisk transmits 181 Call Is Being Forwarded to alice, adding one more "histinfo" element to Supported, eventually overwriting memory past array boundary until Asterisk crashes. | | |
| Comments: | By: Asterisk Team (asteriskteam) 2020-12-28 07:03:34.641-0600Thanks for creating a report! The issue has entered the triage process. That means the issue will wait in this status until a Bug Marshal has an opportunity to review the issue. Once the issue has been reviewed you will receive comments regarding the next steps towards resolution. Please note that log messages and other files should not be sent to the Sangoma Asterisk Team unless explicitly asked for. All files should be placed on this issue in a sanitized fashion as needed.   A good first step is for you to review the [Asterisk Issue Guidelines|https://wiki.asterisk.org/wiki/display/AST/Asterisk+Issue+Guidelines] if you haven't already. The guidelines detail what is expected from an Asterisk issue report.   Then, if you are submitting a patch, please review the [Patch Contribution Process|https://wiki.asterisk.org/wiki/display/AST/Patch+Contribution+Process].   Please note that once your issue enters an open state it has been accepted. As Asterisk is an open source project there is no guarantee or timeframe on when your issue will be looked into. If you need expedient resolution you will need to find and pay a suitable developer. Asking for an update on your issue will not yield any progress on it and will not result in a response. All updates are posted to the issue when they occur.   Please note that by submitting data, code, or documentation to Sangoma through JIRA, you accept the Terms of Use present at [https://www.asterisk.org/terms-of-use/|https://www.asterisk.org/terms-of-use/].  ---   By: Asterisk Team (asteriskteam) 2020-12-28 07:03:38.547-0600This issue has been automatically restricted and set to a blocker due to being a security type issue. If this is not a security vulnerability issue it will be moved to the appropriate issue type when triaged.   Please DO NOT put a code review up for this change at this time. Attach any applicable patches to this issue.  ---   By: Ivan Poddubny (ipoddubny) 2020-12-28 07:09:01.417-0600I'm sorry for opening duplicates ASTERISK-29225 and ASTERISK-29226. Please, close them.  JIRA displayed an error message about formatting but nevertheless it created the issues.  ---   By: George Joseph (gjoseph) 2020-12-29 09:51:28.167-0600We took care of the dups and I've created private gerrit reviews for your patch (which you probably can't see).  I also applied your fix to res\_pjsip\_path and res\_pjsip\_outbound\_registration since they also add values to the Supported header.  We're still discussing a security release schedule so please don't discuss the issue publically for now.   Thanks for finding this!    ---   By: Friendly Automation (friendly-automation) 2021-02-18 10:37:03.178-0600Change 15452 merged by George Joseph:  res\_pjsip\_diversion: Fix adding more than one histinfo to Supported   [https://gerrit.asterisk.org/c/asterisk/+/15452|https://gerrit.asterisk.org/c/asterisk/+/15452]  ---   By: Friendly Automation (friendly-automation) 2021-02-18 10:37:05.423-0600Change 15464 merged by George Joseph:  res\_pjsip\_diversion: Fix adding more than one histinfo to Supported   [https://gerrit.asterisk.org/c/asterisk/+/15464|https://gerrit.asterisk.org/c/asterisk/+/15464]  ---   By: Friendly Automation (friendly-automation) 2021-02-18 10:37:07.872-0600Change 15465 merged by George Joseph:  res\_pjsip\_diversion: Fix adding more than one histinfo to Supported   [https://gerrit.asterisk.org/c/asterisk/+/15465|https://gerrit.asterisk.org/c/asterisk/+/15465]  ---   By: Friendly Automation (friendly-automation) 2021-02-18 10:37:10.812-0600Change 15450 merged by George Joseph:  res\_pjsip\_diversion: Fix adding more than one histinfo to Supported   [https://gerrit.asterisk.org/c/asterisk/+/15450|https://gerrit.asterisk.org/c/asterisk/+/15450]  ---   By: Friendly Automation (friendly-automation) 2021-02-18 10:37:13.020-0600Change 15466 merged by George Joseph:  res\_pjsip\_diversion: Fix adding more than one histinfo to Supported   [https://gerrit.asterisk.org/c/asterisk/+/15466|https://gerrit.asterisk.org/c/asterisk/+/15466]  ---   By: Friendly Automation (friendly-automation) 2021-02-18 10:37:15.803-0600Change 15463 merged by George Joseph:  res\_pjsip\_diversion: Fix adding more than one histinfo to Supported   [https://gerrit.asterisk.org/c/asterisk/+/15463|https://gerrit.asterisk.org/c/asterisk/+/15463]  ---   By: Friendly Automation (friendly-automation) 2021-02-18 10:37:19.882-0600Change 15454 merged by George Joseph:  res\_pjsip\_diversion: Fix adding more than one histinfo to Supported   [https://gerrit.asterisk.org/c/asterisk/+/15454|https://gerrit.asterisk.org/c/asterisk/+/15454]  ---   By: Friendly Automation (friendly-automation) 2021-02-18 10:37:22.290-0600Change 15453 merged by George Joseph:  res\_pjsip\_diversion: Fix adding more than one histinfo to Supported   [https://gerrit.asterisk.org/c/asterisk/+/15453|https://gerrit.asterisk.org/c/asterisk/+/15453]  ---   By: Friendly Automation (friendly-automation) 2021-02-18 10:37:24.827-0600Change 15451 merged by George Joseph:  res\_pjsip\_diversion: Fix adding more than one histinfo to Supported   [https://gerrit.asterisk.org/c/asterisk/+/15451|https://gerrit.asterisk.org/c/asterisk/+/15451]  --- | | |


