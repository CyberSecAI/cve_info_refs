Based on the provided information, here's a breakdown of the vulnerability described in CVE-2020-35776:

**Root Cause of Vulnerability:**

*   The vulnerability lies within the `res_pjsip_diversion.c` module of Asterisk.
*   When Asterisk sends a "181 Call is being forwarded" SIP response, the `res_pjsip_diversion` module adds a "histinfo" element to the "Supported" header.
*   The code fails to check if the "histinfo" element already exists in the header or if adding another element will exceed the maximum allowed size for the header array (PJSIP\_GENERIC\_ARRAY\_MAX\_COUNT, which defaults to 32).

**Weaknesses/Vulnerabilities Present:**

*   **Lack of bounds checking:** The module does not check if adding a "histinfo" element will exceed the maximum size of the "Supported" header array.
*   **Missing duplicate check:** The module does not check if a "histinfo" element already exists before adding it again. This allows for multiple additions of the same element.
*   **Memory corruption:** Repeatedly adding "histinfo" elements without bounds checking can lead to writing past the allocated memory for the header array, resulting in memory corruption and a crash.

**Impact of Exploitation:**

*   **Denial of Service (DoS):**  The primary impact is a denial-of-service. By sending a large number of 181 responses, an attacker can cause the Asterisk server to crash.

**Attack Vectors:**

*   The attack is triggered by sending multiple 181 "Call is being forwarded" SIP responses to an Asterisk server.
*   An attacker needs to trick a registered user into dialing a number that sends these malicious responses.
*   The malicious responses cause Asterisk to generate and send 181 responses back to the original caller, each time adding a "histinfo" element to the Supported header.

**Required Attacker Capabilities/Position:**

*   The attacker needs the capability to send SIP messages to the Asterisk server.
*   The attacker needs to be able to influence the call flow to make Asterisk generate a large number of 181 responses.
*   The attacker does not necessarily need to be authenticated, but they need to cause an authenticated user to dial a specific number.

**Additional Details:**

* The issue was reported on December 28, 2020, and the fix was released on January 4, 2021.
*  Patches were provided for various versions of Asterisk.
*  The vulnerability also affected `res_pjsip_path` and `res_pjsip_outbound_registration` modules which were fixed along with `res_pjsip_diversion`.

The provided content gives a clear picture of the vulnerability, its exploitation, and the resolution, going beyond the generic CVE description.