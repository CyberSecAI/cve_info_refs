```
{
  "vulnerability": {
    "root_cause": "The `BlockLogFormatter` in MediaWiki fails to properly sanitize user-provided content when outputting block logs, leading to potential XSS vulnerabilities.",
    "weaknesses": [
      "Cross-Site Scripting (XSS)",
      "Insufficient output sanitization",
       "Use of `Message::rawParam` with unsanitized input"
    ],
    "impact": "An attacker can inject arbitrary HTML and JavaScript code into the block logs. This code is executed in the context of other users' browsers when they view the log, potentially leading to account compromise or other malicious actions.",
    "attack_vectors": [
        "Manipulating the month messages (e.g., MediaWiki:january through MediaWiki:december)",
        "By injecting malicious code through the MediaWiki:blanknamespace message"
    ],
    "required_capabilities": "An attacker needs the ability to edit the MediaWiki namespace messages (e.g., `MediaWiki:january`, `MediaWiki:blanknamespace`). This usually requires administrator privileges on the MediaWiki instance."
  },
  "affected_components": [
    "BlockLogFormatter.php",
    "Language::translateBlockExpiry",
     "Language::userTimeAndDate"
  ],
  "references": [
     "https://lists.wikimedia.org/pipermail/mediawiki-announce/2020-December/000268.html",
      "https://bugzilla.redhat.com/show_bug.cgi?id=1909238",
     "https://www.debian.org/security/2020/dsa-4816",
     "https://phabricator.wikimedia.org/T268938",
     "https://security-tracker.debian.org/tracker/CVE-2020-35479",
     "https://lists.debian.org/debian-lts-announce/2020/12/msg00034.html"
  ],
   "additional_notes": [
        "The vulnerability is present because the output from the Language::translateBlockExpiry function was not properly escaped before being passed to Message::rawParam. Specifically, the Language::userTimeAndDate function, used within translateBlockExpiry, can return unsafe HTML. Also, `LogFormatter::makePageLink` was documented to receive HTML as a parameter, even in plain text mode.",
        "The fix includes ensuring that HTML is properly escaped before being passed to these methods."
  ]
}
```