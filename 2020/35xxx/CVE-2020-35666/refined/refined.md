The provided content relates to CVE-2020-35666.

**Root cause of vulnerability:**
The application does not properly validate user-provided input before using it in a MongoDB query. Specifically, it directly uses `req.body` parameters such as `X-User-Id`, `space`, and `selector` in the `db.space_users.findOne` method. This allows an attacker to inject MongoDB query operators.

**Weaknesses/vulnerabilities present:**
- **NoSQL Injection:** The vulnerability is a NoSQL injection flaw, specifically targeting MongoDB. By using MongoDB query operators like `$ne` in the `X-User-Id`, `space` parameters, an attacker can bypass intended access controls and manipulate the query.
- **Insufficient Input Validation:** The application fails to validate or sanitize user-provided data before using it in database queries, creating a direct injection vulnerability.

**Impact of exploitation:**
- **Unauthorized Data Access:** An attacker can bypass authentication and authorization mechanisms to access sensitive information, such as user details in the `space_users` collection.
- **Information Disclosure:** The attacker can retrieve data that they are not authorized to view. For instance, the described attack can retrieve details of any user and space, bypassing normal access controls.

**Attack vectors:**
- **HTTP POST Request:** The attack is performed through a POST request to the `/api/collection/findone` endpoint.
- **Manipulated Request Body:** The attacker manipulates the request body, especially parameters like `X-User-Id`, `space`, and potentially `selector` or `options`, using MongoDB query operators.

**Required attacker capabilities/position:**
- **Network Access:** The attacker needs network access to the vulnerable application.
- **Knowledge of API endpoint:** The attacker needs to know the vulnerable API endpoint `(/api/collection/findone)` .
- **Understanding of MongoDB operators:** The attacker needs an understanding of MongoDB query operators.