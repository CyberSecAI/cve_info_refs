Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from the lack of proper sanitization or escaping of data retrieved from the database when displaying DNS query logs in the Pi-hole web interface. Specifically, hostnames from DNS queries were being displayed without any encoding, allowing malicious code within a hostname to be executed.

**Weaknesses/Vulnerabilities:**

*   **Stored Cross-Site Scripting (XSS):** Malicious JavaScript code injected into a DNS hostname is stored in the Pi-hole database. This stored XSS vulnerability is triggered when an administrator views the Query Log or Long-term Query Log in the web interface.

**Impact of Exploitation:**

*   **Arbitrary JavaScript Execution:** Successful exploitation allows an attacker to execute arbitrary JavaScript code within the context of the administrator's browser when viewing the query logs.
*   **Potential for Further Attacks:** This could lead to various malicious activities, including but not limited to session hijacking, defacement of the web interface, or further compromising the server.

**Attack Vectors:**

*   **Malicious DNS Queries:** An attacker can inject malicious JavaScript code by crafting a DNS query with a specially crafted hostname.
*   **Direct or Indirect Query:** The attacker could either directly query the Pi-hole server or perform the query through an indirect means, if the Pi-hole instance permits external DNS queries or if malformed DNS queries are allowed.

**Required Attacker Capabilities/Position:**

*   **Ability to Submit DNS Queries:** The attacker needs to be able to submit DNS queries that reach the vulnerable Pi-hole instance. This could be direct access or indirect via an intermediate system that forwards DNS queries.
*   **No Authentication Required to Trigger Vulnerability:** The XSS vulnerability is triggered when a user views the query log, meaning the vulnerability can be exploited without requiring authentication on the web interface. However, the impact is only realized when an authenticated user views the logs.

**Additional Notes:**
* The vulnerability was addressed by escaping the data retrieved from the database before displaying it in the web interface. This prevents the execution of malicious scripts.
* The fix was released in Pi-hole version v5.2.2, as per the blog post and the related pull request.
* The blog post mentions that Shodan reported over 7,500 Pi-hole instances, highlighting the wide impact of this vulnerability.
* The vulnerability was assigned CVE-2020-35659 on December 23, 2020.