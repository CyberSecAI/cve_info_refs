The provided content describes a vulnerability in the "Gift Cards for WooCommerce" plugin, specifically the "Custom Gift Card Template" feature. Here's a breakdown:

**Root cause of vulnerability:**

*   The vulnerability stems from insecure file upload handling within the "Custom Gift Card Template" feature. The plugin does not properly validate or sanitize the filename of uploaded image files, allowing for arbitrary file uploads.

**Weaknesses/vulnerabilities present:**

*   **Arbitrary File Upload:** The plugin allows an attacker to upload files with a `.php` extension, which can then be executed by the web server.
*   **Lack of Filename Sanitization:** The plugin does not sanitize or validate the uploaded file's name, specifically allowing a trailing space after the extension. This bypasses basic file extension checks and allows for execution of malicious code.
*   **Lack of Input Validation:**  The plugin does not check the content of the uploaded file.

**Impact of exploitation:**

*   **Remote Code Execution (RCE):** Successful exploitation allows the attacker to execute arbitrary PHP code on the server, potentially leading to complete control over the website, data breaches, and other malicious activities.

**Attack vectors:**

*   **HTTP POST Request:** An attacker exploits the vulnerability by sending a crafted POST request to `/wp-admin/admin-ajax.php`.
*   **Multipart Form Data:** The payload includes `multipart/form-data` with a specially crafted file upload.
*   **Filename Manipulation:** The attacker manipulates the filename parameter in the `Content-Disposition` header to include a trailing space after the `.php` extension (e.g., `filename="test.php "`).
*  **Bypassing Extension Check**: Adding a space after the .php extension bypasses extension validation

**Required attacker capabilities/position:**

*   **Network Access:** The attacker must have network access to the vulnerable website.
*   **Knowledge of Plugin:** The attacker needs to know the plugin and its vulnerable endpoint.
*   **Ability to Craft HTTP Requests:**  The attacker needs the ability to create a malicious POST request, manipulating the file upload and parameters.
*   **No Authentication Required:** The provided POC does not show the need to be logged into the WordPress site to exploit this vulnerability.

**Technical Details**
The exploit utilizes a multipart/form-data request with the following key characteristics:

*   `Content-Disposition: form-data; name="file"; filename="test.php "`  (Note the trailing space after "php")
*   `Content-Type: image/jpeg` (This seems to be bypassed/ignored by the server-side implementation.
*   PHP code is embedded as file content, with a comment `/**` to prevent a syntax error caused by missing `?>` tag.

The uploaded file is placed in:
`/wp-content/uploads/cgc_own_img/{filename}.php`

This location is then accessible by the attacker via a web request which allows for the execution of the malicious code.

This exploit provides more details than the basic description for CVE-2020-35627.