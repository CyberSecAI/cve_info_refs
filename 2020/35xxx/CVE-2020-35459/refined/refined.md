Based on the provided content, here's a breakdown of the vulnerability described by CVE-2020-35459:

**Root Cause of Vulnerability:**

The root cause is the lack of proper input sanitization in the `crmsh` utility, specifically within the `crm history` subcommand. The `crm history` subcommand uses `utils.pipe_cmd_nosudo` to execute shell commands. The vulnerability stems from the fact that the "session create SESSION" subcommand, which is part of `crm history`, uses a format string vulnerable to shell injection when creating directories.

**Weaknesses/Vulnerabilities Present:**

*   **Shell Injection:** The `mkdir` command is constructed using string formatting, which is vulnerable to shell injection. The `session_dir` variable, derived from user input, is not properly sanitized before being used in the command.
*   **Insecure Command Execution:** The code uses `utils.pipe_cmd_nosudo` to execute the shell command, which in turn executes the command in a subshell using `os.popen`, allowing execution of arbitrary commands.
*   **Insufficient Input Validation:** The `hawk_invoke` tool which calls the `crmsh` commands has a whitelist of allowed `crmsh` options, however, it does not filter or block stdin, thus allowing the attacker to inject malicious commands using the `crm history` subcommand, specifically through the session creation process.

**Impact of Exploitation:**

*   **Local Privilege Escalation:** An attacker who can execute commands as the `hauser` or `vagrant` user can exploit this vulnerability to gain root privileges. By injecting shell code into the `session_dir` argument, they can execute arbitrary commands with root privileges.

**Attack Vectors:**

*   **Local Access:** The attacker needs local access to the system and the ability to execute commands as either the `hauser` or `vagrant` user.
*   **`hawk_invoke` utility**: The vulnerability is triggered via the `hawk_invoke` tool. This setuid-root helper allows the hawk web console to invoke commands as root via a specific user (`hauser` or `vagrant`).

**Required Attacker Capabilities/Position:**

*   The attacker must have local access to the system.
*   The attacker must have the ability to run commands with the privileges of the `hauser` or `vagrant` user account.
*   The attacker must be able to use the `hawk_invoke` setuid-root helper tool.

**Additional Details:**

*   The vulnerability is triggered when using the "crm history" subcommand, which is whitelisted by `hawk_invoke`.
*   The vulnerable code executes a command similar to `mkdir -p <session_dir>`, where `session_dir` is derived from user input and vulnerable to injection attacks.
*   The fix involves using `Path.mkdir` instead of system `mkdir` or using `utils.mkdirp` and adding `;` to a blacklist filter.

This vulnerability allows a local attacker to elevate their privileges to root by exploiting the insecure handling of input within `crmsh` and the permissions granted to the `hawk_invoke` binary.