=== Content from github.com_0a130ccf_20250119_120039.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenvoyproxy%2Fenvoy%2Fcompare%2Fv1.16.0...v1.16.1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenvoyproxy%2Fenvoy%2Fcompare%2Fv1.16.0...v1.16.1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcompare%2Fshow&source=header-repo&source_repo=envoyproxy%2Fenvoy)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[envoyproxy](/envoyproxy)
/
**[envoy](/envoyproxy/envoy)**
Public

* [Notifications](/login?return_to=%2Fenvoyproxy%2Fenvoy) You must be signed in to change notification settings
* [Fork
  4.9k](/login?return_to=%2Fenvoyproxy%2Fenvoy)
* [Star
   25.3k](/login?return_to=%2Fenvoyproxy%2Fenvoy)

* [Code](/envoyproxy/envoy)
* [Issues
  1.5k](/envoyproxy/envoy/issues)
* [Pull requests
  141](/envoyproxy/envoy/pulls)
* [Actions](/envoyproxy/envoy/actions)
* [Projects
  0](/envoyproxy/envoy/projects)
* [Wiki](/envoyproxy/envoy/wiki)
* [Security](/envoyproxy/envoy/security)
* [Insights](/envoyproxy/envoy/pulse)

Additional navigation options

* [Code](/envoyproxy/envoy)
* [Issues](/envoyproxy/envoy/issues)
* [Pull requests](/envoyproxy/envoy/pulls)
* [Actions](/envoyproxy/envoy/actions)
* [Projects](/envoyproxy/envoy/projects)
* [Wiki](/envoyproxy/envoy/wiki)
* [Security](/envoyproxy/envoy/security)
* [Insights](/envoyproxy/envoy/pulse)

[Permalink](https://github.com/envoyproxy/envoy/compare/envoyproxy%3A8fb3cb8...envoyproxy%3A0717f49)
# Comparing changes

 Choose two branches to see what’s changed or to start a new pull request.
If you need to, you can also  compare across forks
 or
[learn more about diff comparisons](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

# Open a pull request

 Create a new pull request by comparing changes across two branches. If you need to, you can also  compare across forks
.
[Learn more about diff comparisons here](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

*base repository:*
envoyproxy/envoy

Failed to load repositories. Confirm that selected base ref is valid, then try again.

 Loading

*base:*
v1.16.0

Choose a base ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/envoyproxy/envoy/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.16.1)

Could not load tags

Nothing to show

[{{ refName }}
default](/envoyproxy/envoy/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.16.1)

 Loading

...

*head repository:*
envoyproxy/envoy

Failed to load repositories. Confirm that selected head ref is valid, then try again.

 Loading

*compare:*
v1.16.1

Choose a head ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/envoyproxy/envoy/compare/v1.16.0...%7B%7B%20urlEncodedRefName%20%7D%7D)

Could not load tags

Nothing to show

[{{ refName }}
default](/envoyproxy/envoy/compare/v1.16.0...%7B%7B%20urlEncodedRefName%20%7D%7D)

 Loading

* 10

  commits
* 94

  files changed
* 8

  contributors

### Commits on Oct 21, 2020

1. [docs: kick-off 1.16.1-dev (](/envoyproxy/envoy/commit/b8a804ac4bd6ae1e9e26a8c57c7cd08758510236)[#13664](https://github.com/envoyproxy/envoy/pull/13664)[)](/envoyproxy/envoy/commit/b8a804ac4bd6ae1e9e26a8c57c7cd08758510236)
    …

   ```
   Signed-off-by: Lizan Zhou <lizan@tetrate.io>
   ```

   [![@lizan](https://avatars.githubusercontent.com/u/1016047?s=40&v=4)](/lizan)

   [lizan](/envoyproxy/envoy/commits?author=lizan "View all commits by lizan")
   authored
   Oct 21, 2020

   Configuration menu

   * [View commit details](/envoyproxy/envoy/commit/b8a804ac4bd6ae1e9e26a8c57c7cd08758510236)
   * Copy full SHA for b8a804a
   * [Browse repository at this point](/envoyproxy/envoy/tree/b8a804ac4bd6ae1e9e26a8c57c7cd08758510236)

   Copy the full SHA

    [b8a804a](/envoyproxy/envoy/commit/b8a804ac4bd6ae1e9e26a8c57c7cd08758510236)View commit details

   Browse the repository at this point in the history
2. [1.16: CI fixes backport (](/envoyproxy/envoy/commit/8620920c7dd97d8015bc0d0e2b53a2b329cb2c12)[#13665](https://github.com/envoyproxy/envoy/pull/13665)[)](/envoyproxy/envoy/commit/8620920c7dd97d8015bc0d0e2b53a2b329cb2c12)
    …

   ```
   Backport following commits to 1.16:
   [748b2ab](https://github.com/envoyproxy/envoy/commit/748b2ab1c54d91790642a79153e1ccb8c4b67ca5) (mac ci: try ignoring update failure ([#13658](https://github.com/envoyproxy/envoy/pull/13658)), 2020-10-20)
   [f95f539](https://github.com/envoyproxy/envoy/commit/f95f5391b0b8683081ec786ea946026594955fc6) (ci: various improvements ([#13660](https://github.com/envoyproxy/envoy/pull/13660)), 2020-10-20)
   [6481a27](https://github.com/envoyproxy/envoy/commit/6481a275d759bce97b1a8596a589d5d24eba5639) (ci: stop building alpine-debug images in favor of ubuntu-based debug image ([#13598](https://github.com/envoyproxy/envoy/pull/13598)), 2020-10-15)
   [73d78f8](https://github.com/envoyproxy/envoy/commit/73d78f8d6a7d031ec7a0e06365e729e75f1b677d) (ci: use multiple stage ([#13557](https://github.com/envoyproxy/envoy/pull/13557)), 2020-10-15)
   [b7a4756](https://github.com/envoyproxy/envoy/commit/b7a47564ca2ee6844f6344a4f8152d40c052da86) (ci: use azp for api and go-control-plane sync ([#13550](https://github.com/envoyproxy/envoy/pull/13550)), 2020-10-14)
   [876a6bb](https://github.com/envoyproxy/envoy/commit/876a6bb52755b5eb8a78f5bd2f7fd51cfad10410) (ci use azp to sync filter example ([#13501](https://github.com/envoyproxy/envoy/pull/13501)), 2020-10-12)
   [a0f31ee](https://github.com/envoyproxy/envoy/commit/a0f31ee8600256a74caa66e2fd925fd7f6a92823) (ci: use azp to generate docs ([#13481](https://github.com/envoyproxy/envoy/pull/13481)), 2020-10-12)
   7e5d854 (ci: bring BAZEL_BUILD_OPTIONS back for format and docs ([#13480](https://github.com/envoyproxy/envoy/pull/13480)), 2020-10-11)
   [7af2b2b](https://github.com/envoyproxy/envoy/commit/7af2b2ba562e56c06f8727a2802894e49905d830) (ci: use same flaky test process script on macOS ([#13485](https://github.com/envoyproxy/envoy/pull/13485)), 2020-10-10)

   Signed-off-by: Lizan Zhou <lizan@tetrate.io>
   Co-authored-by: asraa <asraa@google.com>
   ```

   [![@lizan](https://avatars.githubusercontent.com/u/1016047?s=40&v=4)](/lizan) [![@asraa](https://avatars.githubusercontent.com/u/5194569?s=40&v=4)](/asraa)

   [lizan](/envoyproxy/envoy/commits?author=lizan "View all commits by lizan")
   and
   [asraa](/envoyproxy/envoy/commits?author=asraa "View all commits by asraa")
   authored
   Oct 21, 2020

   Configuration menu

   * [View commit details](/envoyproxy/envoy/commit/8620920c7dd97d8015bc0d0e2b53a2b329cb2c12)
   * Copy full SHA for 8620920
   * [Browse repository at this point](/envoyproxy/envoy/tree/8620920c7dd97d8015bc0d0e2b53a2b329cb2c12)

   Copy the full SHA

    [8620920](/envoyproxy/envoy/commit/8620920c7dd97d8015bc0d0e2b53a2b329cb2c12)View commit details

   Browse the repository at this point in the history

### Commits on Nov 5, 2020

1. [backport: Prevent SEGFAULT when disabling listener (](/envoyproxy/envoy/commit/79984e40b456f30cfb53564c4afe955aea19f9f9)[#13515](https://github.com/envoyproxy/envoy/pull/13515)[) (](/envoyproxy/envoy/commit/79984e40b456f30cfb53564c4afe955aea19f9f9)[#13882](https://github.com/envoyproxy/envoy/pull/13882)[)](/envoyproxy/envoy/commit/79984e40b456f30cfb53564c4afe955aea19f9f9)
    …

   ```
   * Prevent SEGFAULT when disabling listener ([#13515](https://github.com/envoyproxy/envoy/pull/13515))

   This prevents the stop_listening overload action from causing
   segmentation faults that can occur if the action is enabled after the
   listener has already shut down.

   Signed-off-by: Alex Konradi <akonradi@google.com>
   Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
   ```

   [![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&v=4)](/cpakulski)

   [cpakulski](/envoyproxy/envoy/commits?author=cpakulski "View all commits by cpakulski")
   authored
   Nov 5, 2020

   Configuration menu

   * [View commit details](/envoyproxy/envoy/commit/79984e40b456f30cfb53564c4afe955aea19f9f9)
   * Copy full SHA for 79984e4
   * [Browse repository at this point](/envoyproxy/envoy/tree/79984e40b456f30cfb53564c4afe955aea19f9f9)

   Copy the full SHA

    [79984e4](/envoyproxy/envoy/commit/79984e40b456f30cfb53564c4afe955aea19f9f9)View commit details

   Browse the repository at this point in the history

### Commits on Nov 11, 2020

1. [backport to rel-1.16: proxy\_proto - fixing hashing bug](/envoyproxy/envoy/commit/cb4c1afc8fd52d3743862cf773e34069a60f9c31) [#13768](https://github.com/envoyproxy/envoy/pull/13768) [(](/envoyproxy/envoy/commit/cb4c1afc8fd52d3743862cf773e34069a60f9c31)[#13966](https://github.com/envoyproxy/envoy/pull/13966)[)](/envoyproxy/envoy/commit/cb4c1afc8fd52d3743862cf773e34069a60f9c31)
    …

   ```
   Fix a bug where the transport socket options for the first downstream got reused for subsequent upstream connections.

   Risk Level: low
   Testing: new integration test
   Docs Changes: n/a
   Release Notes:
   Platform Specific Features:
   Fixes [#13659](https://github.com/envoyproxy/envoy/issues/13659)

   Signed-off-by: Alyssa Wilk <alyssar@chromium.org>
   Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
   ```

   [![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&v=4)](/cpakulski)

   [cpakulski](/envoyproxy/envoy/commits?author=cpakulski "View all commits by cpakulski")
   authored
   Nov 11, 2020

   Configuration menu

   * [View commit details](/envoyproxy/envoy/commit/cb4c1afc8fd52d3743862cf773e34069a60f9c31)
   * Copy full SHA for cb4c1af
   * [Browse repository at this point](/envoyproxy/envoy/tree/cb4c1afc8fd52d3743862cf773e34069a60f9c31)

   Copy the full SHA

    [cb4c1af](/envoyproxy/envoy/commit/cb4c1afc8fd52d3743862cf773e34069a60f9c31)View commit details

   Browse the repository at this point in the history

### Commits on Nov 16, 2020

1. [backport to 1.16: connection: Remember transport socket read resumpti…](/envoyproxy/envoy/commit/ff28aac7ea5bd6238d6b18cde1db1ddee577d104)
    …

   ```
   …on requests and replay them when re-enabling read. ([#13772](https://github.com/envoyproxy/envoy/pull/13772)) ([#14017](https://github.com/envoyproxy/envoy/pull/14017))

   Fixes SslSocket read resumption after readDisable when processing the SSL record that contains the last bytes of the HTTP message

   Risk Level: low
   Testing: new unit and integration tests
   Docs Changes: n/a
   Release Notes: added
   Platform Specific Features: n/a
   Fixes [#12304](https://github.com/envoyproxy/envoy/issues/12304)

   Signed-off-by: Antonio Vicente <avd@google.com>
   Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
   ```

   [![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&v=4)](/cpakulski)

   [cpakulski](/envoyproxy/envoy/commits?author=cpakulski "View all commits by cpakulski")
   authored
   Nov 16, 2020

   Configuration menu

   * [View commit details](/envoyproxy/envoy/commit/ff28aac7ea5bd6238d6b18cde1db1ddee577d104)
   * Copy full SHA for ff28aac
   * [Browse repository at this point](/envoyproxy/envoy/tree/ff28aac7ea5bd6238d6b18cde1db1ddee577d104)

   Copy the full SHA

    [ff28aac](/envoyproxy/envoy/commit/ff28aac7ea5bd6238d6b18cde1db1ddee577d104)View commit details

   Browse the repository at this point in the history

### Commits on Nov 19, 2020

1. [disable exact memory checks until we can sort out what changed in tcm…](/envoyproxy/envoy/commit/4a36fdba226e575117f4cd22d7792bdfe7191d92)
    …

   ```
   …alloc ([#13447](https://github.com/envoyproxy/envoy/pull/13447)) ([#14082](https://github.com/envoyproxy/envoy/pull/14082))

   Signed-off-by: Joshua Marantz <jmarantz@google.com>
   Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

   Co-authored-by: Joshua Marantz <jmarantz@google.com>
   ```

   [![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&v=4)](/cpakulski) [![@jmarantz](https://avatars.githubusercontent.com/u/1942589?s=40&v=4)](/jmarantz)

   [cpakulski](/envoyproxy/envoy/commits?author=cpakulski "View all commits by cpakulski")
   and
   [jmarantz](/envoyproxy/envoy/commits?author=jmarantz "View all commits by jmarantz")
   authored
   Nov 19, 2020

   Configuration menu

   * [View commit details](/envoyproxy/envoy/commit/4a36fdba226e575117f4cd22d7792bdfe7191d92)
   * Copy full SHA for 4a36fdb
   * [Browse repository at this point](/envoyproxy/envoy/tree/4a36fdba226e575117f4cd22d7792bdfe7191d92)

   Copy the full SHA

    [4a36fdb](/envoyproxy/envoy/commit/4a36fdba226e575117f4cd22d7792bdfe7191d92)View commit details

   Browse the repository at this point in the history

### Commits on Nov 20, 2020

1. [test: avoid use after free in oauth\_integration\_test (](/envoyproxy/envoy/commit/41be539fd79456f8edc11a2134fc6ad882cf9565)[#14103](https://github.com/envoyproxy/envoy/pull/14103)[) (](/envoyproxy/envoy/commit/41be539fd79456f8edc11a2134fc6ad882cf9565)[#14127](https://github.com/envoyproxy/envoy/pull/14127)[)](/envoyproxy/envoy/commit/41be539fd79456f8edc11a2134fc6ad882cf9565)
    …

   ```
   The client request stream can be deleted under the call stack of Envoy::IntegrationCodecClient::startRequest if the proxy replies quickly enough. Attempts to send an end stream on that request result in use-after-free on the client stream in cases where the client processed the full reply inside startRequest.

   Fixes [#12960](https://github.com/envoyproxy/envoy/issues/12960)

   Signed-off-by: Antonio Vicente <avd@google.com>
   Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

   Co-authored-by: antonio <avd@google.com>
   ```

   [![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&v=4)](/cpakulski) [![@antoniovicente](https://avatars.githubusercontent.com/u/28556681?s=40&v=4)](/antoniovicente)

   [cpakulski](/envoyproxy/envoy/commits?author=cpakulski "View all commits by cpakulski")
   and
   [antoniovicente](/envoyproxy/envoy/commits?author=antoniovicente "View all commits by antoniovicente")
   authored
   Nov 20, 2020

   Configuration menu

   * [View commit details](/envoyproxy/envoy/commit/41be539fd79456f8edc11a2134fc6ad882cf9565)
   * Copy full SHA for 41be539
   * [Browse repository at this point](/envoyproxy/envoy/tree/41be539fd79456f8edc11a2134fc6ad882cf9565)

   Copy the full SHA

    [41be539](/envoyproxy/envoy/commit/41be539fd79456f8edc11a2134fc6ad882cf9565)View commit details

   Browse the repository at this point in the history
2. [backport to 1.16: examples to use v3 configs (](/envoyproxy/envoy/commit/ad65af30c19fbfb4d3e0313fc7a78ca53da05696)[#14125](https://github.com/envoyproxy/envoy/pull/14125)[)](/envoyproxy/envoy/commit/ad65af30c19fbfb4d3e0313fc7a78ca53da05696)
    …

   ```
   Backport of PR [#13529](https://github.com/envoyproxy/envoy/pull/13529) and [#13503](https://github.com/envoyproxy/envoy/pull/13503)

   Signed-off-by: Ryan Northey <ryan@synca.io>
   Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

   Co-authored-by: phlax <phlax@users.noreply.github.com>
   ```

   [![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&v=4)](/cpakulski) [![@phlax](https://avatars.githubusercontent.com/u/454682?s=40&v=4)](/phlax)

   [cpakulski](/envoyproxy/envoy/commits?author=cpakulski "View all commits by cpakulski")
   and
   [phlax](/envoyproxy/envoy/commits?author=phlax "View all commits by phlax")
   authored
   Nov 20, 2020

   Configuration menu

   * [View commit details](/envoyproxy/envoy/commit/ad65af30c19fbfb4d3e0313fc7a78ca53da05696)
   * Copy full SHA for ad65af3
   * [Browse repository at this point](/envoyproxy/envoy/tree/ad65af30c19fbfb4d3e0313fc7a78ca53da05696)

   Copy the full SHA

    [ad65af3](/envoyproxy/envoy/commit/ad65af30c19fbfb4d3e0313fc7a78ca53da05696)View commit details

   Browse the repository at this point in the history

### Commits on Nov 21, 2020

1. [backport to 1.16: udp: properly handle truncated/dropped datagrams (](/envoyproxy/envoy/commit/675f317d5805a1b32b2dfcc8db1e41747bd143ef)[#…](https://github.com/envoyproxy/envoy/pull/14130)
    …

   ```
   […14130](https://github.com/envoyproxy/envoy/pull/14130))

   Signed-off-by: Matt Klein <mklein@lyft.com>
   Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
   Co-authored-by: Matt Klein <mklein@lyft.com>
   Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
   ```

   [![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&v=4)](/cpakulski) [![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&v=4)](/mattklein123)

   [cpakulski](/envoyproxy/envoy/commits?author=cpakulski "View all commits by cpakulski")
   and
   [mattklein123](/envoyproxy/envoy/commits?author=mattklein123 "View all commits by mattklein123")
   authored
   Nov 21, 2020

   Configuration menu

   * [View commit details](/envoyproxy/envoy/commit/675f317d5805a1b32b2dfcc8db1e41747bd143ef)
   * Copy full SHA for 675f317
   * [Browse repository at this point](/envoyproxy/envoy/tree/675f317d5805a1b32b2dfcc8db1e41747bd143ef)

   Copy the full SHA

    [675f317](/envoyproxy/envoy/commit/675f317d5805a1b32b2dfcc8db1e41747bd143ef)View commit details

   Browse the repository at this point in the history
2. [backport to 1.16: proxy protocol: set downstreamRemoteAddress on Stre…](/envoyproxy/envoy/commit/0717f49fef0dac3818cd7cdc52bf18e0ae1f7a2c)
    …

   ```
   …amInfo ([#14132](https://github.com/envoyproxy/envoy/pull/14132))

   This fixes a regression which resulted in the downstreamRemoteAddress
   on the StreamInfo for a connection not having the address supplied by
   the proxy protocol filter, but instead having the address of the
   directly connected peer.

   This issue does not affect HTTP filters.

   Signed-off-by: Greg Greenway <ggreenway@apple.com>
   ```

   [![@ggreenway](https://avatars.githubusercontent.com/u/8603643?s=40&v=4)](/ggreenway)

   [ggreenway](/envoyproxy/envoy/commits?author=ggreenway "View all commits by ggreenway")
   authored
   Nov 21, 2020

   Configuration menu

   * [View commit details](/envoyproxy/envoy/commit/0717f49fef0dac3818cd7cdc52bf18e0ae1f7a2c)
   * Copy full SHA for 0717f49
   * [Browse repository at this point](/envoyproxy/envoy/tree/0717f49fef0dac3818cd7cdc52bf18e0ae1f7a2c)

   Copy the full SHA

    [0717f49](/envoyproxy/envoy/commit/0717f49fef0dac3818cd7cdc52bf18e0ae1f7a2c)View commit details

   Browse the repository at this point in the history

 Loading

### This comparison is taking too long to generate.

Unfortunately it looks like we can’t render this comparison for you right now. It might be too big, or there might be something weird with your repository.

You can try running this command locally to see the comparison on your machine:

`git diff v1.16.0...v1.16.1`

  Retry

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f660028f_20250119_120041.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenvoyproxy%2Fenvoy%2Fissues%2F14113)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenvoyproxy%2Fenvoy%2Fissues%2F14113)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=envoyproxy%2Fenvoy)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[envoyproxy](/envoyproxy)
/
**[envoy](/envoyproxy/envoy)**
Public

* [Notifications](/login?return_to=%2Fenvoyproxy%2Fenvoy) You must be signed in to change notification settings
* [Fork
  4.9k](/login?return_to=%2Fenvoyproxy%2Fenvoy)
* [Star
   25.3k](/login?return_to=%2Fenvoyproxy%2Fenvoy)

* [Code](/envoyproxy/envoy)
* [Issues
  1.5k](/envoyproxy/envoy/issues)
* [Pull requests
  141](/envoyproxy/envoy/pulls)
* [Actions](/envoyproxy/envoy/actions)
* [Projects
  0](/envoyproxy/envoy/projects)
* [Wiki](/envoyproxy/envoy/wiki)
* [Security](/envoyproxy/envoy/security)
* [Insights](/envoyproxy/envoy/pulse)

Additional navigation options

* [Code](/envoyproxy/envoy)
* [Issues](/envoyproxy/envoy/issues)
* [Pull requests](/envoyproxy/envoy/pulls)
* [Actions](/envoyproxy/envoy/actions)
* [Projects](/envoyproxy/envoy/projects)
* [Wiki](/envoyproxy/envoy/wiki)
* [Security](/envoyproxy/envoy/security)
* [Insights](/envoyproxy/envoy/pulse)

# crash when udp packet size large than 1500 #14113

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosed[#14122](https://github.com/envoyproxy/envoy/pull/14122)Closed[crash when udp packet size large than 1500](#top)#14113[#14122](https://github.com/envoyproxy/envoy/pull/14122)Copy linkLabels[bug](https://github.com/envoyproxy/envoy/issues?q=state%3Aopen%20label%3A%22bug%22)[triageIssue requires triage](https://github.com/envoyproxy/envoy/issues?q=state%3Aopen%20label%3A%22triage%22)Issue requires triage![@3ks](https://avatars.githubusercontent.com/u/32058002?u=52f5f480fe793a626210f50636c6d3f7f918cfe2&v=4&size=80)
## Description

![@3ks](https://avatars.githubusercontent.com/u/32058002?u=52f5f480fe793a626210f50636c6d3f7f918cfe2&v=4&size=48)[3ks](https://github.com/3ks)opened [on Nov 20, 2020](https://github.com/envoyproxy/envoy/issues/14113#issue-747181376)
# crash when udp packet size large than 1500

## Description

envoy crash when udp packet size large than 1500.

> Is there any way to change the udp packet size limit?

## Repro steps

* start envoy
* envoy crash when receive packget that size larger than 1500

```
conf-jira-envoy    | [2020-11-20 05:38:55.476][73][warning][misc] [source/common/network/io_socket_handle_impl.cc:395] Dropping truncated UDP packet with size: 1686.
conf-jira-envoy    | [2020-11-20 05:38:55.476][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:104] Caught Segmentation fault, suspect faulting address 0x0
conf-jira-envoy    | [2020-11-20 05:38:55.476][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:91] Backtrace (use tools/stack_decode.py to get line numbers):
conf-jira-envoy    | [2020-11-20 05:38:55.476][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:92] Envoy version: 8fb3cb86082b17144a80402f5367ae65f06083bd/1.16.0/Clean/RELEASE/BoringSSL
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:96] #0: __restore_rt [0x7f9c2d4138a0]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #1: [0x5563a383b4ee]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #2: [0x5563a383bd47]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #3: [0x5563a3689030]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #4: [0x5563a3688de1]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #5: [0x5563a3414366]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #6: [0x5563a384cfe8]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #7: [0x5563a384b9be]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #8: [0x5563a3405838]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #9: [0x5563a39fa8c3]
conf-jira-envoy    | [2020-11-20 05:38:55.478][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:96] #10: start_thread [0x7f9c2d4086db]
conf-jira-envoy exited with code 139

```
## Config

```
admin:
  access_log_path: /tmp/admin_access.log
  address:
    socket_address:
      protocol: TCP
      address: 0.0.0.0
      port_value: 9901
static_resources:
  listeners:
    - name: listener_udp
      reuse_port: true
      address:
        socket_address:
          protocol: UDP
          address: 0.0.0.0
          port_value: 5144
      listener_filters:
        name: envoy.filters.udp_listener.udp_proxy
        typed_config:
          '@type': type.googleapis.com/envoy.extensions.filters.udp.udp_proxy.v3.UdpProxyConfig
          stat_prefix: service
          cluster: conf_jira_udp
  clusters:
    - name: conf_jira_udp
      connect_timeout: 0.25s
      type: STATIC
      lb_policy: ROUND_ROBIN
      load_assignment:
        cluster_name: conf_jira_udp
        endpoints:
          - lb_endpoints:
              - endpoint:
                  address:
                    socket_address:
                      address: 172.16.10.10
                      port_value: 6144
```
## Logs

```
conf-jira-envoy    | [2020-11-20 05:36:51.503][1][info][config] [source/server/configuration_impl.cc:95] loading tracing configuration
conf-jira-envoy    | [2020-11-20 05:36:51.503][1][info][config] [source/server/configuration_impl.cc:70] loading 0 static secret(s)
conf-jira-envoy    | [2020-11-20 05:36:51.503][1][info][config] [source/server/configuration_impl.cc:76] loading 1 cluster(s)
conf-jira-envoy    | [2020-11-20 05:36:51.506][1][info][config] [source/server/configuration_impl.cc:80] loading 1 listener(s)
conf-jira-envoy    | [2020-11-20 05:36:51.506][1][info][config] [source/server/configuration_impl.cc:121] loading stats sink configuration
conf-jira-envoy    | [2020-11-20 05:36:51.506][1][info][runtime] [source/common/runtime/runtime_impl.cc:421] RTDS has finished initialization
conf-jira-envoy    | [2020-11-20 05:36:51.506][1][info][upstream] [source/common/upstream/cluster_manager_impl.cc:178] cm init: all clusters initialized
conf-jira-envoy    | [2020-11-20 05:36:51.506][1][warning][main] [source/server/server.cc:565] there is no configured limit to the number of allowed active connections. Set a limit via the runtime key overload.global_downstream_max_connections
conf-jira-v2       | Nov 20 05:36:51.507  INFO vector::topology::builder: Healthcheck: Passed.
conf-jira-envoy    | [2020-11-20 05:36:51.508][1][info][main] [source/server/server.cc:660] all clusters initialized. initializing init manager
conf-jira-envoy    | [2020-11-20 05:36:51.508][1][info][config] [source/server/listener_manager_impl.cc:888] all dependencies initialized. starting workers
conf-jira-envoy    | [2020-11-20 05:36:51.530][1][info][main] [source/server/server.cc:679] starting main dispatch loop

conf-jira-envoy    | [2020-11-20 05:38:55.476][73][warning][misc] [source/common/network/io_socket_handle_impl.cc:395] Dropping truncated UDP packet with size: 1686.
conf-jira-envoy    | [2020-11-20 05:38:55.476][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:104] Caught Segmentation fault, suspect faulting address 0x0
conf-jira-envoy    | [2020-11-20 05:38:55.476][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:91] Backtrace (use tools/stack_decode.py to get line numbers):
conf-jira-envoy    | [2020-11-20 05:38:55.476][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:92] Envoy version: 8fb3cb86082b17144a80402f5367ae65f06083bd/1.16.0/Clean/RELEASE/BoringSSL
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:96] #0: __restore_rt [0x7f9c2d4138a0]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #1: [0x5563a383b4ee]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #2: [0x5563a383bd47]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #3: [0x5563a3689030]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #4: [0x5563a3688de1]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #5: [0x5563a3414366]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #6: [0x5563a384cfe8]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #7: [0x5563a384b9be]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #8: [0x5563a3405838]
conf-jira-envoy    | [2020-11-20 05:38:55.477][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:98] #9: [0x5563a39fa8c3]
conf-jira-envoy    | [2020-11-20 05:38:55.478][73][critical][backtrace] [bazel-out/k8-opt/bin/source/server/_virtual_includes/backtrace_lib/server/backtrace.h:96] #10: start_thread [0x7f9c2d4086db]
conf-jira-envoy exited with code 139

```
## Metadata

### Assignees

No one assigned

### Labels

[bug](https://github.com/envoyproxy/envoy/issues?q=state%3Aopen%20label%3A%22bug%22)[triageIssue requires triage](https://github.com/envoyproxy/envoy/issues?q=state%3Aopen%20label%3A%22triage%22)Issue requires triage
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_ac0b1fdb_20250119_120043.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenvoyproxy%2Fenvoy%2Fpull%2F14122)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenvoyproxy%2Fenvoy%2Fpull%2F14122)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=envoyproxy%2Fenvoy)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[envoyproxy](/envoyproxy)
/
**[envoy](/envoyproxy/envoy)**
Public

* [Notifications](/login?return_to=%2Fenvoyproxy%2Fenvoy) You must be signed in to change notification settings
* [Fork
  4.9k](/login?return_to=%2Fenvoyproxy%2Fenvoy)
* [Star
   25.3k](/login?return_to=%2Fenvoyproxy%2Fenvoy)

* [Code](/envoyproxy/envoy)
* [Issues
  1.5k](/envoyproxy/envoy/issues)
* [Pull requests
  141](/envoyproxy/envoy/pulls)
* [Actions](/envoyproxy/envoy/actions)
* [Projects
  0](/envoyproxy/envoy/projects)
* [Wiki](/envoyproxy/envoy/wiki)
* [Security](/envoyproxy/envoy/security)
* [Insights](/envoyproxy/envoy/pulse)

Additional navigation options

* [Code](/envoyproxy/envoy)
* [Issues](/envoyproxy/envoy/issues)
* [Pull requests](/envoyproxy/envoy/pulls)
* [Actions](/envoyproxy/envoy/actions)
* [Projects](/envoyproxy/envoy/projects)
* [Wiki](/envoyproxy/envoy/wiki)
* [Security](/envoyproxy/envoy/security)
* [Insights](/envoyproxy/envoy/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fenvoyproxy%2Fenvoy%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fenvoyproxy%2Fenvoy%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# udp: properly handle truncated/dropped datagrams #14122

 Merged

[mattklein123](/mattklein123)
merged 13 commits into
[envoyproxy:master](/envoyproxy/envoy/tree/master "envoyproxy/envoy:master")
from
[cpakulski:issue/14113](/cpakulski/envoy/tree/issue/14113 "cpakulski/envoy:issue/14113")

Nov 20, 2020

 Merged

# [udp: properly handle truncated/dropped datagrams](#top) #14122

[mattklein123](/mattklein123)
merged 13 commits into
[envoyproxy:master](/envoyproxy/envoy/tree/master "envoyproxy/envoy:master")
from
[cpakulski:issue/14113](/cpakulski/envoy/tree/issue/14113 "cpakulski/envoy:issue/14113")

Nov 20, 2020

[Conversation
0](/envoyproxy/envoy/pull/14122)
[Commits
13](/envoyproxy/envoy/pull/14122/commits)
[Checks
0](/envoyproxy/envoy/pull/14122/checks)
[Files changed](/envoyproxy/envoy/pull/14122/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![cpakulski](https://avatars.githubusercontent.com/u/36484366?s=60&v=4)](/cpakulski)

Copy link

Contributor

### @cpakulski **[cpakulski](/cpakulski)** commented [Nov 20, 2020](#issue-747710750)

Commit Message:

properly handle truncated/dropped datagrams

Additional Description:

Risk Level: Med

Testing:Unit tests

Docs Changes: No

Release Notes: Yes

Fixes [#14113](https://github.com/envoyproxy/envoy/issues/14113)

Sorry, something went wrong.

All reactions

 [mattklein123](/mattklein123)
and others
added 11 commits
[October 16, 2020 18:01](#commits-pushed-309ddc5)

[![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&v=4)](/mattklein123)

`[udp: properly handle truncated/dropped datagrams](/envoyproxy/envoy/pull/14122/commits/309ddc5abc1c944621f97b8e310a8106cd044178 "udp: properly handle truncated/dropped datagrams

Signed-off-by: Matt Klein <mklein@lyft.com>")`
 …

`[309ddc5](/envoyproxy/envoy/pull/14122/commits/309ddc5abc1c944621f97b8e310a8106cd044178)`

```
Signed-off-by: Matt Klein <mklein@lyft.com>
```

[![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&v=4)](/mattklein123)

`[comments](/envoyproxy/envoy/pull/14122/commits/ccb53ae2108eaa44cf0008b7c082b386998228a6 "comments

Signed-off-by: Matt Klein <mklein@lyft.com>")`
 …

`[ccb53ae](/envoyproxy/envoy/pull/14122/commits/ccb53ae2108eaa44cf0008b7c082b386998228a6)`

```
Signed-off-by: Matt Klein <mklein@lyft.com>
```

[![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&v=4)](/mattklein123)

`[fix](/envoyproxy/envoy/pull/14122/commits/f51548769ccec7023a294d9f1fc2bafc9c04ba69 "fix

Signed-off-by: Matt Klein <mklein@lyft.com>")`
 …

`[f515487](/envoyproxy/envoy/pull/14122/commits/f51548769ccec7023a294d9f1fc2bafc9c04ba69)`

```
Signed-off-by: Matt Klein <mklein@lyft.com>
```

[![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&v=4)](/mattklein123)

`[Merge branch 'master' into fix_udp_no_fragment](/envoyproxy/envoy/pull/14122/commits/5b6be5fbac69170f23800995bc544c422ef01ca5 "Merge branch 'master' into fix_udp_no_fragment

Signed-off-by: Matt Klein <mklein@lyft.com>")`
 …

`[5b6be5f](/envoyproxy/envoy/pull/14122/commits/5b6be5fbac69170f23800995bc544c422ef01ca5)`

```
Signed-off-by: Matt Klein <mklein@lyft.com>
```

[![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&v=4)](/mattklein123)

`[windows fix](/envoyproxy/envoy/pull/14122/commits/0616a2546c4029cc3a7ca82ac17324a3e75df9be "windows fix

Signed-off-by: Matt Klein <mklein@lyft.com>")`
 …

`[0616a25](/envoyproxy/envoy/pull/14122/commits/0616a2546c4029cc3a7ca82ac17324a3e75df9be)`

```
Signed-off-by: Matt Klein <mklein@lyft.com>
```

[![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&v=4)](/mattklein123)

`[Merge branch 'master' into fix_udp_no_fragment](/envoyproxy/envoy/pull/14122/commits/e482f79d2a9f3464190914e39aad6f4f2ca4d6c9 "Merge branch 'master' into fix_udp_no_fragment

Signed-off-by: Matt Klein <mklein@lyft.com>")`
 …

`[e482f79](/envoyproxy/envoy/pull/14122/commits/e482f79d2a9f3464190914e39aad6f4f2ca4d6c9)`

```
Signed-off-by: Matt Klein <mklein@lyft.com>
```

[![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&v=4)](/mattklein123)

`[fix](/envoyproxy/envoy/pull/14122/commits/060e89832d71715629835693dc9a5ebe7929346e "fix

Signed-off-by: Matt Klein <mklein@lyft.com>")`
 …

`[060e898](/envoyproxy/envoy/pull/14122/commits/060e89832d71715629835693dc9a5ebe7929346e)`

```
Signed-off-by: Matt Klein <mklein@lyft.com>
```

[![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&v=4)](/mattklein123)

`[Merge branch 'master' into fix_udp_no_fragment](/envoyproxy/envoy/pull/14122/commits/c5c36c060ec0672d4c7b27b88572f460b5cd5f2e "Merge branch 'master' into fix_udp_no_fragment

Signed-off-by: Matt Klein <mklein@lyft.com>")`
 …

`[c5c36c0](/envoyproxy/envoy/pull/14122/commits/c5c36c060ec0672d4c7b27b88572f460b5cd5f2e)`

```
Signed-off-by: Matt Klein <mklein@lyft.com>
```

[![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&v=4)](/mattklein123)

`[comments](/envoyproxy/envoy/pull/14122/commits/e876a47fe13ebb3e57e3693a0a1ad2f481f3b8ff "comments

Signed-off-by: Matt Klein <mklein@lyft.com>")`
 …

`[e876a47](/envoyproxy/envoy/pull/14122/commits/e876a47fe13ebb3e57e3693a0a1ad2f481f3b8ff)`

```
Signed-off-by: Matt Klein <mklein@lyft.com>
```

[![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&v=4)](/mattklein123)

`[Merge branch 'master' into fix_udp_no_fragment](/envoyproxy/envoy/pull/14122/commits/4bdf16686ba898c2b7e3b8bd776d3c0ff19c9f11 "Merge branch 'master' into fix_udp_no_fragment")`

`[4bdf166](/envoyproxy/envoy/pull/14122/commits/4bdf16686ba898c2b7e3b8bd776d3c0ff19c9f11)`

[![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&v=4)](/cpakulski)

`[Fix for crash when large UDP packet is received.](/envoyproxy/envoy/pull/14122/commits/b7c5e6db46447c3af0a4fc9eaba7fbd7ddeae543 "Fix for crash when large UDP packet is received.

Signed-off-by: Christoph Pakulski <christoph@tetrate.io>")`
 …

`[b7c5e6d](/envoyproxy/envoy/pull/14122/commits/b7c5e6db46447c3af0a4fc9eaba7fbd7ddeae543)`

```
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
```

 [![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&u=a0ae0bf2d200268dd7cc391803275243449ebbac&v=4)](/cpakulski)
[cpakulski](/cpakulski)
requested review from
[alyssawilk](/alyssawilk),
[ggreenway](/ggreenway) and
[mattklein123](/mattklein123)
as [code owners](/envoyproxy/envoy/blob/ca6e246336a6c454132b5c832d483b8e9aa10ca2/CODEOWNERS#L60)
[November 20, 2020 18:32](#event-4022265671)

[![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&v=4)](/cpakulski)

`[Small modifications to docs.](/envoyproxy/envoy/pull/14122/commits/4853822c45a6a2b4096d0fe48b96cfb02f7a1161 "Small modifications to docs.

Signed-off-by: Christoph Pakulski <christoph@tetrate.io>")`
 …

`[4853822](/envoyproxy/envoy/pull/14122/commits/4853822c45a6a2b4096d0fe48b96cfb02f7a1161)`

```
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
```

[![mattklein123](https://avatars.githubusercontent.com/u/6305260?s=60&v=4)](/mattklein123)

**[mattklein123](/mattklein123)**
previously approved these changes
[Nov 20, 2020](#pullrequestreview-535682974)

 [View reviewed changes](/envoyproxy/envoy/pull/14122/files)

 [![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&u=a0ae0bf2d200268dd7cc391803275243449ebbac&v=4)](/cpakulski)
[cpakulski](/cpakulski)
dismissed
[mattklein123](/mattklein123)’s [stale review](#pullrequestreview-535682974)
via
`[4853822](/envoyproxy/envoy/commit/4853822c45a6a2b4096d0fe48b96cfb02f7a1161)`
[November 20, 2020 18:34](#event-4022273117)

 [![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&u=a0ae0bf2d200268dd7cc391803275243449ebbac&v=4)](/cpakulski)
[cpakulski](/cpakulski)
[force-pushed](/envoyproxy/envoy/compare/7cd249ce53ef8de64b3565a490794ed32378ec08..4853822c45a6a2b4096d0fe48b96cfb02f7a1161)
the
issue/14113

branch
from
[`7cd249c`](/envoyproxy/envoy/commit/7cd249ce53ef8de64b3565a490794ed32378ec08) to
[`4853822`](/envoyproxy/envoy/commit/4853822c45a6a2b4096d0fe48b96cfb02f7a1161)  [Compare](/envoyproxy/envoy/compare/7cd249ce53ef8de64b3565a490794ed32378ec08..4853822c45a6a2b4096d0fe48b96cfb02f7a1161)
[November 20, 2020 18:34](#event-4022273119)

[![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&u=4439d9f238b748a46914242b963e63ec9539960a&v=4)](/mattklein123)
[mattklein123](/mattklein123)
mentioned this pull request
[Nov 20, 2020](#ref-issue-747181376)

[crash when udp packet size large than 1500
#14113](/envoyproxy/envoy/issues/14113)

Closed

[![mattklein123](https://avatars.githubusercontent.com/u/6305260?s=60&v=4)](/mattklein123)

**[mattklein123](/mattklein123)**
previously approved these changes
[Nov 20, 2020](#pullrequestreview-535683741)

 [View reviewed changes](/envoyproxy/envoy/pull/14122/files/4853822c45a6a2b4096d0fe48b96cfb02f7a1161)

[![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&v=4)](/cpakulski)

`[Corrected release notes to be in alphabetical order.](/envoyproxy/envoy/pull/14122/commits/7c1ba69889cb76523c973a4508af71f9b1410d09 "Corrected release notes to be in alphabetical order.

Signed-off-by: Christoph Pakulski <christoph@tetrate.io>")`
 …

`[7c1ba69](/envoyproxy/envoy/pull/14122/commits/7c1ba69889cb76523c973a4508af71f9b1410d09)`

```
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
```

 [![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&u=a0ae0bf2d200268dd7cc391803275243449ebbac&v=4)](/cpakulski)
[cpakulski](/cpakulski)
dismissed
[mattklein123](/mattklein123)’s [stale review](#pullrequestreview-535683741)
via
`[7c1ba69](/envoyproxy/envoy/commit/7c1ba69889cb76523c973a4508af71f9b1410d09)`
[November 20, 2020 19:02](#event-4022367743)

[![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&u=4439d9f238b748a46914242b963e63ec9539960a&v=4)](/mattklein123)
[mattklein123](/mattklein123)
self-assigned this
[Nov 20, 2020](#event-4022384522)

[![mattklein123](https://avatars.githubusercontent.com/u/6305260?s=60&v=4)](/mattklein123)

**[mattklein123](/mattklein123)**
approved these changes
[Nov 20, 2020](#pullrequestreview-535707565)

 [View reviewed changes](/envoyproxy/envoy/pull/14122/files/7c1ba69889cb76523c973a4508af71f9b1410d09)

[![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&u=4439d9f238b748a46914242b963e63ec9539960a&v=4)](/mattklein123)
[mattklein123](/mattklein123)
merged commit [`1ed6ddf`](/envoyproxy/envoy/commit/1ed6ddfb615307755643f810b078ca7fe9d771fa)
into
envoyproxy:master

[Nov 20, 2020](https://github.com/envoyproxy/envoy/pull/14122#event-4022923214)

[cpakulski](/cpakulski)
added a commit
to cpakulski/envoy
that referenced
this pull request
[Nov 20, 2020](#ref-commit-a2f5b8a)
[![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&u=a0ae0bf2d200268dd7cc391803275243449ebbac&v=4)](/cpakulski) [![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&u=4439d9f238b748a46914242b963e63ec9539960a&v=4)](/mattklein123)

`[udp: properly handle truncated/dropped datagrams (](/cpakulski/envoy/commit/a2f5b8a2aac665e4c86282ab729aa9c2bd557362 "udp: properly handle truncated/dropped datagrams (#14122)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>")[envoyproxy#14122](https://github.com/envoyproxy/envoy/pull/14122)[)](/cpakulski/envoy/commit/a2f5b8a2aac665e4c86282ab729aa9c2bd557362 "udp: properly handle truncated/dropped datagrams (#14122)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>")`
…

`[a2f5b8a](/cpakulski/envoy/commit/a2f5b8a2aac665e4c86282ab729aa9c2bd557362)`

```
Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
```

[cpakulski](/cpakulski)
added a commit
to cpakulski/envoy
that referenced
this pull request
[Nov 24, 2020](#ref-commit-c6a29a9)
[![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&u=a0ae0bf2d200268dd7cc391803275243449ebbac&v=4)](/cpakulski) [![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&u=4439d9f238b748a46914242b963e63ec9539960a&v=4)](/mattklein123)

`[udp: properly handle truncated/dropped datagrams (](/cpakulski/envoy/commit/c6a29a9e83d1597ec7b62d27a195645fd9f85fee "udp: properly handle truncated/dropped datagrams (#14122)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>")[envoyproxy#14122](https://github.com/envoyproxy/envoy/pull/14122)[)](/cpakulski/envoy/commit/c6a29a9e83d1597ec7b62d27a195645fd9f85fee "udp: properly handle truncated/dropped datagrams (#14122)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>")`
…

`[c6a29a9](/cpakulski/envoy/commit/c6a29a9e83d1597ec7b62d27a195645fd9f85fee)`

```
Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
```

[andreyprezotto](/andreyprezotto)
pushed a commit
to andreyprezotto/envoy
that referenced
this pull request
[Nov 24, 2020](#ref-commit-ab6e2ff)
[![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&u=a0ae0bf2d200268dd7cc391803275243449ebbac&v=4)](/cpakulski) [![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&u=4439d9f238b748a46914242b963e63ec9539960a&v=4)](/mattklein123) [![@andreyprezotto](https://avatars.githubusercontent.com/u/43416671?s=40&v=4)](/andreyprezotto)

`[udp: properly handle truncated/dropped datagrams (](/andreyprezotto/envoy/commit/ab6e2ff672a50f5b3f25cf4a32d56c92560b849f "udp: properly handle truncated/dropped datagrams (#14122)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>")[envoyproxy#14122](https://github.com/envoyproxy/envoy/pull/14122)[)](/andreyprezotto/envoy/commit/ab6e2ff672a50f5b3f25cf4a32d56c92560b849f "udp: properly handle truncated/dropped datagrams (#14122)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>")`
…

`[ab6e2ff](/andreyprezotto/envoy/commit/ab6e2ff672a50f5b3f25cf4a32d56c92560b849f)`

```
Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
```

[qqustc](/qqustc)
pushed a commit
to qqustc/envoy
that referenced
this pull request
[Nov 24, 2020](#ref-commit-467d6ee)
[![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&u=a0ae0bf2d200268dd7cc391803275243449ebbac&v=4)](/cpakulski) [![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&u=4439d9f238b748a46914242b963e63ec9539960a&v=4)](/mattklein123) [![@qqustc](https://avatars.githubusercontent.com/u/17820715?s=40&v=4)](/qqustc)

`[udp: properly handle truncated/dropped datagrams (](/qqustc/envoy/commit/467d6eebb44748ada9d174206cee9b938e097928 "udp: properly handle truncated/dropped datagrams (#14122)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
Signed-off-by: Qin Qin <qqin@google.com>")[envoyproxy#14122](https://github.com/envoyproxy/envoy/pull/14122)[)](/qqustc/envoy/commit/467d6eebb44748ada9d174206cee9b938e097928 "udp: properly handle truncated/dropped datagrams (#14122)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
Signed-off-by: Qin Qin <qqin@google.com>")`
…

`[467d6ee](/qqustc/envoy/commit/467d6eebb44748ada9d174206cee9b938e097928)`

```
Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
Signed-off-by: Qin Qin <qqin@google.com>
```

[cpakulski](/cpakulski)
added a commit
to cpakulski/envoy
that referenced
this pull request
[Nov 25, 2020](#ref-commit-1c163f0)
[![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&u=a0ae0bf2d200268dd7cc391803275243449ebbac&v=4)](/cpakulski) [![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&u=4439d9f238b748a46914242b963e63ec9539960a&v=4)](/mattklein123)

`[udp: properly handle truncated/dropped datagrams (](/cpakulski/envoy/commit/1c163f0b37783e3c3e6665dc735ccd7f3b671a46 "udp: properly handle truncated/dropped datagrams (#14122)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>")[envoyproxy#14122](https://github.com/envoyproxy/envoy/pull/14122)[)](/cpakulski/envoy/commit/1c163f0b37783e3c3e6665dc735ccd7f3b671a46 "udp: properly handle truncated/dropped datagrams (#14122)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>")`
…

`[1c163f0](/cpakulski/envoy/commit/1c163f0b37783e3c3e6665dc735ccd7f3b671a46)`

```
Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
```

[cpakulski](/cpakulski)
added a commit
to cpakulski/envoy
that referenced
this pull request
[Nov 26, 2020](#ref-commit-24d133a)
[![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&u=a0ae0bf2d200268dd7cc391803275243449ebbac&v=4)](/cpakulski) [![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&u=4439d9f238b748a46914242b963e63ec9539960a&v=4)](/mattklein123)

`[udp: properly handle truncated/dropped datagrams (](/cpakulski/envoy/commit/24d133af36fe034431d49b7d0a7e8130f066f5c8 "udp: properly handle truncated/dropped datagrams (#14122)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>")[envoyproxy#14122](https://github.com/envoyproxy/envoy/pull/14122)[)](/cpakulski/envoy/commit/24d133af36fe034431d49b7d0a7e8130f066f5c8 "udp: properly handle truncated/dropped datagrams (#14122)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>")`
…

`[24d133a](/cpakulski/envoy/commit/24d133af36fe034431d49b7d0a7e8130f066f5c8)`

```
Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
```

[antoniovicente](/antoniovicente)
pushed a commit
that referenced
this pull request
[Dec 1, 2020](#ref-commit-21ad0d9)
[![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&u=a0ae0bf2d200268dd7cc391803275243449ebbac&v=4)](/cpakulski) [![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&u=4439d9f238b748a46914242b963e63ec9539960a&v=4)](/mattklein123)

`[backport to 1.14: udp: properly handle truncated/dropped datagrams (](/envoyproxy/envoy/commit/21ad0d90fee92fad552013b01be7a9c1fa41769c "backport to 1.14: udp: properly handle truncated/dropped datagrams (#14122) (#14192)

* udp: properly handle truncated/dropped datagrams (#14122)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>")[#…](https://github.com/envoyproxy/envoy/pull/14122)`
…

`[21ad0d9](/envoyproxy/envoy/commit/21ad0d90fee92fad552013b01be7a9c1fa41769c)`

```
[…14122](https://github.com/envoyproxy/envoy/pull/14122)) ([#14192](https://github.com/envoyproxy/envoy/pull/14192))

* udp: properly handle truncated/dropped datagrams ([#14122](https://github.com/envoyproxy/envoy/pull/14122))

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
```

[antoniovicente](/antoniovicente)
pushed a commit
that referenced
this pull request
[Dec 1, 2020](#ref-commit-605560f)
[![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&u=a0ae0bf2d200268dd7cc391803275243449ebbac&v=4)](/cpakulski) [![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&u=4439d9f238b748a46914242b963e63ec9539960a&v=4)](/mattklein123)

`[backport to 1.13: udp: properly handle truncated/dropped datagrams (](/envoyproxy/envoy/commit/605560f3aae723b090355e4a00322272ebbd0dd2 "backport to 1.13: udp: properly handle truncated/dropped datagrams (#14122) (#14198)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>")[#…](https://github.com/envoyproxy/envoy/pull/14122)`
…

`[605560f](/envoyproxy/envoy/commit/605560f3aae723b090355e4a00322272ebbd0dd2)`

```
[…14122](https://github.com/envoyproxy/envoy/pull/14122)) ([#14198](https://github.com/envoyproxy/envoy/pull/14198))

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
```

[antoniovicente](/antoniovicente)
pushed a commit
that referenced
this pull request
[Dec 1, 2020](#ref-commit-9a625be)
[![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&u=a0ae0bf2d200268dd7cc391803275243449ebbac&v=4)](/cpakulski) [![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&u=4439d9f238b748a46914242b963e63ec9539960a&v=4)](/mattklein123)

`[backport to 1.15: udp: properly handle truncated/dropped datagrams (](/envoyproxy/envoy/commit/9a625be26b2a1f91693e0ce0fd0417a4bf0e4bed "backport to 1.15: udp: properly handle truncated/dropped datagrams (#14122) (#14166)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>")[#…](https://github.com/envoyproxy/envoy/pull/14122)`
…

`[9a625be](/envoyproxy/envoy/commit/9a625be26b2a1f91693e0ce0fd0417a4bf0e4bed)`

```
[…14122](https://github.com/envoyproxy/envoy/pull/14122)) ([#14166](https://github.com/envoyproxy/envoy/pull/14166))

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
```

 [![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&u=a0ae0bf2d200268dd7cc391803275243449ebbac&v=4)](/cpakulski)
[cpakulski](/cpakulski)
deleted the
issue/14113

branch
[December 14, 2020 21:10](#event-4111352175)

[istio-testing](/istio-testing)
pushed a commit
to istio/envoy
that referenced
this pull request
[Jan 8, 2021](#ref-commit-a0eff54)
[![@bianpengyuan](https://avatars.githubusercontent.com/u/34738376?s=40&u=40f5ada49dbbf27dadd6b70923c53c76665ec7b7&v=4)](/bianpengyuan) [![@PiotrSikora](https://avatars.githubusercontent.com/u/190297?s=40&u=d74930462c3fab97d56d4b95b92f7a6f64714e9a&v=4)](/PiotrSikora)
[![@antoniovicente](https://avatars.githubusercontent.com/u/28556681?s=40&u=ffe9ba790da291946f6ac43a26e85f4ba9dbd71d&v=4)](/antoniovicente) [![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&u=4439d9f238b748a46914242b963e63ec9539960a&v=4)](/mattklein123) [![@lizan](https://avatars.githubusercontent.com/u/1016047?s=40&u=ca050d7a63ee04431f6ba61a198ca4fe1c82e627&v=4)](/lizan) [![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=40&u=a0ae0bf2d200268dd7cc391803275243449ebbac&v=4)](/cpakulski) [![@asraa](https://avatars.githubusercontent.com/u/5194569?s=40&u=f7434e64e439c0a6534a4e77cebb842499736cc3&v=4)](/asraa) [![@jmarantz](https://avatars.githubusercontent.com/u/1942589?s=40&u=826e82aad36e4664ac3f96f27dfc6e7ea3ef4781&v=4)](/jmarantz) [![@Shikugawa](https://avatars.githubusercontent.com/u/17607122?s=40&u=b8a660796bebfd858d027657420ddfd7702fe645&v=4)](/Shikugawa) [![@alyssawilk](https://avatars.githubusercontent.com/u/18220477?s=40&u=2f4fcb7ee026739625e7ee29a2898963a877cb84&v=4)](/alyssawilk)

`[[release-1.7] Backport Envoy 1.15 fixes (](/istio/envoy/commit/a0eff54331dd442dbe41dd74939ef1d5022d6a29 "[release-1.7] Backport Envoy 1.15 fixes (#290)

* docs: kick-off 1.15.1 release. (#12166)

Signed-off-by: Piotr Sikora <piotrsikora@google.com>

* tls: update BoringSSL-FIPS to 20190808. (#12170)

Signed-off-by: Piotr Sikora <piotrsikora@google.com>

* test: Exclude wasm_vm_test from CI by making it a \"manual\" test. (#207)

The wee v8 build times out in CI under --config=asan because the machine the job is scheduled on is too small.

Signed-off-by: Antonio Vicente <avd@google.com>

* [v1.15] http: header map security fixes for duplicate headers (#197) (#200)

Previously header matching did not match on all headers for
non-inline headers. This patch changes the default behavior to
always logically match on all headers. Multiple individual
headers will be logically concatenated with ',' similar to what
is done with inline headers. This makes the behavior effectively
consistent. This behavior can be temporary reverted by setting
the runtime value \"envoy.reloadable_features.header_match_on_all_headers\"
to \"false\".

Targeted fixes have been additionally performed on the following
extensions which make them consider all duplicate headers by default as
a comma concatenated list:
1) Any extension using CEL matching on headers.
2) The header to metadata filter.
3) The JWT filter.
4) The Lua filter.
Like primary header matching used in routing, RBAC, etc. this behavior
can be disabled by setting the runtime value
\"envoy.reloadable_features.header_match_on_all_headers\" to false.

Finally, the setCopy() header map API previously only set the first
header in the case of duplicate non-inline headers. setCopy() now
behaves similiarly to the other set*() APIs and replaces all found
headers with a single value. This may have had security implications
in the extauth filter which uses this API. This behavior can be disabled
by setting the runtime value
\"envoy.reloadable_features.http_set_copy_replace_all_headers\" to false.

Fixes https://github.com/envoyproxy/envoy-setec/issues/188

Signed-off-by: Matt Klein <mklein@lyft.com>

* backport to v1.15: Fix Kafka Repository Location (#223)

Update mirror used to fetch kafka dependency to a valid, working mirror.

Based on #13025
Resolves #13011

Signed-off-by: Antonio Vicente <avd@google.com>

* release: cutting 1.15.1 (#217)

Signed-off-by: Antonio Vicente <avd@google.com>

* docs: Fix release notes for v1.15.1 release. (#13318)

Signed-off-by: Antonio Vicente <avd@google.com>

* Backport flaky test and tsan fixes to releases/v1.15 branch (#13337)

* hds: fix integration test flakes (#12214)

Part of https://github.com/envoyproxy/envoy/issues/12184

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Antonio Vicente <avd@google.com>

* Switch to a tsan-instrumented libc++ for tsan tests (#12134)

This fixes https://github.com/envoyproxy/envoy/issues/9784 and re-enables vhds_integration_test

Risk Level: Low, but will most likely increase memory usage

Signed-off-by: Dmitri Dolguikh <ddolguik@redhat.com>

Signed-off-by: Antonio Vicente <avd@google.com>

* test: shard hds_integration_test (#12482)

This should avoid TSAN timeout flakes.

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Antonio Vicente <avd@google.com>

* test: shard http2_integration_test (#11939)

This should mitigate TSAN timeout.

Signed-off-by: Lizan Zhou <lizan@tetrate.io>
Signed-off-by: Antonio Vicente <avd@google.com>

* test: fix http2_integration_test flake (#12450)

Fixes https://github.com/envoyproxy/envoy/issues/12442

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Antonio Vicente <avd@google.com>

* Kick CI

Signed-off-by: Antonio Vicente <avd@google.com>

Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Dmitri Dolguikh <ddolguik@redhat.com>
Co-authored-by: Lizan Zhou <lizan@tetrate.io>

* docs: kick off v1.15.3-dev (#13695)

Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* 1.15: CI fixes backport (#13697)

Backport following commits to 1.15:
748b2ab (mac ci: try ignoring update failure (#13658), 2020-10-20)
f95f539 (ci: various improvements (#13660), 2020-10-20)
73d78f8 (ci: use multiple stage (#13557), 2020-10-15)
b7a4756 (ci: use azp for api and go-control-plane sync (#13550), 2020-10-14)
876a6bb (ci use azp to sync filter example (#13501), 2020-10-12)
a0f31ee (ci: use azp to generate docs (#13481), 2020-10-12)

Signed-off-by: Lizan Zhou <lizan@tetrate.io>
Co-authored-by: asraa <asraa@google.com>

* 1.15: fix CI script (#13724)

Signed-off-by: Lizan Zhou <lizan@tetrate.io>

* Prevent SEGFAULT when disabling listener (#13515) (#13903)

This prevents the stop_listening overload action from causing
segmentation faults that can occur if the action is enabled after the
listener has already shut down.

Signed-off-by: Alex Konradi <akonradi@google.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* proxy protocol: set downstreamRemoteAddress on StreamInfo (#14131) (#14169)

This fixes a regression which resulted in the downstreamRemoteAddress
on the StreamInfo for a connection not having the address supplied by
the proxy protocol filter, but instead having the address of the
directly connected peer.

This issue does not affect HTTP filters.

Fixes #14087

Signed-off-by: Greg Greenway <ggreenway@apple.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* ci: temproray disable vhds_integration_test in TSAN (#12067) (#14217)

Signed-off-by: Lizan Zhou <lizan@tetrate.io>

* tcmalloc changed and the data coming out of tcmalloc::MallocExtension::GetNumericProperty(\"generic.current_allocated_bytes\") (#14165)

Commit Message: tcmalloc changed and the data coming out of tcmalloc::MallocExtension::GetNumericProperty(\"generic.current_allocated_bytes\") no longer appears to be deterministic, even in unthreaded tests. So disable exact mem checks till we sort that out
Additional Description:
Risk Level: low
Testing: just thread_local_store_test
Docs Changes: n/a
Release Notes: n/a

no longer appears to be deterministic, even in unthreaded tests. So disable exact mem checks till we sort that out

Signed-off-by: Joshua Marantz <jmarantz@google.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

Co-authored-by: Joshua Marantz <jmarantz@google.com>

* backport to v1.15: connection: Remember transport socket read resumption requests and replay them when re-enabling read. (#13772) (#14173)

* connection: Remember transport socket read resumption requests and replay them when re-enabling read. (#13772)

Fixes SslSocket read resumption after readDisable when processing the SSL record that contains the last bytes of the HTTP message

Signed-off-by: Antonio Vicente <avd@google.com>

* backport to 1.15: udp: properly handle truncated/dropped datagrams (#14122) (#14166)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>

* backport to 1.15: vrp: allow supervisord to open its log file (#14066) (#14280)

Commit Message: Allow supervisord to open its log file
Additional Description:
Change the default location of the log file and give supervisord
permissions to write to it.

Risk Level: low
Testing: built image locally
Docs Changes: n/a
Release Notes: n/a
Platform Specific Features: n/a

Signed-off-by: Alex Konradi <akonradi@google.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* rel 1.15: close release 1.15.3 (#14303)

Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* Kick off rel 1.15.4. (#14323)

Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* backport to 1.15: http: fix datadog and squash handling of responses without body (#13328) (#14458)

Commit Message: Fixing bugs in datadog and sqaush where unexpected bodyless responses would crash Envoy
Risk Level: low
Testing: new unit tests, updated certs
Docs Changes: n/a
Release Notes: inline
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: alyssawilk <alyssar@chromium.org>

* backport 1.15: http: fixing a bug with IPv6 hosts (#14273)

Fixing a bug where HTTP parser offsets for IPv6 hosts did not include [] and Envoy assumed it did.
This results in mis-parsing addresses for IPv6 CONNECT requests and IPv6 hosts in fully URLs over HTTP/1.1

Risk Level: low
Testing: new unit, integration tests
Docs Changes: n/a
Release Notes: inline

Signed-off-by: Shikugawa <rei@tetrate.io>
Co-authored-by: alyssawilk <alyssar@chromium.org>

* backport to 1.15: tls: fix detection of the upstream connection close event. (#13858) (#14568)

Fixes #13856.

Signed-off-by: Piotr Sikora <piotrsikora@google.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

Co-authored-by: Piotr Sikora <piotrsikora@google.com>
Co-authored-by: antonio <avd@google.com>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Dmitri Dolguikh <ddolguik@redhat.com>
Co-authored-by: Lizan Zhou <lizan@tetrate.io>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: asraa <asraa@google.com>
Co-authored-by: Joshua Marantz <jmarantz@google.com>
Co-authored-by: Rei Shimizu <Shikugawa@gmail.com>
Co-authored-by: alyssawilk <alyssar@chromium.org>")[#290](https://github.com/istio/envoy/pull/290)[)](/istio/envoy/commit/a0eff54331dd442dbe41dd74939ef1d5022d6a29 "[release-1.7] Backport Envoy 1.15 fixes (#290)

* docs: kick-off 1.15.1 release. (#12166)

Signed-off-by: Piotr Sikora <piotrsikora@google.com>

* tls: update BoringSSL-FIPS to 20190808. (#12170)

Signed-off-by: Piotr Sikora <piotrsikora@google.com>

* test: Exclude wasm_vm_test from CI by making it a \"manual\" test. (#207)

The wee v8 build times out in CI under --config=asan because the machine the job is scheduled on is too small.

Signed-off-by: Antonio Vicente <avd@google.com>

* [v1.15] http: header map security fixes for duplicate headers (#197) (#200)

Previously header matching did not match on all headers for
non-inline headers. This patch changes the default behavior to
always logically match on all headers. Multiple individual
headers will be logically concatenated with ',' similar to what
is done with inline headers. This makes the behavior effectively
consistent. This behavior can be temporary reverted by setting
the runtime value \"envoy.reloadable_features.header_match_on_all_headers\"
to \"false\".

Targeted fixes have been additionally performed on the following
extensions which make them consider all duplicate headers by default as
a comma concatenated list:
1) Any extension using CEL matching on headers.
2) The header to metadata filter.
3) The JWT filter.
4) The Lua filter.
Like primary header matching used in routing, RBAC, etc. this behavior
can be disabled by setting the runtime value
\"envoy.reloadable_features.header_match_on_all_headers\" to false.

Finally, the setCopy() header map API previously only set the first
header in the case of duplicate non-inline headers. setCopy() now
behaves similiarly to the other set*() APIs and replaces all found
headers with a single value. This may have had security implications
in the extauth filter which uses this API. This behavior can be disabled
by setting the runtime value
\"envoy.reloadable_features.http_set_copy_replace_all_headers\" to false.

Fixes https://github.com/envoyproxy/envoy-setec/issues/188

Signed-off-by: Matt Klein <mklein@lyft.com>

* backport to v1.15: Fix Kafka Repository Location (#223)

Update mirror used to fetch kafka dependency to a valid, working mirror.

Based on #13025
Resolves #13011

Signed-off-by: Antonio Vicente <avd@google.com>

* release: cutting 1.15.1 (#217)

Signed-off-by: Antonio Vicente <avd@google.com>

* docs: Fix release notes for v1.15.1 release. (#13318)

Signed-off-by: Antonio Vicente <avd@google.com>

* Backport flaky test and tsan fixes to releases/v1.15 branch (#13337)

* hds: fix integration test flakes (#12214)

Part of https://github.com/envoyproxy/envoy/issues/12184

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Antonio Vicente <avd@google.com>

* Switch to a tsan-instrumented libc++ for tsan tests (#12134)

This fixes https://github.com/envoyproxy/envoy/issues/9784 and re-enables vhds_integration_test

Risk Level: Low, but will most likely increase memory usage

Signed-off-by: Dmitri Dolguikh <ddolguik@redhat.com>

Signed-off-by: Antonio Vicente <avd@google.com>

* test: shard hds_integration_test (#12482)

This should avoid TSAN timeout flakes.

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Antonio Vicente <avd@google.com>

* test: shard http2_integration_test (#11939)

This should mitigate TSAN timeout.

Signed-off-by: Lizan Zhou <lizan@tetrate.io>
Signed-off-by: Antonio Vicente <avd@google.com>

* test: fix http2_integration_test flake (#12450)

Fixes https://github.com/envoyproxy/envoy/issues/12442

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Antonio Vicente <avd@google.com>

* Kick CI

Signed-off-by: Antonio Vicente <avd@google.com>

Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Dmitri Dolguikh <ddolguik@redhat.com>
Co-authored-by: Lizan Zhou <lizan@tetrate.io>

* docs: kick off v1.15.3-dev (#13695)

Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* 1.15: CI fixes backport (#13697)

Backport following commits to 1.15:
748b2ab (mac ci: try ignoring update failure (#13658), 2020-10-20)
f95f539 (ci: various improvements (#13660), 2020-10-20)
73d78f8 (ci: use multiple stage (#13557), 2020-10-15)
b7a4756 (ci: use azp for api and go-control-plane sync (#13550), 2020-10-14)
876a6bb (ci use azp to sync filter example (#13501), 2020-10-12)
a0f31ee (ci: use azp to generate docs (#13481), 2020-10-12)

Signed-off-by: Lizan Zhou <lizan@tetrate.io>
Co-authored-by: asraa <asraa@google.com>

* 1.15: fix CI script (#13724)

Signed-off-by: Lizan Zhou <lizan@tetrate.io>

* Prevent SEGFAULT when disabling listener (#13515) (#13903)

This prevents the stop_listening overload action from causing
segmentation faults that can occur if the action is enabled after the
listener has already shut down.

Signed-off-by: Alex Konradi <akonradi@google.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* proxy protocol: set downstreamRemoteAddress on StreamInfo (#14131) (#14169)

This fixes a regression which resulted in the downstreamRemoteAddress
on the StreamInfo for a connection not having the address supplied by
the proxy protocol filter, but instead having the address of the
directly connected peer.

This issue does not affect HTTP filters.

Fixes #14087

Signed-off-by: Greg Greenway <ggreenway@apple.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* ci: temproray disable vhds_integration_test in TSAN (#12067) (#14217)

Signed-off-by: Lizan Zhou <lizan@tetrate.io>

* tcmalloc changed and the data coming out of tcmalloc::MallocExtension::GetNumericProperty(\"generic.current_allocated_bytes\") (#14165)

Commit Message: tcmalloc changed and the data coming out of tcmalloc::MallocExtension::GetNumericProperty(\"generic.current_allocated_bytes\") no longer appears to be deterministic, even in unthreaded tests. So disable exact mem checks till we sort that out
Additional Description:
Risk Level: low
Testing: just thread_local_store_test
Docs Changes: n/a
Release Notes: n/a

no longer appears to be deterministic, even in unthreaded tests. So disable exact mem checks till we sort that out

Signed-off-by: Joshua Marantz <jmarantz@google.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

Co-authored-by: Joshua Marantz <jmarantz@google.com>

* backport to v1.15: connection: Remember transport socket read resumption requests and replay them when re-enabling read. (#13772) (#14173)

* connection: Remember transport socket read resumption requests and replay them when re-enabling read. (#13772)

Fixes SslSocket read resumption after readDisable when processing the SSL record that contains the last bytes of the HTTP message

Signed-off-by: Antonio Vicente <avd@google.com>

* backport to 1.15: udp: properly handle truncated/dropped datagrams (#14122) (#14166)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>

* backport to 1.15: vrp: allow supervisord to open its log file (#14066) (#14280)

Commit Message: Allow supervisord to open its log file
Additional Description:
Change the default location of the log file and give supervisord
permissions to write to it.

Risk Level: low
Testing: built image locally
Docs Changes: n/a
Release Notes: n/a
Platform Specific Features: n/a

Signed-off-by: Alex Konradi <akonradi@google.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* rel 1.15: close release 1.15.3 (#14303)

Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* Kick off rel 1.15.4. (#14323)

Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* backport to 1.15: http: fix datadog and squash handling of responses without body (#13328) (#14458)

Commit Message: Fixing bugs in datadog and sqaush where unexpected bodyless responses would crash Envoy
Risk Level: low
Testing: new unit tests, updated certs
Docs Changes: n/a
Release Notes: inline
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: alyssawilk <alyssar@chromium.org>

* backport 1.15: http: fixing a bug with IPv6 hosts (#14273)

Fixing a bug where HTTP parser offsets for IPv6 hosts did not include [] and Envoy assumed it did.
This results in mis-parsing addresses for IPv6 CONNECT requests and IPv6 hosts in fully URLs over HTTP/1.1

Risk Level: low
Testing: new unit, integration tests
Docs Changes: n/a
Release Notes: inline

Signed-off-by: Shikugawa <rei@tetrate.io>
Co-authored-by: alyssawilk <alyssar@chromium.org>

* backport to 1.15: tls: fix detection of the upstream connection close event. (#13858) (#14568)

Fixes #13856.

Signed-off-by: Piotr Sikora <piotrsikora@google.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

Co-authored-by: Piotr Sikora <piotrsikora@google.com>
Co-authored-by: antonio <avd@google.com>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Dmitri Dolguikh <ddolguik@redhat.com>
Co-authored-by: Lizan Zhou <lizan@tetrate.io>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: asraa <asraa@google.com>
Co-authored-by: Joshua Marantz <jmarantz@google.com>
Co-authored-by: Rei Shimizu <Shikugawa@gmail.com>
Co-authored-by: alyssawilk <alyssar@chromium.org>")`
…

`[a0eff54](/istio/envoy/commit/a0eff54331dd442dbe41dd74939ef1d5022d6a29)`

```
* docs: kick-off 1.15.1 release. ([envoyproxy#12166](https://github.com/envoyproxy/envoy/pull/12166))

Signed-off-by: Piotr Sikora <piotrsikora@google.com>

* tls: update BoringSSL-FIPS to 20190808. ([envoyproxy#12170](https://github.com/envoyproxy/envoy/pull/12170))

Signed-off-by: Piotr Sikora <piotrsikora@google.com>

* test: Exclude wasm_vm_test from CI by making it a "manual" test. ([#207](https://github.com/istio/envoy/pull/207))

The wee v8 build times out in CI under --config=asan because the machine the job is scheduled on is too small.

Signed-off-by: Antonio Vicente <avd@google.com>

* [v1.15] http: header map security fixes for duplicate headers ([#197](https://github.com/istio/envoy/pull/197)) ([#200](https://github.com/istio/envoy/pull/200))

Previously header matching did not match on all headers for
non-inline headers. This patch changes the default behavior to
always logically match on all headers. Multiple individual
headers will be logically concatenated with ',' similar to what
is done with inline headers. This makes the behavior effectively
consistent. This behavior can be temporary reverted by setting
the runtime value "envoy.reloadable_features.header_match_on_all_headers"
to "false".

Targeted fixes have been additionally performed on the following
extensions which make them consider all duplicate headers by default as
a comma concatenated list:
1) Any extension using CEL matching on headers.
2) The header to metadata filter.
3) The JWT filter.
4) The Lua filter.
Like primary header matching used in routing, RBAC, etc. this behavior
can be disabled by setting the runtime value
"envoy.reloadable_features.header_match_on_all_headers" to false.

Finally, the setCopy() header map API previously only set the first
header in the case of duplicate non-inline headers. setCopy() now
behaves similiarly to the other set*() APIs and replaces all found
headers with a single value. This may have had security implications
in the extauth filter which uses this API. This behavior can be disabled
by setting the runtime value
"envoy.reloadable_features.http_set_copy_replace_all_headers" to false.

Fixes <https://github.com/envoyproxy/envoy-setec/issues/188>

Signed-off-by: Matt Klein <mklein@lyft.com>

* backport to v1.15: Fix Kafka Repository Location ([#223](https://github.com/istio/envoy/pull/223))

Update mirror used to fetch kafka dependency to a valid, working mirror.

Based on [envoyproxy#13025](https://github.com/envoyproxy/envoy/pull/13025)
Resolves [envoyproxy#13011](https://github.com/envoyproxy/envoy/issues/13011)

Signed-off-by: Antonio Vicente <avd@google.com>

* release: cutting 1.15.1 ([#217](https://github.com/istio/envoy/pull/217))

Signed-off-by: Antonio Vicente <avd@google.com>

* docs: Fix release notes for v1.15.1 release. ([envoyproxy#13318](https://github.com/envoyproxy/envoy/pull/13318))

Signed-off-by: Antonio Vicente <avd@google.com>

* Backport flaky test and tsan fixes to releases/v1.15 branch ([envoyproxy#13337](https://github.com/envoyproxy/envoy/pull/13337))

* hds: fix integration test flakes ([envoyproxy#12214](https://github.com/envoyproxy/envoy/pull/12214))

Part of [envoyproxy#12184](https://github.com/envoyproxy/envoy/issues/12184)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Antonio Vicente <avd@google.com>

* Switch to a tsan-instrumented libc++ for tsan tests ([envoyproxy#12134](https://github.com/envoyproxy/envoy/pull/12134))

This fixes [envoyproxy#9784](https://github.com/envoyproxy/envoy/issues/9784) and re-enables vhds_integration_test

Risk Level: Low, but will most likely increase memory usage

Signed-off-by: Dmitri Dolguikh <ddolguik@redhat.com>

Signed-off-by: Antonio Vicente <avd@google.com>

* test: shard hds_integration_test ([envoyproxy#12482](https://github.com/envoyproxy/envoy/pull/12482))

This should avoid TSAN timeout flakes.

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Antonio Vicente <avd@google.com>

* test: shard http2_integration_test ([envoyproxy#11939](https://github.com/envoyproxy/envoy/pull/11939))

This should mitigate TSAN timeout.

Signed-off-by: Lizan Zhou <lizan@tetrate.io>
Signed-off-by: Antonio Vicente <avd@google.com>

* test: fix http2_integration_test flake ([envoyproxy#12450](https://github.com/envoyproxy/envoy/pull/12450))

Fixes [envoyproxy#12442](https://github.com/envoyproxy/envoy/issues/12442)

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Antonio Vicente <avd@google.com>

* Kick CI

Signed-off-by: Antonio Vicente <avd@google.com>

Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Dmitri Dolguikh <ddolguik@redhat.com>
Co-authored-by: Lizan Zhou <lizan@tetrate.io>

* docs: kick off v1.15.3-dev ([envoyproxy#13695](https://github.com/envoyproxy/envoy/pull/13695))

Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* 1.15: CI fixes backport ([envoyproxy#13697](https://github.com/envoyproxy/envoy/pull/13697))

Backport following commits to 1.15:
[748b2ab](https://github.com/istio/envoy/commit/748b2ab1c54d91790642a79153e1ccb8c4b67ca5) (mac ci: try ignoring update failure ([envoyproxy#13658](https://github.com/envoyproxy/envoy/pull/13658)), 2020-10-20)
[f95f539](https://github.com/istio/envoy/commit/f95f5391b0b8683081ec786ea946026594955fc6) (ci: various improvements ([envoyproxy#13660](https://github.com/envoyproxy/envoy/pull/13660)), 2020-10-20)
[73d78f8](https://github.com/istio/envoy/commit/73d78f8d6a7d031ec7a0e06365e729e75f1b677d) (ci: use multiple stage ([envoyproxy#13557](https://github.com/envoyproxy/envoy/pull/13557)), 2020-10-15)
[b7a4756](https://github.com/istio/envoy/commit/b7a47564ca2ee6844f6344a4f8152d40c052da86) (ci: use azp for api and go-control-plane sync ([envoyproxy#13550](https://github.com/envoyproxy/envoy/pull/13550)), 2020-10-14)
[876a6bb](https://github.com/istio/envoy/commit/876a6bb52755b5eb8a78f5bd2f7fd51cfad10410) (ci use azp to sync filter example ([envoyproxy#13501](https://github.com/envoyproxy/envoy/pull/13501)), 2020-10-12)
[a0f31ee](https://github.com/istio/envoy/commit/a0f31ee8600256a74caa66e2fd925fd7f6a92823) (ci: use azp to generate docs ([envoyproxy#13481](https://github.com/envoyproxy/envoy/pull/13481)), 2020-10-12)

Signed-off-by: Lizan Zhou <lizan@tetrate.io>
Co-authored-by: asraa <asraa@google.com>

* 1.15: fix CI script ([envoyproxy#13724](https://github.com/envoyproxy/envoy/pull/13724))

Signed-off-by: Lizan Zhou <lizan@tetrate.io>

* Prevent SEGFAULT when disabling listener ([envoyproxy#13515](https://github.com/envoyproxy/envoy/pull/13515)) ([envoyproxy#13903](https://github.com/envoyproxy/envoy/pull/13903))

This prevents the stop_listening overload action from causing
segmentation faults that can occur if the action is enabled after the
listener has already shut down.

Signed-off-by: Alex Konradi <akonradi@google.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* proxy protocol: set downstreamRemoteAddress on StreamInfo ([envoyproxy#14131](https://github.com/envoyproxy/envoy/pull/14131)) ([envoyproxy#14169](https://github.com/envoyproxy/envoy/pull/14169))

This fixes a regression which resulted in the downstreamRemoteAddress
on the StreamInfo for a connection not having the address supplied by
the proxy protocol filter, but instead having the address of the
directly connected peer.

This issue does not affect HTTP filters.

Fixes [envoyproxy#14087](https://github.com/envoyproxy/envoy/issues/14087)

Signed-off-by: Greg Greenway <ggreenway@apple.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* ci: temproray disable vhds_integration_test in TSAN ([envoyproxy#12067](https://github.com/envoyproxy/envoy/pull/12067)) ([envoyproxy#14217](https://github.com/envoyproxy/envoy/pull/14217))

Signed-off-by: Lizan Zhou <lizan@tetrate.io>

* tcmalloc changed and the data coming out of tcmalloc::MallocExtension::GetNumericProperty("generic.current_allocated_bytes") ([envoyproxy#14165](https://github.com/envoyproxy/envoy/pull/14165))

Commit Message: tcmalloc changed and the data coming out of tcmalloc::MallocExtension::GetNumericProperty("generic.current_allocated_bytes") no longer appears to be deterministic, even in unthreaded tests. So disable exact mem checks till we sort that out
Additional Description:
Risk Level: low
Testing: just thread_local_store_test
Docs Changes: n/a
Release Notes: n/a

no longer appears to be deterministic, even in unthreaded tests. So disable exact mem checks till we sort that out

Signed-off-by: Joshua Marantz <jmarantz@google.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

Co-authored-by: Joshua Marantz <jmarantz@google.com>

* backport to v1.15: connection: Remember transport socket read resumption requests and replay them when re-enabling read. ([envoyproxy#13772](https://github.com/envoyproxy/envoy/pull/13772)) ([envoyproxy#14173](https://github.com/envoyproxy/envoy/pull/14173))

* connection: Remember transport socket read resumption requests and replay them when re-enabling read. ([envoyproxy#13772](https://github.com/envoyproxy/envoy/pull/13772))

Fixes SslSocket read resumption after readDisable when processing the SSL record that contains the last bytes of the HTTP message

Signed-off-by: Antonio Vicente <avd@google.com>

* backport to 1.15: udp: properly handle truncated/dropped datagrams ([envoyproxy#14122](https://github.com/envoyproxy/envoy/pull/14122)) ([envoyproxy#14166](https://github.com/envoyproxy/envoy/pull/14166))

Signed-off-by: Matt Klein <mklein@lyft.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>

* backport to 1.15: vrp: allow supervisord to open its log file ([envoyproxy#14066](https://github.com/envoyproxy/envoy/pull/14066)) ([envoyproxy#14280](https://github.com/envoyproxy/envoy/pull/14280))

Commit Message: Allow supervisord to open its log file
Additional Description:
Change the default location of the log file and give supervisord
permissions to write to it.

Risk Level: low
Testing: built image locally
Docs Changes: n/a
Release Notes: n/a
Platform Specific Features: n/a

Signed-off-by: Alex Konradi <akonradi@google.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* rel 1.15: close release 1.15.3 ([envoyproxy#14303](https://github.com/envoyproxy/envoy/pull/14303))

Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* Kick off rel 1.15.4. ([envoyproxy#14323](https://github.com/envoyproxy/envoy/pull/14323))

Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

* backport to 1.15: http: fix datadog and squash handling of responses without body ([envoyproxy#13328](https://github.com/envoyproxy/envoy/pull/13328)) ([envoyproxy#14458](https://github.com/envoyproxy/envoy/pull/14458))

Commit Message: Fixing bugs in datadog and sqaush where unexpected bodyless responses would crash Envoy
Risk Level: low
Testing: new unit tests, updated certs
Docs Changes: n/a
Release Notes: inline
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: alyssawilk <alyssar@chromium.org>

* backport 1.15: http: fixing a bug with IPv6 hosts ([envoyproxy#14273](https://github.com/envoyproxy/envoy/pull/14273))

Fixing a bug where HTTP parser offsets for IPv6 hosts did not include [] and Envoy assumed it did.
This results in mis-parsing addresses for IPv6 CONNECT requests and IPv6 hosts in fully URLs over HTTP/1.1

Risk Level: low
Testing: new unit, integration tests
Docs Changes: n/a
Release Notes: inline

Signed-off-by: Shikugawa <rei@tetrate.io>
Co-authored-by: alyssawilk <alyssar@chromium.org>

* backport to 1.15: tls: fix detection of the upstream connection close event. ([envoyproxy#13858](https://github.com/envoyproxy/envoy/pull/13858)) ([envoyproxy#14568](https://github.com/envoyproxy/envoy/pull/14568))

Fixes [envoyproxy#13856](https://github.com/envoyproxy/envoy/issues/13856).

Signed-off-by: Piotr Sikora <piotrsikora@google.com>
Signed-off-by: Christoph Pakulski <christoph@tetrate.io>

Co-authored-by: Piotr Sikora <piotrsikora@google.com>
Co-authored-by: antonio <avd@google.com>
Co-authored-by: Matt Klein <mklein@lyft.com>
Co-authored-by: Dmitri Dolguikh <ddolguik@redhat.com>
Co-authored-by: Lizan Zhou <lizan@tetrate.io>
Co-authored-by: Christoph Pakulski <christoph@tetrate.io>
Co-authored-by: asraa <asraa@google.com>
Co-authored-by: Joshua Marantz <jmarantz@google.com>
Co-authored-by: Rei Shimizu <Shikugawa@gmail.com>
Co-authored-by: alyssawilk <alyssar@chromium.org>
```

[![@asraa](https://avatars.githubusercontent.com/u/5194569?s=40&v=4)](/asraa)
[asraa](/asraa)
mentioned this pull request
[Feb 1, 2021](#ref-issue-798405875)

[UDP proxy fuzzing
#14889](/envoyproxy/envoy/issues/14889)

Closed

[![@tatianab](https://avatars.githubusercontent.com/u/6238967?s=40&v=4)](/tatianab)
[tatianab](/tatianab)
mentioned this pull request
[Nov 8, 2023](#ref-issue-1984474828)

[x/vulndb: potential Go vuln in github.com/envoyproxy/envoy: CVE-2020-35471
golang/vulndb#2302](/golang/vulndb/issues/2302)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fenvoyproxy%2Fenvoy%2Fpull%2F14122)

Reviewers

[![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&v=4)](/mattklein123) [mattklein123](/mattklein123)

mattklein123 approved these changes

[![@alyssawilk](https://avatars.githubusercontent.com/u/18220477?s=40&v=4)](/alyssawilk) [alyssawilk](/alyssawilk)

 Awaiting requested review from alyssawilk

[![@ggreenway](https://avatars.githubusercontent.com/u/8603643?s=40&v=4)](/ggreenway) [ggreenway](/ggreenway)

 Awaiting requested review from ggreenway

Assignees

[![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=40&v=4)](/mattklein123) [mattklein123](/mattklein123)

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [crash when udp packet size large than 1500](https://github.com/envoyproxy/envoy/issues/14113)

2 participants

[![@cpakulski](https://avatars.githubusercontent.com/u/36484366?s=52&v=4)](/cpakulski) [![@mattklein123](https://avatars.githubusercontent.com/u/6305260?s=52&v=4)](/mattklein123)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


