- **Root cause of vulnerability:** A logic flaw in the `is_authorized_request` and `validate_ajax_request` functions. These functions check for a nonce, but allow requests to proceed if the nonce parameter is missing rather than invalid. This bypasses the intended CSRF protection.
- **Weaknesses/vulnerabilities present:**
    - Cross-Site Request Forgery (CSRF)
    - Remote Code Execution (RCE)
    - Local File Inclusion (LFI)
    - Cross-Site Scripting (XSS)
    - Unrestricted file upload
- **Impact of exploitation:**
    - Site takeover
    - Malicious redirects
    - Spam injection
    - Phishing
    - Remote code execution
    - Arbitrary code execution
- **Attack vectors:**
    - CSRF attacks crafted by an attacker.
    - Double extension upload (e.g. file.php.css) to achieve RCE in certain server configurations.
    - Using a crafted file as a "Legacy Template" to achieve LFI/RCE.
    - Uploading a crafted image file with embedded code.
- **Required attacker capabilities/position:**
    - An attacker needs to trick an administrator into clicking a link to submit a malicious crafted request.
    - The site needs to have at least one album published and accessible to the attacker.