```
{
  "cve": "CVE-2020-10005",
  "affected_product": "macOS SMB server",
  "vulnerability_details": {
    "root_cause": "A stack-based buffer overflow vulnerability exists in the SMB Server of Apple macOS 10.15.7 when processing TREE_CONNECT requests.",
    "weaknesses": [
      "The `memcpy` function copies data from the SMB request to a fixed-size stack buffer without proper bounds checking.",
       "The size of the data to be copied is taken from the request, and an attacker can manipulate it.",
      "The local stack buffer `wcSharePath` has a fixed size of 2048 bytes."
    ],
    "impact": "A specially crafted SMB packet with an oversized share path can overwrite the stack, leading to arbitrary code execution or denial of service. This can also lead to memory corruption.",
    "attack_vectors": "Sending a malicious SMB packet with an oversized share path in a TREE_CONNECT request to the vulnerable SMB server.",
    "required_capabilities": "An attacker needs to be able to send network packets to the vulnerable SMB server. This typically requires network access to the server."
  },
  "additional_notes": [
     "The vulnerability is located in the `smb2_dispatch_tree_connect` function when processing `TREE_CONNECT` requests.",
     "The vulnerability is present in SMB2 and newer versions of the protocol.",
     "The vulnerable code copies a path string from the request to a local stack buffer (`wcSharePath`) using `memcpy`."
  ],
  "references": [
        "https://talosintelligence.com/vulnerability_reports/TALOS-2021-1246",
        "https://support.apple.com/en-us/HT211940"
  ]
}
```