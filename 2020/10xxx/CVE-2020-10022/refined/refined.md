```
{
  "cveId": "CVE-2020-10022",
  "related": true,
  "cveDescription": "A malformed JSON payload that is received from an UpdateHub server may trigger memory corruption in the Zephyr OS. This could result in a denial of service in the best case, or code execution in the worst case.",
  "vulnerabilityDetails": [
    {
      "source": "github.com_8cac8227_20250119_142204.html",
      "details": "The page buffer can overflow if dCBWDataTransferLength is multiple of the BLOCK_SIZE but the host uses OUT packets smaller than MPS durng transfer."
    },
        {
      "source": "github.com_3cfdc23a_20250119_125246.html",
      "details": "A malformed JSON payload that is received from an UpdateHub server may trigger memory corruption in the Zephyr OS. This could result in a denial of service in the best case, or code execution in the worst case."
    },
    {
      "source": "docs.zephyrproject.org_ca3b03ce_20250119_125243.html",
        "details": "UpdateHub Module Copies a Variable-Size Hash String Into a Fixed-Size Array\n\nA malformed JSON payload that is received from an UpdateHub server may\ntrigger memory corruption in the Zephyr OS. This could result in a\ndenial of service in the best case, or code execution in the worst\ncase.\n\nSee NCC-ZEP-016\n\nThis has been fixed in the below pull requests for main, branch from\nv2.1.0, and branch from v2.2.0."
    },
    {
        "source": "github.com_25c6502b_20250119_125247.html",
        "details": "There are some issues related to security on UpdateHub and this address the following fixes:\n\n*   Fix variable-size string copy\n*   Switch from snprintk in favor of bin2hex\n*   Improvemenets on probe security"
    }
  ],
  "affectedComponents": [
    "UpdateHub module",
    "USB Mass Storage"
    ],
  "rootCause": "A malformed JSON payload received from an UpdateHub server or incorrect data transfer lengths in USB Mass Storage",
  "vulnerabilities": [
      "Memory corruption due to variable-size string copy into a fixed-size buffer in UpdateHub module",
    "Page buffer overflow in USB Mass Storage",
       "Out-of-bounds write in USB Mass Storage with unaligned sizes"
  ],
  "impact": "Denial of service or arbitrary code execution",
   "attackVectors": [
        "Sending malformed JSON payloads to the UpdateHub module",
       "Sending OUT packets smaller than MPS during a USB Mass Storage transfer"
  ],
  "attackerCapabilities": "Attacker can send crafted payloads to the UpdateHub server or manipulate USB Mass Storage data transfer lengths.",
     "fixes": [
    "https://github.com/zephyrproject-rtos/zephyr/pull/24154",
    "https://github.com/zephyrproject-rtos/zephyr/pull/24065",
    "https://github.com/zephyrproject-rtos/zephyr/pull/24066",
    "https://github.com/zephyrproject-rtos/zephyr/pull/23455",
    "https://github.com/zephyrproject-rtos/zephyr/pull/23456",
     "https://github.com/zephyrproject-rtos/zephyr/pull/23240"
  ]
}
```