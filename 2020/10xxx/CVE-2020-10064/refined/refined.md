The content is related to CVE-2020-10064.

**Root cause of vulnerability:**
The vulnerability lies in the improper input frame validation within the `ieee802154` processing in Zephyr RTOS. Specifically, the `ieee802154_recv` function does not properly validate the packet size after modifications performed during PAN ID and source/destination address decoding within `ieee802154_validate_frame`. This can lead to an integer underflow in the packet size calculation.

**Weaknesses/vulnerabilities present:**
- **Integer Underflow**: The code calculates the header length (`hdr_len`) by subtracting the packet data pointer from the payload pointer. Due to modifications during address validation, the payload pointer can be located before the start of the actual packet data, leading to a negative `hdr_len`, which, being an unsigned integer, results in a large positive value.
- **Out-of-Bounds Access:** The erroneous `hdr_len` is later used in `net_buf_pull(pkt->buffer, hdr_len)`, which attempts to pull more data than available from the packet buffer. This can lead to out-of-bounds access, such as a crash, when the code later operates on the packet.
- **Insufficient Size Check**: The initial check for minimal packet size (`IEEE802154_MIN_LENGTH`) in `ieee802154_validate_frame` does not account for additional lengths added by PAN ID and extended source/destination addresses.

**Impact of exploitation:**
- **Denial of Service (DoS):** At a minimum, exploiting this vulnerability can cause a denial of service by crashing the affected device.
- **Remote Code Execution (RCE):** Due to the nature of the out-of-bounds access (specifically in the `uncompress_IPHC_header` function) coupled with context switch and memory layout, it could lead to a potential remote code execution. Specifically, the `memmove` operation that uses the invalid size parameter could cause memory corruption that is exploitable.

**Attack vectors:**
- Network: An attacker can send a crafted IEEE 802.15.4 packet with a small initial size, but with frame formatting causing the PAN ID and/or address fields to expand to reach the vulnerable code.

**Required attacker capabilities/position:**
- The attacker needs the ability to send network packets to the affected device's IEEE 802.15.4 interface.
- No special privileges or user interaction are required for the exploit.