=== Content from xavibel.com_00e7ecff_20250119_141244.html ===

[Happy Hacking!](https://xavibel.com/)

Exploit Dev & Web App Security
![Happy Hacking!](https://xavibel.com/wp-content/uploads/2018/10/cropped-Neo_room-4.jpg)
[Skip to content](#content)

* [Home](https://xavibel.com/)
* [About me](https://xavibel.com/about-me/)

[‚Üê Siemens Polarion ‚Äì CVE-2019-13934, CVE-2019-13935, CVE-2019-13936](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/)
[CVE-2020-10963 ‚Äì Unrestricted File Upload in FrozenNode/Laravel-Administrator ‚Üí](https://xavibel.com/2020/03/23/unrestricted-file-upload-in-frozennode-laravel-administrator/)

# CVE-2020-8088 ‚Äì UseBB Forum 1.0.12 ‚Äì PHP Type Juggling vulnerability

Posted on [January 22, 2020](https://xavibel.com/2020/01/22/usebb-forum-php-type-juggling-vulnerability/ "6:55 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Hello!

Last week I was reading about PHP Type Juggling vulnerabilities and I decided to spend a couple of days learning about them.

These vulnerabilities can happen during comparison of PHP variables, because PHP will automatically convert the data into a common comparable type.

My idea was to try to find one by my own. But first I needed to look for some PHP open source code to review.

I thought that I could find one in old open source forums. My idea was to try to understand the authentication and the password recovery implementations.

After installing a couple of different open source forums I‚Äôve found UseBB software that seemed to have an interesting implementation of the login.

## Installing the software and creating and admin user

So I installed the software, to do that I created a database and followed the installation steps.

I created an admin user with the following credentials:

```
username=admin
password=aabC9RqS
```
## Checking the login implementation

Doing a quick code check, I‚Äôve found that the login was implemented in the file: ‚Äú/sources/panel\_login.php‚Äù

[![](https://xavibel.com/wp-content/uploads/2020/01/code-review-1024x768.png)](https://xavibel.com/wp-content/uploads/2020/01/code-review-1024x768.png)

UseBB Forum Login implementation

## Identifying a vulnerability

The application does different checks to verify if the password supplied by the user is correct. The most important line for checking the Type Juggling vulnerability is the following:

if ( !$userdata[‚Äòid‚Äô] || **md5**(stripslashes($\_POST[‚Äòpasswd‚Äô])) **!=** $userdata[‚Äòpasswd‚Äô] ) {

Notice that it‚Äôs using only one equal sign, that is a loose comparison, and they should have used an strict one.

In this link you can read the following:

<https://www.whitehatsec.com/blog/magic-hashes/>

‚Äú*For more than the last decade, PHP programmers have been wrestling with the equals-equals (==) operator. It‚Äôs caused a lot of issues. This has a particular implication for password hashes. Password hashes in PHP are base16 encoded and can come in the form of ‚Äú0e812389‚Ä¶‚Äù. The problem is in == comparison the 0e means that if the following characters are all digits the whole string gets treated as a float.* ‚Äú

What they are talking about, is that when there is a loose comparison, you can do strange things, like this:

```
socket@lab:~$ php -r "print md5('aabC9RqS');";echo ''
0e041022518165728065344349536299
socket@lab:~$ php -r "print md5('aabg7XSs');";echo ''
0e087386482136013740957780965295
socket@lab:~$ php -r "var_dump(md5('aabC9RqS') == md5('aabg7XSs'));"
bool(true)
```

As you can see the hashes are different but when we compare them with a loose comparison the result is true.

## Login with the same user using a different password

Before doing anything, let‚Äôs check the current status of our database. Specifically the table usebb\_members that stores usernames and hashed passwords.

I see the following hash stored as the password:

![](https://xavibel.com/wp-content/uploads/2020/01/password-hash-2.png)

UseBB Forum admin password hash

If we remember the login verification, this hash is the value for the variable: $userdata[‚Äòpasswd‚Äô]

Doing a quick verification we can see that this hash, is the md5 value of the password that we used when we registered the user:

```
socket@lab:~$ php -r "print md5('aabC9RqS');";echo ''
0e041022518165728065344349536299
```

We know that the password for the user admin is: ‚ÄúaabC9RqS‚Äù but let‚Äôs try to use ‚Äúaabg7XSs‚Äù instead.

We try to login using this password:

![](https://xavibel.com/wp-content/uploads/2020/01/login-with-different-password.png)

The server is evaluating this:

```
md5('aabC9RqS') == md5('aabg7XSs')
0e041022518165728065344349536299 == 0e087386482136013740957780965295
```

And as we saw before‚Ä¶

```
php -r "var_dump(md5('aabC9RqS') == md5('aabg7XSs'));"
bool(true)
```

So, we are in üôÇ

![](https://xavibel.com/wp-content/uploads/2020/01/admin-login.png)
## Vulnerability solution:

We need to add an extra equal in the line 72 of sources/panel\_login.php

if ( !$userdata[‚Äòid‚Äô] || md5(stripslashes($\_POST[‚Äòpasswd‚Äô])) **!==** $userdata[‚Äòpasswd‚Äô] ) {

This software seems to doesn‚Äôt have support. But if you are using it, I recommend you to migrate it to Drupal using this plugin:

<https://www.drupal.org/project/usebb2drupal>

## Interesting resources:

If you are interested reading more about this topic I recommend you some resources:

<https://www.whitehatsec.com/blog/magic-hashes/>

<https://www.owasp.org/images/6/6b/PHPMagicTricks-TypeJuggling.pdf>

<https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Type%20Juggling>

Thank you for reading the blog! See you soon üôÇ

This entry was posted in [Hacking Web](https://xavibel.com/category/hackingweb/) and tagged [CVE](https://xavibel.com/tag/cve/), [forum](https://xavibel.com/tag/forum/), [Hacking web](https://xavibel.com/tag/hacking-web/), [php](https://xavibel.com/tag/php/), [type juggling](https://xavibel.com/tag/type-juggling/), [usebb](https://xavibel.com/tag/usebb/), [vulnerability discovery](https://xavibel.com/tag/vulnerability-discovery/). Bookmark the [permalink](https://xavibel.com/2020/01/22/usebb-forum-php-type-juggling-vulnerability/ "Permalink to CVE-2020-8088 ‚Äì UseBB Forum 1.0.12 ‚Äì PHP Type Juggling vulnerability").

[‚Üê Siemens Polarion ‚Äì CVE-2019-13934, CVE-2019-13935, CVE-2019-13936](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/)
[CVE-2020-10963 ‚Äì Unrestricted File Upload in FrozenNode/Laravel-Administrator ‚Üí](https://xavibel.com/2020/03/23/unrestricted-file-upload-in-frozennode-laravel-administrator/)

### Leave a Reply [Cancel reply](/2020/01/22/usebb-forum-php-type-juggling-vulnerability/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

Œî

* Search for:
* ### Recent Posts

  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Death Note](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-death-note/)
  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Pet Companion](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-pet-companion/)
  + [Shellcode ‚Äì Windows/x86 ‚Äì Create Administrator User ‚Äì Dynamic PEB & EDT](https://xavibel.com/2023/01/18/shellcode-windows-x86-create-administrator-user-dynamic-peb-edt/)
  + [Creating your own AMSI Bypass using Powershell Reflection Technique](https://xavibel.com/2022/11/03/creating-your-own-amsi-bypass-using-powershell-reflection-technique/)
  + [Linux Shared Library Hijacking](https://xavibel.com/2022/09/06/linux-shared-library-hijacking/)
* ### Recent Comments

  + Xavi on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-9964)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5524)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5523)
  + Xavi on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2892)
  + junsec on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2863)
* ### Archives

  + [March 2024](https://xavibel.com/2024/03/)
  + [January 2023](https://xavibel.com/2023/01/)
  + [November 2022](https://xavibel.com/2022/11/)
  + [September 2022](https://xavibel.com/2022/09/)
  + [November 2020](https://xavibel.com/2020/11/)
  + [October 2020](https://xavibel.com/2020/10/)
  + [March 2020](https://xavibel.com/2020/03/)
  + [January 2020](https://xavibel.com/2020/01/)
  + [November 2019](https://xavibel.com/2019/11/)
  + [September 2019](https://xavibel.com/2019/09/)
  + [August 2019](https://xavibel.com/2019/08/)
  + [July 2019](https://xavibel.com/2019/07/)
  + [June 2019](https://xavibel.com/2019/06/)
  + [May 2019](https://xavibel.com/2019/05/)
  + [April 2019](https://xavibel.com/2019/04/)
  + [March 2019](https://xavibel.com/2019/03/)
  + [February 2019](https://xavibel.com/2019/02/)
  + [October 2018](https://xavibel.com/2018/10/)
* ### Categories

  + [Exploiting](https://xavibel.com/category/exploiting/)
  + [Hacking Web](https://xavibel.com/category/hackingweb/)
  + [Miscellaneous](https://xavibel.com/category/miscellaneous/)
  + [Uncategorized](https://xavibel.com/category/uncategorized/)
* ### Meta

  + [Log in](https://xavibel.com/wp-login.php)
  + [Entries feed](https://xavibel.com/feed/)
  + [Comments feed](https://xavibel.com/comments/feed/)
  + [WordPress.org](https://wordpress.org/)

[Happy Hacking!](https://xavibel.com/)

[Proudly powered by WordPress.](https://wordpress.org/ "Semantic Personal Publishing Platform")



=== Content from xavibel.com_e53c238e_20250119_141243.html ===

[Happy Hacking!](https://xavibel.com/)

Exploit Dev & Web App Security
![Happy Hacking!](https://xavibel.com/wp-content/uploads/2018/10/cropped-Neo_room-4.jpg)
[Skip to content](#content)

* [Home](https://xavibel.com/)
* [About me](https://xavibel.com/about-me/)

[‚Üê CVE-2020-8088 ‚Äì UseBB Forum 1.0.12 ‚Äì PHP Type Juggling vulnerability](https://xavibel.com/2020/01/22/usebb-forum-php-type-juggling-vulnerability/)
[Introduction to Format Strings Bugs ‚Üí](https://xavibel.com/2020/10/18/introduction-to-format-strings-bugs/)

# CVE-2020-10963 ‚Äì Unrestricted File Upload in FrozenNode/Laravel-Administrator

Posted on [March 23, 2020](https://xavibel.com/2020/03/23/unrestricted-file-upload-in-frozennode-laravel-administrator/ "10:53 pm") by [Victor](https://xavibel.com/author/victor/ "View all posts by Victor")

Hi all,

This time, we want to show you how we achieved unrestricted file upload in the Laravel-Administrator package of FrozenNode. This open source software,¬†is an administrative interface builder for¬†[Laravel](http://laravel.com/).

<https://github.com/FrozenNode/Laravel-Administrator>

As Laravel-Administrator allows you to create your own modules, we enabled the file upload in one of them:

![](https://xavibel.com/wp-content/uploads/2020/03/1-1024x278.png)

If we try to upload a php file, it raises an error regarding wrong file extension

![](https://xavibel.com/wp-content/uploads/2020/03/2-300x89.png)

This protection can be easily bypassed following the steps below:

* Uploading an allowed file
* Capture the request with BurpSuite (or any other proxy)
* Replace filename extension by .php
* Add a GIF Image header in order to bypass file content filters
* Write the PHP code that you want to execute in the server

![](https://xavibel.com/wp-content/uploads/2020/03/3.png)

At this point, we have been able to upload our payload into the server and, in addition, the server provided us the path of the uploaded file.

![](https://xavibel.com/wp-content/uploads/2020/03/4.png)You will have noticed that the filename has been replaced by a random string but, as far as it is giving us the name, is easy to find.

![](https://xavibel.com/wp-content/uploads/2020/03/5.png)

At this point, we have remote code execution in the server.

As this project is officially abandoned and its fork ([Laravel-Admin](https://github.com/exodusanto/Laravel-Admin)) seems to have stopped the development since Laravel 5.8, we encourage the users to migrate to other supported platforms.

This entry was posted in [Hacking Web](https://xavibel.com/category/hackingweb/) and tagged [CVE](https://xavibel.com/tag/cve/), [file upload](https://xavibel.com/tag/file-upload/), [frozennode](https://xavibel.com/tag/frozennode/), [Hacking web](https://xavibel.com/tag/hacking-web/), [laravel](https://xavibel.com/tag/laravel/), [panel](https://xavibel.com/tag/panel/), [php](https://xavibel.com/tag/php/), [vulnerability discovery](https://xavibel.com/tag/vulnerability-discovery/). Bookmark the [permalink](https://xavibel.com/2020/03/23/unrestricted-file-upload-in-frozennode-laravel-administrator/ "Permalink to CVE-2020-10963 ‚Äì Unrestricted File Upload in FrozenNode/Laravel-Administrator").

[‚Üê CVE-2020-8088 ‚Äì UseBB Forum 1.0.12 ‚Äì PHP Type Juggling vulnerability](https://xavibel.com/2020/01/22/usebb-forum-php-type-juggling-vulnerability/)
[Introduction to Format Strings Bugs ‚Üí](https://xavibel.com/2020/10/18/introduction-to-format-strings-bugs/)

### Leave a Reply [Cancel reply](/2020/03/23/unrestricted-file-upload-in-frozennode-laravel-administrator/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

Œî

* Search for:
* ### Recent Posts

  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Death Note](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-death-note/)
  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Pet Companion](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-pet-companion/)
  + [Shellcode ‚Äì Windows/x86 ‚Äì Create Administrator User ‚Äì Dynamic PEB & EDT](https://xavibel.com/2023/01/18/shellcode-windows-x86-create-administrator-user-dynamic-peb-edt/)
  + [Creating your own AMSI Bypass using Powershell Reflection Technique](https://xavibel.com/2022/11/03/creating-your-own-amsi-bypass-using-powershell-reflection-technique/)
  + [Linux Shared Library Hijacking](https://xavibel.com/2022/09/06/linux-shared-library-hijacking/)
* ### Recent Comments

  + Xavi on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-9964)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5524)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5523)
  + Xavi on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2892)
  + junsec on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2863)
* ### Archives

  + [March 2024](https://xavibel.com/2024/03/)
  + [January 2023](https://xavibel.com/2023/01/)
  + [November 2022](https://xavibel.com/2022/11/)
  + [September 2022](https://xavibel.com/2022/09/)
  + [November 2020](https://xavibel.com/2020/11/)
  + [October 2020](https://xavibel.com/2020/10/)
  + [March 2020](https://xavibel.com/2020/03/)
  + [January 2020](https://xavibel.com/2020/01/)
  + [November 2019](https://xavibel.com/2019/11/)
  + [September 2019](https://xavibel.com/2019/09/)
  + [August 2019](https://xavibel.com/2019/08/)
  + [July 2019](https://xavibel.com/2019/07/)
  + [June 2019](https://xavibel.com/2019/06/)
  + [May 2019](https://xavibel.com/2019/05/)
  + [April 2019](https://xavibel.com/2019/04/)
  + [March 2019](https://xavibel.com/2019/03/)
  + [February 2019](https://xavibel.com/2019/02/)
  + [October 2018](https://xavibel.com/2018/10/)
* ### Categories

  + [Exploiting](https://xavibel.com/category/exploiting/)
  + [Hacking Web](https://xavibel.com/category/hackingweb/)
  + [Miscellaneous](https://xavibel.com/category/miscellaneous/)
  + [Uncategorized](https://xavibel.com/category/uncategorized/)
* ### Meta

  + [Log in](https://xavibel.com/wp-login.php)
  + [Entries feed](https://xavibel.com/feed/)
  + [Comments feed](https://xavibel.com/comments/feed/)
  + [WordPress.org](https://wordpress.org/)

[Happy Hacking!](https://xavibel.com/)

[Proudly powered by WordPress.](https://wordpress.org/ "Semantic Personal Publishing Platform")



=== Content from xavibel.com_ce4abd14_20250119_141243.html ===

[Happy Hacking!](https://xavibel.com/)

Exploit Dev & Web App Security
![Happy Hacking!](https://xavibel.com/wp-content/uploads/2018/10/cropped-Neo_room-4.jpg)
[Skip to content](#content)

* [Home](https://xavibel.com/)
* [About me](https://xavibel.com/about-me/)

# Tag Archives: vulnerability discovery

## [CVE-2020-10963 ‚Äì Unrestricted File Upload in FrozenNode/Laravel-Administrator](https://xavibel.com/2020/03/23/unrestricted-file-upload-in-frozennode-laravel-administrator/)

Posted on [March 23, 2020](https://xavibel.com/2020/03/23/unrestricted-file-upload-in-frozennode-laravel-administrator/ "10:53 pm") by [Victor](https://xavibel.com/author/victor/ "View all posts by Victor")

Hi all, This time, we want to show you how we achieved unrestricted file upload in the Laravel-Administrator package of FrozenNode. This open source software,¬†is an administrative interface builder for¬†Laravel.¬† https://github.com/FrozenNode/Laravel-Administrator As Laravel-Administrator allows you to create your own modules, ‚Ä¶ [Continue reading ‚Üí](https://xavibel.com/2020/03/23/unrestricted-file-upload-in-frozennode-laravel-administrator/)

Posted in [Hacking Web](https://xavibel.com/category/hackingweb/)
|
Tagged [CVE](https://xavibel.com/tag/cve/), [file upload](https://xavibel.com/tag/file-upload/), [frozennode](https://xavibel.com/tag/frozennode/), [Hacking web](https://xavibel.com/tag/hacking-web/), [laravel](https://xavibel.com/tag/laravel/), [panel](https://xavibel.com/tag/panel/), [php](https://xavibel.com/tag/php/), [vulnerability discovery](https://xavibel.com/tag/vulnerability-discovery/)
|
[Leave a comment](https://xavibel.com/2020/03/23/unrestricted-file-upload-in-frozennode-laravel-administrator/#respond)

## [CVE-2020-8088 ‚Äì UseBB Forum 1.0.12 ‚Äì PHP Type Juggling vulnerability](https://xavibel.com/2020/01/22/usebb-forum-php-type-juggling-vulnerability/)

Posted on [January 22, 2020](https://xavibel.com/2020/01/22/usebb-forum-php-type-juggling-vulnerability/ "6:55 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Hello! Last week I was reading about PHP Type Juggling vulnerabilities and I decided to spend a couple of days learning about them. These vulnerabilities can happen during comparison of PHP variables, because PHP will automatically convert the data into ‚Ä¶ [Continue reading ‚Üí](https://xavibel.com/2020/01/22/usebb-forum-php-type-juggling-vulnerability/)

Posted in [Hacking Web](https://xavibel.com/category/hackingweb/)
|
Tagged [CVE](https://xavibel.com/tag/cve/), [forum](https://xavibel.com/tag/forum/), [Hacking web](https://xavibel.com/tag/hacking-web/), [php](https://xavibel.com/tag/php/), [type juggling](https://xavibel.com/tag/type-juggling/), [usebb](https://xavibel.com/tag/usebb/), [vulnerability discovery](https://xavibel.com/tag/vulnerability-discovery/)
|
[Leave a comment](https://xavibel.com/2020/01/22/usebb-forum-php-type-juggling-vulnerability/#respond)

## [Siemens Polarion ‚Äì CVE-2019-13934, CVE-2019-13935, CVE-2019-13936](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/)

Posted on [November 25, 2019](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/ "2:29 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Hello, I write this blog post for people that is just starting in web application hacking. I recommend you that you just download some product or web application and start testing it. You are going to realize that sometimes is ‚Ä¶ [Continue reading ‚Üí](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/)

Posted in [Hacking Web](https://xavibel.com/category/hackingweb/)
|
Tagged [CVE](https://xavibel.com/tag/cve/), [Hacking web](https://xavibel.com/tag/hacking-web/), [persistent XSS](https://xavibel.com/tag/persistent-xss/), [vulnerability discovery](https://xavibel.com/tag/vulnerability-discovery/), [XSS](https://xavibel.com/tag/xss/)
|
[Leave a comment](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/#respond)

* Search for:
* ### Recent Posts

  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Death Note](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-death-note/)
  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Pet Companion](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-pet-companion/)
  + [Shellcode ‚Äì Windows/x86 ‚Äì Create Administrator User ‚Äì Dynamic PEB & EDT](https://xavibel.com/2023/01/18/shellcode-windows-x86-create-administrator-user-dynamic-peb-edt/)
  + [Creating your own AMSI Bypass using Powershell Reflection Technique](https://xavibel.com/2022/11/03/creating-your-own-amsi-bypass-using-powershell-reflection-technique/)
  + [Linux Shared Library Hijacking](https://xavibel.com/2022/09/06/linux-shared-library-hijacking/)
* ### Recent Comments

  + Xavi on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-9964)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5524)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5523)
  + Xavi on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2892)
  + junsec on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2863)
* ### Archives

  + [March 2024](https://xavibel.com/2024/03/)
  + [January 2023](https://xavibel.com/2023/01/)
  + [November 2022](https://xavibel.com/2022/11/)
  + [September 2022](https://xavibel.com/2022/09/)
  + [November 2020](https://xavibel.com/2020/11/)
  + [October 2020](https://xavibel.com/2020/10/)
  + [March 2020](https://xavibel.com/2020/03/)
  + [January 2020](https://xavibel.com/2020/01/)
  + [November 2019](https://xavibel.com/2019/11/)
  + [September 2019](https://xavibel.com/2019/09/)
  + [August 2019](https://xavibel.com/2019/08/)
  + [July 2019](https://xavibel.com/2019/07/)
  + [June 2019](https://xavibel.com/2019/06/)
  + [May 2019](https://xavibel.com/2019/05/)
  + [April 2019](https://xavibel.com/2019/04/)
  + [March 2019](https://xavibel.com/2019/03/)
  + [February 2019](https://xavibel.com/2019/02/)
  + [October 2018](https://xavibel.com/2018/10/)
* ### Categories

  + [Exploiting](https://xavibel.com/category/exploiting/)
  + [Hacking Web](https://xavibel.com/category/hackingweb/)
  + [Miscellaneous](https://xavibel.com/category/miscellaneous/)
  + [Uncategorized](https://xavibel.com/category/uncategorized/)
* ### Meta

  + [Log in](https://xavibel.com/wp-login.php)
  + [Entries feed](https://xavibel.com/feed/)
  + [Comments feed](https://xavibel.com/comments/feed/)
  + [WordPress.org](https://wordpress.org/)

[Happy Hacking!](https://xavibel.com/)

[Proudly powered by WordPress.](https://wordpress.org/ "Semantic Personal Publishing Platform")



=== Content from packetstormsecurity.com_716b4105_20250119_123815.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT‚õî 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from xavibel.com_e89d9602_20250119_141243.html ===

[Happy Hacking!](https://xavibel.com/)

Exploit Dev & Web App Security
![Happy Hacking!](https://xavibel.com/wp-content/uploads/2018/10/cropped-Neo_room-4.jpg)
[Skip to content](#content)

* [Home](https://xavibel.com/)
* [About me](https://xavibel.com/about-me/)

[‚Üê Siemens Polarion ‚Äì CVE-2019-13934, CVE-2019-13935, CVE-2019-13936](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/)
[CVE-2020-10963 ‚Äì Unrestricted File Upload in FrozenNode/Laravel-Administrator ‚Üí](https://xavibel.com/2020/03/23/unrestricted-file-upload-in-frozennode-laravel-administrator/)

# CVE-2020-8088 ‚Äì UseBB Forum 1.0.12 ‚Äì PHP Type Juggling vulnerability

Posted on [January 22, 2020](https://xavibel.com/2020/01/22/usebb-forum-php-type-juggling-vulnerability/ "6:55 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Hello!

Last week I was reading about PHP Type Juggling vulnerabilities and I decided to spend a couple of days learning about them.

These vulnerabilities can happen during comparison of PHP variables, because PHP will automatically convert the data into a common comparable type.

My idea was to try to find one by my own. But first I needed to look for some PHP open source code to review.

I thought that I could find one in old open source forums. My idea was to try to understand the authentication and the password recovery implementations.

After installing a couple of different open source forums I‚Äôve found UseBB software that seemed to have an interesting implementation of the login.

## Installing the software and creating and admin user

So I installed the software, to do that I created a database and followed the installation steps.

I created an admin user with the following credentials:

```
username=admin
password=aabC9RqS
```
## Checking the login implementation

Doing a quick code check, I‚Äôve found that the login was implemented in the file: ‚Äú/sources/panel\_login.php‚Äù

[![](https://xavibel.com/wp-content/uploads/2020/01/code-review-1024x768.png)](https://xavibel.com/wp-content/uploads/2020/01/code-review-1024x768.png)

UseBB Forum Login implementation

## Identifying a vulnerability

The application does different checks to verify if the password supplied by the user is correct. The most important line for checking the Type Juggling vulnerability is the following:

if ( !$userdata[‚Äòid‚Äô] || **md5**(stripslashes($\_POST[‚Äòpasswd‚Äô])) **!=** $userdata[‚Äòpasswd‚Äô] ) {

Notice that it‚Äôs using only one equal sign, that is a loose comparison, and they should have used an strict one.

In this link you can read the following:

<https://www.whitehatsec.com/blog/magic-hashes/>

‚Äú*For more than the last decade, PHP programmers have been wrestling with the equals-equals (==) operator. It‚Äôs caused a lot of issues. This has a particular implication for password hashes. Password hashes in PHP are base16 encoded and can come in the form of ‚Äú0e812389‚Ä¶‚Äù. The problem is in == comparison the 0e means that if the following characters are all digits the whole string gets treated as a float.* ‚Äú

What they are talking about, is that when there is a loose comparison, you can do strange things, like this:

```
socket@lab:~$ php -r "print md5('aabC9RqS');";echo ''
0e041022518165728065344349536299
socket@lab:~$ php -r "print md5('aabg7XSs');";echo ''
0e087386482136013740957780965295
socket@lab:~$ php -r "var_dump(md5('aabC9RqS') == md5('aabg7XSs'));"
bool(true)
```

As you can see the hashes are different but when we compare them with a loose comparison the result is true.

## Login with the same user using a different password

Before doing anything, let‚Äôs check the current status of our database. Specifically the table usebb\_members that stores usernames and hashed passwords.

I see the following hash stored as the password:

![](https://xavibel.com/wp-content/uploads/2020/01/password-hash-2.png)

UseBB Forum admin password hash

If we remember the login verification, this hash is the value for the variable: $userdata[‚Äòpasswd‚Äô]

Doing a quick verification we can see that this hash, is the md5 value of the password that we used when we registered the user:

```
socket@lab:~$ php -r "print md5('aabC9RqS');";echo ''
0e041022518165728065344349536299
```

We know that the password for the user admin is: ‚ÄúaabC9RqS‚Äù but let‚Äôs try to use ‚Äúaabg7XSs‚Äù instead.

We try to login using this password:

![](https://xavibel.com/wp-content/uploads/2020/01/login-with-different-password.png)

The server is evaluating this:

```
md5('aabC9RqS') == md5('aabg7XSs')
0e041022518165728065344349536299 == 0e087386482136013740957780965295
```

And as we saw before‚Ä¶

```
php -r "var_dump(md5('aabC9RqS') == md5('aabg7XSs'));"
bool(true)
```

So, we are in üôÇ

![](https://xavibel.com/wp-content/uploads/2020/01/admin-login.png)
## Vulnerability solution:

We need to add an extra equal in the line 72 of sources/panel\_login.php

if ( !$userdata[‚Äòid‚Äô] || md5(stripslashes($\_POST[‚Äòpasswd‚Äô])) **!==** $userdata[‚Äòpasswd‚Äô] ) {

This software seems to doesn‚Äôt have support. But if you are using it, I recommend you to migrate it to Drupal using this plugin:

<https://www.drupal.org/project/usebb2drupal>

## Interesting resources:

If you are interested reading more about this topic I recommend you some resources:

<https://www.whitehatsec.com/blog/magic-hashes/>

<https://www.owasp.org/images/6/6b/PHPMagicTricks-TypeJuggling.pdf>

<https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Type%20Juggling>

Thank you for reading the blog! See you soon üôÇ

This entry was posted in [Hacking Web](https://xavibel.com/category/hackingweb/) and tagged [CVE](https://xavibel.com/tag/cve/), [forum](https://xavibel.com/tag/forum/), [Hacking web](https://xavibel.com/tag/hacking-web/), [php](https://xavibel.com/tag/php/), [type juggling](https://xavibel.com/tag/type-juggling/), [usebb](https://xavibel.com/tag/usebb/), [vulnerability discovery](https://xavibel.com/tag/vulnerability-discovery/). Bookmark the [permalink](https://xavibel.com/2020/01/22/usebb-forum-php-type-juggling-vulnerability/ "Permalink to CVE-2020-8088 ‚Äì UseBB Forum 1.0.12 ‚Äì PHP Type Juggling vulnerability").

[‚Üê Siemens Polarion ‚Äì CVE-2019-13934, CVE-2019-13935, CVE-2019-13936](https://xavibel.com/2019/11/25/siemens-polarion-multiple-web-vulnerabilities/)
[CVE-2020-10963 ‚Äì Unrestricted File Upload in FrozenNode/Laravel-Administrator ‚Üí](https://xavibel.com/2020/03/23/unrestricted-file-upload-in-frozennode-laravel-administrator/)

### Leave a Reply [Cancel reply](/2020/01/22/usebb-forum-php-type-juggling-vulnerability/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

Œî

* Search for:
* ### Recent Posts

  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Death Note](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-death-note/)
  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Pet Companion](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-pet-companion/)
  + [Shellcode ‚Äì Windows/x86 ‚Äì Create Administrator User ‚Äì Dynamic PEB & EDT](https://xavibel.com/2023/01/18/shellcode-windows-x86-create-administrator-user-dynamic-peb-edt/)
  + [Creating your own AMSI Bypass using Powershell Reflection Technique](https://xavibel.com/2022/11/03/creating-your-own-amsi-bypass-using-powershell-reflection-technique/)
  + [Linux Shared Library Hijacking](https://xavibel.com/2022/09/06/linux-shared-library-hijacking/)
* ### Recent Comments

  + Xavi on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-9964)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5524)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5523)
  + Xavi on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2892)
  + junsec on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2863)
* ### Archives

  + [March 2024](https://xavibel.com/2024/03/)
  + [January 2023](https://xavibel.com/2023/01/)
  + [November 2022](https://xavibel.com/2022/11/)
  + [September 2022](https://xavibel.com/2022/09/)
  + [November 2020](https://xavibel.com/2020/11/)
  + [October 2020](https://xavibel.com/2020/10/)
  + [March 2020](https://xavibel.com/2020/03/)
  + [January 2020](https://xavibel.com/2020/01/)
  + [November 2019](https://xavibel.com/2019/11/)
  + [September 2019](https://xavibel.com/2019/09/)
  + [August 2019](https://xavibel.com/2019/08/)
  + [July 2019](https://xavibel.com/2019/07/)
  + [June 2019](https://xavibel.com/2019/06/)
  + [May 2019](https://xavibel.com/2019/05/)
  + [April 2019](https://xavibel.com/2019/04/)
  + [March 2019](https://xavibel.com/2019/03/)
  + [February 2019](https://xavibel.com/2019/02/)
  + [October 2018](https://xavibel.com/2018/10/)
* ### Categories

  + [Exploiting](https://xavibel.com/category/exploiting/)
  + [Hacking Web](https://xavibel.com/category/hackingweb/)
  + [Miscellaneous](https://xavibel.com/category/miscellaneous/)
  + [Uncategorized](https://xavibel.com/category/uncategorized/)
* ### Meta

  + [Log in](https://xavibel.com/wp-login.php)
  + [Entries feed](https://xavibel.com/feed/)
  + [Comments feed](https://xavibel.com/comments/feed/)
  + [WordPress.org](https://wordpress.org/)

[Happy Hacking!](https://xavibel.com/)

[Proudly powered by WordPress.](https://wordpress.org/ "Semantic Personal Publishing Platform")



=== Content from xavibel.com_b5b5da80_20250119_141243.html ===

[Happy Hacking!](https://xavibel.com/)

Exploit Dev & Web App Security
![Happy Hacking!](https://xavibel.com/wp-content/uploads/2018/10/cropped-Neo_room-4.jpg)
[Skip to content](#content)

* [Home](https://xavibel.com/)
* [About me](https://xavibel.com/about-me/)

[‚Üê CVE-2020-10963 ‚Äì Unrestricted File Upload in FrozenNode/Laravel-Administrator](https://xavibel.com/2020/03/23/unrestricted-file-upload-in-frozennode-laravel-administrator/)
[Protostar ‚Äì Format Strings ‚Äì Level 0 ‚Üí](https://xavibel.com/2020/11/07/protostar-format-strings/)

# Introduction to Format Strings Bugs

Posted on [October 18, 2020](https://xavibel.com/2020/10/18/introduction-to-format-strings-bugs/ "5:37 pm") by [Xavi](https://xavibel.com/author/xavi/ "View all posts by Xavi")

Format strings are the result of facilities for handling functions with variable arguments in the C programming language.

Because it‚Äôs really C what makes format strings bugs possible, they affect every OS that has a C compiler.

## What is a Format String?

To understand what a format string is, you need to understand the problem that format strings solve. Most programs output textual data in some form, often including numerical data.

Say, for example, that a program wanted to ouput a string containing an amount of money.

```
double amountInDollars;
```

Say the amount in euros is $ 1234.88. With a decimal point an two places after it.

Without format strings we would need to write a substantial amount of code just to format a number this way.

Format strings would provide a more generic solution to this problem by allowing a string to be output that includes the values of variables, formatted precisely as dictated by the programmer.

To output the number as specified, we would simply call the printf function, which outputs the string to the process‚Äôs standard output (stdout):

```
printf( "$%.2f\n", AmountInDollars );
```

To output a double you use the format specifier %f.
In this case the format string is: %.2f
We are using the precision component to specify that we require two places after the decimal point

## Why are they useful?

Let‚Äôs say that we want to print the same variable in three different ways:

* In decimal
* In hex
* In ASCII

We can use format Strings to do that:

```
int main ( int argc, char *argv[] )
{
int c;

printf ("=====================\n");
printf ("Decimal Hex Character\n");
printf ("=====================\n");

for ( c=0x20; c<256; c++ ){
	printf( "%03d %02x %c \n", c, c, c);
}

}
```

If we execute this program we can see that we printed the same variable using 3 different format strings:

![](https://xavibel.com/wp-content/uploads/2020/10/intro2.png)
## What is a Format String bug?

A format string bug occurs when user-supplied data is included in the format string specification string of one of the printf family functions, including:

```
printf
fprintf
sprintf
snprintf
vfprintf
vsprintf
vsnprintf
...
```

The attacker supplies a number of format specifiers that have no corresponding arguments on the stack, and values from the stack are used in their place.
This leads to information disclosure and potentially the execution of arbitrary code.

So, let‚Äôs create a vulnerable example code:

```
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>

int target;

void vuln(char *string)
{
  printf(string);

  if(target) {
      printf("you have modified the target :)\n");
  }
}

int main(int argc, char **argv)
{
  vuln(argv[1]);
}
```

And let‚Äôs compile it disabling all the protections:

```
gcc -fno-stack-protector -m32 -z execstack -no-pie -o example example.c
```

And let‚Äôs supply some malicious user input to display internal memory addresses of the program:

```
./format1 `python2 -c 'print ("A"*4 + "%x."*8)'`%x
```
![](https://xavibel.com/wp-content/uploads/2020/10/example-1024x153.png)

So this is all I wanted to cover with the introduction to Format Strings, in the following days I will try to do ProtoStar exploiting CTF box to learn a bit about this vulnerability:

Here is the link to ProtoStar:

<https://exploit-exercises.lains.space/protostar/>

I would try to write some blog posts to save them as a reference for me in the future, when I will probably forget how to exploit this.

See you soon and happy hacking! üôÇ

This entry was posted in [Exploiting](https://xavibel.com/category/exploiting/) and tagged [Assembly](https://xavibel.com/tag/assembly/), [Boofuzz](https://xavibel.com/tag/boofuzz/), [CTF](https://xavibel.com/tag/ctf/), [exploit development](https://xavibel.com/tag/exploit-development/), [Format Strings](https://xavibel.com/tag/format-strings/), [Fuzzing](https://xavibel.com/tag/fuzzing/), [hacking](https://xavibel.com/tag/hacking/), [OSCE](https://xavibel.com/tag/osce/), [OSCE exam](https://xavibel.com/tag/osce-exam/), [ProtoStar](https://xavibel.com/tag/protostar/), [SEH](https://xavibel.com/tag/seh/), [shellcode](https://xavibel.com/tag/shellcode/), [x86](https://xavibel.com/tag/x86/). Bookmark the [permalink](https://xavibel.com/2020/10/18/introduction-to-format-strings-bugs/ "Permalink to Introduction to Format Strings Bugs").

[‚Üê CVE-2020-10963 ‚Äì Unrestricted File Upload in FrozenNode/Laravel-Administrator](https://xavibel.com/2020/03/23/unrestricted-file-upload-in-frozennode-laravel-administrator/)
[Protostar ‚Äì Format Strings ‚Äì Level 0 ‚Üí](https://xavibel.com/2020/11/07/protostar-format-strings/)

### Leave a Reply [Cancel reply](/2020/10/18/introduction-to-format-strings-bugs/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

Œî

* Search for:
* ### Recent Posts

  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Death Note](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-death-note/)
  + [CTF Binary Exploitation ‚Äì Cyber Apocalypse 2024: Hacker Royale ‚Äì Pet Companion](https://xavibel.com/2024/03/17/ctf-binary-exploitation-cyber-apocalypse-2024-hacker-royale-pet-companion/)
  + [Shellcode ‚Äì Windows/x86 ‚Äì Create Administrator User ‚Äì Dynamic PEB & EDT](https://xavibel.com/2023/01/18/shellcode-windows-x86-create-administrator-user-dynamic-peb-edt/)
  + [Creating your own AMSI Bypass using Powershell Reflection Technique](https://xavibel.com/2022/11/03/creating-your-own-amsi-bypass-using-powershell-reflection-technique/)
  + [Linux Shared Library Hijacking](https://xavibel.com/2022/09/06/linux-shared-library-hijacking/)
* ### Recent Comments

  + Xavi on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-9964)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5524)
  + Merrell Vineza on [Exploit Development ‚Äì Vulnserver TRUN ‚Äì JMP EAX](https://xavibel.com/2019/06/24/exploit-development-vulnserver-trun-hard-way/#comment-5523)
  + Xavi on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2892)
  + junsec on [Shellcoding Linux x86 ‚Äì Bind Shell TCP ‚Äì Assignment 1](https://xavibel.com/2019/04/26/shellcoding-linux-x86-shell-bind-tcp/#comment-2863)
* ### Archives

  + [March 2024](https://xavibel.com/2024/03/)
  + [January 2023](https://xavibel.com/2023/01/)
  + [November 2022](https://xavibel.com/2022/11/)
  + [September 2022](https://xavibel.com/2022/09/)
  + [November 2020](https://xavibel.com/2020/11/)
  + [October 2020](https://xavibel.com/2020/10/)
  + [March 2020](https://xavibel.com/2020/03/)
  + [January 2020](https://xavibel.com/2020/01/)
  + [November 2019](https://xavibel.com/2019/11/)
  + [September 2019](https://xavibel.com/2019/09/)
  + [August 2019](https://xavibel.com/2019/08/)
  + [July 2019](https://xavibel.com/2019/07/)
  + [June 2019](https://xavibel.com/2019/06/)
  + [May 2019](https://xavibel.com/2019/05/)
  + [April 2019](https://xavibel.com/2019/04/)
  + [March 2019](https://xavibel.com/2019/03/)
  + [February 2019](https://xavibel.com/2019/02/)
  + [October 2018](https://xavibel.com/2018/10/)
* ### Categories

  + [Exploiting](https://xavibel.com/category/exploiting/)
  + [Hacking Web](https://xavibel.com/category/hackingweb/)
  + [Miscellaneous](https://xavibel.com/category/miscellaneous/)
  + [Uncategorized](https://xavibel.com/category/uncategorized/)
* ### Meta

  + [Log in](https://xavibel.com/wp-login.php)
  + [Entries feed](https://xavibel.com/feed/)
  + [Comments feed](https://xavibel.com/comments/feed/)
  + [WordPress.org](https://wordpress.org/)

[Happy Hacking!](https://xavibel.com/)

[Proudly powered by WordPress.](https://wordpress.org/ "Semantic Personal Publishing Platform")


