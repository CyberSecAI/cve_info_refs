=== Content from graz.pure.elsevier.com_2800e62b_20250119_123609.html ===


* [Skip to main navigation](#main-navigation)
* [Skip to search](#main-search)
* [Skip to main content](#main-content)

[Graz University of Technology Home
![Graz University of Technology Logo](/skin/headerImage/)](/en/)

* + [English](/en/publications/total-eclipse-of-the-heart-disrupting-the-interplanetary-file-sys)
  + [Deutsch](/de/publications/total-eclipse-of-the-heart-disrupting-the-interplanetary-file-sys)

* [Home](/en/)
* [Persons](/en/persons/)
* [Publications](/en/publications/)
* [Organisations](/en/organisations/)
* [Projects](/en/projects/)
* [Activities](/en/activities/)
* [Prizes](/en/prizes/)
* [Press/Media](/en/clippings/)

Search by expertise, name or affiliation

# Total Eclipse of the Heart – Disrupting the InterPlanetary File System

Bernd Prünster, Alexander Marsalek, [Thomas Zefferer](https://graz.elsevierpure.com/en/persons/thomas-zefferer)

* [Institute of Information Security (7050)](https://graz.elsevierpure.com/en/organisations/institute-of-information-security-7050)
* [A-sit - Secure Information Technology Centre Austria (99V01)](https://graz.elsevierpure.com/en/organisations/a-sit-secure-information-technology-centre-austria-99v01)

Research output: Chapter in Book/Report/Conference proceeding › Conference paper › peer-review

* [Overview](/en/publications/total-eclipse-of-the-heart-disrupting-the-interplanetary-file-sys)
* [Fingerprint](/en/publications/total-eclipse-of-the-heart-disrupting-the-interplanetary-file-sys/fingerprints/)
* [Projects
  (1)](/en/publications/total-eclipse-of-the-heart-disrupting-the-interplanetary-file-sys/projects/)

## Abstract

Peer-to-peer networks are an attractive alternative to classical client-server architectures in several fields of application such as voice-over-IP telephony and file sharing. Recently, a new peer-to-peer solution called the InterPlanetary File System (IPFS) has attracted attention, which promises to re-decentralise the Web. Being increasingly used as a stand-alone application, IPFS has also emerged as the technical backbone of various other decentralised solutions and was even used to evade censorship. Decentralised applications serving millions of users rely on IPFS as one of their crucial building blocks. This popularity makes IPFS attractive for large-scale attacks. We have identified a conceptual issue in one of IPFS’s core libraries and demonstrate their exploitation by means of a successful end-to-end attack. We evaluated this attack against the IPFS reference implementation on the public IPFS network, which is used by the average user to share and consume IPFS content. Results obtained from mounting this attack on live IPFS nodes show that arbitrary IPFS nodes can be eclipsed, i.e. isolated from the network, with moderate effort and limited resources. Compared to similar works, we show that our attack scales linearly even beyond current network sizes and can disrupt the entire public IPFS network with alarmingly low effort. The vulnerability set described in this paper has been assigned CVE-2020-10937. Responsible disclosure procedures are currently being carried out and have led to mitigations being deployed, with additional fixes to be rolled out in future releases.

| Original language | English |
| --- | --- |
| Title of host publication | 31st USENIX Security Symposium |
| Publisher | USENIX Association |
| Pages | 3735-3752 |
| ISBN (Electronic) | 978-1-939133-31-1 |
| Publication status | Published - 2022 |
| Event | 31st USENIX Security Symposium: USENIX Security 2022 - Boston, United StatesDuration: 10 Aug 2022 → 12 Aug 2022Conference number: 31 |

### Conference

| Conference | 31st USENIX Security Symposium |
| --- | --- |
| Abbreviated title | USENIX '22 |
| Country/Territory | United States |
| City | Boston |
| Period | 10/08/22 → 12/08/22 |

## Fields of Expertise

* Information, Communication & Computing
## Treatment code (Nähere Zuordnung)

* Application

## Access to Document

* [Originally, unrevised submitted manuscript](/files/41062120/ipfs_eclipse.pdf)Submitted manuscript, 6.3 MB
* [ipfs-eclipse](/files/38133443/ipfs_eclipse.pdf)Accepted author manuscript, 2.75 MB

* <https://arxiv.org/abs/2011.00874>
* <https://www.usenix.org/system/files/sec22-prunster.pdf>Licence: Other
## Other files and links

* [IPFS Blog Post on the Subject](https://blog.ipfs.io/2020-10-30-dht-hardening/)

## Fingerprint

Dive into the research topics of 'Total Eclipse of the Heart – Disrupting the InterPlanetary File System'. Together they form a unique fingerprint.

* Network File System
  Computer Science
  100%
* Responsible Disclosure
  Computer Science
  50%
* Client-Server Architecture
  Computer Science
  50%

[View full fingerprint](/en/publications/total-eclipse-of-the-heart-disrupting-the-interplanetary-file-sys/fingerprints/)

## Projects

* [1](/en/publications/total-eclipse-of-the-heart-disrupting-the-interplanetary-file-sys/projects/?status=FINISHED)
  Finished

Projects per year

* ### [A-SIT - Secure Information Technology Center Austria](https://graz.elsevierpure.com/en/projects/a-sit-secure-information-technology-center-austria)

  Stranacher, K. (Co-Investigator (CoI)), Dominikus, S. (Co-Investigator (CoI)), [Leitold, H.](https://graz.elsevierpure.com/en/persons/herbert-leitold) (Co-Investigator (CoI)), Marsalek, A. (Co-Investigator (CoI)), Teufl, P. (Co-Investigator (CoI)), Bauer, W. (Co-Investigator (CoI)), Aigner, M. J. (Co-Investigator (CoI)), Rössler, T. (Co-Investigator (CoI)), Neuherz, E. (Co-Investigator (CoI)), Dietrich, K. (Co-Investigator (CoI)), [Zefferer, T.](https://graz.elsevierpure.com/en/persons/thomas-zefferer) (Co-Investigator (CoI)), [Mangard, S.](https://graz.elsevierpure.com/en/persons/stefan-mangard) (Co-Investigator (CoI)), Payer, U. (Co-Investigator (CoI)), Orthacker, C. (Co-Investigator (CoI)), Lipp, P. (Co-Investigator (CoI)), Reiter, A. (Co-Investigator (CoI)), Knall, T. (Co-Investigator (CoI)), [Bratko, H.](https://graz.elsevierpure.com/en/persons/harald-bratko) (Co-Investigator (CoI)), Bonato, M. (Co-Investigator (CoI)), Suzic, B. (Co-Investigator (CoI)), Zwattendorfer, B. (Co-Investigator (CoI)), Kreuzhuber, S. (Co-Investigator (CoI)), Oswald, M. E. (Co-Investigator (CoI)), [Tauber, A.](https://graz.elsevierpure.com/en/persons/arne-tauber) (Co-Investigator (CoI)), [Posch, R.](https://graz.elsevierpure.com/en/persons/reinhard-posch) (Principal Investigator (PI)), Bratko, D. (Co-Investigator (CoI)), Feichtner, J. (Co-Investigator (CoI)), Ivkovic, M. (Co-Investigator (CoI)), Reimair, F. (Co-Investigator (CoI)), Wolkerstorfer, J. (Co-Investigator (CoI)) & Scheibelhofer, K. (Co-Investigator (CoI))

  21/05/99 → 31/12/24

  Project: Research area

  + e-government
    100%
  + Security and Privacy
    92%
  + Cryptocurrency
    92%
  + Data Security
    80%
  + Android
    76%

## Cite this

* APA
* Standard
* Harvard
* Vancouver
* Author
* BIBTEX
* RIS

Prünster, B., Marsalek, A.[, & Zefferer, T.](https://graz.elsevierpure.com/en/persons/thomas-zefferer) (2022). [Total Eclipse of the Heart – Disrupting the InterPlanetary File System](https://graz.elsevierpure.com/en/publications/total-eclipse-of-the-heart-disrupting-the-interplanetary-file-sys). In *31st USENIX Security Symposium* (pp. 3735-3752). USENIX Association. <https://arxiv.org/abs/2011.00874>

[**Total Eclipse of the Heart – Disrupting the InterPlanetary File System.**](https://graz.elsevierpure.com/en/publications/total-eclipse-of-the-heart-disrupting-the-interplanetary-file-sys) / Prünster, Bernd; Marsalek, Alexander[; Zefferer, Thomas](https://graz.elsevierpure.com/en/persons/thomas-zefferer).
31st USENIX Security Symposium. USENIX Association, 2022. p. 3735-3752.

Research output: Chapter in Book/Report/Conference proceeding › Conference paper › peer-review

Prünster, B, Marsalek, A [& Zefferer, T](https://graz.elsevierpure.com/en/persons/thomas-zefferer) 2022, [Total Eclipse of the Heart – Disrupting the InterPlanetary File System](https://graz.elsevierpure.com/en/publications/total-eclipse-of-the-heart-disrupting-the-interplanetary-file-sys). in *31st USENIX Security Symposium.* USENIX Association, pp. 3735-3752, 31st USENIX Security Symposium, Boston, United States, 10/08/22. <<https://arxiv.org/abs/2011.00874>>

Prünster B, Marsalek A[, Zefferer T](https://graz.elsevierpure.com/en/persons/thomas-zefferer). [Total Eclipse of the Heart – Disrupting the InterPlanetary File System](https://graz.elsevierpure.com/en/publications/total-eclipse-of-the-heart-disrupting-the-interplanetary-file-sys). In 31st USENIX Security Symposium. USENIX Association. 2022. p. 3735-3752

Prünster, Bernd ; Marsalek, Alexander  [; Zefferer, Thomas](https://graz.elsevierpure.com/en/persons/thomas-zefferer). / [**Total Eclipse of the Heart – Disrupting the InterPlanetary File System**](https://graz.elsevierpure.com/en/publications/total-eclipse-of-the-heart-disrupting-the-interplanetary-file-sys). 31st USENIX Security Symposium. USENIX Association, 2022. pp. 3735-3752

@inproceedings{3e04af3b57cd4194a991245a84fce8be, title = "Total Eclipse of the Heart – Disrupting the InterPlanetary File System", abstract = "Peer-to-peer networks are an attractive alternative to classical client-server architectures in several fields of application such as voice-over-IP telephony and file sharing. Recently, a new peer-to-peer solution called the InterPlanetary File System (IPFS) has attracted attention, which promises to re-decentralise the Web. Being increasingly used as a stand-alone application, IPFS has also emerged as the technical backbone of various other decentralised solutions and was even used to evade censorship. Decentralised applications serving millions of users rely on IPFS as one of their crucial building blocks. This popularity makes IPFS attractive for large-scale attacks. We have identified a conceptual issue in one of IPFS{\textquoteright}s core libraries and demonstrate their exploitation by means of a successful end-to-end attack. We evaluated this attack against the IPFS reference implementation on the public IPFS network, which is used by the average user to share and consume IPFS content. Results obtained from mounting this attack on live IPFS nodes show that arbitrary IPFS nodes can be eclipsed, i.e. isolated from the network, with moderate effort and limited resources. Compared to similar works, we show that our attack scales linearly even beyond current network sizes and can disrupt the entire public IPFS network with alarmingly low effort. The vulnerability set described in this paper has been assigned CVE-2020-10937. Responsible disclosure procedures are currently being carried out and have led to mitigations being deployed, with additional fixes to be rolled out in future releases.", author = "Bernd Pr{\"u}nster and Alexander Marsalek and Thomas Zefferer", year = "2022", language = "English", pages = "3735--3752", booktitle = "31st USENIX Security Symposium", publisher = "USENIX Association", address = "United States", note = "31st USENIX Security Symposium : USENIX Security 2022, USENIX '22 ; Conference date: 10-08-2022 Through 12-08-2022",

}

TY - GEN

T1 - Total Eclipse of the Heart – Disrupting the InterPlanetary File System

AU - Prünster, Bernd

AU - Marsalek, Alexander

AU - Zefferer, Thomas

N1 - Conference code: 31

PY - 2022

Y1 - 2022

N2 - Peer-to-peer networks are an attractive alternative to classical client-server architectures in several fields of application such as voice-over-IP telephony and file sharing. Recently, a new peer-to-peer solution called the InterPlanetary File System (IPFS) has attracted attention, which promises to re-decentralise the Web. Being increasingly used as a stand-alone application, IPFS has also emerged as the technical backbone of various other decentralised solutions and was even used to evade censorship. Decentralised applications serving millions of users rely on IPFS as one of their crucial building blocks. This popularity makes IPFS attractive for large-scale attacks. We have identified a conceptual issue in one of IPFS’s core libraries and demonstrate their exploitation by means of a successful end-to-end attack. We evaluated this attack against the IPFS reference implementation on the public IPFS network, which is used by the average user to share and consume IPFS content. Results obtained from mounting this attack on live IPFS nodes show that arbitrary IPFS nodes can be eclipsed, i.e. isolated from the network, with moderate effort and limited resources. Compared to similar works, we show that our attack scales linearly even beyond current network sizes and can disrupt the entire public IPFS network with alarmingly low effort. The vulnerability set described in this paper has been assigned CVE-2020-10937. Responsible disclosure procedures are currently being carried out and have led to mitigations being deployed, with additional fixes to be rolled out in future releases.

AB - Peer-to-peer networks are an attractive alternative to classical client-server architectures in several fields of application such as voice-over-IP telephony and file sharing. Recently, a new peer-to-peer solution called the InterPlanetary File System (IPFS) has attracted attention, which promises to re-decentralise the Web. Being increasingly used as a stand-alone application, IPFS has also emerged as the technical backbone of various other decentralised solutions and was even used to evade censorship. Decentralised applications serving millions of users rely on IPFS as one of their crucial building blocks. This popularity makes IPFS attractive for large-scale attacks. We have identified a conceptual issue in one of IPFS’s core libraries and demonstrate their exploitation by means of a successful end-to-end attack. We evaluated this attack against the IPFS reference implementation on the public IPFS network, which is used by the average user to share and consume IPFS content. Results obtained from mounting this attack on live IPFS nodes show that arbitrary IPFS nodes can be eclipsed, i.e. isolated from the network, with moderate effort and limited resources. Compared to similar works, we show that our attack scales linearly even beyond current network sizes and can disrupt the entire public IPFS network with alarmingly low effort. The vulnerability set described in this paper has been assigned CVE-2020-10937. Responsible disclosure procedures are currently being carried out and have led to mitigations being deployed, with additional fixes to be rolled out in future releases.

UR - https://blog.ipfs.io/2020-10-30-dht-hardening/

M3 - Conference paper

SP - 3735

EP - 3752

BT - 31st USENIX Security Symposium

PB - USENIX Association

T2 - 31st USENIX Security Symposium

Y2 - 10 August 2022 through 12 August 2022

ER -

Powered by [Pure](http://www.elsevier.com/online-tools/research-intelligence/products-and-services/pure), [Scopus](http://www.scopus.com/) & [Elsevier Fingerprint Engine™](https://www.elsevier.com/products/elsevier-fingerprint-engine)

All content on this site: Copyright © 2025 Graz University of Technology, its licensors, and contributors. All rights are reserved, including those for text and data mining, AI training, and similar technologies. For all open access content, the relevant licensing terms apply

We use cookies to help provide and enhance our service and tailor content. By continuing you agree to the [use of cookies](/en/about/cookies/)

[Log in to Pure](https://pure.tugraz.at/admin/workspace.xhtml)

[Impressum](http://www.tugraz.at/impressum)

[Graz University of Technology data protection policy](http://www.tugraz.at/impressum)

[About web accessibility](/en/web-accessibility/)

[Report vulnerability](https://elsevier.responsibledisclosure.com/hc/en-us/requests/new)



=== Content from blog.ipfs.io_2cb94e1c_20250119_123608.html ===

[IPFS](https://ipfs.tech/)

* [About](https://ipfs.tech/)
* [Community](https://ipfs.tech/community/)
* [Developers](https://ipfs.tech/developers/)
* [Docs](https://docs.ipfs.tech/)
* [Blog](/)

    [Blog & news](/)
# Hardening the IPFS public DHT against eclipse attacks

[Jacob Heun](../?author=jacob-heun)
30 October 2020
 ![Hardening the IPFS public DHT against eclipse attacks](../assets/img/blog-post-placeholder.af417eb0.png)  [#libp2p](../?tags=libp2p)[#DHT](../?tags=dht)[#security](../?tags=security)
Share this item:
Twitter Facebook

A major focus of IPFS for 2020 has been improving Content Routing as the network has continued to scale. While we've made [significant improvements  (opens new window)](https://blog.ipfs.tech/2020-07-20-dht-deep-dive/) to the speed of requests on the DHT, another crucial focus for us has been on the security of the network. During our work leading up to the release of go-ipfs 0.5, we were contacted by Bernd PrÃ¼nster and Alexander Marsalek at [A-SIT  (opens new window)](https://www.a-sit.at) and the [Graz University of Technology  (opens new window)](https://tugraz.at) to advise us of an attack they had discovered during their research targeting go-ipfs 0.4.23 that would allow an attacker with minimal resources to eclipse any node on the public DHT. Over the past 3 minor releases of go-ipfs (0.5, 0.6 and 0.7), we've been collaborating closely with Bernd and Alexander, which has enabled us to release incremental improvements that have mitigated their original attack and increased the cost and difficulty of such attacks by several orders of magnitude. Today we'll dive into the attack and the various mitigations we've released. If you would like to read the full paper, "Total Eclipse of the Heart â Disrupting the InterPlanetary File System", you can find it at the [TU Graz Research Portal  (opens new window)](https://graz.pure.elsevier.com/en/publications/total-eclipse-of-the-heart-disrupting-the-interplanetary-file-sys).

## [#](#mitigating-the-attack) Mitigating the attack

An eclipse attack refers to the ability of an attacker to isolate a peer from the rest of the network so that the targeted peer only communicates with peers controlled by the attacker. The goal of this attack is to pollute the target peers DHT routing table so that only the peers the attacker controls are present. In the attack discovered by Bernd and Alexander, they created a Sybil attack using libp2p and a massive pregenerated list of Peer IDs, totalling 29TB of data, to game the reputation system in libp2p in order to take over the routing table.

If you are not familiar with [Sybil attacks  (opens new window)](https://en.wikipedia.org/wiki/Sybil_attack), the idea is that you can use a single peer with a large number of pseudonymous IDs to subvert reputation systems in order to increase influence on the network. In the context of this attack, the false IDs end up taking the place of honest peers in the routing table of the affected peer.

In order for this attack to be successful, a few vulnerabilities in libp2p were exposed, which ultimately resulted in this attack being very effective in go-ipfs [0.4.23  (opens new window)](https://blog.ipfs.tech/2020-01-30-go-ipfs-0-4-23/). One of the major problems libp2p had at the time this attack was discovered is that the DHT did not favor long lived peers, and it didn't protect peers in its lower buckets (peers on the other half of the network). This issue allowed an attacker to quickly evict honest peers from the routing table of the target in favor of its dishonest peers. As part of the work to overhaul the DHT in go-ipfs 0.5, we changed how entries in the routing table are managed. One of the major changes that affects this is that we will no longer evict a peer from the routing table that is still available. This coupled with the rest of the improvements we made to the DHT in go-ipfs 0.5 made the attack several orders of magnitude more difficult to execute. You can read about the detailed changes to the DHT in the [IPFS 0.5 Content Routing Deep Dive  (opens new window)](https://blog.ipfs.tech/2020-07-20-dht-deep-dive/).

In addition to the changes in go-ipfs 0.5, we also fixed a couple of issues that further increased the difficulty and cost of this attack. Part of the attack's success was due to the ability of a Sybil node to game the reputation system of valued connections by abusing a flaw in how scoring was done for peers acting as relays. The flaw could allow a Sybil node to act as a relay to subsequent Sybil peers, which would continue to boost the score of the relay. This could be done for a single peer using nested Sybils to quickly gain a lot of unwarranted reputation. To resolve this we applied a constant score to relays, which allows us to still value them, but avoids them being able to inflate their reputation. By improving the integrity of internal reputation systems, we've reduced the efficacy of Sybil attacks.

The other significant change we made to increase the cost of this type of attack is introducing IP diversity requirements into the routing table. The original attack on go-ipfs 0.4.23 was able to run on a single machine with a relatively low expense because it was possible for a routing table to contain only peers from a single host. The IP diversity requirement now caps the number of peers that can come from any given host, which makes it infeasible to perform an eclipse attack from a single machine, further increasing the cost of the attack by over two orders of magnitude from go-ipfs 0.5.

## [#](#verifying-the-mitigations) Verifying the mitigations

As part of this collaboration with Bernd and Alexander, we wanted to ensure that we were able to properly test and verify our fixes, which we took two approaches to:

**Live testing**. With our permission, they performed a controlled attack on one of our hosted bootstrap nodes on the public network. This enabled us to gather live metrics and logs to observe the effectiveness of the attack from both our visibility and their external observations. The controlled attack was performed on each version of IPFS prior to its release starting with go-ipfs 0.5, which enabled us to validate our fixes in a production environment.

**Replication on Testground**. Thanks to the development and [release of Testground  (opens new window)](https://blog.ipfs.tech/2020-05-06-launching-testground/), and Bernd and Alexander sharing their attack code, we were able to create test plans to replicate various parts of the attack. This enabled us to do large scale testing of the changes in a controlled test environment to both verify the attack was possible, and to verify our mitigations. The benefit of having these test plans is that we can continue to run them on releases of IPFS and libp2p to ensure we don't introduce regressions. Additionally this ensures we can run the attacks for longer periods of time in a controlled environment to do further analysis on the efficacy and cost of the attacks.

## [#](#where-we-are-today) Where we are today

Over the course of this year we have made significant improvements to both the performance and security of IPFS and libp2p, and collaboration has been a huge part of making this work successful. The research Bernd and Alexander have done, and their willingness to collaborate with us so closely has been invaluable in helping us improve the stability of the network. We're grateful for having had the opportunity to work together. With the release of [go-ipfs 0.7  (opens new window)](https://blog.ipfs.tech/2020-09-24-go-ipfs-0-7-0/) in September, we have increased the difficulty and cost of executing eclipse and Sybil attacks on IPFS and libp2p by several orders of magnitude from its 0.4.23 predecessor.

If you haven't already updated to go-ipfs 0.7, we recommend updating as soon as possible to take advantage of the full scope of these improvements. Check out the [go-ipfs 0.7 update guide  (opens new window)](https://docs.ipfs.tech/recent-releases/go-ipfs-0-7/update-procedure/#use-ipfs-update) for details on how to update!

## Stay informed

Sign up for the IPFS newsletter ([example](../2020-10-30-dht-hardening/)) for the latest on releases, upcoming developments, community events,
and more.

[Sign up](https://ipfs.fyi/newsletter)

* [Blog & news](/)
* [Press](https://ipfs.tech/media/)
* [Code of conduct](https://github.com/ipfs/community/blob/master/code-of-conduct.md)
* [Security](https://github.com/ipfs/community/blob/master/CONTRIBUTING.md#security-issues)
 [Github](https://github.com/ipfs) [YouTube](https://www.youtube.com/channel/UCdjsUXJ3QawK4O5L1kqqsew) [Twitter](http://twitter.com/ipfs) [LinkedIn](https://www.linkedin.com/company/protocollabs/)  [Protocol Labs](https://protocol.ai)
Â©
[Protocol Labs](https://protocol.ai)
| Except as
[noted](https://protocol.ai/legal/), content licensed
[CC-BY 3.0](https://creativecommons.org/licenses/by/3.0/)
|
[Terms](https://protocol.ai/legal/#terms-of-service)
|
[Privacy](https://protocol.ai/legal/#privacy-policy)
|
[DMCA](https://ipfs.tech/legal/)


