**Root cause of vulnerability:**

The plugin's `sgpbAutosave` function, intended for auto-saving draft popups, is accessible to unauthenticated users and lacks nonce or capability checks. This allows attackers to inject malicious JavaScript code into popup settings. Additionally, the plugin has multiple other vulnerabilities stemming from missing capability checks allowing lower level authenticated users to modify settings, export user data and system info.

**Weaknesses/vulnerabilities present:**

*   **Unauthenticated Stored Cross-Site Scripting (XSS):** The `sgpbAutosave` function does not perform authentication or authorization checks and allows unauthenticated users to modify popup settings via a POST request.
*   **Authenticated Settings Modification:** Logged-in users with minimal permissions (e.g., subscribers) can modify plugin settings, specifically granting subscriber-level users access to various plugin functionalities.
*   **Configuration Disclosure:** Any logged in user can export system information using the `sgpb_system_info` action, revealing details about installed plugins and their activation status.
*  **User Data Export:** Any logged in user can export a list of newsletter subscribers using the `csv_file` action, exposing sensitive information.

**Impact of exploitation:**

*   **Unauthenticated Stored XSS:** An attacker can inject malicious JavaScript into popups. This code executes when a user visits a page where the popup is displayed. This could lead to redirection to malicious sites, stealing sensitive data, or site takeover if an admin visits the infected page while logged in.
*   **Authenticated Settings Modification:** Attackers can grant themselves and other low-level users additional permissions within the plugin.
*   **Configuration Disclosure:** Attackers can use the system information to craft more targeted attacks on the website.
*   **User Data Export:** Attackers can obtain subscriber information for social engineering attacks.

**Attack vectors:**

*   **Unauthenticated Stored XSS:** Sending a POST request to `wp-admin/admin-ajax.php` with the `action` parameter set to `sgpb_autosave` and including a malicious JavaScript payload within the `allPopupData` parameter. The popup ID, required to target a specific popup, is visible in the page source.
*   **Authenticated Settings Modification:** Sending a POST request to `admin-post.php` with the `action` parameter set to `sgpbSaveSettings` and the `sgpb-user-roles[]` parameter set to `subscriber`.
*   **Configuration Disclosure:** Sending a POST request to `admin-post.php` with the `action` parameter set to `sgpb_system_info`.
*  **User Data Export:** Sending a POST request to `admin-post.php` with the `action` parameter set to `csv_file`.

**Required attacker capabilities/position:**

*   **Unauthenticated Stored XSS:** No authentication required. Attacker only needs to be able to send a POST request.
*   **Authenticated Settings Modification/Configuration Disclosure/User Data Export:** Requires a user account with minimal permissions, such as a subscriber role.

**Additional Details:**

The provided content includes more detail than the typical CVE description, providing the vulnerable code snippets, specific vulnerable functions and parameter names for each attack vector, and also the timeline of vulnerability discovery, disclosure, and patching.