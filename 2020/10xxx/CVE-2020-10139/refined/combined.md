=== Content from attack.mitre.org_5469b789_20250119_132133.html ===


[![](/theme/images/mitre_attack_logo.png)](/)

* [**Matrices**](/matrices/)
  [Enterprise](/matrices/enterprise/)
  [Mobile](/matrices/mobile/)
  [ICS](/matrices/ics/)
* [**Tactics**](/tactics/)
  [Enterprise](/tactics/enterprise/)
  [Mobile](/tactics/mobile/)
  [ICS](/tactics/ics/)
* [**Techniques**](/techniques/)
  [Enterprise](/techniques/enterprise/)
  [Mobile](/techniques/mobile/)
  [ICS](/techniques/ics/)
* [**Defenses**](/datasources)
  [Data Sources](/datasources)
  [**Mitigations**](/mitigations/)
  [Enterprise](/mitigations/enterprise/)
  [Mobile](/mitigations/mobile/)
  [ICS](/mitigations/ics/)

  [Assets](/assets)
* [**CTI**](/groups)
  [Groups](/groups)
  [Software](/software)
  [Campaigns](/campaigns)
* [**Resources**](/resources/)
  [Get Started](/resources/)
  [Learn More about ATT&CK](/resources/learn-more-about-attack/)
  [ATT&CKcon](/resources/attackcon/)
  [ATT&CK Data & Tools](/resources/attack-data-and-tools/)
  [FAQ](/resources/faq/)
  [Engage with ATT&CK](/resources/engage-with-attack/contact/)
  [Version History](/resources/versions/)
  [Legal & Branding](/resources/legal-and-branding/)
* [**Benefactors**](/resources/engage-with-attack/benefactors/)
* [**Blog**
  ![External site](/theme/images/external-site.svg)](https://medium.com/mitre-attack/)
* Search

Reminder: the TAXII 2.0 server [retired on December 18](https://medium.com/mitre-attack/introducing-taxii-2-1-and-a-fond-farewell-to-taxii-2-0-d9fca6ce4c58). Please switch to the [TAXII 2.1 server](https://github.com/mitre-attack/attack-workbench-taxii-server/blob/main/docs/USAGE.md) to ensure uninterrupted service.

1. [Home](/)
2. [Techniques](/techniques/enterprise)
3. [Enterprise](/techniques/enterprise)
4. [Hijack Execution Flow](/techniques/T1574)
5. DLL Search Order Hijacking

# Hijack Execution Flow: DLL Search Order Hijacking

##### Other sub-techniques of Hijack Execution Flow (13)

| ID | Name |
| --- | --- |
| T1574.001 | DLL Search Order Hijacking |
| [T1574.002](/techniques/T1574/002/) | [DLL Side-Loading](/techniques/T1574/002/) |
| [T1574.004](/techniques/T1574/004/) | [Dylib Hijacking](/techniques/T1574/004/) |
| [T1574.005](/techniques/T1574/005/) | [Executable Installer File Permissions Weakness](/techniques/T1574/005/) |
| [T1574.006](/techniques/T1574/006/) | [Dynamic Linker Hijacking](/techniques/T1574/006/) |
| [T1574.007](/techniques/T1574/007/) | [Path Interception by PATH Environment Variable](/techniques/T1574/007/) |
| [T1574.008](/techniques/T1574/008/) | [Path Interception by Search Order Hijacking](/techniques/T1574/008/) |
| [T1574.009](/techniques/T1574/009/) | [Path Interception by Unquoted Path](/techniques/T1574/009/) |
| [T1574.010](/techniques/T1574/010/) | [Services File Permissions Weakness](/techniques/T1574/010/) |
| [T1574.011](/techniques/T1574/011/) | [Services Registry Permissions Weakness](/techniques/T1574/011/) |
| [T1574.012](/techniques/T1574/012/) | [COR\_PROFILER](/techniques/T1574/012/) |
| [T1574.013](/techniques/T1574/013/) | [KernelCallbackTable](/techniques/T1574/013/) |
| [T1574.014](/techniques/T1574/014/) | [AppDomainManager](/techniques/T1574/014/) |

Adversaries may execute their own malicious payloads by hijacking the search order used to load DLLs. Windows systems use a common method to look for required DLLs to load into a program. [[1]](https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order?redirectedfrom=MSDN)[[2]](https://www.fireeye.com/blog/threat-research/2010/07/malware-persistence-windows-registry.html) Hijacking DLL loads may be for the purpose of establishing persistence as well as elevating privileges and/or evading restrictions on file execution.

There are many ways an adversary can hijack DLL loads. Adversaries may plant trojan dynamic-link library files (DLLs) in a directory that will be searched before the location of a legitimate library that will be requested by a program, causing Windows to load their malicious library when it is called for by the victim program. Adversaries may also perform DLL preloading, also called binary planting attacks, [[3]](https://www.owasp.org/index.php/Binary_planting) by placing a malicious DLL with the same name as an ambiguously specified DLL in a location that Windows searches before the legitimate DLL. Often this location is the current working directory of the program.[[4]](https://www.fireeye.com/blog/threat-research/2011/06/fxsst.html) Remote DLL preloading attacks occur when a program sets its current directory to a remote location such as a Web share before loading a DLL. [[5]](https://docs.microsoft.com/en-us/security-updates/securityadvisories/2010/2269637)

Phantom DLL hijacking is a specific type of DLL search order hijacking where adversaries target references to non-existent DLL files.[[6]](https://www.hexacorn.com/blog/2013/12/08/beyond-good-ol-run-key-part-5/)[[7]](https://www.crowdstrike.com/blog/4-ways-adversaries-hijack-dlls/) They may be able to load their own malicious DLL by planting it with the correct name in the location of the missing module.

Adversaries may also directly modify the search order via DLL redirection, which after being enabled (in the Registry and creation of a redirection file) may cause a program to load a different DLL.[[8]](https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-redirection?redirectedfrom=MSDN)[[9]](https://msdn.microsoft.com/en-US/library/aa375365)[[10]](https://www.fireeye.com/blog/threat-research/2010/08/dll-search-order-hijacking-revisited.html)

If a search order-vulnerable program is configured to run at a higher privilege level, then the adversary-controlled DLL that is loaded will also be executed at the higher level. In this case, the technique could be used for privilege escalation from user to administrator or SYSTEM or from administrator to SYSTEM, depending on the program. Programs that fall victim to path hijacking may appear to behave normally because malicious DLLs may be configured to also load the legitimate DLLs they were meant to replace.

ID: T1574.001

Sub-technique of:
[T1574](/techniques/T1574)

ⓘ

Tactics:
[Persistence](/tactics/TA0003), [Privilege Escalation](/tactics/TA0004), [Defense Evasion](/tactics/TA0005)

ⓘ

Platforms: Windows

Contributors: Ami Holeston, CrowdStrike; Marina Liang; Stefan Kanthak; Travis Smith, Tripwire; Will Alexander, CrowdStrike

Version: 1.3

Created: 13 March 2020

Last Modified: 30 September 2024

[Version Permalink](/versions/v16/techniques/T1574/001/ "Permalink to this version of T1574.001")

[Live Version](/versions/v16/techniques/T1574/001/ "Go to the live version of T1574.001")

## Procedure Examples

| ID | Name | Description |
| --- | --- | --- |
| [G0096](/groups/G0096) | [APT41](/groups/G0096) | [APT41](/groups/G0096) has used search order hijacking to execute malicious payloads, such as [Winnti for Windows](/software/S0141).[[11]](https://go.crowdstrike.com/rs/281-OBQ-266/images/Report2020CrowdStrikeGlobalThreatReport.pdf) |
| [C0040](/campaigns/C0040) | [APT41 DUST](/campaigns/C0040) | [APT41 DUST](https://attack.mitre.org/campaigns/C0040) involved the use of DLL search order hijacking to execute [DUSTTRAP](/software/S1159).[[12]](https://cloud.google.com/blog/topics/threat-intelligence/apt41-arisen-from-dust) |
| [G0143](/groups/G0143) | [Aquatic Panda](/groups/G0143) | [Aquatic Panda](/groups/G0143) has used DLL search-order hijacking to load `exe`, `dll`, and `dat` files into memory.[[13]](https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/) [Aquatic Panda](/groups/G0143) loaded a malicious DLL into the legitimate Windows Security Health Service executable (`SecurityHealthService.exe`) to execute malicious code on victim systems.[[14]](https://go.crowdstrike.com/rs/281-OBQ-266/images/2022OverWatchThreatHuntingReport.pdf) |
| [S0373](/software/S0373) | [Astaroth](/software/S0373) | [Astaroth](/software/S0373) can launch itself via DLL Search Order Hijacking.[[15]](https://securelist.com/the-tetrade-brazilian-banking-malware/97779/) |
| [G0135](/groups/G0135) | [BackdoorDiplomacy](/groups/G0135) | [BackdoorDiplomacy](/groups/G0135) has executed DLL search order hijacking.[[16]](https://www.welivesecurity.com/2021/06/10/backdoordiplomacy-upgrading-quarian-turian/) |
| [S0415](/software/S0415) | [BOOSTWRITE](/software/S0415) | [BOOSTWRITE](/software/S0415) has exploited the loading of the legitimate Dwrite.dll file by actually loading the gdi library, which then loads the gdiplus library and ultimately loads the local Dwrite dll.[[17]](https://www.fireeye.com/blog/threat-research/2019/10/mahalo-fin7-responding-to-new-tools-and-techniques.html) |
| [S1063](/software/S1063) | [Brute Ratel C4](/software/S1063) | [Brute Ratel C4](/software/S1063) has used search order hijacking to load a malicious payload DLL as a dependency to a benign application packaged in the same ISO.[[18]](https://unit42.paloaltonetworks.com/brute-ratel-c4-tool/) |
| [S0631](/software/S0631) | [Chaes](/software/S0631) | [Chaes](/software/S0631) has used search order hijacking to load a malicious DLL.[[19]](https://www.cybereason.com/hubfs/dam/collateral/reports/11-2020-Chaes-e-commerce-malware-research.pdf) |
| [G1021](/groups/G1021) | [Cinnamon Tempest](/groups/G1021) | [Cinnamon Tempest](/groups/G1021) has used search order hijacking to launch [Cobalt Strike](/software/S0154) Beacons.[[20]](https://www.microsoft.com/en-us/security/blog/2022/05/09/ransomware-as-a-service-understanding-the-cybercrime-gig-economy-and-how-to-protect-yourself/)[[21]](https://www.secureworks.com/research/bronze-starlight-ransomware-operations-use-hui-loader) |
| [S0538](/software/S0538) | [Crutch](/software/S0538) | [Crutch](/software/S0538) can persist via DLL search order hijacking on Google Chrome, Mozilla Firefox, or Microsoft OneDrive.[[22]](https://www.welivesecurity.com/2020/12/02/turla-crutch-keeping-back-door-open/) |
| [S0134](/software/S0134) | [Downdelph](/software/S0134) | [Downdelph](/software/S0134) uses search order hijacking of the Windows executable sysprep.exe to escalate privileges.[[23]](http://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-part3.pdf) |
| [S0363](/software/S0363) | [Empire](/software/S0363) | [Empire](/software/S0363) contains modules that can discover and exploit various DLL hijacking opportunities.[[24]](https://github.com/PowerShellEmpire/Empire) |
| [G0120](/groups/G0120) | [Evilnum](/groups/G0120) | [Evilnum](/groups/G0120) has used the malware variant, TerraTV, to load a malicious DLL placed in the TeamViewer directory, instead of the original Windows DLL located in a system folder.[[25]](https://www.welivesecurity.com/2020/07/09/more-evil-deep-look-evilnum-toolset/) |
| [S0182](/software/S0182) | [FinFisher](/software/S0182) | A [FinFisher](/software/S0182) variant uses DLL search order hijacking.[[26]](https://web.archive.org/web/20171222050934/http%3A//www.finfisher.com/FinFisher/index.html)[[27]](https://securelist.com/blackoasis-apt-and-new-targeted-attacks-leveraging-zero-day-exploit/82732/) |
| [S0661](/software/S0661) | [FoggyWeb](/software/S0661) | [FoggyWeb](/software/S0661)'s loader has used DLL Search Order Hijacking to load malicious code instead of the legitimate `version.dll` during the `Microsoft.IdentityServer.ServiceHost.exe` execution process.[[28]](https://www.microsoft.com/security/blog/2021/09/27/foggyweb-targeted-nobelium-malware-leads-to-persistent-backdoor/) |
| [S0009](/software/S0009) | [Hikit](/software/S0009) | [Hikit](/software/S0009) has used [DLL Search Order Hijacking](/techniques/T1574/001) to load `oci.dll` as a persistence mechanism.[[29]](https://www.fireeye.com/blog/threat-research/2012/08/hikit-rootkit-advanced-persistent-attack-techniques-part-1.html) |
| [S0070](/software/S0070) | [HTTPBrowser](/software/S0070) | [HTTPBrowser](/software/S0070) abuses the Windows DLL load order by using a legitimate Symantec anti-virus binary, VPDN\_LU.exe, to load a malicious DLL that mimics a legitimate Symantec DLL, navlu.dll.[[30]](http://research.zscaler.com/2015/08/chinese-cyber-espionage-apt-group.html) |
| [S1097](/software/S1097) | [HUI Loader](/software/S1097) | [HUI Loader](/software/S1097) can be deployed to targeted systems via legitimate programs that are vulnerable to DLL search order hijacking.[[21]](https://www.secureworks.com/research/bronze-starlight-ransomware-operations-use-hui-loader) |
| [S0260](/software/S0260) | [InvisiMole](/software/S0260) | [InvisiMole](/software/S0260) can be launched by using DLL search order hijacking in which the wrapper DLL is placed in the same folder as explorer.exe and loaded during startup into the Windows Explorer process instead of the legitimate library.[[31]](https://www.welivesecurity.com/2018/06/07/invisimole-equipped-spyware-undercover/) |
| [S0530](/software/S0530) | [Melcoz](/software/S0530) | [Melcoz](/software/S0530) can use DLL hijacking to bypass security controls.[[15]](https://securelist.com/the-tetrade-brazilian-banking-malware/97779/) |
| [G0045](/groups/G0045) | [menuPass](/groups/G0045) | [menuPass](/groups/G0045) has used DLL search order hijacking.[[32]](https://web.archive.org/web/20220224041316/https%3A/www.pwc.co.uk/cyber-security/pdf/cloud-hopper-report-final-v4.pdf) |
| [S0280](/software/S0280) | [MirageFox](/software/S0280) | [MirageFox](/software/S0280) is likely loaded via DLL hijacking into a legitimate McAfee binary.[[33]](https://web.archive.org/web/20180615122133/https%3A//www.intezer.com/miragefox-apt15-resurfaces-with-new-tools-based-on-old-ones/) |
| [S0013](/software/S0013) | [PlugX](/software/S0013) | [PlugX](/software/S0013) has the ability to use DLL search order hijacking for installation on targeted systems.[[34]](https://www.proofpoint.com/us/blog/threat-insight/good-bad-and-web-bug-ta416-increases-operational-tempo-against-european) |
| [S0194](/software/S0194) | [PowerSploit](/software/S0194) | [PowerSploit](/software/S0194) contains a collection of Privesc-PowerUp modules that can discover and exploit DLL hijacking opportunities in services and processes.[[35]](https://github.com/PowerShellMafia/PowerSploit)[[36]](http://powersploit.readthedocs.io) |
| [S0113](/software/S0113) | [Prikormka](/software/S0113) | [Prikormka](/software/S0113) uses DLL search order hijacking for persistence by saving itself as ntshrui.dll to the Windows directory so it will load before the legitimate ntshrui.dll saved in the System32 subdirectory.[[37]](http://www.welivesecurity.com/wp-content/uploads/2016/05/Operation-Groundbait.pdf) |
| [S0458](/software/S0458) | [Ramsay](/software/S0458) | [Ramsay](/software/S0458) can hijack outdated Windows application dependencies with malicious versions of its own DLL payload.[[38]](https://www.welivesecurity.com/2020/05/13/ramsay-cyberespionage-toolkit-airgapped-networks/) |
| [S0153](/software/S0153) | [RedLeaves](/software/S0153) | [RedLeaves](/software/S0153) is launched through use of DLL search order hijacking to load a malicious dll.[[39]](https://www.fireeye.com/blog/threat-research/2017/04/apt10_menupass_grou.html) |
| [G0048](/groups/G0048) | [RTM](/groups/G0048) | [RTM](/groups/G0048) has used search order hijacking to force TeamViewer to load a malicious DLL.[[40]](https://www.group-ib.com/blog/rtm) |
| [G0027](/groups/G0027) | [Threat Group-3390](/groups/G0027) | [Threat Group-3390](/groups/G0027) has performed DLL search order hijacking to execute their payload.[[41]](https://research.nccgroup.com/2018/05/18/emissary-panda-a-potential-new-malicious-tool/) |
| [G0131](/groups/G0131) | [Tonto Team](/groups/G0131) | [Tonto Team](/groups/G0131) abuses a legitimate and signed Microsoft executable to launch a malicious DLL.[[42]](https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/) |
| [S0612](/software/S0612) | [WastedLocker](/software/S0612) | [WastedLocker](/software/S0612) has performed DLL hijacking before execution.[[43]](https://research.nccgroup.com/2020/06/23/wastedlocker-a-new-ransomware-variant-developed-by-the-evil-corp-group/) |
| [S0109](/software/S0109) | [WEBC2](/software/S0109) | Variants of [WEBC2](/software/S0109) achieve persistence by using DLL search order hijacking, usually by copying the DLL file to `%SYSTEMROOT%` (`C:\WINDOWS\ntshrui.dll`).[[44]](https://www.mandiant.com/sites/default/files/2021-09/mandiant-apt1-report.pdf) |
| [G0107](/groups/G0107) | [Whitefly](/groups/G0107) | [Whitefly](/groups/G0107) has used search order hijacking to run the loader Vcrodat.[[45]](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/whitefly-espionage-singapore) |

## Mitigations

| ID | Mitigation | Description |
| --- | --- | --- |
| [M1047](/mitigations/M1047) | [Audit](/mitigations/M1047) | Use auditing tools capable of detecting DLL search order hijacking opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for DLL hijacking weaknesses.[[46]](https://github.com/mattifestation/PowerSploit)  Use the program sxstrace.exe that is included with Windows along with manual inspection to check manifest files for side-by-side problems in software.[[47]](https://docs.microsoft.com/windows-server/administration/windows-commands/sxstrace) |
| [M1038](/mitigations/M1038) | [Execution Prevention](/mitigations/M1038) | Adversaries may use new DLLs to execute this technique. Identify and block potentially malicious software executed through search order hijacking by using application control solutions capable of blocking DLLs loaded by legitimate software. |
| [M1044](/mitigations/M1044) | [Restrict Library Loading](/mitigations/M1044) | Disallow loading of remote DLLs. This is included by default in Windows Server 2012+ and is available by patch for XP+ and Server 2003+.  Enable Safe DLL Search Mode to force search for system DLLs in directories with greater restrictions (e.g. `%SYSTEMROOT%`)to be used before local directory DLLs (e.g. a user's home directory)  The Safe DLL Search Mode can be enabled via Group Policy at Computer Configuration > [Policies] > Administrative Templates > MSS (Legacy): MSS: (SafeDllSearchMode) Enable Safe DLL search mode. The associated Windows Registry key for this is located at `HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\SafeDLLSearchMode`[[48]](https://msrc-blog.microsoft.com/2010/08/23/more-information-about-the-dll-preloading-remote-attack-vector/)[[1]](https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order?redirectedfrom=MSDN) |

## Detection

| ID | Data Source | Data Component | Detects |
| --- | --- | --- | --- |
| [DS0022](/datasources/DS0022) | [File](/datasources/DS0022) | [File Creation](/datasources/DS0022/#File%20Creation) | Monitor newly constructed .manifest and .local redirection files that do not correlate with software updates. |
|  |  | [File Modification](/datasources/DS0022/#File%20Modification) | Monitor for changed made to .manifest/.local redirection files, or file systems for moving, renaming, replacing, or modifying DLLs. Changes in the set of DLLs that are loaded by a process (compared with past behavior) that do not correlate with known software, patches, etc., are suspicious. |
| [DS0011](/datasources/DS0011) | [Module](/datasources/DS0011) | [Module Load](/datasources/DS0011/#Module%20Load) | Monitor DLLs loaded into a process and detect DLLs that have the same file name but abnormal paths. |

## References

1. [Microsoft. (2018, May 31). Dynamic-Link Library Search Order. Retrieved November 30, 2014.](https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order?redirectedfrom=MSDN)
2. [Harbour, N. (2010, July 15). Malware Persistence without the Windows Registry. Retrieved November 17, 2020.](https://www.fireeye.com/blog/threat-research/2010/07/malware-persistence-windows-registry.html)
3. [OWASP. (2013, January 30). Binary planting. Retrieved June 7, 2016.](https://www.owasp.org/index.php/Binary_planting)
4. [Harbour, N. (2011, June 3). What the fxsst?. Retrieved November 17, 2020.](https://www.fireeye.com/blog/threat-research/2011/06/fxsst.html)
5. [Microsoft. (, May 23). Microsoft Security Advisory 2269637. Retrieved March 13, 2020.](https://docs.microsoft.com/en-us/security-updates/securityadvisories/2010/2269637)
6. [Hexacorn. (2013, December 8). Beyond good ol’ Run key, Part 5. Retrieved August 14, 2024.](https://www.hexacorn.com/blog/2013/12/08/beyond-good-ol-run-key-part-5/)
7. [CrowdStrike, Falcon OverWatch Team. (2022, December 30). Retrieved October 19, 2023.](https://www.crowdstrike.com/blog/4-ways-adversaries-hijack-dlls/)
8. [Microsoft. (2018, May 31). Dynamic-Link Library Redirection. Retrieved March 13, 2020.](https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-redirection?redirectedfrom=MSDN)
9. [Microsoft. (n.d.). Manifests. Retrieved December 5, 2014.](https://msdn.microsoft.com/en-US/library/aa375365)
10. [Nick Harbour. (2010, September 1). DLL Search Order Hijacking Revisited. Retrieved March 13, 2020.](https://www.fireeye.com/blog/threat-research/2010/08/dll-search-order-hijacking-revisited.html)
11. [Crowdstrike. (2020, March 2). 2020 Global Threat Report. Retrieved December 11, 2020.](https://go.crowdstrike.com/rs/281-OBQ-266/images/Report2020CrowdStrikeGlobalThreatReport.pdf)
12. [Mike Stokkel et al. (2024, July 18). APT41 Has Arisen From the DUST. Retrieved September 16, 2024.](https://cloud.google.com/blog/topics/threat-intelligence/apt41-arisen-from-dust)
13. [Wiley, B. et al. (2021, December 29). OverWatch Exposes AQUATIC PANDA in Possession of Log4Shell Exploit Tools During Hands-on Intrusion Attempt. Retrieved January 18, 2022.](https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/)
14. [CrowdStrike. (2023). 2022 Falcon OverWatch Threat Hunting Report. Retrieved May 20, 2024.](https://go.crowdstrike.com/rs/281-OBQ-266/images/2022OverWatchThreatHuntingReport.pdf)
15. [GReAT. (2020, July 14). The Tetrade: Brazilian banking malware goes global. Retrieved November 9, 2020.](https://securelist.com/the-tetrade-brazilian-banking-malware/97779/)
16. [Adam Burgher. (2021, June 10). BackdoorDiplomacy: Upgrading from Quarian to Turian. Retrieved September 1, 2021](https://www.welivesecurity.com/2021/06/10/backdoordiplomacy-upgrading-quarian-turian/)
17. [Carr, N, et all. (2019, October 10). Mahalo FIN7: Responding to the Criminal Operators’ New Tools and Techniques. Retrieved October 11, 2019.](https://www.fireeye.com/blog/threat-research/2019/10/mahalo-fin7-responding-to-new-tools-and-techniques.html)
18. [Harbison, M. and Renals, P. (2022, July 5). When Pentest Tools Go Brutal: Red-Teaming Tool Being Abused by Malicious Actors. Retrieved February 1, 2023.](https://unit42.paloaltonetworks.com/brute-ratel-c4-tool/)
19. [Salem, E. (2020, November 17). CHAES: Novel Malware Targeting Latin American E-Commerce. Retrieved June 30, 2021.](https://www.cybereason.com/hubfs/dam/collateral/reports/11-2020-Chaes-e-commerce-malware-research.pdf)
20. [Microsoft. (2022, May 9). Ransomware as a service: Understanding the cybercrime gig economy and how to protect yourself. Retrieved March 10, 2023.](https://www.microsoft.com/en-us/security/blog/2022/05/09/ransomware-as-a-service-understanding-the-cybercrime-gig-economy-and-how-to-protect-yourself/)
21. [Counter Threat Unit Research Team . (2022, June 23). BRONZE STARLIGHT RANSOMWARE OPERATIONS USE HUI LOADER. Retrieved December 7, 2023.](https://www.secureworks.com/research/bronze-starlight-ransomware-operations-use-hui-loader)
22. [Faou, M. (2020, December 2). Turla Crutch: Keeping the “back door” open. Retrieved December 4, 2020.](https://www.welivesecurity.com/2020/12/02/turla-crutch-keeping-back-door-open/)
23. [ESET. (2016, October). En Route with Sednit - Part 3: A Mysterious Downloader. Retrieved November 21, 2016.](http://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-part3.pdf)
24. [Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.](https://github.com/PowerShellEmpire/Empire)

1. [Porolli, M. (2020, July 9). More evil: A deep look at Evilnum and its toolset. Retrieved January 22, 2021.](https://www.welivesecurity.com/2020/07/09/more-evil-deep-look-evilnum-toolset/)
2. [FinFisher. (n.d.). Retrieved September 12, 2024.](https://web.archive.org/web/20171222050934/http%3A//www.finfisher.com/FinFisher/index.html)
3. [Kaspersky Lab's Global Research & Analysis Team. (2017, October 16). BlackOasis APT and new targeted attacks leveraging zero-day exploit. Retrieved February 15, 2018.](https://securelist.com/blackoasis-apt-and-new-targeted-attacks-leveraging-zero-day-exploit/82732/)
4. [Ramin Nafisi. (2021, September 27). FoggyWeb: Targeted NOBELIUM malware leads to persistent backdoor. Retrieved October 4, 2021.](https://www.microsoft.com/security/blog/2021/09/27/foggyweb-targeted-nobelium-malware-leads-to-persistent-backdoor/)
5. [Glyer, C., Kazanciyan, R. (2012, August 20). The “Hikit” Rootkit: Advanced and Persistent Attack Techniques (Part 1). Retrieved June 6, 2016.](https://www.fireeye.com/blog/threat-research/2012/08/hikit-rootkit-advanced-persistent-attack-techniques-part-1.html)
6. [Desai, D.. (2015, August 14). Chinese cyber espionage APT group leveraging recently leaked Hacking Team exploits to target a Financial Services Firm. Retrieved January 26, 2016.](http://research.zscaler.com/2015/08/chinese-cyber-espionage-apt-group.html)
7. [Hromcová, Z. (2018, June 07). InvisiMole: Surprisingly equipped spyware, undercover since 2013. Retrieved July 10, 2018.](https://www.welivesecurity.com/2018/06/07/invisimole-equipped-spyware-undercover/)
8. [PwC and BAE Systems. (2017, April). Operation Cloud Hopper. Retrieved April 5, 2017.](https://web.archive.org/web/20220224041316/https%3A/www.pwc.co.uk/cyber-security/pdf/cloud-hopper-report-final-v4.pdf)
9. [Rosenberg, J. (2018, June 14). MirageFox: APT15 Resurfaces With New Tools Based On Old Ones. Retrieved September 21, 2018.](https://web.archive.org/web/20180615122133/https%3A//www.intezer.com/miragefox-apt15-resurfaces-with-new-tools-based-on-old-ones/)
10. [Raggi, M. et al. (2022, March 7). The Good, the Bad, and the Web Bug: TA416 Increases Operational Tempo Against European Governments as Conflict in Ukraine Escalates. Retrieved March 16, 2022.](https://www.proofpoint.com/us/blog/threat-insight/good-bad-and-web-bug-ta416-increases-operational-tempo-against-european)
11. [PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018.](https://github.com/PowerShellMafia/PowerSploit)
12. [PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018.](http://powersploit.readthedocs.io)
13. [Cherepanov, A.. (2016, May 17). Operation Groundbait: Analysis of a surveillance toolkit. Retrieved May 18, 2016.](http://www.welivesecurity.com/wp-content/uploads/2016/05/Operation-Groundbait.pdf)
14. [Sanmillan, I.. (2020, May 13). Ramsay: A cyber‑espionage toolkit tailored for air‑gapped networks. Retrieved May 27, 2020.](https://www.welivesecurity.com/2020/05/13/ramsay-cyberespionage-toolkit-airgapped-networks/)
15. [FireEye iSIGHT Intelligence. (2017, April 6). APT10 (MenuPass Group): New Tools, Global Campaign Latest Manifestation of Longstanding Threat. Retrieved June 29, 2017.](https://www.fireeye.com/blog/threat-research/2017/04/apt10_menupass_grou.html)
16. [Skulkin, O. (2019, August 5). Following the RTM Forensic examination of a computer infected with a banking trojan. Retrieved May 11, 2020.](https://www.group-ib.com/blog/rtm)
17. [Pantazopoulos, N., Henry T. (2018, May 18). Emissary Panda – A potential new malicious tool. Retrieved June 25, 2018.](https://research.nccgroup.com/2018/05/18/emissary-panda-a-potential-new-malicious-tool/)
18. [Faou, M., Tartare, M., Dupuy, T. (2021, March 10). Exchange servers under siege from at least 10 APT groups. Retrieved May 21, 2021.](https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/)
19. [Antenucci, S., Pantazopoulos, N., Sandee, M. (2020, June 23). WastedLocker: A New Ransomware Variant Developed By The Evil Corp Group. Retrieved September 14, 2021.](https://research.nccgroup.com/2020/06/23/wastedlocker-a-new-ransomware-variant-developed-by-the-evil-corp-group/)
20. [Mandiant. (n.d.). Appendix C (Digital) - The Malware Arsenal. Retrieved July 18, 2016.](https://www.mandiant.com/sites/default/files/2021-09/mandiant-apt1-report.pdf)
21. [Symantec. (2019, March 6). Whitefly: Espionage Group has Singapore in Its Sights. Retrieved May 26, 2020.](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/whitefly-espionage-singapore)
22. [PowerSploit. (n.d.). Retrieved December 4, 2014.](https://github.com/mattifestation/PowerSploit)
23. [Gerend, J. et al.. (2017, October 16). sxstrace. Retrieved April 26, 2021.](https://docs.microsoft.com/windows-server/administration/windows-commands/sxstrace)
24. [Microsoft. (2010, August 12). More information about the DLL Preloading remote attack vector. Retrieved December 5, 2014.](https://msrc-blog.microsoft.com/2010/08/23/more-information-about-the-dll-preloading-remote-attack-vector/)

×

load more results

[![](/theme/images/mitrelogowhiteontrans.gif)](https://www.mitre.org)

[Contact Us](/resources/engage-with-attack/contact)

[Terms of Use](/resources/legal-and-branding/terms-of-use)

[Privacy Policy](/resources/legal-and-branding/privacy)

[Website Changelog](/resources/changelog.html "ATT&CK content v16.1
Website  v4.2.1")

© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.



=== Content from www.kb.cert.org_1218c143_20250119_112959.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#114757

## Acronis backup software contains multiple privilege escalation vulnerabilities

#### Vulnerability Note VU#114757

Original Release Date: 2020-10-12 | Last Revised: 2020-10-12

---

### Overview

Acronis True Image, Cyber Backup, and Cyber Protection all contain privilege escalation vulnerabilities, which can allow an unprivileged Windows user to be able to run arbitrary code with SYSTEM privileges.

### Description

**CVE-2020-10138**

Acronis Cyber Backup 12.5 and Cyber Protect 15 include an OpenSSL component that specifies an `OPENSSLDIR` variable as a subdirectory within `C:\jenkins_agent\`. Acronis Cyber Backup and Cyber Protect contain a privileged service that uses this OpenSSL component. Because unprivileged Windows users can create subdirectories off of the system root, a user can create the appropriate path to a specially-crafted `openssl.cnf` file to achieve arbitrary code execution with SYSTEM privileges.

**CVE-2020-10139**

Acronis True Image 2021 includes an OpenSSL component that specifies an `OPENSSLDIR` variable as a subdirectory within `C:\jenkins_agent\`. Acronis True Image contains a privileged service that uses this OpenSSL component. Because unprivileged Windows users can create subdirectories off of the system root, a user can create the appropriate path to a specially-crafted `openssl.cnf` file to achieve arbitrary code execution with SYSTEM privileges.

**CVE-2020-10140**

Acronis True Image 2021 fails to properly set ACLs of the `C:\ProgramData\Acronis` directory. Because some privileged processes are executed from the `C:\ProgramData\Acronis` directory, an unprivileged user can achieve arbitrary code execution with SYSTEM privileges by placing a DLL in one of several paths within `C:\ProgramData\Acronis`.

### Impact

By placing a specially-crafted `openssl.cnf` or DLL file in a specific location, an unprivileged user may be able to execute arbitrary code with SYSTEM privileges on a Windows system with the vulnerable Acronis software installed. See [DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1574/001/) for more details.

### Solution

#### Apply an update

These vulnerabilities are addressed in Acronis True Image 2021 build 32010 ([release notes](https://www.acronis.com/en-us/support/updates/changes.html?p=42226)), Acronis Cyber Backup 12.5 build 16363 ([release notes](https://dl.managed-protection.com/u/backup/rn/12.5/user/en-US/AcronisBackup12.5_relnotes.htm)), and Acronis Cyber Protect 15 build 24600 ([release notes](https://dl.managed-protection.com/u/cyberprotect/rn/15/user/en-US/AcronisCyberProtect15_relnotes.htm)).

### Acknowledgements

This vulnerability was reported by Will Dormann of the CERT/CC. Acronis also credits HackerOne researchers @adr, @mmg, @vanitas, @xnand with independently discovering and reporting the vulnerabilities.

This document was written by Will Dormann.

### Vendor Information

114757
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

### [Acronis Inc.](#Acronis%20Inc.) Affected

Notified:  2020-09-14
Updated: 2020-10-12

| **CVE-2020-10138** | Affected |
| --- | --- |
| **CVE-2020-10139** | Affected |
| **CVE-2020-10140** | Affected |

#### Vendor Statement

We have not received a statement from the vendor.

### References

* <https://www.acronis.com/en-us/support/updates/changes.html?p=42226>
* <https://dl.managed-protection.com/u/backup/rn/12.5/user/en-US/AcronisBackup12.5_relnotes.htm>
* <https://dl.managed-protection.com/u/cyberprotect/rn/15/user/en-US/AcronisCyberProtect15_relnotes.htm>
* <https://attack.mitre.org/techniques/T1574/001/>

### Other Information

| **CVE IDs:** | [CVE-2020-10138](http://web.nvd.nist.gov/vuln/detail/CVE-2020-10138)  [CVE-2020-10139](http://web.nvd.nist.gov/vuln/detail/CVE-2020-10139)  [CVE-2020-10140](http://web.nvd.nist.gov/vuln/detail/CVE-2020-10140) |
| --- | --- |
| **Date Public:** | 2020-10-12 |
| **Date First Published:** | 2020-10-12 |
| **Date Last Updated:** | 2020-10-12 21:40 UTC |
| **Document Revision:** | 4 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


