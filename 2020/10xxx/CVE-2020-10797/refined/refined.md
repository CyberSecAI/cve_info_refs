Based on the provided information, here's a breakdown of the vulnerability related to CVE-2020-10797:

**Root Cause:**

*   The `diag_ping.php` page in pfSense did not properly validate the hostname parameter, and the output was not encoded.

**Weaknesses/Vulnerabilities:**

*   **Cross-Site Scripting (XSS):** The lack of input validation and output encoding allowed for the injection of arbitrary HTML/JavaScript code into the `diag_ping.php` page.

**Impact of Exploitation:**

*   An attacker could inject malicious scripts that would execute in the context of a user's browser session when they accessed the vulnerable page. This could potentially lead to:
    *   Session hijacking
    *   Defacement of the page
    *   Stealing of sensitive information
    *   Redirecting users to malicious websites

**Attack Vectors:**

*   The vulnerability can be triggered by submitting a crafted hostname value using the `host` parameter to the `diag_ping.php` page.
*   The example provided in the Redmine bug report shows how an attacker can include an `<img>` tag with an `onerror` attribute that would trigger an alert box to demonstrate the XSS:
    ```
    127.0.0.1 <img src='' onerror='alert()'>
    ```

**Required Attacker Capabilities/Position:**

*   The attacker would need to have the ability to submit a crafted hostname to the `diag_ping.php` page. This could be achieved by:
    *  Directly accessing the `diag_ping.php` page and submitting the crafted host.
    *  Tricking a user into clicking a link or submitting a form that contains the malicious code.

**Additional Information:**

*   The fix implemented in commit `cc3990a334059018b004c91eeb66c147d8afe83d` includes both input validation and output encoding to mitigate the vulnerability. The `htmlspecialchars()` function is used to encode the output.
*  The same vulnerability was present in `diag_traceroute.php`, and was fixed by implementing the same input validation and output encoding.
*   The fix was included in pfSense version 2.4.5.

**In summary, CVE-2020-10797 describes a reflected Cross-Site Scripting (XSS) vulnerability in the `diag_ping.php` page of pfSense, which was resolved by adding input validation and output encoding using `htmlspecialchars()` to the affected page, and also to `diag_traceroute.php` for similar reasons.**