Based on the provided information, here's an analysis of CVE-2020-10247:

**Root cause of vulnerability:**
- The vulnerability stems from the sighting popover tool which is used when a user interacts with the thumbs-up or thumbs-down icons associated with an event attribute. The `flexibleAddSighting` function in `misp.js` was passing the attribute `value` without sanitization into the HTML, resulting in a persistent XSS.

**Weaknesses/vulnerabilities present:**
- Persistent Cross-Site Scripting (XSS): Malicious JavaScript code could be injected through the attribute `value` and stored on the server. This code would then execute whenever a user interacted with the sighting popover tool related to the affected attribute.

**Impact of exploitation:**
- An attacker could execute arbitrary JavaScript code in the context of the victim's browser. This could lead to:
    - Session hijacking
    - Defacement of the MISP interface
    - Theft of sensitive information
    - Other malicious actions within the application

**Attack vectors:**
- The attack vector involves crafting a malicious event attribute `value` containing JavaScript code. An attacker could inject malicious code via a custom module or via a direct attribute modification.

**Required attacker capabilities/position:**
- The attacker needs to be an authenticated user with the ability to add or modify event attributes in MISP.
- The attacker has to be able to create or modify events that would then be viewed by other users.

**Technical Details:**
- The vulnerability is located in `app/View/Elements/Events/View/sighting_field.ctp` and `app/webroot/js/misp.js`.
- The fix involves removing the unsanitized attribute value parameter from the `flexibleAddSighting` function call in `misp.js` and sanitizing user supplied input through the use of `h()` in `app/View/Elements/Events/View/sighting_field.ctp`

**Additional Notes:**
- The fix involves a minor adjustment to the `flexibleAddSighting` function by removing the value, as this was not a required parameter.
- The vulnerability was discovered during a pentest conducted by an external company on behalf of the Centre for Cyber Security Belgium (CCB).

The provided content gives more specific detail about the vulnerable code and how the vulnerability was fixed, compared to a standard CVE description. It also highlights the importance of sanitizing user inputs to prevent XSS.