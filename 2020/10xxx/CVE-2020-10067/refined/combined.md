=== Content from zephyrprojectsec.atlassian.net_c9b3c6cf_20250119_115827.html ===


[![Custom Jira logo](/s/g2slup/b/0/7ef7099c0a13ed2deff8ea40bd944e68/_/jira-logo-scaled.png)![Custom Jira icon](/s/g2slup/b/0/7ef7099c0a13ed2deff8ea40bd944e68/_/jira-logo-scaled.png)](/jira)ProjectsFiltersDashboardsAppsCreateSearch[Sign in](/login.jsp)![](https://zephyrprojectsec.atlassian.net/rest/api/2/universal_avatar/view/type/project/avatar/10324?size=xxlarge)
## Zephyr Project Security Issues

Software projectMenu[Reports](/projects/ZEPSEC?selectedItem=com.atlassian.jira.jira-projects-plugin:report-page)[Issues](/jira/software/c/projects/ZEPSEC/issues)[Archived issuesNew](/jira/software/c/projects/ZEPSEC/issues/archive)You're in a company-managed project![Loading...](data:image/svg+xml;base64...)



=== Content from github.com_bdeafebe_20250119_134333.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzephyrproject-rtos%2Fzephyr%2Fpull%2F25089)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzephyrproject-rtos%2Fzephyr%2Fpull%2F25089)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=zephyrproject-rtos%2Fzephyr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[zephyrproject-rtos](/zephyrproject-rtos)
/
**[zephyr](/zephyrproject-rtos/zephyr)**
Public

* [Notifications](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr) You must be signed in to change notification settings
* [Fork
  6.8k](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr)
* [Star
   11.3k](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr)

* [Code](/zephyrproject-rtos/zephyr)
* [Issues
  1.9k](/zephyrproject-rtos/zephyr/issues)
* [Pull requests
  863](/zephyrproject-rtos/zephyr/pulls)
* [Discussions](/zephyrproject-rtos/zephyr/discussions)
* [Actions](/zephyrproject-rtos/zephyr/actions)
* [Projects
  20](/zephyrproject-rtos/zephyr/projects)
* [Wiki](/zephyrproject-rtos/zephyr/wiki)
* [Security](/zephyrproject-rtos/zephyr/security)
* [Insights](/zephyrproject-rtos/zephyr/pulse)

Additional navigation options

* [Code](/zephyrproject-rtos/zephyr)
* [Issues](/zephyrproject-rtos/zephyr/issues)
* [Pull requests](/zephyrproject-rtos/zephyr/pulls)
* [Discussions](/zephyrproject-rtos/zephyr/discussions)
* [Actions](/zephyrproject-rtos/zephyr/actions)
* [Projects](/zephyrproject-rtos/zephyr/projects)
* [Wiki](/zephyrproject-rtos/zephyr/wiki)
* [Security](/zephyrproject-rtos/zephyr/security)
* [Insights](/zephyrproject-rtos/zephyr/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fzephyrproject-rtos%2Fzephyr%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [Backport v1.14-branch] Bluetooth: Fix NULL pointer dereference when bt\_send() fails #25089

 Merged

[nashif](/nashif)
merged 1 commit into
[zephyrproject-rtos:v1.14-branch](/zephyrproject-rtos/zephyr/tree/v1.14-branch "zephyrproject-rtos/zephyr:v1.14-branch")
from
[jhedberg:1.14](/jhedberg/zephyr/tree/1.14 "jhedberg/zephyr:1.14")

Jul 8, 2020

 Merged

# [[Backport v1.14-branch] Bluetooth: Fix NULL pointer dereference when bt\_send() fails](#top) #25089

[nashif](/nashif)
merged 1 commit into
[zephyrproject-rtos:v1.14-branch](/zephyrproject-rtos/zephyr/tree/v1.14-branch "zephyrproject-rtos/zephyr:v1.14-branch")
from
[jhedberg:1.14](/jhedberg/zephyr/tree/1.14 "jhedberg/zephyr:1.14")

Jul 8, 2020

[Conversation
1](/zephyrproject-rtos/zephyr/pull/25089)
[Commits
1](/zephyrproject-rtos/zephyr/pull/25089/commits)
[Checks
0](/zephyrproject-rtos/zephyr/pull/25089/checks)
[Files changed](/zephyrproject-rtos/zephyr/pull/25089/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![jhedberg](https://avatars.githubusercontent.com/u/1032570?s=60&v=4)](/jhedberg)

Copy link

Member

### @jhedberg **[jhedberg](/jhedberg)** commented [May 7, 2020](#issue-614197520)

Backport [#24902](https://github.com/zephyrproject-rtos/zephyr/pull/24902)

Sorry, something went wrong.

All reactions

`[Bluetooth: Fix NULL pointer dereference when bt_send() fails](/zephyrproject-rtos/zephyr/pull/25089/commits/78b91674c63b88438c9595860f1b6a81857ec98e "Bluetooth: Fix NULL pointer dereference when bt_send() fails

The last parameter to hci_cmd_done() is expected to be a valid net_buf
since the function immediately tries to dereference it. Fix this by
passing the appropriate buffer reference to the function.

Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>")`
 …

`[78b9167](/zephyrproject-rtos/zephyr/pull/25089/commits/78b91674c63b88438c9595860f1b6a81857ec98e)`

```
The last parameter to hci_cmd_done() is expected to be a valid net_buf
since the function immediately tries to dereference it. Fix this by
passing the appropriate buffer reference to the function.

Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>
```

 [![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=40&u=51d2beb44c5156d2b7fa53c67c18692eef1e0d12&v=4)](/jhedberg)
[jhedberg](/jhedberg)
requested review from
[d3zd3z](/d3zd3z),
[ceolin](/ceolin) and
[carlescufi](/carlescufi)
[May 7, 2020 16:43](#event-3313750250)

 [![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=40&u=51d2beb44c5156d2b7fa53c67c18692eef1e0d12&v=4)](/jhedberg)
[jhedberg](/jhedberg)
requested review from
[sjanc](/sjanc) and
[Vudentz](/Vudentz)
as [code owners](/zephyrproject-rtos/zephyr/blob/035ab2bb72f627422a055380b609d9b1cb5eeaa5/CODEOWNERS#L262)
[May 7, 2020 16:43](#event-3313750254)

 [![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=40&u=51d2beb44c5156d2b7fa53c67c18692eef1e0d12&v=4)](/jhedberg)
[jhedberg](/jhedberg)
requested a review
from [nashif](/nashif)
[May 7, 2020 16:44](#event-3313751724)

[![carlescufi](https://avatars.githubusercontent.com/u/12450381?s=60&v=4)](/carlescufi)

**[carlescufi](/carlescufi)**
approved these changes
[May 7, 2020](#pullrequestreview-407652550)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/25089/files/78b91674c63b88438c9595860f1b6a81857ec98e)

[![@zephyrbot](https://avatars.githubusercontent.com/u/26360365?s=40&u=5c66ab67f5b0043f574103fa4f319a1ab3abd29e&v=4)](/zephyrbot)
[zephyrbot](/zephyrbot)
added
the
[area: Bluetooth](/zephyrproject-rtos/zephyr/labels/area%3A%20Bluetooth)
label
[May 7, 2020](#event-3313755536)

[![d3zd3z](https://avatars.githubusercontent.com/u/90349?s=60&v=4)](/d3zd3z)

**[d3zd3z](/d3zd3z)**
approved these changes
[May 7, 2020](#pullrequestreview-407686677)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/25089/files/78b91674c63b88438c9595860f1b6a81857ec98e)

[![ceolin](https://avatars.githubusercontent.com/u/882919?s=60&v=4)](/ceolin)

**[ceolin](/ceolin)**
approved these changes
[May 8, 2020](#pullrequestreview-408383658)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/25089/files/78b91674c63b88438c9595860f1b6a81857ec98e)

[![@d3zd3z](https://avatars.githubusercontent.com/u/90349?s=40&u=3c272746f5095c46cd68ac40875a07ab86815f0b&v=4)](/d3zd3z)
[d3zd3z](/d3zd3z)
added
the
[backport v1.14-branch](/zephyrproject-rtos/zephyr/labels/backport%20v1.14-branch)
label
[May 8, 2020](#event-3317965675)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)

Copy link

### **[github-actions](/apps/github-actions) bot** commented [Jul 8, 2020](#issuecomment-655212479)

| This pull request has been marked as stale because it has been open (more than) 60 days with no activity. Remove the stale label or add a comment saying that you would like to have the label removed otherwise this pull request will automatically be closed in 14 days. Note, that you can always re-open a closed pull request at any time. |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added
the
[Stale](/zephyrproject-rtos/zephyr/labels/Stale)
label
[Jul 8, 2020](#event-3522858103)

[![@nashif](https://avatars.githubusercontent.com/u/180017?s=40&u=5ff97075d41b30bcc3d0fcfc35020fe9238cf5d9&v=4)](/nashif)
[nashif](/nashif)
merged commit [`1e03a06`](/zephyrproject-rtos/zephyr/commit/1e03a062bd828896e06cf070f8b92b10fb226b69)
into
zephyrproject-rtos:v1.14-branch

[Jul 8, 2020](https://github.com/zephyrproject-rtos/zephyr/pull/25089#event-3524688999)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fzephyrproject-rtos%2Fzephyr%2Fpull%2F25089)

Reviewers

[![@carlescufi](https://avatars.githubusercontent.com/u/12450381?s=40&v=4)](/carlescufi) [carlescufi](/carlescufi)

carlescufi approved these changes

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&v=4)](/ceolin) [ceolin](/ceolin)

ceolin approved these changes

[![@d3zd3z](https://avatars.githubusercontent.com/u/90349?s=40&v=4)](/d3zd3z) [d3zd3z](/d3zd3z)

d3zd3z approved these changes

[![@sjanc](https://avatars.githubusercontent.com/u/10303625?s=40&v=4)](/sjanc) [sjanc](/sjanc)

 Awaiting requested review from sjanc

 sjanc is a code owner

[![@Vudentz](https://avatars.githubusercontent.com/u/2156363?s=40&v=4)](/Vudentz) [Vudentz](/Vudentz)

 Awaiting requested review from Vudentz

 Vudentz is a code owner

[![@nashif](https://avatars.githubusercontent.com/u/180017?s=40&v=4)](/nashif) [nashif](/nashif)

 Awaiting requested review from nashif

Assignees

No one assigned

Labels

[area: Bluetooth](/zephyrproject-rtos/zephyr/labels/area%3A%20Bluetooth)
[Stale](/zephyrproject-rtos/zephyr/labels/Stale)

Projects

[Backports](/orgs/zephyrproject-rtos/projects/32)
Status: Done

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

6 participants

[![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=52&v=4)](/jhedberg) [![@d3zd3z](https://avatars.githubusercontent.com/u/90349?s=52&v=4)](/d3zd3z) [![@ceolin](https://avatars.githubusercontent.com/u/882919?s=52&v=4)](/ceolin) [![@carlescufi](https://avatars.githubusercontent.com/u/12450381?s=52&v=4)](/carlescufi) [![@nashif](https://avatars.githubusercontent.com/u/180017?s=52&v=4)](/nashif) [![@zephyrbot](https://avatars.githubusercontent.com/u/26360365?s=52&v=4)](/zephyrbot)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a8d48e87_20250119_115823.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzephyrproject-rtos%2Fzephyr%2Fpull%2F23239)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzephyrproject-rtos%2Fzephyr%2Fpull%2F23239)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=zephyrproject-rtos%2Fzephyr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[zephyrproject-rtos](/zephyrproject-rtos)
/
**[zephyr](/zephyrproject-rtos/zephyr)**
Public

* [Notifications](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr) You must be signed in to change notification settings
* [Fork
  6.8k](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr)
* [Star
   11.3k](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr)

* [Code](/zephyrproject-rtos/zephyr)
* [Issues
  1.9k](/zephyrproject-rtos/zephyr/issues)
* [Pull requests
  862](/zephyrproject-rtos/zephyr/pulls)
* [Discussions](/zephyrproject-rtos/zephyr/discussions)
* [Actions](/zephyrproject-rtos/zephyr/actions)
* [Projects
  20](/zephyrproject-rtos/zephyr/projects)
* [Wiki](/zephyrproject-rtos/zephyr/wiki)
* [Security](/zephyrproject-rtos/zephyr/security)
* [Insights](/zephyrproject-rtos/zephyr/pulse)

Additional navigation options

* [Code](/zephyrproject-rtos/zephyr)
* [Issues](/zephyrproject-rtos/zephyr/issues)
* [Pull requests](/zephyrproject-rtos/zephyr/pulls)
* [Discussions](/zephyrproject-rtos/zephyr/discussions)
* [Actions](/zephyrproject-rtos/zephyr/actions)
* [Projects](/zephyrproject-rtos/zephyr/projects)
* [Wiki](/zephyrproject-rtos/zephyr/wiki)
* [Security](/zephyrproject-rtos/zephyr/security)
* [Insights](/zephyrproject-rtos/zephyr/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fzephyrproject-rtos%2Fzephyr%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# syscalls: arm: Fix possible overflow in is\_in\_region function #23239

 Merged

[jhedberg](/jhedberg)
merged 2 commits into
[zephyrproject-rtos:master](/zephyrproject-rtos/zephyr/tree/master "zephyrproject-rtos/zephyr:master")
from
[ceolin:syscalls](/ceolin/zephyr/tree/syscalls "ceolin/zephyr:syscalls")

Mar 7, 2020

 Merged

# [syscalls: arm: Fix possible overflow in is\_in\_region function](#top) #23239

[jhedberg](/jhedberg)
merged 2 commits into
[zephyrproject-rtos:master](/zephyrproject-rtos/zephyr/tree/master "zephyrproject-rtos/zephyr:master")
from
[ceolin:syscalls](/ceolin/zephyr/tree/syscalls "ceolin/zephyr:syscalls")

Mar 7, 2020

[Conversation
35](/zephyrproject-rtos/zephyr/pull/23239)
[Commits
2](/zephyrproject-rtos/zephyr/pull/23239/commits)
[Checks
0](/zephyrproject-rtos/zephyr/pull/23239/checks)
[Files changed](/zephyrproject-rtos/zephyr/pull/23239/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ceolin](https://avatars.githubusercontent.com/u/882919?s=60&v=4)](/ceolin)

Copy link

Member

### @ceolin **[ceolin](/ceolin)** commented [Mar 3, 2020](#issue-575004416)

This function is widely used by functions that validate memory

buffers. Macros used to check permissions, like Z\_SYSCALL\_MEMORY\_READ

and Z\_SYSCALL\_MEMORY\_WRITE, use these functions to check that a

pointers passed by user threads in a syscall.

Signed-off-by: Flavio Ceolin flavio.ceolin@intel.com

Sorry, something went wrong.

All reactions

 [![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
requested review from
[d3zd3z](/d3zd3z),
[jhedberg](/jhedberg),
[ioannisg](/ioannisg) and
[andrewboie](/andrewboie)
[March 3, 2020 22:42](#event-3094192100)

 [![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
requested review from
[galak](/galak) and
[MaureenHelm](/MaureenHelm)
as [code owners](/zephyrproject-rtos/zephyr/blob/de3c5ae9ff766ddade706aacc96986548b3e98ff/CODEOWNERS#L20)
[March 3, 2020 22:42](#event-3094192112)

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
added
the
[priority: high](/zephyrproject-rtos/zephyr/labels/priority%3A%20high)
High impact/importance bug
label
[Mar 3, 2020](#event-3094195815)

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
added this to the [v2.2.0](/zephyrproject-rtos/zephyr/milestone/40) milestone
[Mar 3, 2020](#event-3094196343)

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
added
the
[area: Security](/zephyrproject-rtos/zephyr/labels/area%3A%20Security)
Security
label
[Mar 3, 2020](#event-3094200432)

[![@zephyrbot](https://avatars.githubusercontent.com/u/26360365?s=40&u=5c66ab67f5b0043f574103fa4f319a1ab3abd29e&v=4)](/zephyrbot)
[zephyrbot](/zephyrbot)
added
the
[area: ARM](/zephyrproject-rtos/zephyr/labels/area%3A%20ARM)
ARM (32-bit) Architecture
label
[Mar 3, 2020](#event-3094218935)

[![stephanosio](https://avatars.githubusercontent.com/u/11345418?s=60&v=4)](/stephanosio)

**[stephanosio](/stephanosio)**
reviewed
[Mar 3, 2020](#pullrequestreview-368412599)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/23239/files)

[arch/arm/core/aarch32/cortex\_m/mpu/arm\_mpu\_v7\_internal.h](/zephyrproject-rtos/zephyr/pull/23239/files#diff-8793694cce90fcc82271e0ef4a2c06e10908f639a2b14e54021ed22c88fe45db)
Outdated

Show resolved

Hide resolved

[![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=80&u=51d2beb44c5156d2b7fa53c67c18692eef1e0d12&v=4)](/jhedberg)

Copy link

Member

### **[jhedberg](/jhedberg)** commented [Mar 4, 2020](#issuecomment-594449673)

| [@ceolin](https://github.com/ceolin) I've restarted Shippable a few times, but still keeps failing - is it because of something in this PR? |
| --- |

All reactions

Sorry, something went wrong.

[![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=80&u=51d2beb44c5156d2b7fa53c67c18692eef1e0d12&v=4)](/jhedberg)

Copy link

Member

### **[jhedberg](/jhedberg)** commented [Mar 4, 2020](#issuecomment-594456068)

| [@ceolin](https://github.com/ceolin) I've restarted Shippable a few times, but still keeps failing - is it because of something in this PR?  Answering myself: seems like it is:  ``` INFO    - /home/buildslave/src/github.com/zephyrproject-rtos/zephyr/sanity-out/mps2_an385/tests/kernel/pipe/pipe/kernel.pipe/handler.log ERROR   - *** Booting Zephyr OS build v2.2.0-rc3-25-g426ddd95ee73  *** Running test suite test_pipe =================================================================== starting test - test_pipe_on_single_elements E: syscall z_vrfy_k_pipe_put failed check: Memory region 0x200001c1 (size 0) read access denied E: r0/a1:  0x00000000  r1/a2:  0x00000000  r2/a3:  0x00000000 E: r3/a4:  0x00000000 r12/ip:  0x00000000 r14/lr:  0x00000000 E:  xpsr:  0x00000000 E: Faulting instruction address (r15/pc): 0x00000000 E: >>> ZEPHYR FATAL ERROR 3: Kernel oops on CPU 0 E: Current thread: 0x200005d8 (unknown) Caught system error -- reason 3  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=80&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)

Copy link

Member

Author

### **[ceolin](/ceolin)** commented [Mar 4, 2020](#issuecomment-594638145) • edited Loading

| [@jhedberg](https://github.com/jhedberg) there are two issues that we need to figure out how to handle   1. There is one pipe tests that pass a 0 data buffer. Is it valid ? 0 data buffer was causing and underflow and magically going to implementation function. I can put a new test in the verification function to return 0 in that situation and not going to check the memory buffer 2. poll test is failing for the same problem, one test with 0 events. Same thing the issue above, but here is more confuse because of the expected behavior, currently with 0 elements it returns EAGAIN when timeout expires, what is not possible to do in the verification function. I could return -EINVAL (that looks the right thing), but then the test will look really weird, because when the test executes from supervisor thread it will return -EAGAIN and when it runs from user thread will return -EINVAL.   any thoughts ? |
| --- |

All reactions

Sorry, something went wrong.

[![ioannisg](https://avatars.githubusercontent.com/u/2333931?s=60&v=4)](/ioannisg)

**[ioannisg](/ioannisg)**
reviewed
[Mar 4, 2020](#pullrequestreview-368934498)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/23239/files)

[arch/arm/core/aarch32/cortex\_m/mpu/arm\_mpu\_v7\_internal.h](/zephyrproject-rtos/zephyr/pull/23239/files#diff-8793694cce90fcc82271e0ef4a2c06e10908f639a2b14e54021ed22c88fe45db)
Outdated

Show resolved

Hide resolved

[![ioannisg](https://avatars.githubusercontent.com/u/2333931?s=60&v=4)](/ioannisg)

**[ioannisg](/ioannisg)**
reviewed
[Mar 4, 2020](#pullrequestreview-368934740)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/23239/files)

[arch/arm/core/aarch32/cortex\_m/mpu/arm\_mpu\_v7\_internal.h](/zephyrproject-rtos/zephyr/pull/23239/files#diff-8793694cce90fcc82271e0ef4a2c06e10908f639a2b14e54021ed22c88fe45db)
Outdated

|  |  | return 0; |
| --- | --- | --- |
|  |  | } |
|  |  |  |
|  |  | if (start >= r\_addr\_start && end <= r\_addr\_end) { |

Copy link

Member

### @ioannisg **[ioannisg](/ioannisg)** [Mar 4, 2020](#discussion_r387787383)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

here, too

Sorry, something went wrong.

All reactions

Copy link

Member

### @ioannisg **[ioannisg](/ioannisg)** [Mar 4, 2020](#discussion_r387787502)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

and i the nxp\_mpu.c

Sorry, something went wrong.

All reactions

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=80&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)

Copy link

Member

Author

### **[ceolin](/ceolin)** commented [Mar 4, 2020](#issuecomment-594747530)

| [@jhedberg](https://github.com/jhedberg) there are two issues that we need to figure out how to handle   1. There is one pipe tests that pass a 0 data buffer. Is it valid ? 0 data buffer was causing and underflow and magically going to implementation function. I can put a new test in the verification function to return 0 in that situation and not going to check the memory buffer 2. poll test is failing for the same problem, one test with 0 events. Same thing the issue above, but here is more confuse because of the expected behavior, currently with 0 elements it returns EAGAIN when timeout expires, what is not possible to do in the verification function. I could return -EINVAL (that looks the right thing), but then the test will look really weird, because when the test executes from supervisor thread it will return -EAGAIN and when it runs from user thread will return -EINVAL.   any thoughts ?  [@andyross](https://github.com/andyross) [@andrewboie](https://github.com/andrewboie) ideas ? |
| --- |

All reactions

Sorry, something went wrong.

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
changed the title
~~wsyscalls: arm: Fix possible overflow in is\_in\_region function~~
syscalls: arm: Fix possible overflow in is\_in\_region function
[Mar 4, 2020](#event-3098512553)

 [![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
requested review from
[andyross](/andyross) and
[andrewboie](/andrewboie)
and removed request for
[andrewboie](/andrewboie)
[March 4, 2020 23:43](#event-3099076819)

[![ioannisg](https://avatars.githubusercontent.com/u/2333931?s=60&v=4)](/ioannisg)

**[ioannisg](/ioannisg)**
reviewed
[Mar 5, 2020](#pullrequestreview-369350638)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/23239/files)

[arch/arm/core/aarch32/cortex\_m/mpu/arm\_mpu\_v7\_internal.h](/zephyrproject-rtos/zephyr/pull/23239/files#diff-8793694cce90fcc82271e0ef4a2c06e10908f639a2b14e54021ed22c88fe45db)
Outdated

|  |  | @@ -216,7 +217,11 @@ static inline int is\_in\_region(u32\_t r\_index, u32\_t start, u32\_t size) | |
| --- | --- | --- | --- |
|  |  | MPU\_RASR\_SIZE\_Pos) + 1; |
|  |  | r\_addr\_end = r\_addr\_start + (1UL << r\_size\_lshift) - 1; |
|  |  |  |
|  |  | if (start >= r\_addr\_start && (start + size - 1) <= r\_addr\_end) { |
|  |  | if (size == 0 || \_\_builtin\_add\_overflow(start, size - 1, &end)) { |

Copy link

Member

### @ioannisg **[ioannisg](/ioannisg)** [Mar 5, 2020](#discussion_r388123357) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Also, if you want the function to return false when size is zero, I believe this needs to be documented.

Furthermore, I think the case of zero "size", should be better checked at the caller function, mpu\_buffer\_validate, or even documented as a non-allowed input in the common arch interface API, arch\_buffer\_validate. [@andrewboie](https://github.com/andrewboie) what do you think?

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @ceolin **[ceolin](/ceolin)** [Mar 5, 2020](#discussion_r388371841)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

yeah, that is weird, but I believe x86 works same way, I'll change the pr to allows size 0, what means just check whether or not the buffer address is in the given region. This will fix the problem and keeps the current behavior

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @ceolin **[ceolin](/ceolin)** [Mar 5, 2020](#discussion_r388373104)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

whether or not allow size 0 can be addressed / discussed later to no block the release, since it seems not to be a bug. The questions regarding poll and pipe behavior are still open IMHO.

Sorry, something went wrong.

All reactions

`[syscalls: arm: Fix possible overflow in is_in_region function](/zephyrproject-rtos/zephyr/pull/23239/commits/c892fd31ee821691f48c227dacdd1a1a594f312d "syscalls: arm: Fix possible overflow in is_in_region function

This function is widely used by functions that validate memory
buffers. Macros used to check permissions, like Z_SYSCALL_MEMORY_READ
and Z_SYSCALL_MEMORY_WRITE, use these functions to check that a
pointers passed by user threads in a syscall.

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>")`
 …

`[c892fd3](/zephyrproject-rtos/zephyr/pull/23239/commits/c892fd31ee821691f48c227dacdd1a1a594f312d)`

```
This function is widely used by functions that validate memory
buffers. Macros used to check permissions, like Z_SYSCALL_MEMORY_READ
and Z_SYSCALL_MEMORY_WRITE, use these functions to check that a
pointers passed by user threads in a syscall.

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>
```

 [![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
[force-pushed](/zephyrproject-rtos/zephyr/compare/94a713adc2d4c94db3e0fcca3aa9a40a9d809a7d..c892fd31ee821691f48c227dacdd1a1a594f312d)
the
syscalls

branch
from
[`94a713a`](/zephyrproject-rtos/zephyr/commit/94a713adc2d4c94db3e0fcca3aa9a40a9d809a7d) to
[`c892fd3`](/zephyrproject-rtos/zephyr/commit/c892fd31ee821691f48c227dacdd1a1a594f312d)  [Compare](/zephyrproject-rtos/zephyr/compare/94a713adc2d4c94db3e0fcca3aa9a40a9d809a7d..c892fd31ee821691f48c227dacdd1a1a594f312d)
[March 5, 2020 15:33](#event-3101711790)

[![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=80&u=51d2beb44c5156d2b7fa53c67c18692eef1e0d12&v=4)](/jhedberg)

Copy link

Member

### **[jhedberg](/jhedberg)** commented [Mar 5, 2020](#issuecomment-595478651)

| [@ioannisg](https://github.com/ioannisg) [@stephanosio](https://github.com/stephanosio) are you guys ok with the latest version of this PR? I'd like some more reviews than just my own before merging. |
| --- |

All reactions

Sorry, something went wrong.

[![jhedberg](https://avatars.githubusercontent.com/u/1032570?s=60&v=4)](/jhedberg)

**[jhedberg](/jhedberg)**
approved these changes
[Mar 5, 2020](#pullrequestreview-369960119)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/23239/files/c892fd31ee821691f48c227dacdd1a1a594f312d)

[![@ioannisg](https://avatars.githubusercontent.com/u/2333931?s=80&u=f3712df0fbfac2ef5ffe7cb4e57e4c05bbceda94&v=4)](/ioannisg)

Copy link

Member

### **[ioannisg](/ioannisg)** commented [Mar 5, 2020](#issuecomment-595478912)

| [@ioannisg](https://github.com/ioannisg) [@stephanosio](https://github.com/stephanosio) are you guys ok with the latest version of this PR? I'd like some more reviews than just my own before merging.  Will check this again early tomorrow morning [@jhedberg](https://github.com/jhedberg) |
| --- |

All reactions

Sorry, something went wrong.

[![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=80&u=51d2beb44c5156d2b7fa53c67c18692eef1e0d12&v=4)](/jhedberg)

Copy link

Member

### **[jhedberg](/jhedberg)** commented [Mar 6, 2020](#issuecomment-595743581)

| Will check this again early tomorrow morning [@jhedberg](https://github.com/jhedberg)  [@ioannisg](https://github.com/ioannisg) any update on this? |
| --- |

All reactions

Sorry, something went wrong.

[![ioannisg](https://avatars.githubusercontent.com/u/2333931?s=60&v=4)](/ioannisg)

**[ioannisg](/ioannisg)**
reviewed
[Mar 6, 2020](#pullrequestreview-370418465)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/23239/files/c892fd31ee821691f48c227dacdd1a1a594f312d)

Copy link

Member

### @ioannisg **[ioannisg](/ioannisg)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

[@ceolin](https://github.com/ceolin) correct me if I am wrong, but now, it seems that supplying a zero sized buffer will result in the function returning true.This is a change compared to the original behavior, so I wonder if we need that.

could this PR just fix the overflow issue?

Sorry, something went wrong.

All reactions

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=80&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)

Copy link

Member

Author

### **[ceolin](/ceolin)** commented [Mar 6, 2020](#issuecomment-595872094) • edited Loading

| [@ceolin](https://github.com/ceolin) correct me if I am wrong, but now, it seems that supplying a zero sized buffer will result in the function returning true.This is a change compared to the original behavior, so I wonder if we need that. could this PR just fix the overflow issue?  We were wrongly accepting size 0. `if (start >= r_addr_start && (start + size - 1) <= r_addr_end)` as you can see, the second condition will always be true for size == 0  Now, at least we are not comparing an address out of the "valid" range. My initial patch was not accepting size == 0 but then it broke some tests and the behavior was different from X86. My suggestion is merge it and fix the problems and then we can decide whether or not accept 0 size buffers, this will apply to X86 and ARC as well. |
| --- |

All reactions

Sorry, something went wrong.

3 hidden items

Load more…

[![@andrewboie](https://avatars.githubusercontent.com/u/3387369?s=80&u=39259b294046ea22cb384fb978d360a7cafe7a76&v=4)](/andrewboie)

Copy link

Contributor

### **[andrewboie](/andrewboie)** commented [Mar 6, 2020](#issuecomment-595882375)

| it depends on syscall, poll for example seems to return when the timeout expires, without anything valid, pipe just return 0  I understand the behavior, but not the semantics. Why is the test passing a 0 buffer in the first place? What is it testing? |
| --- |

All reactions

Sorry, something went wrong.

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=80&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)

Copy link

Member

Author

### **[ceolin](/ceolin)** commented [Mar 6, 2020](#issuecomment-595883340)

| it depends on syscall, poll for example seems to return when the timeout expires, without anything valid, pipe just return 0  I understand the behavior, but not the semantics. Why is the test passing a 0 buffer in the first place? What is it testing?  The test is testing this corner case what is valid. It is a boundary that has to be tested, the problem is if we reject 0 size buffer at memory access level we trigger an exception what the tests and APIs don't expect |
| --- |

All reactions

Sorry, something went wrong.

[![@andrewboie](https://avatars.githubusercontent.com/u/3387369?s=80&u=39259b294046ea22cb384fb978d360a7cafe7a76&v=4)](/andrewboie)

Copy link

Contributor

### **[andrewboie](/andrewboie)** commented [Mar 6, 2020](#issuecomment-595884945)

| The test is testing this corner case what is valid. It is a boundary that has to be tested, the problem is if we reject 0 size buffer at memory access level we trigger an exception what the tests and APIs don't expect  So is a 0 size buffer valid or not? |
| --- |

All reactions

Sorry, something went wrong.

[![@andrewboie](https://avatars.githubusercontent.com/u/3387369?s=80&u=39259b294046ea22cb384fb978d360a7cafe7a76&v=4)](/andrewboie)

Copy link

Contributor

### **[andrewboie](/andrewboie)** commented [Mar 6, 2020](#issuecomment-595885068)

| And what does it mean to call these APIs with a 0 size buffer? |
| --- |

All reactions

Sorry, something went wrong.

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=80&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)

Copy link

Member

Author

### **[ceolin](/ceolin)** commented [Mar 6, 2020](#issuecomment-595894842) • edited Loading

| The test is testing this corner case what is valid. It is a boundary that has to be tested, the problem is if we reject 0 size buffer at memory access level we trigger an exception what the tests and APIs don't expect  So is a 0 size buffer valid or not?  That is the trick part, currently it is, but not explicitly. Regarding the second question, the meaning is per basis API. Take a look in `k_pipe_put`  ``` /**  * @brief Write data to a pipe.  *  * This routine writes up to @a bytes_to_write bytes of data to @a pipe.  *  * @param pipe Address of the pipe.  * @param data Address of data to write.  * @param bytes_to_write Size of data (in bytes).  * @param bytes_written Address of area to hold the number of bytes written.  * @param min_xfer Minimum number of bytes to write.  * @param timeout Non-negative waiting period to wait for the data to be written  *                (in milliseconds), or one of the special values K_NO_WAIT  *                and K_FOREVER.  *  * @retval 0 At least @a min_xfer bytes of data were written.  * @retval -EIO Returned without waiting; zero data bytes were written.  * @retval -EAGAIN Waiting period timed out; between zero and @a min_xfer  *                 minus one data bytes were written.  * @req K-PIPE-002  */  ```  According with it, if `bytes_to_write` and `min_xfer` are 0 this function should return 0, what is valid. The test is testing it. This one is easy because we can't test for this case before testing the memory access, but poll is more complicate, because it accepts 0 events and just return when the timeout is reached. |
| --- |

All reactions

Sorry, something went wrong.

[![@andrewboie](https://avatars.githubusercontent.com/u/3387369?s=80&u=39259b294046ea22cb384fb978d360a7cafe7a76&v=4)](/andrewboie)

Copy link

Contributor

### **[andrewboie](/andrewboie)** commented [Mar 6, 2020](#issuecomment-595898155)

| I see. Maybe for footprint/performance reasons we should leave (and document in the header) that arch\_buffer\_validate() on a 0-sized region is undefined behavior, and for these particular syscalls add explicit checks. What do you think? We can contemplate this for another PR. Regardless of what we decide, the API docs should be updated. |
| --- |

All reactions

Sorry, something went wrong.

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=80&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)

Copy link

Member

Author

### **[ceolin](/ceolin)** commented [Mar 6, 2020](#issuecomment-595920448)

| I see. Maybe for footprint/performance reasons we should leave (and document in the header) that arch\_buffer\_validate() on a 0-sized region is undefined behavior, and for these particular syscalls add explicit checks. What do you think? We can contemplate this for another PR. Regardless of what we decide, the API docs should be updated.  Agree. Further we can have the initial patch that invalidates 0 size buffers and properly fix APIs.  Do you want me to update this commit with that info ? |
| --- |

All reactions

Sorry, something went wrong.

[![@ioannisg](https://avatars.githubusercontent.com/u/2333931?s=80&u=f3712df0fbfac2ef5ffe7cb4e57e4c05bbceda94&v=4)](/ioannisg)

Copy link

Member

### **[ioannisg](/ioannisg)** commented [Mar 6, 2020](#issuecomment-595987743)

| [@andrewboie](https://github.com/andrewboie) [@ceolin](https://github.com/ceolin) I would like us to update the API and agree on the behavior when the passed size is zero before merging this PR, since this is an essential part of the patch. Ideally, I would like the test-cases and the doc-fix to come within this PR :) |
| --- |

All reactions

Sorry, something went wrong.

[![ioannisg](https://avatars.githubusercontent.com/u/2333931?s=60&v=4)](/ioannisg)

**[ioannisg](/ioannisg)**
reviewed
[Mar 6, 2020](#pullrequestreview-370660674)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/23239/files/c892fd31ee821691f48c227dacdd1a1a594f312d)

Copy link

Member

### @ioannisg **[ioannisg](/ioannisg)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Please, submit also the fix for API documentation, as well as a test that covers this corner case of zero size.

Sorry, something went wrong.

All reactions

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=80&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)

Copy link

Member

Author

### **[ceolin](/ceolin)** commented [Mar 6, 2020](#issuecomment-595989787)

| Please, submit also the fix for API documentation, as well as a test that covers this corner case of zero size.  doing it. |
| --- |

All reactions

Sorry, something went wrong.

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=80&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)

Copy link

Member

Author

### **[ceolin](/ceolin)** commented [Mar 6, 2020](#issuecomment-595996604)

| Please, submit also the fix for API documentation, as well as a test that covers this corner case of zero size.  what exactly you want here ? I'll document that 0 size buffer is undefined behavior, we should not have test for it. That's said, pipe and poll tests are exercising this case, my opinion is that we fix these APIs (maybe others) later. |
| --- |

All reactions

Sorry, something went wrong.

`[sys: usermode: Document 0 size buffer memory check](/zephyrproject-rtos/zephyr/pull/23239/commits/eb77c7c7ab84255c418b434d7906166d82fdce08 "sys: usermode: Document 0 size buffer memory check

Documenting that 0 size buffer has undefined behavior.
See: https://github.com/zephyrproject-rtos/zephyr/pull/23239

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>")`
 …

`[eb77c7c](/zephyrproject-rtos/zephyr/pull/23239/commits/eb77c7c7ab84255c418b434d7906166d82fdce08)`

```
Documenting that 0 size buffer has undefined behavior.
See: [zephyrproject-rtos#23239](https://github.com/zephyrproject-rtos/zephyr/pull/23239)

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>
```

 [![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
requested review from
[carlescufi](/carlescufi) and
[nashif](/nashif)
as [code owners](/zephyrproject-rtos/zephyr/blob/fe6107f2b306f7983908299f3ef8c8aa84b54828/CODEOWNERS#L269)
[March 6, 2020 22:46](#event-3107116972)

[![@zephyrbot](https://avatars.githubusercontent.com/u/26360365?s=40&u=5c66ab67f5b0043f574103fa4f319a1ab3abd29e&v=4)](/zephyrbot)
[zephyrbot](/zephyrbot)
added
the
[area: API](/zephyrproject-rtos/zephyr/labels/area%3A%20API)
Changes to public APIs
label
[Mar 6, 2020](#event-3107136397)

[![@andrewboie](https://avatars.githubusercontent.com/u/3387369?s=80&u=39259b294046ea22cb384fb978d360a7cafe7a76&v=4)](/andrewboie)

Copy link

Contributor

### **[andrewboie](/andrewboie)** commented [Mar 7, 2020](#issuecomment-596050323)

| It's not like this UB represents a security concern unless I'm missing something. Should not block this PR. |
| --- |

All reactions

Sorry, something went wrong.

[![ioannisg](https://avatars.githubusercontent.com/u/2333931?s=60&v=4)](/ioannisg)

**[ioannisg](/ioannisg)**
reviewed
[Mar 7, 2020](#pullrequestreview-370737395)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/23239/files/eb77c7c7ab84255c418b434d7906166d82fdce08)

[include/sys/arch\_interface.h](/zephyrproject-rtos/zephyr/pull/23239/files/eb77c7c7ab84255c418b434d7906166d82fdce08#diff-026d94842854a63cadf6dbf7f84825db4aa013aeae75706f9d8dcae1ef6a07b3)

|  |  | @@ -578,6 +578,8 @@ void arch\_mem\_domain\_destroy(struct k\_mem\_domain \*domain); | |
| --- | --- | --- | --- |
|  |  | \* if the supplied memory buffer spans multiple enabled memory management |
|  |  | \* regions (even if all such regions permit user access). |
|  |  | \* |
|  |  | \* @warning 0 size buffer has undefined behavior. |

Copy link

Member

### @ioannisg **[ioannisg](/ioannisg)** [Mar 7, 2020](#discussion_r389245677)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

That's exactly what I wanted :)

Sorry, something went wrong.

All reactions

[![ioannisg](https://avatars.githubusercontent.com/u/2333931?s=60&v=4)](/ioannisg)

**[ioannisg](/ioannisg)**
approved these changes
[Mar 7, 2020](#pullrequestreview-370738341)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/23239/files/c892fd31ee821691f48c227dacdd1a1a594f312d)

[![@ioannisg](https://avatars.githubusercontent.com/u/2333931?s=80&u=f3712df0fbfac2ef5ffe7cb4e57e4c05bbceda94&v=4)](/ioannisg)

Copy link

Member

### **[ioannisg](/ioannisg)** commented [Mar 7, 2020](#issuecomment-596076886)

| That's said, pipe and poll tests are exercising this case, my opinion is that we fix these APIs (maybe others) later.  Since we are now documenting that arch\_buffer\_validate cannot get a 0 size buffer, we need to open an issue for fixing the APIs related to the tests mentioned above |
| --- |

All reactions

Sorry, something went wrong.

[![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=40&u=51d2beb44c5156d2b7fa53c67c18692eef1e0d12&v=4)](/jhedberg)
[jhedberg](/jhedberg)
merged commit [`4b2fc25`](/zephyrproject-rtos/zephyr/commit/4b2fc256cfe46f831da3bb8176a849645713dcee)
into
zephyrproject-rtos:master

[Mar 7, 2020](https://github.com/zephyrproject-rtos/zephyr/pull/23239#event-3107642730)

[![@ioannisg](https://avatars.githubusercontent.com/u/2333931?s=40&u=f3712df0fbfac2ef5ffe7cb4e57e4c05bbceda94&v=4)](/ioannisg)
[ioannisg](/ioannisg)
mentioned this pull request
[Mar 7, 2020](#ref-issue-533247316)

[ARM: Core Stack Improvements/Bug fixes for 2.2 release
#21201](/zephyrproject-rtos/zephyr/issues/21201)

Closed

18 tasks

[hakehuang](/hakehuang)
pushed a commit
to hakehuang/zephyr
that referenced
this pull request
[Mar 18, 2020](#ref-commit-2ee7f5d)
[![@hakehuang](https://avatars.githubusercontent.com/u/800198?s=40&v=4)](/hakehuang)

`[sys: usermode: Document 0 size buffer memory check](/hakehuang/zephyr/commit/2ee7f5def4133b42a586666c81c3f0cc640829ea "sys: usermode: Document 0 size buffer memory check

Documenting that 0 size buffer has undefined behavior.
See: https://github.com/zephyrproject-rtos/zephyr/pull/23239

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>")`
…

`[2ee7f5d](/hakehuang/zephyr/commit/2ee7f5def4133b42a586666c81c3f0cc640829ea)`

```
Documenting that 0 size buffer has undefined behavior.
See: [zephyrproject-rtos#23239](https://github.com/zephyrproject-rtos/zephyr/pull/23239)

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>
```

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
mentioned this pull request
[Mar 20, 2020](#ref-pullrequest-585327292)

[Backport v1.14: syscalls: arm: Fix possible overflow in is\_in\_region function
#23653](/zephyrproject-rtos/zephyr/pull/23653)
 Merged

[ceolin](/ceolin)
pushed a commit
to ceolin/zephyr
that referenced
this pull request
[Mar 20, 2020](#ref-commit-e7568ad)

`[sys: usermode: Document 0 size buffer memory check](/ceolin/zephyr/commit/e7568ad8a8f3f9744d427af8956281600532eda8 "sys: usermode: Document 0 size buffer memory check

Documenting that 0 size buffer has undefined behavior.
See: https://github.com/zephyrproject-rtos/zephyr/pull/23239

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>")`
…

`[e7568ad](/ceolin/zephyr/commit/e7568ad8a8f3f9744d427af8956281600532eda8)`

```
Documenting that 0 size buffer has undefined behavior.
See: [zephyrproject-rtos#23239](https://github.com/zephyrproject-rtos/zephyr/pull/23239)

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>
```

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
mentioned this pull request
[Mar 20, 2020](#ref-pullrequest-585330904)

[Backport v2.1: syscalls: arm: Fix possible overflow in is\_in\_region function
#23654](/zephyrproject-rtos/zephyr/pull/23654)
 Merged

[ceolin](/ceolin)
pushed a commit
to ceolin/zephyr
that referenced
this pull request
[Mar 24, 2020](#ref-commit-edf2f0b)

`[sys: usermode: Document 0 size buffer memory check](/ceolin/zephyr/commit/edf2f0b5dfbe01a8f98aff2a748c4de52a470a86 "sys: usermode: Document 0 size buffer memory check

Documenting that 0 size buffer has undefined behavior.
See: https://github.com/zephyrproject-rtos/zephyr/pull/23239

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>")`
…

`[edf2f0b](/ceolin/zephyr/commit/edf2f0b5dfbe01a8f98aff2a748c4de52a470a86)`

```
Documenting that 0 size buffer has undefined behavior.
See: [zephyrproject-rtos#23239](https://github.com/zephyrproject-rtos/zephyr/pull/23239)

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>
```

[nashif](/nashif)
pushed a commit
that referenced
this pull request
[Mar 24, 2020](#ref-commit-f032de6)
[![@nashif](https://avatars.githubusercontent.com/u/180017?s=40&v=4)](/nashif)

`[sys: usermode: Document 0 size buffer memory check](/zephyrproject-rtos/zephyr/commit/f032de6cc8969922d504176a7bd35ce30c95f996 "sys: usermode: Document 0 size buffer memory check

Documenting that 0 size buffer has undefined behavior.
See: https://github.com/zephyrproject-rtos/zephyr/pull/23239

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>")`
…

`[f032de6](/zephyrproject-rtos/zephyr/commit/f032de6cc8969922d504176a7bd35ce30c95f996)`

```
Documenting that 0 size buffer has undefined behavior.
See: [#23239](https://github.com/zephyrproject-rtos/zephyr/pull/23239)

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>
```

[dleach02](/dleach02)
pushed a commit
that referenced
this pull request
[May 5, 2020](#ref-commit-2649e4c)
[![@dleach02](https://avatars.githubusercontent.com/u/28570325?s=40&v=4)](/dleach02)

`[sys: usermode: Document 0 size buffer memory check](/zephyrproject-rtos/zephyr/commit/2649e4c0bef3582ad4146109d315088b838d092f "sys: usermode: Document 0 size buffer memory check

Documenting that 0 size buffer has undefined behavior.
See: https://github.com/zephyrproject-rtos/zephyr/pull/23239

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>")`
…

`[2649e4c](/zephyrproject-rtos/zephyr/commit/2649e4c0bef3582ad4146109d315088b838d092f)`

```
Documenting that 0 size buffer has undefined behavior.
See: [#23239](https://github.com/zephyrproject-rtos/zephyr/pull/23239)

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fzephyrproject-rtos%2Fzephyr%2Fpull%2F23239)

Reviewers

[![@stephanosio](https://avatars.githubusercontent.com/u/11345418?s=40&v=4)](/stephanosio) [stephanosio](/stephanosio)

stephanosio left review comments

[![@andrewboie](https://avatars.githubusercontent.com/u/3387369?s=40&v=4)](/andrewboie) [andrewboie](/andrewboie)

andrewboie approved these changes

[![@ioannisg](https://avatars.githubusercontent.com/u/2333931?s=40&v=4)](/ioannisg) [ioannisg](/ioannisg)

ioannisg approved these changes

[![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=40&v=4)](/jhedberg) [jhedberg](/jhedberg)

jhedberg approved these changes

[![@d3zd3z](https://avatars.githubusercontent.com/u/90349?s=40&v=4)](/d3zd3z) [d3zd3z](/d3zd3z)

 Awaiting requested review from d3zd3z

[![@galak](https://avatars.githubusercontent.com/u/16417047?s=40&v=4)](/galak) [galak](/galak)

 Awaiting requested review from galak

[![@MaureenHelm](https://avatars.githubusercontent.com/u/6172539?s=40&v=4)](/MaureenHelm) [MaureenHelm](/MaureenHelm)

 Awaiting requested review from MaureenHelm

[![@andyross](https://avatars.githubusercontent.com/u/300115?s=40&v=4)](/andyross) [andyross](/andyross)

 Awaiting requested review from andyross

[![@carlescufi](https://avatars.githubusercontent.com/u/12450381?s=40&v=4)](/carlescufi) [carlescufi](/carlescufi)

 Awaiting requested review from carlescufi

[![@nashif](https://avatars.githubusercontent.com/u/180017?s=40&v=4)](/nashif) [nashif](/nashif)

 Awaiting requested review from nashif

Assignees

No one assigned

Labels

[area: API](/zephyrproject-rtos/zephyr/labels/area%3A%20API)
Changes to public APIs
[area: ARM](/zephyrproject-rtos/zephyr/labels/area%3A%20ARM)
ARM (32-bit) Architecture
[area: Security](/zephyrproject-rtos/zephyr/labels/area%3A%20Security)
Security
[priority: high](/zephyrproject-rtos/zephyr/labels/priority%3A%20high)
High impact/importance bug

Projects

None yet

Milestone

 [**v2.2.0**](/zephyrproject-rtos/zephyr/milestone/40 "v2.2.0")

Development

Successfully merging this pull request may close these issues.

6 participants

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=52&v=4)](/ceolin) [![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=52&v=4)](/jhedberg) [![@ioannisg](https://avatars.githubusercontent.com/u/2333931?s=52&v=4)](/ioannisg) [![@andrewboie](https://avatars.githubusercontent.com/u/3387369?s=52&v=4)](/andrewboie) [![@stephanosio](https://avatars.githubusercontent.com/u/11345418?s=52&v=4)](/stephanosio) [![@zephyrbot](https://avatars.githubusercontent.com/u/26360365?s=52&v=4)](/zephyrbot)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_aa7018ef_20250119_115826.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzephyrproject-rtos%2Fzephyr%2Fpull%2F23654)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzephyrproject-rtos%2Fzephyr%2Fpull%2F23654)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=zephyrproject-rtos%2Fzephyr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[zephyrproject-rtos](/zephyrproject-rtos)
/
**[zephyr](/zephyrproject-rtos/zephyr)**
Public

* [Notifications](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr) You must be signed in to change notification settings
* [Fork
  6.8k](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr)
* [Star
   11.3k](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr)

* [Code](/zephyrproject-rtos/zephyr)
* [Issues
  1.9k](/zephyrproject-rtos/zephyr/issues)
* [Pull requests
  862](/zephyrproject-rtos/zephyr/pulls)
* [Discussions](/zephyrproject-rtos/zephyr/discussions)
* [Actions](/zephyrproject-rtos/zephyr/actions)
* [Projects
  20](/zephyrproject-rtos/zephyr/projects)
* [Wiki](/zephyrproject-rtos/zephyr/wiki)
* [Security](/zephyrproject-rtos/zephyr/security)
* [Insights](/zephyrproject-rtos/zephyr/pulse)

Additional navigation options

* [Code](/zephyrproject-rtos/zephyr)
* [Issues](/zephyrproject-rtos/zephyr/issues)
* [Pull requests](/zephyrproject-rtos/zephyr/pulls)
* [Discussions](/zephyrproject-rtos/zephyr/discussions)
* [Actions](/zephyrproject-rtos/zephyr/actions)
* [Projects](/zephyrproject-rtos/zephyr/projects)
* [Wiki](/zephyrproject-rtos/zephyr/wiki)
* [Security](/zephyrproject-rtos/zephyr/security)
* [Insights](/zephyrproject-rtos/zephyr/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fzephyrproject-rtos%2Fzephyr%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Backport v2.1: syscalls: arm: Fix possible overflow in is\_in\_region function #23654

 Merged

[dleach02](/dleach02)
merged 2 commits into
[zephyrproject-rtos:v2.1-branch](/zephyrproject-rtos/zephyr/tree/v2.1-branch "zephyrproject-rtos/zephyr:v2.1-branch")
from
[ceolin:23239-v2.1](/ceolin/zephyr/tree/23239-v2.1 "ceolin/zephyr:23239-v2.1")

May 5, 2020

 Merged

# [Backport v2.1: syscalls: arm: Fix possible overflow in is\_in\_region function](#top) #23654

[dleach02](/dleach02)
merged 2 commits into
[zephyrproject-rtos:v2.1-branch](/zephyrproject-rtos/zephyr/tree/v2.1-branch "zephyrproject-rtos/zephyr:v2.1-branch")
from
[ceolin:23239-v2.1](/ceolin/zephyr/tree/23239-v2.1 "ceolin/zephyr:23239-v2.1")

May 5, 2020

[Conversation
0](/zephyrproject-rtos/zephyr/pull/23654)
[Commits
2](/zephyrproject-rtos/zephyr/pull/23654/commits)
[Checks
0](/zephyrproject-rtos/zephyr/pull/23654/checks)
[Files changed](/zephyrproject-rtos/zephyr/pull/23654/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ceolin](https://avatars.githubusercontent.com/u/882919?s=60&v=4)](/ceolin)

Copy link

Member

### @ceolin **[ceolin](/ceolin)** commented [Mar 20, 2020](#issue-585330904)

Backporting [#23239](https://github.com/zephyrproject-rtos/zephyr/pull/23239) to v2.1 branch

Sorry, something went wrong.

All reactions

 Flavio Ceolin
added 2 commits
[March 20, 2020 14:11](#commits-pushed-cfad799)

`[syscalls: arm: Fix possible overflow in is_in_region function](/zephyrproject-rtos/zephyr/pull/23654/commits/cfad799d23c7fe7bd4ff491c760609b602330a8f "syscalls: arm: Fix possible overflow in is_in_region function

This function is widely used by functions that validate memory
buffers. Macros used to check permissions, like Z_SYSCALL_MEMORY_READ
and Z_SYSCALL_MEMORY_WRITE, use these functions to check that a
pointers passed by user threads in a syscall.

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>")`
 …

`[cfad799](/zephyrproject-rtos/zephyr/pull/23654/commits/cfad799d23c7fe7bd4ff491c760609b602330a8f)`

```
This function is widely used by functions that validate memory
buffers. Macros used to check permissions, like Z_SYSCALL_MEMORY_READ
and Z_SYSCALL_MEMORY_WRITE, use these functions to check that a
pointers passed by user threads in a syscall.

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>
```

`[sys: usermode: Document 0 size buffer memory check](/zephyrproject-rtos/zephyr/pull/23654/commits/e7568ad8a8f3f9744d427af8956281600532eda8 "sys: usermode: Document 0 size buffer memory check

Documenting that 0 size buffer has undefined behavior.
See: https://github.com/zephyrproject-rtos/zephyr/pull/23239

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>")`
 …

`[e7568ad](/zephyrproject-rtos/zephyr/pull/23654/commits/e7568ad8a8f3f9744d427af8956281600532eda8)`

```
Documenting that 0 size buffer has undefined behavior.
See: [zephyrproject-rtos#23239](https://github.com/zephyrproject-rtos/zephyr/pull/23239)

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>
```

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
added
[area: ARM](/zephyrproject-rtos/zephyr/labels/area%3A%20ARM)
ARM (32-bit) Architecture
[Backport](/zephyrproject-rtos/zephyr/labels/Backport)
Backport PR and backport failure issues
[backport v2.1-branch](/zephyrproject-rtos/zephyr/labels/backport%20v2.1-branch)
labels
[Mar 20, 2020](#event-3150930469)

 [![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
requested review from
[carlescufi](/carlescufi),
[galak](/galak),
[ioannisg](/ioannisg),
[MaureenHelm](/MaureenHelm) and
[nashif](/nashif)
as [code owners](/zephyrproject-rtos/zephyr/blob/b413223a66ed9e857c67ee21d1e8be4768804dd1/CODEOWNERS#L227)
[March 20, 2020 21:14](#event-3150930477)

[![@zephyrbot](https://avatars.githubusercontent.com/u/26360365?s=40&u=5c66ab67f5b0043f574103fa4f319a1ab3abd29e&v=4)](/zephyrbot)
[zephyrbot](/zephyrbot)
added
the
[area: API](/zephyrproject-rtos/zephyr/labels/area%3A%20API)
Changes to public APIs
label
[Mar 20, 2020](#event-3150936237)

[![d3zd3z](https://avatars.githubusercontent.com/u/90349?s=60&v=4)](/d3zd3z)

**[d3zd3z](/d3zd3z)**
approved these changes
[Mar 20, 2020](#pullrequestreview-378821877)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/23654/files/e7568ad8a8f3f9744d427af8956281600532eda8)

[![@nashif](https://avatars.githubusercontent.com/u/180017?s=40&u=5ff97075d41b30bcc3d0fcfc35020fe9238cf5d9&v=4)](/nashif)
[nashif](/nashif)
added this to the [v2.1.1](/zephyrproject-rtos/zephyr/milestone/42) milestone
[Mar 21, 2020](#event-3152088371)

[![ioannisg](https://avatars.githubusercontent.com/u/2333931?s=60&v=4)](/ioannisg)

**[ioannisg](/ioannisg)**
approved these changes
[Mar 23, 2020](#pullrequestreview-379347916)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/23654/files/e7568ad8a8f3f9744d427af8956281600532eda8)

[![@dleach02](https://avatars.githubusercontent.com/u/28570325?s=40&u=ba9124c5ad16e6258a1973ca2cac1d44c4e721cd&v=4)](/dleach02)
[dleach02](/dleach02)
closed this
[Apr 7, 2020](#event-3211699960)

[![@dleach02](https://avatars.githubusercontent.com/u/28570325?s=40&u=ba9124c5ad16e6258a1973ca2cac1d44c4e721cd&v=4)](/dleach02)
[dleach02](/dleach02)
reopened this
[Apr 7, 2020](#event-3211700114)

[![@dleach02](https://avatars.githubusercontent.com/u/28570325?s=40&u=ba9124c5ad16e6258a1973ca2cac1d44c4e721cd&v=4)](/dleach02)
[dleach02](/dleach02)
closed this
[Apr 16, 2020](#event-3240432154)

[![@dleach02](https://avatars.githubusercontent.com/u/28570325?s=40&u=ba9124c5ad16e6258a1973ca2cac1d44c4e721cd&v=4)](/dleach02)
[dleach02](/dleach02)
reopened this
[Apr 16, 2020](#event-3240432382)

[![@dleach02](https://avatars.githubusercontent.com/u/28570325?s=40&u=ba9124c5ad16e6258a1973ca2cac1d44c4e721cd&v=4)](/dleach02)
[dleach02](/dleach02)
closed this
[Apr 20, 2020](#event-3253255670)

[![@dleach02](https://avatars.githubusercontent.com/u/28570325?s=40&u=ba9124c5ad16e6258a1973ca2cac1d44c4e721cd&v=4)](/dleach02)
[dleach02](/dleach02)
reopened this
[Apr 20, 2020](#event-3253255842)

[![@dleach02](https://avatars.githubusercontent.com/u/28570325?s=40&u=ba9124c5ad16e6258a1973ca2cac1d44c4e721cd&v=4)](/dleach02)
[dleach02](/dleach02)
merged commit [`2649e4c`](/zephyrproject-rtos/zephyr/commit/2649e4c0bef3582ad4146109d315088b838d092f)
into
zephyrproject-rtos:v2.1-branch

[May 5, 2020](https://github.com/zephyrproject-rtos/zephyr/pull/23654#event-3305395395)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fzephyrproject-rtos%2Fzephyr%2Fpull%2F23654)

Reviewers

[![@ioannisg](https://avatars.githubusercontent.com/u/2333931?s=40&v=4)](/ioannisg) [ioannisg](/ioannisg)

ioannisg approved these changes

[![@d3zd3z](https://avatars.githubusercontent.com/u/90349?s=40&v=4)](/d3zd3z) [d3zd3z](/d3zd3z)

d3zd3z approved these changes

[![@carlescufi](https://avatars.githubusercontent.com/u/12450381?s=40&v=4)](/carlescufi) [carlescufi](/carlescufi)

 Awaiting requested review from carlescufi

 carlescufi is a code owner

[![@galak](https://avatars.githubusercontent.com/u/16417047?s=40&v=4)](/galak) [galak](/galak)

 Awaiting requested review from galak

 galak is a code owner

[![@MaureenHelm](https://avatars.githubusercontent.com/u/6172539?s=40&v=4)](/MaureenHelm) [MaureenHelm](/MaureenHelm)

 Awaiting requested review from MaureenHelm

 MaureenHelm is a code owner

[![@nashif](https://avatars.githubusercontent.com/u/180017?s=40&v=4)](/nashif) [nashif](/nashif)

 Awaiting requested review from nashif

 nashif is a code owner

Assignees

No one assigned

Labels

[area: API](/zephyrproject-rtos/zephyr/labels/area%3A%20API)
Changes to public APIs
[area: ARM](/zephyrproject-rtos/zephyr/labels/area%3A%20ARM)
ARM (32-bit) Architecture
[Backport](/zephyrproject-rtos/zephyr/labels/Backport)
Backport PR and backport failure issues

Projects

[Backports](/orgs/zephyrproject-rtos/projects/32)
Status: Done

Milestone

 [**v2.1.1**](/zephyrproject-rtos/zephyr/milestone/42 "v2.1.1")

Development

Successfully merging this pull request may close these issues.

6 participants

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=52&v=4)](/ceolin) [![@d3zd3z](https://avatars.githubusercontent.com/u/90349?s=52&v=4)](/d3zd3z) [![@ioannisg](https://avatars.githubusercontent.com/u/2333931?s=52&v=4)](/ioannisg) [![@nashif](https://avatars.githubusercontent.com/u/180017?s=52&v=4)](/nashif) [![@zephyrbot](https://avatars.githubusercontent.com/u/26360365?s=52&v=4)](/zephyrbot) [![@dleach02](https://avatars.githubusercontent.com/u/28570325?s=52&v=4)](/dleach02)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d06bbf15_20250119_134334.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzephyrproject-rtos%2Fzephyr%2Fpull%2F24902)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzephyrproject-rtos%2Fzephyr%2Fpull%2F24902)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=zephyrproject-rtos%2Fzephyr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[zephyrproject-rtos](/zephyrproject-rtos)
/
**[zephyr](/zephyrproject-rtos/zephyr)**
Public

* [Notifications](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr) You must be signed in to change notification settings
* [Fork
  6.8k](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr)
* [Star
   11.3k](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr)

* [Code](/zephyrproject-rtos/zephyr)
* [Issues
  1.9k](/zephyrproject-rtos/zephyr/issues)
* [Pull requests
  863](/zephyrproject-rtos/zephyr/pulls)
* [Discussions](/zephyrproject-rtos/zephyr/discussions)
* [Actions](/zephyrproject-rtos/zephyr/actions)
* [Projects
  20](/zephyrproject-rtos/zephyr/projects)
* [Wiki](/zephyrproject-rtos/zephyr/wiki)
* [Security](/zephyrproject-rtos/zephyr/security)
* [Insights](/zephyrproject-rtos/zephyr/pulse)

Additional navigation options

* [Code](/zephyrproject-rtos/zephyr)
* [Issues](/zephyrproject-rtos/zephyr/issues)
* [Pull requests](/zephyrproject-rtos/zephyr/pulls)
* [Discussions](/zephyrproject-rtos/zephyr/discussions)
* [Actions](/zephyrproject-rtos/zephyr/actions)
* [Projects](/zephyrproject-rtos/zephyr/projects)
* [Wiki](/zephyrproject-rtos/zephyr/wiki)
* [Security](/zephyrproject-rtos/zephyr/security)
* [Insights](/zephyrproject-rtos/zephyr/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fzephyrproject-rtos%2Fzephyr%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Bluetooth: Fix NULL pointer dereference when bt\_send() fails #24902

 Merged

[jhedberg](/jhedberg)
merged 1 commit into
[zephyrproject-rtos:master](/zephyrproject-rtos/zephyr/tree/master "zephyrproject-rtos/zephyr:master")
from
[jhedberg:bt\_null](/jhedberg/zephyr/tree/bt_null "jhedberg/zephyr:bt_null")

May 4, 2020

 Merged

# [Bluetooth: Fix NULL pointer dereference when bt\_send() fails](#top) #24902

[jhedberg](/jhedberg)
merged 1 commit into
[zephyrproject-rtos:master](/zephyrproject-rtos/zephyr/tree/master "zephyrproject-rtos/zephyr:master")
from
[jhedberg:bt\_null](/jhedberg/zephyr/tree/bt_null "jhedberg/zephyr:bt_null")

May 4, 2020

[Conversation
2](/zephyrproject-rtos/zephyr/pull/24902)
[Commits
1](/zephyrproject-rtos/zephyr/pull/24902/commits)
[Checks
0](/zephyrproject-rtos/zephyr/pull/24902/checks)
[Files changed](/zephyrproject-rtos/zephyr/pull/24902/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![jhedberg](https://avatars.githubusercontent.com/u/1032570?s=60&v=4)](/jhedberg)

Copy link

Member

### @jhedberg **[jhedberg](/jhedberg)** commented [May 2, 2020](#issue-611185393)

The last parameter to hci\_cmd\_done() is expected to be a valid net\_buf

since the function immediately tries to dereference it. Fix this by

passing the appropriate buffer reference to the function.

Signed-off-by: Johan Hedberg johan.hedberg@intel.com

Sorry, something went wrong.

All reactions

`[Bluetooth: Fix NULL pointer dereference when bt_send() fails](/zephyrproject-rtos/zephyr/pull/24902/commits/7f49158271bc1abac739dcfbcbb1569c4df60820 "Bluetooth: Fix NULL pointer dereference when bt_send() fails

The last parameter to hci_cmd_done() is expected to be a valid net_buf
since the function immediately tries to dereference it. Fix this by
passing the appropriate buffer reference to the function.

Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>")`
 …

`[7f49158](/zephyrproject-rtos/zephyr/pull/24902/commits/7f49158271bc1abac739dcfbcbb1569c4df60820)`

```
The last parameter to hci_cmd_done() is expected to be a valid net_buf
since the function immediately tries to dereference it. Fix this by
passing the appropriate buffer reference to the function.

Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>
```

[![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=40&u=51d2beb44c5156d2b7fa53c67c18692eef1e0d12&v=4)](/jhedberg)
[jhedberg](/jhedberg)
added
[bug](/zephyrproject-rtos/zephyr/labels/bug)
The issue is a bug, or the PR is fixing a bug
[area: Bluetooth](/zephyrproject-rtos/zephyr/labels/area%3A%20Bluetooth)
labels
[May 2, 2020](#event-3295868579)

 [![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=40&u=51d2beb44c5156d2b7fa53c67c18692eef1e0d12&v=4)](/jhedberg)
[jhedberg](/jhedberg)
requested review from
[d3zd3z](/d3zd3z),
[ceolin](/ceolin) and
[carlescufi](/carlescufi)
[May 2, 2020 13:07](#event-3295868587)

 [![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=40&u=51d2beb44c5156d2b7fa53c67c18692eef1e0d12&v=4)](/jhedberg)
[jhedberg](/jhedberg)
requested review from
[joerchan](/joerchan) and
[Vudentz](/Vudentz)
as [code owners](/zephyrproject-rtos/zephyr/blob/ec5603da8d60df7da5045f6fb0d08229f60b830d/CODEOWNERS#L421)
[May 2, 2020 13:07](#event-3295868594)

[![carlescufi](https://avatars.githubusercontent.com/u/12450381?s=60&v=4)](/carlescufi)

**[carlescufi](/carlescufi)**
approved these changes
[May 2, 2020](#pullrequestreview-404560343)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/24902/files/7f49158271bc1abac739dcfbcbb1569c4df60820)

[![@wopu-ot](https://avatars.githubusercontent.com/u/40054279?s=80&u=7bc21f6c474a008492bf1b9f0df58168ce40994a&v=4)](/wopu-ot)

Copy link

Collaborator

### **[wopu-ot](/wopu-ot)** commented [May 4, 2020](#issuecomment-623298208)

| It looks like this is also an issue in 2.2. Will you backport the fix? |
| --- |

All reactions

Sorry, something went wrong.

[![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=80&u=51d2beb44c5156d2b7fa53c67c18692eef1e0d12&v=4)](/jhedberg)

Copy link

Member

Author

### **[jhedberg](/jhedberg)** commented [May 4, 2020](#issuecomment-623298331)

| It looks like this is also an issue in 2.2. Will you backport the fix?  Yes |
| --- |

 👍
1
 wopu-ot reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![joerchan](https://avatars.githubusercontent.com/u/1413276?s=60&v=4)](/joerchan)

**[joerchan](/joerchan)**
approved these changes
[May 4, 2020](#pullrequestreview-404762823)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/24902/files/7f49158271bc1abac739dcfbcbb1569c4df60820)

[![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=40&u=51d2beb44c5156d2b7fa53c67c18692eef1e0d12&v=4)](/jhedberg)
[jhedberg](/jhedberg)
merged commit [`e1dddf7`](/zephyrproject-rtos/zephyr/commit/e1dddf7befa7309bd2afc567b2e00d2e7362f7c4)
into
zephyrproject-rtos:master

[May 4, 2020](https://github.com/zephyrproject-rtos/zephyr/pull/24902#event-3298712121)

 [![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=40&u=51d2beb44c5156d2b7fa53c67c18692eef1e0d12&v=4)](/jhedberg)
[jhedberg](/jhedberg)
deleted the
bt\_null

branch
[May 4, 2020 07:59](#event-3298712563)

This was referenced May 4, 2020

[[Backport v2.2] Bluetooth: Fix NULL pointer dereference when bt\_send() fails
#24925](/zephyrproject-rtos/zephyr/pull/24925)
 Merged

[[Backport v1.14-branch] Bluetooth: Fix NULL pointer dereference when bt\_send() fails
#25089](/zephyrproject-rtos/zephyr/pull/25089)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fzephyrproject-rtos%2Fzephyr%2Fpull%2F24902)

Reviewers

[![@carlescufi](https://avatars.githubusercontent.com/u/12450381?s=40&v=4)](/carlescufi) [carlescufi](/carlescufi)

carlescufi approved these changes

[![@joerchan](https://avatars.githubusercontent.com/u/1413276?s=40&v=4)](/joerchan) [joerchan](/joerchan)

joerchan approved these changes

[![@d3zd3z](https://avatars.githubusercontent.com/u/90349?s=40&v=4)](/d3zd3z) [d3zd3z](/d3zd3z)

 Awaiting requested review from d3zd3z

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&v=4)](/ceolin) [ceolin](/ceolin)

 Awaiting requested review from ceolin

[![@Vudentz](https://avatars.githubusercontent.com/u/2156363?s=40&v=4)](/Vudentz) [Vudentz](/Vudentz)

 Awaiting requested review from Vudentz

Assignees

No one assigned

Labels

[area: Bluetooth](/zephyrproject-rtos/zephyr/labels/area%3A%20Bluetooth)
[bug](/zephyrproject-rtos/zephyr/labels/bug)
The issue is a bug, or the PR is fixing a bug

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@jhedberg](https://avatars.githubusercontent.com/u/1032570?s=52&v=4)](/jhedberg) [![@wopu-ot](https://avatars.githubusercontent.com/u/40054279?s=52&v=4)](/wopu-ot) [![@joerchan](https://avatars.githubusercontent.com/u/1413276?s=52&v=4)](/joerchan) [![@carlescufi](https://avatars.githubusercontent.com/u/12450381?s=52&v=4)](/carlescufi)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_ee05e02c_20250119_115824.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzephyrproject-rtos%2Fzephyr%2Fpull%2F23653)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzephyrproject-rtos%2Fzephyr%2Fpull%2F23653)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=zephyrproject-rtos%2Fzephyr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[zephyrproject-rtos](/zephyrproject-rtos)
/
**[zephyr](/zephyrproject-rtos/zephyr)**
Public

* [Notifications](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr) You must be signed in to change notification settings
* [Fork
  6.8k](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr)
* [Star
   11.3k](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr)

* [Code](/zephyrproject-rtos/zephyr)
* [Issues
  1.9k](/zephyrproject-rtos/zephyr/issues)
* [Pull requests
  862](/zephyrproject-rtos/zephyr/pulls)
* [Discussions](/zephyrproject-rtos/zephyr/discussions)
* [Actions](/zephyrproject-rtos/zephyr/actions)
* [Projects
  20](/zephyrproject-rtos/zephyr/projects)
* [Wiki](/zephyrproject-rtos/zephyr/wiki)
* [Security](/zephyrproject-rtos/zephyr/security)
* [Insights](/zephyrproject-rtos/zephyr/pulse)

Additional navigation options

* [Code](/zephyrproject-rtos/zephyr)
* [Issues](/zephyrproject-rtos/zephyr/issues)
* [Pull requests](/zephyrproject-rtos/zephyr/pulls)
* [Discussions](/zephyrproject-rtos/zephyr/discussions)
* [Actions](/zephyrproject-rtos/zephyr/actions)
* [Projects](/zephyrproject-rtos/zephyr/projects)
* [Wiki](/zephyrproject-rtos/zephyr/wiki)
* [Security](/zephyrproject-rtos/zephyr/security)
* [Insights](/zephyrproject-rtos/zephyr/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fzephyrproject-rtos%2Fzephyr%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fzephyrproject-rtos%2Fzephyr%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Backport v1.14: syscalls: arm: Fix possible overflow in is\_in\_region function #23653

 Merged

[nashif](/nashif)
merged 2 commits into
[zephyrproject-rtos:v1.14-branch](/zephyrproject-rtos/zephyr/tree/v1.14-branch "zephyrproject-rtos/zephyr:v1.14-branch")
from
[ceolin:23239-v1.14](/ceolin/zephyr/tree/23239-v1.14 "ceolin/zephyr:23239-v1.14")

Mar 24, 2020

 Merged

# [Backport v1.14: syscalls: arm: Fix possible overflow in is\_in\_region function](#top) #23653

[nashif](/nashif)
merged 2 commits into
[zephyrproject-rtos:v1.14-branch](/zephyrproject-rtos/zephyr/tree/v1.14-branch "zephyrproject-rtos/zephyr:v1.14-branch")
from
[ceolin:23239-v1.14](/ceolin/zephyr/tree/23239-v1.14 "ceolin/zephyr:23239-v1.14")

Mar 24, 2020

[Conversation
0](/zephyrproject-rtos/zephyr/pull/23653)
[Commits
2](/zephyrproject-rtos/zephyr/pull/23653/commits)
[Checks
0](/zephyrproject-rtos/zephyr/pull/23653/checks)
[Files changed](/zephyrproject-rtos/zephyr/pull/23653/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ceolin](https://avatars.githubusercontent.com/u/882919?s=60&v=4)](/ceolin)

Copy link

Member

### @ceolin **[ceolin](/ceolin)** commented [Mar 20, 2020](#issue-585327292)

Manually backporting issue: [#23239](https://github.com/zephyrproject-rtos/zephyr/pull/23239) to v1.14 branch

Sorry, something went wrong.

All reactions

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
added
[area: ARM](/zephyrproject-rtos/zephyr/labels/area%3A%20ARM)
ARM (32-bit) Architecture
[backport v1.14-branch](/zephyrproject-rtos/zephyr/labels/backport%20v1.14-branch)
[Backport](/zephyrproject-rtos/zephyr/labels/Backport)
Backport PR and backport failure issues
labels
[Mar 20, 2020](#event-3150909109)

 [![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
requested a review
from [nashif](/nashif)
[March 20, 2020 21:06](#event-3150909125)

 [![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
requested review from
[andrewboie](/andrewboie),
[andyross](/andyross),
[galak](/galak) and
[MaureenHelm](/MaureenHelm)
as [code owners](/zephyrproject-rtos/zephyr/blob/83bd7d3f3efa9c358e20083ad46b12efadc93ba0/CODEOWNERS#L218)
[March 20, 2020 21:06](#event-3150909128)

[![d3zd3z](https://avatars.githubusercontent.com/u/90349?s=60&v=4)](/d3zd3z)

**[d3zd3z](/d3zd3z)**
approved these changes
[Mar 20, 2020](#pullrequestreview-378814211)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/23653/files)

[![@zephyrbot](https://avatars.githubusercontent.com/u/26360365?s=40&u=5c66ab67f5b0043f574103fa4f319a1ab3abd29e&v=4)](/zephyrbot)
[zephyrbot](/zephyrbot)
added
the
[area: Kernel](/zephyrproject-rtos/zephyr/labels/area%3A%20Kernel)
label
[Mar 20, 2020](#event-3150936032)

 Flavio Ceolin
added 2 commits
[March 24, 2020 09:05](#commits-pushed-15c2573)

`[syscalls: arm: Fix possible overflow in is_in_region function](/zephyrproject-rtos/zephyr/pull/23653/commits/15c2573daba9653a28f0c2d40f4419323a21a18c "syscalls: arm: Fix possible overflow in is_in_region function

This function is widely used by functions that validate memory
buffers. Macros used to check permissions, like Z_SYSCALL_MEMORY_READ
and Z_SYSCALL_MEMORY_WRITE, use these functions to check that a
pointers passed by user threads in a syscall.

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>")`
 …

`[15c2573](/zephyrproject-rtos/zephyr/pull/23653/commits/15c2573daba9653a28f0c2d40f4419323a21a18c)`

```
This function is widely used by functions that validate memory
buffers. Macros used to check permissions, like Z_SYSCALL_MEMORY_READ
and Z_SYSCALL_MEMORY_WRITE, use these functions to check that a
pointers passed by user threads in a syscall.

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>
```

`[sys: usermode: Document 0 size buffer memory check](/zephyrproject-rtos/zephyr/pull/23653/commits/edf2f0b5dfbe01a8f98aff2a748c4de52a470a86 "sys: usermode: Document 0 size buffer memory check

Documenting that 0 size buffer has undefined behavior.
See: https://github.com/zephyrproject-rtos/zephyr/pull/23239

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>")`
 …

`[edf2f0b](/zephyrproject-rtos/zephyr/pull/23653/commits/edf2f0b5dfbe01a8f98aff2a748c4de52a470a86)`

```
Documenting that 0 size buffer has undefined behavior.
See: [zephyrproject-rtos#23239](https://github.com/zephyrproject-rtos/zephyr/pull/23239)

Signed-off-by: Flavio Ceolin <flavio.ceolin@intel.com>
```

 [![@ceolin](https://avatars.githubusercontent.com/u/882919?s=40&u=3abb27eb8df3bdcdd68a15ced62b60adbd4bbd3f&v=4)](/ceolin)
[ceolin](/ceolin)
[force-pushed](/zephyrproject-rtos/zephyr/compare/15611c704deb40aaa6362efb6aef9955b7d433f7..edf2f0b5dfbe01a8f98aff2a748c4de52a470a86)
the
23239-v1.14

branch
from
[`15611c7`](/zephyrproject-rtos/zephyr/commit/15611c704deb40aaa6362efb6aef9955b7d433f7) to
[`edf2f0b`](/zephyrproject-rtos/zephyr/commit/edf2f0b5dfbe01a8f98aff2a748c4de52a470a86)  [Compare](/zephyrproject-rtos/zephyr/compare/15611c704deb40aaa6362efb6aef9955b7d433f7..edf2f0b5dfbe01a8f98aff2a748c4de52a470a86)
[March 24, 2020 16:08](#event-3160406273)

[![nashif](https://avatars.githubusercontent.com/u/180017?s=60&v=4)](/nashif)

**[nashif](/nashif)**
approved these changes
[Mar 24, 2020](#pullrequestreview-380764553)

 [View reviewed changes](/zephyrproject-rtos/zephyr/pull/23653/files/edf2f0b5dfbe01a8f98aff2a748c4de52a470a86)

[![@nashif](https://avatars.githubusercontent.com/u/180017?s=40&u=5ff97075d41b30bcc3d0fcfc35020fe9238cf5d9&v=4)](/nashif)
[nashif](/nashif)
merged commit [`f032de6`](/zephyrproject-rtos/zephyr/commit/f032de6cc8969922d504176a7bd35ce30c95f996)
into
zephyrproject-rtos:v1.14-branch

[Mar 24, 2020](https://github.com/zephyrproject-rtos/zephyr/pull/23653#event-3161911363)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fzephyrproject-rtos%2Fzephyr%2Fpull%2F23653)

Reviewers

[![@nashif](https://avatars.githubusercontent.com/u/180017?s=40&v=4)](/nashif) [nashif](/nashif)

nashif approved these changes

[![@d3zd3z](https://avatars.githubusercontent.com/u/90349?s=40&v=4)](/d3zd3z) [d3zd3z](/d3zd3z)

d3zd3z approved these changes

[![@andrewboie](https://avatars.githubusercontent.com/u/3387369?s=40&v=4)](/andrewboie) [andrewboie](/andrewboie)

 Awaiting requested review from andrewboie

[![@andyross](https://avatars.githubusercontent.com/u/300115?s=40&v=4)](/andyross) [andyross](/andyross)

 Awaiting requested review from andyross

 andyross is a code owner

[![@galak](https://avatars.githubusercontent.com/u/16417047?s=40&v=4)](/galak) [galak](/galak)

 Awaiting requested review from galak

 galak is a code owner

[![@MaureenHelm](https://avatars.githubusercontent.com/u/6172539?s=40&v=4)](/MaureenHelm) [MaureenHelm](/MaureenHelm)

 Awaiting requested review from MaureenHelm

 MaureenHelm is a code owner

Assignees

No one assigned

Labels

[area: ARM](/zephyrproject-rtos/zephyr/labels/area%3A%20ARM)
ARM (32-bit) Architecture
[area: Kernel](/zephyrproject-rtos/zephyr/labels/area%3A%20Kernel)
[Backport](/zephyrproject-rtos/zephyr/labels/Backport)
Backport PR and backport failure issues

Projects

[Backports](/orgs/zephyrproject-rtos/projects/32)
Status: Done

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@ceolin](https://avatars.githubusercontent.com/u/882919?s=52&v=4)](/ceolin) [![@d3zd3z](https://avatars.githubusercontent.com/u/90349?s=52&v=4)](/d3zd3z) [![@nashif](https://avatars.githubusercontent.com/u/180017?s=52&v=4)](/nashif) [![@zephyrbot](https://avatars.githubusercontent.com/u/26360365?s=52&v=4)](/zephyrbot)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from docs.zephyrproject.org_aceee80d_20250119_115820.html ===

[![Logo](../_static/logo.svg)](../index.html)

* Built-in search
* Google search

 Zephyr Project
v: latest

Document Release Versions
[latest](/)
[4.0.0](/4.0.0/)
[3.7.0 (LTS)](/3.7.0/)
[2.7.6 (LTS)](/2.7.6/)

Downloads
[PDF](/latest/zephyr.pdf)

zephyrproject.org Links
[Project Home](https://www.zephyrproject.org/)

[SDK](https://github.com/zephyrproject-rtos/sdk-ng/releases)

[Releases](https://github.com/zephyrproject-rtos/zephyr/releases)

* [Introduction](../introduction/index.html)
* [Developing with Zephyr](../develop/index.html)
* [Kernel](../kernel/index.html)
* [OS Services](../services/index.html)
* [Build and Configuration Systems](../build/index.html)
* [Connectivity](../connectivity/index.html)
* [Hardware Support](../hardware/index.html)
* [Contributing to Zephyr](../contribute/index.html)
* [Project and Governance](../project/index.html)
* [Security](index.html)
  + [Zephyr Security Overview](security-overview.html)
  + [Security Vulnerability Reporting](reporting.html)
  + [Secure Coding](secure-coding.html)
  + [Sensor Device Threat Model](sensor-threat.html)
  + [Hardening Tool](hardening-tool.html)
  + Vulnerabilities
    - [CVE-2017](#cve-2017)
      * [**CVE 2017-14199**](#cve-2017-14199)
      * [**CVE 2017-14201**](#cve-2017-14201)
      * [**CVE 2017-14202**](#cve-2017-14202)
    - [CVE-2019](#cve-2019)
      * [**CVE 2019-9506**](#cve-2019-9506)
    - [CVE-2020](#cve-2020)
      * [**CVE 2020-10019**](#cve-2020-10019)
      * [**CVE 2020-10021**](#cve-2020-10021)
      * [**CVE 2020-10022**](#cve-2020-10022)
      * [**CVE 2020-10023**](#cve-2020-10023)
      * [**CVE 2020-10024**](#cve-2020-10024)
      * [**CVE 2020-10027**](#cve-2020-10027)
      * [**CVE 2020-10028**](#cve-2020-10028)
      * [**CVE 2020-10058**](#cve-2020-10058)
      * [**CVE 2020-10059**](#cve-2020-10059)
      * [**CVE 2020-10060**](#cve-2020-10060)
      * [**CVE 2020-10061**](#cve-2020-10061)
      * [**CVE 2020-10062**](#cve-2020-10062)
      * [**CVE 2020-10063**](#cve-2020-10063)
      * [**CVE 2020-10064**](#cve-2020-10064)
      * [**CVE 2020-10065**](#cve-2020-10065)
      * [**CVE 2020-10066**](#cve-2020-10066)
      * [**CVE 2020-10067**](#cve-2020-10067)
      * [**CVE 2020-10068**](#cve-2020-10068)
      * [**CVE 2020-10069**](#cve-2020-10069)
      * [**CVE 2020-10070**](#cve-2020-10070)
      * [**CVE 2020-10071**](#cve-2020-10071)
      * [**CVE 2020-10072**](#cve-2020-10072)
      * [**CVE 2020-10136**](#cve-2020-10136)
      * [**CVE 2020-13598**](#cve-2020-13598)
      * [**CVE 2020-13599**](#cve-2020-13599)
      * [**CVE 2020-13600**](#cve-2020-13600)
      * [**CVE 2020-13601**](#cve-2020-13601)
      * [**CVE 2020-13602**](#cve-2020-13602)
      * [**CVE 2020-13603**](#cve-2020-13603)
    - [CVE-2021](#cve-2021)
      * [**CVE 2021-3319**](#cve-2021-3319)
      * [**CVE 2021-3320**](#cve-2021-3320)
      * [**CVE 2021-3321**](#cve-2021-3321)
      * [**CVE 2021-3323**](#cve-2021-3323)
      * [**CVE 2021-3430**](#cve-2021-3430)
      * [**CVE 2021-3431**](#cve-2021-3431)
      * [**CVE 2021-3432**](#cve-2021-3432)
      * [**CVE 2021-3433**](#cve-2021-3433)
      * [**CVE 2021-3434**](#cve-2021-3434)
      * [**CVE 2021-3435**](#cve-2021-3435)
      * [**CVE 2021-3436**](#cve-2021-3436)
      * [**CVE 2021-3454**](#cve-2021-3454)
      * [**CVE 2021-3455**](#cve-2021-3455)
      * [**CVE 2021-3510**](#cve-2021-3510)
      * [**CVE 2021-3581**](#cve-2021-3581)
      * [**CVE 2021-3625**](#cve-2021-3625)
      * [**CVE 2021-3835**](#cve-2021-3835)
      * [**CVE 2021-3861**](#cve-2021-3861)
      * [**CVE 2021-3966**](#cve-2021-3966)
    - [CVE-2022](#cve-2022)
      * [**CVE 2022-0553**](#cve-2022-0553)
      * [**CVE 2022-1041**](#cve-2022-1041)
      * [**CVE 2022-1042**](#cve-2022-1042)
      * [**CVE 2022-1841**](#cve-2022-1841)
      * [**CVE 2022-2741**](#cve-2022-2741)
      * [**CVE 2022-2993**](#cve-2022-2993)
      * [**CVE 2022-3806**](#cve-2022-3806)
    - [CVE-2023](#cve-2023)
      * [**CVE 2023-0396**](#cve-2023-0396)
      * [**CVE 2023-0397**](#cve-2023-0397)
      * [**CVE 2023-0779**](#cve-2023-0779)
      * [**CVE 2023-1901**](#cve-2023-1901)
      * [**CVE 2023-1902**](#cve-2023-1902)
      * [**CVE 2023-3725**](#cve-2023-3725)
      * [**CVE 2023-4257**](#cve-2023-4257)
      * [**CVE 2023-4258**](#cve-2023-4258)
      * [**CVE 2023-4259**](#cve-2023-4259)
      * [**CVE 2023-4260**](#cve-2023-4260)
      * [**CVE 2023-4262**](#cve-2023-4262)
      * [**CVE 2023-4263**](#cve-2023-4263)
      * [**CVE 2023-4264**](#cve-2023-4264)
      * [**CVE 2023-4265**](#cve-2023-4265)
      * [**CVE 2023-4424**](#cve-2023-4424)
      * [**CVE 2023-5055**](#cve-2023-5055)
      * [**CVE 2023-5139**](#cve-2023-5139)
      * [**CVE 2023-5184**](#cve-2023-5184)
      * [**CVE 2023-5563**](#cve-2023-5563)
      * [**CVE 2023-5753**](#cve-2023-5753)
      * [**CVE 2023-5779**](#cve-2023-5779)
      * [**CVE 2023-6249**](#cve-2023-6249)
      * [**CVE 2023-6749**](#cve-2023-6749)
      * [**CVE 2023-6881**](#cve-2023-6881)
      * [**CVE 2023-7060**](#cve-2023-7060)
    - [CVE-2024](#cve-2024)
      * [**CVE 2024-1638**](#cve-2024-1638)
      * [**CVE 2024-3077**](#cve-2024-3077)
      * [**CVE 2024-3332**](#cve-2024-3332)
      * [**CVE 2024-4785**](#cve-2024-4785)
      * [**CVE 2024-5754**](#cve-2024-5754)
      * [**CVE 2024-5931**](#cve-2024-5931)
      * [**CVE 2024-6135**](#cve-2024-6135)
      * [**CVE 2024-6137**](#cve-2024-6137)
      * [**CVE 2024-6258**](#cve-2024-6258)
      * [**CVE 2024-6259**](#cve-2024-6259)
      * [**CVE 2024-6442**](#cve-2024-6442)
      * [**CVE 2024-6443**](#cve-2024-6443)
      * [**CVE 2024-6444**](#cve-2024-6444)
      * [**CVE 2024-8798**](#cve-2024-8798)
      * [**CVE 2024-10395**](#cve-2024-10395)
      * [**CVE 2024-11263**](#cve-2024-11263)
  + [Security standards and Zephyr](standards/index.html)
* [Safety](../safety/index.html)
* [Samples and Demos](../samples/index.html)
* [Supported Boards and Shields](../boards/index.html)
* [Shields](../boards/index.html#shields)
* [Releases](../releases/index.html)

Reference

* [API](/latest/doxygen/html/index.html)
* [Kconfig Options](/latest/kconfig.html)
* [Devicetree Bindings](/latest/build/dts/api/bindings.html)
* [West Projects](/latest/develop/manifest/index.html)

[Zephyr Project](../index.html)

* [Docs / Latest](../index.html) »
* [Security](index.html) »
* Vulnerabilities
* [Open on GitHub](https://github.com/zephyrproject-rtos/zephyr/blob/main/doc/security/vulnerabilities.rst)
  [Report an issue with this page](https://github.com/zephyrproject-rtos/zephyr/issues/new?title=doc%3A%20Documentation%20issue%20in%20%27security/vulnerabilities%27&labels=area%3A%20Documentation,area: Documentation&body=%2A%2ADescribe%20the%20bug%2A%2A%0A%0A%3C%3C%20Please%20describe%20the%20issue%20here%20%3E%3E%0A%3C%3C%20You%20may%20also%20want%20to%20update%20the%20automatically%20generated%20issue%20title%20above.%20%3E%3E%0A%0A%2A%2AEnvironment%2A%2A%0A%0A%2A%20Page%3A%20%60security/vulnerabilities%60%0A%2A%20Version%3A%20main%0A%2A%20SHA-1%3A%20c616a1719f2a2accf427766f596cb12e7515b371%0A)

---

# Vulnerabilities[ï](#vulnerabilities "Link to this heading")

This page collects all of the vulnerabilities that are discovered and
fixed in each release. It will also often have more details than is
available in the releases. Some vulnerabilities are deemed to be
sensitive, and will not be publicly discussed until there is
sufficient time to fix them. Because the release notes are locked to
a version, the information here can be updated after the embargo is
lifted.

## CVE-2017[ï](#cve-2017 "Link to this heading")

### [**CVE 2017-14199**](https://www.cve.org/CVERecord?id=CVE-2017-14199)[ï](#cve-2017-14199 "Link to this heading")

Buffer overflow in `getaddrinfo()`.

* [Zephyr project bug tracker ZEPSEC-12](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-12)
* [PR6158 fix for 1.11.0](https://github.com/zephyrproject-rtos/zephyr/pull/6158)

### [**CVE 2017-14201**](https://www.cve.org/CVERecord?id=CVE-2017-14201)[ï](#cve-2017-14201 "Link to this heading")

The shell DNS command can cause unpredictable results due to misuse of
stack variables.

Use After Free vulnerability in the Zephyr shell allows a serial or
telnet connected user to cause denial of service, and possibly remote
code execution.

This has been fixed in release v1.14.0.

* [Zephyr project bug tracker ZEPSEC-17](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-17)
* [PR13260 fix for v1.14.0](https://github.com/zephyrproject-rtos/zephyr/pull/13260)

### [**CVE 2017-14202**](https://www.cve.org/CVERecord?id=CVE-2017-14202)[ï](#cve-2017-14202 "Link to this heading")

The shell implementation does not protect against buffer overruns
resulting in unpredictable behavior.

Improper Restriction of Operations within the Bounds of a Memory
Buffer vulnerability in the shell component of Zephyr allows a serial
or telnet connected user to cause a crash, possibly with arbitrary
code execution.

This has been fixed in release v1.14.0.

* [Zephyr project bug tracker ZEPSEC-18](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-18)
* [PR13048 fix for v1.14.0](https://github.com/zephyrproject-rtos/zephyr/pull/13048)

## CVE-2019[ï](#cve-2019 "Link to this heading")

### [**CVE 2019-9506**](https://www.cve.org/CVERecord?id=CVE-2019-9506)[ï](#cve-2019-9506 "Link to this heading")

The Bluetooth BR/EDR specification up to and including version 5.1
permits sufficiently low encryption key length and does not prevent an
attacker from influencing the key length negotiation. This allows
practical brute-force attacks (aka âKNOBâ) that can decrypt traffic
and inject arbitrary ciphertext without the victim noticing.

* [Zephyr project bug tracker ZEPSEC-20](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-20)
* [PR18702 fix for v1.14.0](https://github.com/zephyrproject-rtos/zephyr/pull/18702)
* [PR18659 fix for v2.0.0](https://github.com/zephyrproject-rtos/zephyr/pull/18659)

## CVE-2020[ï](#cve-2020 "Link to this heading")

### [**CVE 2020-10019**](https://www.cve.org/CVERecord?id=CVE-2020-10019)[ï](#cve-2020-10019 "Link to this heading")

Buffer Overflow vulnerability in USB DFU of zephyr allows a USB
connected host to cause possible remote code execution.

This has been fixed in releases v1.14.2, v2.2.0, and v2.1.1.

* [Zephyr project bug tracker ZEPSEC-25](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-25)
* [PR23460 fix for 1.14.x](https://github.com/zephyrproject-rtos/zephyr/pull/23460)
* [PR23457 fix for 2.1.x](https://github.com/zephyrproject-rtos/zephyr/pull/23457)
* [PR23190 fix in 2.2.0](https://github.com/zephyrproject-rtos/zephyr/pull/23190)

### [**CVE 2020-10021**](https://www.cve.org/CVERecord?id=CVE-2020-10021)[ï](#cve-2020-10021 "Link to this heading")

Out-of-bounds write in USB Mass Storage with unaligned sizes

Out-of-bounds Write in the USB Mass Storage memoryWrite handler with
unaligned Sizes.

See NCC-ZEP-024, NCC-ZEP-025, NCC-ZEP-026

This has been fixed in releases v1.14.2, and v2.2.0.

* [Zephyr project bug tracker ZEPSEC-26](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-26)
* [PR23455 fix for v1.14.2](https://github.com/zephyrproject-rtos/zephyr/pull/23455)
* [PR23456 fix for the v2.1 branch](https://github.com/zephyrproject-rtos/zephyr/pull/23456)
* [PR23240 fix for v2.2.0](https://github.com/zephyrproject-rtos/zephyr/pull/23240)

### [**CVE 2020-10022**](https://www.cve.org/CVERecord?id=CVE-2020-10022)[ï](#cve-2020-10022 "Link to this heading")

UpdateHub Module Copies a Variable-Size Hash String Into a Fixed-Size Array

A malformed JSON payload that is received from an UpdateHub server may
trigger memory corruption in the Zephyr OS. This could result in a
denial of service in the best case, or code execution in the worst
case.

See NCC-ZEP-016

This has been fixed in the below pull requests for main, branch from
v2.1.0, and branch from v2.2.0.

* [Zephyr project bug tracker ZEPSEC-28](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-28)
* [PR24154 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/24154)
* [PR24065 fix for branch from v2.1.0](https://github.com/zephyrproject-rtos/zephyr/pull/24065)
* [PR24066 fix for branch from v2.2.0](https://github.com/zephyrproject-rtos/zephyr/pull/24066)

### [**CVE 2020-10023**](https://www.cve.org/CVERecord?id=CVE-2020-10023)[ï](#cve-2020-10023 "Link to this heading")

Shell Subsystem Contains a Buffer Overflow Vulnerability In
shell\_spaces\_trim

The shell subsystem contains a buffer overflow, whereby an adversary
with physical access to the device is able to cause a memory
corruption, resulting in denial of service or possibly code execution
within the Zephyr kernel.

See NCC-ZEP-019

This has been fixed in releases v1.14.2, v2.2.0, and in a branch from
v2.1.0,

* [Zephyr project bug tracker ZEPSEC-29](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-29)
* [PR23646 fix for v1.14.2](https://github.com/zephyrproject-rtos/zephyr/pull/23646)
* [PR23649 fix for branch from v2.1.0](https://github.com/zephyrproject-rtos/zephyr/pull/23649)
* [PR23304 fix for v2.2.0](https://github.com/zephyrproject-rtos/zephyr/pull/23304)

### [**CVE 2020-10024**](https://www.cve.org/CVERecord?id=CVE-2020-10024)[ï](#cve-2020-10024 "Link to this heading")

ARM Platform Uses Signed Integer Comparison When Validating Syscall
Numbers

The arm platform-specific code uses a signed integer comparison when
validating system call numbers. An attacker who has obtained code
execution within a user thread is able to elevate privileges to that
of the kernel.

See NCC-ZEP-001

This has been fixed in releases v1.14.2, and v2.2.0, and in a branch
from v2.1.0,

* [Zephyr project bug tracker ZEPSEC-30](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-30)
* [PR23535 fix for v1.14.2](https://github.com/zephyrproject-rtos/zephyr/pull/23535)
* [PR23498 fix for branch from v2.1.0](https://github.com/zephyrproject-rtos/zephyr/pull/23498)
* [PR23323 fix for v2.2.0](https://github.com/zephyrproject-rtos/zephyr/pull/23323)

### [**CVE 2020-10027**](https://www.cve.org/CVERecord?id=CVE-2020-10027)[ï](#cve-2020-10027 "Link to this heading")

ARC Platform Uses Signed Integer Comparison When Validating Syscall
Numbers

An attacker who has obtained code execution within a user thread is
able to elevate privileges to that of the kernel.

See NCC-ZEP-001

This has been fixed in releases v1.14.2, and v2.2.0, and in a branch
from v2.1.0.

* [Zephyr project bug tracker ZEPSEC-35](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-35)
* [PR23500 fix for v1.14.2](https://github.com/zephyrproject-rtos/zephyr/pull/23500)
* [PR23499 fix for branch from v2.1.0](https://github.com/zephyrproject-rtos/zephyr/pull/23499)
* [PR23328 fix for v2.2.0](https://github.com/zephyrproject-rtos/zephyr/pull/23328)

### [**CVE 2020-10028**](https://www.cve.org/CVERecord?id=CVE-2020-10028)[ï](#cve-2020-10028 "Link to this heading")

Multiple Syscalls In GPIO Subsystem Performs No Argument Validation

Multiple syscalls with insufficient argument validation

See NCC-ZEP-006

This has been fixed in releases v1.14.2, and v2.2.0, and in a branch
from v2.1.0.

* [Zephyr project bug tracker ZEPSEC-32](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-32)
* [PR23733 fix for v1.14.2](https://github.com/zephyrproject-rtos/zephyr/pull/23733)
* [PR23737 fix for branch from v2.1.0](https://github.com/zephyrproject-rtos/zephyr/pull/23737)
* [PR23308 fix for v2.2.0 (gpio patch)](https://github.com/zephyrproject-rtos/zephyr/pull/23308)

### [**CVE 2020-10058**](https://www.cve.org/CVERecord?id=CVE-2020-10058)[ï](#cve-2020-10058 "Link to this heading")

Multiple Syscalls In kscan Subsystem Performs No Argument Validation

Multiple syscalls in the Kscan subsystem perform insufficient argument
validation, allowing code executing in userspace to potentially gain
elevated privileges.

See NCC-ZEP-006

This has been fixed in a branch from v2.1.0, and release v2.2.0.

* [Zephyr project bug tracker ZEPSEC-34](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-34)
* [PR23748 fix for branch from v2.1.0](https://github.com/zephyrproject-rtos/zephyr/pull/23748)
* [PR23308 fix for v2.2.0 (kscan patch)](https://github.com/zephyrproject-rtos/zephyr/pull/23308)

### [**CVE 2020-10059**](https://www.cve.org/CVERecord?id=CVE-2020-10059)[ï](#cve-2020-10059 "Link to this heading")

UpdateHub Module Explicitly Disables TLS Verification

The UpdateHub module disables DTLS peer checking, which allows for a
man in the middle attack. This is mitigated by firmware images
requiring valid signatures. However, there is no benefit to using DTLS
without the peer checking.

See NCC-ZEP-018

This has been fixed in a PR against Zephyr main.

* [Zephyr project bug tracker ZEPSEC-36](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-36)
* [PR24954 fix on main (to be fixed in v2.3.0)](https://github.com/zephyrproject-rtos/zephyr/pull/24954)
* [PR24954 fix v2.1.0](https://github.com/zephyrproject-rtos/zephyr/pull/24999)
* [PR24954 fix v2.2.0](https://github.com/zephyrproject-rtos/zephyr/pull/24997)

### [**CVE 2020-10060**](https://www.cve.org/CVERecord?id=CVE-2020-10060)[ï](#cve-2020-10060 "Link to this heading")

UpdateHub Might Dereference An Uninitialized Pointer

In updatehub\_probe, right after JSON parsing is complete, objects[1]
is accessed from the output structure in two different places. If the
JSON contained less than two elements, this access would reference
uninitialized stack memory. This could result in a crash, denial of
service, or possibly an information leak.

Recommend disabling updatehub until such a time as a fix can be made
available.

See NCC-ZEP-030

This has been fixed in a PR against Zephyr main.

* [Zephyr project bug tracker ZEPSEC-37](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-37)
* [PR27865 fix on main (to be fixed in v2.4.0)](https://github.com/zephyrproject-rtos/zephyr/pull/27865)
* [PR27865 fix for v2.3.0](https://github.com/zephyrproject-rtos/zephyr/pull/27889)
* [PR27865 fix for v2.2.0](https://github.com/zephyrproject-rtos/zephyr/pull/27891)
* [PR27865 fix for v2.1.0](https://github.com/zephyrproject-rtos/zephyr/pull/27893)

### [**CVE 2020-10061**](https://www.cve.org/CVERecord?id=CVE-2020-10061)[ï](#cve-2020-10061 "Link to this heading")

Error handling invalid packet sequence

Improper handling of the full-buffer case in the Zephyr Bluetooth
implementation can result in memory corruption.

This has been fixed in branches for v1.14.0, v2.2.0, and will be
included in v2.3.0.

* [Zephyr project bug tracker ZEPSEC-75](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-75)
* [PR23516 fix for v2.3 (split driver)](https://github.com/zephyrproject-rtos/zephyr/pull/23516)
* [PR23517 fix for v2.3 (legacy driver)](https://github.com/zephyrproject-rtos/zephyr/pull/23517)
* [PR23091 fix for branch from v1.14.0](https://github.com/zephyrproject-rtos/zephyr/pull/23091)
* [PR23547 fix for branch from v2.2.0](https://github.com/zephyrproject-rtos/zephyr/pull/23547)

### [**CVE 2020-10062**](https://www.cve.org/CVERecord?id=CVE-2020-10062)[ï](#cve-2020-10062 "Link to this heading")

Packet length decoding error in MQTT

CVE: An off-by-one error in the Zephyr project MQTT packet length
decoder can result in memory corruption and possible remote code
execution. NCC-ZEP-031

The MQTT packet header length can be 1 to 4 bytes. An off-by-one error
in the code can result in this being interpreted as 5 bytes, which can
cause an integer overflow, resulting in memory corruption.

This has been fixed in main for v2.3.

* [Zephyr project bug tracker ZEPSEC-84](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-84)
* [commit 11b7a37d for v2.3](https://github.com/zephyrproject-rtos/zephyr/pull/23821/commits/11b7a37d9a0b438270421b224221d91929843de4)
* [NCC-ZEP report](https://research.nccgroup.com/2020/05/26/research-report-zephyr-and-mcuboot-security-assessment) (NCC-ZEP-031)

### [**CVE 2020-10063**](https://www.cve.org/CVERecord?id=CVE-2020-10063)[ï](#cve-2020-10063 "Link to this heading")

Remote Denial of Service in CoAP Option Parsing Due To Integer
Overflow

A remote adversary with the ability to send arbitrary CoAP packets to
be parsed by Zephyr is able to cause a denial of service.

This has been fixed in main for v2.3.

* [Zephyr project bug tracker ZEPSEC-55](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-55)
* [PR24435 fix in main for v2.3](https://github.com/zephyrproject-rtos/zephyr/pull/24435)
* [PR24531 fix for branch from v2.2](https://github.com/zephyrproject-rtos/zephyr/pull/24531)
* [PR24535 fix for branch from v2.1](https://github.com/zephyrproject-rtos/zephyr/pull/24535)
* [PR24530 fix for branch from v1.14](https://github.com/zephyrproject-rtos/zephyr/pull/24530)
* [NCC-ZEP report](https://research.nccgroup.com/2020/05/26/research-report-zephyr-and-mcuboot-security-assessment) (NCC-ZEP-032)

### [**CVE 2020-10064**](https://www.cve.org/CVERecord?id=CVE-2020-10064)[ï](#cve-2020-10064 "Link to this heading")

Improper Input Frame Validation in ieee802154 Processing

* [Zephyr project bug tracker ZEPSEC-65](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-65)
* [PR24971 fix for v2.4](https://github.com/zephyrproject-rtos/zephyr/pull/24971)
* [PR33451 fix for v1.4](https://github.com/zephyrproject-rtos/zephyr/pull/33451)

### [**CVE 2020-10065**](https://www.cve.org/CVERecord?id=CVE-2020-10065)[ï](#cve-2020-10065 "Link to this heading")

OOB Write after not validating user-supplied length (<= 0xffff) and
copying to fixed-size buffer (default: 77 bytes) for HCI\_ACL packets in
bluetooth HCI over SPI driver.

* [Zephyr project bug tracker ZEPSEC-66](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-66)
* This issue has not been fixed.

### [**CVE 2020-10066**](https://www.cve.org/CVERecord?id=CVE-2020-10066)[ï](#cve-2020-10066 "Link to this heading")

Incorrect Error Handling in Bluetooth HCI core

In hci\_cmd\_done, the buf argument being passed as null causes
nullpointer dereference.

* [Zephyr project bug tracker ZEPSEC-67](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-67)
* [PR24902 fix for v2.4](https://github.com/zephyrproject-rtos/zephyr/pull/24902)
* [PR25089 fix for v1.4](https://github.com/zephyrproject-rtos/zephyr/pull/25089)

### [**CVE 2020-10067**](https://www.cve.org/CVERecord?id=CVE-2020-10067)[ï](#cve-2020-10067 "Link to this heading")

Integer Overflow In is\_in\_region Allows User Thread To Access Kernel Memory

A malicious userspace application can cause a integer overflow and
bypass security checks performed by system call handlers. The impact
would depend on the underlying system call and can range from denial
of service to information leak to memory corruption resulting in code
execution within the kernel.

See NCC-ZEP-005

This has been fixed in releases v1.14.2, and v2.2.0.

* [Zephyr project bug tracker ZEPSEC-27](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-27)
* [PR23653 fix for v1.14.2](https://github.com/zephyrproject-rtos/zephyr/pull/23653)
* [PR23654 fix for the v2.1 branch](https://github.com/zephyrproject-rtos/zephyr/pull/23654)
* [PR23239 fix for v2.2.0](https://github.com/zephyrproject-rtos/zephyr/pull/23239)

### [**CVE 2020-10068**](https://www.cve.org/CVERecord?id=CVE-2020-10068)[ï](#cve-2020-10068 "Link to this heading")

Zephyr Bluetooth DLE duplicate requests vulnerability

In the Zephyr project Bluetooth subsystem, certain duplicate and
back-to-back packets can cause incorrect behavior, resulting in a
denial of service.

This has been fixed in branches for v1.14.0, v2.2.0, and will be
included in v2.3.0.

* [Zephyr project bug tracker ZEPSEC-78](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-78)
* [PR23707 fix for v2.3 (split driver)](https://github.com/zephyrproject-rtos/zephyr/pull/23707)
* [PR23708 fix for v2.3 (legacy driver)](https://github.com/zephyrproject-rtos/zephyr/pull/23708)
* [PR23091 fix for branch from v1.14.0](https://github.com/zephyrproject-rtos/zephyr/pull/23091)
* [PR23964 fix for v2.2.0](https://github.com/zephyrproject-rtos/zephyr/pull/23964)

### [**CVE 2020-10069**](https://www.cve.org/CVERecord?id=CVE-2020-10069)[ï](#cve-2020-10069 "Link to this heading")

Zephyr Bluetooth unchecked packet data results in denial of service

An unchecked parameter in bluetooth data can result in an assertion
failure, or division by zero, resulting in a denial of service attack.

This has been fixed in branches for v1.14.0, v2.2.0, and will be
included in v2.3.0.

* [Zephyr project bug tracker ZEPSEC-81](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-81)
* [PR23705 fix for v2.3 (split driver)](https://github.com/zephyrproject-rtos/zephyr/pull/23705)
* [PR23706 fix for v2.3 (legacy driver)](https://github.com/zephyrproject-rtos/zephyr/pull/23706)
* [PR23091 fix for branch from v1.14.0](https://github.com/zephyrproject-rtos/zephyr/pull/23091)
* [PR23963 fix for branch from v2.2.0](https://github.com/zephyrproject-rtos/zephyr/pull/23963)

### [**CVE 2020-10070**](https://www.cve.org/CVERecord?id=CVE-2020-10070)[ï](#cve-2020-10070 "Link to this heading")

MQTT buffer overflow on receive buffer

In the Zephyr Project MQTT code, improper bounds checking can result
in memory corruption and possibly remote code execution. NCC-ZEP-031

When calculating the packet length, arithmetic overflow can result in
accepting a receive buffer larger than the available buffer space,
resulting in user data being written beyond this buffer.

This has been fixed in main for v2.3.

* [Zephyr project bug tracker ZEPSEC-85](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-85)
* [commit 0b39cbf3 for v2.3](https://github.com/zephyrproject-rtos/zephyr/pull/23821/commits/0b39cbf3c01d7feec9d0dd7cc7e0e374b6113542)
* [NCC-ZEP report](https://research.nccgroup.com/2020/05/26/research-report-zephyr-and-mcuboot-security-assessment) (NCC-ZEP-031)

### [**CVE 2020-10071**](https://www.cve.org/CVERecord?id=CVE-2020-10071)[ï](#cve-2020-10071 "Link to this heading")

Insufficient publish message length validation in MQTT

The Zephyr MQTT parsing code performs insufficient checking of the
length field on publish messages, allowing a buffer overflow and
potentially remote code execution. NCC-ZEP-031

This has been fixed in main for v2.3.

* [Zephyr project bug tracker ZEPSEC-86](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-86)
* [commit 989c4713 fix for v2.3](https://github.com/zephyrproject-rtos/zephyr/pull/23821/commits/989c4713ba429aa5105fe476b4d629718f3e6082)
* [NCC-ZEP report](https://research.nccgroup.com/2020/05/26/research-report-zephyr-and-mcuboot-security-assessment) (NCC-ZEP-031)

### [**CVE 2020-10072**](https://www.cve.org/CVERecord?id=CVE-2020-10072)[ï](#cve-2020-10072 "Link to this heading")

All threads can access all socket file descriptors

There is no management of permissions to network socket API file
descriptors. Any thread running on the system may read/write a socket
file descriptor knowing only the numerical value of the file
descriptor.

* [Zephyr project bug tracker ZEPSEC-87](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-87)
* [PR25804 fix for v2.4](https://github.com/zephyrproject-rtos/zephyr/pull/25804)
* [PR27176 fix for v1.4](https://github.com/zephyrproject-rtos/zephyr/pull/27176)

### [**CVE 2020-10136**](https://www.cve.org/CVERecord?id=CVE-2020-10136)[ï](#cve-2020-10136 "Link to this heading")

IP-in-IP protocol routes arbitrary traffic by default zephyrproject

* [Zephyr project bug tracker ZEPSEC-64](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-64)

### [**CVE 2020-13598**](https://www.cve.org/CVERecord?id=CVE-2020-13598)[ï](#cve-2020-13598 "Link to this heading")

FS: Buffer Overflow when enabling Long File Names in FAT\_FS and calling fs\_stat

Performing fs\_stat on a file with a filename longer than 12
characters long will cause a buffer overflow.

* [Zephyr project bug tracker ZEPSEC-88](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-88)
* [PR25852 fix for v2.4](https://github.com/zephyrproject-rtos/zephyr/pull/25852)
* [PR28782 fix for v2.3](https://github.com/zephyrproject-rtos/zephyr/pull/28782)
* [PR33577 fix for v1.4](https://github.com/zephyrproject-rtos/zephyr/pull/33577)

### [**CVE 2020-13599**](https://www.cve.org/CVERecord?id=CVE-2020-13599)[ï](#cve-2020-13599 "Link to this heading")

Security problem with settings and littlefs

When settings is used in combination with littlefs all security
related information can be extracted from the device using MCUmgr and
this could be used e.g in bt-mesh to get the device key, network key,
app keys from the device.

* [Zephyr project bug tracker ZEPSEC-57](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-57)
* [PR26083 fix for v2.4](https://github.com/zephyrproject-rtos/zephyr/pull/26083)

### [**CVE 2020-13600**](https://www.cve.org/CVERecord?id=CVE-2020-13600)[ï](#cve-2020-13600 "Link to this heading")

Malformed SPI in response for eswifi can corrupt kernel memory

* [Zephyr project bug tracker ZEPSEC-91](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-91)
* [PR26712 fix for v2.4](https://github.com/zephyrproject-rtos/zephyr/pull/26712)

### [**CVE 2020-13601**](https://www.cve.org/CVERecord?id=CVE-2020-13601)[ï](#cve-2020-13601 "Link to this heading")

Possible read out of bounds in dns read

* [Zephyr project bug tracker ZEPSEC-92](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-92)
* [PR27774 fix for v2.4](https://github.com/zephyrproject-rtos/zephyr/pull/27774)
* [PR30503 fix for v1.4](https://github.com/zephyrproject-rtos/zephyr/pull/30503)

### [**CVE 2020-13602**](https://www.cve.org/CVERecord?id=CVE-2020-13602)[ï](#cve-2020-13602 "Link to this heading")

Remote Denial of Service in LwM2M do\_write\_op\_tlv

In the Zephyr LwM2M implementation, malformed input can result in an
infinite loop, resulting in a denial of service attack.

* [Zephyr project bug tracker ZEPSEC-56](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-56)
* [PR26571 fix for v2.4](https://github.com/zephyrproject-rtos/zephyr/pull/26571)
* [PR33578 fix for v1.4](https://github.com/zephyrproject-rtos/zephyr/pull/33578)

### [**CVE 2020-13603**](https://www.cve.org/CVERecord?id=CVE-2020-13603)[ï](#cve-2020-13603 "Link to this heading")

Possible overflow in mempool

> * Zephyr offers pre-built âmallocâ wrapper function instead.
> * The âmallocâ function is wrapper for the âsys\_mem\_pool\_allocâ function
> * sys\_mem\_pool\_alloc allocates âsize + WB\_UP(sizeof(struct sys\_mem\_pool\_block))â in an unsafe manner.
> * Asking for very large size values leads to internal integer wrap-around.
> * Integer wrap-around leads to successful allocation of very small memory.
> * For example: calling malloc(0xffffffff) leads to successful allocation of 7 bytes.
> * That leads to heap overflow.

* [Zephyr project bug tracker ZEPSEC-111](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-111)
* [PR31796 fix for v2.4](https://github.com/zephyrproject-rtos/zephyr/pull/31796)
* [PR32808 fix for v1.4](https://github.com/zephyrproject-rtos/zephyr/pull/26571)

## CVE-2021[ï](#cve-2021 "Link to this heading")

### [**CVE 2021-3319**](https://www.cve.org/CVERecord?id=CVE-2021-3319)[ï](#cve-2021-3319 "Link to this heading")

DOS: Incorrect 802154 Frame Validation for Omitted Source / Dest Addresses

Improper processing of omitted source and destination addresses in
ieee802154 frame validation (ieee802154\_validate\_frame)

This has been fixed in main for v2.5.0

* [Zephyr project bug tracker GHSA-94jg-2p6q-5364](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-94jg-2p6q-5364)
* [PR31908 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/31908)

### [**CVE 2021-3320**](https://www.cve.org/CVERecord?id=CVE-2021-3320)[ï](#cve-2021-3320 "Link to this heading")

Mismatch between validation and handling of 802154 ACK frames, where
ACK frames are considered during validation, but not during actual
processing, leading to a type confusion.

* [PR31908 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/31908)

### [**CVE 2021-3321**](https://www.cve.org/CVERecord?id=CVE-2021-3321)[ï](#cve-2021-3321 "Link to this heading")

Incomplete check of minimum IEEE 802154 fragment size leading to an
integer underflow.

* [Zephyr project bug tracker ZEPSEC-114](https://zephyrprojectsec.atlassian.net/browse/ZEPSEC-114)
* [PR33453 fix for v2.4](https://github.com/zephyrproject-rtos/zephyr/pull/33453)

### [**CVE 2021-3323**](https://www.cve.org/CVERecord?id=CVE-2021-3323)[ï](#cve-2021-3323 "Link to this heading")

Integer Underflow in 6LoWPAN IPHC Header Uncompression

This has been fixed in main for v2.5.0

* [Zephyr project bug tracker GHSA-89j6-qpxf-pfpc](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-89j6-qpxf-pfpc)
* [PR 31971 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/31971)

### [**CVE 2021-3430**](https://www.cve.org/CVERecord?id=CVE-2021-3430)[ï](#cve-2021-3430 "Link to this heading")

Assertion reachable with repeated LL\_CONNECTION\_PARAM\_REQ.

This has been fixed in main for v2.6.0

* [Zephyr project bug tracker GHSA-46h3-hjcq-2jjr](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-46h3-hjcq-2jjr)
* [PR 33272 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/33272)
* [PR 33369 fix for 2.5](https://github.com/zephyrproject-rtos/zephyr/pull/33369)
* [PR 33759 fix for 1.14.2](https://github.com/zephyrproject-rtos/zephyr/pull/33759)

### [**CVE 2021-3431**](https://www.cve.org/CVERecord?id=CVE-2021-3431)[ï](#cve-2021-3431 "Link to this heading")

BT: Assertion failure on repeated LL\_FEATURE\_REQ

This has been fixed in main for v2.6.0

* [Zephyr project bug tracker GHSA-7548-5m6f-mqv9](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-7548-5m6f-mqv9)
* [PR 33340 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/33340)
* [PR 33369 fix for 2.5](https://github.com/zephyrproject-rtos/zephyr/pull/33369)

### [**CVE 2021-3432**](https://www.cve.org/CVERecord?id=CVE-2021-3432)[ï](#cve-2021-3432 "Link to this heading")

Invalid interval in CONNECT\_IND leads to Division by Zero

This has been fixed in main for v2.6.0

* [Zephyr project bug tracker GHSA-7364-p4wc-8mj4](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-7364-p4wc-8mj4)
* [PR 33278 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/33278)
* [PR 33369 fix for 2.5](https://github.com/zephyrproject-rtos/zephyr/pull/33369)

### [**CVE 2021-3433**](https://www.cve.org/CVERecord?id=CVE-2021-3433)[ï](#cve-2021-3433 "Link to this heading")

BT: Invalid channel map in CONNECT\_IND results to Deadlock

This has been fixed in main for v2.6.0

* [Zephyr project bug tracker GHSA-3c2f-w4v6-qxrp](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-3c2f-w4v6-qxrp)
* [PR 33278 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/33278)
* [PR 33369 fix for 2.5](https://github.com/zephyrproject-rtos/zephyr/pull/33369)

### [**CVE 2021-3434**](https://www.cve.org/CVERecord?id=CVE-2021-3434)[ï](#cve-2021-3434 "Link to this heading")

L2CAP: Stack based buffer overflow in le\_ecred\_conn\_req()

This has been fixed in main for v2.6.0

* [Zephyr project bug tracker GHSA-8w87-6rfp-cfrm](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-8w87-6rfp-cfrm)
* [PR 33305 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/33305)
* [PR 33419 fix for 2.5](https://github.com/zephyrproject-rtos/zephyr/pull/33419)
* [PR 33418 fix for 1.14.2](https://github.com/zephyrproject-rtos/zephyr/pull/33418)

### [**CVE 2021-3435**](https://www.cve.org/CVERecord?id=CVE-2021-3435)[ï](#cve-2021-3435 "Link to this heading")

L2CAP: Information leakage in le\_ecred\_conn\_req()

This has been fixed in main for v2.6.0

* [Zephyr project bug tracker GHSA-xhg3-gvj6-4rqh](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-xhg3-gvj6-4rqh)
* [PR 33305 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/33305)
* [PR 33419 fix for 2.5](https://github.com/zephyrproject-rtos/zephyr/pull/33419)
* [PR 33418 fix for 1.14.2](https://github.com/zephyrproject-rtos/zephyr/pull/33418)

### [**CVE 2021-3436**](https://www.cve.org/CVERecord?id=CVE-2021-3436)[ï](#cve-2021-3436 "Link to this heading")

Bluetooth: Possible to overwrite an existing bond during keys
distribution phase when the identity address of the bond is known

During the distribution of the identity address information we donât
check for an existing bond with the same identity address.This means
that a duplicate entry will be created in RAM while the newest entry
will overwrite the existing one in persistent storage.

This has been fixed in main for v2.6.0

* [Zephyr project bug tracker GHSA-j76f-35mc-4h63](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-j76f-35mc-4h63)
* [PR 33266 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/33266)
* [PR 33432 fix for 2.5](https://github.com/zephyrproject-rtos/zephyr/pull/33432)
* [PR 33433 fix for 2.4](https://github.com/zephyrproject-rtos/zephyr/pull/33433)
* [PR 33718 fix for 1.14.2](https://github.com/zephyrproject-rtos/zephyr/pull/33718)

### [**CVE 2021-3454**](https://www.cve.org/CVERecord?id=CVE-2021-3454)[ï](#cve-2021-3454 "Link to this heading")

Truncated L2CAP K-frame causes assertion failure

For example, sending L2CAP K-frame where SDU length field is truncated
to only one byte, causes assertion failure in previous releases of
Zephyr. This has been fixed in master by commit 0ba9437 but has not
yet been backported to older release branches.

This has been fixed in main for v2.6.0

* [Zephyr project bug tracker GHSA-fx88-6c29-vrp3](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-fx88-6c29-vrp3)
* [PR 32588 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/32588)
* [PR 33513 fix for 2.5](https://github.com/zephyrproject-rtos/zephyr/pull/33513)
* [PR 33514 fix for 2.4](https://github.com/zephyrproject-rtos/zephyr/pull/33514)

### [**CVE 2021-3455**](https://www.cve.org/CVERecord?id=CVE-2021-3455)[ï](#cve-2021-3455 "Link to this heading")

Disconnecting L2CAP channel right after invalid ATT request leads freeze

When Central device connects to peripheral and creates L2CAP
connection for Enhanced ATT, sending some invalid ATT request and
disconnecting immediately causes freeze.

This has been fixed in main for v2.6.0

* [Zephyr project bug tracker GHSA-7g38-3x9v-v7vp](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-7g38-3x9v-v7vp)
* [PR 35597 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/35597)
* [PR 36104 fix for 2.5](https://github.com/zephyrproject-rtos/zephyr/pull/36104)
* [PR 36105 fix for 2.4](https://github.com/zephyrproject-rtos/zephyr/pull/36105)

### [**CVE 2021-3510**](https://www.cve.org/CVERecord?id=CVE-2021-3510)[ï](#cve-2021-3510 "Link to this heading")

Zephyr JSON decoder incorrectly decodes array of array

When using JSON\_OBJ\_DESCR\_ARRAY\_ARRAY, the subarray is has the token
type JSON\_TOK\_LIST\_START, but then assigns to the object part of the
union. arr\_parse then takes the offset of the array-object (which has
nothing todo with the list) treats it as relative to the parent
object, and stores the length of the subarray in there.

This has been fixed in main for v2.7.0

* [Zephyr project bug tracker GHSA-289f-7mw3-2qf4](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-289f-7mw3-2qf4)
* [PR 36340 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/36340)
* [PR 37816 fix for 2.6](https://github.com/zephyrproject-rtos/zephyr/pull/37816)

### [**CVE 2021-3581**](https://www.cve.org/CVERecord?id=CVE-2021-3581)[ï](#cve-2021-3581 "Link to this heading")

HCI data not properly checked leads to memory overflow in the Bluetooth stack

In the process of setting SCAN\_RSP through the HCI command, the Zephyr
Bluetooth protocol stack did not effectively check the length of the
incoming HCI data. Causes memory overflow, and then the data in the
memory is overwritten, and may even cause arbitrary code execution.

This has been fixed in main for v2.6.0

* [Zephyr project bug tracker GHSA-8q65-5gqf-fmw5](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-8q65-5gqf-fmw5)
* [PR 35935 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/35935)
* [PR 35984 fix for 2.5](https://github.com/zephyrproject-rtos/zephyr/pull/35984)
* [PR 35985 fix for 2.4](https://github.com/zephyrproject-rtos/zephyr/pull/35985)
* [PR 35985 fix for 1.14](https://github.com/zephyrproject-rtos/zephyr/pull/35985)

### [**CVE 2021-3625**](https://www.cve.org/CVERecord?id=CVE-2021-3625)[ï](#cve-2021-3625 "Link to this heading")

Buffer overflow in Zephyr USB DFU DNLOAD

This has been fixed in main for v2.6.0

* [Zephyr project bug tracker GHSA-c3gr-hgvr-f363](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-c3gr-hgvr-f363)
* [PR 36694 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/36694)

### [**CVE 2021-3835**](https://www.cve.org/CVERecord?id=CVE-2021-3835)[ï](#cve-2021-3835 "Link to this heading")

Buffer overflow in Zephyr USB device class

This has been fixed in main for v3.0.0

* [Zephyr project bug tracker GHSA-fm6v-8625-99jf](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-fm6v-8625-99jf)
* [PR 42093 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/42093)
* [PR 42167 fix for 2.7](https://github.com/zephyrproject-rtos/zephyr/pull/42167)

### [**CVE 2021-3861**](https://www.cve.org/CVERecord?id=CVE-2021-3861)[ï](#cve-2021-3861 "Link to this heading")

Buffer overflow in the RNDIS USB device class

This has been fixed in main for v3.0.0

* [Zephyr project bug tracker GHSA-hvfp-w4h8-gxvj](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-hvfp-w4h8-gxvj)
* [PR 39725 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/39725)

### [**CVE 2021-3966**](https://www.cve.org/CVERecord?id=CVE-2021-3966)[ï](#cve-2021-3966 "Link to this heading")

Usb bluetooth device ACL read cb buffer overflow

This has been fixed in main for v3.0.0

* [Zephyr project bug tracker GHSA-hfxq-3w6x-fv2m](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-hfxq-3w6x-fv2m)
* [PR 42093 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/42093)
* [PR 42167 fix for v2.7.0](https://github.com/zephyrproject-rtos/zephyr/pull/42167)

## CVE-2022[ï](#cve-2022 "Link to this heading")

### [**CVE 2022-0553**](https://www.cve.org/CVERecord?id=CVE-2022-0553)[ï](#cve-2022-0553 "Link to this heading")

Possible to retrieve unencrypted firmware image

This has been fixed in main for v3.0.0

* [Zephyr project bug tracker GHSA-wrj2-9vj9-rrcp](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-wrj2-9vj9-rrcp)
* [PR 42424 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/42424)

### [**CVE 2022-1041**](https://www.cve.org/CVERecord?id=CVE-2022-1041)[ï](#cve-2022-1041 "Link to this heading")

Out-of-bound write vulnerability in the Bluetooth Mesh core stack can be triggered during provisioning

This has been fixed in main for v3.1.0

* [Zephyr project bug tracker GHSA-p449-9hv9-pj38](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-p449-9hv9-pj38)
* [PR 45136 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/45136)
* [PR 45188 fix for v3.0.0](https://github.com/zephyrproject-rtos/zephyr/pull/45188)
* [PR 45187 fix for v2.7.0](https://github.com/zephyrproject-rtos/zephyr/pull/45187)

### [**CVE 2022-1042**](https://www.cve.org/CVERecord?id=CVE-2022-1042)[ï](#cve-2022-1042 "Link to this heading")

Out-of-bound write vulnerability in the Bluetooth Mesh core stack can be triggered during provisioning

This has been fixed in main for v3.1.0

* [Zephyr project bug tracker GHSA-j7v7-w73r-mm5x](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-j7v7-w73r-mm5x)
* [PR 45066 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/45066)
* [PR 45135 fix for v3.0.0](https://github.com/zephyrproject-rtos/zephyr/pull/45135)
* [PR 45134 fix for v2.7.0](https://github.com/zephyrproject-rtos/zephyr/pull/45134)

### [**CVE 2022-1841**](https://www.cve.org/CVERecord?id=CVE-2022-1841)[ï](#cve-2022-1841 "Link to this heading")

Out-of-Bound Write in tcp\_flags

This has been fixed in main for v3.1.0

* [Zephyr project bug tracker GHSA-5c3j-p8cr-2pgh](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-5c3j-p8cr-2pgh)
* [PR 45796 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/45796)

### [**CVE 2022-2741**](https://www.cve.org/CVERecord?id=CVE-2022-2741)[ï](#cve-2022-2741 "Link to this heading")

can: denial-of-service can be triggered by a crafted CAN frame

This has been fixed in main for v3.2.0

* [Zephyr project bug tracker GHSA-hx5v-j59q-c3j8](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-hx5v-j59q-c3j8)
* [PR 47903 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/47903)
* [PR 47957 fix for v3.1.0](https://github.com/zephyrproject-rtos/zephyr/pull/47957)
* [PR 47958 fix for v3.0.0](https://github.com/zephyrproject-rtos/zephyr/pull/47958)
* [PR 47959 fix for v2.7.0](https://github.com/zephyrproject-rtos/zephyr/pull/47959)

### [**CVE 2022-2993**](https://www.cve.org/CVERecord?id=CVE-2022-2993)[ï](#cve-2022-2993 "Link to this heading")

bt: host: Wrong key validation check

This has been fixed in main for v3.2.0

* [Zephyr project bug tracker GHSA-3286-jgjx-8cvr](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-3286-jgjx-8cvr)
* [PR 48733 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/48733)

### [**CVE 2022-3806**](https://www.cve.org/CVERecord?id=CVE-2022-3806)[ï](#cve-2022-3806 "Link to this heading")

DoS: Invalid Initialization in le\_read\_buffer\_size\_complete()

* [Zephyr project bug tracker GHSA-w525-fm68-ppq3](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-w525-fm68-ppq3)

## CVE-2023[ï](#cve-2023 "Link to this heading")

### [**CVE 2023-0396**](https://www.cve.org/CVERecord?id=CVE-2023-0396)[ï](#cve-2023-0396 "Link to this heading")

Buffer Overreads in Bluetooth HCI

* [Zephyr project bug tracker GHSA-8rpp-6vxq-pqg3](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-8rpp-6vxq-pqg3)

### [**CVE 2023-0397**](https://www.cve.org/CVERecord?id=CVE-2023-0397)[ï](#cve-2023-0397 "Link to this heading")

DoS: Invalid Initialization in le\_read\_buffer\_size\_complete()

* [Zephyr project bug tracker GHSA-wc2h-h868-q7hj](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-wc2h-h868-q7hj)

This has been fixed in main for v3.3.0

* [PR 54905 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/54905)
* [PR 47957 fix for v3.2.0](https://github.com/zephyrproject-rtos/zephyr/pull/55024)
* [PR 47958 fix for v3.1.0](https://github.com/zephyrproject-rtos/zephyr/pull/55023)
* [PR 47959 fix for v2.7.4](https://github.com/zephyrproject-rtos/zephyr/pull/55022)

### [**CVE 2023-0779**](https://www.cve.org/CVERecord?id=CVE-2023-0779)[ï](#cve-2023-0779 "Link to this heading")

net: shell: Improper input validation

* [Zephyr project bug tracker GHSA-9xj8-6989-r549](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-9xj8-6989-r549)

This has been fixed in main for v3.3.0

* [PR 54371 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/54371)
* [PR 54380 fix for v3.2.0](https://github.com/zephyrproject-rtos/zephyr/pull/54380)
* [PR 54381 fix for v2.7.4](https://github.com/zephyrproject-rtos/zephyr/pull/54381)

### [**CVE 2023-1901**](https://www.cve.org/CVERecord?id=CVE-2023-1901)[ï](#cve-2023-1901 "Link to this heading")

HCI send\_sync Dangling Semaphore Reference Re-use

* [Zephyr project bug tracker GHSA-xvvm-8mcm-9cq3](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-xvvm-8mcm-9cq3)

This has been fixed in main for v3.4.0

* [PR 56709 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/56709)

### [**CVE 2023-1902**](https://www.cve.org/CVERecord?id=CVE-2023-1902)[ï](#cve-2023-1902 "Link to this heading")

HCI Connection Creation Dangling State Reference Re-use

* [Zephyr project bug tracker GHSA-fx9g-8fr2-q899](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-fx9g-8fr2-q899)

This has been fixed in main for v3.4.0

* [PR 56709 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/56709)

### [**CVE 2023-3725**](https://www.cve.org/CVERecord?id=CVE-2023-3725)[ï](#cve-2023-3725 "Link to this heading")

Potential buffer overflow vulnerability in the Zephyr CANbus subsystem.

* [Zephyr project bug tracker GHSA-2g3m-p6c7-8rr3](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-2g3m-p6c7-8rr3)

This has been fixed in main for v3.5.0

* [PR 61502 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/61502)
* [PR 61518 fix for 3.4](https://github.com/zephyrproject-rtos/zephyr/pull/61518)
* [PR 61517 fix for 3.3](https://github.com/zephyrproject-rtos/zephyr/pull/61517)
* [PR 61516 fix for 2.7](https://github.com/zephyrproject-rtos/zephyr/pull/61516)

### [**CVE 2023-4257**](https://www.cve.org/CVERecord?id=CVE-2023-4257)[ï](#cve-2023-4257 "Link to this heading")

Unchecked user input length in the Zephyr WiFi shell module can cause
buffer overflows.

* [Zephyr project bug tracker GHSA-853q-q69w-gf5j](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-853q-q69w-gf5j)

This has been fixed in main for v3.5.0

* [PR 605377 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/605377)
* [PR 61383 fix for 3.4](https://github.com/zephyrproject-rtos/zephyr/pull/61383)

### [**CVE 2023-4258**](https://www.cve.org/CVERecord?id=CVE-2023-4258)[ï](#cve-2023-4258 "Link to this heading")

bt: mesh: vulnerability in provisioning protocol implementation on provisionee side

* [Zephyr project bug tracker GHSA-m34c-cp63-rwh7](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-m34c-cp63-rwh7)

This has been fixed in main for v3.5.0

* [PR 59467 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/59467)
* [PR 60078 fix for 3.4](https://github.com/zephyrproject-rtos/zephyr/pull/60078)
* [PR 60079 fix for 3.3](https://github.com/zephyrproject-rtos/zephyr/pull/60079)

### [**CVE 2023-4259**](https://www.cve.org/CVERecord?id=CVE-2023-4259)[ï](#cve-2023-4259 "Link to this heading")

Buffer overflow vulnerabilities in the Zephyr eS-WiFi driver

* [Zephyr project bug tracker GHSA-gghm-c696-f4j4](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-gghm-c696-f4j4)

This has been fixed in main for v3.5.0

* [PR 63074 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/63074)
* [PR 63750 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/63750)

### [**CVE 2023-4260**](https://www.cve.org/CVERecord?id=CVE-2023-4260)[ï](#cve-2023-4260 "Link to this heading")

Off-by-one buffer overflow vulnerability in the Zephyr FS subsystem

* [Zephyr project bug tracker GHSA-gj27-862r-55wh](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-gj27-862r-55wh)

This has been fixed in main for v3.5.0

* [PR 63079 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/63079)

### [**CVE 2023-4262**](https://www.cve.org/CVERecord?id=CVE-2023-4262)[ï](#cve-2023-4262 "Link to this heading")

* This issue has been determined to be a false positive after further analysis.

### [**CVE 2023-4263**](https://www.cve.org/CVERecord?id=CVE-2023-4263)[ï](#cve-2023-4263 "Link to this heading")

Potential buffer overflow vulnerability in the Zephyr IEEE 802.15.4 nRF 15.4 driver.

* [Zephyr project bug tracker GHSA-rf6q-rhhp-pqhf](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-rf6q-rhhp-pqhf)

This has been fixed in main for v3.5.0

* [PR 60528 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/60528)
* [PR 61384 fix for 3.4](https://github.com/zephyrproject-rtos/zephyr/pull/61384)
* [PR 61216 fix for 2.7](https://github.com/zephyrproject-rtos/zephyr/pull/61216)

### [**CVE 2023-4264**](https://www.cve.org/CVERecord?id=CVE-2023-4264)[ï](#cve-2023-4264 "Link to this heading")

Potential buffer overflow vulnerabilities in the Zephyr Bluetooth subsystem

* [Zephyr project bug tracker GHSA-rgx6-3w4j-gf5j](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-rgx6-3w4j-gf5j)

This has been fixed in main for v3.5.0

* [PR 58834 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/58834)
* [PR 60465 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/60465)
* [PR 61845 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/61845)
* [PR 61385 fix for 3.4](https://github.com/zephyrproject-rtos/zephyr/pull/61385)

### [**CVE 2023-4265**](https://www.cve.org/CVERecord?id=CVE-2023-4265)[ï](#cve-2023-4265 "Link to this heading")

Two potential buffer overflow vulnerabilities in Zephyr USB code

* [Zephyr project bug tracker GHSA-4vgv-5r6q-r6xh](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-4vgv-5r6q-r6xh)

This has been fixed in main for v3.4.0

* [PR 59157 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/59157)
* [PR 59018 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/59018)

### [**CVE 2023-4424**](https://www.cve.org/CVERecord?id=CVE-2023-4424)[ï](#cve-2023-4424 "Link to this heading")

bt: hci: DoS and possible RCE

* [Zephyr project bug tracker GHSA-j4qm-xgpf-qjw3](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-j4qm-xgpf-qjw3)

This has been fixed in main for v3.5.0

* [PR 61651 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/61651)
* [PR 61696 fix for 3.4](https://github.com/zephyrproject-rtos/zephyr/pull/61696)
* [PR 61695 fix for 3.3](https://github.com/zephyrproject-rtos/zephyr/pull/61695)
* [PR 61694 fix for 2.7](https://github.com/zephyrproject-rtos/zephyr/pull/61694)

### [**CVE 2023-5055**](https://www.cve.org/CVERecord?id=CVE-2023-5055)[ï](#cve-2023-5055 "Link to this heading")

L2CAP: Possible Stack based buffer overflow in le\_ecred\_reconf\_req()

* [Zephyr project bug tracker GHSA-wr8r-7f8x-24jj](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-wr8r-7f8x-24jj)

This has been fixed in main for v3.5.0

* [PR 62381 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/62381)

### [**CVE 2023-5139**](https://www.cve.org/CVERecord?id=CVE-2023-5139)[ï](#cve-2023-5139 "Link to this heading")

Potential buffer overflow vulnerability in the Zephyr STM32 Crypto driver.

* [Zephyr project bug tracker GHSA-rhrc-pcxp-4453](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-rhrc-pcxp-4453)

This has been fixed in main for v3.5.0

* [PR 61839 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/61839)

### [**CVE 2023-5184**](https://www.cve.org/CVERecord?id=CVE-2023-5184)[ï](#cve-2023-5184 "Link to this heading")

Potential signed to unsigned conversion errors and buffer overflow
vulnerabilities in the Zephyr IPM driver

* [Zephyr project bug tracker GHSA-8x3p-q3r5-xh9g](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-8x3p-q3r5-xh9g)

This has been fixed in main for v3.5.0

* [PR 63069 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/63069)

### [**CVE 2023-5563**](https://www.cve.org/CVERecord?id=CVE-2023-5563)[ï](#cve-2023-5563 "Link to this heading")

The SJA1000 CAN controller driver backend automatically attempts to recover
from a bus-off event when built with CONFIG\_CAN\_AUTO\_BUS\_OFF\_RECOVERY=y. This
results in calling k\_sleep() in IRQ context, causing a fatal exception.

* [Zephyr project bug tracker GHSA-98mc-rj7w-7rpv](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-98mc-rj7w-7rpv)

This has been fixed in main for v3.5.0

* [PR 63713 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/63713)
* [PR 63718 fix for 3.4](https://github.com/zephyrproject-rtos/zephyr/pull/63718)
* [PR 63717 fix for 3.3](https://github.com/zephyrproject-rtos/zephyr/pull/63717)

### [**CVE 2023-5753**](https://www.cve.org/CVERecord?id=CVE-2023-5753)[ï](#cve-2023-5753 "Link to this heading")

Potential buffer overflow vulnerabilities in the Zephyr Bluetooth
subsystem source code when asserts are disabled.

* [Zephyr project bug tracker GHSA-hmpr-px56-rvww](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-hmpr-px56-rvww)

This has been fixed in main for v3.5.0

* [PR 63605 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/63605)

### [**CVE 2023-5779**](https://www.cve.org/CVERecord?id=CVE-2023-5779)[ï](#cve-2023-5779 "Link to this heading")

Out of bounds issue in remove\_rx\_filter in multiple can drivers.

* [Zephyr project bug tracker GHSA-7cmj-963q-jj47](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-7cmj-963q-jj47)

This has been fixed in main for v3.6.0

* [PR 64399 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/64399)
* [PR 64416 fix for 3.5](https://github.com/zephyrproject-rtos/zephyr/pull/64416)
* [PR 64415 fix for 3.4](https://github.com/zephyrproject-rtos/zephyr/pull/64415)
* [PR 64427 fix for 3.3](https://github.com/zephyrproject-rtos/zephyr/pull/64427)
* [PR 64431 fix for 2.7](https://github.com/zephyrproject-rtos/zephyr/pull/64431)

### [**CVE 2023-6249**](https://www.cve.org/CVERecord?id=CVE-2023-6249)[ï](#cve-2023-6249 "Link to this heading")

Signed to unsigned conversion problem in esp32\_ipm\_send may lead to buffer overflow

* [Zephyr project bug tracker GHSA-32f5-3p9h-2rqc](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-32f5-3p9h-2rqc)

This has been fixed in main for v3.6.0

* [PR 65546 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/65546)

### [**CVE 2023-6749**](https://www.cve.org/CVERecord?id=CVE-2023-6749)[ï](#cve-2023-6749 "Link to this heading")

Potential buffer overflow due unchecked data coming from user input in settings shell.

* [Zephyr project bug tracker GHSA-757h-rw37-66hw](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-757h-rw37-66hw)

This has been fixed in main for v3.6.0

* [PR 66451 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/66451)
* [PR 66584 fix for 3.5](https://github.com/zephyrproject-rtos/zephyr/pull/66584)

### [**CVE 2023-6881**](https://www.cve.org/CVERecord?id=CVE-2023-6881)[ï](#cve-2023-6881 "Link to this heading")

Potential buffer overflow vulnerability in Zephyr fuse file system.

* [Zephyr project bug tracker GHSA-mh67-4h3q-p437](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-mh67-4h3q-p437)

This has been fixed in main for v3.6.0

* [PR 66592 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/66592)

### [**CVE 2023-7060**](https://www.cve.org/CVERecord?id=CVE-2023-7060)[ï](#cve-2023-7060 "Link to this heading")

Missing Security Control in Zephyr OS IP Packet Handling

* [Zephyr project bug tracker GHSA-fjc8-223c-qgqr](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-fjc8-223c-qgqr)

This has been fixed in main for v3.6.0

* [PR 66645 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/66645)
* [PR 66739 fix for 3.5](https://github.com/zephyrproject-rtos/zephyr/pull/66739)
* [PR 66738 fix for 3.4](https://github.com/zephyrproject-rtos/zephyr/pull/66738)
* [PR 66887 fix for 2.7](https://github.com/zephyrproject-rtos/zephyr/pull/66887)

## CVE-2024[ï](#cve-2024 "Link to this heading")

### [**CVE 2024-1638**](https://www.cve.org/CVERecord?id=CVE-2024-1638)[ï](#cve-2024-1638 "Link to this heading")

Bluetooth characteristic LESC security requirement not enforced without additional flags

* [Zephyr project bug tracker GHSA-p6f3-f63q-5mc2](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-p6f3-f63q-5mc2)

This has been fixed in main for v3.6.0

* [PR 69170 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/69170)

### [**CVE 2024-3077**](https://www.cve.org/CVERecord?id=CVE-2024-3077)[ï](#cve-2024-3077 "Link to this heading")

Bluetooth: Integer underflow in gatt\_find\_info\_rsp. A malicious BLE
device can crash BLE victim device by sending malformed gatt packet.

* [Zephyr project bug tracker GHSA-gmfv-4vfh-2mh8](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-gmfv-4vfh-2mh8)

This has been fixed in main for v3.7.0

* [PR 69396 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/69396)

### [**CVE 2024-3332**](https://www.cve.org/CVERecord?id=CVE-2024-3332)[ï](#cve-2024-3332 "Link to this heading")

Bluetooth: DoS caused by null pointer dereference.

A malicious BLE device can send a specific order of packet
sequence to cause a DoS attack on the victim BLE device.

* [Zephyr project bug tracker GHSA-jmr9-xw2v-5vf4](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-jmr9-xw2v-5vf4)

This has been fixed in main for v3.7.0

* [PR 71030 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/71030)

### [**CVE 2024-4785**](https://www.cve.org/CVERecord?id=CVE-2024-4785)[ï](#cve-2024-4785 "Link to this heading")

Bluetooth: Missing Check in LL\_CONNECTION\_UPDATE\_IND Packet Leads to Division by Zero

* [Zephyr project bug tracker GHSA-xcr5-5g98-mchp](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-xcr5-5g98-mchp)

This has been fixed in main for v3.7.0

* [PR 72608 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/72608)

### [**CVE 2024-5754**](https://www.cve.org/CVERecord?id=CVE-2024-5754)[ï](#cve-2024-5754 "Link to this heading")

BT: Encryption procedure host vulnerability

* [Zephyr project bug tracker GHSA-gvv5-66hw-5qrc](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-gvv5-66hw-5qrc)

This has been fixed in main for v3.7.0

* [PR 7395 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/7395)
* [PR 74124 fix for 3.6](https://github.com/zephyrproject-rtos/zephyr/pull/74124)
* [PR 74123 fix for 3.5](https://github.com/zephyrproject-rtos/zephyr/pull/74123)
* [PR 74122 fix for 2.7](https://github.com/zephyrproject-rtos/zephyr/pull/74122)

### [**CVE 2024-5931**](https://www.cve.org/CVERecord?id=CVE-2024-5931)[ï](#cve-2024-5931 "Link to this heading")

BT: Unchecked user input in bap\_broadcast\_assistant

* [Zephyr project bug tracker GHSA-r8h3-64gp-wv7f](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-r8h3-64gp-wv7f)

This has been fixed in main for v3.7.0

* [PR 74062 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/74062)
* [PR 77966 fix for 3.6](https://github.com/zephyrproject-rtos/zephyr/pull/77966)

### [**CVE 2024-6135**](https://www.cve.org/CVERecord?id=CVE-2024-6135)[ï](#cve-2024-6135 "Link to this heading")

BT:Classic: Multiple missing buf length checks

* [Zephyr project bug tracker GHSA-2mp4-4g6f-cqcx](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-2mp4-4g6f-cqcx)

This has been fixed in main for v3.7.0

* [PR 74283 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/74283)
* [PR 77964 fix for 3.6](https://github.com/zephyrproject-rtos/zephyr/pull/77964)

### [**CVE 2024-6137**](https://www.cve.org/CVERecord?id=CVE-2024-6137)[ï](#cve-2024-6137 "Link to this heading")

BT: Classic: SDP OOB access in get\_att\_search\_list

* [Zephyr project bug tracker GHSA-pm38-7g85-cf4f](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-pm38-7g85-cf4f)

This has been fixed in main for v3.7.0

* [PR 75575 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/75575)

### [**CVE 2024-6258**](https://www.cve.org/CVERecord?id=CVE-2024-6258)[ï](#cve-2024-6258 "Link to this heading")

BT: Missing length checks of net\_buf in rfcomm\_handle\_data

* [Zephyr project bug tracker GHSA-7833-fcpm-3ggm](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-7833-fcpm-3ggm)

This has been fixed in main for v3.7.0

* [PR 74640 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/74640)

### [**CVE 2024-6259**](https://www.cve.org/CVERecord?id=CVE-2024-6259)[ï](#cve-2024-6259 "Link to this heading")

BT: HCI: adv\_ext\_report Improper discarding in adv\_ext\_report

* [Zephyr project bug tracker GHSA-p5j7-v26w-wmcp](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-p5j7-v26w-wmcp)

This has been fixed in main for v3.7.0

* [PR 74639 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/74639)
* [PR 77960 fix for 3.6](https://github.com/zephyrproject-rtos/zephyr/pull/77960)

### [**CVE 2024-6442**](https://www.cve.org/CVERecord?id=CVE-2024-6442)[ï](#cve-2024-6442 "Link to this heading")

Bluetooth: ASCS Unchecked tailroom of the response buffer

* [Zephyr project bug tracker GHSA-m22j-ccg7-4v4h](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-m22j-ccg7-4v4h)

This has been fixed in main for v3.7.0

* [PR 74976 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/74976)
* [PR 77958 fix for 3.6](https://github.com/zephyrproject-rtos/zephyr/pull/77958)

### [**CVE 2024-6443**](https://www.cve.org/CVERecord?id=CVE-2024-6443)[ï](#cve-2024-6443 "Link to this heading")

zephyr: out-of-bound read in utf8\_trunc

* [Zephyr project bug tracker GHSA-gg46-3rh2-v765](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-gg46-3rh2-v765)

This has been fixed in main for v3.7.0

* [PR 74949 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/74949)
* [PR 78286 fix for 3.6](https://github.com/zephyrproject-rtos/zephyr/pull/78286)

### [**CVE 2024-6444**](https://www.cve.org/CVERecord?id=CVE-2024-6444)[ï](#cve-2024-6444 "Link to this heading")

Bluetooth: ots: missing buffer length check

* [Zephyr project bug tracker GHSA-qj4r-chj6-h7qp](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-qj4r-chj6-h7qp)

This has been fixed in main for v3.7.0

* [PR 74944 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/74944)
* [PR 77954 fix for 3.6](https://github.com/zephyrproject-rtos/zephyr/pull/77954)

### [**CVE 2024-8798**](https://www.cve.org/CVERecord?id=CVE-2024-8798)[ï](#cve-2024-8798 "Link to this heading")

Bluetooth: classic: avdtp: missing buffer length check

* [Zephyr project bug tracker GHSA-r7pm-f93f-f7fp](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-r7pm-f93f-f7fp)

This has been fixed in main for v4.0.0

* [PR 77969 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/77969)
* [PR 78409 fix for 3.7](https://github.com/zephyrproject-rtos/zephyr/pull/78409)

### [**CVE 2024-10395**](https://www.cve.org/CVERecord?id=CVE-2024-10395)[ï](#cve-2024-10395 "Link to this heading")

Under embargo until 2025-01-23

### [**CVE 2024-11263**](https://www.cve.org/CVERecord?id=CVE-2024-11263)[ï](#cve-2024-11263 "Link to this heading")

arch: riscv: userspace: potential security risk when CONFIG\_RISCV\_GP=y

A rogue thread can corrupt the gp reg and cause the entire system to hard fault at best, at worst,
it can potentially trick the system to access another set of random global symbols.

* [Zephyr project bug tracker GHSA-jjf3-7x72-pqm9](https://github.com/zephyrproject-rtos/zephyr/security/advisories/GHSA-jjf3-7x72-pqm9)

This has been fixed in main for v4.0.0

* [PR 81155 fix for main](https://github.com/zephyrproject-rtos/zephyr/pull/81155)
* [PR 81370 fix for 3.7](https://github.com/zephyrproject-rtos/zephyr/pull/81370)

---

© Copyright 2015-2025 Zephyr Project members and individual contributors.
Last generated: Jan 19, 2025.
Last source update: Dec 15, 2024.


