```
{
  "CVE-2020-10174": {
    "Description": "The vulnerability is due to the unsafe usage of temporary directory in /tmp/timeshift. The application creates temporary files and directories within the /tmp/timeshift directory, and does not check if the directory is a symlink or has been created by an unprivileged user.",
    "Root cause": "The `init_tmp()` function in TeeJee.Process.vala creates a temporary directory for Timeshift using a predictable path prefix `/tmp/timeshift/`. It does not check for pre-existing directories or symlinks at this location before creating the unpredictable sub-directory and shell scripts.",
    "Weaknesses": [
      "Insecure use of predictable temporary directory path",
      "Lack of checks for existing directories and symlinks in /tmp",
      "Race condition vulnerability",
      "Creation of world readable temporary directories with mode 0755."
    ],
    "Impact": "An unprivileged local attacker can exploit this to achieve arbitrary code execution as root. They can pre-create the `/tmp/timeshift` directory and, by using a symlink or timing, replace the intended script file with a malicious one. This malicious script will then be executed with root privileges.",
    "Attack vectors": [
      "Local access to the system is required",
      "The attacker has to create the /tmp/timeshift directory prior to timeshift's execution",
       "The attacker can use a symlink in /tmp/timeshift to direct the temporary data creation to any location on the filesystem",
       "The attacker needs to win a race condition where the attacker controlled directory and script have to be placed before timeshift executes the script"
    ],
    "Required attacker capabilities": "The attacker needs to have local access to the system and be able to create files and directories in /tmp before the timeshift process executes.",
     "Additional Details": "Timeshift creates a temporary directory with a predictable path such as `/tmp/timeshift/randomstring`. Within this directory a shell script is created that is then executed. This predictable path allows a local attacker to replace the directory and script and gain arbitrary code execution as root. The issue exists in versions before v20.03."
  }
}
```