**Root cause of vulnerability:**
- A heap-based buffer overflow in the CODESYS V3 web server (CmpWebServerHandlerV3.dll) due to improper validation of user-supplied data in the /WebVisuV3 endpoint.

**Weaknesses/vulnerabilities present:**
- Heap-based buffer overflow due to an integer overflow in the memory allocation size calculation.
- The `MemGCGetSize` function adds a fixed value (0x5c) to the requested allocation size, leading to an integer overflow if the attacker provides a large value (e.g., 0xffffffff).
- The `SysMemAllocData` function uses the overflowed size, resulting in a smaller than expected buffer being allocated.
- Subsequently, a memory copy operation (`CMUtlSafeMemCpy`) copies more data than the allocated buffer can hold, resulting in a heap buffer overflow.

**Impact of exploitation:**
- The vulnerability can lead to a crash of the web server, causing a denial-of-service condition.
- It can potentially be exploited for remote code execution.
- The overflow may cause unforeseen behavior of the entire CODESYS runtime system.

**Attack vectors:**
- The vulnerability can be exploited remotely via network requests to the CODESYS V3 web server.
- Specifically, crafted `WEB_CLIENT_OPENCONNECTION` and `WEB_CLIENT_RUN_SERVICE` messages are used to trigger the vulnerability.

**Required attacker capabilities/position:**
- The attacker needs network access to the CODESYS V3 web server.
- No authentication is required to trigger the vulnerability.
- An attacker with low technical skills could exploit the vulnerability.
- A proof of concept (PoC) exploit is publicly available.

**Additional details:**
- The vulnerable component is `CmpWebServerHandlerV3.dll` (specifically file version 3.5.15.20).
- The `MemGCGetSize` function adds 0x5c bytes to the requested allocation size during memory allocation operation, which can lead to an integer overflow.
- The attacker first sends a `WEB_CLIENT_OPENCONNECTION` message with a very large allocation size to cause the integer overflow, followed by a `WEB_CLIENT_RUN_SERVICE` message to overflow the undersized heap buffer.
- The vulnerability is triggered when the CmpWebServerHandlerV3 component is in 'state' 0, which is its initial state when CODESYSControlService.exe starts.

**Solution:**
- Upgrade to CODESYS V3 version 3.5.15.40 or later.