=== Content from kb.cert.org_3eafd325_20250119_114120.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#815655

## NCR SelfServ ATM BNA contains multiple vulnerabilities

#### Vulnerability Note VU#815655

Original Release Date: 2020-08-20 | Last Revised: 2020-08-21

---

### Overview

NCR SelfServ automated teller machines (ATMs) running APTRA XFS 04.02.01 and 05.01.00 are vulnerable to physical attacks on the communications bus between the host computer and the bunch note accepter (BNA).

### Description

NCR ATM SelfServ devices running APTRA XFS 04.02.01 and 05.01.00 contain vulnerabilities that can be exploited by an attacker with physical access to the internal components of the ATM, specifically the BNA and the host computer.

#### CVE-2020-10124

NCR SelfServ ATMs running APTRA XFS 05.01.00 do not encrypt, authenticate, or verify the integrity of messages between the BNA and the host computer. A similar vulnerability is identified as [CVE-2020-9062](https://nvd.nist.gov/vuln/detail?vulnId=2020-9062) in [VU#221785](https://kb.cert.org/vuls/id/221785). CVE-2020-9062 involves the cash and check deposit module (CCDM) in ATMs from a different vendor. The CCDM is functionally similar to the BNA.

#### CVE-2020-10125

NCR SelfServ ATMs running APTRA XFS 04.02.01 and 05.01.00 implement 512-bit RSA certificates to validate BNA software updates. Keys of this strength can be broken by an attacker in a sufficiently short period of time, thereby enabling the attacker to sign arbitrary files and CAB archives used to update BNA software, as well as bypass application whitelisting, resulting in the ability to execute arbitrary code. (CWE-326)

#### CVE-2020-10126

NCR SelfServ ATMs running APTRA XFS 05.01.00 do not properly validate software updates for the BNA. An attacker with physical access to internal ATM components can restart the host computer. During boot, the update process looks for CAB archives on removable media and executes a specific file without first validating the signature of the CAB archive. This allows an attacker to execute arbitrary code with SYSTEM privileges. (CWE-305)

### Impact

An attacker with physical access to the internal components of the ATM, including the BNA, can execute arbitrary code. An attacker may also be able to commit deposit forgery, with or without also executing arbitrary code.

A deposit forgery attack requires two separate transactions. The attacker must first deposit actual currency and manipulate the message from the BNA to the host computer to indicate a greater amount or value than was actually deposited. Then the attacker must make a withdrawal for an artificially increased amount or value of currency. This second transaction may need to occur at an ATM operated by a different financial institution (i.e., a not-on-us or OFF-US transaction).

### Solution

#### Apply an update

Update software to APTRA XFS 06.08. The update increases the strength of the RSA keys to limit the window of opportunity for an attacker to crack and misuse the keys (CVE-2020-10125). The update also provides protection against the bypass of the digital signature check (CVE-2020-10126).

### Acknowledgements

These vulnerabilities were researched and reported by Roman Bazhin and Dmitry Turchenkov. At the time of the initial report, Roman Bazhin and Dmitry Turchenkov were associated with Embedi.

Coordinating with Embedi was supported by *U.S. Department of the Treasury, Office of Foreign Assets Control (OFAC) License No. CYBER2-2019-359003-1, Cyber-Related Sanctions Regulations License issued April 2, 2019 to Licensees: CERT Coordination Center at Carnegie Mellonâs Software Engineering Institute (CERT), U.S. Department of Homeland Security, Cybersecurity and Infrastructure Security Agency (CISA), the National Cybersecurity and Communications Integration Center.*

This document was written by Eric Hatleback and Laurie Tyzenhaus.

### Vendor Information

815655
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

### [NCR Corporation](#NCR%20Corporation) Affected

Notified:  2020-08-12
Updated: 2020-08-20

| **CVE-2020-10124** | Affected |
| --- | --- |
| **CVE-2020-10125** | Affected |
| **CVE-2020-10126** | Affected |

#### Vendor Statement

NCR advises all of our customers that it is critically important that APTRA XFS software is kept up to date to ensure that the latest security patches are always installed. We note that the version of software referenced in this report, APTRA XFS 05.01 was released in 2010, and discontinued for support in 2015. Any customer still using unsupported software should upgrade at the earliest possible opportunity. NCR would also note that deposit fraud which might be achievable by exploiting the functionality described in these CVEs does not necessarily result in cash loss. Any Financial Institution that accepts automated deposits has âknow your customerâ and other fraud mitigation policies in place which limit immediate funds availability. Such mitigations are typically stronger where foreign deposits are accepted, if at all. This form of electronic deposit fraud is unlikely to result in significant loss.

#### References

* <https://www.ncr.com/content/dam/ncrcom/content-type/documents/NCR_Security_Alert-2018-13_APTRA_XFS_v5.pdf>

### References

* <https://www.ncr.com/content/dam/ncrcom/content-type/documents/NCR_Security_Alert-2018-13_APTRA_XFS_>
* <v5.pdf>
* <https://home.treasury.gov/news/press-releases/sm0410>
* <https://www.treasury.gov/resource-center/sanctions/OFAC-Enforcement/Pages/20180611.aspx>
* <https://www.treasury.gov/resource-center/sanctions/Programs/Documents/cyber_eo.pdf>

### Other Information

| **CVE IDs:** | [CVE-2020-10124](http://web.nvd.nist.gov/vuln/detail/CVE-2020-10124)  [CVE-2020-10125](http://web.nvd.nist.gov/vuln/detail/CVE-2020-10125)  [CVE-2020-10126](http://web.nvd.nist.gov/vuln/detail/CVE-2020-10126) |
| --- | --- |
| **Date Public:** | 2020-08-20 |
| **Date First Published:** | 2020-08-20 |
| **Date Last Updated:** | 2020-08-21 17:16 UTC |
| **Document Revision:** | 2 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


