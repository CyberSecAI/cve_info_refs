## CVE-2020-11492

Based on the provided content, here's a breakdown of the vulnerability:

*   **Vulnerability:** Privilege Escalation in Docker Desktop for Windows.

*   **Root Cause:** The Docker Desktop Service, which runs with SYSTEM privileges, communicates with child processes using named pipes. This service can be tricked into connecting to a named pipe set up by a lower-privileged malicious process.

*   **Weakness:** The high privilege Docker Desktop Service acts as a client to named pipes, and does not disable impersonation. The server side of a named pipe connection has the ability to impersonate the connecting client account. Since the Docker Desktop Service connects to the malicious pipe, it can be impersonated.

*   **Attack Vector:**
    1.  A malicious process with impersonation privileges creates a named pipe (e.g., `\\.\pipe\dockerLifecycleServer`).
    2.  The high-privilege Docker Desktop Service connects to this malicious pipe as a client.
    3.  The malicious process impersonates the Docker Desktop Service account (SYSTEM).
    4.  The malicious process executes arbitrary system commands with SYSTEM privileges (e.g. using `CreateProcessWithTokenW`).

*   **Attacker Capabilities/Position:**
    *   The attacker needs to execute code under the context of a process that has impersonate privileges ("Impersonate a client after authentication" user right).
    *   One possible attack vector is exploiting a vulnerability in an IIS web application hosted on the same machine. This could allow code execution under the limited IIS App Pool account, which has the required impersonation privileges.

*   **Impact:** Successful exploitation allows a low-privilege attacker to execute arbitrary commands with SYSTEM privileges, achieving full control over the affected system.

*   **Fix:** Docker addressed the vulnerability by configuring the Docker service process to use the `SecurityIdentification` impersonation level when connecting to the named pipes of spawned child processes. This allows the server end of the pipe to get the identity and privileges of the client but not allow impersonation.