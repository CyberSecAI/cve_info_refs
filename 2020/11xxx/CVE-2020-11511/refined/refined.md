```
{
  "cve": "CVE-2020-11511",
  "affected_plugin": "LearnPress",
  "affected_versions": "< 3.2.6.9",
  "vulnerability_details": [
    {
      "root_cause": "The LearnPress plugin's function `learn_press_accept_become_a_teacher()` is vulnerable because it automatically executes upon plugin load and lacks proper input validation and authorization checks. It is designed to process requests to make a user an instructor via a link. However, the function doesn't check if the request is coming from a legitimate source or if the user has the required permissions to do so. This allows unauthenticated users to trigger the function with any user id.",
      "weaknesses": [
        "Improper input validation",
        "Missing authorization checks",
        "Unprotected endpoint",
         "Privilege Escalation"
      ],
      "impact": "An unauthenticated attacker can elevate any user's privileges to 'LP Instructor'. This role has permissions to create posts containing unfiltered HTML, leading to potential site takeover or redirection to malicious sites. ",
      "attack_vectors": "Sending a crafted request to wp-admin/admin-post.php with 'action' set to 'accept-to-be-teacher' and the 'user_id' parameter set to the ID of the target user.",
       "required_attacker_capabilities": "Ability to send HTTP requests to the vulnerable WordPress instance.  No authentication is required to exploit this vulnerability.",
        "additional_details": "The function is executed upon plugin load via `add_action( 'plugins_loaded', 'learn_press_accept_become_a_teacher' );`, making it always available. The attacker needs to know the user ID of the account to be promoted to 'LP Instructor'"
    }
   ]
}
```