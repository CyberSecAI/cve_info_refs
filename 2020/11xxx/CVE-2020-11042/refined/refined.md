Based on the provided content, here's an analysis of CVE-2020-11042:

**Root Cause of Vulnerability:**
The vulnerability lies in the `update_read_icon_info` function within FreeRDP. The function reads several size parameters from the incoming stream, namely `cbColorTable`, `cbBitsMask`, and `cbBitsColor`. Subsequently, it uses these parameters to read data from the stream into memory buffers.

**Weaknesses/Vulnerabilities Present:**
- **Out-of-bounds Read:** The core issue is that the code performs a check to ensure that the remaining length in the stream (`Stream_GetRemainingLength(s)`) is sufficient to accommodate `cbBitsMask` + `cbBitsColor` but does not account for the size of the color table (`cbColorTable`) when reading.
   -  Specifically the vulnerability occurs when the condition `cbBitsMask+cbBitsColor < Stream_GetRemainingLength(s)` is true AND `cbBitsMask+cbColorTable+cbBitsColor > Stream_GetRemainingLength(s)` is true. This leads to reading beyond the valid boundary.
- The vulnerability occurs because the code first reads the size parameters and then performs a check. An attacker can craft a malicious RDP stream with specific values for these size parameters such that the initial check passes, but when reading the data, an out-of-bounds read occurs.

**Impact of Exploitation:**
- **Memory Disclosure:** An attacker can read an attacker-defined amount of client memory (up to 4GB due to the 32-bit unsigned nature of the size parameter) into an intermediate buffer. This could lead to leaking sensitive information from the client's memory.
- **Denial of Service:** The vulnerability can be exploited to crash the client application, leading to a denial of service.

**Attack Vectors:**
- **Malicious RDP Server:** A malicious RDP server can send a crafted RDP stream with manipulated size parameters, triggering the out-of-bounds read on the client.
- **Compromised Server:** If an attacker compromises a legitimate RDP server, they can use this vulnerability to target connected clients.

**Required Attacker Capabilities/Position:**
- The attacker must be in a position to control the RDP server or manipulate the RDP stream sent to the client.
- No special user interaction is required on the client side.

**Additional Notes:**
- The vulnerability affects FreeRDP versions greater than 1.1 and before 2.0.0.
- The fix involves adding checks before reading each data block and using a separate check for total combined sizes (`cbBitsMask`, `cbColorTable`, and `cbBitsColor`).
- The issue was fixed in commit `6b2bc41935e53b0034fe5948aeeab4f32e80f30f`.
- This vulnerability was assigned a severity of "Moderate" by GitHub.