```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability is caused by insecure handling of user-supplied URLs in the Pi-hole web interface. Specifically, the `gravity.sh` script uses `curl` to download blocklists, and it does not properly sanitize the URL provided by the user. This allows an attacker to inject arbitrary `curl` command-line options via crafted URLs.",
    "weaknesses": [
      "Improper Input Validation",
      "Command Injection",
      "Insufficient Sanitization",
       "Privilege Escalation"
    ],
    "impact": "Successful exploitation leads to arbitrary code execution as the `www-data` user, and subsequently, privilege escalation to root.",
    "attack_vectors": [
      "Remote, via the web interface",
      "Authenticated access to the Pi-hole web interface is required"
    ],
     "required_capabilities": [
      "Attacker must be able to login to the Pi-Hole admin web interface with valid credentials.",
      "For Conditional RCE,  Pi-hole service must have its BLOCKINGMODE configuration set to NXDOMAIN"
      ]
  },
  "additional_notes": "The vulnerability is found in `gravity.sh` script, and specifically the `gravity_DownloadBlocklistFromUrl` function. The attacker can inject arbitrary curl flags by using spaces in the URL parameter, and use `-o` flag to write a php file to web directory. There are two ways to achieve RCE via heisenbergCompensator and cmd_ext variables. Priv escalation can be achieved by overwriting teleporter.php in the web directory, then triggering a call to it by using sudo. The vulnerability affects Pi-hole versions 4.4 and below.The provided exploit uses netcat listeners for interaction during the exploitation process. This content provides more details than the official CVE description."
}
```