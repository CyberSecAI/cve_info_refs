Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**
The vulnerability stems from the use of a non-constant time modular inverse operation within the ECC (Elliptic Curve Cryptography) mapping to affine coordinates process when a private key is involved. Specifically, the `mp_invmod` function was used which is not constant-time. This could lead to timing side-channel attacks.

**Weaknesses/Vulnerabilities Present:**
- **Timing Side Channel:** The vulnerability is a timing side-channel weakness. The execution time of the modular inverse operation (`mp_invmod`) could leak information about the private key.
- **Non-Constant Time Operation:** The `mp_invmod` function's execution time was dependent on the input values. This is problematic because in cryptography, operations involving private keys should be constant-time to prevent information leakage through timing analysis.
- **Vulnerable Operations:** The vulnerability is present during operations that involve a private key, such as key generation, shared secret calculation, and signing.
- **Affected Code:** The issue was found within the `ecc_map` function in `wolfcrypt/src/ecc.c`, which is used during the ECC mapping process.

**Impact of Exploitation:**
- **Private Key Disclosure:** An attacker could potentially recover the private key by analyzing the time it takes for the vulnerable function to execute with varying inputs.
- **Cryptographic Compromise:** Successful exploitation could lead to the compromise of cryptographic operations, such as the ability to impersonate the victim, decrypt data encrypted with the compromised key, or forge signatures.

**Attack Vectors:**
- **Timing Analysis:** The attack vector relies on timing analysis. An attacker would need to measure the execution time of the vulnerable code path for different inputs.
- **Local or Remote:** The vulnerability can potentially be exploited both locally and remotely, depending on how the library is used and the attacker's position.

**Required Attacker Capabilities/Position:**
- **Timing Measurement:** The attacker needs to be able to accurately measure the execution time of cryptographic operations performed using the vulnerable code. This might require specific hardware or network configuration to minimize timing noise.
- **Knowledge of Code Usage:** The attacker would need to know when the vulnerable code path is executed and have a good understanding of the cryptographic primitives used.
- **Ability to Trigger Operations:** The attacker must be able to trigger operations using the library that causes the vulnerable code path to execute.

**Additional details:**
- The fix involves replacing the non-constant time `mp_invmod` with a new constant time version `mp_invmod_mont_ct` when the `ct` (constant time) parameter is set in the `ecc_map_ex` function. This new function uses a constant-time modular inverse using Montgomery multiplication.
- The fix also modifies how `wc_ecc_shared_secret_gen_sync` and `wc_ecc_make_pub_ex` calls `ecc_map_ex` to enforce the usage of the constant-time modular inverse by setting the constant time parameter to 1.
- The provided commit includes changes to files `ecc.c`, `tfm.c`, `ecc.h` and `tfm.h`