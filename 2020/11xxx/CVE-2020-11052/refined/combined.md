=== Content from github.com_369aadf1_20250119_123734.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSorcery%2Fsorcery%2Fissues%2F231)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSorcery%2Fsorcery%2Fissues%2F231)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Sorcery%2Fsorcery)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Sorcery](/Sorcery)
/
**[sorcery](/Sorcery/sorcery)**
Public

* [Notifications](/login?return_to=%2FSorcery%2Fsorcery) You must be signed in to change notification settings
* [Fork
  227](/login?return_to=%2FSorcery%2Fsorcery)
* [Star
   1.4k](/login?return_to=%2FSorcery%2Fsorcery)

* [Code](/Sorcery/sorcery)
* [Issues
  46](/Sorcery/sorcery/issues)
* [Pull requests
  24](/Sorcery/sorcery/pulls)
* [Discussions](/Sorcery/sorcery/discussions)
* [Actions](/Sorcery/sorcery/actions)
* [Projects
  0](/Sorcery/sorcery/projects)
* [Wiki](/Sorcery/sorcery/wiki)
* [Security](/Sorcery/sorcery/security)
* [Insights](/Sorcery/sorcery/pulse)

Additional navigation options

* [Code](/Sorcery/sorcery)
* [Issues](/Sorcery/sorcery/issues)
* [Pull requests](/Sorcery/sorcery/pulls)
* [Discussions](/Sorcery/sorcery/discussions)
* [Actions](/Sorcery/sorcery/actions)
* [Projects](/Sorcery/sorcery/projects)
* [Wiki](/Sorcery/sorcery/wiki)
* [Security](/Sorcery/sorcery/security)
* [Insights](/Sorcery/sorcery/pulse)

# brute force vulnerabilityÂ #231

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosed[#235](https://github.com/Sorcery/sorcery/pull/235)Closed[brute force vulnerability](#top)#231[#235](https://github.com/Sorcery/sorcery/pull/235)Copy linkAssignees [![joshbuker](https://avatars.githubusercontent.com/u/1802598?s=64&u=692f743d51114198ce8d00dd096a8494dacef124&v=4)](/joshbuker)![@futuretap](https://avatars.githubusercontent.com/u/110374?u=e71691656f86ab83466632b95a2cbb43b31211e8&v=4&size=80)
## Description

![@futuretap](https://avatars.githubusercontent.com/u/110374?u=e71691656f86ab83466632b95a2cbb43b31211e8&v=4&size=48)[futuretap](https://github.com/futuretap)opened [on Apr 30, 2020](https://github.com/Sorcery/sorcery/issues/231#issue-610116215)

Sorcery 0.14.0 is vulnerable to brute force attacks even if a login\_lock\_time\_period is configured.

If an attacker continues their login attempts after the initial login\_lock\_time\_period has passed, Sorcery no longer rejects those login attempts until eventually the attacker has guessed the right password.

This is caused by an early return in model/submodules/brute\_force\_protection.rb:68 which skips the update of the `lock_expires_at` field. So failed attempts don't update `lock_expires_at` as long as `lock_expires_at` contains any date, even if already passed.

I'll provide a fix.

## Metadata

### Assignees

* [![@joshbuker](https://avatars.githubusercontent.com/u/1802598?s=64&u=692f743d51114198ce8d00dd096a8494dacef124&v=4)joshbuker](/joshbuker)
### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_cabe4127_20250119_123736.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSorcery%2Fsorcery%2Fsecurity%2Fadvisories%2FGHSA-jc8m-cxhj-668x)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSorcery%2Fsorcery%2Fsecurity%2Fadvisories%2FGHSA-jc8m-cxhj-668x)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=Sorcery%2Fsorcery)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Sorcery](/Sorcery)
/
**[sorcery](/Sorcery/sorcery)**
Public

* [Notifications](/login?return_to=%2FSorcery%2Fsorcery) You must be signed in to change notification settings
* [Fork
  227](/login?return_to=%2FSorcery%2Fsorcery)
* [Star
   1.4k](/login?return_to=%2FSorcery%2Fsorcery)

* [Code](/Sorcery/sorcery)
* [Issues
  46](/Sorcery/sorcery/issues)
* [Pull requests
  24](/Sorcery/sorcery/pulls)
* [Discussions](/Sorcery/sorcery/discussions)
* [Actions](/Sorcery/sorcery/actions)
* [Projects
  0](/Sorcery/sorcery/projects)
* [Wiki](/Sorcery/sorcery/wiki)
* [Security](/Sorcery/sorcery/security)
* [Insights](/Sorcery/sorcery/pulse)

Additional navigation options

* [Code](/Sorcery/sorcery)
* [Issues](/Sorcery/sorcery/issues)
* [Pull requests](/Sorcery/sorcery/pulls)
* [Discussions](/Sorcery/sorcery/discussions)
* [Actions](/Sorcery/sorcery/actions)
* [Projects](/Sorcery/sorcery/projects)
* [Wiki](/Sorcery/sorcery/wiki)
* [Security](/Sorcery/sorcery/security)
* [Insights](/Sorcery/sorcery/pulse)

# Brute Force Vulnerability

High

[joshbuker](/joshbuker)
published
GHSA-jc8m-cxhj-668x
May 2, 2020

## Package

bundler

sorcery
([Rubygems](/advisories?query=ecosystem%3Arubygems))

## Affected versions

< 0.15.0

## Patched versions

>= 0.15.0

## Description

### Impact

Brute force vulnerability when using password authentication via Sorcery. The brute force protection submodule will prevent a brute force attack for the defined lockout period, but once expired protection will not be re-enabled until a user or malicious actor logs in successfully. This does not affect users that do not use the built-in brute force protection submodule, nor users that use permanent account lockout.

### Patches

Patched as of version `0.15.0`.

### Workarounds

Currently no workarounds, other than monkey patching the authenticate method provided by Sorcery or upgrading to version `0.15.0`.

### References

Vulnerability identified by [@futuretap](https://github.com/futuretap) via issue [#231](https://github.com/Sorcery/sorcery/issues/231)

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [Sorcery/sorcery](https://github.com/Sorcery/sorcery)

### Severity

High

### CVE ID

CVE-2020-11052

### Weaknesses

No CWEs

### Credits

* [![@futuretap](https://avatars.githubusercontent.com/u/110374?s=40&v=4)](/futuretap)
  [futuretap](/futuretap)
  Analyst

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_5e1bac87_20250119_141223.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSorcery%2Fsorcery)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSorcery%2Fsorcery)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Sorcery%2Fsorcery)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Sorcery](/Sorcery)
/
**[sorcery](/Sorcery/sorcery)**
Public

* [Notifications](/login?return_to=%2FSorcery%2Fsorcery) You must be signed in to change notification settings
* [Fork
  227](/login?return_to=%2FSorcery%2Fsorcery)
* [Star
   1.4k](/login?return_to=%2FSorcery%2Fsorcery)

Magical Authentication

[rubygems.org/gems/sorcery](https://rubygems.org/gems/sorcery "https://rubygems.org/gems/sorcery")

### License

[MIT license](/Sorcery/sorcery/blob/master/LICENSE.md)

[1.4k
stars](/Sorcery/sorcery/stargazers) [227
forks](/Sorcery/sorcery/forks) [Branches](/Sorcery/sorcery/branches) [Tags](/Sorcery/sorcery/tags) [Activity](/Sorcery/sorcery/activity)
 [Star](/login?return_to=%2FSorcery%2Fsorcery)

 [Notifications](/login?return_to=%2FSorcery%2Fsorcery) You must be signed in to change notification settings

* [Code](/Sorcery/sorcery)
* [Issues
  46](/Sorcery/sorcery/issues)
* [Pull requests
  24](/Sorcery/sorcery/pulls)
* [Discussions](/Sorcery/sorcery/discussions)
* [Actions](/Sorcery/sorcery/actions)
* [Projects
  0](/Sorcery/sorcery/projects)
* [Wiki](/Sorcery/sorcery/wiki)
* [Security](/Sorcery/sorcery/security)
* [Insights](/Sorcery/sorcery/pulse)

Additional navigation options

* [Code](/Sorcery/sorcery)
* [Issues](/Sorcery/sorcery/issues)
* [Pull requests](/Sorcery/sorcery/pulls)
* [Discussions](/Sorcery/sorcery/discussions)
* [Actions](/Sorcery/sorcery/actions)
* [Projects](/Sorcery/sorcery/projects)
* [Wiki](/Sorcery/sorcery/wiki)
* [Security](/Sorcery/sorcery/security)
* [Insights](/Sorcery/sorcery/pulse)

# Sorcery/sorcery

   Â master[Branches](/Sorcery/sorcery/branches)[Tags](/Sorcery/sorcery/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commitÂ History[1,374 Commits](/Sorcery/sorcery/commits/master/) | | |
| [.devcontainer](/Sorcery/sorcery/tree/master/.devcontainer ".devcontainer") | | [.devcontainer](/Sorcery/sorcery/tree/master/.devcontainer ".devcontainer") |  |  |
| [.github](/Sorcery/sorcery/tree/master/.github ".github") | | [.github](/Sorcery/sorcery/tree/master/.github ".github") |  |  |
| [gemfiles](/Sorcery/sorcery/tree/master/gemfiles "gemfiles") | | [gemfiles](/Sorcery/sorcery/tree/master/gemfiles "gemfiles") |  |  |
| [lib](/Sorcery/sorcery/tree/master/lib "lib") | | [lib](/Sorcery/sorcery/tree/master/lib "lib") |  |  |
| [spec](/Sorcery/sorcery/tree/master/spec "spec") | | [spec](/Sorcery/sorcery/tree/master/spec "spec") |  |  |
| [.document](/Sorcery/sorcery/blob/master/.document ".document") | | [.document](/Sorcery/sorcery/blob/master/.document ".document") |  |  |
| [.gitignore](/Sorcery/sorcery/blob/master/.gitignore ".gitignore") | | [.gitignore](/Sorcery/sorcery/blob/master/.gitignore ".gitignore") |  |  |
| [.rspec](/Sorcery/sorcery/blob/master/.rspec ".rspec") | | [.rspec](/Sorcery/sorcery/blob/master/.rspec ".rspec") |  |  |
| [.rubocop.yml](/Sorcery/sorcery/blob/master/.rubocop.yml ".rubocop.yml") | | [.rubocop.yml](/Sorcery/sorcery/blob/master/.rubocop.yml ".rubocop.yml") |  |  |
| [.rubocop\_todo.yml](/Sorcery/sorcery/blob/master/.rubocop_todo.yml ".rubocop_todo.yml") | | [.rubocop\_todo.yml](/Sorcery/sorcery/blob/master/.rubocop_todo.yml ".rubocop_todo.yml") |  |  |
| [CHANGELOG.md](/Sorcery/sorcery/blob/master/CHANGELOG.md "CHANGELOG.md") | | [CHANGELOG.md](/Sorcery/sorcery/blob/master/CHANGELOG.md "CHANGELOG.md") |  |  |
| [CODE\_OF\_CONDUCT.md](/Sorcery/sorcery/blob/master/CODE_OF_CONDUCT.md "CODE_OF_CONDUCT.md") | | [CODE\_OF\_CONDUCT.md](/Sorcery/sorcery/blob/master/CODE_OF_CONDUCT.md "CODE_OF_CONDUCT.md") |  |  |
| [Gemfile](/Sorcery/sorcery/blob/master/Gemfile "Gemfile") | | [Gemfile](/Sorcery/sorcery/blob/master/Gemfile "Gemfile") |  |  |
| [LICENSE.md](/Sorcery/sorcery/blob/master/LICENSE.md "LICENSE.md") | | [LICENSE.md](/Sorcery/sorcery/blob/master/LICENSE.md "LICENSE.md") |  |  |
| [MAINTAINING.md](/Sorcery/sorcery/blob/master/MAINTAINING.md "MAINTAINING.md") | | [MAINTAINING.md](/Sorcery/sorcery/blob/master/MAINTAINING.md "MAINTAINING.md") |  |  |
| [README.md](/Sorcery/sorcery/blob/master/README.md "README.md") | | [README.md](/Sorcery/sorcery/blob/master/README.md "README.md") |  |  |
| [Rakefile](/Sorcery/sorcery/blob/master/Rakefile "Rakefile") | | [Rakefile](/Sorcery/sorcery/blob/master/Rakefile "Rakefile") |  |  |
| [SECURITY.md](/Sorcery/sorcery/blob/master/SECURITY.md "SECURITY.md") | | [SECURITY.md](/Sorcery/sorcery/blob/master/SECURITY.md "SECURITY.md") |  |  |
| [sorcery.gemspec](/Sorcery/sorcery/blob/master/sorcery.gemspec "sorcery.gemspec") | | [sorcery.gemspec](/Sorcery/sorcery/blob/master/sorcery.gemspec "sorcery.gemspec") |  |  |
| View all files | | |

## Repository files navigation

* README
* Code of conduct
* MIT license
* Security
# Sorcery: Magical Authentication

Warning

## **Sorcery is currently unmaintained.**

What should I do?

1. Help maintain Sorcery (see: [#350](https://github.com/Sorcery/sorcery/issues/350))
2. Keep using Sorcery, and accept the risk that it may break or have unpatched security vulnerabilities.
3. Consider switching to alternative libraries that are actively maintained:
   * [Clearance](https://github.com/thoughtbot/clearance)
   * [Rodauth](https://github.com/jeremyevans/rodauth)
   * [Devise](https://github.com/heartcombo/devise)
   * [OmniAuth](https://github.com/omniauth/omniauth)

[![Gem Version](https://camo.githubusercontent.com/fed3ab48b77c4532f3cf5df45408f4510edaf013eb6fe5995b1ed2fb67a0d545/68747470733a2f2f62616467652e667572792e696f2f72622f736f72636572792e737667)](https://rubygems.org/gems/sorcery)
[![Gem Downloads](https://camo.githubusercontent.com/9ea29cc98ede0c374716681401929148d4a301c513b61df3c700833c90cfc147/68747470733a2f2f696d672e736869656c64732e696f2f67656d2f64742f736f72636572792e737667)](https://rubygems.org/gems/sorcery)
[![Build Status](https://github.com/Sorcery/sorcery/actions/workflows/ruby.yml/badge.svg?branch=master)](https://github.com/Sorcery/sorcery/actions/workflows/ruby.yml)

Magical Authentication for Rails. Supports ActiveRecord, DataMapper, Mongoid and MongoMapper.

Inspired by Restful Authentication, Authlogic and Devise. Crypto code taken almost unchanged from Authlogic. OAuth code inspired by OmniAuth and Ryan Bates's Railscast about it.

### Philosophy

Sorcery is a stripped-down, bare-bones authentication library, with which you can write your own authentication flow. It was built with a few goals in mind:

* Less is more - less than 20 public methods to remember for the entire feature-set make the lib easy to 'get'.
* No built-in or generated code - use the library's methods inside *your own* MVC structures, and don't fight to fix someone else's.
* Magic yes, Voodoo no - the lib should be easy to hack for most developers.
* Configuration over Confusion - Centralized (1 file), Simple & short configuration as possible, not drowning in syntactic sugar.
* Keep MVC cleanly separated - DB is for models, sessions are for controllers. Models stay unaware of sessions.

## Table of Contents

1. [Useful Links](#useful-links)
2. [API Summary](#api-summary)
3. [Installation](#installation)
4. [Configuration](#configuration)
5. [Full Features List by Module](#full-features-list-by-module)
6. [Planned Features](#planned-features)
7. [Contributing](#contributing)
8. [Contact](#contact)
9. [License](#license)

## Useful Links

* [Documentation](http://rubydoc.info/gems/sorcery)
* [Railscast](http://railscasts.com/episodes/283-authentication-with-sorcery)
* [Simple tutorial](https://github.com/Sorcery/sorcery/wiki/Simple-Password-Authentication)
* [Example Rails app](https://github.com/Sorcery/sorcery-example-app)

Check out the tutorials in the [wiki](https://github.com/Sorcery/sorcery/wiki) for more:

* [DataMapper Support](https://github.com/Sorcery/sorcery/wiki/DataMapper-Support)
* [DelayedJob Integration](https://github.com/Sorcery/sorcery/wiki/DelayedJob-Integration)
* [Simple Password Authentication](https://github.com/Sorcery/sorcery/wiki/Simple-Password-Authentication)
* [Single Table Inheritance Support](https://github.com/Sorcery/sorcery/wiki/Single-Table-Inheritance-Support)
* [Upgrading](https://github.com/Sorcery/sorcery/wiki/Upgrading)

## API Summary

Below is a summary of the library methods. Most method names are self
explaining and the rest are commented:

### Core

```
require_login # This is a before action
login(email, password, remember_me = false)
auto_login(user) # Login without credentials
logout
logged_in? # Available in views
current_user # Available in views
redirect_back_or_to # Use when a user tries to access a page while logged out, is asked to login, and we want to return him back to the page he originally wanted
@user.external? # Users who signed up using Facebook, Twitter, etc.
@user.active_for_authentication? # Add this method to define behaviour that will prevent selected users from signing in
@user.valid_password?('secret') # Compares 'secret' with the actual user's password, returns true if they match
User.authenticates_with_sorcery!
```

### HTTP Basic Auth

```
require_login_from_http_basic # This is a before action
```

### External

```
login_at(provider) # Sends the user to an external service (Facebook, Twitter, etc.) to authenticate
login_from(provider) # Tries to login from the external provider's callback
create_from(provider) # Create the user in the local app database
build_from(provider) # Build user instance using user_info_mappings
```

### Remember Me

```
auto_login(user, should_remember = false) # Login without credentials, optional remember_me
remember_me!
forget_me!
force_forget_me! # Forgets all sessions by clearing the token, even if remember_me_token_persist_globally is set to true
```

### Reset Password

```
User.load_from_reset_password_token(token)
@user.generate_reset_password_token! # Use if you want to send the email by yourself
@user.deliver_reset_password_instructions! # Generates the token and sends the email
@user.change_password(new_password)
@user.change_password!(new_password) # Same as change_password but raises exception on save
```

### Session Timeout

```
invalidate_active_sessions! #Invalidate all sessions with a login_time or last_action_time before the current time. Must Opt-in
```

### User Activation

```
User.load_from_activation_token(token)
@user.setup_activation
@user.activate!
```

Please see the tutorials in the github wiki for detailed usage information.

## Installation

Add this line to your application's Gemfile:

```
gem 'sorcery'
```

And then execute:

```
$ bundle

```

Or install it yourself as:

```
$ gem install sorcery

```

## Configuration

Run the following command to generate the core migration file, the initializer file and the
`User` model class.

```
$ rails generate sorcery:install

```

Run the following command generate the migrations files for remember\_me and reset\_password submodules and will create the initializer file (and add submodules to it), and create the `User` model class.

```
$ rails generate sorcery:install remember_me reset_password

```

Run the following command to generate the core migration file, the initializer and change the model class (in the initializer and migration files) to the class `Person` (and its pluralized version, 'people')

```
$ rails generate sorcery:install --model Person

```

Run the following command to generate only the migration files for the specified submodules and will add them to the initializer file.

```
$ rails generate sorcery:install http_basic_auth external remember_me --only-submodules

```

Inside the initializer, the comments will tell you what each setting does.

## Full Features List by Module

**Core** (see [lib/sorcery/model.rb](https://github.com/Sorcery/sorcery/blob/master/lib/sorcery/model.rb) and [lib/sorcery/controller.rb](https://github.com/Sorcery/sorcery/blob/master/lib/sorcery/controller.rb)):

* Login / logout, optional return user to requested url on login, configurable redirect for non-logged-in users.
* Password encryption, algorithms: bcrypt (default), MD5, SHA-1, SHA-256, SHA-512, AES or custom. Configurable stretches and salt.
* Configurable attribute names for username, password and email.
* Allow multiple fields to serve as username.

**User Activation** (see [lib/sorcery/model/submodules/user\_activation.rb](https://github.com/Sorcery/sorcery/blob/master/lib/sorcery/model/submodules/user_activation.rb)):

* User activation by email with optional success email
* Configurable attribute names
* Configurable mailer, method name, and attribute name
* Configurable temporary token expiration
* Optionally prevent non-active users to login

**Reset Password** (see [lib/sorcery/model/submodules/reset\_password.rb](https://github.com/Sorcery/sorcery/blob/master/lib/sorcery/model/submodules/reset_password.rb)):

* Reset password with email verification
* Configurable mailer, method name, and attribute name
* Configurable temporary token expiration
* Configurable time between emails (hammering protection)

**Remember Me** (see [lib/sorcery/model/submodules/remember\_me.rb](https://github.com/Sorcery/sorcery/blob/master/lib/sorcery/model/submodules/remember_me.rb)):

* Remember me with configurable expiration
* Configurable attribute names
* Configurable to persist globally (supporting multiple browsers at the same time), or starting anew after each login

**Session Timeout** (see [lib/sorcery/controller/submodules/session\_timeout.rb](https://github.com/Sorcery/sorcery/blob/master/lib/sorcery/controller/submodules/session_timeout.rb)):

* Configurable session timeout
* Optionally session timeout will be calculated from last user action
* Optionally enable a method to clear all active sessions, expects an `invalidate_sessions_before` datetime attribute.

**Brute Force Protection** (see [lib/sorcery/model/submodules/brute\_force\_protection.rb](https://github.com/Sorcery/sorcery/blob/master/lib/sorcery/model/submodules/brute_force_protection.rb)):

* Brute force login hammering protection
* configurable logins before lock and lock duration

**Basic HTTP Authentication** (see [lib/sorcery/controller/submodules/http\_basic\_auth.rb](https://github.com/Sorcery/sorcery/blob/master/lib/sorcery/controller/submodules/http_basic_auth.rb)):

* A before action for requesting authentication with HTTP Basic
* Automatic login from HTTP Basic
* Automatic login is disabled if session key changed

**Activity Logging** (see [lib/sorcery/model/submodules/activity\_logging.rb](https://github.com/Sorcery/sorcery/blob/master/lib/sorcery/model/submodules/activity_logging.rb)):

* Automatic logging of last login, last logout, last activity time and IP address for last login
* Configurable timeout by which to decide whether to include a user in the list of logged in users

**External** (see [lib/sorcery/controller/submodules/external.rb](https://github.com/Sorcery/sorcery/blob/master/lib/sorcery/controller/submodules/external.rb)):

* OAuth1 and OAuth2 support (currently: Twitter, Facebook, Github, Google, Heroku, LinkedIn, VK, LiveID, Xing, Salesforce)
* Configurable database column names
* Authentications table

## Planned Features

* Passing a block to encrypt, allowing the developer to define his own mix of salting and encrypting
* Forgot username, maybe as part of the reset\_password module
* Scoping logins (to a subdomain or another arbitrary field)
* Allowing storing the salt and encrypted password in the same DB field for extra security
* Other reset password strategies (security questions?)
* Other brute force protection strategies (captcha)

Have an idea? Let us know, and it might get into the gem!

## Contributing

Bug reports and pull requests are welcome on GitHub at <https://github.com/Sorcery/sorcery>.

* [Git Workflow](https://github.com/Sorcery/sorcery/wiki/Git-Workflow)
* [Running the specs](https://github.com/Sorcery/sorcery/wiki/Running-the-specs)

## Contact

Feel free to ask questions using these contact details:

**Current Maintainers:**

* ***Sorcery has no active maintainers***: [#350](https://github.com/Sorcery/sorcery/issues/350)

**Past Maintainers:**

* Josh Buker ([@joshbuker](https://github.com/joshbuker)) | Email
* Noam Ben-Ari ([@NoamB](https://github.com/NoamB)) | Email | [Twitter](https://twitter.com/nbenari)
* Kir Shatrov ([@kirs](https://github.com/kirs)) | Email | [Twitter](https://twitter.com/Kiiiir)
* Grzegorz Witek ([@arnvald](https://github.com/arnvald)) | Email | [Twitter](https://twitter.com/arnvald)
* Chase Gilliam ([@Ch4s3](https://github.com/Ch4s3)) | Email

## License

The gem is available as open source under the terms of the [MIT License](http://opensource.org/licenses/MIT).

## About

Magical Authentication

[rubygems.org/gems/sorcery](https://rubygems.org/gems/sorcery "https://rubygems.org/gems/sorcery")

### Topics

[ruby](/topics/ruby "Topic: ruby")
[rails](/topics/rails "Topic: rails")
[authentication](/topics/authentication "Topic: authentication")
[sorcery](/topics/sorcery "Topic: sorcery")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)
### Code of conduct

[Code of conduct](#coc-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/Sorcery/sorcery/activity)
[Custom properties](/Sorcery/sorcery/custom-properties)
### Stars

[**1.4k**
stars](/Sorcery/sorcery/stargazers)
### Watchers

[**29**
watching](/Sorcery/sorcery/watchers)
### Forks

[**227**
forks](/Sorcery/sorcery/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FSorcery%2Fsorcery&report=Sorcery+%28user%29)

## [Releases 12](/Sorcery/sorcery/releases)

[v0.17.0
Latest

Mar 8, 2024](/Sorcery/sorcery/releases/tag/v0.17.0)
[+ 11 releases](/Sorcery/sorcery/releases)

## [Packages 0](/orgs/Sorcery/packages?repo_name=sorcery)

No packages published

## [Contributors 205](/Sorcery/sorcery/graphs/contributors)

* [![@NoamB](https://avatars.githubusercontent.com/u/9786?s=64&v=4)](https://github.com/NoamB)
* [![@arnvald](https://avatars.githubusercontent.com/u/135708?s=64&v=4)](https://github.com/arnvald)
* [![@kirs](https://avatars.githubusercontent.com/u/522155?s=64&v=4)](https://github.com/kirs)
* [![@joshbuker](https://avatars.githubusercontent.com/u/1802598?s=64&v=4)](https://github.com/joshbuker)
* [![@kyuden](https://avatars.githubusercontent.com/u/2311539?s=64&v=4)](https://github.com/kyuden)
* [![@Ch4s3](https://avatars.githubusercontent.com/u/1943540?s=64&v=4)](https://github.com/Ch4s3)
* [![@asmsuechan](https://avatars.githubusercontent.com/u/11307908?s=64&v=4)](https://github.com/asmsuechan)
* [![@supremebeing7](https://avatars.githubusercontent.com/u/6739980?s=64&v=4)](https://github.com/supremebeing7)
* [![@banyan](https://avatars.githubusercontent.com/u/19625?s=64&v=4)](https://github.com/banyan)
* [![@ckruse](https://avatars.githubusercontent.com/u/175095?s=64&v=4)](https://github.com/ckruse)
* [![@rafaelsachetto](https://avatars.githubusercontent.com/u/42780?s=64&v=4)](https://github.com/rafaelsachetto)
* [![@palkan](https://avatars.githubusercontent.com/u/1516722?s=64&v=4)](https://github.com/palkan)
* [![@fzagarzazu](https://avatars.githubusercontent.com/u/2101200?s=64&v=4)](https://github.com/fzagarzazu)
* [![@kbighorse](https://avatars.githubusercontent.com/u/93388?s=64&v=4)](https://github.com/kbighorse)

[+ 191 contributors](/Sorcery/sorcery/graphs/contributors)

## Languages

* [Ruby
  98.9%](/Sorcery/sorcery/search?l=ruby)
* Other
  1.1%

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from avatars.githubusercontent.com_2a5fbba6_20250119_141228.html ===
ï¿½ï¿½ï¿½ï¿½ ï¿½  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222ï¿½ï¿½  ( (" ï¿½ï¿½ï¿½          
   } !1AQa"q2ï¿½ï¿½ï¿½#Bï¿½ï¿½Rï¿½ï¿½$3brï¿½
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½       
  w !1AQaq"2ï¿½Bï¿½ï¿½ï¿½ï¿½ #3Rï¿½brï¿½
$4ï¿½%ï¿½&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½   ? ï¿½ï¿½ï¿½ï¿½jï¿½ï¿½>ï¿½5ï¿½Û•ï¿½%ï¿½ï¿½Sï¿½\*ï¿½s~9ï¿½7~x@'3ï¿½Oï¿½8ï¿½ï¿½Æ¦Nï¿½lï¿½.i$dï¿½ï¿½2Ü£ï¿½ï¿½ï¿½ï¿½ .Yï¿½ï¿½ï¿½ï¿½Nï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Jï¿½ï¿½sXï¿½dr2=ï¿½ï¿½4ï¿½ï¿½${ï¿½ï¿½ï¿½ï¿½fhï¿½ï¿½8ï¿½sï¿½=ï¿½ï¿½MÄ·W\_iï¿½ï¿½ï¿½yï¿½pï¿½Nqï¿½ï¿½ï¿½ï¿½ï¿½\*ï¿½VRï¿½ï¿½ï¿½^ï¿½cï¿½ï¿½j)(ï¿½Ã„ï¿½yâ¶…ï¿½ï¿½ï¿½#Qï¿½Æ¸{ï¿½&ï¿½\*Iï¿½ï¿½Dï¿½ï¿½ï¿½$P3ëŠ“Çºï¿½ï¿½ï¿½tï¿½;ï¿½ï¿½Kgï¿½ï¿½ï¿½ï¿½h'ï¿½>ï¿½9Ï§<ï¿½ï¿½]tï¿½'ï¿½ï¿½Yï¿½hï¿½Eï¿½ï¿½ï¿½ï¿½ï¿½ï¿½"ï¿½;ï¿½Ö–ï¿½ï¿½ï¿½{ï¿½lbï¿½;ï¿½
ï¿½xcï¿½ï¿½×¾ï¿½<ï¿½ï¿½jJBï¿½aQTï¿½ sï¿½zï¿½Oï¿½(Ó„,u$ï¿½ï¿½Mï¿½Û³ï¿½ï¿½ï¿½q\ï¿½p<ï¿½ï¿½{Uï¿½ï¿½ÒŠï¿½Sï¿½xï¿½ï¿½\Pï¿½ï¿½ï¿½Ë”ï¿½Ç‚ï¿½ï¿½ï¿½MÂ¾mï¿½ï¿½ï¿½/lï¿½fe1ï¿½|Kï¿½Aï¿½Vï¿½ï¿½ï¿½#}ï¿½ ï¿½-]2ï¿½+ï¿½ï¿½X×²ï¿½ï¿½ï¿½M/ï¿½nï¿½GQï¿½E ï¿½t ï¿½ ï¿½pZï¿½ï¿½ï¿½ï¿½Pï¿½ï¿½dï¿½6 ï¿½kï¿½p?ï¿½ï¿½ï¿½ï¿½cï¿½ !ï¿½ßªï¿½ ï¿½"ï¿½
cï¿½\ï¿½ ï¿½ï¿½ï¿½ è·®ï¿½0ï¿½ï¿½ï¿½hï¿½
Uï¿½dÃƒï¿½ï¿½Jï¿½^ï¿½[Gï¿½ï¿½tï¿½qï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½5uÚ‡ï¿½|ï¿½ï¿½ \Oï¿½Lï¿½ï¿½ï¿½dï¿½ï¿½ï¿½Z\ï¿½vwPGLï¿½ï¿½æ¿·.?ï¿½ï¿½uï¿½xï¿½ï¿½Aï¿½ï¿½ï¿½ï¿½ ï¿½Vï¿½ï¿½ï¿½k]ï¿½ï¿½ï¿½

=== Content from github.com_255104df_20250119_123735.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSorcery%2Fsorcery%2Fpull%2F235)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSorcery%2Fsorcery%2Fpull%2F235)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=Sorcery%2Fsorcery)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Sorcery](/Sorcery)
/
**[sorcery](/Sorcery/sorcery)**
Public

* [Notifications](/login?return_to=%2FSorcery%2Fsorcery) You must be signed in to change notification settings
* [Fork
  227](/login?return_to=%2FSorcery%2Fsorcery)
* [Star
   1.4k](/login?return_to=%2FSorcery%2Fsorcery)

* [Code](/Sorcery/sorcery)
* [Issues
  46](/Sorcery/sorcery/issues)
* [Pull requests
  24](/Sorcery/sorcery/pulls)
* [Discussions](/Sorcery/sorcery/discussions)
* [Actions](/Sorcery/sorcery/actions)
* [Projects
  0](/Sorcery/sorcery/projects)
* [Wiki](/Sorcery/sorcery/wiki)
* [Security](/Sorcery/sorcery/security)
* [Insights](/Sorcery/sorcery/pulse)

Additional navigation options

* [Code](/Sorcery/sorcery)
* [Issues](/Sorcery/sorcery/issues)
* [Pull requests](/Sorcery/sorcery/pulls)
* [Discussions](/Sorcery/sorcery/discussions)
* [Actions](/Sorcery/sorcery/actions)
* [Projects](/Sorcery/sorcery/projects)
* [Wiki](/Sorcery/sorcery/wiki)
* [Security](/Sorcery/sorcery/security)
* [Insights](/Sorcery/sorcery/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FSorcery%2Fsorcery%2Fissues%2Fnew%2Fchoose)

By clicking â€œSign up for GitHubâ€, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). Weâ€™ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FSorcery%2Fsorcery%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix brute force vuln due to callbacks not being ran #235

 Merged

[joshbuker](/joshbuker)
merged 1 commit into
[Sorcery:master](/Sorcery/sorcery/tree/master "Sorcery/sorcery:master")
from
[joshbuker:hotfix/brute-force-vulnerability](/joshbuker/sorcery/tree/hotfix/brute-force-vulnerability "joshbuker/sorcery:hotfix/brute-force-vulnerability")

May 2, 2020

 Merged

# [Fix brute force vuln due to callbacks not being ran](#top) #235

[joshbuker](/joshbuker)
merged 1 commit into
[Sorcery:master](/Sorcery/sorcery/tree/master "Sorcery/sorcery:master")
from
[joshbuker:hotfix/brute-force-vulnerability](/joshbuker/sorcery/tree/hotfix/brute-force-vulnerability "joshbuker/sorcery:hotfix/brute-force-vulnerability")

May 2, 2020

[Conversation
0](/Sorcery/sorcery/pull/235)
[Commits
1](/Sorcery/sorcery/pull/235/commits)
[Checks
0](/Sorcery/sorcery/pull/235/checks)
[Files changed](/Sorcery/sorcery/pull/235/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![joshbuker](https://avatars.githubusercontent.com/u/1802598?s=60&v=4)](/joshbuker)

Copy link

Member

### @joshbuker **[joshbuker](/joshbuker)** commented [May 2, 2020](#issue-611270308)

The authenticate method previously would return before callbacks executed if an

invalid password was provided, which causes the brute force protection to only

work for the first lockout period, and only resets after a successful login.

Fixes [#231](https://github.com/Sorcery/sorcery/issues/231)

Sorry, something went wrong.

All reactions

[![@joshbuker](https://avatars.githubusercontent.com/u/1802598?s=40&v=4)](/joshbuker)

`[Fix brute force vuln due to callbacks not being ran](/Sorcery/sorcery/pull/235/commits/078df5f2053f13c9bfa7f4c50129ff4035523a0e "Fix brute force vuln due to callbacks not being ran

The authenticate method previously would return before callbacks executed if an
invalid password was provided, which causes the brute force protection to only
work for the first lockout period, and only resets after a successful login.

Fixes #231")`
 â€¦

`[078df5f](/Sorcery/sorcery/pull/235/commits/078df5f2053f13c9bfa7f4c50129ff4035523a0e)`

```
The authenticate method previously would return before callbacks executed if an
invalid password was provided, which causes the brute force protection to only
work for the first lockout period, and only resets after a successful login.

Fixes [Sorcery#231](https://github.com/Sorcery/sorcery/issues/231)
```

[![@joshbuker](https://avatars.githubusercontent.com/u/1802598?s=40&u=692f743d51114198ce8d00dd096a8494dacef124&v=4)](/joshbuker)
[joshbuker](/joshbuker)
merged commit [`0f116d2`](/Sorcery/sorcery/commit/0f116d223826895a73b12492f17486e5d54ab7a7)
into
Sorcery:master

[May 2, 2020](https://github.com/Sorcery/sorcery/pull/235#event-3296806752)

 [![@joshbuker](https://avatars.githubusercontent.com/u/1802598?s=40&u=692f743d51114198ce8d00dd096a8494dacef124&v=4)](/joshbuker)
[joshbuker](/joshbuker)
deleted the
hotfix/brute-force-vulnerability

branch
[May 2, 2020 20:57](#event-3296806788)

[![@joshbuker](https://avatars.githubusercontent.com/u/1802598?s=40&u=692f743d51114198ce8d00dd096a8494dacef124&v=4)](/joshbuker)
[joshbuker](/joshbuker)
mentioned this pull request
[May 2, 2020](#ref-pullrequest-610121937)

[Fix for brute\_force vulnerability #231
#232](/Sorcery/sorcery/pull/232)
 Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FSorcery%2Fsorcery%2Fpull%2F235)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [brute force vulnerability](https://github.com/Sorcery/sorcery/issues/231)

1 participant

[![@joshbuker](https://avatars.githubusercontent.com/u/1802598?s=52&v=4)](/joshbuker)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from github.com_733149a9_20250119_123733.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSorcery%2Fsorcery%2Fcommit%2F0f116d223826895a73b12492f17486e5d54ab7a7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSorcery%2Fsorcery%2Fcommit%2F0f116d223826895a73b12492f17486e5d54ab7a7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=Sorcery%2Fsorcery)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Sorcery](/Sorcery)
/
**[sorcery](/Sorcery/sorcery)**
Public

* [Notifications](/login?return_to=%2FSorcery%2Fsorcery) You must be signed in to change notification settings
* [Fork
  227](/login?return_to=%2FSorcery%2Fsorcery)
* [Star
   1.4k](/login?return_to=%2FSorcery%2Fsorcery)

* [Code](/Sorcery/sorcery)
* [Issues
  46](/Sorcery/sorcery/issues)
* [Pull requests
  24](/Sorcery/sorcery/pulls)
* [Discussions](/Sorcery/sorcery/discussions)
* [Actions](/Sorcery/sorcery/actions)
* [Projects
  0](/Sorcery/sorcery/projects)
* [Wiki](/Sorcery/sorcery/wiki)
* [Security](/Sorcery/sorcery/security)
* [Insights](/Sorcery/sorcery/pulse)

Additional navigation options

* [Code](/Sorcery/sorcery)
* [Issues](/Sorcery/sorcery/issues)
* [Pull requests](/Sorcery/sorcery/pulls)
* [Discussions](/Sorcery/sorcery/discussions)
* [Actions](/Sorcery/sorcery/actions)
* [Projects](/Sorcery/sorcery/projects)
* [Wiki](/Sorcery/sorcery/wiki)
* [Security](/Sorcery/sorcery/security)
* [Insights](/Sorcery/sorcery/pulse)

## Commit

[Permalink](/Sorcery/sorcery/commit/0f116d223826895a73b12492f17486e5d54ab7a7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix brute force vuln due to callbacks not being ran ([#235](https://github.com/Sorcery/sorcery/pull/235))

[Browse files](/Sorcery/sorcery/tree/0f116d223826895a73b12492f17486e5d54ab7a7)
Browse the repository at this point in the history

```
The authenticate method previously would return before callbacks executed if an
invalid password was provided, which causes the brute force protection to only
work for the first lockout period, and only resets after a successful login.

Fixes [#231](https://github.com/Sorcery/sorcery/issues/231)
```

* Loading branch information

[![@joshbuker](https://avatars.githubusercontent.com/u/1802598?s=40&v=4)](/joshbuker)

[joshbuker](/Sorcery/sorcery/commits?author=joshbuker "View all commits by joshbuker")
authored
May 2, 2020

1 parent
[6b72ca3](/Sorcery/sorcery/commit/6b72ca36cf389804963e2553ccbb3da000518e51)

commit 0f116d2

Showing
**1 changed file**
with
**4 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

8 changes: 4 additions & 4 deletions

8
[lib/sorcery/model.rb](#diff-ae349063debeff7c5604a41e8bfbba711863a54b0192ef8a9d74a36f1c1cddbe "lib/sorcery/model.rb")

Show comments

[View file](/Sorcery/sorcery/blob/0f116d223826895a73b12492f17486e5d54ab7a7/lib/sorcery/model.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -102,10 +102,6 @@ def authenticate(\*credentials, &block) |
|  |  |  |
|  |  | set\_encryption\_attributes |
|  |  |  |
|  |  | unless user.valid\_password?(credentials[1]) |
|  |  | return authentication\_response(user: user, failure: :invalid\_password, &block) |
|  |  | end |
|  |  |  |
|  |  | if user.respond\_to?(:active\_for\_authentication?) && !user.active\_for\_authentication? |
|  |  | return authentication\_response(user: user, failure: :inactive, &block) |
|  |  | end |
| Expand All | | @@ -118,6 +114,10 @@ def authenticate(\*credentials, &block) |
|  |  | end |
|  |  | end |
|  |  |  |
|  |  | unless user.valid\_password?(credentials[1]) |
|  |  | return authentication\_response(user: user, failure: :invalid\_password, &block) |
|  |  | end |
|  |  |  |
|  |  | authentication\_response(user: user, return\_value: user, &block) |
|  |  | end |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0f116d2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSorcery%2Fsorcery%2Fcommit%2F0f116d223826895a73b12492f17486e5d54ab7a7) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


