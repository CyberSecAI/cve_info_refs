=== Content from uncensored.citadel.org_9f9fac16_20250119_113401.html ===

no

You must be logged in to access this page.

Close window ![Close window](static/webcit_icons/closewindow.gif)

* Uncensored

## Log in using a user name and password

User name:

Password:

Log in
New user? Register now

## New user? Register now

enter the name and password you wish to use, and click "New User."

User name:

Password:

New User

## Log in using OpenID

OpenID URL:

Log in

## Log in using Google

Log in

## Log in using Yahoo

Log in

## Log in using AOL or AIM

Enter your AOL or AIM screen name:

Log in

# Please wait...

![Powered by Citadel](/static/citadel-logo.gif)

Language:

en\_US

* [Summary](summary "Your summary page")
* [![+](static/webcit_icons/expand.gif)
  Rooms](knrooms?template=knrooms?SortBy=byfloorroom?SortOrder=1 "List all your accessible rooms")
  Loading
* [![+](static/webcit_icons/expand.gif)
  Online users](do_template?template=who "See who is online right now")
  + Loading

Log in

switch to room list
switch to menu
My folders

UNREADMSGS new of TOTALMSGS messages

|  | [Citadel Security](/readnew?go=Citadel%20Security)[RSS](/feed_rss?go=Citadel%20Security) 74 new of 74 messages | Please discuss and report any ...  Please discuss and report any and all vulnerabilities here FIRST before reporting them to a national database. BE REALISTIC. Don't let your youthful optimism, idealism, and sense of do-goodery shoot thisproject in the foot. THERE ARE REALITIES TO THOSE REPORTS. Also, According to both NIST & Mitre "You should make a GOOD FAITH EFFORT to NOTIFY the affected vendor and WORK WITH THEM to ENSURE that a patch is available PRIOR to PUBLICLY DISCLOSING the vulnerability." https://cve.mitre.org/cve/researcher\_reservation\_guidelines#researcher\_reservation\_guidelines#2 In other words, lets talk BEFORE you report/disclose publicly. Dropping unwitting CVEs on us causes much wasted effort and many other problems. It is time spent chasing the unnecessary, which couldgo into actually fixing problems. Even so, we're all about that netsec. Please come and join us. | * Not logged in. * Search: * View as:   Bulletin Board   Mail Folder   Blog * Select page: |
| --- | --- | --- | --- |

* [![](static/webcit_icons/essen/16x16/ungoto.png)
  Ungoto](ungoto)
* [![](static/webcit_icons/essen/16x16/readallmsg.png)
  Refresh message list](readfwd)
* ![](static/webcit_icons/essen/16x16/delete.png)
  Delete
* ![](static/webcit_icons/essen/16x16/pencil.png)
  Write mail
* [![](static/webcit_icons/essen/16x16/skiproom.png)
  Skip this room](skip "Leave all messages marked as unread, go to next room with unread messages")
* [![](static/webcit_icons/essen/16x16/nextroom.png)
  Goto next room](gotonext "Mark all messages as read, go to next room with unread messages")

| Subject | Sender | Date |
| --- | --- | --- |

|  | | | |
| --- | --- | --- | --- |

![](static/webcit_icons/throbber.gif)

Loading messages from server, please wait

Open in new window

Move

Copy

Delete

Print

WARNING: You have JavaScript disabled in your web browser. Many functions of this system will not work properly.



=== Content from uncensored.citadel.org_6c2a745a_20250119_113401.html ===

Tue Aug 04 2020 10:05:24 UTC
from
[Murgi](do_template?template=user_show?who=Murgi)

Subject: STARTTLS Command injection in IMAP, POP3, and SMTP

[[Edit]](display_enter?edit=4576039?recp=?cc=?subject=STARTTLS%20Command%20injection%20in%20IMAP,%20POP3,%20and%20SMTP?force_room=_MAIL_)
[Reply]
[ReplyAll]
[Forward]
[Headers]
[Print]

Hello,

during our research in e-mail servers at Münster University of Applied Sciences, we found some security issues in the STARTTLS implementation of the current version of Citadel.

Description

These issues potentially allow a meddler-in-the-middle (MitM) attacker to leak user credentials by injecting plaintext commands into the encrypted TLS stream. This vulnerability was first described by Wietse Venema for Postfix in 2011 (<http://www.postfix.org/CVE-2011-0411.html>). We found that Citadel is vulnerable to this kind of injection in IMAP, POP3, and SMTP. Basically, by injecting plaintext commands between the STARTTLS command an the TLS Handshake, a MitM can cause theirs plaintext commands to be interpreted in the encrypted context. See these SMTP trace from Citadel for example:

Normal:

With command injection:

S: 220 ebb7034d4bf5 ESMTP Citadel server ready.
 C: EHLO buftest
 S: 250-Hello buftest (172.17.0.1 [172.17.0.1])
 S: 250-HELP
 S: 250-SIZE 10485760
 S: 250-STARTTLS
 S: 250-AUTH LOGIN PLAIN
 S: 250-AUTH=LOGIN PLAIN
 S: 250 8BITMIME
 C: STARTTLS
 A: NOOP
 S: 220 Begin TLS negotiation now
 <----- TLS Handshake ----->
 S: 250 NOOP
 - Command injection here!

As you can see, the attacker injected NOOP command (A: NOOP) is interpreted by citadel inside the encrypted context, even though it was sent in plain. The same is possible for POP3 and IMAP.

Proof of Concept

As this is a vulnerability affecting multiple vendors/servers, I can currently not publicly disclose our test script for this. However, I can send it to the developers privately if requested.

Security Impact

For SMTP and IMAP, this vulnerability can be used to leak user credentials to an attacker, e.g., by enclosing them into an e-mail send to the attacker by injecting the MAIL FROM, RCPT TO, and DATA verbs into the encrypted session. Additionally, this vulnerability can be used for cross-protocol attacks on server sharing a TLS certificate with citadel. In IMAP this can, for example, be used to host HTTPS without actually attacking TLS. In POP3, fortunately, the impact is currently limited, but this vulnerability might be used in more elaborate attacks.

Best regards,
Murgi


