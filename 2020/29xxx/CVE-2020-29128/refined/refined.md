```
{
  "vulnerability": {
    "CVE": "CVE-2020-29128",
    "summary": "XXE vulnerability in petl < 1.68",
    "details": "The `fromxml` function in the `petl.io.xml` module, when configured to use the `lxml` library, is vulnerable to XML External Entity (XXE) injection. By default, `lxml` is configured to resolve local entities. An attacker who can submit crafted XML input to an application using petl can disclose arbitrary files on the file system in the context of the user running the application.",
    "affected_applications": "Applications that:\n\n*   accept user-supplied XML input that is processed using `petl` < 1.68\n*   configure `lxml` as the underlying XML processing library used by `petl`",
     "root_cause": "The vulnerability exists because the `fromxml` function in `petl` versions prior to 1.68 creates an `lxml` parser with default settings, which allows the resolution of local entities in the XML input.",
    "weaknesses": [
      "XML External Entity (XXE) injection"
    ],
    "impact": "Information Disclosure - An attacker can read arbitrary files from the filesystem of the server running the application.",
    "attack_vectors": [
      "The attacker must be able to supply crafted XML input to the vulnerable application using `petl` < 1.68 which uses `lxml` as the XML processing library."
    ],
    "required_capabilities": "The attacker must be able to submit XML input that will be parsed by the vulnerable function. They also need to understand how to craft a malicious XML document to extract the information they are targeting.",
    "mitigation": "Update to `petl` >= 1.68.  Also, avoid using the vulnerable `fromxml` function if possible, and ensure there is no user/external access to the application using petl.",
    "references": [
        "https://github.com/nvn1729/advisories/blob/master/cve-2020-29128.md",
        "https://github.com/petl-developers/petl/pull/527",
        "https://petl.readthedocs.io/en/stable/changes.html",
        "https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing",
        "https://github.com/petl-developers/petl/releases/tag/v1.6.8",
        "https://github.com/petl-developers/petl/security/advisories/GHSA-f5gc-p5m3-v347"
     ]
  }
}
```