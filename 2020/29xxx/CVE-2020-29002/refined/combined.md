=== Content from phabricator.wikimedia.org_75f4501b_20250119_141535.html ===
[HomePhabricator](/)

* SearchConfigure Global Search
 [Auth](/auth/)  Login

Click the *MediaWiki* button below to connect your [Wikimedia unified account](https://meta.wikimedia.org/wiki/Help%3AUnified_login). Alternatively, click the *Wikitech Account (LDAP)* button to connect your [Developer account](https://www.mediawiki.org/wiki/Developer_account) credentials.

In case of doubt, [check the Phabricator Help](https://www.mediawiki.org/wiki/Phabricator/Help#Creating_your_account).

Log In or RegisterMediaWikiDeveloper Account Log InLDAP Account (IDP)
# Log In or Register with LDAP

LDAP UsernameLDAP PasswordLog In or RegisterTrouble logging in? [Send a login link to your email address.](/login/email/)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from phabricator.wikimedia.org_057a7711_20250119_124240.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT267278)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T267278
# XSS vulnerability in CologneBlue (CVE-2020-29002)Closed, Resolved[Public](/policy/explain/PHID-TASK-pfbj3qtuje7jwbv2sfm7/view/)SecurityActions

* [Edit Task](/maniphest/task/edit/267278/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/267278/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-pfbj3qtuje7jwbv2sfm7/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-pfbj3qtuje7jwbv2sfm7/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-pfbj3qtuje7jwbv2sfm7/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-pfbj3qtuje7jwbv2sfm7/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-pfbj3qtuje7jwbv2sfm7/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-pfbj3qtuje7jwbv2sfm7/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-pfbj3qtuje7jwbv2sfm7/)
* [Protect as security issue](/wmf/escalate-task/267278/)
* [Award Token](/token/give/PHID-TASK-pfbj3qtuje7jwbv2sfm7/)
* [Flag For Later](/flag/edit/PHID-TASK-pfbj3qtuje7jwbv2sfm7/)

Assigned To

|  | [matmarex](/p/matmarex/) |
| --- | --- |

Authored By

|  | [Jdlrobson](/p/Jdlrobson/) |
| --- | --- |
| Nov 4 2020, 10:57 PM2020-11-04 22:57:23 (UTC+0) |

Tags

* [Security-Team](/tag/security-team/) [(Our Part Is Done)](/project/board/1179/)
* [Security](/tag/security/)
* [Vuln-XSS](/tag/vuln-xss/)
* [CologneBlue](/tag/cologneblue/) [(Backlog)](/project/board/322/)
* [MW-1.36-notes (1.36.0-wmf.14; 2020-10-20)](/project/view/5027/)
* [MW-1.35-notes](/tag/mw-1.35-notes/)
Referenced Files

|  | [F32438524: 0001-Fix-escaping-of-the-qbfind-message.patch](/F32438524) |
| --- | --- |
| Nov 5 2020, 6:33 PM2020-11-05 18:33:13 (UTC+0) |

Subscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [Ammarpad](/p/Ammarpad/) |
| --- | --- |

|  | [Daimona](/p/Daimona/) |
| --- | --- |

|  | [DannyS712](/p/DannyS712/) |
| --- | --- |

|  | [Jdlrobson](/p/Jdlrobson/) |
| --- | --- |

|  | [matmarex](/p/matmarex/) |
| --- | --- |

|  | [Reedy](/p/Reedy/) |
| --- | --- |

[View All 9 Subscribers](/subscriptions/list/PHID-TASK-pfbj3qtuje7jwbv2sfm7/)
# Description

this was flagged by [@Daimona](/p/Daimona/) on the review of [https://gerrit.wikimedia.org/r/c/mediawiki/skins/CologneBlue/+/637771/2/includes/CologneBlueTemplate.php#395](https://gerrit.wikimedia.org/r/c/mediawiki/skins/CologneBlue/%2B/637771/2/includes/CologneBlueTemplate.php#395)

Set the qbfind message to:

"<script>alert(0);</script>Findz",`

Cologne blue will alert 0.

This happens in current master and was only flagged(noticing) during adjustments to the code.

# Details

Author Affiliation WMF Product

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [SECURITY: Fix escaping of the 'qbfind' message](https://gerrit.wikimedia.org/r/c/640195) | [mediawiki/skins/CologneBlue](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue) | [REL1\_31](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue/%2B/REL1_31) | +1 -1 |
|  | [SECURITY: Fix escaping of the 'qbfind' message](https://gerrit.wikimedia.org/r/c/640194) | [mediawiki/skins/CologneBlue](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue) | [REL1\_34](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue/%2B/REL1_34) | +1 -1 |
|  | [SECURITY: Fix escaping of the 'qbfind' message](https://gerrit.wikimedia.org/r/c/639657) | [mediawiki/skins/CologneBlue](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue) | [REL1\_35](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue/%2B/REL1_35) | +1 -1 |
|  | [SECURITY: Fix escaping of the 'qbfind' message](https://gerrit.wikimedia.org/r/c/639656) | [mediawiki/skins/CologneBlue](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue) | [wmf/1.36.0-wmf.16](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue/%2B/wmf/1.36.0-wmf.16) | +1 -1 |
|  | [SECURITY: Fix escaping of the 'qbfind' message](https://gerrit.wikimedia.org/r/c/639655) | [mediawiki/skins/CologneBlue](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue) | [wmf/1.36.0-wmf.14](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue/%2B/wmf/1.36.0-wmf.14) | +1 -1 |
|  | [SECURITY: Fix escaping of the 'qbfind' message](https://gerrit.wikimedia.org/r/c/639652) | [mediawiki/skins/CologneBlue](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue) | [wmf/1.35.0-wmf.16](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue/%2B/wmf/1.35.0-wmf.16) | +1 -1 |
|  | [SECURITY: Fix escaping of the 'qbfind' message](https://gerrit.wikimedia.org/r/c/639653) | [mediawiki/skins/CologneBlue](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue) | [wmf/1.35.0-wmf.14](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue/%2B/wmf/1.35.0-wmf.14) | +1 -1 |
|  | [SECURITY: Fix escaping of the 'qbfind' message](https://gerrit.wikimedia.org/r/c/639618) | [mediawiki/skins/CologneBlue](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/skins/CologneBlue/%2B/master) | +1 -1 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T267278)
# Related Objects

* Mentions

Mentioned In [T115430: Undeploy the 'Cologne Blue' and 'Modern' skins from Wikimedia production](/T115430)
[T263810: Write and send supplementary release announcement for extensions and skins with security patches (1.31.11/1.35.1)](/T263810) Mentioned Here [T263810: Write and send supplementary release announcement for extensions and skins with security patches (1.31.11/1.35.1)](/T263810)
[T2212: Some MediaWiki: messages not safe in HTML (tracking)](/T2212)
### Event Timeline

[Jdlrobson](/p/Jdlrobson/) created this task.[Nov 4 2020, 10:57 PM2020-11-04 22:57:23 (UTC+0)](#6604595)Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  · [View Herald Transcript](/herald/transcript/3974287/)[Nov 4 2020, 10:57 PM2020-11-04 22:57:24 (UTC+0)](#6604606)

[Daimona](/p/Daimona/) added a comment.[Nov 4 2020, 10:58 PM2020-11-04 22:58:07 (UTC+0)](#6604607)Comment Actions

Urgh, I'm sorry. I didn't realize master was already affected.

[Jdlrobson](/p/Jdlrobson/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-7j3e42fjlbhvf6l/)[Nov 4 2020, 11:13 PM2020-11-04 23:13:53 (UTC+0)](#6604616)[Jdlrobson](/p/Jdlrobson/) added a subscriber: [Ammarpad](/p/Ammarpad/).[Urbanecm](/p/Urbanecm/) triaged this task as High priority.[Nov 5 2020, 1:16 AM2020-11-05 01:16:30 (UTC+0)](#6604755)[Urbanecm](/p/Urbanecm/) added projects: [Vuln-XSS](/tag/vuln-xss/), [CologneBlue](/tag/cologneblue/).[Urbanecm](/p/Urbanecm/) added subscribers: [matmarex](/p/matmarex/), [DannyS712](/p/DannyS712/).[Urbanecm](/p/Urbanecm/) subscribed.[matmarex](/p/matmarex/) added a comment.[Nov 5 2020, 6:28 PM2020-11-05 18:28:34 (UTC+0)](#6607071)Comment Actions

I don't think this needs to be a security task. This is a system message, and so it's only vulnerable to administrators. We have a public tracking task for issues like this ([T2212](/T2212)). We should just submit a patch to Gerrit and merge it.

[matmarex](/p/matmarex/) added a comment.[Nov 5 2020, 6:33 PM2020-11-05 18:33:13 (UTC+0)](#6607088)Comment Actions

Let me know if I shouldn't just submit the patch to Gerrit. Otherwise I'll do it tomorrow.

0001-Fix-escaping-of-the-qbfind-message.patch862 B[Download](https://phab.wmfusercontent.org/file/download/3c2kwmnxowbxyxskk5im/PHID-FILE-rnq3j75czx2rk45cnpro/0001-Fix-escaping-of-the-qbfind-message.patch)

[Daimona](/p/Daimona/) added a comment.[Nov 5 2020, 6:38 PM2020-11-05 18:38:16 (UTC+0)](#6607104)Comment Actions
> In [T267278#6607071](/T267278#6607071), [@matmarex](/p/matmarex/) wrote:
>
> I don't think this needs to be a security task. This is a system message, and so it's only vulnerable to administrators. We have a public tracking task for issues like this ([T2212](/T2212)). We should just submit a patch to Gerrit and merge it.

That's true, although I can remember of some similar tasks being kept sec-protected and assigned a CVE recently. Just because exploiting is presumably hard (but who knows, perhaps there's a workaround to being administrators), it's still a possible attack vector: you only need to compromise a sysop account, which is likely much easier than compromising an IA account. So I'd be paranoid and keep it protected. As for the fix, I guess it can be pushed on gerrit as long as someone is around to sec-deploy it.

Either way, I'm obviously leaving this up to the SecTeam (and approving your patch, just in case).

[sbassett](/p/sbassett/) subscribed.Edited · [Nov 5 2020, 6:38 PM2020-11-05 18:38:43 (UTC+0)](#6607106)Comment Actions
> In [T267278#6607088](/T267278#6607088), [@matmarex](/p/matmarex/) wrote:
>
> Let me know if I shouldn't just submit the patch to Gerrit. Otherwise I'll do it tomorrow.

+1 to the patch above and this is **low risk** to go to gerrit IMO, as the issue was already publicly-flagged in gerrit and I'm not seeing anything remotely suspicious within any of [the existing messages](https://codesearch.wmcloud.org/search/?q=qbfind&i=nope&files=&repos=) after a quick audit.

[Jdlrobson](/p/Jdlrobson/) added a comment.[Nov 5 2020, 6:40 PM2020-11-05 18:40:13 (UTC+0)](#6607109)Comment Actions

Great. I'm happy to merge this Bartosz if you want to throw it up onto Gerrit!

[sbassett](/p/sbassett/) added a comment.Edited · [Nov 5 2020, 6:43 PM2020-11-05 18:43:47 (UTC+0)](#6607124)Comment Actions
> In [T267278#6607104](/T267278#6607104), [@Daimona](/p/Daimona/) wrote:
>
> That's true, although I can remember of some similar tasks being kept sec-protected and assigned a CVE recently.

Yes, I'll likely track this for the upcoming supplemental security announcement ([T263810](/T263810)), though since [the skin is no longer bundled](https://www.mediawiki.org/wiki/Bundled_extensions_and_skins), once the patch is merged and deployed, this task can be made public and then any relevant backports can be completed. This probably does warrant a CVE as it's still a viable XSS under certain circumstances, so I'll likely eventually request one.

> Just because exploiting is presumably hard (but who knows, perhaps there's a workaround to being administrators), it's still a possible attack vector: you only need to compromise a sysop account, which is likely much easier than compromising an IA account. So I'd be paranoid and keep it protected. As for the fix, I guess it can be pushed on gerrit as long as someone is around to sec-deploy it.

Yes, agreed. I'm hopeful the merge/deploy can happen quickly. If not, I'm happy to sec-deploy it once the patch is merged.

[sbassett](/p/sbassett/) mentioned this in [T263810: Write and send supplementary release announcement for extensions and skins with security patches (1.31.11/1.35.1)](/T263810).[Nov 5 2020, 6:49 PM2020-11-05 18:49:22 (UTC+0)](#6607138)[sbassett](/p/sbassett/) added a project: [Patch-For-Review](/tag/patch-for-review/).[Nov 5 2020, 8:14 PM2020-11-05 20:14:02 (UTC+0)](#6607433)Comment Actions

Ok, the patch is up for review ([@Jdlrobson](/p/Jdlrobson/) et al):

<https://gerrit.wikimedia.org/r/639618>

If we could get this reviewed and merged soon, that'd be great.

[Jdforrester-WMF](/p/Jdforrester-WMF/) added projects: [MW-1.36-notes (1.36.0-wmf.14; 2020-10-20)](/project/view/5027/), [MW-1.35-notes](/tag/mw-1.35-notes/).[Nov 7 2020, 12:50 AM2020-11-07 00:50:50 (UTC+0)](#6610259)[sbassett](/p/sbassett/) lowered the priority of this task from High to Low.[Nov 9 2020, 4:35 PM2020-11-09 16:35:15 (UTC+0)](#6613838)[sbassett](/p/sbassett/) moved this task from [Incoming](/project/board/1179/) to [Watching](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[sbassett](/p/sbassett/) added a subscriber: [Reedy](/p/Reedy/).Comment Actions

This fix was deployed to production ([1](https://sal.toolforge.org/log/BmVZn3UBpU87LSFJ_xtz), [2](https://sal.toolforge.org/log/3UxYn3UBgTbpqNOmoGpu), tx [@Reedy](/p/Reedy/)!). I'm tracking this task for the next supplemental release: [T263810](/T263810). So we can likely make this task public soon and work on any relevant backports and requesting the CVE.

[sbassett](/p/sbassett/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-n2fpjy7ejao4vwz/)" to "Public (No Login Required)".[Nov 9 2020, 10:29 PM2020-11-09 22:29:31 (UTC+0)](#6615026)[gerritbot](/p/gerritbot/) added a comment.[Nov 9 2020, 10:29 PM2020-11-09 22:29:47 (UTC+0)](#6615027)Comment Actions

Change 640194 had a related patch set uploaded (by SBassett; owner: Bartosz Dziewoński):

[mediawiki/skins/CologneBlue@REL1\_34] SECURITY: Fix escaping of the 'qbfind' message

<https://gerrit.wikimedia.org/r/640194>

[gerritbot](/p/gerritbot/) added a comment.[Nov 9 2020, 10:30 PM2020-11-09 22:30:36 (UTC+0)](#6615028)Comment Actions

Change 640195 had a related patch set uploaded (by SBassett; owner: Bartosz Dziewoński):

[mediawiki/skins/CologneBlue@REL1\_31] SECURITY: Fix escaping of the 'qbfind' message

<https://gerrit.wikimedia.org/r/640195>

[gerritbot](/p/gerritbot/) added a comment.[Nov 9 2020, 10:44 PM2020-11-09 22:44:11 (UTC+0)](#6615072)Comment Actions

Change 640194 **merged** by jenkins-bot:

[mediawiki/skins/CologneBlue@REL1\_34] SECURITY: Fix escaping of the 'qbfind' message

<https://gerrit.wikimedia.org/r/640194>

[gerritbot](/p/gerritbot/) added a comment.[Nov 10 2020, 8:36 PM2020-11-10 20:36:18 (UTC+0)](#6617506)Comment Actions

Change 640195 **merged** by SBassett:

[mediawiki/skins/CologneBlue@REL1\_31] SECURITY: Fix escaping of the 'qbfind' message

<https://gerrit.wikimedia.org/r/640195>

[sbassett](/p/sbassett/) renamed this task from XSS vulnerability in CologneBlue to XSS vulnerability in CologneBlue (CVE-2020-29002).[Dec 1 2020, 5:45 PM2020-12-01 17:45:10 (UTC+0)](#6660482)[sbassett](/p/sbassett/) closed this task as Resolved.[Dec 1 2020, 5:54 PM2020-12-01 17:54:52 (UTC+0)](#6660493)[sbassett](/p/sbassett/) assigned this task to [matmarex](/p/matmarex/).[sbassett](/p/sbassett/) moved this task from [Watching](/project/board/1179/) to [Our Part Is Done](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[sbassett](/p/sbassett/) removed a project: [Patch-For-Review](/tag/patch-for-review/).[matmarex](/p/matmarex/) mentioned this in [T115430: Undeploy the 'Cologne Blue' and 'Modern' skins from Wikimedia production](/T115430).[Nov 20 2024, 7:25 PM2024-11-20 19:25:19 (UTC+0)](#10341647)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from gerrit.wikimedia.org_9f877d35_20250119_141534.html ===




=== Content from gerrit.wikimedia.org_75c2a338_20250119_124238.html ===



