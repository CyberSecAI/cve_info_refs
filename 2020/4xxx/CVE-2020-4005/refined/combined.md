=== Content from www.vmware.com_80615780_20250119_121850.html ===


Menu

* [Products](https://www.broadcom.com/products/)
* [Solutions](https://www.broadcom.com/solutions)
* [Support and Services](https://www.broadcom.com/support)
* [Company](https://www.broadcom.com/company/about-us/)
* [How To Buy](https://www.broadcom.com/how-to-buy/#sales)

* Log in

  [Log In](/c/portal/login)
  [Register](https://profile.broadcom.com/web/registration)

[Register](https://profile.broadcom.com/web/registration)
[Login](/c/portal/login)

VMSA-2020-0026:VMware ESXi, Workstation and Fusion updates address use-after-free and privilege escalation vulnerabilities

Product/Component

VMware Cloud Foundation

2 more products

List of Products

3 Products

* VMware Cloud Foundation
* VMware Desktop Hypervisor
* VMware vSphere ESXi

Notification Id

23583

Last Updated

22 November 2020

Initial Publication Date

17 November 2020

Status

CLOSED

Severity

CRITICAL

CVSS Base Score

8.8 - 9.3

WorkAround

Affected CVE

CVE-2020-4004,CVE-2020-4005

             Advisory ID: VMSA-2020-0026.1   CVSSv3 Range: 8.8 - 9.3   Issue Date:2020-11-19   Updated On: 2020-11-24    CVE(s): CVE-2020-4004, CVE-2020-4005   Synopsis: VMware ESXi, Workstation and Fusion updates address use-after-free and privilege escalation vulnerabilities (CVE-2020-4004, CVE-2020-4005)

 [RSS Feed](https://www.vmware.com/security/advisories/VMSA-2020-0026.xml)

 Download PDF

 Download Text File

Share this page on social media:

##### **1. Impacted Products**

* VMware ESXi
* VMware Workstation Pro / Player (Workstation)
* VMware Fusion Pro / Fusion (Fusion)
* VMware Cloud Foundation (Cloud Foundation)

##### **2. Introduction**

Multiple vulnerabilities in VMware ESXi, Workstation and Fusion were privately reported to VMware. Updates are available to remediate these vulnerabilities in affected VMware products.

##### **3a. Use-after-free vulnerability in XHCI USB controller (CVE-2020-4004)**

**Description**

VMware ESXi, Workstation, and Fusion contain a use-after-free vulnerability in the XHCI USB controller. VMware has evaluated the severity of this issue to be in the [Critical severity range](https://www.vmware.com/support/policies/security_response.html) with a maximum CVSSv3 base score of [9.3](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H).

**Known Attack Vectors**

A malicious actor with local administrative privileges on a virtual machine may exploit this issue to execute code as the virtual machine's VMX process running on the host.

**Resolution**

To remediate CVE-2020-4004 apply the patches listed in the 'Fixed Version' column of the 'Response Matrix' found below.

**Workarounds**

Workarounds for CVE-2020-4004 have been listed in the 'Workarounds' column of the 'Response Matrix' below.

**Additional Documentation**

None.

**Acknowledgements**

VMware would like to thank Xiao Wei and Tianwen Tang (VictorV) of Qihoo 360 Vulcan Team working with the 2020 Tianfu Cup Pwn Contest for reporting this issue to us.

**Notes**

None.

**Response Matrix:**

| Product | Version | Running On | CVE Identifier | CVSSv3 | Severity | Fixed Version | Workarounds | Additional Documentation |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ESXi | 7.0 | Any | CVE-2020-4004 | [9.3](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H) | critical | ESXi70U1b-17168206 | [Remove XHCI (USB 3.x) controller](https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.vm_admin.doc/GUID-ACA30034-EC88-491B-8D8B-4E319611C308.html) | None |
| ESXi | 6.7 | Any | CVE-2020-4004 | [9.3](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H) | critical | ESXi670-202011101-SG | [Remove XHCI (USB 3.x) controller](https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.vm_admin.doc/GUID-ACA30034-EC88-491B-8D8B-4E319611C308.html) | None |
| ESXi | 6.5 | Any | CVE-2020-4004 | [9.3](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H) | critical | ESXi650-202011301-SG | [Remove XHCI (USB 3.x) controller](https://docs.vmware.com/en/VMware-vSphere/6.5/com.vmware.vsphere.vm_admin.doc/GUID-ACA30034-EC88-491B-8D8B-4E319611C308.html) | None |
| Fusion | 12.x | OS X | CVE-2020-4004 | N/A | N/A | Unaffected | N/A | N/A |
| Fusion | 11.x | OS X | CVE-2020-4004 | [9.3](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H) | critical | 11.5.7 | [Remove XHCI (USB 3.x) controller](https://kb.vmware.com/s/article/79712) | None |
| Workstation | 16.x | Any | CVE-2020-4004 | N/A | N/A | Unaffected | N/A | N/A |
| Workstation | 15.x | Any | CVE-2020-4004 | [9.3](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H) | critical | 15.5.7 | [Remove XHCI (USB 3.x) controller](https://kb.vmware.com/s/article/79712) | None |
| VMware Cloud Foundation (ESXi) | 4.x | Any | CVE-2020-4004 | [9.3](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H) | critical | 4.1.0.1 | [Remove XHCI (USB 3.x) controller](https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.vm_admin.doc/GUID-ACA30034-EC88-491B-8D8B-4E319611C308.html) | None. |
| VMware Cloud Foundation (ESXi) | 3.x | Any | CVE-2020-4004 | [9.3](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H) | critical | 3.10.1.2 | [Remove XHCI (USB 3.x) controller](https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.vm_admin.doc/GUID-ACA30034-EC88-491B-8D8B-4E319611C308.html) | None |

##### **3b. VMX elevation-of-privilege vulnerability (CVE-2020-4005)**

**Description**

VMware ESXi contains a privilege-escalation vulnerability that exists in the way certain system calls are being managed. VMware has evaluated the severity of this issue to be in the [Important severity range](https://www.vmware.com/support/policies/security_response.html) with a maximum CVSSv3 base score of [8.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H).

**Known Attack Vectors**

A malicious actor with privileges within the VMX process only, may escalate their privileges on the affected system. Successful exploitation of this issue is only possible when chained with another vulnerability (e.g. CVE-2020-4004).

**Resolution**

To remediate CVE-2020-4005 apply the patches listed in the 'Fixed Version' column of the 'Response Matrix' found below.

**Workarounds**

None.

**Additional Documentation**

None.

**Acknowledgements**

VMware would like to thank Xiao Wei and Tianwen Tang (VictorV) of Qihoo 360 Vulcan Team working with the 2020 Tianfu Cup Pwn Contest for reporting this issue to us.

**Notes**

None.

**Response Matrix:**

| Product | Version | Running On | CVE Identifier | CVSSv3 | Severity | Fixed Version | Workarounds | Additional Documentation |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| ESXi | 7.0 | Any | CVE-2020-4005 | [8.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H) | important | ESXi70U1b-17168206 | None | None |
| ESXi | 6.7 | Any | CVE-2020-4005 | [8.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H) | important | ESXi670-202011101-SG | None | None |
| ESXi | 6.5 | Any | CVE-2020-4005 | [8.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H) | important | ESXi650-202011301-SG | None | None |
| VMware Cloud Foundation (ESXi) | 4.x | Any | CVE-2020-4005 | [8.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H) | important | 4.1.0.1 | None | None |
| VMware Cloud Foundation (ESXi) | 3.x | Any | CVE-2020-4005 | [8.8](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H) | important | 3.10.1.2 | None | None |

##### **4. References**

****VMware ESXi 7.0 ESXi70U1b-17168206**** Downloads and Documentation:
 <https://my.vmware.com/group/vmware/patch>
<https://docs.vmware.com/en/VMware-vSphere/7.0/rn/vsphere-esxi-70u1b.html>

**VMware ESXi 6.7 ESXi670-202011101-SG** Downloads and Documentation:
 <https://my.vmware.com/group/vmware/patch>
 <https://docs.vmware.com/en/VMware-vSphere/6.7/rn/esxi670-202011002.html>

**VMware ESXi 6.5 ESXi650-202011301-SG** Downloads and Documentation:
 <https://my.vmware.com/group/vmware/patch>
 <https://docs.vmware.com/en/VMware-vSphere/6.5/rn/esxi650-202011002.html>

**VMware Workstation Pro 15.5.7** Downloads and Documentation:
<https://www.vmware.com/go/downloadworkstation>
<https://docs.vmware.com/en/VMware-Workstation-Pro/index.html>

**VMware Workstation Player 15.5.7** Downloads and Documentation:
<https://www.vmware.com/go/downloadplayer>
<https://docs.vmware.com/en/VMware-Workstation-Player/index.html>

**VMware Fusion 11.5.7** Downloads and Documentation:
<https://www.vmware.com/go/downloadfusion>
<https://docs.vmware.com/en/VMware-Fusion/index.html>

**VMware vCloud Foundation 4.1.0.1**<https://docs.vmware.com/en/VMware-Cloud-Foundation/4.1/rn/VMware-Cloud-Foundation-41-Release-Notes.html#4.1.0.1>

**VMware vCloud Foundation 3.10.1.2**<https://docs.vmware.com/en/VMware-Cloud-Foundation/3.10.1/rn/VMware-Cloud-Foundation-3101-Release-Notes.html#3.10.1.2>

**Mitre CVE Dictionary Links:** <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-4004>
 <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-4005>

**FIRST CVSSv3 Calculator:**[CVE-2020-4004 - https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
 CVE-2020-4005 - https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H)

##### **5. Change Log**

**2020-11-19 VMSA-2020-0026**
Initial security advisory.

**2020-11-24 VMSA-2020-0026.1**
Updated security advisory to add VMware Cloud Foundation 3.x and 4.x versions in the response matrix of sections 3(a) and 3(b).

##### **6. Contact**

E-mail list for product security notifications and announcements:

<https://lists.vmware.com/cgi-bin/mailman/listinfo/security-announce>

This Security Advisory is posted to the following lists:

[[email protected]](/cdn-cgi/l/email-protection#bfccdadccacdd6cbc692ded1d1d0cad1dcdaffd3d6cccbcc91c9d2c8decdda91dcd0d2)

[[email protected]](/cdn-cgi/l/email-protection#bcdec9dbc8ceddcdfccfd9dfc9ced5c8c5dad3dfc9cf92dfd3d1)

[[email protected]](/cdn-cgi/l/email-protection#85e3f0e9e9e1ecf6e6e9eaf6f0f7e0c5f6e0e6e9ecf6f1f6abeaf7e2)

E-mail: [[email protected]](/cdn-cgi/l/email-protection#780b1d1b0d0a110c01380e150f190a1d561b1715)

PGP key at:

<https://kb.vmware.com/kb/1055>

VMware Security Advisories

<https://www.vmware.com/security/advisories>

VMware Security Response Policy

<https://www.vmware.com/support/policies/security_response.html>

VMware Lifecycle Support Phases

<https://www.vmware.com/support/policies/lifecycle.html>

VMware Security & Compliance Blog

<https://blogs.vmware.com/security>

Twitter

<https://twitter.com/VMwareSRC>

Copyright 2020 VMware Inc. All rights reserved.

Hidden

#####

×

It appears your Broadcom Products and Services are

supported by one of our certified Support partners

Click below to be redirected to the appropriate Support

Partner Portal to request support

For non-product related issues (Support Portal / Licensing) Click HERE

Continue

#####

×

For **Technical Support** (issues with products or services)

1. Select **Technical** to be redirected to the My Entitlements page
2. Expand the product you require support on
3. Select the case icon from the case column
4. You will be redirected to the appropriate vendor portal where you can raise your technical request

For **Non-Technical Support** (issues with portal access, license keys, software downloads)

1. Select **Non-Technical** to be redirected to Broadcom's case management portal

Technical
Non-Technical

#####

×

# Access Denied

This feature has been disabled by your administrator.

#####

×

To prevent this message from showing again, please enable pop-up blockers for [support.broadcom.com](https://support.broadcom.com/)
or click Continue to proceed.

Continue

Top

* [Products](https://www.broadcom.com/products)
* [Solutions](https://www.broadcom.com/solutions)
* [Support and Services](https://www.broadcom.com/support)
* [Company](https://www.broadcom.com/)
* [How to Buy](https://www.broadcom.com/how-to-buy)

 Copyright © 2005-2024 Broadcom. All Rights Reserved. The term “Broadcom” refers to Broadcom Inc. and/or its subsidiaries.

* [Accessibility](https://www.broadcom.com/company/legal/accessibility)
* [Privacy](https://www.broadcom.com/company/legal/privacy)
* [Supplier Responsibility](https://www.broadcom.com/company/citizenship/supplier-responsibility)
* [Terms of Use](https://www.broadcom.com/company/legal/terms-of-use)
* [Site Map](https://www.broadcom.com/sitemap)



=== Content from docs.vmware.com_ff6c0ac0_20250119_135838.html ===


[![](/uicontent/images/VMware_by_Broadcom.png)Docs](/)

* ![](/uicontent/images/VMware_by_Broadcom_Gray-Black.png) Docs
  times
* [(current)](/)

* ![](/uicontent/images/nwMyLibrary.png)
  #####

  ![](/uicontent/images/icon-handshake.png)

  ![](/uicontent/images/icon-support.png)

  ![](/uicontent/images/icon-networking-bg.png)
  [VMware Communities](https://communities.vmware.com/)

  ![](/uicontent/images/icon-download-bg.png)

 This site will be decommissioned on January 30th 2025. After that date content will be available at [techdocs.broadcom.com](https://techdocs.broadcom.com/).

![](/uicontent/images/share-mylibrary.svg)

![](/uicontent/images/add-to-library-colorless.svg)

#

![](/uicontent/images/twitter.svg)
![](/uicontent/images/facebook.svg)
![](/uicontent/images/linkedin.svg)
![](/uicontent/images/weibo.svg)

![](/uicontent/images/pdf.svg)

![](/uicontent/images/feedback.svg)

![](/uicontent/images/edit.svg)

![](/uicontent/images/review.svg)

Twitter
Facebook
LinkedIn
微博

You can remove a USB controller from the virtual machine if you do not want to connect to USB devices.

## Prerequisites

Note: The
ESXi host supports hot-removal of a USB controller. You can remove a USB controller from a virtual machine when both the
ESXi host and the guest operating system of the virtual machine support the hot-removal functionality.

To make sure that the guest operating system of the virtual machine supports the hot-removal functionality, refer to the vendors documentation.

* Verify that the USB controller is not in use.
* Verify that all USB devices are disconnected from the virtual machine.
* Required Privilege: Virtual Machine.Configuration.Add or Remove Device

## Procedure

1. Navigate to a data center, folder, cluster, resource pool, host, or vApp, click the VMs tab and click Virtual Machines.
2. Right-click a virtual machine and click Edit Settings.
3. On the Virtual Hardware tab, move the pointer over the USB controller and click the Remove icon.
4. Click OK to confirm the deletion and close the dialog box.

## Results

The controller is no longer connected to the virtual machine, but remains available to add at a later time.

**Parent topic:**
[USB Configuration from a Client Computer to a Virtual Machine](GUID-800DA713-FB5F-49AF-9045-F21915AB79C8.html "You can add multiple USB devices to a virtual machine when the physical devices connect to a client computer on which the vSphere Client is running. The vSphere Client must be logged in to an instance of vCenter Server that manages the ESXi host where the virtual machines reside. USB passthrough technology supports adding multiple USB devices, such as security dongles, mass storage devices, and smartcard readers to virtual machines.")

check-circle-line

exclamation-circle-line

close-line

![Scroll to top icon](/uicontent/images/scroll_top.svg)

![](/uicontent/images/feedback.svg)

             [![VMware](https://www.vmware.com/content/dam/vmwaredesigns/scrapercontent/resources/logos/vmware-logo-grey.svg "VMware")](https://www.vmware.com/)

Resources

* [Blogs](https://blogs.vmware.com/)
* [Careers](https://www.broadcom.com/jobs)
* [Communities](https://community.broadcom.com/)
* [Customer Stories](https://www.vmware.com/resources/customers)

* [News and Stories](https://news.broadcom.com/)
* [Topics](https://www.vmware.com/topics/)
* [Trust Center](https://www.vmware.com/info/trust-center/)

Support

* [Broadcom Support](https://support.broadcom.com/)
* [Documentation](https://docs.vmware.com)
* [Hands-On Labs](https://www.vmware.com/resources/hands-on-labs)
* [Licensing](https://www.broadcom.com/licensing)

* [Twitter](https://twitter.com/VMware)
* [YouTube](https://www.youtube.com/user/vmwaretv)
* [Facebook](https://www.facebook.com/vmware)
* [LinkedIn](https://www.linkedin.com/company/vmware/mycompany/)
* [Contact Sales](https://go-vmware.broadcom.com/contact-us)

---

  Copyright © 2005-2024 Broadcom. All Rights Reserved. The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries. [Accessibility](https://www.broadcom.com/company/legal/accessibility "Accessibility") [Privacy](https://www.broadcom.com/privacy "Privacy") [Supplier Responsibility](https://www.broadcom.com/company/citizenship/supplier-responsibility "Supplier Responsibility") [Terms Of Use](https://www.broadcom.com/company/legal/terms-of-use "Terms Of Use")

#####

×

Share on Social Media?

×

#####

×

exclamation-circle-line

check-circle-line

 :

#####

×

exclamation-circle-line

|

check-circle-line

exclamation-circle-line

x

#####

×

"
"?

×


