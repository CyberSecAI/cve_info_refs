=== Content from github.com_f1913049_20250119_115855.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxcllnt%2Fopeniked%2Fcommits%2Fmaster)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxcllnt%2Fopeniked%2Fcommits%2Fmaster)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcommits%2Fshow&source=header-repo&source_repo=xcllnt%2Fopeniked)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xcllnt](/xcllnt)
/
**[openiked](/xcllnt/openiked)**
Public

forked from [reyk/openiked](/reyk/openiked)

* [Notifications](/login?return_to=%2Fxcllnt%2Fopeniked) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2Fxcllnt%2Fopeniked)
* [Star
   6](/login?return_to=%2Fxcllnt%2Fopeniked)

* [Code](/xcllnt/openiked)
* [Issues
  0](/xcllnt/openiked/issues)
* [Pull requests
  0](/xcllnt/openiked/pulls)
* [Actions](/xcllnt/openiked/actions)
* [Projects
  0](/xcllnt/openiked/projects)
* [Security](/xcllnt/openiked/security)
* [Insights](/xcllnt/openiked/pulse)

Additional navigation options

* [Code](/xcllnt/openiked)
* [Issues](/xcllnt/openiked/issues)
* [Pull requests](/xcllnt/openiked/pulls)
* [Actions](/xcllnt/openiked/actions)
* [Projects](/xcllnt/openiked/projects)
* [Security](/xcllnt/openiked/security)
* [Insights](/xcllnt/openiked/pulse)

# Commits

## Branch selector

Â master
## User selector

All users
## Datepicker

All time
## Commit History

### Commits on Aug 24, 2020

* #### [Check for automake versions within the last decade](/xcllnt/openiked/commit/782e4ddb8cf2fde13a086f87eea46fdbfd76fb68 "Check for automake versions within the last decade As time goes by and new automake versions are released, have old versions drop off at the tail end. Arbitrarily pick a decade as the time window and have version 1.11 be the oldest version we explicitly check for.")

  Show description for 782e4dd[![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[782e4dd](/xcllnt/openiked/commit/782e4ddb8cf2fde13a086f87eea46fdbfd76fb68)Copy full SHA for 782e4dd
* #### [Fix redundant definitions of privsep\_process](/xcllnt/openiked/commit/75867ac3e8897567f077f2d92dbd1fcad2de0308 "Fix redundant definitions of privsep_process")

  [![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[75867ac](/xcllnt/openiked/commit/75867ac3e8897567f077f2d92dbd1fcad2de0308)Copy full SHA for 75867ac
### Commits on Dec 3, 2019

* #### [Merge pull request](/xcllnt/openiked/commit/095877dc5d9515f4c3de8bee14364e592cc371a2 "Merge pull request #15 from puddingpimp/master Initialise bignums in modp_init (Fix unintialised bignum pointer)") [#15](https://github.com/xcllnt/openiked/pull/15) [from puddingpimp/master](/xcllnt/openiked/commit/095877dc5d9515f4c3de8bee14364e592cc371a2 "Merge pull request #15 from puddingpimp/master Initialise bignums in modp_init (Fix unintialised bignum pointer)")

  Show description for 095877d[![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)authored[095877d](/xcllnt/openiked/commit/095877dc5d9515f4c3de8bee14364e592cc371a2)Copy full SHA for 095877d
* #### [Initialise bignums in modp\_init (Fix unintialised bignum pointer)](/xcllnt/openiked/commit/a4095e0b73afe8ff822ee76980035fb40c7cc081 "Initialise bignums in modp_init (Fix unintialised bignum pointer) BN_hex2bin() will only create a new bignum if the pointer given to it is null, otherwise it assumes it is given an existing bignum to reuse. This was causing the ikev2 slave to crash every time on sa init for me.")

  Show description for a4095e0[![puddingpimp](https://avatars.githubusercontent.com/u/785964?v=4&size=32)](/puddingpimp)[puddingpimp](/xcllnt/openiked/commits?author=puddingpimp)committed[a4095e0](/xcllnt/openiked/commit/a4095e0b73afe8ff822ee76980035fb40c7cc081)Copy full SHA for a4095e0
### Commits on Jan 26, 2019

* #### [Add backward compatibility for OpenSSL 1.0 and older.](/xcllnt/openiked/commit/2976e06f95be3c2c2b95027c486131f2fd47ee83 "Add backward compatibility for OpenSSL 1.0 and older.")

  [![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[2976e06](/xcllnt/openiked/commit/2976e06f95be3c2c2b95027c486131f2fd47ee83)Copy full SHA for 2976e06
### Commits on Jan 25, 2019

* #### [Clear allocated memory in compat version of EVP\_MD\_CTX\_new()](/xcllnt/openiked/commit/42576a6c7065553b528e591ca8d81f23db052da6 "Clear allocated memory in compat version of EVP_MD_CTX_new()")

  [![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[42576a6](/xcllnt/openiked/commit/42576a6c7065553b528e591ca8d81f23db052da6)Copy full SHA for 42576a6
### Commits on Jan 20, 2019

* #### [[Issue](/xcllnt/openiked/commit/81dced24e25f7f53c508a2b28f8237f6679b6099 "[Issue #14] Properly create iked.conf.5 Submitted by: mi@FreeBSD.org") [#14](https://github.com/xcllnt/openiked/issues/14)[] Properly create iked.conf.5](/xcllnt/openiked/commit/81dced24e25f7f53c508a2b28f8237f6679b6099 "[Issue #14] Properly create iked.conf.5 Submitted by: mi@FreeBSD.org")

  Show description for 81dced2[![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[81dced2](/xcllnt/openiked/commit/81dced24e25f7f53c508a2b28f8237f6679b6099)Copy full SHA for 81dced2
* #### [Update my email address](/xcllnt/openiked/commit/edaa2404221df1d9575bb09dd3410aed93cc66ce "Update my email address marcel@brkt.com does not exist any more. Use marcel@FreeBSD.org instead.")

  Show description for edaa240[![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[edaa240](/xcllnt/openiked/commit/edaa2404221df1d9575bb09dd3410aed93cc66ce)Copy full SHA for edaa240
* #### [[FreeBSD/229654] Properly generate man pages on FreeBSD](/xcllnt/openiked/commit/ca2e9164b1aa280dbe8cb6645b6c1370c3fb6fe5 "[FreeBSD/229654] Properly generate man pages on FreeBSD https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=229654")

  Show description for ca2e916[![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[ca2e916](/xcllnt/openiked/commit/ca2e9164b1aa280dbe8cb6645b6c1370c3fb6fe5)Copy full SHA for ca2e916
### Commits on Jan 19, 2019

* #### [Include generated manpages during install](/xcllnt/openiked/commit/250e585328b71ca6111aa3b272b97b192844534e "Include generated manpages during install")

  [![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[250e585](/xcllnt/openiked/commit/250e585328b71ca6111aa3b272b97b192844534e)Copy full SHA for 250e585
* #### [Add .gitignore](/xcllnt/openiked/commit/2d1570d6a692f10d3613607965974498b2250f34 "Add .gitignore")

  [![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[2d1570d](/xcllnt/openiked/commit/2d1570d6a692f10d3613607965974498b2250f34)Copy full SHA for 2d1570d
* #### [Convert ikev2.c to OpenSSL 1.1](/xcllnt/openiked/commit/e8420ce9ab88e1486acf0e504b915eab72b5eaf1 "Convert ikev2.c to OpenSSL 1.1")

  [![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[e8420ce](/xcllnt/openiked/commit/e8420ce9ab88e1486acf0e504b915eab72b5eaf1)Copy full SHA for e8420ce
### Commits on Jan 6, 2019

* #### [Convert dh.c to OpenSSL 1.1](/xcllnt/openiked/commit/86e8978f70f7aefe02b6629c6f4a88a6b0741161 "Convert dh.c to OpenSSL 1.1")

  [![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[86e8978](/xcllnt/openiked/commit/86e8978f70f7aefe02b6629c6f4a88a6b0741161)Copy full SHA for 86e8978
* #### [Fix typo in previous commit (s/rerurn/return/)](/xcllnt/openiked/commit/1625d2da5e620058360c2ad034c954251b99d1e6 "Fix typo in previous commit (s/rerurn/return/)")

  [![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[1625d2d](/xcllnt/openiked/commit/1625d2da5e620058360c2ad034c954251b99d1e6)Copy full SHA for 1625d2d
* #### [Handle errors returned by:](/xcllnt/openiked/commit/5c55f67acfb44eaf4e6e2a8d9c898193c81b4cc4 "Handle errors returned by: mschap_auth_response() mschap_msk() mschap_nt_response()")

  Show description for 5c55f67[![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[5c55f67](/xcllnt/openiked/commit/5c55f67acfb44eaf4e6e2a8d9c898193c81b4cc4)Copy full SHA for 5c55f67
* #### [Convert crypto.c to OpenSSL 1.1](/xcllnt/openiked/commit/b4f62d5f0827f0bbda25b3d1345cc0e502437211 "Convert crypto.c to OpenSSL 1.1")

  [![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[b4f62d5](/xcllnt/openiked/commit/b4f62d5f0827f0bbda25b3d1345cc0e502437211)Copy full SHA for b4f62d5
* #### [Convert chap\_ms.c to OpenSSL 1.1](/xcllnt/openiked/commit/aba1c46c0616172b1eeb19bbf1c2debe7f6b3458 "Convert chap_ms.c to OpenSSL 1.1")

  [![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[aba1c46](/xcllnt/openiked/commit/aba1c46c0616172b1eeb19bbf1c2debe7f6b3458)Copy full SHA for aba1c46
* #### [Convert ca.c to OpenSSL 1.1](/xcllnt/openiked/commit/b76ba5d1cae9337c73701e85432cb0c1a5d50f41 "Convert ca.c to OpenSSL 1.1")

  [![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[b76ba5d](/xcllnt/openiked/commit/b76ba5d1cae9337c73701e85432cb0c1a5d50f41)Copy full SHA for b76ba5d
* #### [Change configure to use OpenSSL 1.1 APIs.](/xcllnt/openiked/commit/97a22b0df57521f972902467815de376ec6a884f "Change configure to use OpenSSL 1.1 APIs.")

  [![xcllnt](https://avatars.githubusercontent.com/u/2830737?v=4&size=32)](/xcllnt)[xcllnt](/xcllnt/openiked/commits?author=xcllnt)committed[97a22b0](/xcllnt/openiked/commit/97a22b0df57521f972902467815de376ec6a884f)Copy full SHA for 97a22b0
### Commits on Nov 16, 2018

* #### [automake is up to 1.16](/xcllnt/openiked/commit/dd087853f51353d6a87ee38a21ad9a93128db123 "automake is up to 1.16")

  ![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[dd08785](/xcllnt/openiked/commit/dd087853f51353d6a87ee38a21ad9a93128db123)Copy full SHA for dd08785
### Commits on Nov 19, 2017

* #### [Fix RSA public key authentication, broken with change](/xcllnt/openiked/commit/fed913633add0c7553bd1101965d328455ff882f "Fix RSA public key authentication, broken with change 69e8de57 Pointed out by: Brandon Bergren") [69e8de5](https://github.com/xcllnt/openiked/commit/69e8de575d5b41148728c6d33d6430991050b96a)

  Show description for fed9136![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[fed9136](/xcllnt/openiked/commit/fed913633add0c7553bd1101965d328455ff882f)Copy full SHA for fed9136
### Commits on Oct 1, 2017

* #### [Consistently prefer IP\_RECVORIGDSTADDR over IP\_RECVDSTADDR](/xcllnt/openiked/commit/fbbcb9d5ef40309995822be8f5dc982a630c32fd "Consistently prefer IP_RECVORIGDSTADDR over IP_RECVDSTADDR On FreeBSD 12.x both IP_RECVORIGDSTADDR and IP_RECVDSTADDR are defined. When setting the socket options, we took IP_RECVORIGDSTADDR over IP_RECVDSTADDR, and when receiving a datagram from the socket, we took IP_RECVDSTADDR over IP_RECVORIGDSTADDR. Consequently, we didn't get the destination address and dropped the packet.")

  Show description for fbbcb9d![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[fbbcb9d](/xcllnt/openiked/commit/fbbcb9d5ef40309995822be8f5dc982a630c32fd)Copy full SHA for fbbcb9d
### Commits on Sep 20, 2017

* #### [Better support intermediate CAs](/xcllnt/openiked/commit/69e8de575d5b41148728c6d33d6430991050b96a "Better support intermediate CAs Don't require to know or have all CAs in the chain. Instead, find the outer-most issuer we know that's in the CERTREQ and find a certificate chain that is rooted by that CA. Save the partial certificate chain in the SA and send them to the peer in as many CERT payloads as there are certificates in the (partial) chain. Similarly, collect all CERT payloads in a partial chain and us all the certificates to verify the leaf certificate. Save the partial chain in the same way we save our local cert.")

  Show description for 69e8de5![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[69e8de5](/xcllnt/openiked/commit/69e8de575d5b41148728c6d33d6430991050b96a)Copy full SHA for 69e8de5
### Commits on Aug 31, 2017

* #### [Let's keep AES-GCM out of the default proposal](/xcllnt/openiked/commit/ecf673ad57b6014b4414cfea8b2d900c20166e5a "Let's keep AES-GCM out of the default proposal GCM doesn't need an integ xform and I don't think the current code works well when we really have a disjoint proposals.")

  Show description for ecf673a![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[ecf673a](/xcllnt/openiked/commit/ecf673ad57b6014b4414cfea8b2d900c20166e5a)Copy full SHA for ecf673a
* #### [Add DH groups 19, 20 & 21 to the default IKE proposal](/xcllnt/openiked/commit/4c0eb620cd28cda209afab0671a37bf304f676ad "Add DH groups 19, 20 & 21 to the default IKE proposal These groups are known as ECP-256, ECP-384 & ECP-521 (resp.)")

  Show description for 4c0eb62![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[4c0eb62](/xcllnt/openiked/commit/4c0eb620cd28cda209afab0671a37bf304f676ad)Copy full SHA for 4c0eb62
* #### [Add SHA2-512 & SHA2-384 to the default IKE & IPsec SA xforms](/xcllnt/openiked/commit/b3c498adfdada62988fca366ab745abc589592a2 "Add SHA2-512 & SHA2-384 to the default IKE & IPsec SA xforms")

  ![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[b3c498a](/xcllnt/openiked/commit/b3c498adfdada62988fca366ab745abc589592a2)Copy full SHA for b3c498a
* #### [Add AES-GCM-16 to the default ESP transforms](/xcllnt/openiked/commit/fc1460e4e4dd073de961f0e718335207e4ec925a "Add AES-GCM-16 to the default ESP transforms")

  ![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[fc1460e](/xcllnt/openiked/commit/fc1460e4e4dd073de961f0e718335207e4ec925a)Copy full SHA for fc1460e
* #### [Fix sending proposals](/xcllnt/openiked/commit/3e18cd6cb60688bd589c03b42087afa6f417506d "Fix sending proposals We can't just filter the transforms the kernel doesn't support. The proposal has the total number of transforms. As such, we need to first determine the total supported transforms and then add the transforms that are supported.")

  Show description for 3e18cd6![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[3e18cd6](/xcllnt/openiked/commit/3e18cd6cb60688bd589c03b42087afa6f417506d)Copy full SHA for 3e18cd6
### Commits on Apr 4, 2017

* #### [Map from IKE's xform Id to pfkey's algorithm Id when checking](/xcllnt/openiked/commit/7f97d0c2a4fd94d57c7a3c7a453b8ec32f1e2153 "Map from IKE's xform Id to pfkey's algorithm Id when checking against the kernel's list of supported algorithms. Also, when the xform length is 0, accept the xform if the algorithm has a fixed key length. The kernel will typically do the right thing when presented with a 0 length.")

  Show description for 7f97d0c![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[7f97d0c](/xcllnt/openiked/commit/7f97d0c2a4fd94d57c7a3c7a453b8ec32f1e2153)Copy full SHA for 7f97d0c
### Commits on Apr 3, 2017

* #### [Save the supported algorithms and check proposals against them.](/xcllnt/openiked/commit/b3c2fca064b437aec0317c9031e8eb9f918c4e1e "Save the supported algorithms and check proposals against them.")

  ![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[b3c2fca](/xcllnt/openiked/commit/b3c2fca064b437aec0317c9031e8eb9f918c4e1e)Copy full SHA for b3c2fca
* #### [Add pfkey\_supports\_xform() and pfkey\_process\_supported()](/xcllnt/openiked/commit/a671fe33e4a1032f268933dd70f38fa16d4192ae "Add pfkey_supports_xform() and pfkey_process_supported() This is the first step towards negotiating only those xforms that the kernel supports.")

  Show description for a671fe3![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[a671fe3](/xcllnt/openiked/commit/a671fe33e4a1032f268933dd70f38fa16d4192ae)Copy full SHA for a671fe3
### Commits on Mar 15, 2017

* #### [Add flow\_precious to keep track of the flows we want to keep](/xcllnt/openiked/commit/4eafd36fef4e73bf533e03f525b826235cae2718 "Add flow_precious to keep track of the flows we want to keep in the kernel for lazy mode. The problem with using a negative value for flow_loaded is that it doesn't work when we have to consider that the flow may not have been loaded yet. This can happen when we receive a SA_INIT request before we initialized the SA.")

  Show description for 4eafd36![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[4eafd36](/xcllnt/openiked/commit/4eafd36fef4e73bf533e03f525b826235cae2718)Copy full SHA for 4eafd36
### Commits on Mar 3, 2017

* #### [Lower the SA replay window to 255 to avoid overflows on](/xcllnt/openiked/commit/a17f482bdb4838f1b9a2f7946b9ee0a659d47a1f "Lower the SA replay window to 255 to avoid overflows on FreeBSD.")

  Show description for a17f482![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[a17f482](/xcllnt/openiked/commit/a17f482bdb4838f1b9a2f7946b9ee0a659d47a1f)Copy full SHA for a17f482
* #### [Bump the SA replay window size from 64 to 512](/xcllnt/openiked/commit/9cb01fd622d0b6030b4e5ff2d22230104eae759e "Bump the SA replay window size from 64 to 512 Reasons for this are: o A 64-packet window causes replay checks to fail under network load. A 256-packet window does not have this problem. o At least 1 network vendor considers switching to 512, which leads me to think that 256 is borderline.")

  Show description for 9cb01fd![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[9cb01fd](/xcllnt/openiked/commit/9cb01fd622d0b6030b4e5ff2d22230104eae759e)Copy full SHA for 9cb01fd
### Commits on Feb 25, 2017

* #### [Merge branch 'event' of](/xcllnt/openiked/commit/38a4ea8f7eb79201aced82a90145e91dccf4735a "Merge branch 'event' of https://github.com/xcllnt/openiked into event") <https://github.com/xcllnt/openiked> [into event](/xcllnt/openiked/commit/38a4ea8f7eb79201aced82a90145e91dccf4735a "Merge branch 'event' of https://github.com/xcllnt/openiked into event")

  ![author](https://github.githubassets.com/images/gravatars/gravatar-user-420.png?size=32)Marcel Moolenaarcommitted[38a4ea8](/xcllnt/openiked/commit/38a4ea8f7eb79201aced82a90145e91dccf4735a)Copy full SHA for 38a4ea8
## Pagination

[Previous](/xcllnt/openiked/commits/master?before=782e4ddb8cf2fde13a086f87eea46fdbfd76fb68+0)[Next](/xcllnt/openiked/commits/master?after=782e4ddb8cf2fde13a086f87eea46fdbfd76fb68+34)

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from www.openiked.org_5d289b17_20250119_115856.html ===


OpenIKED Security

## [*Open***IKED**](/) Security

---

OpenIKED is developed with the same rigorous security process that the
OpenBSD group is famous for. If you wish to report a security issue in
OpenIKED, please contact the OpenBSD project.
For more information, see the
[OpenBSD Security page](https://www.openbsd.org/security.html#reporting).

* **July 27, 2020**

  All versions of OpenIKED in OpenBSD through 6.7 were vulnerable to an
  authentication bypass due to incorrect use of the EVP\_PKEY\_cmp() function.

  For more information see
  [the OpenBSD source code patch.](https://ftp.openbsd.org/pub/OpenBSD/patches/6.7/common/014_iked.patch.sig)

  This bug is corrected in OpenBSD's current and stable branches. Binary updates
  for OpenBSD 6.6 and OpenBSD 6.7 can be obtained with the
  [syspatch(8)](https://man.openbsd.org/syspatch) utility.



=== Content from github.com_64b00b6e_20250119_115854.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenbsd%2Fsrc%2Fcommit%2F7afb2d41c6d373cf965285840b85c45011357115)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenbsd%2Fsrc%2Fcommit%2F7afb2d41c6d373cf965285840b85c45011357115)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=openbsd%2Fsrc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openbsd](/openbsd)
/
**[src](/openbsd/src)**
Public

* [Notifications](/login?return_to=%2Fopenbsd%2Fsrc) You must be signed in to change notification settings
* [Fork
  875](/login?return_to=%2Fopenbsd%2Fsrc)
* [Star
   3.3k](/login?return_to=%2Fopenbsd%2Fsrc)

* [Code](/openbsd/src)
* [Pull requests
  0](/openbsd/src/pulls)
* [Security](/openbsd/src/security)
* [Insights](/openbsd/src/pulse)

Additional navigation options

* [Code](/openbsd/src)
* [Pull requests](/openbsd/src/pulls)
* [Security](/openbsd/src/security)
* [Insights](/openbsd/src/pulse)

## Commit

[Permalink](/openbsd/src/commit/7afb2d41c6d373cf965285840b85c45011357115)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix return value check for openssl API used during pubkey validation.

[Browse files](/openbsd/src/tree/7afb2d41c6d373cf965285840b85c45011357115)
Browse the repository at this point in the history

```
Found thanks to bug report by Michael Scheibel <m.Scheibel (at) tuvit (dot) de>
ok patrick@, markus@, tb@
```

* Loading branch information

[![@tobhe](https://avatars.githubusercontent.com/u/9573670?s=40&v=4)](/tobhe)

[tobhe](/openbsd/src/commits?author=tobhe "View all commits by tobhe")
committed
Jul 27, 2020

1 parent
[4da86b8](/openbsd/src/commit/4da86b847b93a312fd7ae1ef312850d95aeddf0a)

commit 7afb2d4

Showing
**1 changed file**
with
**2 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[sbin/iked/ca.c](#diff-2c52feac3880816a9649cc1b0cc3a018ce546e1986da2cb45533d465c8697103 "sbin/iked/ca.c")

Show comments

[View file](/openbsd/src/blob/7afb2d41c6d373cf965285840b85c45011357115/sbin/iked/ca.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,4 @@ |
|  |  | /\* $OpenBSD: ca.c,v 1.64 2020/07/15 14:45:15 tobhe Exp $ \*/ |
|  |  | /\* $OpenBSD: ca.c,v 1.65 2020/07/27 14:22:53 tobhe Exp $ \*/ |
|  |  |  |
|  |  | /\* |
|  |  | \* Copyright (c) 2010-2013 Reyk Floeter <reyk@openbsd.org> |
| Expand Down  Expand Up | | @@ -1420,7 +1420,7 @@ ca\_validate\_pubkey(struct iked \*env, struct iked\_static\_id \*id, |
|  |  | if (localkey == NULL) |
|  |  | goto sslerr; |
|  |  |  |
|  |  | if (peerkey && !EVP\_PKEY\_cmp(peerkey, localkey)) { |
|  |  | if (peerkey && EVP\_PKEY\_cmp(peerkey, localkey) != 1) { |
|  |  | log\_debug("%s: public key does not match %s", \_\_func\_\_, file); |
|  |  | goto done; |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `7afb2d4`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenbsd%2Fsrc%2Fcommit%2F7afb2d41c6d373cf965285840b85c45011357115) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from ftp.openbsd.org_64399701_20250119_115853.html ===
untrusted comment: verify with openbsd-67-base.pub
RWRmkIA877Io3uA4quwmzRWfmahDybgpV/hEPKVAq3jbYgY+FdKk8+WCWF/1OHUhwDZaodhqzXpcZo8xpBuT1a+4EU+fy/l1kg0=
OpenBSD 6.7 errata 014, July 27, 2020:
In iked, incorrect use of EVP\_PKEY\_cmp allows an authentication bypass.
Apply by doing:
signify -Vep /etc/signify/openbsd-67-base.pub -x 014\_iked.patch.sig \
-m - | (cd /usr/src && patch -p0)
And then rebuild and install iked:
cd /usr/src/sbin/iked
make obj
make
make install
Index: sbin/iked/ca.c
===================================================================
RCS file: /cvs/src/sbin/iked/ca.c,v
diff -u -p -u -r1.60 ca.c
--- sbin/iked/ca.c 12 Apr 2020 20:18:45 -0000 1.60
+++ sbin/iked/ca.c 23 Jul 2020 16:12:41 -0000
@@ -1404,7 +1404,7 @@ ca\_validate\_pubkey(struct iked \*env, str
if (localkey == NULL)
goto sslerr;
- if (!EVP\_PKEY\_cmp(peerkey, localkey)) {
+ if (EVP\_PKEY\_cmp(peerkey, localkey) != 1) {
log\_debug("%s: public key does not match %s", \_\_func\_\_, file);
goto done;
}

