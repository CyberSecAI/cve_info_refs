=== Content from github.com_9c52a600_20250119_113434.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fankane%2Fpghero%2Fissues%2F330)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fankane%2Fpghero%2Fissues%2F330)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=ankane%2Fpghero)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ankane](/ankane)
/
**[pghero](/ankane/pghero)**
Public

* [Notifications](/login?return_to=%2Fankane%2Fpghero) You must be signed in to change notification settings
* [Fork
  450](/login?return_to=%2Fankane%2Fpghero)
* [Star
   8.3k](/login?return_to=%2Fankane%2Fpghero)

* [Code](/ankane/pghero)
* [Issues
  9](/ankane/pghero/issues)
* [Pull requests
  6](/ankane/pghero/pulls)
* [Actions](/ankane/pghero/actions)
* [Security](/ankane/pghero/security)
* [Insights](/ankane/pghero/pulse)

Additional navigation options

* [Code](/ankane/pghero)
* [Issues](/ankane/pghero/issues)
* [Pull requests](/ankane/pghero/pulls)
* [Actions](/ankane/pghero/actions)
* [Security](/ankane/pghero/security)
* [Insights](/ankane/pghero/pulse)

# CSRF Vulnerability¬†#330

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[CSRF Vulnerability](#top)#330Copy link![@ankane](https://avatars.githubusercontent.com/u/220358?u=ba13f3240d7992dc4124a33a4fc65bf4924e5375&v=4&size=80)
## Description

![@ankane](https://avatars.githubusercontent.com/u/220358?u=ba13f3240d7992dc4124a33a4fc65bf4924e5375&v=4&size=48)[ankane](https://github.com/ankane)opened [on Aug 4, 2020](https://github.com/ankane/pghero/issues/330#issue-673031545)

PgHero is vulnerable to cross-site request forgery (CSRF). This vulnerability has been assigned the CVE identifier [CVE-2020-16253](https://github.com/advisories/GHSA-v6fx-752r-ccp2 "CVE-2020-16253").

Versions Affected: 2.6.0 and below

Fixed Versions: 2.7.0

## Impact

The PgHero dashboard is vulnerable to cross-site request forgery (CSRF). This affects the Docker image, Linux packages, and in specific cases, the Ruby gem. The Ruby gem is vulnerable with non-session based authentication methods like basic authentication - session-based authentication methods (like Devise's default authentication) are not affected.

A CSRF attack works by getting an authorized user to visit a malicious website and then performing requests on behalf of the user. In this instance, actions include:

1. Canceling running queries
2. Running `EXPLAIN` on queries (without seeing the results, but can be used for denial of service and other attacks)
3. Resetting query stats (running `pg_stat_statements_reset()`)

All users running an affected release should upgrade immediately.

## Credits

Thanks to Heiko Webers of <https://bauland42.com> for reporting this.

## Technical Details

PgHero uses the `protect_from_forgery` method from Rails to prevent CSRF. However, this defaults to `:null_session`, which has no effect on non-session based authentication methods. This has been changed to `protect_from_forgery with: :exception`.

üëç2
## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_76b70f22_20250119_113432.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fankane%2Fpghero%2F)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fankane%2Fpghero%2F)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=ankane%2Fpghero)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ankane](/ankane)
/
**[pghero](/ankane/pghero)**
Public

* [Notifications](/login?return_to=%2Fankane%2Fpghero) You must be signed in to change notification settings
* [Fork
  450](/login?return_to=%2Fankane%2Fpghero)
* [Star
   8.3k](/login?return_to=%2Fankane%2Fpghero)

A performance dashboard for Postgres

### License

[MIT license](/ankane/pghero/blob/master/LICENSE.txt)

[8.3k
stars](/ankane/pghero/stargazers) [450
forks](/ankane/pghero/forks) [Branches](/ankane/pghero/branches) [Tags](/ankane/pghero/tags) [Activity](/ankane/pghero/activity)
 [Star](/login?return_to=%2Fankane%2Fpghero)

 [Notifications](/login?return_to=%2Fankane%2Fpghero) You must be signed in to change notification settings

* [Code](/ankane/pghero)
* [Issues
  9](/ankane/pghero/issues)
* [Pull requests
  6](/ankane/pghero/pulls)
* [Actions](/ankane/pghero/actions)
* [Security](/ankane/pghero/security)
* [Insights](/ankane/pghero/pulse)

Additional navigation options

* [Code](/ankane/pghero)
* [Issues](/ankane/pghero/issues)
* [Pull requests](/ankane/pghero/pulls)
* [Actions](/ankane/pghero/actions)
* [Security](/ankane/pghero/security)
* [Insights](/ankane/pghero/pulse)

# ankane/pghero

   ¬†master[Branches](/ankane/pghero/branches)[Tags](/ankane/pghero/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit¬†History[1,359 Commits](/ankane/pghero/commits/master/) | | |
| [.github](/ankane/pghero/tree/master/.github ".github") | | [.github](/ankane/pghero/tree/master/.github ".github") |  |  |
| [app](/ankane/pghero/tree/master/app "app") | | [app](/ankane/pghero/tree/master/app "app") |  |  |
| [config](/ankane/pghero/tree/master/config "config") | | [config](/ankane/pghero/tree/master/config "config") |  |  |
| [gemfiles](/ankane/pghero/tree/master/gemfiles "gemfiles") | | [gemfiles](/ankane/pghero/tree/master/gemfiles "gemfiles") |  |  |
| [guides](/ankane/pghero/tree/master/guides "guides") | | [guides](/ankane/pghero/tree/master/guides "guides") |  |  |
| [lib](/ankane/pghero/tree/master/lib "lib") | | [lib](/ankane/pghero/tree/master/lib "lib") |  |  |
| [licenses](/ankane/pghero/tree/master/licenses "licenses") | | [licenses](/ankane/pghero/tree/master/licenses "licenses") |  |  |
| [test](/ankane/pghero/tree/master/test "test") | | [test](/ankane/pghero/tree/master/test "test") |  |  |
| [.gitattributes](/ankane/pghero/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/ankane/pghero/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/ankane/pghero/blob/master/.gitignore ".gitignore") | | [.gitignore](/ankane/pghero/blob/master/.gitignore ".gitignore") |  |  |
| [CHANGELOG.md](/ankane/pghero/blob/master/CHANGELOG.md "CHANGELOG.md") | | [CHANGELOG.md](/ankane/pghero/blob/master/CHANGELOG.md "CHANGELOG.md") |  |  |
| [CONTRIBUTING.md](/ankane/pghero/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") | | [CONTRIBUTING.md](/ankane/pghero/blob/master/CONTRIBUTING.md "CONTRIBUTING.md") |  |  |
| [Gemfile](/ankane/pghero/blob/master/Gemfile "Gemfile") | | [Gemfile](/ankane/pghero/blob/master/Gemfile "Gemfile") |  |  |
| [LICENSE.txt](/ankane/pghero/blob/master/LICENSE.txt "LICENSE.txt") | | [LICENSE.txt](/ankane/pghero/blob/master/LICENSE.txt "LICENSE.txt") |  |  |
| [README.md](/ankane/pghero/blob/master/README.md "README.md") | | [README.md](/ankane/pghero/blob/master/README.md "README.md") |  |  |
| [Rakefile](/ankane/pghero/blob/master/Rakefile "Rakefile") | | [Rakefile](/ankane/pghero/blob/master/Rakefile "Rakefile") |  |  |
| [pghero.gemspec](/ankane/pghero/blob/master/pghero.gemspec "pghero.gemspec") | | [pghero.gemspec](/ankane/pghero/blob/master/pghero.gemspec "pghero.gemspec") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# PgHero

A performance dashboard for Postgres

[See it in action](https://pghero.dokkuapp.com/)

[![Screenshot](https://camo.githubusercontent.com/a0a3057507c841940ab3371030592b8225e53961f9d1f0dc302b2b90a6e7fd66/68747470733a2f2f70676865726f2e646f6b6b756170702e636f6d2f6173736574732f70676865726f2d38386130643035322e706e67)](https://pghero.dokkuapp.com/)

üçä Battle-tested at [Instacart](https://www.instacart.com/opensource)

[![Build Status](https://github.com/ankane/pghero/actions/workflows/build.yml/badge.svg)](https://github.com/ankane/pghero/actions)

## Documentation

PgHero is available as a Docker image, Linux package, and Rails engine.

Select your preferred method of installation to get started.

* [Docker](/ankane/pghero/blob/master/guides/Docker.md)
* [Linux](/ankane/pghero/blob/master/guides/Linux.md)
* [Rails](/ankane/pghero/blob/master/guides/Rails.md)

## Related Projects

* [Dexter](https://github.com/ankane/dexter) - The automatic indexer for Postgres
* [PgBouncerHero](https://github.com/kwent/pgbouncerhero) - A dashboard for PgBouncer
* [pgsync](https://github.com/ankane/pgsync) - Sync Postgres data between databases
* [pgslice](https://github.com/ankane/pgslice) - Postgres partitioning as easy as pie

## Credits

A big thanks to [Craig Kerstiens](http://www.craigkerstiens.com/2013/01/10/more-on-postgres-performance/) and [Heroku](https://blog.heroku.com/archives/2013/5/10/more_insight_into_your_database_with_pgextras) for the initial queries and [Bootswatch](https://github.com/thomaspark/bootswatch) for the theme.

## History

View the [changelog](https://github.com/ankane/pghero/blob/master/CHANGELOG.md)

## Contributing

Everyone is encouraged to help improve this project. Here are a few ways you can help:

* [Report bugs](https://github.com/ankane/pghero/issues)
* Fix bugs and [submit pull requests](https://github.com/ankane/pghero/pulls)
* Write, clarify, or fix documentation
* Suggest or add new features

## About

A performance dashboard for Postgres

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/ankane/pghero/activity)
### Stars

[**8.3k**
stars](/ankane/pghero/stargazers)
### Watchers

[**94**
watching](/ankane/pghero/watchers)
### Forks

[**450**
forks](/ankane/pghero/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fankane%2Fpghero&report=ankane+%28user%29)

## [Releases](/ankane/pghero/releases)

[86
tags](/ankane/pghero/tags)

## [Packages 0](/users/ankane/packages?repo_name=pghero)

No packages published

## [Used by 1.6k](/ankane/pghero/network/dependents)

[* ![@dastanabeuov](https://avatars.githubusercontent.com/u/9317810?s=64&v=4)
* ![@peyyaHQ](https://avatars.githubusercontent.com/u/84287600?s=64&v=4)
* ![@krenzke](https://avatars.githubusercontent.com/u/5323022?s=64&v=4)
* ![@rubyforgood](https://avatars.githubusercontent.com/u/11573263?s=64&v=4)
* ![@gabootsoft](https://avatars.githubusercontent.com/u/26916892?s=64&v=4)
* ![@Morni-Andoka](https://avatars.githubusercontent.com/u/161780413?s=64&v=4)
* ![@titanfat](https://avatars.githubusercontent.com/u/60011775?s=64&v=4)
* ![@kalyansury](https://avatars.githubusercontent.com/u/590229?s=64&v=4)

+ 1,561](/ankane/pghero/network/dependents)

## [Contributors 33](/ankane/pghero/graphs/contributors)

* [![@ankane](https://avatars.githubusercontent.com/u/220358?s=64&v=4)](https://github.com/ankane)
* [![@thotmx](https://avatars.githubusercontent.com/u/719551?s=64&v=4)](https://github.com/thotmx)
* [![@seanlinsley](https://avatars.githubusercontent.com/u/688886?s=64&v=4)](https://github.com/seanlinsley)
* [![@woodhull](https://avatars.githubusercontent.com/u/9278?s=64&v=4)](https://github.com/woodhull)
* [![@annaswims](https://avatars.githubusercontent.com/u/19188?s=64&v=4)](https://github.com/annaswims)
* [![@z4ppy](https://avatars.githubusercontent.com/u/1428660?s=64&v=4)](https://github.com/z4ppy)
* [![@andyatkinson](https://avatars.githubusercontent.com/u/2161008?s=64&v=4)](https://github.com/andyatkinson)
* [![@efremropelato](https://avatars.githubusercontent.com/u/6368884?s=64&v=4)](https://github.com/efremropelato)
* [![@dhcrzf](https://avatars.githubusercontent.com/u/8399811?s=64&v=4)](https://github.com/dhcrzf)
* [![@paul](https://avatars.githubusercontent.com/u/184?s=64&v=4)](https://github.com/paul)
* [![@kbrock](https://avatars.githubusercontent.com/u/1930?s=64&v=4)](https://github.com/kbrock)
* [![@huacnlee](https://avatars.githubusercontent.com/u/5518?s=64&v=4)](https://github.com/huacnlee)
* [![@Deimos](https://avatars.githubusercontent.com/u/9033?s=64&v=4)](https://github.com/Deimos)
* [![@sj26](https://avatars.githubusercontent.com/u/14028?s=64&v=4)](https://github.com/sj26)

[+ 19 contributors](/ankane/pghero/graphs/contributors)

## Languages

* [Ruby
  77.3%](/ankane/pghero/search?l=ruby)
* [HTML
  22.7%](/ankane/pghero/search?l=html)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_9eec5362_20250119_132445.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-v6fx-752r-ccp2)

**CVE-2020-16253**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-v6fx-752r-ccp2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2020-16253](/advisories/GHSA-v6fx-752r-ccp2)

## PgHero gem allows CSRF

High severity

GitHub Reviewed

Published
Aug 5, 2020
to the GitHub Advisory Database
‚Ä¢
Updated Aug 25, 2023

[Vulnerability details](/advisories/GHSA-v6fx-752r-ccp2)
[Dependabot alerts
0](/advisories/GHSA-v6fx-752r-ccp2/dependabot)

## Package

bundler

pghero
([RubyGems](/advisories?query=ecosystem%3Arubygems))

## Affected versions

< 2.7.0

## Patched versions

2.7.0

## Description

The PgHero gem through 2.6.0 for Ruby allows CSRF. PgHero normally uses the `protect_from_forgery` method from Rails to prevent CSRF. However, this defaults to `:null_session`, which has no effect on non-session based authentication methods. Thus the ruby gem is vulnerable with non-session based authentication methods like basic authentication.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-16253>
* [ankane/pghero#330](https://github.com/ankane/pghero/issues/330)
* [ankane/pghero@14b67b3](https://github.com/ankane/pghero/commit/14b67b32fed19a30aaf9826ee72f2a29cda604e9)
* <https://github.com/rubysec/ruby-advisory-db/blob/master/gems/pghero/CVE-2020-16253.yml>

Reviewed
Aug 5, 2020

Published to the GitHub Advisory Database
Aug 5, 2020

Last updated
Aug 25, 2023

### Severity

High

8.1

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
None

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.069%
 (33rd percentile)

### Weaknesses

[CWE-352](/advisories?query=cwe%3A352)

### CVE ID

CVE-2020-16253

### GHSA ID

GHSA-v6fx-752r-ccp2

### Source code

[ankane/pghero](https://github.com/ankane/pghero)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-v6fx-752r-ccp2/improve).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_dea8230a_20250119_132444.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fankane%2Fpghero%2Fissues%2F330)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fankane%2Fpghero%2Fissues%2F330)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=ankane%2Fpghero)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ankane](/ankane)
/
**[pghero](/ankane/pghero)**
Public

* [Notifications](/login?return_to=%2Fankane%2Fpghero) You must be signed in to change notification settings
* [Fork
  450](/login?return_to=%2Fankane%2Fpghero)
* [Star
   8.3k](/login?return_to=%2Fankane%2Fpghero)

* [Code](/ankane/pghero)
* [Issues
  9](/ankane/pghero/issues)
* [Pull requests
  6](/ankane/pghero/pulls)
* [Actions](/ankane/pghero/actions)
* [Security](/ankane/pghero/security)
* [Insights](/ankane/pghero/pulse)

Additional navigation options

* [Code](/ankane/pghero)
* [Issues](/ankane/pghero/issues)
* [Pull requests](/ankane/pghero/pulls)
* [Actions](/ankane/pghero/actions)
* [Security](/ankane/pghero/security)
* [Insights](/ankane/pghero/pulse)

# CSRF Vulnerability¬†#330

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[CSRF Vulnerability](#top)#330Copy link![@ankane](https://avatars.githubusercontent.com/u/220358?u=ba13f3240d7992dc4124a33a4fc65bf4924e5375&v=4&size=80)
## Description

![@ankane](https://avatars.githubusercontent.com/u/220358?u=ba13f3240d7992dc4124a33a4fc65bf4924e5375&v=4&size=48)[ankane](https://github.com/ankane)opened [on Aug 4, 2020](https://github.com/ankane/pghero/issues/330#issue-673031545)

PgHero is vulnerable to cross-site request forgery (CSRF). This vulnerability has been assigned the CVE identifier [CVE-2020-16253](https://github.com/advisories/GHSA-v6fx-752r-ccp2 "CVE-2020-16253").

Versions Affected: 2.6.0 and below

Fixed Versions: 2.7.0

## Impact

The PgHero dashboard is vulnerable to cross-site request forgery (CSRF). This affects the Docker image, Linux packages, and in specific cases, the Ruby gem. The Ruby gem is vulnerable with non-session based authentication methods like basic authentication - session-based authentication methods (like Devise's default authentication) are not affected.

A CSRF attack works by getting an authorized user to visit a malicious website and then performing requests on behalf of the user. In this instance, actions include:

1. Canceling running queries
2. Running `EXPLAIN` on queries (without seeing the results, but can be used for denial of service and other attacks)
3. Resetting query stats (running `pg_stat_statements_reset()`)

All users running an affected release should upgrade immediately.

## Credits

Thanks to Heiko Webers of <https://bauland42.com> for reporting this.

## Technical Details

PgHero uses the `protect_from_forgery` method from Rails to prevent CSRF. However, this defaults to `:null_session`, which has no effect on non-session based authentication methods. This has been changed to `protect_from_forgery with: :exception`.

üëç2
## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


