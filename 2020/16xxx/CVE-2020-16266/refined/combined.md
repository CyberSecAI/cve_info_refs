=== Content from mantisbt.org_7b46b536_20250119_132038.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview_user_page.php%3Fid%3D17784)
[Signup for a new account](/bugs/signup_page.php)

#### User Information

| Username | dregad |
| --- | --- |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 1.3480 seconds



=== Content from github.com_2ff62c0b_20250119_132035.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F9ef8f23a8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F9ef8f23a8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  77](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/9ef8f23a8119221d010251112b1255630a46d903)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix XSS in view\_all\_bug\_page.php ([CVE-2020-16266](https://github.com/advisories/GHSA-4rrc-5vp6-m3f6 "CVE-2020-16266"))

[Browse files](/mantisbt/mantisbt/tree/9ef8f23a8119221d010251112b1255630a46d903)
Browse the repository at this point in the history

```
Hanno Boeck reported a stored cross-site scripting (XSS) vulnerability,
originally discovered by Jaime Andres Restrepo.

Improper escaping on view_all_bug_page.php allowed a remote attacker to
inject arbitrary HTML into the page by saving it into a text Custom
Field, leading to possible code execution in the browser of any user
subsequently viewing the issue (if CSP settings allow it).

Prevent the attack by properly escaping the custom field's contents
before display.

Fixes #27056
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Aug 3, 2020

1 parent
[2fc6661](/mantisbt/mantisbt/commit/2fc66610c3d92232e22520bba15a7d510af9e0e5)

commit 9ef8f23

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[core/filter\_form\_api.php](#diff-09c02a25efdf9d3f1c303bd5810247961613e21885c2729f24de8e09381e6330 "core/filter_form_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/9ef8f23a8119221d010251112b1255630a46d903/core/filter_form_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1855,7 +1855,7 @@ function print\_filter\_values\_custom\_field( array $p\_filter, $p\_field\_id ) { |
|  |  | if( filter\_field\_is\_none( $t\_val ) ) { |
|  |  | $t\_strings[] = lang\_get( 'none' ); |
|  |  | } else { |
|  |  | $t\_strings[] = $t\_val; |
|  |  | $t\_strings[] = string\_attribute( $t\_val ); |
|  |  | } |
|  |  | $t\_inputs[] = '<input type="hidden" name="custom\_field\_' . $p\_field\_id . '[]" value="' . string\_attribute( $t\_val ) . '" />'; |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9ef8f23`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F9ef8f23a8) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from mantisbt.org_99f47d50_20250119_132025.html ===


[![logo](images/mantis_logo_262x90.png "Mantis Bug Tracker")](index.php)

* [HOME](index.php)
* [DEMO](demo.php)
* [DOWNLOAD](download.php)
* [SUPPORT](support.php)
* [ADD-ONS](addons.php)
* [HOSTING](hosting.php)

# Stable Release | Get on latest!

This is the latest stable MantisBT release.
Make sure you are running the latest release to benefit from all
security fixes, bug fixes, and new features.

### Additional Resources:

* [How to upgrade?](/docs/master/en-US/Admin_Guide/html-desktop/#admin.install.upgrade)
* [Changelog](/bugs/changelog_page.php?project=mantisbt&version=2.27.0)
* [Requirements](/docs/master/en-US/Admin_Guide/html-desktop/#admin.install.requirements)
* [PGP keys](https://github.com/mantisbt/mantisbt/blob/master/KEYS.md "Releases are signed with these keys, use them to verify downloaded files' integrity")

## MantisBT 2.27.0

[Download](https://sourceforge.net/projects/mantisbt/files/mantis-stable/2.27.0/)

---

# Legacy Release | Security and critical bugs only!

Older MantisBT version, which is still supported but only gets
fixes for critical bugs and security issues.
You are strongly advised to upgrade to the latest Stable release
as soon as possible, to benefit from new developments.

### Additional Resources:

+ [Changelog](/bugs/changelog_page.php?project=mantisbt&version=1.3.20)
+ [Requirements](/docs/master-1.3.x/en-US/Admin_Guide/html-desktop/#admin.install.requirements)

[Download MantisBT 1.3.20](https://sourceforge.net/projects/mantisbt/files/mantis-stable/1.3.20/)

---

# Nightly Builds | Not Supported - use at your own risk!

These are nightly snapshots generated from the latest development
branches in our Git repository. They have
only undergone minimal testing through our standard Travis CI
build process, and have not been formally
prepared for release; we recommend you only use them for testing
and feedback purposes.

### Additional Resources:

+ [Git Repository](https://github.com/mantisbt/mantisbt)+ + [Travis CI Build Process](https://travis-ci.org/mantisbt/mantisbt)

[Download Nightly Builds](builds.php)

![Mantis Bug Tracker Logo](images/mantis_footer_logo.png)

#### Resources

* [Documentation](documentation.php)
* [Development](development.php)
* [BugTracker](/bugs/)
* [Forums](/forums/)
* [Blog](/blog/)

#### About MantisBT

MantisBT is a popular open source web-based bug tracking system.
Built on PHP and supports Linux, Windows and macOS on the server side.
Compatible with Chrome, Firefox, Safari, Opera and Edge.
Released under the terms of the GNU General Public License (GPL).

Copyright © 2000 - 2025 MantisBT Team



=== Content from mantisbt.org_d7e4ca2f_20250119_112843.html ===

[Skip to content](#content)
[![Mantis Bug Tracker – Blog](https://mantisbt.org/blog/wp-content/uploads/2018/02/mantis_logo.png)](https://mantisbt.org/blog/)

[Mantis Bug Tracker – Blog](https://mantisbt.org/blog/)

Menu

* [Home](/)
* [About](https://mantisbt.org/blog/about)
* [Bugtracker](/bugs/)

# MantisBT 2.24.2 Released

In order to stay up to date with the latest MantisBT news, please star our [GitHub repository](https://github.com/mantisbt/mantisbt), join our [Gitter channel](https://app.gitter.im/#/room/#mantisbt_mantisbt:gitter.im), or [follow us on X](https://twitter.com/mantisbt) or [Mastodon](https://phpc.social/%40mantisbt) and retweet to spread the word!

## MantisBT 2.24.2

Security release for 2.24.x series. All installations are strongly advised to upgrade as soon as possible.

* [0027003](https://mantisbt.org/bugs/view.php?id=27003): **[security]** Update PHPMailer from 6.1.4 to 6.1.6 ([dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784))
* [0027056](https://mantisbt.org/bugs/view.php?id=27056): **[security]** CVE-2020-16266: HTML injection (maybe XSS) via custom field on view\_all\_bug\_page.php ([dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784))

Go ahead and [download](https://mantisbt.org/download.php) the release from our website.

![](https://secure.gravatar.com/avatar/d76f8d74339c20fb921287d3c607d102?s=49&d=identicon&r=g)Author  [dregad](https://mantisbt.org/blog/archives/author/dregad)Posted on [August 8, 2020](https://mantisbt.org/blog/archives/mantisbt/665)Categories [MantisBT](https://mantisbt.org/blog/archives/category/mantisbt)Tags [release](https://mantisbt.org/blog/archives/tag/release)

## Post navigation

[Previous Previous post: MantisBT 2.24.1 Released](https://mantisbt.org/blog/archives/mantisbt/661)[Next Next post: MantisBT 2.24.3 Released](https://mantisbt.org/blog/archives/mantisbt/670)

Search for:

Search

## Recent Posts

* [MantisBT 2.27.0 Released](https://mantisbt.org/blog/archives/mantisbt/778)
* [MantisBT 2.26.4 Released](https://mantisbt.org/blog/archives/mantisbt/770)
* [MantisBT 2.26.3 Released](https://mantisbt.org/blog/archives/mantisbt/763)
* [MantisBT 2.26.2 Released](https://mantisbt.org/blog/archives/mantisbt/759)
* [MantisBT 2.26.1 Released](https://mantisbt.org/blog/archives/mantisbt/753)
## Categories

* [MantisBT](https://mantisbt.org/blog/archives/category/mantisbt)
* [MantisTouch](https://mantisbt.org/blog/archives/category/mantistouch)
* [Web 2.0](https://mantisbt.org/blog/archives/category/web-20)
## Meta

* [Log in](https://mantisbt.org/blog/wp-login.php)
* [Entries feed](https://mantisbt.org/blog/feed)
* [Comments feed](https://mantisbt.org/blog/comments/feed)
* [WordPress.org](https://wordpress.org/)
Search for:

Search

## Recent Posts

* [MantisBT 2.27.0 Released](https://mantisbt.org/blog/archives/mantisbt/778)
* [MantisBT 2.26.4 Released](https://mantisbt.org/blog/archives/mantisbt/770)
* [MantisBT 2.26.3 Released](https://mantisbt.org/blog/archives/mantisbt/763)
* [MantisBT 2.26.2 Released](https://mantisbt.org/blog/archives/mantisbt/759)
* [MantisBT 2.26.1 Released](https://mantisbt.org/blog/archives/mantisbt/753)
## Recent Comments

* dregad on [MantisBT 2.13.1 and 2.12.2 released](https://mantisbt.org/blog/archives/mantisbt/591#comment-58774)
* dregad on [MantisBT 2.14.0, 2.13.2, and 1.13.15 Released](https://mantisbt.org/blog/archives/mantisbt/595#comment-58773)
* dregad on [MantisBT 2.17.0, 2.16.1 and 1.3.16 Released](https://mantisbt.org/blog/archives/mantisbt/605#comment-58772)
* dregad on [MantisBT 2.15.0 Released](https://mantisbt.org/blog/archives/mantisbt/599#comment-58771)
* Larry Burrows on [MantisBT 2.17.0, 2.16.1 and 1.3.16 Released](https://mantisbt.org/blog/archives/mantisbt/605#comment-58599)
## Categories

* [MantisBT](https://mantisbt.org/blog/archives/category/mantisbt)
* [MantisTouch](https://mantisbt.org/blog/archives/category/mantistouch)
* [Web 2.0](https://mantisbt.org/blog/archives/category/web-20)
## Meta

* [Log in](https://mantisbt.org/blog/wp-login.php)
* [Entries feed](https://mantisbt.org/blog/feed)
* [Comments feed](https://mantisbt.org/blog/comments/feed)
* [WordPress.org](https://wordpress.org/)

* [Home](/)
* [About](https://mantisbt.org/blog/about)
* [Bugtracker](/bugs/)

[Mantis Bug Tracker – Blog](https://mantisbt.org/blog/)
[Proudly powered by WordPress](https://wordpress.org/)



=== Content from mantisbt.org_8753c5e1_20250119_112844.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D27056)
[Signup for a new account](/bugs/signup_page.php)

#### View Issue Details

[Wiki](wiki.php?id=27056)[Related Changesets](#changesets)[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0027056 | mantisbt | security | public | 2020-06-21 02:29 | 2020-09-11 09:02 |
|  | | | | | |
|
| Reporter | [hanno](https://mantisbt.org/bugs/view_user_page.php?id=11877) | Assigned To | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) |  | |
| Priority | normal | Severity | minor | Reproducibility | always |
| Status | closed | Resolution | fixed |  | |
| Product Version | 2.1.0 |  | | | |
| Target Version | 2.24.2 | Fixed in Version | 2.24.2 |  | |
|  | | | | | |
|
| Summary | 0027056: CVE-2020-16266: HTML injection (maybe XSS) via custom field on view\_all\_bug\_page.php | | | | |
| Description | The content of the filter variable in the view of the view\_all\_bug\_page.php is not filtered, allowing a thirdparty to inject HTML.  This would usually be a Cross Site Scripting Vulnerability, but the Content Security Policy header blocks executing scripts. However it might still be possible to achieve XSS by invoking functionality from the bundled javascript libraries.  The output should be properly html-escaped. | | | | |
| Steps To Reproduce | 1. Create a custom string type field. 2. Create a form that sends HTML code in the custom field 1 value (see poc).   poc: <form action="https://[hostname]/view\_all\_set.php?f=3" method="POST"> <input name="custom\_field\_1[]" value="<h1 style=color:red>INJECTION</h1>"> <input type=submit> </form> | | | | |
| Tags | No tags attached. | | | | |
|  | | | | | |
|

#### Relationships

[Relationship Graph](bug_relationship_graph.php?bug_id=27056&graph=relation)[Dependency Graph](bug_relationship_graph.php?bug_id=27056&graph=dependency)

| related to | [0021935](view.php?id=21935) | closed | [cproensa](https://mantisbt.org/bugs/view_user_page.php?id=18303) | Filter api refactoring, manage stored filters |
| --- | --- | --- | --- | --- |
| related to | [0027275](view.php?id=27275) | closed | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) | CVE-2020-25288: HTML Injection on bug\_update\_page.php |

#### Activities

| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2020-06-22 03:37  developer    [~0064114](view.php?id=27056#c64114 "Direct link to note") | Thanks for the bug report, I'll have a look at it.  Did you request a CVE for the issue ? If so, please let us know the ID; otherwise we'll take care of it. How would you like to be credited for the finding ? |
| --- | --- |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2020-06-22 06:21  developer    [~0064116](view.php?id=27056#c64116 "Direct link to note") | Confirmed HTML injection it is ! (and potential XSS if CSP settings allow)   [image.png](file_download.php?file_id=9126&type=bug) (12,504 bytes)      [image.png](file_download.php?file_id=9126&type=bug) (12,504 bytes) |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2020-06-22 06:52  developer    [~0064118](view.php?id=27056#c64118 "Direct link to note") | print\_filter\_values\_custom\_field() function seems to be the most appropriate place to add the escaping - [@cproensa](https://mantisbt.org/bugs/view_user_page.php?id=18303), what do you think ?  ``` diff --git a/core/filter_form_api.php b/core/filter_form_api.php index 6280cabbb..114deaa0d 100644 --- a/core/filter_form_api.php +++ b/core/filter_form_api.php @@ -1855,7 +1855,7 @@ function print_filter_values_custom_field( array $p_filter, $p_field_id ) {             if( filter_field_is_none( $t_val ) ) {                 $t_strings[] = lang_get( 'none' );             } else { -               $t_strings[] = $t_val; +               $t_strings[] = string_attribute( $t_val );             }             $t_inputs[] = '<input type="hidden" name="custom_field_' . $p_field_id . '[]" value="' . string_attribute( >        } ``` |
|  | |
| [hanno](https://mantisbt.org/bugs/view_user_page.php?id=11877)   [hanno](https://mantisbt.org/bugs/view_user_page.php?id=11877)  2020-06-22 06:54  reporter    [~0064119](view.php?id=27056#c64119 "Direct link to note") | One addition: I haven't discovered this myself, this was reported to me because I run a public mantis instance which is covered by a (non-payment) bug bounty.  I just ask the finder if he wants to be publicly credited for this. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2020-06-22 07:17  developer    [~0064120](view.php?id=27056#c64120 "Direct link to note") | Problem exists since refactoring of filter display in Mantis 2.1.0 (see [0021935](/bugs/view.php?id=21935 "[closed] Filter api refactoring, manage stored filters")) |
|  | |
| [hanno](https://mantisbt.org/bugs/view_user_page.php?id=11877)   [hanno](https://mantisbt.org/bugs/view_user_page.php?id=11877)  2020-07-04 02:47  reporter    [~0064150](view.php?id=27056#c64150 "Direct link to note") | Finder of the vulnerability is Jaime Andrés Restrepo, please credit him accordingly when publishing an update + security advisory. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2020-08-03 05:32  developer    [~0064220](view.php?id=27056#c64220 "Direct link to note") | CVE request 938519 sent |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2020-08-03 12:08  developer    [~0064222](view.php?id=27056#c64222 "Direct link to note") | CVE-2020-16266 assigned. |
|  | |

#### Related Changesets

| MantisBT: master 9ef8f23a  2020-06-22 02:55  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=25207) [Diff](https://github.com/mantisbt/mantisbt/commit/9ef8f23a8119221d010251112b1255630a46d903) | Fix XSS in view\_all\_bug\_page.php (CVE-2020-16266) | | Affected Issues[0027056](/bugs/view.php?id=27056 "[closed] CVE-2020-16266: HTML injection (maybe XSS) via custom field on view_all_bug_page.php") |
| --- | --- | --- | --- |
| mod - core/filter\_form\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/9ef8f23a8119221d010251112b1255630a46d903) [File](https://github.com/mantisbt/mantisbt/blob/9ef8f23a8119221d010251112b1255630a46d903/core/filter_form_api.php) |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1645 seconds



=== Content from github.com_7220017d_20250119_132038.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F9ef8f23a8119221d010251112b1255630a46d903)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F9ef8f23a8119221d010251112b1255630a46d903)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  77](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/9ef8f23a8119221d010251112b1255630a46d903)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix XSS in view\_all\_bug\_page.php ([CVE-2020-16266](https://github.com/advisories/GHSA-4rrc-5vp6-m3f6 "CVE-2020-16266"))

[Browse files](/mantisbt/mantisbt/tree/9ef8f23a8119221d010251112b1255630a46d903)
Browse the repository at this point in the history

```
Hanno Boeck reported a stored cross-site scripting (XSS) vulnerability,
originally discovered by Jaime Andres Restrepo.

Improper escaping on view_all_bug_page.php allowed a remote attacker to
inject arbitrary HTML into the page by saving it into a text Custom
Field, leading to possible code execution in the browser of any user
subsequently viewing the issue (if CSP settings allow it).

Prevent the attack by properly escaping the custom field's contents
before display.

Fixes #27056
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Aug 3, 2020

1 parent
[2fc6661](/mantisbt/mantisbt/commit/2fc66610c3d92232e22520bba15a7d510af9e0e5)

commit 9ef8f23

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[core/filter\_form\_api.php](#diff-09c02a25efdf9d3f1c303bd5810247961613e21885c2729f24de8e09381e6330 "core/filter_form_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/9ef8f23a8119221d010251112b1255630a46d903/core/filter_form_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1855,7 +1855,7 @@ function print\_filter\_values\_custom\_field( array $p\_filter, $p\_field\_id ) { |
|  |  | if( filter\_field\_is\_none( $t\_val ) ) { |
|  |  | $t\_strings[] = lang\_get( 'none' ); |
|  |  | } else { |
|  |  | $t\_strings[] = $t\_val; |
|  |  | $t\_strings[] = string\_attribute( $t\_val ); |
|  |  | } |
|  |  | $t\_inputs[] = '<input type="hidden" name="custom\_field\_' . $p\_field\_id . '[]" value="' . string\_attribute( $t\_val ) . '" />'; |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9ef8f23`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F9ef8f23a8119221d010251112b1255630a46d903) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


