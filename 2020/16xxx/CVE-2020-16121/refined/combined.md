=== Content from launchpad.net_c56b497c_20250119_133350.html ===

[Log in / Register](https://launchpad.net/~seth-arnold/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~seth-arnold)

## [Seth Arnold](https://launchpad.net/~seth-arnold)

* Overview
* [Code](https://code.launchpad.net/~seth-arnold)
* [Bugs](https://bugs.launchpad.net/~seth-arnold)
* [Blueprints](https://blueprints.launchpad.net/~seth-arnold)
* [Translations](https://translations.launchpad.net/~seth-arnold)
* [Answers](https://answers.launchpad.net/~seth-arnold)

* [Related packages](https://launchpad.net/~seth-arnold/%2Brelated-packages)
* [Related projects](https://launchpad.net/~seth-arnold/%2Brelated-projects)

## User information

Launchpad Id:
seth-arnold

Email:
[Log in](%2Blogin) for email information.

Member since:
2006-05-22

[![Icon of AppArmor Developers](https://launchpadlibrarian.net/65472736/toxie-14.png "Member of AppArmor Developers")](/~apparmor-dev)
[![Icon of Canonical Partner Developers](https://launchpadlibrarian.net/74993564/14.png "Member of Canonical Partner Developers")](/~canonical-partner-dev)
[![Icon of OEM Archive Admins](https://launchpadlibrarian.net/31251458/oem-admin-logo_14x14.png "Member of OEM Archive Admins")](/~oem-archive)
[![Icon of Ubuntu Bug Control](https://launchpadlibrarian.net/4423778/qa-icon.png "Member of Ubuntu Bug Control")](/~ubuntu-bugcontrol)
[![Icon of Ubuntu IRC Team](https://launchpadlibrarian.net/1741440/xchat.png "Member of Ubuntu IRC Team")](/~ubuntu-irc)
[![Icon of Ubuntu LXC Security team](https://launchpadlibrarian.net/673452720/14.png "Member of Ubuntu LXC Security team")](/~ubuntu-lxc-security)
[![Icon of Ubuntu Members](https://launchpadlibrarian.net/606495581/CoF%2014px.png "Member of Ubuntu Members")](/~ubuntumembers)
[![Icon of Ubuntu Security Team](https://launchpadlibrarian.net/1575441/Lock.png "Member of Ubuntu Security Team")](/~ubuntu-security)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English, German

OpenPGP keys:

415010F1BA23C8C720DFB1F5F32172599D8D2E97

SSH keys:

[sarnold@haig](%2Bsshkeys)

Time zone:

America/Los\_Angeles
(UTC-0800)

Karma:
[1792](https://launchpad.net/~seth-arnold/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**sarnold**
 on
**irc.oftc.net**

![IRC](/@@/social-irc "IRC")
**sarnold**
 on
**irc.libera.chat**

![IRC](/@@/social-irc "IRC")
**sarnold**
 on
**chat.canonical.com**

![Matrix](/@@/social-matrix "Matrix") [**@seth-arnold:ubuntu.com**](https://matrix.to//#/@seth-arnold:ubuntu.com)

## Personal package archives

| [doghouse](/~seth-arnold/%2Barchive/ubuntu/doghouse) |
| --- |
| [testing](/~seth-arnold/%2Barchive/ubuntu/testing) |

## [All memberships](https://launchpad.net/~seth-arnold/%2Bparticipation) Latest memberships

| [Ubuntu Matrix Operators](/~matrix-operators)  Joined on 2024-03-31 | |
| --- | --- |
| [#ubuntu-devel IRC Operators](/~irc-ubuntu-devel-ops)  Joined on 2022-11-01 | |
| [Ubuntu IRC Council](/~ubuntu-irc-council)  Joined on 2021-05-25 | |
| [Ubuntu cloaked people on Libera](/~ubuntu-irc-cloaks)  Joined on 2021-05-10 | |

## [Recent activities](https://launchpad.net/~seth-arnold/%2Bkarma) Most active in

| [Ubuntu CVE Tracker](/ubuntu-cve-tracker) |  |  |  |
| --- | --- | --- | --- |
| [ubuntu-security-tools](/ubuntu-security-tools) |  |  |  |
| [QA Regression Testing](/qa-regression-testing) |  |  |  |
| [Ubuntu](/ubuntu) |  |  |  |
| [Launchpad itself](/launchpad) |  |  |  |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_142eadb6_20250119_114635.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[packagekit package](https://launchpad.net/ubuntu/%2Bsource/packagekit)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/packagekit)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/packagekit)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/packagekit)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/packagekit)

# Reading local files as root leads to sensitive information disclosure

Bug #1888887 reported by
[Vaisha Bernard](https://launchpad.net/~vaisha)
on 2020-07-24

[260](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [packagekit (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit "Latest release: 1.2.8-2ubuntu1.1, uploaded to main on 2024-12-13 17:44:11.152238+00:00 by Andreas Hasenack (ahasenack), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Undecided | Unassigned |  |

### Bug Description

Hi,

The InstallFiles, GetFilesLocal and GetDetailsLocal methods of the d-bus interface to PackageKit accesses given files before checking for authorization. This allows non-privileged users to learn the MIME type of any file on the system.

Example in attached Python script:

$ python3 test\_file\_exists\_pk.py /root/.bashrc

File exists and is of MIME type: 'text/plain'

$ python3 test\_file\_exists\_pk.py /root/.bashrca

File does not exist

Description: Ubuntu 20.04 LTS

Release: 20.04

packagekit:

  Installed: 1.1.13-2ubuntu1

  Candidate: 1.1.13-2ubuntu1

  Version table:

 \*\*\* 1.1.13-2ubuntu1 500

        500 <http://nl.archive.ubuntu.com/ubuntu> focal/main amd64 Packages

        100 /var/lib/dpkg/status

Kind regards,

Vaisha Bernard

EYE Control B.V.

## CVE References

* [2020-16121](/bugs/cve/2020-16121 "PackageKit provided detailed error me...")
* [2020-16122](/bugs/cve/2020-16122 "PackageKit's apt backend mistakenly t...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Vaisha Bernard (vaisha)](https://launchpad.net/~vaisha) wrote on 2020-07-24: |  |  | [#1](/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/comments/1) |
| --- | --- | --- | --- |

* [test\_file\_exists\_pk.py](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/%2Battachment/5395611/%2Bfiles/test_file_exists_pk.py)
  [Edit](/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/%2Battachment/5395611)
  (1.2 KiB,
  text/x-python)

[Julian Andres Klode (juliank)](https://launchpad.net/~juliank)
on 2020-08-28

| Changed in packagekit (Ubuntu): | |
| --- | --- |
| **status**: | New → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Julian Andres Klode (juliank)](https://launchpad.net/~juliank) wrote on 2020-09-22: |  |  | [#3](/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/comments/3) |
| --- | --- | --- | --- |

* [0002-Information-disclosure-in-InstallFiles-GetFilesLocal.patch](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/%2Battachment/5413160/%2Bfiles/0002-Information-disclosure-in-InstallFiles-GetFilesLocal.patch)
  [Edit](/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/%2Battachment/5413160)
  (5.8 KiB,
  text/plain)

Attached patch

Attached patch

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2020-09-22: |  |  | [#4](/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/comments/4) |
| --- | --- | --- | --- |

Please use CVE-2020-16121 for this issue. Thanks.

Please use CVE-2020-16121 for this issue. Thanks.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2020-09-24: |  |  | [#5](/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/comments/5) |
| --- | --- | --- | --- |

This bug was fixed in the package packagekit - 1.1.13-2ubuntu1.1

---------------

packagekit (1.1.13-2ubuntu1.1) focal-security; urgency=medium

\* SECURITY UPDATE: information disclosure (LP: [#1888887](/bugs/1888887))

    - debian/patches/CVE-2020-16121.patch: hide failures behind a single

      error message in src/pk-transaction.c.

    - CVE-2020-16121

  \* SECURITY UPDATE: untrusted local file installation (LP: [#1882098](/bugs/1882098))

    - debian/patches/CVE-2020-16122.patch: do not trust local packages in

      backends/aptcc/apt-intf.cpp.

    - CVE-2020-16122

-- Marc Deslauriers <email address hidden> Wed, 23 Sep 2020 06:55:22 -0400

This bug was fixed in the package packagekit - 1.1.13-2ubuntu1.1
---------------
packagekit (1.1.13-2ubuntu1.1) focal-security; urgency=medium
\* SECURITY UPDATE: information disclosure (LP: #1888887)
- debian/patches/CVE-2020-16121.patch: hide failures behind a single
error message in src/pk-transaction.c.
- CVE-2020-16121
\* SECURITY UPDATE: untrusted local file installation (LP: #1882098)
- debian/patches/CVE-2020-16122.patch: do not trust local packages in
backends/aptcc/apt-intf.cpp.
- CVE-2020-16122
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Wed, 23 Sep 2020 06:55:22 -0400

| Changed in packagekit (Ubuntu): | |
| --- | --- |
| **status**: | Triaged → Fix Released |

[Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur)
on 2020-09-24

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2020-09-24: |  |  | [#6](/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/comments/6) |
| --- | --- | --- | --- |

The updates for this issue have been released:

<https://ubuntu.com/security/notices/USN-4538-1>

Thanks!

The updates for this issue have been released:
https://ubuntu.com/security/notices/USN-4538-1
Thanks!

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/packagekit/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [0002-Information-disclosure-in-InstallFiles-GetFilesLocal.patch](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/%2Battachment/5413160/%2Bfiles/0002-Information-disclosure-in-InstallFiles-GetFilesLocal.patch)
  [Edit](/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/%2Battachment/5413160 "Change patch details")

* [Add patch](/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/%2Baddcomment?field.patch=on)

## Bug attachments

* [test\_file\_exists\_pk.py](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/%2Battachment/5395611/%2Bfiles/test_file_exists_pk.py)
  [Edit](/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/%2Battachment/5395611 "Change attachment details")

* [Add attachment](/ubuntu/%2Bsource/packagekit/%2Bbug/1888887/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_0dca030f_20250119_133349.html ===

[Log in / Register](https://launchpad.net/~janitor/%2Blogin)

[![](/@@/person-inactive-logo)](https://launchpad.net/~janitor)

## [Launchpad Janitor](https://launchpad.net/~janitor)

* Overview
* [Code](https://code.launchpad.net/~janitor)
* [Bugs](https://bugs.launchpad.net/~janitor)
* [Blueprints](https://blueprints.launchpad.net/~janitor)
* [Translations](https://translations.launchpad.net/~janitor)
* [Answers](https://answers.launchpad.net/~janitor)

Launchpad Janitor does not use Launchpad.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))


