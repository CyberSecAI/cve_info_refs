- **Root cause of vulnerability:** The vulnerability stems from the ability to modify read-only memory pages using the `ptrace` system call. Although the Azure Sphere kernel enforces a security mechanism that prevents writable memory from being marked as executable and vice-versa, it appears that this mechanism does not prevent direct writes to non-writable pages via `PTRACE_POKETEXT`.
- **Weaknesses/vulnerabilities present:** The vulnerability lies in the improper access control of the `ptrace` system call. The kernel's memory protection mechanism fails to prevent `ptrace` from modifying read-only memory.
- **Impact of exploitation:** An attacker who has already compromised an application can use this vulnerability to execute unsigned code by writing shellcode into the application's memory space, bypassing the intended memory protection mechanisms. This allows for arbitrary code execution within the context of the compromised application.
- **Attack vectors:** The attack vector is through the `ptrace` system call. An attacker needs to be able to execute code within the compromised application. The attacker uses `ptrace` to attach to a child process (also started by the attacker) and write shellcode into a read-only section of the child process's memory.
- **Required attacker capabilities/position:** The attacker must have already gained code execution within a running application on the Azure Sphere device. From this position, the attacker can then use `ptrace` to modify the application's memory and execute arbitrary code.