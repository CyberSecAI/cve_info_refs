=== Content from launchpad.net_01709614_20250119_135112.html ===

[Log in / Register](https://launchpad.net/~mdeslaur/%2Blogin)

[![](https://launchpadlibrarian.net/105574979/head-2011-64px.jpg)](https://launchpad.net/~mdeslaur)

## [Marc Deslauriers](https://launchpad.net/~mdeslaur)

* Overview
* [Code](https://code.launchpad.net/~mdeslaur)
* [Bugs](https://bugs.launchpad.net/~mdeslaur)
* [Blueprints](https://blueprints.launchpad.net/~mdeslaur)
* [Translations](https://translations.launchpad.net/~mdeslaur)
* [Answers](https://answers.launchpad.net/~mdeslaur)

Ubuntu Security Engineer

* [Related packages](https://launchpad.net/~mdeslaur/%2Brelated-packages)
* [Related projects](https://launchpad.net/~mdeslaur/%2Brelated-projects)

## User information

Launchpad Id:
mdeslaur

Email:
[Log in](%2Blogin) for email information.

Member since:
2006-05-31

[![Icon of AppArmor Developers](https://launchpadlibrarian.net/65472736/toxie-14.png "Member of AppArmor Developers")](/~apparmor-dev)
[![Icon of Bluetooth](https://launchpadlibrarian.net/4683649/stock_bluetooth.png "Member of Bluetooth")](/~bluetooth)
[![Icon of Canonical Partner Developers](https://launchpadlibrarian.net/74993564/14.png "Member of Canonical Partner Developers")](/~canonical-partner-dev)
[![Icon of Edubuntu Developers](https://launchpadlibrarian.net/71879383/edubuntu-logo-only_14.png "Member of Edubuntu Developers")](/~edubuntu-dev)
[![Icon of GNOME3 Team](https://launchpadlibrarian.net/235731434/roundel14.png "Member of GNOME3 Team")](/~gnome3-team)
[![Icon of Indicator Applet Developers](https://launchpadlibrarian.net/22816053/add-notification-applet.14.png "Member of Indicator Applet Developers")](/~indicator-applet-developers)
[![Icon of Kubuntu Ninjas - Yellow belts](https://launchpadlibrarian.net/192173133/belt2-yellow3.png "Member of Kubuntu Ninjas - Yellow belts")](/~kubuntu-ninjas-yellow-belts)
[![Icon of Kubuntu Ninjas](https://launchpadlibrarian.net/31496145/icon.png "Member of Kubuntu Ninjas")](/~kubuntu-ninjas)
[![Icon of Kubuntu Package Archives](https://launchpadlibrarian.net/44411915/deb-small.png "Member of Kubuntu Package Archives")](/~kubuntu-ppa)
[![Icon of Lubuntu Code](https://launchpadlibrarian.net/704307155/lennyborg_14.png "Member of Lubuntu Code")](/~lubuntu-code)
[![Icon of Lubuntu Continuous Integration](https://launchpadlibrarian.net/704307325/lennyborg_14.png "Member of Lubuntu Continuous Integration")](/~lubuntu-ci)
[![Icon of Lubuntu Developers](https://launchpadlibrarian.net/704306355/lennyborg_14.png "Member of Lubuntu Developers")](/~lubuntu-dev)
[![Icon of Lubuntu Packages Team](https://launchpadlibrarian.net/704305879/lenny_bug_14.png "Member of Lubuntu Packages Team")](/~lubuntu-packaging)
[![Icon of Lubuntu](https://launchpadlibrarian.net/357050187/14.png "Member of Lubuntu")](/~lubuntu-desktop)
[![Icon of Martin Pitt's fan](https://launchpadlibrarian.net/16410730/immaginexz0.png "Member of Martin Pitt's fan")](/~we-love-pitti)
[![Icon of MOTU](https://launchpadlibrarian.net/1516491/motu-image-2.png "Member of MOTU")](/~motu)
[![Icon of Network-manager](https://launchpadlibrarian.net/11610188/nm-team.png "Member of Network-manager")](/~network-manager)
[![Icon of OEM Archive Admins](https://launchpadlibrarian.net/31251458/oem-admin-logo_14x14.png "Member of OEM Archive Admins")](/~oem-archive)
[![Icon of Soren's Target Audience](https://launchpadlibrarian.net/20548684/golf.png "Member of Soren's Target Audience")](/~sorens-target-audience)
[![Icon of Super Friends](https://launchpadlibrarian.net/134634591/superman14.png "Member of Super Friends")](/~super-friends)
[![Icon of Ubuntu 64-bit](https://launchpadlibrarian.net/17575026/x2_amd2.png "Member of Ubuntu 64-bit")](/~64-bit)
[![Icon of Ubuntu Bug Control](https://launchpadlibrarian.net/4423778/qa-icon.png "Member of Ubuntu Bug Control")](/~ubuntu-bugcontrol)
[![Icon of Ubuntu Canada](https://launchpadlibrarian.net/3600006/Ubuntu_Canada_logo.png "Member of Ubuntu Canada")](/~ubuntu-ca)
[![Icon of Ubuntu Chumby Hackers](https://launchpadlibrarian.net/27381132/14.jpg "Member of Ubuntu Chumby Hackers")](/~ubuntu-chumby-hackers)
[![Icon of Ubuntu Contributing Developers](https://launchpadlibrarian.net/17290192/wrench_emblem-trans.png "Member of Ubuntu Contributing Developers")](/~ubuntu-developer-members)
[![Icon of Ubuntu Core Development Team](https://launchpadlibrarian.net/1072365/main.png "Member of Ubuntu Core Development Team")](/~ubuntu-core-dev)
[![Icon of Ubuntu Development Team](https://launchpadlibrarian.net/1072363/motu.png "Member of Ubuntu Development Team")](/~ubuntu-dev)
[![Icon of Ubuntu Documentation Project Team](https://launchpadlibrarian.net/162165522/ubuntu-doc.png "Member of Ubuntu Documentation Project Team")](/~ubuntu-doc)
[![Icon of Ubuntu GNOME Developers](https://launchpadlibrarian.net/254356645/roundel14.png "Member of Ubuntu GNOME Developers")](/~ubuntu-gnome-dev)
[![Icon of Ubuntu GNOME](https://launchpadlibrarian.net/258611022/ubuntu-gnome_14.png "Member of Ubuntu GNOME")](/~ubuntu-gnome)
[![Icon of Ubuntu Kylin Members](https://launchpadlibrarian.net/444398797/623185830.jpg "Member of Ubuntu Kylin Members")](/~ubuntukylin-members)
[![Icon of Ubuntu Local Community Teams](https://launchpadlibrarian.net/162222905/locoteams-icon.png "Member of Ubuntu Local Community Teams")](/~locoteams)
[![Icon of Ubuntu LXC Security team](https://launchpadlibrarian.net/673452720/14.png "Member of Ubuntu LXC Security team")](/~ubuntu-lxc-security)
[![Icon of Ubuntu MATE Developers](https://launchpadlibrarian.net/212349832/icon.png "Member of Ubuntu MATE Developers")](/~ubuntu-mate-dev)
[![Icon of Ubuntu Members](https://launchpadlibrarian.net/606495581/CoF%2014px.png "Member of Ubuntu Members")](/~ubuntumembers)
[![Icon of Ubuntu Phone](https://launchpadlibrarian.net/130028485/Icon.png "Member of Ubuntu Phone")](/~ubuntu-phone)
[![Icon of Ubuntu Push Notifications Developers](https://launchpadlibrarian.net/146910341/manpush_icon.png "Member of Ubuntu Push Notifications Developers")](/~ubuntu-push-devs)
[![Icon of Ubuntu Security Team](https://launchpadlibrarian.net/1575441/Lock.png "Member of Ubuntu Security Team")](/~ubuntu-security)
[![Icon of Ubuntu Sponsors](https://launchpadlibrarian.net/40794090/minitools.png "Member of Ubuntu Sponsors")](/~ubuntu-sponsors)
[![Icon of Ubuntu Studio Development](https://launchpadlibrarian.net/479050820/14.png "Member of Ubuntu Studio Development")](/~ubuntustudio-dev)
[![Icon of Xubuntu Artwork](https://launchpadlibrarian.net/341831649/icon_optimized_14.png "Member of Xubuntu Artwork")](/~xubuntu-art)
[![Icon of Xubuntu Developers](https://launchpadlibrarian.net/139019912/x-dev.png "Member of Xubuntu Developers")](/~xubuntu-dev)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English, English (Canada), French

OpenPGP keys:

50C4A0DDCF31E452CEB19B516569D855A744BE93

SSH keys:

[mdeslaur](%2Bsshkeys)

Time zone:

America/Montreal
(UTC-0500)

Karma:
[15263](https://launchpad.net/~mdeslaur/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**mdeslaur**
 on
**irc.libera.chat**

## [All bugs in progress](https://launchpad.net/~mdeslaur/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #2014052 [[Lunar FFE]: Samba 4.18.1, 4.17.7 and 4.16.10 Security Releases](https://bugs.launchpad.net/ubuntu/focal/%2Bsource/samba/%2Bbug/2014052) |  |
| --- | --- | --- |
| in [Ubuntu](/ubuntu) | | |

| --- | --- | --- | --- | --- | --- |
||  | #2014052 [[Lunar FFE]: Samba 4.18.1, 4.17.7 and 4.16.10 Security Releases](https://bugs.launchpad.net/ubuntu/jammy/%2Bsource/samba/%2Bbug/2014052) |  |
| --- | --- | --- |
| in [Ubuntu](/ubuntu) | | |

## [All assigned blueprints](/~mdeslaur/%2Bspecs?role=assignee) Assigned blueprints

| **[Security Catch-all](https://blueprints.launchpad.net/ubuntu/%2Bspec/security-p-catch-all "security-p-catch-all")** for **Ubuntu**  Implement various additional security things that don't need a full blueprint of their own. Some or all of this will be discussed in the morning roundtable discussions. | |
| --- | --- |
| **[2-Factor Authentication](https://blueprints.launchpad.net/ubuntu/%2Bspec/security-o-2factor-auth "security-o-2factor-auth")** for **Ubuntu**  Discuss how to implement sensible and friendly two-factor authentication into Ubuntu. | |
| **[Easier installation of security updates](https://blueprints.launchpad.net/ubuntu/%2Bspec/security-m-easier-security-updates "security-m-easier-security-updates")** for **Ubuntu**  This session will discuss ways to get security updates installed quickly and easily. | |

## Personal package archives

| [HandBrake](/~mdeslaur/%2Barchive/ubuntu/handbrake) |
| --- |
| [ScaleRes Indicator](/~mdeslaur/%2Barchive/ubuntu/indicator-scaleres) |
| [indicator-spotify](/~mdeslaur/%2Barchive/ubuntu/indicator-spotify) |
| [pasaffe](/~mdeslaur/%2Barchive/ubuntu/pasaffe) |
| [PPA for Marc Deslauriers](/~mdeslaur/%2Barchive/ubuntu/ppa) |
| [Screen locking issues](/~mdeslaur/%2Barchive/ubuntu/screen-locking) |
| [SteamOS](/~mdeslaur/%2Barchive/ubuntu/steamos) |
| [testing](/~mdeslaur/%2Barchive/ubuntu/testing) |

## [All memberships](https://launchpad.net/~mdeslaur/%2Bparticipation) Latest memberships

| [Ubuntu Security Leadership](/~ubuntu-security-leaders)  Joined on 2024-10-29 | |
| --- | --- |
| [Canonical Kernel Security Team](/~canonical-kernel-security-team)  Joined on 2021-01-20 | |

## [Recent activities](https://launchpad.net/~mdeslaur/%2Bkarma) Most active in

| [Ubuntu](/ubuntu) |  |  |  |  |
| --- | --- | --- | --- | --- |
| [Ubuntu CVE Tracker](/ubuntu-cve-tracker) |  |  |  |  |
| [Tools used by the Ubuntu QA Team](/ubuntu-qa-tools) |  |  |  |  |
| [ubuntu-security-tools](/ubuntu-security-tools) |  |  |  |  |
| [QA Regression Testing](/qa-regression-testing) |  |  |  |  |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_02c553bb_20250119_120845.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[packagekit package](https://launchpad.net/ubuntu/%2Bsource/packagekit)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/packagekit)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/packagekit)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/packagekit)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/packagekit)

# Packagekit lets user install untrusted local packages in Bionic and Focal

Bug #1882098 reported by
[Sami Niemimäki](https://launchpad.net/~niemimsa)
on 2020-06-04

[264](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [packagekit (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit "Latest release: 1.2.8-2ubuntu1.1, uploaded to main on 2024-12-13 17:44:11.152238+00:00 by Andreas Hasenack (ahasenack), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Undecided | Unassigned |  |

### Bug Description

We have packagekit configured to allow users to install trusted packages from preconfigured repositories, but disallowed them to install any untrusted packages.

The policykit configuration we use is following:

[tld.univ.packagekit]

Identity=unix-group:adm;

Action=org.freedesktop.packagekit.package-install;org.freedesktop.packagekit.package-reinstall;org.freedesktop.packagekit.package-remove;org.freedesktop.packagekit.system-sources-refresh;org.freedesktop.packagekit.system-update;org.freedesktop.packagekit.repair-system;

ResultAny=auth\_self

ResultActive=auth\_self

ResultInactive=auth\_self

[tld.univ.packagekit-deny]

Identity=unix-user:\*;

Action=org.freedesktop.packagekit.package-install-untrusted;

ResultAny=no

We would expect this to prevent users from installing local packages downloaded from random repositories, however this does not seem to be the case.

pkcon install-local random\_package.deb will happily prompt for the user to authenticate and will install the package, while pkcon --allow-untrusted install-local random\_package.deb will prompt for root password, which the user does not have.

Our initial toughts was that the issue would be in packagekitd, but after further investigations it looks like the issue could be in aptcc backend.

We are more than happy to provide you with further details, but the above should be enough to reproduce the issue.

See [original description](comments/0)

Tags:

[bionic](/ubuntu/%2Bsource/packagekit/%2Bbugs?field.tag=bionic)
[focal](/ubuntu/%2Bsource/packagekit/%2Bbugs?field.tag=focal)
[patch](/ubuntu/%2Bsource/packagekit/%2Bbugs?field.tag=patch)
[packagekit](/ubuntu/%2Bsource/packagekit/%2Bbugs?field.tag=packagekit)

## CVE References

* [2020-16121](/bugs/cve/2020-16121 "PackageKit provided detailed error me...")
* [2020-16122](/bugs/cve/2020-16122 "PackageKit's apt backend mistakenly t...")

[Sami Niemimäki (niemimsa)](https://launchpad.net/~niemimsa)
on 2020-06-04

| **affects**: | aptdaemon (Ubuntu) → packagekit (Ubuntu) |
| --- | --- |

[Sami Niemimäki (niemimsa)](https://launchpad.net/~niemimsa)
on 2020-06-04

| **description**: | updated |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Esko Järnfors (esko-jarnfors)](https://launchpad.net/~esko-jarnfors) wrote on 2020-06-12: |  |  | [#1](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/1) |
| --- | --- | --- | --- |

Hi!

Can someone confirm this has been at least read please?

Hi!
Can someone confirm this has been at least read please?

[Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold)
on 2020-06-13

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2020-06-13: |  |  | [#2](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/2) |
| --- | --- | --- | --- |

Hello Sami, Esko,

I'm not very familiar with the packagekit or policykit frameworks, so please forgive me if I'm far off course here with these thoughts:

- Is the [tld.univ.packagekit-deny] rule necessary? I'd hope that this permission wouldn't be granted to anyone but admins.

- Are there other rules in other files that might have granted this permission?

- Does it matter if the test users are in no groups? just their own username-group? adm? sudo?

- Does polkit or packagekit have a way to see which rules allow or deny any given request?

Thanks

Hello Sami, Esko,
I'm not very familiar with the packagekit or policykit frameworks, so please forgive me if I'm far off course here with these thoughts:
- Is the [tld.univ.packagekit-deny] rule necessary? I'd hope that this permission wouldn't be granted to anyone but admins.
- Are there other rules in other files that might have granted this permission?
- Does it matter if the test users are in no groups? just their own username-group? adm? sudo?
- Does polkit or packagekit have a way to see which rules allow or deny any given request?
Thanks

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sami Niemimäki (niemimsa)](https://launchpad.net/~niemimsa) wrote on 2020-06-13: |  |  | [#3](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/3) |
| --- | --- | --- | --- |

Hello Seth,

the packagekit-deny rule should not be necessary, it's there to underline what is specifically not allowed.

AFAIK, there are no other rules which could have granted this permission. This happens on a fresh install of Ubuntu where the above is the only modification to polkit rules.

I'm on vacation since yesterday evening, so I cannot currently check if the groups have some kind of unexpected effect.

See this for reference:

<https://github.com/hughsie/PackageKit/blob/master/policy/org.freedesktop.packagekit.policy.in>

The issue is that the command 'pkcon install-local evil-package-i-just-created.deb' triggers the action 'org.freedesktop.packagekit.package-install' instead of 'org.freedesktop.packagekit.package-install-untrusted' which it should.

Hello Seth,
the packagekit-deny rule should not be necessary, it's there to underline what is specifically not allowed.
AFAIK, there are no other rules which could have granted this permission. This happens on a fresh install of Ubuntu where the above is the only modification to polkit rules.
I'm on vacation since yesterday evening, so I cannot currently check if the groups have some kind of unexpected effect.
See this for reference:
https://github.com/hughsie/PackageKit/blob/master/policy/org.freedesktop.packagekit.policy.in
The issue is that the command 'pkcon install-local evil-package-i-just-created.deb' triggers the action 'org.freedesktop.packagekit.package-install' instead of 'org.freedesktop.packagekit.package-install-untrusted' which it should.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Sami Niemimäki (niemimsa)](https://launchpad.net/~niemimsa) wrote on 2020-07-21: |  |  | [#4](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/4) |
| --- | --- | --- | --- |

Hello Seth,

I can now confirm that it does not matter if the test users are in no groups.

The issue persists.

Lines 49 to 56 in the link I provided earlier describe the package-install-untrusted action which should be triggered when installing local packages:

<action id="org.freedesktop.packagekit.package-install-untrusted">

    <!-- SECURITY:

          - Normal users require admin authentication to install untrusted or

            unrecognised packages, as allowing users to do this without a

            password would be a massive security hole.

          - This is not retained as each package should be authenticated.

     -->

    <description>Install untrusted local file</description>

AFAIK this works as intended with other than aptcc backends, eg in Red Hat.

Hello Seth,
I can now confirm that it does not matter if the test users are in no groups.
The issue persists.
Lines 49 to 56 in the link I provided earlier describe the package-install-untrusted action which should be triggered when installing local packages:
<action id="org.freedesktop.packagekit.package-install-untrusted">
<!-- SECURITY:
- Normal users require admin authentication to install untrusted or
unrecognised packages, as allowing users to do this without a
password would be a massive security hole.
- This is not retained as each package should be authenticated.
-->
<description>Install untrusted local file</description>
AFAIK this works as intended with other than aptcc backends, eg in Red Hat.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Julian Andres Klode (juliank)](https://launchpad.net/~juliank) wrote on 2020-08-28: |  |  | [#5](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/5) |
| --- | --- | --- | --- |

Yup, install-local does indeed trigger package-install not package-install-untrusted

Aug 28 11:28:53 jak-t480s polkitd(authority=local)[1744]: Operator of unix-session:2 FAILED to authenticate to gain authorization for action org.freedesktop.packagekit.package-install for system-bus-name::1.535 [pkcon install-local xterm\_353-1ubuntu1\_amd64.deb] (owned by unix-user:jak)

Yup, install-local does indeed trigger package-install not package-install-untrusted
Aug 28 11:28:53 jak-t480s polkitd(authority=local)[1744]: Operator of unix-session:2 FAILED to authenticate to gain authorization for action org.freedesktop.packagekit.package-install for system-bus-name::1.535 [pkcon install-local xterm\_353-1ubuntu1\_amd64.deb] (owned by unix-user:jak)

| Changed in packagekit (Ubuntu): | |
| --- | --- |
| **status**: | New → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Julian Andres Klode (juliank)](https://launchpad.net/~juliank) wrote on 2020-09-01: |  |  | [#6](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/6) |
| --- | --- | --- | --- |

I found out the cause for this, but other backends are affected too probably

- basically the packagekit daemon assumes that packages can be trusted themselves,

so backends that do not have trust information in packages need to explicitly

reject local packages as untrusted, so that PackageKit reprompts for trusted.

I'm not sure how to proceed there - I can come up with a fix for aptcc, but

upstream can't put in the work for other backends, but then releasing just an

apt fix while other backends are vulnerable would not be a good call either.

I found out the cause for this, but other backends are affected too probably
- basically the packagekit daemon assumes that packages can be trusted themselves,
so backends that do not have trust information in packages need to explicitly
reject local packages as untrusted, so that PackageKit reprompts for trusted.
I'm not sure how to proceed there - I can come up with a fix for aptcc, but
upstream can't put in the work for other backends, but then releasing just an
apt fix while other backends are vulnerable would not be a good call either.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Esko Järnfors (esko-jarnfors)](https://launchpad.net/~esko-jarnfors) wrote on 2020-09-03: |  |  | [#7](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/7) |
| --- | --- | --- | --- |

Thanks for triaging and investigating this, Julian!

A fix for at least the aptcc backend would be highly appreciated -- I'd hope the other backends will fix this on their own if they care about it.

The point of packagekit+policykit is to enable people to do (at least somewhat limited) stuff without explicit root access -- otherwise you'd just give them sudo rights and be done with it. In the current situation, granting a user the right to install ("trusted") packages actually grants them rights to place arbitrary files in the filesystem and execute arbitrary code (package scripts) as root, which is at the very very least highly misleading.

I took a cursory look at the earlier apt backend written in python (which is now deleted from the packagekit tree) and it at least looked like it had some logic to decide whether a package can be trusted or not so it didn't seem like checking where the package is coming from would be unprecedented.

Thanks for triaging and investigating this, Julian!
A fix for at least the aptcc backend would be highly appreciated -- I'd hope the other backends will fix this on their own if they care about it.
The point of packagekit+policykit is to enable people to do (at least somewhat limited) stuff without explicit root access -- otherwise you'd just give them sudo rights and be done with it. In the current situation, granting a user the right to install ("trusted") packages actually grants them rights to place arbitrary files in the filesystem and execute arbitrary code (package scripts) as root, which is at the very very least highly misleading.
I took a cursory look at the earlier apt backend written in python (which is now deleted from the packagekit tree) and it at least looked like it had some logic to decide whether a package can be trusted or not so it didn't seem like checking where the package is coming from would be unprecedented.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Julian Andres Klode (juliank)](https://launchpad.net/~juliank) wrote on 2020-09-03: |  |  | [#8](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/8) |
| --- | --- | --- | --- |

It asks apt if the package is trusted, and from apt's POV it is. which might or might not be good, UX wise, for apt (maybe it should also tell you that local debs are not verified), but not much of an issue there.

It asks apt if the package is trusted, and from apt's POV it is. which might or might not be good, UX wise, for apt (maybe it should also tell you that local debs are not verified), but not much of an issue there.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Julian Andres Klode (juliank)](https://launchpad.net/~juliank) wrote on 2020-09-22: |  |  | [#9](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/9) |
| --- | --- | --- | --- |

* [0001-aptcc-Do-not-trust-local-debs-allows-root-privileges.patch](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/%2Battachment/5413161/%2Bfiles/0001-aptcc-Do-not-trust-local-debs-allows-root-privileges.patch)
  [Edit](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/%2Battachment/5413161)
  (1.4 KiB,
  text/plain)

[Ubuntu Foundations Team Bug Bot (crichton)](https://launchpad.net/~crichton)
on 2020-09-22

| **tags**: | added: patch |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Seth Arnold (seth-arnold)](https://launchpad.net/~seth-arnold) wrote on 2020-09-22: |  |  | [#10](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/10) |
| --- | --- | --- | --- |

Please use CVE-2020-16122 for this issue. Thanks.

Please use CVE-2020-16122 for this issue. Thanks.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2020-09-23: |  |  | [#11](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/11) |
| --- | --- | --- | --- |

Hi Julian,

Could you please backport the patch in comment #9 to xenial? The code in xenial is substantially different.

Thanks!

Hi Julian,
Could you please backport the patch in comment #9 to xenial? The code in xenial is substantially different.
Thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Julian Andres Klode (juliank)](https://launchpad.net/~juliank) wrote on 2020-09-23: |  |  | [#12](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/12) |
| --- | --- | --- | --- |

On it

On it

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Esko Järnfors (esko-jarnfors)](https://launchpad.net/~esko-jarnfors) wrote on 2020-09-23: |  |  | [#13](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/13) |
| --- | --- | --- | --- |

Hi and thanks everyone!

I tested the patch and it works fine on focal (packagekit-1.1.13), but even though it applies, it doesn't fix this on bionic (packagekit-1.1.9).

Hi and thanks everyone!
I tested the patch and it works fine on focal (packagekit-1.1.13), but even though it applies, it doesn't fix this on bionic (packagekit-1.1.9).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2020-09-23: |  |  | [#14](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/14) |
| --- | --- | --- | --- |

I am currently preparing updates for this issue, and I just tested the bionic update that includes this patch, and it works in my environment.

Could you please make sure you created the policy file ok, and have rebooted after updating packagekit?

I am currently preparing updates for this issue, and I just tested the bionic update that includes this patch, and it works in my environment.
Could you please make sure you created the policy file ok, and have rebooted after updating packagekit?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Julian Andres Klode (juliank)](https://launchpad.net/~juliank) wrote on 2020-09-23: |  |  | [#15](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/15) |
| --- | --- | --- | --- |

Easiest is to just look at policykit log and see that it triggers the untrusted action, fwiw. IMO.

Easiest is to just look at policykit log and see that it triggers the untrusted action, fwiw. IMO.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Julian Andres Klode (juliank)](https://launchpad.net/~juliank) wrote on 2020-09-23: |  |  | [#16](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/16) |
| --- | --- | --- | --- |

* [cve-2020-16122.patch](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/%2Battachment/5413547/%2Bfiles/cve-2020-16122.patch)
  [Edit](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/%2Battachment/5413547)
  (987 bytes,
  text/plain)

Attached patch for xenial, but I can't test it.

$ pkcon install-local xterm\_353-1ubuntu1\_amd64.deb

Installing files [=========================]

Finished [=========================]

Fatal error: MIME type 'application/vnd.debian.binary-package' not supported /home/jak/Downloads/xterm\_353-1ubuntu1\_amd64.deb

(trying with a random deb, in lxd container)

Attached patch for xenial, but I can't test it.
$ pkcon install-local xterm\_353-1ubuntu1\_amd64.deb
Installing files [=========================]
Finished [=========================]
Fatal error: MIME type 'application/vnd.debian.binary-package' not supported /home/jak/Downloads/xterm\_353-1ubuntu1\_amd64.deb
(trying with a random deb, in lxd container)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Esko Järnfors (esko-jarnfors)](https://launchpad.net/~esko-jarnfors) wrote on 2020-09-24: |  |  | [#17](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/17) |
| --- | --- | --- | --- |

I checked the patch again on bionic, turns out I missed the packagekit restart the first time and the package postinst script for one reason or another didn't restart the daemon on my test machine as it did on focal. The patch seems to work on bionic as well.

I checked the patch again on bionic, turns out I missed the packagekit restart the first time and the package postinst script for one reason or another didn't restart the daemon on my test machine as it did on focal. The patch seems to work on bionic as well.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2020-09-24: |  |  | [#18](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/18) |
| --- | --- | --- | --- |

This bug was fixed in the package packagekit - 1.1.13-2ubuntu1.1

---------------

packagekit (1.1.13-2ubuntu1.1) focal-security; urgency=medium

\* SECURITY UPDATE: information disclosure (LP: [#1888887](/bugs/1888887))

    - debian/patches/CVE-2020-16121.patch: hide failures behind a single

      error message in src/pk-transaction.c.

    - CVE-2020-16121

  \* SECURITY UPDATE: untrusted local file installation (LP: [#1882098](/bugs/1882098))

    - debian/patches/CVE-2020-16122.patch: do not trust local packages in

      backends/aptcc/apt-intf.cpp.

    - CVE-2020-16122

-- Marc Deslauriers <email address hidden> Wed, 23 Sep 2020 06:55:22 -0400

This bug was fixed in the package packagekit - 1.1.13-2ubuntu1.1
---------------
packagekit (1.1.13-2ubuntu1.1) focal-security; urgency=medium
\* SECURITY UPDATE: information disclosure (LP: #1888887)
- debian/patches/CVE-2020-16121.patch: hide failures behind a single
error message in src/pk-transaction.c.
- CVE-2020-16121
\* SECURITY UPDATE: untrusted local file installation (LP: #1882098)
- debian/patches/CVE-2020-16122.patch: do not trust local packages in
backends/aptcc/apt-intf.cpp.
- CVE-2020-16122
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Wed, 23 Sep 2020 06:55:22 -0400

| Changed in packagekit (Ubuntu): | |
| --- | --- |
| **status**: | Triaged → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2020-09-24: |  |  | [#19](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/19) |
| --- | --- | --- | --- |

This bug was fixed in the package packagekit - 1.1.9-1ubuntu2.18.04.6

---------------

packagekit (1.1.9-1ubuntu2.18.04.6) bionic-security; urgency=medium

\* SECURITY UPDATE: information disclosure (LP: [#1888887](/bugs/1888887))

    - debian/patches/CVE-2020-16121.patch: hide failures behind a single

      error message in src/pk-transaction.c.

    - CVE-2020-16121

  \* SECURITY UPDATE: untrusted local file installation (LP: [#1882098](/bugs/1882098))

    - debian/patches/CVE-2020-16122.patch: do not trust local packages in

      backends/aptcc/apt-intf.cpp.

    - CVE-2020-16122

-- Marc Deslauriers <email address hidden> Wed, 23 Sep 2020 07:01:04 -0400

This bug was fixed in the package packagekit - 1.1.9-1ubuntu2.18.04.6
---------------
packagekit (1.1.9-1ubuntu2.18.04.6) bionic-security; urgency=medium
\* SECURITY UPDATE: information disclosure (LP: #1888887)
- debian/patches/CVE-2020-16121.patch: hide failures behind a single
error message in src/pk-transaction.c.
- CVE-2020-16121
\* SECURITY UPDATE: untrusted local file installation (LP: #1882098)
- debian/patches/CVE-2020-16122.patch: do not trust local packages in
backends/aptcc/apt-intf.cpp.
- CVE-2020-16122
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Wed, 23 Sep 2020 07:01:04 -0400

| Changed in packagekit (Ubuntu): | |
| --- | --- |
| **status**: | Triaged → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2020-09-24: |  |  | [#20](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/20) |
| --- | --- | --- | --- |

This bug was fixed in the package packagekit - 0.8.17-4ubuntu6~gcc5.4ubuntu1.5

---------------

packagekit (0.8.17-4ubuntu6~gcc5.4ubuntu1.5) xenial-security; urgency=medium

\* SECURITY UPDATE: information disclosure (LP: [#1888887](/bugs/1888887))

    - debian/patches/CVE-2020-16121.patch: hide failures behind a single

      error message in src/pk-transaction.c.

    - CVE-2020-16121

  \* SECURITY UPDATE: untrusted local file installation (LP: [#1882098](/bugs/1882098))

    - debian/patches/CVE-2020-16122.patch: do not trust local packages in

      backends/aptcc/apt-intf.cpp.

    - CVE-2020-16122

-- Marc Deslauriers <email address hidden> Wed, 23 Sep 2020 13:23:04 -0400

This bug was fixed in the package packagekit - 0.8.17-4ubuntu6~gcc5.4ubuntu1.5
---------------
packagekit (0.8.17-4ubuntu6~gcc5.4ubuntu1.5) xenial-security; urgency=medium
\* SECURITY UPDATE: information disclosure (LP: #1888887)
- debian/patches/CVE-2020-16121.patch: hide failures behind a single
error message in src/pk-transaction.c.
- CVE-2020-16121
\* SECURITY UPDATE: untrusted local file installation (LP: #1882098)
- debian/patches/CVE-2020-16122.patch: do not trust local packages in
backends/aptcc/apt-intf.cpp.
- CVE-2020-16122
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Wed, 23 Sep 2020 13:23:04 -0400

| Changed in packagekit (Ubuntu): | |
| --- | --- |
| **status**: | Triaged → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2020-09-24: |  |  | [#21](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/comments/21) |
| --- | --- | --- | --- |

The updates for this issue have been released:

<https://ubuntu.com/security/notices/USN-4538-1>

Thanks!

The updates for this issue have been released:
https://ubuntu.com/security/notices/USN-4538-1
Thanks!

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/packagekit/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [0001-aptcc-Do-not-trust-local-debs-allows-root-privileges.patch](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/%2Battachment/5413161/%2Bfiles/0001-aptcc-Do-not-trust-local-debs-allows-root-privileges.patch)
  [Edit](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/%2Battachment/5413161 "Change patch details")
* [cve-2020-16122.patch](https://bugs.launchpad.net/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/%2Battachment/5413547/%2Bfiles/cve-2020-16122.patch)
  [Edit](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/%2Battachment/5413547 "Change patch details")

* [Add patch](/ubuntu/%2Bsource/packagekit/%2Bbug/1882098/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_c56b497c_20250119_135112.html ===

[Log in / Register](https://launchpad.net/~seth-arnold/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~seth-arnold)

## [Seth Arnold](https://launchpad.net/~seth-arnold)

* Overview
* [Code](https://code.launchpad.net/~seth-arnold)
* [Bugs](https://bugs.launchpad.net/~seth-arnold)
* [Blueprints](https://blueprints.launchpad.net/~seth-arnold)
* [Translations](https://translations.launchpad.net/~seth-arnold)
* [Answers](https://answers.launchpad.net/~seth-arnold)

* [Related packages](https://launchpad.net/~seth-arnold/%2Brelated-packages)
* [Related projects](https://launchpad.net/~seth-arnold/%2Brelated-projects)

## User information

Launchpad Id:
seth-arnold

Email:
[Log in](%2Blogin) for email information.

Member since:
2006-05-22

[![Icon of AppArmor Developers](https://launchpadlibrarian.net/65472736/toxie-14.png "Member of AppArmor Developers")](/~apparmor-dev)
[![Icon of Canonical Partner Developers](https://launchpadlibrarian.net/74993564/14.png "Member of Canonical Partner Developers")](/~canonical-partner-dev)
[![Icon of OEM Archive Admins](https://launchpadlibrarian.net/31251458/oem-admin-logo_14x14.png "Member of OEM Archive Admins")](/~oem-archive)
[![Icon of Ubuntu Bug Control](https://launchpadlibrarian.net/4423778/qa-icon.png "Member of Ubuntu Bug Control")](/~ubuntu-bugcontrol)
[![Icon of Ubuntu IRC Team](https://launchpadlibrarian.net/1741440/xchat.png "Member of Ubuntu IRC Team")](/~ubuntu-irc)
[![Icon of Ubuntu LXC Security team](https://launchpadlibrarian.net/673452720/14.png "Member of Ubuntu LXC Security team")](/~ubuntu-lxc-security)
[![Icon of Ubuntu Members](https://launchpadlibrarian.net/606495581/CoF%2014px.png "Member of Ubuntu Members")](/~ubuntumembers)
[![Icon of Ubuntu Security Team](https://launchpadlibrarian.net/1575441/Lock.png "Member of Ubuntu Security Team")](/~ubuntu-security)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English, German

OpenPGP keys:

415010F1BA23C8C720DFB1F5F32172599D8D2E97

SSH keys:

[sarnold@haig](%2Bsshkeys)

Time zone:

America/Los\_Angeles
(UTC-0800)

Karma:
[1792](https://launchpad.net/~seth-arnold/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**sarnold**
 on
**irc.oftc.net**

![IRC](/@@/social-irc "IRC")
**sarnold**
 on
**irc.libera.chat**

![IRC](/@@/social-irc "IRC")
**sarnold**
 on
**chat.canonical.com**

![Matrix](/@@/social-matrix "Matrix") [**@seth-arnold:ubuntu.com**](https://matrix.to//#/@seth-arnold:ubuntu.com)

## Personal package archives

| [doghouse](/~seth-arnold/%2Barchive/ubuntu/doghouse) |
| --- |
| [testing](/~seth-arnold/%2Barchive/ubuntu/testing) |

## [All memberships](https://launchpad.net/~seth-arnold/%2Bparticipation) Latest memberships

| [Ubuntu Matrix Operators](/~matrix-operators)  Joined on 2024-03-31 | |
| --- | --- |
| [#ubuntu-devel IRC Operators](/~irc-ubuntu-devel-ops)  Joined on 2022-11-01 | |
| [Ubuntu IRC Council](/~ubuntu-irc-council)  Joined on 2021-05-25 | |
| [Ubuntu cloaked people on Libera](/~ubuntu-irc-cloaks)  Joined on 2021-05-10 | |

## [Recent activities](https://launchpad.net/~seth-arnold/%2Bkarma) Most active in

| [Ubuntu CVE Tracker](/ubuntu-cve-tracker) |  |  |  |
| --- | --- | --- | --- |
| [ubuntu-security-tools](/ubuntu-security-tools) |  |  |  |
| [QA Regression Testing](/qa-regression-testing) |  |  |  |
| [Ubuntu](/ubuntu) |  |  |  |
| [Launchpad itself](/launchpad) |  |  |  |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))


