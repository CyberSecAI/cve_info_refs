Based on the provided information, here's an analysis of CVE-2020-16123:

**Root Cause of Vulnerability:**

- An Ubuntu-specific patch in PulseAudio incorrectly handled snap client connections. The vulnerability stems from the PulseAudio snap policy module relying on `SCM_CREDENTIALS` control messages attached to `PA_COMMAND_AUTH` requests to identify snap-confined clients.
- If the `SO_PASSCRED` socket option is not set, the server receives a message with empty `SCM_CREDENTIALS` (pid=0, uid=65534, gid=65534). The policy module then tries to look up the confinement of pid 0, which doesn't exist, and thus incorrectly determines the client is not a snap. This led to a race condition where the client could bypass confinement if it sent the `PA_COMMAND_AUTH` request before the server called `setsockopt()`.

**Weaknesses/Vulnerabilities Present:**

- **Incorrect privilege reduction:** The vulnerability allowed a snap-confined client to be incorrectly identified as not confined, leading to it gaining elevated privileges (module loading/unloading). The original intent of the snap policy module was to reduce privileges based on whether a client was a snap or not.
- **Race Condition:** The reliance on `SCM_CREDENTIALS` and the timing of setting socket options created a race condition where the client could send the `PA_COMMAND_AUTH` request before the server set the `SO_PASSCRED` option.

**Impact of Exploitation:**

- **Information Disclosure:** An attacker could exploit this vulnerability to expose sensitive information by bypassing the intended security restrictions applied to snap-confined applications, by loading arbitrary modules into the pulseaudio server.

**Attack Vectors:**

- Local attack: An attacker would need to be running a snap application that connects to the PulseAudio server. The vulnerable code resides in the PulseAudio server.

**Required Attacker Capabilities/Position:**

- The attacker needs to be able to run a snap application on the target system.
- The attacker needs to be able to connect to the PulseAudio server.
- The attacker needs to be able to make use of the race condition to bypass confinement.

**Additional Technical Details:**

- The fix involves using `aa_getpeercon()` to retrieve the peer's AppArmor label at connection time. This label is stored in the `pa_client` struct and used by the policy module for confinement checks. This eliminates the race condition and the reliance on potentially missing `SCM_CREDENTIALS`.
- The fix also addresses a related bug (#1886854) where classic snaps were being blocked from module loading/unloading by making sure that the classic snaps can still load modules.
- The vulnerability is specific to Ubuntu due to the way that it uses SCM\_CREDENTIALS to detect snap confined clients.
- The provided test snap ("pa-race") demonstrates the issue by attempting to load/unload a module, which should normally be denied for confined snaps. The fix ensures the test consistently returns "access denied."
- The vulnerability impacts Ubuntu 20.10, 20.04 LTS, 18.04 ESM, and 16.04 ESM, and corresponding patches were released for each version.