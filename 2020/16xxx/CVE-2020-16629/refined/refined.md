```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability lies in the lack of proper sanitization of the `mime_type` value extracted from the `$_FILES` array during file uploads. This value is directly inserted into a SQL query without any filtering or validation.",
    "weaknesses": [
      "SQL Injection",
      "Unvalidated input",
       "Inadequate file upload handling"
    ],
    "impact": "An attacker can execute arbitrary SQL queries by injecting malicious code into the `mime_type` field during file uploads. This allows them to manipulate database records to facilitate further attacks, such as writing arbitrary PHP files to the server leading to remote code execution (RCE).",
    "attack_vectors": "The attack is initiated through a crafted file upload request to the `/api.php?c=upload&f=save` endpoint. The attacker manipulates the `Content-Type` header within the multipart form data to inject SQL code. This injected code can then be used to insert a malicious record into the database.",
     "required_capabilities": "The attacker needs the ability to submit file upload requests to the affected server, which is possible through the `/index.php?c=usercp&f=avatar` interface. They need to intercept the request and modify the Content-Type field and file content to inject SQL and control file extension. They also need knowledge of the vulnerable file replacement functionality, which is used to upload malicious php code using manipulated metadata within the database."
  }
}
```