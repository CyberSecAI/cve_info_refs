Based on the provided content, here's an analysis of CVE-2020-1940:

**Root Cause of Vulnerability:**
The vulnerability stems from how Apache Jackrabbit Oak handles initial password changes and password expiration. When a user changes their password, the new password is included as an attribute within the credentials object. However, this attribute is not removed after processing during the initial authentication phase.

**Weaknesses/Vulnerabilities Present:**
The primary weakness is a sensitive information disclosure vulnerability. The new password remains accessible within the credentials object beyond the initial processing stage.

**Impact of Exploitation:**
The impact is the potential disclosure of a user's new password. This disclosure occurs when the vulnerable authentication mechanism is used in combination with an independent mechanism. An attacker could gain access to a user's new password.

**Attack Vectors:**
The attack vector involves an attacker leveraging a secondary authentication mechanism that can access the credentials object after initial processing, thus exposing the new password attribute.

**Required Attacker Capabilities/Position:**
An attacker needs the ability to interact with the system using an independent authentication mechanism that has access to the credential object that contains the new password after the initial authentication phase, and know that the user is in the process of changing their password.

**Additional Notes**

*   The vulnerability exists in Apache Jackrabbit Oak versions 1.2.0 to 1.22.0.
*   The fix involves upgrading to version 1.24.0 or applying the appropriate patch for older maintained branches (1.2.x, 1.4.x, 1.6.x, 1.8.x and 1.10.x)
*   Patches are provided in the email for older affected branches.