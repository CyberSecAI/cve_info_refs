```
{
  "cveId": "CVE-2020-1740",
  "description": "A flaw was found in Ansible Engine when using Ansible Vault for editing encrypted files. When a user executes \"ansible-vault edit\", another user on the same computer can read the old and new secret, as it is created in a temporary file with mkstemp and the returned file descriptor is closed and the method write_data is called to write the existing secret in the file. This method will delete the file before recreating it insecurely.",
  "vulnerabilityDetails": {
    "rootCause": "The vulnerability exists due to a race condition in the `ansible-vault edit` command. When editing an encrypted file, Ansible creates a temporary file using `mkstemp`, closes the file descriptor, and then attempts to write data to the file using the `write_data` method. This method deletes the file and recreates it insecurely.",
    "weaknesses": [
      "Insecure temporary file creation and handling",
      "Race condition vulnerability"
    ],
    "impact": "A local attacker on the same system can potentially read the old and new secret being edited, leading to unauthorized disclosure of sensitive information.",
    "attackVectors": [
      "Local access to the system is required.",
       "The attacker must be able to observe or access the temporary file created during the ansible-vault edit process."
    ],
    "attackerCapabilities": [
      "Must have local access to the system where ansible-vault edit is being run.",
      "Must be a user on the same system, different from the user invoking ansible-vault edit"
    ]
  }
}
```