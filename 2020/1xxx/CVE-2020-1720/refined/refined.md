Based on the provided content, here's an analysis of CVE-2020-1720:

**Summary:**

The vulnerability lies in the `ALTER ... DEPENDS ON EXTENSION` command within PostgreSQL. This command lacked proper authorization checks, which could allow an attacker with some privileges to bypass security restrictions and potentially corrupt the database.

**Root Cause of Vulnerability:**

The root cause was the missing permission checks within the `ALTER ... DEPENDS ON EXTENSION` command. Specifically, the sub-commands of this SQL command did not verify if the user invoking it had the required privileges to modify the dependencies of an object on a given extension.

**Weaknesses/Vulnerabilities Present:**

*   **Missing Authorization Checks:** The primary weakness was the absence of authorization checks within the `ALTER ... DEPENDS ON EXTENSION` sub-commands. This allowed a user, who might have limited privileges, to mark database objects (like functions, triggers, etc.) as dependent on an extension.
*   **Incorrect Privilege Handling:** The system failed to properly handle and verify ownership or the privileges of the user requesting the change in object dependency.

**Impact of Exploitation:**

*   **Privilege Escalation:** A user with limited privileges could use this vulnerability to mark certain objects as dependent on an extension, potentially allowing them to drop such objects under specific circumstances.
*   **Arbitrary Object Dropping:** An attacker could abuse this flaw to drop database objects (functions, triggers, materialized views, or indexes) that they would not normally have permissions to drop.
*   **Database Corruption:** The ability to drop database objects could lead to data corruption or inconsistent database states, disrupting the normal operation of applications that use the database.

**Attack Vectors:**

*   **SQL Injection/Abuse:** The attack vector is via crafted SQL queries using the `ALTER ... DEPENDS ON EXTENSION` command. An attacker with the ability to execute SQL queries could exploit this flaw.
*   **Extension Manipulation:** The vulnerability becomes exploitable if an attacker can create extensions, or if an extension owner can be tricked into dropping a specific extension that the attacker made objects dependent on.

**Required Attacker Capabilities/Position:**

*   **Database User Account:** The attacker requires a valid user account on the PostgreSQL database server.
*   **Execute Permissions:** An attacker needs the ability to execute SQL queries or the privileges to interact with objects in a specific way in the database.
*   **Some Extension Access:** An attacker needs the ability to either create their own extension or exploit a situation where an administrator has installed an extension, or an extension owner can be convinced to drop their extension to make the flaw fully exploitable.
*   **No Superuser Privilege Required:** The vulnerability is specifically problematic because it does *not* require superuser privileges, enabling an unprivileged user to carry out the attack.

**Additional Notes:**

*   The fix involves adding the necessary privilege checks to the `ALTER ... DEPENDS ON EXTENSION` command, ensuring that the user executing the command owns the object being modified and thus has the required permission.

*   The vulnerability was present in PostgreSQL versions 9.6 through 12 prior to the release of 12.2, 11.7, 10.12 and 9.6.17 and was backported to older versions where relevant.

*   This vulnerability is distinct from CVE-2018-10915 and CVE-2019-10208, though those vulnerabilities were also related to privilege escalation and missing checks in the PostgreSQL environment.