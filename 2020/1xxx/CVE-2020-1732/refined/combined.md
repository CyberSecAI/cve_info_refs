=== Content from bugzilla.redhat.com_b01e54a4_20250119_123151.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3DCVE-2020-1732)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3DCVE-2020-1732)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3DCVE-2020-1732)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1801726

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1801726**](show_bug.cgi?id=1801726)
(CVE-2020-1732)
- [CVE-2020-1732](https://access.redhat.com/security/cve/CVE-2020-1732) Soteria: security identity corruption across concurrent threads

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2020-1732 Soteria: security identity corruption across concurrent threads

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2020-1732 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1798612](show_bug.cgi?id=1798612) | | TreeView+ | [depends on](buglist.cgi?bug_id=1801726&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1801726&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2020-02-11 14:33 UTC by Guilherme de Almeida Suckevicz | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-03-04 13:36 UTC ([History](show_activity.cgi?id=1801726)) | | [CC List:](page.cgi?id=fields.html#cclist) | 79 users (show)  aboyko aileenc akoufoud alazarot almorale anstephe asoldano atangrin avibelli bbaranow bgeorges bmaxwell brian.stansberry cdewolf chazlett darran.lofthouse dingyichen dkreling dosoudil drieden etirelli extras-orphan fnasser ggaughan gvarsami ibek iweiss janstey jason.greene jawilson jbalunas jboss-set jcoleman jochrist jolee jpallich jperkins jschatte jstastny jwon kconner krathod kverlaen kwills ldimaggi lef lgao loleary lthon mnovotny msochure msvehla mszynkie nwallace paradhya pdrozd pgallagh pjindal pmackay psampaio psotirop puntogil rfreire rguimara rrajasek rruss rsvoboda rsynek rwagner sdaley security-response-team smaestri spinder sthorger tcunning theute tkirby tom.jenkinson vhalbert | | Fixed In Version: | soteria 1.0.1 | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A flaw was found in WildFly where multiple requests occurring concurrently could be handled using the identity of another request. This vulnerability occurs when using EE Security with WildFly Elytron. The largest threat from this vulnerability is data confidentiality and integrity. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2020-05-12 10:32:45 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2020:2058](https://access.redhat.com/errata/RHSA-2020%3A2058) | 0 | None | None | None | 2020-05-11 20:10:54 UTC | | Red Hat Product Errata | [RHSA-2020:2059](https://access.redhat.com/errata/RHSA-2020%3A2059) | 0 | None | None | None | 2020-05-11 20:13:57 UTC | | Red Hat Product Errata | [RHSA-2020:2060](https://access.redhat.com/errata/RHSA-2020%3A2060) | 0 | None | None | None | 2020-05-11 20:16:55 UTC | | Red Hat Product Errata | [RHSA-2020:2061](https://access.redhat.com/errata/RHSA-2020%3A2061) | 0 | None | None | None | 2020-05-11 20:20:05 UTC | | Red Hat Product Errata | [RHSA-2020:2333](https://access.redhat.com/errata/RHSA-2020%3A2333) | 0 | None | None | None | 2020-05-28 16:00:02 UTC | | Red Hat Product Errata | [RHSA-2020:2905](https://access.redhat.com/errata/RHSA-2020%3A2905) | 0 | None | None | None | 2020-07-23 07:04:39 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1801726#c0)  Guilherme de Almeida Suckevicz    2020-02-11 14:33:30 UTC  ``` A flaw was found in Soteria before 1.0.1 in a way that multiple requests occurring concurrently there is the possibility of being handled using the identity from another request.  Upstream fix:  <https://github.com/wildfly-security/soteria/commit/c2479f8c39d7d661341fdcaff7f5e97c5eea1a54>   ```  [Comment 15](show_bug.cgi?id=1801726#c15)  Jonathan Christison    2020-03-11 13:58:24 UTC  ``` This vulnerability is out of security support scope for the following product:  * SOA Platform 5  Please refer to <https://access.redhat.com/support/policy/updates/jboss_notes> for more details.   ```  [Comment 16](show_bug.cgi?id=1801726#c16)  errata-xmlrpc    2020-05-11 20:10:51 UTC  ``` This issue has been addressed in the following products:    Red Hat JBoss Enterprise Application Platform 7.2 for RHEL 6  Via RHSA-2020:2058 [https://access.redhat.com/errata/RHSA-2020:2058](https://access.redhat.com/errata/RHSA-2020%3A2058)   ```  [Comment 17](show_bug.cgi?id=1801726#c17)  errata-xmlrpc    2020-05-11 20:13:54 UTC  ``` This issue has been addressed in the following products:    Red Hat JBoss Enterprise Application Platform 7.2 for RHEL 7  Via RHSA-2020:2059 [https://access.redhat.com/errata/RHSA-2020:2059](https://access.redhat.com/errata/RHSA-2020%3A2059)   ```  [Comment 18](show_bug.cgi?id=1801726#c18)  errata-xmlrpc    2020-05-11 20:16:51 UTC  ``` This issue has been addressed in the following products:    Red Hat JBoss Enterprise Application Platform 7.2 for RHEL 8  Via RHSA-2020:2060 [https://access.redhat.com/errata/RHSA-2020:2060](https://access.redhat.com/errata/RHSA-2020%3A2060)   ```  [Comment 19](show_bug.cgi?id=1801726#c19)  errata-xmlrpc    2020-05-11 20:20:01 UTC  ``` This issue has been addressed in the following products:    Red Hat JBoss Enterprise Application Platform  Via RHSA-2020:2061 [https://access.redhat.com/errata/RHSA-2020:2061](https://access.redhat.com/errata/RHSA-2020%3A2061)   ```  [Comment 20](show_bug.cgi?id=1801726#c20)  Product Security DevOps Team    2020-05-12 10:32:45 UTC  ``` This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):  <https://access.redhat.com/security/cve/cve-2020-1732>   ```  [Comment 21](show_bug.cgi?id=1801726#c21)  errata-xmlrpc    2020-05-28 15:59:58 UTC  ``` This issue has been addressed in the following products:    EAP-CD 19 Tech Preview  Via RHSA-2020:2333 [https://access.redhat.com/errata/RHSA-2020:2333](https://access.redhat.com/errata/RHSA-2020%3A2333)   ```  [Comment 22](show_bug.cgi?id=1801726#c22)  errata-xmlrpc    2020-07-23 07:04:35 UTC  ``` This issue has been addressed in the following products:    Red Hat Openshift Application Runtimes  Via RHSA-2020:2905 [https://access.redhat.com/errata/RHSA-2020:2905](https://access.redhat.com/errata/RHSA-2020%3A2905)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1801726&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from github.com_e06b9864_20250119_140914.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-4x5f-xw5j-gv58)

**CVE-2020-1732**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-4x5f-xw5j-gv58)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2020-1732](/advisories/GHSA-4x5f-xw5j-gv58)

## A flaw was found in Soteria before 1.0.1, in a way that...

Moderate severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
•
Updated Jan 29, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-4x5f-xw5j-gv58/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

A flaw was found in Soteria before 1.0.1, in a way that multiple requests occurring concurrently causing security identity corruption across concurrent threads when using EE Security with WildFly Elytron which can lead to the possibility of being handled using the identity from another request.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-1732>
* [wildfly-security/soteria@c2479f8](https://github.com/wildfly-security/soteria/commit/c2479f8c39d7d661341fdcaff7f5e97c5eea1a54)
* <https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-1732>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-1732)
May 4, 2020

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Jan 29, 2023

### Severity

Moderate

### [EPSS score](https://www.first.org/epss/user-guide)

0.050%
 (22nd percentile)

### Weaknesses

No CWEs

### CVE ID

CVE-2020-1732

### GHSA ID

GHSA-4x5f-xw5j-gv58

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-4x5f-xw5j-gv58/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_31aada83_20250119_140914.html ===
�PNG

   
IHDR   (   (   ���m    pHYs  �  ��+  3IDATX�-�I�f�u��o��?�\�U���&���T��hQ M��˱iH��u�\*@�ȂY&�>A �]��#�� "���L�I7��ꮪ���������������9/p����W��xO�y ��s�VT�:��9V:�l]gz9���KV������w�g��-�q���g<�9���v�K~��%��L�n�����u�amc����?� ��?���V1H^�}��k�\_l����d�f�z��7?����N�8<2���%��3G����kVM��߼�7���k��ŵ�7�M���邸
)��\[}e-�����+��SV6[���].X[��~����=�t���~@9W��2[�qr2FG��\_�3��|�)�wo��,�x�vh���
�sm~����\�ǄR���8n3�sz~IZz�\Y]��W\_�O���8Ģ�˜����?��n�����BՊ����}t7��|�w���/
�T">������eim�H�;��%?����4u�ss���c�,CxG`4&
��|6�"',����egg���~�\_~� �KNdN�d�Z �vγ�.�l���Z���O��%.��G����ѡZ�x��t���o�������R�ֈ���� '���\*�y�.漶sme�$Y�XC��Pt�R)�\_���g���S�9�ô%�a�$H��y�����Ф���g:������]~���o���ȴڬu>䫣}��&�ɲ��nB��eF}�x��p����b�֒[�ϲ1����)i��R�^��&�
������'$y#9O+�Lh���W.��f����+�w�z��z���?!�9�k!a�γ�cfg]�Ő�F���;��g�C"2�
��@��ȕ%VE5(�d9y-�چ�ڕ
�Т|���@y�(��H�����YY�j���+5�غ��^��)�?S4�$�'O�y#Z��eʬ�H��[�【� �q���JPAb%�H�hR2�Y6wK�5�3��\*E�b�g�2����i��LN����?C����9�����\_�f��lίp��oҔ���k��!{{}�����WW�\^AK���R�K��B���n�(� `w%ƹ��A��KM���zD"�L˽��IZ�W��ll.3+5���m���8�����y�)�;"k.�T����J�ւ�/�rVF����&���$H0�!+�
sƅ"[�V�����E�Pe��̈W��rFn+�D3��a�M���XZ��`��ל{����LrɈyՐ\_4�tA{O��5
VJ��ź�m��|��p@����X{%c�f��f�`��6F�#��Ǵ����'l��F1��E�C�Ғ<8<�'\_�����x �E��w�i. �e8�x|t�±���N��d�b���9�١����+�K&��x��lQ���4%�ѥWM,�l-','%�iA:Ɉ"�0��R������k�xu�O���A����֬�oӎ&h�������nm�rpxμ.���y]�
vEa4���Z.ܽw��� oݼ��߸����)���NZ"�N擆 �[��,JY��h�Ϋ�/[�q�m�i�!�������t�Y�t0���5�DSx�o�Z"�\_����
O��1q@��X���������3�����׶.'#]�/��n/��bA����%Jxb%��)���]N��l��sl�L(G�������⢄Ֆ�r/�z�|�[�|\�J$��L�gt7�����,`$���ߋ�1���D�?;ck��r�������ޥ��� �M �#bw� �\*Q���3z���G4e�Q����W��?�Q:���m�\*�ŒR:�E��7��k<�w֘�� ��#r��9�e5���|����ɤ�Ge��d�<��&s���G�iG�ټ&�\*��\��\*g)6�b�x�6(z���DK�� ��\_��{��
���5�[9�˞�m��D ���z��� ��n�����m�\*5�L@ 0V �D�Ȇ�Zx�����Ǉ\L
�J#�g���V����=F
\��%��ɏ��P�G��
D9$����<��i��{��|�����{�%ƃ!�<�g\_�o�p�wNO�$�b�)�^+D
�yg�#+���\e�4T储t\K�ځs4��n��ol����&R5�qZ������O�g5U��R�����ȥ��]���]~��q{�M.�p2� �5��M�$R��IP7߾�Q��L��fD�Pk��/&��u�i��j\*�Y�h֗$�)2���a�ҟV]�����q��GKQԬn���zh���2��N�ÿ�#.�}�ɀ��9�V� �D���W>j�$Y'�[�P)�\{]j���|A�=οx�w:1k���՘ 48�=L҆������9i�B7A���rH �-�N����Z��t���7�ó�xS��
C!
dH�L�Xjj9�Kˇ��/�ٿ�>@J����ip��҆�$ �e�)\*�s�`R0�.��9i��B���l<'�|��Ji�w�x�g��%����{�'��-��8@w�7���?!+���:���w��o�!�E���
qSV�����#Eh5J�x�aZ8ںf�5H����x>�i�H%A(�{�d��Xቢ�Ãc���o�ÿ�w���h����ft����lJ���~8�?t�6��u���&��!��g�DQ��PV5/�t����u�:a�`BEYe�+(k���f�H���ƣ��j �5�v��l���%y^PU���m�w4ĵ#\��,U3Gn�Md�M�Y6LF��p��1w�+�<����1ZqQ:~�䜣yM�4��糆G'�Z�HA�<B R�n� ��X��� �q���%Ar���hЄV��n��tvI\.X�1���>^��xy�;<{v����{���/>�{O���(%1��gT�����ENh
u�L3f����A��e���b2�s�o���
���W��Š?����-��"�\*@;��e���U�w^��O�rs5��W{d����6���(��V��BiM�<�5x��j(���X#\_�W(�TFH�p�����$ �L&ah��=�T�奥-�cN�r����)��Cʬ��p��O+��.�x�[oD���b�E�0�PZ&Q��G�9ʂ
��\*�I� ,RjP��tFQ�4M
�aQz5uݰHs�����"E�.�k%��fiE�s�������e��!/]�d���D��Ja�!C�P4M�V)5�v� ��-L$ a� �FZ�
#�֔U���{O�XEM�S6섬l1M���OOY �����8��h�Ŭ���&�,'�rV�V��3�NB�x�� @J���\*
m�N�eY,j�$BH���1���K����րw�^mJ)�V����nM�le!��ڡ\�Hӌ���i����!��.^�WWQAD��b��-�Z�/M{i����Z�n� m� ��R�5a`p��$�!�=I���!m�&�jg i]��W�y��ģ����PZ3��e����k�(!��hmJ#�Bj� ��q�Ł؀ Pڢ�e,J������!
����(&��J�N�pđGK���FII�RՒ&ː=�#�����J.�N�qc�8iF���o�jw��Bil��#�ր� %�5)QZ�� �=��Da�P�5Qh1F#��I]{B+ph�{���ŬD5�\D���� 'G���s�t�6�u���N�tz]�(�� MӀ�c���8�seB�kJ� ���jEQD���k��M�CM�F#��w������]�    IEND�B`�

=== Content from github.com_b544c674_20250119_123152.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwildfly-security%2Fsoteria%2Fcommit%2Fc2479f8c39d7d661341fdcaff7f5e97c5eea1a54)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwildfly-security%2Fsoteria%2Fcommit%2Fc2479f8c39d7d661341fdcaff7f5e97c5eea1a54)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=wildfly-security%2Fsoteria)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wildfly-security](/wildfly-security)
/
**[soteria](/wildfly-security/soteria)**
Public

forked from [eclipse-ee4j/soteria](/eclipse-ee4j/soteria)

* [Notifications](/login?return_to=%2Fwildfly-security%2Fsoteria) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fwildfly-security%2Fsoteria)
* [Star
   0](/login?return_to=%2Fwildfly-security%2Fsoteria)

* [Code](/wildfly-security/soteria)
* [Pull requests
  0](/wildfly-security/soteria/pulls)
* [Actions](/wildfly-security/soteria/actions)
* [Projects
  0](/wildfly-security/soteria/projects)
* [Security](/wildfly-security/soteria/security)
* [Insights](/wildfly-security/soteria/pulse)

Additional navigation options

* [Code](/wildfly-security/soteria)
* [Pull requests](/wildfly-security/soteria/pulls)
* [Actions](/wildfly-security/soteria/actions)
* [Projects](/wildfly-security/soteria/projects)
* [Security](/wildfly-security/soteria/security)
* [Insights](/wildfly-security/soteria/pulse)

## Commit

[Permalink](/wildfly-security/soteria/commit/c2479f8c39d7d661341fdcaff7f5e97c5eea1a54)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#1](https://github.com/wildfly-security/soteria/pull/1) from darranl/[CVE-2020-1732](https://github.com/advisories/GHSA-4x5f-xw5j-gv58 "CVE-2020-1732")

[Browse files](/wildfly-security/soteria/tree/c2479f8c39d7d661341fdcaff7f5e97c5eea1a54)
Browse the repository at this point in the history

```
[[CVE-2020-1732](https://github.com/advisories/GHSA-4x5f-xw5j-gv58 "CVE-2020-1732")] Adjust JASPIC integration to create a new ServerAuthModule for each request.
```

* Loading branch information

[![@fjuma](https://avatars.githubusercontent.com/u/1486286?s=40&v=4)](/fjuma)

[fjuma](/wildfly-security/soteria/commits?author=fjuma "View all commits by fjuma")
authored
Feb 14, 2020

2 parents
[f637fa0](/wildfly-security/soteria/commit/f637fa0dc325d298a99d95ac13c469cfd46ed63a)
+
[1a6234e](/wildfly-security/soteria/commit/1a6234e394a34612f4a73e84857af06ff2d412d7)

commit c2479f8

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**75 additions**
and
**69 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* impl/src/main/java/org/glassfish/soteria

  + mechanisms/jaspic

    - impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/DefaultAuthConfigProvider.java
      [DefaultAuthConfigProvider.java](#diff-05aa95c323085713f1469987f3e39688b900610ad747c22663132a1d2aff3eea)
    - impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/DefaultServerAuthConfig.java
      [DefaultServerAuthConfig.java](#diff-086887c0cf6a6ff34767a34f74e646da5bf610c8b593e63b3e5a9ffde437ccd6)
    - impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/DefaultServerAuthContext.java
      [DefaultServerAuthContext.java](#diff-5450a0d5f552fd0843a5db38604c72e7ba0ba0db98a4d1998048b2776f1e9da6)
    - impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/Jaspic.java
      [Jaspic.java](#diff-80eea7cde7928f054091a4f442f85f42afdcc6761ac7787e73502619ce4c9428)
  + servlet

    - impl/src/main/java/org/glassfish/soteria/servlet/SamRegistrationInstaller.java
      [SamRegistrationInstaller.java](#diff-a5a0cd435d9c0f3917dcc11f981843f228bd20463ef1e32ca9a45ca18767eb05)

## There are no files selected for viewing

15 changes: 8 additions & 7 deletions

15
[impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/DefaultAuthConfigProvider.java](#diff-05aa95c323085713f1469987f3e39688b900610ad747c22663132a1d2aff3eea "impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/DefaultAuthConfigProvider.java")

Show comments

[View file](/wildfly-security/soteria/blob/c2479f8c39d7d661341fdcaff7f5e97c5eea1a54/impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/DefaultAuthConfigProvider.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,6 +17,7 @@ |
|  |  | package org.glassfish.soteria.mechanisms.jaspic; |
|  |  |  |
|  |  | import java.util.Map; |
|  |  | import java.util.function.Supplier; |
|  |  |  |
|  |  | import javax.security.auth.callback.CallbackHandler; |
|  |  | import javax.security.auth.message.AuthException; |
| Expand All | | @@ -30,23 +31,23 @@ |
|  |  | /\*\* |
|  |  | \* This class functions as a kind of factory-factory for {@link ServerAuthConfig} instances, which are by themselves factories |
|  |  | \* for {@link ServerAuthContext} instances, which are delegates for the actual {@link ServerAuthModule} (SAM) that we're after. |
|  |  | \* |
|  |  | \* |
|  |  | \* @author Arjan Tijms |
|  |  | \*/ |
|  |  | public class DefaultAuthConfigProvider implements AuthConfigProvider { |
|  |  |  |
|  |  | private static final String CALLBACK\_HANDLER\_PROPERTY\_NAME = "authconfigprovider.client.callbackhandler"; |
|  |  |  |
|  |  | private Map<String, String> providerProperties; |
|  |  | private ServerAuthModule serverAuthModule; |
|  |  | private Supplier<ServerAuthModule> serverAuthModuleSupplier; |
|  |  |  |
|  |  | public DefaultAuthConfigProvider(ServerAuthModule serverAuthModule) { |
|  |  | this.serverAuthModule = serverAuthModule; |
|  |  | public DefaultAuthConfigProvider(Supplier<ServerAuthModule> serverAuthModuleSupplier) { |
|  |  | this.serverAuthModuleSupplier = serverAuthModuleSupplier; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Constructor with signature and implementation that's required by API. |
|  |  | \* |
|  |  | \* |
|  |  | \* @param properties provider properties |
|  |  | \* @param factory the auth config factory |
|  |  | \*/ |
| Expand All | | @@ -72,7 +73,7 @@ public DefaultAuthConfigProvider(Map<String, String> properties, AuthConfigFacto |
|  |  | public ServerAuthConfig getServerAuthConfig(String layer, String appContext, CallbackHandler handler) throws AuthException, |
|  |  | SecurityException { |
|  |  | return new DefaultServerAuthConfig(layer, appContext, handler == null ? createDefaultCallbackHandler() : handler, |
|  |  | providerProperties, serverAuthModule); |
|  |  | providerProperties, serverAuthModuleSupplier); |
|  |  | } |
|  |  |  |
|  |  | @Override |
| Expand All | | @@ -89,7 +90,7 @@ public void refresh() { |
|  |  | \* Creates a default callback handler via the system property "authconfigprovider.client.callbackhandler", as seemingly |
|  |  | \* required by the API (API uses wording "may" create default handler). TODO: Isn't |
|  |  | \* "authconfigprovider.client.callbackhandler" JBoss specific? |
|  |  | \* |
|  |  | \* |
|  |  | \* @return |
|  |  | \* @throws AuthException |
|  |  | \*/ |
| Expand Down | |  |

11 changes: 6 additions & 5 deletions

11
[impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/DefaultServerAuthConfig.java](#diff-086887c0cf6a6ff34767a34f74e646da5bf610c8b593e63b3e5a9ffde437ccd6 "impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/DefaultServerAuthConfig.java")

Show comments

[View file](/wildfly-security/soteria/blob/c2479f8c39d7d661341fdcaff7f5e97c5eea1a54/impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/DefaultServerAuthConfig.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,6 +17,7 @@ |
|  |  | package org.glassfish.soteria.mechanisms.jaspic; |
|  |  |  |
|  |  | import java.util.Map; |
|  |  | import java.util.function.Supplier; |
|  |  |  |
|  |  | import javax.security.auth.Subject; |
|  |  | import javax.security.auth.callback.CallbackHandler; |
| Expand All | | @@ -29,7 +30,7 @@ |
|  |  | /\*\* |
|  |  | \* This class functions as a kind of factory for {@link ServerAuthContext} instances, which are delegates for the actual |
|  |  | \* {@link ServerAuthModule} (SAM) that we're after. |
|  |  | \* |
|  |  | \* |
|  |  | \* @author Arjan Tijms |
|  |  | \*/ |
|  |  | public class DefaultServerAuthConfig implements ServerAuthConfig { |
| Expand All | | @@ -38,21 +39,21 @@ public class DefaultServerAuthConfig implements ServerAuthConfig { |
|  |  | private String appContext; |
|  |  | private CallbackHandler handler; |
|  |  | private Map<String, String> providerProperties; |
|  |  | private ServerAuthModule serverAuthModule; |
|  |  | private Supplier<ServerAuthModule> serverAuthModuleSupplier; |
|  |  |  |
|  |  | public DefaultServerAuthConfig(String layer, String appContext, CallbackHandler handler, |
|  |  | Map<String, String> providerProperties, ServerAuthModule serverAuthModule) { |
|  |  | Map<String, String> providerProperties, Supplier<ServerAuthModule> serverAuthModuleSupplier) { |
|  |  | this.layer = layer; |
|  |  | this.appContext = appContext; |
|  |  | this.handler = handler; |
|  |  | this.providerProperties = providerProperties; |
|  |  | this.serverAuthModule = serverAuthModule; |
|  |  | this.serverAuthModuleSupplier = serverAuthModuleSupplier; |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public ServerAuthContext getAuthContext(String authContextID, Subject serviceSubject, |
|  |  | @SuppressWarnings("rawtypes") Map properties) throws AuthException { |
|  |  | return new DefaultServerAuthContext(handler, serverAuthModule); |
|  |  | return new DefaultServerAuthContext(handler, serverAuthModuleSupplier); |
|  |  | } |
|  |  |  |
|  |  | // ### The methods below mostly just return what has been passed into the |
| Expand Down | |  |

7 changes: 4 additions & 3 deletions

7
[impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/DefaultServerAuthContext.java](#diff-5450a0d5f552fd0843a5db38604c72e7ba0ba0db98a4d1998048b2776f1e9da6 "impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/DefaultServerAuthContext.java")

Show comments

[View file](/wildfly-security/soteria/blob/c2479f8c39d7d661341fdcaff7f5e97c5eea1a54/impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/DefaultServerAuthContext.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,6 +17,7 @@ |
|  |  | package org.glassfish.soteria.mechanisms.jaspic; |
|  |  |  |
|  |  | import java.util.Collections; |
|  |  | import java.util.function.Supplier; |
|  |  |  |
|  |  | import javax.security.auth.Subject; |
|  |  | import javax.security.auth.callback.CallbackHandler; |
| Expand All | | @@ -34,15 +35,15 @@ |
|  |  | \* <p> |
|  |  | \* Since this simple example only has a single SAM, we delegate directly to that one. Note that this {@link ServerAuthContext} |
|  |  | \* and the {@link ServerAuthModule} (SAM) share a common base interface: {@link ServerAuth}. |
|  |  | \* |
|  |  | \* |
|  |  | \* @author Arjan Tijms |
|  |  | \*/ |
|  |  | public class DefaultServerAuthContext implements ServerAuthContext { |
|  |  |  |
|  |  | private final ServerAuthModule serverAuthModule; |
|  |  |  |
|  |  | public DefaultServerAuthContext(CallbackHandler handler, ServerAuthModule serverAuthModule) throws AuthException { |
|  |  | this.serverAuthModule = serverAuthModule; |
|  |  | public DefaultServerAuthContext(CallbackHandler handler, Supplier<ServerAuthModule> serverAuthModuleSupplier) throws AuthException { |
|  |  | this.serverAuthModule = serverAuthModuleSupplier.get(); |
|  |  | serverAuthModule.initialize(null, null, handler, Collections.<String, String> emptyMap()); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

73 changes: 38 additions & 35 deletions

73
[impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/Jaspic.java](#diff-80eea7cde7928f054091a4f442f85f42afdcc6761ac7787e73502619ce4c9428 "impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/Jaspic.java")

Show comments

[View file](/wildfly-security/soteria/blob/c2479f8c39d7d661341fdcaff7f5e97c5eea1a54/impl/src/main/java/org/glassfish/soteria/mechanisms/jaspic/Jaspic.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,6 +25,7 @@ |
|  |  | import java.security.PrivilegedAction; |
|  |  | import java.util.List; |
|  |  | import java.util.Set; |
|  |  | import java.util.function.Supplier; |
|  |  |  |
|  |  | import javax.security.enterprise.AuthenticationStatus; |
|  |  | import javax.security.auth.Subject; |
| Expand All | | @@ -43,42 +44,44 @@ |
|  |  | import javax.servlet.http.HttpServletRequest; |
|  |  | import javax.servlet.http.HttpServletResponse; |
|  |  |  |
|  |  | import org.glassfish.soteria.cdi.spi.CDIPerRequestInitializer; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* A set of utility methods for using the JASPIC API |
|  |  | \* |
|  |  | \* |
|  |  | \* @author Arjan Tijms |
|  |  | \* |
|  |  | \*/ |
|  |  | public final class Jaspic { |
|  |  |  |
|  |  |  |
|  |  | public static final String IS\_AUTHENTICATION = "org.glassfish.soteria.security.message.request.authentication"; |
|  |  | public static final String IS\_AUTHENTICATION\_FROM\_FILTER = "org.glassfish.soteria.security.message.request.authenticationFromFilter"; |
|  |  | public static final String IS\_SECURE\_RESPONSE = "org.glassfish.soteria.security.message.request.secureResponse"; |
|  |  | public static final String IS\_REFRESH = "org.glassfish.soteria.security.message.request.isRefresh"; |
|  |  | public static final String DID\_AUTHENTICATION = "org.glassfish.soteria.security.message.request.didAuthentication"; |
|  |  |  |
|  |  |  |
|  |  | public static final String AUTH\_PARAMS = "org.glassfish.soteria.security.message.request.authParams"; |
|  |  |  |
|  |  |  |
|  |  | public static final String LOGGEDIN\_USERNAME = "org.glassfish.soteria.security.message.loggedin.username"; |
|  |  | public static final String LOGGEDIN\_ROLES = "org.glassfish.soteria.security.message.loggedin.roles"; |
|  |  | public static final String LAST\_AUTH\_STATUS = "org.glassfish.soteria.security.message.authStatus"; |
|  |  |  |
|  |  |  |
|  |  | public static final String CONTEXT\_REGISTRATION\_ID = "org.glassfish.soteria.security.message.registrationId"; |
|  |  |  |
|  |  |  |
|  |  | // Key in the MessageInfo Map that when present AND set to true indicated a protected resource is being accessed. |
|  |  | // When the resource is not protected, GlassFish omits the key altogether. WebSphere does insert the key and sets |
|  |  | // it to false. |
|  |  | private static final String IS\_MANDATORY = "javax.security.auth.message.MessagePolicy.isMandatory"; |
|  |  | private static final String REGISTER\_SESSION = "javax.servlet.http.registerSession"; |
|  |  |  |
|  |  | private Jaspic() {} |
|  |  |  |
|  |  |  |
|  |  | public static boolean authenticate(HttpServletRequest request, HttpServletResponse response, AuthenticationParameters authParameters) { |
|  |  | try { |
|  |  | // JASPIC 1.1 does not have any way to distinguish between a |
|  |  | // SAM called at start of a request or following request#authenticate. |
|  |  | // See https://java.net/jira/browse/JASPIC\_SPEC-5 |
|  |  |  |
|  |  |  |
|  |  | // We now add this as a request attribute instead, but should better |
|  |  | // be the MessageInfo map |
|  |  | request.setAttribute(IS\_AUTHENTICATION, true); |
| Expand All | | @@ -101,10 +104,10 @@ public static AuthenticationParameters getAuthParameters(HttpServletRequest requ |
|  |  | if (authParameters == null) { |
|  |  | authParameters = new AuthenticationParameters(); |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | return authParameters; |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | public static void logout(HttpServletRequest request, HttpServletResponse response) { |
|  |  | try { |
|  |  | request.logout(); |
| Expand All | | @@ -131,21 +134,21 @@ public Void run() { |
|  |  | public static boolean isRegisterSession(MessageInfo messageInfo) { |
|  |  | return Boolean.valueOf((String)messageInfo.getMap().get(REGISTER\_SESSION)); |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | public static boolean isProtectedResource(MessageInfo messageInfo) { |
|  |  | return Boolean.valueOf((String) messageInfo.getMap().get(IS\_MANDATORY)); |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | @SuppressWarnings("unchecked") |
|  |  | public static void setRegisterSession(MessageInfo messageInfo, String username, Set<String> roles) { |
|  |  | messageInfo.getMap().put("javax.servlet.http.registerSession", TRUE.toString()); |
|  |  |  |
|  |  |  |
|  |  | HttpServletRequest request = (HttpServletRequest) messageInfo.getRequestMessage(); |
|  |  | request.setAttribute(LOGGEDIN\_USERNAME, username); |
|  |  | // TODO: check for existing roles and add |
|  |  | request.setAttribute(LOGGEDIN\_ROLES, roles); |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | public static boolean isAuthenticationRequest(HttpServletRequest request) { |
|  |  | return TRUE.equals(request.getAttribute(IS\_AUTHENTICATION)); |
|  |  | } |
| Expand Down  Expand Up | | @@ -202,70 +205,70 @@ public static AuthStatus fromAuthenticationStatus(AuthenticationStatus authentic |
|  |  | throw new IllegalStateException("Unhandled status:" + authenticationStatus.name()); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Should be called when the callback handler is used with the intention that an actual |
|  |  | \* user is going to be authenticated (as opposed to using the handler for the "do nothing" protocol |
|  |  | \* which uses the unauthenticated identity). |
|  |  | \* |
|  |  | \* |
|  |  | \* @param request The involved HTTP servlet request. |
|  |  | \* |
|  |  | \* |
|  |  | \*/ |
|  |  | public static void setDidAuthentication(HttpServletRequest request) { |
|  |  | request.setAttribute(DID\_AUTHENTICATION, TRUE); |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Gets the app context ID from the servlet context. |
|  |  | \* |
|  |  | \* |
|  |  | \* <p> |
|  |  | \* The app context ID is the ID that JASPIC associates with the given application. |
|  |  | \* In this case that given application is the web application corresponding to the |
|  |  | \* ServletContext. |
|  |  | \* |
|  |  | \* |
|  |  | \* @param context the servlet context for which to obtain the JASPIC app context ID |
|  |  | \* @return the app context ID for the web application corresponding to the given context |
|  |  | \*/ |
|  |  | public static String getAppContextID(ServletContext context) { |
|  |  | return context.getVirtualServerName() + " " + context.getContextPath(); |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Registers a server auth module as the one and only module for the application corresponding to |
|  |  | \* the given servlet context. |
|  |  | \* |
|  |  | \* |
|  |  | \* <p> |
|  |  | \* This will override any other modules that have already been registered, either via proprietary |
|  |  | \* means or using the standard API. |
|  |  | \* |
|  |  | \* @param serverAuthModule the server auth module to be registered |
|  |  | \* |
|  |  | \* @param cdiPerRequestInitializer A {@link CDIPerRequestInitializer} to pass to the {@link ServerAuthModule} |
|  |  | \* @param servletContext the context of the app for which the module is registered |
|  |  | \* @return A String identifier assigned by an underlying factory corresponding to an underlying factory-factory-factory registration |
|  |  | \*/ |
|  |  | public static String registerServerAuthModule(ServerAuthModule serverAuthModule, ServletContext servletContext) { |
|  |  |  |
|  |  | public static String registerServerAuthModule(CDIPerRequestInitializer cdiPerRequestInitializer, ServletContext servletContext) { |
|  |  |  |
|  |  | // Register the factory-factory-factory for the SAM |
|  |  | String registrationId = AccessController.doPrivileged(new PrivilegedAction<String>() { |
|  |  | public String run() { |
|  |  | return AuthConfigFactory.getFactory().registerConfigProvider( |
|  |  | new DefaultAuthConfigProvider(serverAuthModule), |
|  |  | "HttpServlet", |
|  |  | getAppContextID(servletContext), |
|  |  | new DefaultAuthConfigProvider(() -> new HttpBridgeServerAuthModule(cdiPerRequestInitializer)), |
|  |  | "HttpServlet", |
|  |  | getAppContextID(servletContext), |
|  |  | "Default single SAM authentication config provider"); |
|  |  | } |
|  |  | }); |
|  |  |  |
|  |  |  |
|  |  | // Remember the registration ID returned by the factory, so we can unregister the JASPIC module when the web module |
|  |  | // is undeployed. JASPIC being the low level API that it is won't do this automatically. |
|  |  | servletContext.setAttribute(CONTEXT\_REGISTRATION\_ID, registrationId); |
|  |  |  |
|  |  |  |
|  |  | return registrationId; |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Deregisters the server auth module (and encompassing wrappers/factories) that was previously registered via a call |
|  |  | \* to registerServerAuthModule. |
|  |  | \* |
|  |  | \* |
|  |  | \* @param servletContext the context of the app for which the module is deregistered |
|  |  | \*/ |
|  |  | public static void deregisterServerAuthModule(ServletContext servletContext) { |
| Expand All | | @@ -278,6 +281,6 @@ public Boolean run() { |
|  |  | }); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  | } |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c2479f8`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwildfly-security%2Fsoteria%2Fcommit%2Fc2479f8c39d7d661341fdcaff7f5e97c5eea1a54) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from access.redhat.com_a6472c25_20250119_140912.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from github.com_11d4f52f_20250119_140914.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwildfly-security%2Fsoteria%2Fpull%2F1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwildfly-security%2Fsoteria%2Fpull%2F1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=wildfly-security%2Fsoteria)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wildfly-security](/wildfly-security)
/
**[soteria](/wildfly-security/soteria)**
Public

forked from [eclipse-ee4j/soteria](/eclipse-ee4j/soteria)

* [Notifications](/login?return_to=%2Fwildfly-security%2Fsoteria) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fwildfly-security%2Fsoteria)
* [Star
   0](/login?return_to=%2Fwildfly-security%2Fsoteria)

* [Code](/wildfly-security/soteria)
* [Pull requests
  0](/wildfly-security/soteria/pulls)
* [Actions](/wildfly-security/soteria/actions)
* [Projects
  0](/wildfly-security/soteria/projects)
* [Security](/wildfly-security/soteria/security)
* [Insights](/wildfly-security/soteria/pulse)

Additional navigation options

* [Code](/wildfly-security/soteria)
* [Pull requests](/wildfly-security/soteria/pulls)
* [Actions](/wildfly-security/soteria/actions)
* [Projects](/wildfly-security/soteria/projects)
* [Security](/wildfly-security/soteria/security)
* [Insights](/wildfly-security/soteria/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fwildfly-security%2Fsoteria%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fwildfly-security%2Fsoteria%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [CVE-2020-1732] Adjust JASPIC integration to create a new ServerAuthModule for each request. #1

 Merged

[fjuma](/fjuma)
merged 1 commit into
[wildfly-security:1.0.1-jbossorg-x](/wildfly-security/soteria/tree/1.0.1-jbossorg-x "wildfly-security/soteria:1.0.1-jbossorg-x")
from
[darranl:CVE-2020-1732](/darranl/soteria/tree/CVE-2020-1732 "darranl/soteria:CVE-2020-1732")

Feb 14, 2020

 Merged

# [[CVE-2020-1732] Adjust JASPIC integration to create a new ServerAuthModule for each request.](#top) #1

[fjuma](/fjuma)
merged 1 commit into
[wildfly-security:1.0.1-jbossorg-x](/wildfly-security/soteria/tree/1.0.1-jbossorg-x "wildfly-security/soteria:1.0.1-jbossorg-x")
from
[darranl:CVE-2020-1732](/darranl/soteria/tree/CVE-2020-1732 "darranl/soteria:CVE-2020-1732")

Feb 14, 2020

[Conversation
3](/wildfly-security/soteria/pull/1)
[Commits
1](/wildfly-security/soteria/pull/1/commits)
[Checks
0](/wildfly-security/soteria/pull/1/checks)
[Files changed](/wildfly-security/soteria/pull/1/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![darranl](https://avatars.githubusercontent.com/u/481922?s=60&v=4)](/darranl)

Copy link

### @darranl **[darranl](/darranl)** commented [Feb 14, 2020](#issue-565442791)

 *No description provided.*

Sorry, something went wrong.

All reactions

[![@darranl](https://avatars.githubusercontent.com/u/481922?s=40&v=4)](/darranl)

`[[](/wildfly-security/soteria/pull/1/commits/1a6234e394a34612f4a73e84857af06ff2d412d7 "[CVE-2020-1732] Adjust JASPIC integration to create a new ServerAuthModule for each request.")[CVE-2020-1732](https://github.com/advisories/GHSA-4x5f-xw5j-gv58 "CVE-2020-1732")[] Adjust JASPIC integration to create a new ServerAuthM…](/wildfly-security/soteria/pull/1/commits/1a6234e394a34612f4a73e84857af06ff2d412d7 "[CVE-2020-1732] Adjust JASPIC integration to create a new ServerAuthModule for each request.")`
 …

`[1a6234e](/wildfly-security/soteria/pull/1/commits/1a6234e394a34612f4a73e84857af06ff2d412d7)`

```
…odule for each request.
```

[![fjuma](https://avatars.githubusercontent.com/u/1486286?s=60&v=4)](/fjuma)

**[fjuma](/fjuma)**
approved these changes
[Feb 14, 2020](#pullrequestreview-359083493)

 [View reviewed changes](/wildfly-security/soteria/pull/1/files/1a6234e394a34612f4a73e84857af06ff2d412d7)

[![@fjuma](https://avatars.githubusercontent.com/u/1486286?s=40&v=4)](/fjuma)
[fjuma](/fjuma)
merged commit [`c2479f8`](/wildfly-security/soteria/commit/c2479f8c39d7d661341fdcaff7f5e97c5eea1a54)
into
wildfly-security:1.0.1-jbossorg-x

[Feb 14, 2020](https://github.com/wildfly-security/soteria/pull/1#event-3039445084)

 [![@darranl](https://avatars.githubusercontent.com/u/481922?s=40&v=4)](/darranl)
[darranl](/darranl)
deleted the
CVE-2020-1732

branch
[February 19, 2020 16:07](#event-3052307660)

[![@arjantijms](https://avatars.githubusercontent.com/u/3037006?s=80&u=a7fe9a5dc82101b70002f54f8228d6cdcbb5d5d6&v=4)](/arjantijms)

Copy link

### **[arjantijms](/arjantijms)** commented [Sep 24, 2024](#issuecomment-2371556341)

| This is a somewhat older issue, but I got some questions about it recently so would like to add a link to the upstream PR and specifically the discussion there:  [eclipse-ee4j#270](https://github.com/eclipse-ee4j/soteria/pull/270)  In short, this is not necessarily a CVE in Soteria itself, but rather in the combination of how WildFly/Elytron integrated it.  When using the `Subject` for the request state and considering the callback handler to be either stateless or containing only threadsafe global data, there is no vulnarability.  [@darranl](https://github.com/darranl) and [@fjuma](https://github.com/fjuma) How do you handle this in current versions of WildFly? Do you repatch Soteria for every release (since we never merged the original PR), or did you remove the usage of request state from your callback handler?  See also the following recommendation in the specification text:  <https://jakarta.ee/specifications/authentication/3.1/jakarta-authentication-spec-3.1#state>  (I know it's a SHOULD, maybe we can upgrade this to MUST?) |
| --- |

All reactions

Sorry, something went wrong.

[![@darranl](https://avatars.githubusercontent.com/u/481922?s=80&v=4)](/darranl)

Copy link

Author

### **[darranl](/darranl)** commented [Sep 24, 2024](#issuecomment-2371730998)

| Hi [@arjantijms](https://github.com/arjantijms) we have compensated for the Soteria implementation by switching to a CallbackHandler that moves the state to a ThreadLocal allowing the request specific state to be accessed from the current thread whilst a common CallbackHandler instance is in use. |
| --- |

All reactions

Sorry, something went wrong.

[![@arjantijms](https://avatars.githubusercontent.com/u/3037006?s=80&u=a7fe9a5dc82101b70002f54f8228d6cdcbb5d5d6&v=4)](/arjantijms)

Copy link

### **[arjantijms](/arjantijms)** commented [Sep 24, 2024](#issuecomment-2372467161)

| [@darranl](https://github.com/darranl) thanks, that's interesting to hear.  Do we need to retract the CVE? As currently I guess all versions of Soteria would still be flagged, and that would affect WildFly and JBoss too in scanners such a Sonatype? |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fwildfly-security%2Fsoteria%2Fpull%2F1)

Reviewers

[![@fjuma](https://avatars.githubusercontent.com/u/1486286?s=40&v=4)](/fjuma) [fjuma](/fjuma)

fjuma approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@darranl](https://avatars.githubusercontent.com/u/481922?s=52&v=4)](/darranl) [![@arjantijms](https://avatars.githubusercontent.com/u/3037006?s=52&v=4)](/arjantijms) [![@fjuma](https://avatars.githubusercontent.com/u/1486286?s=52&v=4)](/fjuma)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


