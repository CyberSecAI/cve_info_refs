The provided content is related to CVE-2020-9432.

**Root cause of vulnerability:**
The commit fixes a security issue (GSL-2020-026) in the `lua-openssl` library related to how X.509 certificate checks are handled. The original code used `lua_tostring` to obtain hostname, email, and IP address strings from Lua, and then passed these strings along with `strlen` to OpenSSL's X509 verification functions. This is problematic because `lua_tostring` does not guarantee null termination and could read past the end of the provided string, or not copy the entire string if it includes a null byte.
This could cause unexpected results or crashes due to out of bounds read, or a certificate match against the wrong data

**Weaknesses/vulnerabilities present:**
- Use of `lua_tostring` to retrieve strings, which doesn't guarantee null termination and may not copy the entire string due to null byte.
- Incorrect length parameter was passed to OpenSSL's X509 verification functions.

**Impact of exploitation:**
- Incorrect certificate validation could lead to accepting invalid certificates.
- Out-of-bounds reads or crashes

**Attack vectors:**
- An attacker could provide specially crafted hostnames, email addresses, or IP addresses containing embedded null characters or excessively long strings that are not properly handled by the vulnerable code.

**Required attacker capabilities/position:**
- An attacker needs the ability to control the input strings provided to the Lua functions `openssl_x509_check_host`, `openssl_x509_check_email`, and `openssl_x509_check_ip`.