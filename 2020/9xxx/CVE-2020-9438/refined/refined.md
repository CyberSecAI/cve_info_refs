The provided content is related to CVE-2020-9438.

**Root cause of vulnerability:**
The vulnerability is caused by the lack of proper authentication and authorization checks in the Tinxy Smart Door Lock system's offline mode communication. Specifically, the system relies on HTTP-based requests without sufficient security measures to validate the origin or legitimacy of the requests.

**Weaknesses/vulnerabilities present:**
- **Replay Attack:** The system is vulnerable to replay attacks, where a captured HTTP request can be re-sent to the server to unlock the door, even if the user associated with the request has had their access revoked.
- **Insecure HTTP Communication:** Using HTTP-based requests in offline mode makes the communication susceptible to interception and modification.
- **Lack of Proper Authorization:** The server fails to verify if the user is still authorized to perform the unlock operation when processing the offline unlock request.
- **Missing Nonce/Timestamp mechanism:** There is no mechanism in place for preventing replay attacks like a nonce or timestamp parameter in the request.

**Impact of exploitation:**
- An attacker can unlock the door by replaying captured HTTP requests, even if the original user's access has been revoked. This could lead to unauthorized entry and potential security breaches.

**Attack vectors:**
- An attacker with network access can capture a legitimate HTTP unlock request.
- The attacker can then replay this captured request to the door controller to unlock the door.

**Required attacker capabilities/position:**
- The attacker needs to be on the same network as the Tinxy Smart Door Lock controller.
- The attacker needs the ability to intercept HTTP traffic (e.g. via a proxy like Burp Suite).
- The attacker must observe an authenticated user unlock the door in offline mode in order to capture the necessary HTTP request.

**Additional details:**
- The vulnerability is present in the Tinxy Android Apk V 2.1.1 and the corresponding firmware.
- The vendor patched the vulnerability in Android version 3.2.2 and Firmware version v 3.2.