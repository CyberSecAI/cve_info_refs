=== Content from phabricator.wikimedia.org_78053b51_20250119_112032.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT245850)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T245850
# Invoking any namespaced page with {{#widget:}} will run the page's contents as a widget; even if the page is not in Widget namespace (CVE-2020-9382)Closed, Resolved[Public](/policy/explain/PHID-TASK-6xeckscepntdk53k6pou/view/)SecurityActions

* [Edit Task](/maniphest/task/edit/245850/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/245850/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-6xeckscepntdk53k6pou/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-6xeckscepntdk53k6pou/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-6xeckscepntdk53k6pou/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-6xeckscepntdk53k6pou/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-6xeckscepntdk53k6pou/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-6xeckscepntdk53k6pou/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-6xeckscepntdk53k6pou/)
* [Protect as security issue](/wmf/escalate-task/245850/)
* [Award Token](/token/give/PHID-TASK-6xeckscepntdk53k6pou/)
* [Flag For Later](/flag/edit/PHID-TASK-6xeckscepntdk53k6pou/)

Assigned To

|  | [Alexia](/p/Alexia/) |
| --- | --- |

Authored By

|  | [Alexia](/p/Alexia/) |
| --- | --- |
| Feb 21 2020, 5:40 PM2020-02-21 17:40:48 (UTC+0) |

Tags

* [Security](/tag/security/)
* [MediaWiki-General](/tag/mediawiki-general/)
* [MediaWiki-extensions-Widgets](/tag/mediawiki-extensions-widgets/) [(Backlog)](/project/board/358/)
Referenced FilesNoneSubscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [Alexia](/p/Alexia/) |
| --- | --- |

|  | [Bawolff](/p/Bawolff/) |
| --- | --- |

|  | [DannyS712](/p/DannyS712/) |
| --- | --- |

|  | [Ernstkm](/p/Ernstkm/) |
| --- | --- |

|  | [Kghbln](/p/Kghbln/) |
| --- | --- |

|  | [Liuxinyu970226](/p/Liuxinyu970226/) |
| --- | --- |

[View All 11 Subscribers](/subscriptions/list/PHID-TASK-6xeckscepntdk53k6pou/)
# Description

Author Affiliation: Fandom(Wikia, Gamepedia)

This issue occurs since user input is passed to a function not safe for user input.

<https://gerrit.wikimedia.org/r/#/c/mediawiki/extensions/Widgets/+/574041/>

<https://gitlab.com/hydrawiki/third-party-extensions/issues/103>

```
The {{#widget:}} tag can invoke non-widget pages (aside from mainspace pages) by simply invoking the full page name with the widget tag e.g. {{#widget:Template:Page name}}, which can allow any user to run style and script tags on any page.
Example provided by Dragalia Lost admins:

https://dragalialost.gamepedia.com/Test2

https://dragalialost.gamepedia.com/Template:Test2/css
```
# Details

Author Affiliation Other (Please specify in description)
# Related ObjectsSearch...

* Task Graph
* Mentions

|  |  | Status | Subtype | Assigned | Task |
| --- | --- | --- | --- | --- | --- |
|  |  | Resolved |  | [Reedy](/p/Reedy/) | T240392 [Release MediaWiki 1.31.7/1.33.3/1.34.1](/T240392) |
|  |  | Resolved |  | [sbassett](/p/sbassett/) | T240400 [Write and send supplementary release announcement for extensions and skins with security patches (MediaWiki 1.31.7/1.33.3/1.34.1)](/T240400) |
|  |  | Resolved | Security | [Alexia](/p/Alexia/) | T245850 [Invoking any namespaced page with {{#widget:}} will run the page's contents as a widget; even if the page is not in Widget namespace (CVE-2020-9382)](/T245850) |

Mentioned In [T269718: RCE in Widgets extension (CVE-2020-35625)](/T269718)
[T240400: Write and send supplementary release announcement for extensions and skins with security patches (MediaWiki 1.31.7/1.33.3/1.34.1)](/T240400) Mentioned Here [T240400: Write and send supplementary release announcement for extensions and skins with security patches (MediaWiki 1.31.7/1.33.3/1.34.1)](/T240400)
### Event Timeline

[Alexia](/p/Alexia/) created this task.[Feb 21 2020, 5:40 PM2020-02-21 17:40:48 (UTC+0)](#5907605)Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  · [View Herald Transcript](/herald/transcript/3546230/)[Feb 21 2020, 5:40 PM2020-02-21 17:40:50 (UTC+0)](#5907616)[Aklapper](/p/Aklapper/) added a project: [MediaWiki-General](/tag/mediawiki-general/).[Feb 21 2020, 11:16 PM2020-02-21 23:16:33 (UTC+0)](#5908722)[• chasemp](/p/chasemp/) triaged this task as Medium priority.[Feb 24 2020, 4:09 PM2020-02-24 16:09:53 (UTC+0)](#5912385)[Alexia](/p/Alexia/) closed this task as Resolved.[Feb 24 2020, 4:13 PM2020-02-24 16:13:46 (UTC+0)](#5912424)[Alexia](/p/Alexia/) claimed this task.Comment Actions

This has been merged.

<https://github.com/wikimedia/mediawiki-extensions-Widgets/blob/master/WidgetRenderer.php#L162>

[sbassett](/p/sbassett/) reopened this task as Open.[Feb 24 2020, 4:18 PM2020-02-24 16:18:03 (UTC+0)](#5912437)[sbassett](/p/sbassett/) removed [Alexia](/p/Alexia/) as the assignee of this task.[sbassett](/p/sbassett/) edited projects, added [MediaWiki-extensions-Widgets](/tag/mediawiki-extensions-widgets/); removed [Security-Team](/tag/security-team/).[sbassett](/p/sbassett/) added subscribers: [siebrand](/p/siebrand/), [Reedy](/p/Reedy/).[sbassett](/p/sbassett/) closed this task as Resolved.Edited · [Feb 24 2020, 4:26 PM2020-02-24 16:26:13 (UTC+0)](#5912492)[sbassett](/p/sbassett/) assigned this task to [Alexia](/p/Alexia/).[sbassett](/p/sbassett/) subscribed.Comment Actions

Whoops, I think this task was being edited as the [Security-Team](/tag/security-team/) was reviewing it :) Did the above commit get deployed to any relevant wikis (I know ext:Widget isn't part of WMF production)? That should probably happen soon since the patch for master is public. We should also try to backport this to [supported release branches](https://www.mediawiki.org/wiki/Version_lifecycle).

[Alexia](/p/Alexia/) added a comment.[Feb 24 2020, 4:28 PM2020-02-24 16:28:27 (UTC+0)](#5912513)Comment Actions
> In [T245850#5912492](/T245850#5912492), [@sbassett](/p/sbassett/) wrote:
>
> Whoops, I think this task was being edited as the [Security-Team](/tag/security-team/) was reviewing it :) Did the above commit get deployed to any relevant wikis (I know ext:Widget isn't part of WMF production)? That should probably happen soon since the patch for master is public. We should also try to backport this to [supported release branches](https://www.mediawiki.org/wiki/Version_lifecycle).

Yes, this patch is out to all gamepedia.com, wikia.org, and fandom.com wikis. I looked over WMF wikis and as far as I can tell WMF does not use Widgets.

[sbassett](/p/sbassett/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-qz5vjjfe6xdbyvb/)" to "Public (No Login Required)".[Feb 24 2020, 8:54 PM2020-02-24 20:54:44 (UTC+0)](#5913681)Restricted Application added a subscriber: [Liuxinyu970226](/p/Liuxinyu970226/).  · [View Herald Transcript](/herald/transcript/3549764/)[Feb 24 2020, 8:54 PM2020-02-24 20:54:45 (UTC+0)](#5913682)[sbassett](/p/sbassett/) added a comment.[Feb 24 2020, 9:01 PM2020-02-24 21:01:45 (UTC+0)](#5913707)Comment Actions

Backports:

* <https://gerrit.wikimedia.org/r/574556> (REL1\_31)
* <https://gerrit.wikimedia.org/r/574557> (REL1\_33)
* <https://gerrit.wikimedia.org/r/574558> (REL1\_34)

Also added to [T240400](/T240400) for tracking and will request a CVE.

[sbassett](/p/sbassett/) mentioned this in [T240400: Write and send supplementary release announcement for extensions and skins with security patches (MediaWiki 1.31.7/1.33.3/1.34.1)](/T240400).[Feb 24 2020, 9:03 PM2020-02-24 21:03:53 (UTC+0)](#5913713)[Alexia](/p/Alexia/) updated the task description. [(Show Details)](/transactions/detail/PHID-XACT-TASK-s7oxrmraughk26p/)[Feb 24 2020, 9:24 PM2020-02-24 21:24:20 (UTC+0)](#5913801)[sbassett](/p/sbassett/) renamed this task from Invoking any namespaced page with {{#widget:}} will run the page's contents as a widget; even if the page is not in Widget namespace. to Invoking any namespaced page with {{#widget:}} will run the page's contents as a widget; even if the page is not in Widget namespace (CVE-2020-9382).[Feb 24 2020, 10:19 PM2020-02-24 22:19:18 (UTC+0)](#5913962)[Bawolff](/p/Bawolff/) subscribed.[Feb 25 2020, 12:00 AM2020-02-25 00:00:32 (UTC+0)](#5914117)Comment Actions
> The {{#widget:}} tag can invoke non-widget pages (aside from mainspace pages) by simply invoking the full page name with the widget tag e.g. {{#widget:Template:Page name}}, which can allow any user to run style and script tags on any page.

Just as a point of note, you can do mainspace pages by doubling the colon.

[Bawolff](/p/Bawolff/) added a comment.[Feb 25 2020, 12:03 AM2020-02-25 00:03:34 (UTC+0)](#5914122)Comment Actions

This is a super commonly used extension in third party wikis. I think an email to mediawiki-l encouraging people to update might be a good idea.

[Kghbln](/p/Kghbln/) subscribed.[Feb 25 2020, 10:12 AM2020-02-25 10:12:19 (UTC+0)](#5914973)Comment Actions

Since this is a versioned extension [@Yaron\_Koren](/p/Yaron_Koren/) may additionally want to release and tag a new version to make the need to upgrade visible even more.

[sbassett](/p/sbassett/) added a comment.[Feb 25 2020, 4:28 PM2020-02-25 16:28:55 (UTC+0)](#5916315)Comment Actions
> In [T245850#5914122](/T245850#5914122), [@Bawolff](/p/Bawolff/) wrote:
>
> This is a super commonly used extension in third party wikis. I think an email to mediawiki-l encouraging people to update might be a good idea.

So we've tried to be a little better about this sort of information dispersal by adding tasks like [T240400](/T240400) to the release process, the end result being quarterly-ish emails to relevant mailing lists ([1](https://lists.wikimedia.org/pipermail/mediawiki-l/2019-December/048230.html), [2](https://lists.wikimedia.org/pipermail/mediawiki-l/2019-October/048147.html), etc). We can certainly send out something to that effect sooner (like today or tomorrow), focused on this specific issue, if you feel that is warranted.

[sbassett](/p/sbassett/) added a parent task: [T240400: Write and send supplementary release announcement for extensions and skins with security patches (MediaWiki 1.31.7/1.33.3/1.34.1)](/T240400).[Mar 10 2020, 2:15 PM2020-03-10 14:15:28 (UTC+0)](#5956202)[DannyS712](/p/DannyS712/) subscribed.[Mar 26 2020, 5:51 PM2020-03-26 17:51:27 (UTC+0)](#6002795)[Ernstkm](/p/Ernstkm/) subscribed.[May 26 2020, 10:55 PM2020-05-26 22:55:14 (UTC+0)](#6167413)[Skizzerz](/p/Skizzerz/) mentioned this in [T269718: RCE in Widgets extension (CVE-2020-35625)](/T269718).[Dec 11 2020, 6:07 PM2020-12-11 18:07:58 (UTC+0)](#6685284)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from gerrit.wikimedia.org_a86e9b26_20250119_112030.html ===



