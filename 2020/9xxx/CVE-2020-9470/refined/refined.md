Based on the provided content, here's an analysis of CVE-2020-9470:

**Root Cause of Vulnerability:**

- The vulnerability stems from the unsafe handling of HTTP session cookies by Wing FTP Server. Specifically, session files (.lua) are created with world-readable and world-writeable permissions.
- These session files are stored in the `/session` and `/session_admin` directories and are named using the session cookie itself.

**Weaknesses/Vulnerabilities Present:**

- **Insecure File Permissions:** Session files are created with world-readable and world-writeable permissions, allowing any local user to read and modify them.
- **Session Hijacking:** Because of the insecure file permissions, an attacker can read a valid session cookie and modify the IP address to which the session is tied. This allows them to hijack the session.

**Impact of Exploitation:**

- **Local Privilege Escalation to Root:** By hijacking an administrator session, an attacker can execute arbitrary Lua code through the Wing FTP Server's administration panel. Since the server runs with superuser privileges, this leads to root code execution.
- **Full System Compromise:** The attacker can then create a program to spawn a root shell and gain complete control over the server.

**Attack Vectors:**

- **Local Access:** The attacker needs to have local access to the system running Wing FTP Server.
- **File System Access:** The attacker needs to be able to read and write to the session file directories (`/session` and `/session_admin`).
- **HTTP Session Hijacking:** The attacker needs to hijack an active administrative session by reading and modifying session files.

**Required Attacker Capabilities/Position:**

- A local user account on the target system.
- Ability to read and write files in the Wing FTP Server session directories (e.g. `/opt/wftpserver/session_admin`).
- The vulnerability relies on an administrator session being established. The UID_ADMIN cookie expire at the end of the "session", meaning that once a browser tab is closed, the cookie is invalidated, so the attack window might be small.

**Additional Details:**

- The vulnerability affects Wing FTP Server versions 6.2.5 and prior, although some 6.2.5 installations might be patched.
- The vulnerability was reported and patched quickly after the release of v6.2.5.
- The provided content includes a bash exploit that automates the session hijacking process and executes a payload for creating a root shell.
- The exploit modifies the IP address restriction in the session file and then executes a Lua command via curl.
- The vulnerable server is running on port 5466 by default.