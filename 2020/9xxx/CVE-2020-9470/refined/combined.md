=== Content from www.wftpserver.com_a869c2a5_20250119_135438.html ===

[![](images/logo-light.png)Wing FTP Server](/)

* Products
  ![dropdown](images/dropdown.png)
  [FTP Server Software](wftpserver.htm)
  [FTP Client Software](ftprush.htm)
  [FTP Server Clusters](gateway.htm)
* Download
  ![dropdown](images/dropdown.png)
  [Wing FTP Server](download.htm)
  [Wing Gateway](download.htm#gateway)
  [FTP Rush](download.htm#ftprush)
* Purchase
  ![dropdown](images/dropdown.png)
  [Wing FTP Server](order.htm)
  [Wing Gateway](ordergateway.htm)
* Support
  ![dropdown](images/dropdown.png)
  [Get Support](/support.htm)
  [Contact Us](/contacts.htm)
  [Forum](https://bbs.wftpserver.com)
  [Blog](/blog/)
* ![](images/search.png)

  Search
* ![](images/globe.png)

  ![English](images/flag_us.gif) English
  [![Deutsch](images/flag_de.gif) Deutsch](de/)
  [![ç®ä½ä¸­æ](images/flag_zh.gif) ç®ä½ä¸­æ](zh/)
* ![](images/twitter.png)

## FTP Software Downloads

Wing FTP Server is distributed under the shareware license, and you can download and evaluate a fully functional trial version for 30 days. After 30 days, you can continue using it as a **Free edition** for non-commercial use. If you need more features available in Standard/Secure/Corporate edition, please purchase a license and register it. And if you are not sure which version is right for you, please [see the edition difference here.](comparison.htm)
## Wing FTP Server Wing FTP Server

| Wing FTP Server **v7.4.1** for Windows   [[Release Notes]](serverhistory.htm)   [[Quickstart Guide]](/help/ftpserver/aoe.htm) | (13.3 MB) | [Download](download/WingFtpServer.exe) |
| --- | --- | --- |
| Wing FTP Server **v7.4.1** for Linux   [[Release Notes]](serverhistory.htm)   [[Installation Guide]](https://bbs.wftpserver.com/viewtopic.php?f=2&t=49) | (18.4 MB) | [Download](download/wftpserver-linux-64bit.tar.gz) |
| Wing FTP Server **v7.4.1** for Mac OS   [[Release Notes]](serverhistory.htm)   [[Installation Guide]](https://bbs.wftpserver.com/viewtopic.php?f=2&t=62) | (16.0 MB) | [Download](download/wftpserver-mac-i386.tar.gz) |

##### How to upgrade?

* Download the latest version first.
* [Optional] Backup the entire folder "/Data" which under WingFTP's installation folder.
* Stop the Wing FTP Server service.
* Install the new version of WingFTP in the same directory.

##### System Requirements:

* 64-bit Windows OS: Windows 11/10/8/7, Windows Server 2022/2019/2016/2012.
* 64-bit Linux OS: Ubuntu 12+, CentOS 7.0+, Red Hat RHEL 7.0+...

### Wing Gateway Wing Gateway

| Wing Gateway **v1.1.2** for Windows   [[Help Manual]](/help/gateway/index.htm) | (3.2 MB) | [Download](download/WingGateway_Setup.exe) |
| --- | --- | --- |
| Wing Gateway **v1.1.2** for 64-bit Linux | (3.0 MB) | [Download](download/WingGateway-linux-64bit.tar.gz) |
| Wing Gateway **v1.1.2** for 32-bit Linux | (2.7 MB) | [Download](download/WingGateway-linux-32bit.tar.gz) |

##### System Requirements:

* Wing FTP Server needs to be installed on same LAN
* CPU: 2 Cores x86 CPU

### FTP Rush v3 FTP Rush v3

| FTP Rush **v3.5.8** for Windows (requires .NET Framework 4.5+) Freeware   [[Release Notes]](releasenotes.htm) | (3.7 MB) | [Download](download/FTPRush-Setup.exe) |
| --- | --- | --- |
| FTP Rush **v3.5.8** for Windows (portable version) Freeware   [[Release Notes]](releasenotes.htm) | (4.0 MB) | [Download](download/FTPRush.zip) |
| FTP Rush **v3.5.8** for Linux Freeware | (15.5 MB) | [Download](download/FTPRush_linux.tar.bz2) |
| FTP Rush **v3.5.8** for Mac OS Freeware [App Store](https://apps.apple.com/us/app/id1611675603) | (12.4 MB) | [Download](download/FTPRush_mac.tar.bz2) |

### FTP Rush App FTP Rush App

Android/iOS version of FTP Rush. Freeware

| Download it from App Store: [App Store](https://apps.apple.com/us/app/id1462600368) | Download it from Google Play: [Google Play](https://play.google.com/store/apps/details?id=com.wftpserver.ftprush) |
| --- | --- |
| Scan QR code to download: QR code | Or download the [APK file](https://www.wftpserver.com/download/com.wftpserver.ftprush.apk) for Android directly |

### [Wing FTP Server](/)

* [Download](download.htm)
* [Quick Start](/help/ftpserver/index.htm?aoe.htm)
* [Purchase](orderserver.htm)
* [Release Notes](serverhistory.htm)

### [Wing Gateway](gateway.htm)

* [Download](download.htm#gateway)
* [Help Manual](/help/gateway/)
* [Purchase](ordergateway.htm)

### [FTP Rush](ftprush.htm)

* [Download](download.htm#ftprush)
* [Help Manual](/help/ftprush/)
* [Release Notes](releasenotes.htm)

### [Blog Posts](/blog/)

* [Accelerate file transfer](/blog/how-to-accelerate-long-distance-file-transfer/)
* [FTP server load balancing](/blog/ftp-server-load-balancing/)
* [Two-factor authentication](/blog/two-factor-authentication-in-wing-ftp-server/)

Copyright Â© 2003 - 2025 wftpserver.com All Rights Reserved   |  [Privacy policy](privacy.htm)



=== Content from www.hooperlabs.xyz_466dcc27_20250119_121345.html ===

![](/img/logo.png)

# Hooper Labs

[Home](/index.php)
Boot to Root

[Nightfall](/b2r/nightfall.php)
[Weakness](/b2r/weakness.php)
[Stapler 1](/b2r/stapler1.php)
[My Tomcat Host](/b2r/mytomcathost.php)
[Inclusiveness](/b2r/inclusiveness.php)

[Cheat Sheets](/cheatsheets.php)
Mobile

[OWASP Uncrackable 1](/mobile/uncrackable1.php)

[About](/about.php)
[Links](/links.php)
[Recipes](/recipes.php)

## Local Privilege Escalation in Wing FTP Server (<= v6.2.5)

2020-03-04

### Description

From the official website: Wing FTP Server is an easy-to-use, secure, and reliable FTP server software for Windows, Linux, Mac OS, and Solaris. It supports multiple file transfer protocols, including FTP, FTPS, HTTP, HTTPS, and SFTP, giving your clients flexibility in how they connect to the server. And it provides admins with a web-based interface to administrate the server from anywhere. You can also monitor server performance and online sessions and even receive email notifications about various events taking place on the server.

Download Link: [Wing FTP Server Software Downloads](https://www.wftpserver.com/download.htm)

#### Vulnerability - Unsafe Permissions on Session Cookies (CVE-2020-9470)

A weakness in the handling of HTTP sessions within Wing FTP Server allows any local user to escalate privileges to root on Linux, MacOS, and Solaris. Exploitation is contingent on an already-established administrative session.
It should be noted that version 6.2.5 was released on Februrary 27th, 2020, however, this bug was identified, reported, and patched on Februrary 28th, 2020. Therefore, some installations of Wing FTP Server showing version 6.2.5 may be vulnerable, while some may not be vulnerable.

### Background

To see previous bugs within Wing FTP Server and read how to install the software, please see the following article: [CVE-2020-8635](cve-2020-8635.php).

### Attack Scenario

#### Unsafe handling of HTTP session cookies

To track user sessions, on successful login, Wing FTP Server saves sessions as ".lua" files within the "/session" and "/session\_admin" directories. Some versions of 6.2.5 and prior are saved with world-readable and world-writeable permissions, which cause a session hijacking vulnerability.
These ".lua" session files use the naming convention "<cookie>.lua" and are pinned to a specific source IP address. Any local user may read the session cookie of a Wing FTP user or Wing FTP administrator. In addition, a local user may modify the IP address to which that session is pinned, completely hijacking a session.
The Wing FTP Server boasts a Lua interpreter within the administration panel (running by default on port 5466). Since Wing FTP Server must run as a superuser, compromise of an administrative account results in root code execution on the server.

#### Screenshots

Exploitation may also occur by hijacking a Wing FTP user account (to leverage the HTTP file transfer interface), but due to the presence of a Lua interpreter in the administrative interface, this target is more reliably exploited.
Administrative sessions are stored within the "wftpserver/session\_admin" directory.
![](/img/wftpflow4a.png)

#### Exploit

The exploitation of this vulnerability relies on an administrative session being established. In addition, the UID\_ADMIN cookies set by Wing FTP Server expire at the end of the "session", meaning that once a browser tab is closed, the cookie is invalidated.
This may only allow for an exploitation window of few minutes or seconds. To resolve this issue, I created an exploit in bash that locates the Wing FTP Server session\_admin directory, modifies the IP restrictions on the session file, then executes a Lua command from localhost with curl.
The current payload creates a program in C to spawn a bash shell, compiles the program, then changes the owner to root and permissions to SUID to spawn a root shell.

[Link to Exploit](/disclosures/cve-2020-9470.sh)
[(Updated) Exploit-DB](https://www.exploit-db.com/exploits/48154)
![](/img/wftpsploit2.png)

#### Operating Systems Verified:

* Ubuntu 18.04.1 LTS

### Vulnerability Disclosure Policy

Hooper Labs takes security issues seriously. We believe in working with relevant stakeholders to achieve coordinated disclosure within a reasonable period of time.
We also adhere to the industry-standard 90-day disclosure deadline, where vendors are notified of vulnerabilities immediately, with details shared to the public after
90 days (or sooner if the issues are resolved earlier).

Common Vulnerabilities and Exposures (CVEs) are an industry standard for identifying vulnerabilities [(link)](https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures). This system is a method for reference and tracking of publicly-known exposures. A CVE is a way to uniquely reference vulnerabilities across systems and Mitre
Corporation is the primary CVE Numbering Authority (CNA) for the program. We believe that users have a right to know their exposures in order to make informed risk decisions.

Hooper Labs does not participate in bug bounty programs, but instead relies on responsible disclosure [(link)](https://en.wikipedia.org/wiki/Responsible_disclosure).
Effectively communicating vulnerabilities and risks to the vendor, users, and public ensure that risk can be documented, calculated, and mitigated. We hope that through this
process the Information Domain may be marginally safer.


