=== Content from bugs.launchpad.net_c8d5fd47_20250119_132134.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1840201/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Elastic search: Search results are not restricted for aretfacts on pages shared with group

Bug #1840201 reported by
[Lisa Seeto](https://launchpad.net/~lisaseeto)
on 2019-08-15

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | [Robert Lyon](https://launchpad.net/~robertl-9) |  |
|  | [18.10](https://bugs.launchpad.net/mahara/18.10) | Fix Released | High | Unassigned | [Mahara 18.10.5](https://launchpad.net/mahara/%2Bmilestone/18.10.5) |
|  | [19.04](https://bugs.launchpad.net/mahara/19.04) | Fix Released | High | Unassigned | [Mahara 19.04.4](https://launchpad.net/mahara/%2Bmilestone/19.04.4) |
|  | [19.10](https://bugs.launchpad.net/mahara/19.10) | Fix Released | High | Unassigned | [Mahara 19.10.2](https://launchpad.net/mahara/%2Bmilestone/19.10.2) |
|  | [20.04](https://bugs.launchpad.net/mahara/20.04) | Fix Released | High | [Robert Lyon](https://launchpad.net/~robertl-9) | [Mahara 20.04.0](https://launchpad.net/mahara/%2Bmilestone/20.04.0) |

### Bug Description

A user can create a page with media artefacts on it and share it with a group. The user can specify which users in that group have access, i.e "Everyone in group", "Member" and "Admin". When a user selects to share the page with "Member" or "Admin" all members of the group can view via the media category in Elastic Search page and can see the artefact. The preview image for an Image block for this issue is displaying as a broken link in FireFox and not displaying at all in Chrome.

Have Elastic Search set up and able to search.

1. Create a group that has admin and members.

2. Log in as a user (doesn't have to be group member) and create a page with an Image block.

3. Share the page with the group and choose "Admin" in dropdown

4. Log in as an Member of the group and go to Elastic search with no search words (should return everything you have access to see.

5. Select Media tab and view

Expected results:

No artefacts from pages that are not shared with User are returned as results.

Actual results:

User can see artefacts from the page they do not have permission to access.

Mahara: 19.10dev

OS: Ubunt 18.04.2

DB: Postgres

Browser: Firefox 68.01, Chrome 75.0.3770.142

Tags:

[search](/mahara/%2Bbugs?field.tag=search)
[privacy](/mahara/%2Bbugs?field.tag=privacy)

## CVE References

* [2020-9386](/bugs/cve/2020-9386 "In Mahara 18.10 before 18.10.5, 19.04...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Lisa Seeto (lisaseeto)](https://launchpad.net/~lisaseeto) wrote on 2019-08-15: |  |  | [#1](/mahara/%2Bbug/1840201/comments/1) |
| --- | --- | --- | --- |

* [elastic-search-users-can-see.png](https://bugs.launchpad.net/mahara/%2Bbug/1840201/%2Battachment/5282553/%2Bfiles/elastic-search-users-can-see.png)
  [Edit](/mahara/%2Bbug/1840201/%2Battachment/5282553)
  (79.1 KiB,
  image/png)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2019-09-08: |  |  | [#2](/mahara/%2Bbug/1840201/comments/2) |
| --- | --- | --- | --- |

Marking as high as it's to do with permissions and thus privacy.

Marking as high as it's to do with permissions and thus privacy.

| Changed in mahara: | |
| --- | --- |
| **importance**: | Undecided → High |
| **status**: | New → Confirmed |
| **milestone**: | none → 19.10.0 |
| **tags**: | added: privacy |

[Cecilia Vela Gurovic (ceciliavg)](https://launchpad.net/~ceciliavg)
on 2019-10-31

| Changed in mahara: | |
| --- | --- |
| **milestone**: | 19.10.0 → 19.10.1 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2019-11-02: |  |  | [#3](/mahara/%2Bbug/1840201/comments/3) |
| --- | --- | --- | --- |

Please check if also a problem in 19.04.

Please check if also a problem in 19.04.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2020-02-24: |  |  | [#4](/mahara/%2Bbug/1840201/comments/4) |
| --- | --- | --- | --- |

This will need to be tested with isolated institutions turned on as well.

This will need to be tested with isolated institutions turned on as well.

| **information type**: | Public → Private Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9) wrote on 2020-02-24: |  |  | [#5](/mahara/%2Bbug/1840201/comments/5) |
| --- | --- | --- | --- |

<https://reviews.mahara.org/#/c/10770/>

https://reviews.mahara.org/#/c/10770/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2020-03-03: |  |  | [#7](/mahara/%2Bbug/1840201/comments/7) |
| --- | --- | --- | --- |

Information for the security forum post:

Vulnerability type: Incorrect access control

Attack type: Remote

Impact: Information disclosure

Affected: Elasticsearch implementation in Mahara

In Mahara 18.10 before 18.10.5, 19.04 before 19.04.4, and 19.10 before 19.10.2, file metadata information is disclosed to group members in the Elasticsearch result list despite them not having access to to that information any more.

Reference: [https://bugs.launchpad.net/mahara/+bug/1840201](https://bugs.launchpad.net/mahara/%2Bbug/1840201)

Credit: Lisa Seeto and Robert Lyon (Catalyst IT)

CVE: CVE-2020-9386

(link CVE number to: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2020-9386> )

Information for the security forum post:
Vulnerability type: Incorrect access control
Attack type: Remote
Impact: Information disclosure
Affected: Elasticsearch implementation in Mahara
In Mahara 18.10 before 18.10.5, 19.04 before 19.04.4, and 19.10 before 19.10.2, file metadata information is disclosed to group members in the Elasticsearch result list despite them not having access to to that information any more.
Reference: https://bugs.launchpad.net/mahara/+bug/1840201
Credit: Lisa Seeto and Robert Lyon (Catalyst IT)
CVE: CVE-2020-9386
(link CVE number to: https://cve.mitre.org/cgi-bin/cvename.cgi?name=2020-9386 )

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2020-03-04

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2020-03-10:  [**A patch has been submitted for review**](/mahara/%2Bbug/1840201/comments/8) |  |  | [#8](/mahara/%2Bbug/1840201/comments/8) |
| --- | --- | --- | --- |

Patch for "19.04\_STABLE" branch: <https://reviews.mahara.org/10819>

Patch for "19.04\_STABLE" branch: https://reviews.mahara.org/10819

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2020-03-30: |  |  | [#10](/mahara/%2Bbug/1840201/comments/10) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/10819>

Committed: <https://git.mahara.org/mahara/mahara/commit/41c210f3b6a66e520d7ea6b460b3615d7b839f8d>

Submitter: Robert Lyon (<email address hidden>)

Branch: 19.04\_STABLE

commit 41c210f3b6a66e520d7ea6b460b3615d7b839f8d

Author: Robert Lyon <email address hidden>

Date: Wed Mar 11 09:46:28 2020 +1300

[Bug 1866913](/bugs/1866913): Add parts of missing function from master that are needed

Fix for [bug 1840201](/bugs/1840201) in 19.04

Change-Id: I20f41cb9557f3fa24a48e7e05a185ab1f72e5658

Signed-off-by: Robert Lyon <email address hidden>

Reviewed: https://reviews.mahara.org/10819
Committed: https://git.mahara.org/mahara/mahara/commit/41c210f3b6a66e520d7ea6b460b3615d7b839f8d
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 19.04\_STABLE
commit 41c210f3b6a66e520d7ea6b460b3615d7b839f8d
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Wed Mar 11 09:46:28 2020 +1300
Bug 1866913: Add parts of missing function from master that are needed
Fix for bug 1840201 in 19.04
Change-Id: I20f41cb9557f3fa24a48e7e05a185ab1f72e5658
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2020-03-30:  [**A patch has been submitted for review**](/mahara/%2Bbug/1840201/comments/11) |  |  | [#11](/mahara/%2Bbug/1840201/comments/11) |
| --- | --- | --- | --- |

Patch for "18.10\_STABLE" branch: <https://reviews.mahara.org/10838>

Patch for "18.10\_STABLE" branch: https://reviews.mahara.org/10838

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2020-03-30:  [**A change has been merged**](/mahara/%2Bbug/1840201/comments/9) |  |  | [#9](/mahara/%2Bbug/1840201/comments/9) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/10838>

Committed: <https://git.mahara.org/mahara/mahara/commit/42332f7c547376781e539c84340347921bfcc546>

Submitter: Robert Lyon (<email address hidden>)

Branch: 18.10\_STABLE

commit 42332f7c547376781e539c84340347921bfcc546

Author: Robert Lyon <email address hidden>

Date: Wed Mar 11 09:46:28 2020 +1300

[Bug 1866913](/bugs/1866913): Add parts of missing function from master that are needed

Fix for [bug 1840201](/bugs/1840201) in 19.04

Change-Id: I20f41cb9557f3fa24a48e7e05a185ab1f72e5658

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit 41c210f3b6a66e520d7ea6b460b3615d7b839f8d)

Reviewed: https://reviews.mahara.org/10838
Committed: https://git.mahara.org/mahara/mahara/commit/42332f7c547376781e539c84340347921bfcc546
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 18.10\_STABLE
commit 42332f7c547376781e539c84340347921bfcc546
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Wed Mar 11 09:46:28 2020 +1300
Bug 1866913: Add parts of missing function from master that are needed
Fix for bug 1840201 in 19.04
Change-Id: I20f41cb9557f3fa24a48e7e05a185ab1f72e5658
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit 41c210f3b6a66e520d7ea6b460b3615d7b839f8d)

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2020-04-29

| Changed in mahara: | |
| --- | --- |
| **milestone**: | 20.04.0 → none |

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1840201/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1840201/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1840201/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1840201/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Bug attachments

* [elastic-search-users-can-see.png](https://bugs.launchpad.net/mahara/%2Bbug/1840201/%2Battachment/5282553/%2Bfiles/elastic-search-users-can-see.png)
  [Edit](/mahara/%2Bbug/1840201/%2Battachment/5282553 "Change attachment details")

* [Add attachment](/mahara/%2Bbug/1840201/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from mahara.org_3574cb9c_20250119_112956.html ===

[Skip to main content](#header-main)

* [Login](https://mahara.org/?login)

Show search

SearchGo

[![Mahara ePortfolio System](https://mahara.org/theme/mahara-org/images/site-logo.svg?v=4171)](https://mahara.org/)
[![Mahara ePortfolio System](https://mahara.org/theme/raw/images/site-logo-small.svg?v=4171)](https://mahara.org/)
Show main menu

* [Home](https://mahara.org/)
* [Subscription](https://mahara.org/subscription)
* [Demo](https://mahara.org/demo)
* About

  + [About Mahara](https://mahara.org/about)
  + [About open source](https://mahara.org/about/opensource)
  + [Features](https://mahara.org/features)
  + [What is an ePortfolio?](https://mahara.org/about/eportfolios)
  + [Who is using Mahara?](https://mahara.org/showcase)
  + [News and announcements](https://mahara.org/news)
  + [Newsletter](https://mahara.org/newsletter)
  + [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* Community

  + [Community](https://mahara.org/community)
  + [Forums](https://mahara.org/forums)
  + [Mahara manual](https://mahara.org/documentation)
  + [Wiki](https://mahara.org/wiki)
  + [Bug / feature tracker](https://mahara.org/tracker)
  + [Release notes](https://mahara.org/releasenotes)
  + [Security](https://mahara.org/security)
  + [Contributors](https://mahara.org/community/contributors)
  + [Branding](https://mahara.org/branding)
  + [Events](https://mahara.org/events)
* Partners

  + [Partners](https://mahara.org/partners)
  + [Business Partners](https://mahara.org/business-partners)
  + [Supporters](https://mahara.org/supporters)

# Portfolios for your learning community

SearchGo

[Try out Mahara](http://demo.mahara.org/)

![Continuous single line drawing of a puhutukawa tree with a tui on the branches](https://mahara.org/theme/mahara-org/images/dashboard-tree-desktop-full.svg)

![Continuous single line drawing of a person working on a laptop](https://mahara.org/theme/mahara-org/images/dashboard-person-desktop.svg)

## Create portfolios

Using Mahara, students and staff create their personal learning stories by uploading evidence of activities they have participated in, and embedding publicly accessible content they have previously put online. They can write reflections on their experiences that frame this evidence, map it to competencies or registration requirements, and provide necessary context.

Mahara can be used for many different portfolio purposes, such as study, professional development, work-integrated learning, assessment, showcase and presentation, and employability.

[Learn about the portfolio options](https://mahara.org/view/view.php?id=137010)

## Share work

Mahara allows portfolios to be shared flexibly with one person, a specific group of people, or the entire world. Access can be further restricted to a particular time frame or just within an assessment task.

[Find out about sharing portfolios](https://mahara.org/view/view.php?id=137011)

![Continuous single line drawing of a paper plane in flight](https://mahara.org/theme/mahara-org/images/dashboard-paperplane-desktop.svg)

![Continuous single line drawing of a group of people sitting around a laptop in discussion](https://mahara.org/theme/mahara-org/images/dashboard-group-desktop.svg)

## Engage with others

Mahara makes it easy to comment and give feedback. Portfolios can also be submitted to learning management systems via LTI (Learning Tools Interoperability) for marking.

Groups in Mahara allow people to create portfolios collaboratively and engage in forum discussions.

[Learn about collaborating in Mahara](https://mahara.org/view/view.php?id=137012)

## Listen to portfolio stories

In our podcast 'Create. Share. Engage.' portfolio practitioners, researchers, learning designers, and portfolio authors share their journey. Learn how they navigate the many different facets of portfolios in general, and Mahara specifically.

[Listen on the podcast website or in your favourite app](https://podcast.mahara.org/)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-desktop.svg)

![Continuous single line drawing of a speech bubble with the words 'Create. Share. Engage. Portfolios for learning and more'](https://mahara.org/theme/mahara-org/images/dashboard-podcast-logo.svg)

Mahara Community

* [About
  (tab)](https://mahara.org/group/mahara-community)
* [Members
  (tab)](https://mahara.org/group/members.php?id=1)
* [Forums
  (tab selected)](https://mahara.org/interaction/forum/index.php?group=1)
* [Portfolios
  (tab)](https://mahara.org/view/groupviews.php?group=1)

# Forums | Mahara Community

## [Security Announcements](https://mahara.org/interaction/forum/view.php?id=43) / Security issue relating to incorrect access control in Elasticsearch results <18.10.5, <19.04.4, <19.10.2

---

This topic is closed. Only moderators and the group administrators can post new replies.

![Kristina Hoeppner's profile picture](https://mahara.org/thumb.php?type=profileiconbyid&maxwidth=40&maxheight=40&id=438257)
[Kristina Hoeppner](https://mahara.org/user/anitsirk)

Posts: 4884

04 March 2020, 18:38

Vulnerability type: Incorrect access control
Impact: Information disclosure
Affected: Elasticsearch implementation in Mahara

In Mahara 18.10 before 18.10.5, 19.04 before 19.04.4, and 19.10 before 19.10.2, file metadata information is disclosed to group members in the Elasticsearch result list despite them not having access to that information any more.

Reference: [Launchpad bug 1840201](https://bugs.launchpad.net/mahara/%2Bbug/1840201)
Credit: Lisa Seeto and Robert Lyon (Catalyst IT)
CVE reference: [CVE-2020-9386](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2020-9386)

Get the latest releases from our [Git repository](https://git.mahara.org/mahara/mahara). You can also download them from Launchpad:

* [19.10.2](https://launchpad.net/mahara/%2Bmilestone/19.10.2)
* [19.04.4](https://launchpad.net/mahara/%2Bmilestone/19.04.4)
* [18.10.5](https://launchpad.net/mahara/%2Bmilestone/18.10.5)

### Edits to this post:

* [![Kristina Hoeppner's profile picture](https://mahara.org/thumb.php?type=profileiconbyid&maxwidth=20&maxheight=20&id=438257)
  Kristina Hoeppner](https://mahara.org/user/anitsirk) -
  07 March 2020, 17:51

1 result

## Subscribe to our monthly newsletter

Do you want to stay updated on the latest news from Mahara and wider portfolio community? Subscribe to the monthly Mahara newsletter from Catalyst, the maintainers of Mahara.

[Sign up for the newsletter](https://zcu.nz/wpPM)

Create. Share. Engage.
[Try out Mahara](http://demo.mahara.org/)
[Support Mahara](https://mahara.org/subscription)

#### [Support](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Mahara manual](https://mahara.org/documentation)
* [Wiki](https://mahara.org/wiki)
* [Bug / feature tracker](https://mahara.org/tracker)
* [Extended security support](https://mahara.org/extended-security-support)

#### [Get involved](https://mahara.org/community)

* [Community forums](https://mahara.org/forums)
* [Code repository](https://mahara.org/repository)
* [Contribute](https://mahara.org/contribute)
* [Release notes](https://mahara.org/releasenotes)
* [Events](https://mahara.org/events)

#### [About](https://mahara.org/about)

* [News and announcements](https://mahara.org/news)
* [Podcast 'Create. Share. Engage.'](https://podcast.mahara.org)
* [Contributors](https://mahara.org/community/contributors)
* [Security](https://mahara.org/security)
* [Accessibility](https://mahara.org/accessibility)

#### [Home](https://mahara.org/)

#### [Partners](https://mahara.org/partners)

#### [Subscription](https://mahara.org/subscription)

#### [Demo site](https://mahara.org/demo)

[![Powered by Mahara](https://mahara.org/theme/mahara-org/images/powered_by_mahara.svg?v=4171)](https://mahara.org/)

* [Legal](https://mahara.org/legal.php)
* [Contact us](https://mahara.org/contact.php)
* [Help](https://manual.mahara.org/en/24.04/)

[![Developed and maintained by Catalyst](https://mahara.org/theme/mahara-org/images/maintained-by-catalyst.png)](https://catalyst.net.nz/)

[Follow us on LinkedIn](https://www.linkedin.com/company/1845966)

[Find us on Mastodon](https://mastodon.nzoss.nz/%40mahara)



=== Content from bugs.launchpad.net_6b003a57_20250119_132133.html ===

[Log in / Register](https://bugs.launchpad.net/mahara/%2Bbug/1840201/%2Blogin)

[![](https://launchpadlibrarian.net/302557383/mahara_64x64.png)](https://launchpad.net/mahara)

## [Mahara](https://launchpad.net/mahara)

* [Overview](https://launchpad.net/mahara)
* [Code](https://code.launchpad.net/mahara)
* [Bugs](https://bugs.launchpad.net/mahara)
* [Blueprints](https://blueprints.launchpad.net/mahara)
* [Translations](https://translations.launchpad.net/mahara)
* [Answers](https://answers.launchpad.net/mahara)

# Elastic search: Search results are not restricted for aretfacts on pages shared with group

Bug #1840201 reported by
[Lisa Seeto](https://launchpad.net/~lisaseeto)
on 2019-08-15

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Mahara](https://bugs.launchpad.net/mahara) | Fix Released | High | [Robert Lyon](https://launchpad.net/~robertl-9) |  |
|  | [18.10](https://bugs.launchpad.net/mahara/18.10) | Fix Released | High | Unassigned | [Mahara 18.10.5](https://launchpad.net/mahara/%2Bmilestone/18.10.5) |
|  | [19.04](https://bugs.launchpad.net/mahara/19.04) | Fix Released | High | Unassigned | [Mahara 19.04.4](https://launchpad.net/mahara/%2Bmilestone/19.04.4) |
|  | [19.10](https://bugs.launchpad.net/mahara/19.10) | Fix Released | High | Unassigned | [Mahara 19.10.2](https://launchpad.net/mahara/%2Bmilestone/19.10.2) |
|  | [20.04](https://bugs.launchpad.net/mahara/20.04) | Fix Released | High | [Robert Lyon](https://launchpad.net/~robertl-9) | [Mahara 20.04.0](https://launchpad.net/mahara/%2Bmilestone/20.04.0) |

### Bug Description

A user can create a page with media artefacts on it and share it with a group. The user can specify which users in that group have access, i.e "Everyone in group", "Member" and "Admin". When a user selects to share the page with "Member" or "Admin" all members of the group can view via the media category in Elastic Search page and can see the artefact. The preview image for an Image block for this issue is displaying as a broken link in FireFox and not displaying at all in Chrome.

Have Elastic Search set up and able to search.

1. Create a group that has admin and members.

2. Log in as a user (doesn't have to be group member) and create a page with an Image block.

3. Share the page with the group and choose "Admin" in dropdown

4. Log in as an Member of the group and go to Elastic search with no search words (should return everything you have access to see.

5. Select Media tab and view

Expected results:

No artefacts from pages that are not shared with User are returned as results.

Actual results:

User can see artefacts from the page they do not have permission to access.

Mahara: 19.10dev

OS: Ubunt 18.04.2

DB: Postgres

Browser: Firefox 68.01, Chrome 75.0.3770.142

Tags:

[search](/mahara/%2Bbugs?field.tag=search)
[privacy](/mahara/%2Bbugs?field.tag=privacy)

## CVE References

* [2020-9386](/bugs/cve/2020-9386 "In Mahara 18.10 before 18.10.5, 19.04...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Lisa Seeto (lisaseeto)](https://launchpad.net/~lisaseeto) wrote on 2019-08-15: |  |  | [#1](/mahara/%2Bbug/1840201/comments/1) |
| --- | --- | --- | --- |

* [elastic-search-users-can-see.png](https://bugs.launchpad.net/mahara/%2Bbug/1840201/%2Battachment/5282553/%2Bfiles/elastic-search-users-can-see.png)
  [Edit](/mahara/%2Bbug/1840201/%2Battachment/5282553)
  (79.1 KiB,
  image/png)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2019-09-08: |  |  | [#2](/mahara/%2Bbug/1840201/comments/2) |
| --- | --- | --- | --- |

Marking as high as it's to do with permissions and thus privacy.

Marking as high as it's to do with permissions and thus privacy.

| Changed in mahara: | |
| --- | --- |
| **importance**: | Undecided → High |
| **status**: | New → Confirmed |
| **milestone**: | none → 19.10.0 |
| **tags**: | added: privacy |

[Cecilia Vela Gurovic (ceciliavg)](https://launchpad.net/~ceciliavg)
on 2019-10-31

| Changed in mahara: | |
| --- | --- |
| **milestone**: | 19.10.0 → 19.10.1 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2019-11-02: |  |  | [#3](/mahara/%2Bbug/1840201/comments/3) |
| --- | --- | --- | --- |

Please check if also a problem in 19.04.

Please check if also a problem in 19.04.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2020-02-24: |  |  | [#4](/mahara/%2Bbug/1840201/comments/4) |
| --- | --- | --- | --- |

This will need to be tested with isolated institutions turned on as well.

This will need to be tested with isolated institutions turned on as well.

| **information type**: | Public → Private Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9) wrote on 2020-02-24: |  |  | [#5](/mahara/%2Bbug/1840201/comments/5) |
| --- | --- | --- | --- |

<https://reviews.mahara.org/#/c/10770/>

https://reviews.mahara.org/#/c/10770/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kristina Hoeppner (kris-hoeppner)](https://launchpad.net/~kris-hoeppner) wrote on 2020-03-03: |  |  | [#7](/mahara/%2Bbug/1840201/comments/7) |
| --- | --- | --- | --- |

Information for the security forum post:

Vulnerability type: Incorrect access control

Attack type: Remote

Impact: Information disclosure

Affected: Elasticsearch implementation in Mahara

In Mahara 18.10 before 18.10.5, 19.04 before 19.04.4, and 19.10 before 19.10.2, file metadata information is disclosed to group members in the Elasticsearch result list despite them not having access to to that information any more.

Reference: [https://bugs.launchpad.net/mahara/+bug/1840201](https://bugs.launchpad.net/mahara/%2Bbug/1840201)

Credit: Lisa Seeto and Robert Lyon (Catalyst IT)

CVE: CVE-2020-9386

(link CVE number to: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2020-9386> )

Information for the security forum post:
Vulnerability type: Incorrect access control
Attack type: Remote
Impact: Information disclosure
Affected: Elasticsearch implementation in Mahara
In Mahara 18.10 before 18.10.5, 19.04 before 19.04.4, and 19.10 before 19.10.2, file metadata information is disclosed to group members in the Elasticsearch result list despite them not having access to to that information any more.
Reference: https://bugs.launchpad.net/mahara/+bug/1840201
Credit: Lisa Seeto and Robert Lyon (Catalyst IT)
CVE: CVE-2020-9386
(link CVE number to: https://cve.mitre.org/cgi-bin/cvename.cgi?name=2020-9386 )

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2020-03-04

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2020-03-10:  [**A patch has been submitted for review**](/mahara/%2Bbug/1840201/comments/8) |  |  | [#8](/mahara/%2Bbug/1840201/comments/8) |
| --- | --- | --- | --- |

Patch for "19.04\_STABLE" branch: <https://reviews.mahara.org/10819>

Patch for "19.04\_STABLE" branch: https://reviews.mahara.org/10819

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2020-03-30: |  |  | [#10](/mahara/%2Bbug/1840201/comments/10) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/10819>

Committed: <https://git.mahara.org/mahara/mahara/commit/41c210f3b6a66e520d7ea6b460b3615d7b839f8d>

Submitter: Robert Lyon (<email address hidden>)

Branch: 19.04\_STABLE

commit 41c210f3b6a66e520d7ea6b460b3615d7b839f8d

Author: Robert Lyon <email address hidden>

Date: Wed Mar 11 09:46:28 2020 +1300

[Bug 1866913](/bugs/1866913): Add parts of missing function from master that are needed

Fix for [bug 1840201](/bugs/1840201) in 19.04

Change-Id: I20f41cb9557f3fa24a48e7e05a185ab1f72e5658

Signed-off-by: Robert Lyon <email address hidden>

Reviewed: https://reviews.mahara.org/10819
Committed: https://git.mahara.org/mahara/mahara/commit/41c210f3b6a66e520d7ea6b460b3615d7b839f8d
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 19.04\_STABLE
commit 41c210f3b6a66e520d7ea6b460b3615d7b839f8d
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Wed Mar 11 09:46:28 2020 +1300
Bug 1866913: Add parts of missing function from master that are needed
Fix for bug 1840201 in 19.04
Change-Id: I20f41cb9557f3fa24a48e7e05a185ab1f72e5658
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2020-03-30:  [**A patch has been submitted for review**](/mahara/%2Bbug/1840201/comments/11) |  |  | [#11](/mahara/%2Bbug/1840201/comments/11) |
| --- | --- | --- | --- |

Patch for "18.10\_STABLE" branch: <https://reviews.mahara.org/10838>

Patch for "18.10\_STABLE" branch: https://reviews.mahara.org/10838

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mahara Bot (dev-mahara)](https://launchpad.net/~dev-mahara) wrote on 2020-03-30:  [**A change has been merged**](/mahara/%2Bbug/1840201/comments/9) |  |  | [#9](/mahara/%2Bbug/1840201/comments/9) |
| --- | --- | --- | --- |

Reviewed: <https://reviews.mahara.org/10838>

Committed: <https://git.mahara.org/mahara/mahara/commit/42332f7c547376781e539c84340347921bfcc546>

Submitter: Robert Lyon (<email address hidden>)

Branch: 18.10\_STABLE

commit 42332f7c547376781e539c84340347921bfcc546

Author: Robert Lyon <email address hidden>

Date: Wed Mar 11 09:46:28 2020 +1300

[Bug 1866913](/bugs/1866913): Add parts of missing function from master that are needed

Fix for [bug 1840201](/bugs/1840201) in 19.04

Change-Id: I20f41cb9557f3fa24a48e7e05a185ab1f72e5658

Signed-off-by: Robert Lyon <email address hidden>

(cherry picked from commit 41c210f3b6a66e520d7ea6b460b3615d7b839f8d)

Reviewed: https://reviews.mahara.org/10838
Committed: https://git.mahara.org/mahara/mahara/commit/42332f7c547376781e539c84340347921bfcc546
Submitter: Robert Lyon (robertl@catalyst.net.nz)
Branch: 18.10\_STABLE
commit 42332f7c547376781e539c84340347921bfcc546
Author: Robert Lyon <robertl@catalyst.net.nz>
Date: Wed Mar 11 09:46:28 2020 +1300
Bug 1866913: Add parts of missing function from master that are needed
Fix for bug 1840201 in 19.04
Change-Id: I20f41cb9557f3fa24a48e7e05a185ab1f72e5658
Signed-off-by: Robert Lyon <robertl@catalyst.net.nz>
(cherry picked from commit 41c210f3b6a66e520d7ea6b460b3615d7b839f8d)

[Robert Lyon (robertl-9)](https://launchpad.net/~robertl-9)
on 2020-04-29

| Changed in mahara: | |
| --- | --- |
| **milestone**: | 20.04.0 → none |

[See full activity log](https://bugs.launchpad.net/mahara/%2Bbug/1840201/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/mahara/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/mahara/%2Bbug/1840201/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/mahara/%2Bbug/1840201/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/mahara/%2Bbug/1840201/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Bug attachments

* [elastic-search-users-can-see.png](https://bugs.launchpad.net/mahara/%2Bbug/1840201/%2Battachment/5282553/%2Bfiles/elastic-search-users-can-see.png)
  [Edit](/mahara/%2Bbug/1840201/%2Battachment/5282553 "Change attachment details")

* [Add attachment](/mahara/%2Bbug/1840201/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_eab509cc_20250119_132134.html ===

[Log in / Register](https://launchpad.net/~robertl-9/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~robertl-9)

## [Robert Lyon](https://launchpad.net/~robertl-9)

* Overview
* [Code](https://code.launchpad.net/~robertl-9)
* [Bugs](https://bugs.launchpad.net/~robertl-9)
* [Blueprints](https://blueprints.launchpad.net/~robertl-9)
* [Translations](https://translations.launchpad.net/~robertl-9)
* [Answers](https://answers.launchpad.net/~robertl-9)

* [Related packages](https://launchpad.net/~robertl-9/%2Brelated-packages)
* [Related projects](https://launchpad.net/~robertl-9/%2Brelated-projects)

## User information

Launchpad Id:
robertl-9

Email:
[Log in](%2Blogin) for email information.

Member since:
2013-05-15

[![Icon of Mahara Contributors](https://launchpadlibrarian.net/42741467/contributors14.png "Member of Mahara Contributors")](/~mahara-contributors)
[![Icon of Mahara Release](https://launchpadlibrarian.net/74515538/core14.png "Member of Mahara Release")](/~mahara-release)
[![Icon of Mahara Reviewers](https://launchpadlibrarian.net/74515691/maharareviewer14.png "Member of Mahara Reviewers")](/~mahara-reviewers)
[![Icon of Mahara Security](https://launchpadlibrarian.net/42741378/security14.png "Member of Mahara Security")](/~mahara-security)
[![Icon of Mahara translators](https://launchpadlibrarian.net/73545485/translator14.png "Member of Mahara translators")](/~mahara-lang)

Languages:

German

OpenPGP keys:

8A82F7F0E9CAD3664967E9F39FA60291B6534C07,
94E3A41E36DD1563F9C86569E2B8FD0E8202FE62

SSH keys:

[robertl@catalyst.net.nz](%2Bsshkeys)

[robertl@bobserver](%2Bsshkeys)

Time zone:

UTC
(UTC+0000)

Karma:
[483](https://launchpad.net/~robertl-9/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

## [All bugs in progress](https://launchpad.net/~robertl-9/%2Bassignedbugs?search=Search&field.status=In+Progress) Assigned bugs

||  | #1875149 [Outdated packages during PDF export install](https://bugs.launchpad.net/mahara/%2Bbug/1875149) |  |
| --- | --- | --- |
| in [Mahara](/mahara) | | |

| --- | --- | --- | --- | --- | --- |
||  | #1945709 [Better handling of external apps when module is disabled](https://bugs.launchpad.net/mahara/%2Bbug/1945709) |  |
| --- | --- | --- |
| in [Mahara](/mahara) | | |

||  | #1843853 [Add SmartEvidence framework creation/update web service](https://bugs.launchpad.net/mahara/%2Bbug/1843853) |  |
| --- | --- | --- |
| in [Mahara](/mahara) | | |

## [All memberships](https://launchpad.net/~robertl-9/%2Bparticipation) Latest memberships

| [Mahara translators](/~mahara-lang)  Joined on 2017-03-28 | |
| --- | --- |
| [Mahara Reviewers](/~mahara-reviewers)  Joined on 2013-08-27 | |
| [Mahara Security](/~mahara-security)  Joined on 2013-08-27 | |
| [Mahara Release](/~mahara-release)  Joined on 2013-07-24 | |
| [Mahara Contributors](/~mahara-contributors)  Joined on 2013-05-21 | |

## [Recent activities](https://launchpad.net/~robertl-9/%2Bkarma) Most active in

| [Mahara language packs](/mahara-lang) |  |
| --- | --- |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from git.mahara.org_924d3b19_20250119_132130.html ===


[Skip to content](#content-body)
GitLab

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

This is an archived project. Repository and other project resources are read-only.

![mahara](/uploads/-/system/project/avatar/4/Facebook_ProfilePict_180x180.png?width=48)
# mahara Archived

## Project information

This is the old repository for Mahara. It is not updated any more as of April 2023. The latest code is available via a subscription. Please see <https://mahara.org/subscription> for more information.

Read more

* [**22,674** Commits](/mahara/mahara/-/commits/main)
* [**38** Branches](/mahara/mahara/-/branches)
* [**310** Tags](/mahara/mahara/-/tags)

* [README](/mahara/mahara/-/blob/main/README.md)
* [GNU GPLv3](/mahara/mahara/-/blob/main/COPYING)

Created on

May 14, 2015

Find file

Copy HTTPS clone URL

* [**Copy SSH clone URL**git@git.mahara.org:mahara/mahara.git](git%40git.mahara.org%3Amahara/mahara.git)
* [**Copy HTTPS clone URL**https://git.mahara.org/mahara/mahara.git](https://git.mahara.org/mahara/mahara.git)

Loading


