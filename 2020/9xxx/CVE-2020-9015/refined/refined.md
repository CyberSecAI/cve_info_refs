```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability is caused by a combination of a poorly configured TACACS+ (tac_plus) AAA server and Arista's alternative CLI shells. Specifically, the TACACS+ configuration allows for pipe chaining (`|`) with commands, and Arista's implementation allows access to the bash shell in all command modes except EXEC mode. This combination allows a \"read-only\" user to bypass restrictions.",
    "weaknesses": [
      "Incorrect Access Control",
      "Insecure use of pipe chaining",
      "Overly permissive command authorization in TACACS+ configuration",
      "Unrestricted access to bash shell in Arista CLI"
    ],
    "impact": "Privilege escalation from a \"read-only\" user to root. An attacker can gain full control of the Arista switch through a reverse shell.",
    "attack_vectors": "Local access to an Arista switch with a TACACS+ configured \"read-only\" user. The attacker leverages pipe chaining within a permitted command (e.g., 'show version') to execute arbitrary code through the bash shell.",
    "required_capabilities": "The attacker needs valid credentials for a \"read-only\" user account managed by TACACS+ and local access to the Arista switch."
  },
  "affected_products": [
    "TACACS+ (specifically, tac_plus and its derivatives)",
    "Arista EOS versions < 4.23.1F"
  ],
    "additional_information": "Arista disputes the claim that the vulnerability is solely in their product, arguing it requires a combination of TACACS+ misconfiguration and their CLI flexibility. However, the author of the writeup believes Arista is still fundamentally at fault. The writeup includes details of a Metasploit module that can be used to test for this vulnerability. Workarounds include using Arista's built-in roles, modifying TACACS+ configurations to use include/exclude or remove pipe chaining."
}
```