The provided content details a Use-After-Free vulnerability in the `Gfx::doShowText` function of the `pdf2json` library.

- **Root cause of vulnerability:** The vulnerability is a Use-After-Free (UAF) error that occurs within the `Gfx::doShowText` function. This function attempts to access memory that has already been freed. The specific sequence of operations leading to the UAF involves the handling of font resources within a PDF file, particularly during the processing of XObjects and text drawing operations (`opShowText`). When a font resource is deallocated, a dangling pointer remains, and subsequent operations on this pointer leads to the crash.
- **Weaknesses/vulnerabilities present:** The core weakness is a use-after-free condition. This occurs due to improper handling of font resources and their lifecycles. Specifically, when `Gfx::popResources()` is called, the corresponding font resources are freed which may lead to a dangling pointer.
- **Impact of exploitation:** The exploitation of this vulnerability can cause a crash and program termination. An attacker could leverage this to potentially cause a denial-of-service by submitting a crafted PDF file. It can lead to an application crash which will lead to unavailability.
- **Attack vectors:** The attack vector involves processing a specially crafted PDF file. This file is designed to trigger the vulnerable code path in `Gfx::doShowText` function, leading to the use-after-free error.
- **Required attacker capabilities/position:** An attacker needs to be able to provide a crafted PDF file that will be processed by the vulnerable pdf2json library. This could be achieved through various means, such as a web application that processes PDF uploads or any environment where `pdf2json` is used to parse untrusted PDF content.