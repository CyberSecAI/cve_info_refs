The provided content relates to CVE-2020-19007.

**Root cause of vulnerability:**
The Halo blog application does not properly filter user-supplied input when handling blog comments. Specifically, the `content` field of a comment is not sanitized or encoded.

**Weaknesses/vulnerabilities present:**
- Stored Cross-Site Scripting (XSS): The application stores user-provided comments without proper sanitization, allowing an attacker to inject malicious JavaScript code into the database.

**Impact of exploitation:**
- When a user, including administrators, views the blog post containing the malicious comment, the injected JavaScript code executes in their browser within the application's context. This can lead to:
    - Stealing session cookies, which can be used for account takeover.
    - Redirecting the user to a malicious site.
    - Performing actions on behalf of the user.
    - Other malicious activities.

**Attack vectors:**
- An attacker submits a crafted comment containing malicious JavaScript within the `content` field to a blog post.

**Required attacker capabilities/position:**
- The attacker needs to be able to submit comments to the blog.
- The attacker does not need to be authenticated.

**Additional details:**
- The vulnerable code is located in `src/main/java/run/halo/app/controller/content/api/PostController.java`
- The specific payload used to trigger the vulnerability is `<img src=1 onerror=alert(/test/)>` in the comment's content field.
- The issue was fixed in pull request #677.
- The affected versions are Halo 1.2.0 and earlier.