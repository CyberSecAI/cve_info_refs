=== Content from www.seebug.org_f4c613c1_20250119_115744.html ===

![Seebug](/static/dist2/images/weixin-share-sm.jpg)

[![Knownsec-logo](/static/dist2/images/knownsec-logo.png)](https://www.knownsec.com?from=seebug_logo)
![](/static/dist2/images/line.png)
[![Seebug-logo](/static/dist2/images/seebug-logo2023.png?v=2)](/)

* [Index](/)
* [Submit Vulnerability](/contribute/vul)
* [Rank](/hackers)
* Market
  + [Exchange](/exchange/goods)
  + [Newest PoC](/vuldb/vulnerabilities?has_poc=true)
* [Search](/search/)* Community
    + [Pocsuite](http://pocsuite.org/)
    + [Ceye.io](http://ceye.io/)
    + [Paper](http://paper.seebug.org/)
    + [KCon](http://kcon.knownsec.com/)
    + [ZoomEye](https://www.zoomeye.org/)
  * About
    + [Data Statistics](/stat)
    + [Vul Market](/help/about)
    + [Develop Document](https://pocsuite.org/guide/what-is-pocsuite3.html)
    + [Guideline](/help/user_level)
    + [Feedback](/help/feedback)
    + [Help](/help/reward)

* [Login](/accounts/login/?next=/vuldb/ssvid-97883)
* [Register](/accounts/register?next=/vuldb/ssvid-97883)

Toggle navigation

* [Login](/accounts/login/?next=/vuldb/ssvid-97883)
* [Index](/)
* Reward and Rank
  + [Detail Reward List](/vuldb/reward/detail)
  + [PoC Reward List](/vuldb/reward/poc)
  + [Exchange](/exchange/goods)
  + [Rank](/hackers)
  + [Submit New Vulnerability](/contribute/vul)
* Vulnerability Database
  + [Vulnerability List](/vuldb/vulnerabilities)
  + [Component Categories](/appdir/)
  + [Vulnerability Category](/category/)
* [Search](/search/)
* [Data Statistics](/stat)
* [Paper](http://paper.seebug.org/)

# Jfinal cms Background directory traversal

 Follow
0

### Basic Fields

SSV ID:
[SSV-97883](/help/vul#ssv)

Find Time:
Unknown

Submit Time:
2019-03-29

Level:

Category:
[目录穿越](/category/path-traversal)

Component:
[Jfinal cms](/appdir/Jfinal%20cms)

Author:
Unknown

Submitter:
anonymous

CVE-ID：
Add

CNNVD-ID：
Add

CNVD-ID：
Add

ZoomEye Dork：
Add

### Source

### Detail

Contributor
anonymous
Got  0KB

## Jfinal cms Background directory traversal
### Introduction to Vulnerability
Jfinal cms, using the simple and powerful JFinal as the web framework, the template engine is beetl, the database uses mysql, front-end bootstrap, flat ui and other frameworks. Support multi-site, oauth2 authentication, account registration, password encryption, comments and replies, message prompts, website traffic statistics, article comments and pageview statistics, response management, rights management, etc. There is a directory traversal vulnerability in its background template management office.
### Vulnerability Impact
- <= v4.7.1
### Vulnerability Analysis
The vulnerability trigger point is in `com/jflyfox/modules/filemanager/FileManagerController.java`
```java
public void index() {
HttpServletRequest request = getRequest();
try {
request.setCharacterEncoding("UTF-8");
getResponse().setCharacterEncoding("UTF-8");
} catch (UnsupportedEncodingException e) {
e.printStackTrace();
}
FileManager fm = new FileManager(getRequest());
JSONObject responseData = null;
String mode = "";
String path = "";
boolean needPath = false;
boolean putTextarea = false;
if (!auth()) {
fm.error(fm.lang("AUTHORIZATION\_REQUIRED"));
} else {
String contextPath = request.getContextPath();
// 设置contextPath
fm.setGetVar("contextPath", contextPath);
mode = request.getParameter("mode");
path = request.getParameter("path");
if (path != null) {
try {
if (request.getMethod().equals("GET"))
path = new String(path.getBytes("ISO8859-1"), "UTF-8");
} catch (UnsupportedEncodingException e) {
e.printStackTrace();
}
needPath = fm.setGetVar("path", path);
}
if (request.getMethod().equals("GET")) {
if (mode != null && mode != "") {
if (mode.equals("getinfo")) {
if (needPath) {
responseData = fm.getInfo();
}
} else if (mode.equals("getfolder")) {
if (needPath) {
......
```
When the user's incoming mode is getfolder, you can call the `getfolder` method of `Filemanager` and follow `getFolder` of `com/jflyfox/modules/filemanager/FileManager.java`.
```java
public JSONObject getFolder() {
JSONObject array = null;
File dir = new File(getRealFilePath());
File file = null;
if (!dir.isDirectory()) {
this.error(sprintf(lang("DIRECTORY\_NOT\_EXIST"), this.get.get("path")));
} else {
if (!dir.canRead()) {
this.error(sprintf(lang("UNABLE\_TO\_OPEN\_DIRECTORY"), this.get.get("path")));
} else {
array = new JSONObject();
String[] files = dir.list();
JSONObject data = null;
JSONObject props = null;
for (int i = 0; i < files.length; i++) {
data = new JSONObject();
props = new JSONObject();
file = new File(getRealFilePath() + files[i]);
if (file.isDirectory() && !contains(getConfig("unallowed\_dirs"), files[i])) {
try {
props.put("Date Created", (String) null);
props.put("Date Modified", (String) null);
props.put("Height", (String) null);
props.put("Width", (String) null);
props.put("Size", (String) null);
data.put("Path", this.get.get("path") + files[i] + "/");
data.put("Filename", files[i]);
data.put("File Type", "dir");
data.put("Preview", getConfig("icons-path") + getConfig("icons-directory"));
// TODO 文件权限
data.put("Protected", 0);
data.put("Error", "");
data.put("Code", 0);
data.put("Properties", props);
array.put(this.get.get("path") + files[i] + "/", data);
} catch (JSONException e) {
this.error("JSONObject error");
}
} else if (!contains(getConfig("unallowed\_files"), files[i])) {
this.item = new HashMap<String, Object>();
this.item.put("properties", this.properties);
this.getFileInfo(getFilePath() + files[i]);
if (this.params.get("type") == null
|| (this.params.get("type") != null && (!this.params.get("type").equals("Image") || this.params
.get("type").equals("Image")
&& contains(getConfig("images"), (String) this.item.get("filetype"))))) {
try {
data.put("Path", this.get.get("path") + files[i]);
data.put("Filename", this.item.get("filename"));
data.put("File Type", this.item.get("filetype"));
// TODO 文件权限
data.put("Protected", 0);
data.put("Preview", this.item.get("preview"));
data.put("Properties", this.item.get("properties"));
data.put("Error", "");
data.put("Code", 0);
array.put(this.get.get("path") + files[i], data);
} catch (JSONException e) {
this.error("JSONObject error");
}
}
}
}
}
}
return array;
}
```
There is no restriction on the path passed by the user, which leads to directory traversal.
### Vulnerability recurrence
1. Login to the background
2. Click on Template Management
Http://localhost:8080/jfinal\_cms/admin/filemanager/list
Click home
![](https://images.seebug.org/1553855290207-w331s)
3. Use burpsuite to capture the path
![](https://images.seebug.org/1553855296681-w331s)
4. As you can see, the web directory has been jumped out.
![](https://images.seebug.org/1553855303664-w331s)
![Loading icon](/static/dist2/bower_components/loading/loading-bars.svg)

have 0  exchange

### PoC

Unavailable PoC

### Reference Linking

* <https://www.seebug.org>

### Solutions

**Temp Solutions**

Unavailable Temp Solutions

**Official Solution**

Unavailable Official solution

**Defense Solutions**

Unavailable Defense Solutions

Improve Solutions

BackSubmit

[![](/media/banner/2017/08/22/150338358279.png)](https://www.yunaq.com/)

[![](/media/banner/2020/05/26/159048249988.png)](https://www.yunaq.com/help/article?id=5ebcf0e3439fa500115a1326?from=seebugb00515)

[![](/media/banner/2017/08/09/150226089416.png)](https://scanv.yunaq.com/stcs/index.html?from=seebugb00526)

[![](/media/banner/2020/01/16/157914493733.png)](https://www.yunaq.com/dbzx?from=seebugb00115)

---

### Timeline

* 发现/披露了漏洞
* ![anonymous](/static/dist2/images/avatar.png)
  anonymous

  2019-03-29
  提交了漏洞
* ![anonymous](/static/dist2/images/avatar.png)
  anonymous

  2019-03-29
  提交补充了漏洞详情

---

### Related Vuls

* [jfinal CMS v5.1.0代码执行漏洞(CVE-2023-30349)](/vuldb/ssvid-99691)
* [Jfinal cms Backstage Site Management File Upload Vulnerability](/vuldb/ssvid-97897)
* [Jfinal cms Background Article Management Office File Upload Vulnerability](/vuldb/ssvid-97896)
* [Jfinal cms Background Image Management Office File Upload Vulnerability](/vuldb/ssvid-97895)
* [Jfinal cms Background Video Management Office File Upload Vulnerability](/vuldb/ssvid-97894)
* [Jfinal cms Background Template Management Office File Upload Vulnerability](/vuldb/ssvid-97893)
* [Jfinal cms Background Scrolling Image File Upload Vulnerability](/vuldb/ssvid-97892)
* [Jfinal cms Any file renamed in the background, Getshell](/vuldb/ssvid-97886)
* [Jfinal cms Any file deletion in the background](/vuldb/ssvid-97885)
* [Jfinal cms background arbitrary file read](/vuldb/ssvid-97884)

 Follow
0

Popularity
1405

0

![](/static/images/anonymous.jpg)
##### Need to bind phone before comment. [Bind Now](https://sso.telnet404.com/accounts/bind_phone/)

Submit Comment

 anonymous reply

#### Unavailable Comments

※Any content provided by this site, only to learn the code and services, not for illegal purposes

captcha![]()

OK
Back

×
#### Hello,

您的会员可兑换次数还剩：
次

本次兑换将消耗 1 次

Vulnerabilities

* [Vulnerability List](/vuldb/vulnerabilities)
* [Component Categories](/appdir/)
* [Vulnerability Category](/category/)

More

* [Reward List](/vuldb/reward/poc)
* [Rank](/hackers)

Help

* [About](/help/about)
* [Relevant Instructions](/help/user_level)
* [Vulnerability Definition](/help/vul)
* [Reward Plan](/help/reward)

Contact

* 010-57076191
* s1@seebug.org
* 15th Floor, Unit A, Tower 3, Wangjing SOHO, Fu'an West Road, Chaoyang District, Beijing 100102, P.R.China

Public links

* [Knownsec](https://www.knownsec.com/#/)
* [yunaq](https://www.yunaq.com/cyd/?from=cj_cyd_sbug)
* [创宇蜜罐-诱捕溯源](https://mg.yunaq.com/#/?from=seebuglink)
* [ScanV](https://www.scanv.com/?from=seebug)
* [hackernews](http://hackernews.cc/)

Follow Us

[![](https://aqyzmedia.yunaq.com/labels/label_sm_90040.png)](https://v.yunaq.com/certificate?domain=www.seebug.org&from=label)

[![](/static/dist2/images/ksz-kcon-new.svg)](http://kcon.knownsec.com/)

[![](/static/dist2/images/seebug-logo2023.png)](/)

[![](/static/dist2/images/ksz-zoomeye.svg)](https://www.zoomeye.org/)

[![](/static/dist2/images/yunaq-logo.png)](https://www.yunaq.com/?from=sbg0702)

[京ICP备10040895号](https://beian.miit.gov.cn/)
[![](/static/dist2/images/beian.png)
京公网安备 11010502034610号](http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010502034610)
Copyright @ 404 Team from Knownsec.
[简体中文](/accounts/language/?l=zh-cn)

×
#### Hello,

please call the customer service hotline to recharge, thank you for your continued support Seebug!

 010-57076191


