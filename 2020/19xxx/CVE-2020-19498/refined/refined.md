```
{
  "vulnerability_details": {
    "root_cause": "Integer divide by zero error in the Fraction constructor within the box.cc file.",
    "weaknesses": [
      "The `gcd` function might return zero, leading to a division by zero when constructing the fraction.",
      "Lack of proper checks before performing division operations."
    ],
    "impact": "Program termination due to a floating point exception (SIGFPE).",
    "attack_vectors": "Crafted HEIF file containing specific box parameters that trigger the divide-by-zero error in the Fraction constructor.",
    "required_capabilities": "Attacker needs to provide a specially crafted HEIF file that triggers the bug when parsed by libheif. The provided PoC requires the attacker to have knowledge about the structure of libheif to create the malformed input."
  },
  "fixes": [
    {
      "commit_hash": "2710c930918609caaf0a664e9c7bc3dce05d5b58",
      "description": "The commit addresses the issue by implementing a check for division by zero. The code change in `libheif/box.cc` limits the resolution of the fraction to prevent numerical edge cases. Specifically, a while loop is introduced to reduce the fraction's denominator and numerator by right bit shifting and dividing by 2 if it exceeds MAX_FRACTION_DENOMINATOR/MAX_FRACTION_VALUE, preventing subsequent divisions by zero."
    }
  ],
   "cve_id": "CVE-2020-19498"
}
```