=== Content from gitlab.com_ec07a334_20250119_123005.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Oauth Web Application Flow vulnerability

**[HackerOne report #743556](https://hackerone.com/reports/743556)** by `peet86` on 2019-11-21, assigned to [@jeremymatos](/jeremymatos "Jeremy Matos"):

> NOTE! Thanks for submitting a report! Please replace *all* the (parenthesized) sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!

### Summary

Authentication via Oauth2 Web application flow grants authorization code for non(email)verified users.

Gitlab doesn't care about the user's verification state, authorizes Oauth requests without checking the authenticity of the user's primary identifier (email).

* One can enter a non existing email address while sign up on Gitlab.com. (correct)
* At this point the user has a Gitlab account logged in on gitlab.com. The gitlab user is not yet (email) verified though. (correct)
* When the user requests Oauth authorization from a web application Gitlab authorizes it and claims the user is real. (vulnerability)
* After the redirect the Web application the user receives the authorization code without any warning, status. (vulnerability)

### Steps to reproduce

1. Start an Oauth Web Application Flow in an incognito window (no active gitlab sessions) from a previously registered oauth application.
2. Register a new Gitlab account with a non existing / fake email <https://gitlab.com/users/sign_in>
3. Gitlab authorizes the Oauth authorization request and returns with the authorization code.

### Impact

1. Gitlab Oauth authorizes non verified. possibly fake users with (possibly fake) email addresses.

   Eg. random@random.com, tim@apple.com
2. Gitlab claims tim@apple.com or random@random.com are valid users and returns with the email addresses when scope=read\_user+profile requested from a web app. (after the succesful authorization).
3. Gitlab as Oauth Provider compromises millions of web applications around the world. The vulnerability affects all Oauth clients which are trusting Gitlab as a social authentication provider. Many of these web applications expecting that Gitlab authorization fails with non-verified users and does not allow api access for user with possibly fake unique identifiers (email addresses).

### Examples

Not project related. Please just follow the steps above.

### What is the current *bug* behavior?

Oauth authorization SUCCESS.

### What is the expected *correct* behavior?

When a primary email address for a user account has not been verified, Oauth authorization should FAIL.

Similar Oauth flow on Github.com and many other Oauth providers fail. With those providers it's not possible to use not yet verified accounts for Oauth flows.

### Relevant logs and/or screenshots

1. * [Screenshot\_2019-11-21\_at\_17.32.21.png](https://h1.sec.gitlab.net/a/d17326ae-66a5-48d4-a3c2-3ccc41dd881d/Screenshot_2019-11-21_at_17.32.21.png)
2. * F640441
3. After click on Authorize the Oauth client app receives authorization code as query string.

### Output of checks

This bug happens on GitLab.com

#### Results of GitLab environment info

This bug happens on GitLab.com

## Impact

Please read Impact section in the description.

Also please note while this is not necessarily a security leak for Gitlab, many different type of account hijacking is possible in other Oauth dependent web applications which are trusting Gitlab as an Oauth Provider. Eg:

* The attacker registered with tim@apple.com on gitlab.com could hijack a user account which belongs to the real owner of tim@apple.com in a web application where social accounts are connected with (verified)email + password accounts.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_2019-11-21\_at\_17.32.48.png](https://h1.sec.gitlab.net/a/62398bae-c7ad-4a32-b0c8-237ced120e87/Screenshot_2019-11-21_at_17.32.48.png)
* [Screenshot\_2019-11-21\_at\_17.32.21.png](https://h1.sec.gitlab.net/a/d17326ae-66a5-48d4-a3c2-3ccc41dd881d/Screenshot_2019-11-21_at_17.32.21.png)

Edited May 19, 2020 by [Jeremy Watson (ex-GitLab)](/jeremy-gl)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_9838c9a1_20250119_123004.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13272.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13272.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13272.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13272.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Jun 22, 2020

  [e7d1e8ca](/gitlab-org/cves/-/commit/e7d1e8cac904950ddd4c9f21f080639fbe746419)
  [Publishing 17 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/e7d1e8cac904950ddd4c9f21f080639fbe746419)
  ·
  e7d1e8ca

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jun 22, 2020

  e7d1e8ca

  [Publishing 17 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/e7d1e8cac904950ddd4c9f21f080639fbe746419)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jun 22, 2020

Loading


