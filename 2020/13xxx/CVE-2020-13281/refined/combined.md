=== Content from gitlab.com_5eb6eb93_20250119_111036.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# ESCALATED: Decompression Bomb

**[HackerOne report #687730](https://hackerone.com/reports/687730)** by `u3mur4` on 2019-09-04, assigned to `jmatos_bgtvf`:

## Summary

A decompression bomb is a file designed to crash or render useless the program or system reading it, i.e. a denial of service.

An attacker can create a carefully crafted *tar.gz* file and upload it using the *Import an exported GitLab project* functionality. When the file is unpacked its contents are exploded and it fills the drive.

## Steps to reproduce

* Download the [![100gb.tar.gz](data:image/gif;base64...)](https://user-content.gitlab-static.net/e85efc1f8d12c1e4f5b0cc523c8b2708c50c5b98/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34653333663433352d333762352d343762642d623466612d6661356663613761666562392f31303067622e7461722e677a) file (100MB)
* Sign in to a GitLab instance
* Create (Import) a New Project using the *Import an exported GitLab project*
* Set the *GitLab project export file* form field to the previously download [![100gb.tar.gz](data:image/gif;base64...)](https://user-content.gitlab-static.net/e85efc1f8d12c1e4f5b0cc523c8b2708c50c5b98/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34653333663433352d333762352d343762642d623466612d6661356663613761666562392f31303067622e7461722e677a) file
* Click to *Import Project* and wait until it's finished
* Repeat this process until the disk is full
* When the disk is full multiple functionality becomes unavailable (See Video and Impact)

Video version:

[bomb.mp4](https://user-content.gitlab-static.net/af1ae472f92e507b494874a8c1f1d1469bcb7192/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34366562346135392d623362622d343662652d396130652d6263613764363235643137382f626f6d622e6d7034 "Download 'bomb.mp4'")

## How to create the decompression bomb file

You can create the compressed file yourself using couples of bash commands

```
fallocate -l 100G 100gb.zeros
tar cvf - 100gb.zeros | gzip -9 - > 100gb.tar.gz
```

I created a short *go* program [![main.go](data:image/gif;base64...)](https://user-content.gitlab-static.net/bafa635dd052d3620874d5a788920b6562a43f9f/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f35313136373165612d653733322d346361342d383033632d6536373439643036356331352f6d61696e2e676f) to create the compressed file without any intermediate file. The program also sets the modification time inside the tar file to a future date because of the following bug/behavior:

The `ImportExportProjectCleanupWorker` runs every hour and deletes the uncompressed files where the modification time is older than 1 day. Because we set the modification time to a future date inside the tar archive the uncompressed data will be *never* deleted.

```
stat -c '%y' big_file
2020-09-03 21:44:51.000000000 +0200
```

## Impact

* Random 500 errors
* Unable to create/import new projects
* Unable to create issues
* Unable to push git changes
* Unable to upload any file: file avatar, project avatar
* Unable to access the whole site
* etc...

## What is the current *bug* behavior?

* no size check before decompression
* tar sets the modification time of the file

## What is the expected *correct* behavior?

* Limit the maximum file size (`gzip -l 100gb.tar.gz` to get the uncompressed size)
* Use the *-m, --touch* flag to don't extract file modified time

#### GitLab version info

omnibus-gitlab package: GitLab Community Edition 12.2.4

gitlab-development-kit: GitLab Community Edition 12.3.0-pre gitlab-ce@f4e40c532b5582f47a0dd9bf7054112fc9ec6085

gitlab.com: not tested because of dos

## Impact

* Random 500 errors
* Unable to create/import new projects
* Unable to create issues
* Unable to push git changes
* Unable to upload any file: file avatar, project avatar
* Unable to access the whole site
* etc...

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [bomb.mp4](https://h1.sec.gitlab.net/a/46eb4a59-b3bb-46be-9a0e-bca7d625d178/bomb.mp4)
* [main.go](https://h1.sec.gitlab.net/a/511671ea-e732-4ca4-803c-e6749d065c15/main.go)
* [100gb.tar.gz](https://h1.sec.gitlab.net/a/4e33f435-37b5-47bd-b4fa-fa5fca7afeb9/100gb.tar.gz)

Edited Dec 13, 2019 by [GitLab SecurityBot](/gitlab-securitybot)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_69019d53_20250119_111035.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13281.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13281.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13281.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13281.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  Apr 28, 2021

  [2086a3b3](/gitlab-org/cves/-/commit/2086a3b31d4d748d9f092ff4ea1b8e374496c534)
  [Publishing 13 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/2086a3b31d4d748d9f092ff4ea1b8e374496c534)
  繚
  2086a3b3

  [ GitLab Bot ](/gitlab-bot) authored Apr 28, 2021

  2086a3b3

  [Publishing 13 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/2086a3b31d4d748d9f092ff4ea1b8e374496c534)
  [ GitLab Bot ](/gitlab-bot) authored Apr 28, 2021

Loading


