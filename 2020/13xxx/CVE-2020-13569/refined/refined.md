- **Root cause of vulnerability**: The vulnerability is due to a missing CSRF protection in the phpGACL interface of OpenEMR. Specifically, the CSRF checks are missing across all the pages defined by phpGACL in the `/gacl/` subdirectory.
- **Weaknesses/vulnerabilities present**:
    - Cross-Site Request Forgery (CSRF) vulnerability in the phpGACL interface.
    - This vulnerability can be chained with SQL injection and XSS vulnerabilities in phpGACL (described in TALOS-2020-1179 and TALOS-2020-1177 respectively).
    - The lack of `httpOnly` flag in OpenEMR's session cookie further enables session stealing via XSS.
- **Impact of exploitation**:
    - An attacker can execute arbitrary requests in the context of a logged-in OpenEMR admin.
    - By chaining with SQL injection, an attacker can steal admin credentials or execute arbitrary queries in the database.
    - By chaining with XSS, an attacker can steal session cookies, potentially gaining full control of the admin account.
- **Attack vectors**:
    - An attacker can create a malicious web page that, when visited by a logged-in OpenEMR admin, triggers a POST request to the vulnerable phpGACL pages.
    - An attacker can send a link to the admin containing malicious XSS payload.
- **Required attacker capabilities/position**:
    - The attacker needs to be able to entice or force a logged-in OpenEMR admin to visit a malicious web page or click a crafted link.
    - The attacker needs to know the target OpenEMR instance URL.