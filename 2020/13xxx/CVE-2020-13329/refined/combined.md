=== Content from gitlab.com_16c4a2b2_20250119_121702.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13329.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13329.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13329.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13329.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  Sep 29, 2020

  [1f1b165c](/gitlab-org/cves/-/commit/1f1b165c912104481441d651721564df929f4819)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/1f1b165c912104481441d651721564df929f4819)
  繚
  1f1b165c

  [ GitLab Bot ](/gitlab-bot) authored Sep 29, 2020

  1f1b165c

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/1f1b165c912104481441d651721564df929f4819)
  [ GitLab Bot ](/gitlab-bot) authored Sep 29, 2020

Loading



=== Content from gitlab.com_1cc9abc1_20250119_121703.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stored XSS in blob viewer

**[HackerOne report #806571](https://hackerone.com/reports/806571)** by `yvvdwf` on 2020-02-27, assigned to [@jeremymatos](/jeremymatos "Jeremy Matos"):

### Summary

I found a Stored-XSS in blob viewer when viewing a json file.

In particular, when viewing an openapi file, [openapi\_viewer](https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/blob/viewer/index.js#L43) is called to transfer the file's data to [SwaggerUIBundle](https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/blob/openapi/index.js#L10) to render.

SwaggerUIBundle does its job when rending graphical representation of the openapi's content. It also allows *html tags and attributes* in the description of the openapi. Although it removes malicious tags and attributes, but this is not enough in gitlab's context:

1. `class` and `style` attributes allow attackers to arbitrarily present their disposition. My demo below uses `class` attribute to create a transparent layer that fulfils the document to intercept any user's clics.
2. `data-*` attributes, under the help of [jquery-ujs](https://gitlab.com/gitlab-org/gitlab/-/blob/master/package.json#L90), allows attackers to create any requests to server when user clicking (not only `GET`, but also, `PUT`, `DELETE`, `HEAD`) with arbitrary parameters
3. The current CSP is easily by passed by [jQuery.globalEval](https://gitlab.com/gitlab-org/gitlab/-/blob/master/app/assets/javascripts/main.js#L54). In my demo below, you should see an `alert` after clicking anywhere

### Steps to reproduce

1. In any project, create a file naming `xss-openapi.json`, then put the following content:

```
{
  "swagger" : "2.0",
  "info" : {
    "description" : "<a href=https://gitlab.com/yvvdwf/data/-/wikis/alert.md data-type=script style='cursor:default' data-remote=true class='atwho-view select2-drop-mask pika-select'></a><script>alert(0)</script>"
  }}
```

2. Click anywhere on the document view, you should see an alert.

### Impact

There are three impacts as in the Summary above. The most important impact is the stored-XSS allowing attackers to perform any action on behalf of users at the client side.

### Examples

(This repository is in private mode, please let me know if you cannot access it)

<https://gitlab.com/yvvdwf/xss/-/blob/master/xss-openapi.json>

### What is the current *bug* behavior?

Gitlab does not check the result generated by SwaggerUIBundle

### What is the expected *correct* behavior?

Should remove any inappropriate html attributes, such as, `data-*`, `style`, `class`.

### Output of checks

This bug happens on GitLab.com

## Impact

The stored-XSS allows attackers to perform any action on behalf of users at the client side.

Edited Jun 01, 2020 by [Nick Thomas](/nick.thomas)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


