=== Content from gitlab.com_33bc3936_20250119_113210.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13314.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13314.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13314.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13314.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Sep 12, 2020

  [a97854be](/gitlab-org/cves/-/commit/a97854be1b20d84223636b3c6ec47c7698bb4c34)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/a97854be1b20d84223636b3c6ec47c7698bb4c34)
  ·
  a97854be

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Sep 12, 2020

  a97854be

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/a97854be1b20d84223636b3c6ec47c7698bb4c34)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Sep 12, 2020

Loading



=== Content from gitlab.com_b42f9bef_20250119_113211.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Omniauth `google\_auth2/omniauth\_error` endpoint renders arbitrary error message

**[HackerOne report #438746](https://hackerone.com/reports/438746)** by h33t on 2018-11-10:

Hi,

While testing gitlab i have come across a bug where it seemed like users can get manipulated or malicious message could be spread by that vulnerable URL.

Content spoofing is a type of exploit used by a malicious hackers to present a faked or modified Web site to the user as if it were legitimate. The intent is, typically, to defraud victims although sometimes the purpose is simply to misrepresent an organization or an individual.

URL: <https://gitlab.com/users/auth/google_oauth2/omniauth_error?error=Please+Go+To+Evil.com+This+Site+Is+Broken>

#Reproduction Steps

* Access the URL
* In the error parameter put your message.

## Impact

One thing i have thought of this attack is that attackers might try to publish such url in google using seo so then you dont need to send it to a specific user to show the message. If they can publish it on search engines easily a lot of users will get the malicious message of the attacker.

---

From the Security Department:

Fixed error messages should be displayed for valid error codes from the OAuth specification, any invalid error code should render a "Invalid error code received" or other generic error message.

Edited Aug 12, 2020 by [Drew Blessing](/dblessing)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


