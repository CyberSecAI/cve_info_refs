=== Content from gitlab.com_a9466d28_20250119_114229.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13331.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13331.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13331.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13331.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ðŸ¤– GitLab Bot ðŸ¤–'s avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "ðŸ¤– GitLab Bot ðŸ¤–")](/gitlab-bot)

  Sep 29, 2020

  [8d883df4](/gitlab-org/cves/-/commit/8d883df4cfd7b87188eea9b8b53b67346668fb27)
  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/8d883df4cfd7b87188eea9b8b53b67346668fb27)
  Â·
  8d883df4

  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Sep 29, 2020

  8d883df4

  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/8d883df4cfd7b87188eea9b8b53b67346668fb27)
  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Sep 29, 2020

Loading



=== Content from gitlab.com_b8d163e6_20250119_114230.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Unrestricted file upload leads to Stored XSS

**[HackerOne report #880099](https://hackerone.com/reports/880099)** by `semsem123` on 2020-05-21, assigned to [@vdesousa](/vdesousa "Vitor Meireles De Sousa"):

### Summary

i found that i can upload png file with JavaScript code and execute it in wiki page.

### Steps to reproduce

(Step-by-step guide to reproduce the issue, including:)

1-login to gitlab account

2-open your project

3-open Wiki page.

4-Click "New page" button.

5-attach png file which contain below code

`<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg onload="alert(1)" xmlns="http://www.w3.org/2000/svg"> <polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/> </svg>`

6-Click "Create page" button.

7-Click on green triangle

8-if The alert dialog not appears from first time just click on it one more time

### Impact

If wiki pages created by using this vulnerability are visible to everyone (Wiki Visibility setting is set to "Everyone With Access") in "Public" project, there is a possibility that a considerable number of GitLab users and visitors click a malicious link.

### Examples

gitlab.com

tested on Google Chrome

<https://gitlab.com/semsemhacker123/semsemtest/-/wikis/ssaa-home>

<https://gitlab.com/semsemhacker123/semsemtest/-/wikis/uploads/1308853a75502f77b3e22a2f9b0cc88a/1111111.png>

### What is the current *bug* behavior?

The alert dialog appears after clicking "green triangle " in created page.

### What is the expected *correct* behavior?

the png file it must be not executed as `image/svg+xml`

## Impact

An attacker can use XSS to send a malicious script to an unsuspecting user. The end userâ€™s browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [1111111.png](https://h1.sec.gitlab.net/a/9306d9df-c113-44fe-8350-5a07492c313e/1111111.png)
* [gitlab\_poc.png](https://h1.sec.gitlab.net/a/3f35d285-1743-47c7-ab61-93963cbd30e5/gitlab_poc.png)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


