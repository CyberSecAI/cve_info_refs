=== Content from gitlab.com_5f8453dd_20250119_111900.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# SSRF via repository mirror URL

**[HackerOne report #860196](https://hackerone.com/reports/860196)** by `sky003` on 2020-04-27, assigned to [@jeremymatos](/jeremymatos "Jeremy Matos"):

### Summary

SSRF protection can be bypassed by using malformed git repository URL. URL format:

```
git://localhost:[port]/[controlled-payload]@[legit-host]/
Example: git://localhost:1234/whatever-you-want@example.com/
```

### Steps to reproduce

\_1. Log into the gitlab server and start TCP listener on port 1234 ($ nc -vvlp 1234).

\_2. Open "Settings" > "Repository" > "Mirroring repositories" and use the following payload to create a mirror:

```
Git repository URL: git://localhost@example.com/
Password: 1234/some-path?some-query=some-val#
```

[![mirroring-repositories-page.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/bf831f9d5bc2dc6a5a780908bf5eb6cac43da453/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61393739336632662d343938342d343139342d396133332d3835336534373137643438642f6d6972726f72696e672d7265706f7369746f726965732d706167652e706e67)

\_3. Trigger an update for the mirror you created.

[![trigger-mirror-update.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/8cbaaaf4006cd5afaf93094a40d35ea0e0cdfa49/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f34313430636531642d326165322d346464632d386665652d3637363561663039306138362f747269676765722d6d6972726f722d7570646174652e706e67)

\_4. Check TCP listener. You should see the incoming connection.

[![ssrf2.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/8f9c7b8cf9ccdac06e3e06394f2e4f2d538c5d25/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f39333338333539392d396430342d346634662d383231362d3536663932653763363261342f73737266322e706e67)

### Impact

Malicious user can establish TCP connection with local/internal network resources. For the most cases it's gonna be a blind SSRF (malicious user can read some git output from repository mirror update status, which is an error message).

### What is the current *bug* behavior?

There's URL parsing differentials with gitlab app and git.

### What is the expected *correct* behavior?

Since "git" protocol is not designed to have any authentication mechanism, I guess the URL part which contains the credentials can be safely removed.

## Impact

Malicious user can establish TCP connection with local/internal network resources. For the most cases it's gonna be a blind SSRF (malicious user can read some git output from repository mirror update status, which is an error message).

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [ssrf2.png](https://h1.sec.gitlab.net/a/93383599-9d04-4f4f-8216-56f92e7c62a4/ssrf2.png)
* [trigger-mirror-update.png](https://h1.sec.gitlab.net/a/4140ce1d-2ae2-4ddc-8fee-6765af090a86/trigger-mirror-update.png)
* [mirroring-repositories-page.png](https://h1.sec.gitlab.net/a/a9793f2f-4984-4194-9a33-853e4717d48d/mirroring-repositories-page.png)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_f0f09211_20250119_111859.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13309.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13309.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13309.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13309.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Sep 12, 2020

  [b2bfe393](/gitlab-org/cves/-/commit/b2bfe393c897c47fca90fe7f30535a7cc9217e0d)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/b2bfe393c897c47fca90fe7f30535a7cc9217e0d)
  ·
  b2bfe393

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Sep 12, 2020

  b2bfe393

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/b2bfe393c897c47fca90fe7f30535a7cc9217e0d)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Sep 12, 2020

Loading


