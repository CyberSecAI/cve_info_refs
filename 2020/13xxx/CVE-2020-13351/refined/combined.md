=== Content from gitlab.com_23e6e175_20250119_111020.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Unauthorized user is able to access schedule pipeline variables and values

**[HackerOne report #962462](https://hackerone.com/reports/962462)** by `vaib25vicky` on 2020-08-19, assigned to [@dcouture](/dcouture "Dominic Couture"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

The feature allows to add or overwrite variables that are passed to jobs in order to modify the behavior just for that specific instance.

As per this [gitlab-foss#32568 (comment 32531510)](https://gitlab.com/gitlab-org/gitlab-foss/-/issues/32568#note_32531510 "Adding variables to pipelines schedules") , the current security model is

>If you are owner of schedule (as developer) or master => you can read, modify and delete,

If you are developer => you can just list, not read,

>This allows only owners and masters to read variables assigned to the schedule. It prevents other developers from hijacking schedules, but allows master to fully control them. Master already has access to Secret Variables.

But api endpoints are cleary showing this values to everyone even if the user is not part of the project. <https://docs.gitlab.com/ee/api/pipeline_schedules.html#get-a-single-pipeline-schedule>

##### PoC

This is my test project <https://gitlab.com/thevicc/trigg> with schedule pipeline which custom variables you can't read.

Now, run this to read the variable and its value

`curl --header &#34;Private-Token: &lt;your_access_token&gt;&#34; https://gitlab.com/api/v4/projects/20618145/pipeline_schedules/69918`

Response

[![poc_var.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/d72c19bf5ebfca423c00c8149068c615c44112a5/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33333838613338652d626333382d343265382d383163332d3766613161663535613332312f706f635f7661722e706e67)

##### Steps to reproduce

* Create a project and add a schedule pipeline with custom variables
* Only you or owner can read variables
* As second account, use the api `https://docs.gitlab.com/ee/api/pipeline_schedules.html#get-a-single-pipeline-schedule`

#### Impact

This bug allows unauthorized users to read scheduled pipeline custom variables and values. As per security model, this allows other devs to hijack schedules.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [poc\_var.png](https://h1.sec.gitlab.net/a/3388a38e-bc38-42e8-81c3-7fa1af55a321/poc_var.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

1. Visit this link while logged in you'll see the variables (names and values) for a scheduled pipeline in a project you're not a member of <https://gitlab.com/api/v4/projects/20667559/pipeline_schedules/70235>

Edited Aug 21, 2020 by [Dominic Couture](/dcouture)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_496e4e82_20250119_111019.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13351.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13351.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13351.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13351.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Nov 17, 2020

  [9573651e](/gitlab-org/cves/-/commit/9573651ee3147267f13ccb792075c03e093d29ee)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/9573651ee3147267f13ccb792075c03e093d29ee)
  ·
  9573651e

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Nov 17, 2020

  9573651e

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/9573651ee3147267f13ccb792075c03e093d29ee)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Nov 17, 2020

Loading


