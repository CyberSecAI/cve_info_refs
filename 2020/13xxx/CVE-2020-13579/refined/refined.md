- **Root cause of vulnerability**: An integer overflow in the parsing of PlanMaker document records of type 0x8011 or 0x820a. A uint32_t value from the record is multiplied by 8, and if this result overflows, it leads to an undersized heap allocation. Subsequently, when data is copied into this undersized buffer, a heap-based buffer overflow occurs.
- **Weaknesses/vulnerabilities present**:
  - Integer Overflow (CWE-190) when calculating the size of the buffer, due to the multiplication of a user-provided uint32_t by 8.
  - Heap-based buffer overflow when copying data from the record into an undersized heap allocation, leading to memory corruption.
- **Impact of exploitation**: Memory corruption leading to potential arbitrary code execution under the context of the application.
- **Attack vectors**: A specially crafted PlanMaker document (.pmd file) with malicious record types (0x8011 or 0x820a) containing a specific uint32_t value to trigger the overflow during parsing.
- **Required attacker capabilities/position**: The attacker needs to entice the victim to open a specially crafted document to trigger this vulnerability. This could be achieved by sending the document via email or hosting it on a malicious website.