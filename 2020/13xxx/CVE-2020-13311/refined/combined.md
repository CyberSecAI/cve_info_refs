=== Content from gitlab.com_a028f6ee_20250119_121525.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# DoS on wiki page: uneditable pages

**[HackerOne report #907260](https://hackerone.com/reports/907260)** by `yvvdwf` on 2020-06-24:

Dear team,

I found a similar bug as the one in being reported [here](https://gitlab.com/gitlab-org/gitlab/-/issues/210566 "DOS on WIKI pages (Creating uneditable pages)") with the same impact: once being created, the page cannot be modified or deleted via website's interface.

### Steps to reproduce

1. Create a new wiki page.
2. In the Title filed, fill `~/test`
3. Content can be anything
4. Click `Create page` button

The page being created has the path `var/opt/gitlab/test` (instead of `~/test`). The page cannot be neither modified, nor deleted via web's interface.

### Impact

### What is the current *bug* behavior?

The tile character `~` is translated into `/var/opt/gitlab`

### What is the expected *correct* behavior?

The tile character should not be translated

### Output of checks

This bug happens on GitLab.com

## Impact

Once being created, the wiki page cannot be neither modified, nor deleted via web's interface.

### Todo

* Security fix in Gitaly: <https://gitlab.com/gitlab-org/security/gitlab/-/issues/207>
* Fix in upstream `gollum-lib` gem: <https://github.com/gollum/gollum-lib/pull/385>
* Fix in forked `gitlab-gollum-lib` gem

Edited Oct 06, 2020 by [Markus Koller](/toupeira)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_549ec37f_20250119_121523.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13311.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13311.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13311.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13311.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Sep 12, 2020

  [6dd4a63b](/gitlab-org/cves/-/commit/6dd4a63b0f0636619bdb5ba1cae8faae918b238b)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/6dd4a63b0f0636619bdb5ba1cae8faae918b238b)
  ·
  6dd4a63b

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Sep 12, 2020

  6dd4a63b

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/6dd4a63b0f0636619bdb5ba1cae8faae918b238b)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Sep 12, 2020

Loading



=== Content from gitlab.com_97ab9bfb_20250119_121524.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Wiki doesn't handle "~" in page paths correctly

### Summary

When using a `~` in a wiki page title, we create a `~` directory in the wiki repository and store the page there, but the `~` is expanded to the GitLab user's home directory `/var/opt/gitlab` in some situations.

### Steps to reproduce

1. Create a wiki page with the title `~/test` and some content.

### What is the current *bug* behavior?

* In the wiki sidebar navigation, the page's directory gets displayed as `var/opt/gitlab`.
* Opening the page uses the expanded directory in the URL.
* When trying to delete the page, GitLab aborts with a 503 error.
* When trying to edit the page, GitLab responds with a validation error `Someone edited the page the same time you did`.

### What is the expected *correct* behavior?

* We should never expand `~` into the home directory, and display it as a literal `~` instead.
* Editing and deleting a page with `~` in the path or title should work without errors.

### Relevant logs and/or screenshots

Customer ticket: <https://gitlab.zendesk.com/agent/tickets/148330>

Wrong path in sidebar:

[![image](data:image/gif;base64...)](/-/project/278964/uploads/e1496c87b8b94576c568d7101c94fd5f/image.png)

### Output of checks

This bug happens on GitLab.com

### Possible fixes

(If you can, link to the line of code that might be responsible for the problem)

Edited Mar 02, 2020 by [Markus Koller](/toupeira)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


