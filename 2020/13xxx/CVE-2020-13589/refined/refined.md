- **Root cause of vulnerability**: Improper sanitization of user-supplied input within SQL queries. Specifically, the `entities_id` parameter in the `entities/fields` page is vulnerable to SQL injection.
- **Weaknesses/vulnerabilities present**: SQL injection vulnerability in the `entities_id` parameter, which is used in multiple functions (`mulitple_edit`, `export`, or `copy_selected`) on the `entities/fields` page. The application fails to sanitize the input before using it in a database query.
- **Impact of exploitation**: An attacker can execute arbitrary SQL queries by injecting malicious SQL code via the `entities_id` parameter. This could lead to unauthorized data access, modification, or deletion.
- **Attack vectors**:
    - The vulnerability is triggered by crafting a malicious POST request to the `/crm/index.php?module=entities/fields` endpoint with a specific action parameter (`mulitple_edit`, `export`, or `copy_selected`) and including SQL injection in the `entities_id` parameter.
    - The attacker can exploit the vulnerability via an authenticated HTTP request using administrator credentials or through cross-site request forgery.
- **Required attacker capabilities/position**:
    - The attacker must be able to make authenticated HTTP requests to the vulnerable application.
    - The attacker needs either administrator credentials or the ability to exploit the vulnerability via cross-site request forgery.