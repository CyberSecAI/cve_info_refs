=== Content from gitlab.com_33733ce6_20250119_124113.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13264.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13264.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13264.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13264.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Jun 22, 2020

  [e7d1e8ca](/gitlab-org/cves/-/commit/e7d1e8cac904950ddd4c9f21f080639fbe746419)
  [Publishing 17 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/e7d1e8cac904950ddd4c9f21f080639fbe746419)
  ·
  e7d1e8ca

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jun 22, 2020

  e7d1e8ca

  [Publishing 17 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/e7d1e8cac904950ddd4c9f21f080639fbe746419)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jun 22, 2020

Loading



=== Content from gitlab.com_3c290d5e_20250119_124114.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Kubernetes cluster token visible for all-level clusters

**[HackerOne report #702796](https://hackerone.com/reports/702796)** by `xanbanx` on 2019-09-27, assigned to [@cmaxim](/cmaxim "Costel Maxim"):

Hi GitLab Security Team,

### Summary

GitLab allows to add group-level Kubernetes clusters. This allows to add exisiting cluster by adding a cluster URL and a token. However, this token is not properly masked allowing everyone who can visit the cluster page to also get the Kubernetes cluster token. So everyone who is in possession of the token als get full access to the cluster.

### Steps to reproduce

Tested on GitLab Enterprise Edition 12.3.0-pre [2d096e82](/gitlab-org/gitlab/-/commit/2d096e8234d47a1fd9f2c35cf560cdb6080dbfcc "Merge branch 'revert-744cb32e' into 'master'")

1. Create a group and go to `https://example.gitlab.com/groups/<group-name>/-/clusters`
2. Click on `Add existing Cluster`
3. Fill in Kubernetes cluster name: `Test`, API URL: `https://foo.bar`, Service Token: `My Secret Token` and save the page
4. Now scroll below to `Kubernetes cluster details`. Here, you see the Service token being masked. However, you can reveal the the token by clicking on `Show` on the right side.

Now the Kubernetes token is leaked.

### Impact

Kubernetes cluster token being leaked after entered to to GitLab. This allows anyone to visit the Cluster page to steal the cluster token.

### What is the current *bug* behavior?

Kubernetes cluster token canc be revealed in Kubernetes integration.

### What is the expected *correct* behavior?

Once the Kubernetes cluster token is entered, you cannot reveal it again, so remove the `Show` button.

### Output of checks

This bug happens on GitLab.com

Best regards,

Xanbanx

## Impact

See above.

Edited Dec 20, 2019 by [Daniel Gruesso](/danielgruesso)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


