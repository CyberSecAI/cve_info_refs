=== Content from gitlab.com_f9c5b77b_20250119_123927.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stored XSS on the job page

**[HackerOne report #856554](https://hackerone.com/reports/856554)** by `mike12` on 2020-04-22:

Hello Gitlab!

### Steps to reproduce:

1. Run Gitlab `docker run --detach --hostname gitlab.example.com --publish 443:443 --publish 80:80 --publish 22:22 --name gitlab gitlab/gitlab-ce:latest`
2. Create a new project with README.md
3. Go to Operations->Kubernetes

   1. Click on the "Add Kubernetes cluster" button
   2. Select the "Add existing cluster" tab
   3. Kubernetes cluster name: cluster-example
   4. API URL: <https://google.com>
   5. Service Token: token-example
   6. Uncheck the "GitLab-managed cluster" checkbox
   7. Click on the "Add Kubernetes cluster" button
4. Add ".gitlab-ci.yml" file to the repository (to the master branch)

   ```
   deploy:
     stage: deploy
     script:
       - echo "Example"
     environment:
       name: production
       url: https://google.com
       kubernetes:
         namespace: <img src=x onerror=alert(1)>
     only:
     - master
   ```
5. Go to CI/CD->Jobs and open the last job

   [![1.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/6c1a80fb98b5006c036d0c4b3654f8940f25dfea/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f32353861313337362d666333372d343336632d623764662d3333316166316135373065302f312e706e67)

   [![2.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/2c8db5d38cf00e6de0014aa35198455656d23745/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64343539653032612d353063302d346234382d613935352d3565303062343331366230312f322e706e67)

#### Vulnerable code

All vulnerable code is in one file [environments\_block.vue](https://gitlab.com/gitlab-org/gitlab/-/blob/c2da59f0376ee8d99ce16100d5c481234bbf9f8a/app/assets/javascripts/jobs/components/environments_block.vue)

1. [Line 125](https://gitlab.com/gitlab-org/gitlab/-/blob/c2da59f0376ee8d99ce16100d5c481234bbf9f8a/app/assets/javascripts/jobs/components/environments_block.vue#L125)
2. [Line 156](https://gitlab.com/gitlab-org/gitlab/-/blob/c2da59f0376ee8d99ce16100d5c481234bbf9f8a/app/assets/javascripts/jobs/components/environments_block.vue#L156)
3. [Line 251](https://gitlab.com/gitlab-org/gitlab/-/blob/c2da59f0376ee8d99ce16100d5c481234bbf9f8a/app/assets/javascripts/jobs/components/environments_block.vue#L251)
4. And other places where `%{kubernetesNamespace}` is used

## Impact

An attacker can:

1. Perform any action within the application that a user can perform
2. Steal sensitive user data
3. Steal user's credentials

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [1.png](https://h1.sec.gitlab.net/a/258a1376-fc37-436c-b7df-331af1a570e0/1.png)
* [2.png](https://h1.sec.gitlab.net/a/d459e02a-50c0-4b48-a955-5e00b4316b01/2.png)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_151354dd_20250119_123927.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13288.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13288.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13288.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13288.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Aug 11, 2020

  [1c24e567](/gitlab-org/cves/-/commit/1c24e56737cf0e8234ac9263fd3f81c2e185fad5)
  [Publishing 3 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/1c24e56737cf0e8234ac9263fd3f81c2e185fad5)
  ·
  1c24e567

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Aug 11, 2020

  1c24e567

  [Publishing 3 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/1c24e56737cf0e8234ac9263fd3f81c2e185fad5)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Aug 11, 2020

Loading


