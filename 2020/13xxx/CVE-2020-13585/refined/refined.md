- **Root cause of vulnerability**: The vulnerability lies in the `psd_header_processing` function of Accusoft ImageGear, where a missing check on the allocation size leads to a heap-based out-of-bounds write. Specifically, the size of a buffer is calculated using a value from the PSD file, and when the bit depth is zero, a zero size allocation is performed, which in turn can lead to a very small (1 byte) allocation on Windows. Subsequent writes to this buffer, controlled by another value from the file can trigger a heap overflow.
- **Weaknesses/vulnerabilities present**:
  - **CWE-131**: Incorrect Calculation of Buffer Size. The calculation of the buffer size doesn't account for a zero bit depth leading to a too small allocation.
  - **Heap-based out-of-bounds write**: The program writes to the buffer without properly checking the allocated size.
- **Impact of exploitation**: A specially crafted PSD file can cause a heap-based out-of-bounds write, leading to memory corruption. This can potentially result in arbitrary code execution.
- **Attack vectors**: An attacker can exploit this vulnerability by providing a malicious PSD file to a vulnerable application that uses the Accusoft ImageGear library.
- **Required attacker capabilities/position**: The attacker needs to be able to supply a crafted PSD file to be processed by the vulnerable application.