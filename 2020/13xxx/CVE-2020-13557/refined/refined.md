- **Root cause of vulnerability**: A use-after-free vulnerability exists in the JavaScript engine of Foxit PDF Reader. The vulnerability is triggered when a `choiceField` form element is manipulated with JavaScript code. Specifically, deleting an item from the choice field triggers a `Keystroke` event handler which then calls `clearItems`. The `clearItems` function frees the memory associated with choice field objects while the event handler is still being processed, resulting in a use-after-free condition.
- **Weaknesses/vulnerabilities present**: Use-after-free vulnerability (CWE-416). The program attempts to access memory that has already been freed.
- **Impact of exploitation**: Arbitrary code execution. By manipulating the freed memory after it's freed and then reaccessed through the `this` pointer in the event handler, an attacker can gain control of the execution flow.
- **Attack vectors**: A specially crafted PDF document or visiting a malicious site with the browser plugin extension enabled can trigger the vulnerability.
- **Required attacker capabilities/position**: The attacker needs to trick the user into opening a malicious PDF document or visiting a malicious website with the Foxit PDF Reader browser plugin enabled.