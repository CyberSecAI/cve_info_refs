=== Content from gitlab.com_fbc14c41_20250119_114830.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Malicious user can block gitlab.com users by exploiting 2FA inheritance logic

**[HackerOne report #637675](https://hackerone.com/reports/637675)** by `marshall0705` on 2019-07-08, assigned to `estrike`:

### Summary

2FA inheritance can be manipulated to indefinitely block users' access to gitlab.com

### Steps to reproduce

1. Top level group [A] has 2FA enforced
2. Child subgroup [B] also has 2FA enforced (should be irrelevant however, due to inheritance)
3. Child subgroup [C] (should be irrelevant, was just used to contain tests, no explicit 2FA requirement)
4. Project [D] in subgroup (inherited 2FA from [A] and [B])
5. UserX added to [D] only, never added to groups

   Structure: `A / B / C / D`

Theoretically the following structure should also exhibit the same behaviour: `A / D`

6. Log in with UserX, which is then redirected to 2FA page (warning message attached)
7. UserX attempts to remove self from groups, but cannot because they are not a member of the group

### Impact

Users without 2FA can be denied access to gitlab by a malicious user adding them to a project that has inherited 2FA requirements. Users cannot remove themselves from the project as there is no option to do so, and cannot remove themselves from the parent group as they are not a member.

### Examples

Experienced with personal account `marshall0705` against project `Holland And Barrett International / Platform as a Service / dan-test / dan-test`. Admin account `danmarshallhollbarr` used to configure project/groups/members.

### What is the current *bug* behavior?

User is not able to remove themselves from a project that is enforcing 2FA, therefore unable to navigate to other projects/groups.

Furthermore, removing the user from project does not lift the requirement.

### What is the expected *correct* behavior?

Users should be able to leave projects that are enforcing 2FA.

Removing the user from the project should lift the 2FA requirement.

### Relevant logs and/or screenshots

Please see attached screenshot for warning message, which does not include the option to remove self from the project. This is also shown after the user has been removed from the project by the owner.

### Output of checks

This bug happens on GitLab.com

#### Results of GitLab environment info

N/A

## Impact

An attacker can block users from accessing all gitlab.com groups/projects by adding a user to an arbitrary project that has inherited 2FA authentication. The user cannot remove themselves from the project, thus cannot navigate to any other resources.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [image001.png](https://h1.sec.gitlab.net/a/263209cc-6e83-47a4-ba1c-fca2c6b203a1/image001.png)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_5f433bb5_20250119_114830.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13308.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13308.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13308.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13308.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Sep 12, 2020

  [b651f324](/gitlab-org/cves/-/commit/b651f32470af0f6439bc64a6dd9ba05635d4c020)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/b651f32470af0f6439bc64a6dd9ba05635d4c020)
  ·
  b651f324

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Sep 12, 2020

  b651f324

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/b651f32470af0f6439bc64a6dd9ba05635d4c020)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Sep 12, 2020

Loading


