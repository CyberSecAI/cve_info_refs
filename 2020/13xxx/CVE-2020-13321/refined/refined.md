```
{
  "vulnerability": {
    "root_cause": "The application was using the `sanitize` method on user names, which then called `html_safe`, allowing HTML tags to be rendered.",
    "weaknesses": [
      "Improper sanitization of user-controlled input",
       "Use of `html_safe` after sanitization"
    ],
    "impact": "An attacker could inject malicious HTML into their username, which would then be rendered in the application. This allowed an attacker to redirect users to an attacker-controlled site when their username was clicked. This could be used for phishing attacks.",
    "attack_vectors": "The attacker could modify their username via the user account settings page to include a malicious HTML `<a>` tag with a link to an external website and/or an `<img>` tag with an image for phishing.",
    "required_capabilities": "The attacker must have a valid user account to modify the username.  The victim would need to view the attacker's username rendered in a comment section and click it to be redirected."
  }
}
```