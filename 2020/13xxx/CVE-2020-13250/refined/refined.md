```
{
  "ID": "CVE-2020-13250",
  "related_content": [
    {
      "source": "github.com_19cb003f_20250119_114639.html",
      "text": "## 1.7.4 (June 10, 2020)\n\nSECURITY:\n\n* Adding an option `http_config.use_cache` to disable agent caching for http endpoints, because Consul’s DNS and HTTP API expose a caching feature susceptible to DoS. [CVE-2020-13250](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-13250) [[GH-8023]](https://github.com/hashicorp/consul/pull/8023)"
    },
    {
      "source": "github.com_6f751d70_20250119_133357.html",
      "text": "### @hanshasselberg **[hanshasselberg](/hanshasselberg)** commented [Jun 4, 2020](#issue-631099103) • edited Loading\n\n## Summary\n\nConsul’s DNS and HTTP API expose a caching feature susceptible to DoS.\n\n## Background\n\nConsul v1.2.0 introduced an agent cache to ease management of proxy configuration on the agents, allowing caching in the HTTP API. Later v1.4.3 included the ability to turn on using the agent cache for DNS queries. While the cache has the ability to expire, or evict old entries, it does not have the ability to limit the cache’s size.\n\n## Remediation\n\nSteps to remediate:\n\n*   Update to Consul v1.7.4 or v1.6.6\n*   Disable the dns cache feature: <https://www.consul.io/docs/agent/options#dns_use_cache>\n*   Disable the http cache feature: <https://www.consul.io/docs/agent/options#use_cache>\n\n"
    },
     {
      "source": "togithub.com_04f00f2c_20250119_133415.html",
      "text": "### Details\n\nHashiCorp Consul and Consul Enterprise include an HTTP API (introduced in 1.2.0) and DNS (introduced in 1.4.3) caching feature that was vulnerable to denial of service.\n\n##### Specific Go Packages Affected\ngithub.com/hashicorp/consul/agent/config\n\n##### Fix\nThe vulnerability is fixed in versions 1.6.6 and 1.7.4."
    },
    {
      "source": "github.com_acc4f2f4_20250119_114637.html",
       "text": "## 1.6.6 (June 10, 2020)\n\nSECURITY:\n\n* Adding an option `http_config.use_cache` to disable agent caching for http endpoints, because Consul’s DNS and HTTP API expose a caching feature susceptible to DoS. [CVE-2020-13250](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-13250) [[GH-8023]](https://github.com/hashicorp/consul/pull/8023)"
    },
     {
      "source":"github.com_38ac7c9f_20250119_133357.html",
      "text": "This allows the operator to disable agent caching for the http endpoint.\nIt is on by default for backwards compatibility and if disabled will\nignore the url parameter `cached`.\n"
    }
  ],
  "vulnerability_details": {
    "root_cause": "Consul's DNS and HTTP API expose a caching feature susceptible to DoS. The cache lacks the ability to limit its size. Introduced in v1.2.0 for HTTP API caching, and v1.4.3 for DNS queries. The cache has an expiry and eviction feature, but lacks size limits.",
    "weaknesses": [
      "Denial of Service (DoS)",
      "Unbounded resource usage",
      "Lack of input validation"
    ],
    "impact": "A malicious actor can cause a denial-of-service (DoS) or an out-of-memory (OOM) condition by exploiting the unbounded caching feature.",
    "attack_vector": "An unauthenticated attacker can send specially crafted requests to the Consul's DNS and HTTP API endpoints.",
     "attacker_capabilities": "Unauthenticated network access to the affected endpoints"
  }
}
```