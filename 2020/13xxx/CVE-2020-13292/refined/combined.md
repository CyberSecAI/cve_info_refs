=== Content from gitlab.com_509294d4_20250119_113137.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Ability to bypass email verification for OAuth grants results in accounts takeovers on 3rd parties

**[HackerOne report #922456](https://hackerone.com/reports/922456)** by `cache-money` on 2020-07-13, assigned to [@jeremymatos](/jeremymatos "Jeremy Matos"):

### Summary

There's a limitation that requires a validated email before going through the OAuth flow, however this is bypassable. Bypassing this means the target site assumes your email is validated, and actually ends up signing you in with an non-validated email. This behavior can frequently lead to account takeovers in 3rd parties since they often use the email as an identifier, and fold all OAuth/manually created accounts into one. In my example I am going to demonstrate an account takeover on <https://laravelshift.com/>, however this concept is widely exploitable.

It should also be possible to use this technique to get into internal company using pages that just look for `[@]domain.com` in the email before allowing them access.

### Steps to reproduce

1. Create a Bitbucket or GitHub account with a random email, and login to <https://laravelshift.com/>. (We're seeding a victim account).
2. In a different browser, create a new GitLab account with that same email but never confirm it.
3. In that browser, visit LaravelShift and click "Sign in with GitLab", notice you land on a page that states you cannot complete the OAuth grant without validating your email.

Run the following request in Burp replacing your cookies, CSRF token, and state parameter.

```
POST /oauth/authorize HTTP/1.1
Host: gitlab.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 354
DNT: 1
Connection: close
Cookie: [COOKIES]

utf8=%E2%9C%93&authenticity_token=[CSRF TOKEN]&client_id=6dd35c52b02a99eca3454505c4b1f1fa761ad1125bcdccdbc1c290877ef25093&redirect_uri=https%3A%2F%2Flaravelshift.com%2Fauth%2Fgitlab%2Fcallback&state=[STATE VALUE FROM URL]&response_type=code&scope=&nonce=
```

4. Notice the request succeeds with a 302 to LaravelShift with the `code`.
5. Visit that URL and notice you get logged into the victim's account from step 1. This works since the GitLab email is assumed to be trusted and validated.

### Impact

Account takeovers on 3rd parties due to developers assuming GitLab is properly checking validated emails.

### What is the current *bug* behavior?

It's possible to play the `/oauth/authorize` request directly to bypass the `Verify the email address in your account profile before you sign in.` prompt.

### What is the expected *correct* behavior?

The email verification check should be enforced at this step of the process as well.

## Impact

Thanks,

-- Tanner

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_b21db476_20250119_113136.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13292.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13292.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13292.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13292.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Aug 07, 2020

  [c0405a42](/gitlab-org/cves/-/commit/c0405a420fc4b08700fae75ef189b7198b65a0c6)
  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/c0405a420fc4b08700fae75ef189b7198b65a0c6)
  ·
  c0405a42

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Aug 07, 2020

  c0405a42

  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/c0405a420fc4b08700fae75ef189b7198b65a0c6)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Aug 07, 2020

Loading


