=== Content from www.jvanlaak.de_74bc13a8_20250119_111656.html ===

![](https://vg08.met.vgwort.de/na/997a2f5a4e1b444bb1a1293d57ee7850)
# Stashcat

---

---

## CWE 598 Use of GET Request Method With Sensitive Query Strings (aka CVE-2020-13129)

200517
 [Advisory for Stashcat CWE 598 Use of GET Request Method With Sensitive Query Strings](stashcat_CWE_598_200517.pdf)

200518

Mitre assigns CVE-2020-13129

200519
 [NIST NVD](https://nvd.nist.gov/vuln/detail/CVE-2020-13129) publishes CVSSv2 Score of 9.0 HIGH and CVSSv3 Score of 7.2 HIGH

200520
 The vendor has published his [statement](https://stashcat.com/sicherheitsmeldungen) on the issue on his website for stashcat and the same [statement](https://schul.cloud/sicherheit/sicherheitsmeldungen) for schul.cloud.

200527
Comment:
The vendor statement ignores basic attack vectors that are clearly described in the official CWE 598 definition extended description. It might help to read this basics! Arguing that a POST would not help in a man in the middle scenario is not wrong but it ignores all other described possibilities (e.g. log files, referer strings) where the information can pop up unintentionally.

The vendor's self estimate on the severity does not match the CVSS level that several independent organisations scored.

200615

Vendor published new version 3.10.0

---

---

## CWE 359 Exposure of Private Personal Information to an Unauthorized Actor

200518

[Advisory for Stashcat CWE 359 Exposure of Private Personal Information to an Unauthorized Actor](stashcat_CWE_359_200518.pdf) did not qualify as CVE because CVE does not deal with issues in the API

200520
The vendor has published his [statement](https://stashcat.com/sicherheitsmeldungen) on the issue on his website for stashcat and the same [statement](https://schul.cloud/sicherheit/sicherheitsmeldungen) for schul.cloud

200527
Comment:
 The vendor states that all transmitted information is essential to the function of the messenger. The API does not leak any information that the user is not authorized to access. To stop getting access to the email address of other users the vendor offers a hot fix.

The email is exactly what should not be transmitted to other users. It is not shown to the user in the user directory and it has no obvious function for the application. A user id is also transmitted, so no need for an email address. The statement with regards to the hotfix does not tell which functionallity impact will be included.
 One might argue that stashcat is used by closed communities and the users use their respective organisational or company email adress, but an educated guess is that more than 50% of the users are using their private email address. This users are easy targets for fishing campaigns as they acutually expect system mails from stashcat on this email account.

200610
The vendor has published a new [statement](https://schul.cloud/sicherheit/sicherheitsmeldungen) for schul.cloud that email adresses had been transmitted to other users and that this was supposed to happen only to admin accounts.

200616
Comment:
They state that during an internal audit they happened to find this issue on 10. June 2020 14:00 hrs. Bravo! On 2. May 2020 I informed them that emails are transmitted. They linked and commented on my advisory CWE 359 which is public since 18. May 2020. And it clearly states that email adresses are transmitted in the user list for all users. In the meantime the text of the statement for CWE 359 was changed. The text about a hotfix that will be installed on request to ensure that email adresses can not be accessed by other users was removed!!

---

---

## CWE 312 Cleartext Storage of Sensitive Information (aka CVE-2020-13637)

200515

Vendor was informed

200527

Mitre assigns CVE-2020-13637

200527
[Advisory for Stashcat CWE 312 Cleartext Storage of Sensitive Information](stashcat_CWE_312_200527.pdf)

200615

Vendor published new version 3.10.0

The webclient has now a checkbox at login to select for the session id to be stored in the local (persistent) storage or the session storage of the browser.

200616

The vendor has published his [statement](https://stashcat.com/sicherheitsmeldungen) on the issue on his website for stashcat and the same [statement](https://schul.cloud/sicherheit/sicherheitsmeldungen) for schul.cloud



=== Content from www.jvanlaak.de_fc1a4fdb_20250119_111659.html ===
stashcat
Cleartext Storage of Sensitive Information
(CWE 312)

Jens van Laak

May 27, 2020

Stashcat is an instant messenger that is advertised to be safe and confor-
mant to data protection regulations of the European Union. According to
the vendor stashcat is used by German State Police in Niedersachsen and in
Hessen and the German Armed Forces. It is as well the foundation for the
application schul.cloud.

The webapplication of Stashcat stores cleartext session credentials and
the private key for the end-to-end encryption persistent on the local system
without user interaction and without the possibility for the user to opt-in or
to opt-out.

A copy of or access to the local storage database ﬁle enables an attacker

to login and get unlimited access to all data that the user has access to.

1 Overview

Vendor Stashcat Gmbh (owned by heinekingmedia GmbH)

Vendor Website https://www.stashcat.com

Product stashcat

Version ≤ 3.9.2

Product Website https://app.stashcat.com

Impact Information Disclosure

Attack Vector copy of persistent stored data from the user’s system

1

2 Description

Stashcat uses an API to communicate with the system’s server. Most of the requests
are handled via HTTPS GET, POST and OPTIONS requests.

Two parameters – client key and device id – are send in each request and build the

session key.

These parameters along with the unencrypted private key for the end-to-end encryp-
tion, the salt value for crypto functions, the emailadress of the user and a complete set of
userinformation are stored persistent in the local storage1 without any user interaction.
The respective keys in the database are deviceID, clientSecret, im privateKey, im iv,
dd username and im userInfo.

A logout function is provided, but the user has to navigate to the respective webfunc-
tion. If and only if the user logs oﬀ2 via that function, the locally stored data is deleted.
If a user just terminates the browser, all data is kept unprotected in the storage, because
it is stored in the local storage database ﬁle by default3.

A user can simply proof the fact that all access data is stored locally in cleartext
by switching oﬀ the mobile device (and removing the battery if applicable). After the
restart of the device a start of the app will immediately give access to all data (including
the end to end encrypted text messages) without any password. For desktop browsers
the same can be done by closing the browser (additionally restart the computer) and
open the browser again. Retrieving the URL http://app.stashcat.com gives immedi-
ately access to all data (including the end to end encrypted text messages) without any
password.

3 Description of the attack

A copy of or access to the local database ﬁle of the browser or app gives suﬃcient
information to access Stashcat in the user context without any password authorization.
The system does not ask for a login password nor for the key encryption passphrase.

4 Impact

The access to the persistent stored data opens the possibility to get full access to the
user account.

In addition to the access to the not end-to-end encrypted ﬁles, the cleartext storage
of the unencrypted private key enables to access all end-to-end encrypted text commu-
nication.

1e.g. webappsstore SQLITE database in case of Firefox, the respective .ldb ﬁle and the database logﬁle

in case of Chromium

2this needs three clicks, two in the menu and one on a button
3The data is stored persistent all the time. It is deleted when the user uses the logout functionallity.

2

This violates among others even basic4 rules of BSI5 Grundschutz for secure webap-

plications.

In particular:

APP.3.1.A1 If the webapplication stores authentication data the user has to opt-in and

needs to be informed about the assosiated risks.

The session id and the private key are stored without any opt-in (and without any
possibility to opt-out). No information is given to the user about the risk of storage.

APP.3.1.A3 the session ID needs to be protected if stored on client. If the session gets
invalid the session data needs to be deleted both on server and client side.

The session id as combination of clientSecret and deviceID parameter is stored unpro-
tected in the local storage database ﬁle. The data on the client is not deleted if the
session gets invalid by time, because the client is not necessarily connected to stashcat
at that time.

4basic being the lowest of the three catagories: basic requirements, standard requirements and require-

ments for applications with higher security needs

5Federal Oﬃce for Information Security https://www.bsi.bund.de

3


