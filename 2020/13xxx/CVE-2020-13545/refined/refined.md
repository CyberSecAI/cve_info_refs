- **Root cause of vulnerability**: A signed integer overflow occurs when calculating the size of a heap buffer used to store a wide-character string from a TextMaker document. The size is read from the file as a 32-bit integer, then 1 is added, then multiplied by 2. This signed multiplication can overflow, leading to an undersized buffer allocation. Later, when a null terminator is written to the end of the string, a different, unsigned calculation is used, resulting in a pointer that can point outside of the allocated heap buffer, causing a heap-based out-of-bounds write.
- **Weaknesses/vulnerabilities present**:
    - Signed to Unsigned Conversion Error (CWE-196): The application treats a size value as signed for buffer allocation and unsigned when calculating the end pointer.
    - Heap-based out-of-bounds write: The discrepancy in size calculations leads to an out-of-bounds write when a null terminator is written, corrupting heap memory.
- **Impact of exploitation**: Heap-based memory corruption. This can lead to arbitrary code execution under the context of the application
- **Attack vectors**: A specially crafted TextMaker document (.tmd) file. The user must open the malicious document to trigger the vulnerability.
- **Required attacker capabilities/position**: The attacker needs to create a malicious .tmd file and convince the victim to open it using the vulnerable SoftMaker Office TextMaker application.