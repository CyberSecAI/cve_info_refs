=== Content from gitlab.com_c29b0bf9_20250119_124503.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13322.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13322.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13322.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13322.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  Sep 28, 2020

  [9cfca5c4](/gitlab-org/cves/-/commit/9cfca5c4b35b18a87a8bbf685a0020224fbc48a3)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/9cfca5c4b35b18a87a8bbf685a0020224fbc48a3)
  繚
  9cfca5c4

  [ GitLab Bot ](/gitlab-bot) authored Sep 28, 2020

  9cfca5c4

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/9cfca5c4b35b18a87a8bbf685a0020224fbc48a3)
  [ GitLab Bot ](/gitlab-bot) authored Sep 28, 2020

Loading



=== Content from gitlab.com_52176794_20250119_124504.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Group Maintainers can Create/Delete Deploy tokens using API

**[HackerOne report #828154](https://hackerone.com/reports/828154)** by `ashish_r_padelkar` on 2020-03-24, assigned to [@dcouture](/dcouture "Dominic Couture"):

### Summary

Hello,

New API release in 12.9 of Deploy tokens,A group maintainer is able to create/delete group deploy tokens which i think is not intended. These create/delete functionality is only available to group owners in group settings in UI.

`https://docs.gitlab.com/ee/api/deploy_tokens.html#create-a-group-deploy-token`

### Steps to reproduce

1. As a group maintainer, just run the below API

`curl --request POST --header "PRIVATE-TOKEN: <Token>" --header "Content-Type: application/json" --data '{"name": "My deploy token", "expires_at": "2098-02-02", "username": "custom-user", "scopes": ["read_repository"]}' "https://gitlab.com/api/v4/groups/<ID>/deploy_tokens/"`

2. This will create a group level deploy token.
3. You can also delete the tokens created by group admin using below API

`curl --request DELETE --header "PRIVATE-TOKEN: <Token>" "https://gitlab.com/api/v4/groups/<ID>/deploy_tokens/<ID>"`

### What is the current *bug* behavior?

Group Maintainers are able to create/delete group deploy tokens

### What is the expected *correct* behavior?

Group Maintainers shouldnt be allowed to create /delete deploy tokens

### Output of checks

This bug happens on GitLab.com and probably on omnibus installations too!

Regards,

Ashish

## Impact

Group Maintainers are able to create/delete deploy tokens

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


