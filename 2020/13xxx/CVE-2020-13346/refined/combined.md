=== Content from gitlab.com_4a041955_20250119_120528.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Todos are not redacted when membership changes - Access to (confidential) issues and merge requests

**[HackerOne report #880863](https://hackerone.com/reports/880863)** by `vaib25vicky` on 2020-05-22, assigned to [@vdesousa](/vdesousa "Vitor Meireles De Sousa"):

### Summary

This vulnerability was fixed in [gitlab-foss#54349 (closed)](https://gitlab.com/gitlab-org/gitlab-foss/-/issues/54349 "Todos are not redacted when membership changes - Access to (confidential) issues and merge requests") , but it reappears maybe due to some new changes and one is able to reproduce the vulnerability to access confidential issues and MRs.

All issues and MRs used to get redacted after one hour grace period but it is not happening anymore.

The vulnerability only affects when user permissions changes from higher to lower. If user is removed from the project then the to-dos are getting redacted.

### Steps to reproduce

* Create a `private` project to see the problem for both confidential issues and MRs, or a `public` one just for confidential issues (MRs allowed)
* Owner of the project added a user with `Repository` access level.
* User adds issues and MRs to his to-dos list
* Owner changes user access level to `Guest`
* Guest then use the api and get access to all new changes to the issues and MRs.

`curl --header "PRIVATE-TOKEN: &lt;User A Token&gt;" https://mygitlab.example.com/api/v4/todos`

### Impact

User still has access to (confidential) issues and merge requests after permission was removed.

### What is the current *bug* behavior?

Bug still allows low access level user `Guest` to access confidential issues and MRs

### What is the expected *correct* behavior?

Redact the confidential issues and MRs

### PoC

In the image below, you can see MRs and issues are not redacted even after 2 hours.

[![pocc.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/7fc826017e813b37983e28247dc6e7d63f62b5b5/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33303364386438322d333630352d343538622d616336652d3834363932333736353637332f706f63632e706e67)

### Output of checks

This bug happens on GitLab.com

## Impact

Todos are not redacted when membership changes - Access to (confidential) issues and merge requests

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [pocc.png](https://h1.sec.gitlab.net/a/303d8d82-3605-458b-ac6e-846923765673/pocc.png)

Edited Sep 04, 2020 by [Brett Walker](/digitalmoksha)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_6f18da10_20250119_120527.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13346.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13346.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13346.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13346.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Oct 07, 2020

  [1276241d](/gitlab-org/cves/-/commit/1276241d1dfaa2f9334bfdc0f0f44a0ed0e5a8ef)
  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/1276241d1dfaa2f9334bfdc0f0f44a0ed0e5a8ef)
  ·
  1276241d

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Oct 07, 2020

  1276241d

  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/1276241d1dfaa2f9334bfdc0f0f44a0ed0e5a8ef)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Oct 07, 2020

Loading


