=== Content from git.pengutronix.de_f5dbe3a1_20250119_115305.html ===


| [cgit logo](/cgit/) | [index](/cgit/) : [barebox](/cgit/barebox/) | master next |
| --- | --- | --- |
| barebox master repository | Pengutronix |

| [summary](/cgit/barebox/?h=next)[refs](/cgit/barebox/refs/?h=next&id=c0f0cbd1759a6ca6cbda4001dff5764f6633c825)[log](/cgit/barebox/log/net/nfs.c?h=next)[tree](/cgit/barebox/tree/net/nfs.c?h=next&id=c0f0cbd1759a6ca6cbda4001dff5764f6633c825)[commit](/cgit/barebox/commit/net/nfs.c?h=next&id=c0f0cbd1759a6ca6cbda4001dff5764f6633c825)[diff](/cgit/barebox/diff/net/nfs.c?h=next&id=c0f0cbd1759a6ca6cbda4001dff5764f6633c825)[stats](/cgit/barebox/stats/net/nfs.c?h=next) | log msg author committer range |
| --- | --- |

path: [root](/cgit/barebox/commit/?h=next&id=c0f0cbd1759a6ca6cbda4001dff5764f6633c825)/[net](/cgit/barebox/commit/net?h=next&id=c0f0cbd1759a6ca6cbda4001dff5764f6633c825)/[nfs.c](/cgit/barebox/commit/net/nfs.c?h=next&id=c0f0cbd1759a6ca6cbda4001dff5764f6633c825)**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Sascha Hauer <s.hauer@pengutronix.de> | 2020-06-03 09:50:40 +0200 |
| --- | --- | --- |
| committer | Sascha Hauer <s.hauer@pengutronix.de> | 2020-06-03 09:50:44 +0200 |
| commit | [c0f0cbd1759a6ca6cbda4001dff5764f6633c825](/cgit/barebox/commit/net/nfs.c?h=next&id=c0f0cbd1759a6ca6cbda4001dff5764f6633c825) ([patch](/cgit/barebox/patch/net/nfs.c?id=c0f0cbd1759a6ca6cbda4001dff5764f6633c825)) | |
| tree | [6d734abb2000ac4c18984632d0947a501d048983](/cgit/barebox/tree/?h=next&id=c0f0cbd1759a6ca6cbda4001dff5764f6633c825) /[net/nfs.c](/cgit/barebox/tree/net/nfs.c?h=next&id=c0f0cbd1759a6ca6cbda4001dff5764f6633c825) | |
| parent | [1b57c7381c781e3cf39a10a2a01ce8e1fe5aca66](/cgit/barebox/commit/net/nfs.c?h=next&id=1b57c7381c781e3cf39a10a2a01ce8e1fe5aca66) ([diff](/cgit/barebox/diff/net/nfs.c?h=next&id=c0f0cbd1759a6ca6cbda4001dff5764f6633c825&id2=1b57c7381c781e3cf39a10a2a01ce8e1fe5aca66)) | |
| download | [barebox-c0f0cbd1759a6ca6cbda4001dff5764f6633c825.tar.gz](/cgit/barebox/snapshot/barebox-c0f0cbd1759a6ca6cbda4001dff5764f6633c825.tar.gz) | |

nfs: Fix out of bounds readnfs\_read\_reply() interprets the fields of an incoming packet directly
as a field length without checking the boundaries. Clamp the maximum
length to the packet length to avoid reading out of bounds.
Reported-by: Jai Verma <jai2.verma@outlook.com>
Signed-off-by: Sascha Hauer <s.hauer@pengutronix.de>
[Diffstat](/cgit/barebox/diff/?h=next&id=c0f0cbd1759a6ca6cbda4001dff5764f6633c825) (limited to 'net/nfs.c')

| -rw-r--r-- | [net/nfs.c](/cgit/barebox/diff/net/nfs.c?h=next&id=c0f0cbd1759a6ca6cbda4001dff5764f6633c825) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 1 deletions

| diff --git a/net/nfs.c b/net/nfs.cindex 63573098d7..591417e0de 100644--- a/[net/nfs.c](/cgit/barebox/tree/net/nfs.c?h=next&id=1b57c7381c781e3cf39a10a2a01ce8e1fe5aca66)+++ b/[net/nfs.c](/cgit/barebox/tree/net/nfs.c?h=next&id=c0f0cbd1759a6ca6cbda4001dff5764f6633c825)@@ -533,7 +533,7 @@ static int nfs\_readlink\_reply(unsigned char \*pkt, unsigned len)  static int nfs\_read\_reply(unsigned char \*pkt, unsigned len) {- int rlen;+ unsigned int rlen; uint32\_t \*data; int ret; @@ -552,6 +552,8 @@ static int nfs\_read\_reply(unsigned char \*pkt, unsigned len)  rlen = ntohl(net\_read\_uint32(data + 18)); + rlen = max\_t(unsigned int, rlen, len - 19);+ ret = write(net\_store\_fd, (char \*)(data + 19), rlen); if (ret < 0) { perror("write"); |
| --- |

If you are a bot and scrape our website and ignore robots.txt we block your /20 or /48
[beebeebee](/hp).


