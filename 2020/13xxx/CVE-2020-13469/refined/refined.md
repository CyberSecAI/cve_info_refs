- Root cause of vulnerability: The document describes multiple vulnerabilities related to insecure implementations of debug interfaces, DMA controllers, and flash memory protection mechanisms in various STM32F1 microcontroller clones and the original.
- Weaknesses/vulnerabilities present:
    - **D1-A: Load Instruction Exploitation:** Some devices (CKS32F103, GD32VF103) do not sufficiently block load instructions from accessing flash memory even in RDP level 1.
    - **D1-B: Extraction via Exceptions:** Devices (STM32F103, APM32F103, CKS32F103) allow reading flash memory through interrupt vector fetches using the instruction bus, even with a debugger attached in RDP level 1, bypassing intended protection.
    - **D1-C: VTOR Control Flow Redirection:** GD32F103 allows redirecting control flow via the VTOR to execute arbitrary code in SRAM even when the CPU debug module is disabled.
    - **D2: DMA Access Exploitation:** DMA controllers in some devices (CKS32F103, GD32F103) can read flash memory even in RDP level 1, bypassing the intended protection.
    - **H1: Invasive Data Eavesdropping:** Dual-die GD32 devices (GD32F103, GD32F130) expose the QSPI bus communication between the logic and flash memory dies via accessible bonding wires, allowing eavesdropping of flash memory data, even when the debug interface is disabled via RDP level 2 in GD32F130.
    - **H2: Invasive RDP Manipulation:** GD32F130 is vulnerable to active manipulation of QSPI communication, enabling an attacker to downgrade RDP level by modifying the loaded option bytes value, granting debug access to the protected flash memory.
    - **H3: Shellcode Exec. via Glitch and FPB:** Power glitches can be used to bypass debugger lockdown by exploiting SRAM data remanence and the FPB (Flash Patch and Breakpoint Unit) to redirect control flow to a shellcode placed in SRAM.
- Impact of exploitation: Successful exploitation of these vulnerabilities allows an attacker to extract the entire firmware from the microcontrollers, potentially exposing sensitive data and intellectual property. Additionally, some attacks can lead to arbitrary code execution.
- Attack vectors:
    - **Debug interface vulnerabilities:** Exploited through a debugger by manipulating CPU registers, triggering exceptions, or utilizing DMA.
    - **Invasive attacks:** Requiring physical access to the device, including decapping the device, probing bonding wires, and manipulating signals, to either eavesdrop on communication or inject faults.
    - **Power glitching:** Exploiting a power supply glitch to circumvent protection mechanisms.
- Required attacker capabilities/position:
    - **Debug interface attacks:** Require the ability to connect a debugger to the device, and may require some knowledge of the system architecture.
    - **Invasive attacks:** Require physical access to the device, including some hardware skills, decapping capabilities, fine manipulation techniques, and basic knowledge of electronics, while power glitching requires a means to induce a short power interruption and control the device reset.

The document provides more detail than the official CVE description, elaborating on specific exploitation methods and hardware weaknesses.