```json
{
  "vulnerability": {
    "root_cause": "The application fails to properly escape the default branch name when displaying the duplicate dashboard modal.",
    "weaknesses": [
      "Stored XSS vulnerability due to improper escaping of user-controlled input (branch name).",
        "CSP bypass vulnerability used to execute arbitrary javascript on gitlab.com"
    ],
    "impact": "An attacker can execute arbitrary JavaScript code in the victim's browser, potentially leading to account takeover through CSRF token theft and actions on behalf of the victim.",
    "attack_vectors": [
      "The attacker creates a branch with a malicious payload in the branch name.",
        "The attacker then tricks a victim into viewing the metrics dashboard and duplicating it"
    ],
    "required_capabilities": "The attacker needs to have the ability to create a branch within a GitLab project. The victim must have at least reporter access to the project to be impacted by the XSS."
  },
  "additional_details": {
      "csp_bypass": "A previously reported CSP bypass can be used to allow the XSS payload to execute on gitlab.com. This involves embedding the payload in an SVG file which is then used in the malicious branch name.",
      "poc_details": "The proof of concept (PoC) uses a malicious branch name containing an iframe tag that loads arbitrary JavaScript from a previously uploaded svg file, executing javascript in the context of the application.",
      "affected_versions": "This bug was present in GitLab.com running on GitLab Enterprise Edition 12.9.0-pre."
    }
}
```