=== Content from gitlab.com_ff4a1bb9_20250119_113004.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Pre-generation & Static 2FA Authenticator Secret Code can cause risks to accounts

**[HackerOne report #511260](https://hackerone.com/reports/511260)** by `rgupt` on 2019-03-17, assigned to `asaba`:

### Summary:

This issue was inspired by one of the reports #100509 submitted to HackerOne. They have fixed this issue, however this issue is seen on Gitlab application as well.

### Description:

It is observed that the 2FA Authenticator Secret Code generated for an account remains static even when user logs out and logs into the application multiple times.

An attack might play out like this:

* The attacker is able to abuse a password manager's behavior to obtain the victim's username/password at this point.
* The attacker logs into Gitlab & silently grabs the 2FA Authenticator Code without enabling the 2FA.
* Victim logs into their account and then tries to enable 2FA to prevent hacker from accessing the victim's account.
* However since attacker already has the 2FA secret code, and since the 2FA secret code remains static & does not change, the attacker can silently continue to access the victim's account credentials with the 2FA code the attacker possess.

### Steps To Reproduce:

1. Login to a Gitlab account which does not has 2FA enabled.
2. Navigate to Settings -> Accounts Page and click on the button to enable 2FA.
3. The Secret Key for the 2FA Authenticator Code will be displayed. Note this code.
4. Logout of that session and login again and navigate to Settings -> Accounts Page.
5. Again click on the button to enable 2FA and check if the same Secret Key for the 2FA Authenticator code is displayed.

In all the cases, the Secret Key for the 2FA Authenticator Code never changes and remains static.

### Suggested Fix

It could be mitigated by generating a new 2FA Authenticator Secret Code each time the user tries to enable 2FA (regardless of whether the process was cancelled previously). This is how secure sites like HackerOne & Github performs.

## Impact

As a result, if a hacker was able to access the victim's account credential, the hacker can silently get the 2FA Authenticator code without enabling the 2FA Authentication. Next time when victim enables the 2FA, Hacker would still have access to the 2FA Authenticator Code and can continue to login to victim's account.

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_df252ab4_20250119_113004.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13304.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13304.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13304.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13304.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Sep 12, 2020

  [eda3ef44](/gitlab-org/cves/-/commit/eda3ef440df88c26165c845b0d6ed7590be6bb7e)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/eda3ef440df88c26165c845b0d6ed7590be6bb7e)
  ·
  eda3ef44

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Sep 12, 2020

  eda3ef44

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/eda3ef440df88c26165c845b0d6ed7590be6bb7e)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Sep 12, 2020

Loading


