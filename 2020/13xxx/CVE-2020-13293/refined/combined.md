=== Content from gitlab.com_630e250f_20250119_122230.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# When you call your branch the same name as a git hash, it could be checked out by dependents

**[HackerOne report #790634](https://hackerone.com/reports/790634)** by `retroplasma` on 2020-02-07, assigned to [@dcouture](/dcouture "Dominic Couture"):

### Summary

If we call a branch the same name like a git hash then the moment it's checked out somewhere, git prefers the branch name.

So let's say the git hash is `e91803d442559d6efb63102b10c919e10901b01d`.

And someone referenced that hash in their program.

Now the developer or a hacker with access to the repo can create a branch named `e91803d442559d6efb63102b10c919e10901b01d`.

Git will checkout the branch and not the hash when someone puts `git checkout e91803d442559d6efb63102b10c919e10901b01d`.

GitHub prevents users from pushing branches that are the same name as hashes, but GitLab does not.

### Steps to reproduce

(Step-by-step guide to reproduce the issue, including:)

1. Take a hash of a commit A
2. Go to any other commit B
3. Create a branch that is named the same as the hash from commit A
4. Push
5. If someone references the hash in their program, their "git checkout" will checkout commit B. Because it will use the branch name instead of the hash

### Impact

Referencing a hash isn't secure anymore. It would reference a branch that has completely different data.

git shows a warning but "git checkout {...}" is often used.

The attacker can replace the expected code with something malicious that introduces a backdoor in the app or steal data. For example, you would be able to push a malicious branch to an auth library that introduces code to send all the user/pass data to an external server, or maybe add a a crypto miner to a web server.

### Examples

Any project that refs a git ref

### What is the current *bug* behavior?

Gitlab accepts pushed branches that are 40-char hexadecimals

### What is the expected *correct* behavior?

Gitlab shouldn't accept pushed branches that are 40-char hexadecimals (like Github does9

### Relevant logs and/or screenshots

### Output of checks

#### Results of GitLab environment info

## Impact

Redirect pinned refrs of libraries if there is control of a library. A referenced hash won't point to a hash anymore. An attacker can make the branch which has the hash's name contain any other data.

Edited Feb 10, 2020 by [Michelle Gill](/m_gill)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_395b941f_20250119_122229.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13293.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13293.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13293.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13293.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  Aug 07, 2020

  [8fe4c638](/gitlab-org/cves/-/commit/8fe4c638861508f9de3acd71fba326826f0eaa37)
  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/8fe4c638861508f9de3acd71fba326826f0eaa37)
  繚
  8fe4c638

  [ GitLab Bot ](/gitlab-bot) authored Aug 07, 2020

  8fe4c638

  [Publishing 1 updated advisories and 0 new advisories](/gitlab-org/cves/-/commit/8fe4c638861508f9de3acd71fba326826f0eaa37)
  [ GitLab Bot ](/gitlab-bot) authored Aug 07, 2020

Loading


