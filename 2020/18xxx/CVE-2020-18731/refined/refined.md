The content relates to CVE-2020-18731.

**Root cause of vulnerability:**
The vulnerability is a segmentation fault (SEGV) occurring within the `Iec104_Deal_FirmUpdate` function. The root cause appears to be an issue with how the function handles firmware update data, particularly the length parameter passed to it.

**Weaknesses/vulnerabilities present:**
The primary vulnerability is a memory access error leading to a segmentation fault, specifically a dereference of a null pointer (address 0x000000000000). The code attempts to access memory at a null address within `Iec104_Deal_FirmUpdate`. This is due to incorrect handling of the firmware update length, causing a read or write operation to invalid memory. The `Len` argument passed to `Iec104_Deal_FirmUpdate` is 226, while the data length from the input is smaller, this indicates a vulnerability in how the firmware update length is calculated or validated, which causes a buffer overflow.

**Impact of exploitation:**
Exploitation leads to a crash of the `iec104_monitor` application due to a segmentation fault. This could result in a denial-of-service condition, preventing the IEC104 protocol from operating as intended.

**Attack vectors:**
The attack vector is through the network communication of the IEC104 protocol. The attacker sends a specially crafted data packet, specifically related to a firmware update command, to the server.

**Required attacker capabilities/position:**
The attacker needs to be able to send network packets to the `iec104_monitor` server. This requires network access to the machine where the server is running and the ability to craft malicious IEC104 data packets.