The content is related to CVE-2020-18750.

**Root cause of vulnerability:**
The vulnerability is a heap-based buffer overflow in the `CharCodeToUnicode::addMapping` function. The `n` parameter of this function, which dictates the length of a string to be copied, can be larger than `maxUnicodeString`, leading to an out-of-bounds write.

**Weaknesses/vulnerabilities present:**
- **Heap Overflow:** The core issue is writing beyond the allocated buffer `u` within the `CharCodeToUnicodeString` structure.
- **Integer Overflow/Incorrect Length Calculation**: The `len` field can become large enough (`n / 4`), that the subsequent use of `sMap[sMapLen].u[sMap[sMapLen].len - 1]` results in out-of-bounds write.

**Impact of exploitation:**
- **Memory corruption:** An attacker can overwrite heap metadata, potentially leading to arbitrary code execution.
- **Arbitrary Code Execution:** Specifically, the vulnerability can allow modifying memory containing function pointers, enabling an attacker to gain control of the program flow.

**Attack vectors:**
- Crafted PDF file: A specially crafted PDF file can trigger the vulnerability by including a specific sequence in the ToUnicode CMap section that results in a large `n` value being passed to `addMapping`.

**Required attacker capabilities/position:**
- Ability to craft a malicious PDF.
- Ability to have the vulnerable code parse the PDF.

**Additional details:**
- The content also includes a fix for the vulnerability, specifically an `unlikely` check to prevent out-of-bound access in `CharCodeToUnicode.cc`.
- The fix also includes adding `GooLikely.h` which defines `likely` and `unlikely` macros.