Based on the provided content, here's an analysis of the vulnerability:

**Root Cause:**

The vulnerability lies in the `checkuser` function within the `Include\contorl.php` file of SEMCMS. This function authenticates users by querying the `sc_user` database table based on user credentials obtained from cookies. The function uses `test_input()` and `verify_str()` to sanitize the inputs from cookies.

**Weaknesses/Vulnerabilities:**

*   **SQL Injection:**  The core vulnerability is a SQL injection flaw. Although the `verify_str()` function filters out the equals sign (`=`), it does not prevent all forms of SQL injection. The provided example demonstrates that a payload with `or -1`  bypasses the sanitization, allowing an attacker to manipulate the SQL query.

**Impact of Exploitation:**

*   **Bypass Authentication:** An attacker can bypass the authentication mechanism by injecting a carefully crafted payload into the `user_ps` cookie. This would allow them to log in as any user in the `sc_user` table, potentially gaining administrator access.

**Attack Vectors:**

*   **Cookie Manipulation:**  The attack vector is through the manipulation of HTTP cookies: `user_admin` and `user_ps`.  An attacker would modify these cookies to inject the malicious SQL payload.

**Required Attacker Capabilities/Position:**

*   **Knowledge of Cookie Structure:** The attacker needs to know the names of the cookies used for authentication (`user_admin` and `user_ps`).
*   **Ability to Modify Cookies:** The attacker must be able to modify the cookies sent to the server. This could be done through a proxy, browser developer tools, or through other means of intercepting and modifying HTTP requests.

**Technical Details:**

The code snippet `select * from sc_user where user_admin='$cookieuseradmin' and user_ps='$cookieuserpass'` shows how the cookie values are directly inserted into the SQL query. The vulnerability exploits this by crafting a `cookieuserpass` value that results in the following query after injection:

```sql
select * from sc_user where user_admin='\' and user_ps=' or -1 #'
```

This SQL injection bypasses the authentication, because ' or -1' is a true condition and the comment '#' ignores the rest of the query.

The `verify_str()` function filters out `=` but not `-` allowing for the bypass to occur.