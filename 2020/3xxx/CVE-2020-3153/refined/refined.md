```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability is due to the incorrect handling of directory paths during file copy operations in the `vpndownloader.exe` application. The application extracts the target file name by searching for the last backslash character in the source path, but does not account for forward slashes, which are also valid directory separators in Windows.",
    "weaknesses": [
      "Path Traversal (CWE-22)",
       "Uncontrolled Search Path (CWE-427)"
    ],
    "impact": "A local attacker can copy arbitrary files to arbitrary locations with `SYSTEM` privileges, allowing for DLL pre-loading, DLL hijacking, and other related attacks, potentially leading to privilege escalation.",
     "attack_vectors": "A local attacker can exploit the vulnerability by sending a crafted file path to `vpndownloader.exe` through the AnyConnect Agent service, which runs with `SYSTEM` privileges. This service listens on TCP port 62522 on the loopback interface.",
    "required_attacker_capabilities": "The attacker must have valid credentials on the Windows system to communicate with the AnyConnect Agent service."
  },
    "additional_details": {
    "exploit_details": "The `vpndownloader.exe` application is used to copy files during AnyConnect updates. It extracts the target filename from the provided source path by looking for the last backslash character. Because it doesn't recognize forward slashes as valid directory separators, an attacker can include forward slashes in the source path to bypass the filename extraction logic and write to arbitrary locations on the same volume as `%ProgramData%`, where temporary installer files are stored. Since the file copy is done with SYSTEM privileges the attacker can overwrite existing files or create new ones with elevated privileges.",
    "dll_hijacking": "An additional attack scenario involves DLL hijacking. The attacker can overwrite a commonly used DLL file, like `dbghelp.dll`, in a location where a Cisco signed executable will load from. When `vpndownloader.exe` is instructed to run a Cisco signed executable, the attacker controlled DLL will be loaded and executed with `SYSTEM` privileges."
  }
}
```