=== Content from tools.cisco.com_32dab8b8_20250119_140957.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Security AdvisoryCisco AnyConnect Secure Mobility Client for Windows Uncontrolled Search Path Vulnerability Medium   Advisory ID:  cisco-sa-ac-win-path-traverse-qO4HWBsj  First Published: 2020 February 19 16:00 GMT  Last Updated:  2022 October 25 13:31 GMT  Version 1.2:  [Final](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#final)   Workarounds:  No workarounds available  Cisco Bug IDs: [CSCvs46327](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvs46327)     CVE-2020-3153     CWE-427       CVSS Score: [Base 6.5](https://sec.cloudapps.cisco.com/security/center/cvssCalculator.x?version=3.0&vector=CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:H/A:N)**Click Icon to Copy Verbose Score** CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:H/A:N/E:X/RL:X/RC:X       CVE-2020-3153     CWE-427       [Download CSAF](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ac-win-path-traverse-qO4HWBsj/csaf/cisco-sa-ac-win-path-traverse-qO4HWBsj.json)   Email      Summary  * A vulnerability in the installer component of Cisco AnyConnect Secure Mobility Client for Windows could allow an authenticated local attacker to copy user-supplied files to system level directories with system level privileges.  The vulnerability is due to the incorrect handling of directory paths. An attacker could exploit this vulnerability by creating a malicious file and copying the file to a system directory. An exploit could allow the attacker to copy malicious files to arbitrary locations with system level privileges. This could include DLL pre-loading, DLL hijacking, and other related attacks. To exploit this vulnerability, the attacker needs valid credentials on the Windows system.  Cisco has released software updates that address the vulnerability described in this advisory. There are no workarounds that address this vulnerability.  This advisory is available at the following link:<https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ac-win-path-traverse-qO4HWBsj>  Affected Products  * Vulnerable Products At the time of publication, this vulnerability affected Cisco AnyConnect Secure Mobility Client for Windows releases earlier than 4.8.02042.  See the Details section in the bug ID(s) at the top of this advisory for the most complete and current information. Products Confirmed Not Vulnerable Only products listed in the [Vulnerable Products](#vp) section of this advisory are known to be affected by this vulnerability.  Workarounds  * There are no workarounds that address this vulnerability.  Fixed Software  * When [considering software upgrades](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes), customers are advised to regularly consult the advisories for Cisco products, which are available from the [Cisco Security Advisories and Alerts page](https://www.cisco.com/go/psirt), to determine exposure and a complete upgrade solution.  In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. Fixed Releases At the time of publication, Cisco AnyConnect Secure Mobility Client for Windows releases 4.8.02042 and later contained the fix for this vulnerability.  See the Details section in the bug ID(s) at the top of this advisory for the most complete and current information.  Exploitation and Public Announcements  * In October 2022, the Cisco PSIRT became aware of additional attempted exploitation of this vulnerability in the wild. Cisco continues to strongly recommend that customers upgrade to a fixed software release to remediate this vulnerability.  Source  * Cisco would like to thank Yorick Koster, working with the SSD Secure Disclosure program, for reporting this vulnerability.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory    URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ac-win-path-traverse-qO4HWBsj>  Revision History  * | Version | Description | Section | Status | Date |   | --- | --- | --- | --- | --- |   | 1.2 | Updated Exploitation and Public Announcements section because Cisco became aware of active exploitation attempts. | Exploitation and Public Announcements | Final | 2022-OCT-25 |   | 1.1 | Updated Source to include researcher and reporting group. | Source | Final | 2020-FEB-24 |   | 1.0 | Initial public release. | - | Final | 2020-FEB-19 |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.  A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |



=== Content from www.securify.nl_06220677_20250119_140954.html ===
[Securify home](/)Menu![contact](https://www.datocms-assets.com/21957/1585735393-phone-call.svg)Bel ons![contact](https://www.datocms-assets.com/21957/1585735542-letter.svg)Mail ons

* [Code](/diensten/agile-security/)
* [Pentesten](/diensten/pentesting/)
* [Organisatie](/diensten/red-teaming/)
* [Publicaties](/artikelen/)
* [Over ons](/over-ons/)
nl

* [en](/en/advisory/cisco-anyconnect-elevation-of-privileges-due-to-insecure-handling-of-path-names/)
* [nl](/advisory/cisco-anyconnect-elevation-of-privileges-due-to-insecure-handling-of-path-names/)
#### Advisory

![](data:image/svg+xml;charset=utf-8...)![](data:image/jpg;base64...)![Lego guy]()![Lego guy](https://www.datocms-assets.com/21957/1590679367-67u8va6x400x400.jpg?auto=format&dpr=0.24&w=400)**Yorick Koster**April 19, 2020
# Cisco AnyConnect elevation of privileges due to insecure handling of path names

![](data:image/png;base64...)![Cisco AnyConnect elevation of privileges due to insecure handling of path names]()![Cisco AnyConnect elevation of privileges due to insecure handling of path names](https://www.datocms-assets.com/21957/1592561884-card.png?auto=format&w=1200)
#### Spring naar

* [Abstract](/advisory/cisco-anyconnect-elevation-of-privileges-due-to-insecure-handling-of-path-names/#abstract)
* [See also](/advisory/cisco-anyconnect-elevation-of-privileges-due-to-insecure-handling-of-path-names/#see-also)
* [Tested version](/advisory/cisco-anyconnect-elevation-of-privileges-due-to-insecure-handling-of-path-names/#tested-version)
* [Fix](/advisory/cisco-anyconnect-elevation-of-privileges-due-to-insecure-handling-of-path-names/#fix)
* [Introduction](/advisory/cisco-anyconnect-elevation-of-privileges-due-to-insecure-handling-of-path-names/#introduction)
* [Vulnerability details](/advisory/cisco-anyconnect-elevation-of-privileges-due-to-insecure-handling-of-path-names/#vulnerability-details)
* [Proof of concept](/advisory/cisco-anyconnect-elevation-of-privileges-due-to-insecure-handling-of-path-names/#proof-of-concept)
## Abstract

The update functionality of the Cisco AnyConnect Secure Mobility Client for Windows is affected by a path traversal vulnerability that allows local attackers to create/overwrite files on arbitrary locations. Successful exploitation of this vulnerability allows the attacker to gain `SYSTEM` privileges.

## See also

* [CVE-2020-3153](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-3153)
* [cisco-sa-ac-win-path-traverse-qO4HWBsj](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ac-win-path-traverse-qO4HWBsj) - Cisco AnyConnect Secure Mobility Client for Windows Uncontrolled Search Path Vulnerability
* [SSD Advisory](https://ssd-disclosure.com/ssd-advisory-cisco-anyconnect-privilege-elevation-through-path-traversal/) - Cisco AnyConnect Privilege Elevation through Path Traversal

## Tested version

This issue was successfully verified on Cisco AnyConnect Secure Mobility Client for Windows version 4.8.01090.

## Fix

This vulnerability was fixed in Cisco AnyConnect Secure Mobility Client for Windows version 4.8.02042. Cisco customers with active contracts can obtain updates through the Software Center at <https://software.cisco.com/download/navigator.html>.

Cisco has released bug ID [CSCvs46327](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvs46327) for registered users, which contains additional details and an up-to-date list of affected product versions.

## Introduction

Cisco AnyConnect Secure Mobility Client contains functionality to auto-update itself. Auto-update also works for low-privileged users, this is possible because the update is initiated from a service running with `SYSTEM` privileges (*Cisco AnyConnect Secure Mobility Agent*). This service exposes TCP port 62522 on the loopback device to which clients can connect and send commands to be handled by this service. One of these commands it to launch the `vpndownloader` application and update AnyConnect.

A path traversal vulnerability exists in the `vpndownloader` application for Windows that allows a local user to create and run files outside of the temporary installer folder. Successful exploitation of this vulnerability allows a local attacker to gain `SYSTEM` privileges.

## Vulnerability details

The AnyConnect auto-update functionality has been affected by a number of vulnerabilities in the past that can be abused by local users to gain `SYSTEM` privileges (eg, [Kostya Kortchinsky](https://expertmiami.blogspot.nl/2015/06/cisco-anyconnect-secure-mobility-client.html), [Securify](/en/advisory/SFY20150601/cisco-anyconnect-elevation-of-privileges-via-dll-side-loading.html), [Project Zero](https://bugs.chromium.org/p/project-zero/issues/detail?id=460), [SerializingMe](https://www.serializing.me/2016/12/14/anyconnect-elevation-of-privileges-part-1/)). Cisco has made a number of changes to mitigate these attacks, amongst these changes are:

* Executables need to have a valid Authenticode signature from `Cisco Systems, Inc.`.
* (New) versions of `vpndownloader.exe` are copied to `%ProgramData%\Cisco\Cisco AnyConnect Secure Mobility Client\Temp\Downloader`.
* Proper NTFS permissions are (now) set on the `%ProgramData%\Cisco\Cisco AnyConnect Secure Mobility Client\` folder.
* The `vpndownloader.exe` executable must have `vpndownloader.exe` configured as the original filename in its version information.
* When `vpndownloader.exe` launches additional installation files, these files also need to have a valid Authenticode signature from `Cisco Systems, Inc.`.
* Installation files are copied in a separate temporary folder under `%ProgramData%\Cisco\Cisco AnyConnect Secure Mobility Client\Temp\Installer` before they are executed.

In a nutshell, the auto-update mechanism works by sending a message to the AnyConnect Agent to launch `vpndownloader.exe` and instruct it to perform a certain action (as command line argument). This action is either moving/copying a profile (XML) file to a profile folder or launch a Cisco signed installer file.

Technically, this doesn't need to be an installer file, any Cisco signed executable will do. When `vpndownloader.exe` is instructed to run an installer file, the file is first copied to a temporary folder under `%ProgramData%\Cisco\Cisco AnyConnect Secure Mobility Client\Temp\Installer`. After the file has been copied, the digital signature is checked including the signer of the file. If all checks out, the file is launched from the temporary folder and the folder is deleted after execution has completed.

Because the executable is copied to a new temporary folder, and the folder has proper NTFS permissions it is not possible to perform a file/DLL planting attack to run arbitrary code. In addition, the file must be signed by Cisco and the signature must be valid, preventing the execution of arbitrary executables.

A path traversal vulnerability exists in the step where the (user-supplied) executable is copied into the temporary folder. `vpndownloader.exe` will extract the target file name from the source file name. Essentially it does this by searching for the last occurrence of the backslash () character in the source path, the right part after the backslash is treated as the file name and is used as the target file name. AnyConnect does not take into account that the Windows API also accepts the forward slash (/) as directory separator character. Because of this it is possible to cause `vpndownloader.exe` to create files outside its temporary folder.

Since the signature verification is done after the file is copied, it is possible for an attacker to copy any file to any location residing on the same volume as `%ProgramData%` (generally `C:\`). Copying of the file is done with `SYSTEM` privileges - when `vpndownloader.exe` is launched through the AnyConnect Agent. If the target file exists and `SYSTEM` has write access to this file, it will be overwritten with the attacker-supplied file. This alone is enough for a local user to gain elevated privileges.

Another attack scenario is to hijack a DLL that is loaded by a Cisco signed executable. Most Cisco executables are affected by DLL hijacking, a common DLL that is used by Cisco applications is the `dbghelp.dll` file. The attack consists of two steps:

* Create an attacker-controlled `dbghelp.dll` file outside of the temporary folder to prevent removal, traversing one folder up is enough.
* Launch a Cisco signed executable to is vulnerable to DLL hijacking form the same folder, again using the path traversal vulnerability.

When the Cisco signed executable is launched through the AnyConnect Agent, it will also run with `SYSTEM` privileges. The code in the attacker-controlled DLL will also run with these privileges. The application itself is opened within `Session 0`. Windows 10 1803 has [removed](https://docs.microsoft.com/en-us/windows/deployment/planning/windows-10-removed-features) the `Interactive Services Detection Service`, which makes it impossible for users to interact with any GUI displayed in `Session 0`. This of course does nothing to stop an attacker from gaining `SYSTEM` privileges, but it does require an additional step for the attacker to launch a GUI application with elevated privileges.

## Proof of concept

## Vragen of feedback?

Bel ons![contact](https://www.datocms-assets.com/21957/1585735393-phone-call.svg)Mail ons![contact](https://www.datocms-assets.com/21957/1585735542-letter.svg)[![Securify logo](https://www.datocms-assets.com/21957/1589468815-imglogofullwhite.svg)Securify home](/)

**Kantoor:**

Naritaweg 132

1043 CA Amsterdam

**Telefoon:** +31 20 82 04 516

**Mail:** info@securify.nl

**KvK nummer:** 58043624

**Responsible Disclosure:**

rd@securify.nl

**GPG:** 2CC6 9E7A 7CEC E259 2FCC BF92 EC11 E0AC 0101 CC82

* [Events](/evenementen/)
* [LinkedIn](https://www.linkedin.com/company/securify-group)
* [Twitter](https://twitter.com/securifybv)
* [Jobs](https://securifybv.recruitee.com/)
* [Privacy Policy](/privacy-policy/)
* [Terms](/voorwaarden/)
© 2024 Securify BV



=== Content from packetstormsecurity.com_acbeab17_20250119_123233.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from seclists.org_2d8d5ba8_20250119_123235.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](42)
[By Date](date.html#43)
[![Next](/images/right-icon-16x16.png)](44)

[![Previous](/images/left-icon-16x16.png)](42)
[By Thread](index.html#43)
[![Next](/images/right-icon-16x16.png)](44)

![](/shared/images/nst-icons.svg#search)

# Cisco AnyConnect elevation of privileges due to insecure handling of path names

---

*From*: "Securify B.V. via Fulldisclosure" <fulldisclosure () seclists org>

*Date*: Mon, 20 Apr 2020 12:35:51 +0200

---

```
------------------------------------------------------------------------
Cisco AnyConnect elevation of privileges due to insecure handling of
path names
------------------------------------------------------------------------
Yorick Koster, December 2019

------------------------------------------------------------------------
Abstract
------------------------------------------------------------------------
The update functionality of the Cisco AnyConnect Secure Mobility Client
for Windows is affected by a path traversal vulnerability that allows
local attackers to create/overwrite files on arbitrary locations.
Successful exploitation of this vulnerability allows the attacker to
gain SYSTEM privileges.

------------------------------------------------------------------------
See also
------------------------------------------------------------------------
- CVE-2020-3153 [2]
- cisco-sa-ac-win-path-traverse-qO4HWBsj [3] - Cisco AnyConnect Secure
Mobility Client for Windows Uncontrolled Search Path Vulnerability
- SSD Advisory [4] - Cisco AnyConnect Privilege Elevation through Path
Traversal

------------------------------------------------------------------------
Tested version
------------------------------------------------------------------------
This issue was successfully verified on Cisco AnyConnect Secure Mobility
Client for Windows version 4.8.01090.

------------------------------------------------------------------------
Fix
------------------------------------------------------------------------
This vulnerability was fixed in Cisco AnyConnect Secure Mobility Client
for Windows version 4.8.02042. Cisco customers with active contracts can
obtain updates through the Software Center at
<https://software.cisco.com/download/navigator.html>.

Cisco has released bug ID CSCvs46327 [5] for registered users, which
contains additional details and an up-to-date list of affected product
versions.

------------------------------------------------------------------------
Introduction
------------------------------------------------------------------------
Cisco AnyConnect Secure Mobility Client contains functionality to
auto-update itself. Auto-update also works for low-privileged users,
this is possible because the update is initiated from a service running
with SYSTEM privileges (Cisco AnyConnect Secure Mobility Agent). This
service exposes TCP port 62522 on the loopback device to which clients
can connect and send commands to be handled by this service. One of
these commands it to launch the vpndownloader application and update
AnyConnect.

A path traversal vulnerability exists in the vpndownloader application
for Windows that allows a local user to create and run files outside of
the temporary installer folder. Successful exploitation of this
vulnerability allows a local attacker to gain SYSTEM privileges.

------------------------------------------------------------------------
Vulnerability details
------------------------------------------------------------------------
The AnyConnect auto-update functionality has been affected by a number
of vulnerabilities in the past that can be abused by local users to gain
SYSTEM privileges (eg, Kostya Kortchinsky [6], Securify [7], Project
Zero [8], SerializingMe [9]). Cisco has made a number of changes to
mitigate these attacks, amongst these changes are:

- Executables need to have a valid Authenticode signature from Cisco Systems, Inc..
- (New) versions of vpndownloader.exe are copied to %ProgramData%\Cisco\Cisco AnyConnect Secure Mobility
Client\Temp\Downloader.
- Proper NTFS permissions are (now) set on the %ProgramData%\Cisco\Cisco AnyConnect Secure Mobility Client\ folder.
- The vpndownloader.exe executable must have vpndownloader.exe configured as the original filename in its version
information.
- When vpndownloader.exe launches additional installation files, these files also need to have a valid Authenticode
signature from Cisco Systems, Inc..
- Installation files are copied in a separate temporary folder under %ProgramData%\Cisco\Cisco AnyConnect Secure
Mobility Client\Temp\Installer before they are executed.

In a nutshell, the auto-update mechanism works by sending a message to
the AnyConnect Agent to launch vpndownloader.exe and instruct it to
perform a certain action (as command line argument). This action is
either moving/copying a profile (XML) file to a profile folder or launch
a Cisco signed installer file.

Technically, this doesn't need to be an installer file, any Cisco signed
executable will do. When vpndownloader.exe is instructed to run an
installer file, the file is first copied to a temporary folder under
%ProgramData%\Cisco\Cisco AnyConnect Secure Mobility
Client\Temp\Installer. After the file has been copied, the digital
signature is checked including the signer of the file. If all checks
out, the file is launched from the temporary folder and the folder is
deleted after execution has completed.

Because the executable is copied to a new temporary folder, and the
folder has proper NTFS permissions it is not possible to perform a
file/DLL planting attack to run arbitrary code. In addition, the file
must be signed by Cisco and the signature must be valid, preventing the
execution of arbitrary executables.

A path traversal vulnerability exists in the step where the
(user-supplied) executable is copied into the temporary folder.
vpndownloader.exe will extract the target file name from the source file
name. Essentially it does this by searching for the last occurrence of
the backslash (\) character in the source path, the right part after the
backslash is treated as the file name and is used as the target file
name. AnyConnect does not take into account that the Windows API also
accepts the forward slash (/) as directory separator character. Because
of this it is possible to cause vpndownloader.exe to create files
outside its temporary folder.

Since the signature verification is done after the file is copied, it is
possible for an attacker to copy any file to any location residing on
the same volume as %ProgramData% (generally C:\). Copying of the file is
done with SYSTEM privileges - when vpndownloader.exe is launched through
the AnyConnect Agent. If the target file exists and SYSTEM has write
access to this file, it will be overwritten with the attacker-supplied
file. This alone is enough for a local user to gain elevated privileges.

Another attack scenario is to hijack a DLL that is loaded by a Cisco
signed executable. Most Cisco executables are affected by DLL hijacking,
a common DLL that is used by Cisco applications is the dbghelp.dll file.
The attack consists of two steps:

- Create an attacker-controlled dbghelp.dll file outside of the
temporary folder to prevent removal, traversing one folder up is enough.
- Launch a Cisco signed executable to is vulnerable to DLL hijacking
form the same folder, again using the path traversal vulnerability.

When the Cisco signed executable is launched through the AnyConnect
Agent, it will also run with SYSTEM privileges. The code in the
attacker-controlled DLL will also run with these privileges. The
application itself is opened within Session 0. Windows 10 1803 has
removed [10] the Interactive Services Detection Service, which makes it
impossible for users to interact with any GUI displayed in Session 0.
This of course does nothing to stop an attacker from gaining SYSTEM
privileges, but it does require an additional step for the attacker to
launch a GUI application with elevated privileges.

------------------------------------------------------------------------
References
------------------------------------------------------------------------
[1]
<https://www.securify.nl/advisory/SFY20200419/cisco-anyconnect-elevation-of-privileges-due-to-insecure-handling-of-path-names.html>
[2] <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-3153>
[3] <https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ac-win-path-traverse-qO4HWBsj>
[4] <https://ssd-disclosure.com/ssd-advisory-cisco-anyconnect-privilege-elevation-through-path-traversal/>
[5] <https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvs46327>
[6] <https://expertmiami.blogspot.nl/2015/06/cisco-anyconnect-secure-mobility-client.html>
[7] /en/advisory/SFY20150601/cisco-anyconnect-elevation-of-privileges-via-dll-side-loading.html
[8] <https://bugs.chromium.org/p/project-zero/issues/detail?id=460>
[9] <https://www.serializing.me/2016/12/14/anyconnect-elevation-of-privileges-part-1/>
[10] <https://docs.microsoft.com/en-us/windows/deployment/planning/windows-10-removed-features>

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](42)
[By Date](date.html#43)
[![Next](/images/right-icon-16x16.png)](44)

[![Previous](/images/left-icon-16x16.png)](42)
[By Thread](index.html#43)
[![Next](/images/right-icon-16x16.png)](44)

### Current thread:

* **Cisco AnyConnect elevation of privileges due to insecure handling of path names** *Securify B.V. via Fulldisclosure (Apr 21)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from sec.cloudapps.cisco.com_96f7ecbe_20250119_140959.html ===
{
"document": {
"acknowledgments": [
{
"summary": "Cisco would like to thank Yorick Koster, working with the SSD Secure Disclosure program, for reporting this vulnerability."
}
],
"category": "csaf\_security\_advisory",
"csaf\_version": "2.0",
"notes": [
{
"category": "summary",
"title": "Summary",
"text": "A vulnerability in the installer component of Cisco AnyConnect Secure Mobility Client for Windows could allow an authenticated local attacker to copy user-supplied files to system level directories with system level privileges.\r\n\r\nThe vulnerability is due to the incorrect handling of directory paths. An attacker could exploit this vulnerability by creating a malicious file and copying the file to a system directory. An exploit could allow the attacker to copy malicious files to arbitrary locations with system level privileges. This could include DLL pre-loading, DLL hijacking, and other related attacks. To exploit this vulnerability, the attacker needs valid credentials on the Windows system.\r\n\r\nCisco has released software updates that address the vulnerability described in this advisory. There are no workarounds that address this vulnerability.\r\n\r\nThis advisory is available at the following link:\r\nhttps://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ac-win-path-traverse-qO4HWBsj [\"https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ac-win-path-traverse-qO4HWBsj\"]"
},
{
"category": "general",
"title": "Vulnerable Products",
"text": "At the time of publication, this vulnerability affected Cisco AnyConnect Secure Mobility Client for Windows releases earlier than 4.8.02042.\r\n\r\nSee the Details section in the bug ID(s) at the top of this advisory for the most complete and current information."
},
{
"category": "general",
"title": "Products Confirmed Not Vulnerable",
"text": "Only products listed in the Vulnerable Products [\"#vp\"] section of this advisory are known to be affected by this vulnerability."
},
{
"category": "general",
"title": "Workarounds",
"text": "There are no workarounds that address this vulnerability."
},
{
"category": "general",
"title": "Fixed Software",
"text": "When considering software upgrades [\"https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html#fixes\"], customers are advised to regularly consult the advisories for Cisco products, which are available from the Cisco Security Advisories and Alerts page [\"https://www.cisco.com/go/psirt\"], to determine exposure and a complete upgrade solution.\r\n\r\nIn all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.\r\n Fixed Releases\r\nAt the time of publication, Cisco AnyConnect Secure Mobility Client for Windows releases 4.8.02042 and later contained the fix for this vulnerability.\r\n\r\nSee the Details section in the bug ID(s) at the top of this advisory for the most complete and current information."
},
{
"category": "general",
"title": "Vulnerability Policy",
"text": "To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy [\"https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html\"]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco."
},
{
"category": "general",
"title": "Exploitation and Public Announcements",
"text": "In October 2022, the Cisco PSIRT became aware of additional attempted exploitation of this vulnerability in the wild. Cisco continues to strongly recommend that customers upgrade to a fixed software release to remediate this vulnerability."
},
{
"category": "general",
"title": "Source",
"text": "Cisco would like to thank Yorick Koster, working with the SSD Secure Disclosure program, for reporting this vulnerability."
},
{
"category": "legal\_disclaimer",
"title": "Legal Disclaimer",
"text": "THIS DOCUMENT IS PROVIDED ON AN \"AS IS\" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.\r\n\r\nA standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products."
}
],
"publisher": {
"category": "vendor",
"contact\_details": "Emergency Support:\r\n+1 877 228 7302 (toll-free within North America)\r\n+1 408 525 6532 (International direct-dial)\r\nNon-emergency Support:\r\nEmail: psirt@cisco.com\r\nSupport requests that are received via e-mail are typically acknowledged within 48 hours.",
"issuing\_authority": "Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.\r\nMore information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html",
"name": "Cisco",
"namespace": "https://wwww.cisco.com"
},
"references": [
{
"category": "self",
"summary": "Cisco AnyConnect Secure Mobility Client for Windows Uncontrolled Search Path Vulnerability",
"url": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ac-win-path-traverse-qO4HWBsj"
},
{
"category": "external",
"summary": "Cisco Security Vulnerability Policy",
"url": "https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html"
},
{
"category": "external",
"summary": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ac-win-path-traverse-qO4HWBsj",
"url": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ac-win-path-traverse-qO4HWBsj"
},
{
"category": "external",
"summary": "considering software upgrades",
"url": "https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html#fixes"
},
{
"category": "external",
"summary": "Cisco Security Advisories and Alerts page",
"url": "https://www.cisco.com/go/psirt"
},
{
"category": "external",
"summary": "Security Vulnerability Policy",
"url": "https://sec.cloudapps.cisco.com/security/center/resources/security\_vulnerability\_policy.html"
}
],
"title": "Cisco AnyConnect Secure Mobility Client for Windows Uncontrolled Search Path Vulnerability",
"tracking": {
"current\_release\_date": "2022-10-25T13:31:56+00:00",
"generator": {
"date": "2022-10-25T13:31:58+00:00",
"engine": {
"name": "TVCE"
}
},
"id": "cisco-sa-ac-win-path-traverse-qO4HWBsj",
"initial\_release\_date": "2020-02-19T16:00:00+00:00",
"revision\_history": [
{
"date": "2020-02-19T15:19:30+00:00",
"number": "1.0.0",
"summary": "Initial public release."
},
{
"date": "2020-02-24T15:38:38+00:00",
"number": "1.1.0",
"summary": "Updated Source to include researcher and reporting group."
},
{
"date": "2022-10-25T13:31:56+00:00",
"number": "1.2.0",
"summary": "Updated Exploitation and Public Announcements section because Cisco became aware of active exploitation attempts."
}
],
"status": "final",
"version": "1.2.0"
}
},
"product\_tree": {
"branches": [
{
"name": "Cisco",
"category": "vendor",
"branches": [
{
"name": "Cisco AnyConnect Secure Mobility Client",
"category": "product\_family",
"product": {
"name": "Cisco AnyConnect Secure Mobility Client ",
"product\_id": "CSAFPID-109810"
}
}
]
}
]
},
"vulnerabilities": [
{
"cve": "CVE-2020-3153",
"ids": [
{
"system\_name": "Cisco Bug ID",
"text": "CSCvs46327"
}
],
"notes": [
{
"category": "other",
"title": "Affected Product Comprehensiveness",
"text": "Complete."
}
],
"product\_status": {
"known\_affected": [
"CSAFPID-109810"
]
},
"release\_date": "2020-02-19T16:00:00+00:00",
"remediations": [
{
"category": "vendor\_fix",
"details": "Cisco has released software updates that address this vulnerability.",
"product\_ids": [
"CSAFPID-109810"
],
"url": "https://software.cisco.com"
}
],
"scores": [
{
"cvss\_v3": {
"baseScore": 6.5,
"baseSeverity": "MEDIUM",
"vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:H/A:N",
"version": "3.0"
},
"products": [
"CSAFPID-109810"
]
}
],
"title": "vuln-CVE-2020-3153"
}
]
}

=== Content from sec.cloudapps.cisco.com_9e569737_20250119_141001.html ===


[Home](http://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x) / [Latest Threat Information](https://sec.cloudapps.cisco.com/security/center/navigation.x?i=118)
#### Cisco Security

# Common Vulnerability Scoring System

| Choose the version of CVSS calculator:   Version 1  Version 2  Version 3  Version 3.1 |
| --- |
| Common Vulnerability Scoring System (CVSS) Online Calculator, version 3.0 |
| Vector: CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:H/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X |
| This tool is used to calculate a specific threat/vulnerability's CVSS score. Please select the appropriate options below, click "Calculate Score," and the CVSS score will be displayed. Use of this calculator is subject to [the disclaimer below.](#disclaimer) |
| ---    | |
| Base Parameters |
| Once discovered, analyzed, and catalogued, there are certain aspects of a vulnerability that do not change, assuming the initial information is complete and correct. These immutable characteristics will not change over time, nor in different environments. The base metric group captures the access to and impact on the target.  Attack Vector AV: Local AV: Adjacent AV: Network AV: Physical  Select Attack Vector Parameters  Attack Complexity AC: Low AC: High  Select Attack Complexity Parameters  Privileges Required PR: None PR: Low PR: High  Select Privileges Required Parameters  User Interaction UI: Required UI: None  Select User Interaction Parameters  Scope S: Unchanged S: Changed  Select Scope Parameters  Confidentiality Impact C: None C: Low C: High  Select Confidentiality Impact Parameters  Integrity Impact I: None I: Low I: High  Select Integrity Impact Parameters  Availability Impact A: None A: Low A: High  Select Availability Impact Parameters    Base Score: 6.5 |
| Temporal Parameters |
| As a vulnerability ages, certain intrinsic characteristics will change with time. In many cases, when a vulnerability is first discovered, the number of vulnerable systems will be at or close to its peak, while the availability of exploit and remedial information will be at its lowest point. As time progresses, patch information will become more available and more systems will be fixed as more exploits occur, driving the need for the fix. Eventually, the number of vulnerable systems will reach its low point as remedial information reaches its high point. The CVSS temporal metrics group captures these characteristics of a vulnerability that change over time.  Exploit Code Maturity E: Unproven  E: Proof-of-Concept  E: Functional  E: High  E: Not Defined   Select Exploit Code Maturity Parameters  Remediation Level RL: Official-Fix  RL: Temporary-Fix  RL: Workaround  RL: Unavailable  RL: Not Defined   Select Remediation Level Parameters  Report Confidence RC: Unknown  RC: Reasonable  RC: Confirmed  RC: Not Defined   Select Report Confidence Parameters     Temporal Score: 6.5 |
| Environmental Parameters |
| Different user environments can have an immense bearing on how (or if) a vulnerability affects a given information system and its stakeholders. The CVSS environmental metrics group captures characteristics of vulnerabilities that are tied to system distribution and network environment.  Confidentiality Requirement CR: Low  CR: Medium  CR: Not Defined  CR: High   Select Confidentiality Requirement Parameters  Integrity Requirement IR: Low  IR: Medium  IR: Not Defined  IR: High   Select Integrity Requirement Parameters  Availability Requirement AR: Low  AR: Medium  AR: Not Defined  AR: High   Select Availability Requirement Parameters  Modified Attack Vector MAV: Local  MAV: Adjacent  MAV: Network  MAV: Physical  MAV: Not Defined   Select Modified Attack Vector Parameters  Modified Attack Complexity MAC: Low  MAC: High  MAC: Not Defined   Select Modified Attack Complexity Parameters  Modified Privileges Required MPR: None  MPR: Low  MPR: High  MPR: Not Defined   Select Modified Privileges Required Parameters  Modified User Interaction MUI: Required  MUI: None  MUI: Not Defined   Select Modified User Interaction Parameters  Modified Scope MS: Unchanged  MS: Changed  MS: Not Defined   Select Modified Scope Parameters  Modified Confidentiality MC: None  MC: Low  MC: High  MC: Not Defined   Select Modified Confidentiality Parameters  Modified Integrity MI: None  MI: Low  MI: High  MI: Not Defined   Select Modified Integrity Parameters  Modified Availability MA: None  MA: Low  MA: High  MA: Not Defined   Select Modified Availability Parameters    Environmental Score: 6.5 |
| --- |
|  |
|

![](https://www.static-cisco.com/web/fw/search//img/loader.gif)

Loading..

### Tools

* [Cisco Software Checker](/security/center/softwarechecker.x)
* [Cisco Vulnerability Repository](/security/center/cvr)
* [Bug Search](https://bst.cloudapps.cisco.com/bugsearch/)
* [Cisco PSIRT openVuln API](https://developer.cisco.com/psirt/)
* [CVRF Repository](/security/center/cvrfListing.x)
* [OVAL Repository](https://community.cisco.com/t5/services-blogs/update-regarding-oval-definitions-by-cisco/ba-p/3661030)

### Actions

* [Download Cisco Software](https://software.cisco.com/download/home)
* [Download Snort Rules](https://snort.org)
* [Open or Query a TAC Case](https://mycase.cloudapps.cisco.com/case)

### Related Links

* [Cisco Event Responses](/security/center/erp.x?i=52)
* [Cisco Policies and Processes](/security/center/securityResources.x)
* [Cisco Security Blog](https://blogs.cisco.com/security)
* [Security Solutions](https://www.cisco.com/site/us/en/products/security/index.html)

| --- |
| --- |
| **ENDORSEMENT**  Cisco endorses and subscribes to the vulnerability guidelines outlined by the National Infrastructure Advisory Council (NIAC). The NIAC commissioned the development of the Common Vulnerability Scoring System (CVSS), which is currently maintained by FIRST (Forum of Incident Response and Security Teams), www.first.org, and was a combined effort involving many companies, including Cisco Systems, Inc.  **GENERAL DISCLAIMER AND LIMITATION OF LIABILITY**  All information provided by the CVSS Online Calculator is for informational purposes only and is subject to change or withdrawal at any time without notice. The CVSS Online Calculator is a pilot program and Cisco assumes no responsibility for the accuracy or completeness of the information provided and any decision made or action taken or not taken in reliance upon the information provided or furnished hereunder. The information and results provided by the CVSS Online Calculator vary based on the information provided by each user, which is specific to each user's network and cannot be verified or confirmed by Cisco. The CVSS Online Calculator is offered only as a convenience and any use of the results or information provided is at the user's risk. |



=== Content from packetstormsecurity.com_55c6aafc_20250119_123232.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from ssd-disclosure.com_c5c07dee_20250119_140953.html ===

[Skip to content](#content "Skip to content")
[![SSD icon](https://ssd-disclosure.com/wp-content/uploads/2022/08/Group-36.png)](https://ssd-disclosure.com)

# SSD Advisory – Cisco AnyConnect Privilege Elevation through Path Traversal

* [April 19, 2020](https://ssd-disclosure.com/2020/04/19/)
* [SSD Secure Disclosure technical team](https://ssd-disclosure.com/author/ssd-secure-disclosure-technical-team/)
* [Vulnerability publication](https://ssd-disclosure.com/category/vulnerability-publication/)

**Vulnerability Summary**
The update functionality of the Cisco AnyConnect Secure Mobility Client for Windows is affected by a path traversal vulnerability that allows local attackers to create/overwrite files in arbitrary locations. Successful exploitation of this vulnerability allows the attacker to gain `SYSTEM` privileges.

**Credit**
An independent Security Researcher, Yorick Koster, has reported this vulnerability to SSD Secure Disclosure program.

**Affected Systems**
Cisco AnyConnect Secure Mobility Client for Windows, Version 4.8.01090.

**CVE**
CVE-2020-3153

**Vendor Response**
Cisco has released a patch, available from: https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ac-win-path-traverse-qO4HWBsj

**Vulnerability Details**
Cisco AnyConnect Secure Mobility Client contains functionality to auto-update itself. Auto-update also works for low-privileged users, which is possible because the update is initiated from a service called `Cisco AnyConnect Secure Mobility Agent` and is running with `SYSTEM` privileges. This service exposes TCP port 62522 on the loopback device to which clients can connect and send commands to be handled by this service. One of these command is to launch the `vpndownloader` application and update AnyConnect.

A path traversal vulnerability exists in the `vpndownloader` application for Windows that allows a local user to create and run files outside of the temporary installer folder. Successful exploitation of this vulnerability allows a local attacker to gain `SYSTEM` privileges.

The AnyConnect auto-update functionality has been affected by a number of vulnerabilities in the past that can be abused by local users to gain SYSTEM privileges (eg. [Kostya Kortchinsky](https://expertmiami.blogspot.nl/2015/06/cisco-anyconnect-secure-mobility-client.html), [Securify](https://www.securify.nl/advisory/SFY20150601/cisco-anyconnect-elevation-of-privileges-via-dll-side-loading.html), [Project Zero](https://bugs.chromium.org/p/project-zero/issues/detail?id=460), [SerializingMe](https://www.serializing.me/2016/12/14/anyconnect-elevation-of-privileges-part-1/)). Cisco has made a number of changes to mitigate these attacks, amongst these changes are:

* Executables need to have a valid Authenticode signature from `Cisco Systems, Inc`.
* (New) versions of `vpndownloader.exe` are copied to `%ProgramData%\Cisco\Cisco AnyConnect Secure Mobility Client\Temp\Downloader`.
* Proper NTFS Permissions are (now) set on the `%ProgramData%\Cisco\Cisco AnyConnect Secure Mobility Client\` folder.
* the `vpndownloader.exe` executable must have `vpndownloader.exe` configured as the original filename in its version information.
* When `vpndownloader.exe` launches additional installation files, these files also need to have a valid Authenticode signature from `Cisco Systems, Inc.`.
* Installation files are copied in a separate temporary folder under `%ProgramData%\Cisco\Cisco AnyConnect Secure Mobility Client\Temp\Installer` before they are executed.

In a nutshell, the auto-update mechanism works by send a message to the AnyConnect Agent to launch `vpndownloader.exe` and instruct it to perform a certain action (as command line argument). This action is either moving/copying a profile (XML) file to a profile folder or launch a Cisco signed installer file. Technically, this doesn’t need to be an installer file, any Cisco signed executable will do. When `vpndownloader.exe` is instructed to run an installer file, the file is first copied to a temporary folder under `%ProgramData%\Cisco\Cisco AnyConnect Secure Mobility Client\Temp\Installer`.

After the file has been copied, the digital signature is checked including the signer of the file. If all checks out, the file is launched from the temporary folder and the folder is deleted after execution has completed.
Because the executable is copied to a new temporary folder, and the folder has proper NTFS permissions, it is not possible to perform a file/DLL planting attack to run arbitrary code. In addition, the file must be signed by Cisco and the signature must be valid, preventing the execution of arbitrary executable.

A path traversal vulnerability exists in the step where the (user-supplied) executable is copied into the temporary folder. `vpndownloader.exe` will extract the target file name from the source file name. Essentially it does this by searching for the last occurrence of the backslash (\) character in the source path, the right part after the backslash is treated as the filename and is used as the target file name. AnyConnect does not take into account that the Windows API also accepts the forward slash (/) as directory separator character. Because of this it is possible to cause `vpndownloader.exe` to create files outside its temporary folder.

Since the signature verification is done after the file is copied, it is possible for an attacker to copy any file to any location residing on the same volume as `%ProgramData%` (generally C:\). Copying of the file is done with `SYSTEM` privileges – when `vpndownloader.exe` is launched through the AnyConnect Agent. If the target file exists and `SYSTEM` has write access to this file, it will be overwritten with the attacker-supplied file. This alone is enough for a local user to gain elevated privileges.

Another attack scenario is to hijack a DLL that is loaded by a Cisco signed executable. Most Cisco executable are affected by DLL hijacking, a common DLL that is used by Cisco applications is the `dbghelp.dll` file. The attack consists of two steps:

1. Create an attacker-controlled `dbghelp.dll` file outside of the temporary folder to prevent removal, traversing one folder up is enough.
2. Launch a Cisco signed executable which is vulnerable to DLL hijacking from the same folder, again using the path traversal vulnerability.

When the Cisco signed executable is launched through the AnyConnect Agent, it will also run with `SYSTEM` privileges. The code in the attacker-controlled DLL will also run with these privileges. The application itself is opened within `Session 0`. Windows 10 1803 has [removed](https://docs.microsoft.com/en-us/windows/deployment/planning/windows-10-removed-features) the `Interactive Services Detection Service`, which makes it impossible for users to interact with any GUI displayed in `Session 0`. This of course does nothing to stop an attacker from gaining `SYSTEM` privileges, but it does require an additional step for the attacker to launch a GUI application with elevated privileges.

**Exploit**
The POC is a PowerShell module which has the function Invoke-ExploitAnyConnectPathTraversal. This function has two modes.

**Without arguments:**
This mode tries to hijack `%ProgramFiles%\Common Files\microsoft shared\ink\HID.dll`, which is used by the on-screen keyboard. Run the following commands in a PowerShell prompt:

1. Import-Module .-ExploitAnyConnectPathTraversal.psm1
2. Invoke-ExploitAnyConnectPathTraversal
3. Lock the Windows session or sign out
4. Open accessibility tools in the login screen and launch the on-screen keyboard

A PowerShell prompt should open (behind the keyboard) running as `SYSTEM`. (Note that the on-screen keyboard of Windows 7 isn’t affected by this DLL hijack).

**With arguments:**
Running the function with arguments will create three files within `%ProgramData%\Cisco\Cisco AnyConnect Secure Mobility Client\Temp\Installer`:

* payload.bat
* dbghelp.dll
* cstub.exe

`cstub.exe` is a Cisco signed executable, which will be launched by `vpndownloader`. `dbghelp.dll` is hijacked to run `payload.bat`. The provided argument(s) are written to `payload.bat` and thus will run as `SYSTEM`.

1. Import-Module .-ExploitAnyConnectPathTraversal.psm1
2. Invoke-ExploitAnyConnectPathTraversal

## Get in touch

Any questions? Interested in our services?

We’d love to hear from you

[Contact US](#elementor-action%3Aaction%3Dpopup%3Aopen%26settings%3DeyJpZCI6IjYwMTgiLCJ0b2dnbGUiOmZhbHNlfQ%3D%3D)

[Facebook](https://www.facebook.com/ssdsecuredisclosure/)

[Twitter](https://twitter.com/SecuriTeam_SSD)

[Youtube](https://www.youtube.com/channel/UC9ZnYbYqOe6Y3eRdw0TMz9Q)

[Linkedin](https://www.linkedin.com/company/ssd-disclosure)

## [?](https://ssd-disclosure.com/faq/)

[![](https://ssd-disclosure.com/wp-content/uploads/2022/08/Path-1354.png)](https://twitter.com/securiteam_ssd)

[HOME](/)

[THE
COMMUNITY](/our-community/)

[SCOPE](/scope/)

[ADVISORIES](/advisories/)

[SUBMIT](/submit/)

[CONTACT](/contact/)

[![](https://ssd-disclosure.com/wp-content/uploads/2022/08/Path-1354.png)](https://twitter.com/securiteam_ssd)

## ?

## Get in touch

Name

Email

Subject

Message

Send

[Skip to content](#content)

Open toolbar
Accessibility Tools

Accessibility Tools

* Increase TextIncrease Text
* Decrease TextDecrease Text
* GrayscaleGrayscale
* High ContrastHigh Contrast
* Negative ContrastNegative Contrast
* Light BackgroundLight Background
* Links UnderlineLinks Underline
* Readable FontReadable Font
* Reset
  Reset



=== Content from packetstormsecurity.com_ed206ece_20250119_123233.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.
