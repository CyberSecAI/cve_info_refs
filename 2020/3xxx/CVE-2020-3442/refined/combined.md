=== Content from duo.com_b37e5e81_20250119_112507.html ===

[Skip navigation](#main-content)

Search

[Duo Blog](/blog)

* [Docs & Support](/docs)
  + [See All Duo Documentation](/docs)
    - [Getting Started with Duo](/docs/getting-started)
    - [Free Trial Onboarding Guide](/support/free-trial-onboarding-guide)
    - [Duo Essentials Edition](/docs#duo-essentials-features)
    - [Remote Access & VPN](/docs#remote-access-and-vpn)
  + [See All Duo Resources](/resources)
    - [Events & Webinars](/resources/events)
    - [eBooks](/resources/ebooks)
    - [Duo Videos](/resources/videos)
  + [See all Duo Support](/support)
    - [Support for Duo Users](/support#enduserresources)
    - [Support for Admins](/support#adminresources)
    - [Additional Support Information](https://help.duo.com/s/?language=en_US)

[Admin Login](https://admin.duosecurity.com/)

[![Duo Security](/assets/img/duoLogo-web.png)](/)

[![Duo Security](/assets/img/duoLogo-web.png)](/)

* [Admin Login](https://admin.duosecurity.com/)

  Search
* [Our Product](/product)
  ### Duo does it all

  Let us show you. Explore our security stack or request a demo.

  [Contact sales](/about/contact)

  ### [Key Capabilities](/product)

  ### [A black square featuring a prominent circle positioned at its center, creating a striking visual contrast.](/product/passport)

  ### [A fingerprint icon displayed prominently against a solid black background, symbolizing identity and security.](/product/cisco-identity-intelligence)

  ### [A bold check mark within a circle, contrasting sharply with the black background for visual impact.Multi-Factor Authentication (MFA)](/product/multi-factor-authentication-mfa)

  ### [Icon of a radio tower set against a solid black background, symbolizing communication and broadcasting technology.Remote Access](/product/remote-access)

  ### [A computer monitor displaying a phone placed on its surface, illustrating a modern workspace setup.Device Trust](/product/device-trust)

  ### [A gray square positioned centrally against a solid black background, creating a stark contrast in colors.Single Sign-On (SSO)](/product/single-sign-on-sso)

  ### [A gray square featuring a subtle wave pattern, creating a textured and dynamic visual effect.Adaptive Access Policies](/product/adaptive-access-policies)

  ### [Explore Duo Products](/product)

  ### [For Small or Medium Businesses](/product/small-to-medium-business)

  ### [For Enterprise](/product/enterprise)

  ### [For Federal Government](/product/federal-government)

  ### [For State and Local Government](/product/state-and-local-government)
* [Solutions](/solutions)
  ### Security, solved

  Start a free trial to see how Duo can step up your security.

  [Try for free](https://signup.duo.com/)

  ### [All Solutions](/solutions)

  ### [A gray circle centered on a solid black background, creating a striking contrast between the two colors.Continuous Identity Security](/solutions/continuous-identity-security)

  ### [A battery icon featuring two stars, symbolizing high energy or performance.Zero Trust Security](/solutions/zero-trust-security)

  ### [A close-up of a finger with a circular outline surrounding it, emphasizing the finger's position and detail.Passwordless](/solutions/passwordless)

  ### [A simple fish icon displayed prominently against a solid black background.Phishing Prevention](/solutions/phishing-prevention)

  ### [A monochrome icon of a ship's wheel, representing steering and control.Risk-Based Authentication](/solutions/risk-based-authentication)

  ### [All Industries](/solutions)

  ### [K-12 Education](/solutions/k-12)

  ### [Higher Education](/solutions/higher-ed)

  ### [Finance](/solutions/financial)

  ### [Legal](/solutions/legal)

  ### [Retail](/solutions/retail)

  ### [Technology](/solutions/technology)

  ### [Federal Government](/solutions/federal-government)

  ### [State & Local Government](/solutions/state-and-local-government)
* [Why Duo?](/why-duo)
  ### Built for your world

  Duo works where you do, with tools built for your industry’s unique needs.

  [Try for free](https://signup.duo.com/)

  ### [We Have It All](/why-duo)

  ### [Icon of a running man depicted on a solid black background, symbolizing speed and athleticism.Speed to Security](/why-duo/speed-to-security)

  ### [A bold check mark within a circle, contrasting sharply with the black background for visual impact.Next Level MFA](/why-duo/next-level-mfa)

  ### [A shield icon displayed prominently against a solid black background, symbolizing protection and security.Protection and Productivity](/why-duo/protection-and-productivity)

  ### [Cloud icon featuring a prominent check mark, symbolizing approval or successful completion of a task.Complete Protection](/why-duo/complete-coverage)

  ### [About Duo](/about)

  ### [Explore Duo Demos](/demos)

  ### [Explore Customer Stories](/solutions/customer-stories)

  ### [Our Advantage](/editions-and-pricing/duo-advantage)
* [Pricing](/editions-and-pricing)
  ### Flexible, affordable security

  Get world-class data protection without breaking the bank.

  [Ready to buy now?](/editions-and-pricing/ready-to-buy-now)

  ### CompareEditions

  ![A green circle containing a smaller circle within its center, creating a layered visual effect.](/img/asset/aW1nL2ljb25zL25hdi9jb21wYXJlLWVkaXRpb25zLnBuZw==?s=3acf5c0d481caf92ed20d4db46e1310a)
  [Explore plans](/editions-and-pricing)

  ### Essentials$3/User/Month

  ![A green circle containing three evenly spaced dots within its interior.](/img/asset/aW1nL2ljb25zL25hdi9kdW8tZXNzZW50aWFscy5wbmc=?s=ad160e57abf336bee144a3ef02a280ab)
  [View Essentials](/editions-and-pricing/duo-essentials)

  ### Advantage$6/User/Month

  ![A green circle containing four smaller circles arranged within it, creating a visually balanced design.](/img/asset/aW1nL2ljb25zL25hdi9kdW8tYWR2YW50YWdlLnBuZw==?s=84f217535e6dd91cadb57c16d84f1b3a)
  [View Advantage](/editions-and-pricing/duo-advantage)

  ### Premier$9/User/Month

  ![A green circle adorned with white dots, creating a visually appealing and simple design.](/img/asset/aW1nL2ljb25zL25hdi9kdW8tcHJlbWllci5wbmc=?s=eb72ef69ef64353c59ff8a998496aff2)
  [View Premier](/editions-and-pricing/duo-premier)

  ![A circular icon featuring a green and white design, symbolizing freshness and simplicity.](/img/asset/aW1nL2ljb25zL25hdi9kdW8tZnJlZS5wbmc=?s=b55982c88f5fd6c13726caa710ccb707)
  ### Have a team of 10 users or less?

  [Learn more about Duo Free](/editions-and-pricing/duo-free)

  ### Have a team of 10 users or less?

  ![A circular icon featuring a green and white design, symbolizing freshness and simplicity.](/img/asset/aW1nL2ljb25zL25hdi9kdW8tZnJlZS5wbmc=?s=b55982c88f5fd6c13726caa710ccb707)
  [Learn more about Duo Free](/editions-and-pricing/duo-free)
* [Duo Blog](/blog)
* [Docs & Support](/docs)
  ### [See All Duo Documentation](/docs)

  ### [Getting Started with Duo](/docs/getting-started)

  ### [Free Trial Onboarding Guide](/support/free-trial-onboarding-guide)

  ### [Duo Essentials Edition](/docs#duo-essentials-features)

  ### [Remote Access & VPN](/docs#remote-access-and-vpn)

  ### [See All Duo Resources](/resources)

  ### [Events & Webinars](/resources/events)

  ### [eBooks](/resources/ebooks)

  ### [Duo Videos](/resources/videos)

  ### [See all Duo Support](/support)

  ### [Support for Duo Users](/support#enduserresources)

  ### [Support for Admins](/support#adminresources)

  ### [Additional Support Information](https://help.duo.com/s/?language=en_US)

Search

[Duo Blog](/blog)

* [Docs & Support](/docs)
  + [See All Duo Documentation](/docs)
    - [Getting Started with Duo](/docs/getting-started)
    - [Free Trial Onboarding Guide](/support/free-trial-onboarding-guide)
    - [Duo Essentials Edition](/docs#duo-essentials-features)
    - [Remote Access & VPN](/docs#remote-access-and-vpn)
  + [See All Duo Resources](/resources)
    - [Events & Webinars](/resources/events)
    - [eBooks](/resources/ebooks)
    - [Duo Videos](/resources/videos)
  + [See all Duo Support](/support)
    - [Support for Duo Users](/support#enduserresources)
    - [Support for Admins](/support#adminresources)
    - [Additional Support Information](https://help.duo.com/s/?language=en_US)

[Admin Login](https://admin.duosecurity.com/)

[Contact Sales](/about/contact)
[Free Trial](https://signup.duo.com)

[Contact Sales](/about/contact)
[Free Trial](https://signup.duo.com)

# Duo Product Security Advisory

**Advisory ID:** DUO-PSA-2020-003

**Publication Date:** 2020-06-30

**Revision Date:** 2020-06-30

**Status:** Confirmed, Fixed

**Document Revision:** 2

## Overview

Duo has identified and fixed an issue in the [Duo Connect](https://guide.duo.com/duoconnect) client that allows end-users to choose insecure configurations. If DuoConnect is incorrectly configured by the end-user via the ‘-relay’ switch to use “http://” rather than “https://”, then, under certain conditions, DuoConnect may send an authentication token to a Duo Network Gateway (DNG) instance over an unencrypted HTTP connection. An adversary could then use these tokens to bypass the DNG server and gain unauthenticated network access.

This issue was resolved in DuoConnect version 1.1.1 by enforcing HTTPS connections when communicating with the DNG server.

If you received this notification via email, Duo's analysis showed that you had at least one user use a DNG-SSH integration type for authentication in the last 90 days. See remediation steps below under "Solution."

## Description

The DuoConnect client enables users to establish SSH connections to hosts protected by a DNG instance. When a user initiates an SSH connection to a DNG-protected host for the first time using DuoConnect, the user’s browser is opened to a login screen in order to complete authentication determined by the contents of the '-relay' argument. If the ‘-relay’ is set to a URL beginning with "http://", then the browser will initially attempt to load the URL over an insecure HTTP connection, before being immediately redirected to HTTPS (in addition to standard redirect mechanisms, the DNG uses HTTP Strict Transport Security headers to enforce this).

After successfully authenticating to a DNG, DuoConnect stores an authentication token in a local system cache, so users do not have to complete this browser-based authentication workflow for every subsequent SSH connection. These tokens are valid for a configurable period of time, which defaults to 8 hours. If a user running DuoConnect already has a valid token, then instead of opening a web browser, DuoConnect directly contacts the DNG, again using the configured '-relay' value, and sends this token, as well as the intended SSH server hostname and port numbers. If the '-relay' argument begins with "http://", then this request will be sent over an insecure connection, and could be exposed to an attacker who is sniffing the traffic on the same network.

The DNG authentication tokens that may be exposed during SSH relay may be used to gain network-level access to the servers and ports protected by that given relay host. The DNG provides network-level access only to the protected SSH servers. It does not interact with the independent SSH authentication and encryption. An attacker cannot use a stolen token on its own to authenticate against a DNG-protected SSH server.

## Impact

An adversary who is able to monitor network traffic between an improperly-configured DuoConnect client and a DNG instance may be able to capture authentication tokens. These tokens could then be used to bypass DNG authentication, gaining network-level access to SSH servers that are protected by a DNG but they cannot be used on their own to authenticate against a DNG-protected SSH server.

## Affected Product(s)

This issue affects DuoConnect versions on all supported platforms before version 1.1.1.

## Solution

The Duo Product team has fixed the issue by updating DuoConnect to version 1.1.1, which rejects relay configurations that do not specify an HTTPS-based relay.

A DNG instance will automatically instruct users to install the latest version of DuoConnect. Duo administrators do not need to perform any manual updates unless their DNG is not able to connect to the internet to download the new version of the software. In that case, administrators should instruct end-users to download the latest DuoConnect version directly using the links below.

Steps required for end-user remediation:

* Update DuoConnect:
* End-users will need to update DuoConnect once prompted to do so by the DNG (users will be prompted to upgrade DuoConnect during authentication in their browser from July 7, 2020 onwards).
* The updated version of DuoConnect can alternatively be downloaded directly from the following locations at any time:
  Windows - <https://dl.duosecurity.com/DuoConnect-1.1.1.msi>

  macOS - <https://dl.duosecurity.com/DuoConnect-1.1.1.pkg>

  Linux - <https://dl.duosecurity.com/DuoConnect-1.1.1.tar.gz>

The signature of DuoConnect installer files can be verified at <https://duo.com/docs/checksums>.

End-users will need to update their DuoConnect SSH configuration if they receive the error message shown below:

Error: Invalid URL: relay scheme http://server-ssh.example.com invalid: must be https

Update the SSH configuration:
Locate the http relay in the SSH configuration e.g. “ProxyCommand duoconnect -host=%h:%p -relay=http://server-ssh.example.com”
Ensure the relay uses ‘https://’, and not ‘http://’

The SSH configuration for \*nix and macOS operating systems can be located at ~/.ssh/config. The SSH configuration for Windows operating systems can most commonly be found in the user directory C:\Users\username.ssh.

Additionally, you can refer to the “Configure SSH” section in the DuoConnect guide to learn more about steps for SSH configuration should you need further guidance.

## Vulnerability Metrics

**Vulnerability Class:** CWE-319: Cleartext Transmission of Sensitive Information

**Remotely Exploitable:** No

**Authentication Required:** No

**Severity:** Medium

**CVSSv3.1 Overall Score:** 2.8

**CVSSv3.1 Group Scores:** Base: 4.8, Temporal: 4.5

**CVSSv3.1 Vector:** AV:A/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N/E:F/RL:O/RC:C/CR:L/IR:X/AR:X/MAV:A/MAC:H/MPR:N/MUI:R/MS:U/MC:H/MI:N/MA:N

## Timeline

### 2020-06-05

* 11:33 EDT - During internal review, Duo identifies that cached authentication tokens can be sent over cleartext for one API call

### 2020-06-08

* 14:18 EDT - Duo verifies the issue and starts investigating the root cause of the problem

### 2020-06-15

* 17:44 EDT - Duo implements the fix

### 2020-06-18

* 16:30 EDT - Duo decides to release a security advisory for the issue

### 2020-06-23

* 11:00 EDT - Duo starts testing the fix on internal systems

### 2020-06-29

* 11:00 EDT - Duo finishes internal testing

### 2020-06-30

* 11:00 EDT - Duo rolls out version 1.1.1 of DuoConnect

### 2020-06-30

* 11:00 EDT - Duo distributes PSA to impacted customers

### 2020-07-07

* 11:00 EDT - DuoConnect update starts to show up on end-user’s devices

### 2020-07-15

* 12:00 EDT - Duo publishes the PSA.

## References

==========

* CWE-319: Cleartext Transmission of Sensitive Information - <https://cwe.mitre.org/data/definitions/319.html>
* Updating DuoConnect - <https://guide.duo.com/duoconnect#update>
* DuoConnect for SSH Access - <https://guide.duo.com/duoconnect>

## Credits/Contact

===============

If you have questions regarding this issue, please contact us at:

* support@duosecurity.com, referencing "DUO-PSA-2020-003" in the subject
* our phone line at +1(844) 386.6748. International customers can find our toll-free numbers here: https://duo.com/about/contact.

Or, reach out to your Customer Success Manager, as appropriate.

![Duo Security logo](/assets/img/duoLogo-web-white.png)

Search

### International Resources:

* Select Language
  Français
  Deutsch
  Español
  日本語

  Select Language
* [Français](/fr-ca)
  [Deutsch](/de/duo-overview)
  [Español](/es/duo-overview)
  [日本語](/ja-jp)

### Support

* #### Duo Support
* [Duo Support](/support)
* [System Status](https://status.duo.com/)

* #### Support for End Users
* [End User Guides](https://guide.duo.com/)
* [Duo Mobile FAQ](https://help.duo.com/s/topic/0TO70000000LIT2GAO/duo-mobile?language=en_US&tabset-5ba34=2)

* [Get Duo Mobile iOS](https://apps.apple.com/us/app/duo-mobile/id422663827?mt=8)
* [Get Duo Mobile Android](https://play.google.com/store/apps/details?id=com.duosecurity.duomobile&hl=en)

* #### Support for Admins
* [Knowledge Base](https://help.duo.com/s/?language=en_US)
* [Community Forum](https://community.cisco.com/t5/duo-security/ct-p/duo-security)

### Products

* #### [Key Capabilities](/product)
* [Duo Passport](/product/passport)
* [Cisco Identity Intelligence](/product/cisco-identity-intelligence)
* [Mobile App](/product/multi-factor-authentication-mfa/duo-mobile-app)
* [MFA](/product/multi-factor-authentication-mfa)
* [What is MFA](/product/multi-factor-authentication-mfa/what-is-mfa)
* [2FA](/product/multi-factor-authentication-mfa/two-factor-authentication-2fa)
* [Remote Access](/product/remote-access)
* [Device Trust](/product/device-trust)
* [Single Sign-On](/product/single-sign-on-sso)
* [Passwordless](/solutions/passwordless)
* [Zero Trust](/solutions/zero-trust-security)
* [Adaptive Access Policies](/product/adaptive-access-policies)
* #### [Duo Use Cases](/product)
* [State & Local Government](/product/state-and-local-government)
* [Federal Government](/product/federal-government)
* [Enterprise](/product/enterprise)
* [Small to Medium Business](/product/small-to-medium-business)

### Solutions

* #### [All Solutions](/solutions)
* [Continuous Identity Security](/solutions/continuous-identity-security)
* [Access Management](/solutions/access-management)
* [Zero Trust Security](/solutions/zero-trust-security)
* [Passwordless](/solutions/passwordless)
* [Phishing Prevention](/solutions/phishing-prevention)
* [Risk-Based Authentication](/solutions/risk-based-authentication)

### Editions & Partners

* #### [Editions](/editions-and-pricing)
* [Duo Editions](/editions-and-pricing)
* [Duo Free](/editions-and-pricing/duo-free)
* [Duo Essentials](/editions-and-pricing/duo-essentials)
* [Duo Advantage](/editions-and-pricing/duo-advantage)
* [Duo Premier](/editions-and-pricing/duo-premier)
* [Ready to Buy Now?](/editions-and-pricing/ready-to-buy-now)
* #### [Partner with Duo](/partnerships)
* [Partnership Program](/partnerships)
* [Technology Partner Program](/partnerships/technology-partners)
* [Managed Service Provider](/partnerships/managed-service-providers)
* [Security Solutions Provider](/partnerships/security-solution-providers)

### Resources & Docs

* #### [Resources](/resources)
* [About Duo](/about)
* [Careers](/careers)
* [News & Press](/resources/news-and-press)
* [Events & Webinars](/resources/events)
* [Ebooks](/resources/ebooks)
* [Duo Videos](/resources/videos)
* [Interactive Demos](/demos)
* [InfoSec Glossary](/resources/glossary)
* #### [Docs](/docs)
* [Getting Started with Duo](/docs/getting-started)
* [Free Trial Onboarding Guide](/support/free-trial-onboarding-guide)
* [Admin Overview](/docs/administration)
* [End User Guide](https://guide.duo.com/)
* [Docs for Duo Editions](/docs)
* [Docs for Duo Integrations](/docs)

**© 2025 Duo**

* [Terms of Service](/legal/terms)
* [Privacy Statement](/legal/cisco-online-privacy-statement)
* [Duo Privacy Data Sheet](https://trustportal.cisco.com/c/dam/r/ctp/docs/privacydatasheet/security/cisco-duo-privacy-data-sheet.pdf)
* [Copyright Dispute Policy](https://www.cisco.com/c/en/us/about/legal/terms-conditions.html)
* [Service Level Agreement](/legal/sla)
* [Security Response](/support/security-and-reliability/security-response)
* [Cookies](#privacy-manager "Cisco Cookie Consent Manager")

[Top](#top)


