```
{
  "CVE-2020-3964": {
    "root_cause": "An information leak vulnerability exists in the EHCI USB controller due to a missing return value check in the `EhciReadTDBuffer()` function.",
    "weaknesses": [
      "The `EhciReadTDBuffer()` function does not validate the return value of `ReadBytes`, which reads data from a guest-controlled memory address."
    ],
    "impact": "A malicious actor with local access to a virtual machine can exploit this vulnerability to read privileged information from the hypervisor's memory.",
    "attack_vectors": [
      "A guest can provide a crafted qTD (queue element transfer descriptor) with a guest physical address (GPA) of zero, causing `ReadBytes` to fail and resulting in the use of an uninitialized heap buffer for the URB (USB request block).",
      "By sending a SCSI write command to a USB mass storage device, a guest can leak the uninitialized heap data. This is because the hypervisor does not zero out the allocated buffer for the URB."
    ],
    "required_attacker_capabilities": [
      "Local access to a virtual machine",
       "Ability to control the qTDs sent to the EHCI USB controller"
    ],
    "details": "The vulnerability occurs because the `EhciReadTDBuffer()` function, which reads the contents of a URB into a heap buffer, does not check the return value of the `ReadBytes()` function. A guest can force `ReadBytes()` to fail by providing a zero or non-canonical address as the GPA. This leads to a scenario where uninitialized heap data is copied into the URB buffer and subsequently exposed to the guest."
  }
}
```