=== Content from github.com_964b5fd0_20250119_114910.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMariaDB%2Fserver%2Fcommit%2F9d18b6246755472c8324bf3e20e234e08ac45618)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMariaDB%2Fserver%2Fcommit%2F9d18b6246755472c8324bf3e20e234e08ac45618)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=MariaDB%2Fserver)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[MariaDB](/MariaDB)
/
**[server](/MariaDB/server)**
Public

* [Notifications](/login?return_to=%2FMariaDB%2Fserver) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2FMariaDB%2Fserver)
* [Star
   5.8k](/login?return_to=%2FMariaDB%2Fserver)

* [Code](/MariaDB/server)
* [Pull requests
  250](/MariaDB/server/pulls)
* [Actions](/MariaDB/server/actions)
* [Security](/MariaDB/server/security)
* [Insights](/MariaDB/server/pulse)

Additional navigation options

* [Code](/MariaDB/server)
* [Pull requests](/MariaDB/server/pulls)
* [Actions](/MariaDB/server/actions)
* [Security](/MariaDB/server/security)
* [Insights](/MariaDB/server/pulse)

## Commit

[Permalink](/MariaDB/server/commit/9d18b6246755472c8324bf3e20e234e08ac45618)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

rpm/deb and auth\_pam\_tool\_dir/auth\_pam\_tool

[Browse files](/MariaDB/server/tree/9d18b6246755472c8324bf3e20e234e08ac45618)
Browse the repository at this point in the history

```
don't let mysql_install_db set SUID bit for auth_pam_tool in rpm/deb
packages - instead package files with correct permissions and
only fix the ownership of auth_pam_tool_dir (which can only be done
after mysql user is created, so in post-install).

keep old mysql_install_db behavior for bintars
```

* Loading branch information

[![@vuvova](https://avatars.githubusercontent.com/u/2737648?s=40&v=4)](/vuvova)

[vuvova](/MariaDB/server/commits?author=vuvova "View all commits by vuvova")
committed
Jan 17, 2020

1 parent
[7e378a8](/MariaDB/server/commit/7e378a8d3140e8b8eec9f13a29b4e25ebcad3288)

commit 9d18b62

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**18 additions**
and
**14 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* debian

  + debian/mariadb-server-10.4.postinst
    [mariadb-server-10.4.postinst](#diff-3f5831385f223953e9d3e8bc4cc1b546c6294e48c39f3c9a3bb8f1e7977eea67)
  + debian/rules
    [rules](#diff-889c5495b68d2a0c0d1f238818716a71939918499efbc0fc6d2994319624fc67)
* scripts

  + scripts/mysql\_install\_db.sh
    [mysql\_install\_db.sh](#diff-eb6507e912b5bc16c616f9eec6c73842a481c366b76fb6d97bb124f821ef139d)
* support-files/rpm

  + support-files/rpm/server-postin.sh
    [server-postin.sh](#diff-a5ce6bedcfa42077f9983cf9ae753f2e2875d105b81b8cb38b96ba74171d6fdc)

## There are no files selected for viewing

3 changes: 3 additions & 0 deletions

3
[debian/mariadb-server-10.4.postinst](#diff-3f5831385f223953e9d3e8bc4cc1b546c6294e48c39f3c9a3bb8f1e7977eea67 "debian/mariadb-server-10.4.postinst")

Show comments

[View file](/MariaDB/server/blob/9d18b6246755472c8324bf3e20e234e08ac45618/debian/mariadb-server-10.4.postinst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -94,6 +94,9 @@ EOF |
|  |  | chmod 2750 $mysql\_logdir |
|  |  | set -e |
|  |  |  |
|  |  | # Set the correct filesystem ownership for the PAM v2 plugin |
|  |  | chown mysql /usr/lib/mysql/plugin/auth\_pam\_tool\_dir |
|  |  |  |
|  |  | # This is important to avoid dataloss when there is a removed |
|  |  | # mysql-server version from Woody lying around which used the same |
|  |  | # data directory and then somewhen gets purged by the admin. |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[debian/rules](#diff-889c5495b68d2a0c0d1f238818716a71939918499efbc0fc6d2994319624fc67 "debian/rules")

Show comments

[View file](/MariaDB/server/blob/9d18b6246755472c8324bf3e20e234e08ac45618/debian/rules)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -146,6 +146,10 @@ endif |
|  |  | ln -s libmariadb.so.3 $(TMP)/usr/lib/$(DEB\_HOST\_MULTIARCH)/libmysqlclient.so.19 |
|  |  | ln -s libmariadb.so.3 $(TMP)/usr/lib/$(DEB\_HOST\_MULTIARCH)/libmysqlclient.so.20 |
|  |  |  |
|  |  | override\_dh\_fixperms: |
|  |  | dh\_fixperms |
|  |  | chmod 04755 debian/mariadb-server-10.4/usr/lib/mysql/plugin/auth\_pam\_tool\_dir/auth\_pam\_tool |
|  |  | chmod 0700 debian/mariadb-server-10.4/usr/lib/mysql/plugin/auth\_pam\_tool\_dir |
|  |  |  |
|  |  | override\_dh\_installlogrotate-arch: |
|  |  | dh\_installlogrotate --name mysql-server |
| Expand Down | |  |

18 changes: 9 additions & 9 deletions

18
[scripts/mysql\_install\_db.sh](#diff-eb6507e912b5bc16c616f9eec6c73842a481c366b76fb6d97bb124f821ef139d "scripts/mysql_install_db.sh")

Show comments

[View file](/MariaDB/server/blob/9d18b6246755472c8324bf3e20e234e08ac45618/scripts/mysql_install_db.sh)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -478,16 +478,8 @@ do |
|  |  | fi |
|  |  | done |
|  |  |  |
|  |  | if test -n "$user" |
|  |  | if test -n "$user" -a "$in\_rpm" -eq 0 |
|  |  | then |
|  |  | chown $user "$pamtooldir/auth\_pam\_tool\_dir" && \ |
|  |  | chmod 0700 "$pamtooldir/auth\_pam\_tool\_dir" |
|  |  | if test $? -ne 0 |
|  |  | then |
|  |  | echo "Cannot change ownership of the '$pamtooldir/auth\_pam\_tool\_dir' directory" |
|  |  | echo " to the '$user' user. Check that you have the necessary permissions and try again." |
|  |  | exit 1 |
|  |  | fi |
|  |  | if test -z "$srcdir" |
|  |  | then |
|  |  | chown 0 "$pamtooldir/auth\_pam\_tool\_dir/auth\_pam\_tool" && \ |
| Expand All | | @@ -499,6 +491,14 @@ then |
|  |  | echo |
|  |  | fi |
|  |  | fi |
|  |  | chown $user "$pamtooldir/auth\_pam\_tool\_dir" && \ |
|  |  | chmod 0700 "$pamtooldir/auth\_pam\_tool\_dir" |
|  |  | if test $? -ne 0 |
|  |  | then |
|  |  | echo "Cannot change ownership of the '$pamtooldir/auth\_pam\_tool\_dir' directory" |
|  |  | echo " to the '$user' user. Check that you have the necessary permissions and try again." |
|  |  | exit 1 |
|  |  | fi |
|  |  | args="$args --user=$user" |
|  |  | fi |
|  |  |  |
| Expand Down | |  |

7 changes: 2 additions & 5 deletions

7
[support-files/rpm/server-postin.sh](#diff-a5ce6bedcfa42077f9983cf9ae753f2e2875d105b81b8cb38b96ba74171d6fdc "support-files/rpm/server-postin.sh")

Show comments

[View file](/MariaDB/server/blob/9d18b6246755472c8324bf3e20e234e08ac45618/support-files/rpm/server-postin.sh)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -69,11 +69,8 @@ if [ $1 = 1 ] ; then |
|  |  | chmod -R og-rw $datadir/mysql |
|  |  | fi |
|  |  |  |
|  |  | # Set correct filesystem ownership/permissions for the PAM v2 plugin |
|  |  | chown %{mysqld\_group} /usr/lib\*/mysql/plugin/auth\_pam\_tool\_dir |
|  |  | chmod 0700 /usr/lib\*/mysql/plugin/auth\_pam\_tool\_dir |
|  |  | chown 0 /usr/lib\*/mysql/plugin/auth\_pam\_tool\_dir/auth\_pam\_tool |
|  |  | chmod 04755 /usr/lib\*/mysql/plugin/auth\_pam\_tool\_dir/auth\_pam\_tool |
|  |  | # Set the correct filesystem ownership for the PAM v2 plugin |
|  |  | chown %{mysqld\_user} /usr/lib\*/mysql/plugin/auth\_pam\_tool\_dir |
|  |  |  |
|  |  | # install SELinux files - but don't override existing ones |
|  |  | SETARGETDIR=/etc/selinux/targeted/src/policy |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9d18b62`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMariaDB%2Fserver%2Fcommit%2F9d18b6246755472c8324bf3e20e234e08ac45618) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from seclists.org_473aefca_20250119_114911.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![oss-sec logo](/images/oss-sec-logo.png)](/oss-sec/)
## [oss-sec](/oss-sec/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](54)
[By Date](date.html#55)
[![Next](/images/right-icon-16x16.png)](56)

[![Previous](/images/left-icon-16x16.png)](54)
[By Thread](index.html#55)
[![Next](/images/right-icon-16x16.png)](56)

![](/shared/images/nst-icons.svg#search)

# CVE-2020-7221: mariadb: possible local mysql to root user exploit in mysql\_install\_db script setting permissions of /usr/lib64/mysql/plugin/auth\_pam\_tool\_dir/auth\_pam\_tool

---

*From*: Matthias Gerstner <mgerstner () suse de>

*Date*: Tue, 4 Feb 2020 11:26:04 +0100

---

```
Hello list,

in the course of a review of a newly added setuid-root binary
(auth_pam_tool) in recent mariadb releases I discovered a local mysql
user to root privilege escalation.

The issue stems from the mysql_install_db script where the following
lines are found in mariadb releases ranging from 10.4.7 up and including
to 10.4.11:

```
    if test -n "$user"
    then
      chown $user "$pamtooldir/auth_pam_tool_dir" && \
      chmod 0700 "$pamtooldir/auth_pam_tool_dir"
      if test $? -ne 0
      then
          echo "Cannot change ownership of the '$pamtooldir/auth_pam_tool_dir' directory"
          echo " to the '$user' user. Check that you have the necessary permissions and try again."
          exit 1
      fi
      if test -z "$srcdir"
      then
        chown 0 "$pamtooldir/auth_pam_tool_dir/auth_pam_tool" && \
        chmod 04755 "$pamtooldir/auth_pam_tool_dir/auth_pam_tool"
        if test $? -ne 0
        then
            echo "Couldn't set an owner to '$pamtooldir/auth_pam_tool_dir/auth_pam_tool'."
            echo " It must be root, the PAM authentication plugin doesn't work otherwise.."
            echo
        fi
      fi
      args="$args --user=$user"
    fi
```

In a typical MariaDB installation where $user is set to the mysql user
this will perform the following sequence of commands as root:

```
    chown mysql /usr/lib64/mysql/plugin/auth_pam_tool_dir
    chmod 0700 /usr/lib64/mysql/plugin/auth_pam_tool_dir
    chown 0 /usr/lib64/mysql/plugin/auth_pam_tool_dir/auth_pam_tool
    chmod 04755 /usr/lib64/mysql/plugin/auth_pam_tool_dir/auth_pam_tool
```

These steps are executed unconditionally no matter what the current
owner and mode of the auth_pam_tool_dir are. If the mysql account is
compromised then an attacker can prepare a symlink attack or simply
place an arbitrary binary in auth_pam_tool_dir/auth_pam_tool which will
gain setuid-root privileges once mysql_install_db is run. This way the
mysql user can gain full root privileges easily.

The mysql_install_db script can be invoked automatically, depending on
the actual integration into a Linux distribution, e.g. during RPM
installation time or during systemd service start time. It can also be
invoked interactively by an Administrator (it is placed in /usr/bin).

Upstream decided to fix [1] this issue by only executing the commands in
question when the `--rpm` command line parameter is *not* passed. Thus
in typical package manager integrations the vulnerability hopefully
doesn't show any more by default. It will still occur when
Administrators interactively run the command without the `--rpm` switch.
The rationale behind this is support for users that extract tarballs
manually (probably without correctly preserving permissions) to install
MariaDB.

For Deb/RPM packaging MariaDB continues to suggest to use the following
dir and file modes [2], [3]:

mysql:root  0700 /usr/lib/mysql/plugin/auth_pam_tool_dir
 root:root 04755 /usr/lib/mysql/plugin/auth_pam_tool_dir/auth_pam_tool

I personally suggest the following directory mode instead:

root:mysql  0750 /usr/lib/mysql/plugin/auth_pam_tool_dir

This way the hardening is still intact (i.e. the setuid-root binary is
not publically available to users in the system, but only to members of
the mysql group) while the dangerous situation of a setuid-root binary
residing in a directory owned by an unprivileged user is avoided. The
latter situation can easily lead to race conditions e.g. when programs
try to replace the "auth_pam_tool" binary with a new version.

I also recommend a patch of the mysql_install_db script towards this
directory mode, to make the default behaviour of the script more secure.

Cheers

Matthias

Timeline
--------

2020-01-14: I privately reported the issue at security () mariadb org.
2020-01-14: Upstream replied and confirmed the issue. They asked me to
  wait until the next release of MariaDB before publication of the
  issue.
2020-01-16: I attempted a deeper technical discussion with upstream
  about an appropriate fix, but it died down. I shared a CVE for use
  with this issue with upstream.
2020-01-28: MariaDB 10.4.12 got released, containing an attempted fix
  for the issue. I was not informed about the publication by upstream.

References
----------

[1]: <https://github.com/MariaDB/server/commit/9d18b6246755472c8324bf3e20e234e08ac45618>
[2]: <https://github.com/MariaDB/server/blob/mariadb-10.4.12/debian/rules#L151>
[3]: <https://github.com/MariaDB/server/blob/mariadb-10.4.12/plugin/auth_pam/CMakeLists.txt#L20>
[4]: <https://bugzilla.suse.com/show_bug.cgi?id=1160868>

--
Matthias Gerstner <matthias.gerstner () suse de>
Dipl.-Wirtsch.-Inf. (FH), Security Engineer
<https://www.suse.com/security>
Phone: +49 911 740 53 290
GPG Key ID: 0x14C405C971923553

SUSE Software Solutions Germany GmbH
HRB 36809, AG Nürnberg
Geschäftsführer: Felix Imendörffer

```

**Attachment:
[signature.asc](att-55/signature_asc.bin)**

*Description:*

---

[![Previous](/images/left-icon-16x16.png)](54)
[By Date](date.html#55)
[![Next](/images/right-icon-16x16.png)](56)

[![Previous](/images/left-icon-16x16.png)](54)
[By Thread](index.html#55)
[![Next](/images/right-icon-16x16.png)](56)

### Current thread:

* **CVE-2020-7221: mariadb: possible local mysql to root user exploit in mysql\_install\_db script setting permissions of /usr/lib64/mysql/plugin/auth\_pam\_tool\_dir/auth\_pam\_tool** *Matthias Gerstner (Feb 04)*
  + [Re: CVE-2020-7221: mariadb: possible local mysql to root user exploit in mysql\_install\_db script setting permissions of /usr/lib64/mysql/plugin/auth\_pam\_tool\_dir/auth\_pam\_tool](56) *Solar Designer (Feb 04)*
    - [Re: CVE-2020-7221: mariadb: possible local mysql to root user exploit in mysql\_install\_db script setting permissions of /usr/lib64/mysql/plugin/auth\_pam\_tool\_dir/auth\_pam\_tool](57) *Matthias Gerstner (Feb 04)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from bugzilla.suse.com_ca3b7205_20250119_114909.html ===


| Bugzilla – Bug 1160868 | VUL-0: CVE-2020-7221: mariadb: auth\_pam\_tool runtime permission setting allows privilege escalation from mysql user to root | Last modified: 2023-12-29 12:30:14 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1160868)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 1160868**](show_bug.cgi?id=1160868)
- VUL-0: CVE-2020-7221: mariadb: auth\_pam\_tool runtime permission setting allows privilege escalation from mysql user to root

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2020-7221: mariadb: auth\_pam\_tool runtime permission setting allow...

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Normal | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Kristyna Streitova | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/250855/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1160285](show_bug.cgi?id=1160285 "RESOLVED FIXED") | |  | Show dependency [tree](showdependencytree.cgi?id=1160868&hide_resolved=1) / [graph](showdependencygraph.cgi?id=1160868) | |  | | Reported: | 2020-01-14 09:42 UTC by Matthias Gerstner | | --- | --- | | Modified: | 2023-12-29 12:30 UTC ([History](show_activity.cgi?id=1160868)) | | CC List: | 4 users (show)  atoptsoglou jsegitz matthias.gerstner security-team | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1160868) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**disarm mysql\_install\_db default behaviour**](attachment.cgi?id=829037 "View the content of the attachment") (1.81 KB, patch)  [2020-02-04 10:56 UTC](#attach_829037 "Go to the comment associated with the attachment"), Matthias Gerstner | [Details](attachment.cgi?id=829037&action=edit) | [Diff](attachment.cgi?id=829037&action=diff) | | [View All](attachment.cgi?bugid=1160868&action=viewall)  [Add an attachment](attachment.cgi?bugid=1160868&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1160868&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1160868#c0)  Matthias Gerstner   2020-01-14 09:42:24 UTC  ``` I've recently sent a security report to MariaDBs security contact about a local mysql to root user privilege escalation. This is related to the auth_pam_tool setuid binary which I audited in [bug 1160285](show_bug.cgi?id=1160285 "RESOLVED FIXED"). The report goes as follows:  > Hello MariaDB security team, >  > in the course of a security audit of the new "auth_pam_tool" setuid root > binary in MariaDB I have found a potential security issue. I have been > looking into MariaDB version 10.4.10 for this purpose. >  > The issue is a possible local mysql to root user privilege escalation. > It stems from the mysql_install_db script where the following lines are > found: >  > ``` > if test -n "$user" > then >   chown $user "$pamtooldir/auth_pam_tool_dir" && \ >   chmod 0700 "$pamtooldir/auth_pam_tool_dir" >   if test $? -ne 0 >   then >       echo "Cannot change ownership of the '$pamtooldir/auth_pam_tool_dir' directory" >       echo " to the '$user' user. Check that you have the necessary permissions and try again." >       exit 1 >   fi >   if test -z "$srcdir" >   then >     chown 0 "$pamtooldir/auth_pam_tool_dir/auth_pam_tool" && \ >     chmod 04755 "$pamtooldir/auth_pam_tool_dir/auth_pam_tool" >     if test $? -ne 0 >     then >         echo "Couldn't set an owner to '$pamtooldir/auth_pam_tool_dir/auth_pam_tool'." >         echo " It must be root, the PAM authentication plugin doesn't work otherwise.." >         echo >     fi >   fi >   args="$args --user=$user" > fi > ``` >  > In a typical MariaDB installation where $user is set to the mysql user > this will perform the following commands as root: >  > ``` > chown mysql /usr/lib64/mysql/plugin/auth_pam_tool_dir > chmod 0700 /usr/lib64/mysql/plugin/auth_pam_tool_dir > chown 0 /usr/lib64/mysql/plugin/auth_pam_tool_dir/auth_pam_tool > chmod 04755 /usr/lib64/mysql/plugin/auth_pam_tool_dir/auth_pam_tool > ``` >  > These steps are executed unconditionally no matter what the current > owner and mode of the auth_pam_tool_dir are. If the mysql account is > compromised then an attacker can prepare a symlink attack or simply > place an arbitrary binary in auth_pam_tool_dir/auth_pam_tool which will > gain setuid-root privileges once mysql_install_db is run. This way the > mysql user can gain full root privileges easily. >  > My recommendations to make this secure are as follows: >  > - let the directory auth_pam_tool_dir be owned by root:root, mode 755. >  > - let the setuid-binary auth_pam_tool be owned by root:mysql, mode 750. >  > - don't actively modify file system permissions during DB setup, only >   inspect the permissions and warn or fail if they're not correct. Let >   instead the OS packaging take care of correct permissions. Or use >   systemd-tmpfiles which is able to adjust permissions in a safe manner. >   mariadb already ships a sytemd-tmpfiles configuration file that could >   be used for this purpose. >  > This way only members of the mysql group can access the setuid-root > binary and the attack surface is lowered. ``` [Comment 1](show_bug.cgi?id=1160868#c1)  Matthias Gerstner   2020-01-14 09:49:24 UTC  ``` This finding here also show sthat the permissions originally requested in audit [bug 1160285](show_bug.cgi?id=1160285 "RESOLVED FIXED") conflict with the current upstream implementation. But since the upstream implementation is buggy we should wait for them to fix it and then decide what to do in our packaging. ``` [Comment 2](show_bug.cgi?id=1160868#c2)  Matthias Gerstner   2020-01-14 09:51:10 UTC  ``` Please note that this report here is still confidential and we can't publish any information about it before we've agreed with upstream about a publication date. ``` [Comment 3](show_bug.cgi?id=1160868#c3)  Matthias Gerstner   2020-01-14 10:05:54 UTC  ``` Info for reactive security: We didn't ship this setuid-binary yet in any product so we're actually not affected. But we should still track this since we found it and manage the embargo, and we need to avoid packaging this in its current form. ``` [Comment 4](show_bug.cgi?id=1160868#c4)  Matthias Gerstner   2020-01-16 12:53:22 UTC  ``` Upstream replied by now. They acknowledge the issue but the way of fixing it is a bit disputed. At least they will make a change that causes this chown logic to be disabled if mysql_install_db is called with the --rpm parameter. The logic is originally intended for people who use tarballs and mess up permissions.  There is no fixed CRD, they want us to keep this private until their next release (scheduled for the end of this month) is out. They will ping me when this happens. ``` [Comment 5](show_bug.cgi?id=1160868#c5)  Matthias Gerstner   2020-01-20 08:49:48 UTC  ``` Upstream sees no urgent need for a CVE and left it to mee to request one. So I requested one from Mitre. ``` [Comment 6](show_bug.cgi?id=1160868#c6)  Matthias Gerstner   2020-01-20 09:00:04 UTC  ``` This upstream fix [1] will prevent the chmod/chown logic to trigger in the RPM packaging context. We should either apply this patch or wait for the next MariaDB release which is supposed to be finished by end of this month.  [1]: <https://github.com/MariaDB/server/commit/9aa1d516f135b299> ``` [Comment 7](show_bug.cgi?id=1160868#c7)  Kristyna Streitova   2020-01-21 15:49:02 UTC  ``` I think we can wait till the next MariaDB release if they really finish it by the end of this month. ``` [Comment 8](show_bug.cgi?id=1160868#c8)  Matthias Gerstner   2020-02-03 11:40:18 UTC  ``` It seems the communication with upstream didn't work out so well. There's a 10.4.12 release [1] available now that changes something in this area [2]. They didn't even include the CVE number I pulled for them.  Basically this means that this bug here can be published an a posting on oss-sec is probably in order.  [1]: <https://mariadb.com/kb/en/mariadb-10412-changelog/> [2]: <https://github.com/MariaDB/server/commit/9d18b62467> ``` [Comment 11](show_bug.cgi?id=1160868#c11)  Matthias Gerstner   2020-02-04 10:30:28 UTC  ``` I just posted an email describing this vulnerability to the oss-sec mailing list.  The "fix" in upstream release 10.4.12 looks incomplete to me. They now leave the permissions of auth_pam_tool_dir and auth_pam_tool alone when mysql_install_db is invoked with the `--rpm` switch. However they still propagate the directory ownership and mode "mysql:root 0700" for packagers. Also when mysql_install_db is invoked without `--rpm` then the issue still occurs, which can easily happen when an Administrator runs it manually.  I agreed with kstreitova that we can accept this upstream release 10.4.12 when our packaging uses ownership and mode "root:mysql 07500" instead. Now that I'm thinking about it I also like to add another patch for the mysql_install_db script to sanitize the default behaviour of the script. I will share the patch soon. ``` [Comment 12](show_bug.cgi?id=1160868#c12)  Matthias Gerstner   2020-02-04 10:50:11 UTC  ``` oss-sec posting can be found here: <https://seclists.org/oss-sec/2020/q1/55> ``` [Comment 13](show_bug.cgi?id=1160868#c13)  Matthias Gerstner   2020-02-04 10:56:07 UTC  ``` Created [attachment 829037](attachment.cgi?id=829037&action=diff "disarm mysql_install_db default behaviour") [[details]](attachment.cgi?id=829037&action=edit "disarm mysql_install_db default behaviour") disarm mysql_install_db default behaviour ``` [Comment 14](show_bug.cgi?id=1160868#c14)  Matthias Gerstner   2020-02-04 11:01:58 UTC  ``` The patch in [attachment 829037](attachment.cgi?id=829037&action=diff "disarm mysql_install_db default behaviour") [[details]](attachment.cgi?id=829037&action=edit "disarm mysql_install_db default behaviour") will remove the dangerous behaviour of mysql_install_db. I want it to be added in our packaging. We don't expect our customers to extract tarballs manually in the system, thus we won't ever benefit from those dangerous chown/chmod calls. Instead my patch changes the code to just warn the caller if the mode is not the expected one.  @kstreitova: I've submitted sr#769946 towards your home project to add this patch and also fixes the name of the other patch. ``` [Comment 16](show_bug.cgi?id=1160868#c16)  Matthias Gerstner   2020-02-06 08:43:17 UTC  ``` From the security side this bug is finished. Since we never shipped this vulnerability we don't need to track anything for older codestreams. The patches I asked for are present in Factory and have been submitted to SLE-15-SP2. So when you think you're done you may close the bug. ``` [Comment 18](show_bug.cgi?id=1160868#c18)  Kristyna Streitova   2020-02-07 18:02:12 UTC  ``` |    Codestream    | Request | |------------------|---------| | openSUSE:Factory | #772117 | | SLE15SP2         | #210871 |  I'm closing it as fixed. ``` [Comment 25](show_bug.cgi?id=1160868#c25)  Maintenance Automation   2023-10-04 08:32:51 UTC  ``` SUSE-RU-2023:3956-1: An update that solves 221 vulnerabilities and contains three features can now be installed.  Category: recommended (moderate) Bug References: 1001367, 1005555, 1005558, 1005562, 1005564, 1005566, 1005569, 1005581, 1005582, 1006539, 1008253, 1012075, 1013882, 1019948, 1020873, 1020875, 1020877, 1020878, 1020882, 1020884, 1020885, 1020890, 1020891, 1020894, 1020896, 1020976, 1022428, 1038740, 1039034, 1041525, 1041891, 1042632, 1043328, 1047218, 1055165, 1055268, 1058374, 1058729, 1060110, 1062583, 1067443, 1068906, 1069401, 1080891, 1083087, 1088681, 1092544, 1098683, 1101676, 1101677, 1101678, 1103342, 1111858, 1111859, 1112368, 1112377, 1112384, 1112386, 1112391, 1112397, 1112404, 1112415, 1112417, 1112421, 1112432, 1112767, 1116686, 1118754, 1120041, 1122198, 1122475, 1127027, 1132666, 1136035, 1142909, 1143215, 1144314, 1156669, 1160285, 1160868, 1160878, 1160883, 1160895, 1160912, 1166781, 1168380, 1170204, 1173028, 1173516, 1174559, 1175596, 1177472, 1178428, 1180014, 1182218, 1182255, 1182739, 1183770, 1185870, 1185872, 1186031, 1189320, 1192497, 1195325, 1195334, 1195339, 1196016, 1197459, 1198603, 1198604, 1198605, 1198606, 1198607, 1198609, 1198610, 1198611, 1198612, 1198613, 1198628, 1198629, 1198630, 1198631, 1198632, 1198633, 1198634, 1198635, 1198636, 1198637, 1198638, 1198639, 1198640, 1199928, 1200105, 1201161, 1201163, 1201164, 1201165, 1201166, 1201167, 1201168, 1201169, 1201170, 1202863, 332530, 353120, 357634, 359522, 366820, 371000, 387746, 420313, 425079, 427384, 429618, 435519, 437293, 463586, 520876, 525065, 525325, 539243, 539249, 557669, 635645, 747811, 763150, 779476, 789263, 792444, 796164, 829430, 841709, 859345, 889126, 894479, 902396, 914370, 921955, 934789, 937754, 937767, 937787, 942908, 943096, 957174, 963810, 971456, 979524, 983938, 984858, 986251, 989913, 989919, 989922, 989926, 990890, 998309 CVE References: CVE-2006-0903, CVE-2006-4226, CVE-2006-4227, CVE-2007-5969, CVE-2007-5970, CVE-2007-6303, CVE-2007-6304, CVE-2008-2079, CVE-2008-7247, CVE-2009-4019, CVE-2009-4028, CVE-2009-4030, CVE-2012-4414, CVE-2012-5611, CVE-2012-5612, CVE-2012-5615, CVE-2012-5627, CVE-2013-1976, CVE-2015-4792, CVE-2015-4802, CVE-2015-4807, CVE-2015-4815, CVE-2015-4816, CVE-2015-4819, CVE-2015-4826, CVE-2015-4830, CVE-2015-4836, CVE-2015-4858, CVE-2015-4861, CVE-2015-4864, CVE-2015-4866, CVE-2015-4870, CVE-2015-4879, CVE-2015-4895, CVE-2015-4913, CVE-2015-5969, CVE-2015-7744, CVE-2016-0505, CVE-2016-0546, CVE-2016-0596, CVE-2016-0597, CVE-2016-0598, CVE-2016-0600, CVE-2016-0606, CVE-2016-0608, CVE-2016-0609, CVE-2016-0610, CVE-2016-0616, CVE-2016-0640, CVE-2016-0641, CVE-2016-0642, CVE-2016-0644, CVE-2016-0646, CVE-2016-0649, CVE-2016-0650, CVE-2016-0651, CVE-2016-0668, CVE-2016-2047, CVE-2016-3477, CVE-2016-3492, CVE-2016-3521, CVE-2016-3615, CVE-2016-5440, CVE-2016-5584, CVE-2016-5616, CVE-2016-5624, CVE-2016-5626, CVE-2016-5629, CVE-2016-6662, CVE-2016-6663, CVE-2016-6664, CVE-2016-7440, CVE-2016-8283, CVE-2016-9843, CVE-2017-10268, CVE-2017-10286, CVE-2017-10320, CVE-2017-10365, CVE-2017-10378, CVE-2017-10379, CVE-2017-10384, CVE-2017-15365, CVE-2017-3238, CVE-2017-3243, CVE-2017-3244, CVE-2017-3257, CVE-2017-3258, CVE-2017-3265, CVE-2017-3291, CVE-2017-3302, CVE-2017-3308, CVE-2017-3309, CVE-2017-3312, CVE-2017-3313, CVE-2017-3317, CVE-2017-3318, CVE-2017-3453, CVE-2017-3456, CVE-2017-3464, CVE-2017-3636, CVE-2017-3641, CVE-2017-3653, CVE-2018-25032, CVE-2018-2562, CVE-2018-2612, CVE-2018-2622, CVE-2018-2640, CVE-2018-2665, CVE-2018-2668, CVE-2018-2755, CVE-2018-2759, CVE-2018-2761, CVE-2018-2766, CVE-2018-2767, CVE-2018-2771, CVE-2018-2777, CVE-2018-2781, CVE-2018-2782, CVE-2018-2784, CVE-2018-2786, CVE-2018-2787, CVE-2018-2810, CVE-2018-2813, CVE-2018-2817, CVE-2018-2819, CVE-2018-3058, CVE-2018-3060, CVE-2018-3063, CVE-2018-3064, CVE-2018-3066, CVE-2018-3143, CVE-2018-3156, CVE-2018-3162, CVE-2018-3173, CVE-2018-3174, CVE-2018-3185, CVE-2018-3200, CVE-2018-3251, CVE-2018-3277, CVE-2018-3282, CVE-2018-3284, CVE-2019-18901, CVE-2019-2510, CVE-2019-2537, CVE-2019-2614, CVE-2019-2627, CVE-2019-2628, CVE-2019-2737, CVE-2019-2739, CVE-2019-2740, CVE-2019-2758, CVE-2019-2805, CVE-2019-2938, CVE-2019-2974, CVE-2020-13249, CVE-2020-14765, CVE-2020-14776, CVE-2020-14789, CVE-2020-14812, CVE-2020-15180, CVE-2020-2574, CVE-2020-2752, CVE-2020-2760, CVE-2020-2812, CVE-2020-2814, CVE-2020-7221, CVE-2021-2154, CVE-2021-2166, CVE-2021-2372, CVE-2021-2389, CVE-2021-27928, CVE-2021-35604, CVE-2021-46657, CVE-2021-46658, CVE-2021-46659, CVE-2021-46661, CVE-2021-46663, CVE-2021-46664, CVE-2021-46665, CVE-2021-46668, CVE-2021-46669, CVE-2022-21427, CVE-2022-21595, CVE-2022-24048, CVE-2022-24050, CVE-2022-24051, CVE-2022-24052, CVE-2022-27376, CVE-2022-27377, CVE-2022-27378, CVE-2022-27379, CVE-2022-27380, CVE-2022-27381, CVE-2022-27382, CVE-2022-27383, CVE-2022-27384, CVE-2022-27386, CVE-2022-27387, CVE-2022-27444, CVE-2022-27445, CVE-2022-27446, CVE-2022-27447, CVE-2022-27448, CVE-2022-27449, CVE-2022-27451, CVE-2022-27452, CVE-2022-27455, CVE-2022-27456, CVE-2022-27457, CVE-2022-27458, CVE-2022-32081, CVE-2022-32083, CVE-2022-32084, CVE-2022-32085, CVE-2022-32086, CVE-2022-32087, CVE-2022-32088, CVE-2022-32089, CVE-2022-32091, CVE-2022-38791, CVE-2022-47015 Jira References: PED-2455, SLE-12253, SLE-8269 Sources used: SUSE Linux Enterprise High Performance Computing 15 SP1 LTSS 15-SP1 (src): mariadb104-10.4.30-150100.3.5.10, python-mysqlclient-1.4.6-150100.3.3.7 SUSE Linux Enterprise Server 15 SP1 LTSS 15-SP1 (src): mariadb104-10.4.30-150100.3.5.10, python-mysqlclient-1.4.6-150100.3.3.7 SUSE Linux Enterprise Server for SAP Applications 15 SP1 (src): mariadb104-10.4.30-150100.3.5.10, python-mysqlclient-1.4.6-150100.3.3.7 SUSE CaaS Platform 4.0 (src): mariadb104-10.4.30-150100.3.5.10, python-mysqlclient-1.4.6-150100.3.3.7  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 26](show_bug.cgi?id=1160868#c26)  Maintenance Automation   2023-12-29 12:30:14 UTC  ``` SUSE-RU-2023:4991-1: An update that solves 221 vulnerabilities and contains three features can now be installed.  Category: recommended (moderate) Bug References: 1001367, 1005555, 1005558, 1005562, 1005564, 1005566, 1005569, 1005581, 1005582, 1006539, 1008253, 1012075, 1013882, 1019948, 1020873, 1020875, 1020877, 1020878, 1020882, 1020884, 1020885, 1020890, 1020891, 1020894, 1020896, 1020976, 1022428, 1038740, 1039034, 1041525, 1041891, 1042632, 1043328, 1047218, 1055165, 1055268, 1058374, 1058729, 1060110, 1062583, 1067443, 1068906, 1069401, 1080891, 1083087, 1088681, 1092544, 1098683, 1101676, 1101677, 1101678, 1103342, 1111858, 1111859, 1112368, 1112377, 1112384, 1112386, 1112391, 1112397, 1112404, 1112415, 1112417, 1112421, 1112432, 1112767, 1116686, 1118754, 1120041, 1122198, 1122475, 1127027, 1132666, 1136035, 1142909, 1143215, 1144314, 1156669, 1160285, 1160868, 1160878, 1160883, 1160895, 1160912, 1166781, 1168380, 1170204, 1173028, 1173516, 1174559, 1175596, 1177472, 1178428, 1180014, 1182218, 1182255, 1182739, 1183770, 1185870, 1185872, 1186031, 1189320, 1192497, 1195325, 1195334, 1195339, 1196016, 1197459, 1198603, 1198604, 1198605, 1198606, 1198607, 1198609, 1198610, 1198611, 1198612, 1198613, 1198628, 1198629, 1198630, 1198631, 1198632, 1198633, 1198634, 1198635, 1198636, 1198637, 1198638, 1198639, 1198640, 1199928, 1200105, 1201161, 1201163, 1201164, 1201165, 1201166, 1201167, 1201168, 1201169, 1201170, 1202863, 332530, 353120, 357634, 359522, 366820, 371000, 387746, 420313, 425079, 427384, 429618, 435519, 437293, 463586, 520876, 525065, 525325, 539243, 539249, 557669, 635645, 747811, 763150, 779476, 789263, 792444, 796164, 829430, 841709, 859345, 889126, 894479, 902396, 914370, 921955, 934789, 937754, 937767, 937787, 942908, 943096, 957174, 963810, 971456, 979524, 983938, 984858, 986251, 989913, 989919, 989922, 989926, 990890, 998309 CVE References: CVE-2006-0903, CVE-2006-4226, CVE-2006-4227, CVE-2007-5969, CVE-2007-5970, CVE-2007-6303, CVE-2007-6304, CVE-2008-2079, CVE-2008-7247, CVE-2009-4019, CVE-2009-4028, CVE-2009-4030, CVE-2012-4414, CVE-2012-5611, CVE-2012-5612, CVE-2012-5615, CVE-2012-5627, CVE-2013-1976, CVE-2015-4792, CVE-2015-4802, CVE-2015-4807, CVE-2015-4815, CVE-2015-4816, CVE-2015-4819, CVE-2015-4826, CVE-2015-4830, CVE-2015-4836, CVE-2015-4858, CVE-2015-4861, CVE-2015-4864, CVE-2015-4866, CVE-2015-4870, CVE-2015-4879, CVE-2015-4895, CVE-2015-4913, CVE-2015-5969, CVE-2015-7744, CVE-2016-0505, CVE-2016-0546, CVE-2016-0596, CVE-2016-0597, CVE-2016-0598, CVE-2016-0600, CVE-2016-0606, CVE-2016-0608, CVE-2016-0609, CVE-2016-0610, CVE-2016-0616, CVE-2016-0640, CVE-2016-0641, CVE-2016-0642, CVE-2016-0644, CVE-2016-0646, CVE-2016-0649, CVE-2016-0650, CVE-2016-0651, CVE-2016-0668, CVE-2016-2047, CVE-2016-3477, CVE-2016-3492, CVE-2016-3521, CVE-2016-3615, CVE-2016-5440, CVE-2016-5584, CVE-2016-5616, CVE-2016-5624, CVE-2016-5626, CVE-2016-5629, CVE-2016-6662, CVE-2016-6663, CVE-2016-6664, CVE-2016-7440, CVE-2016-8283, CVE-2016-9843, CVE-2017-10268, CVE-2017-10286, CVE-2017-10320, CVE-2017-10365, CVE-2017-10378, CVE-2017-10379, CVE-2017-10384, CVE-2017-15365, CVE-2017-3238, CVE-2017-3243, CVE-2017-3244, CVE-2017-3257, CVE-2017-3258, CVE-2017-3265, CVE-2017-3291, CVE-2017-3302, CVE-2017-3308, CVE-2017-3309, CVE-2017-3312, CVE-2017-3313, CVE-2017-3317, CVE-2017-3318, CVE-2017-3453, CVE-2017-3456, CVE-2017-3464, CVE-2017-3636, CVE-2017-3641, CVE-2017-3653, CVE-2018-25032, CVE-2018-2562, CVE-2018-2612, CVE-2018-2622, CVE-2018-2640, CVE-2018-2665, CVE-2018-2668, CVE-2018-2755, CVE-2018-2759, CVE-2018-2761, CVE-2018-2766, CVE-2018-2767, CVE-2018-2771, CVE-2018-2777, CVE-2018-2781, CVE-2018-2782, CVE-2018-2784, CVE-2018-2786, CVE-2018-2787, CVE-2018-2810, CVE-2018-2813, CVE-2018-2817, CVE-2018-2819, CVE-2018-3058, CVE-2018-3060, CVE-2018-3063, CVE-2018-3064, CVE-2018-3066, CVE-2018-3143, CVE-2018-3156, CVE-2018-3162, CVE-2018-3173, CVE-2018-3174, CVE-2018-3185, CVE-2018-3200, CVE-2018-3251, CVE-2018-3277, CVE-2018-3282, CVE-2018-3284, CVE-2019-18901, CVE-2019-2510, CVE-2019-2537, CVE-2019-2614, CVE-2019-2627, CVE-2019-2628, CVE-2019-2737, CVE-2019-2739, CVE-2019-2740, CVE-2019-2758, CVE-2019-2805, CVE-2019-2938, CVE-2019-2974, CVE-2020-13249, CVE-2020-14765, CVE-2020-14776, CVE-2020-14789, CVE-2020-14812, CVE-2020-15180, CVE-2020-2574, CVE-2020-2752, CVE-2020-2760, CVE-2020-2812, CVE-2020-2814, CVE-2020-7221, CVE-2021-2154, CVE-2021-2166, CVE-2021-2372, CVE-2021-2389, CVE-2021-27928, CVE-2021-35604, CVE-2021-46657, CVE-2021-46658, CVE-2021-46659, CVE-2021-46661, CVE-2021-46663, CVE-2021-46664, CVE-2021-46665, CVE-2021-46668, CVE-2021-46669, CVE-2022-21427, CVE-2022-21595, CVE-2022-24048, CVE-2022-24050, CVE-2022-24051, CVE-2022-24052, CVE-2022-27376, CVE-2022-27377, CVE-2022-27378, CVE-2022-27379, CVE-2022-27380, CVE-2022-27381, CVE-2022-27382, CVE-2022-27383, CVE-2022-27384, CVE-2022-27386, CVE-2022-27387, CVE-2022-27444, CVE-2022-27445, CVE-2022-27446, CVE-2022-27447, CVE-2022-27448, CVE-2022-27449, CVE-2022-27451, CVE-2022-27452, CVE-2022-27455, CVE-2022-27456, CVE-2022-27457, CVE-2022-27458, CVE-2022-32081, CVE-2022-32083, CVE-2022-32084, CVE-2022-32085, CVE-2022-32086, CVE-2022-32087, CVE-2022-32088, CVE-2022-32089, CVE-2022-32091, CVE-2022-38791, CVE-2022-47015 Jira References: PED-2455, SLE-12253, SLE-8269 Sources used: SUSE Linux Enterprise Software Development Kit 12 SP5 (src): mariadb-connector-c-3.1.22-2.35.1, lz4-1.8.0-3.5.2, python-mysqlclient-1.3.14-8.9.2, mariadb104-10.4.30-8.5.46 SUSE Linux Enterprise High Performance Computing 12 SP5 (src): mariadb-connector-c-3.1.22-2.35.1, lz4-1.8.0-3.5.2, python-mysqlclient-1.3.14-8.9.2, mariadb104-10.4.30-8.5.46 SUSE Linux Enterprise Server 12 SP5 (src): mariadb-connector-c-3.1.22-2.35.1, lz4-1.8.0-3.5.2, python-mysqlclient-1.3.14-8.9.2, mariadb104-10.4.30-8.5.46 SUSE Linux Enterprise Server for SAP Applications 12 SP5 (src): mariadb-connector-c-3.1.22-2.35.1, lz4-1.8.0-3.5.2, python-mysqlclient-1.3.14-8.9.2, mariadb104-10.4.30-8.5.46  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1160868)
* - [XML](show_bug.cgi?ctype=xml&id=1160868)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=1160868)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1160868)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from idp-portal.suse.com_6b95d262_20250119_133551.html ===

## UCS

# Welcome to Univention Corporate Server

## JavaScript required

A browser with JavaScript enabled is required in order to use this service.

When using Internet Explorer, please check your security settings and add this address to your trusted sites.


