=== Content from k4m1ll0.com_52f5598f_20250119_130951.html ===

[Main](http://k4m1ll0.com)
[Advisories](./advisories)
[Press](./press)
[Donations](./donations)

## Support My Love Projects

Your contribution means a lot to me. These research projects are my passion, and I have invested a lot of time and resources into them. Unfortunately, I do not have any external supporters, and I cover all the expenses myself.

Dealing with vendors, especially in the field of cybersecurity, can be challenging, and it's even more difficult in my country (Hungary). Your support helps me continue these projects and bring valuable results to the community.

If you appreciate my work, you can contribute in the following ways:

### Securely donate with PayPal

![](https://www.paypal.com/en_HU/i/scr/pixel.gif)

### Scan the QR code to securely donate with PayPal

![PayPal QR Code](./paypal_qrcode.png)

### If you prefer cryptocurrency, you can donate using Bitcoin. Click to copy the BTC address to the clipboard!

bc1qxza23cdutkf4pjujy8yfpqp6rd4w4k3wntpp79

[![Buy Me A Coffee](https://cdn.buymeacoffee.com/buttons/v2/default-blue.png)](https://www.buymeacoffee.com/matekkamilj)

© 2019-2024 KamillÃ³ Matek (k4m1ll0) All Rights Reserved



=== Content from k4m1ll0.com_1179bfe1_20250119_130951.html ===

[Main](https://k4m1ll0.com)
[Advisories](./advisories)
[Press](./press)
[Donations](./donations)

## Advisories

* [Mercusys MW325R Authenticated Remote Code Execution - CVE-2023-52162
  Read more](https://k4m1ll0.com/cve-2023-52162.html)
* [Mercusys MW325R UART shell + "language-switch" vulnerablity. - CVE-2023-46297
  Read more](https://k4m1ll0.com/cve-2023-46297.html)
* [Forcepoint DLP One - Hidden Python Console - Initial access - Red teaming
  Read more](https://k4m1ll0.com/forcepoint-dlp-redteam.html)
* [Microsoft Shift F10 Bypass + Autopilot privesc
  Read more](https://k4m1ll0.com/ShiftF10Bypass-and-privesc.html)
* [TP-Link TLWR840n euv620 password reset CVE-2021-46122
  Read more](https://k4m1ll0.com/cve-tplink-tlwr840n-euV620-password-reset.html)
* [TP-Link TLWR840N EU V5 and V6.20 UART shell - CVE-2022-29402
  Read more](https://k4m1ll0.com/cve-tplink-tlwr840N-uart-shell.html)
* [TP-Link TLWR840N EU V5 Remote Code Execution - CVE-2021-41653
  Read more](https://k4m1ll0.com/cve-2021-41653.html)
* [Pandora FMS 755 Chained Remote Code Execution - HTACCESS - CVE-2021-36697 and CVE-2021-36698.
  Read more](https://k4m1ll0.com/chained_exploit_htaccess.html)
* [Pandora FMS 754 - Sensitive info on the client side - CVE-2021-34075
  Read more](https://k4m1ll0.com/cve-2021-34075.html)
* [Pandora FMS 754 XSS - Chained Remote Code Execution - CVE-2021-35501 and CVE-2021-34074
  Read more](https://k4m1ll0.com/cve-pandorafms754-chained-xss-rce.html)
* [Pandora FMS 742 File Repository Chat history - CVE-2020-8497
  Read more](https://k4m1ll0.com/cve-2020-8497.html)
* [Pandora FMS 742 File Manager + Remote Code Execution 2 - CVE-2020-7935
  Read more](https://k4m1ll0.com/cve-2020-7935.html)
* [Pandora FMS 742 File Repository + Remote Code Execution - CVE-2020-8511
  Read more](https://k4m1ll0.com/cve-2020-8511.html)
* [Pandora FMS 743 Online/Offline Updater/Extension PHP upload + Remote Code Execution - CVE-2020-8500
  Read more](https://k4m1ll0.com/cve-2020-8500.html)
* [Pandora FMS 742 Remote Code Execution File Manager CVE-2019-20050
  Read more](https://k4m1ll0.com/cve-2019-20050.html)
* [Pandora FMS 7.xx multiple XSS vulnerabilities - CVE-2019-19968
  Read more](https://k4m1ll0.com/cve-2019-19968.html)
* [Pandora FMS Remote Code Execution (Alert Manager) - CVE-2019-19681
  Read more](https://k4m1ll0.com/cve-2019-19681.html)

© 2019-2024 KamillÃ³ Matek (k4m1ll0) All Rights Reserved



=== Content from k4m1ll0.com_39673316_20250119_111346.html ===


[Back to the advisories](https://k4m1ll0.com/advisories)

# PHP file upload and remote code execution in Pandora FMS <= 7.42 in the File Manager - CVE-2020-7935

#pandorafms#hacking#exploit#rce#cve

Last Modified: 2024.01.19.

If you find it valuable, you can support me by making a donation. [Donate now](https://k4m1ll0.com/donations.html).

The vendor does not want to allow us to upload and execute the PHP file even with an Admin account in Pandora FMS. They introduced a protection mechanism in the File Manager to solve the issue. Unfortunately, the applied solution is not enough to block an attacker. I reported the problem to the vendor and they fixed it in the Pandora FMS 7.43? version.

# Technical Details

Note: The vulnerability exploitable only with a Web Admin account.

Interestingly the File Manager allows us to upload PHP files, but it is not possible to execute them via the File Manager. The vendor solved it with a tricky get\_file.php, which gives back the contents of a PHP file, so it is not possible to execute it via the File Manager.

I checked the upload process. The name of the PHP file remains the original and the exact path and the exact filename is known (and controllable) by the uploader.

![1](./cve-2020-7935/01.png)

![2](./cve-2020-7935/02.png)

The only thing that is missing is a folder where the attacker can store the PHP file, which is accessible from outside.
Unfortunately there are folders with this property e.g: http(s)://.../pandora\_console/images/backgrounds/ .
It is possible to create a directory with the File Manager. Unfortunately, the permission of the newly created folder and the file doesn't set properly.

![3](./cve-2020-7935/03.png)
## Execute it with curl:

![4](./cve-2020-7935/04.png)
## Proof

![5](./cve-2020-7935/05.png)
# Additional content

Demo video

© 2019-2024 KamillÃ³ Matek (k4m1ll0) All Rights Reserved


