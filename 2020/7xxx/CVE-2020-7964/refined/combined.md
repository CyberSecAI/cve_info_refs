=== Content from github.com_64c558df_20250119_123029.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsaleor%2Fsaleor%2Fcommit%2F233b8890c60fa6d90daf99e4d90fea85867732c3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsaleor%2Fsaleor%2Fcommit%2F233b8890c60fa6d90daf99e4d90fea85867732c3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=saleor%2Fsaleor)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[saleor](/saleor)
/
**[saleor](/saleor/saleor)**
Public

* [Notifications](/login?return_to=%2Fsaleor%2Fsaleor) You must be signed in to change notification settings
* [Fork
  5.6k](/login?return_to=%2Fsaleor%2Fsaleor)
* [Star
   21k](/login?return_to=%2Fsaleor%2Fsaleor)

* [Code](/saleor/saleor)
* [Issues
  295](/saleor/saleor/issues)
* [Pull requests
  38](/saleor/saleor/pulls)
* [Discussions](/saleor/saleor/discussions)
* [Actions](/saleor/saleor/actions)
* [Projects
  1](/saleor/saleor/projects)
* [Security](/saleor/saleor/security)
* [Insights](/saleor/saleor/pulse)

Additional navigation options

* [Code](/saleor/saleor)
* [Issues](/saleor/saleor/issues)
* [Pull requests](/saleor/saleor/pulls)
* [Discussions](/saleor/saleor/discussions)
* [Actions](/saleor/saleor/actions)
* [Projects](/saleor/saleor/projects)
* [Security](/saleor/saleor/security)
* [Insights](/saleor/saleor/pulse)

## Commit

[Permalink](/saleor/saleor/commit/233b8890c60fa6d90daf99e4d90fea85867732c3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#5192](https://github.com/saleor/saleor/pull/5192) from maarcingebala/fix-checkout-attach-user-‚Ä¶

[Browse files](/saleor/saleor/tree/233b8890c60fa6d90daf99e4d90fea85867732c3)
Browse the repository at this point in the history

```
‚Ä¶permissions

Fix permission for checkoutCustomerAttach mutation
```

* Loading branch information

[![@maarcingebala](https://avatars.githubusercontent.com/u/5421321?s=40&v=4)](/maarcingebala)

[maarcingebala](/saleor/saleor/commits?author=maarcingebala "View all commits by maarcingebala")
authored
Jan 23, 2020

2 parents
[0222f85](/saleor/saleor/commit/0222f85b8b1600c19583f461e6fd7a3739899e63)
+
[7df2877](/saleor/saleor/commit/7df28772c502c60964d9687eb5a4d7bc9169af93)

commit 233b889

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**64 additions**
and
**13 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* saleor/graphql

  + checkout

    - saleor/graphql/checkout/mutations.py
      [mutations.py](#diff-c70a2160c49088fa171fda2b4904744130f9cfa1476711c26813f0cf744f20fe)
  + saleor/graphql/schema.graphql
    [schema.graphql](#diff-0de7d822ed8c0bc0dc7b823b647b689cad8ce15c8e9b5784b6c89a5b9fc16236)
* tests/api

  + tests/api/test\_checkout.py
    [test\_checkout.py](#diff-3ec832dc50b8d07b629ce0e842ed6ed690ad7dc79996f5d24b7ea7190c618291)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/saleor/saleor/blob/233b8890c60fa6d90daf99e4d90fea85867732c3/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -54,6 +54,7 @@ All notable, unreleased changes to this project will be documented in this file. |
|  |  | - Drop gettext occurrences - #5189 by @IKarbowiak |
|  |  | - Fix `product\_created` webhook - #5187 by @dzkb |
|  |  | - Drop unused resolver `resolve\_availability` - #5190 by @maarcingebala |
|  |  | - Fix permission for `checkoutCustomerAttach` mutation - #5192 by @maarcingebala |
|  |  |  |
|  |  | ## 2.9.0 |
|  |  |  |
| Expand Down | |  |

41 changes: 34 additions & 7 deletions

41
[saleor/graphql/checkout/mutations.py](#diff-c70a2160c49088fa171fda2b4904744130f9cfa1476711c26813f0cf744f20fe "saleor/graphql/checkout/mutations.py")

Show comments

[View file](/saleor/saleor/blob/233b8890c60fa6d90daf99e4d90fea85867732c3/saleor/graphql/checkout/mutations.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,6 +5,7 @@ |
|  |  | from django.core.exceptions import ObjectDoesNotExist, ValidationError |
|  |  | from django.db import transaction |
|  |  | from django.db.models import Prefetch |
|  |  | from graphql\_jwt.exceptions import PermissionDenied |
|  |  |  |
|  |  | from ...account.error\_codes import AccountErrorCode |
|  |  | from ...checkout import models |
| Expand Down  Expand Up | | @@ -35,7 +36,7 @@ |
|  |  | from ...product import models as product\_models |
|  |  | from ...warehouse.availability import check\_stock\_quantity, get\_available\_quantity |
|  |  | from ..account.i18n import I18nMixin |
|  |  | from ..account.types import AddressInput, User |
|  |  | from ..account.types import AddressInput |
|  |  | from ..core.mutations import ( |
|  |  | BaseMutation, |
|  |  | ClearMetaBaseMutation, |
| Expand Down  Expand Up | | @@ -404,22 +405,39 @@ class CheckoutCustomerAttach(BaseMutation): |
|  |  |  |
|  |  | class Arguments: |
|  |  | checkout\_id = graphene.ID(required=True, description="ID of the checkout.") |
|  |  | customer\_id = graphene.ID(required=True, description="The ID of the customer.") |
|  |  | customer\_id = graphene.ID( |
|  |  | required=False, |
|  |  | description=( |
|  |  | "The ID of the customer. DEPRECATED: This field is deprecated and will " |
|  |  | "be removed in Saleor 2.11. To identify a customer you should " |
|  |  | "authenticate with JWT token." |
|  |  | ), |
|  |  | ) |
|  |  |  |
|  |  | class Meta: |
|  |  | description = "Sets the customer as the owner of the checkout." |
|  |  | error\_type\_class = CheckoutError |
|  |  | error\_type\_field = "checkout\_errors" |
|  |  |  |
|  |  | @classmethod |
|  |  | def perform\_mutation(cls, \_root, info, checkout\_id, customer\_id): |
|  |  | def check\_permissions(cls, context): |
|  |  | return context.user.is\_authenticated |
|  |  |  |
|  |  | @classmethod |
|  |  | def perform\_mutation(cls, \_root, info, checkout\_id, customer\_id=None): |
|  |  | checkout = cls.get\_node\_or\_error( |
|  |  | info, checkout\_id, only\_type=Checkout, field="checkout\_id" |
|  |  | ) |
|  |  | customer = cls.get\_node\_or\_error( |
|  |  | info, customer\_id, only\_type=User, field="customer\_id" |
|  |  | ) |
|  |  | checkout.user = customer |
|  |  |  |
|  |  | # Check if provided customer\_id matches with the authenticated user and raise |
|  |  | # error if it doesn't. This part can be removed when `customer\_id` field is |
|  |  | # removed. |
|  |  | if customer\_id: |
|  |  | current\_user\_id = graphene.Node.to\_global\_id("User", info.context.user.id) |
|  |  | if current\_user\_id != customer\_id: |
|  |  | raise PermissionDenied() |
|  |  |  |
|  |  | checkout.user = info.context.user |
|  |  | checkout.save(update\_fields=["user", "last\_change"]) |
|  |  | return CheckoutCustomerAttach(checkout=checkout) |
|  |  |  |
| Expand All | | @@ -435,11 +453,20 @@ class Meta: |
|  |  | error\_type\_class = CheckoutError |
|  |  | error\_type\_field = "checkout\_errors" |
|  |  |  |
|  |  | @classmethod |
|  |  | def check\_permissions(cls, context): |
|  |  | return context.user.is\_authenticated |
|  |  |  |
|  |  | @classmethod |
|  |  | def perform\_mutation(cls, \_root, info, checkout\_id): |
|  |  | checkout = cls.get\_node\_or\_error( |
|  |  | info, checkout\_id, only\_type=Checkout, field="checkout\_id" |
|  |  | ) |
|  |  |  |
|  |  | # Raise error if the current user doesn't own the checkout of the given ID. |
|  |  | if checkout.user and checkout.user != info.context.user: |
|  |  | raise PermissionDenied() |
|  |  |  |
|  |  | checkout.user = None |
|  |  | checkout.save(update\_fields=["user", "last\_change"]) |
|  |  | return CheckoutCustomerDetach(checkout=checkout) |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[saleor/graphql/schema.graphql](#diff-0de7d822ed8c0bc0dc7b823b647b689cad8ce15c8e9b5784b6c89a5b9fc16236 "saleor/graphql/schema.graphql")

Show comments

[View file](/saleor/saleor/blob/233b8890c60fa6d90daf99e4d90fea85867732c3/saleor/graphql/schema.graphql)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2288,7 +2288,7 @@ type Mutation { |
|  |  | checkoutBillingAddressUpdate(billingAddress: AddressInput!, checkoutId: ID!): CheckoutBillingAddressUpdate |
|  |  | checkoutComplete(checkoutId: ID!, redirectUrl: String, storeSource: Boolean = false): CheckoutComplete |
|  |  | checkoutCreate(input: CheckoutCreateInput!): CheckoutCreate |
|  |  | checkoutCustomerAttach(checkoutId: ID!, customerId: ID!): CheckoutCustomerAttach |
|  |  | checkoutCustomerAttach(checkoutId: ID!, customerId: ID): CheckoutCustomerAttach |
|  |  | checkoutCustomerDetach(checkoutId: ID!): CheckoutCustomerDetach |
|  |  | checkoutEmailUpdate(checkoutId: ID, email: String!): CheckoutEmailUpdate |
|  |  | checkoutLineDelete(checkoutId: ID!, lineId: ID): CheckoutLineDelete |
| Expand Down | |  |

33 changes: 28 additions & 5 deletions

33
[tests/api/test\_checkout.py](#diff-3ec832dc50b8d07b629ce0e842ed6ed690ad7dc79996f5d24b7ea7190c618291 "tests/api/test_checkout.py")

Show comments

[View file](/saleor/saleor/blob/233b8890c60fa6d90daf99e4d90fea85867732c3/tests/api/test_checkout.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,6 +8,7 @@ |
|  |  | from django.core.exceptions import ValidationError |
|  |  | from prices import Money, TaxedMoney |
|  |  |  |
|  |  | from saleor.account.models import User |
|  |  | from saleor.checkout import calculations |
|  |  | from saleor.checkout.error\_codes import CheckoutErrorCode |
|  |  | from saleor.checkout.models import Checkout |
| Expand All | | @@ -25,7 +26,7 @@ |
|  |  | from saleor.shipping import ShippingMethodType |
|  |  | from saleor.shipping.models import ShippingMethod |
|  |  | from saleor.warehouse.models import Stock |
|  |  | from tests.api.utils import get\_graphql\_content |
|  |  | from tests.api.utils import assert\_no\_permission, get\_graphql\_content |
|  |  |  |
|  |  |  |
|  |  | @pytest.fixture |
| Expand Down  Expand Up | | @@ -851,7 +852,9 @@ def test\_checkout\_line\_delete\_by\_zero\_quantity( |
|  |  | mocked\_update\_shipping\_method.assert\_called\_once\_with(checkout, mock.ANY) |
|  |  |  |
|  |  |  |
|  |  | def test\_checkout\_customer\_attach(user\_api\_client, checkout\_with\_item, customer\_user): |
|  |  | def test\_checkout\_customer\_attach( |
|  |  | api\_client, user\_api\_client, checkout\_with\_item, customer\_user |
|  |  | ): |
|  |  | checkout = checkout\_with\_item |
|  |  | assert checkout.user is None |
|  |  |  |
| Expand All | | @@ -871,16 +874,26 @@ def test\_checkout\_customer\_attach(user\_api\_client, checkout\_with\_item, customer\_ |
|  |  | """ |
|  |  | checkout\_id = graphene.Node.to\_global\_id("Checkout", checkout.pk) |
|  |  | customer\_id = graphene.Node.to\_global\_id("User", customer\_user.pk) |
|  |  |  |
|  |  | variables = {"checkoutId": checkout\_id, "customerId": customer\_id} |
|  |  |  |
|  |  | # Mutation should fail for unauthenticated customers |
|  |  | response = api\_client.post\_graphql(query, variables) |
|  |  | assert\_no\_permission(response) |
|  |  |  |
|  |  | # Mutation should succeed for authenticated customer |
|  |  | response = user\_api\_client.post\_graphql(query, variables) |
|  |  | content = get\_graphql\_content(response) |
|  |  |  |
|  |  | data = content["data"]["checkoutCustomerAttach"] |
|  |  | assert not data["errors"] |
|  |  | checkout.refresh\_from\_db() |
|  |  | assert checkout.user == customer\_user |
|  |  |  |
|  |  | # Mutation with ID of a different user should fail as well |
|  |  | other\_customer = User.objects.create\_user("othercustomer@example.com", "password") |
|  |  | variables["customerId"] = graphene.Node.to\_global\_id("User", other\_customer.pk) |
|  |  | response = user\_api\_client.post\_graphql(query, variables) |
|  |  | assert\_no\_permission(response) |
|  |  |  |
|  |  |  |
|  |  | MUTATION\_CHECKOUT\_CUSTOMER\_DETACH = """ |
|  |  | mutation checkoutCustomerDetach($checkoutId: ID!) { |
| Expand All | | @@ -904,16 +917,26 @@ def test\_checkout\_customer\_detach(user\_api\_client, checkout\_with\_item, customer\_ |
|  |  |  |
|  |  | checkout\_id = graphene.Node.to\_global\_id("Checkout", checkout.pk) |
|  |  | variables = {"checkoutId": checkout\_id} |
|  |  |  |
|  |  | # Mutation should succeed if the user owns this checkout. |
|  |  | response = user\_api\_client.post\_graphql( |
|  |  | MUTATION\_CHECKOUT\_CUSTOMER\_DETACH, variables |
|  |  | ) |
|  |  | content = get\_graphql\_content(response) |
|  |  |  |
|  |  | data = content["data"]["checkoutCustomerDetach"] |
|  |  | assert not data["errors"] |
|  |  | checkout.refresh\_from\_db() |
|  |  | assert checkout.user is None |
|  |  |  |
|  |  | # Mutation should fail when user calling it doesn't own the checkout. |
|  |  | other\_user = User.objects.create\_user("othercustomer@example.com", "password") |
|  |  | checkout.user = other\_user |
|  |  | checkout.save() |
|  |  | response = user\_api\_client.post\_graphql( |
|  |  | MUTATION\_CHECKOUT\_CUSTOMER\_DETACH, variables |
|  |  | ) |
|  |  | assert\_no\_permission(response) |
|  |  |  |
|  |  |  |
|  |  | MUTATION\_CHECKOUT\_SHIPPING\_ADDRESS\_UPDATE = """ |
|  |  | mutation checkoutShippingAddressUpdate( |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `233b889`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsaleor%2Fsaleor%2Fcommit%2F233b8890c60fa6d90daf99e4d90fea85867732c3) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_4c7757ec_20250119_123030.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsaleor%2Fsaleor%2Freleases%2Ftag%2F2.9.1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsaleor%2Fsaleor%2Freleases%2Ftag%2F2.9.1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=saleor%2Fsaleor)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[saleor](/saleor)
/
**[saleor](/saleor/saleor)**
Public

* [Notifications](/login?return_to=%2Fsaleor%2Fsaleor) You must be signed in to change notification settings
* [Fork
  5.6k](/login?return_to=%2Fsaleor%2Fsaleor)
* [Star
   21k](/login?return_to=%2Fsaleor%2Fsaleor)

* [Code](/saleor/saleor/tree/2.9.1)
* [Issues
  295](/saleor/saleor/issues)
* [Pull requests
  38](/saleor/saleor/pulls)
* [Discussions](/saleor/saleor/discussions)
* [Actions](/saleor/saleor/actions)
* [Projects
  1](/saleor/saleor/projects)
* [Security](/saleor/saleor/security)
* [Insights](/saleor/saleor/pulse)

Additional navigation options

* [Code](/saleor/saleor/tree/2.9.1)
* [Issues](/saleor/saleor/issues)
* [Pull requests](/saleor/saleor/pulls)
* [Discussions](/saleor/saleor/discussions)
* [Actions](/saleor/saleor/actions)
* [Projects](/saleor/saleor/projects)
* [Security](/saleor/saleor/security)
* [Insights](/saleor/saleor/pulse)

1. [Releases](/saleor/saleor/releases)
2. [2.9.1](/saleor/saleor/releases/tag/2.9.1)

# 2.9.1 Release

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/saleor/saleor/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2.9.1)

 Loading

[View all tags](/saleor/saleor/tags)

![@maarcingebala](https://avatars.githubusercontent.com/u/5421321?s=40&v=4)
[maarcingebala](/maarcingebala)
released this
24 Jan 15:43

[2.9.1](/saleor/saleor/tree/2.9.1)

[`877e5c2`](/saleor/saleor/commit/877e5c285bac9a4b3a35a45063e3451f4bfbad52)

This release fixes [CVE-2020-7964](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-7964) vulnerability issue in Saleor.

The `checkoutCustomerAttach` mutation failed to verify whether the customer ID passed matched the currently logged in user. This allowed users to generate checkout sessions and attach them to random existing users. User IDs are integers, so with enough effort, valid ones could be enumerated using brute force.

As the mutation returns the modified checkout object, the attacker could request its user field to retrieve information about the user the checkout was now assigned to. Information potentially disclosed includes: first and last name, address book contents, order history, and stored payment methods if any (card type, last four digits, expiration date).

Additionally, we‚Äôve also provided a solution that makes sure any embedded user object will only be obtainable by a privileged site admin or by the same user if currently logged in. This affects the following fields:

* `Checkout.events`
* `Checkout.user`
* `CustomerEvent.user`
* `GiftCard.user`
* `Order.events`
* `Order.user`
* `OrderEvent.user`
* `User.storedPaymentSources`

### Affected versions

All Saleor releases contain this mutation up to version 2.9.

### Changelog

* Fix permission for `checkoutCustomerAttach` mutation - [#5192](https://github.com/saleor/saleor/pull/5192) by [@maarcingebala](https://github.com/maarcingebala)
* Restrict access to user field - [#5194](https://github.com/saleor/saleor/pull/5194) by [@maarcingebala](https://github.com/maarcingebala)

 Assets
2

 Loading

 üëç
1
 Al-mualim reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

 1 person reacted

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


