- **Root cause of vulnerability:** The vulnerability stems from the fact that certain AMD virtualization instructions, which operate on host physical addresses, were not trapped by the bhyve hypervisor. This allowed guest operating systems to directly manipulate host memory without proper checks or translation via nested page tables.
- **Weaknesses/vulnerabilities present:** The core issue is the lack of proper trapping of specific AMD virtualization instructions. These instructions, designed to operate on host physical addresses, were directly accessible to the guest OS without going through the nested page table mechanism. This constitutes a privilege escalation vulnerability.
- **Impact of exploitation:** By exploiting this vulnerability, a malicious guest operating system running within bhyve can write to arbitrary host memory locations. This capability allows for complete control over the host system, enabling actions such as data theft, system compromise, and denial of service.
- **Attack vectors:** The attack vector is through a malicious guest operating system running within a bhyve virtual machine on an AMD processor. The guest needs to execute specific, untrapped AMD virtualization instructions to write directly to host memory.
- **Required attacker capabilities/position:** The attacker must have control over a guest operating system running inside a bhyve virtual machine on a host with an AMD CPU. The guest OS must have kernel level privileges to execute the vulnerable instructions.