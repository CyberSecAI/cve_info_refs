The provided content relates to CVE-2020-7981.

**Root cause of vulnerability:**
The vulnerability stems from a lack of proper sanitization of latitude and longitude values before they are used in SQL queries.

**Weaknesses/vulnerabilities present:**
- SQL Injection: The code directly incorporates floating-point latitude and longitude values into SQL queries without sanitization, creating a potential SQL injection vulnerability.

**Impact of exploitation:**
- Data Breach: A successful SQL injection could allow an attacker to retrieve sensitive data from the database.
- Data Modification: Attackers could modify or delete data within the database.
- System Compromise: In severe cases, a successful SQL injection could lead to complete compromise of the system if the database server is accessible to execute OS commands.

**Attack vectors:**
- The attack vector is through the `within_bounding_box` function in `lib/geocoder/sql.rb`. This function constructs SQL queries by directly embedding latitude and longitude values without prior sanitization.
- Attackers can manipulate the latitude (`sw_lat`, `ne_lat`) and longitude (`sw_lng`, `ne_lng`) input parameters of the `within_bounding_box` function.

**Required attacker capabilities/position:**
- The attacker needs to be able to call the `within_bounding_box` function with manipulated latitude/longitude parameters. This would likely require interacting with an application that uses the vulnerable `geocoder` library.
- The attacker needs to know the format of the SQL query used by the library so they can craft an appropriate SQL injection.

**Additional Notes**
- The provided diff shows that the fix for this vulnerability involves converting latitude/longitude values to floats using `.to_f` before including them in the SQL query. This change, while not a true sanitization, mitigates the vulnerability by ensuring the values are treated as numbers, preventing a trivial injection where an attacker injects malicious SQL as a string. However, this is not an ideal approach as further SQL injection vectors could still exist if these values are used without proper validation and parameterized queries.