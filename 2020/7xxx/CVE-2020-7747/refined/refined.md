Based on the provided information, here's an analysis of CVE-2020-7747:

**Root Cause of Vulnerability:**
The vulnerability is a Cross-Site Scripting (XSS) vulnerability in the `lightning-server` package. Specifically, it occurs due to the lack of proper sanitization of user-supplied data when creating visualizations within a session. Malicious JavaScript code can be injected through the `type` field when creating a new visualization.

**Weaknesses/Vulnerabilities Present:**
- **Cross-site Scripting (XSS):** The application fails to properly sanitize user-provided input, allowing an attacker to inject malicious JavaScript code that will be executed in the context of other users' browsers. Specifically, the application does not validate the `type` field before using it in the error message.
- **Lack of Input Validation:** The application does not validate the visualization `type` field, enabling arbitrary values such as `<svg/onload=alert(1)>` to be passed and reflected back in the response.

**Impact of Exploitation:**
- **Arbitrary JavaScript Execution:** An attacker can inject and execute arbitrary JavaScript code in the context of the victim's browser. This can lead to various malicious activities including:
    - **Session Hijacking:** Stealing cookies to hijack user sessions.
    - **Information Disclosure:** Exposing sensitive user information.
    - **Privilege Escalation:** Accessing privileged services and functionality if the victim has elevated permissions.
    - **Malware Delivery:** Delivering malware to the victim.

**Attack Vectors:**
- **HTTP POST Request:** The vulnerability is exploited through an HTTP POST request to the `/sessions/{sid}/visualizations/` endpoint. The malicious payload is included in the `type` field of the JSON request body.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs to be able to send HTTP requests to the server running `lightning-server`.
- **Ability to Craft a Malicious Payload:**  The attacker needs to craft a malicious JavaScript payload, such as `<svg/onload=alert(1)>`, to inject it into the request.
- **User Interaction:** While the vulnerability is reflected XSS, it doesn't require the user to click a malicious link.  The user would need to navigate to the affected view where the injected payload is reflected. The 'User Interaction' score in the CVSS is misleading.

**Technical Details:**
- The vulnerability is located in the `session.js` controller file.
- The Proof of Concept (PoC) shows how to exploit the vulnerability using an HTTP POST request with a malicious `type` field in the JSON body. The server echoes the unsanitized input in the response.
- The application uses the `type` field from the request body in an error message without sanitizing it, resulting in the injection of the payload.

**Additional Notes:**
- There is no fixed version for the `lightning-server` package.
- The provided content includes detailed information about XSS attacks, including the different types of XSS (Stored, Reflected, DOM-based, Mutated), affected environments and prevention techniques. This information provides a broader context about XSS but isn't specific to the root cause.
- The CVSS scores provided for both Snyk and NVD are identical with 6.3 (Medium severity)

This information provides more details than the official CVE description.