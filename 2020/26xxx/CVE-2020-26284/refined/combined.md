=== Content from github.com_28f0025a_20250119_134710.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F38736)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F38736)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=golang%2Fgo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[golang](/golang)
/
**[go](/golang/go)**
Public

* [Notifications](/login?return_to=%2Fgolang%2Fgo) You must be signed in to change notification settings
* [Fork
  17.8k](/login?return_to=%2Fgolang%2Fgo)
* [Star
   125k](/login?return_to=%2Fgolang%2Fgo)

* [Code](/golang/go)
* [Issues
  5k+](/golang/go/issues)
* [Pull requests
  510](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects
  4](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

Additional navigation options

* [Code](/golang/go)
* [Issues](/golang/go/issues)
* [Pull requests](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

# proposal: os/exec: make LookPath not look in dot implicitly on Windows #38736

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosed as not plannedClosed as not planned[proposal: os/exec: make LookPath not look in dot implicitly on Windows](#top)#38736Copy linkLabels[OS-Windows](https://github.com/golang/go/issues?q=state%3Aopen%20label%3A%22OS-Windows%22)[Proposal](https://github.com/golang/go/issues?q=state%3Aopen%20label%3A%22Proposal%22)[Security](https://github.com/golang/go/issues?q=state%3Aopen%20label%3A%22Security%22)Milestone[Proposal](https://github.com/golang/go/milestone/30)![@dholmesdell](https://avatars.githubusercontent.com/u/64506091?v=4&size=80)
## Description

![@dholmesdell](https://avatars.githubusercontent.com/u/64506091?v=4&size=48)[dholmesdell](https://github.com/dholmesdell)opened [on Apr 29, 2020](https://github.com/golang/go/issues/38736#issue-608691699)
### What version of Go are you using (`go version`)?

```
$ go version
go version go1.14.1 windows/amd64

```

Originally noticed with Go 1.8 though.

### Does this issue reproduce with the latest release?

Yes

### What operating system and processor architecture are you using (`go env`)?

`go env` Output
```
$ go env
set GO111MODULE=
set GOARCH=amd64
set GOBIN=
set GOCACHE=C:\Users\holmed2\AppData\Local\go-build
set GOENV=C:\Users\holmed2\AppData\Roaming\go\env
set GOEXE=.exe
set GOFLAGS=
set GOHOSTARCH=amd64
set GOHOSTOS=windows
set GOINSECURE=
set GONOPROXY=
set GONOSUMDB=
set GOOS=windows
set GOPATH=C:\Users\holmed2\go
set GOPRIVATE=
set GOPROXY=https://proxy.golang.org,direct
set GOROOT=C:\Go
set GOSUMDB=sum.golang.org
set GOTMPDIR=
set GOTOOLDIR=C:\Go\pkg\tool\windows_amd64
set GCCGO=gccgo
set AR=ar
set CC=gcc
set CXX=g++
set CGO_ENABLED=1
set GOMOD=
set CGO_CFLAGS=-g -O2
set CGO_CPPFLAGS=
set CGO_CXXFLAGS=-g -O2
set CGO_FFLAGS=-g -O2
set CGO_LDFLAGS=-g -O2
set PKG_CONFIG=pkg-config
set GOGCCFLAGS=-m64 -mthreads -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=C:\Users\holmed2\AppData\Local\Temp\go-build226326482=/tmp/go-build -gno-record-gcc-switches

```
### What did you do?

Copy “C:\Windows\System32\whoami.exe” to the following program’s directory as “systeminfo.exe” and then run the program:

```
package main

import (
      "fmt"
      "os"
      "os/exec"
)

func main() {
      os.Setenv("PATH", `C:\Windows\System32`)

      cmd := exec.Command("systeminfo.exe")
      out, err := cmd.CombinedOutput()
      if err != nil {
            panic(err)
      }
      fmt.Println(string(out))
}

```
### What did you expect to see?

The output of C:\Windows\System32\systeminfo.exe

### What did you see instead?

The output of ./systeminfo.exe (my username, since it is a copy of whoami.exe)

If the renamed copy of systeminfo.exe is removed from the test program’s directory, then the output of “C:\Windows\System32\systeminfo.exe” is displayed as expected.

### Analysis

os/exec/lp\_windows.go contains the following:

```
func LookPath(file string) (string, error) {
…
      if strings.ContainsAny(file, `:\/`) {
            if f, err := findExecutable(file, exts); err == nil {
                  return f, nil
            } else {
                  return "", &Error{file, err}
            }
      }
      if f, err := findExecutable(filepath.Join(".", file), exts); err == nil {
            return f, nil
      }

```

If the value of ‘file’ is an absolute or relative path, a result is returned. The concern is with a value which is only a name, such as “systeminfo.exe”. One would expect this to search the list of paths found in the PATH environment variable, but before doing so the code explicitly searches the current working directory (“.”). There does not appear to be any means provided to disable this behavior and search only PATH.

I would guess that the intent was to mimic the behavior of the cmd.exe command shell, which searches the current directory first even if it is not specified in PATH. By comparison, the documentation for the Windows CreateProcess API indicates that it does not search PATH at all, but will use the current directory to complete a partial path. (The SearchPath API offers an alternative, though also flawed, option to search the current directory last.)

The problem is that it is not possible to use exec.LookPath, and thus exec.Command, to search the system PATH without searching the current directory. Thus even if diligence is taken to have the program set a secure PATH value, the programmer must be aware of this behavior and avoid using these standard library functions. The documentation of exec.LookPath does not mention the current directory, stating only that it searches “the directories named by the PATH environment variable.”

### Suggestions

My preferred recommendation would be to remove the explicit search of “.” (the second if-clause shown above), in order to provide the best level of security and comply with the documentation. A programmer can add “.” to the PATH environment variable value if the behavior is desired, as one would do in a linux/unix program.

If the resulting change in Go behavior/compatibility is not desirable, a workaround could be for exec.LookPath to reference the NoDefaultCurrentDirectoryInExePath environment variable and avoid searching “.” if it is set. This is a workaround which Microsoft apparently added in Vista to disable the behavior in cmd.exe.

cc [@FiloSottile](https://github.com/FiloSottile)

👍19
## Metadata

### Assignees

No one assigned

### Labels

[OS-Windows](https://github.com/golang/go/issues?q=state%3Aopen%20label%3A%22OS-Windows%22)[Proposal](https://github.com/golang/go/issues?q=state%3Aopen%20label%3A%22Proposal%22)[Security](https://github.com/golang/go/issues?q=state%3Aopen%20label%3A%22Security%22)
### Type

No type
### Projects

No projects
### Milestone

* [ProposalNo due date](https://github.com/golang/go/milestone/30)
### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_75438ded_20250119_134709.html ===
���� �  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222��  ( (" ���          
   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz�������������������������������������������������������������������������       
  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? ��-'�2]���O�� ��q����X�r�X� �h[�I�ݏ`?�`��Z��C���B���;�t��V&P|�ܺT��{ɠiV�b%fuLŁ#��=kym��<�C�HR ���>��zT�w���3�35����f�Anǂ��WL�H��8t�?�5b��t{(����%��9~Dz����ڮ^U��� ��\_Z��١W��H�IX蠊�D����#����c ��� uxm㰵��dT�� ��q�3��\m�y$�C/Fnp{�]>��6�U��'f��c���F=q�Ͻpե(ɹnĦ�6�fC|�[�-�ʓ#�}�A�xR~����!�).!|H�bƘ%Sߞ�d���j���C��'حbU�!�\*2K`q��ӎ���[���WP�����p\_j�b��F�Dz��˧�� J��,��ʹZ��n��m����'=8���b;VU{8Zn�g
isN�؞s)`�2��)���S�#��<USʰ�8��������N��7�|� 액i� !��� ��S�ݙ��Σm
Q-a��Kt|��/��9�7�{U+�P��4/#;��?G������2�p�S��G[�6�}�(��3��

=== Content from github.com_06d7aabd_20250119_120309.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgohugoio%2Fhugo%2Fsecurity%2Fadvisories%2FGHSA-8j34-9876-pvfq)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgohugoio%2Fhugo%2Fsecurity%2Fadvisories%2FGHSA-8j34-9876-pvfq)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=gohugoio%2Fhugo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[gohugoio](/gohugoio)
/
**[hugo](/gohugoio/hugo)**
Public

* [Notifications](/login?return_to=%2Fgohugoio%2Fhugo) You must be signed in to change notification settings
* [Fork
  7.6k](/login?return_to=%2Fgohugoio%2Fhugo)
* [Star
   77.3k](/login?return_to=%2Fgohugoio%2Fhugo)

* [Code](/gohugoio/hugo)
* [Issues
  449](/gohugoio/hugo/issues)
* [Pull requests
  26](/gohugoio/hugo/pulls)
* [Actions](/gohugoio/hugo/actions)
* [Projects
  0](/gohugoio/hugo/projects)
* [Security](/gohugoio/hugo/security)
* [Insights](/gohugoio/hugo/pulse)

Additional navigation options

* [Code](/gohugoio/hugo)
* [Issues](/gohugoio/hugo/issues)
* [Pull requests](/gohugoio/hugo/pulls)
* [Actions](/gohugoio/hugo/actions)
* [Projects](/gohugoio/hugo/projects)
* [Security](/gohugoio/hugo/security)
* [Insights](/gohugoio/hugo/pulse)

# Hugo can execute a binary from the current directory on Windows

Moderate

[bep](/bep)
published
GHSA-8j34-9876-pvfq
Dec 20, 2020

## Package

gomod

github.com/gohugoio/hugo
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

< 0.79.1

## Patched versions

0.79.1

## Description

## Impact

Hugo depends on Go's `os/exec` for certain features, e.g. for rendering of Pandoc documents if these binaries are found in the system `%PATH%` on Windows. However, if a malicious file with the same name (`exe` or `bat`) is found in the current working directory at the time of running `hugo`, the malicious command will be invoked instead of the system one.

Windows users who run `hugo` inside untrusted Hugo sites are affected.

## Patches

Users should upgrade to Hugo v0.79.1.

## Workarounds

Other than avoiding untrusted Hugo sites, there is no workaround.

## References

[golang/go#38736](https://github.com/golang/go/issues/38736)

### Severity

Moderate

### CVE ID

CVE-2020-26284

### Weaknesses

No CWEs

### Credits

* [![@Ry0taK](https://avatars.githubusercontent.com/u/49341894?s=40&v=4)](/Ry0taK)
  [Ry0taK](/Ry0taK)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


