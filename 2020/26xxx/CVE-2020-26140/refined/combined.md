=== Content from github.com_bbdc1a0f_20250119_122950.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvanhoefm%2Ffragattacks%2Fblob%2Fmaster%2FSUMMARY.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvanhoefm%2Ffragattacks%2Fblob%2Fmaster%2FSUMMARY.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=vanhoefm%2Ffragattacks)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[vanhoefm](/vanhoefm)
/
**[fragattacks](/vanhoefm/fragattacks)**
Public

* [Notifications](/login?return_to=%2Fvanhoefm%2Ffragattacks) You must be signed in to change notification settings
* [Fork
  185](/login?return_to=%2Fvanhoefm%2Ffragattacks)
* [Star
   1.3k](/login?return_to=%2Fvanhoefm%2Ffragattacks)

* [Code](/vanhoefm/fragattacks)
* [Issues
  1](/vanhoefm/fragattacks/issues)
* [Pull requests
  0](/vanhoefm/fragattacks/pulls)
* [Actions](/vanhoefm/fragattacks/actions)
* [Projects
  0](/vanhoefm/fragattacks/projects)
* [Security](/vanhoefm/fragattacks/security)
* [Insights](/vanhoefm/fragattacks/pulse)

Additional navigation options

* [Code](/vanhoefm/fragattacks)
* [Issues](/vanhoefm/fragattacks/issues)
* [Pull requests](/vanhoefm/fragattacks/pulls)
* [Actions](/vanhoefm/fragattacks/actions)
* [Projects](/vanhoefm/fragattacks/projects)
* [Security](/vanhoefm/fragattacks/security)
* [Insights](/vanhoefm/fragattacks/pulse)

## Files

 master
## Breadcrumbs

1. [fragattacks](/vanhoefm/fragattacks/tree/master)
/
# SUMMARY.md

Copy path Blame  Blame
## Latest commit

## History

[History](/vanhoefm/fragattacks/commits/master/SUMMARY.md)32 lines (16 loc) · 4.72 KB master
## Breadcrumbs

1. [fragattacks](/vanhoefm/fragattacks/tree/master)
/
# SUMMARY.md

Top
## File metadata and controls

* Preview
* Code
* Blame

32 lines (16 loc) · 4.72 KB[Raw](https://github.com/vanhoefm/fragattacks/raw/refs/heads/master/SUMMARY.md)
# Summary of Vulnerabilities

## Design Flaws

* **CVE-2020-24588: Accepting non-SPP A-MSDU frames**: The 802.11 standard that underpins Wi-Fi Protected Access (WPA, WPA2, and WPA3) and Wired Equivalent Privacy (WEP) doesn't require that the A-MSDU flag in the plaintext QoS header field is authenticated. Against devices that support receiving non-SPP A-MSDU frames, which is mandatory as part of 802.11n, an adversary can abuse this to inject arbitrary network packets.
* **CVE-2020-24587: Reassembling fragments encrypted under different keys**: The 802.11 standard that underpins Wi-Fi Protected Access (WPA, WPA2, and WPA3) and Wired Equivalent Privacy (WEP) doesn't require that all fragments of a frame are encrypted under the same key. An adversary can abuse this to exfiltrate selected fragments when another device sends fragmented frames and the WEP, CCMP, or GCMP encryption key is periodically renewed.
* **CVE-2020-24586: Not clearing fragments from memory when (re)connecting to a network:** The 802.11 standard that underpins Wi-Fi Protected Access (WPA, WPA2, and WPA3) and Wired Equivalent Privacy (WEP) doesn't require that received fragments must be cleared from memory after (re)connecting to a network. Under the right circumstances, when another device sends fragmented frames encrypted using WEP, CCMP, or GCMP, this can be abused to inject arbitrary network packets and/or exfiltrate user data.

## Implementation flaws allowing trivial packet injection

* **CVE-2020-26145: Accepting plaintext broadcast fragments as full frames (in an encrypted network)**: Vulnerable WEP, WPA, WPA2, or WPA3 implementations accept second (or subsequent) broadcast fragments even when sent in plaintext and process them as full unfragmented frames. An adversary can abuse this to inject arbitrary network packets independent of the network configuration.
* **CVE-2020-26144: Accepting plaintext A-MSDU frames that start with an RFC1042 header with EtherType EAPOL (in an encrypted network)**: Vulnerable Wi-Fi implementations accept plaintext A-MSDU frames as long as the first 8 bytes correspond to a valid RFC1042 (i.e., LLC/SNAP) header for EAPOL. An adversary can abuse this to inject arbitrary network packets independent of the network configuration.
* **CVE-2020-26140: Accepting plaintext data frames in a protected network**: Vulnerable WEP, WPA, WPA2, or WPA3 implementations accept plaintext frames in a protected Wi-Fi network. An adversary can abuse this to inject arbitrary data frames independent of the network configuration.
* **CVE-2020-26143: Accepting *fragmented* plaintext data frames in a protected network**: Vulnerable WEP, WPA, WPA2, or WPA3 implementations accept fragmented plaintext frames in a protected Wi-Fi network. An adversary can abuse this to inject arbitrary data frames independent of the network configuration.

## Other Implementation Vulnerabilities

* **CVE-2020-26139: Forwarding EAPOL frames even though the sender is not yet authenticated**: Vulnerable Access Points (APs) forward EAPOL frames to other clients even though the sender has not yet successfully authenticated to the AP. An adversary might be able to abuse this in projected Wi-Fi networks to launch denial-of-service attacks against connected clients, and this makes it easier to exploit other vulnerabilities in connected clients.
* **CVE-2020-26146: Reassembling encrypted fragments with non-consecutive packet numbers**: Vulnerable WPA, WPA2, or WPA3 implementations reassemble fragments with non-consecutive packet numbers. An adversary can abuse this to exfiltrate selected fragments. This vulnerability is exploitable when another device sends fragmented frames and the WEP, CCMP, or GCMP data-confidentiality protocol is used. Note that WEP is vulnerable to this attack by design.
* **CVE-2020-26147: Reassembling mixed encrypted/plaintext fragments**: Vulnerable WEP, WPA, WPA2, or WPA3 implementations reassemble fragments even though some of them were sent in plaintext. This vulnerability can be abused to inject packets and/or exfiltrate selected fragments when another device sends fragmented frames and the WEP, CCMP, or GCMP data-confidentiality protocol is used.
* **CVE-2020-26142: Processing fragmented frames as full frames**: Vulnerable WEP, WPA, WPA2, or WPA3 implementations treat fragmented frames as full frames. An adversary can abuse this to inject arbitrary network packets, independent of the network configuration.
* **CVE-2020-26141: Not verifying the TKIP MIC of fragmented frames**: Vulnerable Wi-Fi implementations do not verify the Message Integrity Check (authenticity) of fragmented TKIP frames. An adversary can abuse this to inject and possibly decrypt packets in WPA or WPA2 networks that support the TKIP data-confidentiality protocol.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_984e12b5_20250119_122947.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](11) [[next>]](13) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <ae9de74624a11f32da8edd8c195b753c7d177d3b.camel@sipsolutions.net>
Date: Tue, 11 May 2021 20:11:03 +0200
From: Johannes Berg <johannes@...solutions.net>
To: oss-security@...ts.openwall.com
Cc: Jouni Malinen <j@...fi>
Subject: various 802.11 security issues - fragattacks.com

Hi,

Several security issues in the 802.11 implementations were found by
Mathy Vanhoef (New York University Abu Dhabi), who has published all
the details at

	<https://papers.mathyvanhoef.com/usenix2021.pdf>

and

	<https://www.fragattacks.com/>

For Linux, we've developed the set of patches posted here:

[https://lore.kernel.org/linux-wireless/20210511180259.159598-1-johannes@sipsolutions.net/](https://lore.kernel.org/linux-wireless/20210511180259.159598-1-johannes%40sipsolutions.net/)

Specifically, the following CVEs were assigned:

 * CVE-2020-24586 - Fragmentation cache not cleared on reconnection
 * CVE-2020-24587 - Reassembling fragments encrypted under different
                    keys
 * CVE-2020-24588 - Accepting non-SPP A-MSDU frames, which leads to
                    payload being parsed as an L2 frame under an
                    A-MSDU bit toggling attack
 * CVE-2020-26139 - Forwarding EAPOL from unauthenticated sender
 * CVE-2020-26140 - Accepting plaintext data frames in protected
                    networks
 * CVE-2020-26141 - Not verifying TKIP MIC of fragmented frames
 * CVE-2020-26142 - Processing fragmented frames as full frames
 * CVE-2020-26143 - Accepting fragmented plaintext frames in
                    protected networks
 * CVE-2020-26144 - Always accepting unencrypted A-MSDU frames that
                    start with RFC1042 header with EAPOL ethertype
 * CVE-2020-26145 - Accepting plaintext broadcast fragments as full
                    frames
 * CVE-2020-26146 - Reassembling encrypted fragments with non-consecutive
                    packet numbers
 * CVE-2020-26147 - Reassembling mixed encrypted/plaintext fragments

In general, the scope of these attacks is that they may allow an
attacker to
 * inject L2 frames that they can more or less control (depending on the
   vulnerability and attack method) into an otherwise protected network;
 * exfiltrate (some) network data under certain conditions, this is
   specific to the fragmentation issues.

A subset of these issues is known to apply to the Linux IEEE 802.11
implementation (mac80211). Where it is affected, the attached patches
fix the issues, even if not all of them reference the exact CVE IDs.

In addition, driver and/or firmware updates may be necessary, as well
as potentially more fixes to mac80211, depending on how drivers are
using it.

Specifically, for Intel devices, firmware needs to be updated to the
most recently released versions (which was done without any reference
to the security issues) to address some of the vulnerabilities.

To have a single set of patches, I have included the patches for ath10k
and ath11k drivers in my patch posting linked to above.

We currently don't have information about how other drivers are, if
at all, affected.

Thanks,
johannes

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from fragattacks.com_9c34f0e0_20250119_140741.html ===

![](images/logo.png)

### by [@vanhoefm](https://twitter.com/vanhoefm) of [KU Leuven](https://distrinet.cs.kuleuven.be/) / [NYU Abu Dhabi](https://nyuad.nyu.edu/en/research/faculty-labs-and-projects/nyuad-ccs.html)

Navigate page

* [Intro](#intro)
* [Demo](#demo)
* [Details](#details)
* [Paper](#paper)
* [Tools](#tools)
* [Q&A](#faq)

## [Introduction](#intro)

11 May 2021 —
This website presents FragAttacks (**fr**agmentation
and **ag**gregation **attacks**) which is a collection of new
security vulnerabilities that affect Wi-Fi devices. An adversary that is within range of a victim's Wi-Fi network can abuse these
vulnerabilities to steal user information or attack devices. Three of the discovered vulnerabilities are design flaws in the
Wi-Fi standard and therefore affect most devices. On top of this, several other vulnerabilities were discovered that are
caused by widespread programming mistakes in Wi-Fi products. Experiments indicate that every Wi-Fi product is affected
by at least one vulnerability and that most products are affected by several vulnerabilities.

The discovered vulnerabilities affect all modern security protocols of Wi-Fi, including the latest WPA3 specification.
Even the original security protocol of Wi-Fi, called WEP, is affected. This means that several of the newly discovered
design flaws have been part of Wi-Fi since its release in 1997!
Fortunately, the **design flaws are hard to abuse** because doing so requires user interaction or is only
possible when using uncommon network settings.
As a result, in practice the **biggest concern are the programming mistakes in Wi-Fi products** since
several of them are trivial to exploit.

The discovery of these vulnerabilities comes as a surprise, because the security of Wi-Fi has in fact significantly
improved over the past years.
For instance, previously we discovered the [KRACK attacks](https://www.krackattacks.com/), the defenses
against KRACK were [proven secure](https://www.usenix.org/conference/usenixsecurity20/presentation/cremers),
and the latest WPA3 security specification has [improved](https://www.wi-fi.org/file/wi-fi-security-roadmap-and-wpa3-updates-december-2020).
Unfortunately, a feature that could have prevented one of the newly discovered design flaws was not adopted in practice,
and the other two design flaws are present in a feature of Wi-Fi that was previously not widely studied.
This shows it stays important to analyze even the most well-known security protocols (if you want to help,
we are [hiring](#hiring)). Additionally, it shows that it's essential to regularly
test Wi-Fi products for security vulnerabilities, which can for instance be done when certifying them.

To protect users, security updates were prepared during a 9-month-long coordinated disclosure that was supervised by
the [Wi-Fi Alliance](https://www.wi-fi.org/security-update-fragmentation) and
[ICASI](https://www.icasi.org/aggregation-fragmentation-attacks-against-wifi/). If updates for your device
are not yet available, you can [mitigate](#notpatched) some attacks (but not all)
by assuring that websites use HTTPS and by assuring that your devices received all other available updates.

The research will be presented at the [USENIX Security](#usenixpres) conference and a longer talk with more background will also be given at
[Black Hat USA](https://blackhat.com/us-21/briefings/schedule/index.html#fragattacks-breaking-wi-fi-through-fragmentation-and-aggregation-23518)
this summer.

## [Demo](#demo)

The following video shows three examples of how an adversary can abuse the vulnerabilities. First,
the aggregation design flaw is abused to intercept sensitive information (e.g. the victim's username and password).
Second, it's shown how an adversary can exploit insecure internet-of-things
devices by remotely turning on and off a smart power socket. Finally, it's demonstrated how the
vulnerabilities can be abused as a stepping stone to launch advanced attacks. In particular, the video shows how an adversary
can take over an outdated Windows 7 machine inside a local network.

As the demo illustrates, the Wi-Fi flaws can be abused in two ways. First, under the right conditions they can be abused
to steal sensitive data. Second, an adversary can abuse the Wi-Fi flaws to attack devices in someone's home network.

The biggest risk in practice is likely the ability to abuse the discovered flaws to attack devices in someone's home network.
For instance, many smart home and [internet-of-things](https://en.wikipedia.org/wiki/Internet_of_things#Consumer_applications)
devices are rarely updated, and Wi-Fi security is the last line of defense that prevents someone from attacking
these devices. Unfortunately, due to the discover vulnerabilities, this last line of defense can now be bypassed.
In the demo above, this is illustrated by remotely controlling a smart power plug and by taking over an outdated Windows 7 machine.

The Wi-Fi flaws can also be abused to exfiltrate transmitted data. The demo shows how this can be abused to learn
the username and password of the victim when they use the NYU website. However, when a website is configured with
[HSTS](https://www.eff.org/deeplinks/2014/02/websites-hsts) to always
use [HTTPS](https://en.wikipedia.org/wiki/HTTPS) as an extra layer of security, which nowadays
[close](https://www.troyhunt.com/padlocks-phishing-and-privacy-the-value-proposition-of-a-vpn/#1-https-still-has-a-long-way-to-go)
[to](https://twitter.com/Scott_Helme/status/1305605547106983951)
[20%](https://w3techs.com/technologies/details/ce-hsts) of websites are,
the transmitted data cannot be stolen.
Additionally, several browsers now [warn](https://www.blog.google/products/chrome/milestone-chrome-security-marking-http-not-secure)
the user when HTTPS is not being used.
Finally, although [not always](https://www.usenix.org/conference/usenixsecurity21/presentation/oltrogge) perfect,
recent mobile apps by default use HTTPS and therefore also use this extra protection.

## [Details](#details)

### [Presentations](#presentations)

If you don't want to read the following text, you can also watch my [USENIX Security](#usenixpres)
or [WAC4](#wac4pres) presentation.

### [Plaintext injection vulnerabilities](#plaininject)

Several implementation flaws can be abused to easily inject frames into a protected Wi-Fi network. In particular, an adversary
can often inject an unencrypted Wi-Fi frame by carefully constructing this frame. This can for instance be abused to
intercept a client's traffic by tricking the client into using a [malicious DNS server](#extradocs) as shown in the
[demo](#demo) (the intercepted traffic may have [another layer of protection](https://en.wikipedia.org/wiki/HTTPS) though).
Against routers this can also be abused to [bypass the NAT/firewall](#extadocs), allowing the adversary to
subsequently attack devices in the local Wi-Fi network (e.g. attacking an outdated Windows 7 machine as shown in the [demo](#demo)).

How can the adversary construct unencrypted Wi-Fi frames so they are accepted by a vulnerable device?
First, certain Wi-Fi devices **accept any unencrypted frame even when connected to a protected Wi-Fi network**.
This means the attacker doesn't have to do anything special!
Two of out of four tested home routers were affected by this vulnerability, several internet-of-things devices were affected,
and some smartphones were affected. Additionally, many Wi-Fi dongles on Windows will wrongly accept plaintext frames when
they are split into several (plaintext) fragments.

Additionally, certain devices **accept plaintext aggregated frames that look like handshake messages**.
An adversary can exploit this by sending an aggregated frame whose starts resembles a handshake message and whose second
subframe contains the packet that the adversary wants to inject.
A vulnerable device will first interpret this frame as a handshake message, but will subsequently process it as an aggregated frame.
In a sense, one part of the code will think the frame is a handshake message and will accept it even though it's not encrypted.
Another part of the code will instead see it as an aggregated frame and will process the packet that the adversary wants to inject.

![](images/tenor.gif)

A plaintext aggregated frame that also looks like a handshake message ☺

Finally, several devices process broadcasted fragments as normal unfragmented frames. More problematic, some devices
**accept broadcast fragments even when sent unencrypted**.
An attacker can abuse this to inject packets by encapsulating them in the second fragment of a plaintext broadcast frame.

### [Design flaw: aggregation attack](#aggregationattack "CVE-2020-24588")

The first design flaw is in the frame aggregation feature of Wi-Fi. This feature increases the speed and throughput of a network
by combining small frames into a larger aggregated frame. To implement this feature, the header of each frame contains a flag that
indicates whether the (encrypted) transported data contains a single or aggregated frame. This is illustrated in the following figure:

Unfortunately,
this **"is aggregated" flag is not authenticated** and can be modified by an adversary, meaning a victim can
be tricked into processing the encrypted transported data in an unintended manner. An adversary can abuse this to inject
arbitrary network packets by tricking the victim into connecting to their server and then setting the "is aggregated" flag
of carefully selected packets. Practically all tested devices were vulnerable to this attack. The ability to inject packets
can in turn be abused to intercept a victim’s traffic by making it use a malicious DNS server (see the [demo](#demo)).

This design flaw can be fixed by authenticating the "is aggregated" flag. The Wi-Fi standard already contains a feature to
authenticate this flag, namely requiring SPP A-MSDU frames, but this defense is not backwards-compatible and not supported
in practice. Attacks can also be mitigated using an ad-hoc fix, though new attacks may remain possible.

### [Design flaw: mixed key attack](#mixedkeyattack "CVE-2020-24587")

The second design flaw is in the frame fragmentation feature of Wi-Fi. This feature increases the reliability of a connection
by splitting large frames into smaller fragments. When doing this, every fragment that belongs to the
same frame is encrypted using the same key. However, receivers are not required to check this and will **reassemble fragments
that were decrypted using different keys**.
Under rare conditions this can be abused to exfiltrate data. This is accomplished by mixing fragments that are encrypted under different keys,
as illustrated in the following figure:

In the above figure, the first fragment received by the access point is decrypted using a different key
than the second fragment. Nevertheless, the victim will reassemble both fragments. In practice this allows
an adversary to exfiltrate selected client data.

This design flaw can be fixed in a backwards-compatible manner by only reassembling fragments
that were decrypted using the same key.
Because the attack is only possible under rare conditions **it is considered a theoretical attack**.

### [Design flaw: fragment cache attack](#fragcacheattack "CVE-2020-24586")

The third design flaw is also in Wi-Fi's frame fragmentation feature. The problem is that, when a client disconnects
from the network, the Wi-Fi device is **not required to remove non-reassembled fragments from memory**.
This can be abused against hotspot-like networks such as [eduroam and govroam](https://en.wikipedia.org/wiki/Eduroam)
and against enterprise network where users distrust each other. In those cases, selected data sent by the victim can be
exfiltrated. This is achieved by injecting a malicious fragment in the memory (i.e. fragment cache) of the access point.
When the victim then connects to the access point and sends a fragmented frame, selected fragments will be combined (i.e. reassembled)
with the injected fragment of the adversary. This is illustrated in the following figure:

In the above figure, the adversary injects the first fragment into the fragment cache of the access point. After the
adversary disconnects the fragment stays in the fragment cache and will be reassembled with a fragment of the victim.
If the victim sends fragmented frames, which appears uncommon in practice, this can be abused to exfiltrate data.

This design flaw can be fixed in a backwards-compatible manner by removing fragments from memory whenever disconnecting
or (re)connecting to a network.

### [Other implementation vulnerabilities](#codeflaws)

Some routers will forward handshake frames to another client even when the sender hasn't
authenticated yet. This vulnerability allows an adversary to perform the aggregation attack,
and inject arbitrary frames, without user interaction.

Another extremely common implementation flaw is that receivers do not check whether all
fragments belong to the same frame, meaning an adversary can trivially forge frames by mixing the fragments of two
different frames.

Additionally, against several implementations it is possible to mix encrypted and plaintext fragments.

Finally, some devices don't support fragmentation or aggregation, but are still vulnerable to attacks
because they process fragmented frames as full frames. Under the right circumstances this
can be abused to inject packets.

### [Assigned CVE identifiers](#cves)

An overview of all assigned Common Vulnerabilities and Exposures (CVE) identifiers can be found
[on GitHub](https://github.com/vanhoefm/fragattacks/blob/master/SUMMARY.md),
and there is a list of [known advisories](https://github.com/vanhoefm/fragattacks/blob/master/ADVISORIES.md) from companies.
Summarized, the design flaws were assigned the following CVEs:

* [CVE-2020-24588](https://nvd.nist.gov/vuln/detail/CVE-2020-24588): aggregation attack (accepting non-SPP A-MSDU frames).
* [CVE-2020-24587](https://nvd.nist.gov/vuln/detail/CVE-2020-24587): mixed key attack (reassembling fragments encrypted under different keys).
* [CVE-2020-24586](https://nvd.nist.gov/vuln/detail/CVE-2020-24586): fragment cache attack (not clearing fragments from memory when (re)connecting to a network).

Implementation vulnerabilities that allow the trivial injection of plaintext frames in a protected Wi-Fi network are assigned the following CVEs:

* [CVE-2020-26145](https://nvd.nist.gov/vuln/detail/CVE-2020-26145): Accepting plaintext broadcast fragments as full frames (in an encrypted network).
* [CVE-2020-26144](https://nvd.nist.gov/vuln/detail/CVE-2020-26144): Accepting plaintext A-MSDU frames that start with an RFC1042 header with EtherType EAPOL (in an encrypted network).
* [CVE-2020-26140](https://nvd.nist.gov/vuln/detail/CVE-2020-26140): Accepting plaintext data frames in a protected network.
* [CVE-2020-26143](https://nvd.nist.gov/vuln/detail/CVE-2020-26143): Accepting fragmented plaintext data frames in a protected network.

Other implementation flaws are assigned the following CVEs:

* [CVE-2020-26139](https://nvd.nist.gov/vuln/detail/CVE-2020-26139): Forwarding EAPOL frames even though the sender is not yet authenticated (should only affect APs).
* [CVE-2020-26146](https://nvd.nist.gov/vuln/detail/CVE-2020-26146): Reassembling encrypted fragments with non-consecutive packet numbers.
* [CVE-2020-26147](https://nvd.nist.gov/vuln/detail/CVE-2020-26147): Reassembling mixed encrypted/plaintext fragments.
* [CVE-2020-26142](https://nvd.nist.gov/vuln/detail/CVE-2020-26142): Processing fragmented frames as full frames.
* [CVE-2020-26141](https://nvd.nist.gov/vuln/detail/CVE-2020-26141): Not verifying the TKIP MIC of fragmented frames.

For each implementation vulnerability we listed the reference CVE identifier.
Although each affected codebase normally receives a unique CVE,
the agreement between affected vendors was that, in this specific case,
using the same CVE across different codebases would make communication easier.
For instance, by tying one CVE to each vulnerability, a customer can now ask a vendor
whether their product is affected by a specific CVE.

Please note that this deviates from normal MITRE guidelines, and that this decision was made
by affected vendors independently of MITRE, and that this in no way reflects any changes in how MITRE assigns CVEs.

## [Paper](#paper)

Our paper behind the attack is titled
[Fragment and Forge: Breaking Wi-Fi Through Frame Aggregation and Fragmentation](https://papers.mathyvanhoef.com/usenix2021.pdf)
and was presented at [USENIX Security](https://www.usenix.org/conference/usenixsecurity21/presentation/vanhoef).
You can use the following bibtex entry to cite our paper:

```
@inproceedings{vanhoef-usenix2021-fragattacks,
  author = {Mathy Vanhoef},
  title = {Fragment and Forge: Breaking {Wi-Fi} Through Frame Aggregation and Fragmentation},
  booktitle = {Proceedings of the 30th {USENIX} Security Symposium},
  year = {2021},
  month = {August},
  publisher = {{USENIX} Association}
}
```
### [Paper Clarifications](#papernotes)

* In the paper in Section 6 regarding implementation vulnerabilities, when a tested device accepts plaintext frames, it will also accepted fragmented plaintext frames (Table 1, 2, and 3).

### [USENIX Security Presentation](#usenixpres)

The pre-recorded presentation made for USENIX Security can already be viewed online. Note that the target audience
of this presentation are academics and IT professionals:

### [Workshop on Attacks on Cryptography Presentation](#wac4pres)

A longer presentation that covers more details is the one that I gave at the WAC4 workshop:

### [Extra Documents](#extadocs)

* An [overview](https://papers.mathyvanhoef.com/fragattacks-overview.pdf) of all
  **attacks and their preconditions**. It also contains two extra examples on how an
  adversary can: (1) abuse packet injection vulnerabilities to make a victim use a malicious DNS; and
  (2) how packet injection can be abused to bypass the NAT/firewall of a router.
* [Slides](https://papers.mathyvanhoef.com/fragattacks-slides-amsdu.pdf) illustrating
  how the aggregation attack (CVE-2020-24588) works in practice. Performing this attack requires tricking
  the victim into connecting to the adversary's server. This can be done by making the victim download an
  image from the adversary’s server. Note that JavaScript code execution on the victim is not required.
* [Detailed slides](https://papers.mathyvanhoef.com/fragattacks-slides-2021-03-8.pdf)
  giving an in-depth explanation of each discovered vulnerability.* [Overview slides](https://papers.mathyvanhoef.com/fragattacks-slides-summary-2021-03-8.pdf)
    illustrating only the root cause of each discovered vulnerability.

## [Tools](#tools)

A [tool was made](https://github.com/vanhoefm/fragattacks) that can test if clients or APs are
affected by the discovered design and implementations flaws. It can test home networks and enterprise networks where
authentication is done using, e.g., PEAP-MSCHAPv2 or EAP-TLS. The **tool supports over 45 test cases** and requires modified
drivers in order to reliable test for the discovered vulnerabilities. Without modified drivers, one may wrongly conclude
that a device is not affected while in reality it is.

A **live USB image** is [also available](https://github.com/vanhoefm/fragattacks#id-live-image).
This image contains pre-installed modified drivers, modified firmware for certain Atheros USB dongles, and a
pre-configured Python environment for the tool. Using a live image is useful when you cannot install the modified
drivers natively (and using a virtual machine can be unreliable for some network cards).

Apart from a tool to test if a device is vulnerable I also made proof-of-concepts to exploit weaknesses. Because not all
devices currently have received updates these attacks scripts will be released at a later point if deemed useful.

## [Q&A](#faq)

* [How can I contact you?](#contact)
* [Are you looking for PhD students?](#hiring)
* [Can I reuse the images on this website?](#images)
* [Why did nobody notice the aggregation design flaw before?](#ieeenoticed)
* [Why was the defense against the aggregation attack (CVE-2020-24588) not adopted?](#whynotadopted)
* [My device isn't patched yet, what can I do?](#notpatched)
* [Does using EAP-TLS increase the difficulty of attacks?](#eaptls)
* [Does using 802.11w help mitigate attacks?](#mfp)
* [Why is Wi-Fi security important? We already have HTTPS.](#whyimportant)
* [Will using a VPN prevent attacks?](#vpn)
* [How did you discover this?](#howfound)
* [How sure are you that all Wi-Fi devices are affected?](#allaffected)
* [Does this mean every Wi-Fi device is trivial to attack?](#istrivial)
* [How many networks use fragmentation?](#usagefrag)
* [How many networks periodically refresh the pairwise session key?](#usagerenew)
* [Isn't it irresponsible to release tools to perform the attacks?](#abusetools)
* [Where are all the attack tools?](#attacktools)
* [Do you have example network captures of the vulnerabilities?](#captures)
* [How long will you maintain the driver patches needed to run the test scripts?](#maintaindriver)
* [Why are so many implementations vulnerable to be non-consecutive PN attack?](#nonsecdesign)
* [Why are so many implementations vulnerable to the mixed plaintext/encrypted fragment attack?](#mixeddesign)
* [Can an implementation be vulnerable to a cache attack without being vulnerable to a mixed key attack?](#cachenotmixed)
* [Can the mixed-key attack be prevented in a backward-compatible manner?](#mixedbackward)
* [Is the old WPA-TKIP protocol also affected by the design flaws?](#tkip)
* [Is the ancient WEP protocol also affected by the design flaws?](#wep)
* [Can fragmentation attacks be preventing by disallowing small delays between fragments?](#fragdelays)
* [Are patches for Linux available?](#patchlinux)
* [Did others also discover the plaintext injection issue (CVE-2020-26140)?](#plainothers)
* [Why do you use the same CVE for implementation issues in multiple different codebases?](#samecves)
* [Why was the embargo so long?](#longembargo)
* [How did you monitor for leaks during the embargo?](#detectleaks)
* [Are these vulnerabilities being exploited in practice?](#beingexploit)
* [Why did Microsoft already fix certain vulnerabilities on March 9, 2021?](#microsoft)
* [Is the "Treating fragments as full frames" flaw (CVE-2020-26142) also applicable to APs?](#apfragasfull)
* [Can APs be vulnerable to attacks that send broadcast frames?](#aprecievebcast)
* [Why are some of the tested devices so old?](#whyold)
* [How did you make macOS switch to the malicious DNS server in the demonstration?](#forcebaddns)
* [Isn't nyu.edu using HSTS to prevent these kind of attacks?](#nyuhsts)
* [How do I reproduce the BlueKeep attack shown in the demonstration?](#bluekeep)

### [How can I contact you?](#contact)

You can reach Mathy Vanhoef on twitter at [@vanhoefm](https://www.twitter.com/vanhoefm)
or by emailing mathy.vanhoef@nyu.edu.

### [Are you looking for PhD students?](#hiring)

Yes! Mathy Vanhoef will be starting as a professor at KU Leuven University (Belgium) later this year and is
looking for a **PhD student**. The precise topic you want to work on can be discussed. If you're
a master student at KU Leuven you can also contact me to discuss a **Master's thesis** topic.
Note that the [DistriNet](https://distrinet.cs.kuleuven.be/jobs/) group at KU Leuven is also recruiting
in security-related research fields.

If you want to do network research at New York University Abu Dhabi in the
[Cyber Security & Privacy (CSP)](https://nyuad.nyu.edu/en/research/faculty-labs-and-projects/cybersecurity-and-privacy-lab.html)
team where the FragAttacks research was carried out, you can contact [Christina Pöpper](https://poepper.net/).

### [Can I reuse the images on this website?](#images)

Yes, you can use the [logo](images/logo.png), illustrations of the [aggregation](images/aggregated.png)
design flaw ([mobile version](images/aggregatedsmall.png)),
illustrations of the [mixed key](images/mixedkey.png) design flaw ([mobile version](images/mixedkeysmall.png)),
and illustrations of the [fragment cache](images/fragmentcache.png) design flaw ([mobile version](images/fragmentcachesmall.png)).

Thanks goes to [Darlee Urbiztondo](https://www.thehappylee.com/graphic-design-projects) for designing the logo.

### [Why did nobody notice the aggregation design flaw before?](#ieeenoticed)

When the 802.11n amendment was being written in 2007, which introduced supported for aggregated (A-MSDU) frames,
[several IEEE members](https://mentor.ieee.org/802.11/dcn/07/11-07-0397-07-000n-msdu-protection.doc)
noticed that the "is aggregated" flag was not authenticated. Unfortunately, many products already implemented
a draft of the 802.11n amendment, meaning this problem had to be addressed in a backwards-compatible manner.
The decision was made that devices would advertise whether they are capable of authenticating the "is aggregated"
flag. Only when devices implement and advertise this capability is the "is aggregated" flag protected. Unfortunately,
in 2020 not a single tested device supported this capability, likely because it was considered hard to exploit.
[To quote](https://mentor.ieee.org/802.11/dcn/07/11-07-0397-07-000n-msdu-protection.doc) a remark
made back in 2007:
*"While it is hard to see how this can be exploited, it is clearly a flaw that is capable of being fixed."*

In other words, people did notice this vulnerability and a defense was standardized, but in practice the defense
was never adopted. This is a good example that security defenses must be adopted before attacks become practical.

### [Why was the defense against the aggregation attack (CVE-2020-24588) not adopted?](#whynotadopted)

Likely because it was only considered a theoretic vulnerability when the defense was created.
[To quote](https://mentor.ieee.org/802.11/dcn/07/11-07-0397-07-000n-msdu-protection.doc) a remark
made back in 2007:
*"While it is hard to see how this can be exploited, it is clearly a flaw that is capable of being fixed."*

Additionally, the threat model that was used in the aggregation attack, were the victim is induced into connecting to the
adversary's server, only become widely accepted in 2011 after the disclosure of the [BEAST](https://en.wikipedia.org/wiki/Transport_Layer_Security#BEAST_attack)
attack. In other words, the threat model was not yet widely known back in 2007 when the IEEE added the optional feature
that would have prevented the attack. And even after this threat model became more common,
the resulting attack isn't obvious.

### [My device isn't patched yet, what can I do?](#notpatched)

First, it's always good to remember general security best practices: update your devices, don't reuse your passwords,
make sure you have backups of important data, don't visit shady websites, and so on.

In regards to the discovered Wi-Fi vulnerabilities, you can mitigate attacks that exfiltrate sensitive data by
double-checking that websites you are visiting
[use HTTPS](https://www.blog.google/products/chrome/milestone-chrome-security-marking-http-not-secure).
Even better, you can install the [HTTPS Everywhere](https://www.eff.org/https-everywhere) plugin. This plugin
forces the usage of HTTPS on websites that are known to support it.

To mitigate attacks where your router's NAT/firewall is bypassed and devices are directly attacked, you must assure that
all your devices are updated. Unfortunately, not all products regularly receive updates, in particular smart or internet-of-things
devices, in which case it is difficult (if not impossible) to properly secure them.

More technically, the impact of attacks can also be reduced by manually configuring your DNS server so that it cannot be poisoned.
Specific to your Wi-Fi configuration, you can mitigate attacks (but not fully prevent them) by disabling fragmentation,
disabling pairwise rekeys, and disabling dynamic fragmentation in Wi-Fi 6 (802.11ax) devices.

### [Does using EAP-TLS increase the difficulty of attacks?](#eaptls)

No. All attacks are possible no matter how the client authenticates the network. In other words, attacks are identical
against home and enterprise networks. Moreover, it doesn't matter which EAP method you use in an enterprise network:
all attacks remain possible and can be abused in exactly the same manner.

Important to remark is that exploiting the design flaws relies on a multi-channel machine-in-the-middle position
(and abusing CVE-2020-26146 relies on this MitM as well). This MitM is not a traditional rogue AP. Instead, the attacker
is copying all frames from the real AP to a different Wi-Fi channel. This can be done no matter which authentication method
the network is using. You can read more about this MitM in
[my blog post](https://www.mathyvanhoef.com/2021/05/fragattacks-clarifying-some-aspects.html#rogue-ap).

### [Does using 802.11w help mitigate attacks?](#mfp)

No. Using 802.11w, also known as management frame protection, has no impact on any of the attacks. Even attacks that rely
on the multi-channel machine-in-the-middle position (i.e. the design flaws and CVE-2020-26146) remain possible when using 802.11w.
This is because this MitM isn't established
by sending deauthentication or disassociation frames to first disconnect the client from the network. Instead, to establish
this MitM, the attacker forces the client to switch to another channel. This is accomplished by spoofing beacon frames
that contain malicious Channel Switch Announcements. These beacon frames can be spoofed even when 802.11w is enabled, meaning
that enabling 802.11w won't make attacks harder.

You can read more about the multi-channel MitM in
[my blog post](https://www.mathyvanhoef.com/2021/05/fragattacks-clarifying-some-aspects.html#rogue-ap).
This MitM can be established in precisely the same manner whether or not 802.11w is used.

### [Why is Wi-Fi security important? We already have HTTPS.](#whyimportant)

These days a lot of websites and apps use [HTTPS](https://en.wikipedia.org/wiki/HTTPS) to encrypt data.
When using HTTPS, an adversary cannot see the data you are transmitting even when you are connected to an open Wi-Fi network.
This also means that you can safely use open Wi-Fi hotspots as long as you keep your devices up-to-date and as long as you assure
that websites are using HTTPS. Unfortunately, not all websites require the usage of HTTPS (i.e. they're not using
[HSTS](https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security)), meaning they remain
vulnerable to possible attacks.

At home, the security of your Wi-Fi network is also essential. An insecure network means that others might be able
to connect to the internet through your home. Additionally, more and more devices are using Wi-Fi to transfer personal
files in your local network without an extra layer of protection (e.g. when printing files, smart display screens, when
sending files to a local backup storage, digital photo stands, and so on). More problematic, a lot of internet-of-things devices have tons
of security vulnerabilities that can be exploited if an adversary can communicate with them. The main thing that prevents
an adversary from exploiting these insecure internet-of-things devices is the security of your Wi-Fi network. It therefore
remains essential to have strong encryption and authentication at the Wi-Fi layer.

At work, the security of Wi-Fi is also essential for the same reasons as mentioned above. Additionally, many
companies will automatically allow access to sensitive services when a user (or adversary) is able to
connect to the Wi-Fi network. Therefore strong Wi-Fi security is also essential in a work setting.

### [Will using a VPN prevent attacks?](#vpn)

Using a VPN can prevent attacks where an adversary is trying to exfiltrate data. It will not prevent an
adversary from bypassing your router's NAT/firewall to directly attack devices.

### [How did you discover this?](#howfound)

The seeds of this research were already planted while I was investigating the [KRACK attack](https://krackattacks.com).
At that time, on 8 June 2017 to be
precise, I wrote down some notes to further investigate (de)fragmentation support in Linux. In particular, I thought there might be an
implementation vulnerability in Linux. However, a single unconfirmed implementation flaw isn't too spectacular research-wise, so after disclosing
the KRACK attack I decided to work on other research instead. The idea of inspecting (de)fragmentation in Wi-Fi, and determining whether
there really was a vulnerability or not, was always at the back of my mind though.

Fast-forward three years later, and after gaining some additional ideas to investigate, closer inspection confirmed some of my hunches
and also revealed that these issues were more widespread than I initially assumed. And with some extra insights I also discovered all
the other vulnerabilities. Interestingly, this also shows the advantage of fleshing out ideas before rushing to publish (though actually
finishing the paper before submission was still a race against time..).

### [How sure are you that all Wi-Fi devices are affected?](#allaffected)

In experiments on more than 75 devices, all of them were vulnerable to one or more of the discovered attacks.
I'm curious myself whether *all* devices in the whole world are indeed affected though! To find this out, if you
find a device that isn't affected by at least one of the discovered vulnerabilities, let me know.

Also, if your company provides Wi-Fi devices and you think that your product was not affected by any of the discovered vulnerabilities,
you can send your product to me. Once I confirmed that it indeed was not affected by any vulnerabilities the name of
your product and company will be put here! Note that I do need a method to assure that I'm indeed testing a version
of the product that was available before the disclosure of the vulnerabilities (and that you didn't silently patch
some vulnerabilities).

### [Does this mean every Wi-Fi device is trivial to attack?](#istrivial)

The design issues are, on their own, tedious to exploit in practice. Unfortunately, some of the implementation
vulnerabilities are common and trivial to exploit. Additionally, by combining the design issues with certain implementation
issues, the resulting attacks become more serious. This means the impact of our findings depends on the specific
target. Your vendor can inform you what the precise impact is for specific devices. In other words, for some devices
the impact is minor, while for others it's disastrous.

### [How many networks use fragmentation?](#usagefrag)

By default devices don't send fragmented frames. This means that the mixed key attack and the fragment cache attack,
on their own, will be hard to exploit in practice, unless Wi-Fi 6 is used. When using Wi-Fi 6, which is based on the
802.11ax standard, a device may dynamically fragment frames to fill up available airtime.

### [How many networks periodically refresh the pairwise session key?](#usagerenew)

By default access points don't renew the pairwise session key, even though some may periodically renew the group key.
This means that the default mixed key attack as described in the paper is only possible against networks that deviate from
this default setting.

### [Isn't it irresponsible to release tools to perform the attacks?](#abusetools)

The test tool that we released can only be used to test whether a device is vulnerable. It cannot be used
to perform attacks: an adversary would have to write their own tools for that. This approach enables network
administrators to test if devices are affected while reducing the chance of someone abusing the released code.

### [Where are all the attack tools?](#attacktools)

The code that has currently been released focusses on *detecting* vulnerable implementations. The proof-of-concepts
scripts that perform actual attacks are not released to provide everyone with more time to implement and deploy patches.
Once a large enough fraction of devices has been patched, and if deemed necessary and/or beneficial, the attack script
will be publicly released as well.

### [Do you have example network captures of the vulnerabilities?](#captures)

There are example [network captures](https://github.com/vanhoefm/fragattacks/tree/master/example-pcaps) of the
[test tool](#tools) that illustrate the root causes of several vulnerabilities.

### [How long will you maintain the driver patches needed to run the test scripts?](#maintaindriver)

The modifications to certain drivers have been submitted upstream to Linux meaning they will be maintained by the Linux developers
themselves. The patches to the Intel driver have not been submitted upstream because they're a bit hacky. Concretely, this means that
drivers such as ath9k\_htc will be supported out of the box, while for Intel devices you will have to use patched drivers and I'm not
sure how much time I'll have to maintain those.

### [Why are so many implementations vulnerable to be non-consecutive PN attack?](#nonsecdesign)

That's a good question. I'm not sure why so many developers missed this. This widespread implementation vulnerability
does highlight that leaving important cryptographic operations up to developers is not ideal. Put another way, it might
have been better if the standard required an authenticity check over the reassembled frame instead. That would also better
follow the principle of authenticated encryption.

### [Why are so many implementations vulnerable to the mixed plaintext/encrypted fragment attack?](#mixeddesign)

The 802.11 standard states in section 10.6: "If security encapsulation has been applied to the fragment, it shall be
deencapsulated and decrypted before the fragment is used for defragmentation of the MSDU or MMPDU". There is unfortunately
no warning that unencrypted *fragments* should be dropped. And there are no recommend checks that should be
performed when reassembling two (decrypted) fragments.

### [Can an implementation be vulnerable to a cache attack without being vulnerable to a mixed key attack?](#cachenotmixed)

Yes, although this is unlikely to occur in practice. More technically, let's assume that an implementation tries to prevent mixed key
attacks by: (1) assigning an unique key ID to every fragment; (2) incrementing this key ID whenever the pairwise transient
key (PTK) is updated; and (3) assuring all fragments were decrypted under the same key ID. Unfortunately, in that case
cache attacks may still be feasible. In particular, if under this defense key IDs are reused
after (re)connecting to a network, for example because they are reset to zero, fragments that are decrypted
using a different key may still be assigned the same key ID. As a result, cache attacks remain possible, because the
fragments will still be reassembled as they have the same key ID.

### [Can the mixed-key attack be prevented in a backward-compatible manner?](#mixedbackward)

Strictly speaking not, because the 802.11 standard does not explicitly require that a sender encrypts all fragments
of a specific frame under the same key. Fortunately, all implementations that we tested did encrypt all fragments using
the same key, at least under the normal circumstances that we tested, meaning in practice the mixed key attack can be
prevented without introducing incompatibilities.

### [Is the old WPA-TKIP protocol also affected by the design flaws?](#tkip)

Strictly speaking not, though implementations can still be vulnerable. Note that TKIP should not be used because it
is affected by other more serious security flaws. Additionally, TKIP has been
[deprecated](https://www.wi-fi.org/file/technical-note-removal-of-tkip-from-wi-fi-devices) by the Wi-Fi Alliance.

The TKIP protocol is not affected by the fragmentation-based design flaws (CVE-2020-24587 and CVE-2020-24586) because it
verifies the authenticity of the full reassembled frame. This is in contrast to CCMP and GCMP,
which only verify the authenticity of individual fragments, and rely on sequential packet numbers to securely reassemble
the individual (decrypted) fragments.

Additionally, TKIP is not affected by the aggregation design flaw (CVE-2020-24588) because a receiver is supposed
to drop A-MSDUs that are encrypted using TKIP. Indeed, in Section "12.9.2.8 Per-MSDU/Per-A-MSDU Rx pseudocode"
of the [802.11-2016](https://standards.ieee.org/standard/802_11-2016.html) standard it's specified that
when using TKIP only normal MSDU frames are accepted.

Unfortunately, some implementations don't verify the authenticity of fragmented TKIP frames, and some accept aggregated
frames (i.e. A-MSDUs) even when encrypted using TKIP. This unfortunately means that in practice TKIP implementations
may still be vulnerable.

### [Is the ancient WEP protocol also affected by the design flaws?](#wep)

Yes. The WEP protocol is so horrible that it doesn't even try to verify the authenticity of fragmented frames.
This means an adversary can trivially perform aggregation-based attacks against WEP.

Similar to TKIP, the WEP protocol is not affected by the aggregation design flaw (CVE-2020-24588)
because a receiver is supposed to drop A-MSDUs that are encrypted using WEP. Nevertheless, in practice several
WEP implementations do accept A-MSDUs and therefore are still vulnerable.

Finally, in case you've been living under a rock, stop using WEP, it's known to be a
[horrible](https://en.wikipedia.org/wiki/Wired_Equivalent_Privacy#Weak_security) security protocol.

### [Can fragmentation attacks be preventing by disallowing small delays between fragments?](#fragdelays)

This would make exploiting possible vulnerabilities harder and perhaps in some cases practically infeasible.
Unfortunately this doesn't provide any guarantees though. I therefore recommend to fix the root cause instead.

### [Are patches for Linux available?](#patchlinux)

Yes! During the embargo I helped write some patches for the Linux kernel. This means an updated Linux kernel should (soon) be
available for actively supported Linux distributions.

### [Did others also discover the plaintext injection issue (CVE-2020-26140)?](#plainothers)

During the embargo I was made aware that [Synopsys also discoveredthe plaintext injection vulnerability (CVE-2020-26140) in access points. They found that Mediatek, Realtek, and Qualcomm were
affected, and to cover these three implementations the identifiers
[CVE-2019-18989](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-18989),
[CVE-2019-18990](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-18990), and
[CVE-2019-18991](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-18991) were respectively assigned.](https://www.synopsys.com/blogs/software-security/cyrc-advisory-sept2020/)

During the FragAttacks research I found that the same vulnerability was (still) present in other access points and that clients
can be vulnerable to a similar attack. Additionally, and somewhat surprisingly, I also found that some devices reject
normal (non-fragmented) plaintext frames but do accept fragmented plaintext frames (CVE-2020-26143).

### [Why do you use the same CVE for implementation issues in multiple different codebases?](#samecves)

Implementation-specific vulnerabilities usually get their own independent CVE identifier for each different codebase.
However, because the same implementation issues seem to be present across multiple vendors it would make more sense to have a single CVE identifier
for each common implementation issue.
After all, the main purpose of CVE identifiers is to provide a single, common ID to be used across vendors to identify the same vulnerability.
We therefore think it makes sense to assign only a single CVE identifier to each implementation issues. This enables vendors
and customers to easily reference an implementation vulnerability and, for instance, check whether certain products are affected
by one of the discovered vulnerabilities.

### [Why was the embargo so long?](#longembargo)

The disclosure was delayed by two months in consensus with ICASI and the Wi-Fi Alliance. The decision on whether to disclose fast,
or to provide more time to write and create patches, wasn't easy. At the time, the risk of leaks appeared low,
and the advantage of delaying appeared high. Additionally, we were prepared to immediately disclose in case
details would accidently leak publicly. Another aspect that influenced my decision was *the current situation*, meaning COVID-19,
which among other things made it harder to safely get access to physical places/labs to test patches.

### [How did you monitor for leaks during the embargo?](#detectleaks)

During the last two months of the embargo, we were prepared to make the research public whenever information would seemed to
be leaking. To detect leaks I personally searched for relevant keywords (CVE numbers, paper title, script names) on Google and
social media such as Twitter. The Wi-Fi Alliance and ICASI were also monitoring for leaks (e.g. if questions
came from people that shouldn't have known about it). This can detect innocent leaks. Detecting malicious leaks or
usage of the vulnerabilities in stealthy attacks is a much harder problem (if even possible at all).

If you know about cases where some information was (accidently) leaked, it would be useful to know about that so
that I can better estimate the impact of having long embargos. Any information you provide about this will remain
confidential. This information will help me in future decision when weighing the option of a longer embargo versus
disclosing research even when several vendors don't have patches ready (i.e. it won't be used to point fingers).

### [Are these vulnerabilities being exploited in practice?](#beingexploit)

Not that we are aware of. Because some of the design flaws took so long to discover my hunch is that those have
not been previously exploited in the wild. But it is difficult to monitor whether one of the discovered vulnerabilities have
been exploited in the past or are currently being exploited. So it is hard to give a definite answer to this
question.

### [Why did Microsoft already fix certain vulnerabilities on March 9, 2021?](#microsoft)

The original disclosure date was March 9, 2021. Roughly one week beforehand it was decided to [delay the disclosure](#longembargo).
At this time Microsoft had already committed to shipping certain patches on March 9. I agreed that already releasing
certain patches without providing information about the vulnerabilities was, at that point, an acceptable risk.
Put differently, the advantages of delaying the disclosure appeared to outweigh the risk that someone would reverse engineer
the patches and rediscover certain attacks.

### [Is the "Treating fragments as full frames" flaw (CVE-2020-26142) also applicable to APs?](#apfragasfull)

Yes, access points can also be vulnerable. In particular, during additional experiments that I recently performed, the vulnerability was
also present in OpenBSD when it acted as an access point.

### [Can APs be vulnerable to attacks that send broadcast frames?](#aprecievebcast)

Yes, although they are less likely to be vulnerable compared to clients. This is because under normal circumstances clients
never send a frame to the AP with a broadcast receiver address. Instead, clients first send broadcast/multicast network packets
as unicast Wi-Fi frames to the AP, and the AP then broadcasts these packets to all connected clients. As a result, many APs
will simply ignore Wi-Fi frames with a broadcast receiver address, because in normal networks those frames are only meant for clients.

### [Why are some of the tested devices so old?](#whyold)

I also tested some very old Wi-Fi devices and dongles to estimate how long the discovered vulnerabilities have been
present in the wild. Note that some old devices may remain in use for a long time, for example, expensive medical
or industrial equipment that is rarely replaced.

### [How did you make macOS switch to the malicious DNS server in the demonstration?](#forcebaddns)

After injecting the ICMPv6 Router Advertisement with the malicious DNS server, macOS won't immediately use this DNS server.
This is because macOS will only switch to the malicious DNS server if its current (primary) DNS server is no longer responding.
To force this to happen, we briefly block all traffic towards the victim. This causes macOS to switch to the malicious DNS server.

### [Isn't nyu.edu using HSTS to prevent these kind of attacks?](#nyuhsts)

Websites can use [HSTS](https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security) to force browsers to always
use HTTPS encryption when visiting a website. This prevents the attack that was shown in our [demo](#href).
Unfortunately, the website of NYU at the time did not properly configure HSTS. More technically, some subdomains such as
globalhome.nyu.edu do instruct the browser to use HSTS by including the following header in responses:

```
strict-transport-security: max-age=31536000 ; includeSubDomains
```

Unfortunately, other subdomains such as shibboleth.nyu.edu remove HSTS by including the following header in responses:

```
Strict-Transport-Security: max-age=0
```

Combined with other configuration decisions, this meant that when a user would type nyu.edu in their browser,
the initial request was sent in plaintext and therefore could be intercepted by an adversary.

Note that NYU has been informed of this issue and is investigating it.

### [How do I reproduce the BlueKeep attack shown in the demonstration?](#bluekeep)

First, when using the NAT punching technique, it is essential that you manually configure the CPORT parameter so that metasploit uses
the correct client port. You can learn this port from the injected TCP SYN packet that arrives at the server. When using a different client port
the router/NAT will not recognize the connection and will not forward it to the victim machine.

Second, you must set the AutoCheck parameter to zero. Otherwise metasploit will try to initiate multiple connections with the
victim and that is problematic when manually specifying a client port through CPORT. This workaround of setting AutoCheck
to zero can be avoided by punching multiple holes in the router/NAT and modifying the metasploit to use a different CPORT for
each connection that will be initiated.

[Creative Commons Attribution 4.0 International License](http://creativecommons.org/licenses/by/4.0/) | Design inspired by [TEMPLATED](http://templated.co).



=== Content from cert-portal.siemens.com_3e18c131_20250119_122949.html ===
Siemens Security Advisory by Siemens ProductCERT

SSA-913875: Frame Aggregation and Fragmentation Vulnerabilities
in 802.11

Publication Date:
Last Update:
Current Version:
CVSS v3.1 Base Score: 6.5

2021-07-13
2022-04-12
V1.3

SUMMARY

Twelve vulnerabilities in the implementation of frame aggregation and fragmentation of the 802.11
standard, under the name of FragAttacks, have been published.

Successful exploitation of these vulnerabilities could allow an attacker within Wi-Fi range to forge encrypted
frames, which could result in sensitive data disclosure and possibly trafﬁc manipulation.

The advised Siemens products are only affected by some of the published vulnerabilities.

Siemens has released updates for several affected products and recommends to update to the latest
versions. Siemens recommends speciﬁc countermeasures for products where updates are not, or not yet
available.

AFFECTED PRODUCTS AND SOLUTION

Affected Product and Versions

Remediation

SCALANCE W721-1 RJ45 (6GK5721-1FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W721-1 RJ45 (6GK5721-1FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W722-1 RJ45 (6GK5722-1FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SSA-913875

© Siemens 2022

Page 1 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W722-1 RJ45 (6GK5722-1FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W722-1 RJ45 (6GK5722-1FC00-
0AC0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W734-1 RJ45 (6GK5734-1FX00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W734-1 RJ45 (6GK5734-1FX00-
0AA6):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W734-1 RJ45 (6GK5734-1FX00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W734-1 RJ45 (USA) (6GK5734-
1FX00-0AB6):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W738-1 M12 (6GK5738-1GY00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SSA-913875

© Siemens 2022

Page 2 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W738-1 M12 (6GK5738-1GY00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W748-1 M12 (6GK5748-1GD00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W748-1 M12 (6GK5748-1GD00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W748-1 RJ45 (6GK5748-1FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W748-1 RJ45 (6GK5748-1FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W761-1 RJ45 (6GK5761-1FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W761-1 RJ45 (6GK5761-1FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SSA-913875

© Siemens 2022

Page 3 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W774-1 M12 EEC (6GK5774-1FY00-
0TA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W774-1 M12 EEC (6GK5774-1FY00-
0TB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W774-1 RJ45 (6GK5774-1FX00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W774-1 RJ45 (6GK5774-1FX00-
0AA6):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W774-1 RJ45 (6GK5774-1FX00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W774-1 RJ45 (6GK5774-1FX00-
0AC0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W774-1 RJ45 (USA) (6GK5774-
1FX00-0AB6):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SSA-913875

© Siemens 2022

Page 4 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W778-1 M12 (6GK5778-1GY00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W778-1 M12 (6GK5778-1GY00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W778-1 M12 EEC (6GK5778-
1GY00-0TA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W778-1 M12 EEC (USA) (6GK5778-
1GY00-0TB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-1 RJ45 (6GK5786-1FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-1 RJ45 (6GK5786-1FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-2 RJ45 (6GK5786-2FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SSA-913875

© Siemens 2022

Page 5 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W786-2 RJ45 (6GK5786-2FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-2 RJ45 (6GK5786-2FC00-
0AC0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-2 SFP (6GK5786-2FE00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-2 SFP (6GK5786-2FE00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-2IA RJ45 (6GK5786-2HC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-2IA RJ45 (6GK5786-2HC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-1 M12 (6GK5788-1GD00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SSA-913875

© Siemens 2022

Page 6 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W788-1 M12 (6GK5788-1GD00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-1 RJ45 (6GK5788-1FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-1 RJ45 (6GK5788-1FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-2 M12 (6GK5788-2GD00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-2 M12 (6GK5788-2GD00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-2 M12 EEC (6GK5788-
2GD00-0TA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-2 M12 EEC (6GK5788-
2GD00-0TB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SSA-913875

© Siemens 2022

Page 7 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W788-2 M12 EEC (6GK5788-
2GD00-0TC0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-2 RJ45 (6GK5788-2FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-2 RJ45 (6GK5788-2FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-2 RJ45 (6GK5788-2FC00-
0AC0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SCALANCE W1748-1 M12 (6GK5748-1GY01-
0AA0):
All versions < V3.0.0
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26146, CVE-2020-26147

Update to V3.0.0 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109808629/
See further
Workarounds and Mitigations

recommendations from section

SCALANCE W1748-1 M12 (6GK5748-1GY01-
0TA0):
All versions < V3.0.0
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26146, CVE-2020-26147

Update to V3.0.0 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109808629/
See further
Workarounds and Mitigations

recommendations from section

SCALANCE W1750D:
All versions < V8.7.1.3
only affected by CVE-2020-24588, CVE-2020-
26146

Update to V8.7.1.3 or later version
https://support.industry.siemens.com/cs/de/en/
view/109802805/
See further
Workarounds and Mitigations

recommendations from section

SCALANCE W1788-1 M12 (6GK5788-1GY01-
0AA0):
All versions < V3.0.0
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26146, CVE-2020-26147

Update to V3.0.0 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109808629/
See further
Workarounds and Mitigations

recommendations from section

SSA-913875

© Siemens 2022

Page 8 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W1788-2 EEC M12 (6GK5788-
2GY01-0TA0):
All versions < V3.0.0
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26146, CVE-2020-26147

Update to V3.0.0 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109808629/
See further
Workarounds and Mitigations

recommendations from section

SCALANCE W1788-2 M12 (6GK5788-2GY01-
0AA0):
All versions < V3.0.0
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26146, CVE-2020-26147

Update to V3.0.0 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109808629/
See further
Workarounds and Mitigations

recommendations from section

SCALANCE W1788-2IA M12 (6GK5788-2HY01-
0AA0):
All versions < V3.0.0
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26146, CVE-2020-26147

Update to V3.0.0 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109808629/
See further
Workarounds and Mitigations

recommendations from section

(6GK5763-1AL00-

SCALANCE WAM763-1
7DA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

(6GK5766-1GE00-

SCALANCE WAM766-1
7DA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

(6GK5766-1GE00-

SCALANCE WAM766-1
7DB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

SCALANCE WAM766-1 6GHz (6GK5766-1JE00-
7DA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

SCALANCE WAM766-1 EEC (6GK5766-1GE00-
7TA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

SSA-913875

© Siemens 2022

Page 9 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE WAM766-1 EEC (6GK5766-1GE00-
7TB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

SCALANCE WAM766-1 EEC 6GHz (6GK5766-
1JE00-7TA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

(6GK5763-1AL00-

SCALANCE WUM763-1
3AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

(6GK5763-1AL00-

SCALANCE WUM763-1
3DA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

(6GK5766-1GE00-

SCALANCE WUM766-1
3DA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

(6GK5766-1GE00-

SCALANCE WUM766-1
3DB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

SCALANCE WUM766-1 6GHz (6GK5766-1JE00-
3DA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

WORKAROUNDS AND MITIGATIONS

Siemens has identiﬁed the following speciﬁc workarounds and mitigations that customers can apply to
reduce the risk:

• As these vulnerabilities can only be exploited within Wi-Fi range, when possible reduce Wi-Fi
transmission power or make sure to have the devices in private areas with physical access controls

SSA-913875

© Siemens 2022

Page 10 of 14

Siemens Security Advisory by Siemens ProductCERT

• When possible, A-MSDU can be disabled to mitigate CVE-2020-24588 and CVE-2020-26144

Product speciﬁc remediations or mitigations can be found in the section Affected Products and Solution.

Please follow the General Security Recommendations.

GENERAL SECURITY RECOMMENDATIONS

As a general security measure, Siemens strongly recommends to protect network access to devices
with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens
recommends to conﬁgure the environment according to Siemens’ operational guidelines for Industrial
Security (Download: https://www.siemens.com/cert/operational-guidelines-industrial-security), and to
follow the recommendations in the product manuals.

Additional information on Industrial Security by Siemens can be found at: https://www.siemens.com/
industrialsecurity

PRODUCT DESCRIPTION

SCALANCE W-700 products are wireless communication devices based on IEEE 802.11 standards. They
are used to connect all to sorts of WLAN devices (Access Points or Clients, depending on the operating
mode) with a strong focus on industrial components, like Programmable Logic Controllers (PLCs) or
Human Machine Interfaces (HMIs) and others.

SCALANCE W-1700 products are wireless communication devices based on IEEE 802.11 standards.
They are used to connect all to sorts of WLAN devices (Access Points or Clients, depending on the
operating mode) with a strong focus on industrial components, like Programmable Logic Controllers
(PLCs) or Human Machine Interfaces (HMIs) and others.

The SCALANCE W1750D controller-based Direct Access Points support radio transmission according to
the latest IWLAN standard IEEE 802.11ac Wave 2.

VULNERABILITY CLASSIFICATION

The vulnerability classiﬁcation has been performed by using the CVSS scoring system in version 3.1
(CVSS v3.1) (https://www.ﬁrst.org/cvss/). The CVSS environmental score is speciﬁc to the customer’s
environment and will impact the overall CVSS score. The environmental score should therefore be
individually deﬁned by the customer to accomplish ﬁnal scoring.

An additional classiﬁcation has been performed using the CWE classiﬁcation, a community-developed list
of common software security weaknesses. This serves as a common language and as a baseline for
weakness identiﬁcation, mitigation, and prevention efforts. A detailed list of CWE classes can be found at:
https://cwe.mitre.org/.

Vulnerability CVE-2020-24588

The 802.11 standard that underpins Wi-Fi Protected Access (WPA, WPA2, and WPA3) and Wired
Equivalent Privacy (WEP) doesn’t require that the A-MSDU ﬂag in the plaintext QoS header ﬁeld is
authenticated. Against devices that support receiving non-SSP A-MSDU frames (which is mandatory
as part of 802.11n), an adversary can abuse this to inject arbitrary network packets.

CVSS v3.1 Base Score
CVSS Vector
CWE

3.5
CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C
CWE-306: Missing Authentication for Critical Function

SSA-913875

© Siemens 2022

Page 11 of 14

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2020-26139

An issue was discovered in the kernel in NetBSD 7.1. An Access Point (AP) forwards EAPOL frames
to other clients even though the sender has not yet successfully authenticated to the AP. This might
be abused in projected Wi-Fi networks to launch denial-of-service attacks against connected clients
and makes it easier to exploit other vulnerabilities in connected clients.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-287: Improper Authentication

Vulnerability CVE-2020-26140

An issue was discovered in the ALFA Windows 10 driver 6.1316.1209 for AWUS036H. The WEP, WPA,
WPA2, and WPA3 implementations accept plaintext frames in a protected Wi-Fi network. An adversary
can abuse this to inject arbitrary data frames independent of the network conﬁguration.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-74: Improper Neutralization of Special Elements in Output
Used by a Downstream Component (‘Injection’)

Vulnerability CVE-2020-26141

An issue was discovered in the ALFA Windows 10 driver 6.1316.1209 for AWUS036H. The Wi-Fi
implementation does not verify the Message Integrity Check (authenticity) of fragmented TKIP frames.
An adversary can abuse this to inject and possibly decrypt packets in WPA or WPA2 networks that
support the TKIP data-conﬁdentiality protocol.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-354: Improper Validation of Integrity Check Value

Vulnerability CVE-2020-26143

An issue was discovered in the ALFA Windows 10 driver 1030.36.604 for AWUS036ACH. The WEP,
WPA, WPA2, and WPA3 implementations accept fragmented plaintext frames in a protected Wi-Fi
network. An adversary can abuse this to inject arbitrary data frames independent of the network
conﬁguration.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2020-26144

An issue was discovered on Samsung Galaxy S3 i9305 4.4.4 devices. The WEP, WPA, WPA2, and
WPA3 implementations accept plaintext A-MSDU frames as long as the ﬁrst 8 bytes correspond to a
valid RFC1042 (i.e., LLC/SNAP) header for EAPOL. An adversary can abuse this to inject arbitrary
network packets independent of the network conﬁguration.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

SSA-913875

© Siemens 2022

Page 12 of 14

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2020-26145

An issue was discovered on Samsung Galaxy S3 i9305 4.4.4 devices. The WEP, WPA, WPA2,
and WPA3 implementations accept second (or subsequent) broadcast fragments even when sent
in plaintext and process them as full unfragmented frames. An adversary can abuse this to inject
arbitrary network packets independent of the network conﬁguration.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2020-26146

An issue was discovered on Samsung Galaxy S3 i9305 4.4.4 devices. The WPA, WPA2, and WPA3
implementations reassemble fragments with non-consecutive packet numbers. An adversary can
abuse this to exﬁltrate selected fragments. This vulnerability is exploitable when another device sends
fragmented frames and the WEP, CCMP, or GCMP data-conﬁdentiality protocol is used. Note that
WEP is vulnerable to this attack by design.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2020-26147

An issue was discovered in the Linux kernel 5.8.9. The WEP, WPA, WPA2, and WPA3 implementations
reassemble fragments even though some of them were sent in plaintext. This vulnerability can be
abused to inject packets and/or exﬁltrate selected fragments when another device sends fragmented
frames and the WEP, CCMP, or GCMP data-conﬁdentiality protocol is used.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.4
CVSS:3.1/AV:A/AC:H/PR:N/UI:R/S:U/C:L/I:H/A:N/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

ADDITIONAL INFORMATION

For more details regarding the FragAttacks vulnerabilities refer to:

- Fragment and Forge Breaking Wi-Fi Through Frame Aggregation and Fragmentation: https://papers.
mathyvanhoef.com/usenix2021.pdf

For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the
Siemens ProductCERT:

https://www.siemens.com/cert/advisories

HISTORY DATA

V1.0 (2021-07-13):
V1.1 (2021-10-12):
V1.2 (2022-02-08):

V1.3 (2022-04-12):

Publication Date
Added solution for SCALANCE W1750D
Added solution for SCALANCE W-700 IEEE 802.11ax family, updated name and
split into individual products the SCALANCE W-700 and SCALANCE W-1700
families and clariﬁed that no remediation is planned for SCALANCE W-700 IEEE
802.11n and SCALANCE W-1700 families
Added solution for the SCALANCE W-1700 (11ac) family

SSA-913875

© Siemens 2022

Page 13 of 14

Siemens Security Advisory by Siemens ProductCERT

TERMS OF USE

Siemens Security Advisories are subject to the terms and conditions contained in Siemens’ underlying
license terms or other applicable agreements previously agreed to with Siemens (hereinafter "License
Terms"). To the extent applicable to information, software or documentation made available in or through
a Siemens Security Advisory, the Terms of Use of Siemens’ Global Website (https://www.siemens.com/
terms_of_use, hereinafter "Terms of Use"), in particular Sections 8-10 of the Terms of Use, shall apply
additionally. In case of conﬂicts, the License Terms shall prevail over the Terms of Use.

SSA-913875

© Siemens 2022

Page 14 of 14



=== Content from papers.mathyvanhoef.com_b846d2a5_20250119_140753.html ===
Fragment and Forge: Breaking Wi-Fi Through
Frame Aggregation and Fragmentation

Mathy Vanhoef
New York University Abu Dhabi
mathy.vanhoef@nyu.edu

Abstract
In this paper, we present three design ﬂaws in the 802.11
standard that underpins Wi-Fi. One design ﬂaw is in the frame
aggregation functionality, and another two are in the frame
fragmentation functionality. These design ﬂaws enable an
adversary to forge encrypted frames in various ways, which in
turn enables exﬁltration of sensitive data. We also discovered
common implementation ﬂaws related to aggregation and
fragmentation, which further worsen the impact of our attacks.
Our results affect all protected Wi-Fi networks, ranging from
WEP all the way to WPA3, meaning the discovered ﬂaws
have been part of Wi-Fi since its release in 1997. In our
experiments, all devices were vulnerable to one or more of our
attacks, conﬁrming that all Wi-Fi devices are likely affected.
Finally, we present a tool to test whether devices are affected
by any of the vulnerabilities, and we discuss countermeasures
to prevent our attacks.

1 Introduction

In the last few years, major improvements have been made to
the security of Wi-Fi. Most notably this includes the discov-
ery and prevention of key reinstallation in WPA2 [18, 57, 58],
and the standardization of WPA3 which, among other things,
prevents ofﬂine dictionary attacks [60]. Additionally, extra
defenses have been standardized, such as operating channel
validation and beacon protection, which further increases the
security of Wi-Fi networks [54, 55]. These recent improve-
ments are a welcome addition to Wi-Fi since it continues to be
one of the main methods used to access the Internet. Addition-
ally, Wi-Fi is used in home networks to prevent outsiders from
accessing personal printers, security cameras, smart home
devices, and so on. In enterprise networks, Wi-Fi plays an
equally important role since it authenticates users, it protects
access to internal services, and it secures content while being
transmitted to, for instance, local ﬁle servers, smart presenta-
tion screens in meeting rooms, and so on.

Despite the recent advances in Wi-Fi security, we found
design issues that went unnoticed for more than two decades.

These issues were discovered by analyzing open source Wi-Fi
stacks and systematically inspecting the 802.11 standard. Our
results affect all protected Wi-Fi networks, including old net-
works using Wired Equivalent Privacy (WEP), up to and in-
cluding the latest Wi-Fi Protected Access 3 (WPA3). Since
even WEP is affected, this implies the root cause of several
design ﬂaws has been part of Wi-Fi since its release in 1997.
Equally worrisome is that every single device we tested was
vulnerable to at least one of our attacks.

The most trivial design ﬂaw is in 802.11’s frame aggrega-
tion functionality: by ﬂipping an unauthenticated ﬂag in the
header of a frame, the encrypted payload will be parsed as
containing one or more aggregated frames instead of a nor-
mal network packet. We abuse this to inject arbitrary frames,
and then intercept a victim’s trafﬁc by making it use a mali-
cious DNS server. Practically all devices that we tested were
vulnerable to this attack.

Another two design ﬂaws are in 802.11’s frame fragmenta-
tion feature which splits large frames into smaller fragments.
First, although all fragments of a frame are always encrypted
under the same key, receivers are not required to check that
this is indeed the case. We show that an adversary can abuse
this missing check to forge frames and exﬁltrate data by mix-
ing fragments encrypted under different keys. Second, a re-
ceiver is not required to remove (incomplete) fragments from
memory when connecting to a different network. We abuse
this to inject malicious fragments into the fragment cache, i. e.,
memory, of the victim and thereby inject arbitrary packets.
Most devices were affected by at least one of these attacks.

Apart from design ﬂaws we also discovered widespread
implementation vulnerabilities related to frame aggregation
and fragmentation. These vulnerabilities can either be ex-
ploited on their own or make it signiﬁcantly easier to abuse
the discovered design issues. The most common implementa-
tion vulnerability is that receivers do not check whether all
fragments belong to the same frame, meaning an adversary
can trivially forge frames by mixing the fragments of two
different frames. Against certain implementations it is also
possible to mix encrypted and plaintext fragments, to inject

1

plaintext aggregated frames by masquerading them as hand-
shake messages, and to inject plaintext fragmented (broadcast)
frames. Several other implementation ﬂaws have also been
discovered, and we created a tool to test for all of them [1].
We believe that the discovered design ﬂaws went unnoticed
for so long for two main reasons. First, some of the func-
tionality that we abuse is generally not considered as part of
the core cryptographic functionality of Wi-Fi and therefore
has received no rigorous or formal analysis. Second, patched
drivers or ﬁrmware are needed to conﬁrm the fragmentation-
based vulnerabilities in practice. When using normal drivers,
certain ﬁelds of injected frames may be overwritten without
the programmer realizing this. This causes attacks to fail, and
as a result researchers may mistakenly conclude that devices
are secure, while in reality they are vulnerable.

Because our ﬁndings affect all Wi-Fi devices, we contacted
the Industry Consortium for Advancement of Security on
the Internet (ICASI) to help with a multi-party coordinated
disclosure. We are also collaborating with the Wi-Fi Alliance
to distribute information to vendors.

To summarize, our main contributions are:

• We present a design ﬂaw in 802.11’s frame aggregation
functionality that can be abused to inject arbitrary frames
and demonstrate resulting attacks in practice (Section 3).
• We present a design ﬂaw in 802.11’s frame fragmen-
tation feature where a receiver accepts fragments en-
crypted under different keys. We show how this can be
abused to forge frames and exﬁltrate data (Section 4).
• We present another design ﬂaw where we poison the
fragment cache of a receiver and abuse this to inject
packets and exﬁltrate data (Section 5).

• We discover widespread implementation ﬂaws and cre-
ated a tool to test for all vulnerabilities in this paper [1].
Our tool can test both clients and Access Points (APs)
and covers more than 45 test cases (Section 6).

Finally, we discuss related work, all our countermeasures, and
our results in Section 7, and we conclude in Section 8.

2 Background

This section introduces the 802.11 standard [31] and gives a
high-level description of the design ﬂaws that we discovered.

2.1 Frame layout and packet aggregation

Figure 1 shows the layout of an 802.11 frame and we start
with explaining its general-purpose ﬁelds. First, the Frame
Control (FC) ﬁeld contains several ﬂags and deﬁnes the type
of a frame, e. g., whether it is a data or management frame.
This is followed by three MAC addresses deﬁning the receiver,
sender, and the destination or source of the frame. The Quality
of Service (QoS) ﬁeld deﬁnes the priority of the frame, which
is called the Trafﬁc Identiﬁer (TID) in 802.11. The payload

FC Addr1/2/3 Frag. No.

Seq. No. QoS PN payload

Type ... More Frag. Protected

TID A-MSDU ﬂag

Figure 1: Layout of an encrypted 802.11 frame. Our aggre-
gation attack abuses the ﬁeld in blue, and our fragmentation
attacks the ﬁelds in red. Only the payload ﬁeld is encrypted.

Normal:

LLC/SNAP

IP header

TCP header

Data

A-MSDU: Destination Source Length

packet1

. . .

This subframe is repeated for every packet

Figure 2: Contents of the payload ﬁeld in a normal frame with
an example TCP/IP header (top), and the contents of a frame
with the A-MSDU ﬂag set meaning it contains one or more
aggregated packets (bottom).

ﬁeld of a normal frame contains the transported packet, which
starts with an LLC/SNAP header—sometimes also called an
rfc1042 header [44]—that deﬁnes the type of the packet, e. g.,
whether it is an IP or ARP packet (see Figure 2).

When the packet is small it is more efﬁcient to aggregate
multiple packets into one larger frame. The 802.11n amend-
ment deﬁnes two aggregation methods [33], and we focus on
Aggregate MAC Service Data Units (A-MSDUs), which all
802.11n-capable devices are required to support. The layout
of an A-MSDU frame is similar to a normal frame as shown
in Figure 1, except that the A-MSDU ﬂag in the QoS ﬁeld is
set, and that the payload ﬁeld contains one or more A-MSDU
subframes as shown in Figure 2. Each subframe starts with
the equivalent of an 802.3 header: the destination and source
MAC address of the packet, followed by the length of the
packet. Note that the packet itself starts with an LLC/SNAP
header, just like in a normal frame. Finally, each subframe
except the last is padded so that its length is a multiple of 4.
When a receiver sees that the A-MSDU ﬂag is set in the
QoS ﬁeld, it will extract all A-MSDU subframes and convert
them into Ethernet frames with the destination and source
addresses speciﬁed in the subframe. The problem is that, al-
though the QoS ﬁeld is authenticated, by default the A-MSDU
ﬂag is masked to zero, meaning this ﬂag is not actually authen-
ticated. As a result, an adversary can intercept a normal frame,
set the A-MSDU ﬂag, and the receiver will now incorrectly
interpret the payload as containing A-MSDU subframes. In
Section 3 we show how to abuse this to inject arbitrary frames.

2.2 Frame fragmentation

In noisy environments it can be more efﬁcient to split large
frames into smaller fragments, so that if a fragment gets cor-
rupted, only that fragment has to be retransmitted. The layout
of a fragment, also called a MAC Protocol Data Unit (MPDU),

2

is identical to a normal frame and illustrated in Figure 1. Be-
cause of their similarity, we use the term frame to refer to both
a normal frame and an MPDU, while the term fragment will
be used to explicitly refer to an MPDU. When a frame is split
into multiple fragments, each one is assigned an incremental
4-bit fragment number (Frag. No. in Figure 1). This means
a frame can be split into at most 24 fragments. To allow a
receiver to determine when all fragments have been received,
every fragment except the last has the more fragments ﬂag set
in its frame control ﬁeld. Finally, all fragments of a speciﬁc
frame have the same 12-bit sequence number (Seq. No. in Fig-
ure 1). Only unicast data frames are (de)fragmented, and such
frames can be recognized by the type subﬁeld in the frame
control ﬁeld and by the receiver MAC address (Addr1). In
this paper, we use the notation Fragx(s) to denote a fragment
with fragment number x and sequence number s. For instance,
Frag1(9) denotes a 2nd fragment with sequence number 9.

By default, a frame is only split into fragments when it is
larger than the conﬁgured fragmentation threshold. This frag-
mentation threshold is independent of the maximum packet
size, i. e., the Maximum Transmission Unit (MTU). When
a device supports dynamic fragmentation, which is part of
802.11ax, a transmitter can split a frame into fragments in-
dependent of the fragmentation threshold [30]. In particular,
when a client is assigned a ﬁxed-duration transmit opportu-
nity, called a resource unit in 802.11ax, it can ﬁll the last part
of this duration with a fragmented frame.

2.3 Authentication and encryption

In both protected home and enterprise Wi-Fi networks, the
client will eventually use the 4-way handshake to negotiate a
pairwise session key with the AP. This session key is used to
encrypt data frames. At any point in time, the AP can start a
new 4-way handshake to renew the session key.

When the (AES-)CCMP or GCMP data-conﬁdentiality pro-
tocol is used, frames larger than the fragmentation threshold
are ﬁrst split into fragments, and all fragments are then en-
crypted in the same way as normal frames: the payload ﬁeld is
authenticated and encrypted, and selected metadata is also au-
thenticated. This metadata encompasses, among other things,
all MAC addresses in the header, the fragment number, and
the more fragments ﬂags. The sequence number is not authen-
ticated because its value is only known immediately before
the station is able to transmit [39]. Note that encrypted frames
can be recognized by the protected ﬂag in the FC ﬁeld. Every
encrypted frame also has a strictly increasing Packet Num-
ber (PN), commonly called a nonce, which is used to prevent
replay attacks, and is implicitly authenticated by the data-con-
ﬁdentiality protocol. We use the notation Encn
k{ f } to denote
the encryption of frame f using key k and packet number n.
A receiver ﬁrst checks if the PN is increasing and otherwise
drops the fragment (or frame). Then it decrypts the fragment
and stores it until all fragments are received [31, Fig. 5-1].

On reception of the last fragment, all decrypted fragments
are reassembled into the original frame. Since the fragment
number and more fragments ﬂag are authenticated, an adver-
sary cannot change the number of fragments or their relative
position. Additionally, to prevent an adversary from forging a
frame by combining fragments of different frames, a receiver
must drop all fragments if their PNs are not consecutive.

The older, but not deprecated [48], WPA-TKIP data-conﬁ-
dentiality protocol does not authenticate the fragment number
and more fragments ﬂag, and does not check that the PNs
of the fragments are consecutive. Instead, the reassembled
frame is authenticated using the Michael algorithm. When
using the broken and deprecated WEP protocol, the fragment
number and more fragments ﬂag are not authenticated, and
the reassembled frame is not separately authenticated. This re-
sults in a novel attack against WEP where an attacker can mix
and reorder fragments of different frames (see Section 4.5).

2.4 Attack techniques and scenarios

Although exploiting each discovered design ﬂaw requires a
different threat model, which is described at the start of every
section, there are similarities between most threat models. In
particular, several attacks rely on a multi-channel machine-
in-the-middle (MitM) position, some also rely on a relaxed
BEAST threat model, and one attack targets hotspot-type
networks. We therefore introduce these concepts ﬁrst:

Multi-Channel MitM Many (known) attacks require the
ability to block, modify, or delay encrypted frames sent be-
tween the client and AP. To reliably do this, Vanhoef and
Piessens introduced the multi-channel MitM position [56]. In
this MitM technique, the adversary clones the real AP on a dif-
ferent channel, forces the client into connecting to the rogue
AP on the cloned channel, and forwards frames between the
client and the real AP. The adversary can then modify frames
before forwarding them or not forward them at all. Recently
a defense against this MitM has been ratiﬁed into the draft
802.11 standard, called operating channel validation [55], but
it is not yet used in practice. As a result, the multi-channel
MitM position can be reliably established in practice: the
only requirement is that the adversary possesses two Wi-Fi
antennas and is within radio range of the client and AP.

BEAST threat model The BEAST attack against TLS
introduced a novel threat model where the victim is tricked
into executing malicious JavaScript code [20]. This can for
example be accomplished by social engineering the victim
into visiting a website under control of the adversary, and
enables the adversary to make the victim send a large amount
of trafﬁc. Other attacks against TLS also relied on this threat
model [3, 5, 12, 20, 22, 42, 46, 47], and we call it the BEAST
threat model. In a relaxed version of this threat model, we only
require that the victim connects to a server of the adversary
without requiring the execution of malicious JavaScript code.

3

Hotspot security Hotspots used to be synonymous with
open and insecure Wi-Fi networks. However, this is no longer
the case. In modern hotspot-type networks such as eduroam,
and Hotspot 2.0 networks where users can, e. g., authenticate
using their mobile SIM card [6], each user owns unique au-
thentication keys and as a result their encryption keys also stay
secret. To prevent users from attacking each other, hotspots
commonly use downstream group-addressed forwarding and
client isolation. With the former feature, each client is given
a random group key [6, §5.2], preventing attacks that abuse
the otherwise shared group key [2]. The latter feature, client
isolation, prevents users from communicating with each other,
which most notably blocks ARP-based MitM attacks.

3 Abusing Frame Aggregation

In this section, we present a design ﬂaw in 802.11’s frame
aggregation functionality that allows an adversary to inject
arbitrary packets by making a victim process normal Wi-Fi
frames as aggregated ones. We abuse this to perform a port
scan and to trick a victim into using a malicious DNS server.
This design ﬂaw has been assigned CVE-2020-24588.

3.1 Threat model

The attack works against all current data-conﬁdentiality proto-
cols of Wi-Fi, namely WEP, TKIP, CCMP, and GCMP, mean-
ing all protected Wi-Fi networks are affected. The adversary
must be within radio range of the victim such that a multi-
channel MitM can be obtained, and the victim must support
the reception of A-MSDU frames, which is a mandatory part
of 802.11n [33]. Additionally, the adversary must be able to
send IPv4 packets to the victim with some control over the
payload and with a predictable IP identiﬁcation (ID) ﬁeld. In
Section 6.3, 6.5, and 6.6 we abuse implementation ﬂaws to
perform the attack under alternative assumptions. This section
focuses on a general attack technique, where an adversary can
send such IPv4 packets to a client or AP as follows:

Attacking clients

If the IP address of the client is known,
and no ﬁrewall is blocking incoming packets, we can directly
send IPv4 packets to the victim. Otherwise, we assume that
the adversary is able to make the victim connect to a server
under the adversary’s control, allowing the adversary to inject
IPv4 packets over this connection. A wide-scale method to ac-
complish this is to register a misspelled domain name [43], or
to exploit third-party advertisements in popular websites [27].
A relaxed BEAST threat model can also be used, where the
victim is social engineered into visiting the attacker’s website.

Attacking APs To attack APs, the IP ID ﬁeld of at least
one connected client must be predictable. This can be the case
for older clients [37], and on some devices this ﬁeld always
equals zero [53]. We also rely on the BEAST threat model to
make this client send IPv4 packets with a given payload.

LLC

SNAP

IP hdr Len

ID

IP payload

AA AA 03 00 00 00 08 00 45 00 01 0C 00 22 · · · XX · · · XX

Destination

Source

Length

Subframe 2

Figure 3: Parsing an 802.11 payload containing an IPv4
packet (top) as an A-MSDU frame (bottom). Green under-
lined bytes can be controlled by the adversary, yellow ones
can be partially controlled, and red bytes have a ﬁxed value.

3.2

Injecting frames by spooﬁng A-MSDUs

By default the A-MSDU ﬂag, which informs a receiver how
to parse the encrypted payload of a frame, is not authenti-
cated (recall Section 2.1). Only when the sender and receiver
support Signaling and Payload Protected (SPP) A-MSDUs
is the A-MSDU ﬂag authenticated [33, §11.17]. However,
none of the devices we tested support this feature, meaning
in practice the A-MSDU ﬂag is never authenticated. This
is problematic because nearly all devices we tested do sup-
port receiving A-MSDUs, meaning they can be tricked into
processing normal frames as A-MSDUs, and vice versa.

We can exploit this design ﬂaw by manipulating a normal
802.11 frame such that, when it is processed as an A-MSDU
frame, one of the subframes will correspond to a packet that
we want to inject. This requires the frame’s payload to contain
a specially crafted packet, for instance, the IPv4 packet illus-
trated in Figure 3. Notice that this IPv4 packet is prepended
with an 8-byte LLC/SNAP header when encapsulated in an
802.11 frame (recall Section 2.1). When targeting a client in
our threat model, the adversary can control the IP ID ﬁeld
and the payload that follows the IPv4 header. When these
bytes are interpreted as A-MSDU subframes, the length ﬁeld
of the ﬁrst subframe corresponds to the IP ID ﬁeld (see Fig-
ure 3). This means the attacker can set the 2-byte IP ID ﬁeld
to, e. g., 34, meaning the next A-MSDU subframe starts after
the TCP or UDP header of the injected frame. This leaves
space to include a valid TCP or UDP header in the malicious
IPv4 packet, increasing the chance that the packet is correctly
routed to the victim. Finally, we remark that the IP ID ﬁeld is
not changed by NAT devices or other middleboxes [37], and
therefore such devices will not interfere with our attack.

To change the IPv4 packet into an A-MSDU frame, the ad-
versary establishes a multi-channel MitM between the client
and AP (recall Section 2.4). The encrypted 802.11 frame
containing the IPv4 packet is detected based on its length
and QoS priority. The adversary sets the A-MSDU ﬂag in
the unauthenticated QoS ﬁeld, causing the client to treat the
frame’s payload as A-MSDU subframes. The ﬁrst subframe
will have an unknown sender and destination MAC address
and will be ignored. The second subframe will contain the
packet that the adversary wants to inject, and the client will
parse and process this injected packet.

We can attack APs in a similar way if at least one client uses

4

predictable IP IDs, which is the case for certain older Operat-
ing Systems (OSs) [37, 49]. By relying on the BEAST threat
model, we make this client perform a POST request contain-
ing attacker-controlled binary data. This essentially causes the
transmission of IP packets with a partially attacker-controlled
payload. If the ID ﬁeld of this IPv4 packet is correctly pre-
dicted, the second A-MSDU subframe will correspond to
attacker-controlled data. As a result, the attacker can inject
arbitrary packets. The AP will forward this packet to its next
destination, which is the gateway or any client in the network.
Finally, if a client always uses an IP ID value of zero, it is
possible to use the injection technique in Appendix C.

3.3 Practical impact

The impact of injecting arbitrary packets depends on the ser-
vices running on the victim, whether it is regularly updated,
and so on. As a general example, we performed the following
two attacks against an IPv6 or IPv4 capable victim:

Portscan We performed a portscan against IPv4 and IPv6
hosts to demonstrate the injection of a large number of packets.
Open ports were detected based on the length of the encrypted
TCP SYN/ACK replies.

Malicious DNS server Against dual-stack IPv4/6 clients,
we can inject ICMPv6 router advertisements to trick the vic-
tim into using a DNS server under our control. More precisely,
we abuse IPv6 stateless address autoconﬁguration by inject-
ing an ICMPv6 router advertisement that includes a malicious
DNS server [34]. Against Linux, Windows 10, Android 8.1,
iOS 13.4.1, and macOS 10.15.4, we conﬁrmed that this suc-
cessfully poisoned the DNS server(s) used by the OS. Once
the victim is using the malicious DNS server, the adversary
can redirect all trafﬁc to their malicious server, effectively
intercepting all IP-based trafﬁc of the client. Note that the ma-
licious DNS server will be hosted on an IPv6 address, but can
still respond to DNS requests with IPv4 addresses if needed.
Against IPv4-only clients, a similar attack is possible if
we can obtain the 4-byte transaction identiﬁer that the client
includes in its DHCP discover and requests. This identiﬁer
is normally unpredictable [19]. However, we found that iOS
and macOS randomly generate an identiﬁer on boot, but then
increment it for each DHCP message. Similarly, Halvorsen
et al. found that Mac OS X used predictable identiﬁers [24].
Moreover, certain IoT devices such as our Xiaomi security
camera randomly generate a transaction identiﬁer on boot and
reuse this value in all DHCP messages. This means that if one
transaction identiﬁer can be leaked or brute-forced, it becomes
possible to spoof DHCPv4 messages and force the client into
using a malicious DNS server. Finally, our ESP-12F always
uses the same identiﬁer, even after reboots, meaning we can
trivially make it use a malicious DNS server if we can inject
packets towards it.

3.4 Applicability to short A-MSDUs

In Directional Multi-Gigabit (DMG) networks, deﬁned by
amendment 802.11ad, stations can also send short A-MSDUs
where each subframe only consists of a length ﬁeld and the
transported data. Short A-MSDUs can only be encapsulated
inside DMG frames because only these frames deﬁne the short
A-MSDU ﬂag in the QoS ﬁeld [31, §9.2.4.5]. This ﬂag is al-
ways authenticated in DMG networks [31, §12.5.3.3.3]. Since
DMG frames should only be sent in DMG networks, the short
A-MSDU ﬂag is always authenticated, and hence cannot be
manipulated by an attacker. Nevertheless, we recommend that
the standard more explicitly requires that the short A-MSDU
ﬂag should only be used when it is authenticated.

An implementation risk is that the hardware supports and
authenticates the short A-MSDU ﬂag, but that the software-
based network stack does not support short A-MSDUs. In that
case, short A-MSDUs may be treated as normal A-MSDUs.
Unfortunately, few devices currently support 802.11ad, mean-
ing we were unable to check whether any devices were af-
fected by such implementation-speciﬁc issues.

3.5 Spooﬁng A-MSDUs as normal frames

We can also trick a victim into processing A-MSDU frames as
normal frames. This causes the destination MAC address of
the ﬁrst A-MSDU subframe to be processed as the start of an
LLC/SNAP header. This means that the resulting LLC/SNAP
header is only valid when the target has the (locally admin-
istered) MAC address AA:AA:03:00:00:00. Because of this
limitation, it is unlikely that this can be abused in practice.

3.6 Experiments

All major operating systems are vulnerable to our attack, in-
cluding Windows, Linux, Android, macOS, and iOS. See Sec-
tion 6.1 for a detailed overview of the devices we tested. All
APs we tested were also vulnerable, including home routers
and professional APs. The only exception is NetBSD and
OpenBSD: they do not support the reception of A-MSDUs
and therefore are unaffected by the attack.

We tested end-to-end attacks against several clients. During
these tests, we used two TL-WN722N dongles for the multi-
channel MitM, and we reliably obtained this MitM position by
spooﬁng channel switch announcements [55]. We detected the
injected IPv4 packet based on its length, set the A-MSDU ﬂag
before forwarding it to the victim, and successfully injected
router advertisements to poison the victim’s DNS server.

When testing the attack against FreeBSD and Linux 4.9
and above, we noticed that we were unable to inject packets
as described in Section 3.2. Upon closer inspection we found
that these operating systems strip away the ﬁrst 8 bytes of an
A-MSDU frame if these bytes look like a valid LLC/SNAP
header, and then further process the frame. This behavior is

5

not compliant with the 802.11 standard. When the ﬁrst 8 bytes
are stripped, the length ﬁeld of the ﬁrst A-MSDU subframe
corresponds with the ﬁrst two bytes of the source IP address.
If the victim is not behind a ﬁrewall, we can spoof the source
address of our IPv4 packets such that the injected packet will
again be contained in the second A-MSDU subframe. If the
victim blocks spoofed IP addresses, we can rent a server on
Amazon AWS with an IP address in the subnet 3.5.0.0/16 [7].
The ﬁrst A-MSDU subframe then has a length of 773 bytes,
which leaves sufﬁcient space to inject malicious packets.

3.7 Discussion

To prevent aggregation attacks, stations must either not use
A-MSDUs, or always authenticate the A-MSDU ﬂag, i. e.,
only use SPP A-MSDUs. We elaborate on this in Section 7.2.
We conjecture that turning normal frames into A-MSDUs
can also be abused as an oracle to leak data. For instance, an
AP may act differently depending on the values that are lo-
cated at the A-MSDU header ﬁelds. We leave a more detailed
analysis on abusing A-MSDUs to leak data as future work.

4 Mixed Key Attack against Fragmentation

In this section, we ﬁrst discuss the shared root cause of the two
fragmentation-based design ﬂaws that we discovered. We then
focus on the ﬁrst design ﬂaw, namely how the 802.11 standard
allows an attacker to forge frames by mixing fragments that
are encrypted under different keys. This design ﬂaw has been
assigned CVE-2020-24587. We show how to abuse this ﬂaw
to exﬁltrate client data and, for instance, recover sensitive info
sent over plaintext HTTP connections.

4.1 Fragmentation design ﬂaws

At a high level, the discovered fragmentation ﬂaws are caused
by not properly separating different security contexts and their
associated memory, receive queues, or fragment caches:

Mixed key attack A ﬁrst problem is that the 802.11 stan-
dard does not require that each fragment was decrypted using
the same key. Therefore, an attacker can forge frames by mix-
ing fragments of frames that were encrypted under different
keys, i. e., by mixing fragments belonging to different secu-
rity contexts. This design ﬂaw will be further discussed and
abused in this section.

Fragment cache poisoning The 802.11 standard also
does not state when decrypted fragments should be removed
from memory, i. e., from the fragment cache. That is, de-
crypted fragments are not dropped when the security context
changes due to a (re)connect or (re)association. An attacker
can abuse this to inject fragments into a victim’s fragment
cache, and then combine this with legitimate fragments to in-
ject packets or exﬁltrate decrypted fragments (see Section 5).

6

4.2 Threat model

We ﬁrst focus on the mixed key attack, which works against
WEP, CCMP, and GCMP. The older TKIP protocol is only
affected when the receiver forgets to verify the authenticity
of reassembled frames (see Section 6.7).

The attack requires that one or more devices in the network
send fragmented frames. Although not all devices do this by
default, because their conﬁgured fragmentation threshold is
equal to or bigger than the MTU, it is recommended to use
fragmentation in noisy environments. Moreover, 802.11ax de-
vices are expected to support dynamic fragmentation, making
the usage of fragmentation more common in practice (recall
Section 2.2). For instance, our Cisco Catalyst 9130 has dy-
namic fragmentation enabled by default, and Aruba APs also
support it. With this in mind, our fragmentation-based attacks
are especially relevant against new devices.

To perform the attack, the network must also periodically
refresh the session key of connected devices, and we must be
able to trick the victim into sending a packet to an attacker-
controlled server. Although most networks by default do not
periodically refresh the session key, we do remark that this
assumption matches the requirement of certain key reinstalla-
tion attacks against WPA2 [57, §3.4]. To trick the victim into
sending a packet to a server under our control, we can rely on
the relaxed BEAST threat model. In Section 5 and 6.2, we ex-
ploit additional design and implementation ﬂaws to perform
mixed key attacks without these assumptions.

4.3 Exﬁltrating sensitive data

The adversary’s goal is to forge a packet by mixing fragments
of frames that were encrypted under different keys. These
fragments must have consecutive packet numbers since the
receiver will otherwise discard the fragments. Although many
implementations do not check whether fragments use con-
secutive packet numbers (see Section 6.2), our attack does
assume the victim checks this, and thereby illustrates that
even implementations that fully comply with the standard are
vulnerable.

Mixing fragments Figure 4 illustrates our attack, where
we exploit a vulnerable AP to exﬁltrate data sent by the client.
The attack starts with the generation of a packet towards the
adversary’s server (stage 1(cid:13)). This attacker-destined packet
can, for instance, be generated by social engineering the vic-
tim into loading an innocent resource on the adversary’s
server. By hosting this resource on a long URL, the resulting
packet will be large enough such that it is split in two frag-
ments before transmission. These two encrypted fragments
are represented by Encn
{Frag1(s)}.
The attacker then relies on a multi-channel MitM position
to intercept all fragmented frames, and detects the attacker-
destined packet based on its unique length. Note that the
adversary must ﬁrst collect all fragments of a frame before it

k{Frag0(s)} and Encn+1

k

Client

Attacker

AP (vulnerable)

Header

Payload

1(cid:13)

e
g
a
t
S

2(cid:13)

e
g
a
t
S

Visit attacker’s website
k{ Frag0(s) }
{ Frag1(s) }

Encn
Encn+1
k

Detect packet to
attacker’s server
Encn

k{ Frag0(s) }

Decrypt & store fragment

normal trafﬁc & 4-way handshake rekey

Send sensitive data

Encn
Encn+1
(cid:96)

(cid:96) { Frag0(s(cid:48)) }
{ Frag1(s(cid:48)) }

Detect packet with
sensitive data
Encn+1
(cid:96)

{ Frag1(s) }

Reassemble frame

Packet with sensitive
data is sent to attacker

Figure 4: Mixed key attack against fragmentation. The ﬁrst
fragment is the start of an IP packet to the attacker’s server,
which is appended in stage 2(cid:13) with user data. The reassembled
packet is sent to the attacker’s server, exﬁltrating the user data.

can determine the length of the full frame. Once the attacker-
destined packet is detected, the adversary only forwards the
ﬁrst fragment to the AP. The AP will then decrypt this frag-
ment and will store the decrypted fragment in its memory.

Between stages 1(cid:13) and 2(cid:13) of the attack, the adversary for-
wards all frames between the client and the AP. To prevent
these frames from interfering with the attack, the sequence
number s is never used when forwarding a frame to the AP.
This assures that the ﬁrst fragment of the attacker-destined
packet is not removed from the AP’s memory. Any other for-
warded fragments also will not interfere with the attack, since
the standard requires that a device must support the concur-
rent reception of at least 3 fragmented frames [31, §10.6].
Before stage 2(cid:13) starts, the client and AP must update, i. e.,
rekey, the pairwise session key from k to (cid:96) using the 4-way
handshake. Note that the adversary can predict when rekeys
occur because they happen at regular intervals, and rekeys
can be detected because they cause the packet numbers of the
data-conﬁdentiality protocol to restart from zero.

Stage 2(cid:13) of the attack starts when the client sends a frag-
ment containing sensitive information. This second fragment
must have a packet number equal to n + 1, and otherwise the
attacker has to wait until another 4-way handshake is exe-
cuted so packet numbers start from zero again. The adversary
assigns sequence number s to the second fragment, which is
possible because this ﬁeld is not authenticated, and forwards
the resulting fragment Encn+1
{Frag1(s)} to the AP (stage 2(cid:13)
in Figure 4). Upon reception of the second fragment, the AP

(cid:96)

7

192.168.1.2 to 3.5.1.1

GET /image.png HTTP/1.1

192.168.1.2 to 39.15.69.7

POST /login.php HTTP/1.1
user=admin&pass=SeCr3t

Mixed key attack against fragmentation

192.168.1.2 to 3.5.1.1

POST /login.php HTTP/1.1
user=admin&pass=SeCr3t

Figure 5: Mixing fragments of two packets to exﬁltrate user
data to an attacker-controlled server. The red packet is sent to
the attacker’s server, and the green packet contains user data.

combines both decrypted fragments to reassemble the packet.
This packet is now a combination of the attacker-destined
packet and a packet that contains sensitive user data.

Against devices that only accept fragments with consecu-
tive packet numbers, the second fragment must have packet
number n + 1. To increase the chance that this is the case, an
adversary can rely on the BEAST threat model to make the
client send background trafﬁc using malicious JavaScript.

Packet construction In our attack, we mix a fragment
of an attacker-destined IP packet with a fragment of a packet
containing user data. This process is illustrated in Figure 5.
The IP checksum of the forged packet is correct since it is
only calculated over the IP header. The TCP checksum will
be incorrect, but this has no impact on the attack: intermediate
hops will still forward the packet to its ﬁnal destination since
they only verify the IP checksum. And since the attacker con-
trols the ﬁnal destination, they can simply ignore the incorrect
TCP checksum. Finally, the attacker-destined packet must
not be larger than the targeted packet with sensitive user data.
Otherwise, the IP length ﬁeld will be larger than the actual
payload of the reassembled packet, causing the AP to drop
the packet. If the IP length ﬁeld is smaller than the payload,
only the trailing data is discarded.

The data that can be exﬁltrated depends on the conﬁgura-
tion of the network and the victim. When a fragmentation
threshold of 512 bytes is used, which is for example rec-
ommended by Arch Linux [8], data beyond this position is
located in the second fragment meaning it can be exﬁltrated.
Therefore we can exﬁltrate HTTP cookies, POST data, basic
auth credentials, etc. Additionally, with the BEAST threat
model, malicious JavaScript can let the client perform cross-
origin requests with extra parameters in the URL that push the
cookie towards the second fragment. This is similar to now-
standard methods used in attacks against TLS [4, 20, 22, 42].

4.4 Attack variations

Vulnerable clients Against clients we can perform a sim-
ilar attack to forge packets. However, the TCP or UDP check-
sum of the forged packet only has a 2−16 chance of being

correct, meaning the packet will likely be dropped. Neverthe-
less, attacks remain possible against multimedia streaming
protocols that run over UDP-Lite. This is because the check-
sum in UDP-Lite is only over a portion of a packet, so certain
data can be changed without invalidating the checksum [35].
More general mixed key attacks against clients are possible
when combined with fragment cache attacks (see Section 5).

Multiple key support The 802.11 standard contains an
optional feature where the sender can pick between two keys
to encrypt unicast frames [31, §12.6.21]. This is useful to
facilitate the switchover to a new session key, and is made
possible by including a key ID in a frame’s header that iden-
tiﬁes the used key. When this feature is used, two fragments
that are encrypted under different keys can be forwarded to
the target immediately after one another. This makes attacks
easier in case the target removes fragments from memory
after a certain timeout, or if any frames sent in-between the
fragments interfere with their reassembly on the target.

4.5 Applicability to WEP and TKIP

When using WEP with dynamic rekeying, it is also possible to
mix fragments that are encrypted under different keys. We em-
pirically conﬁrmed this against Linux, which shows that the
discovered design ﬂaw has been part of Wi-Fi since its release
in 1997. Moreover, because WEP does not require that frag-
ments have consecutive packet numbers, i. e., initialization
vectors, an adversary can even mix fragments of two frames
that are encrypted under the same key (see also Section 6.2).
The TKIP protocol is unaffected because, unlike CCMP
and GCMP, its authenticity check covers the full frame instead
of the individual fragments. However, some devices do not
perform this authenticity check, meaning mixed key attacks
can still be possible against TKIP in practice (see Section 6.7).

4.6 Experiments

To perform our attack, we have to inject frames with speciﬁc
fragment and sequence numbers. However, wireless network
cards may overwrite these ﬁelds. Additionally, network cards
may reorder frames with a different QoS priority, which can
also interfere with our attack. To overcome these problems,
we patched the driver of Intel cards, and we patched the driver
and ﬁrmware of Atheros cards (see Appendix A).

In our tests, all major operating systems are vulnerable,
including Windows, Linux, Android, macOS, and iOS. Sec-
tion 6.1 contains an overview of all tested devices. A low
number of devices are unaffected because they require that
all fragments are received immediately after one another, and
any frames sent in-between interfere with their reassembly,
preventing a default mixed key attack. This is, for example,
the case against NetBSD, FreeBSD, and against a few network
cards on Windows and Linux. We remark that this behavior
is not compliant with the standard. Additionally, we found a

method to still perform mixed key attacks against FreeBSD.
This technique relies on non-trivial conditions and is further
discussed in Appendix E. Finally, OpenBSD is not affected
because it does not support fragmentation.

All four home routers that we tested were affected, though
only one of our three professional APs was affected. Against
our Aruba AP-305, any frame sent in-between fragments in-
terferes with their reassembly. Our Cisco Catalyst 9130 did
not support renewing the pairwise session key, meaning a
default mixed key attack is not possible.

To keep experiments more reproducible, we performed end-
to-end attacks against Linux using virtual Wi-Fi interfaces.
In particular, we implemented and successfully performed
an attack against a vulnerable AP to exﬁltrate (decrypted)
fragments sent by the client.

Against Linux, the attack is more tedious because it clears
fragments from memory after two seconds. This can be over-
come in the BEAST threat model, where malicious JavaScript
on the client can trigger the transmission of an attacker-des-
tined packet before the 4-way handshake completes. After
this, trafﬁc can be generated such that a packet with sensitive
data is sent with a high enough packet number within two
seconds, which can then be exﬁltrated. We successfully tested
this method against Linux 4.9.

4.7 Discussion

To prevent mixed key attacks, a receiver should verify that all
fragments were encrypted under the same key. We elaborate
on this in Section 7.2.

Our attacks assumed that the network periodically refreshes
the pairwise session key. In our experience this is not done
by default by most routers and APs. However, this does not
limit attacks in practice because nearly all implementations
accept non-consecutive packet numbers, meaning our attacks
are possible without relying on rekeys (see Section 6.2).

A limitation of our attack is that it can only be used when
one or more devices send fragmented frames. However, we
conjecture that dynamic fragmentation can be abused to in-
duce the transmission of fragmented frames. With dynamic
fragmentation, a transmitter will send fragmented frames in
order to ﬁll allocated time slots (recall Section 2.2). To induce
this type of fragmentation, we can use our MitM position to
spoof the 802.11ax capabilities element of the client or AP,
and advertise that they support dynamic fragmentation. An
experimental analysis of this technique is left as future work.

5 Poisoning the Fragment Cache

In this section, we present a design ﬂaw that enables an adver-
sary to inject fragments into the memory, i. e., fragmentation
cache, of victims. We show that this vulnerability allows an
adversary to exﬁltrate client data and inject arbitrary packets.
This design ﬂaws has been assigned CVE-2020-24586.

8

5.1 Threat model

Client

Attacker

AP (vulnerable)

Our attacks work against WEP, CCMP, and GCMP. The TKIP
protocol is only affected if the authenticity of reassembled
frames is not veriﬁed (see Section 6.7). Similar to the mixed
key attack, a device in the network must be sending frag-
mented frames for the attack to be possible. In Section 6.3
we abuse implementation ﬂaws to perform fragment cache
attacks without this assumption. We also make the following
assumptions depending on whether the target is a client or AP:

Vulnerable APs Our attack will exploit vulnerable APs
in hotspot-type networks such as eduroam, and Hotspot 2.0
networks where users can, for example, authenticate using
their mobile SIM card [6]. In these networks, users may dis-
trust each other, and they will use individual authentication
and encryption keys. Our attack also works when these net-
works use downstream group-addressed forwarding and client
isolation (recall Section 2.4).

Vulnerable clients We assume the client will connect to
a protected Wi-Fi network of which the adversary also knows
the password. The client does not trust this network, and will
not send sensitive data when connected to this network. Such a
network can be a coffee shop or conference network where the
password is publicly shared. Note that in practice an adversary
can listen to probe requests to obtain the networks that (old)
devices are willing to connect to [21], and can use password
sharing apps to obtain the password of nearby hotspots.1

5.2 Exﬁltrating client data

We begin by attacking a vulnerable AP and exﬁltrating data
sent by a client. In stage 1(cid:13) of this attack, we spoof the MAC
address of the targeted client and connect to the network
using valid credentials (see Figure 6). This allows us to inject
fragments into the AP’s memory that are saved under the
victim’s MAC address. Note that the attacker possesses valid
credentials since we target hotspot-type networks.

Stage 2(cid:13) of the attack starts when the real client sends an
Auth frame in order to connect to the network. At that point,
the adversary sends the encrypted fragment Encn
k{Frag0(s)}
to the AP, which contains the start of an attacker-destined
IP packet. The AP decrypts this fragment and stores it in
its fragment cache under the victim’s MAC address. After
this, the attacker disconnects from the network by sending a
Deauth frame, and subsequently establishes a multi-channel
MitM between the client and AP. The 802.11 standard does
not state that the AP must remove fragments when a client
disconnects or reconnects, meaning the injected fragment
stays in the fragment cache of the AP.

Between stages 2(cid:13) and 3(cid:13) of the attack, the adversary lets
the client connect normally. Additionally, the adversary never
sends frames to the AP with sequence number s. This assures

1Example apps are http://wifimap.io or http://instabridge.com

1(cid:13)

e
g
a
t
S

2(cid:13)

e
g
a
t
S

3(cid:13)

e
g
a
t
S

Auth

Spoof client MAC address

Connect under client MAC

Encn

k{ Frag0(s) }

Decrypt & store fragment

Deauth

Fragment cache is not cleared

Let client connect & forward normal trafﬁc

Send sensitive data
(cid:96) { Frag0(s(cid:48)) }
{ Frag1(s(cid:48)) }

Encn
Encn+1
(cid:96)

Encn
Encn+1
(cid:96)

(cid:96) { Frag0(s(cid:48))}
{ Frag1(s) }

Reassemble frame and
thereby exﬁltrate data

Figure 6: Fragment cache attack against a vulnerable AP
with as goal to exﬁltrate (decrypt) client data. The adversary
injects a fragment with an attacker-destined IP packet, which
is appended with a fragment containing sensitive data.

that the fragment that we inject in the second stage of the
attack stays in the AP’s fragment cache.

In stage 3(cid:13) of the attack, the adversary waits until a second
fragment with packet number n + 1 is sent. The adversary for-
wards this fragment to the AP with sequence number s. This
causes the AP to combine it with the injected fragment since
they have the same sequence number and MAC addresses.
Because the AP does not store under which credentials these
fragments were received, it does not realize both fragments
were in fact sent by different users. The reassembled frame
will contain an IP packet with as destination the adversary,
and with as payload the user data (similar to Figure 5). This
exﬁltrates the user data to the adversary. If the frame with
packet number n + 1 is not a second fragment, the attack can
be restarted by forcibly disconnecting the client from the AP.

5.3 Packet injection

An attacker can also inject packets by poisoning the fragment
cache. Against an AP this attack is similar to the data exﬁltra-
tion attack of Section 5.2, except that the injected fragment
Frag0 in stage 2(cid:13) contains the packet to be injected. When
reassembling the frame upon reception of the second frag-
ment, unknown content will be appended to the injected frame.
However, the network layer above 802.11 will discard this
unknown content as padding data. The receiver knows where
this padding data starts because network packets, such as IP
or ARP packets, contain length ﬁelds that deﬁne the size of
the packet. As a result, the adversary can inject packets under

9

Client (vulnerable)

Attacker

AP

1(cid:13)

e
g
a
t
S

2(cid:13)

e
g
a
t
S

Spoof AP MAC address

Connect to untrusted network

Encn

k{ Frag0(s) }

Decrypt & store fragment

Deauth

Fragment cache is not cleared

Let client connect & forward normal trafﬁc

Encn
Encn+1
(cid:96)

(cid:96) { Frag0(s(cid:48)) }
{ Frag1(s) }

Encn
Encn+1
(cid:96)

(cid:96) { Frag0(s(cid:48)) }
{ Frag1(s(cid:48)) }

Reassemble frame
and process packet

Figure 7: Fragment cache attack against a client with as goal
to inject a packet. We abuse this to force the client into using
our DNS server while being connected to a trusted network.

another client’s identity, which is otherwise not possible in
our hotspot-type networks.

To abuse fragment cache poisoning against a client, we
rely on a novel threat model where the client will connect to
an untrusted protected network, but will only send sensitive
data when connected to a trusted network. For instance, a
company laptop can be conﬁgured to only send sensitive data
when connected to the company network, but the laptop is also
used for casual internet surﬁng by, for example, connecting
to a coffee shop network with a publicly shared password.

To attack a client, the adversary ﬁrst spoofs the MAC ad-
dress of the trusted (company) network but advertises the
SSID of the untrusted (coffee shop) network (see stage 1(cid:13) in
Figure 7). Once the client connected to this rogue network, the
adversary injects fragment Frag0(s) into the victim’s memory.
This fragment contains the packet to be injected.

Between stages 1(cid:13) and 2(cid:13) of the attack, the client is discon-
nected from the untrusted network, after which it connects to
the trusted (company) network. While the client is connecting,
the adversary establishes a multi-channel MitM position be-
tween the client and AP. In this MitM position, the adversary
forwards all frames between the client and AP, while avoiding
to use sequence number s in frames towards the client. Note
that the 802.11 standard does not require that the client clears
its fragment cache when (re)connecting to an AP.

Stage 2(cid:13) of the attack starts when the AP of the trusted net-
work sends a second fragment with packet number n + 1. The
adversary forwards this frame with sequence number s, such
that the client will reassemble it with the injected fragment
Frag0(s). Similar to the attack against the AP, the network
layer of the client will discard the content in the second frag-
ment as padding bytes, and will subsequently process the

packet contained in Frag0. In practice, an adversary can use
this packet injection capability to trick the client into using
a malicious DNS server (recall Section 3.3). This in turn
enables the adversary to intercept data that the client only
transmits while connected to the trusted (company) network.

5.4 Experiments

Similar to the mixed key attack, patched drivers are needed
to perform the attack in practice. Windows and Linux are
vulnerable with more than half of all tested network cards. The
Android and iOS devices we tested were not vulnerable. Out
of the tested BSD systems, only FreeBSD is vulnerable in AP
mode and when using the injection technique of Appendix E.
Our three professional APs were not affected, but all our
four home routers unfortunately were. See Section 6.1 for an
overview of all tested devices.

To keep experiments easier to reproduce, we again tested
end-to-end attacks against Linux user virtual Wi-Fi interfaces.
The target network used EAP-PWD, meaning users authenti-
cate themselves using a username and password. In this setup
we successfully attacked a vulnerable AP, poisoned its frag-
ment cache with the start of an IP packet towards our server,
and exﬁltrated (decrypted) fragments sent by the victim.

We also successfully conﬁrmed the attack against WEP on
Linux, meaning this design ﬂaw has been part of the 802.11
standard since its release in 1997.

Finally, we note that attacking Linux is non-trivial because
it clears fragments from memory after two seconds. Neverthe-
less, attacks against Linux APs are practical, because there
we can inject the malicious fragment right before a client is
already attempting to connect to the AP, which assures delay
between the injected and forwarded fragment is low.

5.5 Discussion

A backwards-compatible defense is to clear the fragment
cache when (re)connecting or (re)associating with a station.
We elaborate on this in Section 7.2.

Our cache poisoning attack is only possible if a device in
the network uses fragmentation. Similar to our mixed key
attack, we conjecture that our MitM position can pretend that
the client and AP support dynamic fragmentation, and thereby
induce the use of fragmentation against 802.11ax devices.

In practice, if a device is vulnerable to cache attacks, it is
likely also vulnerable to mixed key attacks. This is not guar-
anteed though, because mixed key attacks can be prevented
while cache attacks remain possible (and vice versa).

6 Experiments and Implementation Flaws

In this section, we elaborate on the experimental setup used to
conﬁrm the design ﬂaws, and we present common implemen-
tation ﬂaws related to frame aggregation and fragmentation.

10

6.1 Experimental setup

To conﬁrm the design ﬂaws in practice we tested smartphones,
laptops, internet-of-things devices, home routers, and profes-
sional APs (see Table 1). We also tested Windows 10 and
Linux 5.5 as clients using 16 wireless network cards on a Lati-
tude 7490 and MSI GE60 (Table 2). Then we tested FreeBSD
12.1 and NetBSD 7.0 using several network cards (Table 3),
and OpenBSD 6.4 using a small number of supported network
cards (Section 6.8). In total this means we tested 75 devices,
i. e., network card and OS combinations. In these experiments
all devices were affected by one or more attacks. In general,
whether a device is affected depends on the OS, network card,
and whether it is acting as a client or AP. While performing
experiments, we also analyzed the code of leaked and open
source network stacks and found several implementation ﬂaws
related to aggregation and fragmentation.

We created a tool that can test if clients or APs are affected
by the discovered design and implementations ﬂaws [1]. It can
test home networks and enterprise networks where authentica-
tion is done using, e. g., PEAP-MSCHAPv2 or EAP-TLS. Our
tool supports over 45 test cases, and over all devices combined
we performed more than a thousand tests.

6.2 Non-consecutive packet numbers

A common implementation ﬂaw is that devices do not check
whether all fragments of a frame have consecutive packet num-
bers, i. e., whether the received fragments indeed belong to the
same frame. This ﬂaw has been assigned CVE-2020-26146.2
In our tests, all devices were affected except Windows 10
when using an Intel 3160 or 8265 card, and Linux when the
kernel itself reassembles fragments (this is generally the case
with SoftMAC 802.11 drivers). This means out of 68 tested
devices that support fragmentation, 52 were vulnerable. See
the “Non-con” column in Table 1, 2, and 3 for an overview of
affected devices. Similar to the mixed key attack of Section 4,
an adversary can abuse this vulnerability by mixing fragments
of different packets in order to exﬁltrate user data. The details
of this attack are illustrated in Figure 9 in the Appendix.

The vulnerability affects CCMP and GCMP. TKIP is only
affected if the authenticity of reassembled frames is not ver-
iﬁed (see Section 6.7). The WEP protocol is vulnerable by
design, meaning this can be considered a fourth novel design
ﬂaw. Interestingly, when GCMP was introduced in 2013, its
speciﬁcation did not require that GCMP-encrypted fragments
must have a consecutive PNs [32, §11.4.3]. The 802.11 group
noticed this mistake in 2015 and updated the standard to
require this check for GCMP as well [41]. Due to this tempo-
rary design ﬂaw, Linux 4.0 to 4.4 was vulnerable when using
GCMP even when the kernel reassembled fragments [11].

2For each implementation ﬂaw we list a reference CVE identiﬁer, however,
vendors may use different CVEs because an implementation ﬂaw normally
receives a unique CVE for each affected codebase. For further details see [1].

11

Table 1: Devices tested using their default built-in wireless
network card and operating system. The ﬁrst three attacks are
the design ﬂaws discussed in Section 3, 4, and 5, respectively.
The last four attacks correspond to implementation ﬂaws dis-
cussed in Section 6.2, 6.3, 6.4, and 6.5, respectively.

Attacks

U
D
S
M
A

-

y
e
k
d
e
x
i
M

.
t
t
a

e
h
c
a
C

.

n
o
c
-
n
o
N

.

g
a
r
f

.
t
s
a
c
B

l
o
p
a
e

e
k
a
F

.

g
a
r
f

.

n
i
a
l
P

U

(cid:35) (cid:32)

(cid:71)(cid:35)

(cid:71)(cid:35) (cid:71)(cid:35)

(cid:32) (cid:32) (cid:35) (cid:32)
(cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:35)
(cid:32) (cid:32) (cid:35) (cid:32) (cid:35)
(cid:32) (cid:32) (cid:35) (cid:32) (cid:35)
(cid:32) (cid:32) (cid:35) (cid:32) (cid:35)

(cid:71)(cid:35)

(cid:71)(cid:35)

(cid:71)(cid:35)

(cid:35)
(cid:35)

(cid:71)(cid:35)

(cid:35)
(cid:32) (cid:32) (cid:32) (cid:32) (cid:35)
(cid:32) (cid:32) (cid:32) (cid:32) (cid:35)
(cid:35)
(cid:32) (cid:32) (cid:35) (cid:35) (cid:71)(cid:35) (cid:35) (cid:35)
(cid:32) (cid:32) (cid:35) (cid:35) (cid:71)(cid:35) (cid:35) (cid:35)

U

(cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:35) (cid:35)
(cid:32) (cid:32) (cid:32) (cid:32)
(cid:32) (cid:32)
(cid:32) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32)
(cid:35) (cid:35)
(cid:32) (cid:32) (cid:32) (cid:32)

U

(cid:32) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35)
(cid:32) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35)
(cid:32) (cid:32) (cid:32) (cid:32)
(cid:32) (cid:32) (cid:32) (cid:32)

U
U

(cid:35) (cid:35)
(cid:35) (cid:32)

(cid:71)(cid:35)

(cid:71)(cid:35)

Device

Huawei Y6 prime
Nexus 5X
Samsung i9305
iPhone XR
iPad Pro 2

MacBook Pro 2013
MacBook Pro 2017
Dell Latitude 7490
MSI GE60

Kankun smart plug
Xiaomi Mi Camera
NanoPi R1
Canon PRO-100S

Asus RT-N10
Linksys WAG320N
Asus RT-AC51U
D-Link DIR-853

Aruba AP-305 / 7008
LANCOM LN-1700
Cisco Catalyst 9130

(cid:32) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35)
(cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:32)
(cid:32) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35)
(cid:71)(cid:35)Vulnerable during handshake
o Resulted in crash

Not affected
Vulnerable
(
(cid:72)(cid:35)

(cid:35)
(cid:32)
◎ Accepts all fragmented frames
(cid:71)(cid:35)

) Only ﬁrst (or last) fragment must be encrypted

U Accepts plaintext

6.3 Mixed plaintext and encrypted fragments

Another common implementation ﬂaw we countered is that
devices reassemble mixed encrypted and plaintext fragments,
instead of only accepting encrypted ones (CVE-2020-26147).
This allows an attacker to replace certain encrypted fragments
with plaintext ones. In our tests, 21 devices only require that
), 9 that the last frag-
the ﬁrst fragment is encrypted (icon
ment is encrypted (icon
), and 3 that only one fragment is en-
(cid:71)(cid:35)
crypted (icon
). Moreover, 11 devices even accept plaintext
frames (CVE-2020-26140), and another 9 accept fragmented
but not unfragmented plaintext frames (CVE-2020-26143).
We represent these last two implementation vulnerabilities
using the icons U and ◎, respectively. All combined, 53 out
of 68 devices that support fragmentation are affected by at

(cid:72)(cid:35)

(cid:32)

Table 2: Test results against Windows (W) and Linux (L)
using various network cards. The AWUS051NH and Ralink
Wi-Pi did not support fragmentation on Linux. The TFWM
was not supported by Windows. See Table 1 for the legend.

Table 3: Test results against FreeBSD (F) and NetBSD (N).
Network cards at the top were tested in client mode, and
the ones at the bottom in AP mode. The AWUS0351NH
is not supported by NetBSD, and the TL-WN722N not by
FreeBSD. See Table 1 on page 11 for the legend.

Attacks

y
e
k
d
e
x
i
M

U
.
n
D
o
S
c
-
M
n
o
-
N
A
W L W L W L W L W L W L W L

.
t
t
a
e
h
c
a
C

l
o
p
a
e
e
k
a
F

.
g
a
r
f
.
n
i
a
l
P

.
g
a
r
f
.
t
s
a
c
B

U

◎

o

◎ U

(cid:35) (cid:35)

(cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:35) (cid:35) (cid:35) (cid:35)
(cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:35) (cid:35) (cid:35) (cid:35)
(cid:32) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:71)(cid:35) (cid:71)(cid:35) (cid:35) (cid:35) (cid:35) (cid:35)
(cid:35) (cid:32) (cid:32) (cid:32) (cid:32) (cid:32) (cid:32) (cid:35)
(cid:71)(cid:35) (cid:35) (cid:35) (cid:35) (cid:35)
(cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:32) (cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:35) (cid:35) (cid:35) (cid:35)
(cid:32)
(cid:32) (cid:32) (cid:32) (cid:32) (cid:32) (cid:35) (cid:32) (cid:32)
(cid:71)(cid:35) (cid:32) (cid:35) (cid:32) (cid:35)
(cid:32) (cid:32) (cid:32) (cid:32) (cid:32) (cid:32) (cid:32) (cid:35)
(cid:35) (cid:32) (cid:35) (cid:32) (cid:35)
(cid:32) (cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35)
(cid:71)(cid:35) (cid:32) (cid:35) (cid:32) (cid:35)
(cid:32) (cid:32) (cid:32) (cid:32) (cid:32) (cid:32) (cid:32) (cid:35)
(cid:32) (cid:32) (cid:32) (cid:32) (cid:32) (cid:32) (cid:32) (cid:35)
(cid:35) (cid:35) (cid:35) (cid:35)
(cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:32) (cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:35) (cid:35) (cid:35) (cid:35)
(cid:32) (cid:32) (cid:32) (cid:32) (cid:35) (cid:32) (cid:32) (cid:35) (cid:35) (cid:71)(cid:35) (cid:35) (cid:35) (cid:35) (cid:35)
(cid:35) (cid:32) (cid:35) (cid:32) (cid:35)
(cid:32) (cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35)
(cid:35) (cid:32) (cid:32) (cid:32) (cid:32) (cid:32) (cid:32) (cid:35)
(cid:71)(cid:35) (cid:35) (cid:35) (cid:35) (cid:35)
–
(cid:32) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:32) (cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:35) (cid:35) (cid:35) (cid:35)

◎ U

◎

◎

◎

◎

–

–

–

–

– (cid:71)(cid:35)– (cid:71)(cid:35)

Network card

Intel 3160
Intel 8265
Intel AX200
AWUS036H
AWUS036NHA
AWUS036ACH
AWUS036ACM
AWUS051NH v2
ZyXel NWD6505
TL-WN725N v1
WNDA3200
WN111v2
Ralink Wi-Pi
Sitecom WL-172
ZyXel M-202
TWFM-B003D

(cid:32)

(cid:32)

(cid:35)

(cid:32)

(cid:35)

least one of these implementation vulnerabilities (see column
“Plain. frag” in Table 1, 2, and 3).

The defragmentation code in Linux tries to enforce that
all fragments are encrypted by checking whether they have
consecutive PNs. Unfortunately, this check is implemented
insecurely: after decrypting a frame, its PN is stored a session
variable, and the PN of the previous fragment is compared to
this session variable. As a result, when a (second) plaintext
fragment is received, it checks whether the PN in this session
variable is consecutive to the previous fragment, and does not
realize this PN is unrelated to the received plaintext fragment.
This means the PN check can be bypassed by ﬁrst forwarding
a valid encrypted fragment towards Linux using a consecutive
PN but under a different sequence number, and then injecting
a plaintext fragment under the correct sequence number (see
Figure 10 in the appendix for details).

Practical impact

If the ﬁrst fragment can be a plaintext
one, an attacker can include a malicious packet in this frag-
ment, which will be processed by the victim once it received
all fragments. This is similar to the cache attack of Section 5.3.
In case the ﬁrst fragment must be encrypted, we can com-
bine this vulnerability with either the A-MSDU or fragment
cache attack to inject arbitrary frames. When combined with
the A-MSDU attack, an attacker uses its multi-channel MitM
position to set the A-MSDU ﬂag of an encrypted ﬁrst frag-
ment. After this, the attacker injects a plaintext fragment, upon

12

Attacks

y
e
k
d
e
x
i
M

U
.
n
D
o
S
c
-
M
n
o
-
A
N
F N F N F N F N F N F N F N

.
t
t
a
e
h
c
a
C

l
o
p
a
e
e
k
a
F

.
g
a
r
f
.
n
i
a
l
P

.
g
a
r
f
.
t
s
a
c
B

–

–

–

(cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:72)(cid:35) (cid:72)(cid:35) (cid:35) (cid:35) (cid:32) (cid:35)
(cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:72)(cid:35) (cid:35) (cid:35) (cid:32) (cid:35)
–
–
(cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:72)(cid:35) (cid:72)(cid:35) (cid:35) (cid:35) (cid:32) (cid:35)
(cid:32)
(cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:72)(cid:35) (cid:35) (cid:35) (cid:32) (cid:35)
–
(cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:71)(cid:35) (cid:72)(cid:35) (cid:35) (cid:35) (cid:32) (cid:35)
(cid:35)
(cid:32)

(cid:71)(cid:35)

(cid:32)

(cid:32)

(cid:35)

(cid:35)

(cid:32)

(cid:35)

(cid:35)

(cid:35)

(cid:35)

–

–

–

–

–

–

–

–

(cid:72)(cid:35)
◎ U

(cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:32)
(cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:32)
–
–
(cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:32) (cid:32) (cid:32)

–

–

◎

(cid:35)

(cid:35)

(cid:35)

(cid:32)

(cid:32) (cid:32) (cid:32) (cid:35)
U
(cid:72)(cid:35) (cid:32) (cid:32) (cid:32) (cid:35)
–
– U
(cid:32) (cid:32) (cid:32) (cid:35)
(cid:35)

(cid:35)

–

Network card

Intel 3160
Sitecom WL-172
AWUS036H
AWUS051NH v2
TL-WN725N v1
Belkin F5D8053
TL-WN722N

Sitecom WL-172
TL-WN725N v1
Belkin F5D8053
TL-WN722N

which the victim reassembles both fragments and processes
the resulting A-MSDU. The idea is now that the second sub-
frame will correspond to the payload of the plaintext fragment
and contains a packet that the attacker wants to inject. An
obstacle is that the ﬁrst encrypted fragment, which the ad-
versary cannot control, must result in a small ﬁrst subframe
of predictable length, such that the second subframe is con-
tained in the injected (second) plaintext fragment. This can
be assured by predicting the IP ID of packets, similar to the
A-MSDU attack against clients in Section 3.2. A second limi-
tation is that not all devices support fragmented A-MSDUs.
In particular, out of 56 devices that supported A-MSDUs, 33
properly handled fragmented A-MSDUs, 9 received them as
malformed frames, and the other 14 silently discarded them.
When combined with the cache attack, the attacker ﬁrst poi-
sons the fragment cache of an AP or client with an encrypted
fragment containing (part of) the packet to be injected. Af-
ter the victim connects to the target network, the adversary
injects the second fragment as plaintext, and the victim will
reassemble the frame and process the injected packet. An
advantage of this combination compared to a default cache
attack is that it can be performed even when no devices in the
network send fragmented frames.

Applicability to WEP and TKIP We also tested WEP
on Linux and found that an adversary could trivially set the
more fragments ﬂag, since it is not authenticated, and subse-
quently combine this ﬁrst encrypted fragment with plaintext
fragments. The TKIP protocol is only affected if the authen-
ticity of reassembled frames is not veriﬁed (see Section 6.7).

LLC

SNAP

EAPOL

EAP

6.6 EAPOL forwarding & fragmentation

AA AA 03 00 00 00 88 8E 01 00 00 00 00 02 · · · XX · · · XX

Destination

Source

Length

Subframe 2

Figure 8: An A-MSDU payload (bottom) whose ﬁrst 8 bytes
are also a valid EAPOL LLC/SNAP header (top). Red bytes
must have the given value, and green ones can have any value.

6.4 Broadcast plaintext fragments

Although broadcast frames should never be fragmented, sev-
eral devices process broadcasted fragments as normal unfrag-
mented frames. Moreover, some devices accept second (or
subsequent) broadcast fragments even when sent unencrypted
in a protected Wi-Fi network (CVE-2020-26145). An attacker
can abuse this to inject packets by encapsulating them in a
second fragmented plaintext broadcast frame, i. e., in a Frag1
frame with a broadcast receiver address. Even unicast network
packets, such as IPv4 or ARP packets, can be encapsulated in
broadcast 802.11 frames and hence be injected in this manner.
Affected devices are listed under the column “Bcast. frag.”
in Table 1, 2, and 3. Notable affected devices are those of
Apple and APs on NetBSD and FreeBSD. Some devices are
only vulnerable during the execution of the 4-way handshake,
but this does not limit attacks: a victim can be forcibly discon-
nected, e. g., deauthenticated or jammed, such that the victim
will reconnect and execute a new 4-way handshake.

6.5 Cloaking A-MSDUs as handshake frames

Devices accept plaintext 4-way handshake frames, i. e., plain-
text data frames with an EAPOL LLC/SNAP header, when
connecting to a network. If implemented wrongly, this can be
abused to inject plaintext A-MSDUs (CVE-2020-26144). In
particular, an adversary can construct a plaintext A-MSDU
whose ﬁrst 8 bytes can also be interpreted as a valid EAPOL
LLC/SNAP header (see Figure 8). Although this causes the
destination and source address of the ﬁrst subframe to be
invalid, meaning the receiver drops this subframe, other sub-
frames are still processed. Hence, an attacker can inject arbi-
trary packets against devices that accept plaintext A-MSDUs
whose ﬁrst 8 bytes equal an EAPOL LLC/SNAP header.

Against FreeBSD and several devices shown in Table 1
and 2, this allows an adversary to inject plaintext A-MSDU
frames. Similar to Section 6.4, some devices are only vulner-
able during the execution of the 4-way handshake. Against
an AWUS036ACH on Windows 10, an A-MSDU starting
with a valid EAPOL header resulted in a blue screen of death.
Finally, some implementations strip away the ﬁrst 8 bytes of
an A-MSDU if these bytes equal a valid LLC/SNAP header
(recall Section 3.6). This is not compliant with the standard
and does not prevent attacks against vulnerable devices.

As highlighted in the previous section, devices must accept
plaintext 4-way handshake frames when a client is connecting
to a network. We found that some devices also forward plain-
text handshake frames if they are destined to other clients
in the network, even when the sender has not yet authenti-
cated (CVE-2020-26139). Affected devices are FreeBSD and
NetBSD APs, and certain home routers such as our Asus
RT-N10 and Linksys WAG320N. An adversary can abuse this
to perform the A-MSDU attack from Section 3 using only a
multi-channel MitM position. In particular, the adversary ﬁrst
associates with the target network. Then, instead of starting
the 4-way handshake, the adversary will send a handshake,
i. e., EAPOL, frame to the AP with as ﬁnal destination a client
that is connected to the network. A vulnerable AP accepts
and forwards this EAPOL frame to its destination, in this case
the targeted client. Moreover, the AP will encrypt this frame
towards the client. The adversary can then uses its MitM posi-
tion to set the A-MSDU ﬂag in the encrypted EAPOL frame.
An adversary can then inject arbitrary packets by constructing
an EAPOL frame as illustrated in Figure 8 and placing the
packet to be injected in the second A-MSDU subframe.

Against a NetBSD AP, an adversary can also send a large
EAPOL frame, after which the AP will fragment, encrypt, and
forward it to the targeted client. In other words, the adversary
can abuse a NetBSD AP to generate encrypted fragments.
This can be combined with the cache attack by ﬁrst poisoning
the fragment cache of the victim, and then generating a second
encrypted fragment through the NetBSD AP that causes the
victim to reassemble the fragments and process the injected
packet. Another option is to abuse this against clients that
accept fragmented frames as long as the last fragment is en-
crypted. Unfortunately, most NetBSD drivers do not support
sending fragmented frames, and only send the ﬁrst fragment
and drop subsequent ones. Nevertheless, drivers such as ath
do transmit all fragments, which an adversary can exploit to
more easily perform fragmentation-based attacks.

6.7 Skipping the TKIP authenticity check

Fragmentation attacks should be impossible against TKIP
because it veriﬁes the authenticity of the full (reassembled)
frame. However, we found several network cards on Linux
and Windows that do not verify the authenticity of reassem-
bled TKIP frames (CVE-2020-26141). On Windows, the
AWUS036H, AWUS036ACH, and TL-WN725N are affected,
and on Linux the NWD6505 and AWUS036ACM are af-
fected. Against these devices our fragmentation-based attacks
are possible even if the old TKIP protocol is used.

6.8 Treating fragments as full frames

Certain implementations, such as OpenBSD and the ESP-12F,
do not support A-MSDUs or fragmented frames. However,

13

they are still vulnerable to attacks because they treat all frames
as non-fragmented ones (CVE-2020-26142). An adversary
can abuse this to inject arbitrary network packets by control-
ling the content that is included in one of the fragments. This
can be accomplished in the relaxed BEAST threat model by
making the client load an attacker-controlled URL or resource,
such that the resulting request or response is fragmented at
the Wi-Fi layer, and one of the fragments purely consists of
attacker-controlled data (which is then treated as a full frame).
In the case of OpenBSD, the more fragments ﬂag is not
included in the associated metadata when decrypting a frag-
ment, causing decryption to fail on all but the last fragment.
The last fragment does not have this ﬂag set, meaning it is
successfully decrypted and will be processed as a full frame.
OpenBSD can also ofﬂoad decryption to the Wi-Fi chip. In
that case, all fragments are properly decrypted, but OpenBSD
treats each decrypted fragment as an unfragmented frame. In
both cases it is possible to inject arbitrary network packets by
controlling the content that is included in the last fragment.

We conﬁrmed the resulting attack(s) against the ESP-12F,
which even accepted plaintext frames, and against OpenBSD
6.6 when it acted as a client using a Belkin F5D8053 v3 or
Intel 8265. We conjecture that other devices, which also do
not support fragmentation, can be attacked in similar ways.

7 Related Work & Discussion

In this section we cover related work, give an overview of all
our countermeasures, discuss results, and explore future work.

7.1 Related work

Aggregation Robyns et al. presented packet-in-packet
attacks that exploit aggregated MPDUs where (encrypted)
frames are aggregated close to the physical layer [45]. In this
aggregation method, encryption happens before aggregation,
and their attacks enabled the remote injection of frames in
open (but not protected) Wi-Fi networks. Similarly, other
packet-in-packet attacks against different protocols are also
only feasible in open networks [15,23]. We study aggregation
at a higher network layer, where encryption takes places after
aggregation. Our resulting attacks apply to protected Wi-Fi
networks and allow an adversary, that is within radio range
of victims, to inject packets. In other work, A-MSDUs were
abused to more easily trigger key reinstallations [58], but no
attention was paid to the unauthenticated A-MSDU ﬂag.

Fragmentation Previous work abused fragmentation to
more efﬁciently exploit known ﬂaws in WEP [13], but did not
uncover ﬂaws in (de)fragmentation features itself. Schepers et
al. found that OpenBSD incorrectly handled fragmented TKIP
frames [50], allowing Denial-of-Service (DoS) attacks and
packet injection, but this was an implementation vulnerability
and not a design ﬂaw in the standard.

Implementation ﬂaws in IPv4 and IPv6 (de)fragmentation
have been abused for DoS attacks, ﬁrewall evasion, etc [9,36].
It was also abused to launch off-path DNS cache poisoning
attacks by bypassing its plaintext challenge-response proto-
col [28]. This was possible because the ﬁrst fragment of a
response contains the unpredictable challenge values, and
an adversary can replace the second fragment with malicious
data. In contrast, our attacks work against encrypted protocols.
Nowadays, IP fragmentation is considered fragile [14].

Against 6LoWPAN, fragmentation was abused to launch a
DoS attack by preventing (correct) packet reassembly [29].

Formal models Cremers et al. formally modeled WPA2
and demonstrated the correctness of key reinstallation de-
fenses. Their model did not include aggregation and fragmen-
tation functionality, and therefore missed the attacks that we
discovered [18]. Other work on formally verifying and mod-
eling WPA2 only focuses on the 4-way handshake [26, 51].

Wi-Fi security Lately major advancements have been
made to the security of Wi-Fi. This includes the discovery
and prevention of key reinstallations in WPA2 [57, 58], the
release of WPA3 [60], and extra defenses such as operating
channel validation and beacon protection [54, 55]. Although
shortcomings in WPA3 were identiﬁed [40, 59], these have
been addressed in an update to the standard [25]. Finally, a
recent update to WPA3 improves the security of enterprise
networks, as these were often insecurely conﬁgured [10, 16].
Other work studied Wi-Fi provisioning schemes [38], in-
ferred and analyzed state machines [52], and studied potential
electromagnetic side-channel leaks in 802.11 radios [17].

7.2 Countermeasures for the design ﬂaws

Spooﬁng aggregated frames The aggregation attack of
Section 3 can be prevented by updating the standard to assure
the A-MSDU ﬂag is always authenticated, i. e., assuring only
SPP A-MSDUs are used. This can be accomplished by setting
and adhering to the “SPP A-MSDU required” ﬂag in the RSN
element when connecting to another station or network. In
theory, this assures all stations either: (1) never accept/send
A-MSDUs; or (2) always authenticate the A-MSDU ﬂag in
sent and received frames [31, Table 11-12].

The RSN element also contains a ﬂag to indicate whether
the device supports SPP A-MSDUs. When a device does not
set this ﬂag, but does set the SPP required ﬂag, this means no
A-MSDUs should be sent to it. In other words, if a device does
not support SPP A-MSDUs, this ﬂag combination instructs
peers to never accept or send A-MSDUs [31, Table 11-12].
This ﬂag combination also prohibits the device itself to send or
accept A-MSDUs, preventing all possible aggregation attacks.
Unfortunately, most devices ignore the SPP ﬂags in the
RSN element, and will send or accept non-SPP A-MSDUs
independent of these ﬂags. Therefore, if a device sets the SPP
required ﬂag, and a peer still sends non-SPP A-MSDUs, these

14

will be dropped. In other words, setting the SPP required ﬂag
may degrade reliability. It also means the attack of Section 3.5
remains possible because, when the sender does not authen-
ticate the A-MSDU ﬂag, it masks the A-MSDU ﬂag to zero
in the authenticated metadata (recall Section 2.1). As a result,
an attacker can unset the A-MSDU ﬂag without the receiver
noticing this. Nevertheless, the impact of this attack appears
low, and as a defense we therefore still recommend to set and
adhere to the SPP required ﬂag in the RSN element.

If dropping non-SPP A-MSDUs is not feasible, attacks can
be mitigated by dropping the full A-MSDU frame if any of
the subframe’s MAC addresses do not belong to connected
stations. In particular, A-MSDUs must be dropped if their ﬁrst
6 bytes equal the start of an LLC/SNAP header, i. e., if the des-
tination address of the ﬁrst subframe is AA:AA:03:00:00:00.
Although this prevents our main attack, other novel aggrega-
tion-based attacks may remain possible.

Mixed key attack Mixed key attacks of Section 4 can be
prevented by not reassembling fragments that were decrypted
using different keys, which is backwards-compatible because
this does not occur in normal circumstances. The standard
and all implementations should be updated to include this
check. An efﬁcient way to implement this is to assign an in-
cremental key identiﬁer to decrypted fragments, increase this
identiﬁer whenever a new key is installed, and verifying that
all fragments were decrypted using the same key identiﬁer.

To mitigate (but not prevent) attacks against receivers, a
transmitter can decide to never use fragmentation. However,
this may reduce reliability. Note that clearing the fragment
cache whenever installing a key does not prevent mixed key
attacks when using multiple key support (recall Section 4.4).

Cache attack The fragment cache attack of Section 5
can be prevented by updating clients to clear the fragment
cache whenever (re)connecting or (re)associating with a net-
work. Similarly, an AP should clear all fragments received by
a speciﬁc client when this client reconnects, reassociates, or
disconnects from the network. These changes are backwards-
compatible since legitimate devices do not rely on this vul-
nerable behavior. The 802.11 standard and all existing imple-
mentations should be updated to perform these actions.

7.3 Overall discussion

Test considerations Several devices were not affected by
our default attack(s), but only to minor variants, e. g., FreeBSD
and OpenBSD. Therefore, we recommend to only consider a
device secure if there are explicit checks in the code to prevent
attacks and if practical tests show it is indeed not vulnerable.
To test attacks, driver and ﬁrmware patches are required to
reliably inject fragmented frames. Otherwise important ﬁelds
may be overwritten, causing attacks to fail. This obstacle
when testing attacks may be one reason why the discovered
design ﬂaws went unnoticed for more than two decades.

Future work Crucial future work is formally modeling
802.11’s aggregation and fragmentation features to evaluate,
and increase conﬁdence in, the correctness of our defenses.
It is also worthwhile to investigate how 802.11ax can be
abused to induce fragmentation in practice, since this would
increase the impact of our fragmentation-based attacks.

We also believe it is important to study in more detail how
different ﬂaws can be combined in practical attacks. Finally,
we consider it interesting future work to analyze other (pro-
prietary) protocols for similar fragmentation-based ﬂaws.

8 Conclusion

We discovered widespread design and implementation ﬂaws
related to frame aggregation and fragmentation. Interestingly,
our aggregation attack could have been avoided if devices
had implemented optional security improvements earlier. This
highlights the importance of deploying security improvements
before practical attacks are known. The two fragmentation-
based design ﬂaws were, at a high level, caused by not ade-
quately separating different security contexts. From this we
learn that properly separating security contexts is an important
principle to take into account when designing protocols.

In practice, our implementation-speciﬁc vulnerabilities are
the most devastating. Several enable the trivial injection of
frames, which we abused to trick a victim into using a mali-
cious DNS server to then intercept most of the victim’s trafﬁc.

Acknowledgments

We thank LANCOM, Aruba, and Cisco for their test devices,
and thank Cisco for help with the disclosure. This work was
supported by the Center for Cyber Security at New York Uni-
versity Abu Dhabi (NYUAD). The author holds a Postdoctoral
fellowship from the Research Foundation Flanders (FWO).

References

[1] https://github.com/vanhoefm/fragattacks

[2] Md Sohail Ahmad. Wpa too! In DEF CON, 2010.

[3] Nadhem J. Al Fardan and Kenneth G. Paterson. Lucky
thirteen: Breaking the TLS and DTLS record protocols.
In IEEE S&P, 2013.

[4] Martin R Albrecht and Kenneth G Paterson. Lucky
microseconds: a timing attack on amazon’s s2n imple-
mentation of TLS. In Eurocrypt, 2016.

[5] Nadhem AlFardan, Daniel Bernstein, Kenneth Paterson,
Bertram Poettering, and Jacob Schuldt. On the security
of RC4 in TLS and WPA. In USENIX Security, 2013.

[6] Wi-Fi Alliance. Hotspot 2.0 Speciﬁcation Ver. 3.1, 2019.

15

[7] Amazon.

Retrieved
AWS IP address ranges.
3 June 2020 form https://docs.aws.amazon.com/
general/latest/gr/aws-ip-ranges.html, 2020.

[22] Christina Garman, Kenneth G. Paterson, and Thyla Van
der Merwe. Attacks only get better: Password recovery
attacks against RC4 in TLS. In USENIX Security, 2015.

[8] Arch Linux Wiki.

Network conﬁguration /
Retrieved 18 February 2020 from

wireless.
https://wiki.archlinux.org/index.php/
Network_configuration/Wireless, 2020.

[23] Travis Goodspeed, Sergey Bratus, Ricky Melgares, Re-
becca Shapiro, and Ryan Speers. Packets in packets:
Orson welles’ in-band signaling attacks for modern ra-
dios. In USENIX WOOT, 2011.

[9] Antonios Atlasis. Attacking IPv6 implementation using
fragmentation. In Black Hat EU Brieﬁngs, 2012.

[24] Finn Michael Halvorsen and Olav Haugen. Cryptanaly-
sis of ieee 802.11i TKIP. Master’s thesis, 2009.

[10] Alberto Bartoli, Eric Medvet, Andrea De Lorenzo, and
Fabiano Tarlao. (in)secure conﬁguration practices of
WPA2 enterprise supplicants. In WiSec, 2018.

[11] Johannes Berg. mac80211: check PN correctly for
GCMP-encrypted fragmented MPDUs. Linux commit
9acc54beb474, 2016.

[12] Karthikeyan Bhargavan and Gaëtan Leurent. On the
practical (in-)security of 64-bit block ciphers: Collision
In CCS,
attacks on HTTP over TLS and OpenVPN.
2016.

[13] Andrea Bittau, Mark Handley, and Joshua Lackey. The
ﬁnal nail in WEP’s cofﬁn. In IEEE S&P, 2006.

[14] Ron Bonica, Fred Baker, Geoff Huston, Bob Hinden, Ole
Trøan, and Fernando Gont. IP fragmentation considered
fragile. RFC 8900, 2020.

[15] Sergey Bratus, Travis Goodspeed, Ange Albertini, and
Debanjum S Solanky. Fillory of PHY: Toward a peri-
odic table of signal corruption exploits and polyglots in
digital radio. In USENIX WOOT, 2016.

[16] Sebastian Brenza, Andre Pawlowski, and Christina Pöp-
per. A practical investigation of identity theft vulnera-
bilities in eduroam. In WiSec, 2015.

[17] Giovanni Camurati, Sebastian Poeplau, Marius Muench,
Tom Hayes, and Aurélien Francillon. Screaming chan-
nels: When electromagnetic side channels meet radio
transceivers. In CSS, 2018.

[18] Cas Cremers, Benjamin Kiesl, and Niklas Medinger. A
formal analysis of IEEE 802.11’s WPA2: Countering
the kracks caused by cracking the counters. In USENIX
Security, 2020.

[19] Ralph Droms. Dynamic Host Conﬁguration Protocol.

RFC 2131, 1997.

[20] T. Duong and J. Rizzo. Here come the xor ninjas. In

Ekoparty Security Conference, 2011.

[25] Dan Harkins, Jouni Malinen, and Mike Montemurro.
Finding PWE in constant time. Retrieved 14 June 2020
from https://mentor.ieee.org/802.11/dcn/19/
11-19-1173-18-000m-pwe-in-constant-time.
docx, 2019.

[26] Changhua He, Mukund Sundararajan, Anupam Datta,
Ante Derek, and John C Mitchell. A modular correctness
proof of IEEE 802.11i and TLS. In CCS, 2005.

[27] Alex Hern. Major sites including new york times and
BBC hit by ransomware malvertising. The Guardian,
2016.

[28] Amir Herzberg and Haya Shulman. Fragmentation con-
sidered poisonous, or: one-domain-to-rule-them-all.org.
In IEEE CNS, 2013.

[29] René Hummen, Jens Hiller, Hanno Wirtz, Martin Henze,
Hossein Shafagh, and Klaus Wehrle. 6LoWPAN frag-
mentation attacks and mitigation mechanisms. In WiSec,
2013.

[30] IEEE P802.11ax/D4.3. Amendment 1: Enhancements

for High Efﬁciency WLAN (draft), 2019.

[31] IEEE Std 802.11. Wireless LAN Medium Access Control

(MAC) and Physical Layer (PHY) Spec, 2016.

[32] IEEE Std 802.11ac. Amendment 4: Enhancements for
Very High Throughput for Operation in Bands below 6
GHz, 2013.

[33] IEEE Std 802.11n. Amendment 5: Enhancements for

Higher Throughput, 2009.

[34] Jaehoon Paul Jeong, Soohong Daniel Park, Luc Beloeil,
IPv6 Router Advertisement

and Syam Madanapalli.
Options for DNS Conﬁguration. RFC 8106, 2017.

[35] Lars-Erik Jonsson, Lars Åke Larzon, Gorry Fairhurst,
Stephen Pink, and Mikael Degermark. The Lightweight
User Datagram Protocol (UDP-Lite). RFC 3828, 2004.

[21] Julien Freudiger. How talkative is your mobile device?
an experimental study of Wi-Fi probe requests. In WiSec,
2015.

[36] Malachi Kenney. Ping of death. Retrieved 14 June
2020 from https://insecure.org/sploits/ping-
o-death.html, 1996.

16

[37] Amit Klein and Benny Pinkas. From IP ID to device ID
and KASLR bypass. In USENIX Security, 2019.

[38] Changyu Li, Quanpu Cai, Juanru Li, Hui Liu, Yuanyuan
Zhang, Dawu Gu, and Yu Yu. Passwords in the air: Har-
vesting Wi-Fi credentials from SmartCfg provisioning.
In WiSec, 2018.

[50] Domien Schepers, Aanjhan Ranganathan, and Mathy
Vanhoef. Practical side-channel attacks against WPA-
TKIP. In ASIA CCS, 2019.

[51] Rajiv Ranjan Singh, José Moreira, Tom Chothia, and
Mark Ryan. Modelling of 802.11 4-way handshake at-
tacks and analysis of security properties. In STM, 2020.

[39] Jie Liang. Simplifying implementation of CCMP mode.
Retrieved 29 May 2020 from mentor.ieee.org/802.
11/dcn/03/11-03-0122-00-000i-simplifying-
implementation-of-ccmp-mode.ppt, 2003.

[40] Karim Lounis and Mohammad Zulkernine. Bad-token:
denial of service attacks on WPA3. In SIN, 2019.

[41] Jouni Malinen and Mark Rison. GCMP decapsulation.
Retrieved 18 May 2020 from https://mentor.ieee.
org/802.11/dcn/15/11-15-1132-02-000m-gcmp-
decapsulation.docx, 2015.

[42] Bodo Möller, Thai Duong, and Krzysztof Kotowicz.
This POODLE bites: exploiting the SSL 3.0 fallback,
2014.

[52] Christopher McMahon Stone, Tom Chothia, and Joeri
de Ruiter. Extending automated protocol state learning
for the 802.11 4-way handshake. In ESORICS, 2018.

[53] Dr. Joseph D. Touch. Updated Speciﬁcation of the IPv4

ID Field. RFC 6864, 2013.

[54] Mathy Vanhoef, Prasant Adhikari, and Christina Pöpper.
Protecting Wi-Fi beacons from outsider forgeries. In
WiSec, 2020.

[55] Mathy Vanhoef, Nehru Bhandaru, Thomas Derham, Ido
Ouzieli, and Frank Piessens. Operating channel val-
idation: Preventing multi-channel man-in-the-middle
In WiSec,
attacks against protected Wi-Fi networks.
2018.

[43] Nick Nikiforakis, Luca Invernizzi, Alexandros Kaprav-
elos, Steven Van Acker, Wouter Joosen, Christopher
Kruegel, Frank Piessens, and Giovanni Vigna. You
are what you include: Large-scale evaluation of remote
JavaScript inclusions. In CCS. ACM, 2012.

[56] Mathy Vanhoef and Frank Piessens. Advanced Wi-Fi

attacks using commodity hardware. In ACSAC, 2014.

[57] Mathy Vanhoef and Frank Piessens. Key reinstallation
attacks: Forcing nonce reuse in WPA2. In CCS, 2017.

[44] J. Postel and J. Reynolds. Standard for the transmission
of IP datagrams over IEEE 802 networks. RFC 1042,
1988.

[45] Pieter Robyns, Peter Quax, and Wim Lamotte. Injection
attacks on 802.11n MAC frame aggregation. In WiSec,
2015.

[46] Eyal Ronen, Robert Gillham, Daniel Genkin, Adi
Shamir, David Wong, and Yuval Yarom. The 9 lives
of bleichenbacher’s CAT: New cache attacks on TLS
implementations. In IEEE S&P, 2019.

[47] Eyal Ronen, Kenneth G. Paterson, and Adi Shamir.
Pseudo constant time implementations of TLS are only
pseudo secure. In CCS, 2018.

[48] Jon Rosdahl, Mark Hamilton, and Michael Montemurro.
Minutes REVmd – may 2018 – warsaw. Retrieved 14
September 2020 from https://mentor.ieee.org/
802.11/dcn/18/11-18-0616-00-000m-minutes-
revmd-may-2018-warsaw.docx, 2018.

[49] Flavia Salutari, Danilo Cicalese, and Dario J Rossi. A
closer look at IP-ID behavior in the wild. In Interna-
tional Conference on Passive and Active Network Mea-
surement. Springer, 2018.

[58] Mathy Vanhoef and Frank Piessens. Release the kraken:

new KRACKs in the 802.11 standard. In CCS, 2018.

[59] Mathy Vanhoef and Eyal Ronen. Dragonblood: Analyz-
ing the Dragonﬂy handshake of WPA3 and EAP-pwd.
In IEEE S&P, 2020.

[60] Wi-Fi Alliance. WPA3 speciﬁcation version 2.0. Re-
trieved 24 May 2020 from https://www.wi-fi.org/
file/wpa3-specification, 2019.

A Driver and ﬁrmware modiﬁcations

Our test tool relies on Linux’s virtual interface support and
we used it with a TL-WN722N to inject frames. To avoid the
kernel function ieee80211_tx_h_sequence from overwrit-
ing sequence numbers when using multiple virtual interfaces,
we patched it to not modify non-zero sequence numbers. To
avoid the ﬁrmware from overwriting the sequence and frag-
ment number, we patched ath_tgt_tx_seqno_normal to
not modify wh->i_seq and wh->i_seq[0].

To prevent injected frames with a different QoS priority
from being reordered, we patched ath9k_htc_tx_data to
set tx_hdr.tidno to zero independent of the frame’s priority.
More details and other required workarounds, including
patches for other wireless network cards, can be found on [1].

17

B Non-consecutive packet number attack

D Plaintext fragment injection against Linux

Client

Attacker

AP (vulnerable)

Client

Attacker

AP (vulnerable)

Visit attacker’s website
k{ Frag0(s) }
{ Frag1(s) }

Encn
Encn+1
k

Send sensitive data

Encn+d
k
Encn+d+1
k

{ Frag0(s(cid:48)) }
{ Frag1(s(cid:48)) }

1(cid:13)

e
g
a
t
S

2(cid:13)

e
g
a
t
S

Detect packet to
attacker’s server
Encn

k{ Frag0(s) }

Decrypt & store fragment

Detect packet with
sensitive data
Encn+d+1
k

{ Frag1(s) }

Reassemble frame

Packet with sensitive
data is sent to attacker

Figure 9: Attacking an AP that accepts fragments with non-
consecutive PNs. The ﬁrst fragment is the start of an IP packet
to the attacker’s server, which is appended in stage 2(cid:13) with
user data. The reassembled packet is sent to the attacker’s
server, exﬁltrating the user data. Between stages 1(cid:13) and 2(cid:13), the
attacker never uses sequence number s in forwarded frames.

C Advanced Aggregation (A-MSDU) attacks

In our aggregation attack, we used IPv4 packets with an at-
tacker-controlled IP identiﬁcation value and payload. How-
ever, it may be infeasible to send such IPv4 packets to a victim.
Instead, an adversary may wish to abuse devices that send
IPv4 packets with an IP ID value of zero. This is useful when
combined with the fragmentation bug of Section 6.3 to control
a second plaintext fragment containing injected packets, or to
attack an AP using a client in the BEAST threat model.

When setting the A-MSDU ﬂag of an encrypted frame that
transports an IPv4 packet with an ID value of zero, the last
two bytes of the destination IP address become the length
ﬁeld of the second A-MSDU subframe. Depending on the
IP addresses used by the network, this results in a short sub-
frame, allowing an adversary to control the content of the
third A-MSDU subframe. For instance, when using the subnet
192.168.1.0/24, the length of the second subframe is between
256 and 512 bytes, leaving enough space to inject frames by
controlling the content of the third subframe. When targeting
IPv4 packets sent to the internet that have an identiﬁcation
value of zero, we conjecture that trafﬁc analysis can be used
to detect which server a user is connecting to, and based on
this the adversary can predict when the last two bytes of the
IP address result in a short A-MSDU subframe.

Encn

k{ Frag0(s) }

Encn

k{ Frag0(s) }

Decrypt & store fragment

Encn+1
k

{ Frag1(s) }

Encn+1
k

{ Frag1(s’) }

Update latest received PN

Frag1(s)

Reassemble frame

1(cid:13)

e
g
a
t
S

2(cid:13)

e
g
a
t
S

Figure 10: Tricking Linux into accepting plaintext fragments.
In stage 1(cid:13) the attacker forwards a legitimate encrypted Frag0.
The second fragment is forwarded under a different sequence
number so it will not be combined with Frag0. However, Linux
does update the session variable containing the latest received
PN to n + 1. In stage 2(cid:13) the attacker injects a plaintext frag-
ment with sequence number s. The PN in the session variable
is now consecutive to the one of Frag0, and since the plain-
text fragment has the same sequence number s as Frag0, the
encrypted and plaintext fragment will be combined. The re-
sulting frame will then be processed (or forwarded) by Linux.

E Fragmentation attacks against FreeBSD

The default mixed key and fragment cache attack do not work
against FreeBSD, because it rejects fragments if an unrelated
frame (of the same sender) is received in-between these frag-
ments.

This can be overcome by realizing that broadcast frames
do not inﬂuence the defragmentation process of FreeBSD. An
adversary can use this to forward 4-way handshake frames
without affecting the defragmentation process by encapsulat-
ing them inside an A-MSDU frame with a broadcast receiver
address, where the destination MAC address in the A-MSDU
subframe equals the unicast address of the receiver.

To use this technique in an attack, the other station has
to send plaintext 4-way handshake messages. This is the de-
fault behavior of devices in the cache attack, but not during
the rekey handshake in the mixed key attack. Nevertheless,
the RT-AC51U AP does send 4-way handshake frames in
plaintext during a rekey. Therefore, when a FreeBSD client is
connected to such an AP, an adversary can capture the plain-
text 4-way handshake messages, and encapsulate them into
broadcast A-MSDU frames. This causes FreeBSD to renew
the pairwise session key without affecting the defragmenta-
tion process, allowing an adversary to perform a mixed key
attack against FreeBSD. We successfully tested this technique
against FreeBSD 12.1 when connected to our RT-AC51U. We
also performed a fragment cache attack against a FreeBSD
AP when it was using an TL-WN725N as a network card.

18



=== Content from www.arista.com_379a6fd2_20250119_122954.html ===


* [Login](/en/login)

 [Wi-Fi Launchpad](https://login.wifi.arista.com/cas/login)
[Community Central](/community/community-forum)
 English

* [English](/en/support/advisories-notices/security-advisory)
* [日本語](/jp/support/advisories-notices/security-advisory)
* [中文](/zh/support/advisories-notices/security-advisory)
* [한국어](/ko/support/advisories-notices/security-advisory)

 [![Arista](/templates/arista_v2/img/logo_arista.png)](/ "Arista")

Toggle Navigation

* Solutions
  + [AI Networking Center](/en/solutions/ai-networking)
  + [Cloud Networking](/en/solutions/cloud-networking)
  + [Cloud-Grade Routing](/en/solutions/cloud-scale-routing)
  + [Cognitive Campus Workspaces](/en/solutions/cognitive-campus)
  + [Electronic Trading](/en/solutions/electronic-trading)
  + [Enterprise WAN](/en/solutions/enterprise-wan)
  + [Federal Government](/en/solutions/federal-government)
  + [Hybrid Cloud](/en/solutions/hybrid-cloud)
  + [IP Storage and Big Data](/en/solutions/big-data)
  + [Media & Entertainment](/en/solutions/media-entertainment)
  + [Network Observability](/en/solutions/network-observability)
  + [Security](/en/solutions/security)
  + [Telemetry and Analytics](/en/solutions/telemetry-analytics)
* Products
  + [Product Overview](#tab17)
  + [EOS](#tab18)
  + [CloudVision](#tab19)
  + [Featured Products](#tab20)
  + [Featured Platforms](#tab720)
  + [Security](#tab664)
  + [DANZ Monitoring Fabric](#tab652)
  + [Cognitive Wi-Fi](/en/products/cloudvision-cue)
  + [Transceivers/Cables](/en/products/transceivers-cables)

  Back
  + [Product Overview](/en/products)Cloud Network Design Choices, The Universal Spine and The Best Data Center Portfolio[![](/assets/images/product/Layer3_VXLAN_Design.png)](/products)

  + [EOS Overview](/en/products/eos)Arista Extensible Operating System (EOS®) is the core of Arista cloud networking solutions for next-generation data centers and cloud networks.[![](/assets/images/product/NetDL-160.png)](/products/eos)

  + [CloudVision Overview](/en/products/eos/eos-cloudvision)A Platform for Cloud Automation and Visibility
  + [CloudVision Universal Network Observability (CV UNO)](/products/eos/eos-cloudvision/cv-uno)[![](/assets/images/video/CV-UNO-Overview-menu.jpg)](https://www.youtube.com/embed/cmHl8IAzmGk?rel=0&wmode=transparent&modestbranding=1&showinfo=0)

  + [Platforms Overview](/en/products/platforms)
  + [7800 Series](#tab588)
  + [7700 Series](#tab1575)
  + [7500 Series](#tab23)
  + [7300 Series](#tab24)
  + [7280 Series](#tab25)
  + [AWE 7200R Series](#tab1539)
  + [7170 Series](#tab27)
  + [7130 Series](#tab446)
  + [7060X Series](#tab30)
  + [7050X Series](#tab31)
  + [7020R Series](#tab32)
  + [7010X Series](#tab33)
  + [750 Series](#tab688)
  + [720X Series](#tab636)
  + [720D Series](#tab1461)
  + [710P Series](#tab1352)
  + [Wi-Fi 7 Series](/en/products/wifi7-series)
  + [Wi-Fi 6E Series](/en/products/wifi6e-series)
  + [Wi-Fi 6 Series](/en/products/wifi6-series)

  + [Universal Cloud Networking](#tab721)
  + [Hyperscale Data Center](#tab722)
  + [Cloud Grade Routing](#tab723)
  + [Enterprise WAN](/en/solutions/enterprise-wan)
  + [Cognitive Campus](#tab724)
  + [R-Series Spine & Leaf](#tab725)
  + [X-Series Spine & Leaf](#tab726)
  + [Programmable](#tab727)
  + [800G Solutions](#tab1615)
  + [400G Solutions](#tab728)
  + [Flexible 10G & 1G Leaf](#tab729)
  + [Network Observability](#tab1324)
  + [Detection and Response](#tab1327)

  + [Network Access Control](/en/products/network-access-control)Simple Scalable Secure![](/assets/images/CV-AGNI-Menu.png)
  + [Multi-Domain Segmentation (MSS)](/en/products/multi-domain-segmentation)
  + [Arista NDR](/en/products/network-detection-and-response)
  + [Wireless Intrusion Prevention System](/en/products/wireless-intrusion-prevention-system)
  + [Edge Threat Management](/solutions/security/etm)
  + [Security Services](/en/products/security-services)

  + [DMF Overview](/en/products/danz-monitoring-fabric)Controller-driven visibility fabric delivering multi-tenant monitoring for pervasive, context-driven network observability[![](/assets/images/video/DANZ-Video-Thumbnail.png)](https://www.youtube.com/embed/TfR0ngz8WwE?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [Multi-Cloud Director Data Sheet](/assets/data/pdf/Datasheets/Arista-Multi-Cloud-Director-Datasheet.pdf)

  Back
  + [7800R4 Series](#tab1551)
  + [7800R3 Series](#tab1566)

  + [7700R4 Series Overview](/en/products/7700r4-series)
  + [7700R4 Data Sheet](/assets/data/pdf/Datasheets/7700R4-Distributed-Etherlink-Switch-Datasheet.pdf)

  + [7500R3 Series](#tab592)
  + [7500R Series](#tab66)

  + [7388X5 Series](#tab1172)
  + [7368X4 Series](#tab569)
  + [7358X4 Series](#tab1176)
  + [7300X Series](#tab568)

  + [7280R3 Series](#tab596)
  + [7280R3 Modular Series](/products/7280r3-series/7280r3-modular)

  + [AWE 7200R Series Overview](/en/products/awe-7200r-series)
  + [AWE 7200R Data Sheet](/assets/data/pdf/Datasheets/AWE-7200R-Datasheet.pdf)

  + [7170 Series Overview](/en/products/7170-series)High Performance Multi-function Programmable Platforms[![](/assets/images/video/7170-Company-Page.png)](https://www.youtube.com/embed/eNo78PHYF5k?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7170 Quick Look](/en/products/7170-series-network-switch-datasheet)
  + [7170 Data Sheet](/assets/data/pdf/Datasheets/7170-Datasheet.pdf)
  + [7170B Data Sheet](/assets/data/pdf/Datasheets/7170B-Datasheet.pdf)
  + [7170 Profile Matrix](/en/support/product-documentation/supported-profile-features)

  + [7130 Series Overview](/en/products/7130-series)
  + [7130 Hardware](#tab486)
  + [7130 Applications](#tab490)
  + [7130 Developer](#tab548)

  + [7060X6 Series](#tab1587)
  + [7060X5 Series](#tab1185)
  + [7060X Series](#tab1184)

  + [7050X4 Series](#tab1180)
  + [7050X3 Series](#tab70)
  + [7050X Series](#tab71)

  + [7020R Series Overview](/en/products/7020r-series)High performance and deep buffer 1 & 10 GbE switch[![](/assets/images/video/7020R_Series.png)](https://www.youtube.com/embed/yIs3ZS0YZe0?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7020R Quick Look](/en/products/7020r-series-network-switch-datasheet)
  + [7020R Data Sheet](/assets/data/pdf/Datasheets/7020R-48_Datasheet.pdf)

  + [7010X Series Overview](/en/products/7010x-series)High performance and power efficient feature rich datacenter 1GbE switch with 25GbE uplinks[![](/assets/images/video/Mega-Menu-7010x.jpg)](https://www.youtube.com/embed/tsKIZDfV9qk?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7010X Data Sheet](/assets/data/pdf/Datasheets/7010TX-Datasheet.pdf)
  + [7010X Quick Look](/assets/data/pdf/Datasheets/7010X-Quick-Look.pdf)

  + [750 Series Overview](/en/products/750-series)Cognitive Campus Modular POE Leaf Switches[![](/assets/images/video/Campus-Modular-Leaf-Switches2.jpg)](https://www.youtube.com/embed/QxcPvf_jRmI?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [750 Data Sheet](/assets/data/pdf/Datasheets/CCS-750-Series-Datasheet.pdf)

  + [722XPM Series](#tab1274)
  + [720XP Series](#tab1275)

  + [720D Series Overview](/en/products/720d-series)Arista 720D Series Cognitive Campus POE Leaf Switches![](/assets/images/product/720D-Series-Menu.jpg)
  + [720D Data Sheet](/assets/data/pdf/Datasheets/CCS-720D-Datasheet.pdf)

  + [710P Series Overview](/en/products/710p-series)Compact, fanless, cognitive PoE switches[![](/assets/images/video/710P-Series-Intro.png)](https://www.youtube.com/embed/F4msz12fdc4?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [710P Data Sheet](/assets/data/pdf/Datasheets/CCS-710P-Datasheet.pdf)

  + [Leaf & Spine](#tab730)
  + [Spine & Routing](#tab731)
  + [Leaf & Routing](#tab732)

  + [Hyperscale Data Center](/en/products/hyperscale-data-center)![](/assets/images/product/Hyperscale-Data-Center.jpg)
  + [7700R4 Series](/en/products/7700r4-series)
  + [7368X4 & 7060X4 Series](#tab754)
  + [7260X3 Series](/en/products/7060x-series)
  + [7060X6 Series](/en/products/7060x6-series)
  + [7060X5 Series](/en/products/7060x5-series)
  + [7060X2 & 7060X Series](/en/products/7060x-series)

  + [Cloud Grade Routing](/en/products/cloud-grade-routing)![](/assets/images/product/Cloud-Grade-Routing.jpg)
  + [7800R3 Series](/en/products/7800r3-series)
  + [7500R3 Series](/en/products/7500r3-series)
  + [7280R3 Series](#tab765)
  + [7020R Series](/en/products/7020r-series)

  + [Spine & Edge Routing](#tab769)
  + [Wired](#tab775)
  + [Wireless](#tab1400)
  + [Network Access Control](/en/products/network-access-control)

  + [R-Series Spine & Leaf](/en/products/r-series-spine-leaf)![](/assets/images/product/R-Series.jpg)
  + [7800R3 Series](/en/products/7800r3-series)
  + [7500R3 Series](/en/products/7500r3-series)
  + [7280R3 Series](#tab787)
  + [7020R Series](/en/products/7020r-series)

  + [X-Series Spine & Leaf](/en/products/x-series-spine-leaf)![](/assets/images/product/X-Series.jpg)
  + [7300X Series](#tab792)
  + [7060X Series](#tab797)
  + [7050X Series](#tab803)

  + [Programmable](/en/products/programmable)![](/assets/images/product/Programmable.jpg)
  + [7170 Series](/en/products/7170-series)
  + [7130 Series](#tab810)

  + [7800R4 Series](/en/products/7800r4-series)
  + [7700R4 Series](/en/products/7700r4-series)
  + [7060X6 Series](/en/products/7060x6-series)

  + [400G Solutions](/en/products/400g-solutions)![](/assets/images/product/400G.jpg)
  + [7800R4 Series](/en/products/7800r4-series)
  + [7800R3 Series](/en/products/7800r3-series)
  + [7700R4 Series](/en/products/7700r4-series)
  + [7500R3 Series](/en/products/7500r3-series)
  + [7388X5 Series](/en/products/7388x5-series)
  + [7368X4 Series](/en/products/7368x4-series)
  + [7358X4 Series](/en/products/7358x4-series)
  + [7280R3 Series](/en/products/7280r3-series)
  + [7060X6 Series](/en/products/7060x6-series)
  + [7060X5 Series](/en/products/7060x5-series)
  + [7060X4 Series](/en/products/7060x-series)
  + [7050X4 Series](/en/products/7050x4-series)

  + [Flexible 10G & 1G Leaf](/en/products/flexible-10g-1g-leaf)![](/assets/images/product/10G-1G-Leaf.jpg)
  + [7020R Series](/en/products/7020r-series)
  + [7010X Series](/en/products/7010x-series)
  + [720XP Series](/en/products/720xp-series)

  + [Observability Overview](/en/solutions/network-observability)Pervasive network visibility, security monitoring and contextual analytics for networks at any scale![](/assets/images/product/observability_mm_banner.jpg)
  + [DANZ Monitoring Fabric](/en/products/danz-monitoring-fabric)

  + [Detection and Response Overview](/en/products/network-detection-and-response)Reduce business impact with AI-Driven security for the new network--campus, data center, IoT and cloud.![](/assets/images/logo/Arista-NDR-Thumbnail2.jpg)
  + [Security Services](/en/products/security-services)

  Back
  + [7800R4 Series Overview](/en/products/7800r4-series)
  + [7800R4 Data Sheet](/assets/data/pdf/Datasheets/7800R4-Series-AI-Spine-Datasheet.pdf)

  + [7800R3 Series Overview](/en/products/7800r3-series)Modular 100/400G Spine Switches[![](/assets/images/video/Introducing-the-7800R-Series.jpg)](https://www.youtube.com/embed/Z8VGvGuYw04?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7800R3 Quick Look](/en/products/7800r3-series-network-switch-quick-look)
  + [7800R3 Data Sheet](/assets/data/pdf/Datasheets/7800R3-Data-Sheet.pdf)

  + [7500R3 Series Overview](/en/products/7500r3-series)Modular 100/400G Spine Switches[![](/assets/images/video/Introducing-7500R3-video.png)](https://www.youtube.com/embed/2X0b5vDJcfs?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7500R3 Quick Look](/en/products/7500r3-series-network-switch-quick-look)
  + [7500R3 Data Sheet](/assets/data/pdf/Datasheets/7500R3-Data-Sheet.pdf)

  + [7500R Series Overview](/en/products/7500r-series)The industry’s highest performance universal spine and datacenter edge switches[![](/assets/images/video/Arista7500RDatacenterScale2017.png)](https://www.youtube.com/embed/KaEFvEib7WY?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7500R Quick Look](/en/products/7500r-series-network-switch-datasheet)
  + [7500R Data Sheet](/assets/data/pdf/Datasheets/7500RDataSheet.pdf)

  + [7388X5 Series Overview](/en/products/7388x5-series)400GbE and 200GbE modular solutions for hyperscale cloud networks and I/O intensive environments[![](/assets/images/video/400G-Expanded-Video.png)](https://www.youtube.com/embed/8QLWpKvkbEw?rel=0&wmode=transparent?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7388X5 Quick Look](/assets/data/pdf/Datasheets/7388X5-Series-Quick-Look.pdf)
  + [7388X5 Data Sheet](/assets/data/pdf/Datasheets/7388X5-Datasheet.pdf)

  + [7368X4 Series Overview](/en/products/7368x4-series)400GbE and 100GbE Modular solutions for hyperscale cloud and I/O intensive environments[![](/assets/images/video/Introducing-the-7368X4-Series.jpg)](https://www.youtube.com/embed/GkcI23iae98?rel=0&wmode=transparent?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7368X4 Quick Look](/en/products/arista-7368x4-series-datasheet-quick-look)
  + [7368X4 Data Sheet](/assets/data/pdf/Datasheets/7368X4-Datasheet.pdf)

  + [7358X4 Series Overview](/en/products/7358x4-series)400GbE and 100GbE modular solutions for large Enterprises, AI and ML environments[![](/assets/images/video/Arista-7050X4-7358X4-Series-Introduction.png)](https://www.youtube.com/embed/gFKzSm2j5pE?rel=0&wmode=transparent?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7358X4 Quick Look](/assets/data/pdf/Datasheets/7358X4-Series-Quick-Look.pdf)
  + [7358X4 Data Sheet](/assets/data/pdf/Datasheets/7358X4-Datasheet.pdf)

  + [7300X Series Overview](/en/products/7300-series)High Performance, high density and feature rich 10, 40, & 100GbE systems[![](/assets/images/video/7300X3-Video-Datasheet.jpg)](https://www.youtube.com/embed/WFTeB4sa6PQ?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7300 Quick Look](/en/products/7300x-series-network-switch-datasheet)
  + [7300 Data Sheet](/assets/data/pdf/Datasheets/7300X_DS.pdf)

  + [7280R3 Series Overview](/en/products/7280r3-series)Dynamic Deep Buffer 25/50/100/400G[![](/assets/images/video/Introducing-the-7280R3-Series2.jpg)](https://www.youtube.com/embed/4tVdVfCINXk?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7280R3 Data Sheet](/assets/data/pdf/Datasheets/7280R3-Data-Sheet.pdf)
  + [7280R3 Quick Look](/en/products/7280r3-series-network-switch-quick-look)
  + [7280R3A Data Sheet](/assets/data/pdf/Datasheets/7280R3A-Datasheet.pdf)
  + [7280R3A Quick Look](/en/products/7280r3a-series-data-center-switch-quick-look)
  + [7280R3 Modular Data Sheet](/assets/data/pdf/Datasheets/7280R3A-Modular-Datasheet.pdf)
  + [7280R3 Modular Quick Look](/en/products/7280r3a-modular-series-quick-look)

  + [7130 Hardware Overview](/en/products/7130-hardware)FPGA-enabled switches![](/assets/images/article/ip_cores.jpg)
  + [7130 Connect Series](/en/products/7130-connect)
  + [7130E Series](/en/products/7130e-series)
  + [7130L Series](/en/products/7130l-series)
  + [7130LBR Series](/en/products/7130lbr-series)
  + [7132LB Series](/en/products/7132lb-series)
  + [7135LB Series](/en/products/7135lb-series)

  + [7130 Applications Overview](/en/products/7130-applications)FPGA-based network applications![](/assets/images/article/development_kits.png)
  + [MetaWatch App](/en/products/7130-meta-watch)
  + [MetaMux App](/en/products/7130-meta-mux)
  + [MultiAccess App](/en/products/7130-multi-access)
  + [MetaProtect App](/en/products/7130-meta-protect)
  + [Exchange App](/en/products/7130-exchange-app)
  + [Switch App](/en/products/7130-switch-app)

  + [7130 Developer Overview](/en/products/7130-developer)Developer ecosystem![](/assets/images/article/Arista-7130-Developer-stock.png)
  + [IP Cores](/en/products/7130-ip-cores)
  + [Development Kits](/en/products/7130-development-kits)

  + [7060X6 Series Overview](/en/products/7060x6-series)Best of breed 800G solutions optimized for AI workloads and hyperscale cloud environments
  + [7060X6 Quick Look](/en/products/7060x6-series-quick-look)
  + [7060X6 Data Sheet](/assets/data/pdf/Datasheets/7060X6-Datasheet.pdf)

  + [7060X5 Series Overview](/en/products/7060x5-series)High Performance 400G solutions for hyperscale cloud networks and I/O intensive environments[![](/assets/images/video/400G-Expanded-Video.png)](https://www.youtube.com/embed/8QLWpKvkbEw?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7060X5 Quick Look](/assets/data/pdf/Datasheets/7060X4_7060X5-QuickLook.pdf)
  + [7060X5 Data Sheet](/assets/data/pdf/Datasheets/7060X5-Datasheet.pdf)

  + [7060X Series Overview](/en/products/7060x-series)25/100GbE and 10/40GbE Leaf and Spine solutions for cloud scale and open networking[![](/assets/images/video/7060X_Introduction1.png)](https://www.youtube.com/embed/MonBNjDni7U?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7060X & 7260X Quick Look](/en/products/7060x-and-7260x-series-network-switch-quick-look)
  + [7060X & 7260X Data Sheet](/assets/data/pdf/Datasheets/7060X_7260X_DS.pdf)

  + [7050X4 Series Overview](/en/products/7050x4-series)Versatile 100G / 400G leaf and spine switches with industry leading performance, rich features and power efficiency[![](/assets/images/video/Arista-7050X4-7358X4-Series-Introduction.png)](https://www.youtube.com/embed/gFKzSm2j5pE?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7050X4 Quick Look](/assets/data/pdf/Datasheets/7050X4-Series-Quick-Look.pdf)
  + [7050X4 Data Sheet](/assets/data/pdf/Datasheets/7050X4-Datasheet.pdf)

  + [7050X3 Series Overview](/en/products/7050x3-series)Versatile leaf and spine switches with industry leading performance, advanced features and power efficiency[![](/assets/images/video/Arista-7050X3-Series-Introduction-v2.png)](https://www.youtube.com/embed/ygRAgiNanmU?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7050X3 Quick Look](/en/products/7050x3-series-network-switch-datasheet)
  + [7050X3 Data Sheet](/assets/data/pdf/Datasheets/7050X3-Datasheet.pdf)

  + [7050X Series Overview](/en/products/7050x-series)Cloud scale fixed configuration leaf and spine switches[![](/assets/images/video/7050X_series_embed_play.png)](https://www.youtube.com/embed/R4ilmyYJkQU?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [7050X Quick Look](/en/products/7050x-series-network-switch-datasheet)
  + [7050X Data Sheet](/assets/data/pdf/Datasheets/7050TX-128_48_Datasheet_S.pdf)

  + [722XPM Series Overview](/en/products/722xpm-series)Secure Cognitive Campus POE Leaf Switches![](/assets/images/722x-mega-menu.png)
  + [722XPM Data Sheet](/assets/data/pdf/Datasheets/CCS-722XP-Datasheet.pdf)

  + [720XP Series Overview](/en/products/720xp-series)Cognitive Campus POE Leaf Switches[![](/assets/images/video/Arista-Campus-Leaf-Switches.jpg)](https://www.youtube.com/embed/PTbe-NNAqog?rel=0&wmode=transparent&modestbranding=1&showinfo=0)
  + [720XP Data Sheet](/assets/data/pdf/Datasheets/CCS-720XP-Datasheet.pdf)

  + [Leaf & Spine](/en/products/leaf-spine)![](/assets/images/product/UCN-Leaf-Spine.jpg)
  + [R Series](/en/products/r-series-spine-leaf)
  + [X Series](/en/products/x-series-spine-leaf)
  + [7170 Series](/en/products/7170-series)

  + [Spine & Routing](/en/products/spine-routing)![](/assets/images/product/UCN-Spine-Routing.jpg)
  + [7800R4 Series](/en/products/7800r4-series)
  + [7800R3 Series](/en/products/7800r3-series)
  + [7500R3 Series](/en/products/7500r3-series)
  + [7280R3 Modular Series](/products/7280r3-series/7280r3-modular)
  + [7368X4 Series](/en/products/7368x4-series)
  + [7300X3 Series](/en/products/7300-series)
  + [7300X Series](/en/products/7300-series)

  + [Leaf & Routing](/en/products/leaf-routing)![](/assets/images/product/UCN-Leaf-Routing.jpg)
  + [7280R3 Series](/en/products/7280r3-series)
  + [7280R3 Modular Series](/products/7280r3-series/7280r3-modular)
  + [7260X3 Series](/en/products/7060x-series)
  + [7060X4 Series](/en/products/7060x-series)
  + [7060X2 & 7060X Series](/en/products/7060x-series)
  + [7050X3 Series](/en/products/7050x3-series)
  + [7050X Series](/en/products/7050x-series)

  + [7368X4 Series](/en/products/7368x4-series)
  + [7060X4 Series](/en/products/7060x-series)

  + [7280R3 Series](/en/products/7280r3-series)
  + [7280R3 Modular Series](/products/7280r3-series/7280r3-modular)

  + [Spine & Edge Routing](/en/products/spine-edge-routing)![](/assets/images/product/Spine-Edge-Routing.jpg)
  + [7300X Series](/en/products/7300-series)
  + [7280R3 Series](/en/products/7280r3-series)
  + [7050X Series](/en/products/7050x-series)
  + [7020R Series](/en/products/7020r-series)

  + [Wired & Wireless](/en/products/wired-wireless)![](/assets/images/product/Wired-Wireless.jpg)
  + [7300X Series](/en/products/7300-series)
  + [7050X Series](/en/products/7050x-series)
  + [750 Series](/en/products/750-series)
  + [720XP Series](/en/products/720xp-series)
  + [722XPM Series](/en/products/722xpm-series)
  + [720D Series](/en/products/720d-series)
  + [710P Series](/en/products/710p-series)
  + [Cognitive Wi-Fi](/en/products/cloudvision-cue)

  + [Wi-Fi 6 Series](/en/products/wifi6-series)
  + [Wi-Fi 6E Series](/en/products/wifi6e-series)

  + [7280R3 Series](/en/products/7280r3-series)
  + [7280R3 Modular Series](/products/7280r3-series/7280r3-modular)

  + [7300X Series Spine](/en/products/7300x-series-spine)![](/assets/images/product/X-Series.jpg)
  + [7300X3 Series](/en/products/7300-series)
  + [7300X Series](/en/products/7300-series)

  + [7060X Series Spine](/en/products/7060x-series-spine)![](/assets/images/product/X-Series.jpg)
  + [7388X5 Series](/en/products/7388x5-series)
  + [7368X4 Series](/en/products/7368x4-series)
  + [7060X5 Series](/en/products/7060x5-series)
  + [7060X4 Series](/en/products/7060x-series)
  + [7260X3 Series](/en/products/7060x-series)
  + [7060X2 and 7060X](/en/products/7060x-series)

  + [7050X Series Spine](/en/products/7050x-series-spine)![](/assets/images/product/X-Series.jpg)
  + [7358X4 Series](/en/products/7358x4-series)
  + [7050X4 Series](/en/products/7050x4-series)
  + [7050X3 Series](/en/products/7050x3-series)
  + [7050X Series](/en/products/7050x-series)

  + [7130 Series Overview](/en/products/7130-series)
  + [7130 Hardware](/en/products/7130-hardware)
  + [7130 Applications](/en/products/7130-applications)
  + [7130 Developer](/en/products/7130-developer)
* Partner
  + [Partner Program](/en/partner/partner-program)
  + [Become a Partner](/en/partner/partner-application)
  + [Partner Code of Ethics and Business Conduct](/assets/data/pdf/Arista-Partner-Code-of-Ethics-and-Business-Conduct.pdf)
  + [Channel Partner Portal](/en/partner/partner-portal)
  + [Technology Partners](/en/partner/technology-partners)
* Support
  + [Support Overview](/en/support)
  + [Customer Support](/en/support/customer-support)
  + [Product Documentation](/en/support/product-documentation)
  + [Product Certifications](/en/support/product-certificate)
  + [Advisories & Notices](/en/support/advisories-notices)
  + [Product Lifecycle](/en/support/product-lifecycle)
  + [Software Download](/en/support/software-download)
  + [Transfer of Information](/en/support/toi)
  + [Support Portal](/en/community/support-portal)
  + [Training Partners](https://www.sdn-pros.com)
  + [Software Bug Portal](/en/support/software-bug-portal)
  + [CVP Upgrade Path](/en/support/cvp-upgrade-path)
  + [MLAG ISSU Check](/en/support/mlag-portal)
  + [Tech Library Portal](/en/tech-library)
* Company
  + [Company Overview](/en/company/company-overview)
  + [Corporate Responsibility](/en/company/corporate-responsibility)
  + [Management Team](/en/company/management-team)
  + [Blogs](https://blogs.arista.com/blog)
  + [Investor Relations](https://investors.arista.com)
  + [Events Calendar](https://events.arista.com/events-calendar)
  + [Webinars](/en/company/news/webinars)
  + [Video Library](/en/company/news/video-library)
  + [Testimonials](/en/company/customer-testimonials)
  + [Careers](/en/careers)
  + [News](/en/company/news)
  + [Contact Us](/en/company/contact-us)

* # Security Advisories

View All Support
X

* [Support Overview](/en/support)
* [Customer Support](/en/support/customer-support)
* [Product Documentation](/en/support/product-documentation)
* [Product Certifications](/en/support/product-certificate)
* [Advisories & Notices](/en/support/advisories-notices)
* [Product Lifecycle](/en/support/product-lifecycle)
* [Software Download](/en/support/software-download)
* [Transfer of Information](/en/support/toi)
* [Support Portal](/en/community/support-portal)
* [Training Partners](https://www.sdn-pros.com)
* [Software Bug Portal](/en/support/software-bug-portal)
* [MLAG ISSU Check](/en/support/mlag-portal)
* [CVP Upgrade Path](/en/support/cvp-upgrade-path)

## Security Advisory 0063 [PDF](/en/support/advisories-notices/security-advisory/12602-security-advisory-63?tmpl=component&format=pdf "PDF")

#### **Updated:** May 25th, 2021

| Revision | Date | Changes |
| --- | --- | --- |
| 1.0 | May 12th, 2021 | Initial Release |
| 1.1 | May 25th, 2021 | Updated assessment with impacted platforms, detection and mitigation. |
| 1.2 | June 9, 2021 | Updated assessment |
| 1.3 | August 19, 2021 | Updated affected platforms, fixed releases, and CVSS Scores |

### **Description**

This security advisory documents the exposure of Arista’s Wi-Fi products to multiple publicly documented security vulnerabilities related to packet fragmentation and aggregation, known as Fragmentation and Forge. These vulnerabilities impact any deployments using WEP, WPA, WPA2 and WPA3 security methods with any SSID. The vulnerabilities span multiple vectors and types of attack.

The vulnerabilities are documented by Arista under Bug 561363.

| **CVE** | **Description** | **CVSS** |
| --- | --- | --- |
| CVE-2020-24586 | During a connection/reconnection, fragments are cached in memory. This vulnerability can be used to inject fragmented packets; or to exfiltrate user data if the cache is accessed during the connection. | **3.5**  AV:A/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N |
| CVE-2020-24587 | When reassembling packets, the encryption key used on fragments is not required to be consistent. As a result, unrelated fragments can be mixed using valid keys. This requires a “Man in the Middle” presence level. | **2.6** AV:A/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N |
| CVE-2020-24588 | A payload protected wireless frame (PP A-MSDU) does not protect the Present subfield of the QoS header. As this subfield is not authenticated, the bit can be flipped to alter the aggregation status of the packet. | **3.5** AV:A/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N |
| CVE-2020-26139 | During the authentication process, the AP will forward EAPOL frames, prior to sender completing authentication. Allows for packet injection into an encrypted networking during authentication. | **5.3** AV:A/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H |
| CVE-2020-26140 | Plaintext data frames are accepted, despite network encryption. Allows for packet injection into an encrypted network. | **6.5** AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N |
| CVE-2020-26141 | If using Temporal Key Integrity Protocol (TKIP), the Message Integrity Check (MIC) will be skipped for fragmented frames. Can be leveraged for packet injection and decryption against an encrypted network. This CVE is not applicable to the Arista Wi-Fi Solution. | NA |
| CVE-2020-26142 | AP will treat fragmented frames as full frames. This CVE is not applicable to the Arista Wi-Fi Solution. | NA |
| CVE-2020-26143 | Plaintext data fragments are accepted, despite network encryption. Allows for packet injection into an encrypted network. | **6.5** AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N |
| CVE-2020-26144 | Plaintext A-MSDU frames are accepted on an encrypted network if the frame begins with an EAPOL LLC/Snap header. Allows for packet injection into an encrypted network. | **6.5** AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N |
| CVE-2020-26135 | If a fragmented multi-destination packet is received, it will be accepted on encrypted networks if the fragment is plaintext. Allows for packet injection into an encrypted network. | **6.5** AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N |
| CVE-2020-26146 | Encrypted fragments will be reassembled, even if they do not have consecutive packet numbers. When combined with fragment injection this can cause users to process malicious data. | **5.3** AV:A/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N |
| CVE-2020-26147 | Encrypted fragments will be reassembled, even if other fragments have been received plaintext. When combined with fragment injection this can cause users to process malicious data. | **5.4** AV:A/AC:H/PR:N/UI:R/S:U/C:L/I:H/A:N |

### **Symptoms**

The CVEs discussed primarily create opportunities for packet injection attack vectors:

* Adversaries can inject/cause receipt of arbitrary TCP/IP packets that were never sent by the legitimate client or AP.
* Adversaries can exfiltrate data under specific conditions.
* Adversary can make the victim use the adversary's DNS server and intercept the victim’s traffic.
* Adversaries can get access to victim’s TCP ports that have active services listening (portscan).
* Adversaries may target delivery of illegitimate TCP/IP packets to any routable network devices.
* Adversary may route malicious traffic over operator network (hotspot mode).

### **Vulnerability Assessment**

**Affected Software**

* All available versions of Wi-Fi AP software as per the impact matrix below

**Affected Platforms**

| **CVE ID** | **Access Points C-250 C-260  C-230 C-235  C-200** | **Access Points  C-120 C-130 C-100 C-110 O-105 W-118** | **Access Points C-75 O-90 C-65W-68** |
| --- | --- | --- | --- |
| CVE-2020-24586 | Y | N | N |
| CVE-2020-24587 | Y | Y | Y |
| CVE-2020-24588 | Y | Y | Y |
| CVE-2020-26139 | Y | Y | N |
| CVE-2020-26140 | N | N | Y |
| CVE-2020-26141 | N | N | N |
| CVE-2020-26142 | N | N | N |
| CVE-2020-26143 | N | N | Y |
| CVE-2020-26144 | Y | Y | Y |
| CVE-2020-26145 | Y | Y | Y |
| CVE-2020-26146 | Y | Y | Y |
| CVE-2020-26147 | N | N | Y |

**Mitigation**

As a security best practice, it is recommended to restrict public access to internal devices to safeguard from potential attacks. A machine-in-the-middle (MitM) attack is required to reliably exploit many of these vulnerabilities (except those applicable to the hotspot scenarios). In this type of attack the adversary sets up a clone of the real AP on a different channel and the client connects to this attacker’s clone instead of the real AP. This enables the attacker to block or modify 802.11 frames.

Arista Access Points are already capable of detecting Rogue APs spoofing the MAC address of a legitimate AP. They can also launch an automatic mitigation session in some cases to prevent legitimate clients from connecting to the Rogue AP. Arista AP models equipped with a dedicated scanning radio are capable of this detection and prevention features by scanning the entire spectrum.

Arista overlay WIPS solution can also detect and mitigate the Rogue AP spoofing attacks.

We recommend enabling the following WIPS settings if they are not already enabled:

**Configure > Alerts > MAC Spoofing > AP MAC Spoofing**

Enable “Display” and “Affects Security Status”:

![](/assets/images/article/SA0063-1.png)

**Configure > WIPS > Automatic Intrusion Detection > MAC Spoofing**

Enable “Spoofing of an Authorized Access Point MAC address”:

![](/assets/images/article/SA0063-2.png)

As a full resolution against this vulnerability, refer to the next section for remediated software versions and hotfix details.

**Resolution**

This vulnerability is tracked by Bug 561363 and can manifest in any environment leveraging WEP, WPA, WPA2 and WPA3 security methods with any SSID for encryption. Arista is actively working with our chip vendors on incorporating fixes into Arista CloudVision Wi-Fi AP software. A new AP software version which addresses the above vulnerabilities will be released by Arista. This will be a regular upgrade similar to other new version upgrades. Arista will notify all customers and partners once the new version with the fixes is released and available. The recommended course of action is to install the provided hotfix or upgrade to a remediated CloudVision Wi-Fi AP software version once available.

| Platform | Fixed Version | Release Date |
| --- | --- | --- |
| **C-260** | **10.0.1-31** | **July 27, 2021** |
| **C-250** | **10.0.1-31** | **July 27, 2021** |
| **C-230** | **10.0.1-31** | **July 27, 2021** |
| **C-200** | **11.0.0-36** | **August 30, 2021** |
| **C-130** | **11.0.0-36** | **August 30, 2021** |
| **C-120** | **11.0.0-36** | **August 30, 2021** |
| **C-110** | **11.0.0-36** | **August 30, 2021** |
| **C-100** | **11.0.0-36** | **August 30, 2021** |
| *C-75* | *TBD* | *TBD* |
| *C-65* | *TBD* | *TBD* |
| **O-235** | **10.0.1-31** | **July 27, 2021** |
| **O-105** | **11.0.0-36** | **August 30, 2021** |
| *O-90* | *TBD* | *TBD* |
| **W-118** | **11.0.0-36** | **August 30, 2021** |
| *W-68* | *TBD* | *TBD* |

Arista will notify all customers and partners as new versions with the fixes are released and available.

For instructions on how to upgrade APs, please refer to the following resources:

* [On-prem deployments](https://arista.my.site.com/AristaCommunity/s/article/How-to-Upgrade-Access-Points-to-a-Specific-Build-On-Premise)
* [On-prem and Cloud deployments](/support/toi/cvw-8-8-0/14244-hitless-wifi-ap-upgrades)

**For More Information**

To read more about this vulnerability, please refer to the following links:

<https://www.icasi.org/aggregation-fragmentation-attacks-against-wifi/>

If you require further assistance, or if you have any further questions regarding this security notice, please contact the Arista Networks Technical Assistance Center (TAC) by one of the following methods:

#### **Open a Service Request**

By email: This email address is being protected from spambots. You need JavaScript enabled to view it.
By telephone: 408-547-5502 ; 866-476-0000

Get In Touch Today
[Contact Us](/en/company/contact-us)

![Arista](/templates/arista_v2/img/logo_arista_blue.png)
[Facebook](https://www.facebook.com/AristaNW) [Twitter](https://twitter.com/%40AristaNetworks) [LinkedIn](http://www.linkedin.com/company/arista-networks-inc)

* Support
  + [Support & Services](/en/support/customer-support)
  + [Training Partners](https://www.sdn-pros.com)
  + [Product Documentation](/en/support/product-documentation)
  + [Software Downloads](/en/support/software-download)
* Contacts & Help
  + [Contact Arista](/en/company/contact-us)
  + [Contact Technical Support](/en/support/customer-support)
  + [Order Status](https://orders.arista.com)
* News
  + [News Room](/en/company/news/in-the-news)
  + [Events Calendar](https://events.arista.com/events-calendar)
  + [Blogs](/blogs)
* About Arista
  + [Company](/en/company/company-overview)
  + [Management Team](/en/company/management-team)
  + [Careers](/en/careers)
  + [Investor Relations](http://investors.arista.com/)

© 2025 Arista Networks, Inc. All rights reserved.

* [Terms of Use](/en/terms-of-use)
* [Privacy Policy](/en/privacy-policy)
* [Fraud Alert](/en/fraud-alert)
* [Sitemap](/en/sitemap)



=== Content from bst.cloudapps.cisco.com_cdd4d147_20250119_140745.html ===


Back

US

EN

×

Your email address belongs to an organization that also manages
your Cisco account login.

Log in to your organization to also log in to Cisco.

Organization Log In

×

Description here

Contact Support
[Privacy](https://www.cisco.com/c/en/us/about/legal/privacy-full.html)
[Terms &
Conditions](https://www.cisco.com/c/en/us/about/legal/terms-conditions.html)
[Cookies](https://www.cisco.com/c/en/us/about/legal/privacy-full.html#cookies)
[Trademarks](http://www.cisco.com/web/siteassets/legal/trademark.html)
[京ICP备05085544号-1](http://beian.miit.gov.cn)

## Cookies are required

Cookies are disabled on your browser. Please enable Cookies and refresh this page.

[Refresh](.)

![Cisco Identity](https://id.cisco.com/fs/bco/1/fs0a411g73DFKaj7K5d7)

## The page has timed out

If this page does not reload automatically, please refresh your browser.



=== Content from www.fragattacks.com_b269443a_20250119_122954.html ===

![](images/logo.png)

### by [@vanhoefm](https://twitter.com/vanhoefm) of [KU Leuven](https://distrinet.cs.kuleuven.be/) / [NYU Abu Dhabi](https://nyuad.nyu.edu/en/research/faculty-labs-and-projects/nyuad-ccs.html)

Navigate page

* [Intro](#intro)
* [Demo](#demo)
* [Details](#details)
* [Paper](#paper)
* [Tools](#tools)
* [Q&A](#faq)

## [Introduction](#intro)

11 May 2021 —
This website presents FragAttacks (**fr**agmentation
and **ag**gregation **attacks**) which is a collection of new
security vulnerabilities that affect Wi-Fi devices. An adversary that is within range of a victim's Wi-Fi network can abuse these
vulnerabilities to steal user information or attack devices. Three of the discovered vulnerabilities are design flaws in the
Wi-Fi standard and therefore affect most devices. On top of this, several other vulnerabilities were discovered that are
caused by widespread programming mistakes in Wi-Fi products. Experiments indicate that every Wi-Fi product is affected
by at least one vulnerability and that most products are affected by several vulnerabilities.

The discovered vulnerabilities affect all modern security protocols of Wi-Fi, including the latest WPA3 specification.
Even the original security protocol of Wi-Fi, called WEP, is affected. This means that several of the newly discovered
design flaws have been part of Wi-Fi since its release in 1997!
Fortunately, the **design flaws are hard to abuse** because doing so requires user interaction or is only
possible when using uncommon network settings.
As a result, in practice the **biggest concern are the programming mistakes in Wi-Fi products** since
several of them are trivial to exploit.

The discovery of these vulnerabilities comes as a surprise, because the security of Wi-Fi has in fact significantly
improved over the past years.
For instance, previously we discovered the [KRACK attacks](https://www.krackattacks.com/), the defenses
against KRACK were [proven secure](https://www.usenix.org/conference/usenixsecurity20/presentation/cremers),
and the latest WPA3 security specification has [improved](https://www.wi-fi.org/file/wi-fi-security-roadmap-and-wpa3-updates-december-2020).
Unfortunately, a feature that could have prevented one of the newly discovered design flaws was not adopted in practice,
and the other two design flaws are present in a feature of Wi-Fi that was previously not widely studied.
This shows it stays important to analyze even the most well-known security protocols (if you want to help,
we are [hiring](#hiring)). Additionally, it shows that it's essential to regularly
test Wi-Fi products for security vulnerabilities, which can for instance be done when certifying them.

To protect users, security updates were prepared during a 9-month-long coordinated disclosure that was supervised by
the [Wi-Fi Alliance](https://www.wi-fi.org/security-update-fragmentation) and
[ICASI](https://www.icasi.org/aggregation-fragmentation-attacks-against-wifi/). If updates for your device
are not yet available, you can [mitigate](#notpatched) some attacks (but not all)
by assuring that websites use HTTPS and by assuring that your devices received all other available updates.

The research will be presented at the [USENIX Security](#usenixpres) conference and a longer talk with more background will also be given at
[Black Hat USA](https://blackhat.com/us-21/briefings/schedule/index.html#fragattacks-breaking-wi-fi-through-fragmentation-and-aggregation-23518)
this summer.

## [Demo](#demo)

The following video shows three examples of how an adversary can abuse the vulnerabilities. First,
the aggregation design flaw is abused to intercept sensitive information (e.g. the victim's username and password).
Second, it's shown how an adversary can exploit insecure internet-of-things
devices by remotely turning on and off a smart power socket. Finally, it's demonstrated how the
vulnerabilities can be abused as a stepping stone to launch advanced attacks. In particular, the video shows how an adversary
can take over an outdated Windows 7 machine inside a local network.

As the demo illustrates, the Wi-Fi flaws can be abused in two ways. First, under the right conditions they can be abused
to steal sensitive data. Second, an adversary can abuse the Wi-Fi flaws to attack devices in someone's home network.

The biggest risk in practice is likely the ability to abuse the discovered flaws to attack devices in someone's home network.
For instance, many smart home and [internet-of-things](https://en.wikipedia.org/wiki/Internet_of_things#Consumer_applications)
devices are rarely updated, and Wi-Fi security is the last line of defense that prevents someone from attacking
these devices. Unfortunately, due to the discover vulnerabilities, this last line of defense can now be bypassed.
In the demo above, this is illustrated by remotely controlling a smart power plug and by taking over an outdated Windows 7 machine.

The Wi-Fi flaws can also be abused to exfiltrate transmitted data. The demo shows how this can be abused to learn
the username and password of the victim when they use the NYU website. However, when a website is configured with
[HSTS](https://www.eff.org/deeplinks/2014/02/websites-hsts) to always
use [HTTPS](https://en.wikipedia.org/wiki/HTTPS) as an extra layer of security, which nowadays
[close](https://www.troyhunt.com/padlocks-phishing-and-privacy-the-value-proposition-of-a-vpn/#1-https-still-has-a-long-way-to-go)
[to](https://twitter.com/Scott_Helme/status/1305605547106983951)
[20%](https://w3techs.com/technologies/details/ce-hsts) of websites are,
the transmitted data cannot be stolen.
Additionally, several browsers now [warn](https://www.blog.google/products/chrome/milestone-chrome-security-marking-http-not-secure)
the user when HTTPS is not being used.
Finally, although [not always](https://www.usenix.org/conference/usenixsecurity21/presentation/oltrogge) perfect,
recent mobile apps by default use HTTPS and therefore also use this extra protection.

## [Details](#details)

### [Presentations](#presentations)

If you don't want to read the following text, you can also watch my [USENIX Security](#usenixpres)
or [WAC4](#wac4pres) presentation.

### [Plaintext injection vulnerabilities](#plaininject)

Several implementation flaws can be abused to easily inject frames into a protected Wi-Fi network. In particular, an adversary
can often inject an unencrypted Wi-Fi frame by carefully constructing this frame. This can for instance be abused to
intercept a client's traffic by tricking the client into using a [malicious DNS server](#extradocs) as shown in the
[demo](#demo) (the intercepted traffic may have [another layer of protection](https://en.wikipedia.org/wiki/HTTPS) though).
Against routers this can also be abused to [bypass the NAT/firewall](#extadocs), allowing the adversary to
subsequently attack devices in the local Wi-Fi network (e.g. attacking an outdated Windows 7 machine as shown in the [demo](#demo)).

How can the adversary construct unencrypted Wi-Fi frames so they are accepted by a vulnerable device?
First, certain Wi-Fi devices **accept any unencrypted frame even when connected to a protected Wi-Fi network**.
This means the attacker doesn't have to do anything special!
Two of out of four tested home routers were affected by this vulnerability, several internet-of-things devices were affected,
and some smartphones were affected. Additionally, many Wi-Fi dongles on Windows will wrongly accept plaintext frames when
they are split into several (plaintext) fragments.

Additionally, certain devices **accept plaintext aggregated frames that look like handshake messages**.
An adversary can exploit this by sending an aggregated frame whose starts resembles a handshake message and whose second
subframe contains the packet that the adversary wants to inject.
A vulnerable device will first interpret this frame as a handshake message, but will subsequently process it as an aggregated frame.
In a sense, one part of the code will think the frame is a handshake message and will accept it even though it's not encrypted.
Another part of the code will instead see it as an aggregated frame and will process the packet that the adversary wants to inject.

![](images/tenor.gif)

A plaintext aggregated frame that also looks like a handshake message ☺

Finally, several devices process broadcasted fragments as normal unfragmented frames. More problematic, some devices
**accept broadcast fragments even when sent unencrypted**.
An attacker can abuse this to inject packets by encapsulating them in the second fragment of a plaintext broadcast frame.

### [Design flaw: aggregation attack](#aggregationattack "CVE-2020-24588")

The first design flaw is in the frame aggregation feature of Wi-Fi. This feature increases the speed and throughput of a network
by combining small frames into a larger aggregated frame. To implement this feature, the header of each frame contains a flag that
indicates whether the (encrypted) transported data contains a single or aggregated frame. This is illustrated in the following figure:

Unfortunately,
this **"is aggregated" flag is not authenticated** and can be modified by an adversary, meaning a victim can
be tricked into processing the encrypted transported data in an unintended manner. An adversary can abuse this to inject
arbitrary network packets by tricking the victim into connecting to their server and then setting the "is aggregated" flag
of carefully selected packets. Practically all tested devices were vulnerable to this attack. The ability to inject packets
can in turn be abused to intercept a victim’s traffic by making it use a malicious DNS server (see the [demo](#demo)).

This design flaw can be fixed by authenticating the "is aggregated" flag. The Wi-Fi standard already contains a feature to
authenticate this flag, namely requiring SPP A-MSDU frames, but this defense is not backwards-compatible and not supported
in practice. Attacks can also be mitigated using an ad-hoc fix, though new attacks may remain possible.

### [Design flaw: mixed key attack](#mixedkeyattack "CVE-2020-24587")

The second design flaw is in the frame fragmentation feature of Wi-Fi. This feature increases the reliability of a connection
by splitting large frames into smaller fragments. When doing this, every fragment that belongs to the
same frame is encrypted using the same key. However, receivers are not required to check this and will **reassemble fragments
that were decrypted using different keys**.
Under rare conditions this can be abused to exfiltrate data. This is accomplished by mixing fragments that are encrypted under different keys,
as illustrated in the following figure:

In the above figure, the first fragment received by the access point is decrypted using a different key
than the second fragment. Nevertheless, the victim will reassemble both fragments. In practice this allows
an adversary to exfiltrate selected client data.

This design flaw can be fixed in a backwards-compatible manner by only reassembling fragments
that were decrypted using the same key.
Because the attack is only possible under rare conditions **it is considered a theoretical attack**.

### [Design flaw: fragment cache attack](#fragcacheattack "CVE-2020-24586")

The third design flaw is also in Wi-Fi's frame fragmentation feature. The problem is that, when a client disconnects
from the network, the Wi-Fi device is **not required to remove non-reassembled fragments from memory**.
This can be abused against hotspot-like networks such as [eduroam and govroam](https://en.wikipedia.org/wiki/Eduroam)
and against enterprise network where users distrust each other. In those cases, selected data sent by the victim can be
exfiltrated. This is achieved by injecting a malicious fragment in the memory (i.e. fragment cache) of the access point.
When the victim then connects to the access point and sends a fragmented frame, selected fragments will be combined (i.e. reassembled)
with the injected fragment of the adversary. This is illustrated in the following figure:

In the above figure, the adversary injects the first fragment into the fragment cache of the access point. After the
adversary disconnects the fragment stays in the fragment cache and will be reassembled with a fragment of the victim.
If the victim sends fragmented frames, which appears uncommon in practice, this can be abused to exfiltrate data.

This design flaw can be fixed in a backwards-compatible manner by removing fragments from memory whenever disconnecting
or (re)connecting to a network.

### [Other implementation vulnerabilities](#codeflaws)

Some routers will forward handshake frames to another client even when the sender hasn't
authenticated yet. This vulnerability allows an adversary to perform the aggregation attack,
and inject arbitrary frames, without user interaction.

Another extremely common implementation flaw is that receivers do not check whether all
fragments belong to the same frame, meaning an adversary can trivially forge frames by mixing the fragments of two
different frames.

Additionally, against several implementations it is possible to mix encrypted and plaintext fragments.

Finally, some devices don't support fragmentation or aggregation, but are still vulnerable to attacks
because they process fragmented frames as full frames. Under the right circumstances this
can be abused to inject packets.

### [Assigned CVE identifiers](#cves)

An overview of all assigned Common Vulnerabilities and Exposures (CVE) identifiers can be found
[on GitHub](https://github.com/vanhoefm/fragattacks/blob/master/SUMMARY.md),
and there is a list of [known advisories](https://github.com/vanhoefm/fragattacks/blob/master/ADVISORIES.md) from companies.
Summarized, the design flaws were assigned the following CVEs:

* [CVE-2020-24588](https://nvd.nist.gov/vuln/detail/CVE-2020-24588): aggregation attack (accepting non-SPP A-MSDU frames).
* [CVE-2020-24587](https://nvd.nist.gov/vuln/detail/CVE-2020-24587): mixed key attack (reassembling fragments encrypted under different keys).
* [CVE-2020-24586](https://nvd.nist.gov/vuln/detail/CVE-2020-24586): fragment cache attack (not clearing fragments from memory when (re)connecting to a network).

Implementation vulnerabilities that allow the trivial injection of plaintext frames in a protected Wi-Fi network are assigned the following CVEs:

* [CVE-2020-26145](https://nvd.nist.gov/vuln/detail/CVE-2020-26145): Accepting plaintext broadcast fragments as full frames (in an encrypted network).
* [CVE-2020-26144](https://nvd.nist.gov/vuln/detail/CVE-2020-26144): Accepting plaintext A-MSDU frames that start with an RFC1042 header with EtherType EAPOL (in an encrypted network).
* [CVE-2020-26140](https://nvd.nist.gov/vuln/detail/CVE-2020-26140): Accepting plaintext data frames in a protected network.
* [CVE-2020-26143](https://nvd.nist.gov/vuln/detail/CVE-2020-26143): Accepting fragmented plaintext data frames in a protected network.

Other implementation flaws are assigned the following CVEs:

* [CVE-2020-26139](https://nvd.nist.gov/vuln/detail/CVE-2020-26139): Forwarding EAPOL frames even though the sender is not yet authenticated (should only affect APs).
* [CVE-2020-26146](https://nvd.nist.gov/vuln/detail/CVE-2020-26146): Reassembling encrypted fragments with non-consecutive packet numbers.
* [CVE-2020-26147](https://nvd.nist.gov/vuln/detail/CVE-2020-26147): Reassembling mixed encrypted/plaintext fragments.
* [CVE-2020-26142](https://nvd.nist.gov/vuln/detail/CVE-2020-26142): Processing fragmented frames as full frames.
* [CVE-2020-26141](https://nvd.nist.gov/vuln/detail/CVE-2020-26141): Not verifying the TKIP MIC of fragmented frames.

For each implementation vulnerability we listed the reference CVE identifier.
Although each affected codebase normally receives a unique CVE,
the agreement between affected vendors was that, in this specific case,
using the same CVE across different codebases would make communication easier.
For instance, by tying one CVE to each vulnerability, a customer can now ask a vendor
whether their product is affected by a specific CVE.

Please note that this deviates from normal MITRE guidelines, and that this decision was made
by affected vendors independently of MITRE, and that this in no way reflects any changes in how MITRE assigns CVEs.

## [Paper](#paper)

Our paper behind the attack is titled
[Fragment and Forge: Breaking Wi-Fi Through Frame Aggregation and Fragmentation](https://papers.mathyvanhoef.com/usenix2021.pdf)
and was presented at [USENIX Security](https://www.usenix.org/conference/usenixsecurity21/presentation/vanhoef).
You can use the following bibtex entry to cite our paper:

```
@inproceedings{vanhoef-usenix2021-fragattacks,
  author = {Mathy Vanhoef},
  title = {Fragment and Forge: Breaking {Wi-Fi} Through Frame Aggregation and Fragmentation},
  booktitle = {Proceedings of the 30th {USENIX} Security Symposium},
  year = {2021},
  month = {August},
  publisher = {{USENIX} Association}
}
```
### [Paper Clarifications](#papernotes)

* In the paper in Section 6 regarding implementation vulnerabilities, when a tested device accepts plaintext frames, it will also accepted fragmented plaintext frames (Table 1, 2, and 3).

### [USENIX Security Presentation](#usenixpres)

The pre-recorded presentation made for USENIX Security can already be viewed online. Note that the target audience
of this presentation are academics and IT professionals:

### [Workshop on Attacks on Cryptography Presentation](#wac4pres)

A longer presentation that covers more details is the one that I gave at the WAC4 workshop:

### [Extra Documents](#extadocs)

* An [overview](https://papers.mathyvanhoef.com/fragattacks-overview.pdf) of all
  **attacks and their preconditions**. It also contains two extra examples on how an
  adversary can: (1) abuse packet injection vulnerabilities to make a victim use a malicious DNS; and
  (2) how packet injection can be abused to bypass the NAT/firewall of a router.
* [Slides](https://papers.mathyvanhoef.com/fragattacks-slides-amsdu.pdf) illustrating
  how the aggregation attack (CVE-2020-24588) works in practice. Performing this attack requires tricking
  the victim into connecting to the adversary's server. This can be done by making the victim download an
  image from the adversary’s server. Note that JavaScript code execution on the victim is not required.
* [Detailed slides](https://papers.mathyvanhoef.com/fragattacks-slides-2021-03-8.pdf)
  giving an in-depth explanation of each discovered vulnerability.* [Overview slides](https://papers.mathyvanhoef.com/fragattacks-slides-summary-2021-03-8.pdf)
    illustrating only the root cause of each discovered vulnerability.

## [Tools](#tools)

A [tool was made](https://github.com/vanhoefm/fragattacks) that can test if clients or APs are
affected by the discovered design and implementations flaws. It can test home networks and enterprise networks where
authentication is done using, e.g., PEAP-MSCHAPv2 or EAP-TLS. The **tool supports over 45 test cases** and requires modified
drivers in order to reliable test for the discovered vulnerabilities. Without modified drivers, one may wrongly conclude
that a device is not affected while in reality it is.

A **live USB image** is [also available](https://github.com/vanhoefm/fragattacks#id-live-image).
This image contains pre-installed modified drivers, modified firmware for certain Atheros USB dongles, and a
pre-configured Python environment for the tool. Using a live image is useful when you cannot install the modified
drivers natively (and using a virtual machine can be unreliable for some network cards).

Apart from a tool to test if a device is vulnerable I also made proof-of-concepts to exploit weaknesses. Because not all
devices currently have received updates these attacks scripts will be released at a later point if deemed useful.

## [Q&A](#faq)

* [How can I contact you?](#contact)
* [Are you looking for PhD students?](#hiring)
* [Can I reuse the images on this website?](#images)
* [Why did nobody notice the aggregation design flaw before?](#ieeenoticed)
* [Why was the defense against the aggregation attack (CVE-2020-24588) not adopted?](#whynotadopted)
* [My device isn't patched yet, what can I do?](#notpatched)
* [Does using EAP-TLS increase the difficulty of attacks?](#eaptls)
* [Does using 802.11w help mitigate attacks?](#mfp)
* [Why is Wi-Fi security important? We already have HTTPS.](#whyimportant)
* [Will using a VPN prevent attacks?](#vpn)
* [How did you discover this?](#howfound)
* [How sure are you that all Wi-Fi devices are affected?](#allaffected)
* [Does this mean every Wi-Fi device is trivial to attack?](#istrivial)
* [How many networks use fragmentation?](#usagefrag)
* [How many networks periodically refresh the pairwise session key?](#usagerenew)
* [Isn't it irresponsible to release tools to perform the attacks?](#abusetools)
* [Where are all the attack tools?](#attacktools)
* [Do you have example network captures of the vulnerabilities?](#captures)
* [How long will you maintain the driver patches needed to run the test scripts?](#maintaindriver)
* [Why are so many implementations vulnerable to be non-consecutive PN attack?](#nonsecdesign)
* [Why are so many implementations vulnerable to the mixed plaintext/encrypted fragment attack?](#mixeddesign)
* [Can an implementation be vulnerable to a cache attack without being vulnerable to a mixed key attack?](#cachenotmixed)
* [Can the mixed-key attack be prevented in a backward-compatible manner?](#mixedbackward)
* [Is the old WPA-TKIP protocol also affected by the design flaws?](#tkip)
* [Is the ancient WEP protocol also affected by the design flaws?](#wep)
* [Can fragmentation attacks be preventing by disallowing small delays between fragments?](#fragdelays)
* [Are patches for Linux available?](#patchlinux)
* [Did others also discover the plaintext injection issue (CVE-2020-26140)?](#plainothers)
* [Why do you use the same CVE for implementation issues in multiple different codebases?](#samecves)
* [Why was the embargo so long?](#longembargo)
* [How did you monitor for leaks during the embargo?](#detectleaks)
* [Are these vulnerabilities being exploited in practice?](#beingexploit)
* [Why did Microsoft already fix certain vulnerabilities on March 9, 2021?](#microsoft)
* [Is the "Treating fragments as full frames" flaw (CVE-2020-26142) also applicable to APs?](#apfragasfull)
* [Can APs be vulnerable to attacks that send broadcast frames?](#aprecievebcast)
* [Why are some of the tested devices so old?](#whyold)
* [How did you make macOS switch to the malicious DNS server in the demonstration?](#forcebaddns)
* [Isn't nyu.edu using HSTS to prevent these kind of attacks?](#nyuhsts)
* [How do I reproduce the BlueKeep attack shown in the demonstration?](#bluekeep)

### [How can I contact you?](#contact)

You can reach Mathy Vanhoef on twitter at [@vanhoefm](https://www.twitter.com/vanhoefm)
or by emailing mathy.vanhoef@nyu.edu.

### [Are you looking for PhD students?](#hiring)

Yes! Mathy Vanhoef will be starting as a professor at KU Leuven University (Belgium) later this year and is
looking for a **PhD student**. The precise topic you want to work on can be discussed. If you're
a master student at KU Leuven you can also contact me to discuss a **Master's thesis** topic.
Note that the [DistriNet](https://distrinet.cs.kuleuven.be/jobs/) group at KU Leuven is also recruiting
in security-related research fields.

If you want to do network research at New York University Abu Dhabi in the
[Cyber Security & Privacy (CSP)](https://nyuad.nyu.edu/en/research/faculty-labs-and-projects/cybersecurity-and-privacy-lab.html)
team where the FragAttacks research was carried out, you can contact [Christina Pöpper](https://poepper.net/).

### [Can I reuse the images on this website?](#images)

Yes, you can use the [logo](images/logo.png), illustrations of the [aggregation](images/aggregated.png)
design flaw ([mobile version](images/aggregatedsmall.png)),
illustrations of the [mixed key](images/mixedkey.png) design flaw ([mobile version](images/mixedkeysmall.png)),
and illustrations of the [fragment cache](images/fragmentcache.png) design flaw ([mobile version](images/fragmentcachesmall.png)).

Thanks goes to [Darlee Urbiztondo](https://www.thehappylee.com/graphic-design-projects) for designing the logo.

### [Why did nobody notice the aggregation design flaw before?](#ieeenoticed)

When the 802.11n amendment was being written in 2007, which introduced supported for aggregated (A-MSDU) frames,
[several IEEE members](https://mentor.ieee.org/802.11/dcn/07/11-07-0397-07-000n-msdu-protection.doc)
noticed that the "is aggregated" flag was not authenticated. Unfortunately, many products already implemented
a draft of the 802.11n amendment, meaning this problem had to be addressed in a backwards-compatible manner.
The decision was made that devices would advertise whether they are capable of authenticating the "is aggregated"
flag. Only when devices implement and advertise this capability is the "is aggregated" flag protected. Unfortunately,
in 2020 not a single tested device supported this capability, likely because it was considered hard to exploit.
[To quote](https://mentor.ieee.org/802.11/dcn/07/11-07-0397-07-000n-msdu-protection.doc) a remark
made back in 2007:
*"While it is hard to see how this can be exploited, it is clearly a flaw that is capable of being fixed."*

In other words, people did notice this vulnerability and a defense was standardized, but in practice the defense
was never adopted. This is a good example that security defenses must be adopted before attacks become practical.

### [Why was the defense against the aggregation attack (CVE-2020-24588) not adopted?](#whynotadopted)

Likely because it was only considered a theoretic vulnerability when the defense was created.
[To quote](https://mentor.ieee.org/802.11/dcn/07/11-07-0397-07-000n-msdu-protection.doc) a remark
made back in 2007:
*"While it is hard to see how this can be exploited, it is clearly a flaw that is capable of being fixed."*

Additionally, the threat model that was used in the aggregation attack, were the victim is induced into connecting to the
adversary's server, only become widely accepted in 2011 after the disclosure of the [BEAST](https://en.wikipedia.org/wiki/Transport_Layer_Security#BEAST_attack)
attack. In other words, the threat model was not yet widely known back in 2007 when the IEEE added the optional feature
that would have prevented the attack. And even after this threat model became more common,
the resulting attack isn't obvious.

### [My device isn't patched yet, what can I do?](#notpatched)

First, it's always good to remember general security best practices: update your devices, don't reuse your passwords,
make sure you have backups of important data, don't visit shady websites, and so on.

In regards to the discovered Wi-Fi vulnerabilities, you can mitigate attacks that exfiltrate sensitive data by
double-checking that websites you are visiting
[use HTTPS](https://www.blog.google/products/chrome/milestone-chrome-security-marking-http-not-secure).
Even better, you can install the [HTTPS Everywhere](https://www.eff.org/https-everywhere) plugin. This plugin
forces the usage of HTTPS on websites that are known to support it.

To mitigate attacks where your router's NAT/firewall is bypassed and devices are directly attacked, you must assure that
all your devices are updated. Unfortunately, not all products regularly receive updates, in particular smart or internet-of-things
devices, in which case it is difficult (if not impossible) to properly secure them.

More technically, the impact of attacks can also be reduced by manually configuring your DNS server so that it cannot be poisoned.
Specific to your Wi-Fi configuration, you can mitigate attacks (but not fully prevent them) by disabling fragmentation,
disabling pairwise rekeys, and disabling dynamic fragmentation in Wi-Fi 6 (802.11ax) devices.

### [Does using EAP-TLS increase the difficulty of attacks?](#eaptls)

No. All attacks are possible no matter how the client authenticates the network. In other words, attacks are identical
against home and enterprise networks. Moreover, it doesn't matter which EAP method you use in an enterprise network:
all attacks remain possible and can be abused in exactly the same manner.

Important to remark is that exploiting the design flaws relies on a multi-channel machine-in-the-middle position
(and abusing CVE-2020-26146 relies on this MitM as well). This MitM is not a traditional rogue AP. Instead, the attacker
is copying all frames from the real AP to a different Wi-Fi channel. This can be done no matter which authentication method
the network is using. You can read more about this MitM in
[my blog post](https://www.mathyvanhoef.com/2021/05/fragattacks-clarifying-some-aspects.html#rogue-ap).

### [Does using 802.11w help mitigate attacks?](#mfp)

No. Using 802.11w, also known as management frame protection, has no impact on any of the attacks. Even attacks that rely
on the multi-channel machine-in-the-middle position (i.e. the design flaws and CVE-2020-26146) remain possible when using 802.11w.
This is because this MitM isn't established
by sending deauthentication or disassociation frames to first disconnect the client from the network. Instead, to establish
this MitM, the attacker forces the client to switch to another channel. This is accomplished by spoofing beacon frames
that contain malicious Channel Switch Announcements. These beacon frames can be spoofed even when 802.11w is enabled, meaning
that enabling 802.11w won't make attacks harder.

You can read more about the multi-channel MitM in
[my blog post](https://www.mathyvanhoef.com/2021/05/fragattacks-clarifying-some-aspects.html#rogue-ap).
This MitM can be established in precisely the same manner whether or not 802.11w is used.

### [Why is Wi-Fi security important? We already have HTTPS.](#whyimportant)

These days a lot of websites and apps use [HTTPS](https://en.wikipedia.org/wiki/HTTPS) to encrypt data.
When using HTTPS, an adversary cannot see the data you are transmitting even when you are connected to an open Wi-Fi network.
This also means that you can safely use open Wi-Fi hotspots as long as you keep your devices up-to-date and as long as you assure
that websites are using HTTPS. Unfortunately, not all websites require the usage of HTTPS (i.e. they're not using
[HSTS](https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security)), meaning they remain
vulnerable to possible attacks.

At home, the security of your Wi-Fi network is also essential. An insecure network means that others might be able
to connect to the internet through your home. Additionally, more and more devices are using Wi-Fi to transfer personal
files in your local network without an extra layer of protection (e.g. when printing files, smart display screens, when
sending files to a local backup storage, digital photo stands, and so on). More problematic, a lot of internet-of-things devices have tons
of security vulnerabilities that can be exploited if an adversary can communicate with them. The main thing that prevents
an adversary from exploiting these insecure internet-of-things devices is the security of your Wi-Fi network. It therefore
remains essential to have strong encryption and authentication at the Wi-Fi layer.

At work, the security of Wi-Fi is also essential for the same reasons as mentioned above. Additionally, many
companies will automatically allow access to sensitive services when a user (or adversary) is able to
connect to the Wi-Fi network. Therefore strong Wi-Fi security is also essential in a work setting.

### [Will using a VPN prevent attacks?](#vpn)

Using a VPN can prevent attacks where an adversary is trying to exfiltrate data. It will not prevent an
adversary from bypassing your router's NAT/firewall to directly attack devices.

### [How did you discover this?](#howfound)

The seeds of this research were already planted while I was investigating the [KRACK attack](https://krackattacks.com).
At that time, on 8 June 2017 to be
precise, I wrote down some notes to further investigate (de)fragmentation support in Linux. In particular, I thought there might be an
implementation vulnerability in Linux. However, a single unconfirmed implementation flaw isn't too spectacular research-wise, so after disclosing
the KRACK attack I decided to work on other research instead. The idea of inspecting (de)fragmentation in Wi-Fi, and determining whether
there really was a vulnerability or not, was always at the back of my mind though.

Fast-forward three years later, and after gaining some additional ideas to investigate, closer inspection confirmed some of my hunches
and also revealed that these issues were more widespread than I initially assumed. And with some extra insights I also discovered all
the other vulnerabilities. Interestingly, this also shows the advantage of fleshing out ideas before rushing to publish (though actually
finishing the paper before submission was still a race against time..).

### [How sure are you that all Wi-Fi devices are affected?](#allaffected)

In experiments on more than 75 devices, all of them were vulnerable to one or more of the discovered attacks.
I'm curious myself whether *all* devices in the whole world are indeed affected though! To find this out, if you
find a device that isn't affected by at least one of the discovered vulnerabilities, let me know.

Also, if your company provides Wi-Fi devices and you think that your product was not affected by any of the discovered vulnerabilities,
you can send your product to me. Once I confirmed that it indeed was not affected by any vulnerabilities the name of
your product and company will be put here! Note that I do need a method to assure that I'm indeed testing a version
of the product that was available before the disclosure of the vulnerabilities (and that you didn't silently patch
some vulnerabilities).

### [Does this mean every Wi-Fi device is trivial to attack?](#istrivial)

The design issues are, on their own, tedious to exploit in practice. Unfortunately, some of the implementation
vulnerabilities are common and trivial to exploit. Additionally, by combining the design issues with certain implementation
issues, the resulting attacks become more serious. This means the impact of our findings depends on the specific
target. Your vendor can inform you what the precise impact is for specific devices. In other words, for some devices
the impact is minor, while for others it's disastrous.

### [How many networks use fragmentation?](#usagefrag)

By default devices don't send fragmented frames. This means that the mixed key attack and the fragment cache attack,
on their own, will be hard to exploit in practice, unless Wi-Fi 6 is used. When using Wi-Fi 6, which is based on the
802.11ax standard, a device may dynamically fragment frames to fill up available airtime.

### [How many networks periodically refresh the pairwise session key?](#usagerenew)

By default access points don't renew the pairwise session key, even though some may periodically renew the group key.
This means that the default mixed key attack as described in the paper is only possible against networks that deviate from
this default setting.

### [Isn't it irresponsible to release tools to perform the attacks?](#abusetools)

The test tool that we released can only be used to test whether a device is vulnerable. It cannot be used
to perform attacks: an adversary would have to write their own tools for that. This approach enables network
administrators to test if devices are affected while reducing the chance of someone abusing the released code.

### [Where are all the attack tools?](#attacktools)

The code that has currently been released focusses on *detecting* vulnerable implementations. The proof-of-concepts
scripts that perform actual attacks are not released to provide everyone with more time to implement and deploy patches.
Once a large enough fraction of devices has been patched, and if deemed necessary and/or beneficial, the attack script
will be publicly released as well.

### [Do you have example network captures of the vulnerabilities?](#captures)

There are example [network captures](https://github.com/vanhoefm/fragattacks/tree/master/example-pcaps) of the
[test tool](#tools) that illustrate the root causes of several vulnerabilities.

### [How long will you maintain the driver patches needed to run the test scripts?](#maintaindriver)

The modifications to certain drivers have been submitted upstream to Linux meaning they will be maintained by the Linux developers
themselves. The patches to the Intel driver have not been submitted upstream because they're a bit hacky. Concretely, this means that
drivers such as ath9k\_htc will be supported out of the box, while for Intel devices you will have to use patched drivers and I'm not
sure how much time I'll have to maintain those.

### [Why are so many implementations vulnerable to be non-consecutive PN attack?](#nonsecdesign)

That's a good question. I'm not sure why so many developers missed this. This widespread implementation vulnerability
does highlight that leaving important cryptographic operations up to developers is not ideal. Put another way, it might
have been better if the standard required an authenticity check over the reassembled frame instead. That would also better
follow the principle of authenticated encryption.

### [Why are so many implementations vulnerable to the mixed plaintext/encrypted fragment attack?](#mixeddesign)

The 802.11 standard states in section 10.6: "If security encapsulation has been applied to the fragment, it shall be
deencapsulated and decrypted before the fragment is used for defragmentation of the MSDU or MMPDU". There is unfortunately
no warning that unencrypted *fragments* should be dropped. And there are no recommend checks that should be
performed when reassembling two (decrypted) fragments.

### [Can an implementation be vulnerable to a cache attack without being vulnerable to a mixed key attack?](#cachenotmixed)

Yes, although this is unlikely to occur in practice. More technically, let's assume that an implementation tries to prevent mixed key
attacks by: (1) assigning an unique key ID to every fragment; (2) incrementing this key ID whenever the pairwise transient
key (PTK) is updated; and (3) assuring all fragments were decrypted under the same key ID. Unfortunately, in that case
cache attacks may still be feasible. In particular, if under this defense key IDs are reused
after (re)connecting to a network, for example because they are reset to zero, fragments that are decrypted
using a different key may still be assigned the same key ID. As a result, cache attacks remain possible, because the
fragments will still be reassembled as they have the same key ID.

### [Can the mixed-key attack be prevented in a backward-compatible manner?](#mixedbackward)

Strictly speaking not, because the 802.11 standard does not explicitly require that a sender encrypts all fragments
of a specific frame under the same key. Fortunately, all implementations that we tested did encrypt all fragments using
the same key, at least under the normal circumstances that we tested, meaning in practice the mixed key attack can be
prevented without introducing incompatibilities.

### [Is the old WPA-TKIP protocol also affected by the design flaws?](#tkip)

Strictly speaking not, though implementations can still be vulnerable. Note that TKIP should not be used because it
is affected by other more serious security flaws. Additionally, TKIP has been
[deprecated](https://www.wi-fi.org/file/technical-note-removal-of-tkip-from-wi-fi-devices) by the Wi-Fi Alliance.

The TKIP protocol is not affected by the fragmentation-based design flaws (CVE-2020-24587 and CVE-2020-24586) because it
verifies the authenticity of the full reassembled frame. This is in contrast to CCMP and GCMP,
which only verify the authenticity of individual fragments, and rely on sequential packet numbers to securely reassemble
the individual (decrypted) fragments.

Additionally, TKIP is not affected by the aggregation design flaw (CVE-2020-24588) because a receiver is supposed
to drop A-MSDUs that are encrypted using TKIP. Indeed, in Section "12.9.2.8 Per-MSDU/Per-A-MSDU Rx pseudocode"
of the [802.11-2016](https://standards.ieee.org/standard/802_11-2016.html) standard it's specified that
when using TKIP only normal MSDU frames are accepted.

Unfortunately, some implementations don't verify the authenticity of fragmented TKIP frames, and some accept aggregated
frames (i.e. A-MSDUs) even when encrypted using TKIP. This unfortunately means that in practice TKIP implementations
may still be vulnerable.

### [Is the ancient WEP protocol also affected by the design flaws?](#wep)

Yes. The WEP protocol is so horrible that it doesn't even try to verify the authenticity of fragmented frames.
This means an adversary can trivially perform aggregation-based attacks against WEP.

Similar to TKIP, the WEP protocol is not affected by the aggregation design flaw (CVE-2020-24588)
because a receiver is supposed to drop A-MSDUs that are encrypted using WEP. Nevertheless, in practice several
WEP implementations do accept A-MSDUs and therefore are still vulnerable.

Finally, in case you've been living under a rock, stop using WEP, it's known to be a
[horrible](https://en.wikipedia.org/wiki/Wired_Equivalent_Privacy#Weak_security) security protocol.

### [Can fragmentation attacks be preventing by disallowing small delays between fragments?](#fragdelays)

This would make exploiting possible vulnerabilities harder and perhaps in some cases practically infeasible.
Unfortunately this doesn't provide any guarantees though. I therefore recommend to fix the root cause instead.

### [Are patches for Linux available?](#patchlinux)

Yes! During the embargo I helped write some patches for the Linux kernel. This means an updated Linux kernel should (soon) be
available for actively supported Linux distributions.

### [Did others also discover the plaintext injection issue (CVE-2020-26140)?](#plainothers)

During the embargo I was made aware that [Synopsys also discoveredthe plaintext injection vulnerability (CVE-2020-26140) in access points. They found that Mediatek, Realtek, and Qualcomm were
affected, and to cover these three implementations the identifiers
[CVE-2019-18989](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-18989),
[CVE-2019-18990](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-18990), and
[CVE-2019-18991](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-18991) were respectively assigned.](https://www.synopsys.com/blogs/software-security/cyrc-advisory-sept2020/)

During the FragAttacks research I found that the same vulnerability was (still) present in other access points and that clients
can be vulnerable to a similar attack. Additionally, and somewhat surprisingly, I also found that some devices reject
normal (non-fragmented) plaintext frames but do accept fragmented plaintext frames (CVE-2020-26143).

### [Why do you use the same CVE for implementation issues in multiple different codebases?](#samecves)

Implementation-specific vulnerabilities usually get their own independent CVE identifier for each different codebase.
However, because the same implementation issues seem to be present across multiple vendors it would make more sense to have a single CVE identifier
for each common implementation issue.
After all, the main purpose of CVE identifiers is to provide a single, common ID to be used across vendors to identify the same vulnerability.
We therefore think it makes sense to assign only a single CVE identifier to each implementation issues. This enables vendors
and customers to easily reference an implementation vulnerability and, for instance, check whether certain products are affected
by one of the discovered vulnerabilities.

### [Why was the embargo so long?](#longembargo)

The disclosure was delayed by two months in consensus with ICASI and the Wi-Fi Alliance. The decision on whether to disclose fast,
or to provide more time to write and create patches, wasn't easy. At the time, the risk of leaks appeared low,
and the advantage of delaying appeared high. Additionally, we were prepared to immediately disclose in case
details would accidently leak publicly. Another aspect that influenced my decision was *the current situation*, meaning COVID-19,
which among other things made it harder to safely get access to physical places/labs to test patches.

### [How did you monitor for leaks during the embargo?](#detectleaks)

During the last two months of the embargo, we were prepared to make the research public whenever information would seemed to
be leaking. To detect leaks I personally searched for relevant keywords (CVE numbers, paper title, script names) on Google and
social media such as Twitter. The Wi-Fi Alliance and ICASI were also monitoring for leaks (e.g. if questions
came from people that shouldn't have known about it). This can detect innocent leaks. Detecting malicious leaks or
usage of the vulnerabilities in stealthy attacks is a much harder problem (if even possible at all).

If you know about cases where some information was (accidently) leaked, it would be useful to know about that so
that I can better estimate the impact of having long embargos. Any information you provide about this will remain
confidential. This information will help me in future decision when weighing the option of a longer embargo versus
disclosing research even when several vendors don't have patches ready (i.e. it won't be used to point fingers).

### [Are these vulnerabilities being exploited in practice?](#beingexploit)

Not that we are aware of. Because some of the design flaws took so long to discover my hunch is that those have
not been previously exploited in the wild. But it is difficult to monitor whether one of the discovered vulnerabilities have
been exploited in the past or are currently being exploited. So it is hard to give a definite answer to this
question.

### [Why did Microsoft already fix certain vulnerabilities on March 9, 2021?](#microsoft)

The original disclosure date was March 9, 2021. Roughly one week beforehand it was decided to [delay the disclosure](#longembargo).
At this time Microsoft had already committed to shipping certain patches on March 9. I agreed that already releasing
certain patches without providing information about the vulnerabilities was, at that point, an acceptable risk.
Put differently, the advantages of delaying the disclosure appeared to outweigh the risk that someone would reverse engineer
the patches and rediscover certain attacks.

### [Is the "Treating fragments as full frames" flaw (CVE-2020-26142) also applicable to APs?](#apfragasfull)

Yes, access points can also be vulnerable. In particular, during additional experiments that I recently performed, the vulnerability was
also present in OpenBSD when it acted as an access point.

### [Can APs be vulnerable to attacks that send broadcast frames?](#aprecievebcast)

Yes, although they are less likely to be vulnerable compared to clients. This is because under normal circumstances clients
never send a frame to the AP with a broadcast receiver address. Instead, clients first send broadcast/multicast network packets
as unicast Wi-Fi frames to the AP, and the AP then broadcasts these packets to all connected clients. As a result, many APs
will simply ignore Wi-Fi frames with a broadcast receiver address, because in normal networks those frames are only meant for clients.

### [Why are some of the tested devices so old?](#whyold)

I also tested some very old Wi-Fi devices and dongles to estimate how long the discovered vulnerabilities have been
present in the wild. Note that some old devices may remain in use for a long time, for example, expensive medical
or industrial equipment that is rarely replaced.

### [How did you make macOS switch to the malicious DNS server in the demonstration?](#forcebaddns)

After injecting the ICMPv6 Router Advertisement with the malicious DNS server, macOS won't immediately use this DNS server.
This is because macOS will only switch to the malicious DNS server if its current (primary) DNS server is no longer responding.
To force this to happen, we briefly block all traffic towards the victim. This causes macOS to switch to the malicious DNS server.

### [Isn't nyu.edu using HSTS to prevent these kind of attacks?](#nyuhsts)

Websites can use [HSTS](https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security) to force browsers to always
use HTTPS encryption when visiting a website. This prevents the attack that was shown in our [demo](#href).
Unfortunately, the website of NYU at the time did not properly configure HSTS. More technically, some subdomains such as
globalhome.nyu.edu do instruct the browser to use HSTS by including the following header in responses:

```
strict-transport-security: max-age=31536000 ; includeSubDomains
```

Unfortunately, other subdomains such as shibboleth.nyu.edu remove HSTS by including the following header in responses:

```
Strict-Transport-Security: max-age=0
```

Combined with other configuration decisions, this meant that when a user would type nyu.edu in their browser,
the initial request was sent in plaintext and therefore could be intercepted by an adversary.

Note that NYU has been informed of this issue and is investigating it.

### [How do I reproduce the BlueKeep attack shown in the demonstration?](#bluekeep)

First, when using the NAT punching technique, it is essential that you manually configure the CPORT parameter so that metasploit uses
the correct client port. You can learn this port from the injected TCP SYN packet that arrives at the server. When using a different client port
the router/NAT will not recognize the connection and will not forward it to the victim machine.

Second, you must set the AutoCheck parameter to zero. Otherwise metasploit will try to initiate multiple connections with the
victim and that is problematic when manually specifying a client port through CPORT. This workaround of setting AutoCheck
to zero can be avoided by punching multiple holes in the router/NAT and modifying the metasploit to use a different CPORT for
each connection that will be initiated.

[Creative Commons Attribution 4.0 International License](http://creativecommons.org/licenses/by/4.0/) | Design inspired by [TEMPLATED](http://templated.co).



=== Content from sec.cloudapps.cisco.com_bdad936f_20250119_140742.html ===


Back

US

EN

×

Your email address belongs to an organization that also manages
your Cisco account login.

Log in to your organization to also log in to Cisco.

Organization Log In

×

Description here

Contact Support
[Privacy](https://www.cisco.com/c/en/us/about/legal/privacy-full.html)
[Terms &
Conditions](https://www.cisco.com/c/en/us/about/legal/terms-conditions.html)
[Cookies](https://www.cisco.com/c/en/us/about/legal/privacy-full.html#cookies)
[Trademarks](http://www.cisco.com/web/siteassets/legal/trademark.html)
[京ICP备05085544号-1](http://beian.miit.gov.cn)

## Cookies are required

Cookies are disabled on your browser. Please enable Cookies and refresh this page.

[Refresh](.)

![Cisco Identity](https://id.cisco.com/fs/bco/1/fs0a411g73DFKaj7K5d7)

## The page has timed out

If this page does not reload automatically, please refresh your browser.



=== Content from tools.cisco.com_ed44aab6_20250119_122952.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Security AdvisoryMultiple Vulnerabilities in Frame Aggregation and Fragmentation Implementations of 802.11 Specification Affecting Cisco Products: May 2021 Medium   Advisory ID:  cisco-sa-wifi-faf-22epcEWu  First Published: 2021 May 11 18:00 GMT  Last Updated:  2021 December 15 15:47 GMT  Version 1.9:  [Final](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#final)   Workarounds:  No workarounds available  Cisco Bug IDs: [CSCvx24420](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24420)  [CSCvx24423](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24423)  [CSCvx24425](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24425)  More...  ,[CSCvx24420](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24420),[CSCvx24423](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24423),[CSCvx24425](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24425),[CSCvx24428](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24428),[CSCvx24439](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24439),[CSCvx24440](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24440),[CSCvx24441](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24441),[CSCvx24449](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24449),[CSCvx24452](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24452),[CSCvx24456](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24456),[CSCvx60997](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx60997),[CSCvx61001](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61001),[CSCvx61012](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61012),[CSCvx61020](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61020),[CSCvx62876](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx62876),[CSCvx62884](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx62884),[CSCvx62886](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx62886),[CSCvx89821](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx89821),[CSCvy32680](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy32680),[CSCvy32690](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy32690),[CSCvy32694](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy32694)   CVE-2020-24586 CVE-2020-24587 CVE-2020-24588  More...     CVE-2020-24586,CVE-2020-24587,CVE-2020-24588,CVE-2020-26139,CVE-2020-26140,CVE-2020-26141,CVE-2020-26142,CVE-2020-26143,CVE-2020-26144,CVE-2020-26145,CVE-2020-26146,CVE-2020-26147  CWE-345 CWE-772 CWE-99       CVSS Score: [Base 6.5](https://sec.cloudapps.cisco.com/security/center/cvssCalculator.x?version=3.1&vector=CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N)**Click Icon to Copy Verbose Score** CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:X/RL:X/RC:X       CVE-2020-24586 CVE-2020-24587 CVE-2020-24588  More...     CVE-2020-24586,CVE-2020-24587,CVE-2020-24588,CVE-2020-26139,CVE-2020-26140,CVE-2020-26141,CVE-2020-26142,CVE-2020-26143,CVE-2020-26144,CVE-2020-26145,CVE-2020-26146,CVE-2020-26147  CWE-345 CWE-772 CWE-99       [Download CSAF](https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-wifi-faf-22epcEWu/csaf/cisco-sa-wifi-faf-22epcEWu.json)   Email      Summary  * On May 11, 2021, the research paper *Fragment and Forge: Breaking Wi-Fi Through Frame Aggregation and Fragmentation* was made public. This paper discusses 12 vulnerabilities in the 802.11 standard. One vulnerability is in the frame aggregation functionality, two vulnerabilities are in the frame fragmentation functionality, and the other nine are implementation vulnerabilities. These vulnerabilities could allow an attacker to forge encrypted frames, which could in turn enable the exfiltration of sensitive data from a targeted device.  This advisory will be updated as additional information becomes available.  This advisory is available at the following link:<https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-wifi-faf-22epcEWu>  Affected Products  * Cisco is investigating its product line to determine which products may be affected by these vulnerabilities. As the investigation progresses, Cisco will update this advisory with information about affected products.    Vulnerable Products The following table lists Cisco products that are affected by the vulnerabilities that are described in this advisory. If a future release date is indicated for software, the date provided represents an estimate based on all information known to Cisco as of the Last Updated date at the top of the advisory. Availability dates are subject to change based on a number of factors, including satisfactory testing results and delivery of other priority features and fixes. If no version or date is listed for an affected component (indicated by a blank field and/or an advisory designation of Interim), Cisco is continuing to evaluate the fix and will update the advisory as additional information becomes available. After the advisory is marked Final, customers should refer to the associated Cisco bug(s) for further details.       | CVE ID | Cisco Bug ID | [Fixed Release Availability](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes) |   | --- | --- | --- |   | Aironet 1532 APs, AP803 Integrated AP on IR829 Industrial Integrated Services Routers | | |   | CVE-2020-24586 | [CSCvy32690](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy32690) | 8.5MR88.10MR6 |   | CVE-2020-24587 | [CSCvy32690](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy32690) | 8.5MR88.10MR6 |   | CVE-2020-24588 | [CSCvy32690](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy32690) | 8.5MR88.10MR6 |   | CVE-2020-26139 | Not affected | N/A |   | CVE-2020-26140 | Not affected | N/A |   | CVE-2020-26141 | Not affected | N/A |   | CVE-2020-26142 | Not affected | N/A |   | CVE-2020-26143 | Not affected | N/A |   | CVE-2020-26144 | Not affected | N/A |   | CVE-2020-26145 | Not affected | N/A |   | CVE-2020-26146 | Not affected | N/A |   | CVE-2020-26147 | Not affected | N/A |   | Aironet 1542 APs, Aironet 1810 APs, Aironet 1815 APs, Aironet 1832 APs, Aironet 1842 APs, Aironet 1852 APs, Aironet 1800i APs | | |   | CVE-2020-24586 | Not affected | N/A |   | CVE-2020-24587 | [CSCvx24420](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24420) | 8.5MR88.10MR616.12.617.3.417.6.1 |   | CVE-2020-24588 | [CSCvx24420](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24420) | 8.5MR88.10MR616.12.617.3.417.6.1 |   | CVE-2020-26139 | [CSCvx24420](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24420) | 8.5MR88.10MR616.12.617.3.417.6.1 |   | CVE-2020-26140 | Not affected | N/A |   | CVE-2020-26141 | Not affected | N/A |   | CVE-2020-26142 | Not affected | N/A |   | CVE-2020-26143 | Not affected | N/A |   | CVE-2020-26144 | Not affected | N/A |   | CVE-2020-26145 | [CSCvx24420](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24420) | 8.5MR88.10MR616.12.617.3.417.6.1 |   | CVE-2020-26146 | [CSCvx24420](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24420) | 8.5MR88.10MR616.12.617.3.417.6.1 |   | CVE-2020-26147 | Not affected | N/A |   | Aironet 1552 APs, Aironet 1552H APs, Aironet 1572 APs, Aironet 1702 APs, Aironet 2702 APs, Aironet 3702 APs, IW 3702 APs | | |   | CVE-2020-24586 | [CSCvy32680](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy32680) | 8.5MR88.10MR616.12.617.3.4 |   | CVE-2020-24587 | [CSCvy32680](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy32680) | 8.5MR88.10MR616.12.617.3.4 |   | CVE-2020-24588 | Not affected | N/A |   | CVE-2020-26139 | Not affected | N/A |   | CVE-2020-26140 | Not affected | N/A |   | CVE-2020-26141 | Not affected | N/A |   | CVE-2020-26142 | Not affected | N/A |   | CVE-2020-26143 | Not affected | N/A |   | CVE-2020-26144 | Not affected | N/A |   | CVE-2020-26145 | Not affected | N/A |   | CVE-2020-26146 | Not affected | N/A |   | CVE-2020-26147 | Not affected | N/A |   | Aironet 1560 Series APs, Aironet 2800 Series APs, Aironet Series 3800 APs, Aironet Series 4800 APs, Catalyst IW 6300 APs, 6300 Series Embedded Services APs (ESW6300) | | |   | CVE-2020-24586 | [CSCvx24449](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24449) | 8.5MR88.10MR616.12.617.3.417.6.1 |   | CVE-2020-24587 | [CSCvx24449](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24449) | 8.5MR88.10MR616.12.617.3.417.6.1 |   | CVE-2020-24588 | Not affected | N/A |   | CVE-2020-26139 | Not affected | N/A |   | CVE-2020-26140 | [CSCvy36698](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy36698) | 8.5MR88.10MR616.12.617.3.417.6.1 |   | CVE-2020-26141 | Not affected | N/A |   | CVE-2020-26142 | Not affected | N/A |   | CVE-2020-26143 | [CSCvy36698](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy36698) | 8.5MR88.10MR616.12.617.3.417.6.1 |   | CVE-2020-26144 | Not affected | N/A |   | CVE-2020-26145 | Not affected | N/A |   | CVE-2020-26146 | [CSCvy36698](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy36698) | 8.5MR88.10MR616.12.617.3.417.6.1 |   | CVE-2020-26147 | [CSCvy36698](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvy36698) | 8.5MR88.10MR616.12.617.3.417.6.1 |   | Catalyst 9105 APs, Catalyst 9115 APs, Catalyst 9120 APs, Integrated AP on 1100 Integrated Services Routers | | |   | CVE-2020-24586 | [CSCvx24425](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24425) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-24587 | [CSCvx24425](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24425) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-24588 | [CSCvx24425](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24425) | 8.10MR616.12.6 17.3.417.6.1 |   | CVE-2020-26139 | Not affected | N/A |   | CVE-2020-26140 | Not affected | N/A |   | CVE-2020-26141 | Not affected | N/A |   | CVE-2020-26142 | Not affected | N/A |   | CVE-2020-26143 | Not affected | N/A |   | CVE-2020-26144 | Not affected | N/A |   | CVE-2020-26145 | Not affected | N/A |   | CVE-2020-26146 | Not affected | N/A |   | CVE-2020-26147 | Not affected | N/A |   | Catalyst 9117 APs | | |   | CVE-2020-24586 | [CSCvx24439](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24439) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-24587 | [CSCvx24439](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24439) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-24588 | [CSCvx24439](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24439) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-26139 | [CSCvx24439](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24439) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-26140 | Not affected | N/A |   | CVE-2020-26141 | Not affected | N/A |   | CVE-2020-26142 | Not affected | N/A |   | CVE-2020-26143 | Not affected | N/A |   | CVE-2020-26144 | [CSCvx24439](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24439) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-26145 | [CSCvx24439](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24439) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-26146 | [CSCvx24439](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24439) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-26147 | Not affected | N/A |   | Catalyst 9124 APs1, Catalyst 9130 APs | | |   | CVE-2020-24586 | [CSCvx24428](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24428)[CSCvx24452](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24452)[CSCvx24456](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24456) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-24587 | [CSCvx24428](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24428)[CSCvx24452](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24452)[CSCvx24456](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24456) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-24588 | [CSCvx24428](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24428)[CSCvx24452](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24452)[CSCvx24456](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24456) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-26139 | [CSCvx24428](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24428)[CSCvx24452](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24452)[CSCvx24456](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24456) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-26140 | Not affected | N/A |   | CVE-2020-26141 | Not affected | N/A |   | CVE-2020-26142 | Not affected | N/A |   | CVE-2020-26143 | Not affected | N/A |   | CVE-2020-26144 | [CSCvx24428](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24428)[CSCvx24452](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24452)[CSCvx24456](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24456) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-26145 | [CSCvx24428](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24428)[CSCvx24452](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24452)[CSCvx24456](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24456) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-26146 | [CSCvx24428](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24428)[CSCvx24452](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24452)[CSCvx24456](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx24456) | 8.10MR616.12.617.3.417.6.1 |   | CVE-2020-26147 | Not affected | N/A |   | 1. Catalyst 9124 APs were not supported until Release 17.5, and the fix will be available in Release 17.6.1 | | |   | Meraki GR10, GR60, MR20, MR30H, MR33, MR36, MR42, MR42E, MR44, MR45, MR46, MR46E, MR52, MR53, MR53E, MR55, MR56, MR70, MR74, MR76, MR84, MR86 | | |   | CVE-2020-24586 | No bug ID | MR 27.7.1 |   | CVE-2020-24587 | No bug ID | MR 27.7.1 |   | CVE-2020-24588 | No bug ID | MR 27.7.1 |   | CVE-2020-26139 | No bug ID | MR 27.7.1 |   | CVE-2020-26140 | No bug ID | MR 27.7.1 |   | CVE-2020-26141 | No bug ID | MR 27.7.1 |   | CVE-2020-26142 | No bug ID | MR 27.7.1 |   | CVE-2020-26143 | No bug ID | MR 27.7.1 |   | CVE-2020-26144 | No bug ID | MR 27.7.1 |   | CVE-2020-26145 | No bug ID | MR 27.7.1 |   | CVE-2020-26146 | No bug ID | MR 27.7.1 |   | CVE-2020-26147 | No bug ID | MR 27.7.1 |   | Meraki MR12, MR18, MR26, MR32, MR34, MR62, MR66, MR72 | | |   | CVE-2020-24586 | No bug ID | MR 26.8.3 |   | CVE-2020-24587 | No bug ID | MR 26.8.3 |   | CVE-2020-24588 | No bug ID | MR 26.8.3 |   | CVE-2020-26139 | No bug ID | MR 26.8.3 |   | CVE-2020-26140 | No bug ID | MR 26.8.3 |   | CVE-2020-26141 | No bug ID | MR 26.8.3 |   | CVE-2020-26142 | No bug ID | MR 26.8.3 |   | CVE-2020-26143 | No bug ID | MR 26.8.3 |   | CVE-2020-26144 | No bug ID | MR 26.8.3 |   | CVE-2020-26145 | No bug ID | MR 26.8.3 |   | CVE-2020-26146 | No bug ID | MR 26.8.3 |   | CVE-2020-26147 | No bug ID | MR 26.8.3 |   | Meraki MX64W, MX65W, MX67W, MX67CW, MX68W, MX68CW, Z3, Z3C1 | | |   | CVE-2020-24586 | No bug ID | MX 17.0 |   | CVE-2020-24587 | No bug ID | MX 17.0 |   | CVE-2020-24588 | No bug ID | MX 17.0 |   | CVE-2020-26139 | No bug ID | MX 17.0 |   | CVE-2020-26140 | No bug ID | MX 17.0 |   | CVE-2020-26141 | No bug ID | MX 17.0 |   | CVE-2020-26142 | No bug ID | MX 17.0 |   | CVE-2020-26143 | No bug ID | MX 17.0 |   | CVE-2020-26144 | No bug ID | MX 17.0 |   | CVE-2020-26145 | No bug ID | MX 17.0 |   | CVE-2020-26146 | No bug ID | MX 17.0 |   | CVE-2020-26147 | No bug ID | MX 17.0 |   | 1. Cisco will not fix these vulnerabilities in the following Cisco Meraki products: MX60W and Z1 | | |   | IP Phone 8861, IP Phone 8865, and IP Conference Phone 8832 | | |   | CVE-2020-24586 | [CSCvx60997](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx60997) | 14.1(1) |   | CVE-2020-24587 | [CSCvx60997](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx60997) | 14.1(1) |   | CVE-2020-24588 | [CSCvx60997](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx60997) | 14.1(1) |   | CVE-2020-26139 | [CSCvx60997](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx60997) | 14.1(1) |   | CVE-2020-26140 | [CSCvx60997](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx60997) | 14.1(1) |   | CVE-2020-26141 | [CSCvx60997](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx60997) | 14.1(1) |   | CVE-2020-26142 | [CSCvx60997](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx60997) | 14.1(1) |   | CVE-2020-26143 | [CSCvx60997](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx60997) | 14.1(1) |   | CVE-2020-26144 | [CSCvx60997](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx60997) | 14.1(1) |   | CVE-2020-26145 | [CSCvx60997](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx60997) | 14.1(1) |   | CVE-2020-26146 | [CSCvx60997](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx60997) | 14.1(1) |   | CVE-2020-26147 | [CSCvx60997](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx60997) | 14.1(1) |   | IP Phone 6861 and IP Phone 8861 Running Third-Party Call Control (3PCC) Software | | |   | CVE-2020-24586 | [CSCvx61001](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61001) | 11.3(5) |   | CVE-2020-24587 | [CSCvx61001](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61001) | 11.3(5) |   | CVE-2020-24588 | [CSCvx61001](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61001) | 11.3(5) |   | CVE-2020-26139 | [CSCvx61001](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61001) | 11.3(5) |   | CVE-2020-26140 | [CSCvx61001](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61001) | 11.3(5) |   | CVE-2020-26141 | [CSCvx61001](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61001) | 11.3(5) |   | CVE-2020-26142 | [CSCvx61001](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61001) | 11.3(5) |   | CVE-2020-26143 | [CSCvx61001](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61001) | 11.3(5) |   | CVE-2020-26144 | [CSCvx61001](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61001) | 11.3(5) |   | CVE-2020-26145 | [CSCvx61001](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61001) | 11.3(5) |   | CVE-2020-26146 | [CSCvx61001](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61001) | 11.3(5) |   | CVE-2020-26147 | [CSCvx61001](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61001) | 11.3(5) |   | Wireless IP Phone 8821 | | |   | CVE-2020-24586 | [CSCvx61012](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61012) | 11.0(6)SR2 |   | CVE-2020-24587 | [CSCvx61012](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61012) | 11.0(6)SR2 |   | CVE-2020-24588 | [CSCvx61012](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61012) | 11.0(6)SR2 |   | CVE-2020-26139 | [CSCvx61012](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61012) | 11.0(6)SR2 |   | CVE-2020-26140 | [CSCvx61012](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61012) | 11.0(6)SR2 |   | CVE-2020-26141 | [CSCvx61012](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61012) | 11.0(6)SR2 |   | CVE-2020-26142 | [CSCvx61012](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61012) | 11.0(6)SR2 |   | CVE-2020-26143 | [CSCvx61012](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61012) | 11.0(6)SR2 |   | CVE-2020-26144 | [CSCvx61012](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61012) | 11.0(6)SR2 |   | CVE-2020-26145 | [CSCvx61012](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61012) | 11.0(6)SR2 |   | CVE-2020-26146 | [CSCvx61012](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61012) | 11.0(6)SR2 |   | CVE-2020-26147 | [CSCvx61012](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61012) | 11.0(6)SR2 |   | Webex Desk Series and Webex Room Series | | |   | CVE-2020-24586 | [CSCvx89821](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx89821) | 1.2(0)SR1 |   | CVE-2020-24587 | [CSCvx89821](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx89821) | 1.2(0)SR1 |   | CVE-2020-24588 | [CSCvx89821](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx89821) | 1.2(0)SR1 |   | CVE-2020-26139 | [CSCvx89821](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx89821) | 1.2(0)SR1 |   | CVE-2020-26140 | [CSCvx89821](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx89821) | 1.2(0)SR1 |   | CVE-2020-26141 | [CSCvx89821](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx89821) | 1.2(0)SR1 |   | CVE-2020-26142 | [CSCvx89821](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx89821) | 1.2(0)SR1 |   | CVE-2020-26143 | [CSCvx89821](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx89821) | 1.2(0)SR1 |   | CVE-2020-26144 | [CSCvx89821](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx89821) | 1.2(0)SR1 |   | CVE-2020-26145 | [CSCvx89821](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx89821) | 1.2(0)SR1 |   | CVE-2020-26146 | [CSCvx89821](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx89821) | 1.2(0)SR1 |   | CVE-2020-26147 | [CSCvx89821](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx89821) | 1.2(0)SR1 |   | Webex Board Series | | |   | CVE-2020-24586 | [CSCvx61020](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61020) | 10.8.2.5 |   | CVE-2020-24587 | [CSCvx61020](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61020) | 10.8.2.5 |   | CVE-2020-24588 | [CSCvx61020](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61020) | 10.8.2.5 |   | CVE-2020-26139 | [CSCvx61020](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61020) | 10.8.2.5 |   | CVE-2020-26140 | [CSCvx61020](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61020) | 10.8.2.5 |   | CVE-2020-26141 | [CSCvx61020](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61020) | 10.8.2.5 |   | CVE-2020-26142 | [CSCvx61020](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61020) | 10.8.2.5 |   | CVE-2020-26143 | [CSCvx61020](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61020) | 10.8.2.5 |   | CVE-2020-26144 | [CSCvx61020](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61020) | 10.8.2.5 |   | CVE-2020-26145 | [CSCvx61020](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61020) | 10.8.2.5 |   | CVE-2020-26146 | [CSCvx61020](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61020) | 10.8.2.5 |   | CVE-2020-26147 | [CSCvx61020](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx61020) | 10.8.2.5 |   | Webex Wireless Phone 840 and 860 | | |   | CVE-2020-24586 | [CSCvx62886](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx62886) | 1.4(0) |   | CVE-2020-24587 | [CSCvx62886](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx62886) | 1.4(0) |   | CVE-2020-24588 | [CSCvx62886](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx62886) | 1.4(0) |   | CVE-2020-26139 | [CSCvx62886](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx62886) | 1.4(0) |   | CVE-2020-26140 | [CSCvx62886](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx62886) | 1.4(0) |   | CVE-2020-26141 | [CSCvx62886](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx62886) | 1.4(0) |   | CVE-2020-26142 | [CSCvx62886](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx62886) | 1.4(0) |   | CVE-2020-26143 | [CSCvx62886](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx62886) | 1.4(0) |   | CVE-2020-26144 | [CSCvx62886](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx62886) | 1.4(0) |   | CVE-2020-26145 | [CSCvx62886](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx62886) | 1.4(0) |   | CVE-2020-26146 | [CSCvx62886](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx62886) | 1.4(0) |   | CVE-2020-26147 | [CSCvx62886](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvx62886) | 1.4(0) |      Products Confirmed Not Vulnerable Only products listed in the [Vulnerable Products](#vp) section of this advisory are known to be affected by this vulnerability.  Details  * The vulnerabilities are not dependent on one another. Exploitation of one of the vulnerabilities is not required to exploit another vulnerability. In addition, a software release that is affected by one of the vulnerabilities may not be affected by the other vulnerabilities.  For a description of the following vulnerabilities, see [Fragment and Forge: Breaking Wi-Fi Through Frame Aggregation and Fragmentation](https://papers.mathyvanhoef.com/usenix2021.pdf).  For additional information, see [FragAttacks](https://fragattacks.com/).  **CVE-2020-26140: Accepting plaintext data frames in a protected network**  Security Impact Rating (SIR): MediumCVSS Base Score: 6.5CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N  **CVE-2020-26143: Accepting fragmented plaintext data frames in a protected network**  Security Impact Rating (SIR): MediumCVSS Base Score: 6.5CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N  **CVE-2020-26144: Accepting plaintext A-MSDU frames that start with an RFC1042 header with EtherType EAPOL (in an encrypted network)**  Security Impact Rating (SIR): MediumCVSS Base Score: 6.5CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N  **CVE-2020-26145: Accepting plaintext broadcast fragments as full frames (in an encrypted network)**  Security Impact Rating (SIR): MediumCVSS Base Score: 6.5CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N  **CVE-2020-24586: Not clearing fragments from memory when (re)connecting to a network**  Security Impact Rating (SIR): MediumCVSS Base Score: 5.7CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N  **CVE-2020-24588: Accepting non-SPP A-MSDU frames**  Security Impact Rating (SIR): MediumCVSS Base Score: 5.7CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N  **CVE-2020-26139: Forwarding EAPOL frames even though the sender is not yet authenticated**  Security Impact Rating (SIR): MediumCVSS Base Score: 5.7CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L  **CVE-2020-26141: Not verifying the TKIP MIC of fragmented frames**  Security Impact Rating (SIR): MediumCVSS Base Score: 5.7CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N  **CVE-2020-26142: Processing fragmented frames as full frames**  Security Impact Rating (SIR): MediumCVSS Base Score: 5.7CVSS Vector: CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N  **CVE-2020-24587: Reassembling fragments encrypted under different keys**  Security Impact Rating (SIR): MediumCVSS Base Score: 4.8CVSS Vector: CVSS:3.1/AV:A/AC:H/PR:N/UI:R/S:U/C:N/I:H/A:N  **CVE-2020-26146: Reassembling encrypted fragments with non-consecutive packet numbers**  Security Impact Rating (SIR): MediumCVSS Base Score: 4.8CVSS Vector: CVSS:3.1/AV:A/AC:H/PR:N/UI:R/S:U/C:N/I:H/A:N  **CVE-2020-26147: Reassembling mixed encrypted/plaintext fragments**  Security Impact Rating (SIR): MediumCVSS Base Score: 4.8CVSS Vector: CVSS:3.1/AV:A/AC:H/PR:N/UI:R/S:U/C:N/I:H/A:N  Workarounds  * There are no workarounds that address these vulnerabilities.  Fixed Software  * For information about [fixed software releases](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes), consult the Cisco bugs identified in the [Vulnerable Products](#vp) section of this advisory.  When [considering software upgrades](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes), customers are advised to regularly consult the advisories for Cisco products, which are available from the [Cisco Security Advisories page](https://www.cisco.com/go/psirt), to determine exposure and a complete upgrade solution.  In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.  Exploitation and Public Announcements  * The Cisco Product Security Incident Response Team (PSIRT) is aware that proof-of-concept exploit code is available for the vulnerabilities that are described in this advisory.  The Cisco PSIRT is not aware of any malicious use of the vulnerabilities that are described in this advisory.  Source  * These vulnerabilities were reported to Cisco by Dr. Mathy Vanhoef of New York University Abu Dhabi. Cisco would like to thank Dr. Vanhoef for his continued help and support during the handling of these vulnerabilities.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory    URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-wifi-faf-22epcEWu>  Revision History  * | Version | Description | Section | Status | Date |   | --- | --- | --- | --- | --- |   | 1.9 | Updated fixed releases. | Vulnerable Products | Final | 2021-DEC-15 |   | 1.8 | Updated fixed release details for Aironet 1532/AP803 products. | Vulnerable Products | Interim | 2021-OCT-05 |   | 1.7 | Updated fixed release details for multiple products. | Vulnerable Products | Interim | 2021-AUG-30 |   | 1.6 | Added additional fixed releases for Meraki products. | Vulnerable Products | Interim | 2021-JUL-13 |   | 1.5 | Update affected products. | Vulnerable Products | Interim | 2021-JUN-02 |   | 1.4 | Added additional fixed releases. | Vulnerable Products | Interim | 2021-MAY-19 |   | 1.3 | Added additional affected products. | Vulnerable Products | Interim | 2021-MAY-17 |   | 1.2 | Added additional affected products. | Vulnerable Products | Interim | 2021-MAY-14 |   | 1.1 | Updated affected Meraki MR products. | Vulnerable Products | Interim | 2021-MAY-11 |   | 1.0 | Initial public release. | - | Interim | 2021-MAY-11 |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.  A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  Related to This Advisory |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |



=== Content from sec.cloudapps.cisco.com_18690d3b_20250119_140747.html ===

# Cisco Security

# Cisco Security

![](https://sec.cloudapps.cisco.com/security/center/Resources/images/search-icon.png)

Search by

* All Categories Listed Below
* Security Advisories and Responses
* URL Lookup

URL :

Reputation:

Please enter correct Domain or IP address.

[Advanced Search](/security/center/Search.x)

[* ![](/security/center/Resources/images/ERPcaro.jpg)

  Cisco Security Advisory
  Bundled Publications:
  See the latest releases](https://sec.cloudapps.cisco.com/security/center/erp.x?i=52)
[* ![](/security/center/Resources/images/AS86425.jpg)

  Lessons from the cybersecurity C-suite
  From successes to slow progress, learn how security leaders
  navigate the cybersecurity landscape.](https://www.cisco.com/c/en/us/products/security/security-reports.html)
[* ![](/security/center/Resources/images/AR02220.jpg)

  Cisco openVuln API:
  Receive custom security
  vulnerability information](https://developer.cisco.com/site/PSIRT/)

[![](/security/center/Resources/images/Security-Advisories.png)

[### Security Advisories](/security/center/publicationListing.x)
Security Advisories](/security/center/publicationListing.x)

[![](/security/center/Resources/images/Cisco-Services.png)

[### Tactical Resources](/security/center/tacticalresources.x)
Tactical Resources](/security/center/tacticalresources.x)

[![](/security/center/Resources/images/Security-Resources.png)

[### Cisco Policies and Processes](/security/center/securityResources.x)
Cisco Policies and Processes](/security/center/securityResources.x)

[![](/security/center/Resources/images/Experts-Blog.png)

[### Experts' Blog](https://blogs.cisco.com/security)
Experts' Blog](https://blogs.cisco.com/security)

[![](/security/center/Resources/images/Notification-Registration.png)

[### Notification Registration](/security/center/navigation.x?i=122)
Notification Registration](/security/center/navigation.x?i=122)

[![](/security/center/Resources/images/Security-Solutions.png)

[### Cisco Security Solutions for Products & Services](https://www.cisco.com/site/us/en/products/security/index.html)
Cisco Security Solutions](https://www.cisco.com/site/us/en/products/security/index.html)

### Contact Cisco

To report a potential vulnerability or data incident that involves Cisco products or services, contact the [Product Security Incident Response Team](https://www.cisco.com/c/dam/en_us/about/security/psirt/Cisco-PSIRT-Infographic.pdf) by email at psirt@cisco.com. Alternatively, reach PSIRT by phone at 877 228 7302 (U.S.) or +1 408 525 6532 (outside U.S.).

For support information or to open a support case, contact the [Cisco Technical Assistance Center (TAC)](https://www.cisco.com/c/en/us/support/index.html).

To request immediate assistance for an emerging cybersecurity event in your organization, contact the [Cisco Talos Incident Response Service](https://www.cisco.com/c/en/us/products/security/sas-threat-management.html) at +1 844 831 7715 (global) or at IncidentResponse@cisco.com.

For additional information about the support and response teams and programs at Cisco, visit [Cisco Emergency Response](https://sec.cloudapps.cisco.com/security/center/resources/cisco_emergency_response.html).

### Tools

* [Cisco Software Checker](https://sec.cloudapps.cisco.com/security/center/softwarechecker.x)
* [Cisco Vulnerability Repository](/security/center/cvr)
* [Bug Search](https://bst.cloudapps.cisco.com/bugsearch/)
* [Cisco PSIRT openVuln API](https://developer.cisco.com/psirt/)
* [CVRF Repository](https://sec.cloudapps.cisco.com/security/center/cvrfListing.x)
* [OVAL Repository](https://community.cisco.com/t5/services-blogs/update-regarding-oval-definitions-by-cisco/ba-p/3661030)

### Actions

* [Download Cisco Software](https://software.cisco.com/download/home)
* [Download Snort Rules](https://snort.org/)
* [Open or Query a TAC Case](https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html)


