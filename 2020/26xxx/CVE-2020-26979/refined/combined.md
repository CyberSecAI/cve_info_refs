=== Content from bugzilla.mozilla.org_98793c64_20250119_132022.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1677047)
* [XML](/show_bug.cgi?ctype=xml&id=1677047)

Closed
[Bug 1677047](/show_bug.cgi?id=1677047)
(CVE-2020-26978)

Opened 4 years ago
Closed 4 years ago

# Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list.

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list.

## Categories

### (Core :: Networking, task)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking#Networking)

Networking
▾

Core :: Networking
For bugs in Mozilla's modular networking library (aka "Netlib" or "Necko".) The networking library supplies the software interface that Mozilla uses to access physical transports (e.g. the Internet and local drives), perform URL resolutions, and handle a variety of networking protocols.

Examples of appropriate bugs: URLs with backslash not fetched; URLs starting with a single slash turn into http:///; Cannot access authenticated FTP site.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

task

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

85 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | [84+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=84%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) |
| firefox82 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox82&o1=equals&v1=wontfix) |
| firefox83 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=wontfix) |
| firefox84 | [+](/buglist.cgi?f1=cf_tracking_firefox84&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=fixed) |
| firefox85 | [+](/buglist.cgi?f1=cf_tracking_firefox85&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 | 84+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox82 |  | wontfix |
| firefox83 |  | wontfix |
| firefox84 | + | fixed |
| firefox85 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: freddy, Assigned: freddy)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40)  [jesup](/user_profile?user_id=11539)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2021-23961](/show_bug.cgi?id=1677940 "RESOLVED FIXED - Consider blocking ports 69, 137, 161, 1719, 6566, 10080")

Dependency [tree](/showdependencytree.cgi?id=1677047&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1677047)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1684007](/show_bug.cgi?id=1684007 "RESOLVED WONTFIX - Port 554 Blocked after Update 84.0 (Linux)"), [1687282](/show_bug.cgi?id=1687282 "RESOLVED WONTFIX - Undo port blocking for port 554")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-moderate, Whiteboard: [adv-main84+][adv-esr78.6+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-26978

[Keywords:](/describekeywords.cgi)

[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main84+][adv-esr78.6+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c5 "4 years ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Bug 1677047 - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin](/attachment.cgi?id=9187611)  [4 years ago](#c1)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c10 "4 years ago")  jcristau : [approval-mozilla-esr78+](#c15 "4 years ago") | [Details](/attachment.cgi?id=9187611&action=edit) | [Review](/attachment.cgi?id=9187611) |
| --- | --- | --- |
| [Bug 1677047 - Testing to block ports 1720, 1723, 554- r=valentin](/attachment.cgi?id=9187612)  [4 years ago](#c2)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#a382307_75935 "4 years ago")  jcristau : [approval-mozilla-esr78+](#a1754344_580382 "4 years ago") | [Details](/attachment.cgi?id=9187612&action=edit) | [Review](/attachment.cgi?id=9187612) |
| [advisory.txt](/attachment.cgi?id=9192461)  [4 years ago](#c20)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   305 bytes, text/plain |  | [Details](/attachment.cgi?id=9192461&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1677047#c0)• 4 years ago |
|  | |

See [bug 1676868](/show_bug.cgi?id=1676868 "RESOLVED FIXED") (and [bug 1674735](/show_bug.cgi?id=1674735 "RESOLVED FIXED - block port 5060 for outgoing requests (potentially mitigating NAT slipstreaming)")).

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677047#a1700_428608)• 4 years ago |

Summary: Add the ports for the SIP, H323, PPTP, RTSP protocols (5060, 1720, 1723, 554) to the restricted ports list. → Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1677047#c1)• 4 years ago |
|  | |

Attached file
[Bug 1677047 - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin](attachment.cgi?id=9187611)
— [Details](attachment.cgi?id=9187611&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1677047#c2)• 4 years ago |
|  | |

Attached file
[Bug 1677047 - Testing to block ports 1720, 1723, 554- r=valentin](attachment.cgi?id=9187612)
— [Details](attachment.cgi?id=9187612&action=edit)

Depends on D96979

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1677047#c3)• 4 years ago |
|  | |

[Green on Try](https://treeherder.mozilla.org/jobs?repo=try&revision=7b19f6039331cd3a4bc08313ed9cb395f920dc82)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677047#a256510_1689)• 4 years ago |

Type: enhancement → taskKeywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677047#a259646_600971)• 4 years ago |

[Attachment #9187612](/attachment.cgi?id=9187612&action=edit "Bug 1677047 - Testing to block ports 1720, 1723, 554- r=valentin") -
Attachment description: Bug 1677047 - Testing to block ports 1720, 1723, 554- r?jgraham → Bug 1677047 - Testing to block ports 1720, 1723, 554- r=valentin

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1677047#c4)• 4 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/6d86c1f75c77c2fdc40b1288dbb0b7f89ab0bd8d>

<https://hg.mozilla.org/integration/autoland/rev/6f9542c83bb8d433f26aa4b4d7cef667f1ae1fa6>

<https://hg.mozilla.org/mozilla-central/rev/6d86c1f75c77>

<https://hg.mozilla.org/mozilla-central/rev/6f9542c83bb8>

Group: network-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-firefox85](/buglist.cgi?f1=cf_status_firefox85&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox85&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 85 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1677047#c5)• 4 years ago |
|  | |

Please nominate this for Beta and ESR78 approval when you're comfortable doing so.

[status-firefox82](/buglist.cgi?f1=cf_status_firefox82&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox82&o1=equals&v1=wontfix)
[status-firefox83](/buglist.cgi?f1=cf_status_firefox83&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=wontfix)
[status-firefox84](/buglist.cgi?f1=cf_status_firefox84&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)
[tracking-firefox84](/buglist.cgi?f1=cf_tracking_firefox84&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox84&o1=equals&v1=%2B)
[tracking-firefox85](/buglist.cgi?f1=cf_tracking_firefox85&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox85&o1=equals&v1=%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [84+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=84%2B)Flags: needinfo?(fbraun)Flags: in-testsuite+

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1677047#c6)• 4 years ago |
|  | |

Comment on [attachment 9187611](/attachment.cgi?id=9187611 "Bug 1677047 - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin") [[details]](/attachment.cgi?id=9187611&action=edit "Bug 1677047 - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin")

[Bug 1677047](/show_bug.cgi?id=1677047 "RESOLVED FIXED - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list.") - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin

### Beta/Release Uplift Approval Request

* **User impact if declined**: less protection for a (yet to be disclosed) bug. Would be great if we could get the fix out soon.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The port shouldn't be used for HTTP(s) and seldomly is. Users who really need this can override themselves. If there's significant breakage, we can override globally with remote settings
* **String changes made/needed**:
Flags: needinfo?(fbraun)
[Attachment #9187611](/attachment.cgi?id=9187611&action=edit "Bug 1677047 - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin") -
Flags: approval-mozilla-beta?

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677047#a346090_428608)• 4 years ago |

[Attachment #9187612](/attachment.cgi?id=9187612&action=edit "Bug 1677047 - Testing to block ports 1720, 1723, 554- r=valentin") -
Flags: approval-mozilla-beta?

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1677047#c7)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1677047&comment_id=15135148 "1 revision") |
|  | |

Comment on [attachment 9187611](/attachment.cgi?id=9187611 "Bug 1677047 - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin") [[details]](/attachment.cgi?id=9187611&action=edit "Bug 1677047 - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin")

[Bug 1677047](/show_bug.cgi?id=1677047 "RESOLVED FIXED - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list.") - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: blocking a non-HTTP port for HTTP traffic.
* **User impact if declined**: less protection for an (undisclosed) bug
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Might be risky if enterprises run stuff on very odd ports in their intranet. We don't have telemetry for this. Users can override with a pref. We can also override the blocking with a remote pref, but I honestly don't know if these overrides would be valid for ESR or if we'd remove the protection on all branches. (Same as <https://bugzilla.mozilla.org/show_bug.cgi?id=1674735#c9>), though this issue here is not public yet
* **String or UUID changes made by this patch**:
[Attachment #9187611](/attachment.cgi?id=9187611&action=edit "Bug 1677047 - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin") -
Flags: approval-mozilla-esr78?

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677047#a346230_428608)• 4 years ago |

[Attachment #9187612](/attachment.cgi?id=9187612&action=edit "Bug 1677047 - Testing to block ports 1720, 1723, 554- r=valentin") -
Flags: approval-mozilla-esr78?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1677047#c8)• 4 years ago |
|  | |

Mike, do you have any thoughts on how likely this and [bug 1674735](/show_bug.cgi?id=1674735 "RESOLVED FIXED - block port 5060 for outgoing requests (potentially mitigating NAT slipstreaming)") are to cause problems in enterprise environments?

Flags: needinfo?(mozilla)

|  | [Mike Kaply [:mkaply]](/user_profile?user_id=7313) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1677047#c9)• 4 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #8](/show_bug.cgi?id=1677047#c8 "RESOLVED FIXED - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list."))

> Mike, do you have any thoughts on how likely this and [bug 1674735](/show_bug.cgi?id=1674735 "RESOLVED FIXED - block port 5060 for outgoing requests (potentially mitigating NAT slipstreaming)") are to cause problems in enterprise environments?

Unfortunately I don't and I can't ask.

How are these flipped back by prefs exactly? the bug is changing hardcoded lists.

Do we know of any legitimate uses of these ports?

Flags: needinfo?(mozilla)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1677047#c10)• 4 years ago |
|  | |

Comment on [attachment 9187611](/attachment.cgi?id=9187611 "Bug 1677047 - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin") [[details]](/attachment.cgi?id=9187611&action=edit "Bug 1677047 - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin")

[Bug 1677047](/show_bug.cgi?id=1677047 "RESOLVED FIXED - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list.") - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin

Approved for 84.0b2.

[Attachment #9187611](/attachment.cgi?id=9187611&action=edit "Bug 1677047 - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677047#a382307_75935)• 4 years ago |

[Attachment #9187612](/attachment.cgi?id=9187612&action=edit "Bug 1677047 - Testing to block ports 1720, 1723, 554- r=valentin") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1677047#c11)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/7765e3dacb76>

<https://hg.mozilla.org/releases/mozilla-beta/rev/a2f75479c86e>

[status-firefox84](/buglist.cgi?f1=cf_status_firefox84&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=fixed)

|  | [Samy Kamkar](/user_profile?user_id=674148) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1677047#c12)• 4 years ago |
|  | |

Hi! I believe the following ports should additionally be blocked (otherwise the same attacks can likely continue to be employed) which I did not see in the two patches above. I've pulled these from the [Linux netfilter source](https://github.com/torvalds/linux/tree/master/net/netfilter) and [documented them here](https://samy.pl/slipstream/#linux-netfilter)):

* 6566 SANE
* 10080 Amanda
* 69 TFTP
* 161 SNMP
* 1719 H323 (RAS)
* 137 NetBIOS

Thanks! Please shoot over any questions.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1677047#c13)• 4 years ago |
|  | |

(In reply to Mike Kaply [:mkaply] from [comment #9](/show_bug.cgi?id=1677047#c9 "RESOLVED FIXED - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list."))

> (In reply to Ryan VanderMeulen [:RyanVM] from [comment #8](/show_bug.cgi?id=1677047#c8 "RESOLVED FIXED - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list."))
>
> > Mike, do you have any thoughts on how likely this and [bug 1674735](/show_bug.cgi?id=1674735 "RESOLVED FIXED - block port 5060 for outgoing requests (potentially mitigating NAT slipstreaming)") are to cause problems in enterprise environments?
>
> Unfortunately I don't and I can't ask.
>
> How are these flipped back by prefs exactly? the bug is changing hardcoded lists.

When going over the list, our code will check for the (non-default) `network.security.ports.banned.override` pref.

Any port in that list will not be blocked after all.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677047#a428703_428608)• 4 years ago |

Blocks: [CVE-2021-23961](/show_bug.cgi?id=1677940 "RESOLVED FIXED - Consider blocking ports 69, 137, 161, 1719, 6566, 10080")

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1677047#c14)• 4 years ago |
|  | |

(In reply to Samy Kamkar from [comment #12](/show_bug.cgi?id=1677047#c12 "RESOLVED FIXED - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list."))

> Hi! I believe the following ports should additionally be blocked (otherwise the same attacks can likely continue to be employed) which I did not see in the two patches above. I've pulled these from the [Linux netfilter source](https://github.com/torvalds/linux/tree/master/net/netfilter) and [documented them here](https://samy.pl/slipstream/#linux-netfilter)):
>
> * 6566 SANE
> * 10080 Amanda
> * 69 TFTP
> * 161 SNMP
> * 1719 H323 (RAS)
> * 137 NetBIOS
>
> Thanks! Please shoot over any questions.

I just realized I didn't respond to the comment. This has been fixed in [bug 1677940](/show_bug.cgi?id=1677940 "RESOLVED FIXED - Consider blocking ports 69, 137, 161, 1719, 6566, 10080"), which landed earlier in the week and should be ready for testing in Firefox Nightly.

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1677047#c15)• 4 years ago |
|  | |

Comment on [attachment 9187611](/attachment.cgi?id=9187611 "Bug 1677047 - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin") [[details]](/attachment.cgi?id=9187611&action=edit "Bug 1677047 - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin")

[Bug 1677047](/show_bug.cgi?id=1677047 "RESOLVED FIXED - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list.") - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin

approved for 78.6esr

[Attachment #9187611](/attachment.cgi?id=9187611&action=edit "Bug 1677047 - Add the ports for the H323, PPTP, RTSP protocols (1720, 1723, 554) to the restricted ports list. - r?valentin") -
Flags: approval-mozilla-esr78? → approval-mozilla-esr78+

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677047#a1754344_580382)• 4 years ago |

[Attachment #9187612](/attachment.cgi?id=9187612&action=edit "Bug 1677047 - Testing to block ports 1720, 1723, 554- r=valentin") -
Flags: approval-mozilla-esr78? → approval-mozilla-esr78+

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1677047#c16)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr78/rev/a11c295b7ec3>

<https://hg.mozilla.org/releases/mozilla-esr78/rev/64addb3cd358>

I had to adjust the test patch around [bug 1673485](/show_bug.cgi?id=1673485 "RESOLVED FIXED - [wpt-sync] Sync PR 26296 - Convert some Fetch tests to multi-global .any.js") hopefully I got it right.

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1677047#c17)• 4 years ago |
|  | |

Backed out for perma failures on websockets/Create-blocked-port.any.html:

<https://hg.mozilla.org/releases/mozilla-esr78/rev/a84355c618cace81392286f557b8f2874347aaae>

Push with failures: <https://treeherder.mozilla.org/jobs?repo=mozilla-esr78&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel%2Crunning%2Cpending%2Crunnable&revision=0724cae903ec40535803c41f61e45638377d8b5e&selectedTaskRun=PnBWafuzTsKZMZu6RsFxKA.0>

Failure log: <https://treeherder.mozilla.org/logviewer?job_id=323461686&repo=mozilla-esr78>

[task 2020-12-03T17:25:48.727Z] 17:25:48 INFO - TEST-UNEXPECTED-FAIL | /websockets/Create-blocked-port.any.worker.html | WebSocket blocked port test 554 - The operation is insecure.

[task 2020-12-03T17:25:48.728Z] 17:25:48 INFO - CreateWebSocketWithBlockedPort@[http://web-platform.test:8000/websockets/websocket.sub.js:43:12](http://web-platform.test:8000/websockets/websocket.sub.js%3A43%3A12)

[task 2020-12-03T17:25:48.728Z] 17:25:48 INFO - @[http://web-platform.test:8000/websockets/Create-blocked-port.any.js:83:46](http://web-platform.test:8000/websockets/Create-blocked-port.any.js%3A83%3A46)

[task 2020-12-03T17:25:48.729Z] 17:25:48 INFO - Test.prototype.step@[http://web-platform.test:8000/resources/testharness.js:1977:25](http://web-platform.test:8000/resources/testharness.js%3A1977%3A25)

[task 2020-12-03T17:25:48.729Z] 17:25:48 INFO - async\_test@[http://web-platform.test:8000/resources/testharness.js:571:22](http://web-platform.test:8000/resources/testharness.js%3A571%3A22)

[task 2020-12-03T17:25:48.730Z] 17:25:48 INFO - @[http://web-platform.test:8000/websockets/Create-blocked-port.any.js:82:13](http://web-platform.test:8000/websockets/Create-blocked-port.any.js%3A82%3A13)

[task 2020-12-03T17:25:48.730Z] 17:25:48 INFO - @[http://web-platform.test:8000/websockets/Create-blocked-port.any.js:81:3](http://web-platform.test:8000/websockets/Create-blocked-port.any.js%3A81%3A3)

[task 2020-12-03T17:25:48.730Z] 17:25:48 INFO - @[http://web-platform.test:8000/websockets/Create-blocked-port.any.worker.js:8:14](http://web-platform.test:8000/websockets/Create-blocked-port.any.worker.js%3A8%3A14)

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)Flags: needinfo?(fbraun)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1677047#c18)• 4 years ago |
|  | |

Can we land this without the websockets hunk, at <https://hg.mozilla.org/releases/mozilla-esr78/rev/64addb3cd358#l3.2>?

We're effectively hitting <https://bugzilla.mozilla.org/show_bug.cgi?id=1349969>, which I don't think is worth uplufting.

Flags: needinfo?(fbraun)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1677047#c19)• 4 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-esr78/rev/7bf70308594c9e45ffb289dfa568bdafcd9be7c7>

<https://hg.mozilla.org/releases/mozilla-esr78/rev/a6c739120affe725bfb9a15a778d8852c5e1760e>

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677047#a2097264_578488)• 4 years ago |

Whiteboard: [adv-main84+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1677047#c20)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9192461)
— [Details](attachment.cgi?id=9192461&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677047#a2368383_578488)• 4 years ago |

Whiteboard: [adv-main84+] → [adv-main84+][adv-esr78.6+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677047#a2371791_578488)• 4 years ago |

Alias: CVE-2020-26978

|  | [Masatoshi Kimura [:emk]](/user_profile?user_id=5842) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677047#a3517351_5842)• 4 years ago |

Regressions: [1684007](/show_bug.cgi?id=1684007 "RESOLVED WONTFIX - Port 554 Blocked after Update 84.0 (Linux)")

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677047#a5716883_428608)• 4 years ago |

Regressions: [1687282](/show_bug.cgi?id=1687282 "RESOLVED WONTFIX - Undo port blocking for port 554")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1677047#a12330908_1689)• 4 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1677047&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Frederik Braun [:freddy]](/user_profile?user_id=428608)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_d6b36419_20250119_112850.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Sun Jan 19 2025 03:28:49 PST

* **Bug ID:**
  1641287,
  1673299

---

| [ID](/buglist.cgi?bug_id=1641287%2C1673299&query_format=advanced&order=bug_id%20DESC&query_based_on=) | [Type](/buglist.cgi?bug_id=1641287%2C1673299&query_format=advanced&order=bug_type%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Summary](/buglist.cgi?bug_id=1641287%2C1673299&query_format=advanced&order=short_desc%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Product](/buglist.cgi?bug_id=1641287%2C1673299&query_format=advanced&order=product%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Comp](/buglist.cgi?bug_id=1641287%2C1673299&query_format=advanced&order=component%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Assignee▲](/buglist.cgi?bug_id=1641287%2C1673299&query_format=advanced&order=assigned_to%20DESC%2Cbug_status%2Cpriority%2Cbug_id&query_based_on=) | [Status▲](/buglist.cgi?bug_id=1641287%2C1673299&query_format=advanced&order=bug_status%20DESC%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Resolution](/buglist.cgi?bug_id=1641287%2C1673299&query_format=advanced&order=resolution%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Updated](/buglist.cgi?bug_id=1641287%2C1673299&query_format=advanced&order=changeddate%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [1641287](/show_bug.cgi?id=1641287 "RESOLVED FIXED - Malicious website can hijack Google search initiated from address bar") |  | [Malicious website can hijack Google search initiated from address bar](/show_bug.cgi?id=1641287) | Firefox | Address Bar | daisuke | RESO | FIXE | 2024-05-30 |
| [1673299](/show_bug.cgi?id=1673299 "RESOLVED FIXED - Fix hijacking issue caused by key types on the search bar") |  | [Fix hijacking issue caused by key types on the search bar](/show_bug.cgi?id=1673299) | Firefox | Search | daisuke | RESO | FIXE | 2022-01-24 |

2 bugs found.

|  |  | [REST](/rest/bug?include_fields=id,summary,status&bug_id=1641287%2C1673299 "Query as a REST API request") | [CSV](/buglist.cgi?bug_id=1641287%2C1673299&query_format=advanced&ctype=csv&human=1) | [Feed](/buglist.cgi?bug_id=1641287%2C1673299&query_format=advanced&title=Bug%20List&ctype=atom) | [iCalendar](/buglist.cgi?bug_id=1641287%2C1673299&query_format=advanced&ctype=ics)  [Change Columns](/colchange.cgi?bug_id=1641287%2C1673299&query_format=advanced&query_based_on=) | [Edit Search](/query.cgi?bug_id=1641287%2C1673299&query_format=advanced) |  | as |
| --- | --- | --- | --- | --- | --- |

[File
a new bug
in the "Firefox" product](/enter_bug.cgi?product=Firefox)



=== Content from www.mozilla.org_4647f489_20250119_112851.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-54

## Security Vulnerabilities fixed in Firefox 84

Announced
December 15, 2020
Impact
critical
Products
Firefox
Fixed in

* Firefox 84

#### [#CVE-2020-16042: Operations on a BigInt could have caused uninitialized memory to be exposed](#CVE-2020-16042)

Reporter
André Bargull
Impact
critical
##### Description

When a BigInt was right-shifted the backing store was not properly cleared, allowing uninitialized memory to be read.

##### References

* [Bug 1679003](https://bugzilla.mozilla.org/show_bug.cgi?id=1679003)

#### [#CVE-2020-26971: Heap buffer overflow in WebGL](#CVE-2020-26971)

Reporter
Omair, Abraruddin Khan
Impact
high
##### Description

Certain blit values provided by the user were not properly constrained leading to a heap buffer overflow on some video drivers.

##### References

* [Bug 1663466](https://bugzilla.mozilla.org/show_bug.cgi?id=1663466)

#### [#CVE-2020-26972: Use-After-Free in WebGL](#CVE-2020-26972)

Reporter
Brian Carpenter via the ASAN Nightly project
Impact
high
##### Description

The lifecycle of IPC Actors allows managed actors to outlive their manager actors; and the former must ensure that they are not attempting to use a dead actor they have a reference to. Such a check was omitted in WebGL, resulting in a use-after-free and a potentially exploitable crash.

##### References

* [Bug 1671382](https://bugzilla.mozilla.org/show_bug.cgi?id=1671382)

#### [#CVE-2020-26973: CSS Sanitizer performed incorrect sanitization](#CVE-2020-26973)

Reporter
Kai Engert
Impact
high
##### Description

Certain input to the CSS Sanitizer confused it, resulting in incorrect components being removed. This could have been used as a sanitizer bypass.

##### References

* [Bug 1680084](https://bugzilla.mozilla.org/show_bug.cgi?id=1680084)

#### [#CVE-2020-26974: Incorrect cast of StyleGenericFlexBasis resulted in a heap use-after-free](#CVE-2020-26974)

Reporter
Pham Bao of VinCSS (Member of Vingroup)
Impact
high
##### Description

When `flex-basis` was used on a table wrapper, a `StyleGenericFlexBasis` object could have been incorrectly cast to the wrong type. This resulted in a heap user-after-free, memory corruption, and a potentially exploitable crash.

##### References

* [Bug 1681022](https://bugzilla.mozilla.org/show_bug.cgi?id=1681022)

#### [#CVE-2020-26975: Malicious applications on Android could have induced Firefox for Android into sending arbitrary attacker-specified headers](#CVE-2020-26975)

Reporter
Pedro Oliveira
Impact
moderate
##### Description

When a malicious application installed on the user's device broadcast an Intent to Firefox for Android, arbitrary headers could have been specified, leading to attacks such as abusing ambient authority or session fixation. This was resolved by only allowing certain safe-listed headers.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1661071](https://bugzilla.mozilla.org/show_bug.cgi?id=1661071)

#### [#CVE-2020-26976: HTTPS pages could have been intercepted by a registered service worker when they should not have been](#CVE-2020-26976)

Reporter
Andrew Sutherland
Impact
moderate
##### Description

When a HTTPS pages was embedded in a HTTP page, and there was a service worker registered for the former, the service worker could have intercepted the request for the secure page despite the iframe not being a secure context due to the (insecure) framing.

##### References

* [Bug 1674343](https://bugzilla.mozilla.org/show_bug.cgi?id=1674343)

#### [#CVE-2020-26977: URL spoofing via unresponsive port in Firefox for Android](#CVE-2020-26977)

Reporter
andrew g
Impact
moderate
##### Description

By attempting to connect a website using an unresponsive port, an attacker could have controlled the content of a tab while the URL bar displayed the original domain.
 *Note: This issue only affects Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1676311](https://bugzilla.mozilla.org/show_bug.cgi?id=1676311)

#### [#CVE-2020-26978: Internal network hosts could have been probed by a malicious webpage](#CVE-2020-26978)

Reporter
Samy Kamkar, Ben Seri, and Gregory Vishnepolsky
Impact
moderate
##### Description

Using techniques that built on the slipstream research, a malicious webpage could have exposed both an internal network's hosts as well as services running on the user's local machine.

##### References

* [Bug 1677047](https://bugzilla.mozilla.org/show_bug.cgi?id=1677047)

#### [#CVE-2020-26979: When entering an address in the address or search bars, a website could have redirected the user before they were navigated to the intended url](#CVE-2020-26979)

Reporter
David Schütz
Impact
low
##### Description

When a user typed a URL in the address bar or the search bar and quickly hit the enter key, a website could sometimes capture that event and then redirect the user before navigation occurred to the desired, entered address. To construct a convincing spoof the attacker would have had to guess what the user was typing, perhaps by suggesting it.

##### References

* [Bug 1641287, 1673299](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1641287%2C1673299)

#### [#CVE-2020-35111: The proxy.onRequest API did not catch view-source URLs](#CVE-2020-35111)

Reporter
Yassine Tioual
Impact
low
##### Description

When an extension with the proxy permission registered to receive `<all_urls>`, the proxy.onRequest callback was not triggered for view-source URLs. While web content cannot navigate to such URLs, a user opening View Source could have inadvertently leaked their IP address.

##### References

* [Bug 1657916](https://bugzilla.mozilla.org/show_bug.cgi?id=1657916)

#### [#CVE-2020-35112: Opening an extension-less download may have inadvertently launched an executable instead](#CVE-2020-35112)

Reporter
Samuel Attard via the Chrome Security Team
Impact
low
##### Description

If a user downloaded a file lacking an extension on Windows, and then "Open"-ed it from the downloads panel, if there was an executable file in the downloads directory with the same name but with an executable extension (such as .bat or .exe) that executable would have been launched instead.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1661365](https://bugzilla.mozilla.org/show_bug.cgi?id=1661365)

#### [#CVE-2020-35113: Memory safety bugs fixed in Firefox 84 and Firefox ESR 78.6](#CVE-2020-35113)

Reporter
Christian Holler
Impact
high
##### Description

Mozilla developer Christian Holler reported memory safety bugs present in Firefox 83 and Firefox ESR 78.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 84 and Firefox ESR 78.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1664831%2C1673589)

#### [#CVE-2020-35114: Memory safety bugs fixed in Firefox 84](#CVE-2020-35114)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Christian Holler, Jan-Ivar Bruaroey, and Gabriele Svelto reported memory safety bugs present in Firefox 83. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 84](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1607449%2C1640416%2C1656459%2C1669914%2C1673567)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


