=== Content from github.com_bbdc1a0f_20250119_121118.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvanhoefm%2Ffragattacks%2Fblob%2Fmaster%2FSUMMARY.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvanhoefm%2Ffragattacks%2Fblob%2Fmaster%2FSUMMARY.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=vanhoefm%2Ffragattacks)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[vanhoefm](/vanhoefm)
/
**[fragattacks](/vanhoefm/fragattacks)**
Public

* [Notifications](/login?return_to=%2Fvanhoefm%2Ffragattacks) You must be signed in to change notification settings
* [Fork
  185](/login?return_to=%2Fvanhoefm%2Ffragattacks)
* [Star
   1.3k](/login?return_to=%2Fvanhoefm%2Ffragattacks)

* [Code](/vanhoefm/fragattacks)
* [Issues
  1](/vanhoefm/fragattacks/issues)
* [Pull requests
  0](/vanhoefm/fragattacks/pulls)
* [Actions](/vanhoefm/fragattacks/actions)
* [Projects
  0](/vanhoefm/fragattacks/projects)
* [Security](/vanhoefm/fragattacks/security)
* [Insights](/vanhoefm/fragattacks/pulse)

Additional navigation options

* [Code](/vanhoefm/fragattacks)
* [Issues](/vanhoefm/fragattacks/issues)
* [Pull requests](/vanhoefm/fragattacks/pulls)
* [Actions](/vanhoefm/fragattacks/actions)
* [Projects](/vanhoefm/fragattacks/projects)
* [Security](/vanhoefm/fragattacks/security)
* [Insights](/vanhoefm/fragattacks/pulse)

## Files

 master
## Breadcrumbs

1. [fragattacks](/vanhoefm/fragattacks/tree/master)
/
# SUMMARY.md

Copy path Blame  Blame
## Latest commit

## History

[History](/vanhoefm/fragattacks/commits/master/SUMMARY.md)32 lines (16 loc) · 4.72 KB master
## Breadcrumbs

1. [fragattacks](/vanhoefm/fragattacks/tree/master)
/
# SUMMARY.md

Top
## File metadata and controls

* Preview
* Code
* Blame

32 lines (16 loc) · 4.72 KB[Raw](https://github.com/vanhoefm/fragattacks/raw/refs/heads/master/SUMMARY.md)
# Summary of Vulnerabilities

## Design Flaws

* **CVE-2020-24588: Accepting non-SPP A-MSDU frames**: The 802.11 standard that underpins Wi-Fi Protected Access (WPA, WPA2, and WPA3) and Wired Equivalent Privacy (WEP) doesn't require that the A-MSDU flag in the plaintext QoS header field is authenticated. Against devices that support receiving non-SPP A-MSDU frames, which is mandatory as part of 802.11n, an adversary can abuse this to inject arbitrary network packets.
* **CVE-2020-24587: Reassembling fragments encrypted under different keys**: The 802.11 standard that underpins Wi-Fi Protected Access (WPA, WPA2, and WPA3) and Wired Equivalent Privacy (WEP) doesn't require that all fragments of a frame are encrypted under the same key. An adversary can abuse this to exfiltrate selected fragments when another device sends fragmented frames and the WEP, CCMP, or GCMP encryption key is periodically renewed.
* **CVE-2020-24586: Not clearing fragments from memory when (re)connecting to a network:** The 802.11 standard that underpins Wi-Fi Protected Access (WPA, WPA2, and WPA3) and Wired Equivalent Privacy (WEP) doesn't require that received fragments must be cleared from memory after (re)connecting to a network. Under the right circumstances, when another device sends fragmented frames encrypted using WEP, CCMP, or GCMP, this can be abused to inject arbitrary network packets and/or exfiltrate user data.

## Implementation flaws allowing trivial packet injection

* **CVE-2020-26145: Accepting plaintext broadcast fragments as full frames (in an encrypted network)**: Vulnerable WEP, WPA, WPA2, or WPA3 implementations accept second (or subsequent) broadcast fragments even when sent in plaintext and process them as full unfragmented frames. An adversary can abuse this to inject arbitrary network packets independent of the network configuration.
* **CVE-2020-26144: Accepting plaintext A-MSDU frames that start with an RFC1042 header with EtherType EAPOL (in an encrypted network)**: Vulnerable Wi-Fi implementations accept plaintext A-MSDU frames as long as the first 8 bytes correspond to a valid RFC1042 (i.e., LLC/SNAP) header for EAPOL. An adversary can abuse this to inject arbitrary network packets independent of the network configuration.
* **CVE-2020-26140: Accepting plaintext data frames in a protected network**: Vulnerable WEP, WPA, WPA2, or WPA3 implementations accept plaintext frames in a protected Wi-Fi network. An adversary can abuse this to inject arbitrary data frames independent of the network configuration.
* **CVE-2020-26143: Accepting *fragmented* plaintext data frames in a protected network**: Vulnerable WEP, WPA, WPA2, or WPA3 implementations accept fragmented plaintext frames in a protected Wi-Fi network. An adversary can abuse this to inject arbitrary data frames independent of the network configuration.

## Other Implementation Vulnerabilities

* **CVE-2020-26139: Forwarding EAPOL frames even though the sender is not yet authenticated**: Vulnerable Access Points (APs) forward EAPOL frames to other clients even though the sender has not yet successfully authenticated to the AP. An adversary might be able to abuse this in projected Wi-Fi networks to launch denial-of-service attacks against connected clients, and this makes it easier to exploit other vulnerabilities in connected clients.
* **CVE-2020-26146: Reassembling encrypted fragments with non-consecutive packet numbers**: Vulnerable WPA, WPA2, or WPA3 implementations reassemble fragments with non-consecutive packet numbers. An adversary can abuse this to exfiltrate selected fragments. This vulnerability is exploitable when another device sends fragmented frames and the WEP, CCMP, or GCMP data-confidentiality protocol is used. Note that WEP is vulnerable to this attack by design.
* **CVE-2020-26147: Reassembling mixed encrypted/plaintext fragments**: Vulnerable WEP, WPA, WPA2, or WPA3 implementations reassemble fragments even though some of them were sent in plaintext. This vulnerability can be abused to inject packets and/or exfiltrate selected fragments when another device sends fragmented frames and the WEP, CCMP, or GCMP data-confidentiality protocol is used.
* **CVE-2020-26142: Processing fragmented frames as full frames**: Vulnerable WEP, WPA, WPA2, or WPA3 implementations treat fragmented frames as full frames. An adversary can abuse this to inject arbitrary network packets, independent of the network configuration.
* **CVE-2020-26141: Not verifying the TKIP MIC of fragmented frames**: Vulnerable Wi-Fi implementations do not verify the Message Integrity Check (authenticity) of fragmented TKIP frames. An adversary can abuse this to inject and possibly decrypt packets in WPA or WPA2 networks that support the TKIP data-confidentiality protocol.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.fragattacks.com_b269443a_20250119_121118.html ===

![](images/logo.png)

### by [@vanhoefm](https://twitter.com/vanhoefm) of [KU Leuven](https://distrinet.cs.kuleuven.be/) / [NYU Abu Dhabi](https://nyuad.nyu.edu/en/research/faculty-labs-and-projects/nyuad-ccs.html)

Navigate page

* [Intro](#intro)
* [Demo](#demo)
* [Details](#details)
* [Paper](#paper)
* [Tools](#tools)
* [Q&A](#faq)

## [Introduction](#intro)

11 May 2021 —
This website presents FragAttacks (**fr**agmentation
and **ag**gregation **attacks**) which is a collection of new
security vulnerabilities that affect Wi-Fi devices. An adversary that is within range of a victim's Wi-Fi network can abuse these
vulnerabilities to steal user information or attack devices. Three of the discovered vulnerabilities are design flaws in the
Wi-Fi standard and therefore affect most devices. On top of this, several other vulnerabilities were discovered that are
caused by widespread programming mistakes in Wi-Fi products. Experiments indicate that every Wi-Fi product is affected
by at least one vulnerability and that most products are affected by several vulnerabilities.

The discovered vulnerabilities affect all modern security protocols of Wi-Fi, including the latest WPA3 specification.
Even the original security protocol of Wi-Fi, called WEP, is affected. This means that several of the newly discovered
design flaws have been part of Wi-Fi since its release in 1997!
Fortunately, the **design flaws are hard to abuse** because doing so requires user interaction or is only
possible when using uncommon network settings.
As a result, in practice the **biggest concern are the programming mistakes in Wi-Fi products** since
several of them are trivial to exploit.

The discovery of these vulnerabilities comes as a surprise, because the security of Wi-Fi has in fact significantly
improved over the past years.
For instance, previously we discovered the [KRACK attacks](https://www.krackattacks.com/), the defenses
against KRACK were [proven secure](https://www.usenix.org/conference/usenixsecurity20/presentation/cremers),
and the latest WPA3 security specification has [improved](https://www.wi-fi.org/file/wi-fi-security-roadmap-and-wpa3-updates-december-2020).
Unfortunately, a feature that could have prevented one of the newly discovered design flaws was not adopted in practice,
and the other two design flaws are present in a feature of Wi-Fi that was previously not widely studied.
This shows it stays important to analyze even the most well-known security protocols (if you want to help,
we are [hiring](#hiring)). Additionally, it shows that it's essential to regularly
test Wi-Fi products for security vulnerabilities, which can for instance be done when certifying them.

To protect users, security updates were prepared during a 9-month-long coordinated disclosure that was supervised by
the [Wi-Fi Alliance](https://www.wi-fi.org/security-update-fragmentation) and
[ICASI](https://www.icasi.org/aggregation-fragmentation-attacks-against-wifi/). If updates for your device
are not yet available, you can [mitigate](#notpatched) some attacks (but not all)
by assuring that websites use HTTPS and by assuring that your devices received all other available updates.

The research will be presented at the [USENIX Security](#usenixpres) conference and a longer talk with more background will also be given at
[Black Hat USA](https://blackhat.com/us-21/briefings/schedule/index.html#fragattacks-breaking-wi-fi-through-fragmentation-and-aggregation-23518)
this summer.

## [Demo](#demo)

The following video shows three examples of how an adversary can abuse the vulnerabilities. First,
the aggregation design flaw is abused to intercept sensitive information (e.g. the victim's username and password).
Second, it's shown how an adversary can exploit insecure internet-of-things
devices by remotely turning on and off a smart power socket. Finally, it's demonstrated how the
vulnerabilities can be abused as a stepping stone to launch advanced attacks. In particular, the video shows how an adversary
can take over an outdated Windows 7 machine inside a local network.

As the demo illustrates, the Wi-Fi flaws can be abused in two ways. First, under the right conditions they can be abused
to steal sensitive data. Second, an adversary can abuse the Wi-Fi flaws to attack devices in someone's home network.

The biggest risk in practice is likely the ability to abuse the discovered flaws to attack devices in someone's home network.
For instance, many smart home and [internet-of-things](https://en.wikipedia.org/wiki/Internet_of_things#Consumer_applications)
devices are rarely updated, and Wi-Fi security is the last line of defense that prevents someone from attacking
these devices. Unfortunately, due to the discover vulnerabilities, this last line of defense can now be bypassed.
In the demo above, this is illustrated by remotely controlling a smart power plug and by taking over an outdated Windows 7 machine.

The Wi-Fi flaws can also be abused to exfiltrate transmitted data. The demo shows how this can be abused to learn
the username and password of the victim when they use the NYU website. However, when a website is configured with
[HSTS](https://www.eff.org/deeplinks/2014/02/websites-hsts) to always
use [HTTPS](https://en.wikipedia.org/wiki/HTTPS) as an extra layer of security, which nowadays
[close](https://www.troyhunt.com/padlocks-phishing-and-privacy-the-value-proposition-of-a-vpn/#1-https-still-has-a-long-way-to-go)
[to](https://twitter.com/Scott_Helme/status/1305605547106983951)
[20%](https://w3techs.com/technologies/details/ce-hsts) of websites are,
the transmitted data cannot be stolen.
Additionally, several browsers now [warn](https://www.blog.google/products/chrome/milestone-chrome-security-marking-http-not-secure)
the user when HTTPS is not being used.
Finally, although [not always](https://www.usenix.org/conference/usenixsecurity21/presentation/oltrogge) perfect,
recent mobile apps by default use HTTPS and therefore also use this extra protection.

## [Details](#details)

### [Presentations](#presentations)

If you don't want to read the following text, you can also watch my [USENIX Security](#usenixpres)
or [WAC4](#wac4pres) presentation.

### [Plaintext injection vulnerabilities](#plaininject)

Several implementation flaws can be abused to easily inject frames into a protected Wi-Fi network. In particular, an adversary
can often inject an unencrypted Wi-Fi frame by carefully constructing this frame. This can for instance be abused to
intercept a client's traffic by tricking the client into using a [malicious DNS server](#extradocs) as shown in the
[demo](#demo) (the intercepted traffic may have [another layer of protection](https://en.wikipedia.org/wiki/HTTPS) though).
Against routers this can also be abused to [bypass the NAT/firewall](#extadocs), allowing the adversary to
subsequently attack devices in the local Wi-Fi network (e.g. attacking an outdated Windows 7 machine as shown in the [demo](#demo)).

How can the adversary construct unencrypted Wi-Fi frames so they are accepted by a vulnerable device?
First, certain Wi-Fi devices **accept any unencrypted frame even when connected to a protected Wi-Fi network**.
This means the attacker doesn't have to do anything special!
Two of out of four tested home routers were affected by this vulnerability, several internet-of-things devices were affected,
and some smartphones were affected. Additionally, many Wi-Fi dongles on Windows will wrongly accept plaintext frames when
they are split into several (plaintext) fragments.

Additionally, certain devices **accept plaintext aggregated frames that look like handshake messages**.
An adversary can exploit this by sending an aggregated frame whose starts resembles a handshake message and whose second
subframe contains the packet that the adversary wants to inject.
A vulnerable device will first interpret this frame as a handshake message, but will subsequently process it as an aggregated frame.
In a sense, one part of the code will think the frame is a handshake message and will accept it even though it's not encrypted.
Another part of the code will instead see it as an aggregated frame and will process the packet that the adversary wants to inject.

![](images/tenor.gif)

A plaintext aggregated frame that also looks like a handshake message ☺

Finally, several devices process broadcasted fragments as normal unfragmented frames. More problematic, some devices
**accept broadcast fragments even when sent unencrypted**.
An attacker can abuse this to inject packets by encapsulating them in the second fragment of a plaintext broadcast frame.

### [Design flaw: aggregation attack](#aggregationattack "CVE-2020-24588")

The first design flaw is in the frame aggregation feature of Wi-Fi. This feature increases the speed and throughput of a network
by combining small frames into a larger aggregated frame. To implement this feature, the header of each frame contains a flag that
indicates whether the (encrypted) transported data contains a single or aggregated frame. This is illustrated in the following figure:

Unfortunately,
this **"is aggregated" flag is not authenticated** and can be modified by an adversary, meaning a victim can
be tricked into processing the encrypted transported data in an unintended manner. An adversary can abuse this to inject
arbitrary network packets by tricking the victim into connecting to their server and then setting the "is aggregated" flag
of carefully selected packets. Practically all tested devices were vulnerable to this attack. The ability to inject packets
can in turn be abused to intercept a victim’s traffic by making it use a malicious DNS server (see the [demo](#demo)).

This design flaw can be fixed by authenticating the "is aggregated" flag. The Wi-Fi standard already contains a feature to
authenticate this flag, namely requiring SPP A-MSDU frames, but this defense is not backwards-compatible and not supported
in practice. Attacks can also be mitigated using an ad-hoc fix, though new attacks may remain possible.

### [Design flaw: mixed key attack](#mixedkeyattack "CVE-2020-24587")

The second design flaw is in the frame fragmentation feature of Wi-Fi. This feature increases the reliability of a connection
by splitting large frames into smaller fragments. When doing this, every fragment that belongs to the
same frame is encrypted using the same key. However, receivers are not required to check this and will **reassemble fragments
that were decrypted using different keys**.
Under rare conditions this can be abused to exfiltrate data. This is accomplished by mixing fragments that are encrypted under different keys,
as illustrated in the following figure:

In the above figure, the first fragment received by the access point is decrypted using a different key
than the second fragment. Nevertheless, the victim will reassemble both fragments. In practice this allows
an adversary to exfiltrate selected client data.

This design flaw can be fixed in a backwards-compatible manner by only reassembling fragments
that were decrypted using the same key.
Because the attack is only possible under rare conditions **it is considered a theoretical attack**.

### [Design flaw: fragment cache attack](#fragcacheattack "CVE-2020-24586")

The third design flaw is also in Wi-Fi's frame fragmentation feature. The problem is that, when a client disconnects
from the network, the Wi-Fi device is **not required to remove non-reassembled fragments from memory**.
This can be abused against hotspot-like networks such as [eduroam and govroam](https://en.wikipedia.org/wiki/Eduroam)
and against enterprise network where users distrust each other. In those cases, selected data sent by the victim can be
exfiltrated. This is achieved by injecting a malicious fragment in the memory (i.e. fragment cache) of the access point.
When the victim then connects to the access point and sends a fragmented frame, selected fragments will be combined (i.e. reassembled)
with the injected fragment of the adversary. This is illustrated in the following figure:

In the above figure, the adversary injects the first fragment into the fragment cache of the access point. After the
adversary disconnects the fragment stays in the fragment cache and will be reassembled with a fragment of the victim.
If the victim sends fragmented frames, which appears uncommon in practice, this can be abused to exfiltrate data.

This design flaw can be fixed in a backwards-compatible manner by removing fragments from memory whenever disconnecting
or (re)connecting to a network.

### [Other implementation vulnerabilities](#codeflaws)

Some routers will forward handshake frames to another client even when the sender hasn't
authenticated yet. This vulnerability allows an adversary to perform the aggregation attack,
and inject arbitrary frames, without user interaction.

Another extremely common implementation flaw is that receivers do not check whether all
fragments belong to the same frame, meaning an adversary can trivially forge frames by mixing the fragments of two
different frames.

Additionally, against several implementations it is possible to mix encrypted and plaintext fragments.

Finally, some devices don't support fragmentation or aggregation, but are still vulnerable to attacks
because they process fragmented frames as full frames. Under the right circumstances this
can be abused to inject packets.

### [Assigned CVE identifiers](#cves)

An overview of all assigned Common Vulnerabilities and Exposures (CVE) identifiers can be found
[on GitHub](https://github.com/vanhoefm/fragattacks/blob/master/SUMMARY.md),
and there is a list of [known advisories](https://github.com/vanhoefm/fragattacks/blob/master/ADVISORIES.md) from companies.
Summarized, the design flaws were assigned the following CVEs:

* [CVE-2020-24588](https://nvd.nist.gov/vuln/detail/CVE-2020-24588): aggregation attack (accepting non-SPP A-MSDU frames).
* [CVE-2020-24587](https://nvd.nist.gov/vuln/detail/CVE-2020-24587): mixed key attack (reassembling fragments encrypted under different keys).
* [CVE-2020-24586](https://nvd.nist.gov/vuln/detail/CVE-2020-24586): fragment cache attack (not clearing fragments from memory when (re)connecting to a network).

Implementation vulnerabilities that allow the trivial injection of plaintext frames in a protected Wi-Fi network are assigned the following CVEs:

* [CVE-2020-26145](https://nvd.nist.gov/vuln/detail/CVE-2020-26145): Accepting plaintext broadcast fragments as full frames (in an encrypted network).
* [CVE-2020-26144](https://nvd.nist.gov/vuln/detail/CVE-2020-26144): Accepting plaintext A-MSDU frames that start with an RFC1042 header with EtherType EAPOL (in an encrypted network).
* [CVE-2020-26140](https://nvd.nist.gov/vuln/detail/CVE-2020-26140): Accepting plaintext data frames in a protected network.
* [CVE-2020-26143](https://nvd.nist.gov/vuln/detail/CVE-2020-26143): Accepting fragmented plaintext data frames in a protected network.

Other implementation flaws are assigned the following CVEs:

* [CVE-2020-26139](https://nvd.nist.gov/vuln/detail/CVE-2020-26139): Forwarding EAPOL frames even though the sender is not yet authenticated (should only affect APs).
* [CVE-2020-26146](https://nvd.nist.gov/vuln/detail/CVE-2020-26146): Reassembling encrypted fragments with non-consecutive packet numbers.
* [CVE-2020-26147](https://nvd.nist.gov/vuln/detail/CVE-2020-26147): Reassembling mixed encrypted/plaintext fragments.
* [CVE-2020-26142](https://nvd.nist.gov/vuln/detail/CVE-2020-26142): Processing fragmented frames as full frames.
* [CVE-2020-26141](https://nvd.nist.gov/vuln/detail/CVE-2020-26141): Not verifying the TKIP MIC of fragmented frames.

For each implementation vulnerability we listed the reference CVE identifier.
Although each affected codebase normally receives a unique CVE,
the agreement between affected vendors was that, in this specific case,
using the same CVE across different codebases would make communication easier.
For instance, by tying one CVE to each vulnerability, a customer can now ask a vendor
whether their product is affected by a specific CVE.

Please note that this deviates from normal MITRE guidelines, and that this decision was made
by affected vendors independently of MITRE, and that this in no way reflects any changes in how MITRE assigns CVEs.

## [Paper](#paper)

Our paper behind the attack is titled
[Fragment and Forge: Breaking Wi-Fi Through Frame Aggregation and Fragmentation](https://papers.mathyvanhoef.com/usenix2021.pdf)
and was presented at [USENIX Security](https://www.usenix.org/conference/usenixsecurity21/presentation/vanhoef).
You can use the following bibtex entry to cite our paper:

```
@inproceedings{vanhoef-usenix2021-fragattacks,
  author = {Mathy Vanhoef},
  title = {Fragment and Forge: Breaking {Wi-Fi} Through Frame Aggregation and Fragmentation},
  booktitle = {Proceedings of the 30th {USENIX} Security Symposium},
  year = {2021},
  month = {August},
  publisher = {{USENIX} Association}
}
```
### [Paper Clarifications](#papernotes)

* In the paper in Section 6 regarding implementation vulnerabilities, when a tested device accepts plaintext frames, it will also accepted fragmented plaintext frames (Table 1, 2, and 3).

### [USENIX Security Presentation](#usenixpres)

The pre-recorded presentation made for USENIX Security can already be viewed online. Note that the target audience
of this presentation are academics and IT professionals:

### [Workshop on Attacks on Cryptography Presentation](#wac4pres)

A longer presentation that covers more details is the one that I gave at the WAC4 workshop:

### [Extra Documents](#extadocs)

* An [overview](https://papers.mathyvanhoef.com/fragattacks-overview.pdf) of all
  **attacks and their preconditions**. It also contains two extra examples on how an
  adversary can: (1) abuse packet injection vulnerabilities to make a victim use a malicious DNS; and
  (2) how packet injection can be abused to bypass the NAT/firewall of a router.
* [Slides](https://papers.mathyvanhoef.com/fragattacks-slides-amsdu.pdf) illustrating
  how the aggregation attack (CVE-2020-24588) works in practice. Performing this attack requires tricking
  the victim into connecting to the adversary's server. This can be done by making the victim download an
  image from the adversary’s server. Note that JavaScript code execution on the victim is not required.
* [Detailed slides](https://papers.mathyvanhoef.com/fragattacks-slides-2021-03-8.pdf)
  giving an in-depth explanation of each discovered vulnerability.* [Overview slides](https://papers.mathyvanhoef.com/fragattacks-slides-summary-2021-03-8.pdf)
    illustrating only the root cause of each discovered vulnerability.

## [Tools](#tools)

A [tool was made](https://github.com/vanhoefm/fragattacks) that can test if clients or APs are
affected by the discovered design and implementations flaws. It can test home networks and enterprise networks where
authentication is done using, e.g., PEAP-MSCHAPv2 or EAP-TLS. The **tool supports over 45 test cases** and requires modified
drivers in order to reliable test for the discovered vulnerabilities. Without modified drivers, one may wrongly conclude
that a device is not affected while in reality it is.

A **live USB image** is [also available](https://github.com/vanhoefm/fragattacks#id-live-image).
This image contains pre-installed modified drivers, modified firmware for certain Atheros USB dongles, and a
pre-configured Python environment for the tool. Using a live image is useful when you cannot install the modified
drivers natively (and using a virtual machine can be unreliable for some network cards).

Apart from a tool to test if a device is vulnerable I also made proof-of-concepts to exploit weaknesses. Because not all
devices currently have received updates these attacks scripts will be released at a later point if deemed useful.

## [Q&A](#faq)

* [How can I contact you?](#contact)
* [Are you looking for PhD students?](#hiring)
* [Can I reuse the images on this website?](#images)
* [Why did nobody notice the aggregation design flaw before?](#ieeenoticed)
* [Why was the defense against the aggregation attack (CVE-2020-24588) not adopted?](#whynotadopted)
* [My device isn't patched yet, what can I do?](#notpatched)
* [Does using EAP-TLS increase the difficulty of attacks?](#eaptls)
* [Does using 802.11w help mitigate attacks?](#mfp)
* [Why is Wi-Fi security important? We already have HTTPS.](#whyimportant)
* [Will using a VPN prevent attacks?](#vpn)
* [How did you discover this?](#howfound)
* [How sure are you that all Wi-Fi devices are affected?](#allaffected)
* [Does this mean every Wi-Fi device is trivial to attack?](#istrivial)
* [How many networks use fragmentation?](#usagefrag)
* [How many networks periodically refresh the pairwise session key?](#usagerenew)
* [Isn't it irresponsible to release tools to perform the attacks?](#abusetools)
* [Where are all the attack tools?](#attacktools)
* [Do you have example network captures of the vulnerabilities?](#captures)
* [How long will you maintain the driver patches needed to run the test scripts?](#maintaindriver)
* [Why are so many implementations vulnerable to be non-consecutive PN attack?](#nonsecdesign)
* [Why are so many implementations vulnerable to the mixed plaintext/encrypted fragment attack?](#mixeddesign)
* [Can an implementation be vulnerable to a cache attack without being vulnerable to a mixed key attack?](#cachenotmixed)
* [Can the mixed-key attack be prevented in a backward-compatible manner?](#mixedbackward)
* [Is the old WPA-TKIP protocol also affected by the design flaws?](#tkip)
* [Is the ancient WEP protocol also affected by the design flaws?](#wep)
* [Can fragmentation attacks be preventing by disallowing small delays between fragments?](#fragdelays)
* [Are patches for Linux available?](#patchlinux)
* [Did others also discover the plaintext injection issue (CVE-2020-26140)?](#plainothers)
* [Why do you use the same CVE for implementation issues in multiple different codebases?](#samecves)
* [Why was the embargo so long?](#longembargo)
* [How did you monitor for leaks during the embargo?](#detectleaks)
* [Are these vulnerabilities being exploited in practice?](#beingexploit)
* [Why did Microsoft already fix certain vulnerabilities on March 9, 2021?](#microsoft)
* [Is the "Treating fragments as full frames" flaw (CVE-2020-26142) also applicable to APs?](#apfragasfull)
* [Can APs be vulnerable to attacks that send broadcast frames?](#aprecievebcast)
* [Why are some of the tested devices so old?](#whyold)
* [How did you make macOS switch to the malicious DNS server in the demonstration?](#forcebaddns)
* [Isn't nyu.edu using HSTS to prevent these kind of attacks?](#nyuhsts)
* [How do I reproduce the BlueKeep attack shown in the demonstration?](#bluekeep)

### [How can I contact you?](#contact)

You can reach Mathy Vanhoef on twitter at [@vanhoefm](https://www.twitter.com/vanhoefm)
or by emailing mathy.vanhoef@nyu.edu.

### [Are you looking for PhD students?](#hiring)

Yes! Mathy Vanhoef will be starting as a professor at KU Leuven University (Belgium) later this year and is
looking for a **PhD student**. The precise topic you want to work on can be discussed. If you're
a master student at KU Leuven you can also contact me to discuss a **Master's thesis** topic.
Note that the [DistriNet](https://distrinet.cs.kuleuven.be/jobs/) group at KU Leuven is also recruiting
in security-related research fields.

If you want to do network research at New York University Abu Dhabi in the
[Cyber Security & Privacy (CSP)](https://nyuad.nyu.edu/en/research/faculty-labs-and-projects/cybersecurity-and-privacy-lab.html)
team where the FragAttacks research was carried out, you can contact [Christina Pöpper](https://poepper.net/).

### [Can I reuse the images on this website?](#images)

Yes, you can use the [logo](images/logo.png), illustrations of the [aggregation](images/aggregated.png)
design flaw ([mobile version](images/aggregatedsmall.png)),
illustrations of the [mixed key](images/mixedkey.png) design flaw ([mobile version](images/mixedkeysmall.png)),
and illustrations of the [fragment cache](images/fragmentcache.png) design flaw ([mobile version](images/fragmentcachesmall.png)).

Thanks goes to [Darlee Urbiztondo](https://www.thehappylee.com/graphic-design-projects) for designing the logo.

### [Why did nobody notice the aggregation design flaw before?](#ieeenoticed)

When the 802.11n amendment was being written in 2007, which introduced supported for aggregated (A-MSDU) frames,
[several IEEE members](https://mentor.ieee.org/802.11/dcn/07/11-07-0397-07-000n-msdu-protection.doc)
noticed that the "is aggregated" flag was not authenticated. Unfortunately, many products already implemented
a draft of the 802.11n amendment, meaning this problem had to be addressed in a backwards-compatible manner.
The decision was made that devices would advertise whether they are capable of authenticating the "is aggregated"
flag. Only when devices implement and advertise this capability is the "is aggregated" flag protected. Unfortunately,
in 2020 not a single tested device supported this capability, likely because it was considered hard to exploit.
[To quote](https://mentor.ieee.org/802.11/dcn/07/11-07-0397-07-000n-msdu-protection.doc) a remark
made back in 2007:
*"While it is hard to see how this can be exploited, it is clearly a flaw that is capable of being fixed."*

In other words, people did notice this vulnerability and a defense was standardized, but in practice the defense
was never adopted. This is a good example that security defenses must be adopted before attacks become practical.

### [Why was the defense against the aggregation attack (CVE-2020-24588) not adopted?](#whynotadopted)

Likely because it was only considered a theoretic vulnerability when the defense was created.
[To quote](https://mentor.ieee.org/802.11/dcn/07/11-07-0397-07-000n-msdu-protection.doc) a remark
made back in 2007:
*"While it is hard to see how this can be exploited, it is clearly a flaw that is capable of being fixed."*

Additionally, the threat model that was used in the aggregation attack, were the victim is induced into connecting to the
adversary's server, only become widely accepted in 2011 after the disclosure of the [BEAST](https://en.wikipedia.org/wiki/Transport_Layer_Security#BEAST_attack)
attack. In other words, the threat model was not yet widely known back in 2007 when the IEEE added the optional feature
that would have prevented the attack. And even after this threat model became more common,
the resulting attack isn't obvious.

### [My device isn't patched yet, what can I do?](#notpatched)

First, it's always good to remember general security best practices: update your devices, don't reuse your passwords,
make sure you have backups of important data, don't visit shady websites, and so on.

In regards to the discovered Wi-Fi vulnerabilities, you can mitigate attacks that exfiltrate sensitive data by
double-checking that websites you are visiting
[use HTTPS](https://www.blog.google/products/chrome/milestone-chrome-security-marking-http-not-secure).
Even better, you can install the [HTTPS Everywhere](https://www.eff.org/https-everywhere) plugin. This plugin
forces the usage of HTTPS on websites that are known to support it.

To mitigate attacks where your router's NAT/firewall is bypassed and devices are directly attacked, you must assure that
all your devices are updated. Unfortunately, not all products regularly receive updates, in particular smart or internet-of-things
devices, in which case it is difficult (if not impossible) to properly secure them.

More technically, the impact of attacks can also be reduced by manually configuring your DNS server so that it cannot be poisoned.
Specific to your Wi-Fi configuration, you can mitigate attacks (but not fully prevent them) by disabling fragmentation,
disabling pairwise rekeys, and disabling dynamic fragmentation in Wi-Fi 6 (802.11ax) devices.

### [Does using EAP-TLS increase the difficulty of attacks?](#eaptls)

No. All attacks are possible no matter how the client authenticates the network. In other words, attacks are identical
against home and enterprise networks. Moreover, it doesn't matter which EAP method you use in an enterprise network:
all attacks remain possible and can be abused in exactly the same manner.

Important to remark is that exploiting the design flaws relies on a multi-channel machine-in-the-middle position
(and abusing CVE-2020-26146 relies on this MitM as well). This MitM is not a traditional rogue AP. Instead, the attacker
is copying all frames from the real AP to a different Wi-Fi channel. This can be done no matter which authentication method
the network is using. You can read more about this MitM in
[my blog post](https://www.mathyvanhoef.com/2021/05/fragattacks-clarifying-some-aspects.html#rogue-ap).

### [Does using 802.11w help mitigate attacks?](#mfp)

No. Using 802.11w, also known as management frame protection, has no impact on any of the attacks. Even attacks that rely
on the multi-channel machine-in-the-middle position (i.e. the design flaws and CVE-2020-26146) remain possible when using 802.11w.
This is because this MitM isn't established
by sending deauthentication or disassociation frames to first disconnect the client from the network. Instead, to establish
this MitM, the attacker forces the client to switch to another channel. This is accomplished by spoofing beacon frames
that contain malicious Channel Switch Announcements. These beacon frames can be spoofed even when 802.11w is enabled, meaning
that enabling 802.11w won't make attacks harder.

You can read more about the multi-channel MitM in
[my blog post](https://www.mathyvanhoef.com/2021/05/fragattacks-clarifying-some-aspects.html#rogue-ap).
This MitM can be established in precisely the same manner whether or not 802.11w is used.

### [Why is Wi-Fi security important? We already have HTTPS.](#whyimportant)

These days a lot of websites and apps use [HTTPS](https://en.wikipedia.org/wiki/HTTPS) to encrypt data.
When using HTTPS, an adversary cannot see the data you are transmitting even when you are connected to an open Wi-Fi network.
This also means that you can safely use open Wi-Fi hotspots as long as you keep your devices up-to-date and as long as you assure
that websites are using HTTPS. Unfortunately, not all websites require the usage of HTTPS (i.e. they're not using
[HSTS](https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security)), meaning they remain
vulnerable to possible attacks.

At home, the security of your Wi-Fi network is also essential. An insecure network means that others might be able
to connect to the internet through your home. Additionally, more and more devices are using Wi-Fi to transfer personal
files in your local network without an extra layer of protection (e.g. when printing files, smart display screens, when
sending files to a local backup storage, digital photo stands, and so on). More problematic, a lot of internet-of-things devices have tons
of security vulnerabilities that can be exploited if an adversary can communicate with them. The main thing that prevents
an adversary from exploiting these insecure internet-of-things devices is the security of your Wi-Fi network. It therefore
remains essential to have strong encryption and authentication at the Wi-Fi layer.

At work, the security of Wi-Fi is also essential for the same reasons as mentioned above. Additionally, many
companies will automatically allow access to sensitive services when a user (or adversary) is able to
connect to the Wi-Fi network. Therefore strong Wi-Fi security is also essential in a work setting.

### [Will using a VPN prevent attacks?](#vpn)

Using a VPN can prevent attacks where an adversary is trying to exfiltrate data. It will not prevent an
adversary from bypassing your router's NAT/firewall to directly attack devices.

### [How did you discover this?](#howfound)

The seeds of this research were already planted while I was investigating the [KRACK attack](https://krackattacks.com).
At that time, on 8 June 2017 to be
precise, I wrote down some notes to further investigate (de)fragmentation support in Linux. In particular, I thought there might be an
implementation vulnerability in Linux. However, a single unconfirmed implementation flaw isn't too spectacular research-wise, so after disclosing
the KRACK attack I decided to work on other research instead. The idea of inspecting (de)fragmentation in Wi-Fi, and determining whether
there really was a vulnerability or not, was always at the back of my mind though.

Fast-forward three years later, and after gaining some additional ideas to investigate, closer inspection confirmed some of my hunches
and also revealed that these issues were more widespread than I initially assumed. And with some extra insights I also discovered all
the other vulnerabilities. Interestingly, this also shows the advantage of fleshing out ideas before rushing to publish (though actually
finishing the paper before submission was still a race against time..).

### [How sure are you that all Wi-Fi devices are affected?](#allaffected)

In experiments on more than 75 devices, all of them were vulnerable to one or more of the discovered attacks.
I'm curious myself whether *all* devices in the whole world are indeed affected though! To find this out, if you
find a device that isn't affected by at least one of the discovered vulnerabilities, let me know.

Also, if your company provides Wi-Fi devices and you think that your product was not affected by any of the discovered vulnerabilities,
you can send your product to me. Once I confirmed that it indeed was not affected by any vulnerabilities the name of
your product and company will be put here! Note that I do need a method to assure that I'm indeed testing a version
of the product that was available before the disclosure of the vulnerabilities (and that you didn't silently patch
some vulnerabilities).

### [Does this mean every Wi-Fi device is trivial to attack?](#istrivial)

The design issues are, on their own, tedious to exploit in practice. Unfortunately, some of the implementation
vulnerabilities are common and trivial to exploit. Additionally, by combining the design issues with certain implementation
issues, the resulting attacks become more serious. This means the impact of our findings depends on the specific
target. Your vendor can inform you what the precise impact is for specific devices. In other words, for some devices
the impact is minor, while for others it's disastrous.

### [How many networks use fragmentation?](#usagefrag)

By default devices don't send fragmented frames. This means that the mixed key attack and the fragment cache attack,
on their own, will be hard to exploit in practice, unless Wi-Fi 6 is used. When using Wi-Fi 6, which is based on the
802.11ax standard, a device may dynamically fragment frames to fill up available airtime.

### [How many networks periodically refresh the pairwise session key?](#usagerenew)

By default access points don't renew the pairwise session key, even though some may periodically renew the group key.
This means that the default mixed key attack as described in the paper is only possible against networks that deviate from
this default setting.

### [Isn't it irresponsible to release tools to perform the attacks?](#abusetools)

The test tool that we released can only be used to test whether a device is vulnerable. It cannot be used
to perform attacks: an adversary would have to write their own tools for that. This approach enables network
administrators to test if devices are affected while reducing the chance of someone abusing the released code.

### [Where are all the attack tools?](#attacktools)

The code that has currently been released focusses on *detecting* vulnerable implementations. The proof-of-concepts
scripts that perform actual attacks are not released to provide everyone with more time to implement and deploy patches.
Once a large enough fraction of devices has been patched, and if deemed necessary and/or beneficial, the attack script
will be publicly released as well.

### [Do you have example network captures of the vulnerabilities?](#captures)

There are example [network captures](https://github.com/vanhoefm/fragattacks/tree/master/example-pcaps) of the
[test tool](#tools) that illustrate the root causes of several vulnerabilities.

### [How long will you maintain the driver patches needed to run the test scripts?](#maintaindriver)

The modifications to certain drivers have been submitted upstream to Linux meaning they will be maintained by the Linux developers
themselves. The patches to the Intel driver have not been submitted upstream because they're a bit hacky. Concretely, this means that
drivers such as ath9k\_htc will be supported out of the box, while for Intel devices you will have to use patched drivers and I'm not
sure how much time I'll have to maintain those.

### [Why are so many implementations vulnerable to be non-consecutive PN attack?](#nonsecdesign)

That's a good question. I'm not sure why so many developers missed this. This widespread implementation vulnerability
does highlight that leaving important cryptographic operations up to developers is not ideal. Put another way, it might
have been better if the standard required an authenticity check over the reassembled frame instead. That would also better
follow the principle of authenticated encryption.

### [Why are so many implementations vulnerable to the mixed plaintext/encrypted fragment attack?](#mixeddesign)

The 802.11 standard states in section 10.6: "If security encapsulation has been applied to the fragment, it shall be
deencapsulated and decrypted before the fragment is used for defragmentation of the MSDU or MMPDU". There is unfortunately
no warning that unencrypted *fragments* should be dropped. And there are no recommend checks that should be
performed when reassembling two (decrypted) fragments.

### [Can an implementation be vulnerable to a cache attack without being vulnerable to a mixed key attack?](#cachenotmixed)

Yes, although this is unlikely to occur in practice. More technically, let's assume that an implementation tries to prevent mixed key
attacks by: (1) assigning an unique key ID to every fragment; (2) incrementing this key ID whenever the pairwise transient
key (PTK) is updated; and (3) assuring all fragments were decrypted under the same key ID. Unfortunately, in that case
cache attacks may still be feasible. In particular, if under this defense key IDs are reused
after (re)connecting to a network, for example because they are reset to zero, fragments that are decrypted
using a different key may still be assigned the same key ID. As a result, cache attacks remain possible, because the
fragments will still be reassembled as they have the same key ID.

### [Can the mixed-key attack be prevented in a backward-compatible manner?](#mixedbackward)

Strictly speaking not, because the 802.11 standard does not explicitly require that a sender encrypts all fragments
of a specific frame under the same key. Fortunately, all implementations that we tested did encrypt all fragments using
the same key, at least under the normal circumstances that we tested, meaning in practice the mixed key attack can be
prevented without introducing incompatibilities.

### [Is the old WPA-TKIP protocol also affected by the design flaws?](#tkip)

Strictly speaking not, though implementations can still be vulnerable. Note that TKIP should not be used because it
is affected by other more serious security flaws. Additionally, TKIP has been
[deprecated](https://www.wi-fi.org/file/technical-note-removal-of-tkip-from-wi-fi-devices) by the Wi-Fi Alliance.

The TKIP protocol is not affected by the fragmentation-based design flaws (CVE-2020-24587 and CVE-2020-24586) because it
verifies the authenticity of the full reassembled frame. This is in contrast to CCMP and GCMP,
which only verify the authenticity of individual fragments, and rely on sequential packet numbers to securely reassemble
the individual (decrypted) fragments.

Additionally, TKIP is not affected by the aggregation design flaw (CVE-2020-24588) because a receiver is supposed
to drop A-MSDUs that are encrypted using TKIP. Indeed, in Section "12.9.2.8 Per-MSDU/Per-A-MSDU Rx pseudocode"
of the [802.11-2016](https://standards.ieee.org/standard/802_11-2016.html) standard it's specified that
when using TKIP only normal MSDU frames are accepted.

Unfortunately, some implementations don't verify the authenticity of fragmented TKIP frames, and some accept aggregated
frames (i.e. A-MSDUs) even when encrypted using TKIP. This unfortunately means that in practice TKIP implementations
may still be vulnerable.

### [Is the ancient WEP protocol also affected by the design flaws?](#wep)

Yes. The WEP protocol is so horrible that it doesn't even try to verify the authenticity of fragmented frames.
This means an adversary can trivially perform aggregation-based attacks against WEP.

Similar to TKIP, the WEP protocol is not affected by the aggregation design flaw (CVE-2020-24588)
because a receiver is supposed to drop A-MSDUs that are encrypted using WEP. Nevertheless, in practice several
WEP implementations do accept A-MSDUs and therefore are still vulnerable.

Finally, in case you've been living under a rock, stop using WEP, it's known to be a
[horrible](https://en.wikipedia.org/wiki/Wired_Equivalent_Privacy#Weak_security) security protocol.

### [Can fragmentation attacks be preventing by disallowing small delays between fragments?](#fragdelays)

This would make exploiting possible vulnerabilities harder and perhaps in some cases practically infeasible.
Unfortunately this doesn't provide any guarantees though. I therefore recommend to fix the root cause instead.

### [Are patches for Linux available?](#patchlinux)

Yes! During the embargo I helped write some patches for the Linux kernel. This means an updated Linux kernel should (soon) be
available for actively supported Linux distributions.

### [Did others also discover the plaintext injection issue (CVE-2020-26140)?](#plainothers)

During the embargo I was made aware that [Synopsys also discoveredthe plaintext injection vulnerability (CVE-2020-26140) in access points. They found that Mediatek, Realtek, and Qualcomm were
affected, and to cover these three implementations the identifiers
[CVE-2019-18989](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-18989),
[CVE-2019-18990](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-18990), and
[CVE-2019-18991](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-18991) were respectively assigned.](https://www.synopsys.com/blogs/software-security/cyrc-advisory-sept2020/)

During the FragAttacks research I found that the same vulnerability was (still) present in other access points and that clients
can be vulnerable to a similar attack. Additionally, and somewhat surprisingly, I also found that some devices reject
normal (non-fragmented) plaintext frames but do accept fragmented plaintext frames (CVE-2020-26143).

### [Why do you use the same CVE for implementation issues in multiple different codebases?](#samecves)

Implementation-specific vulnerabilities usually get their own independent CVE identifier for each different codebase.
However, because the same implementation issues seem to be present across multiple vendors it would make more sense to have a single CVE identifier
for each common implementation issue.
After all, the main purpose of CVE identifiers is to provide a single, common ID to be used across vendors to identify the same vulnerability.
We therefore think it makes sense to assign only a single CVE identifier to each implementation issues. This enables vendors
and customers to easily reference an implementation vulnerability and, for instance, check whether certain products are affected
by one of the discovered vulnerabilities.

### [Why was the embargo so long?](#longembargo)

The disclosure was delayed by two months in consensus with ICASI and the Wi-Fi Alliance. The decision on whether to disclose fast,
or to provide more time to write and create patches, wasn't easy. At the time, the risk of leaks appeared low,
and the advantage of delaying appeared high. Additionally, we were prepared to immediately disclose in case
details would accidently leak publicly. Another aspect that influenced my decision was *the current situation*, meaning COVID-19,
which among other things made it harder to safely get access to physical places/labs to test patches.

### [How did you monitor for leaks during the embargo?](#detectleaks)

During the last two months of the embargo, we were prepared to make the research public whenever information would seemed to
be leaking. To detect leaks I personally searched for relevant keywords (CVE numbers, paper title, script names) on Google and
social media such as Twitter. The Wi-Fi Alliance and ICASI were also monitoring for leaks (e.g. if questions
came from people that shouldn't have known about it). This can detect innocent leaks. Detecting malicious leaks or
usage of the vulnerabilities in stealthy attacks is a much harder problem (if even possible at all).

If you know about cases where some information was (accidently) leaked, it would be useful to know about that so
that I can better estimate the impact of having long embargos. Any information you provide about this will remain
confidential. This information will help me in future decision when weighing the option of a longer embargo versus
disclosing research even when several vendors don't have patches ready (i.e. it won't be used to point fingers).

### [Are these vulnerabilities being exploited in practice?](#beingexploit)

Not that we are aware of. Because some of the design flaws took so long to discover my hunch is that those have
not been previously exploited in the wild. But it is difficult to monitor whether one of the discovered vulnerabilities have
been exploited in the past or are currently being exploited. So it is hard to give a definite answer to this
question.

### [Why did Microsoft already fix certain vulnerabilities on March 9, 2021?](#microsoft)

The original disclosure date was March 9, 2021. Roughly one week beforehand it was decided to [delay the disclosure](#longembargo).
At this time Microsoft had already committed to shipping certain patches on March 9. I agreed that already releasing
certain patches without providing information about the vulnerabilities was, at that point, an acceptable risk.
Put differently, the advantages of delaying the disclosure appeared to outweigh the risk that someone would reverse engineer
the patches and rediscover certain attacks.

### [Is the "Treating fragments as full frames" flaw (CVE-2020-26142) also applicable to APs?](#apfragasfull)

Yes, access points can also be vulnerable. In particular, during additional experiments that I recently performed, the vulnerability was
also present in OpenBSD when it acted as an access point.

### [Can APs be vulnerable to attacks that send broadcast frames?](#aprecievebcast)

Yes, although they are less likely to be vulnerable compared to clients. This is because under normal circumstances clients
never send a frame to the AP with a broadcast receiver address. Instead, clients first send broadcast/multicast network packets
as unicast Wi-Fi frames to the AP, and the AP then broadcasts these packets to all connected clients. As a result, many APs
will simply ignore Wi-Fi frames with a broadcast receiver address, because in normal networks those frames are only meant for clients.

### [Why are some of the tested devices so old?](#whyold)

I also tested some very old Wi-Fi devices and dongles to estimate how long the discovered vulnerabilities have been
present in the wild. Note that some old devices may remain in use for a long time, for example, expensive medical
or industrial equipment that is rarely replaced.

### [How did you make macOS switch to the malicious DNS server in the demonstration?](#forcebaddns)

After injecting the ICMPv6 Router Advertisement with the malicious DNS server, macOS won't immediately use this DNS server.
This is because macOS will only switch to the malicious DNS server if its current (primary) DNS server is no longer responding.
To force this to happen, we briefly block all traffic towards the victim. This causes macOS to switch to the malicious DNS server.

### [Isn't nyu.edu using HSTS to prevent these kind of attacks?](#nyuhsts)

Websites can use [HSTS](https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security) to force browsers to always
use HTTPS encryption when visiting a website. This prevents the attack that was shown in our [demo](#href).
Unfortunately, the website of NYU at the time did not properly configure HSTS. More technically, some subdomains such as
globalhome.nyu.edu do instruct the browser to use HSTS by including the following header in responses:

```
strict-transport-security: max-age=31536000 ; includeSubDomains
```

Unfortunately, other subdomains such as shibboleth.nyu.edu remove HSTS by including the following header in responses:

```
Strict-Transport-Security: max-age=0
```

Combined with other configuration decisions, this meant that when a user would type nyu.edu in their browser,
the initial request was sent in plaintext and therefore could be intercepted by an adversary.

Note that NYU has been informed of this issue and is investigating it.

### [How do I reproduce the BlueKeep attack shown in the demonstration?](#bluekeep)

First, when using the NAT punching technique, it is essential that you manually configure the CPORT parameter so that metasploit uses
the correct client port. You can learn this port from the injected TCP SYN packet that arrives at the server. When using a different client port
the router/NAT will not recognize the connection and will not forward it to the victim machine.

Second, you must set the AutoCheck parameter to zero. Otherwise metasploit will try to initiate multiple connections with the
victim and that is problematic when manually specifying a client port through CPORT. This workaround of setting AutoCheck
to zero can be avoided by punching multiple holes in the router/NAT and modifying the metasploit to use a different CPORT for
each connection that will be initiated.

[Creative Commons Attribution 4.0 International License](http://creativecommons.org/licenses/by/4.0/) | Design inspired by [TEMPLATED](http://templated.co).



=== Content from support.industry.siemens.com_8fdfdc52_20250119_135245.html ===

Loading...
Please enable javascript or update your browser.



=== Content from www.openwall.com_984e12b5_20250119_121117.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](11) [[next>]](13) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <ae9de74624a11f32da8edd8c195b753c7d177d3b.camel@sipsolutions.net>
Date: Tue, 11 May 2021 20:11:03 +0200
From: Johannes Berg <johannes@...solutions.net>
To: oss-security@...ts.openwall.com
Cc: Jouni Malinen <j@...fi>
Subject: various 802.11 security issues - fragattacks.com

Hi,

Several security issues in the 802.11 implementations were found by
Mathy Vanhoef (New York University Abu Dhabi), who has published all
the details at

	<https://papers.mathyvanhoef.com/usenix2021.pdf>

and

	<https://www.fragattacks.com/>

For Linux, we've developed the set of patches posted here:

[https://lore.kernel.org/linux-wireless/20210511180259.159598-1-johannes@sipsolutions.net/](https://lore.kernel.org/linux-wireless/20210511180259.159598-1-johannes%40sipsolutions.net/)

Specifically, the following CVEs were assigned:

 * CVE-2020-24586 - Fragmentation cache not cleared on reconnection
 * CVE-2020-24587 - Reassembling fragments encrypted under different
                    keys
 * CVE-2020-24588 - Accepting non-SPP A-MSDU frames, which leads to
                    payload being parsed as an L2 frame under an
                    A-MSDU bit toggling attack
 * CVE-2020-26139 - Forwarding EAPOL from unauthenticated sender
 * CVE-2020-26140 - Accepting plaintext data frames in protected
                    networks
 * CVE-2020-26141 - Not verifying TKIP MIC of fragmented frames
 * CVE-2020-26142 - Processing fragmented frames as full frames
 * CVE-2020-26143 - Accepting fragmented plaintext frames in
                    protected networks
 * CVE-2020-26144 - Always accepting unencrypted A-MSDU frames that
                    start with RFC1042 header with EAPOL ethertype
 * CVE-2020-26145 - Accepting plaintext broadcast fragments as full
                    frames
 * CVE-2020-26146 - Reassembling encrypted fragments with non-consecutive
                    packet numbers
 * CVE-2020-26147 - Reassembling mixed encrypted/plaintext fragments

In general, the scope of these attacks is that they may allow an
attacker to
 * inject L2 frames that they can more or less control (depending on the
   vulnerability and attack method) into an otherwise protected network;
 * exfiltrate (some) network data under certain conditions, this is
   specific to the fragmentation issues.

A subset of these issues is known to apply to the Linux IEEE 802.11
implementation (mac80211). Where it is affected, the attached patches
fix the issues, even if not all of them reference the exact CVE IDs.

In addition, driver and/or firmware updates may be necessary, as well
as potentially more fixes to mac80211, depending on how drivers are
using it.

Specifically, for Intel devices, firmware needs to be updated to the
most recently released versions (which was done without any reference
to the security issues) to address some of the vulnerabilities.

To have a single set of patches, I have included the patches for ath10k
and ath11k drivers in my patch posting linked to above.

We currently don't have information about how other drivers are, if
at all, affected.

Thanks,
johannes

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from cert-portal.siemens.com_3e18c131_20250119_121117.html ===
Siemens Security Advisory by Siemens ProductCERT

SSA-913875: Frame Aggregation and Fragmentation Vulnerabilities
in 802.11

Publication Date:
Last Update:
Current Version:
CVSS v3.1 Base Score: 6.5

2021-07-13
2022-04-12
V1.3

SUMMARY

Twelve vulnerabilities in the implementation of frame aggregation and fragmentation of the 802.11
standard, under the name of FragAttacks, have been published.

Successful exploitation of these vulnerabilities could allow an attacker within Wi-Fi range to forge encrypted
frames, which could result in sensitive data disclosure and possibly trafﬁc manipulation.

The advised Siemens products are only affected by some of the published vulnerabilities.

Siemens has released updates for several affected products and recommends to update to the latest
versions. Siemens recommends speciﬁc countermeasures for products where updates are not, or not yet
available.

AFFECTED PRODUCTS AND SOLUTION

Affected Product and Versions

Remediation

SCALANCE W721-1 RJ45 (6GK5721-1FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W721-1 RJ45 (6GK5721-1FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W722-1 RJ45 (6GK5722-1FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SSA-913875

© Siemens 2022

Page 1 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W722-1 RJ45 (6GK5722-1FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W722-1 RJ45 (6GK5722-1FC00-
0AC0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W734-1 RJ45 (6GK5734-1FX00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W734-1 RJ45 (6GK5734-1FX00-
0AA6):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W734-1 RJ45 (6GK5734-1FX00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W734-1 RJ45 (USA) (6GK5734-
1FX00-0AB6):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W738-1 M12 (6GK5738-1GY00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SSA-913875

© Siemens 2022

Page 2 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W738-1 M12 (6GK5738-1GY00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W748-1 M12 (6GK5748-1GD00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W748-1 M12 (6GK5748-1GD00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W748-1 RJ45 (6GK5748-1FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W748-1 RJ45 (6GK5748-1FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W761-1 RJ45 (6GK5761-1FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W761-1 RJ45 (6GK5761-1FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SSA-913875

© Siemens 2022

Page 3 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W774-1 M12 EEC (6GK5774-1FY00-
0TA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W774-1 M12 EEC (6GK5774-1FY00-
0TB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W774-1 RJ45 (6GK5774-1FX00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W774-1 RJ45 (6GK5774-1FX00-
0AA6):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W774-1 RJ45 (6GK5774-1FX00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W774-1 RJ45 (6GK5774-1FX00-
0AC0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W774-1 RJ45 (USA) (6GK5774-
1FX00-0AB6):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SSA-913875

© Siemens 2022

Page 4 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W778-1 M12 (6GK5778-1GY00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W778-1 M12 (6GK5778-1GY00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W778-1 M12 EEC (6GK5778-
1GY00-0TA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W778-1 M12 EEC (USA) (6GK5778-
1GY00-0TB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-1 RJ45 (6GK5786-1FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-1 RJ45 (6GK5786-1FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-2 RJ45 (6GK5786-2FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SSA-913875

© Siemens 2022

Page 5 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W786-2 RJ45 (6GK5786-2FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-2 RJ45 (6GK5786-2FC00-
0AC0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-2 SFP (6GK5786-2FE00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-2 SFP (6GK5786-2FE00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-2IA RJ45 (6GK5786-2HC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W786-2IA RJ45 (6GK5786-2HC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-1 M12 (6GK5788-1GD00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SSA-913875

© Siemens 2022

Page 6 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W788-1 M12 (6GK5788-1GD00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-1 RJ45 (6GK5788-1FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-1 RJ45 (6GK5788-1FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-2 M12 (6GK5788-2GD00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-2 M12 (6GK5788-2GD00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-2 M12 EEC (6GK5788-
2GD00-0TA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-2 M12 EEC (6GK5788-
2GD00-0TB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SSA-913875

© Siemens 2022

Page 7 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W788-2 M12 EEC (6GK5788-
2GD00-0TC0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-2 RJ45 (6GK5788-2FC00-
0AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-2 RJ45 (6GK5788-2FC00-
0AB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

SCALANCE W788-2 RJ45 (6GK5788-2FC00-
0AC0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26140, CVE-2020-26141,
CVE-2020-26143, CVE-2020-26144, CVE-2020-
26146, CVE-2020-26147

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

Currently no ﬁx is planned
See recommendations from section Workarounds
and Mitigations

SCALANCE W1748-1 M12 (6GK5748-1GY01-
0AA0):
All versions < V3.0.0
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26146, CVE-2020-26147

Update to V3.0.0 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109808629/
See further
Workarounds and Mitigations

recommendations from section

SCALANCE W1748-1 M12 (6GK5748-1GY01-
0TA0):
All versions < V3.0.0
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26146, CVE-2020-26147

Update to V3.0.0 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109808629/
See further
Workarounds and Mitigations

recommendations from section

SCALANCE W1750D:
All versions < V8.7.1.3
only affected by CVE-2020-24588, CVE-2020-
26146

Update to V8.7.1.3 or later version
https://support.industry.siemens.com/cs/de/en/
view/109802805/
See further
Workarounds and Mitigations

recommendations from section

SCALANCE W1788-1 M12 (6GK5788-1GY01-
0AA0):
All versions < V3.0.0
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26146, CVE-2020-26147

Update to V3.0.0 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109808629/
See further
Workarounds and Mitigations

recommendations from section

SSA-913875

© Siemens 2022

Page 8 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE W1788-2 EEC M12 (6GK5788-
2GY01-0TA0):
All versions < V3.0.0
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26146, CVE-2020-26147

Update to V3.0.0 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109808629/
See further
Workarounds and Mitigations

recommendations from section

SCALANCE W1788-2 M12 (6GK5788-2GY01-
0AA0):
All versions < V3.0.0
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26146, CVE-2020-26147

Update to V3.0.0 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109808629/
See further
Workarounds and Mitigations

recommendations from section

SCALANCE W1788-2IA M12 (6GK5788-2HY01-
0AA0):
All versions < V3.0.0
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26146, CVE-2020-26147

Update to V3.0.0 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109808629/
See further
Workarounds and Mitigations

recommendations from section

(6GK5763-1AL00-

SCALANCE WAM763-1
7DA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

(6GK5766-1GE00-

SCALANCE WAM766-1
7DA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

(6GK5766-1GE00-

SCALANCE WAM766-1
7DB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

SCALANCE WAM766-1 6GHz (6GK5766-1JE00-
7DA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

SCALANCE WAM766-1 EEC (6GK5766-1GE00-
7TA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

SSA-913875

© Siemens 2022

Page 9 of 14

Siemens Security Advisory by Siemens ProductCERT

SCALANCE WAM766-1 EEC (6GK5766-1GE00-
7TB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

SCALANCE WAM766-1 EEC 6GHz (6GK5766-
1JE00-7TA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

(6GK5763-1AL00-

SCALANCE WUM763-1
3AA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

(6GK5763-1AL00-

SCALANCE WUM763-1
3DA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

(6GK5766-1GE00-

SCALANCE WUM766-1
3DA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

(6GK5766-1GE00-

SCALANCE WUM766-1
3DB0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

SCALANCE WUM766-1 6GHz (6GK5766-1JE00-
3DA0):
All versions
only affected by CVE-2020-24588, CVE-2020-
26139, CVE-2020-26144, CVE-2020-26145,
CVE-2020-26146

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

Update to V1.2 or later version
https://support.industry.siemens.com/cs/de/en/
view/109805887
See further
Workarounds and Mitigations

recommendations from section

WORKAROUNDS AND MITIGATIONS

Siemens has identiﬁed the following speciﬁc workarounds and mitigations that customers can apply to
reduce the risk:

• As these vulnerabilities can only be exploited within Wi-Fi range, when possible reduce Wi-Fi
transmission power or make sure to have the devices in private areas with physical access controls

SSA-913875

© Siemens 2022

Page 10 of 14

Siemens Security Advisory by Siemens ProductCERT

• When possible, A-MSDU can be disabled to mitigate CVE-2020-24588 and CVE-2020-26144

Product speciﬁc remediations or mitigations can be found in the section Affected Products and Solution.

Please follow the General Security Recommendations.

GENERAL SECURITY RECOMMENDATIONS

As a general security measure, Siemens strongly recommends to protect network access to devices
with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens
recommends to conﬁgure the environment according to Siemens’ operational guidelines for Industrial
Security (Download: https://www.siemens.com/cert/operational-guidelines-industrial-security), and to
follow the recommendations in the product manuals.

Additional information on Industrial Security by Siemens can be found at: https://www.siemens.com/
industrialsecurity

PRODUCT DESCRIPTION

SCALANCE W-700 products are wireless communication devices based on IEEE 802.11 standards. They
are used to connect all to sorts of WLAN devices (Access Points or Clients, depending on the operating
mode) with a strong focus on industrial components, like Programmable Logic Controllers (PLCs) or
Human Machine Interfaces (HMIs) and others.

SCALANCE W-1700 products are wireless communication devices based on IEEE 802.11 standards.
They are used to connect all to sorts of WLAN devices (Access Points or Clients, depending on the
operating mode) with a strong focus on industrial components, like Programmable Logic Controllers
(PLCs) or Human Machine Interfaces (HMIs) and others.

The SCALANCE W1750D controller-based Direct Access Points support radio transmission according to
the latest IWLAN standard IEEE 802.11ac Wave 2.

VULNERABILITY CLASSIFICATION

The vulnerability classiﬁcation has been performed by using the CVSS scoring system in version 3.1
(CVSS v3.1) (https://www.ﬁrst.org/cvss/). The CVSS environmental score is speciﬁc to the customer’s
environment and will impact the overall CVSS score. The environmental score should therefore be
individually deﬁned by the customer to accomplish ﬁnal scoring.

An additional classiﬁcation has been performed using the CWE classiﬁcation, a community-developed list
of common software security weaknesses. This serves as a common language and as a baseline for
weakness identiﬁcation, mitigation, and prevention efforts. A detailed list of CWE classes can be found at:
https://cwe.mitre.org/.

Vulnerability CVE-2020-24588

The 802.11 standard that underpins Wi-Fi Protected Access (WPA, WPA2, and WPA3) and Wired
Equivalent Privacy (WEP) doesn’t require that the A-MSDU ﬂag in the plaintext QoS header ﬁeld is
authenticated. Against devices that support receiving non-SSP A-MSDU frames (which is mandatory
as part of 802.11n), an adversary can abuse this to inject arbitrary network packets.

CVSS v3.1 Base Score
CVSS Vector
CWE

3.5
CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C
CWE-306: Missing Authentication for Critical Function

SSA-913875

© Siemens 2022

Page 11 of 14

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2020-26139

An issue was discovered in the kernel in NetBSD 7.1. An Access Point (AP) forwards EAPOL frames
to other clients even though the sender has not yet successfully authenticated to the AP. This might
be abused in projected Wi-Fi networks to launch denial-of-service attacks against connected clients
and makes it easier to exploit other vulnerabilities in connected clients.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-287: Improper Authentication

Vulnerability CVE-2020-26140

An issue was discovered in the ALFA Windows 10 driver 6.1316.1209 for AWUS036H. The WEP, WPA,
WPA2, and WPA3 implementations accept plaintext frames in a protected Wi-Fi network. An adversary
can abuse this to inject arbitrary data frames independent of the network conﬁguration.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-74: Improper Neutralization of Special Elements in Output
Used by a Downstream Component (‘Injection’)

Vulnerability CVE-2020-26141

An issue was discovered in the ALFA Windows 10 driver 6.1316.1209 for AWUS036H. The Wi-Fi
implementation does not verify the Message Integrity Check (authenticity) of fragmented TKIP frames.
An adversary can abuse this to inject and possibly decrypt packets in WPA or WPA2 networks that
support the TKIP data-conﬁdentiality protocol.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-354: Improper Validation of Integrity Check Value

Vulnerability CVE-2020-26143

An issue was discovered in the ALFA Windows 10 driver 1030.36.604 for AWUS036ACH. The WEP,
WPA, WPA2, and WPA3 implementations accept fragmented plaintext frames in a protected Wi-Fi
network. An adversary can abuse this to inject arbitrary data frames independent of the network
conﬁguration.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2020-26144

An issue was discovered on Samsung Galaxy S3 i9305 4.4.4 devices. The WEP, WPA, WPA2, and
WPA3 implementations accept plaintext A-MSDU frames as long as the ﬁrst 8 bytes correspond to a
valid RFC1042 (i.e., LLC/SNAP) header for EAPOL. An adversary can abuse this to inject arbitrary
network packets independent of the network conﬁguration.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

SSA-913875

© Siemens 2022

Page 12 of 14

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2020-26145

An issue was discovered on Samsung Galaxy S3 i9305 4.4.4 devices. The WEP, WPA, WPA2,
and WPA3 implementations accept second (or subsequent) broadcast fragments even when sent
in plaintext and process them as full unfragmented frames. An adversary can abuse this to inject
arbitrary network packets independent of the network conﬁguration.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2020-26146

An issue was discovered on Samsung Galaxy S3 i9305 4.4.4 devices. The WPA, WPA2, and WPA3
implementations reassemble fragments with non-consecutive packet numbers. An adversary can
abuse this to exﬁltrate selected fragments. This vulnerability is exploitable when another device sends
fragmented frames and the WEP, CCMP, or GCMP data-conﬁdentiality protocol is used. Note that
WEP is vulnerable to this attack by design.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2020-26147

An issue was discovered in the Linux kernel 5.8.9. The WEP, WPA, WPA2, and WPA3 implementations
reassemble fragments even though some of them were sent in plaintext. This vulnerability can be
abused to inject packets and/or exﬁltrate selected fragments when another device sends fragmented
frames and the WEP, CCMP, or GCMP data-conﬁdentiality protocol is used.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.4
CVSS:3.1/AV:A/AC:H/PR:N/UI:R/S:U/C:L/I:H/A:N/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

ADDITIONAL INFORMATION

For more details regarding the FragAttacks vulnerabilities refer to:

- Fragment and Forge Breaking Wi-Fi Through Frame Aggregation and Fragmentation: https://papers.
mathyvanhoef.com/usenix2021.pdf

For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the
Siemens ProductCERT:

https://www.siemens.com/cert/advisories

HISTORY DATA

V1.0 (2021-07-13):
V1.1 (2021-10-12):
V1.2 (2022-02-08):

V1.3 (2022-04-12):

Publication Date
Added solution for SCALANCE W1750D
Added solution for SCALANCE W-700 IEEE 802.11ax family, updated name and
split into individual products the SCALANCE W-700 and SCALANCE W-1700
families and clariﬁed that no remediation is planned for SCALANCE W-700 IEEE
802.11n and SCALANCE W-1700 families
Added solution for the SCALANCE W-1700 (11ac) family

SSA-913875

© Siemens 2022

Page 13 of 14

Siemens Security Advisory by Siemens ProductCERT

TERMS OF USE

Siemens Security Advisories are subject to the terms and conditions contained in Siemens’ underlying
license terms or other applicable agreements previously agreed to with Siemens (hereinafter "License
Terms"). To the extent applicable to information, software or documentation made available in or through
a Siemens Security Advisory, the Terms of Use of Siemens’ Global Website (https://www.siemens.com/
terms_of_use, hereinafter "Terms of Use"), in particular Sections 8-10 of the Terms of Use, shall apply
additionally. In case of conﬂicts, the License Terms shall prevail over the Terms of Use.

SSA-913875

© Siemens 2022

Page 14 of 14


