=== Content from github.com_2efbe19c_20250119_132643.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin%2Fpull%2F6769)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin%2Fpull%2F6769)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=bitcoin%2Fbitcoin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bitcoin](/bitcoin)
/
**[bitcoin](/bitcoin/bitcoin)**
Public

* [Notifications](/login?return_to=%2Fbitcoin%2Fbitcoin) You must be signed in to change notification settings
* [Fork
  36.6k](/login?return_to=%2Fbitcoin%2Fbitcoin)
* [Star
   81.5k](/login?return_to=%2Fbitcoin%2Fbitcoin)

* [Code](/bitcoin/bitcoin)
* [Issues
  375](/bitcoin/bitcoin/issues)
* [Pull requests
  325](/bitcoin/bitcoin/pulls)
* [Actions](/bitcoin/bitcoin/actions)
* [Projects
  5](/bitcoin/bitcoin/projects)
* [Security](/bitcoin/bitcoin/security)
* [Insights](/bitcoin/bitcoin/pulse)

Additional navigation options

* [Code](/bitcoin/bitcoin)
* [Issues](/bitcoin/bitcoin/issues)
* [Pull requests](/bitcoin/bitcoin/pulls)
* [Actions](/bitcoin/bitcoin/actions)
* [Projects](/bitcoin/bitcoin/projects)
* [Security](/bitcoin/bitcoin/security)
* [Insights](/bitcoin/bitcoin/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fbitcoin%2Fbitcoin%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fbitcoin%2Fbitcoin%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Test LowS in standardness, removes nuisance malleability vector. #6769

 Merged

[laanwj](/laanwj)
merged 1 commit into
[bitcoin:master](/bitcoin/bitcoin/tree/master "bitcoin/bitcoin:master")
from
gmaxwell:no\_nuisance\_malleability

Oct 7, 2015

 Merged

# [Test LowS in standardness, removes nuisance malleability vector.](#top) #6769

[laanwj](/laanwj)
merged 1 commit into
[bitcoin:master](/bitcoin/bitcoin/tree/master "bitcoin/bitcoin:master")
from
gmaxwell:no\_nuisance\_malleability

Oct 7, 2015

[Conversation
21](/bitcoin/bitcoin/pull/6769)
[Commits
1](/bitcoin/bitcoin/pull/6769/commits)
[Checks
0](/bitcoin/bitcoin/pull/6769/checks)
[Files changed](/bitcoin/bitcoin/pull/6769/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![gmaxwell](https://avatars.githubusercontent.com/u/858454?s=60&v=4)](/gmaxwell)

Copy link

Contributor

### @gmaxwell **[gmaxwell](/gmaxwell)** commented [Oct 6, 2015](#issue-109931070)

This adds SCRIPT\_VERIFY\_LOW\_S to STANDARD\_SCRIPT\_VERIFY\_FLAGS which

will make the node require the canonical 'low-s' encoding for

ECDSA signatures when relaying or mining.

Consensus behavior is unchanged.

The rational is explained in [a81cd96](https://github.com/bitcoin/bitcoin/commit/a81cd96805ce6b65cca3a40ebbd3b2eb428abb7b):

Absent this kind of test ECDSA is not a strong signature as given

a valid signature {r, s} both that value and {r, -s mod n} are valid.

These two encodings have different hashes allowing third parties a

vector to change users txids. These attacks are avoided by picking

a particular form as canonical and rejecting the other form(s); in

the of the LOW\_S rule, the smaller of the two possible S values is

used.

If widely deployed this change would eliminate the last remaining

known vector for nuisance malleability on boring SIGHASH\_ALL

p2pkh transactions. On the down-side it will block most

transactions made by sufficiently out of date software.

Unlike the other avenues to change txids on boring transactions this

one was randomly violated by all deployed bitcoin software prior to

its discovery. So, while other malleability vectors where made

non-standard as soon as they were discovered, this one has remained

permitted. Even BIP62 did not propose applying this rule to

old version transactions, but conforming implementations have become

much more common since BIP62 was initially written.

Bitcoin Core has produced compatible signatures since [a28fb70](https://github.com/bitcoin/bitcoin/commit/a28fb70e45d764e558966ba3b02bd16e02b11c14) in

September 2013, but this didn't make it into a release until 0.9

in March 2014; Bitcoinj has done so for a similar span of time.

Bitcoinjs and electrum have been more recently updated.

This does not replace the need for BIP62 or similar, as miners can

still cooperate to break transactions. Nor does it replace the

need for wallet software to handle malleability sanely[1]. This

only eliminates the cheap and irritating DOS attack.

[1] On the Malleability of Bitcoin Transactions

Marcin Andrychowicz, Stefan Dziembowski, Daniel Malinowski, ≈Åukasz Mazurek

<http://fc15.ifca.ai/preproceedings/bitcoin/paper_9.pdf>

Sorry, something went wrong.

 üëç
1
 plibither8 reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[![@gmaxwell](https://avatars.githubusercontent.com/u/858454?s=40&v=4)](/gmaxwell)

`[Test LowS in standardness, removes nuisance malleability vector.](/bitcoin/bitcoin/pull/6769/commits/b196b685c9089b74fd4ff3d9a28ea847ab36179b "Test LowS in standardness, removes nuisance malleability vector.

This adds SCRIPT_VERIFY_LOW_S to STANDARD_SCRIPT_VERIFY_FLAGS which
 will make the node require the canonical 'low-s' encoding for
 ECDSA signatures when relaying or mining.

Consensus behavior is unchanged.

The rational is explained in a81cd96805ce6b65cca3a40ebbd3b2eb428abb7b:
 Absent this kind of test ECDSA is not a strong signature as given
 a valid signature {r, s} both that value and {r, -s mod n} are valid.
 These two encodings have different hashes allowing third parties a
 vector to change users txids.  These attacks are avoided by picking
 a particular form as canonical and rejecting the other form(s); in
 the of the LOW_S rule, the smaller of the two possible S values is
 used.

If widely deployed this change would eliminate the last remaining
 known vector for nuisance malleability on boring SIGHASH_ALL
 p2pkh transactions.  On the down-side it will block most
 transactions made by sufficiently out of date software.

Unlike the other avenues to change txids on boring transactions this
 one was randomly violated by all deployed bitcoin software prior to
 its discovery.  So, while other malleability vectors where made
 non-standard as soon as they were discovered, this one has remained
 permitted.  Even BIP62 did not propose applying this rule to
 old version transactions, but conforming implementations have become
 much more common since BIP62 was initially written.

Bitcoin Core has produced compatible signatures since a28fb70e in
 September 2013, but this didn't make it into a release until 0.9
 in March 2014; Bitcoinj has done so for a similar span of time.
 Bitcoinjs and electrum have been more recently updated.

This does not replace the need for BIP62 or similar, as miners can
 still cooperate to break transactions.  Nor does it replace the
 need for wallet software to handle malleability sanely[1]. This
 only eliminates the cheap and irritating DOS attack.

[1] On the Malleability of Bitcoin Transactions
Marcin Andrychowicz, Stefan Dziembowski, Daniel Malinowski, ≈Åukasz Mazurek
http://fc15.ifca.ai/preproceedings/bitcoin/paper_9.pdf")`
 ‚Ä¶

`[b196b68](/bitcoin/bitcoin/pull/6769/commits/b196b685c9089b74fd4ff3d9a28ea847ab36179b)`

```
This adds SCRIPT_VERIFY_LOW_S to STANDARD_SCRIPT_VERIFY_FLAGS which
 will make the node require the canonical 'low-s' encoding for
 ECDSA signatures when relaying or mining.

Consensus behavior is unchanged.

The rational is explained in [a81cd96](https://github.com/bitcoin/bitcoin/commit/a81cd96805ce6b65cca3a40ebbd3b2eb428abb7b):
 Absent this kind of test ECDSA is not a strong signature as given
 a valid signature {r, s} both that value and {r, -s mod n} are valid.
 These two encodings have different hashes allowing third parties a
 vector to change users txids.  These attacks are avoided by picking
 a particular form as canonical and rejecting the other form(s); in
 the of the LOW_S rule, the smaller of the two possible S values is
 used.

If widely deployed this change would eliminate the last remaining
 known vector for nuisance malleability on boring SIGHASH_ALL
 p2pkh transactions.  On the down-side it will block most
 transactions made by sufficiently out of date software.

Unlike the other avenues to change txids on boring transactions this
 one was randomly violated by all deployed bitcoin software prior to
 its discovery.  So, while other malleability vectors where made
 non-standard as soon as they were discovered, this one has remained
 permitted.  Even BIP62 did not propose applying this rule to
 old version transactions, but conforming implementations have become
 much more common since BIP62 was initially written.

Bitcoin Core has produced compatible signatures since [a28fb70](https://github.com/bitcoin/bitcoin/commit/a28fb70e45d764e558966ba3b02bd16e02b11c14) in
 September 2013, but this didn't make it into a release until 0.9
 in March 2014; Bitcoinj has done so for a similar span of time.
 Bitcoinjs and electrum have been more recently updated.

This does not replace the need for BIP62 or similar, as miners can
 still cooperate to break transactions.  Nor does it replace the
 need for wallet software to handle malleability sanely[1]. This
 only eliminates the cheap and irritating DOS attack.

[1] On the Malleability of Bitcoin Transactions
Marcin Andrychowicz, Stefan Dziembowski, Daniel Malinowski, ≈Åukasz Mazurek
<http://fc15.ifca.ai/preproceedings/bitcoin/paper_9.pdf>
```

[![@gmaxwell](https://avatars.githubusercontent.com/u/858454?s=40&u=63e5c438c242094837a9deeda775d77988b508bf&v=4)](/gmaxwell)
[gmaxwell](/gmaxwell)
added
the
[TX fees and policy](/bitcoin/bitcoin/labels/TX%20fees%20and%20policy)
label
[Oct 6, 2015](#event-427529264)

[![@gmaxwell](https://avatars.githubusercontent.com/u/858454?s=80&u=63e5c438c242094837a9deeda775d77988b508bf&v=4)](/gmaxwell)

Copy link

Contributor

Author

### **[gmaxwell](/gmaxwell)** commented [Oct 6, 2015](#issuecomment-145735385)

| For discussion.  Recent measurements have suggested that somewhere between 85-95% of all transactions are already conforming. I've subsequently gone around and caused several parties (like electrum) to update their behavior.  This could also be coupled with a change that automatically 'fixes' failing transactions by mutating them instead of causing them to be be rejected completely (I understand code for this already exists, but isn't public)-- a prospect which is much less unappealing now that malleability attacks are already going on. However, if LowS becomes even more widespread quickly this change alone may be enough.  If anyone wants to do some sleuthing on which software is still producing HighS signatures, here is a list of addresses recently (but before the recent spate of attacks) involved in a HighS signature: <https://people.xiph.org/~greg/high-s-reusecnt.log> ... |
| --- |

All reactions

Sorry, something went wrong.

[![@pstratem](https://avatars.githubusercontent.com/u/620611?s=80&u=871eabd15ac87d37f1b4d2b927fa8f33e3ad7fe3&v=4)](/pstratem)

Copy link

Contributor

### **[pstratem](/pstratem)** commented [Oct 6, 2015](#issuecomment-145735898)

| ACK |
| --- |

All reactions

Sorry, something went wrong.

[![@TheBlueMatt](https://avatars.githubusercontent.com/u/649246?s=80&v=4)](/TheBlueMatt)

Copy link

Contributor

### **[TheBlueMatt](/TheBlueMatt)** commented [Oct 6, 2015](#issuecomment-145743459)

| I had thought we had switched this on years ago, tbh, and was only corrected a month or so ago. At some point you just have to turn it on given that clients will never otherwise be conformant. Concept ACK.  On October 5, 2015 9:00:23 PM PDT, Patrick Strateman notifications@github.com wrote:  ACK   ---   Reply to this email directly or view it on GitHub: [#6769 (comment)](https://github.com/bitcoin/bitcoin/pull/6769#issuecomment-145735898) |
| --- |

All reactions

Sorry, something went wrong.

[![@btcdrak](https://avatars.githubusercontent.com/u/7275704?s=80&u=578995010af9e1872285cb8e67bcb4f6052d52dd&v=4)](/btcdrak)

Copy link

Contributor

### **[btcdrak](/btcdrak)** commented [Oct 6, 2015](#issuecomment-145764047)

| ACK |
| --- |

All reactions

Sorry, something went wrong.

1 similar comment

[![@paveljanik](https://avatars.githubusercontent.com/u/6848764?s=80&v=4)](/paveljanik)

Copy link

Contributor

### **[paveljanik](/paveljanik)** commented [Oct 6, 2015](#issuecomment-145764263)

| ACK |
| --- |

All reactions

Sorry, something went wrong.

[![@laanwj](https://avatars.githubusercontent.com/u/126646?s=80&u=edaf64d0008bbf44ea0db7410ef2e54d1b4ae0f5&v=4)](/laanwj)

Copy link

Member

### **[laanwj](/laanwj)** commented [Oct 6, 2015](#issuecomment-145765541)

| utACK |
| --- |

All reactions

Sorry, something went wrong.

[![@btcdrak](https://avatars.githubusercontent.com/u/7275704?s=80&u=578995010af9e1872285cb8e67bcb4f6052d52dd&v=4)](/btcdrak)

Copy link

Contributor

### **[btcdrak](/btcdrak)** commented [Oct 6, 2015](#issuecomment-145765761)

| should also be backported imo |
| --- |

All reactions

Sorry, something went wrong.

[![@gmaxwell](https://avatars.githubusercontent.com/u/858454?s=80&u=63e5c438c242094837a9deeda775d77988b508bf&v=4)](/gmaxwell)

Copy link

Contributor

Author

### **[gmaxwell](/gmaxwell)** commented [Oct 6, 2015](#issuecomment-145766100)

| [@btcdrak](https://github.com/btcdrak) trivial, of course, though I wonder if we should also backport lowS production to 0.8, I'm kind of disappointed that we didn't previously. |
| --- |

All reactions

Sorry, something went wrong.

[![@dcousens](https://avatars.githubusercontent.com/u/413395?s=80&u=034ef1433a0704d9c91b57b993009b0383d6b7c0&v=4)](/dcousens)

Copy link

Contributor

### **[dcousens](/dcousens)** commented [Oct 6, 2015](#issuecomment-145767050)

| concept ACK, utACK  I wonder if we should also backport lowS production to 0.8  What percentage of nodes are 0.8? |
| --- |

All reactions

Sorry, something went wrong.

[![@laanwj](https://avatars.githubusercontent.com/u/126646?s=80&u=edaf64d0008bbf44ea0db7410ef2e54d1b4ae0f5&v=4)](/laanwj)

Copy link

Member

### **[laanwj](/laanwj)** commented [Oct 6, 2015](#issuecomment-145767685)

| Backporting to 0.10/0.11 is trivial as it already has the `SCRIPT_VERIFY_LOW_S` flag <=0.9, if still relevant, will also need `IsLowDERSignature` etc. |
| --- |

All reactions

Sorry, something went wrong.

[![@dexX7](https://avatars.githubusercontent.com/u/5836089?s=80&v=4)](/dexX7)

Copy link

Contributor

### **[dexX7](/dexX7)** commented [Oct 6, 2015](#issuecomment-145790220)

| ACK, but should be announced with instructions for non-compliant wallets and users whose transactions may be rejected. (but this doesn't seem strictly related the actual PR) |
| --- |

All reactions

Sorry, something went wrong.

[![@petertodd](https://avatars.githubusercontent.com/u/7042?s=80&u=57b50a05caa63fb86d8f910668719907e9ecf667&v=4)](/petertodd)

Copy link

Contributor

### **[petertodd](/petertodd)** commented [Oct 6, 2015](#issuecomment-145829478)

| utACK  This could also be coupled with a change that automatically 'fixes' failing transactions by mutating them instead of causing them to be be rejected completely  As that's non-consensus code, I think I'd be willing to ACK such a change in principle. Though I'd want the code to be fairly self-contained, and of course, configurable via CLI switch. |
| --- |

All reactions

Sorry, something went wrong.

[![@dcousens](https://avatars.githubusercontent.com/u/413395?s=80&u=034ef1433a0704d9c91b57b993009b0383d6b7c0&v=4)](/dcousens)

Copy link

Contributor

### **[dcousens](/dcousens)** commented [Oct 6, 2015](#issuecomment-145999631)

| This could also be coupled with a change that automatically 'fixes' failing transactions by mutating them instead of causing them to be be rejected completely  This would also have the behaviour of acting as a nuisance malleability attack on incompatible wallets, but I guess that is better than not being relayed. |
| --- |

All reactions

Sorry, something went wrong.

[![@lontivero](https://avatars.githubusercontent.com/u/127973?s=40&v=4)](/lontivero)
[lontivero](/lontivero)
mentioned this pull request
[Oct 7, 2015](#ref-pullrequest-110129678)

[Add LowS flag in Standard ScriptVerify for reducing malleability Tx attacks
MetacoSA/NBitcoin#132](/MetacoSA/NBitcoin/pull/132)
 Merged

[![@NicolasDorier](https://avatars.githubusercontent.com/u/3020646?s=80&u=256d78207f88d303d61b62060a309657276cf6cb&v=4)](/NicolasDorier)

Copy link

Contributor

### **[NicolasDorier](/NicolasDorier)** commented [Oct 7, 2015](#issuecomment-146098601)

| NBitcoin is also producing sigs with LowS, we just updated the STANDARD flags to include LowS for transaction verification. |
| --- |

All reactions

Sorry, something went wrong.

[![@tulip0](https://avatars.githubusercontent.com/u/15009664?s=80&v=4)](/tulip0)

Copy link

### **[tulip0](/tulip0)** commented [Oct 7, 2015](#issuecomment-146100684)

| In an observation bracket between height 376000 and 376500 more than 95% of transactions pass the BIP62 stated low-s requirement. This count only includes transactions where every vin is a standard P2SH scriptPubKey, a type which would be made effectively immutable by this modification.  [early-window](https://cloud.githubusercontent.com/assets/15009664/10330661/905b9d94-6d1a-11e5-8e17-7f52cc7cc280.png)  More recent blocks as of the time of writing are affected heavily by mutated signatures, with very large portions of some blocks (60%) containing transactions that have at least one high-s signature.  [later-window](https://cloud.githubusercontent.com/assets/15009664/10330662/92e3778a-6d1a-11e5-9074-2488d9a5b5b5.png)  Historically we see only a few abnormalities per block, some earlier spikes of unknown origin and more recently most recently due to well publicized mutated signatures .  [historical-defect-rate](https://cloud.githubusercontent.com/assets/15009664/10333289/87942dfc-6d2e-11e5-9230-c0b79deef404.png)  [non-canonical-addresses-sorted.txt](https://gist.githubusercontent.com/lebn/fc8742508219a7c014d4/raw/8a854f4439d254792ec4876c9c20cf22e46411f1/non-canonical-addresses-sorted.txt) contains a sample of P2PKH addresses involved in non-mutated transactions where at least one signature violated low-s. This may be useful in identifying services which need to make upgrades to their wallet software in order to produce compliant signatures. |
| --- |

All reactions

Sorry, something went wrong.

[![@laanwj](https://avatars.githubusercontent.com/u/126646?s=80&u=edaf64d0008bbf44ea0db7410ef2e54d1b4ae0f5&v=4)](/laanwj)

Copy link

Member

### **[laanwj](/laanwj)** commented [Oct 7, 2015](#issuecomment-146121744)

| ACK, but should be announced with instructions for non-compliant wallets and users whose transactions may be rejected. (but this doesn't seem strictly related the actual PR)  Should definitely be in the release notes, also for the backport minor releases. But yes no need to have it hold up this PR. |
| --- |

All reactions

Sorry, something went wrong.

[![@laanwj](https://avatars.githubusercontent.com/u/126646?s=40&u=edaf64d0008bbf44ea0db7410ef2e54d1b4ae0f5&v=4)](/laanwj)
[laanwj](/laanwj)
merged commit [`b196b68`](/bitcoin/bitcoin/commit/b196b685c9089b74fd4ff3d9a28ea847ab36179b)
into
bitcoin:master

[Oct 7, 2015](https://github.com/bitcoin/bitcoin/pull/6769#event-428882940)

[laanwj](/laanwj)
added a commit
that referenced
this pull request
[Oct 7, 2015](#ref-commit-49dd5c6)
[![@laanwj](https://avatars.githubusercontent.com/u/126646?s=40&u=edaf64d0008bbf44ea0db7410ef2e54d1b4ae0f5&v=4)](/laanwj)

`[Merge pull request](/bitcoin/bitcoin/commit/49dd5c629df0a08cf3b1ea8085c03312d1a81696 "Merge pull request #6769

b196b68 Test LowS in standardness, removes nuisance malleability vector. (Gregory Maxwell)") [#6769](https://github.com/bitcoin/bitcoin/pull/6769)`
‚Ä¶

`[49dd5c6](/bitcoin/bitcoin/commit/49dd5c629df0a08cf3b1ea8085c03312d1a81696)`

```
[b196b68](https://github.com/bitcoin/bitcoin/commit/b196b685c9089b74fd4ff3d9a28ea847ab36179b) Test LowS in standardness, removes nuisance malleability vector. (Gregory Maxwell)
```

[gmaxwell](/gmaxwell)
added a commit
that referenced
this pull request
[Oct 7, 2015](#ref-commit-1cea6b0)
[![@gmaxwell](https://avatars.githubusercontent.com/u/858454?s=40&u=63e5c438c242094837a9deeda775d77988b508bf&v=4)](/gmaxwell) [![@laanwj](https://avatars.githubusercontent.com/u/126646?s=40&v=4)](/laanwj)

`[Test LowS in standardness, removes nuisance malleability vector.](/bitcoin/bitcoin/commit/1cea6b0dee0b0f10d5f41433e27c70213a4c531f "Test LowS in standardness, removes nuisance malleability vector.

This adds SCRIPT_VERIFY_LOW_S to STANDARD_SCRIPT_VERIFY_FLAGS which
 will make the node require the canonical 'low-s' encoding for
 ECDSA signatures when relaying or mining.

Consensus behavior is unchanged.

The rational is explained in a81cd96805ce6b65cca3a40ebbd3b2eb428abb7b:
 Absent this kind of test ECDSA is not a strong signature as given
 a valid signature {r, s} both that value and {r, -s mod n} are valid.
 These two encodings have different hashes allowing third parties a
 vector to change users txids.  These attacks are avoided by picking
 a particular form as canonical and rejecting the other form(s); in
 the of the LOW_S rule, the smaller of the two possible S values is
 used.

If widely deployed this change would eliminate the last remaining
 known vector for nuisance malleability on boring SIGHASH_ALL
 p2pkh transactions.  On the down-side it will block most
 transactions made by sufficiently out of date software.

Unlike the other avenues to change txids on boring transactions this
 one was randomly violated by all deployed bitcoin software prior to
 its discovery.  So, while other malleability vectors where made
 non-standard as soon as they were discovered, this one has remained
 permitted.  Even BIP62 did not propose applying this rule to
 old version transactions, but conforming implementations have become
 much more common since BIP62 was initially written.

Bitcoin Core has produced compatible signatures since a28fb70e in
 September 2013, but this didn't make it into a release until 0.9
 in March 2014; Bitcoinj has done so for a similar span of time.
 Bitcoinjs and electrum have been more recently updated.

This does not replace the need for BIP62 or similar, as miners can
 still cooperate to break transactions.  Nor does it replace the
 need for wallet software to handle malleability sanely[1]. This
 only eliminates the cheap and irritating DOS attack.

[1] On the Malleability of Bitcoin Transactions
Marcin Andrychowicz, Stefan Dziembowski, Daniel Malinowski, ≈Åukasz Mazurek
http://fc15.ifca.ai/preproceedings/bitcoin/paper_9.pdf

Conflicts:
	src/policy/policy.h

Rebased-From: b196b685c9089b74fd4ff3d9a28ea847ab36179b
Github-Pull: #6769")`
‚Ä¶

`[1cea6b0](/bitcoin/bitcoin/commit/1cea6b0dee0b0f10d5f41433e27c70213a4c531f)`

```
This adds SCRIPT_VERIFY_LOW_S to STANDARD_SCRIPT_VERIFY_FLAGS which
 will make the node require the canonical 'low-s' encoding for
 ECDSA signatures when relaying or mining.

Consensus behavior is unchanged.

The rational is explained in [a81cd96](https://github.com/bitcoin/bitcoin/commit/a81cd96805ce6b65cca3a40ebbd3b2eb428abb7b):
 Absent this kind of test ECDSA is not a strong signature as given
 a valid signature {r, s} both that value and {r, -s mod n} are valid.
 These two encodings have different hashes allowing third parties a
 vector to change users txids.  These attacks are avoided by picking
 a particular form as canonical and rejecting the other form(s); in
 the of the LOW_S rule, the smaller of the two possible S values is
 used.

If widely deployed this change would eliminate the last remaining
 known vector for nuisance malleability on boring SIGHASH_ALL
 p2pkh transactions.  On the down-side it will block most
 transactions made by sufficiently out of date software.

Unlike the other avenues to change txids on boring transactions this
 one was randomly violated by all deployed bitcoin software prior to
 its discovery.  So, while other malleability vectors where made
 non-standard as soon as they were discovered, this one has remained
 permitted.  Even BIP62 did not propose applying this rule to
 old version transactions, but conforming implementations have become
 much more common since BIP62 was initially written.

Bitcoin Core has produced compatible signatures since [a28fb70](https://github.com/bitcoin/bitcoin/commit/a28fb70e45d764e558966ba3b02bd16e02b11c14) in
 September 2013, but this didn't make it into a release until 0.9
 in March 2014; Bitcoinj has done so for a similar span of time.
 Bitcoinjs and electrum have been more recently updated.

This does not replace the need for BIP62 or similar, as miners can
 still cooperate to break transactions.  Nor does it replace the
 need for wallet software to handle malleability sanely[1]. This
 only eliminates the cheap and irritating DOS attack.

[1] On the Malleability of Bitcoin Transactions
Marcin Andrychowicz, Stefan Dziembowski, Daniel Malinowski, ≈Åukasz Mazurek
<http://fc15.ifca.ai/preproceedings/bitcoin/paper_9.pdf>

Conflicts:
	src/policy/policy.h

Rebased-From: [b196b68](https://github.com/bitcoin/bitcoin/commit/b196b685c9089b74fd4ff3d9a28ea847ab36179b)
Github-Pull: [#6769](https://github.com/bitcoin/bitcoin/pull/6769)
```

[gmaxwell](/gmaxwell)
added a commit
that referenced
this pull request
[Oct 7, 2015](#ref-commit-71cc9d9)
[![@gmaxwell](https://avatars.githubusercontent.com/u/858454?s=40&u=63e5c438c242094837a9deeda775d77988b508bf&v=4)](/gmaxwell) [![@laanwj](https://avatars.githubusercontent.com/u/126646?s=40&v=4)](/laanwj)

`[Test LowS in standardness, removes nuisance malleability vector.](/bitcoin/bitcoin/commit/71cc9d9fe829efd9c9b012c4cd1ece1d988b4869 "Test LowS in standardness, removes nuisance malleability vector.

This adds SCRIPT_VERIFY_LOW_S to STANDARD_SCRIPT_VERIFY_FLAGS which
 will make the node require the canonical 'low-s' encoding for
 ECDSA signatures when relaying or mining.

Consensus behavior is unchanged.

The rational is explained in a81cd96805ce6b65cca3a40ebbd3b2eb428abb7b:
 Absent this kind of test ECDSA is not a strong signature as given
 a valid signature {r, s} both that value and {r, -s mod n} are valid.
 These two encodings have different hashes allowing third parties a
 vector to change users txids.  These attacks are avoided by picking
 a particular form as canonical and rejecting the other form(s); in
 the of the LOW_S rule, the smaller of the two possible S values is
 used.

If widely deployed this change would eliminate the last remaining
 known vector for nuisance malleability on boring SIGHASH_ALL
 p2pkh transactions.  On the down-side it will block most
 transactions made by sufficiently out of date software.

Unlike the other avenues to change txids on boring transactions this
 one was randomly violated by all deployed bitcoin software prior to
 its discovery.  So, while other malleability vectors where made
 non-standard as soon as they were discovered, this one has remained
 permitted.  Even BIP62 did not propose applying this rule to
 old version transactions, but conforming implementations have become
 much more common since BIP62 was initially written.

Bitcoin Core has produced compatible signatures since a28fb70e in
 September 2013, but this didn't make it into a release until 0.9
 in March 2014; Bitcoinj has done so for a similar span of time.
 Bitcoinjs and electrum have been more recently updated.

This does not replace the need for BIP62 or similar, as miners can
 still cooperate to break transactions.  Nor does it replace the
 need for wallet software to handle malleability sanely[1]. This
 only eliminates the cheap and irritating DOS attack.

[1] On the Malleability of Bitcoin Transactions
Marcin Andrychowicz, Stefan Dziembowski, Daniel Malinowski, ≈Åukasz Mazurek
http://fc15.ifca.ai/preproceedings/bitcoin/paper_9.pdf

Rebased-From: b196b685c9089b74fd4ff3d9a28ea847ab36179b
Github-Pull: #6769")`
‚Ä¶

`[71cc9d9](/bitcoin/bitcoin/commit/71cc9d9fe829efd9c9b012c4cd1ece1d988b4869)`

```
This adds SCRIPT_VERIFY_LOW_S to STANDARD_SCRIPT_VERIFY_FLAGS which
 will make the node require the canonical 'low-s' encoding for
 ECDSA signatures when relaying or mining.

Consensus behavior is unchanged.

The rational is explained in [a81cd96](https://github.com/bitcoin/bitcoin/commit/a81cd96805ce6b65cca3a40ebbd3b2eb428abb7b):
 Absent this kind of test ECDSA is not a strong signature as given
 a valid signature {r, s} both that value and {r, -s mod n} are valid.
 These two encodings have different hashes allowing third parties a
 vector to change users txids.  These attacks are avoided by picking
 a particular form as canonical and rejecting the other form(s); in
 the of the LOW_S rule, the smaller of the two possible S values is
 used.

If widely deployed this change would eliminate the last remaining
 known vector for nuisance malleability on boring SIGHASH_ALL
 p2pkh transactions.  On the down-side it will block most
 transactions made by sufficiently out of date software.

Unlike the other avenues to change txids on boring transactions this
 one was randomly violated by all deployed bitcoin software prior to
 its discovery.  So, while other malleability vectors where made
 non-standard as soon as they were discovered, this one has remained
 permitted.  Even BIP62 did not propose applying this rule to
 old version transactions, but conforming implementations have become
 much more common since BIP62 was initially written.

Bitcoin Core has produced compatible signatures since [a28fb70](https://github.com/bitcoin/bitcoin/commit/a28fb70e45d764e558966ba3b02bd16e02b11c14) in
 September 2013, but this didn't make it into a release until 0.9
 in March 2014; Bitcoinj has done so for a similar span of time.
 Bitcoinjs and electrum have been more recently updated.

This does not replace the need for BIP62 or similar, as miners can
 still cooperate to break transactions.  Nor does it replace the
 need for wallet software to handle malleability sanely[1]. This
 only eliminates the cheap and irritating DOS attack.

[1] On the Malleability of Bitcoin Transactions
Marcin Andrychowicz, Stefan Dziembowski, Daniel Malinowski, ≈Åukasz Mazurek
<http://fc15.ifca.ai/preproceedings/bitcoin/paper_9.pdf>

Rebased-From: [b196b68](https://github.com/bitcoin/bitcoin/commit/b196b685c9089b74fd4ff3d9a28ea847ab36179b)
Github-Pull: [#6769](https://github.com/bitcoin/bitcoin/pull/6769)
```

[![@laanwj](https://avatars.githubusercontent.com/u/126646?s=80&u=edaf64d0008bbf44ea0db7410ef2e54d1b4ae0f5&v=4)](/laanwj)

Copy link

Member

### **[laanwj](/laanwj)** commented [Oct 7, 2015](#issuecomment-146131631)

| Backported to 0.10 as [1cea6b0](https://github.com/bitcoin/bitcoin/commit/1cea6b0dee0b0f10d5f41433e27c70213a4c531f), and to 0.11 as [71cc9d9](https://github.com/bitcoin/bitcoin/commit/71cc9d9fe829efd9c9b012c4cd1ece1d988b4869)  Probably we should do a new release on both branches soon. |
| --- |

All reactions

Sorry, something went wrong.

[![@NicolasDorier](https://avatars.githubusercontent.com/u/3020646?s=80&u=256d78207f88d303d61b62060a309657276cf6cb&v=4)](/NicolasDorier)

Copy link

Contributor

### **[NicolasDorier](/NicolasDorier)** commented [Oct 10, 2015](#issuecomment-147069179)

| Is there any discussion about making Bitcoin Core malleate HighS sigs to LowS instead of just not relaying them ? |
| --- |

All reactions

Sorry, something went wrong.

[![@btcdrak](https://avatars.githubusercontent.com/u/7275704?s=80&u=578995010af9e1872285cb8e67bcb4f6052d52dd&v=4)](/btcdrak)

Copy link

Contributor

### **[btcdrak](/btcdrak)** commented [Oct 10, 2015](#issuecomment-147069671)

| [@NicolasDorier](https://github.com/NicolasDorier) I believe some miners are planning on doing this. |
| --- |

All reactions

Sorry, something went wrong.

[![@TheBlueMatt](https://avatars.githubusercontent.com/u/649246?s=80&v=4)](/TheBlueMatt)

Copy link

Contributor

### **[TheBlueMatt](/TheBlueMatt)** commented [Oct 11, 2015](#issuecomment-147257050)

| [@NicolasDorier](https://github.com/NicolasDorier) There seems to be some agreement that its best to not do that by default, but instead to do that temporarily by having devs and miners run a patch to do that on the network first, then slowly transition to making high-S entirely non-standard over time. |
| --- |

All reactions

Sorry, something went wrong.

[![@rubensayshi](https://avatars.githubusercontent.com/u/649160?s=80&v=4)](/rubensayshi)

Copy link

Contributor

### **[rubensayshi](/rubensayshi)** commented [Oct 21, 2015](#issuecomment-149839320)

| would this ever become part of consensus or is it more likely that we'll move torwards the suggested normalized transaction ID ? |
| --- |

All reactions

Sorry, something went wrong.

[![@evoskuil](https://avatars.githubusercontent.com/u/1369335?s=40&v=4)](/evoskuil)
[evoskuil](/evoskuil)
mentioned this pull request
[Oct 27, 2015](#ref-issue-113511136)

[Provide low s value signatures by default.
libbitcoin/libbitcoin-system#332](/libbitcoin/libbitcoin-system/issues/332)

Closed

[maflcko](/maflcko)
pushed a commit
to maflcko/bitcoin-core
that referenced
this pull request
[Mar 26, 2016](#ref-commit-3924b6b)
[![@gmaxwell](https://avatars.githubusercontent.com/u/858454?s=40&u=63e5c438c242094837a9deeda775d77988b508bf&v=4)](/gmaxwell) [![@mikehearn](https://avatars.githubusercontent.com/u/971089?s=40&v=4)](/mikehearn)

`[Test LowS in standardness, removes nuisance malleability vector.](/maflcko/bitcoin-core/commit/3924b6b8f4d1b49edee574878ccce1e5ab6f977d "Test LowS in standardness, removes nuisance malleability vector.

This adds SCRIPT_VERIFY_LOW_S to STANDARD_SCRIPT_VERIFY_FLAGS which
 will make the node require the canonical 'low-s' encoding for
 ECDSA signatures when relaying or mining.

Consensus behavior is unchanged.

The rational is explained in a81cd96805ce6b65cca3a40ebbd3b2eb428abb7b:
 Absent this kind of test ECDSA is not a strong signature as given
 a valid signature {r, s} both that value and {r, -s mod n} are valid.
 These two encodings have different hashes allowing third parties a
 vector to change users txids.  These attacks are avoided by picking
 a particular form as canonical and rejecting the other form(s); in
 the of the LOW_S rule, the smaller of the two possible S values is
 used.

If widely deployed this change would eliminate the last remaining
 known vector for nuisance malleability on boring SIGHASH_ALL
 p2pkh transactions.  On the down-side it will block most
 transactions made by sufficiently out of date software.

Unlike the other avenues to change txids on boring transactions this
 one was randomly violated by all deployed bitcoin software prior to
 its discovery.  So, while other malleability vectors where made
 non-standard as soon as they were discovered, this one has remained
 permitted.  Even BIP62 did not propose applying this rule to
 old version transactions, but conforming implementations have become
 much more common since BIP62 was initially written.

Bitcoin Core has produced compatible signatures since a28fb70e in
 September 2013, but this didn't make it into a release until 0.9
 in March 2014; Bitcoinj has done so for a similar span of time.
 Bitcoinjs and electrum have been more recently updated.

This does not replace the need for BIP62 or similar, as miners can
 still cooperate to break transactions.  Nor does it replace the
 need for wallet software to handle malleability sanely[1]. This
 only eliminates the cheap and irritating DOS attack.

[1] On the Malleability of Bitcoin Transactions
Marcin Andrychowicz, Stefan Dziembowski, Daniel Malinowski, ≈Åukasz Mazurek
http://fc15.ifca.ai/preproceedings/bitcoin/paper_9.pdf

Rebased-From: b196b685c9089b74fd4ff3d9a28ea847ab36179b
Github-Pull: #6769")`
‚Ä¶

`[3924b6b](/maflcko/bitcoin-core/commit/3924b6b8f4d1b49edee574878ccce1e5ab6f977d)`

```
This adds SCRIPT_VERIFY_LOW_S to STANDARD_SCRIPT_VERIFY_FLAGS which
 will make the node require the canonical 'low-s' encoding for
 ECDSA signatures when relaying or mining.

Consensus behavior is unchanged.

The rational is explained in [a81cd96](https://github.com/maflcko/bitcoin-core/commit/a81cd96805ce6b65cca3a40ebbd3b2eb428abb7b):
 Absent this kind of test ECDSA is not a strong signature as given
 a valid signature {r, s} both that value and {r, -s mod n} are valid.
 These two encodings have different hashes allowing third parties a
 vector to change users txids.  These attacks are avoided by picking
 a particular form as canonical and rejecting the other form(s); in
 the of the LOW_S rule, the smaller of the two possible S values is
 used.

If widely deployed this change would eliminate the last remaining
 known vector for nuisance malleability on boring SIGHASH_ALL
 p2pkh transactions.  On the down-side it will block most
 transactions made by sufficiently out of date software.

Unlike the other avenues to change txids on boring transactions this
 one was randomly violated by all deployed bitcoin software prior to
 its discovery.  So, while other malleability vectors where made
 non-standard as soon as they were discovered, this one has remained
 permitted.  Even BIP62 did not propose applying this rule to
 old version transactions, but conforming implementations have become
 much more common since BIP62 was initially written.

Bitcoin Core has produced compatible signatures since [a28fb70](https://github.com/maflcko/bitcoin-core/commit/a28fb70e45d764e558966ba3b02bd16e02b11c14) in
 September 2013, but this didn't make it into a release until 0.9
 in March 2014; Bitcoinj has done so for a similar span of time.
 Bitcoinjs and electrum have been more recently updated.

This does not replace the need for BIP62 or similar, as miners can
 still cooperate to break transactions.  Nor does it replace the
 need for wallet software to handle malleability sanely[1]. This
 only eliminates the cheap and irritating DOS attack.

[1] On the Malleability of Bitcoin Transactions
Marcin Andrychowicz, Stefan Dziembowski, Daniel Malinowski, ≈Åukasz Mazurek
<http://fc15.ifca.ai/preproceedings/bitcoin/paper_9.pdf>

Rebased-From: [b196b68](https://github.com/maflcko/bitcoin-core/commit/b196b685c9089b74fd4ff3d9a28ea847ab36179b)
Github-Pull: [bitcoin#6769](https://github.com/bitcoin/bitcoin/pull/6769)
```

[![@defuse](https://avatars.githubusercontent.com/u/4211072?s=40&v=4)](/defuse)
[defuse](/defuse)
mentioned this pull request
[Aug 16, 2016](#ref-issue-171044320)

[Merge upstream anti DoS patches
zcash/zcash#1251](/zcash/zcash/issues/1251)

Open

[![@mvandeberg](https://avatars.githubusercontent.com/u/15834128?s=40&v=4)](/mvandeberg)
[mvandeberg](/mvandeberg)
mentioned this pull request
[Dec 29, 2017](#ref-pullrequest-284824353)

[BIP-0062
steemit/fc#34](/steemit/fc/pull/34)
 Open

[![@jnewbery](https://avatars.githubusercontent.com/u/1063656?s=40&v=4)](/jnewbery)
[jnewbery](/jnewbery)
mentioned this pull request
[Jan 16, 2019](#ref-issue-400023030)

[[Chapter] pubkey and signature encoding
bitcoinops/scaling-book#9](/bitcoinops/scaling-book/issues/9)

Closed

[reddink](/reddink)
pushed a commit
to reddcoin-project/reddcoin-3.10
that referenced
this pull request
[May 27, 2020](#ref-commit-7417a89)
[![@gmaxwell](https://avatars.githubusercontent.com/u/858454?s=40&u=63e5c438c242094837a9deeda775d77988b508bf&v=4)](/gmaxwell) [![@reddink](https://avatars.githubusercontent.com/u/10765021?s=40&v=4)](/reddink)

`[Test LowS in standardness, removes nuisance malleability vector.](/reddcoin-project/reddcoin-3.10/commit/7417a89fc905846d0648a1784da02f506b74ba85 "Test LowS in standardness, removes nuisance malleability vector.

This adds SCRIPT_VERIFY_LOW_S to STANDARD_SCRIPT_VERIFY_FLAGS which
 will make the node require the canonical 'low-s' encoding for
 ECDSA signatures when relaying or mining.

Consensus behavior is unchanged.

The rational is explained in a81cd96805ce6b65cca3a40ebbd3b2eb428abb7b:
 Absent this kind of test ECDSA is not a strong signature as given
 a valid signature {r, s} both that value and {r, -s mod n} are valid.
 These two encodings have different hashes allowing third parties a
 vector to change users txids.  These attacks are avoided by picking
 a particular form as canonical and rejecting the other form(s); in
 the of the LOW_S rule, the smaller of the two possible S values is
 used.

If widely deployed this change would eliminate the last remaining
 known vector for nuisance malleability on boring SIGHASH_ALL
 p2pkh transactions.  On the down-side it will block most
 transactions made by sufficiently out of date software.

Unlike the other avenues to change txids on boring transactions this
 one was randomly violated by all deployed bitcoin software prior to
 its discovery.  So, while other malleability vectors where made
 non-standard as soon as they were discovered, this one has remained
 permitted.  Even BIP62 did not propose applying this rule to
 old version transactions, but conforming implementations have become
 much more common since BIP62 was initially written.

Bitcoin Core has produced compatible signatures since a28fb70e in
 September 2013, but this didn't make it into a release until 0.9
 in March 2014; Bitcoinj has done so for a similar span of time.
 Bitcoinjs and electrum have been more recently updated.

This does not replace the need for BIP62 or similar, as miners can
 still cooperate to break transactions.  Nor does it replace the
 need for wallet software to handle malleability sanely[1]. This
 only eliminates the cheap and irritating DOS attack.

[1] On the Malleability of Bitcoin Transactions
Marcin Andrychowicz, Stefan Dziembowski, Daniel Malinowski, ≈Åukasz Mazurek
http://fc15.ifca.ai/preproceedings/bitcoin/paper_9.pdf

Conflicts:
	src/policy/policy.h

Rebased-From: b196b685c9089b74fd4ff3d9a28ea847ab36179b
Github-Pull: #6769
(cherry picked from commit 1cea6b0dee0b0f10d5f41433e27c70213a4c531f)")`
‚Ä¶

`[7417a89](/reddcoin-project/reddcoin-3.10/commit/7417a89fc905846d0648a1784da02f506b74ba85)`

```
This adds SCRIPT_VERIFY_LOW_S to STANDARD_SCRIPT_VERIFY_FLAGS which
 will make the node require the canonical 'low-s' encoding for
 ECDSA signatures when relaying or mining.

Consensus behavior is unchanged.

The rational is explained in [a81cd96](https://github.com/reddcoin-project/reddcoin-3.10/commit/a81cd96805ce6b65cca3a40ebbd3b2eb428abb7b):
 Absent this kind of test ECDSA is not a strong signature as given
 a valid signature {r, s} both that value and {r, -s mod n} are valid.
 These two encodings have different hashes allowing third parties a
 vector to change users txids.  These attacks are avoided by picking
 a particular form as canonical and rejecting the other form(s); in
 the of the LOW_S rule, the smaller of the two possible S values is
 used.

If widely deployed this change would eliminate the last remaining
 known vector for nuisance malleability on boring SIGHASH_ALL
 p2pkh transactions.  On the down-side it will block most
 transactions made by sufficiently out of date software.

Unlike the other avenues to change txids on boring transactions this
 one was randomly violated by all deployed bitcoin software prior to
 its discovery.  So, while other malleability vectors where made
 non-standard as soon as they were discovered, this one has remained
 permitted.  Even BIP62 did not propose applying this rule to
 old version transactions, but conforming implementations have become
 much more common since BIP62 was initially written.

Bitcoin Core has produced compatible signatures since [a28fb70](https://github.com/reddcoin-project/reddcoin-3.10/commit/a28fb70e45d764e558966ba3b02bd16e02b11c14) in
 September 2013, but this didn't make it into a release until 0.9
 in March 2014; Bitcoinj has done so for a similar span of time.
 Bitcoinjs and electrum have been more recently updated.

This does not replace the need for BIP62 or similar, as miners can
 still cooperate to break transactions.  Nor does it replace the
 need for wallet software to handle malleability sanely[1]. This
 only eliminates the cheap and irritating DOS attack.

[1] On the Malleability of Bitcoin Transactions
Marcin Andrychowicz, Stefan Dziembowski, Daniel Malinowski, ≈Åukasz Mazurek
<http://fc15.ifca.ai/preproceedings/bitcoin/paper_9.pdf>

Conflicts:
	src/policy/policy.h

Rebased-From: [b196b68](https://github.com/reddcoin-project/reddcoin-3.10/commit/b196b685c9089b74fd4ff3d9a28ea847ab36179b)
Github-Pull: [bitcoin#6769](https://github.com/bitcoin/bitcoin/pull/6769)
(cherry picked from commit [1cea6b0](https://github.com/reddcoin-project/reddcoin-3.10/commit/1cea6b0dee0b0f10d5f41433e27c70213a4c531f))
```

[![@furszy](https://avatars.githubusercontent.com/u/5377650?s=40&u=a2d361f9264d43e1a34d8eb396be83ee0f1739e2&v=4)](/furszy)
[furszy](/furszy)
mentioned this pull request
[Jun 18, 2020](#ref-pullrequest-640905119)

[[Backport] Test LowS in standardness, removes nuisance malleability vector
PIVX-Project/PIVX#1694](/PIVX-Project/PIVX/pull/1694)
 Merged

[furszy](/furszy)
added a commit
to PIVX-Project/PIVX
that referenced
this pull request
[Jul 31, 2020](#ref-commit-0604a98)
[![@furszy](https://avatars.githubusercontent.com/u/5377650?s=40&u=a2d361f9264d43e1a34d8eb396be83ee0f1739e2&v=4)](/furszy)

`[Merge](/PIVX-Project/PIVX/commit/0604a98bd021d3f8017afe8075f44e0c96f53aaa "Merge #1694: [Backport] Test LowS in standardness, removes nuisance malleability vector

ccff44f389cf136987ec43320c0f982aeecb204e Test LowS in standardness, removes nuisance malleability vector. (furszy)

Pull request description:

  On top of #1693 (only last commit matter for this PR).

  Lot of fruitful information can be found in bitcoin#6769 .

  > This adds SCRIPT_VERIFY_LOW_S to STANDARD_SCRIPT_VERIFY_FLAGS which
  > will make the node require the canonical 'low-s' encoding for
  > ECDSA signatures when relaying or mining.

  > Absent this kind of test ECDSA is not a strong signature as given
  > a valid signature {r, s} both that value and {r, -s mod n} are valid.
  > These two encodings have different hashes allowing third parties a
  > vector to change users txids. These attacks are avoided by picking
  > a particular form as canonical and rejecting the other form(s); in
  > the of the LOW_S rule, the smaller of the two possible S values is
  > used.

ACKs for top commit:
  random-zebra:
    utACK ccff44f389cf136987ec43320c0f982aeecb204e
  Fuzzbawls:
    ACK ccff44f389cf136987ec43320c0f982aeecb204e

Tree-SHA512: abcd28e9eab04719480f7f3d8fafcaa9aa46cb52278c42211becde6537066a67fc0be340b6f3b1457efc5543053097d77682cd3c3c09f5dd931d0762cd5e9229") [#1694](https://github.com/PIVX-Project/PIVX/pull/1694)[: [Backport] Test LowS in standardness, removes nuisance m‚Ä¶](/PIVX-Project/PIVX/commit/0604a98bd021d3f8017afe8075f44e0c96f53aaa "Merge #1694: [Backport] Test LowS in standardness, removes nuisance malleability vector

ccff44f389cf136987ec43320c0f982aeecb204e Test LowS in standardness, removes nuisance malleability vector. (furszy)

Pull request description:

  On top of #1693 (only last commit matter for this PR).

  Lot of fruitful information can be found in bitcoin#6769 .

  > This adds SCRIPT_VERIFY_LOW_S to STANDARD_SCRIPT_VERIFY_FLAGS which
  > will make the node require the canonical 'low-s' encoding for
  > ECDSA signatures when relaying or mining.

  > Absent this kind of test ECDSA is not a strong signature as given
  > a valid signature {r, s} both that value and {r, -s mod n} are valid.
  > These two encodings have different hashes allowing third parties a
  > vector to change users txids. These attacks are avoided by picking
  > a particular form as canonical and rejecting the other form(s); in
  > the of the LOW_S rule, the smaller of the two possible S values is
  > used.

ACKs for top commit:
  random-zebra:
    utACK ccff44f389cf136987ec43320c0f982aeecb204e
  Fuzzbawls:
    ACK ccff44f389cf136987ec43320c0f982aeecb204e

Tree-SHA512: abcd28e9eab04719480f7f3d8fafcaa9aa46cb52278c42211becde6537066a67fc0be340b6f3b1457efc5543053097d77682cd3c3c09f5dd931d0762cd5e9229")`
‚Ä¶

`[0604a98](/PIVX-Project/PIVX/commit/0604a98bd021d3f8017afe8075f44e0c96f53aaa)`

```
‚Ä¶alleability vector

[ccff44f](https://github.com/PIVX-Project/PIVX/commit/ccff44f389cf136987ec43320c0f982aeecb204e) Test LowS in standardness, removes nuisance malleability vector. (furszy)

Pull request description:

  On top of [#1693](https://github.com/PIVX-Project/PIVX/pull/1693) (only last commit matter for this PR).

  Lot of fruitful information can be found in [bitcoin#6769](https://github.com/bitcoin/bitcoin/pull/6769) .

  > This adds SCRIPT_VERIFY_LOW_S to STANDARD_SCRIPT_VERIFY_FLAGS which
  > will make the node require the canonical 'low-s' encoding for
  > ECDSA signatures when relaying or mining.

  > Absent this kind of test ECDSA is not a strong signature as given
  > a valid signature {r, s} both that value and {r, -s mod n} are valid.
  > These two encodings have different hashes allowing third parties a
  > vector to change users txids. These attacks are avoided by picking
  > a particular form as canonical and rejecting the other form(s); in
  > the of the LOW_S rule, the smaller of the two possible S values is
  > used.

ACKs for top commit:
  random-zebra:
    utACK [ccff44f](https://github.com/PIVX-Project/PIVX/commit/ccff44f389cf136987ec43320c0f982aeecb204e)
  Fuzzbawls:
    ACK [ccff44f](https://github.com/PIVX-Project/PIVX/commit/ccff44f389cf136987ec43320c0f982aeecb204e)

Tree-SHA512: abcd28e9eab04719480f7f3d8fafcaa9aa46cb52278c42211becde6537066a67fc0be340b6f3b1457efc5543053097d77682cd3c3c09f5dd931d0762cd5e9229
```

[![@jnewbery](https://avatars.githubusercontent.com/u/1063656?s=40&v=4)](/jnewbery)
[jnewbery](/jnewbery)
mentioned this pull request
[Oct 27, 2020](#ref-pullrequest-729508456)

[Newsletters: add 121 (2020-10-28)
bitcoinops/bitcoinops.github.io#479](/bitcoinops/bitcoinops.github.io/pull/479)
 Merged

5 tasks

[![@bitcoin](https://avatars.githubusercontent.com/u/528860?s=40&v=4)](/bitcoin)
[bitcoin](/bitcoin)
locked as **resolved** and limited conversation to collaborators
[Sep 8, 2021](#event-5271628838)

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbitcoin%2Fpull%2F6769).

Reviewers

No reviews

Assignees

No one assigned

Labels

[TX fees and policy](/bitcoin/bitcoin/labels/TX%20fees%20and%20policy)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

12 participants

[![@gmaxwell](https://avatars.githubusercontent.com/u/858454?s=52&v=4)](/gmaxwell) [![@pstratem](https://avatars.githubusercontent.com/u/620611?s=52&v=4)](/pstratem) [![@TheBlueMatt](https://avatars.githubusercontent.com/u/649246?s=52&v=4)](/TheBlueMatt) [![@btcdrak](https://avatars.githubusercontent.com/u/7275704?s=52&v=4)](/btcdrak) [![@paveljanik](https://avatars.githubusercontent.com/u/6848764?s=52&v=4)](/paveljanik) [![@laanwj](https://avatars.githubusercontent.com/u/126646?s=52&v=4)](/laanwj) [![@dcousens](https://avatars.githubusercontent.com/u/413395?s=52&v=4)](/dcousens) [![@dexX7](https://avatars.githubusercontent.com/u/5836089?s=52&v=4)](/dexX7) [![@petertodd](https://avatars.githubusercontent.com/u/7042?s=52&v=4)](/petertodd) [![@NicolasDorier](https://avatars.githubusercontent.com/u/3020646?s=52&v=4)](/NicolasDorier) [![@tulip0](https://avatars.githubusercontent.com/u/15009664?s=52&v=4)](/tulip0) [![@rubensayshi](https://avatars.githubusercontent.com/u/649160?s=52&v=4)](/rubensayshi)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from lists.linuxfoundation.org_5b4617c5_20250119_113753.html ===
From conner at lightning.engineering Tue Oct 20 21:52:27 2020
From: conner at lightning.engineering (Conner Fromknecht)
Date: Tue, 20 Oct 2020 14:52:27 -0700
Subject: [Lightning-dev] CVE-2020-26895: LND Low-S Tx-Relay Standardness
Message-ID:
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
Hi all,
Today we are writing to disclose the details of CVE-2020-26895 as a follow up to
the partial disclosure sent to lightning-dev [1].
## Abstract
Prior to v0.10.0-beta, a malicious peer could force an lnd node to accept a
high-S ECDSA signature when updating new off-chain states. Though the signatures
are valid according to consensus rules, the mempool policy would reject
transactions containing high-S values, potentially leading to loss of funds if
time-sensitive transactions cannot be relayed and confirmed. We have no evidence
of the bug being exploited in the wild.
It affects all classes of lnd nodes: routing, merchant, mobile, etc.
The vulnerability was reported privately to the lnd team by Antoine Riard.
## Background
The lightning-rfc specifies a fixed-width, 64-byte encoding used to transmit
ECDSA signatures in the Lightning protocol, which differs from the DER-encoding
used at the consensus layer. For regular, on-chain transactions, signature
serialization is handled by the btcec library's Signature.Serialize() method
[2]. This method always normalizes signatures to their low-S variant before
performing the DER-encoding to ensure that the btcec library can't \_produce\_
high-S signatures.
Early in lnd's history, however, serialization modeled off btcec was added to
produce DER-encoded signatures directly from the fixed-width representation,
bypassing the conversion into big.Int representation used internally by btcec.
In doing so, retaining the low-S normalization behavior was overlooked, and so
Sig.ToSignatureBytes() [3] would return high-S DER signatures whenever the
fixed-size signature was encoded with a high-S value.
During unilateral closure, this can be exploited by an attacker to cause a
second-level HTLC-success transaction from being accepted to the mempool. If the
victim is unable to patch before the HTLC's CLTV expires, the attacker can then
broadcast their HTLC-timeout transaction and recover the full value of the HTLC
minus fees. On the other hand, lnd?s cooperative close fully verifies the remote
party?s signatures using full policy-aware verification. As a result, the only
exploitation vector occurs during the force close scenario.
## Updates to Lighting RFC
As noted by Riard during the process, the lightning-rfc is lacking in terms of
specifying how nodes should validate signatures accepted off-chain. Notably, the
signatures should be checked for conformation to both consensus \_and\_ tx-relay
standardness rules, and rejected otherwise. Riard has confirmed that he is
planning to submit an update to the specification incorporating these
recommendations.
## Patch
This vulnerability was fixed in v0.10.0-beta by converting all witness
construction methods in lnd to accept signatures according to the
input.Signature interface introduced in PR 4172 [4], which requires the passed
object to have a Serialize() method. lnwire.Sig does not have a Serialize()
method, and so cannot satisfy the interface. As a result, the relevant call
sites were updated to pass in a btcec.Signature, forcing witness signature
serialization through btcec's Serialize() method which includes low-S
normalization.
Note: A high-S signature can be converted to a low-S one manually w/o software
changes, or by a 3rd party, assuming one is aware of the reason for rejection.
Though the above recommendation to the spec by Riard also mitigates the issue,
this approach was chosen because it could retroactively patch affected nodes if
they are upgraded before the HTLC deadline expires, as well as its covertness.
After upgrading, any outstanding broadcasts would be reattempted, this time
normalizing any previously-persisted high-S signatures into their low-S variant.
Following the disclosure, lnd will also introduce the full tx-relay standardness
checks that are to be added to the lightning-rfc, as this offers a more general
and complete approach to ensuring lnd always adheres to standardness rules.
## Timeline
04/03/2020 - Initial report from Antoine Riard
04/10/2020 - PR 4172 merged into master
04/29/2020 - lnd v0.10.0-beta released
08/20/2020 - lnd v0.11.0-beta released
10/08/2020 - Partial Disclosure sent to lightning-dev and lnd mailing list [1]
10/20/2020 - Full Disclosure sent to lightning-dev and lnd mailing list
## References
[1] https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002819.html
[2] https://github.com/btcsuite/btcd/blob/ba530c4abb35ea824a1d3c01d74969b5564c3b08/btcec/signature.go#L47
[3] https://github.com/lightningnetwork/lnd/blob/0f94b8dc624cf0e96ddc8fe1b8e3bf4b3fc4c074/lnwire/signature.go#L92
[4] https://github.com/lightningnetwork/lnd/pull/4172
[5] https://gist.github.com/ariard/fb432a9d2cd3ba24fdc18ccc8c5c6eb4
Huge thanks to Antoine Riard for the responsible disclosure and for helping to
make lnd more safu. More information can be found in Antoine?s disclosure [5].
Regards,
Conner Fromknecht
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCAAdFiEEnI1hhop8SSADsnRO59c3tn+lkscFAl+PWykACgkQ59c3tn+l
ksf7Yg//WqZjtkw4Ol1fsbK+lfAkt6UENAq6Pja4/ZatkFI+U9Of3SwCNA5aAP1p
XSSk4tQptNJi3o8IoUSGLuFZVOzc6SB/vrU3l+MMVcAfgnSj1N5rqW1OLv3Lm/fH
Jz8eSvPtSEdtFt1JOC1VEd4ZEukjB8T6P/d4yudptUTk0tMrkLhLcN7byflxttU/
vG2JTtLl0uO+A2rhHkNvoUYqNLEOQssoAmShEBu+8uK56xGkRJQoBWvWN+yJDWor
MsI9awUzWrvlGU4qCD2WxVWjK7/SXK7cz4PC1XaNr0RqhucXm6lL2wn4r/G1Qqx6
z6ztMG3rHNnLI43Y1DVn2qPiLyhx1cBe/X8U9EUmA1jDv3zCKo9MmRx1gS69DQx+
rWBx3N6AIevs3aU6fF2IrwMfrX/0Xb0HT/fIDq1qhN46UZaxJTUuRkQkpJHNNajI
ze5mmussTg/cdPlSkYTt7/h0CgWN6DAEGVYp6hsPqGoH7jrsEB+wRtsihHRAXevX
dcHZRoB4OG/oKs5vYZk2LIRKr1miNSdas5T0rJA7voGMMJEa5L8nKqGfzMXsudAv
n+gVXCLPx3KjTF8yQrNu277ptGIy4AG71MQoOdxkzLtbzm2vfyDMNd14Qk3KWHVz
NACF4EXcq+oebSIj5kkiNx2jei0hdYVJGPHp8XkewRb0KuB2yDw=
=Sd09
-----END PGP SIGNATURE-----


=== Content from github.com_6a93a179_20250119_132642.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbips%2Fblob%2Fmaster%2Fbip-0147.mediawiki)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbitcoin%2Fbips%2Fblob%2Fmaster%2Fbip-0147.mediawiki)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=bitcoin%2Fbips)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bitcoin](/bitcoin)
/
**[bips](/bitcoin/bips)**
Public

* [Notifications](/login?return_to=%2Fbitcoin%2Fbips) You must be signed in to change notification settings
* [Fork
  5.5k](/login?return_to=%2Fbitcoin%2Fbips)
* [Star
   9.6k](/login?return_to=%2Fbitcoin%2Fbips)

* [Code](/bitcoin/bips)
* [Pull requests
  27](/bitcoin/bips/pulls)
* [Actions](/bitcoin/bips/actions)
* [Wiki](/bitcoin/bips/wiki)
* [Security](/bitcoin/bips/security)
* [Insights](/bitcoin/bips/pulse)

Additional navigation options

* [Code](/bitcoin/bips)
* [Pull requests](/bitcoin/bips/pulls)
* [Actions](/bitcoin/bips/actions)
* [Wiki](/bitcoin/bips/wiki)
* [Security](/bitcoin/bips/security)
* [Insights](/bitcoin/bips/pulse)

## Files

¬†master
## Breadcrumbs

1. [bips](/bitcoin/bips/tree/master)
/
# bip-0147.mediawiki

Copy path Blame  Blame
## Latest commit

## History

[History](/bitcoin/bips/commits/master/bip-0147.mediawiki)59 lines (32 loc) ¬∑ 3.61 KB¬†master
## Breadcrumbs

1. [bips](/bitcoin/bips/tree/master)
/
# bip-0147.mediawiki

Top
## File metadata and controls

* Preview
* Code
* Blame

59 lines (32 loc) ¬∑ 3.61 KB[Raw](https://github.com/bitcoin/bips/raw/refs/heads/master/bip-0147.mediawiki)
```
  BIP: 147
  Layer: Consensus (soft fork)
  Title: Dealing with dummy stack element malleability
  Author: Johnson Lau <jl2012@xbt.hk>
  Comments-Summary: No comments yet.
  Comments-URI: https://github.com/bitcoin/bips/wiki/Comments:BIP-0147
  Status: Final
  Type: Standards Track
  Created: 2016-09-02
  License: PD

```

| Table of Contents    + [Abstract](#user-content-Abstract) + [Motivation](#user-content-Motivation) + [Specification](#user-content-Specification) + [Deployment](#user-content-Deployment) + [Compatibility](#user-content-Compatibility) + [Implementation](#user-content-Implementation) + [Acknowledgements](#user-content-Acknowledgements) + [Copyright](#user-content-Copyright) |
| --- |

## Abstract

This document specifies proposed changes to the Bitcoin transaction validity rules to fix a malleability vector in the extra stack element consumed by `OP_CHECKMULTISIG` and `OP_CHECKMULTISIGVERIFY`.

## Motivation

Signature malleability refers to the ability of any relay node on the network to transform the signature in transactions, with no access to the relevant private keys required. For non-segregated witness transactions, signature malleability will change the `txid` and invalidate any unconfirmed child transactions. Although the `txid` of segregated witness ([BIP141](https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki)) transactions is not third party malleable, this malleability vector will change the `wtxid` and may reduce the efficiency of compact block relay ([BIP152](https://github.com/bitcoin/bips/blob/master/bip-0152.mediawiki)).

A design flaw in `OP_CHECKMULTISIG` and `OP_CHECKMULTISIGVERIFY` causes them to consume an extra stack element ("dummy element") after signature validation. The dummy element is not inspected in any manner, and could be replaced by any value without invalidating the script. This document specifies a new rule to fix this signature malleability.

## Specification

To fix the dummy element malleability, a new consensus rule ("`NULLDUMMY`") is deployed to require that the dummy element MUST be the empty byte array. Anything else makes the script evaluate to false immediately. The `NULLDUMMY` rule applies to `OP_CHECKMULTISIG` and `OP_CHECKMULTISIGVERIFY` in pre-segregated scripts, and also pay-to-witness-script-hash scripts described in BIP141.

## Deployment

This BIP will be deployed by "version bits" [BIP9](https://github.com/bitcoin/bips/blob/master/bip-0009.mediawiki) using the same parameters for BIP141 and BIP143, with the name "segwit" and using bit 1.

For Bitcoin mainnet, the BIP9 starttime is midnight 15 November 2016 UTC (Epoch timestamp 1479168000) and BIP9 timeout is midnight 15 November 2017 UTC (Epoch timestamp 1510704000).

For Bitcoin testnet, the BIP9 starttime is midnight 1 May 2016 UTC (Epoch timestamp 1462060800) and BIP9 timeout is midnight 1 May 2017 UTC (Epoch timestamp 1493596800).

## Compatibility

The reference client has produced compatible signatures from the beginning, and the `NULLDUMMY` rule has been enforced as relay policy by the reference client since v0.10.0. There has been no transactions violating the requirement being added to the chain since at least August 2015.

For all scriptPubKey types in actual use, non-compliant signatures can trivially be converted into compliant ones, so there is no loss of functionality by this requirement. Users MUST pay extra attention to this new rule when designing exotic scripts.

## Implementation

An implementation for the reference client is available at [bitcoin/bitcoin#8636](https://github.com/bitcoin/bitcoin/pull/8636)

## Acknowledgements

Peter Todd is the original author of NULLDUMMY. This document is extracted from the previous [BIP62](https://github.com/bitcoin/bips/blob/master/bip-0062.mediawiki) proposal, which was composed by Pieter Wuille and had input from various people.

## Copyright

This document is placed in the public domain.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from lists.linuxfoundation.org_97418a7b_20250119_113751.html ===
From antoine.riard at gmail.com Tue Oct 20 22:56:09 2020
From: antoine.riard at gmail.com (Antoine Riard)
Date: Tue, 20 Oct 2020 18:56:09 -0400
Subject: [Lightning-dev] Full Disclosure: CVE-2020-26895 LND "Hodl my
Shitsig"
Message-ID:
# Problem
A lightning node must verify that its channel transactions are not only
consensus-valid but also tx-relay standard. The counterparty signatures are
part of the local txn (commitment/HTLC) as provided in the
`commitment\_signed`. Verifying consensus-validity of these signatures but
not their tx-relay standardness, let an attacker provoke a permanent
tx-relay failure of the victim transactions. The attacker can steal
in-flight HTLCs once they expire as the victim can't trustlessly claim them
onchain during the CLTV delay.
Bitcoin ECDSA signatures are made of the scalar pair (R, S). Since Bitcoin
Core 0.10 [0], high-S (above curve order / 2) signatures aren't standard
and thus any transaction containing one won't be relayed/mined on the
regular p2p network. Note, that this check isn't part of consensus rules
even if it has been proposed to be soft-forked [1].
Prior to v0.10, LND would have accepted counterparty high-S signature and
broadcast tx-relay invalid local commitment/HTLC transactions. This can be
exploited by any peer with an already open channel whatever victim
situation (routing node, payment-receiver, payment-sender [2]).
Contrary to other Lightning implementations, LND uses
`btcd.btcec.signature` for verifying counterparty signatures at commitment
signed exchange. This go package relies itself on the default golang crypto
ecdsa package. It differs from libsecp256k1, as the verification method
doesn't enforce the lower-S form of the signature, thus a libsecp256k1
signature validity is tighter than a golang ecdsa package one.
The `btcec` serialization code was correctly normalizing signature to low-S
but this step wasn?t included when that code was brought into LND?s
`lnwire`.
Note, that LND didn't suffer from this vulnerability on opening/closing as
it was relying on btcd.txscript witness verification method with the
correct standard flags, enforcing low-S signatures.
Note that Bitcoin Core (`CPubKey::Verify`) always normalizes signatures
before passing them to libsecp256k1 verification method which
unconditionally enforces low-S (`secp256k1\_ecdsa\_verify`).
# Solution
As ECDSA signatures are inherently malleable, even if the counterparty
provides a high-S signature it can be normalized by the receiver to a
tx-relay standard one.
A more proactive solution is to fail the channel at any reception of a
high-S signature as it's a clear signal that your counterparty is either
malicious or buggy (most bitcoin softwares generates low-S signature since
a while [3]).
For now, the first solution has been adopted by the LND team. A spec change
has been proposed to make the second a requirement.
# Background
A lightning node security underlies the assumption to be always able to
unilaterally broadcast channel transactions in the aim to timely confirm
them on-chain to enforce an off-chain negotiated balance.
It must be remembered that channel transactions are asymmetric, thus each
party owns a different version including all parties's balances/HTLCs. To
broadcast its version, a party must own a valid witness at any time.
For commitment transactions, the witness stack is the following :
0
For HTLC-Success:
0
For HTLC-Timeout:
0   <> (empty vector)
The / are the ones which might have been
maliciously malleated by an attacker.
These signatures are provided at channels updated by a counterparty's
`commitment signed`. Once it's accepted, the local node must release the
revocation secret for the previous channel state, thus relying on the
validity of highest state transactions for its funds' safety.
These transactions must be unilaterally broadcasted in case of reaching the
off-chain resolution deadline for [4]:
\* offered HTLCs for a routing/original sender
\* received HTLCs for a routing/last receiver
Note, this off-chain resolution deadline even if it's expressed as block
height it's not equal to a HTLC absolute timelock but must always be
inferior. It offers a block buffer for a local node to broadcast, fee-bump
and hopefully confirm its transactions.
A non-standard transaction can still be confirmed by out-of-band agreement
with a miner or a user intervention to correct the transaction if possible.
In the case of Lightning, the security model doesn't assume this kind of
user intervention and deployed timelocks would have been too short for a
reasonable intervention of a node operator.
# Discovery
While working on Rust-Lightning, I observed that the implementation was
generating MINIMALIF-invalid transactions due to a regression. This case
wasn't covered by our test framework as there is no easy-to-integrate
utility to test transaction standardness. After patching the spec, to
recall the MINIMALIF requirement on some channel transactions witnesses
[5], I audited deployed Lightning implementations w.r.t to Core script
interpreter policy flags. A quick test against LND (65f5119) revealed this
vulnerability.
After informing the LND team, I also informed the c-lightning and Eclair
teams. Even if this vulnerability is implementation specific, the tx-relay
standardness issues it underscored could have been failed by other
implementations. Thus an urgency fix by one of the team could have revealed
easy-to-exploit weaknesses in other in-production implementations. As the
vulnerability involves language-specific serializers and dependencies, it's
a hard task to evaluate correctness of an implementation without alerting
the concerned developers teams. For the future, it would be better to have
a clearer Lightning-wise coordination policy [6].
Note, that we agreed with the LND team for a 6-month embargo period, the
double of channel funding check CVEs. As the Lightning ecosystem is
maturing, the funds at stake are also growing. It should be minded how much
Lightning software is sensible compared to other security/cryptographic
software (e.g TLS). The high-stake nodes are known, channel connections are
mostly open, they're operating on top of a public infrastructure (the
Bitcoin network) and the codebases are fully open source. Lightning node
operators are running a Bitcoin bank in the plainsight, any failure might
be observed and exploited by an attacker.
I'm eager to engage the wider Lightning community on what a reasonable
vulnerability embargo should endure, both incentivizing dev teams to
proactively fix their security vulnerabilities while minding a wide range
of users, from business to hobbyists.
# Ecosystem Implications
This vulnerability is a case of a transaction standardness malleability.
Transaction standardness is a set of supplementary anti-DoS rules on top of
Bitcoin consensus rules. For e.g, MIN\_STANDARD\_TX\_NONWITNESS\_SIZE or
MINIMALIF-compliant witnesses. This set of rules isn't well-defined as it's
part of a full-node policy, which varies across implementations and
versions.
There is no \_a\_ tx-relay policy but as many tx-relay policies as there are
full-node deployed as some checks might be tightened by node settings. This
fact is acknowledged by LN devs since a while who are most of the time
testing channel transactions standardness against the latest Core release,
for lack of better.
This situation is concerning and sound to have been an undersight during
Lightning/payment channels protocols design. The transaction standardness
surface is quite wide, and any standardness fault, either accidental or
malicious triggered, can provoke a loss of funds for a LN node.
Further, this tx-relay standardness issue has a wider echo as other
time-sensitive multi-party protocols (e.g vaults/CoinSwaps) are affected.
All Bitcoin software implementing this class of protocols must correctly
sanitize counterparty contribution, to avoid jeopardizing funds security or
introducing easy DoS (e.g a dual-funded channel with counterparty
non-standard input) [7]
At the Bitcoin base layer, a tighter, new tx-relay standard rule could
potentially break the security of all these off-chain protocols and thus be
deployed silently without anyone realizing before it's an easy
exploitation. As of today, tx-relay standardness fog is a systematic risk
for layer 2 protocols relying on time-sensitive transactions and I engage
the wider Bitcoin ecosystem to address it.
# Timeline
2020-04-03: Vulnerability discovered, LND team notified
2020-04-29: lnd v0.10.0-beta released
2020-07-31: lnd v0.11.0-beta released
2020-10-08: Partial Disclosure, encourage lnd users to upgrade to lnd
v1.11.x ASAP
2020-10-09: CVE assigned (
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26895)
2020-10-15: Preventive Disclosure to c-lightning, Electrum and Eclair teams
2020-10-20: Full Disclosure
[0] https://github.com/bitcoin/bitcoin/pull/6769
[1] https://github.com/bitcoin/bips/blob/master/bip-0147.mediawiki
[2] A sender won't be able to timeout its offered payment on the first link
of the payment path thus it might be claimed after the expiration with a
preimage of which the utility is out-of-date
[3]
https://github.com/bitcoinops/scaling-book/issues/9#issuecomment-599047992
[4] For more information, see the Flood & Loot paper (
https://arxiv.org/pdf/2006.08513.pdf). The
channel timelocks which could have been exploited due to this current
vulnerable are similar, even if the attack building block differs (i.e
malicious mempool-congestion)
[5] https://github.com/lightningnetwork/lightning-rfc/pull/764
[6] https://github.com/lightningnetwork/lightning-rfc/pull/772
[7] For a wider discussion, see
https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2020-July/018063.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL:


=== Content from gist.github.com_eabd680c_20250119_113748.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fariard%2Ffb432a9d2cd3ba24fdc18ccc8c5c6eb4)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fariard%2Ffb432a9d2cd3ba24fdc18ccc8c5c6eb4&source=header-gist)

[Sign¬†in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fariard%2Ffb432a9d2cd3ba24fdc18ccc8c5c6eb4) [Sign¬†up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fariard%2Ffb432a9d2cd3ba24fdc18ccc8c5c6eb4&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@ariard](https://avatars.githubusercontent.com/u/23310655?s=64&v=4)](/ariard)

# [ariard](/ariard)/**[public-report-high-s.txt](/ariard/fb432a9d2cd3ba24fdc18ccc8c5c6eb4)** Secret

Last active
March 21, 2023 01:39

Show Gist options

* [Download ZIP](/ariard/fb432a9d2cd3ba24fdc18ccc8c5c6eb4/archive/f1ba100d0a66b931971556d9739274050f18bfb0.zip)

* [Star
  (1)
  1](/login?return_to=https%3A%2F%2Fgist.github.com%2Fariard%2Ffb432a9d2cd3ba24fdc18ccc8c5c6eb4)You must be signed in to star a gist
* [Fork
  (1)
  1](/login?return_to=https%3A%2F%2Fgist.github.com%2Fariard%2Ffb432a9d2cd3ba24fdc18ccc8c5c6eb4)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/ariard/fb432a9d2cd3ba24fdc18ccc8c5c6eb4.js&quot;&gt;&lt;/script&gt;
* Save ariard/fb432a9d2cd3ba24fdc18ccc8c5c6eb4 to your computer and use it in GitHub Desktop.

[Code](/ariard/fb432a9d2cd3ba24fdc18ccc8c5c6eb4)
[Revisions
4](/ariard/fb432a9d2cd3ba24fdc18ccc8c5c6eb4/revisions)
[Stars
1](/ariard/fb432a9d2cd3ba24fdc18ccc8c5c6eb4/stargazers)
[Forks
1](/ariard/fb432a9d2cd3ba24fdc18ccc8c5c6eb4/forks)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/ariard/fb432a9d2cd3ba24fdc18ccc8c5c6eb4.js&quot;&gt;&lt;/script&gt;

Save ariard/fb432a9d2cd3ba24fdc18ccc8c5c6eb4 to your computer and use it in GitHub Desktop.

[Download ZIP](/ariard/fb432a9d2cd3ba24fdc18ccc8c5c6eb4/archive/f1ba100d0a66b931971556d9739274050f18bfb0.zip)

 [Raw](/ariard/fb432a9d2cd3ba24fdc18ccc8c5c6eb4/raw/f1ba100d0a66b931971556d9739274050f18bfb0/public-report-high-s.txt)

[**public-report-high-s.txt**](#file-public-report-high-s-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | # Problem |
| --- | --- |
|  |  |
|  | A lightning node must verify that its channel transactions are not only consensus-valid but also |
|  | tx-relay standard. The counterparty signatures are part of the local txn (commitment/HTLC) |
|  | as provided in the `commitment\_signed`. Verifying consensus-validity of these signatures |
|  | but not their tx-relay standardness, let an attacker provoke a permanent tx-relay failure |
|  | of the victim transactions. The attacker can steal in-flight HTLCs once they expire as the victim |
|  | can't trustlessly claim them onchain during the CLTV delay. |
|  |  |
|  | Bitcoin ECDSA signatures are made of the scalar pair (R, S). Since Bitcoin Core 0.10 [0], high-S |
|  | (above curve order / 2) signatures aren't standard and thus any transaction containing one won't be |
|  | relayed/mined on the regular p2p network. Note, that this check isn't part of consensus rules even |
|  | if has been proposed to be soft-forked [1]. |
|  |  |
|  | Prior to v0.10, LND would have accepted counterparty high-S signature and broadcast tx-relay invalid |
|  | local commitment/HTLC transactions. This can be exploited by any peer with an open channel whatever |
|  | victim situation (routing node, payment-receiver, payment-sender [2]). |
|  |  |
|  | Contrary to other Lightning implementations, LND uses `btcd.btcec.signature` for verifying counterparty |
|  | signatures at commimtnent signed exchange. This go package relies itself on the default golang crypto |
|  | ecdsa package. It differs from libsecp256k1, as the verification method doesn't enforce the lower-S |
|  | form of the signature, thus a libsecp256k1 signature validity is tighter than a golang ecdsa package |
|  | one. |
|  |  |
|  | Note, that LND didn't suffer of this vulnerability on opening/closing as it was relying on btcd.txscript |
|  | witness verification method with the correct standard flags, enforcing low-S signatures. |
|  |  |
|  | Note that Bitcoin Core (`CPubKey::Verify`) always normalize signatures before passing them to |
|  | libsecp256k1 verification method which unconditionally enforces low-S (`secp256k1\_ecdsa\_verify`). |
|  |  |
|  | # Solution |
|  |  |
|  | As ECDSA signatures are inherently malleable, even if the counterparty provides a high-S signature |
|  | it can be normalized by the receiver to a tx-relay standard one. |
|  |  |
|  | A more proactive solution is to fail the channel at any reception of a high-S signature as it's a |
|  | clear signal that your counterparty is either malicious or buggy (most bitcoin softwares generate |
|  | low-S signature since a while [3]). |
|  |  |
|  | For now, the first solution has been adopted by the LND team. A spec change has been proposed to make |
|  | the second a requirement. |
|  |  |
|  | # Background |
|  |  |
|  | A lightning node security underlies on the assumption to be always able to unilaterally broadcast |
|  | channel transactions in the aim to timely confirm them on-chain to enforce an off-chain negotiated |
|  | balance. |
|  |  |
|  | It must be remembered that channel transactions are asymmetric, thus each party owns a different |
|  | version including all parties's balances/HTLCs. To broadcast its version, a party must own |
|  | a valid witness at anytime. |
|  |  |
|  | For commitment transactions, the witness stack is the following : |
|  |  |
|  | 0 <localfunding\_sig> <remotefunding\_sig> |
|  |  |
|  | For HTLC-Success: |
|  |  |
|  | 0 <remotehtlc\_sig> <localhtlc\_sig> <payment\_preimage> |
|  |  |
|  | For HTLC-Timeout: |
|  |  |
|  | 0 <remotehtlc\_sig> <localhtlc\_sig> <> (empty vector) |
|  |  |
|  | The <remotefunding\_sig>/<remotehtlc\_sig> are the ones which might have been maliciously malleated |
|  | by an attacker. |
|  |  |
|  | These signatures are provided at channel updated by a counterparty's `commitment signed`. Once it's |
|  | accepted, the local node must release the revocation secret for the previous channel state, thus |
|  | relying on the validity of highest state transactions for its funds safety. |
|  |  |
|  | These transactions must be unilaterally broadcasted in case of reaching the off-chain resolution |
|  | deadline for [4]: |
|  | \* offered HTLCs for a routing/original sender |
|  | \* received HTLCs for a routing/last receiver |
|  |  |
|  | Note, this off-chain resolution deadline even if it's expressed as block height it's not equal |
|  | to a HTLC absolute timelock but must always be inferior. It offers a block buffer for a local node |
|  | to broadcast, fee-bump and hopefully confirm its transations. |
|  |  |
|  | A non-standard transaction can still be confirmed by out-of-band agreement with a miner or a user |
|  | intervention to correct the transaction if possible. In the case of Lightning, the security model |
|  | doesn't assume this kind of user intervention and deployed timelocks would have been too short for |
|  | a reasonable intervention of a node operator. |
|  |  |
|  | # Discovery |
|  |  |
|  | While working on Rust-Lightning, I observed that the implementation was generating MINIMALIF-invalid |
|  | transactions due to a regression. This case wasn't covered by our test framework as there is no |
|  | easy-to-integrate utility to test transaction standardness. After patching the spec, to recall |
|  | the MINIMALIF requirement on some channel transactions witnesses [6], I audited deployed Lightning |
|  | implementations w.r.t to Core script interpreter standardness flags. A quick test against LND (65f5119) |
|  | revealed this vulnerability. |
|  |  |
|  | After informing the LND team, I also informed the c-lightning and Eclair teams. Even if this |
|  | vulnerability is implementation specific, the tx-relay standardness issues it underscored could |
|  | have been failed by other implementations. Thus an urgency fix by one of the team could have revealed |
|  | easy-to-exploit weaknesses in other in-production implementations. As the vulnerability involves |
|  | langage-specific serializers and dependencies, it's a hard task evaluate correctness of an implementation |
|  | without alerting the concerned developers teams. For the future, it would be better to have a clearer |
|  | Lightning-wise coordination policy [7]. |
|  |  |
|  | Note, that we agreed with the LND team for a 6-month embargo period, the double of channel funding |
|  | check CVEs. As the Lightning ecosystem is maturing, the funds are stake are also growing. It should |
|  | be minded how much Lightning software is sensible compared to other security/cryptographic software |
|  | (e.g TLS). The high-stake node are known, channel connections are mostly open, they're operating on |
|  | top of a public infrastructure (the Bitcoin network) and the codebases are fully open source. |
|  | Ligthning node operators are running a Bitcoin bank in the plainsight, any failure might be observed |
|  | and exploited by an attacker. |
|  |  |
|  | I'm eager to engage the wider Lightning community on what a reasonable vulnerability embargo |
|  | should endure, both incentivizing dev teams to proactively fix their security vulnerabilities while |
|  | minding a wide range of users, from business to hobbyists. |
|  |  |
|  | # Ecosystem Implications |
|  |  |
|  | This vulnerability is a case of a transaction standardness malleability. Transaction standardness |
|  | is a set of supplementary anti-DoS rules on top of Bitcoin consensus rulles. For e.g, |
|  | MIN\_STANDARD\_TX\_NONWITNESS\_SIZE or MINIMALIF-compliant witnesses. This set of rules isn't well-defined |
|  | as it's part of a full-node policy, which varies across implementations and versions. |
|  |  |
|  | There is no a tx-relay policy but as many tx-relay policies as there are full-node deployed as some |
|  | checks might be tighten by node settings. This fact is acknowledged by LN devs since a while who |
|  | are most of the time testing channel transactions standardness against lastest Core release, for lack |
|  | of better. |
|  |  |
|  | This situation is concerning and sound to have been an undersight during Lightning/payment channels |
|  | protocols design. The transaction standardness surface is quite wide, and any standardness fault, |
|  | either accidental or malicious triggered, can provoke a loss of funds for a LN node. |
|  |  |
|  | Further, this tx-relay standardness issue has a wider echo as other time-sensitive multi-party |
|  | protocols (e.g vaults/CoinSwaps) are affected. All Bitcoin software implementing this class |
|  | of protocols must correctly sanitize counterparty contribution, to avoid jeopardizing funds |
|  | security or introducing easy DoS (e.g a dual-funded channel with counterparty non-standard input) [8] |
|  |  |
|  | At the Bitcoin base layer, a tigher, new tx-relay standard rule could potentially break the security |
|  | of all these off-chain protocols and thus deployed silently without anyone realizing before it's |
|  | easy exploitation. As of today, tx-relay standardness fog is a systematic risk for layer 2 |
|  | protocols relying on time-sensitive transactions. |
|  |  |
|  | # Timeline |
|  |  |
|  | 2020-04-03: Vulnerability discovered, LND team notified |
|  | 2020-04-29: lnd v0.10.0-beta released |
|  | 2020-07-31: lnd v0.11.0-beta released |
|  | 2020-10-08: Partial Disclosure, encourage lnd users to upgrade to lnd v1.11.x ASAP |
|  | 2020-10-09: CVE assigned (https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26895) |
|  | 2020-10-20: Full Disclosure |
|  |  |
|  |  |
|  | [0] https://github.com/bitcoin/bitcoin/pull/6769 |
|  | [1] https://github.com/bitcoin/bips/blob/master/bip-0147.mediawiki |
|  | [2] A sender won't be able to timeout its offered payment on the first link of the payment path thus |
|  | it might be claimed after the expiration with a preimage of which the utility is out-of-date |
|  | [3] https://github.com/bitcoinops/scaling-book/issues/9#issuecomment-599047992 |
|  | [4] XXX |
|  | [5] For more information, see the Flood & Loot paper (https://arxiv.org/pdf/2006.08513.pdf). The |
|  | channel timelocks which could have been exploited due to this current vulnerable are similar, even |
|  | if the attack building block differs (i.e malicious mempool-congestion) |
|  | [6] https://github.com/lightningnetwork/lightning-rfc/pull/764 |
|  | [7] https://github.com/lightningnetwork/lightning-rfc/pull/772 |
|  | [8] For a wider discussion, see https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2020-July/018063.html |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fariard%2Ffb432a9d2cd3ba24fdc18ccc8c5c6eb4)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


