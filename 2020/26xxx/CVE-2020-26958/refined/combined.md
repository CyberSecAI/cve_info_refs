=== Content from bugzilla.mozilla.org_74ee7ad8_20250119_140519.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1667179)
* [XML](/show_bug.cgi?ctype=xml&id=1667179)

Closed
[Bug 1667179](/show_bug.cgi?id=1667179)
(CVE-2020-26957)

Opened 4 years ago
Closed 4 years ago

# OneCRL does not appear to be working in Fenix

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

OneCRL does not appear to be working in Fenix

## Categories

### (GeckoView :: General, defect, P1)

[Product:](/describecomponents.cgi?product=GeckoView)

GeckoView
▾

GeckoView
The GeckoView components for Android
[See Open Bugs in This Product](/buglist.cgi?product=GeckoView&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=GeckoView)
Watch This Product

[Component:](/describecomponents.cgi?product=GeckoView&component=General#General)

General
▾

GeckoView :: General
The GeckoView embedding widget for Android
[See Open Bugs in This Component](/buglist.cgi?product=GeckoView&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=GeckoView&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=GeckoView&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Android

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### (firefox82 wontfix, firefox83 fixed, firefox84 verified)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

83 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox82 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox82&o1=equals&v1=wontfix) |
| firefox83 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=fixed) |
| firefox84 | --- | [verified](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox82 |  | wontfix |
| firefox83 |  | fixed |
| firefox84 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: April, Assigned: agi)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/2f23a572bdd06777026ab2c155cfe0c0?d=mm&size=40)  [agi](/user_profile?user_id=421286)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/5bb414997e4fe4fec8d2341f0c429b57?d=mm&size=40)  [April](/user_profile?user_id=119354)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/418efed494240195b86667307fe63d5c?d=mm&size=40)  [owlish](/user_profile?user_id=579431)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

### (Regression, [URL](https://github.com/mozilla-mobile/fenix/issues/14597 "https://github.com/mozilla-mobile/fenix/issues/14597") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1526018](/show_bug.cgi?id=1526018 "RESOLVED FIXED - Initialize Intermediate Preloading in its own service")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[github.com/mozilla-mobile/fenix/issue...](https://github.com/mozilla-mobile/fenix/issues/14597 "https://github.com/mozilla-mobile/fenix/issues/14597")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1772232](/show_bug.cgi?id=1772232 "RESOLVED WORKSFORME - Enable/Implement remote settings on Android")

## Details

### (Keywords: regression, sec-moderate, Whiteboard: [geckoview:m83][adv-main83+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-26957

[Keywords:](/describekeywords.cgi)

[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[geckoview:m83][adv-main83+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [Bug 1667179 - Initialize OneCRL when GeckoView starts.](/attachment.cgi?id=9181068)  [4 years ago](#c10)  [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9181068&action=edit) | [Review](/attachment.cgi?id=9181068) |
| --- | --- | --- |
| [revoked.badssl.com on Chrome Android](/attachment.cgi?id=9181400)  [4 years ago](#c12)  [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)   253.25 KB, image/jpeg |  | [Details](/attachment.cgi?id=9181400&action=edit) |
| [advisory.txt](/attachment.cgi?id=9187214)  [4 years ago](#c18)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   258 bytes, text/plain |  | [Details](/attachment.cgi?id=9187214&action=edit) |
| [advisory.txt](/attachment.cgi?id=9188056)  [4 years ago](#c19)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   330 bytes, text/plain |  | [Details](/attachment.cgi?id=9188056&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [April King [:April]](/user_profile?user_id=119354)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1667179#c0)• 4 years ago |
|  | |

OneCRL (Remote Settings) does not appear to be working in Fenix, meaning that Fenix currently has no way to revoke misissued or malicious certificates. This may be related to [bug 1625257](/show_bug.cgi?id=1625257 "REOPENED - Support |storage.sync| API"), if Remote Settings uses `storage.sync`.

This was first reported here:

<https://github.com/mozilla-mobile/fenix/issues/14597>

With the thought that <https://revoked.badssl.com/> was not added to OneCRL, and so therefore didn't trigger the revocation error. However, it was added in [bug 1664854](/show_bug.cgi?id=1664854 "RESOLVED FIXED - Update OneCRL exceptional revocation entry for revoked.badssl.com") and the error persisted, bringing to light the fact that OneCRL-based certificate revocation appears to be completely nonfunctional in Fenix.

:dveditz, should we remove this (currently innocuous) looking bug from Github?

Flags: needinfo?(dveditz)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1667179#c1)• 4 years ago |
|  | |

I've confirmed that the update pref we'd expect Gecko to increment on OneCRL updates remains uninitialized at 0 in Fenix Nightly, which agrees with the idea that OneCRL is not updating / has no data on Fenix.

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1667179#c2)• 4 years ago |
|  | |

OneCRL is our mechanism for addressing compromise or malpractice ("misissuance") by Certificate Authorities, including those currently unknown (e.g., <https://blog.mozilla.org/security/2019/08/21/protecting-our-users-in-kazakhstan/> ).

For most Firefox users, OneCRL is delivered in their install package (in `/defaults/settings/security-state/onecrl.json`, packaged [here](https://searchfox.org/mozilla-central/source/services/settings/dumps/security-state)), and then the Kinto Client keeps it in-sync with periodic updates at Remote Settings; the deltas are typically about 100 bytes, consisting of a couple of strings, and occur on administrative action (e.g., rare, only when necessary). They do get broadcast by Megaphone, but normally on the daily kinto/remote settings check, Firefox gets OneCRL diffs, if any.

OneCRL today is larger than it needs to be, because Firefox 68 clients don't cleanly support removal from OneCRL. We intended for shorten OneCRL this week, but held off since Tor hasn't moved from ESR 68 yet. Anyway, typically the compressed OneCRL state is rolled into the installer and pretty small (540kB uncompressed, 72 kB with bz2).

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1667179#c3)• 4 years ago |
|  | |

Who owns this Fenix/A-C or GV?

Flags: needinfo?(snorp)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1667179#c4)• 4 years ago |
|  | |

I think we can leave the public github issue alone for now (that is, don't try to hide it). There are other bugs noting that Focus, for example, also doesn't support OneCRL, and other places that mention testing against revoked.badssl.com so we'll probably just get dupes if we take it away. But we should stop poking at the GH version of this bug and continue here while trying to work out why it isn't working.

Flags: needinfo?(dveditz) → needinfo?(s.kaspari)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1667179#c5)• 4 years ago |
|  | |

jc: would you call this sec-moderate or sec-high?

Flags: needinfo?(jjones)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667179#a1207460_1689)• 4 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1667179#c6)• 4 years ago |
|  | |

I agree with sec-moderate. Obviously this is a mitigation so that in the event of a sec-critical or sec-high we can avoid spinning builds, but ultimately we can still lean on RelEng to make an immediate point release of Fenix at any hour of the day or night. We just... shouldn't have to.

Flags: needinfo?(jjones)

|  | [Sebastian Kaspari (:sebastian; :pocmo)](/user_profile?user_id=472516) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1667179#c7)• 4 years ago |
|  | |

@Snorp, Agi: This is probably more in your layer or below. I assume GeckoView should deal with that internally?

Flags: needinfo?(s.kaspari) → needinfo?(agi)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1667179#c8)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1667179&comment_id=15080534 "1 revision") |
|  | |

ni esawin in case he knows what's going on here.

Interestingly chrome doesn't block revoked.badssl.com either.

I see that we should have the onecrl.json file on mobile, trying to figure out why it's not working.

Flags: needinfo?(agi) → needinfo?(esawin)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1667179#c9)• 4 years ago |
|  | |

Looks like this is a miss from [Bug 1526018](/show_bug.cgi?id=1526018 "RESOLVED FIXED - Initialize Intermediate Preloading in its own service") which moved the initialization code from somewhere in `security/` to `browser` and did not include the code in mobile too... patch incoming.

Regressions: [1526018](/show_bug.cgi?id=1526018 "RESOLVED FIXED - Initialize Intermediate Preloading in its own service")

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667179#a1546198_421286)• 4 years ago |

Flags: needinfo?(snorp)Flags: needinfo?(esawin)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667179#a1546294_421286)• 4 years ago |

Regressed by: [1526018](/show_bug.cgi?id=1526018 "RESOLVED FIXED - Initialize Intermediate Preloading in its own service")No longer regressions: [1526018](/show_bug.cgi?id=1526018 "RESOLVED FIXED - Initialize Intermediate Preloading in its own service")

|  | [BMO Automation](/user_profile?user_id=546015) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667179#a1546294_546015)• 4 years ago |

Has Regression Range: --- → yesKeywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1667179#c10)• 4 years ago |
|  | |

Attached file
[Bug 1667179 - Initialize OneCRL when GeckoView starts.](attachment.cgi?id=9181068)
— [Details](attachment.cgi?id=9181068&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667179#a1546413_600971)• 4 years ago |

Assignee: nobody → agiStatus: NEW → ASSIGNED

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667179#a1637379_421286)• 4 years ago |

Severity: -- → S3Priority: -- → P1Whiteboard: [geckoview:m83]

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667179#a1637521_406670)• 4 years ago |

Component: Security: Android → GeneralOS: Unspecified → AndroidProduct: Fenix → GeckoViewVersion: unspecified → Trunk

|  | [April King [:April]](/user_profile?user_id=119354)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1667179#c11)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1667179&comment_id=15082673 "1 revision") |
|  | |

(In reply to Agi Sferro | :agi | ⏰ PST | he/him from [comment #8](/show_bug.cgi?id=1667179#c8 "RESOLVED FIXED - OneCRL does not appear to be working in Fenix"))

> Interestingly chrome doesn't block revoked.badssl.com either.

Hmm, on which platform? Chrome desktop blocks it for me, as does Chrome on iOS.

(asking because I run badssl.com)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1667179#c12)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1667179&comment_id=15082761 "1 revision") |
|  | |

Attached image
[revoked.badssl.com on Chrome Android](attachment.cgi?id=9181400)
— [Details](attachment.cgi?id=9181400&action=edit)

(In reply to April King [:April] from [comment #11](/show_bug.cgi?id=1667179#c11 "RESOLVED FIXED - OneCRL does not appear to be working in Fenix"))

> (In reply to Agi Sferro | :agi | ⏰ PST | he/him from [comment #8](/show_bug.cgi?id=1667179#c8 "RESOLVED FIXED - OneCRL does not appear to be working in Fenix"))
>
> > Interestingly chrome doesn't block revoked.badssl.com either.
>
> Hmm, on which platform? Chrome desktop blocks it for me, as does Chrome on iOS.
>
> (asking because I run badssl.com)

On Android

|  | [April King [:April]](/user_profile?user_id=119354)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1667179#c13)• 4 years ago |
|  | |

Ahh, got'cha. Yeah, I think it's coming at some point, but currently Chrome (Android) doesn't make use of CRLSet/Blacklist as it relies on Android's path discovery and verification.

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1667179#c14)• 4 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/1aa2dc4b280e4ac1d5d5742e1923d5d39c04c102>

<https://hg.mozilla.org/mozilla-central/rev/1aa2dc4b280e>

Group: mobile-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-firefox83](/buglist.cgi?f1=cf_status_firefox83&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 83 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667179#a3111568_75935)• 4 years ago |

[status-firefox82](/buglist.cgi?f1=cf_status_firefox82&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox82&o1=equals&v1=wontfix)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1667179#c15)• 4 years ago |
|  | |

In Fenix 84 <https://revoked.badssl.com/> gets blocked but it loads in 83 but the central revision landed in 83. about:buildconfig says it should be included (tagged as devedition etc), might one of the dependencies have an older central revision hardcoded?

[status-firefox84](/buglist.cgi?f1=cf_status_firefox84&o1=isnotempty):
--- → [verified](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=verified)Flags: needinfo?(esawin)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667179#a4054363_421286)• 4 years ago |

Flags: needinfo?(esawin) → needinfo?(agi)

|  | [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1667179#c16)• 4 years ago |
|  | |

I think this is caused by the CRL list not being downloaded yet, could you try leaving the browser idle before testing? It works fine on my Fenix Beta (83).

Flags: needinfo?(agi) → needinfo?(aryx.bugmail)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1667179#c17)• 4 years ago |
|  | |

Let Firefox 83.0b10 idle twice >20 minutes, terminated app, launched it again, <https://revoked.badssl.com/> still doesn't get blocked.

Flags: needinfo?(aryx.bugmail)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667179#a4149786_578488)• 4 years ago |

Whiteboard: [geckoview:m83] → [geckoview:m83][adv-main83+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1667179#c18)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9187214) (obsolete)
— [Details](attachment.cgi?id=9187214&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1667179#c19)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9188056)
— [Details](attachment.cgi?id=9188056&action=edit)

[Attachment #9187214](/attachment.cgi?id=9187214&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667179#a4573574_578488)• 4 years ago |

Alias: CVE-2020-26957

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667179#a16615701_1689)• 4 years ago |

Group: core-security-release

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1667179#a53152757_430528)• 3 years ago |

See Also: → [1772232](/show_bug.cgi?id=1772232 "RESOLVED WORKSFORME - Enable/Implement remote settings on Android")
You need to [log in](/show_bug.cgi?id=1667179&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [[ex-Mozilla] Agi Sferro | :agi](/user_profile?user_id=421286)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_ef8238f3_20250119_140518.html ===


# BMO/UserGuide/Whiteboard

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)

Each bug has a free-form single line text entry box for adding tags and status information. This wiki page is dedicated to collect a comprehensive list of whiteboard tags used in the Mozilla project.

## Contents

* [1 Whiteboard considered harmful](#Whiteboard_considered_harmful)
* [2 Contributor mentoring](#Contributor_mentoring)
* [3 Automated Testing](#Automated_Testing)
* [4 Autonag](#Autonag)
* [5 Release Engineering](#Release_Engineering)
* [6 Sheriffing](#Sheriffing)
* [7 Firefox](#Firefox)
* [8 Community reported bugs](#Community_reported_bugs)
* [9 Firefox OS](#Firefox_OS)
* [10 Tor](#Tor)
* [11 Web Compatibility](#Web_Compatibility)
* [12 Scrum Development](#Scrum_Development)
* [13 What does this whiteboard keyword mean?](#What_does_this_whiteboard_keyword_mean?)
## Whiteboard considered harmful

It is recommended that you request alternative metadata instead of using whiteboard tagging.

* Updating whiteboards tags through the API is non-trivial
* There is no global auto-suggest for whiteboard tags
* There is no verification of whiteboard tags; typos will not be caught and prevented
* Renaming a whiteboard tag requires writing a script to update every bug with that tag, changing its last modified timestamp and generating bugmail; other solutions involve a simple change by administrators
* Whiteboard tags cannot be disabled; people might continue to provide them after they are no longer relevant thinking they still apply
* If desired it's possible to restrict who can set flags to particular values; it will never be possible to prevent accidental or other changes to the whiteboard from any user with editbugs or the bug's reporter

Consider using a keyword, a flag, or a status flag. You can request this on [Bugzilla](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).

## Contributor mentoring

For more information, see [Mentors](/Mentors "Mentors").

* `[lang=]`: The programming language involved for this bug.
* `[mentor-lang=]`: (human/natural) language other than English the mentor will be able to communicate to the contributor with.

## Automated Testing

* `[test disabled]`: Indicates an automated test has been disabled. Typically used in bugs filed for intermittent test failures, to indicate that the absence of new failures in the bug is due to the test being disabled - as well as remind module owners that the test needs fixing and re-enabling.

## Autonag

`[no-nag]`: Indicates that a bug should not be modified or commented in by our [Autonag](/Release_Management/autonag "Release Management/autonag") scripts.

## Release Engineering

* `[capacity]`: This bug will help increase (or free up) capacity for our automated build & test machines.

## Sheriffing

* `[leave open]`: This has [been deprecated](https://groups.google.com/forum/#!topic/mozilla.dev.platform/Ie9OXcWbTSs) in favour of the 'leave-open' keyword. Used to ensure that the bug updating tool mcMerge does not close the bug when commits referencing it are merged into mozilla-central.
* `[retriggered]`: Used by sheriffs when investigating Fresh Oranges [[1]](https://charts.mozilla.org/FreshOranges/index.html) to find where a failure started from, using backfills and retriggers

## Firefox

* `dupeme`, `dupme`, or `DUPEME`: we're pretty sure this bug report is a duplicate of another bug, but cannot recall which one or cannot find it.
* `[qa-]`: QE (Quality Engineering) verification not required - superseded by the qe-verify flag.
* `[adv-mainNN+]` (where `NN` is some number): a security advisory about this bug for the release `NN` will be (has been) written.
* `[MemShrink]`: [a project](/Performance/MemShrink "Performance/MemShrink") to reduce memory consumption.

## Community reported bugs

* `[nightly-community]`: This bug was reported by a member of the Firefox Nightly community. Used to triage community-reported bugs and measure the impact of our core community on product quality.
* `[mozfr-community]`: This bug was reported by a member of the MozFR French-speaking community. Used to evaluate the impact of the mozfr.org community on product quality.

## Firefox OS

[Template:Note: This project is no longer active, but we leave these definitions for bug tracker historian purposes](/index.php?title=Template:Note:_This_project_is_no_longer_active,_but_we_leave_these_definitions_for_bug_tracker_historian_purposes&action=edit&redlink=1 "Template:Note: This project is no longer active, but we leave these definitions for bug tracker historian purposes (page does not exist)")

* `[POVB]`: Part of vendor build; the fix of this bug is not in the Mozilla codebase, but it's in our interest to track it.
* `[priority]`: Indicates we are asked by a partner to address this issue with priority.
* `[tarako_only]`: Special pref or feature that only lands on branch for Tarako (low memory phone), i.e. 1.3T branch of Gaia and Gecko. To be picked up on future releases.
* `[p=]/[u=]/[c=]/[s=]`: See [Scrum Development](/BMO/Whiteboard#Scrum_Development "BMO/Whiteboard"). Firefox OS uses the u= tag as the milestone instead, see [Firefox OS Performance Triage](/FirefoxOS/Performance/Triage#Scrumbugs_Tags "FirefoxOS/Performance/Triage")
* `[ft:<name of the team>]`, `[systemsfe]`, etc: Bugs identified to be owned by a "functional team" within B2G engineering. Each team owns a specific set of Bugzilla components, and tags are used to denote owned bugs outside of these components.

## Tor

* `[tor ###]` Part of the [Tor uplift project](/Security/Tor_Uplift/Tracking "Security/Tor Uplift/Tracking"). For example, `[tor 16620]` indicates a corresponding ticket at <https://trac.torproject.org/16620>. See also <https://torpat.ch/uplift>

## Web Compatibility

[Our whiteboard keywords](/Compatibility/BugsGuide "Compatibility/BugsGuide") are already described.

## Scrum Development

The following flags are used by tools like [scrumbu.gs](https://scrumbu.gs/help/) for managing sprints using the scrum development framework:

* `[p=]`: A rough estimate from engineer on how long the bug is going to take.
* `[u=]`: The user (in the scrum sense) that this story affects
* `[c=]`: The component (in the scrum sense) that this story affects
* `[s=]`: An explicit sprint slug this bug should belong to.

If you are not managing a product, you probably don't have to set these.

## What does this whiteboard keyword mean?

If you know what one of the following whiteboard keywords means, please describe it and put it into one of the above categories above (or create a new one):

* `[2.0-FL-bug-bash]` (example: <https://bugzilla.mozilla.org/show_bug.cgi?id=1021384>)
* `[games]` (example: <https://bugzilla.mozilla.org/show_bug.cgi?id=1017892>)
* `[reserve-photon-structure]` ([examples](https://bugzilla.mozilla.org/buglist.cgi?list_id=14108939&status_whiteboard_type=substring&status_whiteboard=%5Breserve-photon-structure%5D&order=Bug%20Number&query_format=advanced))
* `[TCP]` (example: <https://bugzilla.mozilla.org/show_bug.cgi?id=920036>)
  + my guess: Tablet Contribution Program?

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/Whiteboard&oldid=1245932>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FWhiteboard "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/Whiteboard "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/Whiteboard&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/Whiteboard)
* [View source](/index.php?title=BMO/UserGuide/Whiteboard&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/Whiteboard&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/Whiteboard "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/Whiteboard "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/Whiteboard&oldid=1245932 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/Whiteboard&action=info "More information about this page")

* This page was last edited on 27 March 2023, at 15:08.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/Whiteboard&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_e1d9bf1a_20250119_122653.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1669355)
* [XML](/show_bug.cgi?ctype=xml&id=1669355)

Closed
[Bug 1669355](/show_bug.cgi?id=1669355)
(CVE-2020-26958)

Opened 4 years ago
Closed 4 years ago

# ServiceWorker intercepted channels don't run main fetch step 12 MIME type checks; nsHttpChannel logic should be moved into HttpBaseChannel

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

ServiceWorker intercepted channels don't run main fetch step 12 MIME type checks; nsHttpChannel logic should be moved into HttpBaseChannel

## Categories

### (Core :: Networking: HTTP, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking%3A%20HTTP#Networking%3A%20HTTP)

Networking: HTTP
▾

Core :: Networking: HTTP
For bugs in Mozilla's HTTP networking code. This component deals with HTTP specific issues like pipelining, keep-alive, HTTP proxies, 1.1 issues, redirects, authentication (basic), etc.

Examples of appropriate bugs: Problems with proxy authentication; HTTP redirects looping indefinitely, etc.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20HTTP&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20HTTP&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking%3A%20HTTP)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 81

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

84 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | [83+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=83%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) |
| firefox82 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox82&o1=equals&v1=wontfix) |
| firefox83 | [+](/buglist.cgi?f1=cf_tracking_firefox83&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=fixed) |
| firefox84 | [+](/buglist.cgi?f1=cf_tracking_firefox84&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 | 83+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox82 |  | wontfix |
| firefox83 | + | fixed |
| firefox84 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: moti, Assigned: asuth)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/75b1e0d00a677e73b24efe34917fa1e9?d=mm&size=40)  [asuth](/user_profile?user_id=151407)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/9e043b0cd5740e0202ecb8fc8bc88709?d=mm&size=40)  [moti](/user_profile?user_id=671512)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40)  [jesup](/user_profile?user_id=11539)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-moderate, Whiteboard: [necko-triaged][adv-main83+][adv-esr78.5+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-26958

[Keywords:](/describekeywords.cgi)

[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[necko-triaged][adv-main83+][adv-esr78.5+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [jcristau](/user_profile?user_id=580382) | [in-testsuite](#c31 "4 years ago") | ? |
| --- | --- | --- |
| [jcristau](/user_profile?user_id=580382) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [Bug 1669355 - Refactor MIME type warnings into base class. r=valentin](/attachment.cgi?id=9182268)  [4 years ago](#c9)  [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)   47 bytes, text/x-phabricator-request | pascalc : [approval-mozilla-beta+](#c29 "4 years ago") | [Details](/attachment.cgi?id=9182268&action=edit) | [Review](/attachment.cgi?id=9182268) |
| --- | --- | --- |
| [Bug 1669355 - Enhance MIME type validation tests with ServiceWorkers. r=ckerschb!](/attachment.cgi?id=9182269)  [4 years ago](#c10)  [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9182269&action=edit) | [Review](/attachment.cgi?id=9182269) |
| [Bug 1669355 - Refactor MIME type warnings into base class. r=valentin](/attachment.cgi?id=9185504)  [4 years ago](#c23)  [Yaron Tausky [:ytausky]](/user_profile?user_id=621888)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr78+](#c32 "4 years ago") | [Details](/attachment.cgi?id=9185504&action=edit) | [Review](/attachment.cgi?id=9185504) |
| [advisory.txt](/attachment.cgi?id=9187092)  [4 years ago](#c34)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   246 bytes, text/plain |  | [Details](/attachment.cgi?id=9187092&action=edit) |
| [advisory.txt](/attachment.cgi?id=9187253)  [4 years ago](#c35)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   332 bytes, text/plain |  | [Details](/attachment.cgi?id=9187253&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Moti Harmats](/user_profile?user_id=671512)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1669355#c0)• 4 years ago |
|  | |

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36

Steps to reproduce:

* Set up a simple web server that responds to /aaa.csv with a csv file (content-type: text/csv)
* Create an HTML page containing <script src='/aaa.csv'></script>
* FF will pop an error (in console) saying "The resource from '/aaa.csv' was blocked due to MIME type (“text/csv”) mismatch". (that's the desired behavior)

In order to bypass this restriction, set up a service worker "proxy" layer. It will serve the content from a local cache. FF will execute the fetched content (despite the content-type which isn't application/javascript) This effectively opens up a class of vulnerabilities, the most notable that comes to my mind is XSSI (Cross Site Script Inclusion).

HTML Code:

<html><body>

<script>navigator.serviceWorker.register('sw.js');</script>

<script src='/intercept'></script>

</body></html>

---

SW Code:

self.addEventListener('fetch', (event) => {

const url = '<http://localhost:8081/aaaafffa.csv?11>';

if(event.request.url.endsWith('/intercept'))

event.respondWith(

caches.match(event.request)

.then((response) => response ||

fetch(url, {

method : 'GET',

mode : 'no-cors',

credentials: 'include',

headers : {'Content-type':'application/x-www-form-urlencoded'}

})

)

.catch(() => caches.match('offline')),

);

});

Actual results:

JavaScript execution is possible - bypassing script inclusion security restrictions. (This allows a set of XSSI attacks)

Expected results:

JavaScript execution should be blocked due to mismatching MIME type

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1669355#c1)• 4 years ago |
|  | |

The tl;dr is that nsHttpChannel the security checks that should happen happen in nsHttpChannel and are contingent on the "destination" of the fetch being script-like. Because ServiceWorker interception is its own channel type that inherits from HttpBaseChannel, not nsHttpChannel, the intercepted subresource request is not subject to the check. However, if the intercepted FetchEvent's Request instance is passed to fetch() to actually go to the network, the destination will be propagated and the checks will be applied. So in the case of a naive pass-through ServiceWorker or naive caching ServiceWorker, the checks remain in effect.

:valentin (and cc :dragana), do you have thoughts on whether the check logic should be pushed into the HttpBaseChannel common class?

### Detailed Analysis

Based on my understanding of what's going on:

* In the normal window ScriptLoader situation described in the bug:
  + An HTTP channel is created with an internal load type of nsIContentPolicy::TYPE\_INTERNAL\_SCRIPT which corresponds to an external content policy of nsIContentPolicy::TYPE\_SCRIPT and also corresponds to a fetch destination of "script" which is `RequestDestination::Script` for our purposes.
  + nsHttpChannel is responsible for doing any appropriate MIME type checks. In both cases, the check is dependent on the destination of the script.
    1. The "nosniff" case, [fetch 3.4.1](https://fetch.spec.whatwg.org/#should-response-to-request-be-blocked-due-to-nosniff?) seems to be what's being reported here based on the [error message](https://searchfox.org/mozilla-central/rev/35245411b9e8a911fe3f5adb0632c3394f8b4ccb/dom/locales/en-US/chrome/security/security.properties#79) matching the [nsHttpChannel nosniff check logic](https://searchfox.org/mozilla-central/source/netwerk/protocol/http/nsHttpChannel.cpp#1590-1599). This depends on the server returning a header of `X-Content-Type-Options: nosniff`
    2. The other check is [fetch 2.9](https://fetch.spec.whatwg.org/#should-response-to-request-be-blocked-due-to-mime-type?) which is implemented by [EnsureMIMEOfScript](https://searchfox.org/mozilla-central/rev/35245411b9e8a911fe3f5adb0632c3394f8b4ccb/netwerk/protocol/http/nsHttpChannel.cpp#1615)
* In the Firefox ServiceWorker case:
  + The fetch being issued from the ServiceWorker has no explicit destination so it gets a destination of "" which doesn't induce the check.
  + A naive pass-through `fetch(event.request)` would have the destination and the check would be maintained.
* From a spec perspective:
  + We have the script-loader initiated fetch which will be intercepted in step 3.1 of [4.3 HTTP fetch](https://fetch.spec.whatwg.org/#http-fetch) by "handle fetch". This will have been called either indirectly by [4.2 Scheme Fetch](https://fetch.spec.whatwg.org/#scheme-fetch) or directly by [4.1 Main Fetch](https://fetch.spec.whatwg.org/#main-fetch) but either way it's in step 5.
  + Both the [nosniff](https://fetch.spec.whatwg.org/#should-response-to-request-be-blocked-due-to-nosniff?) and [due to its MIME type](https://fetch.spec.whatwg.org/#should-response-to-request-be-blocked-due-to-mime-type?) spec checks happen in step 12 of [4.1 Main fetch](https://fetch.spec.whatwg.org/#main-fetch) which gets to consume the results of step 5.

This behavior shouldn't have changed with the introduction of parent intercept.

Flags: needinfo?(valentin.gosu)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1669355#c2)• 4 years ago |
|  | |

(Moving this to necko for now, but this is very much at the intersection of ServiceWorkers and necko.)

Group: firefox-core-security → core-securityComponent: Untriaged → Networking: HTTPProduct: Firefox → Core

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1669355#a46710_159069)• 4 years ago |

Group: core-security → network-core-security

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1669355#c3)• 4 years ago |
|  | |

(In reply to Andrew Sutherland [:asuth] (he/him) from [comment #1](/show_bug.cgi?id=1669355#c1 "RESOLVED FIXED - ServiceWorker intercepted channels don't run main fetch step 12 MIME type checks; nsHttpChannel logic should be moved into HttpBaseChannel"))

> :valentin (and cc :dragana), do you have thoughts on whether the check logic should be pushed into the HttpBaseChannel common class?

I think that makes sense., and it's the thing we usually do when we discover some properties of nsHttpChannel also apply to other types of channels 🙂

Flags: needinfo?(valentin.gosu)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1669355#a64804_151407)• 4 years ago |

Summary: Script execution MIME type security restrictions can be bypassed → ServiceWorker intercepted channels don't run main fetch step 12 MIME type checks; nsHttpChannel logic should be moved into HttpBaseChannel

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1669355#c4)• 4 years ago |
|  | |

Also, thanks very much for filing this, Moti!

|  | [Moti Harmats](/user_profile?user_id=671512)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1669355#c5)• 4 years ago |
|  | |

Glad to help :),

Thanks for your quick response!

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1669355#a80019_151407)• 4 years ago |

Status: UNCONFIRMED → NEWEver confirmed: truePriority: -- → P1

|  | [Kershaw Chang [:kershaw]](/user_profile?user_id=505624) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1669355#c6)• 4 years ago |
|  | |

Jens, since this is a P1 bug, could you find someone to work on this?

Thanks.

Severity: -- → S2Flags: needinfo?(jstutte)Whiteboard: [necko-triaged]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1669355#c7)• 4 years ago |
|  | |

Christoph: what other DOM: Security type checks might get bypassed in this path?

Flags: needinfo?(ckerschb)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1669355#a247476_1689)• 4 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1669355#c8)• 4 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #7](/show_bug.cgi?id=1669355#c7 "RESOLVED FIXED - ServiceWorker intercepted channels don't run main fetch step 12 MIME type checks; nsHttpChannel logic should be moved into HttpBaseChannel"))

> Christoph: what other DOM: Security type checks might get bypassed in this path?

I did an anlysis of nsHTTPChannel and ultimately we should move the following security mechanisms from `nsHttpChannel::CallOnStartRequest` in the base channel implementation:

* `EnsureMIMEOfScript` including the `WarnWrongMIMEOfScript`, and
* `ProcessXCTO` which enfoces `x-content-type-options nosniff.

I am not entirely sure about the actual mime type sniffing code surrounded by `if (mLoadFlags & LOAD_CALL_CONTENT_SNIFFERS) {`, that probably needs to be evaluated again, but i could imagine that we want to move that as well.

Flags: needinfo?(ckerschb)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1669355#a670445_151407)• 4 years ago |

Assignee: nobody → bugmailStatus: NEW → ASSIGNED

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1669355#a734355_646284)• 4 years ago |

Flags: needinfo?(jstutte)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1669355#c9)• 4 years ago |
|  | |

Attached file
[Bug 1669355 - Refactor MIME type warnings into base class. r=valentin](attachment.cgi?id=9182268)
— [Details](attachment.cgi?id=9182268&action=edit)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1669355#c10)• 4 years ago |
|  | |

Attached file
[Bug 1669355 - Enhance MIME type validation tests with ServiceWorkers. r=ckerschb!](attachment.cgi?id=9182269)
— [Details](attachment.cgi?id=9182269&action=edit)

Depends on D93906

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1669355#c11)• 4 years ago |
|  | |

Per <https://firefox-source-docs.mozilla.org/bug-mgmt/processes/security-approval.html#on-requesting-sec-approval> and because this is sec-moderate, I am planning to land the fix (not the tests) after the soft freeze ends and to request beta uplift after letting it bake for a few days on nightly. If there's something else I should do, please let me know.

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1669355#c12)• 4 years ago |
|  | |

This had landed: <https://hg.mozilla.org/integration/autoland/rev/989a139969993f4f00ada9356a88b84b2e4d4682>

Backed out for causing mochitest failures in test\_fetch\_event.html:

<https://hg.mozilla.org/integration/autoland/rev/538e243f07cab5bd2f7db5efdda83d1b7ef6ae85>

Push range with failure selected: <https://treeherder.mozilla.org/#/jobs?repo=autoland&group_state=expanded&tochange=538e243f07cab5bd2f7db5efdda83d1b7ef6ae85&searchStr=mochitest%2Cplain&fromchange=3bbdaba33c6e1c04cbfd9170ad317e71f88c8535&selectedTaskRun=c_cCbSQVRKKD5kRFAEe3WQ.0>

Failure log: <https://treeherder.mozilla.org/logviewer.html#?job_id=319138341&repo=autoland>

[task 2020-10-20T13:35:20.244Z] 13:35:20 INFO - TEST-PASS | dom/serviceworkers/test/test\_fetch\_event.html | stylesheet load should be intercepted

[task 2020-10-20T13:35:20.267Z] 13:35:20 INFO - TEST-INFO | started process screentopng

[task 2020-10-20T13:35:20.384Z] 13:35:20 INFO - \*\*\* error running SJS at /builds/worker/workspace/build/tests/mochitest/tests/dom/serviceworkers/test/fetch/interrupt.sjs: 2152398850 on line NaN

[task 2020-10-20T13:35:20.710Z] 13:35:20 INFO - TEST-INFO | screentopng: exit 0

[task 2020-10-20T13:35:20.710Z] 13:35:20 INFO - TEST-UNEXPECTED-FAIL | dom/serviceworkers/test/test\_fetch\_event.html | worker load should be intercepted

[task 2020-10-20T13:35:20.710Z] 13:35:20 INFO - SimpleTest.ok@SimpleTest/SimpleTest.js:417:16

[task 2020-10-20T13:35:20.710Z] 13:35:20 INFO - testController/p</window.onmessage@dom/serviceworkers/test/test\_fetch\_event.html:41:13

Flags: needinfo?(bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1669355#a1879946_151407)• 4 years ago |

Flags: needinfo?(bugmail) → needinfo?(ytausky)

|  | [Yaron Tausky [:ytausky]](/user_profile?user_id=621888) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1669355#c13)• 4 years ago |
|  | |

The test that failed was actually incorrect: it had a service worker returning scripts without the `Content-Type` header, so with the patch it failed. Once I added the correct MIME type the test passes. Fixing the test in the same patch as the actual fix might tip off observers about this issue, so I'm not sure what the best course of action here would be. Maybe fix the test in a separate patch?

Flags: needinfo?(ytausky)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1669355#c14)• 4 years ago |
|  | |

Thanks for the quick investigation! Yes, that sounds good! If you want to file a bug for that and put the patch up, I can review that quickly. Setting needinfo because I find it more helpful with secbugs.

Flags: needinfo?(ytausky)

|  | [Yaron Tausky [:ytausky]](/user_profile?user_id=621888) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1669355#c15)• 4 years ago |
|  | |

I opened [bug 1673748](/show_bug.cgi?id=1673748 "RESOLVED FIXED - dom/serviceworkers/test/test_fetch_event.html makes service worker respond with a script without the correct Content-Type header") for the test fix.

Flags: needinfo?(ytausky)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1669355#c16)• 4 years ago |
|  | |

Thanks! I've approved it and hit the landing button for expediency. Aside: I somehow confused myself into thinking a WPT test had failed, not sure why. Glad it wasn't!

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1669355#c17)• 4 years ago |
|  | |

Would it be worth to add a test for the correct failure handling, too? Like the old test but with inverse expectation?

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1669355#a1936539_646284)• 4 years ago |

Flags: needinfo?(ytausky)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1669355#c18)• 4 years ago |
|  | |

(In reply to Jens Stutte [:jstutte] from [comment #17](/show_bug.cgi?id=1669355#c17 "RESOLVED FIXED - ServiceWorker intercepted channels don't run main fetch step 12 MIME type checks; nsHttpChannel logic should be moved into HttpBaseChannel"))

> Would it be worth to add a test for the correct failure handling, too? Like the old test but with inverse expectation?

You mean like we should add a test that scripts lacking the correct MIME type are rejected? That's covered by the enhanced test on this bug (that we can't land yet).

|  | [Yaron Tausky [:ytausky]](/user_profile?user_id=621888) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1669355#c19)• 4 years ago |
|  | |

Clearing ni since Andrew answered the question.

Flags: needinfo?(ytausky)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1669355#c20)• 4 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/6873589e0ede3c11bc48243be67c3d51e214873f>

<https://hg.mozilla.org/mozilla-central/rev/6873589e0ede>

Group: network-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-firefox84](/buglist.cgi?f1=cf_status_firefox84&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 84 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1669355#c21)• 4 years ago |
|  | |

Looks like this grafts cleanly to Beta as-landed. Does this also affect ESR78? If we wanted to uplift there, it'd need a bit of rebasing, however.

[status-firefox83](/buglist.cgi?f1=cf_status_firefox83&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=affected)Flags: needinfo?(bugmail)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1669355#c22)• 4 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #21](/show_bug.cgi?id=1669355#c21 "RESOLVED FIXED - ServiceWorker intercepted channels don't run main fetch step 12 MIME type checks; nsHttpChannel logic should be moved into HttpBaseChannel"))

> Looks like this grafts cleanly to Beta as-landed. Does this also affect ESR78? If we wanted to uplift there, it'd need a bit of rebasing, however.

This affects ESR78, yes. (If only we'd disabled ServiceWorkers on ESR again![1] ;) I think it would make sense to let it bake for a little more to make sure there's no obvious real-world fallout from this, but it does seem desirable to have the spec-correct behavior on ESR78. :ytausky, do you have cycles to do the rebase and check that the (un-landed) test from this bug passes with the rebased fix applied?

Any uplift will also need to take the fix from <https://phabricator.services.mozilla.com/D94902> for <https://bugzilla.mozilla.org/show_bug.cgi?id=1673748> which is where :ytausky fixed the test that was unhappy and caused this to get backed out the first time. (We landed that separately because otherwise it rather does draw a lot of attention to what's changing, despite this just being sec-med.)

1: This is a joke whose context is that we disabled ServiceWorkers on ESR repeatedly because

Flags: needinfo?(bugmail) → needinfo?(ytausky)

|  | [Yaron Tausky [:ytausky]](/user_profile?user_id=621888) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1669355#c23)• 4 years ago |
|  | |

Attached file
[Bug 1669355 - Refactor MIME type warnings into base class. r=valentin](attachment.cgi?id=9185504)
— [Details](attachment.cgi?id=9185504&action=edit)

|  | [Yaron Tausky [:ytausky]](/user_profile?user_id=621888) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1669355#c24)• 4 years ago |
|  | |

I rebased the patch. How do we handle the test fix from [bug 1673748](/show_bug.cgi?id=1673748 "RESOLVED FIXED - dom/serviceworkers/test/test_fetch_event.html makes service worker respond with a script without the correct Content-Type header")? Should I request an uplift on that bug?

Flags: needinfo?(ytausky)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1669355#c25)• 4 years ago |
|  | |

The patch landed in nightly and beta is affected.

:asuth, is this bug important enough to require an uplift?

If not please set `status_beta` to `wontfix`.

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#uplift_beta.py).

Flags: needinfo?(bugmail)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1669355#c26)• 4 years ago |
|  | |

We can take the test-only change as a ride-along. Note that we're building our final beta tomorrow (Thursday), so we need approval requests ASAP here.

|  | [Yaron Tausky [:ytausky]](/user_profile?user_id=621888) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1669355#c27)• 4 years ago |
|  | |

Comment on [attachment 9185504](/attachment.cgi?id=9185504 "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin") [[details]](/attachment.cgi?id=9185504&action=edit "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin")

[Bug 1669355](/show_bug.cgi?id=1669355 "RESOLVED FIXED - ServiceWorker intercepted channels don't run main fetch step 12 MIME type checks; nsHttpChannel logic should be moved into HttpBaseChannel") - Refactor MIME type warnings into base class. r=valentin

### Beta/Release Uplift Approval Request

* **User impact if declined**: This is a sec-moderate bug -- I'm not sure about exploitability.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: [Bug 1673748](/show_bug.cgi?id=1673748 "RESOLVED FIXED - dom/serviceworkers/test/test_fetch_event.html makes service worker respond with a script without the correct Content-Type header")
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This change adds MIME checks to intercepted channels, it seems like a low risk thing.
* **String changes made/needed**:
[Attachment #9185504](/attachment.cgi?id=9185504&action=edit "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin") -
Flags: approval-mozilla-beta?

|  | [Yaron Tausky [:ytausky]](/user_profile?user_id=621888) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1669355#a2642995_621888)• 4 years ago |

[Attachment #9185504](/attachment.cgi?id=9185504&action=edit "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin") -
Flags: approval-mozilla-beta?

|  | [Yaron Tausky [:ytausky]](/user_profile?user_id=621888) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1669355#c28)• 4 years ago |
|  | |

Comment on [attachment 9182268](/attachment.cgi?id=9182268 "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin") [[details]](/attachment.cgi?id=9182268&action=edit "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin")

[Bug 1669355](/show_bug.cgi?id=1669355 "RESOLVED FIXED - ServiceWorker intercepted channels don't run main fetch step 12 MIME type checks; nsHttpChannel logic should be moved into HttpBaseChannel") - Refactor MIME type warnings into base class. r=valentin

### Beta/Release Uplift Approval Request

* **User impact if declined**: This is a sec-moderate bug -- I'm not sure about exploitability.
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: [Bug 1673748](/show_bug.cgi?id=1673748 "RESOLVED FIXED - dom/serviceworkers/test/test_fetch_event.html makes service worker respond with a script without the correct Content-Type header")
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This change adds MIME checks to intercepted channels, it seems like a low risk thing.
* **String changes made/needed**:
[Attachment #9182268](/attachment.cgi?id=9182268&action=edit "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin") -
Flags: approval-mozilla-beta?

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1669355#c29)• 4 years ago |
|  | |

Comment on [attachment 9182268](/attachment.cgi?id=9182268 "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin") [[details]](/attachment.cgi?id=9182268&action=edit "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin")

[Bug 1669355](/show_bug.cgi?id=1669355 "RESOLVED FIXED - ServiceWorker intercepted channels don't run main fetch step 12 MIME type checks; nsHttpChannel logic should be moved into HttpBaseChannel") - Refactor MIME type warnings into base class. r=valentin

Approved for our last beta, are you going to request an uplift to ESR as well?

[Attachment #9182268](/attachment.cgi?id=9182268&action=edit "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Yaron Tausky [:ytausky]](/user_profile?user_id=621888) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1669355#c30)• 4 years ago |
|  | |

Comment on [attachment 9185504](/attachment.cgi?id=9185504 "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin") [[details]](/attachment.cgi?id=9185504&action=edit "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin")

[Bug 1669355](/show_bug.cgi?id=1669355 "RESOLVED FIXED - ServiceWorker intercepted channels don't run main fetch step 12 MIME type checks; nsHttpChannel logic should be moved into HttpBaseChannel") - Refactor MIME type warnings into base class. r=valentin

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This is a relatively simple fix.
* **User impact if declined**: I'm not sure about its exploitability.
* **Fix Landed on Version**: 84
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: This change adds MIME checks to intercepted channels, it seems like a low risk thing.
* **String or UUID changes made by this patch**:
[Attachment #9185504](/attachment.cgi?id=9185504&action=edit "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin") -
Flags: approval-mozilla-esr78?

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1669355#c31)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/5f1dc921c98f>

[status-firefox82](/buglist.cgi?f1=cf_status_firefox82&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox82&o1=equals&v1=wontfix)
[status-firefox83](/buglist.cgi?f1=cf_status_firefox83&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=fixed)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)Flags: in-testsuite?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1669355#c32)• 4 years ago |
|  | |

Comment on [attachment 9185504](/attachment.cgi?id=9185504 "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin") [[details]](/attachment.cgi?id=9185504&action=edit "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin")

[Bug 1669355](/show_bug.cgi?id=1669355 "RESOLVED FIXED - ServiceWorker intercepted channels don't run main fetch step 12 MIME type checks; nsHttpChannel logic should be moved into HttpBaseChannel") - Refactor MIME type warnings into base class. r=valentin

Approved for 78.5esr.

[Attachment #9185504](/attachment.cgi?id=9185504&action=edit "Bug 1669355 - Refactor MIME type warnings into base class. r=valentin") -
Flags: approval-mozilla-esr78? → approval-mozilla-esr78+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1669355#c33)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr78/rev/72378c07b64e>

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)
[tracking-firefox83](/buglist.cgi?f1=cf_tracking_firefox83&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox83&o1=equals&v1=%2B)
[tracking-firefox84](/buglist.cgi?f1=cf_tracking_firefox84&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox84&o1=equals&v1=%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [83+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=83%2B)

|  | [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1669355#a3014213_151407)• 4 years ago |

Flags: needinfo?(bugmail)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1669355#a3018433_578488)• 4 years ago |

Whiteboard: [necko-triaged] → [necko-triaged][adv-main83+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1669355#c34)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9187092) (obsolete)
— [Details](attachment.cgi?id=9187092&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1669355#c35)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9187253)
— [Details](attachment.cgi?id=9187253&action=edit)

[Attachment #9187092](/attachment.cgi?id=9187092&action=edit "advisory.txt") -
Attachment is obsolete: true

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1669355#a3352476_578488)• 4 years ago |

Whiteboard: [necko-triaged][adv-main83+] → [necko-triaged][adv-main83+][adv-esr78.5+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1669355#a3614631_578488)• 4 years ago |

Alias: CVE-2020-26958

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1669355#a15656753_1689)• 4 years ago |

Group: core-security-release

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1669355#a110770884_600971)• 9 months ago |

[Attachment #9182269](/attachment.cgi?id=9182269&action=edit "Bug 1669355 - Enhance MIME type validation tests with ServiceWorkers. r=ckerschb!") -
Attachment description: Bug 1669355 - Enhance MIME type validation tests with ServiceWorkers. r=ckerschb → Bug 1669355 - Enhance MIME type validation tests with ServiceWorkers. r=ckerschb!

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1669355#c36)• 9 months ago |
|  | |

Pushed by bugmail@asutherland.org:
<https://hg.mozilla.org/integration/autoland/rev/d151edecc032>
Enhance MIME type validation tests with ServiceWorkers. r=ckerschb

|  | [tszentpeteri](/user_profile?user_id=744499) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1669355#c37)• 9 months ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/d151edecc032>

You need to [log in](/show_bug.cgi?id=1669355&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Andrew Sutherland [:asuth] (he/him)](/user_profile?user_id=151407)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_73f8d6fa_20250119_140517.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.mozilla.org_436551aa_20250119_122654.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-50

## Security Vulnerabilities fixed in Firefox 83

Announced
November 17, 2020
Impact
high
Products
Firefox
Fixed in

* Firefox 83

#### [#CVE-2020-26951: Parsing mismatches could confuse and bypass security sanitizer for chrome privileged code](#CVE-2020-26951)

Reporter
Irvan Kurniawan (@sourc7)
Impact
high
##### Description

A parsing and event loading mismatch in Firefox's SVG code could have allowed load events to fire, even after sanitization. An attacker already capable of exploiting an XSS vulnerability in privileged internal pages could have used this attack to bypass our built-in sanitizer.

##### References

* [Bug 1667113](https://bugzilla.mozilla.org/show_bug.cgi?id=1667113)

#### [#CVE-2020-26952: Out of memory handling of JITed, inlined functions could lead to a memory corruption](#CVE-2020-26952)

Reporter
Gary Kwong
Impact
high
##### Description

Incorrect bookkeeping of functions inlined during JIT compilation could have led to memory corruption and a potentially exploitable crash when handling out-of-memory errors.

##### References

* [Bug 1667685](https://bugzilla.mozilla.org/show_bug.cgi?id=1667685)

#### [#CVE-2020-16012: Variable time processing of cross-origin images during drawImage calls](#CVE-2020-16012)

Reporter
Aleksejs Popovs
Impact
moderate
##### Description

When drawing a transparent image on top of an unknown cross-origin image, the Skia library `drawImage` function took a variable amount of time depending on the content of the underlying image. This resulted in potential cross-origin information exposure of image content through timing side-channel attacks.

##### References

* [Bug 1642028](https://bugzilla.mozilla.org/show_bug.cgi?id=1642028)

#### [#CVE-2020-26953: Fullscreen could be enabled without displaying the security UI](#CVE-2020-26953)

Reporter
Abdulrahman Alqabandi of Microsoft Browser Vulnerability Research
Impact
moderate
##### Description

It was possible to cause the browser to enter fullscreen mode without displaying the security UI; thus making it possible to attempt a phishing attack or otherwise confuse the user.

##### References

* [Bug 1656741](https://bugzilla.mozilla.org/show_bug.cgi?id=1656741)

#### [#CVE-2020-26954: Local spoofing of web manifests for arbitrary pages in Firefox for Android](#CVE-2020-26954)

Reporter
Muneaki Nishimura
Impact
moderate
##### Description

When accepting a malicious intent from other installed apps, Firefox for Android accepted manifests from arbitrary file paths and allowed declaring webapp manifests for other origins. This could be used to gain fullscreen access for UI spoofing and could also lead to cross-origin attacks on targeted websites.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1657026](https://bugzilla.mozilla.org/show_bug.cgi?id=1657026)

#### [#CVE-2020-26955: Cookies set during file downloads are shared between normal and Private Browsing Mode in Firefox for Android](#CVE-2020-26955)

Reporter
Muneaki Nishimura
Impact
moderate
##### Description

When a user downloaded a file in Firefox for Android, if a cookie is set, it would have been re-sent during a subsequent file download operation on the same domain, regardless of whether the original and subsequent request were in private and non-private browsing modes.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1663261](https://bugzilla.mozilla.org/show_bug.cgi?id=1663261)

#### [#CVE-2020-26956: XSS through paste (manual and clipboard API)](#CVE-2020-26956)

Reporter
Irvan Kurniawan (@sourc7)
Impact
moderate
##### Description

In some cases, removing HTML elements during sanitization would keep existing SVG event handlers and therefore lead to XSS.

##### References

* [Bug 1666300](https://bugzilla.mozilla.org/show_bug.cgi?id=1666300)

#### [#CVE-2020-26957: OneCRL was not working in Firefox for Android](#CVE-2020-26957)

Reporter
Kevin Brosnan
Impact
moderate
##### Description

OneCRL was non-functional in the new Firefox for Android due to a missing service initialization. This could result in a failure to enforce some certificate revocations.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1667179](https://bugzilla.mozilla.org/show_bug.cgi?id=1667179)

#### [#CVE-2020-26958: Requests intercepted through ServiceWorkers lacked MIME type restrictions](#CVE-2020-26958)

Reporter
Moti Harmats
Impact
moderate
##### Description

Firefox did not block execution of scripts with incorrect MIME types when the response was intercepted and cached through a ServiceWorker. This could lead to a cross-site script inclusion vulnerability, or a Content Security Policy bypass.

##### References

* [Bug 1669355](https://bugzilla.mozilla.org/show_bug.cgi?id=1669355)

#### [#CVE-2020-26959: Use-after-free in WebRequestService](#CVE-2020-26959)

Reporter
Bharadwaj Machiraju
Impact
moderate
##### Description

During browser shutdown, reference decrementing could have occured on a previously freed object, resulting in a use-after-free, memory corruption, and a potentially exploitable crash.

##### References

* [Bug 1669466](https://bugzilla.mozilla.org/show_bug.cgi?id=1669466)

#### [#CVE-2020-26960: Potential use-after-free in uses of nsTArray](#CVE-2020-26960)

Reporter
Zijie Zhao
Impact
moderate
##### Description

If the `Compact()` method was called on an nsTArray, the array could have been reallocated without updating other pointers, leading to a potential use-after-free and exploitable crash.

##### References

* [Bug 1670358](https://bugzilla.mozilla.org/show_bug.cgi?id=1670358)

#### [#CVE-2020-15999: Heap buffer overflow in freetype](#CVE-2020-15999)

Reporter
Sergei Glazunov of Google Project Zero
Impact
moderate
##### Description

In Freetype, if PNG images were embedded into fonts, the `Load_SBit_Png` function contained an integer overflow that led to a heap buffer overflow, memory corruption, and an exploitable crash.
*Note: While Project Zero did discover instances of this vulnerability being exploited in the wild against Chrome, in Firefox this vulnerability is only triggerable if a rarely-used, hidden preference is toggled, and only affected Linux and Android operating systems. Other operating systems are unaffected; and Linux and Android are unaffected in the default configuration.*

##### References

* [Bug 1672223](https://bugzilla.mozilla.org/show_bug.cgi?id=1672223)

#### [#CVE-2020-26961: DoH did not filter IPv4 mapped IP Addresses](#CVE-2020-26961)

Reporter
Gabriel Corona
Impact
moderate
##### Description

When DNS over HTTPS is in use, it intentionally filters RFC1918 and related IP ranges from the responses as these do not make sense coming from a DoH resolver. However when an IPv4 address was mapped through IPv6, these addresses were erroneously let through, leading to a potential DNS Rebinding attack.

##### References

* [Bug 1672528](https://bugzilla.mozilla.org/show_bug.cgi?id=1672528)

#### [#CVE-2020-26962: Cross-origin iframes supported login autofill](#CVE-2020-26962)

Reporter
Paul Stone
Impact
low
##### Description

Cross-origin iframes that contained a login form could have been recognized by the login autofill service, and populated. This could have been used in clickjacking attacks, as well as be read across partitions in dynamic first party isolation.

##### References

* [Bug 610997](https://bugzilla.mozilla.org/show_bug.cgi?id=610997)

#### [#CVE-2020-26963: History and Location interfaces could have been used to hang the browser](#CVE-2020-26963)

Reporter
Sachin Raste
Impact
low
##### Description

Repeated calls to the history and location interfaces could have been used to hang the browser. This was addressed by introducing rate-limiting to these API calls.

##### References

* [Bug 1314912](https://bugzilla.mozilla.org/show_bug.cgi?id=1314912)

#### [#CVE-2020-26964: Firefox for Android's Remote Debugging via USB could have been abused by untrusted apps on older versions of Android](#CVE-2020-26964)

Reporter
Muneaki Nishimura
Impact
low
##### Description

If the Remote Debugging via USB feature was enabled in Firefox for Android on an Android version prior to Android 6.0, untrusted apps could have connected to the feature and operated with the privileges of the browser to read and interact with web content. The feature was implemented as a unix domain socket, protected by the Android SELinux policy; however, SELinux was not enforced for versions prior to 6.0. This was fixed by removing the Remote Debugging via USB feature from affected devices.
*Note: This issue only affected Firefox for Android. Other operating systems are unaffected.*

##### References

* [Bug 1658865](https://bugzilla.mozilla.org/show_bug.cgi?id=1658865)

#### [#CVE-2020-26965: Software keyboards may have remembered typed passwords](#CVE-2020-26965)

Reporter
Makoto Kato
Impact
low
##### Description

Some websites have a feature "Show Password" where clicking a button will change a password field into a textbook field, revealing the typed password. If, when using a software keyboard that remembers user input, a user typed their password and used that feature, the type of the password field was changed, resulting in a keyboard layout change and the possibility for the software keyboard to remember the typed password.

##### References

* [Bug 1661617](https://bugzilla.mozilla.org/show_bug.cgi?id=1661617)

#### [#CVE-2020-26966: Single-word search queries were also broadcast to local network](#CVE-2020-26966)

Reporter
tiebuchen
Impact
low
##### Description

Searching for a single word from the address bar caused an mDNS request to be sent on the local network searching for a hostname consisting of that string; resulting in an information leak.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1663571](https://bugzilla.mozilla.org/show_bug.cgi?id=1663571)

#### [#CVE-2020-26967: Mutation Observers could break or confuse Firefox Screenshots feature](#CVE-2020-26967)

Reporter
Kaizer Soze
Impact
low
##### Description

When listening for page changes with a Mutation Observer, a malicious web page could confuse Firefox Screenshots into interacting with elements other than those that it injected into the page. This would lead to internal errors and unexpected behavior in the Screenshots code.

##### References

* [Bug 1665820](https://bugzilla.mozilla.org/show_bug.cgi?id=1665820)

#### [#CVE-2020-26968: Memory safety bugs fixed in Firefox 83 and Firefox ESR 78.5](#CVE-2020-26968)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Randell Jesup, Christian Holler, Jason Kratzer, Byron Campen, and Steve Fink reported memory safety bugs present in Firefox 82 and Firefox ESR 78.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 83 and Firefox ESR 78.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1551615%2C1607762%2C1656697%2C1657739%2C1660236%2C1667912%2C1671479%2C1671923)

#### [#CVE-2020-26969: Memory safety bugs fixed in Firefox 83](#CVE-2020-26969)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Tyson Smith, Aaron Klotz, David Major and Jason Kratzer reported memory safety bugs present in Firefox 82. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 83](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1623920%2C1651705%2C1667872%2C1668876)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_12b120db_20250119_122654.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-51

## Security Vulnerabilities fixed in Firefox ESR 78.5

Announced
November 17, 2020
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 78.5

#### [#CVE-2020-26951: Parsing mismatches could confuse and bypass security sanitizer for chrome privileged code](#CVE-2020-26951)

Reporter
Irvan Kurniawan (@sourc7)
Impact
high
##### Description

A parsing and event loading mismatch in Firefox's SVG code could have allowed load events to fire, even after sanitization. An attacker already capable of exploiting an XSS vulnerability in privileged internal pages could have used this attack to bypass our built-in sanitizer.

##### References

* [Bug 1667113](https://bugzilla.mozilla.org/show_bug.cgi?id=1667113)

#### [#CVE-2020-16012: Variable time processing of cross-origin images during drawImage calls](#CVE-2020-16012)

Reporter
Aleksejs Popovs
Impact
moderate
##### Description

When drawing a transparent image on top of an unknown cross-origin image, the Skia library `drawImage` function took a variable amount of time depending on the content of the underlying image. This resulted in potential cross-origin information exposure of image content through timing side-channel attacks.

##### References

* [Bug 1642028](https://bugzilla.mozilla.org/show_bug.cgi?id=1642028)

#### [#CVE-2020-26953: Fullscreen could be enabled without displaying the security UI](#CVE-2020-26953)

Reporter
Abdulrahman Alqabandi of Microsoft Browser Vulnerability Research
Impact
moderate
##### Description

It was possible to cause the browser to enter fullscreen mode without displaying the security UI; thus making it possible to attempt a phishing attack or otherwise confuse the user.

##### References

* [Bug 1656741](https://bugzilla.mozilla.org/show_bug.cgi?id=1656741)

#### [#CVE-2020-26956: XSS through paste (manual and clipboard API)](#CVE-2020-26956)

Reporter
Irvan Kurniawan (@sourc7)
Impact
moderate
##### Description

In some cases, removing HTML elements during sanitization would keep existing SVG event handlers and therefore lead to XSS.

##### References

* [Bug 1666300](https://bugzilla.mozilla.org/show_bug.cgi?id=1666300)

#### [#CVE-2020-26958: Requests intercepted through ServiceWorkers lacked MIME type restrictions](#CVE-2020-26958)

Reporter
Moti Harmats
Impact
moderate
##### Description

Firefox did not block execution of scripts with incorrect MIME types when the response was intercepted and cached through a ServiceWorker. This could lead to a cross-site script inclusion vulnerability, or a Content Security Policy bypass.

##### References

* [Bug 1669355](https://bugzilla.mozilla.org/show_bug.cgi?id=1669355)

#### [#CVE-2020-26959: Use-after-free in WebRequestService](#CVE-2020-26959)

Reporter
Bharadwaj Machiraju
Impact
moderate
##### Description

During browser shutdown, reference decrementing could have occured on a previously freed object, resulting in a use-after-free, memory corruption, and a potentially exploitable crash.

##### References

* [Bug 1669466](https://bugzilla.mozilla.org/show_bug.cgi?id=1669466)

#### [#CVE-2020-26960: Potential use-after-free in uses of nsTArray](#CVE-2020-26960)

Reporter
Zijie Zhao
Impact
moderate
##### Description

If the `Compact()` method was called on an nsTArray, the array could have been reallocated without updating other pointers, leading to a potential use-after-free and exploitable crash.

##### References

* [Bug 1670358](https://bugzilla.mozilla.org/show_bug.cgi?id=1670358)

#### [#CVE-2020-15999: Heap buffer overflow in freetype](#CVE-2020-15999)

Reporter
Sergei Glazunov of Google Project Zero
Impact
moderate
##### Description

In Freetype, if PNG images were embedded into fonts, the `Load_SBit_Png` function contained an integer overflow that led to a heap buffer overflow, memory corruption, and an exploitable crash.
*Note: While Project Zero did discover instances of this vulnerability being exploited in the wild against Chrome, in Firefox this vulnerability is only triggerable if a rarely-used, hidden preference is toggled, and only affected Linux and Android operating systems. Other operating systems are unaffected; and Linux and Android are unaffected in the default configuration.*

##### References

* [Bug 1672223](https://bugzilla.mozilla.org/show_bug.cgi?id=1672223)

#### [#CVE-2020-26961: DoH did not filter IPv4 mapped IP Addresses](#CVE-2020-26961)

Reporter
Gabriel Corona
Impact
moderate
##### Description

When DNS over HTTPS is in use, it intentionally filters RFC1918 and related IP ranges from the responses as these do not make sense coming from a DoH resolver. However when an IPv4 address was mapped through IPv6, these addresses were erroneously let through, leading to a potential DNS Rebinding attack.

##### References

* [Bug 1672528](https://bugzilla.mozilla.org/show_bug.cgi?id=1672528)

#### [#CVE-2020-26965: Software keyboards may have remembered typed passwords](#CVE-2020-26965)

Reporter
Makoto Kato
Impact
low
##### Description

Some websites have a feature "Show Password" where clicking a button will change a password field into a textbook field, revealing the typed password. If, when using a software keyboard that remembers user input, a user typed their password and used that feature, the type of the password field was changed, resulting in a keyboard layout change and the possibility for the software keyboard to remember the typed password.

##### References

* [Bug 1661617](https://bugzilla.mozilla.org/show_bug.cgi?id=1661617)

#### [#CVE-2020-26966: Single-word search queries were also broadcast to local network](#CVE-2020-26966)

Reporter
tiebuchen
Impact
low
##### Description

Searching for a single word from the address bar caused an mDNS request to be sent on the local network searching for a hostname consisting of that string; resulting in an information leak.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1663571](https://bugzilla.mozilla.org/show_bug.cgi?id=1663571)

#### [#CVE-2020-26968: Memory safety bugs fixed in Firefox 83 and Firefox ESR 78.5](#CVE-2020-26968)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Steve Fink, Jason Kratzer, Randell Jesup, Christian Holler, and Byron Campen reported memory safety bugs present in Firefox 82 and Firefox ESR 78.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 83 and Firefox ESR 78.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1551615%2C1607762%2C1656697%2C1657739%2C1660236%2C1667912%2C1671479%2C1671923)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_4b725b9c_20250119_122655.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-52

## Security Vulnerabilities fixed in Thunderbird 78.5

Announced
November 17, 2020
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 78.5

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2020-26951: Parsing mismatches could confuse and bypass security sanitizer for chrome privileged code](#CVE-2020-26951)

Reporter
Irvan Kurniawan (@sourc7)
Impact
high
##### Description

A parsing and event loading mismatch in Thunderbird's SVG code could have allowed load events to fire, even after sanitization. An attacker already capable of exploiting an XSS vulnerability in privileged internal pages could have used this attack to bypass our built-in sanitizer.

##### References

* [Bug 1667113](https://bugzilla.mozilla.org/show_bug.cgi?id=1667113)

#### [#CVE-2020-16012: Variable time processing of cross-origin images during drawImage calls](#CVE-2020-16012)

Reporter
Aleksejs Popovs
Impact
moderate
##### Description

When drawing a transparent image on top of an unknown cross-origin image, the Skia library `drawImage` function took a variable amount of time depending on the content of the underlying image. This resulted in potential cross-origin information exposure of image content through timing side-channel attacks.

##### References

* [Bug 1642028](https://bugzilla.mozilla.org/show_bug.cgi?id=1642028)

#### [#CVE-2020-26953: Fullscreen could be enabled without displaying the security UI](#CVE-2020-26953)

Reporter
Abdulrahman Alqabandi of Microsoft Browser Vulnerability Research
Impact
moderate
##### Description

It was possible to cause the browser to enter fullscreen mode without displaying the security UI; thus making it possible to attempt a phishing attack or otherwise confuse the user.

##### References

* [Bug 1656741](https://bugzilla.mozilla.org/show_bug.cgi?id=1656741)

#### [#CVE-2020-26956: XSS through paste (manual and clipboard API)](#CVE-2020-26956)

Reporter
Irvan Kurniawan (@sourc7)
Impact
moderate
##### Description

In some cases, removing HTML elements during sanitization would keep existing SVG event handlers and therefore lead to XSS.

##### References

* [Bug 1666300](https://bugzilla.mozilla.org/show_bug.cgi?id=1666300)

#### [#CVE-2020-26958: Requests intercepted through ServiceWorkers lacked MIME type restrictions](#CVE-2020-26958)

Reporter
Moti Harmats
Impact
moderate
##### Description

Thunderbird did not block execution of scripts with incorrect MIME types when the response was intercepted and cached through a ServiceWorker. This could lead to a cross-site script inclusion vulnerability, or a Content Security Policy bypass.

##### References

* [Bug 1669355](https://bugzilla.mozilla.org/show_bug.cgi?id=1669355)

#### [#CVE-2020-26959: Use-after-free in WebRequestService](#CVE-2020-26959)

Reporter
Bharadwaj Machiraju
Impact
moderate
##### Description

During browser shutdown, reference decrementing could have occured on a previously freed object, resulting in a use-after-free, memory corruption, and a potentially exploitable crash.

##### References

* [Bug 1669466](https://bugzilla.mozilla.org/show_bug.cgi?id=1669466)

#### [#CVE-2020-26960: Potential use-after-free in uses of nsTArray](#CVE-2020-26960)

Reporter
Zijie Zhao
Impact
moderate
##### Description

If the `Compact()` method was called on an nsTArray, the array could have been reallocated without updating other pointers, leading to a potential use-after-free and exploitable crash.

##### References

* [Bug 1670358](https://bugzilla.mozilla.org/show_bug.cgi?id=1670358)

#### [#CVE-2020-15999: Heap buffer overflow in freetype](#CVE-2020-15999)

Reporter
Sergei Glazunov of Google Project Zero
Impact
moderate
##### Description

In Freetype, if PNG images were embedded into fonts, the `Load_SBit_Png` function contained an integer overflow that led to a heap buffer overflow, memory corruption, and an exploitable crash.
*Note: While Project Zero did discover instances of this vulnerability being exploited in the wild against Chrome, in Thunderbird this vulnerability is only triggerable if a rarely-used, hidden preference is toggled, and only affected Linux and Android operating systems. Other operating systems are unaffected; and Linux and Android are unaffected in the default configuration.*

##### References

* [Bug 1672223](https://bugzilla.mozilla.org/show_bug.cgi?id=1672223)

#### [#CVE-2020-26961: DoH did not filter IPv4 mapped IP Addresses](#CVE-2020-26961)

Reporter
Gabriel Corona
Impact
moderate
##### Description

When DNS over HTTPS is in use, it intentionally filters RFC1918 and related IP ranges from the responses as these do not make sense coming from a DoH resolver. However when an IPv4 address was mapped through IPv6, these addresses were erroneously let through, leading to a potential DNS Rebinding attack.

##### References

* [Bug 1672528](https://bugzilla.mozilla.org/show_bug.cgi?id=1672528)

#### [#CVE-2020-26965: Software keyboards may have remembered typed passwords](#CVE-2020-26965)

Reporter
Makoto Kato
Impact
low
##### Description

Some websites have a feature "Show Password" where clicking a button will change a password field into a textbook field, revealing the typed password. If, when using a software keyboard that remembers user input, a user typed their password and used that feature, the type of the password field was changed, resulting in a keyboard layout change and the possibility for the software keyboard to remember the typed password.

##### References

* [Bug 1661617](https://bugzilla.mozilla.org/show_bug.cgi?id=1661617)

#### [#CVE-2020-26966: Single-word search queries were also broadcast to local network](#CVE-2020-26966)

Reporter
tiebuchen
Impact
low
##### Description

Searching for a single word from the address bar caused an mDNS request to be sent on the local network searching for a hostname consisting of that string; resulting in an information leak.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1663571](https://bugzilla.mozilla.org/show_bug.cgi?id=1663571)

#### [#CVE-2020-26968: Memory safety bugs fixed in Thunderbird 78.5](#CVE-2020-26968)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Steve Fink, Jason Kratzer, Randell Jesup, Christian Holler, and Byron Campen reported memory safety bugs present in Thunderbird 78.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 78.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1551615%2C1607762%2C1656697%2C1657739%2C1660236%2C1667912%2C1671479%2C1671923)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_b6cdd711_20250119_140523.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1666300)
* [XML](/show_bug.cgi?ctype=xml&id=1666300)

Closed
[Bug 1666300](/show_bug.cgi?id=1666300)
(CVE-2020-26956)

Opened 4 years ago
Closed 4 years ago

# XSS via paste and Clipboard API and SVG + image onerror handler

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

XSS via paste and Clipboard API and SVG + image onerror handler

## Categories

### (Core :: DOM: Editor, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Editor#DOM%3A%20Editor)

DOM: Editor
▾

Core :: DOM: Editor
For bugs with editing text on web pages. Related HTML features are <input type=text>, <textarea>, contenteditable, and the designMode API.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Editor&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Editor&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Editor)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

84 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr78 | [83+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=83%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) |
| firefox80 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=wontfix) |
| firefox81 | [-](/buglist.cgi?f1=cf_tracking_firefox81&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=wontfix) |
| firefox82 | [-](/buglist.cgi?f1=cf_tracking_firefox82&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox82&o1=equals&v1=wontfix) |
| firefox83 | [+](/buglist.cgi?f1=cf_tracking_firefox83&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=fixed) |
| firefox84 | [+](/buglist.cgi?f1=cf_tracking_firefox84&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr78 | 83+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox80 |  | wontfix |
| firefox81 | - | wontfix |
| firefox82 | - | wontfix |
| firefox83 | + | fixed |
| firefox84 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sourc7, Assigned: hsivonen)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/0030426a5e04e85c33fe02480bc4ca81?d=mm&size=40)  [hsivonen](/user_profile?user_id=5490)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1f6e740893c5a41879a277dd0b0a0c4a?d=mm&size=40)  [sourc7](/user_profile?user_id=537720)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1666777](/show_bug.cgi?id=1666777 "VERIFIED DUPLICATE - HTML Sanitizer Bypass with combined Image + onerror and STYLE element"), [CVE-2020-26951](/show_bug.cgi?id=1667113 "VERIFIED FIXED - mXSS payload (combined svg, style, title element) lead to HTML Sanitizer Bypass and XSS via Clipboard API (paste)")

Dependency [tree](/showdependencytree.cgi?id=1666300&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1666300)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1682950](/show_bug.cgi?id=1682950 "RESOLVED FIXED - Permafailing tier 2 editor/libeditor/tests/test_sanitizer_on_paste.html | Node name should be svg - got \"#text\", expected \"svg\"")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1666132](/show_bug.cgi?id=1666132 "VERIFIED DUPLICATE - Mozilla Firefox Universal XSS with Clipboard API"), [1666893](/show_bug.cgi?id=1666893 "RESOLVED DUPLICATE - Event handler attributes on <img>/<svg> nodes dropped by the HTML sanitizer can still run"), [1666777](/show_bug.cgi?id=1666777 "VERIFIED DUPLICATE - HTML Sanitizer Bypass with combined Image + onerror and STYLE element"), [CVE-2020-26951](/show_bug.cgi?id=1667113 "VERIFIED FIXED - mXSS payload (combined svg, style, title element) lead to HTML Sanitizer Bypass and XSS via Clipboard API (paste)"), [1670913](/show_bug.cgi?id=1670913 "RESOLVED FIXED - DOM Sanitizer API should parse into a throw-away \"loaded as data\" document")

## Details

### (Keywords: reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main83+][adv-esr78.5+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-26956

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main83+][adv-esr78.5+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a3725547_1689 "4 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [jcristau](/user_profile?user_id=580382) | [in-testsuite](#a7489566_580382 "4 years ago") | + |
| --- | --- | --- |
| [jcristau](/user_profile?user_id=580382) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [0447f4d26c48bd8d0526dce173f57b3ac5235b7b.html](/attachment.cgi?id=9176926)  [4 years ago](#c2)  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)   2.77 KB, text/html |  | [Details](/attachment.cgi?id=9176926&action=edit) |
| --- | --- | --- |
| [Bug 1666300 part 1 - Remove attributes from descendants when setting sanitized style.](/attachment.cgi?id=9181014)  [4 years ago](#c10)  [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)   47 bytes, text/x-phabricator-request | tjr : [approval-mozilla-beta+](#c18 "4 years ago")  tjr : [approval-mozilla-esr78+](#c18 "4 years ago")  tjr : [sec-approval+](#c18 "4 years ago") | [Details](/attachment.cgi?id=9181014&action=edit) | [Review](/attachment.cgi?id=9181014) |
| [Bug 1666300 part 2 - Parse into an inert document.](/attachment.cgi?id=9181514)  [4 years ago](#c15)  [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)   47 bytes, text/x-phabricator-request | tjr : [approval-mozilla-beta+](#c19 "4 years ago")  tjr : [approval-mozilla-esr78+](#c19 "4 years ago")  tjr : [sec-approval+](#c19 "4 years ago") | [Details](/attachment.cgi?id=9181514&action=edit) | [Review](/attachment.cgi?id=9181514) |
| [Bug 1666300 test - Test SVG style sanitization on paste.](/attachment.cgi?id=9181743)  [4 years ago](#c16)  [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9181743&action=edit) | [Review](/attachment.cgi?id=9181743) |
| [advisory.txt](/attachment.cgi?id=9187091)  [4 years ago](#c25)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   198 bytes, text/plain |  | [Details](/attachment.cgi?id=9187091&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1666300#c0)• 4 years ago |
|  | |

When fuzzing Firefox clipboard API content sanitization on pasting, I found sanitizer bypass with payload `<svg><style><image href=1 onerror=alert(document.domain)>`. When user copy from crafted malicious website, then paste the content, XSS will execute. It leads to universal XSS on latest stable release of Firefox, Firefox 78.3.0esr (64-bit), and Firefox Nightly 82.0a1 (2020-09-20).

## Steps to reproduce:

1. Go to <https://sourc7.appspot.com/bugzilla/0447f4d26c48bd8d0526dce173f57b3ac5235b7b.html>
2. Click Copy Text
3. Go to <https://output.jsbin.com/gocizet/> (TinyMCE Rich Editor form)
4. Paste with Ctrl+V or Right click -> Paste into TinyMCE form
5. XSS will execute [pop alert(document.domain)]
Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1666300#c1)• 4 years ago |
|  | |

:saschanaz, could you take a look given your work on the other related bug in this area of the code?

Group: firefox-core-security → dom-core-securityStatus: UNCONFIRMED → NEWType: task → defect
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=wontfix)
[status-firefox81](/buglist.cgi?f1=cf_status_firefox81&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=affected)
[status-firefox82](/buglist.cgi?f1=cf_status_firefox82&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox82&o1=equals&v1=affected)
[status-firefox83](/buglist.cgi?f1=cf_status_firefox83&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)Component: Security → DOM: EditorEver confirmed: trueFlags: needinfo?(krosylight)Product: Firefox → CoreSee Also: → [1666132](/show_bug.cgi?id=1666132 "VERIFIED DUPLICATE - Mozilla Firefox Universal XSS with Clipboard API")Summary: Mozilla Firefox Universal XSS with Clipboard API (tested on Nightly 82.0a1 (2020-09-20)) → XSS via paste and Clipboard API and SVG + image onerror handler

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1666300#c2)• 4 years ago |
|  | |

Attached file
[0447f4d26c48bd8d0526dce173f57b3ac5235b7b.html](attachment.cgi?id=9176926)
— [Details](attachment.cgi?id=9176926&action=edit)

Payload HTML

|  | [Kagami Rosylight [:saschanaz] (they/them)](/user_profile?user_id=473060) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1666300#c3)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1666300&comment_id=15046862 "1 revision") |
|  | |

A relevant call stack info:

```
xul.dll!mozilla::dom::SVGImageElement::LoadSVGImage(bool aForce, bool aNotify) Line 131 (c:\Users\Kagami\Documents\GitHub\gecko-dev\dom\svg\SVGImageElement.cpp:131)
xul.dll!mozilla::dom::SVGImageElement::AfterSetAttr(int aNamespaceID, nsAtom * aName, const nsAttrValue * aValue, const nsAttrValue * aOldValue, nsIPrincipal * aSubjectPrincipal, bool aNotify) Line 184 (c:\Users\Kagami\Documents\GitHub\gecko-dev\dom\svg\SVGImageElement.cpp:184)
xul.dll!mozilla::dom::Element::SetAttrAndNotify(int aNamespaceID, nsAtom * aName, nsAtom * aPrefix, const nsAttrValue * aOldValue, nsAttrValue & aParsedValue, nsIPrincipal * aSubjectPrincipal, unsigned char aModType, bool aFireMutation, bool aNotify, bool aCallAfterSetAttr, mozilla::dom::Document * aComposedDocument, const mozAutoDocUpdate &) Line 2407 (c:\Users\Kagami\Documents\GitHub\gecko-dev\dom\base\Element.cpp:2407)
xul.dll!mozilla::dom::Element::SetAttr(int aNamespaceID, nsAtom * aName, nsAtom * aPrefix, const nsTSubstring<char16_t> & aValue, nsIPrincipal * aSubjectPrincipal, bool aNotify) Line 2264 (c:\Users\Kagami\Documents\GitHub\gecko-dev\dom\base\Element.cpp:2264)
xul.dll!mozilla::dom::Element::SetAttr(int aNameSpaceID, nsAtom * aName, nsAtom * aPrefix, const nsTSubstring<char16_t> & aValue, bool aNotify) Line 890 (c:\Users\Kagami\Documents\GitHub\gecko-dev\obj-x86_64-pc-mingw32\dist\include\mozilla\dom\Element.h:890)
xul.dll!nsHtml5TreeOperation::CreateSVGElement(nsAtom * aName, nsHtml5HtmlAttributes * aAttributes, mozilla::dom::FromParser aFromParser, nsNodeInfoManager * aNodeInfoManager, nsHtml5DocumentBuilder * aBuilder, nsresult(*)(nsIContent * *, already_AddRefed<mozilla::dom::NodeInfo> &&, mozilla::dom::FromParser) aCreator) Line 554 (c:\Users\Kagami\Documents\GitHub\gecko-dev\parser\html\nsHtml5TreeOperation.cpp:554)
xul.dll!nsHtml5TreeBuilder::createElement(int aNamespace, nsAtom * aName, nsHtml5HtmlAttributes * aAttributes, void * aIntendedParent, nsHtml5ContentCreatorFunction aCreator) Line 124 (c:\Users\Kagami\Documents\GitHub\gecko-dev\parser\html\nsHtml5TreeBuilderCppSupplement.h:124)
xul.dll!nsHtml5TreeBuilder::appendToCurrentNodeAndPushElementMayFosterSVG(nsHtml5ElementName * elementName, nsHtml5HtmlAttributes * attributes) Line 4287 (c:\Users\Kagami\Documents\GitHub\gecko-dev\parser\html\nsHtml5TreeBuilder.cpp:4287)
xul.dll!nsHtml5TreeBuilder::startTag(nsHtml5ElementName * elementName, nsHtml5HtmlAttributes * attributes, bool selfClosing) Line 744 (c:\Users\Kagami\Documents\GitHub\gecko-dev\parser\html\nsHtml5TreeBuilder.cpp:744)
xul.dll!nsHtml5Tokenizer::emitCurrentTagToken(bool selfClosing, int pos) Line 344 (c:\Users\Kagami\Documents\GitHub\gecko-dev\parser\html\nsHtml5Tokenizer.cpp:344)
xul.dll!nsHtml5Tokenizer::stateLoop<nsHtml5SilentPolicy>(int state, char16_t c, int pos, char16_t * buf, bool reconsume, int returnState, int endPos) Line 1069 (c:\Users\Kagami\Documents\GitHub\gecko-dev\parser\html\nsHtml5Tokenizer.cpp:1069)
xul.dll!nsHtml5Tokenizer::tokenizeBuffer(nsHtml5UTF16Buffer * buffer) Line 443 (c:\Users\Kagami\Documents\GitHub\gecko-dev\parser\html\nsHtml5Tokenizer.cpp:443)
xul.dll!nsHtml5StringParser::Tokenize(const nsTSubstring<char16_t> & aSourceBuffer, mozilla::dom::Document * aDocument, bool aScriptingEnabledForNoscriptParsing) Line 101 (c:\Users\Kagami\Documents\GitHub\gecko-dev\parser\html\nsHtml5StringParser.cpp:101)
xul.dll!nsHtml5StringParser::ParseFragment(const nsTSubstring<char16_t> & aSourceBuffer, nsIContent * aTargetNode, nsAtom * aContextLocalName, int aContextNamespace, bool aQuirks, bool aPreventScriptExecution) Line 55 (c:\Users\Kagami\Documents\GitHub\gecko-dev\parser\html\nsHtml5StringParser.cpp:55)
xul.dll!nsContentUtils::ParseFragmentHTML(const nsTSubstring<char16_t> & aSourceBuffer, nsIContent * aTargetNode, nsAtom * aContextLocalName, int aContextNamespace, bool aQuirks, bool aPreventScriptExecution, int aFlags) Line 4857 (c:\Users\Kagami\Documents\GitHub\gecko-dev\dom\base\nsContentUtils.cpp:4857)
xul.dll!mozilla::HTMLEditor::HTMLWithContextInserter::FragmentParser::ParseFragment(const nsTSubstring<char16_t> & aFragStr, nsAtom * aContextLocalName, const mozilla::dom::Document * aTargetDocument, mozilla::dom::DocumentFragment * * aFragment, bool aTrustedInput) Line 3502 (c:\Users\Kagami\Documents\GitHub\gecko-dev\editor\libeditor\HTMLEditorDataTransfer.cpp:3502)
xul.dll!mozilla::HTMLEditor::HTMLWithContextInserter::FragmentParser::ParsePastedHTML(const nsTSubstring<char16_t> & aInputString, nsAtom * aContextLocalNameAtom, mozilla::dom::DocumentFragment * * aFragment) Line 3191 (c:\Users\Kagami\Documents\GitHub\gecko-dev\editor\libeditor\HTMLEditorDataTransfer.cpp:3191)
xul.dll!mozilla::HTMLEditor::HTMLWithContextInserter::FragmentFromPasteCreator::CreateDocumentFragmentAndGetParentOfPastedHTMLInContext(const mozilla::dom::Document & aDocument, const nsTSubstring<char16_t> & aInputString, const nsTSubstring<char16_t> & aContextStr, bool aTrustedInput, nsCOMPtr<nsINode> & aParentNodeOfPastedHTMLInContext, RefPtr<mozilla::dom::DocumentFragment> & aDocumentFragmentToInsert) Line 3366 (c:\Users\Kagami\Documents\GitHub\gecko-dev\editor\libeditor\HTMLEditorDataTransfer.cpp:3366)
xul.dll!mozilla::HTMLEditor::HTMLWithContextInserter::FragmentFromPasteCreator::Run(const mozilla::dom::Document & aDocument, const nsTSubstring<char16_t> & aInputString, const nsTSubstring<char16_t> & aContextStr, const nsTSubstring<char16_t> & aInfoStr, nsCOMPtr<nsINode> * aOutFragNode, nsCOMPtr<nsINode> * aOutStartNode, nsCOMPtr<nsINode> * aOutEndNode, bool aTrustedInput) Line 3421 (c:\Users\Kagami\Documents\GitHub\gecko-dev\editor\libeditor\HTMLEditorDataTransfer.cpp:3421)
xul.dll!mozilla::HTMLEditor::HTMLWithContextInserter::CreateDOMFragmentFromPaste(const nsTSubstring<char16_t> & aInputString, const nsTSubstring<char16_t> & aContextStr, const nsTSubstring<char16_t> & aInfoStr, nsCOMPtr<nsINode> * aOutFragNode, nsCOMPtr<nsINode> * aOutStartNode, nsCOMPtr<nsINode> * aOutEndNode, int * aOutStartOffset, int * aOutEndOffset, bool aTrustedInput) Line 3214 (c:\Users\Kagami\Documents\GitHub\gecko-dev\editor\libeditor\HTMLEditorDataTransfer.cpp:3214)

```

Not sure what should be done here (Edit: because it seems the handler is not directly called by tree builder). Pinging Henri who suggested the previous solution:

Flags: needinfo?(krosylight) → needinfo?(hsivonen)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a189520_159069)• 4 years ago |

See Also: → [1666893](/show_bug.cgi?id=1666893 "RESOLVED DUPLICATE - Event handler attributes on <img>/<svg> nodes dropped by the HTML sanitizer can still run")

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a197379_159069)• 4 years ago |

See Also: → [1666777](/show_bug.cgi?id=1666777 "VERIFIED DUPLICATE - HTML Sanitizer Bypass with combined Image + onerror and STYLE element")

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1666300#c4)• 4 years ago |
|  | |

mozregression points to [this pushlog](https://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=506facea63169a29e04eb140663da1730052db64&tochange=b7f7ae14590aced450bb0b0469dfb38edd2c0ace), which makes me believe we have been incorrect since we first implemented `<image href>` for SVG.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a265306_159069)• 4 years ago |

See Also: → [CVE-2020-26951](/show_bug.cgi?id=1667113 "VERIFIED FIXED - mXSS payload (combined svg, style, title element) lead to HTML Sanitizer Bypass and XSS via Clipboard API (paste)")

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1666300#c5)• 4 years ago |
|  | |

Without testing, my guess is that we remove element children of SVG `style` but since disconnected image nodes load their `src` for compat with Netscape <= 4.x, we end up loading processing the loading for the empty-string `src` and running the `onerror` handler.

Perhaps we need to change node removal in the sanitizer to iterate over the subtree rooted at the node being removed and remove all attributes in it.

Flags: needinfo?(hsivonen)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a868481_1689)• 4 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a868642_1689)• 4 years ago |

Blocks: [CVE-2020-26951](/show_bug.cgi?id=1667113 "VERIFIED FIXED - mXSS payload (combined svg, style, title element) lead to HTML Sanitizer Bypass and XSS via Clipboard API (paste)")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a868925_1689)• 4 years ago |

Blocks: [1666777](/show_bug.cgi?id=1666777 "VERIFIED DUPLICATE - HTML Sanitizer Bypass with combined Image + onerror and STYLE element")

|  | [Jens Stutte [:jstutte]](/user_profile?user_id=646284) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1666300#c6)• 4 years ago |
|  | |

Setting P1 to reflect security classification of [bug 1666777](/show_bug.cgi?id=1666777 "VERIFIED DUPLICATE - HTML Sanitizer Bypass with combined Image + onerror and STYLE element") (as of [comment 13 there](https://bugzilla.mozilla.org/show_bug.cgi?id=1666777#c13)).

Severity: -- → S3Priority: -- → P1

|  | [Anne (:annevk)](/user_profile?user_id=102998) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1666300#c7)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1666300&comment_id=15072543 "1 revision") |
|  | |

HTML `img` element loading (at least per the HTML standard) does an active document check. It seems we should do a similar check for SVG `image` elements. It seems that only fixing this at the sanitizer level would still make us execute script as part of `XMLHttpRequest` or `DOMParser` or some such, right?

(Also, would fixing this at the sanitizer level prevent all network activity?)

|  | [Kagami Rosylight [:saschanaz] (they/them)](/user_profile?user_id=473060) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1666300#c8)• 4 years ago |
|  | |

Somehow this does not call onerror:

```
new DOMParser().parseFromString("<svg><style><image href=1 onerror=alert(document.domain)>", "text/html")

```

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1666300#c9)• 4 years ago |
|  | |

I'll make an attempt at fixing this.

Assignee: nobody → hsivonenStatus: NEW → ASSIGNED

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1666300#c10)• 4 years ago |
|  | |

Attached file
[Bug 1666300 part 1 - Remove attributes from descendants when setting sanitized style.](attachment.cgi?id=9181014)
— [Details](attachment.cgi?id=9181014&action=edit)

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1666300#c11)• 4 years ago |
|  | |

The attached patch so far implements only the attribute removal hack, not Anne's suggestion of a document marked as "loaded as data".

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1666300#c12)• 4 years ago |
|  | |

Per <https://searchfox.org/mozilla-central/rev/c2e3ac11be4837718c2604e58085fbc8252b69dd/editor/libeditor/HTMLEditorDataTransfer.cpp#3241> , we parse using the document that is being edited as the owner document for the nodes during the node creation. Other than performance, would there be downsides to parsing with a distinct throw-away document marked as "loaded as data"?

(In reply to Kagami :saschanaz from [comment #8](/show_bug.cgi?id=1666300#c8 "VERIFIED FIXED - XSS via paste and Clipboard API and SVG + image onerror handler"))

> Somehow this does not call onerror:
>
> ```
> new DOMParser().parseFromString("<svg><style><image href=1 onerror=alert(document.domain)>", "text/html")
>
> ```

That's because `DOMParser` parses into a document marked as "loaded as data".

The attached patch is sufficient for fixing the reported problem from [comment 0](/show_bug.cgi?id=1666300#c0 "VERIFIED FIXED - XSS via paste and Clipboard API and SVG + image onerror handler"), though.

Flags: needinfo?(krosylight)

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1666300#c13)• 4 years ago |
|  | |

Hmm. While a "loaded as data" document might be nice as a defense-in-depth mechanism, it won't help `innerHTML` in chrome, unless we also de-optimize `innerHTML` in chrome not to parser directly into the target document.

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a1882239_5490)• 4 years ago |

See Also: → [1670913](/show_bug.cgi?id=1670913 "RESOLVED FIXED - DOM Sanitizer API should parse into a throw-away \"loaded as data\" document")

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1666300#c14)• 4 years ago |
|  | |

Clearing needinfo that was answered by voice. I'll write a patch for using a throw-away loaded-as-data document.

Flags: needinfo?(krosylight)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a1967525_600971)• 4 years ago |

[Attachment #9181014](/attachment.cgi?id=9181014&action=edit "Bug 1666300 part 1 - Remove attributes from descendants when setting sanitized style.") -
Attachment description: Bug 1666300 - Remove attributes from descendants when setting sanitized style. → Bug 1666300 part 1 - Remove attributes from descendants when setting sanitized style.

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1666300#c15)• 4 years ago |
|  | |

Attached file
[Bug 1666300 part 2 - Parse into an inert document.](attachment.cgi?id=9181514)
— [Details](attachment.cgi?id=9181514&action=edit)

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1666300#c16)• 4 years ago |
|  | |

Attached file
[Bug 1666300 test - Test SVG style sanitization on paste.](attachment.cgi?id=9181743)
— [Details](attachment.cgi?id=9181743&action=edit)

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1666300#c17)• 4 years ago |
|  | |

Comment on [attachment 9181014](/attachment.cgi?id=9181014 "Bug 1666300 part 1 - Remove attributes from descendants when setting sanitized style.") [[details]](/attachment.cgi?id=9181014&action=edit "Bug 1666300 part 1 - Remove attributes from descendants when setting sanitized style.")

[Bug 1666300](/show_bug.cgi?id=1666300 "VERIFIED FIXED - XSS via paste and Clipboard API and SVG + image onerror handler") part 1 - Remove attributes from descendants when setting sanitized style.

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Very easily from part 1; less so from part 2. (If we really wanted to, we could defer part 1.) Note that while this bug is sec-moderate, this is relates to [bug 1667113](/show_bug.cgi?id=1667113 "VERIFIED FIXED - mXSS payload (combined svg, style, title element) lead to HTML Sanitizer Bypass and XSS via Clipboard API (paste)"), which is sec-high and should land together. However, I consider this one more severe than the other one, because the other one is itself about a defense-in-depth mechanism and is already mitigated by *another* defense-in-depth mechanism.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Either the same patch applies or it will be a mechanical rebase
* **How likely is this patch to cause regressions; how much testing does it need?**: Not very likely: Regressions are likely to break the entire mochitest test harness (and did during development), so now that the harness works again, I expect things to be OK.
[Attachment #9181014](/attachment.cgi?id=9181014&action=edit "Bug 1666300 part 1 - Remove attributes from descendants when setting sanitized style.") -
Flags: sec-approval?

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a2409096_5490)• 4 years ago |

[Attachment #9181514](/attachment.cgi?id=9181514&action=edit "Bug 1666300 part 2 - Parse into an inert document.") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a2599684_578488)• 4 years ago |

[status-firefox84](/buglist.cgi?f1=cf_status_firefox84&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=affected)
[tracking-firefox81](/buglist.cgi?f1=cf_tracking_firefox81&o1=isnotempty):
--- → [-](/buglist.cgi?f1=cf_tracking_firefox81&o1=equals&v1=-)
[tracking-firefox82](/buglist.cgi?f1=cf_tracking_firefox82&o1=isnotempty):
--- → [-](/buglist.cgi?f1=cf_tracking_firefox82&o1=equals&v1=-)
[tracking-firefox83](/buglist.cgi?f1=cf_tracking_firefox83&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox83&o1=equals&v1=%2B)
[tracking-firefox84](/buglist.cgi?f1=cf_tracking_firefox84&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox84&o1=equals&v1=%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [83+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=83%2B)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1666300#c18)• 4 years ago |
|  | |

Comment on [attachment 9181014](/attachment.cgi?id=9181014 "Bug 1666300 part 1 - Remove attributes from descendants when setting sanitized style.") [[details]](/attachment.cgi?id=9181014&action=edit "Bug 1666300 part 1 - Remove attributes from descendants when setting sanitized style.")

[Bug 1666300](/show_bug.cgi?id=1666300 "VERIFIED FIXED - XSS via paste and Clipboard API and SVG + image onerror handler") part 1 - Remove attributes from descendants when setting sanitized style.

Approved to land and uplift. Test approved to land after 12/15

[Attachment #9181014](/attachment.cgi?id=9181014&action=edit "Bug 1666300 part 1 - Remove attributes from descendants when setting sanitized style.") -
Flags: sec-approval?
[Attachment #9181014](/attachment.cgi?id=9181014&action=edit "Bug 1666300 part 1 - Remove attributes from descendants when setting sanitized style.") -
Flags: sec-approval+
[Attachment #9181014](/attachment.cgi?id=9181014&action=edit "Bug 1666300 part 1 - Remove attributes from descendants when setting sanitized style.") -
Flags: approval-mozilla-esr78+
[Attachment #9181014](/attachment.cgi?id=9181014&action=edit "Bug 1666300 part 1 - Remove attributes from descendants when setting sanitized style.") -
Flags: approval-mozilla-beta+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1666300#c19)• 4 years ago |
|  | |

Comment on [attachment 9181514](/attachment.cgi?id=9181514 "Bug 1666300 part 2 - Parse into an inert document.") [[details]](/attachment.cgi?id=9181514&action=edit "Bug 1666300 part 2 - Parse into an inert document.")

[Bug 1666300](/show_bug.cgi?id=1666300 "VERIFIED FIXED - XSS via paste and Clipboard API and SVG + image onerror handler") part 2 - Parse into an inert document.

Approved to land and uplift. Test approved to land after 12/15

[Attachment #9181514](/attachment.cgi?id=9181514&action=edit "Bug 1666300 part 2 - Parse into an inert document.") -
Flags: sec-approval?
[Attachment #9181514](/attachment.cgi?id=9181514&action=edit "Bug 1666300 part 2 - Parse into an inert document.") -
Flags: sec-approval+
[Attachment #9181514](/attachment.cgi?id=9181514&action=edit "Bug 1666300 part 2 - Parse into an inert document.") -
Flags: approval-mozilla-esr78+
[Attachment #9181514](/attachment.cgi?id=9181514&action=edit "Bug 1666300 part 2 - Parse into an inert document.") -
Flags: approval-mozilla-beta+

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1666300#c20)• 4 years ago |
|  | |

Landed:

<https://hg.mozilla.org/integration/autoland/rev/9b0c50269ef788e4b1b8ed3a0662b184e322d04c>

<https://hg.mozilla.org/integration/autoland/rev/0f0fc78ad52193bff03fe070e688b04c71efe994>

And backed out for perma failures on browser\_parsable\_css.js:

<https://hg.mozilla.org/integration/autoland/rev/104bf955a8130a41673f410b7c139edcd85ec0a8>

Failure log:

<https://treeherder.mozilla.org/logviewer.html#/jobs?job_id=319351800&repo=autoland&lineNumber=1586>

Flags: needinfo?(hsivonen)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1666300#c21)• 4 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/3476387362fb15c82f133f390afef719ad36de0a>

<https://hg.mozilla.org/integration/autoland/rev/b067b0d3670b37daad95505b87bddca6bb113d11>

Flags: needinfo?(hsivonen)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1666300#c22)• 4 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/3476387362fb>

<https://hg.mozilla.org/mozilla-central/rev/b067b0d3670b>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-firefox84](/buglist.cgi?f1=cf_status_firefox84&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox84&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 84 Branch

|  | [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a2825907_537720)• 4 years ago |

Status: RESOLVED → VERIFIED

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a2942508_580382)• 4 years ago |

[status-firefox81](/buglist.cgi?f1=cf_status_firefox81&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=wontfix)
[status-firefox82](/buglist.cgi?f1=cf_status_firefox82&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox82&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox82&o1=equals&v1=wontfix)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1666300#c23)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/a3ce9140020a>

<https://hg.mozilla.org/releases/mozilla-beta/rev/279f3b9d4d17>

[status-firefox83](/buglist.cgi?f1=cf_status_firefox83&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox83&o1=equals&v1=fixed)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a3277326_580382)• 4 years ago |

Flags: in-testsuite?

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1666300#c24)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr78/rev/112b19f43ac9>

<https://hg.mozilla.org/releases/mozilla-esr78/rev/667553745b48>

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a3725547_1689)• 4 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a4243605_578488)• 4 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main83+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1666300#c25)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9187091)
— [Details](attachment.cgi?id=9187091&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a4577683_578488)• 4 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main83+] → [reporter-external] [client-bounty-form] [verif?][adv-main83+][adv-esr78.5+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a4839709_578488)• 4 years ago |

Alias: CVE-2020-26956

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1666300#c26)• 4 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/782446e715644da3ca8226d0c3413e3fafb69d6f>

This caused [bug 1682950](/show_bug.cgi?id=1682950 "RESOLVED FIXED - Permafailing tier 2 editor/libeditor/tests/test_sanitizer_on_paste.html | Node name should be svg - got \"#text\", expected \"svg\""), which was unexpected.

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a7489566_580382)• 4 years ago |

Flags: in-testsuite? → in-testsuite+

|  | [Andreea Pavel [:apavel]](/user_profile?user_id=600553) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a7616853_600553)• 4 years ago |

Regressions: [1682950](/show_bug.cgi?id=1682950 "RESOLVED FIXED - Permafailing tier 2 editor/libeditor/tests/test_sanitizer_on_paste.html | Node name should be svg - got \"#text\", expected \"svg\"")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a16881925_1689)• 4 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1666300#a116383389_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1666300&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Irvan Kurniawan (:sourc7)](/user_profile?user_id=537720)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


