=== Content from gitlab.com_041fca98_20250119_112004.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stored XSS via Zoom meeting url on project import

**[HackerOne report #832117](https://hackerone.com/reports/832117)** by `vakzz` on 2020-03-26, assigned to [@rchan-gitlab](/rchan-gitlab "Ron Chan"):

### Summary

When importing a project that has an issue with a zoom meeting, the `ZoomUrlValidator` only checks to see if the `url` fields *contains* a valid url not that the whole field is a valid url. This allows a url such as `javascript:alert(document.domain);//https://zoom.us/my/5556` to pass the validation and to be set as the `href` of the `Join Zoom meeting` link.

```
class ZoomUrlValidator < ActiveModel::EachValidator
  def validate_each(record, attribute, value)
    return if Gitlab::ZoomLinkExtractor.new(value).links.size == 1

    record.errors.add(:url, 'must contain one valid Zoom URL')
  end
end

class ZoomLinkExtractor
  ZOOM_REGEXP = %r{https://(?:[\w-]+\.)?zoom\.us/(?:s|j|my)/\S+}.freeze

  def initialize(text)
    [@]text = text.to_s
  end

  def links
    [@]text.scan(ZOOM_REGEXP)
  end

  def match?
    ZOOM_REGEXP.match?([@]text)
  end
end
```

### Steps to reproduce

1. Create a new project
2. Add an issue
3. Add a comment with `/zoom https://zoom.us/my/5556` to add a zoom meeting
4. Export the project
5. Change the `url` attribute of the zoom meeting in `project.json` to be `javascript:alert(document.domain);//https://zoom.us/my/5556"`
6. Import the project
7. Command/Control clicking the `Join zoom meeting` button will trigger the payload in Chrome/Firefox or a regular left click in Safari/Edge

Demo

[zoom-xss.mp4](https://user-content.gitlab-static.net/ceb0c762828b26682da5c3616d9c23bb002f4bf9/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f33373439306630382d643831342d343162642d383638612d3630373230623533636566632f7a6f6f6d2d7873732e6d7034 "Download 'zoom-xss.mp4'")

### Examples

This also happens on gitlab.com but is blocked due to the CSP

<https://gitlab.com> <https://gitlab.com/vakzz-h1/zoom_xss/-/issues/1>

[![Screen_Shot_2020-03-27_at_12.31.49_am.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/a8e2c2bd697393098e6a08e41b54f00816b5e19a/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61626366616235632d343737392d343533352d386364302d3831393236636263373261352f53637265656e5f53686f745f323032302d30332d32375f61745f31322e33312e34395f616d2e706e67)

### What is the current *bug* behavior?

The url of a `ZoomMeeting` can be anything so long as it contains a valid zoom link somewhere inside it.

### What is the expected *correct* behavior?

The url of a `ZoomMeeting` should be a valid zoom url.

### Output of checks

#### Results of GitLab environment info

```
System information
System:		Ubuntu 18.04
Proxy:		no
Current User:	git
Using RVM:	no
Ruby Version:	2.6.5p114
Gem Version:	2.7.10
Bundler Version:1.17.3
Rake Version:	12.3.3
Redis Version:	5.0.7
Git Version:	2.24.1
Sidekiq Version:5.2.7
Go Version:	unknown

GitLab information
Version:	12.8.7-ee
Revision:	2643fd87200
Directory:	/opt/gitlab/embedded/service/gitlab-rails
DB Adapter:	PostgreSQL
DB Version:	10.12
URL:		http://gitlab-vm.local
HTTP Clone URL:	http://gitlab-vm.local/some-group/some-project.git
SSH Clone URL:	git@gitlab-vm.local:some-group/some-project.git
Elasticsearch:	no
Geo:		no
Using LDAP:	no
Using Omniauth:	yes
Omniauth Providers:

GitLab Shell
Version:	11.0.0
Repository storage paths:
- default: 	/var/opt/gitlab/git-data/repositories
GitLab Shell path:		/opt/gitlab/embedded/service/gitlab-shell
Git:		/opt/gitlab/embedded/bin/git
```

## Impact

If a user clicks the link then the attacker could execute requests on behalf of the user

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [zoom-xss.tar.gz](https://h1.sec.gitlab.net/a/57616af1-3406-46c0-a2c7-d55854952eec/zoom-xss.tar.gz)
* [zoom-xss.mp4](https://h1.sec.gitlab.net/a/37490f08-d814-41bd-868a-60720b53cefc/zoom-xss.mp4)
* [Screen\_Shot\_2020-03-27\_at\_12.31.49\_am.png](https://h1.sec.gitlab.net/a/abcfab5c-4779-4535-8cd0-81926cbc72a5/Screen_Shot_2020-03-27_at_12.31.49_am.png)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_d9a4995c_20250119_112003.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-26407.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-26407.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-26407.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-26407.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![🤖 GitLab Bot 🤖's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "🤖 GitLab Bot 🤖")](/gitlab-bot)

  Dec 09, 2020

  [886c3cd1](/gitlab-org/cves/-/commit/886c3cd173f1cf0dcb90e4fbe7c885a0ca507a45)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/886c3cd173f1cf0dcb90e4fbe7c885a0ca507a45)
  ·
  886c3cd1

  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Dec 09, 2020

  886c3cd1

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/886c3cd173f1cf0dcb90e4fbe7c885a0ca507a45)
  [🤖 GitLab Bot 🤖](/gitlab-bot) authored Dec 09, 2020

Loading


