Based on the provided content, here's the breakdown of the vulnerability related to CVE-2020-26161:

**Root cause of vulnerability:**
The HTTP to HTTPS redirection middleware in Octopus Deploy uses the `Host` header from the incoming request to generate the redirection URL.

**Weaknesses/vulnerabilities present:**
- **Host Header Injection:** The application does not validate or sanitize the `Host` header before using it to construct the redirection URL. This allows an attacker to inject a malicious host value.
- **Vulnerable Redirection Logic:** The application trusts the provided Host header to build a redirect URL, instead of explicitly determining the correct hostname/authority for redirect.

**Impact of exploitation:**
- **Request Hijacking:** An attacker can manipulate the redirection URL, causing the victim to be redirected to a malicious site controlled by the attacker. This can be used in phishing attacks to steal credentials or deliver malware.
- When Octopus is behind a caching reverse-proxy, this also leads to cache poisoning attacks, where the malicious redirect can be cached, and then served to all users accessing the service.

**Attack vectors:**
- Sending an HTTP request to the Octopus Deploy server with a crafted `Host` header containing a malicious domain.
- The crafted Host header will be used to construct the redirect to HTTPS, which redirects the victim to the attackers controlled host.

**Required attacker capabilities/position:**
- The attacker needs the ability to send HTTP requests to the vulnerable Octopus Deploy server.
- The attacker does not require any authentication or privileged access.
- The attacker does need to understand the expected flow of the application, to know to target the HTTP to HTTPS redirect endpoint.

**Affected Versions:**
Octopus Server versions from 2019.8.2 up to the current version are vulnerable.