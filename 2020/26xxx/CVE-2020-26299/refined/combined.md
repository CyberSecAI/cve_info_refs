=== Content from github.com_e4a41f40_20250119_140447.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=QuorumDMS%2Fftp-srv)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[QuorumDMS](/QuorumDMS)
/
**[ftp-srv](/QuorumDMS/ftp-srv)**
Public

* [Notifications](/login?return_to=%2FQuorumDMS%2Fftp-srv) You must be signed in to change notification settings
* [Fork
  117](/login?return_to=%2FQuorumDMS%2Fftp-srv)
* [Star
   390](/login?return_to=%2FQuorumDMS%2Fftp-srv)

📮 Modern FTP Server

### License

[MIT license](/QuorumDMS/ftp-srv/blob/main/LICENSE)

[390
stars](/QuorumDMS/ftp-srv/stargazers) [117
forks](/QuorumDMS/ftp-srv/forks) [Branches](/QuorumDMS/ftp-srv/branches) [Tags](/QuorumDMS/ftp-srv/tags) [Activity](/QuorumDMS/ftp-srv/activity)
 [Star](/login?return_to=%2FQuorumDMS%2Fftp-srv)

 [Notifications](/login?return_to=%2FQuorumDMS%2Fftp-srv) You must be signed in to change notification settings

* [Code](/QuorumDMS/ftp-srv)
* [Issues
  37](/QuorumDMS/ftp-srv/issues)
* [Pull requests
  16](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects
  0](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

Additional navigation options

* [Code](/QuorumDMS/ftp-srv)
* [Issues](/QuorumDMS/ftp-srv/issues)
* [Pull requests](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

# QuorumDMS/ftp-srv

    main[Branches](/QuorumDMS/ftp-srv/branches)[Tags](/QuorumDMS/ftp-srv/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[352 Commits](/QuorumDMS/ftp-srv/commits/main/) | | |
| [.circleci](/QuorumDMS/ftp-srv/tree/main/.circleci ".circleci") | | [.circleci](/QuorumDMS/ftp-srv/tree/main/.circleci ".circleci") |  |  |
| [.github](/QuorumDMS/ftp-srv/tree/main/.github ".github") | | [.github](/QuorumDMS/ftp-srv/tree/main/.github ".github") |  |  |
| [bin](/QuorumDMS/ftp-srv/tree/main/bin "bin") | | [bin](/QuorumDMS/ftp-srv/tree/main/bin "bin") |  |  |
| [changelog](/QuorumDMS/ftp-srv/tree/main/changelog "changelog") | | [changelog](/QuorumDMS/ftp-srv/tree/main/changelog "changelog") |  |  |
| [meta](/QuorumDMS/ftp-srv/tree/main/meta "meta") | | [meta](/QuorumDMS/ftp-srv/tree/main/meta "meta") |  |  |
| [src](/QuorumDMS/ftp-srv/tree/main/src "src") | | [src](/QuorumDMS/ftp-srv/tree/main/src "src") |  |  |
| [test](/QuorumDMS/ftp-srv/tree/main/test "test") | | [test](/QuorumDMS/ftp-srv/tree/main/test "test") |  |  |
| [.editorconfig](/QuorumDMS/ftp-srv/blob/main/.editorconfig ".editorconfig") | | [.editorconfig](/QuorumDMS/ftp-srv/blob/main/.editorconfig ".editorconfig") |  |  |
| [.eslintignore](/QuorumDMS/ftp-srv/blob/main/.eslintignore ".eslintignore") | | [.eslintignore](/QuorumDMS/ftp-srv/blob/main/.eslintignore ".eslintignore") |  |  |
| [.gitattributes](/QuorumDMS/ftp-srv/blob/main/.gitattributes ".gitattributes") | | [.gitattributes](/QuorumDMS/ftp-srv/blob/main/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/QuorumDMS/ftp-srv/blob/main/.gitignore ".gitignore") | | [.gitignore](/QuorumDMS/ftp-srv/blob/main/.gitignore ".gitignore") |  |  |
| [CODEOWNERS](/QuorumDMS/ftp-srv/blob/main/CODEOWNERS "CODEOWNERS") | | [CODEOWNERS](/QuorumDMS/ftp-srv/blob/main/CODEOWNERS "CODEOWNERS") |  |  |
| [CONTRIBUTING.md](/QuorumDMS/ftp-srv/blob/main/CONTRIBUTING.md "CONTRIBUTING.md") | | [CONTRIBUTING.md](/QuorumDMS/ftp-srv/blob/main/CONTRIBUTING.md "CONTRIBUTING.md") |  |  |
| [LICENSE](/QuorumDMS/ftp-srv/blob/main/LICENSE "LICENSE") | | [LICENSE](/QuorumDMS/ftp-srv/blob/main/LICENSE "LICENSE") |  |  |
| [README.md](/QuorumDMS/ftp-srv/blob/main/README.md "README.md") | | [README.md](/QuorumDMS/ftp-srv/blob/main/README.md "README.md") |  |  |
| [SECURITY.md](/QuorumDMS/ftp-srv/blob/main/SECURITY.md "SECURITY.md") | | [SECURITY.md](/QuorumDMS/ftp-srv/blob/main/SECURITY.md "SECURITY.md") |  |  |
| [ftp-srv.d.ts](/QuorumDMS/ftp-srv/blob/main/ftp-srv.d.ts "ftp-srv.d.ts") | | [ftp-srv.d.ts](/QuorumDMS/ftp-srv/blob/main/ftp-srv.d.ts "ftp-srv.d.ts") |  |  |
| [ftp-srv.js](/QuorumDMS/ftp-srv/blob/main/ftp-srv.js "ftp-srv.js") | | [ftp-srv.js](/QuorumDMS/ftp-srv/blob/main/ftp-srv.js "ftp-srv.js") |  |  |
| [logo.png](/QuorumDMS/ftp-srv/blob/main/logo.png "logo.png") | | [logo.png](/QuorumDMS/ftp-srv/blob/main/logo.png "logo.png") |  |  |
| [package-lock.json](/QuorumDMS/ftp-srv/blob/main/package-lock.json "package-lock.json") | | [package-lock.json](/QuorumDMS/ftp-srv/blob/main/package-lock.json "package-lock.json") |  |  |
| [package.json](/QuorumDMS/ftp-srv/blob/main/package.json "package.json") | | [package.json](/QuorumDMS/ftp-srv/blob/main/package.json "package.json") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
* Security

[![ftp-srv](/QuorumDMS/ftp-srv/raw/main/logo.png)](https://github.com/autovance/ftp-srv)

Modern, extensible FTP Server

[![npm](https://camo.githubusercontent.com/b7710aa140ced9c5be449eb0e57aa346ee89b8e5cc884509fd6f842675829557/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f646d2f6674702d7372762e7376673f7374796c653d666f722d7468652d6261646765)](https://www.npmjs.com/package/ftp-srv)
[![circleci](https://camo.githubusercontent.com/84c59ad2a52d504c0550ef4044aa22237161a13af2907cd68a0d0a78dfd1aec3/68747470733a2f2f696d672e736869656c64732e696f2f636972636c6563692f70726f6a6563742f6769746875622f6175746f76616e63652f6674702d7372762f6d61737465722e7376673f7374796c653d666f722d7468652d6261646765)](https://circleci.com/gh/autovance/workflows/ftp-srv/tree/master)

---

## Overview

`ftp-srv` is a modern and extensible FTP server designed to be simple yet configurable.

## Features

* Extensible [file systems](#file-system) per connection
* Passive and active transfers
* [Explicit](https://en.wikipedia.org/wiki/FTPS#Explicit) & [Implicit](https://en.wikipedia.org/wiki/FTPS#Implicit) TLS connections
* Promise based API

## Install

`npm install ftp-srv --save`

## Usage

```
// Quick start, create an active ftp server.
const FtpSrv = require('ftp-srv');

const port=21;
const ftpServer = new FtpSrv({
    url: "ftp://0.0.0.0:" + port,
    anonymous: true
});

ftpServer.on('login', ({ connection, username, password }, resolve, reject) => {
    if(username === 'anonymous' && password === 'anonymous'){
        return resolve({ root:"/" });
    }
    return reject(new errors.GeneralError('Invalid username or password', 401));
});

ftpServer.listen().then(() => {
    console.log('Ftp server is starting...')
});
```

## API

### `new FtpSrv({options})`

#### url

[URL string](https://nodejs.org/api/url.html#url_url_strings_and_url_objects) indicating the protocol, hostname, and port to listen on for connections.
Supported protocols:

* `ftp` Plain FTP
* `ftps` Implicit FTP over TLS

*Note:* The hostname must be the external IP address to accept external connections. `0.0.0.0` will listen on any available hosts for server and passive connections.

**Default:** `"ftp://127.0.0.1:21"`

#### `pasv_url`

`FTP-srv` provides an IP address to the client when a `PASV` command is received in the handshake for a passive connection. Reference [PASV verb](https://cr.yp.to/ftp/retr.html#pasv). This can be one of two options:

* A function which takes one parameter containing the remote IP address of the FTP client. This can be useful when the user wants to return a different IP address depending if the user is connecting from Internet or from an LAN address.
  Example:

```
const { networkInterfaces } = require('os');
const { Netmask } = require('netmask');

const nets = networkInterfaces();
function getNetworks() {
   let networks = {};
   for (const name of Object.keys(nets)) {
       for (const net of nets[name]) {
           if (net.family === 'IPv4' && !net.internal) {
               networks[net.address + "/24"] = net.address
           }
       }
   }
   return networks;
}

const resolverFunction = (address) => {
   // const networks = {
   //     '$GATEWAY_IP/32': `${public_ip}`,
   //     '10.0.0.0/8'    : `${lan_ip}`
   // }
   const networks = getNetworks();
   for (const network in networks) {
       if (new Netmask(network).contains(address)) {
           return networks[network];
       }
   }
   return "127.0.0.1";
}

new FtpSrv({pasv_url: resolverFunction});
```

* A static IP address (ie. an external WAN **IP address** that the FTP server is bound to). In this case, only connections from localhost are handled differently returning `127.0.0.1` to the client.

If not provided, clients can only connect using an `Active` connection.

#### `pasv_min`

The starting port to accept passive connections.

**Default:** `1024`

#### `pasv_max`

The ending port to accept passive connections.

The range is then queried for an available port to use when required.

**Default:** `65535`

#### `greeting`

A human readable array of lines or string to send when a client connects.

**Default:** `null`

#### `tls`

Node [TLS secure context object](https://nodejs.org/api/tls.html#tls_tls_createsecurecontext_options) used for implicit (`ftps` protocol) or explicit (`AUTH TLS`) connections.

**Default:** `false`

#### `anonymous`

If true, will allow clients to authenticate using the username `anonymous`, not requiring a password from the user.

Can also set as a string which allows users to authenticate using the username provided.

The `login` event is then sent with the provided username and `@anonymous` as the password.

**Default:** `false`

#### `blacklist`

Array of commands that are not allowed.

Response code `502` is sent to clients sending one of these commands.

**Example:** `['RMD', 'RNFR', 'RNTO']` will not allow users to delete directories or rename any files.

**Default:** `[]`

#### `whitelist`

Array of commands that are only allowed.

Response code `502` is sent to clients sending any other command.

**Default:** `[]`

#### `file_format`

Sets the format to use for file stat queries such as `LIST`.

**Default:** `"ls"`

**Allowable values:**

* `ls` [bin/ls format](https://cr.yp.to/ftp/list/binls.html)
* `ep` [Easily Parsed LIST format](https://cr.yp.to/ftp/list/eplf.html)
* `function () {}` A custom function returning a format or promise for one.
  + Only one argument is passed in: a node [file stat](https://nodejs.org/api/fs.html#fs_class_fs_stats) object with additional file `name` parameter

#### `log`

A [bunyan logger](https://github.com/trentm/node-bunyan) instance. Created by default.

#### `timeout`

Sets the timeout (in ms) after that an idle connection is closed by the server

**Default:** `0`

## CLI

`ftp-srv` also comes with a builtin CLI.

```
$ ftp-srv [url] [options]
```

```
$ ftp-srv ftp://0.0.0.0:9876 --root ~/Documents
```

#### `url`

Set the listening URL.

Defaults to `ftp://127.0.0.1:21`

#### `--pasv_url`

The hostname to provide a client when attempting a passive connection (`PASV`).

If not provided, clients can only connect using an `Active` connection.

#### `--pasv_min`

The starting port to accept passive connections.

**Default:** `1024`

#### `--pasv_max`

The ending port to accept passive connections.

The range is then queried for an available port to use when required.

**Default:** `65535`

#### `--root` / `-r`

Set the default root directory for users.

Defaults to the current directory.

#### `--credentials` / `-c`

Set the path to a json credentials file.

Format:

```
[
  {
    "username": "...",
    "password": "...",
    "root": "..." // Root directory
  },
  ...
]
```

#### `--username`

Set the username for the only user. Do not provide an argument to allow anonymous login.

#### `--password`

Set the password for the given `username`.

#### `--read-only`

Disable write actions such as upload, delete, etc.

## Events

The `FtpSrv` class extends the [node net.Server](https://nodejs.org/api/net.html#net_class_net_server). Some custom events can be resolved or rejected, such as `login`.

### `client-error`

```
ftpServer.on('client-error', ({connection, context, error}) => { ... });
```

Occurs when an error arises in the client connection.

`connection` [client class object](/QuorumDMS/ftp-srv/blob/main/src/connection.js)

`context` string of where the error occurred

`error` error object

### `disconnect`

```
ftpServer.on('disconnect', ({connection, id, newConnectionCount}) => { ... });
```

Occurs when a client has disconnected.

`connection` [client class object](/QuorumDMS/ftp-srv/blob/main/src/connection.js)

`id` string of the disconnected connection id

`id` number of the new connection count (exclusive the disconnected client connection)

### `closed`

```
ftpServer.on('closed', ({}) => { ... });
```

Occurs when the FTP server has been closed.

### `closing`

```
ftpServer.on('closing', ({}) => { ... });
```

Occurs when the FTP server has started closing.

### `login`

```
ftpServer.on('login', ({connection, username, password}, resolve, reject) => { ... });
```

Occurs when a client is attempting to login. Here you can resolve the login request by username and password.

`connection` [client class object](/QuorumDMS/ftp-srv/blob/main/src/connection.js)

`username` string of username from `USER` command

`password` string of password from `PASS` command

`resolve` takes an object of arguments:

* `fs`
  + Set a custom file system class for this connection to use.
  + See [File System](#file-system) for implementation details.
* `root`
  + If `fs` is not provided, this will set the root directory for the connection.
  + The user cannot traverse lower than this directory.
* `cwd`
  + If `fs` is not provided, will set the starting directory for the connection
  + This is relative to the `root` directory.
* `blacklist`
  + Commands that are forbidden for only this connection
* `whitelist`
  + If set, this connection will only be able to use the provided commands

`reject` takes an error object

### `server-error`

```
ftpServer.on('server-error', ({error}) => { ... });
```

Occurs when an error arises in the FTP server.

`error` error object

### `RETR`

```
connection.on('RETR', (error, filePath) => { ... });
```

Occurs when a file is downloaded.

`error` if successful, will be `null`

`filePath` location to which file was downloaded

### `STOR`

```
connection.on('STOR', (error, fileName) => { ... });
```

Occurs when a file is uploaded.

`error` if successful, will be `null`

`fileName` name of the file that was uploaded

### `RNTO`

```
connection.on('RNTO', (error, fileName) => { ... });
```

Occurs when a file is renamed.

`error` if successful, will be `null`

`fileName` name of the file that was renamed

## Supported Commands

See the [command registry](/QuorumDMS/ftp-srv/blob/main/src/commands/registration) for a list of all implemented FTP commands.

## File System

The default [file system](/QuorumDMS/ftp-srv/blob/main/src/fs.js) can be overwritten to use your own implementation.

This can allow for virtual file systems, and more.

Each connection can set it's own file system based on the user.

The default file system is exported and can be extended as needed:

```
const {FtpSrv, FileSystem} = require('ftp-srv');

class MyFileSystem extends FileSystem {
  constructor() {
    super(...arguments);
  }

  get(fileName) {
    ...
  }
}
```

Custom file systems can implement the following variables depending on the developers needs:

### Methods

#### [`currentDirectory()`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L40)

Returns a string of the current working directory

**Used in:** `PWD`

#### [`get(fileName)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L44)

Returns a file stat object of file or directory

**Used in:** `LIST`, `NLST`, `STAT`, `SIZE`, `RNFR`, `MDTM`

#### [`list(path)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L50)

Returns array of file and directory stat objects

**Used in:** `LIST`, `NLST`, `STAT`

#### [`chdir(path)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L67)

Returns new directory relative to current directory

**Used in:** `CWD`, `CDUP`

#### [`mkdir(path)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L114)

Returns a path to a newly created directory

**Used in:** `MKD`

#### [`write(fileName, {append, start})`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L79)

Returns a writable stream

Options:

`append` if true, append to existing file

`start` if set, specifies the byte offset to write to

**Used in:** `STOR`, `APPE`

#### [`read(fileName, {start})`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L90)

Returns a readable stream

Options:

`start` if set, specifies the byte offset to read from

**Used in:** `RETR`

#### [`delete(path)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L105)

Delete a file or directory

**Used in:** `DELE`

#### [`rename(from, to)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L120)

Renames a file or directory

**Used in:** `RNFR`, `RNTO`

#### [`chmod(path)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L126)

Modifies a file or directory's permissions

**Used in:** `SITE CHMOD`

#### [`getUniqueName(fileName)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L131)

Returns a unique file name to write to. Client requested filename available if you want to base your function on it.
**Used in:** `STOU`

## Contributing

See [CONTRIBUTING.md](/QuorumDMS/ftp-srv/blob/main/CONTRIBUTING.md).

## License

This software is licensed under the MIT Licence. See [LICENSE](/QuorumDMS/ftp-srv/blob/main/LICENSE).

## References

* <https://cr.yp.to/ftp.html>

## About

📮 Modern FTP Server

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/QuorumDMS/ftp-srv/activity)
[Custom properties](/QuorumDMS/ftp-srv/custom-properties)
### Stars

[**390**
stars](/QuorumDMS/ftp-srv/stargazers)
### Watchers

[**16**
watching](/QuorumDMS/ftp-srv/watchers)
### Forks

[**117**
forks](/QuorumDMS/ftp-srv/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv&report=QuorumDMS+%28user%29)

## [Releases 69](/QuorumDMS/ftp-srv/releases)

[v4.6.3
Latest

Oct 9, 2023](/QuorumDMS/ftp-srv/releases/tag/v4.6.3)
[+ 68 releases](/QuorumDMS/ftp-srv/releases)

## [Packages 0](/orgs/QuorumDMS/packages?repo_name=ftp-srv)

No packages published

## [Contributors 39](/QuorumDMS/ftp-srv/graphs/contributors)

[+ 25 contributors](/QuorumDMS/ftp-srv/graphs/contributors)

## Languages

* [JavaScript
  99.1%](/QuorumDMS/ftp-srv/search?l=javascript)
* [HTML
  0.9%](/QuorumDMS/ftp-srv/search?l=html)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a5fe6762_20250119_122633.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fpull%2F224)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fpull%2F224)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=QuorumDMS%2Fftp-srv)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[QuorumDMS](/QuorumDMS)
/
**[ftp-srv](/QuorumDMS/ftp-srv)**
Public

* [Notifications](/login?return_to=%2FQuorumDMS%2Fftp-srv) You must be signed in to change notification settings
* [Fork
  117](/login?return_to=%2FQuorumDMS%2Fftp-srv)
* [Star
   390](/login?return_to=%2FQuorumDMS%2Fftp-srv)

* [Code](/QuorumDMS/ftp-srv)
* [Issues
  37](/QuorumDMS/ftp-srv/issues)
* [Pull requests
  16](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects
  0](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

Additional navigation options

* [Code](/QuorumDMS/ftp-srv)
* [Issues](/QuorumDMS/ftp-srv/issues)
* [Pull requests](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FQuorumDMS%2Fftp-srv%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FQuorumDMS%2Fftp-srv%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# fix(fs): check resolved path against root #224

 Merged

[matt-forster](/matt-forster)
merged 5 commits into
[master](/QuorumDMS/ftp-srv/tree/master "QuorumDMS/ftp-srv:master")
from
[fix-root-escape](/QuorumDMS/ftp-srv/tree/fix-root-escape "QuorumDMS/ftp-srv:fix-root-escape")

Dec 16, 2020

 Merged

# [fix(fs): check resolved path against root](#top) #224

[matt-forster](/matt-forster)
merged 5 commits into
[master](/QuorumDMS/ftp-srv/tree/master "QuorumDMS/ftp-srv:master")
from
[fix-root-escape](/QuorumDMS/ftp-srv/tree/fix-root-escape "QuorumDMS/ftp-srv:fix-root-escape")

Dec 16, 2020

[Conversation
1](/QuorumDMS/ftp-srv/pull/224)
[Commits
5](/QuorumDMS/ftp-srv/pull/224/commits)
[Checks
0](/QuorumDMS/ftp-srv/pull/224/checks)
[Files changed](/QuorumDMS/ftp-srv/pull/224/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![matt-forster](https://avatars.githubusercontent.com/u/3375444?s=60&v=4)](/matt-forster)

Copy link

Contributor

### @matt-forster **[matt-forster](/matt-forster)** commented [Dec 15, 2020](#issue-768124444) • edited Loading

This should prevent paths from being resolved above the root.

Should affect all commands that utilize the FS functions.

Fixes [#167](https://github.com/QuorumDMS/ftp-srv/issues/167)

Sorry, something went wrong.

All reactions

[![@matt-forster](https://avatars.githubusercontent.com/u/3375444?s=40&u=c9a77baf1c9cadc07e1173cfedb238ffae86986a&v=4)](/matt-forster)
[matt-forster](/matt-forster)
self-assigned this
[Dec 15, 2020](#event-4116412289)

[![@matt-forster](https://avatars.githubusercontent.com/u/3375444?s=40&u=c9a77baf1c9cadc07e1173cfedb238ffae86986a&v=4)](/matt-forster)
[matt-forster](/matt-forster)
added
the
[bug](/QuorumDMS/ftp-srv/labels/bug)
A defect or bug that affects the original indended use of the application
label
[Dec 15, 2020](#event-4116412305)

[![@matt-forster](https://avatars.githubusercontent.com/u/3375444?s=40&v=4)](/matt-forster)

`[fix(fs): check resolved path against root](/QuorumDMS/ftp-srv/pull/224/commits/b5d8fc033f14b4fe4871ec2c6c9f522166f89e4b "fix(fs): check resolved path against root

This should prevent paths from being resolved above the root.

Should affect all commands that utilize the FS functions.

Fixes #167")`
 …

`[b5d8fc0](/QuorumDMS/ftp-srv/pull/224/commits/b5d8fc033f14b4fe4871ec2c6c9f522166f89e4b)`

```
This should prevent paths from being resolved above the root.

Should affect all commands that utilize the FS functions.

Fixes [#167](https://github.com/QuorumDMS/ftp-srv/issues/167)
```

 [![@matt-forster](https://avatars.githubusercontent.com/u/3375444?s=40&u=c9a77baf1c9cadc07e1173cfedb238ffae86986a&v=4)](/matt-forster)
[matt-forster](/matt-forster)
[force-pushed](/QuorumDMS/ftp-srv/compare/c80f0fdeae9ba8a297c0133837be1c603f86fa9f..b5d8fc033f14b4fe4871ec2c6c9f522166f89e4b)
the
fix-root-escape

branch
from
[`c80f0fd`](/QuorumDMS/ftp-srv/commit/c80f0fdeae9ba8a297c0133837be1c603f86fa9f) to
[`b5d8fc0`](/QuorumDMS/ftp-srv/commit/b5d8fc033f14b4fe4871ec2c6c9f522166f89e4b)  [Compare](/QuorumDMS/ftp-srv/compare/c80f0fdeae9ba8a297c0133837be1c603f86fa9f..b5d8fc033f14b4fe4871ec2c6c9f522166f89e4b)
[December 15, 2020 20:35](#event-4116540250)

 Tyler Stewart
and others
added 3 commits
[December 15, 2020 17:26](#commits-pushed-d3e0ae5)

`[test: use __dirname for relative certs](/QuorumDMS/ftp-srv/pull/224/commits/d3e0ae5cf1f1fbd41d4ae4ef19d0c4fc6eb6cfae "test: use __dirname for relative certs")`

`[d3e0ae5](/QuorumDMS/ftp-srv/pull/224/commits/d3e0ae5cf1f1fbd41d4ae4ef19d0c4fc6eb6cfae)`

`[fix: improve path resolution](/QuorumDMS/ftp-srv/pull/224/commits/1b5aacbbeb85240de6faeb3916b9d29880c277d0 "fix: improve path resolution")`

`[1b5aacb](/QuorumDMS/ftp-srv/pull/224/commits/1b5aacbbeb85240de6faeb3916b9d29880c277d0)`

[![@matt-forster](https://avatars.githubusercontent.com/u/3375444?s=40&v=4)](/matt-forster)

`[chore: remove unused package](/QuorumDMS/ftp-srv/pull/224/commits/308667b669ce73e8bbd21d1cdf7d106f9bd5ff62 "chore: remove unused package")`

`[308667b](/QuorumDMS/ftp-srv/pull/224/commits/308667b669ce73e8bbd21d1cdf7d106f9bd5ff62)`

 [![@matt-forster](https://avatars.githubusercontent.com/u/3375444?s=40&u=c9a77baf1c9cadc07e1173cfedb238ffae86986a&v=4)](/matt-forster)
[matt-forster](/matt-forster)
[force-pushed](/QuorumDMS/ftp-srv/compare/982330f21bffccdec9f61d8333aa36e301108a79..308667b669ce73e8bbd21d1cdf7d106f9bd5ff62)
the
fix-root-escape

branch
from
[`982330f`](/QuorumDMS/ftp-srv/commit/982330f21bffccdec9f61d8333aa36e301108a79) to
[`308667b`](/QuorumDMS/ftp-srv/commit/308667b669ce73e8bbd21d1cdf7d106f9bd5ff62)  [Compare](/QuorumDMS/ftp-srv/compare/982330f21bffccdec9f61d8333aa36e301108a79..308667b669ce73e8bbd21d1cdf7d106f9bd5ff62)
[December 16, 2020 00:48](#event-4117312057)

 [![@matt-forster](https://avatars.githubusercontent.com/u/3375444?s=40&u=c9a77baf1c9cadc07e1173cfedb238ffae86986a&v=4)](/matt-forster)
[matt-forster](/matt-forster)
marked this pull request as ready for review
[December 16, 2020 00:49](#event-4117313880)

[![trs](https://avatars.githubusercontent.com/u/15315657?s=60&v=4)](/trs)

**[trs](/trs)**
approved these changes
[Dec 16, 2020](#pullrequestreview-553210981)

 [View reviewed changes](/QuorumDMS/ftp-srv/pull/224/files/308667b669ce73e8bbd21d1cdf7d106f9bd5ff62)

[![@matt-forster](https://avatars.githubusercontent.com/u/3375444?s=40&u=c9a77baf1c9cadc07e1173cfedb238ffae86986a&v=4)](/matt-forster)
[matt-forster](/matt-forster)
added
the
[security](/QuorumDMS/ftp-srv/labels/security)
label
[Dec 16, 2020](#event-4117342561)

[![Jl14Salvador](https://avatars.githubusercontent.com/u/12138574?s=60&v=4)](/Jl14Salvador)

**[Jl14Salvador](/Jl14Salvador)**
approved these changes
[Dec 16, 2020](#pullrequestreview-553831103)

 [View reviewed changes](/QuorumDMS/ftp-srv/pull/224/files/308667b669ce73e8bbd21d1cdf7d106f9bd5ff62)

`[fix: normalize resolve path if absolute](/QuorumDMS/ftp-srv/pull/224/commits/4d1fe5618025f1e57b4778f1c8bdf1ec2372a6e7 "fix: normalize resolve path if absolute

Otherwise join will normalize")`
 …

`[4d1fe56](/QuorumDMS/ftp-srv/pull/224/commits/4d1fe5618025f1e57b4778f1c8bdf1ec2372a6e7)`

```
Otherwise join will normalize
```

[![@matt-forster](https://avatars.githubusercontent.com/u/3375444?s=40&u=c9a77baf1c9cadc07e1173cfedb238ffae86986a&v=4)](/matt-forster)
[matt-forster](/matt-forster)
merged commit [`457b859`](/QuorumDMS/ftp-srv/commit/457b859450a37cba10ff3c431eb4aa67771122e3)
into
master

[Dec 16, 2020](https://github.com/QuorumDMS/ftp-srv/pull/224#event-4120876611)

 [![@matt-forster](https://avatars.githubusercontent.com/u/3375444?s=40&u=c9a77baf1c9cadc07e1173cfedb238ffae86986a&v=4)](/matt-forster)
[matt-forster](/matt-forster)
deleted the
fix-root-escape

branch
[December 16, 2020 17:19](#event-4120876690)

[![@botovance](https://avatars.githubusercontent.com/u/34695204?s=80&u=a5f6545eed906bf995984dac1702c51eaac4e247&v=4)](/botovance)

Copy link

Contributor

### **[botovance](/botovance)** commented [Dec 16, 2020](#issuecomment-747092224)

| 🎉 This PR is included in version 4.4.0 🎉  The release is available on:   * [npm package (@latest dist-tag)](https://www.npmjs.com/package/ftp-srv/v/4.4.0) * [GitHub release](https://github.com/autovance/ftp-srv/releases/tag/v4.4.0)   Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot 📦🚀 |
| --- |

All reactions

Sorry, something went wrong.

[![@botovance](https://avatars.githubusercontent.com/u/34695204?s=40&u=a5f6545eed906bf995984dac1702c51eaac4e247&v=4)](/botovance)
[botovance](/botovance)
added
the
[released](/QuorumDMS/ftp-srv/labels/released)
label
[Dec 16, 2020](#event-4122249027)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fpull%2F224)

Reviewers

[![@trs](https://avatars.githubusercontent.com/u/15315657?s=40&v=4)](/trs) [trs](/trs)

trs approved these changes

[![@Jl14Salvador](https://avatars.githubusercontent.com/u/12138574?s=40&v=4)](/Jl14Salvador) [Jl14Salvador](/Jl14Salvador)

Jl14Salvador approved these changes

Assignees

[![@matt-forster](https://avatars.githubusercontent.com/u/3375444?s=40&v=4)](/matt-forster) [matt-forster](/matt-forster)

Labels

[bug](/QuorumDMS/ftp-srv/labels/bug)
A defect or bug that affects the original indended use of the application
[released](/QuorumDMS/ftp-srv/labels/released)
[security](/QuorumDMS/ftp-srv/labels/security)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [Windows: User can escape from root directory](https://github.com/QuorumDMS/ftp-srv/issues/167)

4 participants

[![@matt-forster](https://avatars.githubusercontent.com/u/3375444?s=52&v=4)](/matt-forster) [![@botovance](https://avatars.githubusercontent.com/u/34695204?s=52&v=4)](/botovance) [![@Jl14Salvador](https://avatars.githubusercontent.com/u/12138574?s=52&v=4)](/Jl14Salvador) [![@trs](https://avatars.githubusercontent.com/u/15315657?s=52&v=4)](/trs)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_af6bd2b1_20250119_122630.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fissues%2F167)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fissues%2F167)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=QuorumDMS%2Fftp-srv)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[QuorumDMS](/QuorumDMS)
/
**[ftp-srv](/QuorumDMS/ftp-srv)**
Public

* [Notifications](/login?return_to=%2FQuorumDMS%2Fftp-srv) You must be signed in to change notification settings
* [Fork
  117](/login?return_to=%2FQuorumDMS%2Fftp-srv)
* [Star
   390](/login?return_to=%2FQuorumDMS%2Fftp-srv)

* [Code](/QuorumDMS/ftp-srv)
* [Issues
  37](/QuorumDMS/ftp-srv/issues)
* [Pull requests
  16](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects
  0](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

Additional navigation options

* [Code](/QuorumDMS/ftp-srv)
* [Issues](/QuorumDMS/ftp-srv/issues)
* [Pull requests](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

# Windows: User can escape from root directory #167

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkOpen[#224](https://github.com/QuorumDMS/ftp-srv/pull/224)Open[Windows: User can escape from root directory](#top)#167[#224](https://github.com/QuorumDMS/ftp-srv/pull/224)Copy linkLabels[bugA defect or bug that affects the original indended use of the application](https://github.com/QuorumDMS/ftp-srv/issues?q=state%3Aopen%20label%3A%22bug%22)A defect or bug that affects the original indended use of the application[security](https://github.com/QuorumDMS/ftp-srv/issues?q=state%3Aopen%20label%3A%22security%22)[windows](https://github.com/QuorumDMS/ftp-srv/issues?q=state%3Aopen%20label%3A%22windows%22)![@yetanothernickname](https://avatars.githubusercontent.com/u/53004641?v=4&size=80)
## Description

![@yetanothernickname](https://avatars.githubusercontent.com/u/53004641?v=4&size=48)[yetanothernickname](https://github.com/yetanothernickname)opened [on Jul 17, 2019](https://github.com/QuorumDMS/ftp-srv/issues/167#issue-469177567)

Windows, default File System, root directory set in login event callback. User can browse parent directory using /../../ in URL.

Example:

`root: 'X:\\Project\\Storage\\User'`

URL `ftp://127.0.0.1/../../` becomes a command `CWD \/../../`

At line 30 in fs.js we have `nodePath.resolve('X:\Project\Storage\User', '.\\\..\..\')`

So \_resolvePath() returns

```
{
  clientPath: '\\..\..\',
  fsPath: 'X:\Project'
}

```
## Metadata

### Assignees

No one assigned

### Labels

[bugA defect or bug that affects the original indended use of the application](https://github.com/QuorumDMS/ftp-srv/issues?q=state%3Aopen%20label%3A%22bug%22)A defect or bug that affects the original indended use of the application[security](https://github.com/QuorumDMS/ftp-srv/issues?q=state%3Aopen%20label%3A%22security%22)[windows](https://github.com/QuorumDMS/ftp-srv/issues?q=state%3Aopen%20label%3A%22windows%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e0dc02d1_20250119_122629.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fcommit%2F457b859450a37cba10ff3c431eb4aa67771122e3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fcommit%2F457b859450a37cba10ff3c431eb4aa67771122e3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=QuorumDMS%2Fftp-srv)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[QuorumDMS](/QuorumDMS)
/
**[ftp-srv](/QuorumDMS/ftp-srv)**
Public

* [Notifications](/login?return_to=%2FQuorumDMS%2Fftp-srv) You must be signed in to change notification settings
* [Fork
  117](/login?return_to=%2FQuorumDMS%2Fftp-srv)
* [Star
   390](/login?return_to=%2FQuorumDMS%2Fftp-srv)

* [Code](/QuorumDMS/ftp-srv)
* [Issues
  37](/QuorumDMS/ftp-srv/issues)
* [Pull requests
  16](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects
  0](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

Additional navigation options

* [Code](/QuorumDMS/ftp-srv)
* [Issues](/QuorumDMS/ftp-srv/issues)
* [Pull requests](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

## Commit

[Permalink](/QuorumDMS/ftp-srv/commit/457b859450a37cba10ff3c431eb4aa67771122e3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix(fs): check resolved path against root ([#224](https://github.com/QuorumDMS/ftp-srv/pull/224))

[Browse files](/QuorumDMS/ftp-srv/tree/457b859450a37cba10ff3c431eb4aa67771122e3)
Browse the repository at this point in the history

```
* fix(fs): check resolved path against root

This should prevent paths from being resolved above the root.

Should affect all commands that utilize the FS functions.

Fixes [#167](https://github.com/QuorumDMS/ftp-srv/issues/167)

* test: use __dirname for relative certs

* fix: improve path resolution

* chore: remove unused package

* fix: normalize resolve path if absolute

Otherwise join will normalize

Co-authored-by: Tyler Stewart <tyler@autovance.com>
```

* Loading branch information

Matt Forster
and
Tyler Stewart
authored
Dec 16, 2020

1 parent
[722da60](/QuorumDMS/ftp-srv/commit/722da60a82a63538357f5022827b3f01f5f4249b)

commit 457b859

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**52 additions**
and
**20 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/fs.js
    [fs.js](#diff-3759f6cbb25e017ab6bafb3b268312c252fc803c2c0d9df9f56c2bcce7c71a3f)
* test

  + test/fs.spec.js
    [fs.spec.js](#diff-eabc3e9f0ac8017bf95b7a8c8ce4d63991ce17c3b0ebc532953ac57ed66a8cb1)
  + test/start.js
    [start.js](#diff-50afca92e6fafab43ea7b0184cb4c1ad984739c7c378ef2bac68451ff0c266a7)

## There are no files selected for viewing

33 changes: 19 additions & 14 deletions

33
[src/fs.js](#diff-3759f6cbb25e017ab6bafb3b268312c252fc803c2c0d9df9f56c2bcce7c71a3f "src/fs.js")

Show comments

[View file](/QuorumDMS/ftp-srv/blob/457b859450a37cba10ff3c431eb4aa67771122e3/src/fs.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,10 +6,13 @@ const {createReadStream, createWriteStream, constants} = require('fs'); |
|  |  | const fsAsync = require('./helpers/fs-async'); |
|  |  | const errors = require('./errors'); |
|  |  |  |
|  |  | const UNIX\_SEP\_REGEX = /\//g; |
|  |  | const WIN\_SEP\_REGEX = /\\/g; |
|  |  |  |
|  |  | class FileSystem { |
|  |  | constructor(connection, {root, cwd} = {}) { |
|  |  | this.connection = connection; |
|  |  | this.cwd = nodePath.normalize(cwd ? nodePath.join(nodePath.sep, cwd) : nodePath.sep); |
|  |  | this.cwd = nodePath.normalize((cwd || '/').replace(WIN\_SEP\_REGEX, '/')); |
|  |  | this.\_root = nodePath.resolve(root || process.cwd()); |
|  |  | } |
|  |  |  |
| Expand All | | @@ -18,19 +21,21 @@ class FileSystem { |
|  |  | } |
|  |  |  |
|  |  | \_resolvePath(path = '.') { |
|  |  | const clientPath = (() => { |
|  |  | path = nodePath.normalize(path); |
|  |  | if (nodePath.isAbsolute(path)) { |
|  |  | return nodePath.join(path); |
|  |  | } else { |
|  |  | return nodePath.join(this.cwd, path); |
|  |  | } |
|  |  | })(); |
|  |  |  |
|  |  | const fsPath = (() => { |
|  |  | const resolvedPath = nodePath.join(this.root, clientPath); |
|  |  | return nodePath.resolve(nodePath.normalize(nodePath.join(resolvedPath))); |
|  |  | })(); |
|  |  | // Unix separators normalize nicer on both unix and win platforms |
|  |  | const resolvedPath = path.replace(WIN\_SEP\_REGEX, '/'); |
|  |  |  |
|  |  | // Join cwd with new path |
|  |  | const joinedPath = nodePath.isAbsolute(resolvedPath) |
|  |  | ? nodePath.normalize(resolvedPath) |
|  |  | : nodePath.join('/', this.cwd, resolvedPath); |
|  |  |  |
|  |  | // Create local filesystem path using the platform separator |
|  |  | const fsPath = nodePath.resolve(nodePath.join(this.root, joinedPath) |
|  |  | .replace(UNIX\_SEP\_REGEX, nodePath.sep) |
|  |  | .replace(WIN\_SEP\_REGEX, nodePath.sep)); |
|  |  |  |
|  |  | // Create FTP client path using unix separator |
|  |  | const clientPath = joinedPath.replace(WIN\_SEP\_REGEX, '/'); |
|  |  |  |
|  |  | return { |
|  |  | clientPath, |
| Expand Down | |  |

31 changes: 29 additions & 2 deletions

31
[test/fs.spec.js](#diff-eabc3e9f0ac8017bf95b7a8c8ce4d63991ce17c3b0ebc532953ac57ed66a8cb1 "test/fs.spec.js")

Show comments

[View file](/QuorumDMS/ftp-srv/blob/457b859450a37cba10ff3c431eb4aa67771122e3/test/fs.spec.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,7 +36,7 @@ describe('FileSystem', function () { |
|  |  |  |
|  |  | describe('#\_resolvePath', function () { |
|  |  | it('gets correct relative path', function () { |
|  |  | const result = fs.\_resolvePath(); |
|  |  | const result = fs.\_resolvePath('.'); |
|  |  | expect(result).to.be.an('object'); |
|  |  | expect(result.clientPath).to.equal( |
|  |  | nodePath.normalize('/file/1/2/3')); |
| Expand All | | @@ -53,6 +53,15 @@ describe('FileSystem', function () { |
|  |  | nodePath.resolve('/tmp/ftp-srv/file/1/2')); |
|  |  | }); |
|  |  |  |
|  |  | it('gets correct relative path', function () { |
|  |  | const result = fs.\_resolvePath('other'); |
|  |  | expect(result).to.be.an('object'); |
|  |  | expect(result.clientPath).to.equal( |
|  |  | nodePath.normalize('/file/1/2/3/other')); |
|  |  | expect(result.fsPath).to.equal( |
|  |  | nodePath.resolve('/tmp/ftp-srv/file/1/2/3/other')); |
|  |  | }); |
|  |  |  |
|  |  | it('gets correct absolute path', function () { |
|  |  | const result = fs.\_resolvePath('/other'); |
|  |  | expect(result).to.be.an('object'); |
| Expand All | | @@ -62,7 +71,7 @@ describe('FileSystem', function () { |
|  |  | nodePath.resolve('/tmp/ftp-srv/other')); |
|  |  | }); |
|  |  |  |
|  |  | it('cannot escape root', function () { |
|  |  | it('cannot escape root - unix', function () { |
|  |  | const result = fs.\_resolvePath('../../../../../../../../../../..'); |
|  |  | expect(result).to.be.an('object'); |
|  |  | expect(result.clientPath).to.equal( |
| Expand All | | @@ -71,6 +80,24 @@ describe('FileSystem', function () { |
|  |  | nodePath.resolve('/tmp/ftp-srv')); |
|  |  | }); |
|  |  |  |
|  |  | it('cannot escape root - win', function () { |
|  |  | const result = fs.\_resolvePath('.\\..\\..\\..\\..\\..\\..\\'); |
|  |  | expect(result).to.be.an('object'); |
|  |  | expect(result.clientPath).to.equal( |
|  |  | nodePath.normalize('/')); |
|  |  | expect(result.fsPath).to.equal( |
|  |  | nodePath.resolve('/tmp/ftp-srv')); |
|  |  | }); |
|  |  |  |
|  |  | it('cannot escape root - backslash prefix', function () { |
|  |  | const result = fs.\_resolvePath('\\/../../../../../../'); |
|  |  | expect(result).to.be.an('object'); |
|  |  | expect(result.clientPath).to.equal( |
|  |  | nodePath.normalize('/')); |
|  |  | expect(result.fsPath).to.equal( |
|  |  | nodePath.resolve('/tmp/ftp-srv')); |
|  |  | }); |
|  |  |  |
|  |  | it('resolves to file', function () { |
|  |  | const result = fs.\_resolvePath('/cool/file.txt'); |
|  |  | expect(result).to.be.an('object'); |
| Expand Down | |  |

8 changes: 4 additions & 4 deletions

8
[test/start.js](#diff-50afca92e6fafab43ea7b0184cb4c1ad984739c7c378ef2bac68451ff0c266a7 "test/start.js")

Show comments

[View file](/QuorumDMS/ftp-srv/blob/457b859450a37cba10ff3c431eb4aa67771122e3/test/start.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -9,16 +9,16 @@ const server = new FtpServer({ |
|  |  | pasv\_min: 8881, |
|  |  | greeting: ['Welcome', 'to', 'the', 'jungle!'], |
|  |  | tls: { |
|  |  | key: fs.readFileSync(`${process.cwd()}/test/cert/server.key`), |
|  |  | cert: fs.readFileSync(`${process.cwd()}/test/cert/server.crt`), |
|  |  | ca: fs.readFileSync(`${process.cwd()}/test/cert/server.csr`) |
|  |  | key: fs.readFileSync(`${\_\_dirname}/cert/server.key`), |
|  |  | cert: fs.readFileSync(`${\_\_dirname}/cert/server.crt`), |
|  |  | ca: fs.readFileSync(`${\_\_dirname}/cert/server.csr`) |
|  |  | }, |
|  |  | file\_format: 'ep', |
|  |  | anonymous: 'sillyrabbit' |
|  |  | }); |
|  |  | server.on('login', ({username, password}, resolve, reject) => { |
|  |  | if (username === 'test' && password === 'test' || username === 'anonymous') { |
|  |  | resolve({root: require('os').homedir()}); |
|  |  | resolve({root: \_\_dirname}); |
|  |  | } else reject('Bad username or password'); |
|  |  | }); |
|  |  | server.listen(); |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `457b859`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fcommit%2F457b859450a37cba10ff3c431eb4aa67771122e3) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_647e9540_20250119_140444.html ===
�PNG

   
IHDR  �  �   �.�b  �IDATx��ױћ@FQ�C�U(P(93[�3W��tϩ�K����Z� ���� ��� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� ����szE��3=�\v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� �� ���'�K�qNO�.\v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$���M�^�㜞 ?�֚��]|e���gz��$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$���ZkMox��8�'P��?�i���|ه��\_��@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�k�5��ǹ���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A쀄?  ��(Y吝�    IEND�B`�

=== Content from www.npmjs.com_bb064ddd_20250119_122636.html ===

skip to:[content](#main)[package search](#search)[sign in](#signin)â¤

* [Pro](/products/pro)
* [Teams](/products/teams)
* [Pricing](/products)
* [Documentation](https://docs.npmjs.com)
npmSearch[Sign Up](/signup)[Sign In](/login)
## ftp-srvTypeScript icon, indicating that this package has built-in type declarations

4.6.3Â â¢Â PublicÂ â¢Â Published a year ago

* [Readme](?activeTab=readme)
* [Code Beta](?activeTab=code)
* [7 Dependencies](?activeTab=dependencies)
* [28 Dependents](?activeTab=dependents)
* [72 Versions](?activeTab=versions)

[![ftp-srv](https://raw.githubusercontent.com/autovance/ftp-srv/HEAD/logo.png)](https://github.com/autovance/ftp-srv)

Modern, extensible FTP Server

[![npm](https://camo.githubusercontent.com/1e27e7f3c91d0148c90d2a0d09a4fff447b50f91accf551c712292acb9430f8e/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f646d2f6674702d7372762e7376673f7374796c653d666f722d7468652d6261646765)](https://www.npmjs.com/package/ftp-srv)
[![circleci](https://camo.githubusercontent.com/ee7b85ac8d4e10f4b164a5e013f4ed74647e72ec9cce2d8ecc83a8cff4ba9222/68747470733a2f2f696d672e736869656c64732e696f2f636972636c6563692f70726f6a6563742f6769746875622f6175746f76616e63652f6674702d7372762f6d61737465722e7376673f7374796c653d666f722d7468652d6261646765)](https://circleci.com/gh/autovance/workflows/ftp-srv/tree/master)

---

## [Overview](#overview)

`ftp-srv` is a modern and extensible FTP server designed to be simple yet configurable.

## [Features](#features)

* Extensible [file systems](#file-system) per connection
* Passive and active transfers
* [Explicit](https://en.wikipedia.org/wiki/FTPS#Explicit) & [Implicit](https://en.wikipedia.org/wiki/FTPS#Implicit) TLS connections
* Promise based API

## [Install](#install)

`npm install ftp-srv --save`

## [Usage](#usage)

```
// Quick start, create an active ftp server.
const FtpSrv = require('ftp-srv');

const port=21;
const ftpServer = new FtpSrv({
    url: "ftp://0.0.0.0:" + port,
    anonymous: true
});

ftpServer.on('login', ({ connection, username, password }, resolve, reject) => {
    if(username === 'anonymous' && password === 'anonymous'){
        return resolve({ root:"/" });
    }
    return reject(new errors.GeneralError('Invalid username or password', 401));
});

ftpServer.listen().then(() => {
    console.log('Ftp server is starting...')
});
```
## [API](#api)

### [`new FtpSrv({options})`](#new-ftpsrvoptions)

#### [url](#url)

[URL string](https://nodejs.org/api/url.html#url_url_strings_and_url_objects) indicating the protocol, hostname, and port to listen on for connections.
Supported protocols:

* `ftp` Plain FTP
* `ftps` Implicit FTP over TLS

*Note:* The hostname must be the external IP address to accept external connections. `0.0.0.0` will listen on any available hosts for server and passive connections.

**Default:** `"ftp://127.0.0.1:21"`

#### [`pasv_url`](#pasv_url)

`FTP-srv` provides an IP address to the client when a `PASV` command is received in the handshake for a passive connection. Reference [PASV verb](https://cr.yp.to/ftp/retr.html#pasv). This can be one of two options:

* A function which takes one parameter containing the remote IP address of the FTP client. This can be useful when the user wants to return a different IP address depending if the user is connecting from Internet or from an LAN address.
  Example:

```
const { networkInterfaces } = require('os');
const { Netmask } = require('netmask');

const nets = networkInterfaces();
function getNetworks() {
   let networks = {};
   for (const name of Object.keys(nets)) {
       for (const net of nets[name]) {
           if (net.family === 'IPv4' && !net.internal) {
               networks[net.address + "/24"] = net.address
           }
       }
   }
   return networks;
}

const resolverFunction = (address) => {
   // const networks = {
   //     '$GATEWAY_IP/32': `${public_ip}`,
   //     '10.0.0.0/8'    : `${lan_ip}`
   // }
   const networks = getNetworks();
   for (const network in networks) {
       if (new Netmask(network).contains(address)) {
           return networks[network];
       }
   }
   return "127.0.0.1";
}

new FtpSrv({pasv_url: resolverFunction});
```

* A static IP address (ie. an external WAN **IP address** that the FTP server is bound to). In this case, only connections from localhost are handled differently returning `127.0.0.1` to the client.

If not provided, clients can only connect using an `Active` connection.

#### [`pasv_min`](#pasv_min)

The starting port to accept passive connections.

**Default:** `1024`

#### [`pasv_max`](#pasv_max)

The ending port to accept passive connections.

The range is then queried for an available port to use when required.

**Default:** `65535`

#### [`greeting`](#greeting)

A human readable array of lines or string to send when a client connects.

**Default:** `null`

#### [`tls`](#tls)

Node [TLS secure context object](https://nodejs.org/api/tls.html#tls_tls_createsecurecontext_options) used for implicit (`ftps` protocol) or explicit (`AUTH TLS`) connections.

**Default:** `false`

#### [`anonymous`](#anonymous)

If true, will allow clients to authenticate using the username `anonymous`, not requiring a password from the user.

Can also set as a string which allows users to authenticate using the username provided.

The `login` event is then sent with the provided username and `@anonymous` as the password.

**Default:** `false`

#### [`blacklist`](#blacklist)

Array of commands that are not allowed.

Response code `502` is sent to clients sending one of these commands.

**Example:** `['RMD', 'RNFR', 'RNTO']` will not allow users to delete directories or rename any files.

**Default:** `[]`

#### [`whitelist`](#whitelist)

Array of commands that are only allowed.

Response code `502` is sent to clients sending any other command.

**Default:** `[]`

#### [`file_format`](#file_format)

Sets the format to use for file stat queries such as `LIST`.

**Default:** `"ls"`

**Allowable values:**

* `ls` [bin/ls format](https://cr.yp.to/ftp/list/binls.html)
* `ep` [Easily Parsed LIST format](https://cr.yp.to/ftp/list/eplf.html)
* `function () {}` A custom function returning a format or promise for one.
  + Only one argument is passed in: a node [file stat](https://nodejs.org/api/fs.html#fs_class_fs_stats) object with additional file `name` parameter

#### [`log`](#log)

A [bunyan logger](https://github.com/trentm/node-bunyan) instance. Created by default.

#### [`timeout`](#timeout)

Sets the timeout (in ms) after that an idle connection is closed by the server

**Default:** `0`

## [CLI](#cli)

`ftp-srv` also comes with a builtin CLI.

```
$ ftp-srv [url] [options]
```

```
$ ftp-srv ftp://0.0.0.0:9876 --root ~/Documents
```
#### [`url`](#url-1)

Set the listening URL.

Defaults to `ftp://127.0.0.1:21`

#### [`--pasv_url`](#--pasv_url)

The hostname to provide a client when attempting a passive connection (`PASV`).

If not provided, clients can only connect using an `Active` connection.

#### [`--pasv_min`](#--pasv_min)

The starting port to accept passive connections.

**Default:** `1024`

#### [`--pasv_max`](#--pasv_max)

The ending port to accept passive connections.

The range is then queried for an available port to use when required.

**Default:** `65535`

#### [`--root` / `-r`](#--root---r)

Set the default root directory for users.

Defaults to the current directory.

#### [`--credentials` / `-c`](#--credentials---c)

Set the path to a json credentials file.

Format:

```
[
  {
    "username": "...",
    "password": "...",
    "root": "..." // Root directory
  },
  ...
]
```
#### [`--username`](#--username)

Set the username for the only user. Do not provide an argument to allow anonymous login.

#### [`--password`](#--password)

Set the password for the given `username`.

#### [`--read-only`](#--read-only)

Disable write actions such as upload, delete, etc.

## [Events](#events)

The `FtpSrv` class extends the [node net.Server](https://nodejs.org/api/net.html#net_class_net_server). Some custom events can be resolved or rejected, such as `login`.

### [`client-error`](#client-error)

```
ftpServer.on('client-error', ({connection, context, error}) => { ... });
```

Occurs when an error arises in the client connection.

`connection` [client class object](https://github.com/autovance/ftp-srv/blob/HEAD/src/connection.js)

`context` string of where the error occurred

`error` error object

### [`disconnect`](#disconnect)

```
ftpServer.on('disconnect', ({connection, id, newConnectionCount}) => { ... });
```

Occurs when a client has disconnected.

`connection` [client class object](https://github.com/autovance/ftp-srv/blob/HEAD/src/connection.js)

`id` string of the disconnected connection id

`id` number of the new connection count (exclusive the disconnected client connection)

### [`closed`](#closed)

```
ftpServer.on('closed', ({}) => { ... });
```

Occurs when the FTP server has been closed.

### [`closing`](#closing)

```
ftpServer.on('closing', ({}) => { ... });
```

Occurs when the FTP server has started closing.

### [`login`](#login)

```
ftpServer.on('login', ({connection, username, password}, resolve, reject) => { ... });
```

Occurs when a client is attempting to login. Here you can resolve the login request by username and password.

`connection` [client class object](https://github.com/autovance/ftp-srv/blob/HEAD/src/connection.js)

`username` string of username from `USER` command

`password` string of password from `PASS` command

`resolve` takes an object of arguments:

* `fs`
  + Set a custom file system class for this connection to use.
  + See [File System](#file-system) for implementation details.
* `root`
  + If `fs` is not provided, this will set the root directory for the connection.
  + The user cannot traverse lower than this directory.
* `cwd`
  + If `fs` is not provided, will set the starting directory for the connection
  + This is relative to the `root` directory.
* `blacklist`
  + Commands that are forbidden for only this connection
* `whitelist`
  + If set, this connection will only be able to use the provided commands

`reject` takes an error object

### [`server-error`](#server-error)

```
ftpServer.on('server-error', ({error}) => { ... });
```

Occurs when an error arises in the FTP server.

`error` error object

### [`RETR`](#retr)

```
connection.on('RETR', (error, filePath) => { ... });
```

Occurs when a file is downloaded.

`error` if successful, will be `null`

`filePath` location to which file was downloaded

### [`STOR`](#stor)

```
connection.on('STOR', (error, fileName) => { ... });
```

Occurs when a file is uploaded.

`error` if successful, will be `null`

`fileName` name of the file that was uploaded

### [`RNTO`](#rnto)

```
connection.on('RNTO', (error, fileName) => { ... });
```

Occurs when a file is renamed.

`error` if successful, will be `null`

`fileName` name of the file that was renamed

## [Supported Commands](#supported-commands)

See the [command registry](https://github.com/autovance/ftp-srv/blob/HEAD/src/commands/registration) for a list of all implemented FTP commands.

## [File System](#file-system)

The default [file system](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js) can be overwritten to use your own implementation.

This can allow for virtual file systems, and more.

Each connection can set it's own file system based on the user.

The default file system is exported and can be extended as needed:

```
const {FtpSrv, FileSystem} = require('ftp-srv');

class MyFileSystem extends FileSystem {
  constructor() {
    super(...arguments);
  }

  get(fileName) {
    ...
  }
}
```

Custom file systems can implement the following variables depending on the developers needs:

### [Methods](#methods)

#### [`currentDirectory()`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L40)

Returns a string of the current working directory

**Used in:** `PWD`

#### [`get(fileName)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L44)

Returns a file stat object of file or directory

**Used in:** `LIST`, `NLST`, `STAT`, `SIZE`, `RNFR`, `MDTM`

#### [`list(path)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L50)

Returns array of file and directory stat objects

**Used in:** `LIST`, `NLST`, `STAT`

#### [`chdir(path)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L67)

Returns new directory relative to current directory

**Used in:** `CWD`, `CDUP`

#### [`mkdir(path)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L114)

Returns a path to a newly created directory

**Used in:** `MKD`

#### [`write(fileName, {append, start})`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L79)

Returns a writable stream

Options:

`append` if true, append to existing file

`start` if set, specifies the byte offset to write to

**Used in:** `STOR`, `APPE`

#### [`read(fileName, {start})`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L90)

Returns a readable stream

Options:

`start` if set, specifies the byte offset to read from

**Used in:** `RETR`

#### [`delete(path)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L105)

Delete a file or directory

**Used in:** `DELE`

#### [`rename(from, to)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L120)

Renames a file or directory

**Used in:** `RNFR`, `RNTO`

#### [`chmod(path)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L126)

Modifies a file or directory's permissions

**Used in:** `SITE CHMOD`

#### [`getUniqueName(fileName)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L131)

Returns a unique file name to write to. Client requested filename available if you want to base your function on it.
**Used in:** `STOU`

## [Contributing](#contributing)

See [CONTRIBUTING.md](https://github.com/autovance/ftp-srv/blob/HEAD/CONTRIBUTING.md).

## [License](#license)

This software is licensed under the MIT Licence. See [LICENSE](https://github.com/autovance/ftp-srv/blob/HEAD/LICENSE).

## [References](#references)

* <https://cr.yp.to/ftp.html>
## Readme

### Keywords

* [ftp](/search?q=keywords:ftp)
* [ftp-server](/search?q=keywords:ftp-server)
* [ftp-srv](/search?q=keywords:ftp-srv)
* [ftp-svr](/search?q=keywords:ftp-svr)
* [ftpd](/search?q=keywords:ftpd)
* [ftpserver](/search?q=keywords:ftpserver)
* [server](/search?q=keywords:server)
## Package Sidebar

### Install

`npm i ftp-srv`

### Repository

[Gitgithub.com/autovance/ftp-srv](https://github.com/autovance/ftp-srv)

### Homepage

[github.com/autovance/ftp-srv#readme](https://github.com/autovance/ftp-srv#readme)

### DownloadsWeekly Downloads

6,497

### Version

4.6.3

### License

MIT

### Unpacked Size

84 kB

### Total Files

62

### Last publish

a year ago

### Collaborators

* [![trs](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci85MDg3NTY5ZWE1NGEyMzQ2MjE2ZDFjOTVhNGZhNTg4ZT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.m-eKiehX8b7kWni0kfkZnW6GzNCCUwnQWfVBFCNOxto "trs")](/~trs)
* [![botovance](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci85Mjc1YTE5YThiZTFiODA5NGQ2MjdmZTIzZDVmYzEyND9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.FqRQeW_jZbYZxmAaeGEgt0BziexXS03tXYEh0no5dKc "botovance")](/~botovance)
[**Try** on RunKit](https://runkit.com/npm/ftp-srv)[**Report** malware](/support?inquire=security&security-inquire=malware&package=ftp-srv&version=4.6.3)
## Footer

### Support

* [Help](https://docs.npmjs.com)
* [Advisories](https://github.com/advisories)
* [Status](http://status.npmjs.org/)
* [Contact npm](/support)
### Company

* [About](/about)
* [Blog](https://github.blog/tag/npm/)
* [Press](/press)
### Terms & Policies

* [Policies](/policies/)
* [Terms of Use](/policies/terms)
* [Code of Conduct](/policies/conduct)
* [Privacy](/policies/privacy)



=== Content from github.com_8d3f2adf_20250119_122632.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fdiscussions%2F225)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fdiscussions%2F225)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fdiscussions_fragments%2Fdiscussion_layout&source=header-repo&source_repo=QuorumDMS%2Fftp-srv)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[QuorumDMS](/QuorumDMS)
/
**[ftp-srv](/QuorumDMS/ftp-srv)**
Public

* [Notifications](/login?return_to=%2FQuorumDMS%2Fftp-srv) You must be signed in to change notification settings
* [Fork
  117](/login?return_to=%2FQuorumDMS%2Fftp-srv)
* [Star
   390](/login?return_to=%2FQuorumDMS%2Fftp-srv)

* [Code](/QuorumDMS/ftp-srv)
* [Issues
  37](/QuorumDMS/ftp-srv/issues)
* [Pull requests
  16](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects
  0](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

Additional navigation options

* [Code](/QuorumDMS/ftp-srv)
* [Issues](/QuorumDMS/ftp-srv/issues)
* [Pull requests](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

# Symlink Resolution #225

[Answered](#discussioncomment-248734)
by
[trs](/trs "trs")

[nfacha](/nfacha)
asked this question in
[Q&A](/QuorumDMS/ftp-srv/discussions/categories/q-a)

[Symlink Resolution](#top)
#225

[![@nfacha](https://avatars.githubusercontent.com/u/8540172?s=40&v=4)
nfacha](/nfacha)

Dec 15, 2020
·
11 comments

[Answered](#discussioncomment-248734)
by
[trs](/trs "trs")

 [Return to top](#top)

Discussion options

# {{title}}

Something went wrong.

Quote reply

## [nfacha](/nfacha) [Dec 15, 2020](#discussion-1080086)

 -

| You can escape root if there is a symlink withing the FTP, so creating a symlink inside the root such as `ln -s / x` will allow you to access the server root |
| --- |

Beta
Was this translation helpful?
Give feedback.

2
 You must be logged in to vote

All reactions

Answered by
[trs](/trs)

[Dec 17, 2020](https://github.com/QuorumDMS/ftp-srv/discussions/225#discussioncomment-248734)

This library enables [creating a custom filesystem](https://github.com/autovance/ftp-srv#file-system), you can use this to enable checking symlinks.

You could overwrite the `_resolvePath` and perform a check there. Here's a quick example, not tested and probably doesn't work, but it gives you the idea.

```
// symlinkCheckingFileSystem.js
const {FileSystem} = require('ftp-srv');
const isPathInside = require('is-path-inside'); // https://github.com/sindresorhus/is-path-inside
const {realPathSync} = require('fs');

module.exports.SymlinkCheckingFileSystem = class SymlinkCheckingFileSystem extends FileSystem {
  constructor() {
    super(...arguments);
  }

  _resolvePath(path) {
    // Let base resolver do it's thing
    const {clientPath, fsPath} = …
```

[View full answer](#discussioncomment-248734)

## Replies: 11 comments

* [Oldest](/QuorumDMS/ftp-srv/discussions/225?sort=old)
* [Newest](/QuorumDMS/ftp-srv/discussions/225?sort=new)
* [Top](/QuorumDMS/ftp-srv/discussions/225?sort=top)

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

### [trs](/trs) [Dec 15, 2020](#discussioncomment-248725)

 -

| Node's `path` module doesn't resolve symlinks, so it won't change the directory that this package is using. Should we disallow `cd`-ing into a symlinked directory? ~~If so adding a `stat.isSymbolicLink()` check to the [`chdir` command](https://github.com/autovance/ftp-srv/blob/master/src/fs.js#L72) would be the place to check.~~ This doesn't take into account cd-ing into `link/dir` as `dir` is not a symlink. |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

All reactions

0 replies

Comment options

# {{title}}

Something went wrong.

Quote reply

### [nfacha](/nfacha) [Dec 15, 2020](#discussioncomment-248726) Author

 -

| Node's `path` module doesn't resolve symlinks, so it won't change the directory that this package is using. Should we disallow `cd`-ing into a symlinked directory? If so adding a `stat.isSymbolicLink()` check to the [`chdir` command](https://github.com/autovance/ftp-srv/blob/master/src/fs.js#L72) would be the place to check.  Im able to navigate thru symlinks using this (and escape root doing so), it should be diisabled by default IMHO |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

All reactions

0 replies

Comment options

# {{title}}

Something went wrong.

Quote reply

### [nfacha](/nfacha) [Dec 16, 2020](#discussioncomment-248727) Author

 -

| Tried making these changes, although im still able to go thru the symlink and escape root with these changes (server on Linux, connecting thru Filezilla), am I missing something obvious?  [image](https://user-images.githubusercontent.com/8540172/102287496-19dca900-3f2a-11eb-8ad0-2acaef54846c.png) Added the check on both the chdir and list commands |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

All reactions

0 replies

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

### [Dec 16, 2020](#discussioncomment-248728)

 -

| Unless the client can create that symlink, the fact that the target folder is a link is a non-issue and should be the same as [#167](https://github.com/QuorumDMS/ftp-srv/issues/167). You wouldn't be able to escape out of the linked folder into *that* location, it would still resolve to the location of the local filesystem.  For example a file system like this;  ``` / - tmp/ -- ftp --- user1/ ---- shared/ _linked to /tmp/link/shared/_ --- user2/ ---- shared/ _linked to /tmp/link/shared/_ -- link/ --- shared/ ---- sites/  ```  and a server setup as:  ``` root = '/tmp/ftp/user2' cwd = '/'  ```  The paths should resolve as; `/` -> `/tmp/ftp/user2` `/shared` -> `/tmp/ftp/user2/shared` linked to `/tmp/link/shared` `/shared/sites/` -> `/tmp/ftp/user2/shared/sites` linked to `/tmp/link/shared/sites` `/shared/sites/../../` -> `/tmp/ftp/user2` (not `/tmp/link/`)  The fact that the FS is setup to *use* symlinks isn't the issue of the library, and I think is legitimate.  [@nfacha](https://github.com/nfacha) Am I describing what is happening here correctly? You are able to say, navigate to `/tmp/link` through the symlink? |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

 👍
1

All reactions

* 👍
  1

0 replies

Comment options

# {{title}}

Something went wrong.

Quote reply

### [matt-forster](/matt-forster) [Dec 16, 2020](#discussioncomment-248729)

 -

| [@nfacha](https://github.com/nfacha) Can you checkout [#224](https://github.com/QuorumDMS/ftp-srv/pull/224) and see if this resolves the issue you are having? |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

All reactions

0 replies

Comment options

# {{title}}

Something went wrong.

Quote reply

### [trs](/trs) [Dec 16, 2020](#discussioncomment-248730)

 -

| Symlinks can still be followed through, but can't escape in the way @forstermatth described above. |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

All reactions

0 replies

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

### [nfacha](/nfacha) [Dec 16, 2020](#discussioncomment-248731) Author

 -

| [@nfacha](https://github.com/nfacha) Can you checkout [#224](https://github.com/QuorumDMS/ftp-srv/pull/224) and see if this resolves the issue you are having?  After checking out [#224](https://github.com/QuorumDMS/ftp-srv/pull/224) i can still escape root on the following setup using FIlezilla User root: /home/fmcs Symlink at /root/fmcs named x created with `ln -s / x`  If I switch into the symlink i can still see the server root and navigate thru the folders (that are outside the user root)  From the PR changes it looks like you are appending the root path on the beginning, this is not enough tho, as going thru a symlink resolves the path with the root on the beginning already, after adding some logging(print out `fsPath` from `_resolvePath`) I can see that if I go thru the symlink to `/x/etc/apt` the path gets resolved to `/home/fmcs/x/etc/apt` and that is technically under the path so it allows me to go in there and I can still escape root, the only solution I can see is to check if any of the directories used on the path is a symlink? |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

All reactions

0 replies

Comment options

# {{title}}

Something went wrong.

Quote reply

### [nfacha](/nfacha) [Dec 16, 2020](#discussioncomment-248732) Author

 -

| I have sent in a PR ([#226](https://github.com/QuorumDMS/ftp-srv/pull/226)) that fixes root escaping thru symlinks.  I don't usually work with node, so you might want to do some adjustments as while it works likely there is a better way to do it. |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

All reactions

0 replies

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

### [matt-forster](/matt-forster) [Dec 16, 2020](#discussioncomment-248733)

 -

| So, at the moment, we are not in agreement that this is an issue this library needs to be responsible for.  My opinion is that, to prevent this issue, do not create the symlink in your filesystem. The library doesn't really take responsibility for the FS that you present to your users.  You are actively creating that symlink and making it available to your user. As an admin, there are legitimate uses for symlinks, and I think it is the server's responsibility to make sure the filesystem you are using is set up correctly. FTP clients cannot create these symlinks, so I don't think there is a security issue here. |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

All reactions

0 replies

Comment options

# {{title}}

Something went wrong.

Quote reply

### [trs](/trs) [Dec 17, 2020](#discussioncomment-248734)

 -

| This library enables [creating a custom filesystem](https://github.com/autovance/ftp-srv#file-system), you can use this to enable checking symlinks.  You could overwrite the `_resolvePath` and perform a check there. Here's a quick example, not tested and probably doesn't work, but it gives you the idea.  ``` // symlinkCheckingFileSystem.js const {FileSystem} = require('ftp-srv'); const isPathInside = require('is-path-inside'); // https://github.com/sindresorhus/is-path-inside const {realPathSync} = require('fs');  module.exports.SymlinkCheckingFileSystem = class SymlinkCheckingFileSystem extends FileSystem {   constructor() {     super(...arguments);   }    _resolvePath(path) {     // Let base resolver do it's thing     const {clientPath, fsPath} = super._resolvePath(path);      // Resolve symlinks in path     const realFsPath = realPathSync(fsPath);         if (isPathInside(realFsPath, this.root)) {        // Oh no, this path escapes root!        throw new Error('Tsk tsk');     }      return {clientPath, fsPath};   } } ```  ``` // index.js const {FtpSrv} = require('ftp-srv'); const {SymlinkCheckingFileSystem} = require('./symlinkCheckingFileSystem.js');  const ftpServer = new FtpSrv();  ftpServer.on('login', (connection, resolve, reject) => {   // ...   resolve({     fs: new SymlinkCheckingFileSystem(connection, {root: '...', cwd: '...'}),     // ...   }); });  // ...  ftpServer.listen() ```  This isn't something we want to do in the base library as `_resolvePath` must work with virtual file systems. Doing this check restricts us to the actual file system. So a custom implementation would suite best. |
| --- |

Beta
Was this translation helpful?
Give feedback.

Marked as answer

1
 You must be logged in to vote

 👍
1

All reactions

* 👍
  1

0 replies

Answer selected by
[matt-forster](/matt-forster)

Comment options

# {{title}}

Something went wrong.

Quote reply

edited

# {{editor}}'s edit

 {{actor}} deleted this content
.

# {{editor}}'s edit

Something went wrong.

### [matt-forster](/matt-forster) [Dec 19, 2020](#discussioncomment-248735)

 -

| [@heartz66](https://github.com/heartz66) Please keep the discussion about symlinks here.  Please take a look at the code of the pterodactyl daemon: [pterodactyl/daemon@208f85c](https://github.com/pterodactyl/daemon/commit/208f85c)/src/controllers/server.js#L579  They use fs.realpathSync to resolve symlinks and get the exact path of the path input. As last measure they check if the result path starts with the root value of the folder. The current measures by ftp-srv do not protect against symlinks.  I'd like some more information as to the relevance of the pterodactyl game server, in regards to resolving symlinks in the context of an extensible FTP server. We have avoided making assumptions around the structure of the filesystem the user wants to expose, which can legitimately include symlinks (see above for an example). It is possible to write a resolution extension (example above) that removes the use of symlinks outside of the defined user root. But as far as we can tell, there is no reason to completely block the use of symlinks. |
| --- |

Beta
Was this translation helpful?
Give feedback.

1
 You must be logged in to vote

All reactions

0 replies

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fdiscussions%2F225)

Category

[🙏

Q&A](/QuorumDMS/ftp-srv/discussions/categories/q-a)

Labels

None yet

3 participants

[![@nfacha](https://avatars.githubusercontent.com/u/8540172?s=48&v=4)](/nfacha) [![@matt-forster](https://avatars.githubusercontent.com/u/3375444?s=48&v=4)](/matt-forster) [![@trs](https://avatars.githubusercontent.com/u/15315657?s=48&v=4)](/trs)

Converted from issue

This discussion was converted from issue #225 on December 28, 2020 20:23.

Heading

Bold

Italic

Quote

Code

Link

---

Numbered list

Unordered list

Task list

---

Attach files

Mention

Reference

Menu

* Heading
* Bold
* Italic
* Quote
* Code
* Link
* Numbered list
* Unordered list
* Task list
* Attach files
* Mention
* Reference

# Select a reply

 Loading

  [Create a new saved reply](/settings/replies?return_to=1)

 👍
1
  reacted with thumbs up emoji

 👎
1
  reacted with thumbs down emoji

 😄
1
  reacted with laugh emoji

 🎉
1
  reacted with hooray emoji

 😕
1
  reacted with confused emoji

 ❤️
1
  reacted with heart emoji

 🚀
1
  reacted with rocket emoji

 👀
1
  reacted with eyes emoji

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d63d56f2_20250119_122634.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fsecurity%2Fadvisories%2FGHSA-pmw4-jgxx-pcq9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fsecurity%2Fadvisories%2FGHSA-pmw4-jgxx-pcq9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=QuorumDMS%2Fftp-srv)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[QuorumDMS](/QuorumDMS)
/
**[ftp-srv](/QuorumDMS/ftp-srv)**
Public

* [Notifications](/login?return_to=%2FQuorumDMS%2Fftp-srv) You must be signed in to change notification settings
* [Fork
  117](/login?return_to=%2FQuorumDMS%2Fftp-srv)
* [Star
   390](/login?return_to=%2FQuorumDMS%2Fftp-srv)

* [Code](/QuorumDMS/ftp-srv)
* [Issues
  37](/QuorumDMS/ftp-srv/issues)
* [Pull requests
  16](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects
  0](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

Additional navigation options

* [Code](/QuorumDMS/ftp-srv)
* [Issues](/QuorumDMS/ftp-srv/issues)
* [Pull requests](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

# File System Bounds Escape

Moderate

[matt-forster](/matt-forster)
published
GHSA-pmw4-jgxx-pcq9
Dec 16, 2020

## Package

npm

ftp-srv
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

<= 4.3.4

## Patched versions

None

## Description

### Impact

Clients of FTP servers utilizing `ftp-srv` hosted on Windows machines can escape the FTP user's defined root folder using the expected FTP commands, for example, `CWD` and `UPDR`.

### Background

When windows separators exist within the path (`\`), `path.resolve` leaves the upper pointers intact and allows the user to move beyond the root folder defined for that user. We did not take that into account when creating the path resolve function.

[![Screen Shot 2020-12-15 at 6 42 52 PM](https://user-images.githubusercontent.com/3375444/102293941-5a75fb80-3f05-11eb-9d71-0c190a8dcc75.png)](https://user-images.githubusercontent.com/3375444/102293941-5a75fb80-3f05-11eb-9d71-0c190a8dcc75.png)

### Patches

None at the moment.

### Workarounds

There are no workarounds for windows servers. Hosting the server on a different OS mitigates the issue.

### References

Issues:

[#167](https://github.com/QuorumDMS/ftp-srv/issues/167)

[#225](https://github.com/QuorumDMS/ftp-srv/discussions/225)

### For more information

If you have any questions or comments about this advisory:

Open an issue at <https://github.com/autovance/ftp-srv>.

Please email us directly; security@autovance.com.

### Severity

Moderate

### CVE ID

CVE-2020-26299

### Weaknesses

No CWEs

### Credits

* [![@n-timofeev](https://avatars.githubusercontent.com/u/71152094?s=40&v=4)](/n-timofeev)
  [n-timofeev](/n-timofeev)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


