=== Content from github.com_3fb9ce87_20250119_115148.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdexidp%2Fdex%2Fcommit%2F324b1c886b407594196113a3dbddebe38eecd4e8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdexidp%2Fdex%2Fcommit%2F324b1c886b407594196113a3dbddebe38eecd4e8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=dexidp%2Fdex)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dexidp](/dexidp)
/
**[dex](/dexidp/dex)**
Public

* [Notifications](/login?return_to=%2Fdexidp%2Fdex) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2Fdexidp%2Fdex)
* [Star
   9.7k](/login?return_to=%2Fdexidp%2Fdex)

* [Code](/dexidp/dex)
* [Issues
  305](/dexidp/dex/issues)
* [Pull requests
  147](/dexidp/dex/pulls)
* [Discussions](/dexidp/dex/discussions)
* [Actions](/dexidp/dex/actions)
* [Projects
  0](/dexidp/dex/projects)
* [Wiki](/dexidp/dex/wiki)
* [Security](/dexidp/dex/security)
* [Insights](/dexidp/dex/pulse)

Additional navigation options

* [Code](/dexidp/dex)
* [Issues](/dexidp/dex/issues)
* [Pull requests](/dexidp/dex/pulls)
* [Discussions](/dexidp/dex/discussions)
* [Actions](/dexidp/dex/actions)
* [Projects](/dexidp/dex/projects)
* [Wiki](/dexidp/dex/wiki)
* [Security](/dexidp/dex/security)
* [Insights](/dexidp/dex/pulse)

## Commit

[Permalink](/dexidp/dex/commit/324b1c886b407594196113a3dbddebe38eecd4e8)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-m9hp-7r99-94h5](https://github.com/advisories/GHSA-m9hp-7r99-94h5 "GHSA-m9hp-7r99-94h5")

[Browse files](/dexidp/dex/tree/324b1c886b407594196113a3dbddebe38eecd4e8)
Browse the repository at this point in the history

```
connector/saml: Validate XML roundtrip data before processing request
```

* Loading branch information

[![@justaugustus](https://avatars.githubusercontent.com/u/567897?s=40&v=4)](/justaugustus)

[justaugustus](/dexidp/dex/commits?author=justaugustus "View all commits by justaugustus")
authored
Dec 14, 2020

2 parents
[6e51768](/dexidp/dex/commit/6e5176822b6ac8489d2392ff5fe93586d9d935d8)
+
[57640cc](/dexidp/dex/commit/57640cc7a9f69ae71ac446449ead377974f3c8b9)

commit 324b1c8

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**24 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* connector/saml

  + connector/saml/saml.go
    [saml.go](#diff-7392ada80e9cb65145fa0a4cc3895623d2e771f342b972438b8405844b864d42)
* go.mod
  [go.mod](#diff-33ef32bf6c23acb95f5902d7097b7a1d5128ca061167ec0716715b0b9eeaa5f6)
* go.sum
  [go.sum](#diff-3295df7234525439d778f1b282d146a4f1ff6b415248aaac074e8042d9f42d63)

## There are no files selected for viewing

9 changes: 8 additions & 1 deletion

9
[connector/saml/saml.go](#diff-7392ada80e9cb65145fa0a4cc3895623d2e771f342b972438b8405844b864d42 "connector/saml/saml.go")

Show comments

[View file](/dexidp/dex/blob/324b1c886b407594196113a3dbddebe38eecd4e8/connector/saml/saml.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -7,14 +7,15 @@ import ( |
|  |  | "encoding/base64" |
|  |  | "encoding/pem" |
|  |  | "encoding/xml" |
|  |  | "errors" |
|  |  | "fmt" |
|  |  | "io/ioutil" |
|  |  | "strings" |
|  |  | "sync" |
|  |  | "time" |
|  |  |  |
|  |  | "github.com/beevik/etree" |
|  |  | xrv "github.com/mattermost/xml-roundtrip-validator" |
|  |  | "github.com/pkg/errors" |
|  |  | dsig "github.com/russellhaering/goxmldsig" |
|  |  | "github.com/russellhaering/goxmldsig/etreeutils" |
|  |  |  |
| Expand Down  Expand Up | | @@ -287,6 +288,7 @@ func (p \*provider) POSTData(s connector.Scopes, id string) (action, value string |
|  |  | // |
|  |  | // The steps taken are: |
|  |  | // |
|  |  | // \* Validate XML document does not contain malicious inputs. |
|  |  | // \* Verify signature on XML document (or verify sig on assertion elements). |
|  |  | // \* Verify various parts of the Assertion element. Conditions, audience, etc. |
|  |  | // \* Map the Assertion's attribute elements to user info. |
| Expand All | | @@ -297,6 +299,11 @@ func (p \*provider) HandlePOST(s connector.Scopes, samlResponse, inResponseTo str |
|  |  | return ident, fmt.Errorf("decode response: %v", err) |
|  |  | } |
|  |  |  |
|  |  | byteReader := bytes.NewReader(rawResp) |
|  |  | if xrvErr := xrv.Validate(byteReader); xrvErr != nil { |
|  |  | return ident, errors.Wrap(xrvErr, "validating XML response") |
|  |  | } |
|  |  |  |
|  |  | // Root element is allowed to not be signed if the Assertion element is. |
|  |  | rootElementSigned := true |
|  |  | if p.validator != nil { |
| Expand Down | |  |

6 changes: 4 additions & 2 deletions

6
[go.mod](#diff-33ef32bf6c23acb95f5902d7097b7a1d5128ca061167ec0716715b0b9eeaa5f6 "go.mod")

Show comments

[View file](/dexidp/dex/blob/324b1c886b407594196113a3dbddebe38eecd4e8/go.mod)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,13 +23,15 @@ require ( |
|  |  | github.com/konsorten/go-windows-terminal-sequences v1.0.2 // indirect |
|  |  | github.com/kylelemons/godebug v1.1.0 |
|  |  | github.com/lib/pq v1.3.0 |
|  |  | github.com/mattermost/xml-roundtrip-validator v0.0.0-20201204154048-1a8688af4cf1 |
|  |  | github.com/mattn/go-sqlite3 v1.11.0 |
|  |  | github.com/pkg/errors v0.9.1 |
|  |  | github.com/pquerna/cachecontrol v0.0.0-20180517163645-1555304b9b35 // indirect |
|  |  | github.com/prometheus/client\_golang v1.4.0 |
|  |  | github.com/russellhaering/goxmldsig v0.0.0-20180430223755-7acd5e4a6ef7 |
|  |  | github.com/russellhaering/goxmldsig v1.1.0 |
|  |  | github.com/sirupsen/logrus v1.4.2 |
|  |  | github.com/spf13/cobra v0.0.5 |
|  |  | github.com/stretchr/testify v1.4.0 |
|  |  | github.com/stretchr/testify v1.6.1 |
|  |  | github.com/testcontainers/testcontainers-go v0.0.9 |
|  |  | github.com/tmc/grpc-websocket-proxy v0.0.0-20190109142713-0ad062ec5ee5 // indirect |
|  |  | go.etcd.io/etcd v0.0.0-20191023171146-3cf2f69b5738 |
| Expand Down | |  |

14 changes: 12 additions & 2 deletions

14
[go.sum](#diff-3295df7234525439d778f1b282d146a4f1ff6b415248aaac074e8042d9f42d63 "go.sum")

Show comments

[View file](/dexidp/dex/blob/324b1c886b407594196113a3dbddebe38eecd4e8/go.sum)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -161,6 +161,8 @@ github.com/inconshreveable/mousetrap v1.0.0 h1:Z8tu5sraLXCXIcARxBp/8cbvlwVa7Z1NH |
|  |  | github.com/inconshreveable/mousetrap v1.0.0/go.mod h1:PxqpIevigyE2G7u3NXJIT2ANytuPF1OarO4DADm73n8= |
|  |  | github.com/jonboulle/clockwork v0.1.0 h1:VKV+ZcuP6l3yW9doeqz6ziZGgcynBVQO+obU0+0hcPo= |
|  |  | github.com/jonboulle/clockwork v0.1.0/go.mod h1:Ii8DK3G1RaLaWxj9trq07+26W01tbo22gdxWY5EU2bo= |
|  |  | github.com/jonboulle/clockwork v0.2.0 h1:J2SLSdy7HgElq8ekSl2Mxh6vrRNFxqbXGenYH2I02Vs= |
|  |  | github.com/jonboulle/clockwork v0.2.0/go.mod h1:Pkfl5aHPm1nk2H9h0bjmnJD/BcgbGXUBGnn1kMkgxc8= |
|  |  | github.com/json-iterator/go v1.1.6/go.mod h1:+SdeFBvtyEkXs7REEP0seUULqWtbJapLOCVDaaPEHmU= |
|  |  | github.com/json-iterator/go v1.1.7 h1:KfgG9LzI+pYjr4xvmz/5H4FXjokeP+rlHLhv3iH62Fo= |
|  |  | github.com/json-iterator/go v1.1.7/go.mod h1:KdQUCv79m/52Kvf8AW2vK1V8akMuk1QjK/uOdHXbAo4= |
| Expand All | | @@ -184,6 +186,8 @@ github.com/kylelemons/godebug v1.1.0/go.mod h1:9/0rRGxNHcop5bhtWyNeEfOS8JIWk580+ |
|  |  | github.com/lib/pq v1.3.0 h1:/qkRGz8zljWiDcFvgpwUpwIAPu3r07TDvs3Rws+o/pU= |
|  |  | github.com/lib/pq v1.3.0/go.mod h1:5WUZQaWbwv1U+lTReE5YruASi9Al49XbQIvNi/34Woo= |
|  |  | github.com/magiconair/properties v1.8.0/go.mod h1:PppfXfuXeibc/6YijjN8zIbojt8czPbwD3XqdrwzmxQ= |
|  |  | github.com/mattermost/xml-roundtrip-validator v0.0.0-20201204154048-1a8688af4cf1 h1:D2uMrH5NnWgU7JdjiWjOg/n31gbPH6I0D3IbCrqVVYE= |
|  |  | github.com/mattermost/xml-roundtrip-validator v0.0.0-20201204154048-1a8688af4cf1/go.mod h1:qccnGMcpgwcNaBnxqpJpWWUiPNr5H3O8eDgGV9gT5To= |
|  |  | github.com/mattn/go-colorable v0.0.9/go.mod h1:9vuHe8Xs5qXnSaW/c/ABM9alt+Vo+STaOChaDxuIBZU= |
|  |  | github.com/mattn/go-isatty v0.0.4/go.mod h1:M+lRXTBqGeGNdLjl/ufCoiOlB5xdOkqRJdNxMWT7Zi4= |
|  |  | github.com/mattn/go-runewidth v0.0.2/go.mod h1:LwmH8dsx7+W8Uxz3IHJYH5QSwggIsqBzpuz5H//U1FU= |
| Expand Down  Expand Up | | @@ -224,6 +228,8 @@ github.com/pelletier/go-toml v1.2.0/go.mod h1:5z9KED0ma1S8pY6P1sdut58dfprrGBbd/9 |
|  |  | github.com/pkg/errors v0.8.0/go.mod h1:bwawxfHBFNV+L2hUp1rHADufV3IMtnDRdf1r5NINEl0= |
|  |  | github.com/pkg/errors v0.8.1 h1:iURUrRGxPUNPdy5/HRSm+Yj6okJ6UtLINN0Q9M4+h3I= |
|  |  | github.com/pkg/errors v0.8.1/go.mod h1:bwawxfHBFNV+L2hUp1rHADufV3IMtnDRdf1r5NINEl0= |
|  |  | github.com/pkg/errors v0.9.1 h1:FEBLx1zS214owpjy7qsBeixbURkuhQAwrK5UwLGTwt4= |
|  |  | github.com/pkg/errors v0.9.1/go.mod h1:bwawxfHBFNV+L2hUp1rHADufV3IMtnDRdf1r5NINEl0= |
|  |  | github.com/pmezard/go-difflib v1.0.0 h1:4DBwDE0NGyQoBHbLQYPwSUPoCMWR5BEzIk/f1lZbAQM= |
|  |  | github.com/pmezard/go-difflib v1.0.0/go.mod h1:iKH77koFhYxTK1pcRnkKkqfTogsbg7gZNVY4sRDYZ/4= |
|  |  | github.com/pquerna/cachecontrol v0.0.0-20180517163645-1555304b9b35 h1:J9b7z+QKAmPf4YLrFg6oQUotqHQeUNWwkvo7jZp1GLU= |
| Expand All | | @@ -249,8 +255,8 @@ github.com/prometheus/procfs v0.0.5/go.mod h1:4A/X28fw3Fc593LaREMrKMqOKvUAntwMDa |
|  |  | github.com/prometheus/procfs v0.0.8 h1:+fpWZdT24pJBiqJdAwYBjPSk+5YmQzYNPYzQsdzLkt8= |
|  |  | github.com/prometheus/procfs v0.0.8/go.mod h1:7Qr8sr6344vo1JqZ6HhLceV9o3AJ1Ff+GxbHq6oeK9A= |
|  |  | github.com/rogpeppe/fastuuid v0.0.0-20150106093220-6724a57986af/go.mod h1:XWv6SoW27p1b0cqNHllgS5HIMJraePCO15w5zCzIWYg= |
|  |  | github.com/russellhaering/goxmldsig v0.0.0-20180430223755-7acd5e4a6ef7 h1:J4AOUcOh/t1XbQcJfkEqhzgvMJ2tDxdCVvmHxW5QXao= |
|  |  | github.com/russellhaering/goxmldsig v0.0.0-20180430223755-7acd5e4a6ef7/go.mod h1:Oz4y6ImuOQZxynhbSXk7btjEfNBtGlj2dcaOvXl2FSM= |
|  |  | github.com/russellhaering/goxmldsig v1.1.0 h1:lK/zeJie2sqG52ZAlPNn1oBBqsIsEKypUUBGpYYF6lk= |
|  |  | github.com/russellhaering/goxmldsig v1.1.0/go.mod h1:QK8GhXPB3+AfuCrfo0oRISa9NfzeCpWmxeGnqEpDF9o= |
|  |  | github.com/russross/blackfriday v1.5.2/go.mod h1:JO/DiYxRf+HjHt06OyowR9PTA263kcR/rfWxYHBV53g= |
|  |  | github.com/satori/go.uuid v1.2.0 h1:0uYX9dsZ2yD7q2RtLRtPSdGDWzjeM3TbMJP9utgA0ww= |
|  |  | github.com/satori/go.uuid v1.2.0/go.mod h1:dA0hQrYB0VpLJoorglMZABFdXlWrHn1NEOzdhQKdks0= |
| Expand Down  Expand Up | | @@ -278,6 +284,8 @@ github.com/stretchr/testify v1.3.0 h1:TivCn/peBQ7UY8ooIcPgZFpTNSz0Q2U6UrFlUfqbe0 |
|  |  | github.com/stretchr/testify v1.3.0/go.mod h1:M5WIy9Dh21IEIfnGCwXGc5bZfKNJtfHm1UVUgZn+9EI= |
|  |  | github.com/stretchr/testify v1.4.0 h1:2E4SXV/wtOkTonXsotYi4li6zVWxYlZuYNCXe9XRJyk= |
|  |  | github.com/stretchr/testify v1.4.0/go.mod h1:j7eGeouHqKxXV5pUuKE4zz7dFj8WfuZ+81PSLYec5m4= |
|  |  | github.com/stretchr/testify v1.6.1 h1:hDPOHmpOpP40lSULcqw7IrRb/u7w6RpDC9399XyoNd0= |
|  |  | github.com/stretchr/testify v1.6.1/go.mod h1:6Fq8oRcR53rry900zMqJjRRixrwX3KX962/h/Wwjteg= |
|  |  | github.com/syndtr/gocapability v0.0.0-20170704070218-db04d3cc01c8/go.mod h1:hkRG7XYTFWNJGYcbNJQlaLq0fg1yr4J4t/NcTQtrfww= |
|  |  | github.com/testcontainers/testcontainers-go v0.0.9 h1:mwvFz+FkuQMqQ9oLkG4cVzPsZTRmrCo2NcaerJNaptA= |
|  |  | github.com/testcontainers/testcontainers-go v0.0.9/go.mod h1:0Qe9qqjNZgxHzzdHPWwmQ2D49FFO7920hLdJ4yUJXJI= |
| Expand Down  Expand Up | | @@ -443,6 +451,8 @@ gopkg.in/yaml.v2 v2.2.2/go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI= |
|  |  | gopkg.in/yaml.v2 v2.2.4/go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI= |
|  |  | gopkg.in/yaml.v2 v2.2.5 h1:ymVxjfMaHvXD8RqPRmzHHsB3VvucivSkIAvJFDI5O3c= |
|  |  | gopkg.in/yaml.v2 v2.2.5/go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI= |
|  |  | gopkg.in/yaml.v3 v3.0.0-20200313102051-9f266ea9e77c h1:dUUwHk2QECo/6vqA44rthZ8ie2QXMNeKRTHCNY2nXvo= |
|  |  | gopkg.in/yaml.v3 v3.0.0-20200313102051-9f266ea9e77c/go.mod h1:K4uyk7z7BCEPqu6E+C64Yfv1cQ7kz7rIZviUmN+EgEM= |
|  |  | gotest.tools v0.0.0-20181223230014-1083505acf35/go.mod h1:R//lfYlUuTOTfblYI3lGoAAAebUdzjvbmQsuB7Ykd90= |
|  |  | gotest.tools v2.2.0+incompatible h1:VsBPFP1AI068pPrMxtb/S8Zkgf9xEmTLJjfM+P5UIEo= |
|  |  | gotest.tools v2.2.0+incompatible/go.mod h1:DsYFclhRJ6vuDpmuTbkuFWG+y2sxOXAzmJt81HFBacw= |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `324b1c8`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdexidp%2Fdex%2Fcommit%2F324b1c886b407594196113a3dbddebe38eecd4e8) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f46c8c04_20250119_115152.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmattermost%2Fxml-roundtrip-validator%2Fblob%2Fmaster%2Fadvisories%2Funstable-elements.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmattermost%2Fxml-roundtrip-validator%2Fblob%2Fmaster%2Fadvisories%2Funstable-elements.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=mattermost%2Fxml-roundtrip-validator)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mattermost](/mattermost)
/
**[xml-roundtrip-validator](/mattermost/xml-roundtrip-validator)**
Public

* [Notifications](/login?return_to=%2Fmattermost%2Fxml-roundtrip-validator) You must be signed in to change notification settings
* [Fork
  17](/login?return_to=%2Fmattermost%2Fxml-roundtrip-validator)
* [Star
   80](/login?return_to=%2Fmattermost%2Fxml-roundtrip-validator)

* [Code](/mattermost/xml-roundtrip-validator)
* [Issues
  0](/mattermost/xml-roundtrip-validator/issues)
* [Pull requests
  0](/mattermost/xml-roundtrip-validator/pulls)
* [Actions](/mattermost/xml-roundtrip-validator/actions)
* [Projects
  0](/mattermost/xml-roundtrip-validator/projects)
* [Security](/mattermost/xml-roundtrip-validator/security)
* [Insights](/mattermost/xml-roundtrip-validator/pulse)

Additional navigation options

* [Code](/mattermost/xml-roundtrip-validator)
* [Issues](/mattermost/xml-roundtrip-validator/issues)
* [Pull requests](/mattermost/xml-roundtrip-validator/pulls)
* [Actions](/mattermost/xml-roundtrip-validator/actions)
* [Projects](/mattermost/xml-roundtrip-validator/projects)
* [Security](/mattermost/xml-roundtrip-validator/security)
* [Insights](/mattermost/xml-roundtrip-validator/pulse)

## Files

 master
## Breadcrumbs

1. [xml-roundtrip-validator](/mattermost/xml-roundtrip-validator/tree/master)
2. /[advisories](/mattermost/xml-roundtrip-validator/tree/master/advisories)
/
# unstable-elements.md

Copy path Blame  Blame
## Latest commit

## History

[History](/mattermost/xml-roundtrip-validator/commits/master/advisories/unstable-elements.md)25 lines (16 loc) · 2.05 KB master
## Breadcrumbs

1. [xml-roundtrip-validator](/mattermost/xml-roundtrip-validator/tree/master)
2. /[advisories](/mattermost/xml-roundtrip-validator/tree/master/advisories)
/
# unstable-elements.md

Top
## File metadata and controls

* Preview
* Code
* Blame

25 lines (16 loc) · 2.05 KB[Raw](https://github.com/mattermost/xml-roundtrip-validator/raw/refs/heads/master/advisories/unstable-elements.md)
# Security Advisory: XML element instability in Go's `encoding/xml`

| Affected component | Package `encoding/xml` in Go |
| --- | --- |
| Affected versions | All |
| CVE-ID | CVE-2020-29511 |
| Weakness | CWE-115: Misinterpretation of Input |
| CVSS rating | 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |

## Description

Go's `encoding/xml` handles namespace prefixes on XML elements in a way that causes crafted markup to mutate during round-trips through the `xml.Decoder` and `xml.Encoder` implementations. Encoding and decoding using Go's `encoding/xml` can change the observed namespace as well as the observed local name of a maliciously crafted XML element.

Affected applications include software that relies on XML integrity for security-sensitive decisions. Prominent examples of such applications include SAML and XML-DSig implementations.

## Impact

Mutations caused by encoding round-trips can lead to incorrect or conflicting decisions in affected applications. Equivalent lookups within an XML document can return different results during different stages of the document's lifecycle. Attempting to validate the structure of an XML document can succeed or fail depending on the number of encoding round-trips it has gone through.

As a specific example, an affected SAML implementation can interpret a SAML Assertion as signed, but then proceed to read values from an unsigned part of the same document due to namespace mutations between signature verification and data access. This can lead to full authentication bypass and arbitrary privilege escalation within the scope of a SAML Service Provider.

## Workaround

The `github.com/mattermost/xml-roundtrip-validator` module can detect unstable constructs in an XML document, including unstable element namespace prefixes. Invoking the validator on all untrusted markup and failing early if it returns an error can prevent these types of issue from being exploited in an otherwise affected application.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from mattermost.com_377f9533_20250119_115153.html ===


[Skip to content](#skip-nav-target)
[![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/mattermost-logo-horizontal.svg)](https://mattermost.com/)

* Platform

  Platform

  + [Overview](https://mattermost.com/platform-overview/)
  + [Channels](https://mattermost.com/channels/)
  + [Playbooks](https://mattermost.com/playbooks/)
  + [Integrations](https://mattermost.com/integrations-overview/)
  + [Mobile](https://mattermost.com/mobile/)
  + [AI](https://mattermost.com/copilot/)
  + [Security](https://mattermost.com/security/)
  + [Trust Center](https://trust.mattermost.com/)

  Interoperability

  + [MS Teams](https://mattermost.com/solutions/mattermost-for-microsoft-teams/)
  + [Atlassian](https://mattermost.com/atlassian/)
  + [GitLab](https://mattermost.com/solutions/mattermost-gitlab/)

  Flexible Deployment

  + [On-Premise](https://mattermost.com/enterprise/on-prem/)
  + [Cloud](https://mattermost.com/enterprise/cloud/)
* Solutions

  Use Cases

  + [Integrated Security Operations](https://mattermost.com/solutions/use-cases/integrated-security-operations/)
  + [Out-of-Band Incident Response](https://mattermost.com/solutions/use-cases/out-of-band-incident-response/)
  + [Self-Sovereign Collaboration](https://mattermost.com/solutions/use-cases/self-sovereign-collaboration/)
  + [Mission-Critical ChatOps](https://mattermost.com/solutions/use-cases/mission-critical-chatops/)
  + [Real-Time DevSecOps Collaboration](https://mattermost.com/solutions/use-cases/devsecops-collaboration/)
  + [Purpose-Built Collaboration Hub](https://mattermost.com/solutions/use-cases/purpose-built-collaboration/)

  Industries

  + [Critical Infrastructure](https://mattermost.com/solutions/industries/critical-infrastructure/)
  + [Defense](https://mattermost.com/solutions/industries/defense/)
  + [Technology](https://mattermost.com/solutions/industries/technology/)
  + [Global Public Sector](https://mattermost.com/solutions/industries/government/)
  + [Financial Services](https://mattermost.com/solutions/industries/financial-services/)
  + [Energy and Utilities](https://mattermost.com/solutions/industries/energy-and-utilities/)
  + [Manufacturing](https://mattermost.com/solutions/industries/manufacturing/)
* Customers

  Customers

  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-usaf.png)
    USAF](https://mattermost.com/customers/us-department-of-defense/)
  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-fujitsu.png)
    Fujitsu](https://mattermost.com/customers/fujitsu/)
  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-rte.png)
    RTE](https://mattermost.com/customers/rte/)
  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-cern.png)
    CERN](https://mattermost.com/customers/cern/)
  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-nri.png)
    NRI](https://mattermost.com/customers/nri/)
  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-pramacom.png)
    Pramacom](https://mattermost.com/customers/pramacom/)
  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-crossover.png)
    Crossover Health](https://mattermost.com/customers/crossover-health/)
  + [![](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/header/logos/nav-logo-icon-netfoundry.png)
    Netfoundry](https://mattermost.com/customers/netfoundry/)

  [See more customer stories »](https://mattermost.com/customers/)
* [Pricing](https://mattermost.com/pricing/)
* Partners

  Partners

  + [Become a Partner](https://support.mattermost.com/hc/en-us/requests/new?ticket_form_id=24278352368532)
  + [Partner Program](https://mattermost.com/partners/)
  + [Deal Registration](https://mattermost.com/reseller-deal-registration/)
* Resources

  Resources

  + [Resource Library](https://mattermost.com/resources/)
  + [Blog](https://mattermost.com/blog/)
  + [Demos](https://mattermost.com/resources/?filter=demos)
  + [Events](https://mattermost.com/events/)

  Documentation

  + [Academy](https://academy.mattermost.com/)
  + [Channels Guide](https://docs.mattermost.com/guides/channels.html)
  + [Playbooks Guide](https://docs.mattermost.com/guides/repeatable-processes.html)
  + [Admin](https://docs.mattermost.com/guides/administration.html)
  + [Docs](https://docs.mattermost.com/)
  + [API Reference](https://api.mattermost.com/)
  + [Release Notes](https://docs.mattermost.com/administration/changelog.html)

  Community

  + [Join Community](https://mattermost.com/community/)
  + [Contribute](https://mattermost.com/contribute/)
  + [Deploy](https://mattermost.com/download/)
  + [Integrate](https://developers.mattermost.com/integrate/getting-started/)
  + [Download](https://mattermost.com/download/)
* Login

  Login

  + [My Workspace](https://customers.mattermost.com/cloud/connect-workspace)
  + [Admin Portal](https://customers.mattermost.com/login/)
  + [Apps](https://mattermost.com/download/)
  + [Support](https://support.mattermost.com/hc/en-us/)
* [Talk to an Expert](https://mattermost.com/contact-sales/)

![Engineering](https://mattermost.com/wp-content/uploads/2021/09/Mattermost_Blog_Engineering@2x.webp)
# Coordinated disclosure of XML round-trip vulnerabilities in Go’s standard library

[Juho Forsén](https://mattermost.com/blog/author/juho-forsen/ "Posts by Juho Forsén")

December 14, 2020

[Engineering](https://mattermost.com/blog/category/engineering/)

This blog post is a part of Mattermost’s public disclosure of three serious vulnerabilities in Go’s `encoding/xml` related to tokenization round-trips. The public disclosure comes as a result of several months of work, including collaborating with the Go security team since August 2020 and with affected downstream project maintainers since earlier this month. There are several potential security problems created by these vulnerabilities, one of which is a complete bypass of SAML authentication.

**These issues do not impact Mattermost customers.** See [“No impact to Mattermost customers”](#no-impact-to-mattermost-customers) below for more info.

Despite significant efforts by the Go security team, it has not been possible to patch the vulnerabilities discussed in this blog post. Only one of the three is on the roadmap to be patched in the foreseeable future (see [“Update 12/13/2020” below](#update)). The mitigation for the remaining issues will be adding a new mode in Go to make explicit that these vulnerabilities exist. Downstream projects that assume certain integrity guarantees from Go’s standard library are vulnerable when those guarantees do not hold. The implications of these vulnerabilities in key use cases we have identified present a material security concern. If you maintain a Go-based project that relies on XML integrity, we urge you to read this post carefully.

We don’t take this type of public disclosure lightly, and it has not been an easy decision to make. There are three reasons why we are doing this now:

* The Go security team has determined that the root causes of the vulnerabilities cannot be reliably addressed.
* Go is introducing publicly-visible API changes related to these issues in an upcoming major release, which risks making the vulnerabilities public without explicit public disclosure.
  + The Go security team has agreed to Mattermost coordinating disclosure prior to making their changes public in order to minimize impact to parts of the ecosystem that can’t benefit from the new API. Refer to the [“Upcoming changes in Go”](#upcoming-changes-in-go) section for details.
* Careful steps have been taken to privately disclose the issues to as many affected parties as possible prior to proceeding with public disclosure. All parties involved in the disclosure have collaborated to ensure mitigations are in place and sufficient.

## The vulnerabilities

As part of our security work, we have identified three independently exploitable vulnerabilities in Go’s `encoding/xml`. The advisories are linked below:

* [CVE-2020-29509: XML attribute instability in Go’s encoding/xml](https://github.com/mattermost/xml-roundtrip-validator/blob/master/advisories/unstable-attributes.md)
* [CVE-2020-29510: XML directive instability in Go’s encoding/xml](https://github.com/mattermost/xml-roundtrip-validator/blob/master/advisories/unstable-directives.md)
* [CVE-2020-29511: XML element instability in Go’s encoding/xml](https://github.com/mattermost/xml-roundtrip-validator/blob/master/advisories/unstable-elements.md)

As evident from the titles, the vulnerabilities are closely related. The core issue is the same in all three: maliciously crafted XML markup mutates during round-trips through Go’s decoder and encoder implementations.

What does that mean in practice? If your application processes XML and, while processing it, parses markup that’s the output of at least one preceding round of parsing and serialization, you can no longer assume the output of that parsing matches the output from the preceding round. In other words, passing XML through Go’s decoder and encoder doesn’t preserve its semantics.

This may sound like a non-issue or a source of functional bugs at worst, but the reality of it is much more serious. There are applications that absolutely require semantic integrity in XML in order to be secure — a major example being SAML.

SAML, or the Security Assertion Markup Language, is an XML-based standard approach to single sign-on on the web. It conveys user identity in XML documents whose integrity and authenticity are guaranteed using cryptographic signatures, a scheme called XML-DSig. Because of these vulnerabilities, Go-based SAML implementations are in many cases open to tampering by an attacker: by injecting malicious markup to a correctly signed SAML message, it’s possible to make it still appear correctly signed, but change its semantics to convey a different identity than the original document.

The actual impact of these XML round-trip vulnerabilities of course varies by use case, but in SAML SSO it’s easy to understand: if your SAML messages can be altered to say you’re someone you’re not, the result is arbitrary privilege escalation within the scope of the SAML Service Provider, or in some cases even complete authentication bypass.

As mentioned before, despite significant efforts by the Go security team, there is no Go patch that would reasonably address these vulnerabilities. That doesn’t mean all hope is lost: Along with the public disclosure of these vulnerabilities, we’re open-sourcing an XML validation library that can be used as a workaround. The library as well as basic instructions for its use can be found at [github.com/mattermost/xml-roundtrip-validator](https://github.com/mattermost/xml-roundtrip-validator).

## No impact to Mattermost customers

At the time this public disclosure is taking place, no supported versions of Mattermost products are affected by any of the vulnerabilities. Any impact to Mattermost software has been addressed independently prior to this disclosure and communicated to customers according to Mattermost’s standard disclosure policy. **No action is required from Mattermost customers at this time.**

Mattermost staff originally detected the first one of these vulnerabilities during an internal security review on the 28th of August, 2020. As an immediate response the only affected feature of Mattermost server, a new SAML implementation still in beta at the time, was forcefully disabled. The update was rolled out to customers [in a dot release on the 3rd of September](https://docs.mattermost.com/administration/changelog.html#release-v5-26-feature-release). Mattermost Cloud was not generally available at that time, and so was never affected.

The affected SAML implementation was available as a non-default configuration in Mattermost server versions from 5.20.0 up to and including 5.26.1. Mattermost deployments were only vulnerable if all of the following were simultaneously true:

* The server was running a version between 5.20.0 and 5.26.1, released before September 2020. This excludes Extended Support Releases 5.25.5 and above.
* The server was configured to use SAML SSO authentication.
* The setting “Use Improved SAML Library (Beta)” had been explicitly enabled by an administrator.

Details of the security release addressing these vulnerabilities can be found on the [Mattermost Security Updates page](https://mattermost.com/security-updates/) under the identifier MMSA-2020-0030.

Since the September dot release, Mattermost products have not been vulnerable. We have no evidence of this issue being ever exploited.

## Impact to the Go ecosystem

We have identified three major open source SAML implementations affected by the Go XML round-trip vulnerabilities: [Dex SAML Connector](https://dexidp.io/docs/connectors/saml/), [github.com/crewjam/saml](https://github.com/crewjam/saml), and [github.com/russellhaering/gosaml2](https://github.com/russellhaering/gosaml2). The maintainers of all three projects were included in private embargoed disclosure prior to publishing any details. Maintainers were also given advance access to the github.com/mattermost/xml-roundtrip-validator repository.

Patches are available in the following releases:

* [Dex IDP version 2.27.0](https://github.com/dexidp/dex/releases)
* [github.com/crewjam/saml version 0.4.3](https://github.com/crewjam/saml/releases)
* [github.com/russellhaering/gosaml2 version 0.6.0](https://github.com/russellhaering/gosaml2/tags)

We have also privately reached out to maintainers of significant applications and products that depend on these SAML implementations and given them an advance warning of today’s disclosure without revealing technical details.

Having an idea of the scale and range of affected products may help in understanding why we’ve gone to such lengths in coordinating this. We reached out to a total of 20 companies and projects in addition to the maintainers of the SAML implementations named above. The affected products include:

* A variety of cloud orchestration tools
* Security products from DFIR to secure access and endpoint management
* A commercial IAM solution from a major cloud hosting company
* Multiple web software frameworks
* Hardware root of trust APIs
* Well-known SaaS products

If you find yourself among the organizations we contacted, we urge you to start patching immediately.

It’s unlikely that we found all affected use cases, libraries, and products, and we may have missed even major ones. Even if you didn’t hear from us but suspect your particular use case of encoding/xml may be affected, please consider reviewing your codebase for vulnerable patterns.

## Upcoming changes in Go

The Go security team is planning changes to `encoding/xml` that address round-trip vulnerabilities by deprecating existing behaviors from a security perspective. A new API is expected to land in Go 1.16 that will allow disabling namespace prefix parsing entirely. The current functionality will remain available, but it will no longer be considered secure for use cases that require round-trip stability; Go will stop accepting vulnerability submissions related to its behavior.

The Go security team has chosen this path after determining that the `encoding/xml` package and its data structures were not designed to make safe round-trips possible. The new API allows them to lower developers’ expectations to a more manageable level, as the support for round-trips in the most problematic cases can be explicitly dropped.

By Mattermost’s estimates this new API will not be a reasonable solution for most use cases currently affected by the vulnerabilities. Parsing and resolving namespaces is an essential requirement for correctly implementing SAML, and even considering only a limited set of real-world SAML messages without strict namespacing requirements would be unlikely to allow for a secure implementation.

Because of this reason, we recommend that affected developers continue using the github.com/mattermost/xml-roundtrip-validator module even after Go 1.16 becomes available. As a long-term solution, it may make sense to refactor code in a way that avoids encoding round-trips altogether, but it’s unclear if such refactoring is possible in all cases.

### Update 12/13/2020

We just heard from the Go team that there are possibly additional changes coming in a future version.  It’s not clear to us whether these changes fully fix the XML validation issues in Go, but we’re hopeful that these issues will get fully patched in Go in the near future. We have been informed that a public discussion with the Go team will be opened in this issue at <https://golang.org/issue/43168>.

## Disclosure timeline

The first of the XML round-trip vulnerabilities was originally discovered on the 28th of August, 2020, and by the 31st of August Mattermost had traced the root cause to encoding/xml and reached out to the Go security team. The graphic below shows the full timeline from initial discovery to public disclosure. Blue circles represent actions taken by Mattermost, red circles are responses from the Go security team.

![](data:image/svg+xml...)

Mattermost would like to thank the Go security team and downstream library maintainers for their many efforts and their collaboration in responding to these important issues.

## Security contacts at Mattermost

If you suspect you’ve found a vulnerability in a Mattermost product or open source project such as the [github.com/mattermost/xml-roundtrip-validator](https://github.com/mattermost/xml-roundtrip-validator) module, please report your findings to [[email protected]](/cdn-cgi/l/email-protection#a5d7c0d6d5cacbd6ccc7c9c0c1ccd6c6c9cad6d0d7c0e5c8c4d1d1c0d7c8cad6d18bc6cac8). We ask you not to use public GitHub issues for reporting security issues.

If you have general questions about application security at Mattermost or the vulnerabilities included in this disclosure, don’t hesitate to reach out to us at [[email protected]](/cdn-cgi/l/email-protection#097a6c6a7c7b607d704964687d7d6c7b64667a7d276a6664).

Read more about:

[Go](https://mattermost.com/blog/tag/go/)
[security](https://mattermost.com/blog/tag/security/)
![](data:image/svg+xml...)
`[Juho Forsén](https://mattermost.com/blog/author/juho-forsen/ "Posts by Juho Forsén")`

Juho Forsén is a Staff Security Researcher at Mattermost. In the past he has held roles in security engineering, security consulting, and software development, and has more than a decade of experience building and securing open source software.

[Return to Blog](https://mattermost.com/blog/)

### Read Next

[![workflow automations](data:image/svg+xml...)](https://mattermost.com/blog/5-workflow-automations-for-mattermost-that-we-love-at-n8n/)

### Share

## Read More Engineering Articles

[![](data:image/svg+xml...)](https://mattermost.com/blog/year-of-security-fixes-in-go/)

[![](data:image/svg+xml...)![](https://mattermost.com/wp-content/uploads/2024/12/01_Redis_at_Scale@2x.webp)

Lessons learned from running Redis at scale](https://mattermost.com/blog/lessons-learned-running-redis-at-scale/)

[![](data:image/svg+xml...)![](https://mattermost.com/wp-content/uploads/2024/11/06_DoS_Bug@2x.webp)

A DoS bug that's worse than it seems](https://mattermost.com/blog/a-dos-bug-thats-worse-than-it-seems/)

![](data:image/svg+xml...)![](https://mattermost.com/wp-content/uploads/2021/08/mattermost-newsletter-sign-up.webp)
## Open source news, right in your inbox

## Thanks for subscribing!

![An illustration of a human beside an envelope with a green checkmark.](data:image/svg+xml...)![An illustration of a human beside an envelope with a green checkmark.](https://mattermost.com/wp-content/themes/mattermost-2021/frontend/dist/img/redesign/newsletter/newsletter-success.png)

* Company
  + [About Us](https://mattermost.com/about-us/)
  + [Newsroom](https://mattermost.com/newsroom/)
  + [Partners](https://mattermost.com/partners/)
  + [Events](https://mattermost.com/events/)
  + [Careers](https://mattermost.com/careers/)
  + [Contact Us](https://mattermost.com/contact-us/)
  + [Responsible Disclosure](https://mattermost.com/security-vulnerability-report/)

* Platform
  + [Platform Overview](https://mattermost.com/platform-overview/)
  + [Channels](https://mattermost.com/channels/)
  + [Playbooks](https://mattermost.com/playbooks/)
  + [Integrations](https://mattermost.com/integrations-overview/)
  + [Security](https://mattermost.com/security/)
  + [Customers](https://mattermost.com/customers/)
  + [Comparison Guide](https://mattermost.com/compare/)

* Documentation
  + [Deployment](https://docs.mattermost.com/guides/deployment.html)
  + [Channels Guide](https://docs.mattermost.com/guides/channels.html)
  + [Playbooks Guide](https://docs.mattermost.com/guides/playbooks.html)
  + [Admin](https://docs.mattermost.com/guides/administration.html)
  + [API Reference](https://api.mattermost.com/)
  + [All Docs](https://docs.mattermost.com/)

* Download
  + [Mobile & Desktop Apps](/apps/)
  + [Mattermost Server](/download/)

* Support
  + [General Support](https://mattermost.com/support/)
  + [Community Chat Server](https://community.mattermost.com/login)
  + [Forums](https://forum.mattermost.org/)
  + [Report an Issue](https://handbook.mattermost.com/contributors/contributors/ways-to-contribute#report-a-bug)
  + [Nominate a Feature](/suggestions/)
  + [Help Center](https://support.mattermost.com/hc/en-us)
  + [Terms](/terms-of-use/)

© Mattermost, Inc. 2025. [Terms
of Use](https://mattermost.com/terms-of-use/ "Terms of Service") | [Privacy Policy](https://mattermost.com/privacy-policy/ "Privacy Policy") | [Cookie Policy](https://mattermost.com/privacy-policy/cookies/ "Cookie Policy") | Manage Cookies

* [GitHub icon](https://github.com/mattermost/)
* [LinkedIn icon](https://www.linkedin.com/company/mattermost/)
* [Facebook icon](https://www.facebook.com/Mattermost-2300985916642531/)
* [X icon](https://twitter.com/mattermost)
* [Bluesky icon](https://bsky.app/profile/mattermost.bsky.social)



=== Content from github.com_7e7454e6_20250119_115151.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmattermost%2Fxml-roundtrip-validator%2Fblob%2Fmaster%2Fadvisories%2Funstable-directives.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmattermost%2Fxml-roundtrip-validator%2Fblob%2Fmaster%2Fadvisories%2Funstable-directives.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=mattermost%2Fxml-roundtrip-validator)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mattermost](/mattermost)
/
**[xml-roundtrip-validator](/mattermost/xml-roundtrip-validator)**
Public

* [Notifications](/login?return_to=%2Fmattermost%2Fxml-roundtrip-validator) You must be signed in to change notification settings
* [Fork
  17](/login?return_to=%2Fmattermost%2Fxml-roundtrip-validator)
* [Star
   80](/login?return_to=%2Fmattermost%2Fxml-roundtrip-validator)

* [Code](/mattermost/xml-roundtrip-validator)
* [Issues
  0](/mattermost/xml-roundtrip-validator/issues)
* [Pull requests
  0](/mattermost/xml-roundtrip-validator/pulls)
* [Actions](/mattermost/xml-roundtrip-validator/actions)
* [Projects
  0](/mattermost/xml-roundtrip-validator/projects)
* [Security](/mattermost/xml-roundtrip-validator/security)
* [Insights](/mattermost/xml-roundtrip-validator/pulse)

Additional navigation options

* [Code](/mattermost/xml-roundtrip-validator)
* [Issues](/mattermost/xml-roundtrip-validator/issues)
* [Pull requests](/mattermost/xml-roundtrip-validator/pulls)
* [Actions](/mattermost/xml-roundtrip-validator/actions)
* [Projects](/mattermost/xml-roundtrip-validator/projects)
* [Security](/mattermost/xml-roundtrip-validator/security)
* [Insights](/mattermost/xml-roundtrip-validator/pulse)

## Files

 master
## Breadcrumbs

1. [xml-roundtrip-validator](/mattermost/xml-roundtrip-validator/tree/master)
2. /[advisories](/mattermost/xml-roundtrip-validator/tree/master/advisories)
/
# unstable-directives.md

Copy path Blame  Blame
## Latest commit

## History

[History](/mattermost/xml-roundtrip-validator/commits/master/advisories/unstable-directives.md)25 lines (16 loc) · 1.99 KB master
## Breadcrumbs

1. [xml-roundtrip-validator](/mattermost/xml-roundtrip-validator/tree/master)
2. /[advisories](/mattermost/xml-roundtrip-validator/tree/master/advisories)
/
# unstable-directives.md

Top
## File metadata and controls

* Preview
* Code
* Blame

25 lines (16 loc) · 1.99 KB[Raw](https://github.com/mattermost/xml-roundtrip-validator/raw/refs/heads/master/advisories/unstable-directives.md)
# Security Advisory: XML directive instability in Go's `encoding/xml`

| Affected component | Package `encoding/xml` in Go |
| --- | --- |
| Affected versions | ≤ 1.15 |
| CVE-ID | CVE-2020-29510 |
| Weakness | CWE-115: Misinterpretation of Input |
| CVSS rating | 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |

## Description

Go's `encoding/xml` handles XML directives in a way that causes crafted markup to mutate during round-trips through the `xml.Decoder` and `xml.Encoder` implementations. Encoding and decoding using Go's `encoding/xml` can introduce new structures around a maliciously crafted XML directive.

Affected applications include software that relies on XML integrity for security-sensitive decisions. Prominent examples of such applications include SAML and XML-DSig implementations.

## Impact

Mutations caused by encoding round-trips can lead to incorrect or conflicting decisions in affected applications. Equivalent lookups within an XML document can return different results during different stages of the document's lifecycle. Attempting to validate the structure of an XML document can succeed or fail depending on the number of encoding round-trips it has gone through.

As a specific example, an affected SAML implementation can interpret a SAML Assertion as signed, but then proceed to read values from an unsigned part of the same document due to structural mutations between signature verification and data access. This can lead to full authentication bypass and arbitrary privilege escalation within the scope of a SAML Service Provider.

## Workaround

The `github.com/mattermost/xml-roundtrip-validator` module can detect unstable constructs in an XML document, including unstable directives. Invoking the validator on all untrusted markup and failing early if it returns an error can prevent these types of issue from being exploited in an otherwise affected application.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c66ca263_20250119_115152.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frussellhaering%2Fgoxmldsig%2Fsecurity%2Fadvisories%2FGHSA-q547-gmf8-8jr7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frussellhaering%2Fgoxmldsig%2Fsecurity%2Fadvisories%2FGHSA-q547-gmf8-8jr7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=russellhaering%2Fgoxmldsig)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[russellhaering](/russellhaering)
/
**[goxmldsig](/russellhaering/goxmldsig)**
Public

* [Notifications](/login?return_to=%2Frussellhaering%2Fgoxmldsig) You must be signed in to change notification settings
* [Fork
  128](/login?return_to=%2Frussellhaering%2Fgoxmldsig)
* [Star
   155](/login?return_to=%2Frussellhaering%2Fgoxmldsig)

* [Code](/russellhaering/goxmldsig)
* [Issues
  20](/russellhaering/goxmldsig/issues)
* [Pull requests
  18](/russellhaering/goxmldsig/pulls)
* [Actions](/russellhaering/goxmldsig/actions)
* [Projects
  0](/russellhaering/goxmldsig/projects)
* [Security](/russellhaering/goxmldsig/security)
* [Insights](/russellhaering/goxmldsig/pulse)

Additional navigation options

* [Code](/russellhaering/goxmldsig)
* [Issues](/russellhaering/goxmldsig/issues)
* [Pull requests](/russellhaering/goxmldsig/pulls)
* [Actions](/russellhaering/goxmldsig/actions)
* [Projects](/russellhaering/goxmldsig/projects)
* [Security](/russellhaering/goxmldsig/security)
* [Insights](/russellhaering/goxmldsig/pulse)

# Signature Validation Bypass

Critical

[russellhaering](/russellhaering)
published
GHSA-q547-gmf8-8jr7
Sep 29, 2020

## Package

gomod

github.com/russellhaering/goxmldsig
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

<= 1.1.0

## Patched versions

1.1.0

## Description

### Impact

With a carefully crafted XML file, an attacker can completely bypass signature validation and pass off an altered file as a signed one.

### Patches

A patch is available, all users of goxmldsig should upgrade to v1.1.0.

### For more information

If you have any questions or comments about this advisory open an issue at <https://github.com/russellhaering/goxmldsig>

### Severity

Critical

### CVE ID

CVE-2020-15216

### Weaknesses

No CWEs

### Credits

* [![@jupenur](https://avatars.githubusercontent.com/u/3514914?s=40&v=4)](/jupenur)
  [jupenur](/jupenur)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_d418d39f_20250119_133740.html ===
���� �  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222��  ( (" ���          
   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz�������������������������������������������������������������������������       
  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? ��n��ɨ�#�C��:⮟�����v�6BW�m�O�zW3��1�����W���m�D� <}
=Ğ���kW $�-�G�Q��C~n~��s�-�a"Fvo��f��NGz���-��
��(���[�j� �tؼA�^Z��q �eX�rK�N0=�I�\���eIn�tFi���h���=������ <�� ���]
φE��$�;˿(n2K�6�?��?�=��"� �S� �����"uH�c��T�=3ԜS-�5��G;�T�,x�:���Q&�������D��Y��1�OΧ�t�x.��'v�$AA��0��$�O<{Q{+�hc�P�ir��D%�|��\*Fu�zã�/
��#&uv(s�l� Jϱ�a��tE��ۺc
����x��©m�I�啮'�F][��2p0@<}))]�ks��L�֞\�X�Nb��q���&��>O� E� }%e��m�Y�%�v�[��8��{��9�Y��\_T���\*gQEيM\ɵѮ �7�]n�Pyt���� c��U�9��Q�P�����HP`.p=~\*֥� � ]��� ��?����e$v12ȅn�8�7���q�q^O㖸�|Qk�F�#r9M�''�u�P����� �Ey��� %?��� �h��EOi����,�sF�a�D�?
������� !^i���)��y?�^�U$��'c��

=== Content from github.com_b5c41beb_20250119_115150.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdexidp%2Fdex%2Fsecurity%2Fadvisories%2FGHSA-m9hp-7r99-94h5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdexidp%2Fdex%2Fsecurity%2Fadvisories%2FGHSA-m9hp-7r99-94h5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=dexidp%2Fdex)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dexidp](/dexidp)
/
**[dex](/dexidp/dex)**
Public

* [Notifications](/login?return_to=%2Fdexidp%2Fdex) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2Fdexidp%2Fdex)
* [Star
   9.7k](/login?return_to=%2Fdexidp%2Fdex)

* [Code](/dexidp/dex)
* [Issues
  305](/dexidp/dex/issues)
* [Pull requests
  147](/dexidp/dex/pulls)
* [Discussions](/dexidp/dex/discussions)
* [Actions](/dexidp/dex/actions)
* [Projects
  0](/dexidp/dex/projects)
* [Wiki](/dexidp/dex/wiki)
* [Security](/dexidp/dex/security)
* [Insights](/dexidp/dex/pulse)

Additional navigation options

* [Code](/dexidp/dex)
* [Issues](/dexidp/dex/issues)
* [Pull requests](/dexidp/dex/pulls)
* [Discussions](/dexidp/dex/discussions)
* [Actions](/dexidp/dex/actions)
* [Projects](/dexidp/dex/projects)
* [Wiki](/dexidp/dex/wiki)
* [Security](/dexidp/dex/security)
* [Insights](/dexidp/dex/pulse)

# Critical security issues in XML encoding

Critical

[justaugustus](/justaugustus)
published
GHSA-m9hp-7r99-94h5
Dec 14, 2020

## Package

encoding/xml
(Golang)

## Affected versions

<=2.26.0

## Patched versions

2.27.0

## Description

### Impact

The following vulnerabilities have been disclosed, which impact users leveraging the SAML connector:

Signature Validation Bypass ([CVE-2020-15216](https://github.com/advisories/GHSA-q547-gmf8-8jr7 "CVE-2020-15216")): [GHSA-q547-gmf8-8jr7](https://github.com/russellhaering/goxmldsig/security/advisories/GHSA-q547-gmf8-8jr7 "GHSA-q547-gmf8-8jr7")

`encoding/xml` instabilities:

* [Element namespace prefix instability (CVE-2020-29511)](https://github.com/mattermost/xml-roundtrip-validator/blob/master/advisories/unstable-elements.md)
* [Attribute namespace prefix instability (CVE-2020-29509)](https://github.com/mattermost/xml-roundtrip-validator/blob/master/advisories/unstable-attributes.md)
* [Directive comment instability (CVE-2020-29510)](https://github.com/mattermost/xml-roundtrip-validator/blob/master/advisories/unstable-directives.md)

### Patches

Immediately update to [Dex v2.27.0](https://github.com/dexidp/dex/releases/tag/v2.27.0).

### Workarounds

There are no known workarounds.

### Severity

Critical

### CVE ID

CVE-2020-26290

### Weaknesses

No CWEs

### Credits

* [![@jupenur](https://avatars.githubusercontent.com/u/3514914?s=40&v=4)](/jupenur)
  [jupenur](/jupenur)
  Analyst
* [![@ericchiang](https://avatars.githubusercontent.com/u/2342749?s=40&v=4)](/ericchiang)
  [ericchiang](/ericchiang)
  Analyst
* [![@justaugustus](https://avatars.githubusercontent.com/u/567897?s=40&v=4)](/justaugustus)
  [justaugustus](/justaugustus)
  Analyst
* [![@sagikazarmark](https://avatars.githubusercontent.com/u/1226384?s=40&v=4)](/sagikazarmark)
  [sagikazarmark](/sagikazarmark)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e221af82_20250119_115151.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmattermost%2Fxml-roundtrip-validator%2Fblob%2Fmaster%2Fadvisories%2Funstable-attributes.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmattermost%2Fxml-roundtrip-validator%2Fblob%2Fmaster%2Fadvisories%2Funstable-attributes.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=mattermost%2Fxml-roundtrip-validator)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mattermost](/mattermost)
/
**[xml-roundtrip-validator](/mattermost/xml-roundtrip-validator)**
Public

* [Notifications](/login?return_to=%2Fmattermost%2Fxml-roundtrip-validator) You must be signed in to change notification settings
* [Fork
  17](/login?return_to=%2Fmattermost%2Fxml-roundtrip-validator)
* [Star
   80](/login?return_to=%2Fmattermost%2Fxml-roundtrip-validator)

* [Code](/mattermost/xml-roundtrip-validator)
* [Issues
  0](/mattermost/xml-roundtrip-validator/issues)
* [Pull requests
  0](/mattermost/xml-roundtrip-validator/pulls)
* [Actions](/mattermost/xml-roundtrip-validator/actions)
* [Projects
  0](/mattermost/xml-roundtrip-validator/projects)
* [Security](/mattermost/xml-roundtrip-validator/security)
* [Insights](/mattermost/xml-roundtrip-validator/pulse)

Additional navigation options

* [Code](/mattermost/xml-roundtrip-validator)
* [Issues](/mattermost/xml-roundtrip-validator/issues)
* [Pull requests](/mattermost/xml-roundtrip-validator/pulls)
* [Actions](/mattermost/xml-roundtrip-validator/actions)
* [Projects](/mattermost/xml-roundtrip-validator/projects)
* [Security](/mattermost/xml-roundtrip-validator/security)
* [Insights](/mattermost/xml-roundtrip-validator/pulse)

## Files

 master
## Breadcrumbs

1. [xml-roundtrip-validator](/mattermost/xml-roundtrip-validator/tree/master)
2. /[advisories](/mattermost/xml-roundtrip-validator/tree/master/advisories)
/
# unstable-attributes.md

Copy path Blame  Blame
## Latest commit

## History

[History](/mattermost/xml-roundtrip-validator/commits/master/advisories/unstable-attributes.md)25 lines (16 loc) · 2.06 KB master
## Breadcrumbs

1. [xml-roundtrip-validator](/mattermost/xml-roundtrip-validator/tree/master)
2. /[advisories](/mattermost/xml-roundtrip-validator/tree/master/advisories)
/
# unstable-attributes.md

Top
## File metadata and controls

* Preview
* Code
* Blame

25 lines (16 loc) · 2.06 KB[Raw](https://github.com/mattermost/xml-roundtrip-validator/raw/refs/heads/master/advisories/unstable-attributes.md)
# Security Advisory: XML attribute instability in Go's `encoding/xml`

| Affected component | Package `encoding/xml` in Go |
| --- | --- |
| Affected versions | All |
| CVE-ID | CVE-2020-29509 |
| Weakness | CWE-115: Misinterpretation of Input |
| CVSS rating | 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |

## Description

Go's `encoding/xml` handles namespace prefixes on XML attributes in a way that causes crafted markup to mutate during round-trips through the `xml.Decoder` and `xml.Encoder` implementations. Encoding and decoding using Go's `encoding/xml` can change the observed namespace as well as the observed local name of a maliciously crafted XML attribute.

Affected applications include software that relies on XML integrity for security-sensitive decisions. Prominent examples of such applications include SAML and XML-DSig implementations.

## Impact

Mutations caused by encoding round-trips can lead to incorrect or conflicting decisions in affected applications. Equivalent lookups within an XML document can return different results during different stages of the document's lifecycle. Attempting to validate the structure of an XML document can succeed or fail depending on the number of encoding round-trips it has gone through.

As a specific example, an affected SAML implementation can interpret a SAML Assertion as signed, but then proceed to read values from an unsigned part of the same document due to namespace mutations between signature verification and data access. This can lead to full authentication bypass and arbitrary privilege escalation within the scope of a SAML Service Provider.

## Workaround

The `github.com/mattermost/xml-roundtrip-validator` module can detect unstable constructs in an XML document, including unstable attribute namespace prefixes. Invoking the validator on all untrusted markup and failing early if it returns an error can prevent these types of issue from being exploited in an otherwise affected application.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


