=== Content from gitlab.com_7f5b158b_20250119_115138.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2020](/gitlab-org/cves/-/tree/master/2020)
* [**CVE-2020-26409.json**](/gitlab-org/cves/-/blob/master/2020/CVE-2020-26409.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2020/CVE-2020-26409.json)
[Permalink](/gitlab-org/cves/-/blob/5dbfc725a86e6d942deec9c36b7f06f5b8d912fc/2020/CVE-2020-26409.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ GitLab Bot 's avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 " GitLab Bot ")](/gitlab-bot)

  Dec 09, 2020

  [3abc8dd7](/gitlab-org/cves/-/commit/3abc8dd702988014f741d6f2dddb377e045dc286)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/3abc8dd702988014f741d6f2dddb377e045dc286)
  繚
  3abc8dd7

  [ GitLab Bot ](/gitlab-bot) authored Dec 09, 2020

  3abc8dd7

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/3abc8dd702988014f741d6f2dddb377e045dc286)
  [ GitLab Bot ](/gitlab-bot) authored Dec 09, 2020

Loading



=== Content from gitlab.com_6df8da9b_20250119_115139.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Uncontrolled Resource Consumption in any Markdown field using Mermaid

**[HackerOne report #990461](https://hackerone.com/reports/990461)** by `misha98857` on 2020-09-24, assigned to [@kaunghtet](/kaunghtet "Kaung Htet Aung"):

[Report](#report) | [Attachments](#attachments)

## Report

##### Summary

I found a bypass for the mitigation of [DoS via Mermaid (CVE-2019-9220)](https://hackerone.com/reports/470067) and [DoS via Mermaid (CVE-2019-15584)](https://hackerone.com/reports/670572)

As the mitigation for CVE-2019-9220, the input limit of 5000 characters is currently applied to a Mermaid code block, but it can be bypassed by simply splitting the longer payload to many little code blocks.

##### Steps to reproduce

1. Sign in to GitLab.
2. Open any page where you can input Markdown text using Mermaid into the form.
3. Copy and paste the contents of the attached file ("poc.txt") to the input form.
4. Save the Markdown text on the page you opened. (For example, click "Comment" on "Issue" page or save "Readme.md" file)
5. Page freeze and no working, chrome task manager demonstrate 100% cpu usage for long time.

##### What is the current *bug* behavior?

When rendering of the Mermaid graphs starts, the browser tab displaying the page freezes.

This behavior prevents browsing and editing the page that have been added the Mermaid graphs.

Also, the resources used by the browser tab will increase as rendering continues. In the worst case, the entire browser also freezes or crashes. My browser can load first graphs, but after first view get infinity load other graphs.

##### What is the expected *correct* behavior?

We need a mechanism to stop rendering in advance by detecting if the user's input contains a large number of Mermaid code blocks.

##### Output of checks

Bug tested on readme.md file markdown and issue comments

Browser for testing `Version 85.0.4183.102 (Official Build) Arch Linux (64-bit)`

#### Impact

This vulnerability is effective not only on Issue or Readme.md pages but also on **all pages using Markdown with Mermaid**.

The following impacts exist on the attacked page:

* All users can not view the attacked page. (In some situations, the users may see incomplete rendering of the attacked page, but the user's viewing is still significantly blocked.)
* All users can not take any action on the attacked page.
* Depending on the user's environment, crashing or freezing the entire browser may cause user data being edited to be lost.

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [poc.txt](https://h1.sec.gitlab.net/a/a38d34ea-8d66-4264-9e74-2651dc47bad1/poc.txt)

Edited Oct 01, 2020 by [Kaung Htet Aung](/kaunghtet)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


