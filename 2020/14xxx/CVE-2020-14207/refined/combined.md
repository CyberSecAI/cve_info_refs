=== Content from www.hooperlabs.xyz_c27df250_20250119_124545.html ===

![](/img/logo.png)

# Hooper Labs

[Home](/index.php)
Boot to Root

[Nightfall](/b2r/nightfall.php)
[Weakness](/b2r/weakness.php)
[Stapler 1](/b2r/stapler1.php)
[My Tomcat Host](/b2r/mytomcathost.php)
[Inclusiveness](/b2r/inclusiveness.php)

[Cheat Sheets](/cheatsheets.php)
Mobile

[OWASP Uncrackable 1](/mobile/uncrackable1.php)

[About](/about.php)
[Links](/links.php)
[Recipes](/recipes.php)

## Multiple Vulnerabilities in DiveBook WordPress Plugin (v.1.1.4)

2020-09-15

### Background

The DiveBook plugin for WordPress was prone to a multiple vulnerabilities including SQL injection, cross-site scripting, and improper authorization (CVE-2020-14205, CVE-2020-14206, CVE-2020-14207).
An attacker could leverage these issues to dump the database including administrative user credentials, to steal cookie-based authentication credentials, or launch other attacks. Other versions are likely affected, though they were not tested.

Download Link: [DiveBook](https://downloads.wordpress.org/plugin/divebook.1.1.4.zip)

Vulnerable version: v.1.1.4.

This WordPress plugin is a solutions for dive enthusiasts to collaboratively log and track their dives.

From the [WordPress website](https://wordpress.org/plugins/divebook/): The DiveBook plugin consists of three main functionality areas:

1. The main part of the plugin can be injected in pages or posts (statistics about logged dives, input form to easily log new dives and edit existing dives, and list and information about all logged dives)
2. Settings page for the WordPress Administrator where general settings for the plugin can be stored (not used in Beta version).
3. Sidebar widget that will show key information about the most recent logged dives. You can specify how many dives to be shown in the widget.

#### Vulnerability - Improper Authorization Check (CVE-2020-14205)

An authorization issue is present in the DiveBook "Add New Dive" feature. An anonymous user may create a new dive entry with a crafted HTTP POST.

#### Steps:

1. Identify a WordPress application with the DiveBook (v.1.1.4) plugin installed (hxxps://example.wordpress.com).
2. Locate a page with the DiveBook content included. Note: within the WordPress page editor interface, "[divebook]divebook\_display();[/divebook]" will be included.
3. Submit a crafted POST request containing the required parameters (see HTTP request below).
4. Observe that a new dive has been logged within the database, which is visible on the page.

![](/img/divebook_auth.png)

The screenshot above contains the necessary parameters to create a new dive entry without supplying any cookies.

#### Vulnerability - Unauthenticated Reflected XSS (CVE-2020-14206)

A reflected cross-site scripting vulnerability exists within the DiveBook log's filter functionality. Arbitrary URL parameters are reflected into the application's response, rendered by the browser as HTML or JavaScript. An attacker may abuse this functionality by sending a victim a crafted link containing JavaScript, which will execute within the context of the victim's browser. The "scrolled" parameter is also vulnerable.

#### Steps:

1. Identify a WordPress application with the DiveBook (v.1.1.4) plugin installed (hxxps://example.wordpress.com).
2. Locate a page with the DiveBook content included. Note: within the WordPress page editor interface, "[divebook]divebook\_display();[/divebook]" will be included.
3. Browse to a URL triggering the "filter" functionality and include an arbitrary parameter containing HTML. Example: hxxps://example.wordpress.com/index.php/2020/06/15/hello-world/?filter\_diver=0&filter\_divesite=site&divelog\_page=1&scrolled=798&foobar"<>script>alert`XSS+in+arbitrary+URL+parameter`</script>"<
4. Observe that JavaScript executes within the web page (an alert box appears).

![](/img/divebook_xss.png)

The screenshot above demonstrates the attack (request, response, and result). Observe that a JavaScript "alert" box appears with arbitrary content. This payload may be modified to execute arbitrary JavaScript in the victim's browser.

#### Vulnerability - SQL Injection (CVE-2020-14207)

A SQL injection vulnerability exists within the DiveBook log's filter functionality. Though the plugin escapes some user input (quotes), complete compromise of the application database is possible by injecting the "filter\_diver" GET parameter. Because the WordPress administrative credentials are stored within the database, this may result in complete or partial application compromise.

#### Steps:

1. Identify a WordPress application with the DiveBook (v.1.1.4) plugin installed (hxxps://example.wordpress.com).
2. Locate a page with the DiveBook content included. Note: within the WordPress page editor interface, "[divebook]divebook\_display();[/divebook]" will be included.
3. Browse to a URL triggering the "filter" functionality and injecting into the back-end SQL statement: hxxps://example.wordpress.com/?divelog\_page=1&scrolled=456&filter\_diver=0%20UNION%20SELECT%201,2,version(),4,5,6,7,8,9,10,11,12,13;%20--
4. Observe that the MySQL version is returned within the page.

![](/img/divebook_SQLi.png)

The screenshot above demonstrates the attack and MySQL version returned in the page. A few more crafted queries would result in the password hashes and usernames of all WordPress users for the instance.

#### Testing Conditions:

* Firefox v68.9.0esr
* WordPress 5.4.2

### Vulnerability Disclosure Policy

Hooper Labs takes security issues seriously. We believe in working with relevant stakeholders to achieve coordinated disclosure within a reasonable period of time.
We also adhere to the industry-standard 90-day disclosure deadline, where vendors are notified of vulnerabilities immediately, with details shared to the public after
90 days (or sooner if the issues are resolved earlier).

Common Vulnerabilities and Exposures (CVEs) are an industry standard for identifying vulnerabilities [(link)](https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures). This system is a method for reference and tracking of publicly-known exposures. A CVE is a way to uniquely reference vulnerabilities across systems and Mitre
Corporation is the primary CVE Numbering Authority (CNA) for the program. We believe that users have a right to know their exposures in order to make informed risk decisions.

Hooper Labs does not participate in bug bounty programs, but instead relies on responsible disclosure [(link)](https://en.wikipedia.org/wiki/Responsible_disclosure).
Effectively communicating vulnerabilities and risks to the vendor, users, and public ensure that risk can be documented, calculated, and mitigated. We hope that through this
process the Information Domain may be marginally safer.



=== Content from wordpress.org_9a5b565c_20250119_124545.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

DiveBook

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fdivebook&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fdivebook&locale=en_US)

Search plugins

![](https://s.w.org/plugins/geopattern-icon/divebook.svg)
# divebook

By [Per Ola Saether](http://www.breathingtech.com/about)

* [Details](https://wordpress.org/plugins/divebook/#description)
* [Reviews](https://wordpress.org/plugins/divebook/#reviews)
* [Development](https://wordpress.org/plugins/divebook/#developers)

[Support](https://wordpress.org/support/plugin/divebook/)

## Description

This plugin has been closed as of December 9, 2020 and is not available for download. Reason: Security Issue.

## Reviews

There are no reviews for this plugin.

## Contributors & Developers

“DiveBook” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/579a5047f4a5c8f755ee7f63d63ab31660668bffcbfdf0e37852a0565014349c?s=32&d=mm&r=g)

[Translate “DiveBook” into your language.](https://translate.wordpress.org/projects/wp-plugins/divebook)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/divebook/), check out the [SVN repository](https://plugins.svn.wordpress.org/divebook/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/divebook/) by [RSS](https://plugins.trac.wordpress.org/log/divebook/?limit=100&mode=stop_on_copy&format=rss).

## Meta

* Version **1.1.4**
* Last updated **14 years ago**
* Active installations **N/A**
* WordPress version **2.0.2 or higher**
* Tested up to **3.1.4**
* [Advanced View](https://wordpress.org/plugins/divebook/advanced/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


