=== Content from cybersecurityworks.com_e365978b_20250119_112859.html ===


[![csw-logo](/images/Home/logo1.webp)](/index.php)

* [Contact Us](/contact-us.php)

* [Contact Us](/contact-us.php)

[###### Back to all zero days](/zerodays-vulnerability-list)
## Stored Cross-Site Scripting (XSS) in WSO2 Product

#### Affected Vendor

WSO2

#### Status

Fixed

#### Date

Feb 10, 2020

![](/images/zeroday/medium.png)

Medium Severity

* [Description](#description)
* [Proof of concept (POC)](#poc)
* [Impact](#impact)
* [Remediations](#remedy)
* [Timeline](#timeline)

### Description

A cross-site scripting (XSS) attack can cause arbitrary code (JavaScript) to run in a user’s browser while the browser is connected to a trusted web site. The application targets your users and not the application itself, but it uses your application as the vehicle for the attack. XSS payload is executed when the user loads a page created in WSO2 Identity Server version 5.9.0 Product.

### Proof of concept: (POC)

The following vulnerability was tested on WSO2 Identity Server version 5.9.0 Product.

**Issue 01: Stored cross-site scripting.**

![](data:image/png;base64...)

***Figure 01:*** *Navigating to the Policy Administration and Clicking the **Add New Entitlement Policy** Link.*

![](data:image/png;base64...)***Figure 02:*** *Clicking on Basic Policy Editor will redirect to the* [*URL*](https://localhost:9443/carbon/entitlement/basic-policy-editor.jsp)*.*

![](data:image/png;base64...)

***Figure 03:*** *Fill the necessary details and Move to the **Define Entitlement Rules** section.*

![](data:image/png;base64...)***Figure 04:*** *Intercepting the request, and **‘RuleID’** variable is added with XSS Payload.*

![](data:image/png;base64...)***Figure 05:*** *Inserted payload gets stored and executed whenever the user visits the page.*

![](data:image/png;base64...)***Figure 06:*** *Stored XSS payload in the source code*

### Impact

By leveraging an XSS attack, an attacker can make the browser get redirected to a malicious website, make changes in the UI of the web page, retrieve information from the browser or harm otherwise. However, since all the session related sensitive cookies are set with httpOnly flag and protected, session hijacking or similar attacks would not be possible.

### Remediations

Apply the relevant fixes based on the changes from the public fix using the following link:

<https://github.com/wso2/carbon-identity-framework/pull/2794>

### Timeline

**Jan 31, 2020** – Discovered in WSO2 Identity Server Manager version 5.9.0.

**Feb 04, 2020** - CSW Internal Review.

**Feb 10, 2020** - Reported to the WSO2 security team.

**May 13, 2020** – Published to the public.

### Discovered by

Cyber Security Works Pvt. Ltd.

### Advisory

[Security Advisory Published by WSO2](https://docs.wso2.com/display/Security/Security%2BAdvisory%2BWSO2-2020-0711)

* Affected VendorWSO2
* Bug NameWSO2 IS as Key Manager WSO2 Identity Server
* CVE Number[CVE-2020-14445](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14445)
* CWE IDCWE - 79
* CSW ID2020-CSW-05-1043
* CVSSv3 Score5.4
* Affected Version5.9.0
* SeverityMedium
* Affected ProductWSO2 IS as Key Manager 5.9.0 or earlier, WSO2 Identity Server 5.9.0 or earlier

![fb icon](/images/Home/fb-white.png)
![twitter icon](/images/Home/twitter.png)
![insta icon](/images/Home/linkedin.png)

Talk to CSW's team of experts to secure your landscape.

[Schedule free consultation](/get-quote.php)

##### CSW RSS Feed

Copy this iframe link to the add CSW's RSS feed to your website

×

![](/images/copy-icon.png)

![csw logo](/images/Home/csw.png)
![pci-icon](/images/Home/pci.png)

Cyber Security Works helps reduce security debt and inherent vulnerabilities in an organization’s infrastructure and code. We work with large public, private, and start-up companies and help them prioritize their vulnerabilities.

* [Sitemap](/sitemap.xml)
* [Privacy Policy](/privacy_policy.php)
* [Customer Agreements](/customer-legal-agreement/)

© 2023 - Cyber Security Works

Cookies.
This site uses cookies to give you a better experience. By using our site you agree to the use of cookies. See our [cookie policy](/privacy_policy.php/#trackingPolicy) for more details.

I Accept

![](https://ws.zoominfo.com/pixel/618acb612281f500159749f8)


