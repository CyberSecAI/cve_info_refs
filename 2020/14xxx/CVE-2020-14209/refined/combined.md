=== Content from www.wizlynxgroup.com_fc742b0a_20250119_121615.html ===


[![wizlynx group | IT Security Services](/content/images/logo-nav.png)](/ch/de/)

[Contact Us](../../contact)

# Security Research & Advisories

### Unrestricted Upload of File with Dangerous Type in Dolibarr ERP/CRM

| Vendor |  |
| --- | --- |
| Product | Dolibarr |
| Affected Version(s) | 11.0.4 and probably prior |
| Tested Version(s) | 11.0.4 |
| Vendor Notification | 16 June 2020 |
| Advisory Publication | 16 June 2020 [without technical details] |
| Vendor Fix | 11.0.5 |
| Public Disclosure | 25 September 2020 |
| Latest Modification | 25 September 2020 |
| CVE Identifier | [CVE-2020-14209](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14209) |
| Product Description | Dolibarr ERP/CRM is an open source, free software package for small and medium companies, foundations or freelancers. It includes different features for enterprise resource planning (ERP) and customer relationship management (CRM) but also other features for different activities. |
| Credits | Andrea Gonzalez, Security Researcher & Penetration Tester @wizlynx group |

## **Vulnerability Details**

| **Unrestricted Upload of File with Dangerous Type** | | | |
| --- | --- | --- | --- |
| **Severity**: **High** | **CVSS Score**: 8.8 | **CWE-ID**: [434](https://cwe.mitre.org/data/definitions/434) | **Status**: Open |
| **Vulnerability Description** | | | |
| The application Dolibarr 11.0.4 and probably prior allows low-privilege users to upload files of dangerous types which can result in arbitrary code execution within the context of the vulnerable application. | | | |
| **CVSS Base Score** | | | |
| **Attack Vector** | Network | **Scope** | Changed |
| **Attack Complexity** | Low | **Confidentiality Impact** | High |
| **Privileges Required** | Low | **Integrity Impact** | High |
| **User Interaction** | None | **Availability Impact** | High |

## **PoC**

### Example

Authenticated users can upload files containing code and execute them server-side, since a blacklist is used to detect and rename files with dangerous file extensions, but it does not include common extensions that are interpreted as code when using default configurations in Apache.

Two methods of exploitation have been developed and tested:

* File extension blacklist bypass
* htaccess file upload

The methods were tested using users without any permissions:

![](/content/images/vuln/F0C3027K2O5A.png)

Details for each method are as follows:

**File extension blacklist bypass**

**Requirements:**

* The directory where files are uploaded needs to be inside the web serverâs document root without access restrictions.
* The web server must be able to execute files that are not blacklisted (this is the default configuration for Apache).

**Testing environment:**

* Debian 9.12 running Apache 2.4.25 with default configurations.
* Dolibarr version 11.0.4.

When uploading a file, a filename extension blacklist is used to determine if the file has executable code, in such case the filename is appended the â.noexeâ extension. Before the 9.0.4 version, the blacklist is more permissive compared to more recent versions. The latest version 11.0.4 uses the function isAFileWithExecutableContent to assess if a filename has a dangerous extension.

The Image below shows the content of the fie /htdocs/core/lib/functions.lib.php in Dolibarr version 11.0.4

![](/content/images/vuln/0X5UI4OTULUN.png)

The regular expression shows that extensions such as â.phtâ, â.pharâ and â.shtmlâ are allowed, the default configuration for Apache 2.4.25 executes â.phtâ files as PHP scripts:

![](/content/images/vuln/9WIY5J16BKOF.png)

Likewise, Apache 2.4.41 executes â.pahrâ files by default:

![](/content/images/vuln/9VIV08FKKMRS.png)

As shown below, the user is not allowed to upload files on the âLinked filesâ section of the userâs profile.

![](/content/images/vuln/84KK4ZLRNEJB.png)

However, the following request can bypass the file upload restrictions (this vulnerability has also been reported to Dolibarr as â[Vertical Privilege Escalation â WLX-2020-011](https://www.wizlynxgroup.com/security-research-advisories/vuln/WLX-2020-011)â). The file â0wkenzqk.phtâ is being uploaded, it contains a PHP webshell:

![](/content/images/vuln/890BJQD9Q4UY.png)

The file was successfully uploaded, and its extension was not modified:

![](/content/images/vuln/4DVME0T4R7ST.png)

The uploaded files are stored by default in the /documents/users/<user\_id>/ directory, the webshell can be executed as shown below:

![](/content/images/vuln/U3O70VUCN1WC.png)

**htaccess file upload**

***Requirements:***

* The directory where files are uploaded needs to be inside the web serverâs document root.
* The web server must be Apache with htaccess enabled.

***Testing environment:***

* Debian 9.12 running Apache/2.4.25 with htaccess enabled.
* Dolibarr version 11.0.4.

A PHP file is uploaded as shown in the previous methods, the file is appended the â.noexeâ extension:

![](/content/images/vuln/6U55URMHGRM8.png)

An htaccess file can be uploaded to grant access to the directory where the userâs files are uploaded, and to make files with the extension â.noexeâ executable as PHP files. The following screenshot shows an htaccess file being uploaded, note that the filename is âhtaccessâ, the application does not allow files starting with a dot (.) to be uploaded.

The following screenshot shows the Request that uploads a htaccess file.

![](/content/images/vuln/HQQ2IF64DO0X.png)

The htaccess file needs to be renamed to â.htaccessâ, which can be done leveraging the file renaming function:

![](/content/images/vuln/SFGA719T07QU.png)

Any file uploaded by the user ending with â.noexeâ can now be executed:

![](/content/images/vuln/JY6KVMT6SK47.png)

[Top](#0)

![wizlynx group | IT Security Services](/content/images/WhiteWithRed.png)

wizlynx has not only built a solid foundation of information security, quality and project management know-how, but our associates are known for their ability to apply the right soft skills at the right time to best serve our customers. We make it a point to understand the infrastructure, needs and challenges of our customers, which enables us to deliver fast, effective and high quality results. It is our belief that this level of understanding can only be obtained with the most capable and experienced resources. Reach out to our associates at any time through our interactive competence centers to draw upon our knowledge of processes, procedures, guidelines and tools. Youï¿½ll be able to see, firsthand, the value our team will add to your organization.

---

---

©2024 wizlynx group - All Rights Reserved

* [Terms of Use](/terms-of-use)
* [Privacy](/privacy)



=== Content from github.com_b85dbfe0_20250119_121615.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDolibarr%2Fdolibarr%2Freleases%2Ftag%2F11.0.5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDolibarr%2Fdolibarr%2Freleases%2Ftag%2F11.0.5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=Dolibarr%2Fdolibarr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Dolibarr](/Dolibarr)
/
**[dolibarr](/Dolibarr/dolibarr)**
Public

* [Notifications](/login?return_to=%2FDolibarr%2Fdolibarr) You must be signed in to change notification settings
* [Fork
  2.8k](/login?return_to=%2FDolibarr%2Fdolibarr)
* [Star
   5.6k](/login?return_to=%2FDolibarr%2Fdolibarr)

* [Code](/Dolibarr/dolibarr/tree/11.0.5)
* [Issues
  949](/Dolibarr/dolibarr/issues)
* [Pull requests
  234](/Dolibarr/dolibarr/pulls)
* [Actions](/Dolibarr/dolibarr/actions)
* [Projects
  2](/Dolibarr/dolibarr/projects)
* [Security](/Dolibarr/dolibarr/security)
* [Insights](/Dolibarr/dolibarr/pulse)

Additional navigation options

* [Code](/Dolibarr/dolibarr/tree/11.0.5)
* [Issues](/Dolibarr/dolibarr/issues)
* [Pull requests](/Dolibarr/dolibarr/pulls)
* [Actions](/Dolibarr/dolibarr/actions)
* [Projects](/Dolibarr/dolibarr/projects)
* [Security](/Dolibarr/dolibarr/security)
* [Insights](/Dolibarr/dolibarr/pulse)

1. [Releases](/Dolibarr/dolibarr/releases)
2. [11.0.5](/Dolibarr/dolibarr/releases/tag/11.0.5)

# 11.0.5

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Dolibarr/dolibarr/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...11.0.5)

 Loading

[View all tags](/Dolibarr/dolibarr/tags)

![@eldy](https://avatars.githubusercontent.com/u/883887?s=40&v=4)
[eldy](/eldy)
released this
03 Jul 00:10

·
[57571 commits](/Dolibarr/dolibarr/compare/11.0.5...develop)
to develop
since this release

[11.0.5](/Dolibarr/dolibarr/tree/11.0.5)

[`0eac798`](/Dolibarr/dolibarr/commit/0eac798674eacb44e725fa53423c35ea860acd02)

FIX: $arraydefaultmessage is an object, as well as in /htdocs/core/class/html.formmail.class.php

FIX: 10.0 - pagination in prelevement/bons.php

FIX: 10.0 - undefined $langs if template file copy fails during activation of modContrat

FIX: 11.0 - fatal with postgres on contact/agenda.php

FIX: 11.0 - multicurrency amount not fetched when fetching payments from llx\_paiement or llx\_paiementfourn

FIX: 11.0 - when using pdftk as per hidden conf USE\_PDFTK\_FOR\_PDF\_CONCAT, check that the file exists before displaying a success message

FIX: [#13841](https://github.com/Dolibarr/dolibarr/issues/13841)

FIX: [#13877](https://github.com/Dolibarr/dolibarr/issues/13877) - Can validate invoice if there is a credit note with VAT 0% on an invoice with other lines with a VAT non 0%

FIX: [#13968](https://github.com/Dolibarr/dolibarr/issues/13968)

FIX: [#14001](https://github.com/Dolibarr/dolibarr/issues/14001)

FIX: [#14002](https://github.com/Dolibarr/dolibarr/issues/14002)

FIX: 9.0 - delete unused mandatory argument from migrate\_clean\_association: argument count mismatch causes a fatal error since php7

FIX: 9.0 - fatal during migration from 3.1 using PHP 7

FIX: Accountancy - Binding index - Add a filter on sql request for module Subtotal & Jalon

FIX: avoid error "Call to undefined function measuringUnitString()"

FIX: BlindBoolean SQL injection reported by Christian Weiler

FIX: Can create a credit note on situation invoice if previous is also

FIX: can install module even if (x) was appended during download.

FIX: copy value date of VariousPayment onto the new AccountLine

FIX: count of open day when date and start are not open should be 0

FIX: Default bank account was not loaded for document generation.

FIX: Do not show stats panel if the user does not have permissions

FIX: Fix link of the button to create a credit note and fix the awareness of a error that happen when wo create a credit note

FIX: force rounding 2 on export ld compta

FIX: free text on cash desk

FIX: links into emails of notifications

FIX: missing file manifest.json.php

FIX: missing GetNomURL Hook in warehouse class

FIX: missing hook init + table class + $page not set

FIX: missing rollbacks on trigger bad return

FIX: missing translation value for key "NoMorePredefinedProductToDispatch"

FIX: percent must be displayed on one line

FIX: php error if multicompany disabled

FIX: Privilege escalation reported by wizlynx WLX-2020-011

FIX: replace filter parameter "none" by "restricthtml"

FIX: Rounding Total TVA in "crabe" model pdf

FIX: Show ref\_customer, amount on contract link object

FIX: Site ec.europa.eu has moved to https://

FIX: Tickets mail models doesn't work

FIX: vulnerability reported by wizlynx WLX-2020-012

FIX: We must only rename current bank receipt

FIX: when creating a VariousPayment, the value date is not copied onto the AccountLine that gets created at the same time, so the bank transaction's value date will be the payment date instead of the payment's value date

FIX: wrong url param

FIX: XSS using the renaming of .noexe files - reported by Nolan.

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packetstormsecurity.com_5a3a4dd9_20250119_121614.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT⛔ 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.
