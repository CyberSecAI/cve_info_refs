```
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "CVE-2020-14363": {
    "data": [
      {
        "content": "libX11 1.6.12, fixes for CVE-2020-14363 and CVE 2020-14344\n\n* Wed Aug 26 2020 Peter Hutterer peter.hutterer@redhat.com 1.6.12-1\n- libX11 1.6.12 (CVE-2020-14363, CVE 2020-14344)",
        "type": "fedora mailing list"
      },
      {
        "content": "CVE-2020-14363 libX11: integer overflow leads to double free in locale handling",
        "type": "redhat bugzilla"
      },
          {
        "content": "An integer overflow vulnerability leading to a double-free was found in libX11. This flaw allows a local privileged attacker to cause an application compiled with libX11 to crash, or in some cases, result in arbitrary code execution. The highest threat from this flaw is to confidentiality, integrity as well as system availability.",
        "type": "redhat bugzilla"
      },
      {
        "content": "There is an integer overflow and a double free vulnerability in the way LibX11 handles locales. The integer overflow is a necessary precursor to the double free.",
        "type": "redhat bugzilla comment"
      },
        {
        "content": "I have found an integer overflow and a double free vulnerability in the way LibX11 handles locales. The integer overflow is a necessary precursor to the double free.\nThe integer overflow occurs in this for loop, as length can be incremented to a negative value with sufficiently large font set names. https://gitlab.freedesktop.org/xorg/lib/libx11/-/blob/master/modules/om/generic/omGeneric.c#L2010\nBecause length is a signed int, it wraps, which then causes the call to malloc() to fail here: https://gitlab.freedesktop.org/xorg/lib/libx11/-/blob/master/modules/om/generic/omGeneric.c#L2025\nWhich leads to Xfree(required\\_list)https://gitlab.freedesktop.org/xorg/lib/libx11/-/blob/master/modules/om/generic/omGeneric.c#L2027\nNote that required\\_list and om->core.required\\_charset.charset\\_list are equivalent.  https://gitlab.freedesktop.org/xorg/lib/libx11/-/blob/master/modules/om/generic/omGeneric.c#L2018\nNow because init\\_om returned false, we \"goto err\" here: https://gitlab.freedesktop.org/xorg/lib/libx11/-/blob/master/modules/om/generic/omGeneric.c#L2071\nThen in close\\_om() we call Xfree for a second time on the same region of memory: https://gitlab.freedesktop.org/xorg/lib/libx11/-/blob/master/modules/om/generic/omGeneric.c#L1678\nSo now the same object is freed twice, once as required\\_list, and a second time as om->core.required\\_charset.charset\\_list.\nTo generate the locale here is a small shell script (which requires plenty of RAM and a bit of patience, so don't run it unless you absolutely need to verify the realisability of the vulnerability). https://github.com/Ruia-ruia/Exploits/blob/master/x11doublefree.shThe PoC generates enough fontsets, with large enough names, to increment the length variable in init\\_om to a negative value. I have tested on Ubuntu 20.04, with Glibc 2.31 installed. To trigger the vulnerability, simply run the script and call XOpenOM() in your own application.",
        "type": "github exploit details"
      },
         {
        "content": "#if testing on GLibc 2.31, the error message should be:\n#free(): double free detected in tcache 2#Aborted (core dumped)\ntouch final.txt\nfor ((c=0; c <= 20; c++))do touch test0.txt{echo \"XLC\\_FONTSET\"echo \"fs$c {\"echo \"charset {\"printf \"name \"} >> test0.txt\ndd if=/dev/zero bs=107374182 count=1 | tr '\\0' '0' > test1.txtcat test1.txt >> test0.txt\ntouch test2.txt{ echo \" \"echo \"}\"echo \"font {\"printf \"primary \"} >> test0.txtcat test1.txt >> test0.txt\n{echo \" \"echo \"vertical\\_rotate all\"echo \"}\"echo \"}\"\n} >> test0.txt\necho \"END XLC\\_FONTSET\" >> test0.txtcat test0.txt >> final.txtrm test\\*.txtdone\nmv final.txt /usr/local/share/X11/locale/C/XLC\\_LOCALE",
        "type": "github exploit script"
      },
      {
        "content": "Double free in libX11 locale handling code\n==========================================\n\nCVE-2020-14363\n\nThere is an integer overflow and a double free vulnerability in the way\nLibX11 handles locales. The integer overflow is a necessary precursor to\nthe double free.\n\nPatches\n-------\n\nA Patch for this issue has been committed to the libX11 git repository.\nlibX11 1.6.12 will be released shortly and will include this patch.\n\n<https://gitlab.freedesktop.org/xorg/lib/libx11>\n\ncommit acdaaadcb3d85c61fd43669fc5dddf0f8c3f911d (HEAD -> master)\n\n    Fix an integer overflow in init_om()\n\n    CVE-2020-14363\n\n    This can lead to a double free later, as reported by Jayden Rivers.",
        "type": "xorg mailing list"
      },
      {
        "content": "Jayden Rivers discovered that libx11 incorrectly handled locales. A local\n\nattacker could possibly use this issue to escalate privileges.\n\n([CVE-2020-14363](/security/CVE-2020-14363))",
        "type": "ubuntu security notice"
      }
    ],
    "vulnerability_details": {
      "Root cause of vulnerability": "Integer overflow in the handling of font set names within the locale handling code of libX11.",
      "Weaknesses/vulnerabilities present": "Integer overflow leading to a double free vulnerability.",
      "Impact of exploitation": "A local privileged attacker can cause an application compiled with libX11 to crash, or in some cases, achieve arbitrary code execution. The vulnerability could also lead to information disclosure or system instability.",
      "Attack vectors": "The vulnerability can be triggered by crafting a specific locale configuration with long font set names that cause the integer overflow. This crafted locale must then be loaded by a vulnerable application using XOpenOM().",
      "Required attacker capabilities/position": "The attacker needs to have local access to the system and the ability to create or modify the system's locale configuration.  Additionally, the attacker needs to be able to execute an application that uses the vulnerable libX11 library."
    }
  }
}
```