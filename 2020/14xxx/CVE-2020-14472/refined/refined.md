The provided content describes multiple command injection vulnerabilities in DrayTek Vigor2960 and Vigor3900 routers, which aligns with the potential description of CVE-2020-14472, which refers to command injection vulnerabilities in these devices.

**Vulnerability Details:**

The content outlines several command injection vulnerabilities within the `mainfunction.cgi` file:

1.  **`download_ovpn` function:**
    *   **Root Cause:** Parameters from `http_input` are directly written to a buffer (`buf`) without filtering, and then passed to the `system` call.
    *   **Weakness:** Lack of input sanitization, allowing injection of arbitrary commands.
    *   **Impact:** Remote command execution.
    *   **Attack Vector:** HTTP request to `mainfunction.cgi` with a crafted `http_input` parameter within the `download_ovpn` function call.
    *   **Attacker Capabilities:** Ability to send HTTP requests to the device, no authentication is mentioned within this section.

2.  **`doOpenVpn` function:**
    *   **Root Cause:** The `option` parameter, sourced from `http_input`, is concatenated and used by `system` without sanitization.
    *   **Weakness:** Lack of input sanitization, leading to command injection via the `option` parameter.
    *   **Impact:** Remote command execution.
    *   **Attack Vector:** HTTP request to `mainfunction.cgi` with a crafted `option` parameter within the `doOpenVpn` function call.
    *   **Attacker Capabilities:** Ability to send HTTP requests to the device, no authentication is mentioned within this section.

3.  **`dumpSyslog_func` function:**
    *   **Root Cause:** The `option` parameter, derived from `http_input`, allows single quote characters, enabling command injection when user input closes the quote.
    *   **Weakness:** Improper handling of user input and command sanitization, especially concerning single quotes.
    *   **Impact:** Remote command execution.
    *   **Attack Vector:** HTTP request to `mainfunction.cgi` with a crafted `option` parameter containing malicious commands within single quotes, within the `dumpSyslog_func` function call.
    *   **Attacker Capabilities:** Ability to send HTTP requests to the device, no authentication is mentioned within this section.

4.  **`get_subconfig_func` function:**
    *   **Root Cause:**  The `rtick` parameter, from `http_input`, is concatenated to a file path and then passed to the `system` function.
    *  **Weakness:** Lack of input sanitization, directly using a user controlled parameter in a system call.
    *   **Impact:** Remote command execution.
    *   **Attack Vector:** HTTP request to `mainfunction.cgi` with a crafted `rtick` parameter, within the `get_subconfig_func` function call.
    *   **Attacker Capabilities:** Ability to send HTTP requests to the device, no authentication is mentioned within this section.

5.  **`set_ap_map_config_func` function:**
     *  **Root Cause:** The value of the `option` parameter which is taken from `http_input` will be used in a command that executes `/sbin/ipsec_new_cer`
     *   **Weakness:** Lack of input sanitization, allowing user controlled input to be used in command execution.
     *  **Impact:** Remote command execution
     *   **Attack Vector:** HTTP request to `mainfunction.cgi` with a crafted `option` parameter within the `set_ap_map_config_func` function call.
      *   **Attacker Capabilities:** Ability to send HTTP requests to the device, no authentication is mentioned within this section.

6.  **`delete_wlan_profile_func` function:**
    *   **Root Cause:** The value of the `profile_number` parameter, which is from `http_input`, is concatenated with "uci delete apm\_wlan\_profile.profile" and executed.
    *   **Weakness:** Lack of sanitization on user controlled input, allowing command injection through the `profile_number` parameter.
    *   **Impact:** Remote command execution
    *    **Attack Vector:** HTTP request to `mainfunction.cgi` with a crafted `profile_number` parameter within the `delete_wlan_profile_func` function call.
     *  **Attacker Capabilities:** Ability to send HTTP requests to the device, no authentication is mentioned within this section.

7.  **`ruequest_certificate_func` function:**
     *  **Root Cause:** The value of the `option` parameter will be spliced with "/sbin/ipsec_new_cer", which may cause command execution
     *   **Weakness:** Lack of input sanitization on the user controlled `option` parameter, leading to command injection.
      *   **Impact:** Remote command execution
      *   **Attack Vector:** HTTP request to `mainfunction.cgi` with a crafted `option` parameter within the `ruequest_certificate_func` function call.
       *   **Attacker Capabilities:** Ability to send HTTP requests to the device, no authentication is mentioned within this section.

8.  **`doGRETunnel_func` function:**
    *   **Root Cause:** The table value is directly used in a command execution.
    *   **Weakness:** Lack of sanitization on user controlled input, leading to command injection.
    *   **Impact:** Remote command execution
    *   **Attack Vector:** HTTP request to `mainfunction.cgi` with a crafted `table` parameter within the `doGRETunnel_func` function call.
    *   **Attacker Capabilities:** Ability to send HTTP requests to the device, no authentication is mentioned within this section.

Additionally, a separate command injection vulnerability is described in the `DrayTek-Vigor-CMDi.md` document:

*   **Vulnerability Location**: `mainfunction.cgi`
    *   **Root Cause:** The `frompassword` value is not sanitized and is used in a system command.
    *   **Weakness:** Lack of input sanitization on `frompassword` parameter which will be used in a system call.
    *   **Impact:** Remote command execution
    *   **Attack Vector:** HTTP request to `mainfunction.cgi` with a crafted `frompassword` parameter containing malicious commands.
    *   **Attacker Capabilities:** Requires the router to support SMS login and the attacker needs to know the phone number associated with the router to trigger this vulnerability or have access to `/var/sms_phone_auth`

**Affected Versions:**

*   DrayTek Vigor2960/3900 firmware versions prior to 1.5.1.1

**Timeline:**

*   Vulnerabilities reported: 2020-05-29
*   Vendor reply: 2020-06-01
*   Vendor fix: 2020-06-04
*   New firmware released: 2020-06-17

This information provides more detail than a typical CVE description, with specific vulnerable functions and parameters identified, along with PoC examples.