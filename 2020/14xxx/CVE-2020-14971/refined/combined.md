=== Content from blog.telspace.co.za_8af355e5_20250119_140253.html ===


# [Telspace Africa, The Blog](https://blog.telspace.co.za/)

Hackers for hire

Showing posts with label **pentesting**. [Show all posts](https://blog.telspace.co.za/)

Showing posts with label **pentesting**. [Show all posts](https://blog.telspace.co.za/)

## Tuesday, June 23, 2020

### [Pi-hole Code Injection – CVE-2020-14971– Story Time](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html)

A while ago, we had an internal discussion around people working from home and the technologies/products that could be implemented and/or bought to protect home users. This was due to the implementation of the nationwide lockdown which resulted in companies being forced to change their approach entirely to having employees work from home.

During this discussion the Pi-hole was mentioned. Pi-hole is a very popular option for the more “tech savvy” home user and generally, anyone that’s tired of being spammed with random adverts on every website. You can find more information about it here <https://github.com/pi-hole/pi-hole/>.

Since I had a Pi-hole installed already, I decided to take a look at this beautiful piece of ad blocking software in more detail, specifically reviewing the code and logic of the application. Because it’s Opensource and available freely, this was easily accomplished by downloading and installing the latest Pi-hole (v5.0 at the time).

It’s worth mentioning that a lot of vulnerabilities had already been found in this software, some overlapped with findings that I had found particularly during April and May, which were rightfully allocated to the first people that reported the issues. With that being said, the Pi-hole is a popular target for researchers and adds a lot of value to people’s home and small office environments, so the more findings and fixes the better. I also wanted to focus on the latest version because of this.

Initially, I had found a few critical security vulnerabilities but many had been found and fixed already and others eventually required local shell access in some form, some functionality had been changed over time, which solved those particular RCE issues too. So, I therefore looked at a few other vectors and decided to focus on one specific attack vector, which looked promising.

## **Backup Functions:**

Settings.php has lots of functionality, one of which allows users to back up and restore (export and import) configurations of the Pi-hole with a limited set of files (teleporter tab).

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s640/Screen+Shot+2020-06-18+at+4.31.19+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.31.19%2BPM.png)

This was interesting for me because when you export files, they are compressed in tar.gz format and saved. Upon decompression and by systematically reviewing each file that was saved, I found that there were several files which were useful and easy wins for RCE, in particular if no whitelisting and sanitising was taking place. However, those particular ones are not restored if you modify them, re-compress and upload to restore the backup.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s640/Screen+Shot+2020-06-18+at+4.35.31+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.35.31%2BPM.png)

In this instance though, the affected files I found are dnsmasq.d configuration files and the adlist.json file. The dnsmasq.d/04-pi-hole-static-dhcp.conf file allows static DHCP leases, which link to MAC, IP and host.

I modified the configuration file for dnsmasq.d initially, in which I added my own code for the host parameter. Once I did this, I recompressed the file accordingly and imported the file back in via teleporter:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s640/Screen+Shot+2020-06-18+at+4.38.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.38.14%2BPM.png)

Upon browsing to the static DHCP leases section of the Pi-hole web interface, I could see my code was executing correctly i.e. I had found a Code Injection vulnerability.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s640/Screen+Shot+2020-06-18+at+4.39.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.39.14%2BPM.png)

The same then applied to adlists.json and other parameters in other files, as all the files were not being properly checked upon upload, they also just overwrote whatever was previously there and therefore your code executed accordingly:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s640/Screen+Shot+2020-06-22+at+10.13.18+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s1600/Screen%2BShot%2B2020-06-22%2Bat%2B10.13.18%2BPM.png)

Browse to host/admin/groups-adlists.php and you should get the ‘Adam popup’:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s640/Screen+Shot+2020-06-18+at+4.45.47+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.45.47%2BPM.png)

There are more examples, however it’s more of the same as what has been discussed above. I would also like to mention, that the Pi-hole is an amazing piece of software, built by people who really care for the community, please support them and donate. All the responses (especially from Adam) were really quick and things were patched exceptionally quickly.

You can browse all the fixes, comments and progress of patching by going here:

<https://github.com/pi-hole/AdminLTE/commit/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-640920508>

<https://github.com/pi-hole/AdminLTE/commit/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-643830404>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14971>

at

[Tuesday, June 23, 2020](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/4313565159762696677)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=4313565159762696677&from=pencil "Edit Post")

Labels:
[0day](https://blog.telspace.co.za/search/label/0day),
[2020](https://blog.telspace.co.za/search/label/2020),
[code injection](https://blog.telspace.co.za/search/label/code%20injection),
[CVE-2020-14971](https://blog.telspace.co.za/search/label/CVE-2020-14971),
[pentesting](https://blog.telspace.co.za/search/label/pentesting),
[pihole](https://blog.telspace.co.za/search/label/pihole)

## Thursday, May 28, 2020

### [{Certification Review} - OSWE - Staff Review](https://blog.telspace.co.za/2020/05/certification-review-oswe-staff-review.html)

Recently, Offensive-Security released an online version of their certification called “Offensive Security Web Expert” aka OSWE. After having already experienced and successfully obtaining several other certifications from Offensive Security such as OSCP and OSCE, I was curious and intrigued to give the OSWE course a try as well.
I decided to choose the 2-month package option for the course called “Advanced Web Attacks and Exploitation” and due to other commitments I was able to request and was granted a minor 15 day extension.
After watching the videos and reading through the course material, I was very impressed by the content of the course, as it contained detailed information and analysis on certain in-depth attacks.
The course followed a white-box testing approach which was based on source code review, by reading the code of the web application in order to find and exploit potential vulnerabilities.
The course material included several labs with web application software installed on them and by following the content provided in the course material, exploiting the machines was relatively easy.
Before embarking on this course, I would recommend that you have a good understanding of the following skills:

**1.****Python scripting language:**

The course will require you to have a solid understanding of, as well as experience with python scripting, as it  is used for automating the process of exploiting vulnerabilities as well as automating exploits.

**2.****Other programming languages:**

It is also very important to have basic knowledge and understanding of other programming languages such as C#, JavaScript and Java.

**3.****Prior experience with web application attacks:**

Prior experience with web application attacks will also be very advantageous as you will be required to have strong knowledge and understanding of common modern web attacks. Personally, I would also highly recommend reading the book titled “Web Application Hacker’s Handbook”  beforehand as its content will be very helpful during the course and thereafter.

**4.****Source code review:**

One of the outcomes that this course will teach you is how to do Whitebox testing on web applications by reviewing and understanding the code of the application. Therefore, prior experience in doing source code review on web applications will be advantageous.

**5.****Web development experience:**

Having prior experience with web development and the workings of web applications will also assist with successfully completing this course.

## **Course Overview:**

After receiving the course materials, I began reading the book, watching videos and solving the exercises and milestones.
The first few chapters of the course were relatively basic but from Chapter 4 onwards it became far more advanced. Personally it was at this point that it really became fun, as the course delved deeper into  advanced techniques and attacks types.
Offensive Security recommends that you try and solve the exercises and milestones  as you progress through the chapters to ensure that you get a better grasp and understanding of the materials and also as proof that you have understood everything in that particular chapter.
Listed below, is a list of pros and cons to consider when deciding to take this course:

·       **PROS:**

o  Great for learning and advancing white box testing and source code review skills.
o  The course covers advanced real-world vulnerabilities such as deserialization attacks and advanced techniques.
o  The course covers a wide range of vulnerabilities and exploits, including medium, high and critical risk.
·       **CONS:**

o Although the course covers many different attack types, there are a few that are not covered in the course, for example, XXE, SSRF, CSRF and SSTI.
        o More exercise work and milestones would be advantageous to learners

## **The lab review:**

The lab consisted of 5 machines  which contained the web applications as discussed in the course material. Therefore, by going through the course material comprehensivly and successfully completing the course exercises and milestones, you should be able to successfully execute the necessary attacks and exploitation paths.
Personally, I would recommend practicing as much as possible before moving onto the exam, as this will help increase your skills and confidence.

## **The exam review:**

The exam for the OSWE course is a 48 hour exam, which includes an additional 24 hours for writing your step by step report of the exam. As with all exams, I would recommend that you ensure that you get enough sleep to ensure that you are well rested and able to perform at your peak.
During the exam, I had not rested enough and it started to affect my performance, therefore my recommendation is that if you start feeling tired, go sleep for a bit and then resume as this will help you to think clearer.
A few other suggestions from my experience is to remember to get up and take a walk every few hours and don’t forget to take screenshots as you solve the challenges in the exam.
Lastly, try not to stress too much about the exam, try to think of it as a challenge that you are trying to solve, rather than an exam itself.
### **Important material to read before undertaking this course:**

Below is a list of content material that I would recommend that you read and work through before you undertake the OSWE course:

* “The Web Application hackers handbook” (<https://www.amazon.com/Web-Application-Hackers-Handbook-Exploiting/dp/1118026470>)
* <https://github.com/swisskyrepo/PayloadsAllTheThings>
* Pentest monkey will be helpful for some reverse shell cheat sheets (<http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet>)
* Deserialization attacks on .NET (<https://www.youtube.com/watch?v=eDfGpu3iE4Q>)
* Deserialization on several coding languages (<https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html>)

## **Summary:**

OSWE is a very good course for people looking to improve their source code review skills as well as learning how to detect bugs and vulnerabilities by searching for them in the code itself. I would recommend that you book your exam not long after your lab time ends, so that the information you have learned will be fresh and ready to be used. Overall I enjoyed my OSWE experience and would therefore recommend it to others.
- Blog post by Motaz of Telspace Systems

at

[Thursday, May 28, 2020](https://blog.telspace.co.za/2020/05/certification-review-oswe-staff-review.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/5433247023834488353)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=5433247023834488353&from=pencil "Edit Post")

Labels:
[AWAE](https://blog.telspace.co.za/search/label/AWAE),
[infosec training](https://blog.telspace.co.za/search/label/infosec%20training),
[OSWE](https://blog.telspace.co.za/search/label/OSWE),
[pentesting](https://blog.telspace.co.za/search/label/pentesting),
[web application assessment](https://blog.telspace.co.za/search/label/web%20application%20assessment)

## Tuesday, October 20, 2015

### [The T-Mobile Experian Hack: Lessons in Socially Engineered Breach Prevention](https://blog.telspace.co.za/2015/10/the-t-mobile-experian-hack-lessons-in.html)

[Experian](https://www.experianplc.com/), the world's biggest consumer credit monitoring firm, has suffered two major data breaches.

The first breach came shortly after Experian purchased [Court Ventures](http://www.experian.com/blogs/news/2014/03/30/court-ventures/) in March 2012. They learned of the breach when the U.S. Secret Service informed them of a problem with their newly acquired company. It was reselling data from a U.S. Info Search database.

A third party client was engaging in illegal activity. [Hieu Minh Ngo](http://krebsonsecurity.com/2015/07/id-theft-service-proprietor-gets-13-years/) posed as a detective to gain physical access to Experian’s network. He took this opportunity to inject his Trojan-Horse malware to access sensitive data. He then sold that data through his online service called [Superget.info](https://www.techdirt.com/blog/?company=superget.info) to identity thieves.

Ngo is now serving a reduced [13-year sentence](http://krebsonsecurity.com/2014/04/u-s-states-investigating-breach-at-experian/) for cooperating with law enforcement. This breach compromised 200 million personal records.

To give you a context: the U.S. currently has a population of 325 million people.

T-Mobile Breach Discovery

The second breach, the subject of this article, exposed the personal data of 15 million people. Those records came off a server for T-Mobile US Inc. [Experian](http://www.experian.com/data-breach/t-mobilefacts.html) discovered the problem on Sept. 15, 2015.

There are things you never read about in these news reports. There’s a human cost.

Try to imagine the agony the T-Mobile systems admin felt as he or she realized the magnitude of the problem. Someone had accessed a backdoor and used it to inject malware into a server. And worse, that server contained people’s private information.

See the shock registered on the face of the Experian CISO, as he recognized another breach had taken place.

Think of the Experian Board of Directors and the horrible moment they realized their mistake. They never should have rushed the vetting process for the Decisioning Solutions acquisition.

Feel the disgust the T-Mobile Chief Executive felt. He had to explain to customers that Experian’s remedy for this problem was 2-years of free credit monitoring.

Think about the customer. Maybe it was you, and you now have to work with the 3-credit reporting agencies any time you want to make a major life move.

Our hearts go out to the victims of these attacks.

It’s easy to point fingers and blame in hindsight, but the fact is that most breaches are never detected.

This one was just painfully high profile.

More Details about the T-Mobile Server Breach

[Krebs](http://krebsonsecurity.com/2015/10/at-experian-security-attrition-amid-acquisitions/) on Security reports: on December 3, 2013, T-Mobile notified a small group of customers that someone gained unauthorized access to a file stored on servers owned by Experian.

The [T-Mobile](http://www.darkreading.com/risk/experian-gets-hacked-exposing-ssns-data-from-15-million-t-mobile-customers/d/d-id/1322460) exposure began September 1, 2013, and lasted until September 16, 2015. Breached information includes:

·    Names
·    Dates of birth
·    Addresses
·    Social security numbers (SSNs)
·    Other forms of identification

The mobile provider identified [Decisioning Solutions](http://www.experian.com/business-services/decisioning/decisioning-solutions.html) as the breached vendor. It’s an identity proofing company acquired by Experian in April 2013.

T-Mobile Chief Executive posted this [response](http://www.t-mobile.com/landing/experian-data-breach.html) on their company website:

Obviously, I am incredibly angry about this data breach and we will institute a thorough review of our relationship with Experian, but right now my top concern and first focus is assisting any and all consumers affected.

Connecticut's attorney general plans to [launch an investigation](http://www.huffingtonpost.com/entry/experian-hacked-tmobile_560e0d30e4b0af3706e0481e).

Jeff Stone (International Business Times) [reported](http://www.ibtimes.com/hacked-t-mobile-records-sale-1-apiece-dark-net-payable-bitcoin-2126578) the hacked T-Mobile records were available for sale for $1 apiece on Dark Net, payable in Bitcoin.

Decisioning Solutions Onboarded

[Decisioning Solutions](http://www.bloomberg.com/research/stocks/private/snapshot.asp?privcapId=61381199) provides Software-as-a-Service (SaaS) based workflow management. The system automates decisions for the customer lifecycle.

So far so good…

Experian is a huge company. To take care of the customers well requires workflow processes.

The problem came when Experian failed to fully vet the security for the different verticals at Decisioning.

Automation and the Need for Customer Care

Automation was one of the big topics at [NANOG 64](https://www.nanog.org/meetings/nanog64/agenda). It speeds things up, standardizes processes, and takes care of the customer.

The problem with automated systems is the potential for risk.

During a podcast for SEI, Tim Maher, President and Chief Strategist for the RSA Security Conference, had this to say:

[Software,](https://resources.sei.cmu.edu/asset_files/Podcast/2009_016_102_67699.pdf) Infrastructure, and Platform as a service can be very enticing given the potential cost savings.

But business leaders need to make sure of three things.

They must (1) evaluate the benefits and savings against the risks that can arise when co-mingling their data with other, unknown organizations.

They must (2) demonstrate they meet their compliance requirements.

And they must (3) attempt to hold providers accountable.

In his 2014 article: SaaS Security Risks: It’s the Users, Stupid, [Sean Michael Kerner](http://www.esecurityplanet.com/network-security/saas-security-risks-its-the-users-stupid.html) said the security approach is different.

With SaaS, the attack surface shifts from the traditional application deployment landscape.

Instead of infrastructure itself being the primary target, attacks are moving toward users who hold access rights to data. Individual users of SaaS apps also typically do not have appropriate security controls in place to fully minimize risk.

Universal Access to Filing Support Tickets

[Krebs](http://krebsonsecurity.com/2015/10/at-experian-security-attrition-amid-acquisitions/) also says: The problem with the T-Mobile Experian hack there was a backdoor in the form of a support site portal. It allowed anyone to file support tickets and attach any type of file including malicious files.

By the time Experian became aware of this problem, the exposure had gone on for 2 years. The agency immediately contacted law enforcement.

Data sharing

Dark Reading: The T-Mobile and Experian relationship illustrates the importance of tracking and auditing. The use of sensitive and regulated data in different forms evolves throughout its lifecycle and processing supply chain.

The Critical Nature of Security Assessments

The usual timeline for picking up a breach can range from real time to a few days or even to a number of years. But most breaches are never even picked up at all.

Anytime you involve people, there’s potential for risk.

That’s why regular security assessments are critical to keep your network safe.
The hacking field is dynamic.

As new systems are developed, hackers find ways of breaking into them.

That’s why you need to have security assessments done regularly.

To find out more about how security assessments and training can minimize risk for your enterprise, reach out to one of our staff members.

at

[Tuesday, October 20, 2015](https://blog.telspace.co.za/2015/10/the-t-mobile-experian-hack-lessons-in.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/1070229256194171441)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=1070229256194171441&from=pencil "Edit Post")

Labels:
[2015](https://blog.telspace.co.za/search/label/2015),
[data breaches](https://blog.telspace.co.za/search/label/data%20breaches),
[Experian](https://blog.telspace.co.za/search/label/Experian),
[hacking](https://blog.telspace.co.za/search/label/hacking),
[pentesting](https://blog.telspace.co.za/search/label/pentesting),
[T-Mobile](https://blog.telspace.co.za/search/label/T-Mobile),
[vulnerability](https://blog.telspace.co.za/search/label/vulnerability)

[Older Posts](https://blog.telspace.co.za/search/label/pentesting?updated-max=2015-10-20T10:00:00%2B02:00&max-results=20&start=3&by-date=false "Older Posts")

[Home](https://blog.telspace.co.za/)

Subscribe to:
[Posts (Atom)](https://blog.telspace.co.za/feeds/posts/default)

[![](https://www.telspace.africa/img/tel27.jpg)](https://www.telspace.africa)

www.telspace.africa

| Blog Archive  * ▼   [2023](https://blog.telspace.co.za/2023/)   (2)   + ▼     [October](https://blog.telspace.co.za/2023/10/)     (1)     - [Transformative Journey: My Experience at the Telsp...](https://blog.telspace.co.za/2023/10/transformative-journey-my-experience-at.html)   + ►     [August](https://blog.telspace.co.za/2023/08/)     (1)  * ►   [2022](https://blog.telspace.co.za/2022/)   (2)   + ►     [July](https://blog.telspace.co.za/2022/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2022/05/)     (1)  * ►   [2021](https://blog.telspace.co.za/2021/)   (2)   + ►     [July](https://blog.telspace.co.za/2021/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2021/04/)     (1)  * ►   [2020](https://blog.telspace.co.za/2020/)   (8)   + ►     [December](https://blog.telspace.co.za/2020/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2020/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2020/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2020/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2020/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2020/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2020/01/)     (1)  * ►   [2019](https://blog.telspace.co.za/2019/)   (8)   + ►     [November](https://blog.telspace.co.za/2019/11/)     (1)   + ►     [September](https://blog.telspace.co.za/2019/09/)     (1)   + ►     [August](https://blog.telspace.co.za/2019/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2019/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2019/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2019/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2019/01/)     (1)  * ►   [2018](https://blog.telspace.co.za/2018/)   (3)   + ►     [March](https://blog.telspace.co.za/2018/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2018/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2018/01/)     (1)  * ►   [2017](https://blog.telspace.co.za/2017/)   (7)   + ►     [December](https://blog.telspace.co.za/2017/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2017/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2017/09/)     (4)   + ►     [February](https://blog.telspace.co.za/2017/02/)     (1)  * ►   [2016](https://blog.telspace.co.za/2016/)   (5)   + ►     [December](https://blog.telspace.co.za/2016/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2016/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2016/05/)     (3)  * ►   [2015](https://blog.telspace.co.za/2015/)   (7)   + ►     [December](https://blog.telspace.co.za/2015/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2015/10/)     (2)   + ►     [March](https://blog.telspace.co.za/2015/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2015/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2015/01/)     (1)  * ►   [2014](https://blog.telspace.co.za/2014/)   (14)   + ►     [October](https://blog.telspace.co.za/2014/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2014/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2014/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2014/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2014/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2014/04/)     (2)   + ►     [February](https://blog.telspace.co.za/2014/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2014/01/)     (2)  * ►   [2013](https://blog.telspace.co.za/2013/)   (15)   + ►     [December](https://blog.telspace.co.za/2013/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2013/11/)     (1)   + ►     [October](https://blog.telspace.co.za/2013/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2013/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2013/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2013/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2013/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2013/05/)     (4)   + ►     [April](https://blog.telspace.co.za/2013/04/)     (1)   + ►     [March](https://blog.telspace.co.za/2013/03/)     (1)  * ►   [2012](https://blog.telspace.co.za/2012/)   (5)   + ►     [October](https://blog.telspace.co.za/2012/10/)     (1)   + ►     [July](https://blog.telspace.co.za/2012/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2012/04/)     (1)   + ►     [January](https://blog.telspace.co.za/2012/01/)     (2)  * ►   [2011](https://blog.telspace.co.za/2011/)   (11)   + ►     [November](https://blog.telspace.co.za/2011/11/)     (2)   + ►     [August](https://blog.telspace.co.za/2011/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2011/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2011/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2011/04/)     (2)   + ►     [March](https://blog.telspace.co.za/2011/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2011/01/)     (2)  * ►   [2010](https://blog.telspace.co.za/2010/)   (15)   + ►     [December](https://blog.telspace.co.za/2010/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2010/11/)     (2)   + ►     [September](https://blog.telspace.co.za/2010/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2010/08/)     (1)   + ►     [July](https://blog.telspace.co.za/2010/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2010/05/)     (3)   + ►     [March](https://blog.telspace.co.za/2010/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2010/02/)     (3)  * ►   [2009](https://blog.telspace.co.za/2009/)   (10)   + ►     [September](https://blog.telspace.co.za/2009/09/)     (2)   + ►     [July](https://blog.telspace.co.za/2009/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2009/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2009/05/)     (1)   + ►     [February](https://blog.telspace.co.za/2009/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2009/01/)     (3)  * ►   [2008](https://blog.telspace.co.za/2008/)   (26)   + ►     [December](https://blog.telspace.co.za/2008/12/)     (4)   + ►     [November](https://blog.telspace.co.za/2008/11/)     (2)   + ►     [October](https://blog.telspace.co.za/2008/10/)     (4)   + ►     [September](https://blog.telspace.co.za/2008/09/)     (6)   + ►     [August](https://blog.telspace.co.za/2008/08/)     (3)   + ►     [July](https://blog.telspace.co.za/2008/07/)     (2)   + ►     [June](https://blog.telspace.co.za/2008/06/)     (3)   + ►     [May](https://blog.telspace.co.za/2008/05/)     (2) | Subscribe now!   Posts   [Atom](https://blog.telspace.co.za/feeds/posts/default)     Posts       All Comments   [Atom](https://blog.telspace.co.za/feeds/comments/default)     All Comments |
| --- | --- |

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).



=== Content from blog.telspace.co.za_1f128a1d_20250119_140247.html ===


# [Telspace Africa, The Blog](https://blog.telspace.co.za/)

Hackers for hire

Showing posts with label **code injection**. [Show all posts](https://blog.telspace.co.za/)

Showing posts with label **code injection**. [Show all posts](https://blog.telspace.co.za/)

## Thursday, July 9, 2020

### [phpList – CVE-2020-15072 & CVE-2020-15073 – Story Time](https://blog.telspace.co.za/2020/07/phplist-cve-2020-15072-cve-2020-15073.html)

phpList is currently used in 73 countries and is a popular choice for sending email newsletters, marketing campaigns and announcements. It is accessible via web browsers and is Open Source ([https://www.phplist.org](https://www.phplist.org/)), however a paid for version also exists as a service via [https://www.phplist.com](https://www.phplist.com/).

Given its wide use / adoption, I decided to take a look at phpList recently, in order to give back to the Open Source community.

I would also like to give credit to phpList for responding and patching very quickly, especially to Suela at phpList. A new version of the application is now available for download.

You can browse all the fixes, comments and patching by going to the following URLs:

·      <https://discuss.phplist.org/t/phplist-3-5-5-has-been-released/6377>
·      <https://www.phplist.org/newslist/phplist-3-5-5-release-notes/>
·      <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-15072>
·      <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-15073>

A walkthrough of the 2 identified vulnerabilities is given below:

## **1.) Code Injection via "Import administrators"**

1.1) Click on "Config" then "Import administrators"

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhyPppFv3ohHM2NT1LjJ6s6I6dhOId6El8OY15d4uKYzX-bfUk0zmqTqsHTyZ97n0JivDXXM-TtNJ_NB_qf2honm_ZGUA_fRzetB2a9KfiqzLIqKmqmVw_exQu672KG-VabCZEOhnFhKl61/s640/1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhyPppFv3ohHM2NT1LjJ6s6I6dhOId6El8OY15d4uKYzX-bfUk0zmqTqsHTyZ97n0JivDXXM-TtNJ_NB_qf2honm_ZGUA_fRzetB2a9KfiqzLIqKmqmVw_exQu672KG-VabCZEOhnFhKl61/s1600/1.png)
1.2) Edit a txt file to include basic headers and test (offline) as follows:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgwPKOi0iGqIe0P3pEW5ftErTZiITJk3xBIJmAw3O-19vuwQWYBj4GNwwQ-0oSyK-_eTQrZk2_Npa67HvarILopXHA5UDdsh7eIycClbmE4TX6wFyx4T-SZxQlOuWcDPCalcysQ2WH6C_9Q/s640/2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgwPKOi0iGqIe0P3pEW5ftErTZiITJk3xBIJmAw3O-19vuwQWYBj4GNwwQ-0oSyK-_eTQrZk2_Npa67HvarILopXHA5UDdsh7eIycClbmE4TX6wFyx4T-SZxQlOuWcDPCalcysQ2WH6C_9Q/s1600/2.png)

1.3) Click on "Choose File" and select the text file.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgvh7iweU5AySwLlTQa2RuAdW2-tc-73isJPSOxgTHsmIEo6G9w4YIYOBhFSo8kHa71vEiU9Dz-Vm7P1B6JpIp-jZxSWGv0tjzDfjyIoeI4y82MFKptTb7y3LlUQVYRJuraMIOpfHdIB6Lu/s640/3.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgvh7iweU5AySwLlTQa2RuAdW2-tc-73isJPSOxgTHsmIEo6G9w4YIYOBhFSo8kHa71vEiU9Dz-Vm7P1B6JpIp-jZxSWGv0tjzDfjyIoeI4y82MFKptTb7y3LlUQVYRJuraMIOpfHdIB6Lu/s1600/3.png)
1.4) Click "Do Import"

Code Injection Triggered (not stored)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgic4AdLYhrsjAfipXHah1jXJDYLtpkaAHa5MGpgksN81r4WA1P1vn4QGP_u2gAIM5rSOM_gwQ4EIGtOJI2RgapaXxK6eKVIXL7clJet__4k3lVGubPvxORvmYW4ttLlCPOAtyjibMJ10c9/s640/4.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgic4AdLYhrsjAfipXHah1jXJDYLtpkaAHa5MGpgksN81r4WA1P1vn4QGP_u2gAIM5rSOM_gwQ4EIGtOJI2RgapaXxK6eKVIXL7clJet__4k3lVGubPvxORvmYW4ttLlCPOAtyjibMJ10c9/s1600/4.png)
1.5) Go back to "Import administrators"
1.6) Untick "Test output:"

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj8b584eyAG_Cqdq1QWpLy7l_bAUfDYObDBi9IqsXzMWabTnszBBGiF-BWhyveTamgXeKp0adf6x7c4m4i8NVL1SqyWWgsK_yV2mR7fEh7y7h3PJiWZQr4u5hULLCLoK88w31Nty2qxgZgb/s640/5.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj8b584eyAG_Cqdq1QWpLy7l_bAUfDYObDBi9IqsXzMWabTnszBBGiF-BWhyveTamgXeKp0adf6x7c4m4i8NVL1SqyWWgsK_yV2mR7fEh7y7h3PJiWZQr4u5hULLCLoK88w31Nty2qxgZgb/s1600/5.png)

1.7) Click "Do Import" and you will get an import database error.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjuQW9yZdQfPXYvY4o7KKWn5jZXWM0dLt8PP3yszwY8EyWpflF3X7hKTx1-a5kQWPwZATPTTKB-MF0FmkO85rbtVihefHLTB2S7GlJ4j8Urn9P2spbpQzc3dxve1POff7ICjdW3NIVirALs/s640/6.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjuQW9yZdQfPXYvY4o7KKWn5jZXWM0dLt8PP3yszwY8EyWpflF3X7hKTx1-a5kQWPwZATPTTKB-MF0FmkO85rbtVihefHLTB2S7GlJ4j8Urn9P2spbpQzc3dxve1POff7ICjdW3NIVirALs/s1600/6.png)
1.8) Edit the same text file and add another user as follows:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgYPmTAJndxRf4vcUsSPNjYZiYFYVyIQXxnz0cfMzC-y2v7vAb31Yfkoadpk4seiDbHflcZquH3WfwKtlKPQP1p_K0j1ca4t4_9V6I6U3Ke0Furh26KRswcWiXmki3QfSJuUik4-GdTlWNn/s640/7.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgYPmTAJndxRf4vcUsSPNjYZiYFYVyIQXxnz0cfMzC-y2v7vAb31Yfkoadpk4seiDbHflcZquH3WfwKtlKPQP1p_K0j1ca4t4_9V6I6U3Ke0Furh26KRswcWiXmki3QfSJuUik4-GdTlWNn/s1600/7.png)
1.9) Go back to "Import administrators"
1.10) Click on "Choose File" and choose the text file.
1.11) Untick "Test output:"

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0ofAb_8LvIb0FHFjkG4YLlqh0np36tRl5VoH9Amh3KWd1eg4k9DSfvCRyJr-Fj-OLeYcE7g3xpT_BN_jFiNAc2ViANCzVvsePsaWfXQ7QANTcP_a_dbp5II_SRiDtyAvCrrz1_PUTbmFC/s640/8.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0ofAb_8LvIb0FHFjkG4YLlqh0np36tRl5VoH9Amh3KWd1eg4k9DSfvCRyJr-Fj-OLeYcE7g3xpT_BN_jFiNAc2ViANCzVvsePsaWfXQ7QANTcP_a_dbp5II_SRiDtyAvCrrz1_PUTbmFC/s1600/8.png)
1.12) Click "Do Import" and you will get more import database errors
1.13) Browse to "Subscribers" then "Subscriber Lists"

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPmMrCXyHEnVbqdoC87sIqCwbs_1r2OBaPy5pLCrT-8xLboYFBBziDyGk7AQzeEUeGudQDBrLbtYAmxD6T05ZTw9V8wUE2xRiXkFj0bCsLT00X9DokwYJPwnVNm16KdTaovRC2zr4CjsMR/s640/9.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPmMrCXyHEnVbqdoC87sIqCwbs_1r2OBaPy5pLCrT-8xLboYFBBziDyGk7AQzeEUeGudQDBrLbtYAmxD6T05ZTw9V8wUE2xRiXkFj0bCsLT00X9DokwYJPwnVNm16KdTaovRC2zr4CjsMR/s1600/9.png)
1.14) Click on the first one and you'll get a "hi" popup:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh39UGw9sJIAMhVI9OagcsCODm4um9qGrSUPnN9blTxDANPcCWGOqdlr8LCdqoesEc0NjOuvlnQlY3r2SHquH3xReuKuXw688xrUDZJHli4JqyrTOrKDBsODcZZLdgcWnhGu4VoY3nJNoOQ/s640/10.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh39UGw9sJIAMhVI9OagcsCODm4um9qGrSUPnN9blTxDANPcCWGOqdlr8LCdqoesEc0NjOuvlnQlY3r2SHquH3xReuKuXw688xrUDZJHli4JqyrTOrKDBsODcZZLdgcWnhGu4VoY3nJNoOQ/s1600/10.png)
 1.15) Go back and click on the second one and you'll get a cookie.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiz07ar6YdyKGZ4K_aLR8G8M8m2SgktgbWypmtca56Qfbri2sDeRoI0L4czb8j-qkQSpW5gsDrsk9XSpILHpLIqjhPAxcI8KoKLHA5izCV-F2bRdBYBp0fGN1MeisNeSydKDVfZd3YrYEBT/s640/11.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiz07ar6YdyKGZ4K_aLR8G8M8m2SgktgbWypmtca56Qfbri2sDeRoI0L4czb8j-qkQSpW5gsDrsk9XSpILHpLIqjhPAxcI8KoKLHA5izCV-F2bRdBYBp0fGN1MeisNeSydKDVfZd3YrYEBT/s1600/11.png)

## **2.) Error based SQL Injection via "Import administrators"**

2.1) Click on "Config" then "Import administrators"
2.2) Edit a txt file to include basic headers and text (offline) as follows

email   loginname      password

test2@test.com          "'testsql          test

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhGbYsXFzmDJ5iWWP4c2HzU40ddbxAVCm1t7W6_lM0hJElHVusQDZKq1wPs8RUNLP1bOJouI4YK_1muJqlVjErI9Hfa9aIMrU7ujCbDfuHuY62JItMbuki0__Em9n12PHil7WeLaCfwJXkn/s640/12.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhGbYsXFzmDJ5iWWP4c2HzU40ddbxAVCm1t7W6_lM0hJElHVusQDZKq1wPs8RUNLP1bOJouI4YK_1muJqlVjErI9Hfa9aIMrU7ujCbDfuHuY62JItMbuki0__Em9n12PHil7WeLaCfwJXkn/s1600/12.png)
2.3) Untick "Test output:"
2.4) Click on "Choose File" and choose the text file.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg7svvZIQqFpA0aWRFPRMfR9uEp5I-l8nkHV2jxgiSOIkdBoZwsn7_3Z5_Z2IL8ShXixWTw9o43Tt_gMECC_lhT9TPX5GCNbh1LBaA2og3CHcuNEfE0MjqzQ19elWjcZydH4VfzRmOSVy3t/s640/13.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg7svvZIQqFpA0aWRFPRMfR9uEp5I-l8nkHV2jxgiSOIkdBoZwsn7_3Z5_Z2IL8ShXixWTw9o43Tt_gMECC_lhT9TPX5GCNbh1LBaA2og3CHcuNEfE0MjqzQ19elWjcZydH4VfzRmOSVy3t/s1600/13.png)

 2.5) Click "Do Import" - you'll see the Error Based SQL injection.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjANUdklmTFIgLcH0aBiHikAst6LrVbZ6vqsWQ9OIqAhDTATmBrfzzufhVN2UumiMPO-eEjVC0ibcukbPP9hpewuDK_0UPBe14uRJTbGyG0KuC2KUhqdcP0Lqgg1ft6rk49IDVqU5yi8DRb/s640/14.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjANUdklmTFIgLcH0aBiHikAst6LrVbZ6vqsWQ9OIqAhDTATmBrfzzufhVN2UumiMPO-eEjVC0ibcukbPP9hpewuDK_0UPBe14uRJTbGyG0KuC2KUhqdcP0Lqgg1ft6rk49IDVqU5yi8DRb/s1600/14.png)

*Creative Commons - Attribution-ShareAlike 4.0 International (CC BY-SA 4.0) - <https://creativecommons.org/licenses/by-sa/4.0/>*

at

[Thursday, July 09, 2020](https://blog.telspace.co.za/2020/07/phplist-cve-2020-15072-cve-2020-15073.html "permanent link")

[1 comment:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/6349469799071097550)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=6349469799071097550&from=pencil "Edit Post")

Labels:
[2020](https://blog.telspace.co.za/search/label/2020),
[code injection](https://blog.telspace.co.za/search/label/code%20injection),
[CVE-2020-15072](https://blog.telspace.co.za/search/label/CVE-2020-15072),
[CVE-2020-15073](https://blog.telspace.co.za/search/label/CVE-2020-15073),
[phpList](https://blog.telspace.co.za/search/label/phpList),
[security advisory](https://blog.telspace.co.za/search/label/security%20advisory),
[sql injection](https://blog.telspace.co.za/search/label/sql%20injection)

## Tuesday, June 23, 2020

### [Pi-hole Code Injection – CVE-2020-14971– Story Time](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html)

A while ago, we had an internal discussion around people working from home and the technologies/products that could be implemented and/or bought to protect home users. This was due to the implementation of the nationwide lockdown which resulted in companies being forced to change their approach entirely to having employees work from home.

During this discussion the Pi-hole was mentioned. Pi-hole is a very popular option for the more “tech savvy” home user and generally, anyone that’s tired of being spammed with random adverts on every website. You can find more information about it here <https://github.com/pi-hole/pi-hole/>.

Since I had a Pi-hole installed already, I decided to take a look at this beautiful piece of ad blocking software in more detail, specifically reviewing the code and logic of the application. Because it’s Opensource and available freely, this was easily accomplished by downloading and installing the latest Pi-hole (v5.0 at the time).

It’s worth mentioning that a lot of vulnerabilities had already been found in this software, some overlapped with findings that I had found particularly during April and May, which were rightfully allocated to the first people that reported the issues. With that being said, the Pi-hole is a popular target for researchers and adds a lot of value to people’s home and small office environments, so the more findings and fixes the better. I also wanted to focus on the latest version because of this.

Initially, I had found a few critical security vulnerabilities but many had been found and fixed already and others eventually required local shell access in some form, some functionality had been changed over time, which solved those particular RCE issues too. So, I therefore looked at a few other vectors and decided to focus on one specific attack vector, which looked promising.

## **Backup Functions:**

Settings.php has lots of functionality, one of which allows users to back up and restore (export and import) configurations of the Pi-hole with a limited set of files (teleporter tab).

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s640/Screen+Shot+2020-06-18+at+4.31.19+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.31.19%2BPM.png)

This was interesting for me because when you export files, they are compressed in tar.gz format and saved. Upon decompression and by systematically reviewing each file that was saved, I found that there were several files which were useful and easy wins for RCE, in particular if no whitelisting and sanitising was taking place. However, those particular ones are not restored if you modify them, re-compress and upload to restore the backup.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s640/Screen+Shot+2020-06-18+at+4.35.31+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.35.31%2BPM.png)

In this instance though, the affected files I found are dnsmasq.d configuration files and the adlist.json file. The dnsmasq.d/04-pi-hole-static-dhcp.conf file allows static DHCP leases, which link to MAC, IP and host.

I modified the configuration file for dnsmasq.d initially, in which I added my own code for the host parameter. Once I did this, I recompressed the file accordingly and imported the file back in via teleporter:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s640/Screen+Shot+2020-06-18+at+4.38.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.38.14%2BPM.png)

Upon browsing to the static DHCP leases section of the Pi-hole web interface, I could see my code was executing correctly i.e. I had found a Code Injection vulnerability.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s640/Screen+Shot+2020-06-18+at+4.39.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.39.14%2BPM.png)

The same then applied to adlists.json and other parameters in other files, as all the files were not being properly checked upon upload, they also just overwrote whatever was previously there and therefore your code executed accordingly:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s640/Screen+Shot+2020-06-22+at+10.13.18+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s1600/Screen%2BShot%2B2020-06-22%2Bat%2B10.13.18%2BPM.png)

Browse to host/admin/groups-adlists.php and you should get the ‘Adam popup’:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s640/Screen+Shot+2020-06-18+at+4.45.47+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.45.47%2BPM.png)

There are more examples, however it’s more of the same as what has been discussed above. I would also like to mention, that the Pi-hole is an amazing piece of software, built by people who really care for the community, please support them and donate. All the responses (especially from Adam) were really quick and things were patched exceptionally quickly.

You can browse all the fixes, comments and progress of patching by going here:

<https://github.com/pi-hole/AdminLTE/commit/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-640920508>

<https://github.com/pi-hole/AdminLTE/commit/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-643830404>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14971>

at

[Tuesday, June 23, 2020](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/4313565159762696677)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=4313565159762696677&from=pencil "Edit Post")

Labels:
[0day](https://blog.telspace.co.za/search/label/0day),
[2020](https://blog.telspace.co.za/search/label/2020),
[code injection](https://blog.telspace.co.za/search/label/code%20injection),
[CVE-2020-14971](https://blog.telspace.co.za/search/label/CVE-2020-14971),
[pentesting](https://blog.telspace.co.za/search/label/pentesting),
[pihole](https://blog.telspace.co.za/search/label/pihole)

[Older Posts](https://blog.telspace.co.za/search/label/code%20injection?updated-max=2020-06-23T11:01:00%2B02:00&max-results=20&start=20&by-date=false "Older Posts")

[Home](https://blog.telspace.co.za/)

Subscribe to:
[Posts (Atom)](https://blog.telspace.co.za/feeds/posts/default)

[![](https://www.telspace.africa/img/tel27.jpg)](https://www.telspace.africa)

www.telspace.africa

| Blog Archive  * ▼   [2023](https://blog.telspace.co.za/2023/)   (2)   + ▼     [October](https://blog.telspace.co.za/2023/10/)     (1)     - [Transformative Journey: My Experience at the Telsp...](https://blog.telspace.co.za/2023/10/transformative-journey-my-experience-at.html)   + ►     [August](https://blog.telspace.co.za/2023/08/)     (1)  * ►   [2022](https://blog.telspace.co.za/2022/)   (2)   + ►     [July](https://blog.telspace.co.za/2022/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2022/05/)     (1)  * ►   [2021](https://blog.telspace.co.za/2021/)   (2)   + ►     [July](https://blog.telspace.co.za/2021/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2021/04/)     (1)  * ►   [2020](https://blog.telspace.co.za/2020/)   (8)   + ►     [December](https://blog.telspace.co.za/2020/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2020/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2020/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2020/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2020/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2020/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2020/01/)     (1)  * ►   [2019](https://blog.telspace.co.za/2019/)   (8)   + ►     [November](https://blog.telspace.co.za/2019/11/)     (1)   + ►     [September](https://blog.telspace.co.za/2019/09/)     (1)   + ►     [August](https://blog.telspace.co.za/2019/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2019/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2019/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2019/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2019/01/)     (1)  * ►   [2018](https://blog.telspace.co.za/2018/)   (3)   + ►     [March](https://blog.telspace.co.za/2018/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2018/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2018/01/)     (1)  * ►   [2017](https://blog.telspace.co.za/2017/)   (7)   + ►     [December](https://blog.telspace.co.za/2017/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2017/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2017/09/)     (4)   + ►     [February](https://blog.telspace.co.za/2017/02/)     (1)  * ►   [2016](https://blog.telspace.co.za/2016/)   (5)   + ►     [December](https://blog.telspace.co.za/2016/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2016/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2016/05/)     (3)  * ►   [2015](https://blog.telspace.co.za/2015/)   (7)   + ►     [December](https://blog.telspace.co.za/2015/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2015/10/)     (2)   + ►     [March](https://blog.telspace.co.za/2015/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2015/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2015/01/)     (1)  * ►   [2014](https://blog.telspace.co.za/2014/)   (14)   + ►     [October](https://blog.telspace.co.za/2014/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2014/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2014/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2014/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2014/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2014/04/)     (2)   + ►     [February](https://blog.telspace.co.za/2014/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2014/01/)     (2)  * ►   [2013](https://blog.telspace.co.za/2013/)   (15)   + ►     [December](https://blog.telspace.co.za/2013/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2013/11/)     (1)   + ►     [October](https://blog.telspace.co.za/2013/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2013/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2013/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2013/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2013/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2013/05/)     (4)   + ►     [April](https://blog.telspace.co.za/2013/04/)     (1)   + ►     [March](https://blog.telspace.co.za/2013/03/)     (1)  * ►   [2012](https://blog.telspace.co.za/2012/)   (5)   + ►     [October](https://blog.telspace.co.za/2012/10/)     (1)   + ►     [July](https://blog.telspace.co.za/2012/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2012/04/)     (1)   + ►     [January](https://blog.telspace.co.za/2012/01/)     (2)  * ►   [2011](https://blog.telspace.co.za/2011/)   (11)   + ►     [November](https://blog.telspace.co.za/2011/11/)     (2)   + ►     [August](https://blog.telspace.co.za/2011/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2011/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2011/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2011/04/)     (2)   + ►     [March](https://blog.telspace.co.za/2011/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2011/01/)     (2)  * ►   [2010](https://blog.telspace.co.za/2010/)   (15)   + ►     [December](https://blog.telspace.co.za/2010/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2010/11/)     (2)   + ►     [September](https://blog.telspace.co.za/2010/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2010/08/)     (1)   + ►     [July](https://blog.telspace.co.za/2010/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2010/05/)     (3)   + ►     [March](https://blog.telspace.co.za/2010/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2010/02/)     (3)  * ►   [2009](https://blog.telspace.co.za/2009/)   (10)   + ►     [September](https://blog.telspace.co.za/2009/09/)     (2)   + ►     [July](https://blog.telspace.co.za/2009/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2009/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2009/05/)     (1)   + ►     [February](https://blog.telspace.co.za/2009/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2009/01/)     (3)  * ►   [2008](https://blog.telspace.co.za/2008/)   (26)   + ►     [December](https://blog.telspace.co.za/2008/12/)     (4)   + ►     [November](https://blog.telspace.co.za/2008/11/)     (2)   + ►     [October](https://blog.telspace.co.za/2008/10/)     (4)   + ►     [September](https://blog.telspace.co.za/2008/09/)     (6)   + ►     [August](https://blog.telspace.co.za/2008/08/)     (3)   + ►     [July](https://blog.telspace.co.za/2008/07/)     (2)   + ►     [June](https://blog.telspace.co.za/2008/06/)     (3)   + ►     [May](https://blog.telspace.co.za/2008/05/)     (2) | Subscribe now!   Posts   [Atom](https://blog.telspace.co.za/feeds/posts/default)     Posts       All Comments   [Atom](https://blog.telspace.co.za/feeds/comments/default)     All Comments |
| --- | --- |

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).



=== Content from github.com_e6ea975b_20250119_122413.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Fcommit%2Fc949516ee15fa6a9b0c8511cc4c4d6b0893f3e69)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Fcommit%2Fc949516ee15fa6a9b0c8511cc4c4d6b0893f3e69)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=pi-hole%2Fweb)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pi-hole](/pi-hole)
/
**[web](/pi-hole/web)**
Public

* [Notifications](/login?return_to=%2Fpi-hole%2Fweb) You must be signed in to change notification settings
* [Fork
  566](/login?return_to=%2Fpi-hole%2Fweb)
* [Star
   2.1k](/login?return_to=%2Fpi-hole%2Fweb)

* [Code](/pi-hole/web)
* [Issues
  19](/pi-hole/web/issues)
* [Pull requests
  8](/pi-hole/web/pulls)
* [Actions](/pi-hole/web/actions)
* [Projects
  1](/pi-hole/web/projects)
* [Security](/pi-hole/web/security)
* [Insights](/pi-hole/web/pulse)

Additional navigation options

* [Code](/pi-hole/web)
* [Issues](/pi-hole/web/issues)
* [Pull requests](/pi-hole/web/pulls)
* [Actions](/pi-hole/web/actions)
* [Projects](/pi-hole/web/projects)
* [Security](/pi-hole/web/security)
* [Insights](/pi-hole/web/pulse)

## Commit

[Permalink](/pi-hole/web/commit/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

make use of utils.escapeHtml on the JS side of things, and html\_entit…

[Browse files](/pi-hole/web/tree/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69)
Browse the repository at this point in the history

```
…y_decode/htmlentities in PHP

Signed-off-by: Adam Warner <me@adamwarner.co.uk>
```

* Loading branch information

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&v=4)](/PromoFaux)

[PromoFaux](/pi-hole/web/commits?author=PromoFaux "View all commits by PromoFaux")
committed
Jun 13, 2020

1 parent
[557bd85](/pi-hole/web/commit/557bd85814d019e292430de0c92f288815d5a7ea)

commit c949516

 Show file tree

 Hide file tree

Showing
**11 changed files**
with
**67 additions**
and
**58 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* dns\_records.php
  [dns\_records.php](#diff-c774391bc2aa6a11307c7d5b9409fae96627fabecd2de8cfba1f3ca86e4e627e)
* scripts/pi-hole

  + js

    - scripts/pi-hole/js/customdns.js
      [customdns.js](#diff-05a1ed5d21ec748b07195295509e96173863e2b6774b6047901064a0bc5f307a)
    - scripts/pi-hole/js/groups-adlists.js
      [groups-adlists.js](#diff-0d51bd7fa81d8b76d2f21d81a2a0f98043fb77583047890c5d8cb98480011201)
    - scripts/pi-hole/js/groups-clients.js
      [groups-clients.js](#diff-92db2fbf3547db9b4fec881c5a23696b7b8564b5e653a85064caf1708672e02b)
    - scripts/pi-hole/js/groups-domains.js
      [groups-domains.js](#diff-e3389019dec1611c840a73471f9c0c83c71fb43b8b136ac08881d29fc9297a2d)
    - scripts/pi-hole/js/groups.js
      [groups.js](#diff-6ca30074fe0df89cff2a614eccc087d96ed10e7babc1b058422e6d79959c2513)
  + php

    - scripts/pi-hole/php/database.php
      [database.php](#diff-e1491076035a600b320c3583244e4281de0a206129d70a0e44e3b8b417eec66b)
    - scripts/pi-hole/php/func.php
      [func.php](#diff-aed49e3ae21b6a9df9cf7abfca098dff9aab23413dbe8ce747eba73130d9576a)
    - scripts/pi-hole/php/groups.php
      [groups.php](#diff-8d18abbe77d19d00dbe4dbe76db69ec925fb010449a4b6d54c2e8dce9c0ddb0f)
    - scripts/pi-hole/php/teleporter.php
      [teleporter.php](#diff-47e05d1d5ece47ad81a8c18e3bd533f93d456f6497f1a86bcaf2a94cd74b067e)
* settings.php
  [settings.php](#diff-4092c491c25e7e19aceafbe3c49d234ce7d1eca769519197d2ccba7bde75a27e)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[dns\_records.php](#diff-c774391bc2aa6a11307c7d5b9409fae96627fabecd2de8cfba1f3ca86e4e627e "dns_records.php")

Show comments

[View file](/pi-hole/web/blob/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69/dns_records.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -89,6 +89,7 @@ |
|  |  | </div> |
|  |  | </div> |
|  |  |  |
|  |  | <script src="scripts/pi-hole/js/utils.js"></script> |
|  |  | <script src="scripts/pi-hole/js/ip-address-sorting.js"></script> |
|  |  | <script src="scripts/pi-hole/js/customdns.js"></script> |
|  |  |  |
| Expand Down | |  |

6 changes: 4 additions & 2 deletions

6
[scripts/pi-hole/js/customdns.js](#diff-05a1ed5d21ec748b07195295509e96173863e2b6774b6047901064a0bc5f307a "scripts/pi-hole/js/customdns.js")

Show comments

[View file](/pi-hole/web/blob/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69/scripts/pi-hole/js/customdns.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,6 +5,8 @@ |
|  |  | \* This file is copyright under the latest version of the EUPL. |
|  |  | \* Please see LICENSE file for your rights under this license. \*/ |
|  |  |  |
|  |  | /\* global utils:false \*/ |
|  |  |  |
|  |  | var table; |
|  |  | var token = $("#token").text(); |
|  |  |  |
| Expand Down  Expand Up | | @@ -76,8 +78,8 @@ $(function () { |
|  |  | }); |
|  |  |  |
|  |  | function addCustomDNS() { |
|  |  | var ip = $("#ip").val(); |
|  |  | var domain = $("#domain").val(); |
|  |  | var ip = utils.escapeHtml($("#ip").val()); |
|  |  | var domain = utils.escapeHtml($("#domain").val()); |
|  |  |  |
|  |  | showAlert("info"); |
|  |  | $.ajax({ |
| Expand Down | |  |

10 changes: 5 additions & 5 deletions

10
[scripts/pi-hole/js/groups-adlists.js](#diff-0d51bd7fa81d8b76d2f21d81a2a0f98043fb77583047890c5d8cb98480011201 "scripts/pi-hole/js/groups-adlists.js")

Show comments

[View file](/pi-hole/web/blob/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69/scripts/pi-hole/js/groups-adlists.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -212,8 +212,8 @@ function initTable() { |
|  |  | } |
|  |  |  |
|  |  | function addAdlist() { |
|  |  | var address = $("#new\_address").val(); |
|  |  | var comment = $("#new\_comment").val(); |
|  |  | var address = utils.escapeHtml($("#new\_address").val()); |
|  |  | var comment = utils.escapeHtml($("#new\_comment").val()); |
|  |  |  |
|  |  | utils.disableAll(); |
|  |  | utils.showAlert("info", "", "Adding adlist...", address); |
| Expand Down  Expand Up | | @@ -258,9 +258,9 @@ function editAdlist() { |
|  |  | var tr = $(this).closest("tr"); |
|  |  | var id = tr.attr("data-id"); |
|  |  | var status = tr.find("#status\_" + id).is(":checked") ? 1 : 0; |
|  |  | var comment = tr.find("#comment\_" + id).val(); |
|  |  | var comment = utils.escapeHtml(tr.find("#comment\_" + id).val()); |
|  |  | var groups = tr.find("#multiselect\_" + id).val(); |
|  |  | var address = tr.find("#address\_" + id).text(); |
|  |  | var address = utils.escapeHtml(tr.find("#address\_" + id).text()); |
|  |  |  |
|  |  | var done = "edited"; |
|  |  | var notDone = "editing"; |
| Expand Down  Expand Up | | @@ -338,7 +338,7 @@ function editAdlist() { |
|  |  | function deleteAdlist() { |
|  |  | var tr = $(this).closest("tr"); |
|  |  | var id = tr.attr("data-id"); |
|  |  | var address = tr.find("#address\_" + id).text(); |
|  |  | var address = utils.escapeHtml(tr.find("#address\_" + id).text()); |
|  |  |  |
|  |  | utils.disableAll(); |
|  |  | utils.showAlert("info", "", "Deleting adlist...", address); |
| Expand Down | |  |

12 changes: 6 additions & 6 deletions

12
[scripts/pi-hole/js/groups-clients.js](#diff-92db2fbf3547db9b4fec881c5a23696b7b8564b5e653a85064caf1708672e02b "scripts/pi-hole/js/groups-clients.js")

Show comments

[View file](/pi-hole/web/blob/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69/scripts/pi-hole/js/groups-clients.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -246,9 +246,9 @@ function initTable() { |
|  |  |  |
|  |  | function addClient() { |
|  |  | var ip = $("#select").val(); |
|  |  | var comment = $("#new\_comment").val(); |
|  |  | var comment = utils.escapeHtml($("#new\_comment").val()); |
|  |  | if (ip === "custom") { |
|  |  | ip = $("#ip-custom").val().trim(); |
|  |  | ip = utils.escapeHtml($("#ip-custom").val().trim()); |
|  |  | } |
|  |  |  |
|  |  | utils.disableAll(); |
| Expand Down  Expand Up | | @@ -303,9 +303,9 @@ function editClient() { |
|  |  | var tr = $(this).closest("tr"); |
|  |  | var id = tr.attr("data-id"); |
|  |  | var groups = tr.find("#multiselect\_" + id).val(); |
|  |  | var ip = tr.find("#ip\_" + id).text(); |
|  |  | var name = tr.find("#name\_" + id).text(); |
|  |  | var comment = tr.find("#comment\_" + id).val(); |
|  |  | var ip = utils.escapeHtml(tr.find("#ip\_" + id).text()); |
|  |  | var name = utils.escapeHtml(tr.find("#name\_" + id).text()); |
|  |  | var comment = utils.escapeHtml(tr.find("#comment\_" + id).val()); |
|  |  |  |
|  |  | var done = "edited"; |
|  |  | var notDone = "editing"; |
| Expand Down  Expand Up | | @@ -370,7 +370,7 @@ function deleteClient() { |
|  |  | var tr = $(this).closest("tr"); |
|  |  | var id = tr.attr("data-id"); |
|  |  | var ip = tr.find("#ip\_" + id).text(); |
|  |  | var name = tr.find("#name\_" + id).text(); |
|  |  | var name = utils.escapeHtml(tr.find("#name\_" + id).text()); |
|  |  |  |
|  |  | if (name.length > 0) { |
|  |  | ip += " (" + name + ")"; |
| Expand Down | |  |

10 changes: 5 additions & 5 deletions

10
[scripts/pi-hole/js/groups-domains.js](#diff-e3389019dec1611c840a73471f9c0c83c71fb43b8b136ac08881d29fc9297a2d "scripts/pi-hole/js/groups-domains.js")

Show comments

[View file](/pi-hole/web/blob/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69/scripts/pi-hole/js/groups-domains.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -318,8 +318,8 @@ function addDomain() { |
|  |  | commentEl = $("#new\_regex\_comment"); |
|  |  | } |
|  |  |  |
|  |  | var domain = domainEl.val(); |
|  |  | var comment = commentEl.val(); |
|  |  | var domain = utils.escapeHtml(domainEl.val()); |
|  |  | var comment = utils.escapeHtml(commentEl.val()); |
|  |  |  |
|  |  | utils.disableAll(); |
|  |  | utils.showAlert("info", "", "Adding " + domainRegex + "...", domain); |
| Expand Down  Expand Up | | @@ -385,10 +385,10 @@ function editDomain() { |
|  |  | var elem = $(this).attr("id"); |
|  |  | var tr = $(this).closest("tr"); |
|  |  | var id = tr.attr("data-id"); |
|  |  | var domain = tr.find("#domain\_" + id).text(); |
|  |  | var domain = utils.escapeHtml(tr.find("#domain\_" + id).text()); |
|  |  | var type = tr.find("#type\_" + id).val(); |
|  |  | var status = tr.find("#status\_" + id).is(":checked") ? 1 : 0; |
|  |  | var comment = tr.find("#comment\_" + id).val(); |
|  |  | var comment = utils.escapeHtml(tr.find("#comment\_" + id).val()); |
|  |  |  |
|  |  | // Show group assignment field only if in full domain management mode |
|  |  | // if not included, just use the row data. |
| Expand Down  Expand Up | | @@ -485,7 +485,7 @@ function editDomain() { |
|  |  | function deleteDomain() { |
|  |  | var tr = $(this).closest("tr"); |
|  |  | var id = tr.attr("data-id"); |
|  |  | var domain = tr.find("#domain\_" + id).text(); |
|  |  | var domain = utils.escapeHtml(tr.find("#domain\_" + id).text()); |
|  |  | var type = tr.find("#type\_" + id).val(); |
|  |  |  |
|  |  | var domainRegex; |
| Expand Down | |  |

10 changes: 5 additions & 5 deletions

10
[scripts/pi-hole/js/groups.js](#diff-6ca30074fe0df89cff2a614eccc087d96ed10e7babc1b058422e6d79959c2513 "scripts/pi-hole/js/groups.js")

Show comments

[View file](/pi-hole/web/blob/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69/scripts/pi-hole/js/groups.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -127,8 +127,8 @@ $(function () { |
|  |  | }); |
|  |  |  |
|  |  | function addGroup() { |
|  |  | var name = $("#new\_name").val(); |
|  |  | var desc = $("#new\_desc").val(); |
|  |  | var name = utils.escapeHtml($("#new\_name").val()); |
|  |  | var desc = utils.escapeHtml($("#new\_desc").val()); |
|  |  |  |
|  |  | utils.disableAll(); |
|  |  | utils.showAlert("info", "", "Adding group...", name); |
| Expand Down  Expand Up | | @@ -166,9 +166,9 @@ function editGroup() { |
|  |  | var elem = $(this).attr("id"); |
|  |  | var tr = $(this).closest("tr"); |
|  |  | var id = tr.attr("data-id"); |
|  |  | var name = tr.find("#name\_" + id).val(); |
|  |  | var name = utils.escapeHtml(tr.find("#name\_" + id).val()); |
|  |  | var status = tr.find("#status\_" + id).is(":checked") ? 1 : 0; |
|  |  | var desc = tr.find("#desc\_" + id).val(); |
|  |  | var desc = utils.escapeHtml(tr.find("#desc\_" + id).val()); |
|  |  |  |
|  |  | var done = "edited"; |
|  |  | var notDone = "editing"; |
| Expand Down  Expand Up | | @@ -239,7 +239,7 @@ function editGroup() { |
|  |  | function deleteGroup() { |
|  |  | var tr = $(this).closest("tr"); |
|  |  | var id = tr.attr("data-id"); |
|  |  | var name = tr.find("#name\_" + id).val(); |
|  |  | var name = utils.escapeHtml(tr.find("#name\_" + id).val()); |
|  |  |  |
|  |  | utils.disableAll(); |
|  |  | utils.showAlert("info", "", "Deleting group...", name); |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[scripts/pi-hole/php/database.php](#diff-e1491076035a600b320c3583244e4281de0a206129d70a0e44e3b8b417eec66b "scripts/pi-hole/php/database.php")

Show comments

[View file](/pi-hole/web/blob/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69/scripts/pi-hole/php/database.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -161,9 +161,9 @@ function add\_to\_table($db, $table, $domains, $comment=null, $wildcardstyle=false |
|  |  | if($wildcardstyle) |
|  |  | $domain = "(\\.|^)".str\_replace(".","\\.",$domain)."$"; |
|  |  |  |
|  |  | $stmt->bindValue(":$field", $domain, SQLITE3\_TEXT); |
|  |  | $stmt->bindValue(":$field", htmlentities($domain), SQLITE3\_TEXT); |
|  |  | if($bindcomment) { |
|  |  | $stmt->bindValue(":comment", $comment, SQLITE3\_TEXT); |
|  |  | $stmt->bindValue(":comment", htmlentities($comment), SQLITE3\_TEXT); |
|  |  | } |
|  |  |  |
|  |  | if($stmt->execute() && $stmt->reset()) |
| Expand Down | |  |

39 changes: 21 additions & 18 deletions

39
[scripts/pi-hole/php/func.php](#diff-aed49e3ae21b6a9df9cf7abfca098dff9aab23413dbe8ce747eba73130d9576a "scripts/pi-hole/php/func.php")

Show comments

[View file](/pi-hole/web/blob/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69/scripts/pi-hole/php/func.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -214,31 +214,34 @@ function deleteCustomDNSEntry() |
|  |  |  |
|  |  | function deleteAllCustomDNSEntries() |
|  |  | { |
|  |  | $handle = fopen($customDNSFile, "r"); |
|  |  | if ($handle) |
|  |  | if (isset($customDNSFile)) |
|  |  | { |
|  |  | try |
|  |  | $handle = fopen($customDNSFile, "r"); |
|  |  | if ($handle) |
|  |  | { |
|  |  | while (($line = fgets($handle)) !== false) { |
|  |  | $line = str\_replace("\r","", $line); |
|  |  | $line = str\_replace("\n","", $line); |
|  |  | $explodedLine = explode (" ", $line); |
|  |  | try |
|  |  | { |
|  |  | while (($line = fgets($handle)) !== false) { |
|  |  | $line = str\_replace("\r","", $line); |
|  |  | $line = str\_replace("\n","", $line); |
|  |  | $explodedLine = explode (" ", $line); |
|  |  |  |
|  |  | if (count($explodedLine) != 2) |
|  |  | continue; |
|  |  | if (count($explodedLine) != 2) |
|  |  | continue; |
|  |  |  |
|  |  | $ip = $explodedLine[0]; |
|  |  | $domain = $explodedLine[1]; |
|  |  | $ip = $explodedLine[0]; |
|  |  | $domain = $explodedLine[1]; |
|  |  |  |
|  |  | pihole\_execute("-a removecustomdns ".$ip." ".$domain); |
|  |  | pihole\_execute("-a removecustomdns ".$ip." ".$domain); |
|  |  | } |
|  |  | } |
|  |  | catch (\Exception $ex) |
|  |  | { |
|  |  | return errorJsonResponse($ex->getMessage()); |
|  |  | } |
|  |  | } |
|  |  | catch (\Exception $ex) |
|  |  | { |
|  |  | return errorJsonResponse($ex->getMessage()); |
|  |  | } |
|  |  |  |
|  |  | fclose($handle); |
|  |  | fclose($handle); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | return successJsonResponse(); |
| Expand Down | |  |

25 changes: 14 additions & 11 deletions

25
[scripts/pi-hole/php/groups.php](#diff-8d18abbe77d19d00dbe4dbe76db69ec925fb010449a4b6d54c2e8dce9c0ddb0f "scripts/pi-hole/php/groups.php")

Show comments

[View file](/pi-hole/web/blob/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69/scripts/pi-hole/php/groups.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -58,7 +58,8 @@ function JSON\_error($message = null) |
|  |  | } elseif ($\_POST['action'] == 'add\_group') { |
|  |  | // Add new group |
|  |  | try { |
|  |  | $names = str\_getcsv(trim($\_POST['name']), ' '); |
|  |  | $input = html\_entity\_decode(trim($\_POST['name'])); |
|  |  | $names = str\_getcsv($input, ' '); |
|  |  | $total = count($names); |
|  |  | $added = 0; |
|  |  | $stmt = $db->prepare('INSERT INTO "group" (name,description) VALUES (:name,:desc)'); |
| Expand Down  Expand Up | | @@ -96,6 +97,9 @@ function JSON\_error($message = null) |
|  |  | } elseif ($\_POST['action'] == 'edit\_group') { |
|  |  | // Edit group identified by ID |
|  |  | try { |
|  |  | $name = html\_entity\_decode($\_POST['name']); |
|  |  | $desc = html\_entity\_decode($\_POST['desc']); |
|  |  |  |
|  |  | $stmt = $db->prepare('UPDATE "group" SET enabled=:enabled, name=:name, description=:desc WHERE id = :id'); |
|  |  | if (!$stmt) { |
|  |  | throw new Exception('While preparing statement: ' . $db->lastErrorMsg()); |
| Expand All | | @@ -106,11 +110,10 @@ function JSON\_error($message = null) |
|  |  | throw new Exception('While binding enabled: ' . $db->lastErrorMsg()); |
|  |  | } |
|  |  |  |
|  |  | if (!$stmt->bindValue(':name', $\_POST['name'], SQLITE3\_TEXT)) { |
|  |  | if (!$stmt->bindValue(':name', $name, SQLITE3\_TEXT)) { |
|  |  | throw new Exception('While binding name: ' . $db->lastErrorMsg()); |
|  |  | } |
|  |  |  |
|  |  | $desc = $\_POST['desc']; |
|  |  | if (strlen($desc) === 0) { |
|  |  | // Store NULL in database for empty descriptions |
|  |  | $desc = null; |
| Expand Down  Expand Up | | @@ -263,7 +266,7 @@ function JSON\_error($message = null) |
|  |  | throw new Exception('While binding ip: ' . $db->lastErrorMsg()); |
|  |  | } |
|  |  |  |
|  |  | $comment = $\_POST['comment']; |
|  |  | $comment = html\_entity\_decode($\_POST['comment']); |
|  |  | if (strlen($comment) === 0) { |
|  |  | // Store NULL in database for empty comments |
|  |  | $comment = null; |
| Expand Down  Expand Up | | @@ -293,7 +296,7 @@ function JSON\_error($message = null) |
|  |  | throw new Exception('While preparing statement: ' . $db->lastErrorMsg()); |
|  |  | } |
|  |  |  |
|  |  | $comment = $\_POST['comment']; |
|  |  | $comment = html\_entity\_decode($\_POST['comment']); |
|  |  | if (strlen($comment) === 0) { |
|  |  | // Store NULL in database for empty comments |
|  |  | $comment = null; |
| Expand Down  Expand Up | | @@ -453,7 +456,7 @@ function JSON\_error($message = null) |
|  |  | } elseif ($\_POST['action'] == 'add\_domain') { |
|  |  | // Add new domain |
|  |  | try { |
|  |  | $domains = explode(' ', trim($\_POST['domain'])); |
|  |  | $domains = explode(' ', html\_entity\_decode(trim($\_POST['domain']))); |
|  |  | $before = intval($db->querySingle("SELECT COUNT(\*) FROM domainlist;")); |
|  |  | $total = count($domains); |
|  |  | $added = 0; |
| Expand All | | @@ -474,7 +477,7 @@ function JSON\_error($message = null) |
|  |  | throw new Exception('While binding type: ' . $db->lastErrorMsg()); |
|  |  | } |
|  |  |  |
|  |  | $comment = $\_POST['comment']; |
|  |  | $comment = html\_entity\_decode($\_POST['comment']); |
|  |  | if (strlen($comment) === 0) { |
|  |  | // Store NULL in database for empty comments |
|  |  | $comment = null; |
| Expand Down  Expand Up | | @@ -573,7 +576,7 @@ function JSON\_error($message = null) |
|  |  | throw new Exception('While binding enabled: ' . $db->lastErrorMsg()); |
|  |  | } |
|  |  |  |
|  |  | $comment = $\_POST['comment']; |
|  |  | $comment = html\_entity\_decode($\_POST['comment']); |
|  |  | if (strlen($comment) === 0) { |
|  |  | // Store NULL in database for empty comments |
|  |  | $comment = null; |
| Expand Down  Expand Up | | @@ -742,7 +745,7 @@ function JSON\_error($message = null) |
|  |  | } elseif ($\_POST['action'] == 'add\_adlist') { |
|  |  | // Add new adlist |
|  |  | try { |
|  |  | $addresses = explode(' ', trim($\_POST['address'])); |
|  |  | $addresses = explode(' ', html\_entity\_decode(trim($\_POST['address']))); |
|  |  | $total = count($addresses); |
|  |  | $added = 0; |
|  |  |  |
| Expand All | | @@ -751,7 +754,7 @@ function JSON\_error($message = null) |
|  |  | throw new Exception('While preparing statement: ' . $db->lastErrorMsg()); |
|  |  | } |
|  |  |  |
|  |  | $comment = $\_POST['comment']; |
|  |  | $comment = html\_entity\_decode($\_POST['comment']); |
|  |  | if (strlen($comment) === 0) { |
|  |  | // Store NULL in database for empty comments |
|  |  | $comment = null; |
| Expand Down  Expand Up | | @@ -800,7 +803,7 @@ function JSON\_error($message = null) |
|  |  | throw new Exception('While binding enabled: ' . $db->lastErrorMsg()); |
|  |  | } |
|  |  |  |
|  |  | $comment = $\_POST['comment']; |
|  |  | $comment = html\_entity\_decode($\_POST['comment']); |
|  |  | if (strlen($comment) === 0) { |
|  |  | // Store NULL in database for empty comments |
|  |  | $comment = null; |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[scripts/pi-hole/php/teleporter.php](#diff-47e05d1d5ece47ad81a8c18e3bd533f93d456f6497f1a86bcaf2a94cd74b067e "scripts/pi-hole/php/teleporter.php")

Show comments

[View file](/pi-hole/web/blob/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69/scripts/pi-hole/php/teleporter.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -173,7 +173,7 @@ function archive\_restore\_table($file, $table, $flush=false) |
|  |  | foreach($contents as $row) |
|  |  | { |
|  |  | // Limit max length for a domain entry to 253 chars |
|  |  | if(strlen($row[$field]) > 253) |
|  |  | if(isset($field) && strlen($row[$field]) > 253) |
|  |  | continue; |
|  |  |  |
|  |  | // Bind properties from JSON data |
| Expand All | | @@ -196,7 +196,7 @@ function archive\_restore\_table($file, $table, $flush=false) |
|  |  | default: |
|  |  | $sqltype = "UNK"; |
|  |  | } |
|  |  | $stmt->bindValue(":".$key, $value, $sqltype); |
|  |  | $stmt->bindValue(":".$key, htmlentities($value), $sqltype); |
|  |  | } |
|  |  |  |
|  |  | if($stmt->execute() && $stmt->reset() && $stmt->clear()) |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[settings.php](#diff-4092c491c25e7e19aceafbe3c49d234ce7d1eca769519197d2ccba7bde75a27e "settings.php")

Show comments

[View file](/pi-hole/web/blob/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69/settings.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -714,7 +714,7 @@ function convertseconds($argument) |
|  |  | title="Lease type: IPv<?php echo $lease["type"]; ?><br/>Remaining lease time: <?php echo $lease["TIME"]; ?><br/>DHCP UID: <?php echo $lease["clid"]; ?>"> |
|  |  | <td id="MAC"><?php echo $lease["hwaddr"]; ?></td> |
|  |  | <td id="IP" data-order="<?php echo bin2hex(inet\_pton($lease["IP"])); ?>"><?php echo $lease["IP"]; ?></td> |
|  |  | <td id="HOST"><?php echo $lease["host"]; ?></td> |
|  |  | <td id="HOST"><?php echo htmlentities($lease["host"]); ?></td> |
|  |  | <td> |
|  |  | <button type="button" id="button" class="btn btn-warning btn-xs" data-static="alert"> |
|  |  | <span class="fas fas fa-file-import"></span> |
| Expand Down  Expand Up | | @@ -742,7 +742,7 @@ function convertseconds($argument) |
|  |  | <tr> |
|  |  | <td><?php echo $lease["hwaddr"]; ?></td> |
|  |  | <td data-order="<?php echo bin2hex(inet\_pton($lease["IP"])); ?>"><?php echo $lease["IP"]; ?></td> |
|  |  | <td><?php echo $lease["host"]; ?></td> |
|  |  | <td><?php echo htmlentities($lease["host"]); ?></td> |
|  |  | <td><?php if (strlen($lease["hwaddr"]) > 0) { ?> |
|  |  | <button type="submit" class="btn btn-danger btn-xs" name="removestatic" |
|  |  | value="<?php echo $lease["hwaddr"]; ?>"> |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c949516`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Fcommit%2Fc949516ee15fa6a9b0c8511cc4c4d6b0893f3e69) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.telspace.co.za_b7c100c5_20250119_140254.html ===


# [Telspace Africa, The Blog](https://blog.telspace.co.za/)

Hackers for hire

Showing posts with label **0day**. [Show all posts](https://blog.telspace.co.za/)

Showing posts with label **0day**. [Show all posts](https://blog.telspace.co.za/)

## Thursday, December 10, 2020

### [Looking back on 2019 and 2020…](https://blog.telspace.co.za/2020/12/looking-back-on-2019-and-2020.html)

Every year we look back on the previous year and reflect on what happened, our achievements, lessons learnt etc. However, last year this fell through i.e. we did not look back on 2019 which is just as well given what happened / is happening in 2020 or maybe this is some version of the butterfly effect  Ƹ̵̡Ӝ̵̨̄Ʒ (∩╹□╹∩)

Okay okay we are being a bit dramatic here but it is 2020 and anything is possible, besides our newly acquired l33t ASCII art one liners ᕕ(⌐■\_■)ᕗ, here are some of the highlights over the last 2 years.
## Internships / Bootcamps

We ran two successful internships / bootcamps, this is an important part of our strategy to contribute towards developing / nurturing local information skills in South Africa.  For additional information on the two bootcamps that we ran in the past two years, refer to:

* <https://blog.telspace.co.za/2019/03/telspace-systems-internshipboot-camp.html>
* <https://blog.telspace.co.za/2020/01/boot-camp-2020.html>

From the bootcamps we ran, we ended up hiring 5 new staff members that joined our team and are now on their way to achieving great things both at Telspace and in the community (watch this space).

Those that did not make it with us, in most of the cases, ended up finding jobs at other info sec companies and / or corporates which is the exact reason we started the bootcamp, to filter more people in to the industry as a whole, not just specifically at Telspace. We also assisted those that could not find anywhere to be placed, by sending their CVs to some of our customers and / or other competitors. Below are some pictures of the bootcamp:

|  |
| --- |
| 2020 Bootcamp |

### | | | --- | | 2019 Bootcamp |

## Talks and Research

Over the last two years we have given a number of talks and facilitated training both locally and internationally, below are some of the highlights:
## Training - Hack to Basics - x86 Windows Based Buffer Overflows, an introduction to buffer overflows

We gave this training at both DEF CON 1.0 China and DEF CON 27 - Vegas in 2019, it was presented by Dino and Manny, it was really great to meet up with all our friends at DEF CON and make new friends, hopefully in 2021 we will all be able to meet up again!

|  |
| --- |
| Undercover hackers on their way to DEFCON China (no black hoody = no hacking going on here) |

|  |
| --- |
| Epic artwork, epic venue! #HackerVibes |

|  |
| --- |
| The actual venue where we were presenting but we totally missed the entrance and went on an adventure, thank goodness for Grifter! |

|  |
| --- |
| Our names in lights O\_O |

|  |
| --- |
| A full house for all our classes with great interactions and learning! |

|  |
| --- |
| Party time, and man was it a party x\_X |

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEicrxRVbMYwmAfs19xrNZDeTn4dOLGEKqxMKc8GDytBFSbYw65GNr81nwuVSjexLbY223TD07YlIO8_U_ROtP83t475cYIhNLgI7Whxdn1Zwv27ZD-VuUdgBZ-OO7fPnS6Gp7S3GEHWRRHM/w640-h480/image.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEicrxRVbMYwmAfs19xrNZDeTn4dOLGEKqxMKc8GDytBFSbYw65GNr81nwuVSjexLbY223TD07YlIO8_U_ROtP83t475cYIhNLgI7Whxdn1Zwv27ZD-VuUdgBZ-OO7fPnS6Gp7S3GEHWRRHM/)

|  |
| --- |
| Thanks to all the trainers, organisers, volunteers and everyone that made DEFCON China 1.0 possible <3 |

## Training – Ethical Hacking 101

Right after China we were off to sunny Tel Aviv in Israel for BSides Tel Aviv where we were sponsors and also, gave our ethical hacking 101 training course.  The local Israel hacking community are really awesome and a 100% of the proceeds of our training course were given back to be used by the local BSides TLV community.

|  |
| --- |
| Some cool art work on Aviv Beach |

|  |
| --- |
| Raul (left) and Manny (right), ready to present to the community |

|  |
| --- |
| Packed house for the kick off of BSides TLV 2019 |

|  |
| --- |
| Aaaaaaaaaaaaaaaaaaaand guess where we are now, VEGAAAAAAS! |

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjKTy70qRv8MzTIUeuBoiEMeYsa2z5EpQyg1x-L3lOOJfMfbw4QRBl0R15ekR4j6wrABNYskElEMZFp4kfh5xsNu8rDtoC9wSihqKZetMsvny8yiwImCXMeLIewnljkgwUoHdVw15CoUG1z/w225-h400/image.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjKTy70qRv8MzTIUeuBoiEMeYsa2z5EpQyg1x-L3lOOJfMfbw4QRBl0R15ekR4j6wrABNYskElEMZFp4kfh5xsNu8rDtoC9wSihqKZetMsvny8yiwImCXMeLIewnljkgwUoHdVw15CoUG1z/)

Here we gave our Hack to Basics training for our DEF CON workshop, got to catch up with old friends, make new friends, nothing else like DEF CON Vegas!
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhL8d1JWQO3AXvGtnsn2GeAEMi2pbRaYqtsT407X2UqKwmSwpvCF_TmmTuNXefED7PrUgwVrdF7m_D6fbGTh_3bzQuFTG69PX1Qhx24_7N8jAMgcAFGX-vVkTieXmuKMCQ3QSAudfrQUIo1/w640-h322/image.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhL8d1JWQO3AXvGtnsn2GeAEMi2pbRaYqtsT407X2UqKwmSwpvCF_TmmTuNXefED7PrUgwVrdF7m_D6fbGTh_3bzQuFTG69PX1Qhx24_7N8jAMgcAFGX-vVkTieXmuKMCQ3QSAudfrQUIo1/)

|  |
| --- |
| Students from one of our classes (the ones that wanted to be in the picture that is!). |

|  |
| --- |
| #TheBadgeLife – we got to have them all (or at least some!). |

## Back to the Motherland

Telspace has always been very close to the local (South African) infosec community and we believe in giving back. In line with this, we started / established the DC2711 group in South Africa and had our first conference last year on the 5th of October 2019. The conference was completely FREE to attend (for the community) and allowed various international and local researchers to share their research, for a full list of who spoke, refer to <https://www.dc2711.co.za/dc2711_Presentations.html>. Attendees also got swag packs full of DC2711 goodies.

|  |
| --- |
| Jayson Street handing Dino the official DEF CON flag for the DC2711 Group |

|  |
| --- |
| The official DC2711 sticker but more importantly, a coffeeeeee voucher :D |

|  |
| --- |
| DC2711 Badges |

|  |
| --- |
| Some official swag :D |

|  |
| --- |
| Dino and Manny with their fun faces on :P |

|  |
| --- |
| #DuckArmyInvasion |

|  |
| --- |
| The core GOON team for DC2711 – thank you again! |

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiV-VgTdCJYfw76BL38-Utp2btSP67CkLoOIRbrag_WlZqtqD2Oes38uFfPB1-usXtHWEn37_QDzsUNbNXWRRwG6FglFjkUJ4-KT2DfOfKXJW3SBU6y-ApWP7-61fY3tq1i-n_6aVkuoh-2/w400-h148/image.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiV-VgTdCJYfw76BL38-Utp2btSP67CkLoOIRbrag_WlZqtqD2Oes38uFfPB1-usXtHWEn37_QDzsUNbNXWRRwG6FglFjkUJ4-KT2DfOfKXJW3SBU6y-ApWP7-61fY3tq1i-n_6aVkuoh-2/)
We were also Gold Sponsors of BSides Cape Town 2019 and Amy’s talk was also accepted (this talk was first completed at DC2711)!

|  |
| --- |
| On our way to BSides Cape Town!!!!! |

|  |
| --- |
| Amy Manià giving her talk “Put words in my mouth” although we all know it as the “deep throat” talk. |

Amy’s talk is accessible online at <https://www.youtube.com/watch?v=4R-g90lplco>.
## Research / Dropping them 0days

In 2019 and 2020 we discovered and reported on a number of vulnerabilities, some of the main ones being:

* QNAP - CVE-2019-7181 (<https://www.qnap.com/en/security-advisory/nas-201905-09>)
* phpList – CVE-2020-15072 & CVE-2020-15073 (<https://blog.telspace.co.za/2020/07/phplist-cve-2020-15072-cve-2020-15073.html>)
* Pi-hole Code Injection – CVE-2020-14971 (<https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html>)

We also released a tool called Travesty, which is a directory and file enumeration tool (post exploitation). This can be downloaded at <https://github.com/telspacesystems/travesty> .

For additional information on these and others we released / published this year refer to <https://blog.telspace.co.za/>

During DEF CON Safe Mode (DC28) Greg, Amy and Derek presented at the “War Story Bunker” event (Friday 7th August 2020), which was a pentesting story that caused a lot of big laughs and surprised faces – unfortunately these are not recorded for various reasons, but more information about DC28 can be found at <https://www.defcon.org/html/defcon-safemode/dc-safemode-schedule.html> .

Amy Mania also represented Telspace during a Woven Experiences podcast with Melissa Monnig, the interview can be listened to on Spotify at:

* <https://open.spotify.com/episode/4Co0Vo6xW3sziq77aWBa0Z?si=w_13wOjZRLyU1XvMGQHJNw> .

Throughout the year we also participated in other local and international conferences, round table events and provided comments on news stories in the media.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiMXcYJtMwjVsHfIZh-TPfLxgF7fxz5k0fC2KEBwU70vb6wL10nELJe0NdngpzonP8wNc-No1iEq9qAenYNbtZ3osNDpHSaJ6laCt67AC12oBry0hWA0-2VIBWXEVMl7-dPbMFYI1JhrvWe/w640-h186/image.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiMXcYJtMwjVsHfIZh-TPfLxgF7fxz5k0fC2KEBwU70vb6wL10nELJe0NdngpzonP8wNc-No1iEq9qAenYNbtZ3osNDpHSaJ6laCt67AC12oBry0hWA0-2VIBWXEVMl7-dPbMFYI1JhrvWe/)
Last but not least, our CEO and Founder (Dino Covotsos) is officially part of the DEF CON Review board (Talks and Workshops). This is a great achievement, in particular, representing South Africa at such an international level.  More information can be found at: https://www.defcon.org/html/defcon-27/dc-27-cfp-review-board.html
In closing, we would like to thank everyone who made our 2019/2020 so amazing, a huge thank you to our staff, clients, employees, friends and most importantly the local and international Information Security community.
We wish you all the best and a prosperous year for 2021.

at

[Thursday, December 10, 2020](https://blog.telspace.co.za/2020/12/looking-back-on-2019-and-2020.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/8918405469180868685)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=8918405469180868685&from=pencil "Edit Post")

Labels:
[0day](https://blog.telspace.co.za/search/label/0day),
[2020](https://blog.telspace.co.za/search/label/2020),
[Amy Mania](https://blog.telspace.co.za/search/label/Amy%20Mania),
[BsidesTLV](https://blog.telspace.co.za/search/label/BsidesTLV),
[Defcon](https://blog.telspace.co.za/search/label/Defcon),
[defcon 27](https://blog.telspace.co.za/search/label/defcon%2027),
[defcon china](https://blog.telspace.co.za/search/label/defcon%20china),
[Dino Covotsos](https://blog.telspace.co.za/search/label/Dino%20Covotsos),
[Manuel Corregedor](https://blog.telspace.co.za/search/label/Manuel%20Corregedor),
[research](https://blog.telspace.co.za/search/label/research),
[the munx](https://blog.telspace.co.za/search/label/the%20munx),
[year end](https://blog.telspace.co.za/search/label/year%20end)

## Tuesday, June 23, 2020

### [Pi-hole Code Injection – CVE-2020-14971– Story Time](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html)

A while ago, we had an internal discussion around people working from home and the technologies/products that could be implemented and/or bought to protect home users. This was due to the implementation of the nationwide lockdown which resulted in companies being forced to change their approach entirely to having employees work from home.

During this discussion the Pi-hole was mentioned. Pi-hole is a very popular option for the more “tech savvy” home user and generally, anyone that’s tired of being spammed with random adverts on every website. You can find more information about it here <https://github.com/pi-hole/pi-hole/>.

Since I had a Pi-hole installed already, I decided to take a look at this beautiful piece of ad blocking software in more detail, specifically reviewing the code and logic of the application. Because it’s Opensource and available freely, this was easily accomplished by downloading and installing the latest Pi-hole (v5.0 at the time).

It’s worth mentioning that a lot of vulnerabilities had already been found in this software, some overlapped with findings that I had found particularly during April and May, which were rightfully allocated to the first people that reported the issues. With that being said, the Pi-hole is a popular target for researchers and adds a lot of value to people’s home and small office environments, so the more findings and fixes the better. I also wanted to focus on the latest version because of this.

Initially, I had found a few critical security vulnerabilities but many had been found and fixed already and others eventually required local shell access in some form, some functionality had been changed over time, which solved those particular RCE issues too. So, I therefore looked at a few other vectors and decided to focus on one specific attack vector, which looked promising.

## **Backup Functions:**

Settings.php has lots of functionality, one of which allows users to back up and restore (export and import) configurations of the Pi-hole with a limited set of files (teleporter tab).

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s640/Screen+Shot+2020-06-18+at+4.31.19+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.31.19%2BPM.png)

This was interesting for me because when you export files, they are compressed in tar.gz format and saved. Upon decompression and by systematically reviewing each file that was saved, I found that there were several files which were useful and easy wins for RCE, in particular if no whitelisting and sanitising was taking place. However, those particular ones are not restored if you modify them, re-compress and upload to restore the backup.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s640/Screen+Shot+2020-06-18+at+4.35.31+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.35.31%2BPM.png)

In this instance though, the affected files I found are dnsmasq.d configuration files and the adlist.json file. The dnsmasq.d/04-pi-hole-static-dhcp.conf file allows static DHCP leases, which link to MAC, IP and host.

I modified the configuration file for dnsmasq.d initially, in which I added my own code for the host parameter. Once I did this, I recompressed the file accordingly and imported the file back in via teleporter:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s640/Screen+Shot+2020-06-18+at+4.38.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.38.14%2BPM.png)

Upon browsing to the static DHCP leases section of the Pi-hole web interface, I could see my code was executing correctly i.e. I had found a Code Injection vulnerability.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s640/Screen+Shot+2020-06-18+at+4.39.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.39.14%2BPM.png)

The same then applied to adlists.json and other parameters in other files, as all the files were not being properly checked upon upload, they also just overwrote whatever was previously there and therefore your code executed accordingly:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s640/Screen+Shot+2020-06-22+at+10.13.18+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s1600/Screen%2BShot%2B2020-06-22%2Bat%2B10.13.18%2BPM.png)

Browse to host/admin/groups-adlists.php and you should get the ‘Adam popup’:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s640/Screen+Shot+2020-06-18+at+4.45.47+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.45.47%2BPM.png)

There are more examples, however it’s more of the same as what has been discussed above. I would also like to mention, that the Pi-hole is an amazing piece of software, built by people who really care for the community, please support them and donate. All the responses (especially from Adam) were really quick and things were patched exceptionally quickly.

You can browse all the fixes, comments and progress of patching by going here:

<https://github.com/pi-hole/AdminLTE/commit/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-640920508>

<https://github.com/pi-hole/AdminLTE/commit/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-643830404>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14971>

at

[Tuesday, June 23, 2020](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/4313565159762696677)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=4313565159762696677&from=pencil "Edit Post")

Labels:
[0day](https://blog.telspace.co.za/search/label/0day),
[2020](https://blog.telspace.co.za/search/label/2020),
[code injection](https://blog.telspace.co.za/search/label/code%20injection),
[CVE-2020-14971](https://blog.telspace.co.za/search/label/CVE-2020-14971),
[pentesting](https://blog.telspace.co.za/search/label/pentesting),
[pihole](https://blog.telspace.co.za/search/label/pihole)

## Friday, August 30, 2019

### [TSA-2019-001: Asus Precision TouchPad 11.0.0.25 (Pool Overflow)](https://blog.telspace.co.za/2019/08/tsa-2019-001-asus-precision-touchpad.html)

**Telspace Systems Security Advisory**

**TSA-2019-001:****Asus Precision TouchPad 11.0.0.25 (Pool Overflow)**
**CVE number: CVE-2019-10709**

**Summary:**

The AsusPTPFilter.sys driver on the Asus Precision TouchPad 11.0.0.25 hardware has a Pool Overflow associated with the [\\.\AsusTP](https://www.blogger.com/null)device, leading to a DoS and could potentially lead to privilege escalation via a crafted DeviceIoControl call with a specific IOCTL code.

**Vendor:**

Asus

**Product:**

Asus Precision TouchPad

**Version:**

11.0.0.25

**Vendor:**
<https://www.asus.com/us/News/SupportNews/>
<https://www.asus.com/>

**Proof of Concept:**

<https://github.com/telspacesystems/Asus-DOS>

**Details and crash information:**

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh83_MqXpWNyxRUAr8Us2xCsnneojmoSFo9wp_GcvxTSv4AchzfHEvlbzSms8dkSfvSbEqvyydIWBwZ67JmsRsYEb3joFRAMoy6qc2P8fwlufyMJkJZdJSvyoxiHtKiIsWI2ZQ5pDWgJpu5/s320/1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh83_MqXpWNyxRUAr8Us2xCsnneojmoSFo9wp_GcvxTSv4AchzfHEvlbzSms8dkSfvSbEqvyydIWBwZ67JmsRsYEb3joFRAMoy6qc2P8fwlufyMJkJZdJSvyoxiHtKiIsWI2ZQ5pDWgJpu5/s1600/1.png)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEil_G6Snhbn5NcBDhcdlLyvjjmO0QMSFE03DQQ_tYWyv2x7ZK0a96tcQ4MxZk7f6w74nq08TowTcmQbq2RN1kdP8GjuPwR-3smk7jMG-9ilKTywDktPOBcgv9kaBPLAGs_Ym1zrLKqpj0cq/s320/2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEil_G6Snhbn5NcBDhcdlLyvjjmO0QMSFE03DQQ_tYWyv2x7ZK0a96tcQ4MxZk7f6w74nq08TowTcmQbq2RN1kdP8GjuPwR-3smk7jMG-9ilKTywDktPOBcgv9kaBPLAGs_Ym1zrLKqpj0cq/s1600/2.png)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgPq9cd4MpGMViXy5t1BM6HQChIxg0hz4bjMrw6I2GA0mHrEyt4Zvhcjj_lV8JmAWU2-3eHOaa0NomZ5ywleSyodvTLGwWltUjPRyyChUrC8meYZyB9PvGzF3uV072RRX04hXlmoSUAlrbS/s320/3.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgPq9cd4MpGMViXy5t1BM6HQChIxg0hz4bjMrw6I2GA0mHrEyt4Zvhcjj_lV8JmAWU2-3eHOaa0NomZ5ywleSyodvTLGwWltUjPRyyChUrC8meYZyB9PvGzF3uV072RRX04hXlmoSUAlrbS/s1600/3.png)

**Vendor response:**

The vendor has patched the vulnerability and released a new version.

**Disclosure Timeline:**

25-03-2019 – Initial Discovery
27-03-2019 – Vendor Notification
29-08-2019 – Vendor Patch
30-08-2019 – Public Disclosure

**Credit:**

This vulnerability was discovered by Athanasios Tserpelis of Telspace Systems

at

[Friday, August 30, 2019](https://blog.telspace.co.za/2019/08/tsa-2019-001-asus-precision-touchpad.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/4055040607379685755)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=4055040607379685755&from=pencil "Edit Post")

Labels:
[0day](https://blog.telspace.co.za/search/label/0day),
[asus](https://blog.telspace.co.za/search/label/asus),
[CVE-2019-10709](https://blog.telspace.co.za/search/label/CVE-2019-10709),
[exploit](https://blog.telspace.co.za/search/label/exploit),
[pool overflow](https://blog.telspace.co.za/search/label/pool%20overflow),
[TSA-2019-001](https://blog.telspace.co.za/search/label/TSA-2019-001),
[vulnerability](https://blog.telspace.co.za/search/label/vulnerability)

## Wednesday, March 7, 2018

### [Telspace Systems Security Advisory (TSA-2018-002)](https://blog.telspace.co.za/2018/03/telspace-systems-security-advisory-tsa.html)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjYiGmr0w1YPeJlzL2hKDqoFq8xpmo-v2hUXmR28OaxmOdYutlz6XDbii7of5Dz43Nt6LNogaCN7-NR0MjI3i2dZVrEUSShE6hj_zh-qDiiDtUkc7ZVzCqCYA_Eo5lAbTnSFpcXKVQN0XKy/s320/Telspace.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjYiGmr0w1YPeJlzL2hKDqoFq8xpmo-v2hUXmR28OaxmOdYutlz6XDbii7of5Dz43Nt6LNogaCN7-NR0MjI3i2dZVrEUSShE6hj_zh-qDiiDtUkc7ZVzCqCYA_Eo5lAbTnSFpcXKVQN0XKy/s1600/Telspace.jpg)
## **Security Advisory**

**TSA-2018-002:** Microsoft Edge Information Disclosure Vulnerability

**CVE Number:**CVE-2018-0839

**Summary**

An information disclosure vulnerability exists when Microsoft Edge improperly handles objects in memory. An attacker who successfully exploited the vulnerability could obtain information to further compromise the user’s system.

**Details and crash information**

edgehtml!Ordinal125+0xe3c86:

5ef196d6 8b5928          mov     ebx,dword ptr [ecx+28h] ds:0023:117cd008=????????

**Vendor:**Microsoft

**Product:**Edge

**Version:**11.0.15063.67

**Vendor URLs:**

* [https://www.microsoft.com](https://www.microsoft.com/)
* <https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-0839>
* <https://www.zerodayinitiative.com/advisories/ZDI-18-167/>

**Vendor Response**

The vendor has patched the vulnerability and released a new version

**Disclosure Timeline**

* 23-11-2017 – Initial Discovery
* 29-11-2017 – ZDI Notification
* 07-12-2017 - Vendor notification
* 21-02-2018 - Coordinated public release of advisory

**Credit**

This vulnerability was discovered by Dmitri Kaslov of Telspace Systems

at

[Wednesday, March 07, 2018](https://blog.telspace.co.za/2018/03/telspace-systems-security-advisory-tsa.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/3813804325640235791)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=3813804325640235791&from=pencil "Edit Post")

Labels:
[0day](https://blog.telspace.co.za/search/label/0day),
[CVE-2018-0839](https://blog.telspace.co.za/search/label/CVE-2018-0839),
[Microsoft](https://blog.telspace.co.za/search/label/Microsoft),
[Microsoft Edge](https://blog.telspace.co.za/search/label/Microsoft%20Edge),
[Microsoft Edge Information Disclosure Vulnerability](https://blog.telspace.co.za/search/label/Microsoft%20Edge%20Information%20Disclosure%20Vulnerability),
[security advisory](https://blog.telspace.co.za/search/label/security%20advisory),
[TSA-2018-002](https://blog.telspace.co.za/search/label/TSA-2018-002)

## Wednesday, February 28, 2018

### [Telspace Systems Security Advisory (TSA-2018-001)](https://blog.telspace.co.za/2018/02/telspace-systems-security-advisory-tsa.html)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhoArf3zp44IvVhTABqzSqd-Hyiy8jE06LErpSB2BKnlc321lc-nu94a2by0uMhjNL87Dk-Vnno2j5suO2CVkdIzaO9RBAN0N52pjgHZ8qdfcxLIisgbv40LFJzAspyu71FJLxpLFoil2Bd/s320/Telspace.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhoArf3zp44IvVhTABqzSqd-Hyiy8jE06LErpSB2BKnlc321lc-nu94a2by0uMhjNL87Dk-Vnno2j5suO2CVkdIzaO9RBAN0N52pjgHZ8qdfcxLIisgbv40LFJzAspyu71FJLxpLFoil2Bd/s1600/Telspace.jpg)
## **Security Advisory**

**TSA-2018-001:** Microsoft Access Information Disclosure Vulnerability

**CVE Number:**CVE-2018-0853

**Summary**

An information disclosure vulnerability exists when Microsoft Office Access software reads out of bound memory due to an uninitialized variable, which could disclose the contents of memory. An attacker who successfully exploited the vulnerability could view out of bound memory.

**Details and crash information**

VCRUNTIME140!memcpy+0x4e:

72edd1ce f3a4            rep movs byte ptr es:[edi],byte ptr [esi]

**Vendor:**Microsoft

**Product:**Access

**Version:**16.0.8625.2127

**Vendor URLs:**

* [https://www.microsoft.com](https://www.microsoft.com/)
* <https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-0853>

**Vendor Response**

The vendor has patched the vulnerability and released a new version.

**Disclosure Timeline**

* 23-11-2017 – Initial Discovery
* 25-11-2017 – Vendor Notification
* 19-01-2018 – Vendor Patch
* 13-02-2018 – Public Disclosure

**Credit**

This vulnerability was discovered by Dmitri Kaslov of Telspace Systems

at

[Wednesday, February 28, 2018](https://blog.telspace.co.za/2018/02/telspace-systems-security-advisory-tsa.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/4049566575740132421)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=4049566575740132421&from=pencil "Edit Post")

Labels:
[0day](https://blog.telspace.co.za/search/label/0day),
[CVE-2018-0853](https://blog.telspace.co.za/search/label/CVE-2018-0853),
[Microsoft](https://blog.telspace.co.za/search/label/Microsoft),
[microsoft access](https://blog.telspace.co.za/search/label/microsoft%20access),
[Microsoft Access Information Disclosure Vulnerability](https://blog.telspace.co.za/search/label/Microsoft%20Access%20Information%20Disclosure%20Vulnerability),
[Out of bounds read](https://blog.telspace.co.za/search/label/Out%20of%20bounds%20read),
[security advisory](https://blog.telspace.co.za/search/label/security%20advisory),
[TSA-2018-001](https://blog.telspace.co.za/search/label/TSA-2018-001)

## Wednesday, January 10, 2018

### [2017 Highlights, a great year and even greater things to come!](https://blog.telspace.co.za/2018/01/2017-highlights-great-year-and-even.html)

As we enter a new year Telspace would like to look back on 2017 and thank everyone who made 2017 one of our greatest yet. We have had the pleasure of attending a number of conferences where we were able to present, train and share ideas with like-minded individuals. 2017 saw a growth in the Telspace Team, in particular in our Research and Development space (more to come!). This blog post provides an overview of some of the highlights this year, if we have missed anything let us know in the comments below! We kicked the year off by joining up with Carte Blanche to provide comment on mobile privacy and the tools used to spy on people.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi1c4mYel7R5XPgj4mQlTlgG1mCZxRaxMycS0_nrCVmj2AYjUkBCdD4uQd5x068WhCTL5PpzAiSVHs7VnG1E-Ge7C7_JRW-QF0sYZPiv98MH-aNSrLfibf2jd6H07M7Xu8sYK4LWm_c3MeC/s1600/1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi1c4mYel7R5XPgj4mQlTlgG1mCZxRaxMycS0_nrCVmj2AYjUkBCdD4uQd5x068WhCTL5PpzAiSVHs7VnG1E-Ge7C7_JRW-QF0sYZPiv98MH-aNSrLfibf2jd6H07M7Xu8sYK4LWm_c3MeC/s1600/1.png)
Left to right: Stieler (Standard Bank), Bongani Bingwa (Carte Blanche), Simphiwe (PIC), Dino Covotsos (Telspace Systems)

 Telspace has always been very close to the local infosec community and we believe in giving back. As part of this, Telspace got heavily involved in ITWeb’s first Hackathon where we provided our time to train, mentor and judge the participants. The inaugural Hackathon brought young professionals with an interest in developing their skills in Information Security together. The overall theme, “Innovation in Security”, challenged disruptive innovators to build the most secure systems possible, as well as to explore new innovative mechanisms for the industry.

The Hackaton was a great event / initiative as it made the participants aware of the importance of information security. Telspace also took on board one of the participants from the Hackathon that demonstrated the most passion, as we always like to say, we can teach you skills but we can’t teach you passion!
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3-XVBv6n1LD24nPqpL3GDpK4BcKta8Jkb9p4y8Zb6vL1PZNtGS3XRQ6Y8eqcCyAe5gxm00irAWEjZ_34Nx5RQt0HA02j1hlcVhf5LPQLElWgcbBZjTBpRWBBLa39ox3m87bYaKVGYFyVs/s400/2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3-XVBv6n1LD24nPqpL3GDpK4BcKta8Jkb9p4y8Zb6vL1PZNtGS3XRQ6Y8eqcCyAe5gxm00irAWEjZ_34Nx5RQt0HA02j1hlcVhf5LPQLElWgcbBZjTBpRWBBLa39ox3m87bYaKVGYFyVs/s1600/2.png)
Left to right: Manny Corregedor (COO of Telspace Systems), Nithen Naidoo (CEO of Snode) at the Hackathon Ideathon

For more information on the Hackathon go to:

* <https://www.itweb.co.za/content/lP3gQ2qGr8LMnRD1>
* <http://v2.itweb.co.za/event/itweb/security-summit-2017/?page=hackathon>
* <https://www.itweb.co.za/content/p6GxRKqYe6qb3Wjr>

In addition to supporting the ITWeb Hackathon we also sponsored, provided training (ethical and wireless hacking) and spoke at the ITWeb Security Summit. We also got the opportunity to catchup with some old friends such as Jayson Street, an international speaker, that gave a keynote at the conference. We also made a donation to CANSA for every Telspace shirt that was given away to attendees that visited our stand.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj1mo2BZO_zAZCGg4uK3POHXtVWt4Rhz6GenwSBGFhMbZIYsJG5ngHovHqNGeUr8r4xnVqUmbQab7yq4VpOg3WrSqEXQTAbiYCJu_8d2_crwO7Hz2z-o3xZL6FLAewd1RuvpHIIsmwlhF_0/s640/3.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj1mo2BZO_zAZCGg4uK3POHXtVWt4Rhz6GenwSBGFhMbZIYsJG5ngHovHqNGeUr8r4xnVqUmbQab7yq4VpOg3WrSqEXQTAbiYCJu_8d2_crwO7Hz2z-o3xZL6FLAewd1RuvpHIIsmwlhF_0/s1600/3.png)
Left to right: Eric Lundberg, Manny Corregedor and Jayson Street

![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkDP8Yy_M9bLdyvsAKcW7rf9vwKT6UTp3I6P-TQ6jX7WQXb4zRYpnenunpvz2JMJ6KhrOdkLVptOcBnxR9_cif-GAe3mcsPIr9_vLQUZtTNYy1dVj6TIi3d7XqDKsZVAFCtgp2YQ5Y6n1D/s640/4.png)
Manny Corregedor giving a talk on ‘A false sense of information security’ at the ITWeb Security Summit.

The conference was well attended and had great international speakers such Jayson Street and Mati Aharoni who gave keynotes.

Telspace also attended the first local Johannesburg 0xCon conference where our COO Manny Corregedor presented his talk “Breaking AVs for fun and the greater good”. A great day was had by everyone and it was great seeing the community come together for this local conference.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjeNHwFnreeGgt-Ek6lNEd8RkcnvREhBOX2AB-frwpzbijFGb9n1-LBudfqpnIvhhSQFFgXg6kCeD4RDfaNQtwpuzDuRUq8mu0bvS3Y-3got5yLl-hl7qGyBfZFLr4xM-GQhnRBGqvzP3Kz/s640/5.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjeNHwFnreeGgt-Ek6lNEd8RkcnvREhBOX2AB-frwpzbijFGb9n1-LBudfqpnIvhhSQFFgXg6kCeD4RDfaNQtwpuzDuRUq8mu0bvS3Y-3got5yLl-hl7qGyBfZFLr4xM-GQhnRBGqvzP3Kz/s1600/5.png)
Left to right (front): Manny, Mariska (No longer with Telspace), Sibusiso, Mark, Richard. Back: Eric.

Throughout the year we also participated in other local and international conferences, round table events and provided comments on news stories in the media.

In addition to supporting local events, we also attended Blackhat, Defcon 25 and Bsides in Las Vegas. Our analyst Richard Hocking gave a presentation on Hacking Stock Markets at BSides Las Vegas titled ‘(In)Outsider Trading - Hacking stocks using public information and influence.’
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjaobigqr8pKczjv4e55X5QIZ3pmiDFR49IWMQ60LeHbUfYMPZSVKsxKmPfCiIiABPsfr0AepqXjxZKT3l9M3Cng3_pWbmU2WgjpZcrBu6zK5-JsGTgpr9D70w1XrD09bLv1zp32YpxE2Qu/s640/6.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjaobigqr8pKczjv4e55X5QIZ3pmiDFR49IWMQ60LeHbUfYMPZSVKsxKmPfCiIiABPsfr0AepqXjxZKT3l9M3Cng3_pWbmU2WgjpZcrBu6zK5-JsGTgpr9D70w1XrD09bLv1zp32YpxE2Qu/s1600/6.png)
In Vegas many bonds were made and many beers were enjoyed. We look forward to attending again in 2018. We also donated to the fantastic Hackers for Charity, which is an amazing initiative which we fully support (Thanks Johnny!). More information on this great initiative can be found by going to: <http://www.hackersforcharity.org/> .
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgVwiTcdFkJVwcsyfATvBdDq84zB4G_u1Mqab-RkHV8nz4SbZpn47CKX1PV_RZ596rDekLCKQ4oHleEOeuLOsl8wqV0mYrOAp21ExMfWjoVLbUiwSY2iYNHQQiQ9gn3rm6eArvtMfh8S971/s640/7.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgVwiTcdFkJVwcsyfATvBdDq84zB4G_u1Mqab-RkHV8nz4SbZpn47CKX1PV_RZ596rDekLCKQ4oHleEOeuLOsl8wqV0mYrOAp21ExMfWjoVLbUiwSY2iYNHQQiQ9gn3rm6eArvtMfh8S971/s1600/7.png)
Telspace also sponsored and presented at Bsides Cape Town 2017, where we were proud to run a “selfies for charity” fundraiser for the South African Depression and Anxiety Group (@TheSADAG). Our analyst Frank Allenby also presented his talk titled ‘Breach huffing; a culinary exploration of data breaches’.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEivqKhSw1ljMO_-O5kbBhK2OUj5i9-uGlrN77of3u4T-YxnvXVCt_h96M1L0SyCGC74P2SnY8IQqnkoFyEUD2fCGVl5BEb0R9naxJ78U1c7ctU_YR2SazTyeSdLQcEq4niTa84sFC8Jjxrr/s640/8.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEivqKhSw1ljMO_-O5kbBhK2OUj5i9-uGlrN77of3u4T-YxnvXVCt_h96M1L0SyCGC74P2SnY8IQqnkoFyEUD2fCGVl5BEb0R9naxJ78U1c7ctU_YR2SazTyeSdLQcEq4niTa84sFC8Jjxrr/s1600/8.png)
Frank Allenby speaking at Bsides Cape Town

Our analyst Charlie Smith, also won the capture the flag competition at BSides Cape Town, the prize was a Google Home device, sponsored by NClose Security.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWyOWYO_amAsQEsagSFTLtbgeYJII7MCHMY11tOmarv3ypknB6_lbc91ik4QI1u1t-0nbouZidwWgzyDNG3Vqo4b9BxMmUXyONQl3MxkdomTKSuJgbz_d0A95PsjCKoPuH958qqEHiHUiO/s640/9.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWyOWYO_amAsQEsagSFTLtbgeYJII7MCHMY11tOmarv3ypknB6_lbc91ik4QI1u1t-0nbouZidwWgzyDNG3Vqo4b9BxMmUXyONQl3MxkdomTKSuJgbz_d0A95PsjCKoPuH958qqEHiHUiO/s1600/9.png)
Charlie Smith receiving his prize for winning the CTF at BSides Cape Town

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEisPQB7oIQgKevutC1h5opLVS_GON3BT3FiNTQjVlHX6oiECf-lzRiGaaJcVBx3vjmDPTLe0XvQQzNilPaIVNwlK0yxgBzw76LkE7GULVzPsmE1Pj3BZ6qDxp4QNt19xv-XBk6JhNq7JDH9/s640/10.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEisPQB7oIQgKevutC1h5opLVS_GON3BT3FiNTQjVlHX6oiECf-lzRiGaaJcVBx3vjmDPTLe0XvQQzNilPaIVNwlK0yxgBzw76LkE7GULVzPsmE1Pj3BZ6qDxp4QNt19xv-XBk6JhNq7JDH9/s1600/10.png)
Some “selfies for charity” at BSides Cape Town 2017

For a complete write up on our experience at BSides Cape Town visit:

<http://blog.telspace.co.za/2017/12/flux-capacitors-charged-and-back-to.html>

This year we officially kicked off our security advisory service, Telspace Security Advisories (TSA), where we responsibly disclosed a number of unknown vulnerabilities (0day) to vendors. In 2018 we plan to continue our research in not only finding unknown vulnerabilities but also releasing research that would be valuable to our clients and more importantly the community as a whole - stay tuned :) Lastly, we would like to thank everyone who made our 2017 year so amazing, a huge thank you to our staff, clients, friends and most importantly the local Information Security community. We wish you all the best and a prosperous year for 2018.

at

[Wednesday, January 10, 2018](https://blog.telspace.co.za/2018/01/2017-highlights-great-year-and-even.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/6747934907305813678)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=6747934907305813678&from=pencil "Edit Post")

Labels:
[0day](https://blog.telspace.co.za/search/label/0day),
[0xcon](https://blog.telspace.co.za/search/label/0xcon),
[2017](https://blog.telspace.co.za/search/label/2017),
[2018](https://blog.telspace.co.za/search/label/2018),
[Bsides 2017](https://blog.telspace.co.za/search/label/Bsides%202017),
[CANSA](https://blog.telspace.co.za/search/label/CANSA),
[carte blanche](https://blog.telspace.co.za/search/label/carte%20blanche),
[charity](https://blog.telspace.co.za/search/label/charity),
[hackathon](https://blog.telspace.co.za/search/label/hackathon),
[ITWeb security summit](https://blog.telspace.co.za/search/label/ITWeb%20security%20summit),
[SADAG](https://blog.telspace.co.za/search/label/SADAG),
[security advisory](https://blog.telspace.co.za/search/label/security%20advisory)

[Older Posts](https://blog.telspace.co.za/search/label/0day?updated-max=2018-01-10T14:10:00%2B02:00&max-results=20&start=6&by-date=false "Older Posts")

[Home](https://blog.telspace.co.za/)

Subscribe to:
[Posts (Atom)](https://blog.telspace.co.za/feeds/posts/default)

[![](https://www.telspace.africa/img/tel27.jpg)](https://www.telspace.africa)

www.telspace.africa

| Blog Archive  * ▼   [2023](https://blog.telspace.co.za/2023/)   (2)   + ▼     [October](https://blog.telspace.co.za/2023/10/)     (1)     - [Transformative Journey: My Experience at the Telsp...](https://blog.telspace.co.za/2023/10/transformative-journey-my-experience-at.html)   + ►     [August](https://blog.telspace.co.za/2023/08/)     (1)  * ►   [2022](https://blog.telspace.co.za/2022/)   (2)   + ►     [July](https://blog.telspace.co.za/2022/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2022/05/)     (1)  * ►   [2021](https://blog.telspace.co.za/2021/)   (2)   + ►     [July](https://blog.telspace.co.za/2021/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2021/04/)     (1)  * ►   [2020](https://blog.telspace.co.za/2020/)   (8)   + ►     [December](https://blog.telspace.co.za/2020/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2020/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2020/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2020/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2020/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2020/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2020/01/)     (1)  * ►   [2019](https://blog.telspace.co.za/2019/)   (8)   + ►     [November](https://blog.telspace.co.za/2019/11/)     (1)   + ►     [September](https://blog.telspace.co.za/2019/09/)     (1)   + ►     [August](https://blog.telspace.co.za/2019/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2019/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2019/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2019/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2019/01/)     (1)  * ►   [2018](https://blog.telspace.co.za/2018/)   (3)   + ►     [March](https://blog.telspace.co.za/2018/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2018/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2018/01/)     (1)  * ►   [2017](https://blog.telspace.co.za/2017/)   (7)   + ►     [December](https://blog.telspace.co.za/2017/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2017/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2017/09/)     (4)   + ►     [February](https://blog.telspace.co.za/2017/02/)     (1)  * ►   [2016](https://blog.telspace.co.za/2016/)   (5)   + ►     [December](https://blog.telspace.co.za/2016/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2016/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2016/05/)     (3)  * ►   [2015](https://blog.telspace.co.za/2015/)   (7)   + ►     [December](https://blog.telspace.co.za/2015/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2015/10/)     (2)   + ►     [March](https://blog.telspace.co.za/2015/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2015/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2015/01/)     (1)  * ►   [2014](https://blog.telspace.co.za/2014/)   (14)   + ►     [October](https://blog.telspace.co.za/2014/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2014/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2014/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2014/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2014/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2014/04/)     (2)   + ►     [February](https://blog.telspace.co.za/2014/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2014/01/)     (2)  * ►   [2013](https://blog.telspace.co.za/2013/)   (15)   + ►     [December](https://blog.telspace.co.za/2013/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2013/11/)     (1)   + ►     [October](https://blog.telspace.co.za/2013/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2013/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2013/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2013/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2013/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2013/05/)     (4)   + ►     [April](https://blog.telspace.co.za/2013/04/)     (1)   + ►     [March](https://blog.telspace.co.za/2013/03/)     (1)  * ►   [2012](https://blog.telspace.co.za/2012/)   (5)   + ►     [October](https://blog.telspace.co.za/2012/10/)     (1)   + ►     [July](https://blog.telspace.co.za/2012/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2012/04/)     (1)   + ►     [January](https://blog.telspace.co.za/2012/01/)     (2)  * ►   [2011](https://blog.telspace.co.za/2011/)   (11)   + ►     [November](https://blog.telspace.co.za/2011/11/)     (2)   + ►     [August](https://blog.telspace.co.za/2011/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2011/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2011/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2011/04/)     (2)   + ►     [March](https://blog.telspace.co.za/2011/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2011/01/)     (2)  * ►   [2010](https://blog.telspace.co.za/2010/)   (15)   + ►     [December](https://blog.telspace.co.za/2010/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2010/11/)     (2)   + ►     [September](https://blog.telspace.co.za/2010/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2010/08/)     (1)   + ►     [July](https://blog.telspace.co.za/2010/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2010/05/)     (3)   + ►     [March](https://blog.telspace.co.za/2010/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2010/02/)     (3)  * ►   [2009](https://blog.telspace.co.za/2009/)   (10)   + ►     [September](https://blog.telspace.co.za/2009/09/)     (2)   + ►     [July](https://blog.telspace.co.za/2009/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2009/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2009/05/)     (1)   + ►     [February](https://blog.telspace.co.za/2009/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2009/01/)     (3)  * ►   [2008](https://blog.telspace.co.za/2008/)   (26)   + ►     [December](https://blog.telspace.co.za/2008/12/)     (4)   + ►     [November](https://blog.telspace.co.za/2008/11/)     (2)   + ►     [October](https://blog.telspace.co.za/2008/10/)     (4)   + ►     [September](https://blog.telspace.co.za/2008/09/)     (6)   + ►     [August](https://blog.telspace.co.za/2008/08/)     (3)   + ►     [July](https://blog.telspace.co.za/2008/07/)     (2)   + ►     [June](https://blog.telspace.co.za/2008/06/)     (3)   + ►     [May](https://blog.telspace.co.za/2008/05/)     (2) | Subscribe now!   Posts   [Atom](https://blog.telspace.co.za/feeds/posts/default)     Posts       All Comments   [Atom](https://blog.telspace.co.za/feeds/comments/default)     All Comments |
| --- | --- |

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).



=== Content from github.com_d2171c53_20250119_122410.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Fcommit%2F8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Fcommit%2F8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=pi-hole%2Fweb)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pi-hole](/pi-hole)
/
**[web](/pi-hole/web)**
Public

* [Notifications](/login?return_to=%2Fpi-hole%2Fweb) You must be signed in to change notification settings
* [Fork
  566](/login?return_to=%2Fpi-hole%2Fweb)
* [Star
   2.1k](/login?return_to=%2Fpi-hole%2Fweb)

* [Code](/pi-hole/web)
* [Issues
  19](/pi-hole/web/issues)
* [Pull requests
  8](/pi-hole/web/pulls)
* [Actions](/pi-hole/web/actions)
* [Projects
  1](/pi-hole/web/projects)
* [Security](/pi-hole/web/security)
* [Insights](/pi-hole/web/pulse)

Additional navigation options

* [Code](/pi-hole/web)
* [Issues](/pi-hole/web/issues)
* [Pull requests](/pi-hole/web/pulls)
* [Actions](/pi-hole/web/actions)
* [Projects](/pi-hole/web/projects)
* [Security](/pi-hole/web/security)
* [Insights](/pi-hole/web/pulse)

## Commit

[Permalink](/pi-hole/web/commit/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

missed one (yes yes this can all be squashed)

[Browse files](/pi-hole/web/tree/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5)
Browse the repository at this point in the history

```
Signed-off-by: Adam Warner <me@adamwarner.co.uk>
```

* Loading branch information

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&v=4)](/PromoFaux)

[PromoFaux](/pi-hole/web/commits?author=PromoFaux "View all commits by PromoFaux")
committed
Jun 13, 2020

1 parent
[ae7d3d6](/pi-hole/web/commit/ae7d3d66e89fa3427bdadf4bce678ce25f531f5a)

commit 8f6e136

Showing
**1 changed file**
with
**1 addition**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[scripts/pi-hole/js/groups-clients.js](#diff-92db2fbf3547db9b4fec881c5a23696b7b8564b5e653a85064caf1708672e02b "scripts/pi-hole/js/groups-clients.js")

Show comments

[View file](/pi-hole/web/blob/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5/scripts/pi-hole/js/groups-clients.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -303,7 +303,7 @@ function editClient() { |
|  |  | var tr = $(this).closest("tr"); |
|  |  | var id = tr.attr("data-id"); |
|  |  | var groups = tr.find("#multiselect\_" + id).val(); |
|  |  | var ip = tr.find("#ip\_" + id).text(); |
|  |  | var ip = utils.escapeHtml(tr.find("#ip\_" + id).text()); |
|  |  | var name = utils.escapeHtml(tr.find("#name\_" + id).text()); |
|  |  | var comment = utils.escapeHtml(tr.find("#comment\_" + id).val()); |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8f6e136`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Fcommit%2F8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.telspace.co.za_a2392fd2_20250119_140255.html ===


# [Telspace Africa, The Blog](https://blog.telspace.co.za/)

Hackers for hire

Showing posts with label **2020**. [Show all posts](https://blog.telspace.co.za/)

Showing posts with label **2020**. [Show all posts](https://blog.telspace.co.za/)

## Thursday, December 10, 2020

### [Looking back on 2019 and 2020…](https://blog.telspace.co.za/2020/12/looking-back-on-2019-and-2020.html)

Every year we look back on the previous year and reflect on what happened, our achievements, lessons learnt etc. However, last year this fell through i.e. we did not look back on 2019 which is just as well given what happened / is happening in 2020 or maybe this is some version of the butterfly effect  Ƹ̵̡Ӝ̵̨̄Ʒ (∩╹□╹∩)

Okay okay we are being a bit dramatic here but it is 2020 and anything is possible, besides our newly acquired l33t ASCII art one liners ᕕ(⌐■\_■)ᕗ, here are some of the highlights over the last 2 years.
## Internships / Bootcamps

We ran two successful internships / bootcamps, this is an important part of our strategy to contribute towards developing / nurturing local information skills in South Africa.  For additional information on the two bootcamps that we ran in the past two years, refer to:

* <https://blog.telspace.co.za/2019/03/telspace-systems-internshipboot-camp.html>
* <https://blog.telspace.co.za/2020/01/boot-camp-2020.html>

From the bootcamps we ran, we ended up hiring 5 new staff members that joined our team and are now on their way to achieving great things both at Telspace and in the community (watch this space).

Those that did not make it with us, in most of the cases, ended up finding jobs at other info sec companies and / or corporates which is the exact reason we started the bootcamp, to filter more people in to the industry as a whole, not just specifically at Telspace. We also assisted those that could not find anywhere to be placed, by sending their CVs to some of our customers and / or other competitors. Below are some pictures of the bootcamp:

|  |
| --- |
| 2020 Bootcamp |

### | | | --- | | 2019 Bootcamp |

## Talks and Research

Over the last two years we have given a number of talks and facilitated training both locally and internationally, below are some of the highlights:
## Training - Hack to Basics - x86 Windows Based Buffer Overflows, an introduction to buffer overflows

We gave this training at both DEF CON 1.0 China and DEF CON 27 - Vegas in 2019, it was presented by Dino and Manny, it was really great to meet up with all our friends at DEF CON and make new friends, hopefully in 2021 we will all be able to meet up again!

|  |
| --- |
| Undercover hackers on their way to DEFCON China (no black hoody = no hacking going on here) |

|  |
| --- |
| Epic artwork, epic venue! #HackerVibes |

|  |
| --- |
| The actual venue where we were presenting but we totally missed the entrance and went on an adventure, thank goodness for Grifter! |

|  |
| --- |
| Our names in lights O\_O |

|  |
| --- |
| A full house for all our classes with great interactions and learning! |

|  |
| --- |
| Party time, and man was it a party x\_X |

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEicrxRVbMYwmAfs19xrNZDeTn4dOLGEKqxMKc8GDytBFSbYw65GNr81nwuVSjexLbY223TD07YlIO8_U_ROtP83t475cYIhNLgI7Whxdn1Zwv27ZD-VuUdgBZ-OO7fPnS6Gp7S3GEHWRRHM/w640-h480/image.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEicrxRVbMYwmAfs19xrNZDeTn4dOLGEKqxMKc8GDytBFSbYw65GNr81nwuVSjexLbY223TD07YlIO8_U_ROtP83t475cYIhNLgI7Whxdn1Zwv27ZD-VuUdgBZ-OO7fPnS6Gp7S3GEHWRRHM/)

|  |
| --- |
| Thanks to all the trainers, organisers, volunteers and everyone that made DEFCON China 1.0 possible <3 |

## Training – Ethical Hacking 101

Right after China we were off to sunny Tel Aviv in Israel for BSides Tel Aviv where we were sponsors and also, gave our ethical hacking 101 training course.  The local Israel hacking community are really awesome and a 100% of the proceeds of our training course were given back to be used by the local BSides TLV community.

|  |
| --- |
| Some cool art work on Aviv Beach |

|  |
| --- |
| Raul (left) and Manny (right), ready to present to the community |

|  |
| --- |
| Packed house for the kick off of BSides TLV 2019 |

|  |
| --- |
| Aaaaaaaaaaaaaaaaaaaand guess where we are now, VEGAAAAAAS! |

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjKTy70qRv8MzTIUeuBoiEMeYsa2z5EpQyg1x-L3lOOJfMfbw4QRBl0R15ekR4j6wrABNYskElEMZFp4kfh5xsNu8rDtoC9wSihqKZetMsvny8yiwImCXMeLIewnljkgwUoHdVw15CoUG1z/w225-h400/image.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjKTy70qRv8MzTIUeuBoiEMeYsa2z5EpQyg1x-L3lOOJfMfbw4QRBl0R15ekR4j6wrABNYskElEMZFp4kfh5xsNu8rDtoC9wSihqKZetMsvny8yiwImCXMeLIewnljkgwUoHdVw15CoUG1z/)

Here we gave our Hack to Basics training for our DEF CON workshop, got to catch up with old friends, make new friends, nothing else like DEF CON Vegas!
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhL8d1JWQO3AXvGtnsn2GeAEMi2pbRaYqtsT407X2UqKwmSwpvCF_TmmTuNXefED7PrUgwVrdF7m_D6fbGTh_3bzQuFTG69PX1Qhx24_7N8jAMgcAFGX-vVkTieXmuKMCQ3QSAudfrQUIo1/w640-h322/image.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhL8d1JWQO3AXvGtnsn2GeAEMi2pbRaYqtsT407X2UqKwmSwpvCF_TmmTuNXefED7PrUgwVrdF7m_D6fbGTh_3bzQuFTG69PX1Qhx24_7N8jAMgcAFGX-vVkTieXmuKMCQ3QSAudfrQUIo1/)

|  |
| --- |
| Students from one of our classes (the ones that wanted to be in the picture that is!). |

|  |
| --- |
| #TheBadgeLife – we got to have them all (or at least some!). |

## Back to the Motherland

Telspace has always been very close to the local (South African) infosec community and we believe in giving back. In line with this, we started / established the DC2711 group in South Africa and had our first conference last year on the 5th of October 2019. The conference was completely FREE to attend (for the community) and allowed various international and local researchers to share their research, for a full list of who spoke, refer to <https://www.dc2711.co.za/dc2711_Presentations.html>. Attendees also got swag packs full of DC2711 goodies.

|  |
| --- |
| Jayson Street handing Dino the official DEF CON flag for the DC2711 Group |

|  |
| --- |
| The official DC2711 sticker but more importantly, a coffeeeeee voucher :D |

|  |
| --- |
| DC2711 Badges |

|  |
| --- |
| Some official swag :D |

|  |
| --- |
| Dino and Manny with their fun faces on :P |

|  |
| --- |
| #DuckArmyInvasion |

|  |
| --- |
| The core GOON team for DC2711 – thank you again! |

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiV-VgTdCJYfw76BL38-Utp2btSP67CkLoOIRbrag_WlZqtqD2Oes38uFfPB1-usXtHWEn37_QDzsUNbNXWRRwG6FglFjkUJ4-KT2DfOfKXJW3SBU6y-ApWP7-61fY3tq1i-n_6aVkuoh-2/w400-h148/image.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiV-VgTdCJYfw76BL38-Utp2btSP67CkLoOIRbrag_WlZqtqD2Oes38uFfPB1-usXtHWEn37_QDzsUNbNXWRRwG6FglFjkUJ4-KT2DfOfKXJW3SBU6y-ApWP7-61fY3tq1i-n_6aVkuoh-2/)
We were also Gold Sponsors of BSides Cape Town 2019 and Amy’s talk was also accepted (this talk was first completed at DC2711)!

|  |
| --- |
| On our way to BSides Cape Town!!!!! |

|  |
| --- |
| Amy Manià giving her talk “Put words in my mouth” although we all know it as the “deep throat” talk. |

Amy’s talk is accessible online at <https://www.youtube.com/watch?v=4R-g90lplco>.
## Research / Dropping them 0days

In 2019 and 2020 we discovered and reported on a number of vulnerabilities, some of the main ones being:

* QNAP - CVE-2019-7181 (<https://www.qnap.com/en/security-advisory/nas-201905-09>)
* phpList – CVE-2020-15072 & CVE-2020-15073 (<https://blog.telspace.co.za/2020/07/phplist-cve-2020-15072-cve-2020-15073.html>)
* Pi-hole Code Injection – CVE-2020-14971 (<https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html>)

We also released a tool called Travesty, which is a directory and file enumeration tool (post exploitation). This can be downloaded at <https://github.com/telspacesystems/travesty> .

For additional information on these and others we released / published this year refer to <https://blog.telspace.co.za/>

During DEF CON Safe Mode (DC28) Greg, Amy and Derek presented at the “War Story Bunker” event (Friday 7th August 2020), which was a pentesting story that caused a lot of big laughs and surprised faces – unfortunately these are not recorded for various reasons, but more information about DC28 can be found at <https://www.defcon.org/html/defcon-safemode/dc-safemode-schedule.html> .

Amy Mania also represented Telspace during a Woven Experiences podcast with Melissa Monnig, the interview can be listened to on Spotify at:

* <https://open.spotify.com/episode/4Co0Vo6xW3sziq77aWBa0Z?si=w_13wOjZRLyU1XvMGQHJNw> .

Throughout the year we also participated in other local and international conferences, round table events and provided comments on news stories in the media.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiMXcYJtMwjVsHfIZh-TPfLxgF7fxz5k0fC2KEBwU70vb6wL10nELJe0NdngpzonP8wNc-No1iEq9qAenYNbtZ3osNDpHSaJ6laCt67AC12oBry0hWA0-2VIBWXEVMl7-dPbMFYI1JhrvWe/w640-h186/image.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiMXcYJtMwjVsHfIZh-TPfLxgF7fxz5k0fC2KEBwU70vb6wL10nELJe0NdngpzonP8wNc-No1iEq9qAenYNbtZ3osNDpHSaJ6laCt67AC12oBry0hWA0-2VIBWXEVMl7-dPbMFYI1JhrvWe/)
Last but not least, our CEO and Founder (Dino Covotsos) is officially part of the DEF CON Review board (Talks and Workshops). This is a great achievement, in particular, representing South Africa at such an international level.  More information can be found at: https://www.defcon.org/html/defcon-27/dc-27-cfp-review-board.html
In closing, we would like to thank everyone who made our 2019/2020 so amazing, a huge thank you to our staff, clients, employees, friends and most importantly the local and international Information Security community.
We wish you all the best and a prosperous year for 2021.

at

[Thursday, December 10, 2020](https://blog.telspace.co.za/2020/12/looking-back-on-2019-and-2020.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/8918405469180868685)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=8918405469180868685&from=pencil "Edit Post")

Labels:
[0day](https://blog.telspace.co.za/search/label/0day),
[2020](https://blog.telspace.co.za/search/label/2020),
[Amy Mania](https://blog.telspace.co.za/search/label/Amy%20Mania),
[BsidesTLV](https://blog.telspace.co.za/search/label/BsidesTLV),
[Defcon](https://blog.telspace.co.za/search/label/Defcon),
[defcon 27](https://blog.telspace.co.za/search/label/defcon%2027),
[defcon china](https://blog.telspace.co.za/search/label/defcon%20china),
[Dino Covotsos](https://blog.telspace.co.za/search/label/Dino%20Covotsos),
[Manuel Corregedor](https://blog.telspace.co.za/search/label/Manuel%20Corregedor),
[research](https://blog.telspace.co.za/search/label/research),
[the munx](https://blog.telspace.co.za/search/label/the%20munx),
[year end](https://blog.telspace.co.za/search/label/year%20end)

## Thursday, July 9, 2020

### [phpList – CVE-2020-15072 & CVE-2020-15073 – Story Time](https://blog.telspace.co.za/2020/07/phplist-cve-2020-15072-cve-2020-15073.html)

phpList is currently used in 73 countries and is a popular choice for sending email newsletters, marketing campaigns and announcements. It is accessible via web browsers and is Open Source ([https://www.phplist.org](https://www.phplist.org/)), however a paid for version also exists as a service via [https://www.phplist.com](https://www.phplist.com/).

Given its wide use / adoption, I decided to take a look at phpList recently, in order to give back to the Open Source community.

I would also like to give credit to phpList for responding and patching very quickly, especially to Suela at phpList. A new version of the application is now available for download.

You can browse all the fixes, comments and patching by going to the following URLs:

·      <https://discuss.phplist.org/t/phplist-3-5-5-has-been-released/6377>
·      <https://www.phplist.org/newslist/phplist-3-5-5-release-notes/>
·      <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-15072>
·      <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-15073>

A walkthrough of the 2 identified vulnerabilities is given below:

## **1.) Code Injection via "Import administrators"**

1.1) Click on "Config" then "Import administrators"

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhyPppFv3ohHM2NT1LjJ6s6I6dhOId6El8OY15d4uKYzX-bfUk0zmqTqsHTyZ97n0JivDXXM-TtNJ_NB_qf2honm_ZGUA_fRzetB2a9KfiqzLIqKmqmVw_exQu672KG-VabCZEOhnFhKl61/s640/1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhyPppFv3ohHM2NT1LjJ6s6I6dhOId6El8OY15d4uKYzX-bfUk0zmqTqsHTyZ97n0JivDXXM-TtNJ_NB_qf2honm_ZGUA_fRzetB2a9KfiqzLIqKmqmVw_exQu672KG-VabCZEOhnFhKl61/s1600/1.png)
1.2) Edit a txt file to include basic headers and test (offline) as follows:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgwPKOi0iGqIe0P3pEW5ftErTZiITJk3xBIJmAw3O-19vuwQWYBj4GNwwQ-0oSyK-_eTQrZk2_Npa67HvarILopXHA5UDdsh7eIycClbmE4TX6wFyx4T-SZxQlOuWcDPCalcysQ2WH6C_9Q/s640/2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgwPKOi0iGqIe0P3pEW5ftErTZiITJk3xBIJmAw3O-19vuwQWYBj4GNwwQ-0oSyK-_eTQrZk2_Npa67HvarILopXHA5UDdsh7eIycClbmE4TX6wFyx4T-SZxQlOuWcDPCalcysQ2WH6C_9Q/s1600/2.png)

1.3) Click on "Choose File" and select the text file.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgvh7iweU5AySwLlTQa2RuAdW2-tc-73isJPSOxgTHsmIEo6G9w4YIYOBhFSo8kHa71vEiU9Dz-Vm7P1B6JpIp-jZxSWGv0tjzDfjyIoeI4y82MFKptTb7y3LlUQVYRJuraMIOpfHdIB6Lu/s640/3.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgvh7iweU5AySwLlTQa2RuAdW2-tc-73isJPSOxgTHsmIEo6G9w4YIYOBhFSo8kHa71vEiU9Dz-Vm7P1B6JpIp-jZxSWGv0tjzDfjyIoeI4y82MFKptTb7y3LlUQVYRJuraMIOpfHdIB6Lu/s1600/3.png)
1.4) Click "Do Import"

Code Injection Triggered (not stored)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgic4AdLYhrsjAfipXHah1jXJDYLtpkaAHa5MGpgksN81r4WA1P1vn4QGP_u2gAIM5rSOM_gwQ4EIGtOJI2RgapaXxK6eKVIXL7clJet__4k3lVGubPvxORvmYW4ttLlCPOAtyjibMJ10c9/s640/4.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgic4AdLYhrsjAfipXHah1jXJDYLtpkaAHa5MGpgksN81r4WA1P1vn4QGP_u2gAIM5rSOM_gwQ4EIGtOJI2RgapaXxK6eKVIXL7clJet__4k3lVGubPvxORvmYW4ttLlCPOAtyjibMJ10c9/s1600/4.png)
1.5) Go back to "Import administrators"
1.6) Untick "Test output:"

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj8b584eyAG_Cqdq1QWpLy7l_bAUfDYObDBi9IqsXzMWabTnszBBGiF-BWhyveTamgXeKp0adf6x7c4m4i8NVL1SqyWWgsK_yV2mR7fEh7y7h3PJiWZQr4u5hULLCLoK88w31Nty2qxgZgb/s640/5.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj8b584eyAG_Cqdq1QWpLy7l_bAUfDYObDBi9IqsXzMWabTnszBBGiF-BWhyveTamgXeKp0adf6x7c4m4i8NVL1SqyWWgsK_yV2mR7fEh7y7h3PJiWZQr4u5hULLCLoK88w31Nty2qxgZgb/s1600/5.png)

1.7) Click "Do Import" and you will get an import database error.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjuQW9yZdQfPXYvY4o7KKWn5jZXWM0dLt8PP3yszwY8EyWpflF3X7hKTx1-a5kQWPwZATPTTKB-MF0FmkO85rbtVihefHLTB2S7GlJ4j8Urn9P2spbpQzc3dxve1POff7ICjdW3NIVirALs/s640/6.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjuQW9yZdQfPXYvY4o7KKWn5jZXWM0dLt8PP3yszwY8EyWpflF3X7hKTx1-a5kQWPwZATPTTKB-MF0FmkO85rbtVihefHLTB2S7GlJ4j8Urn9P2spbpQzc3dxve1POff7ICjdW3NIVirALs/s1600/6.png)
1.8) Edit the same text file and add another user as follows:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgYPmTAJndxRf4vcUsSPNjYZiYFYVyIQXxnz0cfMzC-y2v7vAb31Yfkoadpk4seiDbHflcZquH3WfwKtlKPQP1p_K0j1ca4t4_9V6I6U3Ke0Furh26KRswcWiXmki3QfSJuUik4-GdTlWNn/s640/7.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgYPmTAJndxRf4vcUsSPNjYZiYFYVyIQXxnz0cfMzC-y2v7vAb31Yfkoadpk4seiDbHflcZquH3WfwKtlKPQP1p_K0j1ca4t4_9V6I6U3Ke0Furh26KRswcWiXmki3QfSJuUik4-GdTlWNn/s1600/7.png)
1.9) Go back to "Import administrators"
1.10) Click on "Choose File" and choose the text file.
1.11) Untick "Test output:"

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0ofAb_8LvIb0FHFjkG4YLlqh0np36tRl5VoH9Amh3KWd1eg4k9DSfvCRyJr-Fj-OLeYcE7g3xpT_BN_jFiNAc2ViANCzVvsePsaWfXQ7QANTcP_a_dbp5II_SRiDtyAvCrrz1_PUTbmFC/s640/8.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0ofAb_8LvIb0FHFjkG4YLlqh0np36tRl5VoH9Amh3KWd1eg4k9DSfvCRyJr-Fj-OLeYcE7g3xpT_BN_jFiNAc2ViANCzVvsePsaWfXQ7QANTcP_a_dbp5II_SRiDtyAvCrrz1_PUTbmFC/s1600/8.png)
1.12) Click "Do Import" and you will get more import database errors
1.13) Browse to "Subscribers" then "Subscriber Lists"

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPmMrCXyHEnVbqdoC87sIqCwbs_1r2OBaPy5pLCrT-8xLboYFBBziDyGk7AQzeEUeGudQDBrLbtYAmxD6T05ZTw9V8wUE2xRiXkFj0bCsLT00X9DokwYJPwnVNm16KdTaovRC2zr4CjsMR/s640/9.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPmMrCXyHEnVbqdoC87sIqCwbs_1r2OBaPy5pLCrT-8xLboYFBBziDyGk7AQzeEUeGudQDBrLbtYAmxD6T05ZTw9V8wUE2xRiXkFj0bCsLT00X9DokwYJPwnVNm16KdTaovRC2zr4CjsMR/s1600/9.png)
1.14) Click on the first one and you'll get a "hi" popup:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh39UGw9sJIAMhVI9OagcsCODm4um9qGrSUPnN9blTxDANPcCWGOqdlr8LCdqoesEc0NjOuvlnQlY3r2SHquH3xReuKuXw688xrUDZJHli4JqyrTOrKDBsODcZZLdgcWnhGu4VoY3nJNoOQ/s640/10.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh39UGw9sJIAMhVI9OagcsCODm4um9qGrSUPnN9blTxDANPcCWGOqdlr8LCdqoesEc0NjOuvlnQlY3r2SHquH3xReuKuXw688xrUDZJHli4JqyrTOrKDBsODcZZLdgcWnhGu4VoY3nJNoOQ/s1600/10.png)
 1.15) Go back and click on the second one and you'll get a cookie.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiz07ar6YdyKGZ4K_aLR8G8M8m2SgktgbWypmtca56Qfbri2sDeRoI0L4czb8j-qkQSpW5gsDrsk9XSpILHpLIqjhPAxcI8KoKLHA5izCV-F2bRdBYBp0fGN1MeisNeSydKDVfZd3YrYEBT/s640/11.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiz07ar6YdyKGZ4K_aLR8G8M8m2SgktgbWypmtca56Qfbri2sDeRoI0L4czb8j-qkQSpW5gsDrsk9XSpILHpLIqjhPAxcI8KoKLHA5izCV-F2bRdBYBp0fGN1MeisNeSydKDVfZd3YrYEBT/s1600/11.png)

## **2.) Error based SQL Injection via "Import administrators"**

2.1) Click on "Config" then "Import administrators"
2.2) Edit a txt file to include basic headers and text (offline) as follows

email   loginname      password

test2@test.com          "'testsql          test

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhGbYsXFzmDJ5iWWP4c2HzU40ddbxAVCm1t7W6_lM0hJElHVusQDZKq1wPs8RUNLP1bOJouI4YK_1muJqlVjErI9Hfa9aIMrU7ujCbDfuHuY62JItMbuki0__Em9n12PHil7WeLaCfwJXkn/s640/12.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhGbYsXFzmDJ5iWWP4c2HzU40ddbxAVCm1t7W6_lM0hJElHVusQDZKq1wPs8RUNLP1bOJouI4YK_1muJqlVjErI9Hfa9aIMrU7ujCbDfuHuY62JItMbuki0__Em9n12PHil7WeLaCfwJXkn/s1600/12.png)
2.3) Untick "Test output:"
2.4) Click on "Choose File" and choose the text file.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg7svvZIQqFpA0aWRFPRMfR9uEp5I-l8nkHV2jxgiSOIkdBoZwsn7_3Z5_Z2IL8ShXixWTw9o43Tt_gMECC_lhT9TPX5GCNbh1LBaA2og3CHcuNEfE0MjqzQ19elWjcZydH4VfzRmOSVy3t/s640/13.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg7svvZIQqFpA0aWRFPRMfR9uEp5I-l8nkHV2jxgiSOIkdBoZwsn7_3Z5_Z2IL8ShXixWTw9o43Tt_gMECC_lhT9TPX5GCNbh1LBaA2og3CHcuNEfE0MjqzQ19elWjcZydH4VfzRmOSVy3t/s1600/13.png)

 2.5) Click "Do Import" - you'll see the Error Based SQL injection.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjANUdklmTFIgLcH0aBiHikAst6LrVbZ6vqsWQ9OIqAhDTATmBrfzzufhVN2UumiMPO-eEjVC0ibcukbPP9hpewuDK_0UPBe14uRJTbGyG0KuC2KUhqdcP0Lqgg1ft6rk49IDVqU5yi8DRb/s640/14.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjANUdklmTFIgLcH0aBiHikAst6LrVbZ6vqsWQ9OIqAhDTATmBrfzzufhVN2UumiMPO-eEjVC0ibcukbPP9hpewuDK_0UPBe14uRJTbGyG0KuC2KUhqdcP0Lqgg1ft6rk49IDVqU5yi8DRb/s1600/14.png)

*Creative Commons - Attribution-ShareAlike 4.0 International (CC BY-SA 4.0) - <https://creativecommons.org/licenses/by-sa/4.0/>*

at

[Thursday, July 09, 2020](https://blog.telspace.co.za/2020/07/phplist-cve-2020-15072-cve-2020-15073.html "permanent link")

[1 comment:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/6349469799071097550)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=6349469799071097550&from=pencil "Edit Post")

Labels:
[2020](https://blog.telspace.co.za/search/label/2020),
[code injection](https://blog.telspace.co.za/search/label/code%20injection),
[CVE-2020-15072](https://blog.telspace.co.za/search/label/CVE-2020-15072),
[CVE-2020-15073](https://blog.telspace.co.za/search/label/CVE-2020-15073),
[phpList](https://blog.telspace.co.za/search/label/phpList),
[security advisory](https://blog.telspace.co.za/search/label/security%20advisory),
[sql injection](https://blog.telspace.co.za/search/label/sql%20injection)

## Tuesday, June 23, 2020

### [Pi-hole Code Injection – CVE-2020-14971– Story Time](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html)

A while ago, we had an internal discussion around people working from home and the technologies/products that could be implemented and/or bought to protect home users. This was due to the implementation of the nationwide lockdown which resulted in companies being forced to change their approach entirely to having employees work from home.

During this discussion the Pi-hole was mentioned. Pi-hole is a very popular option for the more “tech savvy” home user and generally, anyone that’s tired of being spammed with random adverts on every website. You can find more information about it here <https://github.com/pi-hole/pi-hole/>.

Since I had a Pi-hole installed already, I decided to take a look at this beautiful piece of ad blocking software in more detail, specifically reviewing the code and logic of the application. Because it’s Opensource and available freely, this was easily accomplished by downloading and installing the latest Pi-hole (v5.0 at the time).

It’s worth mentioning that a lot of vulnerabilities had already been found in this software, some overlapped with findings that I had found particularly during April and May, which were rightfully allocated to the first people that reported the issues. With that being said, the Pi-hole is a popular target for researchers and adds a lot of value to people’s home and small office environments, so the more findings and fixes the better. I also wanted to focus on the latest version because of this.

Initially, I had found a few critical security vulnerabilities but many had been found and fixed already and others eventually required local shell access in some form, some functionality had been changed over time, which solved those particular RCE issues too. So, I therefore looked at a few other vectors and decided to focus on one specific attack vector, which looked promising.

## **Backup Functions:**

Settings.php has lots of functionality, one of which allows users to back up and restore (export and import) configurations of the Pi-hole with a limited set of files (teleporter tab).

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s640/Screen+Shot+2020-06-18+at+4.31.19+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.31.19%2BPM.png)

This was interesting for me because when you export files, they are compressed in tar.gz format and saved. Upon decompression and by systematically reviewing each file that was saved, I found that there were several files which were useful and easy wins for RCE, in particular if no whitelisting and sanitising was taking place. However, those particular ones are not restored if you modify them, re-compress and upload to restore the backup.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s640/Screen+Shot+2020-06-18+at+4.35.31+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.35.31%2BPM.png)

In this instance though, the affected files I found are dnsmasq.d configuration files and the adlist.json file. The dnsmasq.d/04-pi-hole-static-dhcp.conf file allows static DHCP leases, which link to MAC, IP and host.

I modified the configuration file for dnsmasq.d initially, in which I added my own code for the host parameter. Once I did this, I recompressed the file accordingly and imported the file back in via teleporter:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s640/Screen+Shot+2020-06-18+at+4.38.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.38.14%2BPM.png)

Upon browsing to the static DHCP leases section of the Pi-hole web interface, I could see my code was executing correctly i.e. I had found a Code Injection vulnerability.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s640/Screen+Shot+2020-06-18+at+4.39.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.39.14%2BPM.png)

The same then applied to adlists.json and other parameters in other files, as all the files were not being properly checked upon upload, they also just overwrote whatever was previously there and therefore your code executed accordingly:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s640/Screen+Shot+2020-06-22+at+10.13.18+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s1600/Screen%2BShot%2B2020-06-22%2Bat%2B10.13.18%2BPM.png)

Browse to host/admin/groups-adlists.php and you should get the ‘Adam popup’:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s640/Screen+Shot+2020-06-18+at+4.45.47+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.45.47%2BPM.png)

There are more examples, however it’s more of the same as what has been discussed above. I would also like to mention, that the Pi-hole is an amazing piece of software, built by people who really care for the community, please support them and donate. All the responses (especially from Adam) were really quick and things were patched exceptionally quickly.

You can browse all the fixes, comments and progress of patching by going here:

<https://github.com/pi-hole/AdminLTE/commit/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-640920508>

<https://github.com/pi-hole/AdminLTE/commit/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-643830404>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14971>

at

[Tuesday, June 23, 2020](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/4313565159762696677)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=4313565159762696677&from=pencil "Edit Post")

Labels:
[0day](https://blog.telspace.co.za/search/label/0day),
[2020](https://blog.telspace.co.za/search/label/2020),
[code injection](https://blog.telspace.co.za/search/label/code%20injection),
[CVE-2020-14971](https://blog.telspace.co.za/search/label/CVE-2020-14971),
[pentesting](https://blog.telspace.co.za/search/label/pentesting),
[pihole](https://blog.telspace.co.za/search/label/pihole)

## Wednesday, May 20, 2020

### [Bypassing refresh tokens with SQLMap’s tamper scripts](https://blog.telspace.co.za/2020/05/bypassing-refresh-tokens-with-sqlmaps_20.html)

In this blog post, I will be taking you through how to make use of the “--tamper” parameter of the SQLMap tool to bypass the limitations of a web application using JWT tokens.

A function of web applications that use JWT tokens is to make the token expire after a certain period of time. This then results in you receiving an error 401 message in the web application, meaning that you don’t have the correct privileges to use that specific web application or endpoint.

During a recent assessment, I came across a web application, which made use of JWT tokens for its authentication process. After token expiry, a request should always be sent to the application to reauthorise access and get a new token.

When using SQLMap to test a web application against potential SQL injection vulnerabilities, this became an issue, as the application would re-authenticate and a new token was issued, which would then result in an error 401 message.

I came up with a solution to this problem when using SQLMap, by requesting a new token and then changing the authorisation header which would then result in this problem being bypassed.

Below is the example of how this was successfully achieved.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0DmZ6IWF-5ddLMvYB9SXupxziC97FL9OKrk6NgvRoIrijGlhiHVNlr9cK8x2WfHS2okMjjLbIL25b8OwgtnzHVLkXZNr_a3rbtaOIXAfwbpmD6T9_c2VtNXxazZiU2E4Cnj1ZzjGYCuc2/s640/1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0DmZ6IWF-5ddLMvYB9SXupxziC97FL9OKrk6NgvRoIrijGlhiHVNlr9cK8x2WfHS2okMjjLbIL25b8OwgtnzHVLkXZNr_a3rbtaOIXAfwbpmD6T9_c2VtNXxazZiU2E4Cnj1ZzjGYCuc2/s1600/1.png)

First the request for a new token was sent to the application:

As can be seen below, this request then responded back with JSON, containing  an “access\_token” which could then be used in the next request:
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidFfXBwVkMnIy6LT0yIEkMup0ZoDJBUY-m61TBEgYHOgRDB9zAQR1KWqlxs4J6_b2vPPovelYyKbYE4cZUHzaBpD9FNSVKBSmNLCPHZ4vwuHYpXZCydP8IVfJC2ofI3g0T63RZE2T0p0y5/s640/2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidFfXBwVkMnIy6LT0yIEkMup0ZoDJBUY-m61TBEgYHOgRDB9zAQR1KWqlxs4J6_b2vPPovelYyKbYE4cZUHzaBpD9FNSVKBSmNLCPHZ4vwuHYpXZCydP8IVfJC2ofI3g0T63RZE2T0p0y5/s1600/2.png)

For the next step, I then used Python to recreate the POST request in a script. In the screenshot below, you can see the code that was used for the POST request:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjF6IIh-FZ4pJCwTB4scDgnxIcqHJgM_T_BR5LIC5iLH9VXQwR6SKQskRXPvY3CYUlVR7U24F6tmCbCP_SGYYP9yF5Hlnni18WAkfzhSQCMZ6nh4DaR1ZfKw9-8tnGhxVThNatNxmsutwFy/s640/3.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjF6IIh-FZ4pJCwTB4scDgnxIcqHJgM_T_BR5LIC5iLH9VXQwR6SKQskRXPvY3CYUlVR7U24F6tmCbCP_SGYYP9yF5Hlnni18WAkfzhSQCMZ6nh4DaR1ZfKw9-8tnGhxVThNatNxmsutwFy/s1600/3.png)

In addition to the above code, the authorisation header should be rewritten with new information before every request that is sent by SQLMap, as can be seen below:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi_Wm2M6VVwhZV4C6vA8jRVV9GlNIjzuV66cAqgvLZo_bSmX95Flb3_HxBWF2oZGEIwtDJvyzbIP-JfFOLyx2iFyNUUkcH-bDAs_2kRlMqGsxzWmZMUzQiLMQmaFdCJRhIxiYR_t8NSklX_/s640/4.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi_Wm2M6VVwhZV4C6vA8jRVV9GlNIjzuV66cAqgvLZo_bSmX95Flb3_HxBWF2oZGEIwtDJvyzbIP-JfFOLyx2iFyNUUkcH-bDAs_2kRlMqGsxzWmZMUzQiLMQmaFdCJRhIxiYR_t8NSklX_/s1600/4.png)
The full tamper script should then look like the code in the screenshot below:
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhknDkNSM9flxODQSs-sEorX78KOeighilmN4QTXFIcjKi7rzB69FF6sDZj2ZEnYYopM5izvGbgaDcW90SHeGdi2uZ-0VLgDrTqNicS-N7l9gt9KS1T3rPdPiAsDCj9Ls6kS-aXdNMzfb8R/s640/5.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhknDkNSM9flxODQSs-sEorX78KOeighilmN4QTXFIcjKi7rzB69FF6sDZj2ZEnYYopM5izvGbgaDcW90SHeGdi2uZ-0VLgDrTqNicS-N7l9gt9KS1T3rPdPiAsDCj9Ls6kS-aXdNMzfb8R/s1600/5.png)
Lastly, in the screenshot below you can see  the command for executing the tamper script against a target using SQLMap(*sqlmap -u <https://url.com/> --tamper bypass.py*):
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgMU7UUji78h0oKlhyMmXVfgSRIRuapHsLmEFNLsP_wcJmIea0cqn49od1beC47E5HJj_wowQKVZIRqMtQ_F0Lcpm_GrSVPTrn78mEfaIq0wGbbEYt_tC9WNV3i3P0zzHcS9JnAp-L7XSah/s640/6.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgMU7UUji78h0oKlhyMmXVfgSRIRuapHsLmEFNLsP_wcJmIea0cqn49od1beC47E5HJj_wowQKVZIRqMtQ_F0Lcpm_GrSVPTrn78mEfaIq0wGbbEYt_tC9WNV3i3P0zzHcS9JnAp-L7XSah/s1600/6.png)

At this point, requests are sent correctly by refreshing the token and you will no longer receive a 401 error message.

I hope you have found this information to be of a value and that it will assist you in future penetration tests.

- Blog post by Motaz of Telspace Systems.

at

[Wednesday, May 20, 2020](https://blog.telspace.co.za/2020/05/bypassing-refresh-tokens-with-sqlmaps_20.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/7070204879869371076)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=7070204879869371076&from=pencil "Edit Post")

Labels:
[2020](https://blog.telspace.co.za/search/label/2020),
[JWT](https://blog.telspace.co.za/search/label/JWT),
[JWT Tokens](https://blog.telspace.co.za/search/label/JWT%20Tokens),
[python](https://blog.telspace.co.za/search/label/python),
[sql injection](https://blog.telspace.co.za/search/label/sql%20injection),
[SQLMap](https://blog.telspace.co.za/search/label/SQLMap),
[web application assessment](https://blog.telspace.co.za/search/label/web%20application%20assessment)

[Older Posts](https://blog.telspace.co.za/search/label/2020?updated-max=2020-05-20T11:02:00%2B02:00&max-results=20&start=4&by-date=false "Older Posts")

[Home](https://blog.telspace.co.za/)

Subscribe to:
[Posts (Atom)](https://blog.telspace.co.za/feeds/posts/default)

[![](https://www.telspace.africa/img/tel27.jpg)](https://www.telspace.africa)

www.telspace.africa

| Blog Archive  * ▼   [2023](https://blog.telspace.co.za/2023/)   (2)   + ▼     [October](https://blog.telspace.co.za/2023/10/)     (1)     - [Transformative Journey: My Experience at the Telsp...](https://blog.telspace.co.za/2023/10/transformative-journey-my-experience-at.html)   + ►     [August](https://blog.telspace.co.za/2023/08/)     (1)  * ►   [2022](https://blog.telspace.co.za/2022/)   (2)   + ►     [July](https://blog.telspace.co.za/2022/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2022/05/)     (1)  * ►   [2021](https://blog.telspace.co.za/2021/)   (2)   + ►     [July](https://blog.telspace.co.za/2021/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2021/04/)     (1)  * ►   [2020](https://blog.telspace.co.za/2020/)   (8)   + ►     [December](https://blog.telspace.co.za/2020/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2020/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2020/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2020/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2020/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2020/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2020/01/)     (1)  * ►   [2019](https://blog.telspace.co.za/2019/)   (8)   + ►     [November](https://blog.telspace.co.za/2019/11/)     (1)   + ►     [September](https://blog.telspace.co.za/2019/09/)     (1)   + ►     [August](https://blog.telspace.co.za/2019/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2019/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2019/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2019/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2019/01/)     (1)  * ►   [2018](https://blog.telspace.co.za/2018/)   (3)   + ►     [March](https://blog.telspace.co.za/2018/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2018/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2018/01/)     (1)  * ►   [2017](https://blog.telspace.co.za/2017/)   (7)   + ►     [December](https://blog.telspace.co.za/2017/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2017/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2017/09/)     (4)   + ►     [February](https://blog.telspace.co.za/2017/02/)     (1)  * ►   [2016](https://blog.telspace.co.za/2016/)   (5)   + ►     [December](https://blog.telspace.co.za/2016/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2016/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2016/05/)     (3)  * ►   [2015](https://blog.telspace.co.za/2015/)   (7)   + ►     [December](https://blog.telspace.co.za/2015/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2015/10/)     (2)   + ►     [March](https://blog.telspace.co.za/2015/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2015/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2015/01/)     (1)  * ►   [2014](https://blog.telspace.co.za/2014/)   (14)   + ►     [October](https://blog.telspace.co.za/2014/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2014/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2014/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2014/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2014/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2014/04/)     (2)   + ►     [February](https://blog.telspace.co.za/2014/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2014/01/)     (2)  * ►   [2013](https://blog.telspace.co.za/2013/)   (15)   + ►     [December](https://blog.telspace.co.za/2013/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2013/11/)     (1)   + ►     [October](https://blog.telspace.co.za/2013/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2013/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2013/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2013/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2013/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2013/05/)     (4)   + ►     [April](https://blog.telspace.co.za/2013/04/)     (1)   + ►     [March](https://blog.telspace.co.za/2013/03/)     (1)  * ►   [2012](https://blog.telspace.co.za/2012/)   (5)   + ►     [October](https://blog.telspace.co.za/2012/10/)     (1)   + ►     [July](https://blog.telspace.co.za/2012/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2012/04/)     (1)   + ►     [January](https://blog.telspace.co.za/2012/01/)     (2)  * ►   [2011](https://blog.telspace.co.za/2011/)   (11)   + ►     [November](https://blog.telspace.co.za/2011/11/)     (2)   + ►     [August](https://blog.telspace.co.za/2011/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2011/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2011/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2011/04/)     (2)   + ►     [March](https://blog.telspace.co.za/2011/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2011/01/)     (2)  * ►   [2010](https://blog.telspace.co.za/2010/)   (15)   + ►     [December](https://blog.telspace.co.za/2010/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2010/11/)     (2)   + ►     [September](https://blog.telspace.co.za/2010/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2010/08/)     (1)   + ►     [July](https://blog.telspace.co.za/2010/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2010/05/)     (3)   + ►     [March](https://blog.telspace.co.za/2010/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2010/02/)     (3)  * ►   [2009](https://blog.telspace.co.za/2009/)   (10)   + ►     [September](https://blog.telspace.co.za/2009/09/)     (2)   + ►     [July](https://blog.telspace.co.za/2009/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2009/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2009/05/)     (1)   + ►     [February](https://blog.telspace.co.za/2009/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2009/01/)     (3)  * ►   [2008](https://blog.telspace.co.za/2008/)   (26)   + ►     [December](https://blog.telspace.co.za/2008/12/)     (4)   + ►     [November](https://blog.telspace.co.za/2008/11/)     (2)   + ►     [October](https://blog.telspace.co.za/2008/10/)     (4)   + ►     [September](https://blog.telspace.co.za/2008/09/)     (6)   + ►     [August](https://blog.telspace.co.za/2008/08/)     (3)   + ►     [July](https://blog.telspace.co.za/2008/07/)     (2)   + ►     [June](https://blog.telspace.co.za/2008/06/)     (3)   + ►     [May](https://blog.telspace.co.za/2008/05/)     (2) | Subscribe now!   Posts   [Atom](https://blog.telspace.co.za/feeds/posts/default)     Posts       All Comments   [Atom](https://blog.telspace.co.za/feeds/comments/default)     All Comments |
| --- | --- |

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).



=== Content from blog.telspace.co.za_c834b4a1_20250119_140256.html ===


# [Telspace Africa, The Blog](https://blog.telspace.co.za/)

Hackers for hire

## Tuesday, June 23, 2020

### Pi-hole Code Injection – CVE-2020-14971– Story Time

A while ago, we had an internal discussion around people working from home and the technologies/products that could be implemented and/or bought to protect home users. This was due to the implementation of the nationwide lockdown which resulted in companies being forced to change their approach entirely to having employees work from home.

During this discussion the Pi-hole was mentioned. Pi-hole is a very popular option for the more “tech savvy” home user and generally, anyone that’s tired of being spammed with random adverts on every website. You can find more information about it here <https://github.com/pi-hole/pi-hole/>.

Since I had a Pi-hole installed already, I decided to take a look at this beautiful piece of ad blocking software in more detail, specifically reviewing the code and logic of the application. Because it’s Opensource and available freely, this was easily accomplished by downloading and installing the latest Pi-hole (v5.0 at the time).

It’s worth mentioning that a lot of vulnerabilities had already been found in this software, some overlapped with findings that I had found particularly during April and May, which were rightfully allocated to the first people that reported the issues. With that being said, the Pi-hole is a popular target for researchers and adds a lot of value to people’s home and small office environments, so the more findings and fixes the better. I also wanted to focus on the latest version because of this.

Initially, I had found a few critical security vulnerabilities but many had been found and fixed already and others eventually required local shell access in some form, some functionality had been changed over time, which solved those particular RCE issues too. So, I therefore looked at a few other vectors and decided to focus on one specific attack vector, which looked promising.

## **Backup Functions:**

Settings.php has lots of functionality, one of which allows users to back up and restore (export and import) configurations of the Pi-hole with a limited set of files (teleporter tab).

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s640/Screen+Shot+2020-06-18+at+4.31.19+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.31.19%2BPM.png)

This was interesting for me because when you export files, they are compressed in tar.gz format and saved. Upon decompression and by systematically reviewing each file that was saved, I found that there were several files which were useful and easy wins for RCE, in particular if no whitelisting and sanitising was taking place. However, those particular ones are not restored if you modify them, re-compress and upload to restore the backup.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s640/Screen+Shot+2020-06-18+at+4.35.31+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.35.31%2BPM.png)

In this instance though, the affected files I found are dnsmasq.d configuration files and the adlist.json file. The dnsmasq.d/04-pi-hole-static-dhcp.conf file allows static DHCP leases, which link to MAC, IP and host.

I modified the configuration file for dnsmasq.d initially, in which I added my own code for the host parameter. Once I did this, I recompressed the file accordingly and imported the file back in via teleporter:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s640/Screen+Shot+2020-06-18+at+4.38.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.38.14%2BPM.png)

Upon browsing to the static DHCP leases section of the Pi-hole web interface, I could see my code was executing correctly i.e. I had found a Code Injection vulnerability.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s640/Screen+Shot+2020-06-18+at+4.39.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.39.14%2BPM.png)

The same then applied to adlists.json and other parameters in other files, as all the files were not being properly checked upon upload, they also just overwrote whatever was previously there and therefore your code executed accordingly:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s640/Screen+Shot+2020-06-22+at+10.13.18+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s1600/Screen%2BShot%2B2020-06-22%2Bat%2B10.13.18%2BPM.png)

Browse to host/admin/groups-adlists.php and you should get the ‘Adam popup’:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s640/Screen+Shot+2020-06-18+at+4.45.47+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.45.47%2BPM.png)

There are more examples, however it’s more of the same as what has been discussed above. I would also like to mention, that the Pi-hole is an amazing piece of software, built by people who really care for the community, please support them and donate. All the responses (especially from Adam) were really quick and things were patched exceptionally quickly.

You can browse all the fixes, comments and progress of patching by going here:

<https://github.com/pi-hole/AdminLTE/commit/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-640920508>

<https://github.com/pi-hole/AdminLTE/commit/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-643830404>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14971>

at

[Tuesday, June 23, 2020](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=4313565159762696677&from=pencil "Edit Post")

Labels:
[0day](https://blog.telspace.co.za/search/label/0day),
[2020](https://blog.telspace.co.za/search/label/2020),
[code injection](https://blog.telspace.co.za/search/label/code%20injection),
[CVE-2020-14971](https://blog.telspace.co.za/search/label/CVE-2020-14971),
[pentesting](https://blog.telspace.co.za/search/label/pentesting),
[pihole](https://blog.telspace.co.za/search/label/pihole)

#### No comments:

[Post a Comment](https://www.blogger.com/comment/fullpage/post/2540168616552398462/4313565159762696677)

[Newer Post](https://blog.telspace.co.za/2020/07/phplist-cve-2020-15072-cve-2020-15073.html "Newer Post")

[Older Post](https://blog.telspace.co.za/2020/05/certification-review-oswe-staff-review.html "Older Post")

[Home](https://blog.telspace.co.za/)

Subscribe to:
[Post Comments (Atom)](https://blog.telspace.co.za/feeds/4313565159762696677/comments/default)

[![](https://www.telspace.africa/img/tel27.jpg)](https://www.telspace.africa)

www.telspace.africa

| Blog Archive  * ►   [2023](https://blog.telspace.co.za/2023/)   (2)   + ►     [October](https://blog.telspace.co.za/2023/10/)     (1)   + ►     [August](https://blog.telspace.co.za/2023/08/)     (1)  * ►   [2022](https://blog.telspace.co.za/2022/)   (2)   + ►     [July](https://blog.telspace.co.za/2022/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2022/05/)     (1)  * ►   [2021](https://blog.telspace.co.za/2021/)   (2)   + ►     [July](https://blog.telspace.co.za/2021/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2021/04/)     (1)  * ▼   [2020](https://blog.telspace.co.za/2020/)   (8)   + ►     [December](https://blog.telspace.co.za/2020/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2020/07/)     (1)   + ▼     [June](https://blog.telspace.co.za/2020/06/)     (1)     - [Pi-hole Code Injection – CVE-2020-14971– Story Time](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html)   + ►     [May](https://blog.telspace.co.za/2020/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2020/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2020/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2020/01/)     (1)  * ►   [2019](https://blog.telspace.co.za/2019/)   (8)   + ►     [November](https://blog.telspace.co.za/2019/11/)     (1)   + ►     [September](https://blog.telspace.co.za/2019/09/)     (1)   + ►     [August](https://blog.telspace.co.za/2019/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2019/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2019/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2019/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2019/01/)     (1)  * ►   [2018](https://blog.telspace.co.za/2018/)   (3)   + ►     [March](https://blog.telspace.co.za/2018/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2018/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2018/01/)     (1)  * ►   [2017](https://blog.telspace.co.za/2017/)   (7)   + ►     [December](https://blog.telspace.co.za/2017/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2017/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2017/09/)     (4)   + ►     [February](https://blog.telspace.co.za/2017/02/)     (1)  * ►   [2016](https://blog.telspace.co.za/2016/)   (5)   + ►     [December](https://blog.telspace.co.za/2016/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2016/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2016/05/)     (3)  * ►   [2015](https://blog.telspace.co.za/2015/)   (7)   + ►     [December](https://blog.telspace.co.za/2015/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2015/10/)     (2)   + ►     [March](https://blog.telspace.co.za/2015/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2015/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2015/01/)     (1)  * ►   [2014](https://blog.telspace.co.za/2014/)   (14)   + ►     [October](https://blog.telspace.co.za/2014/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2014/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2014/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2014/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2014/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2014/04/)     (2)   + ►     [February](https://blog.telspace.co.za/2014/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2014/01/)     (2)  * ►   [2013](https://blog.telspace.co.za/2013/)   (15)   + ►     [December](https://blog.telspace.co.za/2013/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2013/11/)     (1)   + ►     [October](https://blog.telspace.co.za/2013/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2013/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2013/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2013/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2013/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2013/05/)     (4)   + ►     [April](https://blog.telspace.co.za/2013/04/)     (1)   + ►     [March](https://blog.telspace.co.za/2013/03/)     (1)  * ►   [2012](https://blog.telspace.co.za/2012/)   (5)   + ►     [October](https://blog.telspace.co.za/2012/10/)     (1)   + ►     [July](https://blog.telspace.co.za/2012/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2012/04/)     (1)   + ►     [January](https://blog.telspace.co.za/2012/01/)     (2)  * ►   [2011](https://blog.telspace.co.za/2011/)   (11)   + ►     [November](https://blog.telspace.co.za/2011/11/)     (2)   + ►     [August](https://blog.telspace.co.za/2011/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2011/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2011/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2011/04/)     (2)   + ►     [March](https://blog.telspace.co.za/2011/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2011/01/)     (2)  * ►   [2010](https://blog.telspace.co.za/2010/)   (15)   + ►     [December](https://blog.telspace.co.za/2010/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2010/11/)     (2)   + ►     [September](https://blog.telspace.co.za/2010/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2010/08/)     (1)   + ►     [July](https://blog.telspace.co.za/2010/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2010/05/)     (3)   + ►     [March](https://blog.telspace.co.za/2010/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2010/02/)     (3)  * ►   [2009](https://blog.telspace.co.za/2009/)   (10)   + ►     [September](https://blog.telspace.co.za/2009/09/)     (2)   + ►     [July](https://blog.telspace.co.za/2009/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2009/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2009/05/)     (1)   + ►     [February](https://blog.telspace.co.za/2009/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2009/01/)     (3)  * ►   [2008](https://blog.telspace.co.za/2008/)   (26)   + ►     [December](https://blog.telspace.co.za/2008/12/)     (4)   + ►     [November](https://blog.telspace.co.za/2008/11/)     (2)   + ►     [October](https://blog.telspace.co.za/2008/10/)     (4)   + ►     [September](https://blog.telspace.co.za/2008/09/)     (6)   + ►     [August](https://blog.telspace.co.za/2008/08/)     (3)   + ►     [July](https://blog.telspace.co.za/2008/07/)     (2)   + ►     [June](https://blog.telspace.co.za/2008/06/)     (3)   + ►     [May](https://blog.telspace.co.za/2008/05/)     (2) | Subscribe now!   Posts   [Atom](https://blog.telspace.co.za/feeds/posts/default)     Posts       Comments   [Atom](https://blog.telspace.co.za/feeds/4313565159762696677/comments/default)     Comments |
| --- | --- |

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).



=== Content from blog.telspace.co.za_531af428_20250119_140253.html ===


# [Telspace Africa, The Blog](https://blog.telspace.co.za/)

Hackers for hire

## Thursday, May 28, 2020

### [{Certification Review} - OSWE - Staff Review](https://blog.telspace.co.za/2020/05/certification-review-oswe-staff-review.html)

Recently, Offensive-Security released an online version of their certification called “Offensive Security Web Expert” aka OSWE. After having already experienced and successfully obtaining several other certifications from Offensive Security such as OSCP and OSCE, I was curious and intrigued to give the OSWE course a try as well.
I decided to choose the 2-month package option for the course called “Advanced Web Attacks and Exploitation” and due to other commitments I was able to request and was granted a minor 15 day extension.
After watching the videos and reading through the course material, I was very impressed by the content of the course, as it contained detailed information and analysis on certain in-depth attacks.
The course followed a white-box testing approach which was based on source code review, by reading the code of the web application in order to find and exploit potential vulnerabilities.
The course material included several labs with web application software installed on them and by following the content provided in the course material, exploiting the machines was relatively easy.
Before embarking on this course, I would recommend that you have a good understanding of the following skills:

**1.****Python scripting language:**

The course will require you to have a solid understanding of, as well as experience with python scripting, as it  is used for automating the process of exploiting vulnerabilities as well as automating exploits.

**2.****Other programming languages:**

It is also very important to have basic knowledge and understanding of other programming languages such as C#, JavaScript and Java.

**3.****Prior experience with web application attacks:**

Prior experience with web application attacks will also be very advantageous as you will be required to have strong knowledge and understanding of common modern web attacks. Personally, I would also highly recommend reading the book titled “Web Application Hacker’s Handbook”  beforehand as its content will be very helpful during the course and thereafter.

**4.****Source code review:**

One of the outcomes that this course will teach you is how to do Whitebox testing on web applications by reviewing and understanding the code of the application. Therefore, prior experience in doing source code review on web applications will be advantageous.

**5.****Web development experience:**

Having prior experience with web development and the workings of web applications will also assist with successfully completing this course.

## **Course Overview:**

After receiving the course materials, I began reading the book, watching videos and solving the exercises and milestones.
The first few chapters of the course were relatively basic but from Chapter 4 onwards it became far more advanced. Personally it was at this point that it really became fun, as the course delved deeper into  advanced techniques and attacks types.
Offensive Security recommends that you try and solve the exercises and milestones  as you progress through the chapters to ensure that you get a better grasp and understanding of the materials and also as proof that you have understood everything in that particular chapter.
Listed below, is a list of pros and cons to consider when deciding to take this course:

·       **PROS:**

o  Great for learning and advancing white box testing and source code review skills.
o  The course covers advanced real-world vulnerabilities such as deserialization attacks and advanced techniques.
o  The course covers a wide range of vulnerabilities and exploits, including medium, high and critical risk.
·       **CONS:**

o Although the course covers many different attack types, there are a few that are not covered in the course, for example, XXE, SSRF, CSRF and SSTI.
        o More exercise work and milestones would be advantageous to learners

## **The lab review:**

The lab consisted of 5 machines  which contained the web applications as discussed in the course material. Therefore, by going through the course material comprehensivly and successfully completing the course exercises and milestones, you should be able to successfully execute the necessary attacks and exploitation paths.
Personally, I would recommend practicing as much as possible before moving onto the exam, as this will help increase your skills and confidence.

## **The exam review:**

The exam for the OSWE course is a 48 hour exam, which includes an additional 24 hours for writing your step by step report of the exam. As with all exams, I would recommend that you ensure that you get enough sleep to ensure that you are well rested and able to perform at your peak.
During the exam, I had not rested enough and it started to affect my performance, therefore my recommendation is that if you start feeling tired, go sleep for a bit and then resume as this will help you to think clearer.
A few other suggestions from my experience is to remember to get up and take a walk every few hours and don’t forget to take screenshots as you solve the challenges in the exam.
Lastly, try not to stress too much about the exam, try to think of it as a challenge that you are trying to solve, rather than an exam itself.
### **Important material to read before undertaking this course:**

Below is a list of content material that I would recommend that you read and work through before you undertake the OSWE course:

* “The Web Application hackers handbook” (<https://www.amazon.com/Web-Application-Hackers-Handbook-Exploiting/dp/1118026470>)
* <https://github.com/swisskyrepo/PayloadsAllTheThings>
* Pentest monkey will be helpful for some reverse shell cheat sheets (<http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet>)
* Deserialization attacks on .NET (<https://www.youtube.com/watch?v=eDfGpu3iE4Q>)
* Deserialization on several coding languages (<https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html>)

## **Summary:**

OSWE is a very good course for people looking to improve their source code review skills as well as learning how to detect bugs and vulnerabilities by searching for them in the code itself. I would recommend that you book your exam not long after your lab time ends, so that the information you have learned will be fresh and ready to be used. Overall I enjoyed my OSWE experience and would therefore recommend it to others.
- Blog post by Motaz of Telspace Systems

at

[Thursday, May 28, 2020](https://blog.telspace.co.za/2020/05/certification-review-oswe-staff-review.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/5433247023834488353)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=5433247023834488353&from=pencil "Edit Post")

Labels:
[AWAE](https://blog.telspace.co.za/search/label/AWAE),
[infosec training](https://blog.telspace.co.za/search/label/infosec%20training),
[OSWE](https://blog.telspace.co.za/search/label/OSWE),
[pentesting](https://blog.telspace.co.za/search/label/pentesting),
[web application assessment](https://blog.telspace.co.za/search/label/web%20application%20assessment)

## Wednesday, May 20, 2020

### [Bypassing refresh tokens with SQLMap’s tamper scripts](https://blog.telspace.co.za/2020/05/bypassing-refresh-tokens-with-sqlmaps_20.html)

In this blog post, I will be taking you through how to make use of the “--tamper” parameter of the SQLMap tool to bypass the limitations of a web application using JWT tokens.

A function of web applications that use JWT tokens is to make the token expire after a certain period of time. This then results in you receiving an error 401 message in the web application, meaning that you don’t have the correct privileges to use that specific web application or endpoint.

During a recent assessment, I came across a web application, which made use of JWT tokens for its authentication process. After token expiry, a request should always be sent to the application to reauthorise access and get a new token.

When using SQLMap to test a web application against potential SQL injection vulnerabilities, this became an issue, as the application would re-authenticate and a new token was issued, which would then result in an error 401 message.

I came up with a solution to this problem when using SQLMap, by requesting a new token and then changing the authorisation header which would then result in this problem being bypassed.

Below is the example of how this was successfully achieved.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0DmZ6IWF-5ddLMvYB9SXupxziC97FL9OKrk6NgvRoIrijGlhiHVNlr9cK8x2WfHS2okMjjLbIL25b8OwgtnzHVLkXZNr_a3rbtaOIXAfwbpmD6T9_c2VtNXxazZiU2E4Cnj1ZzjGYCuc2/s640/1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0DmZ6IWF-5ddLMvYB9SXupxziC97FL9OKrk6NgvRoIrijGlhiHVNlr9cK8x2WfHS2okMjjLbIL25b8OwgtnzHVLkXZNr_a3rbtaOIXAfwbpmD6T9_c2VtNXxazZiU2E4Cnj1ZzjGYCuc2/s1600/1.png)

First the request for a new token was sent to the application:

As can be seen below, this request then responded back with JSON, containing  an “access\_token” which could then be used in the next request:
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidFfXBwVkMnIy6LT0yIEkMup0ZoDJBUY-m61TBEgYHOgRDB9zAQR1KWqlxs4J6_b2vPPovelYyKbYE4cZUHzaBpD9FNSVKBSmNLCPHZ4vwuHYpXZCydP8IVfJC2ofI3g0T63RZE2T0p0y5/s640/2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidFfXBwVkMnIy6LT0yIEkMup0ZoDJBUY-m61TBEgYHOgRDB9zAQR1KWqlxs4J6_b2vPPovelYyKbYE4cZUHzaBpD9FNSVKBSmNLCPHZ4vwuHYpXZCydP8IVfJC2ofI3g0T63RZE2T0p0y5/s1600/2.png)

For the next step, I then used Python to recreate the POST request in a script. In the screenshot below, you can see the code that was used for the POST request:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjF6IIh-FZ4pJCwTB4scDgnxIcqHJgM_T_BR5LIC5iLH9VXQwR6SKQskRXPvY3CYUlVR7U24F6tmCbCP_SGYYP9yF5Hlnni18WAkfzhSQCMZ6nh4DaR1ZfKw9-8tnGhxVThNatNxmsutwFy/s640/3.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjF6IIh-FZ4pJCwTB4scDgnxIcqHJgM_T_BR5LIC5iLH9VXQwR6SKQskRXPvY3CYUlVR7U24F6tmCbCP_SGYYP9yF5Hlnni18WAkfzhSQCMZ6nh4DaR1ZfKw9-8tnGhxVThNatNxmsutwFy/s1600/3.png)

In addition to the above code, the authorisation header should be rewritten with new information before every request that is sent by SQLMap, as can be seen below:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi_Wm2M6VVwhZV4C6vA8jRVV9GlNIjzuV66cAqgvLZo_bSmX95Flb3_HxBWF2oZGEIwtDJvyzbIP-JfFOLyx2iFyNUUkcH-bDAs_2kRlMqGsxzWmZMUzQiLMQmaFdCJRhIxiYR_t8NSklX_/s640/4.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi_Wm2M6VVwhZV4C6vA8jRVV9GlNIjzuV66cAqgvLZo_bSmX95Flb3_HxBWF2oZGEIwtDJvyzbIP-JfFOLyx2iFyNUUkcH-bDAs_2kRlMqGsxzWmZMUzQiLMQmaFdCJRhIxiYR_t8NSklX_/s1600/4.png)
The full tamper script should then look like the code in the screenshot below:
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhknDkNSM9flxODQSs-sEorX78KOeighilmN4QTXFIcjKi7rzB69FF6sDZj2ZEnYYopM5izvGbgaDcW90SHeGdi2uZ-0VLgDrTqNicS-N7l9gt9KS1T3rPdPiAsDCj9Ls6kS-aXdNMzfb8R/s640/5.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhknDkNSM9flxODQSs-sEorX78KOeighilmN4QTXFIcjKi7rzB69FF6sDZj2ZEnYYopM5izvGbgaDcW90SHeGdi2uZ-0VLgDrTqNicS-N7l9gt9KS1T3rPdPiAsDCj9Ls6kS-aXdNMzfb8R/s1600/5.png)
Lastly, in the screenshot below you can see  the command for executing the tamper script against a target using SQLMap(*sqlmap -u <https://url.com/> --tamper bypass.py*):
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgMU7UUji78h0oKlhyMmXVfgSRIRuapHsLmEFNLsP_wcJmIea0cqn49od1beC47E5HJj_wowQKVZIRqMtQ_F0Lcpm_GrSVPTrn78mEfaIq0wGbbEYt_tC9WNV3i3P0zzHcS9JnAp-L7XSah/s640/6.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgMU7UUji78h0oKlhyMmXVfgSRIRuapHsLmEFNLsP_wcJmIea0cqn49od1beC47E5HJj_wowQKVZIRqMtQ_F0Lcpm_GrSVPTrn78mEfaIq0wGbbEYt_tC9WNV3i3P0zzHcS9JnAp-L7XSah/s1600/6.png)

At this point, requests are sent correctly by refreshing the token and you will no longer receive a 401 error message.

I hope you have found this information to be of a value and that it will assist you in future penetration tests.

- Blog post by Motaz of Telspace Systems.

at

[Wednesday, May 20, 2020](https://blog.telspace.co.za/2020/05/bypassing-refresh-tokens-with-sqlmaps_20.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/7070204879869371076)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=7070204879869371076&from=pencil "Edit Post")

Labels:
[2020](https://blog.telspace.co.za/search/label/2020),
[JWT](https://blog.telspace.co.za/search/label/JWT),
[JWT Tokens](https://blog.telspace.co.za/search/label/JWT%20Tokens),
[python](https://blog.telspace.co.za/search/label/python),
[sql injection](https://blog.telspace.co.za/search/label/sql%20injection),
[SQLMap](https://blog.telspace.co.za/search/label/SQLMap),
[web application assessment](https://blog.telspace.co.za/search/label/web%20application%20assessment)

[Newer Posts](https://blog.telspace.co.za/search?updated-max=2021-04-01T16:21:00%2B02:00&max-results=3&reverse-paginate=true "Newer Posts")

[Older Posts](https://blog.telspace.co.za/search?updated-max=2020-05-20T11:02:00%2B02:00&max-results=3 "Older Posts")

[Home](https://blog.telspace.co.za/)

Subscribe to:
[Posts (Atom)](https://blog.telspace.co.za/feeds/posts/default)

[![](https://www.telspace.africa/img/tel27.jpg)](https://www.telspace.africa)

www.telspace.africa

| Blog Archive  * ►   [2023](https://blog.telspace.co.za/2023/)   (2)   + ►     [October](https://blog.telspace.co.za/2023/10/)     (1)   + ►     [August](https://blog.telspace.co.za/2023/08/)     (1)  * ►   [2022](https://blog.telspace.co.za/2022/)   (2)   + ►     [July](https://blog.telspace.co.za/2022/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2022/05/)     (1)  * ►   [2021](https://blog.telspace.co.za/2021/)   (2)   + ►     [July](https://blog.telspace.co.za/2021/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2021/04/)     (1)  * ▼   [2020](https://blog.telspace.co.za/2020/)   (8)   + ►     [December](https://blog.telspace.co.za/2020/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2020/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2020/06/)     (1)   + ▼     [May](https://blog.telspace.co.za/2020/05/)     (2)     - [{Certification Review} - OSWE - Staff Review](https://blog.telspace.co.za/2020/05/certification-review-oswe-staff-review.html)     - [Bypassing refresh tokens with SQLMap’s tamper scripts](https://blog.telspace.co.za/2020/05/bypassing-refresh-tokens-with-sqlmaps_20.html)   + ►     [March](https://blog.telspace.co.za/2020/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2020/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2020/01/)     (1)  * ►   [2019](https://blog.telspace.co.za/2019/)   (8)   + ►     [November](https://blog.telspace.co.za/2019/11/)     (1)   + ►     [September](https://blog.telspace.co.za/2019/09/)     (1)   + ►     [August](https://blog.telspace.co.za/2019/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2019/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2019/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2019/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2019/01/)     (1)  * ►   [2018](https://blog.telspace.co.za/2018/)   (3)   + ►     [March](https://blog.telspace.co.za/2018/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2018/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2018/01/)     (1)  * ►   [2017](https://blog.telspace.co.za/2017/)   (7)   + ►     [December](https://blog.telspace.co.za/2017/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2017/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2017/09/)     (4)   + ►     [February](https://blog.telspace.co.za/2017/02/)     (1)  * ►   [2016](https://blog.telspace.co.za/2016/)   (5)   + ►     [December](https://blog.telspace.co.za/2016/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2016/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2016/05/)     (3)  * ►   [2015](https://blog.telspace.co.za/2015/)   (7)   + ►     [December](https://blog.telspace.co.za/2015/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2015/10/)     (2)   + ►     [March](https://blog.telspace.co.za/2015/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2015/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2015/01/)     (1)  * ►   [2014](https://blog.telspace.co.za/2014/)   (14)   + ►     [October](https://blog.telspace.co.za/2014/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2014/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2014/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2014/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2014/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2014/04/)     (2)   + ►     [February](https://blog.telspace.co.za/2014/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2014/01/)     (2)  * ►   [2013](https://blog.telspace.co.za/2013/)   (15)   + ►     [December](https://blog.telspace.co.za/2013/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2013/11/)     (1)   + ►     [October](https://blog.telspace.co.za/2013/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2013/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2013/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2013/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2013/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2013/05/)     (4)   + ►     [April](https://blog.telspace.co.za/2013/04/)     (1)   + ►     [March](https://blog.telspace.co.za/2013/03/)     (1)  * ►   [2012](https://blog.telspace.co.za/2012/)   (5)   + ►     [October](https://blog.telspace.co.za/2012/10/)     (1)   + ►     [July](https://blog.telspace.co.za/2012/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2012/04/)     (1)   + ►     [January](https://blog.telspace.co.za/2012/01/)     (2)  * ►   [2011](https://blog.telspace.co.za/2011/)   (11)   + ►     [November](https://blog.telspace.co.za/2011/11/)     (2)   + ►     [August](https://blog.telspace.co.za/2011/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2011/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2011/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2011/04/)     (2)   + ►     [March](https://blog.telspace.co.za/2011/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2011/01/)     (2)  * ►   [2010](https://blog.telspace.co.za/2010/)   (15)   + ►     [December](https://blog.telspace.co.za/2010/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2010/11/)     (2)   + ►     [September](https://blog.telspace.co.za/2010/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2010/08/)     (1)   + ►     [July](https://blog.telspace.co.za/2010/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2010/05/)     (3)   + ►     [March](https://blog.telspace.co.za/2010/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2010/02/)     (3)  * ►   [2009](https://blog.telspace.co.za/2009/)   (10)   + ►     [September](https://blog.telspace.co.za/2009/09/)     (2)   + ►     [July](https://blog.telspace.co.za/2009/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2009/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2009/05/)     (1)   + ►     [February](https://blog.telspace.co.za/2009/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2009/01/)     (3)  * ►   [2008](https://blog.telspace.co.za/2008/)   (26)   + ►     [December](https://blog.telspace.co.za/2008/12/)     (4)   + ►     [November](https://blog.telspace.co.za/2008/11/)     (2)   + ►     [October](https://blog.telspace.co.za/2008/10/)     (4)   + ►     [September](https://blog.telspace.co.za/2008/09/)     (6)   + ►     [August](https://blog.telspace.co.za/2008/08/)     (3)   + ►     [July](https://blog.telspace.co.za/2008/07/)     (2)   + ►     [June](https://blog.telspace.co.za/2008/06/)     (3)   + ►     [May](https://blog.telspace.co.za/2008/05/)     (2) | Subscribe now!   Posts   [Atom](https://blog.telspace.co.za/feeds/posts/default)     Posts       All Comments   [Atom](https://blog.telspace.co.za/feeds/comments/default)     All Comments |
| --- | --- |

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).



=== Content from github.com_8a24a5ed_20250119_140257.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-wjqw-p6cv-p8gj)

**CVE-2020-14971**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-wjqw-p6cv-p8gj)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2020-14971](/advisories/GHSA-wjqw-p6cv-p8gj)

## Pi-hole through 5.0 allows code injection in piholedhcp ...

Moderate severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
•
Updated Jan 29, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-wjqw-p6cv-p8gj/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

Pi-hole through 5.0 allows code injection in piholedhcp (the Static DHCP Leases section) by modifying Teleporter backup files and then restoring them. This occurs in settings.php. To exploit this, an attacker would request a backup of limited files via teleporter.php. These are placed into a .tar.gz archive. The attacker then modifies the host parameter in dnsmasq.d files, and then compresses and uploads these files again.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-14971>
* [pi-hole/web#1443](https://github.com/pi-hole/web/pull/1443)
* [pi-hole/web@8f6e136](https://github.com/pi-hole/web/commit/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5)
* [pi-hole/web@c949516](https://github.com/pi-hole/web/commit/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69)
* <https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-14971)
Jun 23, 2020

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Jan 29, 2023

### Severity

Moderate

### [EPSS score](https://www.first.org/epss/user-guide)

0.043%
 (11th percentile)

### Weaknesses

[CWE-94](/advisories?query=cwe%3A94)

### CVE ID

CVE-2020-14971

### GHSA ID

GHSA-wjqw-p6cv-p8gj

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-wjqw-p6cv-p8gj/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.telspace.co.za_23b04109_20250119_140251.html ===


# [Telspace Africa, The Blog](https://blog.telspace.co.za/)

Hackers for hire

## Tuesday, June 23, 2020

### [Pi-hole Code Injection – CVE-2020-14971– Story Time](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html)

A while ago, we had an internal discussion around people working from home and the technologies/products that could be implemented and/or bought to protect home users. This was due to the implementation of the nationwide lockdown which resulted in companies being forced to change their approach entirely to having employees work from home.

During this discussion the Pi-hole was mentioned. Pi-hole is a very popular option for the more “tech savvy” home user and generally, anyone that’s tired of being spammed with random adverts on every website. You can find more information about it here <https://github.com/pi-hole/pi-hole/>.

Since I had a Pi-hole installed already, I decided to take a look at this beautiful piece of ad blocking software in more detail, specifically reviewing the code and logic of the application. Because it’s Opensource and available freely, this was easily accomplished by downloading and installing the latest Pi-hole (v5.0 at the time).

It’s worth mentioning that a lot of vulnerabilities had already been found in this software, some overlapped with findings that I had found particularly during April and May, which were rightfully allocated to the first people that reported the issues. With that being said, the Pi-hole is a popular target for researchers and adds a lot of value to people’s home and small office environments, so the more findings and fixes the better. I also wanted to focus on the latest version because of this.

Initially, I had found a few critical security vulnerabilities but many had been found and fixed already and others eventually required local shell access in some form, some functionality had been changed over time, which solved those particular RCE issues too. So, I therefore looked at a few other vectors and decided to focus on one specific attack vector, which looked promising.

## **Backup Functions:**

Settings.php has lots of functionality, one of which allows users to back up and restore (export and import) configurations of the Pi-hole with a limited set of files (teleporter tab).

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s640/Screen+Shot+2020-06-18+at+4.31.19+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.31.19%2BPM.png)

This was interesting for me because when you export files, they are compressed in tar.gz format and saved. Upon decompression and by systematically reviewing each file that was saved, I found that there were several files which were useful and easy wins for RCE, in particular if no whitelisting and sanitising was taking place. However, those particular ones are not restored if you modify them, re-compress and upload to restore the backup.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s640/Screen+Shot+2020-06-18+at+4.35.31+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.35.31%2BPM.png)

In this instance though, the affected files I found are dnsmasq.d configuration files and the adlist.json file. The dnsmasq.d/04-pi-hole-static-dhcp.conf file allows static DHCP leases, which link to MAC, IP and host.

I modified the configuration file for dnsmasq.d initially, in which I added my own code for the host parameter. Once I did this, I recompressed the file accordingly and imported the file back in via teleporter:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s640/Screen+Shot+2020-06-18+at+4.38.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.38.14%2BPM.png)

Upon browsing to the static DHCP leases section of the Pi-hole web interface, I could see my code was executing correctly i.e. I had found a Code Injection vulnerability.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s640/Screen+Shot+2020-06-18+at+4.39.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.39.14%2BPM.png)

The same then applied to adlists.json and other parameters in other files, as all the files were not being properly checked upon upload, they also just overwrote whatever was previously there and therefore your code executed accordingly:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s640/Screen+Shot+2020-06-22+at+10.13.18+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s1600/Screen%2BShot%2B2020-06-22%2Bat%2B10.13.18%2BPM.png)

Browse to host/admin/groups-adlists.php and you should get the ‘Adam popup’:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s640/Screen+Shot+2020-06-18+at+4.45.47+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.45.47%2BPM.png)

There are more examples, however it’s more of the same as what has been discussed above. I would also like to mention, that the Pi-hole is an amazing piece of software, built by people who really care for the community, please support them and donate. All the responses (especially from Adam) were really quick and things were patched exceptionally quickly.

You can browse all the fixes, comments and progress of patching by going here:

<https://github.com/pi-hole/AdminLTE/commit/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-640920508>

<https://github.com/pi-hole/AdminLTE/commit/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-643830404>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14971>

at

[Tuesday, June 23, 2020](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/4313565159762696677)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=4313565159762696677&from=pencil "Edit Post")

Labels:
[0day](https://blog.telspace.co.za/search/label/0day),
[2020](https://blog.telspace.co.za/search/label/2020),
[code injection](https://blog.telspace.co.za/search/label/code%20injection),
[CVE-2020-14971](https://blog.telspace.co.za/search/label/CVE-2020-14971),
[pentesting](https://blog.telspace.co.za/search/label/pentesting),
[pihole](https://blog.telspace.co.za/search/label/pihole)

[Newer Posts](https://blog.telspace.co.za/search?updated-max=2021-07-15T13:55:00%2B02:00&max-results=3&reverse-paginate=true "Newer Posts")

[Older Posts](https://blog.telspace.co.za/search?updated-max=2020-06-23T11:01:00%2B02:00&max-results=3 "Older Posts")

[Home](https://blog.telspace.co.za/)

Subscribe to:
[Posts (Atom)](https://blog.telspace.co.za/feeds/posts/default)

[![](https://www.telspace.africa/img/tel27.jpg)](https://www.telspace.africa)

www.telspace.africa

| Blog Archive  * ►   [2023](https://blog.telspace.co.za/2023/)   (2)   + ►     [October](https://blog.telspace.co.za/2023/10/)     (1)   + ►     [August](https://blog.telspace.co.za/2023/08/)     (1)  * ►   [2022](https://blog.telspace.co.za/2022/)   (2)   + ►     [July](https://blog.telspace.co.za/2022/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2022/05/)     (1)  * ►   [2021](https://blog.telspace.co.za/2021/)   (2)   + ►     [July](https://blog.telspace.co.za/2021/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2021/04/)     (1)  * ▼   [2020](https://blog.telspace.co.za/2020/)   (8)   + ►     [December](https://blog.telspace.co.za/2020/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2020/07/)     (1)   + ▼     [June](https://blog.telspace.co.za/2020/06/)     (1)     - [Pi-hole Code Injection – CVE-2020-14971– Story Time](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html)   + ►     [May](https://blog.telspace.co.za/2020/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2020/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2020/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2020/01/)     (1)  * ►   [2019](https://blog.telspace.co.za/2019/)   (8)   + ►     [November](https://blog.telspace.co.za/2019/11/)     (1)   + ►     [September](https://blog.telspace.co.za/2019/09/)     (1)   + ►     [August](https://blog.telspace.co.za/2019/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2019/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2019/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2019/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2019/01/)     (1)  * ►   [2018](https://blog.telspace.co.za/2018/)   (3)   + ►     [March](https://blog.telspace.co.za/2018/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2018/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2018/01/)     (1)  * ►   [2017](https://blog.telspace.co.za/2017/)   (7)   + ►     [December](https://blog.telspace.co.za/2017/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2017/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2017/09/)     (4)   + ►     [February](https://blog.telspace.co.za/2017/02/)     (1)  * ►   [2016](https://blog.telspace.co.za/2016/)   (5)   + ►     [December](https://blog.telspace.co.za/2016/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2016/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2016/05/)     (3)  * ►   [2015](https://blog.telspace.co.za/2015/)   (7)   + ►     [December](https://blog.telspace.co.za/2015/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2015/10/)     (2)   + ►     [March](https://blog.telspace.co.za/2015/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2015/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2015/01/)     (1)  * ►   [2014](https://blog.telspace.co.za/2014/)   (14)   + ►     [October](https://blog.telspace.co.za/2014/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2014/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2014/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2014/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2014/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2014/04/)     (2)   + ►     [February](https://blog.telspace.co.za/2014/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2014/01/)     (2)  * ►   [2013](https://blog.telspace.co.za/2013/)   (15)   + ►     [December](https://blog.telspace.co.za/2013/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2013/11/)     (1)   + ►     [October](https://blog.telspace.co.za/2013/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2013/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2013/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2013/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2013/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2013/05/)     (4)   + ►     [April](https://blog.telspace.co.za/2013/04/)     (1)   + ►     [March](https://blog.telspace.co.za/2013/03/)     (1)  * ►   [2012](https://blog.telspace.co.za/2012/)   (5)   + ►     [October](https://blog.telspace.co.za/2012/10/)     (1)   + ►     [July](https://blog.telspace.co.za/2012/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2012/04/)     (1)   + ►     [January](https://blog.telspace.co.za/2012/01/)     (2)  * ►   [2011](https://blog.telspace.co.za/2011/)   (11)   + ►     [November](https://blog.telspace.co.za/2011/11/)     (2)   + ►     [August](https://blog.telspace.co.za/2011/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2011/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2011/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2011/04/)     (2)   + ►     [March](https://blog.telspace.co.za/2011/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2011/01/)     (2)  * ►   [2010](https://blog.telspace.co.za/2010/)   (15)   + ►     [December](https://blog.telspace.co.za/2010/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2010/11/)     (2)   + ►     [September](https://blog.telspace.co.za/2010/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2010/08/)     (1)   + ►     [July](https://blog.telspace.co.za/2010/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2010/05/)     (3)   + ►     [March](https://blog.telspace.co.za/2010/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2010/02/)     (3)  * ►   [2009](https://blog.telspace.co.za/2009/)   (10)   + ►     [September](https://blog.telspace.co.za/2009/09/)     (2)   + ►     [July](https://blog.telspace.co.za/2009/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2009/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2009/05/)     (1)   + ►     [February](https://blog.telspace.co.za/2009/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2009/01/)     (3)  * ►   [2008](https://blog.telspace.co.za/2008/)   (26)   + ►     [December](https://blog.telspace.co.za/2008/12/)     (4)   + ►     [November](https://blog.telspace.co.za/2008/11/)     (2)   + ►     [October](https://blog.telspace.co.za/2008/10/)     (4)   + ►     [September](https://blog.telspace.co.za/2008/09/)     (6)   + ►     [August](https://blog.telspace.co.za/2008/08/)     (3)   + ►     [July](https://blog.telspace.co.za/2008/07/)     (2)   + ►     [June](https://blog.telspace.co.za/2008/06/)     (3)   + ►     [May](https://blog.telspace.co.za/2008/05/)     (2) | Subscribe now!   Posts   [Atom](https://blog.telspace.co.za/feeds/posts/default)     Posts       All Comments   [Atom](https://blog.telspace.co.za/feeds/comments/default)     All Comments |
| --- | --- |

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).



=== Content from resources.blogblog.com_5fcf17bb_20250119_140244.html ===
GIF89a  �  �ǻ�j4TSP�%    Џ)I5���S(3&��1��#�ǻ!�   ,       O��I���`���(�1�� �
"N�(!�3���wH@1� �憐 ��ra
 R�� ��/��yL `M�J ;

=== Content from blog.telspace.co.za_ff2b0a54_20250119_140246.html ===


# Telspace Africa, The Blog

Hackers for hire

## Friday, October 27, 2023

**Transformative****Journey:****My****Experience****at****the****Telspace****Bootcamp**

My journey through the world of cybersecurity
has been a series of remarkable milestones, all of which led me to the life
changing Telspace Bootcamp experience. It all began with a triumphant win at
the ITWeb Security Summit Hackathon. This victory
not only marked my entry into the Telspace Bootcamp
but also set the stage
for my journey of growth and achievement. In this blog post, I will
delve into my enriching experience at the Telspace Bootcamp, from its
commencement on July 3rd, 2023, to its conclusion on August 31st, 2023, and the
certifications that crowned my journey.

**From Hackathon to Bootcamp: A Dream Come True**

Back in June 2023, I had the opportunity of a
lifetime – participating in the ITWeb Security Summit Hackathon which Telspace
sponsors every year. The event took place at the prestigious Sandton
Convention Centre, where cybersecurity enthusiasts and experts
gathered to showcase
their skills. I was determined to prove myself
in the Red Teaming Capture
the Flag (CTF) competition that was built by
the Telspace Team. I was so thrilled
to have emerged as the winner of the ITWeb
Security Summit Hackathon 2023. It
was an incredible journey, and I was grateful for the opportunity to showcase
my skills in identifying vulnerabilities and proposing innovative solutions.

Upon winning the hackathon
I received an invitation to the Telspace
Bootcamp - this was a dream come true. This
bootcamp was renowned for its rigorous and comprehensive training
program. It promised
to not only equip me with the necessary skills but also
immerse me in the practicalities of the cybersecurity world.

**A Dynamic
Learning Environment**

From day one, the Telspace Bootcamp proved to be
a dynamic and immersive learning environment. The curriculum covered
an extensive range
of cybersecurity topics,
from the fundamentals to advanced techniques. The instructors were not just educators; they were experienced
professionals who shared their real-world insights and experiences. This made
the learning experience both enriching and practical.

**The Bootcamp
programme included, but was not limited to:**

* Hardware hacking
* Hands on Hacking Fundamentals
* Enterprise Infrastructure Hacking
* Web Application Hacking
* Mobile Application Pen testing
* Hacking APIs
* Academy All-Access Membership from TCM Security

**Hands-on Practical****Exercises**

One of the hallmarks of the Telspace
Bootcamp was its emphasis on hands-on practical exercises. We were not just learning theoretical concepts; we
were applying them in simulated environments. These exercises ranged from
ethical hacking and penetration testing
challenges, to network
security simulations. They were designed to prepare
us for the real challenges faced by cybersecurity professionals.
At Telspace, one of the most valuable lessons I learned was the stark contrast to many other courses/internships/bootcamps that often inundate students with tools and concepts that rarely find practical application in the real-world scenarios; instead, Telspace was a refreshing departure from the norm, steadfastly focusing on those tools and topics proven to be indispensable for success as an ethical hacker, a deliberate approach that reflected the bootcamps' commitment to providing an education deeply rooted in practicality and real-world relevance, with an incredibly immersive, hands-on structure that not only demystified but also meticulously covered a multitude of foundational topics, effectively equipping me with the knowledge and skills that I knew would truly empower me in the field.

**Mentorship****and****Guidance**

Throughout the duration of the bootcamp, the invaluable mentorship we
received played an instrumental role in shaping our development and enhancing our learning experience, as our dedicated mentors consistently organised and conducted live sessions,
thereby affording us the exceptional opportunity to acquire knowledge and seek clarification through the asking of questions, with notable examples
including live demonstrations illustrating the
intricate processes of hacking a mobile application and the jailbreaking of an
iPhone; this highly personalised approach employed by our mentors proved to be
a pivotal factor in my educational journey, enabling me to surmount obstacles and gain a profound understanding of complex concepts.**Earning the PJPT Certification with "Early Adopter" Badge**

One of the most significant milestones during my tenure at the Telspace Bootcamp
was achieving the PJPT (Practical Junior Penetration Tester) certification. This achievement, earned on July 27th, 2023, not only validated
my learnings in penetration testing
and ethical hacking but also came with the
prestigious "early adopter"
badge. This badge symbolised my dedication and commitment to staying at the forefront of cybersecurity knowledge. As I am part of the
first 100 to obtain this certificate.**From the TCM Security website:**
"This exam assesses
a student’s ability
to perform an internal network
penetration test at an associate level. Students will have two (2) full days to complete the
assessment and an additional two (2) days to write a professional report.

**In order to receive the certification, a student must:**
Leverage their Active Directory exploitation skillsets to perform
lateral and vertical
network movements, and ultimately compromise the exam Domain Controller. Also, provide a detailed, professionally written report."

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgHrxzuPjW9dQDBREi_HLY-rX2TAG4TQO1P51ymsCHtLkMmRIgYkcGn5xJzmz4WvKipS_MZDpgXVVdCapxPKSyB0n5FA9UDUvIE6FaNjIpaZ3F8v7LHPv01oo9r6Q7WFRQ23dq0qB1QNEVQHlv4agVX8x8gxca_v1bK_PKA9q6RJi8JngFh59iPADqhnXpP/s320/PJPT.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgHrxzuPjW9dQDBREi_HLY-rX2TAG4TQO1P51ymsCHtLkMmRIgYkcGn5xJzmz4WvKipS_MZDpgXVVdCapxPKSyB0n5FA9UDUvIE6FaNjIpaZ3F8v7LHPv01oo9r6Q7WFRQ23dq0qB1QNEVQHlv4agVX8x8gxca_v1bK_PKA9q6RJi8JngFh59iPADqhnXpP/s653/PJPT.jpg)**Conquering the PNPT Certification**
As my journey continued, I reached another
pinnacle on August
26th, 2023, by attaining the PNPT (Practical Network Penetration Tester)
certification. This certification further solidified my learnings in network security
and bolstered my credentials
on my journey to becoming a cybersecurity professional.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgbk9CTQBMa1h0hCReQfN_611BBlv8lR4Dx3_mkfKc5Ku1NLyavBJY_YHo39dCJQBLXRnI4DG4NxZx27Kz15JDMxMfZY4D522tMMaTSNzFKD_e-f8BvEVwxYElcr912Pjz3d5hkUco2Vo9zbY7w7xNoiEw0VSBMQKOViNeiPq-FZL_1rS34oIrBOIRWOx4V/s320/PNPT.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgbk9CTQBMa1h0hCReQfN_611BBlv8lR4Dx3_mkfKc5Ku1NLyavBJY_YHo39dCJQBLXRnI4DG4NxZx27Kz15JDMxMfZY4D522tMMaTSNzFKD_e-f8BvEVwxYElcr912Pjz3d5hkUco2Vo9zbY7w7xNoiEw0VSBMQKOViNeiPq-FZL_1rS34oIrBOIRWOx4V/s649/PNPT.jpg)
**PNPT Advice**Due to NDA, I am unable to discuss specifics regarding the test, however I can offer the following guidance to anyone preparing to take the PNPT exam:

**Finish these 5
recommended courses:**

* Practical Ethical Hacking (PEH) course
* Windows Privilege Escalation (WPE) course
* Open-Source Intelligence (OSINT) course
* External Pentest Playbook (EPP) course
* Linux Privilege Escalation (LPE) course

# **Conclusion: A Journey of Transformation**

My experience at the Telspace
Bootcamp was not just a training program;
it was a journey of transformation. It honed my skills, expanded my knowledge,
and prepared me for the challenges of the cybersecurity field. I am immensely grateful
for the mentorship, hands-on experience, and the certifications that have propelled me forward. This journey
is just the beginning, and I look forward to the exciting
opportunities and challenges that lie ahead in the
ever-evolving world of cybersecurity.
- Blog Post by Sifundo Ngubane

at

[Friday, October 27, 2023](https://blog.telspace.co.za/2023/10/transformative-journey-my-experience-at.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/1244238588128770368)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=1244238588128770368&from=pencil "Edit Post")

## Wednesday, August 2, 2023

### [Boot Camp: 2023](https://blog.telspace.co.za/2023/08/boot-camp-2023.html)

We kicked off our 2023 Boot Camp programme with a fresh intake of interns in July 2023. After approximately 50 grueling interviews, 6 candidates were selected and invited to attend the Boot Camp. Congratulations to all that made it!

They are already knee-deep in the Boot Camp, having already completed several modules of the boot camp within their first month!

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjzx8XvllzzDPQqn7_-vWGJ6AZR3vfPuZHbCUWpM4U4M0ZzKoEnbtxB4KC-euVygRKCOEnHPONNQv-Upp01yJAKGs2cjkxTURGS8ISAxQEJ0uCzTyoy6O6JygEhv6SN2ZsEXgYiYi5T4--R-qN29Ex-WzkvFkQZBM0wGyHGIbhtXYA9bz3deNAOX7C6A2ag/w493-h370/IMG_3136.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjzx8XvllzzDPQqn7_-vWGJ6AZR3vfPuZHbCUWpM4U4M0ZzKoEnbtxB4KC-euVygRKCOEnHPONNQv-Upp01yJAKGs2cjkxTURGS8ISAxQEJ0uCzTyoy6O6JygEhv6SN2ZsEXgYiYi5T4--R-qN29Ex-WzkvFkQZBM0wGyHGIbhtXYA9bz3deNAOX7C6A2ag/s4032/IMG_3136.jpg)

We asked them for some feedback on their experience so far:

*"The Telspace internship offers a dynamic and healthy work environment . It involves research, problem-solving, and exposure to top security experts, providing an incredible learning experience and motivation to be part of the team" - Sifundo*

*"My experience in the bootcamp thus far has been challenging but very insightful. I've learned a lot in a very short time thanks to a welcoming, understanding and highly knowledgeable team." - Nathan*

*"I am in the hacker's realm. What more can I ask for? The learning experience has been great. The organisational culture is fantastic, and I plan to make the most of this golden opportunity." - Jacky*

*"The bootcamp has been challenging, but I am learning a lot about penetration testing." - Muhammad*

*"Through steep learning curves, we thrived; together yet independent. Laughter fortified us, and as one, we safeguard both each other and a better tomorrow" - Shane*

For those interested in entering the industry, we regularly host boot camps. If you would like to participate in our next boot camp, please get in touch with us at recruitment@telspace.africa

In order to prepare yourself, the interview process covers some of the following topics: Networking, Linux, Windows, Cryptography, general information security knowledge, as well as Software Development and Exploitation. We are certain that our Boot Camp surpasses the industry “standard” thanks to the following:

* Our interns don’t have any monetary restraint attached to them, as they are paid a monthly salary whilst undertaking the training with us. Additionally, there are no restraints where the interns will have to pay back money if they do not end up working for Telspace at the end of the Boot Camp. Having an approach other than this would not benefit our newcomers to the industry, nor the community at large.
* If interns are uncertain that they are a good fit for the industry or at Telspace Africa during the boot camp, then they are free to leave at any time, taking what they have learnt with them, including any certifications (and we are more than happy with that!).
* Should our interns pass the strict criteria at the end of the boot camp, via different assessment gateways, then they will be offered a 4-month contract as a junior analyst with Telspace Africa (which they are not obliged to accept). If they do accept the offer, then further certifications and training will be provided by Telspace.
* This boot camp is about growing the information security community, and thereafter, our company; in order to provide our customers with the best possible service.

**Telspace wishes each new intern the very best of luck; we are eager to see the wonderful knowledge you will gain, as well as the many shells you will be popping!**

at

[Wednesday, August 02, 2023](https://blog.telspace.co.za/2023/08/boot-camp-2023.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/7368768631004407593)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=7368768631004407593&from=pencil "Edit Post")

## Thursday, July 7, 2022

### [Boot Camp: 2022](https://blog.telspace.co.za/2022/07/boot-camp-2022.html)

We kicked off our 2022 Boot Camp programme with a fresh intake of interns in May 2022. After approximately 60
gruelling interviews, 3 candidates were selected and invited to attend the Boot
Camp. Congratulations to all that made it!

They are already knee-deep in the Boot
Camp, having completed several modules of the boot camp already!

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgP5O3oQzZ4G05-9_JsMla5S1l7fWLvR7v4K5ZwoW09a8oYCnwdfAF8zbEQilcbLYSHSG4u3NsQy2upM1BFjHpivw-AvmqL-HrLlG2rnstzMcIoaJs4XiDykwNzlKaW4HW72NQjeVctkNi6dLKtPuvG4zSWxAVCpejh1AJbKWK6CkgY5-c-kzdpOyuwZQ/w422-h316/Photo.jpg)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgP5O3oQzZ4G05-9_JsMla5S1l7fWLvR7v4K5ZwoW09a8oYCnwdfAF8zbEQilcbLYSHSG4u3NsQy2upM1BFjHpivw-AvmqL-HrLlG2rnstzMcIoaJs4XiDykwNzlKaW4HW72NQjeVctkNi6dLKtPuvG4zSWxAVCpejh1AJbKWK6CkgY5-c-kzdpOyuwZQ/s1380/Photo.jpg)

We asked them for some feedback on
their experience so far:

*“The Telspace internship for me
is fast paced, healthy work environment as an intern and needs you to always be
on your toes. Whether you make mistakes or get it right first try, you keep pushing
further” – Obakeng*

*“It involves tons of research
and problem-solving. One moment, I am on top of the world as I would pwn the
machines and the next, I am back to my sorrows. I still love it though” –
Tswaitswai*

*“It has been an unbelievable
experience so far. I have not only had the opportunity to expand my knowledge
so vastly in such a short time but I have been afforded the opportunity to get
to know and see first-hand what some of the country’s top security experts can
do, which only adds to the excitement and motivation to become a part of this
great team” - Jason*

For those interested in entering
the industry, we will be hosting another boot camp later this year. If you
would like to participate, please get in touch with us at recruitment@telspace.africa

In order to prepare yourself, the
interview process covers some of the following topics: Networking, Linux,
Windows, Cryptography, general information security knowledge, as well as
Software Development and Exploitation. We are certain that our Boot Camp
surpasses the industry “standard” thanks to the following:

* Our interns don’t have any monetary restraint
  attached to them, as they are paid a monthly salary whilst undertaking the
  training with us. Additionally, there are no restraints where the interns will
  have to pay back money if they do not end up working for Telspace at the end of
  the Boot Camp. Having an approach other than this would not benefit our
  newcomers to the industry, nor the community at large.
* If interns are uncertain that they are a good
  fit for the industry or at Telspace Africa during the boot camp, then they are
  free to leave at any time, taking what they have learnt with them, including
  any certifications (and we are more than happy with that!).
* Should our interns pass the strict criteria at
  the end of the boot camp, via different assessment gateways, then they will be
  offered a 4-month contract as a junior analyst with Telspace Africa (which they
  are not obliged to accept). If they do accept the offer, then further
  certifications and training will be provided by Telspace.
* This boot camp is about growing the information
  security community, and thereafter, our company; in order to provide our
  customers with the best possible service.

**Telspace wishes each new intern the very best of
luck; we are eager to see the wonderful knowledge you will gain, as well as the
many shells you will be popping!**

at

[Thursday, July 07, 2022](https://blog.telspace.co.za/2022/07/boot-camp-2022.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/8279834947796270884)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=8279834947796270884&from=pencil "Edit Post")

Labels:
[2022](https://blog.telspace.co.za/search/label/2022),
[bootcamp](https://blog.telspace.co.za/search/label/bootcamp),
[information sharing](https://blog.telspace.co.za/search/label/information%20sharing),
[infosec training](https://blog.telspace.co.za/search/label/infosec%20training),
[intern](https://blog.telspace.co.za/search/label/intern),
[internship](https://blog.telspace.co.za/search/label/internship),
[Training](https://blog.telspace.co.za/search/label/Training)

[Older Posts](https://blog.telspace.co.za/search?updated-max=2022-07-07T09:33:00%2B02:00&max-results=3 "Older Posts")

[Home](https://blog.telspace.co.za/)

Subscribe to:
[Posts (Atom)](https://blog.telspace.co.za/feeds/posts/default)

[![](https://www.telspace.africa/img/tel27.jpg)](https://www.telspace.africa)

www.telspace.africa

| Blog Archive  * ▼   [2023](https://blog.telspace.co.za/2023/)   (2)   + ▼     [October](https://blog.telspace.co.za/2023/10/)     (1)     - [Transformative Journey: My Experience at the Telsp...](https://blog.telspace.co.za/2023/10/transformative-journey-my-experience-at.html)   + ►     [August](https://blog.telspace.co.za/2023/08/)     (1)  * ►   [2022](https://blog.telspace.co.za/2022/)   (2)   + ►     [July](https://blog.telspace.co.za/2022/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2022/05/)     (1)  * ►   [2021](https://blog.telspace.co.za/2021/)   (2)   + ►     [July](https://blog.telspace.co.za/2021/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2021/04/)     (1)  * ►   [2020](https://blog.telspace.co.za/2020/)   (8)   + ►     [December](https://blog.telspace.co.za/2020/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2020/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2020/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2020/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2020/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2020/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2020/01/)     (1)  * ►   [2019](https://blog.telspace.co.za/2019/)   (8)   + ►     [November](https://blog.telspace.co.za/2019/11/)     (1)   + ►     [September](https://blog.telspace.co.za/2019/09/)     (1)   + ►     [August](https://blog.telspace.co.za/2019/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2019/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2019/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2019/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2019/01/)     (1)  * ►   [2018](https://blog.telspace.co.za/2018/)   (3)   + ►     [March](https://blog.telspace.co.za/2018/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2018/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2018/01/)     (1)  * ►   [2017](https://blog.telspace.co.za/2017/)   (7)   + ►     [December](https://blog.telspace.co.za/2017/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2017/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2017/09/)     (4)   + ►     [February](https://blog.telspace.co.za/2017/02/)     (1)  * ►   [2016](https://blog.telspace.co.za/2016/)   (5)   + ►     [December](https://blog.telspace.co.za/2016/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2016/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2016/05/)     (3)  * ►   [2015](https://blog.telspace.co.za/2015/)   (7)   + ►     [December](https://blog.telspace.co.za/2015/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2015/10/)     (2)   + ►     [March](https://blog.telspace.co.za/2015/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2015/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2015/01/)     (1)  * ►   [2014](https://blog.telspace.co.za/2014/)   (14)   + ►     [October](https://blog.telspace.co.za/2014/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2014/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2014/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2014/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2014/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2014/04/)     (2)   + ►     [February](https://blog.telspace.co.za/2014/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2014/01/)     (2)  * ►   [2013](https://blog.telspace.co.za/2013/)   (15)   + ►     [December](https://blog.telspace.co.za/2013/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2013/11/)     (1)   + ►     [October](https://blog.telspace.co.za/2013/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2013/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2013/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2013/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2013/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2013/05/)     (4)   + ►     [April](https://blog.telspace.co.za/2013/04/)     (1)   + ►     [March](https://blog.telspace.co.za/2013/03/)     (1)  * ►   [2012](https://blog.telspace.co.za/2012/)   (5)   + ►     [October](https://blog.telspace.co.za/2012/10/)     (1)   + ►     [July](https://blog.telspace.co.za/2012/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2012/04/)     (1)   + ►     [January](https://blog.telspace.co.za/2012/01/)     (2)  * ►   [2011](https://blog.telspace.co.za/2011/)   (11)   + ►     [November](https://blog.telspace.co.za/2011/11/)     (2)   + ►     [August](https://blog.telspace.co.za/2011/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2011/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2011/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2011/04/)     (2)   + ►     [March](https://blog.telspace.co.za/2011/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2011/01/)     (2)  * ►   [2010](https://blog.telspace.co.za/2010/)   (15)   + ►     [December](https://blog.telspace.co.za/2010/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2010/11/)     (2)   + ►     [September](https://blog.telspace.co.za/2010/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2010/08/)     (1)   + ►     [July](https://blog.telspace.co.za/2010/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2010/05/)     (3)   + ►     [March](https://blog.telspace.co.za/2010/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2010/02/)     (3)  * ►   [2009](https://blog.telspace.co.za/2009/)   (10)   + ►     [September](https://blog.telspace.co.za/2009/09/)     (2)   + ►     [July](https://blog.telspace.co.za/2009/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2009/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2009/05/)     (1)   + ►     [February](https://blog.telspace.co.za/2009/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2009/01/)     (3)  * ►   [2008](https://blog.telspace.co.za/2008/)   (26)   + ►     [December](https://blog.telspace.co.za/2008/12/)     (4)   + ►     [November](https://blog.telspace.co.za/2008/11/)     (2)   + ►     [October](https://blog.telspace.co.za/2008/10/)     (4)   + ►     [September](https://blog.telspace.co.za/2008/09/)     (6)   + ►     [August](https://blog.telspace.co.za/2008/08/)     (3)   + ►     [July](https://blog.telspace.co.za/2008/07/)     (2)   + ►     [June](https://blog.telspace.co.za/2008/06/)     (3)   + ►     [May](https://blog.telspace.co.za/2008/05/)     (2) | Subscribe now!   Posts   [Atom](https://blog.telspace.co.za/feeds/posts/default)     Posts       All Comments   [Atom](https://blog.telspace.co.za/feeds/comments/default)     All Comments |
| --- | --- |

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).



=== Content from blog.telspace.co.za_0de094d3_20250119_140252.html ===


# [Telspace Africa, The Blog](https://blog.telspace.co.za/)

Hackers for hire

Showing posts with label **pihole**. [Show all posts](https://blog.telspace.co.za/)

Showing posts with label **pihole**. [Show all posts](https://blog.telspace.co.za/)

## Tuesday, June 23, 2020

### [Pi-hole Code Injection – CVE-2020-14971– Story Time](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html)

A while ago, we had an internal discussion around people working from home and the technologies/products that could be implemented and/or bought to protect home users. This was due to the implementation of the nationwide lockdown which resulted in companies being forced to change their approach entirely to having employees work from home.

During this discussion the Pi-hole was mentioned. Pi-hole is a very popular option for the more “tech savvy” home user and generally, anyone that’s tired of being spammed with random adverts on every website. You can find more information about it here <https://github.com/pi-hole/pi-hole/>.

Since I had a Pi-hole installed already, I decided to take a look at this beautiful piece of ad blocking software in more detail, specifically reviewing the code and logic of the application. Because it’s Opensource and available freely, this was easily accomplished by downloading and installing the latest Pi-hole (v5.0 at the time).

It’s worth mentioning that a lot of vulnerabilities had already been found in this software, some overlapped with findings that I had found particularly during April and May, which were rightfully allocated to the first people that reported the issues. With that being said, the Pi-hole is a popular target for researchers and adds a lot of value to people’s home and small office environments, so the more findings and fixes the better. I also wanted to focus on the latest version because of this.

Initially, I had found a few critical security vulnerabilities but many had been found and fixed already and others eventually required local shell access in some form, some functionality had been changed over time, which solved those particular RCE issues too. So, I therefore looked at a few other vectors and decided to focus on one specific attack vector, which looked promising.

## **Backup Functions:**

Settings.php has lots of functionality, one of which allows users to back up and restore (export and import) configurations of the Pi-hole with a limited set of files (teleporter tab).

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s640/Screen+Shot+2020-06-18+at+4.31.19+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.31.19%2BPM.png)

This was interesting for me because when you export files, they are compressed in tar.gz format and saved. Upon decompression and by systematically reviewing each file that was saved, I found that there were several files which were useful and easy wins for RCE, in particular if no whitelisting and sanitising was taking place. However, those particular ones are not restored if you modify them, re-compress and upload to restore the backup.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s640/Screen+Shot+2020-06-18+at+4.35.31+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.35.31%2BPM.png)

In this instance though, the affected files I found are dnsmasq.d configuration files and the adlist.json file. The dnsmasq.d/04-pi-hole-static-dhcp.conf file allows static DHCP leases, which link to MAC, IP and host.

I modified the configuration file for dnsmasq.d initially, in which I added my own code for the host parameter. Once I did this, I recompressed the file accordingly and imported the file back in via teleporter:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s640/Screen+Shot+2020-06-18+at+4.38.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.38.14%2BPM.png)

Upon browsing to the static DHCP leases section of the Pi-hole web interface, I could see my code was executing correctly i.e. I had found a Code Injection vulnerability.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s640/Screen+Shot+2020-06-18+at+4.39.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.39.14%2BPM.png)

The same then applied to adlists.json and other parameters in other files, as all the files were not being properly checked upon upload, they also just overwrote whatever was previously there and therefore your code executed accordingly:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s640/Screen+Shot+2020-06-22+at+10.13.18+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s1600/Screen%2BShot%2B2020-06-22%2Bat%2B10.13.18%2BPM.png)

Browse to host/admin/groups-adlists.php and you should get the ‘Adam popup’:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s640/Screen+Shot+2020-06-18+at+4.45.47+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.45.47%2BPM.png)

There are more examples, however it’s more of the same as what has been discussed above. I would also like to mention, that the Pi-hole is an amazing piece of software, built by people who really care for the community, please support them and donate. All the responses (especially from Adam) were really quick and things were patched exceptionally quickly.

You can browse all the fixes, comments and progress of patching by going here:

<https://github.com/pi-hole/AdminLTE/commit/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-640920508>

<https://github.com/pi-hole/AdminLTE/commit/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-643830404>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14971>

at

[Tuesday, June 23, 2020](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/4313565159762696677)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=4313565159762696677&from=pencil "Edit Post")

Labels:
[0day](https://blog.telspace.co.za/search/label/0day),
[2020](https://blog.telspace.co.za/search/label/2020),
[code injection](https://blog.telspace.co.za/search/label/code%20injection),
[CVE-2020-14971](https://blog.telspace.co.za/search/label/CVE-2020-14971),
[pentesting](https://blog.telspace.co.za/search/label/pentesting),
[pihole](https://blog.telspace.co.za/search/label/pihole)

[Older Posts](https://blog.telspace.co.za/search/label/pihole?updated-max=2020-06-23T11:01:00%2B02:00&max-results=20&start=20&by-date=false "Older Posts")

[Home](https://blog.telspace.co.za/)

Subscribe to:
[Posts (Atom)](https://blog.telspace.co.za/feeds/posts/default)

[![](https://www.telspace.africa/img/tel27.jpg)](https://www.telspace.africa)

www.telspace.africa

| Blog Archive  * ▼   [2023](https://blog.telspace.co.za/2023/)   (2)   + ▼     [October](https://blog.telspace.co.za/2023/10/)     (1)     - [Transformative Journey: My Experience at the Telsp...](https://blog.telspace.co.za/2023/10/transformative-journey-my-experience-at.html)   + ►     [August](https://blog.telspace.co.za/2023/08/)     (1)  * ►   [2022](https://blog.telspace.co.za/2022/)   (2)   + ►     [July](https://blog.telspace.co.za/2022/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2022/05/)     (1)  * ►   [2021](https://blog.telspace.co.za/2021/)   (2)   + ►     [July](https://blog.telspace.co.za/2021/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2021/04/)     (1)  * ►   [2020](https://blog.telspace.co.za/2020/)   (8)   + ►     [December](https://blog.telspace.co.za/2020/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2020/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2020/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2020/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2020/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2020/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2020/01/)     (1)  * ►   [2019](https://blog.telspace.co.za/2019/)   (8)   + ►     [November](https://blog.telspace.co.za/2019/11/)     (1)   + ►     [September](https://blog.telspace.co.za/2019/09/)     (1)   + ►     [August](https://blog.telspace.co.za/2019/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2019/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2019/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2019/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2019/01/)     (1)  * ►   [2018](https://blog.telspace.co.za/2018/)   (3)   + ►     [March](https://blog.telspace.co.za/2018/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2018/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2018/01/)     (1)  * ►   [2017](https://blog.telspace.co.za/2017/)   (7)   + ►     [December](https://blog.telspace.co.za/2017/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2017/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2017/09/)     (4)   + ►     [February](https://blog.telspace.co.za/2017/02/)     (1)  * ►   [2016](https://blog.telspace.co.za/2016/)   (5)   + ►     [December](https://blog.telspace.co.za/2016/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2016/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2016/05/)     (3)  * ►   [2015](https://blog.telspace.co.za/2015/)   (7)   + ►     [December](https://blog.telspace.co.za/2015/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2015/10/)     (2)   + ►     [March](https://blog.telspace.co.za/2015/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2015/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2015/01/)     (1)  * ►   [2014](https://blog.telspace.co.za/2014/)   (14)   + ►     [October](https://blog.telspace.co.za/2014/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2014/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2014/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2014/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2014/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2014/04/)     (2)   + ►     [February](https://blog.telspace.co.za/2014/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2014/01/)     (2)  * ►   [2013](https://blog.telspace.co.za/2013/)   (15)   + ►     [December](https://blog.telspace.co.za/2013/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2013/11/)     (1)   + ►     [October](https://blog.telspace.co.za/2013/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2013/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2013/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2013/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2013/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2013/05/)     (4)   + ►     [April](https://blog.telspace.co.za/2013/04/)     (1)   + ►     [March](https://blog.telspace.co.za/2013/03/)     (1)  * ►   [2012](https://blog.telspace.co.za/2012/)   (5)   + ►     [October](https://blog.telspace.co.za/2012/10/)     (1)   + ►     [July](https://blog.telspace.co.za/2012/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2012/04/)     (1)   + ►     [January](https://blog.telspace.co.za/2012/01/)     (2)  * ►   [2011](https://blog.telspace.co.za/2011/)   (11)   + ►     [November](https://blog.telspace.co.za/2011/11/)     (2)   + ►     [August](https://blog.telspace.co.za/2011/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2011/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2011/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2011/04/)     (2)   + ►     [March](https://blog.telspace.co.za/2011/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2011/01/)     (2)  * ►   [2010](https://blog.telspace.co.za/2010/)   (15)   + ►     [December](https://blog.telspace.co.za/2010/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2010/11/)     (2)   + ►     [September](https://blog.telspace.co.za/2010/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2010/08/)     (1)   + ►     [July](https://blog.telspace.co.za/2010/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2010/05/)     (3)   + ►     [March](https://blog.telspace.co.za/2010/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2010/02/)     (3)  * ►   [2009](https://blog.telspace.co.za/2009/)   (10)   + ►     [September](https://blog.telspace.co.za/2009/09/)     (2)   + ►     [July](https://blog.telspace.co.za/2009/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2009/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2009/05/)     (1)   + ►     [February](https://blog.telspace.co.za/2009/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2009/01/)     (3)  * ►   [2008](https://blog.telspace.co.za/2008/)   (26)   + ►     [December](https://blog.telspace.co.za/2008/12/)     (4)   + ►     [November](https://blog.telspace.co.za/2008/11/)     (2)   + ►     [October](https://blog.telspace.co.za/2008/10/)     (4)   + ►     [September](https://blog.telspace.co.za/2008/09/)     (6)   + ►     [August](https://blog.telspace.co.za/2008/08/)     (3)   + ►     [July](https://blog.telspace.co.za/2008/07/)     (2)   + ►     [June](https://blog.telspace.co.za/2008/06/)     (3)   + ►     [May](https://blog.telspace.co.za/2008/05/)     (2) | Subscribe now!   Posts   [Atom](https://blog.telspace.co.za/feeds/posts/default)     Posts       All Comments   [Atom](https://blog.telspace.co.za/feeds/comments/default)     All Comments |
| --- | --- |

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).



=== Content from avatars.githubusercontent.com_0f077470_20250119_140257.html ===
�PNG

   
IHDR  �  �   �.�b  �IDATx���Q
�@F���@��
�F�>��΄�s�\_Br;�� ~��� f; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; a[=����Y=����WOx%/; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; A���H; �3Ƙs龞9��w9�}m6�#M�?H���$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$|��7 |��� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$l�.��3��"ǹO��e$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$���c���V����@�q�'���� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$���c�� �u^v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@�� b$�� v@¿   ��0�#]E^�    IEND�B`�

=== Content from blog.telspace.co.za_ec7283ae_20250119_140251.html ===


# [Telspace Africa, The Blog](https://blog.telspace.co.za/)

Hackers for hire

## Thursday, July 9, 2020

### [phpList – CVE-2020-15072 & CVE-2020-15073 – Story Time](https://blog.telspace.co.za/2020/07/phplist-cve-2020-15072-cve-2020-15073.html)

phpList is currently used in 73 countries and is a popular choice for sending email newsletters, marketing campaigns and announcements. It is accessible via web browsers and is Open Source ([https://www.phplist.org](https://www.phplist.org/)), however a paid for version also exists as a service via [https://www.phplist.com](https://www.phplist.com/).

Given its wide use / adoption, I decided to take a look at phpList recently, in order to give back to the Open Source community.

I would also like to give credit to phpList for responding and patching very quickly, especially to Suela at phpList. A new version of the application is now available for download.

You can browse all the fixes, comments and patching by going to the following URLs:

·      <https://discuss.phplist.org/t/phplist-3-5-5-has-been-released/6377>
·      <https://www.phplist.org/newslist/phplist-3-5-5-release-notes/>
·      <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-15072>
·      <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-15073>

A walkthrough of the 2 identified vulnerabilities is given below:

## **1.) Code Injection via "Import administrators"**

1.1) Click on "Config" then "Import administrators"

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhyPppFv3ohHM2NT1LjJ6s6I6dhOId6El8OY15d4uKYzX-bfUk0zmqTqsHTyZ97n0JivDXXM-TtNJ_NB_qf2honm_ZGUA_fRzetB2a9KfiqzLIqKmqmVw_exQu672KG-VabCZEOhnFhKl61/s640/1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhyPppFv3ohHM2NT1LjJ6s6I6dhOId6El8OY15d4uKYzX-bfUk0zmqTqsHTyZ97n0JivDXXM-TtNJ_NB_qf2honm_ZGUA_fRzetB2a9KfiqzLIqKmqmVw_exQu672KG-VabCZEOhnFhKl61/s1600/1.png)
1.2) Edit a txt file to include basic headers and test (offline) as follows:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgwPKOi0iGqIe0P3pEW5ftErTZiITJk3xBIJmAw3O-19vuwQWYBj4GNwwQ-0oSyK-_eTQrZk2_Npa67HvarILopXHA5UDdsh7eIycClbmE4TX6wFyx4T-SZxQlOuWcDPCalcysQ2WH6C_9Q/s640/2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgwPKOi0iGqIe0P3pEW5ftErTZiITJk3xBIJmAw3O-19vuwQWYBj4GNwwQ-0oSyK-_eTQrZk2_Npa67HvarILopXHA5UDdsh7eIycClbmE4TX6wFyx4T-SZxQlOuWcDPCalcysQ2WH6C_9Q/s1600/2.png)

1.3) Click on "Choose File" and select the text file.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgvh7iweU5AySwLlTQa2RuAdW2-tc-73isJPSOxgTHsmIEo6G9w4YIYOBhFSo8kHa71vEiU9Dz-Vm7P1B6JpIp-jZxSWGv0tjzDfjyIoeI4y82MFKptTb7y3LlUQVYRJuraMIOpfHdIB6Lu/s640/3.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgvh7iweU5AySwLlTQa2RuAdW2-tc-73isJPSOxgTHsmIEo6G9w4YIYOBhFSo8kHa71vEiU9Dz-Vm7P1B6JpIp-jZxSWGv0tjzDfjyIoeI4y82MFKptTb7y3LlUQVYRJuraMIOpfHdIB6Lu/s1600/3.png)
1.4) Click "Do Import"

Code Injection Triggered (not stored)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgic4AdLYhrsjAfipXHah1jXJDYLtpkaAHa5MGpgksN81r4WA1P1vn4QGP_u2gAIM5rSOM_gwQ4EIGtOJI2RgapaXxK6eKVIXL7clJet__4k3lVGubPvxORvmYW4ttLlCPOAtyjibMJ10c9/s640/4.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgic4AdLYhrsjAfipXHah1jXJDYLtpkaAHa5MGpgksN81r4WA1P1vn4QGP_u2gAIM5rSOM_gwQ4EIGtOJI2RgapaXxK6eKVIXL7clJet__4k3lVGubPvxORvmYW4ttLlCPOAtyjibMJ10c9/s1600/4.png)
1.5) Go back to "Import administrators"
1.6) Untick "Test output:"

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj8b584eyAG_Cqdq1QWpLy7l_bAUfDYObDBi9IqsXzMWabTnszBBGiF-BWhyveTamgXeKp0adf6x7c4m4i8NVL1SqyWWgsK_yV2mR7fEh7y7h3PJiWZQr4u5hULLCLoK88w31Nty2qxgZgb/s640/5.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj8b584eyAG_Cqdq1QWpLy7l_bAUfDYObDBi9IqsXzMWabTnszBBGiF-BWhyveTamgXeKp0adf6x7c4m4i8NVL1SqyWWgsK_yV2mR7fEh7y7h3PJiWZQr4u5hULLCLoK88w31Nty2qxgZgb/s1600/5.png)

1.7) Click "Do Import" and you will get an import database error.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjuQW9yZdQfPXYvY4o7KKWn5jZXWM0dLt8PP3yszwY8EyWpflF3X7hKTx1-a5kQWPwZATPTTKB-MF0FmkO85rbtVihefHLTB2S7GlJ4j8Urn9P2spbpQzc3dxve1POff7ICjdW3NIVirALs/s640/6.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjuQW9yZdQfPXYvY4o7KKWn5jZXWM0dLt8PP3yszwY8EyWpflF3X7hKTx1-a5kQWPwZATPTTKB-MF0FmkO85rbtVihefHLTB2S7GlJ4j8Urn9P2spbpQzc3dxve1POff7ICjdW3NIVirALs/s1600/6.png)
1.8) Edit the same text file and add another user as follows:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgYPmTAJndxRf4vcUsSPNjYZiYFYVyIQXxnz0cfMzC-y2v7vAb31Yfkoadpk4seiDbHflcZquH3WfwKtlKPQP1p_K0j1ca4t4_9V6I6U3Ke0Furh26KRswcWiXmki3QfSJuUik4-GdTlWNn/s640/7.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgYPmTAJndxRf4vcUsSPNjYZiYFYVyIQXxnz0cfMzC-y2v7vAb31Yfkoadpk4seiDbHflcZquH3WfwKtlKPQP1p_K0j1ca4t4_9V6I6U3Ke0Furh26KRswcWiXmki3QfSJuUik4-GdTlWNn/s1600/7.png)
1.9) Go back to "Import administrators"
1.10) Click on "Choose File" and choose the text file.
1.11) Untick "Test output:"

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0ofAb_8LvIb0FHFjkG4YLlqh0np36tRl5VoH9Amh3KWd1eg4k9DSfvCRyJr-Fj-OLeYcE7g3xpT_BN_jFiNAc2ViANCzVvsePsaWfXQ7QANTcP_a_dbp5II_SRiDtyAvCrrz1_PUTbmFC/s640/8.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0ofAb_8LvIb0FHFjkG4YLlqh0np36tRl5VoH9Amh3KWd1eg4k9DSfvCRyJr-Fj-OLeYcE7g3xpT_BN_jFiNAc2ViANCzVvsePsaWfXQ7QANTcP_a_dbp5II_SRiDtyAvCrrz1_PUTbmFC/s1600/8.png)
1.12) Click "Do Import" and you will get more import database errors
1.13) Browse to "Subscribers" then "Subscriber Lists"

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPmMrCXyHEnVbqdoC87sIqCwbs_1r2OBaPy5pLCrT-8xLboYFBBziDyGk7AQzeEUeGudQDBrLbtYAmxD6T05ZTw9V8wUE2xRiXkFj0bCsLT00X9DokwYJPwnVNm16KdTaovRC2zr4CjsMR/s640/9.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPmMrCXyHEnVbqdoC87sIqCwbs_1r2OBaPy5pLCrT-8xLboYFBBziDyGk7AQzeEUeGudQDBrLbtYAmxD6T05ZTw9V8wUE2xRiXkFj0bCsLT00X9DokwYJPwnVNm16KdTaovRC2zr4CjsMR/s1600/9.png)
1.14) Click on the first one and you'll get a "hi" popup:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh39UGw9sJIAMhVI9OagcsCODm4um9qGrSUPnN9blTxDANPcCWGOqdlr8LCdqoesEc0NjOuvlnQlY3r2SHquH3xReuKuXw688xrUDZJHli4JqyrTOrKDBsODcZZLdgcWnhGu4VoY3nJNoOQ/s640/10.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh39UGw9sJIAMhVI9OagcsCODm4um9qGrSUPnN9blTxDANPcCWGOqdlr8LCdqoesEc0NjOuvlnQlY3r2SHquH3xReuKuXw688xrUDZJHli4JqyrTOrKDBsODcZZLdgcWnhGu4VoY3nJNoOQ/s1600/10.png)
 1.15) Go back and click on the second one and you'll get a cookie.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiz07ar6YdyKGZ4K_aLR8G8M8m2SgktgbWypmtca56Qfbri2sDeRoI0L4czb8j-qkQSpW5gsDrsk9XSpILHpLIqjhPAxcI8KoKLHA5izCV-F2bRdBYBp0fGN1MeisNeSydKDVfZd3YrYEBT/s640/11.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiz07ar6YdyKGZ4K_aLR8G8M8m2SgktgbWypmtca56Qfbri2sDeRoI0L4czb8j-qkQSpW5gsDrsk9XSpILHpLIqjhPAxcI8KoKLHA5izCV-F2bRdBYBp0fGN1MeisNeSydKDVfZd3YrYEBT/s1600/11.png)

## **2.) Error based SQL Injection via "Import administrators"**

2.1) Click on "Config" then "Import administrators"
2.2) Edit a txt file to include basic headers and text (offline) as follows

email   loginname      password

test2@test.com          "'testsql          test

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhGbYsXFzmDJ5iWWP4c2HzU40ddbxAVCm1t7W6_lM0hJElHVusQDZKq1wPs8RUNLP1bOJouI4YK_1muJqlVjErI9Hfa9aIMrU7ujCbDfuHuY62JItMbuki0__Em9n12PHil7WeLaCfwJXkn/s640/12.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhGbYsXFzmDJ5iWWP4c2HzU40ddbxAVCm1t7W6_lM0hJElHVusQDZKq1wPs8RUNLP1bOJouI4YK_1muJqlVjErI9Hfa9aIMrU7ujCbDfuHuY62JItMbuki0__Em9n12PHil7WeLaCfwJXkn/s1600/12.png)
2.3) Untick "Test output:"
2.4) Click on "Choose File" and choose the text file.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg7svvZIQqFpA0aWRFPRMfR9uEp5I-l8nkHV2jxgiSOIkdBoZwsn7_3Z5_Z2IL8ShXixWTw9o43Tt_gMECC_lhT9TPX5GCNbh1LBaA2og3CHcuNEfE0MjqzQ19elWjcZydH4VfzRmOSVy3t/s640/13.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg7svvZIQqFpA0aWRFPRMfR9uEp5I-l8nkHV2jxgiSOIkdBoZwsn7_3Z5_Z2IL8ShXixWTw9o43Tt_gMECC_lhT9TPX5GCNbh1LBaA2og3CHcuNEfE0MjqzQ19elWjcZydH4VfzRmOSVy3t/s1600/13.png)

 2.5) Click "Do Import" - you'll see the Error Based SQL injection.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjANUdklmTFIgLcH0aBiHikAst6LrVbZ6vqsWQ9OIqAhDTATmBrfzzufhVN2UumiMPO-eEjVC0ibcukbPP9hpewuDK_0UPBe14uRJTbGyG0KuC2KUhqdcP0Lqgg1ft6rk49IDVqU5yi8DRb/s640/14.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjANUdklmTFIgLcH0aBiHikAst6LrVbZ6vqsWQ9OIqAhDTATmBrfzzufhVN2UumiMPO-eEjVC0ibcukbPP9hpewuDK_0UPBe14uRJTbGyG0KuC2KUhqdcP0Lqgg1ft6rk49IDVqU5yi8DRb/s1600/14.png)

*Creative Commons - Attribution-ShareAlike 4.0 International (CC BY-SA 4.0) - <https://creativecommons.org/licenses/by-sa/4.0/>*

at

[Thursday, July 09, 2020](https://blog.telspace.co.za/2020/07/phplist-cve-2020-15072-cve-2020-15073.html "permanent link")

[1 comment:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/6349469799071097550)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=6349469799071097550&from=pencil "Edit Post")

Labels:
[2020](https://blog.telspace.co.za/search/label/2020),
[code injection](https://blog.telspace.co.za/search/label/code%20injection),
[CVE-2020-15072](https://blog.telspace.co.za/search/label/CVE-2020-15072),
[CVE-2020-15073](https://blog.telspace.co.za/search/label/CVE-2020-15073),
[phpList](https://blog.telspace.co.za/search/label/phpList),
[security advisory](https://blog.telspace.co.za/search/label/security%20advisory),
[sql injection](https://blog.telspace.co.za/search/label/sql%20injection)

[Newer Posts](https://blog.telspace.co.za/search?updated-max=2022-05-10T13:48:00%2B02:00&max-results=3&reverse-paginate=true "Newer Posts")

[Older Posts](https://blog.telspace.co.za/search?updated-max=2020-07-09T11:06:00%2B02:00&max-results=3 "Older Posts")

[Home](https://blog.telspace.co.za/)

Subscribe to:
[Posts (Atom)](https://blog.telspace.co.za/feeds/posts/default)

[![](https://www.telspace.africa/img/tel27.jpg)](https://www.telspace.africa)

www.telspace.africa

| Blog Archive  * ►   [2023](https://blog.telspace.co.za/2023/)   (2)   + ►     [October](https://blog.telspace.co.za/2023/10/)     (1)   + ►     [August](https://blog.telspace.co.za/2023/08/)     (1)  * ►   [2022](https://blog.telspace.co.za/2022/)   (2)   + ►     [July](https://blog.telspace.co.za/2022/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2022/05/)     (1)  * ►   [2021](https://blog.telspace.co.za/2021/)   (2)   + ►     [July](https://blog.telspace.co.za/2021/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2021/04/)     (1)  * ▼   [2020](https://blog.telspace.co.za/2020/)   (8)   + ►     [December](https://blog.telspace.co.za/2020/12/)     (1)   + ▼     [July](https://blog.telspace.co.za/2020/07/)     (1)     - [phpList – CVE-2020-15072 & CVE-2020-15073 – Story ...](https://blog.telspace.co.za/2020/07/phplist-cve-2020-15072-cve-2020-15073.html)   + ►     [June](https://blog.telspace.co.za/2020/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2020/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2020/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2020/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2020/01/)     (1)  * ►   [2019](https://blog.telspace.co.za/2019/)   (8)   + ►     [November](https://blog.telspace.co.za/2019/11/)     (1)   + ►     [September](https://blog.telspace.co.za/2019/09/)     (1)   + ►     [August](https://blog.telspace.co.za/2019/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2019/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2019/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2019/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2019/01/)     (1)  * ►   [2018](https://blog.telspace.co.za/2018/)   (3)   + ►     [March](https://blog.telspace.co.za/2018/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2018/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2018/01/)     (1)  * ►   [2017](https://blog.telspace.co.za/2017/)   (7)   + ►     [December](https://blog.telspace.co.za/2017/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2017/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2017/09/)     (4)   + ►     [February](https://blog.telspace.co.za/2017/02/)     (1)  * ►   [2016](https://blog.telspace.co.za/2016/)   (5)   + ►     [December](https://blog.telspace.co.za/2016/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2016/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2016/05/)     (3)  * ►   [2015](https://blog.telspace.co.za/2015/)   (7)   + ►     [December](https://blog.telspace.co.za/2015/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2015/10/)     (2)   + ►     [March](https://blog.telspace.co.za/2015/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2015/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2015/01/)     (1)  * ►   [2014](https://blog.telspace.co.za/2014/)   (14)   + ►     [October](https://blog.telspace.co.za/2014/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2014/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2014/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2014/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2014/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2014/04/)     (2)   + ►     [February](https://blog.telspace.co.za/2014/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2014/01/)     (2)  * ►   [2013](https://blog.telspace.co.za/2013/)   (15)   + ►     [December](https://blog.telspace.co.za/2013/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2013/11/)     (1)   + ►     [October](https://blog.telspace.co.za/2013/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2013/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2013/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2013/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2013/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2013/05/)     (4)   + ►     [April](https://blog.telspace.co.za/2013/04/)     (1)   + ►     [March](https://blog.telspace.co.za/2013/03/)     (1)  * ►   [2012](https://blog.telspace.co.za/2012/)   (5)   + ►     [October](https://blog.telspace.co.za/2012/10/)     (1)   + ►     [July](https://blog.telspace.co.za/2012/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2012/04/)     (1)   + ►     [January](https://blog.telspace.co.za/2012/01/)     (2)  * ►   [2011](https://blog.telspace.co.za/2011/)   (11)   + ►     [November](https://blog.telspace.co.za/2011/11/)     (2)   + ►     [August](https://blog.telspace.co.za/2011/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2011/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2011/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2011/04/)     (2)   + ►     [March](https://blog.telspace.co.za/2011/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2011/01/)     (2)  * ►   [2010](https://blog.telspace.co.za/2010/)   (15)   + ►     [December](https://blog.telspace.co.za/2010/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2010/11/)     (2)   + ►     [September](https://blog.telspace.co.za/2010/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2010/08/)     (1)   + ►     [July](https://blog.telspace.co.za/2010/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2010/05/)     (3)   + ►     [March](https://blog.telspace.co.za/2010/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2010/02/)     (3)  * ►   [2009](https://blog.telspace.co.za/2009/)   (10)   + ►     [September](https://blog.telspace.co.za/2009/09/)     (2)   + ►     [July](https://blog.telspace.co.za/2009/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2009/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2009/05/)     (1)   + ►     [February](https://blog.telspace.co.za/2009/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2009/01/)     (3)  * ►   [2008](https://blog.telspace.co.za/2008/)   (26)   + ►     [December](https://blog.telspace.co.za/2008/12/)     (4)   + ►     [November](https://blog.telspace.co.za/2008/11/)     (2)   + ►     [October](https://blog.telspace.co.za/2008/10/)     (4)   + ►     [September](https://blog.telspace.co.za/2008/09/)     (6)   + ►     [August](https://blog.telspace.co.za/2008/08/)     (3)   + ►     [July](https://blog.telspace.co.za/2008/07/)     (2)   + ►     [June](https://blog.telspace.co.za/2008/06/)     (3)   + ►     [May](https://blog.telspace.co.za/2008/05/)     (2) | Subscribe now!   Posts   [Atom](https://blog.telspace.co.za/feeds/posts/default)     Posts       All Comments   [Atom](https://blog.telspace.co.za/feeds/comments/default)     All Comments |
| --- | --- |

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).



=== Content from blog.telspace.co.za_1bc450de_20250119_140256.html ===


# [Telspace Africa, The Blog](https://blog.telspace.co.za/)

Hackers for hire

Showing posts with label **CVE-2020-14971**. [Show all posts](https://blog.telspace.co.za/)

Showing posts with label **CVE-2020-14971**. [Show all posts](https://blog.telspace.co.za/)

## Tuesday, June 23, 2020

### [Pi-hole Code Injection – CVE-2020-14971– Story Time](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html)

A while ago, we had an internal discussion around people working from home and the technologies/products that could be implemented and/or bought to protect home users. This was due to the implementation of the nationwide lockdown which resulted in companies being forced to change their approach entirely to having employees work from home.

During this discussion the Pi-hole was mentioned. Pi-hole is a very popular option for the more “tech savvy” home user and generally, anyone that’s tired of being spammed with random adverts on every website. You can find more information about it here <https://github.com/pi-hole/pi-hole/>.

Since I had a Pi-hole installed already, I decided to take a look at this beautiful piece of ad blocking software in more detail, specifically reviewing the code and logic of the application. Because it’s Opensource and available freely, this was easily accomplished by downloading and installing the latest Pi-hole (v5.0 at the time).

It’s worth mentioning that a lot of vulnerabilities had already been found in this software, some overlapped with findings that I had found particularly during April and May, which were rightfully allocated to the first people that reported the issues. With that being said, the Pi-hole is a popular target for researchers and adds a lot of value to people’s home and small office environments, so the more findings and fixes the better. I also wanted to focus on the latest version because of this.

Initially, I had found a few critical security vulnerabilities but many had been found and fixed already and others eventually required local shell access in some form, some functionality had been changed over time, which solved those particular RCE issues too. So, I therefore looked at a few other vectors and decided to focus on one specific attack vector, which looked promising.

## **Backup Functions:**

Settings.php has lots of functionality, one of which allows users to back up and restore (export and import) configurations of the Pi-hole with a limited set of files (teleporter tab).

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s640/Screen+Shot+2020-06-18+at+4.31.19+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEglNhhw3mW08neSXNN_1PoEhIVyxrHWaqOBysJYAbU4FAWUvHg9ftssQELdj0Xpi5Hukk7-ttTCFg2BWrpJ6pvJvYyj9o4icEhZiNy9CfZ6p3qPqSrypAv7_T6DwNBIe_WxbLyU4Eo4I71P/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.31.19%2BPM.png)

This was interesting for me because when you export files, they are compressed in tar.gz format and saved. Upon decompression and by systematically reviewing each file that was saved, I found that there were several files which were useful and easy wins for RCE, in particular if no whitelisting and sanitising was taking place. However, those particular ones are not restored if you modify them, re-compress and upload to restore the backup.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s640/Screen+Shot+2020-06-18+at+4.35.31+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg60pHTXF0c5H35b6bPbxUYnRanI4SEki9V_coimghoR5LPF8qj6CkuJebN2tLx0H41Y3ndjJSOKhMv6_0mtr4xAVWjGYu09IBiPQt8z6aUN_nqtvC8l_QFSuhQzNdP8irl0h8DCLy-9MsS/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.35.31%2BPM.png)

In this instance though, the affected files I found are dnsmasq.d configuration files and the adlist.json file. The dnsmasq.d/04-pi-hole-static-dhcp.conf file allows static DHCP leases, which link to MAC, IP and host.

I modified the configuration file for dnsmasq.d initially, in which I added my own code for the host parameter. Once I did this, I recompressed the file accordingly and imported the file back in via teleporter:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s640/Screen+Shot+2020-06-18+at+4.38.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRfq1diJZChftFHvO-VFfwNTn8GJ9_2FFUSTI6nBVPSqeDtkgEvbofaAoD1F5SKbF7HUy8PoPrtscCu8FpV6LrYJWykSG7yA07-kHwNz-roNAAt9uf5ZsL1nYFEu1h7GLsM28m5o99_p9f/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.38.14%2BPM.png)

Upon browsing to the static DHCP leases section of the Pi-hole web interface, I could see my code was executing correctly i.e. I had found a Code Injection vulnerability.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s640/Screen+Shot+2020-06-18+at+4.39.14+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFECwnHLey4wtTVFSYh0g7Mp09T2oJBLr1auI6hYhBmvhS0OJF8JZJLZoum4ApZcpLDopUXPjYIgQ7ApjLxaTp79tr-NyIElvR11aL1s_uOHSqobD0VCk9hUOCMWNvA8m7NwWtempv8v3S/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.39.14%2BPM.png)

The same then applied to adlists.json and other parameters in other files, as all the files were not being properly checked upon upload, they also just overwrote whatever was previously there and therefore your code executed accordingly:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s640/Screen+Shot+2020-06-22+at+10.13.18+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhG1GmplenHq7rmbWtRjeTy492e1QfFcnEFUSOg09i0PeB3YYgjB3H_YIvSRdQS95kC3753-do_jF3rT57gumNRc8jIoQVxRNP8CvCnRbVyKZJg99DxHLVA4VucqIFsAwtbLB1rIx_R0bGR/s1600/Screen%2BShot%2B2020-06-22%2Bat%2B10.13.18%2BPM.png)

Browse to host/admin/groups-adlists.php and you should get the ‘Adam popup’:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s640/Screen+Shot+2020-06-18+at+4.45.47+PM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjkL4xhcy00Ir0k_5N5b41Wau-Azdckp9X4yqI7nqToiNy8pLw2uHLuxxgHMARkOxL-xcimS2fWjUbn35YVSQF3yPXCZplqB31krG5J2KMfL9CEMu_OvBuXDKezufBsmlSbCAnppzJaPQvO/s1600/Screen%2BShot%2B2020-06-18%2Bat%2B4.45.47%2BPM.png)

There are more examples, however it’s more of the same as what has been discussed above. I would also like to mention, that the Pi-hole is an amazing piece of software, built by people who really care for the community, please support them and donate. All the responses (especially from Adam) were really quick and things were patched exceptionally quickly.

You can browse all the fixes, comments and progress of patching by going here:

<https://github.com/pi-hole/AdminLTE/commit/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-640920508>

<https://github.com/pi-hole/AdminLTE/commit/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5>

<https://github.com/pi-hole/AdminLTE/pull/1443#issuecomment-643830404>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14971>

at

[Tuesday, June 23, 2020](https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html "permanent link")

[No comments:](https://www.blogger.com/comment/fullpage/post/2540168616552398462/4313565159762696677)

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2540168616552398462&postID=4313565159762696677&from=pencil "Edit Post")

Labels:
[0day](https://blog.telspace.co.za/search/label/0day),
[2020](https://blog.telspace.co.za/search/label/2020),
[code injection](https://blog.telspace.co.za/search/label/code%20injection),
[CVE-2020-14971](https://blog.telspace.co.za/search/label/CVE-2020-14971),
[pentesting](https://blog.telspace.co.za/search/label/pentesting),
[pihole](https://blog.telspace.co.za/search/label/pihole)

[Older Posts](https://blog.telspace.co.za/search/label/CVE-2020-14971?updated-max=2020-06-23T11:01:00%2B02:00&max-results=20&start=20&by-date=false "Older Posts")

[Home](https://blog.telspace.co.za/)

Subscribe to:
[Posts (Atom)](https://blog.telspace.co.za/feeds/posts/default)

[![](https://www.telspace.africa/img/tel27.jpg)](https://www.telspace.africa)

www.telspace.africa

| Blog Archive  * ▼   [2023](https://blog.telspace.co.za/2023/)   (2)   + ▼     [October](https://blog.telspace.co.za/2023/10/)     (1)     - [Transformative Journey: My Experience at the Telsp...](https://blog.telspace.co.za/2023/10/transformative-journey-my-experience-at.html)   + ►     [August](https://blog.telspace.co.za/2023/08/)     (1)  * ►   [2022](https://blog.telspace.co.za/2022/)   (2)   + ►     [July](https://blog.telspace.co.za/2022/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2022/05/)     (1)  * ►   [2021](https://blog.telspace.co.za/2021/)   (2)   + ►     [July](https://blog.telspace.co.za/2021/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2021/04/)     (1)  * ►   [2020](https://blog.telspace.co.za/2020/)   (8)   + ►     [December](https://blog.telspace.co.za/2020/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2020/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2020/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2020/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2020/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2020/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2020/01/)     (1)  * ►   [2019](https://blog.telspace.co.za/2019/)   (8)   + ►     [November](https://blog.telspace.co.za/2019/11/)     (1)   + ►     [September](https://blog.telspace.co.za/2019/09/)     (1)   + ►     [August](https://blog.telspace.co.za/2019/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2019/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2019/05/)     (2)   + ►     [March](https://blog.telspace.co.za/2019/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2019/01/)     (1)  * ►   [2018](https://blog.telspace.co.za/2018/)   (3)   + ►     [March](https://blog.telspace.co.za/2018/03/)     (1)   + ►     [February](https://blog.telspace.co.za/2018/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2018/01/)     (1)  * ►   [2017](https://blog.telspace.co.za/2017/)   (7)   + ►     [December](https://blog.telspace.co.za/2017/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2017/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2017/09/)     (4)   + ►     [February](https://blog.telspace.co.za/2017/02/)     (1)  * ►   [2016](https://blog.telspace.co.za/2016/)   (5)   + ►     [December](https://blog.telspace.co.za/2016/12/)     (1)   + ►     [July](https://blog.telspace.co.za/2016/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2016/05/)     (3)  * ►   [2015](https://blog.telspace.co.za/2015/)   (7)   + ►     [December](https://blog.telspace.co.za/2015/12/)     (1)   + ►     [October](https://blog.telspace.co.za/2015/10/)     (2)   + ►     [March](https://blog.telspace.co.za/2015/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2015/02/)     (1)   + ►     [January](https://blog.telspace.co.za/2015/01/)     (1)  * ►   [2014](https://blog.telspace.co.za/2014/)   (14)   + ►     [October](https://blog.telspace.co.za/2014/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2014/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2014/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2014/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2014/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2014/04/)     (2)   + ►     [February](https://blog.telspace.co.za/2014/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2014/01/)     (2)  * ►   [2013](https://blog.telspace.co.za/2013/)   (15)   + ►     [December](https://blog.telspace.co.za/2013/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2013/11/)     (1)   + ►     [October](https://blog.telspace.co.za/2013/10/)     (1)   + ►     [September](https://blog.telspace.co.za/2013/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2013/08/)     (2)   + ►     [July](https://blog.telspace.co.za/2013/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2013/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2013/05/)     (4)   + ►     [April](https://blog.telspace.co.za/2013/04/)     (1)   + ►     [March](https://blog.telspace.co.za/2013/03/)     (1)  * ►   [2012](https://blog.telspace.co.za/2012/)   (5)   + ►     [October](https://blog.telspace.co.za/2012/10/)     (1)   + ►     [July](https://blog.telspace.co.za/2012/07/)     (1)   + ►     [April](https://blog.telspace.co.za/2012/04/)     (1)   + ►     [January](https://blog.telspace.co.za/2012/01/)     (2)  * ►   [2011](https://blog.telspace.co.za/2011/)   (11)   + ►     [November](https://blog.telspace.co.za/2011/11/)     (2)   + ►     [August](https://blog.telspace.co.za/2011/08/)     (1)   + ►     [June](https://blog.telspace.co.za/2011/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2011/05/)     (2)   + ►     [April](https://blog.telspace.co.za/2011/04/)     (2)   + ►     [March](https://blog.telspace.co.za/2011/03/)     (1)   + ►     [January](https://blog.telspace.co.za/2011/01/)     (2)  * ►   [2010](https://blog.telspace.co.za/2010/)   (15)   + ►     [December](https://blog.telspace.co.za/2010/12/)     (1)   + ►     [November](https://blog.telspace.co.za/2010/11/)     (2)   + ►     [September](https://blog.telspace.co.za/2010/09/)     (2)   + ►     [August](https://blog.telspace.co.za/2010/08/)     (1)   + ►     [July](https://blog.telspace.co.za/2010/07/)     (1)   + ►     [May](https://blog.telspace.co.za/2010/05/)     (3)   + ►     [March](https://blog.telspace.co.za/2010/03/)     (2)   + ►     [February](https://blog.telspace.co.za/2010/02/)     (3)  * ►   [2009](https://blog.telspace.co.za/2009/)   (10)   + ►     [September](https://blog.telspace.co.za/2009/09/)     (2)   + ►     [July](https://blog.telspace.co.za/2009/07/)     (1)   + ►     [June](https://blog.telspace.co.za/2009/06/)     (1)   + ►     [May](https://blog.telspace.co.za/2009/05/)     (1)   + ►     [February](https://blog.telspace.co.za/2009/02/)     (2)   + ►     [January](https://blog.telspace.co.za/2009/01/)     (3)  * ►   [2008](https://blog.telspace.co.za/2008/)   (26)   + ►     [December](https://blog.telspace.co.za/2008/12/)     (4)   + ►     [November](https://blog.telspace.co.za/2008/11/)     (2)   + ►     [October](https://blog.telspace.co.za/2008/10/)     (4)   + ►     [September](https://blog.telspace.co.za/2008/09/)     (6)   + ►     [August](https://blog.telspace.co.za/2008/08/)     (3)   + ►     [July](https://blog.telspace.co.za/2008/07/)     (2)   + ►     [June](https://blog.telspace.co.za/2008/06/)     (3)   + ►     [May](https://blog.telspace.co.za/2008/05/)     (2) | Subscribe now!   Posts   [Atom](https://blog.telspace.co.za/feeds/posts/default)     Posts       All Comments   [Atom](https://blog.telspace.co.za/feeds/comments/default)     All Comments |
| --- | --- |

|  |  |
| --- | --- |

Simple theme. Powered by [Blogger](https://www.blogger.com).



=== Content from github.com_691312b3_20250119_140249.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Fpull%2F1443)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Fpull%2F1443)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=pi-hole%2Fweb)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pi-hole](/pi-hole)
/
**[web](/pi-hole/web)**
Public

* [Notifications](/login?return_to=%2Fpi-hole%2Fweb) You must be signed in to change notification settings
* [Fork
  566](/login?return_to=%2Fpi-hole%2Fweb)
* [Star
   2.1k](/login?return_to=%2Fpi-hole%2Fweb)

* [Code](/pi-hole/web)
* [Issues
  19](/pi-hole/web/issues)
* [Pull requests
  8](/pi-hole/web/pulls)
* [Actions](/pi-hole/web/actions)
* [Projects
  1](/pi-hole/web/projects)
* [Security](/pi-hole/web/security)
* [Insights](/pi-hole/web/pulse)

Additional navigation options

* [Code](/pi-hole/web)
* [Issues](/pi-hole/web/issues)
* [Pull requests](/pi-hole/web/pulls)
* [Actions](/pi-hole/web/actions)
* [Projects](/pi-hole/web/projects)
* [Security](/pi-hole/web/security)
* [Insights](/pi-hole/web/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpi-hole%2Fweb%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpi-hole%2Fweb%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Prevent possible XSS attack vector in the input fields of the group section #1443

 Merged

[PromoFaux](/PromoFaux)
merged 1 commit into
[devel](/pi-hole/web/tree/devel "pi-hole/web:devel")
from
[sanitise-group-input](/pi-hole/web/tree/sanitise-group-input "pi-hole/web:sanitise-group-input")

Jun 14, 2020

 Merged

# [Prevent possible XSS attack vector in the input fields of the group section](#top) #1443

[PromoFaux](/PromoFaux)
merged 1 commit into
[devel](/pi-hole/web/tree/devel "pi-hole/web:devel")
from
[sanitise-group-input](/pi-hole/web/tree/sanitise-group-input "pi-hole/web:sanitise-group-input")

Jun 14, 2020

+67

−58

[Conversation
15](/pi-hole/web/pull/1443)
[Commits
1](/pi-hole/web/pull/1443/commits)
[Checks
0](/pi-hole/web/pull/1443/checks)
[Files changed
11](/pi-hole/web/pull/1443/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=60&v=4)](/PromoFaux)

Copy link

Member

### @PromoFaux **[PromoFaux](/PromoFaux)** commented [Jun 5, 2020](#issue-631900867)

**By submitting this pull request, I confirm the following:**

* I have read and understood the [contributors guide](https://github.com/pi-hole/pi-hole/blob/master/CONTRIBUTING.md), as well as this entire template.
* I have made only one major change in my proposed changes.
* I have commented my proposed changes within the code.
* I have tested my proposed changes, and have included unit tests where possible.
* I am willing to help maintain this change if there are issues with it later.
* I give this submission freely and claim no ownership.
* It is compatible with the [EUPL 1.2 license](https://opensource.org/licenses/EUPL-1.1)
* I have squashed any insignificant commits. ([`git rebase`](http://gitready.com/advanced/2009/02/10/squashing-commits-with-rebase.html))

---

**What does this PR aim to accomplish?:**

Calls the already existing `utils.escapeHtml()` to make sure nothing is executed. Works independent of CSP changes

Sorry, something went wrong.

All reactions

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
requested review from
[XhmikosR](/XhmikosR) and
[DL6ER](/DL6ER)
[June 5, 2020 19:53](#event-3412980011)

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
[force-pushed](/pi-hole/web/compare/b2b56711d844d9be3842717017c5fde1f548b80d..29a1e456cd3b712e0f98109fd259c2b00d86c89c)
the
sanitise-group-input

branch
from
[`b2b5671`](/pi-hole/web/commit/b2b56711d844d9be3842717017c5fde1f548b80d) to
[`29a1e45`](/pi-hole/web/commit/29a1e456cd3b712e0f98109fd259c2b00d86c89c)  [Compare](/pi-hole/web/compare/b2b56711d844d9be3842717017c5fde1f548b80d..29a1e456cd3b712e0f98109fd259c2b00d86c89c)
[June 5, 2020 19:55](#event-3412990578)

[![XhmikosR](https://avatars.githubusercontent.com/u/349621?s=60&v=4)](/XhmikosR)

**[XhmikosR](/XhmikosR)**
reviewed
[Jun 6, 2020](#pullrequestreview-425715167)

 [View reviewed changes](/pi-hole/web/pull/1443/files)

[scripts/pi-hole/js/utils.js](/pi-hole/web/pull/1443/files#diff-64d6035b279e2213d7d58dd3e4e5cc20ba3b2c219a5c19a53f306236f07f8d31)
Outdated

Show resolved

Hide resolved

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
requested a review
from [XhmikosR](/XhmikosR)
[June 6, 2020 11:24](#event-3414596006)

[![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=80&u=7a5274e187f0b3476d3d1ea2ad2f9974a8bca846&v=4)](/XhmikosR)

Copy link

Contributor

### **[XhmikosR](/XhmikosR)** commented [Jun 8, 2020](#issuecomment-640394234) • edited Loading

| You need to include `utils.js` in `dns_records.php` before `ip-address-sorting.js`.  I still need to test this myself before approving. |
| --- |

All reactions

Sorry, something went wrong.

[![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=80&u=7a5274e187f0b3476d3d1ea2ad2f9974a8bca846&v=4)](/XhmikosR)

Copy link

Contributor

### **[XhmikosR](/XhmikosR)** commented [Jun 8, 2020](#issuecomment-640686007)

| I only tested group-domains.php and it seems to work. Someone should try the other pages just to be sure. |
| --- |

All reactions

Sorry, something went wrong.

[![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=40&u=7a5274e187f0b3476d3d1ea2ad2f9974a8bca846&v=4)](/XhmikosR)
[XhmikosR](/XhmikosR)
added
the
[Security](/pi-hole/web/labels/Security)
label
[Jun 8, 2020](#event-3420532240)

[![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=40&u=7a5274e187f0b3476d3d1ea2ad2f9974a8bca846&v=4)](/XhmikosR)
[XhmikosR](/XhmikosR)
added this to the [v5.1](/pi-hole/web/milestone/23) milestone
[Jun 8, 2020](#event-3420532701)

[![XhmikosR](https://avatars.githubusercontent.com/u/349621?s=60&v=4)](/XhmikosR)

**[XhmikosR](/XhmikosR)**
previously approved these changes
[Jun 8, 2020](#pullrequestreview-426333237)

 [View reviewed changes](/pi-hole/web/pull/1443/files)

[![XhmikosR](https://avatars.githubusercontent.com/u/349621?s=60&v=4)](/XhmikosR)

**[XhmikosR](/XhmikosR)**
reviewed
[Jun 8, 2020](#pullrequestreview-426335392)

 [View reviewed changes](/pi-hole/web/pull/1443/files)

[scripts/pi-hole/php/groups.php](/pi-hole/web/pull/1443/files#diff-8d18abbe77d19d00dbe4dbe76db69ec925fb010449a4b6d54c2e8dce9c0ddb0f)
Outdated

Show resolved

Hide resolved

[![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=80&u=7a5274e187f0b3476d3d1ea2ad2f9974a8bca846&v=4)](/XhmikosR)

Copy link

Contributor

### **[XhmikosR](/XhmikosR)** commented [Jun 8, 2020](#issuecomment-640693675) via email

| We should prefer the built in solution assuming it works the same IMHO because it's tested and works for everything, not just quotes. … On Mon, Jun 8, 2020, 18:11 Adam Warner \*\*\*@\*\*\*.\*\*\*> wrote: \*\*\*@\*\*\*.\*\*\*\* commented on this pull request. ------------------------------ In scripts/pi-hole/php/groups.php <[#1443 (comment)](https://github.com/pi-hole/web/pull/1443#discussion_r436783867)>: > @@ -58,7 +58,10 @@ function JSON\_error($message = null) } elseif ($\_POST['action'] == 'add\_group') { // Add new group try { - $names = str\_getcsv(trim($\_POST['name']), ' '); + // Payload from the web interface will have been sanitised with " converted to &quot; + // so before we process the input, we will do the opposite and replace &quot; with "; + $input = str\_replace("&quot;","\"",trim($\_POST['name'])); Fair shout, I didn't know of it's existence before now. Either or works in this case. — You are receiving this because your review was requested. Reply to this email directly, view it on GitHub <[#1443 (comment)](https://github.com/pi-hole/web/pull/1443#discussion_r436783867)>, or unsubscribe <<https://github.com/notifications/unsubscribe-auth/AACVLNIIUSZU22FUWR3X423RVT5TNANCNFSM4NVCBUOQ>> . |
| --- |

All reactions

Sorry, something went wrong.

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
marked this pull request as draft
[June 8, 2020 15:50](#event-3420794179)

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
dismissed
[XhmikosR](/XhmikosR)’s [stale review](#pullrequestreview-426333237)
via
`[b6224b2](/pi-hole/web/commit/b6224b2864d84490846049ff33113c44f836867c)`
[June 8, 2020 16:18](#event-3420919005)

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
marked this pull request as ready for review
[June 8, 2020 16:19](#event-3420924131)

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
requested a review
from [XhmikosR](/XhmikosR)
[June 8, 2020 16:19](#event-3420924655)

[![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=80&u=7a5274e187f0b3476d3d1ea2ad2f9974a8bca846&v=4)](/XhmikosR)

Copy link

Contributor

### **[XhmikosR](/XhmikosR)** commented [Jun 8, 2020](#issuecomment-640764276)

| I'd like [@DL6ER](https://github.com/DL6ER) to confirm the database-related code. For example I see this from the [PHP page](https://www.php.net/manual/en/function.html-entity-decode.php):  Although this argument is technically optional, you are highly encouraged to specify the correct value for your code if you are using PHP 5.5 or earlier, or if your [default\_charset](https://www.php.net/manual/en/ini.core.php#ini.default-charset) configuration option may be set incorrectly for the given input.  I will try the branch again tomorrow, and try to review all JS code in those files. |
| --- |

All reactions

Sorry, something went wrong.

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=80&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)

Copy link

Member

Author

### **[PromoFaux](/PromoFaux)** commented [Jun 8, 2020](#issuecomment-640920508) • edited Loading

| [1c5bbc1](https://github.com/pi-hole/web/commit/1c5bbc1f92c85ccd465969985172ce3d4b8db3c0) prevents an (unlikely, but possible) attack vector:  Given the following entry in the static lease file:  ``` dhcp-host=AA:BB:CC:DD:EF:FF,192.168.1.1,<script>alert("hello")</script>  ```  Before patch:  [image](https://user-images.githubusercontent.com/1998970/84086295-74c39f80-a9df-11ea-8f00-b0eed0115246.png)  [image](https://user-images.githubusercontent.com/1998970/84086305-7a20ea00-a9df-11ea-9af7-116f180b7c5b.png)  After patch script is no longer run:  [image](https://user-images.githubusercontent.com/1998970/84086346-9886e580-a9df-11ea-8eb7-29add1d53e72.png) |
| --- |

All reactions

Sorry, something went wrong.

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
[force-pushed](/pi-hole/web/compare/f3dbc4ca9a884e1cc19ab2ac918af6ba93bf5dd7..1c5bbc1f92c85ccd465969985172ce3d4b8db3c0)
the
sanitise-group-input

branch
2 times, most recently
from
[`f3dbc4c`](/pi-hole/web/commit/f3dbc4ca9a884e1cc19ab2ac918af6ba93bf5dd7) to
[`1c5bbc1`](/pi-hole/web/commit/1c5bbc1f92c85ccd465969985172ce3d4b8db3c0)  [Compare](/pi-hole/web/compare/f3dbc4ca9a884e1cc19ab2ac918af6ba93bf5dd7..1c5bbc1f92c85ccd465969985172ce3d4b8db3c0)
[June 8, 2020 22:34](#event-3422274361)

[![@DL6ER](https://avatars.githubusercontent.com/u/16748619?s=80&u=ce6c1349a64ffbe006bee3cd89cb172f8f1f673f&v=4)](/DL6ER)

Copy link

Member

### **[DL6ER](/DL6ER)** commented [Jun 10, 2020](#issuecomment-641931473)

| [@XhmikosR](https://github.com/XhmikosR) I cannot test anything until beginning/mid of next week. I fully trust [@PromoFaux](https://github.com/PromoFaux) to be aware of any database-related issues that might be there. Note that it is planed to drop any SQL stuff from the web interface for Pi-hole v6.0 and to shift any list manipulations into the API (provided by FTL). This to reduce the number of places where stuff can get changed and where write-access is needed. |
| --- |

 👍
1
 PromoFaux reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=80&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)

Copy link

Member

Author

### **[PromoFaux](/PromoFaux)** commented [Jun 10, 2020](#issuecomment-641932229)

| There are a couple more places I want to check before merging (see my screenshots on mattermost for more info) |
| --- |

All reactions

Sorry, something went wrong.

 [![@DL6ER](https://avatars.githubusercontent.com/u/16748619?s=40&u=ce6c1349a64ffbe006bee3cd89cb172f8f1f673f&v=4)](/DL6ER)
[DL6ER](/DL6ER)
marked this pull request as draft
[June 10, 2020 14:02](#event-3429807185)

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&v=4)](/PromoFaux)

`[make use of utils.escapeHtml on the JS side of things, and html_entit…](/pi-hole/web/pull/1443/commits/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69 "make use of utils.escapeHtml on the JS side of things, and html_entity_decode/htmlentities in PHP

Signed-off-by: Adam Warner <me@adamwarner.co.uk>")`
 …

`[c949516](/pi-hole/web/pull/1443/commits/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69)`

```
…y_decode/htmlentities in PHP

Signed-off-by: Adam Warner <me@adamwarner.co.uk>
```

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
[force-pushed](/pi-hole/web/compare/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5..c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69)
the
sanitise-group-input

branch
from
[`8f6e136`](/pi-hole/web/commit/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5) to
[`c949516`](/pi-hole/web/commit/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69)  [Compare](/pi-hole/web/compare/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5..c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69)
[June 13, 2020 17:51](#event-3441001949)

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
marked this pull request as ready for review
[June 13, 2020 17:53](#event-3441004805)

[![DL6ER](https://avatars.githubusercontent.com/u/16748619?s=60&v=4)](/DL6ER)

**[DL6ER](/DL6ER)**
approved these changes
[Jun 14, 2020](#pullrequestreview-430243544)

 [View reviewed changes](/pi-hole/web/pull/1443/files/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69)

Copy link

Member

### @DL6ER **[DL6ER](/DL6ER)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Tested and found no oddities.

Sorry, something went wrong.

All reactions

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
merged commit [`d187219`](/pi-hole/web/commit/d187219f5a901bd3a1bc9825d0a6155e4c284f59)
into
devel

[Jun 14, 2020](https://github.com/pi-hole/web/pull/1443#event-3442094134)

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
deleted the
sanitise-group-input

branch
[June 14, 2020 22:25](#event-3442094149)

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=80&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)

Copy link

Member

Author

### **[PromoFaux](/PromoFaux)** commented [Jun 14, 2020](#issuecomment-643830404)

| Thanks to Dino at @telspacesystems and also [@spartacvs](https://github.com/spartacvs) for reporting the issues that lead to this PR |
| --- |

 👍
2
 spartacvs and telspaceafrica reacted with thumbs up emoji
 😄
1
 telspaceafrica reacted with laugh emoji

All reactions

* 👍
  2 reactions
* 😄
  1 reaction

Sorry, something went wrong.

[![@iasdeoupxe](https://avatars.githubusercontent.com/u/39667843?s=80&v=4)](/iasdeoupxe)

Copy link

### **[iasdeoupxe](/iasdeoupxe)** commented [Jun 27, 2020](#issuecomment-650567934)

| [CVE-2020-14971](https://github.com/advisories/GHSA-wjqw-p6cv-p8gj "CVE-2020-14971") seems got assigned for this issue:  <https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html> |
| --- |

 👍
2
 telspaceafrica and spartacvs reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
mentioned this pull request
[Jul 5, 2020](#ref-pullrequest-651061941)

[Pi-hole web v5.1
#1480](/pi-hole/web/pull/1480)
 Merged

[![@pralor-bot](https://avatars.githubusercontent.com/u/36384445?s=80&u=67cabd2b6a3014c4c900da51299305773d494fec&v=4)](/pralor-bot)

Copy link

### **[pralor-bot](/pralor-bot)** commented [Jul 15, 2020](#issuecomment-659030348)

| This pull request has been mentioned on **Pi-hole Userspace**. There might be relevant details there:  <https://discourse.pi-hole.net/t/pi-hole-5-1-released/35577/1> |
| --- |

All reactions

Sorry, something went wrong.

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
mentioned this pull request
[Oct 5, 2020](#ref-pullrequest-714790801)

[Fixes issue with Apostrophe turning into &#039;
#1599](/pi-hole/web/pull/1599)
 Closed

9 tasks

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
mentioned this pull request
[Oct 12, 2020](#ref-pullrequest-719542562)

[Fix html escaping showing up in input fields. (#1584)
#1603](/pi-hole/web/pull/1603)
 Merged

9 tasks

[![@yubiuser](https://avatars.githubusercontent.com/u/26622301?s=40&v=4)](/yubiuser)
[yubiuser](/yubiuser)
mentioned this pull request
[Oct 4, 2021](#ref-pullrequest-1015430448)

[Unescape German umlauts
#1914](/pi-hole/web/pull/1914)
 Merged

9 tasks

[![@yubiuser](https://avatars.githubusercontent.com/u/26622301?s=40&v=4)](/yubiuser)
[yubiuser](/yubiuser)
mentioned this pull request
[Oct 20, 2021](#ref-issue-1028686537)

[Teleporter: use of apostrophes results with clients desc "&#039;" and adlists desc "&amp;#039;"
#1928](/pi-hole/web/issues/1928)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Fpull%2F1443)

Reviewers

[![@DL6ER](https://avatars.githubusercontent.com/u/16748619?s=40&v=4)](/DL6ER) [DL6ER](/DL6ER)

DL6ER approved these changes

[![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=40&v=4)](/XhmikosR) [XhmikosR](/XhmikosR)

 Awaiting requested review from XhmikosR

Assignees

No one assigned

Labels

[Security](/pi-hole/web/labels/Security)

Projects

None yet

Milestone

 [**v5.1**](/pi-hole/web/milestone/23 "v5.1")

Development

Successfully merging this pull request may close these issues.

5 participants

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=52&v=4)](/PromoFaux) [![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=52&v=4)](/XhmikosR) [![@DL6ER](https://avatars.githubusercontent.com/u/16748619?s=52&v=4)](/DL6ER) [![@iasdeoupxe](https://avatars.githubusercontent.com/u/39667843?s=52&v=4)](/iasdeoupxe) [![@pralor-bot](https://avatars.githubusercontent.com/u/36384445?s=52&v=4)](/pralor-bot)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_83c712f9_20250119_122415.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Fpull%2F1443)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Fpull%2F1443)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=pi-hole%2Fweb)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pi-hole](/pi-hole)
/
**[web](/pi-hole/web)**
Public

* [Notifications](/login?return_to=%2Fpi-hole%2Fweb) You must be signed in to change notification settings
* [Fork
  566](/login?return_to=%2Fpi-hole%2Fweb)
* [Star
   2.1k](/login?return_to=%2Fpi-hole%2Fweb)

* [Code](/pi-hole/web)
* [Issues
  19](/pi-hole/web/issues)
* [Pull requests
  8](/pi-hole/web/pulls)
* [Actions](/pi-hole/web/actions)
* [Projects
  1](/pi-hole/web/projects)
* [Security](/pi-hole/web/security)
* [Insights](/pi-hole/web/pulse)

Additional navigation options

* [Code](/pi-hole/web)
* [Issues](/pi-hole/web/issues)
* [Pull requests](/pi-hole/web/pulls)
* [Actions](/pi-hole/web/actions)
* [Projects](/pi-hole/web/projects)
* [Security](/pi-hole/web/security)
* [Insights](/pi-hole/web/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpi-hole%2Fweb%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpi-hole%2Fweb%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Prevent possible XSS attack vector in the input fields of the group section #1443

 Merged

[PromoFaux](/PromoFaux)
merged 1 commit into
[devel](/pi-hole/web/tree/devel "pi-hole/web:devel")
from
[sanitise-group-input](/pi-hole/web/tree/sanitise-group-input "pi-hole/web:sanitise-group-input")

Jun 14, 2020

 Merged

# [Prevent possible XSS attack vector in the input fields of the group section](#top) #1443

[PromoFaux](/PromoFaux)
merged 1 commit into
[devel](/pi-hole/web/tree/devel "pi-hole/web:devel")
from
[sanitise-group-input](/pi-hole/web/tree/sanitise-group-input "pi-hole/web:sanitise-group-input")

Jun 14, 2020

[Conversation
15](/pi-hole/web/pull/1443)
[Commits
1](/pi-hole/web/pull/1443/commits)
[Checks
0](/pi-hole/web/pull/1443/checks)
[Files changed](/pi-hole/web/pull/1443/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=60&v=4)](/PromoFaux)

Copy link

Member

### @PromoFaux **[PromoFaux](/PromoFaux)** commented [Jun 5, 2020](#issue-631900867)

**By submitting this pull request, I confirm the following:**

* I have read and understood the [contributors guide](https://github.com/pi-hole/pi-hole/blob/master/CONTRIBUTING.md), as well as this entire template.
* I have made only one major change in my proposed changes.
* I have commented my proposed changes within the code.
* I have tested my proposed changes, and have included unit tests where possible.
* I am willing to help maintain this change if there are issues with it later.
* I give this submission freely and claim no ownership.
* It is compatible with the [EUPL 1.2 license](https://opensource.org/licenses/EUPL-1.1)
* I have squashed any insignificant commits. ([`git rebase`](http://gitready.com/advanced/2009/02/10/squashing-commits-with-rebase.html))

---

**What does this PR aim to accomplish?:**

Calls the already existing `utils.escapeHtml()` to make sure nothing is executed. Works independent of CSP changes

Sorry, something went wrong.

All reactions

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
requested review from
[XhmikosR](/XhmikosR) and
[DL6ER](/DL6ER)
[June 5, 2020 19:53](#event-3412980011)

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
[force-pushed](/pi-hole/web/compare/b2b56711d844d9be3842717017c5fde1f548b80d..29a1e456cd3b712e0f98109fd259c2b00d86c89c)
the
sanitise-group-input

branch
from
[`b2b5671`](/pi-hole/web/commit/b2b56711d844d9be3842717017c5fde1f548b80d) to
[`29a1e45`](/pi-hole/web/commit/29a1e456cd3b712e0f98109fd259c2b00d86c89c)  [Compare](/pi-hole/web/compare/b2b56711d844d9be3842717017c5fde1f548b80d..29a1e456cd3b712e0f98109fd259c2b00d86c89c)
[June 5, 2020 19:55](#event-3412990578)

[![XhmikosR](https://avatars.githubusercontent.com/u/349621?s=60&v=4)](/XhmikosR)

**[XhmikosR](/XhmikosR)**
reviewed
[Jun 6, 2020](#pullrequestreview-425715167)

 [View reviewed changes](/pi-hole/web/pull/1443/files)

[scripts/pi-hole/js/utils.js](/pi-hole/web/pull/1443/files#diff-64d6035b279e2213d7d58dd3e4e5cc20ba3b2c219a5c19a53f306236f07f8d31)
Outdated

Show resolved

Hide resolved

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
requested a review
from [XhmikosR](/XhmikosR)
[June 6, 2020 11:24](#event-3414596006)

[![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=80&u=7a5274e187f0b3476d3d1ea2ad2f9974a8bca846&v=4)](/XhmikosR)

Copy link

Contributor

### **[XhmikosR](/XhmikosR)** commented [Jun 8, 2020](#issuecomment-640394234) • edited Loading

| You need to include `utils.js` in `dns_records.php` before `ip-address-sorting.js`.  I still need to test this myself before approving. |
| --- |

All reactions

Sorry, something went wrong.

[![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=80&u=7a5274e187f0b3476d3d1ea2ad2f9974a8bca846&v=4)](/XhmikosR)

Copy link

Contributor

### **[XhmikosR](/XhmikosR)** commented [Jun 8, 2020](#issuecomment-640686007)

| I only tested group-domains.php and it seems to work. Someone should try the other pages just to be sure. |
| --- |

All reactions

Sorry, something went wrong.

[![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=40&u=7a5274e187f0b3476d3d1ea2ad2f9974a8bca846&v=4)](/XhmikosR)
[XhmikosR](/XhmikosR)
added
the
[Security](/pi-hole/web/labels/Security)
label
[Jun 8, 2020](#event-3420532240)

[![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=40&u=7a5274e187f0b3476d3d1ea2ad2f9974a8bca846&v=4)](/XhmikosR)
[XhmikosR](/XhmikosR)
added this to the [v5.1](/pi-hole/web/milestone/23) milestone
[Jun 8, 2020](#event-3420532701)

[![XhmikosR](https://avatars.githubusercontent.com/u/349621?s=60&v=4)](/XhmikosR)

**[XhmikosR](/XhmikosR)**
previously approved these changes
[Jun 8, 2020](#pullrequestreview-426333237)

 [View reviewed changes](/pi-hole/web/pull/1443/files)

[![XhmikosR](https://avatars.githubusercontent.com/u/349621?s=60&v=4)](/XhmikosR)

**[XhmikosR](/XhmikosR)**
reviewed
[Jun 8, 2020](#pullrequestreview-426335392)

 [View reviewed changes](/pi-hole/web/pull/1443/files)

[scripts/pi-hole/php/groups.php](/pi-hole/web/pull/1443/files#diff-8d18abbe77d19d00dbe4dbe76db69ec925fb010449a4b6d54c2e8dce9c0ddb0f)
Outdated

Show resolved

Hide resolved

[![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=80&u=7a5274e187f0b3476d3d1ea2ad2f9974a8bca846&v=4)](/XhmikosR)

Copy link

Contributor

### **[XhmikosR](/XhmikosR)** commented [Jun 8, 2020](#issuecomment-640693675) via email

| We should prefer the built in solution assuming it works the same IMHO because it's tested and works for everything, not just quotes. … On Mon, Jun 8, 2020, 18:11 Adam Warner \*\*\*@\*\*\*.\*\*\*> wrote: \*\*\*@\*\*\*.\*\*\*\* commented on this pull request. ------------------------------ In scripts/pi-hole/php/groups.php <[#1443 (comment)](https://github.com/pi-hole/web/pull/1443#discussion_r436783867)>: > @@ -58,7 +58,10 @@ function JSON\_error($message = null) } elseif ($\_POST['action'] == 'add\_group') { // Add new group try { - $names = str\_getcsv(trim($\_POST['name']), ' '); + // Payload from the web interface will have been sanitised with " converted to &quot; + // so before we process the input, we will do the opposite and replace &quot; with "; + $input = str\_replace("&quot;","\"",trim($\_POST['name'])); Fair shout, I didn't know of it's existence before now. Either or works in this case. — You are receiving this because your review was requested. Reply to this email directly, view it on GitHub <[#1443 (comment)](https://github.com/pi-hole/web/pull/1443#discussion_r436783867)>, or unsubscribe <<https://github.com/notifications/unsubscribe-auth/AACVLNIIUSZU22FUWR3X423RVT5TNANCNFSM4NVCBUOQ>> . |
| --- |

All reactions

Sorry, something went wrong.

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
marked this pull request as draft
[June 8, 2020 15:50](#event-3420794179)

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
dismissed
[XhmikosR](/XhmikosR)’s [stale review](#pullrequestreview-426333237)
via
`[b6224b2](/pi-hole/web/commit/b6224b2864d84490846049ff33113c44f836867c)`
[June 8, 2020 16:18](#event-3420919005)

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
marked this pull request as ready for review
[June 8, 2020 16:19](#event-3420924131)

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
requested a review
from [XhmikosR](/XhmikosR)
[June 8, 2020 16:19](#event-3420924655)

[![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=80&u=7a5274e187f0b3476d3d1ea2ad2f9974a8bca846&v=4)](/XhmikosR)

Copy link

Contributor

### **[XhmikosR](/XhmikosR)** commented [Jun 8, 2020](#issuecomment-640764276)

| I'd like [@DL6ER](https://github.com/DL6ER) to confirm the database-related code. For example I see this from the [PHP page](https://www.php.net/manual/en/function.html-entity-decode.php):  Although this argument is technically optional, you are highly encouraged to specify the correct value for your code if you are using PHP 5.5 or earlier, or if your [default\_charset](https://www.php.net/manual/en/ini.core.php#ini.default-charset) configuration option may be set incorrectly for the given input.  I will try the branch again tomorrow, and try to review all JS code in those files. |
| --- |

All reactions

Sorry, something went wrong.

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=80&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)

Copy link

Member

Author

### **[PromoFaux](/PromoFaux)** commented [Jun 8, 2020](#issuecomment-640920508) • edited Loading

| [1c5bbc1](https://github.com/pi-hole/web/commit/1c5bbc1f92c85ccd465969985172ce3d4b8db3c0) prevents an (unlikely, but possible) attack vector:  Given the following entry in the static lease file:  ``` dhcp-host=AA:BB:CC:DD:EF:FF,192.168.1.1,<script>alert("hello")</script>  ```  Before patch:  [image](https://user-images.githubusercontent.com/1998970/84086295-74c39f80-a9df-11ea-8f00-b0eed0115246.png)  [image](https://user-images.githubusercontent.com/1998970/84086305-7a20ea00-a9df-11ea-9af7-116f180b7c5b.png)  After patch script is no longer run:  [image](https://user-images.githubusercontent.com/1998970/84086346-9886e580-a9df-11ea-8eb7-29add1d53e72.png) |
| --- |

All reactions

Sorry, something went wrong.

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
[force-pushed](/pi-hole/web/compare/f3dbc4ca9a884e1cc19ab2ac918af6ba93bf5dd7..1c5bbc1f92c85ccd465969985172ce3d4b8db3c0)
the
sanitise-group-input

branch
2 times, most recently
from
[`f3dbc4c`](/pi-hole/web/commit/f3dbc4ca9a884e1cc19ab2ac918af6ba93bf5dd7) to
[`1c5bbc1`](/pi-hole/web/commit/1c5bbc1f92c85ccd465969985172ce3d4b8db3c0)  [Compare](/pi-hole/web/compare/f3dbc4ca9a884e1cc19ab2ac918af6ba93bf5dd7..1c5bbc1f92c85ccd465969985172ce3d4b8db3c0)
[June 8, 2020 22:34](#event-3422274361)

[![@DL6ER](https://avatars.githubusercontent.com/u/16748619?s=80&u=ce6c1349a64ffbe006bee3cd89cb172f8f1f673f&v=4)](/DL6ER)

Copy link

Member

### **[DL6ER](/DL6ER)** commented [Jun 10, 2020](#issuecomment-641931473)

| [@XhmikosR](https://github.com/XhmikosR) I cannot test anything until beginning/mid of next week. I fully trust [@PromoFaux](https://github.com/PromoFaux) to be aware of any database-related issues that might be there. Note that it is planed to drop any SQL stuff from the web interface for Pi-hole v6.0 and to shift any list manipulations into the API (provided by FTL). This to reduce the number of places where stuff can get changed and where write-access is needed. |
| --- |

 👍
1
 PromoFaux reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=80&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)

Copy link

Member

Author

### **[PromoFaux](/PromoFaux)** commented [Jun 10, 2020](#issuecomment-641932229)

| There are a couple more places I want to check before merging (see my screenshots on mattermost for more info) |
| --- |

All reactions

Sorry, something went wrong.

 [![@DL6ER](https://avatars.githubusercontent.com/u/16748619?s=40&u=ce6c1349a64ffbe006bee3cd89cb172f8f1f673f&v=4)](/DL6ER)
[DL6ER](/DL6ER)
marked this pull request as draft
[June 10, 2020 14:02](#event-3429807185)

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&v=4)](/PromoFaux)

`[make use of utils.escapeHtml on the JS side of things, and html_entit…](/pi-hole/web/pull/1443/commits/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69 "make use of utils.escapeHtml on the JS side of things, and html_entity_decode/htmlentities in PHP

Signed-off-by: Adam Warner <me@adamwarner.co.uk>")`
 …

`[c949516](/pi-hole/web/pull/1443/commits/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69)`

```
…y_decode/htmlentities in PHP

Signed-off-by: Adam Warner <me@adamwarner.co.uk>
```

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
[force-pushed](/pi-hole/web/compare/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5..c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69)
the
sanitise-group-input

branch
from
[`8f6e136`](/pi-hole/web/commit/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5) to
[`c949516`](/pi-hole/web/commit/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69)  [Compare](/pi-hole/web/compare/8f6e1365b6dec0ae1aa0b0b15b102c9133f347e5..c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69)
[June 13, 2020 17:51](#event-3441001949)

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
marked this pull request as ready for review
[June 13, 2020 17:53](#event-3441004805)

[![DL6ER](https://avatars.githubusercontent.com/u/16748619?s=60&v=4)](/DL6ER)

**[DL6ER](/DL6ER)**
approved these changes
[Jun 14, 2020](#pullrequestreview-430243544)

 [View reviewed changes](/pi-hole/web/pull/1443/files/c949516ee15fa6a9b0c8511cc4c4d6b0893f3e69)

Copy link

Member

### @DL6ER **[DL6ER](/DL6ER)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Tested and found no oddities.

Sorry, something went wrong.

All reactions

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
merged commit [`d187219`](/pi-hole/web/commit/d187219f5a901bd3a1bc9825d0a6155e4c284f59)
into
devel

[Jun 14, 2020](https://github.com/pi-hole/web/pull/1443#event-3442094134)

 [![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
deleted the
sanitise-group-input

branch
[June 14, 2020 22:25](#event-3442094149)

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=80&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)

Copy link

Member

Author

### **[PromoFaux](/PromoFaux)** commented [Jun 14, 2020](#issuecomment-643830404)

| Thanks to Dino at @telspacesystems and also [@spartacvs](https://github.com/spartacvs) for reporting the issues that lead to this PR |
| --- |

 👍
2
 spartacvs and telspaceafrica reacted with thumbs up emoji
 😄
1
 telspaceafrica reacted with laugh emoji

All reactions

* 👍
  2 reactions
* 😄
  1 reaction

Sorry, something went wrong.

[![@iasdeoupxe](https://avatars.githubusercontent.com/u/39667843?s=80&v=4)](/iasdeoupxe)

Copy link

### **[iasdeoupxe](/iasdeoupxe)** commented [Jun 27, 2020](#issuecomment-650567934)

| [CVE-2020-14971](https://github.com/advisories/GHSA-wjqw-p6cv-p8gj "CVE-2020-14971") seems got assigned for this issue:  <https://blog.telspace.co.za/2020/06/pi-hole-code-injection-cve-2020-14971.html> |
| --- |

 👍
2
 telspaceafrica and spartacvs reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
mentioned this pull request
[Jul 5, 2020](#ref-pullrequest-651061941)

[Pi-hole web v5.1
#1480](/pi-hole/web/pull/1480)
 Merged

[![@pralor-bot](https://avatars.githubusercontent.com/u/36384445?s=80&u=67cabd2b6a3014c4c900da51299305773d494fec&v=4)](/pralor-bot)

Copy link

### **[pralor-bot](/pralor-bot)** commented [Jul 15, 2020](#issuecomment-659030348)

| This pull request has been mentioned on **Pi-hole Userspace**. There might be relevant details there:  <https://discourse.pi-hole.net/t/pi-hole-5-1-released/35577/1> |
| --- |

All reactions

Sorry, something went wrong.

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
mentioned this pull request
[Oct 5, 2020](#ref-pullrequest-714790801)

[Fixes issue with Apostrophe turning into &#039;
#1599](/pi-hole/web/pull/1599)
 Closed

9 tasks

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=40&u=b881a72d6ad3e682df87c3f9caf3b8359572f4ed&v=4)](/PromoFaux)
[PromoFaux](/PromoFaux)
mentioned this pull request
[Oct 12, 2020](#ref-pullrequest-719542562)

[Fix html escaping showing up in input fields. (#1584)
#1603](/pi-hole/web/pull/1603)
 Merged

9 tasks

[![@yubiuser](https://avatars.githubusercontent.com/u/26622301?s=40&v=4)](/yubiuser)
[yubiuser](/yubiuser)
mentioned this pull request
[Oct 4, 2021](#ref-pullrequest-1015430448)

[Unescape German umlauts
#1914](/pi-hole/web/pull/1914)
 Merged

9 tasks

[![@yubiuser](https://avatars.githubusercontent.com/u/26622301?s=40&v=4)](/yubiuser)
[yubiuser](/yubiuser)
mentioned this pull request
[Oct 20, 2021](#ref-issue-1028686537)

[Teleporter: use of apostrophes results with clients desc "&#039;" and adlists desc "&amp;#039;"
#1928](/pi-hole/web/issues/1928)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fpi-hole%2Fweb%2Fpull%2F1443)

Reviewers

[![@DL6ER](https://avatars.githubusercontent.com/u/16748619?s=40&v=4)](/DL6ER) [DL6ER](/DL6ER)

DL6ER approved these changes

[![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=40&v=4)](/XhmikosR) [XhmikosR](/XhmikosR)

 Awaiting requested review from XhmikosR

Assignees

No one assigned

Labels

[Security](/pi-hole/web/labels/Security)

Projects

None yet

Milestone

 [**v5.1**](/pi-hole/web/milestone/23 "v5.1")

Development

Successfully merging this pull request may close these issues.

5 participants

[![@PromoFaux](https://avatars.githubusercontent.com/u/1998970?s=52&v=4)](/PromoFaux) [![@XhmikosR](https://avatars.githubusercontent.com/u/349621?s=52&v=4)](/XhmikosR) [![@DL6ER](https://avatars.githubusercontent.com/u/16748619?s=52&v=4)](/DL6ER) [![@iasdeoupxe](https://avatars.githubusercontent.com/u/39667843?s=52&v=4)](/iasdeoupxe) [![@pralor-bot](https://avatars.githubusercontent.com/u/36384445?s=52&v=4)](/pralor-bot)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


