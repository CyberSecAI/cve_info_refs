=== Content from access.redhat.com_6416f931_20250119_133522.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.redhat.com_6c9e1b81_20250119_114724.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3DCVE-2020-14304)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3DCVE-2020-14304)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3DCVE-2020-14304)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1847539

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1847539**](show_bug.cgi?id=1847539)
(CVE-2020-14304)
- [CVE-2020-14304](https://access.redhat.com/security/cve/CVE-2020-14304) kernel: ethtool when reading eeprom of device could lead to memory leak

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2020-14304 kernel: ethtool when reading eeprom of device could lead to me...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2020-14304 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1847557](show_bug.cgi?id=1847557 "CLOSED WONTFIX - CVE-2020-14304 kernel: ethtool when reading eeprom of device could lead to memory leak [fedora-all]") [1847596](show_bug.cgi?id=1847596) [1847597](show_bug.cgi?id=1847597) [1847598](show_bug.cgi?id=1847598) [1847599](show_bug.cgi?id=1847599) [1847600](show_bug.cgi?id=1847600) [1847601](show_bug.cgi?id=1847601) [1911198](show_bug.cgi?id=1911198) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1837276](show_bug.cgi?id=1837276) | | TreeView+ | [depends on](buglist.cgi?bug_id=1847539&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1847539&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2020-06-16 15:10 UTC by Alex | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2023-05-12 19:40 UTC ([History](show_activity.cgi?id=1847539)) | | [CC List:](page.cgi?id=fields.html#cclist) | 49 users (show)  acaringi airlied bhu blc bmasney brdeoliv bskeggs dhoward dvlasenk esammons fhrbata hdegoede hkrzesin iboverma ichavero itamar jarodwilson jeremy jforbes jglisse jlelli john.j5live jonathan josef jross jshortt jstancek jwboyer kcarcia kernel-maint kernel-mgr labbott lgoncalv linville masami256 matt mchehab mcressma mjg59 mlangsdo mleitner nmurray ptalbert qzhao rt-maint rvrbovsk steved walters williams | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A memory disclosure flaw was found in the Linux kernel's ethernet drivers, in the way it read data from the EEPROM of the device. This flaw allows a local user to read uninitialized values from the kernel memory. The highest threat from this vulnerability is to confidentiality. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2020-09-10 21:28:31 UTC | | | Embargoed: |  | | | Flags: | allarkin: needinfo+ | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1847539#c0)  Alex    2020-06-16 15:10:03 UTC  ``` If running ethtool for reading eeprom of device (param -m or param -e), it can lead to reading some uninitialized values from kernel memory. However, attacker can just read some unknown values from drivers memory, but cannot control what and where reads and these values related to the driver only. Attacker cannot affect availability and cannot make any other higher impact than such reading.  The rate of issue is low both because need root access for running "ethtool -m/-e" and because it can work only for some specific network drivers.  The suggested patch: <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=960702#70>   ```  [Comment 2](show_bug.cgi?id=1847539#c2)  Alex    2020-06-16 15:41:26 UTC  ``` Created kernel tracking bugs for this issue:  Affects: fedora-all [[bug 1847557](show_bug.cgi?id=1847557 "CLOSED WONTFIX - CVE-2020-14304 kernel: ethtool when reading eeprom of device could lead to memory leak [fedora-all]")]   ```  [Comment 6](show_bug.cgi?id=1847539#c6)  Alex    2020-06-17 18:48:52 UTC  ``` Statement:  This issue is rated as having Low impact because of being limited to only reading some of the values from the memory of some particular drivers and very limited kernel stack exposure.   ```  [Comment 7](show_bug.cgi?id=1847539#c7)  Alex    2020-06-17 18:48:56 UTC  ``` Mitigation:  Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.   ```  [Comment 10](show_bug.cgi?id=1847539#c10)  Petr Matousek    2020-06-24 12:23:43 UTC  ``` External References:  <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=960702>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1847539&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugs.debian.org_05c527de_20250119_114723.html ===

# Debian Bug report logs - #960702 ethtool -m values change when output is redirected

[![version graph](version.cgi?width=2;height=2;found=linux%2F5.6.7-1;found=linux%2F4.19.118-2;found=linux%2F4.9.210-1;package=src%3Alinux;absolute=0;collapse=1)](version.cgi?found=linux%2F5.6.7-1;found=linux%2F4.19.118-2;found=linux%2F4.9.210-1;info=1;package=src%3Alinux;collapse=1;absolute=0)

Package:
[src:linux](pkgreport.cgi?src=linux);
Maintainer for [src:linux](pkgreport.cgi?src=linux) is [Debian Kernel Team <debian-kernel@lists.debian.org>](pkgreport.cgi?maint=debian-kernel%40lists.debian.org);

Reported by: ["Yannis Aribaud" <bugs@d6bell.net>](pkgreport.cgi?submitter=bugs%40d6bell.net)

Date: Fri, 15 May 2020 15:21:01 UTC

Severity: important

Tags: upstream

Found in versions linux/5.6.7-1, linux/4.19.118-2, linux/4.9.210-1

Forwarded to [https://lore.kernel.org/netdev/20200517172053.GA734488@decadent.org.uk/T/](https://lore.kernel.org/netdev/20200517172053.GA734488%40decadent.org.uk/T/)

Reply or subscribe to this bug.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=960702;mbox=yes), [status mbox](bugreport.cgi?bug=960702;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=960702;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Kernel Team <debian-kernel@lists.debian.org>`:

`Bug#960702`; Package `ethtool`.
(Fri, 15 May 2020 15:21:03 GMT) ([full text](bugreport.cgi?bug=960702;msg=2), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `"Yannis Aribaud" <bugs@d6bell.net>`:

New Bug report received and forwarded. Copy sent to `Debian Kernel Team <debian-kernel@lists.debian.org>`.
(Fri, 15 May 2020 15:21:03 GMT) ([full text](bugreport.cgi?bug=960702;msg=4), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=960702;msg=5), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=bugs%40d6bell.net)
From: "Yannis Aribaud" <bugs@d6bell.net>
To: submit@bugs.debian.org
Subject: ethtool -m values change when output is redirected
Date: Fri, 15 May 2020 15:02:43 +0000
```
[[Message part 1](bugreport.cgi?att=0;bug=960702;msg=5) (text/plain, inline)]
```
```
Package: ethtool
Version: 1:4.19-1
Severity: important
I'm facing a very strange behavior. The command ethtool -m  report the transceiver DOM values correctly, but when the command output is redirected to an other program, values change to somthing else.

Here is a transcript:
root@localhost:~# ethtool -m enp10s0; echo -e 'nnn'; ethtool -m enp10s0 | cat
 Identifier : 0x03 (SFP)
 Extended identifier : 0x04 (GBIC/SFP defined by 2-wire interface ID)
 Connector : 0x07 (LC)
 Transceiver codes : 0x10 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00
 Transceiver type : 10G Ethernet: 10G Base-SR
 Encoding : 0x06 (64B/66B)
 BR, Nominal : 10300MBd
 Rate identifier : 0x00 (unspecified)
 Length (SMF,km) : 0km
 Length (SMF) : 0m
 Length (50um) : 80m
 Length (62.5um) : 20m
 Length (Copper) : 0m
 Length (OM3) : 300m
 Laser wavelength : 850nm
 Vendor name : Pureoptics
 Vendor OUI : 00:00:00
 Vendor PN : EX-SFP-10GE-SR
 Vendor rev : B4
 Option values : 0x00 0x1a
 Option : RX_LOS implemented
 Option : TX_FAULT implemented
 Option : TX_DISABLE implemented
 BR margin, max : 0%
 BR margin, min : 0%
 Vendor SN : M4351243
 Date code : 190515
 Optical diagnostics support : Yes
 Laser bias current : 16.480 mA
 Laser output power : 3.0768 mW / 4.88 dBm
 Receiver signal average optical power : 1.2298 mW / 0.90 dBm
 Module temperature : 48.47 degrees C / 119.24 degrees F
 Module voltage : 1.2336 V
 Alarm/warning flags implemented : Yes
 Laser bias current high alarm : Off
 Laser bias current low alarm : Off
 Laser bias current high warning : Off
 Laser bias current low warning : Off
 Laser output power high alarm : Off
 Laser output power low alarm : Off
 Laser output power high warning : Off
 Laser output power low warning : Off
 Module temperature high alarm : Off
 Module temperature low alarm : Off
 Module temperature high warning : Off
 Module temperature low warning : Off
 Module voltage high alarm : Off
 Module voltage low alarm : Off
 Module voltage high warning : Off
 Module voltage low warning : Off
 Laser rx power high alarm : Off
 Laser rx power low alarm : Off
 Laser rx power high warning : Off
 Laser rx power low warning : Off
 Laser bias current high alarm threshold : 4.744 mA
 Laser bias current low alarm threshold : 49.896 mA
 Laser bias current high warning threshold : 51.776 mA
 Laser bias current low warning threshold : 50.910 mA
 Laser output power high alarm threshold : 2.5701 mW / 4.10 dBm
 Laser output power low alarm threshold : 0.8224 mW / -0.85 dBm
 Laser output power high warning threshold : 0.8224 mW / -0.85 dBm
 Laser output power low warning threshold : 0.8224 mW / -0.85 dBm
 Module temperature high alarm threshold : 0.00 degrees C / 32.00 degrees F
 Module temperature low alarm threshold : 0.00 degrees C / 32.00 degrees F
 Module temperature high warning threshold : 0.00 degrees C / 32.00 degrees F
 Module temperature low warning threshold : 0.00 degrees C / 32.00 degrees F
 Module voltage high alarm threshold : 0.4356 V
 Module voltage low alarm threshold : 0.0000 V
 Module voltage high warning threshold : 0.0000 V
 Module voltage low warning threshold : 0.0000 V
 Laser rx power high alarm threshold : 0.8224 mW / -0.85 dBm
 Laser rx power low alarm threshold : 0.8224 mW / -0.85 dBm
 Laser rx power high warning threshold : 0.8224 mW / -0.85 dBm
 Laser rx power low warning threshold : 0.8224 mW / -0.85 dBm
 Identifier : 0x03 (SFP)
 Extended identifier : 0x04 (GBIC/SFP defined by 2-wire interface ID)
 Connector : 0x07 (LC)
 Transceiver codes : 0x10 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00
 Transceiver type : 10G Ethernet: 10G Base-SR
 Encoding : 0x06 (64B/66B)
 BR, Nominal : 10300MBd
 Rate identifier : 0x00 (unspecified)
 Length (SMF,km) : 0km
 Length (SMF) : 0m
 Length (50um) : 80m
 Length (62.5um) : 20m
 Length (Copper) : 0m
 Length (OM3) : 300m
 Laser wavelength : 850nm
 Vendor name : Pureoptics
 Vendor OUI : 00:00:00
 Vendor PN : EX-SFP-10GE-SR
 Vendor rev : B4
 Option values : 0x00 0x1a
 Option : RX_LOS implemented
 Option : TX_FAULT implemented
 Option : TX_DISABLE implemented
 BR margin, max : 0%
 BR margin, min : 0%
 Vendor SN : M4351243
 Date code : 190515
 Optical diagnostics support : Yes
 Laser bias current : 16.448 mA
 Laser output power : 0.8224 mW / -0.85 dBm
 Receiver signal average optical power : 0.8224 mW / -0.85 dBm
 Module temperature : 32.12 degrees C / 89.83 degrees F
 Module voltage : 0.8224 V
 Alarm/warning flags implemented : Yes
 Laser bias current high alarm : Off
 Laser bias current low alarm : Off
 Laser bias current high warning : Off
 Laser bias current low warning : Off
 Laser output power high alarm : Off
 Laser output power low alarm : Off
 Laser output power high warning : Off
 Laser output power low warning : Off
 Module temperature high alarm : Off
 Module temperature low alarm : Off
 Module temperature high warning : Off
 Module temperature low warning : Off
 Module voltage high alarm : On
 Module voltage low alarm : Off
 Module voltage high warning : On
 Module voltage low warning : Off
 Laser rx power high alarm : Off
 Laser rx power low alarm : Off
 Laser rx power high warning : Off
 Laser rx power low warning : Off
 Laser bias current high alarm threshold : 4.754 mA
 Laser bias current low alarm threshold : 51.402 mA
 Laser bias current high warning threshold : 56.552 mA
 Laser bias current low warning threshold : 53.964 mA
 Laser output power high alarm threshold : 2.6981 mW / 4.31 dBm
 Laser output power low alarm threshold : 2.9216 mW / 4.66 dBm
 Laser output power high warning threshold : 0.8224 mW / -0.85 dBm
 Laser output power low warning threshold : 0.8224 mW / -0.85 dBm
 Module temperature high alarm threshold : 0.00 degrees C / 32.00 degrees F
 Module temperature low alarm threshold : 0.00 degrees C / 32.00 degrees F
 Module temperature high warning threshold : 0.00 degrees C / 32.00 degrees F
 Module temperature low warning threshold : 0.00 degrees C / 32.00 degrees F
 Module voltage high alarm threshold : 0.4368 V
 Module voltage low alarm threshold : 0.0000 V
 Module voltage high warning threshold : 0.0000 V
 Module voltage low warning threshold : 0.0000 V
 Laser rx power high alarm threshold : 0.8224 mW / -0.85 dBm
 Laser rx power low alarm threshold : 0.8224 mW / -0.85 dBm
 Laser rx power high warning threshold : 0.8224 mW / -0.85 dBm
 Laser rx power low warning threshold : 0.8224 mW / -0.85 dBm
As you can see alsmost all mesuring values (C, V, mA and dBm) change. The values when output is redirected are unreliable which makes it impossible to use in a script.
I am using Debian GNU/Linux 10 (buster), kernel 4.19.0-9-amd64 #1 SMP Debian 4.19.118-2 (2020-04-29) x86_64 GNU/Linux and libc6 2.28-10

FYI, I could not reproduce the bug on Debian Stretch (ethtool 1:4.7-1+b1, kernel 4.9.0-11-amd64 and libc6 2.24-11+deb9u4).

--
Yannis Aribaud

```
```
[[Message part 2](bugreport.cgi?att=1;bug=960702;msg=5) (text/html, inline)]
```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Kernel Team <debian-kernel@lists.debian.org>`:

`Bug#960702`; Package `ethtool`.
(Fri, 15 May 2020 16:54:04 GMT) ([full text](bugreport.cgi?bug=960702;msg=7), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Bjørn Mork <bjorn@mork.no>`:

Extra info received and forwarded to list. Copy sent to `Debian Kernel Team <debian-kernel@lists.debian.org>`.
(Fri, 15 May 2020 16:54:04 GMT) ([full text](bugreport.cgi?bug=960702;msg=9), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 960702@bugs.debian.org ([full text](bugreport.cgi?bug=960702;msg=10), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=bjorn%40mork.no)
From: Bjørn Mork <bjorn@mork.no>
To: "Yannis Aribaud" <bugs@d6bell.net>
Cc: 960702@bugs.debian.org
Subject: Re: Bug#960702: ethtool -m values change when output is redirected
Date: Fri, 15 May 2020 18:40:34 +0200
```
"Yannis Aribaud" <bugs@d6bell.net> writes:

> Package: ethtool
> Version: 1:4.19-1
> Severity: important
> I'm facing a very strange behavior. The command ethtool -m  report the transceiver DOM values correctly, but when the command output is redirected to an other program, values change to somthing else.

AFAICS, your SFP+ is reporting strange values in either case.  I do not
think any of these are correct.  Looking at the non-redirected one:

>  Laser output power : 3.0768 mW / 4.88 dBm

This is insanely high.

>  Receiver signal average optical power : 1.2298 mW / 0.90 dBm
>  Module temperature : 48.47 degrees C / 119.24 degrees F
>  Module voltage : 1.2336 V

Should be 3.3 V

>  Laser bias current high alarm threshold : 4.744 mA
>  Laser bias current low alarm threshold : 49.896 mA

Right...

>  Laser output power high alarm threshold : 2.5701 mW / 4.10 dBm

I don't think this can be trusted either, but I do note that it is lower
than your current output.

>  Laser output power low alarm threshold : 0.8224 mW / -0.85 dBm
>  Laser output power high warning threshold : 0.8224 mW / -0.85 dBm
>  Laser output power low warning threshold : 0.8224 mW / -0.85 dBm

Strange limits.  There are too many -0.85 dBm values here.

>  Module temperature high alarm threshold : 0.00 degrees C / 32.00 degrees F
>  Module temperature low alarm threshold : 0.00 degrees C / 32.00 degrees F
>  Module temperature high warning threshold : 0.00 degrees C / 32.00 degrees F
>  Module temperature low warning threshold : 0.00 degrees C / 32.00 degrees F

Makes no sense at all.

>  Module voltage high alarm threshold : 0.4356 V
>  Module voltage low alarm threshold : 0.0000 V
>  Module voltage high warning threshold : 0.0000 V
>  Module voltage low warning threshold : 0.0000 V

Makes even less sense.

>  Laser rx power high alarm threshold : 0.8224 mW / -0.85 dBm
>  Laser rx power low alarm threshold : 0.8224 mW / -0.85 dBm
>  Laser rx power high warning threshold : 0.8224 mW / -0.85 dBm
>  Laser rx power low warning threshold : 0.8224 mW / -0.85 dBm

...

To me it looks like you are just reading arbitrary numbers from the
SFP+.  Try replacing it and see if the results are more reliable.

Bjørn

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Kernel Team <debian-kernel@lists.debian.org>`:

`Bug#960702`; Package `ethtool`.
(Fri, 15 May 2020 17:36:02 GMT) ([full text](bugreport.cgi?bug=960702;msg=12), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=12), [link](#11)).

---

**Acknowledgement sent**
to `"Yannis Aribaud" <bugs@d6bell.net>`:

Extra info received and forwarded to list. Copy sent to `Debian Kernel Team <debian-kernel@lists.debian.org>`.
(Fri, 15 May 2020 17:36:03 GMT) ([full text](bugreport.cgi?bug=960702;msg=14), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 960702@bugs.debian.org ([full text](bugreport.cgi?bug=960702;msg=15), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=bugs%40d6bell.net)
From: "Yannis Aribaud" <bugs@d6bell.net>
To: "Bjørn Mork" <bjorn@mork.no>
Cc: 960702@bugs.debian.org
Subject: Re: Bug#960702: ethtool -m values change when output is
redirected
Date: Fri, 15 May 2020 17:14:17 +0000
```
15 mai 2020 18:40 "Bjørn Mork" <bjorn@mork.no> a écrit:

> "Yannis Aribaud" <bugs@d6bell.net> writes:
>
> [...]
>
> To me it looks like you are just reading arbitrary numbers from the
> SFP+. Try replacing it and see if the results are more reliable.

I will try, but I am seeing the same behavior and similar values on 2 servers running the same hardware and the same software. The SFP+ modules model is commonly used on our equipements (servers, routers, switchs) and we never had such issues.

Values are clearly unreliable but not random at all. Values doesn't change between several runs of the command output redirected or not.

I mean values obviously change between redirected output and non redirected output runs, but not much between several runs redirected and neither between several runs non redirected.

Thus even if the values provided by the tranceivers are crazy, I see no reason seeing differences like those in values due to output redirect... I could not find any clue in the source code of ethtool, but I am no good developper at all.

Regards,

--
Yannis Aribaud

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Kernel Team <debian-kernel@lists.debian.org>`:

`Bug#960702`; Package `ethtool`.
(Fri, 15 May 2020 23:33:04 GMT) ([full text](bugreport.cgi?bug=960702;msg=17), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=17), [link](#16)).

---

**Acknowledgement sent**
to `Ben Hutchings <ben@decadent.org.uk>`:

Extra info received and forwarded to list. Copy sent to `Debian Kernel Team <debian-kernel@lists.debian.org>`.
(Fri, 15 May 2020 23:33:04 GMT) ([full text](bugreport.cgi?bug=960702;msg=19), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=19), [link](#18)).

---

[Message #20](#20) received at 960702@bugs.debian.org ([full text](bugreport.cgi?bug=960702;msg=20), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=20), reply):

![](/cgi-bin/libravatar.cgi?email=ben%40decadent.org.uk)
From: Ben Hutchings <ben@decadent.org.uk>
To: Yannis Aribaud <bugs@d6bell.net>, 960702@bugs.debian.org
Subject: Re: Bug#960702: ethtool -m values change when output is redirected
Date: Sat, 16 May 2020 00:29:42 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=960702;msg=20) (text/plain, inline)]
```
```
Control: tag -1 moreinfo

On Fri, 2020-05-15 at 15:02 +0000, Yannis Aribaud wrote:
> Package: ethtool
> Version: 1:4.19-1
> Severity: important
> I'm facing a very strange behavior. The command ethtool -m  report
> the transceiver DOM values correctly, but when the command output is
> redirected to an other program, values change to somthing else.
[...]
> As you can see alsmost all mesuring values (C, V, mA and dBm) change.
> The values when output is redirected are unreliable which makes it
> impossible to use in a script.

I suspect that ethtool is actually getting garbage data from the
driver.

> I am using Debian GNU/Linux 10 (buster), kernel 4.19.0-9-amd64 #1 SMP
> Debian 4.19.118-2 (2020-04-29) x86_64 GNU/Linux and libc6 2.28-10

And which network driver are you using?

Ben.

--
Ben Hutchings
It's easier to fight for one's principles than to live up to them.

```
```
[[signature.asc](bugreport.cgi?att=1;bug=960702;filename=signature.asc;msg=20) (application/pgp-signature, inline)]
```

---

**Added tag(s) moreinfo.**
Request was from `Ben Hutchings <ben@decadent.org.uk>`
to `960702-submit@bugs.debian.org`.
(Fri, 15 May 2020 23:33:04 GMT) ([full text](bugreport.cgi?bug=960702;msg=22), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=22), [link](#21)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Kernel Team <debian-kernel@lists.debian.org>`:

`Bug#960702`; Package `ethtool`.
(Sun, 17 May 2020 14:54:03 GMT) ([full text](bugreport.cgi?bug=960702;msg=24), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=24), [link](#23)).

---

**Acknowledgement sent**
to `"Yannis Aribaud" <bugs@d6bell.net>`:

Extra info received and forwarded to list. Copy sent to `Debian Kernel Team <debian-kernel@lists.debian.org>`.
(Sun, 17 May 2020 14:54:03 GMT) ([full text](bugreport.cgi?bug=960702;msg=26), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=26), [link](#25)).

---

[Message #27](#27) received at 960702@bugs.debian.org ([full text](bugreport.cgi?bug=960702;msg=27), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=27), reply):

![](/cgi-bin/libravatar.cgi?email=bugs%40d6bell.net)
From: "Yannis Aribaud" <bugs@d6bell.net>
To: "Ben Hutchings" <ben@decadent.org.uk>, 960702@bugs.debian.org
Subject: Re: Bug#960702: ethtool -m values change when output is
redirected
Date: Sun, 17 May 2020 14:41:01 +0000
```
16 mai 2020 01:29 "Ben Hutchings" <ben@decadent.org.uk> a écrit:

> Control: tag -1 moreinfo
>
> [...]
>
>> I am using Debian GNU/Linux 10 (buster), kernel 4.19.0-9-amd64 #1 SMP
>> Debian 4.19.118-2 (2020-04-29) x86_64 GNU/Linux and libc6 2.28-10
>
> And which network driver are you using?

root@localhost:~# ethtool -i enp10s0
driver: mlx4_en
version: 4.0-0
firmware-version: 2.42.5000
expansion-rom-version:
bus-info: 0000:0a:00.0
supports-statistics: yes
supports-test: yes
supports-eeprom-access: no
supports-register-dump: no
supports-priv-flags: yes

root@localhost:~# modinfo mlx4_en
filename:       /lib/modules/4.19.0-9-amd64/kernel/drivers/net/ethernet/mellanox/mlx4/mlx4_en.ko
version:        4.0-0
license:        Dual BSD/GPL
description:    Mellanox ConnectX HCA Ethernet driver
author:         Liran Liss, Yevgeny Petrilin
srcversion:     5E7CBA2E401F495296DC544
depends:        mlx4_core,devlink
retpoline:      Y
intree:         Y
name:           mlx4_en
vermagic:       4.19.0-9-amd64 SMP mod_unload modversions
sig_id:         PKCS#7
signer:         Debian Secure Boot CA
sig_key:        A7:46:8D:EF
sig_hashalgo:   sha256
signature:      27:8D:17:13:F5:5B:EA:8E:DC:88:30:FD:2C:89:50:64:E8:2A:C6:7A:
		25:F5:67:A9:DB:82:CD:5E:46:0E:F6:2A:2F:3F:EF:6B:BE:EF:49:AA:
		27:1D:4D:95:28:AA:6C:88:5A:B1:C7:75:5F:C2:78:71:7F:1B:FC:CC:
		E0:F4:33:DE:9E:51:99:C2:FE:D1:2A:9B:EF:17:63:5C:1E:29:9A:4F:
		00:56:6F:3E:ED:C5:4A:72:63:8A:4C:EE:33:FD:FE:7C:73:2B:D0:0D:
		80:80:A0:91:36:0D:7E:B0:C2:AC:2D:5C:A3:55:BF:03:94:52:64:30:
		DF:14:BC:FB:AF:3B:60:D3:4C:02:78:4D:51:61:D8:F2:E4:02:9C:D5:
		A4:05:81:D9:47:92:5A:C2:0D:D5:00:71:37:85:9B:F4:E5:54:3F:22:
		CD:4C:67:12:63:15:C2:1D:87:C8:03:3C:4E:23:6C:A5:F3:C6:12:99:
		0E:D1:40:AA:47:45:64:0F:AB:C2:E0:71:64:03:AD:4B:F2:0C:02:F3:
		D3:D5:E4:4C:26:63:14:93:46:5F:31:3B:4C:9B:4B:5D:CD:30:C0:DF:
		28:8A:4D:9A:0E:A8:5A:87:F4:7F:DD:F6:0E:A3:3A:B2:99:C0:75:F9:
		00:13:B0:44:06:D1:1C:FE:34:A1:77:36:2A:15:29:F7
parm:           udp_rss:Enable RSS for incoming UDP traffic or disabled (0) (uint)
parm:           pfctx:Priority based Flow Control policy on TX[7:0]. Per priority bit mask (uint)
parm:           pfcrx:Priority based Flow Control policy on RX[7:0]. Per priority bit mask (uint)
parm:           inline_thold:Threshold for using inline data (range: 17-104, default: 104) (uint)

Latest firmware available on Mellanox website for this NIC and default kernel driver.

Regards,

--
Yannis Aribaud

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Kernel Team <debian-kernel@lists.debian.org>`:

`Bug#960702`; Package `ethtool`.
(Sun, 17 May 2020 16:06:03 GMT) ([full text](bugreport.cgi?bug=960702;msg=29), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=29), [link](#28)).

---

**Acknowledgement sent**
to `Ben Hutchings <ben@decadent.org.uk>`:

Extra info received and forwarded to list. Copy sent to `Debian Kernel Team <debian-kernel@lists.debian.org>`.
(Sun, 17 May 2020 16:06:03 GMT) ([full text](bugreport.cgi?bug=960702;msg=31), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=31), [link](#30)).

---

[Message #32](#32) received at 960702@bugs.debian.org ([full text](bugreport.cgi?bug=960702;msg=32), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=32), reply):

![](/cgi-bin/libravatar.cgi?email=ben%40decadent.org.uk)
From: Ben Hutchings <ben@decadent.org.uk>
To: Yannis Aribaud <bugs@d6bell.net>, 960702@bugs.debian.org
Subject: Re: Bug#960702: ethtool -m values change when output is redirected
Date: Sun, 17 May 2020 17:03:55 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=960702;msg=32) (text/plain, inline)]
```
```
Control: tag -1 - moreinfo
Control: reassign -1 src:linux
Control: found -1 4.9.210-1
Control: found -1 4.19.118-2
Control: found -1 5.6.7-1
Control: tag -1 security

On Sun, 2020-05-17 at 14:41 +0000, Yannis Aribaud wrote:
> 16 mai 2020 01:29 "Ben Hutchings" <ben@decadent.org.uk> a écrit:
>
> > Control: tag -1 moreinfo
> >
> > [...]
> >
> > > I am using Debian GNU/Linux 10 (buster), kernel 4.19.0-9-amd64 #1 SMP
> > > Debian 4.19.118-2 (2020-04-29) x86_64 GNU/Linux and libc6 2.28-10
> >
> > And which network driver are you using?
>
> root@localhost:~# ethtool -i enp10s0
> driver: mlx4_en
> version: 4.0-0
> firmware-version: 2.42.5000
> expansion-rom-version:
> bus-info: 0000:0a:00.0
> supports-statistics: yes
> supports-test: yes
> supports-eeprom-access: no
> supports-register-dump: no
> supports-priv-flags: yes
>
> root@localhost:~# modinfo mlx4_en
> filename:       /lib/modules/4.19.0-9-amd64/kernel/drivers/net/ethernet/mellanox/mlx4/mlx4_en.ko
[...]

Right, this turns to have exactly the bug I suspected. :-/

Tagged security because this is leaking kernel memory.

Ben.

--
Ben Hutchings
Logic doesn't apply to the real world. - Marvin Minsky

```
```
[[signature.asc](bugreport.cgi?att=1;bug=960702;filename=signature.asc;msg=32) (application/pgp-signature, inline)]
```

---

**Removed tag(s) moreinfo.**
Request was from `Ben Hutchings <ben@decadent.org.uk>`
to `960702-submit@bugs.debian.org`.
(Sun, 17 May 2020 16:06:03 GMT) ([full text](bugreport.cgi?bug=960702;msg=34), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=34), [link](#33)).

---

**Bug reassigned from package '[ethtool](pkgreport.cgi?package=ethtool)' to '[src:linux](pkgreport.cgi?src=linux)'.**
Request was from `Ben Hutchings <ben@decadent.org.uk>`
to `960702-submit@bugs.debian.org`.
(Sun, 17 May 2020 16:06:03 GMT) ([full text](bugreport.cgi?bug=960702;msg=36), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=36), [link](#35)).

---

**No longer marked as found in versions ethtool/1:4.19-1.**
Request was from `Ben Hutchings <ben@decadent.org.uk>`
to `960702-submit@bugs.debian.org`.
(Sun, 17 May 2020 16:06:04 GMT) ([full text](bugreport.cgi?bug=960702;msg=38), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=38), [link](#37)).

---

**Marked as found in versions linux/4.9.210-1.**
Request was from `Ben Hutchings <ben@decadent.org.uk>`
to `960702-submit@bugs.debian.org`.
(Sun, 17 May 2020 16:06:05 GMT) ([full text](bugreport.cgi?bug=960702;msg=40), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=40), [link](#39)).

---

**Marked as found in versions linux/4.19.118-2.**
Request was from `Ben Hutchings <ben@decadent.org.uk>`
to `960702-submit@bugs.debian.org`.
(Sun, 17 May 2020 16:06:06 GMT) ([full text](bugreport.cgi?bug=960702;msg=42), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=42), [link](#41)).

---

**Marked as found in versions linux/5.6.7-1.**
Request was from `Ben Hutchings <ben@decadent.org.uk>`
to `960702-submit@bugs.debian.org`.
(Sun, 17 May 2020 16:06:07 GMT) ([full text](bugreport.cgi?bug=960702;msg=44), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=44), [link](#43)).

---

**Added tag(s) security.**
Request was from `Ben Hutchings <ben@decadent.org.uk>`
to `960702-submit@bugs.debian.org`.
(Sun, 17 May 2020 16:06:07 GMT) ([full text](bugreport.cgi?bug=960702;msg=46), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=46), [link](#45)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Kernel Team <debian-kernel@lists.debian.org>`:

`Bug#960702`; Package `src:linux`.
(Sun, 17 May 2020 17:24:02 GMT) ([full text](bugreport.cgi?bug=960702;msg=48), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=48), [link](#47)).

---

**Acknowledgement sent**
to `Ben Hutchings <ben@decadent.org.uk>`:

Extra info received and forwarded to list. Copy sent to `Debian Kernel Team <debian-kernel@lists.debian.org>`.
(Sun, 17 May 2020 17:24:02 GMT) ([full text](bugreport.cgi?bug=960702;msg=50), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=50), [link](#49)).

---

[Message #51](#51) received at 960702@bugs.debian.org ([full text](bugreport.cgi?bug=960702;msg=51), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=51), reply):

![](/cgi-bin/libravatar.cgi?email=ben%40decadent.org.uk)
From: Ben Hutchings <ben@decadent.org.uk>
To: Tariq Toukan <tariqt@mellanox.com>
Cc: 960702@bugs.debian.org, netdev@vger.kernel.org
Subject: [PATCH net] mlx4: Fix information leak on failure to read module
EEPROM
Date: Sun, 17 May 2020 18:20:53 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=960702;msg=51) (text/plain, inline)]
```
```
mlx4_en_get_module_eeprom() returns 0 even if it fails.  This results
in copying an uninitialised (or partly initialised) buffer back to
user-space.

Change it so that:

* In the special case that the DOM turns out not to be readable, the
  remaining part of the buffer is cleared.  This should avoid a
  regression when reading modules with this problem.

* In other error cases, the error code is propagated.

Reported-by: Yannis Aribaud <bugs@d6bell.net>
References: <https://bugs.debian.org/960702>
Fixes: 7202da8b7f71 ("ethtool, net/mlx4_en: Cable info, get_module_info/...")
Signed-off-by: Ben Hutchings <ben@decadent.org.uk>
---
This is compile-tested only.  It should go to stable, if it is a
correct fix.

Ben.

 drivers/net/ethernet/mellanox/mlx4/en_ethtool.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/drivers/net/ethernet/mellanox/mlx4/en_ethtool.c b/drivers/net/ethernet/mellanox/mlx4/en_ethtool.c
index 8a5ea2543670..6edc3177af1c 100644
--- a/drivers/net/ethernet/mellanox/mlx4/en_ethtool.c
+++ b/drivers/net/ethernet/mellanox/mlx4/en_ethtool.c
@@ -2078,14 +2078,17 @@ static int mlx4_en_get_module_eeprom(struct net_device *dev,
 		ret = mlx4_get_module_info(mdev->dev, priv->port,
 					   offset, ee->len - i, data + i);

-		if (!ret) /* Done reading */
+		if (!ret) {
+			/* DOM was not readable after all */
+			memset(data + i, 0, ee->len - i);
 			return 0;
+		}

 		if (ret < 0) {
 			en_err(priv,
 			       "mlx4_get_module_info i(%d) offset(%d) bytes_to_read(%d) - FAILED (0x%x)\n",
 			       i, offset, ee->len - i, ret);
-			return 0;
+			return ret;
 		}

 		i += ret;

```
```
[[signature.asc](bugreport.cgi?att=1;bug=960702;filename=signature.asc;msg=51) (application/pgp-signature, inline)]
```

---

**Added tag(s) upstream and patch.**
Request was from `Ben Hutchings <benh@debian.org>`
to `control@bugs.debian.org`.
(Sun, 17 May 2020 17:57:02 GMT) ([full text](bugreport.cgi?bug=960702;msg=53), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=53), [link](#52)).

---

**Set Bug forwarded-to-address to '[https://lore.kernel.org/netdev/20200517172053.GA734488@decadent.org.uk/T/](https://lore.kernel.org/netdev/20200517172053.GA734488%40decadent.org.uk/T/)'.**
Request was from `Ben Hutchings <benh@debian.org>`
to `control@bugs.debian.org`.
(Sun, 17 May 2020 17:57:03 GMT) ([full text](bugreport.cgi?bug=960702;msg=55), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=55), [link](#54)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Kernel Team <debian-kernel@lists.debian.org>`:

`Bug#960702`; Package `src:linux`.
(Mon, 18 May 2020 10:09:02 GMT) ([full text](bugreport.cgi?bug=960702;msg=57), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=57), [link](#56)).

---

**Acknowledgement sent**
to `"Yannis Aribaud" <bugs@d6bell.net>`:

Extra info received and forwarded to list. Copy sent to `Debian Kernel Team <debian-kernel@lists.debian.org>`.
(Mon, 18 May 2020 10:09:02 GMT) ([full text](bugreport.cgi?bug=960702;msg=59), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=59), [link](#58)).

---

[Message #60](#60) received at 960702@bugs.debian.org ([full text](bugreport.cgi?bug=960702;msg=60), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=60), reply):

![](/cgi-bin/libravatar.cgi?email=bugs%40d6bell.net)
From: "Yannis Aribaud" <bugs@d6bell.net>
To: "Ben Hutchings" <ben@decadent.org.uk>, 960702@bugs.debian.org
Subject: Re: Bug#960702: ethtool -m values change when output is
redirected
Date: Mon, 18 May 2020 09:55:10 +0000
```
17 mai 2020 18:04 "Ben Hutchings" <ben@decadent.org.uk> a écrit:

> [...]

Just in case that could be usefull. We change the transceiver for an other model also known to work correctly.

root@localhost:~# ethtool -m enp10s0
	Identifier                                : 0x03 (SFP)
	Extended identifier                       : 0x04 (GBIC/SFP defined by 2-wire interface ID)
	Connector                                 : 0x07 (LC)
	Transceiver codes                         : 0x10 0x00 0x00 0x00 0x40 0x00 0x0c 0x00 0x00
	Transceiver type                          : 10G Ethernet: 10G Base-SR
	Transceiver type                          : FC: short distance (S)
	Transceiver type                          : FC: Multimode, 62.5um (M6)
	Transceiver type                          : FC: Multimode, 50um (M5)
	Encoding                                  : 0x06 (64B/66B)
	BR, Nominal                               : 10300MBd
	Rate identifier                           : 0x00 (unspecified)
	Length (SMF,km)                           : 0km
	Length (SMF)                              : 0m
	Length (50um)                             : 300m
	Length (62.5um)                           : 150m
	Length (Copper)                           : 0m
	Length (OM3)                              : 0m
	Laser wavelength                          : 850nm
	Vendor name                               : FiberStore
	Vendor OUI                                : 00:90:65
	Vendor PN                                 : SFP-10GSR-85
	Vendor rev                                : A
	Option values                             : 0x00 0x1a
	Option                                    : RX_LOS implemented
	Option                                    : TX_FAULT implemented
	Option                                    : TX_DISABLE implemented
	BR margin, max                            : 0%
	BR margin, min                            : 0%
	Vendor SN                                 : N3612030002
	Date code                                 : 161203
	Optical diagnostics support               : Yes
	Laser bias current                        : 16.480 mA
	Laser output power                        : 3.0768 mW / 4.88 dBm
	Receiver signal average optical power     : 1.2298 mW / 0.90 dBm
	Module temperature                        : 48.47 degrees C / 119.24 degrees F
	Module voltage                            : 1.2336 V
	Alarm/warning flags implemented           : Yes
	Laser bias current high alarm             : Off
	Laser bias current low alarm              : Off
	Laser bias current high warning           : Off
	Laser bias current low warning            : Off
	Laser output power high alarm             : Off
	Laser output power low alarm              : Off
	Laser output power high warning           : Off
	Laser output power low warning            : Off
	Module temperature high alarm             : Off
	Module temperature low alarm              : Off
	Module temperature high warning           : Off
	Module temperature low warning            : Off
	Module voltage high alarm                 : Off
	Module voltage low alarm                  : Off
	Module voltage high warning               : Off
	Module voltage low warning                : Off
	Laser rx power high alarm                 : Off
	Laser rx power low alarm                  : Off
	Laser rx power high warning               : Off
	Laser rx power low warning                : Off
	Laser bias current high alarm threshold   : 4.744 mA
	Laser bias current low alarm threshold    : 49.896 mA
	Laser bias current high warning threshold : 51.776 mA
	Laser bias current low warning threshold  : 50.910 mA
	Laser output power high alarm threshold   : 2.5701 mW / 4.10 dBm
	Laser output power low alarm threshold    : 0.8224 mW / -0.85 dBm
	Laser output power high warning threshold : 0.8224 mW / -0.85 dBm
	Laser output power low warning threshold  : 0.8224 mW / -0.85 dBm
	Module temperature high alarm threshold   : 0.00 degrees C / 32.00 degrees F
	Module temperature low alarm threshold    : 0.00 degrees C / 32.00 degrees F
	Module temperature high warning threshold : 0.00 degrees C / 32.00 degrees F
	Module temperature low warning threshold  : 0.00 degrees C / 32.00 degrees F
	Module voltage high alarm threshold       : 0.4356 V
	Module voltage low alarm threshold        : 0.0000 V
	Module voltage high warning threshold     : 0.0000 V
	Module voltage low warning threshold      : 0.0000 V
	Laser rx power high alarm threshold       : 0.8224 mW / -0.85 dBm
	Laser rx power low alarm threshold        : 0.8224 mW / -0.85 dBm
	Laser rx power high warning threshold     : 0.8224 mW / -0.85 dBm
	Laser rx power low warning threshold      : 0.8224 mW / -0.85 dBm

If I understood correctly, the driver is unable to read the DOM values correctly and return uninitialized values, which is a security issue (leaking kernel memory).
The fact that reading the DOM fails is an other issue (maybe Mellanox NIC firmware related ?).

But why are the values changing when output is redirected ? Does it change the variables memory addresses or pointers values ? What mechanism is involved there ?

Best Regards,
--
Yannis Aribaud

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Kernel Team <debian-kernel@lists.debian.org>`:

`Bug#960702`; Package `src:linux`.
(Mon, 18 May 2020 16:51:02 GMT) ([full text](bugreport.cgi?bug=960702;msg=62), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=62), [link](#61)).

---

**Acknowledgement sent**
to `Saeed Mahameed <saeedm@mellanox.com>`:

Extra info received and forwarded to list. Copy sent to `Debian Kernel Team <debian-kernel@lists.debian.org>`.
(Mon, 18 May 2020 16:51:02 GMT) ([full text](bugreport.cgi?bug=960702;msg=64), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=64), [link](#63)).

---

[Message #65](#65) received at 960702@bugs.debian.org ([full text](bugreport.cgi?bug=960702;msg=65), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=65), reply):

![](/cgi-bin/libravatar.cgi?email=saeedm%40mellanox.com)
From: Saeed Mahameed <saeedm@mellanox.com>
To: "ben@decadent.org.uk" <ben@decadent.org.uk>, Tariq Toukan
<tariqt@mellanox.com>
Cc: "960702@bugs.debian.org" <960702@bugs.debian.org>,
"netdev@vger.kernel.org" <netdev@vger.kernel.org>
Subject: Re: [PATCH net] mlx4: Fix information leak on failure to read module
EEPROM
Date: Mon, 18 May 2020 16:47:05 +0000
```
On Sun, 2020-05-17 at 18:20 +0100, Ben Hutchings wrote:
> mlx4_en_get_module_eeprom() returns 0 even if it fails.  This results
> in copying an uninitialised (or partly initialised) buffer back to
> user-space.
>
> Change it so that:
>
> * In the special case that the DOM turns out not to be readable, the
>   remaining part of the buffer is cleared.  This should avoid a
>   regression when reading modules with this problem.
>
> * In other error cases, the error code is propagated.
>
> Reported-by: Yannis Aribaud <bugs@d6bell.net>
> References: <https://bugs.debian.org/960702>
> Fixes: 7202da8b7f71 ("ethtool, net/mlx4_en: Cable info,
> get_module_info/...")
> Signed-off-by: Ben Hutchings <ben@decadent.org.uk>
> ---
> This is compile-tested only.  It should go to stable, if it is a
> correct fix.
>
> Ben.
>
>  drivers/net/ethernet/mellanox/mlx4/en_ethtool.c | 7 +++++--
>  1 file changed, 5 insertions(+), 2 deletions(-)
>
> diff --git a/drivers/net/ethernet/mellanox/mlx4/en_ethtool.c
> b/drivers/net/ethernet/mellanox/mlx4/en_ethtool.c
> index 8a5ea2543670..6edc3177af1c 100644
> --- a/drivers/net/ethernet/mellanox/mlx4/en_ethtool.c
> +++ b/drivers/net/ethernet/mellanox/mlx4/en_ethtool.c
> @@ -2078,14 +2078,17 @@ static int mlx4_en_get_module_eeprom(struct
> net_device *dev,
>  		ret = mlx4_get_module_info(mdev->dev, priv->port,
>  					   offset, ee->len - i, data +
> i);
>

I am not sure i see the issue in here, and why we need the partial
memset ?
first thing in this function we do:
memset(data, 0, ee->len);

and then mlx4_get_module_info() will only copy valid data only on
success.

> -		if (!ret) /* Done reading */
> +		if (!ret) {
> +			/* DOM was not readable after all */

actually if mlx4_get_module_info()  returns any non-negative value it
means how much data was read, so if it returns 0, it means that this
was the last iteration and we are done reading the eeprom..

so i would remove the above comment and the memset below is redundant
since we already memset the whole buffer before the while loop.

> +			memset(data + i, 0, ee->len - i);
>  			return 0;
> +		}
>
>  		if (ret < 0) {
>  			en_err(priv,
>  			       "mlx4_get_module_info i(%d) offset(%d)
> bytes_to_read(%d) - FAILED (0x%x)\n",
>  			       i, offset, ee->len - i, ret);
> -			return 0;
> +			return ret;

I think returning error in here was the actual solution for your
problem. you can verify by looking in the kernel log and verify you see
the log message.

>  		}
>
>  		i += ret;

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian Kernel Team <debian-kernel@lists.debian.org>`:

`Bug#960702`; Package `src:linux`.
(Mon, 18 May 2020 18:21:04 GMT) ([full text](bugreport.cgi?bug=960702;msg=67), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=67), [link](#66)).

---

**Acknowledgement sent**
to `Ben Hutchings <ben@decadent.org.uk>`:

Extra info received and forwarded to list. Copy sent to `Debian Kernel Team <debian-kernel@lists.debian.org>`.
(Mon, 18 May 2020 18:21:04 GMT) ([full text](bugreport.cgi?bug=960702;msg=69), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=69), [link](#68)).

---

[Message #70](#70) received at 960702@bugs.debian.org ([full text](bugreport.cgi?bug=960702;msg=70), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=70), reply):

![](/cgi-bin/libravatar.cgi?email=ben%40decadent.org.uk)
From: Ben Hutchings <ben@decadent.org.uk>
To: Saeed Mahameed <saeedm@mellanox.com>, Tariq Toukan <tariqt@mellanox.com>
Cc: "960702@bugs.debian.org" <960702@bugs.debian.org>,
"netdev@vger.kernel.org"
<netdev@vger.kernel.org>
Subject: Re: [PATCH net] mlx4: Fix information leak on failure to read
module EEPROM
Date: Mon, 18 May 2020 19:16:22 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=960702;msg=70) (text/plain, inline)]
```
```
On Mon, 2020-05-18 at 16:47 +0000, Saeed Mahameed wrote:
> On Sun, 2020-05-17 at 18:20 +0100, Ben Hutchings wrote:
> > mlx4_en_get_module_eeprom() returns 0 even if it fails.  This results
> > in copying an uninitialised (or partly initialised) buffer back to
> > user-space.
[...]
> I am not sure i see the issue in here, and why we need the partial
> memset ?
> first thing in this function we do:
> memset(data, 0, ee->len);
>
> and then mlx4_get_module_info() will only copy valid data only on
> success.

Wow, sorry, I don't know how I missed that.  So this is not the bug I
was looking for.

>
> > -		if (!ret) /* Done reading */
> > +		if (!ret) {
> > +			/* DOM was not readable after all */
>
> actually if mlx4_get_module_info()  returns any non-negative value it
> means how much data was read, so if it returns 0, it means that this
> was the last iteration and we are done reading the eeprom..
>
> so i would remove the above comment and the memset below is redundant
> since we already memset the whole buffer before the while loop.

Right.

> > +			memset(data + i, 0, ee->len - i);
> >  			return 0;
> > +		}
> >
> >  		if (ret < 0) {
> >  			en_err(priv,
> >  			       "mlx4_get_module_info i(%d) offset(%d)
> > bytes_to_read(%d) - FAILED (0x%x)\n",
> >  			       i, offset, ee->len - i, ret);
> > -			return 0;
> > +			return ret;
>
> I think returning error in here was the actual solution for your
> problem. you can verify by looking in the kernel log and verify you see
> the log message.

The original bug report (<https://bugs.debian.org/960702>) says that
ethtool reports different values depending on whether its output is
redirected.  Although returning all-zeroes for the unreadable part
might be wrong, it doesn't explain that behaviour.

Perhaps if the timing of the I²C reads is marginal, varying numbers of
bytes of DOM information might be readable?  But I don't see how
redirection of ethtool's output would affect that.  It uses a single
ioctl to read everything, and the kernel controls timing within that.

So I am mystified about what is going on here.  Maybe there is a bug in
ethtool, but I'm not seeing it.

Ben.

> >  		}
> >
> >  		i += ret;
--
Ben Hutchings
The two most common things in the universe are hydrogen and stupidity.

```
```
[[signature.asc](bugreport.cgi?att=1;bug=960702;filename=signature.asc;msg=70) (application/pgp-signature, inline)]
```

---

**Removed tag(s) security.**
Request was from `Ben Hutchings <benh@debian.org>`
to `control@bugs.debian.org`.
(Mon, 18 May 2020 18:21:05 GMT) ([full text](bugreport.cgi?bug=960702;msg=72), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=72), [link](#71)).

---

**Removed tag(s) patch.**
Request was from `Ben Hutchings <benh@debian.org>`
to `control@bugs.debian.org`.
(Mon, 18 May 2020 22:51:03 GMT) ([full text](bugreport.cgi?bug=960702;msg=74), [mbox](bugreport.cgi?bug=960702;mbox=yes;msg=74), [link](#73)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=960702).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sun Jan 19 11:47:22 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.


