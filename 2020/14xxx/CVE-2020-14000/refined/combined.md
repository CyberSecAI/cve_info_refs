=== Content from scratch.mit.edu_d8e031b4_20250119_125626.html ===


* [Create](/projects/editor/?tip_bar=home)
* [Explore](/explore/projects/all)
* [Ideas](/ideas)
* [About](/about/)

The Scratch privacy policy has been updated, effective May 25, 2023. You can see the new policy [here](/privacy_policy).
x

Confirm your email to enable sharing. [Having trouble?](/info/faq/#accounts)
x

We are experiencing a disruption with email delivery. If you are not receiving emails from us, please try after 8am EST.
x

## Discuss Scratch

* [Discussion Home](/discuss/)

![loading...](//cdn.scratch.mit.edu/scratchr2/static/__774e7841eab6f875e16f7cec38b2f7c3__//images/ajax-loader.gif)

There was an error :( Try again?

Follow Discussion

Unfollow Discussion

‚Äπ‚Äπ previous
1
[2](?page=2)
[next ‚Ä∫‚Ä∫](?page=2)

* [Discussion Forums](/discuss/)
* ¬ª [Advanced Topics](/discuss/31/)
* ¬ª CVE-2020-14000: Script Injection vulnerability in scratch-vm
  [![[RSS Feed]](//cdn.scratch.mit.edu/scratchr2/static/__774e7841eab6f875e16f7cec38b2f7c3__//djangobb_forum/img/feed-icon-small.png "[RSS Feed]")](/discuss/feeds/topic/422904/)

#1[July 15, 2020 02:16:15](/discuss/post/4223443/)

[apple502j](/users/apple502j/)
[![](//cdn2.scratch.mit.edu/get_image/user/10817178_90x90.png)](/users/apple502j/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

On June 9th, 2020, me, apple502j, found a vulnerability in scratch-vm, a library used in Scratch 3.0 that handles project.json deserialization. This is patched on July 14th, and has a CVE ID of CVE-2020-14000.

#2[July 15, 2020 07:38:43](/discuss/post/4223717/)

[novice27b](/users/novice27b/)
[![](//cdn2.scratch.mit.edu/get_image/user/274916_90x90.png)](/users/novice27b/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

Congrats!

#3[July 15, 2020 07:47:43](/discuss/post/4223738/)

[apple502j](/users/apple502j/)
[![](//cdn2.scratch.mit.edu/get_image/user/10817178_90x90.png)](/users/apple502j/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

> novice27b wrote:
>
> Congrats!

I just filled MITRE's form. It seems like it's actually harder to get ST's attention than MITRE's.

#4[July 15, 2020 09:17:19](/discuss/post/4223911/)

[SausageMcSauce](/users/SausageMcSauce/)
[![](//cdn2.scratch.mit.edu/get_image/user/46640925_90x90.png)](/users/SausageMcSauce/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

Is there any mention of the vulnerability outside of Scratch and the scratch-vm repository?

#5[July 15, 2020 10:00:42](/discuss/post/4223972/)

[apple502j](/users/apple502j/)
[![](//cdn2.scratch.mit.edu/get_image/user/10817178_90x90.png)](/users/apple502j/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

> SausageMcSauce wrote:
>
> Is there any mention of the vulnerability outside of Scratch and the scratch-vm repository?

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14000> should soon be updated.

#6[July 15, 2020 12:58:20](/discuss/post/4224359/)

[novice27b](/users/novice27b/)
[![](//cdn2.scratch.mit.edu/get_image/user/274916_90x90.png)](/users/novice27b/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

> apple502j wrote:
>
> > novice27b wrote:
> >
> > Congrats!
>
> I just filled MITRE's form. It seems like it's actually harder to get ST's attention than MITRE's.

Yeah, I've had mixed experiences with reporting vulnerabilities to the scratch team.

#7[July 16, 2020 14:40:01](/discuss/post/4227790/)

[noverify](/users/noverify/)
[![](//cdn2.scratch.mit.edu/get_image/user/61888960_90x90.png)](/users/noverify/)

Scratcher

15 posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

Very interesting that scratch just allowed to load an url out of nowhere!

#8[July 16, 2020 16:17:24](/discuss/post/4228126/)

[apple502j](/users/apple502j/)
[![](//cdn2.scratch.mit.edu/get_image/user/10817178_90x90.png)](/users/apple502j/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

The CVE entry is published at <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14000>

#9[July 17, 2020 09:09:31](/discuss/post/4230122/)

[Capitan\_Florida\_2](/users/Capitan_Florida_2/)
[![](//cdn2.scratch.mit.edu/get_image/user/17540619_90x90.png)](/users/Capitan_Florida_2/)

Scratcher

100+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

> apple502j wrote:
>
> The CVE entry is published at <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14000>

woah that's crazy

#10[July 17, 2020 19:33:41](/discuss/post/4231767/)

[herohamp](/users/herohamp/)
[![](//cdn2.scratch.mit.edu/get_image/user/9565102_90x90.png)](/users/herohamp/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

So who does this apply to then if it does not apply to Scratch?

#11[July 17, 2020 19:39:33](/discuss/post/4231782/)

[A-E-](/users/A-E-/)
[![](//cdn2.scratch.mit.edu/get_image/user/7397632_90x90.png)](/users/A-E-/)

Scratcher

100+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

> herohamp wrote:
>
> So who does this apply to then if it does not apply to Scratch?

It applies to mods with extention support, though many such mods allow loading from URLs anyway.

#12[July 17, 2020 19:39:35](/discuss/post/4231784/)

[ElsieBreeze](/users/ElsieBreeze/)
[![](//cdn2.scratch.mit.edu/get_image/user/56844723_90x90.png)](/users/ElsieBreeze/)

Scratcher

100+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

> herohamp wrote:
>
> So who does this apply to then if it does not apply to Scratch?

I'd imagine Scratch Mods that use workers, as I imagine some might do.

#13[July 18, 2020 09:48:16](/discuss/post/4233229/)

[Boomer001](/users/Boomer001/)
[![](//cdn2.scratch.mit.edu/get_image/user/47201268_90x90.png)](/users/Boomer001/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

Wow, reading this scared me‚Ä¶

*Last edited by Boomer001 (July 18, 2020 09:59:42)*

#14[July 27, 2020 16:55:00](/discuss/post/4262988/)

[apple502j](/users/apple502j/)
[![](//cdn2.scratch.mit.edu/get_image/user/10817178_90x90.png)](/users/apple502j/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

CVSS v3.1 Scores

#15[Sept. 3, 2020 15:32:40](/discuss/post/4387791/)

[AmazingMech2418](/users/AmazingMech2418/)
[![](//cdn2.scratch.mit.edu/get_image/user/19030691_90x90.png)](/users/AmazingMech2418/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

Wouldn't the system for loading from a URL be used for extensions? Also, this is not really a huge deal unless it can access storage and/or cookies though. The best way to sanitize the input would probably to use an allowlist for domains instead of just sanitizing any URLs.

#16[Sept. 3, 2020 16:48:26](/discuss/post/4388069/)

[apple502j](/users/apple502j/)
[![](//cdn2.scratch.mit.edu/get_image/user/10817178_90x90.png)](/users/apple502j/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

This is not the intended mechanics, because getExtensionIdForOpcode is, well‚Ä¶ for getting extension ID and not opcode. Ability to make fetch() request itself is enough to be considered as a vulnerability.

#17[Sept. 3, 2020 17:13:23](/discuss/post/4388162/)

[AmazingMech2418](/users/AmazingMech2418/)
[![](//cdn2.scratch.mit.edu/get_image/user/19030691_90x90.png)](/users/AmazingMech2418/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

> apple502j wrote:
>
> This is not the intended mechanics, because getExtensionIdForOpcode is, well‚Ä¶ for getting extension ID and not opcode. Ability to make fetch() request itself is enough to be considered as a vulnerability.

Why would there be loadExtensionURL function then that is called by getExtensionIdForOpcode? If it weren't for including extensions not directly in scratch-vm, it must be for loading extensions from URLs. Also, it is sandboxed, so even a fetch request wouldn't be too bad. It's really kind of like the experimental extensions in Scratch 2.0 except that it automatically loads the extension instead of you having to copy and paste into the console.

#18[Sept. 3, 2020 18:25:57](/discuss/post/4388433/)

[apple502j](/users/apple502j/)
[![](//cdn2.scratch.mit.edu/get_image/user/10817178_90x90.png)](/users/apple502j/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

I think this is because developers either wanted to add ‚Äúextension URL‚Äù field to project.json (but they didn't) - or too lazy to promisify sync API. The problem is there is no warning or similar stuff before loading such extensions.

#19[Sept. 3, 2020 19:25:48](/discuss/post/4388626/)

[Sheep\_maker](/users/Sheep_maker/)
[![](//cdn2.scratch.mit.edu/get_image/user/14880401_90x90.png)](/users/Sheep_maker/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

> AmazingMech2418 wrote:
>
> Also, it is sandboxed, so even a fetch request wouldn't be too bad.

Perhaps it could be used to DDOS a target if a project abusing this got popular by just constantly spamming requests from every user with the project open. Alternatively, it could be used to spam requests from a different IP (if CORS were enabled on the target).

#20[Sept. 3, 2020 19:28:23](/discuss/post/4388635/)

[AmazingMech2418](/users/AmazingMech2418/)
[![](//cdn2.scratch.mit.edu/get_image/user/19030691_90x90.png)](/users/AmazingMech2418/)

Scratcher

1000+ posts

### CVE-2020-14000: Script Injection vulnerability in scratch-vm

> Sheep\_maker wrote:
>
> > AmazingMech2418 wrote:
> >
> > Also, it is sandboxed, so even a fetch request wouldn't be too bad.
>
> Perhaps it could be used to DDOS a target if a project abusing this got popular by just constantly spamming requests from every user with the project open. Alternatively, it could be used to spam requests from a different IP (if CORS were enabled on the target).

Yeah, but, again, CORS would have to be enabled on the target and most largely targeted websites have CORS disabled as is the default normally.

‚Äπ‚Äπ previous
1
[2](?page=2)
[next ‚Ä∫‚Ä∫](?page=2)

* [Discussion Forums](/discuss/)
* ¬ª [Advanced Topics](/discuss/31/)
* ¬ª CVE-2020-14000: Script Injection vulnerability in scratch-vm [![[RSS Feed]](//cdn.scratch.mit.edu/scratchr2/static/__774e7841eab6f875e16f7cec38b2f7c3__//djangobb_forum/img/feed-icon-small.png "[RSS Feed]")](/discuss/feeds/topic/422904/)

![loading...](//cdn.scratch.mit.edu/scratchr2/static/__774e7841eab6f875e16f7cec38b2f7c3__//images/ajax-loader.gif)

Powered by [DjangoBB](http://djangobb.org/)

* #### About

  + [About Scratch](/about/)
  + [For Parents](/parents/)
  + [For Educators](/educators/)
  + [For Developers](/developers)
  + [Our Team](/info/credits/)
  + [Donors](https://www.scratchfoundation.org/supporters)
  + [Jobs](/jobs/)
  + [Donate](/donate)
* #### Community

  + [Community Guidelines](/community_guidelines/)
  + [Discussion Forums](/discuss/)
  + [Scratch Wiki](http://wiki.scratch.mit.edu/)
  + [Statistics](/statistics/)
* #### Resources

  + [Ideas](/ideas)
  + [FAQ](/info/faq/)
  + [Download](/download)
  + [Contact Us](/contact-us/)
* #### Legal

  + [Terms of Use](/terms_of_use/)
  + [Privacy Policy](/privacy_policy/)
  + [Cookies](/cookies/)
  + [DMCA](/DMCA/)
  + [DSA Requirements](https://www.scratchfoundation.org/dsa/)
* #### Scratch Family

  + [ScratchEd](http://scratched.gse.harvard.edu/)
  + [ScratchJr](http://www.scratchjr.org/)
  + [Scratch Day](http://day.scratch.mit.edu/)
  + [Scratch Conference](/conference/)
  + [Scratch Foundation](http://www.scratchfoundation.org/)
  + [Scratch Store](/store)

* –ê“ß—Å—à”ô–∞
  Afrikaans
  ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
  Asturianu
  ·ä†·àõ·à≠·äõ
  Aragon√©s
  Azeri
  Bahasa Indonesia
  ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ
  –ë–µ–ª–∞—Ä—É—Å–∫–∞—è
  –ë—ä–ª–≥–∞—Ä—Å–∫–∏
  Catal√†
  ƒåesky
  Cymraeg
  Dansk
  Deutsch
  Eesti
  ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨
  English
  Espa√±ol (Espa√±a)
  Espa√±ol Latinoamericano
  Esperanto
  Euskara
  ŸÅÿßÿ±ÿ≥€å
  Filipino
  Fran√ßais
  Frysk
  Gaeilge
  G√†idhlig
  Galego
  ÌïúÍµ≠Ïñ¥
  Hausa
  ’Ä’°’µ’•÷Ä’•’∂
  ◊¢÷¥◊ë÷∞◊®÷¥◊ô◊™
  ‡§π‡§ø‡§Ç‡§¶‡•Ä
  Hrvatski
  isiXhosa
  isiZulu
  √çslenska
  Italiano
  ·É•·Éê·É†·Éó·É£·Éö·Éò ·Éî·Éú·Éê
  “õ–∞–∑–∞“õ—à–∞
  Kichwa
  Kiswahili
  Krey√≤l ayisyen
  Kurd√Æ
  ⁄©Ÿàÿ±ÿØ€å€å ŸÜÿßŸà€ïŸÜÿØ€å
  Latvie≈°u
  Lietuvi≈≥
  Magyar
  MƒÅori
  –ú–æ–Ω–≥–æ–ª —Ö—ç–ª
  Nederlands
  Êó•Êú¨Ë™û
  „Å´„Åª„Çì„Åî
  Norsk Bokm√•l
  Norsk Nynorsk
  Occitan
  ‡¨ì‡¨°‡¨º‡¨ø‡¨Ü
  O ªzbekcha
  ‡πÑ‡∏ó‡∏¢
  ·ûó·û∂·ûü·û∂·ûÅ·üí·ûò·üÇ·ûö
  Polski
  Portugu√™s
  Portugu√™s Brasileiro
  Rapa Nui
  Rom√¢nƒÉ
  –†—É—Å—Å–∫–∏–π
  Sepedi
  Setswana
  Slovenƒçina
  Sloven≈°ƒçina
  –°—Ä–ø—Å–∫–∏
  Suomi
  Svenska
  Ti·∫øng Vi·ªát
  T√ºrk√ße
  –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞
  ÁÆÄ‰Ωì‰∏≠Êñá
  ÁπÅÈ´î‰∏≠Êñá

x
### Sign in

Username

Password

Sign in
Or Join Scratch



=== Content from github.com_eb314f23_20250119_125625.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fscratchfoundation%2Fscratch-vm%2Fpull%2F2476)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fscratchfoundation%2Fscratch-vm%2Fpull%2F2476)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=scratchfoundation%2Fscratch-vm)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[scratchfoundation](/scratchfoundation)
/
**[scratch-vm](/scratchfoundation/scratch-vm)**
Public

* [Notifications](/login?return_to=%2Fscratchfoundation%2Fscratch-vm) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Fscratchfoundation%2Fscratch-vm)
* [Star
   1.2k](/login?return_to=%2Fscratchfoundation%2Fscratch-vm)

* [Code](/scratchfoundation/scratch-vm)
* [Issues
  419](/scratchfoundation/scratch-vm/issues)
* [Pull requests
  120](/scratchfoundation/scratch-vm/pulls)
* [Actions](/scratchfoundation/scratch-vm/actions)
* [Projects
  0](/scratchfoundation/scratch-vm/projects)
* [Wiki](/scratchfoundation/scratch-vm/wiki)
* [Security](/scratchfoundation/scratch-vm/security)
* [Insights](/scratchfoundation/scratch-vm/pulse)

Additional navigation options

* [Code](/scratchfoundation/scratch-vm)
* [Issues](/scratchfoundation/scratch-vm/issues)
* [Pull requests](/scratchfoundation/scratch-vm/pulls)
* [Actions](/scratchfoundation/scratch-vm/actions)
* [Projects](/scratchfoundation/scratch-vm/projects)
* [Wiki](/scratchfoundation/scratch-vm/wiki)
* [Security](/scratchfoundation/scratch-vm/security)
* [Insights](/scratchfoundation/scratch-vm/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fscratchfoundation%2Fscratch-vm%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fscratchfoundation%2Fscratch-vm%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# sanitize extension ID in getExtensionIdForOpcode #2476

 Merged

[cwillisf](/cwillisf)
merged 1 commit into
[scratchfoundation:develop](/scratchfoundation/scratch-vm/tree/develop "scratchfoundation/scratch-vm:develop")
from
[cwillisf:fix-extension-url](/cwillisf/scratch-vm/tree/fix-extension-url "cwillisf/scratch-vm:fix-extension-url")

Jul 14, 2020

 Merged

# [sanitize extension ID in getExtensionIdForOpcode](#top) #2476

[cwillisf](/cwillisf)
merged 1 commit into
[scratchfoundation:develop](/scratchfoundation/scratch-vm/tree/develop "scratchfoundation/scratch-vm:develop")
from
[cwillisf:fix-extension-url](/cwillisf/scratch-vm/tree/fix-extension-url "cwillisf/scratch-vm:fix-extension-url")

Jul 14, 2020

+10

‚àí2

[Conversation
7](/scratchfoundation/scratch-vm/pull/2476)
[Commits
1](/scratchfoundation/scratch-vm/pull/2476/commits)
[Checks
0](/scratchfoundation/scratch-vm/pull/2476/checks)
[Files changed
3](/scratchfoundation/scratch-vm/pull/2476/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![cwillisf](https://avatars.githubusercontent.com/u/7019101?s=60&v=4)](/cwillisf)

Copy link

Contributor

### @cwillisf **[cwillisf](/cwillisf)** commented [Jun 16, 2020](#issue-639292784)

### Proposed Changes

When loading an SB3, we determine whether a block is part of an extension by inspecting its "extended" opcode -- for example, `pen_clear` requires the `pen` extension. This change introduces an extra sanitizing step to ensure that the extension ID doesn't contain any characters that might cause problems. Also, this change defines the characters allowed in extension IDs as alphanumerics plus hyphen.

### Reason for Changes

We should always validate user input, and project files count. We validate most of the project file but we weren't validating the extension ID in this case. See also support ticket 229791.

Special thanks to [@apple502j](https://github.com/apple502j) for bringing this to our attention!

### Test Coverage

A new test has been added to verify that characters are replaced appropriately.

Sorry, something went wrong.

All reactions

[![@cwillisf](https://avatars.githubusercontent.com/u/7019101?s=40&v=4)](/cwillisf)

`[sanitize extension ID in getExtensionIdForOpcode](/scratchfoundation/scratch-vm/pull/2476/commits/90b9da45f4084958535338d1c4d71a22d6136aab "sanitize extension ID in getExtensionIdForOpcode")`

`[90b9da4](/scratchfoundation/scratch-vm/pull/2476/commits/90b9da45f4084958535338d1c4d71a22d6136aab)`

[![@cwillisf](https://avatars.githubusercontent.com/u/7019101?s=40&u=1adecd04b0671b47d5af2a22db6f722801221c53&v=4)](/cwillisf)
[cwillisf](/cwillisf)
added
the
[pr - needs review](/scratchfoundation/scratch-vm/labels/pr%20-%20needs%20review)
label
[Jun 16, 2020](#event-3446781117)

[![@cwillisf](https://avatars.githubusercontent.com/u/7019101?s=40&u=1adecd04b0671b47d5af2a22db6f722801221c53&v=4)](/cwillisf)
[cwillisf](/cwillisf)
added this to the [June 2020](/scratchfoundation/scratch-vm/milestone/58) milestone
[Jun 16, 2020](#event-3446781119)

 [![@cwillisf](https://avatars.githubusercontent.com/u/7019101?s=40&u=1adecd04b0671b47d5af2a22db6f722801221c53&v=4)](/cwillisf)
[cwillisf](/cwillisf)
requested review from
[chrisgarrity](/chrisgarrity) and
[ericrosenbaum](/ericrosenbaum)
[June 16, 2020 01:01](#event-3446781123)

[![@cwillisf](https://avatars.githubusercontent.com/u/7019101?s=40&u=1adecd04b0671b47d5af2a22db6f722801221c53&v=4)](/cwillisf)
[cwillisf](/cwillisf)
assigned [chrisgarrity](/chrisgarrity) and [ericrosenbaum](/ericrosenbaum)
[Jun 16, 2020](#event-3446781139)

[![chrisgarrity](https://avatars.githubusercontent.com/u/399209?s=60&v=4)](/chrisgarrity)

**[chrisgarrity](/chrisgarrity)**
approved these changes
[Jun 23, 2020](#pullrequestreview-435700851)

 [View reviewed changes](/scratchfoundation/scratch-vm/pull/2476/files/90b9da45f4084958535338d1c4d71a22d6136aab)

Copy link

Contributor

### @chrisgarrity **[chrisgarrity](/chrisgarrity)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Code looks fine to me. I also checked that a selection of core extensions still work as expected. I didn't have a bad extension file to test with. [@ericrosenbaum](https://github.com/ericrosenbaum) perhaps you can check whether this interferes with other allowed extensions.

Sorry, something went wrong.

All reactions

[![@chrisgarrity](https://avatars.githubusercontent.com/u/399209?s=40&v=4)](/chrisgarrity)
[chrisgarrity](/chrisgarrity)
removed their assignment
[Jun 23, 2020](#event-3472541187)

[![@ericrosenbaum](https://avatars.githubusercontent.com/u/567844?s=80&u=4c9b34a7032fa4bd15307bce005a9761a5c10ad9&v=4)](/ericrosenbaum)

Copy link

Contributor

### **[ericrosenbaum](/ericrosenbaum)** commented [Jul 1, 2020](#issuecomment-652555570)

| So if I understand correctly, the extension manager has its own similar check [here](https://github.com/LLK/scratch-vm/blob/da68c4faf68014bfdfdb1af263910940d96ddd3a/src/extension-support/extension-manager.js#L273), which prevents loading a built-in extension that has an id with non-alphanumeric characters (it's more strict than the changes here, which allow uppercase letters and hyphens). I was playing around with making built-in extensions with weird id values, but none of them would load because of that existing code. So I wasn't able to test this code path in that way. Do you have a suggestion for how I might test it directly, or should we not worry about it? |
| --- |

All reactions

Sorry, something went wrong.

[![@apple502j](https://avatars.githubusercontent.com/u/33279053?s=80&u=d7e9c3a95242731be3cbc197d6fffb57f2d167cc&v=4)](/apple502j)

Copy link

Contributor

### **[apple502j](/apple502j)** commented [Jul 1, 2020](#issuecomment-652569663)

| [@ericrosenbaum](https://github.com/ericrosenbaum) sent an email to contact us, with PoC attached |
| --- |

 üëç
1
 ericrosenbaum reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@ericrosenbaum](https://avatars.githubusercontent.com/u/567844?s=80&u=4c9b34a7032fa4bd15307bce005a9761a5c10ad9&v=4)](/ericrosenbaum)

Copy link

Contributor

### **[ericrosenbaum](/ericrosenbaum)** commented [Jul 2, 2020](#issuecomment-653070471)

| Thanks for your help @apple502j- I was able to use your info to replicate the issue and confirm that this change prevents it. nice! |
| --- |

All reactions

Sorry, something went wrong.

[![ericrosenbaum](https://avatars.githubusercontent.com/u/567844?s=60&v=4)](/ericrosenbaum)

**[ericrosenbaum](/ericrosenbaum)**
approved these changes
[Jul 2, 2020](#pullrequestreview-441792473)

 [View reviewed changes](/scratchfoundation/scratch-vm/pull/2476/files/90b9da45f4084958535338d1c4d71a22d6136aab)

Copy link

Contributor

### @ericrosenbaum **[ericrosenbaum](/ericrosenbaum)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM!

Sorry, something went wrong.

All reactions

[![@ericrosenbaum](https://avatars.githubusercontent.com/u/567844?s=40&u=4c9b34a7032fa4bd15307bce005a9761a5c10ad9&v=4)](/ericrosenbaum)
[ericrosenbaum](/ericrosenbaum)
assigned [cwillisf](/cwillisf) and unassigned [ericrosenbaum](/ericrosenbaum)
[Jul 2, 2020](#event-3507626079)

[![@ericrosenbaum](https://avatars.githubusercontent.com/u/567844?s=40&u=4c9b34a7032fa4bd15307bce005a9761a5c10ad9&v=4)](/ericrosenbaum)
[ericrosenbaum](/ericrosenbaum)
added
[pr - good to merge](/scratchfoundation/scratch-vm/labels/pr%20-%20good%20to%20merge)
and removed
[pr - needs review](/scratchfoundation/scratch-vm/labels/pr%20-%20needs%20review)
labels
[Jul 2, 2020](#event-3507626715)

[![@cwillisf](https://avatars.githubusercontent.com/u/7019101?s=40&u=1adecd04b0671b47d5af2a22db6f722801221c53&v=4)](/cwillisf)
[cwillisf](/cwillisf)
mentioned this pull request
[Jul 14, 2020](#ref-issue-656821351)

[extension ID filters should be consistent
#2517](/scratchfoundation/scratch-vm/issues/2517)

Open

[![@cwillisf](https://avatars.githubusercontent.com/u/7019101?s=80&u=1adecd04b0671b47d5af2a22db6f722801221c53&v=4)](/cwillisf)

Copy link

Contributor

Author

### **[cwillisf](/cwillisf)** commented [Jul 14, 2020](#issuecomment-658349324)

| filed [#2517](https://github.com/scratchfoundation/scratch-vm/issues/2517) to track the extension ID filter mismatch mentioned in [#2476 (comment)](https://github.com/scratchfoundation/scratch-vm/pull/2476#issuecomment-652555570) |
| --- |

All reactions

Sorry, something went wrong.

[![@cwillisf](https://avatars.githubusercontent.com/u/7019101?s=40&u=1adecd04b0671b47d5af2a22db6f722801221c53&v=4)](/cwillisf)
[cwillisf](/cwillisf)
merged commit [`a9f473f`](/scratchfoundation/scratch-vm/commit/a9f473feb61296f2f12f901c9ae66f8ce1374c65)
into
scratchfoundation:develop

[Jul 14, 2020](https://github.com/scratchfoundation/scratch-vm/pull/2476#event-3545458272)

 [![@cwillisf](https://avatars.githubusercontent.com/u/7019101?s=40&u=1adecd04b0671b47d5af2a22db6f722801221c53&v=4)](/cwillisf)
[cwillisf](/cwillisf)
deleted the
fix-extension-url

branch
[July 14, 2020 18:47](#event-3545458493)

[![@apple502j](https://avatars.githubusercontent.com/u/33279053?s=80&u=d7e9c3a95242731be3cbc197d6fffb57f2d167cc&v=4)](/apple502j)

Copy link

Contributor

### **[apple502j](/apple502j)** commented [Jul 15, 2020](#issuecomment-658505584) ‚Ä¢ edited Loading

| NOTE: [CVE-2020-14000](https://github.com/advisories/GHSA-vc9j-fhvv-8vrf "CVE-2020-14000") assigned for this vulnerability. Affected Versions are scratch-vm from 0.1.0-prerelease.1524239808 to 0.2.0-prerelease.20200709173451 (both inclusive). This is patched in 0.2.0-prerelease.20200714185213. |
| --- |

All reactions

Sorry, something went wrong.

[![@apple502j](https://avatars.githubusercontent.com/u/33279053?s=40&u=d7e9c3a95242731be3cbc197d6fffb57f2d167cc&v=4)](/apple502j)
[apple502j](/apple502j)
mentioned this pull request
[Jan 13, 2021](#ref-pullrequest-785133953)

[Do not try loading unknown extensions automatically
#2813](/scratchfoundation/scratch-vm/pull/2813)
 Open

[![@apple502j](https://avatars.githubusercontent.com/u/33279053?s=40&u=d7e9c3a95242731be3cbc197d6fffb57f2d167cc&v=4)](/apple502j)
[apple502j](/apple502j)
mentioned this pull request
[Sep 14, 2021](#ref-issue-995781383)

[security issue: string variable can exhaust memory and cause scratch hang there
scratchfoundation/scratch-gui#7630](/scratchfoundation/scratch-gui/issues/7630)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fscratchfoundation%2Fscratch-vm%2Fpull%2F2476)

Reviewers

[![@ericrosenbaum](https://avatars.githubusercontent.com/u/567844?s=40&v=4)](/ericrosenbaum) [ericrosenbaum](/ericrosenbaum)

ericrosenbaum approved these changes

[![@chrisgarrity](https://avatars.githubusercontent.com/u/399209?s=40&v=4)](/chrisgarrity) [chrisgarrity](/chrisgarrity)

chrisgarrity approved these changes

Assignees

[![@cwillisf](https://avatars.githubusercontent.com/u/7019101?s=40&v=4)](/cwillisf) [cwillisf](/cwillisf)

Labels

[pr - good to merge](/scratchfoundation/scratch-vm/labels/pr%20-%20good%20to%20merge)

Projects

None yet

Milestone

 [**June 2020**](/scratchfoundation/scratch-vm/milestone/58 "June 2020")

Development

Successfully merging this pull request may close these issues.

4 participants

[![@cwillisf](https://avatars.githubusercontent.com/u/7019101?s=52&v=4)](/cwillisf) [![@ericrosenbaum](https://avatars.githubusercontent.com/u/567844?s=52&v=4)](/ericrosenbaum) [![@apple502j](https://avatars.githubusercontent.com/u/33279053?s=52&v=4)](/apple502j) [![@chrisgarrity](https://avatars.githubusercontent.com/u/399209?s=52&v=4)](/chrisgarrity)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


