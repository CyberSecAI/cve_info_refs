```
{
  "CVE-2020-14352": [
    {
      "Root cause of vulnerability": "Librepo fails to sanitize paths in the 'repomd.xml' configuration file.",
      "Weaknesses/vulnerabilities present": "A directory traversal vulnerability exists where librepo fails to sanitize paths in remote repository metadata. Specifically, the code concatenates 'handle->destdir' and 'record->location_href' without proper validation of the latter.",
      "Impact of exploitation": "A remote attacker controlling a repository could use this vulnerability to copy files outside the destination directory via path traversal. Since DNF often runs as root, this could lead to arbitrary file overwriting and potentially system compromise.",
      "Attack vectors": "The attack vector is a malicious or malformed 'repomd.xml' file provided by a compromised or untrusted repository. The 'location_href' field within this file is used to specify file locations that are downloaded during repository synchronization or upgrades.",
      "Required attacker capabilities/position": "The attacker needs to control a repository that the victim's system is configured to use. This involves hosting a malicious repository and having the victim's system configured to download metadata from that repository. The attacker also needs to manipulate the 'location_href' field in the repository's repomd.xml metadata to include directory traversal sequences."
    },
    {
      "Root cause of vulnerability": "Missing path validation in repomd.xml within librepo",
      "Weaknesses/vulnerabilities present": "Directory traversal vulnerability due to lack of sanitization of paths in repository metadata. Specifically, the `prepare_repo_download_std_target()` and `prepare_repo_download_zck_target()` functions concatenate the destination directory with the location href from the metadata without proper validation.",
      "Impact of exploitation": "An attacker controlling a remote repository can overwrite arbitrary files by crafting a malicious repomd.xml file, leading to system compromise.  On RHEL7, the file is overwritten with an empty file, while on newer versions, the file is overwritten with an attacker-controlled file.",
      "Attack vectors": "A malicious or compromised repository serving a specially crafted repomd.xml file.",
      "Required attacker capabilities/position": "The attacker needs to control a repository that is accessed by a vulnerable system."
    }
  ]
}
```