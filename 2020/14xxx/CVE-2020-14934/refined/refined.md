- **Root cause of vulnerability:** An SNMP request with a number of OIDs exceeding the buffer capacity is processed without proper bounds checking, leading to a buffer overflow.
- **Weaknesses/vulnerabilities present:** Out-of-bounds write vulnerability exists in the `snmp_message_decode()` function due to lack of verification of the `varbinds` buffer capacity. The `varbinds` buffer, which stores OIDs from the SNMP request, is statically allocated in the .bss section, and its size is defined by `SNMP_MAX_NR_VALUES`. When the number of OIDs in the request exceeds this limit, a buffer overflow occurs.
- **Impact of exploitation:** The attacker can overwrite other variables allocated in the .bss section, which can lead to memory corruption and potentially allow for the execution of arbitrary code. Specifically, since the attacker controls the content that is written beyond the buffer, they can overwrite sensitive memory areas of the IoT device running the vulnerable code.
- **Attack vectors:** Sending a crafted SNMP request with a number of OIDs larger than `SNMP_MAX_NR_VALUES`.
- **Required attacker capabilities/position:** The attacker needs to be able to send network packets to the target device on which the vulnerable SNMP service is running. The attacker also needs the ability to craft malicious SNMP requests.