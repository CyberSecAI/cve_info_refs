=== Content from labs.nettitude.com_e62452ff_20250119_124621.html ===


[Skip content](#content)

Global (English)

* [About us](/en/who-we-are/)
* [Client login](/en/client-portal/)
* [⚠️ Report a Cyber Incident](/en/emergency-incident-response-services/)
* [Contact us](/en/contact-us/)

[Logo](/en/)

Menu

Close

* Assurance 4.0

  + Back
  + [Assurance 4.0](/en/who-we-are/assurance-4/)
  + [Assure Assets and Management Systems](/en/assure-assets-and-management-systems/)
  + [Achieve Product Integrity](/en/achieve-product-integrity/)
  + [Source Responsibly](/en/source-responsibly/)
  + [Navigate the Energy Transition and Achieve Net Zero](/en/navigate-the-energy-transition-and-achieve-net-zero/)
  + [Strengthen Cyber Security Maturity](/en/strengthen-cybersecurity-maturity/)
* Sectors

  + Back
  + [Sectors](/en/sectors/)
  + [Food and Beverage](/en/food-beverage-hospitality/)
  + [Financial and Professional Services](/en/financial-and-professional-services/)
  + [Energy and Renewables](/en/energy-renewables/)
  + [Transportation and Mobility](/en/transport-logistics/)
  + [Technology and Telecommunications](/en/ict-telecoms/)
  + [Consumer Goods and Retail](/en/consumer-goods-and-retail/)
  + [Construction and Engineering](/en/construction-industry/)
  + [Healthcare and Medical](/en/healthcare-medical/)
  + [Can't see your sector?](/en/contact-us/)
* Services

  + Back
  + [Services](/en/services/)
  + Assessment and Certification

    - Back
    - [Assessment and Certification](/en/assessment-certification/)
    - [Transfer your Certification to LRQA](/en/transfer-certification-to-lrqa/)
    - Quality, Environment, Health and Safety

      * Back
      * [Quality, Environment, Health and Safety](/en/quality-health-and-safety-and-environmental/)
      * [ISO 9001 Certification](/en/iso-9001/)
      * [ISO 14001 Certification](/en/iso-14001/)
      * [ISO 45001 Certification](/en/iso-45001/)
    - Food and Beverage

      * Back
      * [Food and Beverage](/en/food-beverage-hospitality/)
      * [FSSC 22000 Certification](/en/fssc-22000/)
      * [BRCGS Certification](/en/brcgs-food-safety/)
      * [2nd Party Audits](/en/2nd-party-audit-programmes/)
      * [ISO 22000 Certification](/en/iso-22000/)
      * [IFS Certification](/en/ifs/)
      * [SQF Certification](/en/sqf-certification/)
      * [HACCP Certification](/en/haccp/)
      * [Food Labelling](/en/food-labelling-regulation-advisory-services/)
      * [GSA BAP Certification](/en/gsa-bap/)
      * [MSC Certification](/en/msc/)
      * [ASC Certification](/en/asc/)
    - Sustainability and Responsible Sourcing

      * Back
      * [Sustainability and Responsible Sourcing](/en/climate-change-sustainability/)
      * [ISO 14064 Certification](/en/iso-14064/)
      * [ISO 50001 Certification](/en/iso-50001/)
      * [ISO 46001 Certification](/en/iso-46001/)
      * [Sedex Members Ethical Trade Audit (SMETA)](/en/smeta/)
      * [Amfori BSCI](/en/amfori-bsci-business-social-compliance-initiative/)
      * [Farm First](/en/farm-first-assurance-scheme/)
      * [ERSA](/en/ersa-responsible-sourcing-assessment/)
      * [Social and Labour Convergence Programme (SLCP)](/en/social-labour-convergence-program-slcp/)
      * [Initiative for Compliance and Sustainability (ICS)](/en/initiative-for-compliance-and-sustainability/)
      * [Responsible Business Alliance - Validated Assessment Program (RBA-VAP)](/en/rba-vap-validated-assessment-program/)
      * [Worldwide Responsible Accredited Production (WRAP)](/en/worldwide-responsible-accredited-production/)
      * [EU ETS](/en/eu-ets/)
      * [Responsible Plastic Management](/en/responsible-plastic-management/)
    - Information Security Management

      * Back
      * [Information Security Management](/en/information-security-management/)
      * [ISO 27001 Certification](/en/iso-27001/)
      * [ISO 27701 Certification](/en/iso-27701/)
      * [ISO 20000-1 Certification](/en/iso-20000/)
      * [ISO 22301 Certification](/en/iso-22301/)
      * [CSA STAR Certification](/en/csa-star/)
      * [ISO 42001 Certification](/en/iso-42001-ai-management-system-certification/)
    - Automotive and Aerospace

      * Back
      * [Automotive and Aerospace](/en/automotive-aerospace/)
      * [IATF 16949 Certification](/en/iatf-16949/)
      * [AS 9100 Certification](/en/as9100/)
    - [Medical - ISO 13485 Certification](/en/iso-13485/)
    - [Oil and Gas - ISO 29001 Certification](/en/iso-29001/)
    - [Client-Specific Programmes](/en/client-specific-programmes/)
    - [LRQA Worker Surveys](/en/lrqa-worker-surveys/)
  + Inspection Services

    - Back
    - [Inspection Services](/en/inspection-services/)
    - Product, System and Process Certification

      * Back
      * [Product, System and Process Certification](/en/codes-standards-regulations/)
      * [ASME](/en/asme-code-services/)
      * [Pressure Equipment Directive (PED)](/en/pressure-equipment-directive/)
      * [National Approvals](/en/product-certification/national-approvals/)
      * [EU Directives](/en/product-certification/ce-marking-and-eu-directives/)
    - Welding and Material Services

      * Back
      * [Welding and Material Services](/en/materials-and-welding/)
      * [EN 10204 Type 3.2](/en/materials-and-welding/en-10204-type-3-2-certification-services/)
      * [ISO 3834 Certification](/en/materials-and-welding/iso-3834/)
      * [Welding Procedure and Welder Operator Qualification](/en/materials-and-welding/welding-operator-qualification/)
    - [Container Certification](/en/containers/)
    - [Type Approval](/en/product-certification/type-approval/)
    - [Utilities Schemes](/en/utilities/)
    - Construction Scheme

      * Back
      * [Construction Scheme](/en/construction-industry/)
      * [BIM and ISO 19650](/en/construction-industry/building-information-modelling-bim/)
      * [BOPAS](/en/construction-industry/buildoffsite-property-assurance-scheme-bopas/)
      * [Construction Products Regulation (CPR)](/en/construction-products-regulation/)
    - Energy Transition Services

      * Back
      * [Energy Transition Services](/en/energy-transition-services/)
      * [Hydrogen Projects](/en/hydrogen-net-zero-manufacturing/)
      * [Nuclear Projects](/en/nuclear-supply-chain-inspection/)
      * [Solar Projects](/en/solar-projects-assurance/)
      * [Wind Projects](/en/wind-projects-assurance/)
    - Technical Advisory

      * Back
      * Technical Advisory
      * [Additive Manufacturing](/en/additive-manufacturing/)
      * [Other Technical Advisory Services](/en/technical-advisory-services/)
    - Supply Chain and Vendor Inspection

      * Back
      * [Supply Chain and Vendor Inspection](/en/supply-chain-inspection/)
      * [Cranes and Lifting Equipment](/en/manufacturing-industry/cranes-lifting-equipment/)
    - [Remote Inspection](/en/remote-inspection/)
  + Cyber Security Services

    - Back
    - [Cyber Security Services](/en/cyber-security-services/)
    - [⚠️ Report a Cyber Incident](/en/emergency-incident-response-services/)
    - Cyber Advisory

      * Back
      * [Cyber Advisory](/en/cyber-security-advisory-services/)
      * [Threat Intelligence Services](/en/threat-intelligence-services/)
      * [Virtual CISO Services](/en/virtual-ciso/)
      * [ThreatWatcher](/en/threatwatcher/)
      * [Threat Modelling](/en/threat-modelling/)
      * [Regulatory Compliance Testing](/en/regulatory-compliance-testing/)
      * [Red Teaming](/en/red-teaming/)
      * [Purple Teaming](/en/purple-teaming/)
      * [Cyber Security Maturity Assessment](/en/cyber-security-maturity-assessment/)
      * [Merger and Aquisitions Due Diligence](/en/mergers-and-acquisition-due-diligence/)
      * [Offensive Cyber Security Training](/en/offensive-cyber-security-training/)
    - Governance, Risk and Compliance

      * Back
      * [Governance, Risk and Compliance](/en/governance-risk-compliance-services/)
      * [PCI DSS Consultancy and Assessments](/en/pci-dss-assessments/)
      * [Security Awareness Training](/en/security-awareness-training/)
      * [DORA Compliance](/en/dora-compliance/)
      * [ISO 27001 Certification](/en/iso-27001/)
      * [NIST Cyber Security Framework](/en/nist-cyber-security-framework/)
      * [NCSC 10 Steps to Cyber Security](/en/ncsc-ten-steps-to-cyber-security-assessment/)
      * [CAA ASSURE Cyber Audit](/en/caa-assure-cyber-audit/)
      * [Vendor Security Review](/en/vendor-security-review/)
      * [Policies Procedures Creation and Review](/en/policies-procedures-creation-review/)
      * [Cyber Essentials Certification](/en/cyber-essentials-certification/)
      * [Cyber Security Risk Assessment](/en/cyber-security-risk-assessment/)
      * [Cloud Security and Privacy](/en/information-security-management/)
      * [CMMC Compliance](/en/cmmc-compliance/)
    - Managed Cyber Security Services

      * Back
      * [Managed Cyber Security Services](/en/managed-security-services/)
      * [SOC-as-a-Service (SOCaaS)](/en/soc-as-a-service/)
      * [Network Detection and Response (NDR)](/en/network-detection-and-response/)
      * [Extended Detection and Response (XDR)](/en/extended-detection-and-response/)
      * [Managed Detection and Response (MDR)](/en/managed-detection-and-response/)
      * [Security Information and Event Management (SIEM)](/en/security-information-and-event-management-siem-services/)
      * [Endpoint Detection and Response (EDR)](/en/endpoint-detection-and-response/)
      * [Virtual CISO Services](/en/virtual-ciso/)
      * [Digital Forensics and Incident Response](/en/digital-forensics-and-incident-response/)
      * [Vulnerability Scanning](/en/managed-vulnerability-scanning/)
    - Incident Response

      * Back
      * [Incident Response](/en/incident-response-services/)
      * [Digital Forensics and Incident Response](/en/digital-forensics-and-incident-response/)
      * [Emergency Incident Response](/en/emergency-incident-response-services/)
    - Cyber Security Testing

      * Back
      * [Cyber Security Testing](/en/cyber-security-testing/)
      * [Penetration Testing Services](/en/penetration-testing/)
      * [Web Application Penetration Testing](/en/web-application-penetration-testing/)
      * [Mobile Application Penetration Testing](/en/mobile-application-penetration-testing/)
      * [Cloud Penetration Testing](/en/cloud-penetration-testing/)
      * [Continuous Assurance](/en/continuous-assurance/)
      * [Red Teaming](/en/red-teaming/)
      * [Purple Teaming](/en/purple-teaming/)
      * [Social Engineering](/en/social-engineering/)
      * [Bug Bounty Program](/en/bug-bounty-program/)
    - Cyber Insurance Services

      * Back
      * Cyber Insurance Services
      * [Cyber Insurance Partner](/en/cyber-insurance-service-partner/)
      * [Cyber Insurance](/en/cyber-insurance-services/)
  + Verification and Report Assurance

    - Back
    - [Verification and Report Assurance](/en/assurance-services/)
    - [CSRD](/en/csrd/)
    - [Organisational GHG and Carbon Verification](/en/organisational-ghg-carbon-verification/)
    - [Environmental and Social Verification](/en/environmental-social-verification/)
    - [Product Carbon Footprinting](/en/product-carbon-footprinting/)
    - [Carbon Neutrality](/en/carbon-neutrality/)
    - [Regulatory Emission Schemes](/en/regulatory-emission-schemes/)
    - [Sector Carbon Standards](/en/sector-carbon-standards/)
  + Training

    - Back
    - Training
    - All Training Courses

      * Back
      * [All Training Courses](/en/training/overview/)
      * [Quality, Environment, Health and Safety Training](/en/training/quality-environmental-health-and-safety/)
      * [Food, Beverage and Hospitality Training](/en/training/food-beverage-hospitality/)
      * [Medical Devices Training](/en/training/medical-devices/)
      * [Cybersecurity and Information Security Training](/en/training/infosecurity-cyber/)
      * [Climate Change and Sustainability Training](/en/training/climate-change-sustainability/)
      * [Automotive, Aerospace and Transport Training](/en/training/automotive-aerospace/)
      * [Manufacturing Codes and Standards Training](/en/training/manufacturing/)
    - Online Training

      * Back
      * [Online Training](/en/training/virtual-classroom-online-courses/)
      * [Virtual Classroom Courses](/en/training/virtual-classroom-courses/)
      * [eLearning](/en/training/elearning-courses/)
      * [Blended Training](/en/training/blended/)
    - [LRQA Training Academy](/en/training-academy/)
    - [Management System Solutions](/en/management-system-solutions/)
    - [Training Portal](https://training-portal.lrqa.com/lmt/clmsbrowsev2.prmain?site=lrqaext&in_lang=en&in_region=gl)
  + Advisory Services

    - Back
    - [Advisory Services](/en/advisory-services/)
    - [ESG Advisory](/en/esg-advisory/)
    - [CSDDD](/en/csddd/)
    - [CSRD](/en/csrd/)
    - Diagnostics

      * Back
      * [Diagnostics](/en/diagnostics/)
      * [Responsible Sourcing](/en/responsible-sourcing-in-supply-chains/)
      * [Human Rights Impact Assessment (HRIA)](/en/human-rights-impact-assessment/)
      * [Net Zero](/en/net-zero-climate-risk-service/)
      * [Double Materiality](/en/double-materiality-assessment/)
    - Strategy and Design

      * Back
      * [Strategy and Design](/en/strategy-and-design/)
      * [Supply Chain Risk Assessment and Segmentation](/en/supply-chain-risk-assessment-segmentation-service/)
      * [Carbon Footprint and Decarbonisation Strategy](/en/corporate-decarbonisation-strategy/)
      * [Safety Culture Ladder](/en/safety-culture-ladder/)
    - Implementation

      * Back
      * [Implementation](/en/implementation/)
      * [Grievance Mechanism](/en/grievance-mechanism/)
      * [GHG Inventory](/en/ghg-inventory-service/)
      * [Waste and Emissions Supply Chain Engagement](/en/waste-and-emissions-supply-chain-engagement/)
    - Reporting and Disclosure

      * Back
      * [Reporting and Disclosure](/en/reporting-and-disclosure/)
      * [Climate Disclosure](/en/climate-disclosure-service/)
      * [Sustainability Disclosure](/en/sustainability-disclosure/)
    - [Programme Management](/en/programme-management/)
    - [Technical Advisory](/en/technical-advisory-services/)
    - Training

      * Back
      * Training
      * [All Training Courses](/en/training/overview/)
      * [Online Training](/en/training/virtual-classroom-online-courses/)
      * [Management System Solutions](/en/management-system-solutions/)
      * [Training Portal](https://training-portal.lrqa.com/lmt/clmsbrowsev2.prmain?site=lrqaext&in_lang=en&in_region=gl)
    - [Management System Solutions](/en/management-system-solutions/)
    - [LRQA Worker Surveys](/en/lrqa-worker-surveys/)
  + Data and Analytics

    - Back
    - Data and Analytics
    - [LRQA's EiQ Platform](https://www.eiq.ai/)
    - [EiQ Lite](/en/eiq-lite/)
  + [Can't find the service you need?](/en/contact-us/)
* News and Insights

  + Back
  + News and Insights
  + [Latest News](/en/latest-news/)
  + [Thought Leadership Articles](/en/insights/articles/)
  + [Cyber Labs](/en/cyber-labs/)
  + [Case Studies](/en/case-studies/)
  + [Podcasts](/en/podcasts/)
  + [Downloadable Resources](/en/resources/)
  + [Legislation Map](/en/supply-chain-due-diligence-legislation-map/)
  + [Client Information Notes (CINs)](/en/resources/client-information-note/)
  + [Accreditations](/en/who-we-are/our-management-systems-accreditations/)
  + [Hall of fame](/nl-nl/case-studies/hall-of-fame/)
  + [Awards and Recognition](/en/who-we-are/awards-and-recognition/)
* [Events and Webinars](/en/events/)
* Careers

  + Back
  + [Careers](/en/careers/)
  + [What it's like to work here](/en/why-lrqa/)
  + [From application to onboarding](/en/career-faqs/)
  + Talent Community

    - Back
    - [Talent Community](/en/opportunities/)
    - [Assessment roles](/en/opportunities/assessment-roles/)
    - [Inspection Service roles](/en/opportunities/inspection-service-roles/)
    - [Cybersecurity roles](/en/opportunities/cybersecurity-roles/)
    - [Advisory and ESG roles](/en/opportunities/advisory-and-esg-roles/)
    - [Sales and Business Development roles](/en/opportunities/sales-roles/)
    - [Contractor roles](/en/opportunities/contractor-roles/)
    - [Corporate Function roles](/en/opportunities/corporate-function-roles/)
  + Apply now

    - Back
    - Apply now
    - [Advisory and ESG roles](https://elevatelimited.bamboohr.com/careers)
    - [All other roles](https://jobs.lrqa.com/)
* [About us](/en/who-we-are/)
* [Client login](/en/client-portal/)
* [⚠️ Report a Cyber Incident](/en/emergency-incident-response-services/)

Search

Close

Search form
Search open

Search

Are you looking for?

* [Events](/en/events/)
* [News](/en/latest-news/)
* [Case studies](/en/case-studies/)
* [Resource library](/en/resources/)
* [Client Portal](/en/client-portal/)
* [Client Information Notes](/en/resources/client-information-note/)

You are here:

1. [Home](/en/)
2. [Cyber Labs

   Back to previous page](/en/cyber-labs/)
3. **CVE-2020-14418: madCodeHook Library Local Privilege Escalation**

![](/static/assets/search-grey.svg)
![LRQA Cyber Labs](/cdn-cgi/image/width=1024,format=auto/globalassets/cyber-labs/lrqa-cyber-labs.jpg)

# CVE-2020-14418: madCodeHook Library Local Privilege Escalation

Kyriakos Economou

Senior R&D team member at LRQA

01 Dec 2020

LRQA discovered a vulnerability in the ‘madCodeHook’ third party library which caused a number of security products, including Cisco AMP and Morphisec Unified Threat Prevention Platform, to contain a local privilege escalation vulnerability. Since the vulnerability originated in a third party library, it is likely to affect other software using that library. The madCodeHook author states that at least 15 security vendors use the library.

Following a coordinated disclosure process driven by LRQA, the latest versions of Cisco AMP and Morphisec Unified Threat Prevention Platform are no longer vulnerable to this issue. Other software that uses madCodeHook may still be vulnerable.

## Products Affected

All software using the [madCodeHook](http://www.madshi.net/madCodeHookDescription.htm) library has a kernel mode DLL injection vulnerability in versions prior to v4.1.3. This includes, but is likely not limited to, the following software:

* Cisco AMP prior to v7.2.13:
  + ExPrevDriver.sys
* Morphisec Unified Threat Prevention Platform v4.x earlier than v4.1.2, v3.5.9:
  + MorphiDriver.sys

## Introduction

There is a design flaw inside the kernel mode component of a DLL injection library called [madCodeHook](http://www.madshi.net/)*,*developed by Systemsoftware Mathias Rauen, that is used by several security and other vendors as part of their exploit prevention capabilities, amongst other things.

madCodeHook is a framework of function hooking and code injection techniques that can be used to monitor specific processes for abnormal behaviour or any other situation where API hooking might be required. This works by defining a list of process names to inject a specific DLL module that can also be used for hooking purposes.

The DLL injection takes place from kernel mode in order to achieve early injection into the processes of interest during their initialization stages. The library itself offers the ability to check for specific digital signatures before injecting a module into a process. It also blocks any shared write access to the module to be injected.

These two methods aim to prevent arbitrary DLL injection and/or modification of the defined module after it has passed the signature checks. However, we found a design flaw that can be abused, which allows an attacker to achieve arbitrary DLL injection into privileged processes and execute malicious code in the security context of SYSTEM user account.

According to the author of this library, there are at least 15 security vendors using this library, but they were not able give us further details on this in order to protect their customers.

Based on our investigation, “MalwareBytes” and “EMSISOFT” are also using this library, but since they were notified of this vulnerability by the author of the library, we didn’t have the time to test our exploit against their products.

During this article we will be examining this issue through the [Cisco AMP](https://www.cisco.com/c/en/us/products/security/advanced-malware-protection/index.html) product which uses a driver developed by [Morphisec](https://www.morphisec.com/), which in turn uses the aforementioned kernel mode code library, which can be used for hooking purposes.

## The Vulnerability

The `ExPrevDriver.sys` module, formally known as `MorphiDriver32.sys` and originally developed by Morphisec, is used to inject the `Protector64.dll` and `Protector32.dll` modules into selected user mode processes for extra “monitoring” purposes.

By sending the appropriate IOCTL we can define a path to a module to inject and also process names to protect and/or exclude from the DLL injection on runtime as they start.

Even though the driver will verify that the module is digitally signed by a specific trusted certificate, and blocks any modifications to the module after that by only allowing read access to user mode processes, it doesn’t protect from path redirection attack vectors.

In addition, the driver verifies the digital signature of the module to be injected only during this stage.This type of vulnerability is described as time-of-check-time-of-use (TOCTOU).

## Exploitation

In order to exploit this vulnerability, we need to send the appropriate IOCTL using an input buffer where the data has a specific structure. In addition to that, to be able to reach the dispatcher function, we must first solve a custom crypto-challenge that was applied by the author of madCodeHook library, presumably to block pre-analysis fuzzing and/or make the analysis more difficult.

This stage makes use of the RIPEMD-160 hashing algorithm along with two custom “encryption” routines, where all of them are bound together in a specific order for the purpose of validating and blocking arbitrary input.

The input validation scheme is designed as follows:

1. Prepare a structurally valid input data buffer.
2. Encrypt the data using a custom encryption routine.
3. Hash the encrypted data.
4. Re-encrypt the encrypted data with another custom encryption routine using the hash as a key.
5. Prepend the hash generated in step 3 and send the IOCTL.

The driver will go through the reverse steps to decrypt and validate the structure of the input data. Note, this is an overview of the input validation design; we will leave the rest of the details as an exercise for the reader.

This screenshot shows part of this request to the driver.

![IOCTL Input Data](/globalassets/cyber-labs/cve-2020-14418-madcodehook-library-local-privilege-escalation/ioctl-input-data.png "IOCTL Input Data")

This is a legitimate request performed by the driver during initialization. We can see the full path to the 32-bit module to be injected, and a partial list of target process names. A similar request using the path to the 64-bit module will be used as well to protect 64-bit processes. So, when the driver is loaded it will set a list of process names to monitor for and inject the appropriate module as defined above once a process that matches one of those names is started.

A local attacker can create a directory junction to the original protector module and include this in the path to send via the IOCTL. The driver will verify that we point to the expected module and will accept this request.

The vulnerability exists because instead of the driver storing the real path to the module that we defined via the IOCTL (in other words normalize the provided path), it actually stores the path as we define it. However, the attacker can now delete the junction and create a directory instead, and place an arbitrary DLL with the same name, which will cause the driver to inject the malicious DLL to the selected process defined in the IOCTL when the process starts.

In this way we can trick the driver to successfully validate our request and store the module path as we submit it. We can then inject into arbitrary processes, defined by us via IOCTL, our own DLL that contains the payload.

Finally, we can ‘force’ the driver to load our DLL in a service process running as SYSTEM and obtain full access in the affected host.

## Summary of exploitation steps

Here is a summary of the exploitations steps.

* Create directory junction pointing to the legit module directory (*“mklink /J C:\users\<username>\Desktop\exprev C:\Program Files\Cisco\AMP\exprev”)*
* Send IOCTL using *path “C:\users\<username>\Desktop\exprev\Protector64.dll”*
* Delete directory junction and create a normal full path *“C:\users\<username>\Desktop\exprev\Protector64.dll”* where the DLL is now your own DLL of choice.
* Start a process that you chose to protect through the IOCTL request.
* You should see your DLL loaded into that process.

## Avoiding this type of vulnerability

Drivers should normalize the received module path instead of storing the path as it is received from userland, which may contain junctions in-between, and lead to security issues such as the one reported here.

Additionally, the signature validation routine could be used each time just before a module is injected into a process. In that way, we can ensure that unsigned and/or self-signed binaries cannot be injected into arbitrary processes by abusing design flaws in similar driver functionality.

Finally, drivers shouldn’t (in general) allow low privileged processes to send IOCTL requests. This can be achieved by enforcing the correct ACL to the named device object that is exposed to the user mode processes.

## Disclosure Timeline

The madCodeHook author rapidly patched the library. We also chose to work with Morphisec, an affected vendor, during the disclosure process. Both entities were speedy and effective in their responses.

* Discovery: 6 July 2020
* Library author notified: 6 July 2020
* Patch issued by library author: 16 July 2020
* LRQA disclosure: 1 December 2020

#

### **GitHub Projects**

Check out our latest projects at [GitHub](https://github.com/nettitude)

## **Latest Cyber Labs articles**

* ### Time Travel Debugging Shellcode with Binary Ninja

  ![](/cdn-cgi/image/width=432,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  Learn how to debug shellcode using Time Travel Debugging (TTD) in Binary Ninja. This guide walks you through...
* ### Binary Ninja Plugin

  ![](/cdn-cgi/image/width=1024,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  Recently, in response to a customer incident we needed to reverse engineer a malware sample of WhiteRabbit ransomware...
* ### This Badge is My Badge

  ![](/cdn-cgi/image/width=432,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  When it comes to covert entry assessments, successfully capturing RFID badge values can mean the difference between failure...
* ### Version Tracking in Ghidra

  ![](/cdn-cgi/image/width=432,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  When a binary is reverse engineered using Ghidra, various annotations are applied to aid in understanding the binary’s...
* ### Vulnerabilities in AI Agents

  ![](/cdn-cgi/image/width=432,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  LLMs are becoming increasingly accessible to everyone. It is very easy to create your own LLM system, however...
* ### Emulation with Qiling

  ![LRQA Cyber Labs](/cdn-cgi/image/width=432,format=auto/globalassets/cyber-labs/lrqa-cyber-labs.jpg)

  Article

  Qiling is an emulation framework that builds upon the Unicorn emulator by providing higher level functionality such as...
* ### CVE-2024-20356: Jailbreaking a Cisco appliance to run DOOM

  ![LRQA Cyber Labs](/cdn-cgi/image/width=1024,format=auto/globalassets/cyber-labs/lrqa-cyber-labs.jpg)

  Article

  A walkthrough of CVE-2024-20356, a high severity Command Injection vulnerability affecting a range of Cisco products. This vulnerability...
* ### Flaw in PuTTY P-521 ECDSA signature generation leaks SSH...

  ![](/cdn-cgi/image/width=432,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  This article provides a technical analysis of CVE-2024-31497, a vulnerability in PuTTY discovered by Fabian Bäumer and Marcus Brinkmann...
* ### Introducing SharpConflux

  ![](/cdn-cgi/image/width=432,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  Today, we are releasing a new tool called SharpConflux, a .NET application built to facilitate Confluence exploration. It...

Previous

Next

![](/cdn-cgi/image/width=120,format=auto/globalassets/logos/lrqa-white-logo---dark-background-cropped.png)

* [Who we are](/en/who-we-are/)
* [Careers](/en/careers/)
* [Resources](/en/resources/)

LRQA and any variants are trading names of LRQA Group Limited, its subsidiaries and affiliates. LRQA Group Limited, registered number 1217474, is a limited company registered in England and Wales. Registered office: 1, Trinity Park, Bickenhill Lane, Birmingham B37 7ES. © 2024 LRQA Group Limited.

* [Privacy notice](/en/privacy-notice/)
* [Cookie Policy](/en/cookies-policy/)
* [Terms of use](/en/terms-of-use/)
* [Modern Slavery Statement](/en/who-we-are/modern-slavery/)
* [Governance](/en/who-we-are/governance-policies/)



=== Content from github.com_12df04c6_20250119_124619.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnettitude%2Fmetasploit-modules)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnettitude%2Fmetasploit-modules)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=nettitude%2Fmetasploit-modules)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nettitude](/nettitude)
/
**[metasploit-modules](/nettitude/metasploit-modules)**
Public

* [Notifications](/login?return_to=%2Fnettitude%2Fmetasploit-modules) You must be signed in to change notification settings
* [Fork
  8](/login?return_to=%2Fnettitude%2Fmetasploit-modules)
* [Star
   12](/login?return_to=%2Fnettitude%2Fmetasploit-modules)

Modules created by Nettitude for Metasploit

[12
stars](/nettitude/metasploit-modules/stargazers) [8
forks](/nettitude/metasploit-modules/forks) [Branches](/nettitude/metasploit-modules/branches) [Tags](/nettitude/metasploit-modules/tags) [Activity](/nettitude/metasploit-modules/activity)
 [Star](/login?return_to=%2Fnettitude%2Fmetasploit-modules)

 [Notifications](/login?return_to=%2Fnettitude%2Fmetasploit-modules) You must be signed in to change notification settings

* [Code](/nettitude/metasploit-modules)
* [Issues
  0](/nettitude/metasploit-modules/issues)
* [Pull requests
  0](/nettitude/metasploit-modules/pulls)
* [Actions](/nettitude/metasploit-modules/actions)
* [Projects
  0](/nettitude/metasploit-modules/projects)
* [Security](/nettitude/metasploit-modules/security)
* [Insights](/nettitude/metasploit-modules/pulse)

Additional navigation options

* [Code](/nettitude/metasploit-modules)
* [Issues](/nettitude/metasploit-modules/issues)
* [Pull requests](/nettitude/metasploit-modules/pulls)
* [Actions](/nettitude/metasploit-modules/actions)
* [Projects](/nettitude/metasploit-modules/projects)
* [Security](/nettitude/metasploit-modules/security)
* [Insights](/nettitude/metasploit-modules/pulse)

# nettitude/metasploit-modules

    master[Branches](/nettitude/metasploit-modules/branches)[Tags](/nettitude/metasploit-modules/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[5 Commits](/nettitude/metasploit-modules/commits/master/) | | |
| [.gitignore](/nettitude/metasploit-modules/blob/master/.gitignore ".gitignore") | | [.gitignore](/nettitude/metasploit-modules/blob/master/.gitignore ".gitignore") |  |  |
| [README.md](/nettitude/metasploit-modules/blob/master/README.md "README.md") | | [README.md](/nettitude/metasploit-modules/blob/master/README.md "README.md") |  |  |
| [orchid\_core\_vms\_directory\_traversal.rb](/nettitude/metasploit-modules/blob/master/orchid_core_vms_directory_traversal.rb "orchid_core_vms_directory_traversal.rb") | | [orchid\_core\_vms\_directory\_traversal.rb](/nettitude/metasploit-modules/blob/master/orchid_core_vms_directory_traversal.rb "orchid_core_vms_directory_traversal.rb") |  |  |
| [teltonika\_add\_user.rb](/nettitude/metasploit-modules/blob/master/teltonika_add_user.rb "teltonika_add_user.rb") | | [teltonika\_add\_user.rb](/nettitude/metasploit-modules/blob/master/teltonika_add_user.rb "teltonika_add_user.rb") |  |  |
| [teltonika\_cmd\_exec.rb](/nettitude/metasploit-modules/blob/master/teltonika_cmd_exec.rb "teltonika_cmd_exec.rb") | | [teltonika\_cmd\_exec.rb](/nettitude/metasploit-modules/blob/master/teltonika_cmd_exec.rb "teltonika_cmd_exec.rb") |  |  |
| View all files | | |

## Repository files navigation

* README
# metasploit-modules

Modules created by Nettitude for Metasploit

orchid\_core\_vms\_directory\_traversal.rb - CVE-2018-10956

teltonika\_add\_user.rb - CVE-2017-8117

teltonika\_cmd\_exec.rb - CVE-2017-8117

## About

Modules created by Nettitude for Metasploit

### Resources

[Readme](#readme-ov-file)

[Activity](/nettitude/metasploit-modules/activity)
[Custom properties](/nettitude/metasploit-modules/custom-properties)
### Stars

[**12**
stars](/nettitude/metasploit-modules/stargazers)
### Watchers

[**8**
watching](/nettitude/metasploit-modules/watchers)
### Forks

[**8**
forks](/nettitude/metasploit-modules/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fnettitude%2Fmetasploit-modules&report=nettitude+%28user%29)

## [Releases](/nettitude/metasploit-modules/releases)

No releases published

## [Packages 0](/orgs/nettitude/packages?repo_name=metasploit-modules)

No packages published

## [Contributors 3](/nettitude/metasploit-modules/graphs/contributors)

## Languages

* [Ruby
  100.0%](/nettitude/metasploit-modules/search?l=ruby)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


