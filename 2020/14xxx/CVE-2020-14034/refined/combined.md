=== Content from github.com_5b4db299_20250119_134926.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-43r3-f7j4-6552)

**CVE-2020-14034**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-43r3-f7j4-6552)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2020-14034](/advisories/GHSA-43r3-f7j4-6552)

## An issue was discovered in janus-gateway (aka Janus...

High severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
•
Updated Jan 29, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-43r3-f7j4-6552/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

An issue was discovered in janus-gateway (aka Janus WebRTC Server) through 0.10.0. janus\_get\_codec\_from\_pt in utils.c has a Buffer Overflow via long value in an SDP Offer packet.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-14034>
* [meetecho/janus-gateway#2229](https://github.com/meetecho/janus-gateway/pull/2229)
* <https://github.com/meetecho/janus-gateway/blob/v0.10.0/utils.c#L381>
* <https://github.com/meetecho/janus-gateway/blob/v0.10.0/utils.c#L401>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-14034)
Jun 15, 2020

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Jan 29, 2023

### Severity

High

### [EPSS score](https://www.first.org/epss/user-guide)

0.358%
 (72nd percentile)

### Weaknesses

No CWEs

### CVE ID

CVE-2020-14034

### GHSA ID

GHSA-43r3-f7j4-6552

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-43r3-f7j4-6552/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e1485266_20250119_120617.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmeetecho%2Fjanus-gateway%2Fblob%2Fv0.10.0%2Futils.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmeetecho%2Fjanus-gateway%2Fblob%2Fv0.10.0%2Futils.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=meetecho%2Fjanus-gateway)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[meetecho](/meetecho)
/
**[janus-gateway](/meetecho/janus-gateway)**
Public

* [Notifications](/login?return_to=%2Fmeetecho%2Fjanus-gateway) You must be signed in to change notification settings
* [Fork
  2.5k](/login?return_to=%2Fmeetecho%2Fjanus-gateway)
* [Star
   8.4k](/login?return_to=%2Fmeetecho%2Fjanus-gateway)

* [Code](/meetecho/janus-gateway/tree/v0.10.0)
* [Issues
  15](/meetecho/janus-gateway/issues)
* [Pull requests
  14](/meetecho/janus-gateway/pulls)
* [Actions](/meetecho/janus-gateway/actions)
* [Security](/meetecho/janus-gateway/security)
* [Insights](/meetecho/janus-gateway/pulse)

Additional navigation options

* [Code](/meetecho/janus-gateway/tree/v0.10.0)
* [Issues](/meetecho/janus-gateway/issues)
* [Pull requests](/meetecho/janus-gateway/pulls)
* [Actions](/meetecho/janus-gateway/actions)
* [Security](/meetecho/janus-gateway/security)
* [Insights](/meetecho/janus-gateway/pulse)

## Files

 v0.10.0
## Breadcrumbs

1. [janus-gateway](/meetecho/janus-gateway/tree/v0.10.0)
/
# utils.c

Copy path Blame  Blame
## Latest commit

## History

[History](/meetecho/janus-gateway/commits/v0.10.0/utils.c)1159 lines (1108 loc) · 29.6 KB v0.10.0
## Breadcrumbs

1. [janus-gateway](/meetecho/janus-gateway/tree/v0.10.0)
/
# utils.c

Top
## File metadata and controls

* Code
* Blame

1159 lines (1108 loc) · 29.6 KB[Raw](https://github.com/meetecho/janus-gateway/raw/refs/tags/v0.10.0/utils.c)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000/\*! \file utils.c \* \author Lorenzo Miniero <lorenzo@meetecho.com> \* \copyright GNU General Public License v3 \* \brief Utilities and helpers \* \details Implementations of a few methods that may be of use here \* and there in the code. \* \* \ingroup core \* \ref core \*/
#include <stdlib.h>#include <string.h>#include <sys/stat.h>#include <errno.h>#include <fcntl.h>#include <sys/file.h>#include <sys/types.h>#include <unistd.h>#include <arpa/inet.h>#include <inttypes.h>
#include <zlib.h>
#include "utils.h"#include "debug.h"#include "mutex.h"
#if \_\_MACH\_\_#include "mach\_gettime.h"#endif
gint64 janus\_get\_monotonic\_time(void) { struct timespec ts; clock\_gettime (CLOCK\_MONOTONIC, &ts); return (ts.tv\_sec\*G\_GINT64\_CONSTANT(1000000)) + (ts.tv\_nsec/G\_GINT64\_CONSTANT(1000));}
gint64 janus\_get\_real\_time(void) { struct timespec ts; clock\_gettime (CLOCK\_REALTIME, &ts); return (ts.tv\_sec\*G\_GINT64\_CONSTANT(1000000)) + (ts.tv\_nsec/G\_GINT64\_CONSTANT(1000));}
gboolean janus\_is\_true(const char \*value) { return value && (!strcasecmp(value, "yes") || !strcasecmp(value, "true") || !strcasecmp(value, "1"));}
gboolean janus\_strcmp\_const\_time(const void \*str1, const void \*str2) { if(str1 == NULL || str2 == NULL) return FALSE; const unsigned char \*string1 = (const unsigned char \*)str1; const unsigned char \*string2 = (const unsigned char \*)str2; size\_t maxlen = strlen((char \*)string1); if(strlen((char \*)string2) > maxlen) maxlen = strlen((char \*)string2); unsigned char \*buf1 = g\_malloc0(maxlen+1); memcpy(buf1, string1, strlen(str1)); unsigned char \*buf2 = g\_malloc0(maxlen+1); memcpy(buf2, string2, strlen(str2)); unsigned char result = 0; size\_t i = 0; for (i = 0; i < maxlen; i++) { result |= buf1[i] ^ buf2[i]; } g\_free(buf1); buf1 = NULL; g\_free(buf2); buf2 = NULL; return result == 0;}
guint32 janus\_random\_uint32(void) { return g\_random\_int();}
guint64 janus\_random\_uint64(void) { /\* \* FIXME This needs to be improved, and use something that generates \* more strongly random stuff... using /dev/urandom is probably not \* a good idea, as we don't want to make it harder to cross compile Janus \* \* TODO Look into what libssl and/or libcrypto provide in that respect \* \* PS: JavaScript only supports integer up to 2^53, so we need to \* make sure the number is below 9007199254740992 for safety \*/ guint64 num = g\_random\_int() & 0x1FFFFF; num = (num << 32) | g\_random\_int(); return num;}
char \*janus\_random\_uuid(void) {#if GLIB\_CHECK\_VERSION(2, 52, 0) return g\_uuid\_string\_random();#else /\* g\_uuid\_string\_random is only available from glib 2.52, so if it's \* not available we have to do it manually: the following code is \* heavily based on https://github.com/rxi/uuid4 (MIT license) \*/ const char \*template = "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx"; const char \*samples = "0123456789abcdef"; union { unsigned char b[16]; uint64\_t word[2]; } rnd; rnd.word[0] = janus\_random\_uint64(); rnd.word[1] = janus\_random\_uint64(); /\* Generate the string \*/ char uuid[37], \*dst = uuid; const char \*p = template; int i = 0, n = 0; while(\*p) { n = rnd.b[i >> 1]; n = (i & 1) ? (n >> 4) : (n & 0xf); switch (\*p) { case 'x': \*dst = samples[n]; i++; break; case 'y': \*dst = samples[(n & 0x3) + 8]; i++; break; default: \*dst = \*p; } p++; dst++; } uuid[36] = '\0'; return g\_strdup(uuid);#endif}
guint64 \*janus\_uint64\_dup(guint64 num) { guint64 \*numdup = g\_malloc(sizeof(guint64)); \*numdup = num; return numdup;}
int janus\_string\_to\_uint8(const char \*str, uint8\_t \*num) { if(str == NULL || num == NULL) return -EINVAL; long int val = strtol(str, 0, 10); if(val < 0 || val > UINT8\_MAX) return -ERANGE; \*num = val; return 0;}
int janus\_string\_to\_uint16(const char \*str, uint16\_t \*num) { if(str == NULL || num == NULL) return -EINVAL; long int val = strtol(str, 0, 10); if(val < 0 || val > UINT16\_MAX) return -ERANGE; \*num = val; return 0;}
int janus\_string\_to\_uint32(const char \*str, uint32\_t \*num) { if(str == NULL || num == NULL) return -EINVAL; long long int val = strtoll(str, 0, 10); if(val < 0 || val > UINT32\_MAX) return -ERANGE; \*num = val; return 0;}
void janus\_flags\_reset(janus\_flags \*flags) { if(flags != NULL) g\_atomic\_pointer\_set(flags, 0);}
void janus\_flags\_set(janus\_flags \*flags, gsize flag) { if(flags != NULL) { g\_atomic\_pointer\_or(flags, flag); }}
void janus\_flags\_clear(janus\_flags \*flags, gsize flag) { if(flags != NULL) { g\_atomic\_pointer\_and(flags, ~(flag)); }}
gboolean janus\_flags\_is\_set(janus\_flags \*flags, gsize flag) { if(flags != NULL) { gsize bit = ((gsize) g\_atomic\_pointer\_get(flags)) & flag; return (bit != 0); } return FALSE;}
/\* Easy way to replace multiple occurrences of a string with another \*/char \*janus\_string\_replace(char \*message, const char \*old\_string, const char \*new\_string){ if(!message || !old\_string || !new\_string) return NULL;
 if(!strstr(message, old\_string)) { /\* Nothing to be done (old\_string is not there) \*/ return message; } if(!strcmp(old\_string, new\_string)) { /\* Nothing to be done (old\_string=new\_string) \*/ return message; } if(strlen(old\_string) == strlen(new\_string)) { /\* Just overwrite \*/ char \*outgoing = message; char \*pos = strstr(outgoing, old\_string), \*tmp = NULL; int i = 0; while(pos) { i++; memcpy(pos, new\_string, strlen(new\_string)); pos += strlen(old\_string); tmp = strstr(pos, old\_string); pos = tmp; } return outgoing; } else { /\* We need to resize \*/ char \*outgoing = g\_strdup(message); g\_free(message); if(outgoing == NULL) { return NULL; } int diff = strlen(new\_string) - strlen(old\_string); /\* Count occurrences \*/ int counter = 0; char \*pos = strstr(outgoing, old\_string), \*tmp = NULL; while(pos) { counter++; pos += strlen(old\_string); tmp = strstr(pos, old\_string); pos = tmp; } uint16\_t old\_stringlen = strlen(outgoing)+1, new\_stringlen = old\_stringlen + diff\*counter; if(diff > 0) { /\* Resize now \*/ tmp = g\_realloc(outgoing, new\_stringlen); outgoing = tmp; } /\* Replace string \*/ pos = strstr(outgoing, old\_string); while(pos) { if(diff > 0) { /\* Move to the right (new\_string is larger than old\_string) \*/ uint16\_t len = strlen(pos)+1; memmove(pos + diff, pos, len); memcpy(pos, new\_string, strlen(new\_string)); pos += strlen(new\_string); tmp = strstr(pos, old\_string); } else { /\* Move to the left (new\_string is smaller than old\_string) \*/ uint16\_t len = strlen(pos - diff)+1; memmove(pos, pos - diff, len); memcpy(pos, new\_string, strlen(new\_string)); pos += strlen(old\_string); tmp = strstr(pos, old\_string); } pos = tmp; } if(diff < 0) { /\* We skipped the resize previously (shrinking memory) \*/ tmp = g\_realloc(outgoing, new\_stringlen); outgoing = tmp; } outgoing[strlen(outgoing)] = '\0'; return outgoing; }}
int janus\_mkdir(const char \*dir, mode\_t mode) { char tmp[256]; char \*p = NULL; size\_t len;
 int res = 0; g\_snprintf(tmp, sizeof(tmp), "%s", dir); len = strlen(tmp); if(tmp[len - 1] == '/') tmp[len - 1] = 0; for(p = tmp + 1; \*p; p++) { if(\*p == '/') { \*p = 0; res = mkdir(tmp, mode); if(res != 0 && errno != EEXIST) { JANUS\_LOG(LOG\_ERR, "Error creating folder %s\n", tmp); return res; } \*p = '/'; } } res = mkdir(tmp, mode); if(res != 0 && errno != EEXIST) return res; return 0;}
int janus\_get\_codec\_pt(const char \*sdp, const char \*codec) { if(!sdp || !codec) return -1; int video = 0; const char \*format = NULL, \*format2 = NULL; if(!strcasecmp(codec, "opus")) { video = 0; format = "opus/48000/2"; format2 = "OPUS/48000/2"; } else if(!strcasecmp(codec, "pcmu")) { /\* We know the payload type is 0: we just need to make sure it's there \*/ video = 0; format = "pcmu/8000"; format2 = "PCMU/8000"; } else if(!strcasecmp(codec, "pcma")) { /\* We know the payload type is 8: we just need to make sure it's there \*/ video = 0; format = "pcma/8000"; format2 = "PCMA/8000"; } else if(!strcasecmp(codec, "g722")) { /\* We know the payload type is 9: we just need to make sure it's there \*/ video = 0; format = "g722/8000"; format2 = "G722/8000"; } else if(!strcasecmp(codec, "isac16")) { video = 0; format = "isac/16000"; format2 = "ISAC/16000"; } else if(!strcasecmp(codec, "isac32")) { video = 0; format = "isac/32000"; format2 = "ISAC/32000"; } else if(!strcasecmp(codec, "vp8")) { video = 1; format = "vp8/90000"; format2 = "VP8/90000"; } else if(!strcasecmp(codec, "vp9")) { video = 1; format = "vp9/90000"; format2 = "VP9/90000"; } else if(!strcasecmp(codec, "h264")) { video = 1; format = "h264/90000"; format2 = "H264/90000"; } else { JANUS\_LOG(LOG\_ERR, "Unsupported codec '%s'\n", codec); return -1; } /\* First of all, let's check if the codec is there \*/ if(!video) { if(!strstr(sdp, "m=audio") || (!strstr(sdp, format) && !strstr(sdp, format2))) return -2; } else { if(!strstr(sdp, "m=video") || (!strstr(sdp, format) && !strstr(sdp, format2))) return -2; } char rtpmap[50], rtpmap2[50]; g\_snprintf(rtpmap, 50, "a=rtpmap:%%d %s", format); g\_snprintf(rtpmap2, 50, "a=rtpmap:%%d %s", format2); /\* Look for the mapping \*/ const char \*line = strstr(sdp, video ? "m=video" : "m=audio"); while(line) { char \*next = strchr(line, '\n'); if(next) { \*next = '\0'; if(strstr(line, "a=rtpmap") && strstr(line, format)) { /\* Gotcha! \*/ int pt = 0;#pragma GCC diagnostic ignored "-Wformat-nonliteral" if(sscanf(line, rtpmap, &pt) == 1) { \*next = '\n'; return pt; } } else if(strstr(line, "a=rtpmap") && strstr(line, format2)) { /\* Gotcha! \*/ int pt = 0; if(sscanf(line, rtpmap2, &pt) == 1) {#pragma GCC diagnostic warning "-Wformat-nonliteral" \*next = '\n'; return pt; } } \*next = '\n'; } line = next ? (next+1) : NULL; } return -3;}
const char \*janus\_get\_codec\_from\_pt(const char \*sdp, int pt) { if(!sdp || pt < 0) return NULL; if(pt == 0) return "pcmu"; if(pt == 8) return "pcma"; if(pt == 9) return "g722"; /\* Look for the mapping \*/ char rtpmap[50]; g\_snprintf(rtpmap, 50, "a=rtpmap:%d ", pt); const char \*line = strstr(sdp, "m="); while(line) { char \*next = strchr(line, '\n'); if(next) { \*next = '\0'; if(strstr(line, rtpmap)) { /\* Gotcha! \*/ char name[100]; if(sscanf(line, "a=rtpmap:%d %s", &pt, name) == 2) { \*next = '\n'; if(strstr(name, "vp8") || strstr(name, "VP8")) return "vp8"; if(strstr(name, "vp9") || strstr(name, "VP9")) return "vp9"; if(strstr(name, "h264") || strstr(name, "H264")) return "h264"; if(strstr(name, "opus") || strstr(name, "OPUS")) return "opus"; if(strstr(name, "pcmu") || strstr(name, "PCMU")) return "pcmu"; if(strstr(name, "pcma") || strstr(name, "PCMA")) return "pcma"; if(strstr(name, "g722") || strstr(name, "G722")) return "g722"; if(strstr(name, "isac/16") || strstr(name, "ISAC/16")) return "isac16"; if(strstr(name, "isac/32") || strstr(name, "ISAC/32")) return "isac32"; JANUS\_LOG(LOG\_ERR, "Unsupported codec '%s'\n", name); return NULL; } } \*next = '\n'; } line = next ? (next+1) : NULL; } return NULL;}
/\* PID file management \*/static char \*pidfile = NULL;static int pidfd = -1;static FILE \*pidf = NULL;int janus\_pidfile\_create(const char \*file) { if(file == NULL) return 0; pidfile = g\_strdup(file); /\* Try creating a PID file (or opening an existing one) \*/ pidfd = open(pidfile, O\_RDWR|O\_CREAT|O\_TRUNC, 0644); if(pidfd < 0) { JANUS\_LOG(LOG\_FATAL, "Error opening/creating PID file %s, does Janus have enough permissions?\n", pidfile); return -1; } pidf = fdopen(pidfd, "r+"); if(pidf == NULL) { JANUS\_LOG(LOG\_FATAL, "Error opening/creating PID file %s, does Janus have enough permissions?\n", pidfile); close(pidfd); return -1; } /\* Try locking the PID file \*/ int pid = 0; if(flock(pidfd, LOCK\_EX|LOCK\_NB) < 0) { if(fscanf(pidf, "%d", &pid) == 1) { JANUS\_LOG(LOG\_FATAL, "Error locking PID file (lock held by PID %d?)\n", pid); } else { JANUS\_LOG(LOG\_FATAL, "Error locking PID file (lock held by unknown PID?)\n"); } fclose(pidf); return -1; } /\* Write the PID \*/ pid = getpid(); if(fprintf(pidf, "%d\n", pid) < 0) { JANUS\_LOG(LOG\_FATAL, "Error writing PID in file, error %d (%s)\n", errno, strerror(errno)); fclose(pidf); return -1; } fflush(pidf); /\* We're done \*/ return 0;}
int janus\_pidfile\_remove(void) { if(pidfile == NULL || pidfd < 0 || pidf == NULL) return 0; /\* Unlock the PID file and remove it \*/ if(flock(pidfd, LOCK\_UN) < 0) { JANUS\_LOG(LOG\_FATAL, "Error unlocking PID file\n"); fclose(pidf); close(pidfd); return -1; } fclose(pidf); unlink(pidfile); g\_free(pidfile); return 0;}
/\* Protected folders management \*/static GList \*protected\_folders = NULL;static janus\_mutex pf\_mutex = JANUS\_MUTEX\_INITIALIZER;
void janus\_protected\_folder\_add(const char \*folder) { if(folder == NULL) return; janus\_mutex\_lock(&pf\_mutex); protected\_folders = g\_list\_append(protected\_folders, g\_strdup(folder)); janus\_mutex\_unlock(&pf\_mutex);}
gboolean janus\_is\_folder\_protected(const char \*path) { /\* We need a valid pathname (can't start with a space, we don't trim) \*/ if(path == NULL || \*path == ' ') return TRUE; /\* Resolve the pathname to its real path first \*/ char resolved[PATH\_MAX+1]; resolved[0] = '\0'; if(realpath(path, resolved) == NULL && errno != ENOENT) { JANUS\_LOG(LOG\_ERR, "Error resolving path '%s'... %d (%s)\n", path, errno, strerror(errno)); return TRUE; } /\* Traverse the list of protected folders to see if any match \*/ janus\_mutex\_lock(&pf\_mutex); if(protected\_folders == NULL) { /\* No protected folder in the list \*/ janus\_mutex\_unlock(&pf\_mutex); return FALSE; } gboolean protected = FALSE; GList \*temp = protected\_folders; while(temp) { char \*folder = (char \*)temp->data; if(folder && (strstr(resolved, folder) == resolved)) { protected = TRUE; break; } temp = temp->next; } janus\_mutex\_unlock(&pf\_mutex); return protected;}
void janus\_protected\_folders\_clear(void) { janus\_mutex\_lock(&pf\_mutex); g\_list\_free\_full(protected\_folders, (GDestroyNotify)g\_free); janus\_mutex\_unlock(&pf\_mutex);}
void janus\_get\_json\_type\_name(int jtype, unsigned int flags, char \*type\_name) { /\* Longest possible combination is "a non-empty boolean" plus one for null char \*/ gsize req\_size = 20; /\* Don't allow for both "positive" and "non-empty" because that needlessly increases the size. \*/ if((flags & JANUS\_JSON\_PARAM\_POSITIVE) != 0) { g\_strlcpy(type\_name, "a positive ", req\_size); } else if((flags & JANUS\_JSON\_PARAM\_NONEMPTY) != 0) { g\_strlcpy(type\_name, "a non-empty ", req\_size); } else if(jtype == JSON\_INTEGER || jtype == JSON\_ARRAY || jtype == JSON\_OBJECT) { g\_strlcpy(type\_name, "an ", req\_size); } else { g\_strlcpy(type\_name, "a ", req\_size); } switch(jtype) { case JSON\_TRUE: g\_strlcat(type\_name, "boolean", req\_size); break; case JSON\_INTEGER: g\_strlcat(type\_name, "integer", req\_size); break; case JSON\_REAL: g\_strlcat(type\_name, "real", req\_size); break; case JSON\_STRING: g\_strlcat(type\_name, "string", req\_size); break; case JSON\_ARRAY: g\_strlcat(type\_name, "array", req\_size); break; case JSON\_OBJECT: g\_strlcat(type\_name, "object", req\_size); break; default: break; }}
gboolean janus\_json\_is\_valid(json\_t \*val, json\_type jtype, unsigned int flags) { gboolean is\_valid = (json\_typeof(val) == jtype || (jtype == JSON\_TRUE && json\_typeof(val) == JSON\_FALSE)); if(!is\_valid) return FALSE; if((flags & JANUS\_JSON\_PARAM\_POSITIVE) != 0) { switch(jtype) { case JSON\_INTEGER: is\_valid = (json\_integer\_value(val) >= 0); break; case JSON\_REAL: is\_valid = (json\_real\_value(val) >= 0); break; default: break; } } else if((flags & JANUS\_JSON\_PARAM\_NONEMPTY) != 0) { switch(jtype) { case JSON\_STRING: is\_valid = (strlen(json\_string\_value(val)) > 0); break; case JSON\_ARRAY: is\_valid = (json\_array\_size(val) > 0); break; default: break; } } return is\_valid;}
/\* The following code is more related to codec specific helpers \*/#if defined(\_\_ppc\_\_) || defined(\_\_ppc64\_\_) # define swap2(d) \ ((d&0x000000ff)<<8) | \ ((d&0x0000ff00)>>8)#else # define swap2(d) d#endif
gboolean janus\_vp8\_is\_keyframe(const char \*buffer, int len) { if(!buffer || len < 16) return FALSE; /\* Parse VP8 header now \*/ uint8\_t vp8pd = \*buffer; uint8\_t xbit = (vp8pd & 0x80); uint8\_t sbit = (vp8pd & 0x10); if(xbit) { JANUS\_LOG(LOG\_HUGE, " -- X bit is set!\n"); /\* Read the Extended control bits octet \*/ buffer++; vp8pd = \*buffer; uint8\_t ibit = (vp8pd & 0x80); uint8\_t lbit = (vp8pd & 0x40); uint8\_t tbit = (vp8pd & 0x20); uint8\_t kbit = (vp8pd & 0x10); if(ibit) { JANUS\_LOG(LOG\_HUGE, " -- I bit is set!\n"); /\* Read the PictureID octet \*/ buffer++; vp8pd = \*buffer; uint16\_t picid = vp8pd, wholepicid = picid; uint8\_t mbit = (vp8pd & 0x80); if(mbit) { JANUS\_LOG(LOG\_HUGE, " -- M bit is set!\n"); memcpy(&picid, buffer, sizeof(uint16\_t)); wholepicid = ntohs(picid); picid = (wholepicid & 0x7FFF); buffer++; } JANUS\_LOG(LOG\_HUGE, " -- -- PictureID: %"SCNu16"\n", picid); } if(lbit) { JANUS\_LOG(LOG\_HUGE, " -- L bit is set!\n"); /\* Read the TL0PICIDX octet \*/ buffer++; vp8pd = \*buffer; } if(tbit || kbit) { JANUS\_LOG(LOG\_HUGE, " -- T/K bit is set!\n"); /\* Read the TID/KEYIDX octet \*/ buffer++; vp8pd = \*buffer; } buffer++; /\* Now we're in the payload \*/ if(sbit) { JANUS\_LOG(LOG\_HUGE, " -- S bit is set!\n"); unsigned long int vp8ph = 0; memcpy(&vp8ph, buffer, 4); vp8ph = ntohl(vp8ph); uint8\_t pbit = ((vp8ph & 0x01000000) >> 24); if(!pbit) { JANUS\_LOG(LOG\_HUGE, " -- P bit is NOT set!\n"); /\* It is a key frame! Get resolution for debugging \*/ unsigned char \*c = (unsigned char \*)buffer+3; /\* vet via sync code \*/ if(c[0]!=0x9d||c[1]!=0x01||c[2]!=0x2a) { JANUS\_LOG(LOG\_HUGE, "First 3-bytes after header not what they're supposed to be?\n"); } else { unsigned short val3, val5; memcpy(&val3,c+3,sizeof(short)); int vp8w = swap2(val3)&0x3fff; int vp8ws = swap2(val3)>>14; memcpy(&val5,c+5,sizeof(short)); int vp8h = swap2(val5)&0x3fff; int vp8hs = swap2(val5)>>14; JANUS\_LOG(LOG\_HUGE, "Got a VP8 key frame: %dx%d (scale=%dx%d)\n", vp8w, vp8h, vp8ws, vp8hs); return TRUE; } } } } /\* If we got here it's not a key frame \*/ return FALSE;}
gboolean janus\_vp9\_is\_keyframe(const char \*buffer, int len) { if(!buffer || len < 16) return FALSE; /\* Parse VP9 header now \*/ uint8\_t vp9pd = \*buffer; uint8\_t ibit = (vp9pd & 0x80); uint8\_t pbit = (vp9pd & 0x40); uint8\_t lbit = (vp9pd & 0x20); uint8\_t fbit = (vp9pd & 0x10); uint8\_t vbit = (vp9pd & 0x02); buffer++; len--; if(ibit) { /\* Read the PictureID octet \*/ vp9pd = \*buffer; uint16\_t picid = vp9pd, wholepicid = picid; uint8\_t mbit = (vp9pd & 0x80); if(!mbit) { buffer++; len--; } else { memcpy(&picid, buffer, sizeof(uint16\_t)); wholepicid = ntohs(picid); picid = (wholepicid & 0x7FFF); buffer += 2; len -= 2; } } if(lbit) { buffer++; len--; if(!fbit) { /\* Non-flexible mode, skip TL0PICIDX \*/ buffer++; len--; } } if(fbit && pbit) { /\* Skip reference indices \*/ uint8\_t nbit = 1; while(nbit) { vp9pd = \*buffer; nbit = (vp9pd & 0x01); buffer++; len--; if(len == 0) /\* Make sure we don't overflow \*/ return FALSE; } } if(vbit) { /\* Parse and skip SS \*/ vp9pd = \*buffer; uint n\_s = (vp9pd & 0xE0) >> 5; n\_s++; uint8\_t ybit = (vp9pd & 0x10); if(ybit) { /\* Iterate on all spatial layers and get resolution \*/ buffer++; len--; if(len == 0) /\* Make sure we don't overflow \*/ return FALSE; uint i=0; for(i=0; i<n\_s && len>=4; i++,len-=4) { /\* Width \*/ uint16\_t w; memcpy(&w, buffer, sizeof(uint16\_t)); int vp9w = ntohs(w); buffer += 2; /\* Height \*/ uint16\_t h; memcpy(&h, buffer, sizeof(uint16\_t)); int vp9h = ntohs(h); buffer += 2; if(vp9w || vp9h) { JANUS\_LOG(LOG\_HUGE, "Got a VP9 key frame: %dx%d\n", vp9w, vp9h); return TRUE; } } } } /\* If we got here it's not a key frame \*/ return FALSE;}
gboolean janus\_h264\_is\_keyframe(const char \*buffer, int len) { if(!buffer || len < 6) return FALSE; /\* Parse H264 header now \*/ uint8\_t fragment = \*buffer & 0x1F; uint8\_t nal = \*(buffer+1) & 0x1F; if(fragment == 7 || ((fragment == 28 || fragment == 29) && nal == 7)) { JANUS\_LOG(LOG\_HUGE, "Got an H264 key frame\n"); return TRUE; } else if(fragment == 24) { /\* May we find an SPS in this STAP-A? \*/ buffer++; len--; uint16\_t psize = 0; /\* We're reading 3 bytes \*/ while(len > 2) { memcpy(&psize, buffer, 2); psize = ntohs(psize); buffer += 2; len -= 2; int nal = \*buffer & 0x1F; if(nal == 7) { JANUS\_LOG(LOG\_HUGE, "Got an SPS/PPS\n"); return TRUE; } buffer += psize; len -= psize; } } /\* If we got here it's not a key frame \*/ return FALSE;}
int janus\_vp8\_parse\_descriptor(char \*buffer, int len, uint16\_t \*picid, uint8\_t \*tl0picidx, uint8\_t \*tid, uint8\_t \*y, uint8\_t \*keyidx) { if(!buffer || len < 6) return -1; if(picid) \*picid = 0; if(tl0picidx) \*tl0picidx = 0; if(tid) \*tid = 0; if(y) \*y = 0; if(keyidx) \*keyidx = 0; uint8\_t vp8pd = \*buffer; uint8\_t xbit = (vp8pd & 0x80); /\* Read the Extended control bits octet \*/ if(xbit) { buffer++; vp8pd = \*buffer; uint8\_t ibit = (vp8pd & 0x80); uint8\_t lbit = (vp8pd & 0x40); uint8\_t tbit = (vp8pd & 0x20); uint8\_t kbit = (vp8pd & 0x10); if(ibit) { /\* Read the PictureID octet \*/ buffer++; vp8pd = \*buffer; uint16\_t partpicid = vp8pd, wholepicid = partpicid; uint8\_t mbit = (vp8pd & 0x80); if(mbit) { memcpy(&partpicid, buffer, sizeof(uint16\_t)); wholepicid = ntohs(partpicid); partpicid = (wholepicid & 0x7FFF); if(picid) \*picid = partpicid; buffer++; } } if(lbit) { /\* Read the TL0PICIDX octet \*/ buffer++; vp8pd = \*buffer; if(tl0picidx) \*tl0picidx = vp8pd; } if(tbit || kbit) { /\* Read the TID/Y/KEYIDX octet \*/ buffer++; vp8pd = \*buffer; if(tid) \*tid = (vp8pd & 0xC0) >> 6; if(y) \*y = (vp8pd & 0x20) >> 5; if(keyidx) \*keyidx = (vp8pd & 0x1F) >> 4; } } return 0;}
static int janus\_vp8\_replace\_descriptor(char \*buffer, int len, uint16\_t picid, uint8\_t tl0picidx) { if(!buffer || len < 6) return -1; uint8\_t vp8pd = \*buffer; uint8\_t xbit = (vp8pd & 0x80); /\* Read the Extended control bits octet \*/ if(xbit) { buffer++; vp8pd = \*buffer; uint8\_t ibit = (vp8pd & 0x80); uint8\_t lbit = (vp8pd & 0x40); uint8\_t tbit = (vp8pd & 0x20); uint8\_t kbit = (vp8pd & 0x10); if(ibit) { /\* Overwrite the PictureID octet \*/ buffer++; vp8pd = \*buffer; uint8\_t mbit = (vp8pd & 0x80); if(!mbit) { \*buffer = picid; } else { uint16\_t wholepicid = htons(picid); memcpy(buffer, &wholepicid, 2); \*buffer |= 0x80; buffer++; } } if(lbit) { /\* Overwrite the TL0PICIDX octet \*/ buffer++; \*buffer = tl0picidx; } if(tbit || kbit) { /\* Should we overwrite the TID/Y/KEYIDX octet? \*/ buffer++; } } return 0;}
void janus\_vp8\_simulcast\_context\_reset(janus\_vp8\_simulcast\_context \*context) { if(context == NULL) return; /\* Reset the context values \*/ context->last\_picid = 0; context->base\_picid = 0; context->base\_picid\_prev = 0; context->last\_tlzi = 0; context->base\_tlzi = 0; context->base\_tlzi\_prev = 0;}
void janus\_vp8\_simulcast\_descriptor\_update(char \*buffer, int len, janus\_vp8\_simulcast\_context \*context, gboolean switched) { if(!buffer || len < 0) return; uint16\_t picid = 0; uint8\_t tlzi = 0; uint8\_t tid = 0; uint8\_t ybit = 0; uint8\_t keyidx = 0; /\* Parse the identifiers in the VP8 payload descriptor \*/ if(janus\_vp8\_parse\_descriptor(buffer, len, &picid, &tlzi, &tid, &ybit, &keyidx) < 0) return; if(switched) { context->base\_picid\_prev = context->last\_picid; context->base\_picid = picid; context->base\_tlzi\_prev = context->last\_tlzi; context->base\_tlzi = tlzi; } context->last\_picid = (picid-context->base\_picid)+context->base\_picid\_prev+1; context->last\_tlzi = (tlzi-context->base\_tlzi)+context->base\_tlzi\_prev+1; /\* Overwrite the values in the VP8 payload descriptors with the ones we have \*/ janus\_vp8\_replace\_descriptor(buffer, len, context->last\_picid, context->last\_tlzi);}
/\* Helper method to parse a VP9 RTP video frame and get some SVC-related info: \* notice that this only works with VP9, right now, on an experimental basis \*/int janus\_vp9\_parse\_svc(char \*buffer, int len, gboolean \*found, janus\_vp9\_svc\_info \*info) { if(!buffer || len < 8) return -1; /\* VP9 depay: \*/ /\* https://tools.ietf.org/html/draft-ietf-payload-vp9-04 \*/ /\* Read the first octet (VP9 Payload Descriptor) \*/ uint8\_t vp9pd = \*buffer; uint8\_t ibit = (vp9pd & 0x80) >> 7; uint8\_t pbit = (vp9pd & 0x40) >> 6; uint8\_t lbit = (vp9pd & 0x20) >> 5; uint8\_t fbit = (vp9pd & 0x10) >> 4; uint8\_t bbit = (vp9pd & 0x08) >> 3; uint8\_t ebit = (vp9pd & 0x04) >> 2; uint8\_t vbit = (vp9pd & 0x02) >> 1; if(!lbit) { /\* No Layer indices present, no need to go on \*/ if(found) \*found = FALSE; return 0; } /\* Move to the next octet and see what's there \*/ buffer++; len--; if(ibit) { /\* Read the PictureID octet \*/ vp9pd = \*buffer; uint16\_t picid = vp9pd, wholepicid = picid; uint8\_t mbit = (vp9pd & 0x80); if(!mbit) { buffer++; len--; } else { memcpy(&picid, buffer, sizeof(uint16\_t)); wholepicid = ntohs(picid); picid = (wholepicid & 0x7FFF); buffer += 2; len -= 2; } } if(lbit) { /\* Read the octet and parse the layer indices now \*/ vp9pd = \*buffer; int tlid = (vp9pd & 0xE0) >> 5; uint8\_t ubit = (vp9pd & 0x10) >> 4; int slid = (vp9pd & 0x0E) >> 1; uint8\_t dbit = (vp9pd & 0x01); JANUS\_LOG(LOG\_HUGE, "%s Mode, Layer indices: Temporal: %d (u=%u), Spatial: %d (d=%u)\n",[View remainder of file in raw view](https://github.com/meetecho/janus-gateway/raw/refs/tags/v0.10.0/utils.c)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_dbb18a14_20250119_134926.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-w68x-w98g-jr89)

**CVE-2020-14033**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-w68x-w98g-jr89)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2020-14033](/advisories/GHSA-w68x-w98g-jr89)

## An issue was discovered in janus-gateway (aka Janus...

High severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
•
Updated Jan 29, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-w68x-w98g-jr89/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

An issue was discovered in janus-gateway (aka Janus WebRTC Server) through 0.10.0. janus\_streaming\_rtsp\_parse\_sdp in plugins/janus\_streaming.c has a Buffer Overflow via a crafted RTSP server.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-14033>
* [meetecho/janus-gateway#2229](https://github.com/meetecho/janus-gateway/pull/2229)
* <https://github.com/meetecho/janus-gateway/blob/v0.10.0/plugins/janus_streaming.c#L6117>
* <https://github.com/meetecho/janus-gateway/blob/v0.10.0/plugins/janus_streaming.c#L6166>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-14033)
Jun 15, 2020

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Jan 29, 2023

### Severity

High

### [EPSS score](https://www.first.org/epss/user-guide)

0.358%
 (72nd percentile)

### Weaknesses

No CWEs

### CVE ID

CVE-2020-14033

### GHSA ID

GHSA-w68x-w98g-jr89

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-w68x-w98g-jr89/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d38a071b_20250119_120614.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmeetecho%2Fjanus-gateway%2Fblob%2Fv0.10.0%2Futils.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmeetecho%2Fjanus-gateway%2Fblob%2Fv0.10.0%2Futils.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=meetecho%2Fjanus-gateway)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[meetecho](/meetecho)
/
**[janus-gateway](/meetecho/janus-gateway)**
Public

* [Notifications](/login?return_to=%2Fmeetecho%2Fjanus-gateway) You must be signed in to change notification settings
* [Fork
  2.5k](/login?return_to=%2Fmeetecho%2Fjanus-gateway)
* [Star
   8.4k](/login?return_to=%2Fmeetecho%2Fjanus-gateway)

* [Code](/meetecho/janus-gateway/tree/v0.10.0)
* [Issues
  15](/meetecho/janus-gateway/issues)
* [Pull requests
  14](/meetecho/janus-gateway/pulls)
* [Actions](/meetecho/janus-gateway/actions)
* [Security](/meetecho/janus-gateway/security)
* [Insights](/meetecho/janus-gateway/pulse)

Additional navigation options

* [Code](/meetecho/janus-gateway/tree/v0.10.0)
* [Issues](/meetecho/janus-gateway/issues)
* [Pull requests](/meetecho/janus-gateway/pulls)
* [Actions](/meetecho/janus-gateway/actions)
* [Security](/meetecho/janus-gateway/security)
* [Insights](/meetecho/janus-gateway/pulse)

## Files

 v0.10.0
## Breadcrumbs

1. [janus-gateway](/meetecho/janus-gateway/tree/v0.10.0)
/
# utils.c

Copy path Blame  Blame
## Latest commit

## History

[History](/meetecho/janus-gateway/commits/v0.10.0/utils.c)1159 lines (1108 loc) · 29.6 KB v0.10.0
## Breadcrumbs

1. [janus-gateway](/meetecho/janus-gateway/tree/v0.10.0)
/
# utils.c

Top
## File metadata and controls

* Code
* Blame

1159 lines (1108 loc) · 29.6 KB[Raw](https://github.com/meetecho/janus-gateway/raw/refs/tags/v0.10.0/utils.c)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000/\*! \file utils.c \* \author Lorenzo Miniero <lorenzo@meetecho.com> \* \copyright GNU General Public License v3 \* \brief Utilities and helpers \* \details Implementations of a few methods that may be of use here \* and there in the code. \* \* \ingroup core \* \ref core \*/
#include <stdlib.h>#include <string.h>#include <sys/stat.h>#include <errno.h>#include <fcntl.h>#include <sys/file.h>#include <sys/types.h>#include <unistd.h>#include <arpa/inet.h>#include <inttypes.h>
#include <zlib.h>
#include "utils.h"#include "debug.h"#include "mutex.h"
#if \_\_MACH\_\_#include "mach\_gettime.h"#endif
gint64 janus\_get\_monotonic\_time(void) { struct timespec ts; clock\_gettime (CLOCK\_MONOTONIC, &ts); return (ts.tv\_sec\*G\_GINT64\_CONSTANT(1000000)) + (ts.tv\_nsec/G\_GINT64\_CONSTANT(1000));}
gint64 janus\_get\_real\_time(void) { struct timespec ts; clock\_gettime (CLOCK\_REALTIME, &ts); return (ts.tv\_sec\*G\_GINT64\_CONSTANT(1000000)) + (ts.tv\_nsec/G\_GINT64\_CONSTANT(1000));}
gboolean janus\_is\_true(const char \*value) { return value && (!strcasecmp(value, "yes") || !strcasecmp(value, "true") || !strcasecmp(value, "1"));}
gboolean janus\_strcmp\_const\_time(const void \*str1, const void \*str2) { if(str1 == NULL || str2 == NULL) return FALSE; const unsigned char \*string1 = (const unsigned char \*)str1; const unsigned char \*string2 = (const unsigned char \*)str2; size\_t maxlen = strlen((char \*)string1); if(strlen((char \*)string2) > maxlen) maxlen = strlen((char \*)string2); unsigned char \*buf1 = g\_malloc0(maxlen+1); memcpy(buf1, string1, strlen(str1)); unsigned char \*buf2 = g\_malloc0(maxlen+1); memcpy(buf2, string2, strlen(str2)); unsigned char result = 0; size\_t i = 0; for (i = 0; i < maxlen; i++) { result |= buf1[i] ^ buf2[i]; } g\_free(buf1); buf1 = NULL; g\_free(buf2); buf2 = NULL; return result == 0;}
guint32 janus\_random\_uint32(void) { return g\_random\_int();}
guint64 janus\_random\_uint64(void) { /\* \* FIXME This needs to be improved, and use something that generates \* more strongly random stuff... using /dev/urandom is probably not \* a good idea, as we don't want to make it harder to cross compile Janus \* \* TODO Look into what libssl and/or libcrypto provide in that respect \* \* PS: JavaScript only supports integer up to 2^53, so we need to \* make sure the number is below 9007199254740992 for safety \*/ guint64 num = g\_random\_int() & 0x1FFFFF; num = (num << 32) | g\_random\_int(); return num;}
char \*janus\_random\_uuid(void) {#if GLIB\_CHECK\_VERSION(2, 52, 0) return g\_uuid\_string\_random();#else /\* g\_uuid\_string\_random is only available from glib 2.52, so if it's \* not available we have to do it manually: the following code is \* heavily based on https://github.com/rxi/uuid4 (MIT license) \*/ const char \*template = "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx"; const char \*samples = "0123456789abcdef"; union { unsigned char b[16]; uint64\_t word[2]; } rnd; rnd.word[0] = janus\_random\_uint64(); rnd.word[1] = janus\_random\_uint64(); /\* Generate the string \*/ char uuid[37], \*dst = uuid; const char \*p = template; int i = 0, n = 0; while(\*p) { n = rnd.b[i >> 1]; n = (i & 1) ? (n >> 4) : (n & 0xf); switch (\*p) { case 'x': \*dst = samples[n]; i++; break; case 'y': \*dst = samples[(n & 0x3) + 8]; i++; break; default: \*dst = \*p; } p++; dst++; } uuid[36] = '\0'; return g\_strdup(uuid);#endif}
guint64 \*janus\_uint64\_dup(guint64 num) { guint64 \*numdup = g\_malloc(sizeof(guint64)); \*numdup = num; return numdup;}
int janus\_string\_to\_uint8(const char \*str, uint8\_t \*num) { if(str == NULL || num == NULL) return -EINVAL; long int val = strtol(str, 0, 10); if(val < 0 || val > UINT8\_MAX) return -ERANGE; \*num = val; return 0;}
int janus\_string\_to\_uint16(const char \*str, uint16\_t \*num) { if(str == NULL || num == NULL) return -EINVAL; long int val = strtol(str, 0, 10); if(val < 0 || val > UINT16\_MAX) return -ERANGE; \*num = val; return 0;}
int janus\_string\_to\_uint32(const char \*str, uint32\_t \*num) { if(str == NULL || num == NULL) return -EINVAL; long long int val = strtoll(str, 0, 10); if(val < 0 || val > UINT32\_MAX) return -ERANGE; \*num = val; return 0;}
void janus\_flags\_reset(janus\_flags \*flags) { if(flags != NULL) g\_atomic\_pointer\_set(flags, 0);}
void janus\_flags\_set(janus\_flags \*flags, gsize flag) { if(flags != NULL) { g\_atomic\_pointer\_or(flags, flag); }}
void janus\_flags\_clear(janus\_flags \*flags, gsize flag) { if(flags != NULL) { g\_atomic\_pointer\_and(flags, ~(flag)); }}
gboolean janus\_flags\_is\_set(janus\_flags \*flags, gsize flag) { if(flags != NULL) { gsize bit = ((gsize) g\_atomic\_pointer\_get(flags)) & flag; return (bit != 0); } return FALSE;}
/\* Easy way to replace multiple occurrences of a string with another \*/char \*janus\_string\_replace(char \*message, const char \*old\_string, const char \*new\_string){ if(!message || !old\_string || !new\_string) return NULL;
 if(!strstr(message, old\_string)) { /\* Nothing to be done (old\_string is not there) \*/ return message; } if(!strcmp(old\_string, new\_string)) { /\* Nothing to be done (old\_string=new\_string) \*/ return message; } if(strlen(old\_string) == strlen(new\_string)) { /\* Just overwrite \*/ char \*outgoing = message; char \*pos = strstr(outgoing, old\_string), \*tmp = NULL; int i = 0; while(pos) { i++; memcpy(pos, new\_string, strlen(new\_string)); pos += strlen(old\_string); tmp = strstr(pos, old\_string); pos = tmp; } return outgoing; } else { /\* We need to resize \*/ char \*outgoing = g\_strdup(message); g\_free(message); if(outgoing == NULL) { return NULL; } int diff = strlen(new\_string) - strlen(old\_string); /\* Count occurrences \*/ int counter = 0; char \*pos = strstr(outgoing, old\_string), \*tmp = NULL; while(pos) { counter++; pos += strlen(old\_string); tmp = strstr(pos, old\_string); pos = tmp; } uint16\_t old\_stringlen = strlen(outgoing)+1, new\_stringlen = old\_stringlen + diff\*counter; if(diff > 0) { /\* Resize now \*/ tmp = g\_realloc(outgoing, new\_stringlen); outgoing = tmp; } /\* Replace string \*/ pos = strstr(outgoing, old\_string); while(pos) { if(diff > 0) { /\* Move to the right (new\_string is larger than old\_string) \*/ uint16\_t len = strlen(pos)+1; memmove(pos + diff, pos, len); memcpy(pos, new\_string, strlen(new\_string)); pos += strlen(new\_string); tmp = strstr(pos, old\_string); } else { /\* Move to the left (new\_string is smaller than old\_string) \*/ uint16\_t len = strlen(pos - diff)+1; memmove(pos, pos - diff, len); memcpy(pos, new\_string, strlen(new\_string)); pos += strlen(old\_string); tmp = strstr(pos, old\_string); } pos = tmp; } if(diff < 0) { /\* We skipped the resize previously (shrinking memory) \*/ tmp = g\_realloc(outgoing, new\_stringlen); outgoing = tmp; } outgoing[strlen(outgoing)] = '\0'; return outgoing; }}
int janus\_mkdir(const char \*dir, mode\_t mode) { char tmp[256]; char \*p = NULL; size\_t len;
 int res = 0; g\_snprintf(tmp, sizeof(tmp), "%s", dir); len = strlen(tmp); if(tmp[len - 1] == '/') tmp[len - 1] = 0; for(p = tmp + 1; \*p; p++) { if(\*p == '/') { \*p = 0; res = mkdir(tmp, mode); if(res != 0 && errno != EEXIST) { JANUS\_LOG(LOG\_ERR, "Error creating folder %s\n", tmp); return res; } \*p = '/'; } } res = mkdir(tmp, mode); if(res != 0 && errno != EEXIST) return res; return 0;}
int janus\_get\_codec\_pt(const char \*sdp, const char \*codec) { if(!sdp || !codec) return -1; int video = 0; const char \*format = NULL, \*format2 = NULL; if(!strcasecmp(codec, "opus")) { video = 0; format = "opus/48000/2"; format2 = "OPUS/48000/2"; } else if(!strcasecmp(codec, "pcmu")) { /\* We know the payload type is 0: we just need to make sure it's there \*/ video = 0; format = "pcmu/8000"; format2 = "PCMU/8000"; } else if(!strcasecmp(codec, "pcma")) { /\* We know the payload type is 8: we just need to make sure it's there \*/ video = 0; format = "pcma/8000"; format2 = "PCMA/8000"; } else if(!strcasecmp(codec, "g722")) { /\* We know the payload type is 9: we just need to make sure it's there \*/ video = 0; format = "g722/8000"; format2 = "G722/8000"; } else if(!strcasecmp(codec, "isac16")) { video = 0; format = "isac/16000"; format2 = "ISAC/16000"; } else if(!strcasecmp(codec, "isac32")) { video = 0; format = "isac/32000"; format2 = "ISAC/32000"; } else if(!strcasecmp(codec, "vp8")) { video = 1; format = "vp8/90000"; format2 = "VP8/90000"; } else if(!strcasecmp(codec, "vp9")) { video = 1; format = "vp9/90000"; format2 = "VP9/90000"; } else if(!strcasecmp(codec, "h264")) { video = 1; format = "h264/90000"; format2 = "H264/90000"; } else { JANUS\_LOG(LOG\_ERR, "Unsupported codec '%s'\n", codec); return -1; } /\* First of all, let's check if the codec is there \*/ if(!video) { if(!strstr(sdp, "m=audio") || (!strstr(sdp, format) && !strstr(sdp, format2))) return -2; } else { if(!strstr(sdp, "m=video") || (!strstr(sdp, format) && !strstr(sdp, format2))) return -2; } char rtpmap[50], rtpmap2[50]; g\_snprintf(rtpmap, 50, "a=rtpmap:%%d %s", format); g\_snprintf(rtpmap2, 50, "a=rtpmap:%%d %s", format2); /\* Look for the mapping \*/ const char \*line = strstr(sdp, video ? "m=video" : "m=audio"); while(line) { char \*next = strchr(line, '\n'); if(next) { \*next = '\0'; if(strstr(line, "a=rtpmap") && strstr(line, format)) { /\* Gotcha! \*/ int pt = 0;#pragma GCC diagnostic ignored "-Wformat-nonliteral" if(sscanf(line, rtpmap, &pt) == 1) { \*next = '\n'; return pt; } } else if(strstr(line, "a=rtpmap") && strstr(line, format2)) { /\* Gotcha! \*/ int pt = 0; if(sscanf(line, rtpmap2, &pt) == 1) {#pragma GCC diagnostic warning "-Wformat-nonliteral" \*next = '\n'; return pt; } } \*next = '\n'; } line = next ? (next+1) : NULL; } return -3;}
const char \*janus\_get\_codec\_from\_pt(const char \*sdp, int pt) { if(!sdp || pt < 0) return NULL; if(pt == 0) return "pcmu"; if(pt == 8) return "pcma"; if(pt == 9) return "g722"; /\* Look for the mapping \*/ char rtpmap[50]; g\_snprintf(rtpmap, 50, "a=rtpmap:%d ", pt); const char \*line = strstr(sdp, "m="); while(line) { char \*next = strchr(line, '\n'); if(next) { \*next = '\0'; if(strstr(line, rtpmap)) { /\* Gotcha! \*/ char name[100]; if(sscanf(line, "a=rtpmap:%d %s", &pt, name) == 2) { \*next = '\n'; if(strstr(name, "vp8") || strstr(name, "VP8")) return "vp8"; if(strstr(name, "vp9") || strstr(name, "VP9")) return "vp9"; if(strstr(name, "h264") || strstr(name, "H264")) return "h264"; if(strstr(name, "opus") || strstr(name, "OPUS")) return "opus"; if(strstr(name, "pcmu") || strstr(name, "PCMU")) return "pcmu"; if(strstr(name, "pcma") || strstr(name, "PCMA")) return "pcma"; if(strstr(name, "g722") || strstr(name, "G722")) return "g722"; if(strstr(name, "isac/16") || strstr(name, "ISAC/16")) return "isac16"; if(strstr(name, "isac/32") || strstr(name, "ISAC/32")) return "isac32"; JANUS\_LOG(LOG\_ERR, "Unsupported codec '%s'\n", name); return NULL; } } \*next = '\n'; } line = next ? (next+1) : NULL; } return NULL;}
/\* PID file management \*/static char \*pidfile = NULL;static int pidfd = -1;static FILE \*pidf = NULL;int janus\_pidfile\_create(const char \*file) { if(file == NULL) return 0; pidfile = g\_strdup(file); /\* Try creating a PID file (or opening an existing one) \*/ pidfd = open(pidfile, O\_RDWR|O\_CREAT|O\_TRUNC, 0644); if(pidfd < 0) { JANUS\_LOG(LOG\_FATAL, "Error opening/creating PID file %s, does Janus have enough permissions?\n", pidfile); return -1; } pidf = fdopen(pidfd, "r+"); if(pidf == NULL) { JANUS\_LOG(LOG\_FATAL, "Error opening/creating PID file %s, does Janus have enough permissions?\n", pidfile); close(pidfd); return -1; } /\* Try locking the PID file \*/ int pid = 0; if(flock(pidfd, LOCK\_EX|LOCK\_NB) < 0) { if(fscanf(pidf, "%d", &pid) == 1) { JANUS\_LOG(LOG\_FATAL, "Error locking PID file (lock held by PID %d?)\n", pid); } else { JANUS\_LOG(LOG\_FATAL, "Error locking PID file (lock held by unknown PID?)\n"); } fclose(pidf); return -1; } /\* Write the PID \*/ pid = getpid(); if(fprintf(pidf, "%d\n", pid) < 0) { JANUS\_LOG(LOG\_FATAL, "Error writing PID in file, error %d (%s)\n", errno, strerror(errno)); fclose(pidf); return -1; } fflush(pidf); /\* We're done \*/ return 0;}
int janus\_pidfile\_remove(void) { if(pidfile == NULL || pidfd < 0 || pidf == NULL) return 0; /\* Unlock the PID file and remove it \*/ if(flock(pidfd, LOCK\_UN) < 0) { JANUS\_LOG(LOG\_FATAL, "Error unlocking PID file\n"); fclose(pidf); close(pidfd); return -1; } fclose(pidf); unlink(pidfile); g\_free(pidfile); return 0;}
/\* Protected folders management \*/static GList \*protected\_folders = NULL;static janus\_mutex pf\_mutex = JANUS\_MUTEX\_INITIALIZER;
void janus\_protected\_folder\_add(const char \*folder) { if(folder == NULL) return; janus\_mutex\_lock(&pf\_mutex); protected\_folders = g\_list\_append(protected\_folders, g\_strdup(folder)); janus\_mutex\_unlock(&pf\_mutex);}
gboolean janus\_is\_folder\_protected(const char \*path) { /\* We need a valid pathname (can't start with a space, we don't trim) \*/ if(path == NULL || \*path == ' ') return TRUE; /\* Resolve the pathname to its real path first \*/ char resolved[PATH\_MAX+1]; resolved[0] = '\0'; if(realpath(path, resolved) == NULL && errno != ENOENT) { JANUS\_LOG(LOG\_ERR, "Error resolving path '%s'... %d (%s)\n", path, errno, strerror(errno)); return TRUE; } /\* Traverse the list of protected folders to see if any match \*/ janus\_mutex\_lock(&pf\_mutex); if(protected\_folders == NULL) { /\* No protected folder in the list \*/ janus\_mutex\_unlock(&pf\_mutex); return FALSE; } gboolean protected = FALSE; GList \*temp = protected\_folders; while(temp) { char \*folder = (char \*)temp->data; if(folder && (strstr(resolved, folder) == resolved)) { protected = TRUE; break; } temp = temp->next; } janus\_mutex\_unlock(&pf\_mutex); return protected;}
void janus\_protected\_folders\_clear(void) { janus\_mutex\_lock(&pf\_mutex); g\_list\_free\_full(protected\_folders, (GDestroyNotify)g\_free); janus\_mutex\_unlock(&pf\_mutex);}
void janus\_get\_json\_type\_name(int jtype, unsigned int flags, char \*type\_name) { /\* Longest possible combination is "a non-empty boolean" plus one for null char \*/ gsize req\_size = 20; /\* Don't allow for both "positive" and "non-empty" because that needlessly increases the size. \*/ if((flags & JANUS\_JSON\_PARAM\_POSITIVE) != 0) { g\_strlcpy(type\_name, "a positive ", req\_size); } else if((flags & JANUS\_JSON\_PARAM\_NONEMPTY) != 0) { g\_strlcpy(type\_name, "a non-empty ", req\_size); } else if(jtype == JSON\_INTEGER || jtype == JSON\_ARRAY || jtype == JSON\_OBJECT) { g\_strlcpy(type\_name, "an ", req\_size); } else { g\_strlcpy(type\_name, "a ", req\_size); } switch(jtype) { case JSON\_TRUE: g\_strlcat(type\_name, "boolean", req\_size); break; case JSON\_INTEGER: g\_strlcat(type\_name, "integer", req\_size); break; case JSON\_REAL: g\_strlcat(type\_name, "real", req\_size); break; case JSON\_STRING: g\_strlcat(type\_name, "string", req\_size); break; case JSON\_ARRAY: g\_strlcat(type\_name, "array", req\_size); break; case JSON\_OBJECT: g\_strlcat(type\_name, "object", req\_size); break; default: break; }}
gboolean janus\_json\_is\_valid(json\_t \*val, json\_type jtype, unsigned int flags) { gboolean is\_valid = (json\_typeof(val) == jtype || (jtype == JSON\_TRUE && json\_typeof(val) == JSON\_FALSE)); if(!is\_valid) return FALSE; if((flags & JANUS\_JSON\_PARAM\_POSITIVE) != 0) { switch(jtype) { case JSON\_INTEGER: is\_valid = (json\_integer\_value(val) >= 0); break; case JSON\_REAL: is\_valid = (json\_real\_value(val) >= 0); break; default: break; } } else if((flags & JANUS\_JSON\_PARAM\_NONEMPTY) != 0) { switch(jtype) { case JSON\_STRING: is\_valid = (strlen(json\_string\_value(val)) > 0); break; case JSON\_ARRAY: is\_valid = (json\_array\_size(val) > 0); break; default: break; } } return is\_valid;}
/\* The following code is more related to codec specific helpers \*/#if defined(\_\_ppc\_\_) || defined(\_\_ppc64\_\_) # define swap2(d) \ ((d&0x000000ff)<<8) | \ ((d&0x0000ff00)>>8)#else # define swap2(d) d#endif
gboolean janus\_vp8\_is\_keyframe(const char \*buffer, int len) { if(!buffer || len < 16) return FALSE; /\* Parse VP8 header now \*/ uint8\_t vp8pd = \*buffer; uint8\_t xbit = (vp8pd & 0x80); uint8\_t sbit = (vp8pd & 0x10); if(xbit) { JANUS\_LOG(LOG\_HUGE, " -- X bit is set!\n"); /\* Read the Extended control bits octet \*/ buffer++; vp8pd = \*buffer; uint8\_t ibit = (vp8pd & 0x80); uint8\_t lbit = (vp8pd & 0x40); uint8\_t tbit = (vp8pd & 0x20); uint8\_t kbit = (vp8pd & 0x10); if(ibit) { JANUS\_LOG(LOG\_HUGE, " -- I bit is set!\n"); /\* Read the PictureID octet \*/ buffer++; vp8pd = \*buffer; uint16\_t picid = vp8pd, wholepicid = picid; uint8\_t mbit = (vp8pd & 0x80); if(mbit) { JANUS\_LOG(LOG\_HUGE, " -- M bit is set!\n"); memcpy(&picid, buffer, sizeof(uint16\_t)); wholepicid = ntohs(picid); picid = (wholepicid & 0x7FFF); buffer++; } JANUS\_LOG(LOG\_HUGE, " -- -- PictureID: %"SCNu16"\n", picid); } if(lbit) { JANUS\_LOG(LOG\_HUGE, " -- L bit is set!\n"); /\* Read the TL0PICIDX octet \*/ buffer++; vp8pd = \*buffer; } if(tbit || kbit) { JANUS\_LOG(LOG\_HUGE, " -- T/K bit is set!\n"); /\* Read the TID/KEYIDX octet \*/ buffer++; vp8pd = \*buffer; } buffer++; /\* Now we're in the payload \*/ if(sbit) { JANUS\_LOG(LOG\_HUGE, " -- S bit is set!\n"); unsigned long int vp8ph = 0; memcpy(&vp8ph, buffer, 4); vp8ph = ntohl(vp8ph); uint8\_t pbit = ((vp8ph & 0x01000000) >> 24); if(!pbit) { JANUS\_LOG(LOG\_HUGE, " -- P bit is NOT set!\n"); /\* It is a key frame! Get resolution for debugging \*/ unsigned char \*c = (unsigned char \*)buffer+3; /\* vet via sync code \*/ if(c[0]!=0x9d||c[1]!=0x01||c[2]!=0x2a) { JANUS\_LOG(LOG\_HUGE, "First 3-bytes after header not what they're supposed to be?\n"); } else { unsigned short val3, val5; memcpy(&val3,c+3,sizeof(short)); int vp8w = swap2(val3)&0x3fff; int vp8ws = swap2(val3)>>14; memcpy(&val5,c+5,sizeof(short)); int vp8h = swap2(val5)&0x3fff; int vp8hs = swap2(val5)>>14; JANUS\_LOG(LOG\_HUGE, "Got a VP8 key frame: %dx%d (scale=%dx%d)\n", vp8w, vp8h, vp8ws, vp8hs); return TRUE; } } } } /\* If we got here it's not a key frame \*/ return FALSE;}
gboolean janus\_vp9\_is\_keyframe(const char \*buffer, int len) { if(!buffer || len < 16) return FALSE; /\* Parse VP9 header now \*/ uint8\_t vp9pd = \*buffer; uint8\_t ibit = (vp9pd & 0x80); uint8\_t pbit = (vp9pd & 0x40); uint8\_t lbit = (vp9pd & 0x20); uint8\_t fbit = (vp9pd & 0x10); uint8\_t vbit = (vp9pd & 0x02); buffer++; len--; if(ibit) { /\* Read the PictureID octet \*/ vp9pd = \*buffer; uint16\_t picid = vp9pd, wholepicid = picid; uint8\_t mbit = (vp9pd & 0x80); if(!mbit) { buffer++; len--; } else { memcpy(&picid, buffer, sizeof(uint16\_t)); wholepicid = ntohs(picid); picid = (wholepicid & 0x7FFF); buffer += 2; len -= 2; } } if(lbit) { buffer++; len--; if(!fbit) { /\* Non-flexible mode, skip TL0PICIDX \*/ buffer++; len--; } } if(fbit && pbit) { /\* Skip reference indices \*/ uint8\_t nbit = 1; while(nbit) { vp9pd = \*buffer; nbit = (vp9pd & 0x01); buffer++; len--; if(len == 0) /\* Make sure we don't overflow \*/ return FALSE; } } if(vbit) { /\* Parse and skip SS \*/ vp9pd = \*buffer; uint n\_s = (vp9pd & 0xE0) >> 5; n\_s++; uint8\_t ybit = (vp9pd & 0x10); if(ybit) { /\* Iterate on all spatial layers and get resolution \*/ buffer++; len--; if(len == 0) /\* Make sure we don't overflow \*/ return FALSE; uint i=0; for(i=0; i<n\_s && len>=4; i++,len-=4) { /\* Width \*/ uint16\_t w; memcpy(&w, buffer, sizeof(uint16\_t)); int vp9w = ntohs(w); buffer += 2; /\* Height \*/ uint16\_t h; memcpy(&h, buffer, sizeof(uint16\_t)); int vp9h = ntohs(h); buffer += 2; if(vp9w || vp9h) { JANUS\_LOG(LOG\_HUGE, "Got a VP9 key frame: %dx%d\n", vp9w, vp9h); return TRUE; } } } } /\* If we got here it's not a key frame \*/ return FALSE;}
gboolean janus\_h264\_is\_keyframe(const char \*buffer, int len) { if(!buffer || len < 6) return FALSE; /\* Parse H264 header now \*/ uint8\_t fragment = \*buffer & 0x1F; uint8\_t nal = \*(buffer+1) & 0x1F; if(fragment == 7 || ((fragment == 28 || fragment == 29) && nal == 7)) { JANUS\_LOG(LOG\_HUGE, "Got an H264 key frame\n"); return TRUE; } else if(fragment == 24) { /\* May we find an SPS in this STAP-A? \*/ buffer++; len--; uint16\_t psize = 0; /\* We're reading 3 bytes \*/ while(len > 2) { memcpy(&psize, buffer, 2); psize = ntohs(psize); buffer += 2; len -= 2; int nal = \*buffer & 0x1F; if(nal == 7) { JANUS\_LOG(LOG\_HUGE, "Got an SPS/PPS\n"); return TRUE; } buffer += psize; len -= psize; } } /\* If we got here it's not a key frame \*/ return FALSE;}
int janus\_vp8\_parse\_descriptor(char \*buffer, int len, uint16\_t \*picid, uint8\_t \*tl0picidx, uint8\_t \*tid, uint8\_t \*y, uint8\_t \*keyidx) { if(!buffer || len < 6) return -1; if(picid) \*picid = 0; if(tl0picidx) \*tl0picidx = 0; if(tid) \*tid = 0; if(y) \*y = 0; if(keyidx) \*keyidx = 0; uint8\_t vp8pd = \*buffer; uint8\_t xbit = (vp8pd & 0x80); /\* Read the Extended control bits octet \*/ if(xbit) { buffer++; vp8pd = \*buffer; uint8\_t ibit = (vp8pd & 0x80); uint8\_t lbit = (vp8pd & 0x40); uint8\_t tbit = (vp8pd & 0x20); uint8\_t kbit = (vp8pd & 0x10); if(ibit) { /\* Read the PictureID octet \*/ buffer++; vp8pd = \*buffer; uint16\_t partpicid = vp8pd, wholepicid = partpicid; uint8\_t mbit = (vp8pd & 0x80); if(mbit) { memcpy(&partpicid, buffer, sizeof(uint16\_t)); wholepicid = ntohs(partpicid); partpicid = (wholepicid & 0x7FFF); if(picid) \*picid = partpicid; buffer++; } } if(lbit) { /\* Read the TL0PICIDX octet \*/ buffer++; vp8pd = \*buffer; if(tl0picidx) \*tl0picidx = vp8pd; } if(tbit || kbit) { /\* Read the TID/Y/KEYIDX octet \*/ buffer++; vp8pd = \*buffer; if(tid) \*tid = (vp8pd & 0xC0) >> 6; if(y) \*y = (vp8pd & 0x20) >> 5; if(keyidx) \*keyidx = (vp8pd & 0x1F) >> 4; } } return 0;}
static int janus\_vp8\_replace\_descriptor(char \*buffer, int len, uint16\_t picid, uint8\_t tl0picidx) { if(!buffer || len < 6) return -1; uint8\_t vp8pd = \*buffer; uint8\_t xbit = (vp8pd & 0x80); /\* Read the Extended control bits octet \*/ if(xbit) { buffer++; vp8pd = \*buffer; uint8\_t ibit = (vp8pd & 0x80); uint8\_t lbit = (vp8pd & 0x40); uint8\_t tbit = (vp8pd & 0x20); uint8\_t kbit = (vp8pd & 0x10); if(ibit) { /\* Overwrite the PictureID octet \*/ buffer++; vp8pd = \*buffer; uint8\_t mbit = (vp8pd & 0x80); if(!mbit) { \*buffer = picid; } else { uint16\_t wholepicid = htons(picid); memcpy(buffer, &wholepicid, 2); \*buffer |= 0x80; buffer++; } } if(lbit) { /\* Overwrite the TL0PICIDX octet \*/ buffer++; \*buffer = tl0picidx; } if(tbit || kbit) { /\* Should we overwrite the TID/Y/KEYIDX octet? \*/ buffer++; } } return 0;}
void janus\_vp8\_simulcast\_context\_reset(janus\_vp8\_simulcast\_context \*context) { if(context == NULL) return; /\* Reset the context values \*/ context->last\_picid = 0; context->base\_picid = 0; context->base\_picid\_prev = 0; context->last\_tlzi = 0; context->base\_tlzi = 0; context->base\_tlzi\_prev = 0;}
void janus\_vp8\_simulcast\_descriptor\_update(char \*buffer, int len, janus\_vp8\_simulcast\_context \*context, gboolean switched) { if(!buffer || len < 0) return; uint16\_t picid = 0; uint8\_t tlzi = 0; uint8\_t tid = 0; uint8\_t ybit = 0; uint8\_t keyidx = 0; /\* Parse the identifiers in the VP8 payload descriptor \*/ if(janus\_vp8\_parse\_descriptor(buffer, len, &picid, &tlzi, &tid, &ybit, &keyidx) < 0) return; if(switched) { context->base\_picid\_prev = context->last\_picid; context->base\_picid = picid; context->base\_tlzi\_prev = context->last\_tlzi; context->base\_tlzi = tlzi; } context->last\_picid = (picid-context->base\_picid)+context->base\_picid\_prev+1; context->last\_tlzi = (tlzi-context->base\_tlzi)+context->base\_tlzi\_prev+1; /\* Overwrite the values in the VP8 payload descriptors with the ones we have \*/ janus\_vp8\_replace\_descriptor(buffer, len, context->last\_picid, context->last\_tlzi);}
/\* Helper method to parse a VP9 RTP video frame and get some SVC-related info: \* notice that this only works with VP9, right now, on an experimental basis \*/int janus\_vp9\_parse\_svc(char \*buffer, int len, gboolean \*found, janus\_vp9\_svc\_info \*info) { if(!buffer || len < 8) return -1; /\* VP9 depay: \*/ /\* https://tools.ietf.org/html/draft-ietf-payload-vp9-04 \*/ /\* Read the first octet (VP9 Payload Descriptor) \*/ uint8\_t vp9pd = \*buffer; uint8\_t ibit = (vp9pd & 0x80) >> 7; uint8\_t pbit = (vp9pd & 0x40) >> 6; uint8\_t lbit = (vp9pd & 0x20) >> 5; uint8\_t fbit = (vp9pd & 0x10) >> 4; uint8\_t bbit = (vp9pd & 0x08) >> 3; uint8\_t ebit = (vp9pd & 0x04) >> 2; uint8\_t vbit = (vp9pd & 0x02) >> 1; if(!lbit) { /\* No Layer indices present, no need to go on \*/ if(found) \*found = FALSE; return 0; } /\* Move to the next octet and see what's there \*/ buffer++; len--; if(ibit) { /\* Read the PictureID octet \*/ vp9pd = \*buffer; uint16\_t picid = vp9pd, wholepicid = picid; uint8\_t mbit = (vp9pd & 0x80); if(!mbit) { buffer++; len--; } else { memcpy(&picid, buffer, sizeof(uint16\_t)); wholepicid = ntohs(picid); picid = (wholepicid & 0x7FFF); buffer += 2; len -= 2; } } if(lbit) { /\* Read the octet and parse the layer indices now \*/ vp9pd = \*buffer; int tlid = (vp9pd & 0xE0) >> 5; uint8\_t ubit = (vp9pd & 0x10) >> 4; int slid = (vp9pd & 0x0E) >> 1; uint8\_t dbit = (vp9pd & 0x01); JANUS\_LOG(LOG\_HUGE, "%s Mode, Layer indices: Temporal: %d (u=%u), Spatial: %d (d=%u)\n",[View remainder of file in raw view](https://github.com/meetecho/janus-gateway/raw/refs/tags/v0.10.0/utils.c)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_3bf6a46b_20250119_120617.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmeetecho%2Fjanus-gateway%2Fpull%2F2229)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmeetecho%2Fjanus-gateway%2Fpull%2F2229)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=meetecho%2Fjanus-gateway)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[meetecho](/meetecho)
/
**[janus-gateway](/meetecho/janus-gateway)**
Public

* [Notifications](/login?return_to=%2Fmeetecho%2Fjanus-gateway) You must be signed in to change notification settings
* [Fork
  2.5k](/login?return_to=%2Fmeetecho%2Fjanus-gateway)
* [Star
   8.4k](/login?return_to=%2Fmeetecho%2Fjanus-gateway)

* [Code](/meetecho/janus-gateway)
* [Issues
  15](/meetecho/janus-gateway/issues)
* [Pull requests
  14](/meetecho/janus-gateway/pulls)
* [Actions](/meetecho/janus-gateway/actions)
* [Security](/meetecho/janus-gateway/security)
* [Insights](/meetecho/janus-gateway/pulse)

Additional navigation options

* [Code](/meetecho/janus-gateway)
* [Issues](/meetecho/janus-gateway/issues)
* [Pull requests](/meetecho/janus-gateway/pulls)
* [Actions](/meetecho/janus-gateway/actions)
* [Security](/meetecho/janus-gateway/security)
* [Insights](/meetecho/janus-gateway/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmeetecho%2Fjanus-gateway%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmeetecho%2Fjanus-gateway%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix sscanf-related security issues #2229

 Merged

[lminiero](/lminiero)
merged 1 commit into
[master](/meetecho/janus-gateway/tree/master "meetecho/janus-gateway:master")
from
[sscanf-fixes](/meetecho/janus-gateway/tree/sscanf-fixes "meetecho/janus-gateway:sscanf-fixes")

Jun 15, 2020

 Merged

# [Fix sscanf-related security issues](#top) #2229

[lminiero](/lminiero)
merged 1 commit into
[master](/meetecho/janus-gateway/tree/master "meetecho/janus-gateway:master")
from
[sscanf-fixes](/meetecho/janus-gateway/tree/sscanf-fixes "meetecho/janus-gateway:sscanf-fixes")

Jun 15, 2020

[Conversation
0](/meetecho/janus-gateway/pull/2229)
[Commits
1](/meetecho/janus-gateway/pull/2229/commits)
[Checks
0](/meetecho/janus-gateway/pull/2229/checks)
[Files changed](/meetecho/janus-gateway/pull/2229/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![lminiero](https://avatars.githubusercontent.com/u/3684796?s=60&v=4)](/lminiero)

Copy link

Member

### @lminiero **[lminiero](/lminiero)** commented [Jun 15, 2020](#issue-638765096) • edited Loading

We've been notified about a couple of security issues related to a broken usage of sscanf (reserved IDs: [CVE-2020-14033](https://github.com/advisories/GHSA-w68x-w98g-jr89 "CVE-2020-14033"), [CVE-2020-14034](https://github.com/advisories/GHSA-43r3-f7j4-6552 "CVE-2020-14034"), discovered by Marat Gayanov at Digital Security dsec.ru). Using that information, we extended the fix to a couple of other locations where the issue was present but not reported.

Merging right away, considering these are important fixes and I can't replicate them anymore.

Sorry, something went wrong.

All reactions

[![@lminiero](https://avatars.githubusercontent.com/u/3684796?s=40&v=4)](/lminiero)

`[Fix sscanf-related security issues](/meetecho/janus-gateway/pull/2229/commits/fb85040405495748dbc7c4850b97da9b67b7b47b "Fix sscanf-related security issues")`

`[fb85040](/meetecho/janus-gateway/pull/2229/commits/fb85040405495748dbc7c4850b97da9b67b7b47b)`

[![@lminiero](https://avatars.githubusercontent.com/u/3684796?s=40&v=4)](/lminiero)
[lminiero](/lminiero)
merged commit [`dacb4ed`](/meetecho/janus-gateway/commit/dacb4edfad8e77f73b64d8c175cca0a7796ebf80)
into
master

[Jun 15, 2020](https://github.com/meetecho/janus-gateway/pull/2229#event-3443882147)

 [![@lminiero](https://avatars.githubusercontent.com/u/3684796?s=40&v=4)](/lminiero)
[lminiero](/lminiero)
deleted the
sscanf-fixes

branch
[June 15, 2020 11:12](#event-3443882434)

[![@vincentfretin](https://avatars.githubusercontent.com/u/112249?s=40&v=4)](/vincentfretin)
[vincentfretin](/vincentfretin)
mentioned this pull request
[Aug 29, 2020](#ref-issue-627438503)

[Plugin no longer loads with latest libnice and janus-gateway
mozilla/janus-plugin-sfu#58](/mozilla/janus-plugin-sfu/issues/58)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmeetecho%2Fjanus-gateway%2Fpull%2F2229)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

1 participant

[![@lminiero](https://avatars.githubusercontent.com/u/3684796?s=52&v=4)](/lminiero)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


