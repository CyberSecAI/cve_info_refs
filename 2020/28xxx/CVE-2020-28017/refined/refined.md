The provided content is related to CVE-2020-28017.

**Root Cause of Vulnerability:**

The vulnerability is due to an integer overflow in the `receive_add_recipient()` function. This function allocates memory to store recipient information as Exim receives RCPT TO commands.

**Weaknesses/Vulnerabilities Present:**

*   **Integer Overflow:** When the number of recipients exceeds a certain threshold (52,428,800), the multiplication `recipients_list_max * sizeof(recipient_item)` overflows, resulting in a negative value.
*   **Heap Back-Jump:** The negative size is then passed to `store_get()`, which causes a "back-jump," decreasing the memory pointer.
*   **Heap Overflow:** A subsequent memcpy results in a "forward-overflow" which leads to overwriting the heap.

**Impact of Exploitation:**

*   **Unauthenticated Remote Code Execution:** Although difficult to exploit in default configurations due to large memory requirements (25GB+), it can result in unauthenticated RCE as the 'exim' user.

**Attack Vectors:**

*   **Remote Attack:** Sending a large number of `RCPT TO` commands to the Exim server to trigger the overflow.
*  **Local Attack:** Using the `-bS` option and `smtp_setup_batch_msg()` which does not use ACLs

**Required Attacker Capabilities/Position:**

*   **Remote:**
    *   An attacker must be able to connect to the Exim server and send SMTP commands.
    *  The attacker must send a very large number of RCPT TO commands to trigger the vulnerability
*   **Local:**
    * The attacker needs local access on the machine where Exim is running.
    * The attacker must send a very large number of RCPT TO commands via the `-bS` command to trigger the vulnerability.

**Additional Details:**

*   The document explains how a back-jump and forward-overflow combination, made possible through Exim's memory allocator, allows for overwriting critical configuration strings in heap.
*   The document notes this vulnerability exists since the beginning of Exim's Git history (2004).
*   The document outlines the reason it was difficult to exploit this vulnerability (large memory consumption and time complexity), and why the researchers opted to exploit CVE-2020-28020 instead.