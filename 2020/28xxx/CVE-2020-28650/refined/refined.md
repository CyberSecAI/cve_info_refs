Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause of Vulnerability:**

The WPBakery plugin improperly disabled HTML filtering checks using `kses_remove_filters()` in the `saveAjaxFe` function. Additionally, it allowed access to the editor for any post by supplying the correct parameters, regardless of whether the post was built with the WPBakery page builder. This, combined with custom `onclick` functionality for buttons and the ability to use shortcodes like `vc_raw_js`, `vc_raw_html`, made it possible for lower-level authenticated users to inject malicious JavaScript.

**Weaknesses/Vulnerabilities Present:**

*   **Authenticated Stored Cross-Site Scripting (XSS):** The core vulnerability is the ability for authenticated users with contributor-level or higher permissions to inject malicious JavaScript into posts and pages.
*   **Inadequate Input Sanitization:** The use of `kses_remove_filters()` disabled the default WordPress HTML filtering, allowing unfiltered HTML and JavaScript input.
*  **Incorrect Access Control:** The ability for users to access the editor by supplying correct parameters and values for any post allowed users to modify content not intended to be modified by the page builder

**Impact of Exploitation:**

*   **Malicious Script Injection:** Attackers could inject malicious JavaScript that would execute when a user accessed a page or clicked a button containing the injected script.
*   **Privilege Escalation:** By injecting scripts that execute in an administrator's browser, attackers could create new administrative users, inject backdoors, or perform other malicious actions.
*   **Data Manipulation:** Lower-level users could edit other user's posts without the appropriate permissions.

**Attack Vectors:**

*   **WPBakery Page Builder:** Exploiting the flawed design of the page builder to inject malicious code.
*   **`saveAjaxFe` function:** Utilizing this function to save content containing malicious code.
*   **Custom `onclick` functionality:** Injecting malicious JavaScript into button `onclick` attributes.
*   **Shortcodes:** Using shortcodes like `vc_raw_js`, `vc_raw_html` to add malicious code.

**Required Attacker Capabilities/Position:**

*   **Authenticated Access:** Attackers needed to be authenticated users with contributor-level or higher permissions on the WordPress site.
*   **Access to WPBakery Page Builder:** Attackers needed to be able to access the page builder, or to manipulate the parameters to allow the saving of arbitrary content.

The vulnerability was fixed in version 6.4.1 of the WPBakery plugin. The Wordfence blog post recommends updating to this version and also provides a defense strategy of dual accounts to mitigate the impact of XSS attacks on administrative accounts by using a separate account with lower privileges (editor) to perform most content related tasks.