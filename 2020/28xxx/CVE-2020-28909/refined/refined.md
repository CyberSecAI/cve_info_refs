```
{
  "Root cause of vulnerability": "The `getprofile.sh` script, which can be executed with `sudo` by both `nagios` and `apache` users, reads content from `/usr/local/nagiosxi/tmp/phpmailer.log` and writes it to `/usr/local/nagiosxi/var/components/profile/$folder/phpmailer.log`. The script does not sanitize or validate the contents of `phpmailer.log`, which can be controlled by a malicious actor. Moreover, by creating a symlink in place of the target file, a malicious actor can redirect the file write to arbitrary locations.",
  "Weaknesses/vulnerabilities present": [
    "Command injection",
    "Insecure file handling",
    "Privilege escalation"
  ],
  "Impact of exploitation": "An attacker can escalate privileges from a low privileged `apache` or `nagios` user to `root` by injecting malicious code into a log file, redirecting file writes via symlinks, and then executing the modified `repair_databases.sh` script with elevated privileges.",
  "Attack vectors": "An authenticated attacker with access to a Nagios XI server can achieve code execution as the apache user by exploiting a command injection vulnerability, then use the file handling vulnerability in conjunction with a sudoers entry to elevate their privileges to root.",
  "Required attacker capabilities/position": "The attacker requires an authenticated session on a Nagios XI system and the ability to execute commands as the apache or nagios user."
}
```