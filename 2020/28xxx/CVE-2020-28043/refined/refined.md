The provided content is related to CVE-2020-28043.

**Root cause of vulnerability:**
The vulnerability is caused by the MISP REST client allowing users to issue queries to arbitrary servers by using a full path parameter. This is due to the application not properly sanitizing or validating the URL provided by the user.

**Weaknesses/vulnerabilities present:**
- Server-Side Request Forgery (SSRF): The primary vulnerability is SSRF, where an attacker can make the server send requests to arbitrary URLs, including internal ones.

**Impact of exploitation:**
- An attacker could potentially scan internal network infrastructure or access sensitive internal services, especially if the MISP server has access to other internal servers.
- External users can trigger the server to send requests to internal servers.

**Attack vectors:**
- The attacker would need to utilize the REST client functionality with the `use_full_path` parameter set, providing a URL of their choice.
- An attacker needs to make a crafted request via the REST client.

**Required attacker capabilities/position:**
- The attacker needs to have access to the MISP instance and the ability to use the REST client functionality.
- The attacker does not need to be internal to the network, as this could be exploited by external users.

**Additional Details:**
- The fix involves adding a configuration option `rest_client_enable_arbitrary_urls` which is disabled by default, so the full path option is disabled by default.
- A new configuration option, `rest_client_baseurl`, was also added to override the base URL of the REST client, removing the need for the full path option for configurations like port-forwarded VMs.
- The commit message also credits Heitor GouvÃªa for reporting the vulnerability.