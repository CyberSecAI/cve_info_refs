Based on the provided content, here's a breakdown of the vulnerability described:

**CVE ID:** CVE-2020-28647

**Vulnerability:** Stored Cross-Site Scripting (XSS)

**Affected Product:** Progress MOVEit Transfer versions prior to 2020.1

**Root Cause:**
The vulnerability stems from improper sanitization of user-provided input, specifically the filename during file uploads. The filename is directly embedded within the `onclick` JavaScript function of the download button without proper encoding or escaping, allowing for the injection of malicious JavaScript code.

**Weaknesses:**
*   **Lack of Input Sanitization:** The application fails to sanitize the filename before embedding it into the JavaScript code, allowing for the injection of arbitrary JavaScript.
*   **Insecure use of user input:** The application directly inserts user provided input into JavaScript code without proper encoding or validation.

**Impact of Exploitation:**
*   **Arbitrary JavaScript Execution:** An attacker can inject and execute arbitrary JavaScript code in the victim's browser when they click on the download button for the crafted file.
*   **Privilege Escalation:** A low-level user can exploit the vulnerability by uploading a file with a malicious filename. When an administrator views and attempts to download the file, the injected JavaScript executes in the administrator's session. The injected script can extract CSRF token from the page and perform actions such as creating a new admin user.
*   **Account Takeover:** By creating an admin user, attackers gain full control of the application.

**Attack Vectors:**
*   **File Upload:** An attacker uploads a file with a malicious filename.
*   **Download Button Click:** The victim (e.g., an administrator) clicks the "Download" button for the crafted file, triggering the execution of the injected JavaScript.

**Required Attacker Capabilities/Position:**
*   **Access to MOVEit Transfer:** The attacker must have access to the MOVEit Transfer application, even as a low-level user with the ability to upload files.
*   **Knowledge of JavaScript:** The attacker needs to craft malicious JavaScript code.
*   **Ability to intercept web requests (Burp proxy):** The attacker needs to intercept the file upload request using a proxy like burp suite and modify the file name to inject the payload.
*   **Social Engineering (or other means):** The attacker needs to entice an administrator to download the crafted file.

**Technical Details:**

1.  The attacker uploads a file with a malicious filename that contains JavaScript code.
2.  The application includes the filename in the `onclick` attribute of the download button without sanitization, creating a stored XSS.
3.  When a user clicks the download button, the injected JavaScript code executes in the context of the user's browser.
4.  The attacker can leverage the XSS vulnerability to execute actions such as sending requests to the server to create a new admin user.

**Bypasses**
*   The exploit bypasses the limitation of special characters ( / and \ ) in the file name using base64 encoding for the JavaScript code.
*   The exploit bypasses the Content Security Policy (CSP) by uploading the malicious JavaScript to the MOVEit server itself, then including it via the download functionality.

**Additional notes:**

*   The provided content includes a proof-of-concept exploit and a timeline of the vulnerability disclosure.
*   The vulnerability can lead to complete compromise of the MOVEit application if an administrator is tricked into downloading a maliciously crafted file.