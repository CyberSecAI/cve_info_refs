```text
## Analysis of CVE-2020-28480

The provided content relates to CVE-2020-28480.

**Vulnerability:** Prototype Pollution

**Affected Package:** jointjs

**Affected Versions:**

*   `<3.3.0` (npm package)
*   `[0,)` (Maven package org.webjars.bower:jointjs and org.webjars.npm:jointjs)

**Root Cause:** The `util.setByPath` function does not properly sanitize the path used to access the object's key and set the value, leading to prototype pollution.

**Attack Vector:** By controlling the `path` argument in the `util.setByPath` function, an attacker can inject properties into the `Object.prototype`.

**Impact:**

*   Denial of Service (DoS): By polluting `Object.prototype` with unexpected values (e.g., altering `toString` to an integer), the application can crash due to unexpected states, leading to a denial of service.
*   Remote Code Execution (RCE): If the codebase evaluates a specific attribute of an object and then executes that evaluation (e.g., `eval(someobject.someattr)`), an attacker can inject malicious code through prototype pollution.
*   Property Injection: An attacker can pollute properties that the codebase relies on for informative value, including security properties like cookies or tokens (e.g., `someuser.isAdmin`). This could lead to privilege escalation or other security breaches.

**Exploitability:**

*   **Attack Vector:** Network
*   **Attack Complexity:** Low
*   **Privileges Required:** None
*   **User Interaction:** None

**Proof of Concept:**

```javascript
const jointjs = require("jointjs");

const obj = {};
console.log("Before : " + obj.polluted);
jointjs.util.setByPath({ }, 'proto/polluted', "yes", '/');
// jointjs.util.setByPath({ }, 'constructor/prototype/polluted', "yes", '/');
console.log("After : " + obj.polluted);
```

**Mitigation:**

*   Upgrade `jointjs` to version 3.3.0 or higher (for npm package).
*   Freeze the prototype: `Object.freeze (Object.prototype)`.
*   Require schema validation of JSON input.
*   Avoid using unsafe recursive merge functions.
*   Consider using objects without prototypes (e.g., `Object.create(null)`).
*   Use `Map` instead of `Object`.

**Additional Information:**

*   The vulnerability is due to improper sanitization of the path in the `util.setByPath` function.
*   The vulnerability can be exploited in application servers, web servers, and web browsers.
*   The issue was fixed in this [GitHub PR](https://github.com/clientIO/joint/pull/1406).

```