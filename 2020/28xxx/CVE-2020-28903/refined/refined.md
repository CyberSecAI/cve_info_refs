```json
{
  "cve": "CVE-2020-28903",
  "content": "The provided content discusses a vulnerability (CVE-2020-28903) in Nagios XI where an attacker with control over a fused server can trigger a cross-site scripting (XSS) vulnerability in Nagios Fusion by tainting data returned to Nagios Fusion. The exploit chain starts by gaining code execution on the Nagios XI server, then using the vulnerability in Nagios Fusion to gain code execution in a Fusion user's browser, leading to a full compromise of Nagios deployments.\n\n**Root cause of vulnerability:** \nThe root cause of the vulnerability is that Nagios Fusion trusts and displays the data returned from Nagios XI servers without sanitization, allowing the attacker to inject malicious JavaScript.\n\n**Weaknesses/vulnerabilities present:**\n\n*   Cross-Site Scripting (XSS) vulnerability due to lack of sanitization in data returned by Nagios XI to Nagios Fusion.\n*   Lack of proper validation of data from external systems.\n\n**Impact of exploitation:**\n\n*   **XSS:** Attackers can execute arbitrary JavaScript code in the context of a Nagios Fusion user's browser session.\n*   **Chained Attack:** Combined with other vulnerabilities, attackers can fully compromise a Nagios deployment, gain control of a network operations center, and potentially access other client systems.\n\n**Attack vectors:**\n\n*   Attacker gains control of a Nagios XI server via other means (e.g., RCE via CVE-2020-28648). \n*   Attacker taints the data returned to a Nagios Fusion server by the compromised Nagios XI server. The data is specifically the "Recent Alerts" data via the `polled_extras` table. The `extra_value` column contains an array (dictionary) of key value pairs including the `output` field which is overwritten with malicious javascript.
*   Nagios Fusion polls the compromised Nagios XI, receives the tainted data, stores it in its database, and displays that data to the user. This executes the attacker-controlled JavaScript code within the Nagios Fusion user's browser session, allowing for session hijacking or further attacks against the Fusion server.\n\n**Required attacker capabilities/position:**\n\n*   Attacker needs to have compromised a Nagios XI server or be able to modify the returned data. \n*   Attacker needs to have a valid session on the compromised Nagios XI server.\n*   The Nagios Fusion server must have a 'fused' Nagios XI server that is controlled by the attacker. "
}
```