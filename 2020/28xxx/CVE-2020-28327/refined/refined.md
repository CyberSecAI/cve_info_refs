Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

- The vulnerability stems from a race condition in Asterisk's `res_pjsip` module when handling new SIP INVITE requests.
- Upon receiving a new SIP INVITE, Asterisk creates a dialog object. However, the created dialog object was not immediately locked or referenced, creating a "gap" between creation and its first use by the creating thread.
- During this gap, a different thread could potentially free the dialog object.

**Weaknesses/Vulnerabilities:**

- **Race Condition:** The primary vulnerability is a race condition due to the lack of proper locking/referencing of the newly created dialog object.
- **Use-After-Free:** If another thread frees the dialog in the gap, the initial thread could later try to dereference or access this freed memory, leading to a crash.

**Impact of Exploitation:**

- **Denial of Service (DoS):** Successful exploitation results in a crash of the Asterisk server, causing a denial of service to legitimate users.

**Attack Vectors:**

- **Remote Attack:** The vulnerability can be exploited remotely via SIP INVITE messages.
- **Authenticated Sessions:** The attacking client must either be authenticated or the Asterisk server must be configured for anonymous calling.
- **Connection-Oriented Protocol:** The SIP transport must use a connection-oriented protocol such as TCP or TLS. UDP is not affected.

**Required Attacker Capabilities/Position:**

- The attacker must be able to send SIP INVITE requests to the Asterisk server.
- The attacker must be authenticated to the server or the server must allow anonymous calls
- The attacker must use a connection-oriented protocol like TCP or TLS.

**Additional Notes:**

- The vulnerability is present in all versions of Asterisk 13.x, 16.x, 17.x and 18.x, and Certified Asterisk 16.8 prior to the patched versions.
- The fix involves ensuring that newly created dialog objects are returned locked and with an increased reference count.
- The issue is tracked as ASTERISK-29057 and addressed by AST-2020-001.