=== Content from github.com_8947d453_20250119_111235.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbrocaar%2Fchirpstack-network-server%2Fcommit%2Ff996bb0c6c85281b5658f59ff09db1b4a73db453)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbrocaar%2Fchirpstack-network-server%2Fcommit%2Ff996bb0c6c85281b5658f59ff09db1b4a73db453)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=brocaar%2Fchirpstack-network-server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[brocaar](/brocaar)
/
**[chirpstack-network-server](/brocaar/chirpstack-network-server)**
Public

* [Notifications](/login?return_to=%2Fbrocaar%2Fchirpstack-network-server) You must be signed in to change notification settings
* [Fork
  547](/login?return_to=%2Fbrocaar%2Fchirpstack-network-server)
* [Star
   1.5k](/login?return_to=%2Fbrocaar%2Fchirpstack-network-server)

* [Code](/brocaar/chirpstack-network-server)
* [Issues
  38](/brocaar/chirpstack-network-server/issues)
* [Pull requests
  4](/brocaar/chirpstack-network-server/pulls)
* [Actions](/brocaar/chirpstack-network-server/actions)
* [Projects
  0](/brocaar/chirpstack-network-server/projects)
* [Security](/brocaar/chirpstack-network-server/security)
* [Insights](/brocaar/chirpstack-network-server/pulse)

Additional navigation options

* [Code](/brocaar/chirpstack-network-server)
* [Issues](/brocaar/chirpstack-network-server/issues)
* [Pull requests](/brocaar/chirpstack-network-server/pulls)
* [Actions](/brocaar/chirpstack-network-server/actions)
* [Projects](/brocaar/chirpstack-network-server/projects)
* [Security](/brocaar/chirpstack-network-server/security)
* [Insights](/brocaar/chirpstack-network-server/pulse)

## Commit

[Permalink](/brocaar/chirpstack-network-server/commit/f996bb0c6c85281b5658f59ff09db1b4a73db453)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Improve uplink de-duplication.

[Browse files](/brocaar/chirpstack-network-server/tree/f996bb0c6c85281b5658f59ff09db1b4a73db453)
Browse the repository at this point in the history

```
This removes the de-duplication at the MQTT backend. Some MQTT brokers
provide shared subscription options in which case this additional
de-duplication is not needed.

For MQTT brokers that do not support shared subscriptions, the
collectAndCallOnce function will still filter out duplicated uplinks.

By adding the TXInfo object (hex encoded) to the de-duplication key,
uplink messages received on multiple channels will be handled
separately as they will result in different de-duplication keys.
```

* Loading branch information

[![@brocaar](https://avatars.githubusercontent.com/u/165497?s=40&v=4)](/brocaar)

[brocaar](/brocaar/chirpstack-network-server/commits?author=brocaar "View all commits by brocaar")
committed
Aug 31, 2020

1 parent
[e6a941f](/brocaar/chirpstack-network-server/commit/e6a941fbda553f08796bfe198acbc3327b6a5378)

commit f996bb0

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**10 additions**
and
**19 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* internal

  + backend/gateway/mqtt

    - internal/backend/gateway/mqtt/backend.go
      [backend.go](#diff-4235661045ded4e302efca02cf2e57ab98516e9f623072fb88846361d603ba85)
  + uplink

    - internal/uplink/collect.go
      [collect.go](#diff-98a1235acac2cff77f9d3ef02162ff13a8021cc8caabc2a9e7c98d530ec8f0ae)

## There are no files selected for viewing

15 changes: 0 additions & 15 deletions

15
[internal/backend/gateway/mqtt/backend.go](#diff-4235661045ded4e302efca02cf2e57ab98516e9f623072fb88846361d603ba85 "internal/backend/gateway/mqtt/backend.go")

Show comments

[View file](/brocaar/chirpstack-network-server/blob/f996bb0c6c85281b5658f59ff09db1b4a73db453/internal/backend/gateway/mqtt/backend.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,7 +5,6 @@ import ( |
|  |  | "crypto/tls" |
|  |  | "crypto/x509" |
|  |  | "encoding/base64" |
|  |  | "encoding/hex" |
|  |  | "fmt" |
|  |  | "io/ioutil" |
|  |  | "strings" |
| Expand Down  Expand Up | | @@ -249,20 +248,6 @@ func (b \*Backend) rxPacketHandler(c paho.Client, msg paho.Message) { |
|  |  | "gateway\_id": gatewayID, |
|  |  | }).Info("gateway/mqtt: uplink frame received") |
|  |  |  |
|  |  | // Since with MQTT all subscribers will receive the uplink messages sent |
|  |  | // by all the gateways, the first instance receiving the message must lock it, |
|  |  | // so that other instances can ignore the same message (from the same gw). |
|  |  | key := fmt.Sprintf("lora:ns:uplink:lock:%s:%d:%d:%d:%s", gatewayID, uplinkFrame.TxInfo.Frequency, uplinkFrame.RxInfo.Board, uplinkFrame.RxInfo.Antenna, hex.EncodeToString(uplinkFrame.PhyPayload)) |
|  |  | if locked, err := b.isLocked(key); err != nil || locked { |
|  |  | if err != nil { |
|  |  | log.WithError(err).WithFields(log.Fields{ |
|  |  | "uplink\_id": uplinkID, |
|  |  | "key": key, |
|  |  | }).Error("gateway/mqtt: acquire lock error") |
|  |  | } |
|  |  | return |
|  |  | } |
|  |  |  |
|  |  | b.rxPacketChan <- uplinkFrame |
|  |  | } |
|  |  |  |
| Expand Down | |  |

14 changes: 10 additions & 4 deletions

14
[internal/uplink/collect.go](#diff-98a1235acac2cff77f9d3ef02162ff13a8021cc8caabc2a9e7c98d530ec8f0ae "internal/uplink/collect.go")

Show comments

[View file](/brocaar/chirpstack-network-server/blob/f996bb0c6c85281b5658f59ff09db1b4a73db453/internal/uplink/collect.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -19,8 +19,8 @@ import ( |
|  |  |  |
|  |  | // Templates used for generating Redis keys |
|  |  | const ( |
|  |  | CollectKeyTempl = "lora:ns:rx:collect:%s" |
|  |  | CollectLockKeyTempl = "lora:ns:rx:collect:%s:lock" |
|  |  | CollectKeyTempl = "lora:ns:rx:collect:%s:%s" |
|  |  | CollectLockKeyTempl = "lora:ns:rx:collect:%s:%s:lock" |
|  |  | ) |
|  |  |  |
|  |  | // collectAndCallOnce collects the package, sleeps the configured duraction and |
| Expand All | | @@ -33,8 +33,14 @@ const ( |
|  |  | // unique set per gateway MAC and packet MIC. |
|  |  | func collectAndCallOnce(rxPacket gw.UplinkFrame, callback func(packet models.RXPacket) error) error { |
|  |  | phyKey := hex.EncodeToString(rxPacket.PhyPayload) |
|  |  | key := fmt.Sprintf(CollectKeyTempl, phyKey) |
|  |  | lockKey := fmt.Sprintf(CollectLockKeyTempl, phyKey) |
|  |  | txInfoB, err := proto.Marshal(rxPacket.TxInfo) |
|  |  | if err != nil { |
|  |  | return errors.Wrap(err, "marshal protobuf error") |
|  |  | } |
|  |  | txInfoHEX := hex.EncodeToString(txInfoB) |
|  |  |  |
|  |  | key := fmt.Sprintf(CollectKeyTempl, txInfoHEX, phyKey) |
|  |  | lockKey := fmt.Sprintf(CollectLockKeyTempl, txInfoHEX, phyKey) |
|  |  |  |
|  |  | // this way we can set a really low DeduplicationDelay for testing, without |
|  |  | // the risk that the set already expired in redis on read |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f996bb0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbrocaar%2Fchirpstack-network-server%2Fcommit%2Ff996bb0c6c85281b5658f59ff09db1b4a73db453) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_befb5ad8_20250119_111234.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbrocaar%2Fchirpstack-network-server%2Fcommit%2F874fc1a9b01045ebe8a340f0bb01ed19e8256e60)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbrocaar%2Fchirpstack-network-server%2Fcommit%2F874fc1a9b01045ebe8a340f0bb01ed19e8256e60)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=brocaar%2Fchirpstack-network-server)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[brocaar](/brocaar)
/
**[chirpstack-network-server](/brocaar/chirpstack-network-server)**
Public

* [Notifications](/login?return_to=%2Fbrocaar%2Fchirpstack-network-server) You must be signed in to change notification settings
* [Fork
  547](/login?return_to=%2Fbrocaar%2Fchirpstack-network-server)
* [Star
   1.5k](/login?return_to=%2Fbrocaar%2Fchirpstack-network-server)

* [Code](/brocaar/chirpstack-network-server)
* [Issues
  38](/brocaar/chirpstack-network-server/issues)
* [Pull requests
  4](/brocaar/chirpstack-network-server/pulls)
* [Actions](/brocaar/chirpstack-network-server/actions)
* [Projects
  0](/brocaar/chirpstack-network-server/projects)
* [Security](/brocaar/chirpstack-network-server/security)
* [Insights](/brocaar/chirpstack-network-server/pulse)

Additional navigation options

* [Code](/brocaar/chirpstack-network-server)
* [Issues](/brocaar/chirpstack-network-server/issues)
* [Pull requests](/brocaar/chirpstack-network-server/pulls)
* [Actions](/brocaar/chirpstack-network-server/actions)
* [Projects](/brocaar/chirpstack-network-server/projects)
* [Security](/brocaar/chirpstack-network-server/security)
* [Insights](/brocaar/chirpstack-network-server/pulse)

## Commit

[Permalink](/brocaar/chirpstack-network-server/commit/874fc1a9b01045ebe8a340f0bb01ed19e8256e60)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Improve error handling of unknown gateways.

[Browse files](/brocaar/chirpstack-network-server/tree/874fc1a9b01045ebe8a340f0bb01ed19e8256e60)
Browse the repository at this point in the history

* Loading branch information

[![@brocaar](https://avatars.githubusercontent.com/u/165497?s=40&v=4)](/brocaar)

[brocaar](/brocaar/chirpstack-network-server/commits?author=brocaar "View all commits by brocaar")
committed
Jul 9, 2020

1 parent
[28daf76](/brocaar/chirpstack-network-server/commit/28daf76fc8dc40952eb2459ddff954d348b0a08e)

commit 874fc1a

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**51 additions**
and
**48 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* internal

  + gateway

    - internal/gateway/rx\_info.go
      [rx\_info.go](#diff-a1e191ce744dfb5666767d322ceab532eabd9943ed517ebd2a6ad55226245895)
    - stats

      * internal/gateway/stats/stats.go
        [stats.go](#diff-a1d9b6ed68b1da6afc6959db78535d762b78ff7e327a00d1bd6475707372e8a8)
  + uplink

    - internal/uplink/uplink.go
      [uplink.go](#diff-d07602d121dbdca05f756b2fe26d74e1304601a4b3e37721c076a7657d31dfdd)

## There are no files selected for viewing

71 changes: 29 additions & 42 deletions

71
[internal/gateway/rx\_info.go](#diff-a1e191ce744dfb5666767d322ceab532eabd9943ed517ebd2a6ad55226245895 "internal/gateway/rx_info.go")

Show comments

[View file](/brocaar/chirpstack-network-server/blob/874fc1a9b01045ebe8a340f0bb01ed19e8256e60/internal/gateway/rx_info.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,68 +25,53 @@ import ( |
|  |  | // - add the gateway location |
|  |  | // - set the FPGA id if available |
|  |  | // - decrypt the fine-timestamp (if available and AES key is set) |
|  |  | func UpdateMetaDataInRxInfoSet(ctx context.Context, db sqlx.Queryer, rxInfo []\*gw.UplinkRXInfo) error { |
|  |  | for i := range rxInfo { |
|  |  | id := helpers.GetGatewayID(rxInfo[i]) |
|  |  | func UpdateMetaDataInRxInfoSet(ctx context.Context, db sqlx.Queryer, rxInfoSet []\*gw.UplinkRXInfo) []\*gw.UplinkRXInfo { |
|  |  | var out []\*gw.UplinkRXInfo |
|  |  |  |
|  |  | for i := range rxInfoSet { |
|  |  | rxInfo := rxInfoSet[i] |
|  |  |  |
|  |  | id := helpers.GetGatewayID(rxInfo) |
|  |  | g, err := storage.GetAndCacheGateway(ctx, db, id) |
|  |  | if err != nil { |
|  |  | log.WithFields(log.Fields{ |
|  |  | "ctx\_id": ctx.Value(logging.ContextIDKey), |
|  |  | "gateway\_id": id, |
|  |  | }).WithError(err).Error("get gateway error") |
|  |  | if errors.Cause(err) == storage.ErrDoesNotExist { |
|  |  | log.WithFields(log.Fields{ |
|  |  | "ctx\_id": ctx.Value(logging.ContextIDKey), |
|  |  | "gateway\_id": id, |
|  |  | }).Warning("uplink received by unknown gateway") |
|  |  | } else { |
|  |  | log.WithFields(log.Fields{ |
|  |  | "ctx\_id": ctx.Value(logging.ContextIDKey), |
|  |  | "gateway\_id": id, |
|  |  | }).WithError(err).Error("get gateway error") |
|  |  | } |
|  |  | continue |
|  |  | } |
|  |  |  |
|  |  | // set gateway location |
|  |  | rxInfo[i].Location = &common.Location{ |
|  |  | rxInfo.Location = &common.Location{ |
|  |  | Latitude: g.Location.Latitude, |
|  |  | Longitude: g.Location.Longitude, |
|  |  | Altitude: g.Altitude, |
|  |  | } |
|  |  |  |
|  |  | var board storage.GatewayBoard |
|  |  | if int(rxInfo[i].Board) < len(g.Boards) { |
|  |  | board = g.Boards[int(rxInfo[i].Board)] |
|  |  | if int(rxInfo.Board) < len(g.Boards) { |
|  |  | board = g.Boards[int(rxInfo.Board)] |
|  |  | } |
|  |  |  |
|  |  | // set FPGA ID |
|  |  | // this is useful when the AES decryption key is not set as it |
|  |  | // indicates which key to use for decryption |
|  |  | if rxInfo[i].FineTimestampType == gw.FineTimestampType\_ENCRYPTED && board.FPGAID != nil { |
|  |  | tsInfo := rxInfo[i].GetEncryptedFineTimestamp() |
|  |  | if tsInfo == nil { |
|  |  | log.WithFields(log.Fields{ |
|  |  | "ctx\_id": ctx.Value(logging.ContextIDKey), |
|  |  | "gateway\_id": id, |
|  |  | }).Error("encrypted\_fine\_timestamp must not be nil") |
|  |  | continue |
|  |  | } |
|  |  |  |
|  |  | if tsInfo := rxInfo.GetEncryptedFineTimestamp(); tsInfo != nil && board.FPGAID != nil { |
|  |  | if len(tsInfo.FpgaId) == 0 { |
|  |  | tsInfo.FpgaId = board.FPGAID[:] |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // decrypt fine-timestamp when the AES key is known |
|  |  | if rxInfo[i].FineTimestampType == gw.FineTimestampType\_ENCRYPTED && board.FineTimestampKey != nil { |
|  |  | tsInfo := rxInfo[i].GetEncryptedFineTimestamp() |
|  |  | if tsInfo == nil { |
|  |  | log.WithFields(log.Fields{ |
|  |  | "ctx\_id": ctx.Value(logging.ContextIDKey), |
|  |  | "gateway\_id": id, |
|  |  | }).Error("encrypted\_fine\_timestamp must not be nil") |
|  |  | continue |
|  |  | } |
|  |  |  |
|  |  | if rxInfo[i].Time == nil { |
|  |  | log.WithFields(log.Fields{ |
|  |  | "ctx\_id": ctx.Value(logging.ContextIDKey), |
|  |  | "gateway\_id": id, |
|  |  | }).Error("time must not be nil") |
|  |  | continue |
|  |  | } |
|  |  |  |
|  |  | rxTime, err := ptypes.Timestamp(rxInfo[i].Time) |
|  |  | if tsInfo := rxInfo.GetEncryptedFineTimestamp(); tsInfo != nil && board.FineTimestampKey != nil { |
|  |  | rxTime, err := ptypes.Timestamp(rxInfo.GetTime()) |
|  |  | if err != nil { |
|  |  | log.WithFields(log.Fields{ |
|  |  | "ctx\_id": ctx.Value(logging.ContextIDKey), |
| Expand All | | @@ -103,14 +88,16 @@ func UpdateMetaDataInRxInfoSet(ctx context.Context, db sqlx.Queryer, rxInfo []\*g |
|  |  | continue |
|  |  | } |
|  |  |  |
|  |  | rxInfo[i].FineTimestampType = gw.FineTimestampType\_PLAIN |
|  |  | rxInfo[i].FineTimestamp = &gw.UplinkRXInfo\_PlainFineTimestamp{ |
|  |  | rxInfo.FineTimestampType = gw.FineTimestampType\_PLAIN |
|  |  | rxInfo.FineTimestamp = &gw.UplinkRXInfo\_PlainFineTimestamp{ |
|  |  | PlainFineTimestamp: &plainTS, |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | out = append(out, rxInfo) |
|  |  | } |
|  |  |  |
|  |  | return nil |
|  |  | return out |
|  |  | } |
|  |  |  |
|  |  | func decryptFineTimestamp(key lorawan.AES128Key, rxTime time.Time, ts gw.EncryptedFineTimestamp) (gw.PlainFineTimestamp, error) { |
| Expand Down | |  |

15 changes: 14 additions & 1 deletion

15
[internal/gateway/stats/stats.go](#diff-a1d9b6ed68b1da6afc6959db78535d762b78ff7e327a00d1bd6475707372e8a8 "internal/gateway/stats/stats.go")

Show comments

[View file](/brocaar/chirpstack-network-server/blob/874fc1a9b01045ebe8a340f0bb01ed19e8256e60/internal/gateway/stats/stats.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,6 +18,8 @@ import ( |
|  |  | loraband "github.com/brocaar/lorawan/band" |
|  |  | ) |
|  |  |  |
|  |  | var ErrAbort = errors.New("abort") |
|  |  |  |
|  |  | type statsContext struct { |
|  |  | ctx context.Context |
|  |  | gateway storage.Gateway |
| Expand All | | @@ -40,6 +42,9 @@ func Handle(ctx context.Context, stats gw.GatewayStats) error { |
|  |  |  |
|  |  | for \_, t := range tasks { |
|  |  | if err := t(&sctx); err != nil { |
|  |  | if err == ErrAbort { |
|  |  | return nil |
|  |  | } |
|  |  | return err |
|  |  | } |
|  |  | } |
| Expand All | | @@ -51,7 +56,15 @@ func getGateway(ctx \*statsContext) error { |
|  |  | gatewayID := helpers.GetGatewayID(&ctx.gatewayStats) |
|  |  | gw, err := storage.GetAndCacheGateway(ctx.ctx, storage.DB(), gatewayID) |
|  |  | if err != nil { |
|  |  | return errors.Wrap(err, "get gateway error") |
|  |  | if errors.Cause(err) == storage.ErrDoesNotExist { |
|  |  | log.WithFields(log.Fields{ |
|  |  | "ctx\_id": ctx.ctx.Value(logging.ContextIDKey), |
|  |  | "gateway\_id": gatewayID, |
|  |  | }).Warning("gateway/stats: stats received by unknown gateway") |
|  |  | return ErrAbort |
|  |  | } else { |
|  |  | return errors.Wrap(err, "get gateway error") |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | ctx.gateway = gw |
| Expand Down | |  |

13 changes: 8 additions & 5 deletions

13
[internal/uplink/uplink.go](#diff-d07602d121dbdca05f756b2fe26d74e1304601a4b3e37721c076a7657d31dfdd "internal/uplink/uplink.go")

Show comments

[View file](/brocaar/chirpstack-network-server/blob/874fc1a9b01045ebe8a340f0bb01ed19e8256e60/internal/uplink/uplink.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -178,6 +178,14 @@ func collectUplinkFrames(ctx context.Context, uplinkFrame gw.UplinkFrame) error |
|  |  | } |
|  |  |  |
|  |  | func handleCollectedUplink(ctx context.Context, uplinkFrame gw.UplinkFrame, rxPacket models.RXPacket) error { |
|  |  | // update the gateway meta-data |
|  |  | rxPacket.RXInfoSet = gateway.UpdateMetaDataInRxInfoSet(ctx, storage.DB(), rxPacket.RXInfoSet) |
|  |  |  |
|  |  | // Return if the RXInfoSet is empty. |
|  |  | if len(rxPacket.RXInfoSet) == 0 { |
|  |  | return nil |
|  |  | } |
|  |  |  |
|  |  | var uplinkIDs []uuid.UUID |
|  |  | for \_, p := range rxPacket.RXInfoSet { |
|  |  | uplinkIDs = append(uplinkIDs, helpers.GetUplinkID(p)) |
| Expand All | | @@ -189,11 +197,6 @@ func handleCollectedUplink(ctx context.Context, uplinkFrame gw.UplinkFrame, rxPa |
|  |  | "ctx\_id": ctx.Value(logging.ContextIDKey), |
|  |  | }).Info("uplink: frame(s) collected") |
|  |  |  |
|  |  | // update the gateway meta-data |
|  |  | if err := gateway.UpdateMetaDataInRxInfoSet(ctx, storage.DB(), rxPacket.RXInfoSet); err != nil { |
|  |  | log.WithError(err).Error("uplink: update gateway meta-data in rx-info set error") |
|  |  | } |
|  |  |  |
|  |  | // log the frame for each receiving gateway. |
|  |  | if err := framelog.LogUplinkFrameForGateways(ctx, ns.UplinkFrameLog{ |
|  |  | PhyPayload: uplinkFrame.PhyPayload, |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `874fc1a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbrocaar%2Fchirpstack-network-server%2Fcommit%2F874fc1a9b01045ebe8a340f0bb01ed19e8256e60) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.cyberark.com_7c9cfcea_20250119_111236.html ===


* [Developer](https://developer.cyberark.com/)
* [Events](https://www.cyberark.com/events/)
* [Marketplace](https://community.cyberark.com/marketplace/s/)
* [Partners](https://cyberark.com/partners/)
* [Careers](https://www.cyberark.com/careers/)

* [![](https://cihost.uberflip.com/cyberArk/favicon-update/assets/cyberark-logo.svg)](https://www.cyberark.com/)
* Why CyberArk

  + - [Identity Security Leader](https://www.cyberark.com/why-cyberark/)

      Security-forward identity and access management.

      [Why CyberArk](https://www.cyberark.com/why-cyberark/)
  + - [CyberArk Labs](https://labs.cyberark.com)

      The industry’s top talent proactively researching attacks and trends to keep you ahead.
    - [Blogs](https://www.cyberark.com/resources/all-blog-posts)

      Insights to help you move fearlessly forward in a digital world.
    - [Careers](https://careers.cyberark.com)

      Join a passionate team that is humbled to be a trusted advisor to the world's top companies.
* Platform

  + - [![cora thumbnail](https://www.cyberark.com/wp-content/uploads/2024/05/cora-ai-nav.png)CyberArk CORA AI™](https://www.cyberark.com/products/cora-ai/)

      CyberArk CORA AI™ is your central hub of identity security-focused artificial intelligence capabilities.

      [Learn More](https://www.cyberark.com/products/cora-ai/)
    - [Identity Security Platform](https://www.cyberark.com/products/)

      Put security first without putting productivity second.

      [Explore Platform](https://www.cyberark.com/products/)
  + - * + [Access Management](https://www.cyberark.com/products/access-management/)
        + [Workforce Access](https://www.cyberark.com/products/workforce-identity/)
          - [Single Sign-On](https://www.cyberark.com/products/single-sign-on/)
          - [Multi-Factor Authentication](https://www.cyberark.com/products/adaptive-multi-factor-authentication/)
          - [Workforce Password Management](https://www.cyberark.com/products/workforce-password-management/)
          - [Secure Web Sessions](https://www.cyberark.com/products/secure-web-sessions/)
          - [Secure Browser](https://www.cyberark.com/products/secure-browser/)
        + [Customer Access](https://www.cyberark.com/products/customer-identity/)
          - [B2B Identity](https://www.cyberark.com/products/b2b-identity/)
      * + [Identity Governance and Administration](https://www.cyberark.com/products/identity-management/)
        + [Identity Compliance](https://www.cyberark.com/products/identity-compliance/)
        + [Lifecycle Management](https://www.cyberark.com/products/lifecycle-management/)
        + [Identity Flows](https://www.cyberark.com/products/identity-flows/)
    - * + [Privileged Access](https://www.cyberark.com/products/privileged-access/)
        + [Privileged Access Management](https://www.cyberark.com/products/privileged-access-manager/)
        + [Vendor Privileged Access](https://www.cyberark.com/products/vendor-privileged-access-manager/)
      * + [Secrets Management](https://www.cyberark.com/products/secrets-management/)
        + [Multi-Cloud Secrets](https://www.cyberark.com/products/multi-cloud-secrets/)
        + [Secrets Hub](https://www.cyberark.com/products/secrets-hub/)
        + [Credential Providers](https://www.cyberark.com/products/credential-providers/)
      * + [Venafi Machine Identity Management](https://venafi.com/)
    - * + [Endpoint Privilege Security](https://www.cyberark.com/products/endpoint-privilege-security/)
        + [Endpoint Privilege Management](https://www.cyberark.com/products/endpoint-privilege-manager/)
        + [Secure Desktop](https://www.cyberark.com/products/secure-desktop/)
      * + [Secure Cloud Access](https://www.cyberark.com/products/secure-cloud-access/)
* Solutions

  + - [![cora thumbnail](https://www.cyberark.com/wp-content/uploads/2024/05/cora-ai-nav.png)CyberArk CORA AI™](https://www.cyberark.com/products/cora-ai/)

      CyberArk CORA AI™ is your central hub of identity security-focused artificial intelligence capabilities.

      [Learn More](https://www.cyberark.com/products/cora-ai/)
    - [Identity Security Offerings](https://www.cyberark.com/solutions/)

      Find the right CyberArk identity security solution for your organization.

      [Explore Solutions](https://www.cyberark.com/solutions/)
  + - * + Workforce
        + [Secure Your Workforce](https://www.cyberark.com/solutions/secure-your-workforce/)
        + [Secure Endpoints and Servers](https://www.cyberark.com/secure-endpoints-and-servers/)
        + [Secure External Access](https://www.cyberark.com/solutions/secure-external-access/)
      * + IT
        + [Secure IT Administrators](https://www.cyberark.com/solutions/secure-it-admin-access/)
        + [Secure Cloud Operations Teams](https://www.cyberark.com/solutions/secure-cloud-operations/)
        + [Secure Endpoints and Servers](https://www.cyberark.com/secure-endpoints-and-servers/)
        + [Secure External Access](https://www.cyberark.com/solutions/secure-external-access/)
    - * + Developer
        + [Secure Developers](https://www.cyberark.com/solutions/secure-developers/)
        + [Secure Endpoints and Servers](https://www.cyberark.com/secure-endpoints-and-servers/)
      * + Machines
        + [Secure All Secrets​](https://www.cyberark.com/secure-all-secrets/)
        + [Secure Certificate Management and PKI](https://www.cyberark.com/solutions/secure-certificate-management-and-pki/)
        + [Secure Secrets and Certificates Within CSPs](https://www.cyberark.com/solutions/secure-secrets-and-certificates/)
    - * + Industries
        + [Automotive](https://www.cyberark.com/solutions/automotive/)
        + [Banking](https://www.cyberark.com/solutions/banking/)
        + [Critical Infrastructure](https://www.cyberark.com/solutions/critical-infrastructure/)
        + [Financial Services](https://www.cyberark.com/solutions/financial-services/)
        + [Government](https://www.cyberark.com/solutions/government/)
        + [Healthcare](https://www.cyberark.com/solutions/healthcare/)
        + [Insurance](https://www.cyberark.com/solutions/insurance/)
        + [Manufacturing](https://www.cyberark.com/solutions/manufacturing/)
* Services &
  Support
  + - [How Can We Help?](https://www.cyberark.com/services-support/)

      Expert guidance from strategy to implementation.

      [Services & Support](https://www.cyberark.com/services-support/)
  + - * Customer Success
      * [Customer Stories](https://www.cyberark.com/customer-stories/)
      * [CyberArk Blueprint](https://www.cyberark.com/blueprint/)
      * [Success Plans](https://www.cyberark.com/success-plans/)
    - * Learning
      * [Education Resources](https://www.cyberark.com/services-support/)
      * [Certification](https://www.cyberark.com/services-support/certification/)
      * [Training](https://www.cyberark.com/services-support/training/)
    - * Services
      * [Design & Deployment Services](https://www.cyberark.com/services-support/design-deployment/)
      * [Red Team Services](https://www.cyberark.com/services-support/red-team-services/)
      * [Remediation Services](https://www.cyberark.com/services-support/remediation/)
      * [Strategic Consulting Services](https://www.cyberark.com/services-support/strategic-consulting/)
    - * Support
      * [Product Documentation](https://docs.cyberark.com/)
      * [Technical Community](https://cyberark-customers.force.com/s/)
      * [Technical Support](https://www.cyberark.com/services-support/technical-support/)
* Company

  + - [Company](https://www.cyberark.com/company/)

      Our mission is to secure the world against cyber threats so together we can move fearlessly forward.

      [Learn About CyberArk](https://www.cyberark.com/company/)
  + - * About Us
      * [Leadership](https://www.cyberark.com/company/leadership/)
      * [Investor Relations](https://investors.cyberark.com/home/default.aspx)
      * [Environmental, Social and Governance](https://www.cyberark.com/company/esg/)
      * [Trust Center](https://www.cyberark.com/trust/)
      * [Life at CyberArk](https://www.cyberark.com/company/culture/)
      * [Careers](https://www.cyberark.com/careers/)
    - * Highlights
      * [Newsroom](https://www.cyberark.com/company/newsroom/)
      * [Events](https://www.cyberark.com/events/)
      * [Blog](https://www.cyberark.com/resources/all-blog-posts)
      * [Podcasts](https://www.cyberark.com/podcasts/)
      * [Customer Stories](https://www.cyberark.com/customer-stories/)
      * [CyberArk Labs](https://labs.cyberark.com/)
* Demos & Trials

  + - [Demos & Trials](https://www.cyberark.com/try-buy/)

      Get started with one of our 30-day trials.

      [Start a Trial](https://www.cyberark.com/try-buy/)
  + - [How to Buy](https://www.cyberark.com/how-to-buy/)

      Evaluate, purchase and renew CyberArk Identity Security solutions.
    - [Contact Us](https://www.cyberark.com/contact/)

      How can we help you move fearlessly forward?
    - [Identity Security Subscriptions](https://www.cyberark.com/identity-security-subscriptions/)

      Learn more about our subscription offerings.
* [Request a Demo](https://www.cyberark.com/request-demo/)
* [Blog](https://www.cyberark.com/resources/blog)
* [Partners](https://www.cyberark.com/partners/)
* [Marketplace](https://community.cyberark.com/marketplace/s/)
* [Careers](https://www.cyberark.com/careers/)
* Menu Item
  ![](https://www.cyberark.com/wp-content/uploads/2020/12/Icons-Globe@2x.png)
  + [Deutsch](https://www.cyberark.com/de)
  + [Français](https://www.cyberark.com/fr)
  + [Italiano](https://www.cyberark.com/it)
  + [Español](https://www.cyberark.com/es)
  + [日本語](https://www.cyberark.com/ja)
  + [简体中文](https://www.cyberark.com/zh-hans)
  + [繁體中文](https://www.cyberark.com/zh-hant)
  + [한국어](https://www.cyberark.com/ko/)

English – CyberArk Software Inc
## Up Your Security I.Q. by Checking Out Our Collection of Curated Resources.

![loading](https://content.cdntwrk.com/img/hubs/ajax-loader-white-2x.gif?v=19a554b579c4)

[English – CyberArk Software Inc](https://www.cyberark.com/resources "English – CyberArk Software Inc")

* Products & Services
  + Products & Services
  + [Cloud Security](https://www.cyberark.com/resources/cloud-security)
  + [Customer Access](https://www.cyberark.com/resources/customer-access)
  + [Endpoint Privilege Security](https://www.cyberark.com/resources/endpoint-privilege-security)
  + [Identity Management](https://www.cyberark.com/resources/identity-management)
  + [Privileged Access Management](https://www.cyberark.com/resources/privileged-access-management)
  + [Secrets Management](https://www.cyberark.com/resources/secrets-management)
  + [Services & Support​](https://www.cyberark.com/resources/services-support)
  + [Shared Services](https://www.cyberark.com/resources/shared-services)
  + [Workforce Access](https://www.cyberark.com/resources/workforce-access)
* Topics
  + Topics
  + [Access Management](https://www.cyberark.com/resources/access-management)
  + [Best Practices](https://www.cyberark.com/resources/best-practices)
  + [DevSecOps](https://www.cyberark.com/resources/devsecops)
  + [Endpoint Security](https://www.cyberark.com/resources/endpoint-security)
  + [Hybrid and Multi-Cloud Security](https://www.cyberark.com/resources/hybrid-and-multi-cloud-security)
  + [Identity Security](https://www.cyberark.com/resources/identity-security)
  + [IT Security Audit and Compliance](https://www.cyberark.com/resources/it-security-audit-and-compliance)
  + [Least Privilege](https://www.cyberark.com/resources/least-privilege)
  + [Partners](https://www.cyberark.com/resources/partners)
  + [Ransomware Protection](https://www.cyberark.com/resources/ransomware-protection)
  + [Remote Access](https://www.cyberark.com/resources/remote-access)
  + [Robotic Process Automation](https://www.cyberark.com/resources/robotic-process-automation)
  + [Threat Research​](https://www.cyberark.com/resources/threat-research)
  + [Zero Trust](https://www.cyberark.com/resources/zero-trust)
* Industry
  + Industry
  + [Federal](https://www.cyberark.com/resources/federal)
  + [Financial Services](https://www.cyberark.com/resources/financial-services)
  + [Healthcare​](https://www.cyberark.com/resources/healthcare)
  + [Higher Education](https://www.cyberark.com/resources/higher-education)
  + [Insurance](https://www.cyberark.com/resources/insurance)
  + [Manufacturing](https://www.cyberark.com/resources/manufacturing)
* Content Type
  + Content Type
  + [Analyst Reports](https://www.cyberark.com/resources/analyst-reports)
  + [Blog Articles](https://www.cyberark.com/resources/all-blog-posts)
  + [Customer Stories](https://www.cyberark.com/customer-stories/)
  + [eBooks​](https://www.cyberark.com/resources/ebooks)
  + [Executive Insights](https://www.cyberark.com/resources/executive-insights)
  + [Infographics​](https://www.cyberark.com/resources/infographics)
  + [Podcasts](https://www.cyberark.com/podcasts/)
  + [Product Announcements](https://www.cyberark.com/resources/product-announcements)
  + [Product Datasheets​](https://www.cyberark.com/resources/product-datasheets)
  + [Solution Briefs​](https://www.cyberark.com/resources/solution-briefs)
  + [Tools & Blueprints](https://www.cyberark.com/resources/tools-blueprints)
  + [Webinars](https://www.cyberark.com/resources/webinars)
  + [Videos](https://www.cyberark.com/resources/videos)
  + [Whitepapers​](https://www.cyberark.com/resources/white-papers)

×

[Home](https://www.cyberark.com/resources)
»
[Threat Research Blog](https://www.cyberark.com/resources/threat-research-blog)
»
LoRaWAN & MQTT: What to Know When Securing Your IoT Network

×
Share this Article

* [Facebook](https://www.facebook.com/sharer/sharer.php?u=https://www.cyberark.com/resources/threat-research-blog/lorawan-mqtt-what-to-know-when-securing-your-iot-network)
* [Twitter](https://twitter.com/share?text=LoRaWAN & MQTT: What to Know When Securing Your IoT Network&url=https://www.cyberark.com/resources/threat-research-blog/lorawan-mqtt-what-to-know-when-securing-your-iot-network)
* [Email](/cdn-cgi/l/email-protection#c6f9b5b3a4aca3a5b2fb85a9a8b2a3a8b2e6a0b4a9abe6abbfe68eb3a4e7e0a7abb6fda4a9a2bffb85aea3a5ade6a9b3b2e6b1aea7b2e0e5f6f5fffdb5e6aea7b6b6a3a8afa8a1e6a7b2e685bfa4a3b487b4ade79aa89aa88aa994a7918788e6e0a7abb6fde68b979292fce691aea7b2e6b2a9e68da8a9b1e691aea3a8e695a3a5b3b4afa8a1e69fa9b3b4e68fa992e688a3b2b1a9b4ad9aa892aea3e68aa994a7918788e6b6b4a9b2a9a5a9aae6b1afb4a3aaa3b5b5aabfe6a5a9a8a8a3a5b2b5e6a4a7b2b2a3b4bfebb6a9b1a3b4a3a2e6a2a3b0afa5a3b5e6b2a9e6b2aea3e6afa8b2a3b4a8a3b2e8e684a3a5a7b3b5a3e6a9a0e6afb2b5e6a7a4afaaafb2bfe6b2a9e6a5a9ababb3a8afa5a7b2a3e6aaa9a8a1ebb4a7a8a1a3e6b1afb2aee6aaafb2b2aaa3e6a4a7b2b2a3b4bfe6a5a9a8b5b3abb6b2afa9a8eae6afb2e6afb5e6aaafada3aabfe6b2a9e6a4a3e6b2aea3e6a8a3b2b1a9b4ade8e8e89aa89aa8aeb2b2b6b5fce9e9b1b1b1e8a5bfa4a3b4a7b4ade8a5a9abe9b4a3b5a9b3b4a5a3b5e9b2aeb4a3a7b2ebb4a3b5a3a7b4a5aeeba4aaa9a1e9aaa9b4a7b1a7a8ebabb7b2b2ebb1aea7b2ebb2a9ebada8a9b1ebb1aea3a8ebb5a3a5b3b4afa8a1ebbfa9b3b4ebafa9b2eba8a3b2b1a9b4ad)
* [LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://www.cyberark.com/resources/threat-research-blog/lorawan-mqtt-what-to-know-when-securing-your-iot-network&title=LoRaWAN & MQTT: What to Know When Securing Your IoT Network&summary=The LoRaWAN protocol wirelessly connects battery-powered devices to the internet. Because of its ability to communicate long-range with little battery consumption, it is likely to be the network...)

# LoRaWAN & MQTT: What to Know When Securing Your IoT Network

October 15, 2020
Emmanuel Ouanounou

* Share this Article
* [Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.cyberark.com%2Fresources%2Fthreat-research-blog%2Florawan-mqtt-what-to-know-when-securing-your-iot-network)
* [Twitter](https://twitter.com/share?text=LoRaWAN%20%26%20MQTT%3A%20What%20to%20Know%20When%20Securing%20Your%20IoT%20Network&url=https%3A%2F%2Fwww.cyberark.com%2Fresources%2Fthreat-research-blog%2Florawan-mqtt-what-to-know-when-securing-your-iot-network&via=CyberArk)
* [Email](/cdn-cgi/l/email-protection#09367a7c6b636c6a7d344a66677d6c677d2c3b396f7b66642c3b3964702c3b39417c6b2c3b382f686479326b666d70344a616c6a622c3b39667c7d2c3b397e61687d2c3b3e7a2c3b39616879796c6760676e2c3b39687d2c3b394a706b6c7b487b622c3b382c39482c394845665b685e48472c3b392c3b3f2c3b3944585d5d2c3a482c3b395e61687d2c3b397d662c3b394267667e2c3b395e616c672c3b395a6c6a7c7b60676e2c3b3950667c7b2c3b3940665d2c3b39476c7d7e667b622c39485d616c2c3b3945665b685e48472c3b39797b667d666a66652c3b397e607b6c656c7a7a65702c3b396a6667676c6a7d7a2c3b396b687d7d6c7b702479667e6c7b6c6d2c3b396d6c7f606a6c7a2c3b397d662c3b397d616c2c3b3960677d6c7b676c7d272c3b394b6c6a687c7a6c2c3b39666f2c3b39607d7a2c3b39686b6065607d702c3b397d662c3b396a6664647c67606a687d6c2c3b396566676e247b68676e6c2c3b397e607d612c3b3965607d7d656c2c3b396b687d7d6c7b702c3b396a66677a7c64797d6066672c3b4a2c3b39607d2c3b39607a2c3b396560626c65702c3b397d662c3b396b6c2c3b397d616c2c3b39676c7d7e667b622727272c39482c3948617d7d797a2c3a482c3b4f2c3b4f7e7e7e276a706b6c7b687b62276a66642c3b4f7b6c7a667c7b6a6c7a2c3b4f7d617b6c687d247b6c7a6c687b6a61246b65666e2c3b4f65667b687e68672464787d7d247e61687d247d66246267667e247e616c67247a6c6a7c7b60676e2470667c7b2460667d24676c7d7e667b62)
* [LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.cyberark.com%2Fresources%2Fthreat-research-blog%2Florawan-mqtt-what-to-know-when-securing-your-iot-network&title=LoRaWAN%20%26%20MQTT%3A%20What%20to%20Know%20When%20Securing%20Your%20IoT%20Network&summary=The%20LoRaWAN%20protocol%20wirelessly%20connects%20battery-powered%20devices%20to%20the%20internet.%20Because%20of%20its%20ability%20to%20communicate%20long-range%20with%20little%20battery%20consumption%2C%20it%20is%20likely%20to%20be%20the%20network...)

![](https://www.cyberark.com/wp-content/uploads/2020/10/LoRaWAN-IoT-1200x628-1.jpg)

The LoRaWAN protocol wirelessly connects battery-powered devices to the internet. Because of its ability to communicate long-range with little battery consumption, it is likely to be the network of smart cities and industries in the future. High profile use cases like these require high security standards and LoRaWAN’s design is built with security at its core. In this research, we’ll share some basic knowledge about LoRa and the LoRaWAN protocol and dive into our discovery of a security issue involving a denial of service (DoS) on this protocol.

## LoRa and LoRaWAN

LoRa (L**o**ng **R**ange) is a low-frequency modulation technique developed by Semtech. The aim of this technology is to achieve long-range communication between devices together with low battery consumption. Both of these goals are achieved by using a low frequency (< 1GHz). As we can see in the following figure, WiFi and cellular networks use a higher bandwidth than LoRa, and thus have a lower range and higher battery consumption.

![](https://www.cyberark.com/wp-content/uploads/2020/10/LoRa-vs-WIFI-Cellular.jpg)

LoRa communications have an impressive range of up to 15km.

On top of the LoRa technology, the LoRa Alliance has developed an [open-source protocol](https://lora-alliance.org/resource_hub/lorawan-specification-v1-1/) called LoRaWAN. This protocol aims to securely connect the LoRa devices to the internet. The goal is to have battery-powered devices be able to communicate with the internet while optimizing battery life.

As such, the LoRaWAN protocol offers 3 device classes which allow adapting the battery usage to the use cases.

### Device Classes

**Class A:** Class A devices are meant to have the longest battery life. These devices are sleeping most of the time, and thus, do not listen regularly to the network. They can receive a message from the network (called **downlink**) only as a response to a message they have just sent (called **uplink**). Basically, a Class A device will send a message, wait for a few seconds, then listen to the network for some time, and finally go back to sleep mode. Class A devices are mostly used for detection i.e. the device detects something, sends it to the internet, receives a response (in case there is something to do), and goes back to sleep until the next detection. Examples of Class A devices would be fire alarms, flood detectors, intrusion detectors, etc. (more info [here](https://lora-developers.semtech.com/library/tech-papers-and-guides/lorawan-class-a-devices/))

**Class B:** Class B devices are a compromise between Class A and Class C. Class B devices listen to the network periodically, meaning the network can initiate the communication. A Class B device would typically listen to the network every 32 seconds (but this is configurable) which allows the application to communicate with the device on a regular basis without waiting for an uplink. Class B devices are mainly used for metering like temperature and moisture. Instead of requiring the device to send uplinks on a regular basis (which is highly power consuming), the device sends the data only when it is asked, with a few seconds of latency. (more info [here](https://lora-developers.semtech.com/library/tech-papers-and-guides/lorawan-class-b-devices/#:~:text=Ping%20slot%20periodicity%3A%2032sec%20(the,Class%20B%20downlink%20per%20hour.))

**Class C:** Class C devices are continuously listening to the network except when they are sending uplinks. This type of device is the most power-consuming but offers the lowest latency. These devices are used for monitoring like traffic and water systems (more info [here](https://lora-developers.semtech.com/library/tech-papers-and-guides/lorawan-class-c-devices/)).

Next, we’ll look at how the protocol works. The LoRaWAN protocol is based on 4 components: Gateways, Network Servers, Application Servers and Join Servers.

### The LoRaWAN Protocol

When a **LoRa device** wants to send a frame/packet via the internet, it will send it using the LoRa technology, in all directions.

Then, one or several **Gateways** will receive this packet. The Gateways are small computers (typically Raspberry Pis) that are connected to the internet and have an antenna capable of receiving LoRa packets. The Gateways simply demodulates the LoRa packets and forwards them to the Network Server via the internet.

The **Network Server** is like the router of the LoRaWAN protocol. The frame sent by the device contains clear text headers, an encrypted payload and a signature. The Network Server will check the signature and determine the target Application Server based on the headers. This process will allow the Network Server to forward the message to the right Application Server in case the message is correctly signed.

The **Application Server** is responsible for the application layer of the protocol. It receives the frames from the Network Server, decrypts them, processes the data and eventually sends responses.

Finally, the **Join Server** is the one responsible for security. It generates security keys for encrypting and signing the messages. These keys are securely forwarded to the devices and servers via the Network Server.

The first time a device is turned on, it starts a **Join Procedure** in which it will securely exchange several keys with the Join Server for encryption and signature. *Note: we won’t cover the Join Procedure in this article, so we are assuming that all messages are sent **after** a successful Join Procedure*. After joining, all the uplinks are encrypted and signed by the device using several keys, and all the downlink are encrypted and signed by the Application Server.

Now that we know the different components and devices that take part in the LoRa protocol, and how they interact with each other, let’s look closer at the communication protocol between the Gateways and the Network Server and its implementation.

## Gateway to Network Server Communication – MQTT

As mentioned earlier, the Gateway is operating on the physical layer. It demodulates the LoRa uplinks sent by the devices and forwards them to the Network Server. It also receives downlinks from the Network Server (the downlinks were initially sent by the Application Server to the Network Server), modulates them and sends them to the device.

The task of the Gateway is pretty simple and limited by design. The coverage of the network is highly dependent on the number of Gateways available and therefore, the LoRaWAN protocol does not require Gateways to perform any security checks, so that their implementation is easier. This is not always the case, but, for example, [TheThingsNetwork](https://www.thethingsnetwork.org/) is an open-source community-based LoRaWAN network that allows any member to add a Gateway to their public network. This design requires the Gateway to be unable to decrypt the frames (confidentiality).

### LoRa and MQTT

*From this point, all the implementation-specific parts have been tested on a Chirpstack server infrastructure.*

In many LoRaWAN implementations, the communication between the Gateways and the Network Server is achieved using the MQTT (Message Queuing Telemetry Transport) protocol. MQTT is a publish-subscribe protocol that transports messages between devices. It is designed for high-latency, unreliable networks.

The MQTT protocol consists of a server called “MQTT broker”, which collects the messages and clients that can read or write to the broker. Since it is a publish-subscribe protocol, clients should specify which topic they want to write and subscribe to (for reading). By default (without any authentication implementation), it is possible to subscribe to all the topics.

In most implementations, the MQTT broker runs on the Network Server’s machine. The Gateways listen to downlinks by subscribing to the topic: “gateway/gateway\_id/command/down“ and sends uplinks on the topic: “gateway/gateway\_id/event/up“. The Network server then listens to all topics with the form “gateway/+/event/up“ topics and writes downlinks to the relevant “gateway/+/command/down.”

When an uplink is sent, the Gateway writes the physical payload received from the device with additional data about it (e.g. time and frequency).

![](https://www.cyberark.com/wp-content/uploads/2020/10/MQTT-frame-from-gateway.jpg)

*Figure 2 – MQTT Frame sent by a Gateway*

We can see that the phyPayload field is encrypted. It is also signed, which prevents a malicious Gateway from modifying it without being noticed.

### Uplink Signature

In order to guarantee the integrity of the uplinks, the LoRaWAN protocol requires the device to add a digital signature (Message Integrity Code – MIC) at the end of the phyPayload. The digital signature is calculated as follows:

* Calculate B0:

![](https://www.cyberark.com/wp-content/uploads/2020/10/Mic-calculation-B0.jpg)

*Figure 3 – B0 value for MIC calculation (Source: LoRaWAN 1.1 Specification)*

Where DevAddr is the Device Address for this session, FCntUp is the uplink counter (to prevent replay attacks) and msg is the encrypted payload to be sent

* Calculate B1:

![](https://www.cyberark.com/wp-content/uploads/2020/10/Mic-calculation-B1.jpg)

*Figure 4 – B1 value for MIC calculation (Source: LoRaWAN 1.1 Specification)*

Where ConfFCnt is a downlink related counter, TxDr is the data rate used for the transmission of the uplink, and TxCh is the channel (the other fields are defined like in B0).

* Calculate 2 signatures based on B0 and B1:

cmacS = aes128\_cmac(SNwkSIntKey, B0 | msg)

cmacF = aes128\_cmac(FNwkSIntKey, B1 | msg)

SNwkSIntKey and FNwkSIntKey are two session keys shared between the device and the Network Server (through the Join Server) that are used for integrity verification.

* Calculate the MIC (signature):

MIC = cmacS[0..1] | cmacF[0..1]

The MIC will then be added to the end of the phyPayload. When the Network Server receives the uplink, it checks the MIC before forwarding it to the Application Server. If the MIC is invalid, the Network Server will drop the uplink without forwarding it to the Application Server.

### Frame Collection

As mentioned earlier, uplinks are sent over LoRa RF waves, in all directions. Thus, all the gateways in range will receive the uplink from the device. Since a gateway cannot verify that another gateway has already sent the same packet to the Network Server, this will lead to duplicates of the same physical payload on the MQTT broker (each gateway in range will write a frame with the same “phyPayload” on the MQTT broker).

For example, if 5 gateways are in the range of the device, the uplink payload will appear 5 times on the MQTT broker, with different metadata (gateway id, time, rssi, etc.).

However, on the Application Server, we want to see this message only once. Imagine a fire detection system, which would alert you 5 times for a single fire in the center of the city, and one time if it occurred in the suburb. Important information could be missed in the middle of these duplicates.

In order to address this challenge, the LoRaWAN protocol describes a message collection process, which consists of collecting all the messages that contain the same phyPayload into one single message before sending it to the Application Server.

## The Security Issue: From the Attacker’s Perspective

**Note:** The level of trust of Gateways in the LoRaWAN protocol is not clear. While the protocol does not clearly say if Gateways should be trusted or not, some implementations assume they are not. For example, TheThingsNetwork, a global and open-source LoRa Network, relies on community-installed Gateways. In such a case, our attack would be very easy to implement.

**Type of Attack:** DoS on uplinks (which means full DoS on Class A devices).

**Target:** Chirpstack Network Server (version 3.9.0)

Prerequisite: A compromised/malicious gateway in the network. If the gateway has read/write permissions on all uplink topics on the MQTT broker, the attack can target any device in the Network. If the gateway only has write permission on the MQTT broker, the attack can only target devices in the range of the gateway.

**Consequences of the Attack:** In case of an alarm or detection device (e.g. fire, flood or intrusion), the device would become completely useless because the uplinks from the device would not be received by the application layer. In this case, individuals in a home, company or even a whole city may think they are safe (not receiving any alert), when they could be in considerable danger. Class A devices of any kind would become completely useless since the uplinks would not arrive, and the Application Server is only able to answer to uplinks.

**Description of the Attack:** In this scenario, the attacker reads a message from the MQTT broker and replays it (if s/he doesn’t have read permission, it would just need to send a payload it received from a device in range), and only changes the “frequency” field of the metadata. The 2 possible scenarios are the following:

**First Scenario (The Compromised Gateway has read access to the uplink topics)**

A Device sends an uplink (broadcast to all the Gateways in range)

A legitimate Gateway receives it and forwards it to the MQTT broker with the metadata. In the following message, note that the frequency is 903900000 at the end of the first line.

![](https://www.cyberark.com/wp-content/uploads/2020/10/Legit-MQTT-Frame.jpg)

*Figure 5 – Legitimate MQTT frame*

The malicious Gateway reads this message and replays it with a single difference: the frequency field is set to 200 (not supported by the Network Server)

![](https://www.cyberark.com/wp-content/uploads/2020/10/Legit-and-malicious-MQTT-frames.jpg)

*Figure 6 – Legitimate MQTT frame followed by a malicious one*

The Network Server will collect those 2 messages, say that the MIC is invalid, and the uplink won’t be forwarded to the Application Server.

**Second Scenario (The Compromised Gateway only has write access to the uplink topics)**

A device sends an uplink (broadcast to all the Gateways in range)

The Compromised Gateway receives it and forwards it to the MQTT broker with an invalid frequency (200 for example)

**Optional:** Legitimate Gateways receive the uplink and forward it the right way to the MQTT broker. This does not block the attack but does reduce the chances of a successful attack.

The Network Server receives the uplinks, collects the, calculates an invalid MIC and drops the uplink without forwarding it to the Application Server.

In this scenario, the Malicious Gateway has to be in the range of the device in order to proceed with the attack.

From our comprehension of the code, and without having performed any statistical tests, we strongly believe that the probability of success increases with the number of malicious messages. A malicious gateway can thus send more malicious messages in order to increase the probability of success of the attack.

### The Attack Details

#### The Attack Process

We first tried to perform the attack as described in the first scenario of the previous section (the malicious gateway has read access to the uplink topics). I wrote a small script which listens to all the frames that are sent to the topic *gateway/abababababababab/event/up*. The script would read this frame, edit the frequency to 200 and write it to *gateway/cdcdcdcdcdcdcd/event/up*.

```

import paho.mqtt.client as mqtt
import time
import re

def on_message(client, userdata, message):
    match = re.compile("frequency\":([0-9]+)")
    res = match.sub("frequency\":200", message.payload.decode("utf-8"))
    client.publish("gateway/cdcdcdcdcdcdcdcd/event/up", res)

client = mqtt.Client("FQMISLEAD")
client.connect("localhost")
client.subscribe("gateway/abababababababab/event/up")
client.on_message = on_message
client.loop_start()
time.sleep(100)
client.loop_stop()

```

Executing this script produces the behavior that happened in the previous section:

![](https://www.cyberark.com/wp-content/uploads/2020/10/Legit-and-malicious-MQTT-frames.jpg)

*Figure 6 – Legitimate MQTT frame followed by a malicious one*

When we performed this, the frame was not always forwarded to the Application Server. We looked at the logs of the Network Server (when the message was not forwarded) to understand this behavior:

![](https://www.cyberark.com/wp-content/uploads/2020/10/NS-Log-Invalid-MIC-Error.jpg)

*Figure 7 – Invalid MIC error on the Network Server’s logs*

The error does not say that the frequency is wrong, but it says that the MIC is invalid. This sounded strange, so we decided to debug the server to better understand the error.

#### Debugging the Server

When the Network Server gets started, it starts listening to the MQTT broker (specifically to the *gateway/+/event/up* topics). Anytime a message is written in one of these topics a new thread is created:

![](https://www.cyberark.com/wp-content/uploads/2020/10/Uplink-New-Thread-NS-Code.jpg)

*Figure 8 – New Thread created for each uplink frame (Chirpstack’s NS code – uplink.go)*

This thread will wait to be collected (with the other frames – we will discuss how later), and then, the main thread will perform a series of tests and manipulations on the frame. Among those tests, the MIC is checked. When looking for the “Invalid MIC” string in the code, I saw a constant called *errInvalidMIC* which was referred to in the *device\_session.go (GetDeviceSessionsForDevAddr* function) file:

![](https://www.cyberark.com/wp-content/uploads/2020/10/Throw-Invalid-Mic-NS-Code.jpg)

*Figure 9 – InvalidMIC error being thrown in GetDeviceSessionsForDevAddr function (Chirpstack’s NS – device\_session.go)*

After verifying that this was the function that was causing the error, we looked for the reason why. The function declares a variable called *micOK* and the error is thrown if *micOK* is false. Here is the code which sets the value of *micOK*:

![](https://www.cyberark.com/wp-content/uploads/2020/10/micOK-NS-Code.jpg)

*Figure 10 – micOK calculation (Chirpstack’s NS – device\_session.go)*

*fullFCnt* and *originalFCnt* are the different possible values for the FCnt (uplink frame counter, which is used to avoid replay attacks). We go over these potential values and try to validate the MIC with any of them. If one of is valid, we can move on with the code, otherwise we continue inside the loop. N*ote: the error here is only related to an internal error in the MIC verification, not to an invalid MIC value*.

The *validateUplinkDataMIC* function computes the MIC according to its arguments and verifies if the result is the same as the one stored in *phy*. If they are equal, it returns true, otherwise false.

When we debugged this piece of code, we tried to send regular messages and ones with the attack to see the difference. The one major difference was that when the attack was successful, the value of *txCh* (Transmission Channel – 5th byte of B1 in the calculation of the MIC) passed as an argument to *validateUplinkDataMIC* was 0. When there was no attack or the attack was not successful, the value of *txCh* was 8.

We investigated to see where the value of *txCh* was set:

![](https://www.cyberark.com/wp-content/uploads/2020/10/txCh-NS-Code.jpg)

*Figure 11 – Setting the value of txCh (Chirpstack’s code – data.go)*

As we can see, the *GetUplinkChannelIndex* function allows calculating the value of *txCh* simply based on the *frequency* value provided by the gateway. When the frequency is not supported by the Network Server, the value of *txCh* stays the original value: 0.

Because of this invalid value for *txCh*, the calculated MIC is invalid, and the message is dropped by the Network Server without being forwarded.

#### Message Collection

In order to have a clear idea of this attack, we need to understand why the legitimate message is collected with our malicious message and why the attack fails sometimes.

As seen earlier, the collection occurs early in the processing of the uplink frame. The new thread calls several functions in cascade. The most interesting function for us is *collectAndCallOnce* in *collect.go*. It collects all the uplink frames for the same message and then calls a callback function.

The different frames are stored in a Redis Set. The key to this set is the base64 encoded string of the *phyPayload* field. Thus, all the frames that have the same *phyPayload* will be stored in the same set. The collecting function then waits for a while. When all the messages are stored in the Redis database, the collecting function sets the message’s metadata:

![](https://www.cyberark.com/wp-content/uploads/2020/10/Message-Collection-NS-Code.jpg)

*Figure 12 – Message collection after storage (Chirpstack’s NS – collect.go)*

As we can see, the value of the *TXInfo (containing the frequency)* is set to be the frequency of the last payload in our set. Thus, our attack is successful only when the malicious message shows up after all the legitimate ones in the Redis set.

Redis sets are internally stored as Hash tables. The order of the output when we read the data out of the database is thus the order of the hashes. When we tried to perform statistical tests on Redis databases, it seemed like the hash depends on some seed stored in memory which changes occasionally. Thus, we cannot predict what the hash value would be for a specific payload.

On the other hand, since the result value of a hash can be considered random, we can assume that the probability of a successful attack can be significantly improved by sending our malicious message several times.

## Responsible Disclosure

We responsibly disclosed the security issue to Chirpstack. Their team responded very quickly to our emails and fixed the issue accordingly. During our conversation, we agreed on the fact that Gateways should be trusted in order to guarantee a minimum level of security for a LoRa Network. Thus, Chirpstack’s team implemented two fixes in order to increase security and mitigate the risks associated with these kinds of issues:

* Adding the frequency to the collection key of the uplink frames. This directly targets our attack and fixes the issue in a very straightforward way.
* Not allowing unregistered gateways to communicate with the Network Server. This fix is much more general and increases the security of Chirpstack’s implementation. An attacker now requires taking over an existing Gateway in order to perform this attack. Moreover, it strengthens the consistency of the product with Chirpstack’s philosophy: Gateways should be trusted for the network to be trusted.

## MQTT Security

The power of this security issue lies in an MQTT Authorization misconfiguration. With a safe configuration, the MQTT broker would block the malicious gateway from reading the uplinks of other gateways. In such a case, the attack surface would be significantly reduced and the malicious gateway would only be able to attack in its radio range — about 15km. In case of an MQTT misconfiguration, the attack can apply to the whole Network Server.

According to [this article](https://morphuslabs.com/hacking-the-iot-with-mqtt-8edaf0d07b9b) from Victor Pasknel (Morphus Labs), MQTT misconfigurations are very common on the web. In this research, they showed that more than 70% of the MQTT brokers tested (a random subset of brokers found on Shodan) do not implement Authorization at all, while 19% return “Not Authorized” and 11% return “Bad user or password” (some are likely default or weak passwords).

![](https://www.cyberark.com/wp-content/uploads/2020/10/MQTT-Authorization-Statistics-Shodan.jpg)

*Figure 12 – MQTT Authorization Statistics (Source: Morphus Labs)*

## Conclusion

LoRa opens new opportunities in the world of IoT and the LoRaWAN protocol allows battery-powered devices to be securely connected to the internet for long periods of time, making it a perfect solution for modern IoT devices. Indeed, as cities and industries are increasingly adopting smart devices to better run and operate, they are putting a high level of trust in the data they provide. A denial of service attack on these devices could make the infrastructure even less secure by allowing an attacker to virtually turn off the alert systems.

It’s important to note that the implementation of protocols almost always introduce new security issues, which is why research like this is important for raising awareness. In the case of implementing MQTT broker Authorization, the procedure is well described in [Chirpstack’s Documentation](https://www.chirpstack.io/project/guides/mqtt-authentication/) for the usage with a Chirpstack Network infrastructure. Although there might not be a significant security difference, we suggest configuring a different user to each gateway and highly recommend verifying the security status of each gateway in your whitelist.,

This is yet another example of the importance of a good implementation across all the elements in an infrastructure. A good implementation of the MQTT broker, in this case, would significantly decrease the attack surface of this security issue. Moreover, while protocols may be secure, the way they are implemented might present vulnerabilities, so it’s important for users to always be monitoring for any unusual behavior.

###### Previous Article

![Attacking Kubernetes Clusters Through Your Network Plumbing: Part 1](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2020%2F11%2FLabs_blog-post_2.png&size=1&version=1718922359&sig=460ed2f86ec33942cccc4a7447e9a777&default=hubs%2Ftilebg-blogs.jpg) Attacking Kubernetes Clusters Through Your Network Plumbing: Part 1

Have you ever wondered how the water supply gets into your home and to the taps? Honestly it may not be som...

###### Next Article

![Anti-Virus Vulnerabilities: Who’s Guarding the Watch Tower?](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2020%2F09%2FLobs_Blog_FW.jpg&size=1&version=1737014322&sig=4a0be81a152df463abdc9ae510f7045f&default=hubs%2Ftilebg-blogs.jpg) Anti-Virus Vulnerabilities: Who’s Guarding the Watch Tower?

This blog entry is a special anti-malware edition showcasing how the most common bugs security products suf...

## Recommended for You

* [‹](#related-items-carousel)
* [›](#related-items-carousel)

![Teach Yourself Kubiscan in 7 Minutes (or Less…)](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F11%2Fyourself-kubiscan.png&size=1&version=1737014301&sig=05cd6ea0626fa3f178e70dd4ec0b1cb0&default=hubs%2Ftilebg-blogs.jpg)
 Teach Yourself Kubiscan in 7 Minutes (or Less…)
#### xml encoding="UTF-8" While Kubernetes’ Role-based access control (RBAC) authorization model is an essential part of securing Kubernetes, managing it has proven to be a significant challenge — especially when dealing...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/teach-yourself-kubiscan-in-7-minutes-or-less)

![ByteCodeLLM – Privacy in the LLM Era: Byte Code to Source Code](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F12%2Fbytecodellm-header.png&size=1&version=1733852097&sig=7a94fac5eea6b69c47c905170d418404&default=hubs%2Ftilebg-blogs.jpg)
 ByteCodeLLM – Privacy in the LLM Era: Byte Code to Source Code
#### xml encoding="UTF-8" TL;DR ByteCodeLLM is a new open-source tool that harnesses the power of Local Large Language Models (LLMs) to decompile Python executables. Furthermore, and importantly, it prioritizes data...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/bytecodellm-privacy-in-the-llm-era-byte-code-to-source-code)

![White FAANG: Devouring Your  Personal Data](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F11%2Fdevouring-your-personal-data-1.png&size=1&version=1737014301&sig=8aa2dafd8b6856532d68d4acdd52a6a4&default=hubs%2Ftilebg-blogs.jpg)
 White FAANG: Devouring Your Personal Data
#### xml encoding="UTF-8" Generated using Ideogram Abstract Privacy is a core aspect of our lives. We have the fundamental right to control our personal data, physically or virtually. However, as we use products from...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/white-faang-devouring-your-personal-data)

![Discovering Hidden Vulnerabilities in Portainer with CodeQL](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fhidden-vulnerabilities-codeql.png&size=1&version=1737014301&sig=5c756d67217d4462b1f774e2a10e8cd7&default=hubs%2Ftilebg-blogs.jpg)
 Discovering Hidden Vulnerabilities in Portainer with CodeQL
#### xml encoding="UTF-8" Recently, we researched a project on Portainer, the go-to open-source tool for managing Kubernetes and Docker environments. With more than 30K stars on GitHub, Portainer gives you a user-friendly...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/discovering-hidden-vulnerabilities-in-portainer-with-codeql)

![Anatomy of an LLM RCE](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F10%2Fanatomy.jpg&size=1&version=1737014302&sig=40b897a46f747f12e3b90fd8826a4bd0&default=hubs%2Ftilebg-blogs.jpg)
 Anatomy of an LLM RCE
#### xml encoding="UTF-8" As large language models (LLMs) become more advanced and are granted additional capabilities by developers, security risks increase dramatically. Manipulated LLMs are no longer just a risk of...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/anatomy-of-an-llm-rce)

![A Security Analysis of Azure DevOps Job Execution](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F08%2Fsecurity-analysis-of-azure.jpg&size=1&version=1737014302&sig=b58ae8970f2e350e35d00639d6675541&default=hubs%2Ftilebg-blogs.jpg)
 A Security Analysis of Azure DevOps Job Execution
#### xml encoding="UTF-8" In software development, CI/CD practices are now standard, helping to move code quickly and efficiently from development to production. Azure DevOps, previously known as Team Foundation Server...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/a-security-analysis-of-azure-devops-job-execution)

![AI Treason: The Enemy Within](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F08%2Fai-treason.png&size=1&version=1737014302&sig=463b4b98f3a207767b5d23ad2f622bd9&default=hubs%2Ftilebg-blogs.jpg)
 AI Treason: The Enemy Within
#### xml encoding="UTF-8" tl;dr: Large language models (LLMs) are highly susceptible to manipulation, and, as such, they must be treated as potential attackers in the system. LLMs have become extremely popular and serve...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/ai-treason-the-enemy-within)

![A Brief History of Game Cheating](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F07%2Fbrief-history.jpg&size=1&version=1737014302&sig=6fd5374c1b20b41d1b89450511362d97&default=hubs%2Ftilebg-blogs.jpg)
 A Brief History of Game Cheating
#### xml encoding="UTF-8" Over the short span of video game cheating, both cheaters and game developers have evolved in many ways; this includes everything from modification of important game variables (like health) by...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/a-brief-history-of-game-cheating)

![Double Dipping Cheat Developer Gets Caught Red-Handed](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F07%2Fdouble-dipping-hero.jpg&size=1&version=1737014302&sig=c41f430c2804ef21c9019d1b56670065&default=hubs%2Ftilebg-blogs.jpg)
 Double Dipping Cheat Developer Gets Caught Red-Handed
#### xml encoding="UTF-8" Following our post “A Brief History of Game Cheating,” it’s safe to say that cheats, no matter how lucrative or premium they might look, always carry a degree of danger. Today’s story revolves...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/double-dipping-cheat-developer-gets-caught-red-handed)

![Identity Crisis: The Curious Case of a Delinea Local Privilege Escalation Vulnerability](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F07%2Flocal-privilege-escalation-vulnerability.png&size=1&version=1737014302&sig=af6e43d007b6df5344f37b119f1718d0&default=hubs%2Ftilebg-blogs.jpg)
 Identity Crisis: The Curious Case of a Delinea Local Privilege Escalation Vulnerability
#### xml encoding="UTF-8" During a recent customer engagement, the CyberArk Red Team discovered and exploited an Elevation of Privilege (EoP) vulnerability (CVE-2024-39708) in Delinea Privilege Manager (formerly Thycotic...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/identity-crisis-the-curious-case-of-a-delinea-local-privilege-escalation-vulnerability)

![How to Bypass Golang SSL Verification](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F07%2Fbypass-golang.jpg&size=1&version=1737014302&sig=f04ea569511e2ac5a4b6433e5287a002&default=hubs%2Ftilebg-blogs.jpg)
 How to Bypass Golang SSL Verification
#### xml encoding="UTF-8" Golang applications that use HTTPS requests have a built-in SSL verification feature enabled by default. In our work, we often encounter an application that uses Golang HTTPS requests, and we have...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/how-to-bypass-golang-ssl-verification)

![The Current State of Browser Cookies](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F07%2Fcurrentstate-ofobrowser-cookies.jpg&size=1&version=1737014302&sig=200ebf5ce5f7cc13405aefa7248f7684&default=hubs%2Ftilebg-blogs.jpg)
 The Current State of Browser Cookies
#### xml encoding="UTF-8" What Are Cookies When you hear “cookies,” you may initially think of the delicious chocolate chip ones. However, web cookies function quite differently than their crumbly-baked counterparts....

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/the-current-state-of-browser-cookies)

![You Can’t Always Win Racing the (Key)cloak](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F06%2Fkeycloak-blog-hero.jpg&size=1&version=1737014302&sig=ed9b0467658f999c0cdc292f035f58b9&default=hubs%2Ftilebg-blogs.jpg)
 You Can’t Always Win Racing the (Key)cloak
#### xml encoding="UTF-8" Web Race Conditions – Success and Failure – a Keycloak Case Study In today’s connected world, many organizations’ “keys to the kingdom” are held in identity and access management (IAM) solutions;...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/you-cant-always-win-racing-the-keycloak)

![Operation Grandma: A Tale of LLM Chatbot Vulnerability](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F05%2Fcreepy-bed.png&size=1&version=1737014302&sig=cc82eb8db13c4714e0f005f7e9e17cd6&default=hubs%2Ftilebg-blogs.jpg)
 Operation Grandma: A Tale of LLM Chatbot Vulnerability
#### xml encoding="UTF-8" Who doesn’t like a good bedtime story from Grandma? In today’s landscape, more and more organizations are turning to intelligent chatbots or large language models (LLMs) to boost service quality...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/operation-grandma-a-tale-of-llm-chatbot-vulnerability)

![Your NVMe Had Been Syz’ed: Fuzzing NVMe-oF/TCP Driver for Linux with Syzkaller](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F04%2Flinux-with-syzkaller.png&size=1&version=1737014303&sig=08f788940811f0d6500f61fa02ea2038&default=hubs%2Ftilebg-blogs.jpg)
 Your NVMe Had Been Syz’ed: Fuzzing NVMe-oF/TCP Driver for Linux with Syzkaller
#### xml encoding="UTF-8" Following research conducted by a colleague of mine [1] at CyberArk Labs, I better understood NVMe-oF/TCP. This kernel subsystem exposes INET socket(s), which can be a fruitful attack surface for...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/your-nvme-had-been-syzed-fuzzing-nvme-of-tcp-driver-for-linux-with-syzkaller)

![Crumbled Security: Unmasking the Cookie-Stealing Malware Threat](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F03%2Fhero-labs-crumbled-security.jpg&size=1&version=1737014303&sig=fb350450803b2ed48f69e33de6b99b44&default=hubs%2Ftilebg-blogs.jpg)
 Crumbled Security: Unmasking the Cookie-Stealing Malware Threat
#### xml encoding="UTF-8" Over the past few years, we’ve seen a huge increase in the adoption of identity security  solutions. Since these types of solutions help protect against a whole range of password-guessing and...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/crumbled-security-unmasking-the-cookie-stealing-malware-threat)

![The Hacker’s Guide to The Cosmos (SDK): Stealing Millions from the Blockchain](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F02%2Fcosmos-millions-from-the-blockchain.png&size=1&version=1737014303&sig=5266b8642473dfb2f63317be1b31039b&default=hubs%2Ftilebg-blogs.jpg)
 The Hacker’s Guide to The Cosmos (SDK): Stealing Millions from the Blockchain
#### xml encoding="UTF-8" Introduction Welcome, fellow travelers of the Cosmos! While we may not be traversing the stars on a spaceship, we are all interconnected through the powerful network of blockchains. Unfortunately,...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/the-hackers-guide-to-the-cosmos-sdk-stealing-millions-from-the-blockchain)

![A Deep Dive into Penetration Testing of macOS Applications (Part 3)](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2023%2F07%2Fdeep-dive-into-penetration-testing.jpg&size=1&version=1737014303&sig=35079d54df839e134c592ed4726f25af&default=hubs%2Ftilebg-blogs.jpg)
 A Deep Dive into Penetration Testing of macOS Applications (Part 3)
#### xml encoding="UTF-8" Introduction This is the final installment of the blog series “A Deep Dive into Penetration Testing of macOS Applications.” Previously, we discussed the structure of macOS applications and their...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/a-deep-dive-into-penetration-testing-of-macos-applications-part-3)

![Ransomware’s PLAYing a Broken Game](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2024%2F01%2Fransomware-playing-a-broken-game.png&size=1&version=1737014303&sig=1395628b27a7abd1a37b2c68294ecb2a&default=hubs%2Ftilebg-blogs.jpg)
 Ransomware’s PLAYing a Broken Game
#### xml encoding="UTF-8" Abstract The Play ransomware group is one of the most successful ransomware syndicates today. All it takes is a quick peek with a disassembler to know why this group has become infamous. This is...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/ransomwares-playing-a-broken-game)

![SafeNet: Securing Your Network From Yourself](https://content.cdntwrk.com/mediaproxy?url=https%3A%2F%2Fwww.cyberark.com%2Fwp-content%2Fuploads%2F2023%2F12%2Fsafenet-banner.jpg&size=1&version=1737014303&sig=858ed4ca24b4a42252f14c14b48fd46c&default=hubs%2Ftilebg-blogs.jpg)
 SafeNet: Securing Your Network From Yourself
#### xml encoding="UTF-8" TL;DR Whether working at home or in the office, when conducting cybersecurity research, investigating the dark web forums or engaging with any dangerous part of the internet, staying safe is...

[Read Blog](https://www.cyberark.com/resources/threat-research-blog/safenet-securing-your-network-from-yourself)

[Return to Home](https://www.cyberark.com/resources)

© CyberArk Software Inc

×
Streams

* Products & Services
  + [Cloud Security](https://www.cyberark.com/resources/cloud-security)
  + [Customer Access](https://www.cyberark.com/resources/customer-access)
  + [Endpoint Privilege Security](https://www.cyberark.com/resources/endpoint-privilege-security)
  + [Identity Management](https://www.cyberark.com/resources/identity-management)
  + [Privileged Access Management](https://www.cyberark.com/resources/privileged-access-management)
  + [Secrets Management](https://www.cyberark.com/resources/secrets-management)
  + [Services & Support​](https://www.cyberark.com/resources/services-support)
  + [Shared Services](https://www.cyberark.com/resources/shared-services)
  + [Workforce Access](https://www.cyberark.com/resources/workforce-access)
* Topics
  + [Access Management](https://www.cyberark.com/resources/access-management)
  + [Best Practices](https://www.cyberark.com/resources/best-practices)
  + [DevSecOps](https://www.cyberark.com/resources/devsecops)
  + [Endpoint Security](https://www.cyberark.com/resources/endpoint-security)
  + [Hybrid and Multi-Cloud Security](https://www.cyberark.com/resources/hybrid-and-multi-cloud-security)
  + [Identity Security](https://www.cyberark.com/resources/identity-security)
  + [IT Security Audit and Compliance](https://www.cyberark.com/resources/it-security-audit-and-compliance)
  + [Least Privilege](https://www.cyberark.com/resources/least-privilege)
  + [Partners](https://www.cyberark.com/resources/partners)
  + [Ransomware Protection](https://www.cyberark.com/resources/ransomware-protection)
  + [Remote Access](https://www.cyberark.com/resources/remote-access)
  + [Robotic Process Automation](https://www.cyberark.com/resources/robotic-process-automation)
  + [Threat Research​](https://www.cyberark.com/resources/threat-research)
  + [Zero Trust](https://www.cyberark.com/resources/zero-trust)
* Industry
  + [Federal](https://www.cyberark.com/resources/federal)
  + [Financial Services](https://www.cyberark.com/resources/financial-services)
  + [Healthcare​](https://www.cyberark.com/resources/healthcare)
  + [Higher Education](https://www.cyberark.com/resources/higher-education)
  + [Insurance](https://www.cyberark.com/resources/insurance)
  + [Manufacturing](https://www.cyberark.com/resources/manufacturing)
* Content Type
  + [Analyst Reports](https://www.cyberark.com/resources/analyst-reports)
  + [Blog Articles](https://www.cyberark.com/resources/all-blog-posts)
  + [Customer Stories](https://www.cyberark.com/customer-stories/)
  + [eBooks​](https://www.cyberark.com/resources/ebooks)
  + [Executive Insights](https://www.cyberark.com/resources/executive-insights)
  + [Infographics​](https://www.cyberark.com/resources/infographics)
  + [Podcasts](https://www.cyberark.com/podcasts/)
  + [Product Announcements](https://www.cyberark.com/resources/product-announcements)
  + [Product Datasheets​](https://www.cyberark.com/resources/product-datasheets)
  + [Solution Briefs​](https://www.cyberark.com/resources/solution-briefs)
  + [Tools & Blueprints](https://www.cyberark.com/resources/tools-blueprints)
  + [Webinars](https://www.cyberark.com/resources/webinars)
  + [Videos](https://www.cyberark.com/resources/videos)
  + [Whitepapers​](https://www.cyberark.com/resources/white-papers)

![loading](https://content.cdntwrk.com/img/hubs/ajax-loader-white-2x.gif?v=19a554b579c4)

* Share this Hub
* [Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.cyberark.com%2Fresources)
* [Twitter](https://twitter.com/share?text=Check%20out%20what%27s%20happening%20at%20CyberArk%21&url=https%3A%2F%2Fwww.cyberark.com%2Fresources&via=CyberArk)
* [Email](/cdn-cgi/l/email-protection#5f602c2a3d353a3c2b621a313833362c377a6d6f7a1a6d7a676f7a666c7a6d6f1c263d3a2d1e2d347a6d6f0c30392b283e2d3a7a6d6f16313c7a6d682c7a6d6f172a3d7a6d6f373e2c7a6d6f3d3a3a317a6d6f2c373e2d3a3b7a6d6f28362b377a6d6f26302a793e322f643d303b26621c373a3c347a6d6f302a2b7a6d6f28373e2b7a6d682c7a6d6f373e2f2f3a313631387a6d6f3e2b7a6d6f1c263d3a2d1e2d347a6d6e7a6f1e7a6f1e372b2b2f2c7a6c1e7a6d197a6d19282828713c263d3a2d3e2d34713c30327a6d192d3a2c302a2d3c3a2c)
* [LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.cyberark.com%2Fresources&title=English%20%E2%80%93%20CyberArk%20Software%20Inc%27s&summary=Check%20out%20what%27s%20happening%20at%20CyberArk%21)

×

* #### STAY IN TOUCH

  Keep up to date on security best practices, events and webinars.

  [Tell Me How](https://lp.cyberark.com/Stay-in-touch.html)

* Support
* [Contact Support](https://www.cyberark.com/services-support/technical-support-contact/)
* [Training & Certification](https://www.cyberark.com/services-support/training/)
* [Technical Support](https://www.cyberark.com/services-support/technical-support/)
* [EPM SaaS Register / Login](https://www.cyberark.com/products/endpoint-privilege-manager/login/)
* [Product Security](https://www.cyberark.com/product-security/)

* Resources
* [Resource Center](https://www.cyberark.com/resources)
* [Events](https://www.cyberark.com/events/)
* [Blogs](https://www.cyberark.com/resources/all-blog-posts)
* [CIO Connection](https://www.cyberark.com/cio-connection/)
* [CyberArk Blueprint](https://www.cyberark.com/blueprint/)
* [Scan Your Network](https://www.cyberark.com/discovery-audit/)
* [Marketplace![external icon](https://www.cyberark.com/wp-content/uploads/2021/01/External-darkblue.svg)](https://community.cyberark.com/marketplace/s/)

* Partners
* [Partner Network](https://www.cyberark.com/partners/partner-network/)
* [Partner Community![external link](https://www.cyberark.com/wp-content/uploads/2021/01/External-darkblue.svg)](https://community.cyberark.com/partners/s/login/)
* [Partner Finder](https://www.cyberark.com/partner-finder/)
* [Become a Partner](https://www.cyberark.com/partners/become-a-partner/)
* [Alliance Partner](https://www.cyberark.com/partners/alliance-partners/)

* Company
* [Investor Relations ![external link](https://www.cyberark.com/wp-content/uploads/2021/01/External-darkblue.svg)](https://investors.cyberark.com/home/default.aspx)
* [Leadership](https://www.cyberark.com/company/leadership/)
* [Board of Directors](https://www.cyberark.com/company/leadership/#directors)
* [Newsroom](https://www.cyberark.com/company/newsroom/)
* [Office Locations](https://www.cyberark.com/company/office-locations/)
* [Environmental, Social and Governance](https://www.cyberark.com/company/esg/)
* [Trust Center](https://www.cyberark.com/trust/)
* [Careers – We’re Hiring!](https://careers.cyberark.com/)

![CyberArk Logo](https://cihost.uberflip.com/cyberArk/favicon-update/assets/cyberark-logo.svg)

Copyright ©  CyberArk Software Ltd.
All rights reserved.

* [*Linkedin*](https://www.linkedin.com/company/cyber-ark-software)
* [*Blog*](https://www.cyberark.com/resources/blog)
* [*Youtube*](https://www.youtube.com/user/cyberarksoftware)

* [Terms and Conditions](https://www.cyberark.com/terms-conditions/)
* [Privacy Policy](https://www.cyberark.com/privacy-notice/)


