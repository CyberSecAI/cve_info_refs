```json
{
  "CVE-2020-28910": {
    "description": "The vulnerability is present in `getprofile.sh` script. It can be executed as sudo by the `nagios` and `apache` users. The script reads the last 100 lines of `/usr/local/nagiosxi/tmp/phpmailer.log` and writes them to `/usr/local/nagiosxi/var/components/profile/$folder/phpmailer.log`. Since the `apache` user can write to both file locations, a symlink can be used to overwrite another sudoers script, like `repair_databases.sh`, to execute arbitrary code as root.",
    "root_cause": "Abuse of a script (`getprofile.sh`) that can be executed as sudo by the `nagios` and `apache` users coupled with a symlink vulnerability allowing to overwrite other sudoers scripts with attacker controlled content.",
     "weaknesses": [
        "Privilege Escalation",
         "Symlink vulnerability",
         "Unsanitized File Path"
    ],
    "impact": "Privilege escalation from `apache` or `nagios` user to `root`.",
    "attack_vectors": [
      "Compromise of Nagios XI server with low privilege access",
      "Exploiting the `getprofile.sh` script to overwrite `repair_databases.sh` script with attacker controlled content"
    ],
    "required_capabilities": [
      "Low privilege access to a Nagios XI server as either the `apache` or `nagios` user"
    ],
    "additional_information": "The technique damages the `repair_databases.sh` script. A copy should be made before using this technique to be able to restore functionality."
  }
}
```