Based on the provided content, here's an analysis of CVE-2020-28023:

**Root Cause:**
The vulnerability lies in the `smtp_setup_msg()` function, specifically in how it handles a circular buffer (`smtp_connection_had`) used to track the sequence of SMTP commands. The issue arises when an invalid command sequence (e.g., DATA command before a valid RCPT command) is received.

**Weaknesses/Vulnerabilities Present:**
- **Out-of-bounds read:** The code attempts to read a previous command from the `smtp_connection_had` buffer using an index that can go out of bounds.  Specifically, `smtp_ch_index-1` is used without proper bounds checking, leading to an out-of-bounds read when `smtp_ch_index` is 0.
- **Circular buffer handling error:** The circular buffer is not properly handled, leading to an out-of-bounds access when the index wraps.
- **Potential sensitive information disclosure:** The out-of-bounds read can access unintended memory locations which are then used to construct an error message which is sent to the client.

**Impact of Exploitation:**
- **Information Disclosure:** The primary impact is the potential disclosure of sensitive information from Exim's memory. The content of `smtp_names` and memory located near it can be revealed to a remote, unauthenticated attacker.
- **Crash:** In some scenarios, the out-of-bounds read could potentially lead to a crash due to accessing invalid memory.

**Attack Vectors:**
- **Remote Attack:** This is a remote vulnerability, exploitable by sending crafted SMTP commands to the Exim server.
- **Unauthenticated:** The attacker does not need any authentication to trigger the vulnerability.

**Required Attacker Capabilities/Position:**
- **Network access to Exim server:** The attacker must be able to connect to the Exim server via the network on the SMTP port (usually port 25, or 465/587 for encrypted connections).
- **Ability to send SMTP commands:** The attacker needs the ability to send custom SMTP commands to the server.
- **Knowledge of SMTP protocol:** Basic understanding of the SMTP protocol is required to craft the sequence of commands that triggers the vulnerability.

**Technical Details:**
- The vulnerability is triggered by sending a DATA command before a valid RCPT command.
- The `HAD(SCH_DATA)` macro in `smtp_setup_msg` is used to record the sequence of commands, using a circular buffer.
- If the buffer becomes full, the `smtp_ch_index` is reset to 0.
- The vulnerability lies in how the previous command is accessed using the potentially out-of-bounds index `smtp_ch_index - 1`.
-  The `smtp_printf()` function is used to return an error to the client based on the previous command in the sequence, thereby exposing potentially sensitive information to the attacker from a location adjacent to `smtp_names`.
- The specific line that causes the vulnerability is: `smtp_names[smtp_connection_had[smtp_ch_index-1]]`

**Additional Notes:**
- The report notes that on Debian, the out-of-bounds read results in accessing index 0 of `smtp_names`  which outputs "NONE", which is not harmful. However, other operating systems might have different memory layouts, making this vulnerability more exploitable by leaking pointers or other sensitive information.
- The vulnerability was introduced in Exim 4.88 and was later independently discovered and patched by Exim developers with a proper index fix.