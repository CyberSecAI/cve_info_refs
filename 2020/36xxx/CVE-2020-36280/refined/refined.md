```
{
  "vulnerability": {
    "CVE": "CVE-2020-36280",
    "description": "The provided content details a heap-based buffer overflow vulnerability in the `pixReadFromTiffStream` function within the Leptonica library. When reading a TIFF image with gray and alpha channels, the function allocates a buffer based on the size of a single scanline. If the image is then converted to RGBA format, the code does not account for the increased size of the RGBA scanline, which is twice as large as the original gray+alpha scanline. This leads to a heap-based buffer overflow during the conversion process when writing to the `pixdata`. ",
    "affected_component": "leptonica library, specifically the `pixReadFromTiffStream` function",
    "root_cause": "Insufficient buffer size calculation when converting a gray+alpha TIFF image to RGBA, leading to a heap-based buffer overflow.",
    "vulnerability": "Heap-based buffer overflow",
    "impact": "A successful exploit of this vulnerability could lead to arbitrary code execution or a denial-of-service due to memory corruption.",
    "attack_vector": "The vulnerability is triggered when a malicious TIFF image file, specifically one with gray and alpha channels that is then converted to RGBA, is processed using the `pixReadFromTiffStream` function.",
    "attacker_capabilities": "An attacker needs to be able to provide a specially crafted TIFF image that triggers the vulnerable code path. They need to have the ability to submit or have the target application load/process the malformed tiff image.",
    "additional_details": [
      "The vulnerability is located in `tiffio.c`.",
      "The fix involves doubling the allocated buffer size to accommodate the RGBA format during conversion from gray+alpha.",
       "The issue was discovered as issue 23654 in oss-fuzz.",
       "The fix was introduced in commit `5ba34b1`.",
        "The vulnerability is present in versions prior to 1.80.0"
    ],
    "remediation": "Upgrade to Leptonica version 1.80.0 or later, which includes the fix for this vulnerability.",
    "references": [
      "https://bugzilla.redhat.com/show_bug.cgi?id=1939211",
      "https://bugzilla.redhat.com/show_bug.cgi?id=1939212",
      "https://nvd.nist.gov/vuln/detail/CVE-2020-36280",
      "https://github.com/DanBloomberg/leptonica/commit/5ba34b1fe741d69d43a6c8cf767756997eadd87c",
       "https://security.gentoo.org/glsa/202107-53"
    ]
  }
}
```