Based on the provided content, here's an analysis of CVE-2020-36407:

**Root cause of vulnerability:**

- The vulnerability stems from a missing check on the image dimensions (width and height) before allocating memory, which could lead to an integer overflow.

**Weaknesses/vulnerabilities present:**

- **Integer Overflow:** The code was vulnerable to an integer overflow when calculating the required memory for an image grid, if the `outputWidth` * `outputHeight` exceeded the maximum value of an unsigned integer.
- **Missing Size Check:** There wasn't a proper check to ensure that the calculated image size based on `outputWidth` and `outputHeight` remained within acceptable limits, prior to memory allocation. This could lead to an attempt to allocate extremely large amounts of memory, or other issues.

**Impact of exploitation:**

- **Out-of-Memory:** Exploiting the vulnerability could result in an out-of-memory condition, potentially leading to a crash or denial-of-service (DoS).
- **UNKNOWN WRITE**: The vulnerability could lead to an "unknown write" when processing a crafted image, which could corrupt memory and may lead to further exploitation.

**Attack vectors:**

- **Crafted AVIF File:** An attacker could create a specially crafted AVIF file that contains an image grid box with large `outputWidth` and `outputHeight` values to trigger the overflow.
- **Image Processing:** The vulnerability would be triggered when the vulnerable software attempted to parse and process this crafted AVIF file.

**Required attacker capabilities/position:**

- **File creation/modification:** The attacker needs to be able to create or modify an AVIF file.
- **Victim Interaction:** The victim needs to process the crafted file using the vulnerable libavif library.

**Additional details:**

- The provided commit `0a8e7244d494ae98e9756355dfbfb6697ded2ff9` addresses the vulnerability by introducing a check that prevents `grid->outputWidth * grid->outputHeight` from exceeding `AVIF_MAX_IMAGE_SIZE`.
- The maximum image size is set to `16384 * 16384`.
- The vulnerability was reported through the OSS-Fuzz project, as referenced by `https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=24811` and `https://crbug.com/oss-fuzz/24728` and `https://crbug.com/oss-fuzz/24734`.
- The vulnerability is also tracked as OSV-2020-1597.
- The vulnerability is present in libavif versions up to 0.8.0 and 0.8.1 and was fixed by the commit `0a8e7244d494ae98e9756355dfbfb6697ded2ff9` and `4cfee6282b97533e6c99183ddf7a897173755c69`.