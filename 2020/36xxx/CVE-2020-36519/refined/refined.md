The provided content describes a vulnerability found in Mimecast's email security platform, specifically how it handles sender address verification.

**Root Cause of Vulnerability:**
The vulnerability stems from Mimecast's address alteration/rewrite functionality and insufficient checks on sender domain ownership. Mimecast's system allows users to send emails using addresses from domains that they do not own, provided those domains are also Mimecast customers, or in some cases even if they are not. This was possible because Mimecast's authorized sending IPs were trusted for SPF checks without proper authorization checks on the sending account.

**Weaknesses/Vulnerabilities Present:**
1.  **Lack of Domain Ownership Verification:** Mimecast's system doesn't verify if a user is authorized to send emails from a domain they're trying to use in the "From" field.
2.  **Abuse of Address Alteration/Rewrite:** The address alteration functionality intended for legitimate purposes could be abused to spoof email addresses from any domain using Mimecast.
3.  **SPF Bypass:** Mimecast's authorized sending IPs were trusted for SPF checks, allowing spoofed emails to pass SPF verification even if the sending account was not authorized to use the "From" domain.
4.  **DMARC Bypass:** Due to the passing SPF check, the spoofed emails also bypassed DMARC checks. Since SPF passed, and because of DMARC's relaxed (default) mode, messages were considered valid.
5.  **Calendar Invite Issue:** Calendar invites were not being rewritten correctly and were failing DMARC checks due to reverting to the primary sending domain.

**Impact of Exploitation:**
1.  **Email Spoofing:** Attackers could send emails appearing to be from any domain that uses Mimecast, including high-profile brands, and other customers.
2.  **Bypassing Email Security:** The spoofed emails bypassed SPF and DMARC checks, making them appear legitimate to receiving email servers and end-users.
3.  **Phishing and Social Engineering:** Attackers could use spoofed emails for phishing campaigns, social engineering attacks, or spreading malware.
4.  **Brand Impersonation:** Attackers could impersonate trusted brands, damaging their reputation.
5.  **BIMI Exploitation (Potential):** If the spoofed brand was using BIMI, the attacker could display the company's logo alongside their spoofed email, further increasing credibility.

**Attack Vectors:**
1.  **Mimecast Portal:** Attackers could use the Mimecast portal to configure address alteration and send emails with spoofed "From" addresses.
2.  **Mimecast's Authorized IPs:** By sending through Mimecast's infrastructure, attackers could leverage the fact that Mimecast's sending IPs are trusted for SPF validation.

**Required Attacker Capabilities/Position:**
1.  **Mimecast Account:** The attacker needs a valid Mimecast account within any Mimecast environment.
2.  **Basic Email Knowledge:** Understanding of email headers, SPF, and DMARC is beneficial.
3.  **Knowledge of Mimecast Infrastructure:** Knowledge of Mimecast's MX records is helpful for identifying potential target domains, but not strictly required.
4.  **Ability to use the Mimecast portal:** Basic familiarity with the interface is required to set up the address alternation/rewrite functionality.
5.  **Optional Scripting Knowledge:** For identifying target domains with specific MX records and DMARC policies (p=reject).

**Additional Notes:**
*   The vulnerability allowed spoofing of both Mimecast customers' domains and non-customer domains (the latter would fail DMARC, but still be a form of spoofing).
*   The vulnerability was also successfully demonstrated against mimecast.com domain using a training tenant.
*   The researcher was able to get DMARC to pass by utilizing Mimecast's "address alternation policy", which altered the RFC5322.From address to a spoofed domain, but still sent the email from Mimecast's authorized IP addresses, allowing the emails to pass SPF and therefore DMARC checks.
*   The issue was disclosed to Mimecast on 06/11/19 and eventually fixed on 12/20/19.

This content provides significantly more detail than a typical CVE description.