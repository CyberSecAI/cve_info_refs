Based on the provided content, here's the breakdown of the vulnerability described by CVE-2020-36156:

**Root Cause:**

*   The vulnerability stems from a lack of capability checks in the `profile_update` function of the Ultimate Member plugin. This function is used to update a user's Ultimate Member role during profile updates. The function uses `is_admin()` check but doesn't properly validate if the user has the necessary privileges to modify user roles.

**Weaknesses/Vulnerabilities:**

*   **Insufficient Access Control:** The `profile_update` function lacks proper capability checks, allowing users with access to the `profile.php` page in the WordPress admin area to modify their own or other user's roles, even if they are not administrators.
*   **Insecure use of `is_admin()`:** The code uses `is_admin()` without verifying the user's actual permissions to update user roles. This allows any user with wp-admin access to the `profile.php` page to exploit the vulnerability.

**Impact of Exploitation:**

*   **Privilege Escalation:** An authenticated user with access to their profile page within `wp-admin` can escalate their privileges to those of an administrator or any other custom Ultimate Member role. This could allow attackers full control over the website, including the ability to take the site offline, inject malware or manipulate sensitive data.

**Attack Vectors:**

*   **HTTP POST Request:** The vulnerability is exploited by sending a POST request to the `/wp-admin/profile.php` page.
*   **Manipulation of `um-role` parameter:** The attacker needs to include the `um-role` parameter in the POST request with the desired role they want to escalate to, when updating their profile.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** The attacker needs to be a registered user on the WordPress site and have the ability to access the WordPress `wp-admin` dashboard. This access can be obtained through another vulnerability.
*   **Access to Profile Update Page:** The user needs to have access to the `profile.php` page within the WordPress admin panel.

**Technical Details:**

The vulnerable code snippet from the plugin is:
```php
function profile_update( $user_id, $old_data ) {
    // Bail if no user ID was passed
    if ( empty( $user_id ) ) {
        return;
    }

    $old_roles = $old_data->roles;
    $userdata  = get_userdata( $user_id );
    $new_roles = $userdata->roles;

    if ( is_admin() ) {
        if ( ! empty( $_POST['um-role'] ) ) {
            $new_roles = array_merge( $new_roles, array( $_POST['um-role'] ) );
            if ( ! user_can( $user_id, $_POST['um-role'] ) ) {
                UM()->roles()->set_role( $user_id, $_POST['um-role'] );
            }
        }
    }
}
```

The issue is that the `is_admin()` function only checks if the user is in the admin interface, not if they have the permission to change user roles. This allows any user with access to the wp-admin area to modify their role using the `um-role` parameter. The vulnerability allows the attacker to bypass the `user_can()` check by adding the selected role to `$new_roles` array and then using the `UM()->roles()->set_role()` function, which doesn't perform capabilities checks.

This vulnerability is fixed in version 2.1.12 of the Ultimate Member plugin.