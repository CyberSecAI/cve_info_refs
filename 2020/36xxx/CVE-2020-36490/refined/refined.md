- **Root cause of vulnerability:** The application fails to properly sanitize user-supplied input before including it in the HTML output, leading to persistent cross-site scripting (XSS) vulnerabilities.
- **Weaknesses/vulnerabilities present:** Persistent XSS vulnerabilities exist in multiple parameters across several files. Specifically, the `activepath`, `keyword`, `tag`, `fmdo=x&filename`, `CKEditor`, and `CKEditorFuncNum` parameters of the `file_pic_view.php`, `file_manage_view.php`, `tags_main.php`, `select_media.php`, and `media_main.php` files are vulnerable.
- **Impact of exploitation:** Successful exploitation can lead to session hijacking, persistent phishing attacks, persistent redirects to malicious sources, and persistent manipulation of affected or connected application modules.
- **Attack vectors:** Remote attackers can inject malicious script codes via POST requests to the vulnerable parameters. The injected scripts are stored and executed when other users access the affected pages.
- **Required attacker capabilities/position:** The attacker needs a privileged user account to exploit the vulnerabilities. User interaction is considered low, suggesting that the attacker does not need to directly interact with the victim once the malicious code is injected.