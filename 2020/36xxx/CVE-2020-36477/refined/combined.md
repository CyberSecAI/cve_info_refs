=== Content from github.com_201815a7_20250119_125950.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.24.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.24.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=Mbed-TLS%2Fmbedtls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Mbed-TLS](/Mbed-TLS)
/
**[mbedtls](/Mbed-TLS/mbedtls)**
Public

* [Notifications](/login?return_to=%2FMbed-TLS%2Fmbedtls) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)
* [Star
   5.7k](/login?return_to=%2FMbed-TLS%2Fmbedtls)

* [Code](/Mbed-TLS/mbedtls/tree/v2.24.0)
* [Issues
  1.3k](/Mbed-TLS/mbedtls/issues)
* [Pull requests
  265](/Mbed-TLS/mbedtls/pulls)
* [Projects
  0](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

Additional navigation options

* [Code](/Mbed-TLS/mbedtls/tree/v2.24.0)
* [Issues](/Mbed-TLS/mbedtls/issues)
* [Pull requests](/Mbed-TLS/mbedtls/pulls)
* [Projects](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

1. [Releases](/Mbed-TLS/mbedtls/releases)
2. [v2.24.0](/Mbed-TLS/mbedtls/releases/tag/v2.24.0)

# Mbed TLS 2.24.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.24.0)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

![@yanesca](https://avatars.githubusercontent.com/u/6871045?s=40&v=4)
[yanesca](/yanesca)
released this
01 Sep 09:21

·
[18954 commits](/Mbed-TLS/mbedtls/compare/v2.24.0...development)
to development
since this release

[v2.24.0](/Mbed-TLS/mbedtls/tree/v2.24.0)

[`523f055`](/Mbed-TLS/mbedtls/commit/523f0554b6cdc7ace5d360885c3f5bbcc73ec0e8)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## Description

This release of Mbed TLS provides bug fixes and minor enhancements. This release includes fixes for security issues and the most notable of them are described in more detail in the [security advisories](https://tls.mbed.org/tech-updates/security-advisories).

## API changes

* In the PSA API, rename the types of elliptic curve and Diffie-Hellman group families to psa\_ecc\_family\_t and psa\_dh\_family\_t, in line with the PSA Crypto API specification version 1.0.0. Rename associated macros as well:

  PSA\_ECC\_CURVE\_xxx renamed to PSA\_ECC\_FAMILY\_xxx

  PSA\_DH\_GROUP\_xxx renamed to PSA\_DH\_FAMILY\_xxx

  PSA\_KEY\_TYPE\_GET\_CURVE renamed to to PSA\_KEY\_TYPE\_ECC\_GET\_FAMILY

  PSA\_KEY\_TYPE\_GET\_GROUP renamed to PSA\_KEY\_TYPE\_DH\_GET\_FAMILY

## Default behavior changes

* Stop storing persistent information about externally stored keys created through PSA Crypto with a volatile lifetime. Reported in [#3288](https://github.com/Mbed-TLS/mbedtls/issues/3288) and contributed by Steven Cooreman in [#3382](https://github.com/Mbed-TLS/mbedtls/pull/3382).

## Features

* The new function mbedtls\_ecp\_write\_key() exports private ECC keys back to a byte buffer. It is the inverse of the existing mbedtls\_ecp\_read\_key().
* Support building on e2k (Elbrus) architecture: correctly enable -Wformat-signedness, and fix the code that causes signed-one-bit-field and sign-compare warnings. Contributed by makise-homura (Igor Molchanov) akemi\_homura@kurisa.ch.

## Security

* Fix a vulnerability in the verification of X.509 certificates when matching the expected common name (the cn argument of mbedtls\_x509\_crt\_verify()) with the actual certificate name: when the subjecAltName extension is present, the expected name was compared to any name in that extension regardless of its type. This means that an attacker could for example impersonate a 4-bytes or 16-byte domain by getting a certificate for the corresponding IPv4 or IPv6 (this would require the attacker to control that IP address, though). Similar attacks using other subjectAltName name types might be possible. Found and reported by kFYatek in [#3498](https://github.com/Mbed-TLS/mbedtls/issues/3498).
* When checking X.509 CRLs, a certificate was only considered as revoked if its revocationDate was in the past according to the local clock if available. In particular, on builds without MBEDTLS\_HAVE\_TIME\_DATE, certificates were never considered as revoked. On builds with MBEDTLS\_HAVE\_TIME\_DATE, an attacker able to control the local clock (for example, an untrusted OS attacking a secure enclave) could prevent revocation of certificates via CRLs. Fixed by no longer checking the revocationDate field, in accordance with RFC 5280. Reported by yuemonangong in [#3340](https://github.com/Mbed-TLS/mbedtls/issues/3340). Reported independently and fixed by Raoul Strackx and Jethro Beekman in [#3433](https://github.com/Mbed-TLS/mbedtls/pull/3433).
* In (D)TLS record decryption, when using a CBC ciphersuites without the Encrypt-then-Mac extension, use constant code flow memory access patterns to extract and check the MAC. This is an improvement to the existing countermeasure against Lucky 13 attacks. The previous countermeasure was effective against network-based attackers, but less so against local attackers. The new countermeasure defends against local attackers, even if they have access to fine-grained measurements. In particular, this fixes a local Lucky 13 cache attack found and reported by Tuba Yavuz, Farhaan Fowze, Ken (Yihan) Bai, Grant Hernandez, and Kevin Butler (University of Florida) and Dave Tian (Purdue University).
* Fix side channel in RSA private key operations and static (finite-field) Diffie-Hellman. An adversary with precise enough timing and memory access information (typically an untrusted operating system attacking a secure enclave) could bypass an existing counter-measure (base blinding) and potentially fully recover the private key.
* Fix a 1-byte buffer overread in mbedtls\_x509\_crl\_parse\_der(). Credit to OSS-Fuzz for detecting the problem and to Philippe Antoine for pinpointing the problematic code.
* Zeroising of plaintext buffers in mbedtls\_ssl\_read() to erase unused application data from memory. Reported in [#689](https://github.com/Mbed-TLS/mbedtls/pull/689) by Johan Uppman Bruce of Sectra.

## Bugfix

* Library files installed after a CMake build no longer have execute permission.
* Use local labels in mbedtls\_padlock\_has\_support() to fix an invalid symbol redefinition if the function is inlined. Reported in [#3451](https://github.com/Mbed-TLS/mbedtls/issues/3451) and fix contributed in [#3452](https://github.com/Mbed-TLS/mbedtls/pull/3452) by okhowang.
* Fix the endianness of Curve25519 keys imported/exported through the PSA APIs. psa\_import\_key and psa\_export\_key will now correctly expect/output Montgomery keys in little-endian as defined by RFC7748. Contributed by Steven Cooreman in [#3425](https://github.com/Mbed-TLS/mbedtls/pull/3425).
* Fix build errors when the only enabled elliptic curves are Montgomery curves. Raised by signpainter in [#941](https://github.com/Mbed-TLS/mbedtls/issues/941) and by Taiki-San in [#1412](https://github.com/Mbed-TLS/mbedtls/issues/1412). This also fixes missing declarations reported by Steven Cooreman in [#1147](https://github.com/Mbed-TLS/mbedtls/issues/1147).
* Fix self-test failure when the only enabled short Weierstrass elliptic curve is secp192k1. Fixes [#2017](https://github.com/Mbed-TLS/mbedtls/issues/2017).
* PSA key import will now correctly import a Curve25519/Curve448 public key instead of erroring out. Contributed by Steven Cooreman in [#3492](https://github.com/Mbed-TLS/mbedtls/pull/3492).
* Use arc4random\_buf on NetBSD instead of rand implementation with cyclical lower bits. Fix contributed in [#3540](https://github.com/Mbed-TLS/mbedtls/pull/3540).
* Fix a memory leak in mbedtls\_md\_setup() when using HMAC under low memory conditions. Reported and fix suggested by Guido Vranken in [#3486](https://github.com/Mbed-TLS/mbedtls/issues/3486).
* Fix bug in redirection of unit test outputs on platforms where stdout is defined as a macro. First reported in [#2311](https://github.com/Mbed-TLS/mbedtls/issues/2311) and fix contributed in [#3528](https://github.com/Mbed-TLS/mbedtls/pull/3528).

## Changes

* Only pass -Wformat-signedness to versions of GCC that support it. Reported in [#3478](https://github.com/Mbed-TLS/mbedtls/issues/3478) and fix contributed in [#3479](https://github.com/Mbed-TLS/mbedtls/pull/3479) by okhowang.
* Reduce the stack consumption of mbedtls\_x509write\_csr\_der() which previously could lead to stack overflow on constrained devices. Contributed by Doru Gucea and Simon Leet in [#3464](https://github.com/Mbed-TLS/mbedtls/pull/3464).
* Undefine the ASSERT macro before defining it locally, in case it is defined in a platform header. Contributed by Abdelatif Guettouche in [#3557](https://github.com/Mbed-TLS/mbedtls/pull/3557).
* Update copyright notices to use Linux Foundation guidance. As a result, the copyright of contributors other than Arm is now acknowledged, and the years of publishing are no longer tracked in the source files. This also eliminates the need for the lines declaring the files to be part of MbedTLS. Fixes [#3457](https://github.com/Mbed-TLS/mbedtls/issues/3457).
* Add the command line parameter key\_pwd to the ssl\_client2 and ssl\_server2 example applications which allows to provide a password for the key file specified through the existing key\_file argument. This allows the use of these applications with password-protected key files. Analogously but for ssl\_server2 only, add the command line parameter key\_pwd2 which allows to set a password for the key file provided through the existing key\_file2 argument.

## Who should update

We recommend all affected users should update to take advantage of the bug fixes contained in this release at an appropriate point in their development lifecycle.

## Checksum

The SHA256 hashes for the archives are:

```
d436ae4892bd80329ca18a3960052fbb42d3f1f46c7519711d6763621ca6cfa0  mbedtls-2.24.0.tar.gz
d7b129288a957b1936ade3921504d5524e34a0dbe9f4d965df3416db9cfe0dae  mbedtls-2.24.0.zip

```

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.gentoo.org_85b39c76_20250119_125950.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mbed TLS: Multiple Vulnerabilities — GLSA **202301-08**

Multiple vulnerabilities have been discovered in Mbed TLS, the worst of which could result in arbitrary code execution.

### Affected packages

| Package | **net-libs/mbedtls** on all architectures |
| --- | --- |
| Affected versions | < **2.28.1** |
| Unaffected versions | >= **2.28.1** |

### Background

Mbed TLS (previously PolarSSL) is an “easy to understand, use, integrate and expand” implementation of the TLS and SSL protocols and the respective cryptographic algorithms and support code required.

### Description

Multiple vulnerabilities have been discovered in Mbed TLS. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mbed TLS users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-libs/mbedtls-2.28.1"

```
### References

* [CVE-2020-16150](https://nvd.nist.gov/vuln/detail/CVE-2020-16150)
* [CVE-2020-36421](https://nvd.nist.gov/vuln/detail/CVE-2020-36421)
* [CVE-2020-36422](https://nvd.nist.gov/vuln/detail/CVE-2020-36422)
* [CVE-2020-36423](https://nvd.nist.gov/vuln/detail/CVE-2020-36423)
* [CVE-2020-36424](https://nvd.nist.gov/vuln/detail/CVE-2020-36424)
* [CVE-2020-36425](https://nvd.nist.gov/vuln/detail/CVE-2020-36425)
* [CVE-2020-36426](https://nvd.nist.gov/vuln/detail/CVE-2020-36426)
* [CVE-2020-36475](https://nvd.nist.gov/vuln/detail/CVE-2020-36475)
* [CVE-2020-36476](https://nvd.nist.gov/vuln/detail/CVE-2020-36476)
* [CVE-2020-36477](https://nvd.nist.gov/vuln/detail/CVE-2020-36477)
* [CVE-2020-36478](https://nvd.nist.gov/vuln/detail/CVE-2020-36478)
* [CVE-2021-43666](https://nvd.nist.gov/vuln/detail/CVE-2021-43666)
* [CVE-2021-44732](https://nvd.nist.gov/vuln/detail/CVE-2021-44732)
* [CVE-2021-45450](https://nvd.nist.gov/vuln/detail/CVE-2021-45450)
* [CVE-2022-35409](https://nvd.nist.gov/vuln/detail/CVE-2022-35409)

**Release date**

January 11, 2023

**Latest revision**

January 11, 2023: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [857813](https://bugs.gentoo.org/show_bug.cgi?id=857813)
* [829660](https://bugs.gentoo.org/show_bug.cgi?id=829660)
* [801376](https://bugs.gentoo.org/show_bug.cgi?id=801376)
* [778254](https://bugs.gentoo.org/show_bug.cgi?id=778254)
* [764317](https://bugs.gentoo.org/show_bug.cgi?id=764317)
* [740108](https://bugs.gentoo.org/show_bug.cgi?id=740108)
* [730752](https://bugs.gentoo.org/show_bug.cgi?id=730752)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from github.com_e24f1591_20250119_125948.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Fissues%2F3498)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Fissues%2F3498)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Mbed-TLS%2Fmbedtls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Mbed-TLS](/Mbed-TLS)
/
**[mbedtls](/Mbed-TLS/mbedtls)**
Public

* [Notifications](/login?return_to=%2FMbed-TLS%2Fmbedtls) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)
* [Star
   5.7k](/login?return_to=%2FMbed-TLS%2Fmbedtls)

* [Code](/Mbed-TLS/mbedtls)
* [Issues
  1.3k](/Mbed-TLS/mbedtls/issues)
* [Pull requests
  265](/Mbed-TLS/mbedtls/pulls)
* [Projects
  0](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

Additional navigation options

* [Code](/Mbed-TLS/mbedtls)
* [Issues](/Mbed-TLS/mbedtls/issues)
* [Pull requests](/Mbed-TLS/mbedtls/pulls)
* [Projects](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

# Erroneous handling of IP address SANs #3498

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosed[#3554](https://github.com/Mbed-TLS/mbedtls/pull/3554)Closed[Erroneous handling of IP address SANs](#top)#3498[#3554](https://github.com/Mbed-TLS/mbedtls/pull/3554)Copy linkAssignees [![mpg](https://avatars.githubusercontent.com/u/60640?s=64&u=247379ad8312663047074f24612a32aeb76cc388&v=4)](/mpg)Labels[bug](https://github.com/Mbed-TLS/mbedtls/issues?q=state%3Aopen%20label%3A%22bug%22)[component-x509](https://github.com/Mbed-TLS/mbedtls/issues?q=state%3Aopen%20label%3A%22component-x509%22)![@kFYatek](https://avatars.githubusercontent.com/u/4499762?v=4&size=80)
## Description

![@kFYatek](https://avatars.githubusercontent.com/u/4499762?v=4&size=48)[kFYatek](https://github.com/kFYatek)opened [on Jul 17, 2020](https://github.com/Mbed-TLS/mbedtls/issues/3498#issue-659105620)
### Description

* Type: Bug
* Priority: Minor

**mbed TLS build:**

Version: checked on 2.16.4 and git-8f4f9a8da, likely occurs on all versions that support SAN

**Actual behavior**

[`x509_crt_verify_name()`](https://github.com/ARMmbed/mbedtls/blob/527b87890db72da39f6185f977b8230655a42ddd/library/x509_crt.c#L3013) treats all kinds of Subject Alternative Names equivalently, even in cases where it does not make sense. In particular, IP address SANs are compared byte-by-byte with whatever the value of `cn` is - and in the typical cases it is a hostname (specifically, in the case of normal `mbedtls_ssl_context` operation, it's the value configured via `mbedtls_ssl_set_hostname()`).

It is possible, for example, for a certificate to exist with an IP address SAN for `97.46.112.108` (a perfectly valid IP owned by Verizon in the US), which would erroneously match a hostname of `a.pl` (an actual Polish retailer's website). While unlikely, this is seems like a possibility for certificate spoofing.

This also means that it is very difficult to handle connecting to a server that actually uses an IP address SAN in its certificate, as there is no way to pass an IP address to mbed TLS when connecting.

**Expected behavior**

I would expect IP address SANs to be either ignored or compared in a more appropriate way (e.g. stringified first, perhaps?)

## Metadata

### Assignees

* [![@mpg](https://avatars.githubusercontent.com/u/60640?s=64&u=247379ad8312663047074f24612a32aeb76cc388&v=4)mpg](/mpg)
### Labels

[bug](https://github.com/Mbed-TLS/mbedtls/issues?q=state%3Aopen%20label%3A%22bug%22)[component-x509](https://github.com/Mbed-TLS/mbedtls/issues?q=state%3Aopen%20label%3A%22component-x509%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


