=== Content from github.com_913696ed_20250119_121051.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Fpull%2F3426)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Fpull%2F3426)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=wolfSSL%2Fwolfssl)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wolfSSL](/wolfSSL)
/
**[wolfssl](/wolfSSL/wolfssl)**
Public

* [Notifications](/login?return_to=%2FwolfSSL%2Fwolfssl) You must be signed in to change notification settings
* [Fork
  837](/login?return_to=%2FwolfSSL%2Fwolfssl)
* [Star
   2.4k](/login?return_to=%2FwolfSSL%2Fwolfssl)

* [Code](/wolfSSL/wolfssl)
* [Issues
  91](/wolfSSL/wolfssl/issues)
* [Pull requests
  55](/wolfSSL/wolfssl/pulls)
* [Actions](/wolfSSL/wolfssl/actions)
* [Projects
  0](/wolfSSL/wolfssl/projects)
* [Wiki](/wolfSSL/wolfssl/wiki)
* [Security](/wolfSSL/wolfssl/security)
* [Insights](/wolfSSL/wolfssl/pulse)

Additional navigation options

* [Code](/wolfSSL/wolfssl)
* [Issues](/wolfSSL/wolfssl/issues)
* [Pull requests](/wolfSSL/wolfssl/pulls)
* [Actions](/wolfSSL/wolfssl/actions)
* [Projects](/wolfSSL/wolfssl/projects)
* [Wiki](/wolfSSL/wolfssl/wiki)
* [Security](/wolfSSL/wolfssl/security)
* [Insights](/wolfSSL/wolfssl/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FwolfSSL%2Fwolfssl%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FwolfSSL%2Fwolfssl%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# RSA-PSS: Handle edge case with encoding message to hash #3426

 Merged

[toddouska](/toddouska)
merged 1 commit into
[wolfSSL:master](/wolfSSL/wolfssl/tree/master "wolfSSL/wolfssl:master")
from
[SparkiDev:rsa\_pss\_fix](/SparkiDev/wolfssl/tree/rsa_pss_fix "SparkiDev/wolfssl:rsa_pss_fix")

Nov 3, 2020

 Merged

# [RSA-PSS: Handle edge case with encoding message to hash](#top) #3426

[toddouska](/toddouska)
merged 1 commit into
[wolfSSL:master](/wolfSSL/wolfssl/tree/master "wolfSSL/wolfssl:master")
from
[SparkiDev:rsa\_pss\_fix](/SparkiDev/wolfssl/tree/rsa_pss_fix "SparkiDev/wolfssl:rsa_pss_fix")

Nov 3, 2020

+25

−13

[Conversation
0](/wolfSSL/wolfssl/pull/3426)
[Commits
1](/wolfSSL/wolfssl/pull/3426/commits)
[Checks
0](/wolfSSL/wolfssl/pull/3426/checks)
[Files changed
1](/wolfSSL/wolfssl/pull/3426/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![SparkiDev](https://avatars.githubusercontent.com/u/17982558?s=60&v=4)](/SparkiDev)

Copy link

Contributor

### @SparkiDev **[SparkiDev](/SparkiDev)** commented [Oct 27, 2020](#issue-730052641)

When the key is small relative to the digest (1024-bit key, 64-byte

hash, 61-byte salt length), the internal message to hash is larger than

the output size.

Allocate a buffer for the message when this happens.

Sorry, something went wrong.

All reactions

[![@SparkiDev](https://avatars.githubusercontent.com/u/17982558?s=40&v=4)](/SparkiDev)

`[RSA-PSS: Handle edge case with encoding message to hash](/wolfSSL/wolfssl/pull/3426/commits/fb2288c46dd4c864b78f00a47a364b96a09a5c0f "RSA-PSS: Handle edge case with encoding message to hash

When the key is small relative to the digest (1024-bit key, 64-byte
hash, 61-byte salt length), the internal message to hash is larger than
the output size.
Allocate a buffer for the message when this happens.")`
 …

`[fb2288c](/wolfSSL/wolfssl/pull/3426/commits/fb2288c46dd4c864b78f00a47a364b96a09a5c0f)`

```
When the key is small relative to the digest (1024-bit key, 64-byte
hash, 61-byte salt length), the internal message to hash is larger than
the output size.
Allocate a buffer for the message when this happens.
```

[![@SparkiDev](https://avatars.githubusercontent.com/u/17982558?s=40&u=8b405a1c1a2410af3c505f9d82da6fac1d5c0841&v=4)](/SparkiDev)
[SparkiDev](/SparkiDev)
assigned [SparkiDev](/SparkiDev) and [toddouska](/toddouska) and unassigned [SparkiDev](/SparkiDev)
[Oct 27, 2020](#event-3923654267)

[![JacobBarthelmeh](https://avatars.githubusercontent.com/u/7565298?s=60&v=4)](/JacobBarthelmeh)

**[JacobBarthelmeh](/JacobBarthelmeh)**
approved these changes
[Oct 30, 2020](#pullrequestreview-520388535)

 [View reviewed changes](/wolfSSL/wolfssl/pull/3426/files/fb2288c46dd4c864b78f00a47a364b96a09a5c0f)

[![toddouska](https://avatars.githubusercontent.com/u/601574?s=60&v=4)](/toddouska)

**[toddouska](/toddouska)**
approved these changes
[Nov 3, 2020](#pullrequestreview-522928040)

 [View reviewed changes](/wolfSSL/wolfssl/pull/3426/files/fb2288c46dd4c864b78f00a47a364b96a09a5c0f)

[![@toddouska](https://avatars.githubusercontent.com/u/601574?s=40&v=4)](/toddouska)
[toddouska](/toddouska)
merged commit [`63bf5dc`](/wolfSSL/wolfssl/commit/63bf5dc56ccbfc12a73b06327361687091a4c6f7)
into
wolfSSL:master

[Nov 3, 2020](https://github.com/wolfSSL/wolfssl/pull/3426#event-3955087347)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Fpull%2F3426)

Reviewers

[![@JacobBarthelmeh](https://avatars.githubusercontent.com/u/7565298?s=40&v=4)](/JacobBarthelmeh) [JacobBarthelmeh](/JacobBarthelmeh)

JacobBarthelmeh approved these changes

[![@toddouska](https://avatars.githubusercontent.com/u/601574?s=40&v=4)](/toddouska) [toddouska](/toddouska)

toddouska approved these changes

Assignees

[![@toddouska](https://avatars.githubusercontent.com/u/601574?s=40&v=4)](/toddouska) [toddouska](/toddouska)

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@SparkiDev](https://avatars.githubusercontent.com/u/17982558?s=52&v=4)](/SparkiDev) [![@toddouska](https://avatars.githubusercontent.com/u/601574?s=52&v=4)](/toddouska) [![@JacobBarthelmeh](https://avatars.githubusercontent.com/u/7565298?s=52&v=4)](/JacobBarthelmeh)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_26c31be7_20250119_121050.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Fcommit%2Ffb2288c46dd4c864b78f00a47a364b96a09a5c0f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Fcommit%2Ffb2288c46dd4c864b78f00a47a364b96a09a5c0f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=wolfSSL%2Fwolfssl)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wolfSSL](/wolfSSL)
/
**[wolfssl](/wolfSSL/wolfssl)**
Public

* [Notifications](/login?return_to=%2FwolfSSL%2Fwolfssl) You must be signed in to change notification settings
* [Fork
  837](/login?return_to=%2FwolfSSL%2Fwolfssl)
* [Star
   2.4k](/login?return_to=%2FwolfSSL%2Fwolfssl)

* [Code](/wolfSSL/wolfssl)
* [Issues
  91](/wolfSSL/wolfssl/issues)
* [Pull requests
  55](/wolfSSL/wolfssl/pulls)
* [Actions](/wolfSSL/wolfssl/actions)
* [Projects
  0](/wolfSSL/wolfssl/projects)
* [Wiki](/wolfSSL/wolfssl/wiki)
* [Security](/wolfSSL/wolfssl/security)
* [Insights](/wolfSSL/wolfssl/pulse)

Additional navigation options

* [Code](/wolfSSL/wolfssl)
* [Issues](/wolfSSL/wolfssl/issues)
* [Pull requests](/wolfSSL/wolfssl/pulls)
* [Actions](/wolfSSL/wolfssl/actions)
* [Projects](/wolfSSL/wolfssl/projects)
* [Wiki](/wolfSSL/wolfssl/wiki)
* [Security](/wolfSSL/wolfssl/security)
* [Insights](/wolfSSL/wolfssl/pulse)

## Commit

[Permalink](/wolfSSL/wolfssl/commit/fb2288c46dd4c864b78f00a47a364b96a09a5c0f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

RSA-PSS: Handle edge case with encoding message to hash

[Browse files](/wolfSSL/wolfssl/tree/fb2288c46dd4c864b78f00a47a364b96a09a5c0f)
Browse the repository at this point in the history

```
When the key is small relative to the digest (1024-bit key, 64-byte
hash, 61-byte salt length), the internal message to hash is larger than
the output size.
Allocate a buffer for the message when this happens.
```

* Loading branch information

[![@SparkiDev](https://avatars.githubusercontent.com/u/17982558?s=40&v=4)](/SparkiDev)

[SparkiDev](/wolfSSL/wolfssl/commits?author=SparkiDev "View all commits by SparkiDev")
committed
Oct 27, 2020

1 parent
[2ebb47e](/wolfSSL/wolfssl/commit/2ebb47ec32a05014e47e0e88ea8da8b42b1cf32a)

commit fb2288c

Showing
**1 changed file**
with
**25 additions**
and
**13 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

38 changes: 25 additions & 13 deletions

38
[wolfcrypt/src/rsa.c](#diff-5c280e32776b3d35a1e4b16183f930beeefe9bdecbc04ce1cbb0a51ac967d26e "wolfcrypt/src/rsa.c")

Show comments

[View file](/wolfSSL/wolfssl/blob/fb2288c46dd4c864b78f00a47a364b96a09a5c0f/wolfcrypt/src/rsa.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1116,12 +1116,13 @@ static int RsaPad\_PSS(const byte\* input, word32 inputLen, byte\* pkcsBlock, |
|  |  | int hLen, i, o, maskLen, hiBits; |
|  |  | byte\* m; |
|  |  | byte\* s; |
|  |  | #if defined(WOLFSSL\_NO\_MALLOC) && !defined(WOLFSSL\_STATIC\_MEMORY) |
|  |  | byte msg[RSA\_MAX\_SIZE/8 + RSA\_PSS\_PAD\_SZ]; |
|  |  | #else |
|  |  | byte\* msg = NULL; |
|  |  | #endif |
|  |  | #if defined(WOLFSSL\_PSS\_LONG\_SALT) || defined(WOLFSSL\_PSS\_SALT\_LEN\_DISCOVER) |
|  |  | #if defined(WOLFSSL\_NO\_MALLOC) && !defined(WOLFSSL\_STATIC\_MEMORY) |
|  |  | byte salt[RSA\_MAX\_SIZE/8 + RSA\_PSS\_PAD\_SZ]; |
|  |  | #else |
|  |  | byte\* salt = NULL; |
|  |  | #endif |
|  |  | byte\* salt; |
|  |  | #else |
|  |  | byte salt[WC\_MAX\_DIGEST\_SIZE]; |
|  |  | #endif |
| Expand Down  Expand Up | | @@ -1184,13 +1185,13 @@ static int RsaPad\_PSS(const byte\* input, word32 inputLen, byte\* pkcsBlock, |
|  |  |  |
|  |  | #if defined(WOLFSSL\_PSS\_LONG\_SALT) || defined(WOLFSSL\_PSS\_SALT\_LEN\_DISCOVER) |
|  |  | #if !defined(WOLFSSL\_NO\_MALLOC) || defined(WOLFSSL\_STATIC\_MEMORY) |
|  |  | salt = (byte\*)XMALLOC(RSA\_PSS\_PAD\_SZ + inputLen + saltLen, heap, |
|  |  | msg = (byte\*)XMALLOC(RSA\_PSS\_PAD\_SZ + inputLen + saltLen, heap, |
|  |  | DYNAMIC\_TYPE\_RSA\_BUFFER); |
|  |  | if (salt == NULL) { |
|  |  | if (msg == NULL) { |
|  |  | return MEMORY\_E; |
|  |  | } |
|  |  | #endif |
|  |  | s = m = salt; |
|  |  | salt = s = m = msg; |
|  |  | XMEMSET(m, 0, RSA\_PSS\_PAD\_SZ); |
|  |  | m += RSA\_PSS\_PAD\_SZ; |
|  |  | XMEMCPY(m, input, inputLen); |
| Expand All | | @@ -1203,7 +1204,20 @@ static int RsaPad\_PSS(const byte\* input, word32 inputLen, byte\* pkcsBlock, |
|  |  | } |
|  |  | } |
|  |  | #else |
|  |  | s = m = pkcsBlock; |
|  |  | if (pkcsBlockLen < RSA\_PSS\_PAD\_SZ + inputLen + saltLen) { |
|  |  | #if !defined(WOLFSSL\_NO\_MALLOC) || defined(WOLFSSL\_STATIC\_MEMORY) |
|  |  | msg = (byte\*)XMALLOC(RSA\_PSS\_PAD\_SZ + inputLen + saltLen, heap, |
|  |  | DYNAMIC\_TYPE\_RSA\_BUFFER); |
|  |  | if (msg == NULL) { |
|  |  | return MEMORY\_E; |
|  |  | } |
|  |  | #endif |
|  |  | m = msg; |
|  |  | } |
|  |  | else { |
|  |  | m = pkcsBlock; |
|  |  | } |
|  |  | s = m; |
|  |  | XMEMSET(m, 0, RSA\_PSS\_PAD\_SZ); |
|  |  | m += RSA\_PSS\_PAD\_SZ; |
|  |  | XMEMCPY(m, input, inputLen); |
| Expand Down  Expand Up | | @@ -1240,13 +1254,11 @@ static int RsaPad\_PSS(const byte\* input, word32 inputLen, byte\* pkcsBlock, |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | #if defined(WOLFSSL\_PSS\_LONG\_SALT) || defined(WOLFSSL\_PSS\_SALT\_LEN\_DISCOVER) |
|  |  | #if !defined(WOLFSSL\_NO\_MALLOC) || defined(WOLFSSL\_STATIC\_MEMORY) |
|  |  | if (salt != NULL) { |
|  |  | XFREE(salt, heap, DYNAMIC\_TYPE\_RSA\_BUFFER); |
|  |  | if (msg != NULL) { |
|  |  | XFREE(msg, heap, DYNAMIC\_TYPE\_RSA\_BUFFER); |
|  |  | } |
|  |  | #endif |
|  |  | #endif |
|  |  | return ret; |
|  |  | } |
|  |  | #endif /\* WC\_RSA\_PSS \*/ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `fb2288c`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Fcommit%2Ffb2288c46dd4c864b78f00a47a364b96a09a5c0f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.chromium.org_09c1d536_20250119_121048.html ===



=== Content from github.com_d59b94cb_20250119_121049.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Fcommit%2F63bf5dc56ccbfc12a73b06327361687091a4c6f7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Fcommit%2F63bf5dc56ccbfc12a73b06327361687091a4c6f7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=wolfSSL%2Fwolfssl)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wolfSSL](/wolfSSL)
/
**[wolfssl](/wolfSSL/wolfssl)**
Public

* [Notifications](/login?return_to=%2FwolfSSL%2Fwolfssl) You must be signed in to change notification settings
* [Fork
  837](/login?return_to=%2FwolfSSL%2Fwolfssl)
* [Star
   2.4k](/login?return_to=%2FwolfSSL%2Fwolfssl)

* [Code](/wolfSSL/wolfssl)
* [Issues
  91](/wolfSSL/wolfssl/issues)
* [Pull requests
  55](/wolfSSL/wolfssl/pulls)
* [Actions](/wolfSSL/wolfssl/actions)
* [Projects
  0](/wolfSSL/wolfssl/projects)
* [Wiki](/wolfSSL/wolfssl/wiki)
* [Security](/wolfSSL/wolfssl/security)
* [Insights](/wolfSSL/wolfssl/pulse)

Additional navigation options

* [Code](/wolfSSL/wolfssl)
* [Issues](/wolfSSL/wolfssl/issues)
* [Pull requests](/wolfSSL/wolfssl/pulls)
* [Actions](/wolfSSL/wolfssl/actions)
* [Projects](/wolfSSL/wolfssl/projects)
* [Wiki](/wolfSSL/wolfssl/wiki)
* [Security](/wolfSSL/wolfssl/security)
* [Insights](/wolfSSL/wolfssl/pulse)

## Commit

[Permalink](/wolfSSL/wolfssl/commit/63bf5dc56ccbfc12a73b06327361687091a4c6f7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#3426](https://github.com/wolfSSL/wolfssl/pull/3426) from SparkiDev/rsa\_pss\_fix

[Browse files](/wolfSSL/wolfssl/tree/63bf5dc56ccbfc12a73b06327361687091a4c6f7)
Browse the repository at this point in the history

```
RSA-PSS: Handle edge case with encoding message to hash
```

* Loading branch information

[![@toddouska](https://avatars.githubusercontent.com/u/601574?s=40&v=4)](/toddouska)

[toddouska](/wolfSSL/wolfssl/commits?author=toddouska "View all commits by toddouska")
authored
Nov 3, 2020

2 parents
[3cce86d](/wolfSSL/wolfssl/commit/3cce86d7a85cd6bd0276fff7b161f1f4ede41142)
+
[fb2288c](/wolfSSL/wolfssl/commit/fb2288c46dd4c864b78f00a47a364b96a09a5c0f)

commit 63bf5dc

Showing
**1 changed file**
with
**25 additions**
and
**13 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

38 changes: 25 additions & 13 deletions

38
[wolfcrypt/src/rsa.c](#diff-5c280e32776b3d35a1e4b16183f930beeefe9bdecbc04ce1cbb0a51ac967d26e "wolfcrypt/src/rsa.c")

Show comments

[View file](/wolfSSL/wolfssl/blob/63bf5dc56ccbfc12a73b06327361687091a4c6f7/wolfcrypt/src/rsa.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1116,12 +1116,13 @@ static int RsaPad\_PSS(const byte\* input, word32 inputLen, byte\* pkcsBlock, |
|  |  | int hLen, i, o, maskLen, hiBits; |
|  |  | byte\* m; |
|  |  | byte\* s; |
|  |  | #if defined(WOLFSSL\_NO\_MALLOC) && !defined(WOLFSSL\_STATIC\_MEMORY) |
|  |  | byte msg[RSA\_MAX\_SIZE/8 + RSA\_PSS\_PAD\_SZ]; |
|  |  | #else |
|  |  | byte\* msg = NULL; |
|  |  | #endif |
|  |  | #if defined(WOLFSSL\_PSS\_LONG\_SALT) || defined(WOLFSSL\_PSS\_SALT\_LEN\_DISCOVER) |
|  |  | #if defined(WOLFSSL\_NO\_MALLOC) && !defined(WOLFSSL\_STATIC\_MEMORY) |
|  |  | byte salt[RSA\_MAX\_SIZE/8 + RSA\_PSS\_PAD\_SZ]; |
|  |  | #else |
|  |  | byte\* salt = NULL; |
|  |  | #endif |
|  |  | byte\* salt; |
|  |  | #else |
|  |  | byte salt[WC\_MAX\_DIGEST\_SIZE]; |
|  |  | #endif |
| Expand Down  Expand Up | | @@ -1184,13 +1185,13 @@ static int RsaPad\_PSS(const byte\* input, word32 inputLen, byte\* pkcsBlock, |
|  |  |  |
|  |  | #if defined(WOLFSSL\_PSS\_LONG\_SALT) || defined(WOLFSSL\_PSS\_SALT\_LEN\_DISCOVER) |
|  |  | #if !defined(WOLFSSL\_NO\_MALLOC) || defined(WOLFSSL\_STATIC\_MEMORY) |
|  |  | salt = (byte\*)XMALLOC(RSA\_PSS\_PAD\_SZ + inputLen + saltLen, heap, |
|  |  | msg = (byte\*)XMALLOC(RSA\_PSS\_PAD\_SZ + inputLen + saltLen, heap, |
|  |  | DYNAMIC\_TYPE\_RSA\_BUFFER); |
|  |  | if (salt == NULL) { |
|  |  | if (msg == NULL) { |
|  |  | return MEMORY\_E; |
|  |  | } |
|  |  | #endif |
|  |  | s = m = salt; |
|  |  | salt = s = m = msg; |
|  |  | XMEMSET(m, 0, RSA\_PSS\_PAD\_SZ); |
|  |  | m += RSA\_PSS\_PAD\_SZ; |
|  |  | XMEMCPY(m, input, inputLen); |
| Expand All | | @@ -1203,7 +1204,20 @@ static int RsaPad\_PSS(const byte\* input, word32 inputLen, byte\* pkcsBlock, |
|  |  | } |
|  |  | } |
|  |  | #else |
|  |  | s = m = pkcsBlock; |
|  |  | if (pkcsBlockLen < RSA\_PSS\_PAD\_SZ + inputLen + saltLen) { |
|  |  | #if !defined(WOLFSSL\_NO\_MALLOC) || defined(WOLFSSL\_STATIC\_MEMORY) |
|  |  | msg = (byte\*)XMALLOC(RSA\_PSS\_PAD\_SZ + inputLen + saltLen, heap, |
|  |  | DYNAMIC\_TYPE\_RSA\_BUFFER); |
|  |  | if (msg == NULL) { |
|  |  | return MEMORY\_E; |
|  |  | } |
|  |  | #endif |
|  |  | m = msg; |
|  |  | } |
|  |  | else { |
|  |  | m = pkcsBlock; |
|  |  | } |
|  |  | s = m; |
|  |  | XMEMSET(m, 0, RSA\_PSS\_PAD\_SZ); |
|  |  | m += RSA\_PSS\_PAD\_SZ; |
|  |  | XMEMCPY(m, input, inputLen); |
| Expand Down  Expand Up | | @@ -1240,13 +1254,11 @@ static int RsaPad\_PSS(const byte\* input, word32 inputLen, byte\* pkcsBlock, |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | #if defined(WOLFSSL\_PSS\_LONG\_SALT) || defined(WOLFSSL\_PSS\_SALT\_LEN\_DISCOVER) |
|  |  | #if !defined(WOLFSSL\_NO\_MALLOC) || defined(WOLFSSL\_STATIC\_MEMORY) |
|  |  | if (salt != NULL) { |
|  |  | XFREE(salt, heap, DYNAMIC\_TYPE\_RSA\_BUFFER); |
|  |  | if (msg != NULL) { |
|  |  | XFREE(msg, heap, DYNAMIC\_TYPE\_RSA\_BUFFER); |
|  |  | } |
|  |  | #endif |
|  |  | #endif |
|  |  | return ret; |
|  |  | } |
|  |  | #endif /\* WC\_RSA\_PSS \*/ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `63bf5dc`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Fcommit%2F63bf5dc56ccbfc12a73b06327361687091a4c6f7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_cdf27640_20250119_121052.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Freleases%2Ftag%2Fv4.6.0-stable)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FwolfSSL%2Fwolfssl%2Freleases%2Ftag%2Fv4.6.0-stable)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=wolfSSL%2Fwolfssl)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wolfSSL](/wolfSSL)
/
**[wolfssl](/wolfSSL/wolfssl)**
Public

* [Notifications](/login?return_to=%2FwolfSSL%2Fwolfssl) You must be signed in to change notification settings
* [Fork
  837](/login?return_to=%2FwolfSSL%2Fwolfssl)
* [Star
   2.4k](/login?return_to=%2FwolfSSL%2Fwolfssl)

* [Code](/wolfSSL/wolfssl/tree/v4.6.0-stable)
* [Issues
  91](/wolfSSL/wolfssl/issues)
* [Pull requests
  55](/wolfSSL/wolfssl/pulls)
* [Actions](/wolfSSL/wolfssl/actions)
* [Projects
  0](/wolfSSL/wolfssl/projects)
* [Wiki](/wolfSSL/wolfssl/wiki)
* [Security](/wolfSSL/wolfssl/security)
* [Insights](/wolfSSL/wolfssl/pulse)

Additional navigation options

* [Code](/wolfSSL/wolfssl/tree/v4.6.0-stable)
* [Issues](/wolfSSL/wolfssl/issues)
* [Pull requests](/wolfSSL/wolfssl/pulls)
* [Actions](/wolfSSL/wolfssl/actions)
* [Projects](/wolfSSL/wolfssl/projects)
* [Wiki](/wolfSSL/wolfssl/wiki)
* [Security](/wolfSSL/wolfssl/security)
* [Insights](/wolfSSL/wolfssl/pulse)

1. [Releases](/wolfSSL/wolfssl/releases)
2. [v4.6.0-stable](/wolfSSL/wolfssl/releases/tag/v4.6.0-stable)

# wolfSSL release version 4.6.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/wolfSSL/wolfssl/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v4.6.0-stable)

 Loading

[View all tags](/wolfSSL/wolfssl/tags)

![@JacobBarthelmeh](https://avatars.githubusercontent.com/u/7565298?s=40&v=4)
[JacobBarthelmeh](/JacobBarthelmeh)
released this
23 Dec 14:43

·
[11184 commits](/wolfSSL/wolfssl/compare/v4.6.0-stable...master)
to master
since this release

[v4.6.0-stable](/wolfSSL/wolfssl/tree/v4.6.0-stable)

[`9c87f97`](/wolfSSL/wolfssl/commit/9c87f979a7f1d3a6d786b260653d566c1d31a1c4)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

# wolfSSL Release 4.6.0 (December 22, 2020)

Release 4.6.0 of wolfSSL embedded TLS has bug fixes and new features including:

### New Feature Additions

###### New Build Options

* wolfSSL now enables linux kernel module support. Big news for Linux kernel module developers with crypto requirements! wolfCrypt and wolfSSL are now loadable as modules in the Linux kernel, providing the entire libwolfssl API natively to other kernel modules. For the first time on Linux, the entire TLS protocol stack can be loaded as a module, allowing fully kernel-resident TLS/DTLS endpoints with in-kernel handshaking. (--enable-linuxkm, --enable-linuxkm-defaults, --with-linux-source) (<https://www.wolfssl.com/loading-wolfssl-into-the-linux-kernel/>)
* Build tests and updated instructions for use with Apple’s A12Z chipset (<https://www.wolfssl.com/preliminary-cryptographic-benchmarks-on-new-apple-a12z-bionic-platform/>)
* Expansion of wolfSSL SP math implementation and addition of --enable-sp-math-all build option
* Apache httpd w/TLS 1.3 support added
* Sniffer support for TLS 1.3 and AES CCM
* Support small memory footprint build with only TLS 1.3 and PSK without code for (EC)DHE and certificates

###### New Hardware Acceleration

* Added support for NXP DCP (i.MX RT1060/1062) crypto co-processor
* Add Silicon Labs hardware acceleration using [SL SE Manager](https://docs.silabs.com/gecko-platform/latest/service/api/group-sl-se-manager)

###### New Algorithms

* RC2 ECB/CBC added for use with PKCS#12 bundles
* XChaCha and the XChaCha20-Poly1305 AEAD algorithm support added

###### Misc

* Added support for 802.11Q VLAN frames to sniffer
* Added OCSP function wolfSSL\_get\_ocsp\_producedDate
* Added API to set CPU ID flags cpuid\_select\_flags, cpuid\_set\_flag, cpuid\_clear\_flag
* New DTLS/TLS non-blocking Secure Renegotiation example added to server.c and client.c

### Fixes

###### Math Library

* Fix mp\_to\_unsigned\_bin\_len out of bounds read with buffers longer than maximum MP
* Fix for fp\_read\_radix\_16 out of bounds read
* Fix to add wrapper for new timing resistant wc\_ecc\_mulmod\_ex2 function version in HW ECC acceleration
* Handle an edge case with RSA-PSS encoding message to hash

###### Compatibility Layer Fixes

* Fix for setting serial number wolfSSL\_X509\_set\_serialNumber
* Fix for setting ASN1 time not before / not after with WOLFSSL\_X509
* Fix for order of components in issuer name when using X509\_sign
* Fix for compatibility layer API DH\_compute\_key
* EVP fix incorrect block size for GCM and buffer up AAD for encryption/decryption
* EVP fix for AES-XTS key length return value and fix for string compare calls
* Fix for mutex freeing during RNG failure case with EVP\_KEY creation
* Non blocking use with compatibility layer BIOs in TLS connections

###### Build Configuration

* Fix for custom build with WOLFSSL\_USER\_MALLOC defined
* ED448 compiler warning on Intel 32bit systems
* CURVE448\_SMALL build fix for 32bit systems with Curve448
* Fix to build SP math with IAR
* CMake fix to only set ranlib arguments for Mac, and for stray typo of , -> ;
* Build with --enable-wpas=small fix
* Fix for building fips ready using openssl extra
* Fixes for building with Microchip (min/max and undef SHA\_BLOCK\_SIZE)
* FIx for NO\_FILESYSTEM build on Windows
* Fixed SHA256 support for IMX-RT1060
* Fix for ECC key gen with NO\_TFM\_64BIT

###### Sniffer

* Fixes for sniffer when using static ECC keys. Adds back TLS v1.2 static ECC key fallback detection and fixes new ECC RNG requirement for timing resistance
* Fix for sniffer with SNI enabled to properly handle WOLFSSL\_SUCCESS error code in ProcessClientHello
* Fix for sniffer using HAVE\_MAX\_FRAGMENT in "certificate" type message
* Fix build error with unused "ret" when building with WOLFSSL\_SNIFFER\_WATCH.
* Fix to not treat cert/key not found as error in myWatchCb and WOLFSSL\_SNIFFER\_WATCH.
* Sniffer fixes for handling TCP `out-of-range sequence number`
* Fixes SSLv3 use of ECDH in sniffer

###### PKCS

* PKCS#11 fix to generate ECC key for decrypt/sign or derive
* Fix for resetting internal variables when parsing a malformed PKCS#7 bundle with PKCS7\_VerifySignedData()
* Verify the extracted public key in wc\_PKCS7\_InitWithCert
* Fix for internal buffer size when using decompression with PKCS#7

###### Misc

* Pin the C# verify callback function to keep from garbage collection
* DH fixes for when public key is owned and free’d after a handshake
* Fix for TLS 1.3 early data packets
* Fix for STM32 issue with some Cube HAL versions and STM32 example timeout
* Fix mmCAU and LTC hardware mutex locking to prevent double lock
* Fix potential race condition with CRL monitor
* Fix for possible malformed encrypted key with 3DES causing negative length
* AES-CTR performance fixed with AES-NI

### Improvements/Optimizations

##### SP and Math

* mp\_radix\_size adjustment for leading 0
* Resolve implicit cast warnings with SP build
* Change mp\_sqr to return an error if the result won't fit into the fixed length dp
* ARM64 assembly with clang improvements, clang doesn't always handle use of x29 (FP or Frame Pointer) in inline assembly code correctly - reworked sp\_2048\_sqr\_8 to not use x29
* SP mod exp changed to support exponents of different lengths
* TFM div: fix initial value of size in q so clamping doesn't OOB read
* Numerous stack depth improvements with --enable-smallstack
* Improve cache resistance with Base64 operations

###### TLS 1.3

* TLS 1.3 wolfSSL\_peek want read return addition
* TLS 1.3: Fix P-521 algorithm matching

###### PKCS

* Improvements and refactoring to PKCS#11 key look up
* PKCS [#11](https://github.com/wolfSSL/wolfssl/pull/11) changes for signing and loading RSA public key from private
* check PKCS#7 SignedData private key is valid before using it
* check PKCS#7 VerifySignedData content length against total bundle size to avoid large malloc

###### Compatibility Layer

* EVP add block size for more ciphers in wolfSSL\_EVP\_CIPHER\_block\_size()
* Return long names instead of short names in wolfSSL\_OBJ\_obj2txt()
* Add additional OpenSSL compatibility functions to update the version of Apache httpd supported
* add "CCM8" variants to cipher\_names "CCM-8" ciphers, for OpenSSL compat

###### Builds

* Cortex-M SP ASM support for IAR 6.70
* STM Cube pack support (IDE/STM32Cube)
* Build option --enable-aesgcm=4bit added for AES-GCM GMULT using 4 bit table
* Xilinx IDE updates to allow XTIME override for Xilinx, spelling fixes in Xilinx README.md, and add Xilinx SDK printf support
* Added ED448 to the "all" options and ED448 check key null argument sanity check
* Added ARC4, 3DES, nullcipher, BLAKE2, BLAKE2s, XChaCha, MD2, and MD4 to the “all” options
* Added an --enable-all-crypto option, to enable only the wolfCrypt features of --enable-all, combinable with --enable-cryptonly
* Added the ability to selectively remove features from --enable-all and --enable-all-crypto using specific --disable- options
* Use Intel intrinsics with Windows for RDSEED and RDRAND (thanks to dr-m from MariaDB)
* Add option to build with WOLFSSL\_NO\_CLIENT\_AUTH
* Updated build requirements for wolfSSH use to be less restrictive
* lighttpd support update for v1.4.56
* Added batch file to copy files to ESP-IDF folders and resolved warnings when using v4.0 ESP-IDF
* Added --enable-stacksize=verbose, showing at a glance the stack high water mark for each subtest in testwolfcrypt

###### ECC

* Performance increase for ECC verify only, using non constant time SP modinv
* During ECC verify add validation of r and s before any use
* Always use safe add and dbl with ECC
* Timing resistant scalar multiplication updated with use of Joye double-add ladder
* Update mp\_jacobi function to reduce stack and increase performance for base ECC build
* Reduce heap memory use with wc\_EccPrivateKeyDecode, Improvement to ECC wc\_ecc\_sig\_to\_rs and wc\_ecc\_rs\_raw\_to\_sig to reduce memory use (avoid the mp\_int)
* Improve StoreECC\_DSA\_Sig bounds checking

###### OCSP

* OCSP improvement to handle extensions in singleResponse
* support for OCSP request/response for multiple certificates
* OCSP Must Staple option added to require OCSP stapling response
* Add support for id-pkix-ocsp-nocheck extension

###### Misc

* Additional code coverage added for ECC and RSA, PKCS#7, 3DES, EVP and Blake2b operations
* DTLS MTU: check MTU on write
* Refactor hash sig selection and add the macros WOLFSSL\_STRONGEST\_HASH\_SIG (picks the strongest hash) and WOLFSSL\_ECDSA\_MATCH\_HASH (will pick the hash to match the ECC curve)
* Strict certificate version allowed from client, TLS 1.2 / 1.3 can not accept client certificates lower than version 3
* wolfSSL\_get\_ciphers\_compat(), skip the fake indicator ciphers like the renegotiation indication and the quantum-safe hybrid
* When parsing session ticket, check TLS version to see whether they are version compatible
* Additional sanity check for invalid ASN1 padding on integer type
* Adding in ChaCha20 streaming feature with Mac and Intel assembly build
* Sniffer build with --enable-oldtls option on

 Assets
5

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


