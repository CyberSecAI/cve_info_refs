=== Content from www.wordfence.com_160aac90_20250119_122521.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Ultimate Reviews < 2.1.33 - PHP Object Injection

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Ultimate Reviews < 2.1.33 - PHP Object Injection

9.8

**Deserialization of Untrusted Data**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2020-36726](https://www.cve.org/CVERecord?id=CVE-2020-36726) |
| --- | --- |
| CVSS | 9.8 (Critical) |
| Publicly Published | November 10, 2020 |
| Last Updated | January 22, 2024 |
| Researcher | [Jerome Bruandet - NinTechNet](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/jerome-bruandet-1) |

### Description

The Ultimate Reviews plugin for WordPress is vulnerable to PHP Object Injection in versions up to, and including, 2.1.32 via deserialization of untrusted input in several vulnerable functions. This allows unauthenticated attackers to inject a PHP Object. No POP chain is present in the vulnerable plugin.

#### References

* [blog.nintechnet.com](https://blog.nintechnet.com/wordpress-ultimate-reviews-plugin-fixed-insecure-deserialization-vulnerability/)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/2409141)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fultimate-reviews%2Fultimate-reviews-2133-php-object-injection&t=Ultimate%20Reviews%20%3C%202.1.33%20-%20PHP%20Object%20Injection "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fultimate-reviews%2Fultimate-reviews-2133-php-object-injection&text=Ultimate%20Reviews%20%3C%202.1.33%20-%20PHP%20Object%20Injection "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fultimate-reviews%2Fultimate-reviews-2133-php-object-injection "LinkedIn")
Email

## Vulnerability Details for Ultimate Reviews

#### [Ultimate Reviews](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/ultimate-reviews)

| Software Type | Plugin |
| --- | --- |
| Software Slug | ultimate-reviews [(view on wordpress.org)](https://wordpress.org/plugins/ultimate-reviews) |
| Patched? | Yes |
| Remediation | Update to version 2.1.33, or a newer patched version |
| Affected Version | * < 2.1.33 |
| Patched Version | * 2.1.33 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_22aec200_20250119_122519.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F2409141)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/2409140 "Changeset 2409140")
* [Next Changeset](/changeset/2409142 "Changeset 2409142") →

---

# Changeset 2409141

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
10/29/2020 02:50:27 PM
([4 years](/timeline?from=2020-10-29T14%3A50%3A27Z&precision=second "See timeline at 10/29/2020 02:50:27 PM") ago)

Author:
Rustaurius
Message:

v2.1.33 and tagging

Location:
[ultimate-reviews](/browser/ultimate-reviews?rev=2409141)
Files:

14 edited
1 copied

* [tags/2.1.33](/browser/ultimate-reviews/tags/2.1.33?rev=2409141 "Show entry in browser")
  (copied)
  *(copied from [ultimate-reviews/trunk](/browser/ultimate-reviews/trunk?rev=2379758 "Show original file (revision 2409139)"))*
* [tags/2.1.33/Functions/EWD\_URP\_Submit\_Review.php](/browser/ultimate-reviews/tags/2.1.33/Functions/EWD_URP_Submit_Review.php?rev=2409141 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [tags/2.1.33/Functions/Process\_Ajax.php](/browser/ultimate-reviews/tags/2.1.33/Functions/Process_Ajax.php?rev=2409141 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [tags/2.1.33/Main.php](/browser/ultimate-reviews/tags/2.1.33/Main.php?rev=2409141 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [tags/2.1.33/Shortcodes/SelectReview.php](/browser/ultimate-reviews/tags/2.1.33/Shortcodes/SelectReview.php?rev=2409141 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [tags/2.1.33/css/ewd-urp-styles.css](/browser/ultimate-reviews/tags/2.1.33/css/ewd-urp-styles.css?rev=2409141 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))
* [tags/2.1.33/js/ewd-urp-dashboard-review-ask.js](/browser/ultimate-reviews/tags/2.1.33/js/ewd-urp-dashboard-review-ask.js?rev=2409141 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [tags/2.1.33/readme.txt](/browser/ultimate-reviews/tags/2.1.33/readme.txt?rev=2409141 "Show entry in browser")
  (modified)
  ([1 diff](#file7 "Show differences"))
* [trunk/Functions/EWD\_URP\_Submit\_Review.php](/browser/ultimate-reviews/trunk/Functions/EWD_URP_Submit_Review.php?rev=2409141 "Show entry in browser")
  (modified)
  ([2 diffs](#file8 "Show differences"))
* [trunk/Functions/Process\_Ajax.php](/browser/ultimate-reviews/trunk/Functions/Process_Ajax.php?rev=2409141 "Show entry in browser")
  (modified)
  ([1 diff](#file9 "Show differences"))
* [trunk/Main.php](/browser/ultimate-reviews/trunk/Main.php?rev=2409141 "Show entry in browser")
  (modified)
  ([1 diff](#file10 "Show differences"))
* [trunk/Shortcodes/SelectReview.php](/browser/ultimate-reviews/trunk/Shortcodes/SelectReview.php?rev=2409141 "Show entry in browser")
  (modified)
  ([1 diff](#file11 "Show differences"))
* [trunk/css/ewd-urp-styles.css](/browser/ultimate-reviews/trunk/css/ewd-urp-styles.css?rev=2409141 "Show entry in browser")
  (modified)
  ([1 diff](#file12 "Show differences"))
* [trunk/js/ewd-urp-dashboard-review-ask.js](/browser/ultimate-reviews/trunk/js/ewd-urp-dashboard-review-ask.js?rev=2409141 "Show entry in browser")
  (modified)
  ([1 diff](#file13 "Show differences"))
* [trunk/readme.txt](/browser/ultimate-reviews/trunk/readme.txt?rev=2409141 "Show entry in browser")
  (modified)
  ([1 diff](#file14 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [ultimate-reviews/tags/2.1.33/Functions/EWD\_URP\_Submit\_Review.php](/changeset/2409141/ultimate-reviews/tags/2.1.33/Functions/EWD_URP_Submit_Review.php "Show the changeset 2409141 restricted to ultimate-reviews/tags/2.1.33/Functions/EWD_URP_Submit_Review.php")

  | [r2336954](/browser/ultimate-reviews/trunk/Functions/EWD_URP_Submit_Review.php?rev=2336954#L90 "Show revision 2336954 of this file in browser") | [r2409141](/browser/ultimate-reviews/tags/2.1.33/Functions/EWD_URP_Submit_Review.php?rev=2409141#L90 "Show revision 2409141 of this file in browser") |  |
  | --- | --- | --- |
  | 90 | 90 |  |
  | 91 | 91 | if ($One\_Review\_Per\_Product\_Person == "Yes") { |
  | 92 |  | $Reviewed\_Products = (isset($\_COOKIE['EWD\_URP\_Reviewed\_Products']) ? unserialize(stripslashes($\_COOKIE['EWD\_URP\_Reviewed\_Products'])) : array()); |
  |  | 92 |  |
  |  | 93 | $Reviewed\_Products = isset($\_COOKIE['EWD\_URP\_Reviewed\_Products']) ? json\_decode($\_COOKIE['EWD\_URP\_Reviewed\_Products']) : array(); |
  |  | 94 | $Reviewed\_Products = is\_array( $Reviewed\_Products ) ? array\_map( 'sanitize\_text\_field', $Reviewed\_Products ) : array(); |
  | 93 | 95 |  |
  | 94 |  | if (~~in\_array($Product\_Name, $Reviewed\_Products)~~) { |
  |  | 96 | if ( in\_array($Product\_Name, $Reviewed\_Products) ) { |
  | 95 | 97 | $user\_message = \_\_("You have already submitted a review for a product with that product name. Please select a different product to review.", 'ultimate-reviews'); |
  | 96 | 98 | return $user\_message; |
  | […](/browser/ultimate-reviews/trunk/Functions/EWD_URP_Submit_Review.php?rev=2336954#L99) | […](/browser/ultimate-reviews/tags/2.1.33/Functions/EWD_URP_Submit_Review.php?rev=2409141#L101) |  |
  | 99 | 101 | $Reviewed\_Products[] = $Product\_Name; |
  | 100 | 102 |  |
  | 101 |  | setcookie('EWD\_URP\_Reviewed\_Products', ~~serializ~~e($Reviewed\_Products), time() + 365\*24\*3600, '/'); |
  |  | 103 | setcookie('EWD\_URP\_Reviewed\_Products', json\_encode($Reviewed\_Products), time() + 365\*24\*3600, '/'); |
  | 102 | 104 | } |
  | 103 | 105 |  |
* ## [ultimate-reviews/tags/2.1.33/Functions/Process\_Ajax.php](/changeset/2409141/ultimate-reviews/tags/2.1.33/Functions/Process_Ajax.php "Show the changeset 2409141 restricted to ultimate-reviews/tags/2.1.33/Functions/Process_Ajax.php")

  | [r2336954](/browser/ultimate-reviews/trunk/Functions/Process_Ajax.php?rev=2336954#L69 "Show revision 2336954 of this file in browser") | [r2409141](/browser/ultimate-reviews/tags/2.1.33/Functions/Process_Ajax.php?rev=2409141#L69 "Show revision 2409141 of this file in browser") |  |
  | --- | --- | --- |
  | 69 | 69 | else {update\_post\_meta( $Review\_ID, 'EWD\_URP\_Review\_Karma', $Karma + 1 );} |
  | 70 | 70 |  |
  | 71 |  | $EWD\_URP\_Karma\_IDs = unserialize(stripslashes($\_COOKIE['EWD\_URP\_Karma\_IDs'])); |
  |  | 71 | $EWD\_URP\_Karma\_IDs = isset( $\_COOKIE['EWD\_URP\_Karma\_IDs'] ) ? json\_decode( $\_COOKIE['EWD\_URP\_Karma\_IDs'] ) : array(); |
  |  | 72 | $EWD\_URP\_Karma\_IDs = is\_array( $EWD\_URP\_Karma\_IDs ) ? array\_map( 'intval', $EWD\_URP\_Karma\_IDs ) : array(); |
  | 72 | 73 | $EWD\_URP\_Karma\_IDs[] = $Review\_ID; |
  | 73 | 74 |  |
  | 74 |  | setcookie('EWD\_URP\_Karma\_IDs', ~~serialize($EWD\_URP\_Karma\_IDs~~), time()+3600\*24\*365, '/'); |
  |  | 75 | setcookie('EWD\_URP\_Karma\_IDs', json\_encode( $EWD\_URP\_Karma\_IDs ), time()+3600\*24\*365, '/'); |
  | 75 | 76 | } |
  | 76 | 77 | add\_action('wp\_ajax\_urp\_update\_karma', 'EWD\_URP\_Update\_Karama'); |
* ## [ultimate-reviews/tags/2.1.33/Main.php](/changeset/2409141/ultimate-reviews/tags/2.1.33/Main.php "Show the changeset 2409141 restricted to ultimate-reviews/tags/2.1.33/Main.php")

  | [r2379758](/browser/ultimate-reviews/trunk/Main.php?rev=2379758#L8 "Show revision 2379758 of this file in browser") | [r2409141](/browser/ultimate-reviews/tags/2.1.33/Main.php?rev=2409141#L8 "Show revision 2409141 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | Terms and Conditions: http://www.etoilewebdesign.com/plugin-terms-and-conditions/ |
  | 9 | 9 | Text Domain: ultimate-reviews |
  | 10 |  | Version: 2.1.3~~2~~ |
  |  | 10 | Version: 2.1.33 |
  | 11 | 11 | \*/ |
  | 12 | 12 |  |
* ## [ultimate-reviews/tags/2.1.33/Shortcodes/SelectReview.php](/changeset/2409141/ultimate-reviews/tags/2.1.33/Shortcodes/SelectReview.php "Show the changeset 2409141 restricted to ultimate-reviews/tags/2.1.33/Shortcodes/SelectReview.php")

  | [r2263410](/browser/ultimate-reviews/trunk/Shortcodes/SelectReview.php?rev=2263410#L125 "Show revision 2263410 of this file in browser") | [r2409141](/browser/ultimate-reviews/tags/2.1.33/Shortcodes/SelectReview.php?rev=2409141#L125 "Show revision 2409141 of this file in browser") |  |
  | --- | --- | --- |
  | 125 | 125 |  |
  | 126 | 126 | if ($Karma == "") {$Karma = 0;} |
  | 127 |  | if(isset($\_COOKIE['EWD\_URP\_Karma\_IDs'])) {$EWD\_URP\_Karma\_IDs = unserialize(stripslashes($\_COOKIE['EWD\_URP\_Karma\_IDs']));} |
  | 128 |  | else {$EWD\_URP\_Karma\_IDs = array();} |
  | 129 |  | if (!is\_array($EWD\_URP\_Karma\_IDs)) {$EWD\_URP\_Karma\_IDs = array();} |
  |  | 127 |  |
  |  | 128 | $EWD\_URP\_Karma\_IDs = isset( $\_COOKIE['EWD\_URP\_Karma\_IDs'] ) ? json\_decode( $\_COOKIE['EWD\_URP\_Karma\_IDs'] ) : array(); |
  |  | 129 | $EWD\_URP\_Karma\_IDs = is\_array( $EWD\_URP\_Karma\_IDs ) ? array\_map( 'intval', $EWD\_URP\_Karma\_IDs ) : array(); |
  |  | 130 |  |
  | 130 | 131 | if (in\_array($Review->ID, $EWD\_URP\_Karma\_IDs)) {$Karma\_ID = "0";} |
  | 131 | 132 | else {$Karma\_ID = $Review->ID;} |
* ## [ultimate-reviews/tags/2.1.33/css/ewd-urp-styles.css](/changeset/2409141/ultimate-reviews/tags/2.1.33/css/ewd-urp-styles.css "Show the changeset 2409141 restricted to ultimate-reviews/tags/2.1.33/css/ewd-urp-styles.css")

  | [r2263410](/browser/ultimate-reviews/trunk/css/ewd-urp-styles.css?rev=2263410#L519 "Show revision 2263410 of this file in browser") | [r2409141](/browser/ultimate-reviews/tags/2.1.33/css/ewd-urp-styles.css?rev=2409141#L519 "Show revision 2409141 of this file in browser") |  |
  | --- | --- | --- |
  | 519 | 519 | margin-top: 8px; |
  | 520 | 520 | margin-bottom: 32px; |
  |  | 521 | clear: both; |
  | 521 | 522 | } |
  | 522 | 523 | .ewd-urp-filtering-toggle { |
* ## [ultimate-reviews/tags/2.1.33/js/ewd-urp-dashboard-review-ask.js](/changeset/2409141/ultimate-reviews/tags/2.1.33/js/ewd-urp-dashboard-review-ask.js "Show the changeset 2409141 restricted to ultimate-reviews/tags/2.1.33/js/ewd-urp-dashboard-review-ask.js")

  | [r2379758](/browser/ultimate-reviews/trunk/js/ewd-urp-dashboard-review-ask.js?rev=2379758#L2 "Show revision 2379758 of this file in browser") | [r2409141](/browser/ultimate-reviews/tags/2.1.33/js/ewd-urp-dashboard-review-ask.js?rev=2409141#L2 "Show revision 2409141 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | jQuery('.ewd-urp-main-dashboard-review-ask').css('display', 'block'); |
  | 3 | 3 |  |
  | 4 |  | ~~jQuery('.ewd-urp-main-dashboard-review-ask .notice-dismiss').on('click~~', function(event) { |
  | 5 |  | var data = 'Ask\_Review\_Date=7&action=ewd\_urp\_hide\_review\_ask'; |
  | 6 |  | jQuery.post(ajaxurl, data, function() {}); |
  | 7 |  | }); |
  |  | 4 | jQuery(document).on('click', '.ewd-urp-main-dashboard-review-ask .notice-dismiss', function(event) { |
  |  | 5 | var data = 'Ask\_Review\_Date=7&action=ewd\_urp\_hide\_review\_ask'; |
  |  | 6 | jQuery.post(ajaxurl, data, function() {}); |
  |  | 7 | }); |
  | 8 | 8 |  |
  | 9 | 9 | jQuery('.ewd-urp-review-ask-yes').on('click', function() { |
* ## [ultimate-reviews/tags/2.1.33/readme.txt](/changeset/2409141/ultimate-reviews/tags/2.1.33/readme.txt "Show the changeset 2409141 restricted to ultimate-reviews/tags/2.1.33/readme.txt")

  | [r2379758](/browser/ultimate-reviews/trunk/readme.txt?rev=2379758#L272 "Show revision 2379758 of this file in browser") | [r2409141](/browser/ultimate-reviews/tags/2.1.33/readme.txt?rev=2409141#L272 "Show revision 2409141 of this file in browser") |  |
  | --- | --- | --- |
  | 272 | 272 | == Changelog == |
  | 273 | 273 |  |
  |  | 274 | = 2.1.33 = |
  |  | 275 | - Updating cookie security |
  |  | 276 |  |
  | 274 | 277 | = 2.1.32 = |
  | 275 | 278 | - Corrects recent issue causing the feedback notice to not dismiss correctly |
* ## [ultimate-reviews/trunk/Functions/EWD\_URP\_Submit\_Review.php](/changeset/2409141/ultimate-reviews/trunk/Functions/EWD_URP_Submit_Review.php "Show the changeset 2409141 restricted to ultimate-reviews/trunk/Functions/EWD_URP_Submit_Review.php")

  | [r2336954](/browser/ultimate-reviews/trunk/Functions/EWD_URP_Submit_Review.php?rev=2336954#L90 "Show revision 2336954 of this file in browser") | [r2409141](/browser/ultimate-reviews/trunk/Functions/EWD_URP_Submit_Review.php?rev=2409141#L90 "Show revision 2409141 of this file in browser") |  |
  | --- | --- | --- |
  | 90 | 90 |  |
  | 91 | 91 | if ($One\_Review\_Per\_Product\_Person == "Yes") { |
  | 92 |  | $Reviewed\_Products = (isset($\_COOKIE['EWD\_URP\_Reviewed\_Products']) ? unserialize(stripslashes($\_COOKIE['EWD\_URP\_Reviewed\_Products'])) : array()); |
  |  | 92 |  |
  |  | 93 | $Reviewed\_Products = isset($\_COOKIE['EWD\_URP\_Reviewed\_Products']) ? json\_decode($\_COOKIE['EWD\_URP\_Reviewed\_Products']) : array(); |
  |  | 94 | $Reviewed\_Products = is\_array( $Reviewed\_Products ) ? array\_map( 'sanitize\_text\_field', $Reviewed\_Products ) : array(); |
  | 93 | 95 |  |
  | 94 |  | if (~~in\_array($Product\_Name, $Reviewed\_Products)~~) { |
  |  | 96 | if ( in\_array($Product\_Name, $Reviewed\_Products) ) { |
  | 95 | 97 | $user\_message = \_\_("You have already submitted a review for a product with that product name. Please select a different product to review.", 'ultimate-reviews'); |
  | 96 | 98 | return $user\_message; |
  | […](/browser/ultimate-reviews/trunk/Functions/EWD_URP_Submit_Review.php?rev=2336954#L99) | […](/browser/ultimate-reviews/trunk/Functions/EWD_URP_Submit_Review.php?rev=2409141#L101) |  |
  | 99 | 101 | $Reviewed\_Products[] = $Product\_Name; |
  | 100 | 102 |  |
  | 101 |  | setcookie('EWD\_URP\_Reviewed\_Products', ~~serializ~~e($Reviewed\_Products), time() + 365\*24\*3600, '/'); |
  |  | 103 | setcookie('EWD\_URP\_Reviewed\_Products', json\_encode($Reviewed\_Products), time() + 365\*24\*3600, '/'); |
  | 102 | 104 | } |
  | 103 | 105 |  |
* ## [ultimate-reviews/trunk/Functions/Process\_Ajax.php](/changeset/2409141/ultimate-reviews/trunk/Functions/Process_Ajax.php "Show the changeset 2409141 restricted to ultimate-reviews/trunk/Functions/Process_Ajax.php")

  | [r2336954](/browser/ultimate-reviews/trunk/Functions/Process_Ajax.php?rev=2336954#L69 "Show revision 2336954 of this file in browser") | [r2409141](/browser/ultimate-reviews/trunk/Functions/Process_Ajax.php?rev=2409141#L69 "Show revision 2409141 of this file in browser") |  |
  | --- | --- | --- |
  | 69 | 69 | else {update\_post\_meta( $Review\_ID, 'EWD\_URP\_Review\_Karma', $Karma + 1 );} |
  | 70 | 70 |  |
  | 71 |  | $EWD\_URP\_Karma\_IDs = unserialize(stripslashes($\_COOKIE['EWD\_URP\_Karma\_IDs'])); |
  |  | 71 | $EWD\_URP\_Karma\_IDs = isset( $\_COOKIE['EWD\_URP\_Karma\_IDs'] ) ? json\_decode( $\_COOKIE['EWD\_URP\_Karma\_IDs'] ) : array(); |
  |  | 72 | $EWD\_URP\_Karma\_IDs = is\_array( $EWD\_URP\_Karma\_IDs ) ? array\_map( 'intval', $EWD\_URP\_Karma\_IDs ) : array(); |
  | 72 | 73 | $EWD\_URP\_Karma\_IDs[] = $Review\_ID; |
  | 73 | 74 |  |
  | 74 |  | setcookie('EWD\_URP\_Karma\_IDs', ~~serialize($EWD\_URP\_Karma\_IDs~~), time()+3600\*24\*365, '/'); |
  |  | 75 | setcookie('EWD\_URP\_Karma\_IDs', json\_encode( $EWD\_URP\_Karma\_IDs ), time()+3600\*24\*365, '/'); |
  | 75 | 76 | } |
  | 76 | 77 | add\_action('wp\_ajax\_urp\_update\_karma', 'EWD\_URP\_Update\_Karama'); |
* ## [ultimate-reviews/trunk/Main.php](/changeset/2409141/ultimate-reviews/trunk/Main.php "Show the changeset 2409141 restricted to ultimate-reviews/trunk/Main.php")

  | [r2379758](/browser/ultimate-reviews/trunk/Main.php?rev=2379758#L8 "Show revision 2379758 of this file in browser") | [r2409141](/browser/ultimate-reviews/trunk/Main.php?rev=2409141#L8 "Show revision 2409141 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | Terms and Conditions: http://www.etoilewebdesign.com/plugin-terms-and-conditions/ |
  | 9 | 9 | Text Domain: ultimate-reviews |
  | 10 |  | Version: 2.1.3~~2~~ |
  |  | 10 | Version: 2.1.33 |
  | 11 | 11 | \*/ |
  | 12 | 12 |  |
* ## [ultimate-reviews/trunk/Shortcodes/SelectReview.php](/changeset/2409141/ultimate-reviews/trunk/Shortcodes/SelectReview.php "Show the changeset 2409141 restricted to ultimate-reviews/trunk/Shortcodes/SelectReview.php")

  | [r2263410](/browser/ultimate-reviews/trunk/Shortcodes/SelectReview.php?rev=2263410#L125 "Show revision 2263410 of this file in browser") | [r2409141](/browser/ultimate-reviews/trunk/Shortcodes/SelectReview.php?rev=2409141#L125 "Show revision 2409141 of this file in browser") |  |
  | --- | --- | --- |
  | 125 | 125 |  |
  | 126 | 126 | if ($Karma == "") {$Karma = 0;} |
  | 127 |  | if(isset($\_COOKIE['EWD\_URP\_Karma\_IDs'])) {$EWD\_URP\_Karma\_IDs = unserialize(stripslashes($\_COOKIE['EWD\_URP\_Karma\_IDs']));} |
  | 128 |  | else {$EWD\_URP\_Karma\_IDs = array();} |
  | 129 |  | if (!is\_array($EWD\_URP\_Karma\_IDs)) {$EWD\_URP\_Karma\_IDs = array();} |
  |  | 127 |  |
  |  | 128 | $EWD\_URP\_Karma\_IDs = isset( $\_COOKIE['EWD\_URP\_Karma\_IDs'] ) ? json\_decode( $\_COOKIE['EWD\_URP\_Karma\_IDs'] ) : array(); |
  |  | 129 | $EWD\_URP\_Karma\_IDs = is\_array( $EWD\_URP\_Karma\_IDs ) ? array\_map( 'intval', $EWD\_URP\_Karma\_IDs ) : array(); |
  |  | 130 |  |
  | 130 | 131 | if (in\_array($Review->ID, $EWD\_URP\_Karma\_IDs)) {$Karma\_ID = "0";} |
  | 131 | 132 | else {$Karma\_ID = $Review->ID;} |
* ## [ultimate-reviews/trunk/css/ewd-urp-styles.css](/changeset/2409141/ultimate-reviews/trunk/css/ewd-urp-styles.css "Show the changeset 2409141 restricted to ultimate-reviews/trunk/css/ewd-urp-styles.css")

  | [r2263410](/browser/ultimate-reviews/trunk/css/ewd-urp-styles.css?rev=2263410#L519 "Show revision 2263410 of this file in browser") | [r2409141](/browser/ultimate-reviews/trunk/css/ewd-urp-styles.css?rev=2409141#L519 "Show revision 2409141 of this file in browser") |  |
  | --- | --- | --- |
  | 519 | 519 | margin-top: 8px; |
  | 520 | 520 | margin-bottom: 32px; |
  |  | 521 | clear: both; |
  | 521 | 522 | } |
  | 522 | 523 | .ewd-urp-filtering-toggle { |
* ## [ultimate-reviews/trunk/js/ewd-urp-dashboard-review-ask.js](/changeset/2409141/ultimate-reviews/trunk/js/ewd-urp-dashboard-review-ask.js "Show the changeset 2409141 restricted to ultimate-reviews/trunk/js/ewd-urp-dashboard-review-ask.js")

  | [r2379758](/browser/ultimate-reviews/trunk/js/ewd-urp-dashboard-review-ask.js?rev=2379758#L2 "Show revision 2379758 of this file in browser") | [r2409141](/browser/ultimate-reviews/trunk/js/ewd-urp-dashboard-review-ask.js?rev=2409141#L2 "Show revision 2409141 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | jQuery('.ewd-urp-main-dashboard-review-ask').css('display', 'block'); |
  | 3 | 3 |  |
  | 4 |  | ~~jQuery('.ewd-urp-main-dashboard-review-ask .notice-dismiss').on('click~~', function(event) { |
  | 5 |  | var data = 'Ask\_Review\_Date=7&action=ewd\_urp\_hide\_review\_ask'; |
  | 6 |  | jQuery.post(ajaxurl, data, function() {}); |
  | 7 |  | }); |
  |  | 4 | jQuery(document).on('click', '.ewd-urp-main-dashboard-review-ask .notice-dismiss', function(event) { |
  |  | 5 | var data = 'Ask\_Review\_Date=7&action=ewd\_urp\_hide\_review\_ask'; |
  |  | 6 | jQuery.post(ajaxurl, data, function() {}); |
  |  | 7 | }); |
  | 8 | 8 |  |
  | 9 | 9 | jQuery('.ewd-urp-review-ask-yes').on('click', function() { |
* ## [ultimate-reviews/trunk/readme.txt](/changeset/2409141/ultimate-reviews/trunk/readme.txt "Show the changeset 2409141 restricted to ultimate-reviews/trunk/readme.txt")

  | [r2379758](/browser/ultimate-reviews/trunk/readme.txt?rev=2379758#L272 "Show revision 2379758 of this file in browser") | [r2409141](/browser/ultimate-reviews/trunk/readme.txt?rev=2409141#L272 "Show revision 2409141 of this file in browser") |  |
  | --- | --- | --- |
  | 272 | 272 | == Changelog == |
  | 273 | 273 |  |
  |  | 274 | = 2.1.33 = |
  |  | 275 | - Updating cookie security |
  |  | 276 |  |
  | 274 | 277 | = 2.1.32 = |
  | 275 | 278 | - Corrects recent issue causing the feedback notice to not dismiss correctly |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2409141)
* [Zip Archive](?format=zip&new=2409141)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from blog.nintechnet.com_24eea263_20250119_122518.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# WordPress Ultimate Reviews plugin fixed insecure deserialization vulnerability.

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [November 10, 2020 - 12:42pm [+0700]January 21, 2021 - 6:21pm [+0700]](https://blog.nintechnet.com/wordpress-ultimate-reviews-plugin-fixed-insecure-deserialization-vulnerability/)

The WordPress [Ultimate Reviews](https://wordpress.org/plugins/ultimate-reviews/) plugin (2,000+ active installations) fixed an insecure deserialization vulnerability affecting version 2.1.32 and below that could lead to unauthenticated PHP object injection.

### Insecure Deserialization

There are three occurrences in the plugin where an unauthenticated user could inject a serialized PHP object in a cookie, which could potentially lead to a PHP object injection vulnerability:

1. In the “Functions/Process\_Ajax.php” script, the `EWD_URP_Karma_IDs` cookie L71 in the `EWD_URP_Update_Karama` AJAX action, which can be exploited by any user, authenticated or not:

```
function EWD_URP_Update_Karama() {

   $Review_ID = intval( $_POST['ReviewID'] );
   $Direction = sanitize_text_field( $_POST['Direction'] );

   $Karma = get_post_meta( $Review_ID, 'EWD_URP_Review_Karma', true );

   if ($Direction == 'down') {update_post_meta( $Review_ID, 'EWD_URP_Review_Karma', $Karma - 1 );}
   else {update_post_meta( $Review_ID, 'EWD_URP_Review_Karma', $Karma + 1 );}

   $EWD_URP_Karma_IDs = unserialize(stripslashes($_COOKIE['EWD_URP_Karma_IDs']));
   $EWD_URP_Karma_IDs[] = $Review_ID;

   setcookie('EWD_URP_Karma_IDs', serialize($EWD_URP_Karma_IDs), time()+3600*24*365, '/');
}
add_action('wp_ajax_urp_update_karma', 'EWD_URP_Update_Karama');
add_action('wp_ajax_nopriv_urp_update_karma', 'EWD_URP_Update_Karama');

```

2. In the “Functions/EWD\_URP\_Submit\_Review.php” script, the `EWD_URP_Reviewed_Products` cookie L92, when an unauthenticated user submits a review:

```
if ($One_Review_Per_Product_Person == "Yes") {
   $Reviewed_Products = (isset($_COOKIE['EWD_URP_Reviewed_Products']) ? unserialize(stripslashes($_COOKIE['EWD_URP_Reviewed_Products'])) : array());

```

3. In the “Shortcodes/SelectReview.php” script, the `EWD_URP_Karma_IDs` cookie L127, when an unauthenticated user visits a page or a post:

```
if(isset($_COOKIE['EWD_URP_Karma_IDs'])) {$EWD_URP_Karma_IDs = unserialize(stripslashes($_COOKIE['EWD_URP_Karma_IDs']));}
else {$EWD_URP_Karma_IDs = array();}

```
### Timeline

The vulnerabilities were reported to the WordPress Plugin Team on October 28th 2020, and a new version 2.1.33 was released on October 29th.

### Recommendations

Upgrade immediately to the latest version of the plugin. If you are using our web application firewall for WordPress, [NinjaFirewall WP Edition](https://wordpress.org/plugins/ninjafirewall/) (free) and [NinjaFirewall WP+ Edition](https://nintechnet.com/ninjafirewall/wp-edition/) (premium), you are protected against this vulnerability. Additionally, NinjaFirewall has an option to block serialized PHP objects, which I recommend to enable:

![](https://blog.nintechnet.com/wp-content/uploads/2020/11/wordpress-block-php-object-injection.png)

It can be found in the “Firewall Policies > Advanced Policies” section.

### Stay informed about the latest vulnerabilities

* Running WordPress? You can get [email notifications](https://blog.nintechnet.com/how-to-get-informed-about-the-latest-security-updates-in-your-wordpress-plugins-and-themes/) about vulnerabilities in the plugins or themes installed on your blog.
* On Twitter: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=WordPress%20Ultimate%20Reviews%20plugin%20fixed%20insecure%20deserialization%20vulnerability.&url=https%3A%2F%2Fblog.nintechnet.com%2Fwordpress-ultimate-reviews-plugin-fixed-insecure-deserialization-vulnerability%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Fwordpress-ultimate-reviews-plugin-fixed-insecure-deserialization-vulnerability%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=WordPress%20Ultimate%20Reviews%20plugin%20fixed%20insecure%20deserialization%20vulnerability.&url=https%3A%2F%2Fblog.nintechnet.com%2Fwordpress-ultimate-reviews-plugin-fixed-insecure-deserialization-vulnerability%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous GDPR CCPA Compliance Support plugin fixed insecure deserialization vulnerability.](https://blog.nintechnet.com/gdpr-ccpa-compliance-support-plugin-fixed-insecure-deserialization-vulnerability/)[Next Authenticated RCE vulnerability in WordPress Secure File Manager plugin (unpatched).](https://blog.nintechnet.com/authenticated-rce-vulnerability-in-wordpress-secure-file-manager-plugin-unpatched/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)



=== Content from www.wordfence.com_70fbf4a7_20250119_140341.html ===


![](https://www.wordfence.com/wp-content/uploads/2023/08/Threat-Actors-Using-Obfuscation-in-Attempt-to-Evade-Detection.png)

[![](https://secure.gravatar.com/avatar/680d477d7c41e2495d76bb142a238b06?s=80&d=mm&r=g)Marco Wotschka](https://www.wordfence.com/blog/author/wfmarco/)

August 15, 2023

# Threat Actors Using Obfuscation in Attempt to Evade Detection

As part of our product lineup, we offer security monitoring and malware removal services to our [Wordfence Care](https://www.wordfence.com/products/wordfence-care/) and [Response](https://www.wordfence.com/products/wordfence-response/) customers. In the event of a security incident, our incident response team will investigate the root cause, find and remove malware from your site, and help with other complications that may arise as a result of an infection. During the cleanup, malware samples are added to our Threat Intelligence database, which contains over 3.5 million unique malicious samples. *Interested in integrating this data into your solutions? Check out* [*Wordfence Intelligence Enterprise*](https://www.wordfence.com/products/wordfence-intelligence-enterprise/).

In a [previous blog post](https://www.wordfence.com/blog/2023/07/dissecting-a-clever-malware-sample-for-optimized-detection-and-protection/) we analyzed a malware sample whose author intended to make it look like normal code to the naked eye while carrying out a malicious task. Today, we would like to dissect and share a style of malware that uses several layers of obfuscation to disguise its main purpose while not hiding the fact that it is malicious. It was added to our malware database on February 20, 2023 when one of our analysts discovered it during a site clean.

![](https://www.wordfence.com/wp-content/uploads/2023/08/sample1-1-300x90.png)

*Obfuscated malware sample (line breaks added)*

A signature was developed by the same analyst the following day and released to production within a week after undergoing testing. Customers still using the free version of Wordfence received this signature after a 30 day delay.

## Analyzing the Sample

Rather than making this script blend in by making it look like this code was written by a human, this sample makes use of several different techniques that help it evade detection.

### Density

The screenshot above was edited in order to make sure the sample was legible. In reality, the entire sample was contained on one line when we found it. We don’t see a lot of whitespace in this file, certainly not more than one space character in a row. We often find this to be the case with malware that relies on heavy obfuscation. PHP code written by humans tends to be properly indented and readable, although exceptions exist of course.

### Commenting

One of the most notable elements of this malware is the excessive use of comments in the file. Typically, human coders use comments to describe what their code does, while in this sample comments are exclusively used to break up code bits and make it harder to detect using common malware detection methods such as signatures. Comments in PHP are formatted as follows:

* /\* some comment that spans one or more lines \*/
* // comment begins and ends with a newline (c++ style)
* # comment begins and ends with a newline (shell-style)

Once we remove those comments we get a clearer picture of what this sample does.

![](https://www.wordfence.com/wp-content/uploads/2023/08/sample2-1-300x40.png)

*Obfuscated malware sample after removing comments (line breaks added)*

### Use of Variable Functions

After removing the comments, this sample does appear to be a bit more legible, but it still needs a little bit of work. The variable `$ojq` is set to the string “range” using string concatenation. The command `$nHpCr = $ojq("~"," ");` creates an array of items in the range defined by the two function arguments. Ultimately, the array stored in `$nHpCr` contains all the characters in the following string:

`~}|{zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?>=<;:9876543210/.-,+*)('&%$#"!`

### Concatenation and Arithmetic

What follows is an `include` statement. This include statement is built from individual characters of the aforementioned array via concatenation. Each of those character lookups uses arithmetic operations for further obfuscation. In the end, this entire malware sample accomplishes just one thing. It includes the file named `yEghAwUPIiznpu.m4a`, a file with an extension associated with audio files. This file adds yet another layer of complexity.

![](https://www.wordfence.com/wp-content/uploads/2023/08/sample3-1-300x289.png)

*yEghAwUPIiznpu.m4a after editing for legibility*

This sample makes use of similar obfuscation techniques. We removed the comments that littered the file and added some line breaks as well as indentation. The script begins with some cookie checking before declaring a class and also uses the range function along with string concatenation for added obfuscation.

We notice a static function that sets up a cURL session – used to communicate with a remote server, see checks for `$_GET` parameters as well as some `__FILE__` handling. A protection mechanism that performs a password check is used to protect this malicious shell from unauthorized access.

While we had other signatures in place that aimed at detecting obfuscated malware similar to these samples, we realized that those signatures were not robust enough to handle recently discovered samples as well. This shows the importance of continuous signature development and of embracing redundancy during the signature development process instead of attempting to detect as many files as possible with the fewest possible number of signatures. Regular analysis of new malware samples is crucial to detection – especially when malware samples exhibit several of the aforementioned features.

## Further Research

Since the discovery of these two samples, we have added dozens of signatures that target comment placement, the use of arithmetic when accessing array elements, density, excessive string concatenation, and other features often seen in obfuscated files.

We do this by writing signatures that target certain malicious behaviors of interest in novel ways. As part of our QA process we evaluate false positives as well as other potential issues and address those where possible. Taking this multi-pronged approach to signature development allows us to improve our detection capabilities more quickly and beyond the corpus of files we already have.

As a result of these efforts the first sample is now covered by five production signatures with additional signatures currently still in the testing stage. The second script is covered by six of our signatures and has additional signatures waiting for production approval.

## Conclusion

In today’s post we discussed several obfuscation techniques used in a web shell to try and disguise its real purpose and evade detection. We discussed how these techniques can alternatively be used for detection purposes, and how we used broader research signatures to expand detection.

Our [Premium](https://www.wordfence.com/products/wordfence-premium/), [Care](https://www.wordfence.com/products/wordfence-care/), and [Response](https://www.wordfence.com/products/wordfence-response/) users as well as those who are still using the free version of Wordfence are protected by our malware scanner during file uploads against the upload of this sample as well as some of its variants. This means that Wordfence will block any attempts by attackers that try to upload this file to a compromised WordPress site. [Properly configured](https://www.wordfence.com/help/scan/) scans running on those sites will also detect this sample in the unlikely event it is uploaded to a site during an infection.

It’s important to remember that detection of a compromise is just as important to security as ensuring your site remains protected. By using the Wordfence plugin, and ensuring it has been optimally configured along with following security best practices, you’re ensuring your site remains as protected as possible. Nothing can ever be 100% secure, and risk can never fully be mitigated, so it’s important to have monitoring on your site in the event your site is still compromised despite following all best practices. The Wordfence scanner will alert you to any infections so you can initiate an incident response, and also block malicious malware uploads in the event an attacker gets past a site’s first line of defense.

If you believe that your site might be infected, you can enlist the help of our Incident Response team by purchasing our [Care](https://www.wordfence.com/products/wordfence-care/), or [Response](https://www.wordfence.com/products/wordfence-response/) offering or [follow this guide](https://www.wordfence.com/docs/how-to-clean-a-hacked-wordpress-site-using-wordfence/) to remove the infection yourself.

If you have a malware sample that was missed during a Wordfence scan, please let us know by sending the sample to us at samples@wordfence.com.

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2023%2F08%2Fthreat-actors-using-obfuscation-in-attempt-to-evade-detection%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2023%2F08%2Fthreat-actors-using-obfuscation-in-attempt-to-evade-detection%2F&text=Threat%20Actors%20Using%20Obfuscation%20in%20Attempt%20to%20Evade%20Detection&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2023%2F08%2Fthreat-actors-using-obfuscation-in-attempt-to-evade-detection%2F)

## Comments

1 Comment

* ![](https://secure.gravatar.com/avatar/6640cfc7eb9785414c8b3f98a87e977f?s=96&d=mm&r=g)
  Danny
  August 15, 2023
   7:42 am

  Thank you for that clear explanation. Thank all of you for helping to keep us safe.

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save


