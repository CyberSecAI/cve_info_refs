=== Content from stackoverflow.com_1047a49f_20250119_132911.html ===


[Skip to main content](#content)

[Stack Overflow](https://stackoverflow.com)

1. [About](https://stackoverflow.co/)
2. Products
3. [OverflowAI](https://stackoverflow.co/teams/ai/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav-bar&utm_content=overflowai)

1. [Stack Overflow for Teams
   Where developers & technologists share private knowledge with coworkers](https://stackoverflow.co/teams/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=stack-overflow-for-teams)
2. [Advertising & Talent
   Reach devs & technologists worldwide about your product, service or employer brand](https://stackoverflow.co/advertising/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=stack-overflow-advertising)
3. [OverflowAI
   GenAI features for Teams](https://stackoverflow.co/teams/ai/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=overflow-ai)
4. [OverflowAPI
   Train & fine-tune LLMs](https://stackoverflow.co/api-solutions/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=overflow-api)
5. [Labs
   The future of collective knowledge sharing](https://stackoverflow.co/labs/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=labs)
6. [About the company](https://stackoverflow.co/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=about-the-company)
   [Visit the blog](https://stackoverflow.blog/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=top-nav&utm_content=blog)

Loading…

1. ### [current community](https://stackoverflow.com)

   * [Stack Overflow](https://stackoverflow.com)

     [help](https://stackoverflow.com/help)
     [chat](https://chat.stackoverflow.com/?tab=site&host=stackoverflow.com)
   * [Meta Stack Overflow](https://meta.stackoverflow.com)
   ### your communities

   [Sign up](https://stackoverflow.com/users/signup?ssrc=site_switcher&returnurl=https%3a%2f%2fstackoverflow.com%2fcollectives%2fgo) or [log in](https://stackoverflow.com/users/login?ssrc=site_switcher&returnurl=https%3a%2f%2fstackoverflow.com%2fcollectives%2fgo) to customize your list.

   ### [more stack exchange communities](https://stackexchange.com/sites)

   [company blog](https://stackoverflow.blog)
3. [Log in](https://stackoverflow.com/users/login?ssrc=head&returnurl=https%3a%2f%2fstackoverflow.com%2fcollectives%2fgo)
4. [Sign up](https://stackoverflow.com/users/signup?ssrc=head&returnurl=https%3a%2f%2fstackoverflow.com%2fcollectives%2fgo)

1. 1. [Home](/)
   2. [Questions](/questions)
   3. [Tags](/tags)
   5. [Users](/users)
   6. [Companies](https://stackoverflow.com/jobs/companies?so_medium=stackoverflow&so_source=SiteNav)
   7. Labs
   8. [Discussions](/beta/discussions)
   9. Collectives
   10. Communities for your favorite technologies. [Explore all Collectives](/collectives-all)
2. Teams
   ![](https://cdn.sstatic.net/Img/teams/teams-promo.svg?v=e507948b81bf)

   Ask questions, find answers and collaborate at work with Stack Overflow for Teams.

   [Try Teams for free](https://stackoverflowteams.com/teams/create/free/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=side-bar&utm_content=explore-teams)
   [Explore Teams](https://stackoverflow.co/teams/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=side-bar&utm_content=explore-teams)
3. Teams
4. Ask questions, find answers and collaborate at work with Stack Overflow for Teams.
   [Explore Teams](https://stackoverflow.co/teams/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=side-bar&utm_content=explore-teams-compact)

##### Collectives™ on Stack Overflow

Find centralized, trusted content and collaborate around the technologies you use most.

[Learn more about Collectives](/collectives)

**Teams**

Q&A for work

Connect and share knowledge within a single location that is structured and easy to search.

[Learn more about Teams](https://stackoverflow.co/teams/)

Get early access and see previews of new features.

 [Learn more about Labs](https://stackoverflow.co/labs/)

# The Go Language Collective is no longer active.

Collectives™ on Stack Overflow is a new offering in beta release. Currently a Collective requires participation from
a sponsoring organization, so in some cases a Collective may be decommissioned when the sponsorship ends. All questions and
answers that comprised a Collective remain accessible.

[Find Go Language related posts](/questions/tagged/?tagnames=%5bgo%5d+or+%5bgo-gorm%5d+or+%5bgoroutine%5d)

Looking for more information? See this Help Center article: [What happens when a collective is decommissioned?](/help/collectives-decommissioned)

Find other technology and open source technology organizations already on Stack Overflow. [Explore all Collectives](/collectives-all)

##### [Stack Overflow](https://stackoverflow.com)

* [Questions](/questions)
* [Help](/help)
* [Chat](https://chat.stackoverflow.com/?tab=site&host=stackoverflow.com)

##### [Products](https://stackoverflow.co/)

* [Teams](https://stackoverflow.co/teams/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=footer&utm_content=teams)
* [Advertising](https://stackoverflow.co/advertising/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=footer&utm_content=advertising)
* [Talent](https://stackoverflow.co/advertising/employer-branding/?utm_medium=referral&utm_source=stackoverflow-community&utm_campaign=footer&utm_content=talent)

##### [Company](https://stackoverflow.co/)

* [About](https://stackoverflow.co/)
* [Press](https://stackoverflow.co/company/press/)
* [Work Here](https://stackoverflow.co/company/work-here/)
* [Legal](https://stackoverflow.com/legal)
* [Privacy Policy](https://stackoverflow.com/legal/privacy-policy)
* [Terms of Service](https://stackoverflow.com/legal/terms-of-service/public)
* [Contact Us](/contact)
* Cookie Settings
* [Cookie Policy](https://stackoverflow.com/legal/cookie-policy)

##### [Stack Exchange Network](https://stackexchange.com)

* [Technology](https://stackexchange.com/sites#technology)
* [Culture & recreation](https://stackexchange.com/sites#culturerecreation)
* [Life & arts](https://stackexchange.com/sites#lifearts)
* [Science](https://stackexchange.com/sites#science)
* [Professional](https://stackexchange.com/sites#professional)
* [Business](https://stackexchange.com/sites#business)
* [API](https://api.stackexchange.com/)
* [Data](https://data.stackexchange.com/)

* [Blog](https://stackoverflow.blog?blb=1)
* [Facebook](https://www.facebook.com/officialstackoverflow/)
* [Twitter](https://twitter.com/stackoverflow)
* [LinkedIn](https://linkedin.com/company/stack-overflow)
* [Instagram](https://www.instagram.com/thestackoverflow)

Site design / logo © 2025 Stack Exchange Inc;
user contributions licensed under
[CC BY-SA](https://stackoverflow.com/help/licensing)
.
rev 2025.1.17.21193



=== Content from github.com_c67fe651_20250119_132913.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flabstack%2Fecho%2Fpull%2F1718)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flabstack%2Fecho%2Fpull%2F1718)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=labstack%2Fecho)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[labstack](/labstack)
/
**[echo](/labstack/echo)**
Public

* [Notifications](/login?return_to=%2Flabstack%2Fecho) You must be signed in to change notification settings
* [Fork
  2.2k](/login?return_to=%2Flabstack%2Fecho)
* [Star
   30.3k](/login?return_to=%2Flabstack%2Fecho)

* [Code](/labstack/echo)
* [Issues
  51](/labstack/echo/issues)
* [Pull requests
  26](/labstack/echo/pulls)
* [Discussions](/labstack/echo/discussions)
* [Actions](/labstack/echo/actions)
* [Projects
  0](/labstack/echo/projects)
* [Wiki](/labstack/echo/wiki)
* [Security](/labstack/echo/security)
* [Insights](/labstack/echo/pulse)

Additional navigation options

* [Code](/labstack/echo)
* [Issues](/labstack/echo/issues)
* [Pull requests](/labstack/echo/pulls)
* [Discussions](/labstack/echo/discussions)
* [Actions](/labstack/echo/actions)
* [Projects](/labstack/echo/projects)
* [Wiki](/labstack/echo/wiki)
* [Security](/labstack/echo/security)
* [Insights](/labstack/echo/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Flabstack%2Fecho%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Flabstack%2Fecho%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix Security Vulnerability - Directory Traversal #1718

 Merged

[lammel](/lammel)
merged 1 commit into
[labstack:master](/labstack/echo/tree/master "labstack/echo:master")
from
[little-cui:master](/little-cui/echo/tree/master "little-cui/echo:master")

Dec 15, 2020

 Merged

# [Fix Security Vulnerability - Directory Traversal](#top) #1718

[lammel](/lammel)
merged 1 commit into
[labstack:master](/labstack/echo/tree/master "labstack/echo:master")
from
[little-cui:master](/little-cui/echo/tree/master "little-cui/echo:master")

Dec 15, 2020

[Conversation
16](/labstack/echo/pull/1718)
[Commits
1](/labstack/echo/pull/1718/commits)
[Checks
0](/labstack/echo/pull/1718/checks)
[Files changed](/labstack/echo/pull/1718/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![little-cui](https://avatars.githubusercontent.com/u/23383427?s=60&v=4)](/little-cui)

Copy link

Contributor

### @little-cui **[little-cui](/little-cui)** commented [Dec 13, 2020](#issue-765411536) • edited Loading

Hi, We are [Apache ServiceComb](https://github.com/apache/servicecomb-service-center) team. labstack/echo is the good project, we use it in our frontend project.

Recently, we have found a security vulnerability.

At echo.go（Line 483）

the static directory is bound by calling e.static ("/", staticPath).

The original intention is to read the root directory.

In Windows platform, POC can be constructed for path traversal.

Attack vector(s) :

```
1) Set up demo
2) In Windows platform, you can traverse through ..\

    POC-Request：

    GET /..\\other-dir/secret.txt HTTP/1.1

    HOST: 127.0.0.1:80

    Accept-Encoding: gzip, deflate

    Accept: */*

    Accept-Language: en

    User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1;
Win64; x64; Trident/5.0)

    Connection: close

```

Sorry, something went wrong.

All reactions

[![@codecov](https://avatars.githubusercontent.com/in/254?s=80&v=4)](/apps/codecov)

Copy link

### **[codecov](/apps/codecov) bot** commented [Dec 13, 2020](#issuecomment-744011972) • edited Loading

|  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://codecov.io/gh/labstack/echo/pull/1718?src=pr&el=h1) Report Merging [#1718](https://codecov.io/gh/labstack/echo/pull/1718?src=pr&el=desc) ([1beaf09](https://github.com/labstack/echo/commit/1beaf09740e7e3ed4f6bfdd753121c03946a1142)) into [master](https://codecov.io/gh/labstack/echo/commit/2b36b3d1d74c570db9d9237593ebdf448451e93f?el=desc) ([2b36b3d](https://github.com/labstack/echo/commit/2b36b3d1d74c570db9d9237593ebdf448451e93f)) will **not change** coverage. The diff coverage is `100.00%`.  [Impacted file tree graph](https://codecov.io/gh/labstack/echo/pull/1718?src=pr&el=tree)  ``` @@           Coverage Diff           @@ ##           master    #1718   +/-   ## =======================================   Coverage   85.19%   85.19%            =======================================   Files          29       29              Lines        1986     1986            =======================================   Hits         1692     1692              Misses        186      186              Partials      108      108            ```  | [Impacted Files](https://codecov.io/gh/labstack/echo/pull/1718?src=pr&el=tree) | Coverage Δ |  | | --- | --- | --- | | [echo.go](https://codecov.io/gh/labstack/echo/pull/1718/diff?src=pr&el=tree#diff-ZWNoby5nbw==) | `86.39% <100.00%> (ø)` |  | | [middleware/static.go](https://codecov.io/gh/labstack/echo/pull/1718/diff?src=pr&el=tree#diff-bWlkZGxld2FyZS9zdGF0aWMuZ28=) | `68.65% <100.00%> (ø)` |  |   ---   [Continue to review full report at Codecov](https://codecov.io/gh/labstack/echo/pull/1718?src=pr&el=continue).  **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta) `Δ = absolute <relative> (impact)`, `ø = not affected`, `? = missing data` Powered by [Codecov](https://codecov.io/gh/labstack/echo/pull/1718?src=pr&el=footer). Last update [2b36b3d...1beaf09](https://codecov.io/gh/labstack/echo/pull/1718?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments). |

All reactions

Sorry, something went wrong.

 [![@little-cui](https://avatars.githubusercontent.com/u/23383427?s=40&u=8aa2f8675fb948e989a177939aad793187da2b33&v=4)](/little-cui)
[little-cui](/little-cui)
[force-pushed](/labstack/echo/compare/c6541da6b1af6864055e1de7fae7d0c377cb834f..3dab4916ece73f2d4c209056e587706cc2a3e4b2)
the
master

branch
from
[`c6541da`](/labstack/echo/commit/c6541da6b1af6864055e1de7fae7d0c377cb834f) to
[`3dab491`](/labstack/echo/commit/3dab4916ece73f2d4c209056e587706cc2a3e4b2)  [Compare](/labstack/echo/compare/c6541da6b1af6864055e1de7fae7d0c377cb834f..3dab4916ece73f2d4c209056e587706cc2a3e4b2)
[December 13, 2020 14:01](#event-4106048635)

[![@iambenkay](https://avatars.githubusercontent.com/u/36256097?s=80&u=4dad79fc41c5da64473406433b188e74154874dc&v=4)](/iambenkay)

Copy link

Contributor

### **[iambenkay](/iambenkay)** commented [Dec 13, 2020](#issuecomment-744014638)

| Wow this is superb. Quite a vulnerability. Could you write a test that explicitly confirms that this prevents directory traversal? |
| --- |

All reactions

Sorry, something went wrong.

[![@little-cui](https://avatars.githubusercontent.com/u/23383427?s=40&u=8aa2f8675fb948e989a177939aad793187da2b33&v=4)](/little-cui)
[little-cui](/little-cui)
changed the title
~~Bug Fix: Directory Traversal~~
Fix Security Vulnerability - Directory Traversal
[Dec 13, 2020](#event-4106065704)

[![@little-cui](https://avatars.githubusercontent.com/u/23383427?s=40&u=8aa2f8675fb948e989a177939aad793187da2b33&v=4)](/little-cui)
[little-cui](/little-cui)
closed this
[Dec 13, 2020](#event-4106066361)

[![@little-cui](https://avatars.githubusercontent.com/u/23383427?s=40&u=8aa2f8675fb948e989a177939aad793187da2b33&v=4)](/little-cui)
[little-cui](/little-cui)
reopened this
[Dec 13, 2020](#event-4106067299)

[![@little-cui](https://avatars.githubusercontent.com/u/23383427?s=80&u=8aa2f8675fb948e989a177939aad793187da2b33&v=4)](/little-cui)

Copy link

Contributor

Author

### **[little-cui](/little-cui)** commented [Dec 13, 2020](#issuecomment-744014986)

| Wow this is superb. Quite a vulnerability. Could you write a test that explicitly confirms that this prevents directory traversal?  Sure, i am working on it |
| --- |

 👍
1
 iambenkay reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@aldas](https://avatars.githubusercontent.com/u/2320301?s=80&v=4)](/aldas)

Copy link

Contributor

### **[aldas](/aldas)** commented [Dec 13, 2020](#issuecomment-744046736)

| You could use this as base  ``` func TestDirectoryTraversal(t *testing.T) { 	var testCases = []struct { 		name           string 		givenURL       string 		whenStaticRoot string 		expectContent  string 		expectError    string 	}{ 		{ 			name:           "ok, serve index", 			givenURL:       `/index.html`, 			whenStaticRoot: "../_fixture", 			expectContent:  "Echo", 		}, 		{ 			name:           "nok, do not allow directory traversal", 			givenURL:       `/..\\middleware/basic_auth.go`, 			whenStaticRoot: "../_fixture", 			expectContent:  "package middleware", 			expectError:    "code=404, message=Not Found", 		}, 	}  	for _, tc := range testCases { 		t.Run(tc.name, func(t *testing.T) { 			e := echo.New()  			staticHandler := StaticWithConfig(StaticConfig{Root: tc.whenStaticRoot})(echo.NotFoundHandler)  			req := httptest.NewRequest(http.MethodGet, tc.givenURL, nil) 			rec := httptest.NewRecorder() 			c := e.NewContext(req, rec)  			err := staticHandler(c) 			if tc.expectError != "" { 				assert.Error(t, err) 				assert.EqualError(t, err, tc.expectError)  				assert.NotContains(t, rec.Body.String(), tc.expectContent) 			} else { 				assert.NoError(t, err) 				assert.Contains(t, rec.Body.String(), tc.expectContent) 			} 		}) 	} } ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@aldas](https://avatars.githubusercontent.com/u/2320301?s=80&v=4)](/aldas)

Copy link

Contributor

### **[aldas](/aldas)** commented [Dec 13, 2020](#issuecomment-744048428)

| This seems to be windows specific problem (different separator).  shorter fix would be to change     [echo/middleware/static.go](https://github.com/labstack/echo/blob/2b36b3d1d74c570db9d9237593ebdf448451e93f/middleware/static.go#L170)  Line 170 in [2b36b3d](/labstack/echo/commit/2b36b3d1d74c570db9d9237593ebdf448451e93f)   |  | name := filepath.Join(config.Root, path.Clean("/"+p)) // "/"+ for security | | --- | --- |      to  ``` name := filepath.Join(config.Root, filepath.Clean("/"+p)) ```  seems to fix problem on Windows |
| --- | --- | --- |

 ❤️
2
 iambenkay and little-cui reacted with heart emoji

All reactions

* ❤️
  2 reactions

Sorry, something went wrong.

[![@iambenkay](https://avatars.githubusercontent.com/u/36256097?s=80&u=4dad79fc41c5da64473406433b188e74154874dc&v=4)](/iambenkay)

Copy link

Contributor

### **[iambenkay](/iambenkay)** commented [Dec 13, 2020](#issuecomment-744048641)

| Great! And concise! |
| --- |

All reactions

Sorry, something went wrong.

[![@iambenkay](https://avatars.githubusercontent.com/u/36256097?s=80&u=4dad79fc41c5da64473406433b188e74154874dc&v=4)](/iambenkay)

Copy link

Contributor

### **[iambenkay](/iambenkay)** commented [Dec 13, 2020](#issuecomment-744048905)

| [@little-cui](https://github.com/little-cui) can you test out [@aldas](https://github.com/aldas) suggestion to know if it actually fixes the issue? |
| --- |

All reactions

Sorry, something went wrong.

[![@aldas](https://avatars.githubusercontent.com/u/2320301?s=80&v=4)](/aldas)

Copy link

Contributor

### **[aldas](/aldas)** commented [Dec 13, 2020](#issuecomment-744048995)

| seems that path.Clean() works only for slashes <https://golang.org/pkg/path/#Clean>  ``` 1. Replace multiple slashes with a single slash. 2. Eliminate each . path name element (the current directory). 3. Eliminate each inner .. path name element (the parent directory)    along with the non-.. element that precedes it. 4. Eliminate .. elements that begin a rooted path:    that is, replace "/.." by "/" at the beginning of a path.  ```  but filePath.Clean() is dealing with OS specific separator <https://golang.org/pkg/path/filepath/#Clean>  ``` 1. Replace multiple Separator elements with a single one. 2. Eliminate each . path name element (the current directory). 3. Eliminate each inner .. path name element (the parent directory)    along with the non-.. element that precedes it. 4. Eliminate .. elements that begin a rooted path:    that is, replace "/.." by "/" at the beginning of a path,    assuming Separator is '/'.  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@lammel](https://avatars.githubusercontent.com/u/43678?s=80&u=a6e987a1a84c959d6ec360932fb97923adef1919&v=4)](/lammel)

Copy link

Contributor

### **[lammel](/lammel)** commented [Dec 13, 2020](#issuecomment-744081584)

| Great find! [@little-cui](https://github.com/little-cui) .  Could you adjust your code to the fix [@aldas](https://github.com/aldas) proposed with an added test please so our CI can make sure it is fixed. Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![tianxiaoliang](https://avatars.githubusercontent.com/u/1610890?s=60&v=4)](/tianxiaoliang)

**[tianxiaoliang](/tianxiaoliang)**
approved these changes
[Dec 14, 2020](#pullrequestreview-550986904)

 [View reviewed changes](/labstack/echo/pull/1718/files)

[![@pafuent](https://avatars.githubusercontent.com/u/6979945?s=80&u=4c9ca7350d4ff2272b70e51c00fdc1af1f29a44f&v=4)](/pafuent)

Copy link

Contributor

### **[pafuent](/pafuent)** commented [Dec 14, 2020](#issuecomment-744149287)

| It seems that I missed all the fun 😢 Please [@little-cui](https://github.com/little-cui) bare in mind that you need to apply the fix in Echo#static and in Static middleware (<https://github.com/labstack/echo/blob/master/middleware/static.go>), and of course provide tests for both implementations. |
| --- |

All reactions

Sorry, something went wrong.

[![@aldas](https://avatars.githubusercontent.com/u/2320301?s=80&v=4)](/aldas)

Copy link

Contributor

### **[aldas](/aldas)** commented [Dec 14, 2020](#issuecomment-744802945)

| maybe it is faster if mainters will edit this PR with this (fixes static route and static middleware) [fix\_static\_route\_directory\_traversal.patch.txt](https://github.com/labstack/echo/files/5692185/fix_static_route_directory_traversal.patch.txt) |
| --- |

 👍
1
 little-cui reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@little-cui](https://avatars.githubusercontent.com/u/23383427?s=40&v=4)](/little-cui)

`[Bug Fix: Directory Traversal](/labstack/echo/pull/1718/commits/1beaf09740e7e3ed4f6bfdd753121c03946a1142 "Bug Fix: Directory Traversal")`

`[1beaf09](/labstack/echo/pull/1718/commits/1beaf09740e7e3ed4f6bfdd753121c03946a1142)`

 [![@little-cui](https://avatars.githubusercontent.com/u/23383427?s=40&u=8aa2f8675fb948e989a177939aad793187da2b33&v=4)](/little-cui)
[little-cui](/little-cui)
[force-pushed](/labstack/echo/compare/3dab4916ece73f2d4c209056e587706cc2a3e4b2..1beaf09740e7e3ed4f6bfdd753121c03946a1142)
the
master

branch
from
[`3dab491`](/labstack/echo/commit/3dab4916ece73f2d4c209056e587706cc2a3e4b2) to
[`1beaf09`](/labstack/echo/commit/1beaf09740e7e3ed4f6bfdd753121c03946a1142)  [Compare](/labstack/echo/compare/3dab4916ece73f2d4c209056e587706cc2a3e4b2..1beaf09740e7e3ed4f6bfdd753121c03946a1142)
[December 15, 2020 13:54](#event-4114691333)

[![@little-cui](https://avatars.githubusercontent.com/u/23383427?s=80&u=8aa2f8675fb948e989a177939aad793187da2b33&v=4)](/little-cui)

Copy link

Contributor

Author

### **[little-cui](/little-cui)** commented [Dec 15, 2020](#issuecomment-745300380)

| Please review again |
| --- |

All reactions

Sorry, something went wrong.

[![lammel](https://avatars.githubusercontent.com/u/43678?s=60&v=4)](/lammel)

**[lammel](/lammel)**
approved these changes
[Dec 15, 2020](#pullrequestreview-552581012)

 [View reviewed changes](/labstack/echo/pull/1718/files/1beaf09740e7e3ed4f6bfdd753121c03946a1142)

Copy link

Contributor

### @lammel **[lammel](/lammel)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Looking good!

Thanks [@little-cui](https://github.com/little-cui) and [@aldas](https://github.com/aldas)

Sorry, something went wrong.

All reactions

[![@lammel](https://avatars.githubusercontent.com/u/43678?s=40&u=a6e987a1a84c959d6ec360932fb97923adef1919&v=4)](/lammel)
[lammel](/lammel)
merged commit [`4422e3b`](/labstack/echo/commit/4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa)
into
labstack:master

[Dec 15, 2020](https://github.com/labstack/echo/pull/1718#event-4115197080)

[![@pafuent](https://avatars.githubusercontent.com/u/6979945?s=40&u=4c9ca7350d4ff2272b70e51c00fdc1af1f29a44f&v=4)](/pafuent)
[pafuent](/pafuent)
mentioned this pull request
[Dec 16, 2020](#ref-issue-768383165)

[Add missing UT to Static Middleware
#1720](/labstack/echo/issues/1720)

Closed

[![@gurshafriri](https://avatars.githubusercontent.com/u/54314478?s=80&u=6441e580e1ad84c6a9df6bae10f95e261c6534d5&v=4)](/gurshafriri)

Copy link

### **[gurshafriri](/gurshafriri)** commented [Dec 29, 2020](#issuecomment-752120480)

| 👋 [@lammel](https://github.com/lammel) Do you have a plan to also tag a version containing this fix? Since the details of this issue is already public we (at [snyk](https://snyk.io)) would like to add it to our vulnerability database, better when a fixed version is already tagged. |
| --- |

All reactions

Sorry, something went wrong.

[![@lammel](https://avatars.githubusercontent.com/u/43678?s=80&u=a6e987a1a84c959d6ec360932fb97923adef1919&v=4)](/lammel)

Copy link

Contributor

### **[lammel](/lammel)** commented [Dec 29, 2020](#issuecomment-752150354)

| Yes, a release is being prepared and expected within the next few days. The most important changes are already merged. |
| --- |

 👍
2
 gurshafriri and ironytr reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@rvasilevsf](https://avatars.githubusercontent.com/u/43855753?s=80&v=4)](/rvasilevsf)

Copy link

### **[rvasilevsf](/rvasilevsf)** commented [Feb 9, 2021](#issuecomment-775966521)

| Hello,  Looks like the latest release is [v4.1.17 tagged on 28 Aug 2020](https://github.com/labstack/echo/releases/tag/v4.1.17). When do you plan to cut a new release? |
| --- |

All reactions

Sorry, something went wrong.

[![@aldas](https://avatars.githubusercontent.com/u/2320301?s=40&v=4)](/aldas)
[aldas](/aldas)
mentioned this pull request
[Mar 2, 2021](#ref-pullrequest-820394525)

[Fix #1787: Add support for optional filesystem to the static middleware
#1797](/labstack/echo/pull/1797)
 Merged

This was referenced Mar 14, 2021

[Bump github.com/labstack/echo/v4 from 4.1.17 to 4.2.1 in /instrumentation/github.com/labstack/echo/otelecho/example
jmacd/opentelemetry-go-contrib#523](/jmacd/opentelemetry-go-contrib/pull/523)
 Closed

[Bump github.com/labstack/echo/v4 from 4.1.17 to 4.2.1 in /instrumentation/github.com/labstack/echo/otelecho/example
open-o11y/opentelemetry-go-contrib#592](/open-o11y/opentelemetry-go-contrib/pull/592)
 Closed

[Bump github.com/labstack/echo/v4 from 4.1.17 to 4.2.1 in /instrumentation/github.com/labstack/echo/otelecho/example
evantorrie/opentelemetry-go-contrib#648](/evantorrie/opentelemetry-go-contrib/pull/648)
 Open

[Bump github.com/labstack/echo/v4 from 4.1.17 to 4.2.1 in /instrumentation/github.com/labstack/echo/otelecho/example
codeboten/opentelemetry-go-contrib#379](/codeboten/opentelemetry-go-contrib/pull/379)
 Closed

This was referenced Mar 14, 2021

[Bump github.com/labstack/echo/v4 from 4.1.17 to 4.2.1 in /instrumentation/github.com/labstack/echo/otelecho
evantorrie/contrib-orig#409](/evantorrie/contrib-orig/pull/409)
 Closed

[Bump github.com/labstack/echo/v4 from 4.1.17 to 4.2.1 in /instrumentation/github.com/labstack/echo/otelecho/example
evantorrie/contrib-orig#410](/evantorrie/contrib-orig/pull/410)
 Closed

[Bump github.com/labstack/echo/v4 from 4.1.17 to 4.2.1 in /instrumentation/github.com/labstack/echo/otelecho
codeboten/opentelemetry-go-contrib#380](/codeboten/opentelemetry-go-contrib/pull/380)
 Closed

[![@Kwstubbs](https://avatars.githubusercontent.com/u/11400619?s=40&v=4)](/Kwstubbs)
[Kwstubbs](/Kwstubbs)
mentioned this pull request
[Dec 15, 2022](#ref-pullrequest-1497821919)

[Go: Add and Modify Sanitizers For TaintedPath
github/codeql#11703](/github/codeql/pull/11703)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Flabstack%2Fecho%2Fpull%2F1718)

Reviewers

[![@tianxiaoliang](https://avatars.githubusercontent.com/u/1610890?s=40&v=4)](/tianxiaoliang) [tianxiaoliang](/tianxiaoliang)

tianxiaoliang approved these changes

[![@lammel](https://avatars.githubusercontent.com/u/43678?s=40&v=4)](/lammel) [lammel](/lammel)

lammel approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

8 participants

[![@little-cui](https://avatars.githubusercontent.com/u/23383427?s=52&v=4)](/little-cui) [![@iambenkay](https://avatars.githubusercontent.com/u/36256097?s=52&v=4)](/iambenkay) [![@aldas](https://avatars.githubusercontent.com/u/2320301?s=52&v=4)](/aldas) [![@lammel](https://avatars.githubusercontent.com/u/43678?s=52&v=4)](/lammel) [![@pafuent](https://avatars.githubusercontent.com/u/6979945?s=52&v=4)](/pafuent) [![@gurshafriri](https://avatars.githubusercontent.com/u/54314478?s=52&v=4)](/gurshafriri) [![@rvasilevsf](https://avatars.githubusercontent.com/u/43855753?s=52&v=4)](/rvasilevsf) [![@tianxiaoliang](https://avatars.githubusercontent.com/u/1610890?s=52&v=4)](/tianxiaoliang)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_405201f9_20250119_114054.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flabstack%2Fecho%2Fcommit%2F4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flabstack%2Fecho%2Fcommit%2F4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=labstack%2Fecho)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[labstack](/labstack)
/
**[echo](/labstack/echo)**
Public

* [Notifications](/login?return_to=%2Flabstack%2Fecho) You must be signed in to change notification settings
* [Fork
  2.2k](/login?return_to=%2Flabstack%2Fecho)
* [Star
   30.3k](/login?return_to=%2Flabstack%2Fecho)

* [Code](/labstack/echo)
* [Issues
  51](/labstack/echo/issues)
* [Pull requests
  26](/labstack/echo/pulls)
* [Discussions](/labstack/echo/discussions)
* [Actions](/labstack/echo/actions)
* [Projects
  0](/labstack/echo/projects)
* [Wiki](/labstack/echo/wiki)
* [Security](/labstack/echo/security)
* [Insights](/labstack/echo/pulse)

Additional navigation options

* [Code](/labstack/echo)
* [Issues](/labstack/echo/issues)
* [Pull requests](/labstack/echo/pulls)
* [Discussions](/labstack/echo/discussions)
* [Actions](/labstack/echo/actions)
* [Projects](/labstack/echo/projects)
* [Wiki](/labstack/echo/wiki)
* [Security](/labstack/echo/security)
* [Insights](/labstack/echo/pulse)

## Commit

[Permalink](/labstack/echo/commit/4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#1718](https://github.com/labstack/echo/pull/1718) from little-cui/master

[Browse files](/labstack/echo/tree/4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa)
Browse the repository at this point in the history

```
Fix static directory traversal security vulnerability for Windows
```

* Loading branch information

[![@lammel](https://avatars.githubusercontent.com/u/43678?s=40&v=4)](/lammel)

[lammel](/labstack/echo/commits?author=lammel "View all commits by lammel")
authored
Dec 15, 2020

2 parents
[e7741d4](/labstack/echo/commit/e7741d48b1cff8a5aa5e8c7d86f84bc7ecde582e)
+
[1beaf09](/labstack/echo/commit/1beaf09740e7e3ed4f6bfdd753121c03946a1142)

commit 4422e3b

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**99 additions**
and
**40 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* echo.go
  [echo.go](#diff-aba8ba313c6b989153f1f96e641a8e0e75313485d2e13d64378e70858d5a4669)
* echo\_test.go
  [echo\_test.go](#diff-0caa9b17082e51fb77d60507834cf5d937a77276f774b652f8262da947673332)
* middleware

  + middleware/static.go
    [static.go](#diff-bab9c7eacc29f88b5890041fb1910913ac0e973dad7b73e0d4a561fcc9d9d936)

## There are no files selected for viewing

3 changes: 1 addition & 2 deletions

3
[echo.go](#diff-aba8ba313c6b989153f1f96e641a8e0e75313485d2e13d64378e70858d5a4669 "echo.go")

Show comments

[View file](/labstack/echo/blob/4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa/echo.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -49,7 +49,6 @@ import ( |
|  |  | "net/http" |
|  |  | "net/url" |
|  |  | "os" |
|  |  | "path" |
|  |  | "path/filepath" |
|  |  | "reflect" |
|  |  | "runtime" |
| Expand Down  Expand Up | | @@ -486,7 +485,7 @@ func (common) static(prefix, root string, get func(string, HandlerFunc, ...Middl |
|  |  | return err |
|  |  | } |
|  |  |  |
|  |  | name := filepath.Join(root, path.Clean("/"+p)) // "/"+ for security |
|  |  | name := filepath.Join(root, filepath.Clean("/"+p)) // "/"+ for security |
|  |  | fi, err := os.Stat(name) |
|  |  | if err != nil { |
|  |  | // The access path does not exist |
| Expand Down | |  |

134 changes: 97 additions & 37 deletions

134
[echo\_test.go](#diff-0caa9b17082e51fb77d60507834cf5d937a77276f774b652f8262da947673332 "echo_test.go")

Show comments

[View file](/labstack/echo/blob/4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa/echo_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -60,45 +60,105 @@ func TestEcho(t \*testing.T) { |
|  |  | } |
|  |  |  |
|  |  | func TestEchoStatic(t \*testing.T) { |
|  |  | e := New() |
|  |  |  |
|  |  | assert := assert.New(t) |
|  |  |  |
|  |  | // OK |
|  |  | e.Static("/images", "\_fixture/images") |
|  |  | c, b := request(http.MethodGet, "/images/walle.png", e) |
|  |  | assert.Equal(http.StatusOK, c) |
|  |  | assert.NotEmpty(b) |
|  |  |  |
|  |  | // No file |
|  |  | e.Static("/images", "\_fixture/scripts") |
|  |  | c, \_ = request(http.MethodGet, "/images/bolt.png", e) |
|  |  | assert.Equal(http.StatusNotFound, c) |
|  |  |  |
|  |  | // Directory |
|  |  | e.Static("/images", "\_fixture/images") |
|  |  | c, \_ = request(http.MethodGet, "/images/", e) |
|  |  | assert.Equal(http.StatusNotFound, c) |
|  |  |  |
|  |  | // Directory Redirect |
|  |  | e.Static("/", "\_fixture") |
|  |  | req := httptest.NewRequest(http.MethodGet, "/folder", nil) |
|  |  | rec := httptest.NewRecorder() |
|  |  | e.ServeHTTP(rec, req) |
|  |  | assert.Equal(http.StatusMovedPermanently, rec.Code) |
|  |  | assert.Equal("/folder/", rec.HeaderMap["Location"][0]) |
|  |  |  |
|  |  | // Directory with index.html |
|  |  | e.Static("/", "\_fixture") |
|  |  | c, r := request(http.MethodGet, "/", e) |
|  |  | assert.Equal(http.StatusOK, c) |
|  |  | assert.Equal(true, strings.HasPrefix(r, "<!doctype html>")) |
|  |  | var testCases = []struct { |
|  |  | name string |
|  |  | givenPrefix string |
|  |  | givenRoot string |
|  |  | whenURL string |
|  |  | expectStatus int |
|  |  | expectHeaderLocation string |
|  |  | expectBodyStartsWith string |
|  |  | }{ |
|  |  | { |
|  |  | name: "ok", |
|  |  | givenPrefix: "/images", |
|  |  | givenRoot: "\_fixture/images", |
|  |  | whenURL: "/images/walle.png", |
|  |  | expectStatus: http.StatusOK, |
|  |  | expectBodyStartsWith: string([]byte{0x89, 0x50, 0x4e, 0x47}), |
|  |  | }, |
|  |  | { |
|  |  | name: "No file", |
|  |  | givenPrefix: "/images", |
|  |  | givenRoot: "\_fixture/scripts", |
|  |  | whenURL: "/images/bolt.png", |
|  |  | expectStatus: http.StatusNotFound, |
|  |  | expectBodyStartsWith: "{\"message\":\"Not Found\"}\n", |
|  |  | }, |
|  |  | { |
|  |  | name: "Directory", |
|  |  | givenPrefix: "/images", |
|  |  | givenRoot: "\_fixture/images", |
|  |  | whenURL: "/images/", |
|  |  | expectStatus: http.StatusNotFound, |
|  |  | expectBodyStartsWith: "{\"message\":\"Not Found\"}\n", |
|  |  | }, |
|  |  | { |
|  |  | name: "Directory Redirect", |
|  |  | givenPrefix: "/", |
|  |  | givenRoot: "\_fixture", |
|  |  | whenURL: "/folder", |
|  |  | expectStatus: http.StatusMovedPermanently, |
|  |  | expectHeaderLocation: "/folder/", |
|  |  | expectBodyStartsWith: "", |
|  |  | }, |
|  |  | { |
|  |  | name: "Directory with index.html", |
|  |  | givenPrefix: "/", |
|  |  | givenRoot: "\_fixture", |
|  |  | whenURL: "/", |
|  |  | expectStatus: http.StatusOK, |
|  |  | expectBodyStartsWith: "<!doctype html>", |
|  |  | }, |
|  |  | { |
|  |  | name: "Sub-directory with index.html", |
|  |  | givenPrefix: "/", |
|  |  | givenRoot: "\_fixture", |
|  |  | whenURL: "/folder/", |
|  |  | expectStatus: http.StatusOK, |
|  |  | expectBodyStartsWith: "<!doctype html>", |
|  |  | }, |
|  |  | { |
|  |  | name: "do not allow directory traversal (backslash - windows separator)", |
|  |  | givenPrefix: "/", |
|  |  | givenRoot: "\_fixture/", |
|  |  | whenURL: `/..\\middleware/basic\_auth.go`, |
|  |  | expectStatus: http.StatusNotFound, |
|  |  | expectBodyStartsWith: "{\"message\":\"Not Found\"}\n", |
|  |  | }, |
|  |  | { |
|  |  | name: "do not allow directory traversal (slash - unix separator)", |
|  |  | givenPrefix: "/", |
|  |  | givenRoot: "\_fixture/", |
|  |  | whenURL: `/../middleware/basic\_auth.go`, |
|  |  | expectStatus: http.StatusNotFound, |
|  |  | expectBodyStartsWith: "{\"message\":\"Not Found\"}\n", |
|  |  | }, |
|  |  | } |
|  |  |  |
|  |  | // Sub-directory with index.html |
|  |  | c, r = request(http.MethodGet, "/folder/", e) |
|  |  | assert.Equal(http.StatusOK, c) |
|  |  | assert.Equal(true, strings.HasPrefix(r, "<!doctype html>")) |
|  |  | for \_, tc := range testCases { |
|  |  | t.Run(tc.name, func(t \*testing.T) { |
|  |  | e := New() |
|  |  | e.Static(tc.givenPrefix, tc.givenRoot) |
|  |  | req := httptest.NewRequest(http.MethodGet, tc.whenURL, nil) |
|  |  | rec := httptest.NewRecorder() |
|  |  | e.ServeHTTP(rec, req) |
|  |  | assert.Equal(t, tc.expectStatus, rec.Code) |
|  |  | body := rec.Body.String() |
|  |  | if tc.expectBodyStartsWith != "" { |
|  |  | assert.True(t, strings.HasPrefix(body, tc.expectBodyStartsWith)) |
|  |  | } else { |
|  |  | assert.Equal(t, "", body) |
|  |  | } |
|  |  |  |
|  |  | if tc.expectHeaderLocation != "" { |
|  |  | assert.Equal(t, tc.expectHeaderLocation, rec.Result().Header["Location"][0]) |
|  |  | } else { |
|  |  | \_, ok := rec.Result().Header["Location"] |
|  |  | assert.False(t, ok) |
|  |  | } |
|  |  | }) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func TestEchoFile(t \*testing.T) { |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[middleware/static.go](#diff-bab9c7eacc29f88b5890041fb1910913ac0e973dad7b73e0d4a561fcc9d9d936 "middleware/static.go")

Show comments

[View file](/labstack/echo/blob/4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa/middleware/static.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -167,7 +167,7 @@ func StaticWithConfig(config StaticConfig) echo.MiddlewareFunc { |
|  |  | if err != nil { |
|  |  | return |
|  |  | } |
|  |  | name := filepath.Join(config.Root, path.Clean("/"+p)) // "/"+ for security |
|  |  | name := filepath.Join(config.Root, filepath.Clean("/"+p)) // "/"+ for security |
|  |  |  |
|  |  | if config.IgnoreBase { |
|  |  | routePath := path.Base(strings.TrimRight(c.Path(), "/\*")) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4422e3b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flabstack%2Fecho%2Fcommit%2F4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_cabb7ff8_20250119_132909.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-j453-hm5x-c46w)

**CVE-2020-36565**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-j453-hm5x-c46w)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2020-36565](/advisories/GHSA-j453-hm5x-c46w)

## Echo vulnerable to directory traversal

Moderate severity

GitHub Reviewed

Published
Dec 7, 2022
to the GitHub Advisory Database
•
Updated Jan 28, 2023

[Vulnerability details](/advisories/GHSA-j453-hm5x-c46w)
[Dependabot alerts
0](/advisories/GHSA-j453-hm5x-c46w/dependabot)

## Package

gomod

github.com/labstack/echo/v4
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

< 4.2.0

## Patched versions

4.2.0

## Description

Due to improper sanitization of user input on Windows, the static file handler allows for directory traversal, allowing an attacker to read files outside of the target directory that the server has permission to read.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-36565>
* [labstack/echo#1718](https://github.com/labstack/echo/pull/1718)
* [labstack/echo@4422e3b](https://github.com/labstack/echo/commit/4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa)
* <https://pkg.go.dev/vuln/GO-2021-0051>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-36565)
Dec 7, 2022

Published to the GitHub Advisory Database
Dec 7, 2022

Reviewed
Dec 7, 2022

Last updated
Jan 28, 2023

### Severity

Moderate

5.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
Low

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

### [EPSS score](https://www.first.org/epss/user-guide)

0.080%
 (37th percentile)

### Weaknesses

[CWE-22](/advisories?query=cwe%3A22)

### CVE ID

CVE-2020-36565

### GHSA ID

GHSA-j453-hm5x-c46w

### Source code

[labstack/echo](https://github.com/labstack/echo)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-j453-hm5x-c46w/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a56130a9_20250119_132910.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flabstack%2Fecho%2Fcommit%2F4422e3b66b9fd498e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flabstack%2Fecho%2Fcommit%2F4422e3b66b9fd498e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=labstack%2Fecho)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[labstack](/labstack)
/
**[echo](/labstack/echo)**
Public

* [Notifications](/login?return_to=%2Flabstack%2Fecho) You must be signed in to change notification settings
* [Fork
  2.2k](/login?return_to=%2Flabstack%2Fecho)
* [Star
   30.3k](/login?return_to=%2Flabstack%2Fecho)

* [Code](/labstack/echo)
* [Issues
  51](/labstack/echo/issues)
* [Pull requests
  26](/labstack/echo/pulls)
* [Discussions](/labstack/echo/discussions)
* [Actions](/labstack/echo/actions)
* [Projects
  0](/labstack/echo/projects)
* [Wiki](/labstack/echo/wiki)
* [Security](/labstack/echo/security)
* [Insights](/labstack/echo/pulse)

Additional navigation options

* [Code](/labstack/echo)
* [Issues](/labstack/echo/issues)
* [Pull requests](/labstack/echo/pulls)
* [Discussions](/labstack/echo/discussions)
* [Actions](/labstack/echo/actions)
* [Projects](/labstack/echo/projects)
* [Wiki](/labstack/echo/wiki)
* [Security](/labstack/echo/security)
* [Insights](/labstack/echo/pulse)

## Commit

[Permalink](/labstack/echo/commit/4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#1718](https://github.com/labstack/echo/pull/1718) from little-cui/master

[Browse files](/labstack/echo/tree/4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa)
Browse the repository at this point in the history

```
Fix static directory traversal security vulnerability for Windows
```

* Loading branch information

[![@lammel](https://avatars.githubusercontent.com/u/43678?s=40&v=4)](/lammel)

[lammel](/labstack/echo/commits?author=lammel "View all commits by lammel")
authored
Dec 15, 2020

2 parents
[e7741d4](/labstack/echo/commit/e7741d48b1cff8a5aa5e8c7d86f84bc7ecde582e)
+
[1beaf09](/labstack/echo/commit/1beaf09740e7e3ed4f6bfdd753121c03946a1142)

commit 4422e3b

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**99 additions**
and
**40 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* echo.go
  [echo.go](#diff-aba8ba313c6b989153f1f96e641a8e0e75313485d2e13d64378e70858d5a4669)
* echo\_test.go
  [echo\_test.go](#diff-0caa9b17082e51fb77d60507834cf5d937a77276f774b652f8262da947673332)
* middleware

  + middleware/static.go
    [static.go](#diff-bab9c7eacc29f88b5890041fb1910913ac0e973dad7b73e0d4a561fcc9d9d936)

## There are no files selected for viewing

3 changes: 1 addition & 2 deletions

3
[echo.go](#diff-aba8ba313c6b989153f1f96e641a8e0e75313485d2e13d64378e70858d5a4669 "echo.go")

Show comments

[View file](/labstack/echo/blob/4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa/echo.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -49,7 +49,6 @@ import ( |
|  |  | "net/http" |
|  |  | "net/url" |
|  |  | "os" |
|  |  | "path" |
|  |  | "path/filepath" |
|  |  | "reflect" |
|  |  | "runtime" |
| Expand Down  Expand Up | | @@ -486,7 +485,7 @@ func (common) static(prefix, root string, get func(string, HandlerFunc, ...Middl |
|  |  | return err |
|  |  | } |
|  |  |  |
|  |  | name := filepath.Join(root, path.Clean("/"+p)) // "/"+ for security |
|  |  | name := filepath.Join(root, filepath.Clean("/"+p)) // "/"+ for security |
|  |  | fi, err := os.Stat(name) |
|  |  | if err != nil { |
|  |  | // The access path does not exist |
| Expand Down | |  |

134 changes: 97 additions & 37 deletions

134
[echo\_test.go](#diff-0caa9b17082e51fb77d60507834cf5d937a77276f774b652f8262da947673332 "echo_test.go")

Show comments

[View file](/labstack/echo/blob/4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa/echo_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -60,45 +60,105 @@ func TestEcho(t \*testing.T) { |
|  |  | } |
|  |  |  |
|  |  | func TestEchoStatic(t \*testing.T) { |
|  |  | e := New() |
|  |  |  |
|  |  | assert := assert.New(t) |
|  |  |  |
|  |  | // OK |
|  |  | e.Static("/images", "\_fixture/images") |
|  |  | c, b := request(http.MethodGet, "/images/walle.png", e) |
|  |  | assert.Equal(http.StatusOK, c) |
|  |  | assert.NotEmpty(b) |
|  |  |  |
|  |  | // No file |
|  |  | e.Static("/images", "\_fixture/scripts") |
|  |  | c, \_ = request(http.MethodGet, "/images/bolt.png", e) |
|  |  | assert.Equal(http.StatusNotFound, c) |
|  |  |  |
|  |  | // Directory |
|  |  | e.Static("/images", "\_fixture/images") |
|  |  | c, \_ = request(http.MethodGet, "/images/", e) |
|  |  | assert.Equal(http.StatusNotFound, c) |
|  |  |  |
|  |  | // Directory Redirect |
|  |  | e.Static("/", "\_fixture") |
|  |  | req := httptest.NewRequest(http.MethodGet, "/folder", nil) |
|  |  | rec := httptest.NewRecorder() |
|  |  | e.ServeHTTP(rec, req) |
|  |  | assert.Equal(http.StatusMovedPermanently, rec.Code) |
|  |  | assert.Equal("/folder/", rec.HeaderMap["Location"][0]) |
|  |  |  |
|  |  | // Directory with index.html |
|  |  | e.Static("/", "\_fixture") |
|  |  | c, r := request(http.MethodGet, "/", e) |
|  |  | assert.Equal(http.StatusOK, c) |
|  |  | assert.Equal(true, strings.HasPrefix(r, "<!doctype html>")) |
|  |  | var testCases = []struct { |
|  |  | name string |
|  |  | givenPrefix string |
|  |  | givenRoot string |
|  |  | whenURL string |
|  |  | expectStatus int |
|  |  | expectHeaderLocation string |
|  |  | expectBodyStartsWith string |
|  |  | }{ |
|  |  | { |
|  |  | name: "ok", |
|  |  | givenPrefix: "/images", |
|  |  | givenRoot: "\_fixture/images", |
|  |  | whenURL: "/images/walle.png", |
|  |  | expectStatus: http.StatusOK, |
|  |  | expectBodyStartsWith: string([]byte{0x89, 0x50, 0x4e, 0x47}), |
|  |  | }, |
|  |  | { |
|  |  | name: "No file", |
|  |  | givenPrefix: "/images", |
|  |  | givenRoot: "\_fixture/scripts", |
|  |  | whenURL: "/images/bolt.png", |
|  |  | expectStatus: http.StatusNotFound, |
|  |  | expectBodyStartsWith: "{\"message\":\"Not Found\"}\n", |
|  |  | }, |
|  |  | { |
|  |  | name: "Directory", |
|  |  | givenPrefix: "/images", |
|  |  | givenRoot: "\_fixture/images", |
|  |  | whenURL: "/images/", |
|  |  | expectStatus: http.StatusNotFound, |
|  |  | expectBodyStartsWith: "{\"message\":\"Not Found\"}\n", |
|  |  | }, |
|  |  | { |
|  |  | name: "Directory Redirect", |
|  |  | givenPrefix: "/", |
|  |  | givenRoot: "\_fixture", |
|  |  | whenURL: "/folder", |
|  |  | expectStatus: http.StatusMovedPermanently, |
|  |  | expectHeaderLocation: "/folder/", |
|  |  | expectBodyStartsWith: "", |
|  |  | }, |
|  |  | { |
|  |  | name: "Directory with index.html", |
|  |  | givenPrefix: "/", |
|  |  | givenRoot: "\_fixture", |
|  |  | whenURL: "/", |
|  |  | expectStatus: http.StatusOK, |
|  |  | expectBodyStartsWith: "<!doctype html>", |
|  |  | }, |
|  |  | { |
|  |  | name: "Sub-directory with index.html", |
|  |  | givenPrefix: "/", |
|  |  | givenRoot: "\_fixture", |
|  |  | whenURL: "/folder/", |
|  |  | expectStatus: http.StatusOK, |
|  |  | expectBodyStartsWith: "<!doctype html>", |
|  |  | }, |
|  |  | { |
|  |  | name: "do not allow directory traversal (backslash - windows separator)", |
|  |  | givenPrefix: "/", |
|  |  | givenRoot: "\_fixture/", |
|  |  | whenURL: `/..\\middleware/basic\_auth.go`, |
|  |  | expectStatus: http.StatusNotFound, |
|  |  | expectBodyStartsWith: "{\"message\":\"Not Found\"}\n", |
|  |  | }, |
|  |  | { |
|  |  | name: "do not allow directory traversal (slash - unix separator)", |
|  |  | givenPrefix: "/", |
|  |  | givenRoot: "\_fixture/", |
|  |  | whenURL: `/../middleware/basic\_auth.go`, |
|  |  | expectStatus: http.StatusNotFound, |
|  |  | expectBodyStartsWith: "{\"message\":\"Not Found\"}\n", |
|  |  | }, |
|  |  | } |
|  |  |  |
|  |  | // Sub-directory with index.html |
|  |  | c, r = request(http.MethodGet, "/folder/", e) |
|  |  | assert.Equal(http.StatusOK, c) |
|  |  | assert.Equal(true, strings.HasPrefix(r, "<!doctype html>")) |
|  |  | for \_, tc := range testCases { |
|  |  | t.Run(tc.name, func(t \*testing.T) { |
|  |  | e := New() |
|  |  | e.Static(tc.givenPrefix, tc.givenRoot) |
|  |  | req := httptest.NewRequest(http.MethodGet, tc.whenURL, nil) |
|  |  | rec := httptest.NewRecorder() |
|  |  | e.ServeHTTP(rec, req) |
|  |  | assert.Equal(t, tc.expectStatus, rec.Code) |
|  |  | body := rec.Body.String() |
|  |  | if tc.expectBodyStartsWith != "" { |
|  |  | assert.True(t, strings.HasPrefix(body, tc.expectBodyStartsWith)) |
|  |  | } else { |
|  |  | assert.Equal(t, "", body) |
|  |  | } |
|  |  |  |
|  |  | if tc.expectHeaderLocation != "" { |
|  |  | assert.Equal(t, tc.expectHeaderLocation, rec.Result().Header["Location"][0]) |
|  |  | } else { |
|  |  | \_, ok := rec.Result().Header["Location"] |
|  |  | assert.False(t, ok) |
|  |  | } |
|  |  | }) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func TestEchoFile(t \*testing.T) { |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[middleware/static.go](#diff-bab9c7eacc29f88b5890041fb1910913ac0e973dad7b73e0d4a561fcc9d9d936 "middleware/static.go")

Show comments

[View file](/labstack/echo/blob/4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa/middleware/static.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -167,7 +167,7 @@ func StaticWithConfig(config StaticConfig) echo.MiddlewareFunc { |
|  |  | if err != nil { |
|  |  | return |
|  |  | } |
|  |  | name := filepath.Join(config.Root, path.Clean("/"+p)) // "/"+ for security |
|  |  | name := filepath.Join(config.Root, filepath.Clean("/"+p)) // "/"+ for security |
|  |  |  |
|  |  | if config.IgnoreBase { |
|  |  | routePath := path.Base(strings.TrimRight(c.Path(), "/\*")) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4422e3b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flabstack%2Fecho%2Fcommit%2F4422e3b66b9fd498e) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from pkg.go.dev_45f5ed10_20250119_114057.html ===


[![Go](/static/shared/logo/go-white.svg)](https://go.dev/)
 [Skip to Main Content](#main-content)

![](/static/shared/icon/search_gm_grey_24dp.svg)

![](/static/shared/icon/search_gm_grey_24dp.svg)

* Why Go
  ![submenu dropdown icon](/static/shared/icon/arrow_drop_down_gm_grey_24dp.svg)
  + [Case Studies](https://go.dev/solutions#case-studies)

    Common problems companies solve with Go
  + [Use Cases](https://go.dev/solutions#use-cases)

    Stories about how and why companies use Go
  + [Security Policy](https://go.dev/security/policy/)

    How Go can help keep you secure by default
* [Learn](https://go.dev/learn/)
* Docs
  ![submenu dropdown icon](/static/shared/icon/arrow_drop_down_gm_grey_24dp.svg)
  + [Effective Go](https://go.dev/doc/effective_go)

    Tips for writing clear, performant, and idiomatic Go code
  + [Go User Manual](https://go.dev/doc/)

    A complete introduction to building software with Go
  + [Standard library](https://pkg.go.dev/std)

    Reference documentation for Go's standard library
  + [Release Notes](https://go.dev/doc/devel/release)

    Learn what's new in each Go release
* [Packages](/)
* Community
  ![submenu dropdown icon](/static/shared/icon/arrow_drop_down_gm_grey_24dp.svg)
  + [Recorded Talks](https://go.dev/talks/)

    Videos from prior events
  + [Meetups
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://www.meetup.com/pro/go)

    Meet other local Go developers
  + [Conferences
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://github.com/golang/go/wiki/Conferences)

    Learn and network with Go developers from around the world
  + [Go blog](https://go.dev/blog)

    The Go project's official blog.
  + [Go project](https://go.dev/help)

    Get help and stay informed from Go
  + Get connected
    [![](/static/shared/logo/social/google-groups.svg)](https://groups.google.com/g/golang-nuts "Get connected with google-groups (Opens in new window)")
    [![](/static/shared/logo/social/github.svg)](https://github.com/golang "Get connected with github (Opens in new window)")
    [![](/static/shared/logo/social/twitter.svg)](https://twitter.com/golang "Get connected with twitter (Opens in new window)")
    [![](/static/shared/logo/social/reddit.svg)](https://www.reddit.com/r/golang/ "Get connected with reddit (Opens in new window)")
    [![](/static/shared/logo/social/slack.svg)](https://invite.slack.golangbridge.org/ "Get connected with slack (Opens in new window)")
    [![](/static/shared/logo/social/stack-overflow.svg)](https://stackoverflow.com/collectives/go)

[![Go.](/static/shared/logo/go-blue.svg)](https://go.dev/)

* Why Go
  *![](/static/shared/icon/navigate_next_gm_grey_24dp.svg)*
  *![](/static/shared/icon/navigate_before_gm_grey_24dp.svg)*
  Why Go
  + [Case Studies](https://go.dev/solutions#case-studies)
  + [Use Cases](https://go.dev/solutions#use-cases)
  + [Security Policy](https://go.dev/security/policy/)
* [Learn](https://go.dev/learn/)
* Docs
  *![](/static/shared/icon/navigate_next_gm_grey_24dp.svg)*
  *![](/static/shared/icon/navigate_before_gm_grey_24dp.svg)*
  Docs
  + [Effective Go](https://go.dev/doc/effective_go)
  + [Go User Manual](https://go.dev/doc/)
  + [Standard library](https://pkg.go.dev/std)
  + [Release Notes](https://go.dev/doc/devel/release)
* [Packages](/)
* Community
  *![](/static/shared/icon/navigate_next_gm_grey_24dp.svg)*
  *![](/static/shared/icon/navigate_before_gm_grey_24dp.svg)*
  Community
  + [Recorded Talks](https://go.dev/talks/)
  + [Meetups
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://www.meetup.com/pro/go)
  + [Conferences
    *![](/static/shared/icon/launch_gm_grey_24dp.svg)*](https://github.com/golang/go/wiki/Conferences)
  + [Go blog](https://go.dev/blog)
  + [Go project](https://go.dev/help)
  + Get connected
    [![](/static/shared/logo/social/google-groups.svg)](https://groups.google.com/g/golang-nuts)
    [![](/static/shared/logo/social/github.svg)](https://github.com/golang)
    [![](/static/shared/logo/social/twitter.svg)](https://twitter.com/golang)
    [![](/static/shared/logo/social/reddit.svg)](https://www.reddit.com/r/golang/)
    [![](/static/shared/logo/social/slack.svg)](https://invite.slack.golangbridge.org/)
    [![](/static/shared/logo/social/stack-overflow.svg)](https://stackoverflow.com/collectives/go)

1. [Vulnerability Database](/vuln)
2. [All Reports](/vuln/list)
3. GO-2021-0051

# Vulnerability Report: GO-2021-0051

* CVE-2020-36565, GHSA-j453-hm5x-c46w
* Affects:
  github.com/labstack/echo/v4
* Published: Apr 14, 2021
* Modified: May 20, 2024

Due to improper sanitization of user input on Windows, the static file handler allows for directory traversal, allowing an attacker to read files outside of the target directory that the server has permission to read.

## Affected Packages

* Path
  Go Versions
  Symbols
* [github.com/labstack/echo/v4](/github.com/labstack/echo/v4)
  before v4.1.18-0.20201215153152-4422e3b66b9f
  + [Echo.Static](/github.com/labstack/echo/v4#Echo.Static)
  + [Group.Static](/github.com/labstack/echo/v4#Group.Static)

## Aliases

* [CVE-2020-36565](https://www.cve.org/CVERecord?id=CVE-2020-36565)
* [GHSA-j453-hm5x-c46w](https://github.com/advisories/GHSA-j453-hm5x-c46w)

## References

* <https://github.com/labstack/echo/pull/1718>
* <https://github.com/labstack/echo/commit/4422e3b66b9fd498ed1ae1d0242d660d0ed3faaa>
* <https://vuln.go.dev/ID/GO-2021-0051.json>

## Credits

* @little-cui (Apache ServiceComb)

## Feedback

See anything missing or incorrect?
[Suggest an edit to this report.](https://github.com/golang/vulndb/issues/new?assignees=&labels=Needs+Triage%2CSuggested+Edit&template=suggest_edit.yaml&title=x%2Fvulndb%3A+suggestion+regarding+GO-2021-0051&report=GO-2021-0051)

[Why Go](https://go.dev/solutions)
[Use Cases](https://go.dev/solutions#use-cases)
[Case Studies](https://go.dev/solutions#case-studies)

[Get Started](https://learn.go.dev/)
[Playground](https://play.golang.org)
[Tour](https://tour.golang.org)
[Stack Overflow](https://stackoverflow.com/questions/tagged/go?tab=Newest)
[Help](https://go.dev/help)

[Packages](https://pkg.go.dev)
[Standard Library](/std)
[Sub-repositories](/golang.org/x)
[About Go Packages](https://pkg.go.dev/about)

[About](https://go.dev/project)
[Download](https://go.dev/dl/)
[Blog](https://go.dev/blog)
[Issue Tracker](https://github.com/golang/go/issues)
[Release Notes](https://go.dev/doc/devel/release.html)
[Brand Guidelines](https://blog.golang.org/go-brand)
[Code of Conduct](https://go.dev/conduct)

[Connect](https://www.twitter.com/golang)
[Twitter](https://www.twitter.com/golang)
[GitHub](https://github.com/golang)
[Slack](https://invite.slack.golangbridge.org/)
[r/golang](https://reddit.com/r/golang)
[Meetup](https://www.meetup.com/pro/go)
[Golang Weekly](https://golangweekly.com/)

![Gopher in flight goggles](/static/shared/gopher/pilot-bust-1431x901.svg)

* [Copyright](https://go.dev/copyright)
* [Terms of Service](https://go.dev/tos)
* [Privacy Policy](http://www.google.com/intl/en/policies/privacy/)
* [Report an Issue](https://go.dev/s/pkgsite-feedback)
* ![System theme](/static/shared/icon/brightness_6_gm_grey_24dp.svg)
  ![Dark theme](/static/shared/icon/brightness_2_gm_grey_24dp.svg)
  ![Light theme](/static/shared/icon/light_mode_gm_grey_24dp.svg)

  Theme Toggle
* ![](/static/shared/icon/keyboard_grey_24dp.svg)

  Shortcuts Modal

[![Google logo](/static/shared/logo/google-white.svg)](https://google.com)

## Jump to

![](/static/shared/icon/close_gm_grey_24dp.svg)

Close

## Keyboard shortcuts

![](/static/shared/icon/close_gm_grey_24dp.svg)

| **?** | : This menu |
| --- | --- |
| **/** | : Search site |
| **f** or **F** | : Jump to |
| **y** or **Y** | : Canonical URL |

Close

go.dev uses cookies from Google to deliver and enhance the quality of its services and to
analyze traffic. [Learn more.](https://policies.google.com/technologies/cookies)
Okay


