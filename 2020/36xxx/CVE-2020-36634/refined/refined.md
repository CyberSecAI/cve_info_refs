The provided content is related to CVE-2020-36634.

**Root cause of vulnerability:**
The vulnerability stems from the use of unescaped characters in the rendered n-gram indexes JSON, which could lead to Cross-Site Scripting (XSS) attacks. The original code constructed n-gram indexes using `Variable.getIndexableNames()`, which allowed arbitrary characters that could be interpreted as HTML/Javascript when rendered on a web page, without proper escaping or sanitization.

**Weaknesses/vulnerabilities present:**
- Cross-Site Scripting (XSS): The primary vulnerability is XSS due to the lack of proper escaping of variable names when building n-gram indexes. These indexes are then included in the JSON response, which can be rendered in a web page.
- Unsanitized input: The code uses variable names directly to build n-gram indexes without sanitizing special characters that could be interpreted as HTML or Javascript.

**Impact of exploitation:**
- An attacker could inject malicious scripts into the web page by crafting a variable name that contains HTML or JavaScript code. When the web page displays the n-gram index derived from the malicious variable name, the injected script could be executed in the user's browser.
- This could lead to various malicious activities such as stealing cookies, redirecting users to malicious websites, defacing web pages, or performing other actions on behalf of the user.

**Attack vectors:**
- Maliciously crafted variable names: An attacker would need to have control over the exported variables, specifically their names, such that the generated n-gram indexes contain malicious payloads.
- The vulnerable code is used in a web servlet (`ViewExportedVariablesServlet`), so the attack is likely through HTTP requests that retrieve and render the exported variables.

**Required attacker capabilities/position:**
- The attacker needs the ability to influence the names of the variables being exported through the `VarExporter`.
- They also need to be able to view the output of the `ViewExportedVariablesServlet` which is rendered on a web page.

**Mitigation:**
The vulnerability was mitigated by explicitly building alphanumeric n-gram indexes using the `alphanumericNGrams` function and `buildAlphanumericNGramIndex` function. This approach ensures that only alphanumeric characters are used in the n-gram index, preventing the injection of potentially malicious code into the generated JSON. The code change includes:
1.  **Deprecating `Variable.getIndexableNames()`:** The method that returned unescaped names is deprecated.
2.  **`alphanumericNGrams` function:** A new function is introduced that splits variable names into alphanumeric substrings, and then generates n-grams.
3.  **`buildAlphanumericNGramIndex` function:** A new function to generate n-grams using the `alphanumericNGrams` function to ensure only alphanumeric characters are indexed.
4.  **Modifying `alphanumericNGramIndexesJSON` function**: This function now uses `buildAlphanumericNGramIndex` instead of `buildNGramIndex` to prevent XSS by only using alphanumeric characters in the generated JSON.