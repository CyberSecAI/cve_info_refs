=== Content from github.com_f09b4fce_20250119_112500.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftherealunicornsecurity%2Ftherealunicornsecurity.github.io%2Fblob%2Fmaster%2F_posts%2F2020-10-11-TPLink.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftherealunicornsecurity%2Ftherealunicornsecurity.github.io%2Fblob%2Fmaster%2F_posts%2F2020-10-11-TPLink.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=therealunicornsecurity%2Ftherealunicornsecurity.github.io)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[therealunicornsecurity](/therealunicornsecurity)
/
**[therealunicornsecurity.github.io](/therealunicornsecurity/therealunicornsecurity.github.io)**
Public

forked from [barryclark/jekyll-now](/barryclark/jekyll-now)

* [Notifications](/login?return_to=%2Ftherealunicornsecurity%2Ftherealunicornsecurity.github.io) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2Ftherealunicornsecurity%2Ftherealunicornsecurity.github.io)
* [Star
   16](/login?return_to=%2Ftherealunicornsecurity%2Ftherealunicornsecurity.github.io)

* [Code](/therealunicornsecurity/therealunicornsecurity.github.io)
* [Pull requests
  0](/therealunicornsecurity/therealunicornsecurity.github.io/pulls)
* [Actions](/therealunicornsecurity/therealunicornsecurity.github.io/actions)
* [Projects
  0](/therealunicornsecurity/therealunicornsecurity.github.io/projects)
* [Security](/therealunicornsecurity/therealunicornsecurity.github.io/security)
* [Insights](/therealunicornsecurity/therealunicornsecurity.github.io/pulse)

Additional navigation options

* [Code](/therealunicornsecurity/therealunicornsecurity.github.io)
* [Pull requests](/therealunicornsecurity/therealunicornsecurity.github.io/pulls)
* [Actions](/therealunicornsecurity/therealunicornsecurity.github.io/actions)
* [Projects](/therealunicornsecurity/therealunicornsecurity.github.io/projects)
* [Security](/therealunicornsecurity/therealunicornsecurity.github.io/security)
* [Insights](/therealunicornsecurity/therealunicornsecurity.github.io/pulse)

## Files

 master
## Breadcrumbs

1. [therealunicornsecurity.github.io](/therealunicornsecurity/therealunicornsecurity.github.io/tree/master)
2. /[\_posts](/therealunicornsecurity/therealunicornsecurity.github.io/tree/master/_posts)
/
# 2020-10-11-TPLink.md

Copy path Blame  Blame
## Latest commit

## History

[History](/therealunicornsecurity/therealunicornsecurity.github.io/commits/master/_posts/2020-10-11-TPLink.md)370 lines (314 loc) · 17.4 KB master
## Breadcrumbs

1. [therealunicornsecurity.github.io](/therealunicornsecurity/therealunicornsecurity.github.io/tree/master)
2. /[\_posts](/therealunicornsecurity/therealunicornsecurity.github.io/tree/master/_posts)
/
# 2020-10-11-TPLink.md

Top
## File metadata and controls

* Preview
* Code
* Blame

370 lines (314 loc) · 17.4 KB[Raw](https://github.com/therealunicornsecurity/therealunicornsecurity.github.io/raw/refs/heads/master/_posts/2020-10-11-TPLink.md)

| layout | tags | title |
| --- | --- | --- |
| post | system hardware reverse crypto | Reversing TL-WR840N |

Buying cheap routers to find vulnerabilities in them

[![](/therealunicornsecurity/therealunicornsecurity.github.io/raw/master/_posts/{{ site.baseurl }}/icons/system.png "system")](/therealunicornsecurity/therealunicornsecurity.github.io/blob/master/tags#system)
[![](/therealunicornsecurity/therealunicornsecurity.github.io/raw/master/_posts/{{ site.baseurl }}/icons/hardware.png "hardware")](/therealunicornsecurity/therealunicornsecurity.github.io/blob/master/tags#hardware)
[![](/therealunicornsecurity/therealunicornsecurity.github.io/raw/master/_posts/{{ site.baseurl }}/icons/reverse.png "reverse")](/therealunicornsecurity/therealunicornsecurity.github.io/blob/master/tags#reverse)
[![](/therealunicornsecurity/therealunicornsecurity.github.io/raw/master/_posts/{{ site.baseurl }}/icons/crypto.png "crypto")](/therealunicornsecurity/therealunicornsecurity.github.io/blob/master/tags#crypto)

{:refdef: style="text-align: center;"}
![\_config.yml]({{ site.baseurl }}/images/tplink/router.jpg)
{: refdef}

# Part 1: Acquiring the firmware

TP Link firmwares are easy to get as they are free to download online:
<https://www.tp-link.com/in/support/download/tl-wr840n/>
But that is a bit too easy isn't it ? Is there another way to get it ?

[![](/therealunicornsecurity/therealunicornsecurity.github.io/raw/master/images/tplink/serial.jpg)](/therealunicornsecurity/therealunicornsecurity.github.io/blob/master/images/tplink/serial.jpg)

Most of these devices have a serial port for debugging. Connecting to it should be trivial using a USB to UART adapter:

[![](/therealunicornsecurity/therealunicornsecurity.github.io/raw/master/images/tplink/usbuart.jpg)](/therealunicornsecurity/therealunicornsecurity.github.io/blob/master/images/tplink/usbuart.jpg)

Using this, you could potentially interrupt the boot sequence and enter a low-level shell that would allow you to do things like read the EEPROM chip at different offsets. Of course, if the goal is to easily get the firmware (over several hours because of the baud rate), then you've won !
But, still no thanks. I wanted to try something new:

[![](/therealunicornsecurity/therealunicornsecurity.github.io/raw/master/images/tplink/desolder.jpg)](/therealunicornsecurity/therealunicornsecurity.github.io/blob/master/images/tplink/desolder.jpg)

Desoldering the EEPROM that contains the firmware was my way. If you are looking for a good reason to chose this way rather than any of the aformentioned ones, there isn't. I had just recently acquired a TL866II+, and wanted to have fun with it !
So the chip perfectly fits in the 200mm SOP8 adapter:

[![](/therealunicornsecurity/therealunicornsecurity.github.io/raw/master/images/tplink/tl866.jpg)](/therealunicornsecurity/therealunicornsecurity.github.io/blob/master/images/tplink/tl866.jpg)

But before being able to read from it, we need to identify which kind of chip it is:

[![](/therealunicornsecurity/therealunicornsecurity.github.io/raw/master/images/tplink/eeprom.jpg)](/therealunicornsecurity/therealunicornsecurity.github.io/blob/master/images/tplink/eeprom.jpg)

We can read AH1903 25Q32CS1G, and the logo is Giga Device.
By looking for GD25Q32 in the list of devices supported by minipro, we get this: GD25Q32 @SOP8. We then dump the firmware using the Linux fork of the minipro tool, available here: <https://gitlab.com/DavidGriffith/minipro/>
using the command line

```
root@kali:~# minipro -p GD25Q32 -r firmware.bin
Found TL866II+ 04.2.86 (0x256)
Warning: Firmware is out of date.
  Expected  04.2.118 (0x276)
  Found     04.2.86 (0x256)
Chip ID OK: 0xC84016
Reading Code...  6.99Sec  OK
```

Works like a charm!

# Part 2: Reversing the firmware

The file is 4Mb large, and contains the following signatures:

```
root@kali:~# binwalk firmware.bin

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
53488         0xD0F0          U-Boot version string, "U-Boot 1.1.3 (Jun 14 2018 - 11:06:28)"
66048         0x10200         LZMA compressed data, properties: 0x5D, dictionary size: 8388608 bytes, uncompressed size: 2986732 bytes
1048576       0x100000        Squashfs filesystem, little endian, version 4.0, compression:xz, size: 2955905 bytes, 610 inodes, blocksize: 262144 bytes, created: 2018-06-14 03:15:45
4063248       0x3E0010        XML document, version: "1.0"
```

We are mostly interested in the **squashfs**, as it contains the router's filesystem. But, we also can see that the bootloader code starts at 0xD0F0, so there may be something interesting stored at the beginning of the firmware.

All the binaries are compiled for **MIPS**, that is the most common architecture for routers.
The /etc folder contains several interesting files. Notably, two encrypted XML files, *default\_config.xml* and *reduced\_data\_model.xml*. By searching for these filenames inside the whole squashfs, we get one interesting match: **libcmm.so**.

Compiled code referencing encrypted files might be actually decrypting them, so we disassemble the shared object library using Ghidra.

```
int dm_decryptFile(uint param_1,undefined4 param_2,uint param_3,int param_4)

{
  int iVar1;
  char acStack40 [8];
  int local_20;

  memcpy(acStack40,&encryption_key,8);
  if (param_3 < param_1) {
    cdbg_printf(8,"dm_decryptFile",0xb83,
                "Buffer exceeded, decrypt buf size is %u, but dm file size is %u",param_3,param_1);
    local_20 = 0;
  }
  else {
    local_20 = cen_desMinDo(param_2,param_1,param_4,param_3,acStack40,0);
    iVar1 = local_20;
    if (local_20 == 0) {
      cdbg_printf(8,"dm_decryptFile",0xb8a,"DES decrypt error\n");
    }
    else {
      do {
        local_20 = iVar1;
        if (((undefined *)(param_4 + local_20))[-1] != '\0') break;
        iVar1 = local_20 + -1;
      } while (local_20 != 0);
      *(undefined *)(param_4 + local_20) = 0;
    }
  }
  return local_20;
}
```

If that ain't luck...

We have all the symbols! This makes the task much easier. So I renamed the *&encryption\_key* pointer, but you can easily see that the code is:

1. Copying an 8 bytes array in a local buffer (DES key sizes are 7+1 for parity)
2. Calling *cen\_desMinDo* which comes from **libcutil.so**, and is a wrapper for DES encryption functions

So we quickly get to the results using:

```
openssl enc -d -des-ecb -nopad -K XXXXXXXXXXXXXXXX -in default_config.xml > default_config_decrypted.xml
```

Of course, in this XML file, we expect to find loot, like:

```
    <StorageService>
    <UserAccount instance=1 >
    <Enable val=1 />
    <Username val=admin />
    <Password val=admin />
    <X_TP_Reference val=0 />
    <X_TP_SupperUser val=1 />
    </UserAccount>
```

We like those default credentials a lot, but they are usually widely known and/or documented (especially for cheap routers), so nothing very shocking here. The other file, reduced\_data\_model\_decrypted.xml, contains the same kind of credentials and information, but this time they are models for the global configuration scheme.

Another intersting thing in /etc folder: **shadow doesn't exist**

The passwords are stored the old way, in the passwd file:

```
admin:$1$$iC.dUsGpxNNJGeOm1dFio/:0:0:root:/:/bin/sh
dropbear:x:500:500:dropbear:/var/dropbear:/bin/sh
nobody:*:0:0:nobody:/:/bin/sh

```

So *admin* seems to have a $1 (MD5) password. Let's see what hashcat thinks about this:

```
root@kali:~# hashcat -a 0 -m 500 hash /usr/share/wordlists/rockyou.txt

$1$$iC.dUsGpxNNJGeOm1dFio/:1234

Session..........: hashcat
Status...........: Cracked
Hash.Name........: md5crypt, MD5 (Unix), Cisco-IOS $1$ (MD5)
Hash.Target......: $1$$iC.dUsGpxNNJGeOm1dFio/
Time.Started.....: Wed Oct 28 14:10:47 2020 (1 sec)
Time.Estimated...: Wed Oct 28 14:10:48 2020 (0 secs)
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:     3279 H/s (11.38ms) @ Accel:256 Loops:125 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests
Progress.........: 3072/14344385 (0.02%)
Rejected.........: 0/3072 (0.00%)
Restore.Point....: 0/14344385 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:875-1000
Candidates.#1....: 123456 -> dangerous
```

admin:1234 is the root's password of the router. You could use these credentials to connect through the serial port for example. Of course, we were not really expecting complicated passwords as defaults credentials.

You could also get the default credentials by visiting <https://www.tp-link.com/us/support/faq/191>

But why doing things simply.

# Part 3: Dropbear

Another interesting user here is dropbear. It is a lightweight ssh server for embedded systems, and it could allow a user to authenticate remotely to the router. But how are the dropbear credentials initialized ?

By looking for dropbear related data, we stumble, once again, upon **libcmm.so**, and the very intriguing string `/var/tmp/dropbear/dropbearpwd`
The file doesn't exist in the squashfs, so it must be created during startup. In fact, it is created in one function in named **setDropbearLogin**:

```
undefined4 setDropbearLogin(int conf_obj)

{
  undefined4 uVar1;
  FILE *__stream;
  size_t length;
  byte *pbVar2;
  int iVar3;
  char *__s;
  char acStack112 [36];
  byte dest [32];
  undefined local_2c;
  char *password;

  memset(dest,0,0x21);
  if ((*(char *)(conf_obj + 0x22) == '\0') || (*(char *)(conf_obj + 0x32) == '\0')) {
    cdbg_printf(8,"setDropbearLogin",0xe3,"uname = %s, pswd = %s\n",conf_obj + 0x22,conf_obj + 0x32)
    ;
    uVar1 = 1;
  }
  else {
    __stream = fopen("/var/tmp/dropbear/dropbearpwd","wb+");
    uVar1 = 1;
    if (__stream != (FILE *)0x0) {
      fprintf(__stream,"username:%s\n",conf_obj + 0x22);
      password = (char *)(conf_obj + 0x32);
      __s = acStack112;
      length = strlen(password);
      iVar3 = 0;
      cen_md5MakeDigest(dest,password,length);
      memset(acStack112,0,0x21);
      do {
        pbVar2 = dest + iVar3;
        iVar3 = iVar3 + 1;
        sprintf(__s,"%02x",(uint)*pbVar2);
        __s = __s + 2;
      } while (iVar3 != 0x10);
      memcpy(dest,acStack112,0x21);
      local_2c = 0;
      fprintf(__stream,"password:%s\n",dest);
      fclose(__stream);
      uVar1 = 0;
    }
  }
  return uVar1;
}
```

Hopefully, once again, Ghidra's output is very easily readable, but here is a summary:

1. Open and create /var/tmp/dropbear/dropbearpwd
2. Write the string "username:" with the username given as parameter
3. Hash the password given as parameter
4. Write the string "password:" with the 16 bytes hex encoded hash obtained previously
5. Close the dropbearpwd file

Note that the hashing function is an old friend as well, the function **cen\_md5MakeDigest** also comes from **libcutil.so**.
So now, how are the username and password given to our function? They actually come from a much larger structure.

The router uses a large object stored in the BSS. It is a global data model object, that is written using

`undefined4 dm_setObj(uint param_1,ushort *param_2,ushort *param_3)`

and read with

`undefined4 dm_getObj(uint oid,ushort *out_buf,uint size,void *in_buf)`

Integer OIDs are used to refer to specific parts of the configuration in the memory, for example, in our case, the OID for dropbear credentials is 8:

```
  iVar1 = dm_getObj(8,&source,0x62,dropbear_obj_addr);
  if (iVar1 != 0) {
    cdbg_printf(8,"prepareDropbear",0x11a,"get OID_USER_CFG error.\n");
  }
  setDropbearLogin(dropbear_obj_addr);
  util_execSystem("prepareDropbear","dropbearkey -t rsa -f %s",
                  "/var/tmp/dropbear/dropbear_rsa_host_key");
  util_execSystem("prepareDropbear","dropbearkey -t dss -f %s",
                  "/var/tmp/dropbear/dropbear_dss_host_key");
  util_execSystem("prepareDropbear","dropbear -p %d -r %s -d %s -A %s",0x16,
                  "/var/tmp/dropbear/dropbear_rsa_host_key",
                  "/var/tmp/dropbear/dropbear_dss_host_key","/var/tmp/dropbear/dropbearpwd");
```

This code comes from the function that calls setDropbearLogin. It gets the *dropbear\_obj\_addr* from the global data model, at the OID 8. This section will contain both a username and a plaintext password.

Now, after tracing all the calls to *dm\_setObj* (and it took a while):

```
 **************************************************************
 *                          FUNCTION                          *
 **************************************************************
 undefined dm_setObj()

 dm_setObj                                       XREF[135]:   Entry Point(*),
                                                              rsl_sys_log:0002c470(c),
                                                              rsl_initPingWatchDogObj:0002e0f0
                                                              rsl_initL2tpConnPorttriggeringOb
                                                              rsl_initDmzHostCfgObj:0003c81c(c

...

```

It was clear the the OID 8 was never set as a hardcoded value, but actually from a loop iterating over values from a global variable named **configXMLCtx**. And by drawing the call graph to *dm\_setObj* with the *configXMLCtx* as OID parameter, we find:
{:refdef: style="text-align: center;"}
![\_config.yml]({{ site.baseurl }}/images/tplink/callgraph.png)
{: refdef}

Our credentials come from the XML file we decrypted earlier: *default\_config.xml* !!

# Part 4: Command injections

Regarding this part, I have no certainty towards the vulnerabilities (mostly because the router is dead from desoldering) and it would require a live check to see if parameters are indeed injectable.
This all starts with the prominent use of **system**, that, as you know, is widely discouraged.

```
                 **************************************************************
                 *                       THUNK FUNCTION                       *
                 **************************************************************
                 thunk int system(char * __command)
                   Thunked-Function: <EXTERNAL>::system
                   assume t9 = 0xb8160
 int               v0:4           <RETURN>
 char *            a0:4           __command
                 system                                          XREF[8]:     Entry Point(*),
                                                                              rsl_sys_restoreDefaultCfg:0002af
                                                                              rsl_sys_updateFirmware:0002b280(
                                                                              util_execSystem:00092aac(c),
                                                                              util_execSystem_long:00092d38(c),
                                                                              oal_startUPnP:00098f18(c),
                                                                              ipt_init:000a20e0(c),
                                                                              000ecda4(*)
```

But **system** itself is not the problem, it is the **util\_execSystem** function that relies on it, that is **everywhere** in the code. It has **495** cross references, in functions like *delStaticRoute* or *oal\_ping*.

The function starts like this:

```
  memset(command_line,0,0x200);
  iVar1 = vsnprintf(command_line,0x1ff,cmd,&local_res8);
  cdbg_printf(8,"util_execSystem",0x8b,"%s cmd is \"%s\"\n",caller_name,command_line);
  if (0 < iVar1) {
    iVar1 = 1;
    do {
      local_22c = system(command_line);
      local_22c._1_1_ = (byte)(local_22c >> 8);
      local_240 = local_22c & 0x7f;
      if ((int)local_22c < 0) {
        if (local_22c == 0xffffffff) {
          cdbg_printf(8,"util_execSystem",0x9b,"system fork failed.");
        }
        else {
          perror("util_execSystem call error:");
        }
      }
    }while (waitpid)
```

The buffer containing the command is zeroed, then snprintf'd from the command line passed as a parameter, and straight from there (no sanitization whatsoever) passed to *system()*.

Here is a good example of potentially injectable situation:

```
void oal_ipt_addBridgeIsolationRules(undefined4 param_1)

{
  util_execSystem("oal_ipt_addBridgeIsolationRules",
                  "iptables -t filter -I BRIDGE_ISOLATION -i br+ -o %s -j DROP",param_1);

```

*param\_1* could contain the name of a network interface entered from the web interface. While being directly concatenated, it could contain executable bash code to gain root on the device (bind, reverse shell for example).

I didn't have time to explore all the different uses, but it would be very surprising if none of those were injectable from the web administration interface.

# Part 5: Going further

There is no real conculsion to draw from this study. I bought this router mostly to have fun with it and that's exactly what I did. Passwords are weak, firmware is not encrypted, and so on and so on, but you get what you pay for.

Many things are left unchecked, and I may continue this post in a second part:

1. What is before the bootloader? (spart of it eems to contain hardware configuration, including serial port's configuration)
2. Kernel is 2.6, is there some TPLink proprietary additions to it?
3. Module tp\_domain.ko tries to contact dead domains: tplinklogin.net and [www.tplinklogin.net](http://www.tplinklogin.net), why?
4. Find an exploitable command injection using *util\_execSystem*

Resources

[Recovering TPlink default config](https://github.com/sta-c0000/tpconf_bin_xml/issues/2)

[TL866ii+](http://www.autoelectric.cn/en/tl866_main.html)

A little while after writing this article, I stumbled upon this one [on Pierre Kim's blog](https://pierrekim.github.io/blog/2017-02-09-tplink-c2-and-c20i-vulnerable.html), which shows very similar vulnerabilities. I suspect the code is significantly similar, and probably libraries even contain the exact same code.

We contacted TP Link and created the following [CVE-2020-36178](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-36178) related to the code injection issue. A specific mention to TP Link's security team is deserved, they are very serious and quick to respond, it is always satisfying to see security handled as a serious matter.

Enough for today!

Stay classy netsecurios.

---

## Reverse Engineering Routers

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from therealunicornsecurity.github.io_c0f7c059_20250119_112501.html ===

[![](https://avatars2.githubusercontent.com/u/64358437)](/)
# [Unicorn Security](/)

Breaching Unicorns

[Hire us!](https://unicornsecurity.io)
[Blog](/)
[About](/about)

# Reversing TL-WR840N

Buying cheap routers to find vulnerabilities in them

[![](/icons/system.png "system")](/tags#system)
[![](/icons/hardware.png "hardware")](/tags#hardware)
[![](/icons/reverse.png "reverse")](/tags#reverse)
[![](/icons/crypto.png "crypto")](/tags#crypto)

![_config.yml](/images/tplink/router.jpg)

# Part 1: Acquiring the firmware

TP Link firmwares are easy to get as they are free to download online:
https://www.tp-link.com/in/support/download/tl-wr840n/
But that is a bit too easy isn’t it ? Is there another way to get it ?

![](/images/tplink/serial.jpg)

Most of these devices have a serial port for debugging. Connecting to it should be trivial using a USB to UART adapter:

![](/images/tplink/usbuart.jpg)

Using this, you could potentially interrupt the boot sequence and enter a low-level shell that would allow you to do things like read the EEPROM chip at different offsets. Of course, if the goal is to easily get the firmware (over several hours because of the baud rate), then you’ve won !
But, still no thanks. I wanted to try something new:

![](/images/tplink/desolder.jpg)

Desoldering the EEPROM that contains the firmware was my way. If you are looking for a good reason to chose this way rather than any of the aformentioned ones, there isn’t. I had just recently acquired a TL866II+, and wanted to have fun with it !
So the chip perfectly fits in the 200mm SOP8 adapter:

![](/images/tplink/tl866.jpg)

But before being able to read from it, we need to identify which kind of chip it is:

![](/images/tplink/eeprom.jpg)

We can read AH1903 25Q32CS1G, and the logo is Giga Device.
By looking for GD25Q32 in the list of devices supported by minipro, we get this: GD25Q32 @SOP8. We then dump the firmware using the Linux fork of the minipro tool, available here: https://gitlab.com/DavidGriffith/minipro/
using the command line

```
root@kali:~# minipro -p GD25Q32 -r firmware.bin
Found TL866II+ 04.2.86 (0x256)
Warning: Firmware is out of date.
  Expected  04.2.118 (0x276)
  Found     04.2.86 (0x256)
Chip ID OK: 0xC84016
Reading Code...  6.99Sec  OK

```

Works like a charm!

# Part 2: Reversing the firmware

The file is 4Mb large, and contains the following signatures:

```
root@kali:~# binwalk firmware.bin

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
53488         0xD0F0          U-Boot version string, "U-Boot 1.1.3 (Jun 14 2018 - 11:06:28)"
66048         0x10200         LZMA compressed data, properties: 0x5D, dictionary size: 8388608 bytes, uncompressed size: 2986732 bytes
1048576       0x100000        Squashfs filesystem, little endian, version 4.0, compression:xz, size: 2955905 bytes, 610 inodes, blocksize: 262144 bytes, created: 2018-06-14 03:15:45
4063248       0x3E0010        XML document, version: "1.0"

```

We are mostly interested in the **squashfs**, as it contains the router’s filesystem. But, we also can see that the bootloader code starts at 0xD0F0, so there may be something interesting stored at the beginning of the firmware.

All the binaries are compiled for **MIPS**, that is the most common architecture for routers.
The /etc folder contains several interesting files. Notably, two encrypted XML files, *default\_config.xml* and *reduced\_data\_model.xml*. By searching for these filenames inside the whole squashfs, we get one interesting match: **libcmm.so**.

Compiled code referencing encrypted files might be actually decrypting them, so we disassemble the shared object library using Ghidra.

```
int dm_decryptFile(uint param_1,undefined4 param_2,uint param_3,int param_4)

{
  int iVar1;
  char acStack40 [8];
  int local_20;

  memcpy(acStack40,&encryption_key,8);
  if (param_3 < param_1) {
    cdbg_printf(8,"dm_decryptFile",0xb83,
                "Buffer exceeded, decrypt buf size is %u, but dm file size is %u",param_3,param_1);
    local_20 = 0;
  }
  else {
    local_20 = cen_desMinDo(param_2,param_1,param_4,param_3,acStack40,0);
    iVar1 = local_20;
    if (local_20 == 0) {
      cdbg_printf(8,"dm_decryptFile",0xb8a,"DES decrypt error\n");
    }
    else {
      do {
        local_20 = iVar1;
        if (((undefined *)(param_4 + local_20))[-1] != '\0') break;
        iVar1 = local_20 + -1;
      } while (local_20 != 0);
      *(undefined *)(param_4 + local_20) = 0;
    }
  }
  return local_20;
}

```

If that ain’t luck…

We have all the symbols! This makes the task much easier. So I renamed the *&encryption\_key* pointer, but you can easily see that the code is:

1. Copying an 8 bytes array in a local buffer (DES key sizes are 7+1 for parity)
2. Calling *cen\_desMinDo* which comes from **libcutil.so**, and is a wrapper for DES encryption functions

So we quickly get to the results using:

```
openssl enc -d -des-ecb -nopad -K XXXXXXXXXXXXXXXX -in default_config.xml > default_config_decrypted.xml

```

Of course, in this XML file, we expect to find loot, like:

```
    <StorageService>
    <UserAccount instance=1 >
    <Enable val=1 />
    <Username val=admin />
    <Password val=admin />
    <X_TP_Reference val=0 />
    <X_TP_SupperUser val=1 />
    </UserAccount>

```

We like those default credentials a lot, but they are usually widely known and/or documented (especially for cheap routers), so nothing very shocking here. The other file, reduced\_data\_model\_decrypted.xml, contains the same kind of credentials and information, but this time they are models for the global configuration scheme.

Another intersting thing in /etc folder: **shadow doesn’t exist**

The passwords are stored the old way, in the passwd file:

```
admin:$1$$iC.dUsGpxNNJGeOm1dFio/:0:0:root:/:/bin/sh
dropbear:x:500:500:dropbear:/var/dropbear:/bin/sh
nobody:*:0:0:nobody:/:/bin/sh

```

So *admin* seems to have a $1 (MD5) password. Let’s see what hashcat thinks about this:

```
root@kali:~# hashcat -a 0 -m 500 hash /usr/share/wordlists/rockyou.txt

$1$$iC.dUsGpxNNJGeOm1dFio/:1234

Session..........: hashcat
Status...........: Cracked
Hash.Name........: md5crypt, MD5 (Unix), Cisco-IOS $1$ (MD5)
Hash.Target......: $1$$iC.dUsGpxNNJGeOm1dFio/
Time.Started.....: Wed Oct 28 14:10:47 2020 (1 sec)
Time.Estimated...: Wed Oct 28 14:10:48 2020 (0 secs)
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:     3279 H/s (11.38ms) @ Accel:256 Loops:125 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests
Progress.........: 3072/14344385 (0.02%)
Rejected.........: 0/3072 (0.00%)
Restore.Point....: 0/14344385 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:875-1000
Candidates.#1....: 123456 -> dangerous

```

admin:1234 is the root’s password of the router. You could use these credentials to connect through the serial port for example. Of course, we were not really expecting complicated passwords as defaults credentials.

You could also get the default credentials by visiting <https://www.tp-link.com/us/support/faq/191>

But why doing things simply.

# Part 3: Dropbear

Another interesting user here is dropbear. It is a lightweight ssh server for embedded systems, and it could allow a user to authenticate remotely to the router. But how are the dropbear credentials initialized ?

By looking for dropbear related data, we stumble, once again, upon **libcmm.so**, and the very intriguing string `/var/tmp/dropbear/dropbearpwd`
The file doesn’t exist in the squashfs, so it must be created during startup. In fact, it is created in one function in named **setDropbearLogin**:

```
undefined4 setDropbearLogin(int conf_obj)

{
  undefined4 uVar1;
  FILE *__stream;
  size_t length;
  byte *pbVar2;
  int iVar3;
  char *__s;
  char acStack112 [36];
  byte dest [32];
  undefined local_2c;
  char *password;

  memset(dest,0,0x21);
  if ((*(char *)(conf_obj + 0x22) == '\0') || (*(char *)(conf_obj + 0x32) == '\0')) {
    cdbg_printf(8,"setDropbearLogin",0xe3,"uname = %s, pswd = %s\n",conf_obj + 0x22,conf_obj + 0x32)
    ;
    uVar1 = 1;
  }
  else {
    __stream = fopen("/var/tmp/dropbear/dropbearpwd","wb+");
    uVar1 = 1;
    if (__stream != (FILE *)0x0) {
      fprintf(__stream,"username:%s\n",conf_obj + 0x22);
      password = (char *)(conf_obj + 0x32);
      __s = acStack112;
      length = strlen(password);
      iVar3 = 0;
      cen_md5MakeDigest(dest,password,length);
      memset(acStack112,0,0x21);
      do {
        pbVar2 = dest + iVar3;
        iVar3 = iVar3 + 1;
        sprintf(__s,"%02x",(uint)*pbVar2);
        __s = __s + 2;
      } while (iVar3 != 0x10);
      memcpy(dest,acStack112,0x21);
      local_2c = 0;
      fprintf(__stream,"password:%s\n",dest);
      fclose(__stream);
      uVar1 = 0;
    }
  }
  return uVar1;
}

```

Hopefully, once again, Ghidra’s output is very easily readable, but here is a summary:

1. Open and create /var/tmp/dropbear/dropbearpwd
2. Write the string “username:" with the username given as parameter
3. Hash the password given as parameter
4. Write the string “password:" with the 16 bytes hex encoded hash obtained previously
5. Close the dropbearpwd file

Note that the hashing function is an old friend as well, the function **cen\_md5MakeDigest** also comes from **libcutil.so**.
So now, how are the username and password given to our function? They actually come from a much larger structure.

The router uses a large object stored in the BSS. It is a global data model object, that is written using

`undefined4 dm_setObj(uint param_1,ushort *param_2,ushort *param_3)`

and read with

`undefined4 dm_getObj(uint oid,ushort *out_buf,uint size,void *in_buf)`

Integer OIDs are used to refer to specific parts of the configuration in the memory, for example, in our case, the OID for dropbear credentials is 8:

```
  iVar1 = dm_getObj(8,&source,0x62,dropbear_obj_addr);
  if (iVar1 != 0) {
    cdbg_printf(8,"prepareDropbear",0x11a,"get OID_USER_CFG error.\n");
  }
  setDropbearLogin(dropbear_obj_addr);
  util_execSystem("prepareDropbear","dropbearkey -t rsa -f %s",
                  "/var/tmp/dropbear/dropbear_rsa_host_key");
  util_execSystem("prepareDropbear","dropbearkey -t dss -f %s",
                  "/var/tmp/dropbear/dropbear_dss_host_key");
  util_execSystem("prepareDropbear","dropbear -p %d -r %s -d %s -A %s",0x16,
                  "/var/tmp/dropbear/dropbear_rsa_host_key",
                  "/var/tmp/dropbear/dropbear_dss_host_key","/var/tmp/dropbear/dropbearpwd");

```

This code comes from the function that calls setDropbearLogin. It gets the *dropbear\_obj\_addr* from the global data model, at the OID 8. This section will contain both a username and a plaintext password.

Now, after tracing all the calls to *dm\_setObj* (and it took a while):

```
 **************************************************************
 *                          FUNCTION                          *
 **************************************************************
 undefined dm_setObj()

 dm_setObj                                       XREF[135]:   Entry Point(*),
                                                              rsl_sys_log:0002c470(c),
                                                              rsl_initPingWatchDogObj:0002e0f0
                                                              rsl_initL2tpConnPorttriggeringOb
                                                              rsl_initDmzHostCfgObj:0003c81c(c

...

```

It was clear the the OID 8 was never set as a hardcoded value, but actually from a loop iterating over values from a global variable named **configXMLCtx**. And by drawing the call graph to *dm\_setObj* with the *configXMLCtx* as OID parameter, we find:

![_config.yml](/images/tplink/callgraph.png)

Our credentials come from the XML file we decrypted earlier: *default\_config.xml* !!

# Part 4: Command injections

Regarding this part, I have no certainty towards the vulnerabilities (mostly because the router is dead from desoldering) and it would require a live check to see if parameters are indeed injectable.
This all starts with the prominent use of **system**, that, as you know, is widely discouraged.

```
                 **************************************************************
                 *                       THUNK FUNCTION                       *
                 **************************************************************
                 thunk int system(char * __command)
                   Thunked-Function: <EXTERNAL>::system
                   assume t9 = 0xb8160
 int               v0:4           <RETURN>
 char *            a0:4           __command
                 system                                          XREF[8]:     Entry Point(*),
                                                                              rsl_sys_restoreDefaultCfg:0002af
                                                                              rsl_sys_updateFirmware:0002b280(
                                                                              util_execSystem:00092aac(c),
                                                                              util_execSystem_long:00092d38(c),
                                                                              oal_startUPnP:00098f18(c),
                                                                              ipt_init:000a20e0(c),
                                                                              000ecda4(*)

```

But **system** itself is not the problem, it is the **util\_execSystem** function that relies on it, that is **everywhere** in the code. It has **495** cross references, in functions like *delStaticRoute* or *oal\_ping*.

The function starts like this:

```
  memset(command_line,0,0x200);
  iVar1 = vsnprintf(command_line,0x1ff,cmd,&local_res8);
  cdbg_printf(8,"util_execSystem",0x8b,"%s cmd is \"%s\"\n",caller_name,command_line);
  if (0 < iVar1) {
    iVar1 = 1;
    do {
      local_22c = system(command_line);
      local_22c._1_1_ = (byte)(local_22c >> 8);
      local_240 = local_22c & 0x7f;
      if ((int)local_22c < 0) {
        if (local_22c == 0xffffffff) {
          cdbg_printf(8,"util_execSystem",0x9b,"system fork failed.");
        }
        else {
          perror("util_execSystem call error:");
        }
      }
    }while (waitpid)

```

The buffer containing the command is zeroed, then snprintf’d from the command line passed as a parameter, and straight from there (no sanitization whatsoever) passed to *system()*.

Here is a good example of potentially injectable situation:

```
void oal_ipt_addBridgeIsolationRules(undefined4 param_1)

{
  util_execSystem("oal_ipt_addBridgeIsolationRules",
                  "iptables -t filter -I BRIDGE_ISOLATION -i br+ -o %s -j DROP",param_1);

```

*param\_1* could contain the name of a network interface entered from the web interface. While being directly concatenated, it could contain executable bash code to gain root on the device (bind, reverse shell for example).

I didn’t have time to explore all the different uses, but it would be very surprising if none of those were injectable from the web administration interface.

# Part 5: Going further

There is no real conculsion to draw from this study. I bought this router mostly to have fun with it and that’s exactly what I did. Passwords are weak, firmware is not encrypted, and so on and so on, but you get what you pay for.

Many things are left unchecked, and I may continue this post in a second part:

1. What is before the bootloader? (spart of it eems to contain hardware configuration, including serial port’s configuration)
2. Kernel is 2.6, is there some TPLink proprietary additions to it?
3. Module tp\_domain.ko tries to contact dead domains: tplinklogin.net and www.tplinklogin.net, why?
4. Find an exploitable command injection using *util\_execSystem*

Resources

[Recovering TPlink default config](https://github.com/sta-c0000/tpconf_bin_xml/issues/2)

[TL866ii+](http://www.autoelectric.cn/en/tl866_main.html)

A little while after writing this article, I stumbled upon this one [on Pierre Kim’s blog](https://pierrekim.github.io/blog/2017-02-09-tplink-c2-and-c20i-vulnerable.html), which shows very similar vulnerabilities. I suspect the code is significantly similar, and probably libraries even contain the exact same code.

We contacted TP Link and created the following [CVE-2020-36178](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-36178) related to the code injection issue. A specific mention to TP Link’s security team is deserved, they are very serious and quick to respond, it is always satisfying to see security handled as a serious matter.

Enough for today!

Stay classy netsecurios.

---

Reverse Engineering Routers
—

Written on October 11, 2020



=== Content from www.tp-link.com_e24422bf_20250119_112502.html ===


Your browser does not support JavaScript. Please turn it on for the best experience.

Click to skip the navigation bar

[Où acheter](/fr/where-to-buy/)

[Support](/fr/support/)

1. [Support / Assistance](/fr/support/)
2. [Téléchargement Firmwares, Modes d'Emploi, Guides Utilisateur](/fr/support/download/)
3. [Questions Fréquentes (F.A.Q.)](/fr/support/faq/)
4. [Contacter l'assistance technique](/fr/support/contact-technical-support/)
5. [Listes de compatibilité](/fr/support/compatibility-list/)
6. [Garantie Commerciale et Autorisations de Retour](/fr/support/replacement-warranty/)

[Partner Program](https://zfrmz.com/BVI1NILdmhKHBJ5vaUxO)

[France / Français](/fr/choose-your-location/)

[TP-Link, Reliably Smart](/fr/)

[Search](/fr/search/)
[Online store](https://fr.store.tp-link.com/)

* [STORE
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)](https://fr.store.tp-link.com/)
* Grand Public
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)
  + [WiFi 7](/fr/wifi7/)
  + [Passez au WiFi 6](/fr/wifi6/)
  + [OneMesh](/fr/onemesh/)
  + [G.hn](/fr/ghn/)
  + [Vidéos d'Installation](/fr/support/setup-video/)
  + [Guide d'achat](/fr/home-networking/guide/)
  + [Découvrez le WiFi 6E](/fr/wifi-6e/)
  + [HomeShield](/fr/homeshield/)

  [WiFi Mesh Multi Room](/fr/deco-mesh-wifi/)

  WiFi intelligent et performant partout dans la maison

  + [WiFi 7 Mesh](/fr/home-networking/deco/?filterby=6271)
  + [WiFi 6/6E Mesh](/fr/home-networking/deco/?filterby=6093%7C5730)
  + [Solution Mesh Outdoor](/fr/home-networking/deco/?filterby=6524)
  + [Solution Mesh plafonnier](/fr/home-networking/deco/?filterby=6525)
  + [Solution Mesh 5G/4G/DSL](/fr/home-networking/deco/?filterby=6526)
  + [Routeurs WiFi Mesh Deco](/fr/home-networking/deco/)

  [Réseau WiFi](/fr/home-networking/all-network-expansion/)

  La façon simple de doubler sa couverture WiFi et d'étendre son réseau filaire

  + [CPL/CPL WiFi](/fr/home-networking/powerline/)
  + [Répéteurs WiFi](/fr/home-networking/range-extender/)
  + [Points d'accès WiFi](/fr/home-networking/access-point/)
  + [Switches](/fr/home-networking/soho-switch/)

  [Routeurs](/fr/home-networking/wifi-router/)

  Remplacez le WiFi de votre Box par un WiFi fiable et rapide

  + [Routeurs WiFi 7](/fr/home-networking/wifi-router/?filterby=6271)
  + [Routeurs WiFi 6E](/fr/home-networking/wifi-router/?filterby=6093)
  + [Routeurs WiFi 6](/fr/home-networking/wifi-router/?filterby=5730)
  + [Routeurs Gaming](/fr/home-networking/wifi-router/?filterby=5748)
  + [Routeurs WiFi](/fr/home-networking/wifi-router/)

  [Modems / Routeurs](/fr/home-networking/all-gateways/)

  Connexion Internet 4G / 4G+ / 5G haut débit

  + [Modem/Routeurs 4G / 5G LTE WiFi : Connexion Internet haut débit](/fr/home-networking/5g-4g-router/)
  + [Modems & Routeurs xDSL](/fr/home-networking/dsl-modem-router/)
  + [Modems & Routeurs câble](/fr/home-networking/cable-modem-router/)
  + [WiFi Mobile 4G / 4G+ / 5G](/fr/home-networking/lte-3g/)

  [Switches Grand Public](/fr/home-networking/soho-switch/)

  Connexions filaires de qualité

  + [Switches 5 ports](/fr/home-networking/soho-switch/?filterby=4996)
  + [Switches 8 ports](/fr/home-networking/soho-switch/?filterby=5889)
  + [Switches 16 ports](/fr/home-networking/soho-switch/?filterby=5890)

  [WiFi Mobile 4G LTE](/fr/home-networking/mifi/)

  WiFi où que vous soyez

  + [MiFi : Solutions 4G Mobiles](/fr/home-networking/mifi/)
  + [MiFi 4G+](/fr/home-networking/mifi/?filterby=5768%7C5769)
  + [MiFi 4G+/4G](https://www.tp-link.com/fr/home-networking/mifi/?filterby=5768%7C5769%7C5770)

  [Adaptateurs](/fr/home-networking/all-adapter/)

  Equipez votre PC d'un adaptateur pour un WiFi plus rapide

  + [Adaptateurs WiFi/Bluetooth USB/PCI](/fr/home-networking/adapter/)
  + [Adaptateurs Haute puissance](/fr/home-networking/high-power-adapter/)

  [Accessoires](/fr/home-networking/all-accessories/)

  Tout se ce que vous avez besoin pour une vie connectée

  + [Accessoires Informatiques](/fr/home-networking/computer-accessory/)
  + [Batterie Externe PowerBank](/fr/home-networking/mobile-accessory/)
  + [Appareils Audio Nomades](/fr/home-networking/entertainment-device/)
  + [Antennes](/fr/home-networking/antenna/)

  [Réseau pour TPE](/fr/business-networking/all-soho/)

  La solution facile à utiliser pour la mise en réseau du bureau à domicile

  + [Switches](/fr/business-networking/all-soho-switch/)
  + [Solution Festa](/fr/landing/festa/)
  + [Switches non administrables](/fr/business-networking/soho-switch-unmanaged/)
  + [Easy Smart Switches](/fr/business-networking/soho-switch-easy-smart/)
  + [Routeurs](/fr/business-networking/soho-router/)
  + [Ponts WiFi](/fr/business-networking/all-pharos-wireless-bridge/)
* [Maison Connectée
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)](/fr/search/?q=tapo&t=&s=)
  + [Maison Connectée Tapo](https://www.tp-link.com/fr/search/?q=tapo&t=&s=)
  + [Matter](/fr/technology/matter/)

  [Caméras Vidéosurveillance WiFi](/fr/home-networking/cloud-camera/)

  Caméras de vidéo surveillance connectées et à distance 24h/24 de votre maison

  [Eclairage Connecté WiFi](/fr/home-networking/smart-bulb/)

  Ampoules et Rubans LED Connectés / Commande vocale Google / Alexa

  [Prises Connectées WiFi](/fr/home-networking/smart-plug/)

  Maison Connectée / Commande vocale Google Home et Alexa

  [Robots Aspirateurs Connectés](/fr/smart-home/all-robot-vacuum/)

  Nettoyage quotidien facile

  + [Robots Aspirateurs](/fr/smart-home/robot-vacuum/)
  + [Accessoires Robot Aspirateur](/fr/smart-home/robot-vacuum-accessory/)

  [Capteurs Connectés](/fr/smart-home/smart-sensor/)

  Domotique en mode automatique

  [Sonnettes de porte](/fr/smart-home/smart-doorbell/)

  Sécurité intelligente à votre porte d'entrée

  [Hub de Connexion](/fr/home-networking/smart-hub/)

  Requis pour tous les capteurs/interrupteurs

  [Têtes Thermostatiques Connectées](/fr/home-networking/smart-thermostat/)

  Le confort au quotidien

  [Interrupteurs Connectés](/fr/home-networking/smart-switch/)

  Plus que allumr/éteindre
* [Solutions Pro
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)](https://www.omadanetworks.com/fr/)

  [Festa](/fr/landing/festa/)

  Solution réseau pour TPE et professions libérales

  + [Qu'est-ce que Festa ?](/fr/landing/festa/)
  + [WiFi](/fr/business-networking/soho-festa-access-point/)
  + [Switches](/fr/business-networking/soho-festa-switch/)
  + [Routeurs](/fr/business-networking/soho-festa-gateway/)
  + [Cloud](/fr/business-networking/soho-festa-cloud/)
  + [Tous les produits](/fr/business-networking/all-soho-festa/)

  [Omada](/fr/business-networking/all-omada/)

  Solution réseau Cloud pour les PME

  + [Qu'est-ce qu'Omada ?](/fr/omada-sdn/)
  + [WiFi](/fr/business-networking/omada/wifi/)
  + [Switches](/fr/business-networking/omada/switch/)
  + [Routeurs VPN](/fr/business-networking/omada/router/)
  + [Contrôleurs](/fr/business-networking/omada/controller/)
  + [Accessoires](/fr/business-networking/omada/accessory/)
  + [Toutes les solutions](/fr/business-networking/all-omada/)

  [VIGI](https://www.vigi.com/fr/)

  Solution de vidéosurveillance IA complète pour PME

  + [Qu'est-ce que VIGI ?](https://www.vigi.com/fr/vigi/about-vigi/)
  + [VIGI 4E](https://www.vigi.com/fr/vigi/vigi-4e-principle/)
  + [Caméras](https://www.vigi.com/fr/business-networking/vigi-network-camera/)
  + [Enregistreurs vidéo réseau](https://www.vigi.com/fr/business-networking/vigi-network-video-recorder/)
  + [Kits NVR VIGI](https://www.vigi.com/fr/business-networking/vigi-nvr-kit/)
  + [Système d'énergie solaire](https://www.vigi.com/fr/business-networking/vigi-solar-power-system/)
  + [Accessoires](https://www.vigi.com/fr/business-networking/vigi-accessory/)
  + [Service Logiciel](https://www.vigi.com/fr/business-networking/vigi-software-service/)
  + [Outils VIGI](https://www.vigi.com/fr/smb/vigi-tool/)
  + [Télécharger VIGI Security Manager](https://www.vigi.com/fr/support/download/vigi-security-manager/#VIGI_Security_Manager)
  + [VIGI Security Manager](/fr/business-networking/vigi-security-manager/)
  + [Tous les produits](https://www.vigi.com/fr/business-networking/all-vigi-surveillance/)

  [Omada Pro](/fr/business-networking/all-omada-pro/)

  Solution réseau Cloud pour entreprises et grands comptes

  + [Qu'est qu'Omada Pro ?](/fr/landing/omada-pro/)
  + [WiFi](/fr/business-networking/all-omada-pro-wifi/)
  + [Switches](/fr/business-networking/all-omada-pro-switch/)
  + [Routeurs](/fr/business-networking/all-omada-pro-router/)
  + [Contrôleurs](/fr/business-networking/all-omada-pro-controller/)
  + [Tous les produits](/fr/business-networking/all-omada-pro/)

  [Switches Pro](/fr/business-networking/all-switch/)

  Réseau filaire haut débit manageable et non administrable jusqu'au Niveau 3

  + [Switches non administrables](/fr/business-networking/unmanaged-switch/)
  + [LiteWave Switches Non Administrables](/fr/business-networking/litewave-switch/)
  + [Switches Easy Smart](/fr/business-networking/easy-smart-switch/)
  + [Switches Smart](/fr/business-networking/smart-switch/)
  + [Switches administrables](/fr/business-networking/managed-switch/)
  + [Switches PoE / PoE+](/fr/business-networking/poe-switch/)
  + [Switches Vidéosurveillance](/fr/business-networking/surveillance-switch/)
  + [Accessoires](/fr/business-networking/accessory/)
* Opérateurs / FAI
  ![Click to open the navigation bar](https://static.tp-link.com/assets/images/icon/arrow-gray-down.svg)
  + [FAI](https://service-provider.tp-link.com/)
  + [Solutions Agile](https://service-provider.tp-link.com/solution/)
  + [Outils FAI](/fr/solution/isp-tools/)
  + [Matter](/fr/technology/matter/)

  [Modems & Routeurs xDSL](/fr/service-provider/dsl-router/)

  Pour un réseau haut débit et d'applications haut débit intégrées

  [VDSL](/fr/service-provider/vdsl/)

  Capable d'un réseau haut débit et d'applications haut débit intégrées

  [4G / 5G](/fr/service-provider/lte/)

  Un accès Internet où que vous soyez via carte SIM

  [XGS-PON / GPON / PON - Fibre Optique](/fr/service-provider/gpon/)

  La technologie de pointe pour fournir des services Internet Gigabit

  [CPL / CPL WiFi](/fr/service-provider/powerline-adapter/)

  Moyen simple et efficace de faire passer Internet et son réseau par les prises électriques

  [Répéteurs WiFi](/fr/service-provider/range-extender/)

  Booster son réseau WiFi très simplement

  [Switches Ethernet](/fr/service-provider/switch/)

  Switches pour entreprises
  Switches TP-Link ultra performants pour entreprises : Smart Switches, switches administrables, Unmanaged Switches et Accessoires.

  + [Switches administrables](/fr/service-provider/managed-switch/)
  + [Smart Switches](/fr/service-provider/smart-switch/)
  + [Switches non administrables](/fr/service-provider/unmanaged-switch/)
  + [Accessoires](/fr/service-provider/switch-accessory/)

  [Points d'accès - Relais WiFi](/fr/service-provider/business-wireless/)

  Points d'accès et relais WiFi. Spécialement conçues pour les commerces, les entreprises, les hôtels ou les campus, les solutions Wi-Fi garantissent une couverture sans fil sécurisée et haut débit

  [Routeur WiFi](/fr/service-provider/wifi-router/)

  Le choix de la fiabilité pour le réseau domestique

  [Solutions Mesh](/fr/service-provider/home-wifi-system/)

  Un réseau maillé transparent, intelligent et facile à configurer

  + [Deco ISP Cloud](/fr/solution/deco-for-isp/)

[TP-Link, Reliably Smart](/fr/)

[Search](/fr/search/)
[Online store](https://fr.store.tp-link.com/)
Menu

Submit

* [STORE](https://fr.store.tp-link.com/)
* Grand Public

  Retour

  + WiFi Mesh Multi Room

    - [WiFi 7 Mesh](/fr/home-networking/deco/?filterby=6271)
    - [WiFi 6/6E Mesh](/fr/home-networking/deco/?filterby=6093%7C5730)
    - [Solution Mesh Outdoor](/fr/home-networking/deco/?filterby=6524)
    - [Solution Mesh plafonnier](/fr/home-networking/deco/?filterby=6525)
    - [Solution Mesh 5G/4G/DSL](/fr/home-networking/deco/?filterby=6526)
    - [Routeurs WiFi Mesh Deco](/fr/home-networking/deco/)
  + Réseau WiFi

    - [CPL/CPL WiFi](/fr/home-networking/powerline/)
    - [Répéteurs WiFi](/fr/home-networking/range-extender/)
    - [Points d'accès WiFi](/fr/home-networking/access-point/)
    - [Switches](/fr/home-networking/soho-switch/)
  + Routeurs

    - [Routeurs WiFi 7](/fr/home-networking/wifi-router/?filterby=6271)
    - [Routeurs WiFi 6E](/fr/home-networking/wifi-router/?filterby=6093)
    - [Routeurs WiFi 6](/fr/home-networking/wifi-router/?filterby=5730)
    - [Routeurs Gaming](/fr/home-networking/wifi-router/?filterby=5748)
    - [Routeurs WiFi](/fr/home-networking/wifi-router/)
  + Modems / Routeurs

    - [Modem/Routeurs 4G / 5G LTE WiFi : Connexion Internet haut débit](/fr/home-networking/5g-4g-router/)
    - [Modems & Routeurs xDSL](/fr/home-networking/dsl-modem-router/)
    - [Modems & Routeurs câble](/fr/home-networking/cable-modem-router/)
    - [WiFi Mobile 4G / 4G+ / 5G](/fr/home-networking/lte-3g/)
  + Switches Grand Public

    - [Switches 5 ports](/fr/home-networking/soho-switch/?filterby=4996)
    - [Switches 8 ports](/fr/home-networking/soho-switch/?filterby=5889)
    - [Switches 16 ports](/fr/home-networking/soho-switch/?filterby=5890)
  + WiFi Mobile 4G LTE

    - [MiFi : Solutions 4G Mobiles](/fr/home-networking/mifi/)
    - [MiFi 4G+](/fr/home-networking/mifi/?filterby=5768%7C5769)
    - [MiFi 4G+/4G](https://www.tp-link.com/fr/home-networking/mifi/?filterby=5768%7C5769%7C5770)
  + Adaptateurs

    - [Adaptateurs WiFi/Bluetooth USB/PCI](/fr/home-networking/adapter/)
    - [Adaptateurs Haute puissance](/fr/home-networking/high-power-adapter/)
  + Accessoires

    - [Accessoires Informatiques](/fr/home-networking/computer-accessory/)
    - [Batterie Externe PowerBank](/fr/home-networking/mobile-accessory/)
    - [Appareils Audio Nomades](/fr/home-networking/entertainment-device/)
    - [Antennes](/fr/home-networking/antenna/)
  + Réseau pour TPE

    - [Switches](/fr/business-networking/all-soho-switch/)
    - [Solution Festa](/fr/landing/festa/)
    - [Switches non administrables](/fr/business-networking/soho-switch-unmanaged/)
    - [Easy Smart Switches](/fr/business-networking/soho-switch-easy-smart/)
    - [Routeurs](/fr/business-networking/soho-router/)
    - [Ponts WiFi](/fr/business-networking/all-pharos-wireless-bridge/)
  + [WiFi 7](/fr/wifi7/)
  + [Passez au WiFi 6](/fr/wifi6/)
  + [OneMesh](/fr/onemesh/)
  + [G.hn](/fr/ghn/)
  + [Vidéos d'Installation](/fr/support/setup-video/)
  + [Guide d'achat](/fr/home-networking/guide/)
  + [Découvrez le WiFi 6E](/fr/wifi-6e/)
  + [HomeShield](/fr/homeshield/)
* Maison Connectée

  Retour

  + [Caméras Vidéosurveillance WiFi](/fr/home-networking/cloud-camera/)
  + [Eclairage Connecté WiFi](/fr/home-networking/smart-bulb/)
  + [Prises Connectées WiFi](/fr/home-networking/smart-plug/)
  + Robots Aspirateurs Connectés

    - [Robots Aspirateurs](/fr/smart-home/robot-vacuum/)
    - [Accessoires Robot Aspirateur](/fr/smart-home/robot-vacuum-accessory/)
  + [Capteurs Connectés](/fr/smart-home/smart-sensor/)
  + [Sonnettes de porte](/fr/smart-home/smart-doorbell/)
  + [Hub de Connexion](/fr/home-networking/smart-hub/)
  + [Têtes Thermostatiques Connectées](/fr/home-networking/smart-thermostat/)
  + [Interrupteurs Connectés](/fr/home-networking/smart-switch/)
  + [Maison Connectée Tapo](https://www.tp-link.com/fr/search/?q=tapo&t=&s=)
  + [Matter](/fr/technology/matter/)
* Solutions Pro

  Retour

  + Festa

    - [Qu'est-ce que Festa ?](/fr/landing/festa/)
    - [WiFi](/fr/business-networking/soho-festa-access-point/)
    - [Switches](/fr/business-networking/soho-festa-switch/)
    - [Routeurs](/fr/business-networking/soho-festa-gateway/)
    - [Cloud](/fr/business-networking/soho-festa-cloud/)
    - [Tous les produits](/fr/business-networking/all-soho-festa/)
  + Omada

    - [Qu'est-ce qu'Omada ?](/fr/omada-sdn/)
    - [WiFi](/fr/business-networking/omada/wifi/)
    - [Switches](/fr/business-networking/omada/switch/)
    - [Routeurs VPN](/fr/business-networking/omada/router/)
    - [Contrôleurs](/fr/business-networking/omada/controller/)
    - [Accessoires](/fr/business-networking/omada/accessory/)
    - [Toutes les solutions](/fr/business-networking/all-omada/)
  + VIGI

    - [Qu'est-ce que VIGI ?](https://www.vigi.com/fr/vigi/about-vigi/)
    - [VIGI 4E](https://www.vigi.com/fr/vigi/vigi-4e-principle/)
    - [Caméras](https://www.vigi.com/fr/business-networking/vigi-network-camera/)
    - [Enregistreurs vidéo réseau](https://www.vigi.com/fr/business-networking/vigi-network-video-recorder/)
    - [Kits NVR VIGI](https://www.vigi.com/fr/business-networking/vigi-nvr-kit/)
    - [Système d'énergie solaire](https://www.vigi.com/fr/business-networking/vigi-solar-power-system/)
    - [Accessoires](https://www.vigi.com/fr/business-networking/vigi-accessory/)
    - [Service Logiciel](https://www.vigi.com/fr/business-networking/vigi-software-service/)
    - [Outils VIGI](https://www.vigi.com/fr/smb/vigi-tool/)
    - [Télécharger VIGI Security Manager](https://www.vigi.com/fr/support/download/vigi-security-manager/#VIGI_Security_Manager)
    - [VIGI Security Manager](/fr/business-networking/vigi-security-manager/)
    - [Tous les produits](https://www.vigi.com/fr/business-networking/all-vigi-surveillance/)
  + Omada Pro

    - [Qu'est qu'Omada Pro ?](/fr/landing/omada-pro/)
    - [WiFi](/fr/business-networking/all-omada-pro-wifi/)
    - [Switches](/fr/business-networking/all-omada-pro-switch/)
    - [Routeurs](/fr/business-networking/all-omada-pro-router/)
    - [Contrôleurs](/fr/business-networking/all-omada-pro-controller/)
    - [Tous les produits](/fr/business-networking/all-omada-pro/)
  + Switches Pro

    - [Switches non administrables](/fr/business-networking/unmanaged-switch/)
    - [LiteWave Switches Non Administrables](/fr/business-networking/litewave-switch/)
    - [Switches Easy Smart](/fr/business-networking/easy-smart-switch/)
    - [Switches Smart](/fr/business-networking/smart-switch/)
    - [Switches administrables](/fr/business-networking/managed-switch/)
    - [Switches PoE / PoE+](/fr/business-networking/poe-switch/)
    - [Switches Vidéosurveillance](/fr/business-networking/surveillance-switch/)
    - [Accessoires](/fr/business-networking/accessory/)
* Opérateurs / FAI

  Retour

  + [Modems & Routeurs xDSL](/fr/service-provider/dsl-router/)
  + [VDSL](/fr/service-provider/vdsl/)
  + [4G / 5G](/fr/service-provider/lte/)
  + [XGS-PON / GPON / PON - Fibre Optique](/fr/service-provider/gpon/)
  + [CPL / CPL WiFi](/fr/service-provider/powerline-adapter/)
  + [Répéteurs WiFi](/fr/service-provider/range-extender/)
  + Switches Ethernet

    - [Switches administrables](/fr/service-provider/managed-switch/)
    - [Smart Switches](/fr/service-provider/smart-switch/)
    - [Switches non administrables](/fr/service-provider/unmanaged-switch/)
    - [Accessoires](/fr/service-provider/switch-accessory/)
  + [Points d'accès - Relais WiFi](/fr/service-provider/business-wireless/)
  + [Routeur WiFi](/fr/service-provider/wifi-router/)
  + Solutions Mesh

    - [Deco ISP Cloud](/fr/solution/deco-for-isp/)
  + [FAI](https://service-provider.tp-link.com/)
  + [Solutions Agile](https://service-provider.tp-link.com/solution/)
  + [Outils FAI](/fr/solution/isp-tools/)
  + [Matter](/fr/technology/matter/)
* [Où acheter](/fr/where-to-buy/)
* Support

  Retour

  + [Support / Assistance](/fr/support/)
  + [Téléchargement Firmwares, Modes d'Emploi, Guides Utilisateur](/fr/support/download/)
  + [Questions Fréquentes (F.A.Q.)](/fr/support/faq/)
  + [Contacter l'assistance technique](/fr/support/contact-technical-support/)
  + [Listes de compatibilité](/fr/support/compatibility-list/)
  + [Garantie Commerciale et Autorisations de Retour](/fr/support/replacement-warranty/)
  + [Émulateurs TP-Link](/fr/support/emulator/)
  + [Centre de code GPL](/fr/support/gpl-code/)
  + [Vidéos Assistance](/fr/support/setup-video/)
* [Partner Program](https://zfrmz.com/BVI1NILdmhKHBJ5vaUxO)

+ [tapo](https://www.tp-link.com/fr/search/?q=tapo&t=&s=)
+ [Omada](https://www.omadanetworks.com/fr/)
+ [Festa](/fr/landing/festa/)
+ [VIGI](https://www.vigi.com/fr/)

* [Téléchargement Firmwares, Modes d'Emploi, Guides Utilisateur](/fr/support/download/)
* [Questions Fréquentes (F.A.Q.)](/fr/support/faq/)
* [Contacter l'assistance technique](/fr/support/contact-technical-support/)
* [Listes de compatibilité](/fr/support/compatibility-list/)
* [Garantie Commerciale et Autorisations de Retour](/fr/support/replacement-warranty/)
* [Émulateurs TP-Link](/fr/support/emulator/)
* [Centre de code GPL](/fr/support/gpl-code/)
* [Vidéos Assistance](/fr/support/setup-video/)

# *Téléchargement pour* *TL-WR840N V6*

Veuillez choisir la version matérielle:
V6

* [V6.20](https://www.tp-link.com/fr/support/download/tl-wr840n/v6.20/)
* [V6](https://www.tp-link.com/fr/support/download/tl-wr840n/v6/)
* [V5](https://www.tp-link.com/fr/support/download/tl-wr840n/v5/)
* [V4](https://www.tp-link.com/fr/support/download/tl-wr840n/v4/)
* [V3](https://www.tp-link.com/fr/support/download/tl-wr840n/v3/)
* [V2](https://www.tp-link.com/fr/support/download/tl-wr840n/v2/)
* [V1](https://www.tp-link.com/fr/support/download/tl-wr840n/v1/)

[>Comment trouver la version matérielle d'un appareil TP-Link ?](/fr/support/faq/46/)

IMPORTANT: les disponibilités des modèles et des versions matérielles varient selon les régions. Merci de vous référer au site TP-Link du pays qui vous concerne.
Récapitulatif Produit

* [TL-WR840N(EU)\_V6\_Datasheet](https://static.tp-link.com/2017/201712/20171229/TL-WR840N%28EU%29%206.0.pdf)

Documents

* [SOHO Router(EU1-12Languages)\_Quick Installation Guide](https://static.tp-link.com/2020/202001/20200102/7106508530_SOHOrouter%28EU1_12languages%29_QIG_V1.pdf)
* [TL-WR840N(EU)\_V6\_User Guide](https://static.tp-link.com/2018/201802/20180202/1910012351_TL-WR840N_UG_V6.pdf)
* [TL-WR840N(EU)\_V6\_Quick Installation Guide](https://static.tp-link.com/2018/201802/20180202/7106507934_TL-WR840N_QIG_V6.pdf)

[*![]()*

TL-WR840N](/fr/products/details/tl-wr840n.html)

* Vidéo d'installation
* FAQ
* Firmware
* Applications smartphones
* Code GPL
* Emulateurs

## Vidéo d'installation

* How to Set up Address Reservation on TP-Link Routers Windows

  This video will show you how to set up Address Reservation on TP-Link routers.

  Plus
  Pli
* What should I do if I cannot access the internet? - Using a DSL modem and a TP-Link router

  If you can’t access the internet using a DSL modem and TP-Link router, this video can help you solve the problem.

  Plus
  Pli
* What should I do if I cannot access the internet? - Using a cable modem and a TP-Link router

  If you can’t access the internet using a cable modem and TP-Link router, follow this video step by step to solve your problem.

  Plus
  Pli
* How to turn a router into an Access Point?

*Filtre:*
Tout
Application utilisateur requiseExplications sur le Q&A Durant l'installationAssistance avancéeGuide de ConfigurationDépannage

## FAQs

* [Pourquoi ai-je reçu un e-mail intitulé « Vulnérabilités potentielles détectées dans votre compte » ?](/fr/support/faq/4349/)
  01-15-20253546
* [Comment partager le réseau sur l'application Tether](/fr/support/faq/4318/)
  11-29-20248418
* [Brève introduction du canal sans fil, de la largeur du canal et du DFS](/fr/support/faq/4309/)
  11-12-202413873
* [Comment trouver ou modifier le mot de passe WiFi sur les routeurs WiFi TP-Link](/fr/support/faq/399/)
  02-27-20236876362
* [Comment améliorer le débit ou la portée WiFi ?](/fr/support/faq/468/)
  12-19-20181803710
* [Comment me connecter à l'utilitaire Web (page de gestion) du routeur WiFi TP-Link ?](/fr/support/faq/87/)
  04-18-201921084464
* [Comment effectuer un dépannage à partir du journal système lorsque la connexion PPPoE échoue](/fr/support/faq/596/)
  02-02-2024255587
* [Comment configurer le routeur WiFi TP-Link sur la page de gestion Web](/fr/support/faq/3841/)
  12-19-2023570730
* [How to choose right TP-Link product for your internet service](/fr/support/faq/3838/)
  12-19-202331375
* [Dois-je utiliser Dynamic IP ou PPPoE ?](/fr/support/faq/3837/)
  12-15-202365901
* [Comment afficher le journal système du routeur WiFi TP-Link?](/fr/support/faq/70/)
  12-15-2023993096
* [Comment configurer le routeur Wi-Fi TP-Link avec Singtel sur l'application Tether](/fr/support/faq/3835/)
  12-15-202321207
* [How to setup TP-Link Wi-Fi Router with Singtel on web management page](/fr/support/faq/3836/)
  12-14-202325484
* [Comment mettre à niveau la version du firmware du routeur WiFi TP-Link ?](/fr/support/faq/688/)
  12-12-20232844126
* [Comment installer le routeur sans fil TP-Link pour qu'il fonctionne avec un modem (IP statique) ?](/fr/support/faq/609/)
  11-14-2023441302
* [Comment configurer le contrôle d'accès pour le blocage de sites Web sur le routeur sans fil TP-Link 11N (nouveau logo)](/fr/support/faq/1387/)
  11-14-2023568778
* [Comment configurer les propriétés TCP/IP sur Vista pour se connecter au routeur TP-Link](/fr/support/faq/63/)
  10-18-20238377
* [Comment réinitialiser les produits TP-Link avec le bouton WPS / RESET aux paramètres d'usine](/fr/support/faq/497/)
  12-19-20187084242
* [Comment configurer le routage statique sur les routeurs sans fil](/fr/support/faq/560/)
  08-10-2023702915
* [Comment configurer les paramètres sans fil de base de mes routeurs TP-Link 11N (nouveau logo) ?](/fr/support/faq/1374/)
  08-10-2023337877
* [Que dois-je faire si le voyant Internet est éteint ou s'il y a un message d'erreur «WAN Port Unplugged» sur la page du routeur TP-Link?](/fr/support/faq/2982/)
  07-07-2023485333
* [Pourquoi la fonction de redirection de port ne fonctionne pas sur mon routeur WiFi et Deco ?](/fr/support/faq/785/)
  11-04-2022817253
* [Comment connecter un routeur TP-Link avec Starlink](/fr/support/faq/3652/)
  05-26-2023419110
* [Que dois-je faire si ma connexion Internet est lente ?](/fr/support/faq/2170/)
  05-26-2023580972
* [Comment configurer le routeur WiFi 11N TP-Link en tant que répéteur (nouveau logo)](/fr/support/faq/1383/)
  04-20-2023135830
* [Comment vérifier s'il existe un problème matériel avec votre routeur WiFi TP-Link](/fr/support/faq/2448/)
  05-17-2019257972
* [Quelles sont les questions les plus fréquemment posées sur le débit des routeurs TP-Link?](/fr/support/faq/690/)
  10-28-2019870348
* [Comment lier une adresse IP et une adresse MAC sur un routeur TP-Link?](/fr/support/faq/170/)
  06-19-2019593664
* [Que dois-je faire si la connexion WiFi ne peut pas fonctionner sur mon routeur WiFi TP-Link?](/fr/support/faq/2708/)
  09-16-2022293700
* [Comment utiliser le contrôle de bande passante sur un routeur WiFi TP-Link?](/fr/support/faq/557/)
  12-20-20181712492
* [Comment mettre à niveau la version du firmware du routeur sans fil TP-Link 11N (nouveau logo)](/fr/support/faq/1388/)
  08-26-2022164350
* [Comment utiliser la fonction WDS Bridging pour étendre mon réseau sans fil ?](/fr/support/faq/1555/)
  08-26-2022648733
* [Comment protéger vos périphériques réseau TP-Link contre les attaques potentielles](/fr/support/faq/573/)
  08-26-2022138145
* [Comment configurer les paramètres WiFi de base pour mon routeur WiFi 11 N TP-Link ?](/fr/support/faq/78/)
  04-18-201911939464
* [Routeur modem DSL en mode pont en conjonction avec un routeur WiFi évitant le double NAT](/fr/support/faq/3113/)
  07-08-2022169037
* [Pourquoi mon routeur TP-Link ne peut pas obtenir les paramètres WAN de mon modem ?](/fr/support/faq/138/)
  12-19-20184629733
* [What Can I Do If I Forget the Login Username/Password of My Router?](/fr/support/faq/139/)
  06-29-202220717
* [How to confirm whether the router is connected to internet through Diagnostic function](/fr/support/faq/224/)
  06-29-2022379529
* [Comment configurer le contrôle d'accès pour le blocage de sites Web sur le routeur sans fil TP-Link (ancienne interface utilisateur verte)?](/fr/support/faq/273/)
  12-20-20181087878
* [Comment configurer DDNS (DynDNS) sur un routeur WiFi ?](/fr/support/faq/297/)
  12-20-2018641597
* [Comment configurer le filtre d'adresse MAC WiFi sur un routeur WiFi ?](/fr/support/faq/324/)
  12-20-2018968423
* [Comment utiliser la fonction de contrôle parental sur un routeur WiFi ?](/fr/support/faq/350/)
  12-20-2018502511
* [Comment trouver la clé sans fil sur le routeur 11N?](/fr/support/faq/355/)
  08-10-2018771115
* [How to Setup DDNS (No-IP) on TP-Link Wireless Router](/fr/support/faq/419/)
  06-29-2022384390
* [Comment installer un routeur WiFi TP-Link pour fonctionner avec un modem DSL (PPPoE)?](/fr/support/faq/618/)
  12-19-20182795187
* [How to install TP-Link 11N wireless router to work with a DSL Modem (PPPoE- new logo)](/fr/support/faq/1376/)
  06-28-2022109452
* [How to bind IP Address and MAC Address on TP-Link 11N Router (new logo)](/fr/support/faq/1380/)
  06-28-202279065
* [How to configure Address Reservation on TP-Link 11N wireless router (new logo)](/fr/support/faq/1381/)
  06-28-2022137121
* [Comment configurer le filtrage MAC sans fil sur le routeur sans fil TP-Link 11N (nouveau logo) ?](/fr/support/faq/1386/)
  02-21-2022205940
* [How to use Parental Control function on TP-Link 11N Wireless router (new logo)](/fr/support/faq/1389/)
  06-28-2022109997
* [Comment mettre à niveau le firmware sur les routeurs WiFi TP-Link ?](/fr/support/faq/2796/)
  03-07-2022553257
* [Comment configurer un routeur TP-Link N en tant que point d'accès WiFi ?](/fr/support/faq/417/)
  06-21-20224272054
* [Pourquoi ne peut-on pas se connecter à la page de gestion avec NOD 32 ESET?](/fr/support/faq/358/)
  03-22-2019176663
* [Que dois-je faire si je ne parviens pas à ouvrir des sites Web spécifiques ?](/fr/support/faq/3023/)
  03-12-2021168059
* [Que faire si je ne parviens pas à me connecter à l’interface Web de mon périphérique TP-Link?](/fr/support/faq/2236/)
  12-20-20181565643
* [Que puis-je faire si j'oublie le mot de passe de connexion du routeur sans fil TP-Link?](/fr/support/faq/426/)
  12-19-20189549271
* [Que dois-je faire si je ne trouve pas mon réseau sans fil ou si je ne parviens pas à me connecter au réseau WiFi (nouveau logo)?](/fr/support/faq/1557/)
  01-08-20191900603
* [Que dois-je faire si je ne peux pas accéder à Internet alors que la configuration est terminée (nouveau logo)?](/fr/support/faq/1556/)
  01-08-20192911552
* [Que faire si le réseau WiFi est instable via mon modem routeur WiFi ?](/fr/support/faq/722/)
  04-19-20192686792
* [Redirection de port: comment configurer un serveur virtuel sur un routeur sans fil de la série TP-Link 11N (nouveau logo)?](/fr/support/faq/1379/)
  07-29-20201069872
* [How do I install TP-Link 11N wireless router to work with a Modem (Static IP-new logo)?](/fr/support/faq/1378/)
  03-17-202276388
* [How do I install a TP-Link 11N router to work with a DSL modem (Dynamic IP-new logo)?](/fr/support/faq/1375/)
  03-17-202270939
* [Exigence d'application/Choisir le type de connexion WAN sur mon routeur TP-Link](/fr/support/faq/606/)
  03-10-2022218321
* [Comment installer un routeur TP-Link pour fonctionner avec un modem câble ?](/fr/support/faq/608/)
  12-20-20181500815
* [Comment configurer la fonction de transfert de port sur mon routeur sans fil TP-Link pour Xbox Live?](/fr/support/faq/71/)
  07-29-2020339401
* [Comment configurer le clonage d'adresse MAC sur mon routeur sans fil TP-Link (interface utilisateur verte)?](/fr/support/faq/68/)
  07-29-2020401993
* [Pourquoi mon routeur TP-Link obtient une IP WAN du modem mais pas d'accès Internet ？](/fr/support/faq/361/)
  07-29-2020635914
* [Comment changer l'adresse IP d'un routeur sans fil TP-Link (interface utilisateur verte)?](/fr/support/faq/67/)
  12-19-20182323154
* [Pourquoi ne puis-je pas accéder à Internet une fois connecté au réseau WiFi du routeur TP-Link (Windows)?](/fr/support/faq/428/)
  12-20-20181658568
* [Configuration du contrôle parental sur les routeurs WiFi TP-Link via l'application Tether (TL-WR841N)](/fr/support/faq/2544/)
  07-31-2019106704
* [Comment sécuriser / protéger mon réseau sans fil en utilisant le chiffrement WEP sur un routeur WiFi 11N TP-Link?](/fr/support/faq/257/)
  06-19-2019334072
* [Tableau de comparaison des performances des routeurs WiFi TP-Link](/fr/support/faq/465/)
  04-15-2019368682
* [Comment configurer la gestion à distance pour mon routeur WiFi TP-Link ?](/fr/support/faq/66/)
  12-20-20181194290
* [Comment sécuriser / protéger mon réseau WiFi à l'aide de WPA-PSK / WPA2-PSK sur un routeur sans fil 11N TP-Link?](/fr/support/faq/256/)
  12-20-2018737536
* [Pourquoi ne puis-je pas accéder à Internet une fois connecté au réseau WiFi (MAC OS) du routeur TP-Link?](/fr/support/faq/430/)
  12-20-2018559017
* [Comment configurer la réservation d'adresses sur un routeur WiFi TP-Link](/fr/support/faq/182/)
  12-20-2018634665
* [Comment installer un routeur TP-Link pour fonctionner avec un modem DSL (Dynamic IP)?](/fr/support/faq/607/)
  12-20-2018846720
* [Comment configurer la fonction WDS sur les routeurs WiFi TP-Link (interface utilisateur verte)](/fr/support/faq/227/)
  12-20-20182356095
* [Application Requirement/Internet Access Control](/fr/support/faq/561/)
  10-17-2017174566
* [How do I reduce the MTU size on my TP-Link Router?](/fr/support/faq/69/)
  05-23-2016205586
* [Why can't I login to the web management utility of the TP-Link device?](/fr/support/faq/674/)
  12-06-201411844
* [Why cannot I login my TP-Link product?](/fr/support/faq/437/)
  11-26-201419361
* [Application Requirement/ Parental Control](/fr/support/faq/562/)
  03-20-2014108830
* [How to hard reset TP-Link products to factory default settings (Wireless Router)](/fr/support/faq/83/)
  03-15-201311843
* [What can I do if I forgot the login Username & Password (Wireless Router)？](/fr/support/faq/82/)
  02-29-200823756

**Firmware / Micrologiciel**

Une mise à jour du micrologiciel (Firmware)  interne des produits peut résoudre les problèmes de la version précédente et améliorer les performances du produit.

**Pout procéder**

**IMPORTANT**: Pour éviter les échecs de mise à jour, veuillez lire ce qui suit avec attention, avant de procéder ; en cas de doute n’hésitez pas à contacter le support technique TP-Link.

* Il est recommandé de télécharger les micrologiciels uniquement depuis le site Web TP-Link.fr. Si votre matériel a été commercialisé par une autre succursale TP-Link cliquez [ici](http://www.tp-link.fr/choose-your-location/).

* Déterminez la version matérielle de votre produit TP-Link avant de rechercher les micrologiciels conçu pour cette version.

  Un micrologiciel non spécifiquement conçu pour la version matérielle de votre produit peut endommager ce dernier et en annuler la garantie.

  (***Sauf spécifications contraires***, les sous-versions matérielles acceptent les micrologiciels de la version principale : V2 = V2.0, V2.1, V2.x…

  en revanche V1 ne peut recevoir les micrologiciels de V2, V3, Vx et inversement)
* [Comment trouver la version matérielle d’un produit TP-Link](http://www.tp-link.fr/faq-46.html) ?
* **Ne coupez PAS l'alimentation électrique du produit TP-Link pendant sa mise à jour**, cela pourrait l’endommager de façon permanente.
* **Ne procédez PAS à la mise à jour du micrologiciel via une connexion Wi-Fi** (sauf bien entendu pour les produits dépourvus de connexion Ethernet).
* Il est très fortement recommandé de procéder à la mise à jour depuis un ordinateur non connecté à internet (uniquement durant le temps de cette mise à jour).
* Utilisez un logiciel (au cas où votre système d’exploitation n’intègre pas cette fonctionnalité) pour extraire le micrologiciel du fichier (.zip ou .rar) que vous aurez téléchargé depuis notre site.
* **Aucun micrologiciel n’est exécutable directement** il faut passer par l’interface du produit ou de l’utilitaire associé (cf. mode d’emploi du produit) pour procéder à la mise à jour.

Plus
Pli

| TL-WR840N(EU)\_V6\_240117 | | Téléchargement Important Notice Please upgrade firmware/software from the local TP-Link official website of the purchase location for your TP-Link device, otherwise it may cause upgrade failure or mistakes and be against the warranty. [Still Download](https://static.tp-link.com/upload/firmware/2024/202403/20240315/TL-WR840N%28EU%29_V6_240117.zip)  [Go to Local Website](https://www.tp-link.com/uk/support/download/tl-wr840n/v6/) |
| --- | --- | --- |
| Date de publication: 2024-03-15 | Langue:  Anglais | Taille du fichier: 4.47 MB |
| Modifications and Bug Fixes:  Enhance device security. | | |

| TL-WR840N(EU)\_V6\_220120 | | Téléchargement Important Notice Please upgrade firmware/software from the local TP-Link official website of the purchase location for your TP-Link device, otherwise it may cause upgrade failure or mistakes and be against the warranty. [Still Download](https://static.tp-link.com/upload/firmware/2022/202202/20220215/TL-WR840Nv6_EU_0.9.1_4.19_up_boot%5B220120-rel55489%5D.zip)  [Go to Local Website](https://www.tp-link.com/uk/support/download/tl-wr840n/v6/) |
| --- | --- | --- |
| Date de publication: 2022-03-18 | Langue:  Anglais | Taille du fichier: 3.80 MB |
| Release note:  Modifications and Bug Fixes  Enhance device security  Notes:  For TL-WR840N(EU) V6.0.  This firmware can not be degraded to the previous firmware. | | |

| TL-WR840N(EU)\_V6\_210727 | | Téléchargement Important Notice Please upgrade firmware/software from the local TP-Link official website of the purchase location for your TP-Link device, otherwise it may cause upgrade failure or mistakes and be against the warranty. [Still Download](https://static.tp-link.com/upload/firmware/2021/202107/20210730/TL-WR840Nv6_EU_0.9.1_4.19_up_boot%5B210727-rel41107%5D.zip)  [Go to Local Website](https://www.tp-link.com/uk/support/download/tl-wr840n/v6/) |
| --- | --- | --- |
| Date de publication: 2021-07-30 | Langue:  Anglais | Taille du fichier: 4.35 MB |
| Release note:  Fixed some bugs | | |

**Utiliser un firmware tiers non développé ni distribué par TP-Link dans les produits TP-Link**

Certains firmwares officiels de produits TP-Link peuvent être remplacés par des firmwares tiers tels que : OpenWrt, DD-WRT, LEDE, Gargoyle etc.

TP-Link n'a aucune obligation de support concernant ces micrologiciels, et ne garantit en aucun cas performances et stabilité des produits qui seraient pourvus de ces firmwares.

L'altération fonctionnelle d’un produit consécutif à l’installation et/ou à l'utilisation d'un firmware tiers annulera de fait la garantie de ce produit.

**Accès au code source soumis à licence GPL**

Remarque : Les produits de TP-Link contiennent des portions de logiciel développées par des tiers, ce qui inclus du code soumis à la licence GNU (GPL), Version 1, Version 2, Version 3 ou GNU Lesser General Public License (" LGPL "). Vous pouvez utiliser le code concerné à condition de respecter les termes de la licence.

Vous pouvez consulter, imprimer et télécharger les conditions de la licence GPL [ici](https://static.tp-link.com/resources/document/GPL%20License%20Terms.pdf). Vous trouverez les codes source GPL des logiciels respectifs utilisés dans les produits TP-Link pour le téléchargement direct et d'autres informations, y compris une liste des logiciels TP-Link contenant du code logiciel soumis à licence GPL dans le [Centre de code GPL](/fr/support/gpl-code/).

Les programmes respectifs sont distribués SANS AUCUNE GARANTIE ; sans même la garantie implicite de QUALITÉ MARCHANDE ou d'ADÉQUATION À UN USAGE PARTICULIER. Voir la licence publique générale GNU respective pour plus de détails.

## Apps

![](https://static.tp-link.com/res/style/images/tp-link-tether.png)
TP-Link Tether

TP-Link Tether offre le moyen le plus simple d'accéder à votre réseau et de le gérer avec vos appareils iOS ou Android. En savoir plus sur [TP-Link Tether](https://www.tp-link.com/tether/) et [les appareils compatibles](https://www.tp-link.com/tether/product-list/)

![](https://static.tp-link.com/res/images/qrcode/app-tether.png)

* ![TP-Link Tether Android APP download](https://static.tp-link.com/res/style/images/android_en.png)
* ![TP-Link Tether IOS APP download](https://static.tp-link.com/res/style/images/ios_en.svg)

Remarque : pour utiliser Tether, veuillez mettre à jour le firmware de votre appareil TP-Link vers la dernière version.

## Code GPL

* [TL-WR840N\_V6\_GPL](https://static.tp-link.com/resources/gpl/TL-WR840NV6.tar.gz)

## Emulateurs

| Version firmware | Mode de fonctionnement | Langue |  |
| --- | --- | --- | --- |
| 171220 | - | Anglais | [Parcourir](https://emulator.tp-link.com/Emulator_TL-WR840NV6_EU/index.htm) |

**Remarques:**

**1. L'émulateur est une interface graphique Web virtuelle où vous pouvez découvrir le panneau de gestion des produits TP-Link.**

**2. Les émulateurs répertoriés peuvent ne pas avoir le dernier firmware.**

**3. Les fonctionnalités affichées sont fournies à titre indicatif et leur disponibilité peut dépendre des réglementations locales. Pour plus d'informations, veuillez vous référer à la fiche technique ou à la page du produit.**

## Newsletter TP-Link>TP-Link prend votre vie privée au sérieux. Pour plus de détails sur la politique de confidentialité de TP-Link, veuillez consultez la page suivante [Politique de confidentialité de TP-Link](https://privacy.tp-link.com/web/official/privacy-policy?region=FR) .

E-mail

Email Error

S'enregistrer

Gamme Grand Public

Gamme Maison Connectée

Gamme Entreprises

Je souhaite recevoir la newsletter TP-Link France afin de découvrir ses nouveautés produits et ses offres promotionnelles.

En cochant cette case, je confirme avoir pris connaissance de notre [Politique de confidentalité](https://privacy.tp-link.com/web/official/privacy-policy?region=FR).

reCaptcha not verified

S'enregistrer

## Suivez-nous

* [Facebook](https://www.facebook.com/tplink.fr/)
* [Youtube](https://www.youtube.com/user/tplinkFrance)
* [Linkedin](https://www.linkedin.com/company/9182801/)
* [Twitter](https://twitter.com/TPLinkFrance%20)
* [Instagram](https://www.instagram.com/tplink_france/?hl=fr)

A propos de TP-Link

* [Profil Corporate](/fr/about-us/corporate-profile/)
* [A propos de nous](/fr/about/about-us/)
* [Notre Groupe](/fr/about/group/)
* [Développement Durable](/fr/sustainability/)
* [Contactez-nous](/fr/about-us/contact/)
* [Politique de confidentialité](https://privacy.tp-link.com/web/official/privacy-policy?region=FR)
* [Emploi](/fr/about-us/career/)
* [Conditions d'utilisation](https://privacy.tp-link.com/web/official/terms-of-use)
* [Politique relative aux cookies](https://privacy.tp-link.com/web/cookie/policy?language=fra)
* [Conformité CE](/fr/support/ce/)
* [Recyclage EEE](/fr/about-us/deee/)

Actualité

* [Communiqués de presse](/fr/press/news/)
* [La Presse en Parle](/fr/press/award/)
* [Avis de sécurité](/fr/press/security-advisory/)
* [Blog](/fr/blog/)

[Où acheter](/fr/where-to-buy/)

* [Boutiques en ligne](/fr/where-to-buy/#Boutiques en ligne)
* [Grande Distribution](/fr/where-to-buy/#Grande Distribution)

Pour en savoir plus

* [Librairie](/fr/learning-center/)

[Catalogues](/fr/product-catalogue/)

* [Catalogues Grand Public](/fr/product-catalogue/soho/)
* [Catalogues Solutions Pro](/fr/product-catalogue/smb/)

* [![tp-link](https://static.tp-link.com/upload/menu/tp-link_20231205034128d.png)](https://www.tp-link.com/fr/)
* [![omada](https://static.tp-link.com/upload/menu/omada_20231205034833a.png)](https://www.omadanetworks.com/fr/)
* ![Tapo](https://static.tp-link.com/upload/menu/tapo_20231205034542j.png)

Copyright © 2025 TP-Link Entreprises France SARL. Tous droits réservés.

[France / Français](/fr/choose-your-location/)

De Ireland?

Infos produits, événements, services pour votre pays.

[OK](https://www.tp-link.com/uk/support/download/tl-wr840n/v6/)
[Autre option](https://www.tp-link.com/fr/choose-your-location/)

Close

Ce site Web utilise des cookies pour améliorer la navigation sur le site Web, analyser les activités en ligne et offrir aux utilisateurs la meilleure expérience sur notre site Web. Vous pouvez vous opposer à tout moment à l'utilisation de cookies. Vous pouvez obtenir plus d'informations dans notre  [politique de confidentialité](https://privacy.tp-link.com/web/official/privacy-policy?region=FR) .

Paramètres des cookies
Accepter tous les cookies

Ce site Web utilise des cookies pour améliorer la navigation sur le site Web, analyser les activités en ligne et offrir aux utilisateurs la meilleure expérience sur notre site Web. Vous pouvez vous opposer à tout moment à l'utilisation de cookies. Vous pouvez obtenir plus d'informations dans notre  [politique de confidentialité](https://privacy.tp-link.com/web/official/privacy-policy?region=FR) .

Cookies basiques

Ces cookies sont nécessaires au fonctionnement du site Web et ne peuvent pas être désactivés dans vos systèmes.

TP-Link

accepted\_local\_switcher, tp\_privacy\_base, tp\_privacy\_marketing, tp\_smb-select-product\_scence, tp\_smb-select-product\_scenceSimple, tp\_smb-select-product\_userChoice, tp\_smb-select-product\_userChoiceSimple, tp\_smb-select-product\_userInfo, tp\_smb-select-product\_userInfoSimple, tp\_top-banner, tp\_popup-bottom, tp\_popup-center, tp\_popup-right-middle, tp\_popup-right-bottom, tp\_productCategoryType

Chat en direct

\_\_livechat, \_\_lc2\_cid, \_\_lc2\_cst, \_\_lc\_cid, \_\_lc\_cst, CASID

Youtube

id, VISITOR\_INFO1\_LIVE, LOGIN\_INFO, SIDCC, SAPISID, APISID, SSID, SID, YSC, \_\_Secure-1PSID, \_\_Secure-1PAPISID, \_\_Secure-1PSIDCC, \_\_Secure-3PSID, \_\_Secure-3PAPISID, \_\_Secure-3PSIDCC, 1P\_JAR, AEC, NID, OTZ

Cookies d'analyse et marketing

Les cookies d'analyse nous permettent d'analyser vos activités sur notre site Web pour améliorer et ajuster les fonctionnalités de notre site Web.

Les cookies marketing peuvent être définis via notre site Web par nos partenaires publicitaires afin de créer un profil de vos intérêts et pour vous montrer des publicités pertinentes sur d'autres sites Web.

Google Analytics & Google Tag Manager

\_gid, \_ga\_<container-id>, \_ga, \_gat\_gtag\_<container-id>

Google Ads et DoubleClick

test\_cookie, \_gcl\_au

Meta Pixel

\_fbp

Crazy Egg

cebsp\_, \_ce.s, \_ce.clock\_data, \_ce.clock\_event, cebs

Linkedin

lidc, AnalyticsSyncHistory, UserMatchHistory, bcookie, li\_sugr, ln\_or

Accepter tous les cookies
Enregistrer les paramètres


