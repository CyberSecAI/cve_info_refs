Based on the provided content, here's an analysis of the vulnerability fix:

**Root Cause of Vulnerability:**
The root cause was an XSS (Cross-Site Scripting) vulnerability in the `error-text.php` file. The script was taking user input from the `error` parameter in the URL (`$_GET["error"]`) without proper sanitization before displaying it on the page.

**Weaknesses/Vulnerabilities Present:**
- **Unsanitized User Input:** The script directly used the value of the `error` GET parameter.
- **Lack of Output Encoding:** While `htmlentities()` was used, it was used twice and possibly incorrectly, leading to a bypass.

**Impact of Exploitation:**
An attacker could inject malicious JavaScript code into the `error` parameter. When a user visits the page with this crafted URL, the injected script would execute in their browser, potentially leading to:
    - Session hijacking
    - Redirecting users to malicious sites
    - Stealing sensitive information
    - Defacing the website.

**Attack Vectors:**
- The attack vector was through the `error` GET parameter in the URL. An attacker would need to craft a malicious URL with the injected JavaScript code.

**Required Attacker Capabilities/Position:**
- The attacker would need to be able to craft a URL that could be visited by a target user. They do not need any special access to the server or application other than ability to make a web request.

**Details of the Fix:**
The commit `c2356cc41260551073bfaa3a94d1ab074f554938` addresses this vulnerability. The change in `error-text.php` is:

```diff
@@ -44,7 +44,7 @@
  $error_text = urldecode($_GET["error"]);
  // error_log("ET = " . $error_text);
  // if ($system_error) {
- $error_text = htmlentities($error_text);
+ $error_text = htmlentities($error_text, ENT_QUOTES | ENT_HTML5, $encoding = 'UTF-8');
  // }
  echo "<p class='warn'>" . $error_text . "</p><br/>\n";
  } else {
```
The fix removed the redundant call to `htmlentities()` and uses it with  `ENT_QUOTES | ENT_HTML5` flags. This ensures that both single and double quotes as well as other HTML5 entities are properly encoded, preventing the XSS attack.

The pull request #1822 documents the context and fix associated with the commit.