```
{
  "vulnerability": {
    "root_cause": "The vulnerability is caused by an integer overflow in the vcf_parse_format function when calculating the memory required for FORMAT fields in a VCF file. The check for excessive record size in `vcf_parse_format()` only looked at individual fields and did not consider the combined size of all fields.",
    "weaknesses": [
      "Integer overflow leading to out-of-bounds write."
    ],
    "impact": "An attacker can cause a segmentation fault or out-of-bounds write by crafting a malicious VCF file that triggers the overflow. This can lead to denial of service or potentially arbitrary code execution.",
    "attack_vectors": "The attack vector is through a crafted VCF file. An attacker would need to supply a specially crafted VCF file that contains a large number of FORMAT fields that exceed the maximum size.",
    "required_attacker_capabilities": "The attacker needs to be able to provide a malicious VCF file to the vulnerable software, HTSlib."
  },
  "affected_versions": "All versions of HTSlib prior to the fixes in 1.11 were susceptible to this issue.",
  "fixed_versions": "The issue was fixed in HTSlib 1.11 by PRs #1044 and #1104, and specifically commit dcd4b7304941a8832fba2d0fc4c1e716e7a4e72c.",
    "vulnerability_details": "The vulnerability lies within the `vcf_parse_format` function in `vcf.c`. The function calculates the memory required for FORMAT fields by multiplying the number of samples `v->n_sample` by the size of each field `f->size`. However, the check was done on individual fields and not for all fields together leading to a potential integer overflow when the cumulative size of multiple fields exceeded the maximum value of an integer (INT_MAX), resulting in a heap buffer overflow.\n\nThe fix addresses this by adding a check to ensure that the cumulative memory required for all FORMAT fields does not exceed `INT_MAX` before proceeding with memory allocation. The patch includes the amount of memory used so far `mem->l` in the check. The vulnerability was identified through fuzz testing. ",
    "cvss": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
    "epss_score": "0.340% (71st percentile)"
}
```