=== Content from github.com_546f022d_20250119_125228.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Fissues%2F3394)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Fissues%2F3394)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Mbed-TLS%2Fmbedtls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Mbed-TLS](/Mbed-TLS)
/
**[mbedtls](/Mbed-TLS/mbedtls)**
Public

* [Notifications](/login?return_to=%2FMbed-TLS%2Fmbedtls) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)
* [Star
   5.7k](/login?return_to=%2FMbed-TLS%2Fmbedtls)

* [Code](/Mbed-TLS/mbedtls)
* [Issues
  1.3k](/Mbed-TLS/mbedtls/issues)
* [Pull requests
  265](/Mbed-TLS/mbedtls/pulls)
* [Projects
  0](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

Additional navigation options

* [Code](/Mbed-TLS/mbedtls)
* [Issues](/Mbed-TLS/mbedtls/issues)
* [Pull requests](/Mbed-TLS/mbedtls/pulls)
* [Projects](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

# Leaking control-flow (Frontal attack) #3394

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosed[#3398](https://github.com/Mbed-TLS/mbedtls/pull/3398)Closed[Leaking control-flow (Frontal attack)](#top)#3394[#3398](https://github.com/Mbed-TLS/mbedtls/pull/3398)Copy linkAssignees [![gilles-peskine-arm](https://avatars.githubusercontent.com/u/26596258?s=64&v=4)](/gilles-peskine-arm)Labels[bug](https://github.com/Mbed-TLS/mbedtls/issues?q=state%3Aopen%20label%3A%22bug%22)[component-cryptoCrypto primitives and low-level interfaces](https://github.com/Mbed-TLS/mbedtls/issues?q=state%3Aopen%20label%3A%22component-crypto%22)Crypto primitives and low-level interfacesMilestone[June 2020 Sprint](https://github.com/Mbed-TLS/mbedtls/milestone/6)![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4&size=80)
## Description

![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4&size=48)[raoulstrackx](https://github.com/raoulstrackx)opened [on Jun 4, 2020](https://github.com/Mbed-TLS/mbedtls/issues/3394#issue-630705609)
### Description

* Type: Bug
* Priority: Minor

---

## Bug

**mbed TLS build:**

Version: 2.16.6

OS version: SGX

---

*Discoverers:* Ivan Puddu, Moritz Schneider, Miro Haller, Srdjan Capkun, ETH Zurich (i.e., not me)

\*Short description: The authors describe in their paper a way to determine control flow in SGX enclaves by precisely timing interrupt latency. This succeeds even in balanced branches such as:

```
if (secret == 'a') {
  var1 = 1 + var1;
  var2 = 1 + var2;
} else {
  var1 = 2 + var1;
  var2 = 2 + var2;
}

```

The root cause of this is that the front-end of the processor fetches instructions with a 16 byte well-aligned window. The time to resume an instruction will depend on its location within this fetch window (and thus its virtual address) and instructions near it.

*Full description:* <https://arxiv.org/abs/2005.11516>

*Solution:*

* Remove the secret dependent branch altogether

\*Code locations that require fixes:

* `mpi_montmul` (bignum.c: 1924):

```
    if( mbedtls_mpi_cmp_abs( A, N ) >= 0 )
        mpi_sub_hlp( n, N->p, A->p );
    else
        /* prevent timing attacks */
        mpi_sub_hlp( n, A->p, T->p );

```
## Metadata

### Assignees

* [![@gilles-peskine-arm](https://avatars.githubusercontent.com/u/26596258?s=64&v=4)gilles-peskine-arm](/gilles-peskine-arm)
### Labels

[bug](https://github.com/Mbed-TLS/mbedtls/issues?q=state%3Aopen%20label%3A%22bug%22)[component-cryptoCrypto primitives and low-level interfaces](https://github.com/Mbed-TLS/mbedtls/issues?q=state%3Aopen%20label%3A%22component-crypto%22)Crypto primitives and low-level interfaces
### Type

No type
### Projects

No projects
### Milestone

* [June 2020 Sprint](https://github.com/Mbed-TLS/mbedtls/milestone/6)
### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_5c013c27_20250119_125230.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.23.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.23.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=Mbed-TLS%2Fmbedtls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Mbed-TLS](/Mbed-TLS)
/
**[mbedtls](/Mbed-TLS/mbedtls)**
Public

* [Notifications](/login?return_to=%2FMbed-TLS%2Fmbedtls) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)
* [Star
   5.7k](/login?return_to=%2FMbed-TLS%2Fmbedtls)

* [Code](/Mbed-TLS/mbedtls/tree/v2.23.0)
* [Issues
  1.3k](/Mbed-TLS/mbedtls/issues)
* [Pull requests
  265](/Mbed-TLS/mbedtls/pulls)
* [Projects
  0](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

Additional navigation options

* [Code](/Mbed-TLS/mbedtls/tree/v2.23.0)
* [Issues](/Mbed-TLS/mbedtls/issues)
* [Pull requests](/Mbed-TLS/mbedtls/pulls)
* [Projects](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

1. [Releases](/Mbed-TLS/mbedtls/releases)
2. [v2.23.0](/Mbed-TLS/mbedtls/releases/tag/v2.23.0)

# Mbed TLS 2.23.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.23.0)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

![@yanesca](https://avatars.githubusercontent.com/u/6871045?s=40&v=4)
[yanesca](/yanesca)
released this
01 Jul 14:03

·
[19245 commits](/Mbed-TLS/mbedtls/compare/v2.23.0...development)
to development
since this release

[v2.23.0](/Mbed-TLS/mbedtls/tree/v2.23.0)

[`3ede173`](/Mbed-TLS/mbedtls/commit/3ede1737dc471199bf8d5d3824ee2545c11a497e)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## Description

This release of Mbed TLS provides bug fixes and minor enhancements. This release includes fixes for security issues and the most severe one is described in more detail in a [security advisory](https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2020-07).

## Default behavior changes

* In the experimental PSA secure element interface, change the encoding of key lifetimes to encode a persistence level and the location. Although C prototypes do not effectively change, code calling psa\_register\_se\_driver() must be modified to pass the driver's location instead of the keys' lifetime. If the library is upgraded on an existing device, keys created with the old lifetime value will not be readable or removable through Mbed TLS after the upgrade.

## Features

* New functions in the error module return constant strings for high- and low-level error codes, complementing mbedtls\_strerror() which constructs a string for any error code, including compound ones, but requires a writable buffer. Contributed by Gaurav Aggarwal in [#3176](https://github.com/Mbed-TLS/mbedtls/pull/3176).
* The new utility programs/ssl/ssl\_context\_info prints a human-readable dump of an SSL context saved with mbedtls\_ssl\_context\_save().
* Add support for midipix, a POSIX layer for Microsoft Windows.
* Add new mbedtls\_x509\_crt\_parse\_der\_with\_ext\_cb() routine which allows parsing unsupported certificate extensions via user provided callback. Contributed by Nicola Di Lieto nicola.dilieto@gmail.com in [#3243](https://github.com/Mbed-TLS/mbedtls/pull/3243) as a solution to [#3241](https://github.com/Mbed-TLS/mbedtls/issues/3241).
* Pass the "certificate policies" extension to the callback supplied to mbedtls\_x509\_crt\_parse\_der\_with\_ext\_cb() if it contains unsupported policies ([#3419](https://github.com/Mbed-TLS/mbedtls/pull/3419)).
* Added support to entropy\_poll for the kern.arandom syscall supported on some BSD systems. Contributed by Nia Alarie in [#3423](https://github.com/Mbed-TLS/mbedtls/pull/3423).
* Add support for Windows 2000 in net\_sockets. Contributed by opatomic. [#3239](https://github.com/Mbed-TLS/mbedtls/pull/3239)

## Security

* Fix a side channel vulnerability in modular exponentiation that could reveal an RSA private key used in a secure enclave. Noticed by Sangho Lee, Ming-Wei Shih, Prasun Gera, Taesoo Kim and Hyesoon Kim (Georgia Institute of Technology); and Marcus Peinado (Microsoft Research). Reported by Raoul Strackx (Fortanix) in [#3394](https://github.com/Mbed-TLS/mbedtls/issues/3394).
* Fix side channel in mbedtls\_ecp\_check\_pub\_priv() and mbedtls\_pk\_parse\_key() / mbedtls\_pk\_parse\_keyfile() (when loading a private key that didn't include the uncompressed public key), as well as mbedtls\_ecp\_mul() / mbedtls\_ecp\_mul\_restartable() when called with a NULL f\_rng argument. An attacker with access to precise enough timing and memory access information (typically an untrusted operating system attacking a secure enclave) could fully recover the ECC private key. Found and reported by Alejandro Cabrera Aldaya and Billy Brumley.
* Fix issue in Lucky 13 counter-measure that could make it ineffective when hardware accelerators were used (using one of the MBEDTLS\_SHAxxx\_ALT macros). This would cause the original Lucky 13 attack to be possible in those configurations, allowing an active network attacker to recover plaintext after repeated timing measurements under some conditions. Reported and fix suggested by Luc Perneel in [#3246](https://github.com/Mbed-TLS/mbedtls/issues/3246).

## Bugfix

* Fix the Visual Studio Release x64 build configuration for mbedtls itself. Completes a previous fix in Mbed TLS 2.19 that only fixed the build for the example programs. Reported in [#1430](https://github.com/Mbed-TLS/mbedtls/issues/1430) and fix contributed by irwir.
* Fix undefined behavior in X.509 certificate parsing if the pathLenConstraint basic constraint value is equal to INT\_MAX. The actual effect with almost every compiler is the intended behavior, so this is unlikely to be exploitable anywhere. [#3192](https://github.com/Mbed-TLS/mbedtls/pull/3192)
* Fix issue with a detected HW accelerated record error not being exposed due to shadowed variable. Contributed by Sander Visser in [#3310](https://github.com/Mbed-TLS/mbedtls/pull/3310).
* Avoid NULL pointer dereferencing if mbedtls\_ssl\_free() is called with a NULL pointer argument. Contributed by Sander Visser in [#3312](https://github.com/Mbed-TLS/mbedtls/pull/3312).
* Fix potential linker errors on dual world platforms by inlining mbedtls\_gcc\_group\_to\_psa(). This allows the pk.c module to link separately from psa\_crypto.c. Fixes [#3300](https://github.com/Mbed-TLS/mbedtls/issues/3300).
* Remove dead code in X.509 certificate parsing. Contributed by irwir in [#2855](https://github.com/Mbed-TLS/mbedtls/pull/2855).
* Include asn1.h in error.c. Fixes [#3328](https://github.com/Mbed-TLS/mbedtls/issues/3328) reported by David Hu.
* Fix potential memory leaks in ecp\_randomize\_jac() and ecp\_randomize\_mxz() when PRNG function fails. Contributed by Jonas Lejeune in [#3318](https://github.com/Mbed-TLS/mbedtls/pull/3318).
* Remove unused macros from MSVC projects. Reported in [#3297](https://github.com/Mbed-TLS/mbedtls/issues/3297) and fix submitted in [#3333](https://github.com/Mbed-TLS/mbedtls/pull/3333) by irwir.
* Add additional bounds checks in ssl\_write\_client\_hello() preventing output buffer overflow if the configuration declared a buffer that was too small.
* Set \_POSIX\_C\_SOURCE to at least 200112L in C99 code. Reported in [#3420](https://github.com/Mbed-TLS/mbedtls/issues/3420) and fix submitted in [#3421](https://github.com/Mbed-TLS/mbedtls/pull/3421) by Nia Alarie.
* Fix building library/net\_sockets.c and the ssl\_mail\_client program on NetBSD. Contributed by Nia Alarie in [#3422](https://github.com/Mbed-TLS/mbedtls/pull/3422).
* Fix false positive uninitialised variable reported by cpp-check. Contributed by Sander Visser in [#3311](https://github.com/Mbed-TLS/mbedtls/pull/3311).
* Update iv and len context pointers manually when reallocating buffers using the MBEDTLS\_SSL\_VARIABLE\_BUFFER\_LENGTH feature. This caused issues when receiving a connection with CID, when these fields were shifted in ssl\_parse\_record\_header().

## Changes

* Fix warnings about signedness issues in format strings. The build is now clean of -Wformat-signedness warnings. Contributed by Kenneth Soerensen in [#3153](https://github.com/Mbed-TLS/mbedtls/pull/3153).
* Fix minor performance issue in operations on Curve25519 caused by using a suboptimal modular reduction in one place. Found and fix contributed by Aurelien Jarno in [#3209](https://github.com/Mbed-TLS/mbedtls/pull/3209).
* Combine identical cases in switch statements in md.c. Contributed by irwir in [#3208](https://github.com/Mbed-TLS/mbedtls/pull/3208).
* Simplify a bounds check in ssl\_write\_certificate\_request(). Contributed by irwir in [#3150](https://github.com/Mbed-TLS/mbedtls/pull/3150).
* Unify the example programs termination to call mbedtls\_exit() instead of using a return command. This has been done to enable customization of the behavior in bare metal environments.
* Fix mbedtls\_x509\_dn\_gets to escape non-ASCII characters as "?". Contributed by Koh M. Nakagawa in [#3326](https://github.com/Mbed-TLS/mbedtls/pull/3326).
* Use FindPython3 when cmake version >= 3.15.0
* Abort the ClientHello writing function as soon as some extension doesn't fit into the record buffer. Previously, such extensions were silently dropped. As a consequence, the TLS handshake now fails when the output buffer is not large enough to hold the ClientHello.
* The unit tests now rely on header files in tests/include/test and source files in tests/src. When building with make or cmake, the files in tests/src are compiled and the resulting object linked into each test executable.
* The ECP module, enabled by `MBEDTLS_ECP_C`, now depends on `MBEDTLS_CTR_DRBG_C` or `MBEDTLS_HMAC_DRBG_C` for some side-channel coutermeasures. If side channels are not a concern, this dependency can be avoided by enabling the new option `MBEDTLS_ECP_NO_INTERNAL_RNG`.
* Align MSVC error flag with GCC and Clang. Contributed by Carlos Gomes Martinho. [#3147](https://github.com/Mbed-TLS/mbedtls/pull/3147)
* Remove superfluous assignment in mbedtls\_ssl\_parse\_certificate(). Reported in [#3182](https://github.com/Mbed-TLS/mbedtls/issues/3182) and fix submitted by irwir. [#3217](https://github.com/Mbed-TLS/mbedtls/pull/3217)
* Fix typo in XTS tests. Reported and fix submitted by Kxuan. [#3319](https://github.com/Mbed-TLS/mbedtls/pull/3319)

## Who should update

We recommend all affected users should update to take advantage of the bug fixes contained in this release at an appropriate point in their development lifecycle.

## Checksum

The SHA256 hashes for the archives are:

```
9933fe6b5991d5308e183a5a07454f76d7054721ba269d0c3811b227cb629e7a  mbedtls-2.23.0.tar.gz
bbf9c3cc6b7603f2f15bbba7badcf6cf188a9d5aaa63c4df2d61213f459c2f5f  mbedtls-2.23.0.zip

```

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.gentoo.org_d3ae1f2c_20250119_125227.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 730752
<net-libs/mbedtls-{2.16.7,2.23.0}: Multiple vulnerabilities (CVE-2020-{36421,36422,36423})
Last modified: 2023-01-11 05:24:41 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=730752&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=730752&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 730752**](show_bug.cgi?id=730752)
(CVE-2020-36421, CVE-2020-36422, CVE-2020-36423)
- <net-libs/mbedtls-{2.16.7,2.23.0}: Multiple vulnerabilities (CVE-2020-{36421,36422,36423})

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<net-libs/mbedtls-{2.16.7,2.23.0}: Multiple vulnerabilities (CVE-2020-{36421,...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2020-36421, CVE-2020-36422, CVE-2020-36423 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal minor | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B4 [glsa+ cve] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | PullRequest | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [CVE-2020-16150, CVE-2020-36424, CVE-2020-36425, CVE-2020-36426, CVE-2020-36476, CVE-2020-36477](show_bug.cgi?id=740108 "RESOLVED FIXED - <net-libs/mbedtls-{2.16.8,2.24.0}: Multiple vulnerabilities (CVE-2020-{16150,36424,36425,36426})") | |  | Show dependency [tree](showdependencytree.cgi?id=730752&hide_resolved=1) | |  | | Reported: | 2020-07-04 18:49 UTC by Sam James | | --- | --- | | Modified: | 2023-01-11 05:24 UTC ([History](show_activity.cgi?id=730752)) | | CC List: | 2 users (show)  ajak blueness | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * <https://github.com/gentoo/gentoo/pull/17764> | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") | net-libs/mbedtls-2.16.7-r1 amd64 arm64 ppc64 x86 net-libs/mbedtls-2.23.0-r1 amd64 arm64 ppc64 x86 | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=730752&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=730752&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-04 18:49:20 UTC  ``` Release notes: * 2.16.7: <https://github.com/ARMmbed/mbedtls/releases/tag/mbedtls-2.16.7> * 2.23.0: <https://github.com/ARMmbed/mbedtls/releases/tag/mbedtls-2.23.0>  "Fix a side channel vulnerability in modular exponentiation that could reveal an RSA private key used in a secure enclave. Noticed by Sangho Lee, Ming-Wei Shih, Prasun Gera, Taesoo Kim and Hyesoon Kim (Georgia Institute of Technology); and Marcus Peinado (Microsoft Research). Reported by Raoul Strackx (Fortanix) in 3394.      Fix side channel in mbedtls_ecp_check_pub_priv() and mbedtls_pk_parse_key() / mbedtls_pk_parse_keyfile() (when loading a private key that didn't include the uncompressed public key), as well as mbedtls_ecp_mul() / mbedtls_ecp_mul_restartable() when called with a NULL f_rng argument. An attacker with access to precise enough timing and memory access information (typically an untrusted operating system attacking a secure enclave) could fully recover the ECC private key. Found and reported by Alejandro Cabrera Aldaya and Billy Brumley.      Fix issue in Lucky 13 counter-measure that could make it ineffective when hardware accelerators were used (using one of the MBEDTLS_SHAxxx_ALT macros). This would cause the original Lucky 13 attack to be possible in those configurations, allowing an active network attacker to recover plaintext after repeated timing measurements under some conditions. Reported and fix suggested by Luc Perneel in 3246."  See <https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2020-07> for details on the first vulnerability. ```  [Comment 1](#c1)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-04 18:50:24 UTC  ``` Let us know when ready to stable, thanks! ```  [Comment 2](#c2)  Anthony Basile   gentoo-dev  2020-07-05 15:11:16 UTC  ``` (In reply to Sam James (sec padawan) from [comment #1](show_bug.cgi?id=730752#c1)) > Let us know when ready to stable, thanks!  They should be ready.  KEYWORDS="amd64 arm arm64 ppc ppc64 x86" ```  [Comment 3](#c3)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-05 16:36:02 UTC  ``` (In reply to Anthony Basile from [comment #2](show_bug.cgi?id=730752#c2)) > (In reply to Sam James (sec padawan) from [comment #1](show_bug.cgi?id=730752#c1)) > > Let us know when ready to stable, thanks! >  > They should be ready. >  > KEYWORDS="amd64 arm arm64 ppc ppc64 x86"  Thanks! ```  [Comment 4](#c4)  Sergei Trofimovich (RETIRED)   gentoo-dev  2020-07-08 07:50:01 UTC  ``` ppc stable ```  [Comment 5](#c5)  Agostino Sarubbo   gentoo-dev  2020-07-09 08:04:38 UTC  ``` arm stable ```  [Comment 6](#c6)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-17 00:05:43 UTC  ``` amd64, ppc64, x86: ping ```  [Comment 7](#c7)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-17 01:21:44 UTC  ``` arm64 stable ```  [Comment 8](#c8)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-17 01:39:01 UTC  ``` ppc64 stable ```  [Comment 9](#c9)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-17 23:30:21 UTC  ``` x86 stable ```  [Comment 10](#c10)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-17 23:30:44 UTC  ``` amd64 stable  ---- Please cleanup. ```  [Comment 11](#c11)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-26 15:58:12 UTC  ``` GLSA vote: yes ```  [Comment 12](#c12)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2020-09-21 03:28:21 UTC  ``` Ping ```  [Comment 13](#c13)  Larry the Git Cow   gentoo-dev  2020-10-04 14:01:19 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=2eec5b536cc676a688ff316087a71c31d4ffe303>  commit 2eec5b536cc676a688ff316087a71c31d4ffe303 Author:     John Helmert III <jchelmert3@posteo.net> AuthorDate: 2020-10-04 02:12:25 +0000 Commit:     Sam James <sam@gentoo.org> CommitDate: 2020-10-04 14:00:01 +0000      net-libs/mbedtls: security cleanup          Bug: <https://bugs.gentoo.org/730752>     Package-Manager: Portage-3.0.8, Repoman-3.0.1     Signed-off-by: John Helmert III <jchelmert3@posteo.net>     Closes: <https://github.com/gentoo/gentoo/pull/17764>     Signed-off-by: Sam James <sam@gentoo.org>   net-libs/mbedtls/Manifest                 |  2 -  net-libs/mbedtls/mbedtls-2.16.6.ebuild    | 94 -------------------------------  net-libs/mbedtls/mbedtls-2.22.0-r1.ebuild | 94 -------------------------------  3 files changed, 190 deletions(-) ```   [Comment 14](#c14)  NATTkA bot   gentoo-dev  2020-10-31 12:08:56 UTC  Comment hidden (obsolete)  ``` Unable to check for sanity:  > no match for package: net-libs/mbedtls-2.16.7-r1 ```  [Comment 15](#c15)  NATTkA bot   gentoo-dev  2021-04-01 20:12:44 UTC  ``` Unable to check for sanity:  > no match for package: net-libs/mbedtls-2.16.7-r1 ```  [Comment 16](#c16)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2021-07-18 18:48:58 UTC  ``` CVEs requested for these. ```  [Comment 17](#c17)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2021-07-19 15:27:34 UTC  ``` (In reply to Sam James from [comment #0](show_bug.cgi?id=730752#c0)) > Release notes: > * 2.16.7: <https://github.com/ARMmbed/mbedtls/releases/tag/mbedtls-2.16.7> > * 2.23.0: <https://github.com/ARMmbed/mbedtls/releases/tag/mbedtls-2.23.0> >  > "Fix a side channel vulnerability in modular exponentiation that could > reveal an RSA private key used in a secure enclave. Noticed by Sangho Lee, > Ming-Wei Shih, Prasun Gera, Taesoo Kim and Hyesoon Kim (Georgia Institute of > Technology); and Marcus Peinado (Microsoft Research). Reported by Raoul > Strackx (Fortanix) in 3394.  CVE-2020-37421  >     Fix side channel in mbedtls_ecp_check_pub_priv() and > mbedtls_pk_parse_key() / mbedtls_pk_parse_keyfile() (when loading a private > key that didn't include the uncompressed public key), as well as > mbedtls_ecp_mul() / mbedtls_ecp_mul_restartable() when called with a NULL > f_rng argument. An attacker with access to precise enough timing and memory > access information (typically an untrusted operating system attacking a > secure enclave) could fully recover the ECC private key. Found and reported > by Alejandro Cabrera Aldaya and Billy Brumley.  CVE-2020-36422  >     Fix issue in Lucky 13 counter-measure that could make it ineffective > when hardware accelerators were used (using one of the MBEDTLS_SHAxxx_ALT > macros). This would cause the original Lucky 13 attack to be possible in > those configurations, allowing an active network attacker to recover > plaintext after repeated timing measurements under some conditions. Reported > and fix suggested by Luc Perneel in 3246."  CVE-2020-36423  > See > <https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security>- > advisory-2020-07 for details on the first vulnerability. ```  [Comment 18](#c18)  Larry the Git Cow   gentoo-dev  2022-08-11 03:53:55 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=2aa8d23c8600f65ddf12a27696c2b4b99babbd79>  commit 2aa8d23c8600f65ddf12a27696c2b4b99babbd79 Author:     John Helmert III <ajak@gentoo.org> AuthorDate: 2022-08-11 03:50:22 +0000 Commit:     John Helmert III <ajak@gentoo.org> CommitDate: 2022-08-11 03:50:22 +0000      profiles: last rite app-admin/logcheck          Bug: <https://bugs.gentoo.org/730752>     Signed-off-by: John Helmert III <ajak@gentoo.org>   profiles/package.mask | 5 +++++  1 file changed, 5 insertions(+) ```  [Comment 19](#c19)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-08-11 03:54:51 UTC  ``` (In reply to Larry the Git Cow from [comment #18](show_bug.cgi?id=730752#c18)) > The bug has been referenced in the following commit(s): >  > <https://gitweb.gentoo.org/repo/gentoo.git/commit/> > ?id=2aa8d23c8600f65ddf12a27696c2b4b99babbd79 >  > commit 2aa8d23c8600f65ddf12a27696c2b4b99babbd79 > Author:     John Helmert III <ajak@gentoo.org> > AuthorDate: 2022-08-11 03:50:22 +0000 > Commit:     John Helmert III <ajak@gentoo.org> > CommitDate: 2022-08-11 03:50:22 +0000 >  >     profiles: last rite app-admin/logcheck >      >     Bug: <https://bugs.gentoo.org/730752> >     Signed-off-by: John Helmert III <ajak@gentoo.org> >  >  profiles/package.mask | 5 +++++ >  1 file changed, 5 insertions(+)  Sorry, wrong bug ```  [Comment 20](#c20)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-12-22 23:46:58 UTC  ``` GLSA request filed. ```  [Comment 21](#c21)  Larry the Git Cow   gentoo-dev  2023-01-11 05:22:52 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/data/glsa.git/commit/?id=f524f5fa47d9d739280d4530623a93084918da39>  commit f524f5fa47d9d739280d4530623a93084918da39 Author:     GLSAMaker <glsamaker@gentoo.org> AuthorDate: 2023-01-11 05:19:06 +0000 Commit:     John Helmert III <ajak@gentoo.org> CommitDate: 2023-01-11 05:22:06 +0000      [ GLSA 202301-08 ] Mbed TLS: Multiple Vulnerabilities          Bug: <https://bugs.gentoo.org/730752>     Bug: <https://bugs.gentoo.org/740108>     Bug: <https://bugs.gentoo.org/764317>     Bug: <https://bugs.gentoo.org/778254>     Bug: <https://bugs.gentoo.org/801376>     Bug: <https://bugs.gentoo.org/829660>     Bug: <https://bugs.gentoo.org/857813>     Signed-off-by: GLSAMaker <glsamaker@gentoo.org>     Signed-off-by: John Helmert III <ajak@gentoo.org>   glsa-202301-08.xml | 62 ++++++++++++++++++++++++++++++++++++++++++++++++++++++  1 file changed, 62 insertions(+) ```  [Comment 22](#c22)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2023-01-11 05:24:41 UTC  ``` GLSA released, all done! ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=730752)
* - [XML](show_bug.cgi?ctype=xml&id=730752)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=730752)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=730752&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=730752&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=730752&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from github.com_5f789cf0_20250119_125229.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.16.7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.16.7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=Mbed-TLS%2Fmbedtls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Mbed-TLS](/Mbed-TLS)
/
**[mbedtls](/Mbed-TLS/mbedtls)**
Public

* [Notifications](/login?return_to=%2FMbed-TLS%2Fmbedtls) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)
* [Star
   5.7k](/login?return_to=%2FMbed-TLS%2Fmbedtls)

* [Code](/Mbed-TLS/mbedtls/tree/v2.16.7)
* [Issues
  1.3k](/Mbed-TLS/mbedtls/issues)
* [Pull requests
  265](/Mbed-TLS/mbedtls/pulls)
* [Projects
  0](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

Additional navigation options

* [Code](/Mbed-TLS/mbedtls/tree/v2.16.7)
* [Issues](/Mbed-TLS/mbedtls/issues)
* [Pull requests](/Mbed-TLS/mbedtls/pulls)
* [Projects](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

1. [Releases](/Mbed-TLS/mbedtls/releases)
2. [v2.16.7](/Mbed-TLS/mbedtls/releases/tag/v2.16.7)

# Mbed TLS 2.16.7

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.16.7)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

![@yanesca](https://avatars.githubusercontent.com/u/6871045?s=40&v=4)
[yanesca](/yanesca)
released this
01 Jul 14:03

[v2.16.7](/Mbed-TLS/mbedtls/tree/v2.16.7)

[`abc4602`](/Mbed-TLS/mbedtls/commit/abc460236f17be148036e2c7e07e6a05f938b656)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## Description

Mbed TLS 2.16.7 is a maintenance release of the Mbed TLS 2.16 branch, and provides bug fixes and minor enhancements. This release includes fixes for security issues and the most severe one is described in more detail in a [security advisory](https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2020-07).

## Security

* Fix a side channel vulnerability in modular exponentiation that could reveal an RSA private key used in a secure enclave. Noticed by Sangho Lee, Ming-Wei Shih, Prasun Gera, Taesoo Kim and Hyesoon Kim (Georgia Institute of Technology); and Marcus Peinado (Microsoft Research). Reported by Raoul Strackx (Fortanix) in [#3394](https://github.com/Mbed-TLS/mbedtls/issues/3394).
* Fix side channel in mbedtls\_ecp\_check\_pub\_priv() and mbedtls\_pk\_parse\_key() / mbedtls\_pk\_parse\_keyfile() (when loading a private key that didn't include the uncompressed public key), as well as mbedtls\_ecp\_mul() / mbedtls\_ecp\_mul\_restartable() when called with a NULL f\_rng argument. An attacker with access to precise enough timing and memory access information (typically an untrusted operating system attacking a secure enclave) could fully recover the ECC private key. Found and reported by Alejandro Cabrera Aldaya and Billy Brumley.
* Fix issue in Lucky 13 counter-measure that could make it ineffective when hardware accelerators were used (using one of the MBEDTLS\_SHAxxx\_ALT macros). This would cause the original Lucky 13 attack to be possible in those configurations, allowing an active network attacker to recover plaintext after repeated timing measurements under some conditions. Reported and fix suggested by Luc Perneel in [#3246](https://github.com/Mbed-TLS/mbedtls/issues/3246).

## Bugfix

* Fix the Visual Studio Release x64 build configuration for mbedtls itself. Completes a previous fix in Mbed TLS 2.16.3 that only fixed the build for the example programs. Reported in [#1430](https://github.com/Mbed-TLS/mbedtls/issues/1430) and fix contributed by irwir.
* Fix undefined behavior in X.509 certificate parsing if the pathLenConstraint basic constraint value is equal to INT\_MAX. The actual effect with almost every compiler is the intended behavior, so this is unlikely to be exploitable anywhere. [#3197](https://github.com/Mbed-TLS/mbedtls/pull/3197)
* Include asn1.h in error.c. Fixes [#3328](https://github.com/Mbed-TLS/mbedtls/issues/3328) reported by David Hu.
* Fix potential memory leaks in ecp\_randomize\_jac() and ecp\_randomize\_mxz() when PRNG function fails. Contributed by Jonas Lejeune in [#3318](https://github.com/Mbed-TLS/mbedtls/pull/3318).
* Add additional bounds checks in ssl\_write\_client\_hello() preventing output buffer overflow if the configuration declared a buffer that was too small.

## Changes

* Unify the example programs termination to call mbedtls\_exit() instead of using a return command. This has been done to enable customization of the behavior in bare metal environments.
* Abort the ClientHello writing function as soon as some extension doesn't fit into the record buffer. Previously, such extensions were silently dropped. As a consequence, the TLS handshake now fails when the output buffer is not large enough to hold the ClientHello.
* The ECP module, enabled by `MBEDTLS_ECP_C`, now depends on `MBEDTLS_CTR_DRBG_C`, `MBEDTLS_HMAC_DRBG_C`, `MBEDTLS_SHA512_C` or `MBEDTLS_SHA256_C` for some side-channel coutermeasures. If side channels are not a concern, this dependency can be avoided by enabling the new option `MBEDTLS_ECP_NO_INTERNAL_RNG`.

## Who should update

We recommend all affected users should update to take advantage of the bug fixes contained in this release at an appropriate point in their development lifecycle.

## Checksum

The SHA256 hashes for the archives are:

```
c95b11557ee97d2bdfd48cd57cf9b648a6cddd2ca879e3c35c4e7525f2871992  mbedtls-2.16.7.tar.gz
6ee853f8dbbe662b7647b454c9635ed7f2b3c78293e064c1be74c7cfd97d080b  mbedtls-2.16.7.zip

```

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_d6643edf_20250119_125230.html ===


---

[[Date Prev](msg00035.html)][[Date Next](msg00037.html)]
[[Thread Prev](msg00035.html)][[Thread Next](msg00037.html)]
[[Date Index](maillist.html#00036)]
[[Thread Index](threads.html#00036)]

# [SECURITY] [DLA 3249-1] mbedtls security update

---

* *To*: debian-lts-announce <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3249-1] mbedtls security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Mon, 26 Dec 2022 00:33:58 +0100
* *Message-id*: <[[🔎]](/msgid-search/414914e3b2cdd0d6b297d2baec1e859d0cd3916a.camel%40debian.org) [414914e3b2cdd0d6b297d2baec1e859d0cd3916a.camel@debian.org](msg00036.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3249-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Markus Koschany
December 26, 2022                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : mbedtls
Version        : 2.16.9-0~deb10u1
CVE ID         : CVE-2019-16910 CVE-2019-18222 CVE-2020-10932 CVE-2020-10941
                 CVE-2020-16150 CVE-2020-36421 CVE-2020-36422 CVE-2020-36423
                 CVE-2020-36424 CVE-2020-36425 CVE-2020-36426 CVE-2020-36475
                 CVE-2020-36476 CVE-2020-36478 CVE-2021-24119 CVE-2021-43666
                 CVE-2021-44732 CVE-2022-35409
Debian Bug     : 941265 963159 972806 1002631

Multiple security vulnerabilities have been discovered in mbedtls, a
lightweight crypto and SSL/TLS library, which may allow attackers to obtain
sensitive information like the RSA private key or cause a denial of service
(application or server crash).

For Debian 10 buster, these problems have been fixed in version
2.16.9-0~deb10u1.

We recommend that you upgrade your mbedtls packages.

For the detailed security status of mbedtls please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/mbedtls>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpsZBICojoMg.pgp)**

*Description:* This is a digitally signed message part

---


