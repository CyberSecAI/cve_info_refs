=== Content from www.kb.cert.org_c3a5d42e_20250119_113133.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#429301

## Veritas Backup Exec is vulnerable to privilege escalation due to OPENSSLDIR location

#### Vulnerability Note VU#429301

Original Release Date: 2020-12-23 | Last Revised: 2021-01-06

---

### Overview

Veritas Backup Exec contains a privilege escalation vulnerability due to the use of an `OPENSSLDIR` variable that specifies a location where an unprivileged Windows user can create files.

### Description

**CVE-2019-1552**

Veritas Backup Exec includes an OpenSSL component that specifies an `OPENSSLDIR` variable as `/usr/local/ssl/`. On the Windows platform, this path is interpreted as `C:\usr\local\ssl`. Backup Exec contains a privileged service that uses this OpenSSL component. Because unprivileged Windows users can create subdirectories off of the system root, a user can create the appropriate path to a specially-crafted `openssl.cnf` file to achieve arbitrary code execution with SYSTEM privileges.

### Impact

By placing a specially-crafted `openssl.cnf` in the `C:\usr\local\ssl` directory, an unprivileged user may be able to execute arbitrary code with SYSTEM privileges on a Windows system with the vulnerable Veritas software installed.

### Solution

#### Apply an update

This vulnerability is [addressed](https://www.veritas.com/content/support/en_US/security/VTS20-010) in Backup Exec 21.1 [Hotfix 657517](https://www.veritas.com/content/support/en_US/downloads/update.UPD657517) (Engineering version 21.0.1200.1217) and Backup Exec 20.6 [Hotfix 298543](https://www.veritas.com/content/support/en_US/downloads/update.UPD298543) (Engineering version 20.0.1188.2734).

#### Create a C:\usr\local\ssl directory

In cases where an update cannot be installed, this vulnerability can be mitigated by creating a `C:\usr\local\ssl` directory and restricting ACLs to prevent unprivileged users from being able to write to this location.

### Acknowledgements

This vulnerability was reported by Will Dormann of the CERT/CC.

This document was written by Will Dormann.

### Vendor Information

429301
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

### [Veritas Technologies](#Veritas%20Technologies) Affected

Notified:  2020-11-11
Updated: 2020-12-23

| **CVE-2020-36167** | Affected |
| --- | --- |

#### Vendor Statement

We have not received a statement from the vendor.

#### References

* <https://www.veritas.com/content/support/en_US/security/VTS20-010>
* <https://www.veritas.com/content/support/en_US/downloads/update.UPD657517>
* <https://www.veritas.com/content/support/en_US/downloads/update.UPD298543>

### References

* <https://www.veritas.com/content/support/en_US/security/VTS20-010>
* <https://www.veritas.com/content/support/en_US/downloads/update.UPD657517>
* <https://www.veritas.com/content/support/en_US/downloads/update.UPD298543>

### Other Information

| **CVE IDs:** | [CVE-2020-36167](http://web.nvd.nist.gov/vuln/detail/CVE-2020-36167) |
| --- | --- |
| **Date Public:** | 2020-12-23 |
| **Date First Published:** | 2020-12-23 |
| **Date Last Updated:** | 2021-01-06 18:37 UTC |
| **Document Revision:** | 3 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.veritas.com_a08a7a3a_20250119_113158.html ===


* + Get Support
    - My Support Cases
    - Create Case
    - Start Chat
    - Call Us
    - Learn more about Veritas
  + [Veritas.com](https://www.veritas.com/)
  + [VOX](https://vox.veritas.com/)
* [Veritas.com](https://www.veritas.com/)
* [VOX](https://vox.veritas.com/)
* Get Support
  + My Support Cases
  + Create Case
  + Start Chat
  + Call Us
  + ---
  + [Learn more about Veritas](/content/support/en_US/terms/support-fundamentals)
* Language
  + 简体中文
  + English
  + Français
  + Deutsch
  + Italiano
  + 日本語
  + 한국어
  + Português
  + Español

* + [My Profile](https://www.veritas.com/support/en_US/settings?returnURL=https://www.veritas.com/support/en_US)
  + Sign Out

* Sign In

[![](/content/dam/support-new/logo/veritas_arctera_stack_95.png)

![]()](/content/support/en_US)
Support

* [Products](/content/support/en_US/products)
* [Knowledge Base](/content/support/en_US/search-results?fq=(document_type%3A%22Knowledge_Base%22))
* [Documentation](/content/support/en_US/search-results?q=*&fq=(document_type%3A%22document%22))
* [Downloads](/content/support/en_US/downloads)
* [Licensing](https://sso.veritas.com/app/veritassso_vems_1/exk1dn2qzmgXJCl9c417/sso/saml)
* NetInsights
  + [NetInsights Console](https://netinsights.veritas.com)
  + [Netinsights Status](https://www.veritas.com/support/en_US/netinsights-status)

* NetInsights
  + [NetInsights Console](https://netinsights.veritas.com)
  + [Netinsights Status](https://www.veritas.com/support/en_US/netinsights-status)

Sign In

Sign in failed. Please try again.

Username

Password
[Forgot Password](https://www.veritas.com/support/en/reset_password?returnURL=https://www.veritas.com/support/en)

Remember me

---

Don’t have an account? [Create One](https://www.veritas.com/support/en_US/register?returnURL=https://www.veritas.com/support/en_US).

Cancel
Sign In

##### resetPassword

oldPassword

passwordRules
newPassword

confirmNewPassword

regCancelButton
changePassword

Hello! We noticed that while you have a Veritas Account, you aren't yet registered to manage cases and use chat. Contact us for help registering your account

[regContactUsButton](/content/support/en_US/contact-us)
regCancelButton

![]()

    [Support](/content/support/en_US.html)
  /   [Security Alerts](/content/support/en_US/security.html)
  /   [Backup Exec OpenSSL advisory](/content/support/en_US/security/VTS20-010.html)

## Revision History

* 1.0: December 23, 2020: Initial version
* 1.1: January 8, 2021: Added CVE ID and updated Remediation section

---

## Summary

Veritas has discovered an issue where Veritas Backup Exec could allow an attacker to run arbitrary code with administrator privilege.

## Issue

CVE ID: [CVE-2020-36167](https://nvd.nist.gov/vuln/detail/CVE-2020-36167)

Severity: Critical

CVSS v3.1 Base Score: 9.3 ([AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H&version=3.1))

On start-up, the Backup Exec service loads the OpenSSL library from the Backup Exec Installation folder. This library in turn attempts to load the /usr/local/ssl/openssl.cnf configuration file which may not exist. On Windows systems, this path could translate to <drive>:\usr\local\ssl\openssl.cnf, where <drive> could be the default Windows installation drive such as C:\ or the current root directory for the application. A low privileged user on the Windows system without any privileges in Backup Exec can create a <drive>:\usr\local\ssl\openssl.cnf configuration file to load a malicious OpenSSL engine resulting in arbitrary code execution as SYSTEM when the service starts. This gives the attacker administrator access on the system, allowing the attacker (by default) to access all data, to access all installed applications, etc. If the system is also an Active Directory domain controller then this can affect the entire domain.

This vulnerability only affects Backup Exec servers, it does not affect Backup Exec agents.

## Affected Versions

Backup Exec versions BE 20.x, BE 21.x and 16.x are affected. Earlier unsupported versions may be affected as well.

## Remediation

Customers under a current maintenance contract can download and install updates and patches as described below:

* If you are on BE 21.x:

+ Install Backup Exec 21.1 [Hotfix 657517](https://www.veritas.com/content/support/en_US/downloads/update.UPD657517) (Engineering version 21.0.1200.1217)

* If you are on BE 20.x:

+ Install Backup Exec 20.6 [Hotfix 298543](https://www.veritas.com/content/support/en_US/downloads/update.UPD298543) (Engineering version 20.0.1188.2734)

These hot fixes will be available in Veritas Update for automated download and installation.

If you are on Backup Exec version 16.x or older, Veritas recommends that you upgrade to Backup Exec 21.1 + patch.

See the Veritas Download Center for available updates: <https://www.veritas.com/support/en_US/downloads>

## Mitigation

If not applying a recommended remediation listed above, use an administrator account to create the directory ‘\usr\local\ssl’ under root of all drives and set the ACL on the directory to deny write access to all other users. This will prevent an attacker from installing a malicious OpenSSL engine.

## Questions

For questions or problems regarding this vulnerability please contact Veritas Technical Support (<https://www.veritas.com/support>).

## Acknowlegement

Veritas would like to thank Will Dormann of the CERT/CC for notifying us of this vulnerability.

![](/content/dam/support-new/logo/veritas_arctera_stack_95.png)

---

![]()

© 2024 Veritas
[Contact Us](/content/support/en_US/contact-us)
[Privacy Policy](https://www.veritas.com/about/privacy)
[Legal](https://www.veritas.com/about/legal)
[User Agreement](https://www.veritas.com/content/dam/support/terms/Veritas%20Support%20Web%20User%20Terms_05042018.pdf)


