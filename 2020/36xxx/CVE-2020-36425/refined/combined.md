=== Content from github.com_ebe6ba71_20250119_114752.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.16.8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.16.8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=Mbed-TLS%2Fmbedtls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Mbed-TLS](/Mbed-TLS)
/
**[mbedtls](/Mbed-TLS/mbedtls)**
Public

* [Notifications](/login?return_to=%2FMbed-TLS%2Fmbedtls) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)
* [Star
   5.7k](/login?return_to=%2FMbed-TLS%2Fmbedtls)

* [Code](/Mbed-TLS/mbedtls/tree/v2.16.8)
* [Issues
  1.3k](/Mbed-TLS/mbedtls/issues)
* [Pull requests
  265](/Mbed-TLS/mbedtls/pulls)
* [Projects
  0](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

Additional navigation options

* [Code](/Mbed-TLS/mbedtls/tree/v2.16.8)
* [Issues](/Mbed-TLS/mbedtls/issues)
* [Pull requests](/Mbed-TLS/mbedtls/pulls)
* [Projects](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

1. [Releases](/Mbed-TLS/mbedtls/releases)
2. [v2.16.8](/Mbed-TLS/mbedtls/releases/tag/v2.16.8)

# Mbed TLS 2.16.8

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.16.8)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

![@yanesca](https://avatars.githubusercontent.com/u/6871045?s=40&v=4)
[yanesca](/yanesca)
released this
01 Sep 09:21

[v2.16.8](/Mbed-TLS/mbedtls/tree/v2.16.8)

[`848a4e0`](/Mbed-TLS/mbedtls/commit/848a4e06b375e067552f1a21d4bc69322c673217)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## Description

This release of Mbed TLS provides bug fixes and minor enhancements. This release includes fixes for security issues and the most notable of them are described in more detail in the [security advisories](https://tls.mbed.org/tech-updates/security-advisories).

## Features

* Support building on e2k (Elbrus) architecture: correctly enable -Wformat-signedness, and fix the code that causes signed-one-bit-field and sign-compare warnings. Contributed by makise-homura (Igor Molchanov) akemi\_homura@kurisa.ch.

## Security

* When checking X.509 CRLs, a certificate was only considered as revoked if its revocationDate was in the past according to the local clock if available. In particular, on builds without MBEDTLS\_HAVE\_TIME\_DATE, certificates were never considered as revoked. On builds with MBEDTLS\_HAVE\_TIME\_DATE, an attacker able to control the local clock (for example, an untrusted OS attacking a secure enclave) could prevent revocation of certificates via CRLs. Fixed by no longer checking the revocationDate field, in accordance with RFC 5280. Reported by yuemonangong in [#3340](https://github.com/Mbed-TLS/mbedtls/issues/3340). Reported independently and fixed by Raoul Strackx and Jethro Beekman in [#3433](https://github.com/Mbed-TLS/mbedtls/pull/3433).
* In (D)TLS record decryption, when using a CBC ciphersuites without the Encrypt-then-Mac extension, use constant code flow memory access patterns to extract and check the MAC. This is an improvement to the existing countermeasure against Lucky 13 attacks. The previous countermeasure was effective against network-based attackers, but less so against local attackers. The new countermeasure defends against local attackers, even if they have access to fine-grained measurements. In particular, this fixes a local Lucky 13 cache attack found and reported by Tuba Yavuz, Farhaan Fowze, Ken (Yihan) Bai, Grant Hernandez, and Kevin Butler (University of Florida) and Dave Tian (Purdue University).
* Fix side channel in RSA private key operations and static (finite-field) Diffie-Hellman. An adversary with precise enough timing and memory access information (typically an untrusted operating system attacking a secure enclave) could bypass an existing counter-measure (base blinding) and potentially fully recover the private key.
* Fix a 1-byte buffer overread in mbedtls\_x509\_crl\_parse\_der(). Credit to OSS-Fuzz for detecting the problem and to Philippe Antoine for pinpointing the problematic code.
* Zeroising of plaintext buffers in mbedtls\_ssl\_read() to erase unused application data from memory. Reported in [#689](https://github.com/Mbed-TLS/mbedtls/pull/689) by Johan Uppman Bruce of Sectra.

## Bugfix

* Avoid use of statically sized stack buffers for certificate writing. This previously limited the maximum size of DER encoded certificates in mbedtls\_x509write\_crt\_der() to 2Kb. Reported by soccerGB in [#2631](https://github.com/Mbed-TLS/mbedtls/issues/2631).
* Reduce the stack consumption of mbedtls\_x509write\_csr\_der() which previously could lead to stack overflow on constrained devices. Contributed by Doru Gucea and Simon Leet in [#3464](https://github.com/Mbed-TLS/mbedtls/pull/3464).
* Use arc4random\_buf on NetBSD instead of rand implementation with cyclical lower bits. Fix contributed in [#3540](https://github.com/Mbed-TLS/mbedtls/pull/3540).
* Fix building library/net\_sockets.c and the ssl\_mail\_client program on NetBSD. NetBSD conditionals were added for the backport to avoid the risk of breaking a platform. Original fix contributed by Nia Alarie in [#3422](https://github.com/Mbed-TLS/mbedtls/pull/3422). Adapted for long-term support branch 2.16 in [#3558](https://github.com/Mbed-TLS/mbedtls/pull/3558).
* Fix bug in redirection of unit test outputs on platforms where stdout is defined as a macro. First reported in [#2311](https://github.com/Mbed-TLS/mbedtls/issues/2311) and fix contributed in [#3528](https://github.com/Mbed-TLS/mbedtls/pull/3528). Adopted for LTS branch 2.16 in [#3601](https://github.com/Mbed-TLS/mbedtls/pull/3601).

## Changes

* Update copyright notices to use Linux Foundation guidance. As a result, the copyright of contributors other than Arm is now acknowledged, and the years of publishing are no longer tracked in the source files. This also eliminates the need for the lines declaring the files to be part of MbedTLS. Fixes [#3457](https://github.com/Mbed-TLS/mbedtls/issues/3457).

## Who should update

We recommend all affected users should update to take advantage of the bug fixes contained in this release at an appropriate point in their development lifecycle.

## Checksum

The SHA256 hashes for the archives are:

```
fe9e3b15c3375943bdfebbbb20dd6b4f1147b3b5d926248bd835d73247407430  mbedtls-2.16.8.tar.gz
a2904aa4f8b23a3e3972f87ff1c7e450a128c38d00ac28ad183296607fe2d9d6  mbedtls-2.16.8.zip

```

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.gentoo.org_2a9eade5_20250119_114745.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 740108
<net-libs/mbedtls-{2.16.8,2.24.0}: Multiple vulnerabilities (CVE-2020-{16150,36424,36425,36426})
Last modified: 2023-01-11 05:24:46 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=740108&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=740108&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 740108**](show_bug.cgi?id=740108)
(CVE-2020-16150, CVE-2020-36424, CVE-2020-36425, CVE-2020-36426, CVE-2020-36476, CVE-2020-36477)
- <net-libs/mbedtls-{2.16.8,2.24.0}: Multiple vulnerabilities (CVE-2020-{16150,36424,36425,36426})

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<net-libs/mbedtls-{2.16.8,2.24.0}: Multiple vulnerabilities (CVE-2020-{16150,...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2020-16150, CVE-2020-36424, CVE-2020-36425, CVE-2020-36426, CVE-2020-36476, CVE-2020-36477 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal minor | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B4 [glsa+ cve] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [CVE-2020-36421, CVE-2020-36422, CVE-2020-36423](show_bug.cgi?id=730752 "RESOLVED FIXED - <net-libs/mbedtls-{2.16.7,2.23.0}: Multiple vulnerabilities (CVE-2020-{36421,36422,36423})") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | Show dependency [tree](showdependencytree.cgi?id=740108&hide_resolved=1) | |  | | Reported: | 2020-09-02 19:21 UTC by Sam James | | --- | --- | | Modified: | 2023-01-11 05:24 UTC ([History](show_activity.cgi?id=740108)) | | CC List: | 2 users (show)  ajak blueness | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=740108&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=740108&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-09-02 19:21:29 UTC  ``` * CVE-2020-16150 (Local side channel attack on classical CBC decryption in (D)TLS)  Description: "An local attacker with access to enough information about the state of the cache (including, but not limited to, an untrusted operating system attacking a secure enclave such as SGX or the TrustZone secure world) can recover portions of the plaintext of a (D)TLS record."  Fixed versions: "Affected users will want to upgrade to Mbed TLS 2.24.0, 2.16.8 or 2.7.17 depending on the branch they're currently using."  Advisory: <https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2020-09-1>  * Local side channel attack on RSA and static Diffie-Hellman  Description: "An attacker with access to precise enough timing and memory access information (typically an untrusted operating system attacking a secure enclave such as SGX or the TrustZone secure world) can recover the private keys used in RSA or static (finite-field) Diffie-Hellman operations."  Fixed versions: "Affected users will want to upgrade to Mbed TLS 2.24.0, 2.16.8 or 2.7.17 depending on the branch they're currently using."  Advisory: <https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security-advisory-2020-09-2> ```  [Comment 1](#c1)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-09-02 19:22:24 UTC  ``` Please bump to 2.16.8, 2.24.0, thanks! ```  [Comment 2](#c2)  Anthony Basile   gentoo-dev  2020-09-03 15:38:25 UTC  ``` (In reply to Sam James from [comment #1](show_bug.cgi?id=740108#c1)) > Please bump to 2.16.8, 2.24.0, thanks!  Okay the bumps are in the tree.  I did preliminary testing and everything seems good to go.  If you want, go ahead and convert this into a stabilization bug. ```  [Comment 3](#c3)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2020-09-03 23:03:26 UTC  ``` Thanks! CC-ARCHES when ready. ```  [Comment 4](#c4)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-09-04 18:38:27 UTC  ``` arm64 done ```  [Comment 5](#c5)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-09-04 18:39:33 UTC  ``` arm done ```  [Comment 6](#c6)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-09-04 18:41:34 UTC  ``` ppc64 stable ```  [Comment 7](#c7)  Thomas Deutschmann (RETIRED)   gentoo-dev  2020-09-05 16:18:04 UTC  ``` x86 stable ```  [Comment 8](#c8)  Sergei Trofimovich (RETIRED)   gentoo-dev  2020-09-08 07:11:25 UTC  ``` ppc stable ```  [Comment 9](#c9)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-09-12 23:57:18 UTC  ``` amd64 stable, please cleanup ```  [Comment 10](#c10)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2020-10-30 02:20:16 UTC  ``` Ping ```  [Comment 11](#c11)  Larry the Git Cow   gentoo-dev  2020-10-31 12:07:19 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=a1bdf75cfef9f25bf8ee50237a5620c5a0ec0a84>  commit a1bdf75cfef9f25bf8ee50237a5620c5a0ec0a84 Author:     John Helmert III <jchelmert3@posteo.net> AuthorDate: 2020-10-30 15:29:24 +0000 Commit:     Anthony G. Basile <blueness@gentoo.org> CommitDate: 2020-10-31 12:07:03 +0000      net-libs/mbedtls: security cleanup          Bug: <https://bugs.gentoo.org/740108>     Package-Manager: Portage-3.0.8, Repoman-3.0.2     Signed-off-by: John Helmert III <jchelmert3@posteo.net>     Signed-off-by: Anthony G. Basile <blueness@gentoo.org>   net-libs/mbedtls/Manifest                 |  2 -  net-libs/mbedtls/mbedtls-2.16.7-r1.ebuild | 94 -------------------------------  net-libs/mbedtls/mbedtls-2.23.0-r1.ebuild | 94 -------------------------------  3 files changed, 190 deletions(-) ```  [Comment 12](#c12)  Anthony Basile   gentoo-dev  2020-10-31 12:08:52 UTC  ``` (In reply to Larry the Git Cow from [comment #11](show_bug.cgi?id=740108#c11)) > The bug has been referenced in the following commit(s): >  > <https://gitweb.gentoo.org/repo/gentoo.git/commit/> > ?id=a1bdf75cfef9f25bf8ee50237a5620c5a0ec0a84 >  > commit a1bdf75cfef9f25bf8ee50237a5620c5a0ec0a84 > Author:     John Helmert III <jchelmert3@posteo.net> > AuthorDate: 2020-10-30 15:29:24 +0000 > Commit:     Anthony G. Basile <blueness@gentoo.org> > CommitDate: 2020-10-31 12:07:03 +0000 >  >     net-libs/mbedtls: security cleanup >      >     Bug: <https://bugs.gentoo.org/740108> >     Package-Manager: Portage-3.0.8, Repoman-3.0.2 >     Signed-off-by: John Helmert III <jchelmert3@posteo.net> >     Signed-off-by: Anthony G. Basile <blueness@gentoo.org> >  >  net-libs/mbedtls/Manifest                 |  2 - >  net-libs/mbedtls/mbedtls-2.16.7-r1.ebuild | 94 > ------------------------------- >  net-libs/mbedtls/mbedtls-2.23.0-r1.ebuild | 94 > ------------------------------- >  3 files changed, 190 deletions(-)  Thanks for the reminder. ```  [Comment 13](#c13)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2020-11-01 23:02:47 UTC  ``` (In reply to Anthony Basile from [comment #12](show_bug.cgi?id=740108#c12)) > (In reply to Larry the Git Cow from [comment #11](show_bug.cgi?id=740108#c11)) > > The bug has been referenced in the following commit(s): > >  > > <https://gitweb.gentoo.org/repo/gentoo.git/commit/> > > ?id=a1bdf75cfef9f25bf8ee50237a5620c5a0ec0a84 > >  > > commit a1bdf75cfef9f25bf8ee50237a5620c5a0ec0a84 > > Author:     John Helmert III <jchelmert3@posteo.net> > > AuthorDate: 2020-10-30 15:29:24 +0000 > > Commit:     Anthony G. Basile <blueness@gentoo.org> > > CommitDate: 2020-10-31 12:07:03 +0000 > >  > >     net-libs/mbedtls: security cleanup > >      > >     Bug: <https://bugs.gentoo.org/740108> > >     Package-Manager: Portage-3.0.8, Repoman-3.0.2 > >     Signed-off-by: John Helmert III <jchelmert3@posteo.net> > >     Signed-off-by: Anthony G. Basile <blueness@gentoo.org> > >  > >  net-libs/mbedtls/Manifest                 |  2 - > >  net-libs/mbedtls/mbedtls-2.16.7-r1.ebuild | 94 > > ------------------------------- > >  net-libs/mbedtls/mbedtls-2.23.0-r1.ebuild | 94 > > ------------------------------- > >  3 files changed, 190 deletions(-) >  > Thanks for the reminder.  Thanks for merging! ```   [Comment 14](#c14)  NATTkA bot   gentoo-dev  2020-11-01 23:04:52 UTC  Comment hidden (obsolete)  ``` Resetting sanity check; package list is empty or all packages are done. ```  [Comment 15](#c15)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2021-07-18 21:24:30 UTC  ``` (In reply to Sam James from [comment #0](show_bug.cgi?id=740108#c0)) > * CVE-2020-16150 (Local side channel attack on classical CBC decryption in > (D)TLS) >  > Description: > "An local attacker with access to enough information about the state of the > cache (including, but not limited to, an untrusted operating system > attacking a secure enclave such as SGX or the TrustZone secure world) can > recover portions of the plaintext of a (D)TLS record." >  > Fixed versions: "Affected users will want to upgrade to Mbed TLS 2.24.0, > 2.16.8 or 2.7.17 depending on the branch they're currently using." >  > Advisory: > <https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security>- > advisory-2020-09-1 >  > * Local side channel attack on RSA and static Diffie-Hellman >  > Description: > "An attacker with access to precise enough timing and memory access > information (typically an untrusted operating system attacking a secure > enclave such as SGX or the TrustZone secure world) can recover the private > keys used in RSA or static (finite-field) Diffie-Hellman operations." >  > Fixed versions: "Affected users will want to upgrade to Mbed TLS 2.24.0, > 2.16.8 or 2.7.17 depending on the branch they're currently using." >  > Advisory: > <https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security>- > advisory-2020-09-2  Requested a CVE for the non-CVE'd vulnerability here, as well as these two issues in the changelogs:  When checking X.509 CRLs, a certificate was only considered as revoked if its revocationDate was in the past according to the local clock if available. In particular, on builds without MBEDTLS_HAVE_TIME_DATE, certificates were never considered as revoked. On builds with MBEDTLS_HAVE_TIME_DATE, an attacker able to control the local clock (for example, an untrusted OS attacking a secure enclave) could prevent revocation of certificates via CRLs. Fixed by no longer checking the revocationDate field, in accordance with RFC 5280. Reported by yuemonangong in #3340. Reported independently and fixed by Raoul Strackx and Jethro Beekman in #3433.  Fix a 1-byte buffer overread in mbedtls_x509_crl_parse_der(). Credit to OSS-Fuzz for detecting the problem and to Philippe Antoine for pinpointing the problematic code. ```  [Comment 16](#c16)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2021-07-19 15:31:08 UTC  ``` (In reply to John Helmert III from [comment #15](show_bug.cgi?id=740108#c15)) > (In reply to Sam James from [comment #0](show_bug.cgi?id=740108#c0))  > > * Local side channel attack on RSA and static Diffie-Hellman > >  > > Description: > > "An attacker with access to precise enough timing and memory access > > information (typically an untrusted operating system attacking a secure > > enclave such as SGX or the TrustZone secure world) can recover the private > > keys used in RSA or static (finite-field) Diffie-Hellman operations." > >  > > Fixed versions: "Affected users will want to upgrade to Mbed TLS 2.24.0, > > 2.16.8 or 2.7.17 depending on the branch they're currently using." > >  > > Advisory: > > <https://tls.mbed.org/tech-updates/security-advisories/mbedtls-security>- > > advisory-2020-09-2 >  > Requested a CVE for the non-CVE'd vulnerability here...  CVE-2020-36424  > as well as these two > issues in the changelogs: >  > When checking X.509 CRLs, a certificate was only considered as revoked if > its revocationDate was in the past according to the local clock if > available. In particular, on builds without MBEDTLS_HAVE_TIME_DATE, > certificates were never considered as revoked. On builds with > MBEDTLS_HAVE_TIME_DATE, an attacker able to control the local clock (for > example, an untrusted OS attacking a secure enclave) could prevent > revocation of certificates via CRLs. Fixed by no longer checking the > revocationDate field, in accordance with RFC 5280. Reported by yuemonangong > in #3340. Reported independently and fixed by Raoul Strackx and Jethro > Beekman in #3433.  CVE-2020-36425  > Fix a 1-byte buffer overread in mbedtls_x509_crl_parse_der(). Credit to > OSS-Fuzz for detecting the problem and to Philippe Antoine for pinpointing > the problematic code.  CVE-2020-36426 ```  [Comment 17](#c17)  NATTkA bot   gentoo-dev  2021-07-29 17:26:01 UTC  ``` Package list is empty or all packages have requested keywords. ```  [Comment 18](#c18)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2021-08-25 02:30:17 UTC  ``` CVE-2020-36477:  An issue was discovered in Mbed TLS before 2.24.0. The verification of X.509 certificates when matching the expected common name (the cn argument of mbedtls_x509_crt_verify) with the actual certificate name is mishandled: when the subjecAltName extension is present, the expected name is compared to any name in that extension regardless of its type. This means that an attacker could impersonate a 4-byte or 16-byte domain by getting a certificate for the corresponding IPv4 or IPv6 address (this would require the attacker to control that IP address, though).  CVE-2020-36476:  An issue was discovered in Mbed TLS before 2.24.0 (and before 2.16.8 LTS and before 2.7.17 LTS). There is missing zeroization of plaintext buffers in mbedtls_ssl_read to erase unused application data from memory. ```  [Comment 19](#c19)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-12-22 23:47:10 UTC  ``` GLSA request filed. ```  [Comment 20](#c20)  Larry the Git Cow   gentoo-dev  2023-01-11 05:22:50 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/data/glsa.git/commit/?id=f524f5fa47d9d739280d4530623a93084918da39>  commit f524f5fa47d9d739280d4530623a93084918da39 Author:     GLSAMaker <glsamaker@gentoo.org> AuthorDate: 2023-01-11 05:19:06 +0000 Commit:     John Helmert III <ajak@gentoo.org> CommitDate: 2023-01-11 05:22:06 +0000      [ GLSA 202301-08 ] Mbed TLS: Multiple Vulnerabilities          Bug: <https://bugs.gentoo.org/730752>     Bug: <https://bugs.gentoo.org/740108>     Bug: <https://bugs.gentoo.org/764317>     Bug: <https://bugs.gentoo.org/778254>     Bug: <https://bugs.gentoo.org/801376>     Bug: <https://bugs.gentoo.org/829660>     Bug: <https://bugs.gentoo.org/857813>     Signed-off-by: GLSAMaker <glsamaker@gentoo.org>     Signed-off-by: John Helmert III <ajak@gentoo.org>   glsa-202301-08.xml | 62 ++++++++++++++++++++++++++++++++++++++++++++++++++++++  1 file changed, 62 insertions(+) ```  [Comment 21](#c21)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2023-01-11 05:24:46 UTC  ``` GLSA released, all done! ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=740108)
* - [XML](show_bug.cgi?ctype=xml&id=740108)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=740108)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=740108&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=740108&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=740108&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from github.com_7fa213e4_20250119_114746.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Fissues%2F3340)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Fissues%2F3340)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Mbed-TLS%2Fmbedtls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Mbed-TLS](/Mbed-TLS)
/
**[mbedtls](/Mbed-TLS/mbedtls)**
Public

* [Notifications](/login?return_to=%2FMbed-TLS%2Fmbedtls) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)
* [Star
   5.7k](/login?return_to=%2FMbed-TLS%2Fmbedtls)

* [Code](/Mbed-TLS/mbedtls)
* [Issues
  1.3k](/Mbed-TLS/mbedtls/issues)
* [Pull requests
  265](/Mbed-TLS/mbedtls/pulls)
* [Projects
  0](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

Additional navigation options

* [Code](/Mbed-TLS/mbedtls)
* [Issues](/Mbed-TLS/mbedtls/issues)
* [Pull requests](/Mbed-TLS/mbedtls/pulls)
* [Projects](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

# It may not be necessary to check the "revocation date"  #3340

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosed[#3433](https://github.com/Mbed-TLS/mbedtls/pull/3433)Closed[It may not be necessary to check the "revocation date"](#top) #3340[#3433](https://github.com/Mbed-TLS/mbedtls/pull/3433)Copy linkLabels[bug](https://github.com/Mbed-TLS/mbedtls/issues?q=state%3Aopen%20label%3A%22bug%22)[component-x509](https://github.com/Mbed-TLS/mbedtls/issues?q=state%3Aopen%20label%3A%22component-x509%22)![@yuemonangong](https://avatars.githubusercontent.com/u/35371464?v=4&size=80)
## Description

![@yuemonangong](https://avatars.githubusercontent.com/u/35371464?v=4&size=48)[yuemonangong](https://github.com/yuemonangong)opened [on May 21, 2020](https://github.com/Mbed-TLS/mbedtls/issues/3340#issue-622477662)
### Description

* Type: Bug

---

## Bug

**OS**

ubuntu 16.04.1 [linux|

**mbed TLS build:**

Version: 2.16.5

I created a CRL whose revocation date is later than current time. MbedTLS does not use this CRL because it thought that the CRL is illegal (see the code in /library/x509\_crt.c, line 1788). Comparatively, openssl does not check the "revocation date" field and revokes certificate(s).

The openssl guys explained that "revocation date” is useless in certificate validation and may only be used as meta data (see [openssl/openssl#11859](https://github.com/openssl/openssl/issues/11859)). I indeed checked RFC 5280 and did not find any words saying that "revocation date" is important (for certificate parsing and validation). Then do we still need to check the revocation date?

```
#if defined(MBEDTLS_X509_CRL_PARSE_C)
/*
 * Return 1 if the certificate is revoked, or 0 otherwise.
 */
int mbedtls_x509_crt_is_revoked( const mbedtls_x509_crt *crt, const mbedtls_x509_crl *crl )
{
    const mbedtls_x509_crl_entry *cur = &crl->entry;

    while( cur != NULL && cur->serial.len != 0 )
    {
        if( crt->serial.len == cur->serial.len &&
            memcmp( crt->serial.p, cur->serial.p, crt->serial.len ) == 0 )
        {
            if( mbedtls_x509_time_is_past( &cur->revocation_date ) )
                return( 1 );
        }

        cur = cur->next;
    }

    return( 0 );
}

```

The command I used is:

```
cert_app mode='file' filename=leaf.pem ca_file=root.pem crl_file=test.crl

```

The verification returns

```
Result of MbedTLS:
  . Loading the CA root certificate ... ok (0 skipped)

  . Loading the certificate(s) ... ok
  . Peer certificate information    ...
      cert. version     : 3
      serial number     : 01
      issuer name       : C=CN, ST=SH, O=SJTU, OU=DDST, CN=NCRL
      subject name      : C=GB, ST=Berkshire, L=Newbury, O=My Company Ltd
      issued  on        : 1996-08-01 00:00:00
      expires on        : 2020-12-31 23:59:59
      signed using      : RSA with SHA-256
      RSA key size      : 2048 bits
      basic constraints : CA=true

  . Verifying X.509 certificate...
Verify requested for (Depth 1):
cert. version     : 3
serial number     : F5:34:01:4D:DA:77:4E:2F
issuer name       : C=CN, ST=SH, O=SJTU, OU=DDST, CN=NCRL
subject name      : C=CN, ST=SH, O=SJTU, OU=DDST, CN=NCRL
issued  on        : 2020-03-26 08:27:49
expires on        : 2023-01-14 08:27:49
signed using      : RSA with SHA-256
RSA key size      : 2048 bits
basic constraints : CA=true, max_pathlen=3
key usage         : Digital Signature, Non Repudiation, Key Encipherment, Key Cert Sign, CRL Sign
  This certificate has no flags

Verify requested for (Depth 0):
cert. version     : 3
serial number     : 01
issuer name       : C=CN, ST=SH, O=SJTU, OU=DDST, CN=NCRL
subject name      : C=GB, ST=Berkshire, L=Newbury, O=My Company Ltd
issued  on        : 1996-08-01 00:00:00
expires on        : 2020-12-31 23:59:59
signed using      : RSA with SHA-256
RSA key size      : 2048 bits
basic constraints : CA=true
  This certificate has no flags
 ok

```

Result of OpenSSL:

```
C = GB, ST = Berkshire, L = Newbury, O = My Company Ltd
error 23 at 0 depth lookup: certificate revoked
error leaf.pem: verification failed

```

root.pem

```
-----BEGIN CERTIFICATE-----
MIIDNDCCAhygAwIBAgIJAPU0AU3ad04vMA0GCSqGSIb3DQEBCwUAMEcxCzAJBgNV
BAYTAkNOMQswCQYDVQQIDAJTSDENMAsGA1UECgwEU0pUVTENMAsGA1UECwwERERT
VDENMAsGA1UEAwwETkNSTDAeFw0yMDAzMjYwODI3NDlaFw0yMzAxMTQwODI3NDla
MEcxCzAJBgNVBAYTAkNOMQswCQYDVQQIDAJTSDENMAsGA1UECgwEU0pUVTENMAsG
A1UECwwERERTVDENMAsGA1UEAwwETkNSTDCCASIwDQYJKoZIhvcNAQEBBQADggEP
ADCCAQoCggEBAPNLlu+KPCcjj1KiZ1/sUFvFRDt3Z7WZTWjOYeJUFvycHNcYN9cE
laGJ32hfjgaPw9u3cOgs0JJHwIhlQkNhSexUvgGatw336H/3FjPQCJKs48lDJG13
sDF7TK1MvG5wcF1pgRkfvoRSWOyr30aqoeQHaRnqMnT0lWBy26mmV6mgM7LPeNq8
E6jh6aLy7uep3+rO/Ef7LvFi/QWqy+vVVmr5MljXtFyWI+aLs4uFtZZ6rFw5Va4U
Y6OffwchjkVex1eML4D593fobkmkubxZEm2o2Upi/Eiech7CM8HuwgqrAwoIVxi6
FlObraD90sUSUKUwohvl03tkjCTXakXF2TUCAwEAAaMjMCEwEgYDVR0TAQH/BAgw
BgEB/wIBAzALBgNVHQ8EBAMCAeYwDQYJKoZIhvcNAQELBQADggEBACb6hOtUCqD5
sH4VucCO4FYFHM6nfBvB9vx+c2RPC/psam9clOvL5llrUhY070pXbZnd2hwxfnzj
cdr448sVyJkHosukzZj/MyEBV9BERTUMOaY4etQxM2L33uyzn5++/NeRC2Yd53AL
vY/s4znat7txqBK/izvLemLerp1Z5E58VFzLOvYNz+7vEoxMmNaU55TGh88VJIvo
THaZ3LflTc7hv9eUWin0LTV0mg7cvM+/qWrM2N2hyOukztF5gCcMEgoVkpEgUCJP
WsrvOumtDNuXnPr80r4N54n5TaQCTBG22Tj89klc6jUji63+UR9KKACCV44KT8hc
+0ecJPmXqEU=
-----END CERTIFICATE-----

```

leaf.pem

```
-----BEGIN CERTIFICATE-----
MIIDITCCAgmgAwIBAgIBATANBgkqhkiG9w0BAQsFADBHMQswCQYDVQQGEwJDTjEL
MAkGA1UECAwCU0gxDTALBgNVBAoMBFNKVFUxDTALBgNVBAsMBEREU1QxDTALBgNV
BAMMBE5DUkwwHhcNOTYwODAxMDAwMDAwWhcNMjAxMjMxMjM1OTU5WjBMMQswCQYD
VQQGEwJHQjESMBAGA1UECBMJQmVya3NoaXJlMRAwDgYDVQQHEwdOZXdidXJ5MRcw
FQYDVQQKEw5NeSBDb21wYW55IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC
AQoCggEBAL+N0yePi18I/+MxN/31iBehb2rO5s8MzykUz3aGp3BG/5uEFueqoYZN
CNLA38wIUT/ry8wIw+jlTNj29L7Q9uOX8+10XgF4VTVtN14KT0s7tZ5dLjGRD7ft
fZF03ifbGYp39fW2Wjutjo4Jyop+Bm7g6SrSJB3uaioITpZh8Xf7MHo+kNjJKPsu
ZlVVNQ3T5WQWzoskcpRRIujv7U/NATuRzXODUzqnw+HGavu2qTX3falo5i0dzzrt
9yCtLKqtC+0oX+kZPIi3ib/o20fY3hEXwYstq5sKpvV25xgKTbtwRN1KlMIhfSQN
uFXIg/Rd6rbd9P60zPYxzOTwMsaEysECAwEAAaMTMBEwDwYDVR0TAQH/BAUwAwEB
/zANBgkqhkiG9w0BAQsFAAOCAQEAKhf5CQGxsJCzkFJv26ggzi2HxN/X/eXcwJyy
3gfPP0JZNLzRb6bmracLui58LyCX+0tmY5TA1G3V94Vdu2LIUMRoANwKszTxhW/n
8oNvXDji+E62EsivCtoPgYRAwFE0q4flvcWzDwGlqCfEdaG1uqYGLlLxW8gmHdFs
pKJf4yCzQOn04RmReXOhaAtyUT+xp9AUzawzr2PPGA75x7B07HT4ezLPWy+l1X0o
gMBOWm3AwrwTD8k1B488NiKivCYjBn6UPG0r9/gKxSvdEJEJ6SyM8+Jw+f7lij8i
55LYqy8oyPPknQOAWzB+KZkCbqkcBGJLEPR35agBN/SDSdioXA==
-----END CERTIFICATE-----

```

test.crl

```
-----BEGIN X509 CRL-----
MIIBtjCBnwIBATANBgkqhkiG9w0BAQ4FADBHMQswCQYDVQQGEwJDTjELMAkGA1UE
CAwCU0gxDTALBgNVBAoMBFNKVFUxDTALBgNVBAsMBEREU1QxDTALBgNVBAMMBE5D
UkwXDTIwMDMwODIwMjYwN1oXDTIxMDIyMTIwMjYwN1owFDASAgEBFw0yMTAyMjEy
MDI2MDdaoA4wDDAKBgNVHRQEAwIBADANBgkqhkiG9w0BAQ4FAAOCAQEAkqQPjXyG
FTyPmHi47KoMaeg0M7wU5KO8SXOHxUEU65+QuXOK5pOSpjAH+JhLk5H19dY+22gW
+Bec3N3PO2Iw7iK58t5jl+UywRl3VNf6g2Pf+7zrZje3XoTHATLp+LHfVkUJLflZ
/FiEtJS6NVsNemrAY+BNCCIocHqBVjMAX1zSmUw9lSUFIH6+9HOtVQ0FlmO5RBA5
6QoCmAO3t/5FZF3LqxGj5z3weBVsU340iebf20remV2pEFwWW9KKDBkx+Rd9njgW
dmrKXY4pLfAUZ+D2eCevHBU7vLSSjmgBOKu+74/l28wGF+7oFtj5txbK4hdc1j11
/gX0RqNhGLarQw==
-----END X509 CRL-----

```
## Metadata

### Assignees

No one assigned

### Labels

[bug](https://github.com/Mbed-TLS/mbedtls/issues?q=state%3Aopen%20label%3A%22bug%22)[component-x509](https://github.com/Mbed-TLS/mbedtls/issues?q=state%3Aopen%20label%3A%22component-x509%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_201815a7_20250119_114754.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.24.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.24.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=Mbed-TLS%2Fmbedtls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Mbed-TLS](/Mbed-TLS)
/
**[mbedtls](/Mbed-TLS/mbedtls)**
Public

* [Notifications](/login?return_to=%2FMbed-TLS%2Fmbedtls) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)
* [Star
   5.7k](/login?return_to=%2FMbed-TLS%2Fmbedtls)

* [Code](/Mbed-TLS/mbedtls/tree/v2.24.0)
* [Issues
  1.3k](/Mbed-TLS/mbedtls/issues)
* [Pull requests
  265](/Mbed-TLS/mbedtls/pulls)
* [Projects
  0](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

Additional navigation options

* [Code](/Mbed-TLS/mbedtls/tree/v2.24.0)
* [Issues](/Mbed-TLS/mbedtls/issues)
* [Pull requests](/Mbed-TLS/mbedtls/pulls)
* [Projects](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

1. [Releases](/Mbed-TLS/mbedtls/releases)
2. [v2.24.0](/Mbed-TLS/mbedtls/releases/tag/v2.24.0)

# Mbed TLS 2.24.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.24.0)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

![@yanesca](https://avatars.githubusercontent.com/u/6871045?s=40&v=4)
[yanesca](/yanesca)
released this
01 Sep 09:21

·
[18954 commits](/Mbed-TLS/mbedtls/compare/v2.24.0...development)
to development
since this release

[v2.24.0](/Mbed-TLS/mbedtls/tree/v2.24.0)

[`523f055`](/Mbed-TLS/mbedtls/commit/523f0554b6cdc7ace5d360885c3f5bbcc73ec0e8)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## Description

This release of Mbed TLS provides bug fixes and minor enhancements. This release includes fixes for security issues and the most notable of them are described in more detail in the [security advisories](https://tls.mbed.org/tech-updates/security-advisories).

## API changes

* In the PSA API, rename the types of elliptic curve and Diffie-Hellman group families to psa\_ecc\_family\_t and psa\_dh\_family\_t, in line with the PSA Crypto API specification version 1.0.0. Rename associated macros as well:

  PSA\_ECC\_CURVE\_xxx renamed to PSA\_ECC\_FAMILY\_xxx

  PSA\_DH\_GROUP\_xxx renamed to PSA\_DH\_FAMILY\_xxx

  PSA\_KEY\_TYPE\_GET\_CURVE renamed to to PSA\_KEY\_TYPE\_ECC\_GET\_FAMILY

  PSA\_KEY\_TYPE\_GET\_GROUP renamed to PSA\_KEY\_TYPE\_DH\_GET\_FAMILY

## Default behavior changes

* Stop storing persistent information about externally stored keys created through PSA Crypto with a volatile lifetime. Reported in [#3288](https://github.com/Mbed-TLS/mbedtls/issues/3288) and contributed by Steven Cooreman in [#3382](https://github.com/Mbed-TLS/mbedtls/pull/3382).

## Features

* The new function mbedtls\_ecp\_write\_key() exports private ECC keys back to a byte buffer. It is the inverse of the existing mbedtls\_ecp\_read\_key().
* Support building on e2k (Elbrus) architecture: correctly enable -Wformat-signedness, and fix the code that causes signed-one-bit-field and sign-compare warnings. Contributed by makise-homura (Igor Molchanov) akemi\_homura@kurisa.ch.

## Security

* Fix a vulnerability in the verification of X.509 certificates when matching the expected common name (the cn argument of mbedtls\_x509\_crt\_verify()) with the actual certificate name: when the subjecAltName extension is present, the expected name was compared to any name in that extension regardless of its type. This means that an attacker could for example impersonate a 4-bytes or 16-byte domain by getting a certificate for the corresponding IPv4 or IPv6 (this would require the attacker to control that IP address, though). Similar attacks using other subjectAltName name types might be possible. Found and reported by kFYatek in [#3498](https://github.com/Mbed-TLS/mbedtls/issues/3498).
* When checking X.509 CRLs, a certificate was only considered as revoked if its revocationDate was in the past according to the local clock if available. In particular, on builds without MBEDTLS\_HAVE\_TIME\_DATE, certificates were never considered as revoked. On builds with MBEDTLS\_HAVE\_TIME\_DATE, an attacker able to control the local clock (for example, an untrusted OS attacking a secure enclave) could prevent revocation of certificates via CRLs. Fixed by no longer checking the revocationDate field, in accordance with RFC 5280. Reported by yuemonangong in [#3340](https://github.com/Mbed-TLS/mbedtls/issues/3340). Reported independently and fixed by Raoul Strackx and Jethro Beekman in [#3433](https://github.com/Mbed-TLS/mbedtls/pull/3433).
* In (D)TLS record decryption, when using a CBC ciphersuites without the Encrypt-then-Mac extension, use constant code flow memory access patterns to extract and check the MAC. This is an improvement to the existing countermeasure against Lucky 13 attacks. The previous countermeasure was effective against network-based attackers, but less so against local attackers. The new countermeasure defends against local attackers, even if they have access to fine-grained measurements. In particular, this fixes a local Lucky 13 cache attack found and reported by Tuba Yavuz, Farhaan Fowze, Ken (Yihan) Bai, Grant Hernandez, and Kevin Butler (University of Florida) and Dave Tian (Purdue University).
* Fix side channel in RSA private key operations and static (finite-field) Diffie-Hellman. An adversary with precise enough timing and memory access information (typically an untrusted operating system attacking a secure enclave) could bypass an existing counter-measure (base blinding) and potentially fully recover the private key.
* Fix a 1-byte buffer overread in mbedtls\_x509\_crl\_parse\_der(). Credit to OSS-Fuzz for detecting the problem and to Philippe Antoine for pinpointing the problematic code.
* Zeroising of plaintext buffers in mbedtls\_ssl\_read() to erase unused application data from memory. Reported in [#689](https://github.com/Mbed-TLS/mbedtls/pull/689) by Johan Uppman Bruce of Sectra.

## Bugfix

* Library files installed after a CMake build no longer have execute permission.
* Use local labels in mbedtls\_padlock\_has\_support() to fix an invalid symbol redefinition if the function is inlined. Reported in [#3451](https://github.com/Mbed-TLS/mbedtls/issues/3451) and fix contributed in [#3452](https://github.com/Mbed-TLS/mbedtls/pull/3452) by okhowang.
* Fix the endianness of Curve25519 keys imported/exported through the PSA APIs. psa\_import\_key and psa\_export\_key will now correctly expect/output Montgomery keys in little-endian as defined by RFC7748. Contributed by Steven Cooreman in [#3425](https://github.com/Mbed-TLS/mbedtls/pull/3425).
* Fix build errors when the only enabled elliptic curves are Montgomery curves. Raised by signpainter in [#941](https://github.com/Mbed-TLS/mbedtls/issues/941) and by Taiki-San in [#1412](https://github.com/Mbed-TLS/mbedtls/issues/1412). This also fixes missing declarations reported by Steven Cooreman in [#1147](https://github.com/Mbed-TLS/mbedtls/issues/1147).
* Fix self-test failure when the only enabled short Weierstrass elliptic curve is secp192k1. Fixes [#2017](https://github.com/Mbed-TLS/mbedtls/issues/2017).
* PSA key import will now correctly import a Curve25519/Curve448 public key instead of erroring out. Contributed by Steven Cooreman in [#3492](https://github.com/Mbed-TLS/mbedtls/pull/3492).
* Use arc4random\_buf on NetBSD instead of rand implementation with cyclical lower bits. Fix contributed in [#3540](https://github.com/Mbed-TLS/mbedtls/pull/3540).
* Fix a memory leak in mbedtls\_md\_setup() when using HMAC under low memory conditions. Reported and fix suggested by Guido Vranken in [#3486](https://github.com/Mbed-TLS/mbedtls/issues/3486).
* Fix bug in redirection of unit test outputs on platforms where stdout is defined as a macro. First reported in [#2311](https://github.com/Mbed-TLS/mbedtls/issues/2311) and fix contributed in [#3528](https://github.com/Mbed-TLS/mbedtls/pull/3528).

## Changes

* Only pass -Wformat-signedness to versions of GCC that support it. Reported in [#3478](https://github.com/Mbed-TLS/mbedtls/issues/3478) and fix contributed in [#3479](https://github.com/Mbed-TLS/mbedtls/pull/3479) by okhowang.
* Reduce the stack consumption of mbedtls\_x509write\_csr\_der() which previously could lead to stack overflow on constrained devices. Contributed by Doru Gucea and Simon Leet in [#3464](https://github.com/Mbed-TLS/mbedtls/pull/3464).
* Undefine the ASSERT macro before defining it locally, in case it is defined in a platform header. Contributed by Abdelatif Guettouche in [#3557](https://github.com/Mbed-TLS/mbedtls/pull/3557).
* Update copyright notices to use Linux Foundation guidance. As a result, the copyright of contributors other than Arm is now acknowledged, and the years of publishing are no longer tracked in the source files. This also eliminates the need for the lines declaring the files to be part of MbedTLS. Fixes [#3457](https://github.com/Mbed-TLS/mbedtls/issues/3457).
* Add the command line parameter key\_pwd to the ssl\_client2 and ssl\_server2 example applications which allows to provide a password for the key file specified through the existing key\_file argument. This allows the use of these applications with password-protected key files. Analogously but for ssl\_server2 only, add the command line parameter key\_pwd2 which allows to set a password for the key file provided through the existing key\_file2 argument.

## Who should update

We recommend all affected users should update to take advantage of the bug fixes contained in this release at an appropriate point in their development lifecycle.

## Checksum

The SHA256 hashes for the archives are:

```
d436ae4892bd80329ca18a3960052fbb42d3f1f46c7519711d6763621ca6cfa0  mbedtls-2.24.0.tar.gz
d7b129288a957b1936ade3921504d5524e34a0dbe9f4d965df3416db9cfe0dae  mbedtls-2.24.0.zip

```

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_4c5b7895_20250119_114755.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.7.17)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Freleases%2Ftag%2Fv2.7.17)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=Mbed-TLS%2Fmbedtls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Mbed-TLS](/Mbed-TLS)
/
**[mbedtls](/Mbed-TLS/mbedtls)**
Public

* [Notifications](/login?return_to=%2FMbed-TLS%2Fmbedtls) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)
* [Star
   5.7k](/login?return_to=%2FMbed-TLS%2Fmbedtls)

* [Code](/Mbed-TLS/mbedtls/tree/v2.7.17)
* [Issues
  1.3k](/Mbed-TLS/mbedtls/issues)
* [Pull requests
  265](/Mbed-TLS/mbedtls/pulls)
* [Projects
  0](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

Additional navigation options

* [Code](/Mbed-TLS/mbedtls/tree/v2.7.17)
* [Issues](/Mbed-TLS/mbedtls/issues)
* [Pull requests](/Mbed-TLS/mbedtls/pulls)
* [Projects](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

1. [Releases](/Mbed-TLS/mbedtls/releases)
2. [v2.7.17](/Mbed-TLS/mbedtls/releases/tag/v2.7.17)

# Mbed TLS 2.7.17

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/Mbed-TLS/mbedtls/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v2.7.17)

 Loading

[View all tags](/Mbed-TLS/mbedtls/tags)

![@yanesca](https://avatars.githubusercontent.com/u/6871045?s=40&v=4)
[yanesca](/yanesca)
released this
01 Sep 09:20

[v2.7.17](/Mbed-TLS/mbedtls/tree/v2.7.17)

[`7cd4d2d`](/Mbed-TLS/mbedtls/commit/7cd4d2dadb5fdc8410ee667f062646bd28f37e62)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

## Description

This release of Mbed TLS provides bug fixes and minor enhancements. This release includes fixes for security issues and the most notable of them are described in more detail in the [security advisories](https://tls.mbed.org/tech-updates/security-advisories).

## Features

* Support building on e2k (Elbrus) architecture: correctly enable -Wformat-signedness, and fix the code that causes signed-one-bit-field and sign-compare warnings. Contributed by makise-homura (Igor Molchanov) akemi\_homura@kurisa.ch.

## Security

* When checking X.509 CRLs, a certificate was only considered as revoked if its revocationDate was in the past according to the local clock if available. In particular, on builds without MBEDTLS\_HAVE\_TIME\_DATE, certificates were never considered as revoked. On builds with MBEDTLS\_HAVE\_TIME\_DATE, an attacker able to control the local clock (for example, an untrusted OS attacking a secure enclave) could prevent revocation of certificates via CRLs. Fixed by no longer checking the revocationDate field, in accordance with RFC 5280. Reported by yuemonangong in [#3340](https://github.com/Mbed-TLS/mbedtls/issues/3340). Reported independently and fixed by Raoul Strackx and Jethro Beekman in [#3433](https://github.com/Mbed-TLS/mbedtls/pull/3433).
* In (D)TLS record decryption, when using a CBC ciphersuites without the Encrypt-then-Mac extension, use constant code flow memory access patterns to extract and check the MAC. This is an improvement to the existing countermeasure against Lucky 13 attacks. The previous countermeasure was effective against network-based attackers, but less so against local attackers. The new countermeasure defends against local attackers, even if they have access to fine-grained measurements. In particular, this fixes a local Lucky 13 cache attack found and reported by Tuba Yavuz, Farhaan Fowze, Ken (Yihan) Bai, Grant Hernandez, and Kevin Butler (University of Florida) and Dave Tian (Purdue University).
* Fix side channel in RSA private key operations and static (finite-field) Diffie-Hellman. An adversary with precise enough timing and memory access information (typically an untrusted operating system attacking a secure enclave) could bypass an existing counter-measure (base blinding) and potentially fully recover the private key.
* Fix a 1-byte buffer overread in mbedtls\_x509\_crl\_parse\_der(). Credit to OSS-Fuzz for detecting the problem and to Philippe Antoine for pinpointing the problematic code.
* Zeroising of plaintext buffers in mbedtls\_ssl\_read() to erase unused application data from memory. Reported in [#689](https://github.com/Mbed-TLS/mbedtls/pull/689) by Johan Uppman Bruce of Sectra.

## Bugfix

* Use arc4random\_buf on NetBSD instead of rand implementation with cyclical lower bits. Fix contributed in [#3540](https://github.com/Mbed-TLS/mbedtls/pull/3540).
* Fix building library/net\_sockets.c on NetBSD. NetBSD conditionals were added for the backport to avoid the risk of breaking a platform. Original fix contributed by Nia Alarie in [#3422](https://github.com/Mbed-TLS/mbedtls/pull/3422). Adopted for long-term support branch 2.7 in [#3570](https://github.com/Mbed-TLS/mbedtls/pull/3570).
* Fix bug in redirection of unit test outputs on platforms where stdout is defined as a macro. First reported in [#2311](https://github.com/Mbed-TLS/mbedtls/issues/2311) and fix contributed in [#3528](https://github.com/Mbed-TLS/mbedtls/pull/3528). Adopted for LTS branch 2.7 in [#3600](https://github.com/Mbed-TLS/mbedtls/pull/3600).

## Changes

* Update copyright notices to use Linux Foundation guidance. As a result, the copyright of contributors other than Arm is now acknowledged, and the years of publishing are no longer tracked in the source files. This also eliminates the need for the lines declaring the files to be part of MbedTLS. Fixes [#3457](https://github.com/Mbed-TLS/mbedtls/issues/3457).

## Who should update

We recommend all affected users should update to take advantage of the bug fixes contained in this release at an appropriate point in their development lifecycle.

## Checksum

The SHA256 hashes for the archives are:

```
fae5441631a8696d1eae71f61b8276d728b41a905954326019830cdaf0afeb42  mbedtls-2.7.17.tar.gz
a009059b0b4b882b884e8ef7013ff068b1254d8a2d98243e000c67b1737956b6  mbedtls-2.7.17.zip

```

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_45c06f9c_20250119_114751.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Fpull%2F3433)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Fpull%2F3433)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=Mbed-TLS%2Fmbedtls)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Mbed-TLS](/Mbed-TLS)
/
**[mbedtls](/Mbed-TLS/mbedtls)**
Public

* [Notifications](/login?return_to=%2FMbed-TLS%2Fmbedtls) You must be signed in to change notification settings
* [Fork
  2.6k](/login?return_to=%2FMbed-TLS%2Fmbedtls)
* [Star
   5.7k](/login?return_to=%2FMbed-TLS%2Fmbedtls)

* [Code](/Mbed-TLS/mbedtls)
* [Issues
  1.3k](/Mbed-TLS/mbedtls/issues)
* [Pull requests
  265](/Mbed-TLS/mbedtls/pulls)
* [Projects
  0](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

Additional navigation options

* [Code](/Mbed-TLS/mbedtls)
* [Issues](/Mbed-TLS/mbedtls/issues)
* [Pull requests](/Mbed-TLS/mbedtls/pulls)
* [Projects](/Mbed-TLS/mbedtls/projects)
* [Security](/Mbed-TLS/mbedtls/security)
* [Insights](/Mbed-TLS/mbedtls/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FMbed-TLS%2Fmbedtls%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FMbed-TLS%2Fmbedtls%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Always revoke certificate on CRL #3433

 Merged

[gilles-peskine-arm](/gilles-peskine-arm)
merged 1 commit into
[Mbed-TLS:development](/Mbed-TLS/mbedtls/tree/development "Mbed-TLS/mbedtls:development")
from
[raoulstrackx:raoul/verify\_crl\_without\_time](/raoulstrackx/mbedtls/tree/raoul/verify_crl_without_time "raoulstrackx/mbedtls:raoul/verify_crl_without_time")

Aug 26, 2020

 Merged

# [Always revoke certificate on CRL](#top) #3433

[gilles-peskine-arm](/gilles-peskine-arm)
merged 1 commit into
[Mbed-TLS:development](/Mbed-TLS/mbedtls/tree/development "Mbed-TLS/mbedtls:development")
from
[raoulstrackx:raoul/verify\_crl\_without\_time](/raoulstrackx/mbedtls/tree/raoul/verify_crl_without_time "raoulstrackx/mbedtls:raoul/verify_crl_without_time")

Aug 26, 2020

[Conversation
39](/Mbed-TLS/mbedtls/pull/3433)
[Commits
1](/Mbed-TLS/mbedtls/pull/3433/commits)
[Checks
0](/Mbed-TLS/mbedtls/pull/3433/checks)
[Files changed](/Mbed-TLS/mbedtls/pull/3433/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=60&v=4)](/raoulstrackx)

Copy link

Contributor

### @raoulstrackx **[raoulstrackx](/raoulstrackx)** commented [Jun 16, 2020](#issue-639408013) • edited by mpg Loading

## Description

Always revoke certificate on CRL

RFC5280 (<https://tools.ietf.org/html/rfc5280>) does not state that the `revocationDate` should be checked.

In addition, when no time source is available (i.e., when MBEDTLS\_HAVE\_TIME\_DATE is not defined), `mbedtls_x509_time_is_past` always returns 0. This results in the CRL not being checked at all.

## Status

**READY**

## Requires Backporting

Yes

* 2.16 - [Backport 2.16: Always revoke certificate on CRL #3562](https://github.com/Mbed-TLS/mbedtls/pull/3562)
* 2.7 - [Backport 2.7: Always revoke certificate on CRL #3561](https://github.com/Mbed-TLS/mbedtls/pull/3561)

## Todos

* Tests
* Changelog updated

Fix [#3340](https://github.com/Mbed-TLS/mbedtls/issues/3340)

Sorry, something went wrong.

All reactions

 [![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=40&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)
[raoulstrackx](/raoulstrackx)
[force-pushed](/Mbed-TLS/mbedtls/compare/2dd3f94cedfe6921caed9233f761ea2ec897460d..20f3ef7ef5401e95cce6e24c813de8875938071d)
the
raoul/verify\_crl\_without\_time

branch
from
[`2dd3f94`](/Mbed-TLS/mbedtls/commit/2dd3f94cedfe6921caed9233f761ea2ec897460d) to
[`20f3ef7`](/Mbed-TLS/mbedtls/commit/20f3ef7ef5401e95cce6e24c813de8875938071d)  [Compare](/Mbed-TLS/mbedtls/compare/2dd3f94cedfe6921caed9233f761ea2ec897460d..20f3ef7ef5401e95cce6e24c813de8875938071d)
[June 16, 2020 06:53](#event-3447486588)

[raoulstrackx](/raoulstrackx)
added a commit
to raoulstrackx/rust-mbedtls
that referenced
this pull request
[Jun 16, 2020](#ref-commit-052976c)
[![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=40&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)

`[Conditional compilation of test](/raoulstrackx/rust-mbedtls/commit/052976c532dfc51db776a42e273448a56293f7cc "Conditional compilation of test

A bug in the ARMmbed mbedtls library only revokes certificates when a time source is
available. We temporarily disable the following test, until patch
https://github.com/ARMmbed/mbedtls/pull/3433 lands and we use the updated library")`
…

`[052976c](/raoulstrackx/rust-mbedtls/commit/052976c532dfc51db776a42e273448a56293f7cc)`

```
A bug in the ARMmbed mbedtls library only revokes certificates when a time source is
available. We temporarily disable the following test, until patch
[Mbed-TLS/mbedtls#3433](https://github.com/Mbed-TLS/mbedtls/pull/3433) lands and we use the updated library
```

 [![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=40&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)
[raoulstrackx](/raoulstrackx)
[force-pushed](/Mbed-TLS/mbedtls/compare/7bf03958f1744ec561b3c9332000c397d815086a..7c14bc284738b75d7b655547ba74fe38ee5ec68d)
the
raoul/verify\_crl\_without\_time

branch
2 times, most recently
from
[`7bf0395`](/Mbed-TLS/mbedtls/commit/7bf03958f1744ec561b3c9332000c397d815086a) to
[`7c14bc2`](/Mbed-TLS/mbedtls/commit/7c14bc284738b75d7b655547ba74fe38ee5ec68d)  [Compare](/Mbed-TLS/mbedtls/compare/7bf03958f1744ec561b3c9332000c397d815086a..7c14bc284738b75d7b655547ba74fe38ee5ec68d)
[June 16, 2020 09:33](#event-3448108214)

[![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=40&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)
[raoulstrackx](/raoulstrackx)
changed the title
~~When no time source available, always revoke certificate on CRL~~
Always revoke certificate on CRL
[Jun 16, 2020](#event-3448112100)

[![@danh-arm](https://avatars.githubusercontent.com/u/5684642?s=40&v=4)](/danh-arm)
[danh-arm](/danh-arm)
assigned [mpg](/mpg)
[Jun 18, 2020](#event-3457177007)

[![@mpg](https://avatars.githubusercontent.com/u/60640?s=40&u=247379ad8312663047074f24612a32aeb76cc388&v=4)](/mpg)
[mpg](/mpg)
added
[bug](/Mbed-TLS/mbedtls/labels/bug)
[component-x509](/Mbed-TLS/mbedtls/labels/component-x509)
[needs-backports](/Mbed-TLS/mbedtls/labels/needs-backports)
Backports are missing or are pending review and approval.
[needs: changelog](/Mbed-TLS/mbedtls/labels/needs%3A%20changelog)
[needs-review](/Mbed-TLS/mbedtls/labels/needs-review)
Every commit must be reviewed by at least two team members,
labels
[Jun 19, 2020](#event-3461992848)

[![@mpg](https://avatars.githubusercontent.com/u/60640?s=80&u=247379ad8312663047074f24612a32aeb76cc388&v=4)](/mpg)

Copy link

Contributor

### **[mpg](/mpg)** commented [Jun 22, 2020](#issuecomment-647334555)

| Thanks for your contribution! I agree with your assessment: I looked at all instances of "revocationDate" in RFC 5280 and it never says that it should be checked. Moreover, point (j) on [page 95](https://tools.ietf.org/html/rfc5280#page-95) says to marked as revoked as soon as issuer name and serial number match. It looks like this field is more informational (a bit like the optional "reason" field.) Also, from a security perspective, if the certificate ended up on a CRL, it shouldn't be trusted regardless of the revocation date, especially considering the local clock can't always be trusted.  The new behaviour should come with a test. Please generate a CRL with a revocation date in the far future (to make sure it's still in the future in a few years) for one of our existing certificate and add a test for verifying this certificate with that CRL using the function `x509_verify` in `tests/suites/test_suite_x509parse.data`. The generated CRL file should live in `tests/data_files` and its generation method documented in `tests/data_files/Makefile`. In order to obtain a revocation date in the future, you might need to use the `faketime` utility (see examples in that Makefile). Feel free to ask for help on testing if needed, we're aware that out test system is not always intuitive first time you touch it.  Since this changes the observable behaviour, it deserves an entry in our ChangeLog, I'd say under `Bugfix` as the current behaviour isn't in accordance to the standard. Can you write one? See [https://github.com/ARMmbed/mbedtls/blob/development/ChangeLog.d/00README.md](the ChangeLog README).  Finally, can you add a Signed-Off-By line to your commit message, ton indicate that you agree with our [licensing terms](https://github.com/ARMmbed/mbedtls#license)? |
| --- |

All reactions

Sorry, something went wrong.

[![mpg](https://avatars.githubusercontent.com/u/60640?s=60&v=4)](/mpg)

**[mpg](/mpg)**
reviewed
[Jun 22, 2020](#pullrequestreview-434660864)

 [View reviewed changes](/Mbed-TLS/mbedtls/pull/3433/files)

Copy link

Contributor

### @mpg **[mpg](/mpg)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

The change itself looks good to me, but there are a few additional things to do:

* add a test
* add a ChangeLog entry
* add a Signed-Off-By line in each commit message

Sorry, something went wrong.

All reactions

[![@mpg](https://avatars.githubusercontent.com/u/60640?s=40&u=247379ad8312663047074f24612a32aeb76cc388&v=4)](/mpg)
[mpg](/mpg)
added
[needs-work](/Mbed-TLS/mbedtls/labels/needs-work)
and removed
[needs-review](/Mbed-TLS/mbedtls/labels/needs-review)
Every commit must be reviewed by at least two team members,
labels
[Jun 22, 2020](#event-3466927586)

 [![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=40&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)
[raoulstrackx](/raoulstrackx)
[force-pushed](/Mbed-TLS/mbedtls/compare/dd3f37032c91d16a5dea29c40f024f31f0417a25..1369231f82bc36d37696236b3b5ad24f127ef3b3)
the
raoul/verify\_crl\_without\_time

branch
2 times, most recently
from
[`dd3f370`](/Mbed-TLS/mbedtls/commit/dd3f37032c91d16a5dea29c40f024f31f0417a25) to
[`1369231`](/Mbed-TLS/mbedtls/commit/1369231f82bc36d37696236b3b5ad24f127ef3b3)  [Compare](/Mbed-TLS/mbedtls/compare/dd3f37032c91d16a5dea29c40f024f31f0417a25..1369231f82bc36d37696236b3b5ad24f127ef3b3)
[June 22, 2020 12:00](#event-3468004744)

[![mpg](https://avatars.githubusercontent.com/u/60640?s=60&v=4)](/mpg)

**[mpg](/mpg)**
requested changes
[Jun 24, 2020](#pullrequestreview-436527764)

 [View reviewed changes](/Mbed-TLS/mbedtls/pull/3433/files)

Copy link

Contributor

### @mpg **[mpg](/mpg)** left a comment • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks for adding a ChangeLog entry and unit tests as requested! This is looking quite good, except for a typo in the ChangeLog entry; I also suggested a possible improvement to the test descriptions.

Sorry, something went wrong.

All reactions

[tests/suites/test\_suite\_x509parse.data](/Mbed-TLS/mbedtls/pull/3433/files#diff-68b43426b4fc8bb755242c7311b954e8bf5cde2ac35dec906ea086dc2c0fbbe7)
Outdated

Show resolved

Hide resolved

[ChangeLog.d/fix-crl-revocationDate.txt](/Mbed-TLS/mbedtls/pull/3433/files#diff-2bcb97eda8b034d3b78ef504180a469c1f789fb0812caff7002ca09499f90321)
Outdated

Show resolved

Hide resolved

[ChangeLog.d/fix-crl-revocationDate.txt](/Mbed-TLS/mbedtls/pull/3433/files#diff-2bcb97eda8b034d3b78ef504180a469c1f789fb0812caff7002ca09499f90321)
Outdated

|  |  | \* A CRL's "revocationDate" entry field is on longer checked to be in the |
| --- | --- | --- |
|  |  | past. This brings the implementation in line with RFC 5280. Note that |
|  |  | this also is a security fix in environments where the local clock cannot |
|  |  | be trusted (e.g., in an Intel SGX enclave). Reported by Raoul Strackx & |

Copy link

Contributor

### @mpg **[mpg](/mpg)** [Jun 24, 2020](#discussion_r444807974)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

That's an interesting point. As you've noted when adding tests (thanks for that!), currently we have a `config.h` option `MBEDTLS_HAVE_TIME_DATE` whose documentation reads:

```
 * System has time.h, time(), and an implementation for
 * mbedtls_platform_gmtime_r() (see below).
 * The time needs to be correct (not necessarily very accurate, but at least
 * the date should be correct). This is used to verify the validity period of
 * X.509 certificates.
 *
 * Comment if your system does not have a correct clock.

```

Perhaps this documentation should be made more explicit:

```
 * \warning You should comment this out if the system's clock could be controlled by an attacker.

```

I'm mentioning this because my initial reaction was "but on systems where the local clock can't be trusted, people should just undefine `MBEDTLS_HAVE_TIME_DATE`" - then I checked if the documentation was actually making that clear, and perhaps not enough.

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @gilles-peskine-arm **[gilles-peskine-arm](/gilles-peskine-arm)** [Jun 24, 2020](#discussion_r444817791)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

“people should just undefine `MBEDTLS_HAVE_TIME_DATE`” That depends on your threat model. Undefining `MBEDTLS_HAVE_TIME_DATE` means that no certificate will ever be considered to have expired.

Sorry, something went wrong.

 👍
1
 jethrogb reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Copy link

Contributor

Author

### @raoulstrackx **[raoulstrackx](/raoulstrackx)** [Jun 24, 2020](#discussion_r444821264)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I agree description could be more clear. The same applies for `MBEDTLS_HAVE_TIME`: when the system's clock can't be trusted, it also cannot be trusted for measuring time differences.

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @raoulstrackx **[raoulstrackx](/raoulstrackx)** [Jun 24, 2020](#discussion_r444823497)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Good point [@gilles-peskine-arm](https://github.com/gilles-peskine-arm) but if you leave `MBEDTLS_HAVE_TIME_DATE` defined, things like SSL caches may never expire.

Sorry, something went wrong.

All reactions

Copy link

Contributor

### @mpg **[mpg](/mpg)** [Jun 25, 2020](#discussion_r445386591)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Ok, after thinking a bit more about this, I think I was wrong to suggest placing the ChangeLog entry under "Bugfix". As the PR description says, when `MBEDTLS_HAVE_TIME_DATE` is unset, we would simply never consider any certificate as revoked. I'm not sure how I overlooked this before, but that's enough to qualify as a security issue.

I'm now thinking the ChangeLog entry should look more like:

```
Security
   * When checking X.509 CRLs, a certificate was only considered as revoked if its revocationDate was in the past according to the local clock if available. In particular, on builds without MBEDTLS_HAVE_TIME_DATE, certificates were never considered as revoked. On builds with MBEDTLS_HAVE_TIME_DATE, an attacker able to control the local clock (for example, an untrusted OS attacking a secure enclave) could prevent revocation of certificates via CRLs. Fixed by no longer checking the revocationDate field, in accordance with RFC 5280.  Reported and fixed by Raoul Strackx & Jethro Beekman.

```

Sorry, something went wrong.

All reactions

 [![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=40&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)
[raoulstrackx](/raoulstrackx)
[force-pushed](/Mbed-TLS/mbedtls/compare/1369231f82bc36d37696236b3b5ad24f127ef3b3..3529f78d9f756dd6dded97691261f33a394471c8)
the
raoul/verify\_crl\_without\_time

branch
from
[`1369231`](/Mbed-TLS/mbedtls/commit/1369231f82bc36d37696236b3b5ad24f127ef3b3) to
[`3529f78`](/Mbed-TLS/mbedtls/commit/3529f78d9f756dd6dded97691261f33a394471c8)  [Compare](/Mbed-TLS/mbedtls/compare/1369231f82bc36d37696236b3b5ad24f127ef3b3..3529f78d9f756dd6dded97691261f33a394471c8)
[June 24, 2020 11:14](#event-3477011835)

[![mpg](https://avatars.githubusercontent.com/u/60640?s=60&v=4)](/mpg)

**[mpg](/mpg)**
requested changes
[Jun 25, 2020](#pullrequestreview-437270316)

 [View reviewed changes](/Mbed-TLS/mbedtls/pull/3433/files)

Copy link

Contributor

### @mpg **[mpg](/mpg)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks for updating the PR according to our feedback.

As commented above, I think I was wrong to recommend a "bugfix" changelog entry.

Also, I'm afraid one of the tests you added is currently not exercised in our CI, which should be fixed.

Finally, regarding changes to the documentation and to the ChangeLog, you may want to wait for Gilles to weigh in, in case we're not immediately in agreement, to avoid making changes in different directions each time one of us comments.

Sorry, something went wrong.

All reactions

[include/mbedtls/config.h](/Mbed-TLS/mbedtls/pull/3433/files#diff-f781da22676e488056bc0453f79e0e4dee75eb68433a7ae66e257d17e50cfd89)
Outdated

Show resolved

Hide resolved

[tests/suites/test\_suite\_x509parse.data](/Mbed-TLS/mbedtls/pull/3433/files#diff-68b43426b4fc8bb755242c7311b954e8bf5cde2ac35dec906ea086dc2c0fbbe7)

Show resolved

Hide resolved

[![@mpg](https://avatars.githubusercontent.com/u/60640?s=40&u=247379ad8312663047074f24612a32aeb76cc388&v=4)](/mpg)
[mpg](/mpg)
added
the
[needs-review](/Mbed-TLS/mbedtls/labels/needs-review)
Every commit must be reviewed by at least two team members,
label
[Jun 25, 2020](#event-3481153796)

 [![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=40&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)
[raoulstrackx](/raoulstrackx)
[force-pushed](/Mbed-TLS/mbedtls/compare/3529f78d9f756dd6dded97691261f33a394471c8..98122db15fb64bfc10cf6e77bb330e453c696c7a)
the
raoul/verify\_crl\_without\_time

branch
from
[`3529f78`](/Mbed-TLS/mbedtls/commit/3529f78d9f756dd6dded97691261f33a394471c8) to
[`98122db`](/Mbed-TLS/mbedtls/commit/98122db15fb64bfc10cf6e77bb330e453c696c7a)  [Compare](/Mbed-TLS/mbedtls/compare/3529f78d9f756dd6dded97691261f33a394471c8..98122db15fb64bfc10cf6e77bb330e453c696c7a)
[June 25, 2020 12:45](#event-3482209627)

[![mpg](https://avatars.githubusercontent.com/u/60640?s=60&v=4)](/mpg)

**[mpg](/mpg)**
requested changes
[Jun 26, 2020](#pullrequestreview-438075943)

 [View reviewed changes](/Mbed-TLS/mbedtls/pull/3433/files)

Copy link

Contributor

### @mpg **[mpg](/mpg)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks for updating the PR. I'm satisfied with the result, but the CI complains about whitespace issues, which need to be fixed.

Sorry, something went wrong.

All reactions

[ChangeLog.d/crl-revocationDate.txt](/Mbed-TLS/mbedtls/pull/3433/files#diff-1438f10acecaa78d0328084780aae78fe97fdf99b556468e324741f0c93f7d64)
Outdated

Show resolved

Hide resolved

 [![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=40&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)
[raoulstrackx](/raoulstrackx)
[force-pushed](/Mbed-TLS/mbedtls/compare/98122db15fb64bfc10cf6e77bb330e453c696c7a..b21e50960a2cd7fa565c92121117cf0f57eddd40)
the
raoul/verify\_crl\_without\_time

branch
from
[`98122db`](/Mbed-TLS/mbedtls/commit/98122db15fb64bfc10cf6e77bb330e453c696c7a) to
[`b21e509`](/Mbed-TLS/mbedtls/commit/b21e50960a2cd7fa565c92121117cf0f57eddd40)  [Compare](/Mbed-TLS/mbedtls/compare/98122db15fb64bfc10cf6e77bb330e453c696c7a..b21e50960a2cd7fa565c92121117cf0f57eddd40)
[June 26, 2020 09:09](#event-3485785671)

[![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=80&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)

Copy link

Contributor

Author

### **[raoulstrackx](/raoulstrackx)** commented [Jul 1, 2020](#issuecomment-652372274)

| [@mpg](https://github.com/mpg) could you send me the output of CI? Running the tests locally doesn't give me much insight. There are failed tests, but those fail on the development branch too. |
| --- |

All reactions

Sorry, something went wrong.

[![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=80&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)

Copy link

Contributor

Author

### **[raoulstrackx](/raoulstrackx)** commented [Jul 1, 2020](#issuecomment-652373059)

| One of the tests that fail is:  client:  ``` ../programs/ssl/ssl_client2 server_port=14928 server_addr=127.0.0.1 force_version=tls1_2 ca_file=none auth_mode=none crt_file=none key_file=none force_ciphersuite=TLS-ECDHE-ECDSA-WITH-AES-128-CBC-SHA256                                                                                                                                                                                                                                                 . Seeding the random number generator... ok                                                                                                                                                                                                   . Loading the CA root certificate ... ok (0 skipped)                                                                                                                                                                                          . Loading the client cert. and key... ok (key type: invalid PK)                                                                                                                                                                               . Connecting to tcp/127.0.0.1/14928... ok                                                                                                                                                                                                     . Setting up the SSL/TLS structure... ok                                                                                                                                                                                                      . Performing the SSL/TLS handshake... failed                                                                                                                                                                                                  ! mbedtls_ssl_handshake returned -0x7780                                                                                                                                                                                                                                                                                                                                                                                                                                                  Last error was: -0x7780 - SSL - A fatal alert message was received from our peer                                                                                                                                                                                                                                                                                                                                                                                                            EXIT: 1                                                                                                                                                                                                                                       EXIT: 1  ```  server:  ``` gnutls-serv -p 14928 --http  --disable-client-cert --x509certfile data_files/server5.crt --x509keyfile data_files/server5.key --priority NORMAL:+AES-256-CCM-8:+AES-128-CCM-8:+ARCFOUR-128:+NULL:+MD5:+PSK:+DHE-PSK:+ECDHE-PSK:+RSA-PSK:-VERS-TLS-ALL:+VERS-TLS1.2                                                                                                                                                                                                                         HTTP Server listening on IPv4 0.0.0.0 port 14928...done HTTP Server listening on IPv6 :: port 14928...done                                                                                                                                                                                            No certificates found!                                                                                                                                                                                                                        Set static Diffie-Hellman parameters, consider --dhparams.                                                                                                                                                                                                                                                                                                                                                                                                                                  * Accepted connection from IPv4 127.0.0.1 port 51090 on Wed Jul  1 13:45:09 2020                                                                                                                                                              - Description: (TLS1.2)-(ECDHE-ECDSA-SECP521R1)-(AES-128-CBC)-(SHA1)                                                                                                                                                                          - Session ID: 3A:1B:0B:91:85:1B:B3:D2:D3:CA:5B:83:6B:AD:8C:B0:35:4A:21:01:72:E6:F5:B3:65:73:0D:F0:E0:C6:D3:21                                                                                                                                 - Given server name[1]: localhost                                                                                                                                                                                                             - Ephemeral EC Diffie-Hellman parameters                                                                                                                                                                                                       - Using curve: SECP521R1                                                                                                                                                                                                                      - Curve size: 528 bits                                                                                                                                                                                                                       - Version: TLS1.2 - Key Exchange: ECDHE-ECDSA - Server Signature: ECDSA-SHA512 - Cipher: AES-128-CBC - MAC: SHA1 - Compression: NULL - Options: extended master secret, safe renegotiation, EtM, - Channel binding 'tls-unique': 0c25dc0a33cd9291f2a8d0e0 No certificates found!  * Accepted connection from IPv4 127.0.0.1 port 51092 on Wed Jul  1 13:45:09 2020 - Description: (TLS1.2)-(ECDHE-ECDSA-SECP521R1)-(AES-256-CBC)-(SHA1) - Session ID: 6F:38:69:0F:4D:1E:24:32:B2:1A:F6:E3:51:86:B9:1E:23:87:83:27:D3:A5:2A:26:29:6B:61:3B:FB:D6:60:39 - Given server name[1]: localhost - Ephemeral EC Diffie-Hellman parameters  - Using curve: SECP521R1  - Curve size: 528 bits - Version: TLS1.2 - Key Exchange: ECDHE-ECDSA - Server Signature: ECDSA-SHA512 - Cipher: AES-256-CBC - MAC: SHA1 - Compression: NULL - Options: extended master secret, safe renegotiation, EtM, - Channel binding 'tls-unique': f2fe159ed656e501fe4a5b85 Error in handshake  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@gilles-peskine-arm](https://avatars.githubusercontent.com/u/26596258?s=40&v=4)](/gilles-peskine-arm)
[gilles-peskine-arm](/gilles-peskine-arm)
removed
the
[needs-work](/Mbed-TLS/mbedtls/labels/needs-work)
label
[Jul 1, 2020](#event-3502155768)

[![@gilles-peskine-arm](https://avatars.githubusercontent.com/u/26596258?s=80&v=4)](/gilles-peskine-arm)

Copy link

Contributor

### **[gilles-peskine-arm](/gilles-peskine-arm)** commented [Jul 1, 2020](#issuecomment-652383201)

| You don't need to do anything else to pass CI.   * Travis passed. * `pr-head` had a single test case failure which is in a DTLS test where an unexpected resend happened. This can happen if the OS drops a UDP packet, which is rare but possible. So that's as good as a pass. * `pr-merge` passed with an older version of `development`, and didn't run with the latest version due to the "needs work" label. I've kicked a new run, should be over in an hour or so. * Mbed OS jobs are failing due to an unrelated change on the Mbed OS side. We're ignoring Mbed OS CI results until that's fixed.   If you're getting failures with interoperability tests locally, it's probably because you're using different versions of OpenSSL and GnuTLS. Different tests need different versions because older versions lack some features or have bugs, and newer versions have removed some obsolete features. The docker image in `tests/docker` should work. |
| --- |

All reactions

Sorry, something went wrong.

21 hidden items

Load more…

[![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=80&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)

Copy link

Contributor

Author

### **[raoulstrackx](/raoulstrackx)** commented [Aug 13, 2020](#issuecomment-673363184)

| Thanks for your help!  Who would be backporting the patch? |
| --- |

All reactions

Sorry, something went wrong.

[![@mpg](https://avatars.githubusercontent.com/u/60640?s=80&u=247379ad8312663047074f24612a32aeb76cc388&v=4)](/mpg)

Copy link

Contributor

### **[mpg](/mpg)** commented [Aug 13, 2020](#issuecomment-673377073)

| Well, if you're willing to do it, that would be much appreciated. It would involve raising two new PRs, one targeting mbedtls-2.16, the other targeting mbedtls-2.7, with the same content as this one (usually `git cherry-pick` is helpful for that), and then linking to those in this PR's description.  Otherwise, we can handle it ourselves, but that may be a bit slower as that means involving more people on our side (1 for creating the PRs, 2 for reviewing them, while if you can create the PRs, the 2 reviewers who approved the original can usually review the backports pretty quickly).  Just let us know. |
| --- |

All reactions

Sorry, something went wrong.

[![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=80&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)

Copy link

Contributor

Author

### **[raoulstrackx](/raoulstrackx)** commented [Aug 13, 2020](#issuecomment-673381226)

| Sure I can do that. |
| --- |

 👍
1
 mpg reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=80&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)

Copy link

Contributor

Author

### **[raoulstrackx](/raoulstrackx)** commented [Aug 13, 2020](#issuecomment-673496358)

| Backported as [#3561](https://github.com/Mbed-TLS/mbedtls/pull/3561) and [#3562](https://github.com/Mbed-TLS/mbedtls/pull/3562) |
| --- |

All reactions

Sorry, something went wrong.

This was referenced Aug 14, 2020

[Backport 2.7: Always revoke certificate on CRL
#3561](/Mbed-TLS/mbedtls/pull/3561)
 Merged

[Backport 2.16: Always revoke certificate on CRL
#3562](/Mbed-TLS/mbedtls/pull/3562)
 Merged

[![@gilles-peskine-arm](https://avatars.githubusercontent.com/u/26596258?s=40&v=4)](/gilles-peskine-arm)
[gilles-peskine-arm](/gilles-peskine-arm)
removed
the
[needs-backports](/Mbed-TLS/mbedtls/labels/needs-backports)
Backports are missing or are pending review and approval.
label
[Aug 14, 2020](#event-3657709919)

[![@gilles-peskine-arm](https://avatars.githubusercontent.com/u/26596258?s=80&v=4)](/gilles-peskine-arm)

Copy link

Contributor

### **[gilles-peskine-arm](/gilles-peskine-arm)** commented [Aug 14, 2020](#issuecomment-674274799)

| Unfortunately, there's a conflict. It's a simple add/add conflict, but it prevents merging. Please either merge with the latest state of the `development` branch or rebase on top of `development`. |
| --- |

All reactions

Sorry, something went wrong.

[![@gilles-peskine-arm](https://avatars.githubusercontent.com/u/26596258?s=40&v=4)](/gilles-peskine-arm)
[gilles-peskine-arm](/gilles-peskine-arm)
added
[needs-work](/Mbed-TLS/mbedtls/labels/needs-work)
and removed
[needs-work](/Mbed-TLS/mbedtls/labels/needs-work)
labels
[Aug 14, 2020](#event-3657715314)

[![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=40&v=4)](/raoulstrackx)

`[Always revoke certificate on CRL](/Mbed-TLS/mbedtls/pull/3433/commits/a4e86141f1451e8097f85a823a4426e1c1cfdf7c "Always revoke certificate on CRL

RFC5280 does not state that the `revocationDate` should be checked.

In addition, when no time source is available (i.e., when MBEDTLS_HAVE_TIME_DATE is not defined), `mbedtls_x509_time_is_past` always returns 0. This results in the CRL not being checked at all.

https://tools.ietf.org/html/rfc5280
Signed-off-by: Raoul Strackx <raoul.strackx@fortanix.com>")`
 …

`[a4e8614](/Mbed-TLS/mbedtls/pull/3433/commits/a4e86141f1451e8097f85a823a4426e1c1cfdf7c)`

```
RFC5280 does not state that the `revocationDate` should be checked.

In addition, when no time source is available (i.e., when MBEDTLS_HAVE_TIME_DATE is not defined), `mbedtls_x509_time_is_past` always returns 0. This results in the CRL not being checked at all.

<https://tools.ietf.org/html/rfc5280>
Signed-off-by: Raoul Strackx <raoul.strackx@fortanix.com>
```

 [![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=40&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)
[raoulstrackx](/raoulstrackx)
dismissed stale reviews from [mpg](/mpg) and [gilles-peskine-arm](/gilles-peskine-arm)
via
`[a4e8614](/Mbed-TLS/mbedtls/commit/a4e86141f1451e8097f85a823a4426e1c1cfdf7c)`
[August 17, 2020 07:05](#event-3660476211)

 [![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=40&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)
[raoulstrackx](/raoulstrackx)
[force-pushed](/Mbed-TLS/mbedtls/compare/27c4a8db94883c3febfb2caf8773329000c2f509..a4e86141f1451e8097f85a823a4426e1c1cfdf7c)
the
raoul/verify\_crl\_without\_time

branch
from
[`27c4a8d`](/Mbed-TLS/mbedtls/commit/27c4a8db94883c3febfb2caf8773329000c2f509) to
[`a4e8614`](/Mbed-TLS/mbedtls/commit/a4e86141f1451e8097f85a823a4426e1c1cfdf7c)  [Compare](/Mbed-TLS/mbedtls/compare/27c4a8db94883c3febfb2caf8773329000c2f509..a4e86141f1451e8097f85a823a4426e1c1cfdf7c)
[August 17, 2020 07:05](#event-3660476214)

[![mpg](https://avatars.githubusercontent.com/u/60640?s=60&v=4)](/mpg)

**[mpg](/mpg)**
approved these changes
[Aug 17, 2020](#pullrequestreview-468249914)

 [View reviewed changes](/Mbed-TLS/mbedtls/pull/3433/files/a4e86141f1451e8097f85a823a4426e1c1cfdf7c)

Copy link

Contributor

### @mpg **[mpg](/mpg)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks for resolving the conflict. I've done the rebase myself and got an equivalent result.

Sorry, something went wrong.

All reactions

[![@mpg](https://avatars.githubusercontent.com/u/60640?s=40&u=247379ad8312663047074f24612a32aeb76cc388&v=4)](/mpg)
[mpg](/mpg)
added
the
[needs-review](/Mbed-TLS/mbedtls/labels/needs-review)
Every commit must be reviewed by at least two team members,
label
[Aug 18, 2020](#event-3665115963)

 [![@mpg](https://avatars.githubusercontent.com/u/60640?s=40&u=247379ad8312663047074f24612a32aeb76cc388&v=4)](/mpg)
[mpg](/mpg)
requested a review
from [gilles-peskine-arm](/gilles-peskine-arm)
[August 18, 2020 08:07](#event-3665116215)

[![gilles-peskine-arm](https://avatars.githubusercontent.com/u/26596258?s=60&v=4)](/gilles-peskine-arm)

**[gilles-peskine-arm](/gilles-peskine-arm)**
approved these changes
[Aug 19, 2020](#pullrequestreview-470349254)

 [View reviewed changes](/Mbed-TLS/mbedtls/pull/3433/files/a4e86141f1451e8097f85a823a4426e1c1cfdf7c)

[![@gilles-peskine-arm](https://avatars.githubusercontent.com/u/26596258?s=40&v=4)](/gilles-peskine-arm)
[gilles-peskine-arm](/gilles-peskine-arm)
added
[needs-backports](/Mbed-TLS/mbedtls/labels/needs-backports)
Backports are missing or are pending review and approval.
and removed
[needs-review](/Mbed-TLS/mbedtls/labels/needs-review)
Every commit must be reviewed by at least two team members,
labels
[Aug 19, 2020](#event-3670242034)

[![@gilles-peskine-arm](https://avatars.githubusercontent.com/u/26596258?s=80&v=4)](/gilles-peskine-arm)

Copy link

Contributor

### **[gilles-peskine-arm](/gilles-peskine-arm)** commented [Aug 19, 2020](#issuecomment-676152346)

| Thanks. Please resolve the similar conflict in the backports as well. |
| --- |

All reactions

Sorry, something went wrong.

[![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=80&u=965d2c79a5c823ddf809ff5a8d54e55f30246be8&v=4)](/raoulstrackx)

Copy link

Contributor

Author

### **[raoulstrackx](/raoulstrackx)** commented [Aug 26, 2020](#issuecomment-680779386)

| Sorry for the late response. Merge conflicts have been resolved |
| --- |

All reactions

Sorry, something went wrong.

[![@gilles-peskine-arm](https://avatars.githubusercontent.com/u/26596258?s=40&v=4)](/gilles-peskine-arm)
[gilles-peskine-arm](/gilles-peskine-arm)
added
[approved](/Mbed-TLS/mbedtls/labels/approved)
Design and code approved - may be waiting for CI or backports
and removed
[needs-backports](/Mbed-TLS/mbedtls/labels/needs-backports)
Backports are missing or are pending review and approval.
labels
[Aug 26, 2020](#event-3694226636)

[![@gilles-peskine-arm](https://avatars.githubusercontent.com/u/26596258?s=40&v=4)](/gilles-peskine-arm)
[gilles-peskine-arm](/gilles-peskine-arm)
merged commit [`9e4d438`](/Mbed-TLS/mbedtls/commit/9e4d4387f07326fff227a40f76c25e5181b1b1e2)
into
Mbed-TLS:development

[Aug 26, 2020](https://github.com/Mbed-TLS/mbedtls/pull/3433#event-3694226995)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FMbed-TLS%2Fmbedtls%2Fpull%2F3433)

Reviewers

[![@jethrogb](https://avatars.githubusercontent.com/u/1132307?s=40&v=4)](/jethrogb) [jethrogb](/jethrogb)

jethrogb left review comments

[![@gilles-peskine-arm](https://avatars.githubusercontent.com/u/26596258?s=40&v=4)](/gilles-peskine-arm) [gilles-peskine-arm](/gilles-peskine-arm)

gilles-peskine-arm approved these changes

[![@mpg](https://avatars.githubusercontent.com/u/60640?s=40&v=4)](/mpg) [mpg](/mpg)

mpg approved these changes

[![@ronald-cron-arm](https://avatars.githubusercontent.com/u/39518861?s=40&v=4)](/ronald-cron-arm) [ronald-cron-arm](/ronald-cron-arm)

 Awaiting requested review from ronald-cron-arm

Assignees

[![@mpg](https://avatars.githubusercontent.com/u/60640?s=40&v=4)](/mpg) [mpg](/mpg)

Labels

[approved](/Mbed-TLS/mbedtls/labels/approved)
Design and code approved - may be waiting for CI or backports
[bug](/Mbed-TLS/mbedtls/labels/bug)
[component-x509](/Mbed-TLS/mbedtls/labels/component-x509)

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [It may not be necessary to check the "revocation date"](https://github.com/Mbed-TLS/mbedtls/issues/3340)

5 participants

[![@raoulstrackx](https://avatars.githubusercontent.com/u/56830709?s=52&v=4)](/raoulstrackx) [![@mpg](https://avatars.githubusercontent.com/u/60640?s=52&v=4)](/mpg) [![@gilles-peskine-arm](https://avatars.githubusercontent.com/u/26596258?s=52&v=4)](/gilles-peskine-arm) [![@ronald-cron-arm](https://avatars.githubusercontent.com/u/39518861?s=52&v=4)](/ronald-cron-arm) [![@jethrogb](https://avatars.githubusercontent.com/u/1132307?s=52&v=4)](/jethrogb)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_d6643edf_20250119_114756.html ===


---

[[Date Prev](msg00035.html)][[Date Next](msg00037.html)]
[[Thread Prev](msg00035.html)][[Thread Next](msg00037.html)]
[[Date Index](maillist.html#00036)]
[[Thread Index](threads.html#00036)]

# [SECURITY] [DLA 3249-1] mbedtls security update

---

* *To*: debian-lts-announce <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3249-1] mbedtls security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Mon, 26 Dec 2022 00:33:58 +0100
* *Message-id*: <[[🔎]](/msgid-search/414914e3b2cdd0d6b297d2baec1e859d0cd3916a.camel%40debian.org) [414914e3b2cdd0d6b297d2baec1e859d0cd3916a.camel@debian.org](msg00036.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3249-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Markus Koschany
December 26, 2022                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : mbedtls
Version        : 2.16.9-0~deb10u1
CVE ID         : CVE-2019-16910 CVE-2019-18222 CVE-2020-10932 CVE-2020-10941
                 CVE-2020-16150 CVE-2020-36421 CVE-2020-36422 CVE-2020-36423
                 CVE-2020-36424 CVE-2020-36425 CVE-2020-36426 CVE-2020-36475
                 CVE-2020-36476 CVE-2020-36478 CVE-2021-24119 CVE-2021-43666
                 CVE-2021-44732 CVE-2022-35409
Debian Bug     : 941265 963159 972806 1002631

Multiple security vulnerabilities have been discovered in mbedtls, a
lightweight crypto and SSL/TLS library, which may allow attackers to obtain
sensitive information like the RSA private key or cause a denial of service
(application or server crash).

For Debian 10 buster, these problems have been fixed in version
2.16.9-0~deb10u1.

We recommend that you upgrade your mbedtls packages.

For the detailed security status of mbedtls please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/mbedtls>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpsZBICojoMg.pgp)**

*Description:* This is a digitally signed message part

---


