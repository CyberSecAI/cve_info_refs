=== Content from bitbucket.org_f003bc58_20250119_123644.html ===




=== Content from alquimistadesistemas.com_552739f6_20250119_123643.html ===

[![Alquimista de sistemas](https://alquimistadesistemas.com/images/logo.png)](https://alquimistadesistemas.com/)

de sistemas

* [ofensiva](/category/ofensiva)
* [defensiva](/category/defensiva)
* [linux](/category/linux)
* [windows](/category/windows)
* [bash](/category/bash)
* [web](/category/web)
* [vbs](/category/vbs)
* [mysql](/category/mysql)
* [red](/category/red)

# SQL Injection y archivo peligroso en Demokratian

---

* mar 05 mayo 2020
* [ofensiva](https://alquimistadesistemas.com/category/ofensiva)
* [#auditar software sqli demokratian](https://alquimistadesistemas.com/tag/auditar-software-sqli-demokratian.html)

![Demokratian_logo](/images/demokratian-logo.jpg "Demokratian logo")

Demokratian es una aplicaciÃ³n web para realizar votaciones de forma sencilla y segura. Es software libre y puede ser utilizada sin mucho nivel tÃ©cnico.
EstÃ¡ escrita en PHP y que utiliza una base de datos MySQL.

Por casualidades encontrÃ© el software demokratian en unas votaciones en las que participÃ©. Al participar me entrÃ³ la curiosidad y realizando algunas pruebas encontrÃ© estas 2 vulnerabildades.

Hay que decir que el desarrollador, al contactar con el, arreglo el bug bastante rÃ¡pido.

### Info del Software

* Nombre: Demokratian
* Repositorio: <https://bitbucket.org/csalgadow/demokratian_votaciones>
* Web: <http://demokratian.org/>

## Vulnerabilidades

Bien, aquÃ­ estÃ¡n dos los vulnerabilidades que encontrÃ© y que fueron reportadas y solucionadas por el desarrollador Carlos Salgado.

### SQL Injection

* URL: basicos\_php/genera\_select.php
* Parametro: id\_provincia
* MÃ©todo: GET
* AutenticaciÃ³n: No requerido.
* Modo: Remoto
* POC: http://example.com/basicos\_php/genera\_select.php?id\_provincia=-1%20union%20all%20select%201,2,3,4,database()
* Parche: <https://bitbucket.org/csalgadow/demokratian_votaciones/commits/b56c48b519fc52efa65404c312ea9bbde320e3fa>

Como podemos ver la vulnerabilidad es bastante grave. Ya que es posible descargar los datos de los votantes.
La vulnerabilidad tiene parche y es posible aplicarlo descargando la versiÃ³n master o aplicando la siguiente modificaciÃ³n en el cÃ³digo:

basicos\_php/genera\_select.php

```
#$id_provincia = fn_filtro($con, $_GET['id_provincia']);
$id_provincia = fn_filtro_numerico($con, $_GET['id_provincia']);

```
### Broken Authentication

* URL: install/install3.php
* AutenticaciÃ³n: No requerido.
* Modo: Remoto
* POC: http://example.com/install/install3.php
* Parche: <https://bitbucket.org/csalgadow/demokratian_votaciones/commits/0d073ee461edd5f42528d41e00bf0a7b22e86bb3>

Esta vulnerabilidad se debe a que los administradores de sistemas se dejan el fichero despuÃ©s de la instalaciÃ³n y es posible hacer un usuario con rol de administrador de forma transparente y ganando control total sobre la aplicaciÃ³n.
En las nuevas versiones este fichero es borrado una vez se ha instalada la aplicaciÃ³n.

* [Archivos](https://alquimistadesistemas.com/archives.html)
* [Categorias](https://alquimistadesistemas.com/categories.html)
* [Tags](https://alquimistadesistemas.com/tags.html)

* [![GitHub](/images/github.png)](https://github.com/jbenages)
* [![Linkedin](/images/linkedin.png)](https://www.linkedin.com/in/jbenages/)
* [![RSS](/images/rss.png)](/feeds/all.atom.xml)

* ![Logo de bitcoin](/images/btc.png)1GS6WfypypK8rDhwAuqnHcM4dLrr6uDybk


