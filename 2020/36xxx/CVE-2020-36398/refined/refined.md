- **Root cause of vulnerability**: Insufficient input sanitization when handling user input in the "Send a campaign" feature. Specifically, the application attempts to remove script tags, but fails to properly encode HTML entities.
- **Weaknesses/vulnerabilities present**: Stored Cross-Site Scripting (XSS) vulnerability. The application stores user-provided input without proper sanitization and later renders it in a web page.
- **Impact of exploitation**: An attacker can execute arbitrary JavaScript code in the context of the victim's browser, potentially leading to:
    - Transmitting private data (like cookies or session information) to the attacker.
    - Redirecting the victim to attacker-controlled web content.
    - Performing other malicious actions on the user's machine, under the guise of the vulnerable site.
- **Attack vectors**:
    1. An authenticated attacker logs into the phpList admin panel.
    2. The attacker navigates to the "Send a campaign" feature.
    3. The attacker injects a malicious XSS payload, which includes an `svg/onload` event that executes JavaScript code, into the input fields of the campaign.
    4. The attacker saves the campaign.
    5. When another user views the campaign preview, the stored XSS payload is triggered, and the malicious JavaScript code is executed.
- **Required attacker capabilities/position**: The attacker needs to have an authenticated session with access to the phpList administration panel.