Based on the provided content, here's an analysis of CVE-2020-36388:

**Root Cause:**
The vulnerability stems from the insecure use of the `getimagesize()` PHP function within the `civicrm/CRM/Badge/BAO/Badge.php` file. This function is vulnerable to Phar deserialization attacks when processing user-controlled input.

**Weaknesses/Vulnerabilities:**
- **Phar Deserialization:** The `getimagesize()` function, when provided a path to a specially crafted Phar archive (identified by the `phar://` wrapper), can trigger the deserialization of objects contained within the archive. This can be exploited if an attacker can upload such a file to the server and reference it.
- **Unvalidated User Input:** The `$img` parameter, which is fully controlled by the user, is directly passed to the vulnerable `getimagesize()` function without sanitization.

**Impact of Exploitation:**
- **Remote Code Execution (RCE):** By crafting a malicious Phar archive with PHP objects containing malicious code, an attacker can achieve arbitrary PHP code execution on the server. This could lead to a full compromise of the CiviCRM instance and potentially the underlying CMS (e.g., WordPress).

**Attack Vectors:**
1. **Image Upload:** An attacker must first upload a malicious Phar archive disguised as an image file to the server.
2. **AJAX Request:** The attacker then crafts an AJAX request to the `getImageProp()` function (in `civicrm/CRM/Badge/Page/AJAX.php`), providing the path to the uploaded malicious Phar archive via the `img` parameter. This triggers the vulnerable `getimagesize()` call, leading to Phar deserialization and subsequent code execution.

**Required Attacker Capabilities/Position:**
- **Administrator Access:** While the initial vulnerability is present, an attacker needs to be able to make the crafted AJAX request. The content indicates that achieving this requires a stored XSS in the application, which is made possible by chaining CVE-2020-36389. This ultimately requires luring an authenticated administrator to a malicious page, or having administrative access to the application.
- **Ability to Upload Files:**  The attacker needs to be able to upload files to the server.

**Additional Details:**
- The blog post from SonarSource provides detailed code snippets illustrating the vulnerable code paths.
- The CiviCRM advisory confirms the Phar deserialization vulnerability and its fix in versions 5.24.3 and 5.21.3.
- The blog post also notes that while WordPress environments are vulnerable, some CMS systems like Joomla, which include the "PharExtensionInterceptor" library, would not be affected by the vulnerability.
- The blog post details that the vulnerability can be chained with another vulnerability (CVE-2020-36389) to gain full access to the system.

**In summary,** CVE-2020-36388 is a critical vulnerability allowing for remote code execution via Phar deserialization. Successful exploitation requires an attacker to be able to upload a malicious file and then trigger the vulnerable code by making a crafted request. It is often chained with other vulnerabilities, such as CVE-2020-36389, which grants the attacker admin access via stored XSS.