=== Content from www.wordfence.com_45957c3b_20250119_111421.html ===


![](https://www.wordfence.com/wp-content/uploads/2020/04/widget-import-export-vulnerability.png)

[![](https://secure.gravatar.com/avatar/d46b866dba15e07748d03fe68187c62c?s=80&d=mm&r=g)Wordfence Author](https://www.wordfence.com/blog/author/wfauthor/)

April 15, 2020

# Unpatched High-Severity Vulnerability in Widget Settings Importer/Exporter Plugin

On March 12, 2020, our Threat Intelligence team discovered a stored Cross-Site Scripting (XSS) vulnerability in [Widget Settings Importer/Exporter](https://wordpress.org/plugins/widget-settings-importexport/), a WordPress plugin with over 40,000 installations. This flaw allowed an authenticated attacker with minimal, subscriber-level permissions to import and activate custom widgets containing arbitrary JavaScript into a site with the plugin installed.

We reached out to the plugin vendor the same day, March 12, 2020, but have not yet received a response. On March 20, 2020, we reached out to the WordPress plugin team and sent them the full disclosure of the vulnerability, and after following up with them on April 13, 2020, the plugin has been removed from the WordPress repository. As there is no patch currently available, we highly recommend deactivating and removing this plugin.

Wordfence Premium users received a new firewall rule on March 12, 2020 to protect against exploits targeting these vulnerabilities. Free Wordfence users received this rule on April 11, 2020.

---

**Description**: Authenticated Stored Cross-Site Scripting(XSS)

**Affected Plugin**: Widget Settings Importer/Exporter

**Plugin Slug**: widget-settings-importexport

**Affected Versions**: <=1.5.3

**CVE ID**: Pending

**CVSS Score**: 7.4 (high)

**CVSS Vector**: [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L)

**Fully Patched Version**: N/A

Widget Settings Importer/Exporter is a WordPress plugin that offers the ability to import and export WordPress Widgets – a WordPress feature that adds functionality to a site’s header, sidebars and footer. The plugin registers an AJAX action that is used to perform widget import:

```
add_action( 'wp_ajax_import_widget_data', array( __CLASS__, 'ajax_import_widget_data' ) );
```

As is the case with many similar vulnerabilities, the function called by the AJAX action fails to use capability checks or nonce checks. This means that any authenticated user, regardless of their permissions, can use it to import widgets into the site, including widgets containing malicious JavaScript, which would be executed in the browser of any visitor to the site.

Specifically, the `ajax_import_widget_data` function obtains the widget data to be imported by calling `file_get_contents` on the supplied `import_file` parameter. Most sites are configured with a setting, `allow_url_fopen`, that allows this function to get the contents of a remotely hosted file. This makes it possible for an attacker to import a malicious widget to the site by sending a `$_POST` request to `wp-admin/admin-ajax.php` with the `action` parameter set to `import_widget_data`, the `import_file` parameter set to the URL of a crafted, remotely hosted JSON file, and the `widgets` parameter set to describe the widget to be imported.

If the `clear_current` parameter is set, any currently active widgets on the site would also be removed. If the imported widget contains malicious JavaScript, it could be used to redirect site visitors to malvertising sites, or even to steal an administrator’s session, potentially leading to site takeover.

The vulnerable function:

```
   public static function ajax_import_widget_data() {
       $response = array(
           'what' => 'widget_import_export',
           'action' => 'import_submit'
       );

       $widgets = isset( $_POST['widgets'] ) ? $_POST['widgets'] : false;
       $import_file = isset( $_POST['import_file'] ) ? $_POST['import_file'] : false;

       if( empty($widgets) || empty($import_file) ){
           $response['id'] = new WP_Error('import_widget_data', 'No widget data posted to import');
           $response = new WP_Ajax_Response( $response );
           $response->send();
       }

       $clear_current = isset( $_POST['clear_current'] );

       if ( $clear_current )
           self::clear_widgets();

       $json_data = file_get_contents( $import_file );
       $json_data = json_decode( $json_data, true );
       $sidebar_data = $json_data[0];
       $widget_data = $json_data[1];
       foreach ( $sidebar_data as $title => $sidebar ) {
           $count = count( $sidebar );
           for ( $i = 0; $i < $count; $i++ ) {
               $widget = array( );
               $widget['type'] = trim( substr( $sidebar[$i], 0, strrpos( $sidebar[$i], '-' ) ) );
               $widget['type-index'] = trim( substr( $sidebar[$i], strrpos( $sidebar[$i], '-' ) + 1 ) );
               if ( !isset( $widgets[$widget['type']][$widget['type-index']] ) ) {
                   unset( $sidebar_data[$title][$i] );
               }
           }
           $sidebar_data[$title] = array_values( $sidebar_data[$title] );
       }

       foreach ( $widgets as $widget_title => $widget_value ) {
           foreach ( $widget_value as $widget_key => $widget_value ) {
               $widgets[$widget_title][$widget_key] = $widget_data[$widget_title][$widget_key];
           }
       }

       $sidebar_data = array( array_filter( $sidebar_data ), $widgets );
       $response['id'] = ( self::parse_import_data( $sidebar_data ) ) ? true : new WP_Error( 'widget_import_submit', 'Unknown Error' );

       $response = new WP_Ajax_Response( $response );
       $response->send();
   }
```
### What Should I Do?

It is likely that this plugin will not be patched, so we strongly recommend deactivating and removing this plugin from your site. Plugins with similar functionality, such as [Widget Importer & Exporter](https://wordpress.org/plugins/widget-importer-exporter), are available and should be reasonably safe, though it should be considered best practice to deactivate and remove any plugins that are not actively in use.

### Disclosure Timeline

**March 12, 2020** – Vulnerability initially discovered and analyzed. Firewall rule released for Wordfence Premium users. Initial outreach to plugin vendor.

**March 20, 2020** – We reach out to the WordPress plugins team and provide them with full disclosure.

**April 11, 2020** – Wordfence free users receive firewall rule.

**April 13, 2020** – We follow up with the WordPress plugins team and the plugin is removed from the WordPress repository.

**April 15, 2020** – Vulnerability disclosed after more than 30 days with no response from plugin vendor.

### Conclusion

In today’s post, we detailed a stored Cross-Site Scripting (XSS) vulnerability in the Widget Settings Importer/Exporter WordPress plugin. These flaws have not yet been patched, so we recommend that users deactivate and delete this plugin immediately until a patch is made available. Sites running [Wordfence Premium](https://www.wordfence.com/wordfence-signup/?promo_id=blog20200415&promo_name=get-premium&promo_creative=txt&promo_position=conclusion) have been protected from attacks against this vulnerability since March 12, 2020. Sites running the free version of Wordfence received a firewall rule update on April 11, 2020.

*This article was written by Ramuel Gall, a former Wordfence Senior Security Researcher.*

Search

### Trust Your Site to the Leader in WordPress Security

Wordfence includes an endpoint firewall, malware scanner, robust login security features, live traffic views, and more. Discover why over 5 million WordPress sites put their trust in Wordfence.

[Protect Your Site](/products/pricing/)

**Did you enjoy this post? Share it!**

[*Facebook*](http://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2020%2F04%2Funpatched-high-severity-vulnerability-in-widget-settings-importer-exporter-plugin%2F)
[*Twitter*](https://twitter.com/share?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2020%2F04%2Funpatched-high-severity-vulnerability-in-widget-settings-importer-exporter-plugin%2F&text=Unpatched%20High-Severity%20Vulnerability%20in%20Widget%20Settings%20Importer%2FExporter%20Plugin&via=wordfence)
[*LinkedIn*](https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwww.wordfence.com%2Fblog%2F2020%2F04%2Funpatched-high-severity-vulnerability-in-widget-settings-importer-exporter-plugin%2F)

## Comments

2 Comments

* ![](https://secure.gravatar.com/avatar/2380d265a87614be8e2587bcecff4603?s=96&d=mm&r=g)
  Nicola Fleming
  April 15, 2020
   4:13 pm

  Thankfully my sites aren't affected by this vunerability, but I've been wondering how the firewall rules are rolled out? With the latest free version 7.4.6 being rolled out in February, and now we're in April, are the firewall rules updated automatically without a change in Wordfence version?

+ ![](https://secure.gravatar.com/avatar/59930e186988e5f164c12674f73e6267?s=96&d=mm&r=g)
  Ram Gall
  April 16, 2020
   8:04 am

  Hi Nicola!

  The Wordfence plugin actually fetches Firewall rules directly from our servers without needing to be updated. Sites running the premium version of Wordfence automatically check for and receive updates twice a day, while sites running the free version of Wordfence automatically check for and receive updates once a week. It is also possibly to manually update firewall rules, though sites running the free version of Wordfence will still only receive rules that have been released for more than 30 days. Even with firewall rules in place, the most effective way to keep your site safe is to remove or upgrade vulnerable plugins.

### Breaking WordPress Security Research in your inbox as it happens.

![Example of a news story](/img/footer-news-example.jpg)

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save



=== Content from www.wordfence.com_3f75fc30_20250119_111423.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Widget Settings Importer/Exporter Plugin <= 1.5.3 - Unauthorized Widget Import to Stored Cross-Site Scripting

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Widget Settings Importer/Exporter Plugin <= 1.5.3 - Unauthorized Widget Import to Stored Cross-Site Scripting

7.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L)

| CVE | [CVE-2020-36769](https://www.cve.org/CVERecord?id=CVE-2020-36769) |
| --- | --- |
| CVSS | 7.4 (High) |
| Publicly Published | April 15, 2020 |
| Last Updated | January 22, 2024 |
| Researcher | [Ram - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/ramuel-gall) |

### Description

The Widget Settings Importer/Exporter Plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the wp\_ajax\_import\_widget\_dataparameter AJAX action in versions up to, and including, 1.5.3 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers with subscriber-level permissions and above to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [www.wordfence.com](https://www.wordfence.com/blog/2020/04/unpatched-high-severity-vulnerability-in-widget-settings-importer-exporter-plugin/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwidget-settings-importexport%2Fwidget-settings-importerexporter-plugin-153-unauthorized-widget-import-to-stored-cross-site-scripting&t=Widget%20Settings%20Importer%2FExporter%20Plugin%20%3C%3D%201.5.3%20-%20Unauthorized%20Widget%20Import%20to%20Stored%20Cross-Site%20Scripting "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwidget-settings-importexport%2Fwidget-settings-importerexporter-plugin-153-unauthorized-widget-import-to-stored-cross-site-scripting&text=Widget%20Settings%20Importer%2FExporter%20Plugin%20%3C%3D%201.5.3%20-%20Unauthorized%20Widget%20Import%20to%20Stored%20Cross-Site%20Scripting "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwidget-settings-importexport%2Fwidget-settings-importerexporter-plugin-153-unauthorized-widget-import-to-stored-cross-site-scripting "LinkedIn")
Email

## Vulnerability Details for Widget Settings Importer/Exporter

#### [Widget Settings Importer/Exporter](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/widget-settings-importexport)

| Software Type | Plugin |
| --- | --- |
| Software Slug | widget-settings-importexport [(view on wordpress.org)](https://wordpress.org/plugins/widget-settings-importexport) |
| Patched? | No |
| Remediation | No known patch available. Please review the vulnerability's details in depth and employ mitigations based on your organization's risk tolerance. It may be best to uninstall the affected software and find a replacement. |
| Affected Version | * <= 1.5.3 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


