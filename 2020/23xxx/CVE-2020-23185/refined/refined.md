- **Root cause of vulnerability**: Insufficient sanitization of user input in the "security" feature. Specifically, the application attempts to remove script tags but fails to prevent XSS via HTML event handlers.
- **Weaknesses/vulnerabilities present**: Stored Cross-Site Scripting (XSS) vulnerability. The application does not properly HTML entity encode user-supplied data before rendering it on the page.
- **Impact of exploitation**: An attacker can execute malicious JavaScript code in the context of the vulnerable web application. This can lead to:
    - Transmitting private data (cookies, session information) to the attacker.
    - Redirecting the victim to attacker-controlled content.
    - Performing other malicious actions on the user's machine.
- **Attack vectors**:
    - An authenticated user navigates to the security settings page.
    - The attacker injects an XSS payload, such as `<svg/onload=alert(/XSS/)//`, into a form field.
    - The injected payload is stored in the database.
    - The payload is rendered when viewing the page, triggering the XSS.
- **Required attacker capabilities/position**:
    - Authenticated access to the administration panel of the PHP-Fusion application.
    - Ability to navigate to the security settings page.
    - Ability to input and save data in the application's form fields.