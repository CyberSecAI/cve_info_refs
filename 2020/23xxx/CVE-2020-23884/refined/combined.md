=== Content from github.com_aaebcc63_20250119_125741.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnomacs%2Fnomacs%2Fissues%2F516)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnomacs%2Fnomacs%2Fissues%2F516)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=nomacs%2Fnomacs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nomacs](/nomacs)
/
**[nomacs](/nomacs/nomacs)**
Public

* [Notifications](/login?return_to=%2Fnomacs%2Fnomacs) You must be signed in to change notification settings
* [Fork
  158](/login?return_to=%2Fnomacs%2Fnomacs)
* [Star
   2.1k](/login?return_to=%2Fnomacs%2Fnomacs)

* [Code](/nomacs/nomacs)
* [Issues
  383](/nomacs/nomacs/issues)
* [Pull requests
  9](/nomacs/nomacs/pulls)
* [Discussions](/nomacs/nomacs/discussions)
* [Actions](/nomacs/nomacs/actions)
* [Projects
  0](/nomacs/nomacs/projects)
* [Wiki](/nomacs/nomacs/wiki)
* [Security](/nomacs/nomacs/security)
* [Insights](/nomacs/nomacs/pulse)

Additional navigation options

* [Code](/nomacs/nomacs)
* [Issues](/nomacs/nomacs/issues)
* [Pull requests](/nomacs/nomacs/pulls)
* [Discussions](/nomacs/nomacs/discussions)
* [Actions](/nomacs/nomacs/actions)
* [Projects](/nomacs/nomacs/projects)
* [Wiki](/nomacs/nomacs/wiki)
* [Security](/nomacs/nomacs/security)
* [Insights](/nomacs/nomacs/pulse)

# Open a malformed mng format file, buffer overflow and memory corruption will occur. #516

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Open a malformed mng format file, buffer overflow and memory corruption will occur.](#top)#516Copy link![@Aurorainfinity](https://avatars.githubusercontent.com/u/67816264?u=5702236735002755de231ed7de43a478e92c5a58&v=4&size=80)
## Description

![@Aurorainfinity](https://avatars.githubusercontent.com/u/67816264?u=5702236735002755de231ed7de43a478e92c5a58&v=4&size=48)[Aurorainfinity](https://github.com/Aurorainfinity)opened [on Jul 9, 2020](https://github.com/nomacs/nomacs/issues/516#issue-653986822)

Two issues were found in nomacs in all versions. nomacs does not handle the mng file format very well. When nomacs opens a carefully constructed mng file, nomacs will have a buffer overflow and crash

# 1. buffer overflow

++++++++++++++++++++++++++++++++++++++++++++

(71c.f7c): Access violation - code c0000005 (first chance)

First chance exceptions are reported before any exception handling.

This exception may be expected and handled.

eax=00000000 ebx=00000000 ecx=3ffffc38 edx=045d0000 esi=0425fd80 edi=205d1000

eip=6edc103b esp=03a7f130 ebp=00000000 iopl=0 nv up ei pl nz na pe nc

cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00010206

\*\*\* ERROR: Symbol file could not be found. Defaulted to export symbols for C:\Users\test\Desktop\nomacs-2.4.6-x86-WinXP\imageformats\qmng4.dll -

qmng4+0x2103b:

6edc103b f3ab rep stos dword ptr es:[edi]

0:011> !exploitable -v

!exploitable 1.6.0.0

HostMachine\HostUser

Executing Processor Architecture is x86

Debuggee is in User Mode

Debuggee is a live user mode debugging session on the local machine

Event Type: Exception

Exception Faulting Address: 0x205d1000

First Chance Exception Type: STATUS\_ACCESS\_VIOLATION (0xC0000005)

Exception Sub-Type: Write Access Violation

Faulting Instruction:6edc103b rep stos dword ptr es:[edi]

Exception Hash (Major/Minor): 0x8c7435c8.0xf37f4977

Hash Usage : Stack Trace:

Major+Minor : qmng4+0x2103b

Instruction Address: 0x000000006edc103b

Description: User Mode Write AV

Short Description: WriteAV

Exploitability Classification: EXPLOITABLE

Recommended Bug Title: Exploitable - User Mode Write AV starting at qmng4+0x000000000002103b (Hash=0x8c7435c8.0xf37f4977)

User mode write access violations that are not near NULL are exploitable.

++++++++++++++++++++++++++++++++++++++++++++

# 2. memory corruption

---

(340.62c): Access violation - code c0000005 (first chance)

First chance exceptions are reported before any exception handling.

This exception may be expected and handled.

eax=0459e8e1 ebx=00000000 ecx=00000000 edx=00000000 esi=00000000 edi=00000000

eip=6edbd435 esp=03aef3c4 ebp=04592a58 iopl=0 nv up ei ng nz na po cy

cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00010283

\*\*\* ERROR: Symbol file could not be found. Defaulted to export symbols for C:\Users\test\Desktop\nomacs-2.4.6-x86-WinXP\imageformats\qmng4.dll -

qmng4+0x1d435:

6edbd435 880e mov byte ptr [esi],cl ds:0023:00000000=??

0:009> !exploitable -v

!exploitable 1.6.0.0

HostMachine\HostUser

Executing Processor Architecture is x86

Debuggee is in User Mode

Debuggee is a live user mode debugging session on the local machine

Event Type: Exception

Exception Faulting Address: 0x0

First Chance Exception Type: STATUS\_ACCESS\_VIOLATION (0xC0000005)

Exception Sub-Type: Write Access Violation

Faulting Instruction:6edbd435 mov byte ptr [esi],cl

Basic Block:

6edbd435 mov byte ptr [esi],cl

Tainted Input operands: 'cl','esi'

6edbd437 movzx ecx,byte ptr [eax]

6edbd43a mov byte ptr [esi+1],cl

6edbd43d movzx ecx,byte ptr [eax-1]

6edbd441 mov byte ptr [esi+2],cl

6edbd444 movzx ecx,byte ptr [eax+2]

6edbd448 mov byte ptr [esi+3],cl

6edbd44b mov ecx,dword ptr [ebp+248h]

6edbd451 add edx,ecx

6edbd453 add eax,4

6edbd456 lea esi,[esi+ecx\*4]

6edbd459 cmp edx,dword ptr [ebp+294h]

6edbd45f jl qmng4+0x1d431 (6edbd431)

Exception Hash (Major/Minor): 0xebb32a1e.0x41bed88a

Hash Usage : Stack Trace:

Major+Minor : qmng4+0x1d435

Major+Minor : qmng4+0x106d

Instruction Address: 0x000000006edbd435

Description: User Mode Write AV near NULL

Short Description: WriteAVNearNull

Exploitability Classification: UNKNOWN

Recommended Bug Title: User Mode Write AV near NULL starting at qmng4+0x000000000001d435

(Hash=0xebb32a1e.0x41bed88a)

User mode write access violations that are near NULL are unknown.

---

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from nomacs.org_4e88d8cc_20250119_125741.html ===


[nomacs](https://nomacs.org)

* [Matrix](https://matrix.to/#/#nomacs:matrix.org)
* [GitHub](https://github.com/nomacs/nomacs)

* [Docs](https://nomacs.org/docs/getting-started/introduction/)
* [Blog](https://nomacs.org/blog/)

# nomacs - Image Lounge

nomacs is a free, open source image viewer, which supports multiple platforms. You can use it for viewing all common image formats including RAW and psd images.

[Get started](https://nomacs.org/docs/getting-started/introduction)

GNU General Public License v3.0. [GitHub v3.16](https://github.com/nomacs/nomacs)

## Image viewing

Supports the most common image formats including RAW. [Learn more →](/docs/documentation/features)

## Image editing

Supports cropping, resizing, rotating, and color adjustments, and more.

## Viewer synchronization

The same action (like panning, zooming, etc.) can be performed on multiple viewers, making comparing two images easy.

* Powered by [Zola](https://www.getzola.org/) and [AdiDoks](https://github.com/aaranxu/adidoks)

* [Code of Conduct](https://nomacs.org/docs/contributing/code-of-conduct/)


