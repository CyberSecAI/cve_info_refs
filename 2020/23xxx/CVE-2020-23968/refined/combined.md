=== Content from ricardojba.github.io_79701575_20250119_131002.html ===

CVE-2020-23968 ILEX International Sign&go 7.1 Arbitrary File Creation Privilege Escalation | vibrio's personal infosec blog

[Home](/)
[About](/about/)

[Github](https://github.com/ricardojba)
[LinkedIn](https://www.linkedin.com/in/ricardojbalmeida/)
[Subscribe](/feed.xml)

vibrio@work

# [CVE-2020-23968 ILEX International Sign&go 7.1 Arbitrary File Creation Privilege Escalation](/CVE-2020-23968-ILEX-SignGo-EoP/)

November 10, 2020

**Product:** ILEX International Sign&go 7.1.2 build 201804160953

ILEX International Sign&go is a modular global SSO solution from ILEX International. It offers Strong Authentication, Web Access Management, Mobile Access Management, Identity Federation functionalities through common architecture and administration.

**Type:** Local Privilege Escalation

**Summary:** Due to over permissive access rights on a logging directory, the ILEX International Sign&Go software can be abused to perform privileged file operations, such as arbitrary file creation. This can be exploited, e.g. via DLL hijacking on the privileged Sign&Go process, to obtain SYSTEM privileges on the local machine. This vulnerability was patched in recent versions and users should update to the latest version.

# Introduction

When conducting audits on Windows laptops, I usually test for common privilege escalation techniques, namely using Procmon (from Sysinternals), to analyse the behaviour of installed non-system applications.

While doing a recent assessment I was looking at the Procmon output and noticed the Sign&go process writing to a log file inside the `C:\ProgramData` directory:

![](/assets/posts/2020-11-10-CVE-2020-23968-ILEX-SignGo-EoP/z_procmon_1.PNG)

I also noticed there were a lot of DLL hijacking opportunities that could be used for persistence:

![](/assets/posts/2020-11-10-CVE-2020-23968-ILEX-SignGo-EoP/z_procmon_2.PNG)

The above process was actually a service, setup to automatically start at boot, and running as ‘SYSTEM’:

![](/assets/posts/2020-11-10-CVE-2020-23968-ILEX-SignGo-EoP/z_service_1.PNG)

![](/assets/posts/2020-11-10-CVE-2020-23968-ILEX-SignGo-EoP/z_service_2.PNG)

![](/assets/posts/2020-11-10-CVE-2020-23968-ILEX-SignGo-EoP/z_service_3.PNG)

![](/assets/posts/2020-11-10-CVE-2020-23968-ILEX-SignGo-EoP/z_service_4.PNG)

The service binary is located at `C:\Program Files\Sign and go 7.1 Workstation Security Suite\sngWSService.exe`:

![](/assets/posts/2020-11-10-CVE-2020-23968-ILEX-SignGo-EoP/z_path_2.PNG)

It’s also digitally signed:

![](/assets/posts/2020-11-10-CVE-2020-23968-ILEX-SignGo-EoP/z_binary_1.PNG)

![](/assets/posts/2020-11-10-CVE-2020-23968-ILEX-SignGo-EoP/z_binary_2.PNG)

![](/assets/posts/2020-11-10-CVE-2020-23968-ILEX-SignGo-EoP/z_binary_3.PNG)

# Permissive directory access rights

Checking the permissions of the `C:\ProgramData\Ilex\S&G\Logs` directory, it was possible to see that it was inheriting the permissions from `C:\ProgramData`:

![](/assets/posts/2020-11-10-CVE-2020-23968-ILEX-SignGo-EoP/z_perms_1.PNG)

![](/assets/posts/2020-11-10-CVE-2020-23968-ILEX-SignGo-EoP/z_perms_2.PNG)

So as a regular user or in an enterprise environment, an Authenticated User will have Read and Write permissions on the `C:\ProgramData\Ilex\S&G\Logs` directory.

# Vulnerability Analysis

We have a Windows service running as ‘SYSTEM’, performing operations on user-controlled files and directories without impersonation.

All the conditions are gathered to use one of the several techniques to abuse Windows filesystem features, that James Forshaw developed and also released as the [Symbolic Link Testing Toolkit](https://github.com/googleprojectzero/symboliclink-testing-tools), for researchers to use as Proof-of-Concept.

In this case, I will use Object Manager Symbolic Links to exploit the vulnerability, since unprivileged users can create symbolic links in the Windows Object Manager, in order to escalate privileges to SYSTEM. As an unprivileged user we can chain a mount point that resolves to the `\RPC Control\` directory with an Object Manager Symbolic Link in that directory.

![](/assets/posts/2020-11-10-CVE-2020-23968-ILEX-SignGo-EoP/object_manager_symbolic_links.PNG)

@[*Abusing privileged file operations (Provadys) - TROOPERS 2019*](https://troopers.de/downloads/troopers19/TROOPERS19_AD_Abusing_privileged_file_operations.pdf)

# Exploit Chain

To exploit the vulnerability, we will need to:

1. Delete all files in `C:\ProgramData\Ilex\S&G\Logs`
2. Create a pseudo-symlink named `C:\ProgramData\Ilex\S&G\Logs\000-sngWSService1.log` that points to `C:\Windows\System32\pwned.dll` - note that the service can write to `000-sngWSService[1-2].log`, so when exploiting the vulnerability, first check what file is being used by the service.
3. A regular user is not allowed to restart the service in order to force a file write operation, however, if the computer loses network connectivity the service will start writing error messages on the log file. So this third step can either be disconnecting the computer from the network or just wait it out (it can take a long time or be in a few minutes, so YMMV).

The steps above will use the symlink technique to divert the file write operation on the log file to an arbitrary file with an attacker-chosen name.

![](/assets/posts/2020-11-10-CVE-2020-23968-ILEX-SignGo-EoP/exploit_symlink.PNG)

@[*Abusing privileged file operations (Provadys) - TROOPERS 2019*](https://troopers.de/downloads/troopers19/TROOPERS19_AD_Abusing_privileged_file_operations.pdf)

# Exploit

I have written a Proof-of-Concept in Powershell and C++ and the code can be found [here](https://github.com/ricardojba/CVE-2020-23968-ILEX-SignGo-EoP).

The powershell exploit will drop on disk two binaries from the Symbolic Link Testing Toolkit (CreateSymlink.exe and DeleteMountPoint.exe) and a [reverse shell in DLL format](https://github.com/Hood3dRob1n/Y.A.S.P./blob/master/payloads/reverse-dll/reverse_dll.c), so it’s not very OPSEC safe.

To compile the C++ exploit, it’s necessary to link it with the [Symbolic Link Testing Toolkit](https://github.com/googleprojectzero/symboliclink-testing-tools).

Powershell Exploit Execution:

![](/assets/posts/2020-11-10-CVE-2020-23968-ILEX-SignGo-EoP/z_exploitexec_1.PNG)

# Timeline

* 2020-07-08: CVE request sent to MITRE.
* 2020-07-13: Ticket opened with the vendor that included the vulnerability details.
* 2020-07-16: Ticket status feedback request.
* 2020-07-22: Ticket status feedback request.
* 2020-08-05: Ticket status feedback request.
* 2020-08-12: Ticket status feedback request.
* 2020-08-17: Answer from ILEX requesting some details.
* 2020-08-17: Feedback given to ILEX.
* 2020-08-18: ILEX accepted and confirmed the vulnerability.
* 2020-09-10: ILEX contacted again via LinkedIn.
* 2020-09-15: ILEX meeting to give further details.
* 2020-09-28: Patch released.
* 2020-11-10: Publication of this advisory.
* 2020-11-10: MITRE assignment of CVE-2020-23968.



=== Content from signgo.com_2c906fe0_20250119_111336.html ===


[![Sign Making Software SignGo](/images/logo2.png)](/index.php "Sign Making Software SignGo")

* [Home](/)
* [Products](/products)
  + [SignGo Pro](/products/signgo-pro)
  + [SignGo Lite](/products/signgo-lite)
  + [Compare](/products/compare)
  + [Supported Cutters](/products/supported-cutters)
  + [Feature Tour](/products/feature-tour)
* Support
  + [Driver Request](/support/driver-request)
  + [Tutorials](/support/signgo-tutorials)
* [FAQs](/faqs)
* [Download](/downloads)
* [Newsletter](/newsletter)
* [Contact](/contact)
  + [Contact Us](/contact/contact-us)

![SignGo Home Banner](http://signgo.com/images/banners/banner-signgo-2.png)

# Introducing SignGo

SignGo is cutting software for Windows. You design or import graphics for cutting on a plotter or for printing. You can also cut around printed graphics to create stickers or decals. SignGo works only on **Windows** computers. There is a [**Lite**](/products/signgo-lite) version and a [**Pro**](/products/signgo-pro) version with extra features (see a comparison **[here](/products/compare)**). It's **free to use for 30 days** so go ahead and **[give it a try](/component/judownload/?view=category&id=4&Itemid=139)**.

[![SignGo Screen](/images/signgo-home01.png)](https://www.youtube.com/playlist?list=PLhSNmbQHLDGgrcX41h3v5kFI9ZdcGDD2E)

SignGo is great for making signs by cutting vinyl from rolls or sheets. However you can do much more than that. For example heat transfer graphics for T-shirt, textile and promotional goods, decals, paint masks, glass frosting and decorative etching templates, craft stencils, sandblast stencils, stickers, automotive window tint, paint protection and so on...

SignGo is easy to use and versatile, helping you turn your ideas into reality.

Create and cut lettering at any size using Truetype, Opentype and Type 1 fonts installed on your system. If your cutter is too small for the job no problem, SignGo will automatically tile it for you.

## Some uses for SignGo

![Vinyl Lettering](/images/icons/icon-lettering.png) Vinyl Lettering

![T-shirt Graphics](/images/icons/icon-tshirt.png) T-shirt and textile graphics

![Promotional Items](/images/icons/icon-promotional.png) Promotional items such as mugs, mats, key fobs, phone covers and much more!

![Craft Stencils](/images/icons/icon-craft.png) Craft stencils - import or create your own beautiful designs from scratch

![Paint Stencils](/images/icons/icon-paint-stencil.png) Paint stencils - for all kinds of hobbyist uses around the home and for the packaging and automotive industries

![Sandblast Stencils](/images/icons/icon-sandblast-stencil.png) Sandblast stencils - for stonemasonry, construction and others

![Decorative Glass](/images/icons/icon-dec-glass.png) Decorative Glass - cut privacy films and beautiful masks for glass etching and frosting

![Stickers](/images/icons/icon-stickers.png) Decals and stickers - cut around printed graphics for work or fun!

![icon plotter](/images/icons/icon-plotter.png) Over 500 cutter plotters supported | **[Show Me](/products/supported-cutters)** | **[Request a Driver](/support/driver-request?form_id=2&show_form_title=1&show_form_description=1)** |

## Text Editor

Enter and edit text directly into the layout. Individual characters and words can be selected and manipulated in the same way as a word processing package. Font styles, size, spacing, baseline shift and slant angle are all easily adjusted on screen. Automatic kerning is complemented by the ability to create and save custom kerning pairs for any font on your system. Placing text along a curve or around a shape is as easy as clicking a mouse button and you can even create and edit your own fonts.

## Node Editing

Powerful editing tools give you total control over outlines. Individual lines, curves and nodes can be manipulated to any degree for perfect results.

## Welding

Fully comprehensive welding tools allow you to merge, subtract and intersect multiple objects.

## Advanced Cutting Features

A wealth of features are included to make vinyl sign production a breeze. Colour separation, flexible tiling, weed borders, multiple copies, data spooling, rotation and resize to name but a few.

## Direct Scanning (Pro version)

The built-in interface means you can easily retrieve images from TWAIN sources such as scanners and digital cameras. TWAIN Twain is an industry standard for communications with scanners and other forms of picture input devices. Some digital cameras also use the TWAIN interface to allow images to be loaded directly into the program.

## Image Tracing (Pro version)

You can easily convert (trace) bitmap images to high quality outlines suitable for cutting. You can convert black and white (line-art), greyscale and even colour images.

## Shadows (Pro version)

Every conceivable shadow effect is available through a simple toolbar. Automatic welding produces cuttable outlines every time, without overlapping lines. Offsets and surrounds are easily defined and you can decide whether you want your shadow effect to butt join or overlay.

## Distortions (Pro version)

Choose from perspective, envelope and sphere effects to create any kind of distortion. You can even apply distortions to bitmap images.

## Gradient Fills (Pro version)

Create colourful graduated fills using "drag and drop" colouring. You can add as many colours as you wish as well as control the position and angle of the effect.

## Texture Fills (Pro version)

Use any bitmap image to create a texture. total control of the size, shape and angle of the texture is offered via a simple graphical control.

## Transparent Fills (Pro version)

Transparency values can be given to any object (including bitmaps) allowing objects beneath to "show through". You can also apply graduated and shaped transparent fills. Combine transparent fills with gradient fills for endless possibilities and you can even apply transparent textures.

## Advanced Cutting Features

A wealth of features are included to make vinyl sign production a breeze. Colour separation, flexible tiling, weed borders, multiple copies, data spooling, rotation and resize to name but a few.

## Print and Cut (Pro version)

The "cut around" attribute is used to define cutting contours for printer/cutter devices. It is also used for calibrating a printed graphic for contour cutting on a separate cutting plotter.

**[System requirements](/products/41-signgo-system-requirements)**

### Watch SignGo

[![SignGo Video](/images/video.png)](https://www.youtube.com/playlist?list=PLhSNmbQHLDGgrcX41h3v5kFI9ZdcGDD2E)

### Download Now

# Free 30 Day Trial

[Download SignGo](/downloads)

* [Privacy Policy](/privacy-policy)
* [Contact Us](/contact-us)
* [Mailing List](/mailing-list)

© 2019 Wissen UK Inc. Ltd.

[Go to top](/#top)


=== Content from ricardojba.github.io_024a602f_20250119_111337.html ===

CVE-Pending ILEX International Sign&go 7.1 Arbitrary File Creation Privilege Escalation | vibrio's personal infosec blog

[Home](/)
[About](/about/)

[Github](https://github.com/ricardojba)
[LinkedIn](https://www.linkedin.com/in/ricardojbalmeida/)
[Subscribe](/feed.xml)

vibrio@work

# [CVE-Pending ILEX International Sign&go 7.1 Arbitrary File Creation Privilege Escalation](/CVE-Pending-ILEX-SignGo-EoP/)

November 09, 2020

Correct URL: <https://ricardojba.github.io/CVE-2020-23968-ILEX-SignGo-EoP/>


