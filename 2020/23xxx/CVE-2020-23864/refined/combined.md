=== Content from daniels-it-blog.blogspot.com_f8e54a32_20250119_120244.html ===

[Skip to main content](#main)

Search

### Search This Blog

# [Another IT Security Blog](http://daniels-it-blog.blogspot.com/)

IT Security, Hacking and More

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[July 18, 2020](http://daniels-it-blog.blogspot.com/2020/07/iobit-malware-fighter-arbitrary-code.html "permanent link")

### IOBit Malware Fighter - Arbitrary Code Execution as NT Authority\System

**Product:** IOBit Malware Fighter**Version:** 8.0.2.547**Tested on:** Windows 10 Pro 2004 x64**Vendor informed:** No**PoC:** This blog post**CVE:** Requested
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg1Clqgi1rK7JXSHeynHPeApJteinnmSzgXhAwlgeXY7eHkVKEpgsFSSQl8ggq26xexuJg05Hh-PYQssTncyGDzwlbP6GVa38bVbY3rAa4y5rLJCDOEMhvDV4AD5Iaa_CGcrOsOEHK7a-U/w625-h395/2020-07-18+22_07_48-.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg1Clqgi1rK7JXSHeynHPeApJteinnmSzgXhAwlgeXY7eHkVKEpgsFSSQl8ggq26xexuJg05Hh-PYQssTncyGDzwlbP6GVa38bVbY3rAa4y5rLJCDOEMhvDV4AD5Iaa_CGcrOsOEHK7a-U/s1406/2020-07-18%2B22_07_48-.png)

**Short Description:** A local attacker can use IOBit Malware Fighter to arbitrary execute code as NT Authority\System by placing a .dll file.
**Vulnerability Description:** IOBit Malware Fighter uses a service called "IMF Service" running as NT Authority\System.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEji2_pYONsIVOcdotlRwmohffSa1e8E3QFtesbfRXcGaHdqzyNQsHF0_SR7uYetsj0ibEwm-EhZ2SDLyWFxuKm6oCSDY8xzrtF2OnYsyvG6WG2BKYMEA3iUChZax1zKn7tAIxUkWoAIyyE/w625-h329/2020-07-18+21_04_08-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEji2_pYONsIVOcdotlRwmohffSa1e8E3QFtesbfRXcGaHdqzyNQsHF0_SR7uYetsj0ibEwm-EhZ2SDLyWFxuKm6oCSDY8xzrtF2OnYsyvG6WG2BKYMEA3iUChZax1zKn7tAIxUkWoAIyyE/s756/2020-07-18%2B21_04_08-Window.png)
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhx5CBSM_piBaz86yPQj0-RC1xQCu8xZo43s7N1YHUp08wmeovLxx37k79Tew13y9Jq_koL2h8FJtIGX_hH7-4QOBY1xqCUgwKgQVE3Sj_Y-KD4Wf62r3fowzEe2eLGYLdu97KxiVQkqRc/w533-h625/2020-07-18+21_02_21-Window.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhx5CBSM_piBaz86yPQj0-RC1xQCu8xZo43s7N1YHUp08wmeovLxx37k79Tew13y9Jq_koL2h8FJtIGX_hH7-4QOBY1xqCUgwKgQVE3Sj_Y-KD4Wf62r3fowzEe2eLGYLdu97KxiVQkqRc/s566/2020-07-18%2B21_02_21-Window.png)

This service also spawn other Malware Fighter Processes (sub processes are "only" running elevated with high integrity).
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgDIvk8del6fcJpnepW6x35CM_TrAkdnHGGG_eNrmvDU7RoU_EsKboq6UzhnJ-2MhDw2lbQWm9-cfDBQ6BMd8kxU9JWkWQ4z5BSQTqGG-rI3ATyHTCh-PxxL1hbWhT71R9DIubQOaLzYqI/w781-h106/2020-07-18+21_20_47-Process+Explorer+-+Sysinternals_+www.sysinternals.com+%255BTESTVM_user%255D+%2528Administrat.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgDIvk8del6fcJpnepW6x35CM_TrAkdnHGGG_eNrmvDU7RoU_EsKboq6UzhnJ-2MhDw2lbQWm9-cfDBQ6BMd8kxU9JWkWQ4z5BSQTqGG-rI3ATyHTCh-PxxL1hbWhT71R9DIubQOaLzYqI/s1063/2020-07-18%2B21_20_47-Process%2BExplorer%2B-%2BSysinternals_%2Bwww.sysinternals.com%2B%255BTESTVM_user%255D%2B%2528Administrat.png)

To run code as NT Authority\System the attacker acts as following:
First the attacker drops a malicious dll file into "C:\Users\user\AppData\Local\Microsoft\WindowsApps" called "Register.dll".
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgBdjmsy1rQwHTkeG1dis4EAlg9qI8Y8irIjhMxeHaz5thqol4NFz0rZ5wgIuowiQhNb_UjZt5e2FuS6YEscJIiDeq4bEuXmnMh7dx_BEIAWrL1mr2clJaS9RUblhfO1mTm97I0BAHaY4I/w781-h126/2020-07-18+21_44_57-Windows+PowerShell.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgBdjmsy1rQwHTkeG1dis4EAlg9qI8Y8irIjhMxeHaz5thqol4NFz0rZ5wgIuowiQhNb_UjZt5e2FuS6YEscJIiDeq4bEuXmnMh7dx_BEIAWrL1mr2clJaS9RUblhfO1mTm97I0BAHaY4I/s979/2020-07-18%2B21_44_57-Windows%2BPowerShell.png)

This file is executed when IOBit Malware Fighter is launched or the user opens Malware Fighter GUI with high integrity (admin rights).
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgxFxFhcHtVfChBzoacfP9L9Z5Ya4XF84A9rEBGhVy2NPDxU4-4jcy0dUEhXQqbzamPbL5G20BeWjVBNCdQ590LTiOVMsxOCgbu7NkWrObKhPXmMdzCdZoRzuhmZ5db0gSUkA7oT0nK0IE/w781-h104/2020-07-18+21_46_42-Process+Explorer+-+Sysinternals_+www.sysinternals.com+%255BTESTVM_user%255D+%2528Administrat.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgxFxFhcHtVfChBzoacfP9L9Z5Ya4XF84A9rEBGhVy2NPDxU4-4jcy0dUEhXQqbzamPbL5G20BeWjVBNCdQ590LTiOVMsxOCgbu7NkWrObKhPXmMdzCdZoRzuhmZ5db0gSUkA7oT0nK0IE/s1009/2020-07-18%2B21_46_42-Process%2BExplorer%2B-%2BSysinternals_%2Bwww.sysinternals.com%2B%255BTESTVM_user%255D%2B%2528Administrat.png)

Once the code runs with high integrity the same dll (evil.dll) will be copied to "C:\Program Files (x86)\IObit\IObit Malware Fighter" and called "version.dll"
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi5LcrGuzpEZDmILLnYzZvr_jzh5NAwAqNm7mxgnupQk8ZkudgGXQT64Y0yh-iqvNNw_HB3GplT4J4nrssn6fQ2DAexNsp9_HxriSoh9a3JipNPklo3CAsKIHSPHmy-gTVfdnZYAGES6TY/w625-h438/2020-07-18+21_52_40-IObit+Malware+Fighter.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi5LcrGuzpEZDmILLnYzZvr_jzh5NAwAqNm7mxgnupQk8ZkudgGXQT64Y0yh-iqvNNw_HB3GplT4J4nrssn6fQ2DAexNsp9_HxriSoh9a3JipNPklo3CAsKIHSPHmy-gTVfdnZYAGES6TY/s884/2020-07-18%2B21_52_40-IObit%2BMalware%2BFighter.png)

With high integrity (admin rights) it is possible to reboot the system. Once the system is rebooted "version.dll" will be loaded by "IMFsrv.exe" as NT Authority\System:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjoTPwg-HdUjOc6R5Hd5PQSSevIDD2w8LdOg8mrT0S6RLLxO82kcQECcs6xx1qStNl6q6MjMH1tOJFV1Ng8KGSBeD4sw9d-cTnToXXkq3KkDT2dx5fMqY4DosPTFKFoKSdGcPb6wQaSpaI/w625-h83/2020-07-18+21_56_14-Process+Explorer+-+Sysinternals_+www.sysinternals.com+%255BTESTVM_user%255D+%2528Administrat.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjoTPwg-HdUjOc6R5Hd5PQSSevIDD2w8LdOg8mrT0S6RLLxO82kcQECcs6xx1qStNl6q6MjMH1tOJFV1Ng8KGSBeD4sw9d-cTnToXXkq3KkDT2dx5fMqY4DosPTFKFoKSdGcPb6wQaSpaI/s1021/2020-07-18%2B21_56_14-Process%2BExplorer%2B-%2BSysinternals_%2Bwww.sysinternals.com%2B%255BTESTVM_user%255D%2B%2528Administrat.png)

**Conclusion:** I don´t know why IOBit Malware Fighter loads dll files from user locations or  doesn´t validate files before loading or protects it´s installation folder...Classical dll hijacking and privilege escalation

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Popular Posts

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhOxu8ebE1R6863Whvsj3YgoAO8YGHDoRHt38_d4FyZ4VPhEJGSESmvLzf8UisJ2ojENVJaEytbQYtx6DFZ-KK8pfjvxS92cKISOL6iCK4GJdjwUAP7W0hyphenhyphen7WJ61Md-CMKWJ2DQ7VIGM80/w625-h368/2020-07-02+18_39_31-Window.png)](http://daniels-it-blog.blogspot.com/2020/07/gog-galaxy-escalation-of-privileges.html)

[July 02, 2020](http://daniels-it-blog.blogspot.com/2020/07/gog-galaxy-escalation-of-privileges.html "permanent link")

### [GOG Galaxy - Escalation of Privileges incl. Code Execution](http://daniels-it-blog.blogspot.com/2020/07/gog-galaxy-escalation-of-privileges.html)

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[![Image](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0STecxFl9XczUVcqwLC2XB1MqaIJP6NhsLSrwr1QnG-8K2C_b1t8qywi1Q4nMx03gLu_Y1ou8Ocd4rg50c1QgIciMFI7xG4npnOhAzHMGWaBgjyWM_RXUgJTFDJyW4OPrYhyphenhyphen7iMnJ8ck/w625-h319/2020-07-02+13_42_45-Windows+PowerShell.png)](http://daniels-it-blog.blogspot.com/2020/07/steam-arbitrary-code-execution-part-2.html)

[July 02, 2020](http://daniels-it-blog.blogspot.com/2020/07/steam-arbitrary-code-execution-part-2.html "permanent link")

### [Steam - Escalation of Privileges](http://daniels-it-blog.blogspot.com/2020/07/steam-arbitrary-code-execution-part-2.html)

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[Powered by Blogger](https://www.blogger.com)

Theme images by [enot-poloskun](http://www.istockphoto.com/portfolio/enot-poloskun?platform=blogger)

[![My photo](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgeK_SG7N7IIvgs2eb-q-Pc3uN8LN78oNxZfiQPKL-1UMy130NvDDcqkSP30jV1cJZrW-uDPcglrt4RM_sfX9rEzO-909OEtkljjuGpnJLMzvAO9kVfUbLsvJDA0dS8/s113/anonymous.jpg)](https://www.blogger.com/profile/12332761312556315624)
[Daniel Gebert](https://www.blogger.com/profile/12332761312556315624)

[Visit profile](https://www.blogger.com/profile/12332761312556315624)

### Archive

* [2020
  11](http://daniels-it-blog.blogspot.com/2020/)

  + [August
    1](http://daniels-it-blog.blogspot.com/2020/08/)
  + [July
    6](http://daniels-it-blog.blogspot.com/2020/07/)

    - [UAC bypass via dll hijacking and mock directories](http://daniels-it-blog.blogspot.com/2020/07/uac-bypass-via-dll-hijacking-and-mock.html)
    - [IOBit Malware Fighter - Arbitrary Code Execution a...](http://daniels-it-blog.blogspot.com/2020/07/iobit-malware-fighter-arbitrary-code.html)
    - [Arbitrary File Delete via wsreset.exe // Bypass Ad...](http://daniels-it-blog.blogspot.com/2020/07/arbitrary-file-delete-via-wsresetexe.html)
    - [Software in the middle - Abusing legitimate Softwa...](http://daniels-it-blog.blogspot.com/2020/07/software-in-middle-abusing-legitimate.html)
    - [GOG Galaxy - Escalation of Privileges incl. Code E...](http://daniels-it-blog.blogspot.com/2020/07/gog-galaxy-escalation-of-privileges.html)
    - [Steam - Escalation of Privileges](http://daniels-it-blog.blogspot.com/2020/07/steam-arbitrary-code-execution-part-2.html)
  + [June
    3](http://daniels-it-blog.blogspot.com/2020/06/)
  + [May
    1](http://daniels-it-blog.blogspot.com/2020/05/)

### [Report Abuse](https://www.blogger.com/go/report-abuse)


