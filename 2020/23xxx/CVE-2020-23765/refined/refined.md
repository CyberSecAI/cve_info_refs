- **Root cause of vulnerability**: The vulnerability lies in the insufficient validation of uploaded files, specifically within the backup plugin of Bludit V3.12.0.  Although there are checks for file type and extension (.zip), the system does not validate the content of the zip archive, which allows for a malicious file to be placed inside and uploaded via the backup mechanism.

- **Weaknesses/vulnerabilities present**:
    - **Inadequate file content validation**: The backup plugin only checks for the .zip extension and the zip archive structure, but not the contents within. This allows an attacker to embed malicious files like a PHP script with a .php extension.
    - **Lack of sanitization/validation during file restoration**: The system restores the uploaded files from the backup zip without any sanitization or validation leading to possible code execution.
    - **Bypass of upload restrictions**: By modifying the backup archive, the attacker bypasses restrictions on uploading PHP files directly.

- **Impact of exploitation**:
    - **Remote code execution**: By uploading a crafted backup containing a PHP webshell, the attacker can execute arbitrary code on the server.
    - **Full server control**: Successful exploitation can lead to a full compromise of the server.

- **Attack vectors**:
    - **File upload**: The initial attack vector involves uploading a logo with malicious PHP code. The user needs to modify the file content to embed php code
    - **Backup upload**: The attacker generates and downloads a valid backup archive which contains the malicious php code disguised as a logo image. The attacker then modifies this backup to include a file with a .php extension. This modified backup is then uploaded to the server.
    - **Web access**: Once uploaded, the attacker accesses the PHP file, executing the malicious code.

- **Required attacker capabilities/position**:
    - **Administrator rights**: The attacker needs administrator privileges on the Bludit installation to access the file upload and backup functionality.
    - **Ability to intercept/modify HTTP requests**: The attacker needs to be able to intercept the logo upload request and modify the image content to php code via burpsuite or similar.
    - **Ability to modify zip files**: The attacker needs the ability to modify the contents of zip files either through a zip tool, or an ability to modify the raw zip file.