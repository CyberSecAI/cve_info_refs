- **Root cause of vulnerability:** Improper input sanitization when handling user-provided input in the "configure attributes" feature. Specifically, the application attempts to remove script tags but fails to prevent XSS due to not encoding the reflected output.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS). The application does not properly sanitize or encode user-supplied data before displaying it, allowing malicious code to be stored in the database and executed in the browsers of other users.
- **Impact of exploitation:** An attacker can inject malicious scripts that are stored in the application database, and when these scripts are rendered in a user's browser they will execute. This can lead to session hijacking, phishing attacks, defacement of the application, or other malicious actions.
- **Attack vectors:** The attack vector is the "configure attributes" page, specifically the input field for adding a new attribute value under the "Edit Values" option. By inserting a crafted XSS payload such as `<details/open/ontoggle=confirm(1337)>`, an attacker can trigger the execution of arbitrary JavaScript when a user views the affected page.
- **Required attacker capabilities/position:** The attacker must be an authenticated user of the phplist application with the necessary privileges to access and modify the "configure attributes" section.