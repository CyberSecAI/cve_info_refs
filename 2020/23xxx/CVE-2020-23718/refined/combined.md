=== Content from github.com_b306df52_20250119_124530.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxujinliang%2Fzibbs%2Fissues%2F4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxujinliang%2Fzibbs%2Fissues%2F4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=xujinliang%2Fzibbs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xujinliang](/xujinliang)
/
**[zibbs](/xujinliang/zibbs)**
Public

* [Notifications](/login?return_to=%2Fxujinliang%2Fzibbs) You must be signed in to change notification settings
* [Fork
  7](/login?return_to=%2Fxujinliang%2Fzibbs)
* [Star
   18](/login?return_to=%2Fxujinliang%2Fzibbs)

* [Code](/xujinliang/zibbs)
* [Issues
  3](/xujinliang/zibbs/issues)
* [Pull requests
  0](/xujinliang/zibbs/pulls)
* [Actions](/xujinliang/zibbs/actions)
* [Projects
  0](/xujinliang/zibbs/projects)
* [Security](/xujinliang/zibbs/security)
* [Insights](/xujinliang/zibbs/pulse)

Additional navigation options

* [Code](/xujinliang/zibbs)
* [Issues](/xujinliang/zibbs/issues)
* [Pull requests](/xujinliang/zibbs/pulls)
* [Actions](/xujinliang/zibbs/actions)
* [Projects](/xujinliang/zibbs/projects)
* [Security](/xujinliang/zibbs/security)
* [Insights](/xujinliang/zibbs/pulse)

# The function parameter [Route] has reflective XSS #4

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[The function parameter [Route] has reflective XSS](#top)#4Copy link![@Stellarsss](https://avatars.githubusercontent.com/u/33337704?v=4&size=80)
## Description

![@Stellarsss](https://avatars.githubusercontent.com/u/33337704?v=4&size=48)[Stellarsss](https://github.com/Stellarsss)opened [on Jun 18, 2020](https://github.com/xujinliang/zibbs/issues/4#issue-640989968)

First follow to the index.php entry file, which will load the frame file directly, so just visit the following address

`http://20.20.20.130:8000/zibbs/index.php`

`http://20.20.20.130:8000/zibbs`

Will directly load the framework file and instantiate the framework class

[![图片](https://user-images.githubusercontent.com/33337704/84992814-fb644380-b17a-11ea-8d72-6bb437d2dc13.png)](https://user-images.githubusercontent.com/33337704/84992814-fb644380-b17a-11ea-8d72-6bb437d2dc13.png)

Directly trace to the **core/framework.php** file. After analysis, this CMS handles the processing of each controller and operation through 【route】, wherein the parameter route is the controller name and action name to be filled in in this GET request.

**core/framework.php**

[![图片](https://user-images.githubusercontent.com/33337704/84992835-04551500-b17b-11ea-9c12-aa05f81e02d4.png)](https://user-images.githubusercontent.com/33337704/84992835-04551500-b17b-11ea-9c12-aa05f81e02d4.png)

A normal GET request would look like this

<http://20.20.20.130:8000/zibbs/index.php?route=admin/login>

[![图片](https://user-images.githubusercontent.com/33337704/84992855-0b7c2300-b17b-11ea-9ba2-89df40f273cb.png)](https://user-images.githubusercontent.com/33337704/84992855-0b7c2300-b17b-11ea-9ba2-89df40f273cb.png)

And here the parameter 【route】 is controllable, The value of the input parameter 【route】 is processed as follows, The value of the parameter【router】is first split through /，Such as route=aaa/bbb, the aaa Is the controller name,bbb for the action of, It also makes conditional judgments about whether the controller and the action name exist, When the Controller name does not exist, it will directly output "aaa Controller Controller does not exist 11111", as shown below

[![图片](https://user-images.githubusercontent.com/33337704/84992877-15058b00-b17b-11ea-9ef9-86124271d9c9.png)](https://user-images.githubusercontent.com/33337704/84992877-15058b00-b17b-11ea-9ef9-86124271d9c9.png)

[![图片](https://user-images.githubusercontent.com/33337704/84992891-1a62d580-b17b-11ea-8bfa-33a03ba10d33.png)](https://user-images.githubusercontent.com/33337704/84992891-1a62d580-b17b-11ea-8bfa-33a03ba10d33.png)

This is for the parameter 【route】, If the controller doesn't exist, The value of the input parameter 【route】 is displayed directly, And the following values, without XSS filtering, Only the addslashes() method is done here, and there is no XSS filtering function in this aspect

[![图片](https://user-images.githubusercontent.com/33337704/84992914-22bb1080-b17b-11ea-8d96-2471522cfffe.png)](https://user-images.githubusercontent.com/33337704/84992914-22bb1080-b17b-11ea-8d96-2471522cfffe.png)

Because there is no filtering here, there is reflective XSS, which is tested as follows

Because of the split for / here, the regular XSS payload cannot be taken from a bomb frame, so using the following XSS payload can make a bomb fram

[![](x)](x)

<http://20.20.20.130:8000/zibbs/index.php?route=1111%3Cimg%20src=x%20onerror=prompt(1)%3E>

[![图片](https://user-images.githubusercontent.com/33337704/84992939-2d75a580-b17b-11ea-8d5d-ff7da9d85105.png)](https://user-images.githubusercontent.com/33337704/84992939-2d75a580-b17b-11ea-8d5d-ff7da9d85105.png)

[![图片](https://user-images.githubusercontent.com/33337704/84992990-36ff0d80-b17b-11ea-8d6b-c415a049f421.png)](https://user-images.githubusercontent.com/33337704/84992990-36ff0d80-b17b-11ea-8d6b-c415a049f421.png)

The following test statement can also cause a pop-up as normal

route=admin/[![](x)](x)

[![图片](https://user-images.githubusercontent.com/33337704/84993014-41b9a280-b17b-11ea-93e8-d850888b600a.png)](https://user-images.githubusercontent.com/33337704/84993014-41b9a280-b17b-11ea-93e8-d850888b600a.png)

**Solution：**

filter or encode special characters like this

<

"

'

&

%

... ...

and filter some keyword like this

script

javascript

... ...

or filter some label function which can run javascript like this

onclick

onerror

onload

... ...

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


