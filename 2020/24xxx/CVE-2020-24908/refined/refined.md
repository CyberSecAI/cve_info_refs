- **Root cause of vulnerability:** The vulnerability stems from overly permissive file system permissions on the agent's script directory (`C:\ProgramData\checkmk\agent\local`) on Windows systems, allowing any local user to write to this directory. The scripts in this directory are then executed by the Checkmk agent with SYSTEM privileges.
- **Weaknesses/vulnerabilities present:** Insecure file system permissions, specifically allowing write access to the agent's local script directory by any user. This allows for arbitrary command execution as SYSTEM.
- **Impact of exploitation:** A local user can gain full administrative privileges (SYSTEM) on the affected system. This allows the attacker to fully control the system.
- **Attack vectors:** Local access. An attacker needs to have a standard user account on the system monitored by Checkmk.
- **Required attacker capabilities/position:** The attacker needs to have a valid local user account on a Windows system where the Checkmk agent is installed. They need to be able to write files into the `C:\ProgramData\checkmk\agent\local` directory.