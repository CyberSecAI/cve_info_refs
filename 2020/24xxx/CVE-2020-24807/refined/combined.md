=== Content from github.com_9c58d472_20250119_122017.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-6495-8jvh-f28x)

**GHSA-6495-8jvh-f28x**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-6495-8jvh-f28x)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [GHSA-6495-8jvh-f28x](/advisories/GHSA-6495-8jvh-f28x)

## File restriction bypass in socket.io-file

High severity

GitHub Reviewed

Published
Oct 2, 2020
to the GitHub Advisory Database
•
Updated Jan 9, 2023

[Vulnerability details](/advisories/GHSA-6495-8jvh-f28x)
[Dependabot alerts
0](/advisories/GHSA-6495-8jvh-f28x/dependabot)

## Package

npm

socket.io-file
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

<= 2.0.31

## Patched versions

None

## Description

All versions of `socket.io-file`are vulnerable to a file restriction bypass. The validation for valid file types only happens on the client-side, which allows an attacker to intercept the Websocket request post-validation and alter the `name` value to upload any file types.

No fix is currently available. Consider using an alternative package until a fix is made available.

### References

* <https://www.npmjs.com/advisories/1564>
* <https://nvd.nist.gov/vuln/detail/CVE-2020-24807>

Reviewed
Oct 2, 2020

Published to the GitHub Advisory Database
Oct 2, 2020

Last updated
Jan 9, 2023

### Severity

High

7.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

### Weaknesses

[CWE-20](/advisories?query=cwe%3A20)

### CVE ID

No known CVE

### GHSA ID

GHSA-6495-8jvh-f28x

### Source code

[rico345100/socket.io-file](https://github.com/rico345100/socket.io-file)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-6495-8jvh-f28x/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.npmjs.com_3e63e819_20250119_122020.html ===

skip to:[content](#main)[package search](#search)[sign in](#signin)â¤

* [Pro](/products/pro)
* [Teams](/products/teams)
* [Pricing](/products)
* [Documentation](https://docs.npmjs.com)
npmSearch[Sign Up](/signup)[Sign In](/login)
## socket.io-file[DefinitelyTyped icon, indicating that this package has TypeScript declarations provided by the separate @types/socket.io-file package](/package/%40types/socket.io-file)

2.0.31Â â¢Â PublicÂ â¢Â Published 6 years ago

* [Readme](?activeTab=readme)
* [Code Beta](?activeTab=code)
* [1 Dependency](?activeTab=dependencies)
* [3 Dependents](?activeTab=dependents)
* [30 Versions](?activeTab=versions)

# Socket.io-file 2.0

Socket.io-file is now 2.0, much improved! See the below for details..!
Also check the client [client module](https://github.com/rico345100/socket.io-file-client) too.

## Major Changes from 1.x to 2.x

Socket.io-file 1.x used Binary String to send files. Binary String is little bit slower than direct Binary writes, and also server used fs.write, not writable stream.
Recently, FileReader.readAsBinaryString() was deprecated, so I updated Socket.io-file to use ArrayBuffer(Object for manipulate Binary Data directly from JavaScript) instead of Binary String.

Also, newer version has much more functionalities, like Server-side MIME type checking, File size limitations.
Even you can configure the size of each transmission(chunk) any value you want, higher value gives you faster upload.

## Features

* Simple is the best.
* File uploads
* Highly improved performance
* Using File Streams to write faster, efficient.
* Checking mime, limit file size
* Multiple file uploads

## Example

You can found full source code here: [Example Page](https://github.com/rico345100/socket.io-file-example)
Or [Browserify Example](https://github.com/rico345100/socket.io-file-example-browserify)

### Server side

```
"useÂ strict";constÂ expressÂ =Â require('express');constÂ appÂ =Â express();constÂ httpÂ =Â require('http');constÂ httpServerÂ =Â http.Server(app);constÂ ioÂ =Â require('socket.io')(httpServer);constÂ SocketIOFileÂ =Â require('socket.io-file');Â app.get('/',Â (req,Â res,Â next)Â =>Â {Â Â Â Â returnÂ res.sendFile(__dirnameÂ +Â '/client/index.html');});Â app.get('/app.js',Â (req,Â res,Â next)Â =>Â {Â Â Â Â returnÂ res.sendFile(__dirnameÂ +Â '/client/app.js');});Â app.get('/socket.io.js',Â (req,Â res,Â next)Â =>Â {Â Â Â Â returnÂ res.sendFile(__dirnameÂ +Â '/node_modules/socket.io-client/dist/socket.io.js');});Â app.get('/socket.io-file-client.js',Â (req,Â res,Â next)Â =>Â {Â Â Â Â returnÂ res.sendFile(__dirnameÂ +Â '/node_modules/socket.io-file-client/socket.io-file-client.js');});Â io.on('connection',Â (socket)Â =>Â {Â Â Â Â console.log('SocketÂ connected.');Â Â Â Â Â varÂ uploaderÂ =Â newÂ SocketIOFile(socket,Â {Â Â Â Â Â Â Â Â //Â uploadDir:Â {			//Â multipleÂ directoriesÂ Â Â Â Â Â Â Â //Â 	music:Â 'data/music',Â Â Â Â Â Â Â Â //Â 	document:Â 'data/document'Â Â Â Â Â Â Â Â //Â },Â Â Â Â Â Â Â Â uploadDir:Â 'data',							//Â simpleÂ directoryÂ Â Â Â Â Â Â Â accepts:Â ['audio/mpeg',Â 'audio/mp3'],		//Â chromeÂ andÂ someÂ ofÂ browsersÂ checkingÂ mp3Â asÂ 'audio/mp3',Â notÂ 'audio/mpeg'Â Â Â Â Â Â Â Â maxFileSize:Â 4194304,Â 						//Â 4Â MB.Â defaultÂ isÂ undefined(noÂ limit)Â Â Â Â Â Â Â Â chunkSize:Â 10240,							//Â defaultÂ isÂ 10240(1KB)Â Â Â Â Â Â Â Â transmissionDelay:Â 0,						//Â delayÂ ofÂ eachÂ transmission,Â higherÂ valueÂ savesÂ moreÂ cpuÂ resources,Â lowerÂ uploadÂ speed.Â defaultÂ isÂ 0(noÂ delay)Â Â Â Â Â Â Â Â overwrite:Â trueÂ 							//Â overwriteÂ fileÂ ifÂ exists,Â defaultÂ isÂ true.Â Â Â Â });Â Â Â Â uploader.on('start',Â (fileInfo)Â =>Â {Â Â Â Â Â Â Â Â console.log('StartÂ uploading');Â Â Â Â Â Â Â Â console.log(fileInfo);Â Â Â Â });Â Â Â Â uploader.on('stream',Â (fileInfo)Â =>Â {Â Â Â Â Â Â Â Â console.log(`${fileInfo.wrote}Â /Â ${fileInfo.size}Â byte(s)`);Â Â Â Â });Â Â Â Â uploader.on('complete',Â (fileInfo)Â =>Â {Â Â Â Â Â Â Â Â console.log('UploadÂ Complete.');Â Â Â Â Â Â Â Â console.log(fileInfo);Â Â Â Â });Â Â Â Â uploader.on('error',Â (err)Â =>Â {Â Â Â Â Â Â Â Â console.log('Error!',Â err);Â Â Â Â });Â Â Â Â uploader.on('abort',Â (fileInfo)Â =>Â {Â Â Â Â Â Â Â Â console.log('Aborted:Â ',Â fileInfo);Â Â Â Â });});Â httpServer.listen(3000,Â ()Â =>Â {Â Â Â Â console.log('ServerÂ listeningÂ onÂ portÂ 3000');});
```
### Client side

```
varÂ socketÂ =Â io('http://localhost:3000');varÂ uploaderÂ =Â newÂ SocketIOFileClient(socket);varÂ formÂ =Â document.getElementById('form');Â uploader.on('start',Â function(fileInfo)Â {Â Â Â Â console.log('StartÂ uploading',Â fileInfo);});uploader.on('stream',Â function(fileInfo)Â {Â Â Â Â console.log('Streaming...Â sentÂ 'Â +Â fileInfo.sentÂ +Â 'Â bytes.');});uploader.on('complete',Â function(fileInfo)Â {Â Â Â Â console.log('UploadÂ Complete',Â fileInfo);});uploader.on('error',Â function(err)Â {Â Â Â Â console.log('Error!',Â err);});uploader.on('abort',Â function(fileInfo)Â {Â Â Â Â console.log('Aborted:Â ',Â fileInfo);});Â form.onsubmitÂ =Â function(ev)Â {Â Â Â Â ev.preventDefault();Â Â Â Â Â Â Â Â varÂ fileElÂ =Â document.getElementById('file');Â Â Â Â varÂ uploadIdsÂ =Â uploader.upload(fileEl,Â {Â Â Â Â Â Â Â Â data:Â {Â /*Â ArbitraryÂ data...Â */Â }Â Â Â Â });Â Â Â Â Â //Â setTimeout(function()Â {Â Â Â Â Â Â Â Â //Â uploader.abort(uploadIds[0]);Â Â Â Â Â Â Â Â //Â console.log(uploader.getUploadInfo());Â Â Â Â //Â },Â 1000);};
```

```
<html><head>Â Â Â Â <metaÂ charset="UTF-8">Â Â Â Â <title>Socket.io-fileÂ 2.xÂ FileÂ UploadÂ Example</title></head><body>Â Â Â Â <h1>Socket.io-fileÂ 2.xÂ FileÂ UploadÂ Example</h1>Â Â Â Â <p>SelectÂ fileÂ andÂ clickÂ uploadÂ buttonÂ toÂ upload.</p>Â Â Â Â <p>MultipleÂ uploadÂ alsoÂ supports.</p>Â Â Â Â Â <formÂ id="form">Â Â Â Â Â Â Â Â <inputÂ type="file"Â id="file"Â multipleÂ />Â Â Â Â Â Â Â Â <inputÂ type="submit"Â value="Upload"Â />Â Â Â Â </form>Â Â Â Â Â <scriptÂ src="socket.io.js"></script>Â Â Â Â Â <scriptÂ src="socket.io-file-client.js"></script>Â Â Â Â Â <scriptÂ src="app.js"></script>Â </body></html>
```
## API

### constructor SocketIOFile(io socket, Object options)

Create new SocketIOFile object.

Available optionts:

* String uploadDir: String of directory want to upload. This value can be relative or absolute both. Or you can pass the object which has key as identifier, value as directory for multiple directories upload. Client can select the destination if server has multiple upload directories. Check the example to details.
* Array accepts: Array of string that refers mime type. Note that browsers and server can recognize different(like mp3 file, Chrome recognize as "audio/mp3" while server recognize as "audio/mpeg"). See the example to detail later. Default is empty array, which means accept every file.
* Number maxFileSize: Bytes of max file size. Default is undefined, means no limit.
* Number chunkSize: Size of chunk you sending to. Default is 10240 = 1KB. Higher value gives you faster upload, uses more server resources. Lower value saves your server resources, slower upload.
* Number transmissionDelay: Delay of each chunk transmission, default is 0. 0 means no delay, unit is ms. Use this property wisely to save your server resources with chunkSize.
* Boolean overwite: If sets true, overwrite the file if already exists. Default is false, which upload gonna complete immediately if file already exists.
* **New from 2.0.1** String rename: Rename the file before upload starts.
* **New from 2.0.1** Function rename: Rename the file before upload starts. Return value is use for the name. This option is useful to upload file without overwriting concerns. Check the details from later example.

### Events

SocketIOFile provides these events.

#### ready (ADDED ON 2.0.12)

Fired on ready, means after synchronize meta data from client. Make sure upload after ready event triggered.

#### start

Fired on starting file upload. This means server grant your uploading request and create empty file to begin writes. Argument has:

* String name: Name of the file
* Number size: Size of the file(bytes)
* String uploadDir: Directory for writing.
* Object data: An arbitrary data object that was passed to the client's upload()-function.
* **New from 2.0.31** String originalFileName: When renamed file name, original name also delivers here.

#### stream

Fired on getting chunks from client. Argument has:

* String name
* String uploadDir
* Number size
* Number wrote: Bytes of wrote
* Object data: An arbitrary data object that was passed to the client's upload()-function.

#### complete

Fired on upload complete. Argument has:

* String name
* String uploadDir
* String mime: MIME type that server recognized.
* Number size
* Number wrote
* Number estimated: Estimated uploading time as ms.
* Object data: An arbitrary data object that was passed to the client's upload()-function.
* **New from 2.0.2** String uploadId: Upload ID passing from Client.
* **New from 2.0.31** String originalFileName: When renamed file name, original name also delivers here.

#### abort

Fired on abort uploading.

* String name
* String uploadDir
* Number size
* Number wrote
* Object data: An arbitrary data object that was passed to the client's upload()-function.

#### error

Fired on got an error.

* First argument: Error object.
* Second argument: Object with the following properties:
  -- String uploadId
  -- String name
  -- String uploadTo
  -- Object data: An arbitrary data object that was passed to the client's upload()-function.

#### destroy (ADDED ON 2.0.2)

Fired after destroyed Socket.io-file object

### void SocketIOFile.prototype.destroy(void) (ADDED ON 2.0.2)

Destroy all resources that used in Socket.io-file. It also send some order to the client so that client can clear own resources.

## Multiple uploading path

Socket.io-file supports multiple path upload. You can specify multiple upload path with passing object that has key as identifier, value as actual directory.

```
varÂ uploaderÂ =Â newÂ SocketIOFile(socket,Â {Â Â Â Â uploadDir:Â {Â Â Â Â Â Â Â Â music:Â 'data/music',Â Â Â Â Â Â Â Â document:Â 'data/document'Â Â Â Â }});
```

Remember, if you are using multiple path upload, client must select which want to upload.

```
uploader.upload(fileEl,Â {Â Â Â Â uploadTo:Â 'music'		//Â uploadÂ toÂ data/music});
```
## Rename before uploads

From version *2.0.1*, you can now rename the file name before upload starts.

```
varÂ pathÂ =Â require('path');varÂ countÂ =Â 0;Â varÂ uploaderÂ =Â newÂ SocketIOFile(socket,Â {Â Â Â Â overwrite:Â false,Â Â Â Â rename:Â function(filename,Â fileInfo)Â {Â Â Â Â Â Â Â Â varÂ fileÂ =Â path.parse(filename);Â Â Â Â Â Â Â Â varÂ fnameÂ =Â file.name;Â Â Â Â Â Â Â Â varÂ extÂ =Â file.ext;Â Â Â Â returnÂ `${fname}_${count++}.${ext}`;});
```

Above example changes the filename before upload starts, adding counting value before file extension.
This makes file always written, because filename never can't same(but only before you restart the server).
If you want to generate some kind of **unique identifier** to the file always, consider to using Date string or other uid generating node modules like node-uuid.
You can easily combine them together, just put in them into rename option.

From version 2.0.13, you can now just pass string directory, without function.

From version 2.0.31, when use rename property(or function), original file name will includes in argument of complete/start event.

```
varÂ uploadÂ =Â newÂ SocketIOFile(socket,Â {Â Â Â Â rename:Â 'myNewFilename.xls'});
```
## FAQ

### Upload 0 bytes

Try to upload after "ready" event fired.

## Browser Supports

This module uses FileReader API with ArrayBuffer, so make sure your browser support it.

## Readme

### Keywords

* [WebSocket](/search?q=keywords:WebSocket)
* [Socket.io](/search?q=keywords:Socket.io)
* [binary](/search?q=keywords:binary)
* [arraybuffer](/search?q=keywords:arraybuffer)
* [file](/search?q=keywords:file)
* [upload](/search?q=keywords:upload)
## Package Sidebar

### Install

`npm i socket.io-file`

### Repository

[Gitgithub.com/rico345100/socket.io-file](https://github.com/rico345100/socket.io-file)

### Homepage

[github.com/rico345100/socket.io-file#readme](https://github.com/rico345100/socket.io-file#readme)

### DownloadsWeekly Downloads

250

### Version

2.0.31

### License

MIT

### Unpacked Size

21.3 kB

### Total Files

5

### Last publish

6 years ago

### Collaborators

* [![modernator](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci8wZDUyMjQzZjRjZGY1YjgxZGFhYWI5ZGE2MGYxMjgyNj9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.uJVxKD4SEoD-MDZQPLJ5KzvU2QQT8wyWPsmPBQUagNI "modernator")](/~modernator)
[**Try** on RunKit](https://runkit.com/npm/socket.io-file)[**Report** malware](/support?inquire=security&security-inquire=malware&package=socket.io-file&version=2.0.31)
## Footer

### Support

* [Help](https://docs.npmjs.com)
* [Advisories](https://github.com/advisories)
* [Status](http://status.npmjs.org/)
* [Contact npm](/support)
### Company

* [About](/about)
* [Blog](https://github.blog/tag/npm/)
* [Press](/press)
### Terms & Policies

* [Policies](/policies/)
* [Terms of Use](/policies/terms)
* [Code of Conduct](/policies/conduct)
* [Privacy](/policies/privacy)



=== Content from www.npmjs.com_486954fc_20250119_135907.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-6495-8jvh-f28x)

**GHSA-6495-8jvh-f28x**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-6495-8jvh-f28x)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [GHSA-6495-8jvh-f28x](/advisories/GHSA-6495-8jvh-f28x)

## File restriction bypass in socket.io-file

High severity

GitHub Reviewed

Published
Oct 2, 2020
to the GitHub Advisory Database
•
Updated Jan 9, 2023

[Vulnerability details](/advisories/GHSA-6495-8jvh-f28x)
[Dependabot alerts
0](/advisories/GHSA-6495-8jvh-f28x/dependabot)

## Package

npm

socket.io-file
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

<= 2.0.31

## Patched versions

None

## Description

All versions of `socket.io-file`are vulnerable to a file restriction bypass. The validation for valid file types only happens on the client-side, which allows an attacker to intercept the Websocket request post-validation and alter the `name` value to upload any file types.

No fix is currently available. Consider using an alternative package until a fix is made available.

### References

* <https://www.npmjs.com/advisories/1564>
* <https://nvd.nist.gov/vuln/detail/CVE-2020-24807>

Reviewed
Oct 2, 2020

Published to the GitHub Advisory Database
Oct 2, 2020

Last updated
Jan 9, 2023

### Severity

High

7.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

### Weaknesses

[CWE-20](/advisories?query=cwe%3A20)

### CVE ID

No known CVE

### GHSA ID

GHSA-6495-8jvh-f28x

### Source code

[rico345100/socket.io-file](https://github.com/rico345100/socket.io-file)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-6495-8jvh-f28x/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b0e79472_20250119_122018.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frico345100%2Fsocket.io-file)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frico345100%2Fsocket.io-file)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=rico345100%2Fsocket.io-file)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rico345100](/rico345100)
/
**[socket.io-file](/rico345100/socket.io-file)**
Public

* [Notifications](/login?return_to=%2Frico345100%2Fsocket.io-file) You must be signed in to change notification settings
* [Fork
  19](/login?return_to=%2Frico345100%2Fsocket.io-file)
* [Star
   48](/login?return_to=%2Frico345100%2Fsocket.io-file)

Socket.io-file is a node module for uploading file via Socket.io module

### License

[MIT license](/rico345100/socket.io-file/blob/master/LICENSE)

[48
stars](/rico345100/socket.io-file/stargazers) [19
forks](/rico345100/socket.io-file/forks) [Branches](/rico345100/socket.io-file/branches) [Tags](/rico345100/socket.io-file/tags) [Activity](/rico345100/socket.io-file/activity)
 [Star](/login?return_to=%2Frico345100%2Fsocket.io-file)

 [Notifications](/login?return_to=%2Frico345100%2Fsocket.io-file) You must be signed in to change notification settings

* [Code](/rico345100/socket.io-file)
* [Issues
  9](/rico345100/socket.io-file/issues)
* [Pull requests
  0](/rico345100/socket.io-file/pulls)
* [Actions](/rico345100/socket.io-file/actions)
* [Projects
  0](/rico345100/socket.io-file/projects)
* [Security](/rico345100/socket.io-file/security)
* [Insights](/rico345100/socket.io-file/pulse)

Additional navigation options

* [Code](/rico345100/socket.io-file)
* [Issues](/rico345100/socket.io-file/issues)
* [Pull requests](/rico345100/socket.io-file/pulls)
* [Actions](/rico345100/socket.io-file/actions)
* [Projects](/rico345100/socket.io-file/projects)
* [Security](/rico345100/socket.io-file/security)
* [Insights](/rico345100/socket.io-file/pulse)

# rico345100/socket.io-file

    master[Branches](/rico345100/socket.io-file/branches)[Tags](/rico345100/socket.io-file/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[37 Commits](/rico345100/socket.io-file/commits/master/) | | |
| [.gitignore](/rico345100/socket.io-file/blob/master/.gitignore ".gitignore") | | [.gitignore](/rico345100/socket.io-file/blob/master/.gitignore ".gitignore") |  |  |
| [LICENSE](/rico345100/socket.io-file/blob/master/LICENSE "LICENSE") | | [LICENSE](/rico345100/socket.io-file/blob/master/LICENSE "LICENSE") |  |  |
| [index.js](/rico345100/socket.io-file/blob/master/index.js "index.js") | | [index.js](/rico345100/socket.io-file/blob/master/index.js "index.js") |  |  |
| [package-lock.json](/rico345100/socket.io-file/blob/master/package-lock.json "package-lock.json") | | [package-lock.json](/rico345100/socket.io-file/blob/master/package-lock.json "package-lock.json") |  |  |
| [package.json](/rico345100/socket.io-file/blob/master/package.json "package.json") | | [package.json](/rico345100/socket.io-file/blob/master/package.json "package.json") |  |  |
| [readme.md](/rico345100/socket.io-file/blob/master/readme.md "readme.md") | | [readme.md](/rico345100/socket.io-file/blob/master/readme.md "readme.md") |  |  |
| [utils.js](/rico345100/socket.io-file/blob/master/utils.js "utils.js") | | [utils.js](/rico345100/socket.io-file/blob/master/utils.js "utils.js") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# Socket.io-file 2.0

Socket.io-file is now 2.0, much improved! See the below for details..!
Also check the client [client module](https://github.com/rico345100/socket.io-file-client) too.

## Major Changes from 1.x to 2.x

Socket.io-file 1.x used Binary String to send files. Binary String is little bit slower than direct Binary writes, and also server used fs.write, not writable stream.
Recently, FileReader.readAsBinaryString() was deprecated, so I updated Socket.io-file to use ArrayBuffer(Object for manipulate Binary Data directly from JavaScript) instead of Binary String.

Also, newer version has much more functionalities, like Server-side MIME type checking, File size limitations.
Even you can configure the size of each transmission(chunk) any value you want, higher value gives you faster upload.

## Features

* Simple is the best.
* File uploads
* Highly improved performance
* Using File Streams to write faster, efficient.
* Checking mime, limit file size
* Multiple file uploads

## Example

You can found full source code here: [Example Page](https://github.com/rico345100/socket.io-file-example)
Or [Browserify Example](https://github.com/rico345100/socket.io-file-example-browserify)

### Server side

```
"use strict";
const express = require('express');
const app = express();
const http = require('http');
const httpServer = http.Server(app);
const io = require('socket.io')(httpServer);
const SocketIOFile = require('socket.io-file');

app.get('/', (req, res, next) => {
	return res.sendFile(__dirname + '/client/index.html');
});

app.get('/app.js', (req, res, next) => {
	return res.sendFile(__dirname + '/client/app.js');
});

app.get('/socket.io.js', (req, res, next) => {
	return res.sendFile(__dirname + '/node_modules/socket.io-client/dist/socket.io.js');
});

app.get('/socket.io-file-client.js', (req, res, next) => {
	return res.sendFile(__dirname + '/node_modules/socket.io-file-client/socket.io-file-client.js');
});

io.on('connection', (socket) => {
	console.log('Socket connected.');

	var uploader = new SocketIOFile(socket, {
		// uploadDir: {			// multiple directories
		// 	music: 'data/music',
		// 	document: 'data/document'
		// },
		uploadDir: 'data',							// simple directory
		accepts: ['audio/mpeg', 'audio/mp3'],		// chrome and some of browsers checking mp3 as 'audio/mp3', not 'audio/mpeg'
		maxFileSize: 4194304, 						// 4 MB. default is undefined(no limit)
		chunkSize: 10240,							// default is 10240(1KB)
		transmissionDelay: 0,						// delay of each transmission, higher value saves more cpu resources, lower upload speed. default is 0(no delay)
		overwrite: true 							// overwrite file if exists, default is true.
	});
	uploader.on('start', (fileInfo) => {
		console.log('Start uploading');
		console.log(fileInfo);
	});
	uploader.on('stream', (fileInfo) => {
		console.log(`${fileInfo.wrote} / ${fileInfo.size} byte(s)`);
	});
	uploader.on('complete', (fileInfo) => {
		console.log('Upload Complete.');
		console.log(fileInfo);
	});
	uploader.on('error', (err) => {
		console.log('Error!', err);
	});
	uploader.on('abort', (fileInfo) => {
		console.log('Aborted: ', fileInfo);
	});
});

httpServer.listen(3000, () => {
	console.log('Server listening on port 3000');
});
```

### Client side

```
var socket = io('http://localhost:3000');
var uploader = new SocketIOFileClient(socket);
var form = document.getElementById('form');

uploader.on('start', function(fileInfo) {
	console.log('Start uploading', fileInfo);
});
uploader.on('stream', function(fileInfo) {
	console.log('Streaming... sent ' + fileInfo.sent + ' bytes.');
});
uploader.on('complete', function(fileInfo) {
	console.log('Upload Complete', fileInfo);
});
uploader.on('error', function(err) {
	console.log('Error!', err);
});
uploader.on('abort', function(fileInfo) {
	console.log('Aborted: ', fileInfo);
});

form.onsubmit = function(ev) {
	ev.preventDefault();

	var fileEl = document.getElementById('file');
	var uploadIds = uploader.upload(fileEl, {
		data: { /* Arbitrary data... */ }
	});

	// setTimeout(function() {
		// uploader.abort(uploadIds[0]);
		// console.log(uploader.getUploadInfo());
	// }, 1000);
};
```

```
<html>
<head>
	<meta charset="UTF-8">
	<title>Socket.io-file 2.x File Upload Example</title>
</head>
<body>
	<h1>Socket.io-file 2.x File Upload Example</h1>
	<p>Select file and click upload button to upload.</p>
	<p>Multiple upload also supports.</p>

	<form id="form">
		<input type="file" id="file" multiple />
		<input type="submit" value="Upload" />
	</form>

	<script src="socket.io.js"></script>
	<script src="socket.io-file-client.js"></script>
	<script src="app.js"></script>
</body>
</html>
```

## API

### constructor SocketIOFile(io socket, Object options)

Create new SocketIOFile object.

Available optionts:

* String uploadDir: String of directory want to upload. This value can be relative or absolute both. Or you can pass the object which has key as identifier, value as directory for multiple directories upload. Client can select the destination if server has multiple upload directories. Check the example to details.
* Array accepts: Array of string that refers mime type. Note that browsers and server can recognize different(like mp3 file, Chrome recognize as "audio/mp3" while server recognize as "audio/mpeg"). See the example to detail later. Default is empty array, which means accept every file.
* Number maxFileSize: Bytes of max file size. Default is undefined, means no limit.
* Number chunkSize: Size of chunk you sending to. Default is 10240 = 1KB. Higher value gives you faster upload, uses more server resources. Lower value saves your server resources, slower upload.
* Number transmissionDelay: Delay of each chunk transmission, default is 0. 0 means no delay, unit is ms. Use this property wisely to save your server resources with chunkSize.
* Boolean overwite: If sets true, overwrite the file if already exists. Default is false, which upload gonna complete immediately if file already exists.
* **New from 2.0.1** String rename: Rename the file before upload starts.
* **New from 2.0.1** Function rename: Rename the file before upload starts. Return value is use for the name. This option is useful to upload file without overwriting concerns. Check the details from later example.

### Events

SocketIOFile provides these events.

#### ready (ADDED ON 2.0.12)

Fired on ready, means after synchronize meta data from client. Make sure upload after ready event triggered.

#### start

Fired on starting file upload. This means server grant your uploading request and create empty file to begin writes. Argument has:

* String name: Name of the file
* Number size: Size of the file(bytes)
* String uploadDir: Directory for writing.
* Object data: An arbitrary data object that was passed to the client's upload()-function.
* **New from 2.0.31** String originalFileName: When renamed file name, original name also delivers here.

#### stream

Fired on getting chunks from client. Argument has:

* String name
* String uploadDir
* Number size
* Number wrote: Bytes of wrote
* Object data: An arbitrary data object that was passed to the client's upload()-function.

#### complete

Fired on upload complete. Argument has:

* String name
* String uploadDir
* String mime: MIME type that server recognized.
* Number size
* Number wrote
* Number estimated: Estimated uploading time as ms.
* Object data: An arbitrary data object that was passed to the client's upload()-function.
* **New from 2.0.2** String uploadId: Upload ID passing from Client.
* **New from 2.0.31** String originalFileName: When renamed file name, original name also delivers here.

#### abort

Fired on abort uploading.

* String name
* String uploadDir
* Number size
* Number wrote
* Object data: An arbitrary data object that was passed to the client's upload()-function.

#### error

Fired on got an error.

* First argument: Error object.
* Second argument: Object with the following properties:
  -- String uploadId
  -- String name
  -- String uploadTo
  -- Object data: An arbitrary data object that was passed to the client's upload()-function.

#### destroy (ADDED ON 2.0.2)

Fired after destroyed Socket.io-file object

### void SocketIOFile.prototype.destroy(void) (ADDED ON 2.0.2)

Destroy all resources that used in Socket.io-file. It also send some order to the client so that client can clear own resources.

## Multiple uploading path

Socket.io-file supports multiple path upload. You can specify multiple upload path with passing object that has key as identifier, value as actual directory.

```
var uploader = new SocketIOFile(socket, {
	uploadDir: {
		music: 'data/music',
		document: 'data/document'
	}
});
```

Remember, if you are using multiple path upload, client must select which want to upload.

```
uploader.upload(fileEl, {
	uploadTo: 'music'		// upload to data/music
});
```

## Rename before uploads

From version *2.0.1*, you can now rename the file name before upload starts.

```
var path = require('path');
var count = 0;

var uploader = new SocketIOFile(socket, {
	overwrite: false,
	rename: function(filename, fileInfo) {
		var file = path.parse(filename);
        var fname = file.name;
        var ext = file.ext;
	return `${fname}_${count++}.${ext}`;
});
```

Above example changes the filename before upload starts, adding counting value before file extension.
This makes file always written, because filename never can't same(but only before you restart the server).
If you want to generate some kind of **unique identifier** to the file always, consider to using Date string or other uid generating node modules like node-uuid.
You can easily combine them together, just put in them into rename option.

From version 2.0.13, you can now just pass string directory, without function.

From version 2.0.31, when use rename property(or function), original file name will includes in argument of complete/start event.

```
var upload = new SocketIOFile(socket, {
	rename: 'myNewFilename.xls'
});
```

## FAQ

### Upload 0 bytes

Try to upload after "ready" event fired.

## Browser Supports

This module uses FileReader API with ArrayBuffer, so make sure your browser support it.

## About

Socket.io-file is a node module for uploading file via Socket.io module

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/rico345100/socket.io-file/activity)
### Stars

[**48**
stars](/rico345100/socket.io-file/stargazers)
### Watchers

[**5**
watching](/rico345100/socket.io-file/watchers)
### Forks

[**19**
forks](/rico345100/socket.io-file/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Frico345100%2Fsocket.io-file&report=rico345100+%28user%29)

## [Releases](/rico345100/socket.io-file/releases)

No releases published

## [Packages 0](/users/rico345100/packages?repo_name=socket.io-file)

No packages published

## [Contributors 6](/rico345100/socket.io-file/graphs/contributors)

## Languages

* [JavaScript
  100.0%](/rico345100/socket.io-file/search?l=javascript)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


