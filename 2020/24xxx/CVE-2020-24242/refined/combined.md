=== Content from bugzilla.nasm.us_a3e9160a_20250119_121330.html ===


Bugzilla – Bug 3392708
SEGV in tok\_text asm/preproc.c:322
Last modified: 2020-07-30 15:58:58 PDT

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](docs/en/html/using/understanding.html)
* |
  [Log In](show_bug.cgi?id=3392708&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=3392708&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

Self-registration is disabled due to spam issue (mail gorcunov@gmail.com or hpa@zytor.com to create an account)

[**Bug 3392708**](show_bug.cgi?id=3392708)
- SEGV in tok\_text asm/preproc.c:322

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
SEGV in tok\_text asm/preproc.c:322

| | [Status](page.cgi?id=fields.html#bug_status): | CLOSED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | NASM | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=NASM "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Assembler ([show other bugs](buglist.cgi?component=Assembler&product=NASM&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 2.15.xx | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | High critical | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | nobody | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2020-07-28 04:05 PDT by Suhwan | | --- | --- | | Modified: | 2020-07-30 15:58 PDT ([History](show_activity.cgi?id=3392708)) | | CC List: | 5 users (show)  chang.seok.bae gorcunov hpa nasm-bugs prada960808 | |  | | | [Obtained from:](page.cgi?id=fields.html#cf_build "Please indicate where you obtained and/or built your version of NASM.") | Build from source archive using configure | | [Generated by:](page.cgi?id=fields.html#cf_robot "Was this bug report generated by an automatic tool, such as a memory leak detector or fuzzer, *without* including a human validation description or analysis of the problem?") | --- | | [Bug category:](page.cgi?id=fields.html#cf_category "The general category of this bug oor request.") |  | | [Breaks existing code:](page.cgi?id=fields.html#cf_breaks "This bug report breaks existing code in production or under development.") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [**poc**](attachment.cgi?id=411797 "View the content of the attachment") (360 bytes, application/octet-stream)  [2020-07-28 04:05 PDT](#attach_411797 "Go to the comment associated with the attachment"), Suhwan | [Details](attachment.cgi?id=411797&action=edit) | | [Add an attachment](attachment.cgi?bugid=3392708&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=3392708&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=3392708#c0)  Suhwan    2020-07-28 04:05:42 PDT  ``` Created [attachment 411797](attachment.cgi?id=411797 "poc") [[details]](attachment.cgi?id=411797&action=edit "poc") poc  Hi,  I found a SEGV in tok_text asm/preproc.c:322 It is triggered in nasm version 2.15rc10.  Please run following command `nasm -f win64 -o tmp.o $PoC`   ==32505==ERROR: AddressSanitizer: SEGV on unknown address 0x00000000000c (pc 0x55f65853fe00 bp 0x7feb4656d600 sp 0x7ffed04f1fe0 T0) ==32505==The signal is caused by a READ memory access. ==32505==Hint: address points to the zero page.     #0 0x55f65853fdff in tok_text asm/preproc.c:322     #1 0x55f65853fdff in do_directive asm/preproc.c:3552     #2 0x55f65855f738 in pp_tokline asm/preproc.c:6716     #3 0x55f65855f738 in pp_getline asm/preproc.c:6779     #4 0x55f6583d1dfa in assemble_file asm/nasm.c:1705     #5 0x55f6583c7056 in main asm/nasm.c:712     #6 0x7feb450f7b96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)     #7 0x55f6583ca129 in _start (/mnt/hda2/suhwan/add_project/final/FINAL_TEST_ZONE/program/nasm-2.15rc10/install_dir/bin/nasm+0x124129)  AddressSanitizer can not provide additional info. SUMMARY: AddressSanitizer: SEGV asm/preproc.c:322 in tok_text ==32505==ABORTING ```  [Comment 1](show_bug.cgi?id=3392708#c1)  Suhwan    2020-07-28 23:14:42 PDT  ``` Still reproduced in NASM version 2.16rc0. This is found by Agency for Defense Development (ADD) in South Korea. ```  [Comment 2](show_bug.cgi?id=3392708#c2)  H. Peter Anvin    2020-07-29 00:28:28 PDT  ``` 2.16rc0 is not an actual version, it is the tag for the future 2.16 development branch, which is not up to date as focus is currently on the nasm-2.15.xx maintenance branch.  The best would be if you can give the git ID for what you test, otherwise the daily snapshot number. ```  [Comment 3](show_bug.cgi?id=3392708#c3)  Suhwan    2020-07-29 00:46:17 PDT  ``` NASM version 2.15.04rc1 compiled on Jul 29 2020   ==26762==ERROR: AddressSanitizer: SEGV on unknown address 0x00000000000c (pc 0x564f19a4e52c bp 0x7ff982d25640 sp 0x7ffd85154120 T0) ==26762==The signal is caused by a READ memory access. ==26762==Hint: address points to the zero page.     #0 0x564f19a4e52b in tok_text asm/preproc.c:334     #1 0x564f19a4e52b in do_directive asm/preproc.c:3671     #2 0x564f19a6c19c in pp_tokline asm/preproc.c:6851     #3 0x564f19a6c19c in pp_getline asm/preproc.c:6914     #4 0x564f198e038b in assemble_file asm/nasm.c:1718     #5 0x564f198d7171 in main asm/nasm.c:714     #6 0x7ff9818afb96 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21b96)     #7 0x564f198da289 in _start (/mnt/hda2/suhwan/add_project/final/FINAL_TEST_ZONE/program/nasm-2.15.04rc1/install_dir/bin/nasm+0x12a289)  AddressSanitizer can not provide additional info. SUMMARY: AddressSanitizer: SEGV asm/preproc.c:334 in tok_text ==26762==ABORTING  Sorry for bothering you. ```  [Comment 4](show_bug.cgi?id=3392708#c4)  H. Peter Anvin    2020-07-30 15:58:58 PDT  ``` Fixed in checkin 6299a3114ce0f3acd55d07de201a8ca2f0a83059 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=3392708)
* - [XML](show_bug.cgi?ctype=xml&id=3392708)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=3392708)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](docs/en/html/using/understanding.html)
  + |
    [Log In](show_bug.cgi?id=3392708&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=3392708&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


