=== Content from code610.blogspot.com_22da349b_20250119_115406.html ===


# [code16](https://code610.blogspot.com/)

## Strony

* [Strona główna](https://code610.blogspot.com/)
* [Mini arts](https://code610.blogspot.com/p/mini-arts.html)
* [Notes Magazine](https://code610.blogspot.com/p/notes-magazine.html)
* [Found bugs](https://code610.blogspot.com/p/found.html)
* [CTFs](https://code610.blogspot.com/p/ctfs.html)
* [Contact](https://code610.blogspot.com/p/contact.html)

## czwartek, 20 sierpnia 2020

### Postauth RCE in Nagios 5.7.2

Last time when I was checking NagiosXI is described here[[1](https://code610.blogspot.com/2019/12/postauth-rce-in-latest-nagiosxi.html), [2](https://code610.blogspot.com/2020/03/nagios-5611-xssd.html), [3](https://code610.blogspot.com/2020/03/creating-poc-for-nagiosxi-0day.html)] so you could already get some 'basic introduction' to the topic. Below you will find new more details - this time for (again) 'latest' version (5.7.2). Here we go...

This time we will start [here](https://www.nagios.com/downloads/nagios-xi/linux/):

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhKGISo5pz9-R1GubJBODbT2KBvOIeMpAJ0aJZIN_WhCBbPLtlEwEBToIss1h6m9yceR-gResuQKU9JIBSWzyafY6mQI-bYBS_VF9-YPEIo-LqZrEyJAKJFbHzZQGSeRjlU7pF696Ccnyc/s640/00.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhKGISo5pz9-R1GubJBODbT2KBvOIeMpAJ0aJZIN_WhCBbPLtlEwEBToIss1h6m9yceR-gResuQKU9JIBSWzyafY6mQI-bYBS_VF9-YPEIo-LqZrEyJAKJFbHzZQGSeRjlU7pF696Ccnyc/s1275/00.png)

[As usual](https://code610.blogspot.com/p/mini-arts.html) I tried to identify some webapps bugs like XSS (to 'start somehere';)). So I started here:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgtdgCq4DVaaxiMb13C9UyCsGi720-Y9KUZ6JOe255Hr86PUvx44BXra5UCNLD6XfkLB2cTn3fFcYHweaZIwByNP8NgFx0D1ZBS6CixBNkH9ICNwcXK1SrAYbH9-6DARtR3aB8AXt4xtZ8/s640/01.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgtdgCq4DVaaxiMb13C9UyCsGi720-Y9KUZ6JOe255Hr86PUvx44BXra5UCNLD6XfkLB2cTn3fFcYHweaZIwByNP8NgFx0D1ZBS6CixBNkH9ICNwcXK1SrAYbH9-6DARtR3aB8AXt4xtZ8/s1001/01.png)

I found that 'Email Address' is vulnerable to XSS, see below:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhBQcTMg1h3vWtByejCJk75Tuy2elm_DOMK8tVVFkpt5p-q5iPRLhfsIwKV9KA_6XxiaZ5x-IR3S8WVi7BNuZApJ4zu2QkIByfmZlPMdnI5njdQTiaQoWnIgqBT4aGk2XJneUMNDI3dhyQ/s640/02.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhBQcTMg1h3vWtByejCJk75Tuy2elm_DOMK8tVVFkpt5p-q5iPRLhfsIwKV9KA_6XxiaZ5x-IR3S8WVi7BNuZApJ4zu2QkIByfmZlPMdnI5njdQTiaQoWnIgqBT4aGk2XJneUMNDI3dhyQ/s1226/02.png)

In the meantime I was looking for the reason in the source. This is one of the findings:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiSlo55Z5nIdEKQV7g7VzzFsUxImgFEmCQgdQTAvM3tJ3DMEY-yrclq3aZs4pIt7sQi5TuY59Jgy_DcaCbpf5ITr4DSzHe4XSmBQIX-5eDdlKtGrqzO0j1paSduJLJQ4QLUwnIe5JUOFU0/s640/03.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiSlo55Z5nIdEKQV7g7VzzFsUxImgFEmCQgdQTAvM3tJ3DMEY-yrclq3aZs4pIt7sQi5TuY59Jgy_DcaCbpf5ITr4DSzHe4XSmBQIX-5eDdlKtGrqzO0j1paSduJLJQ4QLUwnIe5JUOFU0/s1523/03.png)

Next I watched NagiosXI weblog console, check this out (looks pretty familiar to few last cases described [here](https://code610.blogspot.com/2020/04/and-now-we-are-free.html)):

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi5EfkOsSPgeMEqAFGWjiELUCL6hcPRZy08EuNMz-QjqHlnT2qUZA8XoIzHp1XKS6FJP3xC13k3TSh5xIR0kRIgaflqWOIw_EiVv6IQH1wTYBzhBx-FhZaiJdqifUStKpKUbfhCUPREWCA/s640/04.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi5EfkOsSPgeMEqAFGWjiELUCL6hcPRZy08EuNMz-QjqHlnT2qUZA8XoIzHp1XKS6FJP3xC13k3TSh5xIR0kRIgaflqWOIw_EiVv6IQH1wTYBzhBx-FhZaiJdqifUStKpKUbfhCUPREWCA/s1722/04.png)

Well... ;> I started to dig a bit with this field...

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiVZf7PSIBtmkrxX87QR_iUtgJPhOc9eJIh7XBf9PlIOuc7Hw5QQjXAphsgcpnX3MJrxqaUfF10tp7M9ZCIU5xzky1UrqdFzCYbo0a_DSy98gcRzxCWJY76kv-5eiUoP3T_9cPLPZ8KgGk/s640/05.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiVZf7PSIBtmkrxX87QR_iUtgJPhOc9eJIh7XBf9PlIOuc7Hw5QQjXAphsgcpnX3MJrxqaUfF10tp7M9ZCIU5xzky1UrqdFzCYbo0a_DSy98gcRzxCWJY76kv-5eiUoP3T_9cPLPZ8KgGk/s956/05.png)

After I updated my account-email-settings I decided to *send test notifications*:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEilLSrzRo9i_wemz-cdGhBx7mZlKvRR1QebFTl6hCzBu7dUHmHJ-ecyxuLI12pwsuBoSJTxWvHvd3SIh2EbapfqLAEb8vdq3v4FIdVppqqvf5Q5S6lgYHa5Fgrm1WZNNAEH6qvBoF4L0pA/s0/06.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEilLSrzRo9i_wemz-cdGhBx7mZlKvRR1QebFTl6hCzBu7dUHmHJ-ecyxuLI12pwsuBoSJTxWvHvd3SIh2EbapfqLAEb8vdq3v4FIdVppqqvf5Q5S6lgYHa5Fgrm1WZNNAEH6qvBoF4L0pA/s622/06.png)

Few more attempts below:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjKk2dZmvEz-fL90cZD_LjVVhDAQMv3T7m2au-b-h3TuB366fpHcBlwNcqVRCq7O6CV7QgDzl9DIv3knPRM_vDo3Luq3yE7cUXSoohgaSeo2c97EpIHPaelliHc7dK0ovIJXe8yzPLL79s/s640/07.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjKk2dZmvEz-fL90cZD_LjVVhDAQMv3T7m2au-b-h3TuB366fpHcBlwNcqVRCq7O6CV7QgDzl9DIv3knPRM_vDo3Luq3yE7cUXSoohgaSeo2c97EpIHPaelliHc7dK0ovIJXe8yzPLL79s/s1550/07.png)

...and 'few more' (hours of) checking source and logs:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgmOFt2-5aPmmB-7NOTseWpSrPZGE-CvFV_rcoKuDq5VVCjZBgWGMHDopjRZg5lWatlXhJov0UBjWzcpN10pzAHT6smyfSoU1qlwtjCYh20v8tsbKTVWGmJ3Ox_U997KJDPkcmzTgKViuw/s640/08.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgmOFt2-5aPmmB-7NOTseWpSrPZGE-CvFV_rcoKuDq5VVCjZBgWGMHDopjRZg5lWatlXhJov0UBjWzcpN10pzAHT6smyfSoU1qlwtjCYh20v8tsbKTVWGmJ3Ox_U997KJDPkcmzTgKViuw/s1345/08.png)

And that's how I found this file:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEju3Nq5Ood1PPQAsddY7WBzun6gOal4ZDcditDR2NxQAJuKNsDvHv8uq6RrCmpqHz94BmO9cHylatm5yYjrRx2kjbnW_kH1rYPDnIe1IB7VgJLgxhFt3ZQhskfmzrSSfckfq_injNlDSxA/s640/09.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEju3Nq5Ood1PPQAsddY7WBzun6gOal4ZDcditDR2NxQAJuKNsDvHv8uq6RrCmpqHz94BmO9cHylatm5yYjrRx2kjbnW_kH1rYPDnIe1IB7VgJLgxhFt3ZQhskfmzrSSfckfq_injNlDSxA/s1316/09.png)

[Going down](https://www.youtube.com/watch?v=h3Yrhv33Zb8)?

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEinNPsEO6-l0WVlyUP5PwgAchlBwKj_OJpkFY25rZ3ht2LfYNqeo8iR5h5XHhP4Z0kYOi6TDjDhKiHVp4DXQA7ybM47lRCl06EqBWSrCwjfybGcrS1DDPy_3ktyoZNqSy6qYPhT3hmCuUk/s640/10.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEinNPsEO6-l0WVlyUP5PwgAchlBwKj_OJpkFY25rZ3ht2LfYNqeo8iR5h5XHhP4Z0kYOi6TDjDhKiHVp4DXQA7ybM47lRCl06EqBWSrCwjfybGcrS1DDPy_3ktyoZNqSy6qYPhT3hmCuUk/s975/10.png)

Now, let's *parse\_argv()*:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh1jQyZfFvCwb4v0ck1WhFjNC7kG6cNnUgaPa3QEZsQ-d9pCvHQtEr-gZW7XH5Wn6Y9HlyhLrokgbKHNsUIJDFtRn9SAZINwEs5LqaHoCHK_fwQz6yfYf30yCxwhdEVYVgxAKgHX5VV_Ik/s640/11.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh1jQyZfFvCwb4v0ck1WhFjNC7kG6cNnUgaPa3QEZsQ-d9pCvHQtEr-gZW7XH5Wn6Y9HlyhLrokgbKHNsUIJDFtRn9SAZINwEs5LqaHoCHK_fwQz6yfYf30yCxwhdEVYVgxAKgHX5VV_Ik/s799/11.png)

I was wondering if I'm able to even try to run "the same" command using directly (only) bash (from target server):

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhf-BXYDTVIRjQHKIk9DaQnyT6vDpk8DxNaAz52TkXowqQ-iI3auilS4Jq0H8XF8kXy3kqhiAasI_tbEyiBw7k01_A0lF3QiOONsF-fkAQTVxMTye-DjqGy1FrAIeSOpetZPmLhgNqtjIE/s640/12.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhf-BXYDTVIRjQHKIk9DaQnyT6vDpk8DxNaAz52TkXowqQ-iI3auilS4Jq0H8XF8kXy3kqhiAasI_tbEyiBw7k01_A0lF3QiOONsF-fkAQTVxMTye-DjqGy1FrAIeSOpetZPmLhgNqtjIE/s1067/12.png)

I was. So the reason was something inside the webapp - not the payload itself... Checking:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhaw9LQMqWD7aYPNVmV46q0AnT_Yqhyd4SpDFExSKxUJtNqa-qt8pEjcVyWK7yiM82GIng_IrG0YFuumu-vAQGRhAynwlCWo_q2Fr_89w7OfwKfCE_5O1WO-vzS2c8vetkB_BF6htaYg8M/s640/13.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhaw9LQMqWD7aYPNVmV46q0AnT_Yqhyd4SpDFExSKxUJtNqa-qt8pEjcVyWK7yiM82GIng_IrG0YFuumu-vAQGRhAynwlCWo_q2Fr_89w7OfwKfCE_5O1WO-vzS2c8vetkB_BF6htaYg8M/s1774/13.png)

Here (from bash-perspective) everything looks fine. So I was looking more and more source files, github links, and google resources. After preparing a proper (but-still-bash) payload I decided to test it again using 'Send Test Notifications':

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgkLnjD4dT3cYXAYE6-TPEob49Mqf6x50CM3gW7OBORQfpk-3QLvpsxKXEXJckO_OUOVFANRu9kSfamS5F5EOeUoRDQz9toG9Z4bYE2Jy7r0JOl7FRO4bKJxlzK_b0qXywgpyH06arvRCs/s640/14.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgkLnjD4dT3cYXAYE6-TPEob49Mqf6x50CM3gW7OBORQfpk-3QLvpsxKXEXJckO_OUOVFANRu9kSfamS5F5EOeUoRDQz9toG9Z4bYE2Jy7r0JOl7FRO4bKJxlzK_b0qXywgpyH06arvRCs/s1673/14.png)

No luck (screen from VMPlayer is the response for bash request started from *runme.sh* script).

I tried to ask *ps|aux* for some hint(s):

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg6O4EKkYUe2QgFDdZkRpUSLznXYKCVNKO0JMuF5vab_yxL3LOH4qQ1IvNrjRuuLFjZYahakfkK07DOtWUMkBgGTvuyhyphenhyphenj0a0G8Dqqj8T5Lx4fBIs-oOaBo8xNAWg22F7CIGVQmHVcUTPk/s640/15.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg6O4EKkYUe2QgFDdZkRpUSLznXYKCVNKO0JMuF5vab_yxL3LOH4qQ1IvNrjRuuLFjZYahakfkK07DOtWUMkBgGTvuyhyphenhyphenj0a0G8Dqqj8T5Lx4fBIs-oOaBo8xNAWg22F7CIGVQmHVcUTPk/s1687/15.png)

After 4 days... ;] I even decided to try to use some *strace*-magic:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjDLt0OQ40_R3yDCRIy0SK0FoMbQwLl7QFlwATP0o9L8tNweXrOxa9FJHLnxxxcryV2hhmwYSqbXG_JBlTlxO6ZaCQ1r3_NjD5kjDURy2G0xsO7X1pByg-NlsmWpc3tHi81H51TL7fETLs/s640/16.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjDLt0OQ40_R3yDCRIy0SK0FoMbQwLl7QFlwATP0o9L8tNweXrOxa9FJHLnxxxcryV2hhmwYSqbXG_JBlTlxO6ZaCQ1r3_NjD5kjDURy2G0xsO7X1pByg-NlsmWpc3tHi81H51TL7fETLs/s777/16.png)

Still nothing.During day5 (and also checking the logs from NagiosXI) I found a new hint - PHPMailer:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiKmjQcfv0fR2pLP4EdAk_ffFo4tW0r38xDMzdI5dsx0v24KlbyXpZGrtZl4tkWyW18f3mIncLidTXFL2UX_Wj16IVPRQzRwIZHXn7pVFQUDlE552pwWqXFjOyID2zCFcx3m_AxTRbiyOk/s640/17.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiKmjQcfv0fR2pLP4EdAk_ffFo4tW0r38xDMzdI5dsx0v24KlbyXpZGrtZl4tkWyW18f3mIncLidTXFL2UX_Wj16IVPRQzRwIZHXn7pVFQUDlE552pwWqXFjOyID2zCFcx3m_AxTRbiyOk/s1050/17.png)

Ok. So: in my opinion I wasn't able to *escape* from new version of PHPMailer available in NagiosXI. That was the reason (but feel free to correct me (and my payload ;)) if I'm wrong).

Few more pages to read I found for example here:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhL4Zs7oXkcrAANFVYvOBMyG2Ag2W_dduiuSU51yp6w1mrNr_9Gy-H1_724_AdJqhRz1EEL6jpeOJbtN2wdUVnbyN_CfoSed58-cmj6b3w5kab-Gfz8wV9uvyj3qWje0OjUueXzghk7UXo/s640/18.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhL4Zs7oXkcrAANFVYvOBMyG2Ag2W_dduiuSU51yp6w1mrNr_9Gy-H1_724_AdJqhRz1EEL6jpeOJbtN2wdUVnbyN_CfoSed58-cmj6b3w5kab-Gfz8wV9uvyj3qWje0OjUueXzghk7UXo/s845/18.png)

Sample logs:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjQrNEvyQau1hQj6FoSqhpi5F-DHaaWd0GcYr31wND-Gr8_UHHdsIuGsc-cFD4T5BX6o8YHfFDi0ROth3DWOlneU6NC78uPV8e4ChX6RhNN3AiIaflmmPaUaZ14ftMwXWh_vqH4EaDCaPY/s640/19.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjQrNEvyQau1hQj6FoSqhpi5F-DHaaWd0GcYr31wND-Gr8_UHHdsIuGsc-cFD4T5BX6o8YHfFDi0ROth3DWOlneU6NC78uPV8e4ChX6RhNN3AiIaflmmPaUaZ14ftMwXWh_vqH4EaDCaPY/s1330/19.png)

BTW: you can also (re)send your 'emails' (payloads) using 'My Scheduled Reports', check it out:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgd2WC8JfjOqiPi659BvQDomsLGQ0IyIkfJSN0E4bzOltkKrbs6oAFVLnx-pgvCIqhnkDQE7Pqz02SQbOLvWBOuxP6SNIQcMd0fnOKnPKWI4PoW7Mxdh9HF5hw6THkN9zMAKgatV3Baqcg/s640/20.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgd2WC8JfjOqiPi659BvQDomsLGQ0IyIkfJSN0E4bzOltkKrbs6oAFVLnx-pgvCIqhnkDQE7Pqz02SQbOLvWBOuxP6SNIQcMd0fnOKnPKWI4PoW7Mxdh9HF5hw6THkN9zMAKgatV3Baqcg/s1065/20.png)

Few more example logs:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiQQE7P7hIo1yjPgB5jKpltQ4WlsKIHafipGboCa_editoQI54z87dpgWTpWNSUuXlTyjgSw4o7d6looUqLTlIr6y9CPViE1CGA2_qBozjMz_XOw85Sm0zEpgCGbf9BtmewYY2tE_1DepA/s640/21.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiQQE7P7hIo1yjPgB5jKpltQ4WlsKIHafipGboCa_editoQI54z87dpgWTpWNSUuXlTyjgSw4o7d6looUqLTlIr6y9CPViE1CGA2_qBozjMz_XOw85Sm0zEpgCGbf9BtmewYY2tE_1DepA/s1203/21.png)

At this stage (day6 ;]) I decided to "leave it like this" here and go to the next (possible) bug (I'll found). So that's how I landed in one of the available *Configuration Wizards*:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhWbD4kIY5HNNlIe0Uvvzh-xWwIkftwTjXJ_lLzkFTgPoRldiplJ0UkJmUxX8rogdbRE1QOgBEOilQjukymO5k7l_nwHcQ8zJFZfI2Bt-84sQ1HTBvlwSsfQeKyIogMX2ki7_4ndMXilSs/s640/22.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhWbD4kIY5HNNlIe0Uvvzh-xWwIkftwTjXJ_lLzkFTgPoRldiplJ0UkJmUxX8rogdbRE1QOgBEOilQjukymO5k7l_nwHcQ8zJFZfI2Bt-84sQ1HTBvlwSsfQeKyIogMX2ki7_4ndMXilSs/s1065/22.png)

I decided to give it a try (and prepare similar payload):

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjg5ZmicxyTqCa2GdQFOc58pMo_7cUcOzggUwvaSd4ETpyChxSAh9gsxBjX9S6w08oRcUxGAopVOdSOdZjXre0UBvH3q-OXp2POxC4fdLW73DtkBKE0DR3pgbMMAInRiLMYni9FvThS8zY/s640/23.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjg5ZmicxyTqCa2GdQFOc58pMo_7cUcOzggUwvaSd4ETpyChxSAh9gsxBjX9S6w08oRcUxGAopVOdSOdZjXre0UBvH3q-OXp2POxC4fdLW73DtkBKE0DR3pgbMMAInRiLMYni9FvThS8zY/s1233/23.png)

As you can see (last line on the screen above) there is an ***echo-output*** **;D** of the command we tried to use. ;] Great, let's try one more time:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhBtJ3PAoBCpK46A40G5qPkvYV28u1PkM8BBbxcRL0geQxIJYaH96aZpSP4wNz6PgR5tDPjH3lvX_H8DpD7v-25N9nxHIpcWJAm_zf0hrrH94-2gS49PWfJxwdWhVtO8x8BYOnheZt7FV4/s640/24.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhBtJ3PAoBCpK46A40G5qPkvYV28u1PkM8BBbxcRL0geQxIJYaH96aZpSP4wNz6PgR5tDPjH3lvX_H8DpD7v-25N9nxHIpcWJAm_zf0hrrH94-2gS49PWfJxwdWhVtO8x8BYOnheZt7FV4/s1034/24.png)

This time we should be here:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgy0cmTD1MkW_JZDhJaDbhtI2DznZ_o9SkSDp_UnaIHSQyHKBM5-z5sAr7T_8elQLl1V4-RxNgMS2SIxjM1T0KQpU9OxVTpoRJi2TM15TOs_7aY0h5lk0HTe1XdArksQNa-6FMdHQBlw7s/s640/25.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgy0cmTD1MkW_JZDhJaDbhtI2DznZ_o9SkSDp_UnaIHSQyHKBM5-z5sAr7T_8elQLl1V4-RxNgMS2SIxjM1T0KQpU9OxVTpoRJi2TM15TOs_7aY0h5lk0HTe1XdArksQNa-6FMdHQBlw7s/s1823/25.png)

Ok, again:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRSYOXUua0YTsjAmHCYCBl91MPzOtEslA8HMzdHUS4hmhjlZoWlkcSdZm_e-uZsTtArs_3aPNe5p1CFjdZtLz42RYO5V10x8HkGmJ2b7hEv0rKpNF3zV18YPE9Bb49lgJSaV_wFOvPLlc/s640/26.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiRSYOXUua0YTsjAmHCYCBl91MPzOtEslA8HMzdHUS4hmhjlZoWlkcSdZm_e-uZsTtArs_3aPNe5p1CFjdZtLz42RYO5V10x8HkGmJ2b7hEv0rKpNF3zV18YPE9Bb49lgJSaV_wFOvPLlc/s1155/26.png)

[; I think [we're already there](https://www.youtube.com/watch?v=oXWUQdoTmKw)... ;] Checking:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg5cKjZpHta1S51bWyAktjUF4YXVpTQx1eXu8IY-UzfiEiH7SU4yv2k-kitrF8dtT5tH0KRAFlc4n4VDZGBm55XUBgfW3Y21_XXouTFiTFvLTIqdPCmcb-57eFRv8K3wSmVQhH_c0nbCvQ/s640/27.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg5cKjZpHta1S51bWyAktjUF4YXVpTQx1eXu8IY-UzfiEiH7SU4yv2k-kitrF8dtT5tH0KRAFlc4n4VDZGBm55XUBgfW3Y21_XXouTFiTFvLTIqdPCmcb-57eFRv8K3wSmVQhH_c0nbCvQ/s1811/27.png)

(Yep, I saw *fopen()* so I tried to read some passwd ;))

Now:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEin0Ow5_ckod5qr3d6SybRBWaRv32seG7FEJK6ProH6oJUsLtr1QwJby0eXqrd40OMXnboRm_Sg8AQ-Cy6cJ0nTKyM7vsSMGuRixAKBiQSVwMAD6hXVz8faaER9z841H6txHf-BfkefGOo/s640/28.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEin0Ow5_ckod5qr3d6SybRBWaRv32seG7FEJK6ProH6oJUsLtr1QwJby0eXqrd40OMXnboRm_Sg8AQ-Cy6cJ0nTKyM7vsSMGuRixAKBiQSVwMAD6hXVz8faaER9z841H6txHf-BfkefGOo/s1791/28.png)

Bingo! ;]

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgosTmYwo5ly6mXxeKDB3P3YuwCKa_v8cPzNuN-T_p1e_01E_WPiFiCuj1FRKA5zx9xm8KmFLaYo5leMUZ1p4n3U_ZUofPimkVDuI6weJY83OmYXS-tkddWEBFf-TiuAC3VWzUPHzOWj1E/s640/29.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgosTmYwo5ly6mXxeKDB3P3YuwCKa_v8cPzNuN-T_p1e_01E_WPiFiCuj1FRKA5zx9xm8KmFLaYo5leMUZ1p4n3U_ZUofPimkVDuI6weJY83OmYXS-tkddWEBFf-TiuAC3VWzUPHzOWj1E/s1560/29.png)

Using [few old tricks](https://code610.blogspot.com/p/ctfs.html) (like payload+base64+|sh) we should be somewhere here:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi-aOku-vu93dFIXxUFWPxtuwzhu8J9veGT9mLMMR6VvB1qFOxkS8XACghStsMp-D_1yz1_si6hCkZTQMBkhagvly4cdazEOCTapD-kqB5zjH9UczH5kJN8yvAOhS73npkT1mJg3ZF7jV4/s640/30.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi-aOku-vu93dFIXxUFWPxtuwzhu8J9veGT9mLMMR6VvB1qFOxkS8XACghStsMp-D_1yz1_si6hCkZTQMBkhagvly4cdazEOCTapD-kqB5zjH9UczH5kJN8yvAOhS73npkT1mJg3ZF7jV4/s901/30.png)

[Waiting](https://www.youtube.com/watch?v=OQMVYs0JwQI):

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhfFSHcDI6U4rSqDYcg15rt0IPrdOYPweHC3CLLDNGaByntaJAc7nI6DdQkm4Dbq721PD8uwEZM050CKaAMeoOQhRJGDMVWYGYjtsRt6OtMD6zBQ-LKdTS1LeI5Wcib1TSBF1aTipcR5ME/s640/32.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhfFSHcDI6U4rSqDYcg15rt0IPrdOYPweHC3CLLDNGaByntaJAc7nI6DdQkm4Dbq721PD8uwEZM050CKaAMeoOQhRJGDMVWYGYjtsRt6OtMD6zBQ-LKdTS1LeI5Wcib1TSBF1aTipcR5ME/s1197/32.png)

I think we'll stop here.

Special thanks goes to **[my Patreon](https://patreon.com/CodySixteen): Daniel.**

**Thanks! You are awesome! ;)**

See you next time!

[Cheers](https://twitter.com/CodySixteen)

Posted by

[code16](https://www.blogger.com/profile/10414695159301496862 "author profile")

at

[09:29](https://code610.blogspot.com/2020/08/postauth-rce-in-nagios-572.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/4457504812250871322/229758173213514531 "Wyślij posta przez e-mail")

[Wyślij pocztą e-mail](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=229758173213514531&target=email "Wyślij pocztą e-mail")[Wrzuć na bloga](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=229758173213514531&target=blog "Wrzuć na bloga")[Udostępnij w X](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=229758173213514531&target=twitter "Udostępnij w X")[Udostępnij w usłudze Facebook](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=229758173213514531&target=facebook "Udostępnij w usłudze Facebook")[Udostępnij w serwisie Pinterest](https://www.blogger.com/share-post.g?blogID=4457504812250871322&postID=229758173213514531&target=pinterest "Udostępnij w serwisie Pinterest")

Labels:
[debug](https://code610.blogspot.com/search/label/debug),
[infrastructure](https://code610.blogspot.com/search/label/infrastructure),
[notes](https://code610.blogspot.com/search/label/notes),
[pentest](https://code610.blogspot.com/search/label/pentest),
[pwn](https://code610.blogspot.com/search/label/pwn),
[web](https://code610.blogspot.com/search/label/web),
[writeup](https://code610.blogspot.com/search/label/writeup)

#### Brak komentarzy:

#### Prześlij komentarz

[Nowszy post](https://code610.blogspot.com/2020/08/basic-pentest-lab-with-docker.html "Nowszy post")

[Starszy post](https://code610.blogspot.com/2020/08/scheduling-checkpoint-gaia.html "Starszy post")

[Strona główna](https://code610.blogspot.com/)

Subskrybuj:
[Komentarze do posta (Atom)](https://code610.blogspot.com/feeds/229758173213514531/comments/default)

## O mnie

[![Moje zdjęcie](//blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgxTLkJwUjO012n0PeP9QOXHkiKVBchiASFL9T6Rad6IsRCwX5CEz_v6pEQP3C_7HRetAZ72fNNZmenletYgK1cYrMKZoAzT0KOEPKauvcQIEq3lsP873D8edyRzITkefA/s113/koszulka.jpg)](https://www.blogger.com/profile/10414695159301496862)
[code16](https://www.blogger.com/profile/10414695159301496862)

Cody Sixteen

[Wyświetl mój pełny profil](https://www.blogger.com/profile/10414695159301496862)

## Archiwum bloga

* ►
  [2024](https://code610.blogspot.com/2024/)
  (10)
  + ►
    [12](https://code610.blogspot.com/2024/12/)
    (1)
  + ►
    [10](https://code610.blogspot.com/2024/10/)
    (2)
  + ►
    [09](https://code610.blogspot.com/2024/09/)
    (1)
  + ►
    [07](https://code610.blogspot.com/2024/07/)
    (2)
  + ►
    [04](https://code610.blogspot.com/2024/04/)
    (2)
  + ►
    [01](https://code610.blogspot.com/2024/01/)
    (2)

* ►
  [2023](https://code610.blogspot.com/2023/)
  (14)
  + ►
    [12](https://code610.blogspot.com/2023/12/)
    (3)
  + ►
    [11](https://code610.blogspot.com/2023/11/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2023/05/)
    (1)
  + ►
    [04](https://code610.blogspot.com/2023/04/)
    (9)

* ►
  [2022](https://code610.blogspot.com/2022/)
  (16)
  + ►
    [09](https://code610.blogspot.com/2022/09/)
    (1)
  + ►
    [07](https://code610.blogspot.com/2022/07/)
    (3)
  + ►
    [06](https://code610.blogspot.com/2022/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2022/05/)
    (1)
  + ►
    [04](https://code610.blogspot.com/2022/04/)
    (7)
  + ►
    [03](https://code610.blogspot.com/2022/03/)
    (1)
  + ►
    [02](https://code610.blogspot.com/2022/02/)
    (2)

* ►
  [2021](https://code610.blogspot.com/2021/)
  (37)
  + ►
    [12](https://code610.blogspot.com/2021/12/)
    (1)
  + ►
    [11](https://code610.blogspot.com/2021/11/)
    (1)
  + ►
    [10](https://code610.blogspot.com/2021/10/)
    (2)
  + ►
    [09](https://code610.blogspot.com/2021/09/)
    (3)
  + ►
    [08](https://code610.blogspot.com/2021/08/)
    (8)
  + ►
    [07](https://code610.blogspot.com/2021/07/)
    (3)
  + ►
    [06](https://code610.blogspot.com/2021/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2021/05/)
    (7)
  + ►
    [04](https://code610.blogspot.com/2021/04/)
    (2)
  + ►
    [03](https://code610.blogspot.com/2021/03/)
    (5)
  + ►
    [02](https://code610.blogspot.com/2021/02/)
    (2)
  + ►
    [01](https://code610.blogspot.com/2021/01/)
    (2)

* ▼
  [2020](https://code610.blogspot.com/2020/)
  (62)
  + ►
    [12](https://code610.blogspot.com/2020/12/)
    (1)
  + ►
    [11](https://code610.blogspot.com/2020/11/)
    (2)
  + ►
    [10](https://code610.blogspot.com/2020/10/)
    (1)
  + ►
    [09](https://code610.blogspot.com/2020/09/)
    (2)
  + ▼
    [08](https://code610.blogspot.com/2020/08/)
    (5)
    - [Scanning Docker Images](https://code610.blogspot.com/2020/08/scanning-docker-images.html)
    - [Creating your first CTF VM](https://code610.blogspot.com/2020/08/creating-your-first-ctf-vm.html)
    - [Basic Pentest Lab with Docker](https://code610.blogspot.com/2020/08/basic-pentest-lab-with-docker.html)
    - [Postauth RCE in Nagios 5.7.2](https://code610.blogspot.com/2020/08/postauth-rce-in-nagios-572.html)
    - [Scheduling Checkpoint Gaia](https://code610.blogspot.com/2020/08/scheduling-checkpoint-gaia.html)
  + ►
    [07](https://code610.blogspot.com/2020/07/)
    (5)
  + ►
    [06](https://code610.blogspot.com/2020/06/)
    (7)
  + ►
    [05](https://code610.blogspot.com/2020/05/)
    (5)
  + ►
    [04](https://code610.blogspot.com/2020/04/)
    (11)
  + ►
    [03](https://code610.blogspot.com/2020/03/)
    (10)
  + ►
    [02](https://code610.blogspot.com/2020/02/)
    (6)
  + ►
    [01](https://code610.blogspot.com/2020/01/)
    (7)

* ►
  [2019](https://code610.blogspot.com/2019/)
  (97)
  + ►
    [12](https://code610.blogspot.com/2019/12/)
    (4)
  + ►
    [11](https://code610.blogspot.com/2019/11/)
    (9)
  + ►
    [10](https://code610.blogspot.com/2019/10/)
    (8)
  + ►
    [09](https://code610.blogspot.com/2019/09/)
    (5)
  + ►
    [08](https://code610.blogspot.com/2019/08/)
    (20)
  + ►
    [07](https://code610.blogspot.com/2019/07/)
    (10)
  + ►
    [06](https://code610.blogspot.com/2019/06/)
    (3)
  + ►
    [05](https://code610.blogspot.com/2019/05/)
    (8)
  + ►
    [03](https://code610.blogspot.com/2019/03/)
    (15)
  + ►
    [02](https://code610.blogspot.com/2019/02/)
    (5)
  + ►
    [01](https://code610.blogspot.com/2019/01/)
    (10)

* ►
  [2018](https://code610.blogspot.com/2018/)
  (67)
  + ►
    [12](https://code610.blogspot.com/2018/12/)
    (13)
  + ►
    [11](https://code610.blogspot.com/2018/11/)
    (4)
  + ►
    [10](https://code610.blogspot.com/2018/10/)
    (3)
  + ►
    [09](https://code610.blogspot.com/2018/09/)
    (4)
  + ►
    [08](https://code610.blogspot.com/2018/08/)
    (7)
  + ►
    [07](https://code610.blogspot.com/2018/07/)
    (9)
  + ►
    [06](https://code610.blogspot.com/2018/06/)
    (7)
  + ►
    [05](https://code610.blogspot.com/2018/05/)
    (1)
  + ►
    [04](https://code610.blogspot.com/2018/04/)
    (2)
  + ►
    [03](https://code610.blogspot.com/2018/03/)
    (7)
  + ►
    [01](https://code610.blogspot.com/2018/01/)
    (10)

* ►
  [2017](https://code610.blogspot.com/2017/)
  (58)
  + ►
    [12](https://code610.blogspot.com/2017/12/)
    (3)
  + ►
    [11](https://code610.blogspot.com/2017/11/)
    (5)
  + ►
    [10](https://code610.blogspot.com/2017/10/)
    (9)
  + ►
    [09](https://code610.blogspot.com/2017/09/)
    (3)
  + ►
    [08](https://code610.blogspot.com/2017/08/)
    (11)
  + ►
    [07](https://code610.blogspot.com/2017/07/)
    (4)
  + ►
    [06](https://code610.blogspot.com/2017/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2017/05/)
    (10)
  + ►
    [04](https://code610.blogspot.com/2017/04/)
    (5)
  + ►
    [02](https://code610.blogspot.com/2017/02/)
    (1)
  + ►
    [01](https://code610.blogspot.com/2017/01/)
    (6)

* ►
  [2016](https://code610.blogspot.com/2016/)
  (63)
  + ►
    [12](https://code610.blogspot.com/2016/12/)
    (2)
  + ►
    [11](https://code610.blogspot.com/2016/11/)
    (5)
  + ►
    [10](https://code610.blogspot.com/2016/10/)
    (6)
  + ►
    [09](https://code610.blogspot.com/2016/09/)
    (8)
  + ►
    [08](https://code610.blogspot.com/2016/08/)
    (6)
  + ►
    [07](https://code610.blogspot.com/2016/07/)
    (12)
  + ►
    [06](https://code610.blogspot.com/2016/06/)
    (1)
  + ►
    [05](https://code610.blogspot.com/2016/05/)
    (23)

## Etykiety

* [.net](https://code610.blogspot.com/search/label/.net)
* [android](https://code610.blogspot.com/search/label/android)
* [binary](https://code610.blogspot.com/search/label/binary)
* [crackme](https://code610.blogspot.com/search/label/crackme)
* [ctf](https://code610.blogspot.com/search/label/ctf)
* [debug](https://code610.blogspot.com/search/label/debug)
* [docker](https://code610.blogspot.com/search/label/docker)
* [drones](https://code610.blogspot.com/search/label/drones)
* [enlil](https://code610.blogspot.com/search/label/enlil)
* [FortiGate](https://code610.blogspot.com/search/label/FortiGate)
* [fuzz](https://code610.blogspot.com/search/label/fuzz)
* [infrastructure](https://code610.blogspot.com/search/label/infrastructure)
* [malware](https://code610.blogspot.com/search/label/malware)
* [notes](https://code610.blogspot.com/search/label/notes)
* [pentest](https://code610.blogspot.com/search/label/pentest)
* [poc](https://code610.blogspot.com/search/label/poc)
* [pwn](https://code610.blogspot.com/search/label/pwn)
* [RE](https://code610.blogspot.com/search/label/RE)
* [web](https://code610.blogspot.com/search/label/web)
* [writeup](https://code610.blogspot.com/search/label/writeup)

|  |  |
| --- | --- |

Motyw Okno obrazu. Obsługiwane przez usługę [Blogger](https://www.blogger.com).


