=== Content from doc.powerdns.com_b7aad800_20250119_120455.html ===

### Navigation

* [index](../genindex.html "General Index")
* [routing table](../http-routingtable.html "HTTP Routing Table") |
* [next](powerdns-advisory-2021-01.html "PowerDNS Security Advisory 2021-01: Specific query crashes Authoritative Server") |
* [previous](powerdns-advisory-2020-05.html "PowerDNS Security Advisory 2020-05: Leaking uninitialised memory through crafted zone records") |
* [PowerDNS Authoritative Server documentation](../indexTOC.html) »
* [Security Advisories](index.html) »

[PowerDNS Authoritative Server](../indexTOC.html)

#### Previous topic

[PowerDNS Security Advisory 2020-05: Leaking uninitialised memory through crafted zone records](powerdns-advisory-2020-05.html "previous chapter")

#### Next topic

[PowerDNS Security Advisory 2021-01: Specific query crashes Authoritative Server](powerdns-advisory-2021-01.html "next chapter")

## Contents

* [PowerDNS Authoritative Nameserver](../index.html)
* [Installing PowerDNS](../installation.html)
* [Upgrade Notes](../upgrading.html)
* [DNS Modes of Operation](../modes-of-operation.html)
* [Migrating to PowerDNS](../migration.html)
* [Running and Operating](../running.html)
* [Security of PowerDNS](../security.html)
* [Performance and Tuning](../performance.html)
* [DNSSEC](../dnssec/index.html)
* [Per zone settings: Domain Metadata](../domainmetadata.html)
* [Dynamic DNS Update (RFC 2136)](../dnsupdate.html)
* [Catalog Zones (RFC 9432)](../catalog.html)
* [TSIG](../tsig.html)
* [Lua Records](../lua-records/index.html)
* [Guides and How Tos](../guides/index.html)
* [Backends](../backends/index.html)
* [Built-in Webserver and HTTP API](../http-api/index.html)
* [Manual Pages](../manpages/index.html)
* [Authoritative Server Settings](../settings.html)
* [Security Advisories](index.html)
  + [PowerDNS Security Advisory 2022-01: incomplete validation of incoming IXFR transfer in Authoritative Server and Recursor](powerdns-advisory-2022-01.html)
  + [PowerDNS Security Advisory 2021-01: Specific query crashes Authoritative Server](powerdns-advisory-2021-01.html)
  + PowerDNS Security Advisory 2020-06: Various issues in our GSS-TSIG support
  + [PowerDNS Security Advisory 2020-05: Leaking uninitialised memory through crafted zone records](powerdns-advisory-2020-05.html)
  + [PowerDNS Security Advisory 2019-06: Denial of service via crafted zone records](powerdns-advisory-2019-06.html)
  + [PowerDNS Security Advisory 2019-05: Denial of service via NOTIFY packets](powerdns-advisory-2019-05.html)
  + [PowerDNS Security Advisory 2019-04: Denial of service via crafted zone records](powerdns-advisory-2019-04.html)
  + [PowerDNS Security Advisory 2019-03: Insufficient validation in the HTTP remote backend](powerdns-advisory-2019-03.html)
  + [PowerDNS Security Advisory 2018-05: Packet cache pollution via crafted query](powerdns-advisory-2018-05.html)
  + [PowerDNS Security Advisory 2018-03: Crafted zone record can cause a denial of service](powerdns-advisory-2018-03.html)
  + [PowerDNS Security Advisory 2018-02: Buffer overflow in dnsreplay](powerdns-advisory-2018-02.html)
  + [PowerDNS Security Advisory 2017-04: Missing check on API operations](powerdns-advisory-2017-04.html)
  + [PowerDNS Security Advisory 2016-05: Crafted zone record can cause a denial of service](powerdns-advisory-2016-05.html)
  + [PowerDNS Security Advisory 2016-04: Insufficient validation of TSIG signatures](powerdns-advisory-2016-04.html)
  + [PowerDNS Security Advisory 2016-03: Denial of service via the web server](powerdns-advisory-2016-03.html)
  + [PowerDNS Security Advisory 2016-02: Crafted queries can cause abnormal CPU usage](powerdns-advisory-2016-02.html)
  + [PowerDNS Security Advisory 2016-01: Crafted queries can cause unexpected backend load](powerdns-advisory-2016-01.html)
  + [PowerDNS Security Advisory 2015-03: Packet parsing bug can lead to crashes](powerdns-advisory-2015-03.html)
  + [PowerDNS Security Advisory 2015-02: Packet parsing bug can cause thread or process abortion](powerdns-advisory-2015-02.html)
  + [PowerDNS Security Advisory 2015-01: Label decompression bug can cause crashes or CPU spikes](powerdns-advisory-2015-01.html)
  + [PowerDNS Security Advisory 2012-01: PowerDNS Authoritative Server can be caused to generate a traffic loop](powerdns-advisory-2012-01.html)
  + [PowerDNS Security Advisory 2008-03: Some PowerDNS Configurations can be forced to restart remotely](powerdns-advisory-2008-03.html)
  + [PowerDNS Security Advisory 2008-02: By not responding to certain queries, domains become easier to spoof](powerdns-advisory-2008-02.html)
  + [Older security advisories](index.html#older-security-advisories)
* [Changelogs](../changelog/index.html)
* [End of life statements](../appendices/EOL.html)
* [Frequently Asked Questions](../appendices/FAQ.html)
* [Backend writersâ guide](../appendices/backend-writers-guide.html)
* [Compiling PowerDNS](../appendices/compiling.html)
* [Cryptographic software and export control](../appendices/crypto-export.html)
* [Internals](../appendices/internals.html)
* [Supported Record Types](../appendices/types.html)
* [PowerDNS/dnsdist license](../common/license.html)

### This Page

* [Show Source](../_sources/security-advisories/powerdns-advisory-2020-06.rst.txt)

1. [Docs](../indexTOC.html)
2. [Security Advisories](index.html)
3. PowerDNS Security Advisory 2020-06: Various issues in our GSS-TSIG support

# PowerDNS Security Advisory 2020-06: Various issues in our GSS-TSIG support[Â¶](#powerdns-security-advisory-2020-06-various-issues-in-our-gss-tsig-support "Permalink to this headline")

* CVE: CVE-2020-24696, CVE-2020-24697, CVE-2020-24698
* Date: September 22nd, 2020
* Affects: PowerDNS Authoritative versions before 4.4.0, when compiled with âenable-experimental-gss-tsig
* Not affected: 4.4.0 and up, and any version compiled without GSS-TSIG support
* Severity: Low
* Impact: Crashes, Information Leaks, Possible code execution
* Exploit: This problem can be triggered via crafted packets
* Risk of system compromise: Low
* Solution: Do not use software built with GSS-TSIG support

Various issues have been found in our GSS-TSIG support, where an unauthorized attacker could cause crashes, possibly leak uninitialised memory, and possibly execute arbitrary code.

These issues have been assigned:

* CVE-2020-24696: A remote, unauthenticated attacker can trigger a race condition leading to a crash, or possibly arbitrary code execution, by sending crafted queries with a GSS-TSIG signature.
* CVE-2020-24697: A remote, unauthenticated attacker can cause a denial of service by sending crafted queries with a GSS-TSIG signature.
* CVE-2020-24698: A remote, unauthenticated attacker might be able to cause a double-free, leading to a crash or possibly arbitrary code execution by sending crafted queries with a GSS-TSIG signature.

All PowerDNS Authoritative versions are affected, but *only* if they have been compiled with `--enable-experimental-gss-tsig`.
We have never published packages with the feature enabled.

Because of the various issues with the feature (including a complete lack of testing code around it), and no reports of production usage of GSS-TSIG, we have decided to remove the relevant code completely in PowerDNS Authoritative 4.4.0.
Users of earlier versions that rely on the feature can keep doing so until they upgrade to 4.4.0, but need to be aware of these issues.

We would like to thank Nathaniel Ferguson for finding and subsequently reporting these issues!

[PowerDNS Security Advisory 2020-05: Leaking uninitialised memory through crafted zone records](powerdns-advisory-2020-05.html "previous chapter (use the left arrow)")

[PowerDNS Security Advisory 2021-01: Specific query crashes Authoritative Server](powerdns-advisory-2021-01.html "next chapter (use the right arrow)")

### Navigation

* [index](../genindex.html "General Index")
* [routing table](../http-routingtable.html "HTTP Routing Table") |
* [next](powerdns-advisory-2021-01.html "PowerDNS Security Advisory 2021-01: Specific query crashes Authoritative Server") |
* [previous](powerdns-advisory-2020-05.html "PowerDNS Security Advisory 2020-05: Leaking uninitialised memory through crafted zone records") |
* [PowerDNS Authoritative Server documentation](../indexTOC.html) »
* [Security Advisories](index.html) »

© Copyright PowerDNS.COM BV. Created using [Sphinx](http://sphinx.pocoo.org/).


