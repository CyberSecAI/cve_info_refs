=== Content from blackbatsec.medium.com_8a9c9c7b_20250119_125120.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Feea175e147f0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fblackbatsec.medium.com%2Fcve-2020-24881-server-side-request-forgery-in-osticket-eea175e147f0&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fblackbatsec.medium.com%2Fcve-2020-24881-server-side-request-forgery-in-osticket-eea175e147f0&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE-2020‚Äì24881: Server Side Request Forgery in OsTicket

[![Talatmehmood](https://miro.medium.com/v2/resize:fill:88:88/2*hEbPvjmy_XMBEIVePKcqYQ.png)](/?source=post_page---byline--eea175e147f0--------------------------------)

[Talatmehmood](/?source=post_page---byline--eea175e147f0--------------------------------)

¬∑

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F867ee9767cce&operation=register&redirect=https%3A%2F%2Fblackbatsec.medium.com%2Fcve-2020-24881-server-side-request-forgery-in-osticket-eea175e147f0&user=Talatmehmood&userId=867ee9767cce&source=post_page-867ee9767cce--byline--eea175e147f0---------------------post_header-----------)

2 min read¬∑Nov 2, 2020

--

1

Listen

Share

![]()
# Server Side Request Forgery in OsTicket

Hello guys, I hope everyone is doing great! A little introduction about me, My name is [Talat Mehmood](https://www.linkedin.com/in/talat-mehmood-1a10b2142/) and I‚Äôm an active bounty hunter, Freelancer and Penetration tester since 2017.

While working on a Penetration Testing Project (let‚Äôs say abc company), I came across their support portal. They were using OsTicket 1.12.x. On digging further, I discovered that ‚ÄúPrint‚Äù module is vulnerable to Server Side Request Forgery (SSRF). I‚Äôll try to keep this writeup as simple as possible.

> Server-side request forgery (also known as SSRF) is a web security vulnerability that allows an attacker to induce the server-side application to make HTTP requests to an arbitrary domain of the attacker‚Äôs choosing

> ‚ÄúosTicket is a widely-used open source support ticket system. It seamlessly integrates inquiries created via email, phone and web-based forms into a simple easy-to-use multi-user web interface. Manage, organize and archive all your support requests and responses in one place.‚Äù

# Exploiting CVE-2020‚Äì24881

1. Login to the osticket customer portal.
2. Click on any ticket [Open or Closed].
3. In ‚ÄúPost a Reply‚Äù section, click on HTML Editor.
4. I tried different HTML elements like **iframe** and **embed** but none of them worked. :( Try using following payload:

***<img src=‚Äúhttps://attacker.com‚Äù>***

5. Post Reply and then click on ‚ÄúPrint‚Äù button and TA-DAA!

![]()

6. You‚Äôll receive a request from the internal IP of victim machine. I used BurpSuite‚Äôs collaborator server and below is the output:

![]()
# Impact

Burp Suite and Acunetix labels SSRF as ‚Äú**High**‚Äù. In this case, we can‚Äôt see an internal resource from victim server since the requested resource will be opened in an image element. However, we can perform port scanning and other SSRF Exploits. For more details about SSRF, please visit following URL:

[## Server side request forgery

### SSRF as in Server Side Request Forgery is a vulnerability that allows an attacker to force server interfaces into‚Ä¶

www.acunetix.com](https://www.acunetix.com/vulnerabilities/web/server-side-request-forgery/?source=post_page-----eea175e147f0--------------------------------)
# Patch

Upgrade to latest version of osticket ( version > v1.14.2) from [vendor website.](https://github.com/osTicket/osTicket)

# Thanks for reading this write-up!

If you liked my write-up please hit **üëè** & share with your friends which will encourage me to publish more Infosec write-ups in future.

Linkedin: <https://www.linkedin.com/in/talat-mehmood-1a10b2142/>

Twitter: <https://twitter.com/Blackbatsecuri1>

[Osticket](https://medium.com/tag/osticket?source=post_page-----eea175e147f0--------------------------------)[Ssrf](https://medium.com/tag/ssrf?source=post_page-----eea175e147f0--------------------------------)[Bug Bounty](https://medium.com/tag/bug-bounty?source=post_page-----eea175e147f0--------------------------------)[24881](https://medium.com/tag/24881?source=post_page-----eea175e147f0--------------------------------)

--

--

1

[![Talatmehmood](https://miro.medium.com/v2/resize:fill:96:96/2*hEbPvjmy_XMBEIVePKcqYQ.png)](/?source=post_page---post_author_info--eea175e147f0--------------------------------)[![Talatmehmood](https://miro.medium.com/v2/resize:fill:128:128/2*hEbPvjmy_XMBEIVePKcqYQ.png)](/?source=post_page---post_author_info--eea175e147f0--------------------------------)Follow[## Written by Talatmehmood](/?source=post_page---post_author_info--eea175e147f0--------------------------------)[81 Followers](/followers?source=post_page---post_author_info--eea175e147f0--------------------------------)¬∑[1 Following](/following?source=post_page---post_author_info--eea175e147f0--------------------------------)

Ethical Hacker | Bug Bounty Hunter | Freelancer

Follow
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----eea175e147f0--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----eea175e147f0--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----eea175e147f0--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----eea175e147f0--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----eea175e147f0--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----eea175e147f0--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----eea175e147f0--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----eea175e147f0--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----eea175e147f0--------------------------------)[Teams](https://medium.com/business?source=post_page-----eea175e147f0--------------------------------)



=== Content from packetstormsecurity.com_df160472_20250119_125119.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUT‚õî 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.

=== Content from github.com_c5c33d91_20250119_125122.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FosTicket%2FosTicket%2Fcommit%2Fd98c2d096aeb8876c6ab2f88317cd371d781f14d)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FosTicket%2FosTicket%2Fcommit%2Fd98c2d096aeb8876c6ab2f88317cd371d781f14d)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=osTicket%2FosTicket)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[osTicket](/osTicket)
/
**[osTicket](/osTicket/osTicket)**
Public

* [Notifications](/login?return_to=%2FosTicket%2FosTicket) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2FosTicket%2FosTicket)
* [Star
   3.3k](/login?return_to=%2FosTicket%2FosTicket)

* [Code](/osTicket/osTicket)
* [Issues
  825](/osTicket/osTicket/issues)
* [Pull requests
  337](/osTicket/osTicket/pulls)
* [Discussions](/osTicket/osTicket/discussions)
* [Actions](/osTicket/osTicket/actions)
* [Projects
  0](/osTicket/osTicket/projects)
* [Wiki](/osTicket/osTicket/wiki)
* [Security](/osTicket/osTicket/security)
* [Insights](/osTicket/osTicket/pulse)

Additional navigation options

* [Code](/osTicket/osTicket)
* [Issues](/osTicket/osTicket/issues)
* [Pull requests](/osTicket/osTicket/pulls)
* [Discussions](/osTicket/osTicket/discussions)
* [Actions](/osTicket/osTicket/actions)
* [Projects](/osTicket/osTicket/projects)
* [Wiki](/osTicket/osTicket/wiki)
* [Security](/osTicket/osTicket/security)
* [Insights](/osTicket/osTicket/pulse)

## Commit

[Permalink](/osTicket/osTicket/commit/d98c2d096aeb8876c6ab2f88317cd371d781f14d)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

ssrf: External Inline Images

[Browse files](/osTicket/osTicket/tree/d98c2d096aeb8876c6ab2f88317cd371d781f14d)
Browse the repository at this point in the history

```
This mitigates an SSRF security vulnerability reported by [Talat
Mehmood](<https://twitter.com/Blackbatsecuri1>) where we do not check if the
src URL for external inline images contain a valid image extension when
displaying. This means if someone puts something like `<img
src="mymalicioussite.com/badscript.js">` in the body of their message, when
someone clicks Show Images or when the ticket is printed the server will
call the src URL to get the "image" data for display. This is a problem as
this could load malicious code/scripts in the browser. This adds a new
setting called `Allow External Images` and if Disabled we will not allow any
external images in Threads. If this setting is Enabled (default), we will
only allow `<img>` src URLs with valid image extensions
(`png`,`jpg`,`jpeg`,`gif`).
```

* Loading branch information

[![@JediKev](https://avatars.githubusercontent.com/u/11823401?s=40&v=4)](/JediKev)

[JediKev](/osTicket/osTicket/commits?author=JediKev "View all commits by JediKev")
committed
Aug 19, 2020

1 parent
[d2491c1](/osTicket/osTicket/commit/d2491c1f2510e55fd37140ecfafa43d6ee19a93d)

commit d98c2d0

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**71 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* include

  + include/class.config.php
    [class.config.php](#diff-0070d3dd8bc6fbb0790ff80a27ee347620cb438b1491f3d4f980b384efd3e407)
  + include/class.format.php
    [class.format.php](#diff-daec24b4d730666279e91b157dbfbe137b7478d9c1f4ac96ddc580b291f8fbe6)
  + include/class.thread.php
    [class.thread.php](#diff-8295050e06760cc0ccfd2604907bb4debfe1e47ba96f9eee469a4c6325f5909b)
  + i18n/en\_US

    - include/i18n/en\_US/config.yaml
      [config.yaml](#diff-ae136d733b87ad298678a7e615ef0189d9f88daf38c98eecedf92690cf76a26f)
    - help/tips

      * include/i18n/en\_US/help/tips/settings.ticket.yaml
        [settings.ticket.yaml](#diff-0cda20931fcad6b2ad59c38967231b9d3bb618b3e95b82135ce41e8e0fc78b40)
  + staff

    - include/staff/settings-tickets.inc.php
      [settings-tickets.inc.php](#diff-479863701853bc7d2047597a434758f66dc2dacfb6c71b87c325e5edd240121c)

## There are no files selected for viewing

6 changes: 6 additions & 0 deletions

6
[include/class.config.php](#diff-0070d3dd8bc6fbb0790ff80a27ee347620cb438b1491f3d4f980b384efd3e407 "include/class.config.php")

Show comments

[View file](/osTicket/osTicket/blob/d98c2d096aeb8876c6ab2f88317cd371d781f14d/include/class.config.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -230,6 +230,7 @@ class OsticketConfig extends Config { |
|  |  | 'max\_open\_tickets' => 0, |
|  |  | 'files\_req\_auth' => 1, |
|  |  | 'force\_https' => '', |
|  |  | 'allow\_external\_images' => 1, |
|  |  | ); |
|  |  |  |
|  |  | function \_\_construct($section=null) { |
| Expand Down  Expand Up | | @@ -1035,6 +1036,10 @@ function requireTopicToClose() { |
|  |  | return $this->get('require\_topic\_to\_close'); |
|  |  | } |
|  |  |  |
|  |  | function allowExternalImages() { |
|  |  | return ($this->get('allow\_external\_images')); |
|  |  | } |
|  |  |  |
|  |  | function getDefaultTicketQueueId() { |
|  |  | return $this->get('default\_ticket\_queue', 1); |
|  |  | } |
| Expand Down  Expand Up | | @@ -1417,6 +1422,7 @@ function updateTicketsSettings($vars, &$errors) { |
|  |  | 'allow\_client\_updates'=>isset($vars['allow\_client\_updates'])?1:0, |
|  |  | 'ticket\_lock' => $vars['ticket\_lock'], |
|  |  | 'default\_ticket\_queue'=>$vars['default\_ticket\_queue'], |
|  |  | 'allow\_external\_images'=>isset($vars['allow\_external\_images'])?1:0, |
|  |  | )); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

49 changes: 44 additions & 5 deletions

49
[include/class.format.php](#diff-daec24b4d730666279e91b157dbfbe137b7478d9c1f4ac96ddc580b291f8fbe6 "include/class.format.php")

Show comments

[View file](/osTicket/osTicket/blob/d98c2d096aeb8876c6ab2f88317cd371d781f14d/include/class.format.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -411,13 +411,29 @@ function input($var) { |
|  |  |  |
|  |  | //Format text for display.. |
|  |  | function display($text, $inline\_images=true, $balance=true) { |
|  |  | global $cfg; |
|  |  |  |
|  |  | // Exclude external images? |
|  |  | $exclude = !$cfg->allowExternalImages(); |
|  |  | // Allowed image extensions |
|  |  | $allowed = array('gif', 'png', 'jpg', 'jpeg'); |
|  |  |  |
|  |  | // Make showing offsite images optional |
|  |  | $text = preg\_replace\_callback('/<img ([^>]\*)(src="http[^"]+")([^>]\*)\/>/', |
|  |  | function($match) { |
|  |  | // Drop embedded classes -- they don't refer to ours |
|  |  | $match = preg\_replace('/class="[^"]\*"/', '', $match); |
|  |  | return sprintf('<span %s class="non-local-image" data-%s %s></span>', |
|  |  | $match[1], $match[2], $match[3]); |
|  |  | function($match) use ($exclude, $allowed) { |
|  |  | $m = array(); |
|  |  | // Split the src URL and get the extension |
|  |  | preg\_match('/src="([^"]+)"/', $match[2], $m); |
|  |  | $url = explode('.', explode('?', $m[1])[0]); |
|  |  | $ext = preg\_split('/[^A-Za-z]/', end($url))[0]; |
|  |  |  |
|  |  | if (!$exclude && in\_array($ext, $allowed)) { |
|  |  | // Drop embedded classes -- they don't refer to ours |
|  |  | $match = preg\_replace('/class="[^"]\*"/', '', $match); |
|  |  | return sprintf('<span %s class="non-local-image" data-%s %s></span>', |
|  |  | $match[1], $match[2], $match[3]); |
|  |  | } else |
|  |  | return ''; |
|  |  | }, |
|  |  | $text); |
|  |  |  |
| Expand All | | @@ -433,6 +449,29 @@ function($match) { |
|  |  | return $text; |
|  |  | } |
|  |  |  |
|  |  | function stripExternalImages($input, $display=false) { |
|  |  | global $cfg; |
|  |  |  |
|  |  | // Allowed Inline External Image Extensions |
|  |  | $allowed = array('gif', 'png', 'jpg', 'jpeg'); |
|  |  | $exclude = !$cfg->allowExternalImages(); |
|  |  |  |
|  |  | $input = preg\_replace\_callback('/<img ([^>]\*)(src="([^"]+)")([^>]\*)\/?>/', |
|  |  | function($match) use ($allowed, $exclude, $display) { |
|  |  | // Split the src URL and get the extension |
|  |  | $url = explode('.', explode('?', $match[3])[0]); |
|  |  | $ext = preg\_split('/[^A-Za-z]/', end($url))[0]; |
|  |  |  |
|  |  | if (($exclude && $display) || !in\_array($ext, $allowed)) |
|  |  | return ''; |
|  |  | else |
|  |  | return $match[0]; |
|  |  | }, |
|  |  | $input); |
|  |  |  |
|  |  | return $input; |
|  |  | } |
|  |  |  |
|  |  | function striptags($var, $decode=true) { |
|  |  |  |
|  |  | if(is\_array($var)) |
| Expand Down | |  |

5 changes: 4 additions & 1 deletion

5
[include/class.thread.php](#diff-8295050e06760cc0ccfd2604907bb4debfe1e47ba96f9eee469a4c6325f5909b "include/class.thread.php")

Show comments

[View file](/osTicket/osTicket/blob/d98c2d096aeb8876c6ab2f88317cd371d781f14d/include/class.thread.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1647,6 +1647,9 @@ static function create($vars=false) { |
|  |  | if (!($body = Format::strip\_emoticons($vars['body']->getClean()))) |
|  |  | $body = '-'; //Special tag used to signify empty message as stored. |
|  |  |  |
|  |  | // Ensure valid external images |
|  |  | $body = Format::stripExternalImages($body); |
|  |  |  |
|  |  | $poster = $vars['poster']; |
|  |  | if ($poster && is\_object($poster)) |
|  |  | $poster = (string) $poster; |
| Expand Down  Expand Up | | @@ -2890,7 +2893,7 @@ function display($output=false) { |
|  |  | case 'email': |
|  |  | return $this->body; |
|  |  | case 'pdf': |
|  |  | return Format::clickableurls($this->body); |
|  |  | return Format::clickableurls(Format::stripExternalImages($this->body, true)); |
|  |  | default: |
|  |  | return Format::display($this->body, true, !$this->options['balanced']); |
|  |  | } |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[include/i18n/en\_US/config.yaml](#diff-ae136d733b87ad298678a7e615ef0189d9f88daf38c98eecedf92690cf76a26f "include/i18n/en_US/config.yaml")

Show comments

[View file](/osTicket/osTicket/blob/d98c2d096aeb8876c6ab2f88317cd371d781f14d/include/i18n/en_US/config.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -80,6 +80,7 @@ core: |
|  |  | ticket\_number\_format: '######' |
|  |  | ticket\_sequence\_id: 0 |
|  |  | queue\_bucket\_counts: 0 |
|  |  | allow\_external\_images: 1 |
|  |  | task\_number\_format: '#' |
|  |  | task\_sequence\_id: 2 |
|  |  | log\_level: 2 |
| Expand Down | |  |

9 changes: 9 additions & 0 deletions

9
[include/i18n/en\_US/help/tips/settings.ticket.yaml](#diff-0cda20931fcad6b2ad59c38967231b9d3bb618b3e95b82135ce41e8e0fc78b40 "include/i18n/en_US/help/tips/settings.ticket.yaml")

Show comments

[View file](/osTicket/osTicket/blob/d98c2d096aeb8876c6ab2f88317cd371d781f14d/include/i18n/en_US/help/tips/settings.ticket.yaml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -124,6 +124,15 @@ require\_topic\_to\_close: |
|  |  | content: > |
|  |  | If Enabled, a Ticket must have a Help Topic in order to be Closed by an Agent |
|  |  |  |
|  |  | allow\_external\_images: |
|  |  | title: Allow External Images |
|  |  | content: > |
|  |  | If Enabled, the system will allow external inline images that have a valid image |
|  |  | extension (.png, .jpg, .jpeg, .gif). If Disabled, the system will exclude |
|  |  | any external inline images. One caveat to note, is if the setting is Disabled we |
|  |  | will still store external inline images that have a valid image extension in case |
|  |  | the setting is re-enabled in the future. |
|  |  |  |
|  |  | assigned\_tickets: |
|  |  | title: Assigned Tickets |
|  |  | content: > |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[include/staff/settings-tickets.inc.php](#diff-479863701853bc7d2047597a434758f66dc2dacfb6c71b87c325e5edd240121c "include/staff/settings-tickets.inc.php")

Show comments

[View file](/osTicket/osTicket/blob/d98c2d096aeb8876c6ab2f88317cd371d781f14d/include/staff/settings-tickets.inc.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -234,6 +234,13 @@ |
|  |  | <?php echo \_\_('Enable'); ?>&nbsp;<i class="help-tip icon-question-sign" href="#require\_topic\_to\_close"></i> |
|  |  | </td> |
|  |  | </tr> |
|  |  | <tr> |
|  |  | <td><?php echo \_\_('Allow External Images'); ?>:</td> |
|  |  | <td> |
|  |  | <input type="checkbox" name="allow\_external\_images" <?php echo $config['allow\_external\_images']?'checked="checked"':''; ?>> |
|  |  | <?php echo \_\_('Enable'); ?>&nbsp;<i class="help-tip icon-question-sign" href="#allow\_external\_images"></i> |
|  |  | </td> |
|  |  | </tr> |
|  |  | <tr> |
|  |  | <th colspan="2"> |
|  |  | <em><b><?php echo \_\_('Attachments');?></b>: <?php echo \_\_('Size and maximum uploads setting mainly apply to web tickets.');?></em> |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 1 comment on commit `d98c2d0`

[![@tr4l](https://avatars.githubusercontent.com/u/11498598?s=80&v=4)](/tr4l)

Copy link

### @tr4l **[tr4l](/tr4l)** commented on `[d98c2d0](/osTicket/osTicket/commit/d98c2d096aeb8876c6ab2f88317cd371d781f14d)` [Nov 3, 2020](#commitcomment-43834666) ‚Ä¢ edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Hi,

The issue with a SSRF is not that an attacker can load malicious script. The issue is that a request is made by the server. The attacker can still add an appropropiate extention and get internal IP of the server, or call an internal ES server, aws endpoint protected by firewall, sometime even a file from the filesystem of the server.

The filter in itself doesn't seems really robust neither (but didn't dig into it).

What happens with url like <https://www.example.com/evil-script.js#legit.jpg> ?

Sorry, something went wrong.

 üëç
2
 wszdhf and FFCoder reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FosTicket%2FosTicket%2Fcommit%2Fd98c2d096aeb8876c6ab2f88317cd371d781f14d) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


