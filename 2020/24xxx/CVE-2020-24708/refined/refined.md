Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**

*   The "Host" input field within the sending profile form in Gophish v0.10.1 was vulnerable to Cross-Site Scripting (XSS). The application did not properly sanitize user-supplied input, allowing an attacker to inject malicious code.

**Weaknesses/vulnerabilities present:**

*   **Stored XSS:** The injected XSS payload was stored when saving the sending profile.
*   **Lack of Input Sanitization:** The application failed to sanitize the "Host" input field, allowing HTML and JavaScript injection.
*   **Impersonation Feature Abuse:** Gophish's impersonation feature allowed a lower-privileged user to entice an administrator to trigger the stored XSS by interacting with a malicious profile.

**Impact of exploitation:**

*   **Arbitrary Code Execution:** The XSS payload executes in the administrator's browser when they interact with the malicious sending profile, potentially leading to malicious actions.
*   **Account Compromise:** An attacker could potentially steal session cookies, manipulate administrator actions, or inject further malicious code to compromise the administrator's account.

**Attack vectors:**

*   **Malicious Sending Profile:** A rogue user crafts a malicious sending profile containing an XSS payload in the "Host" field.
*   **Social Engineering:** The rogue user then asks an admin to impersonate them and test the "broken" sending profile.
*   **Test Email Trigger:** When the administrator sends a test email from the user's profile, the stored XSS is triggered, executing the injected code.

**Required attacker capabilities/position:**

*   **Low-Privilege User:** The attacker needs to be a valid user within the Gophish application.
*   **Social Engineering Skills:** The attacker needs to trick an administrator into impersonating their account.
*   **Understanding of Gophish:** The attacker must understand how the "Host" field and the test email feature are used.

**Additional details from the provided content:**

*   The vulnerability was identified by Marcus Nilsson of usd AG.
*   The vulnerability was fixed by the vendor in commit 90fed5a575628b89eaf941e1627b49e0f3693812.
*   The fix involved escaping the error message in the sending profile hostname.
*   The provided content includes a proof-of-concept scenario, detailing how an attacker could exploit the vulnerability.
*   The vendor was notified on 2020-06-18 and released a fix on 2020-08-07.