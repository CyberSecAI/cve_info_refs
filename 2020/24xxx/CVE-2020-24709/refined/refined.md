Based on the provided content, here's the breakdown of the vulnerability:

**CVE ID:** CVE-2020-24709

**Root Cause of Vulnerability:**
The vulnerability stems from the lack of proper input sanitization and output encoding in the HTML editor's preview feature within Gophish. Specifically, the preview functionality in both the Landing Page and Email Template editors allows for the execution of XSS payloads injected into the source text area.

**Weaknesses/Vulnerabilities Present:**
- **Stored Cross-Site Scripting (XSS):** Malicious JavaScript code injected through the HTML editor's preview is stored and executed when a user previews the landing page or email template.

**Impact of Exploitation:**
- An attacker can execute arbitrary JavaScript code within the context of a user's browser session when the user previews the malicious landing page or email template.
-  Although the Gophish session cookie is protected with the HttpOnly flag, an attacker may be able to perform actions with the rights of the user. This could include stealing sensitive information or performing actions on behalf of the user if they are logged in to the application.

**Attack Vectors:**
- A rogue user creates a malicious landing page or email template containing XSS payloads within the HTML editor.
- The attacker then tricks an administrator into previewing the crafted malicious content. This could be achieved by asking the administrator to "impersonate" the rogue user and preview their "broken" template.

**Required Attacker Capabilities/Position:**
- The attacker needs to be a registered user of the Gophish application with the ability to create landing pages and email templates.
- The attacker needs to be able to trick another user (typically an administrator) into previewing the malicious content.

**Additional Information:**
- The advisory suggests that all user-controlled input should be treated as potentially dangerous. It recommends encoding dynamic output based on user-controlled data using functions like `htmlspecialchars()` in PHP.
- Server-side input validation with whitelisting is also recommended.
- The vulnerability was found by Marcus Nilsson of usd AG.
- The vulnerability was fixed by the vendor.