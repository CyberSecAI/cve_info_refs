=== Content from wiki.debian.org_8d48714b_20250119_133022.html ===

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")

[Wiki](/FrontPage "Debian Wiki Homepage")

[Login](/LTS?action=login)

* [FrontPage](/FrontPage)
* [RecentChanges](/RecentChanges)
* [FindPage](/FindPage)
* [HelpContents](/HelpContents)
* [LTS](/LTS)

Search:

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")
[Wiki](/FrontPage "Debian Wiki Homepage")/

* [Login](/LTS?action=login)
* Comments
* [Info](/LTS?action=info)
* [Attachments](/LTS?action=AttachFile)
* More Actions:
  Raw Text
  Print View
  Render as Docbook
  Delete Cache
  ------------------------
  Check Spelling
  Like Pages
  Local Site Map
  ------------------------
  Rename Page
  Delete Page
  ------------------------
  Subscribe User
  ------------------------
  Remove Spam
  Revert to this revision
  Package Pages
  ------------------------
  Load
  Save
  SlideShow

# * [LTS](/LTS)

[Translation(s)](/DebianWiki/EditorGuide#translation): [English](/LTS) - [Deutsch](/de/LTS) - [Español](/es/LTS) - [Français](/fr/LTS) - [Italiano](/it/LTS) - [한국어](/ko/LTS) - [Português](/pt/LTS) - [Português (Brasil)](/pt_BR/LTS) - [Русский](/ru/LTS)

# Debian Long Term Support

Debian Long Term Support (LTS) is a project to extend the lifetime of all Debian stable releases to (at least) 5 years. Debian LTS is not handled by the Debian Security and Release teams, but by a separate group of volunteers and companies interested in making it a success.

Thus the Debian LTS team takes over security maintenance of the various releases once the Debian Security team stops its work.

![/!\](/htdocs/debwiki/img/alert.png "/!\")

LTS ([last modified 2024-08-15 02:46:47](/LTS?action=info))

* Debian [privacy policy](https://www.debian.org/legal/privacy), Wiki [team](/Teams/DebianWiki), [bugs](https://bugs.debian.org/wiki.debian.org) and [config](https://salsa.debian.org/debian/wiki.debian.org).
* Powered by [MoinMoin](https://moinmo.in/ "This site uses the MoinMoin Wiki software.") and [Python](https://moinmo.in/Python "MoinMoin is written in Python."), with hosting provided by [Metropolitan Area Network Darmstadt](https://www.man-da.de/).



=== Content from bugs.gentoo.org_84685c7a_20250119_133023.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 733
postfix-1.1.3 does not create /var/spool/portage
Last modified: 2003-02-04 19:42:18 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=733&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=733&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 733**](show_bug.cgi?id=733)
- postfix-1.1.3 does not create /var/spool/portage

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
postfix-1.1.3 does not create /var/spool/portage

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Linux | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Linux "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | [OLD] Core system ([show other bugs](buglist.cgi?component=%5BOLD%5D%20Core%20system&product=Gentoo%20Linux&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | x86 Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | High normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Donny Davies (RETIRED) | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2002-02-17 11:20 UTC by Ian Smith | | --- | --- | | Modified: | 2003-02-04 19:42 UTC ([History](show_activity.cgi?id=733)) | | CC List: | 0 users | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=733&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=733&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Ian Smith    2002-02-17 11:20:53 UTC  ``` Strange one this, I remerged after running postfix-check because it complained that /var/spool/portage did not exist.  The lines in the emerge output:  --- /var/spool/ >>> /var/spool/postfix/ >>> /var/spool/postfix/maildrop/  seem to indicate that the dir was created, but an ls confirmed the original output of postfix-check, ie. not found.  I did a mkdir and postfix-check succeded. ```  [Comment 1](#c1)  Daniel Robbins (RETIRED)   gentoo-dev  2002-02-17 11:49:11 UTC  ``` creating ${ROOT}/var/spool/postfix in pkg_postinst() will fix this. ```  [Comment 2](#c2)  Donny Davies (RETIRED)   gentoo-dev  2002-02-18 19:02:44 UTC  ``` fixed. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=733)
* - [XML](show_bug.cgi?ctype=xml&id=733)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=733)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=733&product=Gentoo%20Linux)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=733&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=733&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from lists.debian.org_66175e28_20250119_114242.html ===


---

[[Date Prev](msg00005.html)][[Date Next](msg00007.html)]
[[Thread Prev](msg00005.html)][[Thread Next](msg00007.html)]
[[Date Index](maillist.html#00006)]
[[Thread Index](threads.html#00006)]

# [SECURITY] [DLA 2393-1] snmptt security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2393-1] snmptt security update
* *From*: Abhijith PA <abhijith@disroot.org>
* *Date*: Fri, 2 Oct 2020 23:40:16 +0530
* *Message-id*: <[[🔎]](/msgid-search/53a4a56f-80a8-ebc9-ea38-1515d6fbd377%40disroot.org) [53a4a56f-80a8-ebc9-ea38-1515d6fbd377@disroot.org](msg00006.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2393-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Abhijith PA
October 01, 2020                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : snmptt
Version        : 1.4-1+deb9u1
CVE ID         : CVE-2020-24361

It was found that SNMP Trap Translator does not drop privileges as
configured and does not properly escape shell commands in certain
functions. A remote attacker, by sending a malicious crafted SNMP trap,
could possibly execute arbitrary shell code with the privileges of the
process or cause a Denial of Service condition.

For Debian 9 stretch, this problem has been fixed in version
1.4-1+deb9u1.

We recommend that you upgrade your snmptt packages.

For the detailed security status of snmptt please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/snmptt>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE7xPqJqaY/zX9fJAuhj1N8u2cKO8FAl93bQEACgkQhj1N8u2c
KO9knQ/9HwMgeN0a1W8Q2fwKz/G1yuBIvjYtrUE8Xeqi3rdPWGc4rTtiN8qKUSrD
wBX+gy8KjIpR/DfFztxqE3OaWhRZV4PoLJlaWFtisxGgaMWvXPBKzsH0AI8Rx0xz
6F2JtGjUyePKFEFMkTvIHEKwmTXIBMBJdDIrh8qUtcxTlKBZWk4s4wUUPTjlfo5u
d17wG2WGxH/oJP8ljkWsemf2+GZrI9iydMHq5rHeWlMtU18t9SoLLl05EX2SPCUA
cVN2wFryxOAbAf6QMiLvMb3gQPLjZi19sZCFC8r+YgwoO6GSqFAMK/owC6bwMdYE
p+Uf12Surwo5xK9b0CBr04TYFtUJnsWSh9E7uh1qGVw5pm7OSfmv/2lKSqz+z0ar
d9JKnBFhjifGYBhw8Bli6iFfi47o8YgSSChGYs221MxLywqaaL27DI3znjPjs194
tVQoV+AEZ07KHPffVzk13r/xU+gTh4muyAb42p85IKhh48wqC6whpjYIM7heosbs
kXgzHutpLGgmkPRxrj/E5ij2UN01pINMQ2jy2rTCvtfoF6yBdiuzwxOz1o5TJDhg
DRyyThBUmZQP6gk3R/mpYlKXbWQaCtHBtOAFk5XsOyJ7Lg3ecrvQTnXXgrRrF59K
AClEcUxhoA9kik7duv+u3G/AtCLVq12ouPDYqbHtERQ8rsxlQgE=
=z42s
-----END PGP SIGNATURE-----

```

---



=== Content from www.snmptt.org_6117f40b_20250119_114242.html ===


SNMP Trap Translator
[skip to page content](#Content)

[Home](/)

[About](/about.shtml)

[Downloads](/downloads.shtml)

[Screenshots](/screenshots.shtml)

[Git](/cvs.shtml)

[Change Log](/changelog.shtml)

[Documentation](/docs/snmptt.shtml)

[SNMPTT](/docs/snmptt.shtml)

[Convert](/docs/snmpttconvert.shtml)

[ConvertMIB](/docs/snmpttconvertmib.shtml)

[FAQs](/docs/faqs.shtml)

[Mailing Lists](/mailinglists.shtml)

[Users](/users.shtml)

[Resources](/resources.shtml)

[Support](/support.shtml)

[License](/license.shtml)

 [![SourceForge.net SNMPTT Project](http://sflogo.sourceforge.net/sflogo.php?group_id=51473&type=2)](http://www.sourceforge.net/projects/snmptt)
[![Buy Me a Coffee at ko-fi.com](https://cdn.ko-fi.com/cdn/kofi4.png?v=3)](https://ko-fi.com/L3L3EM8EV)

Change Log

v1.5 - August 17th, 2022

* Added PREEXEC support for unknown traps. Results are stored in the variable **$pu*n***. See the **unknown\_trap\_preexec** setting in **snmptt.ini**.
* Added **unknown\_trap\_nodes\_match\_mode** setting to allow you to change how traps are handled when they do not match due to **MATCH** and **NODES**. If set to 1, traps are considered skipped instead of unknown. Statistics now include the number of skipped traps when enabled.
* Added support for wildcards for the **snmptt\_conf\_files** setting in **snmptt.ini**. Example: **/etc/snmptt/snmptt.\*.conf**
* Added **log\_format** **snmptt.ini** setting to allow you to define the STDOUT, text log and eventlog text format.
* Added **syslog\_format** **snmptt.ini** setting to allow you to define the syslog text format. This will allow you to add a structured data section for RFC5424 syslog.
* Added variable substitution **$j** to pull out the enterprise number from the full enterprise OID. For example, for enterprise OID .1.3.6.1.4.1.232, **$j** would
  contain 232.
* Added remote syslog support using the Perl module Log::Syslog::Fast which also allows you to specify the APP-NAME for RFC5424 syslog.
  Added the following **snmptt.ini** settings: **syslog\_module**, **syslog\_remote\_dest**, **syslog\_remote\_port**, **syslog\_remote\_proto**, **syslog\_rfc\_format**, **syslog\_app** and **syslog\_system\_app**.
* Added reload support to the **snmptt.service** systemd file. This will allow you to use the **'systemctl reload snmptt'** command to reload the configuration.
* Added support for IPv6. To enable, set **ipv6\_enable = 1** in **snmptt.ini**.
* Added support for sub-second sleep for spool folder processing.
* **snmptt.ini** can now be located in **/etc/snmptt** and is searched for at this
  location first.
* Updated documentation on securing SNMPTT to ensure the snmptt user has read access to the configuration files. This is required when issuing a reload.
* Fixed a bug with **daemon\_uid** that prevented SNMPTT from starting on FreeBSD
  (bug 47).
* Fixed a bug where traps arriving with the hostname set to UNKNOWN were
  not being handled properly (bug 46).
* Fixed a bug with **MATCH** which was preventing it from matching integers properly (bug 41).
* Fixed a bug where the agent IP address was not handled correctly when
  it was received from Net-SNMP as **IpAddress:x.x.x.x** (bug 27).
* Fixed a race condition bug with **snmptthander** and **snmptthandler-embedded**
  which could cause traps to be missed. Spool files are now immediately locked
  after creation using flock(). If flock() is not supported, the spool file will be created
  with a temporary filename and then renamed after closing.
* Fixed a bug with **wildcard\_expansion\_separator** which caused an issue when
  using wildcard separators that were longer than one character (bug 38).
* Fixed a bug where quotes were not properly removed from some incoming traps.
* Fixed bug with debug mode that was causing some debug mode output even when
  debug mode was off.
* Fixed a bug where DNS resolution was not working for enterprise variables
  when **net\_snmp\_perl\_enable** was disabled.
* Fixed a bug that prevented snmptt from starting when debug mode was disabled (bug 48).
* Fixed debug output bug with snmptthandler-embedded (PR 1).
* Fixed a bug with IPv6 address handling for NODES in snmptt.conf.
* Fixed a bug that prevented the hostname from being extraced when IPv6 is disabled and the hostname is passed from Net-SNMP as UDP: [x.x.x.x]:xxxx->[x.x.x.x]:xxxx.
* Changed **net\_snmp\_perl\_best\_guess** default from 0 to 2 as any modern system
  should support this. See FAQ and **snmptt.ini** for details on this variable.
* Enabled Perl warnings to help ensure code is following best practices.
* Ran code against Perl::Critic to find non-optimal code. Made various adjustments such as relacing bare words with variables and changing open() calls from two arguments to three.
* Documentation was converted from html to markdown to make it easier to maintain and a full review was completed. Many improvments have been made including a new section on integrating with Icinga. The docs folder now contains **.md**, **.html** and **.epub** versions of the documentation.
* **snmptthandler-embedded**:
  + Varbind types **Gauge32** and **Hex-STRING** now have the Gauge32: and Hex-STRING: text removed for incoming traps. Unicode line endings are also removed (Perl 5.10 and higher).
* **snmpttconvertmib**:
  + Added **--exec\_file** option to allow you to provide an EXEC command
    inside of a file instead of specifying on the command line. Useful for
    commands that include quotes so that you don't have to worry about escaping on
    the command line. Also allows you to define multiple EXEC lines instead of
    just one.
  + Added **--exec\_mode** option to allow you change how the EXEC line
    is built. Setting to **0** will append the format line to the end of the line
    (default). Setting to **1** does not append the format line to the end of the
    line. This is useful if you have added **$Fz** to the **--exec** line so that
    SNMPTT can replace it with the FORMAT line. Setting to **2** is similar to **1**,
    but instead of SNMPTT having to replace **$Fz** with the FORMAT line,
    **snmpttconvertmib** will do the substitution.
  + Added **--preexec** and **-preexec\_file** options.

v1.4.2 - July 23rd, 2020

* Fixed a security issue with EXEC / PREXEC / unknown\_trap\_exec
  that could allow malicious shell code to be executed.
* Fixed a bug with EXEC / PREXEC / unknown\_trap\_exec that caused
  commands to be run as root instead of the user defined in
  daemon\_uid.

v1.4 - November 6th, 2013

* Added snmptt.ini option
  net\_snmp\_perl\_cache\_enable
  to enable caching of Net-SNMP Perl module OID and ENUM
  translations.  This may speed up translations and reduce CPU
  load when net\_snmp\_perl\_enable
  and translate\_\* options are
  enabled.
* Fixed bug with snmptthandler-embedded where IP addresses and
  OIDs were not being detected properly because they contained
  'OID:', 'IpAddress:' etc.
* Fixed bug with MATCH.  The PREEXEC $p variable could not
  be used with MATCH.  PREEXEC is now executed first if MATCH
  contains $p.
* Fixed bug with syslog.  Log entries were supposed to be
  logged with snmptt[pid] but instad of the pid it was actually the
  effective user ID (2980512).
* Fixed bug where the hostname is not detected properly when
  snmptrapd is configured to not use DNS.
* Fixed bug where if the spool directory is not defined, files
  may be deleted from the wrong folder (3020696).
* Fixed bug with syslog logging.  Function was not being
  called properly (3166749).
* Fixed bug with MATCH where number ranges were not working
  (3397982).
* Fixed bug with multi-line traps (2915658).
* Fixed bug with LOGONLY severity.  EXEC was being executed
  even if the trap had a severity of LOGONLY (3567744).
* Fixed bug with snmptt hanging if the log message sent to syslog
  contained a % symbol.  All %'s are now escaped before sending
  to syslog (3567748).
* Fixed possible bug with MySQL.  Put CONNECT string on one
  line.
* Fixed bug with not being able to write to the debug log file
  when running snmptt as non-root if the debug file didn't already
  exist with the correct permissions at startup.  The ownership
  of snmptt.debug is now set to daemon\_uid before switching to the
  new uid.  Patch 3423525.
* Installation documentation updates (bug 3425999).

v1.3 - November 15th, 2009

* Added snmptthandler-embedded
  - a Net-SNMP
  snmptrapd embedded Perl version of snmptthandler.
* Added variable substitutions $Be,
  $Bu, $BE
  and $Bn for SNMPv3
  securityEngineID,
  securityName, contextEngineID and contextName (requires
  snmptthandler-embedded handler).
* Added **snmptt.ini** option **duplicate\_trap\_window
  variable** for duplicate trap detection.
* Added LSB init keywords and actions to snmptt-init.d
  and changed the priority
  for start / stop so that it starts after snmptrapd and stops before
  snmptrapd.
* Changed the default log path to /var/log/snmptt
  for Unix and
  c:\snmpt\log for Windows to
  make it easier to grant write permission to the
  snmptt process.
* Changed umask for log files to 002 to ensure they are not
  created as world writable.
* Fixed a bug where the the PID file was being created using the
  parent (root) PID instead of the child (daemon\_uid) when daemon\_uid
  is used.
* The DEBUG log file will now be re-opened when a HUP signal is
  sent.
* When debugging is enabled, flush buffers every sleep cycle so
  we can tail the debug log file.
* Don't print messages to the console when starting in daemon
  mode unless debugging is enabled or an error occurs.
* 'Could not open debug output file!' is no longer reported when
  debugging is disabled.
* Added snmptt.logrotate
  file from Ville Skytta.
* Fixed a bug (1748512) with handling escaped quotes in a trap
  message.
* Updated snmptt-net-snmp-test to test MIB descriptions.
* SNMPTTConvertMIB:
* + Fixed a bug (1678270) where a TRAP-TYPE / NOTIFICATION-TYPE
    line would not translate if it was split across two lines.

v1.2 - June 16th, 2007

* When **daemon\_uid** is used, two processes will now be
  spawned. The first process will be run as the same user that
  started SNMPTT (which should be root). The second will run as the
  **daemon\_uid** user. This was changed so that SNMPTT could
  properly clean up the pid file on exit.
* Added snmptt.ini option
  **pid\_file** to allow for custom pid file locations when running
  in daemon mode.
* Fixed bug where pid file did not contain the current pid of
  snmptt.
* Added **snmptt.ini** options **date\_format**,
  **time\_format**, **date\_time\_format**,
  **date\_time\_format\_sql** and **stat\_time\_format\_sql** to
  allow the output format for **$x** and **$X** substitution
  variables, and the format of the date/time for text logs and SQL to
  be changed using **strftime()** variables. This allows for
  proper date/time data types to be used in SQL databases.
* Added logging of trap statistics to a SQL table. Added
  **\*table\_statistics** **snmptt.ini** variable to define the
  table to be used.
* Added ability to add custom columns to **\*\_table** and
  **\*\_table\_unknown** tables. Added **sql\_custom\_columns** and
  **sql\_custom\_columns\_unknown** **snmptt.ini** options.
* Added **snmptt.ini** option **unknown\_trap\_exec\_format**
  to allow custom output with substitutions.
* Added the ability to log system messages to a text file in
  addtion to the existing syslog and Event Log.
   Added **snmptt.ini** options **log\_system** and
  log\_system\_file.
* Added a work-around to the [Net-SNMP v5.4 traphandle bug (1638225)](http://sourceforge.net/tracker/index.php?func=detail&aid=1638225&group_id=12694&atid=112694) where the host name was
  set to <UNKNOWN>. When detected, SNMPTT will use the host IP
  address instead.
* Added a **$H** variable substitution to give the host name
  of the computer that is running SNMPTT, or a user defined value
  specified in the new **snmptt\_system\_name** **snmptt.ini**
  option.
* Added MATCH support for bitwise AND
* Added **snmptt.ini** option **exec\_escape** to escape
  wildards (\* and ?) in EXEC, PREEXEC and the unknown\_trap\_exec
  commands. This is enabled by default for Linux and Unix (or
  anything non-Windows) to prevent the wildcards from being expanded
  by the shell.
* Moved **unknown\_trap\_exec** to Exec section in
  **snmptt.ini**.
* Added 'use strict' pragma in source code.
* Experimental:  Added threads (Perl ithreads) support for
  EXEC. When enabled, EXEC commands will launch in a thread to allow
  SNMPTT to continue processing other traps. Added **snmptt.ini**
  options **threads\_enable** and **threads\_max**.
* Fixed bug where snmptt tried to log to syslog when changing
  UIDs even if syslog\_system\_enable was set to 0.
* Fixed a bug in REGEX with handling of captures.
   Text::Balanced module is now required.
* Fixed a bug under Windows where SNMPTT was trying to log to
  syslog instead of the event log.
* Fixed a bug where SNMPTT was attempting to log to syslog /
  eventlog when using the --time option.
* Fixed a bug in MATCH where the i modifier was not handled
  correctly.
* Added information to Nagios section of documentation for using
  SNMP traps as heartbeats by using freshness checks.
* Added information to Nagios section of documentation for using
  freshness checks to automatically clear trap alerts.
* SNMPTTConvertMIB:
* + Fixed a bug (1438794) where a TRAP-TYPE / NOTIFICATION-TYPE
    line would not translate if it was split across two lines.
  + Fixed a bug (1438394) where ARGUMENTS lines that have $1, $2
    etc instead of %0, %1 would not translate.
  + Fixed a bug where a --#SEVERITYMAP line would be used instead
    of --#SEVERITY.

v1.1 - January 17th, 2006

* Added **PREEXEC** **snmptt.conf** file option to allow an
  external program to be run before processing the FORMAT and EXEC lines.
  The output of the external program is stored in the **$p*n***
  variable where ***n*** is a number starting from 1. Multiple **PREEXEC**
  lines are permitted. The first **PREEXEC** stores the result of the
  command in **$p1**, the second in **$p2** etc. Any ending
  newlines are removed. The **snmptt.ini** parameter **pre\_exec\_enable**
  can be used to enable / disable it.
* **MATCH** statement now accepts any variable name instead of only
  enterprise variables. Example: MATCH $s:(Normal)
* Added **NODES MODE=** snmptt.conf file option to allow you to
  select either **POS** (positive - the default) or **NEG**
  (negative) for **NODES** matches. If set to **NEG**, then **NODES**
  is a 'match' only if *none* of the **NODES** entries match.
* Added **unknown\_trap\_exec** **snmptt.ini** option. If defined,
  the command will be executed for ALL unknown traps. Passed to the
  command will be all standard and enterprise variables, similar to **unknown\_trap\_log\_file**
  but without the newlines.
* **snmptt --dump** which dumps all the configured EVENTs, now
  displays duplicate EVENT entries to assist with troubleshooting
  duplicate entries trap logs.
* If the debug log file can not be opened, a message is now logged to
  syslog if **syslog\_system\_enable** is enabled, and to the Event Log
  if **eventlog\_system\_enable** is enabled
* Fixed bug with PostgreSQL where some trap data was interpreted as
  'placeholders' in the INSERT statement which caused logging errors.
  PostgreSQL now uses PREPARE / EXECUTE statements instead.
* MySQL now uses PREPARE / EXECUTE statements instead of a single INSERT
  statement.
* Fixed bug in **NODES** where **NODES** entries from previous
  EVENTs were not being purged correctly.
* Fixed bug where **snmptt --dump** would attempt to log to syslog
  or the Event Log.
* Fixed bug that prevented the wildcard **.\*** from being accepted
  on the EVENT line.
* Added Windows Event Log forwarding documentation to integration
  section.
* SNMPTTConvertMIB:
* + Fixed a bug when **--format\_desc=n** was used that caused
    extra trailing whitespaces to be added for every non existent line
    in the description.
  + Fixed bug that prevented some MIBs from being accepted due to
    spacing in the **DEFINITIONS::= line**.
  + Fixed bug in that prevented **--ARGUMENTS {}** from being
    parsed due to spacing.

v1.0 - September 1st, 2004

* SQL database connections are now opened after forking to the
  background when running in daemon mode, and after changing users when
  running SNMPTT as a non-root user. This should prevent 'gone away' and
  other connection problems with SQL databases due to lost handles.
* Added mysql\_ping\_on\_insert, postgresql\_ping\_on\_insert and
  dbd\_odbc\_ping\_on\_insert options to 'ping' the database before doing an
  INSERT. Also added the options mysql\_ping\_interval,
  postgresql\_ping\_interval and dbd\_odbc\_ping\_interval to periodically ping
  the database. These options will help ensure the connection to the
  database remains available. If an error is returned, it will attempt to
  reconnect to the database. This should prevent SNMPTT from having to be
  restarted if the SQL server is not available due to an outage or a
  connection timeout due to no activity.
* Added variable substitution $Fz which when used on an EXEC line will
  dump the translated FORMAT line. This will allow for simplified EXEC
  lines when they are the same as the FORMAT line (minus the command to
  execute of course).
* Added variable substitutions $Fa, $Ff, $Fn, $Fr, $Ft, for alarm
  (bell), form feed (FF), newline (LF, NL), return (CR) and tab (HT, TAB)
* Added variable substitution $D to dump the description text for FORMAT
  and EXEC lines. The descriptions can be pulled from either the
  SNMPTT.CONF or MIB files. This is controlled by the description\_mode and
  description\_clean snmptt.ini options.
* Added support for logging unknown traps to a SQL table
* Added logging of statistical information for total traps received,
  total traps translated, total traps ignored and total unknown traps.
  Statistics are logged at shut down, and optionally at a defined interval
  defined by the new snmptt.ini variable statistics\_interval. Logging can
  also be forced by sending the SIGUSR1 signal, or by creating a file
  called !statistics in the spool folder.
* Added the error number reported by MySQL to MySQL errors (system
  syslog, eventlog etc)
* Added /usr/local/etc/snmp and /usr/local/etc paths to the list of
  default directories searched for snmptt.ini.
* Added some friendly error messages when required Perl modules are not
  available
* Fixed bug with with handling traps in symbolic format (snmptrapd
  without -On)
* Fixed bug with with using printing $ symbols in FORMAT and EXEC lines
* Added Simple Event Correlator (SEC) integration documentation
* SNMPTTConvertMIB:
* + Fixed bug that prevented the variable list (OBJECTS) of V2 MIB
    files from being converted
  + Fixed bug that caused an infinite loop processing the
    VARIABLES/OBJECTS section if the line in the MIB file contained
    spaces after the closing bracket

v0.9 - November 3rd, 2003

* Syslog messages are now logged with snmptt[*pid*] instead of
  TRAPD for traps, and snmptt-sys[*pid*] instead of SNMPTT for system
  messages
* Added the option daemon\_uid which causes snmptt to change to a
  different user (uid) after launching on Unix systems running in daemon
  mode
* Fixed bug that prevented ip addresses from being detected correctly
  with translate\_value\_oids
* Fixed bug with MATCH that caused integer ranges from not being handled
  correctly
* Separated SNMPTT, SNMPTTCONVERT, SNMPTTCONVERTMIB and FAQ /
  Troubleshooting documentation into separate documents

v0.8 - September 16th, 2003

* Added MATCH keyword support to allow trap matching based on
  values contained inside the trap enterprise variables
* REGEX now supports substitution with captures and the modifiers
  i, g and e. The e modifier allows for complex REGEX
  expressions.
* Added support for remote MySQL and PostgreSQL databases
* Added PostgreSQL support for DBD:Pg
* An EVENT can now contain mulitple EXEC lines
* An EVENT can now contain mulitple NODES lines
* Added the option dynamic\_nodes to allow NODES files to be
  either loaded at startup or loaded each time an EVENT is
  processed
* Added trapoid column for database logging to contain the actual
  trap received. The eventid column will contain the actual matched
  entry from the .conf file (which could be a wildcard OID)
* Fixed bug that prevented some variables from displaying the
  correct values because the received trap OID was replaced with the
  actual EVENT entry
* Fixed bug that caused OIDs not to be translated correctly with
  translate\_value\_oids enabled
* Agent IP address is now used instead of 'host' IP address for
  NODES matches, the 'hostname' column in database logs and the $A
  variable
* Variable $A now prints the agent host name. $aA prints the
  agent IP address.
* Variable $E now prints the enterprise in symbolic form. $e
  prints the numeric OID
* Variable $O now prints the trap in symbolic form. $o prints the
  numeric OID
* Added new variable substitution $i to print the actual matched
  entry from the .conf file (which could be a wildcard OID)
* Added the configuration option dns\_enable to enable DNS lookups
  on host and agent IP addresses
* If DNS is enabled, NODES entries are resolved to IP addresses
  and the IP address is used to perform the match. This will allow
  for aliases to be used.
* Added the option resolve\_value\_ip\_addresses to resolve ip
  addresses contained inside enterprise variable values
* Changed snmptt.ini setting translate\_trap\_oid to
  translate\_log\_trap\_oid
* Changed snmptt.ini setting translate\_oids to
  translate\_value\_oids
* Added configuraiton settings: translate\_enterprise\_oid\_format,
  translate\_trap\_oid\_format, translate\_varname\_oid\_format and
  db\_translate\_enterprise
* $O follows translate\_trap\_oid\_format, and $o is always the
  numerical trap OID
* $E follows translate\_enterprise\_oid\_format, and $e is always
  the numerical enterprise OID
* The enterprise column when logging to a database now follows
  the db\_translate\_enterprise setting
* Fixed bug with $# to report the correct number of enterprise
  variables (was 1 lower than it should have been)
* Fixed bug with handling traps that contain quoted values that
  span multiple lines
* PID file now created (/var/run/snmptt.pid or ./snmptt.pid) when
  running in daemon mode on Linux / Unix. snmptt-init.d script
  updated to remove the pid file when shutting down snmptt.
* Added Nagios / Netsaint integration documentation
* Added contrib folder
* Snmpttconvertmib
* + Now prints the variables contained in each trap definition
    unless --no\_variables is set. When using --net\_snmp\_perl it will
    also resolve the Syntax (INTEGER, OCTETSTR etc) and Description. If
    it's an INTEGER, will also print out the enumeration tags if any
    exist.
  + Improved compatability with MIB files

v0.7 - April 17th, 2003

* Fixes a vulnerability that prevents the possibility of injected
  commands contained in traps from being executed when using the EXEC
  feature
* Added the ability for traps passed from snmptrapd or loaded
  from the snmptt.conf files to contain symbolic OIDs such as
  linkDown and IF-MIB::linkUp. This feature requires the UCD-SNMP /
  Net-SNMP Perl module
* Added the configuration options translate\_trap\_oid and
  translate\_oids to have the trap OID and OID values contained in the
  trap variables converted from numerical OID to symbolic form before
  logging. This feature requires the UCD-SNMP / Net-SNMP Perl
  module
* Added support for logging of traps using PostgreSQL via DBI /
  DBD::PgPP
* Added REGEX keyword support to allow user definable search and
  replace on FORMAT / EXEC lines
* NODES entry can now contain a CIDR address (eg:
  192.168.10.0/23), or a network range
  (192.168.10.0-192.168.11.255)
* NODES entry can now contain a mix of host names, IP addresses,
  CIDR addresses, network ranges and filenames
* Added the ability to force a reload of the configuration files
  while running in daemon mode by placing a file called !reload in
  the spool directory
* Added snmptt-net-snmp-test program to perform various
  translations of numeric and symbolic OIDS to assist with
  determining if the installed Perl module will function as expected
  with SNMPTT
* Fixed bug that prevented quoted text from being logged
  correctly to SQL databases
* Fixed bug that would prevent the translation of integer values
  to enumeration tags and variable name substitutions when using
  Net-SNMP 5.0.x
* Snmpttconvertmib
  + FORMAT / EXEC line can now contain any of the following:
    - --#SUMMARY or DESCRIPTION (use DESCRIPTION only if --#SUMMARY
      does not exist)
    - description or --#SUMMARY (use --#SUMMARY only if DESCRIPTION
      does not exist)
    - --#SUMMARY and DESCRIPTION
    - DESCRIPTION and --#SUMMARY
  + When using the DESCRIPTION to build the FORMAT / EXEC line, can
    now choose between using the first line of the DESCRIPTION field,
    or the first x number of sentences
  + The use of the --#SUMMARY and DESCRIPTION line for the FORMAT /
    EXEC line can be disabled
  + Support for multiple --#SUMMARY lines
  + Support for --#SEVERITY lines
  + The default of using the $\* wildcard can be disabled
  + Conversion of the DESCRIPTION section to SDESC / EDESC can be
    disabled
  + EXEC line can be specified on the command line
  + NODES line can be specified on the command line

v0.6 - March 25th, 2003

* Logging:
  + Added support for logging of traps using DBD::ODBC
  + Fixed bug with Win32::ODBC connection not being closed on exit
    of SNMPTT
  + MySQL code cleanup
  + Added support for logging traps to the NT Event Log including
    the ability to select the Event Log level based on the severity
    level defined in the snmptt.conf file
  + Improved syslog support by adding the ability to select the
    syslog level based on the severity level defined in the snmptt.conf
    file
  + Added syslog and NT Event Log support for SNMPTT 'system'
    events such as startup, shutdown, errors handling spool directory /
    files, database connectivity errors etc
  + Added the option keep\_unlogged\_traps to have SNMPTT erase the
    spooled trap file only after it successfully logs to at least one
    or all log systems. This will help prevent traps from being lost
    due to logging problems.
* Added ability to translate integer values to enumeration tags
  defined in MIB files. This feature requires the UCD-SNMP / Net-SNMP
  Perl module
* Added new variable substitutions: $vn (variable name),
  $+n(variable name:value), $-n (variable name (type):value), $+\*
  (same as $+n but wildcard), and $-\* (same as $-n but wildcard).
  Translation of the variable name using the MIB requires the
  UCD-SNMP / Net-SNMP Perl module.
* If a variable is passed from snmptrapd that is blank, snmptt
  will replace it with (null)
* Fixed bug that would prevent variables numbered 10 or higher
  from being translated correctly
* Fixed bug with handling trap data that contains spaces but is
  not inside of quotes
* Code cleanup to remove Perl warnings (-w)
* Added separate debug file for snmptthandler
* Cleaned up defaults code for snmptthandler
* Added examples folder containg a sample snmptt.conf file and
  sample trap file
* Added FAQ section to this document
* Snmpttconvertmib
  + Code cleanup
  + Now uses new command line arguments (snmpttconvertmib -h for
    help).
  + Can now use either snmptranslate or the SNMP Perl module
    (Net-SNMP) to process MIB files
  + Can now add a NODES line when converting MIB files
  + Now checks the version of snmptranslate before converting the
    mib to ensure snmptranslate is called correctly
  + Fixed bug which would cause the last notification of a v2 MIB
    file not to be converted correctly

v0.5 - February 12th, 2003

* Spool file list sorted before processing to ensure traps are
  processed in the order they are received when in daemon mode
* Added use\_trap\_time variable to config file for daemon mode to
  have SNMPTT use either the time from the spool file, or the current
  time. Changed SNMPTTHANDLER to output the current date and time on
  the first line of the spool file
* Fixed bug with default variable settings being ignored.
  Defaults were not being set correctly if variable was not defined
  in the .ini file.
* Fixed bug with SNMPTT ignoring the daemon mode parameter in the
  .ini file
* Fixed bug with Nodes list not being flushed out for each
  processed trap when running in daemon mode
* Added strip\_domain and strip\_domain\_list configuration options
  to enable / disable the removal of the domain name from the host
  name passed to SNMPTT. Defaults to disabled (do not strip domain
  name)
* SNMPTTCONVERTMIB now prepends the contents of the --#TYPE line
  (if present) to the --#SUMMARY line to provide a more descriptive
  FORMAT / EXEC line

v0.4 - November 18th, 2002

* Variable substitution changes:
  + $X = Date, $x = Time instead of $x being both date and
    time
  + $N = Event name instead of $S
  + Added $c, $@, $O, $o, $ar, $R, $aR, $G, $S
* Configuration moved to a .ini file
* MySQL support via DBI under Linux and Windows
* ODBC support via Win32::ODBC under Windows

v0.3 - September 11th, 2002

* Daemon mode support for SNMPTT. When running as a daemon,
  SNMPTTHANDLER script is used to spool traps from SNMPTRAPD.
* SNMPTTCONVERTMIB utility to convert trap / notify definitions
  from MIB files
* Sample trap file (sample-trap) for testing
* Command line options to SNMPTT
* SNMPTT now strips UDP: and :port from IP addresses when using
  Net-SNMP 5.0+
* NODES files can now contain comments
* NODES files can now contain either host names or IP
  addresses
* You can now have multiple definitions of the same trap so that
  different hosts / nodes can have different actions or one host have
  multiple actions
* Configuration file can now contain a list of other
  configuration files to load

v0.2 - July 10th, 2002

* Improved debugging output
* Severity substitution bug fix
* SNMP V2 trap bug fix
* UCD-SNMP v4.2.3 problem workaround

v0.1 - April 18th, 2002

* Initial release

---

Last modified: Thursday, 18-Aug-2022 01:21:23 UTC

Copyright © 2002-2022 Alex Burger



=== Content from security.gentoo.org_33bdde22_20250119_114243.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# SNMP Trap Translator: Multiple vulnerabilities — GLSA **202007-63**

Multiple vulnerabilities have been found in SNMP Trap Translator,
the worst of which could allow attackers to execute arbitrary shell code.

### Affected packages

| Package | **net-analyzer/snmptt** on all architectures |
| --- | --- |
| Affected versions | < **1.4.1** |
| Unaffected versions | >= **1.4.1** |

### Background

SNMP Trap Translator (SNMPTT) is an SNMP trap handler written in Perl.

### Description

It was found that SNMP Trap Translator does not drop privileges as
configured and does not properly escape shell commands in certain
functions.

### Impact

A remote attacker, by sending a malicious crafted SNMP trap, could
possibly execute arbitrary shell code with the privileges of the process
or cause a Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All SNMP Trap Translator users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-analyzer/snmptt-1.4.1"

```
### References

* [SNMPTT 1.4.1 ChangeLog](https://sourceforge.net/p/snmptt/git/ci/snmptt_1-4-1/tree/snmptt/ChangeLog)
* [CVE-2020-24361](https://nvd.nist.gov/vuln/detail/CVE-2020-24361)

**Release date**

July 31, 2020

**Latest revision**

August 16, 2020: 2

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [733478](https://bugs.gentoo.org/show_bug.cgi?id=733478)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


