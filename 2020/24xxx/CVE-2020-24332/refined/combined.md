=== Content from seclists.org_e459cd98_20250119_120113.html ===
Index: trousers-0.3.14/src/tcs/ps/tcsps.c
===================================================================
--- trousers-0.3.14.orig/src/tcs/ps/tcsps.c
+++ trousers-0.3.14/src/tcs/ps/tcsps.c
@@ -72,7 +72,7 @@ get\_file()
}
/\* open and lock the file \*/
- system\_ps\_fd = open(tcsd\_options.system\_ps\_file, O\_CREAT|O\_RDWR, 0600);
+ system\_ps\_fd = open(tcsd\_options.system\_ps\_file, O\_CREAT|O\_RDWR|O\_NOFOLLOW, 0600);
if (system\_ps\_fd < 0) {
LogError("system PS: open() of %s failed: %s",
tcsd\_options.system\_ps\_file, strerror(errno));
Index: trousers-0.3.14/src/tcsd/svrside.c
===================================================================
--- trousers-0.3.14.orig/src/tcsd/svrside.c
+++ trousers-0.3.14/src/tcsd/svrside.c
@@ -473,6 +473,7 @@ main(int argc, char \*\*argv)
}
return TCSERR(TSS\_E\_INTERNAL\_ERROR);
}
+ setgid(pwd->pw\_gid);
setuid(pwd->pw\_uid);
#endif
#endif
Index: trousers-0.3.14/src/tcsd/tcsd\_conf.c
===================================================================
--- trousers-0.3.14.orig/src/tcsd/tcsd\_conf.c
+++ trousers-0.3.14/src/tcsd/tcsd\_conf.c
@@ -743,7 +743,7 @@ conf\_file\_init(struct tcsd\_config \*conf)
#ifndef SOLARIS
struct group \*grp;
struct passwd \*pw;
- mode\_t mode = (S\_IRUSR|S\_IWUSR);
+ mode\_t mode = (S\_IRUSR|S\_IWUSR|S\_IRGRP);
#endif /\* SOLARIS \*/
TSS\_RESULT result;
@@ -798,15 +798,15 @@ conf\_file\_init(struct tcsd\_config \*conf)
}
/\* make sure user/group TSS owns the conf file \*/
- if (pw->pw\_uid != stat\_buf.st\_uid || grp->gr\_gid != stat\_buf.st\_gid) {
+ if (stat\_buf.st\_uid != 0 || grp->gr\_gid != stat\_buf.st\_gid) {
LogError("TCSD config file (%s) must be user/group %s/%s", tcsd\_config\_file,
- TSS\_USER\_NAME, TSS\_GROUP\_NAME);
+ "root", TSS\_GROUP\_NAME);
return TCSERR(TSS\_E\_INTERNAL\_ERROR);
}
- /\* make sure only the tss user can manipulate the config file \*/
+ /\* make sure only the tss user can read (but not manipulate) the config file \*/
if (((stat\_buf.st\_mode & 0777) ^ mode) != 0) {
- LogError("TCSD config file (%s) must be mode 0600", tcsd\_config\_file);
+ LogError("TCSD config file (%s) must be mode 0640", tcsd\_config\_file);
return TCSERR(TSS\_E\_INTERNAL\_ERROR);
}
#endif /\* SOLARIS \*/


=== Content from www.openwall.com_182c72df_20250119_120111.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2020/08/13/3) [[next>]](../../../2020/08/15/1) [[<thread-prev]](../../../2020/08/06/4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <da7d33de74a55b800b43cbec36a549e77612106e.camel@linux.ibm.com>
Date: Fri, 14 Aug 2020 01:39:34 -0700
From: Debora Velarde Babb <debora@...ux.ibm.com>
To: Matthias Gerstner <mgerstner@...e.de>, oss-security@...ts.openwall.com
Cc: trousers-tech@...ts.sourceforge.net, security <security@...e.de>
Subject: Re: [TrouSerS-tech] Multiple Security Issues in the TrouSerS tpm1.2
 tscd Daemon

On Wed, 2020-05-20 at 14:54 +0200, Matthias Gerstner wrote:
>
>
> Security Issues
> ===============
>
> The security issues resulting from this are as follows:
>
> a) Since /var/lib/tpm is owned by the tss user (as per
> dist/Makefile.am), the
>    creation of the `system.data` file in step 3) is prone to symlink
> attacks. The
>    tss user can thereby cause the creation of new files or the
> corruption of
>    existing files. These new files end up with mode 0600 and no
> `chown()` to the
>    tss user is performed by the tcsd. Thus it looks like no full
> local root
>    privilege escalation can be achieved but only DoS attacks.

CVE-2020-24332 is assigned to issue a)

[Suggested description]
An issue was discovered in TrouSerS through 0.3.14.
If the tcsd daemon is started with root privileges, the creation of
the system.data file is prone to symlink attacks. The tss user can be
used to create or corrupt existing files, which could possibly lead to
a DoS attack.

>
> b) The tcsd only drops the root uid, not the root gid in step 4). A
> call to
>    `setgid()` is missing. Therefore the tcsd continues to run with
> root group
>    privileges it doesn't actually require. This could allow further
> privilege
>    escalations when combined with other, yet unknown attack vectors.

CVE-2020-24330 assigned to security issue b)

[Suggested description]
An issue was discovered in TrouSerS through 0.3.14.
If the tcsd daemon is started with root privileges instead of by the
tss user, it fails to drop the root gid privilege when
no longer needed.

>
> c) The configuration file /etc/tcsd.conf is _required_ by the tcsd to
> be
>    owned by tss:tss mode 0600. Therefore the unprivileged user can
> change all
>    daemon related settings, including the `system_ps_file` path. This
> means
>    the `mkdir()` and `chmod()` performed in step 2) can be directed
> to an
>    arbitrary path. This also includes the symlink attack described in
> a)
>    for arbitrary paths.
>
>    Further security issues could stem from this by manipulating other
> config
>    file options. I did not look deeper into this.

CVE-2020-24331 is assigned to security issue c)

[Suggested description]
An issue was discovered in TrouSerS through 0.3.14.
If the tcsd daemon is started with root privileges, the tss user still
has read and write access to the /etc/tcsd.conf file (which contains
various settings related to this daemon).

>
> d) Not directly related to the logic above. The example RPM spec file
> [5] in
>    the TrouSerS repository is using unsafe file and directory modes
> for
>    /var/lib/tpm and /usr/sbin/tcsd:
>
>    ```
>    # create the default location for the persistent store files
>    if test -e %{_localstatedir}/tpm; then
>         mkdir -p %{_localstatedir}/tpm
>         /bin/chown tss:tss %{_localstatedir}/tpm
>         /bin/chmod 1777 %{_localstatedir}/tpm
>    fi
>
>    # chown the daemon
>    /bin/chown tss:tss %{_sbindir}/tcsd
>    ```
>
>    So here a public sticky-bit directory is setup in /var/lib/tpm.
> This could
>    allow arbitrary users to setup the symlink attack mentioned in a).
> It could
>    also lead to an information leak. Once the tcsd is started as root
> the mode
>    of /var/lib/tpm will be corrected in step 1), however.
>
>    Passing ownership of /usr/sbin/tcsd to the tss user would allow
> the tss
>    user to replace the tcsd binary by malicious code that will
> potentially be
>    executed by the root user, leading to arbitrary code execution.
>
>    I'm not aware of any distribution actually using this spec file or
> parts of
>    it. Still it is a very bad example.
>
> Mitigation and Bugfixes
> =======================
>
> It seems best to me to run the tcsd as the tss:tss user and group
> right away
> and to not rely on the privilege drop logic implemented in the daemon
> itself.
> All of a), b) and c) should no longer be problematic in this case. I
> found
> that on Debian and Gentoo Linux this is already the case. To make
> this work a
> udev rule needs to be packaged that passes ownership of /dev/tpm0
> device to
> the tss user. To prevent regressions when switching from the
> privilege drop
> approach to this new approach, a possibly already existing
> /var/lib/tpm/system.auth file needs to be safely chown()'ed to the
> tss user
> during package updates.
>
> On SUSE and Fedora Linux the tcsd is started as root via systemd,
> thus they
> are affected by the security issues. A preliminary suggested source
> code fix
> is attached to this mail. It makes sure that `O_NOFOLLOW` is added to
> step 3)
> to prevent a symlink attack. It also adds a drop of the root gid to
> the tss
> gid. And it modifies the check of /etc/tcsd.conf such that ownership
> root:tss
> and mode 0640 are necessary. The packaging needs to be adjusted
> accordingly.
>
> The correct long term fix should probably be to *only* open /dev/tpm0
> as root,
> immediately drop to tss:tss and only then perform the further
> initialization
> steps. The initialization sequence in `tcsd_startup()` is currently
> running
> completely in the root user context and seems rather complex. Maybe
> there are
> more details to this that I don't know of yet. For this reason I
> didn't try a
> patch in this direction yet.
>
> Upstream Reporting
> ==================
>
> I reported issues a), b) and d) privately to the documented upstream
> contacts
> without much success (see Timeline below). The SUSE Security Team 90
> days
> maximum disclosure time has been reached, therefore I'm publishing
> this now in
> an uncoordinated way. While working on a fix I additionally
> discovered issue
> c). SUSE is tracking the issues in bsc#1164472 [6] currently.
>
> Issues a), b) and c) deserve CVE assignments in my opinion. I can't
> request
> CVEs myself though, because IBM upstream is a CNA themselves.
> Therefore
> upstream is required to assign their own CVEs.
>
> Timeline
> ========
>
> 2020-02-19: I reported findings a), b) and d) to
> honclo@...ux.vnet.ibm.com,
>             the security contact of the project according to the
> README file [2].
> 2020-02-28: I reported findings a), b) and d) to debora@...ux.ibm.com
> , the
>             maintainer of the project according to the AUTHORS file
> [3].
> 2020-03-16: I received a reply from debora@...ux.ibm.com, stating
> that she
>             will look into the findings.
> 2020-05-06: I reminded debora@...ux.ibm.com that the latest
> disclosure time
>             [4] for the findings is approaching and asked for any
> updates.
> 2020-05-20: I started working on a bugfix and mitigations, discovered
> the
>             additional finding c) and started publishing the
> findings.
>
> [1]: <https://sourceforge.net/projects/trousers>
> [2]:
> <https://sourceforge.net/p/trousers/trousers/ci/master/tree/README>
> [3]:
> <https://sourceforge.net/p/trousers/trousers/ci/master/tree/AUTHORS>
> [4]: [https://en.opensuse.org/openSUSE:Security_disclosure_policy](https://en.opensuse.org/openSUSE%3ASecurity_disclosure_policy)
> [5]:
> <https://sourceforge.net/p/trousers/trousers/ci/master/tree/dist/trousers.spec.in>
> [6]: <https://bugzilla.suse.com/show_bug.cgi?id=1164472>
>
> Best Regards
>
> Matthias
>
> _______________________________________________
> TrouSerS-tech mailing list
> TrouSerS-tech@...ts.sourceforge.net
> <https://lists.sourceforge.net/lists/listinfo/trousers-tech>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.suse.com_dc3d4c27_20250119_120112.html ===


| Bugzilla – Bug 1164472 | VUL-0: CVE-2020-24330: trousers: TrouSerS tcsd privilege escalation tss to root user | Last modified: 2024-05-07 11:00:55 UTC |
| --- | --- | --- |

|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1164472)
* |
  [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

[**Bug 1164472**](show_bug.cgi?id=1164472)
(CVE-2020-24330)
- VUL-0: CVE-2020-24330: trousers: TrouSerS tcsd privilege escalation tss to root user

[Summary:](page.cgi?id=glossary.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
VUL-0: CVE-2020-24330: trousers: TrouSerS tcsd privilege escalation tss to ro...

| | [Status](page.cgi?id=status_resolution_matrix.html): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=glossary.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2020-24330 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | SUSE Security Incidents | | [Classification:](page.cgi?id=glossary.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Novell Products | | [Component:](describecomponents.cgi?product=SUSE Security Incidents "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Incidents ([show other bugs](buglist.cgi?component=Incidents&product=SUSE%20Security%20Incidents&bug_status=__open__)) | | [Version:](page.cgi?id=glossary.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=glossary.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Other Other | |  | | | [Priority](page.cgi?id=glossary.html#priority): | P3 - Medium **Severity**: Normal | | [Target Milestone:](page.cgi?id=glossary.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=glossary.html#assigned_to "The person in charge of resolving the bug.") | Security Team bot | | [QA Contact:](page.cgi?id=glossary.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Security Team bot | |  | | | [URL:](page.cgi?id=glossary.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | <https://smash.suse.de/issue/253422/> | | [Whiteboard:](page.cgi?id=glossary.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | CVSSv3.1:SUSE:CVE-2020-24330:7.8:(AV:... | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=glossary.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=glossary.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2020-02-20 12:00 UTC by Matthias Gerstner | | --- | --- | | Modified: | 2024-05-07 11:00 UTC ([History](show_activity.cgi?id=1164472)) | | CC List: | 6 users (show)  abergmann antonio.gemelli camila.matos matthias.gerstner security-team thomas.leroy | |  | | | [See Also:](page.cgi?id=glossary.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Found By:](page.cgi?id=glossary.html#cf_foundby "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Services Priority:](page.cgi?id=glossary.html#cf_nts_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Business Priority:](page.cgi?id=glossary.html#cf_biz_priority "A custom Free Text field in this installation of Bugzilla.") |  | | [Blocker:](page.cgi?id=glossary.html#cf_blocker "A custom Drop Down field in this installation of Bugzilla.") | --- | | [Marketing QA Status:](page.cgi?id=glossary.html#cf_marketing_qa_status "A custom Drop Down field in this installation of Bugzilla.") | --- | | [IT Deployment:](page.cgi?id=glossary.html#cf_it_deployment "A custom Drop Down field in this installation of Bugzilla.") | --- | |  | |  * [Clone This Bug](enter_bug.cgi?cloned_bug_id=1164472) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=1164472&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=1164472&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1164472#c0)  Matthias Gerstner   2020-02-20 12:00:59 UTC  ``` I stumbled across the tcsd in the trousers tpm 1.2 package no handling the user privilege drop to the 'tss' user well. I've sent the following email to the upstream contact that is noted in trouser's README file as a security contact:  ``` Hi,  I'm contacting you, because your email is listed in the TrouSerS README [1] as a contact for security issues in TrouSerS.  I want to report a couple of security related findings in TrouSerS.  I noticed that the tcsd daemon in TrouSerS is dropping root privileges too late in the startup process and does so also incompletely:  1) TrouSerS upstream recommends the state directory /var/lib/tpm to be    owned by the unprivileged user tss:tss, mode 0700. However, the tcsd    daemon when started as root drops to user tss too late. As root the    daemon creates at least the following file in the state directory    (taken from strace output):     openat(AT_FDCWD, "/var/lib/tpm/system.data", O_RDWR|O_CREAT, 0600) = 4     This means a compromised tss user account can prepare a symlink    attack in this path, causing arbitrary paths to be    created/overwritten in the system. This is at least a local    denial-of-service attack vector.  2) tcsd only drops the root user id via `setuid()` but not the root    group id. Therefore tcsd continues to run with root group privileges.    Should the daemon be compromised then the root group privileges can    be used to extend privileges beyond what the tcsd actually needs to    have.  3) Furthermore the spec file example [2] in the trousers repository is    not using safe file and directory modes:     ```    %post    # create the default location for the persistent store files    if test -e %{_localstatedir}/tpm; then    	mkdir -p %{_localstatedir}/tpm    	/bin/chown tss:tss %{_localstatedir}/tpm    	/bin/chmod 1777 %{_localstatedir}/tpm    fi     # chown the daemon    /bin/chown tss:tss %{_sbindir}/tcsd    ```     The localstatedir being world-readable and carrying a sticky bit    doesn't make much sense. It also fosters further symlink attacks    available to all users. Furthermore it might present an information    leak depending on the data stored e.g. in /var/lib/tpm/system.data.     The `chown tss:tss /usr/sbin/tcsd` would allow a local root exploit,    because it allows the tss user to replace this program by a different    one, which will then potentially be run by the root user.  I've been looking in a couple of distributions and I found out the following:  - Debian and Gentoo are not affected by 1), 2) since they use init   scripts with start-stop-daemon and run tscd directly as the tss user.  - SUSE and Fedora/RedHat use systemd units to start tcsd as root and   rely on the daemon to drop privileges accordingly. Therefore they are   affected by 1), 2).  As a quick protection measure I recommend to run tcsd directly as the tss user via systemd or init scripts and thus don't rely on the tscd privilege drop logic. This should only require appropriate permissions for /var/lib/tpm and the /dev/tpm0 device (via e.g. udev rules) to work.  To fix the TrouSerS code I recommend to either:  a) remove the privilege drop code completely, refuse running as root and    require the daemon always to be run as the tss user  or  b) move the privilege drop code into an earlier stage of the daemon    code, before any files are written, and to also drop the root gid to    the tss gid.  At SUSE we follow a security disclosure policy [3] that allows the issue to remain private for up to 90 days. Please inform me whether you can confirm the findings described above and how long you want to keep it private, if at all. Also please tell me whether you want to assign CVE identifiers for the individual findings, and how you intend to handle the further disclosure process.  Thank you  Matthias  [1]: <https://sourceforge.net/p/trousers/trousers/ci/master/tree/README> [2]: <https://sourceforge.net/p/trousers/trousers/ci/master/tree/dist/trousers.spec.in> [3]: [https://en.opensuse.org/openSUSE:Security_disclosure_policy](https://en.opensuse.org/openSUSE%3ASecurity_disclosure_policy) ```  This bug here is mostly about item 1) which clearly deserves a CVE. item 2) is closely related, could use its separate bug and CVE. Since with 2) a compromised tss account can still cause symlink attacks for files where the root group has write permission. 3) is more a cosmetical kind of thing, I hope. Not used in SUSE packages this way anyways.  I communicated the security policy to upstream therefore tracking the latest CRD here accordingly:  CRD: 2020-05-19 or earlier ``` [Comment 1](show_bug.cgi?id=1164472#c1)  Matthias Gerstner   2020-04-02 08:04:36 UTC  ``` As it turned out the security contact address in the upstream README was wrong. I tried the regular maintainer debora@linux.ibm.com instead. From her I've got a reply on 2020-03-16. She wants to look into it but since then nothing new. ``` [Comment 2](show_bug.cgi?id=1164472#c2)  Matthias Gerstner   2020-05-20 08:41:25 UTC  ``` So this issue is going to be published now without support from upstream since there is no reply. I will first try to fix our own packaging. We can't pull a CVE at the moment, because IBM is a CNA themselves. If they don't react even after publication then we can still approach Mitre to get one ourselves. ``` [Comment 3](show_bug.cgi?id=1164472#c3)  Matthias Gerstner   2020-05-20 08:52:47 UTC  ``` In the current upstream code in src/tcsd/svrside.c:458 (main function) is a call to `tcsd_startup()` where the vulnerable code is called. The privilege drop of the uid is only done later in src/tcsd/svrside.c:476.  `ps_dirs_init()` checks the `system_ps_dir` (/var/lib/tpm), tries to create it with mode 0700 but does not `chown()` it. If it already exists then it also tries to correct the mode to 0700. This conflicts with our packaging where the mode is set to 0770.  In `ps_init_disk_cache()` the `get_file()` function triggers the open of /var/lib/tpm/system.data with `O_CREAT | O_RDWR`.  To fix this in Factory I'll take the route to start tcsd as the tss user right away. This reduces any risks that might still lurk in the code, because the startup sequence and privilege drop logic seem pretty inconsistent to me, security wise. This also requires a udev rules file to be shipped, however, because currently tcsd opens /dev/tpm0 as root before dropping to the tss uid. It also requires changing the ownership of a possible already existing /var/lib/tpm/system.data to tss.  For backporting to older codestreams I consider adding `O_NOFOLLOW` to the `open()` in `get_file()` and also to additionally drop the gid after initialization. ``` [Comment 4](show_bug.cgi?id=1164472#c4)  Matthias Gerstner   2020-05-20 10:16:21 UTC  ``` The situation is getting worse the more I'm looking into it. It turns out that the /etc/tcsd.conf file MUST be owned by tss:tss mode 600. In this config paths to kernel files as well as to the system_ps_file are defined:   root # grep system_ps_file /etc/tcsd.conf  # Option: system_ps_file  # system_ps_file = /var/lib/tpm/system.data  This means the unprivileged tss user can not only stage a symlink attack in /var/lib/tpm, but it can also change the path where the tcsd is trying to create /var/lib/tpm with mode 0700. Luckily the code isn't `chown()`'ing this path to the tss user, otherwise we'd have a full tss to root privilege escalation.  There might be more attack vectors through the config file like information leaks.  A fix needs to change the mode and ownership of /etc/tcsd.conf to root:tss 0640. There's no need for the tss user to write to this config file. ``` [Comment 5](show_bug.cgi?id=1164472#c5)  OBSbugzilla Bot   2020-05-20 11:40:07 UTC  ``` This is an autogenerated message for OBS integration: This bug (1164472) was mentioned in <https://build.opensuse.org/request/show/807580> Factory / trousers ``` [Comment 8](show_bug.cgi?id=1164472#c8)  Swamp Workflow Management   2020-05-26 19:13:11 UTC  ``` SUSE-RU-2020:1483-1: An update that has one recommended fix can now be installed.  Category: recommended (important) Bug References: 1164472 CVE References:  Sources used: SUSE Linux Enterprise Module for Basesystem 15-SP1 (src):    trousers-0.3.14-6.6.2  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 9](show_bug.cgi?id=1164472#c9)  Swamp Workflow Management   2020-05-26 19:18:05 UTC  ``` SUSE-RU-2020:1484-1: An update that has one recommended fix can now be installed.  Category: recommended (important) Bug References: 1164472 CVE References:  Sources used: SUSE OpenStack Cloud Crowbar 8 (src):    trousers-0.3.14-3.3.1 SUSE OpenStack Cloud 8 (src):    trousers-0.3.14-3.3.1 SUSE Linux Enterprise Software Development Kit 12-SP5 (src):    trousers-0.3.14-3.3.1 SUSE Linux Enterprise Software Development Kit 12-SP4 (src):    trousers-0.3.14-3.3.1 SUSE Linux Enterprise Server for SAP 12-SP3 (src):    trousers-0.3.14-3.3.1 SUSE Linux Enterprise Server 12-SP5 (src):    trousers-0.3.14-3.3.1 SUSE Linux Enterprise Server 12-SP4 (src):    trousers-0.3.14-3.3.1 SUSE Linux Enterprise Server 12-SP3-LTSS (src):    trousers-0.3.14-3.3.1 SUSE Linux Enterprise Server 12-SP3-BCL (src):    trousers-0.3.14-3.3.1 SUSE Enterprise Storage 5 (src):    trousers-0.3.14-3.3.1 HPE Helion Openstack 8 (src):    trousers-0.3.14-3.3.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 10](show_bug.cgi?id=1164472#c10)  Swamp Workflow Management   2020-06-02 07:12:56 UTC  ``` openSUSE-RU-2020:0755-1: An update that has one recommended fix can now be installed.  Category: recommended (important) Bug References: 1164472 CVE References:  Sources used: openSUSE Leap 15.1 (src):    trousers-0.3.14-lp151.4.7.1 ``` [Comment 11](show_bug.cgi?id=1164472#c11)  Matthias Gerstner   2020-06-08 07:56:03 UTC  ``` All updates are submitted. Reassigning to reactive security. ``` [Comment 12](show_bug.cgi?id=1164472#c12)  Alexander Bergmann   2020-08-14 06:49:17 UTC  ``` CVE-2020-24330 was assigned to this bug.  References: <https://nvd.nist.gov/vuln/detail/CVE-2020-24330> ``` [Comment 13](show_bug.cgi?id=1164472#c13)  Alexander Bergmann   2020-08-17 07:52:44 UTC  ``` Three CVEs got assigned to this issue:  - CVE-2020-24330: tcsd daemon is started with root privileges instead of by the tss user, it fails to drop the root gid privilege when no longer needed. - CVE-2020-24331: The tss user still has read and write access to the /etc/tcsd.conf file (which contains various settings related to this daemon). - CVE-2020-24332: The creation of the system.data file is prone to symlink attacks. The tss user can be used to create or corrupt existing files, which could possibly lead to a DoS attack. ``` [Comment 14](show_bug.cgi?id=1164472#c14)  Thomas Leroy   2022-08-09 09:51:38 UTC  ``` Hi Matthias, it seems that we still have the following codestreams affected - SUSE:SLE-11-SP3:Update - SUSE:SLE-12:Update - SUSE:SLE-15:Update  Can it be possible to submit a fix for these three? :) ``` [Comment 17](show_bug.cgi?id=1164472#c17)  Matthias Gerstner   2022-08-10 08:05:52 UTC  ``` (In reply to Thomas Leroy from [comment #14](show_bug.cgi?id=1164472#c14)) > Hi Matthias, it seems that we still have the following codestreams affected > - SUSE:SLE-11-SP3:Update > - SUSE:SLE-12:Update > - SUSE:SLE-15:Update >  > Can it be possible to submit a fix for these three? :)  I submitted updates for these three codestreams. It was not all that easy for the old codestreams but hopefully everything works out. ``` [Comment 18](show_bug.cgi?id=1164472#c18)  Thomas Leroy   2022-08-10 08:06:46 UTC  ``` (In reply to Matthias Gerstner from [comment #17](show_bug.cgi?id=1164472#c17)) > (In reply to Thomas Leroy from [comment #14](show_bug.cgi?id=1164472#c14)) > > Hi Matthias, it seems that we still have the following codestreams affected > > - SUSE:SLE-11-SP3:Update > > - SUSE:SLE-12:Update > > - SUSE:SLE-15:Update > >  > > Can it be possible to submit a fix for these three? :) >  > I submitted updates for these three codestreams. It was not all that easy > for the old codestreams but hopefully everything works out.  Thanks a lot Matthias! ``` [Comment 19](show_bug.cgi?id=1164472#c19)  Swamp Workflow Management   2022-08-12 19:15:39 UTC  ``` SUSE-SU-2022:2798-1: An update that fixes one vulnerability is now available.  Category: security (important) Bug References: 1164472 CVE References: CVE-2020-24330 JIRA References:  Sources used: SUSE Linux Enterprise Server for SAP 15 (src):    trousers-0.3.14-150000.3.3.1 SUSE Linux Enterprise Server 15-LTSS (src):    trousers-0.3.14-150000.3.3.1 SUSE Linux Enterprise High Performance Computing 15-LTSS (src):    trousers-0.3.14-150000.3.3.1 SUSE Linux Enterprise High Performance Computing 15-ESPOS (src):    trousers-0.3.14-150000.3.3.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 20](show_bug.cgi?id=1164472#c20)  Swamp Workflow Management   2022-08-12 19:19:04 UTC  ``` SUSE-SU-2022:2800-1: An update that fixes one vulnerability is now available.  Category: security (important) Bug References: 1164472 CVE References: CVE-2020-24330 JIRA References:  Sources used: SUSE Linux Enterprise Server 12-SP2-BCL (src):    trousers-0.3.13-3.3.1  NOTE: This line indicates an update has been released for the listed product(s). At times this might be only a partial fix. If you have questions please reach out to maintenance coordination. ``` [Comment 21](show_bug.cgi?id=1164472#c21)  Matthias Gerstner   2023-10-16 12:30:33 UTC  ``` Reassigning to (reactive) security team to allow them to close the bug when they deem it appropriate. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=1164472)
* - [XML](show_bug.cgi?ctype=xml&id=1164472)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=1164472)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [IDP Log In](/saml2_login.cgi?idp=IDP&target=show_bug.cgi%3Fid%3D1164472)
  + |
    [Forgot Password](https://idp-portal.suse.com/univention/self-service/#page=passwordreset)

+ Legal:
+ [openSUSE](http://en.opensuse.org/Terms_of_site)
+ [SUSE](https://www.suse.com/company/legal/)



=== Content from lists.fedoraproject.org_b0ebede7_20250119_120113.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/SSDL7COIFCZQMUBNAASNMKMX7W5JUHRD/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/SSDL7COIFCZQMUBNAASNMKMX7W5JUHRD/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/SSDL7COIFCZQMUBNAASNMKMX7W5JUHRD/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/SSDL7COIFCZQMUBNAASNMKMX7W5JUHRD/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-SSDL7COIFCZQMUBNAASNMKMX7W5JUHRD.mbox.gz?message=SSDL7COIFCZQMUBNAASNMKMX7W5JUHRD "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/SSDL7COIFCZQMUBNAASNMKMX7W5JUHRD/#SSDL7COIFCZQMUBNAASNMKMX7W5JUHRD)

# [SECURITY] Fedora 33 Update: trousers-0.3.14-4.fc33

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

4 Nov
2020

4 Nov
'20

7:04 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2020-ab3dace708
2020-11-05 01:02:23.473495
--------------------------------------------------------------------------------

Name : trousers
Product : Fedora 33
Version : 0.3.14
Release : 4.fc33
URL : <http://trousers.sourceforge.net>
Summary : TCG's Software Stack v1.2
Description :
TrouSerS is an implementation of the Trusted Computing Group's Software Stack
(TSS) specification. You can use TrouSerS to write applications that make use
of your TPM hardware. TPM hardware can create, store and use RSA keys
securely (without ever being exposed in memory), verify a platform's software
state using cryptographic hashes and more.

--------------------------------------------------------------------------------
Update Information:

Security update for trousers. Fixes for the following CVEs, plus a fix for
an annocheck warning. - Fix for CVE-2020-24330 (RHBZ#1874824) - Fix for
CVE-2020-24331 (RHBZ#1870057) - Fix for CVE-2020-24332 (RHBZ#1870053)
--------------------------------------------------------------------------------
ChangeLog:

\* Thu Oct 29 2020 Jerry Snitselaar jsnitsel@redhat.com - 0.3.14-4
- Fix for CVE-2020-24330 (RHBZ#1874824)
- Fix for CVE-2020-24331 (RHBZ#1870057)
- Fix for CVE-2020-24332 (RHBZ#1870053)
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #1870053 - CVE-2020-24332 trousers: tss user can be used to create or corrupt existing files, this could lead to DoS [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=1870053>
[ 2 ] Bug #1870057 - CVE-2020-24331 trousers: tss user still has read and write access to the /etc/tcsd.conf file if tcsd is started as root [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=1870057>
[ 3 ] Bug #1874824 - CVE-2020-24330 trousers: fails to drop the root gid privilege when no longer needed [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=1874824>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2020-ab3dace708' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/SSDL7COIFCZQMUBNAASNMKMX7W5JUHRD/#SSDL7COIFCZQMUBNAASNMKMX7W5JUHRD)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from bugzilla.redhat.com_69905a39_20250119_134523.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1870053)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1870053)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1870053)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1870053

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1870053**](show_bug.cgi?id=1870053)
- [CVE-2020-24332](https://access.redhat.com/security/cve/CVE-2020-24332) trousers: tss user can be used to create or corrupt existing files, this could lead to DoS [fedora-all]

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2020-24332 trousers: tss user can be used to create or corrupt existing f...

| | [Keywords](describekeywords.cgi): | Security  SecurityTracking | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Fedora | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Fedora | | [Component:](describecomponents.cgi?product=Fedora "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | trousers | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 32 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Jerry Snitselaar | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Fedora Extras Quality Assurance | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [CVE-2020-24332](show_bug.cgi?id=1870052 "CLOSED ERRATA - CVE-2020-24332 trousers: tss user can be used to create or corrupt existing files, this could lead to DoS") | | TreeView+ | [depends on](buglist.cgi?bug_id=1870053&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1870053&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2020-08-19 09:38 UTC by Marian Rehak | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2020-11-05 01:03 UTC ([History](show_activity.cgi?id=1870053)) | | [CC List:](page.cgi?id=fields.html#cclist) | 2 users (show)  igor.raits jsnitsel | | Fixed In Version: | trousers-0.3.14-4.fc33 | | | Doc Type: | No Doc Update | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2020-11-05 01:03:12 UTC | | | Type: | --- | | | Embargoed: |  | | | [Dependent Products:](page.cgi?id=fields.html#dependent_products "Other Products that are affected by this bug.") | Ember-CSI Red Hat Enterprise Virtualization Manager Red Hat OpenStack Service Telemetry Framework | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1870053#c0)  Marian Rehak    2020-08-19 09:38:46 UTC  ```  This is an automatically created tracking bug!  It was created to ensure that one or more security vulnerabilities are fixed in affected versions of fedora-all.  For comments that are specific to the vulnerability please use bugs filed against the "Security Response" product referenced in the "Blocks" field.  For more information see: <http://fedoraproject.org/wiki/Security/TrackingBugs>  When submitting as an update, use the fedpkg template provided in the next comment(s).  This will include the bug IDs of this tracking bug as well as the relevant top-level CVE bugs.  Please also mention the CVE IDs being fixed in the RPM changelog and the fedpkg commit message.  NOTE: this issue affects multiple supported versions of Fedora. While only one tracking bug has been filed, please correct all affected versions at the same time.  If you need to fix the versions independent of each other, you may clone this bug as appropriate.   ```  [Comment 1](show_bug.cgi?id=1870053#c1)  Marian Rehak    2020-08-19 09:38:49 UTC  ``` Use the following template to for the 'fedpkg update' request to submit an update for this issue as it contains the top-level parent bug(s) as well as this tracking bug.  This will ensure that all associated bugs get updated when new packages are pushed to stable.  =====  # bugfix, security, enhancement, newpackage (required) type=security  # low, medium, high, urgent (required) severity=medium  # testing, stable request=testing  # Bug numbers: 1234,9876 bugs=1870052,1870053  # Description of your update notes=Security fix for [PUT CVEs HERE]  # Enable request automation based on the stable/unstable karma thresholds autokarma=True stable_karma=3 unstable_karma=-3  # Automatically close bugs when this marked as stable close_bugs=True  # Suggest that users restart after update suggest_reboot=False  ======  Additionally, you may opt to use the bodhi web interface to submit updates:  <https://bodhi.fedoraproject.org/updates/new>   ```  [Comment 2](show_bug.cgi?id=1870053#c2)  Fedora Update System    2020-10-30 22:09:25 UTC  ``` FEDORA-2020-ab3dace708 has been submitted as an update to Fedora 33. <https://bodhi.fedoraproject.org/updates/FEDORA-2020-ab3dace708>   ```  [Comment 3](show_bug.cgi?id=1870053#c3)  Fedora Update System    2020-10-31 02:56:00 UTC  ``` FEDORA-2020-ab3dace708 has been pushed to the Fedora 33 testing repository. In short time you'll be able to install the update with the following command: `sudo dnf upgrade --enablerepo=updates-testing --advisory=FEDORA-2020-ab3dace708` You can provide feedback for this update here: <https://bodhi.fedoraproject.org/updates/FEDORA-2020-ab3dace708>  See also [https://fedoraproject.org/wiki/QA:Updates_Testing](https://fedoraproject.org/wiki/QA%3AUpdates_Testing) for more information on how to test updates.   ```  [Comment 4](show_bug.cgi?id=1870053#c4)  Fedora Update System    2020-11-05 01:03:12 UTC  ``` FEDORA-2020-ab3dace708 has been pushed to the Fedora 33 stable repository. If problem still persists, please make note of it in this bug report.   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1870053&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)


