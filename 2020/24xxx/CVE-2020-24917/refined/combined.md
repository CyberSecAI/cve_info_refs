=== Content from sisl.lab.uic.edu_75701fb9_20250119_141857.html ===


[University of Illinois Chicago](https://www.uic.edu/)
Search the site

Toggle Menu

Search

[University of Illinois Chicago](https://www.uic.edu/)

[Systems and Internet Security Lab](https://sisl.lab.uic.edu)

* [Projects](/projects/)
  Expand Projects menu

  + [CHESS](/projects/chess/)
  + [MARPLE](/projects/marple/)
  + [CSFV](/projects/csfv/)
  + [ESP-IGERT](/projects/esp-igert-2/)
  + [MALDIVES](/projects/maldives/)
* [People](/people/)
* [Publications](/publications/)
* [News](/news/)
* [Contact](/contact/)

* [Computer Science](https://www.cs.uic.edu/)
* [College of Engineering](https://engineering.uic.edu/)

* [UIC.edu](http://uic.edu)
* [Campus Map](http://maps.uic.edu/)

Search

[# Systems and Internet Security Lab

## UIC Computer Science](https://sisl.lab.uic.edu)

We conduct research on a wide range of topics on systems and Internet security to develop techniques and tools aimed at prevention and detection of cyber attacks.

## Research Areas [Heading link](#research-areas) xml version="1.0" encoding="UTF-8" standalone="no"? Copy link

* Web Security

  We focus on vulnerability analysis and detection of web applications using static and dynamic code analysis, formal methods, and ideas from compilers and OSs
* Mobile Security

  We focus on vulnerability analysis of mobile apps and mobile malware analysis
* Cybercrime

  We focus on automated analysis of for-crime software to understand their behavior and build effective defenses
* Advanced Threats

  We investigate robust techniques to analyze and detect advanced persistent threats

## News [Heading link](#news) xml version="1.0" encoding="UTF-8" standalone="no"? Copy link

[![ieee symposium 2019 ](https://sisl.lab.uic.edu/wp-content/uploads/sites/330/2018/09/ieee-sp-2019-348x342.png)](https://sisl.lab.uic.edu/news-stories/paper-accepted-at-ieee-security-privacy-2019-oakland-2019/)

### [Paper Accepted at IEEE Security & Privacy 2019](https://sisl.lab.uic.edu/news-stories/paper-accepted-at-ieee-security-privacy-2019-oakland-2019/)

Posted on **September 04, 2018**

[![presenting award ](https://sisl.lab.uic.edu/wp-content/uploads/sites/330/2018/09/venkat-usenix-348x342.jpg)](https://sisl.lab.uic.edu/news-stories/paper-receives-distinguished-paper-award-at-the-27th-usenix-security-symposium/)

### [SISL lands Distinguished Paper Award at the 27th USENIX Security Symposium](https://sisl.lab.uic.edu/news-stories/paper-receives-distinguished-paper-award-at-the-27th-usenix-security-symposium/)

Posted on **August 17, 2018**

## [More News](https://sisl.lab.uic.edu/news/)

## projects [Heading link](#projects) xml version="1.0" encoding="UTF-8" standalone="no"? Copy link

* [![people](https://sisl.lab.uic.edu/wp-content/uploads/sites/330/2018/06/people-600x397.png)

  People](https://sisl.lab.uic.edu/people/)
* [![projects](https://sisl.lab.uic.edu/wp-content/uploads/sites/330/2018/06/projects-600x397.png)

  Projects](https://sisl.lab.uic.edu/projects/)
* [![publications](https://sisl.lab.uic.edu/wp-content/uploads/sites/330/2018/06/publications-600x397.png)

  Publications](https://sisl.lab.uic.edu/publications/)

## Featured Project [Heading link](#featured-project) xml version="1.0" encoding="UTF-8" standalone="no"? Copy link

­

![malware](https://sisl.lab.uic.edu/wp-content/uploads/sites/330/2018/06/malware-tile-550x550.png)

## CHESS: Computers and Humans Exploring Software Security [Heading link](#chess-computers-and-humans-exploring-software-security) xml version="1.0" encoding="UTF-8" standalone="no"? Copy link

The CHESS project seeks to scale analysis of programs to find vulnerabilities, exploits, and patches with the help of human users.

[Go to Project](https://sisl.lab.uic.edu/projects/chess/)

 [University of Illinois Chicago](https://www.uic.edu/)

## Contact

## Social Media Accounts

## UIC.edu links

* **[UIC.edu](https://uic.edu/)**
* [Academic Calendar](https://catalog.uic.edu/ucat/academic-calendar/)
* [Athletics](https://uicflames.com/)
* [Campus Directory](https://www.uic.edu/apps/departments-az/search)
* [Disability Resources](https://disabilityresources.uic.edu/)
* [Emergency Information](https://emergency.uic.edu/)
* [Event Calendar](https://today.uic.edu/events)
* [Job Openings](https://uic.edu/about/job-opportunities)
* [Library](https://library.uic.edu/)
* [Maps](https://maps.uic.edu/)
* [UIC Safe Mobile App](https://ready.uic.edu/digital-materials/uic-safe-mobile-app/)
* [UIC Today](https://today.uic.edu/)
* [UI Health](https://uihealth.uic.edu/)
* [Veterans Affairs](https://dos.uic.edu/student-veterans-affairs/)
* [Report a Concern](https://reportaconcern.uic.edu/)

Powered by Red 3.0.51
© 2025 The Board of Trustees of the University of Illinois |
[Privacy Statement](https://www.vpaa.uillinois.edu/resources/web_privacy)

## Campuses

* [University of Illinois System](https://www.uillinois.edu/)
* [Urbana-Champaign](https://illinois.edu/)
* [Springfield](https://www.uis.edu/)
* [Chicago](https://www.uic.edu/)



=== Content from sisl.lab.uic.edu_eacadb71_20250119_124752.html ===


[University of Illinois Chicago](https://www.uic.edu/)
Search the site

Toggle Menu

Search

[University of Illinois Chicago](https://www.uic.edu/)

[Systems and Internet Security Lab](https://sisl.lab.uic.edu)

* [Projects](/projects/)
  Expand Projects menu

  + [CHESS](/projects/chess/)
  + [MARPLE](/projects/marple/)
  + [CSFV](/projects/csfv/)
  + [ESP-IGERT](/projects/esp-igert-2/)
  + [MALDIVES](/projects/maldives/)
* [People](/people/)
* [Publications](/publications/)
* [News](/news/)
* [Contact](/contact/)

* [Computer Science](https://www.cs.uic.edu/)
* [College of Engineering](https://engineering.uic.edu/)

* [UIC.edu](http://uic.edu)
* [Campus Map](http://maps.uic.edu/)

Search

[## Systems and Internet Security Lab

## UIC Computer Science](https://sisl.lab.uic.edu)

[View Menu
Down arrow icon](#menu-secondary)

1. [Systems and Internet Security Lab](https://sisl.lab.uic.edu)
2. [Projects](https://sisl.lab.uic.edu/projects/)
3. [CHESS](https://sisl.lab.uic.edu/projects/chess/)
4. Cross site scripting in OsTicket (CVE-2020-24917)

# Cross site scripting in OsTicket (CVE-2020-24917)

## Cross site scripting in osTicket (CVE CVE-2020-24917) [Heading link](#cross-site-scripting-in-osticket-cve-cve-2020-24917) xml version="1.0" encoding="UTF-8" standalone="no"? Copy link

A cross site scripting vulnerability is present in OsTicket before version 1.14.3

The vulnerability was found automatically by the NAVEX project, in the file [ajax.draft.php](https://github.com/osTicket/osTicket/blob/8202e62acc37a542868d77751baa8c0ab33254d2/include/ajax.draft.php), inside the function \_uploadInlineImage().

Here’s the vulnerable code snippet (non relevant lines have been omitted for clarity):

```
$file = AttachmentFile::format($_FILES['file']);
$ids = $draft->attachments->upload($file);
$id = (is_array($ids)) ? $ids[0] : $ids;
if (!($f = AttachmentFile::lookup($id)))
    return Http::response(500, 'Unable to attach image');

echo JsonDataEncoder::encode(array(
            $f->getName() => array(
            'content_id' => 'cid:'.$f->getKey(),
            'id' => $f->getKey(),
            // Return draft_id to connect the auto draft creation
            'draft_id' => $draft->getId(),
            'url' => $f->getDownloadUrl(
                ['type' => 'D', 'deposition' => 'inline']),
        )));

```

This endpoint is meant to be called by Javascript code in the frontend when a file is uploaded via the Javascript text editor, and returns a JSON with some information on the uploaded file.

However, the name of the uploaded file (which is user-controlled) is reflected back into the echoed JSON.

This combined with an insufficient CSRF protection, and the lack of a Content-type header in this endpoint, allow an attacker to execute arbitrary JS code in a victim’s browser.

We contacted the developers which responded immediately, and fixed the vulnerability very soon after disclosure, in release 1.14.3

## [Projects](https://sisl.lab.uic.edu/projects/)

[Back to main content](#red-main)

* [CHESS](/projects/chess/)
* [MARPLE](/projects/marple/)
* [CSFV](/projects/csfv/)
* [ESP-IGERT](/projects/esp-igert-2/)
* [MALDIVES](/projects/maldives/)

 [University of Illinois Chicago](https://www.uic.edu/)

## Contact

## Social Media Accounts

## UIC.edu links

* **[UIC.edu](https://uic.edu/)**
* [Academic Calendar](https://catalog.uic.edu/ucat/academic-calendar/)
* [Athletics](https://uicflames.com/)
* [Campus Directory](https://www.uic.edu/apps/departments-az/search)
* [Disability Resources](https://disabilityresources.uic.edu/)
* [Emergency Information](https://emergency.uic.edu/)
* [Event Calendar](https://today.uic.edu/events)
* [Job Openings](https://uic.edu/about/job-opportunities)
* [Library](https://library.uic.edu/)
* [Maps](https://maps.uic.edu/)
* [UIC Safe Mobile App](https://ready.uic.edu/digital-materials/uic-safe-mobile-app/)
* [UIC Today](https://today.uic.edu/)
* [UI Health](https://uihealth.uic.edu/)
* [Veterans Affairs](https://dos.uic.edu/student-veterans-affairs/)
* [Report a Concern](https://reportaconcern.uic.edu/)

Powered by Red 3.0.51
© 2025 The Board of Trustees of the University of Illinois |
[Privacy Statement](https://www.vpaa.uillinois.edu/resources/web_privacy)

## Campuses

* [University of Illinois System](https://www.uillinois.edu/)
* [Urbana-Champaign](https://illinois.edu/)
* [Springfield](https://www.uis.edu/)
* [Chicago](https://www.uic.edu/)



=== Content from github.com_5adacf85_20250119_124750.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FosTicket%2FosTicket%2Fcompare%2Fv1.14.2...v1.14.3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FosTicket%2FosTicket%2Fcompare%2Fv1.14.2...v1.14.3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcompare%2Fshow&source=header-repo&source_repo=osTicket%2FosTicket)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[osTicket](/osTicket)
/
**[osTicket](/osTicket/osTicket)**
Public

* [Notifications](/login?return_to=%2FosTicket%2FosTicket) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2FosTicket%2FosTicket)
* [Star
   3.3k](/login?return_to=%2FosTicket%2FosTicket)

* [Code](/osTicket/osTicket)
* [Issues
  825](/osTicket/osTicket/issues)
* [Pull requests
  337](/osTicket/osTicket/pulls)
* [Discussions](/osTicket/osTicket/discussions)
* [Actions](/osTicket/osTicket/actions)
* [Projects
  0](/osTicket/osTicket/projects)
* [Wiki](/osTicket/osTicket/wiki)
* [Security](/osTicket/osTicket/security)
* [Insights](/osTicket/osTicket/pulse)

Additional navigation options

* [Code](/osTicket/osTicket)
* [Issues](/osTicket/osTicket/issues)
* [Pull requests](/osTicket/osTicket/pulls)
* [Discussions](/osTicket/osTicket/discussions)
* [Actions](/osTicket/osTicket/actions)
* [Projects](/osTicket/osTicket/projects)
* [Wiki](/osTicket/osTicket/wiki)
* [Security](/osTicket/osTicket/security)
* [Insights](/osTicket/osTicket/pulse)

[Permalink](https://github.com/osTicket/osTicket/compare/osTicket%3Acba6035...osTicket%3Af4f5bc6)
# Comparing changes

 Choose two branches to see what’s changed or to start a new pull request.
If you need to, you can also  compare across forks
 or
[learn more about diff comparisons](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

# Open a pull request

 Create a new pull request by comparing changes across two branches. If you need to, you can also  compare across forks
.
[Learn more about diff comparisons here](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

*base repository:*
osTicket/osTicket

Failed to load repositories. Confirm that selected base ref is valid, then try again.

 Loading

*base:*
v1.14.2

Choose a base ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/osTicket/osTicket/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.14.3)

Could not load tags

Nothing to show

[{{ refName }}
default](/osTicket/osTicket/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.14.3)

 Loading

...

*head repository:*
osTicket/osTicket

Failed to load repositories. Confirm that selected head ref is valid, then try again.

 Loading

*compare:*
v1.14.3

Choose a head ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/osTicket/osTicket/compare/v1.14.2...%7B%7B%20urlEncodedRefName%20%7D%7D)

Could not load tags

Nothing to show

[{{ refName }}
default](/osTicket/osTicket/compare/v1.14.2...%7B%7B%20urlEncodedRefName%20%7D%7D)

 Loading

6
contributors

[Commits
127](#commits_bucket)
[Files changed
78](#files_bucket)

 Loading

 Loading

### This comparison is taking too long to generate.

Unfortunately it looks like we can’t render this comparison for you right now. It might be too big, or there might be something weird with your repository.

You can try running this command locally to see the comparison on your machine:

`git diff v1.14.2...v1.14.3`

  Retry

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_1ba9e2c7_20250119_124749.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FosTicket%2FosTicket%2Fcommit%2F518de223933eab0c5558741ce317f36958ef193d)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FosTicket%2FosTicket%2Fcommit%2F518de223933eab0c5558741ce317f36958ef193d)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=osTicket%2FosTicket)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[osTicket](/osTicket)
/
**[osTicket](/osTicket/osTicket)**
Public

* [Notifications](/login?return_to=%2FosTicket%2FosTicket) You must be signed in to change notification settings
* [Fork
  1.7k](/login?return_to=%2FosTicket%2FosTicket)
* [Star
   3.3k](/login?return_to=%2FosTicket%2FosTicket)

* [Code](/osTicket/osTicket)
* [Issues
  825](/osTicket/osTicket/issues)
* [Pull requests
  337](/osTicket/osTicket/pulls)
* [Discussions](/osTicket/osTicket/discussions)
* [Actions](/osTicket/osTicket/actions)
* [Projects
  0](/osTicket/osTicket/projects)
* [Wiki](/osTicket/osTicket/wiki)
* [Security](/osTicket/osTicket/security)
* [Insights](/osTicket/osTicket/pulse)

Additional navigation options

* [Code](/osTicket/osTicket)
* [Issues](/osTicket/osTicket/issues)
* [Pull requests](/osTicket/osTicket/pulls)
* [Discussions](/osTicket/osTicket/discussions)
* [Actions](/osTicket/osTicket/actions)
* [Projects](/osTicket/osTicket/projects)
* [Wiki](/osTicket/osTicket/wiki)
* [Security](/osTicket/osTicket/security)
* [Insights](/osTicket/osTicket/pulse)

## Commit

[Permalink](/osTicket/osTicket/commit/518de223933eab0c5558741ce317f36958ef193d)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

xss: Draft Uploaded Attachment

[Browse files](/osTicket/osTicket/tree/518de223933eab0c5558741ce317f36958ef193d)
Browse the repository at this point in the history

```
This mitigates an XSS vulnerability reported by [The NAVEX
Project](<https://sisl.lab.uic.edu/projects/chess/>) where if an attachment is
uploaded via Draft AJAX, the filename stored/returned in the response is not
sanitized. This updates `DraftAjaxAPI::_uploadInlineImage()` to sanitize the
filename before it's returned in the JSON encoded response. This also
updates `AttachmentFile::format()` to sanitize the filename before saving to
the backend. In addition this forces the `application/json` Content-Type on
all AJAX responses that return strictly JSON; this adds another layer of
protection.
```

* Loading branch information

[![@JediKev](https://avatars.githubusercontent.com/u/11823401?s=40&v=4)](/JediKev)

[JediKev](/osTicket/osTicket/commits?author=JediKev "View all commits by JediKev")
committed
Aug 19, 2020

1 parent
[d98c2d0](/osTicket/osTicket/commit/d98c2d096aeb8876c6ab2f88317cd371d781f14d)

commit 518de22

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**12 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* include

  + include/ajax.draft.php
    [ajax.draft.php](#diff-0bfad519c15c29da532d6a18a81d88e8c8e52297b1fda11d61fffec0b1ece613)
  + include/ajax.forms.php
    [ajax.forms.php](#diff-03f7d5d933cd3483874ddf221a4a0bf371aa9cfe97b287e28663171682805485)
  + include/ajax.i18n.php
    [ajax.i18n.php](#diff-401639be9b3244c0029cec17cb0aac2827a1b2f3a824b776cbf780e7a092174a)
  + include/class.file.php
    [class.file.php](#diff-9fe047d3c383c78f732a882dd8bd4ef7bb3f3fb6bf58930bd6407a22eed33cc7)

## There are no files selected for viewing

6 changes: 5 additions & 1 deletion

6
[include/ajax.draft.php](#diff-0bfad519c15c29da532d6a18a81d88e8c8e52297b1fda11d61fffec0b1ece613 "include/ajax.draft.php")

Show comments

[View file](/osTicket/osTicket/blob/518de223933eab0c5558741ce317f36958ef193d/include/ajax.draft.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,6 +16,7 @@ function \_createDraft($vars) { |
|  |  | if (!($draft = Draft::create($vars)) || !$draft->save()) |
|  |  | Http::response(500, 'Unable to create draft'); |
|  |  |  |
|  |  | header('Content-Type: application/json; charset=UTF-8'); |
|  |  | echo JsonDataEncoder::encode(array( |
|  |  | 'draft\_id' => $draft->getId(), |
|  |  | )); |
| Expand All | | @@ -27,6 +28,7 @@ function \_getDraft($draft) { |
|  |  |  |
|  |  | $body = Format::viewableImages($draft->getBody()); |
|  |  |  |
|  |  | header('Content-Type: application/json; charset=UTF-8'); |
|  |  | echo JsonDataEncoder::encode(array( |
|  |  | 'body' => $body, |
|  |  | 'draft\_id' => $draft->getId(), |
| Expand Down  Expand Up | | @@ -126,8 +128,9 @@ function \_uploadInlineImage($draft) { |
|  |  | if (!($f = AttachmentFile::lookup($id))) |
|  |  | return Http::response(500, 'Unable to attach image'); |
|  |  |  |
|  |  | header('Content-Type: application/json; charset=UTF-8'); |
|  |  | echo JsonDataEncoder::encode(array( |
|  |  | $f->getName() => array( |
|  |  | Format::sanitize($f->getName()) => array( |
|  |  | 'content\_id' => 'cid:'.$f->getKey(), |
|  |  | 'id' => $f->getKey(), |
|  |  | // Return draft\_id to connect the auto draft creation |
| Expand Down  Expand Up | | @@ -369,6 +372,7 @@ function getFileList() { |
|  |  | 'title' => $f->getName(), |
|  |  | ); |
|  |  | } |
|  |  | header('Content-Type: application/json; charset=UTF-8'); |
|  |  | echo JsonDataEncoder::encode($files); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[include/ajax.forms.php](#diff-03f7d5d933cd3483874ddf221a4a0bf371aa9cfe97b287e28663171682805485 "include/ajax.forms.php")

Show comments

[View file](/osTicket/osTicket/blob/518de223933eab0c5558741ce317f36958ef193d/include/ajax.forms.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -382,6 +382,7 @@ function upload($id) { |
|  |  | if (!$impl instanceof FileUploadField) |
|  |  | Http::response(400, 'Upload to a non file-field'); |
|  |  |  |
|  |  | header('Content-Type: application/json; charset=UTF-8'); |
|  |  | return JsonDataEncoder::encode( |
|  |  | array('id'=>$impl->ajaxUpload()) |
|  |  | ); |
| Expand All | | @@ -404,6 +405,7 @@ function attach($object=null) { |
|  |  | ->first()->getConfiguration(); |
|  |  | $field = new FileUploadField(); |
|  |  | $field->\_config = $config; |
|  |  | header('Content-Type: application/json; charset=UTF-8'); |
|  |  | return JsonDataEncoder::encode( |
|  |  | array('id'=>$field->ajaxUpload($thisstaff ? true : false)) |
|  |  | ); |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[include/ajax.i18n.php](#diff-401639be9b3244c0029cec17cb0aac2827a1b2f3a824b776cbf780e7a092174a "include/ajax.i18n.php")

Show comments

[View file](/osTicket/osTicket/blob/518de223933eab0c5558741ce317f36958ef193d/include/ajax.i18n.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -49,6 +49,7 @@ function getTranslations($tag) { |
|  |  | $json = JsonDataEncoder::encode($phrases) ?: '{}'; |
|  |  | //Http::cacheable(md5($json), $lm); |
|  |  |  |
|  |  | header('Content-Type: application/json; charset=UTF-8'); |
|  |  | return $json; |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -124,6 +125,7 @@ function getConfiguredLanguages() { |
|  |  | $json = JsonDataEncoder::encode($langs); |
|  |  | Http::cacheable(md5($json), $cfg->lastModified()); |
|  |  |  |
|  |  | header('Content-Type: application/json; charset=UTF-8'); |
|  |  | return $json; |
|  |  | } |
|  |  |  |
| Expand All | | @@ -142,6 +144,7 @@ function getSecondaryLanguages() { |
|  |  | $json = JsonDataEncoder::encode($langs); |
|  |  | Http::cacheable(md5($json), $cfg->lastModified()); |
|  |  |  |
|  |  | header('Content-Type: application/json; charset=UTF-8'); |
|  |  | return $json; |
|  |  | } |
|  |  | } |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[include/class.file.php](#diff-9fe047d3c383c78f732a882dd8bd4ef7bb3f3fb6bf58930bd6407a22eed33cc7 "include/class.file.php")

Show comments

[View file](/osTicket/osTicket/blob/518de223933eab0c5558741ce317f36958ef193d/include/class.file.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -633,6 +633,8 @@ function format($files) { |
|  |  |  |
|  |  | //Basic validation. |
|  |  | foreach($attachments as $i => &$file) { |
|  |  | $file['name'] = Format::sanitize($file['name']); |
|  |  |  |
|  |  | //skip no file upload "error" - why PHP calls it an error is beyond me. |
|  |  | if($file['error'] && $file['error']==UPLOAD\_ERR\_NO\_FILE) { |
|  |  | unset($attachments[$i]); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `518de22`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FosTicket%2FosTicket%2Fcommit%2F518de223933eab0c5558741ce317f36958ef193d) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from sisl.lab.uic.edu_ec7e3327_20250119_141854.html ===


[University of Illinois Chicago](https://www.uic.edu/)
Search the site

Toggle Menu

Search

[University of Illinois Chicago](https://www.uic.edu/)

[Systems and Internet Security Lab](https://sisl.lab.uic.edu)

* [Projects](/projects/)
  Expand Projects menu

  + [CHESS](/projects/chess/)
  + [MARPLE](/projects/marple/)
  + [CSFV](/projects/csfv/)
  + [ESP-IGERT](/projects/esp-igert-2/)
  + [MALDIVES](/projects/maldives/)
* [People](/people/)
* [Publications](/publications/)
* [News](/news/)
* [Contact](/contact/)

* [Computer Science](https://www.cs.uic.edu/)
* [College of Engineering](https://engineering.uic.edu/)

* [UIC.edu](http://uic.edu)
* [Campus Map](http://maps.uic.edu/)

Search

[## Systems and Internet Security Lab

## UIC Computer Science](https://sisl.lab.uic.edu)

[View Menu
Down arrow icon](#menu-secondary)

1. [Systems and Internet Security Lab](https://sisl.lab.uic.edu)
2. [Projects](https://sisl.lab.uic.edu/projects/)
3. CHESS

# CHESS

GAMEPLAY: Graph Analysis for Mechanized Exploit generation and Patching Leveraging human Assistance for improved Yield

The GAMEPLAY project aims to improve the processes software vulnerabilities detection, exploit generation, and patching. Gameplay is part of the CHESS DARPA program (Computers and Humans Exploring Software Security) whose goal is to "research the effectiveness of enabling computers and humans to collaboratively reason over software artifacts, such as source code and compiled binaries". In GAMEPLAY, we are building tools and methods to discover vulnerabilities and generate exploits for PHP, Javascript, and C/C binaries.

## Participating Institutions: [Heading link](#participating-institutions) xml version="1.0" encoding="UTF-8" standalone="no"? Copy link

* [![uic](https://sisl.lab.uic.edu/wp-content/uploads/sites/330/2018/06/uic_osKhKdj-600x397.png)

  University of Illinois at Chicago](http://www.uic.edu/)
* [![jhu](https://sisl.lab.uic.edu/wp-content/uploads/sites/330/2020/08/JHU_logo-600x397.png)

  Johns Hopkins University](https://www.jhu.edu)
* [![ibm](https://sisl.lab.uic.edu/wp-content/uploads/sites/330/2020/08/UT-Dallas_tex_flame-600x397.png)

  University of Texas at Dallas](https://www.utdallas.edu)

## Prinicipal Investigators: [Heading link](#prinicipal-investigators) xml version="1.0" encoding="UTF-8" standalone="no"? Copy link

* [V.N. Venkatakrishnan](https://www.cs.uic.edu/~venkat/)(UIC)
* [Rigel Gjomemo](https://www.cs.uic.edu/~rgjomemo)(UIC)
* [Kevin Hamlen](https://personal.utdallas.edu/~hamlen/)(UTD)
* Yinzhi Cao (JHU)

## Sponsor: [Heading link](#sponsor) xml version="1.0" encoding="UTF-8" standalone="no"? Copy link

­[DARPA](https://www.darpa.mil/)­

## Results [Heading link](#results) xml version="1.0" encoding="UTF-8" standalone="no"? Copy link

Found Vulnerabilities:

* [OsTicket (CVE-2020-24917)](https://sisl.lab.uic.edu/projects/chess/osticket-xss/)
* [Collabtive (CVE-2020-13655)](https://sisl.lab.uic.edu/projects/chess/cross-site-scripting-in-collabtive/)
* [CePhoenix (CVE-2020-12058)](https://sisl.lab.uic.edu/projects/chess/cross-site-scripting-in-cephoenix/)
* [ZoneMinder (CVE-2020-25729)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25729)
* [ECommerce CodeIgniter (CVE-2020-25086)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25086)
* [ECommerce CodeIgniter (CVE-2020-25087)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25087)
* [ECommerce CodeIgniter (CVE-2020-25088)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25088)
* [ECommerce CodeIgniter (CVE-2020-25089](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25089))
* [ECommerce CodeIgniter (CVE-2020-25090](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25090))
* [ECommerce CodeIgniter (CVE-2020-25091)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25091)
* [ECommerce CodeIgniter (CVE-2020-25092)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25092)
* [ECommerce CodeIgniter (CVE-2020-25093](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25093))

## [Projects](https://sisl.lab.uic.edu/projects/)

[Back to main content](#red-main)

* [CHESS](/projects/chess/)
* [MARPLE](/projects/marple/)
* [CSFV](/projects/csfv/)
* [ESP-IGERT](/projects/esp-igert-2/)
* [MALDIVES](/projects/maldives/)

 [University of Illinois Chicago](https://www.uic.edu/)

## Contact

## Social Media Accounts

## UIC.edu links

* **[UIC.edu](https://uic.edu/)**
* [Academic Calendar](https://catalog.uic.edu/ucat/academic-calendar/)
* [Athletics](https://uicflames.com/)
* [Campus Directory](https://www.uic.edu/apps/departments-az/search)
* [Disability Resources](https://disabilityresources.uic.edu/)
* [Emergency Information](https://emergency.uic.edu/)
* [Event Calendar](https://today.uic.edu/events)
* [Job Openings](https://uic.edu/about/job-opportunities)
* [Library](https://library.uic.edu/)
* [Maps](https://maps.uic.edu/)
* [UIC Safe Mobile App](https://ready.uic.edu/digital-materials/uic-safe-mobile-app/)
* [UIC Today](https://today.uic.edu/)
* [UI Health](https://uihealth.uic.edu/)
* [Veterans Affairs](https://dos.uic.edu/student-veterans-affairs/)
* [Report a Concern](https://reportaconcern.uic.edu/)

Powered by Red 3.0.51
© 2025 The Board of Trustees of the University of Illinois |
[Privacy Statement](https://www.vpaa.uillinois.edu/resources/web_privacy)

## Campuses

* [University of Illinois System](https://www.uillinois.edu/)
* [Urbana-Champaign](https://illinois.edu/)
* [Springfield](https://www.uis.edu/)
* [Chicago](https://www.uic.edu/)



=== Content from sisl.lab.uic.edu_1303329e_20250119_141855.html ===


[University of Illinois Chicago](https://www.uic.edu/)
Search the site

Toggle Menu

Search

[University of Illinois Chicago](https://www.uic.edu/)

[Systems and Internet Security Lab](https://sisl.lab.uic.edu)

* [Projects](/projects/)
  Expand Projects menu

  + [CHESS](/projects/chess/)
  + [MARPLE](/projects/marple/)
  + [CSFV](/projects/csfv/)
  + [ESP-IGERT](/projects/esp-igert-2/)
  + [MALDIVES](/projects/maldives/)
* [People](/people/)
* [Publications](/publications/)
* [News](/news/)
* [Contact](/contact/)

* [Computer Science](https://www.cs.uic.edu/)
* [College of Engineering](https://engineering.uic.edu/)

* [UIC.edu](http://uic.edu)
* [Campus Map](http://maps.uic.edu/)

Search

[## Systems and Internet Security Lab

## UIC Computer Science](https://sisl.lab.uic.edu)

# Projects

[View Menu
Down arrow icon](#menu-secondary)

## ACTIVE PROJECTS [Heading link](#active-projects) xml version="1.0" encoding="UTF-8" standalone="no"? Copy link

* [![maldive](https://sisl.lab.uic.edu/wp-content/uploads/sites/330/2020/08/maldives-tile-600x397.png)

  (2015-2019)

  **Developing a Comprehensive Understanding of Malware Delivery Mechanisms**](https://sisl.lab.uic.edu/projects/maldives/)
* [![marple](https://sisl.lab.uic.edu/wp-content/uploads/sites/330/2020/08/marple-tile-600x397.png)

  (2015-2019)

  **Mitigating APT Damage by Reasoning with Provenance in Large Enterprise Networks**](https://sisl.lab.uic.edu/projects/marple/)
* [![esp-igert](https://sisl.lab.uic.edu/wp-content/uploads/sites/330/2020/08/esp-igert-tile-600x397.png)

  (2012-2017)

  **Electronic Security and Privacy: Technological, Human, Enterprise and Legal Considerations**](https://sisl.lab.uic.edu/projects/esp-igert-2/)
* [![csfv](https://sisl.lab.uic.edu/wp-content/uploads/sites/330/2020/08/csfv-tile-600x397.png)

  (2012-2015)

  **Crowd Sourced Formal Verification**](https://sisl.lab.uic.edu/projects/csfv/)
* [![chess](https://sisl.lab.uic.edu/wp-content/uploads/sites/330/2020/08/chess-tile-600x397.png)

  (2018-2022)

  **Computers and Humans Exploring Software Security**](https://sisl.lab.uic.edu/projects/chess/)

## [Projects](https://sisl.lab.uic.edu/projects/)

[Back to main content](#red-main)

* [CHESS](/projects/chess/)
* [MARPLE](/projects/marple/)
* [CSFV](/projects/csfv/)
* [ESP-IGERT](/projects/esp-igert-2/)
* [MALDIVES](/projects/maldives/)

 [University of Illinois Chicago](https://www.uic.edu/)

## Contact

## Social Media Accounts

## UIC.edu links

* **[UIC.edu](https://uic.edu/)**
* [Academic Calendar](https://catalog.uic.edu/ucat/academic-calendar/)
* [Athletics](https://uicflames.com/)
* [Campus Directory](https://www.uic.edu/apps/departments-az/search)
* [Disability Resources](https://disabilityresources.uic.edu/)
* [Emergency Information](https://emergency.uic.edu/)
* [Event Calendar](https://today.uic.edu/events)
* [Job Openings](https://uic.edu/about/job-opportunities)
* [Library](https://library.uic.edu/)
* [Maps](https://maps.uic.edu/)
* [UIC Safe Mobile App](https://ready.uic.edu/digital-materials/uic-safe-mobile-app/)
* [UIC Today](https://today.uic.edu/)
* [UI Health](https://uihealth.uic.edu/)
* [Veterans Affairs](https://dos.uic.edu/student-veterans-affairs/)
* [Report a Concern](https://reportaconcern.uic.edu/)

Powered by Red 3.0.51
© 2025 The Board of Trustees of the University of Illinois |
[Privacy Statement](https://www.vpaa.uillinois.edu/resources/web_privacy)

## Campuses

* [University of Illinois System](https://www.uillinois.edu/)
* [Urbana-Champaign](https://illinois.edu/)
* [Springfield](https://www.uis.edu/)
* [Chicago](https://www.uic.edu/)


