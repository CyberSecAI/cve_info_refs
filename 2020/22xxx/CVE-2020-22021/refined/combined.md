=== Content from lists.debian.org_928c272e_20250119_112817.html ===


---

[[Date Prev](msg00017.html)][[Date Next](msg00019.html)]
[[Thread Prev](msg00017.html)][[Thread Next](msg00019.html)]
[[Date Index](maillist.html#00018)]
[[Thread Index](threads.html#00018)]

# [SECURITY] [DLA 2742-1] ffmpeg security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2742-1] ffmpeg security update
* *From*: Anton Gladky <gladk@debian.org>
* *Date*: Sun, 15 Aug 2021 06:58:19 +0200 (CEST)
* *Message-id*: <[[üîé]](/msgid-search/20210815045819.3B4714A0284%40thinkpad.localdomain)¬†[20210815045819.3B4714A0284@thinkpad.localdomain](msg00018.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2742-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                         Anton Gladky
August 14, 2021                               <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : ffmpeg
Version        : 7:3.2.15-0+deb9u3
CVE ID         : CVE-2020-21041 CVE-2020-22015 CVE-2020-22016 CVE-2020-22020
                 CVE-2020-22021 CVE-2020-22022 CVE-2020-22023 CVE-2020-22025
                 CVE-2020-22026 CVE-2020-22028 CVE-2020-22031 CVE-2020-22032
                 CVE-2020-22036 CVE-2021-3566 CVE-2021-38114

Multiple issues have been discovered in ffmpeg.

CVE-2020-21041

    Buffer Overflow vulnerability exists via apng_do_inverse_blend in
    libavcodec/pngenc.c, which could let a remote malicious user cause a
    Denial of Service.

CVE-2020-22015

    Buffer Overflow vulnerability in mov_write_video_tag due to the out of
    bounds in libavformat/movenc.c, which could let a remote malicious user
    obtain sensitive information, cause a Denial of Service, or execute
    arbitrary code.

CVE-2020-22016

    A heap-based Buffer Overflow vulnerability at libavcodec/get_bits.h when
    writing .mov files, which might lead to memory corruption and other
    potential consequences.

CVE-2020-22020

    Buffer Overflow vulnerability in the build_diff_map function in
    libavfilter/vf_fieldmatch.c, which could let a remote malicious user cause
    a Denial of Service.

CVE-2020-22021

    Buffer Overflow vulnerability at filter_edges function in
    libavfilter/vf_yadif.c, which could let a remote malicious user cause a
    Denial of Service.

CVE-2020-22022

    A heap-based Buffer Overflow vulnerability exists in filter_frame at
    libavfilter/vf_fieldorder.c, which might lead to memory corruption and other
    potential consequences.

CVE-2020-22023

    A heap-based Buffer Overflow vulnerabililty exists in filter_frame at
    libavfilter/vf_bitplanenoise.c, which might lead to memory corruption and
    other potential consequences.

CVE-2020-22025

    A heap-based Buffer Overflow vulnerability exists in gaussian_blur at
    libavfilter/vf_edgedetect.c, which might lead to memory corruption and other
    potential consequences.

CVE-2020-22026

    Buffer Overflow vulnerability exists in the config_input function at
    libavfilter/af_tremolo.c, which could let a remote malicious user cause a
    Denial of Service.

CVE-2020-22028

    Buffer Overflow vulnerability in filter_vertically_8 at
    libavfilter/vf_avgblur.c, which could cause a remote Denial of Service.

CVE-2020-22031

    A Heap-based Buffer Overflow vulnerability in filter16_complex_low, which
    might lead to memory corruption and other potential consequences.

CVE-2020-22032

    A heap-based Buffer Overflow vulnerability in gaussian_blur, which might
    lead to memory corruption and other potential consequences.

CVE-2020-22036

    A heap-based Buffer Overflow vulnerability in filter_intra at
    libavfilter/vf_bwdif.c, which might lead to memory corruption and other
    potential consequences.

CVE-2021-3566

    The tty demuxer did not have a 'read_probe' function assigned to it. By
    crafting a legitimate "ffconcat" file that references an image, followed by
    a file the triggers the tty demuxer, the contents of the second file will be
    copied into the output file verbatim (as long as the `-vcodec copy` option
    is passed to ffmpeg).

CVE-2021-38114

    libavcodec/dnxhddec.c does not check the return value of the  init_vlc
    function. Crafted DNxHD data can cause unspecified impact.

For Debian 9 stretch, these problems have been fixed in version
7:3.2.15-0+deb9u3.

We recommend that you upgrade your ffmpeg packages.

For the detailed security status of ffmpeg please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/ffmpeg>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEu71F6oGKuG/2fnKF0+Fzg8+n/wYFAmEYnuUACgkQ0+Fzg8+n
/wZjLw//SqRxR5dxNq3k6PHU198Mj9rVuPinsKS1yucBMslAznMYYpIC0PWptNVH
Dv/5ZFLZg6lMmZJ/okNtwBs/ctJF2mBGUlp8xFgmKJlVmKszM4H2WJzvLivN4nAt
IlWCiuS1ODdQEtZOKBiTVi9OEUvjjRZdRFdvmtNlz36ng4mGe2e70sg+leexfhhN
lwCuGP1Zq4u/OuxitlP8VlLciGuFPbxnKhN26pHykrdMnkd1VwE3tyDK1T2jKzZX
hVbpqhDgxTseo5P7g/+Ciz9rm4yYRTA2njzEN+eyA6AQV8ZrYF259BaWaJLqWvLI
RdQmaFeZ3K0DpW3k0PX2BWb0aeV5rltdWjCq12sJr0bMkosEbx2MK0pYdVtCdF1t
uo9DmGLpu1ihwF09BpyQ91dC0NYb8n6opB7bGmif76pkLNROmCNqn2G+AKSwSCig
w9pY+KFf8U6+888fcjI4I9kupbqDuRIOSvtkdVOxcQF6tmkT+mw8nWsUi2WnAux3
DITYEPQvHPxHcfNCSqwoIRVX17gD1S3CbBfpwYJTMEQMHRbdNaybVmdLQGbzGFwL
vxinW2Psd+wRym+pJKGIvLg167GVTDCbH0yRbI1BCG1K4xO1TO8JtGyQSOhR0GPB
4OCMi3/WNTZ+KlBVBjHauqZ34YIaaJ0xxNwL5l+gDgpojIB2+Tw=
=zUxe
-----END PGP SIGNATURE-----

```

---



=== Content from trac.ffmpeg.org_53dcfdcf_20250119_112821.html ===


[![FFmpeg](/ffmpeg-logo.png)](https://ffmpeg.org)

Search:

* [Login](/login)
* [Preferences](/prefs)
* [Help/Guide](/wiki/TracGuide)
* [About Trac](/about)
* [Register](/register)
* [Forgot your password?](/reset_password)

* [Wiki](/wiki)
* [Timeline](/timeline)
* [View Tickets](/report)
* [Search](/search)
* [Tags](/tags)

## Context Navigation

* ![Up-vote](/chrome/vote/aupgray.png)+0![Down-vote](/chrome/vote/adowngray.png)
* ‚Üê [Previous Ticket](/ticket/8239 "Ticket #8239")
* [Next Ticket](/ticket/8241 "Ticket #8241") ‚Üí

---

Opened [5 years ago](/timeline?from=2019-10-11T02%3A12%3A12Z&precision=second "See timeline at Oct 11, 2019, 2:12:12 AM")

Closed [4 years ago](/timeline?from=2021-05-29T09%3A41%3A15Z&precision=second "See timeline at May 29, 2021, 9:41:15 AM")

## [#8240](/ticket/8240) [closed](/query?status=closed) [defect](/query?status=!closed&type=defect) ([fixed](/query?resolution=fixed&status=closed))

# heap-buffer-overflow at libavfilter/vf\_yadif.c

| Reported by: | [Suhwan](/query?reporter=Suhwan&status=!closed) | Owned by: |  |
| --- | --- | --- | --- |
| Priority: | [normal](/query?priority=normal&status=!closed) | Component: | [avfilter](/query?component=avfilter&status=!closed) |
| Version: | [git-master](/query?status=!closed&version=git-master) | Keywords: | [asan](/query?keywords=~asan&status=!closed) |
| Cc: |  | Blocked By: |  |
| Blocking: |  | Reproduced by developer: | [yes](/query?reproduced=1&status=!closed) |
| Analyzed by developer: | [no](/query?analyzed=0&status=!closed) |  |  |

## Description

Summary of the bug:

There is a heap-buffer-overflow at libavfilter/vf\_yadif.c:138 in filter\_edges

I compiled ffmpeg with "--toolchain=clang-asan" to check the heap buffer overflow and attached log file.

How to reproduce:

```
% ffmpeg_g -t 0 -y -r 87 -i $PoC -filter_complex yadif -target dvd -loglevel 0 -map 0 -vbsf imxdump -c:a:72 pgmyuv -c:s:12 r10k -vframes 64 -ab 43k -ar 22050 tmp.tak

ffmpeg version N-95314-g1331e00179 Copyright (c) 2000-2019 the FFmpeg developers
built with clang version 6.0.0-1ubuntu2 (tags/RELEASE_600/final)
configuration: --cc=clang --cxx=clang++ --ld=clang --enable-debug --toolchain=clang-asan

```

Here's ASAN log

```
==32056==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61a00000fc7f at pc 0x0000045836a0 bp 0x7fe17051b7b0 sp 0x7fe17051b7a8
READ of size 1 at 0x61a00000fc7f thread T18
    #0 0x458369f in filter_edges ffmpeg/libavfilter/vf_yadif.c:138:5
    #1 0x458d5b7 in filter_slice ffmpeg/libavfilter/vf_yadif.c:217:13
    #2 0x159e267 in worker_func ffmpeg/libavfilter/pthread.c:50:15
    #3 0x2011cbf9 in run_jobs ffmpeg/libavutil/slicethread.c:61:9
    #4 0x201134fd in thread_worker ffmpeg/libavutil/slicethread.c:85:13
    #5 0x4eb9de in __asan::AsanThread::ThreadStart(unsigned long, __sanitizer::atomic_uintptr_t*) (ffmpeg_g+0x4eb9de)
    #6 0x7fe17dd4b6da in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76da)
    #7 0x7fe17d45088e in clone /build/glibc-OTsEL5/glibc-2.27/misc/../sysdeps/unix/sysv/linux/x86_64/clone.S:95

0x61a00000fc7f is located 1 bytes to the left of 1103-byte region [0x61a00000fc80,0x61a0000100cf)
allocated by thread T1 here:
    #0 0x4de9e8 in posix_memalign (ffmpeg_g+0x4de9e8)
    #1 0x1fd8c0b7 in av_malloc ffmpeg/libavutil/mem.c:87:9
    #2 0x1fb2ded1 in av_buffer_alloc ffmpeg/libavutil/buffer.c:72:12
    #3 0x1fb2ded1 in av_buffer_allocz ffmpeg/libavutil/buffer.c:85
    #4 0x1fb3f521 in pool_alloc_buffer ffmpeg/libavutil/buffer.c:313:26
    #5 0x1fb3f521 in av_buffer_pool_get ffmpeg/libavutil/buffer.c:349
    #6 0xa8eb710 in video_get_buffer ffmpeg/libavcodec/decode.c:1678:23
    #7 0xa8eb710 in avcodec_default_get_buffer2 ffmpeg/libavcodec/decode.c:1717
    #8 0xa90a8db in get_buffer_internal ffmpeg/libavcodec/decode.c:1945:11
    #9 0xa90a8db in ff_get_buffer ffmpeg/libavcodec/decode.c:1970

Thread T18 created by T0 here:
    #0 0x436f80 in pthread_create (ffmpeg_g+0x436f80)
    #1 0x2010fd0c in avpriv_slicethread_create ffmpeg/libavutil/slicethread.c:147:19

Thread T1 created by T0 here:
    #0 0x436f80 in pthread_create (ffmpeg_g+0x436f80)
    #1 0x10ef97df in ff_frame_thread_init ffmpeg/libavcodec/pthread_frame.c:828:15
    #2 0x132987e8 in avcodec_open2 ffmpeg/libavcodec/utils.c:754:15
    #3 0x8795a6 in init_input_stream ffmpeg/fftools/ffmpeg.c:2939:20
    #4 0x8795a6 in transcode_init ffmpeg/fftools/ffmpeg.c:3696
    #5 0x82f7a0 in transcode ffmpeg/fftools/ffmpeg.c:4663:11
    #6 0x81cf5f in main ffmpeg/fftools/ffmpeg.c:4894:9
    #7 0x7fe17d350b96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310

SUMMARY: AddressSanitizer: heap-buffer-overflow ffmpeg/libavfilter/vf_yadif.c:138:5 in filter_edges

```

Please confirm.

Thanks

### Attachments (2)

[gdb\_vf\_yadif\_138](/attachment/ticket/8240/gdb_vf_yadif_138 "View attachment")[‚Äã](/raw-attachment/ticket/8240/gdb_vf_yadif_138 "Download")
(18.3 KB
) - added by Suhwan [5 years ago](/timeline?from=2019-10-11T02%3A12%3A24Z&precision=second "See timeline at Oct 11, 2019, 2:12:24 AM").
[PoC\_vf\_yadif138.webp](/attachment/ticket/8240/PoC_vf_yadif138.webp "View attachment")[‚Äã](/raw-attachment/ticket/8240/PoC_vf_yadif138.webp "Download")
(336 bytes
) - added by Suhwan [5 years ago](/timeline?from=2019-10-11T02%3A12%3A41Z&precision=second "See timeline at Oct 11, 2019, 2:12:41 AM").
poc

Download all attachments as:
[.zip](/zip-attachment/ticket/8240/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (5)

### by Suhwan, [5 years ago](/timeline?from=2019-10-11T02%3A12%3A24Z&precision=second "See timeline at Oct 11, 2019, 2:12:24 AM")

| Attachment: | [*gdb\_vf\_yadif\_138*](/attachment/ticket/8240/gdb_vf_yadif_138)[‚Äã](/raw-attachment/ticket/8240/gdb_vf_yadif_138 "Download") added |
| --- | --- |

### by Suhwan, [5 years ago](/timeline?from=2019-10-11T02%3A12%3A41Z&precision=second "See timeline at Oct 11, 2019, 2:12:41 AM")

| Attachment: | [*PoC\_vf\_yadif138.webp*](/attachment/ticket/8240/PoC_vf_yadif138.webp)[‚Äã](/raw-attachment/ticket/8240/PoC_vf_yadif138.webp "Download") added |
| --- | --- |

poc

### [comment:1](#comment:1) by Elon Musk, [4 years ago](/timeline?from=2021-02-05T12%3A39%3A39Z&precision=second "See timeline at Feb 5, 2021, 12:39:39 PM")

| Component: | undetermined ‚Üí avfilter |
| --- | --- |
| Reproduced by developer: | set |
| Status: | new ‚Üí open |

### [comment:2](#comment:2) by Michael Niedermayer, [4 years ago](/timeline?from=2021-05-29T09%3A22%3A10Z&precision=second "See timeline at May 29, 2021, 9:22:10 AM")

Will post a patch fixing this

### [comment:3](#comment:3) by Michael Niedermayer, [4 years ago](/timeline?from=2021-05-29T09%3A41%3A15Z&precision=second "See timeline at May 29, 2021, 9:41:15 AM")

| Resolution: | ‚Üí fixed |
| --- | --- |
| Status: | open ‚Üí closed |

Patch here: [‚Äãhttps://lists.ffmpeg.org/pipermail/ffmpeg-devel/2021-May/280739.html](https://lists.ffmpeg.org/pipermail/ffmpeg-devel/2021-May/280739.html)

will apply patch soon

**Note:**
See [TracTickets](/wiki/TracTickets)
for help on using tickets.

### Download in other formats:

* [RSS Feed](/ticket/8240?format=rss)
* [Comma-delimited Text](/ticket/8240?format=csv)
* [Tab-delimited Text](/ticket/8240?format=tab)

---

[![Trac Powered](/chrome/common/trac_logo_mini.png)](https://trac.edgewall.org/)

Powered by [**Trac 1.6**](/about)

By [Edgewall Software](http://www.edgewall.org/)
.

Visit the Trac open source project at
<http://trac.edgewall.org/>



=== Content from www.debian.org_7d3dec2e_20250119_112822.html ===


---

[[Date Prev](msg00174.html)][[Date Next](msg00176.html)]
[[Thread Prev](msg00174.html)][[Thread Next](msg00176.html)]
[[Date Index](maillist.html#00175)]
[[Thread Index](threads.html#00175)]

# [SECURITY] [DSA 4990-1] ffmpeg security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4990-1] ffmpeg security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Tue, 19 Oct 2021 18:51:14 +0000
* *Message-id*: <[[üîé]](/msgid-search/20211019185114.GA14597%40seger.debian.org)¬†[20211019185114.GA14597@seger.debian.org](msg00175.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4990-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
October 19, 2021                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : ffmpeg
CVE ID         : CVE-2020-20445 CVE-2020-20446 CVE-2020-20453 CVE-2020-21041
                 CVE-2020-22015 CVE-2020-22016 CVE-2020-22017 CVE-2020-22019
                 CVE-2020-22020 CVE-2020-22021 CVE-2020-22022 CVE-2020-22023
                 CVE-2020-22025 CVE-2020-22026 CVE-2020-22027 CVE-2020-22028
                 CVE-2020-22029 CVE-2020-22030 CVE-2020-22031 CVE-2020-22032
                 CVE-2020-22033 CVE-2020-22034 CVE-2020-22035 CVE-2020-22036
                 CVE-2020-22037 CVE-2020-22049 CVE-2020-22054 CVE-2020-35965
                 CVE-2021-38114 CVE-2021-38171 CVE-2021-38291

Several vulnerabilities have been discovered in the FFmpeg multimedia
framework, which could result in denial of service or potentially the
execution of arbitrary code if malformed files/streams are processed.

For the oldstable distribution (buster), these problems have been fixed
in version 7:4.1.8-0+deb10u1.

We recommend that you upgrade your ffmpeg packages.

For the detailed security status of ffmpeg please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/ffmpeg>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmFvE0MACgkQEMKTtsN8
Tjar1A//XPaJ4SP7JyAs3H845zwESim4+SsoK2sdz5fkFIiaM17lHcVTeQyDbGtw
5E9LfBRw9oxseU+6pCze3LdwqDKhdwiotDgWj4NZ8OJBLz4Iq12nJMkKCXAaTdFp
8pBYhrgLloyl+6Tdc76jBGMT9KhXtaWrNhsI/T01KNMD0yhOMBzgmgOJi7NgoMcS
/mk6TAfW5zGClMWCAVPHwmCx4S6C+8O99pgGdavbBZhtdFqZETgYFln8H3Wpw8V9
93MF4Qbwq7kZ3NLI+Jie5shM50ootzcHa8RP7Aaf+3K4mZ/9ORo8rvJF7mcJi4EG
fE/e0x/Q4bezdFbbgDFVLMzEq9vdO1UevO8gCWlfe17nh+JB3BEiwO9mF+cUuvb5
ySH8FA2W9EWEGEZgdgk2h8suHQ5ELI3sNLPnc9VA2IXF/PVl3Gm3vK3+ELedP5Lw
WK2QlWOiVPkzAvcY8EXtEzIMCdnioMKkrcr5bDzfCeL7FTR0A6St+NKYWO/31R2h
c6WGxAOMXSSSKe1j48mrsbqNlzPv7LwDyjS70ZJ3QrtQ4dp+prxnAD3A4uDk6fyO
7Qs466QF0bYRJP/I0DggKEwQKvdK9MSubSgftz414J+bqfE3WqUOjtUneN4ZTQx0
WXA7cPN/2rolLx2UGygPfqjlTcdFBFwWrBfXpu34jYD7ONiKGTU=
=i0d7
-----END PGP SIGNATURE-----

```

---


