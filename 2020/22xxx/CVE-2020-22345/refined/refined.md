- **Root cause of vulnerability:** The vulnerability stems from the usage of the `popen()` function with a command line argument constructed using a database value that can be modified by an authenticated user. Specifically, the `$RRDdatabase_path` variable, retrieved from the database, is concatenated with other values and passed as an argument to `popen()`.
- **Weaknesses/vulnerabilities present:**
    - **Authenticated Remote Code Execution (RCE):** An authenticated user can inject arbitrary commands by modifying the `RRDdatabase_status_path` value in the database via the `/main.get.php?p=50118` page, which is then used in a `popen()` call.
    - **Insecure use of popen():** The application uses popen() with user-controlled data, allowing for command injection.
- **Impact of exploitation:** Successful exploitation allows an authenticated attacker to execute arbitrary system commands on the server hosting the Centreon application, leading to a complete compromise of the system.
- **Attack vectors:**
    - The attacker must be an authenticated user.
    - The attacker crafts a malicious payload within the `RRDdatabase_status_path` database field via the `updateODSConfigData` function accessible through the web interface at `/main.get.php?p=50118`.
    - The exploit is triggered when the vulnerable `displayServiceStatus.php` script calls popen() with the attacker controlled data.
- **Required attacker capabilities/position:**
    - The attacker needs to have valid credentials to log in to the Centreon application.
    - The attacker must be able to make HTTP requests to the application.
    - The attacker must have knowledge of the vulnerable endpoint within the application.

This content provides more details than the typical CVE description, outlining the specific code locations and steps required for exploitation.