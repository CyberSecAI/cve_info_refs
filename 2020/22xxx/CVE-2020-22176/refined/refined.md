Based on the provided content, the following vulnerabilities exist in the PHPGurukul Hospital Management System v4.0:

**Vulnerability 1: SQL Injection in `hms/user-login.php`**

*   **Root Cause:** The application directly incorporates the user-supplied `username` POST parameter into an SQL query without sanitization or parameterization.
*   **Weakness:** SQL Injection.
*   **Impact:** An unauthenticated remote attacker can manipulate the SQL query to extract sensitive database information. This could include user credentials, patient data, and other sensitive information stored in the database.
*   **Attack Vector:** Sending a crafted POST request to `hms/user-login.php` with a malicious `username` parameter.
*   **Attacker Capabilities:** No specific capabilities are required, just the ability to send HTTP requests.

**Vulnerability 2: SQL Injection in `hms/forgot-password.php`**

*   **Root Cause:** The application directly uses the `fullname` and `email` POST parameters in an SQL query without proper sanitization.
*  **Weakness:** SQL Injection.
*   **Impact:**  An unauthenticated remote attacker can extract sensitive information from the database.
*   **Attack Vector:** Sending a crafted POST request to `hms/forgot-password.php` with malicious `fullname` and `email` parameters.
*   **Attacker Capabilities:** No specific capabilities are required, just the ability to send HTTP requests.

**Vulnerability 3: SQL Injection in `hms/registration.php`**

*   **Root Cause:** The application directly uses the `full_name`, `address`, `city`, `gender`, and `email` POST parameters in an SQL query without sanitization.
*   **Weakness:** SQL Injection.
*   **Impact:** An unauthenticated remote attacker can gain access to database sensitive data by manipulating the SQL query.
*   **Attack Vector:** Sending a crafted POST request to `hms/registration.php` with malicious parameters.
*   **Attacker Capabilities:** No specific capabilities are required, just the ability to send HTTP requests.

**Vulnerability 4: SQL Injection in `hms/edit-profile.php`**

*   **Root Cause:** The application directly incorporates the `fname`, `address`, `city`, and `gender` POST parameters into an SQL query without sanitation. It also relies on a flawed authentication bypass.
*   **Weakness:** SQL Injection, flawed authentication bypass
*   **Impact:** A user can bypass the login check and then manipulate the SQL query to access database information. This is effectively a privilege escalation vulnerability.
*   **Attack Vector:** First, visit `/hms/user-login.php` and submit a login attempt (even with invalid credentials). Then, send a crafted POST request to `hms/edit-profile.php` with malicious parameters.
*   **Attacker Capabilities:** A user needs the ability to send HTTP requests, and needs to know to attempt the authentication bypass.

**Vulnerability 5 & 6: SQL Injection in `hms/get_doctor.php`**

*   **Root Cause:** The application directly uses the `specilizationid` (line 6) and `doctor` (line 20) POST parameters in SQL queries without proper sanitization.
*   **Weakness:** SQL Injection.
*   **Impact:** An unauthenticated remote attacker can manipulate the query to extract database information.
*   **Attack Vector:** Sending a crafted POST request to `hms/get_doctor.php` with malicious parameters.
*   **Attacker Capabilities:** No specific capabilities are required, just the ability to send HTTP requests.

**Vulnerability 7: SQL Injection in `hms/appointment-history.php`**

*   **Root Cause:** The application directly uses the `id` GET parameter in an SQL query without sanitization. It also relies on a flawed authentication bypass.
*   **Weakness:** SQL Injection, flawed authentication bypass
*   **Impact:** A user can bypass the login check and then manipulate the SQL query to extract database information. This is effectively a privilege escalation vulnerability.
*    **Attack Vector:** First, visit `/hms/user-login.php` and submit a login attempt (even with invalid credentials). Then, send a crafted GET request to `hms/appointment-history.php` with a malicious `id` parameter.
*   **Attacker Capabilities:** A user needs the ability to send HTTP requests, and needs to know to attempt the authentication bypass.

**Vulnerability 8: SQL Injection in `hms/book-appointment.php`**

*   **Root Cause:** The application directly incorporates the POST parameters `Doctorspecialization`, `doctor`, `feet`, `appdate`, and `apptime` into an SQL query without sanitization. It also relies on a flawed authentication bypass.
*   **Weakness:** SQL Injection, flawed authentication bypass.
*   **Impact:** A user can bypass the login check and then manipulate the SQL query to extract database information. This is effectively a privilege escalation vulnerability.
*   **Attack Vector:** First, visit `/hms/user-login.php` and submit a login attempt (even with invalid credentials). Then, send a crafted POST request to `hms/book-appointment.php` with malicious parameters.
*   **Attacker Capabilities:** A user needs the ability to send HTTP requests, and needs to know to attempt the authentication bypass.

**Vulnerability 9: SQL Injection in `hms/change-emaild.php`**

*   **Root Cause:** The application directly uses the `email` POST parameter in an SQL query without sanitization. It also relies on a flawed authentication bypass.
*   **Weakness:** SQL Injection, flawed authentication bypass
*   **Impact:** A user can bypass the login check and then manipulate the SQL query to extract database information. This is effectively a privilege escalation vulnerability.
*   **Attack Vector:** First, visit `/hms/user-login.php` and submit a login attempt (even with invalid credentials). Then, send a crafted POST request to `hms/change-emaild.php` with a malicious `email` parameter.
*   **Attacker Capabilities:** A user needs the ability to send HTTP requests, and needs to know to attempt the authentication bypass.

**Vulnerability 10: SQL Injection in `hms/check_availability.php`**

*   **Root Cause:** The application directly uses the `email` POST parameter in an SQL query without sanitization.
*   **Weakness:** SQL Injection
*   **Impact:** An unauthenticated remote attacker can manipulate the SQL query to extract database information.
*   **Attack Vector:** Send a crafted POST request to `hms/check_availability.php` with a malicious `email` parameter.
*   **Attacker Capabilities:** No specific capabilities are required, just the ability to send HTTP requests.

**Vulnerability 11: SQL Injection in `hms/admin/betweendates-detailsreports.php`**

*   **Root Cause:** The application directly incorporates the `fromdate` and `todate` POST parameters into an SQL query without sanitization. It also relies on a flawed authentication bypass.
*    **Weakness:** SQL Injection, flawed authentication bypass
*   **Impact:** A user can bypass the login check and then manipulate the SQL query to extract database information. This is effectively a privilege escalation vulnerability.
*   **Attack Vector:** First, visit `/hms/user-login.php` and submit a login attempt (even with invalid credentials). Then, send a crafted POST request to `hms/admin/betweendates-detailsreports.php` with malicious `fromdate` and `todate` parameters.
*   **Attacker Capabilities:** A user needs the ability to send HTTP requests, and needs to know to attempt the authentication bypass.

**Vulnerability 12: Sensitive Information Disclosure in multiple areas**

*   **Root Cause:** The application does not verify admin permissions before displaying sensitive information in `hms/admin/appointment-history.php` and `hms/admin/manage-users.php`
*   **Weakness:** Improper authorization checks leading to information disclosure
*   **Impact:**  An unauthenticated user can access admin-level data.
*   **Attack Vector:** Directly accessing `hms/admin/appointment-history.php` or `hms/admin/manage-users.php`
*   **Attacker Capabilities:** No specific capabilities are required, just the ability to send HTTP requests.

**Vulnerability 13: Persistent Cross-Site Scripting (XSS) in `hms/admin/appointment-history.php`**

*   **Root Cause:** The application stores user-supplied input from the `Doctorspecialization` parameter in `hms/book-appointment.php` without sanitization and then displays it unsanitized in `hms/admin/appointment-history.php`.
*  **Weakness:** Persistent Cross-Site Scripting (XSS)
*   **Impact:** An attacker can inject malicious JavaScript code that will execute in the administrator's browser when they view the appointment history. This can lead to session hijacking and other malicious actions.
*   **Attack Vector:** A registered user injects malicious javascript via the `Doctorspecialization` parameter when making an appointment. When an administrator views the appointment history the XSS payload is executed.
*   **Attacker Capabilities:** The attacker needs a registered user account and the ability to send HTTP requests.