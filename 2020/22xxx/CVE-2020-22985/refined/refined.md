The provided content discusses multiple reflected Cross-Site Scripting (rXSS) vulnerabilities found in Facebook's implementation of MicroStrategy Web SDK.

**Root Cause of Vulnerability:**
The root cause lies in the improper handling of user-supplied data within the MicroStrategy Web SDK, specifically the `uploadFile` and `wikiScraper` tasks. The application fails to properly encode or sanitize user-provided input before reflecting it back to the user's browser.

**Weaknesses/Vulnerabilities Present:**
- **Reflected Cross-Site Scripting (rXSS):** The `uploadFile` task processes uploaded files and returns their content without encoding, allowing an attacker to inject malicious JavaScript code within a crafted file. Similarly, the `wikiScrapper` task doesn't sanitize or encode the content of a provided URL, which can result in XSS when rendering the scraped web page.

**Impact of Exploitation:**
- **Arbitrary JavaScript Execution:** Successful exploitation allows attackers to execute arbitrary JavaScript code in the context of the victim's browser, specifically under the domain `m-nexus.thefacebook.com`.
- **Data Theft:** Malicious scripts could gather sensitive information about the victim's system and send it to a third party.
- **Manipulation of Application DOM:** Attackers can trick users into performing unintended actions by manipulating the application's Document Object Model (DOM).

**Attack Vectors:**
- **uploadFile Task:**
    -   An attacker crafts a malicious file (e.g., an HTML file containing JavaScript) and uploads it through a specifically crafted HTML form, which bypasses the lack of ability to control file contents via standard HTML forms.
    -   The vulnerable application processes this file and reflects the malicious content in the response without proper encoding, leading to XSS.
-   **wikiScraper Task:**
    -   An attacker crafts a malicious HTML page with Javascript and hosts it on a third-party server.
    -   The attacker then provides a link to this malicious page through the `searchString` parameter of the `wikiScrapper` task.
    -   The vulnerable application fetches the page content and reflects it without proper encoding, resulting in XSS.

**Required Attacker Capabilities/Position:**
-   The attacker needs to be able to send a crafted request to the affected endpoints.
-   For the `uploadFile` vulnerability, the attacker needs to be able to host a malicious HTML page containing JavaScript code to upload the crafted file via POST request.
-   For the `wikiScraper` vulnerability, the attacker needs to host a malicious HTML page with a specific structure (including HTML, BODY, H1 tags, and a table with `wikitable` class), accessible via a URL.
- No special privileges are needed, as the vulnerabilities are triggered client-side.

**Additional Details:**
- The vulnerable MicroStrategy Web SDK was hosted on a Facebook production server under the `m-nexus.thefacebook.com` domain, which is no longer publicly accessible.
- The attacker utilized `jd-gui` to decompile the MicroStrategy Web SDK and analyze its source code to understand the `uploadFile` and `wikiScraper` tasks.
- The attacker created a custom HTML form with JavaScript to bypass the limitation that HTML forms do not allow specifying the file content directly to exploit the `uploadFile` task, successfully injecting the XSS payload into the file.
- The attacker used `htmlpasta.com` to host the malicious page for the `wikiScraper` task.
- The article mentions that Facebook rewarded the reporter with a "five-digit bounty" for these findings, and that they fixed the issues.