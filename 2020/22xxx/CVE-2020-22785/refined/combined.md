=== Content from github.com_f2c12281_20250119_125032.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fether%2Fetherpad-lite%2Fpull%2F3833)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fether%2Fetherpad-lite%2Fpull%2F3833)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=ether%2Fetherpad-lite)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ether](/ether)
/
**[etherpad-lite](/ether/etherpad-lite)**
Public

* [Notifications](/login?return_to=%2Fether%2Fetherpad-lite) You must be signed in to change notification settings
* [Fork
  2.9k](/login?return_to=%2Fether%2Fetherpad-lite)
* [Star
   17k](/login?return_to=%2Fether%2Fetherpad-lite)

* [Code](/ether/etherpad-lite)
* [Issues
  123](/ether/etherpad-lite/issues)
* [Pull requests
  9](/ether/etherpad-lite/pulls)
* [Discussions](/ether/etherpad-lite/discussions)
* [Actions](/ether/etherpad-lite/actions)
* [Projects
  0](/ether/etherpad-lite/projects)
* [Wiki](/ether/etherpad-lite/wiki)
* [Security](/ether/etherpad-lite/security)
* [Insights](/ether/etherpad-lite/pulse)

Additional navigation options

* [Code](/ether/etherpad-lite)
* [Issues](/ether/etherpad-lite/issues)
* [Pull requests](/ether/etherpad-lite/pulls)
* [Discussions](/ether/etherpad-lite/discussions)
* [Actions](/ether/etherpad-lite/actions)
* [Projects](/ether/etherpad-lite/projects)
* [Wiki](/ether/etherpad-lite/wiki)
* [Security](/ether/etherpad-lite/security)
* [Insights](/ether/etherpad-lite/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fether%2Fetherpad-lite%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fether%2Fetherpad-lite%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Import/export max file size & rate limiting. Import only allowed with author present on pad #3833

 Merged

[muxator](/muxator)
merged 21 commits into
[ether:develop](/ether/etherpad-lite/tree/develop "ether/etherpad-lite:develop")
from
[JohnMcLear:rate-limiting](/JohnMcLear/etherpad-lite/tree/rate-limiting "JohnMcLear/etherpad-lite:rate-limiting")

Apr 14, 2020

 Merged

# [Import/export max file size & rate limiting. Import only allowed with author present on pad](#top) #3833

[muxator](/muxator)
merged 21 commits into
[ether:develop](/ether/etherpad-lite/tree/develop "ether/etherpad-lite:develop")
from
[JohnMcLear:rate-limiting](/JohnMcLear/etherpad-lite/tree/rate-limiting "JohnMcLear/etherpad-lite:rate-limiting")

Apr 14, 2020

[Conversation
53](/ether/etherpad-lite/pull/3833)
[Commits
21](/ether/etherpad-lite/pull/3833/commits)
[Checks
0](/ether/etherpad-lite/pull/3833/checks)
[Files changed](/ether/etherpad-lite/pull/3833/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=60&v=4)](/JohnMcLear)

Copy link

Member

### @JohnMcLear **[JohnMcLear](/JohnMcLear)** commented [Apr 4, 2020](#issue-594120318) • edited Loading

* Rate limits
  + Settings
  + Tests <-- can't test without an authorID.
* Restricts import only if user is on pad
  + Settings
  + Tests <-- can't test without an authorID.
* Max file size on import
  + Settings
  + Tests <-- can't test without an authorID

Also

* loadSettings was not getting the correct settings, it was only parsing settings.json and ignoring defaults not present in the settings.json file.

  Tests without creating an authorID is not really feasible, I tried but I can't find a decent way.

This is good to merge as is, knowing that a future job is to write test coverage which includes a method to create an authorID that is present on a specific padID.

Sorry, something went wrong.

All reactions

 [JohnMcLear](/JohnMcLear)
added 15 commits
[March 15, 2020 09:53](#commits-pushed-9ea5ad9)

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[Merge pull request](/ether/etherpad-lite/pull/3833/commits/9ea5ad9317c73879769e2f1c643751e3f74ae0ae "Merge pull request #2 from ether/develop

sdf") [#2](https://github.com/JohnMcLear/etherpad-lite/pull/2) [from ether/develop](/ether/etherpad-lite/pull/3833/commits/9ea5ad9317c73879769e2f1c643751e3f74ae0ae "Merge pull request #2 from ether/develop

sdf")`
 …

`[9ea5ad9](/ether/etherpad-lite/pull/3833/commits/9ea5ad9317c73879769e2f1c643751e3f74ae0ae)`

```
sdf
```

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[Merge pull request](/ether/etherpad-lite/pull/3833/commits/c696165fdd83b667b35806f54a343b7aed30bdf9 "Merge pull request #3 from ether/develop

update") [#3](https://github.com/JohnMcLear/etherpad-lite/pull/3) [from ether/develop](/ether/etherpad-lite/pull/3833/commits/c696165fdd83b667b35806f54a343b7aed30bdf9 "Merge pull request #3 from ether/develop

update")`
 …

`[c696165](/ether/etherpad-lite/pull/3833/commits/c696165fdd83b667b35806f54a343b7aed30bdf9)`

```
update
```

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[Merge pull request](/ether/etherpad-lite/pull/3833/commits/a59d48ce19198089ac9b6d8d4cfd07f985232198 "Merge pull request #4 from ether/develop

Updating") [#4](https://github.com/JohnMcLear/etherpad-lite/pull/4) [from ether/develop](/ether/etherpad-lite/pull/3833/commits/a59d48ce19198089ac9b6d8d4cfd07f985232198 "Merge pull request #4 from ether/develop

Updating")`
 …

`[a59d48c](/ether/etherpad-lite/pull/3833/commits/a59d48ce19198089ac9b6d8d4cfd07f985232198)`

```
Updating
```

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[Merge branch 'develop' of github.com:ether/etherpad-lite into develop](/ether/etherpad-lite/pull/3833/commits/0cf1692547020831ac42a24c8857641412430173 "Merge branch 'develop' of github.com:ether/etherpad-lite into develop")`

`[0cf1692](/ether/etherpad-lite/pull/3833/commits/0cf1692547020831ac42a24c8857641412430173)`

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[Merge branch 'develop' of github.com:ether/etherpad-lite into develop](/ether/etherpad-lite/pull/3833/commits/f5a47dbf799a643a1780c79ee2e5c6c3fb3b50bc "Merge branch 'develop' of github.com:ether/etherpad-lite into develop")`

`[f5a47db](/ether/etherpad-lite/pull/3833/commits/f5a47dbf799a643a1780c79ee2e5c6c3fb3b50bc)`

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[Merge branch 'develop' of github.com:ether/etherpad-lite into develop](/ether/etherpad-lite/pull/3833/commits/a2400ec958295cb1afaade96b5e7e5b1ee8b3ee9 "Merge branch 'develop' of github.com:ether/etherpad-lite into develop")`

`[a2400ec](/ether/etherpad-lite/pull/3833/commits/a2400ec958295cb1afaade96b5e7e5b1ee8b3ee9)`

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[Merge branch 'develop' of github.com:ether/etherpad-lite into develop](/ether/etherpad-lite/pull/3833/commits/d1cb72e11158cf4fea7e3739c4935e2425de5297 "Merge branch 'develop' of github.com:ether/etherpad-lite into develop")`

`[d1cb72e](/ether/etherpad-lite/pull/3833/commits/d1cb72e11158cf4fea7e3739c4935e2425de5297)`

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[Merge pull request](/ether/etherpad-lite/pull/3833/commits/099d18641237f9b5a715b32afe90b92e9696de7f "Merge pull request #6 from ether/develop

update") [#6](https://github.com/JohnMcLear/etherpad-lite/pull/6) [from ether/develop](/ether/etherpad-lite/pull/3833/commits/099d18641237f9b5a715b32afe90b92e9696de7f "Merge pull request #6 from ether/develop

update")`
 …

`[099d186](/ether/etherpad-lite/pull/3833/commits/099d18641237f9b5a715b32afe90b92e9696de7f)`

```
update
```

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[Merge branch 'develop' of github.com:ether/etherpad-lite into develop](/ether/etherpad-lite/pull/3833/commits/387d55cb0b6593d6093f8dfd058bd3df51bf6da7 "Merge branch 'develop' of github.com:ether/etherpad-lite into develop")`

`[387d55c](/ether/etherpad-lite/pull/3833/commits/387d55cb0b6593d6093f8dfd058bd3df51bf6da7)`

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[Merge branch 'develop' of github.com:ether/etherpad-lite into develop](/ether/etherpad-lite/pull/3833/commits/550aff60ef74462560c262df554693831ef62b71 "Merge branch 'develop' of github.com:ether/etherpad-lite into develop")`

`[550aff6](/ether/etherpad-lite/pull/3833/commits/550aff60ef74462560c262df554693831ef62b71)`

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[Merge branch 'develop' of github.com:ether/etherpad-lite into develop](/ether/etherpad-lite/pull/3833/commits/c19ddd49c81820b55c2a494b5ce3df857714f911 "Merge branch 'develop' of github.com:ether/etherpad-lite into develop")`

`[c19ddd4](/ether/etherpad-lite/pull/3833/commits/c19ddd49c81820b55c2a494b5ce3df857714f911)`

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[Merge branch 'develop' of github.com:ether/etherpad-lite into develop](/ether/etherpad-lite/pull/3833/commits/59d5c4a0ab1712eeb79ab0cb60c6d478358dd2f3 "Merge branch 'develop' of github.com:ether/etherpad-lite into develop")`

`[59d5c4a](/ether/etherpad-lite/pull/3833/commits/59d5c4a0ab1712eeb79ab0cb60c6d478358dd2f3)`

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[Merge branch 'develop' of github.com:ether/etherpad-lite into develop](/ether/etherpad-lite/pull/3833/commits/371be0a1369b87d219d5e02388409c788589ce27 "Merge branch 'develop' of github.com:ether/etherpad-lite into develop")`

`[371be0a](/ether/etherpad-lite/pull/3833/commits/371be0a1369b87d219d5e02388409c788589ce27)`

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[Merge branch 'develop' of github.com:ether/etherpad-lite into develop](/ether/etherpad-lite/pull/3833/commits/16daaa540b56ff181cf390749e14e92d1458d8cf "Merge branch 'develop' of github.com:ether/etherpad-lite into develop")`

`[16daaa5](/ether/etherpad-lite/pull/3833/commits/16daaa540b56ff181cf390749e14e92d1458d8cf)`

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[import/export: always rate limit import and exports](/ether/etherpad-lite/pull/3833/commits/1b3737ed866341000b79b7572aa00dc96899af51 "import/export: always rate limit import and exports

This is a departure from previous versions, which did not limit import/export
requests. Now such requests are ALWAYS rate limited. The default is 10 requests
per IP each 90 seconds, and also applies to old instances upgraded to 1.8.3.

Administrators can tune the parameters via settings.importExportRateLimiting.")`
 …

`[1b3737e](/ether/etherpad-lite/pull/3833/commits/1b3737ed866341000b79b7572aa00dc96899af51)`

```
This is a departure from previous versions, which did not limit import/export
requests. Now such requests are ALWAYS rate limited. The default is 10 requests
per IP each 90 seconds, and also applies to old instances upgraded to 1.8.3.

Administrators can tune the parameters via settings.importExportRateLimiting.
```

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&u=9da4d2ce0d3b321b59cfd02ee4879c8632422682&v=4)](/JohnMcLear)
[JohnMcLear](/JohnMcLear)
self-assigned this
[Apr 4, 2020](#event-3200587151)

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&u=9da4d2ce0d3b321b59cfd02ee4879c8632422682&v=4)](/JohnMcLear)
[JohnMcLear](/JohnMcLear)
changed the title
~~Max file size, Rate limiting & can only import with author present on pad - DO NOT MERGE~~
Max file size, Rate limiting & can only import with author present on pad - Ready for review.
[Apr 5, 2020](#event-3202555841)

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&u=9da4d2ce0d3b321b59cfd02ee4879c8632422682&v=4)](/JohnMcLear)
[JohnMcLear](/JohnMcLear)
added this to the
1.8.2 milestone
[Apr 6, 2020](#event-3204011818)

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&u=9da4d2ce0d3b321b59cfd02ee4879c8632422682&v=4)](/JohnMcLear)
[JohnMcLear](/JohnMcLear)
mentioned this pull request
[Apr 6, 2020](#ref-issue-589697740)

[Release 1.8.3: what do we want to include?
#3781](/ether/etherpad-lite/issues/3781)

Closed

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&u=9da4d2ce0d3b321b59cfd02ee4879c8632422682&v=4)](/JohnMcLear)
[JohnMcLear](/JohnMcLear)
modified the milestones:
1.8.2,
[1.8.3](/ether/etherpad-lite/milestone/13)
[Apr 6, 2020](#event-3204052923)

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&u=9da4d2ce0d3b321b59cfd02ee4879c8632422682&v=4)](/JohnMcLear)
[JohnMcLear](/JohnMcLear)
changed the title
~~Max file size, Rate limiting & can only import with author present on pad - Ready for review.~~
URGENT! Max file size, Rate limiting & can only import with author present on pad - Ready for review.
[Apr 9, 2020](#event-3217322885)

 [![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&u=753ff589f3ea8f715e1919101e06931596fe8e22&v=4)](/muxator)
[muxator](/muxator)
self-requested a review
[April 11, 2020 09:09](#event-3223854762)

[![muxator](https://avatars.githubusercontent.com/u/4067621?s=60&v=4)](/muxator)

**[muxator](/muxator)**
reviewed
[Apr 11, 2020](#pullrequestreview-391750962)

 [View reviewed changes](/ether/etherpad-lite/pull/3833/files)

[tests/backend/loadSettings.js](/ether/etherpad-lite/pull/3833/files#diff-525e7a5e4b7a3fcf06876dea20ddd4fc920c83232cd02a0b178a730a62907037)

Show resolved

Hide resolved

[![muxator](https://avatars.githubusercontent.com/u/4067621?s=60&v=4)](/muxator)

**[muxator](/muxator)**
reviewed
[Apr 11, 2020](#pullrequestreview-391751426)

 [View reviewed changes](/ether/etherpad-lite/pull/3833/files)

[src/node/hooks/express/importexport.js](/ether/etherpad-lite/pull/3833/files#diff-8936a547997b28192a38a2fed363dcb267992d46e54094f984b474a1697178e7)
Outdated

Show resolved

Hide resolved

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=80&u=9da4d2ce0d3b321b59cfd02ee4879c8632422682&v=4)](/JohnMcLear)

Copy link

Member

Author

### **[JohnMcLear](/JohnMcLear)** commented [Apr 12, 2020](#issuecomment-612583002)

| Am I blocking further review of this? |
| --- |

All reactions

Sorry, something went wrong.

 [![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&u=753ff589f3ea8f715e1919101e06931596fe8e22&v=4)](/muxator)
[muxator](/muxator)
[force-pushed](/ether/etherpad-lite/compare/f72906d07d31ff93b5c30dd657132bb4b298bde3..eb3842386dcb8ed296658398db5785d6f4364c20)
the
rate-limiting

branch
4 times, most recently
from
[`f72906d`](/ether/etherpad-lite/commit/f72906d07d31ff93b5c30dd657132bb4b298bde3) to
[`eb38423`](/ether/etherpad-lite/commit/eb3842386dcb8ed296658398db5785d6f4364c20)  [Compare](/ether/etherpad-lite/compare/f72906d07d31ff93b5c30dd657132bb4b298bde3..eb3842386dcb8ed296658398db5785d6f4364c20)
[April 12, 2020 19:57](#event-3225406713)

10 hidden items

Load more…

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=80&u=9da4d2ce0d3b321b59cfd02ee4879c8632422682&v=4)](/JohnMcLear)

Copy link

Member

Author

### **[JohnMcLear](/JohnMcLear)** commented [Apr 12, 2020](#issuecomment-612681397)

| Quick questions: in this series, two final changes "bubbled up": they introduce and subsequently remove tests for the functionality (`tests/backend/specs/api/rateLimitFileSizeAndAuthorSessionExists.js`), leaving no trace of them.  I understand you said they cannot be implemented right now. **Can I drop those two commits** altogether?  I can't remember but if they are commented out they can be left in. The idea is that we have a reference for tests for when I can figure out how to create a session and put that session present in a pad. That or provide a method to bypass that with `loadtest: true`;  Either way it would be nice to have a reference / reminder knowing how infrequent I contribute :D |
| --- |

All reactions

Sorry, something went wrong.

[![@muxator](https://avatars.githubusercontent.com/u/4067621?s=80&u=753ff589f3ea8f715e1919101e06931596fe8e22&v=4)](/muxator)

Copy link

Contributor

### **[muxator](/muxator)** commented [Apr 12, 2020](#issuecomment-612681759)

| I can't remember but if they are commented out they can be left in.  No they are not commented out. The test file is introduced in a commit and wiped altogether in the next one. This is why I asked. |
| --- |

All reactions

Sorry, something went wrong.

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&u=9da4d2ce0d3b321b59cfd02ee4879c8632422682&v=4)](/JohnMcLear)
[JohnMcLear](/JohnMcLear)
mentioned this pull request
[Apr 12, 2020](#ref-issue-598581066)

[Please take care of the documentation part, or at least drop two lines here.
#3858](/ether/etherpad-lite/issues/3858)

Closed

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=80&u=9da4d2ce0d3b321b59cfd02ee4879c8632422682&v=4)](/JohnMcLear)

Copy link

Member

Author

### **[JohnMcLear](/JohnMcLear)** commented [Apr 12, 2020](#issuecomment-612683694)

| In heinsight, I should have split rate limiting and author requirements up into two PRs. My apologies [@muxator](https://github.com/muxator). |
| --- |

All reactions

Sorry, something went wrong.

 [![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&u=753ff589f3ea8f715e1919101e06931596fe8e22&v=4)](/muxator)
[muxator](/muxator)
[force-pushed](/ether/etherpad-lite/compare/fad4fa2cd0564a90672dbc81ec98278b83330d8b..f35f003d4dc51d9302dd84b702ac45feb410a4bb)
the
rate-limiting

branch
from
[`fad4fa2`](/ether/etherpad-lite/commit/fad4fa2cd0564a90672dbc81ec98278b83330d8b) to
[`f35f003`](/ether/etherpad-lite/commit/f35f003d4dc51d9302dd84b702ac45feb410a4bb)  [Compare](/ether/etherpad-lite/compare/fad4fa2cd0564a90672dbc81ec98278b83330d8b..f35f003d4dc51d9302dd84b702ac45feb410a4bb)
[April 12, 2020 22:13](#event-3225504425)

[![@muxator](https://avatars.githubusercontent.com/u/4067621?s=80&u=753ff589f3ea8f715e1919101e06931596fe8e22&v=4)](/muxator)

Copy link

Contributor

### **[muxator](/muxator)** commented [Apr 12, 2020](#issuecomment-612684251) • edited Loading

| In heinsight, I should have split rate limiting and author requirements up into two PRs. My apologies [@muxator](https://github.com/muxator).  I was thinking about that just now. I'm going to split them.   1. max file size 2. author requirements 3. rate limiting   **Edit**: done. The next comments apply on this split version. In particular, please have a look at commit [9847bf6](https://github.com/ether/etherpad-lite/commit/9847bf67ff0ff24e87131833004a8e2e050c020d) because I need help there. |
| --- |

All reactions

Sorry, something went wrong.

 [![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&u=753ff589f3ea8f715e1919101e06931596fe8e22&v=4)](/muxator)
[muxator](/muxator)
[force-pushed](/ether/etherpad-lite/compare/f35f003d4dc51d9302dd84b702ac45feb410a4bb..486700b241e777eb40f60467fbd6c05e28b94e36)
the
rate-limiting

branch
from
[`f35f003`](/ether/etherpad-lite/commit/f35f003d4dc51d9302dd84b702ac45feb410a4bb) to
[`486700b`](/ether/etherpad-lite/commit/486700b241e777eb40f60467fbd6c05e28b94e36)  [Compare](/ether/etherpad-lite/compare/f35f003d4dc51d9302dd84b702ac45feb410a4bb..486700b241e777eb40f60467fbd6c05e28b94e36)
[April 12, 2020 22:47](#event-3225526789)

 [muxator](/muxator)
and others
added 3 commits
[April 13, 2020 01:04](#commits-pushed-86da069)

[![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&v=4)](/muxator)

`[docker: allow to control the maximum file size of an import via IMPOR…](/ether/etherpad-lite/pull/3833/commits/86da069b77588ee6a7957ca027987393d3c10d47 "docker: allow to control the maximum file size of an import via IMPORT_MAX_SIZE")`
 …

`[86da069](/ether/etherpad-lite/pull/3833/commits/86da069b77588ee6a7957ca027987393d3c10d47)`

```
…T_MAX_SIZE
```

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[import: do not allow importing into a pad from the web UI if the user…](/ether/etherpad-lite/pull/3833/commits/1aeebcb9255047262876c2d03c4c4bbbe7339c83 "import: do not allow importing into a pad from the web UI if the user is not on that pad

Importing to a pad is allowed only if an author has a session estabilished and
has already contributed to that specific pad. This means that as long as the
user is on the pad (via the browser) then import is possible.

Note that an author session is NOT the same as a group session, which is not
required.

This setting does not apply to API requests, only to /p/$PAD$/import

This change of behaviour is introduced in Etherpad 1.8.3, and cannot be
disabled.")`
 …

`[1aeebcb](/ether/etherpad-lite/pull/3833/commits/1aeebcb9255047262876c2d03c4c4bbbe7339c83)`

```
… is not on that pad

Importing to a pad is allowed only if an author has a session estabilished and
has already contributed to that specific pad. This means that as long as the
user is on the pad (via the browser) then import is possible.

Note that an author session is NOT the same as a group session, which is not
required.

This setting does not apply to API requests, only to /p/$PAD$/import

This change of behaviour is introduced in Etherpad 1.8.3, and cannot be
disabled.
```

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear)

`[import: introduce importMaxFileSize setting. Defaults to 50 MB](/ether/etherpad-lite/pull/3833/commits/4203262622a02e3171d19c880c88d58f63711878 "import: introduce importMaxFileSize setting. Defaults to 50 MB

From Etherpad 1.8.3 onwards, the maximum allowed size for a single imported
file will always be bounded.

The maximum allowed size can be configured via importMaxFileSize.")`
 …

`[4203262](/ether/etherpad-lite/pull/3833/commits/4203262622a02e3171d19c880c88d58f63711878)`

```
From Etherpad 1.8.3 onwards, the maximum allowed size for a single imported
file will always be bounded.

The maximum allowed size can be configured via importMaxFileSize.
```

 [![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&u=753ff589f3ea8f715e1919101e06931596fe8e22&v=4)](/muxator)
[muxator](/muxator)
[force-pushed](/ether/etherpad-lite/compare/a194093d23bb01d409dfa788d5b8b5e0c4d23caf..d75c1fc1a9543505b7e2b1cb37cbe121fbb40209)
the
rate-limiting

branch
2 times, most recently
from
[`a194093`](/ether/etherpad-lite/commit/a194093d23bb01d409dfa788d5b8b5e0c4d23caf) to
[`d75c1fc`](/ether/etherpad-lite/commit/d75c1fc1a9543505b7e2b1cb37cbe121fbb40209)  [Compare](/ether/etherpad-lite/compare/a194093d23bb01d409dfa788d5b8b5e0c4d23caf..d75c1fc1a9543505b7e2b1cb37cbe121fbb40209)
[April 12, 2020 23:58](#event-3225572570)

[![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&v=4)](/muxator)

`[docker: allow to control import/export rate limiting parameters](/ether/etherpad-lite/pull/3833/commits/3699131022a65a37ead72fa3038960cd98bdfe8a "docker: allow to control import/export rate limiting parameters

The newly introduces environment variables are IMPORT_EXPORT_RATE_LIMIT_WINDOW
and IMPORT_EXPORT_MAX_REQ_PER_IP.")`
 …

`[3699131](/ether/etherpad-lite/pull/3833/commits/3699131022a65a37ead72fa3038960cd98bdfe8a)`

```
The newly introduces environment variables are IMPORT_EXPORT_RATE_LIMIT_WINDOW
and IMPORT_EXPORT_MAX_REQ_PER_IP.
```

 [![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&u=753ff589f3ea8f715e1919101e06931596fe8e22&v=4)](/muxator)
[muxator](/muxator)
[force-pushed](/ether/etherpad-lite/compare/d75c1fc1a9543505b7e2b1cb37cbe121fbb40209..c1269e314ab5e4fbd7f508721569c447980c27d9)
the
rate-limiting

branch
from
[`d75c1fc`](/ether/etherpad-lite/commit/d75c1fc1a9543505b7e2b1cb37cbe121fbb40209) to
[`c1269e3`](/ether/etherpad-lite/commit/c1269e314ab5e4fbd7f508721569c447980c27d9)  [Compare](/ether/etherpad-lite/compare/d75c1fc1a9543505b7e2b1cb37cbe121fbb40209..c1269e314ab5e4fbd7f508721569c447980c27d9)
[April 13, 2020 00:18](#event-3225588040)

[![muxator](https://avatars.githubusercontent.com/u/4067621?s=60&v=4)](/muxator)

**[muxator](/muxator)**
reviewed
[Apr 13, 2020](#pullrequestreview-391908236)

 [View reviewed changes](/ether/etherpad-lite/pull/3833/files)

[src/node/utils/Settings.js](/ether/etherpad-lite/pull/3833/files#diff-98e161344d84a3448f8e7f85c678dcfb6872b3e0f86161d25744b2b8caab4bef)
Outdated

Show resolved

Hide resolved

[![muxator](https://avatars.githubusercontent.com/u/4067621?s=60&v=4)](/muxator)

**[muxator](/muxator)**
reviewed
[Apr 13, 2020](#pullrequestreview-391908830)

 [View reviewed changes](/ether/etherpad-lite/pull/3833/files)

[settings.json.template](/ether/etherpad-lite/pull/3833/files#diff-2b14e66ffa839924b6dbfbfc79dc4c3fe89f44a936c70b03a3b55bac9a93e58e)
Outdated

Show resolved

Hide resolved

[![muxator](https://avatars.githubusercontent.com/u/4067621?s=60&v=4)](/muxator)

**[muxator](/muxator)**
reviewed
[Apr 13, 2020](#pullrequestreview-391909004)

 [View reviewed changes](/ether/etherpad-lite/pull/3833/files)

Copy link

Contributor

### @muxator **[muxator](/muxator)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I need help to describe the effect of `requireAuthorSessionToImport`

Sorry, something went wrong.

All reactions

 [![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&u=753ff589f3ea8f715e1919101e06931596fe8e22&v=4)](/muxator)
[muxator](/muxator)
[force-pushed](/ether/etherpad-lite/compare/0d4b9b193e0083b4ccc9de3dff95dd9623bef035..124b396a646279ee1304708f9a432e494fa551ea)
the
rate-limiting

branch
2 times, most recently
from
[`0d4b9b1`](/ether/etherpad-lite/commit/0d4b9b193e0083b4ccc9de3dff95dd9623bef035) to
[`124b396`](/ether/etherpad-lite/commit/124b396a646279ee1304708f9a432e494fa551ea)  [Compare](/ether/etherpad-lite/compare/0d4b9b193e0083b4ccc9de3dff95dd9623bef035..124b396a646279ee1304708f9a432e494fa551ea)
[April 13, 2020 22:46](#event-3228825076)

 [muxator](/muxator)
added 2 commits
[April 14, 2020 01:10](#commits-pushed-ca3d181)

[![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&v=4)](/muxator)

`[tests: remove loadSettings.js for backend tests.](/ether/etherpad-lite/pull/3833/commits/ca3d1819d8f2d06b4d7281fc1c0306b93acc9fe8 "tests: remove loadSettings.js for backend tests.

The old loadSettings.js was a way of customizing settings upon load, because
the Settings module did not offer this functionality. But it did not work well,
since all the default settings were not loaded.

Let's get rid of loadSettings.js for the bulk of the tests (the \"backend\"
specs). For the \"container\" specs, we'll keep it in place until/if we rewrite
Settings.js making it less brittle.")`
 …

`[ca3d181](/ether/etherpad-lite/pull/3833/commits/ca3d1819d8f2d06b4d7281fc1c0306b93acc9fe8)`

```
The old loadSettings.js was a way of customizing settings upon load, because
the Settings module did not offer this functionality. But it did not work well,
since all the default settings were not loaded.

Let's get rid of loadSettings.js for the bulk of the tests (the "backend"
specs). For the "container" specs, we'll keep it in place until/if we rewrite
Settings.js making it less brittle.
```

[![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&v=4)](/muxator)

`[importexport: improved logging](/ether/etherpad-lite/pull/3833/commits/de4c5359fc9cca3c97fc706f963e8daeedd23477 "importexport: improved logging

This is in preparation to the next activities about import/export securization.")`
 …

`[de4c535](/ether/etherpad-lite/pull/3833/commits/de4c5359fc9cca3c97fc706f963e8daeedd23477)`

```
This is in preparation to the next activities about import/export securization.
```

[![muxator](https://avatars.githubusercontent.com/u/4067621?s=60&v=4)](/muxator)

**[muxator](/muxator)**
reviewed
[Apr 13, 2020](#pullrequestreview-392508301)

 [View reviewed changes](/ether/etherpad-lite/pull/3833/files)

[src/node/hooks/express/importexport.js](/ether/etherpad-lite/pull/3833/files#diff-8936a547997b28192a38a2fed363dcb267992d46e54094f984b474a1697178e7)
Outdated

Show resolved

Hide resolved

 [![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&u=753ff589f3ea8f715e1919101e06931596fe8e22&v=4)](/muxator)
[muxator](/muxator)
[force-pushed](/ether/etherpad-lite/compare/11ebeaee8b0c5911f44247856adc8a8ab12491f5..313229cfd642b5ad25c614e56dcf3a46de53f643)
the
rate-limiting

branch
2 times, most recently
from
[`11ebeae`](/ether/etherpad-lite/commit/11ebeaee8b0c5911f44247856adc8a8ab12491f5) to
[`313229c`](/ether/etherpad-lite/commit/313229cfd642b5ad25c614e56dcf3a46de53f643)  [Compare](/ether/etherpad-lite/compare/11ebeaee8b0c5911f44247856adc8a8ab12491f5..313229cfd642b5ad25c614e56dcf3a46de53f643)
[April 14, 2020 00:49](#event-3229054203)

[![muxator](https://avatars.githubusercontent.com/u/4067621?s=60&v=4)](/muxator)

**[muxator](/muxator)**
reviewed
[Apr 14, 2020](#pullrequestreview-392533966)

 [View reviewed changes](/ether/etherpad-lite/pull/3833/files)

Copy link

Contributor

### @muxator **[muxator](/muxator)** left a comment • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

All done. I have one remaining point (important), and a UI note (not important)

1. ~~Is there a use case for which a user should want to set `requireAuthorSessionToImport` to `false`?~~

   ~~If this is a needed security change, these checks should always be done, without the possibility of disabling them.~~
2. when an import fails (for example because it is rate limited), the UI freezes and then times out. I am ok with keeping as-is, for now, but let's remember to fix it.

**Edit**: I decided to remove the configuration setting `requireAuthorSessionToImport` and always enable those checks. It will not possible to disable the new behaviour.

Sorry, something went wrong.

All reactions

 [![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&u=753ff589f3ea8f715e1919101e06931596fe8e22&v=4)](/muxator)
[muxator](/muxator)
[force-pushed](/ether/etherpad-lite/compare/313229cfd642b5ad25c614e56dcf3a46de53f643..3699131022a65a37ead72fa3038960cd98bdfe8a)
the
rate-limiting

branch
from
[`313229c`](/ether/etherpad-lite/commit/313229cfd642b5ad25c614e56dcf3a46de53f643) to
[`3699131`](/ether/etherpad-lite/commit/3699131022a65a37ead72fa3038960cd98bdfe8a)  [Compare](/ether/etherpad-lite/compare/313229cfd642b5ad25c614e56dcf3a46de53f643..3699131022a65a37ead72fa3038960cd98bdfe8a)
[April 14, 2020 01:34](#event-3229133455)

[![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&u=753ff589f3ea8f715e1919101e06931596fe8e22&v=4)](/muxator)
[muxator](/muxator)
merged commit [`5acbdb8`](/ether/etherpad-lite/commit/5acbdb83e5132bfac38d82285ab6359fdfbf375d)
into
ether:develop

[Apr 14, 2020](https://github.com/ether/etherpad-lite/pull/3833#event-3229136069)

[![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&u=753ff589f3ea8f715e1919101e06931596fe8e22&v=4)](/muxator)
[muxator](/muxator)
changed the title
~~URGENT! Max file size, Rate limiting & can only import with author present on pad - Ready for review.~~
Import/export max file size & rate limiting. Import only allowed with author present on pad
[Apr 21, 2020](#event-3254015083)

[![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&u=753ff589f3ea8f715e1919101e06931596fe8e22&v=4)](/muxator)
[muxator](/muxator)
added
the
[Export/Import](/ether/etherpad-lite/labels/Export/Import)
label
[Apr 21, 2020](#event-3254043436)

[![@rhansen](https://avatars.githubusercontent.com/u/1612291?s=40&v=4)](/rhansen)
[rhansen](/rhansen)
mentioned this pull request
[Oct 1, 2020](#ref-issue-713090797)

[Revisit allowAnyoneToImport
#4381](/ether/etherpad-lite/issues/4381)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fether%2Fetherpad-lite%2Fpull%2F3833)

Reviewers

[![@muxator](https://avatars.githubusercontent.com/u/4067621?s=40&v=4)](/muxator) [muxator](/muxator)

muxator left review comments

Assignees

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=40&v=4)](/JohnMcLear) [JohnMcLear](/JohnMcLear)

Labels

[Export/Import](/ether/etherpad-lite/labels/Export/Import)

Projects

None yet

Milestone

 [**1.8.3**](/ether/etherpad-lite/milestone/13 "1.8.3")

Development

Successfully merging this pull request may close these issues.

2 participants

[![@JohnMcLear](https://avatars.githubusercontent.com/u/220864?s=52&v=4)](/JohnMcLear) [![@muxator](https://avatars.githubusercontent.com/u/4067621?s=52&v=4)](/muxator)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


