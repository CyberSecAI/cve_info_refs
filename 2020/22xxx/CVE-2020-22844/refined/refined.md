Based on the provided content, here's the breakdown of the vulnerability:

**CVE ID:** CVE-2020-22844

**Root Cause of Vulnerability:**
- The vulnerability lies in the `smb` process of MikroTik RouterOS. Specifically, the process does not properly free allocated memory.

**Weaknesses/Vulnerabilities Present:**
- **Memory Exhaustion:** Repeatedly sending "Session Setup Request" packets causes memory to be allocated but not freed. This leads to memory exhaustion.
- **Lack of Resource Management:** The `smb` process lacks proper memory management by not freeing allocated memory, making it susceptible to resource exhaustion.

**Impact of Exploitation:**
- **System Reboot:** Exhausting the memory through the vulnerability can cause the MikroTik RouterOS system to reboot.
- **Denial of Service:** Repeated exploitation can lead to a denial of service due to the system rebooting.

**Attack Vectors:**
- Sending specially crafted "Session Setup Request" packets repeatedly.
- The `message id` field within the "Session Setup Request" packet needs to be updated for every request sent.

**Required Attacker Capabilities/Position:**
- The attacker does not need authentication to exploit the vulnerability.
- The attacker needs the ability to send network packets to the target MikroTik device, implying network access.

**Additional Notes:**
- The vulnerability affects MikroTik RouterOS versions prior to 6.47 (stable release tree).
- The vulnerability was fixed in version 6.47.1
- This CVE is related to a memory exhaustion issue found in the `smb` process of MikroTik RouterOS and was reported alongside another vulnerability in the `ftpd` process (CVE-2020-22845).