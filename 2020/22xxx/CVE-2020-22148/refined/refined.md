- **Root cause of vulnerability:** The application fails to properly sanitize user-supplied input when adding a new tag, leading to stored cross-site scripting.
- **Weaknesses/vulnerabilities present:** Stored Cross-Site Scripting (XSS) vulnerability.
- **Impact of exploitation:** An attacker can inject malicious JavaScript code that will be executed in the context of other users' browsers when they access the affected page. This can be used to steal cookies, redirect users to malicious websites, or perform other malicious actions on behalf of the user.
- **Attack vectors:** A malicious user submits a crafted HTTP POST request to `admin.php?page=tags` with an XSS payload within the `add_tag` parameter.
- **Required attacker capabilities/position:** The attacker needs to be able to access the admin panel and send a POST request with the crafted payload. The attacker needs to know the token for the form.