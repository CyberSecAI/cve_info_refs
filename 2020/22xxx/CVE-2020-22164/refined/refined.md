Based on the provided content, here's a breakdown of the vulnerabilities in the PHPGurukul Hospital Management System v4.0:

**Vulnerabilities:**

1.  **SQL Injection Vulnerabilities (Multiple Instances):**
    *   **Root Cause:**  The application directly incorporates user-supplied input (POST and GET parameters) into SQL queries without proper sanitization or parameterization.
    *   **Weakness:** Lack of input sanitization, direct use of user-controlled data in SQL queries.
    *   **Impact:**  An attacker can manipulate SQL queries to extract sensitive data from the database, potentially including user credentials, personal information, and other confidential data. The attacker can also potentially modify or delete data.
    *   **Attack Vectors:**  HTTP POST and GET requests to vulnerable PHP pages, injecting SQL code via request parameters.
    *   **Required Capabilities:** Unauthenticated remote access to the vulnerable application.

    Specifically vulnerable files are:
        *   `hms/user-login.php`
        *   `hms/forgot-password.php`
        *   `hms/registration.php`
        *   `hms/edit-profile.php`
        *   `hms/get_doctor.php` (two instances)
        *   `hms/appointment-history.php`
        *    `hms/book-appointment.php`
        *   `hms/change-emaild.php`
        *   `hms/check_availability.php`
        *   `hms/admin/betweendates-detailsreports.php`

2.  **Sensitive Information Disclosure:**
    *   **Root Cause:** The application displays sensitive information without proper authentication checks in multiple areas such as `/hms/admin/appointment-history.php` and `/hms/admin/manage-users.php`
    *   **Weakness:** Inadequate access control, missing authentication checks for viewing sensitive data.
    *   **Impact:**  An attacker can access and view user data, appointment information, and other data without proper authorization.
    *   **Attack Vectors:**  Accessing specific admin pages via web browser
    *   **Required Capabilities:**  Unauthenticated remote access to the application

3.  **Persistent Cross-Site Scripting (XSS):**
    *   **Root Cause:** The application stores user-supplied input without proper sanitization and displays it on a different page without sanitization.
    *   **Weakness:** Lack of output encoding/sanitization on data retrieved from the database.
    *   **Impact:** An attacker can inject malicious JavaScript code that gets executed in the browser of other users (e.g., administrator). This can lead to cookie theft, account hijacking, or redirection to malicious sites.
    *   **Attack Vectors:** Submitting a malicious payload through `hms/book-appointment.php` that is displayed in `/hms/admin/appointment-history.php`
    *   **Required Capabilities:**  Registered user access to the system. Administrator access to view admin page with malicious payload.

**Privilege Escalation Note:**
The report details a method of bypassing authentication checks using session management in the application. By initially visiting `/hms/user-login.php` and attempting a login, even with invalid credentials, a user can set the `$_SESSION['login']` variable which then allows access to some pages that would normally require a valid login such as `hms/edit-profile.php`, `hms/appointment-history.php`, `hms/book-appointment.php`,  `hms/change-emaild.php`, and `hms/admin/betweendates-detailsreports.php`. This is a form of privilege escalation.

**Environment:**

*   Apache web server
*   PHP version 7.0.12
*   PHPGurukul Hospital Management System version 4.0

**Summary:**

The report provides comprehensive details of multiple SQL injection vulnerabilities, a sensitive information disclosure vulnerability, and a persistent XSS vulnerability in the PHPGurukul Hospital Management System 4.0.  It includes detailed descriptions, proof-of-concept exploit code, and screenshots for each vulnerability.