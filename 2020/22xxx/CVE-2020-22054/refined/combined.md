=== Content from lists.debian.org_6a8652f3_20250119_115635.html ===


---

[[Date Prev](msg00011.html)][[Date Next](msg00013.html)]
[[Thread Prev](msg00011.html)][[Thread Next](msg00013.html)]
[[Date Index](maillist.html#00012)]
[[Thread Index](threads.html#00012)]

# [SECURITY] [DLA 2818-1] ffmpeg security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 2818-1] ffmpeg security update
* *From*: Anton Gladky <gladk@debian.org>
* *Date*: Sun, 14 Nov 2021 21:47:56 +0100
* *Message-id*: <[[üîé]](/msgid-search/20211114204756.953FA4A035E%40thinkpad.localdomain)¬†[20211114204756.953FA4A035E@thinkpad.localdomain](msg00012.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2818-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                         Anton Gladky
November 13, 2021                             <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : ffmpeg
Version        : 7:3.2.16-1+deb9u1
CVE ID         : CVE-2020-20445 CVE-2020-20446 CVE-2020-20451 CVE-2020-20453
                 CVE-2020-22037 CVE-2020-22041 CVE-2020-22044 CVE-2020-22046
                 CVE-2020-22048 CVE-2020-22049 CVE-2020-22054 CVE-2021-38171
                 CVE-2021-38291

Multiple issues have been discovered in ffmpeg - tools for transcoding,
streaming and playing of multimedia files.

CVE-2020-20445

    Divide By Zero issue via libavcodec/lpc.h, which allows a remote malicious
    user to cause a Denial of Service.

CVE-2020-20446

    Divide By Zero issue via libavcodec/aacpsy.c, which allows a remote malicious
    user to cause a Denial of Service.

CVE-2020-20451

    Denial of Service issue due to resource management errors via
    fftools/cmdutils.c.

CVE-2020-20453

    Divide By Zero issue via libavcodec/aaccoder, which allows a remote
    malicious user to cause a Denial of Service.

CVE-2020-22037

    A Denial of Service vulnerability due to a memory leak in
    avcodec_alloc_context3 at options.c

CVE-2020-22041

    A Denial of Service vulnerability due to a memory leak in
    the av_buffersrc_add_frame_flags function in buffersrc.

CVE-2020-22044

    A Denial of Service vulnerability due to a memory leak in the
    url_open_dyn_buf_internal function in libavformat/aviobuf.c.

CVE-2020-22046

    A Denial of Service vulnerability due to a memory leak in the
    avpriv_float_dsp_allocl function in libavutil/float_dsp.c.

CVE-2020-22048

    A Denial of Service vulnerability due to a memory leak in the
    ff_frame_pool_get function in framepool.c.

CVE-2020-22049

    A Denial of Service vulnerability due to a memory leak in the
    wtvfile_open_sector function in wtvdec.c.

CVE-2020-22054

    A Denial of Service vulnerability due to a memory leak in the av_dict_set
    function in dict.c.

CVE-2021-38171

    adts_decode_extradata in libavformat/adtsenc.c does not check the
    init_get_bits return value, which is a necessary step because the second
    argument to init_get_bits can be crafted.

CVE-2021-38291

    Assertion failure at src/libavutil/mathematics.c, causing ffmpeg aborted
    is detected. In some extrme cases, like with adpcm_ms samples with an
    extremely high channel count, get_audio_frame_duration() may return a
    negative frame duration value.

For Debian 9 stretch, these problems have been fixed in version
7:3.2.16-1+deb9u1.

We recommend that you upgrade your ffmpeg packages.

For the detailed security status of ffmpeg please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/ffmpeg>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEu71F6oGKuG/2fnKF0+Fzg8+n/wYFAmGRdfMACgkQ0+Fzg8+n
/wYM1hAAlHzYwm9B2nvTdl09cQjxypZel3vsSLywadLMkwxz+nOkqT8eKK7NUCx+
DDuCEpNKx8NXudadNxp3RFgjkmC72cB9aFZsjaq2OoycCJhRK43hTWNt+4fEuSWZ
AVThV5bC72usSf2bW56cHsiF1nIJqkPIlc9wpPBXPz+sVSoDrZAN7npzdMmrZbEi
jakCPqUAtOfJXMlphT5rN91DVFvHbSeeSl4YSVk4/ne7vPv8exy2eQH1UfHOu7JY
7jzg15Y9H5eQILlVTyj5Kjqf8oC20toyMTFJLYTnBBlnRGjDa71RqBajWN3wfH2h
HNrLrFuqpeR0L5Pp7BdybGETHTh4xdXthj6yWQr83rGJt6qSr4wbB7cYyhp/fPci
+5k92Cr/4+GVtbZ5Mf3swqVuak6N+FHHhO3RmcNGxaGBf8FGo6R4appfbMITusow
AdJWeGIwIU57jPkD3gVAuySWJGtm2jiqpHMpL7tF9t4ZX/tOE3Anzoxtql+qJhZH
fU+GdJ6giWA80NnpicG44I6dh/yC8zL3B/nXRI/dBVVgmSEwL4ypFfj/C491nx2i
FQ/suwiZLaSip8dDyjsb6kdvvoivRqMZhzmWlsp3cdvJluJdqSfMMG0sI9J7nxfk
phWZs4mBriPSOu+zQoLr7uyqtL/sSHeQ0gINBAN9iO5sagG6aBk=
=2qUQ
-----END PGP SIGNATURE-----

```

---



=== Content from trac.ffmpeg.org_fdaeeaee_20250119_115636.html ===


[![FFmpeg](/ffmpeg-logo.png)](https://ffmpeg.org)

Search:

* [Login](/login)
* [Preferences](/prefs)
* [Help/Guide](/wiki/TracGuide)
* [About Trac](/about)
* [Register](/register)
* [Forgot your password?](/reset_password)

* [Wiki](/wiki)
* [Timeline](/timeline)
* [View Tickets](/report)
* [Search](/search)
* [Tags](/tags)

## Context Navigation

* ![Up-vote](/chrome/vote/aupgray.png)+0![Down-vote](/chrome/vote/adowngray.png)
* ‚Üê [Previous Ticket](/ticket/8314 "Ticket #8314")
* [Next Ticket](/ticket/8316 "Ticket #8316") ‚Üí

---

Opened [5 years ago](/timeline?from=2019-10-19T16%3A49%3A35Z&precision=second "See timeline at Oct 19, 2019, 4:49:35 PM")

Closed [5 years ago](/timeline?from=2019-10-24T23%3A00%3A01Z&precision=second "See timeline at Oct 24, 2019, 11:00:01 PM")

## [#8315](/ticket/8315) [closed](/query?status=closed) [defect](/query?status=!closed&type=defect) ([fixed](/query?resolution=fixed&status=closed))

# memory leaks in av\_dict\_set()

| Reported by: | [Suhwan](/query?reporter=Suhwan&status=!closed) | Owned by: |  |
| --- | --- | --- | --- |
| Priority: | [minor](/query?priority=minor&status=!closed) | Component: | [ffmpeg](/query?component=ffmpeg&status=!closed) |
| Version: | [git-master](/query?status=!closed&version=git-master) | Keywords: | [leak](/query?keywords=~leak&status=!closed) |
| Cc: |  | Blocked By: |  |
| Blocking: |  | Reproduced by developer: | [no](/query?reproduced=0&status=!closed) |
| Analyzed by developer: | [no](/query?analyzed=0&status=!closed) |  |  |

## Description

Summary of the bug:

There're memory leaks detected in av\_dict\_set()

How to reproduce:

```
% ffmpeg_g -y -i $PoC1 -i $PoC2 -filter_complex acompressor -target dvd -loglevel 0 -c pcm_s24le tmp.dnxhd

ffmpeg version N-95464-g7056ddc0e0 Copyright (c) 2000-2019 the FFmpeg developers
built with clang version 6.0.0-1ubuntu2 (tags/RELEASE_600/final)
configuration: --cc=clang --cxx=clang++ --ld=clang --enable-debug

```

Here's Valgrind log

```
==36149== HEAP SUMMARY:
==36149==     in use at exit: 1,046 bytes in 61 blocks
==36149==   total heap usage: 643 allocs, 582 frees, 2,630,129 bytes allocated
==36149==
==36149== 54 (16 direct, 38 indirect) bytes in 1 blocks are definitely lost in loss record 40 of 44
==36149==    at 0x9FE3E76: memalign (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==36149==    by 0x9FE3F91: posix_memalign (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==36149==    by 0x592F079: av_malloc (mem.c:87)
==36149==    by 0x592F079: av_mallocz (mem.c:238)
==36149==    by 0x58EA3CC: av_dict_set (dict.c:89)
==36149==    by 0x45D36E: new_output_stream (ffmpeg_opt.c:1554)
==36149==    by 0x455A25: new_audio_stream (ffmpeg_opt.c:1860)
==36149==    by 0x4508EC: init_output_filter (ffmpeg_opt.c:2062)
==36149==    by 0x43481F: open_output_file (ffmpeg_opt.c:2187)
==36149==    by 0x42DE5E: open_files (ffmpeg_opt.c:3283)
==36149==    by 0x42DC06: ffmpeg_parse_options (ffmpeg_opt.c:3337)
==36149==    by 0x487BB3: main (ffmpeg.c:4862)
==36149==
==36149== LEAK SUMMARY:
==36149==    definitely lost: 16 bytes in 1 blocks
==36149==    indirectly lost: 38 bytes in 3 blocks
==36149==      possibly lost: 0 bytes in 0 blocks
==36149==    still reachable: 992 bytes in 57 blocks
==36149==         suppressed: 0 bytes in 0 blocks
==36149== Reachable blocks (those to which a pointer was found) are not shown.
==36149== To see them, rerun with: --leak-check=full --show-leak-kinds=all
==36149==
==36149== For counts of detected and suppressed errors, rerun with: -v
==36149== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)

```

Please confirm.

Thanks

### Attachments (2)

[PoC\_1.wav](/attachment/ticket/8315/PoC_1.wav "View attachment")[‚Äã](/raw-attachment/ticket/8315/PoC_1.wav "Download")
(125.0 KB
) - added by Suhwan [5 years ago](/timeline?from=2019-10-19T16%3A49%3A46Z&precision=second "See timeline at Oct 19, 2019, 4:49:46 PM").
poc1
[PoC\_2.bmp](/attachment/ticket/8315/PoC_2.bmp "View attachment")[‚Äã](/raw-attachment/ticket/8315/PoC_2.bmp "Download")
(11.4 KB
) - added by Suhwan [5 years ago](/timeline?from=2019-10-19T16%3A49%3A59Z&precision=second "See timeline at Oct 19, 2019, 4:49:59 PM").
poc2

Download all attachments as:
[.zip](/zip-attachment/ticket/8315/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (4)

### by Suhwan, [5 years ago](/timeline?from=2019-10-19T16%3A49%3A46Z&precision=second "See timeline at Oct 19, 2019, 4:49:46 PM")

| Attachment: | [*PoC\_1.wav*](/attachment/ticket/8315/PoC_1.wav)[‚Äã](/raw-attachment/ticket/8315/PoC_1.wav "Download") added |
| --- | --- |

poc1

### by Suhwan, [5 years ago](/timeline?from=2019-10-19T16%3A49%3A59Z&precision=second "See timeline at Oct 19, 2019, 4:49:59 PM")

| Attachment: | [*PoC\_2.bmp*](/attachment/ticket/8315/PoC_2.bmp)[‚Äã](/raw-attachment/ticket/8315/PoC_2.bmp "Download") added |
| --- | --- |

poc2

### [comment:1](#comment:1) by Carl Eugen Hoyos, [5 years ago](/timeline?from=2019-10-24T13%3A40%3A55Z&precision=second "See timeline at Oct 24, 2019, 1:40:55 PM")

| Component: | undetermined ‚Üí ffmpeg |
| --- | --- |
| Keywords: | leak added |
| Priority: | important ‚Üí minor |

### [comment:2](#comment:2) by mkver, [5 years ago](/timeline?from=2019-10-24T23%3A00%3A01Z&precision=second "See timeline at Oct 24, 2019, 11:00:01 PM")

| Resolution: | ‚Üí fixed |
| --- | --- |
| Status: | new ‚Üí closed |

Fixed in [6f2a3958cfac135c60b509a61a4fd39432d8f9a9](/changeset/6f2a3958cfac135c60b509a61a4fd39432d8f9a9/ffmpeg "fftools/ffmpeg: Free swresample dictionary during cleanup

Freeing ...").

**Note:**
See [TracTickets](/wiki/TracTickets)
for help on using tickets.

### Download in other formats:

* [RSS Feed](/ticket/8315?format=rss)
* [Comma-delimited Text](/ticket/8315?format=csv)
* [Tab-delimited Text](/ticket/8315?format=tab)

---

[![Trac Powered](/chrome/common/trac_logo_mini.png)](https://trac.edgewall.org/)

Powered by [**Trac 1.6**](/about)

By [Edgewall Software](http://www.edgewall.org/)
.

Visit the Trac open source project at
<http://trac.edgewall.org/>



=== Content from www.debian.org_7d3dec2e_20250119_115636.html ===


---

[[Date Prev](msg00174.html)][[Date Next](msg00176.html)]
[[Thread Prev](msg00174.html)][[Thread Next](msg00176.html)]
[[Date Index](maillist.html#00175)]
[[Thread Index](threads.html#00175)]

# [SECURITY] [DSA 4990-1] ffmpeg security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4990-1] ffmpeg security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Tue, 19 Oct 2021 18:51:14 +0000
* *Message-id*: <[[üîé]](/msgid-search/20211019185114.GA14597%40seger.debian.org)¬†[20211019185114.GA14597@seger.debian.org](msg00175.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4990-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
October 19, 2021                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : ffmpeg
CVE ID         : CVE-2020-20445 CVE-2020-20446 CVE-2020-20453 CVE-2020-21041
                 CVE-2020-22015 CVE-2020-22016 CVE-2020-22017 CVE-2020-22019
                 CVE-2020-22020 CVE-2020-22021 CVE-2020-22022 CVE-2020-22023
                 CVE-2020-22025 CVE-2020-22026 CVE-2020-22027 CVE-2020-22028
                 CVE-2020-22029 CVE-2020-22030 CVE-2020-22031 CVE-2020-22032
                 CVE-2020-22033 CVE-2020-22034 CVE-2020-22035 CVE-2020-22036
                 CVE-2020-22037 CVE-2020-22049 CVE-2020-22054 CVE-2020-35965
                 CVE-2021-38114 CVE-2021-38171 CVE-2021-38291

Several vulnerabilities have been discovered in the FFmpeg multimedia
framework, which could result in denial of service or potentially the
execution of arbitrary code if malformed files/streams are processed.

For the oldstable distribution (buster), these problems have been fixed
in version 7:4.1.8-0+deb10u1.

We recommend that you upgrade your ffmpeg packages.

For the detailed security status of ffmpeg please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/ffmpeg>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmFvE0MACgkQEMKTtsN8
Tjar1A//XPaJ4SP7JyAs3H845zwESim4+SsoK2sdz5fkFIiaM17lHcVTeQyDbGtw
5E9LfBRw9oxseU+6pCze3LdwqDKhdwiotDgWj4NZ8OJBLz4Iq12nJMkKCXAaTdFp
8pBYhrgLloyl+6Tdc76jBGMT9KhXtaWrNhsI/T01KNMD0yhOMBzgmgOJi7NgoMcS
/mk6TAfW5zGClMWCAVPHwmCx4S6C+8O99pgGdavbBZhtdFqZETgYFln8H3Wpw8V9
93MF4Qbwq7kZ3NLI+Jie5shM50ootzcHa8RP7Aaf+3K4mZ/9ORo8rvJF7mcJi4EG
fE/e0x/Q4bezdFbbgDFVLMzEq9vdO1UevO8gCWlfe17nh+JB3BEiwO9mF+cUuvb5
ySH8FA2W9EWEGEZgdgk2h8suHQ5ELI3sNLPnc9VA2IXF/PVl3Gm3vK3+ELedP5Lw
WK2QlWOiVPkzAvcY8EXtEzIMCdnioMKkrcr5bDzfCeL7FTR0A6St+NKYWO/31R2h
c6WGxAOMXSSSKe1j48mrsbqNlzPv7LwDyjS70ZJ3QrtQ4dp+prxnAD3A4uDk6fyO
7Qs466QF0bYRJP/I0DggKEwQKvdK9MSubSgftz414J+bqfE3WqUOjtUneN4ZTQx0
WXA7cPN/2rolLx2UGygPfqjlTcdFBFwWrBfXpu34jYD7ONiKGTU=
=i0d7
-----END PGP SIGNATURE-----

```

---


