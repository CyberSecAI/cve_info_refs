=== Content from www.debian.org_36b99aba_20250119_123108.html ===


---

[[Date Prev](msg00182.html)][[Date Next](msg00184.html)]
[[Thread Prev](msg00182.html)][[Thread Next](msg00184.html)]
[[Date Index](maillist.html#00183)]
[[Thread Index](threads.html#00183)]

# [SECURITY] [DSA 4998-1] ffmpeg security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4998-1] ffmpeg security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Sun, 31 Oct 2021 16:40:22 +0000
* *Message-id*: <[[üîé]](/msgid-search/20211031164022.GA9637%40seger.debian.org)¬†[20211031164022.GA9637@seger.debian.org](msg00183.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4998-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
October 31, 2021                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : ffmpeg
CVE ID         : CVE-2020-20446 CVE-2020-20450 CVE-2020-20453 CVE-2020-22037
                 CVE-2020-22042 CVE-2021-38114 CVE-2021-38171 CVE-2021-38291
                 CVE-2020-21697 CVE-2020-21688 CVE-2020-20445

Several vulnerabilities have been discovered in the FFmpeg multimedia
framework, which could result in denial of service or potentially the
execution of arbitrary code if malformed files/streams are processed.

For the stable distribution (bullseye), these problems have been fixed in
version 7:4.3.3-0+deb11u1.

We recommend that you upgrade your ffmpeg packages.

For the detailed security status of ffmpeg please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/ffmpeg>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmF+xfUACgkQEMKTtsN8
TjY1Bw//YNL74vqBdoTiiNfHPW7S5zcKB+YkWMRT+t9gyITOkASzZ5k3MvRJUgOr
U1+QK507XvyGeKvRcRaT5P0se9KtmTWPGB9zn7yfv+1RWbtv6ffpwLspLMzAITLr
aXffbCuqF/E0J6THgJBWYMaIti4FNVdcQ/WdaS0Lz4bGkkS6f3wvJV1QbivLA0JI
QXKxB6JSET6sLSyVsKA1r9/w4QeIZ5GNfxxdDIaZUOIwpUkyfFJLBLeXLmnqJ1Cw
yiz/tCF4TPuH68tDEZqmmEZIKPCyJPBuXWbqGOIYB8ld1EDXuy3eXLSxhOz/kAoO
uWFph4VKpkfDXLWBAE7M+Ots2ZM7sT5KTwWz5T/K9RL9hFA6V0AWiVCfhLw/Yz+A
4H3rB/B2G93ea4Y9CTLR75xKKIapK3dJ9TY8SgyN9owaTfqWcoH3AJvnlGSWVihc
GTBp+zMFCrpdrAKrdJydre5hdji/07j2owWvjuMZPbjQMzQuIihu4MTUPxKudn9X
4JR73c9brxibIBPegIJiY4kdXquXO/yuQ6UNKDJCbszjOytHavCtC/tS2l39vol7
zuujpZROXIx6obfHjGi25E2IlSOHHDua7QP1SlOYXSwIZ6DDWAvGgi9di0FGo/Hu
MA6OHY7GeEju63y7A3dFkcmLPUVdDCH5GDXtjKwosVzhdIkrC70=
=Lr1c
-----END PGP SIGNATURE-----

```

---



=== Content from trac.ffmpeg.org_0fd4423e_20250119_123107.html ===


[![FFmpeg](/ffmpeg-logo.png)](https://ffmpeg.org)

Search:

* [Login](/login)
* [Preferences](/prefs)
* [Help/Guide](/wiki/TracGuide)
* [About Trac](/about)
* [Register](/register)
* [Forgot your password?](/reset_password)

* [Wiki](/wiki)
* [Timeline](/timeline)
* [View Tickets](/report)
* [Search](/search)
* [Tags](/tags)

## Context Navigation

* ![Up-vote](/chrome/vote/aupgray.png)+0![Down-vote](/chrome/vote/adowngray.png)
* ‚Üê [Previous Ticket](/ticket/8266 "Ticket #8266")
* [Next Ticket](/ticket/8268 "Ticket #8268") ‚Üí

---

Opened [5 years ago](/timeline?from=2019-10-13T16%3A35%3A59Z&precision=second "See timeline at Oct 13, 2019, 4:35:59 PM")

Closed [4 years ago](/timeline?from=2020-08-23T18%3A20%3A27Z&precision=second "See timeline at Aug 23, 2020, 6:20:27 PM")

## [#8267](/ticket/8267) [closed](/query?status=closed) [defect](/query?status=!closed&type=defect) ([fixed](/query?resolution=fixed&status=closed))

# memory leaks from libavfilter/graphparser.c in link\_filter\_inouts

| Reported by: | [Suhwan](/query?reporter=Suhwan&status=!closed) | Owned by: |  |
| --- | --- | --- | --- |
| Priority: | [minor](/query?priority=minor&status=!closed) | Component: | [ffmpeg](/query?component=ffmpeg&status=!closed) |
| Version: | [git-master](/query?status=!closed&version=git-master) | Keywords: | [leak](/query?keywords=~leak&status=!closed) |
| Cc: |  | Blocked By: |  |
| Blocking: |  | Reproduced by developer: | [yes](/query?reproduced=1&status=!closed) |
| Analyzed by developer: | [no](/query?analyzed=0&status=!closed) |  |  |

## Description

Summary of the bug:

There're memory leaks from libavfilter/graphparser.c in link\_filter\_inouts

How to reproduce:

```
% ffmpeg_g -y -i $PoC -filter_complex rgbtestsrc -loglevel 0 tmp.mpegtsraw

ffmpeg version N-95336-g4f4334bcbc Copyright (c) 2000-2019 the FFmpeg developers
built with clang version 6.0.0-1ubuntu2 (tags/RELEASE_600/final)
configuration: --cc=clang --cxx=clang++ --ld=clang --enable-debug

```

Here's Valgrind log

```
==30745== HEAP SUMMARY:
==30745==     in use at exit: 612 bytes in 16 blocks
==30745==   total heap usage: 389 allocs, 373 frees, 2,471,014 bytes allocated
==30745==
==30745== 32 bytes in 1 blocks are definitely lost in loss record 11 of 15
==30745==    at 0x9D40E76: memalign (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==30745==    by 0x9D40F91: posix_memalign (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==30745==    by 0x5911E09: av_malloc (mem.c:87)
==30745==    by 0x5911E09: av_mallocz (mem.c:238)
==30745==    by 0x65F62E: link_filter_inouts (graphparser.c:285)
==30745==    by 0x65DEFC: avfilter_graph_parse2 (graphparser.c:431)
==30745==    by 0x4615D4: init_complex_filtergraph (ffmpeg_filter.c:353)
==30745==    by 0x42DB4B: init_complex_filters (ffmpeg_opt.c:2102)
==30745==    by 0x42DB4B: ffmpeg_parse_options (ffmpeg_opt.c:3324)
==30745==    by 0x487B43: main (ffmpeg.c:4862)
==30745==
==30745== LEAK SUMMARY:
==30745==    definitely lost: 32 bytes in 1 blocks
==30745==    indirectly lost: 0 bytes in 0 blocks
==30745==      possibly lost: 0 bytes in 0 blocks
==30745==    still reachable: 580 bytes in 15 blocks
==30745==         suppressed: 0 bytes in 0 blocks
==30745== Reachable blocks (those to which a pointer was found) are not shown.
==30745== To see them, rerun with: --leak-check=full --show-leak-kinds=all
==30745==
==30745== For counts of detected and suppressed errors, rerun with: -v
==30745== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)

```

ASAN

```
=================================================================
==15214==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x4de9e8 in posix_memalign (ffmpeg_asan+0x4de9e8)
    #1 0x8599368 in av_malloc ffmpeg/libavutil/mem.c:87:9
    #2 0x8599368 in av_mallocz ffmpeg/libavutil/mem.c:238
    #3 0x9397d2 in link_filter_inouts ffmpeg/libavfilter/graphparser.c:285:36
    #4 0x93620d in avfilter_graph_parse2 ffmpeg/libavfilter/graphparser.c:431:20
    #5 0x5850b4 in init_complex_filtergraph ffmpeg/fftools/ffmpeg_filter.c:353:11
    #6 0x516995 in init_complex_filters ffmpeg/fftools/ffmpeg_opt.c:2102:15
    #7 0x516995 in ffmpeg_parse_options ffmpeg/fftools/ffmpeg_opt.c:3324
    #8 0x5db156 in main ffmpeg/fftools/ffmpeg.c:4862:11
    #9 0x7f6e24c9cb96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310

SUMMARY: AddressSanitizer: 32 byte(s) leaked in 1 allocation(s).

```

Please confirm.

Thanks

### Attachments (1)

[PoC\_graphparser.wav](/attachment/ticket/8267/PoC_graphparser.wav "View attachment")[‚Äã](/raw-attachment/ticket/8267/PoC_graphparser.wav "Download")
(125.0 KB
) - added by Suhwan [5 years ago](/timeline?from=2019-10-13T16%3A36%3A08Z&precision=second "See timeline at Oct 13, 2019, 4:36:08 PM").

Download all attachments as:
[.zip](/zip-attachment/ticket/8267/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (3)

### by Suhwan, [5 years ago](/timeline?from=2019-10-13T16%3A36%3A08Z&precision=second "See timeline at Oct 13, 2019, 4:36:08 PM")

| Attachment: | [*PoC\_graphparser.wav*](/attachment/ticket/8267/PoC_graphparser.wav)[‚Äã](/raw-attachment/ticket/8267/PoC_graphparser.wav "Download") added |
| --- | --- |

### [comment:1](#comment:1) by Carl Eugen Hoyos, [5 years ago](/timeline?from=2020-02-28T17%3A52%3A20Z&precision=second "See timeline at Feb 28, 2020, 5:52:20 PM")

| Component: | undetermined ‚Üí avfilter |
| --- | --- |
| Keywords: | leak added; valgrind asan removed |
| Priority: | normal ‚Üí minor |
| Reproduced by developer: | set |
| Status: | new ‚Üí open |

### [comment:2](#comment:2) by mkver, [4 years ago](/timeline?from=2020-08-23T18%3A20%3A27Z&precision=second "See timeline at Aug 23, 2020, 6:20:27 PM")

| Component: | avfilter ‚Üí ffmpeg |
| --- | --- |
| Resolution: | ‚Üí fixed |
| Status: | open ‚Üí closed |

Fixed in [426c16d61a9b5056a157a1a2a057a4e4d13eef84](/changeset/426c16d61a9b5056a157a1a2a057a4e4d13eef84/ffmpeg "fftools/ffmpeg: Fix leak of AVFilterInOut in case of error

The ...").

**Note:**
See [TracTickets](/wiki/TracTickets)
for help on using tickets.

### Download in other formats:

* [RSS Feed](/ticket/8267?format=rss)
* [Comma-delimited Text](/ticket/8267?format=csv)
* [Tab-delimited Text](/ticket/8267?format=tab)

---

[![Trac Powered](/chrome/common/trac_logo_mini.png)](https://trac.edgewall.org/)

Powered by [**Trac 1.6**](/about)

By [Edgewall Software](http://www.edgewall.org/)
.

Visit the Trac open source project at
<http://trac.edgewall.org/>


