=== Content from github.com_b55d9eee_20250119_125350.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpcmacdon%2Fjsish%2Fcommit%2F430ea27accd4d4ffddc946c9402e7c9064835a18)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpcmacdon%2Fjsish%2Fcommit%2F430ea27accd4d4ffddc946c9402e7c9064835a18)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=pcmacdon%2Fjsish)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pcmacdon](/pcmacdon)
/
**[jsish](/pcmacdon/jsish)**
Public

* [Notifications](/login?return_to=%2Fpcmacdon%2Fjsish) You must be signed in to change notification settings
* [Fork
  9](/login?return_to=%2Fpcmacdon%2Fjsish)
* [Star
   44](/login?return_to=%2Fpcmacdon%2Fjsish)

* [Code](/pcmacdon/jsish)
* [Issues
  19](/pcmacdon/jsish/issues)
* [Pull requests
  1](/pcmacdon/jsish/pulls)
* [Discussions](/pcmacdon/jsish/discussions)
* [Actions](/pcmacdon/jsish/actions)
* [Projects
  0](/pcmacdon/jsish/projects)
* [Security](/pcmacdon/jsish/security)
* [Insights](/pcmacdon/jsish/pulse)

Additional navigation options

* [Code](/pcmacdon/jsish)
* [Issues](/pcmacdon/jsish/issues)
* [Pull requests](/pcmacdon/jsish/pulls)
* [Discussions](/pcmacdon/jsish/discussions)
* [Actions](/pcmacdon/jsish/actions)
* [Projects](/pcmacdon/jsish/projects)
* [Security](/pcmacdon/jsish/security)
* [Insights](/pcmacdon/jsish/pulse)

## Commit

[Permalink](/pcmacdon/jsish/commit/430ea27accd4d4ffddc946c9402e7c9064835a18)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Release "3.0.7": Fix toPrecision bug "stack overflow [#4](https://github.com/pcmacdon/jsish/issues/4)".

[Browse files](/pcmacdon/jsish/tree/430ea27accd4d4ffddc946c9402e7c9064835a18)
Browse the repository at this point in the history

```
FossilOrigin-Name: 6c7f0c37027d7f890b57cb38f776af39b8f81f03e60ceeb0a231a1d21e24b5de
```

* Loading branch information

pmacdona
committed
Apr 13, 2020

1 parent
[5408a6d](/pcmacdon/jsish/commit/5408a6d93f45bf1f7acd9ae5d44e0ebd77379e98)

commit 430ea27

 Show file tree

 Hide file tree

Showing
**20 changed files**
with
**62 additions**
and
**62 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/jsi.h
    [jsi.h](#diff-6abc6c69e3210e802a6aaae218dc72fb8ca5cdebbae79d184376c46f70254257)
  + src/jsiCmds.c
    [jsiCmds.c](#diff-529cdbb18f083e766dc87fe3da9bcfd70b0965c903fab781bec7ed50bdc9f781)
  + src/jsiCode.c
    [jsiCode.c](#diff-9319d330f2e50acbf21b516a0af1bfe747c40e40029bcedaf443d9ea309cacc7)
  + src/jsiEval.c
    [jsiEval.c](#diff-0c50af74f292ceaba0d12741a325db045dce1ad906c7bb2d16a7ac1482291ee6)
  + src/jsiFilesys.c
    [jsiFilesys.c](#diff-4340177c4f52e62654cf7bff96929bd1b72bcf3a264e6c61b36c1127851834ea)
  + src/jsiFunc.c
    [jsiFunc.c](#diff-fee696dc13878be1c5d1d6fae9462c26761a94173702674238bd3b0a2f151cfd)
  + src/jsiHash.c
    [jsiHash.c](#diff-353ffd5887354e6ef47765e3c2226c40aa7a3f9bb016a0117d5fd558aa3d4440)
  + src/jsiInterp.c
    [jsiInterp.c](#diff-caf32b11ffe4ac7e7a534fcd5e71d47dfa4592fcc7af7b769df4ea4ddb725880)
  + src/jsiJSON.c
    [jsiJSON.c](#diff-1e34f432e1212f15a1f9187db80e6d0e283e3b7e715cf03e05193d1ca9893597)
  + src/jsiMySql.c
    [jsiMySql.c](#diff-4464a325b786de7918798f98c64c62624edf26522d7103edfa40359b45e42689)
  + src/jsiNumber.c
    [jsiNumber.c](#diff-db2630c258b0f9d263d739a47e0bb79cc9819061eef25ca2805fc67bce97bbbe)
  + src/jsiOptions.c
    [jsiOptions.c](#diff-f6e3609232a9ce7df88edc16cd022be52ea52b67a46edbdd223e7d9346b20c89)
  + src/jsiPstate.c
    [jsiPstate.c](#diff-d779b2713e055bf25ed1321c4760c65928a620106e7e3e1ce17ca15885e4bedb)
  + src/jsiRegexp.c
    [jsiRegexp.c](#diff-f1a097026129d8ac67ce543775bf656e28392770aeec6f121048ca93e19bb75e)
  + src/jsiSqlite.c
    [jsiSqlite.c](#diff-d9acadb4504adf0cdaff2a44e01c049ffc4cb3e9c4e64238fde7c42565ce639f)
  + src/jsiString.c
    [jsiString.c](#diff-40b0bfeda1ecc4d6676ee27031f1550a6cad7bf66462120feede39f9fe560396)
  + src/jsiTree.c
    [jsiTree.c](#diff-fd83b4d01758a8cb85473ac71aa4bf5e3c7434388d723d81cf59fa859b2d3467)
  + src/jsiUtils.c
    [jsiUtils.c](#diff-3faae09966be8bafaf3f87daa726bf560577b4527232df0b4c078ebdd0cebd2e)
  + src/jsiValue.c
    [jsiValue.c](#diff-f72c8297869466b5927a06faa81380c6726b2626c4a2f57155701e4f66aced68)
  + src/jsiWebSocket.c
    [jsiWebSocket.c](#diff-90c7867f080917100d1a1c324ee3db9011b94d075ef41a6b993e0320e19dcafc)

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[src/jsi.h](#diff-6abc6c69e3210e802a6aaae218dc72fb8ca5cdebbae79d184376c46f70254257 "src/jsi.h")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsi.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,7 +4,7 @@ |
|  |  |  |
|  |  | #define JSI\_VERSION\_MAJOR 3 |
|  |  | #define JSI\_VERSION\_MINOR 0 |
|  |  | #define JSI\_VERSION\_RELEASE 6 |
|  |  | #define JSI\_VERSION\_RELEASE 7 |
|  |  |  |
|  |  | #define JSI\_VERSION (JSI\_VERSION\_MAJOR + ((Jsi\_Number)JSI\_VERSION\_MINOR/100.0) + ((Jsi\_Number)JSI\_VERSION\_RELEASE/10000.0)) |
|  |  |  |
| Expand Down  Expand Up | | @@ -213,7 +213,7 @@ typedef enum { |
|  |  | JSI\_DBI\_NO\_MUTEX =0x0004, /\* Disable mutex. \*/ |
|  |  | JSI\_DBI\_FULL\_MUTEX =0x0008, /\* Use full mutex. \*/ |
|  |  |  |
|  |  | JSI\_MAX\_NUMBER\_STRING=50, |
|  |  | JSI\_MAX\_NUMBER\_STRING=100, |
|  |  | JSI\_BUFSIZ=8192 |
|  |  |  |
|  |  | } Jsi\_Enums; /\* Debugging is easier with enums than #define. \*/ |
| Expand Down | |  |

14 changes: 7 additions & 7 deletions

14
[src/jsiCmds.c](#diff-529cdbb18f083e766dc87fe3da9bcfd70b0965c903fab781bec7ed50bdc9f781 "src/jsiCmds.c")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsiCmds.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -845,7 +845,7 @@ Jsi\_RC jsi\_PkgDumpInfo(Jsi\_Interp \*interp, const char \*name, Jsi\_Value \*\*ret) { |
|  |  | Jsi\_ObjInsert(interp, nobj, "name", Jsi\_ValueNewStringDup(interp, name), 0); |
|  |  | Jsi\_ObjInsert(interp, nobj, "version", Jsi\_ValueNewNumber(interp, ptr->version), 0); |
|  |  | Jsi\_ObjInsert(interp, nobj, "lastReq", Jsi\_ValueNewNumber(interp, ptr->lastReq), 0); |
|  |  | char buf[200]; |
|  |  | char buf[JSI\_MAX\_NUMBER\_STRING\*2]; |
|  |  | jsi\_VersionNormalize(ptr->version, buf, sizeof(buf)); |
|  |  | Jsi\_ObjInsert(interp, nobj, "verStr", Jsi\_ValueNewStringDup(interp, buf), 0); |
|  |  | const char \*cp = (ptr->loadFile?ptr->loadFile:""); |
| Expand Down  Expand Up | | @@ -1192,7 +1192,7 @@ static Jsi\_RC SysGetEnvCmd(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Value \*\_this |
|  |  | Jsi\_Value \*vres; |
|  |  | Jsi\_Obj \*ores = Jsi\_ObjNew(interp); |
|  |  | Jsi\_Value \*nnv; |
|  |  | char \*val, nam[200]; |
|  |  | char \*val, nam[JSI\_BUFSIZ/2]; |
|  |  | //Jsi\_ObjIncrRefCount(interp, ores); |
|  |  | vres = Jsi\_ValueMakeObject(interp, NULL, ores); |
|  |  | //Jsi\_IncrRefCount(interp, vres); |
| Expand Down  Expand Up | | @@ -2700,7 +2700,7 @@ static Jsi\_RC DebugAddCmd(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Value \*\_this, |
|  |  | } |
|  |  | if (bp.line<=0 && !bp.func) |
|  |  | return Jsi\_LogError("bad number"); |
|  |  | char nbuf[100]; |
|  |  | char nbuf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  | bp.id = ++interp->debugOpts.breakIdx; |
|  |  | bp.enabled = 1; |
|  |  | snprintf(nbuf, sizeof(nbuf), "%d", bp.id); |
| Expand All | | @@ -2718,7 +2718,7 @@ static Jsi\_RC DebugRemoveCmd\_(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Value \*\_t |
|  |  | if (interp->breakpointHash) |
|  |  | { |
|  |  | int num; |
|  |  | char nbuf[100]; |
|  |  | char nbuf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  | if (Jsi\_GetIntFromValue(interp, val, &num) != JSI\_OK) |
|  |  | return Jsi\_LogError("bad number"); |
|  |  |  |
| Expand Down  Expand Up | | @@ -2766,7 +2766,7 @@ static Jsi\_RC DebugInfoCmd(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Value \*\_this |
|  |  | return Jsi\_HashKeysDump(interp, interp->breakpointHash, ret, 0); |
|  |  | Jsi\_Value \*val = Jsi\_ValueArrayIndex(interp, args, 0); |
|  |  | int num; |
|  |  | char nbuf[100]; |
|  |  | char nbuf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  | if (Jsi\_GetIntFromValue(interp, val, &num) != JSI\_OK) |
|  |  | return Jsi\_LogError("bad number"); |
|  |  |  |
| Expand Down  Expand Up | | @@ -3800,7 +3800,7 @@ static Jsi\_RC SysVerConvertCmd(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Value \*\_ |
|  |  | Jsi\_Value \*flag = Jsi\_ValueArrayIndex(interp, args, 1); |
|  |  | if (!val) goto bail; |
|  |  | if (Jsi\_ValueIsNumber(interp, val)) { |
|  |  | char buf[200]; |
|  |  | char buf[JSI\_MAX\_NUMBER\_STRING\*2]; |
|  |  | Jsi\_Number n; |
|  |  | if (Jsi\_GetNumberFromValue(interp, val, &n) != JSI\_OK) |
|  |  | goto bail; |
| Expand Down  Expand Up | | @@ -3953,7 +3953,7 @@ static Jsi\_RC SysTimesCmd(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Value \*\_this, |
|  |  | if (bv) |
|  |  | interp->timesStart = now; |
|  |  | else { |
|  |  | char buf[100]; |
|  |  | char buf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  | snprintf(buf, sizeof(buf), " (times = %.6f sec)\n", (now-interp->timesStart)); |
|  |  | Jsi\_Puts(interp, jsi\_Stderr, buf, -1); |
|  |  | } |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/jsiCode.c](#diff-9319d330f2e50acbf21b516a0af1bfe747c40e40029bcedaf443d9ea309cacc7 "src/jsiCode.c")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsiCode.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -436,7 +436,7 @@ void jsi\_code\_decode(Jsi\_Interp \*interp, jsi\_OpCode \*op, int currentip, char \*bu |
|  |  | if (\_JSICASTINT(op->op) < 0 || op->op >= OP\_LASTOP) { |
|  |  | snprintf(buf, bsiz, "Bad opcode[%d] at %d", op->op, currentip); |
|  |  | } |
|  |  | char nbuf[100]; |
|  |  | char nbuf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  | snprintf(nbuf, sizeof(nbuf), "%d#%d", currentip, op->Line); |
|  |  | snprintf(buf, bsiz, "%-8s %s ", nbuf, jsi\_op\_names[op->op]); |
|  |  |  |
| Expand Down | |  |

22 changes: 11 additions & 11 deletions

22
[src/jsiEval.c](#diff-0c50af74f292ceaba0d12741a325db045dce1ad906c7bb2d16a7ac1482291ee6 "src/jsiEval.c")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsiEval.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -287,23 +287,23 @@ static Jsi\_RC jsi\_logic\_less(Jsi\_Interp\* interp, int i1, int i2) { |
|  |  |  |
|  |  | static const char \*jsi\_evalprint(Jsi\_Value \*v) |
|  |  | { |
|  |  | static char buf[100]; |
|  |  | static char buf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  | if (!v) |
|  |  | return "nil"; |
|  |  | if (v->vt == JSI\_VT\_NUMBER) { |
|  |  | snprintf(buf, 100, "NUM:%" JSI\_NUMGFMT " ", v->d.num); |
|  |  | snprintf(buf, sizeof(buf), "NUM:%" JSI\_NUMGFMT " ", v->d.num); |
|  |  | } else if (v->vt == JSI\_VT\_BOOL) { |
|  |  | snprintf(buf, 100, "BOO:%d", v->d.val); |
|  |  | snprintf(buf, sizeof(buf), "BOO:%d", v->d.val); |
|  |  | } else if (v->vt == JSI\_VT\_STRING) { |
|  |  | snprintf(buf, 100, "STR:'%s'", v->d.s.str); |
|  |  | snprintf(buf, sizeof(buf), "STR:'%s'", v->d.s.str); |
|  |  | } else if (v->vt == JSI\_VT\_VARIABLE) { |
|  |  | snprintf(buf, 100, "VAR:%p", v->d.lval); |
|  |  | snprintf(buf, sizeof(buf), "VAR:%p", v->d.lval); |
|  |  | } else if (v->vt == JSI\_VT\_NULL) { |
|  |  | snprintf(buf, 100, "NULL"); |
|  |  | snprintf(buf, sizeof(buf), "NULL"); |
|  |  | } else if (v->vt == JSI\_VT\_OBJECT) { |
|  |  | snprintf(buf, 100, "OBJ:%p", v->d.obj); |
|  |  | snprintf(buf, sizeof(buf), "OBJ:%p", v->d.obj); |
|  |  | } else if (v->vt == JSI\_VT\_UNDEF) { |
|  |  | snprintf(buf, 100, "UNDEFINED"); |
|  |  | snprintf(buf, sizeof(buf), "UNDEFINED"); |
|  |  | } |
|  |  | return buf; |
|  |  | } |
| Expand Down  Expand Up | | @@ -403,7 +403,7 @@ static void jsiDumpInstr(Jsi\_Interp \*interp, jsi\_Pstate \*ps, Jsi\_Value \*\_this, |
|  |  | jsi\_TryList \*trylist, jsi\_OpCode \*ip, Jsi\_OpCodes \*opcodes) |
|  |  | { |
|  |  | int i; |
|  |  | char buf[200]; |
|  |  | char buf[JSI\_MAX\_NUMBER\_STRING\*2]; |
|  |  | jsi\_code\_decode(interp, ip, ip - opcodes->codes, buf, sizeof(buf)); |
|  |  | Jsi\_Printf(interp, jsi\_Stderr, "%p: %-30.200s : THIS=%s, STACK=[", ip, buf, jsi\_evalprint(\_this)); |
|  |  | for (i = 0; i < interp->framePtr->Sp; ++i) { |
| Expand Down  Expand Up | | @@ -1538,7 +1538,7 @@ Jsi\_RC jsi\_evalcode\_sub(jsi\_Pstate \*ps, Jsi\_OpCodes \*opcodes, |
|  |  | break; |
|  |  | } |
|  |  | int bval = 0; |
|  |  | char nbuf[100]; |
|  |  | char nbuf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  | Jsi\_Value \*vv; |
|  |  | Jsi\_Obj \*obj = v->d.obj; |
|  |  | if (!cp) { |
| Expand Down  Expand Up | | @@ -2155,7 +2155,7 @@ Jsi\_RC jsi\_evalcode(jsi\_Pstate \*ps, Jsi\_Func \*func, Jsi\_OpCodes \*opcodes, |
|  |  | Jsi\_IncrRefCount(interp, fargs); |
|  |  | rc = jsi\_evalcode\_sub(ps, opcodes, scope, fargs, \_this, \*vret); |
|  |  | Jsi\_DecrRefCount(interp, fargs); |
|  |  | if (interp->didReturn == 0 && !interp->exited) { |
|  |  | if (interp->didReturn == 0 && !interp->exited && rc == JSI\_OK) { |
|  |  | if ((interp->evalFlags&JSI\_EVAL\_RETURN)==0) |
|  |  | Jsi\_ValueMakeUndef(interp, vret); |
|  |  | /\*if (interp->framePtr->Sp != oldSp) //TODO: at some point after memory refs??? |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/jsiFilesys.c](#diff-4340177c4f52e62654cf7bff96929bd1b72bcf3a264e6c61b36c1127851834ea "src/jsiFilesys.c")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsiFilesys.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1177,7 +1177,7 @@ const char \*jsi\_GetHomeDir(Jsi\_Interp \*interp) { |
|  |  |  |
|  |  | if ((str = getenv("HOME")) == NULL) { |
|  |  | struct passwd pwd, \*pw; |
|  |  | char buf[20000]; |
|  |  | char buf[JSI\_BUFSIZ\*3]; |
|  |  | if (getpwuid\_r(getuid(), &pwd, buf, sizeof(buf), &pw) == 0 && pw->pw\_dir) |
|  |  | str = pw->pw\_dir; |
|  |  | } |
| Expand Down | |  |

6 changes: 3 additions & 3 deletions

6
[src/jsiFunc.c](#diff-fee696dc13878be1c5d1d6fae9462c26761a94173702674238bd3b0a2f151cfd "src/jsiFunc.c")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsiFunc.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -189,7 +189,7 @@ const char \*jsiFuncInfo(Jsi\_Interp \*interp, Jsi\_DString \*dStr, Jsi\_Func\* func, J |
|  |  | Jsi\_RC jsi\_ArgTypeCheck(Jsi\_Interp \*interp, int typ, Jsi\_Value \*arg, const char \*p1, |
|  |  | const char \*p2, int index, Jsi\_Func \*func, bool isdefault) { |
|  |  | Jsi\_RC rc = JSI\_OK; |
|  |  | char idxBuf[200]; |
|  |  | char idxBuf[JSI\_MAX\_NUMBER\_STRING\*2]; |
|  |  | idxBuf[0] = 0; |
|  |  | if (func && arg->vt == JSI\_VT\_UNDEF && !interp->typeCheck.noundef && index>0 && !isdefault && !(typ&JSI\_TT\_UNDEFINED)) { |
|  |  | snprintf(idxBuf, sizeof(idxBuf), " arg %d", index); |
| Expand Down  Expand Up | | @@ -295,7 +295,7 @@ Jsi\_RC jsi\_StaticArgTypeCheck(Jsi\_Interp \*interp, int atyp, const char \*p1, cons |
|  |  | Jsi\_DString dStr = {}; |
|  |  | const char \*exp = jsi\_typeName(interp, typ, &dStr); |
|  |  | const char \*vtyp = jsi\_TypeName(interp, (Jsi\_ttype)atyp); |
|  |  | char idxBuf[200]; |
|  |  | char idxBuf[JSI\_MAX\_NUMBER\_STRING\*2]; |
|  |  | idxBuf[0] = 0; |
|  |  | if (index>0) |
|  |  | snprintf(idxBuf, sizeof(idxBuf), " arg %d", index); |
| Expand Down  Expand Up | | @@ -339,7 +339,7 @@ Jsi\_RC jsi\_RunFuncCallCheck(Jsi\_Interp \*interp, Jsi\_Func \*func, int argc, const |
|  |  | if (ss==NULL && spec == NULL) |
|  |  | return JSI\_OK; |
|  |  | int i, minArgs, maxArgs, mis = 0, varargs = 0; |
|  |  | char nbuf[100]; |
|  |  | char nbuf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  | if (func->type == FC\_BUILDIN) { |
|  |  | varargs = (spec->maxArgs<0); |
|  |  | maxArgs = spec->maxArgs + func->callflags.bits.addargs; |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/jsiHash.c](#diff-353ffd5887354e6ef47765e3c2226c40aa7a3f9bb016a0117d5fd558aa3d4440 "src/jsiHash.c")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsiHash.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -623,7 +623,7 @@ static Jsi\_Value \*jsi\_hashFmtKey(Jsi\_MapEntry\* h, struct Jsi\_MapOpts \*opts, int |
|  |  | void \*key = Jsi\_HashKeyGet(hPtr); |
|  |  | if (opts->keyType == JSI\_KEYS\_ONEWORD) |
|  |  | return Jsi\_ValueNewNumber(opts->interp, (Jsi\_Number)(intptr\_t)key); |
|  |  | char nbuf[100]; |
|  |  | char nbuf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  | snprintf(nbuf, sizeof(nbuf), "%p", key); |
|  |  | return Jsi\_ValueNewStringDup(opts->interp, nbuf); |
|  |  | } |
| Expand Down | |  |

6 changes: 3 additions & 3 deletions

6
[src/jsiInterp.c](#diff-caf32b11ffe4ac7e7a534fcd5e71d47dfa4592fcc7af7b769df4ea4ddb725880 "src/jsiInterp.c")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsiInterp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -700,7 +700,7 @@ static Jsi\_RC jsi\_InterpDelete(Jsi\_Interp \*interp, void \*ptr) { |
|  |  |  |
|  |  | Jsi\_Interp\* Jsi\_Main(Jsi\_InterpOpts \*opts) |
|  |  | { |
|  |  | int rc = 0; |
|  |  | Jsi\_RC rc = JSI\_OK; |
|  |  | Jsi\_Interp\* interp = NULL; |
|  |  | int argc = 0, first = 1; |
|  |  | char \*\*argv = NULL; |
| Expand Down  Expand Up | | @@ -929,7 +929,7 @@ Jsi\_Interp\* Jsi\_Main(Jsi\_InterpOpts \*opts) |
|  |  | } |
|  |  | if (jsi\_deleted) //TODO: rationalize jsi\_deleted, jsi\_exitCode, etc |
|  |  | return jsi\_DoExit(rc==JSI\_EXIT?NULL:interp, jsi\_exitCode); |
|  |  | if (rc == 0) { |
|  |  | if (rc == JSI\_OK) { |
|  |  | /\* Skip output from an ending semicolon which evaluates to undefined \*/ |
|  |  | Jsi\_Value \*ret = Jsi\_ReturnValue(interp); |
|  |  | if (!Jsi\_ValueIsType(interp, ret, JSI\_VT\_UNDEF)) { |
| Expand All | | @@ -940,7 +940,7 @@ Jsi\_Interp\* Jsi\_Main(Jsi\_InterpOpts \*opts) |
|  |  | } |
|  |  | } else { |
|  |  | if (!interp->parent && !interp->isHelp) |
|  |  | fputs("ERROR\n", stderr); |
|  |  | fprintf(stderr, "ERROR: %s\n", interp->errMsgBuf); |
|  |  | return jsi\_DoExit(interp, 1); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/jsiJSON.c](#diff-1e34f432e1212f15a1f9187db80e6d0e283e3b7e715cf03e05193d1ca9893597 "src/jsiJSON.c")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsiJSON.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,7 +6,7 @@ |
|  |  |  |
|  |  | static void jsonNewDString(Jsi\_Interp \*interp, Jsi\_DString \*dStr, const char\* str, int len) |
|  |  | { |
|  |  | char buf[100], \*dp = buf; |
|  |  | char buf[JSI\_MAX\_NUMBER\_STRING], \*dp = buf; |
|  |  | const char \*cp = str; |
|  |  | int ulen; |
|  |  |  |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[src/jsiMySql.c](#diff-4464a325b786de7918798f98c64c62624edf26522d7103edfa40359b45e42689 "src/jsiMySql.c")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsiMySql.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1169,7 +1169,7 @@ static void mdbDeleteCmd(MySqlObj \*jdb) |
|  |  | \*/ |
|  |  | static void mdbEvalSetColumnJSON(MyDbEvalContext \*p, int iCol, Jsi\_DString \*dStr) { |
|  |  | Jsi\_Interp \*interp = p->jdb->interp; |
|  |  | char nbuf[200]; |
|  |  | char nbuf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  | MysqlPrep \*prep = p->prep; |
|  |  | SqlFieldResults \*field = prep->fieldResult+iCol; |
|  |  | if (field->isnull) { |
| Expand Down  Expand Up | | @@ -1219,7 +1219,7 @@ static void mdbEvalSetColumnJSON(MyDbEvalContext \*p, int iCol, Jsi\_DString \*dStr |
|  |  |  |
|  |  | static void mdbEvalSetColumn(MyDbEvalContext \*p, int iCol, Jsi\_DString \*dStr) { |
|  |  | //Jsi\_Interp \*interp = p->jdb->interp; |
|  |  | char nbuf[200]; |
|  |  | char nbuf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  | MysqlPrep \*prep = p->prep; |
|  |  | SqlFieldResults \*field = prep->fieldResult+iCol; |
|  |  | Jsi\_Interp \*interp = p->jdb->interp; |
| Expand Down | |  |

10 changes: 5 additions & 5 deletions

10
[src/jsiNumber.c](#diff-db2630c258b0f9d263d739a47e0bb79cc9819061eef25ca2805fc67bce97bbbe "src/jsiNumber.c")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsiNumber.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -123,7 +123,7 @@ static Jsi\_RC NumberConstructor(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Value \* |
|  |  | static Jsi\_RC NumberToFixedCmd(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Value \*\_this, |
|  |  | Jsi\_Value \*\*ret, Jsi\_Func \*funcPtr) |
|  |  | { |
|  |  | char buf[100]; |
|  |  | char buf[JSI\_MAX\_NUMBER\_STRING+1]; |
|  |  | int prec = 0, skip = 0; |
|  |  | Jsi\_Number num; |
|  |  | Jsi\_Value \*v; |
| Expand All | | @@ -141,14 +141,14 @@ static Jsi\_RC NumberToFixedCmd(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Value \*\_ |
|  |  | static Jsi\_RC NumberToPrecisionCmd(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Value \*\_this, |
|  |  | Jsi\_Value \*\*ret, Jsi\_Func \*funcPtr) |
|  |  | { |
|  |  | char buf[100]; |
|  |  | char buf[JSI\_MAX\_NUMBER\_STRING\*2]; |
|  |  | int prec = 0, skip = 0; |
|  |  | Jsi\_Number num; |
|  |  | Jsi\_Value \*v; |
|  |  | ChkStringN(\_this, funcPtr, v); |
|  |  | if (Jsi\_GetIntFromValue(interp, Jsi\_ValueArrayIndex(interp, args, skip), &prec) != JSI\_OK) |
|  |  | return JSI\_ERROR; |
|  |  | if (prec<=0) return JSI\_ERROR; |
|  |  | if (prec<=0 || prec>JSI\_MAX\_NUMBER\_STRING) return Jsi\_LogError("precision must be between 1 and %d", JSI\_MAX\_NUMBER\_STRING); |
|  |  | Jsi\_GetDoubleFromValue(interp, v, &num); |
|  |  | snprintf(buf, sizeof(buf),"%.\*" JSI\_NUMFFMT, prec, num); |
|  |  | if (num<0) |
| Expand All | | @@ -163,7 +163,7 @@ static Jsi\_RC NumberToPrecisionCmd(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Valu |
|  |  | static Jsi\_RC NumberToExponentialCmd(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Value \*\_this, |
|  |  | Jsi\_Value \*\*ret, Jsi\_Func \*funcPtr) |
|  |  | { |
|  |  | char buf[100]; |
|  |  | char buf[JSI\_MAX\_NUMBER\_STRING+1]; |
|  |  | int prec = 0, skip = 0; |
|  |  | Jsi\_Number num; |
|  |  | Jsi\_Value \*v; |
| Expand Down  Expand Up | | @@ -191,7 +191,7 @@ static Jsi\_RC NumberToExponentialCmd(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Va |
|  |  | static Jsi\_RC NumberToStringCmd(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Value \*\_this, |
|  |  | Jsi\_Value \*\*ret, Jsi\_Func \*funcPtr) |
|  |  | { |
|  |  | char buf[500]; |
|  |  | char buf[JSI\_MAX\_NUMBER\_STRING+1]; |
|  |  | int radix = 10, skip = 0, argc = Jsi\_ValueGetLength(interp, args); |
|  |  | Jsi\_Number num; |
|  |  | Jsi\_Value \*v; |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/jsiOptions.c](#diff-f6e3609232a9ce7df88edc16cd022be52ea52b67a46edbdd223e7d9346b20c89 "src/jsiOptions.c")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsiOptions.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1876,7 +1876,7 @@ static Jsi\_RC jsi\_BitfieldToValue(Jsi\_Interp \*interp, Jsi\_OptionSpec\* spec, Jsi\_ |
|  |  | if (JSI\_OK != jsi\_EnumToValue(interp, eSpec, outValue, outStr, (void\*)&nval, flags)) |
|  |  | return JSI\_ERROR; |
|  |  | } else if (outStr) { |
|  |  | char obuf[100]; |
|  |  | char obuf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  | snprintf(obuf, sizeof(obuf), "%" PRId64, inum); |
|  |  | Jsi\_DSAppend(outStr, obuf, NULL); |
|  |  | } else { |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[src/jsiPstate.c](#diff-d779b2713e055bf25ed1321c4760c65928a620106e7e3e1ce17ca15885e4bedb "src/jsiPstate.c")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsiPstate.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -239,8 +239,8 @@ int jsi\_PstateSetFile(jsi\_Pstate \*ps, Jsi\_Channel fp, int skipbang) |
|  |  | l->d.fp = fp; |
|  |  | Jsi\_Rewind(ps->interp, fp); |
|  |  | if (skipbang) { |
|  |  | char buf[1000]; |
|  |  | if (Jsi\_Gets(ps->interp, fp, buf, 1000) && (buf[0] != '#' || buf[1] != '!')) { |
|  |  | char buf[JSI\_BUFSIZ]; |
|  |  | if (Jsi\_Gets(ps->interp, fp, buf, sizeof(buf)) && (buf[0] != '#' || buf[1] != '!')) { |
|  |  | Jsi\_Rewind(ps->interp, fp); |
|  |  | } |
|  |  | } |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/jsiRegexp.c](#diff-f1a097026129d8ac67ce543775bf656e28392770aeec6f121048ca93e19bb75e "src/jsiRegexp.c")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsiRegexp.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -162,7 +162,7 @@ Jsi\_RC Jsi\_RegExpMatch(Jsi\_Interp \*interp, Jsi\_Value \*pattern, const char \*v, in |
|  |  | int r = regexec(reg, v, 1, &pos, regexec\_flags); |
|  |  |  |
|  |  | if (r >= REG\_BADPAT) { |
|  |  | char buf[100]; |
|  |  | char buf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  |  |
|  |  | regerror(r, reg, buf, sizeof(buf)); |
|  |  | return Jsi\_LogError("error while matching pattern: %s", buf); |
| Expand Down | |  |

10 changes: 5 additions & 5 deletions

10
[src/jsiSqlite.c](#diff-d9acadb4504adf0cdaff2a44e01c049ffc4cb3e9c4e64238fde7c42565ce639f "src/jsiSqlite.c")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsiSqlite.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1395,7 +1395,7 @@ static void jsiSqlFunc(sqlite3\_context \*context, int argc, sqlite3\_value\*\*argv) |
|  |  |  |
|  |  | bool b; |
|  |  | if( rc != JSI\_OK) { |
|  |  | char buf[250]; |
|  |  | char buf[JSI\_BUFSIZ]; |
|  |  | snprintf(buf, sizeof(buf), "error in function: %.200s", p->zName); |
|  |  | sqlite3\_result\_error(context, buf, -1); |
|  |  |  |
| Expand Down  Expand Up | | @@ -1760,7 +1760,7 @@ static void dbEvalRowInfo( |
|  |  | \*/ |
|  |  | static void dbEvalSetColumnJSON(DbEvalContext \*p, int iCol, Jsi\_DString \*dStr) { |
|  |  | Jsi\_Interp \*interp = p->jdb->interp; |
|  |  | char nbuf[200]; |
|  |  | char nbuf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  |  |
|  |  | sqlite3\_stmt \*pStmt = p->pPreStmt->pStmt; |
|  |  |  |
| Expand Down  Expand Up | | @@ -1810,7 +1810,7 @@ static void dbEvalSetColumnJSON(DbEvalContext \*p, int iCol, Jsi\_DString \*dStr) { |
|  |  |  |
|  |  | static void dbEvalSetColumn(DbEvalContext \*p, int iCol, Jsi\_DString \*dStr) { |
|  |  | Jsi\_Interp \*interp = p->jdb->interp; |
|  |  | char nbuf[200]; |
|  |  | char nbuf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  |  |
|  |  | sqlite3\_stmt \*pStmt = p->pPreStmt->pStmt; |
|  |  |  |
| Expand Down  Expand Up | | @@ -2560,7 +2560,7 @@ static void dbOutputQuotedString(Jsi\_DString \*dStr, const char \*z) { |
|  |  | \*/ |
|  |  | static void dbOutputHexBlob(Jsi\_DString \*dStr, const void \*pBlob, int nBlob){ |
|  |  | int i; |
|  |  | char out[100], \*zBlob = (char \*)pBlob; |
|  |  | char out[JSI\_MAX\_NUMBER\_STRING], \*zBlob = (char \*)pBlob; |
|  |  | Jsi\_DSAppend(dStr, "X'", NULL); |
|  |  | for(i=0; i<nBlob; i++){ snprintf(out, sizeof(out),"%02x",zBlob[i]&0xff);Jsi\_DSAppend(dStr, out, NULL); } |
|  |  | Jsi\_DSAppend(dStr, "'", NULL); |
| Expand Down  Expand Up | | @@ -4393,7 +4393,7 @@ static int jsi\_DbQuery(Jsi\_Db \*jdb, Jsi\_CDataDb \*dbopts, const char \*query) |
|  |  |  |
|  |  | DbEvalContext sEval = {}; |
|  |  | int insert = 0, replace = 0, update = 0; |
|  |  | char nbuf[100], \*bPtr; |
|  |  | char nbuf[JSI\_MAX\_NUMBER\_STRING], \*bPtr; |
|  |  | #ifdef JSI\_DB\_DSTRING\_SIZE |
|  |  | JSI\_DSTRING\_VAR(dStr, JSI\_DB\_DSTRING\_SIZE); |
|  |  | #else |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[src/jsiString.c](#diff-40b0bfeda1ecc4d6676ee27031f1550a6cad7bf66462120feede39f9fe560396 "src/jsiString.c")

Show comments

[View file](/pcmacdon/jsish/blob/430ea27accd4d4ffddc946c9402e7c9064835a18/src/jsiString.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -724,7 +724,7 @@ static Jsi\_RC StringReplaceCmd(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Value \*\_ |
|  |  | int match = regexec(regex, p, MAX\_SUBREGEX, pmatch, regexec\_flags); |
|  |  |  |
|  |  | if (match >= REG\_BADPAT) { |
|  |  | char buf[100]; |
|  |  | char buf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  |  |
|  |  | regerror(match, regex, buf, sizeof(buf)); |
|  |  | Jsi\_LogError("error while matching pattern: %s", buf); |
| Expand Down  Expand Up | | @@ -895,7 +895,7 @@ static Jsi\_RC StringSearchCmd(Jsi\_Interp \*interp, Jsi\_Value \*args, Jsi\_Value \*\_t |
|  |  | return JSI\_OK; |
|  |  | } |
|  |  | if (r >= REG\_BADPAT) { |
|  |  | char buf[100]; |
|  |  | char buf[JSI\_MAX\_NUMBER\_STRING]; |
|  |  |  |
|  |  | regerror(r, reg, buf, sizeof(buf)); |
|  |  | Jsi\_LogError("error while matching pattern: %s", buf); |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `430ea27`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpcmacdon%2Fjsish%2Fcommit%2F430ea27accd4d4ffddc946c9402e7c9064835a18) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


