- **Root cause of vulnerability**: The admin API only checks the session, lacking proper CSRF protection.
- **Weaknesses/vulnerabilities present**: Cross-Site Request Forgery (CSRF). The application does not validate the origin of requests to admin endpoints, allowing an attacker to forge requests on behalf of an authenticated user.
- **Impact of exploitation**: An attacker can perform actions with admin privileges by tricking an authenticated admin user into submitting a forged request. In the provided example, an attacker can create a discount code.
- **Attack vectors**: The attacker crafts a malicious HTML page that includes a form which submits a request to the vulnerable admin endpoint. They then trick an authenticated administrator into accessing this page.
- **Required attacker capabilities/position**: The attacker needs to be able to convince an authenticated admin user to visit a page under the attacker's control or any other method of triggering the forged request. The attacker also needs to know the specific vulnerable endpoint and the required parameters.