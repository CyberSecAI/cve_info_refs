- **Root cause of vulnerability**: The vulnerability lies in the `plus/ajax_common.php` file where the `$_GET['query']` parameter is not properly sanitized before being used in a SQL query.
- **Weaknesses/vulnerabilities present**: The main vulnerability is a SQL injection. The `$_GET['query']` parameter is passed to `$gbk_query` and then processed by `iconv`, allowing manipulation using special characters and encodings (e.g., wide characters, Chinese characters). This bypasses input validation and allows direct injection of SQL code.
- **Impact of exploitation**: Successful exploitation leads to SQL injection, allowing attackers to potentially read, modify, or delete data in the database, or execute arbitrary commands depending on the database server configuration. In the provided proof of concept (PoC), the attacker is able to retrieve the database version and username, which demonstrates information disclosure.
- **Attack vectors**: The attack vector is through the `$_GET['query']` parameter in the `upload/plus/ajax_common.php` script, which is accessible via an HTTP GET request.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the server hosting the vulnerable application. No prior authentication is mentioned as necessary to trigger the vulnerability. The attacker should be able to craft the special characters to bypass the application's validation and insert SQL code.