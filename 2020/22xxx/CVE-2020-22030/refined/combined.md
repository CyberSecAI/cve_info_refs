=== Content from www.debian.org_7d3dec2e_20250119_121220.html ===


---

[[Date Prev](msg00174.html)][[Date Next](msg00176.html)]
[[Thread Prev](msg00174.html)][[Thread Next](msg00176.html)]
[[Date Index](maillist.html#00175)]
[[Thread Index](threads.html#00175)]

# [SECURITY] [DSA 4990-1] ffmpeg security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4990-1] ffmpeg security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Tue, 19 Oct 2021 18:51:14 +0000
* *Message-id*: <[[🔎]](/msgid-search/20211019185114.GA14597%40seger.debian.org) [20211019185114.GA14597@seger.debian.org](msg00175.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4990-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
October 19, 2021                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : ffmpeg
CVE ID         : CVE-2020-20445 CVE-2020-20446 CVE-2020-20453 CVE-2020-21041
                 CVE-2020-22015 CVE-2020-22016 CVE-2020-22017 CVE-2020-22019
                 CVE-2020-22020 CVE-2020-22021 CVE-2020-22022 CVE-2020-22023
                 CVE-2020-22025 CVE-2020-22026 CVE-2020-22027 CVE-2020-22028
                 CVE-2020-22029 CVE-2020-22030 CVE-2020-22031 CVE-2020-22032
                 CVE-2020-22033 CVE-2020-22034 CVE-2020-22035 CVE-2020-22036
                 CVE-2020-22037 CVE-2020-22049 CVE-2020-22054 CVE-2020-35965
                 CVE-2021-38114 CVE-2021-38171 CVE-2021-38291

Several vulnerabilities have been discovered in the FFmpeg multimedia
framework, which could result in denial of service or potentially the
execution of arbitrary code if malformed files/streams are processed.

For the oldstable distribution (buster), these problems have been fixed
in version 7:4.1.8-0+deb10u1.

We recommend that you upgrade your ffmpeg packages.

For the detailed security status of ffmpeg please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/ffmpeg>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAmFvE0MACgkQEMKTtsN8
Tjar1A//XPaJ4SP7JyAs3H845zwESim4+SsoK2sdz5fkFIiaM17lHcVTeQyDbGtw
5E9LfBRw9oxseU+6pCze3LdwqDKhdwiotDgWj4NZ8OJBLz4Iq12nJMkKCXAaTdFp
8pBYhrgLloyl+6Tdc76jBGMT9KhXtaWrNhsI/T01KNMD0yhOMBzgmgOJi7NgoMcS
/mk6TAfW5zGClMWCAVPHwmCx4S6C+8O99pgGdavbBZhtdFqZETgYFln8H3Wpw8V9
93MF4Qbwq7kZ3NLI+Jie5shM50ootzcHa8RP7Aaf+3K4mZ/9ORo8rvJF7mcJi4EG
fE/e0x/Q4bezdFbbgDFVLMzEq9vdO1UevO8gCWlfe17nh+JB3BEiwO9mF+cUuvb5
ySH8FA2W9EWEGEZgdgk2h8suHQ5ELI3sNLPnc9VA2IXF/PVl3Gm3vK3+ELedP5Lw
WK2QlWOiVPkzAvcY8EXtEzIMCdnioMKkrcr5bDzfCeL7FTR0A6St+NKYWO/31R2h
c6WGxAOMXSSSKe1j48mrsbqNlzPv7LwDyjS70ZJ3QrtQ4dp+prxnAD3A4uDk6fyO
7Qs466QF0bYRJP/I0DggKEwQKvdK9MSubSgftz414J+bqfE3WqUOjtUneN4ZTQx0
WXA7cPN/2rolLx2UGygPfqjlTcdFBFwWrBfXpu34jYD7ONiKGTU=
=i0d7
-----END PGP SIGNATURE-----

```

---



=== Content from trac.ffmpeg.org_47ebc22b_20250119_121219.html ===


[![FFmpeg](/ffmpeg-logo.png)](https://ffmpeg.org)

Search:

* [Login](/login)
* [Preferences](/prefs)
* [Help/Guide](/wiki/TracGuide)
* [About Trac](/about)
* [Register](/register)
* [Forgot your password?](/reset_password)

* [Wiki](/wiki)
* [Timeline](/timeline)
* [View Tickets](/report)
* [Search](/search)
* [Tags](/tags)

## Context Navigation

* ![Up-vote](/chrome/vote/aupgray.png)+0![Down-vote](/chrome/vote/adowngray.png)
* ← [Previous Ticket](/ticket/8275 "Ticket #8275")
* [Next Ticket](/ticket/8277 "Ticket #8277") →

---

Opened [5 years ago](/timeline?from=2019-10-15T14%3A38%3A46Z&precision=second "See timeline at Oct 15, 2019, 2:38:46 PM")

Closed [5 years ago](/timeline?from=2019-10-15T14%3A59%3A41Z&precision=second "See timeline at Oct 15, 2019, 2:59:41 PM")

## [#8276](/ticket/8276) [closed](/query?status=closed) [defect](/query?status=!closed&type=defect) ([fixed](/query?resolution=fixed&status=closed))

# heap-buffer-overflow at libavfilter/af\_afade.c:436:1 in crossfade\_samples\_fltp

| Reported by: | [Suhwan](/query?reporter=Suhwan&status=!closed) | Owned by: |  |
| --- | --- | --- | --- |
| Priority: | [normal](/query?priority=normal&status=!closed) | Component: | [undetermined](/query?component=undetermined&status=!closed) |
| Version: | [git-master](/query?status=!closed&version=git-master) | Keywords: | [asan](/query?keywords=~asan&status=!closed) |
| Cc: |  | Blocked By: |  |
| Blocking: |  | Reproduced by developer: | [no](/query?reproduced=0&status=!closed) |
| Analyzed by developer: | [no](/query?analyzed=0&status=!closed) |  |  |

## Description

Summary of the bug:

There is a heap-buffer-overflow at libavfilter/af\_afade.c:436:1 in crossfade\_samples\_fltp

I compiled ffmpeg with "--toolchain=clang-asan" to check the memory corruption and attached log file.

How to reproduce:

```
% ffmpeg_g -y -i $PoC1 -i $PoC2 -filter_complex acrossfade tmp.tta

ffmpeg version N-95382-g62f4722582 Copyright (c) 2000-2019 the FFmpeg developers
built with clang version 6.0.0-1ubuntu2 (tags/RELEASE_600/final)
configuration: --cc=clang --cxx=clang++ --ld=clang --enable-debug --toolchain=clang-asan

```

Here's ASAN log

```
==30297==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7fffd8445800 at pc 0x0000016a73a2 bp 0x7fffffffa6a0 sp 0x7fffffffa698
READ of size 4 at 0x7fffd8445800 thread T0
    #0 0x16a73a1 in crossfade_samples_fltp ffmpeg/libavfilter/af_afade.c:436:1
    #1 0x169963c in activate ffmpeg/libavfilter/af_afade.c:504:13
    #2 0x824c3e in ff_filter_activate ffmpeg/libavfilter/avfilter.c:1442:38
    #3 0x8700b2 in push_frame ffmpeg/libavfilter/buffersrc.c:187:15
    #4 0x8700b2 in av_buffersrc_add_frame_internal ffmpeg/libavfilter/buffersrc.c:261
    #5 0x86eaf2 in av_buffersrc_add_frame_flags ffmpeg/libavfilter/buffersrc.c:170:16
    #6 0x666407 in ifilter_send_frame ffmpeg/fftools/ffmpeg.c:2186:11
    #7 0x666407 in send_frame_to_filters ffmpeg/fftools/ffmpeg.c:2260
    #8 0x605543 in decode_audio ffmpeg/fftools/ffmpeg.c:2327:11
    #9 0x605543 in process_input_packet ffmpeg/fftools/ffmpeg.c:2609
    #10 0x64a707 in process_input ffmpeg/fftools/ffmpeg.c:4508:5
    #11 0x5e7157 in transcode_step ffmpeg/fftools/ffmpeg.c:4628:11
    #12 0x5e7157 in transcode ffmpeg/fftools/ffmpeg.c:4682
    #13 0x5db65b in main ffmpeg/fftools/ffmpeg.c:4884:9
    #14 0x7ffff5c93b96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310
    #15 0x41def9 in _start (ffmpeg_asan+0x41def9)

0x7fffd8445800 is located 0 bytes to the right of 159744-byte region [0x7fffd841e800,0x7fffd8445800)
allocated by thread T0 here:
    #0 0x4de9e8 in posix_memalign (ffmpeg_asan+0x4de9e8)
    #1 0x85924d1 in av_malloc ffmpeg/libavutil/mem.c:87:9
    #2 0x84f927d in av_buffer_alloc ffmpeg/libavutil/buffer.c:72:12
    #3 0x84fdc26 in pool_alloc_buffer ffmpeg/libavutil/buffer.c:313:26
    #4 0x84fdc26 in av_buffer_pool_get ffmpeg/libavutil/buffer.c:349
    #5 0x91c368 in ff_frame_pool_get ffmpeg/libavfilter/framepool.c:261:29
    #6 0x6e2d4c in ff_default_get_audio_buffer ffmpeg/libavfilter/audio.c:73:13
    #7 0x82a406 in ff_inlink_consume_samples ffmpeg/libavfilter/avfilter.c:1181:11
    #8 0x1699080 in activate ffmpeg/libavfilter/af_afade.c:492:19
    #9 0x824c3e in ff_filter_activate ffmpeg/libavfilter/avfilter.c:1442:38
    #10 0x8700b2 in push_frame ffmpeg/libavfilter/buffersrc.c:187:15
    #11 0x8700b2 in av_buffersrc_add_frame_internal ffmpeg/libavfilter/buffersrc.c:261
    #12 0x86eaf2 in av_buffersrc_add_frame_flags ffmpeg/libavfilter/buffersrc.c:170:16
    #13 0x666407 in ifilter_send_frame ffmpeg/fftools/ffmpeg.c:2186:11
    #14 0x666407 in send_frame_to_filters ffmpeg/fftools/ffmpeg.c:2260
    #15 0x605543 in decode_audio ffmpeg/fftools/ffmpeg.c:2327:11
    #16 0x605543 in process_input_packet ffmpeg/fftools/ffmpeg.c:2609
    #17 0x64a707 in process_input ffmpeg/fftools/ffmpeg.c:4508:5
    #18 0x5e7157 in transcode_step ffmpeg/fftools/ffmpeg.c:4628:11
    #19 0x5e7157 in transcode ffmpeg/fftools/ffmpeg.c:4682
    #20 0x5db65b in main ffmpeg/fftools/ffmpeg.c:4884:9
    #21 0x7ffff5c93b96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310

SUMMARY: AddressSanitizer: heap-buffer-overflow ffmpeg/libavfilter/af_afade.c:436:1 in crossfade_samples_fltp
Shadow bytes around the buggy address:
  0x10007b080ab0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x10007b080ac0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x10007b080ad0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x10007b080ae0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x10007b080af0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x10007b080b00:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x10007b080b10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x10007b080b20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x10007b080b30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x10007b080b40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x10007b080b50: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==30297==ABORTING

```

Please confirm.

Thanks

### Attachments (2)

[PoC1\_af\_afade\_436.vob](/attachment/ticket/8276/PoC1_af_afade_436.vob "View attachment")[​](/raw-attachment/ticket/8276/PoC1_af_afade_436.vob "Download")
(1.0 MB
) - added by Suhwan [5 years ago](/timeline?from=2019-10-15T14%3A39%3A17Z&precision=second "See timeline at Oct 15, 2019, 2:39:17 PM").
poc1
[PoC2\_af\_afade\_436.wav](/attachment/ticket/8276/PoC2_af_afade_436.wav "View attachment")[​](/raw-attachment/ticket/8276/PoC2_af_afade_436.wav "Download")
(125.0 KB
) - added by Suhwan [5 years ago](/timeline?from=2019-10-15T14%3A39%3A31Z&precision=second "See timeline at Oct 15, 2019, 2:39:31 PM").
poc2

Download all attachments as:
[.zip](/zip-attachment/ticket/8276/)

Oldest first

Newest first

Threaded

Show comments

Show property changes

### Change History (3)

### by Suhwan, [5 years ago](/timeline?from=2019-10-15T14%3A39%3A17Z&precision=second "See timeline at Oct 15, 2019, 2:39:17 PM")

| Attachment: | [*PoC1\_af\_afade\_436.vob*](/attachment/ticket/8276/PoC1_af_afade_436.vob)[​](/raw-attachment/ticket/8276/PoC1_af_afade_436.vob "Download") added |
| --- | --- |

poc1

### by Suhwan, [5 years ago](/timeline?from=2019-10-15T14%3A39%3A31Z&precision=second "See timeline at Oct 15, 2019, 2:39:31 PM")

| Attachment: | [*PoC2\_af\_afade\_436.wav*](/attachment/ticket/8276/PoC2_af_afade_436.wav)[​](/raw-attachment/ticket/8276/PoC2_af_afade_436.wav "Download") added |
| --- | --- |

poc2

### [comment:1](#comment:1) by Elon Musk, [5 years ago](/timeline?from=2019-10-15T14%3A59%3A41Z&precision=second "See timeline at Oct 15, 2019, 2:59:41 PM")

| Resolution: | → fixed |
| --- | --- |
| Status: | new → closed |

**Note:**
See [TracTickets](/wiki/TracTickets)
for help on using tickets.

### Download in other formats:

* [RSS Feed](/ticket/8276?format=rss)
* [Comma-delimited Text](/ticket/8276?format=csv)
* [Tab-delimited Text](/ticket/8276?format=tab)

---

[![Trac Powered](/chrome/common/trac_logo_mini.png)](https://trac.edgewall.org/)

Powered by [**Trac 1.6**](/about)

By [Edgewall Software](http://www.edgewall.org/)
.

Visit the Trac open source project at
<http://trac.edgewall.org/>


