=== Content from plugins.jenkins.io_daaee8ff_20250119_133252.html ===

# Script Security

How to install

* [Documentation](/script-security/)
* [Releases](/script-security/releases/)
* [Issues](/script-security/issues/)
* [Dependencies](/script-security/dependencies/)
* [Health Score](/script-security/healthscore/)

## User’s guide

(adapted from information on [Template plugin in CloudBees Plugins guide](https://docs.cloudbees.com/docs/admin-resources/latest/plugins/template#template-sect-script-approval))

Various Jenkins plugins require that users define custom scripts, most commonly in the Groovy language, to customize Jenkins’s behavior. If everyone who writes these scripts is a Jenkins administrator—specifically if they have the Overall/RunScripts permission, used for example by the Script Console link—then they can write whatever scripts they like. These scripts may directly refer to internal Jenkins objects using the same API offered to plugins. Such users must be completely trusted, as they can do anything to Jenkins (even changing its security settings or running shell commands on the server).

However, if some script authors are “regular users” with only more limited permissions, such as Job/Configure, it is inappropriate to let them run arbitrary scripts. To support such a division of roles, the Script Security library plugin can be integrated into various feature plugins. It supports two related systems: script approval, and Groovy sandboxing.

### Script Approval

The first, and simpler, security system is to allow any kind of script to be run, but only with an administrator’s approval. There is a globally maintained list of approved scripts which are judged to not perform any malicious actions.

When a user saves some kind of configuration (for example, a job), there will be appropriate warnings indicating that approval is required. Administrators may approve those scripts using the Script Approval configuration page or following the approval link in the configuration. In previous versions of Script Security Plugin, scripts saved by administrators where automatically approved when saving them, but this functionality was disabled to prevent a variety of social engineering-based attacks. (“Saving” usually means from the web UI, but could also mean uploading a new XML configuration via REST or CLI.) or merely by creating a new item copying an existing one.

When a user saves a template configuration, a check is done whether any contained scripts have been edited from an approved text. (More precisely, whether the requested content has ever been approved before.) If it has not been approved, a request for approval of this script is added to a queue. (A warning is also displayed in the configuration screen UI when the current text of a script is not currently approved.)

An administrator may now go to *Manage Jenkins » In-process Script Approval* where a list of scripts pending approval will be shown. Assuming nothing dangerous-looking is being requested, just click Approve to let the script be run henceforth.

If you try to run an unapproved script, it will simply fail, typically with a message explaining that it is pending approval. You may retry once the script has been approved. The details of this behavior may vary according to the feature plugin integrating this library.

### Groovy Sandboxing

Waiting for an administrator to approve every change to a script, no matter how seemingly trivial, could be unacceptable in a team spread across timezones or during tight deadlines. As an alternative option, the Script Security system lets Groovy scripts be run without approval so long as they limit themselves to operations considered inherently safe. This limited execution environment is called a sandbox. (Currently no sandbox implementations are available for other languages, so all such scripts must be approved if configured by non-administrators.)

To switch to this mode, simply check the box Use Groovy Sandbox below the Groovy script’s entry field. Sandboxed scripts can be run immediately by anyone. (Even administrators, though the script is subject to the same restrictions regardless of who wrote it.) When the script is run, every method call, object construction, and field access is checked against a whitelist of approved operations. If an unapproved operation is attempted, the script is killed and the corresponding Jenkins feature cannot be used yet.

The Script Security plugin ships with a small default whitelist, and integrating plugins may add operations to that list (typically methods specific to that plugin).

But you are not limited to the default whitelist: every time a script fails before running an operation that is not yet whitelisted, that operation is automatically added to another approval queue. An administrator can go to the same page described above for approval of entire scripts, and see a list of pending operation approvals. If Approve is clicked next to the signature of an operation, it is immediately added to the whitelist and available for sandboxed scripts.

Most signatures be of the form `method class.Name methodName arg1Type arg2Type…`, indicating a Java method call with a specific “receiver” class (this), method name, and list of argument (or parameter) types. (The most general signature of an attempted method call will be offered for approval, even when the actual object it was to be called on was of a more specific type overriding that method.) You may also see `staticMethod` for static (class) methods, `new` for constructors, and `field` for field accesses (get or set).

Administrators in security-sensitive environments should carefully consider which operations to whitelist. Operations which change state of persisted objects (such as Jenkins jobs) should generally be denied. Most `getSomething` methods are harmless.

In case of highly secured environments, where only sandbox scripts are allowed, the option "Force the use of the sandbox globally in the system" allows forcing the use of the sandbox globally in the system and will block the creation of new items in the "In-process Script Approval" screen.

### ACL-aware methods

Be aware however that even some “getter” methods are designed to check specific permissions (using an ACL: access control list), whereas scripts are often run by a system pseudo-user to whom all permissions are granted. So for example `method hudson.model.AbstractItem getParent` (which obtains the folder or Jenkins root containing a job) is in and of itself harmless, but the possible follow-up call `method hudson.model.ItemGroup getItems` (which lists jobs by name within a folder) checks Job/Read. This second call would be dangerous to whitelist unconditionally, since it would mean that a user who is granted Job/Create in a folder would be able to read at least some information from any jobs in that folder, even those which are supposed to be hidden according to a project-based authorization strategy; it would suffice to create a job in the folder which includes a Groovy script like this (details would vary according to the integrating plugin):

`println("I sniffed ${thisjob.getParent().getItems()}!");`

When run, the script output would display at least the names of supposedly secret projects. An administrator may instead click Approve assuming permission check for `getItems`; this will permit the call when run as an actual user (if the integrating plugin ever does so), while forbidding it when run as the system user (which is more typical). In this case, `getItems` is actually implemented to return only those jobs which the current user has access to, so if run in the former case (as a specific user), the description will show just those jobs they could see anyway. This more advanced button is shown only for method calls (and constructors), and should be used only where you know that Jenkins is doing a permission check.

## Developer’s guide

[Complete example integration](https://github.com/jenkinsci/groovy-postbuild-plugin/pull/11/files)

### The easy way

For a typical Groovy integration, in which you offer the user the option of using either script approval or the sandbox, change your describable’s String-valued script field into a SecureGroovyScript field. In your constructor, before storing the value, call `configuringWithKeyItem` (if there could only be one such script per top-level item) or configuringWithNonKeyItem (if there might be several). The configuration form should use `<f:property field="…"/>` to pick up the script and sandbox configuration. When you want to run the script, just call evaluate.

(For compatibility with old data, pick a different field name and deprecate the original. Then you can define a readResolve method which sets the new field to a SecureGroovyScript with the sandbox off, calls `configuring(ApprovalContext.create())` on it to notify the system that an unapproved script has been loaded, and unsets the old field.)

### The hard way

To be used if you need more control than SecureGroovyScript offers:

Introduce a boolean sandbox field into your configuration.

When unset, you need to call `ScriptApproval.configuring` in the `@DataBoundConstructor`. Use `ApprovalContext.withCurrentUser`, and also `withItemAsKey` where applicable (when there is just one script per job); otherwise at least withItem where applicable, and/or `withKey` when you can uniquely identify this usage from the context (`StaplerRequest.findAncestorObject` is helpful here). This lets the system know a (possibly) new script has been configured by a particular person. You will also need a `readResolve` that calls configuring to notify the system when a configurable with script has been loaded from disk (and thus the configurer is unknown). Call `ScriptApproval.using` when the script is run, and catch `UnapprovedUsageException` if necessary. The descriptor should use form validation on the script field and call `ScriptApproval.checking` (generally your descriptor should already be doing at least a syntax check on this field).

When the sandbox field is set, you need merely set up the Groovy shell with `GroovySandbox.createSecureCompilerConfiguration` and then call `GroovySandbox.run`; be prepared to catch `RejectedAccessException` and call `ScriptApproval.accessRejected`.

### Preapproved methods for the sandbox

To preapprove some particular method calls, simply annotate them with @Whitelisted if in your plugin; otherwise you can register (with `@Extension`) a ProxyWhitelist delegating to StaticWhitelist.from and loading a text file listing whitelisted methods.

### Classpath for evaluating scripts

When constructing a GroovyShell to evaluate a script, or calling `ecureGroovyScript.evaluate`, you must pass a `ClassLoader` which represents the effective classpath for the script. You could use the loader of Jenkins core, or your plugin, or `Jenkins.getInstance().getPluginManager().uberClassLoader`.

Whatever you choose, do not allow an unprivileged user to add arbitrary classpath entries by making a `URLClassLoader`! This would make it trivial to bypass all security when using the sandbox. (A user need merely make this or another job archive a JAR containing some class with a static method marked `@Whitelisted` and doing whatever they like, then call the method from their script.) No attack has yet been demonstrated when using whole-script approval—a `URLClassLoader` with normal parent-first delegation would not permit trivial masking of innocent-looking APIs by compromised versions—but it is likely that some clever use of `META-INF/services/org.codehaus.groovy.transform.ASTTransformation` or similar could cause an otherwise safe script to behave in an unexpected and unauthorized manner. [JENKINS-22834](https://issues.jenkins-ci.org/browse/JENKINS-22834) suggests a safe standard alternative.

### Unit tests

When writing tests for plug-ins that use the Script Security Plugin you may encounter some errors in your tests.

If your tests call, direct or indirectly, the `ScriptApproval.get()` method, then your unit tests must use JenkinsRule so that `Jenkins.getInstance()` does not return null. It is likely that tests that were working now start to fail if you are not using the sandbox. It occurs because they are being enqueued for approval. In case you need to execute scripts regardless of approvals, `ScriptApproval.get().preapprove(script, GroovyLanguage.get())` will ensure that all configured scripts are approved. Alternately, you can have your tests run scripts using the sandbox. In this case you may need to whitelist methods used by your tests -- either generally for real users, or using a `@TestExtension` to have a whitelist just for tests.

## Version history

From of version 1.77 see [GitHub Releases](https://github.com/jenkinsci/script-security-plugin/releases). [Archives](https://github.com/jenkinsci/script-security-plugin/blob/71755e3bd5cf0f04acfcb5afc27b5a29252fca7e/CHANGELOG.md)

##### Version: 1369.v9b\_98a\_4e95b\_2d

Released: 2 months agoRequires Jenkins 2.387.3ID: script-security
##### Installed on 98.6% of controllers

[View detailed version information](https://old.stats.jenkins.io/pluginversions/script-security.html)
##### Links

[GitHub](https://github.com/jenkinsci/script-security-plugin)[Open issues (Jira)](https://issues.jenkins.io/issues/?jql=resolution%20is%20EMPTY%20and%20component%3D18520)[Report an issue (Jira)](https://www.jenkins.io/participate/report-issue/redirect/#18520/script-security)[Extension Points](https://www.jenkins.io/doc/developer/extensions/script-security)[Javadoc](https://javadoc.jenkins.io/plugin/script-security)
##### Labels

[Library plugins (for use by other plugins)](/ui/search/?labels=api-plugin)[Security](/ui/search/?labels=security)
##### Maintainers

[Jesse Glick](/ui/search/?query=jglick)[Kohsuke Kawaguchi](/ui/search/?query=kohsuke)[Andrew Bayer](/ui/search/?query=abayer)[rsandell](/ui/search/?query=rsandell)[Devin Nusbaum](/ui/search/?query=dnusbaum)[Carroll Chiou](/ui/search/?query=carroll)[Liam Newman](/ui/search/?query=bitwiseman)[Karl Shultz](/ui/search/?query=kshultz)
##### Help us improve this page!

To propose a change submit a pull request to [the plugin page](https://github.com/jenkinsci/script-security-plugin) on GitHub.
##### Previous Security Warnings

* ###### [Groovy sandbox protection incomplete](https://jenkins.io/security/advisory/2016-04-11/)

  + Affects version 1.18 and earlier
* ###### [Unsafe methods in the default list of approved signatures](https://jenkins.io/security/advisory/2017-07-10/)

  + Affects version 1.29 and earlier
* ###### [Multiple sandbox bypasses](https://jenkins.io/security/advisory/2017-08-07/)

  + Affects version 1.30 and earlier
* ###### [Arbitrary file read vulnerability](https://jenkins.io/security/advisory/2017-12-11/)

  + Affects version 1.36 and earlier
* ###### [Script Security sandbox bypass](https://jenkins.io/security/advisory/2018-10-29/#SECURITY-1186)

  + Affects version 1.47 and earlier
* ###### [Script Security sandbox bypass](https://jenkins.io/security/advisory/2019-01-08/#SECURITY-1266)

  + Affects version 1.49 and earlier
* ###### [Script Security sandbox bypass](https://jenkins.io/security/advisory/2019-01-28/#SECURITY-1292)

  + Affects version 1.50 and earlier
* ###### [Script Security sandbox bypass](https://jenkins.io/security/advisory/2019-02-19/#SECURITY-1320)

  + Affects version 1.52 and earlier
* ###### [Script security sandbox bypass](https://jenkins.io/security/advisory/2019-03-06/#SECURITY-1336%20(1))

  + Affects version 1.53 and earlier
* ###### [Script Security sandbox bypass](https://jenkins.io/security/advisory/2019-03-25/#SECURITY-1353)

  + Affects version 1.55 and earlier
* ###### [Sandbox bypass through type casts](https://jenkins.io/security/advisory/2019-07-31/#SECURITY-1465%20(1))

  + Affects version 1.61 and earlier
* ###### [Sandbox bypass through method pointer expressions](https://jenkins.io/security/advisory/2019-07-31/#SECURITY-1465%20(2))

  + Affects version 1.61 and earlier
* ###### [Sandbox bypass vulnerability](https://jenkins.io/security/advisory/2019-09-12/#SECURITY-1538)

  + Affects version 1.62 and earlier
* ###### [Sandbox bypass vulnerability](https://jenkins.io/security/advisory/2019-10-01/#SECURITY-1579)

  + Affects version 1.64 and earlier
* ###### [Sandbox bypass vulnerability](https://jenkins.io/security/advisory/2019-11-21/#SECURITY-1658)

  + Affects version 1.67 and earlier
* ###### [Sandbox bypass vulnerability](https://jenkins.io/security/advisory/2020-02-12/#SECURITY-1713)

  + Affects version 1.69 and earlier
* ###### [Sandbox bypass vulnerability](https://jenkins.io/security/advisory/2020-03-09/#SECURITY-1754)

  + Affects version 1.70 and earlier
* ###### [Stored XSS vulnerability](https://jenkins.io/security/advisory/2020-06-03/#SECURITY-1866)

  + Affects version 1.72 and earlier
* ###### [Sandbox bypass vulnerability](https://www.jenkins.io/security/advisory/2020-09-23/#SECURITY-2020)

  + Affects version 1.74 and earlier
* ###### [CSRF vulnerability](https://www.jenkins.io/security/advisory/2022-05-17/#SECURITY-2116)

  + Affects version 1158.v7c1b\_73a\_69a\_08 and earlier
* ###### [Sandbox bypass vulnerability](https://www.jenkins.io/security/advisory/2022-10-19/#SECURITY-2824%20(1))

  + Affects version 1183.v774b\_0b\_0a\_a\_451 and earlier
* ###### [Whole-script approval vulnerable to SHA-1 collisions](https://www.jenkins.io/security/advisory/2022-11-15/#SECURITY-2564)

  + Affects version 1189.vb\_a\_b\_7c8fd5fde and earlier
* ###### [Sandbox bypass vulnerability](https://www.jenkins.io/security/advisory/2023-01-24/#SECURITY-3016)

  + Affects version 1228.vd93135a\_2fb\_25 and earlier
* ###### [Multiple sandbox bypass vulnerabilities](https://www.jenkins.io/security/advisory/2024-05-02/#SECURITY-3341)

  + Affects version 1335.vf07d9ce377a\_e and earlier
* ###### [Missing permission check](https://www.jenkins.io/security/advisory/2024-11-13/#SECURITY-3447)

  + Affects version 1367.vdf2fc45f229c and earlier
![tracker](https://jenkins-matomo.do.g4v.dev/piwik.php?idsite=1&rec=1&url=https://plugins.jenkins.io//script-security/)



=== Content from www.jenkins.io_6fbcd972_20250119_114546.html ===


[Jenkins Security Home](/security/)

**For Administrators**

* [Overview](/security/for-administrators/)
* [Security Advisories](/security/advisories/)
* [Security Issues](/security/issues/)
* [Advisory Schedule](/security/scheduling/)
* [Vulnerabilities in Plugins](/security/plugins/)
* [How We Fix Security Issues](/security/fixing/)

**For Reporters**

* [Reporting Vulnerabilities](/security/reporting/)
* [Jenkins CNA](/security/cna/)

**For Maintainers**

* [Overview](/security/for-maintainers/)
* [Vulnerabilities in Plugins](/security/plugins/)

**Jenkins Security Team**

* [About](/security/team/)
* [Contributions](/security/improvements/)

# Jenkins Security Advisory 2020-09-23

This advisory announces vulnerabilities in the following Jenkins deliverables:

* [Implied Labels
  Plugin](https://plugins.jenkins.io/implied-labels)
* [Liquibase Runner
  Plugin](https://plugins.jenkins.io/liquibase-runner)
* [Liquibase Runner
  Plugin](https://plugins.jenkins.io/liquibase-runner)
* [Lockable Resources
  Plugin](https://plugins.jenkins.io/lockable-resources)
* [Script Security
  Plugin](https://plugins.jenkins.io/script-security)
* warnings
  Plugin

## Descriptions

### Sandbox bypass vulnerability in Script Security Plugin

**SECURITY-2020
/
CVE-2020-2279**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**Affected plugin:
[`script-security`](https://plugins.jenkins.io/script-security)**

**Description:**

Script Security Plugin provides a sandbox feature that allows low privileged users to define scripts, including Pipelines, that are generally safe to execute.
Calls to code defined inside a sandboxed script are intercepted, and various allowlists are checked to determine whether the call is to be allowed.

In Script Security Plugin 1.74 and earlier, any calls from outside a sandboxed script to code defined inside a sandboxed script were always allowed.
As sandboxed scripts can communicate their results through script return values and similar mechanisms, this could result in code defined inside of a sandboxed script to be called without sandbox protection.

This vulnerability allows attackers with permission to define and run sandboxed scripts, including Pipelines, to bypass the sandbox protection and execute arbitrary code in the context of the Jenkins controller JVM.

Script Security Plugin 1.75 will prevent code defined inside a sandbox from being invoked outside a sandboxed script.

In rare cases, invocations of sandboxed scripts may begin failing if the script return value or script binding include code defined in the sandbox and is further processed by the calling code.
To resolve this issue, the affected values need to be converted inside the sandboxed script to a known safe type, such as `String`.

For compatibility with this change, the following plugins should be upgraded to the versions specified:

* [Email Extension Plugin](https://plugins.jenkins.io/email-ext) should be updated to version 2.77 or newer.
* [Warnings Next Generation Plugin](https://plugins.jenkins.io/warnings-ng) should be updated to version 8.4.3 or newer.
* [Warnings Plugin](https://plugins.jenkins.io/warnings) should be updated to version 5.0.2 or newer.
### CSRF vulnerability in warnings Plugin allows remote code execution

**SECURITY-2042
/
CVE-2020-2280**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Affected plugin:
[`warnings`](https://plugins.jenkins.io/warnings)**

**Description:**

warnings Plugin 5.0.1 and earlier does not require POST requests for a form validation method intended for testing custom warnings parsers, resulting in a cross-site request forgery (CSRF) vulnerability.

This vulnerability allows attackers to execute arbitrary code.

warnings Plugin 5.0.2 requires POST requests for the affected form validation method.

This vulnerability was caused by an incomplete fix to [SECURITY-1295](/security/advisory/2019-01-28/).

### CSRF vulnerability in Lockable Resources Plugin

**SECURITY-1958
/
CVE-2020-2281**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L)

**Affected plugin:
[`lockable-resources`](https://plugins.jenkins.io/lockable-resources)**

**Description:**

Lockable Resources Plugin 2.8 and earlier does not require POST requests for several HTTP endpoints, resulting in a cross-site request forgery (CSRF) vulnerability.

This vulnerability allows attackers to reserve, unreserve, unlock, and reset resources.

Lockable Resources Plugin 2.9 requires POST requests for the affected HTTP endpoints.

### Missing permission check in Implied Labels Plugin allows reconfiguring the plugin

**SECURITY-2004
/
CVE-2020-2282**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L)

**Affected plugin:
[`implied-labels`](https://plugins.jenkins.io/implied-labels)**

**Description:**

Implied Labels Plugin 0.6 and earlier does not perform a permission check in an HTTP endpoint.

This allows attackers with Overall/Read permission to configure the plugin.

Implied Labels Plugin 0.7 requires Overall/Administer permission to configure the plugin.

### Stored XSS vulnerability in Liquibase Runner Plugin

**SECURITY-1885
/
CVE-2020-2283**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H)

**Affected plugin:
[`liquibase-runner`](https://plugins.jenkins.io/liquibase-runner)**

**Description:**

Liquibase Runner Plugin 1.4.5 and earlier does not escape changeset contents when showing them on the build page.

This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to provide Liquibase changesets evaluated by the plugin.

Liquibase Runner Plugin 1.4.7 no longer supports evaluating changesets.

### XXE vulnerability in Liquibase Runner Plugin

**SECURITY-1887
/
CVE-2020-2284**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N)

**Affected plugin:
[`liquibase-runner`](https://plugins.jenkins.io/liquibase-runner)**

**Description:**

Liquibase Runner Plugin 1.4.5 and earlier does not configure its XML parser to prevent XML external entity (XXE) attacks.

This allows attackers able to provide Liquibase changesets evaluated by the plugin to have Jenkins parse a crafted XML file that uses external entities for extraction of secrets from the Jenkins controller or server-side request forgery.

Liquibase Runner Plugin 1.4.7 no longer parses Liquibase changesets.

### Missing permission check in Liquibase Runner Plugin allows enumerating credentials IDs

**SECURITY-2030
/
CVE-2020-2285**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`liquibase-runner`](https://plugins.jenkins.io/liquibase-runner)**

**Description:**

Liquibase Runner Plugin 1.4.7 and earlier does not perform a permission check in an HTTP endpoint.

This allows attackers with Overall/Read permission to enumerate credentials IDs of credentials stored in Jenkins. Those can be used as part of an attack to capture the credentials using another vulnerability.

An enumeration of credentials IDs in Liquibase Runner Plugin 1.4.8 requires the appropriate permissions.

## Severity

* SECURITY-1885:
  [High](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H)
* SECURITY-1887:
  [High](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N)
* SECURITY-1958:
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L)
* SECURITY-2004:
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L)
* SECURITY-2020:
  [High](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)
* SECURITY-2030:
  [Medium](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-2042:
  [High](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

## Affected Versions

* **Implied Labels
  Plugin**
  up to and including
  0.6
* **Liquibase Runner
  Plugin**
  up to and including
  1.4.5
* **Liquibase Runner
  Plugin**
  up to and including
  1.4.7
* **Lockable Resources
  Plugin**
  up to and including
  2.8
* **Script Security
  Plugin**
  up to and including
  1.74
* **warnings
  Plugin**
  up to and including
  5.0.1

## Fix

* **Implied Labels
  Plugin**
  should be updated to version
  0.7
* **Liquibase Runner
  Plugin**
  should be updated to version
  1.4.7
* **Liquibase Runner
  Plugin**
  should be updated to version
  1.4.8
* **Lockable Resources
  Plugin**
  should be updated to version
  2.9
* **Script Security
  Plugin**
  should be updated to version
  1.75
* **warnings
  Plugin**
  should be updated to version
  5.0.2

These versions include fixes to the vulnerabilities described above. All prior versions are considered to be affected by these vulnerabilities unless otherwise indicated.

## Credit

The Jenkins project would like to thank the reporters for discovering and
[reporting](/security/#reporting-vulnerabilities)
these vulnerabilities:

* **Daniel Beck, CloudBees, Inc.**
  for
  SECURITY-1885, SECURITY-1887, SECURITY-2030
* **Devin Nusbaum, CloudBees, Inc.**
  for
  SECURITY-2042
* **Pierre Beitz, CloudBees, Inc.**
  for
  SECURITY-1958
* **Wadeck Follonier, CloudBees, Inc. and Daniel Beck, CloudBees, Inc.**
  for
  SECURITY-2020



=== Content from www.openwall.com_83ee4057_20250119_114545.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2020/09/22/11) [[next>]](../../../2020/09/26/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <72558D3A-640E-4561-862F-91453510916E@beckweb.net>
Date: Wed, 23 Sep 2020 14:57:59 +0200
From: Daniel Beck <ml@...kweb.net>
To: oss-security@...ts.openwall.com
Subject: Multiple vulnerabilities in Jenkins plugins

Jenkins is an open source automation server which enables developers around
the world to reliably build, test, and deploy their software.

The following releases contain fixes for security vulnerabilities:

* Implied Labels Plugin 0.7
* Liquibase Runner Plugin 1.4.8
* Lockable Resources Plugin 2.9
* Script Security Plugin 1.75
* Warnings Plugin 5.0.2

Summaries of the vulnerabilities are below. More details, severity, and
attribution can be found here:
<https://www.jenkins.io/security/advisory/2020-09-23/>

We provide advance notification for security updates on this mailing list:
<https://groups.google.com/d/forum/jenkinsci-advisories>

If you discover security vulnerabilities in Jenkins, please report them as
described here:
<https://www.jenkins.io/security/#reporting-vulnerabilities>

---

SECURITY-2020 / CVE-2020-2279
Script Security Plugin provides a sandbox feature that allows low
privileged users to define scripts, including Pipelines, that are generally
safe to execute. Calls to code defined inside a sandboxed script are
intercepted, and various allowlists are checked to determine whether the
call is to be allowed.

In Script Security Plugin 1.74 and earlier, any calls from outside a
sandboxed script to code defined inside a sandboxed script were always
allowed. As sandboxed scripts can communicate their results through script
return values and similar mechanisms, this could result in code defined
inside of a sandboxed script to be called without sandbox protection.

This vulnerability allows attackers with permission to define and run
sandboxed scripts, including Pipelines, to bypass the sandbox protection
and execute arbitrary code in the context of the Jenkins controller JVM.

SECURITY-2042 / CVE-2020-2280
Warnings Plugin 5.0.1 and earlier does not require POST requests for a form
validation method intended for testing custom warnings parsers, resulting
in a cross-site request forgery (CSRF) vulnerability.

This vulnerability allows attackers to execute arbitrary code.

SECURITY-1958 / CVE-2020-2281
Lockable Resources Plugin 2.8 and earlier does not require POST requests
for several HTTP endpoints, resulting in a cross-site request forgery
(CSRF) vulnerability.

This vulnerability allows attackers to reserve, unreserve, unlock, and
reset resources.

SECURITY-2004 / CVE-2020-2282
Implied Labels Plugin 0.6 and earlier does not perform a permission check
in an HTTP endpoint.

This allows attackers with Overall/Read permission to configure the plugin.

SECURITY-1885 / CVE-2020-2283
Liquibase Runner Plugin 1.4.5 and earlier does not escape changeset
contents when showing them on the build page.

This results in a stored cross-site scripting (XSS) vulnerability
exploitable by attackers able to provide Liquibase changesets evaluated by
the plugin.

SECURITY-1887 / CVE-2020-2284
Liquibase Runner Plugin 1.4.5 and earlier does not configure its XML parser
to prevent XML external entity (XXE) attacks.

This allows attackers able to provide Liquibase changesets evaluated by the
plugin to have Jenkins parse a crafted XML file that uses external entities
for extraction of secrets from the Jenkins controller or server-side
request forgery.

SECURITY-2030 / CVE-2020-2285
Liquibase Runner Plugin 1.4.7 and earlier does not perform a permission
check in an HTTP endpoint.

This allows attackers with Overall/Read permission to enumerate credentials
IDs of credentials stored in Jenkins. Those can be used as part of an
attack to capture the credentials using another vulnerability.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.jenkins.io_ebe9f477_20250119_133254.html ===


[Jenkins Security Home](/security/)

**For Administrators**

* [Overview](/security/for-administrators/)
* [Security Advisories](/security/advisories/)
* [Security Issues](/security/issues/)
* [Advisory Schedule](/security/scheduling/)
* [Vulnerabilities in Plugins](/security/plugins/)
* [How We Fix Security Issues](/security/fixing/)

**For Reporters**

* [Reporting Vulnerabilities](/security/reporting/)
* [Jenkins CNA](/security/cna/)

**For Maintainers**

* [Overview](/security/for-maintainers/)
* [Vulnerabilities in Plugins](/security/plugins/)

**Jenkins Security Team**

* [About](/security/team/)
* [Contributions](/security/improvements/)

# Jenkins Security

The Jenkins project takes security seriously.
We make every possible effort to ensure users can adequately secure their automation infrastructure.
To that end, we work with Jenkins core and plugin developers, as well as security researchers, to fix security vulnerabilities in Jenkins in a timely manner, and to improve the security of Jenkins in general.

Learn more about [Securing Jenkins](/doc/book/security/) in the Jenkins User Handbook.

## Security Advisories

Security advisories are the primary way to publicly inform Jenkins users about security issues in Jenkins and Jenkins plugins.
You can find all past security advisories in our [security advisories archive](/security/advisories/).

We announce the publication of a new security advisory through multiple channels:

* We send an email notification to the public [`jenkinsci-advisories`](https://groups.google.com/g/jenkinsci-advisories) Google group with a short overview of affected components and a link to the security advisory. Only Jenkins security team members can post. You can subscribe and unsubscribe via email.
* We send an email notification to the [`oss-security`](https://oss-security.openwall.org/wiki/mailing-lists/oss-security) mailing list with excerpts of the security advisory.
* We publish an [RSS feed for the jenkins.io/security/advisories/](/security/advisories/rss.xml) page.

Additionally, Jenkins administrators are informed about published security issues directly in Jenkins if they have affected versions of Jenkins or plugins installed.

Finally, the Jenkins project is a [CVE Numbers Authority](/security/cna), and we submit CVE metadata simultaneously with the publication of security advisories, allowing automated security tools using CVE information to identify vulnerable installations.

|  | Even if you run Jenkins on a private network and trust everyone in your team, security issues in Jenkins can still impact you:   * [CSRF vulnerabilities](https://en.wikipedia.org/wiki/Cross-site_request_forgery) are a risk even if attackers have no direct access to Jenkins. * Does Jenkins build source code you haven’t audited, using build scripts someone else wrote, displaying generated reports on its web UI?   All of these are potential security concerns. |
| --- | --- |

## How to Report a Security Vulnerability

If you find a vulnerability in Jenkins, please [report it in the issue tracker under the SECURITY project](https://issues.jenkins.io/secure/CreateIssueDetails%21init.jspa?pid=10180&issuetype=10103).
This project is configured in such a way that only the reporter, the maintainers, and the Jenkins security team can see the details.
Restricting access to this potentially sensitive information allows core and plugin maintainers to develop effective security fixes that are safe to apply.
We provide issue reporting guidelines and an overview of our process on [Reporting Security Vulnerabilities](reporting).

If you are unable to report using our issue tracker, you can also send your report to the private Jenkins Security Team mailing list:
`jenkinsci-cert@googlegroups.com`

|  | Do not contact the Jenkins security team asking us for compliance documents, certifications, or to fill out a questionnaire. We will not respond to such queries. If we consider it necessary to provide a statement in response to incidents such as [log4shell](/blog/2021/12/10/log4j2-rce-CVE-2021-44228/) or [SpringShell](/blog/2022/03/31/spring-rce-CVE-2022-22965/), you will find a response in our [blog](/blog/). |
| --- | --- |

## Learn More

[How We Handle Vulnerabilities in Plugins](plugins)

We strive to fix all security vulnerabilities in Jenkins and plugins in a timely manner.
However the number and diversity of plugins and maintainers' autonomy make this impossible to guarantee.

[How We Schedule Security Advisories](scheduling)

Information about how we schedule security advisories and security updates.

[How We Fix Security Issues](fixing)

Guidelines for developing security fixes in the Jenkins project.

[Information for Plugin Maintainers](for-maintainers)

The Jenkins security team contacted me about a security vulnerability. Now what?

[Information for Administrators](for-administrators)

This page explains everything Jenkins users and administrators need to know about the Jenkins security process.

[Jenkins CVE Numbers Authority](cna)

The Jenkins project is a CVE Numbers Authority (CNA) for Jenkins and Jenkins plugins published by the Jenkins project.

[About the Jenkins Security Team](team)

The Jenkins Security Team is a group of volunteers led by the Jenkins Security Officer who triage and fix security vulnerabilities.

[Improvements by the Security Team](improvements)

These are some contributions by members of the Jenkins security team that weren’t delivered as security fixes, but still are security-related.


