The provided content relates to CVE-2020-2191.

**Root cause of vulnerability:**
The Swarm Plugin API endpoints for adding or removing agent labels did not perform regular permission checks and did not require POST requests.

**Weaknesses/vulnerabilities present:**
*   **Improper permission checks:** API endpoints only required a global Swarm secret to use, bypassing regular permission checks.
*   **CSRF vulnerability:** API endpoints did not require POST requests, making them vulnerable to cross-site request forgery.

**Impact of exploitation:**
*   Users with Agent/Create permission could add or remove labels of any agent.
*   CSRF vulnerability allowed for unauthorized manipulation of agent labels.

**Attack vectors:**
*   Network access to the Jenkins instance.
*   Exploitation of the API endpoints using a global Swarm secret.
*   CSRF via a malicious web page or other means to trigger API requests.

**Required attacker capabilities/position:**
*   User with Agent/Create permission within the Jenkins instance.
*   Knowledge of the global Swarm secret.
*   Ability to send HTTP requests to the Jenkins instance (for CSRF).