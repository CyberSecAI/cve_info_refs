=== Content from insinuator.net_e0c62082_20250119_134457.html ===


[Insinuator.net](https://insinuator.net/)

Bold Statements

Primary Menu

* [About](https://insinuator.net/about/)

* [RSS Feed](https://insinuator.net/?feed=rss)
* [Follow us](http://twitter.com/insinuator)

## Categories

* [Breaking](https://insinuator.net/category/breaking/)
* [Building](https://insinuator.net/category/building/)
* [Events](https://insinuator.net/category/events/)
* [Misc](https://insinuator.net/category/misc/)
## Tags

[4G](https://insinuator.net/tag/4g/)
[Active Directory](https://insinuator.net/tag/active-directory/)
[advisory](https://insinuator.net/tag/advisory/)
[Android](https://insinuator.net/tag/android/)
[Black Hat](https://insinuator.net/tag/black-hat/)
[blackhoodie](https://insinuator.net/tag/blackhoodie/)
[Bluetooth](https://insinuator.net/tag/bluetooth/)
[C3](https://insinuator.net/tag/c3/)
[Cisco](https://insinuator.net/tag/cisco/)
[cloud](https://insinuator.net/tag/cloud/)
[Day-Con](https://insinuator.net/tag/day-con/)
[disclosure](https://insinuator.net/tag/disclosure/)
[Docker](https://insinuator.net/tag/docker/)
[ERNW white paper](https://insinuator.net/tag/ernw-white-paper/)
[exploit](https://insinuator.net/tag/exploit/)
[forensics](https://insinuator.net/tag/forensics/)
[fuzzing](https://insinuator.net/tag/fuzzing/)
[GSM](https://insinuator.net/tag/gsm/)
[hardening](https://insinuator.net/tag/hardening/)
[hardware](https://insinuator.net/tag/hardware/)
[HITB](https://insinuator.net/tag/hitb/)
[iOS](https://insinuator.net/tag/ios/)
[IoT](https://insinuator.net/tag/iot/)
[IPv6](https://insinuator.net/tag/ipv6/)
[Linux](https://insinuator.net/tag/linux/)
[malware](https://insinuator.net/tag/malware/)
[medical](https://insinuator.net/tag/medical/)
[network](https://insinuator.net/tag/network/)
[pentest](https://insinuator.net/tag/pentest/)
[reversing](https://insinuator.net/tag/reversing/)
[RIPE](https://insinuator.net/tag/ripe/)
[risk](https://insinuator.net/tag/risk/)
[SAP](https://insinuator.net/tag/sap/)
[SDR](https://insinuator.net/tag/sdr/)
[Telco](https://insinuator.net/tag/telco/)
[TelcoSecDay](https://insinuator.net/tag/telcosecday/)
[tool](https://insinuator.net/tag/tool/)
[TROOPERS](https://insinuator.net/tag/troopers/)
[trust](https://insinuator.net/tag/trust/)
[virtualization](https://insinuator.net/tag/virtualization/)
[VMware](https://insinuator.net/tag/vmware/)
[VoIP](https://insinuator.net/tag/voip/)
[vulnerability](https://insinuator.net/tag/vulnerability/)
[web application](https://insinuator.net/tag/web-application/)
[Windows](https://insinuator.net/tag/windows/)
## Archives

Archives
Select Month
 November 2024  (2)
 September 2024  (2)
 August 2024  (2)
 June 2024  (2)
 May 2024  (4)
 April 2024  (4)
 February 2024  (1)
 October 2023  (3)
 September 2023  (2)
 August 2023  (1)
 July 2023  (1)
 June 2023  (2)
 May 2023  (3)
 December 2022  (1)
 September 2022  (2)
 August 2022  (1)
 June 2022  (1)
 April 2022  (1)
 March 2022  (1)
 December 2021  (1)
 October 2021  (1)
 July 2021  (1)
 May 2021  (4)
 April 2021  (2)
 March 2021  (1)
 February 2021  (3)
 January 2021  (5)
 December 2020  (4)
 November 2020  (6)
 October 2020  (2)
 September 2020  (5)
 July 2020  (3)
 June 2020  (1)
 May 2020  (1)
 April 2020  (2)
 March 2020  (3)
 February 2020  (3)
 January 2020  (2)
 December 2019  (2)
 November 2019  (6)
 October 2019  (4)
 September 2019  (3)
 August 2019  (3)
 July 2019  (6)
 June 2019  (6)
 May 2019  (7)
 April 2019  (7)
 March 2019  (2)
 February 2019  (4)
 January 2019  (14)
 December 2018  (4)
 November 2018  (11)
 October 2018  (6)
 September 2018  (1)
 August 2018  (4)
 July 2018  (3)
 June 2018  (3)
 May 2018  (3)
 April 2018  (5)
 March 2018  (8)
 February 2018  (12)
 January 2018  (2)
 December 2017  (2)
 November 2017  (3)
 October 2017  (7)
 September 2017  (5)
 August 2017  (3)
 July 2017  (3)
 June 2017  (6)
 May 2017  (5)
 April 2017  (3)
 March 2017  (8)
 February 2017  (6)
 January 2017  (8)
 December 2016  (12)
 November 2016  (14)
 October 2016  (12)
 September 2016  (12)
 August 2016  (9)
 July 2016  (9)
 June 2016  (7)
 May 2016  (10)
 April 2016  (23)
 March 2016  (29)
 February 2016  (14)
 January 2016  (12)
 December 2015  (15)
 November 2015  (6)
 October 2015  (9)
 September 2015  (7)
 August 2015  (5)
 July 2015  (6)
 June 2015  (14)
 May 2015  (9)
 April 2015  (9)
 March 2015  (13)
 February 2015  (10)
 January 2015  (18)
 December 2014  (10)
 November 2014  (10)
 October 2014  (7)
 September 2014  (3)
 August 2014  (9)
 July 2014  (5)
 June 2014  (1)
 May 2014  (9)
 April 2014  (1)
 March 2014  (3)
 February 2014  (5)
 January 2014  (13)
 December 2013  (5)
 November 2013  (5)
 October 2013  (4)
 September 2013  (1)
 August 2013  (10)
 July 2013  (10)
 June 2013  (5)
 May 2013  (4)
 April 2013  (10)
 March 2013  (4)
 February 2013  (12)
 January 2013  (6)
 December 2012  (2)
 November 2012  (4)
 October 2012  (1)
 September 2012  (3)
 July 2012  (3)
 June 2012  (3)
 May 2012  (8)
 April 2012  (2)
 March 2012  (5)
 February 2012  (6)
 January 2012  (4)
 December 2011  (7)
 November 2011  (7)
 October 2011  (6)
 September 2011  (3)
 August 2011  (3)
 July 2011  (6)
 June 2011  (4)
 May 2011  (4)
 April 2011  (5)
 March 2011  (5)
 January 2011  (2)
 December 2010  (6)
 November 2010  (5)
 October 2010  (3)
 September 2010  (4)
 August 2010  (5)
 July 2010  (6)
 June 2010  (2)
 December 2009  (1)
 November 2009  (1)
 October 2009  (3)
 0  (1)

Search for:

Search

* [ERNW](https://www.ernw.de)
* [ERNW Research](https://www.ernw-research.de)

[Back](https://insinuator.net/#post-12995)

[Misc](https://insinuator.net/category/misc/)
[November 13, 2020](https://insinuator.net/2020/11/forklift-lpe/) by [Birk Kauer](https://insinuator.net/author/bkauer/)
# Forklift <=3.3.9 and <=3.4 Local Privilege Escalations on macOS (CVE-2020-15349/CVE-2020-27192)

I have started to have a look at my local installed helpers on macOS. These helpers are used as an interface for applications to perform privileged operations on the system. Thus, it is quite a nice attack surface to search for Local Privilege Escalations.

Forklift is an advanced dual pane file manager for macOS. It is well known under macOS power users.

As part of my investigation I identified vulnerabilities in Forklift allowing local privilege escalation.

By now all vulnerabilities are fixed by the vendor I can release the details: <https://binarynights.com/versionhistory>

# **Forklift 3.3.9 Local Privilege Escalation CVE-2020-15349**

When installing the Forklift, a new helper called *com.binarynights.ForkLiftHelper* for Mac OS X is automatically installed to the */Library/PrivilegedHelperTools/* directory.

Analyzing this helper, which handles XPC messages, resulted in different ways of escalating privileges from user to *root* on Mac OS X.

When accepting XPC calls the `HelperTool listener:shouldAcceptNewConnection` respectively `(BOOL)listener:(NSXPCListener *)listener shouldAcceptNewConnection:(NSXPCConnection *)connection` function by default. This function is used to perform the initial steps for establishing an XPC connection. Usually, this function performs the authorization of the caller—however, the function of the *com.binarynights.ForkLiftHelper* does not implement any authorization checks. Thus, it is possible to call any exposed functions over XPC unauthorized.

The following functions are exposed over XPC to the caller:

`@protocol _TtP4main21ForkLiftHelperProtcol_

- (void)changePermissions:(NSString *)arg1 permissions:(long long)arg2 reply:(void (^)(NSError *))arg3;

- (void)changeOwner:(NSString *)arg1 owner:(long long)arg2 group:(long long)arg3 reply:(void (^)(NSError *))arg4;

- (void)calculateDirectorySize:(NSString *)arg1 reply:(void (^)(NSNumber *, NSError *))arg2;

- (void)createDirectory:(NSString *)arg1 reply:(void (^)(NSError *))arg2;

- (void)deleteItem:(NSString *)arg1 reply:(void (^)(NSError *))arg2;

- (void)moveItem:(NSString *)arg1 targetPath:(NSString *)arg2 reply:(void (^)(NSError *))arg3;

- (void)copyItemAbort:(NSString *)arg1;

- (void)copyItemProgress:(NSString *)arg1 reply:(void (^)(NSNumber *, NSError *))arg2;

- (void)copyItem:(NSString *)arg1 targetPath:(NSString *)arg2 UUID:(NSString *)arg3 reply:(void (^)(NSError *))arg4;

- (void)moveToTrash:(NSString *)arg1 reply:(void (^)(NSError *))arg2;

- (void)getHelperVersion:(void (^)(NSString *))arg1;

@end`

## Setuid Exploitation

The first method to exploit this helper is as follows:
### Step 1: Interpreter Target chown

Copy, for example, the python interpreter to a user-controllable directory and call the XPC function *changeOwner* with the parameter `@"<path>" owner:0 group:0`. This will change the ownership of the python interpreter to *root*.
### Step 2: Set SUID flag

Second, it is possible to set the SUID bit to the interpreter issuing an XPC request to the *changePermissions* function with the following parameter `@"<path>" permissions:2541`. The permissions *2541* represent in octal the number *4755*, which sets the SUID flag on the binary.
### Step 3: LPE

The following command will spawn a shell as root:

`$/tmp/python_copied -c 'import pty; import os; os.setuid(0);pty.spawn("/bin/bash")'`
# id
uid=0(root) […]

### Full Exploit

Please make sure to first have a python interpreter copied to */tmp* with the name *python\_copied*.
A working exploit can be found [here](https://github.com/Traxes/Forklift_LPE/blob/main/exploit.m).

## LaunchAgent Exploitation

The second method to exploit this helper is as follows:
### Writing a new Launch Agent

Due to the XPC call *moveItem* it is possible to move any item as *root*. Thus, it is possible to write a *plist* file to the */tmp* directory and then copy it to the */Library/LaunchDaemons/* directory. The following parameters are used for the *moveItem* function `@"/tmp/com.sample.Load.plist" targetPath:@"/Library/LaunchDaemons/com.sample.Load.plist"`

### Full Exploit

The exploit can be found [here](https://github.com/Traxes/Forklift_LPE/blob/main/exploit_move_item.m) and automatically adds a new launch agent which is triggered at a restart:

### Recommendation

It is recommended to enforce authorization when calling the XPC helper.
These authorization checks should contain:
– The caller is a valid signed application
– The caller application was well hardened against DYLIB injection attacks (runtime flag)
– The caller application has the correct TeamID from the Software Company
An excellent resource for the authorization checks can be found at <https://blog.obdev.at/what-we-have-learned-from-a-vulnerability/>.
The following example *shouldAcceptNewConnecton* functions displays the different stages of the correct authorization checks:

## Partial Fix

When reviewing the first fix for the issue by the vendor, it was noticed that they forgot to implement a check in the helper if the caller is compiled with the runtime flag (e.g., *0x1000).* Thus, it is possible to load an older version of Forklift, and Inject a library with the presented DYLD injection method and exploit the very same problem.

This problem was also noticed by Csaba Fitzl (Twitter: [@theevilbit](https://theevilbit.github.io/)). Huge shoutout to him as I learned a lot from his excellent resources!

# Entitlements LPE CVE-2020-27192

Now the current measures that are in place are checking whether the Forklift application itself is calling the helper.
It is possible to bypass this using a technique called *Dylib* injection. The operating system has a load order where the OS will try to load *dylib* libraries from different resources from the file system or sometimes even by environment variables.

Forklift is compiled with the following runtime flags:

`codesign -dvvvv /Applications/ForkLift.app/Contents/MacOS/ForkLift
Executable=/Applications/ForkLift.app/Contents/MacOS/ForkLift
Identifier=com.binarynights.ForkLift-3
Format=app bundle with Mach-O thin (x86_64)
CodeDirectory v=20500 size=27271 flags=0x10000(runtime) hashes=843+5 location=embedded`

The system will prevent such *dylib* loading from happening. However, there is a catch which disables these hardening features which is called the entitlement. Entitlements can bypass this loading prevention and unfortunately forklift uses the entitlement to disable library validation by default.

The following displays that:

`jtool2 --ent /Applications/ForkLift.app/Contents/MacOS/ForkLift
Note: 15214 symbols detected in this file! This will take a little while - generate a companion file or use '-q' for quick mode..
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" ["http://www.apple.com/DTDs/PropertyList-1.0.dtd"](http://www.apple.com/DTDs/PropertyList-1.0.dtd)>
<plist version="1.0">
<dict>
    <key>com.apple.security.application-groups</key>
    <array>
        <string>J3CP9BBBN6.com.binarynights.ForkLift</string>
    </array>
    <key>com.apple.security.automation.apple-events</key>
    <true/>
    <key>com.apple.security.cs.disable-library-validation</key> <------
    <true/>
    <key>com.apple.security.personal-information.photos-library</key>
    <true/>
</dict>
</plist>`

This is the same for the helper:

`jtool2 --ent /Library/PrivilegedHelperTools/com.binarynights.ForkLiftHelper
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" ["http://www.apple.com/DTDs/PropertyList-1.0.dtd"](http://www.apple.com/DTDs/PropertyList-1.0.dtd)>
<plist version="1.0">
<dict>
    <key>com.apple.security.automation.apple-events</key>
    <true/>
    <key>com.apple.security.cs.disable-library-validation</key>    <-------
    <true/>
    <key>com.apple.security.personal-information.photos-library</key>
    <true/>
</dict>
</plist>`

Thus, it is possible to inject a library at load time of forklift which connects to the XPC helper service and exploits the same vulnerability as previously.
This attack is described in detail at the following blogposts:

– <https://objective-see.com/blog/blog_0x56.html>
– <https://theevilbit.github.io/posts/dyld_insert_libraries_dylib_injection_in_macos_osx_deep_dive/>
– <https://secret.club/2020/08/14/macos-entitlements.html>
### Recommendation

It is recommended to not have the entitlement *com.apple.security.cs.disable-library-validation* in your application. Further, it is recommended to check whether the entitlements are securely set.
# Disclosure Timeline

– 08.06.2020 Initial Contact for Mail Address
– 08.06.2020 Response to send the same mail unencrypted
– 09.06.2020 Follow Up question for encryption
– 10.06.2020 Clearance of Encrypted Disclosure
– 12.06.2020 Disclosure of the LPE
– 15.06.2020 Partial Fix for CVE-2020-15349 (LPE)
– 16.06.2020 Disclosure of Entitlements LPE
– 19.06.2020 Disclosure of only partial fix of CVE-2020-15349
– 19.08.2020 Fix of CVE-2020-27192 and Final Fix for CVE-2020-15349

# Final Words

I have to add that the communication with the vendor was very responsive, and even when they had a hard time implementing all recommended controls, they were all the time very professional! Thus, I will for sure further use this excellent file viewer.

Cheers,

Birk

[Back](https://insinuator.net/#post-12995)

[LPE](https://insinuator.net/tag/lpe/)[Mac OS X](https://insinuator.net/tag/mac-os-x/)[Privilege Escalation](https://insinuator.net/tag/privilege-escalation/)[vulnerability](https://insinuator.net/tag/vulnerability/)

## Post navigation

[Reversing C++ Without Getting a Heart Attack – DEvirtualize VIrtual Calls With Devi](https://insinuator.net/2020/11/reversing-c-without-getting-a-heart-attack-devirtualize-virtual-calls-with-devi/)[Microsoft Office Telemetry: Report Release](https://insinuator.net/2020/11/microsoft-office-telemetry-report-release/)

[Imprint](/about) | [Privacy Policy](/privacy) | ©2025 ERNW Enno Rey Netzwerke GmbH



=== Content from insinuator.net_9ea79d18_20250119_134457.html ===


[Insinuator.net](https://insinuator.net/)

Bold Statements

Primary Menu

* [About](https://insinuator.net/about/)

* [RSS Feed](https://insinuator.net/?feed=rss)
* [Follow us](http://twitter.com/insinuator)

## Categories

* [Breaking](https://insinuator.net/category/breaking/)
* [Building](https://insinuator.net/category/building/)
* [Events](https://insinuator.net/category/events/)
* [Misc](https://insinuator.net/category/misc/)
## Tags

[4G](https://insinuator.net/tag/4g/)
[Active Directory](https://insinuator.net/tag/active-directory/)
[advisory](https://insinuator.net/tag/advisory/)
[Android](https://insinuator.net/tag/android/)
[Black Hat](https://insinuator.net/tag/black-hat/)
[blackhoodie](https://insinuator.net/tag/blackhoodie/)
[Bluetooth](https://insinuator.net/tag/bluetooth/)
[C3](https://insinuator.net/tag/c3/)
[Cisco](https://insinuator.net/tag/cisco/)
[cloud](https://insinuator.net/tag/cloud/)
[Day-Con](https://insinuator.net/tag/day-con/)
[disclosure](https://insinuator.net/tag/disclosure/)
[Docker](https://insinuator.net/tag/docker/)
[ERNW white paper](https://insinuator.net/tag/ernw-white-paper/)
[exploit](https://insinuator.net/tag/exploit/)
[forensics](https://insinuator.net/tag/forensics/)
[fuzzing](https://insinuator.net/tag/fuzzing/)
[GSM](https://insinuator.net/tag/gsm/)
[hardening](https://insinuator.net/tag/hardening/)
[hardware](https://insinuator.net/tag/hardware/)
[HITB](https://insinuator.net/tag/hitb/)
[iOS](https://insinuator.net/tag/ios/)
[IoT](https://insinuator.net/tag/iot/)
[IPv6](https://insinuator.net/tag/ipv6/)
[Linux](https://insinuator.net/tag/linux/)
[malware](https://insinuator.net/tag/malware/)
[medical](https://insinuator.net/tag/medical/)
[network](https://insinuator.net/tag/network/)
[pentest](https://insinuator.net/tag/pentest/)
[reversing](https://insinuator.net/tag/reversing/)
[RIPE](https://insinuator.net/tag/ripe/)
[risk](https://insinuator.net/tag/risk/)
[SAP](https://insinuator.net/tag/sap/)
[SDR](https://insinuator.net/tag/sdr/)
[Telco](https://insinuator.net/tag/telco/)
[TelcoSecDay](https://insinuator.net/tag/telcosecday/)
[tool](https://insinuator.net/tag/tool/)
[TROOPERS](https://insinuator.net/tag/troopers/)
[trust](https://insinuator.net/tag/trust/)
[virtualization](https://insinuator.net/tag/virtualization/)
[VMware](https://insinuator.net/tag/vmware/)
[VoIP](https://insinuator.net/tag/voip/)
[vulnerability](https://insinuator.net/tag/vulnerability/)
[web application](https://insinuator.net/tag/web-application/)
[Windows](https://insinuator.net/tag/windows/)
## Archives

Archives
Select Month
 November 2024  (2)
 September 2024  (2)
 August 2024  (2)
 June 2024  (2)
 May 2024  (4)
 April 2024  (4)
 February 2024  (1)
 October 2023  (3)
 September 2023  (2)
 August 2023  (1)
 July 2023  (1)
 June 2023  (2)
 May 2023  (3)
 December 2022  (1)
 September 2022  (2)
 August 2022  (1)
 June 2022  (1)
 April 2022  (1)
 March 2022  (1)
 December 2021  (1)
 October 2021  (1)
 July 2021  (1)
 May 2021  (4)
 April 2021  (2)
 March 2021  (1)
 February 2021  (3)
 January 2021  (5)
 December 2020  (4)
 November 2020  (6)
 October 2020  (2)
 September 2020  (5)
 July 2020  (3)
 June 2020  (1)
 May 2020  (1)
 April 2020  (2)
 March 2020  (3)
 February 2020  (3)
 January 2020  (2)
 December 2019  (2)
 November 2019  (6)
 October 2019  (4)
 September 2019  (3)
 August 2019  (3)
 July 2019  (6)
 June 2019  (6)
 May 2019  (7)
 April 2019  (7)
 March 2019  (2)
 February 2019  (4)
 January 2019  (14)
 December 2018  (4)
 November 2018  (11)
 October 2018  (6)
 September 2018  (1)
 August 2018  (4)
 July 2018  (3)
 June 2018  (3)
 May 2018  (3)
 April 2018  (5)
 March 2018  (8)
 February 2018  (12)
 January 2018  (2)
 December 2017  (2)
 November 2017  (3)
 October 2017  (7)
 September 2017  (5)
 August 2017  (3)
 July 2017  (3)
 June 2017  (6)
 May 2017  (5)
 April 2017  (3)
 March 2017  (8)
 February 2017  (6)
 January 2017  (8)
 December 2016  (12)
 November 2016  (14)
 October 2016  (12)
 September 2016  (12)
 August 2016  (9)
 July 2016  (9)
 June 2016  (7)
 May 2016  (10)
 April 2016  (23)
 March 2016  (29)
 February 2016  (14)
 January 2016  (12)
 December 2015  (15)
 November 2015  (6)
 October 2015  (9)
 September 2015  (7)
 August 2015  (5)
 July 2015  (6)
 June 2015  (14)
 May 2015  (9)
 April 2015  (9)
 March 2015  (13)
 February 2015  (10)
 January 2015  (18)
 December 2014  (10)
 November 2014  (10)
 October 2014  (7)
 September 2014  (3)
 August 2014  (9)
 July 2014  (5)
 June 2014  (1)
 May 2014  (9)
 April 2014  (1)
 March 2014  (3)
 February 2014  (5)
 January 2014  (13)
 December 2013  (5)
 November 2013  (5)
 October 2013  (4)
 September 2013  (1)
 August 2013  (10)
 July 2013  (10)
 June 2013  (5)
 May 2013  (4)
 April 2013  (10)
 March 2013  (4)
 February 2013  (12)
 January 2013  (6)
 December 2012  (2)
 November 2012  (4)
 October 2012  (1)
 September 2012  (3)
 July 2012  (3)
 June 2012  (3)
 May 2012  (8)
 April 2012  (2)
 March 2012  (5)
 February 2012  (6)
 January 2012  (4)
 December 2011  (7)
 November 2011  (7)
 October 2011  (6)
 September 2011  (3)
 August 2011  (3)
 July 2011  (6)
 June 2011  (4)
 May 2011  (4)
 April 2011  (5)
 March 2011  (5)
 January 2011  (2)
 December 2010  (6)
 November 2010  (5)
 October 2010  (3)
 September 2010  (4)
 August 2010  (5)
 July 2010  (6)
 June 2010  (2)
 December 2009  (1)
 November 2009  (1)
 October 2009  (3)
 0  (1)

Search for:

Search

* [ERNW](https://www.ernw.de)
* [ERNW Research](https://www.ernw-research.de)

# Author: Birk Kauer

[Misc](https://insinuator.net/category/misc/)
[November 13, 2020](https://insinuator.net/2020/11/forklift-lpe/) by [Birk Kauer](https://insinuator.net/author/bkauer/)
## [Forklift <=3.3.9 and <=3.4 Local Privilege Escalations on macOS (CVE-2020-15349/CVE-2020-27192)](https://insinuator.net/2020/11/forklift-lpe/)

I have started to have a look at my local installed helpers on macOS. These helpers are used as an interface for applications to perform privileged operations on the system. Thus, it is quite a nice attack surface to search for Local Privilege Escalations.

Forklift is an advanced dual pane file manager for macOS. It is well known under macOS power users.

As part of my investigation I identified vulnerabilities in Forklift allowing local privilege escalation.

By now all vulnerabilities are fixed by the vendor I can release the details: <https://binarynights.com/versionhistory>

[Continue reading “Forklift <=3.3.9 and <=3.4 Local Privilege Escalations on macOS (CVE-2020-15349/CVE-2020-27192)”](https://insinuator.net/2020/11/forklift-lpe/#more-12995)

[Continue reading](https://insinuator.net/2020/11/forklift-lpe/)

[LPE](https://insinuator.net/tag/lpe/)[Mac OS X](https://insinuator.net/tag/mac-os-x/)[Privilege Escalation](https://insinuator.net/tag/privilege-escalation/)[vulnerability](https://insinuator.net/tag/vulnerability/)

[Misc](https://insinuator.net/category/misc/)
[January 10, 2019](https://insinuator.net/2019/01/macos-mojave-hardening-guide/) by [Birk Kauer](https://insinuator.net/author/bkauer/)
## [macOS Mojave Hardening Guide](https://insinuator.net/2019/01/macos-mojave-hardening-guide/)

Due to the new release of macOS Mojave in September we updated the El Capitan hardening guide.

[Continue reading “macOS Mojave Hardening Guide”](https://insinuator.net/2019/01/macos-mojave-hardening-guide/#more-11257)

[Continue reading](https://insinuator.net/2019/01/macos-mojave-hardening-guide/)

[hardening](https://insinuator.net/tag/hardening/)[Mac OS X](https://insinuator.net/tag/mac-os-x/)[macOS](https://insinuator.net/tag/macos/)

[Breaking](https://insinuator.net/category/breaking/)
[October 3, 2018](https://insinuator.net/2018/10/spraying-arbitrary-objects-into-the-non-paged-pool/) by [Birk Kauer](https://insinuator.net/author/bkauer/)
## [Spraying arbitrary objects into the non-paged pool](https://insinuator.net/2018/10/spraying-arbitrary-objects-into-the-non-paged-pool/)

Recently, I had some time to play around with HEVD [[1](https://github.com/hacksysteam/HackSysExtremeVulnerableDriver)], an extremly vulnerable Windows driver available for 32-bit and 64-bit systems.

Since exploits for all vulnerabilities of the 32-bit variant are publically available, I was wondering why this is not the case for the 64-bit version, especially for the pool corruption and UAF vulnerabilities.

[Continue reading “Spraying arbitrary objects into the non-paged pool”](https://insinuator.net/2018/10/spraying-arbitrary-objects-into-the-non-paged-pool/#more-10761)

[Continue reading](https://insinuator.net/2018/10/spraying-arbitrary-objects-into-the-non-paged-pool/)

[Misc](https://insinuator.net/category/misc/)
[February 24, 2017](https://insinuator.net/2017/02/cloudflare-incident-cloudbleed/) by [Birk Kauer](https://insinuator.net/author/bkauer/)
## [Cloudflare Incident #Cloudbleed](https://insinuator.net/2017/02/cloudflare-incident-cloudbleed/)

Exactly one week ago I noticed an “urgent” tweet from Tavis Ormandy to get in contact with the Cloudflare team.

Normally when a tweet like this appears from Tavis, something is horribly broken. Well, today we know the background of this tweet as the [bug tracker](https://bugs.chromium.org/p/project-zero/issues/detail?id=1139) issue went public and it exposed quite a bug from Cloudflare. [Continue reading “Cloudflare Incident #Cloudbleed”](https://insinuator.net/2017/02/cloudflare-incident-cloudbleed/#more-9053)

[Continue reading](https://insinuator.net/2017/02/cloudflare-incident-cloudbleed/)

[Cloudbleed](https://insinuator.net/tag/cloudbleed/)[Cloudflare](https://insinuator.net/tag/cloudflare/)[incident](https://insinuator.net/tag/incident/)

[Breaking](https://insinuator.net/category/breaking/)
[January 24, 2017](https://insinuator.net/2017/01/insomnihack-pwn50-write-up/) by [Birk Kauer](https://insinuator.net/author/bkauer/)
## [Insomni’hack pwn50 write-up](https://insinuator.net/2017/01/insomnihack-pwn50-write-up/)

Hi all,

i´ve looked a bit at the [Insomni’hack CTF](https://insomnihack.ch/?page_id=16) which took place on the 21st January and lasted for 36 hours.

For the sake of warming up a bit for our Troopers workshop [Windows and Linux Exploitation](https://www.troopers.de/events/troopers17/728_windows_and_linux_exploitation/),

I decided to create a write-up of the first pwn50 challenge.

To grab your own copy of the presented files you can also find it in our [Github](https://github.com/ernw/insinuator-snippets/tree/master/Insomnihack) repository:

[Continue reading “Insomni’hack pwn50 write-up”](https://insinuator.net/2017/01/insomnihack-pwn50-write-up/#more-8868)

[Continue reading](https://insinuator.net/2017/01/insomnihack-pwn50-write-up/)

[Insomni’hack](https://insinuator.net/tag/insomnihack/)

[Events](https://insinuator.net/category/events/)
[October 27, 2016](https://insinuator.net/2016/10/day-con-recap/) by [Birk Kauer](https://insinuator.net/author/bkauer/)
## [Day-Con X Recap](https://insinuator.net/2016/10/day-con-recap/)

Just a few days ago I had the pleasure of visiting [Day-Con X](http://day-con.org/). I listened to some great talks in the closed and public sessions. Since the first day was the security summit (closed session) I will just name a few titles with some brief words.

[Continue reading “Day-Con X Recap”](https://insinuator.net/2016/10/day-con-recap/#more-8340)

[Continue reading](https://insinuator.net/2016/10/day-con-recap/)

[Day-Con](https://insinuator.net/tag/day-con/)

[Events](https://insinuator.net/category/events/)
[August 9, 2016](https://insinuator.net/2016/08/black-hat-2016-summary/) by [Birk Kauer](https://insinuator.net/author/bkauer/)
## [Black Hat 2016 Summary](https://insinuator.net/2016/08/black-hat-2016-summary/)

Just a few days ago I had a blast again at this year’s Black Hat. Some of the talks were really worth listening to, so I wanted to point them out and give a short summary.

[USING UNDOCUMENTED CPU BEHAVIOR TO SEE INTO KERNEL MODE AND BREAK KASLR IN THE PROCESS](https://www.blackhat.com/us-16/briefings.html#using-undocumented-cpu-behavior-to-see-into-kernel-mode-and-break-kaslr-in-the-process) – Anders Fogh & Daniel Gruss

They had the last slot at the last day of Black Hat which resulted in a kind of empty room, but in my opinion it was an awesome talk and I even had the pleasure to meet these two guys at our ERNW dinner.

The talk was about a very weirdly documented Intel instruction which does not check for privileges or throw exceptions:

[Continue reading “Black Hat 2016 Summary”](https://insinuator.net/2016/08/black-hat-2016-summary/#more-7657)

[Continue reading](https://insinuator.net/2016/08/black-hat-2016-summary/)

[Black Hat](https://insinuator.net/tag/black-hat/)

[Events](https://insinuator.net/category/events/)
[March 31, 2016](https://insinuator.net/2016/03/keynote-1-troopers-2016/) by [Birk Kauer](https://insinuator.net/author/bkauer/)
## [Keynote #1 Troopers 2016](https://insinuator.net/2016/03/keynote-1-troopers-2016/)

The first Keynote directly after the Opening by Enno Rey was held by Ben Zevenbergen. At the beginning he pointed out that he is not a very technical guy rather he specialized in Information Law and a policy advisor to the European Parliament. Before he started to dive into his Keynote he talked about some rant story’s which happened to him while trying to make his point clear on previous conferences and that he came in peace to Troopers ;).

[Continue reading “Keynote #1 Troopers 2016”](https://insinuator.net/2016/03/keynote-1-troopers-2016/#more-6405)

[Continue reading](https://insinuator.net/2016/03/keynote-1-troopers-2016/)

[TROOPERS](https://insinuator.net/tag/troopers/)

[Events](https://insinuator.net/category/events/)
[March 28, 2016](https://insinuator.net/2016/03/attacking-next-generation-firewalls/) by [Birk Kauer](https://insinuator.net/author/bkauer/)
## [Attacking Next-Generation Firewalls](https://insinuator.net/2016/03/attacking-next-generation-firewalls/)

Felix Wilhelm presented in his talk various ways to attack his new target – The PA-500 which is produced by Palo Alto Networks.

He discovered vulnerabilities in 3 different exposed aspects of the device. The first vulnerability occurred inside of an unauthenticated API from the Management-Website which could only be accessed within the Admin Network. This vulnerability was a typical off-by-one Command Injection, which could be abused by reaching out to the API with a special client=wget Request.

[Continue reading “Attacking Next-Generation Firewalls”](https://insinuator.net/2016/03/attacking-next-generation-firewalls/#more-6361)

[Continue reading](https://insinuator.net/2016/03/attacking-next-generation-firewalls/)

[NGFW](https://insinuator.net/tag/ngfw/)[TROOPERS](https://insinuator.net/tag/troopers/)

[Breaking](https://insinuator.net/category/breaking/)
[January 28, 2016](https://insinuator.net/2016/01/die/) by [Birk Kauer](https://insinuator.net/author/bkauer/)
## [Dynamic IDA Enrichment (aka. DIE)](https://insinuator.net/2016/01/die/)

Last year on the [Hex-rays plugin Contest](https://hex-rays.com/contests/2015/index.shtml) the Dynamic IDA Enrichment (DIE) plugin won first place, so we decided to have a look and play around with it.

DIE extends IDA to add Dynamic Data to the static analysis. So after the installation, we are able to perform the static analysis using a lot of supporting information from the actual execution of the binary under assessment.

Since DIE is purely written in Python you will need at least Python 2.7 and IDA Versions prior to 6.8 won´t work. In the current version DIE will only work on Windows which will hopefully soon be available cross-platform.

To setup the environment for DIE just use pip install –r requirements.txt (requirements.txt are shipped with DIE).

Copy die\_proxy.py to the IDA Plugin directory and add an environment Variable named DIEDIR including the path to the DIE directory. [Continue reading “Dynamic IDA Enrichment (aka. DIE)”](https://insinuator.net/2016/01/die/#more-5778)

[Continue reading](https://insinuator.net/2016/01/die/)

[IDA](https://insinuator.net/tag/ida/)[reversing](https://insinuator.net/tag/reversing/)

* [RSS Feed](https://insinuator.net/?feed=rss)
* [Follow us](http://twitter.com/insinuator)

## Categories

* [Breaking](https://insinuator.net/category/breaking/)
* [Building](https://insinuator.net/category/building/)
* [Events](https://insinuator.net/category/events/)
* [Misc](https://insinuator.net/category/misc/)
## Tags

[4G](https://insinuator.net/tag/4g/)
[Active Directory](https://insinuator.net/tag/active-directory/)
[advisory](https://insinuator.net/tag/advisory/)
[Android](https://insinuator.net/tag/android/)
[Black Hat](https://insinuator.net/tag/black-hat/)
[blackhoodie](https://insinuator.net/tag/blackhoodie/)
[Bluetooth](https://insinuator.net/tag/bluetooth/)
[C3](https://insinuator.net/tag/c3/)
[Cisco](https://insinuator.net/tag/cisco/)
[cloud](https://insinuator.net/tag/cloud/)
[Day-Con](https://insinuator.net/tag/day-con/)
[disclosure](https://insinuator.net/tag/disclosure/)
[Docker](https://insinuator.net/tag/docker/)
[ERNW white paper](https://insinuator.net/tag/ernw-white-paper/)
[exploit](https://insinuator.net/tag/exploit/)
[forensics](https://insinuator.net/tag/forensics/)
[fuzzing](https://insinuator.net/tag/fuzzing/)
[GSM](https://insinuator.net/tag/gsm/)
[hardening](https://insinuator.net/tag/hardening/)
[hardware](https://insinuator.net/tag/hardware/)
[HITB](https://insinuator.net/tag/hitb/)
[iOS](https://insinuator.net/tag/ios/)
[IoT](https://insinuator.net/tag/iot/)
[IPv6](https://insinuator.net/tag/ipv6/)
[Linux](https://insinuator.net/tag/linux/)
[malware](https://insinuator.net/tag/malware/)
[medical](https://insinuator.net/tag/medical/)
[network](https://insinuator.net/tag/network/)
[pentest](https://insinuator.net/tag/pentest/)
[reversing](https://insinuator.net/tag/reversing/)
[RIPE](https://insinuator.net/tag/ripe/)
[risk](https://insinuator.net/tag/risk/)
[SAP](https://insinuator.net/tag/sap/)
[SDR](https://insinuator.net/tag/sdr/)
[Telco](https://insinuator.net/tag/telco/)
[TelcoSecDay](https://insinuator.net/tag/telcosecday/)
[tool](https://insinuator.net/tag/tool/)
[TROOPERS](https://insinuator.net/tag/troopers/)
[trust](https://insinuator.net/tag/trust/)
[virtualization](https://insinuator.net/tag/virtualization/)
[VMware](https://insinuator.net/tag/vmware/)
[VoIP](https://insinuator.net/tag/voip/)
[vulnerability](https://insinuator.net/tag/vulnerability/)
[web application](https://insinuator.net/tag/web-application/)
[Windows](https://insinuator.net/tag/windows/)
## Archives

Archives
Select Month
 November 2024  (2)
 September 2024  (2)
 August 2024  (2)
 June 2024  (2)
 May 2024  (4)
 April 2024  (4)
 February 2024  (1)
 October 2023  (3)
 September 2023  (2)
 August 2023  (1)
 July 2023  (1)
 June 2023  (2)
 May 2023  (3)
 December 2022  (1)
 September 2022  (2)
 August 2022  (1)
 June 2022  (1)
 April 2022  (1)
 March 2022  (1)
 December 2021  (1)
 October 2021  (1)
 July 2021  (1)
 May 2021  (4)
 April 2021  (2)
 March 2021  (1)
 February 2021  (3)
 January 2021  (5)
 December 2020  (4)
 November 2020  (6)
 October 2020  (2)
 September 2020  (5)
 July 2020  (3)
 June 2020  (1)
 May 2020  (1)
 April 2020  (2)
 March 2020  (3)
 February 2020  (3)
 January 2020  (2)
 December 2019  (2)
 November 2019  (6)
 October 2019  (4)
 September 2019  (3)
 August 2019  (3)
 July 2019  (6)
 June 2019  (6)
 May 2019  (7)
 April 2019  (7)
 March 2019  (2)
 February 2019  (4)
 January 2019  (14)
 December 2018  (4)
 November 2018  (11)
 October 2018  (6)
 September 2018  (1)
 August 2018  (4)
 July 2018  (3)
 June 2018  (3)
 May 2018  (3)
 April 2018  (5)
 March 2018  (8)
 February 2018  (12)
 January 2018  (2)
 December 2017  (2)
 November 2017  (3)
 October 2017  (7)
 September 2017  (5)
 August 2017  (3)
 July 2017  (3)
 June 2017  (6)
 May 2017  (5)
 April 2017  (3)
 March 2017  (8)
 February 2017  (6)
 January 2017  (8)
 December 2016  (12)
 November 2016  (14)
 October 2016  (12)
 September 2016  (12)
 August 2016  (9)
 July 2016  (9)
 June 2016  (7)
 May 2016  (10)
 April 2016  (23)
 March 2016  (29)
 February 2016  (14)
 January 2016  (12)
 December 2015  (15)
 November 2015  (6)
 October 2015  (9)
 September 2015  (7)
 August 2015  (5)
 July 2015  (6)
 June 2015  (14)
 May 2015  (9)
 April 2015  (9)
 March 2015  (13)
 February 2015  (10)
 January 2015  (18)
 December 2014  (10)
 November 2014  (10)
 October 2014  (7)
 September 2014  (3)
 August 2014  (9)
 July 2014  (5)
 June 2014  (1)
 May 2014  (9)
 April 2014  (1)
 March 2014  (3)
 February 2014  (5)
 January 2014  (13)
 December 2013  (5)
 November 2013  (5)
 October 2013  (4)
 September 2013  (1)
 August 2013  (10)
 July 2013  (10)
 June 2013  (5)
 May 2013  (4)
 April 2013  (10)
 March 2013  (4)
 February 2013  (12)
 January 2013  (6)
 December 2012  (2)
 November 2012  (4)
 October 2012  (1)
 September 2012  (3)
 July 2012  (3)
 June 2012  (3)
 May 2012  (8)
 April 2012  (2)
 March 2012  (5)
 February 2012  (6)
 January 2012  (4)
 December 2011  (7)
 November 2011  (7)
 October 2011  (6)
 September 2011  (3)
 August 2011  (3)
 July 2011  (6)
 June 2011  (4)
 May 2011  (4)
 April 2011  (5)
 March 2011  (5)
 January 2011  (2)
 December 2010  (6)
 November 2010  (5)
 October 2010  (3)
 September 2010  (4)
 August 2010  (5)
 July 2010  (6)
 June 2010  (2)
 December 2009  (1)
 November 2009  (1)
 October 2009  (3)
 0  (1)

[Imprint](/about) | [Privacy Policy](/privacy) | ©2025 ERNW Enno Rey Netzwerke GmbH



=== Content from theevilbit.github.io_f6334156_20250119_134456.html ===


[theevilbit blog](https://theevilbit.github.io/)

* [Posts](https://theevilbit.github.io/posts/)
* [Talks and Workshops](https://theevilbit.github.io/talks/)
* [Shield.app](https://theevilbit.github.io/shield/)
* [Beyond good ol' LaunchAgents](https://theevilbit.github.io/beyond/)
* [Tags](https://theevilbit.github.io/tags/)
* [About](https://theevilbit.github.io/about/)

# Csaba Fitzl

##

©
2024
Csaba Fitzl
·
Powered by [Hugo](https://gohugo.io/) & [Coder](https://github.com/luizdepra/hugo-coder/).


