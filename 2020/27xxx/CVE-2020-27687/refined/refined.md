Based on the provided content, here's the breakdown of CVE-2020-27687:

**Root cause of vulnerability:**
- The application uses the `Host` header from the HTTP request to generate password reset links. It does not validate or sanitize this header before using it in the link generation process.

**Weaknesses/vulnerabilities present:**
- Host header injection vulnerability.

**Impact of exploitation:**
- An attacker can inject a malicious host in the `Host` header. This will cause the application to generate password reset links that point to an attacker-controlled domain.
- The attacker can then use these maliciously crafted password reset links in emails sent to the victims.
- If a victim clicks the link, they are redirected to the attackerâ€™s site.
- This can be used to trick victims into submitting their password reset tokens and new passwords to a malicious website.

**Attack vectors:**
- By sending a specially crafted HTTP request to the `/api/noauth/resetPasswordByEmail` endpoint with a manipulated `Host` header.

**Required attacker capabilities/position:**
- The attacker needs to be able to send HTTP requests to the vulnerable server. This can typically be done remotely.

**Additional Information:**
- The vulnerability was patched in version 3.2 of Thingsboard, which introduces an option to disable this behavior.
- The patch introduces a new setting called `prohibitDifferentUrl`. When this is enabled, the application will not use the hostname from the client request headers.
- By default, the setting is disabled and an installation will be vulnerable even on the latest version if the option is not enabled.