The provided content relates to CVE-2020-27795.

**Root cause of vulnerability:**
The vulnerability is caused by a null pointer dereference in the `anal_fcn_data` function of radare2, which occurs when the `adf` command is used without prior analysis.

**Weaknesses/vulnerabilities present:**
- Null pointer dereference
- Missing check for null function pointer.

**Impact of exploitation:**
- Segmentation fault (crash)

**Attack vectors:**
- Executing the `adf` command in radare2 without prior analysis

**Required attacker capabilities/position:**
- The attacker needs the ability to execute commands in radare2.
- No special privileges needed.

**More details:**
- The issue occurs in `libr/core/anal.c` within the `anal_fcn_data` function. When `adf` is used without prior analysis, the `r_anal_get_fcn_in` function returns a null pointer, which leads to a segmentation fault later in the `ensure_fcn_range` function.
- The fix involves a change in `libr/core/cmd_anal.c`. The line `RAnalFunction *fcn = r_anal_get_fcn_in (core->anal, core->offset, -1);` is changed to `RAnalFunction *fcn = r_anal_get_fcn_in (core->anal, core->offset, R_ANAL_FCN_TYPE_ANY);` and a check for null is made to prevent the segfault.
- A test case was added to verify that `adf` command no longer crashes when used without analysis.