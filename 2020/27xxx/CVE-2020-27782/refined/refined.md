The content relates to CVE-2020-27782.

**Root cause of vulnerability:**
The Undertow AJP connector improperly handles certain characters in query strings. Specifically, non-RFC compliant characters in the query string are not properly validated by the AJP connector before being processed by the backend server.

**Weaknesses/vulnerabilities:**
- Improper handling of special characters in the query string.
- Lack of input validation on query string parameters before being passed to the backend server.
- AJP connector does not adhere to RFC 7230 and RFC 3986 regarding allowed characters in URLs/query strings.

**Impact of exploitation:**
An attacker can send a malicious request with non-RFC compliant characters in the query string, which can lead to server errors, an abrupt connection close, and ultimately a denial of service (DoS). In some cases, servers using Undertow may mark the node as broken, causing further disruption.

**Attack vectors:**
The attack vector involves sending malicious requests via AJP with specially crafted query strings containing non-RFC compliant characters.

**Required attacker capabilities/position:**
An attacker needs to be able to send HTTP requests to a server that is using an AJP connector with an affected version of Undertow. The attacker does not need specific credentials and can perform the attack remotely.

**Additional Details:**

- The vulnerability exists in the AJP connector of Undertow, which impacts both mod_jk and mod_proxy_ajp setups.
- The issue was discovered by Richard Opalka.
- The fix is to ensure that the AJP implementation rejects non-RFC compliant characters.
- Mitigation involves switching from AJP to HTTP/1.1 for proxying to the backend.
- Several Red Hat products were affected and received patches, including JBoss EAP, Red Hat Single Sign-On, Red Hat Openshift Application Runtimes, Red Hat Integration, Red Hat support for Spring Boot and Red Hat Fuse.