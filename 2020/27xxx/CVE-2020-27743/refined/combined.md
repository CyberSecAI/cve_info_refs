=== Content from github.com_70a51c1c_20250119_120025.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkravietz%2Fpam_tacplus%2Fpull%2F163)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkravietz%2Fpam_tacplus%2Fpull%2F163)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=kravietz%2Fpam_tacplus)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Feb 28, 2024. It is now read-only.

[kravietz](/kravietz)
/
**[pam\_tacplus](/kravietz/pam_tacplus)**
Public archive

* [Notifications](/login?return_to=%2Fkravietz%2Fpam_tacplus) You must be signed in to change notification settings
* [Fork
  101](/login?return_to=%2Fkravietz%2Fpam_tacplus)
* [Star
   132](/login?return_to=%2Fkravietz%2Fpam_tacplus)

* [Code](/kravietz/pam_tacplus)
* [Issues
  37](/kravietz/pam_tacplus/issues)
* [Pull requests
  8](/kravietz/pam_tacplus/pulls)
* [Actions](/kravietz/pam_tacplus/actions)
* [Projects
  0](/kravietz/pam_tacplus/projects)
* [Wiki](/kravietz/pam_tacplus/wiki)
* [Security](/kravietz/pam_tacplus/security)
* [Insights](/kravietz/pam_tacplus/pulse)

Additional navigation options

* [Code](/kravietz/pam_tacplus)
* [Issues](/kravietz/pam_tacplus/issues)
* [Pull requests](/kravietz/pam_tacplus/pulls)
* [Actions](/kravietz/pam_tacplus/actions)
* [Projects](/kravietz/pam_tacplus/projects)
* [Wiki](/kravietz/pam_tacplus/wiki)
* [Security](/kravietz/pam_tacplus/security)
* [Insights](/kravietz/pam_tacplus/pulse)

# Check for failure of OpenSSL RAND\_[pseudo\_]bytes #163

 Merged

[kravietz](/kravietz)
merged 2 commits into
[kravietz:master](/kravietz/pam_tacplus/tree/master "kravietz/pam_tacplus:master")
from
[deastoe:rand-check](/deastoe/pam_tacplus/tree/rand-check "deastoe/pam_tacplus:rand-check")

Oct 26, 2020

 Merged

# [Check for failure of OpenSSL RAND\_[pseudo\_]bytes](#top) #163

[kravietz](/kravietz)
merged 2 commits into
[kravietz:master](/kravietz/pam_tacplus/tree/master "kravietz/pam_tacplus:master")
from
[deastoe:rand-check](/deastoe/pam_tacplus/tree/rand-check "deastoe/pam_tacplus:rand-check")

Oct 26, 2020

[Conversation
11](/kravietz/pam_tacplus/pull/163)
[Commits
2](/kravietz/pam_tacplus/pull/163/commits)
[Checks
0](/kravietz/pam_tacplus/pull/163/checks)
[Files changed](/kravietz/pam_tacplus/pull/163/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![deastoe](https://avatars.githubusercontent.com/u/31696783?s=60&v=4)](/deastoe)

Copy link

Contributor

### @deastoe **[deastoe](/deastoe)** commented [Oct 23, 2020](#issue-728125055)

Discovered by [@gollub](https://github.com/gollub).

magic.c: check for failure of RAND\_[pseudo\_]bytes

When magic() is implemented via libcrypto's RAND\_bytes or

RAND\_pseudo\_bytes we should check for a failure and abort to

ensure we don't use a predictable session\_id.

This prevents (further) weakening\* of the TACACS+ protocol

"encryption" since session\_id is an input to the algorithm.

\*by modern standards TACACS+ is deemed "obfuscated" - RFC 8907.

pam\_tacplus.c: Fallback to using PID as task ID

If there is a failure obtaining a random task ID for the session

accounting request then fallback to using the PID, as this is unique

for the lifetime of the PAM application and therefore session.

Sorry, something went wrong.

All reactions

 [deastoe](/deastoe)
added 2 commits
[October 23, 2020 11:56](#commits-pushed-c9bed74)

[![@deastoe](https://avatars.githubusercontent.com/u/31696783?s=40&v=4)](/deastoe)

`[magic.c: check for failure of RAND_[pseudo_]bytes](/kravietz/pam_tacplus/pull/163/commits/c9bed7496e81e550ee22746f23bbb11be2e046ed "magic.c: check for failure of RAND_[pseudo_]bytes

When magic() is implemented via libcrypto's RAND_bytes or
RAND_pseudo_bytes we should check for a failure and abort to
ensure we don't use a predictable session_id.

This prevents (further) weakening* of the TACACS+ protocol
\"encryption\" since session_id is an input to the algorithm.

*by modern standards TACACS+ is deemed \"obfuscated\" - RFC 8907.")`
 ‚Ä¶

`[c9bed74](/kravietz/pam_tacplus/pull/163/commits/c9bed7496e81e550ee22746f23bbb11be2e046ed)`

```
When magic() is implemented via libcrypto's RAND_bytes or
RAND_pseudo_bytes we should check for a failure and abort to
ensure we don't use a predictable session_id.

This prevents (further) weakening* of the TACACS+ protocol
"encryption" since session_id is an input to the algorithm.

*by modern standards TACACS+ is deemed "obfuscated" - RFC 8907.
```

[![@deastoe](https://avatars.githubusercontent.com/u/31696783?s=40&v=4)](/deastoe)

`[pam_tacplus.c: Fallback to using PID as task ID](/kravietz/pam_tacplus/pull/163/commits/bceaab0cd51a09b88f40f19da799ac7390264bf8 "pam_tacplus.c: Fallback to using PID as task ID

If there is a failure obtaining a random task ID for the session
accounting request then fallback to using the PID, as this is unique
for the lifetime of the PAM application and therefore session.")`
 ‚Ä¶

`[bceaab0](/kravietz/pam_tacplus/pull/163/commits/bceaab0cd51a09b88f40f19da799ac7390264bf8)`

```
If there is a failure obtaining a random task ID for the session
accounting request then fallback to using the PID, as this is unique
for the lifetime of the PAM application and therefore session.
```

[![@gollub](https://avatars.githubusercontent.com/u/1199932?s=80&v=4)](/gollub)

Copy link

Collaborator

### **[gollub](/gollub)** commented [Oct 23, 2020](#issuecomment-715287891)

| LGTM |
| --- |

All reactions

Sorry, something went wrong.

[![@deastoe](https://avatars.githubusercontent.com/u/31696783?s=80&u=653829433ae446688950ae47b4547a1d4beea137&v=4)](/deastoe)

Copy link

Contributor

Author

### **[deastoe](/deastoe)** commented [Oct 23, 2020](#issuecomment-715439801)

| I have requested allocation of a CVE ID from MITRE. |
| --- |

 üëç
2
 kravietz and Fr3ya reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

Sorry, something went wrong.

[![kravietz](https://avatars.githubusercontent.com/u/616047?s=60&v=4)](/kravietz)

**[kravietz](/kravietz)**
approved these changes
[Oct 26, 2020](#pullrequestreview-516674682)

 [View reviewed changes](/kravietz/pam_tacplus/pull/163/files/bceaab0cd51a09b88f40f19da799ac7390264bf8)

[![@kravietz](https://avatars.githubusercontent.com/u/616047?s=40&u=c22bec67b8b441cf7213f72f27fb476e56d5d3f3&v=4)](/kravietz)
[kravietz](/kravietz)
merged commit [`468cc9d`](/kravietz/pam_tacplus/commit/468cc9d484364ecdc8bb245805f5c1fcb415fec9)
into
kravietz:master

[Oct 26, 2020](https://github.com/kravietz/pam_tacplus/pull/163#event-3920162511)

[![@kravietz](https://avatars.githubusercontent.com/u/616047?s=80&u=c22bec67b8b441cf7213f72f27fb476e56d5d3f3&v=4)](/kravietz)

Copy link

Owner

### **[kravietz](/kravietz)** commented [Oct 26, 2020](#issuecomment-716480548)

| Thanks, when we have CVE we can bump version and publish a new release. |
| --- |

 üëç
1
 deastoe reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=80&u=54a9fd1cfc2b1abb34a487f17e07eb8a03cecdae&v=4)](/carnil)

Copy link

### **[carnil](/carnil)** commented [Oct 27, 2020](#issuecomment-717077180)

| CVE-2020-27743 was assigned for this issue. |
| --- |

 üëç
1
 deastoe reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@kravietz](https://avatars.githubusercontent.com/u/616047?s=80&u=c22bec67b8b441cf7213f72f27fb476e56d5d3f3&v=4)](/kravietz)

Copy link

Owner

### **[kravietz](/kravietz)** commented [Oct 27, 2020](#issuecomment-717084677)

| Can you review/edit [GHSA-rp3p-jm35-jv76](https://github.com/kravietz/pam_tacplus/security/advisories/GHSA-rp3p-jm35-jv76 "GHSA-rp3p-jm35-jv76") |
| --- |

All reactions

Sorry, something went wrong.

[![@deastoe](https://avatars.githubusercontent.com/u/31696783?s=80&u=653829433ae446688950ae47b4547a1d4beea137&v=4)](/deastoe)

Copy link

Contributor

Author

### **[deastoe](/deastoe)** commented [Nov 2, 2020](#issuecomment-720426697)

| Thanks all for progressing this while I was AFK. |
| --- |

All reactions

Sorry, something went wrong.

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=80&u=54a9fd1cfc2b1abb34a487f17e07eb8a03cecdae&v=4)](/carnil)

Copy link

### **[carnil](/carnil)** commented [Nov 4, 2020](#issuecomment-721532578)

| [@kravietz](https://github.com/kravietz), [@deastoe](https://github.com/deastoe) looking the commit history of the project it looks that the issue only is introduced after [6fac250](https://github.com/kravietz/pam_tacplus/commit/6fac2504657b8d98fcd627d60ebdbffcf0253b81) in v1.5.0-beta.1. If this is correct maybe in [GHSA-rp3p-jm35-jv76](https://github.com/kravietz/pam_tacplus/security/advisories/GHSA-rp3p-jm35-jv76 "GHSA-rp3p-jm35-jv76") that could be added to the 'affected versions' constraints. |
| --- |

All reactions

Sorry, something went wrong.

[![@gollub](https://avatars.githubusercontent.com/u/1199932?s=80&v=4)](/gollub)

Copy link

Collaborator

### **[gollub](/gollub)** commented [Nov 4, 2020](#issuecomment-721534295)

| [@carnil](https://github.com/carnil) , that's correct. Updated the advisory: "after v1.5.0, before v1.6.1" |
| --- |

All reactions

Sorry, something went wrong.

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=80&u=54a9fd1cfc2b1abb34a487f17e07eb8a03cecdae&v=4)](/carnil)

Copy link

### **[carnil](/carnil)** commented [Nov 4, 2020](#issuecomment-721539016)

| [@gollub](https://github.com/gollub): Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@deastoe](https://avatars.githubusercontent.com/u/31696783?s=80&u=653829433ae446688950ae47b4547a1d4beea137&v=4)](/deastoe)

Copy link

Contributor

Author

### **[deastoe](/deastoe)** commented [Nov 4, 2020](#issuecomment-721646048) ‚Ä¢ edited Loading

| [@carnil](https://github.com/carnil), [@gollub](https://github.com/gollub), I believe this also affects v1.4.1:   [pam\_tacplus/libtac/lib/header.c](https://github.com/kravietz/pam_tacplus/blob/8dddbec2940f99fa4867d6b6a92d8ba10206915e/libtac/lib/header.c#L93)  Line 93 in [8dddbec](/kravietz/pam_tacplus/commit/8dddbec2940f99fa4867d6b6a92d8ba10206915e)   |  | RAND\_pseudo\_bytes((unsigned char \*) &session\_id, sizeof(session\_id)); | | --- | --- |     I will update the advisory.   In fact, it looks like v1.4.1 also does not check for a failure of getrandom(). This was fixed in v1.5.1 ([d5ea51f](https://github.com/kravietz/pam_tacplus/commit/d5ea51ff6a9b74bdc8a9ea7e6758d520f9b9a9fa)) |
| --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@deastoe](https://avatars.githubusercontent.com/u/31696783?s=80&u=653829433ae446688950ae47b4547a1d4beea137&v=4)](/deastoe)

Copy link

Contributor

Author

### **[deastoe](/deastoe)** commented [Nov 4, 2020](#issuecomment-721652508)

| In fact, it looks like v1.4.1 also does not check for a failure of getrandom().  However in 1.4.1 getrandom() is only used when not built with libcrypto, and 1.4.1 cannot be built out-of-the-box *without* libcrypto. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkravietz%2Fpam_tacplus%2Fpull%2F163).

Reviewers

[![@kravietz](https://avatars.githubusercontent.com/u/616047?s=40&v=4)](/kravietz) [kravietz](/kravietz)

kravietz approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

4 participants

[![@deastoe](https://avatars.githubusercontent.com/u/31696783?s=52&v=4)](/deastoe) [![@gollub](https://avatars.githubusercontent.com/u/1199932?s=52&v=4)](/gollub) [![@kravietz](https://avatars.githubusercontent.com/u/616047?s=52&v=4)](/kravietz) [![@carnil](https://avatars.githubusercontent.com/u/773068?s=52&v=4)](/carnil)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from tools.ietf.org_0dca75d0_20250119_120027.html ===


* Light
* Dark
* Auto

[RFC 8907

Informational](/doc/rfc8907/)

|  | Title |  | The Terminal Access Controller Access-Control System Plus (TACACS+) Protocol |
| --- | --- | --- | --- |
| Document | Document type |  | RFC - Informational  September 2020  [View errata](https://www.rfc-editor.org/errata_search.php?rfc=8907 "Click to view errata.") [Report errata](https://www.rfc-editor.org/errata.php#reportnew "Click to report an error in the document.") Was [draft-ietf-opsawg-tacacs](/doc/draft-ietf-opsawg-tacacs/18/) ([opsawg WG](/wg/opsawg/about/)) |
| --- | --- | --- | --- |
|  | Select version |  | * [00](/doc/html/draft-ietf-opsawg-tacacs-00) * [01](/doc/html/draft-ietf-opsawg-tacacs-01) * [02](/doc/html/draft-ietf-opsawg-tacacs-02) * [03](/doc/html/draft-ietf-opsawg-tacacs-03) * [04](/doc/html/draft-ietf-opsawg-tacacs-04) * [05](/doc/html/draft-ietf-opsawg-tacacs-05) * [06](/doc/html/draft-ietf-opsawg-tacacs-06) * [07](/doc/html/draft-ietf-opsawg-tacacs-07) * [08](/doc/html/draft-ietf-opsawg-tacacs-08) * [09](/doc/html/draft-ietf-opsawg-tacacs-09) * [10](/doc/html/draft-ietf-opsawg-tacacs-10) * [11](/doc/html/draft-ietf-opsawg-tacacs-11) * [12](/doc/html/draft-ietf-opsawg-tacacs-12) * [13](/doc/html/draft-ietf-opsawg-tacacs-13) * [14](/doc/html/draft-ietf-opsawg-tacacs-14) * [15](/doc/html/draft-ietf-opsawg-tacacs-15) * [16](/doc/html/draft-ietf-opsawg-tacacs-16) * [17](/doc/html/draft-ietf-opsawg-tacacs-17) * [18](/doc/html/draft-ietf-opsawg-tacacs-18) * [RFC 8907](/doc/html/rfc8907) |
|  | Compare versions |  | RFC 8907  draft-ietf-opsawg-tacacs-18  draft-ietf-opsawg-tacacs-16  draft-ietf-opsawg-tacacs-15  draft-ietf-opsawg-tacacs-14  draft-ietf-opsawg-tacacs-13  draft-ietf-opsawg-tacacs-12  draft-ietf-opsawg-tacacs-11  draft-ietf-opsawg-tacacs-10  draft-ietf-opsawg-tacacs-09  draft-ietf-opsawg-tacacs-08  draft-ietf-opsawg-tacacs-07  draft-ietf-opsawg-tacacs-06  draft-ietf-opsawg-tacacs-05  draft-ietf-opsawg-tacacs-04  draft-ietf-opsawg-tacacs-03  draft-ietf-opsawg-tacacs-02  draft-ietf-opsawg-tacacs-01  draft-ietf-opsawg-tacacs-00   RFC 8907  draft-ietf-opsawg-tacacs-18  draft-ietf-opsawg-tacacs-16  draft-ietf-opsawg-tacacs-15  draft-ietf-opsawg-tacacs-14  draft-ietf-opsawg-tacacs-13  draft-ietf-opsawg-tacacs-12  draft-ietf-opsawg-tacacs-11  draft-ietf-opsawg-tacacs-10  draft-ietf-opsawg-tacacs-09  draft-ietf-opsawg-tacacs-08  draft-ietf-opsawg-tacacs-07  draft-ietf-opsawg-tacacs-06  draft-ietf-opsawg-tacacs-05  draft-ietf-opsawg-tacacs-04  draft-ietf-opsawg-tacacs-03  draft-ietf-opsawg-tacacs-02  draft-ietf-opsawg-tacacs-01  draft-ietf-opsawg-tacacs-00   Side-by-side  Inline |
|  | Authors |  | [Thorsten Dahm](/person/t.dahm%40resolution.de "Datatracker profile of Thorsten Dahm") , [Andrej Ota](/person/andrej%40ota.si "Datatracker profile of Andrej Ota") , [dcmgash@cisco.com](/person/dcmgash%40cisco.com "Datatracker profile of dcmgash@cisco.com") , [David Carrel](/person/carrel%40ipsec.org "Datatracker profile of David Carrel") , [Lol Grant](/person/lol%40cisco.com "Datatracker profile of Lol Grant")   Email authors |
|  | RFC stream |  | IETF Logo IETF Logo |
|  | Other formats |  | [txt](https://www.rfc-editor.org/rfc/rfc8907.txt) [html](https://www.rfc-editor.org/rfc/rfc8907.html) [xml](https://www.rfc-editor.org/rfc/rfc8907.xml) [pdf](https://www.rfc-editor.org/rfc/rfc8907.pdf) [bibtex](/doc/rfc8907/bibtex/) |
|  | Additional resources |  | [Mailing list discussion](https://mailarchive.ietf.org/arch/browse/opsawg/?q=rfc8907 OR %22draft-ietf-opsawg-tacacs%22) |
|  |  |  | [Report a bug](https://github.com/ietf-tools/datatracker/issues/new/choose) |

| RFC 8907 | TACACS+ | September 2020 |
| --- | --- | --- |
| Dahm, et al. | Informational | [Page] |
| --- | --- | --- |

Stream:
Internet Engineering Task Force (IETF)
RFC:
[8907](https://www.rfc-editor.org/rfc/rfc8907)
Category:
Informational
Published:
September 2020

ISSN:
2070-1721
Authors:
T. Dahm
Google Inc.

A. Ota
Google Inc.

D.C. Medway Gash
Cisco Systems, Inc.

D. Carrel
IPsec Research

L. Grant

# RFC 8907

# The Terminal Access Controller Access-Control System Plus (TACACS+) Protocol

## [Abstract](#abstract)

This document describes the Terminal Access Controller Access-Control
System Plus (TACACS+) protocol, which is widely deployed today to provide
Device Administration for routers, network access servers, and other
networked computing devices via one or more centralized servers.[¬∂](#section-abstract-1)

## [Status of This Memo](#name-status-of-this-memo)

This document is not an Internet Standards Track specification; it is
published for informational purposes.[¬∂](#section-boilerplate.1-1)

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Not all documents
approved by the IESG are candidates for any level of Internet
Standard; see Section 2 of RFC 7841.[¬∂](#section-boilerplate.1-2)

Information about the current status of this document, any
errata, and how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8907>.[¬∂](#section-boilerplate.1-3)

## [Copyright Notice](#name-copyright-notice)

Copyright (c) 2020 IETF Trust and the persons identified as the
document authors. All rights reserved.[¬∂](#section-boilerplate.2-1)

This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents
carefully, as they describe your rights and restrictions with
respect to this document. Code Components extracted from this
document must include Simplified BSD License text as described in
Section 4.e of the Trust Legal Provisions and are provided without
warranty as described in the Simplified BSD License.[¬∂](#section-boilerplate.2-2)

This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008. The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s)
controlling the copyright in such materials, this document may not
be modified outside the IETF Standards Process, and derivative
works of it may not be created outside the IETF Standards Process,
except to format it for publication as an RFC or to translate it
into languages other than English.[¬∂](#section-boilerplate.2-3)

‚ñ≤
## [Table of Contents](#name-table-of-contents)

* [1](#section-1).¬†¬†[Introduction](#name-introduction)[¬∂](#section-toc.1-1.1.1)
* [2](#section-2).¬†¬†[Conventions](#name-conventions)[¬∂](#section-toc.1-1.2.1)
* [3](#section-3).¬†¬†[Technical Definitions](#name-technical-definitions)[¬∂](#section-toc.1-1.3.1)

  + [3.1](#section-3.1).¬†¬†[Client](#name-client)[¬∂](#section-toc.1-1.3.2.1.1)
  + [3.2](#section-3.2).¬†¬†[Server](#name-server)[¬∂](#section-toc.1-1.3.2.2.1)
  + [3.3](#section-3.3).¬†¬†[Packet](#name-packet)[¬∂](#section-toc.1-1.3.2.3.1)
  + [3.4](#section-3.4).¬†¬†[Connection](#name-connection)[¬∂](#section-toc.1-1.3.2.4.1)
  + [3.5](#section-3.5).¬†¬†[Session](#name-session)[¬∂](#section-toc.1-1.3.2.5.1)
  + [3.6](#section-3.6).¬†¬†[Treatment of Enumerated Protocol Values](#name-treatment-of-enumerated-pro)[¬∂](#section-toc.1-1.3.2.6.1)
  + [3.7](#section-3.7).¬†¬†[Treatment of Text Strings](#name-treatment-of-text-strings)[¬∂](#section-toc.1-1.3.2.7.1)
* [4](#section-4).¬†¬†[TACACS+ Packets and Sessions](#name-tacacs-packets-and-sessions)[¬∂](#section-toc.1-1.4.1)

  + [4.1](#section-4.1).¬†¬†[The TACACS+ Packet Header](#name-the-tacacs-packet-header)[¬∂](#section-toc.1-1.4.2.1.1)
  + [4.2](#section-4.2).¬†¬†[The TACACS+ Packet Body](#name-the-tacacs-packet-body)[¬∂](#section-toc.1-1.4.2.2.1)
  + [4.3](#section-4.3).¬†¬†[Single Connection Mode](#name-single-connection-mode)[¬∂](#section-toc.1-1.4.2.3.1)
  + [4.4](#section-4.4).¬†¬†[Session Completion](#name-session-completion)[¬∂](#section-toc.1-1.4.2.4.1)
  + [4.5](#section-4.5).¬†¬†[Data Obfuscation](#name-data-obfuscation)[¬∂](#section-toc.1-1.4.2.5.1)
* [5](#section-5).¬†¬†[Authentication](#name-authentication)[¬∂](#section-toc.1-1.5.1)

  + [5.1](#section-5.1).¬†¬†[The Authentication START Packet Body](#name-the-authentication-start-pa)[¬∂](#section-toc.1-1.5.2.1.1)
  + [5.2](#section-5.2).¬†¬†[The Authentication REPLY Packet Body](#name-the-authentication-reply-pa)[¬∂](#section-toc.1-1.5.2.2.1)
  + [5.3](#section-5.3).¬†¬†[The Authentication CONTINUE Packet Body](#name-the-authentication-continue)[¬∂](#section-toc.1-1.5.2.3.1)
  + [5.4](#section-5.4).¬†¬†[Description of Authentication Process](#name-description-of-authenticati)[¬∂](#section-toc.1-1.5.2.4.1)

    - [5.4.1](#section-5.4.1).¬†¬†[Version Behavior](#name-version-behavior)[¬∂](#section-toc.1-1.5.2.4.2.1.1)
    - [5.4.2](#section-5.4.2).¬†¬†[Common Authentication Flows](#name-common-authentication-flows)[¬∂](#section-toc.1-1.5.2.4.2.2.1)
    - [5.4.3](#section-5.4.3).¬†¬†[Aborting an Authentication Session](#name-aborting-an-authentication-)[¬∂](#section-toc.1-1.5.2.4.2.3.1)
* [6](#section-6).¬†¬†[Authorization](#name-authorization)[¬∂](#section-toc.1-1.6.1)

  + [6.1](#section-6.1).¬†¬†[The Authorization REQUEST Packet Body](#name-the-authorization-request-p)[¬∂](#section-toc.1-1.6.2.1.1)
  + [6.2](#section-6.2).¬†¬†[The Authorization REPLY Packet Body](#name-the-authorization-reply-pac)[¬∂](#section-toc.1-1.6.2.2.1)
* [7](#section-7).¬†¬†[Accounting](#name-accounting)[¬∂](#section-toc.1-1.7.1)

  + [7.1](#section-7.1).¬†¬†[The Account REQUEST Packet Body](#name-the-account-request-packet-)[¬∂](#section-toc.1-1.7.2.1.1)
  + [7.2](#section-7.2).¬†¬†[The Accounting REPLY Packet Body](#name-the-accounting-reply-packet)[¬∂](#section-toc.1-1.7.2.2.1)
* [8](#section-8).¬†¬†[Argument-Value Pairs](#name-argument-value-pairs)[¬∂](#section-toc.1-1.8.1)

  + [8.1](#section-8.1).¬†¬†[Value Encoding](#name-value-encoding)[¬∂](#section-toc.1-1.8.2.1.1)
  + [8.2](#section-8.2).¬†¬†[Authorization Arguments](#name-authorization-arguments)[¬∂](#section-toc.1-1.8.2.2.1)
  + [8.3](#section-8.3).¬†¬†[Accounting Arguments](#name-accounting-arguments)[¬∂](#section-toc.1-1.8.2.3.1)
* [9](#section-9).¬†¬†[Privilege Levels](#name-privilege-levels)[¬∂](#section-toc.1-1.9.1)
* [10](#section-10).¬†[Security Considerations](#name-security-considerations)[¬∂](#section-toc.1-1.10.1)

  + [10.1](#section-10.1).¬†¬†[General Security of the Protocol](#name-general-security-of-the-pro)[¬∂](#section-toc.1-1.10.2.1.1)
  + [10.2](#section-10.2).¬†¬†[Security of Authentication Sessions](#name-security-of-authentication-)[¬∂](#section-toc.1-1.10.2.2.1)
  + [10.3](#section-10.3).¬†¬†[Security of Authorization Sessions](#name-security-of-authorization-s)[¬∂](#section-toc.1-1.10.2.3.1)
  + [10.4](#section-10.4).¬†¬†[Security of Accounting Sessions](#name-security-of-accounting-sess)[¬∂](#section-toc.1-1.10.2.4.1)
  + [10.5](#section-10.5).¬†¬†[TACACS+ Best Practices](#name-tacacs-best-practices)[¬∂](#section-toc.1-1.10.2.5.1)

    - [10.5.1](#section-10.5.1).¬†¬†[Shared Secrets](#name-shared-secrets)[¬∂](#section-toc.1-1.10.2.5.2.1.1)
    - [10.5.2](#section-10.5.2).¬†¬†[Connections and Obfuscation](#name-connections-and-obfuscation)[¬∂](#section-toc.1-1.10.2.5.2.2.1)
    - [10.5.3](#section-10.5.3).¬†¬†[Authentication](#name-authentication-2)[¬∂](#section-toc.1-1.10.2.5.2.3.1)
    - [10.5.4](#section-10.5.4).¬†¬†[Authorization](#name-authorization-2)[¬∂](#section-toc.1-1.10.2.5.2.4.1)
    - [10.5.5](#section-10.5.5).¬†¬†[Redirection Mechanism](#name-redirection-mechanism)[¬∂](#section-toc.1-1.10.2.5.2.5.1)
* [11](#section-11).¬†[IANA Considerations](#name-iana-considerations)[¬∂](#section-toc.1-1.11.1)
* [12](#section-12).¬†[References](#name-references)[¬∂](#section-toc.1-1.12.1)

  + [12.1](#section-12.1).¬†¬†[Normative References](#name-normative-references)[¬∂](#section-toc.1-1.12.2.1.1)
  + [12.2](#section-12.2).¬†¬†[Informative References](#name-informative-references)[¬∂](#section-toc.1-1.12.2.2.1)
* [Acknowledgements](#name-acknowledgements)[¬∂](#section-toc.1-1.13.1)
* [Authors' Addresses](#name-authors-addresses)[¬∂](#section-toc.1-1.14.1)

## [1.](#section-1) [Introduction](#name-introduction)

This document describes the Terminal Access Controller Access-Control
System Plus (TACACS+) protocol. It was conceived initially as a general
Authentication, Authorization, and Accounting (AAA) protocol. It is
widely deployed today but is mainly confined for a specific subset of
AAA called Device Administration, which includes authenticating access to network
devices, providing central authorization of operations, and auditing of
those operations.[¬∂](#section-1-1)

A wide range of TACACS+ clients and servers is already deployed in the
field. The TACACS+ protocol they are based on is defined in a document
that was originally intended for IETF publication, but was never
standardized. The document is known as "The Draft" [[THE-DRAFT](#THE-DRAFT)].[¬∂](#section-1-2)

This Draft was a product of its time and did not address all of the
key security concerns that are considered when designing modern
standards. Therefore, deployment must be executed with care. These
concerns are addressed in [Section 10](#TACACSSecurity).[¬∂](#section-1-3)

The primary intent of this informational document is to clarify the
subset of "The Draft", which is common to implementations supporting
Device Administration. It is intended that all implementations that
conform to this document will conform to "The Draft". However, it is
not intended that all implementations that conform to "The Draft" will
conform to this document. The following features from "The Draft" have
been removed:[¬∂](#section-1-4)

* This document officially removes SENDPASS for security
  reasons.[¬∂](#section-1-5.1)
* The normative description of legacy features such as the Apple
  Remote Access Protocol (ARAP) and outbound authentication has been
  removed.[¬∂](#section-1-5.2)
* The Support for forwarding to an alternative daemon
  (TAC\_PLUS\_AUTHEN\_STATUS\_FOLLOW) has been deprecated.[¬∂](#section-1-5.3)

The TACACS+ protocol allows for arbitrary length and content
authentication exchanges to support alternative authentication
mechanisms. It is extensible to provide for site customization and
future development features, and it uses TCP to ensure reliable
delivery. The protocol allows the TACACS+ client to request fine-grained
access control and allows the server to respond to each component of
that request.[¬∂](#section-1-6)

The separation of authentication, authorization, and accounting is a
key element of the design of TACACS+ protocol. Essentially, it makes
TACACS+ a suite of three protocols. This document will address each
one in separate sections. Although TACACS+ defines all three, an
implementation or deployment is not required to employ all three.
Separating the elements is useful for the Device Administration use
case, specifically, for authorization and accounting of individual commands in a
session. Note that there is no provision made at the protocol level
to associate authentication requests with authorization requests.[¬∂](#section-1-7)

## [2.](#section-2) [Conventions](#name-conventions)

The key words "MUST", "MUST NOT",
"REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
"RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are
to be interpreted as described in BCP¬†14 [[RFC2119](#RFC2119)]
[[RFC8174](#RFC8174)] when, and only when, they appear in all capitals,
as shown here.[¬∂](#section-2-1)

## [3.](#section-3) [Technical Definitions](#name-technical-definitions)

This section provides a few basic definitions that are applicable to
this document.[¬∂](#section-3-1)

### [3.1.](#section-3.1) [Client](#name-client)

The client is any device that initiates TACACS+ protocol requests
to mediate access, mainly for the Device Administration use case.[¬∂](#section-3.1-1)

### [3.2.](#section-3.2) [Server](#name-server)

The server receives TACACS+ protocol requests and replies
according to its business model in accordance with the flows defined
in this document.[¬∂](#section-3.2-1)

### [3.3.](#section-3.3) [Packet](#name-packet)

All uses of the word packet in this document refer to TACACS+
protocol data units unless explicitly noted otherwise. The informal
term "packet" has become an established part of the definition.[¬∂](#section-3.3-1)

### [3.4.](#section-3.4) [Connection](#name-connection)

TACACS+ uses TCP for its transport. TCP Server port 49 is allocated
by IANA for TACACS+ traffic.[¬∂](#section-3.4-1)

### [3.5.](#section-3.5) [Session](#name-session)

The concept of a session is used
throughout this document. A TACACS+
session is a single authentication
sequence, a single authorization
exchange, or a single accounting
exchange.[¬∂](#section-3.5-1)

An accounting and authorization
session will consist of a single pair
of packets (the request and its
reply). An authentication session may
involve an arbitrary number of packets
being exchanged. The session is an
operational concept that is maintained
between the TACACS+ client and
server. It does not necessarily
correspond to a given user or user
action.[¬∂](#section-3.5-2)

### [3.6.](#section-3.6) [Treatment of Enumerated Protocol Values](#name-treatment-of-enumerated-pro)

This document describes various
enumerated values in the packet header
and the headers for specific packet
types. For example, in the
authentication start packet type, this
document defines the action field with
three values: TAC\_PLUS\_AUTHEN\_LOGIN,
TAC\_PLUS\_AUTHEN\_CHPASS, and
TAC\_PLUS\_AUTHEN\_SENDAUTH.[¬∂](#section-3.6-1)

If the server does not implement one of the defined options in a
packet that it receives, or it encounters an option that is not listed
in this document for a header field, then it should respond with an
ERROR and terminate the session. This will allow the client to try a
different option.[¬∂](#section-3.6-2)

If an error occurs but the type of the
incoming packet cannot be determined,
a packet with the identical cleartext
header but with a sequence number
incremented by one and the length set
to zero MUST be
returned to indicate an error.[¬∂](#section-3.6-3)

### [3.7.](#section-3.7) [Treatment of Text Strings](#name-treatment-of-text-strings)

The TACACS+ protocol makes extensive use of text strings. "The
Draft" intended that these strings would be treated as byte arrays
where each byte would represent a US-ASCII character.[¬∂](#section-3.7-1)

More recently, server implementations have been extended to
interwork with external identity services, and so a more nuanced
approach is needed. Usernames MUST be encoded and
handled using the UsernameCasePreserved Profile specified in [[RFC8265](#RFC8265)]. The security
considerations in [Section 8](https://www.rfc-editor.org/rfc/rfc8265#section-8) of [[RFC8265](#RFC8265)] apply.[¬∂](#section-3.7-2)

Where specifically mentioned, data fields contain arrays of
arbitrary bytes as required for protocol processing. These are not
intended to be made visible through user interface to users.[¬∂](#section-3.7-3)

All other text fields in TACACS+
MUST be treated as
printable byte arrays of US-ASCII as
defined by [[RFC0020](#RFC0020)]. The term
"printable" used here means the fields
MUST exclude the
"Control Characters" defined in [Section 5.2](https://www.rfc-editor.org/rfc/rfc20#section-5.2) of [[RFC0020](#RFC0020)].[¬∂](#section-3.7-4)

## [4.](#section-4) [TACACS+ Packets and Sessions](#name-tacacs-packets-and-sessions)

### [4.1.](#section-4.1) [The TACACS+ Packet Header](#name-the-tacacs-packet-header)

All TACACS+ packets begin with the
following 12-byte header. The header
describes the remainder of the packet:[¬∂](#section-4.1-1)

```

 1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
+----------------+----------------+----------------+----------------+
|major  | minor  |                |                |                |
|version| version|      type      |     seq_no     |   flags        |
+----------------+----------------+----------------+----------------+
|                                                                   |
|                            session_id                             |
+----------------+----------------+----------------+----------------+
|                                                                   |
|                              length                               |
+----------------+----------------+----------------+----------------+

```
[¬∂](#section-4.1-2)

The following general rules apply to all TACACS+ packet types:[¬∂](#section-4.1-3)

* To signal that any variable-length data fields are unused, the
  corresponding length values are set to zero. Such fields
  MUST be ignored, and treated as if not present.[¬∂](#section-4.1-4.1)
* The lengths of data and message fields in a packet are specified by
  their corresponding length field (and are not null terminated).[¬∂](#section-4.1-4.2)
* All length values are unsigned and in network byte order.[¬∂](#section-4.1-4.3)

major\_version[¬∂](#section-4.1-5)

* This is the major TACACS+ version number.[¬∂](#section-4.1-6.1.1)

* TAC\_PLUS\_MAJOR\_VER := 0xc[¬∂](#section-4.1-7.1)

minor\_version[¬∂](#section-4.1-8)

* This is the minor TACACS+ version number.[¬∂](#section-4.1-9.1.1)
* TAC\_PLUS\_MINOR\_VER\_DEFAULT := 0x0[¬∂](#section-4.1-9.2)
* TAC\_PLUS\_MINOR\_VER\_ONE := 0x1[¬∂](#section-4.1-9.3)

type[¬∂](#section-4.1-10)

* This is the packet type.[¬∂](#section-4.1-11.1.1)
* Options are:[¬∂](#section-4.1-11.2)
* TAC\_PLUS\_AUTHEN := 0x01 (Authentication)[¬∂](#section-4.1-11.3)
* TAC\_PLUS\_AUTHOR := 0x02 (Authorization)[¬∂](#section-4.1-11.4)
* TAC\_PLUS\_ACCT := 0x03 (Accounting)[¬∂](#section-4.1-11.5)

seq\_no[¬∂](#section-4.1-12)

* This is the sequence number of the current packet. The first packet in
  a session MUST have the sequence number 1, and each
  subsequent packet will increment the sequence number by one. TACACS+
  clients only send packets containing odd sequence numbers, and TACACS+
  servers only send packets containing even sequence numbers.[¬∂](#section-4.1-13.1.1)
* The sequence number must never wrap, i.e., if the sequence number 28-1
  is ever reached, that session must terminate and be restarted with a
  sequence number of 1.[¬∂](#section-4.1-13.2.1)

flags[¬∂](#section-4.1-14)

* This field contains various bitmapped flags.[¬∂](#section-4.1-15.1.1)
* The flag bit:[¬∂](#section-4.1-15.2.1)
* TAC\_PLUS\_UNENCRYPTED\_FLAG := 0x01[¬∂](#section-4.1-15.3.1)
* This flag indicates that the sender
  did not obfuscate the body of the
  packet. This option MUST NOT be used in production. The
  application of this flag will be
  covered in "Security Considerations"
  ([Section 10](#TACACSSecurity)).[¬∂](#section-4.1-15.4.1)
* This flag SHOULD be clear in all
  deployments. Modern network traffic tools support encrypted
  traffic when configured with the shared secret (see "Shared Secrets" ([Section 10.5.1](#SharedSecrets))), so obfuscated mode can and
  SHOULD be used even during test.[¬∂](#section-4.1-15.5.1)
* The single-connection flag:[¬∂](#section-4.1-15.6.1)
* TAC\_PLUS\_SINGLE\_CONNECT\_FLAG := 0x04[¬∂](#section-4.1-15.7.1)
* This flag is used to allow a client and server to negotiate
  "Single Connection Mode" ([Section 4.3](#SingleConnectMode)).[¬∂](#section-4.1-15.8.1)
* All other bits MUST be ignored when reading,
  and SHOULD be set to zero when writing.[¬∂](#section-4.1-15.9.1)

session\_id[¬∂](#section-4.1-16)

* The Id for this TACACS+ session. This field does not change
  for the duration of the TACACS+ session. This number
  MUST be generated by a cryptographically strong
  random number generation method. Failure to do so will
  compromise security of the session. For more details, refer to
  [[RFC4086](#RFC4086)].[¬∂](#section-4.1-17.1.1)

length[¬∂](#section-4.1-18)

* The total length of the packet body (not including
  the header). Implementations MUST allow control over
  maximum packet sizes accepted by TACACS+ Servers.
  The recommended maximum packet size is 216.[¬∂](#section-4.1-19.1.1)

### [4.2.](#section-4.2) [The TACACS+ Packet Body](#name-the-tacacs-packet-body)

The TACACS+ body types are defined in
the packet header. The next sections
of this document will address the
contents of the different TACACS+
bodies.[¬∂](#section-4.2-1)

### [4.3.](#section-4.3) [Single Connection Mode](#name-single-connection-mode)

Single Connection Mode is intended to
improve performance where there is a
lot of traffic between a client and a
server by allowing the client to
multiplex multiple sessions on a
single TCP connection.[¬∂](#section-4.3-1)

The packet header contains the
TAC\_PLUS\_SINGLE\_CONNECT\_FLAG used by
the client and server to negotiate the
use of Single Connection Mode.[¬∂](#section-4.3-2)

The client sets this flag to indicate
that it supports multiplexing TACACS+
sessions over a single TCP
connection. The client MUST NOT send a second packet on a
connection until single-connect status
has been established.[¬∂](#section-4.3-3)

To indicate it will support Single
Connection Mode, the server sets this
flag in the first reply packet in
response to the first request from a
client. The server may set this flag
even if the client does not set it,
but the client may ignore the flag and
close the connection after the session
completes.[¬∂](#section-4.3-4)

The flag is only relevant for the
first two packets on a connection, to
allow the client and server to
establish Single Connection Mode. No
provision is made for changing Single
Connection Mode after the first two
packets; the client and server
MUST ignore the flag
after the second packet on a
connection.[¬∂](#section-4.3-5)

If Single Connection Mode has not been
established in the first two packets
of a TCP connection, then both the
client and the server close the
connection at the end of the first
session.[¬∂](#section-4.3-6)

The client negotiates Single Connection Mode to improve
efficiency. The server may refuse to allow Single Connection Mode for
the client. For example, it may not be appropriate to allocate a
long-lasting TCP connection to a specific client in some deployments.
Even if the server is configured to permit Single Connection Mode for
a specific client, the server may close the connection. For example, a
server MUST be configured to time out a Single
Connection Mode TCP connection after a specific period of inactivity
to preserve its resources. The client MUST accommodate
such closures on a TCP session even after Single Connection Mode has
been established.[¬∂](#section-4.3-7)

The TCP connection underlying the Single Connection Mode will close
eventually either because of the timeout from the server or from an
intermediate link. If a session is in progress when the client
detects disconnect, then the client should handle it as described in
"Session Completion" ([Section 4.4](#SessionCompletion)). If a session is
not in progress, then the client will need to detect this and restart
the Single Connection Mode when it initiates the next session.[¬∂](#section-4.3-8)

### [4.4.](#section-4.4) [Session Completion](#name-session-completion)

The REPLY packets defined for the packet types in the sections
below (Authentication, Authorization, and Accounting) contain a status
field. The complete set of options for this field depend upon the
packet type, but all three REPLY packet types define values
representing PASS, ERROR, and FAIL, which indicate the last packet of a
regular session (one that is not aborted).[¬∂](#section-4.4-1)

The server responds with a PASS or a FAIL to indicate that the
processing of the request completed and that the client can apply the
result (PASS or FAIL) to control the execution of the action that
prompted the request to be sent to the server.[¬∂](#section-4.4-2)

The server responds with an ERROR to indicate that the processing
of the request did not complete. The client cannot apply the result,
and it MUST behave as if the server could not be
connected to. For example, the client tries alternative methods, if
they are available, such as sending the request to a backup server or
using local configuration to determine whether the action that
prompted the request should be executed.[¬∂](#section-4.4-3)

Refer to "Aborting an Authentication Session" ([Section 5.4.3](#AbortinganAuthenticationSession)) for details
on handling additional status options.[¬∂](#section-4.4-4)

When the session is complete, the TCP connection should be
handled as follows, according to whether Single Connection Mode was
negotiated:[¬∂](#section-4.4-5)

* If Single Connection Mode was not negotiated, then the connection
  should be closed.[¬∂](#section-4.4-6.1.1)
* If Single Connection Mode was enabled,
  then the connection
  SHOULD be left open
  (see "Single Connection Mode" ([Section 4.3](#SingleConnectMode))) but may still be
  closed after a timeout period to
  preserve deployment resources.[¬∂](#section-4.4-6.2.1)
* If Single Connection Mode was enabled,
  but an ERROR occurred due to
  connection issues (such as an
  incorrect secret (see [Section 4.5](#Obfuscation))), then any further
  new sessions MUST NOT
  be accepted on the connection. If
  there are any sessions that have
  already been established, then they
  MAY be completed. Once
  all active sessions are completed, then
  the connection MUST be
  closed.[¬∂](#section-4.4-6.3.1)

It is recommended that client implementations provide robust
schemes for dealing with servers that cannot be connected to. Options
include providing a list of servers for redundancy and an option for
a local fallback configuration if no servers can be reached. Details
will be implementation specific.[¬∂](#section-4.4-7)

The client should manage connections
and handle the case of a server that
establishes a connection but does not
respond. The exact behavior is
implementation specific. It is
recommended that the client
close the connection after a
configurable timeout.[¬∂](#section-4.4-8)

### [4.5.](#section-4.5) [Data Obfuscation](#name-data-obfuscation)

The body of packets may be
obfuscated. The following sections
describe the obfuscation method that
is supported in the protocol. In "The
Draft", this process was actually
referred to as Encryption, but the
algorithm would not meet modern
standards and so will not be termed
as encryption in this document.[¬∂](#section-4.5-1)

The obfuscation mechanism relies on a
secret key, a shared secret value that
is known to both the client and the
server. The secret keys
MUST remain secret.[¬∂](#section-4.5-2)

Server implementations MUST allow a unique secret
key to be associated with each client. It is a site-dependent decision
as to whether or not the use of separate keys is appropriate.[¬∂](#section-4.5-3)

The flag field MUST be configured with
TAC\_PLUS\_UNENCRYPTED\_FLAG set to 0 so that the packet body is obfuscated by
XORing it bytewise with a pseudo-random pad:[¬∂](#section-4.5-4)

* ENCRYPTED {data} = data pseudo\_pad[¬∂](#section-4.5-5.1.1)

The packet body can then be de-obfuscated by XORing it bytewise
with a pseudo-random pad.[¬∂](#section-4.5-6)

* data = ENCRYPTED {data} pseudo\_pad[¬∂](#section-4.5-7.1.1)

The pad is generated by concatenating
a series of MD5 hashes (each 16 bytes
long) and truncating it to the length
of the input data.
Whenever used in this document, MD5 refers to
the "RSA Data
Security, Inc.¬† MD5 Message-Digest
Algorithm" as specified in
[[RFC1321](#RFC1321)].[¬∂](#section-4.5-8)

* pseudo\_pad = {MD5\_1 [,MD5\_2 [
  ... ,MD5\_n]]} truncated to len(data)[¬∂](#section-4.5-9.1.1)

The first MD5 hash is generated by
concatenating the session\_id, the
secret key, the version number, and the
sequence number, and then running MD5
over that stream. All of those input
values are available in the packet
header, except for the secret
key, which
is a shared secret between the TACACS+
client and server.[¬∂](#section-4.5-10)

The version number and session\_id are extracted from the
header.[¬∂](#section-4.5-11)

Subsequent hashes are generated by
using the same input stream but
concatenating the previous hash value
at the end of the input stream.[¬∂](#section-4.5-12)

* MD5\_1 = MD5{session\_id, key, version,
  seq\_no} MD5\_2 = MD5{session\_id, key,
  version, seq\_no, MD5\_1} .... MD5\_n =
  MD5{session\_id, key, version, seq\_no,
  MD5\_n-1}[¬∂](#section-4.5-13.1.1)

When a server detects that the
secrets it has configured for the
device do not match, it
MUST return ERROR. For
details of TCP connection handling on
ERROR, refer to "Session Completion" ([Section 4.4](#SessionCompletion)).[¬∂](#section-4.5-14)

* TAC\_PLUS\_UNENCRYPTED\_FLAG == 0x1[¬∂](#section-4.5-15.1.1)

This option is deprecated and
MUST NOT be used in
production. In this case, the entire
packet body is in cleartext. A request
MUST be dropped if
TAC\_PLUS\_UNENCRYPTED\_FLAG is set to
true.[¬∂](#section-4.5-16)

After a packet body is de-obfuscated, the lengths of the
component
values
in the packet are summed. If the sum is not
identical to the
cleartext
datalength value from the header,
the
packet MUST be
discarded and an ERROR signaled. For details of TCP connection
handling on ERROR, refer to
"Session Completion" ([Section 4.4](#SessionCompletion)).[¬∂](#section-4.5-17)

Commonly, such failures are seen when
the keys are mismatched between the
client and the TACACS+ server.[¬∂](#section-4.5-18)

## [5.](#section-5) [Authentication](#name-authentication)

Authentication is the action of determining who a user (or entity)
is. Authentication can take many forms. Traditional authentication
employs a name and a fixed password. However, fixed passwords are
vulnerable security, so many modern authentication mechanisms utilize
"one-time" passwords or a challenge-response query. TACACS+ is designed
to support all of these and be flexible enough to handle any future
mechanisms. Authentication generally takes place when the user first
logs in to a machine or requests a service of it.[¬∂](#section-5-1)

Authentication is not mandatory; it is a site-configured option.
Some sites do not require it. Others require it only for certain
services (see "Authorization" ([Section 6](#Authorization))). Authentication may also take place
when a user attempts to gain extra privileges and must identify himself
or herself as someone who possesses the required information (passwords,
etc.) for those privileges.[¬∂](#section-5-2)

### [5.1.](#section-5.1) [The Authentication START Packet Body](#name-the-authentication-start-pa)

```

 1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
+----------------+----------------+----------------+----------------+
|    action      |    priv_lvl    |  authen_type   | authen_service |
+----------------+----------------+----------------+----------------+
|    user_len    |    port_len    |  rem_addr_len  |    data_len    |
+----------------+----------------+----------------+----------------+
|    user ...
+----------------+----------------+----------------+----------------+
|    port ...
+----------------+----------------+----------------+----------------+
|    rem_addr ...
+----------------+----------------+----------------+----------------+
|    data...
+----------------+----------------+----------------+----------------+

```
[¬∂](#section-5.1-1)

Packet fields are as follows:[¬∂](#section-5.1-2)

action[¬∂](#section-5.1-3)

* This indicates the authentication action.[¬∂](#section-5.1-4.1.1)

  Valid values are:[¬∂](#section-5.1-4.1.2)
* TAC\_PLUS\_AUTHEN\_LOGIN := 0x01[¬∂](#section-5.1-4.2)
* TAC\_PLUS\_AUTHEN\_CHPASS := 0x02[¬∂](#section-5.1-4.3)
* TAC\_PLUS\_AUTHEN\_SENDAUTH := 0x04[¬∂](#section-5.1-4.4)

priv\_lvl[¬∂](#section-5.1-5)

* This indicates the privilege level that the user is authenticating
  as. Please refer to "Privilege Levels" ([Section 9](#PrivilegeLevel)).[¬∂](#section-5.1-6.1.1)

authen\_type[¬∂](#section-5.1-7)

* The type of authentication. Please see "Common Authentication Flows" ([Section 5.4.2](#CommonAuthenticationFlows)).[¬∂](#section-5.1-8.1.1)
* Valid values are:[¬∂](#section-5.1-8.2.1)
* TAC\_PLUS\_AUTHEN\_TYPE\_ASCII := 0x01[¬∂](#section-5.1-8.3)
* TAC\_PLUS\_AUTHEN\_TYPE\_PAP := 0x02[¬∂](#section-5.1-8.4)
* TAC\_PLUS\_AUTHEN\_TYPE\_CHAP := 0x03[¬∂](#section-5.1-8.5)
* TAC\_PLUS\_AUTHEN\_TYPE\_MSCHAP := 0x05[¬∂](#section-5.1-8.6)
* TAC\_PLUS\_AUTHEN\_TYPE\_MSCHAPV2 := 0x06[¬∂](#section-5.1-8.7)

authen\_service[¬∂](#section-5.1-9)

* This is the service that is requesting
  the authentication.[¬∂](#section-5.1-10.1.1)
* Valid values are:[¬∂](#section-5.1-10.2.1)
* TAC\_PLUS\_AUTHEN\_SVC\_NONE := 0x00[¬∂](#section-5.1-10.3)
* TAC\_PLUS\_AUTHEN\_SVC\_LOGIN := 0x01[¬∂](#section-5.1-10.4)
* TAC\_PLUS\_AUTHEN\_SVC\_ENABLE := 0x02[¬∂](#section-5.1-10.5)
* TAC\_PLUS\_AUTHEN\_SVC\_PPP := 0x03[¬∂](#section-5.1-10.6)
* TAC\_PLUS\_AUTHEN\_SVC\_PT := 0x05[¬∂](#section-5.1-10.7)
* TAC\_PLUS\_AUTHEN\_SVC\_RCMD := 0x06[¬∂](#section-5.1-10.8)
* TAC\_PLUS\_AUTHEN\_SVC\_X25 := 0x07[¬∂](#section-5.1-10.9)
* TAC\_PLUS\_AUTHEN\_SVC\_NASI := 0x08[¬∂](#section-5.1-10.10)
* TAC\_PLUS\_AUTHEN\_SVC\_FWPROXY := 0x09[¬∂](#section-5.1-10.11)
* The TAC\_PLUS\_AUTHEN\_SVC\_NONE option is intended for the
  authorization application of this field that indicates that no
  authentication was performed by the device.[¬∂](#section-5.1-10.12.1)

  The TAC\_PLUS\_AUTHEN\_SVC\_LOGIN option indicates regular login (as
  opposed to ENABLE) to a client device.[¬∂](#section-5.1-10.12.2)
* The TAC\_PLUS\_AUTHEN\_SVC\_ENABLE option
  identifies the ENABLE authen\_service,
  which refers to a service requesting
  authentication in order to grant the
  user different privileges. This is
  comparable to the Unix "su(1)"
  command, which substitutes the current
  user's identity with another. An
  authen\_service value of NONE is only
  to be used when none of the other
  authen\_service values are appropriate.
  ENABLE may be requested independently;
  no requirements for previous
  authentications or authorizations are
  imposed by the protocol.[¬∂](#section-5.1-10.13.1)
* Other options are included for legacy/backwards compatibility.[¬∂](#section-5.1-10.14.1)

user, user\_len[¬∂](#section-5.1-11)

* The username is optional in this
  packet, depending upon the class of
  authentication. If it is absent, the
  client MUST set
  user\_len to 0. If included, the
  user\_len indicates the length of the
  user field, in bytes.[¬∂](#section-5.1-12.1.1)

port, port\_len[¬∂](#section-5.1-13)

* The name of the client port on which
  the authentication is taking place.
  The value of this field is free-format
  text and is client specific. Examples
  of this argument include "tty10"
  to denote the tenth tty line, and
  "async10" to denote the tenth async
  interface. The client documentation
  SHOULD define the
  values and their meanings for this
  field. For details of text encoding,
  see "Treatment of Text Strings" ([Section 3.7](#TextEncoding)). The port\_len indicates the
  length of the port field, in bytes.[¬∂](#section-5.1-14.1.1)

rem\_addr, rem\_addr\_len[¬∂](#section-5.1-15)

* A string indicating the remote
  location from which the user has
  connected to the client. For details
  of text encoding, see "Treatment of
  Text Strings" ([Section 3.7](#TextEncoding)).[¬∂](#section-5.1-16.1.1)
* When TACACS+ was used for dial-up services, this value contained
  the caller ID.[¬∂](#section-5.1-16.2.1)
* When TACACS+ is used for Device
  Administration, the user is normally
  connected via a network, and in this
  case, the value is intended to hold a
  network address, IPv4 or IPv6. For
  IPv6 address text representation
  defined, please see [[RFC5952](#RFC5952)].[¬∂](#section-5.1-16.3.1)
* This field is optional (since the information may not be
  available). The rem\_addr\_len indicates the length of the user field,
  in bytes.[¬∂](#section-5.1-16.4.1)

data, data\_len[¬∂](#section-5.1-17)

* The data field is used to send data appropriate for the action and
  authen\_type. It is described in more detail in "Common Authentication
  Flows" ([Section 5.4.2](#CommonAuthenticationFlows)). The data\_len field indicates the length of the
  data field, in bytes.[¬∂](#section-5.1-18.1.1)

### [5.2.](#section-5.2) [The Authentication REPLY Packet Body](#name-the-authentication-reply-pa)

The TACACS+ server sends only one type
of authentication packet (a REPLY
packet) to the client.[¬∂](#section-5.2-1)

```

 1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
+----------------+----------------+----------------+----------------+
|     status     |      flags     |        server_msg_len           |
+----------------+----------------+----------------+----------------+
|           data_len              |        server_msg ...
+----------------+----------------+----------------+----------------+
|           data ...
+----------------+----------------+

```
[¬∂](#section-5.2-2)

status[¬∂](#section-5.2-3)

* The current status of the authentication.[¬∂](#section-5.2-4.1.1)
* Valid values are:[¬∂](#section-5.2-4.2)

* TAC\_PLUS\_AUTHEN\_STATUS\_PASS := 0x01[¬∂](#section-5.2-5.1)
* TAC\_PLUS\_AUTHEN\_STATUS\_FAIL :=
  0x02[¬∂](#section-5.2-5.2)
* TAC\_PLUS\_AUTHEN\_STATUS\_GETDATA := 0x03[¬∂](#section-5.2-5.3)
* TAC\_PLUS\_AUTHEN\_STATUS\_GETUSER := 0x04[¬∂](#section-5.2-5.4)
* TAC\_PLUS\_AUTHEN\_STATUS\_GETPASS := 0x05[¬∂](#section-5.2-5.5)
* TAC\_PLUS\_AUTHEN\_STATUS\_RESTART := 0x06[¬∂](#section-5.2-5.6)
* TAC\_PLUS\_AUTHEN\_STATUS\_ERROR
  := 0x07[¬∂](#section-5.2-5.7)
* TAC\_PLUS\_AUTHEN\_STATUS\_FOLLOW := 0x21[¬∂](#section-5.2-5.8)

flags[¬∂](#section-5.2-6)

* Bitmapped flags that modify the action to be taken.[¬∂](#section-5.2-7.1.1)
* The following values are defined:[¬∂](#section-5.2-7.2)

* TAC\_PLUS\_REPLY\_FLAG\_NOECHO := 0x01[¬∂](#section-5.2-8.1)

server\_msg, server\_msg\_len[¬∂](#section-5.2-9)

* A message to be displayed to the user. This field is optional. The
  server\_msg\_len indicates the length of the server\_msg field, in bytes.
  For details of text encoding, see "Treatment of Text Strings" ([Section 3.7](#TextEncoding)).[¬∂](#section-5.2-10.1.1)

data, data\_len[¬∂](#section-5.2-11)

* A field that holds data that is a part of the authentication exchange
  and is intended for client processing, not the user. It is not a
  printable text encoding. Examples of its use are shown in "Common
  Authentication Flows" ([Section 5.4.2](#CommonAuthenticationFlows)). The data\_len indicates the length of the data
  field, in bytes.[¬∂](#section-5.2-12.1.1)

### [5.3.](#section-5.3) [The Authentication CONTINUE Packet Body](#name-the-authentication-continue)

This packet is sent from the client to the server following the
receipt of a REPLY packet.[¬∂](#section-5.3-1)

```

 1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
+----------------+----------------+----------------+----------------+
|          user_msg len           |            data_len             |
+----------------+----------------+----------------+----------------+
|     flags      |  user_msg ...
+----------------+----------------+----------------+----------------+
|    data ...
+----------------+

```
[¬∂](#section-5.3-2)

user\_msg, user\_msg\_len[¬∂](#section-5.3-3)

* A field that is the string that the user entered, or the client
  provided on behalf of the user, in response to the server\_msg from a
  REPLY packet. The user\_len indicates the length of the user field, in
  bytes.[¬∂](#section-5.3-4.1.1)

data, data\_len[¬∂](#section-5.3-5)

* This field carries information that is specific to the action and the
  authen\_type for this session. Valid uses of this field are described
  below. It is not a printable text encoding. The data\_len indicates the
  length of the data field, in bytes.[¬∂](#section-5.3-6.1.1)

flags[¬∂](#section-5.3-7)

* This holds the bitmapped flags that modify the action to be taken.[¬∂](#section-5.3-8.1.1)
* The following values are defined:[¬∂](#section-5.3-8.2.1)
* TAC\_PLUS\_CONTINUE\_FLAG\_ABORT := 0x01[¬∂](#section-5.3-8.3)

### [5.4.](#section-5.4) [Description of Authentication Process](#name-description-of-authenticati)

The action, authen\_type, and authen\_service fields (described above)
combine to indicate what kind of authentication is to be performed.
Every authentication START, REPLY, and CONTINUE packet includes a data
field. The use of this field is dependent upon the kind of
authentication.[¬∂](#section-5.4-1)

This document defines a core set of authentication flows to be
supported by TACACS+. Each authentication flow consists of a START
packet. The server responds either with a request for more
information (GETDATA, GETUSER, or GETPASS) or a termination PASS, FAIL,
ERROR, or RESTART. The actions and meanings when the server sends a
RESTART or ERROR are common and are described further below.[¬∂](#section-5.4-2)

When the REPLY status equals TAC\_PLUS\_AUTHEN\_STATUS\_GETDATA,
TAC\_PLUS\_AUTHEN\_STATUS\_GETUSER, or TAC\_PLUS\_AUTHEN\_STATUS\_GETPASS,
authentication continues and the server SHOULD provide
server\_msg content for the client to prompt the user for more
information. The client MUST then return a CONTINUE
packet containing the requested information in the user\_msg field.[¬∂](#section-5.4-3)

The client should interpret TAC\_PLUS\_AUTHEN\_STATUS\_GETUSER as a
request for a username and TAC\_PLUS\_AUTHEN\_STATUS\_GETPASS as a request
for a password. The TAC\_PLUS\_AUTHEN\_STATUS\_GETDATA is the generic
request for more information to flexibly support future requirements.[¬∂](#section-5.4-4)

If the information being requested by the server from the client is
sensitive, then the server should set the TAC\_PLUS\_REPLY\_FLAG\_NOECHO
flag. When the client queries the user for the information, the
response MUST NOT be reflected in the user interface as
it is entered.[¬∂](#section-5.4-5)

The data field is only used in the REPLY
where
explicitly
defined
below.[¬∂](#section-5.4-6)

#### [5.4.1.](#section-5.4.1) [Version Behavior](#name-version-behavior)

The TACACS+ protocol is
versioned to allow revisions
while maintaining backwards
compatibility. The version
number is in every packet
header. The changes between
minor\_version 0 and 1 apply
only to the authentication
process, and all deal with the
way that Challenge
Handshake
Authentication
Protocol (CHAP) and
Password
Authentication
Protocol (PAP)
authentications are
handled. minor\_version 1 may
only be used for
authentication kinds that
explicitly call for it in the
table below:[¬∂](#section-5.4.1-1)

[Table 1](#table-1):
[TACACS+ Protocol Versioning](#name-tacacs-protocol-versioning)

|  | LOGIN | CHPASS | SENDAUTH |
| --- | --- | --- | --- |
| ASCII | v0 | v0 | - |
| PAP | v1 | - | v1 |
| CHAP | v1 | - | v1 |
| MS-CHAPv1/2 | v1 | - | v1 |

The '-' symbol represents that the option is not valid.[¬∂](#section-5.4.1-3)

All authorization and accounting and ASCII authentication use
minor\_version 0.[¬∂](#section-5.4.1-4)

PAP, CHAP, and MS-CHAP login use minor\_version 1. The normal exchange
is a single START packet from the client and a single REPLY from the
server.[¬∂](#section-5.4.1-5)

The removal of SENDPASS was prompted by security concerns and
is no longer considered part of the TACACS+ protocol.[¬∂](#section-5.4.1-6)

#### [5.4.2.](#section-5.4.2) [Common Authentication Flows](#name-common-authentication-flows)

This section describes common authentication flows. If the server does
not implement an option, it MUST respond with
TAC\_PLUS\_AUTHEN\_STATUS\_FAIL.[¬∂](#section-5.4.2-1)

##### [5.4.2.1.](#section-5.4.2.1) [ASCII Login](#name-ascii-login)

```

    action = TAC_PLUS_AUTHEN_LOGIN
    authen_type = TAC_PLUS_AUTHEN_TYPE_ASCII
    minor_version = 0x0

```
[¬∂](#section-5.4.2.1-1)

This is a standard ASCII authentication. The START packet
MAY contain the username. If the user does not include
the username, then the server MUST obtain it from the
client with a CONTINUE TAC\_PLUS\_AUTHEN\_STATUS\_GETUSER. If the user
does not provide a username, then the server can send another
TAC\_PLUS\_AUTHEN\_STATUS\_GETUSER request, but the server
MUST limit the number of retries that are permitted;
the recommended limit is three attempts. When the server has the
username, it will obtain the password using a continue with
TAC\_PLUS\_AUTHEN\_STATUS\_GETPASS. ASCII login uses the user\_msg field
for both the username and password. The data fields in both the START
and CONTINUE packets are not used for ASCII logins; any content
MUST be ignored. The session is composed of a single
START followed by zero or more pairs of REPLYs and CONTINUEs, followed
by a final REPLY indicating PASS, FAIL, or ERROR.[¬∂](#section-5.4.2.1-2)

##### [5.4.2.2.](#section-5.4.2.2) [PAP Login](#name-pap-login)

```

    action = TAC_PLUS_AUTHEN_LOGIN
    authen_type = TAC_PLUS_AUTHEN_TYPE_PAP
    minor_version = 0x1

```
[¬∂](#section-5.4.2.2-1)

The entire exchange MUST consist of a single START
packet and a single REPLY. The START packet MUST
contain a username and the data field MUST contain the
PAP ASCII password. A PAP authentication only consists of a username
and password [[RFC1334](#RFC1334)] (Obsolete). The
REPLY from the server MUST be either a PASS, FAIL, or
ERROR.[¬∂](#section-5.4.2.2-2)

##### [5.4.2.3.](#section-5.4.2.3) [CHAP Login](#name-chap-login)

```

    action = TAC_PLUS_AUTHEN_LOGIN
    authen_type = TAC_PLUS_AUTHEN_TYPE_CHAP
    minor_version = 0x1

```
[¬∂](#section-5.4.2.3-1)

The entire exchange MUST consist of a single START
packet and a single REPLY. The START packet MUST
contain the username in the user field, and the data field is a
concatenation of the PPP id, the challenge, and the response.[¬∂](#section-5.4.2.3-2)

The length of the challenge value can be determined from the length of
the data field minus the length of the id (always 1 octet) and the
length of the response field (always 16 octets).[¬∂](#section-5.4.2.3-3)

To perform the authentication, the server calculates the PPP hash as defined
in PPP Authentication [[RFC1334](#RFC1334)] and then
compares that value with the response. The MD5 algorithm option is always
used. The REPLY from the server MUST be a PASS, FAIL, or
ERROR.[¬∂](#section-5.4.2.3-4)

The selection of the challenge and its length are not an aspect of the
TACACS+ protocol. However, it is strongly recommended that the
client/endstation interaction be configured with a secure
challenge. The TACACS+ server can help by rejecting authentications
where the challenge is below a minimum length (minimum recommended is
8 bytes).[¬∂](#section-5.4.2.3-5)

##### [5.4.2.4.](#section-5.4.2.4) [MS-CHAP v1 Login](#name-ms-chap-v1-login)

```

    action = TAC_PLUS_AUTHEN_LOGIN
    authen_type = TAC_PLUS_AUTHEN_TYPE_MSCHAP
    minor_version = 0x1

```
[¬∂](#section-5.4.2.4-1)

The entire exchange MUST consist of a single START packet and a
single REPLY. The START packet MUST contain the username in the
user field, and the data field will be a concatenation of the PPP id, the
MS-CHAP challenge, and the MS-CHAP response.[¬∂](#section-5.4.2.4-2)

The length of the challenge value can be determined from the length of the
data field minus the length of the id (always 1 octet) and the length of the
response field (always 49 octets).[¬∂](#section-5.4.2.4-3)

To perform the authentication, the server will use a combination of MD4 and
DES on the user's secret and the challenge, as defined in [[RFC2433](#RFC2433)], and then compare the
resulting value with the response. The REPLY from the server
MUST be a PASS or FAIL.[¬∂](#section-5.4.2.4-4)

For best practices, please refer to [[RFC2433](#RFC2433)]. The TACACS+ server MUST reject
authentications where the challenge deviates from 8 bytes as defined
in the RFC.[¬∂](#section-5.4.2.4-5)

##### [5.4.2.5.](#section-5.4.2.5) [MS-CHAP v2 Login](#name-ms-chap-v2-login)

```

    action = TAC_PLUS_AUTHEN_LOGIN
    authen_type = TAC_PLUS_AUTHEN_TYPE_MSCHAPV2
    minor_version = 0x1

```
[¬∂](#section-5.4.2.5-1)

The entire exchange MUST consist of a single START packet and a
single REPLY. The START packet MUST contain the username in the
user field, and the data field will be a concatenation of the PPP id, the
MS-CHAP challenge, and the MS-CHAP response.[¬∂](#section-5.4.2.5-2)

The length of the challenge value can be determined from the length of the
data field minus the length of the id (always 1 octet) and the length of the
response field (always 49 octets).[¬∂](#section-5.4.2.5-3)

To perform the authentication, the server will use the algorithm specified
[[RFC2759](#RFC2759)] on the user's secret and challenge,
and then compare the resulting value with the response. The REPLY from the
server MUST be a PASS or FAIL.[¬∂](#section-5.4.2.5-4)

For best practices for MS-CHAP v2, please refer to [[RFC2759](#RFC2759)]. The TACACS+ server MUST reject
authentications where the challenge deviates from 16 bytes as defined in the
RFC.[¬∂](#section-5.4.2.5-5)

##### [5.4.2.6.](#section-5.4.2.6) [Enable Requests](#name-enable-requests)

```

    action = TAC_PLUS_AUTHEN_LOGIN
    priv_lvl = implementation dependent
    authen_type = not used
    service = TAC_PLUS_AUTHEN_SVC_ENABLE

```
[¬∂](#section-5.4.2.6-1)

This is an "ENABLE" request, used to change the current running
privilege level of a user. The exchange MAY consist of
multiple messages while the server collects the information it
requires in order to allow changing the principal's privilege
level. This exchange is very similar to an ASCII login ([Section 5.4.2.1](#ASCIILogin)).[¬∂](#section-5.4.2.6-2)

In order to readily distinguish "ENABLE" requests from other types of request,
the value of the authen\_service field MUST be set to
TAC\_PLUS\_AUTHEN\_SVC\_ENABLE when requesting an ENABLE. It MUST NOT be set to this value when requesting any other operation.[¬∂](#section-5.4.2.6-3)

##### [5.4.2.7.](#section-5.4.2.7) [ASCII Change Password Request](#name-ascii-change-password-reque)

```

action = TAC_PLUS_AUTHEN_CHPASS
authen_type = TAC_PLUS_AUTHEN_TYPE_ASCII

```
[¬∂](#section-5.4.2.7-1)

This exchange consists of multiple messages while the server collects
the information it requires in order to change the user's password. It
is very similar to an ASCII login. The status value
TAC\_PLUS\_AUTHEN\_STATUS\_GETPASS MUST only be used when
requesting the "new" password. It MAY be sent multiple
times. When requesting the "old" password, the status value
MUST be set to TAC\_PLUS\_AUTHEN\_STATUS\_GETDATA.[¬∂](#section-5.4.2.7-2)

#### [5.4.3.](#section-5.4.3) [Aborting an Authentication Session](#name-aborting-an-authentication-)

The client may prematurely terminate a session by setting the
TAC\_PLUS\_CONTINUE\_FLAG\_ABORT flag in the CONTINUE message. If this flag is
set, the data portion of the message may contain a text explaining the reason
for the abort. This text will be handled by the server according to the
requirements of the deployment. For details of text encoding, see "Treatment
of Text Strings" ([Section 3.7](#TextEncoding)). For more
details about session termination, refer to "Session Completion" ([Section 4.4](#SessionCompletion)).[¬∂](#section-5.4.3-1)

In cases of PASS, FAIL, or ERROR, the server can insert a message into
server\_msg to be displayed to the user.[¬∂](#section-5.4.3-2)

"The Draft" [[THE-DRAFT](#THE-DRAFT)]
defined a mechanism to direct authentication requests to an
alternative server. This mechanism is regarded as insecure, is
deprecated, and is not covered here. The client should treat
TAC\_PLUS\_AUTHEN\_STATUS\_FOLLOW as TAC\_PLUS\_AUTHEN\_STATUS\_FAIL.[¬∂](#section-5.4.3-3)

If the status equals TAC\_PLUS\_AUTHEN\_STATUS\_ERROR, then the host is
indicating that it is experiencing an unrecoverable error and the
authentication will proceed as if that host could not be contacted.
The data field may contain a message to be printed on an
administrative console or log.[¬∂](#section-5.4.3-4)

If the status equals TAC\_PLUS\_AUTHEN\_STATUS\_RESTART, then the
authentication sequence is restarted with a new START packet from the
client, with a new session Id and seq\_no set to 1. This REPLY packet
indicates that the current authen\_type value (as specified in the
START packet) is not acceptable for this session. The client may try
an alternative authen\_type.[¬∂](#section-5.4.3-5)

If a client does not implement the TAC\_PLUS\_AUTHEN\_STATUS\_RESTART option,
then it MUST process the response as if the status was
TAC\_PLUS\_AUTHEN\_STATUS\_FAIL.[¬∂](#section-5.4.3-6)

## [6.](#section-6) [Authorization](#name-authorization)

In the TACACS+ protocol, authorization is the action of determining
what a user is allowed to do. Generally, authentication precedes
authorization, though it is not mandatory that a client use the same
service for authentication that it will use for authorization. An
authorization request may indicate that the user is not authenticated
(we don't know who they are). In this case, it is up to the server to
determine, according to its configuration, if an unauthenticated user is
allowed the services in question.[¬∂](#section-6-1)

Authorization does not merely provide yes or no answers, but it may also
customize the service for the particular user. A common use of authorization
is to provision a shell session when a user first logs into a device to
administer it. The TACACS+ server might respond to the request by allowing the
service, but placing a time restriction on the login shell. For a list of
common arguments used in authorization, see "Authorization Arguments" ([Section 8.2](#AuthorizationAttributes)).[¬∂](#section-6-2)

In the TACACS+ protocol, an authorization is always a single pair of messages:
a REQUEST from the client followed by a REPLY from the server.[¬∂](#section-6-3)

The authorization REQUEST message contains a fixed set of fields that indicate
how the user was authenticated and a variable set of arguments that describe
the services and options for which authorization is requested.[¬∂](#section-6-4)

The REPLY contains a variable set of response arguments (argument-value pairs)
that can restrict or modify the client's actions.[¬∂](#section-6-5)

### [6.1.](#section-6.1) [The Authorization REQUEST Packet Body](#name-the-authorization-request-p)

```

  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
+----------------+----------------+----------------+----------------+
|  authen_method |    priv_lvl    |  authen_type   | authen_service |
+----------------+----------------+----------------+----------------+
|    user_len    |    port_len    |  rem_addr_len  |    arg_cnt     |
+----------------+----------------+----------------+----------------+
|   arg_1_len    |   arg_2_len    |      ...       |   arg_N_len    |
+----------------+----------------+----------------+----------------+
|   user ...
+----------------+----------------+----------------+----------------+
|   port ...
+----------------+----------------+----------------+----------------+
|   rem_addr ...
+----------------+----------------+----------------+----------------+
|   arg_1 ...
+----------------+----------------+----------------+----------------+
|   arg_2 ...
+----------------+----------------+----------------+----------------+
|   ...
+----------------+----------------+----------------+----------------+
|   arg_N ...
+----------------+----------------+----------------+----------------+

```
[¬∂](#section-6.1-1)

authen\_method[¬∂](#section-6.1-2)

* This field allows the client to indicate the authentication method used to
  acquire user information.[¬∂](#section-6.1-3.1.1)
* TAC\_PLUS\_AUTHEN\_METH\_NOT\_SET := 0x00[¬∂](#section-6.1-3.2)
* TAC\_PLUS\_AUTHEN\_METH\_NONE :=
  0x01[¬∂](#section-6.1-3.3)
* TAC\_PLUS\_AUTHEN\_METH\_KRB5 := 0x02[¬∂](#section-6.1-3.4)
* TAC\_PLUS\_AUTHEN\_METH\_LINE :=
  0x03[¬∂](#section-6.1-3.5)
* TAC\_PLUS\_AUTHEN\_METH\_ENABLE := 0x04[¬∂](#section-6.1-3.6)
* TAC\_PLUS\_AUTHEN\_METH\_LOCAL
  := 0x05[¬∂](#section-6.1-3.7)
* TAC\_PLUS\_AUTHEN\_METH\_TACACSPLUS := 0x06[¬∂](#section-6.1-3.8)
* TAC\_PLUS\_AUTHEN\_METH\_GUEST := 0x08[¬∂](#section-6.1-3.9)
* TAC\_PLUS\_AUTHEN\_METH\_RADIUS :=
  0x10[¬∂](#section-6.1-3.10)
* TAC\_PLUS\_AUTHEN\_METH\_KRB4 := 0x11[¬∂](#section-6.1-3.11)
* TAC\_PLUS\_AUTHEN\_METH\_RCMD :=
  0x20[¬∂](#section-6.1-3.12)
* As this information is not always subject to verification, it MUST NOT be used in policy evaluation. LINE refers to a
  fixed password associated with the terminal line used to gain access.
  LOCAL is a client local user database. ENABLE is a command that
  authenticates in order to grant new privileges. TACACSPLUS is, of
  course, TACACS+. GUEST is an unqualified guest authentication. RADIUS
  is the RADIUS authentication protocol. RCMD refers to authentication
  provided via the R-command protocols from Berkeley Unix.
  KRB5 [[RFC4120](#RFC4120)] and KRB4 [[KRB4](#KRB4)]
  are Kerberos versions 5 and 4.[¬∂](#section-6.1-3.13.1)
* As mentioned above, this field is used by the client to indicate how
  it performed the authentication. One of the options
  (TAC\_PLUS\_AUTHEN\_METH\_TACACSPLUS := 0x06) is TACACS+ itself, and so the detail
  of how the client performed this option is given in "Authentication" ([Section 5](#Authentication)). For all other options,
  such as KRB and RADIUS, the TACACS+ protocol did not play any part in the
  authentication phase; as those interactions were not conducted using the
  TACACS+ protocol, they will not be documented here. For implementers of
  clients who need details of the other protocols, please refer to the
  respective Kerberos [[RFC4120](#RFC4120)] and RADIUS
  [[RFC3579](#RFC3579)] RFCs.[¬∂](#section-6.1-3.14.1)

priv\_lvl[¬∂](#section-6.1-4)

* This field is used in the same way as the priv\_lvl field in authentication
  request and is described in "Privilege Levels" ([Section 9](#PrivilegeLevel)). It indicates the user's
  current privilege level.[¬∂](#section-6.1-5.1.1)

authen\_type[¬∂](#section-6.1-6)

* This field corresponds to the authen\_type field in "Authentication" ([Section 5](#Authentication)). It indicates
  the type of authentication that was performed. If this information is not
  available, then the client will set authen\_type to
  TAC\_PLUS\_AUTHEN\_TYPE\_NOT\_SET := 0x00. This value is valid only in
  authorization and accounting requests.[¬∂](#section-6.1-7.1.1)

authen\_service[¬∂](#section-6.1-8)

* This field is the same as the authen\_service field in "Authentication" ([Section 5](#Authentication)). It indicates
  the service through which the user authenticated.[¬∂](#section-6.1-9.1.1)

user, user\_len[¬∂](#section-6.1-10)

* This field contains the user's account name. The user\_len MUST
  indicate the length of the user field, in bytes.[¬∂](#section-6.1-11.1.1)

port, port\_len[¬∂](#section-6.1-12)

* This field matches the port field in "Authentication" ([Section 5](#Authentication)). The port\_len
  indicates the length of the port field, in bytes.[¬∂](#section-6.1-13.1.1)

rem\_addr, rem\_addr\_len[¬∂](#section-6.1-14)

* This field matches the rem\_addr field in "Authentication" ([Section 5](#Authentication)). The rem\_addr\_len indicates the
  length of the port field, in bytes.[¬∂](#section-6.1-15.1.1)

arg\_cnt[¬∂](#section-6.1-16)

* This represents the number of authorization arguments to follow.[¬∂](#section-6.1-17.1.1)

arg\_1 ... arg\_N, arg\_1\_len .... arg\_N\_len[¬∂](#section-6.1-18)

* These arguments are the primary elements of the authorization
  interaction. In the request packet, they describe the specifics of the
  authorization that is being requested. Each argument is encoded in
  the packet as a single arg field (arg\_1... arg\_N) with a
  corresponding length field (which indicates the length of each
  argument in bytes).[¬∂](#section-6.1-19.1.1)
* The authorization arguments in both the REQUEST and the REPLY are
  argument-value pairs. The argument and the value are in a single
  string and are separated by either a "=" (0X3D) or a "\*" (0X2A). The
  equals sign indicates a mandatory argument. The asterisk indicates an
  optional one. For details of text encoding, see "Treatment of Text Strings" ([Section 3.7](#TextEncoding)).[¬∂](#section-6.1-19.2.1)
* An argument name MUST NOT contain either of the
  separators. An argument value MAY contain the
  separators. This means that the arguments must be parsed until the
  first separator is encountered; all characters in the argument, after
  this separator, are interpreted as the argument value.[¬∂](#section-6.1-19.3.1)
* Optional arguments are ones that may be disregarded by either client
  or server. Mandatory arguments require that the receiving side can
  handle the argument, that is, its implementation and configuration
  includes the details of how to act on it. If the client receives a
  mandatory argument that it cannot handle, it MUST
  consider the authorization to have failed. The value part of an
  argument-value pair may be empty, that is, the length of the value may
  be zero.[¬∂](#section-6.1-19.4.1)
* Argument-value strings are not NULL terminated; rather, their length
  value indicates their end. The maximum length of an argument-value
  string is 255 characters. The minimum is two characters (one
  name-value character and the separator).[¬∂](#section-6.1-19.5.1)
* Though the arguments allow extensibility, a common core set of authorization
  arguments SHOULD be supported by clients and servers; these are
  listed in "Authorization Arguments" ([Section 8.2](#AuthorizationAttributes)).[¬∂](#section-6.1-19.6.1)

### [6.2.](#section-6.2) [The Authorization REPLY Packet Body](#name-the-authorization-reply-pac)

```

 1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
+----------------+----------------+----------------+----------------+
|    status      |     arg_cnt    |         server_msg len          |
+----------------+----------------+----------------+----------------+
+            data_len             |    arg_1_len   |    arg_2_len   |
+----------------+----------------+----------------+----------------+
|      ...       |   arg_N_len    |         server_msg ...
+----------------+----------------+----------------+----------------+
|   data ...
+----------------+----------------+----------------+----------------+
|   arg_1 ...
+----------------+----------------+----------------+----------------+
|   arg_2 ...
+----------------+----------------+----------------+----------------+
|   ...
+----------------+----------------+----------------+----------------+
|   arg_N ...
+----------------+----------------+----------------+----------------+

```
[¬∂](#section-6.2-1)

status[¬∂](#section-6.2-2)

* This field indicates the authorization status.[¬∂](#section-6.2-3.1.1)
* TAC\_PLUS\_AUTHOR\_STATUS\_PASS\_ADD := 0x01[¬∂](#section-6.2-3.2.1)

  If the status equals
  TAC\_PLUS\_AUTHOR\_STATUS\_PASS\_ADD, then the arguments specified
  in the request are authorized and the arguments in the
  response MUST be applied according to the rules
  described above.[¬∂](#section-6.2-3.2.2)

  To approve the authorization with no modifications, the
  server sets the status to TAC\_PLUS\_AUTHOR\_STATUS\_PASS\_ADD and
  the arg\_cnt to 0.[¬∂](#section-6.2-3.2.3)
* TAC\_PLUS\_AUTHOR\_STATUS\_PASS\_REPL := 0x02[¬∂](#section-6.2-3.3.1)

  If the status equals
  TAC\_PLUS\_AUTHOR\_STATUS\_PASS\_REPL, then the client
  MUST use the authorization argument-value pairs
  (if any) in the response instead of the authorization
  argument-value pairs from the request.[¬∂](#section-6.2-3.3.2)
* TAC\_PLUS\_AUTHOR\_STATUS\_FAIL := 0x10[¬∂](#section-6.2-3.4.1)

  If the status equals
  TAC\_PLUS\_AUTHOR\_STATUS\_FAIL, then the requested authorization
  MUST be denied.[¬∂](#section-6.2-3.4.2)
* TAC\_PLUS\_AUTHOR\_STATUS\_ERROR := 0x11[¬∂](#section-6.2-3.5.1)

  A status of TAC\_PLUS\_AUTHOR\_STATUS\_ERROR
  indicates an error occurred on the server. For the differences
  between ERROR and FAIL, refer to "Session Completion" ([Section 4.4](#SessionCompletion)). None of
  the arg values have any relevance if an ERROR is set and must
  be ignored.[¬∂](#section-6.2-3.5.2)
* TAC\_PLUS\_AUTHOR\_STATUS\_FOLLOW := 0x21[¬∂](#section-6.2-3.6.1)

  When the status equals
  TAC\_PLUS\_AUTHOR\_STATUS\_FOLLOW, the arg\_cnt MUST
  be 0. In that case, the actions to be taken and the contents
  of the data field are identical to the
  TAC\_PLUS\_AUTHEN\_STATUS\_FOLLOW status for authentication.[¬∂](#section-6.2-3.6.2)

server\_msg, server\_msg\_len[¬∂](#section-6.2-4)

* This is a string that may be presented to the user. The server\_msg\_len
  indicates the length of the server\_msg field, in bytes. For details of
  text encoding, see "Treatment of Text Strings" ([Section 3.7](#TextEncoding)).[¬∂](#section-6.2-5.1.1)

data, data\_len[¬∂](#section-6.2-6)

* This is a string that may be presented on an administrative display, console,
  or log. The decision to present this message is client specific. The data\_len
  indicates the length of the data field, in bytes. For details of text
  encoding, see "Treatment of Text Strings" ([Section 3.7](#TextEncoding)).[¬∂](#section-6.2-7.1.1)

arg\_cnt[¬∂](#section-6.2-8)

* This represents the number of authorization arguments to follow.[¬∂](#section-6.2-9.1.1)

arg\_1 ... arg\_N, arg\_1\_len .... arg\_N\_len[¬∂](#section-6.2-10)

* The arguments describe the specifics of the authorization that is
  being requested. For details of the content of the args, refer to
  "Authorization Arguments" ([Section 8.2](#AuthorizationAttributes)). Each argument is encoded in the packet as a
  single arg field (arg\_1... arg\_N) with a corresponding length field
  (which indicates the length of each argument in bytes).[¬∂](#section-6.2-11.1.1)

## [7.](#section-7) [Accounting](#name-accounting)

Accounting is typically the third action after authentication and
authorization. But again, neither authentication nor authorization is
required. Accounting is the action of recording what a user is doing
and/or has done. Accounting in TACACS+ can serve two purposes: it may
be used as an auditing tool for security services, and it may also be
used to account for services used such as in a billing
environment. To this end, TACACS+ supports three types of accounting
records: Start records indicate that a service is about to begin, Stop
records indicate that a service has just terminated, and Update
records are intermediate notices that indicate that a service is still
being performed. TACACS+ accounting records contain all the
information used in the authorization records and also contain
accounting-specific information such as start and stop times (when
appropriate) and resource usage information. A list of accounting
arguments is defined in "Accounting Arguments" ([Section 8.3](#AccountingAttributes)).[¬∂](#section-7-1)

### [7.1.](#section-7.1) [The Account REQUEST Packet Body](#name-the-account-request-packet-)

```

 1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
+----------------+----------------+----------------+----------------+
|      flags     |  authen_method |    priv_lvl    |  authen_type   |
+----------------+----------------+----------------+----------------+
| authen_service |    user_len    |    port_len    |  rem_addr_len  |
+----------------+----------------+----------------+----------------+
|    arg_cnt     |   arg_1_len    |   arg_2_len    |      ...       |
+----------------+----------------+----------------+----------------+
|   arg_N_len    |    user ...
+----------------+----------------+----------------+----------------+
|   port ...
+----------------+----------------+----------------+----------------+
|   rem_addr ...
+----------------+----------------+----------------+----------------+
|   arg_1 ...
+----------------+----------------+----------------+----------------+
|   arg_2 ...
+----------------+----------------+----------------+----------------+
|   ...
+----------------+----------------+----------------+----------------+
|   arg_N ...
+----------------+----------------+----------------+----------------+

```
[¬∂](#section-7.1-1)

flags[¬∂](#section-7.1-2)

* This holds bitmapped flags.[¬∂](#section-7.1-3.1.1)
* Valid values are:[¬∂](#section-7.1-3.2.1)
* TAC\_PLUS\_ACCT\_FLAG\_START := 0x02[¬∂](#section-7.1-3.3)
* TAC\_PLUS\_ACCT\_FLAG\_STOP := 0x04[¬∂](#section-7.1-3.4)
* TAC\_PLUS\_ACCT\_FLAG\_WATCHDOG := 0x08[¬∂](#section-7.1-3.5)

All other fields are defined in "Authentication" ([Section 5](#Authentication)) and "Authorization" ([Section 6](#Authorization)) and have the same
semantics. They provide details for the conditions on the client, and
authentication context, so that these details may be logged for
accounting purposes.[¬∂](#section-7.1-4)

See "Accounting Arguments" ([Section 8.3](#AccountingAttributes)) for
the dictionary of arguments relevant to accounting.[¬∂](#section-7.1-5)

### [7.2.](#section-7.2) [The Accounting REPLY Packet Body](#name-the-accounting-reply-packet)

The purpose of accounting is to record the action that has occurred on
the client. The server MUST reply with success only
when the accounting request has been recorded. If the server did not
record the accounting request, then it MUST reply with
ERROR.[¬∂](#section-7.2-1)

```

 1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
+----------------+----------------+----------------+----------------+
|         server_msg len          |            data_len             |
+----------------+----------------+----------------+----------------+
|     status     |         server_msg ...
+----------------+----------------+----------------+----------------+
|     data ...
+----------------+

```
[¬∂](#section-7.2-2)

status[¬∂](#section-7.2-3)

* This is the return status.[¬∂](#section-7.2-4.1.1)
* Values are:[¬∂](#section-7.2-4.2.1)
* TAC\_PLUS\_ACCT\_STATUS\_SUCCESS := 0x01[¬∂](#section-7.2-4.3)
* TAC\_PLUS\_ACCT\_STATUS\_ERROR :=
  0x02[¬∂](#section-7.2-4.4)
* TAC\_PLUS\_ACCT\_STATUS\_FOLLOW := 0x21[¬∂](#section-7.2-4.5.1)

  When the status equals
  TAC\_PLUS\_ACCT\_STATUS\_FOLLOW, the
  actions to be taken and the contents
  of the data field are identical to the
  TAC\_PLUS\_AUTHEN\_STATUS\_FOLLOW status
  for authentication.[¬∂](#section-7.2-4.5.2)

server\_msg, server\_msg\_len[¬∂](#section-7.2-5)

* This is a string that may be presented to the user. The server\_msg\_len
  indicates the length of the server\_msg field, in bytes. For details of
  text encoding, see "Treatment of Text Strings" ([Section 3.7](#TextEncoding)).[¬∂](#section-7.2-6.1.1)

data, data\_len[¬∂](#section-7.2-7)

* This is a string that may be presented on an administrative display,
  console, or log. The decision to present this message is client
  specific. The data\_len indicates the length of the data field, in
  bytes. For details of text encoding, see "Treatment of Text Strings" ([Section 3.7](#TextEncoding)).[¬∂](#section-7.2-8.1.1)

TACACS+ accounting is intended to record various types of events on clients,
for example: login sessions, command entry, and others as required by the
client implementation. These events are collectively referred to in "The
Draft" [[THE-DRAFT](#THE-DRAFT)] as "tasks".[¬∂](#section-7.2-9)

The TAC\_PLUS\_ACCT\_FLAG\_START flag indicates that this is a start
accounting message. Start messages will only be sent once when a task
is started. The TAC\_PLUS\_ACCT\_FLAG\_STOP indicates that this is a stop
record and that the task has terminated. The
TAC\_PLUS\_ACCT\_FLAG\_WATCHDOG flag means that this is an update record.[¬∂](#section-7.2-10)

[Table 2](#table-2):
[Summary of Accounting Packets](#name-summary-of-accounting-packe)

| Watchdog | Stop | Start | Flags & 0xE | Meaning |
| --- | --- | --- | --- | --- |
| 0 | 0 | 0 | 0 | INVALID |
| 0 | 0 | 1 | 2 | Start Accounting Record |
| 0 | 1 | 0 | 4 | Stop Accounting Record |
| 0 | 1 | 1 | 6 | INVALID |
| 1 | 0 | 0 | 8 | Watchdog, no update |
| 1 | 0 | 1 | A | Watchdog, with update |
| 1 | 1 | 0 | C | INVALID |
| 1 | 1 | 1 | E | INVALID |

The START and STOP flags are mutually
exclusive.[¬∂](#section-7.2-12)

The WATCHDOG flag is used by the client to communicate ongoing
status of a long-running task. Update records are sent at the client's
discretion. The frequency of the update depends upon the intended
application: a watchdog to provide progress indication will require
higher frequency than a daily keep-alive. When the WATCHDOG flag is
set along with the START flag, it indicates that the update record
provides additional or updated arguments from the original START
record. If the START flag is not set, then this indicates only that
task is still running, and no new information is provided (servers
MUST ignore any arguments). The STOP flag MUST NOT be set in conjunction with the WATCHDOG flag.[¬∂](#section-7.2-13)

The server MUST respond
with TAC\_PLUS\_ACCT\_STATUS\_ERROR if the
client requests an INVALID option.[¬∂](#section-7.2-14)

## [8.](#section-8) [Argument-Value Pairs](#name-argument-value-pairs)

TACACS+ is intended to be an extensible
protocol. The arguments used in Authorization
and Accounting are not limited by this
document. Some arguments are defined below
for common use cases. Clients
MUST use these arguments when
supporting the corresponding use cases.[¬∂](#section-8-1)

### [8.1.](#section-8.1) [Value Encoding](#name-value-encoding)

All argument values are encoded as strings. For details of text
encoding, see "Treatment of Text Strings" ([Section 3.7](#TextEncoding)). The
following type representations SHOULD be followed.[¬∂](#section-8.1-1)

Numeric[¬∂](#section-8.1-2)

* All numeric values in an argument-value string are provided as decimal
  numbers, unless otherwise stated. All arguments include a length
  field, and TACACS+ implementations MUST verify that
  they can accommodate the lengths of numeric arguments before
  attempting to process them. If the length cannot be accommodated, then
  the argument MUST be regarded as not handled and the
  logic in "Authorization" ([Section 6.1](#TheAuthorizationREQUESTPacketBody)) regarding the processing
  of arguments MUST be applied.[¬∂](#section-8.1-3.1.1)

Boolean[¬∂](#section-8.1-4)

* All Boolean arguments are encoded with
  values "true" or "false".[¬∂](#section-8.1-5.1.1)

IP-Address[¬∂](#section-8.1-6)

* It is recommended that hosts be specified as an IP address so as to avoid any
  ambiguities. For details of text encoding, see "Treatment of Text Strings" ([Section 3.7](#TextEncoding)). IPv4 addresses are specified as octet numerics separated by
  dots ('.'). IPv6 address text representation is defined in [[RFC5952](#RFC5952)].[¬∂](#section-8.1-7.1.1)

Date Time[¬∂](#section-8.1-8)

* Absolute date/times are specified in seconds since the epoch, 12:00am,
  January 1, 1970. The time zone MUST be UTC
  unless a time zone
  argument is specified.[¬∂](#section-8.1-9.1.1)

String[¬∂](#section-8.1-10)

* Many values have no specific type representation and are
  interpreted as plain strings.[¬∂](#section-8.1-11.1.1)

Empty Values[¬∂](#section-8.1-12)

* Arguments may be submitted with no value, in which case they consist of the
  name and the mandatory or optional separator. For example, the argument "cmd",
  which has no value, is transmitted as a string of four characters "cmd=".[¬∂](#section-8.1-13.1.1)

### [8.2.](#section-8.2) [Authorization Arguments](#name-authorization-arguments)

service (String)[¬∂](#section-8.2-1)

* The primary service. Specifying a service argument indicates that this is a
  request for authorization or accounting of that service. For example:
  "shell", "tty-server", "connection", "system" and "firewall"; others may be
  chosen for the required application. This argument MUST always
  be included.[¬∂](#section-8.2-2.1.1)

protocol (String)[¬∂](#section-8.2-3)

* A field that may be used to indicate a subset of a service.[¬∂](#section-8.2-4.1.1)

cmd (String)[¬∂](#section-8.2-5)

* A shell (exec) command. This indicates the command name of the command that is
  to be run. The "cmd" argument MUST be specified if service
  equals "shell".[¬∂](#section-8.2-6.1.1)
* Authorization of shell commands is a common use case for the
  TACACS+ protocol. Command Authorization generally takes one of two
  forms: session based or command based.[¬∂](#section-8.2-6.2.1)
* For session-based shell authorization, the "cmd" argument will have
  an empty value. The client determines which commands are allowed in a
  session according to the arguments present in the authorization.[¬∂](#section-8.2-6.3.1)
* In command-based authorization, the client requests that the server
  determine whether a command is allowed by making an authorization
  request for each command. The "cmd" argument will have the command
  name as its value.[¬∂](#section-8.2-6.4.1)

cmd-arg (String)[¬∂](#section-8.2-7)

* An argument to a shell (exec) command. This indicates an argument for
  the shell command that is to be run. Multiple cmd-arg arguments may
  be specified, and they are order dependent.[¬∂](#section-8.2-8.1.1)

acl (Numeric)[¬∂](#section-8.2-9)

* A number representing a connection access list. Applicable only to
  session-based shell authorization. For details of text encoding, see
  "Treatment of Text Strings" ([Section 3.7](#TextEncoding)).[¬∂](#section-8.2-10.1.1)

inacl (String)[¬∂](#section-8.2-11)

* The identifier (name) of an interface input access list. For details of text
  encoding, see "Treatment of Text Strings" ([Section 3.7](#TextEncoding)).[¬∂](#section-8.2-12.1.1)

outacl (String)[¬∂](#section-8.2-13)

* The identifier (name) of an interface output access list. For details of text
  encoding, see "Treatment of Text Strings" ([Section 3.7](#TextEncoding)).[¬∂](#section-8.2-14.1.1)

addr (IP-Address)[¬∂](#section-8.2-15)

* A network address.[¬∂](#section-8.2-16.1.1)

addr-pool (String)[¬∂](#section-8.2-17)

* The identifier of an address pool from which the client can assign an
  address.[¬∂](#section-8.2-18.1.1)

timeout (Numeric)[¬∂](#section-8.2-19)

* An absolute timer for the connection (in minutes). A value of zero
  indicates no timeout.[¬∂](#section-8.2-20.1.1)

idletime (Numeric)[¬∂](#section-8.2-21)

* An idle-timeout for the connection (in minutes). A value of zero
  indicates no timeout.[¬∂](#section-8.2-22.1.1)

autocmd (String)[¬∂](#section-8.2-23)

* An auto-command to run. Applicable only to session-based shell authorization.[¬∂](#section-8.2-24.1.1)

noescape (Boolean)[¬∂](#section-8.2-25)

* Prevents the user from using an escape character. Applicable only to
  session-based shell authorization.[¬∂](#section-8.2-26.1.1)

nohangup (Boolean)[¬∂](#section-8.2-27)

* Boolean. Do not disconnect after an automatic command. Applicable
  only to session-based shell authorization.[¬∂](#section-8.2-28.1.1)

priv-lvl (Numeric)[¬∂](#section-8.2-29)

* The privilege level to be assigned. Please refer to "Privilege Levels" ([Section 9](#PrivilegeLevel)).[¬∂](#section-8.2-30.1.1)

### [8.3.](#section-8.3) [Accounting Arguments](#name-accounting-arguments)

The following arguments are defined for TACACS+ accounting only. They
MUST precede any argument-value pairs that are defined
in "Authorization" ([Section 6](#Authorization)).[¬∂](#section-8.3-1)

task\_id (String)[¬∂](#section-8.3-2)

* Start and stop records for the same event MUST have
  matching task\_id argument values. The client MUST
  ensure that active task\_ids are not duplicated; a client MUST NOT reuse a task\_id in a start record until it has sent a stop
  record for that task\_id. Servers MUST NOT make
  assumptions about the format of a task\_id.[¬∂](#section-8.3-3.1.1)

start\_time (Date Time)[¬∂](#section-8.3-4)

* The time the action started (in seconds since the epoch).[¬∂](#section-8.3-5.1.1)

stop\_time (Date Time)[¬∂](#section-8.3-6)

* The time the action stopped (in seconds since the epoch).[¬∂](#section-8.3-7.1.1)

elapsed\_time (Numeric)[¬∂](#section-8.3-8)

* The elapsed time in seconds for the action.[¬∂](#section-8.3-9.1.1)

timezone (String)[¬∂](#section-8.3-10)

* The time zone abbreviation for all timestamps included in this packet. A
  database of time zones is maintained in [[TZDB](#TZDB)].[¬∂](#section-8.3-11.1.1)

event (String)[¬∂](#section-8.3-12)

* Used only when "service=system". Current values are "net\_acct", "cmd\_acct",
  "conn\_acct", "shell\_acct", "sys\_acct", and "clock\_change". These indicate
  system-level changes. The flags field SHOULD indicate whether
  the service started or stopped.[¬∂](#section-8.3-13.1.1)

reason (String)[¬∂](#section-8.3-14)

* Accompanies an event argument. It describes why the event occurred.[¬∂](#section-8.3-15.1.1)

bytes (Numeric)[¬∂](#section-8.3-16)

* The number of bytes transferred by this action.[¬∂](#section-8.3-17.1.1)

bytes\_in (Numeric)[¬∂](#section-8.3-18)

* The number of bytes transferred by this action from the endstation to
  the client port.[¬∂](#section-8.3-19.1.1)

bytes\_out (Numeric)[¬∂](#section-8.3-20)

* The number of bytes transferred by this action from the client
  to the endstation port.[¬∂](#section-8.3-21.1.1)

paks (Numeric)[¬∂](#section-8.3-22)

* The number of packets transferred by this action.[¬∂](#section-8.3-23.1.1)

paks\_in (Numeric)[¬∂](#section-8.3-24)

* The number of input packets transferred by this action from the endstation to
  the client port.[¬∂](#section-8.3-25.1.1)

paks\_out (Numeric)[¬∂](#section-8.3-26)

* The number of output packets transferred by this action from the client port
  to the endstation.[¬∂](#section-8.3-27.1.1)

err\_msg (String)[¬∂](#section-8.3-28)

* A string describing the status of the action. For details of text
  encoding, see "Treatment of Text Strings" ([Section 3.7](#TextEncoding)).[¬∂](#section-8.3-29.1.1)

Where the TACACS+ deployment is used to support the Device Administration
use case, it is often required to log all commands entered into client
devices. To support this mode of operation, TACACS+ client devices MUST be
configured to send an accounting start packet for every command entered,
irrespective of how the commands were authorized. These "Command Accounting"
packets MUST include the "service" and "cmd" arguments, and if needed, the
"cmd-arg" arguments detailed in [Section 8.2](#AuthorizationAttributes).[¬∂](#section-8.3-30)

## [9.](#section-9) [Privilege Levels](#name-privilege-levels)

The TACACS+ protocol supports flexible
authorization schemes through the extensible
arguments.[¬∂](#section-9-1)

The privilege levels scheme is built into the protocol and has been
extensively used as an option for Session-based shell authorization.
Privilege levels are ordered values from 0 to 15 with each level being a
superset of the next lower value. Configuration and implementation of the
client will map actions (such as the permission to execute specific commands)
to different privilege levels. The allocation of commands to privilege levels
is highly dependent upon the deployment. Common allocations are as follows:[¬∂](#section-9-2)

* TAC\_PLUS\_PRIV\_LVL\_MIN :=
  0x00. The level normally
  allocated to an
  unauthenticated session.[¬∂](#section-9-3.1)
* TAC\_PLUS\_PRIV\_LVL\_USER :=
  0x01. The level normally
  allocated to a regular
  authenticated session.[¬∂](#section-9-3.2)
* TAC\_PLUS\_PRIV\_LVL\_ROOT :=
  0x0f. The level normally
  allocated to a session
  authenticated by a highly
  privileged user to allow
  commands with significant
  system impact.[¬∂](#section-9-3.3)
* TAC\_PLUS\_PRIV\_LVL\_MAX :=
  0x0f. The highest privilege
  level.[¬∂](#section-9-3.4)

A privilege level can be assigned to a shell (exec) session when it
starts. The client will permit the actions associated with this level to be
executed. This privilege level is returned by the server in a session-based
shell authorization (when "service" equals "shell" and "cmd" is empty). When
a user is required to perform actions that are mapped to a higher privilege
level, an ENABLE-type reauthentication can be initiated by the client.
The client will insert the required privilege level into the authentication
header for ENABLE authentication requests.[¬∂](#section-9-4)

The use of privilege levels to determine session-based access to
commands and resources is not mandatory for clients. Although the
privilege-level scheme is widely supported, its lack of flexibility in
requiring a single monotonic hierarchy of permissions means that other
session-based command authorization schemes have evolved. However, it
is still common enough that it SHOULD be supported by
servers.[¬∂](#section-9-5)

## [10.](#section-10) [Security Considerations](#name-security-considerations)

"The Draft" [[THE-DRAFT](#THE-DRAFT)] from 1998 did not address all of the key security concerns
that are considered when designing modern standards. This section addresses
known limitations and concerns that will impact overall security of the
protocol and systems where this protocol is deployed to manage central
authentication, authorization, or accounting for network Device
Administration.[¬∂](#section-10-1)

Multiple implementations of the protocol described in
"The Draft" [[THE-DRAFT](#THE-DRAFT)]
have been deployed. As the protocol was never standardized, current
implementations may be incompatible in non-obvious ways, giving rise
to additional security risks. This section does not claim to enumerate
all possible security vulnerabilities.[¬∂](#section-10-2)

### [10.1.](#section-10.1) [General Security of the Protocol](#name-general-security-of-the-pro)

The TACACS+ protocol does not include a security mechanism that would meet
modern-day requirements. These security mechanisms would be best
referred to as "obfuscation" and not "encryption", since they provide
no meaningful integrity, privacy, or replay protection. An attacker
with access to the data stream should be assumed to be able to read
and modify all TACACS+ packets. Without mitigation, a range of risks
such as the following are possible:[¬∂](#section-10.1-1)

* Accounting information may be modified by the man-in-the-middle
  attacker, making such logs unsuitable and not trustable for auditing
  purposes.[¬∂](#section-10.1-2.1)
* Invalid or misleading values may be inserted by the man-in-the-middle
  attacker in various fields at known offsets to try and circumvent the
  authentication or authorization checks even inside the obfuscated
  body.[¬∂](#section-10.1-2.2)

While the protocol provides some measure of transport privacy, it is
vulnerable to at least the following attacks:[¬∂](#section-10.1-3)

* Brute-force attacks exploiting increased efficiency of MD5 digest computation.[¬∂](#section-10.1-4.1)
* Known plaintext attacks that may decrease the cost of brute-force
  attacks.[¬∂](#section-10.1-4.2)
* Chosen plaintext attacks that may decrease the cost of a brute-force
  attacks.[¬∂](#section-10.1-4.3)
* No forward secrecy.[¬∂](#section-10.1-4.4)

Even though, to the best knowledge of the authors, this method of encryption
wasn't rigorously tested, enough information is available that it is best
referred to as "obfuscation" and not "encryption".[¬∂](#section-10.1-5)

For these reasons, users deploying the TACACS+ protocol in their
environments MUST limit access to known clients and
MUST control the security of the entire transmission
path. Attackers who can guess the key or otherwise break the
obfuscation will gain unrestricted and undetected access to all
TACACS+ traffic. Ensuring that a centralized AAA system like TACACS+
is deployed on a secured transport is essential to managing the
security risk of such an attack.[¬∂](#section-10.1-6)

The following parts of this section
enumerate only the session-specific
risks that are in addition to general
risk associated with bare obfuscation
and lack of integrity checking.[¬∂](#section-10.1-7)

### [10.2.](#section-10.2) [Security of Authentication Sessions](#name-security-of-authentication-)

Authentication sessions SHOULD be used via a secure
transport (see "TACACS+ Best Practices" ([Section 10.5](#Bestpractices))) as the man-in-the-middle attack may
completely subvert them. Even CHAP, which may be considered resistant to password
interception, is unsafe as it does not protect the username from a
trivial man-in-the-middle attack.[¬∂](#section-10.2-1)

This document deprecates the redirection mechanism using the
TAC\_PLUS\_AUTHEN\_STATUS\_FOLLOW option, which was included in "The Draft". As
part of this process, the secret key for a new server was sent to the
client. This public exchange of secret keys means that once one session is
broken, it may be possible to leverage that key to attacking connections to
other servers.¬† This mechanism MUST NOT be used in modern
deployments. It MUST NOT be used outside a secured deployment.[¬∂](#section-10.2-2)

### [10.3.](#section-10.3) [Security of Authorization Sessions](#name-security-of-authorization-s)

Authorization sessions SHOULD be used via a secure
transport (see "TACACS+ Best Practices" ([Section 10.5](#Bestpractices))) as it's trivial to execute a successful
man-in-the-middle attack that changes well-known plaintext in either
requests or responses.[¬∂](#section-10.3-1)

As an example, take the field "authen\_method". It's not unusual in
actual deployments to authorize all commands received via the device
local serial port (a console port), as that one is usually considered
secure by virtue of the device located in a physically secure
location. If an administrator would configure the authorization system
to allow all commands entered by the user on a local console to aid in
troubleshooting, that would give all access to all commands to any
attacker that would be able to change the "authen\_method" from
TAC\_PLUS\_AUTHEN\_METH\_TACACSPLUS to TAC\_PLUS\_AUTHEN\_METH\_LINE. In this
regard, the obfuscation provided by the protocol itself wouldn't help
much, because:[¬∂](#section-10.3-2)

* A lack of integrity means that any byte in the payload may be changed
  without either side detecting the change.[¬∂](#section-10.3-3.1)
* Known plaintext means that an attacker would know with certainty which
  octet is the target of the attack (in this case, first octet after the
  header).[¬∂](#section-10.3-3.2)
* In combination with known plaintext, the attacker can determine with
  certainty the value of the crypto-pad octet used to obfuscate the
  original octet.[¬∂](#section-10.3-3.3)

### [10.4.](#section-10.4) [Security of Accounting Sessions](#name-security-of-accounting-sess)

Accounting sessions SHOULD be used via a secure
transport (see "TACACS+ Best Practices" ([Section 10.5](#Bestpractices))). Although Accounting sessions are not
directly involved in authentication or authorizing operations on the
device, man-in-the-middle attackers may do any of the following:[¬∂](#section-10.4-1)

* Replace accounting data with new valid values or garbage that can confuse
  auditors or hide information related to their authentication and/or
  authorization attack attempts.[¬∂](#section-10.4-2.1)
* Try and poison an accounting log with entries designed to make systems
  behave in unintended ways (these systems could be TACACS+ servers and any other
  systems that would manage accounting entries).[¬∂](#section-10.4-2.2)

In addition to these direct manipulations, different client
implementations pass a different fidelity of accounting data. Some
vendors have been observed in the wild that pass sensitive data like
passwords, encryption keys, and the like as part of the accounting log.
Due to a lack of strong encryption with perfect forward secrecy, this
data may be revealed in the future, leading to a security incident.[¬∂](#section-10.4-3)

### [10.5.](#section-10.5) [TACACS+ Best Practices](#name-tacacs-best-practices)

With respect to the observations about the security issues
described above, a network administrator MUST NOT
rely on the obfuscation of the TACACS+ protocol. TACACS+
MUST be used within a secure deployment; TACACS+
MUST be deployed over networks that ensure privacy and
integrity of the communication and MUST be deployed
over a network that is separated from other traffic. Failure to do
so will impact overall network security.[¬∂](#section-10.5-1)

The following recommendations impose restrictions on how the
protocol is applied. These restrictions were not imposed in "The
Draft". New implementations, and upgrades of current implementations,
MUST implement these recommendations. Vendors
SHOULD provide mechanisms to assist the administrator
to achieve these best practices.[¬∂](#section-10.5-2)

#### [10.5.1.](#section-10.5.1) [Shared Secrets](#name-shared-secrets)

TACACS+ servers and clients MUST treat shared
secrets as sensitive data to be managed securely, as would be
expected for other sensitive data such as identity credential
information. TACACS+ servers MUST NOT leak sensitive
data.[¬∂](#section-10.5.1-1)

For example:[¬∂](#section-10.5.1-2)

* TACACS+ servers MUST NOT expose shared secrets in
  logs.[¬∂](#section-10.5.1-3.1.1)
* TACACS+ servers MUST allow a dedicated secret key to be defined
  for each client.[¬∂](#section-10.5.1-3.2.1)
* TACACS+ server management systems MUST provide a
  mechanism to track secret key lifetimes and notify administrators to
  update them periodically. TACACS+ server administrators
  SHOULD change secret keys at regular intervals.[¬∂](#section-10.5.1-3.3.1)
* TACACS+ servers SHOULD warn administrators if
  secret keys are not unique per client.[¬∂](#section-10.5.1-3.4.1)
* TACACS+ server administrators SHOULD always define
  a secret for each client.[¬∂](#section-10.5.1-3.5.1)
* TACACS+ servers and clients MUST support shared keys that are at
  least 32 characters long.[¬∂](#section-10.5.1-3.6.1)
* TACACS+ servers MUST support policy to define
  minimum complexity for shared keys.[¬∂](#section-10.5.1-3.7.1)
* TACACS+ clients SHOULD NOT allow servers to be
  configured without a shared secret key or shared key that is less
  than 16 characters long.[¬∂](#section-10.5.1-3.8.1)
* TACACS+ server administrators SHOULD configure
  secret keys of a minimum of 16 characters in length.[¬∂](#section-10.5.1-3.9.1)

#### [10.5.2.](#section-10.5.2) [Connections and Obfuscation](#name-connections-and-obfuscation)

TACACS+ servers MUST allow the definition of
individual clients. The servers MUST only accept
network connection attempts from these defined known clients.[¬∂](#section-10.5.2-1)

TACACS+ servers MUST reject connections
that have
TAC\_PLUS\_UNENCRYPTED\_FLAG set. There MUST always be a
shared secret set on the server for the client requesting the
connection.[¬∂](#section-10.5.2-2)

If an invalid shared secret is detected when processing packets
for a client, TACACS+ servers MUST NOT accept any new
sessions on that connection. TACACS+ servers MUST
terminate the connection on completion of any sessions that were
previously established with a valid shared secret on that
connection.[¬∂](#section-10.5.2-3)

TACACS+ clients MUST NOT set
TAC\_PLUS\_UNENCRYPTED\_FLAG. Clients MUST be
implemented in a way that requires explicit configuration to enable
the use of TAC\_PLUS\_UNENCRYPTED\_FLAG. This option MUST NOT be used when the client is in production.[¬∂](#section-10.5.2-4)

When a TACACS+ client receives responses from servers where:[¬∂](#section-10.5.2-5)

* the response packet was received from the server configured
  with a shared key, but the packet has TAC\_PLUS\_UNENCRYPTED\_FLAG
  set, and[¬∂](#section-10.5.2-6.1)
* the response packet was received from the server configured
  not to use obfuscation, but the packet has
  TAC\_PLUS\_UNENCRYPTED\_FLAG not set,[¬∂](#section-10.5.2-6.2)

the TACACS+ client MUST close the TCP
session, and process the response in the same way that a
TAC\_PLUS\_AUTHEN\_STATUS\_FAIL (authentication sessions) or
TAC\_PLUS\_AUTHOR\_STATUS\_FAIL (authorization sessions) was
received.[¬∂](#section-10.5.2-7)

#### [10.5.3.](#section-10.5.3) [Authentication](#name-authentication-2)

To help TACACS+ administrators select stronger authentication
options, TACACS+ servers MUST allow the administrator
to configure the server to only accept challenge/response options
for authentication (TAC\_PLUS\_AUTHEN\_TYPE\_CHAP or
TAC\_PLUS\_AUTHEN\_TYPE\_MSCHAP or TAC\_PLUS\_AUTHEN\_TYPE\_MSCHAPV2 for
authen\_type).[¬∂](#section-10.5.3-1)

TACACS+ server administrators SHOULD enable the
option mentioned in the previous paragraph.
TACACS+ server deployments SHOULD only enable other
options (such as TAC\_PLUS\_AUTHEN\_TYPE\_ASCII or
TAC\_PLUS\_AUTHEN\_TYPE\_PAP) when unavoidable due to requirements of
identity/password systems.[¬∂](#section-10.5.3-2)

TACACS+ server administrators SHOULD NOT allow the
same credentials to be applied in challenge-based
(TAC\_PLUS\_AUTHEN\_TYPE\_CHAP or TAC\_PLUS\_AUTHEN\_TYPE\_MSCHAP or
TAC\_PLUS\_AUTHEN\_TYPE\_MSCHAPV2) and non-challenge-based authen\_type
options, as the insecurity of the latter will compromise the security
of the former.[¬∂](#section-10.5.3-3)

TAC\_PLUS\_AUTHEN\_SENDAUTH and TAC\_PLUS\_AUTHEN\_SENDPASS options
mentioned in "The Draft" SHOULD NOT be used due to their security implications. TACACS+
servers SHOULD NOT implement them. If they must be
implemented, the servers MUST default to the options
being disabled and MUST warn the administrator that
these options are not secure.[¬∂](#section-10.5.3-4)

#### [10.5.4.](#section-10.5.4) [Authorization](#name-authorization-2)

The authorization and accounting features are intended to provide
extensibility and flexibility. There is a base dictionary defined in
this document, but it may be extended in deployments by using new
argument names. The cost of the flexibility is that administrators
and implementers MUST ensure that the argument and
value pairs shared between the clients and servers have consistent
interpretation.[¬∂](#section-10.5.4-1)

TACACS+ clients that receive an unrecognized mandatory argument
MUST evaluate server response as if they received
TAC\_PLUS\_AUTHOR\_STATUS\_FAIL.[¬∂](#section-10.5.4-2)

#### [10.5.5.](#section-10.5.5) [Redirection Mechanism](#name-redirection-mechanism)

"The Draft" described a redirection mechanism
(TAC\_PLUS\_AUTHEN\_STATUS\_FOLLOW). This feature is difficult to
secure. The option to send secret keys in the server list is
particularly insecure, as it can reveal client shared secrets.[¬∂](#section-10.5.5-1)

TACACS+ servers MUST deprecate the redirection mechanism.[¬∂](#section-10.5.5-2)

If the redirection mechanism is implemented, then TACACS+ servers
MUST disable it by default and MUST
warn TACACS+ server administrators that it must only be enabled
within a secure deployment due to the risks of revealing shared
secrets.[¬∂](#section-10.5.5-3)

TACACS+ clients SHOULD deprecate this feature by treating
TAC\_PLUS\_AUTHEN\_STATUS\_FOLLOW as TAC\_PLUS\_AUTHEN\_STATUS\_FAIL.[¬∂](#section-10.5.5-4)

## [11.](#section-11) [IANA Considerations](#name-iana-considerations)

This document has no IANA actions.[¬∂](#section-11-1)

## [12.](#section-12) [References](#name-references)

### [12.1.](#section-12.1) [Normative References](#name-normative-references)

[RFC0020]
Cerf, V., "ASCII format for network interchange", STD 80, RFC 20, DOI 10.17487/RFC0020, October 1969, <<https://www.rfc-editor.org/info/rfc20>>.

[RFC1321]
Rivest, R., "The MD5 Message-Digest Algorithm", RFC 1321, DOI 10.17487/RFC1321, April 1992, <<https://www.rfc-editor.org/info/rfc1321>>.

[RFC1334]
Lloyd, B. and W. Simpson, "PPP Authentication Protocols", RFC 1334, DOI 10.17487/RFC1334, October 1992, <<https://www.rfc-editor.org/info/rfc1334>>.

[RFC2119]
Bradner, S., "Key words for use in RFCs to Indicate Requirement Levels", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997, <<https://www.rfc-editor.org/info/rfc2119>>.

[RFC2433]
Zorn, G. and S. Cobb, "Microsoft PPP CHAP Extensions", RFC 2433, DOI 10.17487/RFC2433, October 1998, <<https://www.rfc-editor.org/info/rfc2433>>.

[RFC2759]
Zorn, G., "Microsoft PPP CHAP Extensions, Version 2", RFC 2759, DOI 10.17487/RFC2759, January 2000, <<https://www.rfc-editor.org/info/rfc2759>>.

[RFC3579]
Aboba, B. and P. Calhoun, "RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP)", RFC 3579, DOI 10.17487/RFC3579, September 2003, <<https://www.rfc-editor.org/info/rfc3579>>.

[RFC4086]
Eastlake 3rd, D., Schiller, J., and S. Crocker, "Randomness Requirements for Security", BCP 106, RFC 4086, DOI 10.17487/RFC4086, June 2005, <<https://www.rfc-editor.org/info/rfc4086>>.

[RFC4120]
Neuman, C., Yu, T., Hartman, S., and K. Raeburn, "The Kerberos Network Authentication Service (V5)", RFC 4120, DOI 10.17487/RFC4120, July 2005, <<https://www.rfc-editor.org/info/rfc4120>>.

[RFC5952]
Kawamura, S. and M. Kawashima, "A Recommendation for IPv6 Address Text Representation", RFC 5952, DOI 10.17487/RFC5952, August 2010, <<https://www.rfc-editor.org/info/rfc5952>>.

[RFC8174]
Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017, <<https://www.rfc-editor.org/info/rfc8174>>.

[RFC8265]
Saint-Andre, P. and A. Melnikov, "Preparation, Enforcement, and Comparison of Internationalized Strings Representing Usernames and Passwords", RFC 8265, DOI 10.17487/RFC8265, October 2017, <<https://www.rfc-editor.org/info/rfc8265>>.

### [12.2.](#section-12.2) [Informative References](#name-informative-references)

[KRB4]
Miller, S., Neuman, C., Schiller, J., and J. Saltzer, "Section E.2.1: Kerberos Authentication and Authorization System", MIT Project Athena, Cambridge, Massachusetts, December 1987.

[THE-DRAFT]
Carrel, D. and L. Grant, "The TACACS+ Protocol Version 1.78", Work in Progress, Internet-Draft, draft-grant-tacacs-02, January 1997, <<https://tools.ietf.org/html/draft-grant-tacacs-02>>.

[TZDB]
Eggert, P. and A. Olson, "Sources for Time Zone and Daylight Saving Time Data", 1987, <<https://www.iana.org/time-zones>>.

## [Acknowledgements](#name-acknowledgements)

The authors would like to thank the following reviewers whose
comments and contributions made considerable improvements to this
document: Alan DeKok, Alexander Clouter, Chris Janicki, Tom Petch,
Robert Drake, and John Heasley, among many others.[¬∂](#section-appendix.a-1)

The authors would particularly like to thank
Alan DeKok, who provided
significant insights and recommendations on
all aspects of the document and the
protocol. Alan DeKok has
dedicated considerable time and effort to help
improve the document, identifying weaknesses
and providing remediation.[¬∂](#section-appendix.a-2)

The authors would also like to thank the support from the OPSAWG
Chairs and advisors, especially Joe Clarke.[¬∂](#section-appendix.a-3)

## [Authors' Addresses](#name-authors-addresses)

Thorsten Dahm
Google Inc.
1600 Amphitheatre Parkway
Mountain View, CA 94043

United States of America
Email:
thorstendlux@google.com

Andrej Ota
Google Inc.
1600 Amphitheatre Parkway
Mountain View, CA 94043

United States of America
Email:
andrej@ota.si

Douglas C. Medway Gash
Cisco Systems, Inc.
170 West Tasman Dr.
San Jose, CA 95134

United States of America
Email:
dcmgash@cisco.com

David Carrel
IPsec Research
Email:
carrel@ipsec.org

Lol Grant
Email:
lol.grant@gmail.com

[Datatracker](/doc/rfc8907/)

RFC 8907

RFC
- Informational

* Info
* Contents
* Prefs

| Document | Document type |  | RFC - Informational  September 2020  [View errata](https://www.rfc-editor.org/errata_search.php?rfc=8907 "Click to view errata.") [Report errata](https://www.rfc-editor.org/errata.php#reportnew "Click to report an error in the document.") Was [draft-ietf-opsawg-tacacs](/doc/draft-ietf-opsawg-tacacs/18/) ([opsawg WG](/wg/opsawg/about/)) |
| --- | --- | --- | --- |
|  | Select version |  | * [00](/doc/html/draft-ietf-opsawg-tacacs-00) * [01](/doc/html/draft-ietf-opsawg-tacacs-01) * [02](/doc/html/draft-ietf-opsawg-tacacs-02) * [03](/doc/html/draft-ietf-opsawg-tacacs-03) * [04](/doc/html/draft-ietf-opsawg-tacacs-04) * [05](/doc/html/draft-ietf-opsawg-tacacs-05) * [06](/doc/html/draft-ietf-opsawg-tacacs-06) * [07](/doc/html/draft-ietf-opsawg-tacacs-07) * [08](/doc/html/draft-ietf-opsawg-tacacs-08) * [09](/doc/html/draft-ietf-opsawg-tacacs-09) * [10](/doc/html/draft-ietf-opsawg-tacacs-10) * [11](/doc/html/draft-ietf-opsawg-tacacs-11) * [12](/doc/html/draft-ietf-opsawg-tacacs-12) * [13](/doc/html/draft-ietf-opsawg-tacacs-13) * [14](/doc/html/draft-ietf-opsawg-tacacs-14) * [15](/doc/html/draft-ietf-opsawg-tacacs-15) * [16](/doc/html/draft-ietf-opsawg-tacacs-16) * [17](/doc/html/draft-ietf-opsawg-tacacs-17) * [18](/doc/html/draft-ietf-opsawg-tacacs-18) * [RFC 8907](/doc/html/rfc8907) |
|  | Compare versions |  | RFC 8907  draft-ietf-opsawg-tacacs-18  draft-ietf-opsawg-tacacs-16  draft-ietf-opsawg-tacacs-15  draft-ietf-opsawg-tacacs-14  draft-ietf-opsawg-tacacs-13  draft-ietf-opsawg-tacacs-12  draft-ietf-opsawg-tacacs-11  draft-ietf-opsawg-tacacs-10  draft-ietf-opsawg-tacacs-09  draft-ietf-opsawg-tacacs-08  draft-ietf-opsawg-tacacs-07  draft-ietf-opsawg-tacacs-06  draft-ietf-opsawg-tacacs-05  draft-ietf-opsawg-tacacs-04  draft-ietf-opsawg-tacacs-03  draft-ietf-opsawg-tacacs-02  draft-ietf-opsawg-tacacs-01  draft-ietf-opsawg-tacacs-00   RFC 8907  draft-ietf-opsawg-tacacs-18  draft-ietf-opsawg-tacacs-16  draft-ietf-opsawg-tacacs-15  draft-ietf-opsawg-tacacs-14  draft-ietf-opsawg-tacacs-13  draft-ietf-opsawg-tacacs-12  draft-ietf-opsawg-tacacs-11  draft-ietf-opsawg-tacacs-10  draft-ietf-opsawg-tacacs-09  draft-ietf-opsawg-tacacs-08  draft-ietf-opsawg-tacacs-07  draft-ietf-opsawg-tacacs-06  draft-ietf-opsawg-tacacs-05  draft-ietf-opsawg-tacacs-04  draft-ietf-opsawg-tacacs-03  draft-ietf-opsawg-tacacs-02  draft-ietf-opsawg-tacacs-01  draft-ietf-opsawg-tacacs-00   Side-by-side  Inline |
|  | Authors |  | [Thorsten Dahm](/person/t.dahm%40resolution.de "Datatracker profile of Thorsten Dahm") , [Andrej Ota](/person/andrej%40ota.si "Datatracker profile of Andrej Ota") , [dcmgash@cisco.com](/person/dcmgash%40cisco.com "Datatracker profile of dcmgash@cisco.com") , [David Carrel](/person/carrel%40ipsec.org "Datatracker profile of David Carrel") , [Lol Grant](/person/lol%40cisco.com "Datatracker profile of Lol Grant")   Email authors |
|  | RFC stream |  | IETF Logo IETF Logo |
|  | Other formats |  | [txt](https://www.rfc-editor.org/rfc/rfc8907.txt) [html](https://www.rfc-editor.org/rfc/rfc8907.html) [xml](https://www.rfc-editor.org/rfc/rfc8907.xml) [pdf](https://www.rfc-editor.org/rfc/rfc8907.pdf) [bibtex](/doc/rfc8907/bibtex/) |
|  | Additional resources |  | [Mailing list discussion](https://mailarchive.ietf.org/arch/browse/opsawg/?q=rfc8907 OR %22draft-ietf-opsawg-tacacs%22) |

[Report a datatracker bug](https://github.com/ietf-tools/datatracker/issues/new/choose)

Show sidebar by default

Yes

No

Tab to show by default

Info

Contents

HTMLization configuration

HTMLize the plaintext

Plaintextify the HTML

Maximum font size

Page dependencies

Inline

Reference

Citation links

 Go to reference section

Go to linked document

![](//analytics.ietf.org/piwik.php?idsite=7)



=== Content from avatars.githubusercontent.com_ffa0fe78_20250119_134449.html ===

[Skip to content](#start-of-content)

GitHub Copilot is now available for free.
[Learn more](https://github.com/features/copilot/?utm_source=github&utm_medium=banner&utm_campaign=copilotfree-bannerheader)

## Navigation Menu

Toggle navigation

[Sign in](/login)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F&source=header-home)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

# Build and ship software on a single, collaborative platform

Join the world‚Äôs most widely adopted AI-powered developer platform.

Enter your emailSign up for GitHub[Try GitHub Copilot](/features/copilot)
## GitHub features

A demonstration animation of a code editor using GitHub Copilot Chat, where the user requests GitHub Copilot to refactor duplicated logic and extract it into a reusable function for a given code snippet.

CodePlanCollaborateAutomateSecure

Build code quickly and more securely with GitHub Copilot embedded throughout your workflows.

## GitHub is used by

![Shopify](https://github.githubassets.com/assets/shopify-3fed3011ac81.svg)![EY](https://github.githubassets.com/assets/ey-7434b194d68c.svg)![Figma](https://github.githubassets.com/assets/figma-04e0038c0fef.svg)![Duolingo](https://github.githubassets.com/assets/duolingo-ea3a0aa56fa5.svg)![New York Times](https://github.githubassets.com/assets/newyorktimes-9d76d7f338f5.svg)![Mercado Libre](https://github.githubassets.com/assets/mercado-libre-762f679589f2.svg)![American Airlines](https://github.githubassets.com/assets/american-airlines-a2b13c8fbe08.svg)![Ford](https://github.githubassets.com/assets/ford-2fb5195a4c7c.svg)![Mercedes Benz](https://github.githubassets.com/assets/mercedes-b9190458c80e.svg)![Soci√©t√© G√©n√©rale](https://github.githubassets.com/assets/societe-generale-7a3414490494.svg)![Vodafone](https://github.githubassets.com/assets/vodafone-6e0f322de6cd.svg)![Philips](https://github.githubassets.com/assets/philips-8087a5f95f5c.svg)![SAP](https://github.githubassets.com/assets/sap-ea7dcd02e37d.svg)![Infosys](https://github.githubassets.com/assets/infosys-7587455de0bd.svg)![Spotify](https://github.githubassets.com/assets/spotify-591ecb426c1e.svg)![Shopify](https://github.githubassets.com/assets/shopify-3fed3011ac81.svg)![EY](https://github.githubassets.com/assets/ey-7434b194d68c.svg)![Figma](https://github.githubassets.com/assets/figma-04e0038c0fef.svg)![Duolingo](https://github.githubassets.com/assets/duolingo-ea3a0aa56fa5.svg)![New York Times](https://github.githubassets.com/assets/newyorktimes-9d76d7f338f5.svg)![Mercado Libre](https://github.githubassets.com/assets/mercado-libre-762f679589f2.svg)![American Airlines](https://github.githubassets.com/assets/american-airlines-a2b13c8fbe08.svg)![Ford](https://github.githubassets.com/assets/ford-2fb5195a4c7c.svg)![Mercedes Benz](https://github.githubassets.com/assets/mercedes-b9190458c80e.svg)![Soci√©t√© G√©n√©rale](https://github.githubassets.com/assets/societe-generale-7a3414490494.svg)![Vodafone](https://github.githubassets.com/assets/vodafone-6e0f322de6cd.svg)![Philips](https://github.githubassets.com/assets/philips-8087a5f95f5c.svg)![SAP](https://github.githubassets.com/assets/sap-ea7dcd02e37d.svg)![Infosys](https://github.githubassets.com/assets/infosys-7587455de0bd.svg)![Spotify](https://github.githubassets.com/assets/spotify-591ecb426c1e.svg)
## Accelerate performance

With GitHub Copilot embedded throughout the platform, you can simplify your toolchain, automate tasks, and improve the developer experience.

![](https://github.githubassets.com/assets/particles-de1dd20f3008.png)A Copilot chat window with extensions enabled. The user inputs the @ symbol to reveal a list of five Copilot Extensions. @Sentry is selected from the list, which shifts the window to a chat directly with that extension. There are three sample prompts at the bottom of the chat window, allowing the user to Get incident information, Edit status on incident, or List the latest issues. The last one is activated to send the prompt: @Sentry List the latest issues. The extension then lists several new issues and their metadata.
### Work 55% faster.1 Increase productivity with AI-powered coding assistance, including code completion, chat, and more.

1[Survey: The AI wave continues to grow on software development teams, 2024.](https://github.blog/news-insights/research/survey-ai-wave-grows/)

[Explore GitHub Copilot](/features/copilot)![Duolingo](https://github.githubassets.com/assets/logo-duolingo-14477f9e54a6.svg)

Duolingo boosts developer speed by 25% with GitHub Copilot

[Read customer story](/customer-stories/duolingo)![Gartner](https://github.githubassets.com/assets/logo-gartner-aa8c2e452b64.svg)

2024 Gartner¬Æ Magic Quadrant‚Ñ¢ for AI Code Assistants

[Read report](https://www.gartner.com/doc/reprints?id=1-2IKO4MPE&ct=240819&st=sb)![](https://github.githubassets.com/assets/accordion-1-ce487d44c0bf.webp)![](https://github.githubassets.com/assets/accordion-2-730955545f07.webp)![](https://github.githubassets.com/assets/accordion-3-52ca331d22ea.webp)![](https://github.githubassets.com/assets/accordion-4-a26744b70ff7.webp)
### Automate any workflow

Optimize your process with simple and secured CI/CD.

A list of workflows displays a heading ‚Äò45,167 workflow runs‚Äô at the top. Below are five rows of completed workflows accompanied by their completion time and their duration formatted in minutes and seconds.[Discover GitHub Actions](/features/actions)
### Get up and running in seconds

Start building instantly with a comprehensive dev environment in the cloud.

A GitHub Codespaces setup for the landing page of a game called OctoInvaders. On the left is a code editor with some HTML and Javascript files open. On the right is a live render of the page. In front of this split editor window is a screenshot of two active GitHub Codespaces environments with their branch names and a button to ‚ÄòCreate codespace on main.‚Äô[Check out GitHub Codespaces](/features/codespaces)
### Build on the go

Manage projects and chat with GitHub Copilot from anywhere.

Two smartphone screens side by side. The left screen shows a Notification inbox, listing issues and pull requests from different repositories like TensorFlow and GitHub‚Äôs OctoArcade octoinvaders. The right screen shows a new conversation in GitHub Copilot chat.[Download GitHub Mobile](/mobile)
### Integrate the tools you love

Sync with 17,000+ integrations and a growing library of Copilot Extensions.

A grid of fifty app tiles displays logos for integrations and extensions for companies like Stripe, Slack, and Docker. The tiles extend beyond the bounds of the image to indicate a wide array of apps. [Visit GitHub Marketplace](/marketplace)
## Built-in application security where found means fixed

Use AI to find and fix vulnerabilities‚Äîfreeing your teams to ship more secure software faster.

![](https://github.githubassets.com/assets/particles-de1dd20f3008.png)
### Apply fixes in seconds. Spend less time fixing vulnerabilities and more time building features with Copilot Autofix.

[Explore GitHub Advanced Security](/enterprise/advanced-security)![Copilot Autofix identifies vulnerable code and provides an explanation, together with a secure code suggestion to remediate the vulnerability.](https://github.githubassets.com/assets/hero-64ecd484397f.webp)

Solve security debt. Leverage AI-assisted security campaigns to reduce application vulnerabilities and zero-day attacks.

[Discover security campaigns](/enterprise/advanced-security)![A security campaign screen displays the campaign‚Äôs progress bar with 97% completed of 701 alerts. A total of 23 alerts are left with 13 in progress, and the campaign started 20 days ago. The status below shows that there are 7 days left in the campaign with a due date of November 15, 2024.](https://github.githubassets.com/assets/pillar-1-dd667a921f55.webp)

Dependencies you can depend on. Update vulnerable dependencies with supported fixes for breaking changes.

[Learn about Dependabot](/features/security/software-supply-chain)![List of dependencies defined in a requirements .txt file.](https://github.githubassets.com/assets/pillar-2-ff69e872920a.webp)

Your secrets, your business: protected.  Detect, prevent, and remediate leaked secrets across your organization.

[Read about secret scanning](/features/security/code)![GitHub push protection confirms and displays an active secret, and blocks the push.](https://github.githubassets.com/assets/pillar-3-0a063e2daae2.webp)
### 7x fastervulnerability fixes with GitHub2

2This 7X times factor is based on data from the industry‚Äôs longest running analysis of fix rates Veracode State of Software Security 2023, which cites the average time to fix 50% of flaws as 198 days vs. GitHub‚Äôs fix rates of 72% of flaws with in 28 days which is at a minimum of 7X faster when compared.

### 90% coverage[of alert types in all supported languages with Copilot Autofix](https://docs.github.com/en/code-security/code-scanning/managing-your-code-scanning-configuration/codeql-query-suites)

## Work together, achieve more

Collaborate with your teams, use management tools that sync with your projects, and code from anywhere‚Äîall on a single, integrated platform.

![](https://github.githubassets.com/assets/particles-de1dd20f3008.png)![A project management dashboard showing tasks for the ‚ÄòOctoArcade Invaders‚Äô project, with tasks grouped under project phase categories like ‚ÄòPrototype,‚Äô ‚ÄòBeta,‚Äô and ‚ÄòLaunch‚Äô in a table layout. One of the columns displays sub-issue progress bars with percentages for each issue.](https://github.githubassets.com/assets/hero-961322485af6.webp)
### Your workflows, your way. Plan effectively with an adaptable spreadsheet that syncs with your work.

[Jump into GitHub Projects](/features/issues)‚Äú
> It helps us onboard new software engineers and get them productive right away. We have all our source code, issues, and pull requests in one place... GitHub is a complete platform that frees us from menial tasks and enables us to do our best work.

Fabian FaulhaberApplication manager at Mercedes-Benz

![](https://github.githubassets.com/assets/accordion-1-38ad6b6d1b20.webp)![](https://github.githubassets.com/assets/accordion-2-c0a62cfc31a1.webp)![](https://github.githubassets.com/assets/accordion-3-5d5d222f1830.webp)![](https://github.githubassets.com/assets/accordion-4-7abff9233556.webp)
### Keep track of your tasks

Create issues and manage projects with tools that adapt to your code.

Display of task tracking within an issue, showing the status of related sub-issues and their connection to the main issue.[Explore GitHub Issues](/features/issues)
### Share ideas and ask questions

Create space for open-ended conversations alongside your project.

A GitHub Discussions thread where a GitHub user suggests a power-up idea involving Hubot revealing a path and protecting Mona. The post has received 5 upvotes and several reactions. Below, three other users add to the discussion, suggesting Hubot could provide different power-ups depending on levels and appreciating the collaboration idea.[Discover GitHub Discussions](/features/discussions)
### Review code changes together

Create review processes that improve code quality and fit neatly into your workflow.

Two code review approvals by helios-ackmore and amanda-knox, which are followed by three successful checks for ‚ÄòBuild,‚Äô ‚ÄòTest,‚Äô and ‚ÄòPublish.‚Äô[Learn about code review](/features/code-review)
### Fund open source projects

Become an open source partner and support the tools and libraries that power your work.

A GitHub Sponsors popup displays ‚Äò$15,000 a month‚Äô with a progress bar showing 87% towards a $15,000 goal.[Dive into GitHub Sponsors](/sponsors)
## From startups to enterprises, GitHub scales with teams of any size in any industry.

By industryBy sizeBy use case

---

[![](https://github.githubassets.com/assets/figma-62d390a52419.webp)![Figma](https://github.githubassets.com/assets/figma-9b0c642e96b8.svg)Technology

Figma streamlines development and strengthens security

Read customer story](https://github.com/customer-stories/figma)[![](https://github.githubassets.com/assets/mercedes-benz-d8f89b041561.webp)![Mercedes-Benz](https://github.githubassets.com/assets/mercedes-benz-60ddd54043e7.svg)Automotive

Mercedes-Benz standardizes source code and automates onboarding

Read customer story](https://github.com/customer-stories/mercedes-benz)[![](https://github.githubassets.com/assets/mercado-libre-579cb5447302.webp)![Mercado Libre](https://github.githubassets.com/assets/mercado-libre-2d6d610fa873.svg)Financial services

Mercado Libre cuts coding time by 50%

Read customer story](https://github.com/customer-stories/mercado-libre)[Explore customer stories](/customer-stories)

---

[View all solutions](/solutions)
## Millions of developers and businesses call GitHub home

Whether you‚Äôre scaling your development process or just learning how to code, GitHub is where you belong. Join the world‚Äôs most widely adopted AI-powered developer platform to build the technologies that redefine what‚Äôs possible.

Enter your emailSign up for GitHub[Try GitHub Copilot](/features/copilot)

## Site-wide Links

### Subscribe to our developer newsletter

Get tips, technical guides, and best practices. Twice a month. Right in your inbox.

[Subscribe](https://resources.github.com/newsletter/)

### Product

* [Features](/features)
* [Enterprise](/enterprise)
* [Copilot](/features/copilot)
* [Security](/security)
* [Pricing](/pricing)
* [Team](/team)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare)

### Platform

* [Developer API](https://docs.github.com/get-started/exploring-integrations/about-building-integrations)
* [Partners](https://partner.github.com)
* [Education](https://github.com/edu)
* [GitHub CLI](https://cli.github.com)
* [GitHub Desktop](https://desktop.github.com)
* [GitHub Mobile](https://github.com/mobile)

### Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com)
* [Premium Support](/enterprise/premium-support)
* [Skills](https://skills.github.com)
* [Status](https://www.githubstatus.com)
* [Contact GitHub](https://support.github.com?tags=dotcom-footer)

### Company

* [About](https://github.com/about)
* [Customer stories](/customer-stories?type=enterprise)
* [Blog](https://github.blog)
* [The ReadME Project](/readme)
* [Careers](https://github.careers)
* [Newsroom](/newsroom)
* [Inclusion](/about/diversity)
* [Social Impact](https://socialimpact.github.com)
* [Shop](https://shop.github.com)

* ¬© 2025 GitHub, Inc.
* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
  ([Updated 02/2024](https://github.com/github/site-policy/pull/582))
* [Sitemap](/sitemap)
* [What is Git?](/git-guides)
* Manage cookies
* Do not share my personal information

* [GitHub on LinkedIn](https://www.linkedin.com/company/github)
* [Instagram
  GitHub on Instagram](https://www.instagram.com/github)
* [GitHub on YouTube](https://www.youtube.com/github)
* [GitHub on X](https://x.com/github)
* [TikTok
  GitHub on TikTok](https://www.tiktok.com/%40github)
* [Twitch
  GitHub on Twitch](https://www.twitch.tv/github)
* [GitHub‚Äôs organization on GitHub](https://github.com/github)

You can‚Äôt perform that action at this time.


