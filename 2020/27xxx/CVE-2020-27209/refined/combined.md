=== Content from www.aisec.fraunhofer.de_83b45f81_20250119_114545.html ===


Search

[![](/content/dam/aisec/aisec_190x52.gif)
Fraunhofer Institute for Applied and Integrated Security](/en.html)

[Fraunhofer Institute for Applied and Integrated Security](/en.html)

* [Jobs / Career](/en/jobs-career.html)
* [Blog](/en/Blog.html)
* [Contact](/en/about-us/contact.html)
* [Deutsch](/)

* [Jobs / Career](/en/jobs-career.html)
* [About Fraunhofer AISEC](/en/about-us.html)
  [X]
  [About Fraunhofer AISEC](/en/about-us.html)
  + [In Profile](/en/about-us/in-profile.html)
  + [Opportunities for collaboration](/en/about-us/Collaboration.html)
  + [How to find us](/en/about-us/how-to-find-us.html)
  + [Contact](/en/about-us/contact.html)
  + [Laboratories](/en/about-us/Laboratories.html)
  + [Scientific Excellence](/en/about-us/scientific_excellence.html)
  + [Quality Management](/en/about-us/quality_management.html)
  + [Competence Center for Post-Quantum Cryptography](/en/about-us/Competence-Center-PQC.html)
  + [Advisory Board](/en/about-us/advisory-board.html)
  + [Statement for Democracy](/en/about-us/statement-for-democracy.html)
* [Fields of Expertise](/en/fields-of-expertise.html)
  [X]
  [Fields of Expertise](/en/fields-of-expertise.html)
  + [Cognitive Security Technologies](/en/fields-of-expertise/CST.html)
    - [BayQS](/en/fields-of-expertise/CST/bayqs.html)
  + [Hardware Security](/en/fields-of-expertise/HWS.html)
  + [Secure Infrastructure](/en/fields-of-expertise/SIS.html)
  + [Secure Systems Engineering](/en/fields-of-expertise/SSE.html)
  + [Secure Operating Systems](/en/fields-of-expertise/SOS.html)
  + [Product Protection and Industrial Security](/en/fields-of-expertise/PIN.html)
  + [Service and Application Security](/en/fields-of-expertise/SAS.html)
* [Spotlights](/en/spotlights.html)
  [X]
  [Spotlights](/en/spotlights.html)
  + [Trusted Electronics](/en/spotlights/trusted-electronics.html)
  + [Post-Quantum Cryptography](/en/spotlights/Competence-Center-PQC.html)
  + [Deepfakes](/en/spotlights/Deepfakes.html)
  + [Cyber Resilience Act](/en/spotlights/the-cyber-resilience-act---security-requirements-for-products-wi.html)
* [Media](/en/media.html)
  [X]
  [Media](/en/media.html)
  + [Publications](/en/media/publications.html)
    - [Annual report 2022](/en/media/publications/Annual-report-2022.html)
    - [Annual Report 2023](/en/media/publications/annual-report-2023.html)
  + [Press Releases](/en/media/press-releases.html)
  + [Newsletter](/en/media/Newsletter.html)
  + [Events](/en/media/events.html)
    - [Workshop Secure & Trustworthy Hardware](/en/media/events/workshop--secure-and-trustworthy-hardware-.html)
  + [More media](/en/media/moremedia.html)
    - [Serious Game](/en/media/moremedia/CharlieQC.html)
* [Blog](/en/Blog.html)
* More

To view this video please enable JavaScript, and consider upgrading to a web browser that supports HTML5 video

Where am I?

* [English](/en.html)
* Shedding too much Light on a Microcontroller’s Firmware Protection

# Shedding too much Light on a Microcontroller's Firmware Protection

Proceedings of the 11th USENIX Workshop on Offensive Technologies (WOOT '17) - Vancouver, BC, Canada            [CVE number 2017-18347](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-18347)

Almost every microcontroller with integrated flash features firmware readout protection. This is a form of content protection which aims at securing intellectual property (IP) as well as cryptographic keys and algorithms from an adversary. One series of microcontrollers are the STM32 which have recently gained popularity and thus are increasingly under attack. However, no practical experience and information on the resilience of STM32 microcontrollers is publicly available. The paper presents the first investigation of the STM32 security concept, especially targeting the STM32F0 sub-series. Starting with a conceptual analysis, we discover three weaknesses and develop them to vulnerabilities by demonstrating corresponding Proofs-of-Concept. At first, we discover that a common security configuration provides low protection which can be exploited using our Cold-boot Stepping approach to extract critical data or even readout-protected firmware. Secondly, we reveal a design weakness in the security configuration storage which allows an attacker to downgrade the level of firmware protection, thereby enabling additional attacks. Thirdly, we discover and analyze a hardware flaw in the debug interface, attributed to a race condition, that allows us to directly extract readprotected firmware using an iterative approach. Each attack requires only low-priced equipment, thereby increasing the impact of each weakness and resulting in a severe threat altogether.

##

### Paper Download

[Download](/content/dam/aisec/ResearchExcellence/woot17-paper-obermaier.pdf "Download")

### Presentation

[Download](/content/dam/aisec/ResearchExcellence/firmwareprotection-pres-woot17.pdf "Download")

### Bibtex

[Download](/content/dam/aisec/Dokumente/Publikationen/Studien_TechReports/englisch/Biblio-Bibtex.bib "Download")

### Download

### Firmware under attack

[Download](/content/dam/aisec/ResearchExcellence/microbootCrc.zip "Download")

### Download

### Coldboot Stepping PoC

[Download](/content/dam/aisec/ResearchExcellence/coldbootStepping.zip "Download")

### Download

### Firmware Extraction PoC

[Download](/content/dam/aisec/ResearchExcellence/swdFirmwareExtractor.zip "Download")

## Laboratory setup for Cold Boot Stepping

[![](/en/FirmwareProtection/jcr:content/contentPar/sectioncomponent_0/sectionParsys/textwithasset/imageComponent/image.img.jpg/1501770805414/1-coldbootStepping-setup1.jpg)](/en/FirmwareProtection/jcr%3Acontent/contentPar/sectioncomponent_0/sectionParsys/textwithasset/imageComponent/image.img.4col.large.jpg/1501770805414/1-coldbootStepping-setup1.jpg)

By observing changes in SRAM, one can reverse-engineer the basic control flow, find out the usage of specific addresses and may also discover briefly visible secret data. The system is only allowed to run for a precisely controlled duration and is then stopped. The contents of the SRAM is read out and a snapshot is created. With well chosen and increasing runtime duration this is similar to stepping through the firmware, since only a few instructions are executed between each SRAM snapshot.

## UV-C irradiation setup for Security Downgrade

[![](/en/FirmwareProtection/jcr:content/contentPar/sectioncomponent_0/sectionParsys/textwithasset_0/imageComponent/image.img.jpg/1501770832653/2-uv1.jpg)](/en/FirmwareProtection/jcr%3Acontent/contentPar/sectioncomponent_0/sectionParsys/textwithasset_0/imageComponent/image.img.4col.large.jpg/1501770832653/2-uv1.jpg)

The STM32 Readout Protection Level protection mechanism is based on the RDP and nRDP bytes in the option byte memory region. At the power-on event, the option bytes are loaded from flash memory and the corresponding RDP Level is set. We show by experiment, that a flaw in the implementation evolves to a practical threat. The option byte memory region can be modified specifically by UV-C light performing optical fault injection.

## Setup for firmware extraction out of a device using RDP Level 1

[![](/en/FirmwareProtection/jcr:content/contentPar/sectioncomponent_0/sectionParsys/textwithasset_1/imageComponent/image.img.jpg/1501770858638/3-lvl1Extract.jpg)](/en/FirmwareProtection/jcr%3Acontent/contentPar/sectioncomponent_0/sectionParsys/textwithasset_1/imageComponent/image.img.4col.large.jpg/1501770858638/3-lvl1Extract.jpg)

The STM32F0 series microcontrollers use the Serial Wire Debug interface for debugging and flash programming. When a debugger becomes attached to this interface in Readout Protection Level 1, the flash protection logic cuts access to flash memory. Due to a race condition in the implementation not only a single access can be performed, but the whole firmware can be extracted from a microcontroller.

### Contact

### Contact Press / Media

#### Stefan Tatschner

Security Researcher

Fraunhofer AISEC
Lichtenbergstraße 11
85748 Garching b. München

* Send email
* stefan.tatschner@aisec.fraunhofer.de

## Navigation and Social Media

### Share

Print

* [Visitor regulations](/en/Visitorregulations.html)
* [Tenders](/en/Tenders.html)
* [Imprint](/en/imprint.html)
* [Data Protection](/en/data_protection.html)

© 2025

**Source: Fraunhofer-Gesellschaft
Fraunhofer Institute for Applied and Integrated Security - Shedding too much Light on a Microcontroller’s Firmware Protection**

Online in Internet; URL: https://www.aisec.fraunhofer.de/en/FirmwareProtection.html

Date: 16.1.2025 22:55



=== Content from github.com_e09533fb_20250119_114544.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkmackay%2Fmicro-ecc%2Freleases)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkmackay%2Fmicro-ecc%2Freleases)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Findex&source=header-repo&source_repo=kmackay%2Fmicro-ecc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kmackay](/kmackay)
/
**[micro-ecc](/kmackay/micro-ecc)**
Public

* [Notifications](/login?return_to=%2Fkmackay%2Fmicro-ecc) You must be signed in to change notification settings
* [Fork
  463](/login?return_to=%2Fkmackay%2Fmicro-ecc)
* [Star
   1.3k](/login?return_to=%2Fkmackay%2Fmicro-ecc)

* [Code](/kmackay/micro-ecc)
* [Issues
  46](/kmackay/micro-ecc/issues)
* [Pull requests
  11](/kmackay/micro-ecc/pulls)
* [Actions](/kmackay/micro-ecc/actions)
* [Projects
  0](/kmackay/micro-ecc/projects)
* [Wiki](/kmackay/micro-ecc/wiki)
* [Security](/kmackay/micro-ecc/security)
* [Insights](/kmackay/micro-ecc/pulse)

Additional navigation options

* [Code](/kmackay/micro-ecc)
* [Issues](/kmackay/micro-ecc/issues)
* [Pull requests](/kmackay/micro-ecc/pulls)
* [Actions](/kmackay/micro-ecc/actions)
* [Projects](/kmackay/micro-ecc/projects)
* [Wiki](/kmackay/micro-ecc/wiki)
* [Security](/kmackay/micro-ecc/security)
* [Insights](/kmackay/micro-ecc/pulse)

# Releases: kmackay/micro-ecc

[Releases](/kmackay/micro-ecc/releases)
[Tags](/kmackay/micro-ecc/tags)

Releases · kmackay/micro-ecc
## 1.1

22 Jan 00:14

![@kmackay](https://avatars.githubusercontent.com/u/3208815?s=40&v=4)
[kmackay](/kmackay)

[v1.1](/kmackay/micro-ecc/tree/v1.1)

[`24c60e2`](/kmackay/micro-ecc/commit/24c60e243580c7868f4334a1ba3123481fe1aa48)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/kmackay/micro-ecc/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.1)

 Loading

[View all tags](/kmackay/micro-ecc/tags)

[1.1](/kmackay/micro-ecc/releases/tag/v1.1)
[Latest](/kmackay/micro-ecc/releases/latest)

[Latest](/kmackay/micro-ecc/releases/latest)

For people that don't want to pull from master.

 Assets
2

 Loading

All reactions

## v1.0

23 May 04:43

![@kmackay](https://avatars.githubusercontent.com/u/3208815?s=40&v=4)
[kmackay](/kmackay)

[v1.0](/kmackay/micro-ecc/tree/v1.0)

[`d037ec8`](/kmackay/micro-ecc/commit/d037ec89546fad14b5c4d5456c2e23a71e554966)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/kmackay/micro-ecc/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.0)

 Loading

[View all tags](/kmackay/micro-ecc/tags)

[v1.0](/kmackay/micro-ecc/releases/tag/v1.0)

Apparently GitHub has "releases" now.

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from eprint.iacr.org_48fafd58_20250119_114542.html ===

# What a lovely hat

#### Is it made out of [tin foil](https://iacr.org/tinfoil.html)?

[![IACR Logo](/img/iacrlogo_small.png)](https://iacr.org/)

[Cryptology ePrint Archive](/)

* Papers
  Updates from the last:+ [7 days](/days/7)
  + [31 days](/days/31)
  + [6 months](/days/183)
  + [365 days](/days/365)
  + ---
  + [Listing by year](/byyear)
  + [All papers](/complete)
  + [Compact view](/complete/compact)
  + [Subscribe](https://www.iacr.org/news/subscribe)
  + ---
  + [How to cite](/citation.html)
  + ---
  + [Harvesting metadata](/rss)
* Submissions
  + [Submit a paper](/submit)
  + [Revise or withdraw a paper](/revise)
  + [Acceptance and publishing conditions](/operations.html)
* About
  + [Goals and history](/about.html)
  + [News](/news.html)
  + [Statistics](/stats)
  + [Contact](/contact.html)

![Search Button](/img/search.svg)

Search

[Advanced search](/search)

#### Paper 2021/640

### Security and Trust in Open Source Security Tokens

Marc Schink, Alexander Wagner, Florian Unterstein, and Johann Heyszl

##### Abstract

Using passwords for authentication has been proven vulnerable in countless security incidents. Hardware authentication tokens effectively prevent most password-related security issues and improve security indisputably. However, we would like to highlight that there are new threats from attackers with physical access which need to be discussed. Supply chain adversaries may manipulate devices on a large scale and install backdoors before they even reach end users. In evil maid scenarios, specific devices may even be attacked while already in use. Hence, we thoroughly investigate the security and trustworthiness of eight commercially available open source authentication tokens, including devices from the two market leaders: SoloKeys and Nitrokey. Unfortunately, we identify and practically verify significant vulnerabilities in all eight examined tokens. Some of them based on severe, previously undiscovered, vulnerabilities of three major microcontroller products which are used at a large scale in various products. Our findings clearly emphasize the significant threat from supply chain and evil maid scenarios since the attacks are practical and only require moderate attacker efforts. Fortunately, we are able to describe software-based countermeasures as effective improvements to retrofit the examined devices. To improve the security and trustworthiness of future authentication tokens, we also derive important general design recommendations.

##### Metadata

Available format(s)

[![](/img/file-pdf.svg)PDF](/2021/640.pdf)

Category
[Applications](/search?category=APPLICATIONS)
Publication info
A minor revision of an IACR publication in TCHES 2021
Keywords
[security token](/search?q=security%20token)[second factor authentication](/search?q=second%20factor%20authentication)[FIDO](/search?q=FIDO)[fault injection attack](/search?q=fault%20injection%20attack)[side-channel attack](/search?q=side-channel%20attack)[firmware protection](/search?q=firmware%20protection)
Contact author(s)
marc schink @ aisec fraunhofer de

History
2021-05-17: received
Short URL
<https://ia.cr/2021/640>
License
[![Creative Commons Attribution](/img/license/CC_BY.svg "Creative Commons Attribution")

CC BY](https://creativecommons.org/licenses/by/4.0/)

**BibTeX**
![](/img/copy-outline.svg)Copy to clipboard

```

@misc{cryptoeprint:2021/640,
      author = {Marc Schink and Alexander Wagner and Florian Unterstein and Johann Heyszl},
      title = {Security and Trust in Open Source Security Tokens},
      howpublished = {Cryptology {ePrint} Archive, Paper 2021/640},
      year = {2021},
      url = {https://eprint.iacr.org/2021/640}
}

```

[![IACR Logo](/img/iacrlogo_small.png)](https://iacr.org/)

Note: In order to protect the privacy of readers, eprint.iacr.org
does not use cookies or embedded third party content.



=== Content from github.com_9e483222_20250119_114544.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkmackay%2Fmicro-ecc%2Fcommit%2F1b5f5cea5145c96dd8791b9b2c41424fc74c2172)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkmackay%2Fmicro-ecc%2Fcommit%2F1b5f5cea5145c96dd8791b9b2c41424fc74c2172)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=kmackay%2Fmicro-ecc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kmackay](/kmackay)
/
**[micro-ecc](/kmackay/micro-ecc)**
Public

* [Notifications](/login?return_to=%2Fkmackay%2Fmicro-ecc) You must be signed in to change notification settings
* [Fork
  463](/login?return_to=%2Fkmackay%2Fmicro-ecc)
* [Star
   1.3k](/login?return_to=%2Fkmackay%2Fmicro-ecc)

* [Code](/kmackay/micro-ecc)
* [Issues
  46](/kmackay/micro-ecc/issues)
* [Pull requests
  11](/kmackay/micro-ecc/pulls)
* [Actions](/kmackay/micro-ecc/actions)
* [Projects
  0](/kmackay/micro-ecc/projects)
* [Wiki](/kmackay/micro-ecc/wiki)
* [Security](/kmackay/micro-ecc/security)
* [Insights](/kmackay/micro-ecc/pulse)

Additional navigation options

* [Code](/kmackay/micro-ecc)
* [Issues](/kmackay/micro-ecc/issues)
* [Pull requests](/kmackay/micro-ecc/pulls)
* [Actions](/kmackay/micro-ecc/actions)
* [Projects](/kmackay/micro-ecc/projects)
* [Wiki](/kmackay/micro-ecc/wiki)
* [Security](/kmackay/micro-ecc/security)
* [Insights](/kmackay/micro-ecc/pulse)

## Commit

[Permalink](/kmackay/micro-ecc/commit/1b5f5cea5145c96dd8791b9b2c41424fc74c2172)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix for [#168](https://github.com/kmackay/micro-ecc/issues/168)

[Browse files](/kmackay/micro-ecc/tree/1b5f5cea5145c96dd8791b9b2c41424fc74c2172)
Browse the repository at this point in the history

* Loading branch information

[![@kmackay](https://avatars.githubusercontent.com/u/3208815?s=40&v=4)](/kmackay)

[kmackay](/kmackay/micro-ecc/commits?author=kmackay "View all commits by kmackay")
committed
Oct 7, 2020

1 parent
[622a7f8](/kmackay/micro-ecc/commit/622a7f82ac9f5e9b2871de4acd59799f45fa5d3b)

commit 1b5f5ce

Showing
**1 changed file**
with
**13 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

17 changes: 13 additions & 4 deletions

17
[uECC.c](#diff-10db6f8897720c185091cbe32bf9916cc5d6f7aeeb7bfcbc851cbdb01731d033 "uECC.c")

Show comments

[View file](/kmackay/micro-ecc/blob/1b5f5cea5145c96dd8791b9b2c41424fc74c2172/uECC.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1210,7 +1210,7 @@ static void bits2int(uECC\_word\_t \*native, |
|  |  | bcopy((uint8\_t \*) native, bits, bits\_size); |
|  |  | #else |
|  |  | uECC\_vli\_bytesToNative(native, bits, bits\_size); |
|  |  | #endif |
|  |  | #endif |
|  |  | if (bits\_size \* 8 <= (unsigned)curve->num\_n\_bits) { |
|  |  | return; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1239,6 +1239,7 @@ static int uECC\_sign\_with\_k(const uint8\_t \*private\_key, |
|  |  | uECC\_word\_t tmp[uECC\_MAX\_WORDS]; |
|  |  | uECC\_word\_t s[uECC\_MAX\_WORDS]; |
|  |  | uECC\_word\_t \*k2[2] = {tmp, s}; |
|  |  | uECC\_word\_t \*initial\_Z = 0; |
|  |  | #if uECC\_VLI\_NATIVE\_LITTLE\_ENDIAN |
|  |  | uECC\_word\_t \*p = (uECC\_word\_t \*)signature; |
|  |  | #else |
| Expand All | | @@ -1255,7 +1256,15 @@ static int uECC\_sign\_with\_k(const uint8\_t \*private\_key, |
|  |  | } |
|  |  |  |
|  |  | carry = regularize\_k(k, tmp, s, curve); |
|  |  | EccPoint\_mult(p, curve->G, k2[!carry], 0, num\_n\_bits + 1, curve); |
|  |  | /\* If an RNG function was specified, try to get a random initial Z value to improve |
|  |  | protection against side-channel attacks. \*/ |
|  |  | if (g\_rng\_function) { |
|  |  | if (!uECC\_generate\_random\_int(k2[carry], curve->p, num\_words)) { |
|  |  | return 0; |
|  |  | } |
|  |  | initial\_Z = k2[carry]; |
|  |  | } |
|  |  | EccPoint\_mult(p, curve->G, k2[!carry], initial\_Z, num\_n\_bits + 1, curve); |
|  |  | if (uECC\_vli\_isZero(p, num\_words)) { |
|  |  | return 0; |
|  |  | } |
| Expand Down  Expand Up | | @@ -1299,7 +1308,7 @@ static int uECC\_sign\_with\_k(const uint8\_t \*private\_key, |
|  |  | bcopy((uint8\_t \*) signature + curve->num\_bytes, (uint8\_t \*) s, curve->num\_bytes); |
|  |  | #else |
|  |  | uECC\_vli\_nativeToBytes(signature + curve->num\_bytes, curve->num\_bytes, s); |
|  |  | #endif |
|  |  | #endif |
|  |  | return 1; |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -1472,7 +1481,7 @@ int uECC\_verify(const uint8\_t \*public\_key, |
|  |  | uECC\_word\_t \*\_public = (uECC\_word\_t \*)public\_key; |
|  |  | #else |
|  |  | uECC\_word\_t \_public[uECC\_MAX\_WORDS \* 2]; |
|  |  | #endif |
|  |  | #endif |
|  |  | uECC\_word\_t r[uECC\_MAX\_WORDS], s[uECC\_MAX\_WORDS]; |
|  |  | wordcount\_t num\_words = curve->num\_words; |
|  |  | wordcount\_t num\_n\_words = BITS\_TO\_WORDS(curve->num\_n\_bits); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1b5f5ce`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkmackay%2Fmicro-ecc%2Fcommit%2F1b5f5cea5145c96dd8791b9b2c41424fc74c2172) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.aisec.fraunhofer.de_9735de12_20250119_114545.html ===


Titel - Suche

[![](/content/dam/aisec/aisec_190x52.gif)
Fraunhofer-Institut für Angewandte und Integrierte Sicherheit](/)

[Fraunhofer-Institut für Angewandte und Integrierte Sicherheit](/)
[zurück zur Startseite](/)

* [Jobs und Karriere](/de/jobs.html)
* [Ansprechpartner](/de/das-institut/kontakt-und-anfahrt/ansprechpartner.html)
* [Publikationen](/de/das-institut/publikationen.html)
* [Kontakt und Anfahrt](/de/das-institut/kontakt-und-anfahrt.html)
* [Blog](/de/blog.html)
* [English](/en.html)

* [Das Fraunhofer AISEC](/de/das-institut.html)
  [X]
  [Das Fraunhofer AISEC](/de/das-institut.html)
  + [Im Profil](/de/das-institut/im-profil.html)
  + [Wissenschaftliche Exzellenz](/de/das-institut/wissenschaftliche-exzellenz.html)
  + [Kooperationsmöglichkeiten](/de/das-institut/Kooperationen.html)
  + [Qualitätsmanagement](/de/das-institut/qualitaetsmanagement.html)
  + [Kontakt und Anfahrt](/de/das-institut/kontakt-und-anfahrt.html)
  + [Publikationen](/de/das-institut/publikationen.html)
    - [Jahresbericht 2022](/de/das-institut/publikationen/jahresbericht-2022.html)
    - [Jahresbericht 2023](/de/das-institut/publikationen/Jahresbericht2023.html)
  + [Unser Netzwerk](/de/das-institut/netzwerk.html)
  + [Kuratorium](/de/das-institut/kuratorium.html)
  + [Laborlandschaft](/de/das-institut/laborraeume.html)
  + [Statement für Demokratie](/de/das-institut/statement-fuer-demokratie.html)
* [Forschungsabteilungen](/de/forschungsabteilungen.html)
  [X]
  [Forschungsabteilungen](/de/forschungsabteilungen.html)
  + [Cognitive Security Technologies](/de/forschungsabteilungen/CST.html)
  + [Hardware Security](/de/forschungsabteilungen/HWS.html)
  + [Product Protection and Industrial Security](/de/forschungsabteilungen/PIN.html)
  + [Service and Application Security](/de/forschungsabteilungen/SAS.html)
  + [Secure Operating Systems](/de/forschungsabteilungen/SOS.html)
  + [Secure Systems Engineering](/de/forschungsabteilungen/SSE.html)
  + [Secure Infrastructure](/de/forschungsabteilungen/SIS.html)
* [Spotlights](/de/spotlights.html)
  [X]
  [Spotlights](/de/spotlights.html)
  + [Cyber Resilience Act](/de/spotlights/Cyber-Resilience-Act-Sicherheitsanforderungen-fuer-Produkte-mit-digitalen-Elementen.html)
  + [Vertrauenswürdige Elektronik](/de/spotlights/vertrauenswuerdige-elektronik.html)
  + [Post-Quanten-Kryptografie](/de/spotlights/kompetenzzentrum-post-quanten-kryptografie.html)
  + [Deepfakes](/de/spotlights/Deepfakes.html)
* [Presse und Veranstaltungen](/de/presse-und-veranstaltungen.html)
  [X]
  [Presse und Veranstaltungen](/de/presse-und-veranstaltungen.html)
  + [Veranstaltungen](/de/presse-und-veranstaltungen/veranstaltungen.html)
    - [Workshop Sichere & Vertrauenswürdige Hardware](/de/presse-und-veranstaltungen/veranstaltungen/workshop--sichere-und-vertrauenswuerdige-hardware-.html)
  + [Pressemitteilungen](/de/presse-und-veranstaltungen/pressemitteilungen.html)
  + [Newsletter](/de/presse-und-veranstaltungen/NewsletterAbo.html)
  + [Medien](/de/presse-und-veranstaltungen/Medien.html)
* [Jobs und Karriere](/de/jobs.html)
  [X]
  [Jobs und Karriere](/de/jobs.html)
  + [Duales Studium](/de/jobs/Duales_Studium.html)
    - [AISEC-2021-28](/de/jobs/Duales_Studium/aisec-2021-28.html)
    - [AISEC-2021-27](/de/jobs/Duales_Studium/aisec-2021-27.html)
* [Lernlabor Cybersicherheit](/de/lernlabor.html)
  [X]
  [Lernlabor Cybersicherheit](/de/lernlabor.html)
  + [Fachbeirat](/de/lernlabor/fachbeirat_LLCS.html)
  + [Charlie und die Quantenfabrik](/de/lernlabor/SeriousGame.html)
  + [Kompetenzlücken schließen](/de/lernlabor/Interview.html)
* [Blog](/de/blog.html)
* Mehr

Wo bin ich?

* [Deutsch](/)
* [Das Fraunhofer AISEC](/de/das-institut.html)
* [Wissenschaftliche Exzellenz](/de/das-institut/wissenschaftliche-exzellenz.html)
* Security and Trust in Open Source Security Tokens

# Security and Trust in Open Source Security Tokens

Passwords are the most common authentication mechanism for private as well as professional IT services such as social media, banking or enterprise infrastructure. Unfortunately, the use of passwords leads to many security issues. Weak passwords allow for guessing or dictionary attacks, password re-use may lead to credential stuffing where stolen passwords are used for other services of the same users.

This is why hardware security tokens are often used as a second authentication factor to increase the security. These tokens have been designed to prevent the described threats effectively by using strong cryptography and a securely stored key. Although the use of security tokens is generally helpful to improve authentication security, tokens could be manipulated at multiple points before they reach the end user. Starting from the actual token designs going into internationally distributed production, then to the supply chain and distribution to end users, there is significant additional attack surface for malicious manipulation.

In the paper **[Security and Trust in Open Source Security Tokens](https://eprint.iacr.org/2021/640.pdf)**, we investigated the trustworthiness of security tokens. We specifically concentrate on security tokens which are marketed as open source and focus on hardware attacks in supply chain and evil maid scenarios. We perform a systematic analysis of the most important commercially available candidates. The trustworthiness of the security tokens was assessed according to a top-down methodology which we outline shortly in the following. We uncovered several vulnerabilities for which we were able to contribute effective software-based mitigation measures to the respective open source projects. All details can be found in the paper. The uncovered vulnerabilities in hardware indicated that respective microchips must only be used with caution when security is important for a product.

##

![](/de/das-institut/wissenschaftliche-exzellenz/security-and-trust-in-open-source-security-tokens/jcr:content/contentPar/sectioncomponent/sectionParsys/textwithasset_897530638/imageComponent/image.img.jpg/1621239832585/Architectural-Attacks-HWS.jpg "Architectural Attacks_Hardware Security")

© Fraunhofer AISECArchitectural Attacks

#### **Architectural Attacks**

We started with an evaluation of the device architecture and by identifying components which are used for the storage of secrets and authentication operations. Based on the preliminary analysis, we investigated whether the existing inter-chip and debug interfaces have any exploitable logical flaws or are prone to known vulnerabilities. Within this step we successfully compromised the Nitrokey FIDO U2F and the Nitrokey Pro 2 token security measures. The Librem Key from Purism is identical to the Nitrokey Pro 2 and as such it is by this attack affected as well. The attacks are explained in detail in chapter 5 and 6 of this paper.

**Relevant CVEs:**

* Nitrokey FIDO U2F - CVE-2020-12061
* ST Microelectronics STM32F1 - CVE-2020-8004

##

#### **Side-Channel Attacks**

If the previous attempts did not reveal any weaknesses, we focused on the cryptographic implementations that are used during the authentication operations. For that, we used pen-like EM measurement probes with coarse spatial resolution and oscilloscopes operating in a sub-GHz range. This side-channel analysis led to the successful recovery of the private keys for the micro-ecc library, which is used within the Solokeys Solo and the Nitrokey FIDO2 token, and the ARM CryptoCell hardware accelerator, which is contained in the nRF52840 microcontroller and which is part of the Google OpenSK and the Feitian OpenSK token. The details about the side-channel analysis and key recovery is explained in chapter 7.1 and 8.1.

**Relevant CVEs:**

* micro-ecc - CVE-2020-27209
* Nordic Semiconductor nRF52840 - CVE-2020-27211

![](/de/das-institut/wissenschaftliche-exzellenz/security-and-trust-in-open-source-security-tokens/jcr:content/contentPar/sectioncomponent/sectionParsys/textwithasset_1445364373/imageComponent/image.img.jpg/1621239887161/Side-Channel-Attacks-HWS.jpg "Side-Channel-Atttacks_Hardware Security")

© Fraunhofer AISEC Side-Channel Attacks

##

![](/de/das-institut/wissenschaftliche-exzellenz/security-and-trust-in-open-source-security-tokens/jcr:content/contentPar/sectioncomponent/sectionParsys/textwithasset_1911974987/imageComponent/image.img.jpg/1621239912261/Fault-Injection-Attacks-HWS.jpg "Fault Injection Attacks_Hardware Security")

© Fraunhofer AISECFault Injection Attacks

#### **Fault Injection Attacks**

To further assess the security, we investigated the hardware security features of the included chips in more detail. In this step, we evaluated if included chips exhibit exploitable vulnerabilities with the help of side-channel analyses and fault injections. Due to the black box nature of the implemented security measures reverse engineering effort is needed. We were able to circumvent the read-out protection of the STM32L4 and the nRF52840 microcontroller, which are used in the SoloKeys Solo & Somu, the Nitrokey FIDO2, the Google OpenSK and the Feititan OpenSK. The details of these attacks can be found in chapter 7.2 and 8.2.

**Relevant CVEs:**

* ST Microelectronics STM32L4 - CVE-2020-27212, CVE-2021-29414
* Nordic Semiconductor nRF52840 - CVE-2021-29415
* SoloKeys Solo & Somu - CVE-2020-27208
* Nitrokey FIDO2 - CVE-2020-27208

Despite our findings, authentication tokens and second factor authentication are clearly beneficial for security. However, our findings show that it is not always easy to rely on hardware security features which are provided by chip manufacturers. **We conclude that it is highly important to carefully assess the security of microchips against physical attacks in a capable laboratory**. Some vulnerabilities can be mitigated using proper countermeasures, as it was the case here. We proposed effective countermeasures which, at the time of writing, have already been partially implemented. In this way we were able to contribute to the security of current and future authentication tokens. In other cases, however, hardware vulnerabilities may be unrecoverable. This shows the high relevance of hardware security for the security of end products. The full details of the analysis, attacks as well as countermeasures can be found in the paper, which is open access and linked below.

## Further information

* [Read the paper](https://eprint.iacr.org/2021/640.pdf "Read the paper")
* [CHES 2021](https://www.iacr.org/cryptodb/data/paper.php?pubkey=31282%20)

## Authors

### Contact Press / Media

#### Marc Schink

Hardware Security

Fraunhofer AISEC
Lichtenbergstraße 11
85748 Garching b. München

Telefon  +49 89 3229986-144

* E-Mail senden
* marc.schink@aisec.fraunhofer.de

### Contact Press / Media

#### Alexander Wagner

Hardware Security

Fraunhofer AISEC
Lichtenbergstraße 11
85748 Garching b. München

Telefon  +49 89 3229986-149

* E-Mail senden
* alexander.wagner@aisec.fraunhofer.de

### Contact Press / Media

#### Florian Unterstein

Hardware Security

Fraunhofer AISEC
Lichtenbergstraße 11
85748 Garching b. München

### Kontakt

### Contact Press / Media

#### Marc Schink

Hardware Security

Fraunhofer AISEC
Lichtenbergstraße 11
85748 Garching b. München

Telefon  +49 89 3229986-144

* E-Mail senden
* marc.schink@aisec.fraunhofer.de

### Contact Press / Media

#### Alexander Wagner

Hardware Security

Fraunhofer AISEC
Lichtenbergstraße 11
85748 Garching b. München

Telefon  +49 89 3229986-149

* E-Mail senden
* alexander.wagner@aisec.fraunhofer.de

## Navigation und Social Media

### Teilen

Drucken

* [Besucherregelung](/de/Besucherregelungen.html)
* [Ausschreibungen](/de/Ausschreibungen.html)
* [Beschaffung](/de/Beschaffung.html)
* [Impressum](/de/impressum.html)
* [Datenschutzerklärung](/de/datenschutzerklaerung.html)

© 2025

**Quelle: Fraunhofer-Gesellschaft
Fraunhofer-Institut für Angewandte und Integrierte Sicherheit - Security and Trust in Open Source Security Tokens**

Online im Internet; URL: https://www.aisec.fraunhofer.de/de/das-institut/wissenschaftliche-exzellenz/security-and-trust-in-open-source-security-tokens.html

Datum: 16.1.2025 21:08


