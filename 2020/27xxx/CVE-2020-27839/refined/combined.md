=== Content from bugzilla.redhat.com_6ffc7b73_20250119_125324.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1901330)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1901330)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1901330)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1901330

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1901330**](show_bug.cgi?id=1901330)
(CVE-2020-27839)
- [CVE-2020-27839](https://access.redhat.com/security/cve/CVE-2020-27839) ceph-dashboard: Don't use Browser's LocalStorage for storing JWT but Secure Cookies with proper HTTP Headers

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2020-27839 ceph-dashboard: Don't use Browser's LocalStorage for storing J...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2020-27839 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1906948](show_bug.cgi?id=1906948) [1906954](show_bug.cgi?id=1906954 "CLOSED ERRATA - CVE-2020-27839 ceph: ceph-dashboard: Don't use Browser's LocalStorage for storing JWT but Secure Cookies with proper HTTP Headers [fedora-all]") [1910511](show_bug.cgi?id=1910511) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1898181](show_bug.cgi?id=1898181) | | TreeView+ | [depends on](buglist.cgi?bug_id=1901330&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1901330&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2020-11-24 21:21 UTC by Sage McTaggart | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2024-12-18 19:56 UTC ([History](show_activity.cgi?id=1901330)) | | [CC List:](page.cgi?id=fields.html#cclist) | 38 users (show)  amctagga anharris aoconnor bniver branto danmick david dbecker eglynn fedora flucifre gfidente gmeno hvyas i jdurgin jjoyce josef jschluet kdreyer lhh loic lpeer lsvaty madam mbenjamin mburns mgarciac mhackett mhicks ocs-bugs pgrist ramkrsna sclewis slinaber sostapov steve vereddy | | Fixed In Version: | ceph-dashboard 14.2.17, ceph-dashboard 15.2.9 | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A flaw was found in ceph-dashboard. The JSON Web Token (JWT) used for user authentication is stored by the frontend application in the browser’s localStorage which is potentially vulnerable to attackers via XSS attacks. The highest threat from this vulnerability is to data confidentiality and integrity. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2021-06-15 21:03:54 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Ceph Project Bug Tracker | [44591](https://tracker.ceph.com/issues/44591) | 0 | None | None | None | 2021-01-12 00:21:15 UTC | | Red Hat Bugzilla | [1889435](show_bug.cgi?id=1889435 "CLOSED ERRATA - (CVE-2020-27839) [security] Don't use Browser's LocalStorage for storing JWT but Secure Cookies with proper HTTP Headers") | 1 | medium | CLOSED | (CVE-2020-27839) [security] Don't use Browser's LocalStorage for storing JWT but Secure Cookies with proper HTTP Headers | 2021-08-30 08:31:33 UTC | | Red Hat Product Errata | [RHSA-2021:2445](https://access.redhat.com/errata/RHSA-2021%3A2445) | 0 | None | None | None | 2021-06-15 17:13:02 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1901330#c0)  Sage McTaggart    2020-11-24 21:21:55 UTC  ``` Issue:  The JSON Web Token (JWT) used for user authentication is stored the by the frontend application in the browser’s localStorage.   Suggestion:  Do not store sensitive data in HTML5 localStorage, not even temporarily. Use cookies with appropriate security flags (secure, HttpOnly, SameSite).   ```  [Comment 6](show_bug.cgi?id=1901330#c6)  Sage McTaggart    2020-12-11 22:39:41 UTC  ``` Created ceph tracking bugs for this issue:  Affects: fedora-all [[bug 1906954](show_bug.cgi?id=1906954 "CLOSED ERRATA - CVE-2020-27839 ceph: ceph-dashboard: Don't use Browser's LocalStorage for storing JWT but Secure Cookies with proper HTTP Headers [fedora-all]")]   ```  [Comment 10](show_bug.cgi?id=1901330#c10)  Sage McTaggart    2020-12-17 18:34:46 UTC  ``` <https://tracker.ceph.com/issues/44591> attaching ceph tracker for reference.   ```  [Comment 12](show_bug.cgi?id=1901330#c12)  Eric Christensen    2021-02-17 20:14:48 UTC  ``` Statement:  * Red Hat Ceph Storage 3 is not affected as it does not use authentication for the dashboard.  * Red Hat OpenStack Platform deployments use the ceph package directly from the Ceph channel; the RHOSP package will not be updated at this time.  * Red Hat OpenShift Container Storage (RHOCS) 4 shipped ceph package for the usage of RHOCS 4.2 only which has reached End of Life. The shipped version of ceph package is neither used nor supported with the release of RHOCS 4.3.  * Red Hat Enterprise Linux 8 does not include the ceph dashboard component.   ```  [Comment 13](show_bug.cgi?id=1901330#c13)  Eric Christensen    2021-02-17 20:14:50 UTC  ``` Mitigation:  Do not store sensitive data in HTML5 localStorage, not even temporarily. Use cookies with appropriate security flags (secure, HttpOnly, SameSite).   ```  [Comment 14](show_bug.cgi?id=1901330#c14)  errata-xmlrpc    2021-06-15 17:12:58 UTC  ``` This issue has been addressed in the following products:    Red Hat Ceph Storage 4.2  Via RHSA-2021:2445 [https://access.redhat.com/errata/RHSA-2021:2445](https://access.redhat.com/errata/RHSA-2021%3A2445)   ```  [Comment 15](show_bug.cgi?id=1901330#c15)  Product Security DevOps Team    2021-06-15 21:03:54 UTC  ``` This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):  <https://access.redhat.com/security/cve/cve-2020-27839>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1901330&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from tracker.ceph.com_7be33f3e_20250119_142248.html ===


⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/dashboard/search):

 Dashboard[All Projects](/projects?jump=issues)
# [Ceph](/projects/ceph?jump=issues) » [mgr](/projects/mgr?jump=issues) » Dashboard

* [Overview](/projects/dashboard)
* [Activity](/projects/dashboard/activity)
* [Roadmap](/projects/dashboard/roadmap)
* [Issues](/projects/dashboard/issues)

### Tags

 [GSoC22](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=GSoC22) [administration](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=administration) [angular](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=angular) [carbon](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=carbon) [cds](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=cds) [cephadm](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=cephadm) [cleanup](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=cleanup) [configuration](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=configuration) [dashboard\_sprint\_23](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=dashboard_sprint_23) [datatable](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=datatable) [debuggability](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=debuggability) [dependency](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=dependency) [development](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=development) [documentation](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=documentation) [e2e](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=e2e) [feature-gap](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=feature-gap) [good-first-issue](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=good-first-issue) [grafana](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=grafana) [ha](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=ha) [i18n](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=i18n) [installation](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=installation) [isci](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=isci) [logging](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=logging) [low-hanging-fruit](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=low-hanging-fruit) [main-failures](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=main-failures) [management](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=management) [monitoring](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=monitoring) [notifications](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=notifications) [observability](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=observability) [osd](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=osd)
### Custom queries

* [API Test Failures](/projects/dashboard/issues?query_id=334)
* [Backports](/projects/dashboard/issues?query_id=236)
* [Backports: nautilus](/projects/dashboard/issues?query_id=235)
* [Bug queue](/projects/dashboard/issues?query_id=27)
* [Bug queue (last 30 days)](/projects/dashboard/issues?query_id=244)
* [Bug triage](/projects/dashboard/issues?query_id=40)
* [Categorized under Usability + UX](/projects/dashboard/issues?query_id=326)
* [Clean-ups](/projects/dashboard/issues?query_id=245)
* [Crash queue](/projects/dashboard/issues?query_id=241)
* [Crash triage](/projects/dashboard/issues?query_id=240)
* [Dashboard bugs (last 180 days)](/projects/dashboard/issues?query_id=297)
* [Dashboard Bugs (NEW) in the last 30 days (except accessibility)](/projects/dashboard/issues?query_id=275)
* [Dashboard CDS](/projects/dashboard/issues?query_id=271)
* [Dashboard Sprint 23](/projects/dashboard/issues?query_id=246)
* [Feedback](/projects/dashboard/issues?query_id=30)
* [Low Hanging Fruit](/projects/dashboard/issues?query_id=278)
* [Monitoring](/projects/dashboard/issues?query_id=251)
* [My issues](/projects/dashboard/issues?query_id=7)
* [Need Review](/projects/dashboard/issues?query_id=32)
* [Pending backports](/projects/dashboard/issues?query_id=60)
* [Product Backlog Scrub](/projects/dashboard/issues?query_id=45)
* [Quincy: backlog](/projects/dashboard/issues?query_id=238)
* [Rook - Dashboard Integration bugs](/projects/dashboard/issues?query_id=300)
* [Telemetry](/projects/dashboard/issues?query_id=255)
* [Test Failures](/projects/dashboard/issues?query_id=277)

Actions
Copy link
## Bug #44591

closed

[Feature #47765](/issues/47765): mgr/dashboard: security improvements

### CVE-2020-27839: mgr/dashboard: The ceph dashboard is vulnerable to XSS attacks

Added by Anonymous [almost 5 years](/projects/dashboard/activity?from=2020-03-13 "03/13/2020 07:49 AM") ago.
Updated [over 3 years](/projects/dashboard/activity?from=2021-04-22 "04/22/2021 11:15 AM") ago.

Status:ResolvedPriority:HighAssignee:[Avan Thakkar](/users/10851)Category:GeneralTarget version:-% Done:

|  |
| --- |

0%

Source:Backport:octopus, nautilusRegression:NoSeverity:3 - minorReviewed:Affected Versions:ceph-qa-suite:Pull request ID:[38259](https://github.com/ceph/ceph/pull/38259)Crash signature (v1):Crash signature (v2):Tags (freeform):
Tags:[usability](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=usability) [low-hanging-fruit](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=low-hanging-fruit) [management](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=management) [configuration](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=configuration) [security](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=security) [administration](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=administration) [documentation](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=documentation) [installation](/projects/dashboard/issues?fields%5B%5D=issue_tags&operators%5Bissue_tags%5D=%3D&set_filter=1&values%5Bissue_tags%5D%5B%5D=installation)

---

**Description**

To authenticate the user with the ceph dashboard the user can exchange a username and password for a jwt token. This token will be stored inside the users browser. On every request, the ceph dashboard attaches this token to the 'Authorization' header to get access to the api.
The problem is how we store this token. Currently, we just save it inside the local storage of the browser which makes it vulnerable to XSS attacks. If any of our npm dependencies is compromised, an attacker could steal the token of a user and use it. I also tried to inject malicious code into the translation files, we host on transifex. I did not manage to attack the dashboard with that approach, because the angular i18n compiler rejected all script tags, but that does not mean that it is not possible.
Keeping the npm packages up to date is very important, but doesn't fix the problem either. Not anyone, who is running a ceph cluster, is going to update it on a regular basis (every week or two).

Currently I see three solutions:

* Critical actions should always ask for user credentials
  What are critical actions? From my point of view, at least all user management actions. Changing the role of a user or en- and disabling an account of another user should not be possible without entering the password of the current user.

* 2FA
  Using two factor authentication will mitigate attacks. At least the attacker cannot request a token with just the username and password. The XSS problem would still exist.

* Double submitted cookies
  Storing the jwt token in a httpOnly cookie prevents XSS attacks, but opens the door for csrf attacks. With sending two coockies, one containing the jwt header and payload (httpOnly disabled), and one containing the signature, could be a solution. JavaScript can not read the content of httpOnly cookies, but the content of cookies without httpOnly. So, our frontend could read the header.payload and sends it with every request, inside a meta tag. The backend could then reconstruct the token.

Please see: <https://medium.com/lightrail/getting-token-authentication-right-in-a-stateless-single-page-application-57d0c6474e3> for more details

---

**Related issues**
[4](/issues?issue_id=48584%2C47341%2C48738%2C48739&set_filter=true&status_id=%2A) ([1 open](/issues?issue_id=48584%2C47341%2C48738%2C48739&set_filter=true&status_id=o) — [3 closed](/issues?issue_id=48584%2C47341%2C48738%2C48739&set_filter=true&status_id=c))

|  | Related to Dashboard - [Cleanup #48584](/issues/48584): mgr/dashboard: remove auth/check and modify redirectURL for SSO | New |  |  |  | |  | | --- | | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  | Related to Dashboard - [Cleanup #47341](/issues/47341): mgr/dashboard: securing CherryPy | Resolved | [Avan Thakkar](/users/10851) |  |  | |  | | --- | | Actions |
|  | Copied to Dashboard - [Backport #48738](/issues/48738): nautilus: CVE-2020-27839: mgr/dashboard: The ceph dashboard is vulnerable to XSS attacks | Resolved | [Aashish Sharma](/users/11319) |  |  |  | Actions |
|  | Copied to Dashboard - [Backport #48739](/issues/48739): octopus: CVE-2020-27839: mgr/dashboard: The ceph dashboard is vulnerable to XSS attacks | Resolved | [Avan Thakkar](/users/10851) |  |  |  | Actions |

Related to
Is duplicate of
Has duplicate
Blocks
Blocked by
Precedes
Follows
Copied to
Copied from
Issue #
Delay:  days

Cancel

* [History](/issues/44591?tab=history)
* [Notes](/issues/44591?tab=notes)
* [Property changes](/issues/44591?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by Anonymous [almost 5 years](/projects/dashboard/activity?from=2020-03-13 "03/13/2020 07:52 AM") ago

* **Description** updated ([diff](/journals/160947/diff?detail_id=164975 "View differences"))

ActionsCopy link
[#2](#note-2)
#### Updated by Stephan Müller [over 4 years](/projects/dashboard/activity?from=2020-05-07 "05/07/2020 03:38 PM") ago

Another approach that could help would be to using a data stream instead of HTTP1.1 polling by using websockets or HTTP2 (<https://tracker.ceph.com/issues/45306>).

Another thing could be to store the IP of the user in the backend and force a relogin, by expiring the session, if the IP or MAC has changed.

ActionsCopy link
[#3](#note-3)
#### Updated by [Ernesto Puerta](/users/7374) [over 4 years](/projects/dashboard/activity?from=2020-10-19 "10/19/2020 04:31 PM") ago

* **Parent task** set to *#47765*

ActionsCopy link
[#4](#note-4)
#### Updated by [Ernesto Puerta](/users/7374) [about 4 years](/projects/dashboard/activity?from=2020-12-01 "12/01/2020 11:42 AM") ago

Sebastian: `httpOnly` prevents XSS while `secure` and `SameSite=Strict` together [prevent CRSF attacks](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite)... I've been reading [this OWASP page](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html) but I couldn't find an understandable explanation on why they state that `SameSite` set cookies don't fully prevent CSRF. My bet is that they don't consider the combination of `httpOnly + secure + SameSite=strict`.

In fact, the [author of that Medium blog post has this conversation with a user](https://medium.com/%40kin_ng5/why-not-just-use-one-http-only-cookie-for-the-jwt-and-have-the-front-end-make-another-request-for-1146a8ac7936):
```

@Kin Ng: why not just use one http only cookie for the jwt and have the front end make another request for the necessary user role info and store in memory?

@author: While that approach would certainly work for general authentication and role info retrieval and security, going to one cookie wouldn’t allow the other benefits mentioned around session timeout and extension that relies on the cookies having different expiry settings

```

The most relevant thing is that we ensure that we don't have GET methods that trigger unsafe actions/side-effects (I checked that I saw none).

ActionsCopy link
[#5](#note-5)
#### Updated by [Ernesto Puerta](/users/7374) [about 4 years](/projects/dashboard/activity?from=2020-12-02 "12/02/2020 12:21 PM") ago

Additionally, now Ceph-Dashboard requires an `Accept` header that follows an un-standard pattern `application/vnd...+json`, so [this is one (custom header) the 3 strategies OWASP recommends](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html#use-of-custom-request-headers) to complement the `SameSite` setting.

ActionsCopy link
[#6](#note-6)
#### Updated by [Ernesto Puerta](/users/7374) [about 4 years](/projects/dashboard/activity?from=2020-12-09 "12/09/2020 09:26 AM") ago

* **Status** changed from *New* to *Fix Under Review*
* **Assignee** set to *Avan Thakkar*
* **Pull request ID** set to *38259*

ActionsCopy link
[#7](#note-7)
#### Updated by [Avan Thakkar](/users/10851) [about 4 years](/projects/dashboard/activity?from=2020-12-14 "12/14/2020 08:06 AM") ago

* **Related to** *[Cleanup #48584](/issues/48584): mgr/dashboard: remove auth/check and modify redirectURL for SSO* added

ActionsCopy link
[#8](#note-8)
#### Updated by [Nathan Cutler](/users/2544) [about 4 years](/projects/dashboard/activity?from=2020-12-14 "12/14/2020 01:24 PM") ago

* **Backport** set to *octopus, nautilus*

(Optimistic that this will be backported)

ActionsCopy link
[#9](#note-9)
#### Updated by [Volker Theile](/users/6612) [about 4 years](/projects/dashboard/activity?from=2021-01-04 "01/04/2021 10:12 AM") ago

* **Status** changed from *Fix Under Review* to *Pending Backport*

ActionsCopy link
[#10](#note-10)
#### Updated by [Backport Bot](/users/12172) [about 4 years](/projects/dashboard/activity?from=2021-01-04 "01/04/2021 10:16 AM") ago

* **Copied to** *[Backport #48738](/issues/48738): nautilus: CVE-2020-27839: mgr/dashboard: The ceph dashboard is vulnerable to XSS attacks* added

ActionsCopy link
[#11](#note-11)
#### Updated by [Backport Bot](/users/12172) [about 4 years](/projects/dashboard/activity?from=2021-01-04 "01/04/2021 10:16 AM") ago

* **Copied to** *[Backport #48739](/issues/48739): octopus: CVE-2020-27839: mgr/dashboard: The ceph dashboard is vulnerable to XSS attacks* added

ActionsCopy link
[#12](#note-12)
#### Updated by [Ken Dreyer](/users/1362) [about 4 years](/projects/dashboard/activity?from=2021-01-12 "01/12/2021 11:15 PM") ago

* **Subject** changed from *mgr/dashboard: The ceph dashboard is vulnerable to XSS attacks* to *CVE-2020-27839: mgr/dashboard: The ceph dashboard is vulnerable to XSS attacks*

We're tracking this as CVE-2020-27839.

ActionsCopy link
[#13](#note-13)
#### Updated by [Avan Thakkar](/users/10851) [almost 4 years](/projects/dashboard/activity?from=2021-02-12 "02/12/2021 12:17 PM") ago

* **Related to** *[Cleanup #47341](/issues/47341): mgr/dashboard: securing CherryPy* added

ActionsCopy link
[#14](#note-14)
#### Updated by [Avan Thakkar](/users/10851) [almost 4 years](/projects/dashboard/activity?from=2021-02-16 "02/16/2021 02:15 PM") ago

* **Status** changed from *Pending Backport* to *Resolved*

ActionsCopy link
[#15](#note-15)
#### Updated by [Ernesto Puerta](/users/7374) [over 3 years](/projects/dashboard/activity?from=2021-04-22 "04/22/2021 11:15 AM") ago

* **Tracker** changed from *Enhancement* to *Bug*
* **Project** changed from *mgr* to *Dashboard*
* **Category** changed from *132* to *General*
* **Regression** set to *No*
* **Severity** set to *3 - minor*

Actions
Copy link

Also available in: [Atom](/issues/44591.atom)
[PDF](/issues/44591.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...



=== Content from access.redhat.com_e3eb7ab6_20250119_142246.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)


