- **Root cause of vulnerability**: Integer overflow in the `tvm_value_array_allocate` function when calculating the allocation size for a new array, triggered by the `NEWA` instruction in the Garmin ConnectIQ TVM.
- **Weaknesses/vulnerabilities present**: The `tvm_value_array_allocate` function does not properly check for integer overflows when calculating the allocation size for an array. The `NEWA` instruction only checks for negative array lengths but doesn't consider the potential for integer overflow during the subsequent size calculation.
- **Impact of exploitation**: Successful exploitation allows a ConnectIQ app to perform read/write operations across the entire MAX32630 address space, effectively escaping the application's restricted execution environment. This allows for arbitrary code execution on the device.
- **Attack vectors**: A malicious ConnectIQ app that has been installed on the device, leveraging the `NEWA` instruction with a large array size to cause the integer overflow. The attacker has to directly manipulate the bytecode.
- **Required attacker capabilities/position**: The attacker needs the ability to create and install a malicious ConnectIQ application on a vulnerable Garmin Forerunner 235 device running firmware version 7.90. The attacker needs to craft specific bytecode to trigger the overflow.