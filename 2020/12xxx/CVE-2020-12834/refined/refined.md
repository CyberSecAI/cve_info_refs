- **Root cause of vulnerability:** The vulnerability stems from the default auto-login feature enabled during the first-time setup or after a factory reset of eQ-3 Homematic CCU2 and CCU3 devices. This auto-login bypasses authentication, allowing unauthenticated attackers access to the web interface. Furthermore, the JSON API method `ReGa.runScript` allows execution of arbitrary shell commands via the undocumented `system.Exec()` call.
- **Weaknesses/vulnerabilities present:**
    - **Improper Authorization (CWE-285):** The default auto-login feature bypasses user authentication, granting unauthorized access to the web interface.
    - **Remote Code Execution:** The `ReGa.runScript` method allows execution of arbitrary shell commands using the `system.Exec()` function, which can be leveraged to execute malicious code on the device.
- **Impact of exploitation:** Successful exploitation allows an attacker to execute arbitrary code on the vulnerable device, leading to full compromise, which can result in complete control over the device, data exfiltration, denial of service, and further attacks on the network.
- **Attack vectors:**
    - An attacker accesses the web interface of the device, which is automatically logged in due to the default auto-login feature.
    - The attacker then sends a crafted JSON API request to the `ReGa.runScript` method, including a malicious script utilizing `system.Exec()` to execute commands on the system.
- **Required attacker capabilities/position:**
    - The attacker needs to have network access to the web interface of the vulnerable Homematic CCU2 or CCU3 device.
    - The attacker does not need to authenticate because the auto-login feature is enabled by default.
    - The attacker must be able to send HTTP requests to the device.