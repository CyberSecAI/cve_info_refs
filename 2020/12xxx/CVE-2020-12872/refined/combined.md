=== Content from github.com_01572da6_20250119_125626.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ferlyaws%2Fyaws%2Freleases)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ferlyaws%2Fyaws%2Freleases)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Findex&source=header-repo&source_repo=erlyaws%2Fyaws)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[erlyaws](/erlyaws)
/
**[yaws](/erlyaws/yaws)**
Public

* [Notifications](/login?return_to=%2Ferlyaws%2Fyaws) You must be signed in to change notification settings
* [Fork
  269](/login?return_to=%2Ferlyaws%2Fyaws)
* [Star
   1.3k](/login?return_to=%2Ferlyaws%2Fyaws)

* [Code](/erlyaws/yaws)
* [Issues
  32](/erlyaws/yaws/issues)
* [Pull requests
  3](/erlyaws/yaws/pulls)
* [Actions](/erlyaws/yaws/actions)
* [Projects
  0](/erlyaws/yaws/projects)
* [Wiki](/erlyaws/yaws/wiki)
* [Security](/erlyaws/yaws/security)
* [Insights](/erlyaws/yaws/pulse)

Additional navigation options

* [Code](/erlyaws/yaws)
* [Issues](/erlyaws/yaws/issues)
* [Pull requests](/erlyaws/yaws/pulls)
* [Actions](/erlyaws/yaws/actions)
* [Projects](/erlyaws/yaws/projects)
* [Wiki](/erlyaws/yaws/wiki)
* [Security](/erlyaws/yaws/security)
* [Insights](/erlyaws/yaws/pulse)

# Releases: erlyaws/yaws

[Releases](/erlyaws/yaws/releases)
[Tags](/erlyaws/yaws/tags)

Releases ¬∑ erlyaws/yaws
## Yaws 2.2.0

13 Jul 23:08

![@vinoski](https://avatars.githubusercontent.com/u/57131?s=40&v=4)
[vinoski](/vinoski)

[yaws-2.2.0](/erlyaws/yaws/tree/yaws-2.2.0)

[`9801b57`](/erlyaws/yaws/commit/9801b576e271770c8362b9493850d5780eb028ef)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/erlyaws/yaws/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...yaws-2.2.0)

 Loading

[View all tags](/erlyaws/yaws/tags)

[Yaws 2.2.0](/erlyaws/yaws/releases/tag/yaws-2.2.0)
[Latest](/erlyaws/yaws/releases/latest)

[Latest](/erlyaws/yaws/releases/latest)

## What's changed

* rebar3 is now supported on the `master` branch
* Add support for Erlang/OTP 27.0
* Raise minimum supported Erlang/OTP version to 23.0
* Various small bug fixes

**Full Changelog**: [yaws-2.1.1...yaws-2.2.0](https://github.com/erlyaws/yaws/compare/yaws-2.1.1...yaws-2.2.0)

## New Contributors

* [@cl0ne](https://github.com/cl0ne) made their first contribution in [#450](https://github.com/erlyaws/yaws/pull/450)
* [@michalmuskala](https://github.com/michalmuskala) made their first contribution in [#452](https://github.com/erlyaws/yaws/pull/452)
* [@sudnam](https://github.com/sudnam) made their first contribution in [#466](https://github.com/erlyaws/yaws/pull/466)
* [@mikpe](https://github.com/mikpe) made their first contribution in [#474](https://github.com/erlyaws/yaws/pull/474)
* [@gnaeser](https://github.com/gnaeser) made their first contribution in [#477](https://github.com/erlyaws/yaws/pull/477)

### Contributors

* [![@cl0ne](https://avatars.githubusercontent.com/u/271097?s=64&v=4)](https://github.com/cl0ne)
* [![@michalmuskala](https://avatars.githubusercontent.com/u/477062?s=64&v=4)](https://github.com/michalmuskala)
* [![@sudnam](https://avatars.githubusercontent.com/u/2221340?s=64&v=4)](https://github.com/sudnam)
* [![@gnaeser](https://avatars.githubusercontent.com/u/5903818?s=64&v=4)](https://github.com/gnaeser)
* [![@mikpe](https://avatars.githubusercontent.com/u/7581288?s=64&v=4)](https://github.com/mikpe)

cl0ne, michalmuskala, and 3 other contributors

 Assets
2

 Loading

 üëç
2
 leeyisoft and cl0ne reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

 2 people reacted

## Yaws 2.1.1

04 Feb 14:09

![@vinoski](https://avatars.githubusercontent.com/u/57131?s=40&v=4)
[vinoski](/vinoski)

[yaws-2.1.1](/erlyaws/yaws/tree/yaws-2.1.1)

[`5c08d0c`](/erlyaws/yaws/commit/5c08d0cb12036015240f14fe44bdd16baced80f5)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/erlyaws/yaws/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...yaws-2.1.1)

 Loading

[View all tags](/erlyaws/yaws/tags)

[Yaws 2.1.1](/erlyaws/yaws/releases/tag/yaws-2.1.1)

* Add support for reproducible/deterministic builds
* Fix problem with SSL options under Erlang/OTP 24
* Move build verification to Github Actions
* Reenable compilation warnings by default
* Fix URL encoding issue with directory listings
* Logging enhancements
* Raise minimum supported version of Erlang/OTP to 21.3

 Assets
2

 Loading

All reactions

## Yaws 2.1.0

14 Nov 16:59

![@vinoski](https://avatars.githubusercontent.com/u/57131?s=40&v=4)
[vinoski](/vinoski)

[yaws-2.1.0](/erlyaws/yaws/tree/yaws-2.1.0)

[`b2282da`](/erlyaws/yaws/commit/b2282da62a49d43ed196413875c58580ceab9972)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/erlyaws/yaws/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...yaws-2.1.0)

 Loading

[View all tags](/erlyaws/yaws/tags)

[Yaws 2.1.0](/erlyaws/yaws/releases/tag/yaws-2.1.0)

* Erlang/OTP 24 support. Minimum supported Erlang/OTP version is now 21.0.
* Add support for the `SameSite` cookie
* Do not return multiple identical `Set-Cookie` headers
* Fix default IP in `sconf` record
* Ignore trailing whitespace when decoding JSON
* Add convenience function `json2:obj_fetch/3`

Various other fixes and enhancements; see the output of `git log yaws-2.0.9..yaws-2.1.0` for details.

For `rebar3` support, please use the `rebar3-support` branch. This branch will be part of a future release.

 Assets
3

 Loading

 üöÄ
2
 dch and andridus reacted with rocket emoji

All reactions

* üöÄ
  2 reactions

 2 people reacted

## Yaws 2.0.9

03 Apr 16:26

![@vinoski](https://avatars.githubusercontent.com/u/57131?s=40&v=4)
[vinoski](/vinoski)

[yaws-2.0.9](/erlyaws/yaws/tree/yaws-2.0.9)

[`2243eaf`](/erlyaws/yaws/commit/2243eaf212b3d36c2552ae93dfd9e78cf6ac64d5)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/erlyaws/yaws/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...yaws-2.0.9)

 Loading

[View all tags](/erlyaws/yaws/tags)

[Yaws 2.0.9](/erlyaws/yaws/releases/tag/yaws-2.0.9)

* Add the `options_asterisk_methods` server configuration setting for specifying a custom list of HTTP methods to return in the `Allow` header for `OPTIONS *`
* Support HTTPS for SOAP
* Handle server name wildcards correctly
* Allow `hibernate_after` as a websocket option

Various other fixes and enhancements, see the output of `git log yaws-2.0.8..yaws-2.0.9` for details.

For `rebar3` support, please use the `rebar3-support` branch. This branch will be part of the next release.

 Assets
3

 Loading

All reactions

## Yaws 2.0.8

07 Sep 15:17

![@vinoski](https://avatars.githubusercontent.com/u/57131?s=40&v=4)
[vinoski](/vinoski)

[yaws-2.0.8](/erlyaws/yaws/tree/yaws-2.0.8)

[`bcce905`](/erlyaws/yaws/commit/bcce9051fc3c468da792df8b3b008aba94436da3)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/erlyaws/yaws/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...yaws-2.0.8)

 Loading

[View all tags](/erlyaws/yaws/tags)

[Yaws 2.0.8](/erlyaws/yaws/releases/tag/yaws-2.0.8)

* Yaws 2.0.8 contains several security fixes. **Users running older versions in production are strongly urged to upgrade to 2.0.8**.
* Support for Erlang/OTP 23.
* Various other fixes and enhancements, see the output of `git log yaws-2.0.7..yaws-2.0.8` for details.

For `rebar3` support, please use the `rebar3-support` branch. This branch will be part of the next release.

 Assets
3

 Loading

All reactions

## Yaws 2.0.7

14 Jul 14:10

![@vinoski](https://avatars.githubusercontent.com/u/57131?s=40&v=4)
[vinoski](/vinoski)

[yaws-2.0.7](/erlyaws/yaws/tree/yaws-2.0.7)

[`c5aa1e3`](/erlyaws/yaws/commit/c5aa1e300105578f3c3c025b367f4d2725ae5b5d)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/erlyaws/yaws/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...yaws-2.0.7)

 Loading

[View all tags](/erlyaws/yaws/tags)

[Yaws 2.0.7](/erlyaws/yaws/releases/tag/yaws-2.0.7)

version 2.0.7

 Assets
2

 Loading

All reactions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_3aef46fd_20250119_125625.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ferlyaws%2Fyaws%2Fissues%2F402)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ferlyaws%2Fyaws%2Fissues%2F402)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=erlyaws%2Fyaws)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[erlyaws](/erlyaws)
/
**[yaws](/erlyaws/yaws)**
Public

* [Notifications](/login?return_to=%2Ferlyaws%2Fyaws) You must be signed in to change notification settings
* [Fork
  269](/login?return_to=%2Ferlyaws%2Fyaws)
* [Star
   1.3k](/login?return_to=%2Ferlyaws%2Fyaws)

* [Code](/erlyaws/yaws)
* [Issues
  32](/erlyaws/yaws/issues)
* [Pull requests
  3](/erlyaws/yaws/pulls)
* [Actions](/erlyaws/yaws/actions)
* [Projects
  0](/erlyaws/yaws/projects)
* [Wiki](/erlyaws/yaws/wiki)
* [Security](/erlyaws/yaws/security)
* [Insights](/erlyaws/yaws/pulse)

Additional navigation options

* [Code](/erlyaws/yaws)
* [Issues](/erlyaws/yaws/issues)
* [Pull requests](/erlyaws/yaws/pulls)
* [Actions](/erlyaws/yaws/actions)
* [Projects](/erlyaws/yaws/projects)
* [Wiki](/erlyaws/yaws/wiki)
* [Security](/erlyaws/yaws/security)
* [Insights](/erlyaws/yaws/pulse)

# CVE-2020-12872¬†#402

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[CVE-2020-12872](#top)#402Copy link![@carnil](https://avatars.githubusercontent.com/u/773068?u=54a9fd1cfc2b1abb34a487f17e07eb8a03cecdae&v=4&size=80)
## Description

![@carnil](https://avatars.githubusercontent.com/u/773068?u=54a9fd1cfc2b1abb34a487f17e07eb8a03cecdae&v=4&size=48)[carnil](https://github.com/carnil)opened [on May 24, 2020](https://github.com/erlyaws/yaws/issues/402#issue-623860560)

While going trough some CVE feeds and track the information noticed the [CVE-2020-12872](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12872) assignment for yaws, which is from the following [report](https://medium.com/%40charlielabs101/cve-2020-12872-df315411aa70)

Were you informed about this?

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_616dcdd7_20250119_142408.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ferlyaws%2Fyaws%2Fissues%2F402)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ferlyaws%2Fyaws%2Fissues%2F402)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=erlyaws%2Fyaws)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[erlyaws](/erlyaws)
/
**[yaws](/erlyaws/yaws)**
Public

* [Notifications](/login?return_to=%2Ferlyaws%2Fyaws) You must be signed in to change notification settings
* [Fork
  269](/login?return_to=%2Ferlyaws%2Fyaws)
* [Star
   1.3k](/login?return_to=%2Ferlyaws%2Fyaws)

* [Code](/erlyaws/yaws)
* [Issues
  32](/erlyaws/yaws/issues)
* [Pull requests
  3](/erlyaws/yaws/pulls)
* [Actions](/erlyaws/yaws/actions)
* [Projects
  0](/erlyaws/yaws/projects)
* [Wiki](/erlyaws/yaws/wiki)
* [Security](/erlyaws/yaws/security)
* [Insights](/erlyaws/yaws/pulse)

Additional navigation options

* [Code](/erlyaws/yaws)
* [Issues](/erlyaws/yaws/issues)
* [Pull requests](/erlyaws/yaws/pulls)
* [Actions](/erlyaws/yaws/actions)
* [Projects](/erlyaws/yaws/projects)
* [Wiki](/erlyaws/yaws/wiki)
* [Security](/erlyaws/yaws/security)
* [Insights](/erlyaws/yaws/pulse)

# CVE-2020-12872¬†#402

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[CVE-2020-12872](#top)#402Copy link![@carnil](https://avatars.githubusercontent.com/u/773068?u=54a9fd1cfc2b1abb34a487f17e07eb8a03cecdae&v=4&size=80)
## Description

![@carnil](https://avatars.githubusercontent.com/u/773068?u=54a9fd1cfc2b1abb34a487f17e07eb8a03cecdae&v=4&size=48)[carnil](https://github.com/carnil)opened [on May 24, 2020](https://github.com/erlyaws/yaws/issues/402#issue-623860560)

While going trough some CVE feeds and track the information noticed the [CVE-2020-12872](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12872) assignment for yaws, which is from the following [report](https://medium.com/%40charlielabs101/cve-2020-12872-df315411aa70)

Were you informed about this?

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_33a177cc_20250119_125623.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ferlyaws%2Fyaws%2Fblob%2Fc0fd79f17d52628fcec527da7fa3e788c283c445%2Fsrc%2Fyaws_config.erl)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ferlyaws%2Fyaws%2Fblob%2Fc0fd79f17d52628fcec527da7fa3e788c283c445%2Fsrc%2Fyaws_config.erl)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=erlyaws%2Fyaws)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[erlyaws](/erlyaws)
/
**[yaws](/erlyaws/yaws)**
Public

* [Notifications](/login?return_to=%2Ferlyaws%2Fyaws) You must be signed in to change notification settings
* [Fork
  269](/login?return_to=%2Ferlyaws%2Fyaws)
* [Star
   1.3k](/login?return_to=%2Ferlyaws%2Fyaws)

* [Code](/erlyaws/yaws)
* [Issues
  32](/erlyaws/yaws/issues)
* [Pull requests
  3](/erlyaws/yaws/pulls)
* [Actions](/erlyaws/yaws/actions)
* [Projects
  0](/erlyaws/yaws/projects)
* [Wiki](/erlyaws/yaws/wiki)
* [Security](/erlyaws/yaws/security)
* [Insights](/erlyaws/yaws/pulse)

Additional navigation options

* [Code](/erlyaws/yaws)
* [Issues](/erlyaws/yaws/issues)
* [Pull requests](/erlyaws/yaws/pulls)
* [Actions](/erlyaws/yaws/actions)
* [Projects](/erlyaws/yaws/projects)
* [Wiki](/erlyaws/yaws/wiki)
* [Security](/erlyaws/yaws/security)
* [Insights](/erlyaws/yaws/pulse)

## Files

¬†c0fd79f
## Breadcrumbs

1. [yaws](/erlyaws/yaws/tree/c0fd79f17d52628fcec527da7fa3e788c283c445)
2. /[src](/erlyaws/yaws/tree/c0fd79f17d52628fcec527da7fa3e788c283c445/src)
/
# yaws\_config.erl

Copy path Blame  Blame
## Latest commit

## History

[History](/erlyaws/yaws/commits/c0fd79f17d52628fcec527da7fa3e788c283c445/src/yaws_config.erl)3598 lines (3186 loc) ¬∑ 134 KB¬†c0fd79f
## Breadcrumbs

1. [yaws](/erlyaws/yaws/tree/c0fd79f17d52628fcec527da7fa3e788c283c445)
2. /[src](/erlyaws/yaws/tree/c0fd79f17d52628fcec527da7fa3e788c283c445/src)
/
# yaws\_config.erl

Top
## File metadata and controls

* Code
* Blame

3598 lines (3186 loc) ¬∑ 134 KB[Raw](https://github.com/erlyaws/yaws/raw/c0fd79f17d52628fcec527da7fa3e788c283c445/src/yaws_config.erl)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000%%%----------------------------------------------------------------------%%% File : yaws\_config.erl%%% Author : Claes Wikstrom <klacke@bluetail.com>%%% Purpose :%%% Created : 16 Jan 2002 by Claes Wikstrom <klacke@bluetail.com>%%%----------------------------------------------------------------------
-module(yaws\_config).-author('klacke@bluetail.com').
-include("../include/yaws.hrl").-include("../include/yaws\_api.hrl").-include("yaws\_debug.hrl").
-include\_lib("kernel/include/file.hrl").
-define(NEXTLINE, io\_get\_line(FD, '', [])).
-export([load/1, make\_default\_gconf/2, make\_default\_sconf/0, make\_default\_sconf/3, add\_sconf/1, add\_yaws\_auth/1, add\_yaws\_soap\_srv/1, add\_yaws\_soap\_srv/2, load\_mime\_types\_module/2, compile\_and\_load\_src\_dir/1, search\_sconf/3, search\_group/3, update\_sconf/4, delete\_sconf/3, eq\_sconfs/2, soft\_setconf/4, hard\_setconf/2, can\_hard\_gc/2, can\_soft\_setconf/4, can\_soft\_gc/2, verify\_upgrade\_args/2, toks/2]).
%% where to look for yaws.confpaths() -> case application:get\_env(yaws, config) of undefined -> case yaws:getuid() of {ok, "0"} -> %% root [yaws\_generated:etcdir() ++ "/yaws/yaws.conf"]; \_ -> %% developer [filename:join([yaws:home(), "yaws.conf"]), "./yaws.conf", yaws\_generated:etcdir() ++ "/yaws/yaws.conf"] end; {ok, File} -> [File] end.
%% load the config
load(E = #env{conf = false}) -> case yaws:first(fun(F) -> yaws:exists(F) end, paths()) of false -> {error, "Can't find any config file "}; {ok, \_, File} -> load(E#env{conf = {file, File}}) end;load(E) -> {file, File} = E#env.conf, error\_logger:info\_msg("Yaws: Using config file ~s~n", [File]), case file:open(File, [read, {encoding, E#env.encoding}]) of {ok, FD} -> GC = make\_default\_gconf(E#env.debug, E#env.id), GC1 = if E#env.traceoutput == undefined -> GC; true -> ?gc\_set\_tty\_trace(GC, E#env.traceoutput) end, GC2 = ?gc\_set\_debug(GC1, E#env.debug), GC3 = GC2#gconf{trace = E#env.trace}, R = fload(FD, GC3), ?Debug("FLOAD(~s): ~p", [File, R]), case R of {ok, GC4, Cs} -> yaws:mkdir(yaws:tmpdir()), Cs1 = add\_yaws\_auth(Cs), add\_yaws\_soap\_srv(GC4), validate\_cs(GC4, Cs1); Err -> Err end; Err -> {error, ?F("Can't open config file ~s: ~p", [File, Err])} end.
add\_yaws\_soap\_srv(GC) when GC#gconf.enable\_soap == true -> add\_yaws\_soap\_srv(GC, true);add\_yaws\_soap\_srv(\_GC) -> [].add\_yaws\_soap\_srv(GC, false) when GC#gconf.enable\_soap == true -> [{yaws\_soap\_srv, {yaws\_soap\_srv, start\_link, [GC#gconf.soap\_srv\_mods]}, permanent, 5000, worker, [yaws\_soap\_srv]}];add\_yaws\_soap\_srv(GC, true) when GC#gconf.enable\_soap == true -> Spec = add\_yaws\_soap\_srv(GC, false), case whereis(yaws\_soap\_srv) of undefined -> spawn(fun() -> supervisor:start\_child(yaws\_sup, hd(Spec)) end); \_ -> ok end, Spec;add\_yaws\_soap\_srv(\_GC, \_Start) -> [].
add\_yaws\_auth(#sconf{}=SC) -> SC#sconf{authdirs = setup\_auth(SC)};add\_yaws\_auth(SCs) -> [SC#sconf{authdirs = setup\_auth(SC)} || SC <- SCs].
%% We search and setup www authenticate for each directory%% specified as an auth directory or containing a .yaws\_auth file.%% These are merged with server conf.setup\_auth(#sconf{docroot = Docroot, xtra\_docroots = XtraDocroots, authdirs = Authdirs}=SC) -> [begin Authdirs1 = load\_yaws\_auth\_from\_docroot(D, ?sc\_auth\_skip\_docroot(SC)), Authdirs2 = load\_yaws\_auth\_from\_authdirs(Authdirs, D, []), Authdirs3 = [A || A <- Authdirs1, not lists:keymember(A#auth.dir,#auth.dir,Authdirs2)], Authdirs4 = ensure\_auth\_headers(Authdirs3 ++ Authdirs2), start\_pam(Authdirs4), {D, Authdirs4} end || D <- [Docroot|XtraDocroots] ].
load\_yaws\_auth\_from\_docroot(\_, true) -> [];load\_yaws\_auth\_from\_docroot(undefined, \_) -> [];load\_yaws\_auth\_from\_docroot(Docroot, \_) -> Fun = fun (Path, Acc) -> %% Strip Docroot and then filename SP = string:sub\_string(Path, length(Docroot)+1), Dir = filename:dirname(SP), A = #auth{docroot=Docroot, dir=Dir}, case catch load\_yaws\_auth\_file(Path, A) of {ok, L} -> L ++ Acc; \_Other -> Acc end end, filelib:fold\_files(Docroot, "^.yaws\_auth$", true, Fun, []).
load\_yaws\_auth\_from\_authdirs([], \_, Acc) -> lists:reverse(Acc);load\_yaws\_auth\_from\_authdirs([Auth = #auth{dir=Dir}| Rest], Docroot, Acc) -> if Auth#auth.docroot /= [] andalso Auth#auth.docroot /= Docroot -> load\_yaws\_auth\_from\_authdirs(Rest, Docroot, Acc); Auth#auth.docroot == [] -> Auth1 = Auth#auth{dir=filename:nativename(Dir)}, F = fun(A) -> (A#auth.docroot == Docroot andalso A#auth.dir == Auth1#auth.dir) end, case lists:any(F, Acc) of true -> load\_yaws\_auth\_from\_authdirs(Rest, Docroot, Acc); false -> Acc1 = Acc ++ load\_yaws\_auth\_from\_authdir(Docroot, Auth1), load\_yaws\_auth\_from\_authdirs(Rest, Docroot, Acc1) end; true -> %% #auth.docroot == Docroot Auth1 = Auth#auth{docroot=Docroot, dir=filename:nativename(Dir)}, F = fun(A) -> not (A#auth.docroot == [] andalso A#auth.dir == Auth1#auth.dir) end, Acc1 = lists:filter(F, Acc), Acc2 = Acc1 ++ load\_yaws\_auth\_from\_authdir(Docroot, Auth1), load\_yaws\_auth\_from\_authdirs(Rest, Docroot, Acc2) end;load\_yaws\_auth\_from\_authdirs([{Docroot, Auths}|\_], Docroot, Acc) -> load\_yaws\_auth\_from\_authdirs(Auths, Docroot, Acc);load\_yaws\_auth\_from\_authdirs([\_| Rest], Docroot, Acc) -> load\_yaws\_auth\_from\_authdirs(Rest, Docroot, Acc).
load\_yaws\_auth\_from\_authdir(Docroot, Auth) -> Dir = case Auth#auth.dir of "/" ++ R -> R; \_ -> Auth#auth.dir end, Path = filename:join([Docroot, Dir, ".yaws\_auth"]), case catch load\_yaws\_auth\_file(Path, Auth) of {ok, Auths} -> Auths; \_ -> [Auth] end.
load\_yaws\_auth\_file(Path, Auth) -> case file:consult(Path) of {ok, TermList} -> error\_logger:info\_msg("Reading .yaws\_auth ~s~n", [Path]), parse\_yaws\_auth\_file(TermList, Auth); {error, enoent} -> {error, enoent}; Error -> error\_logger:format("Bad .yaws\_auth file ~s ~p~n", [Path, Error]), Error end.
ensure\_auth\_headers(Authdirs) -> [add\_auth\_headers(Auth) || Auth <- Authdirs].
add\_auth\_headers(Auth = #auth{headers = []}) -> %% Headers needs to be set Realm = Auth#auth.realm, Headers = yaws:make\_www\_authenticate\_header({realm, Realm}), Auth#auth{headers = Headers};add\_auth\_headers(Auth) -> Auth.
start\_pam([]) -> ok;start\_pam([#auth{pam = false}|T]) -> start\_pam(T);start\_pam([A|T]) -> case whereis(yaws\_pam) of undefined -> % pam not started Spec = {yaws\_pam, {yaws\_pam, start\_link, [yaws:to\_list(A#auth.pam),undefined,undefined]}, permanent, 5000, worker, [yaws\_pam]}, spawn(fun() -> supervisor:start\_child(yaws\_sup, Spec) end); \_ -> start\_pam(T) end.
parse\_yaws\_auth\_file([], Auth=#auth{files=[]}) -> {ok, [Auth]};parse\_yaws\_auth\_file([], Auth=#auth{dir=Dir, files=Files}) -> {ok, [Auth#auth{dir=filename:join(Dir, F), files=[F]} || F <- Files]};
parse\_yaws\_auth\_file([{realm, Realm}|T], Auth0) -> parse\_yaws\_auth\_file(T, Auth0#auth{realm = Realm});
parse\_yaws\_auth\_file([{pam, Pam}|T], Auth0) when is\_atom(Pam) -> parse\_yaws\_auth\_file(T, Auth0#auth{pam = Pam});
parse\_yaws\_auth\_file([{authmod, Authmod0}|T], Auth0) when is\_atom(Authmod0)-> Headers = try Authmod0:get\_header() ++ Auth0#auth.headers catch \_:\_ -> error\_logger:format("Failed to ~p:get\_header() \n", [Authmod0]), Auth0#auth.headers end, parse\_yaws\_auth\_file(T, Auth0#auth{mod = Authmod0, headers = Headers});
parse\_yaws\_auth\_file([{file, File}|T], Auth0) -> Files = case File of "/" ++ F -> [F|Auth0#auth.files]; \_ -> [File|Auth0#auth.files] end, parse\_yaws\_auth\_file(T, Auth0#auth{files=Files});
parse\_yaws\_auth\_file([{User, Password}|T], Auth0) when is\_list(User), is\_list(Password) -> Salt = crypto:strong\_rand\_bytes(32), Hash = crypto:hash(sha256, [Salt, Password]), Users = case lists:member({User, sha256, Salt, Hash}, Auth0#auth.users) of true -> Auth0#auth.users; false -> [{User, sha256, Salt, Hash} | Auth0#auth.users] end, parse\_yaws\_auth\_file(T, Auth0#auth{users = Users});
parse\_yaws\_auth\_file([{User, Algo, B64Hash}|T], Auth0) when is\_list(User), is\_list(Algo), is\_list(B64Hash) -> case parse\_auth\_user(User, Algo, "", B64Hash) of {ok, Res} -> Users = case lists:member(Res, Auth0#auth.users) of true -> Auth0#auth.users; false -> [Res | Auth0#auth.users] end, parse\_yaws\_auth\_file(T, Auth0#auth{users = Users}); {error, Reason} -> error\_logger:format("Failed to parse user line ~p: ~p~n", [{User, Algo, B64Hash}, Reason]), parse\_yaws\_auth\_file(T, Auth0) end;
parse\_yaws\_auth\_file([{User, Algo, B64Salt, B64Hash}|T], Auth0) when is\_list(User), is\_list(Algo), is\_list(B64Salt), is\_list(B64Hash) -> case parse\_auth\_user(User, Algo, B64Salt, B64Hash) of {ok, Res} -> Users = case lists:member(Res, Auth0#auth.users) of true -> Auth0#auth.users; false -> [Res | Auth0#auth.users] end, parse\_yaws\_auth\_file(T, Auth0#auth{users = Users}); {error, Reason} -> error\_logger:format("Failed to parse user line ~p: ~p~n", [{User, Algo, B64Hash, B64Hash}, Reason]), parse\_yaws\_auth\_file(T, Auth0) end;
parse\_yaws\_auth\_file([{allow, all}|T], Auth0) -> Auth1 = case Auth0#auth.acl of none -> Auth0#auth{acl={all, [], deny\_allow}}; {\_,D,O} -> Auth0#auth{acl={all, D, O}} end, parse\_yaws\_auth\_file(T, Auth1);
parse\_yaws\_auth\_file([{allow, IPs}|T], Auth0) when is\_list(IPs) -> Auth1 = case Auth0#auth.acl of none -> AllowIPs = parse\_auth\_ips(IPs, []), Auth0#auth{acl={AllowIPs, [], deny\_allow}}; {all, \_, \_} -> Auth0; {AllowIPs, DenyIPs, Order} -> AllowIPs2 = parse\_auth\_ips(IPs, []) ++ AllowIPs, Auth0#auth{acl={AllowIPs2, DenyIPs, Order}} end, parse\_yaws\_auth\_file(T, Auth1);
parse\_yaws\_auth\_file([{deny, all}|T], Auth0) -> Auth1 = case Auth0#auth.acl of none -> Auth0#auth{acl={[], all, deny\_allow}}; {A,\_,O} -> Auth0#auth{acl={A, all, O}} end, parse\_yaws\_auth\_file(T, Auth1);
parse\_yaws\_auth\_file([{deny, IPs}|T], Auth0) when is\_list(IPs) -> Auth1 = case Auth0#auth.acl of none -> DenyIPs = parse\_auth\_ips(IPs, []), Auth0#auth{acl={[], DenyIPs, deny\_allow}}; {\_, all, \_} -> Auth0; {AllowIPs, DenyIPs, Order} -> DenyIPs2 = parse\_auth\_ips(IPs, []) ++ DenyIPs, Auth0#auth{acl={AllowIPs, DenyIPs2, Order}} end, parse\_yaws\_auth\_file(T, Auth1);
parse\_yaws\_auth\_file([{order, O}|T], Auth0) when O == allow\_deny; O == deny\_allow -> Auth1 = case Auth0#auth.acl of none -> Auth0#auth{acl={[], [], O}}; {A,D,\_} -> Auth0#auth{acl={A, D, O}} end, parse\_yaws\_auth\_file(T, Auth1).
%% Create mime\_types.erl, compile it and load it. If everything is ok,%% reload groups.%%%% If an error occured, the previously-loaded version (the first time, it's the%% static version) is kept.load\_mime\_types\_module(GC, Groups) -> GInfo = GC#gconf.mime\_types\_info, SInfos = [{{SC#sconf.servername, SC#sconf.port}, SC#sconf.mime\_types\_info} || SC <- lists:flatten(Groups), SC#sconf.mime\_types\_info /= undefined],
 case {is\_dir(yaws:id\_dir(GC#gconf.id)), is\_dir(yaws:tmpdir("/tmp"))} of {true, \_} -> File = filename:join(yaws:id\_dir(GC#gconf.id), "mime\_types.erl"), load\_mime\_types\_module(File, GInfo, SInfos); {\_, true} -> File = filename:join(yaws:tmpdir("/tmp"), "mime\_types.erl"), load\_mime\_types\_module(File, GInfo, SInfos); \_ -> error\_logger:format("Cannot write module mime\_types.erl~n" "Keep the previously-loaded version~n", []) end, lists:map(fun(Gp) -> [begin F = fun(X) when is\_atom(X) -> X; (X) -> element(1, mime\_types:t(SC, X)) end, TAS = SC#sconf.tilde\_allowed\_scripts, AS = SC#sconf.allowed\_scripts, SC#sconf{tilde\_allowed\_scripts=lists:map(F, TAS), allowed\_scripts=lists:map(F, AS)} end || SC <- Gp] end, Groups).
load\_mime\_types\_module(\_, undefined, []) -> ok;load\_mime\_types\_module(File, undefined, SInfos) -> load\_mime\_types\_module(File, #mime\_types\_info{}, SInfos);load\_mime\_types\_module(File, GInfo, SInfos) -> case mime\_type\_c:generate(File, GInfo, SInfos) of ok -> case compile:file(File, [binary]) of {ok, ModName, Binary} -> case code:load\_binary(ModName, [], Binary) of {module, ModName} -> ok; {error, What} -> error\_logger:format( "Cannot load module '~p': ~p~n" "Keep the previously-loaded version~n", [ModName, What] ) end; \_ -> error\_logger:format("Compilation of '~p' failed~n" "Keep the previously-loaded version~n", [File]) end; {error, Reason} -> error\_logger:format("Cannot write module ~p: ~p~n" "Keep the previously-loaded version~n", [File, Reason]) end.
%% Compile modules found in the configured source directories, recursively.compile\_and\_load\_src\_dir(GC) -> Incs = lists:map(fun(Dir) -> {i, Dir} end, GC#gconf.include\_dir), Opts = [binary, return] ++ Incs, lists:foreach(fun(D) -> compile\_and\_load\_src\_dir([], [D], Opts) end, GC#gconf.src\_dir).
compile\_and\_load\_src\_dir(\_Dir, [], \_Opts) -> ok;compile\_and\_load\_src\_dir(Dir, [Entry0|Rest], Opts) -> Entry1 = case Dir of [] -> Entry0; \_ -> filename:join(Dir, Entry0) end, case filelib:is\_dir(Entry1) of true -> case file:list\_dir(Entry1) of {ok, Files} -> compile\_and\_load\_src\_dir(Entry1, Files, Opts); {error, Reason} -> error\_logger:format("Failed to compile modules in ~p: ~s~n", [Entry1, file:format\_error(Reason)]) end; false -> case filename:extension(Entry0) of ".erl" -> compile\_module\_src\_dir(Entry1, Opts); \_ -> ok end end, compile\_and\_load\_src\_dir(Dir, Rest, Opts).
compile\_module\_src\_dir(File, Opts) -> case catch compile:file(File, Opts) of {ok, Mod, Bin} -> error\_logger:info\_msg("Compiled ~p~n", [File]), load\_src\_dir(File, Mod, Bin); {ok, Mod, Bin, []} -> error\_logger:info\_msg("Compiled ~p [0 Errors - 0 Warnings]~n", [File]), load\_src\_dir(File, Mod, Bin); {ok, Mod, Bin, Warnings} -> WsMsg = [format\_compile\_warns(W,[]) || W <- Warnings], error\_logger:warning\_msg("Compiled ~p [~p Errors - ~p Warnings]~n~s", [File,0,length(WsMsg),WsMsg]), load\_src\_dir(File, Mod, Bin); {error, [], Warnings} -> WsMsg = [format\_compile\_warns(W,[]) || W <- Warnings], error\_logger:format("Failed to compile ~p " "[~p Errors - ~p Warnings]~n~s" "\*\*\* warnings being treated as errors~n", [File,0,length(WsMsg),WsMsg]); {error, Errors, Warnings} -> WsMsg = [format\_compile\_warns(W,[]) || W <- Warnings], EsMsg = [format\_compile\_errs(E,[]) || E <- Errors], error\_logger:format("Failed to compile ~p " "[~p Errors - ~p Warnings]~n~s~s", [File,length(EsMsg),length(WsMsg),EsMsg,WsMsg]); error -> error\_logger:format("Failed to compile ~p~n", [File]); {'EXIT', Reason} -> error\_logger:format("Failed to compile ~p: ~p~n", [File, Reason]) end.
load\_src\_dir(File, Mod, Bin) -> case code:load\_binary(Mod, File, Bin) of {module, Mod} -> ok; {error, Reason} -> error\_logger:format("Cannot load module ~p: ~p~n", [Mod, Reason]) end.
format\_compile\_warns({\_, []}, Acc) -> lists:reverse(Acc);format\_compile\_warns({File, [{L,M,E}|Rest]}, Acc) -> Msg = io\_lib:format(" ~s:~w: Warning: ~s~n", [File,L,M:format\_error(E)]), format\_compile\_warns({File, Rest}, [Msg|Acc]).
format\_compile\_errs({\_, []}, Acc) -> lists:reverse(Acc);format\_compile\_errs({File, [{L,M,E}|Rest]}, Acc) -> Msg = io\_lib:format(" ~s:~w: ~s~n", [File,L,M:format\_error(E)]), format\_compile\_errs({File, Rest}, [Msg|Acc]).
%% This is the function that arranges sconfs into%% different server groupsvalidate\_cs(GC, Cs) -> L = lists:map(fun(#sconf{listen=IP0}=SC0) -> SC = case is\_tuple(IP0) of false -> {ok, IP} = inet\_parse:address(IP0), SC0#sconf{listen=IP}; true -> SC0 end, {{SC#sconf.listen, SC#sconf.port}, SC} end, Cs), L2 = lists:map(fun(X) -> element(2, X) end, lists:keysort(1,L)), L3 = arrange(L2, start, [], []), case validate\_groups(GC, L3) of ok -> {ok, GC, L3}; Err -> Err end.
validate\_groups(\_, []) -> ok;validate\_groups(GC, [H|T]) -> case (catch validate\_group(GC, H)) of ok -> validate\_groups(GC, T); Err -> Err end.
validate\_group(GC, List) -> [SC0|SCs] = List,
 %% all servers with the same IP/Port must share the same tcp configuration case lists:all(fun(SC) -> lists:keyfind(listen\_opts, 1, SC#sconf.soptions) == lists:keyfind(listen\_opts, 1, SC0#sconf.soptions) end, SCs) of true -> ok; false -> throw({error, ?F("Servers in the same group must share the same tcp" " configuration: ~p", [SC0#sconf.servername])}) end,
 %% If the default servers (the first one) is not an SSL server: %% all servers with the same IP/Port must be non-SSL server %% If SNI is disabled or not supported: %% all servers with the same IP/Port must share the same SSL config %% If SNI is enabled: %% TLS protocol must be supported by the default servers (the first one) if SC0#sconf.ssl == undefined -> case lists:all(fun(SC) -> SC#sconf.ssl == SC0#sconf.ssl end, SCs) of true -> ok; false -> throw({error, ?F("All servers in the same group than" " ~p must have no SSL configuration", [SC0#sconf.servername])}) end; GC#gconf.sni == disable -> case lists:all(fun(SC) -> SC#sconf.ssl == SC0#sconf.ssl end, SCs) of true -> ok; false -> throw({error, ?F("SNI is disabled, all servers in the same" " group than ~p must share the same ssl" " configuration", [SC0#sconf.servername])}) end;
 true -> Vs = case (SC0#sconf.ssl)#ssl.protocol\_version of undefined -> proplists:get\_value(available,ssl:versions()); L -> L end, F = fun(V) -> lists:member(V, ['tlsv1.3','tlsv1.2','tlsv1.1',tlsv1]) end, case lists:any(F, Vs) of true -> ok; false -> throw({error, ?F("SNI is enabled, the server ~p must enable" " TLS protocol", [SC0#sconf.servername])}) end end,
 %% all servernames in a group must be unique SN = lists:sort([yaws:to\_lower(X#sconf.servername) || X <- List]), no\_two\_same(SN).
no\_two\_same([H,H|\_]) -> throw({error, ?F("Two servers in the same group cannot have same name ~p",[H])});no\_two\_same([\_H|T]) -> no\_two\_same(T);no\_two\_same([]) -> ok.
arrange([C|Tail], start, [], B) -> C1 = set\_server(C), arrange(Tail, {in, C1}, [C1], B);arrange([], \_, [], B) -> B;arrange([], \_, A, B) -> [lists:reverse(A) | B];arrange([C|Tail], {in, C0}, A, B) -> C1 = set\_server(C), if C1#sconf.listen == C0#sconf.listen, C1#sconf.port == C0#sconf.port -> arrange(Tail, {in, C0}, [C1|A], B); true -> arrange(Tail, {in, C1}, [C1], [lists:reverse(A)|B]) end.
set\_server(SC) -> SC1 = if SC#sconf.port == 0 -> {ok, P} = yaws:find\_private\_port(), SC#sconf{port=P}; true -> SC end, case {SC1#sconf.ssl, SC1#sconf.port, ?sc\_has\_add\_port(SC1)} of {undefined, 80, \_} -> SC1; {undefined, Port, true} -> add\_port(SC1, Port); {\_SSL, 443, \_} -> SC1; {\_SSL, Port, true} -> add\_port(SC1, Port); {\_,\_,\_} -> SC1 end.
add\_port(SC, Port) -> case string:tokens(SC#sconf.servername, ":") of [Srv, Prt] -> case (catch list\_to\_integer(Prt)) of {'EXIT', \_} -> SC#sconf{servername = Srv ++ [$:|integer\_to\_list(Port)]}; \_Int -> SC end; [Srv] -> SC#sconf{servername = Srv ++ [$:|integer\_to\_list(Port)]} end.
make\_default\_gconf(Debug, Id) -> Y = yaws\_dir(), Flags = (?GC\_COPY\_ERRLOG bor ?GC\_FAIL\_ON\_BIND\_ERR bor ?GC\_PICK\_FIRST\_VIRTHOST\_ON\_NOMATCH), #gconf{yaws\_dir = Y, ebin\_dir = [filename:join([Y, "examples/ebin"])], include\_dir = [filename:join([Y, "examples/include"])], trace = false, logdir = ".", cache\_refresh\_secs = if Debug == true -> 0; true -> 30 end, flags = if Debug -> Flags bor ?GC\_DEBUG; true -> Flags end,
 yaws = "Yaws " ++ yaws\_generated:version(), id = Id }.
%% Keep this function for backward compatibility. But no one is supposed to use%% it (yaws\_config is an internal module, its api is private).make\_default\_sconf() -> make\_default\_sconf([], undefined, undefined).
make\_default\_sconf([], Servername, Port) -> make\_default\_sconf(filename:join([yaws\_dir(), "www"]), Servername, Port);make\_default\_sconf(DocRoot, undefined, Port) -> make\_default\_sconf(DocRoot, "localhost", Port);make\_default\_sconf(DocRoot, Servername, undefined) -> make\_default\_sconf(DocRoot, Servername, 8000);make\_default\_sconf(DocRoot, Servername, Port) -> AbsDocRoot = filename:absname(DocRoot), case is\_dir(AbsDocRoot) of true -> set\_server(#sconf{port=Port, servername=Servername, listen={127,0,0,1},docroot=AbsDocRoot}); false -> throw({error, ?F("Invalid docroot: directory ~s does not exist", [AbsDocRoot])}) end.
yaws\_dir() -> yaws:get\_app\_dir().
string\_to\_host\_and\_port(String) -> HostPortRE = "^(?:\\[([^\\]]+)\\]|([^:]+)):([0-9]+)$", REOptions = [{capture, all\_but\_first, list}], case re:run(String, HostPortRE, REOptions) of {match, [IPv6, HostOrIPv4, Port]} -> case string:to\_integer(Port) of {Integer, []} when Integer >= 0, Integer =< 65535 -> case IPv6 of "" -> {ok, HostOrIPv4, Integer}; \_ -> {ok, IPv6, Integer} end; \_Else -> {error, ?F("~p is not a valid port number", [Port])} end; nomatch -> {error, ?F("bad host and port specifier, expected HOST:PORT; " "use [IP]:PORT for IPv6 address", [])} end.
string\_to\_node\_mod\_fun(String) -> case string:tokens(String, ":") of [Node, Mod, Fun] -> {ok, list\_to\_atom(Node), list\_to\_atom(Mod), list\_to\_atom(Fun)}; [Mod, Fun] -> {ok, list\_to\_atom(Mod), list\_to\_atom(Fun)}; \_ -> {error, ?F("bad external module specifier, " "expected NODE:MODULE:FUNCTION or MODULE:FUNCTION", [])} end.
%% two states, global, serverfload(FD, GC) -> case catch fload(FD, GC, [], 1, ?NEXTLINE) of {ok, GC1, Cs} -> {ok, GC1, lists:reverse(Cs)}; Err -> Err end.
fload(FD, GC, Cs, \_Lno, eof) -> file:close(FD), {ok, GC, Cs};
fload(FD, GC, Cs, Lno, Chars) -> case toks(Lno, Chars) of [] -> fload(FD, GC, Cs, Lno+1, ?NEXTLINE);
 ["subconfig", '=', Name] -> case subconfigfiles(FD, Name, Lno) of {ok, Files} -> case fload\_subconfigfiles(Files, global, GC, Cs) of {ok, GC1, Cs1} -> fload(FD, GC1, Cs1, Lno+1, ?NEXTLINE); Err -> Err end; Err -> Err end;
 ["subconfigdir", '=', Name] -> case subconfigdir(FD, Name, Lno) of {ok, Files} -> case fload\_subconfigfiles(Files, global, GC, Cs) of {ok, GC1, Cs1} -> fload(FD, GC1, Cs1, Lno+1, ?NEXTLINE); Err -> Err end; Err -> Err end;
 ["trace", '=', Bstr] when GC#gconf.trace == false -> case Bstr of "traffic" -> fload(FD, GC#gconf{trace = {true, traffic}}, Cs, Lno+1, ?NEXTLINE); "http" -> fload(FD, GC#gconf{trace = {true, http}}, Cs, Lno+1, ?NEXTLINE); "false" -> fload(FD, GC#gconf{trace = false}, Cs, Lno+1, ?NEXTLINE); \_ -> {error, ?F("Expect false|http|traffic at line ~w",[Lno])} end; ["trace", '=', \_Bstr] -> %% don't overwrite setting from commandline fload(FD, GC, Cs, Lno+1, ?NEXTLINE);
 ["logdir", '=', Logdir] -> Dir = case Logdir of "+" ++ D -> D1 = filename:absname(D), %% try to make the log directory if it doesn't exist yaws:mkdir(D1), D1; \_ -> filename:absname(Logdir) end, case is\_dir(Dir) of true -> put(logdir, Dir), fload(FD, GC#gconf{logdir = Dir}, Cs, Lno+1, ?NEXTLINE); false -> {error, ?F("Expect directory at line ~w (logdir ~s)", [Lno, Dir])} end;
 ["ebin\_dir", '=', Ebindir] -> Dir = filename:absname(Ebindir), case warn\_dir("ebin\_dir", Dir) of true -> fload(FD, GC#gconf{ebin\_dir = [Dir|GC#gconf.ebin\_dir]}, Cs, Lno+1, ?NEXTLINE); false -> fload(FD, GC, Cs, Lno+1, ?NEXTLINE) end;
 ["src\_dir", '=', Srcdir] -> Dir = filename:absname(Srcdir), case warn\_dir("src\_dir", Dir) of true -> fload(FD, GC#gconf{src\_dir = [Dir|GC#gconf.src\_dir]}, Cs, Lno+1, ?NEXTLINE); false -> fload(FD, GC, Cs, Lno+1, ?NEXTLINE) end;
 ["runmod", '=', Mod0] -> Mod = list\_to\_atom(Mod0), fload(FD, GC#gconf{runmods = [Mod|GC#gconf.runmods]}, Cs, Lno+1, ?NEXTLINE);
 ["enable\_soap", '=', Bool] -> if (Bool == "true") -> fload(FD, GC#gconf{enable\_soap = true}, Cs, Lno+1, ?NEXTLINE); true -> fload(FD, GC#gconf{enable\_soap = false}, Cs, Lno+1, ?NEXTLINE) end;
 ["soap\_srv\_mods", '=' | SoapSrvMods] -> case parse\_soap\_srv\_mods(SoapSrvMods, []) of {ok, L} -> fload(FD, GC#gconf{soap\_srv\_mods = L}, Cs, Lno+1, ?NEXTLINE); {error, Str} -> {error, ?F("~s at line ~w", [Str, Lno])} end;
 ["max\_connections", '=', Int] -> case (catch list\_to\_integer(Int)) of I when is\_integer(I) -> fload(FD, GC#gconf{max\_connections = I}, Cs, Lno+1, ?NEXTLINE); \_ when Int == "nolimit" -> fload(FD, GC, Cs, Lno+1, ?NEXTLINE); \_ -> {error, ?F("Expect integer at line ~w", [Lno])} end;
 ["process\_options", '=', POpts] -> case parse\_process\_options(POpts) of {ok, ProcList} -> fload(FD, GC#gconf{process\_options=ProcList}, Cs, Lno+1, ?NEXTLINE); {error, Str} -> {error, ?F("~s at line ~w", [Str, Lno])} end;
 ["large\_file\_chunk\_size", '=', Int] -> case (catch list\_to\_integer(Int)) of I when is\_integer(I) -> fload(FD, GC#gconf{large\_file\_chunk\_size = I}, Cs, Lno+1, ?NEXTLINE); \_ -> {error, ?F("Expect integer at line ~w", [Lno])} end;
 ["large\_file\_sendfile", '=', Method] -> case set\_sendfile\_flags(GC, Method) of {ok, GC1} -> fload(FD, GC1, Cs, Lno+1, ?NEXTLINE); {error, Str} -> {error, ?F("~s at line ~w", [Str, Lno])} end;
 ["acceptor\_pool\_size", '=', Int] -> case catch list\_to\_integer(Int) of I when is\_integer(I), I >= 0 -> fload(FD, GC#gconf{acceptor\_pool\_size = I}, Cs, Lno+1, ?NEXTLINE); \_ -> {error, ?F("Expect integer >= 0 at line ~w", [Lno])} end;
 ["log\_wrap\_size", '=', Int] -> case (catch list\_to\_integer(Int)) of I when is\_integer(I) -> fload(FD, GC#gconf{log\_wrap\_size = I}, Cs, Lno+1, ?NEXTLINE); \_ -> {error, ?F("Expect integer at line ~w", [Lno])} end;
 ["log\_resolve\_hostname", '=', Bool] -> case is\_bool(Bool) of {true, Val} -> fload(FD, ?gc\_log\_set\_resolve\_hostname(GC, Val), Cs, Lno+1, ?NEXTLINE); false -> {error, ?F("Expect true|false at line ~w", [Lno])} end;
 ["fail\_on\_bind\_err", '=', Bool] -> case is\_bool(Bool) of {true, Val} -> fload(FD, ?gc\_set\_fail\_on\_bind\_err(GC, Val), Cs, Lno+1, ?NEXTLINE); false -> {error, ?F("Expect true|false at line ~w", [Lno])} end;
 ["include\_dir", '=', Incdir] -> Dir = filename:absname(Incdir), case warn\_dir("include\_dir", Dir) of true -> fload(FD, GC#gconf{include\_dir= [Dir|GC#gconf.include\_dir]}, Cs, Lno+1, ?NEXTLINE); false -> fload(FD, GC, Cs, Lno+1, ?NEXTLINE)
 end;
 ["mnesia\_dir", '=', Mnesiadir] -> Dir = filename:absname(Mnesiadir), case is\_dir(Dir) of true -> put(mnesiadir, Dir), fload(FD, GC#gconf{mnesia\_dir = Dir}, Cs, Lno+1, ?NEXTLINE); false -> {error, ?F("Expect mnesia directory at line ~w", [Lno])} end;
 ["tmpdir", '=', \_TmpDir] -> %% ignore error\_logger:format( "tmpdir in yaws.conf is no longer supported - ignoring\n",[] ), fload(FD, GC, Cs, Lno+1, ?NEXTLINE);
 ["keepalive\_timeout", '=', Val] -> %% keep this bugger for backward compat for a while case (catch list\_to\_integer(Val)) of I when is\_integer(I) -> fload(FD, GC#gconf{keepalive\_timeout = I}, Cs, Lno+1, ?NEXTLINE); \_ when Val == "infinity" -> fload(FD, GC#gconf{keepalive\_timeout = infinity}, Cs, Lno+1, ?NEXTLINE); \_ -> {error, ?F("Expect integer at line ~w", [Lno])} end;
 ["keepalive\_maxuses", '=', Int] -> case (catch list\_to\_integer(Int)) of I when is\_integer(I) -> fload(FD, GC#gconf{keepalive\_maxuses = I}, Cs, Lno+1, ?NEXTLINE); \_ when Int == "nolimit" -> %% nolimit is the default fload(FD, GC, Cs, Lno+1, ?NEXTLINE); \_ -> {error, ?F("Expect integer at line ~w", [Lno])} end;
 ["php\_exe\_path", '=' , PhpPath] -> error\_logger:format( "'php\_exe\_path' is deprecated, use 'php\_handler' instead\n", []), case is\_file(PhpPath) of true ->[View remainder of file in raw view](https://github.com/erlyaws/yaws/raw/c0fd79f17d52628fcec527da7fa3e788c283c445/src/yaws_config.erl)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from avatars.githubusercontent.com_c38efc78_20250119_142408.html ===
ÔøΩÔøΩÔøΩÔøΩ ÔøΩ  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222ÔøΩÔøΩ  P P" ÔøΩÔøΩÔøΩ          
   } !1AQa"q2ÔøΩÔøΩÔøΩ#BÔøΩÔøΩRÔøΩÔøΩ$3brÔøΩ
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ       
  w !1AQaq"2ÔøΩBÔøΩÔøΩÔøΩÔøΩ #3RÔøΩbrÔøΩ
$4ÔøΩ%ÔøΩ&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ   ? ÔøΩXaÔøΩFUDffÔøΩ ÔøΩ5ÔøΩÔøΩ^eÔøΩÔøΩÔøΩw”è÷ÆoÔøΩQBÔøΩBÔøΩ6ÔøΩÔøΩ'ÔøΩ0I6|ÔøΩÔøΩrÔøΩOÔøΩ^ÔøΩkTÔøΩÔøΩMu2ÔøΩ
<ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩOÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩpÔøΩÔøΩe&ÔøΩÔøΩÔøΩÔøΩ9eY-ÔøΩ7ÔøΩÔøΩÔøΩ'aUÔøΩÔøΩÔøΩsNKkwRvÔøΩ1ÔøΩÔøΩÔøΩ 
ÔøΩ,ZzYÔøΩÔøΩ$ÔøΩÔøΩTÔøΩRÔøΩÔøΩÔøΩ~kÔøΩÔøΩ8ÔøΩ=BAÔøΩj9ÔøΩHaÔøΩÔøΩ`ÔøΩÔøΩÔøΩM<#Z|€åÔøΩÔøΩ~n0WÔøΩÔøΩeÔøΩ\*ÔøΩ3ÔøΩÔøΩ&ÔøΩn$ ÔøΩÔøΩÔøΩ]4ÔøΩMÔøΩ+InyÔøΩ4j“ü=)lÔøΩ~œ≥FÔøΩÔøΩmK&B ÔøΩÔøΩ9IQ“∞gKÔøΩtÔøΩt~ÔøΩEÔøΩÔøΩ2ÔøΩÔøΩr0q€úÔøΩÔøΩHÔøΩÔøΩÔøΩsJSlLƒπ8bÔøΩÔøΩEkÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ 3ÔøΩbÔøΩÔøΩÔøΩÔøΩÔøΩhÔøΩ/-PÔøΩlFÔøΩÔøΩ\*ÔøΩÔøΩÔªéXÔøΩ"ÔøΩ…åÔøΩJInÔøΩÔøΩzPCÔøΩ~ÔøΩ ÔøΩBÔøΩpÔøΩ~sÔøΩÔøΩÒäø¨kÔøΩÔøΩÔøΩÔøΩÔøΩ4\_.ÔøΩÔøΩÔøΩ|ÔøΩÔøΩÔøΩÔøΩGÔøΩ\_ÔøΩy^!ZvP,ÔøΩÔøΩÔøΩ⁄ΩAÔøΩ ?ÔøΩÔøΩÊÇç8y#ÔøΩÔøΩJÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩ0[ÔøΩmÃíÔøΩbÔøΩ<ÔøΩÔøΩ9ÔøΩ‘±hÔøΩ#ÔøΩ#ÔøΩ>ÔøΩÔøΩS>ÔøΩÔøΩ›±U ÔøΩ?ÔøΩnÔøΩefBÔøΩÔøΩÔøΩÔøΩ
kÔøΩnÔøΩÔøΩÔøΩÔøΩ0ÔøΩSn
-ÔøΩÔøΩÔøΩeÔøΩ ÔøΩÔøΩÔøΩÔøΩOÔøΩlÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩOÔøΩÔøΩ{[+ycIÔøΩÔøΩÔøΩÔøΩÔøΩ=rÔøΩÔøΩ@ÔøΩ\*ÔøΩ+$ÔøΩÔøΩÔøΩlSÔøΩ—ö‹¥d6GÔøΩIÔøΩ'“äÔøΩOnÔøΩÔøΩUÔøΩ e◊åÔøΩ“ÖÔøΩ]ÔøΩÔøΩ"ÔøΩivg~`\_ÔøΩÔøΩp
ÔøΩÔøΩ2ÔøΩc!LÔøΩ6ÔøΩÔøΩ\t…≠TÔøΩÔøΩB\_ÔøΩÔøΩ
ÔøΩCÔøΩÔøΩÔøΩÔøΩT#ÔøΩJÔøΩ>ÔøΩÔøΩÔøΩÔøΩtÔøΩEÔøΩÔøΩÔøΩ
ÔøΩgÔøΩ÷òlÔøΩÔøΩ.ÿÄ
€óÔøΩÔøΩÔøΩÔøΩnÔøΩ}8ÔøΩÔøΩ1\*)<}\*ÔøΩ"ÔøΩÔøΩOÔøΩ0bÔøΩ{IÔøΩÔøΩlPCn$ÔøΩÔøΩ#ÔøΩ2MdÔøΩWÔøΩ8 ÔøΩÔøΩ;ÔøΩÔøΩÔøΩS“£ÔøΩxzÔøΩÔøΩÔøΩnÔøΩÔøΩ‹∫ÔøΩ2ÔøΩÔøΩÔøΩÔøΩ~ÔøΩi8ÔøΩzuÔøΩQÔøΩiÔøΩÔøΩÔøΩÔøΩHÔøΩ|>6ÔøΩ|ÔøΩÔøΩÔøΩÔøΩÔøΩW,ÔøΩÔøΩÔøΩu[T HÔøΩ
ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩaW\*J‹∫ÔøΩÔøΩlÔøΩÔøΩUm:u=ÔøΩÔøΩ⁄Ø^ÔøΩ5ÔøΩÔøΩe^ÔøΩlÔøΩÔøΩÔøΩgÔøΩÔøΩmÔøΩ&
ÔøΩ>ÔøΩ¬∫8ÔøΩ|ÔøΩÔøΩ0m\ÔøΩÔøΩÔøΩTÔøΩÔøΩ\LÔøΩb 2ÔøΩÔøΩZ~bÔøΩ#ÔøΩÔøΩnÔøΩÔøΩÔøΩOÔøΩ')ÔøΩÔøΩ <ÔøΩÔøΩF?wÔøΩoÔøΩBÔøΩÔøΩÔøΩ%|ÔøΩLSÔøΩÔøΩÔøΩ\_ÔøΩ)ÔøΩ$qi%ÔøΩÔøΩÔøΩR ÔøΩÔøΩÔøΩZQÔøΩÔøΩWÔøΩ)(ÔøΩÔøΩdxzÔøΩÔøΩ%9g`G“™ÔøΩ ÔøΩm<ÔøΩÔøΩÔøΩÔøΩÔøΩppÔøΩ{ÔøΩÔøΩEGS"ÔøΩ"ÔøΩÔøΩÔøΩ\_ÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩ>ÔøΩÔøΩËà®lÔøΩ¬ßÔøΩ8ÔøΩ ÔøΩÔøΩ~ÔøΩÔøΩÔøΩÔøΩA,\_ÔøΩÔøΩ`√çÔøΩÔøΩÔøΩÔøΩÔøΩyÔøΩÔøΩ»πfÔøΩgÔøΩÔøΩÔøΩÔøΩ7VÔøΩÔøΩuÔøΩÔøΩnÔøΩ?:ÔøΩÔøΩÔøΩÔøΩÃ≠<{ÔøΩÔøΩÔøΩÔøΩÔøΩ]-ÔøΩÔøΩ]lÔøΩagÔøΩÔøΩ#ÔøΩt$‡∑¶…¨Ë¥´ÔøΩÔøΩÔøΩEyH ÔøΩÔøΩuÔøΩ◊®√•YÔøΩXÔøΩ2ÔøΩ,ÔøΩÔøΩa$ÔøΩ+ÔøΩ8ÔøΩ0ÔøΩRTÔøΩÔøΩ+ÔøΩÔøΩÔøΩÔøΩ ÔøΩ=ÔøΩÔøΩIÔøΩÔøΩÔøΩ+nyÊΩ¢ÔøΩÔøΩÔøΩau ÔøΩ>ÔøΩc>ÔøΩÔøΩÔøΩ#ÔøΩÔøΩÔøΩXD2ÔøΩ
gÔøΩÔøΩUsÔøΩÔøΩrIÔøΩÔøΩÔøΩÔøΩVÔøΩÔøΩhÔøΩcÔøΩnÔøΩ1ÔøΩGoŒíÔøΩlYÔøΩÔøΩ\\*HZEGÔøΩÔøΩF92zÔøΩ^ÔøΩ>vÔøΩVqÔøΩÔøΩÔøΩ~ÔøΩÔøΩ{ÔøΩXy«ñÔøΩnÔøΩÔøΩ CCLÔøΩÔøΩÔøΩÔøΩ{ÔøΩDÔøΩÔøΩT
ÔøΩN3◊øÔøΩ] ÔøΩ[hÔøΩÔøΩÔøΩP ÔøΩ:ÔøΩÔøΩZÔøΩÔøΩÔøΩR][ÔøΩÔøΩcÔøΩ4ÔøΩÔøΩÔøΩd8qÔøΩÔøΩTÔøΩÔøΩL;ÔøΩ6›§ÔøΩ<ÔøΩÔøΩ\XÔøΩ>eÔøΩÔøΩÔøΩZnvÔøΩÔøΩÔøΩhÔøΩÔøΩÔøΩaajQQÔøΩÔøΩÔøΩ)ÔøΩÔøΩÔøΩ3}hÔøΩÔøΩ?ÔøΩÔøΩt\ÔøΩÔøΩÔøΩLÔøΩÔøΩ
9ÔøΩÔøΩ◊§ÔøΩÔøΩÔøΩÿºs|ÔøΩ$[ 7ÔøΩÔøΩÔøΩÔøΩÔøΩ;VÔøΩÔøΩyÔøΩ{5ÔøΩ
ÔøΩÔøΩ"gœôÔøΩÔøΩÔøΩ8ÔøΩÔøΩÔøΩÔøΩySÔøΩ`ÔøΩwmhÔøΩÔøΩ>ÔøΩÔøΩÔøΩsÔøΩÔøΩ\*OCnÔøΩÔøΩGgo=‹¢+hdÔøΩNÔøΩcRÔøΩÔøΩÔøΩÔøΩ6ÔøΩ
##### 8ÔøΩÔøΩÔøΩ6ÔøΩ;mÔøΩ#ÔøΩ?ÔøΩWÔøΩnrÔøΩ5ÔøΩÔøΩÔøΩrwNkÔøΩÔøΩÔøΩ]I5ÔøΩÔøΩÔøΩ >ÔøΩ5ÔøΩL4⁄≥ÔøΩŒ¶9wiPÔøΩ$xtÔøΩUÔøΩÔøΩ\UkÔøΩHÔøΩlÔøΩÔøΩÔøΩÔøΩ>ÔøΩÔøΩÔøΩÔøΩH<ÔøΩÔøΩ"ÔøΩÔøΩ<\“Æ!ÔøΩÔøΩ#ÔøΩBWqNÔøΩCÔøΩ=@ÔøΩÔøΩCÔøΩÔøΩ(ÔøΩÔøΩÔøΩOÔøΩÔøΩjÔøΩÔøΩÔøΩE{ÔøΩÔøΩSÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ



=== Content from medium.com_ca541396_20250119_142408.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdf315411aa70&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40charlielabs101%2Fcve-2020-12872-df315411aa70&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40charlielabs101%2Fcve-2020-12872-df315411aa70&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE 2020‚Äì12872

[![CharlieLabs101](https://miro.medium.com/v2/resize:fill:88:88/1*dmbNkD5D-u45r44go_cf0g.png)](/%40charlielabs101?source=post_page---byline--df315411aa70--------------------------------)

[CharlieLabs101](/%40charlielabs101?source=post_page---byline--df315411aa70--------------------------------)

¬∑

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6c1e983e65fd&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40charlielabs101%2Fcve-2020-12872-df315411aa70&user=CharlieLabs101&userId=6c1e983e65fd&source=post_page-6c1e983e65fd--byline--df315411aa70---------------------post_header-----------)

3 min read¬∑May 15, 2020

--

Listen

Share

PoC of CVE 2020‚Äì12872
First of all, I‚Äôm a researcher not a Hacker.
Yaws 2.0.2 ~2.0.6 and other versions might are vulnerable to Sweet32 Attacks, and how is this works:

First let‚Äôs start Yaws server 2.0.2:

![]()

1. First we started Yaws 2.0.2 server in my Local Machine

![]()

Starting NMAP

2. Then, let‚Äôs start NMAP and lets Scan for Ports and services running
I‚Äôm using the ssl-enum-ciphers script from NMAP.

![]()

Yaws Version

3. I‚Äôm Using Yaws 2.0.2 Version

![]()

4. As you can see here: Yaws is supporting weak ciphers as DES and 3DES.
Those ciphers are vulnerable to Sweet32 Attacks.
Sweet32 attack is basically a Cipher-Block Collision Attack.
When cipher-block is like 64-bit or less you can try Cipher-Block Collisions and then get information Disclosure of all the system.
But it can take a while.
To exploit this you gonna need a very faster computer or a nice cluster.
After exploit, you will intercept all the traffic between you and the server.

![]()

Starting SSLSCAN

5. Now let‚Äôs use SSLScan to get more information about the Ciphers.

![]()

6. As you can see here, Yaws is supporting TLS 1.0+ with DES-CBC3-SHA
You can read more about sweet32 attacks here: <http://sweet32.info/>

7. How I exploit a server vulnerable to Sweet32 Attack?

![]()

worker.js

![]()

attack.html

And to intercept the traffic you can use for instance wireshark.

![]()

This is just an Example

Just run and wait for the collisions.
It may take a while‚Ä¶ But after the exploitation you will intercept all the traffic between you and the server.

## How to fix?

Just ending support to DES and 3DES ciphers :)
I tried contact to Yaws Staff.
Hey, I would like to help and fix this issue as soon as possible!

## Gratz and sources:

Gratz: **CharlieLabs101**
Yaws Project: <http://yaws.hyber.org/>
Yaws LICENSE: <https://github.com/erlyaws/yaws/blob/master/LICENSE>
Sweet32 Info: <https://sweet32.info/>
Wireshark: <https://www.wireshark.org/>
Contact:*charlieLabs101@protonmail.com*

49c1bae58d5dcdbbfc62bc1c3985e0ec8b9f9250306499c9ac42b510d2ef5de5

--

--

[![CharlieLabs101](https://miro.medium.com/v2/resize:fill:96:96/1*dmbNkD5D-u45r44go_cf0g.png)](/%40charlielabs101?source=post_page---post_author_info--df315411aa70--------------------------------)[![CharlieLabs101](https://miro.medium.com/v2/resize:fill:128:128/1*dmbNkD5D-u45r44go_cf0g.png)](/%40charlielabs101?source=post_page---post_author_info--df315411aa70--------------------------------)Follow[## Written by CharlieLabs101](/%40charlielabs101?source=post_page---post_author_info--df315411aa70--------------------------------)[4 Followers](/%40charlielabs101/followers?source=post_page---post_author_info--df315411aa70--------------------------------)¬∑[1 Following](/%40charlielabs101/following?source=post_page---post_author_info--df315411aa70--------------------------------)

Researcher

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----df315411aa70--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----df315411aa70--------------------------------)[About](/about?autoplay=1&source=post_page-----df315411aa70--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----df315411aa70--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----df315411aa70--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----df315411aa70--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----df315411aa70--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----df315411aa70--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----df315411aa70--------------------------------)[Teams](/business?source=post_page-----df315411aa70--------------------------------)



=== Content from sweet32.info_7925193f_20250119_125627.html ===

# Sweet32: Birthday attacks on 64-bit block ciphers in TLS and OpenVPN

## CVE-2016-2183, CVE-2016-6329

Cryptographic protocols
like [TLS](https://tools.ietf.org/html/rfc5246), [SSH](https://tools.ietf.org/html/rfc4253), [IPsec](https://eprint.iacr.org/2006/097.pdf),
and [OpenVPN](https://openvpn.net/) commonly
use [block
cipher](https://en.wikipedia.org/wiki/Block_cipher) algorithms, such as AES, Triple-DES, and Blowfish, to
encrypt data between clients and servers. To use such algorithms, the
data is broken into fixed-length chunks, called blocks, and each block is
encrypted separately according to a [mode of operation](https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation).
Older block ciphers, such as Triple-DES and
Blowfish use a block size of 64 bits, whereas AES uses a block size
of 128 bits.

It is well-known in the cryptographic community that a short block
size makes a block cipher vulnerable to
[birthday](http://web.cs.ucdavis.edu/~rogaway/papers/modes.pdf)
[attacks](https://eprint.iacr.org/2012/623), even if there
are no cryptographic attacks against the block cipher itself.
We observe that such attacks have now become practical for the common usage of
64-bit block ciphers in popular protocols like TLS and OpenVPN.
Still, such ciphers are widely enabled on the Internet.
Blowfish is currently the default cipher in OpenVPN, and Triple-DES
is supported by nearly all HTTPS web servers, and currently used for
roughly 1-2% of HTTPS connections between mainstream browsers and
web servers.

We show that a network attacker who can monitor a long-lived
Triple-DES HTTPS connection between a web browser and a website can
recover secure HTTP cookies by capturing around 785¬†GB of
traffic. In our proof-of-concept demo, this attack currently takes
less than two days, using malicious Javascript to generate traffic. Keeping a web connection alive for two days may not
seem very practical, but it worked easily in the lab. In terms of computational complexity, this
attack is comparable to the recent [attacks](http://www.isg.rhul.ac.uk/tls/)
on [RC4](http://www.rc4nomore.com/). We also demonstrate
a similar attack on VPNs that use 64-bit ciphers, such as OpenVPN,
where long-lived Blowfish connections are the norm.

Countermeasures are currently being implemented by browser vendors,
OpenSSL, and the OpenVPN team, and we advise users to update to the
latest available versions.

Our results are described in the following technical paper, presented at [ACM CCS 2016](https://www.sigsac.org/ccs/CCS2016/):

[![[article]](article.png "download article")](SWEET32_CCS16.pdf)
[![[slides]](presentation.png "download presentation")](SWEET32_CCS16_slides.pdf)
### [On the Practical (In-)Security of 64-bit Block Ciphers ‚Äî Collision Attacks on HTTP over TLS and OpenVPN](SWEET32_CCS16.pdf)

Karthikeyan Bhargavan, Ga√É¬´tan Leurent

## Block Ciphers and the Birthday Bound

The security of a block cipher is often reduced to the key size *k*: the
best attack should be the exhaustive search of the key, with complexity
2*k*. However, the block size *n* is also an important security
parameter, defining the amount of data that can be encrypted under the
same key. This is particularly important when using common modes of
operation: we require block ciphers to be secure with up to 2*n*
queries, but most modes of operation (e.g. CBC, CTR, GCM,
OCB, etc.) are unsafe with more than 2*n*/2 blocks of message (the
birthday bound).

With a modern block cipher with 128-bit blocks such as AES, the
birthday bound corresponds to 256¬†EB.
However, for a block cipher with 64-bit
blocks, the birthday bound corresponds to only 32¬†GB, which is easily reached in practice. When the amount of data
encrypted under a fixed key approaches this limit, the security guarantees
of the mode of operation start to crumble. This problem is
well-known by cryptographers, who always require keys to be
changed **well before** 2n/2 blocks. However
it is often minimized by practitioners
because the attacks require known plaintext, and reveal only little
information.
Indeed, standard bodies only recommend to change the
key just before 2n/2 blocks, and many implementations don't
enforce any limit on the use of a key.

In particular, there are many uses of block ciphers with 64-bit blocks
where large amount of data are potentially encrypted under the same key, such as:

* 3G telephony (UMTS), encrypted with KASUMI;
* OpenVPN, which uses Blowfish as the default cipher;
* many Internet protocols, such as TLS, IPSec and SSH, support Triple-DES
  as a legacy cipher.

In all these scenarios, 32¬†GB of data can be transferred in less than one
hour with a fast connection.

## Exploiting Block Cipher Collisions

![](CBC.svg)

In practice, block ciphers are used with a mode of operation in order to
deal with messages of arbitrary length.
The CBC mode is one of the oldest encryption modes, and still widely
used. The message *M* is divided into blocks *mi* and is
encrypted as:
 *ci = Ek(mi ‚äï ci-1)*,
where *c-1* is an initialization
value usually denoted as IV.
We now explain the impact of collisions on the CBC mode.

CBC has been proven secure up to 2*n*/2 of
messages.
On the other hand there is a simple birthday attack against CBC: after
2*n*/2 message blocks encrypted with the same key (in the same
message or in different messages), a collision between two ciphertext
blocks *ci = cj* is expected. Since *Ek* is a
permutation, a collision in the output means that the inputs are the
same (*mi ‚äï ci-1 = mj ‚äï cj-1*)
which reveals the xor of two plaintext blocks:
*mi ‚äï mj = ci-1 ‚äï cj-1*.

With 2*d* blocks of data the expected number of collisions
is roughly 22*d-n-*1 (following the birthday paradox).

### Practical impact

In many contexts, recovering only the xor between
two plaintext blocks is not sufficient for an attack with a
practical impact. However, an attack can be mounted when the following
conditions are fulfilled:

* a fixed secret is sent repeatedly;
* some fraction of the plaintext is known.

In this case, there is a chance that a
collision leaks the xor between the fixed secret and the known
plaintext; this would immediately reveal the secret. More precisely,
this attack is expected to succeed with high probability as soon as
2s copies of the secret and 2t known blocks are encrypted,
with *s+t ‚â• n*.

In particular, this is applicable to the security of encrypted HTTP
connections, when an authentication token is send with every request.
A man-in-the-browser attacker can generate a large
number of requests, and recover the authentication token, using the fact
that most headers in the request are predictable or even controlled by
the attacker.

## 64-bit Block Cipher Usage on the Internet

Many of the most influential Internet security protocols, such as TLS,
SSH, and IPsec were standardized at a time when 64-bit block ciphers,
such as Triple-DES and Blowfish, were still considered
strong.
For example, in TLS 1.0 and 1.1, Triple-DES is the mandatory encryption
algorithm, so all TLS libraries implement it and a vast majority of
web servers support it. In addition, until we disclosed the
attacks in this paper, OpenSSL included Triple-DES ciphersuites in its
HIGH-security list (it has now been moved to MEDIUM).

### Triple-DES and Blowfish usage in VPNs.

IPSec Most IPSec-based VPN clients support
Triple-DES for interoperability. In particular, some versions of
Microsoft's L2TP VPN client
use [Triple-DES
by default](https://support.microsoft.com/en-us/kb/325158).

OpenVPN
[OpenVPN](https://openvpn.net) is a popular open-source VPN solution
originally written by James Yonan. The **default encryption** for the
transport protocol of OpenVPN **is Blowfish ‚Äì a 64-bit cipher ‚Äì** with the
CBC mode. OpenVPN supports two different modes to generate session keys
to encrypt the messages:

* In **pre-shared-key mode**, static keys are used for all the traffic.
  In particular, there is no limit to the lifetime of those keys.
* In **TLS mode**, session keys are generated with a TLS handshake,
  using certificates to authenticate the peers. The session keys are
  updated periodically, with limits on the number of packets, the number
  of bytes, or a session time. The default configuration rekeys the
  tunnel every hour.

### Triple-DES usage in HTTPS.

Triple-DES is the second most widely supported cipher (after AES) in HTTPS
servers, with about [87% of servers supporting
it](https://securitypitfalls.wordpress.com/2016/04/17/february-2016-scan-results-incomplete/).
Furthermore, all popular web browsers support Triple-DES. The cipher that
is actually negotiated for a TLS connection is chosen by the server,
based on its local preference order and on the order in which the
client advertises its ciphersuites. Since most modern browsers and servers
prefer AES over Triple-DES one may expect only a negligible number of connections
to negotiate Triple-DES. However, we find evidence that 1-2% of
all TLS connections likely use Triple-DES in CBC mode, as described below.

Firefox Telemetry
[Telemetry data from Mozilla Firefox](https://mzl.la/2bkLMFA)
show that Triple-DES is used for close to 1% of HTTPS connections from
Firefox browsers (0.76% with beta 49). The use of Triple-DES with Firefox
is slowly decreasing, and peaked with the removal of RC4 from
the list of supported ciphers in version 36. Indeed a number of servers
are configured to use, in order of preference, first RC4, then Triple-DES,
and now use Triple-DES with Firefox. Since all modern browsers have
deprecated RC4 between 2013 and 2015 (following
RFC 7465), they will also use
a Triple-DES ciphersuite in this situation.

Scanning the Top 1M Websites
We performed a scan of the top 1 million servers as listed by
Alexa using the [cipherscan](https://github.com/jvehent/cipherscan)
tool. We
found that 86% of the servers that support TLS include Triple-DES as one
of the supported ciphers. Moreover, 1.2% of these servers are configured
in such a way that they will actually pick a
Triple-DES based ciphersuite with a modern browser, even though better alternatives are available.
(In particular many of these servers support AES-based ciphersuites, but use Triple-DES or RC4 preferentially.)

Windows XP Clients and Windows 2003 Servers
The Windows Server 2003 operating system does not support AES-based
ciphersuites in its default configuration, although support for AES can
be added with an optional [hotfix](https://support.microsoft.com/en-us/kb/948963). The Windows XP operating system with
security update [MS10-049](https://support.microsoft.com/en-us/kb/980436) supports
AES-based ciphersuites.
If AES-based ciphersuites have not been added, these operating systems support only
RC4, Triple-DES, DES, and RC2-40. While they are not supported
anymore by Microsoft, they still have some users, and this creates
situations where the best available cipher is Triple-DES.

### Long-lived HTTPS connection

An important requirement for the attack is to send a large number of
requests in the same TLS connection.
Therefore, we need to find client and
servers that not only negotiate the use of Triple-DES, but also exchange a
large number of HTTP request in the same TLS connection (without
rekeying). This is possible using a persistent HTTP connection, as
defined in HTTP/1.1 (Keep-Alive).
On the client side, all browsers
that we tested (Firefox, Chrome, Opera) will reuse a TLS connection as
long as the server keeps it open.

On the server side,
we found that a number of HTTP servers will close the TLS connection
even when it is still active. In particular, Apache and Nginx
limit the number of requests sent in the same connection, with a maximum
of 100 in the default configuration. On the other hand, IIS does not
seem to have such a limit. In practice, many high profile servers
accept a very large number of requests in a single TLS connection.

Vulnerable Websites
For a better estimate of the number of vulnerable servers, we tested
servers from Alexa's top 10k that negotiate Triple-DES with a modern
client. We identified 11483 different HTTPS servers, and found that 226 of them (1.9%) negotiate Triple-DES
with a modern client. Moreover, 72 of these (0.6% of the total) also
accept to keep a connection open for at least 800k requests.
Consequently, the duration of the attack is not unrealistic, at least
from the viewpoint of browsers and servers, and we estimate that at
least 0.6% of HTTPS connections are vulnerable to our attacks.

For advice about how to check a website's
configuration and configure it properly, see the [FAQ](#faq).

## Attacking Authenticated HTTP over TLS and OpenVPN

We now demonstrate concrete attacks against authenticated HTTP sessions even
when they are secured by TLS or OpenVPN.
First, we identify a few examples of secret authentication credentials
that are repeatedly sent by the browser on every request. We then
show how we can recover these secrets using block cipher collisions.

### HTTP Bearer Tokens

Cookie-based Sessions
Modern HTTPS websites use a variety of methods to manage authenticated
sessions with their clients. The most popular mechanism is secure
*cookies* as specified in RFC6265. Once a user has logged in, the
server sets a cookie containing a secret value on the user's
browser. The browser will then send the cookie on all subsequent
requests to the website, implicitly authenticating the user.

Cookies are sensitive, because an attacker who obtains a session cookie
can then log in as the user from a different browser. The cookie acts
as a *bearer token* that carries the user's delegated credential.

A cookie for a website is normally included in all requests to that
website whether that request was initiated by the user, or a script on
the website, or even by a different website. Browsers sometimes impose
stricter rules for this last category of requests, called cross-origin
or cross-domain requests. For example, XmlHttpRequests sent from one
domain to another may not have cookies attached. However, cross-domain
requests for images or iframes will still send cookies.

HTTP BasicAuth
Apart from cookies, there are other mechanisms for a website to
authenticate the user. In the HTTP Basic Authentication mechanism
specified in RFC7617, the browser asks the user to enter a username
and password into a special dialog and then sends this information (in
plaintext) as an HTTP header of the form:

```

Authorization: Basic dGVzdDoxMjPCow=

```

Once a user has entered his login information once, the browser will typically
cache this information and use it on all subsequent requests to the server.
Notably, even if a different website creates a cross-domain request to the
authenticated server, the BasicAuth credentials will be automatically sent
by the browser.
BasicAuth credentials contain the user's password and are hence security-critical.
One should only use this authentication mechanism over HTTPS but a number of
corporate websites use BasicAuth over HTTP, under the assumption that their
users can only access the website over a VPN or some other secure connection.

![](Attack.svg)
### The Beastly Attack Scenario

Our attack scenario, is similar to the setup used in recent attacks on RC4.
The attacker wants to steal some bearer token that is being repeatedly
sent by a browser to a website secured with HTTPS, or an HTTP website
accessed through a VPN. We assume that the attacker can
control some JavaScript on a web page loaded by the user's browser,
either by actively tampering with an HTTP response on the wire, or by
hosting a malicious website that the user is fooled into visiting. We
also assume that the attacker can observe all the encrypted traffic between the
target browser and the secure website.

We further assume that the data is encrypted with a 64-bit block cipher
in CBC mode (either an HTTPS connection where the client and server have
negotiated Triple-DES, or an HTTP connection though a VPN encrypted with Blowfish or Triple-DES). Suppose the victim is already logged in to a
website and has a session cookie. The attacker runs malicious
JavaScript code on the victim's browser that repeatedly sends HTTP
queries to the target website server, each containing the session
cookie. If he sends close to 232 queries, a collision is
expected between a ciphertext block corresponding to the cookie
(*ci*), and a known block (*cj*), containing a known part of the
query. The collision attack against CBC reveals the session cookie:
*pi = pj ‚äï ci-1 ‚äï cj-1*.

Note that most of the traffic generated by the attacker is known or
predictable. The requested URL is chosen by the attacker, and all the
headers excepted the cookie are predictable and can be observed in any
HTTP traffic.

```
<html>
  <body>
    <script>
    var W = new Array;
    for (var i=0; i<8; i++) {
        var x = new Worker("worker.js");
        W.push(x);
    }
    </script>
  </body>
</html>

```

*attack.html*

```
var url = "https://10.0.0.1/index.html";
var xhr = new XMLHttpRequest;

// Expand URL to ~4kB using a query string
// Alternatively, force a large cookie
url += "?";
var x = 10000000;
for (var i=0; i<=500; i++) {
    url += x++;
}

while(true) {
    xhr.open("HEAD", url, false);
    xhr.withCredentials = true;
    xhr.send();
    xhr.abort();
}

```

*worker.js*

### Proof-of-Concept Attack Demo

The attacker code consists of two parts: a JavaScript program that
sends a large number of HTTP requests, and a network
adversary who processes the resulting ciphertext to recovers a 16-byte secret.

Man-in-the-browser code The attacker code is
shown on the right: it uses Web workers to
issue XmlHttpRequests, using
the withCredentials property to make sure that cookies are
send in the cross-origin request.
We experimented with several browsers, and we obtained the best
results with Firefox Developer Edition 47.0a2.

Recovering collisions
We captured the encrypted packets with tcpdump and used a
C++ program to extract the ciphertext blocks (using libpcap).
In both the HTTPS attack and the OpenVPN attack, each HTTP query is sent in a
separate encrypted record, which contain the plaintext at a fixed
position, as well as some extra information (packet number, padding,
MAC, ...). Therefore, it is easy to know to which plaintext block
corresponds each ciphertext block, and to align the cookie to a block limit.
After capturing all the traffic, the C++ program sorts the ciphertext
blocks in order to locate collisions. Since the amount of data is quite
large (hundreds of gigabytes), we use the external sort implementation of the
stxxl library. With a NAS storage, sorting the data took
around four hours.

### Attacking Basic Auth over OpenVPN

To demonstrate the attack against OpenVPN, we use a pre-shared-key
tunnel between two physical machines running Linux, with Firefox
Developer Edition 47.0a2 on one side, and an nginx server on the other
side. Access to the server is protected by BasicAuth, and the user
has entered his credentials. Using the default OpenVPN settings, the
tunnel is encrypted with Blowfish in CBC mode.

We use the Javascript code described in the previous section to send a
large number of requests to the server though the tunnel. We found
that increasing the size of the request to 4~kB does not significantly
reduce the query rate, but reduces the number of queries required for
the attack. In our setting, the browser generates about 2900 requests
per second, using several web Worker running in parallel. We expect
the first collision after roughly
232.3 blocks (40¬†GB), *i.e.* one hour.
In practice, we detected the first collision
early, after only 30 minutes (231.3 blocks); as expected, the
predicted xor difference was correct. The full attack needs about
236.6 blocks (785¬†GB) to recover a two-block secret out of 4¬†kB
messages; this should take about 19 hours in this setting. **In our
demo, it took 18.6 hours and 705¬†GB, and we successfully
recovered the 16-byte authentication token.**

### Attacking Secure Cookies over HTTPS

The attack against HTTPS connection is very similar to the attack
against OpenVPN, as long as we have a client and server that negotiate
Triple-DES, and that keep a connection open for a long time.

Vulnerable Websites As detailed above, about 0.6% of the top Alexa 100K
websites support Triple-DES and allow long-lived HTTPS connections. This
list contains many high-profile e-commerce and banking websites.

We use the Javascript code described above,
but we note that with several Workers running in
parallel, modern browsers open a few parallel connections to
the server and split the requests over these connections.
For our attack, we need to maximize the throughput over a *single*
connection. This can be achieved by disturbing some of the connections
so that most of request are send in a single. In our setup, we used
iptables rules to limit the rate of all connections except one.
In a real attack, this would be done by an active man-in-the-middle, but
a passive man-in-the-middle can also mount the attack -- it will just
take more time to collect the data.

Proof-of-Concept Attack Demo
In our setup we use Firefox Developer Edition 47.0a2 running
on Linux and an IIS 6.0 server
in a Windows Server 2003 R2 SP2 Virtual machine. The default configuration of
IIS 6.0 with all recommended updates offers only RC4 and Triple-DES ciphers,
and will use Triple-DES with Firefox and other recent browsers where RC4 is
disabled. Moreover, IIS 6.0 supports HTTP/1.1 and keeps an active connection open
for an arbitrary long time.

On Firefox Developer Edition 47.0a2, with a few dozen
Workers running in parallel, we can send up to 2000 requests
per second in a single TLS connection.
In our experiment, we were lucky to detect the first collision after
only 25 minutes (220.1 requests), and we verified that the
collision revealed the xor of two plaintexts blocks. As seen
previously, the full attack should require 236.6 blocks (785¬†GB) to
recover a two-block cookie, which should take 38 hours in our setting.
**Experimentally, we have recovered a two-block cookie from an HTTPS trace
of only 610¬†GB, captured in 30.5 hours.**

## Impact and Mitigation

We have demonstrated the first concrete attacks on mainstream Internet
protocols that exploit block cipher collisions. Our attacks can
recover valuable secrets such as HTTP cookies and passwords in under
40 hours. Our attacks impact a majority of OpenVPN connections and an
estimated 0.6% of HTTPS connections to popular websites. We expect
that our attacks also impact a number of SSH and IPsec connections,
but we do not have concrete measurements for these protocols. Like
many recent attacks on TLS, such a BEAST and RC4 NOMORE, the
underlying principles behind our attacks were well known to
cryptographers. Our goal is to raise awareness among practitioners
about the vulnerabilities of short block ciphers and on safe ways of
using them.

### Comparison with RC4 attacks

Our attack scenario is very similar to the setup of the recent
attacks on the use of RC4 in HTTPS. We use
the same man-in-the-browser setting to generate a large number of HTTP
requests, and the data complexity of the attack is comparable.
Our attack requires only 229.1 short queries of 512¬†bytes
(280¬†GB in total), which
can be reduced to 227.6 longer queries of 4¬†kB
(785¬†GB in total).
However, these numbers are for the
case when all the data is encrypted within the same session. Even if
the amount of data sent on a single connection is limited, as long as
the limit is close enough to the birthday bound, we can still mount
our attacks across multiple parallel and sequential sessions, albeit
with a higher data and time complexity.

### Mitigation

The obvious way to avoid these attacks is to stop using legacy 64-bit
block ciphers. Alternatively, the attack can be mitigated by rekeying
the session frequently.

Concretely, we recommend the following measures to prevent
our attack:

* Web servers and VPNs should be configured to prefer
  128-bit ciphers. According to our scans, about 1.1% of the top 100k
  web server from Alexa, and 0.5% of the top 1 million, support AES but
  prefer to use 3DES.
* Web browsers should offer 3DES as a fallback-only cipher, to
  avoid using it with servers that support AES but prefer 3DES.
* TLS libraries and applications should limit the length
  of TLS sessions with a 64-bit cipher. This could be done with TLS
  renegotiation, or in some cases by closing the connection and starting
  a new one (i.e. limiting HTTP/1.1 Keep-Alive, SPDY, and HTTP/2
  with 3DES ciphersuites).
* OpenVPN users can change the cipher from the default Blowfish to AES, using
  for instance `cipher AES-128-CBC` on the client and
  server configuration. If they don't control the server
  configuration, they can mitigate the attack by forcing frequent
  rekeying with `reneg-bytes 64000000`.

### Responsible disclosure

We have communicated our results and concerns to the OpenVPN team, and
to various website owners, browser vendors, and TLS libraries. They all
acknowledged the
issue, and are working on implementing countermeasures. The TLS
vulnerability received CVE number CVE-2016-2183, and the OpenVPN
vulnerability is tracked as CVE-2016-6329.

**NIST** is working on
[deprecation
of 3DES](http://csrc.nist.gov/news_events/index.html#jul11). They plan to limit the use of 3DES to
220 blocks with a given key, and to disallow 3DES in TLS,
IPsec, and possibly other protocols.

**OpenVPN** [2.3.12](http://www.mail-archive.com/openvpn-announce%40lists.sourceforge.net/msg00000.html) will [display](https://www.mail-archive.com/openvpn-devel%40lists.sourceforge.net/msg00029.html) a
[warning](https://www.mail-archive.com/openvpn-devel%40lists.sourceforge.net/msg00030.html) to users who choose to use 64-bit ciphers and encourage them
to transition to AES (cipher
negotiation is also being implemented in the 2.4 branch). It will also
implement a default
renegotiation limit of 64MB when used in TLS mode in a future version. A [wiki entry](https://community.openvpn.net/openvpn/wiki/SWEET32) provides further details.

**OpenSSL** has moved 3DES ciphersuites from the
HIGH category to
MEDIUM in the [1.0.1](https://github.com/openssl/openssl/commit/e95f5e03f6f1f8d3f6cbe4b7fa48e57b4cf8fd60) and [1.0.2](https://github.com/openssl/openssl/commit/0fff5065884d5ac61123a604bbcee30a53c808ff) branches, and will disable it by default in
the upcoming [1.1.0](https://github.com/openssl/openssl/commit/ef28891bab7054667f2f6739f6d376c38b3ca1cc) release.
They have a [blog entry](https://www.openssl.org/blog/blog/2016/08/24/sweet32/) with further details.

**Akamai** will offer an option for web server
administrators to drop 3DES
from the offered ciphers.

**Apple** has disabled 3DES on icloud.com and is
recommending that
all its customers disable 3DES on their websites.

Currently, most browsers see about 1% of their connections using
3DES, and vendors consider this number too high to simply disable
3DES on the client side, since too many websites would be broken.
So, they are instead considering implementing data limits per
connection to force rekeying, or offering 3DES ciphersuites only in a
fallback negotiation if no AES ciphersuite is acceptable to the
server.

**Mozilla** is [implementing](https://bugzilla.mozilla.org/show_bug.cgi?id=1267899) [data limits](https://bugzilla.mozilla.org/show_bug.cgi?id=1268745) for all
ciphersuites. This has been integrated into [NSS 3.27](https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/NSS_3.27_release_notes), which should be used in Firefox 51.

**Microsoft** has [removed](https://technet.microsoft.com/library/security/3155527.aspx) 3DES from the False Start
whitelist.

More details about implemented countermeasures
will be added to this webpage as they become
available.

### On the Web

The attack has been mentionned on
[Threatpost](https://threatpost.com/new-collision-attacks-against-3des-blowfish-allow-for-cookie-decryption/120087/),
[Ars Technica](http://arstechnica.com/security/2016/08/new-attack-can-pluck-secrets-from-1-of-https-traffic-affects-top-sites/),
[Matthew Green's blog](http://blog.cryptographyengineering.com/2016/08/attack-of-week-64-bit-ciphers-in-tls.html),
[Tom's hardware](https://nakedsecurity.sophos.com/2016/08/25/anatomy-of-a-cryptographic-collision-the-sweet32-attack/),
[Softpedia](http://news.softpedia.com/news/sweet32-attack-3des-and-blowfish-ciphers-considered-insecure-507631.shtml),
[Naked Security](https://nakedsecurity.sophos.com/2016/08/25/anatomy-of-a-cryptographic-collision-the-sweet32-attack/),
[The Register](http://www.theregister.co.uk/2016/08/29/big_data_busts_crypto_sweet32_captures_collisions_in_old_ciphers/),
[inira.fr](https://www.inria.fr/actualite/actualites-inria/nouvelle-demonstration-de-la-vulnerabilite-de-protocoles-de-securite-internet), and
[ZDnet.fr](http://www.zdnet.fr/actualites/sweet32-les-vieux-algos-se-cachent-pour-mourir-39841068.htm), among others...
.

## FAQ

### Why is 3DES still used with a modern browser?

Because more than 1% of the web servers are poorly configured, and prefer using 3DES rather than AES.

### How can I check if my server is well configured?

You can use
the [scanning tool](https://www.ssllabs.com/ssltest/)
form Qualys SSL Labs. In the "Handshake Simulation" section, you
should see 3DES or RC4 only with browsers that don't support
stronger ciphersuites, like IE6/XP and IE8/XP. If you have 3DES
ciphersuites at the bottom of the "Cipher Suites" section, you can
try to remove them, but it's not an immediate security issue.
Removing 3DES will protect you against potential downgrade attack,
but it will also break connections from older clients.

### How can I fix my server's configuration

You can follow the advice
from [Mozilla](https://wiki.mozilla.org/Security/Server_Side_TLS),
and their [Configuration generator](https://mozilla.github.io/server-side-tls/ssl-config-generator/).

### I'm using Blowfish-256, is it safe?

No, the attack is independent of the key length. It work on
Blowfish with any key length, and Triple-DES with 3 independent keys
(168 bits in total).

### Why Sweet32?

It's a stupid pun, based on
the [sweet
sixteen](https://en.wikipedia.org/wiki/Sweet_sixteen_%28birthday%29) birthday celebration. Our attack is a birthday
attack (taking its name from the [birthday paradox](https://en.wikipedia.org/wiki/Birthday_problem)) with complexity 232. You could also say that
232 is the *sweet spot* where attacks become practical.

### Can I use your logo to talk about the attack?

Yes, you can. To the extent possible under law, Ga√É¬´tan Leurent
has [waived
all copyright and related or neighboring rights](http://creativecommons.org/publicdomain/zero/1.0/) to
the [Sweet32 logo](sweet32.svg).

## About us

We are a pair of researchers from INRIA, the French national research
institute for computer science. You can contact us at our email addresses:
[FirstName].[LastName]@inria.fr (use our names without any accents.)

* [Karthikeyan Bhargavan](http://prosecco.inria.fr/personal/karthik/)
* [Ga√É¬´tan Leurent](https://who.rocq.inria.fr/Gaetan.Leurent/)

## Sweet32

![[Sweet32 Logo]](sweet32.svg)

* [Block Ciphers and the Birthday Bound](#intro)
* [Exploiting Block Cipher Collisions](#CBC)
* [64-bit Block Cipher Usage on the Internet](#usage)
* [Attacking Authenticated HTTP over TLS and OpenVPN](#demo)
* [Impact and Mitigation](#impact)
* [FAQ](#faq)
* [About us](#about)
* [Paper](SWEET32_CCS16.pdf)
* [Slides](SWEET32_CCS16_slides.pdf)



=== Content from github.com_bd7ba227_20250119_142410.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarnil)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarnil)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@carnil](https://avatars.githubusercontent.com/u/773068?s=64&v=4)

**carnil**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarnil)

[Overview](/carnil)
[Repositories
16](/carnil?tab=repositories)
[Projects
0](/carnil?tab=projects)
[Packages
0](/carnil?tab=packages)
[Stars
18](/carnil?tab=stars)

More

* [Overview](/carnil)
* [Repositories](/carnil?tab=repositories)
* [Projects](/carnil?tab=projects)
* [Packages](/carnil?tab=packages)
* [Stars](/carnil?tab=stars)

![@carnil](https://avatars.githubusercontent.com/u/773068?s=64&v=4)

**carnil**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarnil)

[![View carnil's full-sized avatar](https://avatars.githubusercontent.com/u/773068?v=4)](https://avatars.githubusercontent.com/u/773068?v=4)

# Salvatore Bonaccorso carnil

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fcarnil)

[32
followers](https://github.com/carnil?tab=followers) ¬∑ [8
following](https://github.com/carnil?tab=following)

## [Achievements](/carnil?tab=achievements)

[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/carnil?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x2](/carnil?achievement=pull-shark&tab=achievements)
## [Achievements](/carnil?tab=achievements)

[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/carnil?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x2](/carnil?achievement=pull-shark&tab=achievements)

Block or Report

# Block or report carnil

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user‚Äôs behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=carnil+%28user%29)

[Overview](/carnil)
[Repositories
16](/carnil?tab=repositories)
[Projects
0](/carnil?tab=projects)
[Packages
0](/carnil?tab=packages)
[Stars
18](/carnil?tab=stars)

More

* [Overview](/carnil)
* [Repositories](/carnil?tab=repositories)
* [Projects](/carnil?tab=projects)
* [Packages](/carnil?tab=packages)
* [Stars](/carnil?tab=stars)

## Popular repositories Loading

1. [nodau](/carnil/nodau) nodau
   Public

   Forked from [TicklishHoneyBee/nodau](/TicklishHoneyBee/nodau)

   a simple console notetaking program

   C

   [2](/carnil/nodau/stargazers)
2. [Damian-Conway-s-Vim-Setup](/carnil/Damian-Conway-s-Vim-Setup) Damian-Conway-s-Vim-Setup
   Public

   Forked from [thoughtstream/Damian-Conway-s-Vim-Setup](/thoughtstream/Damian-Conway-s-Vim-Setup)

   Vim Script

   [1](/carnil/Damian-Conway-s-Vim-Setup/stargazers)
3. [perl-proc-processtable](/carnil/perl-proc-processtable) perl-proc-processtable
   Public

   Forked from [jwbargsten/perl-proc-processtable](/jwbargsten/perl-proc-processtable)

   Perl Proc::ProcessTable distribution

   C
4. [lnav](/carnil/lnav) lnav
   Public

   Forked from [tstack/lnav](/tstack/lnav)

   Log file navigator

   C++
5. [Acme-MyFirstModule-CARNIL](/carnil/Acme-MyFirstModule-CARNIL) Acme-MyFirstModule-CARNIL
   Public

   Acme::MyFirstModule::CARNIL

   Perl
6. [acme-myfirstmodule-heeb](/carnil/acme-myfirstmodule-heeb) acme-myfirstmodule-heeb
   Public

   Forked from [elmar/acme-myfirstmodule-heeb](/elmar/acme-myfirstmodule-heeb)

   Example Perl Module for brian d foys PAUSE workshop

   Perl

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


