=== Content from wiki.mozilla.org_5a19a554_20250119_130718.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_4bf6b2e7_20250119_111039.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1554110)
* [XML](/show_bug.cgi?ctype=xml&id=1554110)

Closed
[Bug 1554110](/show_bug.cgi?id=1554110)
(CVE-2020-12389)

Opened 6 years ago
Closed 5 years ago

# Windows sandbox: renderer processes can open each and unrelated Chromium processes

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Windows sandbox: renderer processes can open each and unrelated Chromium processes

## Categories

### (Core :: Security: Process Sandboxing, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Security%3A%20Process%20Sandboxing#Security%3A%20Process%20Sandboxing)

Security: Process Sandboxing
▾

Core :: Security: Process Sandboxing
For process sandboxing bugs. Generally this covers code under the security/sandbox/ source directory, but there is code elsewhere to hook the different platform process sandboxes into Gecko etc.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Security%3A%20Process%20Sandboxing&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Security%3A%20Process%20Sandboxing&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Security%3A%20Process%20Sandboxing)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr60 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix) |
| firefox-esr68 | [76+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=76%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) |
| firefox67.0.1 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox67_0_1&o1=equals&v1=wontfix) |
| firefox68 | [+](/buglist.cgi?f1=cf_tracking_firefox68&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=wontfix) |
| firefox69 | [+](/buglist.cgi?f1=cf_tracking_firefox69&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix) |
| firefox70 | [+](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=wontfix) |
| firefox71 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=wontfix) |
| firefox72 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix) |
| firefox73 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=wontfix) |
| firefox74 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=wontfix) |
| firefox75 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox75&o1=equals&v1=wontfix) |
| firefox76 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox76&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr60 |  | wontfix |
| firefox-esr68 | 76+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox67.0.1 |  | wontfix |
| firefox68 | + | wontfix |
| firefox69 | + | wontfix |
| firefox70 | + | wontfix |
| firefox71 |  | wontfix |
| firefox72 |  | wontfix |
| firefox73 |  | wontfix |
| firefox74 |  | wontfix |
| firefox75 |  | wontfix |
| firefox76 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: niklas.baumstark, Assigned: bobowen)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/8877ff082c9a902bbf383dc11c1aeffc?d=mm&size=40)  [bobowen](/user_profile?user_id=458623)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/75bf31b48e75eedfebaa411a76a85155?d=mm&size=40)  [niklas.baumstark](/user_profile?user_id=423505)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/6ad7e6f8a605ca81446ea4c83d819fb2?d=mm&size=40)  [gcp](/user_profile?user_id=151147)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2020-12388](/show_bug.cgi?id=1618911 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape")

[1555810](/show_bug.cgi?id=1555810 "RESOLVED INVALID - Make the privileged about/mozilla content processes Medium Integrity")

## Details

### (4 keywords, Whiteboard: [reporter-external] [client-bounty-form][post-critsmash-triage][adv-main76+][adv-ESR68.8+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-12389

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form][post-critsmash-triage][adv-main76+][adv-ESR68.8+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a22063904_1689 "6 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [noni](/user_profile?user_id=458186) | [qe-verify](#a29368102_458186 "5 years ago") | - |
| --- | --- | --- |
| [noni](/user_profile?user_id=458186) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 1 obsolete file)

| [Bug 1554110: SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!](/attachment.cgi?id=9069004)  [6 years ago](#c15)  [Bob Owen (:bobowen)](/user_profile?user_id=458623)   47 bytes, text/x-phabricator-request | abillings : [sec-approval+](#c19 "6 years ago") | [Details](/attachment.cgi?id=9069004&action=edit) | [Review](/attachment.cgi?id=9069004) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9144310)  [5 years ago](#c40)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   263 bytes, text/plain |  | [Details](/attachment.cgi?id=9144310&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Niklas Baumstark](/user_profile?user_id=423505)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1554110#c0)• 6 years ago |
|  | |

Chromium uses the following code to prevent access between renderers, and from renderers to other low integrity processes: <https://cs.chromium.org/chromium/src/services/service_manager/sandbox/win/sandbox_win.cc?l=430>

```
  result = policy->SetTokenLevel(sandbox::USER_RESTRICTED_SAME_ACCESS,
                                 sandbox::USER_LOCKDOWN);
  if (result != sandbox::SBOX_ALL_OK)
    return result;
  // Prevents the renderers from manipulating low-integrity processes.
  result = policy->SetDelayedIntegrityLevel(sandbox::INTEGRITY_LEVEL_UNTRUSTED);

```

In SandboxBroker::SetSecurityLevelForContentProcess of Firefox with aSandboxLevel < 20 however, the delayed integrity level is set to INTEGRITY\_LEVEL\_LOW: <https://dxr.mozilla.org/mozilla-central/source/security/sandbox/win/src/sandboxbroker/sandboxBroker.cpp#432>

This means that content processes can open and manipulate each other, and also to some other Chromium-based processes such as the Chrome or Electron GPU process (an example is the Slack desktop application). I verified this in Firefox 67 by attaching to a renderer process with WinDbg and calling OpenProcess(PROCESS\_VM\_WRITE, 0, <PID>) to check if the result is non-zero. The steps for doing so are as follows (on Windows 10):

```
bp kernel32!ReadFile
g
# wait for breakpoint to hit
eq KERNEL32!_imp_ReadFile kernel32!OpenProcessStub
eq @rsp deadbeef
r @rcx=0x20
r @rdx=0
r @r8=0n<PID>
g
# will crash at 0xdeadbeef because we changed the return address
r @rax   # non-zero if opening was successfully

```

One direct consequence of this within Firefox itself is that a web renderer process can escalate privileges to file and web extension processes which are potentially more trusted. See also [bug 1538028](/show_bug.cgi?id=1538028 "RESOLVED FIXED - Privilege escalation from web to file process"), file processes can read the entire filesystem.

Another consequence is that we can get control of a process before it calls LowerToken(). This clearly goes against the idea of the sandbox, even though it probably only means a minor increase of kernel attack surface in the case of Firefox. If a Chromium-like win32k lockdown mechanism will ever be introduced in the future, this would be a bypass.

Also, I could imagine that this could affect site isolation in the future.

Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a10512_159069)• 6 years ago |

Group: firefox-core-security → dom-core-securityType: task → defectComponent: Security → Security: Process SandboxingProduct: Firefox → Core

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1554110#c1)• 6 years ago |
|  | |

Thanks Niklas, it's useful having this explicitly in a bug (which I don't think we already have), but this is a known issue.

We are working towards moving to untrusted integrity level at the same time as win32k lockdown.

Many of the things that block that also block us from using untrusted integrity.

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1554110#c2)• 6 years ago |
|  | |

Need to hook this up to a INTEGRITY\_LEVEL\_UNTRUSTED bug.

Priority: -- → P2

|  | [Niklas Baumstark](/user_profile?user_id=423505)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1554110#c3)• 6 years ago |
|  | |

In the meanwhile, you're fine with essentially presenting the entire host filesystem to a compromised renderer?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1554110#c4)• 6 years ago |
|  | |

he did say "working towards moving to untrusted integrity level" -- that's not "fine with it", it's just hard retrofitting into a decade plus of the wrong architecture.

> If a Chromium-like win32k lockdown mechanism will ever be introduced in the future, this would be a bypass.

We're working hard on that, too.

Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Niklas Baumstark](/user_profile?user_id=423505)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1554110#c5)• 6 years ago |
|  | |

I guess I misposed the question: Unless Firefox requires doing OpenProcess for legitimate purposes, shouldn't it be possible to fix this bug without moving to untrusted integrity, and would that not be a warranted approach to this issue?

|  | [Niklas Baumstark](/user_profile?user_id=423505)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1554110#c6)• 6 years ago |
|  | |

Somebody already wrote about the fact that this is possibly publicly, probably without realizing the security implications: <https://github.com/0vercl0k/CVE-2019-9810#organization>

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1554110#c7)• 6 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #4](/show_bug.cgi?id=1554110#c4 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"))

> he did say "working towards moving to untrusted integrity level" -- that's not "fine with it", it's just hard retrofitting into a decade plus of the wrong architecture.
>
> > If a Chromium-like win32k lockdown mechanism will ever be introduced in the future, this would be a bypass.
>
> We're working hard on that, too.

I'd also add that it's not quite as simple as presenting the entire host filesystem to a compromised renderer.

The vast majority of the time the file content process will not be running and, other bugs that need fixing aside, in theory a compromised renderer should not be able to force the parent process to start it.

That said my thanks in [comment 1](/show_bug.cgi?id=1554110#c1 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes") was genuine, this is one of the things that we knew would be addressed by moving to untrusted, but having this bug filed has raised the awareness of that within Mozilla.

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1554110#c8)• 6 years ago |
|  | |

(In reply to Niklas Baumstark from [comment #5](/show_bug.cgi?id=1554110#c5 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"))

> I guess I misposed the question: Unless Firefox requires doing OpenProcess for legitimate purposes, shouldn't it be possible to fix this bug without moving to untrusted integrity, and would that not be a warranted approach to this issue?

If you have ideas about how we can prevent this without going to untrusted then that would be great.

|  | [Niklas Baumstark](/user_profile?user_id=423505)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1554110#c9)• 6 years ago |
|  | |

I was thinking about a ObRegisterCallbacks hook on PsProcessType, which I believe is the canonical anti-debugging trick on Windows.

|  | [Niklas Baumstark](/user_profile?user_id=423505)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1554110#c10)• 6 years ago |
|  | |

Maybe this can also be done with just normal ACLs, unfortunately I'm not an expert in Windows security

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1554110#c11)• 6 years ago |
|  | |

(In reply to Niklas Baumstark from [comment #9](/show_bug.cgi?id=1554110#c9 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"))

> I was thinking about a ObRegisterCallbacks hook on PsProcessType, which I believe is the canonical anti-debugging trick on Windows.

Ah right we don't currently use kernel drivers, so this solution would not be straight forward to roll out and indeed could introduce worse vulnerabilities.

It might also be possible for the process to work around such hooking.

|  | [Niklas Baumstark](/user_profile?user_id=423505)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1554110#c12)• 6 years ago |
|  | |

Oh I didn't realize this is a kernel API, please ignore. Anyways, will let you know if I come across anything useful.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a556179_578488)• 6 years ago |

See Also: → [1555810](/show_bug.cgi?id=1555810 "RESOLVED INVALID - Make the privileged about/mozilla content processes Medium Integrity")

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1554110#c13)• 6 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1554110&comment_id=14152078 "1 revision") |
|  | |

(In reply to Niklas Baumstark from [comment #10](/show_bug.cgi?id=1554110#c10 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"))

> Maybe this can also be done with just normal ACLs, unfortunately I'm not an expert in Windows security

It looks like you can do exactly this, thanks!

The CreateProcessAsUser function can take two LPSECURITY\_ATTRIBUTES arguments, which allows you to set the security descriptor for the process and thread.

If I pass a security descriptor with just the user in the dacl, then the OpenProcess fails, because the normal content processes have the user removed from their access token.

Then I found a setting that had been added to the sandbox policy a while ago that doesn't add the Restricted SID and removes the Logon SID from the ACL on the access token used to create the process.

This is what is used to get the security descriptor if null is passed for the LPSECURITY\_ATTRIBUTES for the process and thread, so this is a really simple change to achieve the same result.

|  | [Niklas Baumstark](/user_profile?user_id=423505)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1554110#c14)• 6 years ago |
|  | |

If I understand you correctly, then taking the approach of modifying the token privileges rather than the process ACL is preferrable because it would also deal with the issue of the Chromium/Electron renderers.

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1554110#c15)• 6 years ago |
|  | |

Attached file
[Bug 1554110: SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!](attachment.cgi?id=9069004) (obsolete)
— [Details](attachment.cgi?id=9069004&action=edit)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a623565_458623)• 6 years ago |

Assignee: nobody → bobowencodeStatus: NEW → ASSIGNEDPriority: P2 → P1

|  | [Niklas Baumstark](/user_profile?user_id=423505)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1554110#c16)• 6 years ago |
|  | |

Bob, is it possible for me to get access to this patch to test it on my local build, just out of curiosity?

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1554110#c17)• 6 years ago |
|  | |

(In reply to Niklas Baumstark from [comment #14](/show_bug.cgi?id=1554110#c14 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"))

> If I understand you correctly, then taking the approach of modifying the token privileges rather than the process ACL is preferrable because it would also deal with the issue of the Chromium/Electron renderers.

Well it would potentially prevent other low integrity processes from opening our process (if they didn't have the User SID).

This doesn't affect whether our process can open other low integrity processes, we would need untrusted or a more restrictive access token for that, but it's a big step in the right direction.

For example the low integrity internet explorer process still has the Logon SID in its ACL with read access.

We still have that SID in our access token (this just removes it from our processes ACL), so we should still be able to get read access to that IE process.

(In reply to Niklas Baumstark from [comment #16](/show_bug.cgi?id=1554110#c16 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"))

> Bob, is it possible for me to get access to this patch to test it on my local build, just out of curiosity?

Given that this is just a one line policy change, I'll paste it in here.

```
diff --git a/security/sandbox/win/src/sandboxbroker/sandboxBroker.cpp b/security/sandbox/win/src/sandboxbroker/sandboxBroker.cpp
--- a/security/sandbox/win/src/sandboxbroker/sandboxBroker.cpp
+++ b/security/sandbox/win/src/sandboxbroker/sandboxBroker.cpp
@@ -502,6 +502,8 @@ void SandboxBroker::SetSecurityLevelForC
       sandbox::SBOX_ALL_OK == result,
       "SetDelayedIntegrityLevel should never fail, what happened?");

+  mPolicy->SetLockdownDefaultDacl();
+
   sandbox::MitigationFlags mitigations =
       sandbox::MITIGATION_BOTTOM_UP_ASLR | sandbox::MITIGATION_HEAP_TERMINATE |
       sandbox::MITIGATION_SEHOP | sandbox::MITIGATION_DEP_NO_ATL_THUNK |

```

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1554110#c18)• 6 years ago |
|  | |

Comment on [attachment 9069004](/attachment.cgi?id=9069004 "Bug 1554110: SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!") [[details]](/attachment.cgi?id=9069004&action=edit "Bug 1554110: SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!")

[Bug 1554110](/show_bug.cgi?id=1554110 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"): SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not by itself, this is something that could contribute to a sandbox escape.

  It wouldn't take long for someone with the necessary understanding to work out what this protects against.

  I think landing this under a separate non security bug would be a good idea.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: If the patch doesn't apply or rebase, then it will be trivial to create new patches.
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely, because sandboxed processes shouldn't be attempting to open each other.

  There is a very small risk that this could interfere with other software that might try to open our processes, but I think that is unlikely because they would tend to be running with more privileges anyway.
[Attachment #9069004](/attachment.cgi?id=9069004&action=edit "Bug 1554110: SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a999143_280903)• 6 years ago |

[status-firefox67.0.1](/buglist.cgi?f1=cf_status_firefox67_0_1&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox67_0_1&o1=equals&v1=wontfix)
[status-firefox68](/buglist.cgi?f1=cf_status_firefox68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=affected)
[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=affected)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected)
[tracking-firefox68](/buglist.cgi?f1=cf_tracking_firefox68&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox68&o1=equals&v1=%2B)
[tracking-firefox69](/buglist.cgi?f1=cf_tracking_firefox69&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox69&o1=equals&v1=%2B)
[tracking-firefox-esr60](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=isnotempty):
--- → [68+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=68%2B)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1554110#c19)• 6 years ago |
|  | |

Comment on [attachment 9069004](/attachment.cgi?id=9069004 "Bug 1554110: SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!") [[details]](/attachment.cgi?id=9069004&action=edit "Bug 1554110: SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!")

[Bug 1554110](/show_bug.cgi?id=1554110 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"): SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!

sec-approval+ for trunk. We'll want this on beta and ESR60 as well so please create and nominate patches for those branches.

[Attachment #9069004](/attachment.cgi?id=9069004&action=edit "Bug 1554110: SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!") -
Flags: sec-approval? → sec-approval+

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1554110#c20)• 6 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #19](/show_bug.cgi?id=1554110#c19 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"))

> Comment on [attachment 9069004](/attachment.cgi?id=9069004 "Bug 1554110: SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!") [[details]](/attachment.cgi?id=9069004&action=edit "Bug 1554110: SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!")
>
> [Bug 1554110](/show_bug.cgi?id=1554110 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"): SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!
>
> sec-approval+ for trunk. We'll want this on beta and ESR60 as well so please create and nominate patches for those branches.

Landed via [bug 1557282](/show_bug.cgi?id=1557282 "RESOLVED FIXED - Add SetLockdownDefaultDacl to the content process sandbox policy for Windows.") (deliberately not linked).

The patch for m-c imports cleanly for beta, I'll add one for ESR60 on [bug 1557282](/show_bug.cgi?id=1557282 "RESOLVED FIXED - Add SetLockdownDefaultDacl to the content process sandbox policy for Windows.").

NI to jcristau and RyanVM, so they're aware of this for the approval requests, which I'll make on that bug.

Flags: needinfo?(ryanvm)Flags: needinfo?(jcristau)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a1131400_75935)• 6 years ago |

Flags: needinfo?(ryanvm)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1554110#c21)• 6 years ago |
|  | |

This has just been backed out, looks like some audio/media issue.

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1554110#c22)• 6 years ago |
|  | |

I guess this won't make 68 at this point.

[status-firefox68](/buglist.cgi?f1=cf_status_firefox68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox68&o1=equals&v1=wontfix)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox-esr60](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=isnotempty):
[68+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=68%2B) → [69+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=69%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [69+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=69%2B)Flags: needinfo?(jcristau)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1554110#c23)• 6 years ago |
|  | |

In [bug 1557282](/show_bug.cgi?id=1557282 "RESOLVED FIXED - Add SetLockdownDefaultDacl to the content process sandbox policy for Windows.") I'm going to try landing this again just for windows 10.

I've filed [bug 1564842](/show_bug.cgi?id=1564842 "RESOLVED DUPLICATE - Add SetLockdownDefaultDacl to the content process sandbox policy for Windows 8.1 and earlier.") for landing this for earlier versions, possibly once audio remoting has been enabled.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1554110#c24)• 6 years ago |
|  | |

Comment on [attachment 9069004](/attachment.cgi?id=9069004 "Bug 1554110: SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!") [[details]](/attachment.cgi?id=9069004&action=edit "Bug 1554110: SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!")

[Bug 1554110](/show_bug.cgi?id=1554110 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"): SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!

Revision D33301 was moved to [bug 1557282](/show_bug.cgi?id=1557282 "RESOLVED FIXED - Add SetLockdownDefaultDacl to the content process sandbox policy for Windows."). Setting [attachment 9069004](/attachment.cgi?id=9069004 "Bug 1554110: SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!") [[details]](/attachment.cgi?id=9069004&action=edit "Bug 1554110: SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!") to obsolete.

[Attachment #9069004](/attachment.cgi?id=9069004&action=edit "Bug 1554110: SetLockdownDefaultDacl for content process sandbox policy. r=jmathies!") -
Attachment is obsolete: true

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1554110#c25)• 5 years ago |
|  | |

Too late for this cycle.

[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix)
[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=affected)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix)
[tracking-firefox-esr60](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=isnotempty):
[69+](/buglist.cgi?f1=cf_tracking_firefox_esr60&o1=equals&v1=69%2B) → ---
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[69+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=69%2B) → [?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1554110#c26)• 5 years ago |
|  | |

Bob, want to give this another try for 71/70?

[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=%3F)
[tracking-firefox70](/buglist.cgi?f1=cf_tracking_firefox70&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%2B)Flags: needinfo?(bobowencode)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1554110#c27)• 5 years ago |
|  | |

Following up in email with Bob and jimm.

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1554110#c28)• 5 years ago |
|  | |

From email with :gcp, this is blocked partly by [bug 1432303](/show_bug.cgi?id=1432303 "RESOLVED FIXED - Enable AudioIPC on Windows"), and possibly by [bug 1567385](/show_bug.cgi?id=1567385 "RESOLVED FIXED - 20.8% tabswitch (windows10-64-shippable) regression on push aaf7ae8412559f328b121cc8e392b1737ce40131 (Thu July 11 2019)") as well.

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1554110#c29)• 5 years ago |
|  | |

Following up in email with :kinetik and :drno.

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1554110#c30)• 5 years ago |
|  | |

From discussion with kinetik, we are aiming a fix at 71.

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=affected) → [fix-optional](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fix-optional)
[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=%3F) → [affected](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=affected)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1554110#c31)• 5 years ago |
|  | |

(In reply to Liz Henry (:lizzard) from [comment #30](/show_bug.cgi?id=1554110#c30 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"))

> From discussion with kinetik, we are aiming a fix at 71.

Thanks lizzard (sorry, must have missed this comment first time, only noticed with the email from the CCs being added).

One idea we had (if the audio issue is fixed), is to only call SetLockdownDefaultDacl on the processes that we want to protect.

So, the file content process and certain other "privileged" content processes. In the hope that we can live with the performance and profiling issues in those processes.

I think it should be fairly straight forward to pass through the remote type instead of just a bool for the file content process to [1]

tjr - I think you're more familiar with these new remote types - which ones do you think we would need to protect? (Also, do you think that we might live with the other issues in these process types?)

[1] <https://searchfox.org/mozilla-central/rev/1fe0cf575841dbf3b7e159e88ba03260cd1354c0/security/sandbox/win/src/sandboxbroker/sandboxBroker.cpp#419>

Flags: needinfo?(bobowencode) → needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1554110#c32)• 5 years ago |
|  | |

We have three types of content processes we would want to protect: file, privilegedabout, and privilegedmozillacontent. privilegedabout hosts about:newtab and that's got to be fast. privilegedmozillacontent hosts FXA which does in-browser crypto so while it's not a bright red flag like newtab, it is something to be somewhat concerned about.

Note that once we get Fission, we would also need to apply this to regular content processes too. If that isn't done in this bug, it should be a separate bug that blocks [Bug 1505832](/show_bug.cgi?id=1505832 "NEW - [meta] Fission Site Sandboxing")

It's an ugly dependency graph to draw out "If we apply it to X but not Y we're leaving ourselves vulnerable to Z which negates the benefit of applying it to X" - but I don't think that's necessary. If we can apply it to X, we should, even if we don't derive the benefit today.

Flags: needinfo?(tom)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a16607101_75935)• 5 years ago |

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fix-optional) → [wontfix](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=wontfix)
[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=wontfix)
[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
--- → [fix-optional](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=fix-optional)
[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
--- → [fix-optional](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fix-optional)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1554110#c33)• 5 years ago |
|  | |

Should we mark this bug as stalled?

[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=fix-optional) → [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix)
[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fix-optional) → [wontfix](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=wontfix)
[status-firefox74](/buglist.cgi?f1=cf_status_firefox74&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=wontfix)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F) → ---

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1554110#c34)• 5 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #33](/show_bug.cgi?id=1554110#c33 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"))

> Should we mark this bug as stalled?

No; it's blocked on Audio IPC but there is no additional information we need (that we can't get) to justify marking it stalled.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a22063904_1689)• 5 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1554110#c35)• 5 years ago |
|  | |

Update on recent progress on regressions caused by the SetLockdownDefaultDacl fix:

* Audio remoting is riding the trains.
* I have a patch for the profiler stack issue.
* Performance issues appear to be multifaceted:
  + OpenProcessToken - reasonably good fix for this to prevent brokering to the parent.
  + Appears to break DWrite cache (which we think we need to do deliberately at some point) - this does not affect us when there is no acceleration or when webrender is enabled, so could enable in those cases.
  + Two above appear to fix tabswitch performance regressions ([bug 1567385](/show_bug.cgi?id=1567385 "RESOLVED FIXED - 20.8% tabswitch (windows10-64-shippable) regression on push aaf7ae8412559f328b121cc8e392b1737ce40131 (Thu July 11 2019)")), but not tp6 cold start regressions ([bug 1566744](/show_bug.cgi?id=1566744 "RESOLVED FIXED - 2.26 - 14.81% raptor-tp6-facebook-firefox-cold / raptor-tp6-google-firefox-cold / (windows10-64-shippable, windows10-64-shippable-qr, windows7-32-shippable) regression on push 9559ef8f347dc0e4e92546954472d4153283d5f2 (Thu July 11 2019)")), need to investigate those further.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a24659245_1689)• 5 years ago |

See Also: → [CVE-2020-12388](/show_bug.cgi?id=1618911 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape")

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1554110#c36)• 5 years ago |
|  | |

Bob, has this been fixed now that [bug 1618911](/show_bug.cgi?id=1618911 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape") landed?

Flags: needinfo?(bobowencode)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1554110#c37)• 5 years ago |
|  | |

(In reply to Gian-Carlo Pascutto [:gcp] from [comment #36](/show_bug.cgi?id=1554110#c36 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"))

> Bob, has this been fixed now that [bug 1618911](/show_bug.cgi?id=1618911 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape") landed?

Yes, I've resolved instead of duplicated, because the attacks were different even though the underlying cause and fix were the same.

Status: ASSIGNED → RESOLVEDClosed: 5 years ago
[status-firefox75](/buglist.cgi?f1=cf_status_firefox75&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox75&o1=equals&v1=wontfix)
[status-firefox76](/buglist.cgi?f1=cf_status_firefox76&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox76&o1=equals&v1=fixed)Flags: needinfo?(bobowencode)Resolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a27144707_75935)• 5 years ago |

Group: dom-core-security → core-security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a27611869_1689)• 5 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1554110#c38)• 5 years ago |
|  | |

If the fix in [bug 1618911](/show_bug.cgi?id=1618911 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape") was backported to ESR68, is this bug also fixed in ESR68? It got marked "wontfix" a couple months ago for some reason.

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix) → [?](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=%3F)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [76+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=76%2B)Flags: needinfo?(bobowencode)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1554110#c39)• 5 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #38](/show_bug.cgi?id=1554110#c38 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"))

> If the fix in [bug 1618911](/show_bug.cgi?id=1618911 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape") was backported to ESR68, is this bug also fixed in ESR68? It got marked "wontfix" a couple months ago for some reason.

yeah, I guess it was originally a won't fix, but that changed with the severity being increased due to the full escape

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=%3F) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)Flags: needinfo?(bobowencode)

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a29368102_458186)• 5 years ago |

Flags: qe-verify-Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a29473393_428608)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage] → [reporter-external] [client-bounty-form][post-critsmash-triage][adv-main76+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a29474363_428608)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form][post-critsmash-triage][adv-main76+] → [reporter-external] [client-bounty-form][post-critsmash-triage][adv-main76+][adv-ESR68.8+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1554110#c40)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9144310)
— [Details](attachment.cgi?id=9144310&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a29527245_1689)• 5 years ago |

Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a29547130_428608)• 5 years ago |

Alias: CVE-2020-12389

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1554110#c41)• 5 years ago |
|  | |

Same root cause as [bug 1618911](/show_bug.cgi?id=1618911 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"), different exploit strategy. Also opening up.

Group: core-security-release

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a76148275_578488)• 3 years ago |

Keywords: [csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1554110#a158397209_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1554110&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Bob Owen (:bobowen)](/user_profile?user_id=458623)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_73f8d6fa_20250119_130718.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.mozilla.org_a00a6259_20250119_111040.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-17

## Security Vulnerabilities fixed in Firefox ESR 68.8

Announced
May 5, 2020
Impact
critical
Products
Firefox ESR
Fixed in

* Firefox ESR 68.8

#### [#CVE-2020-12387: Use-after-free during worker shutdown](#CVE-2020-12387)

Reporter
Looben Yang
Impact
critical
##### Description

A race condition when running shutdown code for Web Worker led to a use-after-free vulnerability. This resulted in a potentially exploitable crash.

##### References

* [Bug 1545345](https://bugzilla.mozilla.org/show_bug.cgi?id=1545345)

#### [#CVE-2020-12388: Sandbox escape with improperly guarded Access Tokens](#CVE-2020-12388)

Reporter
James Forshaw of Google Project Zero
Impact
critical
##### Description

The Firefox content processes did not sufficiently lockdown access control which could result in a sandbox escape.
*Note: this issue only affects Firefox on Windows operating systems.*

##### References

* [Bug 1618911](https://bugzilla.mozilla.org/show_bug.cgi?id=1618911)

#### [#CVE-2020-12389: Sandbox escape with improperly separated process types](#CVE-2020-12389)

Reporter
Niklas Baumstark
Impact
high
##### Description

The Firefox content processes did not sufficiently lockdown access control which could result in a sandbox escape.
*Note: this issue only affects Firefox on Windows operating systems.*

##### References

* [Bug 1554110](https://bugzilla.mozilla.org/show_bug.cgi?id=1554110)

#### [#CVE-2020-6831: Buffer overflow in SCTP chunk input validation](#CVE-2020-6831)

Reporter
Natalie Silvanovich of Google Project Zero
Impact
high
##### Description

A buffer overflow could occur when parsing and validating SCTP chunks in WebRTC. This could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1632241](https://bugzilla.mozilla.org/show_bug.cgi?id=1632241)

#### [#CVE-2020-12392: Arbitrary local file access with 'Copy as cURL'](#CVE-2020-12392)

Reporter
Ophir LOJKINE
Impact
moderate
##### Description

The 'Copy as cURL' feature of Devtools' network tab did not properly escape the HTTP POST data of a request, which can be controlled by the website. If a user used the 'Copy as cURL' feature and pasted the command into a terminal, it could have resulted in the disclosure of local files.

##### References

* [Bug 1614468](https://bugzilla.mozilla.org/show_bug.cgi?id=1614468)

#### [#CVE-2020-12393: Devtools' 'Copy as cURL' feature did not fully escape website-controlled data, potentially leading to command injection](#CVE-2020-12393)

Reporter
David Yesland
Impact
moderate
##### Description

The 'Copy as cURL' feature of Devtools' network tab did not properly escape the HTTP method of a request, which can be controlled by the website. If a user used the 'Copy as cURL' feature and pasted the command into a terminal, it could have resulted in command injection and arbitrary command execution.
*Note: this issue only affects Firefox on Windows operating systems.*

##### References

* [Bug 1615471](https://bugzilla.mozilla.org/show_bug.cgi?id=1615471)

#### [#CVE-2020-12395: Memory safety bugs fixed in Firefox 76 and Firefox ESR 68.8](#CVE-2020-12395)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Alexandru Michis, Jason Kratzer, philipp, Ted Campbell, Bas Schouten, André Bargull, and Karl Tomlinson reported memory safety bugs present in Firefox 75 and Firefox ESR 68.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 76 and Firefox ESR 68.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1595886%2C1611482%2C1614704%2C1624098%2C1625749%2C1626382%2C1628076%2C1631508)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_d22229a5_20250119_130722.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1618911)
* [XML](/show_bug.cgi?ctype=xml&id=1618911)

Closed
[Bug 1618911](/show_bug.cgi?id=1618911)
(CVE-2020-12388)

Opened 5 years ago
Closed 5 years ago

# Firefox: Default Content Process DACL Sandbox Escape

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox: Default Content Process DACL Sandbox Escape

## Categories

### (Core :: Security: Process Sandboxing, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Security%3A%20Process%20Sandboxing#Security%3A%20Process%20Sandboxing)

Security: Process Sandboxing
▾

Core :: Security: Process Sandboxing
For process sandboxing bugs. Generally this covers code under the security/sandbox/ source directory, but there is code elsewhere to hook the different platform process sandboxes into Gecko etc.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Security%3A%20Process%20Sandboxing&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Security%3A%20Process%20Sandboxing&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Security%3A%20Process%20Sandboxing)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

75 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla76

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [76+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=76%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) |
| firefox73 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=wontfix) |
| firefox74 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=wontfix) |
| firefox75 | [+](/buglist.cgi?f1=cf_tracking_firefox75&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox75&o1=equals&v1=wontfix) |
| firefox76 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox76&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr68 | 76+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox73 |  | wontfix |
| firefox74 |  | wontfix |
| firefox75 | + | wontfix |
| firefox76 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: forshaw, Assigned: bobowen)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/8877ff082c9a902bbf383dc11c1aeffc?d=mm&size=40)  [bobowen](/user_profile?user_id=458623)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/5f639fae9daed646889e64c874cbf5b6?d=mm&size=40)  [forshaw](/user_profile?user_id=540730)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/6ad7e6f8a605ca81446ea4c83d819fb2?d=mm&size=40)  [gcp](/user_profile?user_id=151147)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

20 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2020-12389](/show_bug.cgi?id=1554110 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes")

[bugs.chromium.org/p/project-zero/issu...](https://bugs.chromium.org/p/project-zero/issues/detail?id=2016 "https://bugs.chromium.org/p/project-zero/issues/detail?id=2016")

## Details

### (Keywords: csectype-priv-escalation, csectype-sandbox-escape, sec-critical, Whiteboard: [disclosure date is 2020-05-28][post-critsmash-triage][adv-main76+][adv-ESR68.8+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-12388

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[disclosure date is 2020-05-28][post-critsmash-triage][adv-main76+][adv-ESR68.8+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [btot](/user_profile?user_id=553429) | [qe-verify](#a3020074_553429 "5 years ago") | - |
| --- | --- | --- |
| [btot](/user_profile?user_id=553429) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (9 files)

| [Proof of Concept Visual Studio Project](/attachment.cgi?id=9129793)  [5 years ago](#c0)  [James Forshaw](/user_profile?user_id=540730)   34.07 KB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9129793&action=edit) |
| --- | --- | --- |
| [Bug 1557282 Part 1: Take chromium commit c1ce57ea5d31208af589b4839390a44ab20b0c8f. r=handyman!](/attachment.cgi?id=9131513)  [5 years ago](#c22)  [Bob Owen (:bobowen)](/user_profile?user_id=458623)   18.90 KB, patch |  | [Details](/attachment.cgi?id=9131513&action=edit) | [Diff](/attachment.cgi?id=9131513&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1618911&attachment=9131513) |
| [Bug 1557282 Part 2: Fix profiler issues when using SetLockdownDefaultDacl. r=dmajor!](/attachment.cgi?id=9131514)  [5 years ago](#c23)  [Bob Owen (:bobowen)](/user_profile?user_id=458623)   7.47 KB, patch |  | [Details](/attachment.cgi?id=9131514&action=edit) | [Diff](/attachment.cgi?id=9131514&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1618911&attachment=9131514) |
| [Bug 1557282 Part 3: Use SetLockdownDefaultDacl and AddRestrictingRandomSid in sandbox policies. r=handyman!](/attachment.cgi?id=9131515)  [5 years ago](#c24)  [Bob Owen (:bobowen)](/user_profile?user_id=458623)   6.36 KB, patch |  | [Details](/attachment.cgi?id=9131515&action=edit) | [Diff](/attachment.cgi?id=9131515&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1618911&attachment=9131515) |
| [\*\*\*ESR68\*\*\* Bug 1557282 Part 1: Take chromium commit c1ce57ea5d31208af589b4839390a44ab20b0c8f. r=handyman!](/attachment.cgi?id=9131620)  [5 years ago](#c26)  [Bob Owen (:bobowen)](/user_profile?user_id=458623)   22.66 KB, patch |  | [Details](/attachment.cgi?id=9131620&action=edit) | [Diff](/attachment.cgi?id=9131620&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1618911&attachment=9131620) |
| [\*\*\*ESR68\*\*\* Bug 1557282 Part 2: Fix profiler issues when using SetLockdownDefaultDacl. r=dmajor!](/attachment.cgi?id=9131621)  [5 years ago](#c27)  [Bob Owen (:bobowen)](/user_profile?user_id=458623)   5.49 KB, patch |  | [Details](/attachment.cgi?id=9131621&action=edit) | [Diff](/attachment.cgi?id=9131621&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1618911&attachment=9131621) |
| [\*\*\*ESR68\*\*\* Bug 1557282 Part 3: Use SetLockdownDefaultDacl and AddRestrictingRandomSid in sandbox policies. r=handyman!](/attachment.cgi?id=9131622)  [5 years ago](#c28)  [Bob Owen (:bobowen)](/user_profile?user_id=458623)   6.20 KB, patch |  | [Details](/attachment.cgi?id=9131622&action=edit) | [Diff](/attachment.cgi?id=9131622&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1618911&attachment=9131622) |
| [Bug 1557282 Part 4: Use USER\_LIMITED from the start of the socket process sandbox. r=handyman!](/attachment.cgi?id=9131703)  [5 years ago](#c32)  [Bob Owen (:bobowen)](/user_profile?user_id=458623)   1.32 KB, patch |  | [Details](/attachment.cgi?id=9131703&action=edit) | [Diff](/attachment.cgi?id=9131703&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1618911&attachment=9131703) |
| [advisory.txt](/attachment.cgi?id=9144309)  [5 years ago](#c50)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   281 bytes, text/plain |  | [Details](/attachment.cgi?id=9144309&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1618911#c0)• 5 years ago |
|  | |

Attached file
[Proof of Concept Visual Studio Project](attachment.cgi?id=9129793)
— [Details](attachment.cgi?id=9129793&action=edit)

Firefox: Default Content Process DACL Sandbox Escape

Platform: Firefox 73.0.1 and 75.0a1, 64-bit on Windows 10 1809/1909 (not tested earlier OS versions).

Class: Elevation of Privilege

Summary: The Firefox content processes do not sufficiently lockdown access control which can result in a sandbox escape.

Description:

According to <https://wiki.mozilla.org/Security/Sandbox> the current content process sandbox is Level 5 which runs with Chromium token level of USER\_LIMITED. However, USER\_LIMITED is sufficient to open any of the other content processes running at the same time.

The ability to open another process presents a problem, the initial token is set to USER\_RESTRICTED\_SAME\_ACCESS. If a content process is compromised via an RCE then an attack waits for a new content process to be created (there’s also likely a way of making a new content process start programmatically) the process can be opened before the initial thread token is dropped with the call to LowerToken and the attack can run as USER\_RESTRICTED\_SAME\_ACCESS.

Even though the content process runs as a Low Integrity Level this access is sufficient to escape the sandbox. There’s likely to be multiple routes to escape but one which works that I’ve provided as a POC is as follows:

1. Wait for a new content process to start. Immediately suspend the process.
2. Impersonate the main thread’s initial token to elevate privileges.
3. Create an out-of-process COM server using the privileged identity to escape the process Job object. This also bypasses the child process mitigation as that’s set on the primary token, not the impersonation token.
4. Migrate to the new COM server process, abuse a UAC “feature” documented at <https://www.tiraniddo.dev/2019/02/accessing-access-tokens-for-uiaccess.html> which allows us to create a new process with UI Access privilege under our control.
5. Use UI Access to bypass UIPI and programmatically access the Explorer Run Dialog to spawn a process outside of the sandbox.

Fixing wise, you should be able to call the Chromium sandbox target policy function SetLockdownDefaultDacl to restrict the access between content processes. Note that it’s possible this will cause some system code to fail, you’ll need to do extensive testing to make sure it’s not a problem.

On a related topic I’d also recommend calling:

sandbox::ApplyProcessMitigationsToCurrentProcess(sandbox::MITIGATION\_HARDEN\_TOKEN\_IL\_POLICY).

In the main browser process. This prevents related token stealing attacks, which while mostly mitigated in Windows could still pose a risk. This can be done in slow time, it doesn’t have to be part of this fix.

Proof of Concept:

I’ve provided a PoC as a Visual Studio 2019 project. It contains a C# DLL injector and a C++ DLL which will be injected into a running copy of Firefox. The exploit will send details to the debug output which you can capture using Sysinternals Debug View.

Note, I’ve tested this on the latest stable as well as Nightly. It seems at least in Nightly it hits a release assert at <https://dxr.mozilla.org/mozilla-central/source/ipc/glue/Transport_win.h#68> if debugging, continuing the execution the exploit still works. I think this assert is probably due to the process suspension, though it’s not entirely clear. I’m of the opinion that it doesn’t block the exploit, and is not really related.

1. Compile the VS2019 solution project as Release build, x64. The C# It will need to grab the NtApiDotNet library from NuGet to work.
2. Copy the DLL from x64\Release and InjectDll.exe and NtApiDotNet.dll from InjectDll\bin\Release to a generally accessible directory (say C:\Test).
3. Start a copy of Firefox running.
4. From a command line run InjectDll.exe FirefoxSandboxEscape.dll. Check that prints a PID, this is the process the code has injected into which should be a sandboxed content process.
5. In firefox create a new tab and navigate to a new web page. This should cause a new content process to be created for the exploit to hijack. A command prompt running at medium should appear.

Expected Result:

Code running in one content process should not be able to open other content processes.

Observed Result:

Content process is opened, initial thread token repurposes and sandbox escaped.

This bug is subject to a 90 day disclosure deadline. After 90 days elapse,

the bug report will become visible to the public. The scheduled disclosure

date is 2020-05-28. Disclosure at an earlier date is also possible if

agreed upon by all parties.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1618911#c1)• 5 years ago |
|  | |

This looks related to [bug 1554110](/show_bug.cgi?id=1554110 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"), is that right Bob?

Group: firefox-core-security → dom-core-security
[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=affected)
[status-firefox74](/buglist.cgi?f1=cf_status_firefox74&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=affected)Component: Security → Security: Process SandboxingFlags: needinfo?(bobowencode)Product: Firefox → Core

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1618911#c2)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #1](/show_bug.cgi?id=1618911#c1 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"))

> This looks related to [bug 1554110](/show_bug.cgi?id=1554110 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes"), is that right Bob?

Yes, that describes the fundamental issue and our problems with deploying that fix.

The only outstanding issue that we know about is a performance one.

There is another (I believe DirectWrite) performance issue when we have acceleration enabled, but not webrender.

James however gives a much more extensive account of how this can be abused - thanks for the detailed report.

Our original concern was access to other running content processes with different trust levels from the parent (or indeed privileges in the case of the file content process).

The ease of complete escape might mean we need to swallow those performance problems though.

Flags: needinfo?(bobowencode)

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1618911#c3)• 5 years ago |
|  | |

Would it be possible to be added to issue 1554110 to see the discussion, or does it contain other sensitive information? I'm investigating possible better fixes at the Chromium repo level so understanding of issues would be useful.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1618911#c4)• 5 years ago |
|  | |

(In reply to James Forshaw from [comment #3](/show_bug.cgi?id=1618911#c3 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"))

> Would it be possible to be added to issue 1554110 to see the discussion, or does it contain other sensitive information? I'm investigating possible better fixes at the Chromium repo level so understanding of issues would be useful.

Bob? :-)

Status: UNCONFIRMED → NEWEver confirmed: trueFlags: needinfo?(bobowencode)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1618911#c5)• 5 years ago |
|  | |

Added.

Flags: needinfo?(bobowencode)

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1618911#c6)• 5 years ago |
|  | |

Thanks for adding me on to the other bug. I'm currently working on a change to Chromium. In summary in entails:

* Generating a random SID and adding that as a new restricted SID.
* Added the random SID granting full access into the default DACL.
* Use SetLockdownDefaultDacl to remove the other DACL access.

This should provide isolation of processes, threads and their resources from each other running at the same level as long as the each process gets a random SID. However the process will be able to access itself, this should hopefully fix issues with DirectWrite cache, although of course that will get broken at some point if you decide to drop to a lower privilege. I've no idea on the impact of the audio service though. Enabling this will still be optional, it won't be applied to everything just in case of breakage.

It won't stop a process opening another at a similar level which doesn't employ these tricks, so for example an IE PM process running at the same time would still be accessible, but there's not much you can do about that other than running in a more restrictive sandbox.

I'll let you know when I having something in the Chromium repo to test. Of course if you have other ideas it'd be good to know.

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1618911#c7)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1618911&comment_id=14672085 "1 revision") |
|  | |

(In reply to James Forshaw from [comment #6](/show_bug.cgi?id=1618911#c6 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"))

...

> I'll let you know when I having something in the Chromium repo to test. Of course if you have other ideas it'd be good to know.

Thanks James, no other ideas at the moment, but I'm continuing to try and track down the other performance regressions.

Sounds like that will definitely render my OpenProcessToken fix unnecessary, hopefully it will sort the other performance regressions as well.

We were already planning to break the DirectWrite cache deliberately at some point assuming that we would hit the same reconnection issue that you had, but we'll probably only do that when we have the accelerated rendering moved to the GPU process.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1618911#c8)• 5 years ago |
|  | |

[Tracking Requested - why for this release]: Public disclosure date of 2020-05-28, which looks like will happen when 76 is in release.

[tracking-firefox75](/buglist.cgi?f1=cf_tracking_firefox75&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox75&o1=equals&v1=%3F)Whiteboard: [disclosure date is 2020-05-28]

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a402410_580382)• 5 years ago |

[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=wontfix)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox75](/buglist.cgi?f1=cf_tracking_firefox75&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox75&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox75&o1=equals&v1=%2B)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1618911#c9)• 5 years ago |
|  | |

[Tracking Requested - why for this release]:

The deadline per [comment #8](/show_bug.cgi?id=1618911#c8 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape") would mean that, in principle, we'd need to figure something out for ESR. It's unclear to me what the feasibility of that would be.

[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a429024_406194)• 5 years ago |

Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a435582_406194)• 5 years ago |

Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a442352_1689)• 5 years ago |

See Also: → [CVE-2020-12389](/show_bug.cgi?id=1554110 "RESOLVED FIXED - Windows sandbox: renderer processes can open each and unrelated Chromium processes")

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a452104_75935)• 5 years ago |

[status-firefox74](/buglist.cgi?f1=cf_status_firefox74&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=wontfix)

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1618911#c10)• 5 years ago |
|  | |

I've implemented the new sandbox feature in Chromium. [https://chromium.googlesource.com/chromium/src.git/+/c1ce57ea5d31208af589b4839390a44ab20b0c8f](https://chromium.googlesource.com/chromium/src.git/%2B/c1ce57ea5d31208af589b4839390a44ab20b0c8f).

I don't know what you're process is to merge in updates. To enable you'd need to call both SetLockdownDefaultDacl() and AddRestrictingRandomSid() on the sandbox policy.

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1618911#c11)• 5 years ago |
|  | |

(In reply to James Forshaw from [comment #10](/show_bug.cgi?id=1618911#c10 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"))

> I've implemented the new sandbox feature in Chromium. [https://chromium.googlesource.com/chromium/src.git/+/c1ce57ea5d31208af589b4839390a44ab20b0c8f](https://chromium.googlesource.com/chromium/src.git/%2B/c1ce57ea5d31208af589b4839390a44ab20b0c8f).
>
> I don't know what you're process is to merge in updates. To enable you'd need to call both SetLockdownDefaultDacl() and AddRestrictingRandomSid() on the sandbox policy.

Thanks for the speedy implementation.

We normally take full updates, with some shimmed files to reduce dependency creep.

We also have a set of our own patches for various reasons.

In cases like these, I'll try and merge in just that update, we're not too far behind, so hopefully it won't be too painful.

Assignee: nobody → bobowencodeStatus: NEW → ASSIGNED

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a493462_580382)• 5 years ago |

[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F) → [75+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=75%2B)

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a519658_151147)• 5 years ago |

Priority: -- → P1

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1618911#c12)• 5 years ago |
|  | |

Local testing with James's fix looks good, thanks again for this!

* Audio issue appears to be fixed on Windows 7 even without cubeb sandbox (remote audio) enabled
* Gecko profiler issue with stacks fixed
* Performance issues appear to be fixed, although it's a little difficult to be sure of this with local runs. Given that I tried to land the SetLockdownDefaultDacl fix on [bug 1557282](/show_bug.cgi?id=1557282 "RESOLVED FIXED - Add SetLockdownDefaultDacl to the content process sandbox policy for Windows.") (an open bug) last year and I have pushed try pushes with various attempts to fix performance issues I didn't think pushing this fix to try added any new risk. Performance issues appear to be fixed:

  <https://treeherder.mozilla.org/#/jobs?repo=try&selectedJob=291846719&revision=3576fb045d820f0fcb977a916d7e6391d6826d24>

As far as I can see, we'll need to add these settings to all of our sandboxed processes, because if a way can be found to cause them to start (or restart) then they would also be initially running at low integrity and with a permissive access token. So, I think I'm going to have to push a full try push with those changes added, to get some test coverage. My feeling is that if the content process issues are fixed, we have a reasonable chance it won't cause issues in other processes.

One concern I have is when firefox is being run from a network drive.

For legacy reasons a number of people expect this to work.

When we detect this we stop using restricting SIDs in the access tokens, instead just relying on deny only settings.

For some reason, we never got to the bottom of, restricting SIDs don't seem to work for certain things when accessing a network drive.

As the random SID is only added as a restricting SID, it's obviously not there when we're not using them.

James - in the case above is there an easy way (with existing sandbox code or otherwise) to add the random SID to the Access Token as a normal SID, so we still keep access to our own process?

Flags: needinfo?(forshaw)

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1618911#c13)• 5 years ago |
|  | |

Unfortunately it's not really possible to add arbitrary groups, at least not without running with SeTcbPrivilege which basically requires you to be running a system service. The problem with UNC paths is by default Windows blocks access to network resources from restricted tokens, regardless of how much access those tokens have. i.e. even if you add every SID restricted as you have in the list of groups it won't. I believe there's a system setting you could change to allow this to work but of course that'd have to be enabled by the user.

From a unprivileged user process really the only possibility would be to disable the sandbox in your current implementation. There might be a theoretical possibility to use AppContainers on modern Windows 10 versions (which is supported in the Chromium sandbox) but that's fraught with difficult as well.

Could you try the POC I sent to ensure it breaks with the new sandbox changes? I've don't manual analysis in Chrome but not full end to end testing in FF.

Flags: needinfo?(forshaw)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1618911#c14)• 5 years ago |
|  | |

(In reply to James Forshaw from [comment #13](/show_bug.cgi?id=1618911#c13 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"))

> Unfortunately it's not really possible to add arbitrary groups, at least not without running with SeTcbPrivilege which basically requires you to be running a system service. The problem with UNC paths is by default Windows blocks access to network resources from restricted tokens, regardless of how much access those tokens have. i.e. even if you add every SID restricted as you have in the list of groups it won't. I believe there's a system setting you could change to allow this to work but of course that'd have to be enabled by the user.
>
> From a unprivileged user process really the only possibility would be to disable the sandbox in your current implementation. There might be a theoretical possibility to use AppContainers on modern Windows 10 versions (which is supported in the Chromium sandbox) but that's fraught with difficult as well.

Thanks, I guess we have two other choices then, dveditz, tjr - what do you think?:

* Don't lockdown the dacl when running from a network drive, even though that fundamentally weakens the sandbox.
* Land the other fix for the gecko profiler stack issue and just leave the performance problems when we're running from a network drive. Of course there is a chance this will cause other currently unknown issues, but maybe that is better than having a known effectively unsandboxed browser.

> Could you try the POC I sent to ensure it breaks with the new sandbox changes? I've don't manual analysis in Chrome but not full end to end testing in FF.

I've compiled up the POC in VS2017 and checked that it was working without the fix.

With the fix the injected into process crashes, but the medium integrity command prompt doesn't appear.

Flags: needinfo?(tom)Flags: needinfo?(dveditz)

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1618911#c15)• 5 years ago |
|  | |

You can still apply the DACL lockdown, but without the restricting SIDs it won't have any effect. The fix I implemented relies on both a token being sufficiently restricted and the potential target processes running with a restricted DACL. If you've effectively turned off the Restricted SIDs then you'll no longer prevent other processes from opening each other.

As for the POC I'm not sure it should crash, but I guess I've not actually checked it running. Is there a way of getting a test build so I can verify myself? Alternatively I can provide some instruction on using some of my analysis tools in PowerShell which you can use to verify process access.

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1618911#c16)• 5 years ago |
|  | |

(In reply to James Forshaw from [comment #15](/show_bug.cgi?id=1618911#c15 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"))

> You can still apply the DACL lockdown, but without the restricting SIDs it won't have any effect. The fix I implemented relies on both a token being sufficiently restricted and the potential target processes running with a restricted DACL. If you've effectively turned off the Restricted SIDs then you'll no longer prevent other processes from opening each other.

Ah, I guess the User's SID isn't set to deny only.

> As for the POC I'm not sure it should crash, but I guess I've not actually checked it running. Is there a way of getting a test build so I can verify myself? Alternatively I can provide some instruction on using some of my analysis tools in PowerShell which you can use to verify process access.

You could use the build from the try push:

<https://firefox-ci-tc.services.mozilla.com/api/queue/v1/task/IKBzjJx4ReCaH6BkeHZ5Tg/runs/0/artifacts/public/build/install/sea/target.installer.exe>

That only has the fix enabled for content processes and I think your injection could pick up any child process because of the confusing -contentproc arg (which I think actually means we're using firefox.exe and not plugin-container.exe or something), if you also added command contains or possibly ends with "tab", then you should be guaranteed to get a content process.

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1618911#c17)• 5 years ago |
|  | |

(In reply to Bob Owen (:bobowen) from [comment #16](/show_bug.cgi?id=1618911#c16 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"))

> (In reply to James Forshaw from [comment #15](/show_bug.cgi?id=1618911#c15 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"))
>
> > You can still apply the DACL lockdown, but without the restricting SIDs it won't have any effect. The fix I implemented relies on both a token being sufficiently restricted and the potential target processes running with a restricted DACL. If you've effectively turned off the Restricted SIDs then you'll no longer prevent other processes from opening each other.
>
> Ah, I guess the User's SID isn't set to deny only.

I tried this by flipping the flag to always not use restricting SIDs and sure enough the fix no longer works (the exploit starts working again, I had to tweak it a bit to inject into processes without a restricted token).

However, I added into the USER\_LIMITED code when not using restricted SIDs: `restricted_token.AddUserSidForDenyOnly();` and that was enough for it to block the exploit again.

I'm not sure what else that might break, in theory for the normal case we don't have the User's SID because it's not in the restricted set, but Windows permissions can be unpredictable in some cases.

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1618911#c18)• 5 years ago |
|  | |

I wouldn't recommend blocking the user SID through a deny only, at least if you want anything to work correctly. Certainly opening the process would almost certainly fail, although it'll seem to work from in-process because there's a sandbox hook to handle it. The big issue with system services comes down to making a call to a service, that service impersonates the caller then tries to open the calling process which fails.

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1618911#c19)• 5 years ago |
|  | |

(In reply to James Forshaw from [comment #18](/show_bug.cgi?id=1618911#c18 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"))

> I wouldn't recommend blocking the user SID through a deny only, at least if you want anything to work correctly. Certainly opening the process would almost certainly fail, although it'll seem to work from in-process because there's a sandbox hook to handle it. The big issue with system services comes down to making a call to a service, that service impersonates the caller then tries to open the calling process which fails.

Right, we're back to the same regressions as before, one of which I have a fix for and the other performance ones caused presumably by the mechanism you describe.

However, having a performance hit only when running from a network drive, is probably better than having a totally compromised sandbox in that case. We may of course find other things that are broken in other ways than just performance.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1618911#c20)• 5 years ago |
|  | |

(In reply to Bob Owen (:bobowen) from [comment #19](/show_bug.cgi?id=1618911#c19 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"))

> However, having a performance hit only when running from a network drive, is probably better than having a totally compromised sandbox in that case. We may of course find other things that are broken in other ways than just performance.

Agreed.

Flags: needinfo?(tom)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1618911#c21)• 5 years ago |
|  | |

I've tested running from a network drive with the User's SID set to deny only and that does stop the POC.

Things seemed to work OK.

I tried things that run the various different child processes.

It was slow, but that mainly seemed to be down to running from the network rather than this change.

So, I propose to land these patches using open [bug 1557282](/show_bug.cgi?id=1557282 "RESOLVED FIXED - Add SetLockdownDefaultDacl to the content process sandbox policy for Windows."), given that has already had related traffic on it.

Two try pushes:

<https://treeherder.mozilla.org/#/jobs?repo=try&duplicate_jobs=visible&selectedJob=291996630&revision=29d18576ca967f5ec79c491beed287f008cc5f3d>

<https://treeherder.mozilla.org/#/jobs?repo=try&duplicate_jobs=visible&selectedJob=292000034&revision=319875f253dde422da5c154e8815bbb0efa52c29>

The first shows that adding this to the socket process breaks tests, the second is without the settings on the socket process.

I don't think we need to worry about that immediately, because:

* the socket process isn't shipping just yet (although it is soon)
* it starts before any other child processes and as far as I can tell currently doesn't attempt to restart, if that changes, which I guess it may well, then we'll need to work out what the settings are breaking

Not adding the rules to the socket process, has the added bonus of meaning all three patches apply to Beta and Release cleanly.

Unfortunately not ESR68 though, I'm having trouble getting that to build locally at the moment.

I've reproduced with the POC on a Beta and Release build and tested it was blocked with the new settings.

I'll upload the proposed patches to this bug first.

CCing handyman and dmajor as a heads up for the reviews on [bug 1557282](/show_bug.cgi?id=1557282 "RESOLVED FIXED - Add SetLockdownDefaultDacl to the content process sandbox policy for Windows.").

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1618911#c22)• 5 years ago |
|  | |

Attached patch

[Bug 1557282 Part 1: Take chromium commit c1ce57ea5d31208af589b4839390a44ab20b0c8f. r=handyman!](attachment.cgi?id=9131513&action=diff)
— [Details](attachment.cgi?id=9131513&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1618911&attachment=9131513)

This adds AddRestrictingRandomSid feature, which fixes our issues with

SetLockdownDefaultDacl, apart from when we are running from a network drive.

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1618911#c23)• 5 years ago |
|  | |

Attached patch

[Bug 1557282 Part 2: Fix profiler issues when using SetLockdownDefaultDacl. r=dmajor!](attachment.cgi?id=9131514&action=diff)
— [Details](attachment.cgi?id=9131514&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1618911&attachment=9131514)

When we are running from a network drive the new feature in part 1 doesn't work.

So this uses DuplicateHandle instead of OpenThread to get the thread handle used

by the profiler.

It also removes a DuplicateHandle THREAD\_ALL\_ACCESS call that also fails and a

DuplicateHandle to get a real process handle, which only seems to have been to

fix something on Windows XP.

The handle passed in is always the profiler one, so already has the necessary

permissions. If no thread handle is passed then the pseudo handle is used.

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1618911#c24)• 5 years ago |
|  | |

Attached patch

[Bug 1557282 Part 3: Use SetLockdownDefaultDacl and AddRestrictingRandomSid in sandbox policies. r=handyman!](attachment.cgi?id=9131515&action=diff)
— [Details](attachment.cgi?id=9131515&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1618911&attachment=9131515)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1618911#c25)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1618911&comment_id=14681390 "1 revision") |
|  | |

Finally won my fight with the ESR68 build, patches incoming.

I can see the permissions being set properly, but even without them the POC doesn't seem to work for some reason.

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1618911#c26)• 5 years ago |
|  | |

Attached patch

[\*\*\*ESR68\*\*\* Bug 1557282 Part 1: Take chromium commit c1ce57ea5d31208af589b4839390a44ab20b0c8f. r=handyman!](attachment.cgi?id=9131620&action=diff)
— [Details](attachment.cgi?id=9131620&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1618911&attachment=9131620)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1618911#c27)• 5 years ago |
|  | |

Attached patch

[\*\*\*ESR68\*\*\* Bug 1557282 Part 2: Fix profiler issues when using SetLockdownDefaultDacl. r=dmajor!](attachment.cgi?id=9131621&action=diff)
— [Details](attachment.cgi?id=9131621&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1618911&attachment=9131621)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1618911#c28)• 5 years ago |
|  | |

Attached patch

[\*\*\*ESR68\*\*\* Bug 1557282 Part 3: Use SetLockdownDefaultDacl and AddRestrictingRandomSid in sandbox policies. r=handyman!](attachment.cgi?id=9131622&action=diff)
— [Details](attachment.cgi?id=9131622&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1618911&attachment=9131622)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1618911#c29)• 5 years ago |
|  | |

I worked out what was going wrong in the POC for esr68.

In RunExploit `HANDLE proc` was uninitialised and it was then picking up a terminated process and trying to suspend it.

Why this only caused a problem for esr68, I'm not sure.

When I initialised it to nullptr the POC started working and is blocked with the ESR68 patches attached.

(In reply to Bob Owen (:bobowen) from [comment #21](/show_bug.cgi?id=1618911#c21 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"))

...

> The first shows that adding this to the socket process breaks tests, the second is without the settings on the socket process.
>
> I don't think we need to worry about that immediately, because:
>
> * the socket process isn't shipping just yet (although it is soon)
> * it starts before any other child processes and as far as I can tell currently doesn't attempt to restart, if that changes, which I guess it may well, then we'll need to work out what the settings are breaking

I also realised this morning that this is wrong, because we ought to also worry about already running compromised low integrity processes (another firefox instance for example or chrome GPU process (much less likely to be compromised I know)). If firefox with the socket process is then opened the exploit works as the socket process initialises.

One way to break this exploit at least is to run the socket process at USER\_LIMITED from the start, this seems to break the creation of the out-of-process COM server I think.

The media socket process tests still work locally.

One other idea I had was to start the socket process at medium integrity not low (to prevent it being opened), before dropping to untrusted, but this breaks the tests.

I'll try the USER\_LIMITED change on try with the socket process tests and update patch part 3 later, as I see no reason not to do this if it doesn't break anything.

James - do you think starting the socket process without the locked down dacl but at USER\_LIMITED from the start is enough of a mitigation here or do we need to work out why the dacl lockdown is breaking things? (My guess is that it is to do with socket opens, but I haven't proved that.)

Flags: needinfo?(forshaw)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1618911#c30)• 5 years ago |
|  | |

Try push with USER\_LIMITED from start of socket process. Just socket process tests (spi):

<https://treeherder.mozilla.org/#/jobs?repo=try&duplicate_jobs=visible&revision=903e6f3b1b05932defce0be4025c016795b743a7>

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1618911#c31)• 5 years ago |
|  | |

Try push with the socket process using USER\_LIMITED from the start looks good.

I've decided to upload this as a fourth part, because it wouldn't need to be uplifted as the socket process is only enabled on Nightly at the moment.

By the way, I've tried to get everything ready for landing because I will have some time today and tomorrow to work on this, but I'm then on PTO from Monday.

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1618911#c32)• 5 years ago |
|  | |

Attached patch

[Bug 1557282 Part 4: Use USER\_LIMITED from the start of the socket process sandbox. r=handyman!](attachment.cgi?id=9131703&action=diff)
— [Details](attachment.cgi?id=9131703&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1618911&attachment=9131703)

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1618911#c33)• 5 years ago |
|  | |

Sorry for the buggy POC.

The fix is all best efforts IMO. At the current FF's content sandbox level (and Chromium GPU) I'm sure they're probably still a way out given enough time and effort spent. Chromium has the advantage that finding a GPU RCE is slightly more difficult than finding a renderer sandbox escape so that's the only reason it's less of a concern (however I did enable the lockdown in Chromium on Friday).

I think the biggest risk is the initial token, if you can get it working with USER\_LIMITED then that's a good idea. Still would be interesting to find out why your tests are failing as it might identity some new misfeature in Windows which needs to be taken into consideration in the future.

Flags: needinfo?(forshaw)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1618911#c34)• 5 years ago |
|  | |

(In reply to James Forshaw from [comment #33](/show_bug.cgi?id=1618911#c33 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"))

> Sorry for the buggy POC.
>
> The fix is all best efforts IMO. At the current FF's content sandbox level (and Chromium GPU) I'm sure they're probably still a way out given enough time and effort spent. Chromium has the advantage that finding a GPU RCE is slightly more difficult than finding a renderer sandbox escape so that's the only reason it's less of a concern (however I did enable the lockdown in Chromium on Friday).
>
> I think the biggest risk is the initial token, if you can get it working with USER\_LIMITED then that's a good idea. Still would be interesting to find out why your tests are failing as it might identity some new misfeature in Windows which needs to be taken into consideration in the future.

Thanks, looks like we can use USER\_LIMITED from the start for the socket process.

Hopefully when I get back I can find out what is broken in the socket process with the locked down dacl.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1618911#c35)• 5 years ago |
|  | |

I don't think uplifting to beta 75 is realistic if Bob's out until March 23, but we'll see how rough it goes trying to land on nightly in [bug 1557282](/show_bug.cgi?id=1557282 "RESOLVED FIXED - Add SetLockdownDefaultDacl to the content process sandbox policy for Windows.").

Flags: needinfo?(dveditz)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1618911#c36)• 5 years ago |
|  | |

[Bug 1557282](/show_bug.cgi?id=1557282 "RESOLVED FIXED - Add SetLockdownDefaultDacl to the content process sandbox policy for Windows.") landed on central.

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 5 years ago
[status-firefox76](/buglist.cgi?f1=cf_status_firefox76&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox76&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla76

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1618911#c37)• 5 years ago |
|  | |

James, what's the Chrome disclosure timeline on this? If we ship the fix in Firefox 76 (scheduled for 2020-05-05), is that early enough? (It should be per the timeline in [comment 0](/show_bug.cgi?id=1618911#c0 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"), just want to make sure that still stands.)

Flags: needinfo?(forshaw)

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1618911#c38)• 5 years ago |
|  | |

Disclosure wise the Project zero issue will be opened on 2020-05-28 as per the original report. We recently changed our policy and you get the whole 90 days from reporting date before the issues are disclosed. 2020-05-05 should therefore more than meet schedule.

From the Chrome (non-P0) perspective the fixes are merged into Canary/Dev but the issue is not public and won't be for a similar time period. However the fixes don't make any reference to FF in any way.

Flags: needinfo?(forshaw)

|  | [Gian-Carlo Pascutto [:gcp]](/user_profile?user_id=151147) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1618911#c39)• 5 years ago |
|  | |

From discussion, there's an additional complication: for ESR 68, when we're on a network drive and use the fallback fix, we can't rely on AudioIPC to fix the audio issues. So that configuration might end up with broken audio. Not sure how common that configuration is, but Enterprise environments might be exactly the situation where running from a network drive happens. Blergh!

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1618911#c40)• 5 years ago |
|  | |

(In reply to Gian-Carlo Pascutto [:gcp] from [comment #39](/show_bug.cgi?id=1618911#c39 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"))

> From discussion, there's an additional complication: for ESR 68, when we're on a network drive and use the fallback fix, we can't rely on AudioIPC to fix the audio issues. So that configuration might end up with broken audio. Not sure how common that configuration is, but Enterprise environments might be exactly the situation where running from a network drive happens. Blergh!

I've tested running ESR68 from a network drive with the patches applied on two windows 10 installations and audio appears to be working OK.

Given [bug 1567662](/show_bug.cgi?id=1567662 "RESOLVED FIXED - No audio on Firefox Nightly on Windows 10"), from the last time I tried to land this (without the new chromium fix), I suspect that there will be some cases where it is broken.

On windows 7 ESR68 from a network drive had broken audio.

It appeared to be working fine when running locally.

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a2069407_580382)• 5 years ago |

[status-firefox75](/buglist.cgi?f1=cf_status_firefox75&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox75&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox75&o1=equals&v1=wontfix)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[75+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=75%2B) → [76+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=76%2B)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a3020074_553429)• 5 years ago |

Flags: qe-verify-Whiteboard: [disclosure date is 2020-05-28] → [disclosure date is 2020-05-28][post-critsmash-triage]

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1618911#c41)• 5 years ago |
|  | |

RyanVM reminded me that this isn't in ESR68 yet.

The patches landed using publicly open [bug 1557282](/show_bug.cgi?id=1557282 "RESOLVED FIXED - Add SetLockdownDefaultDacl to the content process sandbox policy for Windows.").

The fixes for this don't seem to have caused any issues on Nightly or Beta Fx76 as far as I know.

We know that we will get some problems with broken audio on ESR68 when running from a network drive (Firefox binaries installed on a network share).

That's because we don't have the benefit of cubeb remoting there.

The preferred fix for this, if people can't live with broken audio, is to install Firefox locally on the machine or possibly use Release version if the network installation is a must.

Is everyone happy that we should still take this on ESR68 given the security implications?

If we are, then I'll get the patches updated with any further rebasing / review comments and get them uploaded to [bug 1557282](/show_bug.cgi?id=1557282 "RESOLVED FIXED - Add SetLockdownDefaultDacl to the content process sandbox policy for Windows.") for uplift approval.

Flags: needinfo?(rtestard)Flags: needinfo?(mozilla)Flags: needinfo?(dveditz)Flags: needinfo?(drno)

|  | [Mike Kaply [:mkaply]](/user_profile?user_id=7313) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1618911#c42)• 5 years ago |
|  | |

That's fine with me. And worst case on ESR, can't they change the sandbox value?

Flags: needinfo?(mozilla)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1618911#c43)• 5 years ago |
|  | |

(In reply to Mike Kaply [:mkaply] from [comment #42](/show_bug.cgi?id=1618911#c42 "RESOLVED FIXED - Firefox: Default Content Process DACL Sandbox Escape"))

> That's fine with me. And worst case on ESR, can't they change the sandbox value?

They can, but I don't think we should recommend that as a solution.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1618911#c44)• 5 years ago |
|  | |

Fine with me -- I prefer to fix the security bug

Flags: needinfo?(dveditz)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a4590883_406194)• 5 years ago |

URL: [https://googleprojectzero.blogspot.co...](https://googleprojectzero.blogspot.com/2020/04/you-wont-believe-what-this-one-line.html)

|  | [James Forshaw](/user_profile?user_id=540730)  Reporter |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1618911#c45)• 5 years ago |
|  | |

The blog is not about this issue. I identified this issue while implementing the exploit chain for the Windows kernel bug in that blog post. I originally targeted FF's Content Sandbox, but the blog post I only briefly mention FF and focus on Chrome to avoid people looking too closely. The P0 issue for this vulnerability is still hidden and within the 90 days of disclosure.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1618911#c46)• 5 years ago |
|  | |

Ah, sorry. I haven't had a chance to read the blog post yet. Thanks for the correction.

URL: [https://googleprojectzero.blogspot.co...](https://googleprojectzero.blogspot.com/2020/04/you-wont-believe-what-this-one-line.html)

|  | [Nils Ohlmeier [:drno]](/user_profile?user_id=489581) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1618911#c47)• 5 years ago |
|  | |

Hopefully with ESR 78 (or before on normal release) we will gain the ability to do audio remotely on Windows. So yes lets fix the security issue.

Flags: needinfo?(drno)

|  | [Romain Testard [:RT]](/user_profile?user_id=486264) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1618911#c48)• 5 years ago |
|  | |

Fine with me

Flags: needinfo?(rtestard)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1618911#c49)• 5 years ago |
|  | |

Thanks everyone, patches are now up on [bug 1557282](/show_bug.cgi?id=1557282 "RESOLVED FIXED - Add SetLockdownDefaultDacl to the content process sandbox policy for Windows.") and ESR68 uplift approval requested.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a4852070_75935)• 5 years ago |

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a5256479_428608)• 5 years ago |

Whiteboard: [disclosure date is 2020-05-28][post-critsmash-triage] → [disclosure date is 2020-05-28][post-critsmash-triage][adv-main76+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a5257474_428608)• 5 years ago |

Whiteboard: [disclosure date is 2020-05-28][post-critsmash-triage][adv-main76+] → [disclosure date is 2020-05-28][post-critsmash-triage][adv-main76+][adv-ESR68.8+]

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1618911#c50)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9144309)
— [Details](attachment.cgi?id=9144309&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a5330135_428608)• 5 years ago |

Alias: CVE-2020-12388

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a7765418_428608)• 5 years ago |

See Also: → <https://bugs.chromium.org/p/project-zero/issues/detail?id=2016>

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1618911#c51)• 5 years ago |
|  | |

No point in keeping it closed after P0 releases their report. Opening up as per conversation with Dan.

Group: core-security-release

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1618911#c52)• 5 years ago |
|  | |

Project Zero blog post: <https://googleprojectzero.blogspot.com/2020/06/ff-sandbox-escape-cve-2020-12388.html>

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1618911#a51853782_578488)• 3 years ago |

Keywords: [csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---)
You need to [log in](/show_bug.cgi?id=1618911&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [James Forshaw](/user_profile?user_id=540730)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_99346820_20250119_111039.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-16

## Security Vulnerabilities fixed in Firefox 76

Announced
May 5, 2020
Impact
critical
Products
Firefox
Fixed in

* Firefox 76

#### [#CVE-2020-12387: Use-after-free during worker shutdown](#CVE-2020-12387)

Reporter
Looben Yang
Impact
critical
##### Description

A race condition when running shutdown code for Web Worker led to a use-after-free vulnerability. This resulted in a potentially exploitable crash.

##### References

* [Bug 1545345](https://bugzilla.mozilla.org/show_bug.cgi?id=1545345)

#### [#CVE-2020-12388: Sandbox escape with improperly guarded Access Tokens](#CVE-2020-12388)

Reporter
James Forshaw of Google Project Zero
Impact
critical
##### Description

The Firefox content processes did not sufficiently lockdown access control which could result in a sandbox escape.
*Note: this issue only affects Firefox on Windows operating systems.*

##### References

* [Bug 1618911](https://bugzilla.mozilla.org/show_bug.cgi?id=1618911)

#### [#CVE-2020-12389: Sandbox escape with improperly separated process types](#CVE-2020-12389)

Reporter
Niklas Baumstark
Impact
high
##### Description

The Firefox content processes did not sufficiently lockdown access control which could result in a sandbox escape.
*Note: this issue only affects Firefox on Windows operating systems.*

##### References

* [Bug 1554110](https://bugzilla.mozilla.org/show_bug.cgi?id=1554110)

#### [#CVE-2020-6831: Buffer overflow in SCTP chunk input validation](#CVE-2020-6831)

Reporter
Natalie Silvanovich of Google Project Zero
Impact
high
##### Description

A buffer overflow could occur when parsing and validating SCTP chunks in WebRTC. This could have led to memory corruption and a potentially exploitable crash.

##### References

* [Bug 1632241](https://bugzilla.mozilla.org/show_bug.cgi?id=1632241)

#### [#CVE-2020-12390: Incorrect serialization of nsIPrincipal.origin for IPv6 addresses](#CVE-2020-12390)

Reporter
Giorgio Maone
Impact
moderate
##### Description

Incorrect origin serialization of URLs with IPv6 addresses could lead to incorrect security checks

##### References

* [Bug 1141959](https://bugzilla.mozilla.org/show_bug.cgi?id=1141959)

#### [#CVE-2020-12391: Content-Security-Policy bypass using object elements](#CVE-2020-12391)

Reporter
Giorgio Maone
Impact
moderate
##### Description

Documents formed using `data:` URLs in an `object` element failed to inherit the CSP of the creating context. This allowed the execution of scripts that should have been blocked, albeit with a unique opaque origin.

##### References

* [Bug 1457100](https://bugzilla.mozilla.org/show_bug.cgi?id=1457100)

#### [#CVE-2020-12392: Arbitrary local file access with 'Copy as cURL'](#CVE-2020-12392)

Reporter
Ophir LOJKINE
Impact
moderate
##### Description

The 'Copy as cURL' feature of Devtools' network tab did not properly escape the HTTP POST data of a request, which can be controlled by the website. If a user used the 'Copy as cURL' feature and pasted the command into a terminal, it could have resulted in the disclosure of local files.

##### References

* [Bug 1614468](https://bugzilla.mozilla.org/show_bug.cgi?id=1614468)

#### [#CVE-2020-12393: Devtools' 'Copy as cURL' feature did not fully escape website-controlled data, potentially leading to command injection](#CVE-2020-12393)

Reporter
David Yesland
Impact
moderate
##### Description

The 'Copy as cURL' feature of Devtools' network tab did not properly escape the HTTP method of a request, which can be controlled by the website. If a user used the 'Copy as cURL' feature and pasted the command into a terminal, it could have resulted in command injection and arbitrary command execution.
*Note: this issue only affects Firefox on Windows operating systems.*

##### References

* [Bug 1615471](https://bugzilla.mozilla.org/show_bug.cgi?id=1615471)

#### [#CVE-2020-12394: URL spoofing in location bar when unfocussed](#CVE-2020-12394)

Reporter
Kestrel
Impact
low
##### Description

A logic flaw in our location bar implementation could have allowed a local attacker to spoof the current location by selecting a different origin and removing focus from the input element.

##### References

* [Bug 1628288](https://bugzilla.mozilla.org/show_bug.cgi?id=1628288)

#### [#CVE-2020-12395: Memory safety bugs fixed in Firefox 76 and Firefox ESR 68.8](#CVE-2020-12395)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Alexandru Michis, Jason Kratzer, philipp, Ted Campbell, Bas Schouten, André Bargull, and Karl Tomlinson reported memory safety bugs present in Firefox 75 and Firefox ESR 68.7. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 76 and Firefox ESR 68.8](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1595886%2C1611482%2C1614704%2C1624098%2C1625749%2C1626382%2C1628076%2C1631508)

#### [#CVE-2020-12396: Memory safety bugs fixed in Firefox 76](#CVE-2020-12396)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Frederik Braun, Andrew McCreight, C.M.Chang, and Dan Minor reported memory safety bugs present in Firefox 75. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 76](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1339601%2C1611938%2C1620488%2C1622291%2C1627644)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


