=== Content from github.com_425c1236_20250119_141012.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-p665-3xc8-4hrv)

**CVE-2020-12887**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-p665-3xc8-4hrv)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2020-12887](/advisories/GHSA-p665-3xc8-4hrv)

## Memory leaks were discovered in the CoAP library in Arm...

Moderate severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
•
Updated Jan 29, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-p665-3xc8-4hrv/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

Memory leaks were discovered in the CoAP library in Arm Mbed OS 5.15.3 when using the Arm mbed-coap library 5.1.5. The CoAP parser is responsible for parsing received CoAP packets. The function sn\_coap\_parser\_options\_parse() parses the CoAP option number field of all options present in the input packet. Each option number is calculated as a sum of the previous option number and a delta of the current option. The delta and the previous option number are expressed as unsigned 16-bit integers. Due to lack of overflow detection, it is possible to craft a packet that wraps the option number around and results in the same option number being processed again in a single packet. Certain options allocate memory by calling a memory allocation function. In the cases of COAP\_OPTION\_URI\_QUERY, COAP\_OPTION\_URI\_PATH, COAP\_OPTION\_LOCATION\_QUERY, and COAP\_OPTION\_ETAG, there is no check on whether memory has already been allocated, which in conjunction with the option number integer overflow may lead to multiple assignments of allocated memory to a single pointer. This has been demonstrated to lead to memory leak by buffer orphaning. As a result, the memory is never freed.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-12887>
* [ARMmbed/mbed-os#12930](https://github.com/ARMmbed/mbed-os/issues/12930)
* [ARMmbed/mbed-os#12957](https://github.com/ARMmbed/mbed-os/issues/12957)
* [PelionIoT/mbed-coap#116](https://github.com/PelionIoT/mbed-coap/pull/116)
* [mjurczak/mbed-coap@4647a68](https://github.com/mjurczak/mbed-coap/commit/4647a68e364401e81dbd370728127d844f221d93)

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-12887)
Jun 18, 2020

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Jan 29, 2023

### Severity

Moderate

### [EPSS score](https://www.first.org/epss/user-guide)

0.399%
 (73rd percentile)

### Weaknesses

[CWE-401](/advisories?query=cwe%3A401)

### CVE ID

CVE-2020-12887

### GHSA ID

GHSA-p665-3xc8-4hrv

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-p665-3xc8-4hrv/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a20c262b_20250119_141013.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-ghhj-m687-4jqx)

**CVE-2020-12884**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-ghhj-m687-4jqx)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2020-12884](/advisories/GHSA-ghhj-m687-4jqx)

## A buffer over-read was discovered in the CoAP library in...

Moderate severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
•
Updated Jan 29, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-ghhj-m687-4jqx/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

A buffer over-read was discovered in the CoAP library in Arm Mbed OS 5.15.3. The CoAP parser is responsible for parsing received CoAP packets. The function sn\_coap\_parser\_options\_parse\_multiple\_options() parses CoAP options that may occur multiple consecutive times in a single packet. While processing the options, packet\_data\_pptr is accessed after being incremented by option\_len without a prior out-of-bounds memory check. The temp\_parsed\_uri\_query\_ptr is validated for a correct range, but the range valid for temp\_parsed\_uri\_query\_ptr is derived from the amount of allocated heap memory, not the actual input size. Therefore the check of temp\_parsed\_uri\_query\_ptr may be insufficient for safe access to the area pointed to by packet\_data\_pptr. As a result, access to a memory area outside of the intended boundary of the packet buffer is made.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-12884>
* [ARMmbed/mbed-os#12928](https://github.com/ARMmbed/mbed-os/issues/12928)
* [PelionIoT/mbed-coap#116](https://github.com/PelionIoT/mbed-coap/pull/116)

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-12884)
Jun 18, 2020

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Jan 29, 2023

### Severity

Moderate

### [EPSS score](https://www.first.org/epss/user-guide)

0.235%
 (61st percentile)

### Weaknesses

No CWEs

### CVE ID

CVE-2020-12884

### GHSA ID

GHSA-ghhj-m687-4jqx

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-ghhj-m687-4jqx/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_ac25a848_20250119_141012.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-jhjh-34gq-3m8c)

**CVE-2020-12885**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-jhjh-34gq-3m8c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2020-12885](/advisories/GHSA-jhjh-34gq-3m8c)

## An infinite loop was discovered in the CoAP library in...

High severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
•
Updated Jan 29, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-jhjh-34gq-3m8c/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

An infinite loop was discovered in the CoAP library in Arm Mbed OS 5.15.3. The CoAP parser is responsible for parsing received CoAP packets. The function sn\_coap\_parser\_options\_parse\_multiple\_options() parses CoAP options in a while loop. This loop's exit condition is computed using the previously allocated heap memory required for storing the result of parsing multiple options. If the input heap memory calculation results in zero bytes, the loop exit condition is never met and the loop is not terminated. As a result, the packet parsing function never exits, leading to resource consumption.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-12885>
* [ARMmbed/mbed-os#12929](https://github.com/ARMmbed/mbed-os/issues/12929)
* [PelionIoT/mbed-coap#116](https://github.com/PelionIoT/mbed-coap/pull/116)

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-12885)
Jun 18, 2020

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Jan 29, 2023

### Severity

High

### [EPSS score](https://www.first.org/epss/user-guide)

0.145%
 (51st percentile)

### Weaknesses

No CWEs

### CVE ID

CVE-2020-12885

### GHSA ID

GHSA-jhjh-34gq-3m8c

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-jhjh-34gq-3m8c/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_82c9e6fe_20250119_141013.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-x723-g4p2-w8m5)

**CVE-2020-12883**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-x723-g4p2-w8m5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2020-12883](/advisories/GHSA-x723-g4p2-w8m5)

## Buffer over-reads were discovered in the CoAP library in...

Moderate severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
•
Updated Jan 29, 2023

## Package

No package listed—
[Suggest a package](/advisories/GHSA-x723-g4p2-w8m5/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

Buffer over-reads were discovered in the CoAP library in Arm Mbed OS 5.15.3. The CoAP parser is responsible for parsing received CoAP packets. The function sn\_coap\_parser\_options\_parse() parses CoAP input linearly using a while loop. Once an option is parsed in a loop, the current point (\*packet\_data\_pptr) is increased correspondingly. The pointer is restricted by the size of the received buffer, as well as by the option delta and option length bytes. The actual input packet length is not verified against the number of bytes read when processing the option extended delta and the option extended length. Moreover, the calculation of the message\_left variable, in the case of non-extended option deltas, is incorrect and indicates more data left for processing than provided in the function input. All of these lead to heap-based or stack-based memory location read access that is outside of the intended boundary of the buffer. Depending on the platform-specific memory management mechanisms, it can lead to processing of unintended inputs or system memory access violation errors.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-12883>
* [ARMmbed/mbed-os#12925](https://github.com/ARMmbed/mbed-os/issues/12925)
* [ARMmbed/mbed-os#12926](https://github.com/ARMmbed/mbed-os/issues/12926)
* [ARMmbed/mbed-os#12927](https://github.com/ARMmbed/mbed-os/issues/12927)
* [PelionIoT/mbed-coap#116](https://github.com/PelionIoT/mbed-coap/pull/116)

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-12883)
Jun 18, 2020

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Jan 29, 2023

### Severity

Moderate

### [EPSS score](https://www.first.org/epss/user-guide)

0.557%
 (78th percentile)

### Weaknesses

[CWE-119](/advisories?query=cwe%3A119)

### CVE ID

CVE-2020-12883

### GHSA ID

GHSA-x723-g4p2-w8m5

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-x723-g4p2-w8m5/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_c204b6c9_20250119_141012.html ===
���� �  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222��  ( (" ���          
   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz�������������������������������������������������������������������������       
  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? �&ԭ�-�i�]��e�� w5jsI��N�FG!�P��2?Z�5}Hiڥ��i ��e�?�'G��t��:��;\�x��Y`3ӑ��:����R���v��C4{Ն�F:{�zU� ș?�r��柭]K-��`#
!�W��q�?�L\_tE�$\*���>�ҭU��1�)'dtj�y��Gۡ� �����s��Y���lc��n���� ��� =�:��U��iJʁՇ�s�G�l~�sdm#X.d]��t����h1��b�b�(���0�籬M�Q�]��n'd27!�U�����9GCҧR<�o���ʋ���3��G��\*�+1��l���V��k5�bI6�c���}8�Y�#\���5��.�3|��Yⷞ�Y������.�7������^�L���N�ڱ����Ċ�� �������� �j$�zgb��ᐆF���[ė�p�1a\*� g������ ��?δ?��� �Wf�W+\_0��u��+���aӴא��냚��� S/Ҹ� �.\_���VU]�Qٲk}~M/I[��2���d��������G� @v� ���+7\� �6���� �Ee�m1����

=== Content from github.com_cda35c81_20250119_123406.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FARMmbed%2Fmbed-os%2Fissues%2F12929)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FARMmbed%2Fmbed-os%2Fissues%2F12929)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fissues%2Fshow&source=header-repo&source_repo=ARMmbed%2Fmbed-os)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ARMmbed](/ARMmbed)
/
**[mbed-os](/ARMmbed/mbed-os)**
Public

* [Notifications](/login?return_to=%2FARMmbed%2Fmbed-os) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2FARMmbed%2Fmbed-os)
* [Star
   4.7k](/login?return_to=%2FARMmbed%2Fmbed-os)

* [Code](/ARMmbed/mbed-os)
* [Issues
  195](/ARMmbed/mbed-os/issues)
* [Pull requests
  11](/ARMmbed/mbed-os/pulls)
* [Actions](/ARMmbed/mbed-os/actions)
* [Projects
  0](/ARMmbed/mbed-os/projects)
* [Security](/ARMmbed/mbed-os/security)
* [Insights](/ARMmbed/mbed-os/pulse)

Additional navigation options

* [Code](/ARMmbed/mbed-os)
* [Issues](/ARMmbed/mbed-os/issues)
* [Pull requests](/ARMmbed/mbed-os/pulls)
* [Actions](/ARMmbed/mbed-os/actions)
* [Projects](/ARMmbed/mbed-os/projects)
* [Security](/ARMmbed/mbed-os/security)
* [Insights](/ARMmbed/mbed-os/pulse)

# Infinite loop in MbedOS CoAP library parser #12929

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Infinite loop in MbedOS CoAP library parser](#top)#12929Copy linkLabels[type: bug](https://github.com/ARMmbed/mbed-os/issues?q=state%3Aopen%20label%3A%22type%3A%20bug%22)![@mjurczak](https://avatars.githubusercontent.com/u/9540275?u=c8ed5071ca8020098fdd9c01e58b807398a7bbe2&v=4&size=80)
## Description

![@mjurczak](https://avatars.githubusercontent.com/u/9540275?u=c8ed5071ca8020098fdd9c01e58b807398a7bbe2&v=4&size=48)[mjurczak](https://github.com/mjurczak)opened [on May 5, 2020](https://github.com/ARMmbed/mbed-os/issues/12929#issue-612896526)
### Description of defect

**References:**

<https://github.com/ARMmbed/mbed-os/tree/mbed-os-5.15.3/features/frameworks/mbed-coap>

<https://github.com/ARMmbed/mbed-coap/tree/v5.1.5>

**File:**

[sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c)

```
Example Trace:
    #*  sn_coap_parser_options_parse_multiple_options()
        sn_coap_parser.c:657
    #*  sn_coap_parser_options_parse()
        sn_coap_parser.c:498
    #n  sn_coap_parser()
        sn_coap_parser.c:161

```

**Analysis:**

If a packet with an option processed by parse\_multiple\_options() function and declared zero option length is encountered, the parser enters an infinite loop.

Example entry point with zero-length option\_len:

[mbed-os/features/frameworks/mbed-coap/source/sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c#L498-L501)

Lines 498 to 501
in
[b6370b4](/ARMmbed/mbed-os/commit/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3)

|  | ret\_status = sn\_coap\_parser\_options\_parse\_multiple\_options(handle, packet\_data\_pptr, message\_left, |
| --- | --- |
|  | &dst\_coap\_msg\_ptr->options\_list\_ptr->location\_query\_ptr, &dst\_coap\_msg\_ptr->options\_list\_ptr->location\_query\_len, |
|  | COAP\_OPTION\_LOCATION\_QUERY, option\_len); |
|  | if (ret\_status >= 0) { |

Together with message\_left equal to 1 this results in zero-length needed heap calculation result:

[mbed-os/features/frameworks/mbed-coap/source/sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c#L635)

Line 635
in
[b6370b4](/ARMmbed/mbed-os/commit/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3)

|  | int16\_t uri\_query\_needed\_heap = sn\_coap\_parser\_options\_count\_needed\_memory\_multiple\_option(\*packet\_data\_pptr, packet\_left\_len, option, option\_number\_len); |
| --- | --- |

With zero length heap allocation the function exits early without entering the main processing loop:

[mbed-os/features/frameworks/mbed-coap/source/sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c#L652-L657)

Lines 652 to 657
in
[b6370b4](/ARMmbed/mbed-os/commit/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3)

|  | \*dst\_len\_ptr = uri\_query\_needed\_heap; |
| --- | --- |
|  |  |
|  | temp\_parsed\_uri\_query\_ptr = \*dst\_pptr; |
|  |  |
|  | /\* Loop all Uri-Query options \*/ |
|  | while ((temp\_parsed\_uri\_query\_ptr - \*dst\_pptr) < uri\_query\_needed\_heap) { |

Which leaves (\*packet\_data\_pptr) unmodified, pointing at the same option which leads to sn\_coap\_parser\_options\_parse() looping over the same option in an infinite loop.

**Type:**

* Remote Denial Of Service
* Excessive resources usage (CPU time)
* System overload

**Result:**

* The procedure loops infinitely

#### Target(s) affected by this defect ?

* MbedOS mbed-coap library 5.1.5
* MbedOS 5.15.3

#### Toolchain(s) (name and version) displaying this defect ?

N/A

#### What version of Mbed-os are you using (tag or sha) ?

MbedOS 5.15.3

#### What version(s) of tools are you using. List all that apply (E.g. mbed-cli)

N/A

#### How is this defect reproduced ?

Parsing the provided input example input with sn\_coap\_parser() function.

```
#include <stdint.h>
#include <stdlib.h>
#include <stdio.h>
#include "sn_coap_protocol.h"
#include "sn_coap_header.h"

struct coap_s* coapHandle;
coap_version_e coapVersion = COAP_VERSION_1;

void* coap_malloc(uint16_t size){
    return malloc(size);
}

void coap_free(void* addr){
    free(addr);
}

uint8_t coap_tx_cb(uint8_t *arg_a, uint16_t arg_b, sn_nsdl_addr_s *arg_c, void *arg_d){
    return 0;
}

int8_t coap_rx_cb(sn_coap_hdr_s *arg_a, sn_nsdl_addr_s *arg_b, void *arg_c){
    return 0;
}

int main(int argc, const char* argv[])
{
    FILE *fp;
    size_t read_bytes;
    size_t input_size;
    uint8_t *message_buffer;
    if (argc != 2)
    {
       return 1;
    }

    fp = fopen(argv[1], "r");
    if (fp == NULL)
    {
      return 2;
    }

    fseek (fp , 0 , SEEK_END);
    input_size = ftell(fp);
    rewind (fp);

    if (input_size > 65527)
    {
      return 3;
    }

    message_buffer = malloc(input_size);
    read_bytes = fread(message_buffer, 1, input_size, fp);
    fclose(fp);
    coapHandle = sn_coap_protocol_init(&coap_malloc, &coap_free, &coap_tx_cb, &coap_rx_cb);
    sn_coap_hdr_s* parsed = sn_coap_parser(coapHandle, read_bytes, message_buffer, &coapVersion);
    sn_coap_parser_release_allocated_coap_msg_mem(coapHandle, parsed);
    free(message_buffer);

    return 0;
}
```

[hang1.log](https://github.com/ARMmbed/mbed-os/files/4583616/hang1.log)

[hang\_minimal.log](https://github.com/ARMmbed/mbed-os/files/4583618/hang_minimal.log)

## Metadata

### Assignees

No one assigned

### Labels

[type: bug](https://github.com/ARMmbed/mbed-os/issues?q=state%3Aopen%20label%3A%22type%3A%20bug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_6611b78d_20250119_123405.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPelionIoT%2Fmbed-coap%2Fpull%2F116)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPelionIoT%2Fmbed-coap%2Fpull%2F116)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=PelionIoT%2Fmbed-coap)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PelionIoT](/PelionIoT)
/
**[mbed-coap](/PelionIoT/mbed-coap)**
Public

* [Notifications](/login?return_to=%2FPelionIoT%2Fmbed-coap) You must be signed in to change notification settings
* [Fork
  16](/login?return_to=%2FPelionIoT%2Fmbed-coap)
* [Star
   29](/login?return_to=%2FPelionIoT%2Fmbed-coap)

* [Code](/PelionIoT/mbed-coap)
* [Issues
  6](/PelionIoT/mbed-coap/issues)
* [Pull requests
  2](/PelionIoT/mbed-coap/pulls)
* [Actions](/PelionIoT/mbed-coap/actions)
* [Projects
  0](/PelionIoT/mbed-coap/projects)
* [Security](/PelionIoT/mbed-coap/security)
* [Insights](/PelionIoT/mbed-coap/pulse)

Additional navigation options

* [Code](/PelionIoT/mbed-coap)
* [Issues](/PelionIoT/mbed-coap/issues)
* [Pull requests](/PelionIoT/mbed-coap/pulls)
* [Actions](/PelionIoT/mbed-coap/actions)
* [Projects](/PelionIoT/mbed-coap/projects)
* [Security](/PelionIoT/mbed-coap/security)
* [Insights](/PelionIoT/mbed-coap/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FPelionIoT%2Fmbed-coap%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FPelionIoT%2Fmbed-coap%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Bugfix/coap parser mem access bugs #116

 Merged

[esajaa](/esajaa)
merged 6 commits into
[PelionIoT:master](/PelionIoT/mbed-coap/tree/master "PelionIoT/mbed-coap:master")
from
[mjurczak:bugfix/coap\_parser\_mem\_access\_bugs](/mjurczak/mbed-coap/tree/bugfix/coap_parser_mem_access_bugs "mjurczak/mbed-coap:bugfix/coap_parser_mem_access_bugs")

Jun 22, 2020

 Merged

# [Bugfix/coap parser mem access bugs](#top) #116

[esajaa](/esajaa)
merged 6 commits into
[PelionIoT:master](/PelionIoT/mbed-coap/tree/master "PelionIoT/mbed-coap:master")
from
[mjurczak:bugfix/coap\_parser\_mem\_access\_bugs](/mjurczak/mbed-coap/tree/bugfix/coap_parser_mem_access_bugs "mjurczak/mbed-coap:bugfix/coap_parser_mem_access_bugs")

Jun 22, 2020

[Conversation
2](/PelionIoT/mbed-coap/pull/116)
[Commits
6](/PelionIoT/mbed-coap/pull/116/commits)
[Checks
0](/PelionIoT/mbed-coap/pull/116/checks)
[Files changed](/PelionIoT/mbed-coap/pull/116/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![mjurczak](https://avatars.githubusercontent.com/u/9540275?s=60&v=4)](/mjurczak)

Copy link

Contributor

### @mjurczak **[mjurczak](/mjurczak)** commented [Jun 10, 2020](#issue-636576282)

[x] I confirm this contribution is my own and I agree to license it with Apache 2.0.

[x] I confirm the moderators may change the PR before merging it in.

### Summary of changes

Fixes for out-ouf-bounds memory access, memory leak and infinite loop condition in coap packets parser.

The fixed issues described in detail in the following threads:

[ARMmbed/mbed-os#12957](https://github.com/ARMmbed/mbed-os/issues/12957)

[ARMmbed/mbed-os#12948](https://github.com/ARMmbed/mbed-os/issues/12948)

[ARMmbed/mbed-os#12930](https://github.com/ARMmbed/mbed-os/issues/12930)

[ARMmbed/mbed-os#12928](https://github.com/ARMmbed/mbed-os/issues/12928)

[ARMmbed/mbed-os#12927](https://github.com/ARMmbed/mbed-os/issues/12927)

[ARMmbed/mbed-os#12926](https://github.com/ARMmbed/mbed-os/issues/12926)

[ARMmbed/mbed-os#12925](https://github.com/ARMmbed/mbed-os/issues/12925)

Reserved CVE identifiers related to the resolved issues:

[CVE-2020-12886](https://github.com/advisories/GHSA-8v45-9mw2-ffmm "CVE-2020-12886")

[CVE-2020-12883](https://github.com/advisories/GHSA-x723-g4p2-w8m5 "CVE-2020-12883")

[CVE-2020-12884](https://github.com/advisories/GHSA-ghhj-m687-4jqx "CVE-2020-12884")

[CVE-2020-12885](https://github.com/advisories/GHSA-jhjh-34gq-3m8c "CVE-2020-12885")

[CVE-2020-12887](https://github.com/advisories/GHSA-p665-3xc8-4hrv "CVE-2020-12887")

Sorry, something went wrong.

All reactions

 [mjurczak](/mjurczak)
added 4 commits
[May 7, 2020 12:23](#commits-pushed-152cde0)

[![@mjurczak](https://avatars.githubusercontent.com/u/9540275?s=40&v=4)](/mjurczak)

`[Merge pull request](/PelionIoT/mbed-coap/pull/116/commits/152cde0a79afc1e66ef36484172ee2f433777d0b "Merge pull request #1 from ARMmbed/master

Update to latest mastser") [#1](https://github.com/mjurczak/mbed-coap/pull/1) [from ARMmbed/master](/PelionIoT/mbed-coap/pull/116/commits/152cde0a79afc1e66ef36484172ee2f433777d0b "Merge pull request #1 from ARMmbed/master

Update to latest mastser")`
 …

`[152cde0](/PelionIoT/mbed-coap/pull/116/commits/152cde0a79afc1e66ef36484172ee2f433777d0b)`

```
Update to latest mastser
```

[![@mjurczak](https://avatars.githubusercontent.com/u/9540275?s=40&v=4)](/mjurczak)

`[Implemented measures to protect against out-of-bounds memory access i…](/PelionIoT/mbed-coap/pull/116/commits/cbcb40b466d05905d354437849f3e806beee3202 "Implemented measures to protect against out-of-bounds memory access in coap parser.

Fixed insufficient memory range validation prior to memory access in options parsing and token parsing.

CVE-2020-12886
CVE-2020-12883
CVE-2020-12884")`
 …

`[cbcb40b](/PelionIoT/mbed-coap/pull/116/commits/cbcb40b466d05905d354437849f3e806beee3202)`

```
…n coap parser.

Fixed insufficient memory range validation prior to memory access in options parsing and token parsing.

[CVE-2020-12886](https://github.com/advisories/GHSA-8v45-9mw2-ffmm "CVE-2020-12886")
[CVE-2020-12883](https://github.com/advisories/GHSA-x723-g4p2-w8m5 "CVE-2020-12883")
[CVE-2020-12884](https://github.com/advisories/GHSA-ghhj-m687-4jqx "CVE-2020-12884")
```

[![@mjurczak](https://avatars.githubusercontent.com/u/9540275?s=40&v=4)](/mjurczak)

`[Fixed possible infinite loop in sn_coap_parser_options_parse_multiple…](/PelionIoT/mbed-coap/pull/116/commits/f50e3311337d68092e1fe21f1c195f16a1d0cb43 "Fixed possible infinite loop in sn_coap_parser_options_parse_multiple_options()

Fixed an issue with improved boundary checks and inproved end-of multiple options processing loop break conditions.
Simplified the sn_coap_parser_options_count_needed_memory_multiple_option() function by reusing extended options number/length parsing functions.

CVE-2020-12885")`
 …

`[f50e331](/PelionIoT/mbed-coap/pull/116/commits/f50e3311337d68092e1fe21f1c195f16a1d0cb43)`

```
…_options()

Fixed an issue with improved boundary checks and inproved end-of multiple options processing loop break conditions.
Simplified the sn_coap_parser_options_count_needed_memory_multiple_option() function by reusing extended options number/length parsing functions.

[CVE-2020-12885](https://github.com/advisories/GHSA-jhjh-34gq-3m8c "CVE-2020-12885")
```

[![@mjurczak](https://avatars.githubusercontent.com/u/9540275?s=40&v=4)](/mjurczak)

`[Implemented measures to prevent memory leaks in sn_coap_parser_option…](/PelionIoT/mbed-coap/pull/116/commits/e65e5eb79a66e004e9fdb30f224447ab6179059a "Implemented measures to prevent memory leaks in sn_coap_parser_options_parse().

Added a helper uint16_t addition function with overflow detection. The function is used when calculating the extended length and option delta. The overlow detection is needed to avoid wrap-around of option number or length.
Additional checks in options using sn_coap_parser_options_parse_multiple_options() have been implemented to avoid overwriting of pointers pointing to previously allocated memory.

CVE-2020-12887")`
 …

`[e65e5eb](/PelionIoT/mbed-coap/pull/116/commits/e65e5eb79a66e004e9fdb30f224447ab6179059a)`

```
…s_parse().

Added a helper uint16_t addition function with overflow detection. The function is used when calculating the extended length and option delta. The overlow detection is needed to avoid wrap-around of option number or length.
Additional checks in options using sn_coap_parser_options_parse_multiple_options() have been implemented to avoid overwriting of pointers pointing to previously allocated memory.

[CVE-2020-12887](https://github.com/advisories/GHSA-p665-3xc8-4hrv "CVE-2020-12887")
```

[![@mjurczak](https://avatars.githubusercontent.com/u/9540275?s=40&u=c8ed5071ca8020098fdd9c01e58b807398a7bbe2&v=4)](/mjurczak)
[mjurczak](/mjurczak)
mentioned this pull request
[Jun 10, 2020](#ref-issue-616186629)

[Memory leak in MbedOS CoAP library parser - sn\_coap\_parser\_options\_parse()
ARMmbed/mbed-os#12957](/ARMmbed/mbed-os/issues/12957)

Closed

 [![@esajaa](https://avatars.githubusercontent.com/u/26139870?s=40&v=4)](/esajaa)
[esajaa](/esajaa)
requested a review
from [anttiylitokola](/anttiylitokola)
[June 15, 2020 11:53](#event-3444025197)

[![@esajaa](https://avatars.githubusercontent.com/u/26139870?s=40&v=4)](/esajaa)

`[Formatting fixes](/PelionIoT/mbed-coap/pull/116/commits/91253bf3be7d928243ac8e804002153df035137c "Formatting fixes")`

`[91253bf](/PelionIoT/mbed-coap/pull/116/commits/91253bf3be7d928243ac8e804002153df035137c)`

[![@esajaa](https://avatars.githubusercontent.com/u/26139870?s=80&v=4)](/esajaa)

Copy link

Contributor

### **[esajaa](/esajaa)** commented [Jun 16, 2020](#issuecomment-644742448)

| Hi [@mjurczak](https://github.com/mjurczak),  I've been going through your pull request, and to me it seems like a good addition. I asked for a second opinion, but so far it's passing all the tests and nothing really seems out of place. I pushed some formatting fixes to the branch, hopefully that's okay to you.  I also noticed that you had few other branches in your fork. Is all the content here in this PR, or are there more pull requests incoming?  Best Regards, Esa |
| --- |

All reactions

Sorry, something went wrong.

[![@mjurczak](https://avatars.githubusercontent.com/u/9540275?s=80&u=c8ed5071ca8020098fdd9c01e58b807398a7bbe2&v=4)](/mjurczak)

Copy link

Contributor

Author

### **[mjurczak](/mjurczak)** commented [Jun 16, 2020](#issuecomment-644983503)

| Hi [@esajaa](https://github.com/esajaa) , Thanks for the formatting fixes. The content of the remaining branches in my fork is included in this single PR. I hope this is okay.  Kind regards, Maciej |
| --- |

All reactions

Sorry, something went wrong.

[![anttiylitokola](https://avatars.githubusercontent.com/u/13655184?s=60&v=4)](/anttiylitokola)

**[anttiylitokola](/anttiylitokola)**
approved these changes
[Jun 18, 2020](#pullrequestreview-432933217)

 [View reviewed changes](/PelionIoT/mbed-coap/pull/116/files/91253bf3be7d928243ac8e804002153df035137c)

`[Merge branch 'master' into bugfix/coap_parser_mem_access_bugs](/PelionIoT/mbed-coap/pull/116/commits/efbec0df4db5f5eafacd439c6af42ce11d286e21 "Merge branch 'master' into bugfix/coap_parser_mem_access_bugs")`

`[efbec0d](/PelionIoT/mbed-coap/pull/116/commits/efbec0df4db5f5eafacd439c6af42ce11d286e21)`

[![@esajaa](https://avatars.githubusercontent.com/u/26139870?s=40&v=4)](/esajaa)
[esajaa](/esajaa)
merged commit [`fd2a3ef`](/PelionIoT/mbed-coap/commit/fd2a3effd3dbd932ebfc390a501d65a7bd52d7cf)
into
PelionIoT:master

[Jun 22, 2020](https://github.com/PelionIoT/mbed-coap/pull/116#event-3466867759)

[![@kjbracey](https://avatars.githubusercontent.com/u/11025917?s=40&v=4)](/kjbracey)
[kjbracey](/kjbracey)
mentioned this pull request
[Jun 24, 2020](#ref-pullrequest-638824292)

[Optimise packet parser and builder core
#117](/PelionIoT/mbed-coap/pull/117)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FPelionIoT%2Fmbed-coap%2Fpull%2F116)

Reviewers

[![@anttiylitokola](https://avatars.githubusercontent.com/u/13655184?s=40&v=4)](/anttiylitokola) [anttiylitokola](/anttiylitokola)

anttiylitokola approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@mjurczak](https://avatars.githubusercontent.com/u/9540275?s=52&v=4)](/mjurczak) [![@esajaa](https://avatars.githubusercontent.com/u/26139870?s=52&v=4)](/esajaa) [![@anttiylitokola](https://avatars.githubusercontent.com/u/13655184?s=52&v=4)](/anttiylitokola)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


