```
{
  "cveId": "CVE-2020-12439",
  "related": true,
  "information": [
    {
      "type": "Technical Details",
      "content": "UTXOs (Unspent Transaction Outputs) are unique, but outputs may be reused. This means a UTXO can be spent and recreated with a different position in the output MMR (Merkle Mountain Range). Previously, this was not accounted for in some rewind scenarios. An incorrect position would be used, as the UTXO was assumed to be in the later position when rewound. This could force a node to see a transaction (or block) as invalid, when it would otherwise be correctly seen as valid by other nodes."
    },
    {
      "type": "Root cause",
      "content": "The vulnerability stemmed from incorrect handling of output positions in the `output_pos` index during blockchain rewinds. When a UTXO was spent and then recreated at a different position, the system would incorrectly assume the UTXO was at the later position when rewinding, instead of tracking the previous position."
    },
    {
      "type": "Weaknesses",
      "content": "The primary weakness was the lack of transactional updates to the `output_pos` index during blockchain rewinds. The system stored a bitmap of spent output positions per block, which was insufficient to accurately track changes to the index during rewinds, leading to \"false positives\"."
    },
    {
      "type": "Impact of exploitation",
      "content": "An attacker with a large graphrate could craft blocks that would force a node to rewind and apply the attacker's crafted blocks. This would cause the node to become out of consensus with the rest of the network and without a way to recover, by incorrectly marking valid transactions/blocks as invalid."
    },
    {
      "type": "Attack vectors",
        "content": "The attack vector was through the crafting of blocks that would trigger a rewind on vulnerable nodes. The attacker needed sufficient graphrate (mining power) to create blocks and force the rewind process."
    },
    {
      "type":"Required attacker capabilities/position",
      "content": "An attacker would need a large graphrate (mining power) to be able to craft blocks that could trigger the vulnerability on vulnerable nodes. No special access was required."
    },
     {
      "type": "Fix Details",
      "content": "The issue was fixed by correctly tracking the previous position of outputs, and ensuring the `output_pos` index is updated correctly during both block application and rewind. This was done by storing a vector of output positions with sort order consistent with the inputs to the block, rather than a bitmap. This change allows transactional updates to the `output_pos` index."
    }
  ]
}
```