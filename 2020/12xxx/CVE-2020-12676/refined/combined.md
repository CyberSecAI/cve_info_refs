=== Content from blog.intothesymmetry.com_2a931e23_20250119_140016.html ===

[Skip to main content](#main)

# [Into the symmetry](https://blog.intothesymmetry.com/)

Search

### Search This Blog

### Slack SAML authentication bypass

[October 26, 2017](https://blog.intothesymmetry.com/2017/10/slack-saml-authentication-bypass.html "permanent link")

tl;drÂ  I found a severe issue in the [Slack](https://slack.com/)'s [SAML](https://en.wikipedia.org/wiki/SAML_2.0) implementation that allowed me to bypass the authentication. This has now been solved by Slack.
# Introduction

IMHO the rule #1 of any bug hunter (note I do not consider myself one of them since I do this really sporadically) is to have a good RSS feed list.Â  In the course of the last years I built a pretty decent one and I try to follow other security experts trying to "steal" some useful tricks. There are many experts in different fields of the security panorama and too many to quote them here (maybe another post). But one of the leading expert (that I follow) on SAML is by far [Ioannis Kakavas](https://twitter.com/ilektrojohn). Indeed he was able in the last years to find serious vulnerability in the SAML implementation of [Microsoft](http://www.economyofmechanism.com/office365-authbypass.html) and [Github](http://www.economyofmechanism.com/github-saml). Usually I am more an ["OAuth guy"](https://www.manning.com/books/oauth-2-in-action) but since both, SAML and OAuth, are nothing else that grandchildren of [Kerberos](https://en.wikipedia.org/wiki/Kerberos_%28protocol%29) learning SAML has been in my todo list for long time. The Github incident gave me the final motivation to start learning it.
# Learning SAML

As said I was a kind of **SAML-idiot** until begin of 2017 but then I decided to learn it a little bit. Of course I started giving a look the the specification, but the best way I learn things is by doing and hopefully breaking. So I downloaded [this great Burp extension](https://github.com/SAMLRaider/SAMLRaider) called **SAML Raider** (great stuff, it saves so much time, you can edit any assertion on the fly).
Then I tried to look if any of the service that routinely I use are SAML compliant. It turns out that many of them are. To name some:

* [Github](https://github.com/) (but I guess [Ioannis](https://twitter.com/ilektrojohn) already took all the bugs there). So ping next (I actually found [this](http://blog.intothesymmetry.com/2017/05/cross-origin-brute-forcing-of-saml-and.html) funny JS Github bug giving a look into it, but not pertinent here)
* [Hackerone](https://www.hackerone.com/), I gave a try here but nada, nisba, niente, nicht, niet
* [Slack,](https://slack.com/) Bingo see next section (this is probably meant for Enterprise customers)

[![](https://get.slack.help/hc/article_attachments/115014834866/testmode.png)](https://get.slack.help/hc/article_attachments/115014834866/testmode.png)

# Slack SAML authentication bypass

As said many of the service I use in my routine are SAML aware so I started to poke a bit them. The vulnerability I found is part of the class known as "[*confused deputy problem*](http://en.wikipedia.org/wiki/Confused_deputy_problem)". I already talked about it in one of my [OAuth blog post](http://blog.intothesymmetry.com/2013/05/oauth-2-attacks-introducing-devil-wears.html) (tl;dr this is also why you never want to use OAuth implicit grant flow as authentication mechanism) and is really simple. Basically SAML assertions, between others contains an element called **Audience** and **AudienceRestriction**. Quoting [Ioannis](https://twitter.com/ilektrojohn):

> *The Assertion also contains an AudienceRestriction element that defines
> that this Assertion is targeted for a specific Service Provider and
> cannot be used for any other Service Provider.*

This means that if I present to a ServiceProvider A an assertion meant for ServiceProvider B, then the ServiceProvider A shoud reject it.
Well between all other things I tried this very really simple attack against a Slack's SAML endpoint /sso/saml and guess what? It worked :o !!
To be more concrete I used an old and **expired (**yes the assertion was also expired!!) Github's Assertion I had saved somewhere in my archive that was signed for a subject different than mine (namely the username was not asanso aka me) and I presented to Slack. Slack happily accepted it and I was logged in Slack channel with the username of this old and expired Assertion that was never meant to be a Slack one!!! Wow this is scary.... Well well this look bad enough so I stopped quite immediately and open a ticket on [Hackerone](http://hackerone.com/)....
# Disclosure timeline

...here the Slack security team was simply amazing... Thanks guys

**02-05-2017 -** Reported the issue via Hackerone.

**03-05-2017 -** Slack confirmed the issue.

**26-08-2017 -** Slack awarded a 3000$ bounty but still working with the affected customers in order to solve the vulnerability. Hence the ticket was kept open.

**26-10-2017 -** Slack closed the issue
# Acknowledgement

I would like to thank the Slack security team in particular Max Feldman you guys rock, really!!

Well that's all folks.  **For more SAML trickery [follow me on Twitter](https://twitter.com/asanso).**

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Labels

[bounty](https://blog.intothesymmetry.com/search/label/bounty)
[saml](https://blog.intothesymmetry.com/search/label/saml)

Labels:
[bounty](https://blog.intothesymmetry.com/search/label/bounty)
[saml](https://blog.intothesymmetry.com/search/label/saml)

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Comments

![](//www.blogger.com/img/blogger_logo_round_35.png)

[PanickedPacman](https://www.blogger.com/profile/04489194998201550244) saidâ€¦

Your Hackerone anchor tag is missing .com

[27 October 2017 at 10:10](https://blog.intothesymmetry.com/2017/10/slack-saml-authentication-bypass.html?showComment=1509124211045#c7811247350069840047 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=5832863639484084941&postID=7811247350069840047 "Delete Comment")

![](//www.blogger.com/img/blogger_logo_round_35.png)

[ll](https://www.blogger.com/profile/13409233330078201207) saidâ€¦

Fixed thanks!!

[28 October 2017 at 12:24](https://blog.intothesymmetry.com/2017/10/slack-saml-authentication-bypass.html?showComment=1509218653581#c1860572620309521668 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=5832863639484084941&postID=1860572620309521668 "Delete Comment")

![](//www.blogger.com/img/blogger_logo_round_35.png)

[davide](https://www.blogger.com/profile/12727560342876305194) saidâ€¦

Hi, would you share your RSS list? I'm always interested in reading good stuff ;-)
thanks in advance

[22 November 2017 at 04:39](https://blog.intothesymmetry.com/2017/10/slack-saml-authentication-bypass.html?showComment=1511354396742#c11373476006145623 "comment permalink")
[![](https://resources.blogblog.com/img/icon_delete13.gif)](https://www.blogger.com/delete-comment.g?blogID=5832863639484084941&postID=11373476006145623 "Delete Comment")

[Post a Comment](https://www.blogger.com/comment/fullpage/post/5832863639484084941/3566384980368454393)

### Popular posts from this blog

### [OpenSSL Key Recovery Attack on DH small subgroups (CVE-2016-0701)](https://blog.intothesymmetry.com/2016/01/openssl-key-recovery-attack-on-dh-small.html)

[January 28, 2016](https://blog.intothesymmetry.com/2016/01/openssl-key-recovery-attack-on-dh-small.html "permanent link")

Usual Mandatory Disclaimer: IANAC (I am not a cryptographer) so I might likely end up writing a bunch of mistakes in this blog post... tl;dr The OpenSSL 1.0.2 releases suffer from a Key Recovery Attack on DH small subgroups . This issue got assigned CVE-2016-0701 with a severity of High and OpenSSL 1.0.2 users should upgrade to 1.0.2f. If an application is using DH configured with parameters based on primes that are not "safe" or not Lim-Lee (as the one in RFC 5114 ) and either Static DH ciphersuites are used or DHE ciphersuites with the default OpenSSL configuration (in particular SSL\_OP\_SINGLE\_DH\_USE is not set) then is vulnerable to this attack.Â  It is believed that many popular applications (e.g. Apache mod\_ssl) do set theÂ  SSL\_OP\_SINGLE\_DH\_USE option and would therefore not be at risk (for DHE ciphersuites), they still might be for Static DH ciphersuites. Introduction So if you are still here it means you wanna know more. And here is the thing. In my last bl...

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[23 comments](https://www.blogger.com/comment/fullpage/post/5832863639484084941/2235833002254502540)

[Read more](https://blog.intothesymmetry.com/2016/01/openssl-key-recovery-attack-on-dh-small.html "OpenSSL Key Recovery Attack on DH small subgroups (CVE-2016-0701)")

### [Critical vulnerability in JSON Web Encryption (JWE) - RFC 7516](https://blog.intothesymmetry.com/2017/03/critical-vulnerability-in-json-web.html)

[March 13, 2017](https://blog.intothesymmetry.com/2017/03/critical-vulnerability-in-json-web.html "permanent link")

tl;dr if you are using go-jose , node-jose , jose2go , Nimbus JOSE+JWT or jose4j with ECDH-ES please update to the latest version. RFC 7516 aka JSON Web Encryption (JWE) hence many software libraries implementing this specification used to suffer from a classic Invalid Curve Attack . This would allow an attacker to completely recover the secret key of a party using JWE with Key Agreement with Elliptic Curve Diffie-Hellman Ephemeral Static (ECDH-ES) , where the sender could extract receiverâ€™s private key. Premise In this blog post I assume you are already knowledgeable about elliptic curves and their use in cryptography. If not Nick Sullivan 's A (Relatively Easy To Understand) Primer on Elliptic Curve Cryptography or Andrea Corbellini's series Elliptic Curve Cryptography: finite fields and discrete logarithms are great starting points. Then if you further want to climb the elliptic learning curve including the related attacks you might also want to visit https://s...

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[2 comments](https://www.blogger.com/comment/fullpage/post/5832863639484084941/2944417194682605697)

[Read more](https://blog.intothesymmetry.com/2017/03/critical-vulnerability-in-json-web.html "Critical vulnerability in JSON Web Encryption (JWE)  - RFC 7516 ")

### [The Curious Case of WebCrypto Diffie-Hellman on Firefox - Small Subgroups Key Recovery Attack on DH](https://blog.intothesymmetry.com/2020/01/the-curious-case-of-webcrypto-diffie.html)

[January 07, 2020](https://blog.intothesymmetry.com/2020/01/the-curious-case-of-webcrypto-diffie.html "permanent link")

tl;dr Mozilla Firefox prior to version 72 suffers from Small Subgroups Key Recovery Attack on DH in the WebCrypto 's API. The Firefox's team fixed the issue r emoving completely support for DH over finite fields (that is not in the WebCrypto standard). If you find this interesting read further below. Premise In this blog post I assume you are already knowledgeable about Diffie-Hellman over finite fields and related attacks. If not I recommend to read any cryptography book that covers public key cryptography. Here is a really cool simple explanation by David Wong : I found a cooler way to explain Diffie-Hellman :D pic.twitter.com/DlPvGwZbto â€” David Wong (@cryptodavidw) January 4, 2020 If you want more details about Small Subgroups Key Recovery Attack on DH I covered some background in one of my previous post ( OpenSSL Key Recovery Attack on DH small subgroups (CVE-2016-0701) ). There is also an academic pape r where we examine the issue with some more rigors. ...

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[2 comments](https://www.blogger.com/comment/fullpage/post/5832863639484084941/7432388175917295566)

[Read more](https://blog.intothesymmetry.com/2020/01/the-curious-case-of-webcrypto-diffie.html "The Curious Case of WebCrypto Diffie-Hellman on Firefox -   Small Subgroups Key Recovery Attack on DH")

### twitter

> Verifiable Delay Functions from Supersingular Isogenies and Pairings with [@luca\_defeo](https://twitter.com/luca_defeo?ref_src=twsrc%5Etfw) [@SimonMasson2](https://twitter.com/SimonMasson2?ref_src=twsrc%5Etfw) and Christophe Petit <https://t.co/Z9hMv4q4wK> [pic.twitter.com/Z3yR8FCZbb](https://t.co/Z3yR8FCZbb)
>
> â€” Antonio Sanso (@asanso) [February 21, 2019](https://twitter.com/asanso/status/1098592424992092167?ref_src=twsrc%5Etfw)

### Books from me

[![Books from me](https://images.manning.com/255/340/resize/book/e/14336f9-6493-46dc-938c-11a34c9d20ac/Richer-OAuth2-HI.png)](https://www.manning.com/books/oauth-2-in-action)

OAuth 2 in Action

### Archive

* [January 20201](https://blog.intothesymmetry.com/2020/01/)
* [August 20191](https://blog.intothesymmetry.com/2019/08/)
* [July 20192](https://blog.intothesymmetry.com/2019/07/)
* [May 20191](https://blog.intothesymmetry.com/2019/05/)
* [December 20182](https://blog.intothesymmetry.com/2018/12/)
* [July 20181](https://blog.intothesymmetry.com/2018/07/)
* [April 20181](https://blog.intothesymmetry.com/2018/04/)
* [February 20181](https://blog.intothesymmetry.com/2018/02/)
* [January 20182](https://blog.intothesymmetry.com/2018/01/)
* [December 20171](https://blog.intothesymmetry.com/2017/12/)

* [October 20172](https://blog.intothesymmetry.com/2017/10/)
* [August 20172](https://blog.intothesymmetry.com/2017/08/)
* [June 20171](https://blog.intothesymmetry.com/2017/06/)
* [May 20172](https://blog.intothesymmetry.com/2017/05/)
* [April 20172](https://blog.intothesymmetry.com/2017/04/)
* [March 20171](https://blog.intothesymmetry.com/2017/03/)
* [November 20161](https://blog.intothesymmetry.com/2016/11/)
* [October 20161](https://blog.intothesymmetry.com/2016/10/)
* [June 20161](https://blog.intothesymmetry.com/2016/06/)
* [May 20161](https://blog.intothesymmetry.com/2016/05/)
* [April 20161](https://blog.intothesymmetry.com/2016/04/)
* [January 20162](https://blog.intothesymmetry.com/2016/01/)
* [December 20153](https://blog.intothesymmetry.com/2015/12/)
* [October 20151](https://blog.intothesymmetry.com/2015/10/)
* [September 20152](https://blog.intothesymmetry.com/2015/09/)
* [August 20151](https://blog.intothesymmetry.com/2015/08/)
* [June 20151](https://blog.intothesymmetry.com/2015/06/)
* [May 20151](https://blog.intothesymmetry.com/2015/05/)
* [April 20151](https://blog.intothesymmetry.com/2015/04/)
* [March 20151](https://blog.intothesymmetry.com/2015/03/)
* [January 20151](https://blog.intothesymmetry.com/2015/01/)
* [December 20141](https://blog.intothesymmetry.com/2014/12/)
* [October 20141](https://blog.intothesymmetry.com/2014/10/)
* [September 20142](https://blog.intothesymmetry.com/2014/09/)
* [August 20141](https://blog.intothesymmetry.com/2014/08/)
* [April 20142](https://blog.intothesymmetry.com/2014/04/)
* [February 20141](https://blog.intothesymmetry.com/2014/02/)
* [May 20132](https://blog.intothesymmetry.com/2013/05/)
* [October 20121](https://blog.intothesymmetry.com/2012/10/)
* [August 20121](https://blog.intothesymmetry.com/2012/08/)
* [June 20122](https://blog.intothesymmetry.com/2012/06/)
* [January 20121](https://blog.intothesymmetry.com/2012/01/)
* [January 20111](https://blog.intothesymmetry.com/2011/01/)
* [August 20101](https://blog.intothesymmetry.com/2010/08/)
* [June 20101](https://blog.intothesymmetry.com/2010/06/)
* [May 20102](https://blog.intothesymmetry.com/2010/05/)
* [March 20102](https://blog.intothesymmetry.com/2010/03/)
* [February 20101](https://blog.intothesymmetry.com/2010/02/)

Show more
Show less

### Labels

* [AS vulnerability](https://blog.intothesymmetry.com/search/label/AS%20vulnerability)
* [bounty](https://blog.intothesymmetry.com/search/label/bounty)
* [browser-security](https://blog.intothesymmetry.com/search/label/browser-security)
* [client vulnerability](https://blog.intothesymmetry.com/search/label/client%20vulnerability)
* [crypto](https://blog.intothesymmetry.com/search/label/crypto)
* [csrf](https://blog.intothesymmetry.com/search/label/csrf)
* [dh](https://blog.intothesymmetry.com/search/label/dh)
* [ecc](https://blog.intothesymmetry.com/search/label/ecc)
* [isogeny](https://blog.intothesymmetry.com/search/label/isogeny)
* [ita](https://blog.intothesymmetry.com/search/label/ita)

* [jwe](https://blog.intothesymmetry.com/search/label/jwe)
* [jwt](https://blog.intothesymmetry.com/search/label/jwt)
* [kubernetes](https://blog.intothesymmetry.com/search/label/kubernetes)
* [MS DRBG](https://blog.intothesymmetry.com/search/label/MS%20DRBG)
* [oauth](https://blog.intothesymmetry.com/search/label/oauth)
* [oltu](https://blog.intothesymmetry.com/search/label/oltu)
* [openssl](https://blog.intothesymmetry.com/search/label/openssl)
* [pre-oauth](https://blog.intothesymmetry.com/search/label/pre-oauth)
* [saml](https://blog.intothesymmetry.com/search/label/saml)
* [tls](https://blog.intothesymmetry.com/search/label/tls)
* [vdf](https://blog.intothesymmetry.com/search/label/vdf)
* [vulnerability](https://blog.intothesymmetry.com/search/label/vulnerability)

Show more
Show less

[Powered by Blogger](https://www.blogger.com)



=== Content from compass-security.com_fc15b1ec_20250119_140015.html ===
#############################################################
#
# COMPASS SECURITY ADVISORY
# https://www.compass-security.com/research/advisories/
#
#############################################################
#
# Product: SAML v2.0 bindings in Java using JAXB
# Vendor: FusionAuth
# CSNC ID: CSNC-2020-002
# CVE ID: CVE-2020-12676
# Subject: Signature Exclusion Attack
# Risk: High
# Effect: Remotely exploitable
# Author: Felix Sieges
# Date: 2020-09-30
#
#############################################################
Introduction:
-------------
FusionAuth [1] provides authentication, authorization, and user management for any app.
SAML v2.0 bindings in Java using JAXB are a library used to integrate SAML
Authentication with Java Applications. Compass Security [2] identified a vulnerability
that allows remote attackers to forge messages and bypass authentication via a SAML
assertion that lacks a Signature element, aka a "Signature exclusion attack".
Affected:
---------
Vulnerable:
fusionauth-samlv2 0.2.3
Not vulnerable:
fusionauth-samlv2 0.2.4
Not tested:
No other version was tested, but it is believed for the older versions to be
vulnerable as well.
Technical Description
---------------------
Unauthenticated users can send forged messages to the FusionAuth to bypass
Authentication, impersonate other users or gain arbitrary roles. The SAML
Message can be send to the Application without a signature even if this is
required. The impact depends on individual applications that
implement fusionauth-samlv2.
The code which is responsible to verify the signature is called from the parseResponse
function [3]. The function checks whether a signature must be verified and if so
the function verifySignature is called to do signature verification checks.
https://github.com/FusionAuth/fusionauth-
```
public AuthenticationResponse parseResponse(String encodedResponse, boolean verifySignature, PublicKey key)
throws SAMLException {
AuthenticationResponse response = new AuthenticationResponse();
byte[] decodedResponse = Base64.getMimeDecoder().decode(encodedResponse);
response.rawResponse = new String(decodedResponse, StandardCharsets.UTF\_8);
Document document = parseFromBytes(decodedResponse);
if (verifySignature) {
verifySignature(document, key);
}
```
In the function verifySignature [4] the SAML message is parsed after validation that a
signature is attached to the message. If no signatures exist the function just returns.
Hence the parseReponse method assumes that the signature is valid and the SAML message
will be processed further.
```
private void verifySignature(Document document, Key key) throws SAMLException {
// Fix the IDs in the entire document per the suggestions at http://stackoverflow.com/questions/17331187/xml-dig-sig-error-after-upgrade-to-java7u25
fixIDs(document.getDocumentElement());
NodeList nl = document.getElementsByTagNameNS(XMLSignature.XMLNS, "Signature");
if (nl.getLength() == 0) {
return;
}
for (int i = 0; i < nl.getLength(); i++) {
DOMValidateContext validateContext = new DOMValidateContext(key, nl.item(i));
XMLSignatureFactory factory = XMLSignatureFactory.getInstance("DOM");
try {
XMLSignature signature = factory.unmarshalXMLSignature(validateContext);
boolean valid = signature.validate(validateContext);
if (!valid) {
throw new SAMLException("Invalid SAML v2.0 authentication response. The signature is invalid.");
}
} catch (MarshalException e) {
throw new SAMLException("Unable to verify XML signature in the SAML v2.0 authentication response because we couldn't unmarshall the XML Signature element", e);
} catch (XMLSignatureException e) {
throw new SAMLException("Unable to verify XML signature in the SAML v2.0 authentication response. The signature was unmarshalled we couldn't validate it for an unknown reason", e);
}
}
}
}
```
Workaround / Fix:
-----------------
Upgrade to fusionauth-samlv2 0.2.4, where the signature checks are performed correctly
#TODO
Timeline:
---------
2020-04-29: Discovery by Felix Sieges
2020-05-06: Assigned CVE-2020-12676
2020-05-06: Initial vendor notification
2020-05-06: Initial vendor response
2020-12-05: Release of fixed Version
2020-09-30: Coordinated public disclosure date
References:
-----------
[1] https://fusionauth.io/
[2] https://compass-security.com
[3] https://github.com/FusionAuth/fusionauth-samlv2/blob/master/src/main/java/io/fusionauth/samlv2/service/DefaultSAMLv2Service.java#L502
[4] https://github.com/FusionAuth/fusionauth-samlv2/blob/dbcf3ccabbc89f43ca322c1526a6a3589e3a1f1f/src/main/java/io/fusionauth/samlv2/service/DefaultSAMLv2Service.java#L820


=== Content from nmap.org_9ba698e9_20250119_140017.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

[Get Nmap 7.95 here](/download)
## News

* Nmap.org has been redesigned! Our new mobile-friendly layout is also on [Npcap.com](https://npcap.com),
  [Seclists.org](https://seclists.org),
  [Insecure.org](https://insecure.org), and
  [Sectools.org](https://sectools.org).* Nmap 7.90 has been released with Npcap 1.00 along with dozens of other performance improvements, bug fixes, and feature enhancements! [[Release Announcement](https://seclists.org/nmap-announce/2020/1) | [Download page](https://nmap.org/download.html)]* After more than 7 years of development and 170 public pre-releases, we're delighted to announce Npcap version 1.00! [[Release Announcement](https://seclists.org/nmap-announce/2020/0) | [Download page](https://nmap.org/npcap/)]* Nmap 7.80 was released for DEFCON 27! [[release notes](https://seclists.org/nmap-announce/2019/0) | [download](https://nmap.org/download.html)]* Nmap turned 20 years old on September 1, 2017! Celebrate by reading [the original Phrack #51 article](/p51-11.html). [#Nmap20](https://twitter.com/hashtag/Nmap20)!* Nmap 7.50 is now available! [[release notes](https://seclists.org/nmap-announce/2017/3) | [download](https://nmap.org/download.html)]* Nmap 7 is now available! [[release notes](/7/) | [download](https://nmap.org/download.html)]* We're pleased to release our new and Improved [Icons of the Web](/favicon/) projectâ€”a 5-gigapixel interactive collage of the top million sites on the Internet!* Nmap has been discovered in two new movies! It's used to [hack Matt Damon's brain in Elysium](movies/#elysium) and also to [launch nuclear missiles in G.I. Joe: Retaliation](movies/#gijoe)!* We're delighted to announce Nmap 6.40 with 14 new [NSE scripts](/book/nse.html), hundreds of new [OS](/book/osdetect.html) and [version detection](/book/vscan.html) signatures, and many great new features! [[Announcement/Details](https://seclists.org/nmap-announce/2013/1)], [[Download Site](https://nmap.org/download.html)]* We just released Nmap 6.25 with 85 new NSE scripts, performance improvements, better OS/version detection, and more! [[Announcement/Details](https://seclists.org/nmap-hackers/2012/4)], [[Download Site](https://nmap.org/download.html)]* Any release as big as Nmap 6 is bound to uncover a few bugs. We've now fixed them with [Nmap 6.01](https://seclists.org/nmap-hackers/2012/3)!* Nmap 6 is now available! [[release notes](/6/) | [download](https://nmap.org/download.html)]* The security community has spoken! 3,000 of you shared favorite security tools for our relaunched [SecTools.Org](https://sectools.org). It is sort of like Yelp for security tools. Are you familiar with all of the [49 new tools](https://sectools.org/tag/new/) in this edition?* [Nmap 5.50 Released](https://seclists.org/nmap-hackers/2011/0): Now with Gopher protocol support! Our first stable release in a year includes 177 NSE scripts, 2,982 OS fingerprints, and 7,319 version detection signatures. Release focuses were the Nmap Scripting Engine, performance, Zenmap GUI, and the Nping packet analysis tool. [[Download page](https://nmap.org/download) | [Release notes](https://seclists.org/nmap-hackers/2011/0)]* Those who missed Defcon can now watch Fyodor and David Fifield demonstrate the power of the Nmap Scripting Engine. They give an overview of NSE, use it to explore Microsoft's global network, write an NSE script from scratch, and hack a webcam--all in 38 minutes! ([Presentation video](/presentations/BHDC10/))* *Icons of the Web*: explore favicons for the top million web sites with our [new poster and online viewer](/favicon).* We're delighted to announce the immediate, free availability of the [Nmap Security Scanner version 5.00](/5/). Don't miss the [top 5 improvements in Nmap 5](/5/#5changes).* After years of effort, we are delighted to release [Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning](/book/)!* We now have an active Nmap [Facebook page](http://facebook.com/nmap) and [Twitter feed](http://twitter.com/nmap/) to augment the [mailing lists](#lists). All of these options offer RSS feeds as well.

# Nmap: Discover your network

Nmap ("Network Mapper") is a
[free and open source](/npsl/) utility for
network discovery and security auditing. Many systems and network
administrators also find it useful for tasks such as network
inventory, managing service upgrade schedules, and monitoring host or
service uptime. Nmap uses raw IP packets in novel ways to determine
what hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other characteristics. It
was designed to rapidly scan large networks, but works fine against
single hosts. Nmap runs on all major computer operating systems, and
official binary packages are available for Linux, Windows, and Mac OS
X. In addition to the classic command-line Nmap executable, the Nmap
suite includes an advanced GUI and results viewer
([Zenmap](/zenmap/)), a flexible data
transfer, redirection, and debugging tool
([Ncat](/ncat/)), a utility for
comparing scan results ([Ndiff](/ndiff/)), and a packet generation and response analysis tool ([Nping](/nping/)).

Nmap was named â€œSecurity Product of the Yearâ€ by Linux
Journal, Info World, LinuxQuestions.Org, and Codetalker Digest. It
was even featured in [twelve
movies](/movies/), including
[The Matrix Reloaded](/movies/#matrix),
[Die Hard 4](/movies/#diehard4),
[Girl With the Dragon Tattoo](/movies/#gwtdt),
and
[The Bourne Ultimatum](/movies/#bourne).

Nmap is ...

* Nmap
  Security
  Port Scanner
* **Flexible**: Supports dozens of advanced techniques for
  mapping out networks filled with IP filters, firewalls, routers, and
  other obstacles. This includes many [port scanning](/book/man-port-scanning-techniques.html) mechanisms (both TCP &
  UDP), [OS
  detection](/book/osdetect.html), [version detection](/book/vscan.html), ping sweeps, and more. See the [documentation page](/docs.html).* **Powerful**: Nmap has been used to scan huge networks of
    literally hundreds of thousands of machines.* **Portable**: Most operating systems are supported, including
      Linux,
      Microsoft Windows,
      FreeBSD,
      OpenBSD,
      Solaris,
      IRIX,
      Mac OS X,
      HP-UX,
      NetBSD,
      Sun OS,
      Amiga,
      and more.* **Easy**: While Nmap offers a rich set of advanced features for
        power users, you can start out as simply as "nmapÂ -vÂ -AÂ *targethost*". Both traditional command line and graphical (GUI)
        versions are available to suit your preference. Binaries are
        available for those who do not wish to compile Nmap from source.* **Free**: The primary goals of the Nmap Project is to help make
          the Internet a little more secure and to provide
          administrators/auditors/hackers with an advanced tool for exploring
          their networks. Nmap is available for [free download](https://nmap.org/download.html), and also comes with full
          source code that you may modify and redistribute under the terms of
          the [license](data/COPYING).* **Well Documented**: Significant effort has been put into
            comprehensive and up-to-date man pages, whitepapers, tutorials, and
            even a whole book! Find them in multiple
            languages [here](/docs.html).* **Supported**: While Nmap comes with no warranty, it is well supported by a vibrant community of developers and users. Most of this interaction occurs on the [Nmap mailing lists](#lists). Most bug reports and questions should be sent to the [nmap-dev list](https://seclists.org/nmap-dev), but only after you read the [guidelines](/book/man-bugs.html). We recommend that all users subscribe to the low-traffic [nmap-hackers](https://seclists.org/nmap-hackers) announcement list. You can also find Nmap on [Facebook](http://facebook.com/nmap) and [Twitter](http://twitter.com/nmap). For real-time chat, join the #nmap channel on [Freenode](http://freenode.net/) or [EFNet](http://www.efnet.org/).* **Acclaimed**: Nmap has won numerous awards, including
                "Information Security Product of the Year" by Linux Journal, Info
                World and Codetalker Digest. It has been featured in hundreds of
                magazine articles, several movies, dozens of books, and one comic book
                series. Visit the [press page](nmap_inthenews.html)
                for further details.* **Popular**: Thousands of people download Nmap every day, and
                  it is included with many operating systems (Redhat Linux, Debian
                  Linux, Gentoo, FreeBSD, OpenBSD, etc). It is among the top ten (out of
                  30,000) programs at the Freshmeat.Net repository. This is important
                  because it lends Nmap its vibrant development and user support
                  communities.

## Communication

Nmap users are encouraged to subscribe to the *Nmap-hackers*
mailing list. It is a low volume (6 posts in 2017), moderated list
for the most important announcements about Nmap, Insecure.org, and
related projects. You can join more than 128,000 current subscribers
by submitting your email address here:

(or subscribe with custom options from the [Nmap-hackers list info page](https://nmap.org/mailman/listinfo/announce))

We also have a development list for more hardcore members
(especially programmers) who are interested in helping the project by
helping with coding, testing, feature ideas, etc. New (test/beta)
versions of Nmap are sometimes released here prior to general
availability for QA purposes. You can subscribe at the [Nmap-dev list
info page](https://nmap.org/mailman/listinfo/dev).

Both lists are archived (along with many other security lists) at [Seclists.org](https://seclists.org).

Though it isn't nearly as active as the mailing lists, the official IRC channel is #nmap on [Freenode](http://freenode.net/) (irc.freenode.net).

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from github.com_2332fe32_20250119_122132.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCompassSecurity%2FSAMLRaider)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCompassSecurity%2FSAMLRaider)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=CompassSecurity%2FSAMLRaider)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[CompassSecurity](/CompassSecurity)
/
**[SAMLRaider](/CompassSecurity/SAMLRaider)**
Public

* [Notifications](/login?return_to=%2FCompassSecurity%2FSAMLRaider) You must be signed in to change notification settings
* [Fork
  76](/login?return_to=%2FCompassSecurity%2FSAMLRaider)
* [Star
   415](/login?return_to=%2FCompassSecurity%2FSAMLRaider)

SAML2 Burp Extension

### License

[MIT license](/CompassSecurity/SAMLRaider/blob/master/LICENSE)

[415
stars](/CompassSecurity/SAMLRaider/stargazers) [76
forks](/CompassSecurity/SAMLRaider/forks) [Branches](/CompassSecurity/SAMLRaider/branches) [Tags](/CompassSecurity/SAMLRaider/tags) [Activity](/CompassSecurity/SAMLRaider/activity)
 [Star](/login?return_to=%2FCompassSecurity%2FSAMLRaider)

 [Notifications](/login?return_to=%2FCompassSecurity%2FSAMLRaider) You must be signed in to change notification settings

* [Code](/CompassSecurity/SAMLRaider)
* [Issues
  12](/CompassSecurity/SAMLRaider/issues)
* [Pull requests
  1](/CompassSecurity/SAMLRaider/pulls)
* [Actions](/CompassSecurity/SAMLRaider/actions)
* [Projects
  0](/CompassSecurity/SAMLRaider/projects)
* [Wiki](/CompassSecurity/SAMLRaider/wiki)
* [Security](/CompassSecurity/SAMLRaider/security)
* [Insights](/CompassSecurity/SAMLRaider/pulse)

Additional navigation options

* [Code](/CompassSecurity/SAMLRaider)
* [Issues](/CompassSecurity/SAMLRaider/issues)
* [Pull requests](/CompassSecurity/SAMLRaider/pulls)
* [Actions](/CompassSecurity/SAMLRaider/actions)
* [Projects](/CompassSecurity/SAMLRaider/projects)
* [Wiki](/CompassSecurity/SAMLRaider/wiki)
* [Security](/CompassSecurity/SAMLRaider/security)
* [Insights](/CompassSecurity/SAMLRaider/pulse)

# CompassSecurity/SAMLRaider

   Â master[Branches](/CompassSecurity/SAMLRaider/branches)[Tags](/CompassSecurity/SAMLRaider/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commitÂ History[215 Commits](/CompassSecurity/SAMLRaider/commits/master/) | | |
| [doc](/CompassSecurity/SAMLRaider/tree/master/doc "doc") | | [doc](/CompassSecurity/SAMLRaider/tree/master/doc "doc") |  |  |
| [gradle](/CompassSecurity/SAMLRaider/tree/master/gradle "gradle") | | [gradle](/CompassSecurity/SAMLRaider/tree/master/gradle "gradle") |  |  |
| [scripts](/CompassSecurity/SAMLRaider/tree/master/scripts "scripts") | | [scripts](/CompassSecurity/SAMLRaider/tree/master/scripts "scripts") |  |  |
| [src](/CompassSecurity/SAMLRaider/tree/master/src "src") | | [src](/CompassSecurity/SAMLRaider/tree/master/src "src") |  |  |
| [.gitattributes](/CompassSecurity/SAMLRaider/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/CompassSecurity/SAMLRaider/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/CompassSecurity/SAMLRaider/blob/master/.gitignore ".gitignore") | | [.gitignore](/CompassSecurity/SAMLRaider/blob/master/.gitignore ".gitignore") |  |  |
| [BappDescription.html](/CompassSecurity/SAMLRaider/blob/master/BappDescription.html "BappDescription.html") | | [BappDescription.html](/CompassSecurity/SAMLRaider/blob/master/BappDescription.html "BappDescription.html") |  |  |
| [BappManifest.bmf](/CompassSecurity/SAMLRaider/blob/master/BappManifest.bmf "BappManifest.bmf") | | [BappManifest.bmf](/CompassSecurity/SAMLRaider/blob/master/BappManifest.bmf "BappManifest.bmf") |  |  |
| [LICENSE](/CompassSecurity/SAMLRaider/blob/master/LICENSE "LICENSE") | | [LICENSE](/CompassSecurity/SAMLRaider/blob/master/LICENSE "LICENSE") |  |  |
| [README.md](/CompassSecurity/SAMLRaider/blob/master/README.md "README.md") | | [README.md](/CompassSecurity/SAMLRaider/blob/master/README.md "README.md") |  |  |
| [build.gradle](/CompassSecurity/SAMLRaider/blob/master/build.gradle "build.gradle") | | [build.gradle](/CompassSecurity/SAMLRaider/blob/master/build.gradle "build.gradle") |  |  |
| [gradlew](/CompassSecurity/SAMLRaider/blob/master/gradlew "gradlew") | | [gradlew](/CompassSecurity/SAMLRaider/blob/master/gradlew "gradlew") |  |  |
| [gradlew.bat](/CompassSecurity/SAMLRaider/blob/master/gradlew.bat "gradlew.bat") | | [gradlew.bat](/CompassSecurity/SAMLRaider/blob/master/gradlew.bat "gradlew.bat") |  |  |
| [settings.gradle](/CompassSecurity/SAMLRaider/blob/master/settings.gradle "settings.gradle") | | [settings.gradle](/CompassSecurity/SAMLRaider/blob/master/settings.gradle "settings.gradle") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# SAML Raider - SAML2 Burp Extension

## Description

SAML Raider is a Burp Suite extension for testing SAML infrastructures. It
contains two core functionalities: Manipulating SAML Messages and manage X.509
certificates.

This software was originally created by Roland Bischofberger and [Emanuel
Duss](https://github.com/emanuelduss) (@emanuelduss) during a bachelor thesis at
the [Hochschule fÃ¼r Technik Rapperswil](https://www.hsr.ch) (HSR).

## Features

The extension is divided in two parts. A SAML message editor and a certificate
management tool.

### Message Editor

Features of the SAML Raider message editor:

* Sign SAML messages & assertions (signature spoofing attack)
* Remove signatures (signature exclusion attack)
* Edit SAML messages (SAMLRequest, SAMLResponse & custom parameter names)
* Perform eight common XSW attacks
* Insert XXE and XSLT attack payloads
* Supported Profiles: SAML Webbrowser Single Sign-on Profile, Web Services
  Security SAML Token Profile
* Supported Bindings: POST Binding, Redirect Binding, SOAP Binding, URI Binding

SAML Attacks:

[![SAML Attacks](/CompassSecurity/SAMLRaider/raw/master/doc/saml_attacks.png)](/CompassSecurity/SAMLRaider/blob/master/doc/saml_attacks.png)

SAML Message Info:

[![SAML Message Info](/CompassSecurity/SAMLRaider/raw/master/doc/saml_info.png)](/CompassSecurity/SAMLRaider/blob/master/doc/saml_info.png)

### Certificate Management

Features of the SAML Raider Certificate Management:

* Import X.509 certificates (PEM and DER format)
* Import X.509 certificate chains
* Export X.509 certificates (PEM format)
* Delete imported X.509 certificates
* Display informations of X.509 certificates
* Import private keys (PKCD#8 in DER format and traditional RSA in PEM Format)
* Export private keys (traditional RSA Key PEM Format)
* Cloning X.509 certificates
* Cloning X.509 certificate chains
* Create new X.509 certificates
* Editing and self-sign existing X.509 certificates

Certificate Management:

[![Certificate Management](/CompassSecurity/SAMLRaider/raw/master/doc/certificates.png)](/CompassSecurity/SAMLRaider/blob/master/doc/certificates.png)

## Demo

SAML Signature Spoofing Demo:

[![SAML Signature Spoofing Demo](/CompassSecurity/SAMLRaider/raw/master/doc/saml_signature_spoofing_demo.gif)](/CompassSecurity/SAMLRaider/blob/master/doc/saml_signature_spoofing_demo.gif)

FusionAuth XXE Demo (CVE-2021-27736):

[![FusionAuth XXE Demo](/CompassSecurity/SAMLRaider/raw/master/doc/saml_fusionauth_xxe.gif)](/CompassSecurity/SAMLRaider/blob/master/doc/saml_fusionauth_xxe.gif)

## Installation

### Installation from BApp Store

The recommended and easiest way to install SAML Raider is using the BApp Store.
Open Burp and click in the `Extensions` tab on the `BApp Store` tab. Select `SAML Raider` and hit the `Install` button to install our extension.

Don't forget to rate our extension with as many stars you like ðŸ˜„.

### Manual Installation

First, download the latest SAML Raider version:
[saml-raider-2.1.0.jar](https://github.com/SAMLRaider/SAMLRaider/releases/download/v2.1.0/saml-raider-2.1.0.jar).
Then, start Burp Suite and click in the `Extensions` tab on `Add`. Choose the
SAML Raider JAR file to install it and you are ready to go.

## Usage Hints

To test SAML environments more comfortable, you could add a intercept rule in
the proxy settings. Add a new rule which checks if a Parameter Name
`SAMLResponse` is in the request. We hope the usage of our extension is mostly
self explaining ðŸ˜„. If you have questions, don't hesitate to ask us!

If you have a custom parameter name for a SAML message, this can be configured
in the SAML Raider Certificates tab.

If you don't want to let SAML Raider parse your SAML message before sending to
the server (e.g. when performing XXE attacks), use the raw mode.

## Development

See [hacking](/CompassSecurity/SAMLRaider/blob/master/doc/hacking.md).

## Feedback, Bugs and Feature Requests

Feedback is welcome! Please contact us or create a new issue on GitHub.

## License

See the [LICENSE](/CompassSecurity/SAMLRaider/blob/master/LICENSE) file (MIT License) for license rights and
limitations.

## References

SAML Raider is on the Internet :).

### Bachelor Thesis

* Our bachelor thesis where SAML Raider was born:
  [eprints\_BA\_SAML2\_Burp\_Plugin\_SAML\_Raider\_eduss\_rbischof.pdf](https://eprints.hsr.ch/464/1/eprints_BA_SAML2_Burp_Plugin_SAML_Raider_eduss_rbischof.pdf).

### General

* PortSwigger Burp BApp Store: <https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e>
* SAML Raider in our Company Blog @CompassSecurity: <https://blog.compass-security.com/tag/saml-raider/>
* Schwachstellen in SAML 2.0 Implementationen: <https://www.syssec.at/en/veranstaltungen/archiv/dachsecurity2016/papers/DACH_Security_2016_Paper_12A1.pdf>

### SAML Hacking Tutorials

* Awesome SAML Security Testing Blog Posts by @epi052:
  + SAML Testing Methodology Basics: <https://epi052.gitlab.io/notes-to-self/blog/2019-03-07-how-to-test-saml-a-methodology/>
  + SAML Testing Methodology using SAML Raider: <https://epi052.gitlab.io/notes-to-self/blog/2019-03-13-how-to-test-saml-a-methodology-part-two/>
* Hack SAML Single Sign-on with Burp Suite: <https://null-byte.wonderhowto.com/how-to/hack-saml-single-sign-with-burp-suite-0184405/>
* Attacking SSO: Common SAML Vulnerabilities and Ways to Find Them: <https://blog.netspi.com/attacking-sso-common-saml-vulnerabilities-ways-find/>
* How to use Burp Suite to verify SAML Signature Wrapping attack: <https://blog.ritvn.com/testing/2018/02/16/burp-suite-saml-signature-wrapping-attack.html>
* Vulnerabilities Related to SAML: <https://varutra.com/blog/?p=1945b>
* Owning SAML: <https://www.anitian.com/owning-saml/>

### Discovered Vulnerabilities using SAML Raider

* CVE-2015-5372: nevisAuth Authentication Bypass (Signature Spoofing)
  + Blog Post: <https://blog.compass-security.com/2015/09/saml-sp-authentication-bypass-vulnerability-in-nevisauth/>
  + Advisory: <https://www.compass-security.com/fileadmin/Datein/Research/Advisories/CVE-2015-5372_AdNovum_nevisAuth_Authentication_Bypass.txt>
* Slack SAML Authentication Bypass:
  + Blog Post: <https://blog.intothesymmetry.com/2017/10/slack-saml-authentication-bypass.html>
* CVE-2020-12676: FusionAuth Signature Exclusion Attack
  + Advisory: <https://compass-security.com/fileadmin/Research/Advisories/2020-06_CSNC-2020-002_FusionAuth_Signature_Exclusion_Attack.txt>
* CVE-2021-27736: FusionAuth SAML Library
  + Advisory: <https://www.compass-security.com/fileadmin/Research/Advisories/2021-03_CSNC-2021-004_FusionAuth_SAML_Library_XML_External_Entity.txt>

### Other

* SANS Burp Suite Cheat Sheet recommends SAML Raider: <https://www.sans.org/security-resources/posters/pen-testing/burp-suite-cheat-sheet-280?msc=Cheat+Sheet+Blog>

## Authors

* Roland Bischofberger (GitHub: [RouLee](https://github.com/RouLee))
* Emanuel Duss (GitHub: [emanuelduss](https://github.com/emanuelduss))
* Tobias Hort-Giess (GitHub: [t-hg](https://github.com/t-hg))

## About

SAML2 Burp Extension

### Topics

[saml](/topics/saml "Topic: saml")
[burp](/topics/burp "Topic: burp")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/CompassSecurity/SAMLRaider/activity)
[Custom properties](/CompassSecurity/SAMLRaider/custom-properties)
### Stars

[**415**
stars](/CompassSecurity/SAMLRaider/stargazers)
### Watchers

[**22**
watching](/CompassSecurity/SAMLRaider/watchers)
### Forks

[**76**
forks](/CompassSecurity/SAMLRaider/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FCompassSecurity%2FSAMLRaider&report=CompassSecurity+%28user%29)

## [Releases 20](/CompassSecurity/SAMLRaider/releases)

[Release v2.1.0
Latest

Jan 2, 2025](/CompassSecurity/SAMLRaider/releases/tag/v2.1.0)
[+ 19 releases](/CompassSecurity/SAMLRaider/releases)

## [Packages 0](/orgs/CompassSecurity/packages?repo_name=SAMLRaider)

No packages published

## [Contributors 14](/CompassSecurity/SAMLRaider/graphs/contributors)

## Languages

* [Java
  98.9%](/CompassSecurity/SAMLRaider/search?l=java)
* Other
  1.1%

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from seclists.org_af425a8e_20250119_122131.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](0)
[By Date](date.html#1)
[![Next](/images/right-icon-16x16.png)](2)

[![Previous](/images/left-icon-16x16.png)](0)
[By Thread](index.html#1)
[![Next](/images/right-icon-16x16.png)](2)

![](/shared/images/nst-icons.svg#search)

# CVE-2020-12676 - FusionAuth SAML v2.0 bindings in Java using JAXB - Signature Exclusion Attack

---

*From*: Advisories <advisories () compass-security com>

*Date*: Wed, 30 Sep 2020 12:02:07 +0000

---

```
#############################################################
#
# COMPASS SECURITY ADVISORY
# <https://www.compass-security.com/research/advisories/>
#
#############################################################
#
# Product:  SAML v2.0 bindings in Java using JAXB
# Vendor:   FusionAuth
# CSNC ID:  CSNC-2020-002
# CVE ID:   CVE-2020-12676
# Subject:  Signature Exclusion Attack
# Risk:     High
# Effect:   Remotely exploitable
# Author:   Felix Sieges <felix.sieges () compass-security com>
# Date:     2020-09-30
#
#############################################################

Introduction:
-------------
FusionAuth [1] provides authentication, authorization, and user management for any app.
SAML v2.0 bindings in Java using JAXB are a library used to integrate SAML
Authentication with Java Applications. Compass Security [2] identified a vulnerability
that allows remote attackers to forge messages and bypass authentication via a SAML
assertion that lacks a Signature element, aka a "Signature exclusion attack".

Affected:
---------
Vulnerable:
fusionauth-samlv2 0.2.3

Not vulnerable:
fusionauth-samlv2 0.2.4

Not tested:
No other version was tested, but it is believed for the older versions to be
vulnerable as well.

Technical Description
---------------------
Unauthenticated users can send forged messages to the FusionAuth to bypass
Authentication, impersonate other users or gain arbitrary roles. The SAML
Message can be send to the Application without a signature even if this is
required. The impact depends on individual applications that
implement fusionauth-samlv2.

The code which is responsible to verify the signature is called from the parseResponse
function [3]. The function checks whether a signature must be verified and if so
the function verifySignature is called to do signature verification checks.

<https://github.com/FusionAuth/fusionauth->

```
  public AuthenticationResponse parseResponse(String encodedResponse, boolean verifySignature, PublicKey key)
      throws SAMLException {

    AuthenticationResponse response = new AuthenticationResponse();
    byte[] decodedResponse = Base64.getMimeDecoder().decode(encodedResponse);
    response.rawResponse = new String(decodedResponse, StandardCharsets.UTF_8);

    Document document = parseFromBytes(decodedResponse);
    if (verifySignature) {
      verifySignature(document, key);
    }
```

In the function verifySignature [4] the SAML message is parsed after validation that a
signature is attached to the message. If no signatures exist the function just returns.
Hence the parseReponse method assumes that the signature is valid and the SAML message
will be processed further.

```
  private void verifySignature(Document document, Key key) throws SAMLException {
    // Fix the IDs in the entire document per the suggestions at
<http://stackoverflow.com/questions/17331187/xml-dig-sig-error-after-upgrade-to-java7u25>
    fixIDs(document.getDocumentElement());

    NodeList nl = document.getElementsByTagNameNS(XMLSignature.XMLNS, "Signature");
    if (nl.getLength() == 0) {
      return;
    }

    for (int i = 0; i < nl.getLength(); i++) {
      DOMValidateContext validateContext = new DOMValidateContext(key, nl.item(i));
      XMLSignatureFactory factory = XMLSignatureFactory.getInstance("DOM");
      try {
        XMLSignature signature = factory.unmarshalXMLSignature(validateContext);
        boolean valid = signature.validate(validateContext);
        if (!valid) {
          throw new SAMLException("Invalid SAML v2.0 authentication response. The signature is invalid.");
        }
      } catch (MarshalException e) {
        throw new SAMLException("Unable to verify XML signature in the SAML v2.0 authentication response because we
couldn't unmarshall the XML Signature element", e);
      } catch (XMLSignatureException e) {
        throw new SAMLException("Unable to verify XML signature in the SAML v2.0 authentication response. The signature
was unmarshalled we couldn't validate it for an unknown reason", e);
      }
    }
  }
}
```

Workaround / Fix:
-----------------
Upgrade to fusionauth-samlv2 0.2.4, where the signature checks are performed correctly

#TODO
Timeline:
---------
2020-04-29:     Discovery by Felix Sieges
2020-05-06:     Assigned CVE-2020-12676
2020-05-06:     Initial vendor notification
2020-05-06:     Initial vendor response
2020-12-05:     Release of fixed Version
2020-09-30:     Coordinated public disclosure date

References:
-----------
[1] <https://fusionauth.io/>
[2] <https://compass-security.com>
[3]
<https://github.com/FusionAuth/fusionauth-samlv2/blob/master/src/main/java/io/fusionauth/samlv2/service/DefaultSAMLv2Service.java#L502>
[4]
<https://github.com/FusionAuth/fusionauth-samlv2/blob/dbcf3ccabbc89f43ca322c1526a6a3589e3a1f1f/src/main/java/io/fusionauth/samlv2/service/DefaultSAMLv2Service.java#L820>

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](0)
[By Date](date.html#1)
[![Next](/images/right-icon-16x16.png)](2)

[![Previous](/images/left-icon-16x16.png)](0)
[By Thread](index.html#1)
[![Next](/images/right-icon-16x16.png)](2)

### Current thread:

* **CVE-2020-12676 - FusionAuth SAML v2.0 bindings in Java using JAXB - Signature Exclusion Attack** *Advisories (Oct 02)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.nds.ruhr-uni-bochum.de_0b070795_20250119_122134.html ===
On Breaking SAML: Be Whoever You Want to Be

Juraj Somorovsky1, Andreas Mayer2, JÂ¨org Schwenk1, Marco Kampmann1, and Meiko Jensen1

1Horst GÂ¨ortz Institute for IT-Security, Ruhr-University Bochum, Germany
2Adolf WÂ¨urth GmbH & Co. KG, KÂ¨unzelsau-Gaisbach, Germany
{Juraj.Somorovsky, Joerg.Schwenk, Marco.Kampmann, Meiko.Jensen}@rub.de,
Andreas.Mayer@wuerth.com

Abstract

The Security Assertion Markup Language (SAML) is a
widely adopted language for making security statements
about subjects. It is a critical component for the develop-
ment of federated identity deployments and Single Sign-
On scenarios. In order to protect integrity and authentic-
ity of the exchanged SAML assertions, the XML Signa-
ture standard is applied. However, the signature veriï¬ca-
tion algorithm is much more complex than in traditional
signature formats like PKCS#7. The integrity protection
can thus be successfully circumvented by application of
different XML Signature speciï¬c attacks, under a weak
adversarial model.

In this paper we describe an in-depth analysis of 14
major SAML frameworks and show that 11 of them,
including Salesforce, Shibboleth, and IBM XS40, have
critical XML Signature wrapping (XSW) vulnerabilities.
Based on our analysis, we developed an automated pen-
etration testing tool for XSW in SAML frameworks. Its
feasibility was proven by additional discovery of a new
XSW variant. We propose the ï¬rst framework to an-
alyze such attacks, which is based on the information
ï¬‚ow between two components of the Relying Party. Sur-
prisingly, this analysis also yields efï¬cient and practical
countermeasures.

1

Introduction

The Security Assertion Markup Language (SAML) is an
XML based language designed for making security state-
ments about subjects. SAML assertions are used as se-
curity tokens in WS-Security, and in REST based Single
Sign-On (SSO) scenarios. SAML is supported by major
software vendors and open source projects, and is widely
deployed. Due to its ï¬‚exibility and broad support, new
application scenarios are deï¬ned constantly.

SAML ASSERTIONS. Since SAML assertions con-
tain security critical claims about a subject, the validity
of these claims must be certiï¬ed. According to the stan-

dard, this shall be achieved by using XML Signatures,
which should either cover the complete SAML assertion,
or an XML document containing it (e.g. a SAML Au-
thentication response).

However, roughly 80% of the SAML frameworks that
we evaluated could be broken by circumventing integrity
protection with novel XML Signature wrapping (XSW)
attacks. This surprising result is mainly due to two facts:

â€¢ Complex Signing Algorithm: Previous digital sig-
nature data formats like PKCS#7 and OpenPGP
compute a single hash of the whole document, and
signatures are simply appended to the document.
The XML Signature standard is much more com-
plex. Especially, the position of the signature and
the signed content is variable. Therefore, many per-
mutations of the same XML document exist.

â€¢ Unspeciï¬ed internal

interface: Most SAML
frameworks treat the Relying Party (i.e.
the Web
Service or website consuming SAML assertions) as
a single block, assuming a joint common state for
all tasks. However, logically this block must be sub-
divided into the signature veriï¬cation module (later
called RPsig) which performs a cryptographic opera-
tion, and the SAML processing module (later called
RPclaims) which processes the claims contained in
the SAML assertion. Both modules have different
views on the assertion, and they typically only ex-
change a Boolean value about the validity of the sig-
nature.

CONTRIBUTION.

In this paper, we present an in-
depth analysis of 14 SAML frameworks and systems.
During this analysis, we found critical XSW vulnerabili-
ties in 11 of these frameworks. This result is alarming
given the importance of SAML in practice, especially
since SSO frameworks may become a single point of at-
tack.
It clearly indicates that the security implications
behind SAML and XML Signature are not understood
yet.

Second, these vulnerabilities are exploitable by an at-
tacker with far fewer resources than the classical network
based attacker from cryptography: Our adversary may
succeed even if he does not control the network. He does
not need realtime eavesdropping capabilities, but can
work with SAML assertions whose lifetime has expired.
A single signed SAML assertion is sufï¬cient to com-
pletely compromise a SAML issuer/Identity Provider.
Using SSL/TLS to encrypt SAML assertions, and thus to
prevent adversaries from learning assertions by intercept-
ing network trafï¬c, does not help either: The adversary
may e.g. register as a regular customer at the SAML is-
suer, and may use his own assertion to impersonate other
customers.

Third, we give the ï¬rst model for SAML frameworks
that takes into account the interface between RPsig and
RPclaims. This model gives a clear deï¬nition of successful
attacks on SAML. Besides its theoretical interest, it also
enables us to prove several positive results. These results
are new and help to explain why some of the frameworks
were not vulnerable to our attacks, and to give advice on
how to improve the security of the other 11 frameworks.

Last, we show that XSW vulnerabilities constitute an
important and broad class of attack vectors. There is no
easy defense against XSW attacks: Contrary to common
belief, even signing the whole document does not neces-
sarily protect against them. To set up working defenses,
a better understanding of this versatile attack class is re-
quired. A specialized XSW pentesting tool developed
during our research will be released as open source to aid
this understanding. Its practicability was proven by dis-
covering a new attack vector on Salesforce SAML inter-
face despite the fact that speciï¬c countermeasures have
been applied.

RESPONSIBLE DISCLOSURE. All vulnerabilities
found during our analysis were reported to the respon-
sible security teams. Accordingly, in many cases, we
closely collaborated with them in order to patch the
found issues.

OUTLINE. The rest of the paper is organized as fol-
lows. Section 2 gives a highlevel overview on SAML,
and Section 3 adds details. The methodology of the in-
vestigation is explained in Section 4, and the detailed re-
sults are described in Section 5. In Section 6 we present
the ï¬rst fully automated XSW penetration test tool for
SAML. Section 7 gives a formal analysis and derives two
countermeasures. In Section 8 we discuss their practi-
cal feasibility. Section 9 presents an overview on related
work. In the last section we conclude and propose future
research directions.

Figure 1: A typical Single Sign-On scenario: The user
visits the RP, which generates a request token. He redi-
rects this token to the IdP. The issued token is sent to the
user and forwarded to the RP. Even though the channel
is secured by SSL/TLS, the user still can see the token.

2 Motivation

In this section we introduce two typical SAML scenarios
and some widely used SAML frameworks.

SAML-BASED SINGLE SIGN-ON. Typical Internet
users have to manage many identities for different web
applications. To overcome this problem, Single Sign-On
was developed. In this approach the users authenticate
only once to a trustworthy Identity Provider (IdP). After
a successful login of a user, the IdP issues security to-
kens on demand. These tokens are used to authenticate
to Relying Parties (RP).

A simpliï¬ed Single Sign-On scenario is depicted in
Figure 1. In this setting, a user logged-in by the IdP ï¬rst
visits the desired RP (1). The RP issues a token request
(2). This token is sent to the user (3) who forwards it
to the IdP (4). The IdP issues a token response for the
user including several claims (e.g. his access rights or
expiration time). In order to protect the authenticity and
integrity of the claims, the token is signed (5). Subse-
quently, the token is sent to the user (6), who forwards it
to the RP (7). The RP validates the signature and after-
wards grants access to the protected service or resource,
if the user is authorized (8). This access control decision
is based on the claims in the validated token.

SECURING WEB SERVICES WITH SAML. Another
typical application scenario is the use of SAML together
with WS-Security [29] in SOAP [21] to provide authen-
tication and authorization mechanisms to Web Services.
SAML assertions are included as security tokens in the
Security header.

SAML PROVIDERS AND FRAMEWORKS.

The
evaluation presented in this paper was made through-
out the last 18 months and includes prominent and well-
used SAML frameworks, which are summarized in Ta-
ble 1. Our analysis included the IBM hardware appliance

ClientRelying Party(RP)Identity Provider (IdP)45SAML ResponseTokenIssuing andSigningToken Redirect6Token Response7Token Redirect8Signature    validationToken  evaluationUser   authorization[SSL/TLS]3Token Request1LoginRequest[SSL/TLS]2SAML RequestTokenIssuingFramework/Provider
Apache Axis 2
Guanxi
Higgins 1.x
IBM XS40
JOSSO
WIF
OIOSAML
OpenAM
OneLogin
OpenAthens
OpenSAML
Salesforce
SimpleSAMLphp
WSO2

Language
Java
Java
Java
XSLT
Java
.NET
Java, .NET
Java
Java, PHP, Ruby, Python
Java, C++
Java, C++

Type
WS
Web SSO
Web SSO
WS
Web SSO
Web SSO
Web SSO
Web SSO
Web SSO
Web SSO
Web SSO
Web SSO â€”
Web SSO
Web SSO

PHP
Java

Reference
http://axis.apache.org
http://guanxi.sourceforge.net
www.eclipse.org/higgins
www.ibm.com
www.josso.org
http://msdn.microsoft.com
http://www.oiosaml.info
http://forgerock.com/openam.html
www.onelogin.com
www.openathens.net
http://opensaml.org
www.salesforce.com
http://simplesamlphp.org
www.wso2.com

Application1
WSO2 Web Services
Sakai Project (www.sakaiproject.org)
Identity project
Enterprise XML Security Gateway
Motorola, NEC, Redhat 2
Microsoft Sharepoint 2010
Danish eGovernment (e.g. www.virk.dk)
Enterprise-Class Open Source SSO
Joomla, Wordpress, SugarCRM, Drupal
UK Federation (www.eduserv.org.uk)
Shibboleth, SuisseID
Cloud Computing and CRM
Danish e-ID Federation (www.wayf.dk)
WSO2 products (Carbon, ESB, . . . )

Table 1: Analyzed SAML frameworks and providers: The columns give information about type (Web Service or
Browser-based SSO), programming language (if known), website, and application in concrete products or frameworks.

XS40, which is applied as an XML Security Gateway.
Other examples of closed source frameworks are the
Windows Identity Foundation (WIF) used in Microsoft
Sharepoint and the Salesforce cloud platform. Important
open source frameworks include OpenSAML, OpenAM,
OIOSAML, OneLogin, and Apache Axis 2. OpenSAML
is for example used in Shibboleth and the SDK of the
electronic identity card from Switzerland (SuisseID).
OpenAM, formerly known as SUN OpenSSO, is an iden-
tity and access management middleware, used in major
enterprises. The OIOSAML framework is e.g. used in
Danish public sector federations (e.g. eGovernment busi-
ness and citizen portals). The OneLogin Toolkits can be
used to integrate SAML into various popular open source
web applications like Wordpress, Joomla, Drupal, and
SugarCRM. Moreover, these Toolkits are used by many
OneLogin customers (e.g. Zendesk, SAManage, Knowl-
edgeTree, and Yammer) to enable SAML-based SSO.
Apache Axis2 is the standard framework for generating
and deploying Web Service applications.

3 Technical Foundations

In this section we brieï¬‚y introduce the SAML standard
and XML Signature wrapping attacks. Additionally, for
readers unfamiliar with the relevant W3C standards, we
present XML Signature [14] and XML Schema [36].

3.1 XML Signature

The XML Signature standard [14] deï¬nes the syntax and
processing rules for creating, representing, and verifying
It is possible to sign a
XML-based digital signatures.
whole XML tree or only speciï¬c elements. One XML
Signature can cover several local or global resources.
A signature placed within the signed content is called
If the signature surrounds the
an enveloped signature.

1In some of the listed applications and frameworks SAML-based

SSO is optional and has to be explicitly activated.

2Stated on JOSSOâ€™s website.

<Signature ID?>
<SignedInfo>

<CanonicalizationMethod/>
<SignatureMethod/>
(<Reference URI? >
(<Transforms>)?
<DigestMethod>
<DigestValue>

</Reference>)+

</SignedInfo>
<SignatureValue>
(<KeyInfo>)?
(<Object ID?>)*

</Signature>

Figure 2: XML Signature data structure (â€?â€: zero or one
occurrence; â€+â€: one or more occurrences; â€*â€: zero or
more occurrences).

signed parts, it is an enveloping signature. A detached
signature is neither inside nor a parent of the signed data.

An XML Signature is represented by the Signature
element. Figure 2 provides its basic structure. XML
Signatures are two-pass signatures:
the hash value of
the resource (DigestValue) along with the used hash
algorithm (DigestMethod) and the URI reference to
the resource are stored in a Reference element. Ad-
ditionally, the Transforms element speciï¬es the pro-
cessing steps which are applied prior to digesting of
the resource. Each signed resource is represented by
in the SignedInfo element.
a Reference element
Therefore, SignedInfo is a collection of hash val-
ues and URIs. The SignedInfo itself is protected
by the signature. The CanonicalizationMethod and
the SignatureMethod element specify the algorithms
used for canonicalization and signature creation, and are
also embedded in SignedInfo. The Base64-encoded
value of the computed signature is deposited in the
SignatureValue element. In addition, the KeyInfo el-
ement facilitates the transport of signature relevant key
management information. The Object is an optional el-
ement that may contain any data.

<saml:Assertion Version ID IssueInstant>

<saml:Issuer>
<ds:Signature>?
<saml:Subject>?
<saml:Conditions>?
<saml:Advice>?
<saml:AuthnStatement>*
<saml:AuthzDecisionStatement>*
<saml:AttributeStatement>*

</saml:Assertion>

Figure 3: SAML assertion structure.

3.2 XML Schema

The W3C recommendation XML Schema [36] is a lan-
guage to describe the layout, semantics, and content of
an XML document. A document is deemed to be valid,
when it conforms to a speciï¬c schema. A schema con-
sists of a content model, a vocabulary, and the used data
types. The content model describes the document struc-
ture and the relationship of the items. The standard pro-
vides 19 primitive data types to deï¬ne the allowed con-
tent of the elements and attributes.

Regarding to our evaluation of SAML based XML
Signature Wrapping attacks there is one important el-
ement deï¬nition in XML Schema. The any element
allows the usage of any well-formed XML document
in a declared content type. When an XML processor
validates an element deï¬ned by an any element, the
processContents attribute speciï¬es the level of ï¬‚ex-
ibility. The value lax instructs the schema validator to
check against the given namespace. If no schema infor-
mation is available, the content is considered valid. In the
case of processContents="skip" the XML processor
does not validate the element at all.

3.3 SAML

SAML is an XML standard for exchanging authentica-
tion and authorization statements about Subjects [11].
Several proï¬les are deï¬ned in [10]. The most important
proï¬le is the Browser SSO proï¬le, which deï¬nes how to
use SAML with a web browser.

A SAML assertion has the structure described in Fig-
ure 3. The issuing time of the assertion is speciï¬ed in
saml:IssueInstant. All attributes are required.

The saml:Issuer element speciï¬es the SAML au-
thority (the IdP) that is making the claim(s) in the asser-
tion. The assertionâ€™s saml:Subject deï¬nes the princi-
pal about whom all statements within the assertion are
made. The saml:*Statement elements are used to
specify user-deï¬ned statements relevant for the context
of the SAML assertion.

To protect the integrity of the security claims made
by the Issuer, the whole saml:Assertion element must
be protected with a digital signature following the XML

Figure 4: SAML message examples (SOAP and REST):
The SAML assertion is put into a root element R and
signed using an enveloped signature. When signing the
SOAP body, an additional detached signature is used.

Signature standard. Therefore,
the SAML speciï¬ca-
tion [11] requires that either the saml:Assertion ele-
ment or an ancestor element must be referenced by the
Signature element, with an enveloped XML Signature
([11], Section 5.4.1). Furthermore, Id-based referencing
must be used ([11], Section 5.4.2), which opens the way
for XSW attacks.

In REST based frameworks, the SAML assertion is
typically put into an enveloping Response element.
Frameworks applying SOAP insert the SAML assertions
into the SOAP header (or the Security element in-
side of the SOAP header). For clariï¬cation purposes,
consider that the SAML assertions are signed using en-
veloped XML Signatures and are put into some binding
root element R (see Figure 4).

3.4 XML Signature Wrapping Attacks

XML documents containing XML Signatures are typi-
cally processed in two independent steps: signature val-
idation and function invocation (business logic). If both
modules have different views on the data, a new class of
vulnerabilities named XML Signature Wrapping attacks
(XSW) [27, 23] exists.
In these attacks the adversary
modiï¬es the message structure by injecting forged ele-
ments which do not invalidate the XML Signature. The
goal of this alteration is to change the message in such
a way that the application logic and the signature veriï¬-
cation module use different parts of the message. Con-
sequently, the receiver veriï¬es the XML Signature suc-
cessfully but the application logic processes the bogus
element. The attacker thus circumvents the integrity pro-
tection and the origin authentication of the XML Signa-
ture and can inject arbitrary content. Figure 5 shows a
simple XSW attack on a SOAP message.

XSW attacks resemble other classes of injection at-
tacks like XSS or SQLi: in all cases, the attacker tries to
force different views on the data in security modules (e.g.
Web Application Firewalls) and data processing modules
(HTML parser, SQL engine).

SignedProcessedEnvelopeAssertionHeaderID=â€œ123â€œSignatureSignedInfoReferenceURI=â€œ#123â€œResponseAssertionSignatureSignedInfoReferenceURI=â€œ#123â€œID=â€œ123â€œBodyBinding root element RFigure 5: A simple XML Signature wrapping attack: The
attacker moves the original signed content to a newly cre-
ated Wrapper element. Afterwards, he creates an arbi-
trary content with a different Id, which is invoked by the
business logic.

4 XSW Attacks on SAML

In this section we ï¬rst characterize the assumed threat
model. Second, we describe the basic attack principle
that underlies our analysis of the 14 frameworks.3

4.1 Threat Model

As a prerequisite the attacker requires an arbitrary signed
SAML message. This could be a single assertion A or a
whole document D with an embedded assertion, and its
lifetime can be expired. After obtaining such a message,
the attacker modiï¬es it by injecting evil content, e.g. an
evil assertion EA. In our model we assume two differ-
ent types of adversaries, which are both weaker than the
classical network based attacker:

1. Advacc. To obtain an assertion, this attacker regis-
ters as a user of an Identity Provider IdP. Advacc
then receives, through normal interaction with IdP,
a valid signed SAML assertion A (probably as a
part of a larger document D) making claims about
Advacc. The attacker now adds additional claims EA
about any other subject S, and submits the modiï¬ed
document D(cid:48) (A(cid:48)) to RP.

2. Advintc. This adversary retrieves SAML assertions
from the Internet, but he does not have the abil-
ity to read encrypted network trafï¬c. This can
be done either by accessing transmitted data di-
rectly from unprotected networks (snifï¬ng), or in
an â€ofï¬‚ineâ€ manner by analyzing proxy or browser
caches. Since SAML assertions should be worthless
once their lifetime expired, they may even be posted

3Please note that from now on we distinguish between the document
D and the root element R. This is to make clear the distinction between
the element referenced by the XML signature, and the document root:
Even if the root element R of the original document D is signed, we
may transform this into a new document D(cid:48) with a new evil root ER,
without invalidating the signature.

Figure 6: Types of signature applications on SAML as-
sertions on the left. The new malicious content needed
to execute the attacks depicted on the right, accordingly.

in technical discussion boards, where Advintcmay
access them.

4.2 Basic Attack Principle

As described in the previous section, XML Signatures
can be applied to SAML assertions in different ways and
placed in different elements. The only prerequisite is that
the Assertion element or the protocol binding element
(ancestor of Assertion) is signed using an enveloped
signature with Id-based referencing. In this section we
analyze the usage of SAML assertions in different frame-
works and the possibilities of inserting malicious con-
tent. Generally, SAML assertions and their signatures
are implemented as depicted in Figure 6:

1. The ï¬rst possible usage of signatures in SAML as-
sertions is to insert the XML Signature S1 as a
child of the SAML assertion A1 and sign only the
Assertion element A1. This type can be used in-
dependently of the underlying protocol (SOAP or
REST).

2. The second type of signature application in SAML
signs the whole protocol binding element R. The
XML Signature can be placed into the SAML asser-
tion A1 or directly into the protocol binding root ele-
ment R. This kind of signature application is used in
different SAML HTTP bindings, where the whole
Response element is signed.

3. It is also possible to use more than one XML Sig-
nature. The third example shows this kind of signa-
ture application: the inner signature S1 protects the
SAML assertion and the outer signature S addition-
ally secures the whole protocol message. This kind
of signature application is e.g. used by the Simple-
SAMLphp framework.

In order to apply XSW attacks to SAML assertions,
the basic attack idea stays the same: The attacker has

SignedProcessedEnvelopeWrapperHeaderID=â€œ123â€œSignatureSignedInfoReferenceURI=â€œ#123â€œBodyBodyCreateKeyPairMonitorInstancesID=â€œattackâ€œA1S1EAA1S1REREAA1SRS1EREALegitimate contentInjected evil contentSignedProcessedSigning Type 1)Signing Type 2)Signing Type 3)to create new malicious elements and force the assertion
logic to process them, whereas the signature veriï¬cation
logic veriï¬es the integrity and authenticity of the original
content. In applications of the ï¬rst signature type, the
attacker only has to create a new evil assertion EA. In the
second and third signing types, he also has to create the
whole evil root ER element including the evil assertion.

4.3 Attack Permutations

The attacker has many different possibilities where to in-
sert the malicious and the original content. To this end,
he has to deal with these questions:

â€¢ At which level in the XML message tree should the
malicious content and the original signed data be
included?

â€¢ Which Assertion element is processed by the as-

sertion logic?

â€¢ Which element is used for signature veriï¬cation?

By answering these questions we can deï¬ne different
attack patterns, where the original and the malicious el-
ements can be permuted (Figure 7). We thus get a com-
plete list of attack vectors, which served as a guideline
for our investigations.

For the following explanations we only consider sign-
ing type 1) deï¬ned in Figure 6. In this signing type only
the Assertion element is referenced.

The attack permutations are depicted in Figure 7. In
addition, we analyze their SAML standard conformance
and the signature validity:

1. Malicious assertion, original assertion, and signa-
ture are left on the same message level: This kind of
XML message can have six permutations. None of
them is SAML standard compliant, since the XML
Signature does not sign its parent element. The di-
gest value over the signed elements in all the mes-
sages can be correctly validated. We can use this
type of attack messages if the server does not check
the SAML conformance.

2. All the three elements are inserted at different mes-
sage levels, as child elements of each other, which
again results in six permutations: Messages 2-a and
2-b show examples of SAML standard conform-
ing and cryptographically valid messages. In both
cases the signature element references its parent â€“
the original assertion A1. Message 2-c illustrates a
message which is not SAML standard conform as
the signature signs its child element. Nevertheless,
the message is cryptographically valid. Lastly, mes-
sage 2-d shows an example of an invalid message
since the signature would be veriï¬ed over both as-
sertions. Generally, if the signature is inserted as the

Figure 7: Possible variants for XSW attacks applied on
messages with one signed SAML assertion divided ac-
cording to the insertion depth of the evil assertion EA,
the original assertion A1 and the signature S1. The var-
ious permutations are labeled according to their validity
and SAML-conformance.

child of the root element, the message would also be
either invalid or not SAML standard compliant.
3. For the insertion of these three elements we use two
message levels: Message 3-a shows an example of
a valid and SAML compliant document. By con-
structing message 3-b, the signature element was
moved to the new malicious assertion. Since it ref-
erences the original element, it is still valid, but does
not conform to the SAML standard.

The analysis shown above can similarly be applied to

messages with different signing types (see Figure 6).

5 Practical Evaluation

We evaluated the above deï¬ned attacks on real-world
systems and frameworks introduced in Section 2. In this
section we present the results.

5.1 Signature Exclusion Attacks

We start the presentation of our results with the simplest
attack type called Signature exclusion attack. This at-
tack relies on poor implementation of a serverâ€™s security
logic, which checks the signature validity only if the sig-
nature is included. If the security logic does not ï¬nd the
Signature element, it simply skips the validation step.

A1S1EARA1S1EARA1S1EAR2) Three Levels (6 Permutations)3) Two Levels (12 Permutations)A1S1EARA1S1EARA1S1EARA1S1EAR1) One Level (6 Permutations)SignedProcessedSignature Invalidnot SAML-conforma)b)c)d)a)b)EAS1A1REAS1A1Rc)EAS1A1Rd)SAML-conformFigure 8: XML tree-based illustration of reï¬ned XSW attacks found in Type 1 signature applications.

The evaluation showed that three SAML-based frame-
works were vulnerable to these attacks: Apache Axis2
Web Services Framework, JOSSO, and the Java-based
implementation of SAML 2.0 in Eduserv (other versions
of SAML and the C-implementation in Eduserv were not
affected).

By applying this attack on JOSSO and Eduserv the at-
tacker had to remove the Signature element from the
message, since if it was found, the framework tried to
validate it. On the other hand, the Apache Axis2 frame-
work did not validate the Signature element over the
SAML assertion at all, even if it was included in the mes-
sage. Apache Axis2 validated only the signature over the
SOAP body and the Timestamp element. The signature
protecting the SAML assertion, which is included sep-
arately in the Assertion element, was completely ig-
nored.

5.2 Reï¬ned Signature Wrapping

Ten out of 14 systems were prone to reï¬ned XSW at-
tacks.

Classiï¬ed on the three different signature application
types given in Figure 6, ï¬ve SAML-based systems failed
in validating Type 1 messages, where only the asser-
tion is protected by an XML Signature. Figure 8 depicts
the XML tree-based illustration of the found XSW vari-
ants. Starting from left to right, Higgins, Apache Axis2,
and the IBM XS 40 Security Gateway were outfoxed
by the two depicted permutations.
In the ï¬rst variant
it was sufï¬cient to inject an evil assertion with a dif-
ferent Id attribute in front of the original assertion. As
the SAML standard allows to have multiple assertions in
one protocol element, the XML Schema validation still
succeeded. The second attack type embedded the orig-
inal assertion as a child element into the evil assertion
EA. In both cases the XML Signature was still standard
conform, as enveloped signatures were applied. This
was broken in the case of OIOSAML by using detached
signatures. In this variant the original Signature ele-
ment was moved into the EA, which was inserted be-
fore the legitimate assertion. The last shown permuta-
tion was applicable to the cloud services of Salesforce

Figure 9: XML tree-based illustration of reï¬ned XSW
attacks found in Type 2 signature applications.

and the OpenAM framework. At this, the genuine asser-
tion was placed into the original Signature element. As
both implementations apply XML Schema for validating
the schema conformance of a SAML message, this was
done by injecting them into the Object element, which
allows arbitrary content. Again, this is not compliant
to the SAML standard because this mutation transforms
the enveloped to an enveloping signature. Finally, the
OneLogin Toolkits were prone to all shown attack vari-
ants as they did not apply XML Schema, validated the
XML Signature independent of itâ€™s semantic occurrence
and used a ï¬xed reference to the processed SAML claims
(/samlp:Response/saml:Assertion[1]).

We found three susceptible implementations, which
applied Type 2 messages, where the whole message is
protected by an XML Signature. We depict the attacks
on these implementations in Figure 9.
In the Guanxi
and JOSSO implementations the legitimate root element
was inserted into the Object element in the original
Signature. The Signature node was moved into the
ER element which also included the new evil assertion.
In the case of WSO2, it was sufï¬cient to place the orig-
inal root element into the ER object. Naturally, some-
one would expect that enforcing full document signing
would eliminate XSW completely. The both given ex-
amples demonstrate that this does not hold in practice.
Again, this highlights the vigilance required when im-
plementing complex standards such as SAML.

Finally, we did not ï¬nd vulnerable frameworks that
applied Type 3 messages, where both the root and the as-

RootAssertionID=â€œevilâ€œAssertionID=â€œ123â€œSignatureSignedInfoReferenceURI=â€œ#123â€œRootAssertionID=â€œevilâ€œAssertionID=â€œ123â€œSignatureSignedInfoReferenceURI=â€œ#123â€œRootAssertionID=â€œevilâ€œAssertionID=â€œ123â€œSignatureSignedInfoReferenceURI=â€œ#123â€œSignedProcessedRootAssertionID=â€œevilâ€œAssertionID=â€œ123â€œSignatureSignedInfoReferenceURI=â€œ#123â€œOIOSAMLHiggins, Apache Axis2, IBM XS 40 Security GatewayOpenAM, SalesforceRootAssertionRootID=â€œ123â€œSignatureSignedInfoReferenceURI=â€œ#123â€œID=â€œevilâ€œAssertionRootAssertionRootID=â€œ123â€œSignatureSignedInfoReferenceURI=â€œ#123â€œID=â€œevilâ€œAssertionGuanxi, JOSSOWSO2sertion are protected by different signatures. Indeed, one
legitimate reason is, that most SAML implementations
do not use Type 3 messages. In our practical evaluation,
only SimpleSAMLphp applied them by default. Never-
theless, this does not mean that XSW is not applicable to
this message type in practice.

5.3 OpenSAML Vulnerability

The attack vectors described above did not work against
the prevalently deployed OpenSAML library. The reason
was that OpenSAML compared the Id used by the signa-
ture validation with the Id of the processed assertion. If
these identiï¬ers were different (based on a string compar-
ison), the signature validation failed. Additionally, XML
messages including more than one element with the same
Id were also rejected. Both mechanisms are handled in
OpenSAML by using the Apache Xerces library and its
XML Schema validation method [34]. Nevertheless, it
was possible to overcome these countermeasures with a
more sophisticated XSW attack.

As mentioned before,

in OpenSAML the Apache
Xerces library performs a schema validation of every in-
coming XML message. Therefore, the Id of each el-
ement can be deï¬ned by using the appropriate XML
Schema ï¬le. This allows the Xerces library to iden-
tify all included Ids and to reject messages with Id
values which are not unique (e.g. duplicated). How-
ever, a bug in this library caused that XML elements
deï¬ned with xsd:any content were not processed cor-
rectly. More concretely, the content of the elements
deï¬ned as <xsd:any processContents="lax"> were
not checked using the deï¬ned XML Schema. Therefore,
it was possible to insert elements with arbitrary â€“ also
duplicated â€“ Ids inside an XML message. This created a
good position for our wrapped content.

It is still the question which of the extensible elements
could be used for the execution of our attacks. This de-
pends on two processing properties:

1. Which element is used for assertion processing?
2. Which element is validated by the security module,

if there are two elements with the same Id?

Interestingly,
the two existing implementations of
Apache Xerces (Java and C++) handled element deref-
erencing differently.

For C++, the attacker had to ensure that the original
signed assertion was copied before the evil assertion. In
the Java case, the legitimate assertion had to be placed
within or after the evil assertion.
In summary, if two
elements with the same Id values occurred in an XML
message, the XML security library detected only the ï¬rst
(for C++) or the last (for Java) element in the message.
This property gave the attacker an opportunity to use

Figure 10: XSW attack on OpenSAML library.

<element name="Extensions" type="samlp:ExtensionsType"/>
<complexType name="ExtensionsType">

<sequence>

<any namespace="##other" processContents="lax"

maxOccurs="unbounded"/>
</sequence>
</complexType>

Figure 11: XML Schema deï¬nition of the Extensions
element.

e.g. the Extensions element for the C++ library, whose
XML Schema is deï¬ned in Figure 11. However, the
Extensions element is not the only possible position for
our wrapped content. The schemas of SAML and XML
Signature allow more locations (e.g. the Object element
of the Signature, or the SubjectConfirmationData
and Advice elements of the Assertion).

The previously described behavior of

the XML
schema validation forced OpenSAML to use the wrapped
In contrast,
original assertion for signature validation.
the application logic processed the claims of the evil as-
sertion. In Figure 10, we present the concrete attack mes-
sages of this novel XSW variant.

The successful attack on OpenSAML shows that coun-
tering the XSW attack can become more complicated
than expected. Even when applying several countermea-
sures, the developer should still consider vulnerabilities
in the underlying libraries. Namely, one vulnerability in
the XML Schema validating library can lead to the exe-
cution of a successful XSW attack.

5.4 Various Implementation Flaws

While reviewing the OneLogin Toolkit, we discovered
another interesting ï¬‚aw: the implementation did not care
about what data was actually signed. Therefore, any con-
tent signed by the IdP was sufï¬cient to launch a XSW
attack. In our case we used the metadata of the IdP 4 and
created our own self-made response message to success-
fully attack OneLogin.

4The SAML Metadata [12] describes properties of SAML entities
in XML to allow the easy establishment of federations. Typically, the
metadata is signed by the issuer and publicly available.

SignedProcessedResponseAssertionExtensionsAssertionC++JavaSignatureSignedInfoReferenceURI=â€œ#123â€œID=â€œ123â€œResponseAssertionAssertionSignatureSignedInfoReferenceURI=â€œ#123â€œID=â€œ123â€œID=â€œ123â€œID=â€œ123â€œObjectBesides the fact that a SAML system has to check
what data is signed, it is also essential to verify by whom
the signature was created. In an early version of Sim-
pleSAMLphp, which applied Type 3 messages, we ob-
served that an attacker could forge the outer signature of
the response message with any arbitrary key. In short,
the SimpleSAMLphp RP did not verify if the included
certiï¬cate in the KeyInfo element is trustworthy at all.
The key evaluation for the signed assertion was correctly
handled.

5.5 Secure Frameworks

In our evaluation of real-world SAML implementations
we observed that Microsoft Sharepoint 2010 and Simple-
SAMLphp were resistant to all applied test cases. Based
on these ï¬ndings the following questions arise: How
In
do these systems implement signature validation?
which way do signature validation and assertion process-
ing work together? Due to the fact that the source code of
Sharepoint 2010 is not publicly available, we were only
able to analyze SimpleSAMLphp.

According to this investigation the main signature
validation and claims processing algorithm of Simple-
SAMLphp performs the following ï¬ve steps to counter-
act XSW attacks:

1. XML Schema validation: First,

the whole re-
sponse message is validated against the applied
SAML schemas.

2. Extract assertions: All included assertions are ex-
tracted. Each assertion is saved as a DOM tree in
a separate variable. The following steps are only
applied on these segregated assertions.

3. Verify what is signed: SimpleSAMLphp checks, if
each assertion is protected by an enveloped signa-
ture. In short, the XML node addressed by the URI
attribute of the Reference element is compared to
the root element of the same assertion. The XML
Signature in the assertion is an enveloped signature
if and only if both objects are identical.

4. Validate signature: The veriï¬cation of every en-
veloped signature is exclusively done on the DOM
tree of each corresponding assertion.

5. Assertion processing: The subsequent assertion
processing is solely done with the extracted and suc-
cessfully validated assertions.

When not considering the signature exclusion bug
found in the OpenAthens implementation and its Java-
based assertionsâ€™ processing, this framework was also
resistant to all the described attacks. The analysis of its
implementation showed that it processes SAML asser-
tions similarly to the above described SimpleSAMLphp
framework.

e
p
y
t
g
n
i
n
g
i
Frameworks / Providers S
1)
Apache Axis 2
2)
Guanxi
1)
Higgins 1.x
1)
IBM XS40
2)
JOSSO
1)
WIF
1)
OIOSAML
1)
OpenAM
1)
OneLogin
1)
OpenAthens
1)
OpenSAML
1)
Salesforce
3)
SimpleSAMLphp
2)
WSO2

n
o
i
s
u
l
c
x
e

e
r
u
t
a
n
g
i
S
X

X

X

d
e
t
a
c
i
t
s
i
h
p
o
S

W
S
X

X

e
l
b
a
r
e
n
l
u
v

t
o
N

X

X

W
S
X
d
e
n
ï¬
e
R
X
X
X
X
X

X
X
X

X

X

Table 2: Results of our practical evaluation show that a
majority of the analyzed frameworks were vulnerable to
the reï¬ned wrapping techniques.

5.6 Summary

We evaluated 14 different SAML-based systems. We
found 11 of them susceptible to XSW attacks, while the
majority were prone to reï¬ned XSW. One prevalently
used framework (OpenSAML) was receptive to a new,
more subtle, variant of this attack vector.
In addition,
three out of the tested frameworks were vulnerable to
Signature Exclusion attacks. We found two implemen-
tations, which were resistant against all test cases. The
results obtained from our analysis are summarized in Ta-
ble 2.

6 XSW Penetration Test Tool for SAML

Motivated on our crucial ï¬ndings from the extensive
frameworksâ€™ analysis and the vast amount of possible
attack permutations, we implemented the ï¬rst fully au-
tomated penetration test tool for XSW attacks in SAML-
In this section we brieï¬‚y describe
based frameworks.
the basic design decisions for our tool. Afterwards, we
motivate its usage by revisiting the Salesforce SAML in-
terface. This interface yielded a new possibility for an
interesting XSW attack even after a deep investigation
with different handcrafted messages.

Our tool will be integrated into the WS-Attacker
framework5 and offered as open source to support the
huge Web Services and SSO developersâ€™ community.

6.1 Penetration Test Tool

According to the theoretical and practical analysis of dif-
ferent SAML frameworks (see Section 4, 5), we gained
the following general knowledge about XSW attacks:

5http://ws-attacker.sourceforge.net

â€¢ XML Schema validation: Some of the SAML
frameworks check message conformance to the un-
derlying XML schema. Therefore, it is necessary to
use XML schema extension points for placing the
wrapped content. If the extension elements are not
provided in the message, they have to be explicitly
included.

â€¢ Order and position: The order and position of
signed and executed elements in the message tree
can force the different processing modules to have
inconsistent data views.

â€¢ Processing of the Ids: Several SAML frameworks
explicitly check, if the Id in the handled assertion
is also used in the Reference of the XML Signa-
ture. Application of this countermeasure alone does
not work, as there is still the option to use more el-
ements with equal Ids.

â€¢ Placement of

the Signature element: The
Signature element can be placed in the newly cre-
ated evil assertion or stay in the original assertion
(cf. the attacks on Higgins, Apache Axis2 and IBM
XS40 in Figure 8). Both cases must be considered.
â€¢ Signature exclusion: In three out of 14 frameworks
implementation bugs caused that the signature vali-
dation step was omitted.

â€¢ Untrusted signatures: It is essential to check that
the signature was created with a trustworthy key.
Otherwise, the attacker can forge a signature with
any arbitrary key and embed the corresponding cer-
tiï¬cate in the KeyInfo element.

Based on this knowledge, we developed a library,
which allows the systematic creation of a vast amount
Its processing can
of different SAML attack vectors.
be summarized in the following steps. First, the library
takes a signed XML document containing a SAML as-
sertion and analyzes the usage of XML Signature. The
element referenced by the signature is stored as a string.
Subsequently, it creates a new malicious message includ-
ing an evil assertion with modiï¬ed content (e.g.
the
NameID and/or Timestamp element). Then, it searches
dynamically for extension points in the XML Schema
documents (e.g. XML Schemas for SAML, HTTP bind-
ing, XML Signature, or SOAP). It places the extension
elements into the malicious message (e.g. a new Object
element is created and placed into the given Signature
element). Afterwards, the library embeds the stored orig-
inal referenced element into each of the possible mali-
cious message elements. For each position, a combina-
tion of different attack vectors â€“ considering changes in
the Ids of the newly created elements and the positions
of the Signature elements â€“ are created. For complete-
ness, test cases for signature exclusion and untrusted sig-
natures are provided. With these attack vectors, develop-

Figure 12: A successful XSW attack performed against
the patched Salesforce SAML interface.

ers can systematically test the security of their (newly)
developed SAML libraries.

6.2 Salesforce SAML Interface Revisited

After reporting the XSW vulnerability to Salesforce, the
security response team developed a simple and promis-
ing countermeasure: the SAML interface solely accepted
messages containing one Assertion element6. On re-
quest of the Salesforce security team, we investigated
the ï¬xed SAML interface with handcrafted messages
containing wrapped contents in different elements. Our
manual analysis did not reveal any new attack vectors.
Every message containing more than one Assertion el-
ement was automatically rejected. Therefore, we ï¬rst
considered this interface to be secure.

A few months later, after ï¬nishing the development of
our penetration test tool, we decided to retest the Sales-
force SAML interface and prove the feasibility of our ap-
proach. Surprisingly, the automated penetration test tool
revealed a new successful attack variant by inserting the
wrapped content into the Audience element â€“ a descen-
dant of the Conditions element. This element typically
contains a URI constraining the parties that can consume
the issued assertion. The wrapped message is depicted in
Figure 12. As can be seen in the ï¬gure, both Assertion
elements needed to contain the same Id attribute.

This scientiï¬cally interesting attack vector stayed un-
analyzed as the Salesforce security team did not expose
any concrete information about their SAML interface.
However, this ï¬nding shows how complex the develop-
ment of secure signature wrapping countermeasures is.
This motivates for further development of automatic pen-
etration test tools for XSW.

Salesforce security team afterwards implemented a
countermeasure, which could successfully mitigate all
our attack types. Its details were not revealed.

6This countermeasure is not standard-conform as one message can
generally contain several assertions. Therefore, we do not consider this
remedy in our countermeasure analysis in Section 7.

SignedProcessedResponseAssertionAssertionSignatureSignedInfoReferenceURI=â€œ#123â€œID=â€œ123â€œID=â€œ123â€œAudiencesaml.salesforce.com7.3 Relying Party Model

We assume that processing of documents containing
SAML assertions is split into two parts: (1) XML Sig-
nature veriï¬cation RPsig, and (2) SAML security claims
processing RPclaims (see Figure 13). This assumption is
justiï¬ed since both parts differ in their algorithmic base,
and because this separation was found in all frameworks.
If RPclaims accepts, then the application logic RPwork of
the Relying Party will deliver the requested resource to
the requestor.

The XML Signature veriï¬cation module RPsig is con-
ï¬gured to trust several Identity Provider public keys
{pk1, . . . , pkr}. Each public key deï¬nes a trusted do-
main within RP. After receiving a signed XML document
D, RPsig searches for a Signature element. It applies
the referencing method described in Reference to re-
trieve the signed parts of the document, applies the trans-
forms described in Transforms to these parts, and com-
pares the computed hash values with the values stored in
DigestValue. If all these values match, signature ver-
iï¬cation is performed over the whole SignedInfo ele-
ment, with one of the trusted keys from {pk1, . . . , pkr}.
RPsig then communicates the result of the signature veri-
ï¬cation (eventually alongside D) to RPclaims.

The SAML security claims processing module
RPclaims may operate a customer database dbRP, and may
validate SAML assertions against this database. In this
case if the claimed identity is contained in dbRP, the asso-
ciated rights are granted to the requestor. As an alterna-
tive, RPclaims may rely on authorization data contained in
dbIdP. In this case, the associated rights will be contained
in the SAML assertion, and RPclaims will grant these.

Please note that the deï¬nition of the winning event
given below does not depend on the output of the sig-
nature veriï¬cation part RPsig, but on the SAML asser-
tion processing RPclaims. This is necessary since in all
cases described in this paper, signature veriï¬cation was
done correctly (as is always the case with XML Signa-
ture wrapping). Therefore, to be able to formulate mean-
ingful statements about the security of a SAML frame-
work, we must make some assumptions on the behavior
of RPclaims.

There are many possible strategies for RPclaims to pro-
cess SAML assertions: E.g. use the claims from the ï¬rst
assertion which is opened during parsing, from the ï¬rst
that is closed during parsing (analogously for the last as-
sertion opened or closed), or issue an error message if
more than one Assertion element is read.

7.4 Adversarial Model

the two different

Please recall
types of adversaries
we have mentioned in our threat model in Section 4.
Advintc is the stronger of the two: He has the ability to

Figure 13: Overview of the components in our formal
model.

7 Analysis and Countermeasures

In order to deï¬ne what a successful attack on a SAML
implementation is, we have to deï¬ne the possibilities of
the adversary, and the event that characterizes a success-
ful attack. We do this in form of a game played between
the adversary on one side, and IdP and RP on the other
side. Additionally, we derive two different countermea-
sures. Their practical application is described in Sec-
tion 8.

7.1 Data Model

A SAML assertion A can be sent to a Relying Party RP
either as a stand-alone XML document, or as part of a
larger document D. (D may be a complete SOAP mes-
sage, or a SAML Authentication response.) To process
the SAML assertion(s), the Relying Party (more speciï¬-
cally, RPclaims) searches for the Assertion element and
parses it. We assume that A is signed, either stand-alone,
or as part of D.

7.2

Identity Provider Model

We deï¬ne an Identity Provider IdP to be an entity that is-
sues signed SAML assertions, and that has control over
a single private key for signing. Thus, companies like
Salesforce may operate several IdPs, one for each do-
main of customers.

An Identity Provider IdP operates a customer database
dbIdP and is able to perform a secure authentication
protocol with any customer contained in this database.
Furthermore, he has control over a private signing key,
where the corresponding public key is trusted by a set of
Relying Parties RP := {RP1, . . . , RPn}, either directly,
or through means of a Public Key Infrastructure. After
receiving a request from one of the customers registered
in dbIdP, and after successful authentication, he may is-
sue a signed XML document D, where the signed part
contains the requested SAML assertion A.

IdP1IdP2IdP3AdvaccAdvintcRPsigRPclaimsRPworkpartially intercept network trafï¬c, e.g. by snifï¬ng HTTP
trafï¬c on an unprotected WLAN, by reading past mes-
sages from an unprotected log ï¬le, or by a chosen ci-
phertext attack on TLS 1.0 along the lines of [5]. Please
note that already this adversary is strictly weaker than the
classical network based attacker known from cryptogra-
phy. Advacc, our weaker adversary, only has access to
the IdP and RP, i.e. he may register as a customer with
IdP and receive SAML assertions issued about himself,
and he may send requests to RP.

We deï¬ne preconditions and success conditions of an
attacker in the form of a game G. If Adv mounts a suc-
cessful attack under these conditions, we say that Adv
wins the game. This facilitates some deï¬nitions.

During the game G, the adversary has access to a
validly signed document D containing a SAML assertion
A issued by IdP. He then generates his own (evil) asser-
tion EA, and combines it arbitrarily with D into an XML
document D(cid:48). This document is then sent to RP.

Deï¬nition 1. We say that the adversary (either Advintc or
Advacc) wins game G if RP, after receiving document D(cid:48),
with non-negligible probability Pr(WinAdv) bases its au-
thentication and authorization decisions on the security
claims contained in EA.

Remark: For all researched frameworks, the winning
probability was either negligible or equal to 1. Within the
term â€negligibleâ€ we include the possibility that Adv is-
sues a forged cryptographic signature, which we assume
If an adversary wins the
to be impossible in practice.
game against a speciï¬c Relying Party RP, he takes over
the trust domain for a speciï¬c public key pk within RP.
Advacc may do this for all pk where he is allowed to reg-
ister as a customer with the corresponding IdP who con-
trols (sk, pk). Advintc can achieve this for all pk where he
is able to ï¬nd single signed SAML assertion A where the
signature can (could in the past) be veriï¬ed with pk.

7.5 Countermeasure 1:
what-is-hashed

Only-process-

We can derive the ï¬rst countermeasure if we assume that
RPsig acts as a ï¬lter and only forwards the hashed parts
of an XML document to RPclaims. The hashed parts of
an XML document are those parts that are serialized as
an input to a hash function, and where the hash value is
stored in a Reference element. This excludes all parts
of the document that are removed before hash calculation
by applying a transformation, especially the enveloped
signature transform.

Claim 1. If RPsig only forwards the hashed parts of D to
RPclaims, then Pr(WinAdv) is negligible.

It is straightforward to see that EA is only forwarded

to RPclaims if a valid signature for EA is available.

Please note that although this approach is simple and
effective, it is rarely used in practice due to a number of
subtle implementation problems. A variant of this ap-
proach is implemented by SimpleSAMLphp, where the
RP imposes special requirements on the SAML authen-
tication response, thus limiting interoperability. We dis-
cuss these problems in Section 8.

7.6 Countermeasure 2: Mark signed ele-

ments

In practice, RPsig only returns a Boolean value, and
the whole document D is forwarded to RPclaims. Since
IdPhas to serve many different Relying Parties, we as-
sume knowledge about the strategy of RPclaims only for
RPsig. One possibility to mark signed elements is to hand
over the complete document D from RPsig to RPclaims,
plus a description where the validly signed assertions can
be found.

A second possibility that

is more appropriate for
SAML is that RPsig chooses a random value r, marks
the validly signed elements with an attribute containing
r, and forwards r together with the marked document.
RPclaims can then check if the assertion processed con-
tains r.

Let us therefore consider the second approach in more
detail. For sake of simplicity we assume that only one
complete element (i.e. a complete subtree of the XML
document tree) is signed.

Claim 2. Let Dsig be the signed subtree of D, and
let r âˆˆ {0, 1}l be the random value chosen by RPsig
and attached to Dsig. Then Pr(WinAdv) is bounded by
max{breaksig, 2âˆ’l}.

RPclaims (regardless of its strategy to choose an asser-
tion) will only process EA if r is attached to this element.
An adversary can achieve this by either generating a valid
signature for EA (then r will be attached by RPsig), or by
guessing r and attaching it to EA.

8 Practical Countermeasures

In Section 5.5 we analyzed message processing of Sim-
pleSAMLphp. This framework was resistant against all
XSW attacks. One could therefore ask a legitimate ques-
tion: Why do we need further countermeasures and why
is it not appropriate to apply the security algorithm of
SimpleSAMLphp in every system?

We want to make clear that SimpleSAMLphp offers
both critical functionalities in one framework: signa-
ture validation (RPsig) and SAML assertion evaluation

Figure 14: The see-what-is-signed approach applied in
HTTP POST binding: After successful signature valida-
tion the security module RPsig excludes all the unsigned
elements and forwards the message to the module pro-
cessing security claims RPclaims and the business logic.

(RPclaims). These two methods are implemented using
the same libraries and processing modules. After pars-
ing a document, the elements are stored within a docu-
ment tree and can be accessed directly. This allows the
security developers to conveniently access the same el-
ements used in signature validation and assertion evalu-
ation steps. However, especially in SOA environments
there exist scenarios, which force the developers to sep-
arate these two steps into different modules or even dif-
ferent systems, e.g.:

â€¢ Using a signature validation library: Before eval-
uating the incoming assertion elements, the devel-
oper uses a DOM-based signature library, which
returns true or false according to the message
validity. However, the developer does not exactly
know which elements were validated.
If the as-
sertion evaluation uses a different parsing approach
(e.g.
streaming-based SAX or StAX approach)
or another DOM-library, the message processing
could become error-prone.

â€¢ XML Security gateways: XML Security gateways
can validate XML Signatures and are conï¬gured to
forward only validated XML documents. If the de-
veloper evaluates a validated document in his appli-
cation, he again has no explicit information about
the position of the signed element. Synchronization
of signature and assertion processing components in
this scenario becomes even more complicated, if the
developer has no information about the implemen-
tation of the security gateway (e.g. IBM XS40).

These two examples show that a convenient access to
the same XML elements is not always given. Subse-
quently, we present two practical feasible countermea-
sures, which can be applied in complex and distributed
real-world implementations. Both countermeasures re-
sult from our formal analysis in Section 7.

8.1 See-what-is-signed

The core idea of this countermeasure is to forward only
those elements to the business logic module (RPclaims)

that were validated by the signature veriï¬cation module
(RPsig). This is not trivial as extracting the unsigned el-
ements from the message context could make the fur-
ther message processing in some scenarios impossible.
Therefore, we propose a solution that excludes only the
unsigned elements which do not contain any signed de-
scendants. We give an example of such a message pro-
cessing in Figure 14. This way, the claims and message
processing logic would get the whole message context:
in case of SOAP it would see the whole Envelope ele-
ment, by application of HTTP POST binding it would be
able to process the entire Response element. The main
advantage of this approach is that the message process-
ing logic does not have to search for validated elements
because all forwarded elements are validated.

We want to stress the fact that by application of this ap-
proach all unsigned character nodes have to be extracted.
Otherwise, the attacker could create an evil assertion EA
and insert the signed original assertion into each element
of EA. If RPsig would not extract the character contents
from EA, RPclaims could process its claims. However, by
extracting the unsigned character nodes, the attacker has
no possibility to insert his evil content, since it was ex-
cluded in RPsig. Nevertheless, the subsequent XML mod-
ules can still access the whole XML tree.

This idea has already been discussed by Gajek et
al. [17]. However, until now no XML Signature
framework implements this countermeasure.
It could
be applied especially in the context of SAML HTTP
POST bindings because the unsigned elements within
the SAML response do not contain any data needed
in RPclaims. We consider this countermeasure in these
scenarios as appropriate because the SAML standard
only allows the usage of Id-based referencing, exclusive
canonicalization, and enveloped transformation. The au-
thors explicitly state that this countermeasure would not
work if XML Signature uses speciï¬c XSLT or XPath
transformations.

8.2 Unique Identiï¬cation (Tainting) of

Signed Data

The second countermeasure represents another form of
the see-what-is-signed approach. The basic idea is to
uniquely identify the signed data in the RPsig module
and forward this information to the following modules.
As described in our formal analysis, this could be done
by generating a random value r, sending it to the next
processing module (or as an attribute in the document
root element), and attaching it to all the signed elements.
We give an example of this countermeasure applied to a
SOAP message in Figure 15.

The main drawback of this countermeasure is that the
SAML XML Schema does not allow the inclusion of

ResponseAssertionID=â€œ123â€œSignatureURI=â€œ#123â€œRPsigRPclaimsStatusResponseAssertionID=â€œ123â€œcontains partial information about the structure of the
SOAP message and the neighborhood of the signed el-
ement(s). The information preserves the structure of the
data to be signed. However, Gajek et al. have shown
that this approach does not prevent XSW attacks [16].
Benameur, Kadir, and Fenet [6] have extended the inline
approach, but suffer from the same vulnerabilities.

Jensen et al. [24] have analyzed the effectiveness of
XML Schema validation in terms of fending XSW at-
tacks in Web Services. Thereby, they have used man-
ually hardened XML Schemas. The authors have con-
cluded that XML Schema validation is capable of fend-
ing XSW attacks, at the expense of two important disad-
vantages: for each application a speciï¬c hardened XML
Schema without extension points must be created care-
fully. Moreover, validating of a hardened XML Schema
entails severe performance penalties.

XPath and XPath Filter 2 are speciï¬ed as referenc-
ing mechanisms in the XML Signature standard. How-
ever, the WS-Security standard proposes not to use these
mechanisms, and the SAML standard mandates to use
Id-based referencing instead. This is due to the fact that
both standards are very complex. Gajek et al. [15] have
evaluated the effectiveness of these mechanisms to mit-
igate XSW attacks in the SOAP context, and have pro-
posed a lightweight variant FastXPath, which has lead
to the same performance in a PoC implementation as by
adapting the Id-based referencing.

Jensen et al. [23] have however shown that this ap-
proach does not completely eliminate XSW attacks: by
clever manipulations of XML namespace declarations
within a signed document, which take into account the
processing rules for canonicalization algorithms in XML
Signature, XSW attacks could successfully be mounted
even against XPath referenced resources.

The impacts of practical XSW attacks have also been
analyzed in [20, 33].
In these works new types of
XSW attack have been applied on SOAP Web Service
interfaces of Amazon and Eucalyptus clouds. The at-
tacks have exploited different XML processing in dis-
tinct modules.

In summary, previous work has mostly concentrated
on SOAP, and the results do not directly apply to all
SAML use cases.

SAML and Single Sign-On Since SAML offers very
ï¬‚exible mechanisms to make claims about identities,
there is a large body of research on how SAML can be
used to improve identity management (e.g. [22, 39]) and
other identity-related processes like payment or SIP on
the Internet [25, 35]. In all these applications, the secu-
rity of all SAML standards is assumed.

In an overview paper on SAML, Maler and Reed [26]
have proposed mutually authenticated TLS as the basic

Figure 15: Unique identiï¬cation of signed data applied
on a SOAP message including two signed elements: The
RPsig module uniquely identiï¬es the signed elements
with a random value r and forwards this information
along with the whole XML message.

new attributes: neither directly into the Assertion el-
ement nor the Response binding element. Therefore,
the XML Schema validation of the assertion processing
module would fail. For general application of this idea
the SAML XML Schema needs to be extended.

Another possibility to implement this countermeasure
is to use XML node types, which do not violate XML
Schema, but are visible to the XML processors. For
example, processing instructions, which are intended to
carry instructions to the application belong to this group.
They can be placed anywhere in the document without
invalidating the XML Schema. Additionally, they can
be conveniently found by processing XML trees with
streaming and DOM-based parsers. Therefore, the pres-
ence of these XML nodes would help to ï¬nd the vali-
dated data and thus allows to mitigate XSW attacks. We
propose this technique for further discussion in the W3C
XML Security Working Group and the OASIS consor-
tium.

9 Related Work

XML Signature Wrapping (XSW). XSW attacks
have ï¬rst been described in [28] and [7]. Several coun-
termeasures have been proposed over time.

McIntosh and Austel [28] have presented several XSW
attacks and discussed (informal) receiver-sided security
policies in order to prevent such exploits. They have
however not given a deï¬nitive solution for this problem.
Bhargavan, Fournet and Gordon [7] have analyzed a
formal approach in order to verify Web Services speciï¬-
cations. They have proposed a policy advisor [8], a tool
that generates appropriate security policies for Web Ser-
vices protocols. This approach is however not directly
applicable to SAML.

Rahaman, Schaad and Rits [32, 30, 31] have refrained
from policy-driven approaches and have introduced an
inline solution. The authors have proposed to embed an
Account element into the SOAP header. This element

EnvelopeAssertionHeaderID=â€œ123â€œSignatureSignatureURI=â€œ#123â€œBodyURI=â€œ#bodyâ€œID=â€œbodyâ€œUnsignedContentRPsigRPclaimsrg=â€œxyâ€œrg=â€œxyâ€œr=â€œxyâ€œEnvelopeAssertionHeaderID=â€œ123â€œSignatureSignatureURI=â€œ#123â€œBodyURI=â€œ#bodyâ€œID=â€œbodyâ€œUnsignedContentr=â€œxyâ€œsecurity mechanism. Please note that even if mutually
authenticated TLS would be employed, it would not pre-
vent our attacks because we only need a single signed
SAML assertion from an IdP, which we can get through
different means. Moreover, there exist speciï¬c sidechan-
nels, which could be exploited by an adversary. Let us
e.g. mention chosen-plaintext attacks against SSL/TLS
predicted by [37] and reï¬ned by [5], or the Million Ques-
tion attack by Bleichenbacher [9]. Other complications
arise with the everlasting problems with SSL PKIs.

In 2003, T. GroÃŸ has initiated the security analysis of
SAML [18] from a Dolev-Yao point of view, which has
been formalized in [4]. He has found, together with B.
Pï¬tzmann [19], deï¬ciencies in the information ï¬‚ow be-
tween the SAML entities. Their work has inï¬‚uenced a
revision of the standard.

In 2008, Armando et al. [3] have built a formal model
of the SAML 2.0 Web Browser SSO protocol and have
analyzed it with the model checker SATMC. By intro-
ducing a malicious RP they have found a practical at-
tack on the SAML implementation of Google Apps. An-
other attack on the SAML-based SSO of Google Apps
has been found in 2011 [2]. Again, a malicious RP has
been used to force a userâ€™s web browser to access a re-
source without approval. Thereby, the malicious RP has
injected malicious content in the initial unintended re-
quest to the attacked RP. After successful authentication
on the IdP this content has been executed in the context
of the userâ€™s authenticated session.

The fact that SAML protocols consist of multiple lay-
ers has been pointed out in [13]. In this paper, the Weak-
est Link Attack has enabled adversaries to succeed at all
levels of authentication by breaking only at the weakest
one.

Very recently, another work pointing out the impor-
tance of SSO protocols has been published by Wang et
al. [38]. This work has analyzed the security quality
of commercially deployed SSO solutions. It has shown
eight serious logic ï¬‚aws in high-proï¬le IdPs and RPs
(such as OpenID, Facebook, or JanRain), which have
allowed an attacker to sign in as the victim user. The
SAML-based SSO has not been analyzed.

10 Conclusion

In this paper we systematically analyzed the application
of XSW attacks on SAML frameworks and systems. We
showed that the large majority of systems exhibit criti-
cal security insufï¬ciencies in their interfaces. Addition-
ally, we revealed new classes of XSW attacks, which
worked even if speciï¬c countermeasures were applied.
We showed that the application of XML Security heav-
ily depends on the underlying XML processing system
(i.e. different XML libraries and parsing types). The pro-

cessing modules involved can have inconsistent views on
the same secured XML document, which may result in
successful XSW attacks. Generally, these heterogeneous
views can exist in all data formats beyond XML.

We proposed a formal model by analyzing the in-
formation ï¬‚ow inside the Relying Party and presented
two countermeasures. The effectiveness of these coun-
termeasures depends on the real information ï¬‚ow and
the data processing inside RPclaims. Our research is
a ï¬rst step towards understanding the implications of
the information ï¬‚ow between cryptographic and non-
cryptographic components in complex software environ-
ments. Research in this direction could enhance the re-
sults, and provide easy-to-apply solutions for practical
frameworks.

As another future research direction, we propose de-
velopment of an enhanced penetration testing tool for
XSW in arbitrary XML documents and all types of XML
Signatures. This kind of tool presents a huge challenge
as it should e.g. consider more difï¬cult transformations
like XPath or XSLT.

Acknowledgements

The authors would like to thank all the security teams and
their developers for their cooperation, and would like to
note that throughout the collaboration all the teams ef-
fectuated a productive and highly professional commu-
nication.

Moreover, we would like to thank Scott Cantor, David
Jorm, Florian Kohlar, Christian Mainka, Christopher
Meyer, Thomas Roessler, and the anonymous review-
ers (of the USENIX Security Symposium and the IEEE
Symposium on Security and Privacy) for their valuable
remarks on the developed attacks and the paper content.
Finally, we thank Alexander Bieber for the Sharepoint
2010 test bed.

This work was partially funded by the Sec2 project of
the German Federal Ministry of Education and Research
(BMBF, FKZ: 01BY1030).

References

[1] IEEE International Conference on Web Services, ICWS 2009, Los

Angeles, CA, USA, 6-10 July 2009 (2009), IEEE.

[2] ARMANDO, A., CARBONE, R., COMPAGNA, L., CU Â´ELLAR, J.,
PELLEGRINO, G., AND SORNIOTTI, A. From Multiple Creden-
tials to Browser-Based Single Sign-On: Are We More Secure?
In Future Challenges in Security and Privacy for Academia and
Industry, J. Camenisch, S. Fischer-Hbner, Y. Murayama, A. Port-
mann, and C. Rieder, Eds., vol. 354 of IFIP Advances in Infor-
mation and Communication Technology. Springer Boston, 2011.
[3] ARMANDO, A., CARBONE, R., COMPAGNA, L., CU Â´ELLAR,
Formal Analysis of SAML 2.0
J., AND TOBARRA, M. L.
Web Browser Single Sign-On: Breaking the SAML-based Single
Sign-On for Google Apps. In Proceedings of the 6th ACM Work-
shop on Formal Methods in Security Engineering, FMSE 2008,
V. Shmatikov, Ed. ACM, Alexandria and VA and USA, 2008.

[4] BACKES, M., AND GROSS, T. Tailoring the dolev-yao abstrac-
In SWS (2005), E. Damiani and

tion to web services realities.
H. Maruyama, Eds., ACM, pp. 65â€“74.

[21] GUDGIN, M., HADLEY, M., MENDELSOHN, N., MOREAU, J.-
J., AND NIELSEN, H. F. SOAP Version 1.2 Part 1: Messaging
Framework. W3C Recommendation (2003).

[5] BARD, G. V.

A Challenging but Feasible Blockwise-
Adaptive Chosen-Plaintext Attack on SSL. In SECRYPT (2006),
M. Malek, E. FernÂ´andez-Medina, and J. Hernando, Eds., IN-
STICC Press, pp. 99â€“109.

[6] BENAMEUR, A., KADIR, F. A., AND FENET, S. XML Rewrit-
ing Attacks: Existing Solutions and their Limitations. In IADIS
Applied Computing 2008 (Apr. 2008), IADIS Press.

[7] BHARGAVAN, K., FOURNET, C., AND GORDON, A. D. Verify-
ing policy-based security for web services. In CCS â€™04: Proceed-
ings of the 11th ACM conference on Computer and communica-
tions security (2004), pp. 268â€“277.

[8] BHARGAVAN, K., FOURNET, C., GORDON, A. D., AND
Oâ€™SHEA, G. An advisor for web services security policies. In
SWS â€™05: Proceedings of the 2005 workshop on Secure web ser-
vices (New York, NY, USA, 2005), ACM, pp. 1â€“9.

[9] BLEICHENBACHER, D. Chosen ciphertext attacks against proto-
cols based on the rsa encryption standard pkcs #1. In CRYPTO
(1998), pp. 1â€“12.

[10] CANTOR, S., KEMP,

J., MALER, E., AND PHILPOTT,
the OASIS Security Assertion Markup
R.
Proï¬les for
Language (SAML) V2.0.
OASIS Standard, 15.03.2005,
2005. http://docs.oasis-open.org/security/saml/v2.
0/saml-profiles-2.0-os.pdf.

[11] CANTOR, S., KEMP, J., PHILPOTT, R., AND MALER, E.
Assertions and Protocol for the OASIS Security Assertion
Markup Language (SAML) V2.0. OASIS Standard, 15.03.2005,
2005. http://docs.oasis-open.org/security/saml/v2.
0/saml-core-2.0-os.pdf.

[12] CANTOR, S., MOREH, J., PHILPOTT, R., AND MALER,
E. Metadata for the OASIS Security Assertion Markup
Language (SAML) V2.0.
OASIS Standard, 15.03.2005,
2005. http://docs.oasis-open.org/security/saml/v2.
0/saml-metadata-2.0-os.pdf.

[13] CHAN, Y.-Y. Weakest link attack on single sign-on and its case
in saml v2.0 web sso. In Computational Science and Its Applica-
tions - ICCSA 2006, M. Gavrilova, O. Gervasi, V. Kumar, C. Tan,
D. Taniar, A. Lagan, Y. Mun, and H. Choo, Eds., vol. 3982 of
Lecture Notes in Computer Science. Springer Berlin / Heidelberg,
2006, pp. 507â€“516. 10.1007/11751595 54.

[14] EASTLAKE, D., REAGLE, J., SOLO, D., HIRSCH, F., AND
ROESSLER, T. XML Signature Syntax and Processing (Second
Edition), 2008. http://www.w3.org/TR/xmldsig-core/.

[15] GAJEK, S., JENSEN, M., LIAO, L., AND SCHWENK, J. Analy-
sis of signature wrapping attacks and countermeasures. In ICWS
[1], pp. 575â€“582.

[16] GAJEK, S., LIAO, L., AND SCHWENK, J. Breaking and ï¬xing
the inline approach. In SWS â€™07: Proceedings of the 2007 ACM
workshop on Secure web services (New York, NY, USA, 2007),
ACM, pp. 37â€“43.

[17] GAJEK, S., LIAO, L., AND SCHWENK, J. Towards a formal
semantic of xml signature. W3C Workshop Next Steps for XML
Signature and XML Encryption, 2007.

[18] GROSS, T. Security Analysis of the SAML SSO Browser/Artifact
Proï¬le. In ACSAC (2003), IEEE Computer Society, pp. 298â€“307.

[19] GROSS, T., AND PFITZMANN, B. SAML artifact information
ï¬‚ow revisited. In In IEEE Workshop on Web Services Security
(WSSS) (Berkeley, May 2006), IEEE, pp. 84â€“100.

[20] GRUSCHKA, N., AND IACONO, L. L. Vulnerable cloud: Soap
message security validation revisited. In ICWS [1], pp. 625â€“631.

[22] HARDING, P., JOHANSSON, L., AND KLINGENSTEIN, N. Dy-
namic security assertion markup language: Simplifying single
sign-on. Security Privacy, IEEE 6, 2 (march-april 2008), 83 â€“
85.

[23] JENSEN, M., LIAO, L., AND SCHWENK, J. The curse of names-
paces in the domain of xml signature. In SWS (2009), E. Damiani,
S. Proctor, and A. Singhal, Eds., ACM, pp. 29â€“36.

[24] JENSEN, M., MEYER, C., SOMOROVSKY, J., AND SCHWENK,
J. On the effectiveness of xml schema validation for counter-
ing xml signature wrapping attacks. In Securing Services on the
Cloud (IWSSC), 2011 1st International Workshop on (sept. 2011),
pp. 7 â€“13.

[25] LUTZ, D., AND STILLER, B. Combining identity federation with
payment: The saml-based payment protocol. In Network Oper-
ations and Management Symposium (NOMS), 2010 IEEE (april
2010), pp. 495 â€“502.

[26] MALER, E., AND REED, D. The venn of identity: Options and
issues in federated identity management. Security Privacy, IEEE
6, 2 (march-april 2008), 16 â€“23.

[27] MCINTOSH, M., AND AUSTEL, P. XML Signature Element
Wrapping Attacks and Countermeasures. In SWS â€™05: Proceed-
ings of the 2005 workshop on Secure web services (New York,
NY, USA, 2005), ACM Press, pp. 20â€“27.

[28] MCINTOSH, M., AND AUSTEL, P. XML signature element
wrapping attacks and countermeasures. In Workshop on Secure
Web Services (2005).

[29] NADALIN, A., KALER, C., MONZILLO, R., AND HALLAM-
BAKER, P. Web Services Security: SOAP Message Security 1.1
(WS-Security 2004). OASIS Standard (2006).

[30] RAHAMAN, M. A., MARTEN, R., AND SCHAAD, A. An inline
approach for secure soap requests and early validation. OWASP
AppSec Europe, 2006.

[31] RAHAMAN, M. A., AND SCHAAD, A. Soap-based secure con-
versation and collaboration. In ICWS (2007), pp. 471â€“480.
[32] RAHAMAN, M. A., SCHAAD, A., AND RITS, M. Towards se-
In Workshop on Secure

cure soap message exchange in a soa.
Web Services (2006).

[33] SOMOROVSKY, J., HEIDERICH, M., JENSEN, M., SCHWENK,
J., GRUSCHKA, N., AND IACONO, L. L. All Your Clouds are
Belong to us â€“ Security Analysis of Cloud Management Inter-
faces. In The ACM Cloud Computing Security Workshop (CCSW)
(Oct. 2011).

[34] THE APACHE SOFTWARE FOUNDATION. Apache Xerces.
[35] TSCHOFENIG, H., FALK, R., PETERSON, J., HODGES, J.,
SICKER, D., AND POLK, J. Using saml to protect the session
initiation protocol (sip). Network, IEEE 20, 5 (sept.-oct. 2006),
14 â€“17.

[36] VAN DER VLIST, E. XML Schema. Oâ€™Reilly, 2002.
[37] WAGNER, D., AND SCHNEIER, B. Analysis of the SSL 3.0 pro-
In In Proceedings of the Second USENIX Workshop on
tocol.
Electronic Commerce (1996), USENIX Association, pp. 29â€“40.
[38] WANG, R., CHEN, S., AND WANG, X. Signing Me onto Your
Accounts through Facebook and Google: a Trafï¬c-Guided Secu-
rity Study of Commercially Deployed Single-Sign-On Web Ser-
vices. In IEEE Symposium on Security and Privacy (Oakland),
IEEE Computer Society (May 2012).

[39] YONG-SHENG, Z., AND JING, Y. Research of dynamic authen-
tication mechanism crossing domains for web services based on
saml. In Future Computer and Communication (ICFCC), 2010
2nd International Conference on (may 2010), vol. 2, pp. V2â€“395
â€“V2â€“398.



=== Content from packetstormsecurity.com_b0b77279_20250119_122129.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

LOCKED OUTâ›” 24 hour lockout initiated

hi. we regret to inform you that a condition has occurred that has resulted in a 24 hour lockout. this occurs when rate limiting controls are exceeded or when someone attempts to hack the system but fails too many times. we wish you luck in your future attempts tomorrow.
