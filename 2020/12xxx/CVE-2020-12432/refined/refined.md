```
{
  "vulnerability": {
    "root_cause": "The Vereign's /wopi/ API interface in Collabora CODE is vulnerable to stored XSS due to improper handling of uploaded HTML documents and insecure file access permissions.",
    "weaknesses": [
      "Stored Cross-Site Scripting (XSS)",
      "Insecure Permissions"
    ],
    "impact": "An attacker can steal local storage data, potentially leading to account hijacking or other unauthorized actions. By crafting malicious HTML links containing an XSS payload, the attacker can redirect victims to a third-party service and exfiltrate their cookies and local storage data.",
    "attack_vectors": [
      "Uploading a malicious HTML document through the web application.",
      "Crafting a link with an XSS redirect to the victim through the /wopi/ API"
    ],
    "required_attacker_capabilities": "The attacker needs to upload a document containing malicious HTML and then craft a specific link including a valid access token obtained from the /wopi/getAccessToken endpoint. The attacker also requires the wopi API to be accessible via the generated token, which is the default configuration.",
      "additional_details": "The vulnerability is related to the /wopi/ API developed by Vereign. The vulnerability is present in Collabora CODE versions 4.2.2 and below. The provided PoC shows how an attacker can use a crafted link to redirect users and exfiltrate sensitive data. The token is accessed via the /wopi/getAccessToken endpoint. The attacker injects JavaScript into the HTML document to steal cookies and local storage data."
  }
}
```