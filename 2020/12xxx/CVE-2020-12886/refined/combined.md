=== Content from github.com_6611b78d_20250119_124722.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPelionIoT%2Fmbed-coap%2Fpull%2F116)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPelionIoT%2Fmbed-coap%2Fpull%2F116)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=PelionIoT%2Fmbed-coap)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PelionIoT](/PelionIoT)
/
**[mbed-coap](/PelionIoT/mbed-coap)**
Public

* [Notifications](/login?return_to=%2FPelionIoT%2Fmbed-coap) You must be signed in to change notification settings
* [Fork
  16](/login?return_to=%2FPelionIoT%2Fmbed-coap)
* [Star
   29](/login?return_to=%2FPelionIoT%2Fmbed-coap)

* [Code](/PelionIoT/mbed-coap)
* [Issues
  6](/PelionIoT/mbed-coap/issues)
* [Pull requests
  2](/PelionIoT/mbed-coap/pulls)
* [Actions](/PelionIoT/mbed-coap/actions)
* [Projects
  0](/PelionIoT/mbed-coap/projects)
* [Security](/PelionIoT/mbed-coap/security)
* [Insights](/PelionIoT/mbed-coap/pulse)

Additional navigation options

* [Code](/PelionIoT/mbed-coap)
* [Issues](/PelionIoT/mbed-coap/issues)
* [Pull requests](/PelionIoT/mbed-coap/pulls)
* [Actions](/PelionIoT/mbed-coap/actions)
* [Projects](/PelionIoT/mbed-coap/projects)
* [Security](/PelionIoT/mbed-coap/security)
* [Insights](/PelionIoT/mbed-coap/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FPelionIoT%2Fmbed-coap%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FPelionIoT%2Fmbed-coap%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Bugfix/coap parser mem access bugs #116

 Merged

[esajaa](/esajaa)
merged 6 commits into
[PelionIoT:master](/PelionIoT/mbed-coap/tree/master "PelionIoT/mbed-coap:master")
from
[mjurczak:bugfix/coap\_parser\_mem\_access\_bugs](/mjurczak/mbed-coap/tree/bugfix/coap_parser_mem_access_bugs "mjurczak/mbed-coap:bugfix/coap_parser_mem_access_bugs")

Jun 22, 2020

 Merged

# [Bugfix/coap parser mem access bugs](#top) #116

[esajaa](/esajaa)
merged 6 commits into
[PelionIoT:master](/PelionIoT/mbed-coap/tree/master "PelionIoT/mbed-coap:master")
from
[mjurczak:bugfix/coap\_parser\_mem\_access\_bugs](/mjurczak/mbed-coap/tree/bugfix/coap_parser_mem_access_bugs "mjurczak/mbed-coap:bugfix/coap_parser_mem_access_bugs")

Jun 22, 2020

[Conversation
2](/PelionIoT/mbed-coap/pull/116)
[Commits
6](/PelionIoT/mbed-coap/pull/116/commits)
[Checks
0](/PelionIoT/mbed-coap/pull/116/checks)
[Files changed](/PelionIoT/mbed-coap/pull/116/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![mjurczak](https://avatars.githubusercontent.com/u/9540275?s=60&v=4)](/mjurczak)

Copy link

Contributor

### @mjurczak **[mjurczak](/mjurczak)** commented [Jun 10, 2020](#issue-636576282)

[x] I confirm this contribution is my own and I agree to license it with Apache 2.0.

[x] I confirm the moderators may change the PR before merging it in.

### Summary of changes

Fixes for out-ouf-bounds memory access, memory leak and infinite loop condition in coap packets parser.

The fixed issues described in detail in the following threads:

[ARMmbed/mbed-os#12957](https://github.com/ARMmbed/mbed-os/issues/12957)

[ARMmbed/mbed-os#12948](https://github.com/ARMmbed/mbed-os/issues/12948)

[ARMmbed/mbed-os#12930](https://github.com/ARMmbed/mbed-os/issues/12930)

[ARMmbed/mbed-os#12928](https://github.com/ARMmbed/mbed-os/issues/12928)

[ARMmbed/mbed-os#12927](https://github.com/ARMmbed/mbed-os/issues/12927)

[ARMmbed/mbed-os#12926](https://github.com/ARMmbed/mbed-os/issues/12926)

[ARMmbed/mbed-os#12925](https://github.com/ARMmbed/mbed-os/issues/12925)

Reserved CVE identifiers related to the resolved issues:

[CVE-2020-12886](https://github.com/advisories/GHSA-8v45-9mw2-ffmm "CVE-2020-12886")

[CVE-2020-12883](https://github.com/advisories/GHSA-x723-g4p2-w8m5 "CVE-2020-12883")

[CVE-2020-12884](https://github.com/advisories/GHSA-ghhj-m687-4jqx "CVE-2020-12884")

[CVE-2020-12885](https://github.com/advisories/GHSA-jhjh-34gq-3m8c "CVE-2020-12885")

[CVE-2020-12887](https://github.com/advisories/GHSA-p665-3xc8-4hrv "CVE-2020-12887")

Sorry, something went wrong.

All reactions

 [mjurczak](/mjurczak)
added 4 commits
[May 7, 2020 12:23](#commits-pushed-152cde0)

[![@mjurczak](https://avatars.githubusercontent.com/u/9540275?s=40&v=4)](/mjurczak)

`[Merge pull request](/PelionIoT/mbed-coap/pull/116/commits/152cde0a79afc1e66ef36484172ee2f433777d0b "Merge pull request #1 from ARMmbed/master

Update to latest mastser") [#1](https://github.com/mjurczak/mbed-coap/pull/1) [from ARMmbed/master](/PelionIoT/mbed-coap/pull/116/commits/152cde0a79afc1e66ef36484172ee2f433777d0b "Merge pull request #1 from ARMmbed/master

Update to latest mastser")`
 ‚Ä¶

`[152cde0](/PelionIoT/mbed-coap/pull/116/commits/152cde0a79afc1e66ef36484172ee2f433777d0b)`

```
Update to latest mastser
```

[![@mjurczak](https://avatars.githubusercontent.com/u/9540275?s=40&v=4)](/mjurczak)

`[Implemented measures to protect against out-of-bounds memory access i‚Ä¶](/PelionIoT/mbed-coap/pull/116/commits/cbcb40b466d05905d354437849f3e806beee3202 "Implemented measures to protect against out-of-bounds memory access in coap parser.

Fixed insufficient memory range validation prior to memory access in options parsing and token parsing.

CVE-2020-12886
CVE-2020-12883
CVE-2020-12884")`
 ‚Ä¶

`[cbcb40b](/PelionIoT/mbed-coap/pull/116/commits/cbcb40b466d05905d354437849f3e806beee3202)`

```
‚Ä¶n coap parser.

Fixed insufficient memory range validation prior to memory access in options parsing and token parsing.

[CVE-2020-12886](https://github.com/advisories/GHSA-8v45-9mw2-ffmm "CVE-2020-12886")
[CVE-2020-12883](https://github.com/advisories/GHSA-x723-g4p2-w8m5 "CVE-2020-12883")
[CVE-2020-12884](https://github.com/advisories/GHSA-ghhj-m687-4jqx "CVE-2020-12884")
```

[![@mjurczak](https://avatars.githubusercontent.com/u/9540275?s=40&v=4)](/mjurczak)

`[Fixed possible infinite loop in sn_coap_parser_options_parse_multiple‚Ä¶](/PelionIoT/mbed-coap/pull/116/commits/f50e3311337d68092e1fe21f1c195f16a1d0cb43 "Fixed possible infinite loop in sn_coap_parser_options_parse_multiple_options()

Fixed an issue with improved boundary checks and inproved end-of multiple options processing loop break conditions.
Simplified the sn_coap_parser_options_count_needed_memory_multiple_option() function by reusing extended options number/length parsing functions.

CVE-2020-12885")`
 ‚Ä¶

`[f50e331](/PelionIoT/mbed-coap/pull/116/commits/f50e3311337d68092e1fe21f1c195f16a1d0cb43)`

```
‚Ä¶_options()

Fixed an issue with improved boundary checks and inproved end-of multiple options processing loop break conditions.
Simplified the sn_coap_parser_options_count_needed_memory_multiple_option() function by reusing extended options number/length parsing functions.

[CVE-2020-12885](https://github.com/advisories/GHSA-jhjh-34gq-3m8c "CVE-2020-12885")
```

[![@mjurczak](https://avatars.githubusercontent.com/u/9540275?s=40&v=4)](/mjurczak)

`[Implemented measures to prevent memory leaks in sn_coap_parser_option‚Ä¶](/PelionIoT/mbed-coap/pull/116/commits/e65e5eb79a66e004e9fdb30f224447ab6179059a "Implemented measures to prevent memory leaks in sn_coap_parser_options_parse().

Added a helper uint16_t addition function with overflow detection. The function is used when calculating the extended length and option delta. The overlow detection is needed to avoid wrap-around of option number or length.
Additional checks in options using sn_coap_parser_options_parse_multiple_options() have been implemented to avoid overwriting of pointers pointing to previously allocated memory.

CVE-2020-12887")`
 ‚Ä¶

`[e65e5eb](/PelionIoT/mbed-coap/pull/116/commits/e65e5eb79a66e004e9fdb30f224447ab6179059a)`

```
‚Ä¶s_parse().

Added a helper uint16_t addition function with overflow detection. The function is used when calculating the extended length and option delta. The overlow detection is needed to avoid wrap-around of option number or length.
Additional checks in options using sn_coap_parser_options_parse_multiple_options() have been implemented to avoid overwriting of pointers pointing to previously allocated memory.

[CVE-2020-12887](https://github.com/advisories/GHSA-p665-3xc8-4hrv "CVE-2020-12887")
```

[![@mjurczak](https://avatars.githubusercontent.com/u/9540275?s=40&u=c8ed5071ca8020098fdd9c01e58b807398a7bbe2&v=4)](/mjurczak)
[mjurczak](/mjurczak)
mentioned this pull request
[Jun 10, 2020](#ref-issue-616186629)

[Memory leak in MbedOS CoAP library parser - sn\_coap\_parser\_options\_parse()
ARMmbed/mbed-os#12957](/ARMmbed/mbed-os/issues/12957)

Closed

 [![@esajaa](https://avatars.githubusercontent.com/u/26139870?s=40&v=4)](/esajaa)
[esajaa](/esajaa)
requested a review
from [anttiylitokola](/anttiylitokola)
[June 15, 2020 11:53](#event-3444025197)

[![@esajaa](https://avatars.githubusercontent.com/u/26139870?s=40&v=4)](/esajaa)

`[Formatting fixes](/PelionIoT/mbed-coap/pull/116/commits/91253bf3be7d928243ac8e804002153df035137c "Formatting fixes")`

`[91253bf](/PelionIoT/mbed-coap/pull/116/commits/91253bf3be7d928243ac8e804002153df035137c)`

[![@esajaa](https://avatars.githubusercontent.com/u/26139870?s=80&v=4)](/esajaa)

Copy link

Contributor

### **[esajaa](/esajaa)** commented [Jun 16, 2020](#issuecomment-644742448)

| Hi [@mjurczak](https://github.com/mjurczak),  I've been going through your pull request, and to me it seems like a good addition. I asked for a second opinion, but so far it's passing all the tests and nothing really seems out of place. I pushed some formatting fixes to the branch, hopefully that's okay to you.  I also noticed that you had few other branches in your fork. Is all the content here in this PR, or are there more pull requests incoming?  Best Regards, Esa |
| --- |

All reactions

Sorry, something went wrong.

[![@mjurczak](https://avatars.githubusercontent.com/u/9540275?s=80&u=c8ed5071ca8020098fdd9c01e58b807398a7bbe2&v=4)](/mjurczak)

Copy link

Contributor

Author

### **[mjurczak](/mjurczak)** commented [Jun 16, 2020](#issuecomment-644983503)

| Hi [@esajaa](https://github.com/esajaa) , Thanks for the formatting fixes. The content of the remaining branches in my fork is included in this single PR. I hope this is okay.  Kind regards, Maciej |
| --- |

All reactions

Sorry, something went wrong.

[![anttiylitokola](https://avatars.githubusercontent.com/u/13655184?s=60&v=4)](/anttiylitokola)

**[anttiylitokola](/anttiylitokola)**
approved these changes
[Jun 18, 2020](#pullrequestreview-432933217)

 [View reviewed changes](/PelionIoT/mbed-coap/pull/116/files/91253bf3be7d928243ac8e804002153df035137c)

`[Merge branch 'master' into bugfix/coap_parser_mem_access_bugs](/PelionIoT/mbed-coap/pull/116/commits/efbec0df4db5f5eafacd439c6af42ce11d286e21 "Merge branch 'master' into bugfix/coap_parser_mem_access_bugs")`

`[efbec0d](/PelionIoT/mbed-coap/pull/116/commits/efbec0df4db5f5eafacd439c6af42ce11d286e21)`

[![@esajaa](https://avatars.githubusercontent.com/u/26139870?s=40&v=4)](/esajaa)
[esajaa](/esajaa)
merged commit [`fd2a3ef`](/PelionIoT/mbed-coap/commit/fd2a3effd3dbd932ebfc390a501d65a7bd52d7cf)
into
PelionIoT:master

[Jun 22, 2020](https://github.com/PelionIoT/mbed-coap/pull/116#event-3466867759)

[![@kjbracey](https://avatars.githubusercontent.com/u/11025917?s=40&v=4)](/kjbracey)
[kjbracey](/kjbracey)
mentioned this pull request
[Jun 24, 2020](#ref-pullrequest-638824292)

[Optimise packet parser and builder core
#117](/PelionIoT/mbed-coap/pull/117)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FPelionIoT%2Fmbed-coap%2Fpull%2F116)

Reviewers

[![@anttiylitokola](https://avatars.githubusercontent.com/u/13655184?s=40&v=4)](/anttiylitokola) [anttiylitokola](/anttiylitokola)

anttiylitokola approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@mjurczak](https://avatars.githubusercontent.com/u/9540275?s=52&v=4)](/mjurczak) [![@esajaa](https://avatars.githubusercontent.com/u/26139870?s=52&v=4)](/esajaa) [![@anttiylitokola](https://avatars.githubusercontent.com/u/13655184?s=52&v=4)](/anttiylitokola)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_624dfd6f_20250119_124723.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FARMmbed%2Fmbed-os%2Fissues%2F12948)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FARMmbed%2Fmbed-os%2Fissues%2F12948)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=ARMmbed%2Fmbed-os)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ARMmbed](/ARMmbed)
/
**[mbed-os](/ARMmbed/mbed-os)**
Public

* [Notifications](/login?return_to=%2FARMmbed%2Fmbed-os) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2FARMmbed%2Fmbed-os)
* [Star
   4.7k](/login?return_to=%2FARMmbed%2Fmbed-os)

* [Code](/ARMmbed/mbed-os)
* [Issues
  195](/ARMmbed/mbed-os/issues)
* [Pull requests
  11](/ARMmbed/mbed-os/pulls)
* [Actions](/ARMmbed/mbed-os/actions)
* [Projects
  0](/ARMmbed/mbed-os/projects)
* [Security](/ARMmbed/mbed-os/security)
* [Insights](/ARMmbed/mbed-os/pulse)

Additional navigation options

* [Code](/ARMmbed/mbed-os)
* [Issues](/ARMmbed/mbed-os/issues)
* [Pull requests](/ARMmbed/mbed-os/pulls)
* [Actions](/ARMmbed/mbed-os/actions)
* [Projects](/ARMmbed/mbed-os/projects)
* [Security](/ARMmbed/mbed-os/security)
* [Insights](/ARMmbed/mbed-os/pulse)

# Out of range memory access in MbedOS CoAP library parser - token length not validated¬†#12948

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Out of range memory access in MbedOS CoAP library parser - token length not validated](#top)#12948Copy linkLabels[type: bug](https://github.com/ARMmbed/mbed-os/issues?q=state%3Aopen%20label%3A%22type%3A%20bug%22)![@mjurczak](https://avatars.githubusercontent.com/u/9540275?u=c8ed5071ca8020098fdd9c01e58b807398a7bbe2&v=4&size=80)
## Description

![@mjurczak](https://avatars.githubusercontent.com/u/9540275?u=c8ed5071ca8020098fdd9c01e58b807398a7bbe2&v=4&size=48)[mjurczak](https://github.com/mjurczak)opened [on May 8, 2020](https://github.com/ARMmbed/mbed-os/issues/12948#issue-614898715)
### Description of defect

**References:**

<https://github.com/ARMmbed/mbed-os/tree/mbed-os-5.15.3/features/frameworks/mbed-coap>

<https://github.com/ARMmbed/mbed-coap/tree/v5.1.5>

**File:**

[sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c)

**Analysis:**

If a packet with declared token length larger than actually provided

is parsed, read out of the provided input buffer boundaries may occur.

Invalid memory access may occur in sn\_coap\_protocol\_malloc\_copy() as there is no check to verify if the arguments are within input buffer boundaries:

[mbed-os/features/frameworks/mbed-coap/source/sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c#L279-L288)

Lines 279 to 288
in
[b6370b4](/ARMmbed/mbed-os/commit/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3)

|  | /\* Parse token, if exists \*/ |
| --- | --- |
|  | dst\_coap\_msg\_ptr->token\_len = \*packet\_data\_start\_ptr & COAP\_HEADER\_TOKEN\_LENGTH\_MASK; |
|  |  |
|  | if (dst\_coap\_msg\_ptr->token\_len) { |
|  | if ((dst\_coap\_msg\_ptr->token\_len > 8) || dst\_coap\_msg\_ptr->token\_ptr) { |
|  | tr\_error("sn\_coap\_parser\_options\_parse - token not valid!"); |
|  | return -1; |
|  | } |
|  |  |
|  | dst\_coap\_msg\_ptr->token\_ptr = sn\_coap\_protocol\_malloc\_copy(handle, \*packet\_data\_pptr, dst\_coap\_msg\_ptr->token\_len); |

**Type:**

* Out-of-bounds Read

**Result:**

* Parsing data out of input bounds
* Possible crash due out-of-bound memory access

**Patch proposal:**

<https://github.com/mjurczak/mbed-coap/tree/bugfix/buffer_read_out_of_bounds>

#### Target(s) affected by this defect ?

* MbedOS mbed-coap library 5.1.5
* MbedOS 5.15.3

#### Toolchain(s) (name and version) displaying this defect ?

N/A

#### What version of Mbed-os are you using (tag or sha) ?

MbedOS 5.15.3

#### What version(s) of tools are you using. List all that apply (E.g. mbed-cli)

N/A

#### How is this defect reproduced ?

Parsing the provided input example input with sn\_coap\_parser() function.

```
#include <stdint.h>
#include <stdlib.h>
#include <stdio.h>
#include "sn_coap_protocol.h"
#include "sn_coap_header.h"

struct coap_s* coapHandle;
coap_version_e coapVersion = COAP_VERSION_1;

void* coap_malloc(uint16_t size){
    return malloc(size);
}

void coap_free(void* addr){
    free(addr);
}

uint8_t coap_tx_cb(uint8_t *arg_a, uint16_t arg_b, sn_nsdl_addr_s *arg_c, void *arg_d){
    return 0;
}

int8_t coap_rx_cb(sn_coap_hdr_s *arg_a, sn_nsdl_addr_s *arg_b, void *arg_c){
    return 0;
}

int main(int argc, const char* argv[])
{
    FILE *fp;
    size_t read_bytes;
    size_t input_size;
    uint8_t *message_buffer;
    if (argc != 2)
    {
       return 1;
    }

    fp = fopen(argv[1], "r");
    if (fp == NULL)
    {
      return 2;
    }

    fseek (fp , 0 , SEEK_END);
    input_size = ftell(fp);
    rewind (fp);

    if (input_size > 65527)
    {
      return 3;
    }

    message_buffer = malloc(input_size);
    read_bytes = fread(message_buffer, 1, input_size, fp);
    fclose(fp);
    coapHandle = sn_coap_protocol_init(&coap_malloc, &coap_free, &coap_tx_cb, &coap_rx_cb);
    sn_coap_hdr_s* parsed = sn_coap_parser(coapHandle, read_bytes, message_buffer, &coapVersion);
    sn_coap_parser_release_allocated_coap_msg_mem(coapHandle, parsed);
    free(message_buffer);

    return 0;
}
```

[sn\_coap\_parser.c:token\_overflow.log](https://github.com/ARMmbed/mbed-os/files/4600700/sn_coap_parser.c.token_overflow.log)

üëç1
## Metadata

### Assignees

No one assigned

### Labels

[type: bug](https://github.com/ARMmbed/mbed-os/issues?q=state%3Aopen%20label%3A%22type%3A%20bug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_dae68d1b_20250119_141826.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FARMmbed%2Fmbed-os%2Fissues%2F12925)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FARMmbed%2Fmbed-os%2Fissues%2F12925)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=ARMmbed%2Fmbed-os)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ARMmbed](/ARMmbed)
/
**[mbed-os](/ARMmbed/mbed-os)**
Public

* [Notifications](/login?return_to=%2FARMmbed%2Fmbed-os) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2FARMmbed%2Fmbed-os)
* [Star
   4.7k](/login?return_to=%2FARMmbed%2Fmbed-os)

* [Code](/ARMmbed/mbed-os)
* [Issues
  195](/ARMmbed/mbed-os/issues)
* [Pull requests
  11](/ARMmbed/mbed-os/pulls)
* [Actions](/ARMmbed/mbed-os/actions)
* [Projects
  0](/ARMmbed/mbed-os/projects)
* [Security](/ARMmbed/mbed-os/security)
* [Insights](/ARMmbed/mbed-os/pulse)

Additional navigation options

* [Code](/ARMmbed/mbed-os)
* [Issues](/ARMmbed/mbed-os/issues)
* [Pull requests](/ARMmbed/mbed-os/pulls)
* [Actions](/ARMmbed/mbed-os/actions)
* [Projects](/ARMmbed/mbed-os/projects)
* [Security](/ARMmbed/mbed-os/security)
* [Insights](/ARMmbed/mbed-os/pulse)

# Out of range memory access in MbedOS CoAP library parser¬†#12925

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Out of range memory access in MbedOS CoAP library parser](#top)#12925Copy linkLabels[type: bug](https://github.com/ARMmbed/mbed-os/issues?q=state%3Aopen%20label%3A%22type%3A%20bug%22)![@mjurczak](https://avatars.githubusercontent.com/u/9540275?u=c8ed5071ca8020098fdd9c01e58b807398a7bbe2&v=4&size=80)
## Description

![@mjurczak](https://avatars.githubusercontent.com/u/9540275?u=c8ed5071ca8020098fdd9c01e58b807398a7bbe2&v=4&size=48)[mjurczak](https://github.com/mjurczak)opened [on May 5, 2020](https://github.com/ARMmbed/mbed-os/issues/12925#issue-612891401)
### Description of defect

**References:**

<https://github.com/ARMmbed/mbed-os/tree/mbed-os-5.15.3/features/frameworks/mbed-coap>

<https://github.com/ARMmbed/mbed-coap/tree/v5.1.5>

**File:**

[sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c)

```
Example Trace:
    #0  sn_coap_parser_options_parse_uint()
        sn_coap_parser.c:257
    #1  sn_coap_parser_options_parse()
        sn_coap_parser.c:531
    #2  sn_coap_parser()
        sn_coap_parser.c:161

```

**Analysis:**

If a packet with option delta lower than 13 is parsed, the remaning message length is incorrectly calculated in the line:

[mbed-os/features/frameworks/mbed-coap/source/sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c#L329)

Line 329
in
[b6370b4](/ARMmbed/mbed-os/commit/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3)

|  | message\_left = packet\_len - ((\*packet\_data\_pptr) - packet\_data\_start\_ptr); |
| --- | --- |

The packet data pointer is not incremented prior to the remaining message length calculation and therefore it does not account for the option byte. This allows a malformed message with not option value following to pass through message length check in the line:

[mbed-os/features/frameworks/mbed-coap/source/sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c#L331-L335)

Lines 331 to 335
in
[b6370b4](/ARMmbed/mbed-os/commit/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3)

|  | if (message\_left == 0){ |
| --- | --- |
|  | /\* packet\_data\_pptr would overflow! \*/ |
|  | tr\_error("sn\_coap\_parser\_options\_parse - \*\*packet\_data\_pptr overflow !"); |
|  | return -1; |
|  | } |

For short options length the remaining message length is unchanged after option lengh processing:

[mbed-os/features/frameworks/mbed-coap/source/sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c#L361)

Line 361
in
[b6370b4](/ARMmbed/mbed-os/commit/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3)

|  | message\_left = packet\_len - (\*packet\_data\_pptr - packet\_data\_start\_ptr); |
| --- | --- |

Allowing to pass throught final message length check:

[mbed-os/features/frameworks/mbed-coap/source/sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c#L391-L395)

Lines 391 to 395
in
[b6370b4](/ARMmbed/mbed-os/commit/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3)

|  | if (message\_left < option\_len){ |
| --- | --- |
|  | /\* packet\_data\_pptr would overflow! \*/ |
|  | tr\_error("sn\_coap\_parser\_options\_parse - \*\*packet\_data\_pptr would overflow when parsing options!"); |
|  | return -1; |
|  | } |

In option processing code the packet data pointer is incremented beyond the input buffer boundary and passed for further processing, e.g. in:

[mbed-os/features/frameworks/mbed-coap/source/sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c#L529)

Line 529
in
[b6370b4](/ARMmbed/mbed-os/commit/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3)

|  | (\*packet\_data\_pptr)++; |
| --- | --- |

The invalid pointer is then accessed by functions called from option processing code, e.g. in:

[mbed-os/features/frameworks/mbed-coap/source/sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c#L257)

Line 257
in
[b6370b4](/ARMmbed/mbed-os/commit/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3)

|  | value |= \*(\*packet\_data\_pptr)++; |
| --- | --- |

**Type:**

* Integer Overflow or Wraparound
* Out-of-bounds Read

**Result:**

* Parsing data out of input bounds
* Possible crash due out-of-bound memory access

#### Target(s) affected by this defect ?

* MbedOS mbed-coap library 5.1.5
* MbedOS 5.15.3

#### Toolchain(s) (name and version) displaying this defect ?

N/A

#### What version of Mbed-os are you using (tag or sha) ?

MbedOS 5.15.3

#### What version(s) of tools are you using. List all that apply (E.g. mbed-cli)

N/A

#### How is this defect reproduced ?

Parsing the provided input example input with sn\_coap\_parser() function.

```
#include <stdint.h>
#include <stdlib.h>
#include <stdio.h>
#include "sn_coap_protocol.h"
#include "sn_coap_header.h"

struct coap_s* coapHandle;
coap_version_e coapVersion = COAP_VERSION_1;

void* coap_malloc(uint16_t size){
    return malloc(size);
}

void coap_free(void* addr){
    free(addr);
}

uint8_t coap_tx_cb(uint8_t *arg_a, uint16_t arg_b, sn_nsdl_addr_s *arg_c, void *arg_d){
    return 0;
}

int8_t coap_rx_cb(sn_coap_hdr_s *arg_a, sn_nsdl_addr_s *arg_b, void *arg_c){
    return 0;
}

int main(int argc, const char* argv[])
{
    FILE *fp;
    size_t read_bytes;
    size_t input_size;
    uint8_t *message_buffer;
    if (argc != 2)
    {
       return 1;
    }

    fp = fopen(argv[1], "r");
    if (fp == NULL)
    {
      return 2;
    }

    fseek (fp , 0 , SEEK_END);
    input_size = ftell(fp);
    rewind (fp);

    if (input_size > 65527)
    {
      return 3;
    }

    message_buffer = malloc(input_size);
    read_bytes = fread(message_buffer, 1, input_size, fp);
    fclose(fp);
    coapHandle = sn_coap_protocol_init(&coap_malloc, &coap_free, &coap_tx_cb, &coap_rx_cb);
    sn_coap_hdr_s* parsed = sn_coap_parser(coapHandle, read_bytes, message_buffer, &coapVersion);
    sn_coap_parser_release_allocated_coap_msg_mem(coapHandle, parsed);
    free(message_buffer);

    return 0;
}
```

[sn\_coap\_parser.c:257\_\_read\_buffer\_overflow.log](https://github.com/ARMmbed/mbed-os/files/4583581/sn_coap_parser.c.257__read_buffer_overflow.log)

## Metadata

### Assignees

No one assigned

### Labels

[type: bug](https://github.com/ARMmbed/mbed-os/issues?q=state%3Aopen%20label%3A%22type%3A%20bug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_a20c262b_20250119_141826.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-ghhj-m687-4jqx)

**CVE-2020-12884**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-ghhj-m687-4jqx)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2020-12884](/advisories/GHSA-ghhj-m687-4jqx)

## A buffer over-read was discovered in the CoAP library in...

Moderate severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
‚Ä¢
Updated Jan 29, 2023

## Package

No package listed‚Äî
[Suggest a package](/advisories/GHSA-ghhj-m687-4jqx/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

A buffer over-read was discovered in the CoAP library in Arm Mbed OS 5.15.3. The CoAP parser is responsible for parsing received CoAP packets. The function sn\_coap\_parser\_options\_parse\_multiple\_options() parses CoAP options that may occur multiple consecutive times in a single packet. While processing the options, packet\_data\_pptr is accessed after being incremented by option\_len without a prior out-of-bounds memory check. The temp\_parsed\_uri\_query\_ptr is validated for a correct range, but the range valid for temp\_parsed\_uri\_query\_ptr is derived from the amount of allocated heap memory, not the actual input size. Therefore the check of temp\_parsed\_uri\_query\_ptr may be insufficient for safe access to the area pointed to by packet\_data\_pptr. As a result, access to a memory area outside of the intended boundary of the packet buffer is made.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-12884>
* [ARMmbed/mbed-os#12928](https://github.com/ARMmbed/mbed-os/issues/12928)
* [PelionIoT/mbed-coap#116](https://github.com/PelionIoT/mbed-coap/pull/116)

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-12884)
Jun 18, 2020

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Jan 29, 2023

### Severity

Moderate

### [EPSS score](https://www.first.org/epss/user-guide)

0.235%
 (61st percentile)

### Weaknesses

No CWEs

### CVE ID

CVE-2020-12884

### GHSA ID

GHSA-ghhj-m687-4jqx

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-ghhj-m687-4jqx/improve).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_77b12a19_20250119_141825.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-8v45-9mw2-ffmm)

**CVE-2020-12886**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-8v45-9mw2-ffmm)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2020-12886](/advisories/GHSA-8v45-9mw2-ffmm)

## A buffer over-read was discovered in the CoAP library in...

Moderate severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
‚Ä¢
Updated Jan 29, 2023

## Package

No package listed‚Äî
[Suggest a package](/advisories/GHSA-8v45-9mw2-ffmm/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

A buffer over-read was discovered in the CoAP library in Arm Mbed OS 5.15.3. The CoAP parser is responsible for parsing received CoAP packets. The function sn\_coap\_parser\_options\_parse() parses the CoAP packet header starting from the message token. The length of the token in the received message is provided in the first byte parsed by the sn\_coap\_parser\_options\_parse() function. The length encoded in the message is not validated against the actual input buffer length before accessing the token. As a result, memory access outside of the intended boundary of the buffer may occur.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-12886>
* [ARMmbed/mbed-os#12948](https://github.com/ARMmbed/mbed-os/issues/12948)
* [PelionIoT/mbed-coap#116](https://github.com/PelionIoT/mbed-coap/pull/116)

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-12886)
Jun 18, 2020

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Jan 29, 2023

### Severity

Moderate

### [EPSS score](https://www.first.org/epss/user-guide)

0.235%
 (61st percentile)

### Weaknesses

No CWEs

### CVE ID

CVE-2020-12886

### GHSA ID

GHSA-8v45-9mw2-ffmm

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-8v45-9mw2-ffmm/improve).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_ae1f95ad_20250119_141825.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisor)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisor)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@advisor](https://avatars.githubusercontent.com/u/693679?s=64&v=4)

**advisor**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisor)

[Overview](/advisor)
[Repositories
1](/advisor?tab=repositories)
[Projects
0](/advisor?tab=projects)
[Packages
0](/advisor?tab=packages)
[Stars
4](/advisor?tab=stars)

More

* [Overview](/advisor)
* [Repositories](/advisor?tab=repositories)
* [Projects](/advisor?tab=projects)
* [Packages](/advisor?tab=packages)
* [Stars](/advisor?tab=stars)

![@advisor](https://avatars.githubusercontent.com/u/693679?s=64&v=4)

**advisor**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisor)

[![View advisor's full-sized avatar](https://avatars.githubusercontent.com/u/693679?v=4)](https://avatars.githubusercontent.com/u/693679?v=4)

# advisor

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisor)

[1
follower](https://github.com/advisor?tab=followers) ¬∑ [0
following](https://github.com/advisor?tab=following)

Block or Report

# Block or report advisor

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user‚Äôs behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=advisor+%28user%29)

[Overview](/advisor)
[Repositories
1](/advisor?tab=repositories)
[Projects
0](/advisor?tab=projects)
[Packages
0](/advisor?tab=packages)
[Stars
4](/advisor?tab=stars)

More

* [Overview](/advisor)
* [Repositories](/advisor?tab=repositories)
* [Projects](/advisor?tab=projects)
* [Packages](/advisor?tab=packages)
* [Stars](/advisor?tab=stars)

## Popular repositories Loading

1. [helpmetravel.net](/advisor/helpmetravel.net) helpmetravel.net
   Public

   a repo for sikmple web site

   Ruby

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_bf819bdd_20250119_141825.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FARMmbed%2Fmbed-os%2Fissues%2F12926)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FARMmbed%2Fmbed-os%2Fissues%2F12926)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=ARMmbed%2Fmbed-os)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ARMmbed](/ARMmbed)
/
**[mbed-os](/ARMmbed/mbed-os)**
Public

* [Notifications](/login?return_to=%2FARMmbed%2Fmbed-os) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2FARMmbed%2Fmbed-os)
* [Star
   4.7k](/login?return_to=%2FARMmbed%2Fmbed-os)

* [Code](/ARMmbed/mbed-os)
* [Issues
  195](/ARMmbed/mbed-os/issues)
* [Pull requests
  11](/ARMmbed/mbed-os/pulls)
* [Actions](/ARMmbed/mbed-os/actions)
* [Projects
  0](/ARMmbed/mbed-os/projects)
* [Security](/ARMmbed/mbed-os/security)
* [Insights](/ARMmbed/mbed-os/pulse)

Additional navigation options

* [Code](/ARMmbed/mbed-os)
* [Issues](/ARMmbed/mbed-os/issues)
* [Pull requests](/ARMmbed/mbed-os/pulls)
* [Actions](/ARMmbed/mbed-os/actions)
* [Projects](/ARMmbed/mbed-os/projects)
* [Security](/ARMmbed/mbed-os/security)
* [Insights](/ARMmbed/mbed-os/pulse)

# Out of range memory access in MbedOS CoAP library parser - option number¬†#12926

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Out of range memory access in MbedOS CoAP library parser - option number](#top)#12926Copy linkLabels[type: bug](https://github.com/ARMmbed/mbed-os/issues?q=state%3Aopen%20label%3A%22type%3A%20bug%22)![@mjurczak](https://avatars.githubusercontent.com/u/9540275?u=c8ed5071ca8020098fdd9c01e58b807398a7bbe2&v=4&size=80)
## Description

![@mjurczak](https://avatars.githubusercontent.com/u/9540275?u=c8ed5071ca8020098fdd9c01e58b807398a7bbe2&v=4&size=48)[mjurczak](https://github.com/mjurczak)opened [on May 5, 2020](https://github.com/ARMmbed/mbed-os/issues/12926#issue-612893067)
### Description of defect

**References:**

<https://github.com/ARMmbed/mbed-os/tree/mbed-os-5.15.3/features/frameworks/mbed-coap>

<https://github.com/ARMmbed/mbed-coap/tree/v5.1.5>

**File:**

[sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c)

```
Example Traces:
    #0  sn_coap_parser_options_parse()
        sn_coap_parser.c:310
    #1  sn_coap_parser()
        sn_coap_parser.c:161

    #0  sn_coap_parser_options_parse()
        sn_coap_parser.c:314
    #1  sn_coap_parser()
        sn_coap_parser.c:161

```

**Analysis:**

If a packet with option delta equal to 13 or 14 is parsed with no extended option delta following, access beyond the packet data buffer is made due to insufficient message length checks:

[mbed-os/features/frameworks/mbed-coap/source/sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c#L309-L322)

Lines 309 to 322
in
[b6370b4](/ARMmbed/mbed-os/commit/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3)

|  | if (option\_number == 13) { |
| --- | --- |
|  | option\_number = \*(\*packet\_data\_pptr + 1) + 13; |
|  | (\*packet\_data\_pptr)++; |
|  | } else if (option\_number == 14) { |
|  | if (message\_left >= 2){ |
|  | option\_number = \*(\*packet\_data\_pptr + 2); |
|  | option\_number += (\*(\*packet\_data\_pptr + 1) << 8) + 269; |
|  | (\*packet\_data\_pptr) += 2; |
|  | } else { |
|  | /\* packet\_data\_pptr would overflow! \*/ |
|  | tr\_error("sn\_coap\_parser\_options\_parse - \*\*packet\_data\_pptr overflow !"); |
|  | return -1; |
|  | } |
|  | } |

Before option number processing the message left bytes is calculated including the option delta/option length byte:

[mbed-os/features/frameworks/mbed-coap/source/sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c#L298)

Line 298
in
[b6370b4](/ARMmbed/mbed-os/commit/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3)

|  | message\_left = packet\_len - ((\*packet\_data\_pptr) - packet\_data\_start\_ptr); |
| --- | --- |

In case of option delta set to 13, the extended delta byte is accessed in the following line without prior check for buffer out-of-bound index:

[mbed-os/features/frameworks/mbed-coap/source/sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c#L310)

Line 310
in
[b6370b4](/ARMmbed/mbed-os/commit/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3)

|  | option\_number = \*(\*packet\_data\_pptr + 1) + 13; |
| --- | --- |

In case of option delta set to 14, the extended delta bytes are accessed with insufficient index check. As the message\_left variable includes the option delta byte, the check will pass malformed frame if there is only one extended delta byte following:

[mbed-os/features/frameworks/mbed-coap/source/sn\_coap\_parser.c](https://github.com/ARMmbed/mbed-os/blob/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3/features/frameworks/mbed-coap/source/sn_coap_parser.c#L312-L315)

Lines 312 to 315
in
[b6370b4](/ARMmbed/mbed-os/commit/b6370b4c37f3d4665ed1cdcb1afea85396bba1b3)

|  | } else if (option\_number == 14) { |
| --- | --- |
|  | if (message\_left >= 2){ |
|  | option\_number = \*(\*packet\_data\_pptr + 2); |
|  | option\_number += (\*(\*packet\_data\_pptr + 1) << 8) + 269; |

**Type:**

* Integer Overflow or Wraparound
* Out-of-bounds Read

**Result:**

* Parsing data out of input bounds
* Possible crash due out-of-bound memory access

#### Target(s) affected by this defect ?

* MbedOS mbed-coap library 5.1.5
* MbedOS 5.15.3

#### Toolchain(s) (name and version) displaying this defect ?

N/A

#### What version of Mbed-os are you using (tag or sha) ?

MbedOS 5.15.3

#### What version(s) of tools are you using. List all that apply (E.g. mbed-cli)

N/A

#### How is this defect reproduced ?

Parsing the provided input example input with sn\_coap\_parser() function.

```
#include <stdint.h>
#include <stdlib.h>
#include <stdio.h>
#include "sn_coap_protocol.h"
#include "sn_coap_header.h"

struct coap_s* coapHandle;
coap_version_e coapVersion = COAP_VERSION_1;

void* coap_malloc(uint16_t size){
    return malloc(size);
}

void coap_free(void* addr){
    free(addr);
}

uint8_t coap_tx_cb(uint8_t *arg_a, uint16_t arg_b, sn_nsdl_addr_s *arg_c, void *arg_d){
    return 0;
}

int8_t coap_rx_cb(sn_coap_hdr_s *arg_a, sn_nsdl_addr_s *arg_b, void *arg_c){
    return 0;
}

int main(int argc, const char* argv[])
{
    FILE *fp;
    size_t read_bytes;
    size_t input_size;
    uint8_t *message_buffer;
    if (argc != 2)
    {
       return 1;
    }

    fp = fopen(argv[1], "r");
    if (fp == NULL)
    {
      return 2;
    }

    fseek (fp , 0 , SEEK_END);
    input_size = ftell(fp);
    rewind (fp);

    if (input_size > 65527)
    {
      return 3;
    }

    message_buffer = malloc(input_size);
    read_bytes = fread(message_buffer, 1, input_size, fp);
    fclose(fp);
    coapHandle = sn_coap_protocol_init(&coap_malloc, &coap_free, &coap_tx_cb, &coap_rx_cb);
    sn_coap_hdr_s* parsed = sn_coap_parser(coapHandle, read_bytes, message_buffer, &coapVersion);
    sn_coap_parser_release_allocated_coap_msg_mem(coapHandle, parsed);
    free(message_buffer);

    return 0;
}
```

[sn\_coap\_parser.c:310\_\_read\_buffer\_overflow\_minimal.log](https://github.com/ARMmbed/mbed-os/files/4583591/sn_coap_parser.c.310__read_buffer_overflow_minimal.log)

[sn\_coap\_parser.c:314\_\_read\_buffer\_overflow\_minimal.log](https://github.com/ARMmbed/mbed-os/files/4583592/sn_coap_parser.c.314__read_buffer_overflow_minimal.log)

## Metadata

### Assignees

No one assigned

### Labels

[type: bug](https://github.com/ARMmbed/mbed-os/issues?q=state%3Aopen%20label%3A%22type%3A%20bug%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_82c9e6fe_20250119_141827.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-x723-g4p2-w8m5)

**CVE-2020-12883**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-x723-g4p2-w8m5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2020-12883](/advisories/GHSA-x723-g4p2-w8m5)

## Buffer over-reads were discovered in the CoAP library in...

Moderate severity

Unreviewed

Published
May 24, 2022
to the GitHub Advisory Database
‚Ä¢
Updated Jan 29, 2023

## Package

No package listed‚Äî
[Suggest a package](/advisories/GHSA-x723-g4p2-w8m5/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

Buffer over-reads were discovered in the CoAP library in Arm Mbed OS 5.15.3. The CoAP parser is responsible for parsing received CoAP packets. The function sn\_coap\_parser\_options\_parse() parses CoAP input linearly using a while loop. Once an option is parsed in a loop, the current point (\*packet\_data\_pptr) is increased correspondingly. The pointer is restricted by the size of the received buffer, as well as by the option delta and option length bytes. The actual input packet length is not verified against the number of bytes read when processing the option extended delta and the option extended length. Moreover, the calculation of the message\_left variable, in the case of non-extended option deltas, is incorrect and indicates more data left for processing than provided in the function input. All of these lead to heap-based or stack-based memory location read access that is outside of the intended boundary of the buffer. Depending on the platform-specific memory management mechanisms, it can lead to processing of unintended inputs or system memory access violation errors.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2020-12883>
* [ARMmbed/mbed-os#12925](https://github.com/ARMmbed/mbed-os/issues/12925)
* [ARMmbed/mbed-os#12926](https://github.com/ARMmbed/mbed-os/issues/12926)
* [ARMmbed/mbed-os#12927](https://github.com/ARMmbed/mbed-os/issues/12927)
* [PelionIoT/mbed-coap#116](https://github.com/PelionIoT/mbed-coap/pull/116)

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2020-12883)
Jun 18, 2020

Published to the GitHub Advisory Database
May 24, 2022

Last updated
Jan 29, 2023

### Severity

Moderate

### [EPSS score](https://www.first.org/epss/user-guide)

0.557%
 (78th percentile)

### Weaknesses

[CWE-119](/advisories?query=cwe%3A119)

### CVE ID

CVE-2020-12883

### GHSA ID

GHSA-x723-g4p2-w8m5

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-x723-g4p2-w8m5/improve).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


