=== Content from cert.vde.com_672a49d1_20250119_121455.html ===


* English
* Deutsch

Everything
Advisories

Blog posts

Bulletins

Cves

Pages

Toggle navigation

Everything
Advisories

Blog posts

Bulletins

Cves

Pages

* |
* [News](/en/blog/)
* |
* [Advisories](/en/advisories/)
* |
* [CNA](/en/cna/)
* |
* [Bulletins](/en/bulletins/)
* |
* [Events](/en/events/)
* |
* [More](/en/more/)
  + [Report a Vulnerability](/en/more/report-a-vulnerability/)
  + [Knowledgebase](/en/more/knowledgebase/)
    - [Guides](/en/more/knowledgebase/psirt-guides/)
    - [Reading Room](/en/more/knowledgebase/reading-room/)
  + [About us](/en/more/certvde/)
    - [RFC2350](/en/more/certvde/rfc2350/)
    - [Disclosure Policy](/en/more/certvde/disclosure-policy/)
    - [Guidelines and Compliance](/en/more/certvde/guidelines-and-compliance/)
    - [Contact](/en/more/certvde/contact/)
  + [Our Partners](/en/more/our-partners/)

* [← VDE-2021-012](/en/advisories/VDE-2021-012/ "MB connect line: multiple products partially affected by DNSpooq")
* [VDE-2021-016 →](/en/advisories/VDE-2021-016/ "Weidmueller: Accidentally open network port in u-controls and IoT-Gateways")

2021-04-27 10:08 (CEST)
VDE-2020-051

### Beckhoff: DoS-Vulnerability for TwinCAT OPC UA Server and IPC Diagnostics UA Server (Update A)

Share:
Email |
[Twitter](https://twitter.com/intent/tweet?url=https://cert.vde.com/en/advisories/VDE-2020-051/&text=CERT@VDE has released a new advisory: VDE-2020-051: Beckhoff%3A%20DoS-Vulnerability%20for%20TwinCAT%20OPC%20UA%20Server%20and%20IPC%20Diagnostics%20UA%20Server%20%28Update%20A%29)

#### ID

VDE-2020-051

#### Published

2021-04-27 10:08 (CEST)

#### Last update

2022-02-11 08:37 (CET)

#### Vendor(s)

Beckhoff Automation GmbH & Co. KG

#### Product(s)

| Article No° | Product Name | Affected Version(s) |
| --- | --- | --- |
|  | IPC Diagnostics UA Server | <= 3.1.0.1 |
|  | TwinCAT OPC UA Server | <= 2.3.0.12 |

#### Summary

Some TwinCAT OPC UA Server and IPC Diagnostics UA Server versions from Beckhoff Automation GmbH & Co. KG are vulnerable to denial of service attacks. The attacker needs to send several specifically crafted requests to the running OPC UA server. After some of these requests the OPC UA server is no longer responsive to any client. This is without effect to the real-time functionality of IPCs.

**UPDATE A - 11.05.2021**

Please note that some hardware products from Beckhoff are shipped with a TwinCAT OPC UA Server pre-installed. In some cases the server is enabled by default.

IPC Diagnostics UA Server (contained in Beckhoff’s Windows images)

* server versions up to and including 3.1.0.1 are affected
* Please note that IPC products from Beckhoff are shipped with an IPC Diagnostics UA Server pre-installed. In all cases the server is disabled by default.

The version numbers named above always refer to the version number which is accessible via OPC UA at the server via the standard OPC UA node /Objects/Server/ServerStatus/BuildInfo/SoftwareVersion and on Windows also as the file property "File version" of the file TcOpcUaServer.exe for TwinCAT OPC UA Server respectively the file DevMgrSvr-UA.exe for IPC Diagnostics UA Server.

**UPDATE A - 11.05.2021**

Please note that IPC products from Beckhoff are shipped with an IPC Diagnostics UA Server pre-installed. While on Windows CE it is disabled by default all other Windows images have it enabled by default.

---

#### CVE ID

[CVE-2020-12526](https://nvd.nist.gov/vuln/detail/CVE-2020-12526)

#### Last Update:

July 7, 2021, 10:08 a.m.

#### Severity

5.3

[(CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L)](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L&version=3.1)

#### Weakness

Improper Input Validation [(CWE-20)](https://cwe.mitre.org/data/definitions/20.html)

#### Summary

TwinCAT OPC UA Server in versions up to 2.3.0.12 and IPC Diagnostics UA Server in versions up to 3.1.0.1 from Beckhoff Automation GmbH & Co. KG are vulnerable to denial of service attacks. The attacker needs to send several specifically crafted requests to the running OPC UA server. After some of these requests the OPC UA server is no longer responsive to any client. This is without effect to the real-time functionality of IPCs.

#### Details

[nvd.nist.gov](https://nvd.nist.gov/vuln/detail/CVE-2020-12526)

---

#### Impact

An attacker who can establish a TCP connection to one of the affected OPC UA servers can send a series of specifically crafted data packets to it. By repeating this several times this will provoke a stack overflow at the OPC UA server which then stops and does not recover until restarted by an administrator.

Since TCP connections are routable there attacker may perform the exploit from remote if there is no firewall set up which limits the access to the TCP which the OPC UA server is listening on. The attacker does not need to have a local account at the device or OPC UA server nor it any authentication required for the attack.

Please note: The availability impact within the CVSS vector has been rated low because the TwinCAT OPC UA Server and IPC Diagnostics UA Server are seen as less-essential functional parts of an Industrial PC (IPC) image, not as its core functionality. The critical functionality of the IPC is its real-time runtime. The TwinCAT OPC UA Server is a communication interface. The IPC Diagnostics UA Server is for the hardware diagnostics functionality of the IPC. The main function of the IPC remains unaffected during the attack.

#### Solution

**Mitigation**
Consider disabling the IPC Diagnostics Server by stopping and disabling the corresponding Windows service or service. For example this can be achieved with the following PowerShell commands:

`Stop-Service -Force -Name DevMgrSvr-UA`
`Set-Service -Name DevMgrSvr-UA -StartupType Disabled`

Alternatively consider limiting access to the TCP port the OPC UA server is listening on. This can happen with a dedicated firewall appliance which sits in front of an affected device. Alternatively at the device the Windows firewall can be configured to limit access to the TCP port. Further guidance is provided within the "Security Guide IPC" from Beckhoff which is accessible at <https://www.beckhoff.com/secguide>.

**Solution**
For devices running Windows but not Windows CE or TwinCAT/BSD please get a recent version of the OPC UA servers through the conventional ways and update your system.

For devices running Windows CE please request a recent image via Beckhoff’s support and apply it to your device.

For the product CX8091 please use firmware version "CX8091\_CE600\_LF\_v356f\_TC211R3\_B2306\_v2" or later which can be downloaded at

<https://download.beckhoff.com/download/software/embPC-Control/CX80x0/CX8091/OPC-update>

Please note that the updated OPC UA server leaves less RAM available to your application on the CX8091.

#### Reported by

Beckhoff Automation thanks Industrial Control Security Laboratory of QI-ANXIN Technology Group Inc. from China for reporting the issue and for support and efforts with the coordinated disclosure. Also Beckhoff Automation thanks CERT@VDE for coordination.

Beckhoffs advisory can be found at <https://download.beckhoff.com/download/Document/product-security/Advisories/advisory-2021-001.pdf>.

## Member of

[![](/static/img/member/cert_verbund.png)](https://www.cert-verbund.de/)

[![](/static/img/member/ti.png)](https://www.trusted-introducer.org/directory/teams/vde.html)

[![](/static/img/member/allianz_fcs.png)](https://www.allianz-fuer-cybersicherheit.de/)

[![](/static/img/member/ama.png)](https://www.ama-sensorik.de/)

---

[Contact](/more/certvde/contact) |
[Imprint](https://www.vde.com/en/legal-notice)
| [Privacy Statement](/more/certvde/privacy-statement) | [Data Protection Notice](/more/certvde/data-protection-notice)



=== Content from download.beckhoff.com_6046c6aa_20250119_121456.html ===
Beckhoff Security Advisory 2021-001:

DoS-Vulnerability for TwinCAT OPC UA Server and IPC Diagnostics UA Server

Publication Date
Last Update
Current Version
CVE-ID
VDE-ID
CVSS 3.1
Weakness Enumeration

04/26/2021 (April 26th 2021)
05/10/2021 (May 10th 2021)
1.2
CVE-2020-12526
VDE-2020-051
5.3 Medium (AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L)
CWE-20: Improper Input Validation

Summary

Some TwinCAT OPC UA Server and IPC Diagnostics UA Server versions from Beckhoff Automation GmbH &
Co. KG are vulnerable to denial of service attacks. The attacker needs to send several specifically crafted requests
to the running OPC UA server. After some of these requests the OPC UA server is no longer responsive to any
client. This is without effect to the real-time functionality of IPCs.

Appearance

•  TwinCAT OPC UA Server (contained within TF6100 OPC UA)

o  server versions up to and including 2.3.0.12 are affected

▪

these are included within TF6100 versions up to and including 3.3.18

o  Please note that some hardware products from Beckhoff are shipped with a TwinCAT OPC UA

Server pre-installed. In some cases the server is enabled by default.

•

IPC Diagnostics UA Server (contained in Beckhoff’s Windows images)

o  server versions up to and including 3.1.0.1 are affected

o  Please note that IPC products from Beckhoff are shipped with an IPC Diagnostics UA Server
pre-installed. While on Windows CE it is disabled by default all other Windows images have it
enabled by default.

The version numbers named above always refer to the version number which is accessible via OPC UA at the
server via the standard OPC UA node /Objects/Server/ServerStatus/BuildInfo/SoftwareVersion and on Windows
also as the file property “File version” of the file TcOpcUaServer.exe for TwinCAT OPC UA Server respectively
the file DevMgrSvr-UA.exe for IPC Diagnostics UA Server.

Description

An attacker who can establish a TCP connection to one of the affected OPC UA servers can send a series of
specifically crafted data packets to it. By repeating this several times this will provoke a stack overflow at the OPC
UA server which then stops and does not recover until restarted by an administrator.

Since TCP connections are routable there attacker may perform the exploit from remote if there is no firewall set
up which limits the access to the TCP which the OPC UA server is listening on. The attacker does not need to
have a local account at the device or OPC UA server nor it any authentication required for the attack.

Please note: The availability impact within the CVSS vector has been rated low because the TwinCAT OPC UA
Server and IPC Diagnostics UA Server are seen as less-essential functional parts of an Industrial PC (IPC) image,
not as its core functionality. The critical functionality of the IPC is its real-time runtime. The TwinCAT OPC UA
Server is a communication interface. The IPC Diagnostics UA Server is for the hardware diagnostics functionality
of the IPC. The main function of the IPC remains unaffected during the attack.

Mitigation

Consider disabling the IPC Diagnostics Server by stopping and disabling the corresponding Windows service or
service. For example this can be achieved with the following PowerShell commands:

                   Beckhoff Automation GmbH & Co. KG, Hülshorstweg 20, 33415 Verl   Tel: 05246 / 963-0, Fax 05246/ 963-198

Stop-Service -Force -Name DevMgrSvr-UA
Set-Service -Name DevMgrSvr-UA -StartupType Disabled

Alternatively consider limiting access to the TCP port the OPC UA server is listening on. This can happen with a
dedicated  firewall  appliance  which  sits  in  front  of  an  affected  device.  Alternatively  at  the  device  the  Windows
firewall can be configured to limit access to the TCP port. Further guidance is provided within the “Security Guide
IPC” from Beckhoff which is accessible at https://www.beckhoff.com/secguide .

Solution

For devices running Windows but not Windows CE or TwinCAT/BSD please get a recent version of the OPC UA
servers through the conventional ways and update your system.

For devices running Windows CE please request a recent image via Beckhoff’s support and apply it to your device.
For the product CX8091 please use firmware version “CX8091_CE600_LF_v356f_TC211R3_B2306_v2” or later
which can be downloaded at

https://download.beckhoff.com/download/software/embPC-Control/CX80x0/CX8091/OPC-update

Please note that the updated OPC UA server leaves less RAM available to your application on the CX8091.

Acknowledgement

Beckhoff Automation thanks Industrial Control Security Laboratory of QI-ANXIN Technology Group Inc. from
China for reporting the issue and for support and efforts with the coordinated disclosure. Also Beckhoff
Automation thanks CERT@VDE for coordination.

Reporting vulnerabilities

Beckhoff Automation welcomes responsibly coordinated reports of vulnerabilities and Beckhoff will collaborate
with reporting parties to fix vulnerabilities or mitigate threats.

Disclaimer

Beckhoff is not responsible for any side effects negatively affecting the real-time capabilities of your TwinCAT
control application possibly caused by updates. Beckhoff offers updated images with qualified performance for
Beckhoff hardware from time to time. TwinCAT System Manager offers tools which can be of assistance to
verify real-time performance after update. A backup should be created every time before installing an update.
Only administrators or IT experts should perform the backup and update procedure.

References

[1] Additional information about the latest IPC security advisories is provided here:
www.beckhoff.com/secinfo

History

V 1.0
V 1.1
V 1.2

04/26/2021
04/26/2021
05/10/2021

Publication
Added explanation for CVSS and acknowledgement for CERT@VDE
Corrected explanation of default settings for Windows images

                   Beckhoff Automation GmbH & Co. KG, Hülshorstweg 20, 33415 Verl   Tel: 05246 / 963-0, Fax 05246/ 963-198


