=== Content from douevenknow.us_8fc821ff_20250119_140210.html ===

[[Segmentation Fault]](/ "[Segmentation Fault]")

1. 00.
2. 01.
3. 02.

I am a programming and reverse engineering enthusiast who probably keeps going farther than they should.
[Archive](/archive)
[Random](/random)

![Profile Photo](https://64.media.tumblr.com/avatar_19c67fce6734_128.pnj)
Feel free to check out my other work or follow me on social media in the links below.

1. [Questions? Comments? Criticism? All is welcome.](/ask "Ask a question")
2. [RSS Feed](https://douevenknow.us/rss "RSS Feed")
3. [Mobile](/mobile "View mobile version")

[![GitHub](https://static.tumblr.com/ubkenek/Qv0luyv55/github-icon.png)](https://github.com/shinyquagsire23 "GitHub")
[![GooglePlus Icon](https://static.tumblr.com/ubkenek/G6uluz2hj/googleplus-icon.png)](https://plus.google.com/u/1/100105085728881429255 "Google Plus")
[![Twitter Icon](https://static.tumblr.com/ubkenek/wialuyvfa/twitter-icon.png)](http://twitter.com/ShinyQuagsire "Twitter")

[üîã
üì±‚ùÑÔ∏èü•æüîì, an EL1/EL3 coldboot vulnerability affecting 7 years of LG Android devices](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability)

I should probably preface all of this by saying that I‚Äôm not really a security professional in the sense that I don‚Äôt actually do security stuff for a living; I reported this vulnerability in March and gave a 90 day delay on releasing specific details mostly just because that‚Äôs A Thing That Security Researchers Do. Also the vulnerability doesn‚Äôt require user interaction from coldboot so it‚Äôs a bit nasty in that regard. But also this vulnerability sat around for 7 years so it could be argued that, if anything, 90 days is too long.

Anyhow jumping into things, this is a writeup documenting¬†[CVE-2020-12753](https://nvd.nist.gov/vuln/detail/CVE-2020-12753), a bootloader vulnerability affecting most Qualcomm-based LG phones since the Nexus 5, all the way up to the my test device, the LG Stylo 4 Q710 (and 5 Q720), and probably others. While working on the implementation of this vulnerability I thought it was odd how few bootloader vulnerabilities for Android actually get properly documented, and given the sheer spread of affected devices of this particular vuln I thought it‚Äôd be interesting to document it in detail.

**A Quick Primer on the (Qualcomm) Android Boot Process**

The device I‚Äôm working with, the Stylo 4, operates on 2013-2016 variant of Qualcomm‚Äôs boot sequence described at <https://lineageos.org/engineering/Qualcomm-Firmware/>:

![image](https://64.media.tumblr.com/71ccac3e1f7f43ca8f6e546ad38f332c/f8833c921da777cc-3e/s500x750/29fda1846ecf50e3f1ab119058e612ef39c6b0a6.png)

- On power-on, the Primary Bootloader (PBL) initializes DRAM, eMMC, etc and then loads and verifies SBL1 (Secondary Bootloader 1) from eMMC.
- SBL1 then loads and verifies the Trusted Execution Environment (TEE), aboot, and a few other bits and pieces and then jumps to the TEE, in this case Qualcomm‚Äôs Secure Execution Environment (QSEE)
- QSEE sets up secure EL3/EL1 (TrustZone) and jumps down to aboot (non-secure EL1)
- aboot loads and verifies the Linux kernel and jumps to it

Some Android devices allow ‚Äúbootloader unlocking‚Äù, which allows unsigned kernels to be loaded and run. Generally this unlocking occurs via aboot, and the implementation varies from vendor to vendor, however in most cases what happens is that a fastboot command gets sent to the phone to unlock/lock the phone, and as part of [Android‚Äôs Verified Boot](https://source.android.com/security/verifiedboot/boot-flow), the phone‚Äôs storage is wiped on this transition. There‚Äôs also some requirements on user verification so that, in theory, this unlock cannot occur without user interaction.

Additionally, with verified boot enabled, Android will use [dm-verity](https://source.android.com/security/verifiedboot/dm-verity) to verify all files on the root/system partition, and SELinux is run as Enforcing.

**Variants on the Boot Process, added by LG**

In practice, the boot process isn‚Äôt quite so simple: Vendors are able to add modifications to the boot process as they see fit. In LG‚Äôs case, these differences can be summarized as follows:
- Hardware bringup in SBL for charging PMICs, LEDs, and other misc hardware
- Misc logging/debugging modifications
- Additional TEE processes for SIM unlocking, backed by RPMB
- In aboot, vendor-specific fastboot commands (or no fastboot at all in the case of my device), restrictions on unlocking via certificates, verification modifications, additional boot args for Linux, etc
- Vendor-specific recoveries/flashers, LAF in the case of LG

While I initially started in a privesc from within Linux (and got ~close to getting kernel execution), Google has done a lot of work to ensure that vendors can‚Äôt mess up Android security. However, bootloaders have a lot less oversight, so going after these vendor-specific bits of hardware bringup seemed extremely opportune for errors.

**Introducing: raw\_resources**

At an undetermined point in time (likely prior to the Nexus 5 releasing), LG added an ‚Äúimgdata‚Äù partition on eMMC to store boot graphics for Download Mode, fastboot graphics, charging graphics, the unlock graphic and so on. Image data is stored RLE compressed and for each image, metadata for the image width, height, x and y position are specified. The Nexus 5‚Äôs final bootloader image, as far as I can tell, only accesses this partition from aboot; SBL1 is not affected on this device. For the curious, I have a Python3 script which can extract these images at <https://gist.github.com/shinyquagsire23/ba0f6209592d50fb8e4166620228aaa5>.

![image](https://64.media.tumblr.com/7e8708ee47b63eb7270716d2a9175602/f8833c921da777cc-ac/s250x400/37620545d50e53188b44578e25af6f361f71178c.png)![image](https://64.media.tumblr.com/cb2dd3865b7ae70ba4af2950a34fb1fb/f8833c921da777cc-8e/s250x400/f953b7153f1a1631f1b9ff5bc4e59cd61d7a56c9.png)

*A few examples of Nexus 5 imgdata resources*

imgdata later became raw\_resources, and at an undetermined point, the same RLE decompression and metadata interpreting was copied into SBL1 for use in boot paths where the battery has discharged significantly. If the battery is discharged too far, SBL1‚Äôs pm\_sbl\_chg\_check\_weak\_battery\_status will display LGE\_PM\_NO\_CHARGER for boot attempts made without a charger connected, LGE\_PM\_WEAK\_CHARGING\_ON for boot attempts with a charger connected, and LGE\_PM\_NO\_BATERY\_ANI\_\* for boot attempts made without a battery. A script for extracting raw\_resources can be found at <https://gist.github.com/shinyquagsire23/b69ca343fd2f246aee882ecb5af702bd>.

![image](https://64.media.tumblr.com/d120ad227397e72155075166f13e31e2/f8833c921da777cc-98/s250x400/28249d57f2b65fcdeac385b8667652c64dbaa94a.png)![image](https://64.media.tumblr.com/a51b53313f61f721a702f3ec2eebd61e/f8833c921da777cc-7f/s250x400/2d2585b6e25abd115d815376a501a0330d7da695.png)

*A few examples of Q710 resources*

On normal boot paths, aboot reads raw\_resources to display the boot logo, download mode graphic, and verified boot statuses for devices which allow unlocking. In my case, the Q710/Q720 does not allow for unlocking, so this boot path is never reached on these devices. However, the graphics still exist I guess on the off chance that they allowed it to happen.

For the C inclined, the format of raw\_resources can be summarized in these structs:
typedef struct boot\_img\_header
{
 ¬† ¬†char magic[0x10];
 ¬† ¬†uint32\_t num\_imgs;
 ¬† ¬†uint32\_t version;
 ¬† ¬†char device[0x10];
 ¬† ¬†uint32\_t signature\_offs;
} boot\_img\_header;

typedef struct img\_info
{
 ¬† ¬†char name[0x28];
 ¬† ¬†uint32\_t data\_offset;
 ¬† ¬†uint32\_t data\_size;
 ¬† ¬†uint32\_t width;
 ¬† ¬†uint32\_t height;
 ¬† ¬†uint32\_t offs\_x;
 ¬† ¬†uint32\_t offs\_y;
} img\_info;

The following calculation is performed in order to determine the output pointer to be used during decompression:
bpp = 24
screen\_stride = fbinfo->screen\_width;
fbuf\_offset = offs\_x + (screen\_stride \* offs\_y);
fbuf\_out = (fbuf\_offset \* (bpp / 8)) + fbinfo->buffer;

offs\_x and offs\_y are not bounds checked, and fbinfo->buffer is known in SBL1 and aboot, allowing for a controlled arbitrary write in both environments.

**SBL1 load\_res\_888rle\_image Arbitrary Write**

This boot path requires discharging the battery to below 0%. While this is less feasible for any practical usage, performing the arbitrary write at this point allows patching SBL1 to disable signature verification before TEE and aboot are loaded. Any of the LGE\_PM\_\* images can be hijacked selectively for arbitrary code execution, though for my PoC I used LGE\_PM\_NO\_CHARGER specifically because I didn‚Äôt want to accidentally brick myself (or well, I didn‚Äôt want to have to beep out eMMC wires on the board to unbrick).

A 32-bit x offset can be calculated for any given address divisible by 3 using the following calculation:
offset\_x = (((0x100000000 + target\_addr) - 0x90000000) / 3) & 0xFFFFFFFF

Data written to this arbitrary address can be kept contiguous by specifying the image width to be the same as the screen width. The height should then be rounded up from the payload size to ensure all data is written properly. So really by the end, this isn‚Äôt an arbitrary write so much as it is an arbitrary memcpy at Secure EL3.

**aboot Arbitrary Write**

The aboot arbitrary write functions identically to SBL1: Any image can be selected to perform the arbitrary write. Most notably, this includes any lglogo\_image\_\* graphic, which is displayed by default on every boot. The framebuffer is generally fixed to address 0x90001000, which means that by using the arbitrary write to gain code execution, the original graphic which was used to obtain the arbitrary write can be written to the screen following hijacking to, in effect, make it appear as if boot flow has not been modified at all, for better or for worse.

A good question that might be raised after looking briefly at the structs earlier would be, ‚Äúwait, there‚Äôs a signature offset, why does any of this work if raw\_resources contains a signature?‚Äù And yes, raw\_resources contains a signature! But it‚Äôs a useless signature because this signature is only checked in aboot while displaying verifiedboot\_\* images. At some point, XDA users found out that you could swap the LG boot logos over the verifiedboot\_\* images so that when they unlocked their devices they wouldn‚Äôt have to see the AVB boot nag messages. Naturally, this defeats the point of Google‚Äôs Verified Boot spec since it would potentially allow a bootloader be unlocked without the user knowing, so LG added a signature. But it‚Äôs only checked for the verified boot images.

As a minor note, unlike SBL1, aboot will also select between raw\_resources\_a and raw\_resources\_b depending on the A/B boot slot.

**Practical Exploitation**

I started by exploiting SBL1, partially because Secure EL3 is just cooler than nonsecure EL1, but also because the framebuffer address was more obviously seen than in aboot (though I later found the aboot framebuffer address anyhow). At this point in execution all of the hardware is initialized and no other bootloaders have been loaded, so we‚Äôre basically free to patch sigchecks and control the entire phone!

As it turns out though, SBL1 takes a bit more work to actually exploit, because unlike aboot, its segments aren‚Äôt set RWX. I‚Äôm not really sure why aboot has all of its segments RWX, like at that point it‚Äôs more of a ‚Äòboot‚Äô than a 'secure boot‚Äô if they can‚Äôt even bother to use the easiest security option available.

In any case, ROP is required briefly to bypass the MMU‚Äôs NX bit. This isn‚Äôt too terrible, since SBL1 actually has a routine we can jump to to disable the MMU, though it requires a bit of finnagling to get correct.

So in summary, the exploitation process goes as follows:
 - Flash raw\_resources\_a.img to eMMC (ie via kernel execution, LG LAF, soldered wires and a hardware flasher, etc).
 - For SBL1 hax, drain the battery to below 0%. For my Q710, I drained most of the battery by leaving the screen at max brightness with sleep disabled until the phone powered off on its own after several hours. To drain the remaining battery, I charged enough to enter LAF download mode and left it to drain with the screen on for 2-3 hours.
 - Hold Power and Volume Down until the phone restarts. If the phone discharged enough, the phone should restart into the payload.
 - The phone can be plugged in to boot into aboot and Android normally, but the payload will now execute every time the payload-injected graphic is displayed.

To exploit SBL1:
 - raw\_resources\_a is modified such that the x offset is set to 0x2801CF5C, the width to 1080, and the height to 5. This will decompress LGE\_PM\_NO\_CHARGER (now containing the contents of payload.bin) to 0x08056E14, slightly higher than the stack pointer during decompression.
 - The image is decompressed and load\_res\_888rle\_image exits. The previous LR has now been overwritten by a pointer to a Thumb-mode pop {pc} ROP slide, to account for possible offsetting error.
 - At the end of the ROP slide, the following ROP instruction sequence is executed:

pop {r4-r12, pc} ¬† ¬†; r8 is now set to SBL1\_ARM\_MMU\_DISABLE, and r12 is now set to SBL1\_THUMB\_BX\_R8

pop {r4-r6, lr} ¬† ¬† ; LR is set to the payload pointer
orr r12, r12, #0x1
bx r12 ; jump to SBL1\_THUMB\_BX\_R8

bx r8 ; jump to SBL1\_ARM\_MMU\_DISABLE with lr now set to our payload

**Proof-of-Concept, and Future Plans**

For those interested in experimenting, a PoC can be found [here](https://github.com/shinyquagsire23/CVE-2020-12753-PoC). Note that this is specifically for the LG Q710, and contains offset specific to the AMZ LG Stylo 4 (Q710ULM, 20c\_00\_AMZ\_US\_OP\_1121). I‚Äôm planning on polishing things up further, however my current boot takeover involves two other vulnerabilities that I‚Äôd like to give a bit more time to make sure they‚Äôre actually fixed/close to being fixed before releasing.

In the meantime I‚Äôd be interested in seeing if anyone else is interested in porting this to other LG devices, since I only own a Nexus 5, a Q710 and a Q720. As it is, these vulns will allow bootloader unlocking at a *minimum* on most older Qualcomm LG devices, and secure EL3 on newer ones, which should be *very*¬†interesting for anyone interested in finding vulnerabilities in QSEE/similar on LG devices.

1. [![Date Posted Icon](https://static.tumblr.com/ubkenek/W8Rlmyhj3/datepostedicon.png)
   1st June 2020](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability "Date Posted")
3. [![Notes Icon](https://static.tumblr.com/ubkenek/Qnilmyiga/notesicon.png)
   Notes: 9](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability "Notes")

![Tags Icon](https://static.tumblr.com/ubkenek/CVXlmyivc/tagsicon.png)
[#CVE-2020-12753](https://douevenknow.us/tagged/CVE-2020-12753)[#exploitation](https://douevenknow.us/tagged/exploitation)[#bootloader](https://douevenknow.us/tagged/bootloader)[#Android](https://douevenknow.us/tagged/Android)[#Android ROMs](https://douevenknow.us/tagged/Android%20ROMs)

2. [![](https://assets.tumblr.com/images/default_avatar/sphere_open_16.png)](https://arm21.tumblr.com/ "Untitled ")[arm21](https://arm21.tumblr.com/ "Untitled") liked this
3. [![](https://64.media.tumblr.com/avatar_34af463271ff_16.pnj)](https://ca1iban.tumblr.com/ "Truth as untruth ")[ca1iban](https://ca1iban.tumblr.com/ "Truth as untruth") liked this
4. [![](https://assets.tumblr.com/images/default_avatar/pyramid_open_16.png)](https://jarno83-blog.tumblr.com/ "Untitled ")[jarno83-blog](https://jarno83-blog.tumblr.com/ "Untitled") liked this
5. [![](https://assets.tumblr.com/images/default_avatar/pyramid_open_16.png)](https://jarno83-blog.tumblr.com/ "Untitled")[jarno83-blog](https://jarno83-blog.tumblr.com/ "Untitled") said:
   Hi, After finding your great post I dug out my old flex 2 it‚Äôs a lg-h955. Is it possible to use this method on that, so costum ROMs can be created and loaded?
6. [![](https://64.media.tumblr.com/afbfb033825422fedea8d3ff777b50d4/69c9099eda53c676-8e/s16x16u_c1/a8b794ed1422227761bb43052ffed36ce80a0e1c.pnj)](https://valshaped.tumblr.com/ "Shaped like a Friend")[valshaped](https://valshaped.tumblr.com/post/619786019860037632 "Shaped like a Friend") reblogged this from [shinyquagsire23](https://douevenknow.us/ "[Segmentation Fault]")
7. [![](https://64.media.tumblr.com/78f557aa1552e576cca88d3615762458/eff9fddd7c4899f7-61/s16x16u_c1/c35c926aa4d48016bf36332b18575850988c1cf3.pnj)](https://valstormed.tumblr.com/ "Gee, you sure look hungry. Care for a bite? ")[valstormed](https://valstormed.tumblr.com/ "Gee, you sure look hungry. Care for a bite?") liked this
8. [![](https://64.media.tumblr.com/avatar_3e2c2bbc5859_16.pnj)](https://foldingcookie2.tumblr.com/ "rutaciervas")[foldingcookie2](https://foldingcookie2.tumblr.com/post/619777353254682624 "rutaciervas") reblogged this from [shinyquagsire23](https://douevenknow.us/ "[Segmentation Fault]")
9. [![](https://64.media.tumblr.com/avatar_3e2c2bbc5859_16.pnj)](https://foldingcookie2.tumblr.com/ "rutaciervas ")[foldingcookie2](https://foldingcookie2.tumblr.com/ "rutaciervas") liked this
10. [![](https://64.media.tumblr.com/avatar_19c67fce6734_16.pnj)](https://douevenknow.us/ "[Segmentation Fault]")[shinyquagsire23](https://douevenknow.us/ "[Segmentation Fault]") posted this

Page 1 of 1

This blog is powered by [Tumblr](http://tumblr.com "Tumblr") and designed by [CoSnap](http://cosnap.co.uk "The CoSnap website").

![](https://px.srvcs.tumblr.com/impixu?T=1737295329&J=eyJ0eXBlIjoidXJsIiwidXJsIjoiaHR0cDovL2RvdWV2ZW5rbm93LnVzL3Bvc3QvNjE5NzYzMDc0ODIyNTIwODMyL2FuLWVsMWVsMy1jb2xkYm9vdC12dWxuZXJhYmlsaXR5IiwicmVxdHlwZSI6MCwicm91dGUiOiIvcG9zdC86aWQvOnN1bW1hcnkiLCJub3NjcmlwdCI6MX0=&U=IPCCJPJMPJ&K=20cd17bb6f5e3bd82db96d7d468bdbb9e7595d7df6e7a48d1804c2089f7edb4d&R=)![](https://px.srvcs.tumblr.com/impixu?T=1737295329&J=eyJ0eXBlIjoicG9zdCIsInVybCI6Imh0dHA6Ly9kb3VldmVua25vdy51cy9wb3N0LzYxOTc2MzA3NDgyMjUyMDgzMi9hbi1lbDFlbDMtY29sZGJvb3QtdnVsbmVyYWJpbGl0eSIsInJlcXR5cGUiOjAsInJvdXRlIjoiL3Bvc3QvOmlkLzpzdW1tYXJ5IiwicG9zdHMiOlt7InBvc3RpZCI6IjYxOTc2MzA3NDgyMjUyMDgzMiIsImJsb2dpZCI6MTUwNDEzMTgyLCJzb3VyY2UiOjMzfV0sIm5vc2NyaXB0IjoxfQ==&U=IKONHFHIEL&K=7e727397674fcfaf7415317e8351c1acd79435cd910d4b75952867889955eef1&R=)

=== Content from en.wikipedia.org_31bf0888_20250119_140157.html ===
[Jump to content](#bodyContent)

Main menu

Main menu
move to sidebar
hide

Navigation

* [Main page](/wiki/Main_Page "Visit the main page [z]")
* [Contents](/wiki/Wikipedia%3AContents "Guides to browsing Wikipedia")
* [Current events](/wiki/Portal%3ACurrent_events "Articles related to current events")
* [Random article](/wiki/Special%3ARandom "Visit a randomly selected article [x]")
* [About Wikipedia](/wiki/Wikipedia%3AAbout "Learn about Wikipedia and how it works")
* [Contact us](//en.wikipedia.org/wiki/Wikipedia%3AContact_us "How to contact Wikipedia")

Contribute

* [Help](/wiki/Help%3AContents "Guidance on how to use and edit Wikipedia")
* [Learn to edit](/wiki/Help%3AIntroduction "Learn how to edit Wikipedia")
* [Community portal](/wiki/Wikipedia%3ACommunity_portal "The hub for editors")
* [Recent changes](/wiki/Special%3ARecentChanges "A list of recent changes to Wikipedia [r]")
* [Upload file](/wiki/Wikipedia%3AFile_upload_wizard "Add images or other media for use on Wikipedia")

[![](/static/images/icons/wikipedia.png)
![Wikipedia](/static/images/mobile/copyright/wikipedia-wordmark-en.svg)
![The Free Encyclopedia](/static/images/mobile/copyright/wikipedia-tagline-en.svg)](/wiki/Main_Page)

[Search](/wiki/Special%3ASearch "Search Wikipedia [f]")

Search

Appearance

* [Donate](https://donate.wikimedia.org/?wmf_source=donate&wmf_medium=sidebar&wmf_campaign=en.wikipedia.org&uselang=en)
* [Create account](/w/index.php?title=Special:CreateAccount&returnto=Cold+boot+attack "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=Cold+boot+attack "You're encouraged to log in; however, it's not mandatory. [o]")

Personal tools

* [Donate](https://donate.wikimedia.org/?wmf_source=donate&wmf_medium=sidebar&wmf_campaign=en.wikipedia.org&uselang=en)
* [Create account](/w/index.php?title=Special:CreateAccount&returnto=Cold+boot+attack "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=Cold+boot+attack "You're encouraged to log in; however, it's not mandatory. [o]")

Pages for logged out editors [learn more](/wiki/Help%3AIntroduction)

* [Contributions](/wiki/Special%3AMyContributions "A list of edits made from this IP address [y]")
* [Talk](/wiki/Special%3AMyTalk "Discussion about edits from this IP address [n]")

## Contents

move to sidebar
hide

* (Top)
* [1
  Technical details](#Technical_details)
* [2
  Uses](#Uses)

  Toggle Uses subsection
  + [2.1
    Digital forensics](#Digital_forensics)
  + [2.2
    Malicious intent](#Malicious_intent)
* [3
  Circumventing full disk encryption](#Circumventing_full_disk_encryption)

  Toggle Circumventing full disk encryption subsection
  + [3.1
    BitLocker](#BitLocker)
  + [3.2
    Mitigation](#Mitigation)
    - [3.2.1
      Register-based key storage](#Register-based_key_storage)
    - [3.2.2
      Cache-based key storage](#Cache-based_key_storage)
    - [3.2.3
      Dismounting encrypted disks](#Dismounting_encrypted_disks)
* [4
  Effective countermeasures](#Effective_countermeasures)

  Toggle Effective countermeasures subsection
  + [4.1
    Preventing physical access](#Preventing_physical_access)
  + [4.2
    Full memory encryption](#Full_memory_encryption)
  + [4.3
    Secure erasure of memory](#Secure_erasure_of_memory)
  + [4.4
    External key storage](#External_key_storage)
* [5
  Ineffective countermeasures](#Ineffective_countermeasures)
* [6
  Smartphones](#Smartphones)
* [7
  References](#References)
* [8
  External links](#External_links)

Toggle the table of contents

# Cold boot attack

9 languages

* [‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ](https://bn.wikipedia.org/wiki/%E0%A6%95%E0%A7%8B%E0%A6%B2%E0%A7%8D%E0%A6%A1_%E0%A6%AC%E0%A7%81%E0%A6%9F_%E0%A6%86%E0%A6%95%E0%A7%8D%E0%A6%B0%E0%A6%AE%E0%A6%A3 "‡¶ï‡ßã‡¶≤‡ßç‡¶° ‡¶¨‡ßÅ‡¶ü ‡¶Ü‡¶ï‡ßç‡¶∞‡¶Æ‡¶£ ‚Äì Bangla")
* [Deutsch](https://de.wikipedia.org/wiki/Kaltstartattacke "Kaltstartattacke ‚Äì German")
* [Espa√±ol](https://es.wikipedia.org/wiki/Ataque_de_arranque_en_fr%C3%ADo "Ataque de arranque en fr√≠o ‚Äì Spanish")
* [ŸÅÿßÿ±ÿ≥€å](https://fa.wikipedia.org/wiki/%D8%AD%D9%85%D9%84%D9%87_%D8%B1%D8%A7%D9%87%E2%80%8C%D8%A7%D9%86%D8%AF%D8%A7%D8%B2%DB%8C_%D8%B3%D8%B1%D8%AF "ÿ≠ŸÖŸÑŸá ÿ±ÿßŸá‚ÄåÿßŸÜÿØÿßÿ≤€å ÿ≥ÿ±ÿØ ‚Äì Persian")
* [Fran√ßais](https://fr.wikipedia.org/wiki/Attaque_par_d%C3%A9marrage_%C3%A0_froid "Attaque par d√©marrage √† froid ‚Äì French")
* [Portugu√™s](https://pt.wikipedia.org/wiki/Cold_boot_attack "Cold boot attack ‚Äì Portuguese")
* [–†—É—Å—Å–∫–∏–π](https://ru.wikipedia.org/wiki/%D0%90%D1%82%D0%B0%D0%BA%D0%B0_%D1%87%D0%B5%D1%80%D0%B5%D0%B7_%D1%85%D0%BE%D0%BB%D0%BE%D0%B4%D0%BD%D1%83%D1%8E_%D0%BF%D0%B5%D1%80%D0%B5%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D1%83 "–ê—Ç–∞–∫–∞ —á–µ—Ä–µ–∑ —Ö–æ–ª–æ–¥–Ω—É—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É ‚Äì Russian")
* [–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞](https://uk.wikipedia.org/wiki/Cold_boot_attack "Cold boot attack ‚Äì Ukrainian")
* [‰∏≠Êñá](https://zh.wikipedia.org/wiki/%E5%86%B7%E5%90%AF%E5%8A%A8%E6%94%BB%E5%87%BB "ÂÜ∑ÂêØÂä®ÊîªÂáª ‚Äì Chinese")

[Edit links](https://www.wikidata.org/wiki/Special%3AEntityPage/Q1584046#sitelinks-wikipedia "Edit interlanguage links")

* [Article](/wiki/Cold_boot_attack "View the content page [c]")
* [Talk](/wiki/Talk%3ACold_boot_attack "Discuss improvements to the content page [t]")

English

* [Read](/wiki/Cold_boot_attack)
* [Edit](/w/index.php?title=Cold_boot_attack&action=edit "Edit this page [e]")
* [View history](/w/index.php?title=Cold_boot_attack&action=history "Past revisions of this page [h]")

Tools

Tools
move to sidebar
hide

Actions

* [Read](/wiki/Cold_boot_attack)
* [Edit](/w/index.php?title=Cold_boot_attack&action=edit "Edit this page [e]")
* [View history](/w/index.php?title=Cold_boot_attack&action=history)

General

* [What links here](/wiki/Special%3AWhatLinksHere/Cold_boot_attack "List of all English Wikipedia pages containing links to this page [j]")
* [Related changes](/wiki/Special%3ARecentChangesLinked/Cold_boot_attack "Recent changes in pages linked from this page [k]")
* [Upload file](/wiki/Wikipedia%3AFile_Upload_Wizard "Upload files [u]")
* [Special pages](/wiki/Special%3ASpecialPages "A list of all special pages [q]")
* [Permanent link](/w/index.php?title=Cold_boot_attack&oldid=1255149176 "Permanent link to this revision of this page")
* [Page information](/w/index.php?title=Cold_boot_attack&action=info "More information about this page")
* [Cite this page](/w/index.php?title=Special:CiteThisPage&page=Cold_boot_attack&id=1255149176&wpFormIdentifier=titleform "Information on how to cite this page")
* [Get shortened URL](/w/index.php?title=Special:UrlShortener&url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCold_boot_attack)
* [Download QR code](/w/index.php?title=Special:QrCode&url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCold_boot_attack)

Print/export

* [Download as PDF](/w/index.php?title=Special:DownloadAsPdf&page=Cold_boot_attack&action=show-download-screen "Download this page as a PDF file")
* [Printable version](/w/index.php?title=Cold_boot_attack&printable=yes "Printable version of this page [p]")

In other projects

* [Wikidata item](https://www.wikidata.org/wiki/Special%3AEntityPage/Q1584046 "Structured data on this page hosted by Wikidata [g]")

Appearance
move to sidebar
hide

From Wikipedia, the free encyclopedia

Means of compromising computer security by restarting the computer

In [computer security](/wiki/Computer_security "Computer security"), a **cold boot attack** (or to a lesser extent, a **platform reset attack**) is a type of [side channel attack](/wiki/Side_channel_attack "Side channel attack") in which an attacker with [physical access](/wiki/Physical_access "Physical access") to a computer performs a [memory dump](/wiki/Memory_dump "Memory dump") of a computer's [random-access memory (RAM)](/wiki/Random-access_memory "Random-access memory") by performing a hard reset of the target machine. Typically, cold boot attacks are used for retrieving encryption [keys](/wiki/Key_%28cryptography%29 "Key (cryptography)") from a running [operating system](/wiki/Operating_system "Operating system") for malicious or criminal investigative reasons.[[1]](#cite_note-MacIver2006-1)[[2]](#cite_note-halderman2008-2)[[3]](#cite_note-forensic2011-3) The attack relies on the [data remanence](/wiki/Data_remanence "Data remanence") property of [DRAM](/wiki/Dynamic_random-access_memory "Dynamic random-access memory") and [SRAM](/wiki/Static_random-access_memory "Static random-access memory") to retrieve memory contents that [remain readable](/wiki/DRAM_data_remanence "DRAM data remanence") in the seconds to minutes following a power switch-off.[[2]](#cite_note-halderman2008-2)[[4]](#cite_note-skorobogatov2002-4)[[5]](#cite_note-bitlocker2008-5)

An attacker with physical access to a running computer typically executes a cold boot attack by [cold-booting](/wiki/Cold-booting "Cold-booting") the machine and booting a lightweight operating system from a removable disk to dump the contents of pre-boot physical [memory](/wiki/Random-access_memory "Random-access memory") to a file.[[6]](#cite_note-memTool2008-6)[[2]](#cite_note-halderman2008-2) An attacker is then free to analyze the data [dumped](/wiki/Core_dump "Core dump") from memory to find sensitive data, such as the [keys](/wiki/Key_%28cryptography%29 "Key (cryptography)"), using various forms of [key finding attacks](/wiki/Key_finding_attacks "Key finding attacks").[[7]](#cite_note-7)[[8]](#cite_note-hargreaves2008-8) Since cold boot attacks target [random-access memory](/wiki/Random-access_memory "Random-access memory"), [full disk encryption](/wiki/Full_disk_encryption "Full disk encryption") schemes, even with a [trusted platform module](/wiki/Trusted_platform_module "Trusted platform module") installed are ineffective against this kind of attack.[[2]](#cite_note-halderman2008-2) This is because the problem is fundamentally a [hardware](/wiki/Computer_hardware "Computer hardware") (insecure memory) and not a [software](/wiki/Software "Software") issue. However, malicious access can be prevented by limiting physical access and using modern techniques to avoid storing sensitive data in [random-access memory](/wiki/Random-access_memory "Random-access memory").

## Technical details

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=1 "Edit section: Technical details")]
[![](//upload.wikimedia.org/wikipedia/commons/thumb/7/7c/K%C3%A4ltespray_2009_PD_IMG_5196.JPG/220px-K%C3%A4ltespray_2009_PD_IMG_5196.JPG)](/wiki/File%3AK%C3%A4ltespray_2009_PD_IMG_5196.JPG)

Liquid nitrogen, [freeze spray](/wiki/Freeze_spray "Freeze spray") or compressed air cans can be improvised to cool memory modules, and thereby slow down the degradation of volatile memory

[DIMM memory modules](/wiki/DIMM "DIMM") gradually lose data over time as they lose power, but do not immediately lose all data when power is lost.[[2]](#cite_note-halderman2008-2) With certain memory modules, the time window for an attack can be extended to hours or even a week by cooling them with [freeze spray](/wiki/Freeze_spray "Freeze spray") and liquid nitrogen. Furthermore, as the [bits](/wiki/Bit "Bit") disappear in memory over time, they can be reconstructed, as they fade away in a predictable manner.[[2]](#cite_note-halderman2008-2) Consequently, an attacker can perform a [memory dump](/wiki/Memory_dump "Memory dump") of its contents by executing a cold boot attack. The ability to execute the cold boot attack successfully varies considerably across different systems, types of memory, memory manufacturers and motherboard properties, and may be more difficult to carry out than software-based methods or a [DMA attack](/wiki/DMA_attack "DMA attack").[[9]](#cite_note-carbone2011-9) While the focus of current research is on disk encryption, any sensitive data held in memory is vulnerable to the attack.[[2]](#cite_note-halderman2008-2)

Attackers execute cold boot attacks by forcefully and abruptly rebooting a target machine and then booting a pre-installed operating system from a [USB flash drive](/wiki/USB_flash_drive "USB flash drive"), [CD-ROM](/wiki/CD-ROM "CD-ROM") or [over the network](/wiki/Network_boot "Network boot").[[3]](#cite_note-forensic2011-3) In cases where it is not practical to hard reset the target machine, an attacker may alternatively physically remove the [memory modules](/wiki/DIMM "DIMM") from the original system and quickly place them into a compatible machine under the attacker's control, which is then booted to access the memory.[[2]](#cite_note-halderman2008-2) Further analysis can then be performed against the data dumped from [RAM](/wiki/Random-access_memory "Random-access memory").

A similar kind of attack can also be used to extract data from memory, such as a [DMA attack](/wiki/DMA_attack "DMA attack") that allows the physical memory to be accessed via a high-speed expansion port such as [FireWire](/wiki/FireWire "FireWire").[[3]](#cite_note-forensic2011-3) A cold boot attack may be preferred in certain cases, such as when there is high risk of hardware damage. Using the high-speed expansion port can [short out](/wiki/Short_circuit "Short circuit"), or physically damage hardware in certain cases.[[3]](#cite_note-forensic2011-3)

## Uses

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=2 "Edit section: Uses")]

Cold boots attacks are typically used for [digital forensic investigations](/wiki/Digital_forensics "Digital forensics"), malicious purposes such as theft, and data recovery.[[3]](#cite_note-forensic2011-3)

### Digital forensics

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=3 "Edit section: Digital forensics")]

In certain cases, a cold boot attack is used in the discipline of [digital forensics](/wiki/Digital_forensics "Digital forensics") to forensically preserve data contained within memory as criminal evidence.[[3]](#cite_note-forensic2011-3) For example, when it is not practical to preserve data in memory through other means, a cold boot attack may be used to perform a dump of the data contained in [random-access memory](/wiki/Random-access_memory "Random-access memory"). For example, a cold boot attack is used in situations where a system is secured and it is not possible to access the computer.[[3]](#cite_note-forensic2011-3) A cold boot attack may also be necessary when a hard disk is encrypted with [full disk encryption](/wiki/Full_disk_encryption "Full disk encryption") and the disk potentially contains evidence of criminal activity. A cold boot attack provides access to the memory, which can provide information about the state of the system at the time such as what programs are running.[[3]](#cite_note-forensic2011-3)

### Malicious intent

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=4 "Edit section: Malicious intent")]

A cold boot attack may be used by attackers to gain access to encrypted information such as financial information or [trade secrets](/wiki/Trade_secret "Trade secret") for malicious intent.[[10]](#cite_note-gruhn2016-10)

## Circumventing full disk encryption

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=5 "Edit section: Circumventing full disk encryption")]

A common purpose of cold boot attacks is to circumvent software-based disk encryption. Cold boot attacks when used in conjunction with [key finding attacks](/wiki/Key_finding_attacks "Key finding attacks") have been demonstrated to be an effective means of circumventing [full disk encryption](/wiki/Full_disk_encryption "Full disk encryption") schemes of various vendors and [operating systems](/wiki/Operating_system "Operating system"), even where a [Trusted Platform Module](/wiki/Trusted_Platform_Module "Trusted Platform Module") (TPM) [secure cryptoprocessor](/wiki/Secure_cryptoprocessor "Secure cryptoprocessor") is used.[[2]](#cite_note-halderman2008-2)

In the case of disk encryption applications that can be configured to allow the operating system to boot without a pre-[boot](/wiki/Booting "Booting") [PIN](/wiki/Personal_identification_number "Personal identification number") being entered or a hardware key being present (e.g. [BitLocker](/wiki/BitLocker "BitLocker") in a simple configuration that uses a TPM without a [two-factor authentication](/wiki/Two-factor_authentication "Two-factor authentication") PIN or USB key), the time frame for the attack is not limiting at all.[[2]](#cite_note-halderman2008-2)

### BitLocker

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=6 "Edit section: BitLocker")]

[BitLocker](/wiki/BitLocker "BitLocker") in its default configuration uses a [trusted platform module](/wiki/Trusted_platform_module "Trusted platform module") that neither requires a [PIN](/wiki/Personal_identification_number "Personal identification number"), nor an external key to decrypt the disk. When the [operating system](/wiki/Operating_system "Operating system") boots, [BitLocker](/wiki/BitLocker "BitLocker") retrieves the key from the TPM, without any user interaction. Consequently, an attacker can simply power on the machine, wait for the operating system to begin [booting](/wiki/Booting "Booting") and then execute a cold boot attack against the machine to retrieve the key. Due to this, [two-factor authentication](/wiki/Two-factor_authentication "Two-factor authentication"), such as a pre-boot PIN or a removable USB device containing a startup key together with a TPM should be used to work around this vulnerability in the default BitLocker implementation.[[11]](#cite_note-bitlockerOverview2008-11)[[5]](#cite_note-bitlocker2008-5) However, this workaround does not prevent an attacker from retrieving sensitive data from memory, nor from retrieving encryption keys cached in memory.

### Mitigation

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=7 "Edit section: Mitigation")]

Since a [memory dump](/wiki/Memory_dump "Memory dump") can be easily performed by executing a cold boot attack, storage of sensitive data in RAM, like encryption keys for [full disk encryption](/wiki/Full_disk_encryption "Full disk encryption") is unsafe. Several solutions have been proposed for storing encryption keys in areas, other than [random-access memory](/wiki/Random-access_memory "Random-access memory"). While these solutions may reduce the chance of breaking full disk encryption, they provide no protection of other sensitive data stored in memory.

#### Register-based key storage

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=8 "Edit section: Register-based key storage")]

One solution for keeping encryption keys out of memory is register-based key storage. Implementations of this solution are [TRESOR](/wiki/TRESOR "TRESOR")[[12]](#cite_note-tresor-usenix-12) and Loop-Amnesia.[[13]](#cite_note-loopamnesia-acsac-13) Both of these implementations modify the [kernel](/wiki/Kernel_%28operating_system%29 "Kernel (operating system)") of an operating system so that [CPU registers](/wiki/CPU_register "CPU register") (in TRESOR's case the [x86 debug registers](/wiki/X86_debug_register "X86 debug register") and in Loop-Amnesia's case the AMD64 or EMT64 profiling registers) can be used to store encryption keys, rather than in RAM. Keys stored at this level cannot easily be read from [userspace](/wiki/User_space "User space")[*[citation needed](/wiki/Wikipedia%3ACitation_needed "Wikipedia:Citation needed")*] and are lost when the computer restarts for any reason. TRESOR and Loop-Amnesia both must use on-the-fly [round key](/wiki/Key_schedule "Key schedule") generation due to the limited space available for storing cryptographic tokens in this manner. For security, both disable interrupts to prevent key information from leaking to memory from the CPU registers while encryption or decryption is being performed, and both block access to the debug or profile registers.

There are two potential areas in modern [x86](/wiki/X86 "X86") processors for storing keys: the [SSE](/wiki/Streaming_SIMD_Extensions "Streaming SIMD Extensions") registers which could in effect be made privileged by disabling all SSE instructions (and necessarily, any programs relying on them), and the debug registers which were much smaller but had no such issues.

A [proof of concept](/wiki/Proof_of_concept "Proof of concept") distribution called 'paranoix' based on the SSE register method has been developed.[[14]](#cite_note-muller2010-14) The developers claim that "running TRESOR on a 64-bit CPU that supports [AES-NI](/wiki/AES-NI "AES-NI"), there is no performance penalty compared to a generic implementation of [AES](/wiki/Advanced_Encryption_Standard "Advanced Encryption Standard")",[[15]](#cite_note-tresorBlog-15) and run slightly faster than standard encryption despite the need for key recalculation.[[12]](#cite_note-tresor-usenix-12) The primary advantage of Loop-Amnesia compared to TRESOR is that it supports the use of multiple encrypted drives; the primary disadvantages are a lack of support for 32-bit x86 and worse performance on CPUs not supporting AES-NI.

#### Cache-based key storage

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=9 "Edit section: Cache-based key storage")]

"Frozen cache" (sometimes known as "cache as RAM"),[[16]](#cite_note-tews2010-16) may be used to securely store encryption keys. It works by disabling a CPU's L1 cache and uses it for key storage, however, this may significantly degrade overall system performance to the point of being too slow for most purposes.[[17]](#cite_note-frozencache-17)[*[better¬†source¬†needed](/wiki/Wikipedia%3ANOTRS "Wikipedia:NOTRS")*]

A similar cache-based solution was proposed by Guan et al. (2015)[[18]](#cite_note-copker-18) by employing the WB (Write-Back) cache mode to keep data in caches, reducing the computation times of public key algorithms.

Mimosa[[19]](#cite_note-guan2015-19) in IEEE S&P 2015 presented a more practical solution for public-key cryptographic computations against cold-boot attacks and DMA attacks. It employs hardware transactional memory (HTM) which was originally proposed as a speculative memory access mechanism to boost the performance of multi-threaded applications. The strong atomicity guarantee provided by HTM, is utilized to defeat illegal concurrent accesses to the memory space that contains sensitive data. The RSA private key is encrypted in memory by an AES key that is protected by TRESOR. On request, an RSA private-key computation is conducted within an HTM transaction: the private key is firstly decrypted into memory, and then RSA decryption or signing is conducted. Because a plain-text RSA private key only appears as modified data in an HTM transaction, any read operation to these data will abort the transaction - the transaction will roll-back to its initial state. Note that, the RSA private key is encrypted in initial state, and it is a result of write operations (or AES decryption). Currently HTM is implemented in caches or store-buffers, both of which are located in CPUs, not in external RAM chips. So cold-boot attacks are prevented. Mimosa defeats against attacks that attempt to read sensitive data from memory (including cold-boot attacks, DMA attacks, and other software attacks), and it only introduces a small performance overhead.

#### Dismounting encrypted disks

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=10 "Edit section: Dismounting encrypted disks")]

Best practice recommends dismounting any encrypted, non-system disks when not in use, since most disk encryption software are designed to securely erase keys cached in memory after use.[[20]](#cite_note-dean2009-20) This reduces the risk of an attacker being able to salvage encryption keys from memory by executing a cold boot attack. To minimize access to encrypted information on the operating system hard disk, the machine should be completely shut down when not in use to reduce the likelihood of a successful cold boot attack.[[2]](#cite_note-halderman2008-2)[[21]](#cite_note-wired2008-21) However, [data may remain readable](/wiki/Data_remanence "Data remanence") from tens of seconds to several minutes depending upon the physical RAM device in the machine, potentially allowing some data to be retrieved from memory by an attacker. Configuring an [operating system](/wiki/Operating_system "Operating system") to shut down or hibernate when unused, instead of using sleep mode, can help mitigate the risk of a successful cold boot attack.

## Effective countermeasures

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=11 "Edit section: Effective countermeasures")]
### Preventing physical access

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=12 "Edit section: Preventing physical access")]

Typically, a cold boot attack can be prevented by limiting an attacker's [physical access](/wiki/Physical_access "Physical access") to the computer or by making it increasingly difficult to carry out the attack. One method involves [soldering](/wiki/Soldering "Soldering") or gluing in the [memory modules](/wiki/DIMM "DIMM") onto the [motherboard](/wiki/Motherboard "Motherboard"), so they cannot be easily removed from their sockets and inserted into another machine under an attacker's control.[[2]](#cite_note-halderman2008-2) However, this does not prevent an attacker from booting the victim's machine and performing a [memory dump](/wiki/Memory_dump "Memory dump") using a removable [USB flash drive](/wiki/USB_flash_drive "USB flash drive"). A [mitigation](/wiki/Vulnerability_mitigation "Vulnerability mitigation") such as [UEFI Secure Boot](/wiki/UEFI_Secure_Boot "UEFI Secure Boot") or similar boot verification approaches can be effective in preventing an attacker from booting up a custom software environment to dump out the contents of soldered-on main memory.[[22]](#cite_note-weis-22)

### Full memory encryption

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=13 "Edit section: Full memory encryption")]

Encrypting [random-access memory](/wiki/Random-access_memory "Random-access memory") (RAM) mitigates the possibility of an attacker being able to obtain [encryption keys](/wiki/Key_%28cryptography%29 "Key (cryptography)") or other material from memory via a cold boot attack. This approach may require changes to the operating system, applications, or hardware. One example of hardware-based memory encryption was implemented in the [Microsoft](/wiki/Microsoft "Microsoft") [Xbox](/wiki/Xbox_%28console%29 "Xbox (console)").[[23]](#cite_note-23) Implementations on newer x86-64 hardware are available from AMD and on Intel [Willow Cove](/wiki/Willow_Cove "Willow Cove") and newer.

Software-based full memory encryption is similar to CPU-based key storage since key material is never exposed to memory, but is more comprehensive since all memory contents are encrypted. In general, only immediate pages are decrypted and read on the fly by the operating system.[[24]](#cite_note-ramCrypt2016-24) Implementations of software-based memory encryption solutions include: a commercial product from [PrivateCore](/wiki/PrivateCore "PrivateCore").[[25]](#cite_note-25)[[26]](#cite_note-26)[[27]](#cite_note-27) and RamCrypt, a kernel-patch for the Linux kernel that encrypts data in memory and stores the encryption key in the CPU registers in a manner similar to [TRESOR](/wiki/TRESOR "TRESOR").[[12]](#cite_note-tresor-usenix-12)[[24]](#cite_note-ramCrypt2016-24)

Since version 1.24, [VeraCrypt](/wiki/VeraCrypt "VeraCrypt") supports RAM encryption for keys and passwords.[[28]](#cite_note-28)

More recently, several papers have been published highlighting the availability of security-enhanced x86 and ARM commodity processors.[[29]](#cite_note-29)[[30]](#cite_note-30) In that work, an ARM Cortex A8 processor is used as the substrate on which a full memory encryption solution is built. Process segments (for example, stack, code or heap) can be encrypted individually or in composition. This work marks the first full memory encryption implementation on a general-purpose commodity processor. The system provides both confidentiality and integrity protections of code and data which are encrypted everywhere outside the CPU boundary.

### Secure erasure of memory

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=14 "Edit section: Secure erasure of memory")]

Since cold boot attacks target unencrypted [random-access memory](/wiki/Random-access_memory "Random-access memory"), one solution is to erase sensitive data from memory when it is no longer in use. The "TCG Platform Reset Attack Mitigation Specification",[[31]](#cite_note-31) an industry response to this specific attack, forces the [BIOS](/wiki/BIOS "BIOS") to overwrite memory during [POST](/wiki/Power-on_self-test "Power-on self-test") if the operating system was not shut down cleanly. However, this measure can still be circumvented by removing the memory module from the system and reading it back on another system under the attacker's control that does not support these measures.[[2]](#cite_note-halderman2008-2)

An effective secure erase feature would be that if power is interrupted, the RAM is wiped in the less than 300 ms before power is lost in conjunction with a secure BIOS and hard drive/SSD controller that encrypts data on the M-2 and SATAx ports. If the [RAM](/wiki/RAM "RAM") itself contained no serial presence or other data and the timings were stored in the BIOS with some form of failsafe requiring a hardware key to change them, it would be nearly impossible to recover any data and would also be immune to [TEMPEST](/wiki/Tempest_%28codename%29 "Tempest (codename)") attacks, man-in-the-RAM and other possible infiltration methods.[*[citation needed](/wiki/Wikipedia%3ACitation_needed "Wikipedia:Citation needed")*][[32]](#cite_note-32)

Some [operating systems](/wiki/Operating_systems "Operating systems") such as [Tails](/wiki/Tails_%28operating_system%29 "Tails (operating system)") provide a feature that securely writes random data to system memory when the operating system is shut down to mitigate against a cold boot attack.[[33]](#cite_note-tails-33) However, video memory erasure is still not possible and as of 2022 it's still an open ticket on the Tails forum.[[34]](#cite_note-34) Potential attacks which could exploit this flaw are:

* Generation of a [GnuPG keypair](/wiki/GNU_Privacy_Guard "GNU Privacy Guard") and viewing the private key on a text editor could lead to the key being recovered.[[35]](#cite_note-35)
* A [cryptocurrency](/wiki/Cryptocurrency "Cryptocurrency") seed could be seen, therefore bypassing the wallet (even if encrypted) allowing access to the funds.[*[citation needed](/wiki/Wikipedia%3ACitation_needed "Wikipedia:Citation needed")*]
* Typing a password with visibility enabled might show parts of it or even the whole key. If a keyfile is used, it could be shown to reduce time needed for a password attack.
* Traces of mounted or opened encrypted volumes with [plausible deniability](/wiki/Plausible_deniability "Plausible deniability") might be shown, leading to the discovery of them.
* If connected to a [.onion](/wiki/.onion ".onion") service, the [URL](/wiki/URL "URL") might be shown and lead to its discovery, whereas otherwise would be extremely difficult.[[36]](#cite_note-36)[[37]](#cite_note-37)
* Usage of a particular program could show user's patterns. For instance, if a [steganography](/wiki/Steganography "Steganography") program is used and opened, the assumption that the user has been hiding data could be made. Likewise, if an instant messenger is being used, a list of contacts or messages could be shown.

### External key storage

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=15 "Edit section: External key storage")]

A cold boot attack can be prevented by ensuring no keys are stored by the hardware under attack.

* User enters the disk encryption key manually
* Using an [enclosed fully encrypted hard disk drive](/wiki/Hardware-based_full_disk_encryption#Enclosed_hard_disk_drive_FDE "Hardware-based full disk encryption") where the [encryption keys](/wiki/Key_%28cryptography%29 "Key (cryptography)") are held in hardware separate from the [hard disk drive](/wiki/Hard_disk_drive "Hard disk drive").

## Ineffective countermeasures

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=16 "Edit section: Ineffective countermeasures")]

[Memory scrambling](/wiki/Memory_scrambling "Memory scrambling") may be used to minimize undesirable parasitic effects of semiconductors as a feature of modern [Intel Core](/wiki/Intel_Core "Intel Core") processors.[[38]](#cite_note-38)[[39]](#cite_note-39)[[40]](#cite_note-40)[[41]](#cite_note-41)
However, because the scrambling is only used to [decorrelate](/wiki/Decorrelation "Decorrelation") any patterns within the memory contents, the memory can be descrambled via a descrambling attack.[[42]](#cite_note-42)[[43]](#cite_note-43) Hence, memory scrambling is not a viable mitigation against cold boot attacks.

[Sleep mode](/wiki/Hibernate_%28OS_feature%29 "Hibernate (OS feature)") provides no additional protection against a cold boot attack because data typically still resides in memory while in this state. As such, full disk encryption products are still vulnerable to attack because the keys reside in memory and do not need to be re-entered once the machine resumes from a low power state.

Although limiting the boot device options in the [BIOS](/wiki/BIOS "BIOS") may make it slightly harder to boot another operating system, firmware in modern chipsets tends to allow the user to override the boot device during [POST](/wiki/Power-on_self_test "Power-on self test") by pressing a specified hot key.[[5]](#cite_note-bitlocker2008-5)[[44]](#cite_note-microsoftBios2018-44)[[45]](#cite_note-biosKeys-45) Limiting the boot device options will not prevent the memory module from being removed from the system and read back on an alternative system either. In addition, most chipsets provide a recovery mechanism that allows the BIOS settings to be reset to default even if they are protected with a password.[[10]](#cite_note-gruhn2016-10)[[46]](#cite_note-dell-46) The [BIOS settings](/wiki/BIOS "BIOS") can also be modified while the system is running to circumvent any protections enforced by it, such as memory wiping or locking the boot device.[[47]](#cite_note-47)[[48]](#cite_note-48)[[49]](#cite_note-49)

## Smartphones

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=17 "Edit section: Smartphones")]

The cold boot attack can be adapted and carried out in a similar manner on Android [smartphones](/wiki/Smartphone "Smartphone").[[50]](#cite_note-cellPhones2018-50) A cold boot can be performed by disconnecting the phone's battery to force a hard reset or holding down the power button.[[50]](#cite_note-cellPhones2018-50) The smartphone is then flashed with an operating system image that can perform a [memory dump](/wiki/Memory_dump "Memory dump"). Typically, the smartphone is connected to an attacker's machine using a [USB](/wiki/Universal_Serial_Bus "Universal Serial Bus") port.

Typically, Android [smartphones](/wiki/Smartphones "Smartphones") securely erase encryption keys from [random-access memory](/wiki/Random-access_memory "Random-access memory") when the phone is locked.[[50]](#cite_note-cellPhones2018-50) This reduces the risk of an attacker being able to retrieve the keys from memory, even if they succeeded in executing a cold boot attack against the phone.

## References

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=18 "Edit section: References")]

1. **[^](#cite_ref-MacIver2006_1-0)** MacIver, Douglas (2006-09-21). [*Penetration Testing Windows Vista BitLocker Drive Encryption*](http://www.secguru.com/files/hitbsecconf2006kl/DAY%202%20-%20Douglas%20MacIver%20-%20Pentesting%20BitLocker.pdf) (PDF). [HITBSecConf2006, Malaysia](http://conference.hackinthebox.org/hitbsecconf2006kl/). [Microsoft](/wiki/Microsoft "Microsoft"). Retrieved 2008-09-23.
2. ^ [***a***](#cite_ref-halderman2008_2-0) [***b***](#cite_ref-halderman2008_2-1) [***c***](#cite_ref-halderman2008_2-2) [***d***](#cite_ref-halderman2008_2-3) [***e***](#cite_ref-halderman2008_2-4) [***f***](#cite_ref-halderman2008_2-5) [***g***](#cite_ref-halderman2008_2-6) [***h***](#cite_ref-halderman2008_2-7) [***i***](#cite_ref-halderman2008_2-8) [***j***](#cite_ref-halderman2008_2-9) [***k***](#cite_ref-halderman2008_2-10) [***l***](#cite_ref-halderman2008_2-11) [***m***](#cite_ref-halderman2008_2-12) Halderman, J. Alex; Schoen, Seth D.; Heninger, Nadia; Clarkson, William; Paul, William; Calandrino, Joseph A.; Feldman, Ariel J.; Appelbaum, Jacob; Felten, Edward W. (2009-05-01). ["Lest we remember: cold-boot attacks on encryption keys"](https://www.usenix.org/legacy/event/sec08/tech/full_papers/halderman/halderman.pdf) (PDF). *Communications of the ACM*. **52** (5): 91‚Äì98. [doi](/wiki/Doi_%28identifier%29 "Doi (identifier)"):[10.1145/1506409.1506429](https://doi.org/10.1145/1506409.1506429). [ISSN](/wiki/ISSN_%28identifier%29 "ISSN (identifier)")¬†[0001-0782](https://search.worldcat.org/issn/0001-0782). [S2CID](/wiki/S2CID_%28identifier%29 "S2CID (identifier)")¬†[7770695](https://api.semanticscholar.org/CorpusID%3A7770695).
3. ^ [***a***](#cite_ref-forensic2011_3-0) [***b***](#cite_ref-forensic2011_3-1) [***c***](#cite_ref-forensic2011_3-2) [***d***](#cite_ref-forensic2011_3-3) [***e***](#cite_ref-forensic2011_3-4) [***f***](#cite_ref-forensic2011_3-5) [***g***](#cite_ref-forensic2011_3-6) [***h***](#cite_ref-forensic2011_3-7) Carbone, Richard; Bean, C; Salois, M (January 2011). [*An in-depth analysis of the cold boot attack*](https://www.forensicfocus.com/stable/wp-content/uploads/2011/08/cold_boot_attack_for_forensiscs1.pdf) (PDF). Defence Research and Development Canada.
4. **[^](#cite_ref-skorobogatov2002_4-0)** Skorobogatov, Sergei (June 2002). [*Low temperature data remanence in static RAM*](https://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-536.pdf) (PDF). University of Cambridge.
5. ^ [***a***](#cite_ref-bitlocker2008_5-0) [***b***](#cite_ref-bitlocker2008_5-1) [***c***](#cite_ref-bitlocker2008_5-2) MacIver, Douglas (2008-02-25). ["System Integrity Team Blog: Protecting BitLocker from Cold Attacks (and other threats)"](https://docs.microsoft.com/en-us/archive/blogs/si_team/protecting-bitlocker-from-cold-attacks-and-other-threats). [Microsoft](/wiki/Microsoft "Microsoft"). Retrieved 2020-06-24.
6. **[^](#cite_ref-memTool2008_6-0)** ["Memory Research Project Source Code"](https://web.archive.org/web/20130605132146/https%3A//citp.princeton.edu/research/memory/code/). *Center for Information Technology Policy*. 2008-06-16. Archived from [the original](https://citp.princeton.edu/research/memory/code/) on 2013-06-05. Retrieved 2018-11-06.
7. **[^](#cite_ref-7)** ["Passware Software Cracks BitLocker Encryption Open"](http://www.prnewswire.com/news-releases/passware-software-cracks-bitlocker-encryption-open-78212917.html) (Press release). PR Newswire. 2009-12-01.
8. **[^](#cite_ref-hargreaves2008_8-0)** Hargreaves, C.; Chivers, H. (March 2008). ["Recovery of Encryption Keys from Memory Using a Linear Scan"](https://www.researchgate.net/publication/221548532). *2008 Third International Conference on Availability, Reliability and Security*. 2008 Third International Conference on Availability, Reliability and Security. pp.¬†1369‚Äì1376. [doi](/wiki/Doi_%28identifier%29 "Doi (identifier)"):[10.1109/ARES.2008.109](https://doi.org/10.1109/ARES.2008.109). [ISBN](/wiki/ISBN_%28identifier%29 "ISBN (identifier)")¬†[978-0-7695-3102-1](/wiki/Special%3ABookSources/978-0-7695-3102-1 "Special:BookSources/978-0-7695-3102-1").
9. **[^](#cite_ref-carbone2011_9-0)** Carbone, R.; Bean, C; Salois, M. (January 2011). ["An In-depth Analysis of the Cold Boot Attack: Can it be Used for Sound Forensic Memory Acquisition?"](https://web.archive.org/web/20130408131959/http%3A//www.dtic.mil/cgi-bin/GetTRDoc?AD=ADA545078). *Defense Technical Information Center*. Archived from [the original](http://www.dtic.mil/cgi-bin/GetTRDoc?AD=ADA545078) (pdf) on April 8, 2013.
10. ^ [***a***](#cite_ref-gruhn2016_10-0) [***b***](#cite_ref-gruhn2016_10-1) Gruhn, Michael (2016-11-24). ["Forensically Sound Data Acquisition in the age of Anti-Forensic Innocence"](https://d-nb.info/1122350279/34). Erlangen, Germany: Friedrich-Alexander-Universit√§t Erlangen-N√ºrnberg.
11. **[^](#cite_ref-bitlockerOverview2008_11-0)** ["BitLocker Drive Encryption Technical Overview"](https://technet.microsoft.com/en-us/library/cc732774.aspx). [Microsoft](/wiki/Microsoft "Microsoft"). 2008. Retrieved 2008-11-19.
12. ^ [***a***](#cite_ref-tresor-usenix_12-0) [***b***](#cite_ref-tresor-usenix_12-1) [***c***](#cite_ref-tresor-usenix_12-2) [TRESOR USENIX paper, 2011](http://www1.informatik.uni-erlangen.de/tresorfiles/tresor.pdf) [Archived](https://web.archive.org/web/20120113062139/http%3A//www1.informatik.uni-erlangen.de/tresorfiles/tresor.pdf) 2012-01-13 at the [Wayback Machine](/wiki/Wayback_Machine "Wayback Machine")
13. **[^](#cite_ref-loopamnesia-acsac_13-0)** Simmons, Patrick (2011-12-05). [*Security through amnesia: a software-based solution to the cold boot attack on disk encryption*](https://web.archive.org/web/20181106132326/https%3A//www.ideals.illinois.edu/bitstream/handle/2142/18862/amnesia.pdf?sequence=2&isAllowed=y) (PDF). Proceedings of the 27th Annual Computer Security Applications Conference. ACM. pp.¬†73‚Äì82. [doi](/wiki/Doi_%28identifier%29 "Doi (identifier)"):[10.1145/2076732.2076743](https://doi.org/10.1145/2076732.2076743). [ISBN](/wiki/ISBN_%28identifier%29 "ISBN (identifier)")¬†[978-1-4503-0672-0](/wiki/Special%3ABookSources/978-1-4503-0672-0 "Special:BookSources/978-1-4503-0672-0"). Archived from [the original](https://www.ideals.illinois.edu/bitstream/handle/2142/18862/amnesia.pdf?sequence=2&isAllowed=y) (PDF) on 2018-11-06. Retrieved 2018-11-06.
14. **[^](#cite_ref-muller2010_14-0)** M√ºller, Tilo (2010-05-31). ["Cold-Boot Resistant Implementation of AES in the Linux Kernel"](https://faui1-files.cs.fau.de/filepool/thesis/diplomarbeit-2010-mueller.pdf) (PDF). Aachen, Germany: RWTH Aachen University.
15. **[^](#cite_ref-tresorBlog_15-0)** Friedrich-Alexander-Universit√§t Erlangen-N√ºrnberg. ["Tresor / TreVisor / Armored: TRESOR Runs Encryption Securely Outside RAM / The TRESOR Hypervisor / for Android-driven Devices"](https://www.cs1.tf.fau.de/research/system-security-and-software-protection-group/tresor-trevisor-armored/). Retrieved 2018-11-06.
16. **[^](#cite_ref-tews2010_16-0)** Tews, Erik (December 2010). [*FrozenCache ‚Äì Mitigating cold-boot attacks for Full-Disk-Encryption software*](https://events.ccc.de/2010/12/28/frozen-cache/). 27th Chaos Communication.
17. **[^](#cite_ref-frozencache_17-0)** [Frozen Cache Blog](http://frozencache.blogspot.com/)
18. **[^](#cite_ref-copker_18-0)** Guan, Le; Lin, Jingqiang; Luo, Bo; Jing, Jiwu (February 2014). [*Copker: Computing with Private Keys without RAM*](https://web.archive.org/web/20160803150133/http%3A//www.internetsociety.org/sites/default/files/07_1_1.pdf) (PDF). 21st ISOC Network and Distributed System Security Symposium (NDSS). Archived from [the original](https://www.internetsociety.org/sites/default/files/07_1_1.pdf) (PDF) on 2016-08-03. Retrieved 2016-03-01.
19. **[^](#cite_ref-guan2015_19-0)** Guan, L.; Lin, J.; Luo, B.; Jing, J.; Wang, J. (May 2015). ["Protecting Private Keys against Memory Disclosure Attacks Using Hardware Transactional Memory"](https://www.ieee-security.org/TC/SP2015/papers-archived/6949a003.pdf) (PDF). *2015 IEEE Symposium on Security and Privacy*. 2015 IEEE Symposium on Security and Privacy. pp.¬†3‚Äì19. [doi](/wiki/Doi_%28identifier%29 "Doi (identifier)"):[10.1109/SP.2015.8](https://doi.org/10.1109/SP.2015.8). [ISBN](/wiki/ISBN_%28identifier%29 "ISBN (identifier)")¬†[978-1-4673-6949-7](/wiki/Special%3ABookSources/978-1-4673-6949-7 "Special:BookSources/978-1-4673-6949-7").
20. **[^](#cite_ref-dean2009_20-0)** Dean, Sarah (2009-11-11). ["Cold Boot Attacks on Encryption Keys (aka "DRAM attacks")"](https://web.archive.org/web/20120915080532/http%3A//www.freeotfe.org/docs/Main/FAQ.htm#de). Archived from [the original](http://www.freeotfe.org/docs/Main/FAQ.htm#de) on 2012-09-15. Retrieved 2008-11-11.
21. **[^](#cite_ref-wired2008_21-0)** ["Encryption Still Good; Sleeping Mode Not So Much, PGP Says"](http://blog.wired.com/27bstroke6/2008/02/encryption-stil.html). *[Wired](/wiki/Wired_%28magazine%29 "Wired (magazine)")*. 2008-02-21. Retrieved 2008-02-22.
22. **[^](#cite_ref-weis_22-0)** Weis S, PrivateCore (2014-06-25). [*Protecting Data In-Use from Firmware and Physical Attacks*](https://www.blackhat.com/docs/us-14/materials/us-14-Weis-Protecting-Data-In-Use-From-Firmware-And-Physical-Attacks-WP.pdf#page=2) (PDF). [Black Hat USA 2014](https://www.blackhat.com/us-14/archives.html#Weis). Palo Alto, California, U. S. A. p.¬†2.
23. **[^](#cite_ref-23)** B. Huang ["Keeping Secrets in Hardware: The Microsoft Xbox Case Study"](http://web.mit.edu/bunnie/www/proj/anatak/AIM-2002-008.pdf), "CHES 2002 Lecture Notes in Notes in Computer Science Volume 2523", 2003
24. ^ [***a***](#cite_ref-ramCrypt2016_24-0) [***b***](#cite_ref-ramCrypt2016_24-1) G√∂tzfried, Johannes; M√ºller, Tilo; Drescher, Gabor; N√ºrnberger, Stefan; Backes, Michael (2016). ["RamCrypt: Kernel-based Address Space Encryption for User-mode Processes"](https://faui1-files.cs.fau.de/filepool/projects/ramcrypt/ramcrypt.pdf) (PDF). *Proceedings of the 11th ACM on Asia Conference on Computer and Communications Security*. ASIA CCS '16. New York, NY, USA: ACM. pp.¬†919‚Äì924. [doi](/wiki/Doi_%28identifier%29 "Doi (identifier)"):[10.1145/2897845.2897924](https://doi.org/10.1145/2897845.2897924). [ISBN](/wiki/ISBN_%28identifier%29 "ISBN (identifier)")¬†[978-1-4503-4233-9](/wiki/Special%3ABookSources/978-1-4503-4233-9 "Special:BookSources/978-1-4503-4233-9"). Retrieved 2018-11-07.
25. **[^](#cite_ref-25)** Y. Hu, G. Hammouri, and B. Sunar ["A fast real-time memory authentication protocol"](http://dl.acm.org/citation.cfm?id=1456461), "STC '08 Proceedings of the 3rd ACM workshop on Scalable trusted computing", 2008
26. **[^](#cite_ref-26)** G. Duc and R. Keryell, ["CryptoPage: an efficient secure architecture with memory encryption, integrity and information leakage protection"](https://ieeexplore.ieee.org/xpl/articleDetails.jsp?arnumber=4041192), Dec. 2006
27. **[^](#cite_ref-27)** X. Chen, R. P. Dick, and A. Choudhary ["Operating system controlled processor-memory bus encryption"](http://dl.acm.org/citation.cfm?id=1403657,), "Proceedings of the conference on Design, automation and test in Europe", 2008
28. **[^](#cite_ref-28)** ["VeraCrypt Release Notes"](https://www.veracrypt.fr/en/Release%20Notes.html).
29. **[^](#cite_ref-29)** M. Henson and S. Taylor ["Beyond full disk encryption:protection on security-enhanced commodity processors"](http://dl.acm.org/citation.cfm?id=2524549), "Proceedings of the 11th international conference on applied cryptography and network security", 2013
30. **[^](#cite_ref-30)** M. Henson and S. Taylor ["Memory encryption: a survey of existing techniques"](http://dl.acm.org/citation.cfm?id=2566673), "ACM Computing Surveys volume 46 issue 4", 2014
31. **[^](#cite_ref-31)** ["TCG Platform Reset Attack Mitigation Specification"](https://www.trustedcomputinggroup.org/resources/pc_client_work_group_platform_reset_attack_mitigation_specification_version_10/). [Trusted Computing Group](/wiki/Trusted_Computing_Group "Trusted Computing Group"). May 28, 2008. Retrieved June 10, 2009.
32. **[^](#cite_ref-32)** Teague, Ryne (2017). "EVIDENCE VERIFICATION COMPLICATIONS WITH SOLID-STATE DRIVES". *Association of Digital Forensics, Security and Law*. **12**: 75‚Äì85 ‚Äì via ProQuest.
33. **[^](#cite_ref-tails_33-0)** ["Tails - Protection against cold boot attacks"](https://tails.boum.org/doc/advanced_topics/cold_boot_attacks/index.en.html). Retrieved 7 November 2018.
34. **[^](#cite_ref-34)** ["Erase video memory on shutdown (#5356) ¬∑ Issues ¬∑ tails / Tails ¬∑ GitLab"](https://redmine.tails.boum.org/code/issues/5356).
35. **[^](#cite_ref-35)** ["The Palinopsia Bug"](https://hsmr.cc/palinopsia/). *hsmr.cc*. 2022-04-17. [Archived](https://web.archive.org/web/20220224224922/https%3A//hsmr.cc/palinopsia/) from the original on 2022-02-24. Retrieved 2022-04-17.
36. **[^](#cite_ref-36)** ["Tor: Onion Service Protocol"](https://2019.www.torproject.org/docs/onion-services.html.en). *2019.www.torproject.org*. 2022-04-17. [Archived](https://web.archive.org/web/20220405071524/https%3A//2019.www.torproject.org/docs/onion-services.html.en) from the original on 2022-04-05. Retrieved 2022-04-17.
37. **[^](#cite_ref-37)** <https://svn-archive.torproject.org/svn/projects/design-paper/tor-design.pdf> [*[bare URL PDF](/wiki/Wikipedia%3ABare_URLs "Wikipedia:Bare URLs")*]
38. **[^](#cite_ref-38)** Igor Skochinsky (2014-03-12). ["Secret of Intel Management Engine"](https://www.slideshare.net/codeblue_jp/igor-skochinsky-enpub). *SlideShare*. pp.¬†26‚Äì29. Retrieved 2014-07-13.
39. **[^](#cite_ref-39)** ["2nd Generation Intel Core Processor Family Desktop, Intel Pentium Processor Family Desktop, and Intel Celeron Processor Family Desktop"](http://www.intel.com/content/dam/www/public/us/en/documents/datasheets/2nd-gen-core-desktop-vol-1-datasheet.pdf) (PDF). June 2013. p.¬†23. Retrieved 2015-11-03.
40. **[^](#cite_ref-40)** ["2nd Generation Intel Core Processor Family Mobile and Intel Celeron Processor Family Mobile"](http://www.intel.com/content/dam/www/public/us/en/documents/datasheets/2nd-gen-core-family-mobile-vol-1-datasheet.pdf) (PDF). September 2012. p.¬†24. Retrieved 2015-11-03.
41. **[^](#cite_ref-41)** Michael Gruhn, Tilo Muller. ["On the Practicability of Cold Boot Attacks"](https://www1.cs.fau.de/filepool/projects/coldboot/fares_coldboot.pdf) (PDF). Retrieved 2018-07-28.
42. **[^](#cite_ref-42)** Johannes Bauer; Michael Gruhn; Felix C. Freiling (2016). ["Lest we forget: Cold-boot attacks on scrambled DDR3 memory"](https://doi.org/10.1016/j.diin.2016.01.009). *Digital Investigation*. **16**: S65 ‚Äì S74. [doi](/wiki/Doi_%28identifier%29 "Doi (identifier)"):[10.1016/j.diin.2016.01.009](https://doi.org/10.1016/j.diin.2016.01.009).
43. **[^](#cite_ref-43)** Salessawi Ferede; Yitbarek Misiker; Tadesse Aga. ["Cold Boot Attacks are Still Hot: Security Analysis of Memory Scramblers in Modern Processors"](https://web.eecs.umich.edu/~taustin/papers/HPCA17-coldboot.pdf) (PDF). Retrieved 2018-07-28.
44. **[^](#cite_ref-microsoftBios2018_44-0)** kpacquer (2018-05-14). ["Boot to UEFI Mode or Legacy BIOS mode"](https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/boot-to-uefi-mode-or-legacy-bios-mode). *Microsoft*. Retrieved 2018-11-06.
45. **[^](#cite_ref-biosKeys_45-0)** S, Ray (2015-12-08), [*Booting to the Boot Menu and BIOS*](https://kb.wisc.edu/page.php?id=58779), University of Wisconsin-Madison, retrieved 2018-11-06
46. **[^](#cite_ref-dell_46-0)** Dell Inc. (2018-10-09). ["How to Perform a BIOS or CMOS Reset and/or Clear the NVRAM on your Dell System | Dell Australia"](https://www.dell.com/support/article/au/en/aubsdt1/sln284985/how-to-perform-a-bios-or-cmos-reset-and-or-clear-the-nvram-on-your-dell-system). *Dell Support*.
47. **[^](#cite_ref-47)** Ruud, Schramp (2014-06-13), [*OHM2013: RAM Memory acquisition using live-BIOS modification*](https://www.youtube.com/watch?v=i_WvtO1NIsA), [archived](https://ghostarchive.org/varchive/youtube/20211221/i_WvtO1NIsA) from the original on 2021-12-21, retrieved 2018-07-28
48. **[^](#cite_ref-48)** Michael, Gruhn (2016). [*Forensically Sound Data Acquisition in the Age of Anti-Forensic Innocence*](http://nbn-resolving.de/urn%3Anbn%3Ade%3Abvb%3A29-opus4-79386) (Thesis). Friedrich-Alexander-Universit√§t Erlangen-N√ºrnberg (FAU). p.¬†67.
49. **[^](#cite_ref-49)** Schramp, R. (March 2017). "Live transportation and RAM acquisition proficiency test". *Digital Investigation*. **20**: 44‚Äì53. [doi](/wiki/Doi_%28identifier%29 "Doi (identifier)"):[10.1016/j.diin.2017.02.006](https://doi.org/10.1016/j.diin.2017.02.006). [ISSN](/wiki/ISSN_%28identifier%29 "ISSN (identifier)")¬†[1742-2876](https://search.worldcat.org/issn/1742-2876).
50. ^ [***a***](#cite_ref-cellPhones2018_50-0) [***b***](#cite_ref-cellPhones2018_50-1) [***c***](#cite_ref-cellPhones2018_50-2) Bali, Ranbir Singh (July 2018). [*Cold Boot Attack on Cell Phones*](https://www.researchgate.net/publication/326211565). Concordia University of Edmonton.`{{[cite book](/wiki/Template%3ACite_book "Template:Cite book")}}`: CS1 maint: location missing publisher ([link](/wiki/Category%3ACS1_maint%3A_location_missing_publisher "Category:CS1 maint: location missing publisher"))

## External links

[[edit](/w/index.php?title=Cold_boot_attack&action=edit&section=19 "Edit section: External links")]

* [Lest We Remember: Cold Boot Attacks on Encryption Keys](https://www.youtube.com/watch?v=JDaicPIgn9U) on [YouTube](/wiki/YouTube_video_%28identifier%29 "YouTube video (identifier)")
* [McGrew Security's Proof of Concept](https://web.archive.org/web/20080516212552/http%3A//mcgrewsecurity.com/projects/msramdmp/)
* [Boffins Freeze Phone to Crack Android On-Device Crypto](https://www.theregister.co.uk/2013/02/16/frost_android_encryption_crack/)
* Skorobogatov, Sergei (June 2002). ["Low temperature data remanence in static RAM"](http://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-536.html). *[University of Cambridge](/wiki/University_of_Cambridge "University of Cambridge")*. [doi](/wiki/Doi_%28identifier%29 "Doi (identifier)"):[10.48456/tr-536](https://doi.org/10.48456/tr-536). Retrieved 2008-02-27.

![](https://login.wikimedia.org/wiki/Special:CentralAutoLogin/start?useformat=desktop&type=1x1&usesul3=0)
Retrieved from "<https://en.wikipedia.org/w/index.php?title=Cold_boot_attack&oldid=1255149176>"
[Categories](/wiki/Help%3ACategory "Help:Category"):

* [Disk encryption](/wiki/Category%3ADisk_encryption "Category:Disk encryption")
* [Side-channel attacks](/wiki/Category%3ASide-channel_attacks "Category:Side-channel attacks")
Hidden categories:

* [Webarchive template wayback links](/wiki/Category%3AWebarchive_template_wayback_links "Category:Webarchive template wayback links")
* [All articles with bare URLs for citations](/wiki/Category%3AAll_articles_with_bare_URLs_for_citations "Category:All articles with bare URLs for citations")
* [Articles with bare URLs for citations from March 2022](/wiki/Category%3AArticles_with_bare_URLs_for_citations_from_March_2022 "Category:Articles with bare URLs for citations from March 2022")
* [Articles with PDF format bare URLs for citations](/wiki/Category%3AArticles_with_PDF_format_bare_URLs_for_citations "Category:Articles with PDF format bare URLs for citations")
* [CS1 maint: location missing publisher](/wiki/Category%3ACS1_maint%3A_location_missing_publisher "Category:CS1 maint: location missing publisher")
* [Articles with short description](/wiki/Category%3AArticles_with_short_description "Category:Articles with short description")
* [Short description matches Wikidata](/wiki/Category%3AShort_description_matches_Wikidata "Category:Short description matches Wikidata")
* [All articles with unsourced statements](/wiki/Category%3AAll_articles_with_unsourced_statements "Category:All articles with unsourced statements")
* [Articles with unsourced statements from December 2015](/wiki/Category%3AArticles_with_unsourced_statements_from_December_2015 "Category:Articles with unsourced statements from December 2015")
* [All articles lacking reliable references](/wiki/Category%3AAll_articles_lacking_reliable_references "Category:All articles lacking reliable references")
* [Articles lacking reliable references from November 2018](/wiki/Category%3AArticles_lacking_reliable_references_from_November_2018 "Category:Articles lacking reliable references from November 2018")
* [Articles with unsourced statements from February 2019](/wiki/Category%3AArticles_with_unsourced_statements_from_February_2019 "Category:Articles with unsourced statements from February 2019")
* [Articles with unsourced statements from April 2023](/wiki/Category%3AArticles_with_unsourced_statements_from_April_2023 "Category:Articles with unsourced statements from April 2023")

* This page was last edited on 3 November 2024, at 11:43¬†(UTC).
* Text is available under the [Creative Commons Attribution-ShareAlike 4.0 License](/wiki/Wikipedia%3AText_of_the_Creative_Commons_Attribution-ShareAlike_4.0_International_License "Wikipedia:Text of the Creative Commons Attribution-ShareAlike 4.0 International License");
  additional terms may apply. By using this site, you agree to the [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use "foundation:Special:MyLanguage/Policy:Terms of Use") and [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3APrivacy_policy "foundation:Special:MyLanguage/Policy:Privacy policy"). Wikipedia¬Æ is a registered trademark of the [Wikimedia Foundation, Inc.](https://wikimediafoundation.org/), a non-profit organization.

* [Privacy policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3APrivacy_policy)
* [About Wikipedia](/wiki/Wikipedia%3AAbout)
* [Disclaimers](/wiki/Wikipedia%3AGeneral_disclaimer)
* [Contact Wikipedia](//en.wikipedia.org/wiki/Wikipedia%3AContact_us)
* [Code of Conduct](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AUniversal_Code_of_Conduct)
* [Developers](https://developer.wikimedia.org)
* [Statistics](https://stats.wikimedia.org/#/en.wikipedia.org)
* [Cookie statement](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ACookie_statement)
* [Mobile view](//en.m.wikipedia.org/w/index.php?title=Cold_boot_attack&mobileaction=toggle_view_mobile)

* [![Wikimedia Foundation](/static/images/footer/wikimedia-button.svg)](https://wikimediafoundation.org/)
* [![Powered by MediaWiki](/w/resources/assets/poweredby_mediawiki.svg)](https://www.mediawiki.org/)

Search

Search

Toggle the table of contents

Cold boot attack

9 languages

Add topic



=== Content from douevenknow.us_aafbc4f7_20250119_140210.html ===

[[Segmentation Fault]](/ "[Segmentation Fault]")

1. 00.
2. 01.
3. 02.

I am a programming and reverse engineering enthusiast who probably keeps going farther than they should.
[Archive](/archive)
[Random](/random)

![Profile Photo](https://64.media.tumblr.com/avatar_19c67fce6734_128.pnj)
Feel free to check out my other work or follow me on social media in the links below.

1. [Questions? Comments? Criticism? All is welcome.](/ask "Ask a question")
2. [RSS Feed](https://douevenknow.us/rss "RSS Feed")
3. [Mobile](/mobile "View mobile version")

[![GitHub](https://static.tumblr.com/ubkenek/Qv0luyv55/github-icon.png)](https://github.com/shinyquagsire23 "GitHub")
[![GooglePlus Icon](https://static.tumblr.com/ubkenek/G6uluz2hj/googleplus-icon.png)](https://plus.google.com/u/1/100105085728881429255 "Google Plus")
[![Twitter Icon](https://static.tumblr.com/ubkenek/wialuyvfa/twitter-icon.png)](http://twitter.com/ShinyQuagsire "Twitter")

[üîã
üì±‚ùÑÔ∏èü•æüîì, an EL1/EL3 coldboot vulnerability affecting 7 years of LG Android devices](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability)

I should probably preface all of this by saying that I‚Äôm not really a security professional in the sense that I don‚Äôt actually do security stuff for a living; I reported this vulnerability in March and gave a 90 day delay on releasing specific details mostly just because that‚Äôs A Thing That Security Researchers Do. Also the vulnerability doesn‚Äôt require user interaction from coldboot so it‚Äôs a bit nasty in that regard. But also this vulnerability sat around for 7 years so it could be argued that, if anything, 90 days is too long.

Anyhow jumping into things, this is a writeup documenting¬†[CVE-2020-12753](https://nvd.nist.gov/vuln/detail/CVE-2020-12753), a bootloader vulnerability affecting most Qualcomm-based LG phones since the Nexus 5, all the way up to the my test device, the LG Stylo 4 Q710 (and 5 Q720), and probably others. While working on the implementation of this vulnerability I thought it was odd how few bootloader vulnerabilities for Android actually get properly documented, and given the sheer spread of affected devices of this particular vuln I thought it‚Äôd be interesting to document it in detail.

**A Quick Primer on the (Qualcomm) Android Boot Process**

The device I‚Äôm working with, the Stylo 4, operates on 2013-2016 variant of Qualcomm‚Äôs boot sequence described at <https://lineageos.org/engineering/Qualcomm-Firmware/>:

![image](https://64.media.tumblr.com/71ccac3e1f7f43ca8f6e546ad38f332c/f8833c921da777cc-3e/s500x750/29fda1846ecf50e3f1ab119058e612ef39c6b0a6.png)

- On power-on, the Primary Bootloader (PBL) initializes DRAM, eMMC, etc and then loads and verifies SBL1 (Secondary Bootloader 1) from eMMC.
- SBL1 then loads and verifies the Trusted Execution Environment (TEE), aboot, and a few other bits and pieces and then jumps to the TEE, in this case Qualcomm‚Äôs Secure Execution Environment (QSEE)
- QSEE sets up secure EL3/EL1 (TrustZone) and jumps down to aboot (non-secure EL1)
- aboot loads and verifies the Linux kernel and jumps to it

Some Android devices allow ‚Äúbootloader unlocking‚Äù, which allows unsigned kernels to be loaded and run. Generally this unlocking occurs via aboot, and the implementation varies from vendor to vendor, however in most cases what happens is that a fastboot command gets sent to the phone to unlock/lock the phone, and as part of [Android‚Äôs Verified Boot](https://source.android.com/security/verifiedboot/boot-flow), the phone‚Äôs storage is wiped on this transition. There‚Äôs also some requirements on user verification so that, in theory, this unlock cannot occur without user interaction.

Additionally, with verified boot enabled, Android will use [dm-verity](https://source.android.com/security/verifiedboot/dm-verity) to verify all files on the root/system partition, and SELinux is run as Enforcing.

**Variants on the Boot Process, added by LG**

In practice, the boot process isn‚Äôt quite so simple: Vendors are able to add modifications to the boot process as they see fit. In LG‚Äôs case, these differences can be summarized as follows:
- Hardware bringup in SBL for charging PMICs, LEDs, and other misc hardware
- Misc logging/debugging modifications
- Additional TEE processes for SIM unlocking, backed by RPMB
- In aboot, vendor-specific fastboot commands (or no fastboot at all in the case of my device), restrictions on unlocking via certificates, verification modifications, additional boot args for Linux, etc
- Vendor-specific recoveries/flashers, LAF in the case of LG

While I initially started in a privesc from within Linux (and got ~close to getting kernel execution), Google has done a lot of work to ensure that vendors can‚Äôt mess up Android security. However, bootloaders have a lot less oversight, so going after these vendor-specific bits of hardware bringup seemed extremely opportune for errors.

**Introducing: raw\_resources**

At an undetermined point in time (likely prior to the Nexus 5 releasing), LG added an ‚Äúimgdata‚Äù partition on eMMC to store boot graphics for Download Mode, fastboot graphics, charging graphics, the unlock graphic and so on. Image data is stored RLE compressed and for each image, metadata for the image width, height, x and y position are specified. The Nexus 5‚Äôs final bootloader image, as far as I can tell, only accesses this partition from aboot; SBL1 is not affected on this device. For the curious, I have a Python3 script which can extract these images at <https://gist.github.com/shinyquagsire23/ba0f6209592d50fb8e4166620228aaa5>.

![image](https://64.media.tumblr.com/7e8708ee47b63eb7270716d2a9175602/f8833c921da777cc-ac/s250x400/37620545d50e53188b44578e25af6f361f71178c.png)![image](https://64.media.tumblr.com/cb2dd3865b7ae70ba4af2950a34fb1fb/f8833c921da777cc-8e/s250x400/f953b7153f1a1631f1b9ff5bc4e59cd61d7a56c9.png)

*A few examples of Nexus 5 imgdata resources*

imgdata later became raw\_resources, and at an undetermined point, the same RLE decompression and metadata interpreting was copied into SBL1 for use in boot paths where the battery has discharged significantly. If the battery is discharged too far, SBL1‚Äôs pm\_sbl\_chg\_check\_weak\_battery\_status will display LGE\_PM\_NO\_CHARGER for boot attempts made without a charger connected, LGE\_PM\_WEAK\_CHARGING\_ON for boot attempts with a charger connected, and LGE\_PM\_NO\_BATERY\_ANI\_\* for boot attempts made without a battery. A script for extracting raw\_resources can be found at <https://gist.github.com/shinyquagsire23/b69ca343fd2f246aee882ecb5af702bd>.

![image](https://64.media.tumblr.com/d120ad227397e72155075166f13e31e2/f8833c921da777cc-98/s250x400/28249d57f2b65fcdeac385b8667652c64dbaa94a.png)![image](https://64.media.tumblr.com/a51b53313f61f721a702f3ec2eebd61e/f8833c921da777cc-7f/s250x400/2d2585b6e25abd115d815376a501a0330d7da695.png)

*A few examples of Q710 resources*

On normal boot paths, aboot reads raw\_resources to display the boot logo, download mode graphic, and verified boot statuses for devices which allow unlocking. In my case, the Q710/Q720 does not allow for unlocking, so this boot path is never reached on these devices. However, the graphics still exist I guess on the off chance that they allowed it to happen.

For the C inclined, the format of raw\_resources can be summarized in these structs:
typedef struct boot\_img\_header
{
 ¬† ¬†char magic[0x10];
 ¬† ¬†uint32\_t num\_imgs;
 ¬† ¬†uint32\_t version;
 ¬† ¬†char device[0x10];
 ¬† ¬†uint32\_t signature\_offs;
} boot\_img\_header;

typedef struct img\_info
{
 ¬† ¬†char name[0x28];
 ¬† ¬†uint32\_t data\_offset;
 ¬† ¬†uint32\_t data\_size;
 ¬† ¬†uint32\_t width;
 ¬† ¬†uint32\_t height;
 ¬† ¬†uint32\_t offs\_x;
 ¬† ¬†uint32\_t offs\_y;
} img\_info;

The following calculation is performed in order to determine the output pointer to be used during decompression:
bpp = 24
screen\_stride = fbinfo->screen\_width;
fbuf\_offset = offs\_x + (screen\_stride \* offs\_y);
fbuf\_out = (fbuf\_offset \* (bpp / 8)) + fbinfo->buffer;

offs\_x and offs\_y are not bounds checked, and fbinfo->buffer is known in SBL1 and aboot, allowing for a controlled arbitrary write in both environments.

**SBL1 load\_res\_888rle\_image Arbitrary Write**

This boot path requires discharging the battery to below 0%. While this is less feasible for any practical usage, performing the arbitrary write at this point allows patching SBL1 to disable signature verification before TEE and aboot are loaded. Any of the LGE\_PM\_\* images can be hijacked selectively for arbitrary code execution, though for my PoC I used LGE\_PM\_NO\_CHARGER specifically because I didn‚Äôt want to accidentally brick myself (or well, I didn‚Äôt want to have to beep out eMMC wires on the board to unbrick).

A 32-bit x offset can be calculated for any given address divisible by 3 using the following calculation:
offset\_x = (((0x100000000 + target\_addr) - 0x90000000) / 3) & 0xFFFFFFFF

Data written to this arbitrary address can be kept contiguous by specifying the image width to be the same as the screen width. The height should then be rounded up from the payload size to ensure all data is written properly. So really by the end, this isn‚Äôt an arbitrary write so much as it is an arbitrary memcpy at Secure EL3.

**aboot Arbitrary Write**

The aboot arbitrary write functions identically to SBL1: Any image can be selected to perform the arbitrary write. Most notably, this includes any lglogo\_image\_\* graphic, which is displayed by default on every boot. The framebuffer is generally fixed to address 0x90001000, which means that by using the arbitrary write to gain code execution, the original graphic which was used to obtain the arbitrary write can be written to the screen following hijacking to, in effect, make it appear as if boot flow has not been modified at all, for better or for worse.

A good question that might be raised after looking briefly at the structs earlier would be, ‚Äúwait, there‚Äôs a signature offset, why does any of this work if raw\_resources contains a signature?‚Äù And yes, raw\_resources contains a signature! But it‚Äôs a useless signature because this signature is only checked in aboot while displaying verifiedboot\_\* images. At some point, XDA users found out that you could swap the LG boot logos over the verifiedboot\_\* images so that when they unlocked their devices they wouldn‚Äôt have to see the AVB boot nag messages. Naturally, this defeats the point of Google‚Äôs Verified Boot spec since it would potentially allow a bootloader be unlocked without the user knowing, so LG added a signature. But it‚Äôs only checked for the verified boot images.

As a minor note, unlike SBL1, aboot will also select between raw\_resources\_a and raw\_resources\_b depending on the A/B boot slot.

**Practical Exploitation**

I started by exploiting SBL1, partially because Secure EL3 is just cooler than nonsecure EL1, but also because the framebuffer address was more obviously seen than in aboot (though I later found the aboot framebuffer address anyhow). At this point in execution all of the hardware is initialized and no other bootloaders have been loaded, so we‚Äôre basically free to patch sigchecks and control the entire phone!

As it turns out though, SBL1 takes a bit more work to actually exploit, because unlike aboot, its segments aren‚Äôt set RWX. I‚Äôm not really sure why aboot has all of its segments RWX, like at that point it‚Äôs more of a ‚Äòboot‚Äô than a 'secure boot‚Äô if they can‚Äôt even bother to use the easiest security option available.

In any case, ROP is required briefly to bypass the MMU‚Äôs NX bit. This isn‚Äôt too terrible, since SBL1 actually has a routine we can jump to to disable the MMU, though it requires a bit of finnagling to get correct.

So in summary, the exploitation process goes as follows:
 - Flash raw\_resources\_a.img to eMMC (ie via kernel execution, LG LAF, soldered wires and a hardware flasher, etc).
 - For SBL1 hax, drain the battery to below 0%. For my Q710, I drained most of the battery by leaving the screen at max brightness with sleep disabled until the phone powered off on its own after several hours. To drain the remaining battery, I charged enough to enter LAF download mode and left it to drain with the screen on for 2-3 hours.
 - Hold Power and Volume Down until the phone restarts. If the phone discharged enough, the phone should restart into the payload.
 - The phone can be plugged in to boot into aboot and Android normally, but the payload will now execute every time the payload-injected graphic is displayed.

To exploit SBL1:
 - raw\_resources\_a is modified such that the x offset is set to 0x2801CF5C, the width to 1080, and the height to 5. This will decompress LGE\_PM\_NO\_CHARGER (now containing the contents of payload.bin) to 0x08056E14, slightly higher than the stack pointer during decompression.
 - The image is decompressed and load\_res\_888rle\_image exits. The previous LR has now been overwritten by a pointer to a Thumb-mode pop {pc} ROP slide, to account for possible offsetting error.
 - At the end of the ROP slide, the following ROP instruction sequence is executed:

pop {r4-r12, pc} ¬† ¬†; r8 is now set to SBL1\_ARM\_MMU\_DISABLE, and r12 is now set to SBL1\_THUMB\_BX\_R8

pop {r4-r6, lr} ¬† ¬† ; LR is set to the payload pointer
orr r12, r12, #0x1
bx r12 ; jump to SBL1\_THUMB\_BX\_R8

bx r8 ; jump to SBL1\_ARM\_MMU\_DISABLE with lr now set to our payload

**Proof-of-Concept, and Future Plans**

For those interested in experimenting, a PoC can be found [here](https://github.com/shinyquagsire23/CVE-2020-12753-PoC). Note that this is specifically for the LG Q710, and contains offset specific to the AMZ LG Stylo 4 (Q710ULM, 20c\_00\_AMZ\_US\_OP\_1121). I‚Äôm planning on polishing things up further, however my current boot takeover involves two other vulnerabilities that I‚Äôd like to give a bit more time to make sure they‚Äôre actually fixed/close to being fixed before releasing.

In the meantime I‚Äôd be interested in seeing if anyone else is interested in porting this to other LG devices, since I only own a Nexus 5, a Q710 and a Q720. As it is, these vulns will allow bootloader unlocking at a *minimum* on most older Qualcomm LG devices, and secure EL3 on newer ones, which should be *very*¬†interesting for anyone interested in finding vulnerabilities in QSEE/similar on LG devices.

1. [![Date Posted Icon](https://static.tumblr.com/ubkenek/W8Rlmyhj3/datepostedicon.png)
   1st June 2020](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability "Date Posted")
3. [![Notes Icon](https://static.tumblr.com/ubkenek/Qnilmyiga/notesicon.png)
   Notes: 9](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability "Notes")

![Tags Icon](https://static.tumblr.com/ubkenek/CVXlmyivc/tagsicon.png)
[#CVE-2020-12753](https://douevenknow.us/tagged/CVE-2020-12753)[#exploitation](https://douevenknow.us/tagged/exploitation)[#bootloader](https://douevenknow.us/tagged/bootloader)[#Android](https://douevenknow.us/tagged/Android)[#Android ROMs](https://douevenknow.us/tagged/Android%20ROMs)

Page 1 of 1

This blog is powered by [Tumblr](http://tumblr.com "Tumblr") and designed by [CoSnap](http://cosnap.co.uk "The CoSnap website").

![](https://px.srvcs.tumblr.com/impixu?T=1737295330&J=eyJ0eXBlIjoidXJsIiwidXJsIjoiaHR0cDovL2RvdWV2ZW5rbm93LnVzL3RhZ2dlZC9DVkUtMjAyMC0xMjc1MyIsInJlcXR5cGUiOjAsInJvdXRlIjoiL3RhZ2dlZC86dGFnIiwibm9zY3JpcHQiOjF9&U=ANNJHILPEF&K=82091436cbc910275584c4ff75854afe7718b5bd27247c700db209f18a965a71&R=)![](https://px.srvcs.tumblr.com/impixu?T=1737295330&J=eyJ0eXBlIjoicG9zdCIsInVybCI6Imh0dHA6Ly9kb3VldmVua25vdy51cy90YWdnZWQvQ1ZFLTIwMjAtMTI3NTMiLCJyZXF0eXBlIjowLCJyb3V0ZSI6Ii90YWdnZWQvOnRhZyIsInBvc3RzIjpbeyJwb3N0aWQiOiI2MTk3NjMwNzQ4MjI1MjA4MzIiLCJibG9naWQiOjE1MDQxMzE4Miwic291cmNlIjozM31dLCJub3NjcmlwdCI6MX0=&U=FOOBKOAJCJ&K=efcf2af0f23ba356a9c9d81b8fa7e79eec18fe47d489b8077c86cc9c3203052f&R=)

=== Content from www.zdnet.com_a0a1589c_20250119_122332.html ===

                                                                                                                                                                                                       X    Trending

* [Samsung Unpacked 2025: How to watch and what to expect](/article/samsung-unpacked-2025-how-to-watch-and-what-to-expect/)
* [This hidden Pixel camera feature makes your photos more vibrant](/article/this-hidden-pixel-camera-feature-makes-your-photos-more-vibrant-how-to-enable-it/)
* [I invested in a no-fees video doorbell, and it's paying off for my smart home](/home-and-office/smart-home/i-invested-in-a-no-fees-video-doorbell-and-its-paying-off-for-my-smart-home/)
* [I recommend this 2-in-1 laptop to both creatives and professionals](/article/i-recommend-this-2-in-1-laptop-to-both-creatives-and-professionals-and-its-on-sale-right-now/)
* [Don't plug these 7 devices into extension cords](/home-and-office/smart-office/dont-plug-these-7-devices-into-extension-cords-space-heaters-and-other-common-items-included/)
* [MacBook Pro vs. MacBook Air](/article/macbook-air-vs-macbook-pro-how-to-decide)
* [Oura Ring 3 vs Oura Ring 4](/article/oura-ring-3-vs-oura-ring-4/)
* [Apple Pencil Pro vs. Apple Pencil 2](/article/apple-pencil-pro-vs-apple-pencil-2/)

* [Best free VPNs of 2025](/article/best-free-vpn/)
* [Best VPNs for school of 2025](/article/best-vpns-for-school/)
* [Fastest laptops of 2025](/article/fastest-laptops/)
* [Best Dell laptops of 2025](/article/best-dell-laptops/)
* [Best mini PCs of 2025](/article/best-mini-pc/)
* [Best mini PCs for gaming in 2025](/article/best-mini-gaming-pcs/)
* [Best mini ITX PC cases of 2025](/article/best-mini-itx-pc-cases/)

* [Best data removal services: Delete yourself from the internet](/article/best-data-removal-services/)
* [Best email hosting service](/article/best-email-hosting/)
* [Best VPS hosting service](/article/best-vps-hosting-service/)
* [Can your old PC handle the Windows 11 upgrade?](/article/you-can-still-upgrade-old-pcs-to-windows-11-even-if-microsoft-says-no-readers-prove-it/)
* [How to upgrade an incompatible Windows 10 PC to Windows 11](/article/how-to-upgrade-an-incompatible-windows-10-pc-to-windows-11-two-ways/)
* [NEO QLED vs OLED: Which TV tech is right for you?](/home-and-office/home-entertainment/neo-qled-vs-oled-which-technology-is-right-for-you/)
* [ZDNET Recommends](/zdnet-recommends/)
Tech

* [Gaming](/topic/gaming/)
* [Headphones](/topic/headphones/)
* [Laptops](/topic/laptops/)
* [Mobile Accessories](/topic/mobile-accessories/)
* [Networking](/topic/networking/)
* [PCs](/topic/pcs/)

* [Printers](/topic/printers/)
* [Smartphones](/topic/smartphones/)
* [Smart Watches](/topic/smart-watches/)
* [Speakers](/topic/speakers/)
* [Streaming Devices](/topic/streaming-devices/)
* [Streaming Services](/topic/video-streaming-services/)

* [Tablets](/topic/tablets/)
* [TVs](/topic/tvs/)
* [Wearables](/topic/wearables/)

* [Kitchen & Household](/topic/kitchen-household/)
* [Office Furniture](/topic/office-furniture/)
* [Office Hardware & Appliances](/topic/office-hardware-appliances/)
* [Smart Home](/topic/smart-home/)
* [Smart Lighting](/topic/smart-lighting/)
* [Yard & Outdoors](/topic/yard-outdoors/)
Innovation

* [Artificial Intelligence](/topic/artificial-intelligence/)
* [AR + VR](/topic/ar-vr/)
* [Cloud](/topic/cloud/)
* [Digital Transformation](/topic/digital-transformation/)
* [Energy](/topic/energy/)

* [Robotics](/topic/robotics/)
* [Sustainability](/topic/sustainability/)
* [Transportation](/topic/transportation/)
* [Work Life](/topic/work-life/)

* [Accelerate your tech game Paid Content](https://www.zdnet.com/accelerate-your-tech-game/)
* [How the New Space Race Will Drive Innovation](https://www.zdnet.com/topic/how-the-new-space-race-will-drive-innovation/)
* [How the metaverse will change the future of work and society](https://www.zdnet.com/topic/how-the-metaverse-will-change-the-future-of-work-and-society/)

* [Managing the Multicloud](https://www.zdnet.com/topic/managing-the-multicloud/)
* [The Future of the Internet](https://www.zdnet.com/topic/the-future-of-the-internet/)
* [The New Rules of Work](https://www.zdnet.com/topic/the-new-rules-of-work/)
* [The Tech Trends to Watch in 2023](https://www.zdnet.com/topic/the-tech-trends-to-watch-in-2023/)
Business

* [See all Business](/topic/business/)
* [Amazon](/topic/amazon/)
* [Apple](/topic/apple/)
* [Developer](/topic/developer/)
* [E-Commerce](/topic/e-commerce/)

* [Edge Computing](/topic/edge-computing/)
* [Enterprise Software](/topic/enterprise-software/)
* [Executive](/topic/executive/)
* [Google](/topic/google/)
* [Microsoft](/topic/microsoft/)

* [Professional Development](/topic/professional-development/)
* [Social Media](/topic/social-media/)
* [SMB](/topic/smb/)
* [Windows](/topic/windows/)

* [How AI is transforming organizations everywhere](https://www.zdnet.com/topic/how-ai-is-transforming-organizations-everywhere/)
* [The intersection of generative AI and engineering](https://www.zdnet.com/topic/the-intersection-of-generative-ai-and-engineering/)
* [Software development: Emerging trends and changing roles](https://www.zdnet.com/topic/software-development-emerging-trends-and-changing-roles/)
Security

* [See all Security](/topic/security/)
* [Cyber Threats](/topic/cyber-threats/)
* [Password Manager](/topic/password-manager/)
* [Ransomware](/topic/ransomware/)
* [VPN](/topic/vpn/)

* [Cybersecurity: Let's get tactical](https://www.zdnet.com/topic/cybersecurity-lets-get-tactical/)
* [Securing the Cloud](https://www.zdnet.com/topic/cybersecurity-lets-get-tactical/)
Advice

* [Deals](https://www.zdnet.com/deals/)
* [How-to](https://www.zdnet.com/how-to/)
* [Product Comparisons](https://www.zdnet.com/product-comparisons/)
* [Product Spotlights](https://www.zdnet.com/product-spotlights/)
* [Reviews](/reviews/)
Buying Guides

* [See all Buying Guides](/best-products/)
* [Best Samsung phones](/article/best-samsung-phone/)
* [Best Android phones](/article/best-android-phone/)
* [Best smart rings](/article/best-smart-ring/)
* [Best blood pressure watches](/article/best-blood-pressure-watch/)
* [Best headphones for sleeping](/article/best-headphones-for-sleeping/)

* [Best robot vacuum mops](/home-and-office/kitchen-household/best-robot-vacuum-mop/)
* [Best web hosting services](/article/best-web-hosting/)
* [Best travel VPNs](/article/best-travel-vpn/)
* [Best VPNs](/article/best-vpn/)
* [Best AI image generators](/article/best-ai-image-generator/)
* [Best AI chatbots](/article/best-ai-chatbot/)

* [Best 75-inch TVs](/home-and-office/home-entertainment/best-75-inch-tv/)
* [Best smartphones](/article/best-phone/)
* [Best iPhones](/article/best-iphone/)
* [Best MagSafe battery packs](/article/best-magsafe-battery/)
* [Best digital notebooks](/article/best-smart-notebook/)
* [Best TV antennas](/home-and-office/home-entertainment/best-tv-antenna/)

* [Best TVs](/home-and-office/home-entertainment/best-tv/)
* [Best laptops](/article/best-laptop/)
* [Best tablets](/article/best-tablet/)
* [Best smartwatches](/article/best-smartwatch/)
* [Best headphones](/article/best-headphones/)
* [Best live TV streaming services](/home-and-office/home-entertainment/best-live-tv-streaming-service/)
 [tomorrow belongs to those who embrace it today](/about/)

* [ZDNET France](https://www.zdnet.fr/)
* [ZDNET Germany](https://www.zdnet.de/)
* [ZDNET Korea](https://www.zdnet.co.kr/)
* [ZDNET Japan](https://japan.zdnet.com/)
     Go

* [See all Topics](/topic/)
* [Finance](/topic/finance/)
* [Education](/topic/education/)
* [Health](/topic/health/)

* [Special Features](https://www.zdnet.com/topic/?filter=special-features)
* [ZDNET In Depth](/in-depth/)
* [ZDNET Recommends](https://www.zdnet.com/zdnet-recommends/)

* [Newsletters](/newsletters/)
* [Videos](/video/)
* [Editorial Guidelines](/editorial-guidelines/)

* Trending
* [Samsung Unpacked 2025: How to watch and what to expect](/article/samsung-unpacked-2025-how-to-watch-and-what-to-expect/)
* [This hidden Pixel camera feature makes your photos more vibrant](/article/this-hidden-pixel-camera-feature-makes-your-photos-more-vibrant-how-to-enable-it/)
* [I invested in a no-fees video doorbell, and it's paying off for my smart home](/home-and-office/smart-home/i-invested-in-a-no-fees-video-doorbell-and-its-paying-off-for-my-smart-home/)
* [I recommend this 2-in-1 laptop to both creatives and professionals](/article/i-recommend-this-2-in-1-laptop-to-both-creatives-and-professionals-and-its-on-sale-right-now/)
* [Don't plug these 7 devices into extension cords](/home-and-office/smart-office/dont-plug-these-7-devices-into-extension-cords-space-heaters-and-other-common-items-included/)
* [MacBook Pro vs. MacBook Air](/article/macbook-air-vs-macbook-pro-how-to-decide)
* [Oura Ring 3 vs Oura Ring 4](/article/oura-ring-3-vs-oura-ring-4/)
* [Apple Pencil Pro vs. Apple Pencil 2](/article/apple-pencil-pro-vs-apple-pencil-2/)
* [Best free VPNs of 2025](/article/best-free-vpn/)
* [Best VPNs for school of 2025](/article/best-vpns-for-school/)
* [Fastest laptops of 2025](/article/fastest-laptops/)
* [Best Dell laptops of 2025](/article/best-dell-laptops/)
* [Best mini PCs of 2025](/article/best-mini-pc/)
* [Best mini PCs for gaming in 2025](/article/best-mini-gaming-pcs/)
* [Best mini ITX PC cases of 2025](/article/best-mini-itx-pc-cases/)
* [Best data removal services: Delete yourself from the internet](/article/best-data-removal-services/)
* [Best email hosting service](/article/best-email-hosting/)
* [Best VPS hosting service](/article/best-vps-hosting-service/)
* [Can your old PC handle the Windows 11 upgrade?](/article/you-can-still-upgrade-old-pcs-to-windows-11-even-if-microsoft-says-no-readers-prove-it/)
* [How to upgrade an incompatible Windows 10 PC to Windows 11](/article/how-to-upgrade-an-incompatible-windows-10-pc-to-windows-11-two-ways/)
* [NEO QLED vs OLED: Which TV tech is right for you?](/home-and-office/home-entertainment/neo-qled-vs-oled-which-technology-is-right-for-you/)
* [ZDNET Recommends](/zdnet-recommends/)

* Tech
* [Gaming](/topic/gaming/)
* [Headphones](/topic/headphones/)
* [Laptops](/topic/laptops/)
* [Mobile Accessories](/topic/mobile-accessories/)
* [Networking](/topic/networking/)
* [PCs](/topic/pcs/)
* [Printers](/topic/printers/)
* [Smartphones](/topic/smartphones/)
* [Smart Watches](/topic/smart-watches/)
* [Speakers](/topic/speakers/)
* [Streaming Devices](/topic/streaming-devices/)
* [Streaming Services](/topic/video-streaming-services/)
* [Tablets](/topic/tablets/)
* [TVs](/topic/tvs/)
* [Wearables](/topic/wearables/)
* [Kitchen & Household](/topic/kitchen-household/)
* [Office Furniture](/topic/office-furniture/)
* [Office Hardware & Appliances](/topic/office-hardware-appliances/)
* [Smart Home](/topic/smart-home/)
* [Smart Lighting](/topic/smart-lighting/)
* [Yard & Outdoors](/topic/yard-outdoors/)

* Innovation
* [Artificial Intelligence](/topic/artificial-intelligence/)
* [AR + VR](/topic/ar-vr/)
* [Cloud](/topic/cloud/)
* [Digital Transformation](/topic/digital-transformation/)
* [Energy](/topic/energy/)
* [Robotics](/topic/robotics/)
* [Sustainability](/topic/sustainability/)
* [Transportation](/topic/transportation/)
* [Work Life](/topic/work-life/)
* [Accelerate your tech game Paid Content](https://www.zdnet.com/accelerate-your-tech-game/)
* [How the New Space Race Will Drive Innovation](https://www.zdnet.com/topic/how-the-new-space-race-will-drive-innovation/)
* [How the metaverse will change the future of work and society](https://www.zdnet.com/topic/how-the-metaverse-will-change-the-future-of-work-and-society/)
* [Managing the Multicloud](https://www.zdnet.com/topic/managing-the-multicloud/)
* [The Future of the Internet](https://www.zdnet.com/topic/the-future-of-the-internet/)
* [The New Rules of Work](https://www.zdnet.com/topic/the-new-rules-of-work/)
* [The Tech Trends to Watch in 2023](https://www.zdnet.com/topic/the-tech-trends-to-watch-in-2023/)

* Business
* [See all Business](/topic/business/)
* [Amazon](/topic/amazon/)
* [Apple](/topic/apple/)
* [Developer](/topic/developer/)
* [E-Commerce](/topic/e-commerce/)
* [Edge Computing](/topic/edge-computing/)
* [Enterprise Software](/topic/enterprise-software/)
* [Executive](/topic/executive/)
* [Google](/topic/google/)
* [Microsoft](/topic/microsoft/)
* [Professional Development](/topic/professional-development/)
* [Social Media](/topic/social-media/)
* [SMB](/topic/smb/)
* [Windows](/topic/windows/)
* [How AI is transforming organizations everywhere](https://www.zdnet.com/topic/how-ai-is-transforming-organizations-everywhere/)
* [The intersection of generative AI and engineering](https://www.zdnet.com/topic/the-intersection-of-generative-ai-and-engineering/)
* [Software development: Emerging trends and changing roles](https://www.zdnet.com/topic/software-development-emerging-trends-and-changing-roles/)

* Security
* [See all Security](/topic/security/)
* [Cyber Threats](/topic/cyber-threats/)
* [Password Manager](/topic/password-manager/)
* [Ransomware](/topic/ransomware/)
* [VPN](/topic/vpn/)
* [Cybersecurity: Let's get tactical](https://www.zdnet.com/topic/cybersecurity-lets-get-tactical/)
* [Securing the Cloud](https://www.zdnet.com/topic/cybersecurity-lets-get-tactical/)

* Advice
* [Deals](https://www.zdnet.com/deals/)
* [How-to](https://www.zdnet.com/how-to/)
* [Product Comparisons](https://www.zdnet.com/product-comparisons/)
* [Product Spotlights](https://www.zdnet.com/product-spotlights/)
* [Reviews](/reviews/)

* Buying Guides
* [See all Buying Guides](/best-products/)
* [Best Samsung phones](/article/best-samsung-phone/)
* [Best Android phones](/article/best-android-phone/)
* [Best smart rings](/article/best-smart-ring/)
* [Best blood pressure watches](/article/best-blood-pressure-watch/)
* [Best headphones for sleeping](/article/best-headphones-for-sleeping/)
* [Best robot vacuum mops](/home-and-office/kitchen-household/best-robot-vacuum-mop/)
* [Best web hosting services](/article/best-web-hosting/)
* [Best travel VPNs](/article/best-travel-vpn/)
* [Best VPNs](/article/best-vpn/)
* [Best AI image generators](/article/best-ai-image-generator/)
* [Best AI chatbots](/article/best-ai-chatbot/)
* [Best 75-inch TVs](/home-and-office/home-entertainment/best-75-inch-tv/)
* [Best smartphones](/article/best-phone/)
* [Best iPhones](/article/best-iphone/)
* [Best MagSafe battery packs](/article/best-magsafe-battery/)
* [Best digital notebooks](/article/best-smart-notebook/)
* [Best TV antennas](/home-and-office/home-entertainment/best-tv-antenna/)
* [Best TVs](/home-and-office/home-entertainment/best-tv/)
* [Best laptops](/article/best-laptop/)
* [Best tablets](/article/best-tablet/)
* [Best smartwatches](/article/best-smartwatch/)
* [Best headphones](/article/best-headphones/)
* [Best live TV streaming services](/home-and-office/home-entertainment/best-live-tv-streaming-service/)

* More
* [See all Topics](/topic/)
* [Finance](/topic/finance/)
* [Education](/topic/education/)
* [Health](/topic/health/)
* [Special Features](https://www.zdnet.com/topic/?filter=special-features)
* [ZDNET In Depth](/in-depth/)
* [ZDNET Recommends](https://www.zdnet.com/zdnet-recommends/)
* [Newsletters](/newsletters/)
* [Videos](/video/)
* [Editorial Guidelines](/editorial-guidelines/)
 Tech      [Home](/)[Tech](/topic/tech/)[Security](/topic/security/)
# New cold boot attack affects seven years of LG Android smartphones

LG has released a firmware fix in May 2020. Attack requires physical access.
  ![catalin-cimpanu.jpg](https://www.zdnet.com/a/img/resize/cfe8bff3bdc8af3f2ab8d2a4252f39ca491137af/2018/08/21/a59867e9-8d75-40af-a87c-690638f8afa4/catalin-cimpanu.jpg?auto=webp&fit=crop&frame=1&height=192&width=192) Written by [Catalin Cimpanu, Contributor](/meet-the-team/catalin-cimpanu/)  June 2, 2020 at 1:19 p.m. PT

               ![LG smartphone](https://www.zdnet.com/a/img/resize/a38793ac699094595451e3c68d2697c92e9d8bc2/2020/06/02/ed875c87-78ed-42a8-859e-91a4b85f0d2b/lg.jpg?auto=webp&width=1280)

 Image: Ilan Dov

### CNE

 [![galaxy-s10-plus.jpg]()
### Best Phones for 2019

Our editors hand-picked these products based on our tests and reviews.

Read now](https://www.cnet.com/topics/phones/best-phones/?ftag=CMG-01-10aaa1b)

South Korean phone manufacturer LG has released a security update last month to fix a vulnerability that impacts its Android smartphones sold over the past seven years.

The vulnerability, tracked under the identifier of CVE-2020-12753, impacts the bootloader component that ships with LG smartphones.

Separate from the Android OS, the bootloader is a piece of firmware specific to each smartphone vendor. It is the first piece of code that runs when a user starts their device, and it ensures that smartphone firmware and the Android OS itself start in a correct and secure manner.

### Vulnerability found in the LG bootloader graphics package

In March this year, US software engineer Max Thomas discovered a vulnerability in the bootloader component that had been added to LG smartphones starting with the LG Nexus 5 series.

In a [technical breakdown](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability) of the vulnerability published on Tuesday, Thomas says the bootloader component's graphics package contains a bug that lets attackers sneak in their own code to run alongside the bootloader's graphics under certain conditions, such as when the battery dies out and when the device is in the bootloader's Download Mode.

 ![lg-graphics.png]()

 Image: Max Thomas

Thomas says that threat actors who perfectly time an attack can gain the ability to run their own custom code, which could allow them to take over the bootloader, and inherently the entire device. A video demo is embedded below.

The bug impacts all LG smartphones utilizing QSEE (Qualcomm Secure Execution Environment) chips that use the EL1 or EL3 runtime firmware, and all LG devices running Android 7.2 and later.

### Attack requires physical access

To be clear, the CVE-2020-12753 vulnerability is what researchers call a "[cold boot attack](https://en.wikipedia.org/wiki/Cold_boot_attack)," meaning a vulnerability that can only be exploited by having physical access and connecting to a vulnerable device.

However, this doesn't mean the bug is less impactful. In situations where a user's device is stolen or seized, this vulnerability can be used to grant the new owner control over the device and to unlock its secrets.

LG has released a patch for this bug in the LVE-SMP-200006 security update, which the company [released in early May 2020](https://lgsecurity.lge.com/).

Device owners who have a daily threat model that includes losing access to their LG smartphone should look into applying the LVE-SMP-200006 update.

Thomas has also released [proof-of-concept code](https://github.com/shinyquagsire23/CVE-2020-12753-PoC) he used to break the bootloader on an LG Stylo 4 smartphone.

#### LG G8 ThinQ review: in pictures

 [![lg-g8-1.jpg]()](/pictures/lg-g8-thinq-first-look-review-in-pictures/1/) [![lg-g8-2.jpg]()](/pictures/lg-g8-thinq-first-look-review-in-pictures/2/) [![lg-g8-3.jpg]()](/pictures/lg-g8-thinq-first-look-review-in-pictures/3/) [![lg-g8-4.jpg]()](/pictures/lg-g8-thinq-first-look-review-in-pictures/4/) [![lg-g8-5.jpg]()](/pictures/lg-g8-thinq-first-look-review-in-pictures/5/) [![lg-g8-6.jpg]()](/pictures/lg-g8-thinq-first-look-review-in-pictures/6/) [![lg-g8-7.jpg]()](/pictures/lg-g8-thinq-first-look-review-in-pictures/7/) [![lg-g8-8.jpg]()](/pictures/lg-g8-thinq-first-look-review-in-pictures/8/) [![lg-g8-9.jpg]()](/pictures/lg-g8-thinq-first-look-review-in-pictures/9/) [![lg-g8-10.jpg]()](/pictures/lg-g8-thinq-first-look-review-in-pictures/10/) [![lg-g8-11.png]()](/pictures/lg-g8-thinq-first-look-review-in-pictures/11/) [![lg-g8-12.png]()](/pictures/lg-g8-thinq-first-look-review-in-pictures/12/) [![lg-g8-13.png]()](/pictures/lg-g8-thinq-first-look-review-in-pictures/13/) [![lg-g8-14.png]()](/pictures/lg-g8-thinq-first-look-review-in-pictures/14/)
#### Security

   [![ExpressVPN mobile]()
The best VPN services of 2024: Expert tested](/article/best-vpn/ "The best VPN services of 2024: Expert tested") [![Google Pixel 8 display sitting on table.]()
How to turn on Private DNS Mode on Android (and why you should)](/article/how-to-turn-on-private-dns-mode-on-android-and-why-you-should/ "How to turn on Private DNS Mode on Android (and why you should)") [![gettyimages-1779832566]()
The best antivirus software and apps you can buy](/article/best-antivirus/ "The best antivirus software and apps you can buy") [![A black VPN router with its antennas up against an orange background]()
The best VPN routers you can buy](/article/best-vpn-router/ "The best VPN routers you can buy") [![spy-big-brother-digital-surveillance-istock.jpg]()
How to find and remove spyware from your phone](/article/how-to-find-and-remove-spyware-from-your-phone/ "How to find and remove spyware from your phone")

* [![ExpressVPN mobile]()
  The best VPN services of 2024: Expert tested](/article/best-vpn/ "The best VPN services of 2024: Expert tested")
* [![Google Pixel 8 display sitting on table.]()
  How to turn on Private DNS Mode on Android (and why you should)](/article/how-to-turn-on-private-dns-mode-on-android-and-why-you-should/ "How to turn on Private DNS Mode on Android (and why you should)")
* [![gettyimages-1779832566]()
  The best antivirus software and apps you can buy](/article/best-antivirus/ "The best antivirus software and apps you can buy")
* [![A black VPN router with its antennas up against an orange background]()
  The best VPN routers you can buy](/article/best-vpn-router/ "The best VPN routers you can buy")
* [![spy-big-brother-digital-surveillance-istock.jpg]()
  How to find and remove spyware from your phone](/article/how-to-find-and-remove-spyware-from-your-phone/ "How to find and remove spyware from your phone")
 [Editorial standards](/editorial-guidelines/)  Show Comments  Log In to Comment [Community Guidelines](/article/zdnet-community-guidelines/)
###

### Related

 [![A young man and a young woman using OnePlus 10 Pro smartphones to take selfies]()
### The best phones you can buy (and how the OnePlus 13 stacks up)](/article/best-phone/) [![Samsung Smart Monitor M9]()
### This $200 Android is the only smartphone at CES that you should care about](/article/this-200-android-is-the-only-smartphone-at-ces-that-you-should-care-about/) [![Swippit phone battery changer at CES 2025]()
### This viral 'phone toaster' at CES can fully charge your handset in under 5 seconds - sort of](/article/this-viral-phone-toaster-at-ces-can-fully-charge-your-handset-in-under-5-seconds-sort-of/)        ![Footer background image]()  [ZDNET](/) we equip you to harness the power of disruptive innovation, at work and at home.

* [Topics](/topic/)
* [Galleries](/pictures/)
* [Videos](/video/)
* [Do Not Sell or Share My Personal Information](https://www.ziffdavis.com/ztg-privacy-policy/)

* [about ZDNET](/about/)
* [Meet The Team](/feature/meet-the-team-us/)
* [Sitemap](/sitemap/)
* [Reprint Policy](/reprints/)

* Join |
  Log In
* [Newsletters](/newsletters/)
* [Site Assistance](https://zdnet.zendesk.com/hc/en-us)
* Licensing
* [Accessibility](https://www.ziffdavis.com/accessibility/)

¬© 2025 ZDNET, A Ziff Davis company. All rights reserved.
 [Privacy Policy](https://www.ziffdavis.com/ztg-privacy-policy/) |
 |
Cookie Settings |
[Advertise](https://www.zdnet.com/advertise/) |
[Terms of Use](https://www.ziffdavis.com/terms-of-use/)


=== Content from douevenknow.us_ec9d3dc6_20250119_140211.html ===

[[Segmentation Fault]](/ "[Segmentation Fault]")

1. 00.
2. 01.
3. 02.

I am a programming and reverse engineering enthusiast who probably keeps going farther than they should.
[Archive](/archive)
[Random](/random)

![Profile Photo](https://64.media.tumblr.com/avatar_19c67fce6734_128.pnj)
Feel free to check out my other work or follow me on social media in the links below.

1. [Questions? Comments? Criticism? All is welcome.](/ask "Ask a question")
2. [RSS Feed](https://douevenknow.us/rss "RSS Feed")
3. [Mobile](/mobile "View mobile version")

[![GitHub](https://static.tumblr.com/ubkenek/Qv0luyv55/github-icon.png)](https://github.com/shinyquagsire23 "GitHub")
[![GooglePlus Icon](https://static.tumblr.com/ubkenek/G6uluz2hj/googleplus-icon.png)](https://plus.google.com/u/1/100105085728881429255 "Google Plus")
[![Twitter Icon](https://static.tumblr.com/ubkenek/wialuyvfa/twitter-icon.png)](http://twitter.com/ShinyQuagsire "Twitter")

[üîã
üì±‚ùÑÔ∏èü•æüîì, an EL1/EL3 coldboot vulnerability affecting 7 years of LG Android devices](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability)

I should probably preface all of this by saying that I‚Äôm not really a security professional in the sense that I don‚Äôt actually do security stuff for a living; I reported this vulnerability in March and gave a 90 day delay on releasing specific details mostly just because that‚Äôs A Thing That Security Researchers Do. Also the vulnerability doesn‚Äôt require user interaction from coldboot so it‚Äôs a bit nasty in that regard. But also this vulnerability sat around for 7 years so it could be argued that, if anything, 90 days is too long.

Anyhow jumping into things, this is a writeup documenting¬†[CVE-2020-12753](https://nvd.nist.gov/vuln/detail/CVE-2020-12753), a bootloader vulnerability affecting most Qualcomm-based LG phones since the Nexus 5, all the way up to the my test device, the LG Stylo 4 Q710 (and 5 Q720), and probably others. While working on the implementation of this vulnerability I thought it was odd how few bootloader vulnerabilities for Android actually get properly documented, and given the sheer spread of affected devices of this particular vuln I thought it‚Äôd be interesting to document it in detail.

**A Quick Primer on the (Qualcomm) Android Boot Process**

The device I‚Äôm working with, the Stylo 4, operates on 2013-2016 variant of Qualcomm‚Äôs boot sequence described at <https://lineageos.org/engineering/Qualcomm-Firmware/>:

![image](https://64.media.tumblr.com/71ccac3e1f7f43ca8f6e546ad38f332c/f8833c921da777cc-3e/s500x750/29fda1846ecf50e3f1ab119058e612ef39c6b0a6.png)

- On power-on, the Primary Bootloader (PBL) initializes DRAM, eMMC, etc and then loads and verifies SBL1 (Secondary Bootloader 1) from eMMC.
- SBL1 then loads and verifies the Trusted Execution Environment (TEE), aboot, and a few other bits and pieces and then jumps to the TEE, in this case Qualcomm‚Äôs Secure Execution Environment (QSEE)
- QSEE sets up secure EL3/EL1 (TrustZone) and jumps down to aboot (non-secure EL1)
- aboot loads and verifies the Linux kernel and jumps to it

Some Android devices allow ‚Äúbootloader unlocking‚Äù, which allows unsigned kernels to be loaded and run. Generally this unlocking occurs via aboot, and the implementation varies from vendor to vendor, however in most cases what happens is that a fastboot command gets sent to the phone to unlock/lock the phone, and as part of [Android‚Äôs Verified Boot](https://source.android.com/security/verifiedboot/boot-flow), the phone‚Äôs storage is wiped on this transition. There‚Äôs also some requirements on user verification so that, in theory, this unlock cannot occur without user interaction.

Additionally, with verified boot enabled, Android will use [dm-verity](https://source.android.com/security/verifiedboot/dm-verity) to verify all files on the root/system partition, and SELinux is run as Enforcing.

**Variants on the Boot Process, added by LG**

In practice, the boot process isn‚Äôt quite so simple: Vendors are able to add modifications to the boot process as they see fit. In LG‚Äôs case, these differences can be summarized as follows:
- Hardware bringup in SBL for charging PMICs, LEDs, and other misc hardware
- Misc logging/debugging modifications
- Additional TEE processes for SIM unlocking, backed by RPMB
- In aboot, vendor-specific fastboot commands (or no fastboot at all in the case of my device), restrictions on unlocking via certificates, verification modifications, additional boot args for Linux, etc
- Vendor-specific recoveries/flashers, LAF in the case of LG

While I initially started in a privesc from within Linux (and got ~close to getting kernel execution), Google has done a lot of work to ensure that vendors can‚Äôt mess up Android security. However, bootloaders have a lot less oversight, so going after these vendor-specific bits of hardware bringup seemed extremely opportune for errors.

**Introducing: raw\_resources**

At an undetermined point in time (likely prior to the Nexus 5 releasing), LG added an ‚Äúimgdata‚Äù partition on eMMC to store boot graphics for Download Mode, fastboot graphics, charging graphics, the unlock graphic and so on. Image data is stored RLE compressed and for each image, metadata for the image width, height, x and y position are specified. The Nexus 5‚Äôs final bootloader image, as far as I can tell, only accesses this partition from aboot; SBL1 is not affected on this device. For the curious, I have a Python3 script which can extract these images at <https://gist.github.com/shinyquagsire23/ba0f6209592d50fb8e4166620228aaa5>.

![image](https://64.media.tumblr.com/7e8708ee47b63eb7270716d2a9175602/f8833c921da777cc-ac/s250x400/37620545d50e53188b44578e25af6f361f71178c.png)![image](https://64.media.tumblr.com/cb2dd3865b7ae70ba4af2950a34fb1fb/f8833c921da777cc-8e/s250x400/f953b7153f1a1631f1b9ff5bc4e59cd61d7a56c9.png)

*A few examples of Nexus 5 imgdata resources*

imgdata later became raw\_resources, and at an undetermined point, the same RLE decompression and metadata interpreting was copied into SBL1 for use in boot paths where the battery has discharged significantly. If the battery is discharged too far, SBL1‚Äôs pm\_sbl\_chg\_check\_weak\_battery\_status will display LGE\_PM\_NO\_CHARGER for boot attempts made without a charger connected, LGE\_PM\_WEAK\_CHARGING\_ON for boot attempts with a charger connected, and LGE\_PM\_NO\_BATERY\_ANI\_\* for boot attempts made without a battery. A script for extracting raw\_resources can be found at <https://gist.github.com/shinyquagsire23/b69ca343fd2f246aee882ecb5af702bd>.

![image](https://64.media.tumblr.com/d120ad227397e72155075166f13e31e2/f8833c921da777cc-98/s250x400/28249d57f2b65fcdeac385b8667652c64dbaa94a.png)![image](https://64.media.tumblr.com/a51b53313f61f721a702f3ec2eebd61e/f8833c921da777cc-7f/s250x400/2d2585b6e25abd115d815376a501a0330d7da695.png)

*A few examples of Q710 resources*

On normal boot paths, aboot reads raw\_resources to display the boot logo, download mode graphic, and verified boot statuses for devices which allow unlocking. In my case, the Q710/Q720 does not allow for unlocking, so this boot path is never reached on these devices. However, the graphics still exist I guess on the off chance that they allowed it to happen.

For the C inclined, the format of raw\_resources can be summarized in these structs:
typedef struct boot\_img\_header
{
 ¬† ¬†char magic[0x10];
 ¬† ¬†uint32\_t num\_imgs;
 ¬† ¬†uint32\_t version;
 ¬† ¬†char device[0x10];
 ¬† ¬†uint32\_t signature\_offs;
} boot\_img\_header;

typedef struct img\_info
{
 ¬† ¬†char name[0x28];
 ¬† ¬†uint32\_t data\_offset;
 ¬† ¬†uint32\_t data\_size;
 ¬† ¬†uint32\_t width;
 ¬† ¬†uint32\_t height;
 ¬† ¬†uint32\_t offs\_x;
 ¬† ¬†uint32\_t offs\_y;
} img\_info;

The following calculation is performed in order to determine the output pointer to be used during decompression:
bpp = 24
screen\_stride = fbinfo->screen\_width;
fbuf\_offset = offs\_x + (screen\_stride \* offs\_y);
fbuf\_out = (fbuf\_offset \* (bpp / 8)) + fbinfo->buffer;

offs\_x and offs\_y are not bounds checked, and fbinfo->buffer is known in SBL1 and aboot, allowing for a controlled arbitrary write in both environments.

**SBL1 load\_res\_888rle\_image Arbitrary Write**

This boot path requires discharging the battery to below 0%. While this is less feasible for any practical usage, performing the arbitrary write at this point allows patching SBL1 to disable signature verification before TEE and aboot are loaded. Any of the LGE\_PM\_\* images can be hijacked selectively for arbitrary code execution, though for my PoC I used LGE\_PM\_NO\_CHARGER specifically because I didn‚Äôt want to accidentally brick myself (or well, I didn‚Äôt want to have to beep out eMMC wires on the board to unbrick).

A 32-bit x offset can be calculated for any given address divisible by 3 using the following calculation:
offset\_x = (((0x100000000 + target\_addr) - 0x90000000) / 3) & 0xFFFFFFFF

Data written to this arbitrary address can be kept contiguous by specifying the image width to be the same as the screen width. The height should then be rounded up from the payload size to ensure all data is written properly. So really by the end, this isn‚Äôt an arbitrary write so much as it is an arbitrary memcpy at Secure EL3.

**aboot Arbitrary Write**

The aboot arbitrary write functions identically to SBL1: Any image can be selected to perform the arbitrary write. Most notably, this includes any lglogo\_image\_\* graphic, which is displayed by default on every boot. The framebuffer is generally fixed to address 0x90001000, which means that by using the arbitrary write to gain code execution, the original graphic which was used to obtain the arbitrary write can be written to the screen following hijacking to, in effect, make it appear as if boot flow has not been modified at all, for better or for worse.

A good question that might be raised after looking briefly at the structs earlier would be, ‚Äúwait, there‚Äôs a signature offset, why does any of this work if raw\_resources contains a signature?‚Äù And yes, raw\_resources contains a signature! But it‚Äôs a useless signature because this signature is only checked in aboot while displaying verifiedboot\_\* images. At some point, XDA users found out that you could swap the LG boot logos over the verifiedboot\_\* images so that when they unlocked their devices they wouldn‚Äôt have to see the AVB boot nag messages. Naturally, this defeats the point of Google‚Äôs Verified Boot spec since it would potentially allow a bootloader be unlocked without the user knowing, so LG added a signature. But it‚Äôs only checked for the verified boot images.

As a minor note, unlike SBL1, aboot will also select between raw\_resources\_a and raw\_resources\_b depending on the A/B boot slot.

**Practical Exploitation**

I started by exploiting SBL1, partially because Secure EL3 is just cooler than nonsecure EL1, but also because the framebuffer address was more obviously seen than in aboot (though I later found the aboot framebuffer address anyhow). At this point in execution all of the hardware is initialized and no other bootloaders have been loaded, so we‚Äôre basically free to patch sigchecks and control the entire phone!

As it turns out though, SBL1 takes a bit more work to actually exploit, because unlike aboot, its segments aren‚Äôt set RWX. I‚Äôm not really sure why aboot has all of its segments RWX, like at that point it‚Äôs more of a ‚Äòboot‚Äô than a 'secure boot‚Äô if they can‚Äôt even bother to use the easiest security option available.

In any case, ROP is required briefly to bypass the MMU‚Äôs NX bit. This isn‚Äôt too terrible, since SBL1 actually has a routine we can jump to to disable the MMU, though it requires a bit of finnagling to get correct.

So in summary, the exploitation process goes as follows:
 - Flash raw\_resources\_a.img to eMMC (ie via kernel execution, LG LAF, soldered wires and a hardware flasher, etc).
 - For SBL1 hax, drain the battery to below 0%. For my Q710, I drained most of the battery by leaving the screen at max brightness with sleep disabled until the phone powered off on its own after several hours. To drain the remaining battery, I charged enough to enter LAF download mode and left it to drain with the screen on for 2-3 hours.
 - Hold Power and Volume Down until the phone restarts. If the phone discharged enough, the phone should restart into the payload.
 - The phone can be plugged in to boot into aboot and Android normally, but the payload will now execute every time the payload-injected graphic is displayed.

To exploit SBL1:
 - raw\_resources\_a is modified such that the x offset is set to 0x2801CF5C, the width to 1080, and the height to 5. This will decompress LGE\_PM\_NO\_CHARGER (now containing the contents of payload.bin) to 0x08056E14, slightly higher than the stack pointer during decompression.
 - The image is decompressed and load\_res\_888rle\_image exits. The previous LR has now been overwritten by a pointer to a Thumb-mode pop {pc} ROP slide, to account for possible offsetting error.
 - At the end of the ROP slide, the following ROP instruction sequence is executed:

pop {r4-r12, pc} ¬† ¬†; r8 is now set to SBL1\_ARM\_MMU\_DISABLE, and r12 is now set to SBL1\_THUMB\_BX\_R8

pop {r4-r6, lr} ¬† ¬† ; LR is set to the payload pointer
orr r12, r12, #0x1
bx r12 ; jump to SBL1\_THUMB\_BX\_R8

bx r8 ; jump to SBL1\_ARM\_MMU\_DISABLE with lr now set to our payload

**Proof-of-Concept, and Future Plans**

For those interested in experimenting, a PoC can be found [here](https://github.com/shinyquagsire23/CVE-2020-12753-PoC). Note that this is specifically for the LG Q710, and contains offset specific to the AMZ LG Stylo 4 (Q710ULM, 20c\_00\_AMZ\_US\_OP\_1121). I‚Äôm planning on polishing things up further, however my current boot takeover involves two other vulnerabilities that I‚Äôd like to give a bit more time to make sure they‚Äôre actually fixed/close to being fixed before releasing.

In the meantime I‚Äôd be interested in seeing if anyone else is interested in porting this to other LG devices, since I only own a Nexus 5, a Q710 and a Q720. As it is, these vulns will allow bootloader unlocking at a *minimum* on most older Qualcomm LG devices, and secure EL3 on newer ones, which should be *very*¬†interesting for anyone interested in finding vulnerabilities in QSEE/similar on LG devices.

1. [![Date Posted Icon](https://static.tumblr.com/ubkenek/W8Rlmyhj3/datepostedicon.png)
   1st June 2020](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability "Date Posted")
3. [![Notes Icon](https://static.tumblr.com/ubkenek/Qnilmyiga/notesicon.png)
   Notes: 9](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability "Notes")

![Tags Icon](https://static.tumblr.com/ubkenek/CVXlmyivc/tagsicon.png)
[#CVE-2020-12753](https://douevenknow.us/tagged/CVE-2020-12753)[#exploitation](https://douevenknow.us/tagged/exploitation)[#bootloader](https://douevenknow.us/tagged/bootloader)[#Android](https://douevenknow.us/tagged/Android)[#Android ROMs](https://douevenknow.us/tagged/Android%20ROMs)

Page 1 of 1

This blog is powered by [Tumblr](http://tumblr.com "Tumblr") and designed by [CoSnap](http://cosnap.co.uk "The CoSnap website").

![](https://px.srvcs.tumblr.com/impixu?T=1737295331&J=eyJ0eXBlIjoidXJsIiwidXJsIjoiaHR0cDovL2RvdWV2ZW5rbm93LnVzL3RhZ2dlZC9leHBsb2l0YXRpb24iLCJyZXF0eXBlIjowLCJyb3V0ZSI6Ii90YWdnZWQvOnRhZyIsIm5vc2NyaXB0IjoxfQ==&U=MMGIFLIBHB&K=3cc62359e70bdd28a5065c74a0b0d483deb521735f8a936d548e6a5fcbb903c6&R=)![](https://px.srvcs.tumblr.com/impixu?T=1737295331&J=eyJ0eXBlIjoicG9zdCIsInVybCI6Imh0dHA6Ly9kb3VldmVua25vdy51cy90YWdnZWQvZXhwbG9pdGF0aW9uIiwicmVxdHlwZSI6MCwicm91dGUiOiIvdGFnZ2VkLzp0YWciLCJwb3N0cyI6W3sicG9zdGlkIjoiNjE5NzYzMDc0ODIyNTIwODMyIiwiYmxvZ2lkIjoxNTA0MTMxODIsInNvdXJjZSI6MzN9XSwibm9zY3JpcHQiOjF9&U=AFKBPALOGO&K=e13d852cab4c34c2c132cce944280143c829ed512ea4bd15a49ee19426945688&R=)

=== Content from douevenknow.us_2e37517a_20250119_140212.html ===

[[Segmentation Fault]](/ "[Segmentation Fault]")

1. 00.
2. 01.
3. 02.

I am a programming and reverse engineering enthusiast who probably keeps going farther than they should.
[Archive](/archive)
[Random](/random)

![Profile Photo](https://64.media.tumblr.com/avatar_19c67fce6734_128.pnj)
Feel free to check out my other work or follow me on social media in the links below.

1. [Questions? Comments? Criticism? All is welcome.](/ask "Ask a question")
2. [RSS Feed](https://douevenknow.us/rss "RSS Feed")
3. [Mobile](/mobile "View mobile version")

[![GitHub](https://static.tumblr.com/ubkenek/Qv0luyv55/github-icon.png)](https://github.com/shinyquagsire23 "GitHub")
[![GooglePlus Icon](https://static.tumblr.com/ubkenek/G6uluz2hj/googleplus-icon.png)](https://plus.google.com/u/1/100105085728881429255 "Google Plus")
[![Twitter Icon](https://static.tumblr.com/ubkenek/wialuyvfa/twitter-icon.png)](http://twitter.com/ShinyQuagsire "Twitter")

[üîã
üì±‚ùÑÔ∏èü•æüîì, an EL1/EL3 coldboot vulnerability affecting 7 years of LG Android devices](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability)

I should probably preface all of this by saying that I‚Äôm not really a security professional in the sense that I don‚Äôt actually do security stuff for a living; I reported this vulnerability in March and gave a 90 day delay on releasing specific details mostly just because that‚Äôs A Thing That Security Researchers Do. Also the vulnerability doesn‚Äôt require user interaction from coldboot so it‚Äôs a bit nasty in that regard. But also this vulnerability sat around for 7 years so it could be argued that, if anything, 90 days is too long.

Anyhow jumping into things, this is a writeup documenting¬†[CVE-2020-12753](https://nvd.nist.gov/vuln/detail/CVE-2020-12753), a bootloader vulnerability affecting most Qualcomm-based LG phones since the Nexus 5, all the way up to the my test device, the LG Stylo 4 Q710 (and 5 Q720), and probably others. While working on the implementation of this vulnerability I thought it was odd how few bootloader vulnerabilities for Android actually get properly documented, and given the sheer spread of affected devices of this particular vuln I thought it‚Äôd be interesting to document it in detail.

**A Quick Primer on the (Qualcomm) Android Boot Process**

The device I‚Äôm working with, the Stylo 4, operates on 2013-2016 variant of Qualcomm‚Äôs boot sequence described at <https://lineageos.org/engineering/Qualcomm-Firmware/>:

![image](https://64.media.tumblr.com/71ccac3e1f7f43ca8f6e546ad38f332c/f8833c921da777cc-3e/s500x750/29fda1846ecf50e3f1ab119058e612ef39c6b0a6.png)

- On power-on, the Primary Bootloader (PBL) initializes DRAM, eMMC, etc and then loads and verifies SBL1 (Secondary Bootloader 1) from eMMC.
- SBL1 then loads and verifies the Trusted Execution Environment (TEE), aboot, and a few other bits and pieces and then jumps to the TEE, in this case Qualcomm‚Äôs Secure Execution Environment (QSEE)
- QSEE sets up secure EL3/EL1 (TrustZone) and jumps down to aboot (non-secure EL1)
- aboot loads and verifies the Linux kernel and jumps to it

Some Android devices allow ‚Äúbootloader unlocking‚Äù, which allows unsigned kernels to be loaded and run. Generally this unlocking occurs via aboot, and the implementation varies from vendor to vendor, however in most cases what happens is that a fastboot command gets sent to the phone to unlock/lock the phone, and as part of [Android‚Äôs Verified Boot](https://source.android.com/security/verifiedboot/boot-flow), the phone‚Äôs storage is wiped on this transition. There‚Äôs also some requirements on user verification so that, in theory, this unlock cannot occur without user interaction.

Additionally, with verified boot enabled, Android will use [dm-verity](https://source.android.com/security/verifiedboot/dm-verity) to verify all files on the root/system partition, and SELinux is run as Enforcing.

**Variants on the Boot Process, added by LG**

In practice, the boot process isn‚Äôt quite so simple: Vendors are able to add modifications to the boot process as they see fit. In LG‚Äôs case, these differences can be summarized as follows:
- Hardware bringup in SBL for charging PMICs, LEDs, and other misc hardware
- Misc logging/debugging modifications
- Additional TEE processes for SIM unlocking, backed by RPMB
- In aboot, vendor-specific fastboot commands (or no fastboot at all in the case of my device), restrictions on unlocking via certificates, verification modifications, additional boot args for Linux, etc
- Vendor-specific recoveries/flashers, LAF in the case of LG

While I initially started in a privesc from within Linux (and got ~close to getting kernel execution), Google has done a lot of work to ensure that vendors can‚Äôt mess up Android security. However, bootloaders have a lot less oversight, so going after these vendor-specific bits of hardware bringup seemed extremely opportune for errors.

**Introducing: raw\_resources**

At an undetermined point in time (likely prior to the Nexus 5 releasing), LG added an ‚Äúimgdata‚Äù partition on eMMC to store boot graphics for Download Mode, fastboot graphics, charging graphics, the unlock graphic and so on. Image data is stored RLE compressed and for each image, metadata for the image width, height, x and y position are specified. The Nexus 5‚Äôs final bootloader image, as far as I can tell, only accesses this partition from aboot; SBL1 is not affected on this device. For the curious, I have a Python3 script which can extract these images at <https://gist.github.com/shinyquagsire23/ba0f6209592d50fb8e4166620228aaa5>.

![image](https://64.media.tumblr.com/7e8708ee47b63eb7270716d2a9175602/f8833c921da777cc-ac/s250x400/37620545d50e53188b44578e25af6f361f71178c.png)![image](https://64.media.tumblr.com/cb2dd3865b7ae70ba4af2950a34fb1fb/f8833c921da777cc-8e/s250x400/f953b7153f1a1631f1b9ff5bc4e59cd61d7a56c9.png)

*A few examples of Nexus 5 imgdata resources*

imgdata later became raw\_resources, and at an undetermined point, the same RLE decompression and metadata interpreting was copied into SBL1 for use in boot paths where the battery has discharged significantly. If the battery is discharged too far, SBL1‚Äôs pm\_sbl\_chg\_check\_weak\_battery\_status will display LGE\_PM\_NO\_CHARGER for boot attempts made without a charger connected, LGE\_PM\_WEAK\_CHARGING\_ON for boot attempts with a charger connected, and LGE\_PM\_NO\_BATERY\_ANI\_\* for boot attempts made without a battery. A script for extracting raw\_resources can be found at <https://gist.github.com/shinyquagsire23/b69ca343fd2f246aee882ecb5af702bd>.

![image](https://64.media.tumblr.com/d120ad227397e72155075166f13e31e2/f8833c921da777cc-98/s250x400/28249d57f2b65fcdeac385b8667652c64dbaa94a.png)![image](https://64.media.tumblr.com/a51b53313f61f721a702f3ec2eebd61e/f8833c921da777cc-7f/s250x400/2d2585b6e25abd115d815376a501a0330d7da695.png)

*A few examples of Q710 resources*

On normal boot paths, aboot reads raw\_resources to display the boot logo, download mode graphic, and verified boot statuses for devices which allow unlocking. In my case, the Q710/Q720 does not allow for unlocking, so this boot path is never reached on these devices. However, the graphics still exist I guess on the off chance that they allowed it to happen.

For the C inclined, the format of raw\_resources can be summarized in these structs:
typedef struct boot\_img\_header
{
 ¬† ¬†char magic[0x10];
 ¬† ¬†uint32\_t num\_imgs;
 ¬† ¬†uint32\_t version;
 ¬† ¬†char device[0x10];
 ¬† ¬†uint32\_t signature\_offs;
} boot\_img\_header;

typedef struct img\_info
{
 ¬† ¬†char name[0x28];
 ¬† ¬†uint32\_t data\_offset;
 ¬† ¬†uint32\_t data\_size;
 ¬† ¬†uint32\_t width;
 ¬† ¬†uint32\_t height;
 ¬† ¬†uint32\_t offs\_x;
 ¬† ¬†uint32\_t offs\_y;
} img\_info;

The following calculation is performed in order to determine the output pointer to be used during decompression:
bpp = 24
screen\_stride = fbinfo->screen\_width;
fbuf\_offset = offs\_x + (screen\_stride \* offs\_y);
fbuf\_out = (fbuf\_offset \* (bpp / 8)) + fbinfo->buffer;

offs\_x and offs\_y are not bounds checked, and fbinfo->buffer is known in SBL1 and aboot, allowing for a controlled arbitrary write in both environments.

**SBL1 load\_res\_888rle\_image Arbitrary Write**

This boot path requires discharging the battery to below 0%. While this is less feasible for any practical usage, performing the arbitrary write at this point allows patching SBL1 to disable signature verification before TEE and aboot are loaded. Any of the LGE\_PM\_\* images can be hijacked selectively for arbitrary code execution, though for my PoC I used LGE\_PM\_NO\_CHARGER specifically because I didn‚Äôt want to accidentally brick myself (or well, I didn‚Äôt want to have to beep out eMMC wires on the board to unbrick).

A 32-bit x offset can be calculated for any given address divisible by 3 using the following calculation:
offset\_x = (((0x100000000 + target\_addr) - 0x90000000) / 3) & 0xFFFFFFFF

Data written to this arbitrary address can be kept contiguous by specifying the image width to be the same as the screen width. The height should then be rounded up from the payload size to ensure all data is written properly. So really by the end, this isn‚Äôt an arbitrary write so much as it is an arbitrary memcpy at Secure EL3.

**aboot Arbitrary Write**

The aboot arbitrary write functions identically to SBL1: Any image can be selected to perform the arbitrary write. Most notably, this includes any lglogo\_image\_\* graphic, which is displayed by default on every boot. The framebuffer is generally fixed to address 0x90001000, which means that by using the arbitrary write to gain code execution, the original graphic which was used to obtain the arbitrary write can be written to the screen following hijacking to, in effect, make it appear as if boot flow has not been modified at all, for better or for worse.

A good question that might be raised after looking briefly at the structs earlier would be, ‚Äúwait, there‚Äôs a signature offset, why does any of this work if raw\_resources contains a signature?‚Äù And yes, raw\_resources contains a signature! But it‚Äôs a useless signature because this signature is only checked in aboot while displaying verifiedboot\_\* images. At some point, XDA users found out that you could swap the LG boot logos over the verifiedboot\_\* images so that when they unlocked their devices they wouldn‚Äôt have to see the AVB boot nag messages. Naturally, this defeats the point of Google‚Äôs Verified Boot spec since it would potentially allow a bootloader be unlocked without the user knowing, so LG added a signature. But it‚Äôs only checked for the verified boot images.

As a minor note, unlike SBL1, aboot will also select between raw\_resources\_a and raw\_resources\_b depending on the A/B boot slot.

**Practical Exploitation**

I started by exploiting SBL1, partially because Secure EL3 is just cooler than nonsecure EL1, but also because the framebuffer address was more obviously seen than in aboot (though I later found the aboot framebuffer address anyhow). At this point in execution all of the hardware is initialized and no other bootloaders have been loaded, so we‚Äôre basically free to patch sigchecks and control the entire phone!

As it turns out though, SBL1 takes a bit more work to actually exploit, because unlike aboot, its segments aren‚Äôt set RWX. I‚Äôm not really sure why aboot has all of its segments RWX, like at that point it‚Äôs more of a ‚Äòboot‚Äô than a 'secure boot‚Äô if they can‚Äôt even bother to use the easiest security option available.

In any case, ROP is required briefly to bypass the MMU‚Äôs NX bit. This isn‚Äôt too terrible, since SBL1 actually has a routine we can jump to to disable the MMU, though it requires a bit of finnagling to get correct.

So in summary, the exploitation process goes as follows:
 - Flash raw\_resources\_a.img to eMMC (ie via kernel execution, LG LAF, soldered wires and a hardware flasher, etc).
 - For SBL1 hax, drain the battery to below 0%. For my Q710, I drained most of the battery by leaving the screen at max brightness with sleep disabled until the phone powered off on its own after several hours. To drain the remaining battery, I charged enough to enter LAF download mode and left it to drain with the screen on for 2-3 hours.
 - Hold Power and Volume Down until the phone restarts. If the phone discharged enough, the phone should restart into the payload.
 - The phone can be plugged in to boot into aboot and Android normally, but the payload will now execute every time the payload-injected graphic is displayed.

To exploit SBL1:
 - raw\_resources\_a is modified such that the x offset is set to 0x2801CF5C, the width to 1080, and the height to 5. This will decompress LGE\_PM\_NO\_CHARGER (now containing the contents of payload.bin) to 0x08056E14, slightly higher than the stack pointer during decompression.
 - The image is decompressed and load\_res\_888rle\_image exits. The previous LR has now been overwritten by a pointer to a Thumb-mode pop {pc} ROP slide, to account for possible offsetting error.
 - At the end of the ROP slide, the following ROP instruction sequence is executed:

pop {r4-r12, pc} ¬† ¬†; r8 is now set to SBL1\_ARM\_MMU\_DISABLE, and r12 is now set to SBL1\_THUMB\_BX\_R8

pop {r4-r6, lr} ¬† ¬† ; LR is set to the payload pointer
orr r12, r12, #0x1
bx r12 ; jump to SBL1\_THUMB\_BX\_R8

bx r8 ; jump to SBL1\_ARM\_MMU\_DISABLE with lr now set to our payload

**Proof-of-Concept, and Future Plans**

For those interested in experimenting, a PoC can be found [here](https://github.com/shinyquagsire23/CVE-2020-12753-PoC). Note that this is specifically for the LG Q710, and contains offset specific to the AMZ LG Stylo 4 (Q710ULM, 20c\_00\_AMZ\_US\_OP\_1121). I‚Äôm planning on polishing things up further, however my current boot takeover involves two other vulnerabilities that I‚Äôd like to give a bit more time to make sure they‚Äôre actually fixed/close to being fixed before releasing.

In the meantime I‚Äôd be interested in seeing if anyone else is interested in porting this to other LG devices, since I only own a Nexus 5, a Q710 and a Q720. As it is, these vulns will allow bootloader unlocking at a *minimum* on most older Qualcomm LG devices, and secure EL3 on newer ones, which should be *very*¬†interesting for anyone interested in finding vulnerabilities in QSEE/similar on LG devices.

1. [![Date Posted Icon](https://static.tumblr.com/ubkenek/W8Rlmyhj3/datepostedicon.png)
   1st June 2020](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability "Date Posted")
3. [![Notes Icon](https://static.tumblr.com/ubkenek/Qnilmyiga/notesicon.png)
   Notes: 9](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability "Notes")

![Tags Icon](https://static.tumblr.com/ubkenek/CVXlmyivc/tagsicon.png)
[#CVE-2020-12753](https://douevenknow.us/tagged/CVE-2020-12753)[#exploitation](https://douevenknow.us/tagged/exploitation)[#bootloader](https://douevenknow.us/tagged/bootloader)[#Android](https://douevenknow.us/tagged/Android)[#Android ROMs](https://douevenknow.us/tagged/Android%20ROMs)

Page 1 of 1

This blog is powered by [Tumblr](http://tumblr.com "Tumblr") and designed by [CoSnap](http://cosnap.co.uk "The CoSnap website").

![](https://px.srvcs.tumblr.com/impixu?T=1737295332&J=eyJ0eXBlIjoidXJsIiwidXJsIjoiaHR0cDovL2RvdWV2ZW5rbm93LnVzL3RhZ2dlZC9ib290bG9hZGVyIiwicmVxdHlwZSI6MCwicm91dGUiOiIvdGFnZ2VkLzp0YWciLCJub3NjcmlwdCI6MX0=&U=LAIMMKGJHN&K=08f2f98ef5a8c5fcbd2e1a4830cdcc8808941765cfb8fd02625d684817d31dea&R=)![](https://px.srvcs.tumblr.com/impixu?T=1737295332&J=eyJ0eXBlIjoicG9zdCIsInVybCI6Imh0dHA6Ly9kb3VldmVua25vdy51cy90YWdnZWQvYm9vdGxvYWRlciIsInJlcXR5cGUiOjAsInJvdXRlIjoiL3RhZ2dlZC86dGFnIiwicG9zdHMiOlt7InBvc3RpZCI6IjYxOTc2MzA3NDgyMjUyMDgzMiIsImJsb2dpZCI6MTUwNDEzMTgyLCJzb3VyY2UiOjMzfV0sIm5vc2NyaXB0IjoxfQ==&U=LAKBGKPICA&K=498fab80647411ed5aa3d631fe7608b74b737ac57722a013f7e3bea70aa2073f&R=)

=== Content from static.tumblr.com_67d61092_20250119_140208.html ===
ÔøΩPNG

   
IHDR      
  ÔøΩ.ÔøΩÔøΩ   tEXtSoftware Adobe ImageReadyqÔøΩe<  diTXtXML:com.adobe.xmp     xpacket begin="Ôªø" id="W5M0MpCehiHzreSzNTczkc9d"?        xpacket end="r"?ÔøΩ9  -IDATxÔøΩbÔøΩÔøΩÔøΩ?0m⁄∂ÔøΩÔøΩ  ÔøΩÔøΩ[w\*0ÔøΩÔøΩÔøΩÔøΩ1ÔøΩ0 ÔøΩ ÔøΩ8ÔøΩhÔøΩ4a2@V@ÔøΩ ÔøΩdÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩ~ÔøΩTÔøΩÔøΩ8ÔøΩÔøΩHÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩ@ÔøΩÔøΩ ÔøΩÔøΩ(ÔøΩÔøΩ07ÔøΩ\ÔøΩ ÔøΩ
PI ÔøΩÔøΩÔøΩÔøΩsÔøΩÔøΩÔøΩÔøΩÔøΩx$ÔøΩAvÔøΩ<ÔøΩÔøΩÔøΩlÔøΩsÔøΩÔøΩ5ÔøΩ=(ÔøΩ`A8ÔøΩ ÔøΩdÔøΩ ÔøΩÔøΩÔøΩ z>j4ÔøΩ0ÔøΩ!jÔøΩ (^ÔøΩqÔøΩPÔøΩhX:"{ÔøΩÔøΩÔøΩ0ÔøΩ:ÔøΩ
 ÔøΩ~Œ≥ÔøΩ     IENDÔøΩB`ÔøΩ

=== Content from github.com_002c0942_20250119_140212.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshinyquagsire23%2FCVE-2020-12753-PoC)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshinyquagsire23%2FCVE-2020-12753-PoC)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=shinyquagsire23%2FCVE-2020-12753-PoC)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[shinyquagsire23](/shinyquagsire23)
/
**[CVE-2020-12753-PoC](/shinyquagsire23/CVE-2020-12753-PoC)**
Public

* [Notifications](/login?return_to=%2Fshinyquagsire23%2FCVE-2020-12753-PoC) You must be signed in to change notification settings
* [Fork
  7](/login?return_to=%2Fshinyquagsire23%2FCVE-2020-12753-PoC)
* [Star
   40](/login?return_to=%2Fshinyquagsire23%2FCVE-2020-12753-PoC)

A proof-of-concept for CVE-2020-12753

[40
stars](/shinyquagsire23/CVE-2020-12753-PoC/stargazers) [7
forks](/shinyquagsire23/CVE-2020-12753-PoC/forks) [Branches](/shinyquagsire23/CVE-2020-12753-PoC/branches) [Tags](/shinyquagsire23/CVE-2020-12753-PoC/tags) [Activity](/shinyquagsire23/CVE-2020-12753-PoC/activity)
 [Star](/login?return_to=%2Fshinyquagsire23%2FCVE-2020-12753-PoC)

 [Notifications](/login?return_to=%2Fshinyquagsire23%2FCVE-2020-12753-PoC) You must be signed in to change notification settings

* [Code](/shinyquagsire23/CVE-2020-12753-PoC)
* [Issues
  1](/shinyquagsire23/CVE-2020-12753-PoC/issues)
* [Pull requests
  0](/shinyquagsire23/CVE-2020-12753-PoC/pulls)
* [Actions](/shinyquagsire23/CVE-2020-12753-PoC/actions)
* [Projects
  0](/shinyquagsire23/CVE-2020-12753-PoC/projects)
* [Security](/shinyquagsire23/CVE-2020-12753-PoC/security)
* [Insights](/shinyquagsire23/CVE-2020-12753-PoC/pulse)

Additional navigation options

* [Code](/shinyquagsire23/CVE-2020-12753-PoC)
* [Issues](/shinyquagsire23/CVE-2020-12753-PoC/issues)
* [Pull requests](/shinyquagsire23/CVE-2020-12753-PoC/pulls)
* [Actions](/shinyquagsire23/CVE-2020-12753-PoC/actions)
* [Projects](/shinyquagsire23/CVE-2020-12753-PoC/projects)
* [Security](/shinyquagsire23/CVE-2020-12753-PoC/security)
* [Insights](/shinyquagsire23/CVE-2020-12753-PoC/pulse)

# shinyquagsire23/CVE-2020-12753-PoC

   ¬†master[Branches](/shinyquagsire23/CVE-2020-12753-PoC/branches)[Tags](/shinyquagsire23/CVE-2020-12753-PoC/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit¬†History[2 Commits](/shinyquagsire23/CVE-2020-12753-PoC/commits/master/) | | |
| [README.md](/shinyquagsire23/CVE-2020-12753-PoC/blob/master/README.md "README.md") | | [README.md](/shinyquagsire23/CVE-2020-12753-PoC/blob/master/README.md "README.md") |  |  |
| [lg-craftres.py](/shinyquagsire23/CVE-2020-12753-PoC/blob/master/lg-craftres.py "lg-craftres.py") | | [lg-craftres.py](/shinyquagsire23/CVE-2020-12753-PoC/blob/master/lg-craftres.py "lg-craftres.py") |  |  |
| [payload.bin](/shinyquagsire23/CVE-2020-12753-PoC/blob/master/payload.bin "payload.bin") | | [payload.bin](/shinyquagsire23/CVE-2020-12753-PoC/blob/master/payload.bin "payload.bin") |  |  |
| [raw\_resources.img\_884736](/shinyquagsire23/CVE-2020-12753-PoC/blob/master/raw_resources.img_884736 "raw_resources.img_884736") | | [raw\_resources.img\_884736](/shinyquagsire23/CVE-2020-12753-PoC/blob/master/raw_resources.img_884736 "raw_resources.img_884736") |  |  |
| [raw\_resources\_a\_mod.img](/shinyquagsire23/CVE-2020-12753-PoC/blob/master/raw_resources_a_mod.img "raw_resources_a_mod.img") | | [raw\_resources\_a\_mod.img](/shinyquagsire23/CVE-2020-12753-PoC/blob/master/raw_resources_a_mod.img "raw_resources_a_mod.img") |  |  |
| [sbl\_gadgets.s](/shinyquagsire23/CVE-2020-12753-PoC/blob/master/sbl_gadgets.s "sbl_gadgets.s") | | [sbl\_gadgets.s](/shinyquagsire23/CVE-2020-12753-PoC/blob/master/sbl_gadgets.s "sbl_gadgets.s") |  |  |
| [sbl\_rop.s](/shinyquagsire23/CVE-2020-12753-PoC/blob/master/sbl_rop.s "sbl_rop.s") | | [sbl\_rop.s](/shinyquagsire23/CVE-2020-12753-PoC/blob/master/sbl_rop.s "sbl_rop.s") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2020-12753-PoC

This repo contains a proof-of-concept for üîãüì±‚ùÑÔ∏èü•æüîì, an SBL1/aboot vuln for Secure EL3 arbitrary code execution on the LG Stylo 4 (AMZ/Q710ULM). This is only tested on updates 20a and 20c and with the SBL1 variant of the vulnerability.

```
 - Makefile                 : Builds raw_resources_a_mod.img given sbl_rop.s and raw_resources.img_884736
 - raw_resources.img_884736 : Original raw_resources partition; sha256 510def86aa7608ac02f243d3c161bf973ac4add066be763c8abcb2fee90a454c
 - raw_resources_a_mod.img  : pre-compiled raw_resources partition to be flashed; sha256 26ee5f4589009bc20269bdb813a78d729b9daba44f7826560f6b7201f5396e73
 - payload.bin              : pre-compiled output of sbl_rop.s (no RLE compression)
 - lg-craftres.py           : Python3 script which takes in raw_resources.img_884736 and payload.bin and outputs raw_resources_a_mod.img
 - sbl_rop.s                : ROP payload to be written to the stack by load_res_888rle_image
 - sbl_gadgets.s            : ROP gadget defines for SBL1, included by sbl_rop.s

```

To build from source, armips (<https://github.com/Kingcom/armips>) and Python 3 are required.

## About

A proof-of-concept for CVE-2020-12753

### Resources

[Readme](#readme-ov-file)

[Activity](/shinyquagsire23/CVE-2020-12753-PoC/activity)
### Stars

[**40**
stars](/shinyquagsire23/CVE-2020-12753-PoC/stargazers)
### Watchers

[**6**
watching](/shinyquagsire23/CVE-2020-12753-PoC/watchers)
### Forks

[**7**
forks](/shinyquagsire23/CVE-2020-12753-PoC/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fshinyquagsire23%2FCVE-2020-12753-PoC&report=shinyquagsire23+%28user%29)

## [Releases](/shinyquagsire23/CVE-2020-12753-PoC/releases)

No releases published

## [Packages 0](/users/shinyquagsire23/packages?repo_name=CVE-2020-12753-PoC)

No packages published

## Languages

* [Python
  60.4%](/shinyquagsire23/CVE-2020-12753-PoC/search?l=python)
* [Assembly
  39.6%](/shinyquagsire23/CVE-2020-12753-PoC/search?l=assembly)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from lgsecurity.lge.com_45a3b8ed_20250119_122330.html ===
You need to enable JavaScript to run this app.

=== Content from douevenknow.us_3ede564e_20250119_140211.html ===

[[Segmentation Fault]](/ "[Segmentation Fault]")

1. 00.
2. 01.
3. 02.

I am a programming and reverse engineering enthusiast who probably keeps going farther than they should.
[Archive](/archive)
[Random](/random)

![Profile Photo](https://64.media.tumblr.com/avatar_19c67fce6734_128.pnj)
Feel free to check out my other work or follow me on social media in the links below.

1. [Questions? Comments? Criticism? All is welcome.](/ask "Ask a question")
2. [RSS Feed](https://douevenknow.us/rss "RSS Feed")
3. [Mobile](/mobile "View mobile version")

[![GitHub](https://static.tumblr.com/ubkenek/Qv0luyv55/github-icon.png)](https://github.com/shinyquagsire23 "GitHub")
[![GooglePlus Icon](https://static.tumblr.com/ubkenek/G6uluz2hj/googleplus-icon.png)](https://plus.google.com/u/1/100105085728881429255 "Google Plus")
[![Twitter Icon](https://static.tumblr.com/ubkenek/wialuyvfa/twitter-icon.png)](http://twitter.com/ShinyQuagsire "Twitter")

[üîã
üì±‚ùÑÔ∏èü•æüîì, an EL1/EL3 coldboot vulnerability affecting 7 years of LG Android devices](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability)

I should probably preface all of this by saying that I‚Äôm not really a security professional in the sense that I don‚Äôt actually do security stuff for a living; I reported this vulnerability in March and gave a 90 day delay on releasing specific details mostly just because that‚Äôs A Thing That Security Researchers Do. Also the vulnerability doesn‚Äôt require user interaction from coldboot so it‚Äôs a bit nasty in that regard. But also this vulnerability sat around for 7 years so it could be argued that, if anything, 90 days is too long.

Anyhow jumping into things, this is a writeup documenting¬†[CVE-2020-12753](https://nvd.nist.gov/vuln/detail/CVE-2020-12753), a bootloader vulnerability affecting most Qualcomm-based LG phones since the Nexus 5, all the way up to the my test device, the LG Stylo 4 Q710 (and 5 Q720), and probably others. While working on the implementation of this vulnerability I thought it was odd how few bootloader vulnerabilities for Android actually get properly documented, and given the sheer spread of affected devices of this particular vuln I thought it‚Äôd be interesting to document it in detail.

**A Quick Primer on the (Qualcomm) Android Boot Process**

The device I‚Äôm working with, the Stylo 4, operates on 2013-2016 variant of Qualcomm‚Äôs boot sequence described at <https://lineageos.org/engineering/Qualcomm-Firmware/>:

![image](https://64.media.tumblr.com/71ccac3e1f7f43ca8f6e546ad38f332c/f8833c921da777cc-3e/s500x750/29fda1846ecf50e3f1ab119058e612ef39c6b0a6.png)

- On power-on, the Primary Bootloader (PBL) initializes DRAM, eMMC, etc and then loads and verifies SBL1 (Secondary Bootloader 1) from eMMC.
- SBL1 then loads and verifies the Trusted Execution Environment (TEE), aboot, and a few other bits and pieces and then jumps to the TEE, in this case Qualcomm‚Äôs Secure Execution Environment (QSEE)
- QSEE sets up secure EL3/EL1 (TrustZone) and jumps down to aboot (non-secure EL1)
- aboot loads and verifies the Linux kernel and jumps to it

Some Android devices allow ‚Äúbootloader unlocking‚Äù, which allows unsigned kernels to be loaded and run. Generally this unlocking occurs via aboot, and the implementation varies from vendor to vendor, however in most cases what happens is that a fastboot command gets sent to the phone to unlock/lock the phone, and as part of [Android‚Äôs Verified Boot](https://source.android.com/security/verifiedboot/boot-flow), the phone‚Äôs storage is wiped on this transition. There‚Äôs also some requirements on user verification so that, in theory, this unlock cannot occur without user interaction.

Additionally, with verified boot enabled, Android will use [dm-verity](https://source.android.com/security/verifiedboot/dm-verity) to verify all files on the root/system partition, and SELinux is run as Enforcing.

**Variants on the Boot Process, added by LG**

In practice, the boot process isn‚Äôt quite so simple: Vendors are able to add modifications to the boot process as they see fit. In LG‚Äôs case, these differences can be summarized as follows:
- Hardware bringup in SBL for charging PMICs, LEDs, and other misc hardware
- Misc logging/debugging modifications
- Additional TEE processes for SIM unlocking, backed by RPMB
- In aboot, vendor-specific fastboot commands (or no fastboot at all in the case of my device), restrictions on unlocking via certificates, verification modifications, additional boot args for Linux, etc
- Vendor-specific recoveries/flashers, LAF in the case of LG

While I initially started in a privesc from within Linux (and got ~close to getting kernel execution), Google has done a lot of work to ensure that vendors can‚Äôt mess up Android security. However, bootloaders have a lot less oversight, so going after these vendor-specific bits of hardware bringup seemed extremely opportune for errors.

**Introducing: raw\_resources**

At an undetermined point in time (likely prior to the Nexus 5 releasing), LG added an ‚Äúimgdata‚Äù partition on eMMC to store boot graphics for Download Mode, fastboot graphics, charging graphics, the unlock graphic and so on. Image data is stored RLE compressed and for each image, metadata for the image width, height, x and y position are specified. The Nexus 5‚Äôs final bootloader image, as far as I can tell, only accesses this partition from aboot; SBL1 is not affected on this device. For the curious, I have a Python3 script which can extract these images at <https://gist.github.com/shinyquagsire23/ba0f6209592d50fb8e4166620228aaa5>.

![image](https://64.media.tumblr.com/7e8708ee47b63eb7270716d2a9175602/f8833c921da777cc-ac/s250x400/37620545d50e53188b44578e25af6f361f71178c.png)![image](https://64.media.tumblr.com/cb2dd3865b7ae70ba4af2950a34fb1fb/f8833c921da777cc-8e/s250x400/f953b7153f1a1631f1b9ff5bc4e59cd61d7a56c9.png)

*A few examples of Nexus 5 imgdata resources*

imgdata later became raw\_resources, and at an undetermined point, the same RLE decompression and metadata interpreting was copied into SBL1 for use in boot paths where the battery has discharged significantly. If the battery is discharged too far, SBL1‚Äôs pm\_sbl\_chg\_check\_weak\_battery\_status will display LGE\_PM\_NO\_CHARGER for boot attempts made without a charger connected, LGE\_PM\_WEAK\_CHARGING\_ON for boot attempts with a charger connected, and LGE\_PM\_NO\_BATERY\_ANI\_\* for boot attempts made without a battery. A script for extracting raw\_resources can be found at <https://gist.github.com/shinyquagsire23/b69ca343fd2f246aee882ecb5af702bd>.

![image](https://64.media.tumblr.com/d120ad227397e72155075166f13e31e2/f8833c921da777cc-98/s250x400/28249d57f2b65fcdeac385b8667652c64dbaa94a.png)![image](https://64.media.tumblr.com/a51b53313f61f721a702f3ec2eebd61e/f8833c921da777cc-7f/s250x400/2d2585b6e25abd115d815376a501a0330d7da695.png)

*A few examples of Q710 resources*

On normal boot paths, aboot reads raw\_resources to display the boot logo, download mode graphic, and verified boot statuses for devices which allow unlocking. In my case, the Q710/Q720 does not allow for unlocking, so this boot path is never reached on these devices. However, the graphics still exist I guess on the off chance that they allowed it to happen.

For the C inclined, the format of raw\_resources can be summarized in these structs:
typedef struct boot\_img\_header
{
 ¬† ¬†char magic[0x10];
 ¬† ¬†uint32\_t num\_imgs;
 ¬† ¬†uint32\_t version;
 ¬† ¬†char device[0x10];
 ¬† ¬†uint32\_t signature\_offs;
} boot\_img\_header;

typedef struct img\_info
{
 ¬† ¬†char name[0x28];
 ¬† ¬†uint32\_t data\_offset;
 ¬† ¬†uint32\_t data\_size;
 ¬† ¬†uint32\_t width;
 ¬† ¬†uint32\_t height;
 ¬† ¬†uint32\_t offs\_x;
 ¬† ¬†uint32\_t offs\_y;
} img\_info;

The following calculation is performed in order to determine the output pointer to be used during decompression:
bpp = 24
screen\_stride = fbinfo->screen\_width;
fbuf\_offset = offs\_x + (screen\_stride \* offs\_y);
fbuf\_out = (fbuf\_offset \* (bpp / 8)) + fbinfo->buffer;

offs\_x and offs\_y are not bounds checked, and fbinfo->buffer is known in SBL1 and aboot, allowing for a controlled arbitrary write in both environments.

**SBL1 load\_res\_888rle\_image Arbitrary Write**

This boot path requires discharging the battery to below 0%. While this is less feasible for any practical usage, performing the arbitrary write at this point allows patching SBL1 to disable signature verification before TEE and aboot are loaded. Any of the LGE\_PM\_\* images can be hijacked selectively for arbitrary code execution, though for my PoC I used LGE\_PM\_NO\_CHARGER specifically because I didn‚Äôt want to accidentally brick myself (or well, I didn‚Äôt want to have to beep out eMMC wires on the board to unbrick).

A 32-bit x offset can be calculated for any given address divisible by 3 using the following calculation:
offset\_x = (((0x100000000 + target\_addr) - 0x90000000) / 3) & 0xFFFFFFFF

Data written to this arbitrary address can be kept contiguous by specifying the image width to be the same as the screen width. The height should then be rounded up from the payload size to ensure all data is written properly. So really by the end, this isn‚Äôt an arbitrary write so much as it is an arbitrary memcpy at Secure EL3.

**aboot Arbitrary Write**

The aboot arbitrary write functions identically to SBL1: Any image can be selected to perform the arbitrary write. Most notably, this includes any lglogo\_image\_\* graphic, which is displayed by default on every boot. The framebuffer is generally fixed to address 0x90001000, which means that by using the arbitrary write to gain code execution, the original graphic which was used to obtain the arbitrary write can be written to the screen following hijacking to, in effect, make it appear as if boot flow has not been modified at all, for better or for worse.

A good question that might be raised after looking briefly at the structs earlier would be, ‚Äúwait, there‚Äôs a signature offset, why does any of this work if raw\_resources contains a signature?‚Äù And yes, raw\_resources contains a signature! But it‚Äôs a useless signature because this signature is only checked in aboot while displaying verifiedboot\_\* images. At some point, XDA users found out that you could swap the LG boot logos over the verifiedboot\_\* images so that when they unlocked their devices they wouldn‚Äôt have to see the AVB boot nag messages. Naturally, this defeats the point of Google‚Äôs Verified Boot spec since it would potentially allow a bootloader be unlocked without the user knowing, so LG added a signature. But it‚Äôs only checked for the verified boot images.

As a minor note, unlike SBL1, aboot will also select between raw\_resources\_a and raw\_resources\_b depending on the A/B boot slot.

**Practical Exploitation**

I started by exploiting SBL1, partially because Secure EL3 is just cooler than nonsecure EL1, but also because the framebuffer address was more obviously seen than in aboot (though I later found the aboot framebuffer address anyhow). At this point in execution all of the hardware is initialized and no other bootloaders have been loaded, so we‚Äôre basically free to patch sigchecks and control the entire phone!

As it turns out though, SBL1 takes a bit more work to actually exploit, because unlike aboot, its segments aren‚Äôt set RWX. I‚Äôm not really sure why aboot has all of its segments RWX, like at that point it‚Äôs more of a ‚Äòboot‚Äô than a 'secure boot‚Äô if they can‚Äôt even bother to use the easiest security option available.

In any case, ROP is required briefly to bypass the MMU‚Äôs NX bit. This isn‚Äôt too terrible, since SBL1 actually has a routine we can jump to to disable the MMU, though it requires a bit of finnagling to get correct.

So in summary, the exploitation process goes as follows:
 - Flash raw\_resources\_a.img to eMMC (ie via kernel execution, LG LAF, soldered wires and a hardware flasher, etc).
 - For SBL1 hax, drain the battery to below 0%. For my Q710, I drained most of the battery by leaving the screen at max brightness with sleep disabled until the phone powered off on its own after several hours. To drain the remaining battery, I charged enough to enter LAF download mode and left it to drain with the screen on for 2-3 hours.
 - Hold Power and Volume Down until the phone restarts. If the phone discharged enough, the phone should restart into the payload.
 - The phone can be plugged in to boot into aboot and Android normally, but the payload will now execute every time the payload-injected graphic is displayed.

To exploit SBL1:
 - raw\_resources\_a is modified such that the x offset is set to 0x2801CF5C, the width to 1080, and the height to 5. This will decompress LGE\_PM\_NO\_CHARGER (now containing the contents of payload.bin) to 0x08056E14, slightly higher than the stack pointer during decompression.
 - The image is decompressed and load\_res\_888rle\_image exits. The previous LR has now been overwritten by a pointer to a Thumb-mode pop {pc} ROP slide, to account for possible offsetting error.
 - At the end of the ROP slide, the following ROP instruction sequence is executed:

pop {r4-r12, pc} ¬† ¬†; r8 is now set to SBL1\_ARM\_MMU\_DISABLE, and r12 is now set to SBL1\_THUMB\_BX\_R8

pop {r4-r6, lr} ¬† ¬† ; LR is set to the payload pointer
orr r12, r12, #0x1
bx r12 ; jump to SBL1\_THUMB\_BX\_R8

bx r8 ; jump to SBL1\_ARM\_MMU\_DISABLE with lr now set to our payload

**Proof-of-Concept, and Future Plans**

For those interested in experimenting, a PoC can be found [here](https://github.com/shinyquagsire23/CVE-2020-12753-PoC). Note that this is specifically for the LG Q710, and contains offset specific to the AMZ LG Stylo 4 (Q710ULM, 20c\_00\_AMZ\_US\_OP\_1121). I‚Äôm planning on polishing things up further, however my current boot takeover involves two other vulnerabilities that I‚Äôd like to give a bit more time to make sure they‚Äôre actually fixed/close to being fixed before releasing.

In the meantime I‚Äôd be interested in seeing if anyone else is interested in porting this to other LG devices, since I only own a Nexus 5, a Q710 and a Q720. As it is, these vulns will allow bootloader unlocking at a *minimum* on most older Qualcomm LG devices, and secure EL3 on newer ones, which should be *very*¬†interesting for anyone interested in finding vulnerabilities in QSEE/similar on LG devices.

1. [![Date Posted Icon](https://static.tumblr.com/ubkenek/W8Rlmyhj3/datepostedicon.png)
   1st June 2020](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability "Date Posted")
3. [![Notes Icon](https://static.tumblr.com/ubkenek/Qnilmyiga/notesicon.png)
   Notes: 9](https://douevenknow.us/post/619763074822520832/an-el1el3-coldboot-vulnerability "Notes")

![Tags Icon](https://static.tumblr.com/ubkenek/CVXlmyivc/tagsicon.png)
[#CVE-2020-12753](https://douevenknow.us/tagged/CVE-2020-12753)[#exploitation](https://douevenknow.us/tagged/exploitation)[#bootloader](https://douevenknow.us/tagged/bootloader)[#Android](https://douevenknow.us/tagged/Android)[#Android ROMs](https://douevenknow.us/tagged/Android%20ROMs)

Page 1 of 1

This blog is powered by [Tumblr](http://tumblr.com "Tumblr") and designed by [CoSnap](http://cosnap.co.uk "The CoSnap website").

![](https://px.srvcs.tumblr.com/impixu?T=1737295331&J=eyJ0eXBlIjoidXJsIiwidXJsIjoiaHR0cDovL2RvdWV2ZW5rbm93LnVzL3RhZ2dlZC9BbmRyb2lkIiwicmVxdHlwZSI6MCwicm91dGUiOiIvdGFnZ2VkLzp0YWciLCJub3NjcmlwdCI6MX0=&U=FPICGHGOGH&K=7ad1c1647b304ffe18f837eaf802b844e3c1cd8d361c906625dc3b40ad2c622b&R=)![](https://px.srvcs.tumblr.com/impixu?T=1737295331&J=eyJ0eXBlIjoicG9zdCIsInVybCI6Imh0dHA6Ly9kb3VldmVua25vdy51cy90YWdnZWQvQW5kcm9pZCIsInJlcXR5cGUiOjAsInJvdXRlIjoiL3RhZ2dlZC86dGFnIiwicG9zdHMiOlt7InBvc3RpZCI6IjYxOTc2MzA3NDgyMjUyMDgzMiIsImJsb2dpZCI6MTUwNDEzMTgyLCJzb3VyY2UiOjMzfV0sIm5vc2NyaXB0IjoxfQ==&U=BCBKCFOIKH&K=790df885404b1609581c8ef687fd7056ff709f596f86d94d89e31e684c9c12e4&R=)
