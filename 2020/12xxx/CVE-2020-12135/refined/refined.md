```text
{
  "cveId": "CVE-2020-12135",
  "description": "bson before 0.8 incorrectly uses int for lengths and sizes of strings and buffers, leading to integer overflows and heap-based buffer overflows when parsing crafted BSON documents, resulting in a denial of service or possibly arbitrary code execution.",
  "vulnerabilityDetails": [
    {
      "source": "launchpad.net_c56b497c_20250119_134341.html",
      "detail": "UNRELATED"
    },
    {
      "source": "lists.ubuntu.com_be8ed54b_20250119_134344.html",
      "detail": "UNRELATED"
    },
    {
      "source": "launchpad.net_ff884fee_20250119_134344.html",
      "detail": "UNRELATED"
    },
    {
      "source": "github.com_624c2a7e_20250119_115845.html",
     "detail": "This commit fixes a vulnerability related to mixing int and size_t types in the mongo-c-driver-legacy's BSON library. The changes include:\n\n*   Modifying the type of variables and function parameters related to sizes and lengths from int to size_t. This change applies to functions like `bson_buffer_size`, `bson_iterator_next`, `bson_append`, `bson_ensure_space`, `bson_append_estart`, `bson_append_string_base`, `bson_append_code_w_scope_n`, `bson_append_binary`, `bson_append_regex`, `bson_append_element`, `bson_malloc`, `bson_realloc`, `bson_string_is_db_ref`, `bson_validate_string` , `bson_check_string`, and `bson_check_field_name`.\n*   The change also includes adjusting integer casts to `(int)` when passing `size_t` variables to functions that expect an `int`."
    },
    {
      "source": "launchpadlibrarian.net_4b7e98de_20250119_115846.html",
      "detail": "This patch addresses an integer overflow issue in the `bson_ensure_space` function in `bson.c` by changing the type of `bytesNeeded` parameter from `uint32_t` to `size_t` and casting 1 to `size_t` before adding it to other size parameters."
    },
    {
      "source": "bugs.launchpad.net_299e479c_20250119_115844.html",
      "detail": "The vulnerability is a heap-based buffer overflow in `whoopsie`'s BSON parsing logic, specifically within the `bson.c` file. The root cause is an integer overflow when calculating the size of the memory needed for a BSON key. The `strlen` of the key is added to 1 and stored into a `uint32_t` variable, 'len'. If the key is large enough the integer will overflow leading to a smaller than expected value. When the memory is allocated it uses the underflowed value. Subsequently the code copies the key into the under-allocated space resulting in a heap-based buffer overflow. The vulnerability can be triggered by providing a crafted .crash file with a large 'key' field, that when parsed by `whoopsie`, leads to memory corruption. The impact is a denial of service (application crash) and potentially arbitrary code execution. The attacker needs to create a malformed .crash file to trigger the overflow. The required attacker capabilities is the ability to write to `/var/crash`, typically done via a crashing application. Specifically the bug occurs in `bson_append` which calls `bson_ensure_space`, with the overflow occurring in `bson_ensure_space` at `bson.c:663` in whoopsie version 0.2.69."
    },
    {
      "source": "usn.ubuntu.com_e57b88ca_20250119_115846.html",
      "detail": "The vulnerability is caused by improper memory handling when parsing files, which can be triggered by a local attacker resulting in a denial of service or potentially arbitrary code execution. This is a heap-based buffer overflow vulnerability in `whoopsie`'s BSON parsing logic. This occurs when `whoopsie` attempts to bsonify a crafted crash file. The integer overflow occurs when calculating the size of a key, leading to memory corruption."
    }
  ]
}
```