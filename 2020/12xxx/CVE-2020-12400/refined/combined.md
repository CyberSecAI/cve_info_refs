=== Content from lists.debian.org_8891601a_20250119_115330.html ===


---

[[Date Prev](msg00020.html)][[Date Next](msg00022.html)]
[[Thread Prev](msg00020.html)][[Thread Next](msg00022.html)]
[[Date Index](maillist.html#00021)]
[[Thread Index](threads.html#00021)]

# [SECURITY] [DLA 3327-1] nss security update

---

* *To*: debian-lts-announce <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3327-1] nss security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Mon, 20 Feb 2023 16:16:03 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/95fb8713a1cc888ee821a1118d68f6ae8252e696.camel%40debian.org)Â [95fb8713a1cc888ee821a1118d68f6ae8252e696.camel@debian.org](msg00021.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3327-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Markus Koschany
February 20, 2023                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : nss
Version        : 2:3.42.1-1+deb10u6
CVE ID         : CVE-2020-6829 CVE-2020-12400 CVE-2020-12401 CVE-2020-12403
                 CVE-2023-0767

Multiple security vulnerabilities have been discovered in nss, the Network
Security Service libraries.

CVE-2020-6829

    When performing EC scalar point multiplication, the wNAF point
    multiplication algorithm was used; which leaked partial information about
    the nonce used during signature generation. Given an electro-magnetic trace
    of a few signature generations, the private key could have been computed.

CVE-2020-12400

    When converting coordinates from projective to affine, the modular
    inversion was not performed in constant time, resulting in a possible
    timing-based side channel attack.

CVE-2020-12401

    During ECDSA signature generation, padding applied in the nonce designed to
    ensure constant-time scalar multiplication was removed, resulting in
    variable-time execution dependent on secret data.

CVE-2020-12403

    A flaw was found in the way CHACHA20-POLY1305 was implemented in NSS.
    When using multi-part Chacha20, it could cause out-of-bounds reads.
    This issue was fixed by explicitly disabling multi-part ChaCha20
    (which was not functioning correctly) and strictly enforcing tag length.

CVE-2023-0767

    Christian Holler discovered that incorrect handling of PKCS 12 Safe Bag
    attributes may result in execution of arbitrary code if a specially crafted
    PKCS 12 certificate bundle is processed.

For Debian 10 buster, these problems have been fixed in version
2:3.42.1-1+deb10u6.

We recommend that you upgrade your nss packages.

For the detailed security status of nss please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/nss>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpgEGoDjAMoI.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from bugzilla.mozilla.org_9b103237_20250119_115330.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1623116)
* [XML](/show_bug.cgi?ctype=xml&id=1623116)

Closed
[Bug 1623116](/show_bug.cgi?id=1623116)
(CVE-2020-12400)

Opened 5 years ago
Closed 5 years ago

# P-384 and P-521 implementation uses a side-channel vulnerable modular inversion function

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

P-384 and P-521 implementation uses a side-channel vulnerable modular inversion function

## Categories

### (NSS :: Libraries, defect, P1)

[Product:](/describecomponents.cgi?product=NSS)

NSS
â–¾

NSS
Network Security Services - a cross-platform
security library ([more info](http://www.mozilla.org/projects/security/pki/nss/))
[See Open Bugs in This Product](/buglist.cgi?product=NSS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=NSS)
Watch This Product

[Component:](/describecomponents.cgi?product=NSS&component=Libraries#Libraries)

Libraries
â–¾

NSS :: Libraries
Libraries for client support of SSL v2 and v3, TLS, PKCS #5,
PKCS #7, PKCS #11, PKCS #12, S/MIME, X.509 v3 certificates,
and other security standards
[See Open Bugs in This Component](/buglist.cgi?product=NSS&component=Libraries&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=NSS&component=Libraries&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=NSS&component=Libraries)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

other

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

## Tracking

### (firefox-esr68- wontfix, firefox-esr78- wontfix, firefox76 wontfix, firefox77 wontfix, firefox78 wontfix, firefox79- wontfix, firefox80- fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

3.55

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix) |
| firefox-esr78 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix) |
| firefox76 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox76&o1=equals&v1=wontfix) |
| firefox77 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox77&o1=equals&v1=wontfix) |
| firefox78 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=wontfix) |
| firefox79 | [-](/buglist.cgi?f1=cf_tracking_firefox79&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix) |
| firefox80 | [-](/buglist.cgi?f1=cf_tracking_firefox80&o1=equals&v1=-) | [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr68 | - | wontfix |
| firefox-esr78 | - | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox76 |  | wontfix |
| firefox77 |  | wontfix |
| firefox78 |  | wontfix |
| firefox79 | - | wontfix |
| firefox80 | - | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: dveditz, Assigned: beurdouche)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=40)  [beurdouche](/user_profile?user_id=622637)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=40)  [jcj](/user_profile?user_id=520206)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=40)  [dveditz](/user_profile?user_id=1689)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=40)  [beurdouche](/user_profile?user_id=622637)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

### ( [URL](https://eprint.iacr.org/2020/432.pdf "https://eprint.iacr.org/2020/432.pdf") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[eprint.iacr.org/2020/432.pdf](https://eprint.iacr.org/2020/432.pdf "https://eprint.iacr.org/2020/432.pdf")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1387108](/show_bug.cgi?id=1387108 "RESOLVED FIXED - 8175110, CVE-2017-10118: Higher quality ECDSA operations"), [CVE-2020-6829](/show_bug.cgi?id=1631583 "RESOLVED FIXED - Side channel attack on ECDSA signature generation")

## Details

### (Keywords: csectype-disclosure, sec-moderate, Whiteboard: [disclosure date 2020-07-28][adv-main80+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-12400

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[disclosure date 2020-07-28][adv-main80+]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [mboldan](/user_profile?user_id=551058) | [qe-verify](#a11715223_551058 "4 years ago") | - |
| --- | --- | --- |
| [mboldan](/user_profile?user_id=551058) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [advisory.txt](/attachment.cgi?id=9170783)  [4 years ago](#c28)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   484 bytes, text/plain |  | [Details](/attachment.cgi?id=9170783&action=edit) |
| --- | --- | --- |

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1623116#c0)â€¢ 5 years ago |
|  | |

Mail to security@ from Alejandro Cabrera Aldaya:

---

We recently dig into how the EC projective coordinates attack proposed in [1] could affect NSS.

The attack in [1] aims at recover some bits of the scalar starting from the projective representation

of an scalar multiplication output point.

Schemes like ECDSA are very sensitive to scalar leaks, therefore the attack in [1] can thwarts the security of an implementation if the attacker knows the projective representation of the product kG in ECDSA.

The success rate of the attack proposed in [1] depends on several factors such as:

* Elliptic curve form (Weierstrass, Montogmery, etc.)
* The finite field over the curve is defined
* Projective coordinates (Jacobian, Mxy, etc.)
* Scalar multiplication algorithm

making a high-demand time-consuming task to assess the real threat of this attack on implementation.

During our analysis to several cryptographic libraries we focused on NIST curve P-256 code paths and have found that your library is potentially vulnerable because the projective to affine coordinates conversion uses a side-channel vulnerable modular inversion function.

Considering the number of freedom degrees and potential threats we recommend to use one of the following countermeasures to prevent an already existing vulnerability or a future introduced one if one of the listed factors changes.

Countermeasures:

* Coordinates randomization after scalar multiplication but just before coordinates conversion takes place.
* Using FLT to invert Z instead of binary GCD based algorithms during coordinates conversion.

[1] - Naccache et al. - "Projective coordinates leak" - <https://eprint.iacr.org/2003/191>

The results of our research is going to be published at CHES.

If you wan't to assign a CVE, please let us know to include it a reference in the paper.

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1623116#c1)â€¢ 5 years ago |
|  | |

Hmm; how quickly can we get the HACL\* p256 implementation, I wonder?

|  | [Alejandro Cabrera Aldaya](/user_profile?user_id=659120) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1623116#c2)â€¢ 5 years ago |
|  | |

I made a copy-and-paste error in the report. Sorry for the noise!

P-256 code path is secure against this attack in NSS.

It uses FLT to compute the modular inversion of Z during the projective to affine coordinates conversion.

The issues relies in P-384 and P-521.

Where a side-channel insecure modular inversion algorithm is used.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1623116#c3)â€¢ 5 years ago |
|  | |

JC: is this just a local side-channel, or something that could be detected over the internet somehow? Not sure how to rate the severity here.

Flags: needinfo?(jjones)Summary: P-256 implementation uses a side-channel vulnerable modular inversion function â†’ P-384 and P-521 implementation uses a side-channel vulnerable modular inversion function

|  | [Alejandro Cabrera Aldaya](/user_profile?user_id=659120) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1623116#c4)â€¢ 5 years ago |
|  | |

it is a local side-channel

|  | [Robert Relyea](/user_profile?user_id=11099) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1623116#c5)â€¢ 5 years ago |
|  | |

I think the 256 bit curve on 64 bit is vulnerable as well. Only the 32 bit platforms have a special implementation. The quick and fix for this is to change ec\_GFp\_div() to use Fermat's Little Therom rather than or GCD invert function. The former is significantly slower (you calculate 1/x mod p = x^(p-1) mod p. Blinding is probably the better way to go. That would happend in jac code.

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1623116#c6)â€¢ 5 years ago |
|  | |

This is a duplicate of [Bug 1568061](/show_bug.cgi?id=1568061 "RESOLVED FIXED - side-channel leakage in ECDSA signature generation") and also related to [Bug 1387108](/show_bug.cgi?id=1387108 "RESOLVED FIXED - 8175110, CVE-2017-10118: Higher quality ECDSA operations") ([CVE-2017-10118](https://www.cve.org/CVERecord?id=CVE-2017-10118)).

The short of it is this is mostly a vulnerability for the server-side, and for an uncommon configuration (<1% of Firefox handshakes).

I'm resolving this as a duplicate, and we can continue the server-side discussions in the other two bugs.

Status: NEW â†’ RESOLVEDClosed: 5 years agoFlags: needinfo?(jjones)Resolution: --- â†’ FIXEDSee Also: â†’ [1387108](/show_bug.cgi?id=1387108 "RESOLVED FIXED - 8175110, CVE-2017-10118: Higher quality ECDSA operations")

|  | [Alejandro Cabrera Aldaya](/user_profile?user_id=659120) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1623116#c7)â€¢ 5 years ago |
|  | |

Sorry, could you check the CVE? [CVE-2017-10118](https://www.cve.org/CVERecord?id=CVE-2017-10118) is related to Java SE.

I don't have access to the mentioned bug tracks, may I get access to them?

It would be nice for our research to know about previous works on this, thanks!

Regarding mostly server-side, take into account NSS is used by other projects as crypto backend (eg. libreswan VPN), where client auth are in place.

|  | [Alicja Kario](/user_profile?user_id=487652) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1623116#c8)â€¢ 5 years ago |
|  | |

jcj: The Resolution doesn't match what you said...

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1623116#c9)â€¢ 5 years ago |
|  | |

Ugh, sorry about that Hubert. Fixed.

Alejandro - interesting, perhaps they redefined the CVE. It was never ours to begin with, but reported against Java and we got the notice that NSS had the same vulnerability. I'll add you to the other bugs in a moment.

Resolution: FIXED â†’ DUPLICATE

|  | [Alejandro Cabrera Aldaya](/user_profile?user_id=659120) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1623116#c10)â€¢ 5 years ago |
|  | |

jcj: thanks!

I read the descriptions and they are not the same.

We didn't exploit the non-constant time nature of wNAF nor Weierstrass incomplete formulae.

The potential threat resides in the coordinates conversion from projective to affine, that involves a side-channel insecure modular inversion function.

P-384 and P-521 code paths use a modular inversion algorithm based on the binary GCD algorithm.

while P-256 code path use an exponentiation with a non secret exponent (FLT) to compute the inverse.

This code path difference is what makes the P-384 and P-521 potentially exploitable while P-256 doesn't.

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1623116#c11)â€¢ 5 years ago |
|  | |

Thank you for the clarification - I'm reopening this one.

Status: RESOLVED â†’ REOPENEDResolution: DUPLICATE â†’ ---

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1623116#a779281_1689)â€¢ 5 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1623116#c12)â€¢ 5 years ago |
|  | |

Leaving untriaged for next week's triage

Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1623116#c13)â€¢ 5 years ago |
|  | |

The priority flag is not set for this bug.

:jcj, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_priority.py).

Flags: needinfo?(jjones)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1623116#c14)â€¢ 5 years ago |
|  | |

Replacement of the P384/P521 implementations in [Bug 1631583](/show_bug.cgi?id=1631583 "RESOLVED FIXED - Side channel attack on ECDSA signature generation") is going to be the best resolution for this bug, too.

URL: <https://eprint.iacr.org/2020/432.pdf>See Also: â†’ [CVE-2020-6829](/show_bug.cgi?id=1631583 "RESOLVED FIXED - Side channel attack on ECDSA signature generation")

|  | [Alejandro Cabrera Aldaya](/user_profile?user_id=659120) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1623116#c15)â€¢ 5 years ago |
|  | |

Only if you replace the insecure modular inversion function used to convert from projective coordinates.

Changing the scalar mult to a constant-time variant doesn't help.

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1623116#c16)â€¢ 5 years ago |
|  | |

(In reply to Alejandro Cabrera Aldaya from [comment #15](/show_bug.cgi?id=1623116#c15 "RESOLVED FIXED - P-384 and P-521 implementation uses a side-channel vulnerable modular inversion function"))

> Only if you replace the insecure modular inversion function used to convert from projective coordinates.

Indeed.

Ben is currently keeping track of the EC replacements. Assigning to him for tracking.

Assignee: nobody â†’ bbeurdoucheStatus: REOPENED â†’ ASSIGNEDFlags: needinfo?(jjones)Priority: -- â†’ P1

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1623116#c17)â€¢ 5 years ago |
|  | |

Requesting CVE assignment.

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1623116#c18)â€¢ 5 years ago |
|  | |

Assigned [CVE-2020-12400](https://www.cve.org/CVERecord?id=CVE-2020-12400)

Alias: CVE-2020-12400Flags: needinfo?(dveditz)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1623116#c19)â€¢ 5 years ago |
|  | |

Alejandro and team,

After some more digging here, I'd like to revise my earlier comments and request whether your team would be able to help us rewrite this modular inversion function. I had mistakenly believed that there was one constructed already by the HACL\* project, but there is not. As with the other patches, we are happy to and standing by to assist in review and test.

Thank you!

Flags: needinfo?(aldaya)

|  | [Alejandro Cabrera Aldaya](/user_profile?user_id=659120) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1623116#c20)â€¢ 5 years ago |
|  | |

Hi JC, could you add bbrumley@gmail.com to this thread?

thanks!

Flags: needinfo?(aldaya)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1623116#c21)â€¢ 5 years ago |
|  | |

cc:ed

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1623116#c22)â€¢ 5 years ago |
|  | |

> After some more digging here, I'd like to revise my earlier comments and request whether your team would be able to help us rewrite this modular inversion function

Absolutely. When we have the fix for [Bug 1631583](/show_bug.cgi?id=1631583 "RESOLVED FIXED - Side channel attack on ECDSA signature generation") (finally) ready, it will remove `mp_invmod` from this call stack anyway. But the [Bug 1631597](/show_bug.cgi?id=1631597 "RESOLVED FIXED - side channel vulnerabilities during RSA key generation") fix should make `mp_invmod` CT so everybody wins :)

Stay tuned and yea we'll appreciate the testing help when my team gets there.

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1623116#c23)â€¢ 5 years ago |
|  | |

Thank you very much, bbrumley!

Whiteboard: [disclosure date 2020-06-30]

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1623116#a4930305_520206)â€¢ 5 years ago |

[status-firefox76](/buglist.cgi?f1=cf_status_firefox76&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox76&o1=equals&v1=wontfix)
[status-firefox77](/buglist.cgi?f1=cf_status_firefox77&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox77&o1=equals&v1=wontfix)
[status-firefox78](/buglist.cgi?f1=cf_status_firefox78&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=affected)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1623116#a4930419_520206)â€¢ 5 years ago |

Severity: normal â†’ S3

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1623116#c24)â€¢ 5 years ago |
|  | |

Re-targetting to 2020-07-28 (Firefox 79) per <https://bugzilla.mozilla.org/show_bug.cgi?id=1631583#c30>

Whiteboard: [disclosure date 2020-06-30] â†’ [disclosure date 2020-07-28]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1623116#a8747950_1689)â€¢ 5 years ago |

[status-firefox79](/buglist.cgi?f1=cf_status_firefox79&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1623116#a8748000_1689)â€¢ 5 years ago |

[tracking-firefox79](/buglist.cgi?f1=cf_tracking_firefox79&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox79&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- â†’ [79+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=79%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- â†’ [79+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=79%2B)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1623116#a8973728_580382)â€¢ 5 years ago |

[status-firefox78](/buglist.cgi?f1=cf_status_firefox78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=wontfix)

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1623116#c25)â€¢ 5 years ago |
|  | |

Our tooling [ECCKiila](https://gitlab.com/nisec/ecckiila) is now public.

We stripped out the NSS rigging and instructions for now, to respect the embargo. (It's questionable if that was necessary, but I acted conservatively.)

The code you are seeing in these revisions is exactly the output from that tooling, just post-processed with `unifdef` like the instructions say. I used this oneliner

```
export CURVES="secp256r1 secp384r1 secp521r1"
for c in $CURVES; do unifdef ecp/$c/ecp_$c.c -URIG_GOST -DRIG_NSS -UOPENSSL_BUILDING_OPENSSL -ULIB_TEST > /path/to/libnss/nss/lib/freebl/ecl/ecp_$c.c; done

```

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1623116#c26)â€¢ 5 years ago |
|  | |

Per JC, we're going to let these fixes ride the regular NSS trains without uplifting since the severity to Firefox is significantly lower.

[status-firefox79](/buglist.cgi?f1=cf_status_firefox79&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix)
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix)
[tracking-firefox79](/buglist.cgi?f1=cf_tracking_firefox79&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox79&o1=equals&v1=%2B) â†’ [-](/buglist.cgi?f1=cf_tracking_firefox79&o1=equals&v1=-)
[tracking-firefox80](/buglist.cgi?f1=cf_tracking_firefox80&o1=isnotempty):
--- â†’ [-](/buglist.cgi?f1=cf_tracking_firefox80&o1=equals&v1=-)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[79+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=79%2B) â†’ [-](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=-)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
[79+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=79%2B) â†’ [-](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=-)

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1623116#c27)â€¢ 5 years ago |
|  | |

As stated in [comment 22](/show_bug.cgi?id=1623116#c22 "RESOLVED FIXED - P-384 and P-521 implementation uses a side-channel vulnerable modular inversion function"), this issue has been remedied in the related and mentioned bugs. Closing.

Status: ASSIGNED â†’ RESOLVEDClosed: 5 years ago â†’ 5 years agoResolution: --- â†’ FIXEDTarget Milestone: --- â†’ 3.55

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1623116#a10969400_75935)â€¢ 4 years ago |

[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1623116#a11512580_1689)â€¢ 4 years ago |

Group: crypto-core-security â†’ core-security-release

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1623116#a11715223_551058)â€¢ 4 years ago |

Flags: qe-verify-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1623116#a13315028_578488)â€¢ 4 years ago |

Whiteboard: [disclosure date 2020-07-28] â†’ [disclosure date 2020-07-28][adv-main80+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1623116#c28)â€¢ 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9170783)
â€” [Details](attachment.cgi?id=9170783&action=edit)

It's not clear to me from this bug what type of side channel this was - I'm guessing timing? If it's a power analysis attack or something, or you think the advisory can be improved or the credit is incorrect please let me know.

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1623116#c29)â€¢ 4 years ago |
|  | |

Hey Tom,

A few suggestions below, if it's not too late. It was a page fault attack (although def power analysis would've been an option for us), but without getting too technical for a high level advisory, maybe stressing it's a local attack vector like below is sufficient.

BBB

### Byline

Alejandro Cabrera Aldaya, Cesar Pereida GarcÃ­a, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland

### Channel

When converting coordinates from projective to affine, the modular inversion was not performed in constant time, resulting in a possible local microarchitecture attack.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1623116#a53188651_1689)â€¢ 3 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1623116&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [Tom Ritter [:tjr]](/user_profile?user_id=578488)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_73f8d6fa_20250119_133915.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")â€Ž | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from wiki.mozilla.org_2210cd17_20250119_133916.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")â€Ž | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.mozilla.org_19945826_20250119_115331.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-36

## Security Vulnerabilities fixed in Firefox 80

Announced
August 25, 2020
Impact
high
Products
Firefox
Fixed in

* Firefox 80

#### [#CVE-2020-15663: Downgrade attack on the Mozilla Maintenance Service could have resulted in escalation of privilege](#CVE-2020-15663)

Reporter
Xiaoyin Liu
Impact
high
##### Description

If Firefox is installed to a user-writable directory, the Mozilla Maintenance Service would execute updater.exe from the install location with administrative privileges. Although the Mozilla Maintenance Service does ensure that updater.exe is signed by Mozilla, the version could have been rolled back to a previous version which would have allowed exploitation of an older bug and arbitrary code execution with system privileges.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1643199](https://bugzilla.mozilla.org/show_bug.cgi?id=1643199)

#### [#CVE-2020-15664: Attacker-induced prompt for extension installation](#CVE-2020-15664)

Reporter
Kaizer Soze
Impact
high
##### Description

By holding a reference to the `eval()` function from an about:blank window, a malicious webpage could have gained access to the InstallTrigger object which would allow them to prompt the user to install an extension. Combined with user confusion, this could result in an unintended or malicious extension being installed.

##### References

* [Bug 1658214](https://bugzilla.mozilla.org/show_bug.cgi?id=1658214)

#### [#CVE-2020-12401: Timing-attack on ECDSA signature generation](#CVE-2020-12401)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida GarcÃ­a, JesÃºs-Javier Chi-DomÃ­nguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

During ECDSA signature generation, padding applied in the nonce designed to ensure constant-time scalar multiplication was removed, resulting in variable-time execution dependent on secret data.

##### References

* [Bug 1631573](https://bugzilla.mozilla.org/show_bug.cgi?id=1631573)

#### [#CVE-2020-6829: P-384 and P-521 vulnerable to an electro-magnetic side channel attack on signature generation](#CVE-2020-6829)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida GarcÃ­a, JesÃºs-Javier Chi-DomÃ­nguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

When performing EC scalar point multiplication, the wNAF point multiplication algorithm was used; which leaked partial information about the nonce used during signature generation. Given an electro-magnetic trace of a few signature generations, the private key could have been computed.

##### References

* [Bug 1631583](https://bugzilla.mozilla.org/show_bug.cgi?id=1631583)

#### [#CVE-2020-12400: P-384 and P-521 vulnerable to a side channel attack on modular inversion](#CVE-2020-12400)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida GarcÃ­a, JesÃºs-Javier Chi-DomÃ­nguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

When converting coordinates from projective to affine, the modular inversion was not performed in constant time, resulting in a possible timing-based side channel attack.

##### References

* [Bug 1623116](https://bugzilla.mozilla.org/show_bug.cgi?id=1623116)

#### [#CVE-2020-15665: Address bar not reset when choosing to stay on a page after the beforeunload dialog is shown](#CVE-2020-15665)

Reporter
Luan Herrera
Impact
moderate
##### Description

Firefox did not reset the address bar after the beforeunload dialog was shown if the user chose to remain on the page. This could have resulted in an incorrect URL being shown when used in conjunction with other unexpected browser behaviors.

##### References

* [Bug 1651636](https://bugzilla.mozilla.org/show_bug.cgi?id=1651636)

#### [#CVE-2020-15666: MediaError message property leaks cross-origin response status](#CVE-2020-15666)

Reporter
Gunes Acar
Impact
low
##### Description

When trying to load a non-video in an audio/video context the exact status code (200, 302, 404, 500, 412, 403, etc.) was disclosed via the MediaError Message. This level of information leakage is inconsistent with the standardized onerror/onsuccess disclosure and can lead to inferring login status to services or device discovery on a local network among other attacks.

##### References

* [Bug 1450853](https://bugzilla.mozilla.org/show_bug.cgi?id=1450853)

#### [#CVE-2020-15667: Heap overflow when processing an update file](#CVE-2020-15667)

Reporter
crixer
Impact
low
##### Description

When processing a MAR update file, after the signature has been validated, an invalid name length could result in a heap overflow, leading to memory corruption and potentially arbitrary code execution. Within Firefox as released by Mozilla, this issue is only exploitable with the Mozilla-controlled signing key.

##### References

* [Bug 1653371](https://bugzilla.mozilla.org/show_bug.cgi?id=1653371)

#### [#CVE-2020-15668: Data Race when reading certificate information](#CVE-2020-15668)

Reporter
Tyson Smith
Impact
low
##### Description

A lock was missing when accessing a data structure and importing certificate information into the trust database.

##### References

* [Bug 1651520](https://bugzilla.mozilla.org/show_bug.cgi?id=1651520)

#### [#CVE-2020-15670: Memory safety bugs fixed in Firefox 80 and Firefox ESR 78.2](#CVE-2020-15670)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Jason Kratzer, Christian Holler, and Byron Campen reported memory safety bugs present in Firefox 79 and Firefox ESR 78.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 80 and Firefox ESR 78.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1651001%2C1653626%2C1656957)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_a2a6133f_20250119_115332.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-39

## Security Vulnerabilities fixed in Firefox for Android 80

Announced
September 2, 2020
Impact
high
Products
Firefox for Android
Fixed in

* Firefox for Android 80

#### [#CVE-2020-15664: Attacker-induced prompt for extension installation](#CVE-2020-15664)

Reporter
Kaizer Soze
Impact
high
##### Description

By holding a reference to the `eval()` function from an about:blank window, a malicious webpage could have gained access to the InstallTrigger object which would allow them to prompt the user to install an extension. Combined with user confusion, this could result in an unintended or malicious extension being installed.

##### References

* [Bug 1658214](https://bugzilla.mozilla.org/show_bug.cgi?id=1658214)

#### [#CVE-2020-12401: Timing-attack on ECDSA signature generation](#CVE-2020-12401)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida GarcÃ­a, JesÃºs-Javier Chi-DomÃ­nguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

During ECDSA signature generation, padding applied in the nonce designed to ensure constant-time scalar multiplication was removed, resulting in variable-time execution dependent on secret data.

##### References

* [Bug 1631573](https://bugzilla.mozilla.org/show_bug.cgi?id=1631573)

#### [#CVE-2020-6829: P-384 and P-521 vulnerable to an electro-magnetic side channel attack on signature generation](#CVE-2020-6829)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida GarcÃ­a, JesÃºs-Javier Chi-DomÃ­nguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

When performing EC scalar point multiplication, the wNAF point multiplication algorithm was used; which leaked partial information about the nonce used during signature generation. Given an electro-magnetic trace of a few signature generations, the private key could have been computed.

##### References

* [Bug 1631583](https://bugzilla.mozilla.org/show_bug.cgi?id=1631583)

#### [#CVE-2020-12400: P-384 and P-521 vulnerable to a side channel attack on modular inversion](#CVE-2020-12400)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida GarcÃ­a, JesÃºs-Javier Chi-DomÃ­nguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

When converting coordinates from projective to affine, the modular inversion was not performed in constant time, resulting in a possible timing-based side channel attack.

##### References

* [Bug 1623116](https://bugzilla.mozilla.org/show_bug.cgi?id=1623116)

#### [#CVE-2020-15666: MediaError message property leaks cross-origin response status](#CVE-2020-15666)

Reporter
Gunes Acar
Impact
low
##### Description

When trying to load a non-video in an audio/video context the exact status code (200, 302, 404, 500, 412, 403, etc.) was disclosed via the MediaError Message. This level of information leakage is inconsistent with the standardized onerror/onsuccess disclosure and can lead to inferring login status to services or device discovery on a local network among other attacks.

##### References

* [Bug 1450853](https://bugzilla.mozilla.org/show_bug.cgi?id=1450853)

#### [#CVE-2020-15668: Data Race when reading certificate information](#CVE-2020-15668)

Reporter
Tyson Smith
Impact
low
##### Description

A lock was missing when accessing a data structure and importing certificate information into the trust database.

##### References

* [Bug 1651520](https://bugzilla.mozilla.org/show_bug.cgi?id=1651520)

#### [#CVE-2020-15671: Passwords could be saved to phone keyboard dictionary](#CVE-2020-15671)

Reporter
Karol Frejlich
Impact
low
##### Description

When typing in a password under certain conditions, a race may have occured where the InputContext was not being correctly set for the input field, resulting in the typed passwod being saved to the keyboard dictionary.

##### References

* [Bug 1653862](https://bugzilla.mozilla.org/show_bug.cgi?id=1653862)

#### [#CVE-2020-15670: Memory safety bugs fixed in Firefox for Android 80](#CVE-2020-15670)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Jason Kratzer, Christian Holler, and Byron Campen reported memory safety bugs present in Firefox for Android 79. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox for Android 80](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1651001%2C1653626%2C1656957)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_b4fa9e39_20250119_133920.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1631583)
* [XML](/show_bug.cgi?ctype=xml&id=1631583)

Closed
[Bug 1631583](/show_bug.cgi?id=1631583)
(CVE-2020-6829)

Opened 5 years ago
Closed 5 years ago

# Side channel attack on ECDSA signature generation

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Side channel attack on ECDSA signature generation

## Categories

### (NSS :: Libraries, defect, P1)

[Product:](/describecomponents.cgi?product=NSS)

NSS
â–¾

NSS
Network Security Services - a cross-platform
security library ([more info](http://www.mozilla.org/projects/security/pki/nss/))
[See Open Bugs in This Product](/buglist.cgi?product=NSS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=NSS)
Watch This Product

[Component:](/describecomponents.cgi?product=NSS&component=Libraries#Libraries)

Libraries
â–¾

NSS :: Libraries
Libraries for client support of SSL v2 and v3, TLS, PKCS #5,
PKCS #7, PKCS #11, PKCS #12, S/MIME, X.509 v3 certificates,
and other security standards
[See Open Bugs in This Component](/buglist.cgi?product=NSS&component=Libraries&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=NSS&component=Libraries&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=NSS&component=Libraries)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

## Tracking

### (Root Cause:Coding: Other, firefox-esr68- wontfix, firefox-esr78- wontfix, firefox76 wontfix, firefox77 wontfix, firefox78 wontfix, firefox79- wontfix, firefox80- fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

3.55

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Root Cause | [Coding: Other](/buglist.cgi?f1=cf_root_cause&o1=equals&v1=Coding%3A%20Other) |
| --- | --- |

| Accessibility Severity | --- |
| --- | --- |
| Root Cause | Coding: Other |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix) |
| firefox-esr78 | [-](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix) |
| firefox76 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox76&o1=equals&v1=wontfix) |
| firefox77 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox77&o1=equals&v1=wontfix) |
| firefox78 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=wontfix) |
| firefox79 | [-](/buglist.cgi?f1=cf_tracking_firefox79&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix) |
| firefox80 | [-](/buglist.cgi?f1=cf_tracking_firefox80&o1=equals&v1=-) | [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr68 | - | wontfix |
| firefox-esr78 | - | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox76 |  | wontfix |
| firefox77 |  | wontfix |
| firefox78 |  | wontfix |
| firefox79 | - | wontfix |
| firefox80 | - | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: dveditz, Assigned: kjacobs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/37ada3382011f10c6afb586fe07b6215?d=mm&size=40)  [kjacobs](/user_profile?user_id=636914)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=40)  [jcj](/user_profile?user_id=520206)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/da6b54ad3fdb36ba7656df9adfe65d12?d=mm&size=40)  [dveditz](/user_profile?user_id=1689)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=40)  [beurdouche](/user_profile?user_id=622637)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

19 people

## References

### ( [URL](https://eprint.iacr.org/2020/432.pdf "https://eprint.iacr.org/2020/432.pdf") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2020-12401](/show_bug.cgi?id=1631573 "RESOLVED FIXED - ECDSA Timing Countermeasure Bypass")

Dependency [tree](/showdependencytree.cgi?id=1631583&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1631583)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1287216](/show_bug.cgi?id=1287216 "RESOLVED DUPLICATE - Constant-time 32 bit implementation of P521")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[eprint.iacr.org/2020/432.pdf](https://eprint.iacr.org/2020/432.pdf "https://eprint.iacr.org/2020/432.pdf")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2020-12400](/show_bug.cgi?id=1623116 "RESOLVED FIXED - P-384 and P-521 implementation uses a side-channel vulnerable modular inversion function")

## Details

### (Keywords: csectype-disclosure, sec-high, Whiteboard: [sec-moderate in Firefox][disclosure date 2020-07-28][RedHat INC1266630][sec-survey][adv-main80+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-6829

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sec-moderate in Firefox][disclosure date 2020-07-28][RedHat INC1266630][sec-survey][adv-main80+]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [mboldan](/user_profile?user_id=551058) | [qe-verify](#a8766099_551058 "4 years ago") | - |
| --- | --- | --- |
| [mboldan](/user_profile?user_id=551058) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 3 obsolete files)

| [wnaf\_trace.jpg](/attachment.cgi?id=9141838)  [5 years ago](#c0)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   78.25 KB, image/jpeg |  | [Details](/attachment.cgi?id=9141838&action=edit) |
| --- | --- | --- |
| [Bug 1631583 - ECC: constant time P-384](/attachment.cgi?id=9155893)  [5 years ago](#c20)  [Billy Brumley](/user_profile?user_id=661519)   47 bytes, text/x-phabricator-request | tjr : [sec-approval+](#c44 "5 years ago") | [Details](/attachment.cgi?id=9155893&action=edit) | [Review](/attachment.cgi?id=9155893) |
| [Bug 1631583 - ECC: constant time P-521](/attachment.cgi?id=9157321)  [5 years ago](#c23)  [Billy Brumley](/user_profile?user_id=661519)   47 bytes, text/x-phabricator-request | tjr : [sec-approval+](#c45 "5 years ago") | [Details](/attachment.cgi?id=9157321&action=edit) | [Review](/attachment.cgi?id=9157321) |
| [Screenshot from 2020-06-17 18-06-20.png](/attachment.cgi?id=9157329)  [5 years ago](#c25)  [Billy Brumley](/user_profile?user_id=661519)   134.80 KB, image/png |  | [Details](/attachment.cgi?id=9157329&action=edit) |
| [Bug 1631583 - ECC: constant time P-521](/attachment.cgi?id=9159794)  [5 years ago](#c32)  [Billy Brumley](/user_profile?user_id=661519)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9159794&action=edit) | [Review](/attachment.cgi?id=9159794) |
| [Bug 1631583 ECC: constant time P-384](/attachment.cgi?id=9159808)  [5 years ago](#c33)  [Billy Brumley](/user_profile?user_id=661519)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9159808&action=edit) | [Review](/attachment.cgi?id=9159808) |
| [Bug 1631583 - ECC: constant time P-256](/attachment.cgi?id=9159916)  [5 years ago](#c35)  [Billy Brumley](/user_profile?user_id=661519)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9159916&action=edit) | [Review](/attachment.cgi?id=9159916) |
| [advisory.txt](/attachment.cgi?id=9171205)  [4 years ago](#c54)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   621 bytes, text/plain |  | [Details](/attachment.cgi?id=9171205&action=edit) |

Show Obsolete

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1631583#c0)â€¢ 5 years ago |
|  | |

Attached image
[wnaf\_trace.jpg](attachment.cgi?id=9141838)
â€” [Details](attachment.cgi?id=9141838&action=edit)

[filed from mail to security@ from Sohaib ul Hassan]

Hey Folks!

We are a team of security researchers from Tampere University, Finland.

We have discovered a vulnerability in ECDSA signature generation that

enables us to exfiltrate information from various side channels and

recover the private key.

# Vulnerable function

The vulnerability is found in the non-constant time ECC scalar

multiplication function ec\_GFp\_pt\_mul\_jm\_wNAF @

lib/freebl/ecl/ecp\_jm.cecp\_jm.c. This code path is executed when

either NIST\_P384 or NIST\_P521 EC curve is selected. The wNAF scalar

multiplication computes EC point doubling (ec\_GFp\_pt\_dbl\_jm) at each

iteration, with a conditional branch depending on non-zero scalar

digits, which computes an EC point addition (ec\_GFp\_pt\_add\_jm\_aff).

In general, wNAF point multiplication algorithm is known to be

vulnerable, and successfully targeted in the past e.g. in OpenSSL

ECDSA with L1 cache timings [4], LLC cache timings [3],

ElectroMagnetic emanations (EM) [2], and port contention [1].

Using the EM side-channel, we successfully extracted the position of

zero and non-zero wNAF digits while nss-certutil tool performed scalar

multiplication during the ECDSA signature generation, leaking partial

information about the ECDSA nonce. Given a small number of ECDSA

signatures, this information can be used to steal the private key.

Attached with this report, an EM trace which clearly reveals the

position of point doubling and additions.

We used the EM channel for simplicity, but also achieved success with

various other SW-based channels, including but not limited to timing.

Additionally and related to ECDSA signature generation, we also

exploited using a software controlled side-channel attack the wNAF

encoding function ec\_compute\_wNAF @ lib/freebl/ecl/ec\_naf.c. We were

able to recover the wNAF encoding of the scalar using a single trace.

# Fix

Replace the non-constant time wNAF calls with a constant time

implementation. Our team is willing to help with the fix.

# Disclosure

We are planning for a public disclosure on May 18. But this embargo

date is also up for discussion.

# Links

[1]:

<https://www.thomas-krenn.com/en/wiki/PortSmash_Side-Channel_Vulnerability_CVE-2018-5407>

[2]: <https://eprint.iacr.org/2016/230.pdf>

[3]: <https://eprint.iacr.org/2014/161.pdf>

[4]: <https://www.iacr.org/archive/asiacrypt2009/59120664/59120664.pdf>

We appreciate if you could take a look at this issue at your earliest

convenience. Thanks.

Best Regards,

Sohaib ul Hassan

Doctoral Researcher

Network and Information Security Group

Tampere University

Finland

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1631583#c1)â€¢ 5 years ago |
|  | |

RedHat identifies this issue as INC1266630 in case we need to talk to them about it.

Whiteboard: [disclosure date 2020-05-18] â†’ [disclosure date 2020-05-18][RedHat INC1266630]

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1631583#c2)â€¢ 5 years ago |
|  | |

Thank you and your whole research group for this collection of reports. This comment is being added to each.

Iâ€™m assigning each of these to a team member for more detailed analysis beyond our initial triage. As all of these affect RHEL, I am also requesting impact analysis from our RedHat peers as well, as even if a side-channel is local, that might indicate higher-severity for server software than for Firefox. The analysis will also determine how to allocate CVE numbers, as needed.

I would like to advise that the embargo period your team has initially indicated is quite short, and in this case conflicts with both RedHat and Firefox release cycles. For a bug being actively exploited, we can do what is necessary; in the general case, our Release Calendar [0] indicates that to meet a 18 May disclosure date, we would need to make and uplift a point release of NSS from Nightly to Firefox Beta 76 within 8 days, which, given the complexity involved, seems unrealistic - and moreso for all four bugs at once. Weâ€™ll have a better idea as we complete our analysis of each bug.

Again, thank you for bringing these issues to our attention. Research such as yours makes the whole world safer!

[0] <https://wiki.mozilla.org/Release_Management/Calendar>

Assignee: nobody â†’ kjacobs.bugzillaStatus: NEW â†’ ASSIGNEDFlags: needinfo?(dueno)Priority: -- â†’ P1

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1631583#c3)â€¢ 5 years ago |
|  | |

Sohaib and team,

Weâ€™ve been alerted to the existence of <https://eprint.iacr.org/2020/432.pdf>, so it appears the issue is already publicly disclosed. Luckily, < 0.1% of Firefox beta telemetry are p384 and p521 [0]. Unfortunately, this is likely a serious issue for RedHat, as I expect they are more likely to have customers using the larger curves.

Sohaib: Are there plans for imminent disclosure for any of the other issues?

Dan: Since thereâ€™s now a spotlight pointed at this, weâ€™re definitely going to need a CVE for RedHatâ€™s management.

Bob, RedHat: Heads-up.

[0] <https://mzl.la/3eUrSkW>

URL: <https://eprint.iacr.org/2020/432.pdf>Severity: -- â†’ criticalFlags: needinfo?(sohaibulhassan)Flags: needinfo?(rrelyea)Flags: needinfo?(dveditz)OS: Unspecified â†’ AllHardware: Unspecified â†’ All

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a248145_1689)â€¢ 5 years ago |

Alias: CVE-2020-6829Flags: needinfo?(dveditz)Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)Whiteboard: [disclosure date 2020-05-18][RedHat INC1266630] â†’ [sec-moderate in Firefox][disclosure date 2020-05-18][RedHat INC1266630]

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1631583#c4)â€¢ 5 years ago |
|  | |

For clarification, you might be misreading Table 1 in eprint:2020:432. It is saying NSS is threatened to do the use of BEEA during projective to affine point conversion. The paper is (mostly) unrelated to the "Scalar Multiplication" column, and does not mention wNAF elsewhere in the paper. (Or even define what it is.)

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1631583#c5)â€¢ 5 years ago |
|  | |

In terms of "imminent disclosure", you're seeing everything we have at the moment :)

And Re: eprint:2020:432 -- for the record, Alejandro reported our research results to `security@mozilla.org` on 17 March.

Thanks for the discourse!

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1631583#c6)â€¢ 5 years ago |
|  | |

Our proposed fix for this is, similar to the P-256 code in NSS, a custom `ECGroupStr` for P-384 and P-521 with formally verified and constant time code. My team is happy to assist with that, especially since it is a non-trivial change. (Patching wNAF is a waste of time and effort.)

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1631583#c7)â€¢ 5 years ago |
|  | |

Thanks. We agree that moving to a non-wNAF and constant-time algorithm is the best direction here. That algorithm could be either generic or specific for these two curves.

We would be happy to review and accept a patch (as well as lend assistance with any NSS-specific questions that come up), but if you already have a CT/FV implementation in mind, we can also take on the work of incorporating it into NSS. Let us know how youâ€™d like to proceed.

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a252687_520206)â€¢ 5 years ago |

See Also: â†’ [CVE-2020-12400](/show_bug.cgi?id=1623116 "RESOLVED FIXED - P-384 and P-521 implementation uses a side-channel vulnerable modular inversion function")

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1631583#c8)â€¢ 5 years ago |
|  | |

Public tooling can give us the CT/FV for the GFp layer, but the EC layer and rigging is missing.

I have a pair of researchers working on automating all of this -- the focus there is for OpenSSL but since the EC bits of NSS and OpenSSL were forked from the same source 20 years ago I'm guessing it's not that hard to tweak our tooling output.

And it is somehow easier for NSS since we're only talking about 2 curves here. (cf. like 50 in OpenSSL.) NSS has done a good job of narrowing their attack surface in that sense.

So give us some time and we'll come to you when we have a working implementation. This will take several weeks but we will keep you posted.

I mentioned on another thread (likely buried somewhere) we can **push the embargo date** on all my team's work (#1631576 #1631573 #1631583 #1631597) to at least **02 June**.

Let's take the time to get the fixes in right. I've been fixing and re-fixing OpenSSL now for over a decade, so I feel like I know exactly what *not* to do. (e.g. push out half baked patches and one-liner crutch fixes, punting the problem to other parts of the library.)

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1631583#c9)â€¢ 5 years ago |
|  | |

Excellent - we're glad to have your (collective) eyes on this!

I'm going to needinfo myself to make sure this doesn't fall off the radar. Let me know if any questions come up, or once you're ready for review and testing on the patch.

Flags: needinfo?(kjacobs.bugzilla)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1631583#c10)â€¢ 5 years ago |
|  | |

Per <https://bugzilla.mozilla.org/show_bug.cgi?id=1631583#c8>, updating disclosure date. Thanks, bbrumley and team!

Whiteboard: [sec-moderate in Firefox][disclosure date 2020-05-18][RedHat INC1266630] â†’ [sec-moderate in Firefox][disclosure date 2020-06-02][RedHat INC1266630]

|  | [Robert Relyea](/user_profile?user_id=11099) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1631583#c11)â€¢ 5 years ago |
|  | |

Huzaifas is probably the best person to handle any Red Hat CVE's. If you need me to review anything, let me know.

bob

Flags: needinfo?(rrelyea)

|  | [Huzaifa Sidhpurwala](/user_profile?user_id=331752) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1631583#c12)â€¢ 5 years ago |
|  | |

(In reply to J.C. Jones [:jcj] (he/him) [increased latency due to COVID-19] from [comment #3](/show_bug.cgi?id=1631583#c3 "RESOLVED FIXED - Side channel attack on ECDSA signature generation"))

> Sohaib and team,
>
> Weâ€™ve been alerted to the existence of <https://eprint.iacr.org/2020/432.pdf>, so it appears the issue is already publicly disclosed. Luckily, < 0.1% of Firefox beta telemetry are p384 and p521 [0]. Unfortunately, this is likely a serious issue for RedHat, as I expect they are more likely to have customers using the larger curves.
>
> Sohaib: Are there plans for imminent disclosure for any of the other issues?
>
> Dan: Since thereâ€™s now a spotlight pointed at this, weâ€™re definitely going to need a CVE for RedHatâ€™s management.
>
> Bob, RedHat: Heads-up.
>
> [0] <https://mzl.la/3eUrSkW>

Seems like a CVE has already been assigned to this issue, i can assign CVEs if you want, but isnt Mozilla already a CNA?

Also since the paper is already published, should'nt we consider this issue as already public?

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1631583#c13)â€¢ 5 years ago |
|  | |

Quick update. We are making progress. We have the formally verified GF layer, and at least a first go at an EC layer. We are working essentially on lots of glue -- between the GF layer to the EC layer, and the EC layer to NSS rigging. I hope to have at least something initial to show within a week or so.

(This is for P-384 and P-521.)

BBB

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1631583#c14)â€¢ 5 years ago |
|  | |

(In reply to Huzaifa Sidhpurwala from [comment #12](/show_bug.cgi?id=1631583#c12 "RESOLVED FIXED - Side channel attack on ECDSA signature generation"))

> Seems like a CVE has already been assigned to this issue, i can assign CVEs if you want, but isnt Mozilla already a CNA?
>
> Also since the paper is already published, should'nt we consider this issue as already public?

Huzaifa: Sorry for the delay in responding here. There's already a CVE assigned, as you see, but this issue is not public. The paper points to this function, but doesn't reference this particular vulnerability.

|  | [Emma Humphries â˜•ï¸ðŸŽ¸ðŸ§žâ€â™€ï¸âœ¨ (she/they) [:emceeaich] (Pacific Time) use needinfo](/user_profile?user_id=554394) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1631583#c15)â€¢ 5 years ago |
|  | |

These are current, open bugs with a Severity of `critical`. The Severity of these bugs is being changed to `S2` to be consistent with the May 4 2020 Severity definitions.

Please let Release Management know if these bugs are still `S2`.

Severity: critical â†’ S2

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1631583#c16)â€¢ 5 years ago |
|  | |

Retargeting to 30 June per <https://bugzilla.mozilla.org/show_bug.cgi?id=1631597#c14> - thanks bbrumley and team!

[status-firefox76](/buglist.cgi?f1=cf_status_firefox76&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox76&o1=equals&v1=wontfix)
[status-firefox77](/buglist.cgi?f1=cf_status_firefox77&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox77&o1=equals&v1=wontfix)
[status-firefox78](/buglist.cgi?f1=cf_status_firefox78&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=affected)Whiteboard: [sec-moderate in Firefox][disclosure date 2020-06-02][RedHat INC1266630] â†’ [sec-moderate in Firefox][disclosure date 2020-06-30][RedHat INC1266630]

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a2037192_580382)â€¢ 5 years ago |

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- â†’ [?](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=%3F)

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1631583#c17)â€¢ 5 years ago |
|  | |

Update: our internal unit tests for P-384 and P-521 are now passing. It means one side of the rigging is now done (our own EC layer to fiat's GF layer). So all that's left is

1. More performance optimization of the EC layer
2. NSS rigging

So when we understand the performance tradeoffs more, we'll come to you with a patch.

Right now the code is 64-bit only because it uses the `__int128` type. (And possibly gcc/clang only? I don't know.)

FIAT has 32-bit flavors too that we can likely `ifdef` at compile time, but we don't have that rigged in yet.

Any hints / expectations here in terms of portability, architecture, and required compilers?

My team is a Linux-only shop so anything that isn't gcc or clang we can't sign up for. Cross-architecture is fine -- x64, x32, aarch64, armv7, even maybe mips32 we can test. But yea Linux-only. So we need your help there testing wise since I reckon you support lots of OSs.

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1631583#c18)â€¢ 5 years ago |
|  | |

Tampere University team,

I realize I havenâ€™t replied to your specific questions here, so let me do that as best I can:

> Any hints / expectations here in terms of portability, architecture, and required compilers?

NSS is pretty cross-platform, but the way weâ€™re approaching all of these patches so far is going to be pretty much the same. As weâ€™re doing with the patch for [CVE-2020-12402](https://www.cve.org/CVERecord?id=CVE-2020-12402), weâ€™ll test on all our tier-1 platforms and compilers as part of the review process, but basically thatâ€™s every line depicted here â€” particularly expand the `Builds (+5)` portions to see clang (4) and gcc versions (4.4+). But weâ€™ll help adapt the patches and ensure support.

We can also help with the 32-bit compile-time work with the Fiat code, if you want to post a work-in-progress patch (`moz-phab submit --wip`).

(As something of a reminder to myself, when we do land fiat crypto code, I need to patch Firefoxâ€™s `about:license` to include its license)

Finally, I'm marking 68 ESR as wontfix, since this Firefox's perspective this is more of a sec-moderate and so not a typical ESR candidate.

Root Cause: --- â†’ Coding: Other
[status-firefox79](/buglist.cgi?f1=cf_status_firefox79&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=affected)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=%3F) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix)

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1631583#c19)â€¢ 5 years ago |
|  | |

Great thanks JC.

The code is pretty much ready. I'm confident I'll be able to submit a patch tomorrow. The performance looks very good. Just a small issue to solve on big endian platforms.

For P-384, you'll get both 64-bit and 32-bit portable versions.

Unfortunately for P-521, we can only deliver the 64-bit portable version. The reason is a combination of Fiat limitations and 521 being not on a word boundary.

What I can do is: promise to deliver the 32-bit version if and when Fiat supports that field. All the code is 100% machine generated so when that happens, it's less than a 5min job.

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1631583#c20)â€¢ 5 years ago |
|  | |

Attached file
[Bug 1631583 - ECC: constant time P-384](attachment.cgi?id=9155893)
â€” [Details](attachment.cgi?id=9155893&action=edit)

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1631583#c21)â€¢ 5 years ago |
|  | |

So ... I did the submission with `moz-phab` (I think). Some notes:

* The `ecp_secp384r1.c` file is 100% computer generated.
* For review, try to ignore anything between `/* BEGIN verbatim fiat code */` and `/* END verbatim fiat code */`
* Everything from `static void fe_inv_secp384r1` up to `static void precomp_rdx` is also computer generated like everything else, but with high confidence because we did not hand write the ECC arith formulas or inversion -- they are auto generated from EFD format.
* So for review, try to focus on `static void precomp_rdx` up to and including `mp_err ec_group_set_secp384r1`. In particular, the NSS rigging starts at `#include "mplogic.h"`.
* I need to add some kind of license notice

Here's the numbers for my super crappy laptop, `clang-10` 64-bit build.

## Before

```
bbrumley@emerald:~/svnrepos/libnss/nss$ LD_LIBRARY_PATH=$HOME/svnrepos/libnss/dist/Release/lib ../dist/Release/bin/ecperf
Testing NIST-P256 using freebl implementation...
    ECDH_Derive     count: 100 sec: 0.11 op/sec: 938.89
    ECDSA_Sign      count: 100 sec: 0.02 op/sec: 5196.69
        ECDHE max rate = 1533.90
    ECDSA_Verify    count: 100 sec: 0.05 op/sec: 1937.38
... okay.
Testing NIST-P384 using freebl implementation...
    ECDH_Derive     count: 100 sec: 0.21 op/sec: 481.40
    ECDSA_Sign      count: 100 sec: 0.11 op/sec: 874.95
        ECDHE max rate = 339.09
    ECDSA_Verify    count: 100 sec: 0.19 op/sec: 521.73
... okay.
Testing NIST-P521 using freebl implementation...
    ECDH_Derive     count: 100 sec: 0.29 op/sec: 343.25
    ECDSA_Sign      count: 100 sec: 0.16 op/sec: 622.60
        ECDHE max rate = 241.46
    ECDSA_Verify    count: 100 sec: 0.25 op/sec: 404.48
... okay.
Testing Curve25519 using freebl implementation...
    ECDH_Derive     count: 100 sec: 0.01 op/sec: 18775.82
... okay.

```
## After

```
bbrumley@emerald:~/svnrepos/libnss/nss$ LD_LIBRARY_PATH=$HOME/svnrepos/libnss/dist/Release/lib ../dist/Release/bin/ecperf
Testing NIST-P256 using freebl implementation...
    ECDH_Derive     count: 100 sec: 0.10 op/sec: 953.02
    ECDSA_Sign      count: 100 sec: 0.02 op/sec: 5488.47
        ECDHE max rate = 1610.37
    ECDSA_Verify    count: 100 sec: 0.05 op/sec: 1896.71
... okay.
Testing NIST-P384 using freebl implementation...
    ECDH_Derive     count: 100 sec: 0.16 op/sec: 630.42
    ECDSA_Sign      count: 100 sec: 0.03 op/sec: 3026.82
        ECDHE max rate = 914.31
    ECDSA_Verify    count: 100 sec: 0.10 op/sec: 1044.17
... okay.
Testing NIST-P521 using freebl implementation...
    ECDH_Derive     count: 100 sec: 0.29 op/sec: 350.78
    ECDSA_Sign      count: 100 sec: 0.16 op/sec: 633.75
        ECDHE max rate = 246.13
    ECDSA_Verify    count: 100 sec: 0.24 op/sec: 408.67
... okay.
Testing Curve25519 using freebl implementation...
    ECDH_Derive     count: 100 sec: 0.01 op/sec: 18730.10
... okay.

```

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1631583#c22)â€¢ 5 years ago |
|  | |

Thanks for the patch! The performance improvement is a nice bonus.

We've already started the review, which we plan to complete by the middle of next week (~24 June). For scheduling purposes, is there any ETA on the 64-bit P521 patch?

Flags: needinfo?(kjacobs.bugzilla)

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1631583#c23)â€¢ 5 years ago |
|  | |

Attached file
[Bug 1631583 - ECC: constant time P-521](attachment.cgi?id=9157321)
â€” [Details](attachment.cgi?id=9157321&action=edit)

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1631583#c24)â€¢ 5 years ago |
|  | |

(In reply to Kevin Jacobs [:kjacobs] from [comment #22](/show_bug.cgi?id=1631583#c22 "RESOLVED FIXED - Side channel attack on ECDSA signature generation"))

> Thanks for the patch! The performance improvement is a nice bonus.
>
> We've already started the review, which we plan to complete by the middle of next week (~24 June). For scheduling purposes, is there any ETA on the 64-bit P521 patch?

It's there now ;)

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1631583#c25)â€¢ 5 years ago |
|  | |

Attached image
[Screenshot from 2020-06-17 18-06-20.png](attachment.cgi?id=9157329)
â€” [Details](attachment.cgi?id=9157329&action=edit)

Numbers from the paper attached. Bottom 2 rows are relevant for NSS. Numbers look pretty good.

You're derive is slower because you're doing *explicit* point validation:

1. Checking nP = inf
2. Finally calculating the shared kP

So two scalar multiplications. That made sense when NSS supported a bunch of random curves, but not anymore. Since these are prime-order curves, verifying points satisfy the curve equation is enough so you can do away with (1) above.

It is easy to add that logic to the templating, adding a fourth function pointer. But I haven't yet.

|  | [Robert Relyea](/user_profile?user_id=11099) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1631583#c26)â€¢ 5 years ago |
|  | |

I think it's there as a FIPS requirement to prevent small sub-group attacks. I'd have to check with the lab to verify that it's redundant if y is on the curve and the curve is in a prime field.

RE: machine generated code. I'm OK with that as long as the tool which generated it (and the source input to that tool) is available. (We don't need to rerun it at build time, but we would want users to be able to regenerate their own .c files for the paranoid.

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1631583#c27)â€¢ 5 years ago |
|  | |

Hey Bob,

Absolutely it's a FIPS requirement. But if the point satisfies the curve equation, and the curve has prime-order, it's guaranteed to be order-n. That's a group theory constraint.

All of our tooling will be open sourced as soon as we clean up stuff, and we wanted to wait until embargoes expire.

If you want "early access", just give me a GitLab username and I'm happy to grant access.

PS I'm not sure the paper describing this code generation helps with review, but I'm also happy to share that if you want nitty gritty academic research details. NSS was only a very small part of the work here (on the mathematically "boring" end since these are extremely legacy curves), as you can see from the table. (Nevertheless, we are very happy to have it in scope.)

|  | [Robert Relyea](/user_profile?user_id=11099) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1631583#c28)â€¢ 5 years ago |
|  | |

OK, I will check with the lab, but I think a check that the curve is prime-order (out of paranoia) and skipping the test in that case would be fine.

We don't need early access, if the tools are available "soon" after embargo, that is fine.

bob

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1631583#c29)â€¢ 5 years ago |
|  | |

bbrumley, regarding this bug, [Bug 1631573](/show_bug.cgi?id=1631573 "RESOLVED FIXED - ECDSA Timing Countermeasure Bypass"), and [Bug 1623116](/show_bug.cgi?id=1623116 "RESOLVED FIXED - P-384 and P-521 implementation uses a side-channel vulnerable modular inversion function"):

Could we re-target the disclosure dates out one more release cycle, to 2020-07-28 (Firefox 79)? I know my team has started reviews of this bug's attached patches, and I apologize that we don't have further comments posted yet, but we'll be on that alongside getting this week's release of NSS 3.54 out.

Thanks!

Flags: needinfo?(bbrumley)

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1631583#c30)â€¢ 5 years ago |
|  | |

Hey JC,

> Could we re-target the disclosure dates out one more release cycle, to 2020-07-28 (Firefox 79)? I know my team has started reviews of this bug's attached patches, and I apologize that we don't have further comments posted yet, but we'll be on that alongside getting this week's release of NSS 3.54 out.

Yea let's re-target. It's a lot of code and we didn't exactly deliver in a timely fashion. Let's take the time to do the fix right.

In the meantime, we even have some performance improvements with our tooling. But I guess that's not the main point here, and when the tooling is public I hope we can provide improvements seamlessly from our upstream tooling.

BBB

Flags: needinfo?(bbrumley)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1631583#c31)â€¢ 5 years ago |
|  | |

Thanks so much, bbrumley. It's a lot, and again we appreciate your team's interest, skill, and professionalism. Re-targetting to 2020-07-28.

Whiteboard: [sec-moderate in Firefox][disclosure date 2020-06-30][RedHat INC1266630] â†’ [sec-moderate in Firefox][disclosure date 2020-07-28][RedHat INC1266630]

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1631583#c32)â€¢ 5 years ago |
|  | |

Attached file
[Bug 1631583 - ECC: constant time P-521](attachment.cgi?id=9159794) (obsolete)
â€” [Details](attachment.cgi?id=9159794&action=edit)

Depends on D80012

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1631583#c33)â€¢ 5 years ago |
|  | |

Attached file
[Bug 1631583 ECC: constant time P-384](attachment.cgi?id=9159808) (obsolete)
â€” [Details](attachment.cgi?id=9159808&action=edit)

Depends on D79267

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1631583#c34)â€¢ 5 years ago |
|  | |

Slightly better numbers for P-384:

```
Testing NIST-P384 using freebl implementation...
    ECDH_Derive     count: 100 sec: 0.15 op/sec: 651.02
    ECDSA_Sign      count: 100 sec: 0.02 op/sec: 4013.16
        ECDHE max rate = 1166.05
    ECDSA_Verify    count: 100 sec: 0.09 op/sec: 1151.07
... okay.

```

I guess the P-521 numbers are pretty good too:

## Before

```
Testing NIST-P521 using freebl implementation...
    ECDH_Derive     count: 100 sec: 0.29 op/sec: 345.72
    ECDSA_Sign      count: 100 sec: 0.16 op/sec: 623.53
        ECDHE max rate = 242.31
    ECDSA_Verify    count: 100 sec: 0.25 op/sec: 402.94
... okay.

```
## After

```
Testing NIST-P521 using freebl implementation...
    ECDH_Derive     count: 100 sec: 0.17 op/sec: 605.66
    ECDSA_Sign      count: 100 sec: 0.05 op/sec: 1998.28
        ECDHE max rate = 650.99
    ECDSA_Verify    count: 100 sec: 0.11 op/sec: 927.28
... okay.

```

**But more importantly:** we were able to get the 32-bit Fiat code working for P-521! So this gives you complete coverage for the fix :)

I have no Idea if I'm doing this revision thing correctly. In the git universe this would be fixup commits pushed to the PR branch ... *shrug* pls advise if I'm mucking things up.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a5798568_1689)â€¢ 5 years ago |

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1631583#c35)â€¢ 5 years ago |
|  | |

Attached file
[Bug 1631583 - ECC: constant time P-256](attachment.cgi?id=9159916) (obsolete)
â€” [Details](attachment.cgi?id=9159916&action=edit)

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1631583#c36)â€¢ 5 years ago |
|  | |

I added P-256 for consistency, if you're interested.

## Before

```
Testing NIST-P256 using freebl implementation...
    ECDH_Derive     count: 100 sec: 0.08 op/sec: 1210.81
    ECDSA_Sign      count: 100 sec: 0.03 op/sec: 3622.53
        ECDHE max rate = 1208.34
    ECDSA_Verify    count: 100 sec: 0.06 op/sec: 1603.03
... okay.

```
## After

```
Testing NIST-P256 using freebl implementation...
    ECDH_Derive     count: 100 sec: 0.05 op/sec: 2137.03
    ECDSA_Sign      count: 100 sec: 0.02 op/sec: 5344.74
        ECDHE max rate = 1870.44
    ECDSA_Verify    count: 100 sec: 0.03 op/sec: 2925.52
... okay.

```

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a6022707_580382)â€¢ 5 years ago |

[status-firefox78](/buglist.cgi?f1=cf_status_firefox78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=wontfix)
[tracking-firefox79](/buglist.cgi?f1=cf_tracking_firefox79&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox79&o1=equals&v1=%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- â†’ [79+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=79%2B)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1631583#c37)â€¢ 5 years ago |
|  | |

Hey Bob,

I'm expecting you'll mostly have similar comments as with the 384, but could you take a look at the 521 patch too, please? <https://phabricator.services.mozilla.com/D80012>

Flags: needinfo?(dueno) â†’ needinfo?(rrelyea)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a6271864_600971)â€¢ 5 years ago |

[Attachment #9159808](/attachment.cgi?id=9159808&action=edit "Bug 1631583 ECC: constant time P-384") -
Attachment is obsolete: true

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a6283018_580382)â€¢ 5 years ago |

Blocks: [CVE-2020-12401](/show_bug.cgi?id=1631573 "RESOLVED FIXED - ECDSA Timing Countermeasure Bypass")

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a6283161_600971)â€¢ 5 years ago |

[Attachment #9157321](/attachment.cgi?id=9157321&action=edit "Bug 1631583 - ECC: constant time P-521") -
Attachment description: Bug 1631583 - ECC: constant time P-521 (64-bit) â†’ Bug 1631583 - ECC: constant time P-521

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a6283221_600971)â€¢ 5 years ago |

[Attachment #9159794](/attachment.cgi?id=9159794&action=edit "Bug 1631583 - ECC: constant time P-521") -
Attachment is obsolete: true

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1631583#c38)â€¢ 5 years ago |
|  | |

We are getting failures on aarch64. I don't know why yet.

|  | [Benjamin Beurdouche [:beurdouche]](/user_profile?user_id=622637) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1631583#c39)â€¢ 5 years ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1631583&comment_id=14922535 "1 revision") |
|  | |

Random thought: endianness/signedness issues? : )

|  | [Robert Relyea](/user_profile?user_id=11099) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1631583#c40)â€¢ 5 years ago |
|  | |

OK, I've looked at both and approved them (though see [comment 38](/show_bug.cgi?id=1631583#c38 "RESOLVED FIXED - Side channel attack on ECDSA signature generation") which I just noticed).

Flags: needinfo?(rrelyea)

|  | [Robert Relyea](/user_profile?user_id=11099) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1631583#c41)â€¢ 5 years ago |
|  | |

re [comment 38](/show_bug.cgi?id=1631583#c38 "RESOLVED FIXED - Side channel attack on ECDSA signature generation"): I'm not seeing any potential endian issues. The code seems to treat everything as uint64's or uint128's. I wonder if arm is doing the right thing when multiplying a 128bit value(which is a 64 bit casted to 128 bit) by a 64 bit value and getting the correct 128 bit value

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1631583#c42)â€¢ 5 years ago |
|  | |

> We are getting failures on aarch64. I don't know why yet.

I think we got it. `char` defaults to unsigned on arm but signed on x86/x64. Checking the fixes now.

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1631583#c43)â€¢ 5 years ago |
|  | |

Comment on [attachment 9155893](/attachment.cgi?id=9155893 "Bug 1631583 - ECC: constant time P-384") [[details]](/attachment.cgi?id=9155893&action=edit "Bug 1631583 - ECC: constant time P-384")

[Bug 1631583](/show_bug.cgi?id=1631583 "RESOLVED FIXED - Side channel attack on ECDSA signature generation") - ECC: constant time P-384

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Medium difficulty.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: Yes
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**: It's not risky, but I'm not sure if we want to do this into an ESR this release, or maybe include in a future ESR update.
* **How likely is this patch to cause regressions; how much testing does it need?**: Moderate possibility, but we'd see the issues pretty rapidly when it gets into Beta.
[Attachment #9155893](/attachment.cgi?id=9155893&action=edit "Bug 1631583 - ECC: constant time P-384") -
Flags: sec-approval?

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a7244513_520206)â€¢ 5 years ago |

[Attachment #9157321](/attachment.cgi?id=9157321&action=edit "Bug 1631583 - ECC: constant time P-521") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1631583#c44)â€¢ 5 years ago |
|  | |

Comment on [attachment 9155893](/attachment.cgi?id=9155893 "Bug 1631583 - ECC: constant time P-384") [[details]](/attachment.cgi?id=9155893&action=edit "Bug 1631583 - ECC: constant time P-384")

[Bug 1631583](/show_bug.cgi?id=1631583 "RESOLVED FIXED - Side channel attack on ECDSA signature generation") - ECC: constant time P-384

Approved to land

[Attachment #9155893](/attachment.cgi?id=9155893&action=edit "Bug 1631583 - ECC: constant time P-384") -
Flags: sec-approval? â†’ sec-approval+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1631583#c45)â€¢ 5 years ago |
|  | |

Comment on [attachment 9157321](/attachment.cgi?id=9157321 "Bug 1631583 - ECC: constant time P-521") [[details]](/attachment.cgi?id=9157321&action=edit "Bug 1631583 - ECC: constant time P-521")

[Bug 1631583](/show_bug.cgi?id=1631583 "RESOLVED FIXED - Side channel attack on ECDSA signature generation") - ECC: constant time P-521

Sorry, missed this one!

[Attachment #9157321](/attachment.cgi?id=9157321&action=edit "Bug 1631583 - ECC: constant time P-521") -
Flags: sec-approval? â†’ sec-approval+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1631583#c46)â€¢ 5 years ago |
|  | |

Per JC, we're going to let these fixes ride the regular NSS trains without uplifting since the severity to Firefox is significantly lower.

[status-firefox79](/buglist.cgi?f1=cf_status_firefox79&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix)
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix)
[tracking-firefox79](/buglist.cgi?f1=cf_tracking_firefox79&o1=isnotempty):
[+](/buglist.cgi?f1=cf_tracking_firefox79&o1=equals&v1=%2B) â†’ [-](/buglist.cgi?f1=cf_tracking_firefox79&o1=equals&v1=-)
[tracking-firefox80](/buglist.cgi?f1=cf_tracking_firefox80&o1=isnotempty):
--- â†’ [-](/buglist.cgi?f1=cf_tracking_firefox80&o1=equals&v1=-)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- â†’ [-](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=-)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
[79+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=79%2B) â†’ [-](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=-)

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914)  Assignee |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1631583#c47)â€¢ 5 years ago |
|  | |

try push: <https://treeherder.mozilla.org/#/jobs?repo=try&revision=1bd549658c61b15be26a64c9875e8d594a2bb40f>

nss-try push: <https://treeherder.mozilla.org/#/jobs?repo=nss-try&revision=16596e415bdf93fcc23d1327b24fe43e1036bf01>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a7432800_600971)â€¢ 5 years ago |

[Attachment #9155893](/attachment.cgi?id=9155893&action=edit "Bug 1631583 - ECC: constant time P-384") -
Attachment description: Bug 1631583 ECC: constant time P-384 â†’ Bug 1631583 - ECC: constant time P-384

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914)  Assignee |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1631583#c48)â€¢ 5 years ago |
|  | |

bbrumley: We are ready to land P384/P521, but I noticed that the summaries are all blank. Would you like to provide one, including any credit to you and your team? If not, that's fine too.

Thanks!

Flags: needinfo?(bbrumley)

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1631583#c49)â€¢ 5 years ago |
|  | |

> bbrumley: We are ready to land P384/P521

Great!

> I noticed that the summaries are all blank. Would you like to provide one, including any credit to you and your team? If not, that's fine too.

Oh, right. Sure -- anything similar to below is fine :)

BBB

```
This portable code contributed by the Network and Information Security
Group (NISEC) at Tampere University comes from
[ECCKiila](https://gitlab.com/nisec/ecckiila) that uses
[Fiat](https://github.com/mit-plv/fiat-crypto) for the underlying field
arithmetic.

Co-authored-by: Luis Rivera-Zamarripa <luis.riverazamarripa@tuni.fi>
Co-authored-by: JesÃºs-Javier Chi-DomÃ­nguez <jesus.chidominguez@tuni.fi>

```
Flags: needinfo?(bbrumley)

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914)  Assignee |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1631583#c50)â€¢ 5 years ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1631583&comment_id=14940888 "1 revision") |
|  | |

P384 and P521 landed:

<https://hg.mozilla.org/projects/nss/rev/d19a3cd451bbf9602672fdbba8d6a817a55bfc69>

<https://hg.mozilla.org/projects/nss/rev/ca068f5b5c176c503ddce969e78dd326cc5fd29a>

Regarding the P256 patch, the 32-bit performance takes a ~30-50% hit over the existing implementation. We're still interested in taking it, but need to do some investigation into what kind of impact that would have on Firefox, particularly on mobile devices. Maybe some optimizations are possible. We have an in-progress patch to bring in 64-bit HACL\* P256, but will certainly benchmark it against the 64-bit Fiat code.

I'm going to mark this bug resolved and for now, link it to [bug 1653364](/show_bug.cgi?id=1653364 "RESOLVED WONTFIX") so that we can circle back on the last patch.

Thanks again for these contributions!

Status: ASSIGNED â†’ RESOLVEDClosed: 5 years agoResolution: --- â†’ FIXEDSee Also: â†’ [1615555](/show_bug.cgi?id=1615555 "RESOLVED FIXED - Integration of HACL* P-256")Target Milestone: --- â†’ 3.55

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a7511500_636914)â€¢ 5 years ago |

See Also: [1615555](/show_bug.cgi?id=1615555 "RESOLVED FIXED - Integration of HACL* P-256") â†’

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a7533576_75935)â€¢ 5 years ago |

[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1631583#c51)â€¢ 4 years ago |
|  | |

I'm planning to uplift this bug's patches to the 3.53 branch for whenever we make our next build of NSS destined for ESR 78.

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix) â†’ [fix-optional](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fix-optional)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1631583#c52)â€¢ 4 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1631583) to reply.

Flags: needinfo?(kjacobs.bugzilla)Whiteboard: [sec-moderate in Firefox][disclosure date 2020-07-28][RedHat INC1266630] â†’ [sec-moderate in Firefox][disclosure date 2020-07-28][RedHat INC1266630][sec-survey]

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1631583#c53)â€¢ 4 years ago |
|  | |

NSS\_3\_53\_BRANCH

<https://hg.mozilla.org/projects/nss/rev/e55ab3145546ae3cf1333b43956a974675d2d25c>

<https://hg.mozilla.org/projects/nss/rev/3f022d5eca5d3cd0e366a825a5681953d76299d0>

Flags: needinfo?(sohaibulhassan)

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a8540378_636914)â€¢ 4 years ago |

Flags: needinfo?(kjacobs.bugzilla)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a8563216_1689)â€¢ 4 years ago |

Group: crypto-core-security â†’ core-security-release

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a8766099_551058)â€¢ 4 years ago |

Flags: qe-verify-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a10365688_578488)â€¢ 4 years ago |

Whiteboard: [sec-moderate in Firefox][disclosure date 2020-07-28][RedHat INC1266630][sec-survey] â†’ [sec-moderate in Firefox][disclosure date 2020-07-28][RedHat INC1266630][sec-survey][adv-main80+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1631583#c54)â€¢ 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9171205)
â€” [Details](attachment.cgi?id=9171205&action=edit)

Advisory attached, LMK if any corrections are needed.

|  | [Billy Brumley](/user_profile?user_id=661519) |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1631583#c55)â€¢ 4 years ago |
|  | |

This one is also fine :)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a20926477_1689)â€¢ 4 years ago |

Group: core-security-release

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a45001445_75935)â€¢ 3 years ago |

[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fix-optional) â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1631583#a131234683_600971)â€¢ 7 months ago |

[Attachment #9159916](/attachment.cgi?id=9159916&action=edit "Bug 1631583 - ECC: constant time P-256") -
Attachment is obsolete: true
You need to [log in](/show_bug.cgi?id=1631583&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.debian.org_8d48714b_20250119_133915.html ===

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")

[Wiki](/FrontPage "Debian Wiki Homepage")

[Login](/LTS?action=login)

* [FrontPage](/FrontPage)
* [RecentChanges](/RecentChanges)
* [FindPage](/FindPage)
* [HelpContents](/HelpContents)
* [LTS](/LTS)

Search:

[![Debian](https://www.debian.org/Pics/openlogo-50.png)](https://www.debian.org "Debian Homepage")
[Wiki](/FrontPage "Debian Wiki Homepage")/

* [Login](/LTS?action=login)
* Comments
* [Info](/LTS?action=info)
* [Attachments](/LTS?action=AttachFile)
* More Actions:
  Raw Text
  Print View
  Render as Docbook
  Delete Cache
  ------------------------
  Check Spelling
  Like Pages
  Local Site Map
  ------------------------
  Rename Page
  Delete Page
  ------------------------
  Subscribe User
  ------------------------
  Remove Spam
  Revert to this revision
  Package Pages
  ------------------------
  Load
  Save
  SlideShow

# * [LTS](/LTS)

[Translation(s)](/DebianWiki/EditorGuide#translation): [English](/LTS) - [Deutsch](/de/LTS) - [EspaÃ±ol](/es/LTS) - [FranÃ§ais](/fr/LTS) - [Italiano](/it/LTS) - [í•œêµ­ì–´](/ko/LTS) - [PortuguÃªs](/pt/LTS) - [PortuguÃªs (Brasil)](/pt_BR/LTS) - [Ð ÑƒÑÑÐºÐ¸Ð¹](/ru/LTS)

# Debian Long Term Support

Debian Long Term Support (LTS) is a project to extend the lifetime of all Debian stable releases to (at least) 5 years. Debian LTS is not handled by the Debian Security and Release teams, but by a separate group of volunteers and companies interested in making it a success.

Thus the Debian LTS team takes over security maintenance of the various releases once the Debian Security team stops its work.

![/!\](/htdocs/debwiki/img/alert.png "/!\")

LTS ([last modified 2024-08-15 02:46:47](/LTS?action=info))

* Debian [privacy policy](https://www.debian.org/legal/privacy), Wiki [team](/Teams/DebianWiki), [bugs](https://bugs.debian.org/wiki.debian.org) and [config](https://salsa.debian.org/debian/wiki.debian.org).
* Powered by [MoinMoin](https://moinmo.in/ "This site uses the MoinMoin Wiki software.") and [Python](https://moinmo.in/Python "MoinMoin is written in Python."), with hosting provided by [Metropolitan Area Network Darmstadt](https://www.man-da.de/).


