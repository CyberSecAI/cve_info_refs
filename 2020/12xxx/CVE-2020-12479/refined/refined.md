- **Root cause of vulnerability:** Improper sanitization of user-supplied input when changing language preferences leads to an arbitrary file inclusion vulnerability. The `newValue` parameter, which should contain a language code, is not validated and allows for arbitrary values.
- **Weaknesses/vulnerabilities present:** Arbitrary File Inclusion. The application uses an unsanitized user-provided value to construct a file path, leading to the inclusion of files outside of the intended directory.
- **Impact of exploitation:** An attacker can include arbitrary PHP files from the server's filesystem. This can be combined with file upload vulnerabilities to achieve remote code execution by including a malicious PHP file uploaded by the attacker.
- **Attack vectors:** Sending a crafted POST request to `/teampass/sources/users.queries.php` with a modified `newValue` parameter containing a path to a PHP file on the server.
- **Required attacker capabilities/position:** An attacker needs to be a valid user of the TeamPass application to be able to change their language preference. No specific privileges are explicitly mentioned; an ordinary user account would be sufficient. The attacker needs to know the path to a target file.