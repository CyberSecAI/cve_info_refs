Based on the provided content, here's an analysis of CVE-2020-12888:

**Root cause of vulnerability:**

The root cause is a flaw in the Linux kernel's PCIe Virtual Function I/O (vfio-pci) driver. This driver allows users or virtual machines to disable a device's memory space while it is still mapped into a process's address space.

**Weaknesses/vulnerabilities present:**

The core vulnerability is the lack of proper checks and handling within the vfio-pci driver when a device's memory space is disabled. This results in a race condition where a process can attempt to access a memory region that has been explicitly disabled.

**Impact of exploitation:**

The primary impact of exploiting this vulnerability is a denial-of-service (DoS).  Specifically, on some hardware platforms, this can lead to a hardware error and a system crash. In some cases there is also a potential for privilege escalation but more often the impact is system wide instability.

**Attack vectors:**

The attack vector is local access. This means an attacker must have a user account on the system or be a guest virtual machine.

**Required attacker capabilities/position:**

*   **Local user access:**  The attacker must have an account on the affected system or a guest virtual machine with access to a PCIe Virtual Functions.
*   **Device access:** The attacker needs permissions to access and control PCIe Virtual Functions. In a cloud environment, guest virtual machines may have the ability to control or manipulate their own assigned PCIe devices, including disabling device memory spaces.

**Technical Details**

The vulnerability occurs when a user process, or guest VM, is able to disable a devices memory space via the VFIO driver. This happens by manipulating the PCI command register or implicitly when the device's memory is disabled during a reset sequence. If the same user process or guest VM then attempts to read or write into the memory space after it is disabled, it causes a platform level error to be triggered leading to a system crash and therefore denial of service.

The vulnerability is fixed by adding checks within the vfio driver which prevents access to the memory space if it is disabled, with the goal to block user processes and virtual machines before a platform level error is triggered. The fix is implemented using a memory lock around the memory enable bit and also adds support for faulting on PFNMAP vmas.

The fix involves these key changes:

1.  Adding tracking of the device memory enable bit.
2.  Blocking access when the device MMIO memory is disabled.
3.  Synchronous fault handling for CPU access.
4.  Preventing user triggering platform level error handling.
5.  Blocking access across reset operations.
6.  Blocking MSI-X vector table accesses when disabled

These changes aim to prevent the user from accessing device memory when disabled and return `-EIO` or `SIGBUS` when user process access attempts occur which should lead to a more graceful userland experience as well as avoiding the system crash on the host.

The provided information offers more technical detail about the vulnerability than the official CVE description, particularly relating to implementation details and locking scenarios.