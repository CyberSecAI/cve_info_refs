```
{
  "cveId": "CVE-2020-6807",
  "description": "When a device was changed while a stream was about to be destroyed, the stream-reinit task may have been executed after the stream was destroyed, causing a use-after-free and a potentially exploitable crash.",
  "vulnerabilityDetails": {
    "rootCause": "A data race between the stream-reinit task on the device-changed callback thread, and the stream-destroy task on the main audio thread, leading to a use-after-free condition.",
    "weaknesses": [
      "Use-after-free",
      "Data race"
    ],
    "impact": "A use-after-free condition leading to a potentially exploitable crash.",
    "attackVectors": "Triggering device change events while a stream is being destroyed.",
    "attackerCapabilities": "Ability to change the audio device."
  },
  "affectedProducts": [
    "Thunderbird",
    "Firefox"
  ],
    "patchDetails": "The fix involves unregistering the device-changed callback before destroying the stream, which blocks the current thread until pending device-changed callbacks finish. This prevents the stream-reinit task from being queued after the stream is destroyed, avoiding the use-after-free."
}
```