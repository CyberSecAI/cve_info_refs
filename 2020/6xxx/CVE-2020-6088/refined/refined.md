- **Root cause of vulnerability**: The vulnerability lies in how the Allen-Bradley Flex IO 1794-AENT/B device parses the ENIP Request Path, specifically when a reserved Network Segment Sub-Type is provided.
- **Weaknesses/vulnerabilities present**: The device does not properly validate the Network Segment Length when a reserved Network Segment Sub-Type between 0x50 and 0x5f is used. It reads the subsequent byte as the length in words without checking if the length exceeds the remaining packet data. This leads to a buffer overflow when processing this invalid length.
- **Impact of exploitation**: Successful exploitation of this vulnerability leads to a denial-of-service (DoS) condition. The device enters a fault state, loses communication, and requires a physical power cycle to recover.
- **Attack vectors**: An attacker sends a specially crafted ENIP packet with a reserved Network Segment Sub-Type (0x50-0x5f) and a Network Segment Length byte that specifies a size greater than the remaining data in the packet.
- **Required attacker capabilities/position**: The attacker needs to be able to send network packets to the vulnerable device, implying network access to the device's Ethernet/IP interface. No authentication is required.