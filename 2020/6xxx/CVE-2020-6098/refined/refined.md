The content is related to CVE-2020-6098.

- **Root cause of vulnerability:** The vulnerability is caused by a lack of input validation in the handling of Diameter AVP (Attribute Value Pair) payloads within the `freeDiameterd` server. Specifically, a crafted Diameter CER (Capabilities-Exchange-Request) packet with a malformed AVP can trigger a memory corruption due to an integer underflow when calculating the size of the AVP data, leading to a crash.
- **Weaknesses/vulnerabilities present:**
    - Integer underflow: The calculation of `avp->avp_rawlen` results in an integer underflow due to a malformed AVP length.
    - Memory corruption:  The underflowed `avp->avp_rawlen` is used as the size parameter in a `malloc` call, resulting in allocating a large memory chunk. The subsequent `memcpy` then attempts to copy data to this large buffer using a source and size that lead to memory corruption.
    - Lack of input validation: There is a lack of input validation of the AVP length, allowing the integer underflow to occur.
- **Impact of exploitation:** Exploitation results in a denial of service (DoS) due to a crash in `freeDiameterd`, making the Diameter server unavailable.
- **Attack vectors:** The attack vector is a crafted Diameter CER packet with a malformed AVP sent to the server.
- **Required attacker capabilities/position:** The attacker must be able to send network packets to the vulnerable `freeDiameterd` server. No authentication or special privileges are required.