```
{
  "vulnerability": {
    "cve_id": "CVE-2020-6817",
    "description": "The mozilla/bleach library is vulnerable to a regular expression denial-of-service (ReDoS) in the `BleachSanitizerFilter.sanitize_css` function. This vulnerability can be triggered by crafting specific input strings when the `style` attribute is whitelisted in `bleach.clean` calls.",
    "root_cause": "The vulnerability stems from a poorly constructed regular expression (`gauntlet`) used within the `sanitize_css` function. The regular expression contains mutually inclusive alternation nested inside a quantifier, leading to catastrophic backtracking when processing specially crafted input strings.",
    "weaknesses": [
      "Regular Expression Denial of Service (ReDoS)"
    ],
    "impact": "An attacker can cause a denial of service by providing a crafted input string, causing the regular expression engine to consume excessive CPU resources due to catastrophic backtracking.",
    "attack_vectors": [
      "The vulnerability can be triggered by calling `bleach.clean` with an allowed tag with an allowed `style` attribute. For example, `bleach.clean(..., attributes={'a': ['style']})`"
    ],
    "required_capabilities": "The attacker needs to be able to provide a malicious string as input to the `bleach.clean` function and set the `attributes` argument to allow `style`.",
	"additional_details": "The issue is caused by the overlapping nature of the alternation statements within the regex `([-/:,#%.'\"\\s!\\w]|\\w-\\w|'[\s\\w]+'\\s*|\"[\s\\w]+\"|\\([\\d,%\\.\\s]+\\))*`. The overlapping sections are `\"[\\s\\w]+\"` and `[-/:,#%.'\"\\s!\\w]` , where input like `'\"a\"' * 64` can cause catastrophic backtracking,  or the overlapping  `\\w-\\w` and `[-/:,#%.'\"\\s!\\w]` with `'a-a' * 64`. The `^` in the input ensures none of the alternation statements are matched, so when `$` is hit in the regex, it causes it to backtrack. The vulnerability was present since 2012. The fix was to remove `-`, `'`, and `\"` from the initial alternation statement."
  }
}
```