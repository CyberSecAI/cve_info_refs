=== Content from talosintelligence.com_6d8351a5_20250119_120958.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2020-1001

## Videolabs libmicrodns 0.1.0 mdns\_recv return value denial-of-service vulnerability

##### March 23, 2020

##### CVE Number

CVE-2020-6078

### Summary

An exploitable denial-of-service vulnerability exists in the message-parsing functionality of Videolabs libmicrodns 0.1.0. When parsing mDNS messages in `mdns_recv`, the return value of the `mdns_read_header` function is not checked, leading to an uninitialized variable usage that eventually results in a null pointer dereference, leading to service crash. An attacker can send a series of mDNS messages to trigger this vulnerability.

### Tested Versions

Videolabs libmicrodns 0.1.0

### Product URLs

<https://github.com/videolabs/libmicrodns>

### CVSSv3 Score

7.5 - CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CWE

CWE-252: Unchecked Return Value

### Details

The libmicrodns library is an mDNS resolver that aims to be simple and compatible cross-platform.

The function `mdns_listen_probe_network` handles the data structures used for the reception of mDNS messages. It declares an `mdns_hdr` that stores the header of the last mDNS message processed. It also calls `mdns_recv` [2], which actually fills this structure and parses the rest of the mDNS message. As we can see, the structure is initialized to `0`, but it’s left untouched inside the `mdns_recv` loop.

```
struct mdns_hdr {
        uint16_t id;
        uint16_t flags;
        uint16_t num_qn;
        uint16_t num_ans_rr;
        uint16_t num_auth_rr;
        uint16_t num_add_rr;
};

...

static int
mdns_listen_probe_network(const struct mdns_ctx *ctx, const char *const names[],
                          unsigned int nb_names, mdns_listen_callback callback,
                          void *p_cookie)
{
    struct mdns_hdr ahdr = {0};                                                      // [1]
    struct rr_entry *entries;
    struct pollfd *pfd = alloca( sizeof(*pfd) * ctx->nb_conns );
    int r;

    for (size_t i = 0; i < ctx->nb_conns; ++i) {
            pfd[i].fd = ctx->conns[i].sock;
            pfd[i].events = POLLIN;
    }

    r = poll(pfd, ctx->nb_conns, 1000);
    if (r <= 0) {
            return r;
    }
    for (size_t i = 0; i < ctx->nb_conns; ++i) {
            if ((pfd[i].revents & POLLIN) == 0)
                    continue;
            r = mdns_recv(&ctx->conns[i], &ahdr, &entries);                          // [2]
            if (r == MDNS_NETERR && os_wouldblock())
            {
                    mdns_free(entries);
                    continue;
            }

            if (ahdr.num_ans_rr + ahdr.num_add_rr == 0)
            {
                    mdns_free(entries);
                    continue;
            }

            for (struct rr_entry *entry = entries; entry; entry = entry->next) {
                    for (unsigned int i = 0; i < nb_names; ++i) {
                            if (!strrcmp(entry->name, names[i])) {
                                    callback(p_cookie, r, entries);
                                    break;
                            }
                    }
            }
            mdns_free(entries);
    }
    return 0;
}

```

The function `mdns_recv` reads and parses an mDNS message:

```
static int
mdns_recv(const struct mdns_conn* conn, struct mdns_hdr *hdr, struct rr_entry **entries)
{
        uint8_t buf[MDNS_PKT_MAXSZ];
        size_t num_entry, n;
        ssize_t length;
        struct rr_entry *entry;

        *entries = NULL;
        if ((length = recv(conn->sock, (char *) buf, sizeof(buf), 0)) < 0)       // [3]
                return (MDNS_NETERR);

        const uint8_t *ptr = mdns_read_header(buf, length, hdr);                 // [4]
        n = length;

        num_entry = hdr->num_qn + hdr->num_ans_rr + hdr->num_add_rr;             // [5]
        for (size_t i = 0; i < num_entry; ++i) {
                entry = calloc(1, sizeof(struct rr_entry));
                if (!entry)
                        goto err;
                ptr = rr_read(ptr, &n, buf, entry, i >= hdr->num_qn);            // [6]
                if (!ptr) {
                        free(entry);
                        errno = ENOSPC;
                        goto err;
                }
                entry->next = *entries;
                *entries = entry;
        }
        ...
}

```

At [3], a message is read from the network. The 12-bytes mDNS header is then parsed at [4]. If at least one question/resource-record is found [5], the loop parses the remaining data in the message. by calling `rr_read` [6].

```
static const uint8_t *
mdns_read_header(const uint8_t *ptr, size_t n, struct mdns_hdr *hdr)
{
        if (n <= sizeof(struct mdns_hdr)) {
                errno = ENOSPC;
                return NULL;                               // [7]
        }
        ptr = read_u16(ptr, &n, &hdr->id);
        ptr = read_u16(ptr, &n, &hdr->flags);
        ptr = read_u16(ptr, &n, &hdr->num_qn);
        ptr = read_u16(ptr, &n, &hdr->num_ans_rr);
        ptr = read_u16(ptr, &n, &hdr->num_auth_rr);
        ptr = read_u16(ptr, &n, &hdr->num_add_rr);
        return ptr;
}

```

The function `mdns_read_header` parses the header, and returns NULL [7] when the message is too small (less than or equal to 12). However, after [4], the code doesn’t check the return value of this function. Since the contents of the `hdr` structures are not reset between each call of `mdns_recv`, the line at [5] is effectively accessing uninitialized data.

If `num_entry` is then different from `0` (because of a previous valid mDNS message), the `rr_read` function will be called with `ptr` set to `NULL`. Eventually, `rr_read` will call the `rr_decode` function that will dereference this null pointer at [8], crashing the service.

```
/*
 * Decodes a DN compressed format (RFC 1035)
 * e.g "\x03foo\x03bar\x00" gives "foo.bar"
 */
static const uint8_t *
rr_decode(const uint8_t *ptr, size_t *n, const uint8_t *root, char **ss)
{
        char *s;

        s = *ss = malloc(MDNS_DN_MAXSZ);
        if (!s)
                return (NULL);

        if (*ptr == 0) {                                                   // [8]
                *s = '\0';
                advance(1);
                return (ptr);
        }
        ...

```
### Timeline

2020-01-30 - Vendor Disclosure

2020-03-20 - Vendor Patched

2020-03-23 - Public Release

##### Credit

Discovered by Claudio Bozzato of Cisco Talos.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2020-1002](/vulnerability_reports/TALOS-2020-1002) [Previous Report

TALOS-2020-1000](/vulnerability_reports/TALOS-2020-1000)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from security.gentoo.org_68ef395e_20250119_120957.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# libmicrodns: Multiple vulnerabilities — GLSA **202005-10**

Multiple vulnerabilities have been found in libmicrodns, the worst
of which could result in the arbitrary execution of code.

### Affected packages

| Package | **net-libs/libmicrodns** on all architectures |
| --- | --- |
| Affected versions | < **0.1.2** |
| Unaffected versions | >= **0.1.2** |

### Background

libmicrodns is an mDNS library, focused on being simple and
cross-platform.

### Description

Multiple vulnerabilities have been discovered in libmicrodns. Please
review the CVE identifiers and the upstream advisory referenced below for
details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All libmicrodns users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-libs/libmicrodns-0.1.2"

```
### References

* [CVE-2020-6071](https://nvd.nist.gov/vuln/detail/CVE-2020-6071)
* [CVE-2020-6072](https://nvd.nist.gov/vuln/detail/CVE-2020-6072)
* [CVE-2020-6073](https://nvd.nist.gov/vuln/detail/CVE-2020-6073)
* [CVE-2020-6077](https://nvd.nist.gov/vuln/detail/CVE-2020-6077)
* [CVE-2020-6078](https://nvd.nist.gov/vuln/detail/CVE-2020-6078)
* [CVE-2020-6079](https://nvd.nist.gov/vuln/detail/CVE-2020-6079)
* [CVE-2020-6080](https://nvd.nist.gov/vuln/detail/CVE-2020-6080)
* [VideoLAN-SB-VLC-309](https://www.videolan.org/security/sb-vlc309.html)

**Release date**

May 14, 2020

**Latest revision**

May 14, 2020: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [714606](https://bugs.gentoo.org/show_bug.cgi?id=714606)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.debian.org_2d000379_20250119_120958.html ===


---

[[Date Prev](msg00073.html)][[Date Next](msg00075.html)]
[[Thread Prev](msg00073.html)][[Thread Next](msg00075.html)]
[[Date Index](maillist.html#00074)]
[[Thread Index](threads.html#00074)]

# [SECURITY] [DSA 4671-1] vlc security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 4671-1] vlc security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Thu, 30 Apr 2020 20:48:04 +0000
* *Message-id*: <[[🔎]](/msgid-search/20200430204804.GA3677%40seger.debian.org) [20200430204804.GA3677@seger.debian.org](msg00074.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-4671-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
April 30, 2020                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : vlc
CVE ID         : CVE-2020-6071 CVE-2020-6072 CVE-2020-6073 CVE-2020-6077
                 CVE-2020-6078 CVE-2020-6079 CVE-2020-6080

Multiple security issues were discovered in the microdns plugin of the
VLC media player, which could result in denial of service or potentially
the execution of arbitrary code via malicious mDNS packets.

For the oldstable distribution (stretch), these problems have been fixed
in version 3.0.10-0+deb9u1. This update disables the microdns plugin.

For the stable distribution (buster), these problems have been fixed in
version 3.0.10-0+deb10u1. This update disables the microdns plugin.

We recommend that you upgrade your vlc packages.

For the detailed security status of vlc please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/vlc>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAl6rN7sACgkQEMKTtsN8
TjZAkQ//fhHYmKdfaGWZfJ1vP3Pm2EAOo+vyeZW9u/JkAPACoIuIUwsNaDnYMwI5
45ae4gMLZ0/luRMNkNSML0D+Qipzx1sm+FqkwkbitGO0KYyreagLvMLDZJAGaBTQ
3FeILf13nXV0Rx2Hx9PvvS09LX6DmypCIWWn8DabMs+OOEyeUGiM6JaCY81Ekihe
GBLsEpZQELFxbwSLv8GHjmPuV+uwu3JchK60moYwMpJgEo4Y+ngYDvWLX6PfAi6z
ost2gYeYbsAznZTHrCz7pPasCVLunWvapnZPyEDjMUcfyh+ieulaadjk0t5wMszO
Z8IdVe2JFeQhjZXhubEppUXxTtLWx4kjD+dknsVzu3wa8WPFw8Rad8xUJkYEvxgt
E0WZA6xXscKeltDtGDvTfnIDmrSE+wJE2kqTDZwx4b2ZyDwNL0kGCRdCKdBZopHi
Re5VXc30byoZj0C/w5KdYN1n8DXZRbNf5hm2atSBMbcIBgrktxOHRuut/+zw4tzp
t4LlgqlYcIsjaOWNUaO8hxuX1EAOhQT09X2da7mi6lu51zsUwhOM1BwQ5I5PK5T5
ydPwo434xkhlTEIcctxotM/eKLXExV8ExhPRD4qnGKE6TGfhQS8Fn8sFez5LSYI4
ScKTgN3WvW7eaE0MBxl3Dr+9JlSRaCbc2oDtHbPnFIFULeICFOw=
=qcxN
-----END PGP SIGNATURE-----

```

---


