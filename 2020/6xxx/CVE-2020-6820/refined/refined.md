```
{
  "CVE-2020-6820": {
    "related": true,
    "summary": "Use-after-free when handling a ReadableStream",
    "details": [
      {
        "type": "description",
        "content": "Under certain conditions, when handling a ReadableStream, a race condition can cause a use-after-free. We are aware of targeted attacks in the wild abusing this flaw."
      },
      {
        "type": "vulnerability_details",
        "root_cause": "Race condition during the handling of a ReadableStream leading to a use-after-free.",
         "weaknesses": [
           "Use-after-free",
           "Race Condition"
         ],
        "impact": "Critical. Targeted attacks in the wild are known to be exploiting this flaw. Could lead to arbitrary code execution.",
        "attack_vectors": [
          "Specially crafted website",
           "Browser or browser-like contexts"
          ],
        "attacker_capabilities": "Attacker needs to trick the user into opening a specially crafted website."
       },
      {
       "type": "affected_products",
       "products": [
          "Firefox",
          "Firefox ESR",
          "Thunderbird"
        ],
       "fixed_in": [
          "Firefox 74.0.1",
          "Firefox ESR 68.6.1",
          "Thunderbird 68.7"
          ]
      },
      {
        "type": "additional_info",
        "content": "The vulnerability is located in `mozilla::ipc::ProtocolUtils.h`, specifically in the `Id` function. It involves a double free scenario due to incorrect lifecycle management of `CacheStreamControlParent`. The root cause is a race condition in the shutdown sequence of the cache API where `CacheStreamControlParent` is freed but then still accessed due to an asynchronous message. The fix involves normalizing the shutdown procedure to prevent double frees. JavaScript is required for exploitation."
      }
    ]
  }
}
```