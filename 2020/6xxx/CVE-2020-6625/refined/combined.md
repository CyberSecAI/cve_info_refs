=== Content from security.gentoo.org_3c1da7f8_20250119_122912.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# JHead: Multiple vulnerabilities — GLSA **202007-17**

Multiple vulnerabilities have been found in JHead, the worst of
which could result in a Denial of Service condition.

### Affected packages

| Package | **media-gfx/jhead** on all architectures |
| --- | --- |
| Affected versions | < **3.04** |
| Unaffected versions | >= **3.04** |

### Background

JHead is an exif jpeg header manipulation tool.

### Description

Multiple vulnerabilities have been discovered in JHead. Please review
the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All JHead users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=media-gfx/jhead-3.04"

```
### References

* [CVE-2019-1010301](https://nvd.nist.gov/vuln/detail/CVE-2019-1010301)
* [CVE-2019-1010302](https://nvd.nist.gov/vuln/detail/CVE-2019-1010302)
* [CVE-2019-19035](https://nvd.nist.gov/vuln/detail/CVE-2019-19035)

**Release date**

July 26, 2020

**Latest revision**

July 27, 2020: 2

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [701826](https://bugs.gentoo.org/show_bug.cgi?id=701826)
* [711220](https://bugs.gentoo.org/show_bug.cgi?id=711220)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.sentex.ca_a95b406c_20250119_140646.html ===
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
\*\*\*\*\* Detailed change log - since version 1.2 \*\*\*\*\*
\*\*\*\*\* In cronological order, oldest to newest \*\*\*\*\*
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*
Jun 3 2001:
Added -dc option for deleting all comments
Jun 5 2001:
No longer clip comment length at 200 characters on display
Jul 16 2001
Follow TIFF link correctly
Save thumbnail option added
(Thanks Michal D Hughes for his help mdh(a)logcabin.woods.bridge.com)
Aug 8 & 9 2001
Transfer exif header option added.
Moved relative path & discard all but jpeg stuff in separate functions
Changed ISO heuristic to deal with ISo < 80 better
(Thanks Harry TsaiHarryTsai(a)alum.mit.edu)
Agust 12 2001
Testing under Linux, minor fixups.
-------Released version 1.3-------
August 26 2001
Fixed problem where thumbnails in big endian files were not saved right.
(thanks Joe Steele [joe(a)madewell.com])
Sept 1 2001
Added command line option to remove exif section entirely.
Added time / time-zone adjust option.
Sept 9 2001
Avoid renaming file with right name again with -n option
Change name of SetFileTime variable to not conflict with windows.
Oct 9 2001
Added option to set exif timestamp to absolute time
Added option to save thumbnail to stdout (unix only)
(thanks Nathan Schmidt [mailto:nathan(a)cs.stanford.edu])
Fixed bug in parsing truncated exif headers
(thanks Joachim.Geyer(a)djh-freeweb.de)
Got rid of strnprintf (not avilable on FreeBSD 4.4)
-------Released version 1.4-------
Oct 10 2001
More improved handling of truncated exif headers - as may be produced
by -dt option in older versions of this program.
Oct 18 2001
Fixed bug in -ts option where '-' causes scanf to treat parms as negative.
(thanks Pete Ashdon [mailto:pashdown(a)xmission.com])
Oct 25 2001
Added -ce option
-------Released version 1.5-------
Dec 26 2001
Added -V (version) option
Added -exonly (exif only) option
Jan 2 2002:
Fixed lots of typos (Thanks, David Baker [mailto:dave(a)dsb3.com])
Jan 12: 2002
Use EDITOR environment variable to pick which editor (Instead of notpead or VI)
Jan 13: 2002
Improved thumbnail deletion feature - now not just shortens the header, but
also removes pointers to the thumbnail form the exif header.
-------Released version 1.6-------
Jan 29 2002
Use adjusted date instead of original date when -ta is used in combination
with -ft or -n options
Feb 25 2002
Added image orientation display to summary
April 22 2002
Changed 35mm equivalent focal calculation to use 36mm instead of 35mm for 35mm
negative width (35 mm negative frames are 36 mm wide)
April 28 2002
Split jhead.c int jhead.c and jpgfile.c. Jpgfile.c contains jpeg manipulation
code that is reusable outside of jhead, while jhead.c contains code specific
to jhead (command line parsing, display)
May 11 2002
Fix bug in -dt option that rears its ugly head if the directories are in the
exif header out of order.
-------Released version 1.7-------
June 3 2002
Ignore undefined bits of "flash used" tag, as cannon sets them nonzero, causing
jhead to indicate flash used when it wasn't with some Canon models.
Jul 7 2002
-------Released version 1.8-------
Sept 8 2002
makehtml now also lists .avi files as video clips
Sept 11 2002
Handle first IFD offset != 8, as comes out of Pentax Optio 230 camera.
Sept 13 2002
Show 4 digits of past decimal if exposrure time is less than 0.01 sec.
Sept 25 2002
Integrate patch from James R Van Zandt to allow inclusion of original name
when '%f' is part of rename format string.
Dec 11 2002
-------Released version 1.9-------
Oct 8 2002
Minor changes where newlines are printed.
Added check to warn about wiping out the originals with the -st option.
Oct 9 2002
Fixed display of "flash used=no" for exif headers generated by photoshop.
Oct 13 2002
Added -ci and -cs options.
March 3 2003
Limit directory recursion depth to avoid crashing on circularly linked
directories within the Exif header.
April 6 2003
Added automatic rottion (-autorotate) to right-up images that contain
a rotation tag from the camera.
\*Finally\* wrote a nice MAN page for jhead.
-------Released version 2.0 -- April 2003 -------
Dec ?? 2003
Set all copies of the date to same value when setting or modifying.
(I intentionally only set one, but too may people considered this a bug)
Dec 28 2003
fixed unix makefile
Dec 29 2003
added -cl (insert comment literal) option
Jan 8 2004
Added -norot (zero out rotation tag) option
-------Released version 2.1 -- Jan 2004 -------
Jan 12
Added handling of explicit 35mm equivalent tag
fixed inconsistency in computing 35 mm equivalent focal lengths between
concise and regular output.
Jan 17
Impelemented optoin to supress file date display, for regression tests.
Feb 1
Better indentatin of verbose option, rudementary canon maker not parsing
March
Various spelling errors fixed in output strings, and
jpeg --> JPEG, exif --> Exif
April 13
Use '-outfile' command line option of jpegtran when launching jpegtran to
do rotation so that syntax of launched command is same on Windows and Unix.
April 19
Various spelling fixes in manapge.
Jun 20
Added ability to do sequencial renaming ('%i' in format string for -n option)
-------Released version 2.2 -- Jun 2004 ----------
Handle some oddities - like '/' separators in date fields, or images with
an orientation tag for the thumbnail.
Increase maximum number of jpeg sections to 40 from 20
Dec 3
Don't try to write to readonly files.
Use changed copy of date/time for rename and file time set operations
Dec 25
Added -purejpg and -du options
Dec 28
More details on flash usage.
Show digital zoom ratio
Don't show jpeg process if it's baseline (almost always is)
-------Released version 2.3 -- Jan 2005 ----------
Jan 14 2005
Display GPS info if included in image
Feb 27 2004
Fix some time reference confusion bugs relating to -ta option
May 29 2005
Added -da option for easier adjusting of date/time by large amounts.
-------Released version 2.4 -- May 2005 ----------
Jun 06 2005
Fix -da option
-------Released version 2.4-1 -- Jun 09 2005 --------
Jun 10 2005
Removed some debug printf I accidentally left in!
-------Released version 2.4-2 -- Jun 10 2005 --------
August 8 2005
Avoid duplicating exif header on some commands
Sept 11 2005
Fix up return codes.
Oct 8 2005
Preserve file permissions and time when files are modified.
Oct 29 2005
Read ISO euqivalnt and white balance from canon makernote
Nov 5 2005
Added -rt (replace thumbnail) feature, and rotate the thumbnail also
when using the -autorot feature
Dec 28 2005
Added -rgt (regenerate thumbnail) feature.
Added -orp and -orl options
-------Released version 2.5 -- Jan 8 2006 --------
Jan 28 2006
Fix typecast issue run itno with GCC 4
Feb 17 2006
Fix shutter speed display in '-c' mode for very long shutter speeds
Feb 26 2006
Fix some nitpicks from Debian folks
Mar 6 2006
Fix a bug in autorot when rotating filenames with spaces in them.
April 2 2006
Improved handling of corrupt exif linkages in exif header
April 3 2006
Added -a (rename associated files) options
-------Released version 2.6 -- April 29 2006 --------
Sept 9 2006
Remove maximum jpeg sections limit
Sept 10 2006
Added -ds option
Oct 18 2006
On clearing rotation, clear the image and the optinoal thumbnail rotation tags.
(some viewers use the wrong tag)
Dec 29 2006
Add -mkexif option to make a new exif header.
-------Released version 2.7 -- Jan 11 2007 --------
Feb 10 2007
Added IPTC handling
Feb 11 2007
Added -q option
Feb 17 2007
Fix handling of corrupted GPS directory.
Feb 18 2007
Extract focus distance from canon makernote.
Jun 3 2007
Extract subject range (pentax and fuji cameras)
-------Released version 2.8 -- Nov 13 2007 --------
Feb 14 2008
Fix it so it no longer deletex XMP sections
Improve IPTC handling a little
March 3 2008
Change how date is encoded with -mkexif section to make it more compatible.
Make jhead aware of XMP data and not delete it.
-------Released version 2.82 -- Apr 03 2008 --------
May 8 2008
Decode more exif tags for '-v' mode.
Sep 23 2008
Fix a bunch of potential string overflows
Oct 1 2008
Fix bug where IPTC sction was not deleted by -purejpg
Fix GPS altitude decode bug
-------Released version 2.84 -- Oct 4 2008 --------
Jan 15 2008
Fix bug with -ce introduced as a result of putting all the security
checks the debian people wanted.
Feb 2 2008
Added the ability to move files with the -n option. (makes directories if necessary)
Various minor typo and documentation fixes.
-------Released version 2.86 -- Feb 14 2009 --------
Fixed an #ifdef that I had defined the wrong way, causing the -ce option to fail.
-------Released version 2.87 -- Mar 03 2009 --------
May 2009:
A few more tags recognized with jhead -v
Accept strange date encoding of LG VX-9700
Fix metering mode display
Fix crash bug on corrupted jpeg
Deal better with extra padding bytes between jpeg markers
Nov 3 2009:
Now preserve resoltuion units of jfif header, or set them with info from exif header.
-------Released version 2.88 -- Nov 6 2009 --------
Dec 16 2009:
Handle slightly different signature in IPTC as well.
Jan 25 2010:
Handle mixted-endian-ness files from newer Canon point ant shoot cameras.
Jan 26 2010:
More handling of IPTC variants.
-------Released version 2.90 -- Feb 5 2010 --------
May 7 2010:
Fix a compiler warning
Dec 29 2010:
Make -n behave like -nf, and get rid of that option.
Dec 2 2011:
Handle IPTC in UTF8 (as per photoshop CS5)
-------Released version 2.93 -- Dec 3 2011 --------
Jan 24 2011:
Fixed bug in jhead -cmd that caused metatdata to be deleted.
-------Released version 2.94 -- Jan 24 2012 --------
Mar 3 2011:
Handle very large unsigned rational numbers in exif header
-------Released version 2.95 -- Mar 16 2012 --------
Jun 18 2012:
Fix printing file info when -ft option is used
Do not skip readonle files with -st option
-------Released version 2.96 -- Jun 22 2012 --------
Jul 9 2012:
Make it compile clean with visual studio 10
Jul 28 2012:
Various cleanups from debian folks.
Oct 19 2012:
Add feature to show quality of jpeg, (by Andy Spiegel)
Dec 27 2012:
Fix crash on some corrupt files bug, clarify time adjustment syntax in help
-------Released version 2.97 -- Jan 30 2013 --------
Jun 10 2013:
Make max comment size 16000
Oct 25 2013:
Added "-zt" option to trim 32k of trailing zeroes from Nikon 1 J2 and J3 images.
Sep 28 2014:
Add ability to reset invalid rotation tag (from Moultrie game cameras)
-------Released version 3.0 -- Feb 2 2015 --------
Ma4 5 2015:
Add option to set exif date from date from another file.
Jul 28 2015:
Remove some unnecessary warnings with some types of GPS data
Aug 4 2015:
Remove multiple copies of the same type of section when deleting section types
Aug 11 2011:
Bug fixes relating to fuzz testing.
Aug 1 2017:
Fix bug when no orientation tag is present
Aug 12 2018:
Fix bug of not clearing exif information when processing images with an without
exif data in one invocation.
-------Released version 3.02 -- Dec 11 2018 --------
Dec 21 2018:
Fix bug where thumbnail replacement DID NOT WORK.
(broke while fixing compiler warnings for 3.02 release)
-------Released version 3.03 -- Dec 31 2018 --------
Nov 20 2019:
Apply a whole bunch of patches from Debian.
Spell check and fuzz test stuff from Debian, nothing useful to human users.
-------Released version 3.04 -- Nov 22 2019 --------


=== Content from bugs.gentoo.org_222089bf_20250119_122911.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 876247
<media-gfx/jhead-3.06.0.1: multiple vulnerabilities
Last modified: 2024-06-22 08:32:52 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=876247&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=876247&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 876247**](show_bug.cgi?id=876247)
(CVE-2020-6624, CVE-2020-6625, CVE-2022-41751)
- <media-gfx/jhead-3.06.0.1: multiple vulnerabilities

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<media-gfx/jhead-3.06.0.1: multiple vulnerabilities

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2020-6624, CVE-2020-6625, CVE-2022-41751 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B2 [glsa+] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2022-10-09 03:37 UTC by John Helmert III | | --- | --- | | Modified: | 2024-06-22 08:32 UTC ([History](show_activity.cgi?id=876247)) | | CC List: | 0 users | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=876247&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=876247&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-10-09 03:37:10 UTC  ``` CVE-2020-6624 ([https://bugs.launchpad.net/ubuntu/+source/jhead/+bug/1858744](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858744)):  jhead through 3.04 has a heap-based buffer over-read in process_DQT in jpgqguess.c.  CVE-2020-6625 ([https://bugs.launchpad.net/ubuntu/+source/jhead/+bug/1858746](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858746)):  jhead through 3.04 has a heap-based buffer over-read in Get32s when called from ProcessGpsInfo in gpsinfo.c.  Both bugs untouched in launchpad. We should fix glsa-202007-17, too, as it's referenced in the CVEs.  <https://security.gentoo.org/glsa/202007-17> ```  [Comment 1](#c1)  Andreas K. Hüttel   archtester gentoo-dev  2022-10-18 22:28:21 UTC  ``` (In reply to John Helmert III from [comment #0](show_bug.cgi?id=876247#c0)) > CVE-2020-6624 ([https://bugs.launchpad.net/ubuntu/+source/jhead/+bug/1858744](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858744)): >  > jhead through 3.04 has a heap-based buffer over-read in process_DQT in > jpgqguess.c.  <https://github.com/Matthias-Wandel/jhead/issues/20> maybe??  >  > CVE-2020-6625 ([https://bugs.launchpad.net/ubuntu/+source/jhead/+bug/1858746](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858746)): >  > jhead through 3.04 has a heap-based buffer over-read in Get32s when called > from ProcessGpsInfo in gpsinfo.c.  <https://github.com/Matthias-Wandel/jhead/issues/17> maybe?? if yes, then fixed in 3.06.0.1  >  > Both bugs untouched in launchpad. We should fix glsa-202007-17, too, > as it's referenced in the CVEs. >  > <https://security.gentoo.org/glsa/202007-17> ```  [Comment 2](#c2)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2022-10-19 02:30:04 UTC  ``` CVE-2022-41751 (<https://github.com/Matthias-Wandel/jhead/pull/57>):  Jhead 3.06.0.1 allows attackers to execute arbitrary OS commands by placing them in a JPEG filename and then using the regeneration -rgt50 option.  This one's definitely patched: <https://github.com/Matthias-Wandel/jhead/commit/ba1da7dce9e8f3269159b57b88ff9688624426d2> ```  [Comment 3](#c3)  Larry the Git Cow   gentoo-dev  2023-04-07 12:36:48 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=9fceaf2a9da27bc153a88c26a17ab13dd98e8d23>  commit 9fceaf2a9da27bc153a88c26a17ab13dd98e8d23 Author:     Andreas K. Hüttel <dilfridge@gentoo.org> AuthorDate: 2023-04-07 12:36:28 +0000 Commit:     Andreas K. Hüttel <dilfridge@gentoo.org> CommitDate: 2023-04-07 12:36:28 +0000      media-gfx/jhead: drop 3.04          Bug: <https://bugs.gentoo.org/876247>     Signed-off-by: Andreas K. Hüttel <dilfridge@gentoo.org>   media-gfx/jhead/Manifest          |  1 -  media-gfx/jhead/jhead-3.04.ebuild | 24 ------------------------  2 files changed, 25 deletions(-) ```  [Comment 4](#c4)  John Helmert III   archtester Gentoo Infrastructure gentoo-dev Security  2023-04-30 23:00:03 UTC  ``` Let's trust Andreas and treat these as fixed in 3.06.0.1. ```  [Comment 5](#c5)  Larry the Git Cow   gentoo-dev  2024-06-22 08:30:28 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/data/glsa.git/commit/?id=70a36362e8053f3760826b4ccce860e94299c700>  commit 70a36362e8053f3760826b4ccce860e94299c700 Author:     GLSAMaker <glsamaker@gentoo.org> AuthorDate: 2024-06-22 08:28:39 +0000 Commit:     Hans de Graaff <graaff@gentoo.org> CommitDate: 2024-06-22 08:29:13 +0000      [ GLSA 202406-05 ] JHead: Multiple Vulnerabilities          Bug: <https://bugs.gentoo.org/876247>     Bug: <https://bugs.gentoo.org/879801>     Bug: <https://bugs.gentoo.org/908519>     Signed-off-by: GLSAMaker <glsamaker@gentoo.org>     Signed-off-by: Hans de Graaff <graaff@gentoo.org>   glsa-202406-05.xml | 48 ++++++++++++++++++++++++++++++++++++++++++++++++  1 file changed, 48 insertions(+) ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=876247)
* - [XML](show_bug.cgi?ctype=xml&id=876247)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=876247)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=876247&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=876247&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=876247&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from bugs.launchpad.net_5968880f_20250119_140644.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[jhead package](https://launchpad.net/ubuntu/%2Bsource/jhead)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/jhead)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/jhead)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/jhead)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/jhead)

# heap-buffer-overflow on jhead-3.04/exif.c:336 Get32s

Bug #1858746 reported by
[Binbin Li](https://launchpad.net/~libbin)
on 2020-01-08

[8](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [jhead (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead "Latest release: 1:3.08-3, uploaded to main on 2024-11-08 22:38:39.844813+00:00 by Joachim Reichel (reichel-debian), maintained by Joachim Reichel (reichel-debian)") | New | Undecided | Unassigned |  |

### Bug Description

heap-buffer-overflow on jhead-3.04/exif.c:336 Get32s when we run ./jhead ./input/poc.

lbb@lbb ./jhead ./input/id\_043

Nonfatal Error : './input/id\_043' Suspicious offset of first Exif IFD value

Nonfatal Error : './input/id\_043' Maximum Exif directory nesting exceeded (corrupt Exif header)

Nonfatal Error : './input/id\_043' Illegal number format 32768 for tag 1000 in Exif

Nonfatal Error : './input/id\_043' Maximum Exif directory nesting exceeded (corrupt Exif header)

Nonfatal Error : './input/id\_043' Illegal number format 95 for Exif gps tag 002a

Nonfatal Error : './input/id\_043' Illegal number format 62152 for Exif gps tag 91bf

Nonfatal Error : './input/id\_043' Illegal number format 65529 for Exif gps tag ffff

Nonfatal Error : './input/id\_043' Illegal number format 0 for Exif gps tag 00ff

Nonfatal Error : './input/id\_043' Illegal number format 0 for Exif gps tag 7c00

Nonfatal Error : './input/id\_043' Inappropriate format (4) for Exif GPS coordinates!

Nonfatal Error : './input/id\_043' Illegal number format 65535 for Exif gps tag 1f00

Nonfatal Error : './input/id\_043' Illegal number format 128 for Exif gps tag 0010

Nonfatal Error : './input/id\_043' Illegal number format 0 for Exif gps tag 0087

Nonfatal Error : './input/id\_043' Illegal number format 128 for Exif gps tag 0010

Nonfatal Error : './input/id\_043' Illegal number format 0 for Exif gps tag 0087

Nonfatal Error : './input/id\_043' Illegal number format 0 for Exif gps tag 0092

Nonfatal Error : './input/id\_043' Illegal number format 0 for Exif gps tag 0088

Nonfatal Error : './input/id\_043' Illegal number format 257 for Exif gps tag 2d00

Nonfatal Error : './input/id\_043' Illegal number format 23110 for Exif gps tag 4146

Nonfatal Error : './input/id\_043' Inappropriate format (12) for Exif GPS coordinates!

=================================================================

==25863==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x611000009fdd at pc 0x00000040aeff bp 0x7ffe1a579f50 sp 0x7ffe1a579f40

READ of size 1 at 0x611000009fdd thread T0

    #0 0x40aefe in Get32s /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:336

    #1 0x4115dc in ProcessGpsInfo /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/gpsinfo.c:138

    #2 0x40d9a3 in ProcessExifDir /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:866

    #3 0x40d91c in ProcessExifDir /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:852

    #4 0x40d91c in ProcessExifDir /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:852

    #5 0x40d91c in ProcessExifDir /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:852

    #6 0x40d91c in ProcessExifDir /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:852

    #7 0x40e09a in process\_EXIF /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:1041

    #8 0x408318 in ReadJpegSections /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jpgfile.c:287

    #9 0x408581 in ReadJpegFile /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jpgfile.c:379

    #10 0x405039 in ProcessFile /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jhead.c:905

    #11 0x40267d in main /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jhead.c:1756

    #12 0x7ff18ec8a82f in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x2082f)

    #13 0x403c38 in \_start (/home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jhead+0x403c38)

0x611000009fdd is located 3 bytes to the right of 218-byte region [0x611000009f00,0x611000009fda)

allocated by thread T0 here:

    #0 0x7ff18f3d5602 in malloc (/usr/lib/x86\_64-linux-gnu/libasan.so.2+0x98602)

    #1 0x40798b in ReadJpegSections /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jpgfile.c:173

    #2 0x408581 in ReadJpegFile /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jpgfile.c:379

    #3 0x405039 in ProcessFile /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jhead.c:905

    #4 0x40267d in main /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jhead.c:1756

    #5 0x7ff18ec8a82f in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x2082f)

SUMMARY: AddressSanitizer: heap-buffer-overflow /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:336 Get32s

Shadow bytes around the buggy address:

  0x0c227fff93a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff93b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff93c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff93d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff93e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

=>0x0c227fff93f0: 00 00 00 00 00 00 00 00 00 00 00[02]fa fa fa fa

  0x0c227fff9400: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff9410: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff9420: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff9430: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff9440: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

Shadow byte legend (one shadow byte represents 8 application bytes):

  Addressable: 00

  Partially addressable: 01 02 03 04 05 06 07

  Heap left redzone: fa

  Heap right redzone: fb

  Freed heap region: fd

  Stack left redzone: f1

  Stack mid redzone: f2

  Stack right redzone: f3

  Stack partial redzone: f4

  Stack after return: f5

  Stack use after scope: f8

  Global redzone: f9

  Global init order: f6

  Poisoned by user: f7

  Container overflow: fc

  Array cookie: ac

  Intra object redzone: bb

  ASan internal: fe

==25863==ABORTING

Tags:

[heap-buffer-overflow](/ubuntu/%2Bsource/jhead/%2Bbugs?field.tag=heap-buffer-overflow)
[jhead](/ubuntu/%2Bsource/jhead/%2Bbugs?field.tag=jhead)

## CVE References

* [2020-6625](/bugs/cve/2020-6625 "jhead through 3.04 has a heap-based b...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Binbin Li (libbin)](https://launchpad.net/~libbin) wrote on 2020-01-08: |  |  | [#1](/ubuntu/%2Bsource/jhead/%2Bbug/1858746/comments/1) |
| --- | --- | --- | --- |

* [POC](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Battachment/5318438/%2Bfiles/id_043)
  [Edit](/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Battachment/5318438)
  (240 bytes,
  application/octet-stream)

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/jhead/%2Bfilebug)

This report contains
**Public**
information

Everyone can see this information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Bug attachments

* [POC](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Battachment/5318438/%2Bfiles/id_043)
  [Edit](/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Battachment/5318438 "Change attachment details")

* [Add attachment](/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.gentoo.org_4ca58ae4_20250119_122910.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 711220
<media-gfx/jhead-3.04: Multiple vulnerabilities (CVE-2019-{1010301,1010302})
Last modified: 2022-10-09 03:40:27 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=711220&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=711220&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 711220**](show_bug.cgi?id=711220)
(CVE-2019-1010301, CVE-2019-1010302)
- <media-gfx/jhead-3.04: Multiple vulnerabilities (CVE-2019-{1010301,1010302})

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<media-gfx/jhead-3.04: Multiple vulnerabilities (CVE-2019-{1010301,1010302})

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2019-1010301, CVE-2019-1010302 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal minor | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B3 [glsa+ cve] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") | CC-ARCHES | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [CVE-2019-19035](show_bug.cgi?id=701826 "RESOLVED FIXED - <media-gfx/jhead-3.04: heap based over-read in ReadJpegSections and process_SOFn in jpgfile.c leads to denial of service (CVE-2019-19035)") | |  | Show dependency [tree](showdependencytree.cgi?id=711220&hide_resolved=1) | |  | | Reported: | 2020-03-01 20:33 UTC by Sam James | | --- | --- | | Modified: | 2022-10-09 03:40 UTC ([History](show_activity.cgi?id=711220)) | | CC List: | 2 users (show)  dilfridge graphics+disabled | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * <https://github.com/gentoo/gentoo/pull/16406> * [CVE-2021-28275, CVE-2021-28276, CVE-2021-28277, CVE-2021-28278, CVE-2021-3496](show_bug.cgi?id=730746 "RESOLVED FIXED - <media-gfx/jhead-3.06.0.1: Multiple vulnerabilities (CVE-2020-{6624,6625}, CVE-2021-3496)") | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") | media-gfx/jhead-3.04 | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | | Flags: | nattka: sanity-check+ | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=711220&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=711220&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-03-01 20:33:54 UTC  ``` 1) CVE-2019-1010301  Description: "jhead 3.03 is affected by: Buffer Overflow. The impact is: Denial of service. The component is: gpsinfo.c Line 151 ProcessGpsInfo(). The attack vector is: Open a specially crafted JPEG file."  URL: <https://www.cvedetails.com/cve/CVE-2019-1010301/>  2) CVE-2019-1010302  Description: "jhead 3.03 is affected by: Incorrect Access Control. The impact is: Denial of service. The component is: iptc.c Line 122 show_IPTC(). The attack vector is: the victim must open a specially crafted JPEG file."  URL: <https://www.cvedetails.com/cve/CVE-2019-1010302/>  --- Affected versions: - <3.04? (<https://www.sentex.ca/~mwandel/jhead/changes.txt>) ```  [Comment 1](#c1)  Yury German   Gentoo Infrastructure gentoo-dev  2020-04-12 00:02:48 UTC  ``` Adding 2 more CVE's to this (Same Version)   CVE-2020-6625 (NEW) Closejhead through 3.04 has a heap-based buffer over-read in Get32s when called from ProcessGpsInfo in gpsinfo.c.   CVE-2020-6624 (NEW) Closejhead through 3.04 has a heap-based buffer over-read in process_DQT in jpgqguess.c. ```  [Comment 2](#c2)  Larry the Git Cow   gentoo-dev  2020-07-04 14:27:47 UTC  ``` The bug has been referenced in the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=67e090339cb570cde380194dbc8b68089d9de311>  commit 67e090339cb570cde380194dbc8b68089d9de311 Author:     John Helmert III <jchelmert3@posteo.net> AuthorDate: 2020-06-24 20:39:38 +0000 Commit:     Andreas K. Hüttel <dilfridge@gentoo.org> CommitDate: 2020-07-04 14:25:02 +0000      media-gfx/jhead: Security bump to 3.04          EAPI bumped, src_prepare refactored away, added PATCHES array instead     with a patch that includes the effects of the previous patch. This patch     also includes adding Makefile functionality to create a shared library     that was removed upstream since the last version we have.          Bug: <https://bugs.gentoo.org/701826>     Bug: <https://bugs.gentoo.org/711220>     Package-Manager: Portage-2.3.103, Repoman-2.3.23     Signed-off-by: John Helmert III <jchelmert3@posteo.net>     Closes: <https://github.com/gentoo/gentoo/pull/16406>     Signed-off-by: Andreas K. Hüttel <dilfridge@gentoo.org>   media-gfx/jhead/Manifest                           |  1 +  .../files/jhead-3.04-mkstemp-fix-makefile.patch    | 53 ++++++++++++++++++++++  media-gfx/jhead/jhead-3.04.ebuild                  | 24 ++++++++++  3 files changed, 78 insertions(+) ```  [Comment 3](#c3)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-04 18:17:21 UTC  ``` (In reply to Yury German from [comment #1](show_bug.cgi?id=711220#c1)) > Adding 2 more CVE's to this (Same Version) >  >  > CVE-2020-6625 (NEW) > Closejhead through 3.04 has a heap-based buffer over-read in Get32s when > called from ProcessGpsInfo in gpsinfo.c. >  >  > CVE-2020-6624 (NEW) > Closejhead through 3.04 has a heap-based buffer over-read in process_DQT in > jpgqguess.c.  I'll put these in a new bug just because then we can handle all the fixed stuff together. ```  [Comment 4](#c4)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-14 17:08:12 UTC  ``` No open bugs. Will stable if no objections? ```  [Comment 5](#c5)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-17 03:21:56 UTC  ``` ppc64 stable ```  [Comment 6](#c6)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-17 03:30:23 UTC  ``` ppc stable ```  [Comment 7](#c7)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-17 23:32:05 UTC  ``` x86 stable ```  [Comment 8](#c8)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-17 23:32:23 UTC  ``` amd64 stable ```  [Comment 9](#c9)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-18 18:37:01 UTC  ``` sparc stable. Please cleanup. ```  [Comment 10](#c10)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-26 15:52:33 UTC  ``` GLSA vote: yes ```  [Comment 11](#c11)  GLSAMaker/CVETool Bot   gentoo-dev  2020-07-26 23:58:46 UTC  ``` This issue was resolved and addressed in  GLSA 202007-17 at <https://security.gentoo.org/glsa/202007-17> by GLSA coordinator Sam James (sam_c). ```  [Comment 12](#c12)  Sam James   archtester Gentoo Infrastructure gentoo-dev Security  2020-07-27 01:16:22 UTC  ``` (In reply to GLSAMaker/CVETool Bot from [comment #11](show_bug.cgi?id=711220#c11)) > This issue was resolved and addressed in >  GLSA 202007-17 at <https://security.gentoo.org/glsa/202007-17> > by GLSA coordinator Sam James (sam_c).  Reopening for cleanup. ```  [Comment 13](#c13)  Larry the Git Cow   gentoo-dev  2020-07-27 03:15:33 UTC  ``` The bug has been closed via the following commit(s):  <https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=40cb226be567e8f6b584268028b59b07812e8532>  commit 40cb226be567e8f6b584268028b59b07812e8532 Author:     Sam James <sam@gentoo.org> AuthorDate: 2020-07-27 02:34:17 +0000 Commit:     Sam James <sam@gentoo.org> CommitDate: 2020-07-27 03:15:18 +0000      media-gfx/jhead: security cleanup          Closes: <https://bugs.gentoo.org/711220>     Package-Manager: Portage-3.0.0, Repoman-2.3.23     Signed-off-by: Sam James <sam@gentoo.org>   media-gfx/jhead/Manifest                           |  2 --  .../files/jhead-2.90-mkstemp_respect_flags.patch   | 26 ------------------  media-gfx/jhead/jhead-2.97.ebuild                  | 31 ---------------------  media-gfx/jhead/jhead-3.00-r2.ebuild               | 30 --------------------  media-gfx/jhead/jhead-3.00.ebuild                  | 32 ----------------------  5 files changed, 121 deletions(-) ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=711220)
* - [XML](show_bug.cgi?ctype=xml&id=711220)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=711220)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=711220&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=711220&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=711220&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from github.com_86c0bef3_20250119_140645.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMatthias-Wandel%2Fjhead%2Fissues%2F20)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FMatthias-Wandel%2Fjhead%2Fissues%2F20)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=Matthias-Wandel%2Fjhead)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Matthias-Wandel](/Matthias-Wandel)
/
**[jhead](/Matthias-Wandel/jhead)**
Public

* [Notifications](/login?return_to=%2FMatthias-Wandel%2Fjhead) You must be signed in to change notification settings
* [Fork
  29](/login?return_to=%2FMatthias-Wandel%2Fjhead)
* [Star
   226](/login?return_to=%2FMatthias-Wandel%2Fjhead)

* [Code](/Matthias-Wandel/jhead)
* [Issues
  10](/Matthias-Wandel/jhead/issues)
* [Pull requests
  1](/Matthias-Wandel/jhead/pulls)
* [Discussions](/Matthias-Wandel/jhead/discussions)
* [Actions](/Matthias-Wandel/jhead/actions)
* [Projects
  0](/Matthias-Wandel/jhead/projects)
* [Security](/Matthias-Wandel/jhead/security)
* [Insights](/Matthias-Wandel/jhead/pulse)

Additional navigation options

* [Code](/Matthias-Wandel/jhead)
* [Issues](/Matthias-Wandel/jhead/issues)
* [Pull requests](/Matthias-Wandel/jhead/pulls)
* [Discussions](/Matthias-Wandel/jhead/discussions)
* [Actions](/Matthias-Wandel/jhead/actions)
* [Projects](/Matthias-Wandel/jhead/projects)
* [Security](/Matthias-Wandel/jhead/security)
* [Insights](/Matthias-Wandel/jhead/pulse)

# heap overflow #20

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[heap overflow](#top)#20Copy link![@bird8693](https://avatars.githubusercontent.com/u/13704697?v=4&size=80)
## Description

![@bird8693](https://avatars.githubusercontent.com/u/13704697?v=4&size=48)[bird8693](https://github.com/bird8693)opened [on Mar 24, 2021](https://github.com/Matthias-Wandel/jhead/issues/20#issue-839253289)

Please check [https://bugs.launchpad.net/ubuntu/+source/jhead/+bug/1920605](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1920605)

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugs.launchpad.net_d74afa79_20250119_140644.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858744/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[jhead package](https://launchpad.net/ubuntu/%2Bsource/jhead)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/jhead)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/jhead)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/jhead)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/jhead)

# heap-buffer-overflow on jhead(v3.03, v3.04)/jpgqguess.c:109 process\_DQT

Bug #1858744 reported by
[Binbin Li](https://launchpad.net/~libbin)
on 2020-01-08

[8](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [jhead (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead "Latest release: 1:3.08-3, uploaded to main on 2024-11-08 22:38:39.844813+00:00 by Joachim Reichel (reichel-debian), maintained by Joachim Reichel (reichel-debian)") | New | Undecided | Unassigned |  |

### Bug Description

Heap-buffer-overflow while running jhead(v3.03, v3.04). I can not confirm if this bug is needed to patch. Deatil log as follow: (POC in attachment)

lbb@lbb ./jhead/jhead ./input/id\_m075

Nonfatal Error : './input/id\_m075' Suspicious offset of first Exif IFD value

Nonfatal Error : './input/id\_m075' Illegally sized Exif subdirectory (60138 entries)

Nonfatal Error : './input/id\_m075' Extraneous 11 padding bytes before section 03

Nonfatal Error : './input/id\_m075' Extraneous 10 padding bytes before section DB

Nonfatal Error : './input/id\_m075' Extraneous 12 padding bytes before section 03

Nonfatal Error : './input/id\_m075' Extraneous 164 padding bytes before section C4

Nonfatal Error : './input/id\_m075' Extraneous 10 padding bytes before section EA

Nonfatal Error : './input/id\_m075' Extraneous 10 padding bytes before section 03

Nonfatal Error : './input/id\_m075' Extraneous 11 padding bytes before section 03

Nonfatal Error : './input/id\_m075' Extraneous 10 padding bytes before section DB

=================================================================

==19742==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60700000ddc3 at pc 0x0000004e5c14 bp 0x7fff938f6490 sp 0x7fff938f6488

READ of size 1 at 0x60700000ddc3 thread T0

    #0 0x4e5c13 in process\_DQT /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jpgqguess.c:109:38

    #1 0x4e2d9c in ReadJpegSections /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jpgfile.c:223:17

    #2 0x4e39c7 in ReadJpegFile /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jpgfile.c:379:11

    #3 0x4dea31 in ProcessFile /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jhead.c:905:10

    #4 0x4dea31 in main /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jhead.c:1756

    #5 0x7f3ea4c5f82f in \_\_libc\_start\_main /build/glibc-LK5gWL/glibc-2.23/csu/../csu/libc-start.c:291

    #6 0x435e48 in \_start (/home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jhead+0x435e48)

0x60700000ddc3 is located 0 bytes to the right of 67-byte region [0x60700000dd80,0x60700000ddc3)

allocated by thread T0 here:

    #0 0x4bcdf2 in \_\_interceptor\_malloc (/home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jhead+0x4bcdf2)

    #1 0x4e291c in ReadJpegSections /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jpgfile.c:173:25

    #2 0x4e39c7 in ReadJpegFile /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jpgfile.c:379:11

SUMMARY: AddressSanitizer: heap-buffer-overflow /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jpgqguess.c:109 process\_DQT

Shadow bytes around the buggy address:

  0x0c0e7fff9b60: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c0e7fff9b70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c0e7fff9b80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c0e7fff9b90: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c0e7fff9ba0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

=>0x0c0e7fff9bb0: 00 00 00 00 00 00 00 00[03]fa fa fa fa fa 00 00

  0x0c0e7fff9bc0: 00 00 00 00 00 00 03 fa fa fa fa fa 00 00 00 00

  0x0c0e7fff9bd0: 00 00 00 00 03 fa fa fa fa fa 00 00 00 00 00 00

  0x0c0e7fff9be0: 00 00 03 fa fa fa fa fa 00 00 00 00 00 00 00 00

  0x0c0e7fff9bf0: 03 fa fa fa fa fa fd fd fd fd fd fd fd fd fd fd

  0x0c0e7fff9c00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

Shadow byte legend (one shadow byte represents 8 application bytes):

  Addressable: 00

  Partially addressable: 01 02 03 04 05 06 07

  Heap left redzone: fa

  Heap right redzone: fb

  Freed heap region: fd

  Stack left redzone: f1

  Stack mid redzone: f2

  Stack right redzone: f3

  Stack partial redzone: f4

  Stack after return: f5

  Stack use after scope: f8

  Global redzone: f9

  Global init order: f6

  Poisoned by user: f7

  Container overflow: fc

  Array cookie: ac

  Intra object redzone: bb

  ASan internal: fe

  Left alloca redzone: ca

  Right alloca redzone: cb

==19742==ABORTING

See [original description](comments/0)

Tags:

[jhead](/ubuntu/%2Bsource/jhead/%2Bbugs?field.tag=jhead)
[stack-buffer-overflow](/ubuntu/%2Bsource/jhead/%2Bbugs?field.tag=stack-buffer-overflow)

## CVE References

* [2020-6624](/bugs/cve/2020-6624 "jhead through 3.04 has a heap-based b...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Binbin Li (libbin)](https://launchpad.net/~libbin) wrote on 2020-01-08: |  |  | [#1](/ubuntu/%2Bsource/jhead/%2Bbug/1858744/comments/1) |
| --- | --- | --- | --- |

* [POC](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858744/%2Battachment/5318434/%2Bfiles/id_m075)
  [Edit](/ubuntu/%2Bsource/jhead/%2Bbug/1858744/%2Battachment/5318434)
  (102.7 KiB,
  application/octet-stream)

| **description**: | updated |
| --- | --- |

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858744/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/jhead/%2Bfilebug)

This report contains
**Public**
information

Everyone can see this information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/jhead/%2Bbug/1858744/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858744/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858744/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Bug attachments

* [POC](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858744/%2Battachment/5318434/%2Bfiles/id_m075)
  [Edit](/ubuntu/%2Bsource/jhead/%2Bbug/1858744/%2Battachment/5318434 "Change attachment details")

* [Add attachment](/ubuntu/%2Bsource/jhead/%2Bbug/1858744/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_662e5e24_20250119_140646.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[jhead package](https://launchpad.net/ubuntu/%2Bsource/jhead)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/jhead)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/jhead)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/jhead)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/jhead)

# heap-buffer-overflow on jhead-3.04/exif.c:336 Get32s

Bug #1858746 reported by
[Binbin Li](https://launchpad.net/~libbin)
on 2020-01-08

[8](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [jhead (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead "Latest release: 1:3.08-3, uploaded to main on 2024-11-08 22:38:39.844813+00:00 by Joachim Reichel (reichel-debian), maintained by Joachim Reichel (reichel-debian)") | New | Undecided | Unassigned |  |

### Bug Description

heap-buffer-overflow on jhead-3.04/exif.c:336 Get32s when we run ./jhead ./input/poc.

lbb@lbb ./jhead ./input/id\_043

Nonfatal Error : './input/id\_043' Suspicious offset of first Exif IFD value

Nonfatal Error : './input/id\_043' Maximum Exif directory nesting exceeded (corrupt Exif header)

Nonfatal Error : './input/id\_043' Illegal number format 32768 for tag 1000 in Exif

Nonfatal Error : './input/id\_043' Maximum Exif directory nesting exceeded (corrupt Exif header)

Nonfatal Error : './input/id\_043' Illegal number format 95 for Exif gps tag 002a

Nonfatal Error : './input/id\_043' Illegal number format 62152 for Exif gps tag 91bf

Nonfatal Error : './input/id\_043' Illegal number format 65529 for Exif gps tag ffff

Nonfatal Error : './input/id\_043' Illegal number format 0 for Exif gps tag 00ff

Nonfatal Error : './input/id\_043' Illegal number format 0 for Exif gps tag 7c00

Nonfatal Error : './input/id\_043' Inappropriate format (4) for Exif GPS coordinates!

Nonfatal Error : './input/id\_043' Illegal number format 65535 for Exif gps tag 1f00

Nonfatal Error : './input/id\_043' Illegal number format 128 for Exif gps tag 0010

Nonfatal Error : './input/id\_043' Illegal number format 0 for Exif gps tag 0087

Nonfatal Error : './input/id\_043' Illegal number format 128 for Exif gps tag 0010

Nonfatal Error : './input/id\_043' Illegal number format 0 for Exif gps tag 0087

Nonfatal Error : './input/id\_043' Illegal number format 0 for Exif gps tag 0092

Nonfatal Error : './input/id\_043' Illegal number format 0 for Exif gps tag 0088

Nonfatal Error : './input/id\_043' Illegal number format 257 for Exif gps tag 2d00

Nonfatal Error : './input/id\_043' Illegal number format 23110 for Exif gps tag 4146

Nonfatal Error : './input/id\_043' Inappropriate format (12) for Exif GPS coordinates!

=================================================================

==25863==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x611000009fdd at pc 0x00000040aeff bp 0x7ffe1a579f50 sp 0x7ffe1a579f40

READ of size 1 at 0x611000009fdd thread T0

    #0 0x40aefe in Get32s /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:336

    #1 0x4115dc in ProcessGpsInfo /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/gpsinfo.c:138

    #2 0x40d9a3 in ProcessExifDir /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:866

    #3 0x40d91c in ProcessExifDir /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:852

    #4 0x40d91c in ProcessExifDir /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:852

    #5 0x40d91c in ProcessExifDir /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:852

    #6 0x40d91c in ProcessExifDir /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:852

    #7 0x40e09a in process\_EXIF /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:1041

    #8 0x408318 in ReadJpegSections /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jpgfile.c:287

    #9 0x408581 in ReadJpegFile /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jpgfile.c:379

    #10 0x405039 in ProcessFile /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jhead.c:905

    #11 0x40267d in main /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jhead.c:1756

    #12 0x7ff18ec8a82f in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x2082f)

    #13 0x403c38 in \_start (/home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jhead+0x403c38)

0x611000009fdd is located 3 bytes to the right of 218-byte region [0x611000009f00,0x611000009fda)

allocated by thread T0 here:

    #0 0x7ff18f3d5602 in malloc (/usr/lib/x86\_64-linux-gnu/libasan.so.2+0x98602)

    #1 0x40798b in ReadJpegSections /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jpgfile.c:173

    #2 0x408581 in ReadJpegFile /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jpgfile.c:379

    #3 0x405039 in ProcessFile /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jhead.c:905

    #4 0x40267d in main /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/jhead.c:1756

    #5 0x7ff18ec8a82f in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x2082f)

SUMMARY: AddressSanitizer: heap-buffer-overflow /home/lbb/afl-experient/Tests/ASAN/jhead-3.04/exif.c:336 Get32s

Shadow bytes around the buggy address:

  0x0c227fff93a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff93b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff93c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff93d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff93e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

=>0x0c227fff93f0: 00 00 00 00 00 00 00 00 00 00 00[02]fa fa fa fa

  0x0c227fff9400: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff9410: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff9420: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff9430: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c227fff9440: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

Shadow byte legend (one shadow byte represents 8 application bytes):

  Addressable: 00

  Partially addressable: 01 02 03 04 05 06 07

  Heap left redzone: fa

  Heap right redzone: fb

  Freed heap region: fd

  Stack left redzone: f1

  Stack mid redzone: f2

  Stack right redzone: f3

  Stack partial redzone: f4

  Stack after return: f5

  Stack use after scope: f8

  Global redzone: f9

  Global init order: f6

  Poisoned by user: f7

  Container overflow: fc

  Array cookie: ac

  Intra object redzone: bb

  ASan internal: fe

==25863==ABORTING

Tags:

[heap-buffer-overflow](/ubuntu/%2Bsource/jhead/%2Bbugs?field.tag=heap-buffer-overflow)
[jhead](/ubuntu/%2Bsource/jhead/%2Bbugs?field.tag=jhead)

## CVE References

* [2020-6625](/bugs/cve/2020-6625 "jhead through 3.04 has a heap-based b...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Binbin Li (libbin)](https://launchpad.net/~libbin) wrote on 2020-01-08: |  |  | [#1](/ubuntu/%2Bsource/jhead/%2Bbug/1858746/comments/1) |
| --- | --- | --- | --- |

* [POC](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Battachment/5318438/%2Bfiles/id_043)
  [Edit](/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Battachment/5318438)
  (240 bytes,
  application/octet-stream)

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/jhead/%2Bfilebug)

This report contains
**Public**
information

Everyone can see this information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Bug attachments

* [POC](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Battachment/5318438/%2Bfiles/id_043)
  [Edit](/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Battachment/5318438 "Change attachment details")

* [Add attachment](/ubuntu/%2Bsource/jhead/%2Bbug/1858746/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))


