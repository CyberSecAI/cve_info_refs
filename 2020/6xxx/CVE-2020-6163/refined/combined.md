=== Content from phabricator.wikimedia.org_e47b5680_20250119_112559.html ===
Page Menu[HomePhabricator](/)

* SearchConfigure Global Search

[Log In](https://phabricator.wikimedia.org/auth/start/?next=%2FT240773)[Create Task](/maniphest/task/edit/nocreate/) [Maniphest](/maniphest/)  T240773
# Exposed HTML in WikibaseMediaInfo autocomplete suggestions (CVE-2020-6163)Closed, Resolved[Public](/policy/explain/PHID-TASK-n2rh55tc7dovxhocdvqd/view/)Actions

* [Edit Task](/maniphest/task/edit/240773/)
* Edit Related Tasks...
* [Create Subtask](/maniphest/task/subtask/240773/)
* [Edit Parent Tasks](/search/rel/task.has-parent/PHID-TASK-n2rh55tc7dovxhocdvqd/)
* [Edit Subtasks](/search/rel/task.has-subtask/PHID-TASK-n2rh55tc7dovxhocdvqd/)
* [Merge Duplicates In](/search/rel/task.merge-in/PHID-TASK-n2rh55tc7dovxhocdvqd/)
* [Close As Duplicate](/search/rel/task.close-as-duplicate/PHID-TASK-n2rh55tc7dovxhocdvqd/)
* Edit Related Objects...
* [Edit Commits](/search/rel/task.has-commit/PHID-TASK-n2rh55tc7dovxhocdvqd/)
* [Edit Mocks](/search/rel/task.has-mock/PHID-TASK-n2rh55tc7dovxhocdvqd/)
* Subscribe
* [Mute Notifications](/subscriptions/mute/PHID-TASK-n2rh55tc7dovxhocdvqd/)
* [Protect as security issue](/wmf/escalate-task/240773/)
* [Award Token](/token/give/PHID-TASK-n2rh55tc7dovxhocdvqd/)
* [Flag For Later](/flag/edit/PHID-TASK-n2rh55tc7dovxhocdvqd/)

Assigned To

|  | [matthiasmullie](/p/matthiasmullie/) |
| --- | --- |

Authored By

|  | [Bugreporter](/p/Bugreporter/) |
| --- | --- |
| Dec 14 2019, 11:05 PM2019-12-14 23:05:35 (UTC+0) |

Tags

* [WikibaseMediaInfo](/tag/wikibasemediainfo/) [(Backlog)](/project/board/1816/)
* [Structured Data Engineering](/tag/structured_data_engineering/) [(To Do)](/project/board/3633/)
* [Structured-Data-Backlog (Current Work)](/project/view/4232/) [(Verify on Production)](/project/board/4232/)
* [Security-Team](/tag/security-team/) [(Our Part Is Done)](/project/board/1179/)
* [Vuln-XSS](/tag/vuln-xss/)
* [Security](/tag/security/)
Referenced FilesNoneSubscribers

|  | [Aklapper](/p/Aklapper/) |
| --- | --- |

|  | [Bugreporter](/p/Bugreporter/) |
| --- | --- |

|  | [Keegan](/p/Keegan/) |
| --- | --- |

|  | [matthiasmullie](/p/matthiasmullie/) |
| --- | --- |

|  | [• PDrouin-WMF](/p/PDrouin-WMF/) |
| --- | --- |

|  | [• Ramsey-WMF](/p/Ramsey-WMF/) |
| --- | --- |

|  | [sbassett](/p/sbassett/) |
| --- | --- |

# Description

Introduced in [T235754: Implement haswbstatement:P<depicts>=Q<your term> autocomplete suggestions](/T235754):

* restore <https://www.wikidata.org/w/index.php?title=Q13406268&oldid=1076235008>, which has en label "<p onmouseover=alert(1)>1</p>"
* in Commons search box, type "<p" or "Q13406268"
* now you will find the autocomplete suggestion is exposed.
# Details

|  | Subject | Repo | Branch | Lines +/- |
| --- | --- | --- | --- | --- |
|  | [Escape labels in HTML output](https://gerrit.wikimedia.org/r/c/558203) | [mediawiki/extensions/WikibaseMediaInfo](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/WikibaseMediaInfo) | [master](https://gerrit.wikimedia.org/r/plugins/gitiles/mediawiki/extensions/WikibaseMediaInfo/%2B/master) | +1 -1 |

[Customize query in gerrit](https://gerrit.wikimedia.org/r/#/q/bug:T240773)
# Related ObjectsSearch...

* Task Graph
* Mentions

|  |  | Status | Subtype | Assigned | Task |
| --- | --- | --- | --- | --- | --- |
|  |  | Resolved |  | [Reedy](/p/Reedy/) | T240392 [Release MediaWiki 1.31.7/1.33.3/1.34.1](/T240392) |
|  |  | Resolved |  | [sbassett](/p/sbassett/) | T240400 [Write and send supplementary release announcement for extensions and skins with security patches (MediaWiki 1.31.7/1.33.3/1.34.1)](/T240400) |
|  |  | Resolved |  | [matthiasmullie](/p/matthiasmullie/) | T240773 [Exposed HTML in WikibaseMediaInfo autocomplete suggestions (CVE-2020-6163)](/T240773) |

Mentioned In [T240400: Write and send supplementary release announcement for extensions and skins with security patches (MediaWiki 1.31.7/1.33.3/1.34.1)](/T240400) Mentioned Here [T235754: Implement haswbstatement:P<depicts>=Q<your term> autocomplete suggestions](/T235754)
### Event Timeline

[Bugreporter](/p/Bugreporter/) created this task.[Dec 14 2019, 11:05 PM2019-12-14 23:05:35 (UTC+0)](#5741993)Restricted Application added a subscriber: [Aklapper](/p/Aklapper/).  · [View Herald Transcript](/herald/transcript/3445354/)[Dec 14 2019, 11:05 PM2019-12-14 23:05:37 (UTC+0)](#5742004)[Bugreporter](/p/Bugreporter/) added projects: [WikibaseMediaInfo](/tag/wikibasemediainfo/), [Structured Data Engineering](/tag/structured_data_engineering/).[Dec 14 2019, 11:06 PM2019-12-14 23:06:23 (UTC+0)](#5742005)Restricted Application added a project: [Structured-Data-Backlog](/tag/structured-data-backlog/).  · [View Herald Transcript](/herald/transcript/3445355/)[Dec 14 2019, 11:06 PM2019-12-14 23:06:24 (UTC+0)](#5742006)[Bugreporter](/p/Bugreporter/) added subscribers: [• Ramsey-WMF](/p/Ramsey-WMF/), [Keegan](/p/Keegan/), [• PDrouin-WMF](/p/PDrouin-WMF/).[Dec 14 2019, 11:07 PM2019-12-14 23:07:52 (UTC+0)](#5742007)Comment Actions

[@matthiasmullie](/p/matthiasmullie/) as the developer.

[Bugreporter](/p/Bugreporter/) added a subscriber: [matthiasmullie](/p/matthiasmullie/).[Dec 14 2019, 11:08 PM2019-12-14 23:08:17 (UTC+0)](#5742009)[Bugreporter](/p/Bugreporter/) added a comment.[Dec 16 2019, 8:06 PM2019-12-16 20:06:06 (UTC+0)](#5745773)Comment Actions

[@matthiasmullie](/p/matthiasmullie/) (probably the previous ping does not work)

[Bugreporter](/p/Bugreporter/) added a comment.[Dec 16 2019, 8:07 PM2019-12-16 20:07:37 (UTC+0)](#5745795)This comment was removed by [Bugreporter](/p/Bugreporter/).[Bugreporter](/p/Bugreporter/) added a comment.[Dec 16 2019, 8:08 PM2019-12-16 20:08:04 (UTC+0)](#5745798)Comment Actions

[@Ramsey-WMF](/p/Ramsey-WMF/) please see this

[matthiasmullie](/p/matthiasmullie/) claimed this task.[Dec 16 2019, 8:10 PM2019-12-16 20:10:24 (UTC+0)](#5745804)[matthiasmullie](/p/matthiasmullie/) edited projects, added [Structured-Data-Backlog (Current Work)](/project/view/4232/); removed [Structured-Data-Backlog](/tag/structured-data-backlog/).[• Ramsey-WMF](/p/Ramsey-WMF/) added a comment.[Dec 16 2019, 8:16 PM2019-12-16 20:16:35 (UTC+0)](#5745822)Comment Actions

Looking into it.

[Aklapper](/p/Aklapper/) added a comment.[Dec 16 2019, 8:17 PM2019-12-16 20:17:25 (UTC+0)](#5745824)Comment Actions

[[@Bugreporter](/p/Bugreporter/): Please stop pinging people one by one and creating notification emails for each comment. Thanks for your understanding.]

[matthiasmullie](/p/matthiasmullie/) moved this task from [Incoming](/project/board/4232/) to [Code Review](/project/board/4232/) on the [Structured-Data-Backlog (Current Work)](/project/view/4232/) board.[Dec 16 2019, 8:40 PM2019-12-16 20:40:17 (UTC+0)](#5745890)[sbassett](/p/sbassett/) moved this task from [Backlog / Other](/project/board/30/) to [Other WMF team](/project/board/30/) on the [acl\*security](/tag/acl_security/) board.[Dec 16 2019, 8:48 PM2019-12-16 20:48:35 (UTC+0)](#5745900)[sbassett](/p/sbassett/) added projects: [Security-Team](/tag/security-team/), [Vuln-XSS](/tag/vuln-xss/).[sbassett](/p/sbassett/) moved this task from [Incoming](/project/board/1179/) to [Watching](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[matthiasmullie](/p/matthiasmullie/) moved this task from [Code Review](/project/board/4232/) to [Needs QA](/project/board/4232/) on the [Structured-Data-Backlog (Current Work)](/project/view/4232/) board.[Dec 17 2019, 5:03 PM2019-12-17 17:03:37 (UTC+0)](#5748302)[• Ramsey-WMF](/p/Ramsey-WMF/) moved this task from [Needs QA](/project/board/4232/) to [Verify on Production](/project/board/4232/) on the [Structured-Data-Backlog (Current Work)](/project/view/4232/) board.[Dec 17 2019, 5:34 PM2019-12-17 17:34:36 (UTC+0)](#5748452)[Reedy](/p/Reedy/) triaged this task as Medium priority.[Dec 18 2019, 5:01 PM2019-12-18 17:01:07 (UTC+0)](#5751755)[matthiasmullie](/p/matthiasmullie/) closed this task as Resolved.[Jan 6 2020, 6:48 PM2020-01-06 18:48:38 (UTC+0)](#5778948)Comment Actions

This is now fixed - confirmed with example mentioned in task description.

[sbassett](/p/sbassett/) subscribed.[Jan 6 2020, 6:59 PM2020-01-06 18:59:54 (UTC+0)](#5779013)Comment Actions

[@matthiasmullie](/p/matthiasmullie/) - Is there a gerrit patch set or security patch we could reference here? Backports to supported release branches or a CVE? The [Security-Team](/tag/security-team/) can help with the latter if need be. Thanks.

[matthiasmullie](/p/matthiasmullie/) added a comment.[Jan 6 2020, 7:54 PM2020-01-06 19:54:32 (UTC+0)](#5779321)Comment Actions

Yes - not sure why gerritbot didn't pick it up, but here's the patch: [https://gerrit.wikimedia.org/r/c/mediawiki/extensions/WikibaseMediaInfo/+/558203](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/WikibaseMediaInfo/%2B/558203)

[sbassett](/p/sbassett/) added a comment.[Jan 6 2020, 8:10 PM2020-01-06 20:10:18 (UTC+0)](#5779382)Comment Actions
> In [T240773#5779321](/T240773#5779321), [@matthiasmullie](/p/matthiasmullie/) wrote:
>
> Yes - not sure why gerritbot didn't pick it up, but here's the patch: [https://gerrit.wikimedia.org/r/c/mediawiki/extensions/WikibaseMediaInfo/+/558203](https://gerrit.wikimedia.org/r/c/mediawiki/extensions/WikibaseMediaInfo/%2B/558203)

Thanks! gerritbot can't currently see security-protected Phab tasks.

[sbassett](/p/sbassett/) added a comment.[Jan 7 2020, 9:39 PM2020-01-07 21:39:27 (UTC+0)](#5783978)Comment Actions

So it doesn't look like templates/search/PropertySuggestionsWidget.mustache+dom existed in REL1\_34 or previous, so no backports necessary. I'm going make the task public now and request a CVE.

[sbassett](/p/sbassett/) changed the visibility from "[Custom Policy](/transactions/old/PHID-XACT-TASK-2nd42wouz7dunmr/)" to "Public (No Login Required)".[Jan 7 2020, 9:39 PM2020-01-07 21:39:39 (UTC+0)](#5783980)[sbassett](/p/sbassett/) moved this task from [Other WMF team](/project/board/30/) to [Done](/project/board/30/) on the [acl\*security](/tag/acl_security/) board.[sbassett](/p/sbassett/) moved this task from [Watching](/project/board/1179/) to [Our Part Is Done](/project/board/1179/) on the [Security-Team](/tag/security-team/) board.[sbassett](/p/sbassett/) renamed this task from Exposed HTML in WikibaseMediaInfo autocomplete suggestions to Exposed HTML in WikibaseMediaInfo autocomplete suggestions (CVE-2020-6163).[Jan 8 2020, 6:18 PM2020-01-08 18:18:32 (UTC+0)](#5787163)[sbassett](/p/sbassett/) mentioned this in [T240400: Write and send supplementary release announcement for extensions and skins with security patches (MediaWiki 1.31.7/1.33.3/1.34.1)](/T240400).[Jan 8 2020, 6:29 PM2020-01-08 18:29:40 (UTC+0)](#5787249)[• chasemp](/p/chasemp/) added a project: [Security](/tag/security/).[Feb 10 2020, 10:56 PM2020-02-10 22:56:24 (UTC+0)](#5868873) · [• chasemp](/p/chasemp/) removed a project: [acl\*security](/tag/acl_security/).[Feb 20 2020, 8:16 PM2020-02-20 20:16:22 (UTC+0)](#5904384) · [sbassett](/p/sbassett/) added a parent task: [T240400: Write and send supplementary release announcement for extensions and skins with security patches (MediaWiki 1.31.7/1.33.3/1.34.1)](/T240400).[Mar 10 2020, 2:15 PM2020-03-10 14:15:28 (UTC+0)](#5956203)[Log In to Comment](/login/?next=)Content licensed under Creative Commons Attribution-ShareAlike (CC BY-SA) 4.0 unless otherwise noted; code licensed under GNU General Public License (GPL) 2.0 or later and other open source licenses. By using this site, you agree to the Terms of Use, Privacy Policy, and Code of Conduct. · [Wikimedia Foundation](https://wikimediafoundation.org/) · [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ANon-wiki_privacy_policy) · [Code of Conduct](https://www.mediawiki.org/wiki/Special%3AMyLanguage/Code_of_Conduct) · [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use/Phabricator) · [Disclaimer](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AGeneral_disclaimer) · [CC-BY-SA](https://creativecommons.org/licenses/by-sa/4.0/) · [GPL](https://www.gnu.org/licenses/old-licenses/gpl-2.0.html) · [Credits](https://www.mediawiki.org/wiki/Phabricator/Credits)

=== Content from gerrit.wikimedia.org_ce47b6c8_20250119_112558.html ===



