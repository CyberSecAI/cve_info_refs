```json
{
  "cve": "CVE-2020-6131",
  "source": "talosintelligence.com_19a60fd4_20250119_124743.html",
  "summary": "The `coure_period_id` parameter in the page `MassScheduleSessionSet.php` is vulnerable to SQL injection. A specially crafted HTTP request can lead to SQL injection. An attacker can make an authenticated HTTP request to trigger these vulnerabilities.",
  "details": [
    {
      "weakness": "SQL Injection (CWE-89)",
      "attack_vector": "HTTP request",
      "vulnerable_code": "Lines 37 and 38 in `MassScheduleSessionSet.php`:\n```\n34     if($_REQUEST['course_period_id'])\n35     {\n36     $_SESSION['MassSchedule.php']['course_period_id']=$_REQUEST['course_period_id'];\n37     $gender_res = DBGet(DBQuery('SELECT GENDER_RESTRICTION FROM course_periods WHERE COURSE_PERIOD_ID='.$_REQUEST['course_period_id']));\n38     $marking_period= DBGet(DBQuery('SELECT MARKING_PERIOD_ID FROM course_periods WHERE COURSE_PERIOD_ID='.$_REQUEST['course_period_id']));\n39     if($marking_period[1]['MARKING_PERIOD_ID']==''){\n40         $get_syear_mpid=DBGet(DBQuery('SELECT MARKING_PERIOD_ID FROM school_years WHERE SCHOOL_ID='.UserSchool().' AND SYEAR='.UserSyear()));\n41         $marking_period=$get_syear_mpid;\n42     }\n43     $get_mp_det=DBGet(DBQuery('SELECT * FROM marking_periods WHERE MARKING_PERIOD_ID='.$marking_period[1]['MARKING_PERIOD_ID']));\n44\n45     $_SESSION['MassSchedule.php']['gender'] = $gender_res[1]['GENDER_RESTRICTION'];\n46 //        $_REQUEST['title'] = str_replace('\"', '\\\"', $_REQUEST['title']);\n47         if ($gender_res[1]['GENDER_RESTRICTION'] != 'N')\n48         $_REQUEST['title']=$_REQUEST['title'].' - Gender : '.($gender_res == 'M' ? 'Male' : 'Female');\n49     }\n50     if($_REQUEST['course_id'])\n51     $_SESSION['MassSchedule.php']['course_id']=$_REQUEST['course_id'];\n52     if($_REQUEST['subject_id'])\n53     $_SESSION['MassSchedule.php']['subject_id']=$_REQUEST['subject_id'];\n```",
      "request_example": "GET /opensis/MassScheduleSessionSet.php?course_period_id=1[SQLINJECTION]&title=1 HTTP/1.1\r\nHost: [IP]\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\nAccept-Language: en-GB,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 0\r\nOrigin: http://[IP]\r\nDNT: 1\r\nConnection: close\r\nReferer: http://[IP]/opensis/Modules.php?modname=eligibility/Student.php&modfunc=add&start_date=\r\nCookie: miniSidebar=0; PHPSESSID=6chg16qcanbg3adrqlq6sm6fa3\r\nUpgrade-Insecure-Requests: 1",
      "affected_parameter": "course_period_id",
      "authentication": "The attacker needs to be authenticated."
    }
  ]
}
```