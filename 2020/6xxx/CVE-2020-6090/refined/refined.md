- **Root cause of vulnerability**: The web-based management (WBM) application of the WAGO PFC 200 allows a web admin user to upload and activate software packages in the opkg `.ipk` format. The `opkg` utility is executed with root privileges when activating these packages, without proper integrity checks or code signing. This allows execution of arbitrary code within the scripts of the package (`control` portion), or overwrite system services with malicious code.
- **Weaknesses/vulnerabilities present**:
  - Improper privilege management: The `opkg` utility, which is responsible for installing and activating software packages, is executed with root privileges by the WBM application.
  - Lack of integrity checks: The uploaded `.ipk` packages lack integrity checks such as code signing. This allows an attacker to inject malicious code into the package.
  - Unrestricted file overwrite: The "force" activation option allows an attacker to overwrite system services, leading to potential privilege escalation and control of the device.
- **Impact of exploitation**: Successful exploitation of this vulnerability allows an attacker to gain root privileges on the device and execute arbitrary code. It also allows overwriting system files which would enable persistent access and control over the WAGO PFC 200.
- **Attack vectors**: The attack vector is via crafted HTTP requests to the web-based management interface, specifically using the software upload functionality.
- **Required attacker capabilities/position**: The attacker needs to have the credentials for the WBM admin user, which allows them to upload and activate software packages.