- **Root cause of vulnerability**: An integer overflow in the `decode_int` function when parsing the length of an integer within an SNMP packet. Specifically, the check at `[1]` is vulnerable to integer wraparound when `len` is larger than `size`. This leads to an out-of-bounds read in the while loop at `[2]` when accessing `packet[*pos]`.
- **Weaknesses/vulnerabilities present**:
  - Integer overflow leading to out-of-bounds read.
  - Inadequate input validation in the SNMP packet parser, allowing the `len` field to exceed the packet size.
- **Impact of exploitation**:
  - Information Leak: By sending multiple packets with variable sizes, an attacker can read arbitrary amounts of memory 4 bytes at a time.
  - Denial of Service: Accessing out-of-bounds memory at a large offset can lead to an access violation and immediate crash.
- **Attack vectors**:
  - Sending a specially crafted SNMP packet with an invalid length for the request ID field. The length field will be used as `len` value in the `decode_int` function.
- **Required attacker capabilities/position**:
  - The attacker needs to be able to send SNMP packets to the vulnerable server.