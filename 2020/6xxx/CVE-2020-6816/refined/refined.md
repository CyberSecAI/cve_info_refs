```
{
  "CVE-2020-6816": [
    {
      "Root cause of vulnerability": "The vulnerability arises from inconsistent parsing of HTML content within the `svg` or `math` tags when combined with RCDATA tags and the `strip=False` option in the `bleach.clean` function. The `html5lib` parser, used by Bleach, interprets content inside `svg` and `math` tags as XML, leading to different parsing behavior compared to regular HTML content. Specifically, the parser does not properly sanitize tags within the scope of svg/math.",
      "Weaknesses/vulnerabilities present": "Mutation Cross-Site Scripting (mXSS) due to improper handling of nested tags within svg/math and RCDATA tags. When `strip=False` is used, unlisted tags that should have been sanitized are not, leading to the potential for XSS attacks.",
      "Impact of exploitation": "An attacker can inject arbitrary JavaScript code by exploiting the parsing differences between the browser and Bleach, leading to potential data theft, session hijacking, or other malicious activities on the user's browser.",
      "Attack vectors": "An attacker can inject a malicious payload, which includes svg or math tags along with RCDATA tags, into a web application using the Bleach library to sanitize user-provided HTML. The payload bypasses the sanitizer and is then executed by the browser. This can be done through stored XSS or reflected XSS.",
      "Required attacker capabilities/position": "The attacker needs to have the ability to submit HTML content that includes svg or math tags, and at least one of the RCDATA tags (script, noscript, style, noframes, xmp, noembed, iframe). Additionally the web application must call the bleach.clean with strip set to False, and allow svg or math tags along with one or more of the mentioned RCDATA tags."
    },
    {
      "Root cause of vulnerability": "This vulnerability is a type of Mutation Cross-Site Scripting (mXSS) that occurs due to inconsistent parsing of HTML between the browser and the Bleach library. Specifically, when  `svg` or `math` tags are whitelisted, along with an RCDATA tag, with `strip=False`, and when a style tag is nested within an svg/math tag, the content inside it is treated as XML instead of text. This allows an attacker to bypass Bleach's sanitization.",
      "Weaknesses/vulnerabilities present": "The vulnerability lies in the way Bleach sanitizes content within svg and math tags. When strip=False is used, Bleach fails to properly sanitize tags nested within svg or math tags' style elements. This allows injection of arbitrary HTML/XML and JavaScript, since tags nested inside style tags in svg/math scope pop out.",
      "Impact of exploitation": "An attacker can execute arbitrary JavaScript code by exploiting this parsing discrepancy, potentially leading to data theft, session hijacking, or other malicious activities. Because bleach is intended to sanitize HTML, this is a significant vulnerability in applications that rely on it.",
      "Attack vectors": "The attacker crafts a payload including svg or math tags, and at least one of the following RCDATA tags: script, noscript, style, noframes, xmp, noembed, iframe. This payload is injected into an application that uses bleach.clean to sanitize user input, but with strip set to False. Because bleach does not sanitize tags nested within style tags in svg/math scope, these tags pop out and execute.  ",
      "Required attacker capabilities/position": "The attacker needs to be able to inject HTML content containing specially crafted svg or math tags combined with RCDATA tags in an application that uses bleach with a configuration that whitelists both and has `strip=False`."
    }
  ]
}
```