```
[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source:
<http://hyp3rlinx.altervista.org/advisories/NEOWISE-CARBONFTP-v1.4-INSECURE-PROPRIETARY-PASSWORD-ENCRYPTION.txt>
[+] twitter.com/hyp3rlinx
[+] ISR: ApparitionSec

[Vendor]
www.neowise.com

[Product]
CarbonFTP v1.4

[Vulnerability Type]
Insecure Proprietary Password Encryption

[CVE Reference]
CVE-2020-6857

[Affected Component]
Password Encryption

[Impact Escalation of Privileges]
true

[Impact Information Disclosure]
true

[Security Issue]
CarbonFTP v1.4 uses insecure proprietary password encryption with a hard-coded weak encryption key.
The key for locally stored FTP server passwords is hard-coded in the binary. Passwords encoded as hex
are converted to decimal which is then computed by adding the key "97F" (hex) or 2431 (decimal) to the result. The key 97F seems
to be the same for all executables across all systems. Finally, passwords are stored as decimal values.

If a user chooses to save the project the passwords are stored in ".CFTP" local configuration files under
"C:\Users\<VICTIM>\AppData\Roaming\Neowise\CarbonFTPProjects".

Password encryption/decryption is as follows:
- The plaintext password characters are converted to their hexadecimal representation.
- The hexadecimal is converted to decimal.
- The hardcoded encryption key "97F" (hex) or 2431 (decimal) is added to the decimal representation.
- The result is stored as a decimal string.

Decryption is performed by reversing the process:
- The encrypted decimal value is read from the config file.
- The hardcoded key "97F" (2431 in decimal) is subtracted from the encrypted decimal string.
- The result is converted to hex.
- The hex representation is converted to ASCII to retrieve the plaintext password.

CarbonFTP passwords less than nine characters are padded using characters from the current password up until
reaching a password length of nine bytes.

[Exploit/POC]
A python script "CarbonFTPExploit.py" is provided which can decrypt CarbonFTP config files, by reversing the algorithm described.

[Network Access]
Local

[Severity]
High

[Disclosure Timeline]
Vendor Notification: Website contact form not working, several attempts : January 12, 2020
CVE Assigned by mitre : January 13, 2020
January 20, 2020 : Public Disclosure
```