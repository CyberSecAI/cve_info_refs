=== Content from bugzilla.mozilla.org_fc95ad4f_20250119_135530.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1610426)
* [XML](/show_bug.cgi?ctype=xml&id=1610426)

Closed
[Bug 1610426](/show_bug.cgi?id=1610426)
(CVE-2020-6796)

Opened 5 years ago
Closed 5 years ago

# No validation of array index (key) in xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes leads to Stack Out-Of-Bounds write in the broker process (Sandbox Escape / LPE)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

No validation of array index (key) in xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes leads to Stack Out-Of-Bounds write in the broker process (Sandbox Escape / LPE)

## Categories

### (Toolkit :: Crash Reporting, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Crash%20Reporting#Crash%20Reporting)

Crash Reporting
▾

Toolkit :: Crash Reporting
Breakpad crash reporting library - exception handler and crash report sender application.
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Crash%20Reporting&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Crash%20Reporting&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Crash%20Reporting)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla74

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) |
| firefox72 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix) |
| firefox73 | [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed) |
| firefox74 | [+](/buglist.cgi?f1=cf_tracking_firefox74&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr68 | 73+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox72 |  | wontfix |
| firefox73 | + | fixed |
| firefox74 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: mastho64, Assigned: gsvelto)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/03fda82227c39197ab49cd9cef4e3e89?d=mm&size=40)  [gsvelto](/user_profile?user_id=448747)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/4fa429d0f93952673648595ade8a16f5?d=mm&size=40)  [mastho64](/user_profile?user_id=636829)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/03fda82227c39197ab49cd9cef4e3e89?d=mm&size=40)  [gsvelto](/user_profile?user_id=448747)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (5 keywords, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main73+] [adv-esr68.5+][post-critsmash-triage])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-6796

[Keywords:](/describekeywords.cgi)

[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main73+] [adv-esr68.5+][post-critsmash-triage]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1167532_1689 "5 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [bmaris](/user_profile?user_id=458188) | [qe-verify](#a886586_458188 "5 years ago") | + |
| --- | --- | --- |
| [bmaris](/user_profile?user_id=458188) | qe-verify | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [stackoobw.zip](/attachment.cgi?id=9121969)  [5 years ago](#c0)  [Thomas Imbert](/user_profile?user_id=636829)   3.69 KB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9121969&action=edit) |
| --- | --- | --- |
| [Bug 1610426 - Discard unknown crash annotations r=froydnj](/attachment.cgi?id=9122027)  [5 years ago](#c3)  [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c19 "5 years ago")  RyanVM : [approval-mozilla-esr68+](#c19 "5 years ago")  tjr : [sec-approval+](#c11 "5 years ago") | [Details](/attachment.cgi?id=9122027&action=edit) | [Review](/attachment.cgi?id=9122027) |
| [advisory.txt](/attachment.cgi?id=9123324)  [5 years ago](#c23)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   293 bytes, text/plain |  | [Details](/attachment.cgi?id=9123324&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Thomas Imbert](/user_profile?user_id=636829)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1610426#c0)• 5 years ago |
|  | |

Attached file
[stackoobw.zip](attachment.cgi?id=9121969)
— [Details](attachment.cgi?id=9121969&action=edit)

Hi,

# Vulnerability

Memory corruption (Sandbox escape) in mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes tested on Firefox 72.0.2.7321

The vulnerability is in the following function:

```
// https://github.com/mozilla/gecko-dev/blob/master/ipc/glue/CrashReporterMetadataShmem.cpp#L210
typedef mozilla::EnumeratedArray<Annotation, Annotation::Count, nsCString> AnnotationTable;
void CrashReporterMetadataShmem::ReadAppNotes(const Shmem& aShmem,
                                              AnnotationTable& aNotes) {
  for (MetadataShmemReader reader(aShmem); !reader.Done(); reader.Next()) {
    switch (reader.Type()) {
      case EntryType::Annotation: {
        Annotation key; // no sanitization of key (uint32_t)
        nsCString value;
        if (!reader.Read(&key) || !reader.Read(value)) {
          return;
        }
        // Stack OOB write due to key (neither EnumeratedArray[] or Array[] have bounds check in release build)
        aNotes[key] = value; // EnumeratedArray (fixed length) stored in stack of mozilla::ipc::CrashReporterHost::FinalizeCrashReport
        break;
      }
      default:
        NS_ASSERTION(false, "Unknown metadata entry type");
        break;
    }
  }
}

```

The *key* variable comes from the shared memory (ShMem) without any validation and it is used as array index for storing the value string. A malicious content process (sandboxed) can modify its *CrashReporterClient* shared memory, crash itself to trigger the vulnerable code path in the broker process (not sandboxed) and achieve code execution outside the sandbox.

# Repro and Crash

To reproduce, install Python 2.7 64 bits and PythonForWindows (<https://github.com/hakril/PythonForWindows>), compile **payload\_corrupt.cc** (change offset in *GetShMem* if running different version then nmake) then run inject.py with the payload\_corrupt.dll path.

The POC (provided - see attached files) sets the *key* to 0xfffffff of the first annotation and crash the content process (NULL deref).

The broker process will crash when trying to read the annotation of the crashed child:

```
xul!nsTSubstring<char>::Assign+0x41:
00007ff9`c3bb1041 0fb7460c        movzx   eax,word ptr [rsi+0Ch] ds:00000085`32ffe164=????

this = 0x00000085`32ffe158 (nsTSubstring<char>::Assign)
00000084`32ffe168 class mozilla::EnumeratedArray<CrashReporter::Annotation,CrashReporter::Annotation::Count,nsTString<char> > annotations (CrashReporterHost::FinalizeCrashReport)
? 0xfffffff * 0x10 + 0x8432ffe168 + c
Evaluate expression: 572086280548 = 00000085`32ffe164

0:000> kc
 # Call Site
00 xul!nsTSubstring<char>::Assign
01 xul!nsTSubstring<char>::Assign
02 xul!nsTString<char>::operator=
03 xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes
04 xul!mozilla::ipc::CrashReporterHost::FinalizeCrashReport
05 xul!mozilla::ipc::CrashReporterHost::GenerateCrashReport
06 xul!mozilla::dom::ContentParent::ActorDestroy
07 xul!mozilla::ipc::IProtocol::DestroySubtree
08 xul!mozilla::dom::PContentParent::OnChannelError
09 xul!mozilla::dom::ContentParent::OnChannelError
0a xul!mozilla::detail::RunnableMethodArguments<>::applyImpl
0b xul!mozilla::detail::RunnableMethodArguments<>::apply
0c xul!mozilla::detail::RunnableMethodImpl<mozilla::ipc::MessageChannel *,void (mozilla::ipc::MessageChannel::*)(),0,mozilla::RunnableKind::Cancelable>::Run
0d xul!nsThread::ProcessNextEvent
0e xul!NS_ProcessNextEvent
0f xul!mozilla::ipc::MessagePump::Run
10 xul!MessageLoop::RunInternal
11 xul!MessageLoop::RunHandler
12 xul!MessageLoop::Run
13 xul!nsBaseAppShell::Run
14 xul!nsAppShell::Run
15 xul!nsAppStartup::Run
16 xul!XREMain::XRE_mainRun
17 xul!XREMain::XRE_main
18 xul!XRE_main

```
# Exploitation

The exploitation assumes having code execution in sandboxed renderers processes (RCE -> LPE step targeted).

By modifying the *key* (array index), we can replace objects stored in the stack frame of caller functions.

On Firefox version 72.0.2.7321 on Windows 10 x86-64, some offsets are very interesting for exploitation:

```
xul!nsCOMPtr_base::~nsCOMPtr_base+0xb5d [inlined in xul!nsThread::ProcessNextEvent+0x14d8]:
00007ff9`c3beab08 ff5010          call    qword ptr [rax+10h] ds:41414141`41414151=???????????????? // rax controlled via the string value
0:000> kc
 # Call Site
00 xul!nsCOMPtr_base::~nsCOMPtr_base
01 xul!mozilla::dom::ScriptSettingsStackEntry::~ScriptSettingsStackEntry
02 xul!mozilla::dom::AutoNoJSAPI::~AutoNoJSAPI
03 xul!mozilla::Maybe<mozilla::dom::AutoNoJSAPI>::reset
04 xul!nsThread::ProcessNextEvent
05 xul!NS_ProcessNextEvent

```

Definitily with some work, it is possible to achieve code execution in Firefox main process (Sandbox escape).

Thank you

Flags: sec-bounty?

|  | [Johann Hofmann [:johannh]](/user_profile?user_id=522029) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1610426#c1)• 5 years ago |
|  | |

Jed, are you the right person to take a look at this bug?

Group: firefox-core-security → core-securityType: task → defectComponent: Security → IPCFlags: needinfo?(jld)Product: Firefox → Core

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1610426#c2)• 5 years ago |
|  | |

Confirmed, I'll fix it this afternoon.

Status: UNCONFIRMED → NEWEver confirmed: true

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1610426#a27590_75935)• 5 years ago |

Assignee: nobody → gsveltoGroup: core-security → dom-core-security
[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix)
[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=affected)
[status-firefox74](/buglist.cgi?f1=cf_status_firefox74&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=affected)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=%3F)
[tracking-firefox73](/buglist.cgi?f1=cf_tracking_firefox73&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B)
[tracking-firefox74](/buglist.cgi?f1=cf_tracking_firefox74&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox74&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F)

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1610426#c3)• 5 years ago |
|  | |

Attached file
[Bug 1610426 - Discard unknown crash annotations r=froydnj](attachment.cgi?id=9122027)
— [Details](attachment.cgi?id=9122027&action=edit)

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1610426#c4)• 5 years ago |
|  | |

CC'ing Nathan for the review.

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1610426#a28024_448747)• 5 years ago |

Status: NEW → ASSIGNED

|  | [Jed Davis [:jld] ⟨⏰|UTC-8⟩ ⟦he/him⟧](/user_profile?user_id=462836) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1610426#a39297_462836)• 5 years ago |

Flags: needinfo?(jld)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1610426#c5)• 5 years ago |
|  | |

Could we add runtime checking to mozilla::Array<>?

I guess this is a little mitigated at least on 64 bit systems by the fact that the index is 32 bit, but writing arbitrary values to arbitrary offsets within that range sounds bad.

Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1610426#c6)• 5 years ago |
|  | |

It looks like this might be a regression from [bug 1348273](/show_bug.cgi?id=1348273 "RESOLVED FIXED - Make AnnotateCrashReport() more robust by turning annotations into a well known list of constants"), which landed in 63. I didn't look too closely, but it looked like it was some kind of hash map before that.

|  | [Nathan Froyd [:froydnj]](/user_profile?user_id=417288) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1610426#c7)• 5 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #5](/show_bug.cgi?id=1610426#c5 "RESOLVED FIXED - No validation of array index (key) in xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes leads to Stack Out-Of-Bounds write in the broker process (Sandbox Escape / LPE)"))

> Could we add runtime checking to mozilla::Array<>?
>
> I guess this is a little mitigated at least on 64 bit systems by the fact that the index is 32 bit, but writing arbitrary values to arbitrary offsets within that range sounds bad.

We should at least add it to `EnumeratedArray`, because people will assume their enums are always in bounds. Adding it to `Array` might be a little harder, as I think `Array` gets used in some perf-critical code like dom bindings. But maybe we can add an `IfYouReallyKnowWhatYouAreDoing` template parameter or something.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1610426#a76329_75935)• 5 years ago |

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=%3F) → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F) → [73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B)

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1610426#c8)• 5 years ago |
|  | |

Yes, previously it was a hash table and everything used strings instead of an enum. The plan calls for this code to be rewritten and moved out of Gecko this year (see [bug 1588530](/show_bug.cgi?id=1588530 "NEW - [meta] Crash reporting Rust rewrite")) so that we don't need this complex IPC dance between the crashed content process and the main process.

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1610426#c9)• 5 years ago |
|  | |

Comment on [attachment 9122027](/attachment.cgi?id=9122027 "Bug 1610426 - Discard unknown crash annotations r=froydnj") [[details]](/attachment.cgi?id=9122027&action=edit "Bug 1610426 - Discard unknown crash annotations r=froydnj")

[Bug 1610426](/show_bug.cgi?id=1610426 "RESOLVED FIXED - No validation of array index (key) in xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes leads to Stack Out-Of-Bounds write in the broker process (Sandbox Escape / LPE)") - Discard unknown crash annotations r=froydnj

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: An example is provided in the bug.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: 68esr
* **If not all supported branches, which bug introduced the flaw?**: [Bug 1348273](/show_bug.cgi?id=1348273 "RESOLVED FIXED - Make AnnotateCrashReport() more robust by turning annotations into a well known list of constants")
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: The patch introduces a trivial check so should be risk-free
[Attachment #9122027](/attachment.cgi?id=9122027&action=edit "Bug 1610426 - Discard unknown crash annotations r=froydnj") -
Flags: sec-approval?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1610426#a123436_406194)• 5 years ago |

Group: dom-core-security → firefox-core-securityComponent: IPC → Crash ReportingProduct: Core → Toolkit

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1610426#c10)• 5 years ago |
|  | |

(In reply to Gabriele Svelto [:gsvelto] from [comment #9](/show_bug.cgi?id=1610426#c9 "RESOLVED FIXED - No validation of array index (key) in xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes leads to Stack Out-Of-Bounds write in the broker process (Sandbox Escape / LPE)"))

> * **How easily could an exploit be constructed based on the patch?**: An example is provided in the bug.

That's not quite answering the question. The patch makes it clear what the issue is, as it adds a bounds check to a write to a crash reporter array.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1610426#c11)• 5 years ago |
|  | |

Comment on [attachment 9122027](/attachment.cgi?id=9122027 "Bug 1610426 - Discard unknown crash annotations r=froydnj") [[details]](/attachment.cgi?id=9122027&action=edit "Bug 1610426 - Discard unknown crash annotations r=froydnj")

[Bug 1610426](/show_bug.cgi?id=1610426 "RESOLVED FIXED - No validation of array index (key) in xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes leads to Stack Out-Of-Bounds write in the broker process (Sandbox Escape / LPE)") - Discard unknown crash annotations r=froydnj

Approved to land and request uplift.

[Attachment #9122027](/attachment.cgi?id=9122027&action=edit "Bug 1610426 - Discard unknown crash annotations r=froydnj") -
Flags: sec-approval? → sec-approval+

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1610426#c12)• 5 years ago |
|  | |

(In reply to Andrew McCreight [:mccr8] from [comment #10](/show_bug.cgi?id=1610426#c10 "RESOLVED FIXED - No validation of array index (key) in xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes leads to Stack Out-Of-Bounds write in the broker process (Sandbox Escape / LPE)"))

> (In reply to Gabriele Svelto [:gsvelto] from [comment #9](/show_bug.cgi?id=1610426#c9 "RESOLVED FIXED - No validation of array index (key) in xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes leads to Stack Out-Of-Bounds write in the broker process (Sandbox Escape / LPE)"))
>
> > * **How easily could an exploit be constructed based on the patch?**: An example is provided in the bug.
>
> That's not quite answering the question. The patch makes it clear what the issue is, as it adds a bounds check to a write to a crash reporter array.

I apologize, my brain stopped processing the question at "How easily could an exploit be constructed" and somehow skipped the "based on the patch" part. While it's not obvious that you need to crash a content process first it's pretty easy to tell what you can do with it.

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1610426#c13)• 5 years ago |
|  | |

Landed: <https://hg.mozilla.org/integration/autoland/rev/b315803378d515c12f42162332d389f3942b51fc>

I hope to have adjusted the flags accordingly. I'll request update for ESR and beta.

Status: ASSIGNED → RESOLVEDClosed: 5 years ago
[status-firefox74](/buglist.cgi?f1=cf_status_firefox74&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1610426#c14)• 5 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/b315803378d5>

Group: firefox-core-security → core-security-releaseTarget Milestone: --- → mozilla74

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1610426#c15)• 5 years ago |
|  | |

I haven't requested the uplifts yet because I'm verifying the fix in nightly first.

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1610426#c16)• 5 years ago |
|  | |

I tried verifying the fix but after modifying the exploit code to build (and adjusting the offsets) I can't get the injection script to work.

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1610426#c17)• 5 years ago |
|  | |

Comment on [attachment 9122027](/attachment.cgi?id=9122027 "Bug 1610426 - Discard unknown crash annotations r=froydnj") [[details]](/attachment.cgi?id=9122027&action=edit "Bug 1610426 - Discard unknown crash annotations r=froydnj")

[Bug 1610426](/show_bug.cgi?id=1610426 "RESOLVED FIXED - No validation of array index (key) in xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes leads to Stack Out-Of-Bounds write in the broker process (Sandbox Escape / LPE)") - Discard unknown crash annotations r=froydnj

### Beta/Release Uplift Approval Request

* **User impact if declined**: This is a significant security issue even though it would need at least another exploit to be used
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The patch only adds a bounds check to prevent the out-of-bounds access
* **String changes made/needed**: none
[Attachment #9122027](/attachment.cgi?id=9122027&action=edit "Bug 1610426 - Discard unknown crash annotations r=froydnj") -
Flags: approval-mozilla-beta?

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1610426#c18)• 5 years ago |
|  | |

Comment on [attachment 9122027](/attachment.cgi?id=9122027 "Bug 1610426 - Discard unknown crash annotations r=froydnj") [[details]](/attachment.cgi?id=9122027&action=edit "Bug 1610426 - Discard unknown crash annotations r=froydnj")

[Bug 1610426](/show_bug.cgi?id=1610426 "RESOLVED FIXED - No validation of array index (key) in xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes leads to Stack Out-Of-Bounds write in the broker process (Sandbox Escape / LPE)") - Discard unknown crash annotations r=froydnj

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec:high bug
* **User impact if declined**: This is a significant security issue even though it would need at least another exploit to be used
* **Fix Landed on Version**: 74
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: The patch only adds a bounds check to prevent the out-of-bounds access
* **String or UUID changes made by this patch**: none
[Attachment #9122027](/attachment.cgi?id=9122027&action=edit "Bug 1610426 - Discard unknown crash annotations r=froydnj") -
Flags: approval-mozilla-esr68?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1610426#c19)• 5 years ago |
|  | |

Comment on [attachment 9122027](/attachment.cgi?id=9122027 "Bug 1610426 - Discard unknown crash annotations r=froydnj") [[details]](/attachment.cgi?id=9122027&action=edit "Bug 1610426 - Discard unknown crash annotations r=froydnj")

[Bug 1610426](/show_bug.cgi?id=1610426 "RESOLVED FIXED - No validation of array index (key) in xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes leads to Stack Out-Of-Bounds write in the broker process (Sandbox Escape / LPE)") - Discard unknown crash annotations r=froydnj

Avoids a possible out-of-bounds access. Approved for 73.0b9 and 68.5esr.

[Attachment #9122027](/attachment.cgi?id=9122027&action=edit "Bug 1610426 - Discard unknown crash annotations r=froydnj") -
Flags: approval-mozilla-esr68?
[Attachment #9122027](/attachment.cgi?id=9122027&action=edit "Bug 1610426 - Discard unknown crash annotations r=froydnj") -
Flags: approval-mozilla-esr68+
[Attachment #9122027](/attachment.cgi?id=9122027&action=edit "Bug 1610426 - Discard unknown crash annotations r=froydnj") -
Flags: approval-mozilla-beta?
[Attachment #9122027](/attachment.cgi?id=9122027&action=edit "Bug 1610426 - Discard unknown crash annotations r=froydnj") -
Flags: approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1610426#c20)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr68/rev/910a7b4b5f2e>

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1610426#c21)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/8f3b8fef5686>

[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed)

|  | [Thomas Imbert](/user_profile?user_id=636829)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1610426#c22)• 5 years ago |
|  | |

(In reply to Gabriele Svelto [:gsvelto] from [comment #16](/show_bug.cgi?id=1610426#c16 "RESOLVED FIXED - No validation of array index (key) in xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes leads to Stack Out-Of-Bounds write in the broker process (Sandbox Escape / LPE)"))

> I tried verifying the fix but after modifying the exploit code to build (and adjusting the offsets) I can't get the injection script to work.

Please can you check the ACL on the payload\_corrupt DLL? Please add Everyone Read and Read & Execute, the renderer process may not have access to the dll file.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1610426#a635830_578488)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main73+] [adv-esr68.5+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1610426#c23)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9123324)
— [Details](attachment.cgi?id=9123324&action=edit)

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1610426#a886586_458188)• 5 years ago |

Flags: qe-verify+Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main73+] [adv-esr68.5+] → [reporter-external] [client-bounty-form] [verif?][adv-main73+] [adv-esr68.5+][postcritsmash-triage]

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1610426#a886755_458188)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main73+] [adv-esr68.5+][postcritsmash-triage] → [reporter-external] [client-bounty-form] [verif?][adv-main73+] [adv-esr68.5+][post-critsmash-triage]

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1610426#a1132418_458188)• 5 years ago |

QA Whiteboard: [qa-triaged]

|  | [Emil Ghitta, QA [:emilghitta]](/user_profile?user_id=588744) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1610426#c24)• 5 years ago |
|  | |

Hi Thomas!

It seems that I'm unable to inject the script in order to verify if this issue was fixed or not.

Can you please help us by verifying (using the fixed Fx versions) if this issue is fixed on your side?

Thank you!

QA Whiteboard: [qa-triaged]Flags: needinfo?(mastho64)

|  | [Emil Ghitta, QA [:emilghitta]](/user_profile?user_id=588744) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1610426#a1137201_588744)• 5 years ago |

QA Whiteboard: [qa-triaged]

|  | [Thomas Imbert](/user_profile?user_id=636829)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1610426#c25)• 5 years ago |
|  | |

(In reply to Emil Ghitta, QA [:emilghitta] from [comment #24](/show_bug.cgi?id=1610426#c24 "RESOLVED FIXED - No validation of array index (key) in xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes leads to Stack Out-Of-Bounds write in the broker process (Sandbox Escape / LPE)"))

> Hi Thomas!
>
> It seems that I'm unable to inject the script in order to verify if this issue was fixed or not.
>
> Can you please help us by verifying (using the fixed Fx versions) if this issue is fixed on your side?
>
> Thank you!

Hi,

Where can I download the fixed version?

Thomas

Flags: needinfo?(mastho64)

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1610426#c26)• 5 years ago |
|  | |

The latest nightly should have the fix: <https://www.mozilla.org/it/firefox/channel/desktop/>

|  | [Thomas Imbert](/user_profile?user_id=636829)  Reporter |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1610426#c27)• 5 years ago |
|  | |

Thank you,

Steps:

* Download nightly from <https://www.mozilla.org/en-US/firefox/channel/desktop/> (version 74.0a1 (2020-02-02) (64-bit))
* Download symbols of xul version 74.0a1 and find offset of xul!sClientSingleton symbol
* Change offset in payload\_corrupt.cc (new offset 0x05905710)
* Open Visual Studio shell and nmake the POC
* icacls bin\payload\_corrupt.dll /grant Everyone:RX
* Attach debugger to the broker (firefox.exe)
* Install python 2.7 and PythonForWindows (github) and run inject.py
* No crash in xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes

Actually, a bit later there is an exception (Invalid handle - code c0000008) in CrashReporter::PlatformWriter::~PlatformWriter (not a security issue and the exception is handled).

```
Debugging notes:

xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes+0xd4:
00007ff9`b8512694 81fe99000000    cmp     esi,99h // rsi=000000000fffffff the OOB index now checked against 0x99 (Annotation::Count)
0:000> t
xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes+0xda:
00007ff9`b851269a 7777            ja      xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes+0x153 (00007ff9`b8512713) [br=1] // branch to return

```

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1610426#c28)• 5 years ago |
|  | |

(In reply to Thomas Imbert from [comment #27](/show_bug.cgi?id=1610426#c27 "RESOLVED FIXED - No validation of array index (key) in xul!mozilla::ipc::CrashReporterMetadataShmem::ReadAppNotes leads to Stack Out-Of-Bounds write in the broker process (Sandbox Escape / LPE)"))

> Actually, a bit later there is an exception (Invalid handle - code c0000008) in CrashReporter::PlatformWriter::~PlatformWriter (not a security issue and the exception is handled).

Thank you. I know why that's happening, I'll file a separate issue for that.

|  | [Gabriele Svelto [:gsvelto]](/user_profile?user_id=448747)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1610426#c29)• 5 years ago |
|  | |

Filed [bug 1612899](/show_bug.cgi?id=1612899 "RESOLVED FIXED - Don't double-close the platform-writer file handle"), it's a trivial fix.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1610426#a1167532_1689)• 5 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1610426#a1761857_578488)• 5 years ago |

Alias: CVE-2020-6796

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1610426#a11755752_1689)• 5 years ago |

Group: core-security-release

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1610426#a55175673_578488)• 3 years ago |

Keywords: [csectype-sandbox-escape](/buglist.cgi?keywords=csectype-sandbox-escape&resolution=---)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1610426#a137502318_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1610426&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Thomas Imbert](/user_profile?user_id=636829)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_ff0f8d89_20250119_121516.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-05

## Security Vulnerabilities fixed in Firefox 73

Announced
February 11, 2020
Impact
high
Products
Firefox
Fixed in

* Firefox 73

#### [#CVE-2020-6796: Missing bounds check on shared memory read in the parent process](#CVE-2020-6796)

Reporter
Thomas Imbert
Impact
high
##### Description

A content process could have modified shared memory relating to crash reporting information, crash itself, and cause an out-of-bound write. This could have caused memory corruption and a potentially exploitable crash.

##### References

* [Bug 1610426](https://bugzilla.mozilla.org/show_bug.cgi?id=1610426)

#### [#CVE-2020-6797: Extensions granted downloads.open permission could open arbitrary applications on Mac OSX](#CVE-2020-6797)

Reporter
Vladimir Metnew
Impact
moderate
##### Description

By downloading a file with the .fileloc extension, a semi-privileged extension could launch an arbitrary application on the user's computer. The attacker is restricted as they are unable to download non-quarantined files or supply command line arguments to the application, limiting the impact.
*Note: this issue only occurs on Mac OSX. Other operating systems are unaffected.*

##### References

* [Bug 1596668](https://bugzilla.mozilla.org/show_bug.cgi?id=1596668)

#### [#CVE-2020-6798: Incorrect parsing of template tag could result in JavaScript injection](#CVE-2020-6798)

Reporter
terjanq
Impact
moderate
##### Description

If a `<template>` tag was used in a `<select%gt;` tag, the parser could be confused and allow JavaScript parsing and execution when it should not be allowed. A site that relied on the browser behaving correctly could suffer a cross-site scripting vulnerability as a result.

##### References

* [Bug 1602944](https://bugzilla.mozilla.org/show_bug.cgi?id=1602944)

#### [#CVE-2020-6799: Arbitrary code execution when opening pdf links from other applications, when Firefox is configured as default pdf reader](#CVE-2020-6799)

Reporter
Joshua Graham & Brendan Scarvell
Impact
moderate
##### Description

Command line arguments could have been injected during Firefox invocation as a shell handler for certain unsupported file types. This required Firefox to be configured as the default handler for a given file type and for a file downloaded to be opened in a third party application that insufficiently sanitized URL data. In that situation, clicking a link in the third party application could have been used to retrieve and execute files whose location was supplied through command line arguments.
*Note: This issue only affects Windows operating systems and when Firefox is configured as the default handler for non-default filetypes. Other operating systems are unaffected.*

##### References

* [Bug 1606596](https://bugzilla.mozilla.org/show_bug.cgi?id=1606596)

#### [#CVE-2020-6800: Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](#CVE-2020-6800)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Raul Gurzau, Tyson Smith, Bob Clary, Liz Henry, and Christian Holler reported memory safety bugs present in Firefox 72 and Firefox ESR 68.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777)

#### [#CVE-2020-6801: Memory safety bugs fixed in Firefox 73](#CVE-2020-6801)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Jason Kratzer, Tyson Smith, and Christian Holler reported memory safety bugs present in Firefox 72. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 73](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1601024%2C1601712%2C1604836%2C1606492)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_0c6a373f_20250119_121517.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-07

## Security Vulnerabilities fixed in Thunderbird 68.5

Announced
February 11, 2020
Impact
moderate
Products
Thunderbird
Fixed in

* Thunderbird 68.5

#### [#CVE-2020-6793: Out-of-bounds read when processing certain email messages](#CVE-2020-6793)

Reporter
Chiaki ISHIKAWA
Impact
moderate
##### Description

When processing an email message with an ill-formed envelope, Thunderbird could read data from a random memory location.

##### References

* [Bug 1608539](https://bugzilla.mozilla.org/show_bug.cgi?id=1608539)

#### [#CVE-2020-6794: Setting a master password post-Thunderbird 52 does not delete unencrypted previously stored passwords](#CVE-2020-6794)

Reporter
Jurgen Gaeremyn
Impact
moderate
##### Description

If a user saved passwords before Thunderbird 60 and then later set a master password, an unencrypted copy of these passwords is still accessible. This is because the older stored password file was not deleted when the data was copied to a new format starting in Thunderbird 60. The new master password is added only on the new file. This could allow the exposure of stored password data outside of user expectations.

##### References

* [Bug 1606619](https://bugzilla.mozilla.org/show_bug.cgi?id=1606619)

#### [#CVE-2020-6795: Crash processing S/MIME messages with multiple signatures](#CVE-2020-6795)

Reporter
Stephan Lauffer
Impact
moderate
##### Description

When processing a message that contains multiple S/MIME signatures, a bug in the MIME processing code caused a null pointer dereference, leading to an unexploitable crash.

##### References

* [Bug 1611105](https://bugzilla.mozilla.org/show_bug.cgi?id=1611105)

#### [#CVE-2020-6797: Extensions granted downloads.open permission could open arbitrary applications on Mac OSX](#CVE-2020-6797)

Reporter
Vladimir Metnew
Impact
moderate
##### Description

By downloading a file with the .fileloc extension, a semi-privileged extension could launch an arbitrary application on the user's computer. The attacker is restricted as they are unable to download non-quarantined files or supply command line arguments to the application, limiting the impact.
*Note: this issue only occurs on Mac OSX. Other operating systems are unaffected.*

##### References

* [Bug 1596668](https://bugzilla.mozilla.org/show_bug.cgi?id=1596668)

#### [#CVE-2020-6798: Incorrect parsing of template tag could result in JavaScript injection](#CVE-2020-6798)

Reporter
terjanq
Impact
moderate
##### Description

If a `<template>` tag was used in a `<select%gt;` tag, the parser could be confused and allow JavaScript parsing and execution when it should not be allowed. A site that relied on the browser behaving correctly could suffer a cross-site scripting vulnerability as a result.
*In general, this flaw cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but is potentially a risk in browser or browser-like contexts.*

##### References

* [Bug 1602944](https://bugzilla.mozilla.org/show_bug.cgi?id=1602944)

#### [#CVE-2020-6792: Message ID calculcation was based on uninitialized data](#CVE-2020-6792)

Reporter
Chiaki ISHIKAWA
Impact
low
##### Description

When deriving an identifier for an email message, uninitialized memory was used in addition to the message contents.

##### References

* [Bug 1609607](https://bugzilla.mozilla.org/show_bug.cgi?id=1609607)

#### [#CVE-2020-6800: Memory safety bugs fixed in Thunderbird 68.5](#CVE-2020-6800)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Raul Gurzau, Tyson Smith, Bob Clary, Liz Henry, and Christian Holler reported memory safety bugs present in Firefox 72 and Firefox ESR 68.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.
*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

##### References

* [Memory safety bugs fixed in Firefox 73, Firefox ESR 68.5, and Thunderbird 68.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_73f8d6fa_20250119_135531.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_09843fff_20250119_135527.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1611105)
* [XML](/show_bug.cgi?ctype=xml&id=1611105)

Closed
[Bug 1611105](/show_bug.cgi?id=1611105)
(CVE-2020-6795)

Opened 5 years ago
Closed 5 years ago

# TB crashes during opening s/mime signed mail from mailman mailinglist

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

TB crashes during opening s/mime signed mail from mailman mailinglist

## Categories

### (Thunderbird :: Security, defect)

[Product:](/describecomponents.cgi?product=Thunderbird)

Thunderbird
▾

Thunderbird
For bugs in MZLA's Thunderbird desktop mail client. Bugs in the back-end (e.g. protocols) should be filed in the [MailNews Core](https://bugzilla.mozilla.org/enter_bug.cgi?product=MailNews Core) product. Bugs in calendar should be filed in the [Calendar](https://bugzilla.mozilla.org/enter_bug.cgi?product=Calendar) product. Bugs for the chat features, file in the [Chat Core](https://bugzilla.mozilla.org/enter_bug.cgi?product=Chat%20Core) product.
[See Open Bugs in This Product](/buglist.cgi?product=Thunderbird&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Thunderbird)
Watch This Product

[Component:](/describecomponents.cgi?product=Thunderbird&component=Security#Security)

Security
▾

Thunderbird :: Security
For app-level security bugs.

If the problem relates to underlying components (PSM, NSS, Core, Toolkit) then please file it in the appropriate product instead of here.

[See Open Bugs in This Component](/buglist.cgi?product=Thunderbird&component=Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Thunderbird&component=Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Thunderbird&component=Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

68

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### (thunderbird\_esr68+ fixed, thunderbird73+ fixed, thunderbird74 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Thunderbird 74.0

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| thunderbird\_esr68 | [+](/buglist.cgi?f1=cf_tracking_thunderbird_esr68&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr68&o1=equals&v1=fixed) |
| thunderbird73 | [+](/buglist.cgi?f1=cf_tracking_thunderbird_73&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_thunderbird_73&o1=equals&v1=fixed) |
| thunderbird74 | --- | [fixed](/buglist.cgi?f1=cf_status_thunderbird_74&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-thunderbird |  | --- |
| thunderbird\_esr68 | + | fixed |
| thunderbird73 | + | fixed |
| thunderbird74 |  | fixed |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| thunderbird133 | --- | --- |
| thunderbird134 | --- | --- |
| thunderbird135 | --- | --- |
| thunderbird136 | --- | --- |

## People

### (Reporter: lauffer, Assigned: KaiE)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=40)  [KaiE](/user_profile?user_id=36541)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/84385f8f1dad546c0d5e800eabe8462f?d=mm&size=40)  [lauffer](/user_profile?user_id=52791)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

4 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2019-11755](/show_bug.cgi?id=1240290 "RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks")

## Details

### (Keywords: sec-moderate)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-6795

[Keywords:](/describekeywords.cgi)

[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | wanted-thunderbird |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [TB-Crash-Fwd\_attachment\_both\_signed.eml](/attachment.cgi?id=9122597)  [5 years ago](#c0)  [Stephan Lauffer](/user_profile?user_id=52791)   19.96 KB, application/x-extension-eml |  | [Details](/attachment.cgi?id=9122597&action=edit) |
| --- | --- | --- |
| [1611105-v1.patch](/attachment.cgi?id=9122665)  [5 years ago](#c3)  [Kai Engert [:KaiE:]](/user_profile?user_id=36541)   824 bytes, patch | mkmelin : [review+](#c7 "5 years ago")  mkmelin : [approval-comm-beta+](#a607474_101158 "5 years ago")  mkmelin : [approval-comm-esr68+](#a1048322_101158 "5 years ago") | [Details](/attachment.cgi?id=9122665&action=edit) | [Diff](/attachment.cgi?id=9122665&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1611105&attachment=9122665) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Stephan Lauffer](/user_profile?user_id=52791)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1611105#c0)• 5 years ago |
|  | |

Attached file
[TB-Crash-Fwd\_attachment\_both\_signed.eml](attachment.cgi?id=9122597)
— [Details](attachment.cgi?id=9122597&action=edit)

User Agent: Mozilla/5.0 (X11; Linux x86\_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.130 Safari/537.36

Steps to reproduce:

# Symphtom:

Forward a S/MIME signed mail to a mailman mailinglist AND signe it with S/MIME again and send the forwarded mail as attachment. Now open the mail and Thunderbird crashes.

I don't know if this problem causes other security risks. Unless you have checked this I would mark this problem as harmful security problem. Feel free to "unckeck" this and open this bug for world access/read.

Affected TB versions round about above v60. TB crashes on Linux and Windows, too. Other architectures not tested.

We have tested the Horde Webgroupware and Thunderbird as sending/composing MUA but makes no different.

# Fast test to reproduce:

Open the attached eml file. :-/

# Workarounds:

1st: Do not signe the fwd mail to the list OR

2nd: Do not send the fwd mail as attachment

Actual results:

TB crashes during opening the mail.

Expected results:

TB should show/open the mail and not crash... (:

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1611105#c1)• 5 years ago |
|  | |

Thanks a lot for your report, confirming the crash with the provided attachment on latest TB 68.x

Assignee: nobody → kaieStatus: UNCONFIRMED → NEWEver confirmed: true

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1611105#c2)• 5 years ago |
|  | |

We crash with a null pointer dereference, so the crash probably isn't exploitable.

The crash is in MimeObject\_write, trying to look at obj->options->state->first\_data\_written\_p, but obj->options->state is NULL.

Call stack is:

MimeObject\_write

MimeInlineTextPlain\_parse\_eof

MimeInlineText\_finalize

mime\_free

I think this means we have already processed/cleaned up this MIME object earlier, because the only place that clears obj->options->state is in MimeObject\_finalize.

Then I saw we're running into two assertions:

once: [26617, Main Thread] ###!!! ASSERTION: shouldn't already have hdrs for multipart: '!mult->hdrs', file /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimemsig.cpp, line 584

three times: [26617, Main Thread] ###!!! ASSERTION: should only have one child: 'cont->nchildren == 1', file /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimemsig.cpp, line 649

Those assertions are in MimeMultipartSigned\_emit\_child.

I see that we execute that function twice for the same MIME object, which probably shouldn't happen.

The call stack of those two calls are:

```
#0  0x00007fffea9d3543 in MimeMultipartSigned_emit_child(MimeObject*) (obj=0x7fffd95b8660) at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimemsig.cpp:584
#1  0x00007fffea9d2d75 in MimeMultipartSigned_parse_eof(MimeObject*, bool) (obj=0x7fffd95b8660, abort_p=false) at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimemsig.cpp:121
#2  0x00007fffea9d5e94 in MimeMultipart_close_child(MimeObject*) (object=0x7fffd5d03f00) at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimemult.cpp:508
#3  0x00007fffea9d44b2 in MimeMultipart_parse_line(char const*, int, MimeObject*) (line=0x7fffd5f2d800 "--", '=' <repeats 15 times>, "5250413269614387544==\n", length=39, obj=0x7fffd5d03f00) at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimemult.cpp:141
#4  0x00007fffea9a131a in convert_and_send_buffer(char*, int, bool, int (*)(char*, unsigned int, void*), void*) (buf=0x7fffd5f2d800 "--", '=' <repeats 15 times>, "5250413269614387544==\n", length=39, convert_newlines_p=true, per_line_fn=
    0x7fffea9d4250 <MimeMultipart_parse_line(char const*, int, MimeObject*)>, closure=0x7fffd5d03f00) at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimebuf.cpp:133
#5  0x00007fffea9a10e4 in mime_LineBuffer(char const*, int32_t, char**, int32_t*, uint32_t*, bool, int32_t (*)(char*, uint32_t, void*), void*)
    (net_buffer=0x7fffd9f37c00 "--", '=' <repeats 15 times>, "5250413269614387544==\n\n", net_buffer_size=39, bufferP=0x7fffd5d03f38, buffer_sizeP=0x7fffd5d03f48, buffer_fpP=0x7fffd5d03f50, convert_newlines_p=true, per_line_fn=
    0x7fffea9d4250 <MimeMultipart_parse_line(char const*, int, MimeObject*)>, closure=0x7fffd5d03f00) at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimebuf.cpp:207
#6  0x00007fffea9d6ed6 in MimeObject_parse_buffer(char const*, int, MimeObject*) (buffer=0x7fffd9f37c00 "--", '=' <repeats 15 times>, "5250413269614387544==\n\n", size=39, obj=0x7fffd5d03f00) at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimeobj.cpp:223
#7  0x00007fffea9d0050 in MimeMessage_parse_line(char const*, int, MimeObject*) (aLine=0x7fffd9f37c00 "--", '=' <repeats 15 times>, "5250413269614387544==\n\n", aLength=39, obj=0x7fffd5cb6400) at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimemsg.cpp:180
#8  0x00007fffea9a131a in convert_and_send_buffer(char*, int, bool, int (*)(char*, unsigned int, void*), void*) (buf=0x7fffd9f37c00 "--", '=' <repeats 15 times>, "5250413269614387544==\n\n", length=39, convert_newlines_p=true, per_line_fn=
    0x7fffea9cfc50 <MimeMessage_parse_line(char const*, int, MimeObject*)>, closure=0x7fffd5cb6400) at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimebuf.cpp:133
#9  0x00007fffea9a10e4 in mime_LineBuffer(char const*, int32_t, char**, int32_t*, uint32_t*, bool, int32_t (*)(char*, uint32_t, void*), void*)
    (net_buffer=0x7fffd55b1e64 "--", '=' <repeats 15 times>, "5250413269614387544==\r\nContent-Type: text/plain; charset=\"iso-8859-1\"\r\nMIME-Version: 1.0\r\nContent-Transfer-Encoding: quoted-printable\r\nContent-Disposition: inline\r\n\r\n", '_' <repeats 17 times>..., net_buffer_size=374, bufferP=0x7fffd5cb6438, buffer_sizeP=0x7fffd5cb6448, buffer_fpP=0x7fffd5cb6450, convert_newlines_p=true, per_line_fn=0x7fffea9cfc50 <MimeMessage_parse_line(char const*, int, MimeObject*)>, closure=0x7fffd5cb6400)
    at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimebuf.cpp:207
#10 0x00007fffea9d6ed6 in MimeObject_parse_buffer(char const*, int, MimeObject*)
    (buffer=0x7fffd55ad000 "Return-Path: <test-bounces@lists.ph-freiburg.de>\r\nReceived: from pmailfr-hx.ph-freiburg.de ([unix socket])\r\n\t by pmailfr-hx (Cyrus 3.0.12) with LMTPA;\r\n\t Thu, 23 Jan 2020 11:00:28 +0100\r\nX-Cyrus-Sessi"..., size=20442, obj=0x7fffd5cb6400)
    at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimeobj.cpp:223
#11 0x00007fffea9c840b in mime_display_stream_write(nsMIMESession*, char const*, int32_t)
    (stream=0x7fffdc27e400, buf=0x7fffd55ad000 "Return-Path: <test-bounces@lists.ph-freiburg.de>\r\nReceived: from pmailfr-hx.ph-freiburg.de ([unix socket])\r\n\t by pmailfr-hx (Cyrus 3.0.12) with LMTPA;\r\n\t Thu, 23 Jan 2020 11:00:28 +0100\r\nX-Cyrus-Sessi"..., size=20442)
    at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimemoz2.cpp:853

#0  0x00007fffea9d3543 in MimeMultipartSigned_emit_child(MimeObject*) (obj=0x7fffd95b8660) at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimemsig.cpp:584
#1  0x00007fffea9d2d75 in MimeMultipartSigned_parse_eof(MimeObject*, bool) (obj=0x7fffd95b8660, abort_p=false) at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimemsig.cpp:121
#2  0x00007fffea9d543c in MimeMultipart_parse_eof(MimeObject*, bool) (obj=0x7fffd5d03f00, abort_p=false) at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimemult.cpp:633
#3  0x00007fffea9a59e7 in MimeContainer_parse_eof(MimeObject*, bool) (object=0x7fffd5cb6400, abort_p=false) at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimecont.cpp:93
#4  0x00007fffea9d02ac in MimeMessage_parse_eof(MimeObject*, bool) (obj=0x7fffd5cb6400, abort_p=false) at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimemsg.cpp:492
#5  0x00007fffea9c84e3 in mime_display_stream_complete(nsMIMESession*) (stream=0x7fffdc27e400) at /home/user/moz/comm-esr68/mozilla/comm/mailnews/mime/src/mimemoz2.cpp:867

```

In short, we reach the code to flush twice:

* mime\_display\_stream\_write -> ... MimeMultipart\_close\_child -> MimeMultipartSigned\_parse\_eof -> emit
* mime\_display\_stream\_complete -> ... MimeMultipart\_parse\_eof -> MimeMultipartSigned\_parse\_eof -> emit

I think MimeMultipartSigned isn't prepared to be emitted twice, but doesn't protect itself against it.

It checks for a flag closed\_p, which is documented as: prevent multiple calls to parse\_eof.

So we should probably set this variable to true - but where?

Very few places set it currently. Some MIME code sets it on failure. The primary place to set it is MimeObject\_parse\_eof, which is usually called by all \_parse\_eof functions, that each call their superclass->parse\_eof.

I see we don't reach that when calling MimeMultipartSigned\_parse\_eof. We get a failure from MimeMultipartSigned\_emit\_child, and on failure, it doesn't set closed\_p like other places do!

I'll test if that fixes the crash. Also, I'll check why MimeMultipartSigned\_emit\_child returns a failure.

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1611105#c3)• 5 years ago |
|  | |

Attached patch

[1611105-v1.patch](attachment.cgi?id=9122665&action=diff)
— [Details](attachment.cgi?id=9122665&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1611105&attachment=9122665)

This patch fixes the crash for me.

I mentioned that by MimeMultipartSigned\_emit\_child returns failure. That's expected. MimeMultCMS\_init finds that we already have another S/MIME signature part in the message, and we refuse to process duplicate S/MIME signatures - and disable display of all signature information for this message.

[Attachment #9122665](/attachment.cgi?id=9122665&action=edit "1611105-v1.patch") -
Flags: review?(mkmelin+mozilla)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1611105#a20506_36541)• 5 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1611105#c4)• 5 years ago |
|  | |

Documenting the nesting structure of the attached message:

```
Content-Type: multipart/mixed; boundary="===============5250413269614387544=="
--===============5250413269614387544==
    Content-Type: multipart/signed; protocol="application/pkcs7-signature"; micalg=sha-256; boundary="------------ms060003030207090106080807"
    --------------ms060003030207090106080807
        Content-Type: multipart/mixed;
         boundary="------------D359E395F3E33596DCD69412"
        --------------D359E395F3E33596DCD69412
            Content-Type: text/plain; charset=utf-8; format=flowed
        --------------D359E395F3E33596DCD69412
            Content-Type: message/rfc822;
            Content-Type: multipart/signed; protocol="application/pkcs7-signature"; micalg=sha-256; boundary="------------ms090706050908080107090509"
            --------------ms090706050908080107090509
                Content-Type: text/plain; charset=utf-8; format=flowed
                --------------ms090706050908080107090509
                Content-Type: application/pkcs7-signature; name="smime.p7s"
            --------------ms090706050908080107090509--
        --------------D359E395F3E33596DCD69412--
    --------------ms060003030207090106080807
        Content-Type: application/pkcs7-signature; name="smime.p7s"
    --------------ms060003030207090106080807--
--===============5250413269614387544==
    Content-Type: text/plain; charset="iso-8859-1"
--===============5250413269614387544==--

```

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1611105#c5)• 5 years ago |
|  | |

What's the most likely crash signature that would be generated on crash-stats?

is nsMsgComposeSecure::MimeFinishMultipartSigned possible? [bp-6e43c589-290e-41cd-803a-c650f0191101](https://crash-stats.mozilla.org/report/index/6e43c589-290e-41cd-803a-c650f0191101)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1611105#c6)• 5 years ago |
|  | |

(In reply to Wayne Mery (:wsmwk) from [comment #5](/show_bug.cgi?id=1611105#c5 "RESOLVED FIXED - TB crashes during opening s/mime signed mail from mailman mailinglist"))

> What's the most likely crash signature that would be generated on crash-stats?

MimeObject\_write

MimeInlineTextPlain\_parse\_eof

MimeInlineText\_finalize

mime\_free

> is nsMsgComposeSecure::MimeFinishMultipartSigned possible? [bp-6e43c589-290e-41cd-803a-c650f0191101](https://crash-stats.mozilla.org/report/index/6e43c589-290e-41cd-803a-c650f0191101)

Seems unlikely to be related. This bug is about processing a received message.

That crash report is about sending out a new message that we create.

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1611105#c7)• 5 years ago |
|  | |

Comment on [attachment 9122665](/attachment.cgi?id=9122665 "1611105-v1.patch") [[details]](/attachment.cgi?id=9122665&action=edit "1611105-v1.patch") [[diff]](/attachment.cgi?id=9122665&action=diff "1611105-v1.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1611105&attachment=9122665)
1611105-v1.patch
Review of [attachment 9122665](/attachment.cgi?id=9122665 "1611105-v1.patch") [[details]](/attachment.cgi?id=9122665&action=edit "1611105-v1.patch") [[diff]](/attachment.cgi?id=9122665&action=diff "1611105-v1.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1611105&attachment=9122665):
-----------------------------------------------------------------
Looks good, thx!
[Attachment #9122665](/attachment.cgi?id=9122665&action=edit "1611105-v1.patch") -
Flags: review?(mkmelin+mozilla) → review+

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1611105#c8)• 5 years ago |
|  | |

<https://hg.mozilla.org/comm-central/rev/237a41008a61db0eaa252f3c0bea04c89c455fb7>

Status: NEW → RESOLVEDClosed: 5 years ago
[status-thunderbird73](/buglist.cgi?f1=cf_status_thunderbird_73&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_73&o1=equals&v1=affected)
[status-thunderbird74](/buglist.cgi?f1=cf_status_thunderbird_74&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_thunderbird_74&o1=equals&v1=fixed)
[status-thunderbird\_esr68](/buglist.cgi?f1=cf_status_thunderbird_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_esr68&o1=equals&v1=affected)
[tracking-thunderbird73](/buglist.cgi?f1=cf_tracking_thunderbird_73&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_thunderbird_73&o1=equals&v1=%3F)
[tracking-thunderbird\_esr68](/buglist.cgi?f1=cf_tracking_thunderbird_esr68&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_thunderbird_esr68&o1=equals&v1=%3F)Resolution: --- → FIXEDTarget Milestone: --- → Thunderbird 74.0

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1611105#a44195_36541)• 5 years ago |

[Attachment #9122665](/attachment.cgi?id=9122665&action=edit "1611105-v1.patch") -
Flags: approval-comm-esr68?
[Attachment #9122665](/attachment.cgi?id=9122665&action=edit "1611105-v1.patch") -
Flags: approval-comm-beta?

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1611105#c9)• 5 years ago |
| duplicate | |

| Comment hidden (duplicate) |  |
| --- | --- |

What's the most likely crash signature that would be generated on crash-stats?

is nsMsgComposeSecure::MimeFinishMultipartSigned a possibility? [bp-6e43c589-290e-41cd-803a-c650f0191101](https://crash-stats.mozilla.org/report/index/6e43c589-290e-41cd-803a-c650f0191101)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1611105#c10)• 5 years ago |
|  | |

Wayne, you submitted your question twice. See [comment 6](/show_bug.cgi?id=1611105#c6 "RESOLVED FIXED - TB crashes during opening s/mime signed mail from mailman mailinglist") for my response.

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1611105#a607459_101158)• 5 years ago |

[tracking-thunderbird73](/buglist.cgi?f1=cf_tracking_thunderbird_73&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_thunderbird_73&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_thunderbird_73&o1=equals&v1=%2B)
[tracking-thunderbird\_esr68](/buglist.cgi?f1=cf_tracking_thunderbird_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_thunderbird_esr68&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_thunderbird_esr68&o1=equals&v1=%2B)

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1611105#a607474_101158)• 5 years ago |

[Attachment #9122665](/attachment.cgi?id=9122665&action=edit "1611105-v1.patch") -
Flags: approval-comm-beta? → approval-comm-beta+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1611105#a616198_1689)• 5 years ago |

Group: mail-core-security → core-security-release

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1611105#a621614_578488)• 5 years ago |

Alias: CVE-2020-6795

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1611105#c11)• 5 years ago |
|  | |

Thunderbird 73.0b2:

<https://hg.mozilla.org/releases/comm-beta/rev/39542aae79eca484cab6f77058105ea47006d5ea>

[status-thunderbird73](/buglist.cgi?f1=cf_status_thunderbird_73&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_73&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_thunderbird_73&o1=equals&v1=fixed)

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1611105#c12)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1611105&comment_id=14621964 "1 revision") |
|  | |

(In reply to Kai Engert (:KaiE:) from [comment #6](/show_bug.cgi?id=1611105#c6 "RESOLVED FIXED - TB crashes during opening s/mime signed mail from mailman mailinglist"))

> (In reply to Wayne Mery (:wsmwk) from [comment #5](/show_bug.cgi?id=1611105#c5 "RESOLVED FIXED - TB crashes during opening s/mime signed mail from mailman mailinglist"))
>
> > What's the most likely crash signature that would be generated on crash-stats?
>
> MimeObject\_write
>
> MimeInlineTextPlain\_parse\_eof
>
> MimeInlineText\_finalize
>
> mime\_free

so perhaps ....

MIME\_MimeObject\_write [bp-34006993-76ba-4904-a6da-b3fc20200203](https://crash-stats.mozilla.org/report/index/34006993-76ba-4904-a6da-b3fc20200203)

0 xul.dll MIME\_MimeObject\_write(MimeObject\*, char const\*, int, bool) comm/mailnews/mime/src/mimei.cpp:200

1 xul.dll static int MimeInlineTextPlain\_parse\_eof(struct MimeObject\*, bool) comm/mailnews/mime/src/mimetpla.cpp:234

2 xul.dll static void MimeInlineText\_finalize(struct MimeObject\*) comm/mailnews/mime/src/mimetext.cpp:159

3 xul.dll mime\_free comm/mailnews/mime/src/mimei.cpp:255

4 xul.dll static void MimeContainer\_finalize(struct MimeObject\*) comm/mailnews/mime/src/mimecont.cpp:67

5 xul.dll mime\_free comm/mailnews/mime/src/mimei.cpp:255

6 xul.dll static void MimeContainer\_finalize(struct MimeObject\*) comm/mailnews/mime/src/mimecont.cpp:67

7 xul.dll mime\_free comm/mailnews/mime/src/mimei.cpp:255

8 xul.dll static void MimeContainer\_finalize(struct MimeObject\*) comm/mailnews/mime/src/mimecont.cpp:67

9 xul.dll mime\_free comm/mailnews/mime/src/mimei.cpp:255

10 xul.dll mime\_display\_stream\_complete comm/mailnews/mime/src/mimemoz2.cpp:892

11 xul.dll nsStreamConverter::OnStopRequest(nsIRequest\*, nsresult) comm/mailnews/mime/src/nsStreamConverter.cpp:922

12 xul.dll nsDocumentOpenInfo::OnStopRequest(nsIRequest\*, nsresult) uriloader/base/nsURILoader.cpp:360

xul.dll | mime\_free | MimeContainer\_finalize [bp-80e48557-1eb9-4dcb-ae22-e38040200114](https://crash-stats.mozilla.org/report/index/80e48557-1eb9-4dcb-ae22-e38040200114)

0 xul.dll xul.dll@0x2142ed

1 xul.dll mime\_free comm/mailnews/mime/src/mimei.cpp:255

2 xul.dll static void MimeContainer\_finalize(struct MimeObject\*) comm/mailnews/mime/src/mimecont.cpp:67

3 xul.dll mime\_free comm/mailnews/mime/src/mimei.cpp:255

4 xul.dll static void MimeContainer\_finalize(struct MimeObject\*) comm/mailnews/mime/src/mimecont.cpp:67

5 xul.dll mime\_free comm/mailnews/mime/src/mimei.cpp:255

6 xul.dll mime\_display\_stream\_complete comm/mailnews/mime/src/mimemoz2.cpp:892

7 xul.dll nsStreamConverter::OnStopRequest(nsIRequest\*, nsresult) comm/mailnews/mime/src/nsStreamConverter.cpp:922

8 xul.dll nsDocumentOpenInfo::OnStopRequest(nsIRequest\*, nsresult) uriloader/base/nsURILoader.cpp:360

9 xul.dll nsMsgProtocol::OnStopRequest(nsIRequest\*, nsresult) comm/mailnews/base/util/nsMsgProtocol.cpp:384

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1611105#c13)• 5 years ago |
|  | |

Although the code that causes this crash has always been there, the fix from [bug 1240290](/show_bug.cgi?id=1240290 "RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks") causes this crash scenario to be reached frequently with certain S/MIME messages.

See Also: → [CVE-2019-11755](/show_bug.cgi?id=1240290 "RESOLVED FIXED - Susceptibility to S/MIME Message Takeover Attacks")

|  | [Magnus Melin [:mkmelin]](/user_profile?user_id=101158) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1611105#a1048322_101158)• 5 years ago |

[Attachment #9122665](/attachment.cgi?id=9122665&action=edit "1611105-v1.patch") -
Flags: approval-comm-esr68? → approval-comm-esr68+

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1611105#c14)• 5 years ago |
|  | |

Rob, can you please land into comm-esr68? Thanks.

Flags: needinfo?(rob)

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1611105#c15)• 5 years ago |
| uplift | |

c-esr68:

<https://hg.mozilla.org/releases/comm-esr68/rev/5e3454394b88>

Flags: needinfo?(rob)

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1611105#a1181927_63411)• 5 years ago |

[status-thunderbird\_esr68](/buglist.cgi?f1=cf_status_thunderbird_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr68&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1611105#a17130558_1689)• 4 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1611105&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Stephan Lauffer](/user_profile?user_id=52791)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_726b16e0_20250119_121517.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-06

## Security Vulnerabilities fixed in Firefox ESR 68.5

Announced
February 11, 2020
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 68.5

#### [#CVE-2020-6796: Missing bounds check on shared memory read in the parent process](#CVE-2020-6796)

Reporter
Thomas Imbert
Impact
high
##### Description

A content process could have modified shared memory relating to crash reporting information, crash itself, and cause an out-of-bound write. This could have caused memory corruption and a potentially exploitable crash.

##### References

* [Bug 1610426](https://bugzilla.mozilla.org/show_bug.cgi?id=1610426)

#### [#CVE-2020-6797: Extensions granted downloads.open permission could open arbitrary applications on Mac OSX](#CVE-2020-6797)

Reporter
Vladimir Metnew
Impact
moderate
##### Description

By downloading a file with the .fileloc extension, a semi-privileged extension could launch an arbitrary application on the user's computer. The attacker is restricted as they are unable to download non-quarantined files or supply command line arguments to the application, limiting the impact.
*Note: this issue only occurs on Mac OSX. Other operating systems are unaffected.*

##### References

* [Bug 1596668](https://bugzilla.mozilla.org/show_bug.cgi?id=1596668)

#### [#CVE-2020-6798: Incorrect parsing of template tag could result in JavaScript injection](#CVE-2020-6798)

Reporter
terjanq
Impact
moderate
##### Description

If a `<template>` tag was used in a `<select%gt;` tag, the parser could be confused and allow JavaScript parsing and execution when it should not be allowed. A site that relied on the browser behaving correctly could suffer a cross-site scripting vulnerability as a result.

##### References

* [Bug 1602944](https://bugzilla.mozilla.org/show_bug.cgi?id=1602944)

#### [#CVE-2020-6799: Arbitrary code execution when opening pdf links from other applications, when Firefox is configured as default pdf reader](#CVE-2020-6799)

Reporter
Joshua Graham & Brendan Scarvell
Impact
moderate
##### Description

Command line arguments could have been injected during Firefox invocation as a shell handler for certain unsupported file types. This required Firefox to be configured as the default handler for a given file type and for a file downloaded to be opened in a third party application that insufficiently sanitized URL data. In that situation, clicking a link in the third party application could have been used to retrieve and execute files whose location was supplied through command line arguments.
*Note: This issue only affects Windows operating systems and when Firefox is configured as the default handler for non-default filetypes. Other operating systems are unaffected.*

##### References

* [Bug 1606596](https://bugzilla.mozilla.org/show_bug.cgi?id=1606596)

#### [#CVE-2020-6800: Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](#CVE-2020-6800)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Raul Gurzau, Tyson Smith, Bob Clary, Liz Henry, and Christian Holler reported memory safety bugs present in Firefox 72 and Firefox ESR 68.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_1ebb754d_20250119_135532.html ===


# BMO

From MozillaWiki

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)

This is the main public page for all things related to <https://bugzilla.mozilla.org>, aka BMO, Mozilla's customized version of [Bugzilla](http://www.bugzilla.org).

BMO is a core piece of infrastructure at Mozilla. It is used to track not only bugs and feature requests but also many other tasks across various teams.

The BMO source is a slightly modified fork of Bugzilla with many custom extensions. It is currently based on Bugzilla 4.2 but with many features backported from 4.4 and master. All the BMO devs are also involved in the Bugzilla project, and we contribute features and fixes upstream where they are generally applicable, that is, not too specific to Mozilla's particular needs.

Updates are usually deployed on a weekly basis and are listed on the [Recent Changes](/BMO/Recent_Changes "BMO/Recent Changes") page.

## Contents

* [1 B-Team](#B-Team)
* [2 New Users](#New_Users)
* [3 New Bots](#New_Bots)
* [4 User Guide](#User_Guide)
* [5 Road Map](#Road_Map)
* [6 Browser Support For BMO](#Browser_Support_For_BMO)
  + [6.1 JavaScript and Analytics](#JavaScript_and_Analytics)
* [7 Third-Party Applications](#Third-Party_Applications)
* [8 More Information about BMO](#More_Information_about_BMO)
* [9 Contributing to BMO](#Contributing_to_BMO)
* [10 Policies and Procedures](#Policies_and_Procedures)
  + [10.1 Code Updates](#Code_Updates)
  + [10.2 Administrative Changes](#Administrative_Changes)
  + [10.3 BMO Administrative Processes](#BMO_Administrative_Processes)
  + [10.4 BMO Development and Other Processes](#BMO_Development_and_Other_Processes)
  + [10.5 Custom Bug Entry Forms](#Custom_Bug_Entry_Forms)
# B-Team

The team that works on BMO is called the B-Team, because of past affiliation with the defunct Automation and Tools team (A-Team).

* dkl: Dave Lawrence (Owner/Engineer)
* glob (Manager)

The Low-level, security, and quality tools team contributes tooling, and development:

* calixte: Calixte Denizet, (AutoNag)
* marco: Marco Castelluccio, (BugBug)

We also also have some volunteers, that we consider to be part of the B-Team as well:

* seban: Sebastin Santy (long-term volunteer, past GSoC student)
* atoll: Richard Solderberg (Reviewer-at-Large, slightly borrowed from Mozilla IT)
* kohei: Kohei Yoshino, (UX Designer)
* *... and you can be one too!*

There are also some people that still have some involvement with BMO,
but their day-to-day attention is directed to other parts of Mozilla.

* zeid: Zeid Zabaneh (Engineer)

Past contributors include:

* mary: Mary Umoh (Intern, Summer 2017)
* gerv: Gervase Markham
* mcote: Mark Côté
* dylan: Dylan Hardison
* imadueme: Israel Madueme (Engineer)
* justdave: Dave Miller
* emceeaich: Emma Humphries, (Bugmaster)
* mhentges: Mitchell Hentges (Engineer)

# New Users

Getting used to Bugzilla can be a bit daunting. We have a short [introductory video](https://gerv.makes.org/popcorn/1bn6) available that is as gentle as possible. You may also be interested in the [[MDN section about Bugzilla](https://developer.mozilla.org/en-US/docs/Mozilla/Bugzilla)], which contains information more suitable as an introduction to a general audience. Of special interest is the MDN article, [What to do and what not to do in Bugzilla](https://developer.mozilla.org/en-US/docs/What_to_do_and_what_not_to_do_in_Bugzilla), which contains instructions on getting elevated privileges.

# New Bots

If you have a bot that uses BMO, be sure to add it to the [BMO/Bot Registry](/BMO/Bot_Registry "BMO/Bot Registry")
so we know who to contact about it!

# User Guide

We're putting together a [user guide](/BMO/UserGuide "BMO/UserGuide") with helpful information on various aspects of Bugzilla. New and experienced users alike should benefit from it. There's a lot to go through, so please feel free to contribute!

# Road Map

We keep a yearly [road map](/BMO/Road_Map "BMO/Road Map") with our medium-term plans (1-2 years), at a high level. Also see our [current projects](/BMO#Current_Projects "BMO") for some of the big items we are working on in the current quarter.

# Browser Support For BMO

Full Support includes: The current versions of Firefox, Chrome, Chromium, Safari, WebKit, and Edge; and the latest Firefox ESR.

Limited Support includes: The previous versions of Firefox, Chrome, Chromium, Safari, WebKit, Edge, and Firefox ESR; and Firefox Nightly.

Internet Explorer is no longer supported, though some features may still work with IE 11.

See [bug 1359310](https://bugzilla.mozilla.org/show_bug.cgi?id=1359310) and [bug 1422435](https://bugzilla.mozilla.org/show_bug.cgi?id=1422435).

## JavaScript and Analytics

JavaScript is required to use bugzilla.mozilla.org.

The `Do Not Track` header sent by your browser is honored.

# Third-Party Applications

Lots and lots of web apps and general tools have been written to interface with BMO. We have started [cataloguing them](/BMO/ThirdPartyApps "BMO/ThirdPartyApps"). If you're looking for different ways to interface with BMO, check it out; similarly, if you are thinking about writing an app, check the catalogue to see if something similar exists that you could use, contribute to, or fork before setting out on your own.

There's one in particular that is particularly important: [Phabricator](https://moz-conduit.readthedocs.io/en/latest/phabricator-user.html), Mozilla's new and growing code-review tool.

# More Information about BMO

Our discussion forum is mozilla.tools.bmo [[mailing list](https://lists.mozilla.org/listinfo/tools-bmo)] [[Google Group](https://groups.google.com/forum/#!forum/mozilla.tools.bmo)] [USENET].

We also have answers to [Frequently Asked Questions](/BMO/FAQ "BMO/FAQ") and a slightly-but-not-too-out-of-date [hardware diagram](http://people.mozilla.org/~justdave/BugzillaPhysicalDiagram-rev110504.png).

If you're building an application or tool that interfaces with BMO, you may be interested in the following:

* [Best practices and etiquette](/BMO/Integration_Best_Practice "BMO/Integration Best Practice") for integrating external apps with BMO
* Info and plans on Bugzilla's [REST API](/Bugzilla%3AREST_API "Bugzilla:REST API"), and the older, deprecated [BzAPI](/Bugzilla%3ABzAPI "Bugzilla:BzAPI").

Looking for another way to access Bugzilla's raw data? Try the [ElasticSearch cluster](/BMO/ElasticSearch "BMO/ElasticSearch").

# Contributing to BMO

If you'd like to help out with BMO specifically (as opposed to the general upstream [Bugzilla project](/Bugzilla "Bugzilla")), you can find us in #bmo on irc.mozilla.org. If you plan on contributing patches, see the documentation in the [README.rst](https://github.com/mozilla-bteam/bmo/blob/master/README.rst). You can file bugs under the [bugzilla.mozilla.org product](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org). Don't file them under the Bugzilla product unless you are sure it's a bug in the general Bugzilla product. In particular, all administrative changes should be filed under bugzilla.mozilla.org (see below for more).

# Policies and Procedures

## Code Updates

Code updates are normally deployed to bugzilla.mozilla.org late Monday/early Tuesday, US/Pacific time, at no specific time, if changes need to be pushed out. Security fixes or other fatal type errors will always go out as soon as possible.

Updates are usually deployed on a weekly basis and are listed on the [BMO/Recent Changes](/BMO/Recent_Changes "BMO/Recent Changes") page.

## Administrative Changes

If you need changes to BMO's configuration to support your team, project, etc., please consult this page before filing bugs:

* [General information on requesting Changes to BMO](/BMO/Requesting_Changes "BMO/Requesting Changes")

## BMO Administrative Processes

* [Adding a new product](/BMO/new-product "BMO/new-product")
* [Adding a new "rapid release" version](/BMO/new-version "BMO/new-version")
* [Adding a new BMO security group](/BMO/new-security-group "BMO/new-security-group")
* [Retiring Products and Components](/BMO/RetiringComponents "BMO/RetiringComponents"): moving things to the Graveyard classification.
* [Restoring Disabled Accounts](/BMO/RestoringDisabledAccounts "BMO/RestoringDisabledAccounts")
* [Merging Accounts](/index.php?title=BMO/MergingAccounts&action=edit&redlink=1 "BMO/MergingAccounts (page does not exist)")
* [Disabling Accounts](/BMO/DisablingAccounts "BMO/DisablingAccounts")

See also [BMO on Mana](https://mana.mozilla.org/wiki/pages/viewpage.action?pageId=45845955) (requires LDAP).

## BMO Development and Other Processes

* [Overall Development Processes](/BMO/Development_Processes "BMO/Development Processes")

* [Planning a BMO outage](/BMO/OutagePlanning "BMO/OutagePlanning")
* [Reset the development branch to master](/BMO/ResetDevelopmentBranch "BMO/ResetDevelopmentBranch")
* [Maintaining Perl Dependencies for BMO](/BMO/Perl_Dependencies "BMO/Perl Dependencies")

## Custom Bug Entry Forms

In the past, BMO developers supported writing custom bug entry forms specific for the needs of different projects and groups within Mozilla. In order to focus more on other important features, we will no longer be providing that support going forward. For more information on why this change was made, see [here](https://groups.google.com/forum/#!topic/mozilla.tools.bmo/tp4dSwUfKSA).

There is a new [custom form framework](https://github.com/mozilla-bteam/custom-form-example) being developed by an outside contributor named Sebastin Santy. It is still in the early stages but it eventually will be very useful for users who want to create a customized bug entry form that can be used to submit bugs to BMO.

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO&oldid=1248774>"
[Category](/Special%3ACategories "Special:Categories"):

* [BMO](/index.php?title=Category:BMO&action=edit&redlink=1 "Category:BMO (page does not exist)")

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO)
* [View source](/index.php?title=BMO&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO&oldid=1248774 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO&action=info "More information about this page")

* This page was last edited on 30 October 2023, at 16:36.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_d031a228_20250119_121515.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1596668)
* [XML](/show_bug.cgi?ctype=xml&id=1596668)

Closed
[Bug 1596668](/show_bug.cgi?id=1596668)
(CVE-2020-6797)

Opened 5 years ago
Closed 5 years ago

# Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files

## Categories

### (Firefox :: File Handling, defect, P1)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=File%20Handling#File%20Handling)

File Handling
▾

Firefox :: File Handling
For issues dealing with helper applications, and guessing Content Types when they aren't specified/known (ftp:, file:, jar:, but generally not http:). This component does not cover: backend networking issues, such as those covered by Networking: FTP or Networking: File, nor does it cover the Download Manager which has its own component in the Toolkit product.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=File%20Handling)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Firefox 74

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified) |
| firefox72 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix) |
| firefox73 | [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=verified) |
| firefox74 | [+](/buglist.cgi?f1=cf_tracking_firefox74&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr68 | 73+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox72 |  | wontfix |
| firefox73 | + | verified |
| firefox74 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: vladimirmetnew, Assigned: Gijs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/c735e81990ce93d78a069c5fbc5ab37d?d=mm&size=40)  [vladimirmetnew](/user_profile?user_id=570698)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-priv-escalation, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main73+] [adv-esr68.5+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-6797

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main73+] [adv-esr68.5+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c31 "5 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [firefox-extension-fileloc.zip](/attachment.cgi?id=9108939)  [5 years ago](#c0)  [Vladimir Metnew](/user_profile?user_id=570698)   3.86 KB, application/zip |  | [Details](/attachment.cgi?id=9108939&action=edit) |
| --- | --- | --- |
| [Bug 1596668, r?spohl](/attachment.cgi?id=9117703)  [5 years ago](#c20)  [:Gijs (he/him)](/user_profile?user_id=159069)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c32 "5 years ago")  RyanVM : [approval-mozilla-esr68+](#c41 "5 years ago") | [Details](/attachment.cgi?id=9117703&action=edit) | [Review](/attachment.cgi?id=9117703) |
| [advisory.txt](/attachment.cgi?id=9122662)  [5 years ago](#c44)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   490 bytes, text/plain |  | [Details](/attachment.cgi?id=9122662&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1596668#c0)• 5 years ago |
|  | |

Attached file
[firefox-extension-fileloc.zip](attachment.cgi?id=9108939)
— [Details](attachment.cgi?id=9108939&action=edit)

FF Version: 70.0.1

macOS: 10.15.1 (19B88)

1. .fileloc files behave on macOS similarly to .url files on Windows - as shortcuts that can execute local apps.
2. A malicious extension with `downloads/downloads.open` permissions can download a .fileloc file + execute it to launch arbitrary local apps.
3. It looks like a non-secure feature of macOS(that I'm going to report), so it's not clear what'd be your opinion. I guess you'd like to add this file to your file handling mechanism as well.

PoC opens Calculator.app on Catalina.

Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1596668#c1)• 5 years ago |
|  | |

Shane, under what circumstances are webextensions *supposed* to be able to execute arbitrary local executables? I assume that addons with native messaging can already do this, and maybe others?

Component: Security → File HandlingFlags: needinfo?(mixedpuppy)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1596668#c2)• 5 years ago |
|  | |

In fact, let's move this to webextensions for now. I imagine this issue doesn't just affect fileloc files, and/or if it does, that whatever lists other "dangerous" things should be what's listing this, not core Firefox code. We can always move it back if there's shared code being used that I'm not aware of.

Component: File Handling → UntriagedProduct: Firefox → WebExtensions

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1596668#c3)• 5 years ago |
|  | |

I'm unable to reproduce this on osx 10.14 with release or nightly. We need to find someone with 10.15 to verify.

After fixing the app path in the popup js file, when I use the extension to download then click the "run" button, the file is opened in textedit.

I am able to use the downloaded x.fileloc from Finder and the command line to open an application.

*The downloads.open API merely calls launch on the download, so if this were to work, it should work without an extension involved at all.* Just download a fileloc file somewhere and open it from the downloads panel.

Vladimir, does opening the downloaded file from the downloads panel also work for opening the app?

[1] <https://searchfox.org/mozilla-central/rev/131338e5017bc0283d86fb73844407b9a2155c98/toolkit/components/extensions/parent/ext-downloads.js#951>

[2] <https://searchfox.org/mozilla-central/rev/131338e5017bc0283d86fb73844407b9a2155c98/toolkit/components/downloads/DownloadCore.jsm#734>

[3] <https://searchfox.org/mozilla-central/rev/131338e5017bc0283d86fb73844407b9a2155c98/toolkit/components/downloads/DownloadIntegration.jsm#721>

Flags: needinfo?(vladimirmetnew)

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1596668#c4)• 5 years ago |
|  | |

Alexandru, could you verify this bug?

Assignee: nobody → acornestean

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1596668#c5)• 5 years ago |
|  | |

(In reply to Shane Caraveo (:mixedpuppy) from [comment #3](/show_bug.cgi?id=1596668#c3 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> Just download a fileloc file somewhere and open it from the downloads panel.

As a note, doing this on 10.14 resulted in the same behavior, from the downloads panel it opened the file in textedit, but I could use the downloaded file via Finder to open the app.

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a306826_372685)• 5 years ago |

Flags: needinfo?(mixedpuppy)

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a306879_372685)• 5 years ago |

Flags: needinfo?(mixedpuppy)

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1596668#c6)• 5 years ago |
|  | |

> Vladimir, does opening the downloaded file from the downloads panel also work for opening the app?

Yeah, it's a macOS shortcut file and FF basically calls `open` on this file. It works for opening the app.

Default handler for .fileloc is Finder.app. Try to rebuild launchservices database, if .fileloc gets opened in TextEdit.app on your device. (might damage your macOS setup preferences) Or run macOS VM.

I setup a macOS in VM and tried to repro this again: it works. Screencast - <https://drive.google.com/open?id=103he_74WHflyVLv9IxydOwGY9ewyhxJ1>

Flags: needinfo?(vladimirmetnew)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a563593_1689)• 5 years ago |

Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1596668#c7)• 5 years ago |
|  | |

Given the extension api uses the underlying libraries, and that this happens as well from the downloads panel, I'm moving back in to file handling component.

Component: Untriaged → File HandlingFlags: needinfo?(mixedpuppy)Product: WebExtensions → Firefox

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a1145208_159069)• 5 years ago |

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1596668#c8)• 5 years ago |
|  | |

Talked to Marco about this. It seems we should:

1. add fileloc to the list of executable extensions (and make sure those get checked on mac, as we use the executable bit at the moment) and/or hardcode a check in nsLocalFileUnix that returns true only for this type of file
2. ensure we show the executable warning based on that, and require user interaction (that last part should already be happening)

Note that at least on my 10.14 machine, the `file:///System/Applications` path does not exist, which might be why the testcase doesn't work. Though the extension also fails to install for me ("extension does not contain a valid manifest").

Shane, can you confirm this seems right to you? (Also, any idea why the add-on is not installing?)

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(mixedpuppy)

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1596668#c9)• 5 years ago |
|  | |

file:///System/Applications exists only on Catalina. (different partition, additional security measure)

You can change /System to / and it will work on Mojave as well.

> (Also, any idea why the add-on is not installing?)
>
> Probably, an issue in my code? I ctrl+c'ed the addon from FF examples on github, it may miss somethings

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1596668#c10)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #8](/show_bug.cgi?id=1596668#c8 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> Though the extension also fails to install for me ("extension does not contain a valid manifest").

How are you trying to install the add-on? A zip file can only be loaded directly via `about:debugging` if manifest.json is a top-level file in the zip file.

In the attached test case, it is inside a subdirectory. So to test the add-on, you need to extract the zip file and load the directory via `about:debugging`.

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1596668#c11)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #8](/show_bug.cgi?id=1596668#c8 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> Talked to Marco about this. It seems we should:
>
> 1. add fileloc to the list of executable extensions (and make sure those get checked on mac, as we use the executable bit at the moment) and/or hardcode a check in nsLocalFileUnix that returns true only for this type of file
> 2. ensure we show the executable warning based on that, and require user interaction (that last part should already be happening)
>
> Note that at least on my 10.14 machine, the `file:///System/Applications` path does not exist, which might be why the testcase doesn't work. Though the extension also fails to install for me ("extension does not contain a valid manifest").

I changed that in my testing to point at a valid location for an application.

> Shane, can you confirm this seems right to you? (Also, any idea why the add-on is not installing?)

Yeah, that seems like a good approach.

Flags: needinfo?(mixedpuppy)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1596668#c12)• 5 years ago |
|  | |

I'm going to steal this to implement [comment #8](/show_bug.cgi?id=1596668#c8 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files").

Assignee: acornestean → gijskruitbosch+bugsStatus: NEW → ASSIGNEDType: task → defect

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1596668#c13)• 5 years ago |
|  | |

JFYI I’ve heard Chrome is going to deprecate downloads.open and make it an alias to downloads.show

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1596668#c14)• 5 years ago |
|  | |

(In reply to Vladimir Metnew from [comment #13](/show_bug.cgi?id=1596668#c13 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> JFYI I’ve heard Chrome is going to deprecate downloads.open and make it an alias to downloads.show

Thanks for the heads-up. Is there a public reference for this plan?

This feels like something in Shane's wheelhouse again... :-)

Flags: needinfo?(vladimirmetnew)Flags: needinfo?(mixedpuppy)

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1596668#c15)• 5 years ago |
|  | |

> Thanks for the heads-up. Is there a public reference for this plan?

No, I submitted the same bug to Chrome, and I've just accidentally recalled they had been discussing this option to deprecate `downloads.open` behavior.

Completely not an official reference :)

Flags: needinfo?(vladimirmetnew)

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1596668#c16)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #14](/show_bug.cgi?id=1596668#c14 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> This feels like something in Shane's wheelhouse again... :-)

Bouncing that hot potato back to you. This can be done via the downloads panel itself, so it should be fixed (per [comment 8](/show_bug.cgi?id=1596668#c8 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files")). As well, we don't deprecate APIs overnight, and if this is being deprecated it's likely part of manifest v3.

Flags: needinfo?(mixedpuppy)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1596668#c17)• 5 years ago |
|  | |

(In reply to Shane Caraveo (:mixedpuppy) from [comment #16](/show_bug.cgi?id=1596668#c16 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> (In reply to :Gijs (he/him) from [comment #14](/show_bug.cgi?id=1596668#c14 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
>
> > This feels like something in Shane's wheelhouse again... :-)
>
> Bouncing that hot potato back to you. This can be done via the downloads panel itself, so it should be fixed (per [comment 8](/show_bug.cgi?id=1596668#c8 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files")). As well, we don't deprecate APIs overnight, and if this is being deprecated it's likely part of manifest v3.

To be clear, I'm still going to fix this as discussed. I was just pinging you about the deprecation stuff. Sorry for the brevity-induced lack of clarity.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1596668#c18)• 5 years ago |
|  | |

The priority flag is not set for this bug.

:Gijs, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_priority.py).

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a1835661_159069)• 5 years ago |

Flags: needinfo?(gijskruitbosch+bugs)Priority: -- → P1

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1596668#c19)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1596668&comment_id=14564014 "1 revision") |
|  | |

After adding `fileloc` to the list of dangerous extensions, I get the expected prompt when using the downloads panel.

However, either way Calculator does not open (testing on Mojave) - instead, the file gets opened by textedit... I see the same thing on older Firefoxes (ie it's using textedit rather than opening the app). Unsure why I'm seeing different behaviour - OP, did you actually test on Mojave with Firefox? Perhaps something got changed wrt fileloc files on Catalina? Because when I open the file "manually" from Finder, Calculator.app appears in the dock but bounces forever. Opening calculator normally (via spotlight) works fine...

Flags: needinfo?(vladimirmetnew)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1596668#c20)• 5 years ago |
|  | |

Attached file
[Bug 1596668, r?spohl](attachment.cgi?id=9117703)
— [Details](attachment.cgi?id=9117703&action=edit)

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1596668#c21)• 5 years ago |
|  | |

See PoC screencast I've recorded before I've submitted this bug : <https://drive.google.com/open?id=103he_74WHflyVLv9IxydOwGY9ewyhxJ1>

It worked fine on macOS 10.15.1 for me

Flags: needinfo?(vladimirmetnew)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1596668#c22)• 5 years ago |
|  | |

(In reply to Vladimir Metnew from [comment #21](/show_bug.cgi?id=1596668#c21 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> See PoC screencast I've recorded before I've submitted this bug : <https://drive.google.com/open?id=103he_74WHflyVLv9IxydOwGY9ewyhxJ1>
>
> It worked fine on macOS 10.15.1 for me

Sure, I'm not doubting that it works for you in 10.15. But I don't have 10.15 available right now, and you asserted in [comment #9](/show_bug.cgi?id=1596668#c9 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files") that it works on Mojave. I'm just asking, have you actually tested Mojave? The bug is valid either way, and it's fine if you don't have access to 10.14 - but for my sanity it'd be nice to understand if I'm doing something wrong, or if there's some difference between 10.14 and 10.15 here. I tried rebuilding the launch services database, that didn't make any difference.

Flags: needinfo?(vladimirmetnew)

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1596668#c23)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #22](/show_bug.cgi?id=1596668#c22 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> (In reply to Vladimir Metnew from [comment #21](/show_bug.cgi?id=1596668#c21 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
>
> > See PoC screencast I've recorded before I've submitted this bug : <https://drive.google.com/open?id=103he_74WHflyVLv9IxydOwGY9ewyhxJ1>
> >
> > It worked fine on macOS 10.15.1 for me
>
> Sure, I'm not doubting that it works for you in 10.15. But I don't have 10.15 available right now, and you asserted in [comment #9](/show_bug.cgi?id=1596668#c9 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files") that it works on Mojave. I'm just asking, have you actually tested Mojave? The bug is valid either way, and it's fine if you don't have access to 10.14 - but for my sanity it'd be nice to understand if I'm doing something wrong, or if there's some difference between 10.14 and 10.15 here. I tried rebuilding the launch services database, that didn't make any difference.

I observed a few cases when Calculator spins infinitely. But in this case, the binary is still mapped and executed in memory properly.

Try to change shortcut's URL to `file:///usr/bin/sudo` and launch via downloads.open -> Terminal.app popups and sudo outputs its help page. seems like a valid proof of the file execution

So yeah, there is no difference in OS version, because the binary is actually executed. but tbf I don't know why Calculator sometimes spins and grabs only 8K memory. Might be related to some macOS features

Flags: needinfo?(vladimirmetnew)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1596668#c24)• 5 years ago |
|  | |

(In reply to Vladimir Metnew from [comment #23](/show_bug.cgi?id=1596668#c23 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> (In reply to :Gijs (he/him) from [comment #22](/show_bug.cgi?id=1596668#c22 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
>
> > (In reply to Vladimir Metnew from [comment #21](/show_bug.cgi?id=1596668#c21 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
> >
> > > See PoC screencast I've recorded before I've submitted this bug : <https://drive.google.com/open?id=103he_74WHflyVLv9IxydOwGY9ewyhxJ1>
> > >
> > > It worked fine on macOS 10.15.1 for me
> >
> > Sure, I'm not doubting that it works for you in 10.15. But I don't have 10.15 available right now, and you asserted in [comment #9](/show_bug.cgi?id=1596668#c9 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files") that it works on Mojave. I'm just asking, have you actually tested Mojave? The bug is valid either way, and it's fine if you don't have access to 10.14 - but for my sanity it'd be nice to understand if I'm doing something wrong, or if there's some difference between 10.14 and 10.15 here. I tried rebuilding the launch services database, that didn't make any difference.
>
> I observed a few cases when Calculator spins infinitely.

To be clear, this is what I see if I open the file from Finder. From Firefox, all I can see is it opening in textedit.

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1596668#c25)• 5 years ago |
|  | |

(In reply to :Gijs (back Jan 2; he/him) from [comment #24](/show_bug.cgi?id=1596668#c24 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> (In reply to Vladimir Metnew from [comment #23](/show_bug.cgi?id=1596668#c23 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
>
> > (In reply to :Gijs (he/him) from [comment #22](/show_bug.cgi?id=1596668#c22 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
> >
> > > (In reply to Vladimir Metnew from [comment #21](/show_bug.cgi?id=1596668#c21 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
> > >
> > > > See PoC screencast I've recorded before I've submitted this bug : <https://drive.google.com/open?id=103he_74WHflyVLv9IxydOwGY9ewyhxJ1>
> > > >
> > > > It worked fine on macOS 10.15.1 for me
> > >
> > > Sure, I'm not doubting that it works for you in 10.15. But I don't have 10.15 available right now, and you asserted in [comment #9](/show_bug.cgi?id=1596668#c9 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files") that it works on Mojave. I'm just asking, have you actually tested Mojave? The bug is valid either way, and it's fine if you don't have access to 10.14 - but for my sanity it'd be nice to understand if I'm doing something wrong, or if there's some difference between 10.14 and 10.15 here. I tried rebuilding the launch services database, that didn't make any difference.
> >
> > I observed a few cases when Calculator spins infinitely.
>
> To be clear, this is what I see if I open the file from Finder. From Firefox, all I can see is it opening in textedit.

not sure why it happens to you now

I guess it might be an additional patch from Apple

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1596668#c26)• 5 years ago |
|  | |

:spohl, unsure if this is review request is showing up in your queue, so just checking! :-)

Flags: needinfo?(spohl.mozilla.bugs)

|  | [Stephen A Pohl [:spohl]](/user_profile?user_id=456485) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1596668#c27)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #26](/show_bug.cgi?id=1596668#c26 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> :spohl, unsure if this is review request is showing up in your queue, so just checking! :-)

It was in my queue but I didn't get a notification and I would probably have missed it. Thank you for pinging me!

Flags: needinfo?(spohl.mozilla.bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1596668#c28)• 5 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/bee05acc3ce7b56e5840e27a178262ff9a87a637>

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1596668#c29)• 5 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/bee05acc3ce7>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 5 years ago
[status-firefox74](/buglist.cgi?f1=cf_status_firefox74&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → Firefox 74

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1596668#c30)• 5 years ago |
|  | |

Comment on [attachment 9117703](/attachment.cgi?id=9117703 "Bug 1596668, r?spohl") [[details]](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl")

[Bug 1596668](/show_bug.cgi?id=1596668 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), r?spohl

### Beta/Release Uplift Approval Request

* **User impact if declined**: Security issue
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: On a macOS 10.15 machine:

1. download the add-on attached to the bug
2. unzip it
3. open the build you're testing
4. navigate to about:debugging
5. install a temporary add-on from there
6. find the manifest.json file and pick that
7. using the add-on's toolbar button, first download and then open the file

ER:

a warning dialog about it being a dangerous file

pre patch:

No warning dialog

* **List of other uplifts needed**: n/a
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: trivial patch to a hardcoded list of file extensions that only affects macOS
* **String changes made/needed**: nope
[Attachment #9117703](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl") -
Flags: approval-mozilla-beta?

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a5128919_159069)• 5 years ago |

Flags: qe-verify+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1596668#c31)• 5 years ago |
|  | |

Do .fileloc files support arguments? I was thinking like windows .lnk files, but .url files don't. Launching existing programs without arguments isn't likely too dangerous. On the other hand if you have downloads.open permission could you download two files? One an executable .app that we won't let you open, and then a .fileloc to launch it? You'd have to guess the user's download directory, though. Maybe WebExtensions can figure that out already in other ways (would have to investigate).

Flags: sec-bounty? → sec-bounty+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1596668#c32)• 5 years ago |
|  | |

Comment on [attachment 9117703](/attachment.cgi?id=9117703 "Bug 1596668, r?spohl") [[details]](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl")

[Bug 1596668](/show_bug.cgi?id=1596668 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), r?spohl

Approved for 73.0b5. Should we take this on ESR too?

Flags: needinfo?(gijskruitbosch+bugs)
[Attachment #9117703](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1596668#c33)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/ebdbfe7bcbbd>

[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix)
[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=%3F)
[tracking-firefox73](/buglist.cgi?f1=cf_tracking_firefox73&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B)
[tracking-firefox74](/buglist.cgi?f1=cf_tracking_firefox74&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox74&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1596668#c34)• 5 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #32](/show_bug.cgi?id=1596668#c32 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> Comment on [attachment 9117703](/attachment.cgi?id=9117703 "Bug 1596668, r?spohl") [[details]](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl")
>
> [Bug 1596668](/show_bug.cgi?id=1596668 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), r?spohl
>
> Approved for 73.0b5. Should we take this on ESR too?

We could, I think. Stephen, does that sound right to you? I don't see any issue with it (that'd suggest e.g. waiting a cycle to make sure there's no breakage) but wanted to doublecheck.

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(spohl.mozilla.bugs)

|  | [Stephen A Pohl [:spohl]](/user_profile?user_id=456485) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1596668#c35)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #34](/show_bug.cgi?id=1596668#c34 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> (In reply to Ryan VanderMeulen [:RyanVM] from [comment #32](/show_bug.cgi?id=1596668#c32 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
>
> > Comment on [attachment 9117703](/attachment.cgi?id=9117703 "Bug 1596668, r?spohl") [[details]](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl")
> >
> > [Bug 1596668](/show_bug.cgi?id=1596668 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), r?spohl
> >
> > Approved for 73.0b5. Should we take this on ESR too?
>
> We could, I think. Stephen, does that sound right to you? I don't see any issue with it (that'd suggest e.g. waiting a cycle to make sure there's no breakage) but wanted to doublecheck.

This seems like a good ESR candidate due to the low risk of breakage.

Flags: needinfo?(spohl.mozilla.bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1596668#c36)• 5 years ago |
|  | |

Comment on [attachment 9117703](/attachment.cgi?id=9117703 "Bug 1596668, r?spohl") [[details]](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl")

[Bug 1596668](/show_bug.cgi?id=1596668 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), r?spohl

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec-moderate
* **User impact if declined**: see above
* **Fix Landed on Version**: 74
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: tiny patch just adding an extension to a list
* **String or UUID changes made by this patch**: nope
[Attachment #9117703](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl") -
Flags: approval-mozilla-esr68?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a5168922_75935)• 5 years ago |

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=%3F) → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F) → [73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B)

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a5180454_458188)• 5 years ago |

QA Whiteboard: [qa-triaged]

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1596668#c37)• 5 years ago |
|  | |

I've managed to reproduce the issue using the steps from [comment 30](/show_bug.cgi?id=1596668#c30 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), on Firefox 72.0.

The issue is not reproducing anymore on Beta 73.0b5 and Nightly 74.0a1 under macOS 10.13.6. Ni? myself as a reminder to verify this on esr68 too, once it lands.

[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=verified)
[status-firefox74](/buglist.cgi?f1=cf_status_firefox74&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=verified)Flags: needinfo?(ciprian.georgiu)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1596668#c38)• 5 years ago |
|  | |

(In reply to Ciprian Georgiu [:ciprian\_georgiu], Release Desktop QA from [comment #37](/show_bug.cgi?id=1596668#c37 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> I've managed to reproduce the issue using the steps from [comment 30](/show_bug.cgi?id=1596668#c30 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), on Firefox 72.0.
>
> The issue is not reproducing anymore on Beta 73.0b5 and Nightly 74.0a1 under macOS 10.13.6.

I'm a bit surprised; I specifically asked to check macOS 10.15. Where did you reproduce the issue with 72, and can you doublecheck you see the expected results on 10.15 as well?

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1596668#c39)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #38](/show_bug.cgi?id=1596668#c38 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> I'm a bit surprised; I specifically asked to check macOS 10.15. Where did you reproduce the issue with 72, and can you doublecheck you see the expected results on 10.15 as well?

I was able to reproduce it on macOS 10.13.6 (I did not realize that this required a specific OS X version to be verified, since I've managed to see the issue on older versions).

I got the same results on macOS 10.15.1 as well, the warning dialog is correctly displayed using the same Firefox builds as per my previous comment.

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1596668#c40)• 5 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #31](/show_bug.cgi?id=1596668#c31 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> Do .fileloc files support arguments? I was thinking like windows .lnk files, but .url files don't. Launching existing programs without arguments isn't likely too dangerous. On the other hand if you have downloads.open permission could you download two files? One an executable .app that we won't let you open, and then a .fileloc to launch it? You'd have to guess the user's download directory, though. Maybe WebExtensions can figure that out already in other ways (would have to investigate).

No, .fileloc files don't support arguments :(

See my slides for a detailed impact description and additional research of macOS file quarantine issues - <https://docs.google.com/presentation/d/19WeQbqc_OKnrSv1I3Z4sm-oNAf6IVzHwRyQP4i9Bv_Y/edit?usp=sharing>

> you have downloads.open permission
>
> (Un)Luckily, to execute arbitrary code attacker needs:

* either to somehow plant a "launchable" file (`open` of which triggers code execution) with a quarantine meta attribute. This scenario is possible by sharing a file via Dropbox/OneDrive/<other\_cloud\_storage>. see my slides for a full list of these files and similar vulnerabilities (e.g., Keybase vuln)
* or to download + downloads.open `.app` + downloads.open it again + user needs to confirm GateKeeper dialog -> unrealistic scenario

I don't consider cases when File Quarantine is intentionally disabled, because in this case a single downloads.open on .terminal files leads to code execution.

Also, all utils except web browsers and sandboxed apps don't apply file quarantine at all. Files from brew/git aren't quarantined.

*In theory*, attacker can start some macOS-native binary which (for example) starts a local server and increase attack surface (or even exploit some OS vuln right from the web). But that's probably not a FF issue

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1596668#c41)• 5 years ago |
|  | |

Comment on [attachment 9117703](/attachment.cgi?id=9117703 "Bug 1596668, r?spohl") [[details]](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl")

[Bug 1596668](/show_bug.cgi?id=1596668 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), r?spohl

Approved for 68.5esr also.

[Attachment #9117703](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl") -
Flags: approval-mozilla-esr68? → approval-mozilla-esr68+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1596668#c42)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr68/rev/27f71a0b7aa2>

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1596668#c43)• 5 years ago |
|  | |

Verified fixed as well on 68.5.0esr under macOS 10.15.1 and 10.13.6.

Status: RESOLVED → VERIFIED
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified)Flags: qe-verify+Flags: needinfo?(ciprian.georgiu)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a5991429_578488)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main73+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a5991822_578488)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main73+] → [reporter-external] [client-bounty-form] [verif?][adv-main73+] [adv-esr68.5+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1596668#c44)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9122662)
— [Details](attachment.cgi?id=9122662&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a7546932_578488)• 5 years ago |

Alias: CVE-2020-6798

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a7547060_578488)• 5 years ago |

Alias: CVE-2020-6798 → CVE-2020-6797

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a17540616_1689)• 5 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a143286795_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1596668&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Vladimir Metnew](/user_profile?user_id=570698)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from security.gentoo.org_984975ef_20250119_121516.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple vulnerabilities — GLSA **202003-02**

Multiple vulnerabilities have been found in Mozilla Firefox, the
worst of which may allow execution of arbitrary code.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **68.6.0** |
| Unaffected versions | >= **68.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **68.6.0** |
| Unaffected versions | >= **68.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla
Project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please
review the CVE identifiers referenced below for details.

### Impact

A remote attacker could entice a user to view a specially crafted web
page, possibly resulting in the execution of arbitrary code with the
privileges of the process or a Denial of Service condition. Furthermore,
a remote attacker may be able to perform Man-in-the-Middle attacks,
obtain sensitive information, spoof the address bar, conduct clickjacking
attacks, bypass security restrictions and protection mechanisms, or have
other unspecified impact.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-68.6.0"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-68.6.0"

```
### References

* [CVE-2019-11745](https://nvd.nist.gov/vuln/detail/CVE-2019-11745)
* [CVE-2019-17005](https://nvd.nist.gov/vuln/detail/CVE-2019-17005)
* [CVE-2019-17008](https://nvd.nist.gov/vuln/detail/CVE-2019-17008)
* [CVE-2019-17010](https://nvd.nist.gov/vuln/detail/CVE-2019-17010)
* [CVE-2019-17011](https://nvd.nist.gov/vuln/detail/CVE-2019-17011)
* [CVE-2019-17012](https://nvd.nist.gov/vuln/detail/CVE-2019-17012)
* [CVE-2019-17016](https://nvd.nist.gov/vuln/detail/CVE-2019-17016)
* [CVE-2019-17017](https://nvd.nist.gov/vuln/detail/CVE-2019-17017)
* [CVE-2019-17022](https://nvd.nist.gov/vuln/detail/CVE-2019-17022)
* [CVE-2019-17024](https://nvd.nist.gov/vuln/detail/CVE-2019-17024)
* [CVE-2019-17026](https://nvd.nist.gov/vuln/detail/CVE-2019-17026)
* [CVE-2019-20503](https://nvd.nist.gov/vuln/detail/CVE-2019-20503)
* [CVE-2020-6796](https://nvd.nist.gov/vuln/detail/CVE-2020-6796)
* [CVE-2020-6797](https://nvd.nist.gov/vuln/detail/CVE-2020-6797)
* [CVE-2020-6798](https://nvd.nist.gov/vuln/detail/CVE-2020-6798)
* [CVE-2020-6799](https://nvd.nist.gov/vuln/detail/CVE-2020-6799)
* [CVE-2020-6800](https://nvd.nist.gov/vuln/detail/CVE-2020-6800)
* [CVE-2020-6805](https://nvd.nist.gov/vuln/detail/CVE-2020-6805)
* [CVE-2020-6806](https://nvd.nist.gov/vuln/detail/CVE-2020-6806)
* [CVE-2020-6807](https://nvd.nist.gov/vuln/detail/CVE-2020-6807)
* [CVE-2020-6811](https://nvd.nist.gov/vuln/detail/CVE-2020-6811)
* [CVE-2020-6812](https://nvd.nist.gov/vuln/detail/CVE-2020-6812)
* [CVE-2020-6814](https://nvd.nist.gov/vuln/detail/CVE-2020-6814)
* [MFSA-2019-37](https://www.mozilla.org/en-US/security/advisories/mfsa2019-37/)
* [MFSA-2020-03](https://www.mozilla.org/en-US/security/advisories/mfsa2020-03/)
* [MFSA-2020-06](https://www.mozilla.org/en-US/security/advisories/mfsa2020-06/)
* [MFSA-2020-09](https://www.mozilla.org/en-US/security/advisories/mfsa2020-09/)

**Release date**

March 12, 2020

**Latest revision**

March 12, 2020: 2

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [702638](https://bugs.gentoo.org/show_bug.cgi?id=702638)
* [705000](https://bugs.gentoo.org/show_bug.cgi?id=705000)
* [709346](https://bugs.gentoo.org/show_bug.cgi?id=709346)
* [712182](https://bugs.gentoo.org/show_bug.cgi?id=712182)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


