=== Content from usn.ubuntu.com_f34c5689_20250119_120022.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-4328-1: Thunderbird vulnerabilities

13 April 2020

Several security issues were fixed in Thunderbird.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 19.10](/security/notices?release=eoan)
* [Ubuntu 18.04 ESM](/security/notices?release=bionic)

## Packages

* [thunderbird](/security/cves?package=thunderbird) - Mozilla Open Source mail and newsgroup client

## Details

It was discovered that Message ID calculation was based on uninitialized

data. An attacker could potentially exploit this to obtain sensitive

information. ([CVE-2020-6792](/security/CVE-2020-6792))

Mutiple security issues were discovered in Thunderbird. If a user were

tricked in to opening a specially crafted message, an attacker could

potentially exploit these to cause a denial of service, obtain sensitive

information, or execute arbitrary code. ([CVE-2020-6793](/security/CVE-2020-6793), [CVE-2020-6795](/security/CVE-2020-6795),

[CVE-2020-6822](/security/CVE-2020-6822))

It was discovered that if a user saved passwords before Thunderbird 60

and then later set a master password, an unencrypted copy of these

passwords would still be accessible. A local user could exploit this to

obtain sensitive information. ([CVE-2020-6794](/security/CVE-2020-6794))

Multiple security issues were discovered in Thunderbird. If a user were

tricked in to opening a specially crafted website in a browsing context,

an attacker could potentially exploit these to cause a denial of service,

conduct cross-site scripting (XSS) attacks, obtain sensitive information,

or execute arbitrary code. ([CVE-2019-20503](/security/CVE-2019-20503), [CVE-2020-6798](/security/CVE-2020-6798), [CVE-2020-6800](/security/CVE-2020-6800),

[CVE-2020-6805](/security/CVE-2020-6805), [CVE-2020-6806](/security/CVE-2020-6806), [CVE-2020-6807](/security/CVE-2020-6807), [CVE-2020-6812](/security/CVE-2020-6812), [CVE-2020-6814](/security/CVE-2020-6814),

[CVE-2020-6819](/security/CVE-2020-6819), [CVE-2020-6820](/security/CVE-2020-6820), [CVE-2020-6821](/security/CVE-2020-6821), [CVE-2020-6825](/security/CVE-2020-6825))

It was discovered that the Devtools’ ‘Copy as cURL’ feature did not

fully escape website-controlled data. If a user were tricked in to using

the ‘Copy as cURL’ feature to copy and paste a command with specially

crafted data in to a terminal, an attacker could potentially exploit this

to execute arbitrary commands via command injection. ([CVE-2020-6811](/security/CVE-2020-6811))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 19.10

* [thunderbird](https://launchpad.net/ubuntu/%2Bsource/thunderbird)
  -
  [1:68.7.0+build1-0ubuntu0.19.10.1](https://launchpad.net/ubuntu/%2Bsource/thunderbird/1%3A68.7.0%2Bbuild1-0ubuntu0.19.10.1)

##### Ubuntu 18.04

* [thunderbird](https://launchpad.net/ubuntu/%2Bsource/thunderbird)
  -
  [1:68.7.0+build1-0ubuntu0.18.04.1](https://launchpad.net/ubuntu/%2Bsource/thunderbird/1%3A68.7.0%2Bbuild1-0ubuntu0.18.04.1)

After a standard system update you need to restart Thunderbird to make

all the necessary changes.

## References

* [CVE-2020-6792](/security/CVE-2020-6792)
* [CVE-2020-6793](/security/CVE-2020-6793)
* [CVE-2020-6794](/security/CVE-2020-6794)
* [CVE-2020-6795](/security/CVE-2020-6795)
* [CVE-2020-6798](/security/CVE-2020-6798)
* [CVE-2020-6800](/security/CVE-2020-6800)
* [CVE-2019-20503](/security/CVE-2019-20503)
* [CVE-2020-6805](/security/CVE-2020-6805)
* [CVE-2020-6806](/security/CVE-2020-6806)
* [CVE-2020-6807](/security/CVE-2020-6807)
* [CVE-2020-6811](/security/CVE-2020-6811)
* [CVE-2020-6812](/security/CVE-2020-6812)
* [CVE-2020-6814](/security/CVE-2020-6814)
* [CVE-2020-6819](/security/CVE-2020-6819)
* [CVE-2020-6820](/security/CVE-2020-6820)
* [CVE-2020-6821](/security/CVE-2020-6821)
* [CVE-2020-6822](/security/CVE-2020-6822)
* [CVE-2020-6825](/security/CVE-2020-6825)

## Related notices

* [USN-4335-1](/security/notices/USN-4335-1)
* [USN-4278-1](/security/notices/USN-4278-1)
* [USN-4278-2](/security/notices/USN-4278-2)
* [USN-4299-1](/security/notices/USN-4299-1)
* [USN-4317-1](/security/notices/USN-4317-1)
* [USN-4323-1](/security/notices/USN-4323-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from security.gentoo.org_984975ef_20250119_115951.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple vulnerabilities — GLSA **202003-02**

Multiple vulnerabilities have been found in Mozilla Firefox, the
worst of which may allow execution of arbitrary code.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **68.6.0** |
| Unaffected versions | >= **68.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **68.6.0** |
| Unaffected versions | >= **68.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla
Project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please
review the CVE identifiers referenced below for details.

### Impact

A remote attacker could entice a user to view a specially crafted web
page, possibly resulting in the execution of arbitrary code with the
privileges of the process or a Denial of Service condition. Furthermore,
a remote attacker may be able to perform Man-in-the-Middle attacks,
obtain sensitive information, spoof the address bar, conduct clickjacking
attacks, bypass security restrictions and protection mechanisms, or have
other unspecified impact.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-68.6.0"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-68.6.0"

```
### References

* [CVE-2019-11745](https://nvd.nist.gov/vuln/detail/CVE-2019-11745)
* [CVE-2019-17005](https://nvd.nist.gov/vuln/detail/CVE-2019-17005)
* [CVE-2019-17008](https://nvd.nist.gov/vuln/detail/CVE-2019-17008)
* [CVE-2019-17010](https://nvd.nist.gov/vuln/detail/CVE-2019-17010)
* [CVE-2019-17011](https://nvd.nist.gov/vuln/detail/CVE-2019-17011)
* [CVE-2019-17012](https://nvd.nist.gov/vuln/detail/CVE-2019-17012)
* [CVE-2019-17016](https://nvd.nist.gov/vuln/detail/CVE-2019-17016)
* [CVE-2019-17017](https://nvd.nist.gov/vuln/detail/CVE-2019-17017)
* [CVE-2019-17022](https://nvd.nist.gov/vuln/detail/CVE-2019-17022)
* [CVE-2019-17024](https://nvd.nist.gov/vuln/detail/CVE-2019-17024)
* [CVE-2019-17026](https://nvd.nist.gov/vuln/detail/CVE-2019-17026)
* [CVE-2019-20503](https://nvd.nist.gov/vuln/detail/CVE-2019-20503)
* [CVE-2020-6796](https://nvd.nist.gov/vuln/detail/CVE-2020-6796)
* [CVE-2020-6797](https://nvd.nist.gov/vuln/detail/CVE-2020-6797)
* [CVE-2020-6798](https://nvd.nist.gov/vuln/detail/CVE-2020-6798)
* [CVE-2020-6799](https://nvd.nist.gov/vuln/detail/CVE-2020-6799)
* [CVE-2020-6800](https://nvd.nist.gov/vuln/detail/CVE-2020-6800)
* [CVE-2020-6805](https://nvd.nist.gov/vuln/detail/CVE-2020-6805)
* [CVE-2020-6806](https://nvd.nist.gov/vuln/detail/CVE-2020-6806)
* [CVE-2020-6807](https://nvd.nist.gov/vuln/detail/CVE-2020-6807)
* [CVE-2020-6811](https://nvd.nist.gov/vuln/detail/CVE-2020-6811)
* [CVE-2020-6812](https://nvd.nist.gov/vuln/detail/CVE-2020-6812)
* [CVE-2020-6814](https://nvd.nist.gov/vuln/detail/CVE-2020-6814)
* [MFSA-2019-37](https://www.mozilla.org/en-US/security/advisories/mfsa2019-37/)
* [MFSA-2020-03](https://www.mozilla.org/en-US/security/advisories/mfsa2020-03/)
* [MFSA-2020-06](https://www.mozilla.org/en-US/security/advisories/mfsa2020-06/)
* [MFSA-2020-09](https://www.mozilla.org/en-US/security/advisories/mfsa2020-09/)

**Release date**

March 12, 2020

**Latest revision**

March 12, 2020: 2

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [702638](https://bugs.gentoo.org/show_bug.cgi?id=702638)
* [705000](https://bugs.gentoo.org/show_bug.cgi?id=705000)
* [709346](https://bugs.gentoo.org/show_bug.cgi?id=709346)
* [712182](https://bugs.gentoo.org/show_bug.cgi?id=712182)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_ff0f8d89_20250119_120026.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-05

## Security Vulnerabilities fixed in Firefox 73

Announced
February 11, 2020
Impact
high
Products
Firefox
Fixed in

* Firefox 73

#### [#CVE-2020-6796: Missing bounds check on shared memory read in the parent process](#CVE-2020-6796)

Reporter
Thomas Imbert
Impact
high
##### Description

A content process could have modified shared memory relating to crash reporting information, crash itself, and cause an out-of-bound write. This could have caused memory corruption and a potentially exploitable crash.

##### References

* [Bug 1610426](https://bugzilla.mozilla.org/show_bug.cgi?id=1610426)

#### [#CVE-2020-6797: Extensions granted downloads.open permission could open arbitrary applications on Mac OSX](#CVE-2020-6797)

Reporter
Vladimir Metnew
Impact
moderate
##### Description

By downloading a file with the .fileloc extension, a semi-privileged extension could launch an arbitrary application on the user's computer. The attacker is restricted as they are unable to download non-quarantined files or supply command line arguments to the application, limiting the impact.
*Note: this issue only occurs on Mac OSX. Other operating systems are unaffected.*

##### References

* [Bug 1596668](https://bugzilla.mozilla.org/show_bug.cgi?id=1596668)

#### [#CVE-2020-6798: Incorrect parsing of template tag could result in JavaScript injection](#CVE-2020-6798)

Reporter
terjanq
Impact
moderate
##### Description

If a `<template>` tag was used in a `<select%gt;` tag, the parser could be confused and allow JavaScript parsing and execution when it should not be allowed. A site that relied on the browser behaving correctly could suffer a cross-site scripting vulnerability as a result.

##### References

* [Bug 1602944](https://bugzilla.mozilla.org/show_bug.cgi?id=1602944)

#### [#CVE-2020-6799: Arbitrary code execution when opening pdf links from other applications, when Firefox is configured as default pdf reader](#CVE-2020-6799)

Reporter
Joshua Graham & Brendan Scarvell
Impact
moderate
##### Description

Command line arguments could have been injected during Firefox invocation as a shell handler for certain unsupported file types. This required Firefox to be configured as the default handler for a given file type and for a file downloaded to be opened in a third party application that insufficiently sanitized URL data. In that situation, clicking a link in the third party application could have been used to retrieve and execute files whose location was supplied through command line arguments.
*Note: This issue only affects Windows operating systems and when Firefox is configured as the default handler for non-default filetypes. Other operating systems are unaffected.*

##### References

* [Bug 1606596](https://bugzilla.mozilla.org/show_bug.cgi?id=1606596)

#### [#CVE-2020-6800: Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](#CVE-2020-6800)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Raul Gurzau, Tyson Smith, Bob Clary, Liz Henry, and Christian Holler reported memory safety bugs present in Firefox 72 and Firefox ESR 68.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777)

#### [#CVE-2020-6801: Memory safety bugs fixed in Firefox 73](#CVE-2020-6801)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Jason Kratzer, Tyson Smith, and Christian Holler reported memory safety bugs present in Firefox 72. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 73](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1601024%2C1601712%2C1604836%2C1606492)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_44adb626_20250119_115951.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Thunderbird: Multiple vulnerabilities — GLSA **202003-10**

Multiple vulnerabilities have been found in Mozilla Thunderbird,
the worst of which could result in the arbitrary execution of code.

### Affected packages

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **68.6.0** |
| Unaffected versions | >= **68.6.0** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **68.6.0** |
| Unaffected versions | >= **68.6.0** |

### Background

Mozilla Thunderbird is a popular open-source email client from the
Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Thunderbird.
Please review the CVE identifiers referenced below for details.

### Impact

A remote attacker may be able to execute arbitrary code, cause a Denial
of Service condition, obtain sensitive information, or conduct Cross-Site
Request Forgery (CSRF).

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-68.6.0"

```

All Mozilla Thunderbird binary users should upgrade to the latest
version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=mail-client/thunderbird-bin-68.6.0"

```
### References

* [MFSA-2019-35](https://www.mozilla.org/en-US/security/advisories/mfsa2019-35/)
* [MFSA-2019-37](https://www.mozilla.org/en-US/security/advisories/mfsa2019-37/)
* [MFSA-2020-07](https://www.mozilla.org/en-US/security/advisories/mfsa2020-07/)
* [MFSA-2020-10](https://www.mozilla.org/en-US/security/advisories/mfsa2020-10/)
* [CVE-2019-11745](https://nvd.nist.gov/vuln/detail/CVE-2019-11745)
* [CVE-2019-11757](https://nvd.nist.gov/vuln/detail/CVE-2019-11757)
* [CVE-2019-11759](https://nvd.nist.gov/vuln/detail/CVE-2019-11759)
* [CVE-2019-11760](https://nvd.nist.gov/vuln/detail/CVE-2019-11760)
* [CVE-2019-11761](https://nvd.nist.gov/vuln/detail/CVE-2019-11761)
* [CVE-2019-11762](https://nvd.nist.gov/vuln/detail/CVE-2019-11762)
* [CVE-2019-11763](https://nvd.nist.gov/vuln/detail/CVE-2019-11763)
* [CVE-2019-11764](https://nvd.nist.gov/vuln/detail/CVE-2019-11764)
* [CVE-2019-17005](https://nvd.nist.gov/vuln/detail/CVE-2019-17005)
* [CVE-2019-17008](https://nvd.nist.gov/vuln/detail/CVE-2019-17008)
* [CVE-2019-17010](https://nvd.nist.gov/vuln/detail/CVE-2019-17010)
* [CVE-2019-17011](https://nvd.nist.gov/vuln/detail/CVE-2019-17011)
* [CVE-2019-17012](https://nvd.nist.gov/vuln/detail/CVE-2019-17012)
* [CVE-2019-20503](https://nvd.nist.gov/vuln/detail/CVE-2019-20503)
* [CVE-2020-6792](https://nvd.nist.gov/vuln/detail/CVE-2020-6792)
* [CVE-2020-6793](https://nvd.nist.gov/vuln/detail/CVE-2020-6793)
* [CVE-2020-6794](https://nvd.nist.gov/vuln/detail/CVE-2020-6794)
* [CVE-2020-6795](https://nvd.nist.gov/vuln/detail/CVE-2020-6795)
* [CVE-2020-6798](https://nvd.nist.gov/vuln/detail/CVE-2020-6798)
* [CVE-2020-6800](https://nvd.nist.gov/vuln/detail/CVE-2020-6800)
* [CVE-2020-6805](https://nvd.nist.gov/vuln/detail/CVE-2020-6805)
* [CVE-2020-6806](https://nvd.nist.gov/vuln/detail/CVE-2020-6806)
* [CVE-2020-6807](https://nvd.nist.gov/vuln/detail/CVE-2020-6807)
* [CVE-2020-6811](https://nvd.nist.gov/vuln/detail/CVE-2020-6811)
* [CVE-2020-6812](https://nvd.nist.gov/vuln/detail/CVE-2020-6812)
* [CVE-2020-6814](https://nvd.nist.gov/vuln/detail/CVE-2020-6814)

**Release date**

March 14, 2020

**Latest revision**

March 14, 2020: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [698516](https://bugs.gentoo.org/show_bug.cgi?id=698516)
* [702638](https://bugs.gentoo.org/show_bug.cgi?id=702638)
* [709350](https://bugs.gentoo.org/show_bug.cgi?id=709350)
* [712518](https://bugs.gentoo.org/show_bug.cgi?id=712518)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.mozilla.org_726b16e0_20250119_120026.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-06

## Security Vulnerabilities fixed in Firefox ESR 68.5

Announced
February 11, 2020
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 68.5

#### [#CVE-2020-6796: Missing bounds check on shared memory read in the parent process](#CVE-2020-6796)

Reporter
Thomas Imbert
Impact
high
##### Description

A content process could have modified shared memory relating to crash reporting information, crash itself, and cause an out-of-bound write. This could have caused memory corruption and a potentially exploitable crash.

##### References

* [Bug 1610426](https://bugzilla.mozilla.org/show_bug.cgi?id=1610426)

#### [#CVE-2020-6797: Extensions granted downloads.open permission could open arbitrary applications on Mac OSX](#CVE-2020-6797)

Reporter
Vladimir Metnew
Impact
moderate
##### Description

By downloading a file with the .fileloc extension, a semi-privileged extension could launch an arbitrary application on the user's computer. The attacker is restricted as they are unable to download non-quarantined files or supply command line arguments to the application, limiting the impact.
*Note: this issue only occurs on Mac OSX. Other operating systems are unaffected.*

##### References

* [Bug 1596668](https://bugzilla.mozilla.org/show_bug.cgi?id=1596668)

#### [#CVE-2020-6798: Incorrect parsing of template tag could result in JavaScript injection](#CVE-2020-6798)

Reporter
terjanq
Impact
moderate
##### Description

If a `<template>` tag was used in a `<select%gt;` tag, the parser could be confused and allow JavaScript parsing and execution when it should not be allowed. A site that relied on the browser behaving correctly could suffer a cross-site scripting vulnerability as a result.

##### References

* [Bug 1602944](https://bugzilla.mozilla.org/show_bug.cgi?id=1602944)

#### [#CVE-2020-6799: Arbitrary code execution when opening pdf links from other applications, when Firefox is configured as default pdf reader](#CVE-2020-6799)

Reporter
Joshua Graham & Brendan Scarvell
Impact
moderate
##### Description

Command line arguments could have been injected during Firefox invocation as a shell handler for certain unsupported file types. This required Firefox to be configured as the default handler for a given file type and for a file downloaded to be opened in a third party application that insufficiently sanitized URL data. In that situation, clicking a link in the third party application could have been used to retrieve and execute files whose location was supplied through command line arguments.
*Note: This issue only affects Windows operating systems and when Firefox is configured as the default handler for non-default filetypes. Other operating systems are unaffected.*

##### References

* [Bug 1606596](https://bugzilla.mozilla.org/show_bug.cgi?id=1606596)

#### [#CVE-2020-6800: Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](#CVE-2020-6800)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Raul Gurzau, Tyson Smith, Bob Clary, Liz Henry, and Christian Holler reported memory safety bugs present in Firefox 72 and Firefox ESR 68.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 73 and Firefox ESR 68.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_abc63474_20250119_115951.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1602944)
* [XML](/show_bug.cgi?ctype=xml&id=1602944)

Closed
[Bug 1602944](/show_bug.cgi?id=1602944)
(CVE-2020-6798)

Opened 5 years ago
Closed 5 years ago

# Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>

## Categories

### (Core :: DOM: HTML Parser, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20HTML%20Parser#DOM%3A%20HTML%20Parser)

DOM: HTML Parser
▾

Core :: DOM: HTML Parser
This system consumes content from the web, parses, validates and builds a content model (document)
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20HTML%20Parser&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20HTML%20Parser&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20HTML%20Parser)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla74

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) |
| firefox72 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix) |
| firefox73 | [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed) |
| firefox74 | [+](/buglist.cgi?f1=cf_tracking_firefox74&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr68 | 73+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox72 |  | wontfix |
| firefox73 | + | fixed |
| firefox74 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: terjanq, Assigned: hsivonen)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/0030426a5e04e85c33fe02480bc4ca81?d=mm&size=40)  [hsivonen](/user_profile?user_id=5490)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/b9542b6c41902e6dbb70023843f01b80?d=mm&size=40)  [terjanq](/user_profile?user_id=628059)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/b89a42ca4c4d59c27f33c399bb1ecc7b?d=mm&size=40)  [farre](/user_profile?user_id=566192)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external, sec-moderate, Whiteboard: [reporter-external] [web-bounty-form] [verif?][post-critsmash-triage][adv-main73+] [adv-esr68.5+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-6798

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [web-bounty-form] [verif?][post-critsmash-triage][adv-main73+] [adv-esr68.5+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a4737436_1689 "5 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [bmaris](/user_profile?user_id=458188) | [qe-verify](#a3256933_458188 "5 years ago") | - |
| --- | --- | --- |
| [bmaris](/user_profile?user_id=458188) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Bug 1602944 - Move setting context to null.](/attachment.cgi?id=9117223)  [5 years ago](#c8)  [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c20 "5 years ago")  RyanVM : [approval-mozilla-esr68+](#c20 "5 years ago") | [Details](/attachment.cgi?id=9117223&action=edit) | [Review](/attachment.cgi?id=9117223) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9122666)  [5 years ago](#c25)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   387 bytes, text/plain |  | [Details](/attachment.cgi?id=9122666&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [terjanq](/user_profile?user_id=628059)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1602944#c0)• 5 years ago |
|  | |

# Description

When doing some fuzzing, I discovered that it is possible to execute scripts inside <select> element when using innerHTML method. The bug is that the parsing gets broken after injecting <template> element.

Generally, no scripts should be executed inside <select> element, and the only allowed tags seem to be <option>, <optgroup>, <script>, <template>. None of these can execute javascript when called through innerHTML, and the bug seems to be only working in the Firefox within browsers that I tested this on.

# Steps

Reproduction steps (Firefox Browser 71.0 (64-bit), Windows 10):

var s = document.createElement('select');

document.body.appendChild(s);

s.innerHTML = '<svg/onload=alert(/wont\_trigger/)></svg><template></template><svg/onload=alert(/will\_trigger/)></svg>'

I also discovered that the issue is very innerHTML specific and will not work when the element is inserted directly through insertAdjacentHTML, document.write() or

<select><template></template><svg onload=alert()></svg></select> as a HTML code.

# Impact

I don't know what's the biggest impact yet, but I fell that there must a serious bug in the parser that allows inserting any HTML after <template></template> when using innerHTML, even if the element could not be put there otherwise.

Flags: sec-bounty?

|  | [terjanq](/user_profile?user_id=628059)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a26_628059)• 5 years ago |

Summary: Possible Mutation XSS or DOM XSS → Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1602944#c1)• 5 years ago |
|  | |

Thank you very much for this report, terjanq! This is really interesting.

My reading of the spec is that `<script>` ought to be allowed in `<select>` but that's not true. So there's one thing.

Then from looking at the current implementation, it seems that HTML parsing when inside a `<select>` is picky about what to allow and what isn't but starts allowing everything once you have inserted `<template></template>`.

I gather the ending template is resetting parser state but doing it incorrectly.

CCing hsivonen for the parser stuff and annevk for the spec bit (mostly out of curiosity)

|  | [terjanq](/user_profile?user_id=628059)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1602944#c2)• 5 years ago |
|  | |

(In reply to Frederik Braun [:freddyb] from [comment #1](/show_bug.cgi?id=1602944#c1 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>"))

> My reading of the spec is that `<script>` ought to be allowed in `<select>` but that's not true. So there's one thing.

Executing `document.write('<select><script>alert()</script></select>')` will trigger an alert, so will when used as a plain HTML `<select><script>alert()</script></select>`. `innerHTML` will also insert a `<script>` tag inside `<select>` element but scripts are not executed when inserted via this method.

Another observation by me is that when calling `document.body.innerHTML = '<select><option>1</option><template></template><svg/onload=alert()></select>'` script will not be executed, so it's strictly related to the case scenario that I discovered.

|  | [April King [:April]](/user_profile?user_id=119354) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a79388_119354)• 5 years ago |

Component: Other → SecurityProduct: Websites → Firefox

|  | [Johann Hofmann [:johannh]](/user_profile?user_id=522029) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a225404_522029)• 5 years ago |

Group: websites-security → core-securityType: task → defectComponent: Security → DOM: HTML ParserProduct: Firefox → Core

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1602944#c3)• 5 years ago |
|  | |

It seems the ending template element resets the state incorrectly and the parser doesn't remember it was inside a `<select>` element.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a235050_159069)• 5 years ago |

Group: core-security → dom-core-security

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1602944#c4)• 5 years ago |
|  | |

Is the problem `<template>` or is this really the same svg-related thing in [bug 1598466](/show_bug.cgi?id=1598466 "REOPENED - mXSS/HTML parser ambiguity with SVG and P nested")?

Flags: needinfo?(hsivonen)

|  | [terjanq](/user_profile?user_id=628059)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1602944#c5)• 5 years ago |
|  | |

The problem is `<select>` and `<template>` related.

```
var s = document.createElement('select');
document.body.appendChild(s);
s.innerHTML = '<template></template><img src=a onerror="alert(/loaded/)"/>'

```

The above also triggers the alert.

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1602944#c6)• 5 years ago |
|  | |

The first and most obvious thing about `template` end tag processing is that the spec has gained an action "generate implied end tags thoroughly" but we only do the old "generate implied end tags" when that's required. That's unlikely to be the problem here, though.

The more likely cause is that the "reset the insertion mode appropriately" algorithm has gained a variable *last* that we don't have.

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a828321_5490)• 5 years ago |

Assignee: nobody → hsivonenStatus: UNCONFIRMED → ASSIGNEDEver confirmed: trueFlags: needinfo?(hsivonen)

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1602944#c7)• 5 years ago |
|  | |

(In reply to Henri Sivonen (:hsivonen) from [comment #6](/show_bug.cgi?id=1602944#c6 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>"))

> The first and most obvious thing about `template` end tag processing is that the spec has gained an action "generate implied end tags thoroughly" but we only do the old "generate implied end tags" when that's required. That's unlikely to be the problem here, though.
>
> The more likely cause is that the "reset the insertion mode appropriately" algorithm has gained a variable *last* that we don't have.

We should also fix these, but since these aren't the root cause, not right before holiday without test cases.

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1602944#c8)• 5 years ago |
|  | |

Attached file
[Bug 1602944 - Move setting context to null.](attachment.cgi?id=9117223)
— [Details](attachment.cgi?id=9117223&action=edit)

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1602944#c9)• 5 years ago |
|  | |

Alphan, if you r+ while I'm away, please also request sec-approval, etc.

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1602944#c10)• 5 years ago |
|  | |

(In reply to Henri Sivonen (:hsivonen) from [comment #7](/show_bug.cgi?id=1602944#c7 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>"))

> (In reply to Henri Sivonen (:hsivonen) from [comment #6](/show_bug.cgi?id=1602944#c6 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>"))
>
> > The first and most obvious thing about `template` end tag processing is that the spec has gained an action "generate implied end tags thoroughly" but we only do the old "generate implied end tags" when that's required. That's unlikely to be the problem here, though.
> >
> > The more likely cause is that the "reset the insertion mode appropriately" algorithm has gained a variable *last* that we don't have.
>
> We should also fix these, but since these aren't the root cause, not right before holiday without test cases.

Filed as [bug 1605364](/show_bug.cgi?id=1605364 "ASSIGNED").

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1602944#c11)• 5 years ago |
|  | |

The priority flag is not set for this bug.

:hsinyi, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_priority.py).

Flags: needinfo?(htsai)

|  | [Hsin-Yi Tsai (she/her) [:hsinyi]](/user_profile?user_id=434964) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a1946916_434964)• 5 years ago |

Flags: needinfo?(htsai)Priority: -- → P2

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1602944#c12)• 5 years ago |
|  | |

Olli, any idea what sort of security rating this should get?

Flags: needinfo?(bugs)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1602944#c13)• 5 years ago |
|  | |

I would say sec-moderate and not sec-high, since in general many event handlers may run when using innerHTML.

Alphan, could you request approval, per [comment 9](/show_bug.cgi?id=1602944#c9 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>").

Flags: needinfo?(bugs) → needinfo?(alchen)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1602944#c14)• 5 years ago |
|  | |

And Hsin-Yi reminded me that sec-moderate doesn't need approval :)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a2044743_39966)• 5 years ago |

Flags: needinfo?(alchen)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1602944#c15)• 5 years ago |
|  | |

And [bug 1562581](/show_bug.cgi?id=1562581 "NEW") is about load event handlers on svg, "I'm pretty sure that this isn't actually a security bug".

RyanVM, I do think this should land to all the branches around the same time. Do you know what is the right procedure for that?

Ask sec-approval and other approvals at the same time? (even though sec-approval isn't strictly needed)

Flags: needinfo?(ryanvm)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1602944#c16)• 5 years ago |
|  | |

If you do the branch approvals up front, you could wait to autoland until they're given (with a comment noting that as the intended plan). From there, uplifts should happen pretty shortly after the patches reach m-c per our usual practices.

That said, we're in RC week at the moment and a new cycle starts on Monday, so you might want to wait a couple weeks if you're worried about an exposure window here.

Flags: needinfo?(ryanvm)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1602944#c17)• 5 years ago |
|  | |

Ah, right. Perhaps hsivonen can then deal with this once he is back in a week or so.

Flags: needinfo?(hsivonen)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a2054850_406194)• 5 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1602944#c18)• 5 years ago |
|  | |

Comment on [attachment 9117223](/attachment.cgi?id=9117223 "Bug 1602944 - Move setting context to null.") [[details]](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.")

[Bug 1602944](/show_bug.cgi?id=1602944 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>") - Move setting context to null.

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: A template in select can confuse the parser, so a site that relies on the browser behaving correctly could in theory suffer XSS. However, in practice, it's unlikely that a site with proper XSS-avoidance mechanisms would be affected.
* **User impact if declined**: Small possibility of XSS.
* **Fix Landed on Version**: Not yet landed; see [comment 15](/show_bug.cgi?id=1602944#c15 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>")
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Very low risk. Nulling out a couple of fields is deferred.
* **String or UUID changes made by this patch**: None.

### Beta/Release Uplift Approval Request

* **User impact if declined**: A template in select can confuse the parser, so a site that relies on the browser behaving correctly could in theory suffer XSS. However, in practice, it's unlikely that a site with proper XSS-avoidance mechanisms would be affected.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: Very low risk. Nulling out a couple of fields is deferred.
* **String changes made/needed**: None.
Flags: needinfo?(hsivonen)
[Attachment #9117223](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.") -
Flags: approval-mozilla-esr68?
[Attachment #9117223](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.") -
Flags: approval-mozilla-beta?

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1602944#c19)• 5 years ago |
|  | |

(In reply to Olli Pettay [:smaug] from [comment #14](/show_bug.cgi?id=1602944#c14 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>"))

> And Hsin-Yi reminded me that sec-moderate doesn't need approval :)

Not requesting sec-approval due to this.

(In reply to Olli Pettay [:smaug] from [comment #15](/show_bug.cgi?id=1602944#c15 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>"))

> I do think this should land to all the branches around the same time.

Requesting branch approval in advance due to this.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1602944#c20)• 5 years ago |
|  | |

Comment on [attachment 9117223](/attachment.cgi?id=9117223 "Bug 1602944 - Move setting context to null.") [[details]](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.")

[Bug 1602944](/show_bug.cgi?id=1602944 "RESOLVED FIXED - Possible Mutation XSS or DOM XSS in innerHTML method due to incorrect parsing <template>") - Move setting context to null.

Fixes a sec issue, approved for 73.0b5 and 68.5esr. Let's hold off on uplifting until this merges to m-c, though.

[Attachment #9117223](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.") -
Flags: approval-mozilla-esr68?
[Attachment #9117223](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.") -
Flags: approval-mozilla-esr68+
[Attachment #9117223](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.") -
Flags: approval-mozilla-beta?
[Attachment #9117223](/attachment.cgi?id=9117223&action=edit "Bug 1602944 - Move setting context to null.") -
Flags: approval-mozilla-beta+

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1602944#c21)• 5 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/c7545f9cfe8f64a53400054f703b05989f90ada7>

<https://hg.mozilla.org/mozilla-central/rev/c7545f9cfe8f>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 5 years ago
[status-firefox74](/buglist.cgi?f1=cf_status_firefox74&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla74

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1602944#c22)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/8c63ea54dd6b>

[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix)
[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox73](/buglist.cgi?f1=cf_tracking_firefox73&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B)
[tracking-firefox74](/buglist.cgi?f1=cf_tracking_firefox74&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox74&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1602944#c23)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr68/rev/3b3f5444c547>

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)

|  | [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1602944#c24)• 5 years ago |
|  | |

<https://hg.mozilla.org/projects/htmlparser/rev/bf1dd019d127e946af4a2baeab20352eae860897>

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a3256933_458188)• 5 years ago |

Flags: qe-verify-Whiteboard: [reporter-external] [web-bounty-form] [verif?] → [reporter-external] [web-bounty-form] [verif?][post-critsmash-triage]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a3778169_578488)• 5 years ago |

Whiteboard: [reporter-external] [web-bounty-form] [verif?][post-critsmash-triage] → [reporter-external] [web-bounty-form] [verif?][post-critsmash-triage][adv-main73+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a3778453_578488)• 5 years ago |

Whiteboard: [reporter-external] [web-bounty-form] [verif?][post-critsmash-triage][adv-main73+] → [reporter-external] [web-bounty-form] [verif?][post-critsmash-triage][adv-main73+] [adv-esr68.5+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1602944#c25)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9122666)
— [Details](attachment.cgi?id=9122666&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a4737436_1689)• 5 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a5333654_578488)• 5 years ago |

Alias: CVE-2020-6798

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a15327192_1689)• 5 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1602944#a141073409_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1602944&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Henri Sivonen (:hsivonen)](/user_profile?user_id=5490)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_73f8d6fa_20250119_134445.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.mozilla.org_0c6a373f_20250119_120027.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-07

## Security Vulnerabilities fixed in Thunderbird 68.5

Announced
February 11, 2020
Impact
moderate
Products
Thunderbird
Fixed in

* Thunderbird 68.5

#### [#CVE-2020-6793: Out-of-bounds read when processing certain email messages](#CVE-2020-6793)

Reporter
Chiaki ISHIKAWA
Impact
moderate
##### Description

When processing an email message with an ill-formed envelope, Thunderbird could read data from a random memory location.

##### References

* [Bug 1608539](https://bugzilla.mozilla.org/show_bug.cgi?id=1608539)

#### [#CVE-2020-6794: Setting a master password post-Thunderbird 52 does not delete unencrypted previously stored passwords](#CVE-2020-6794)

Reporter
Jurgen Gaeremyn
Impact
moderate
##### Description

If a user saved passwords before Thunderbird 60 and then later set a master password, an unencrypted copy of these passwords is still accessible. This is because the older stored password file was not deleted when the data was copied to a new format starting in Thunderbird 60. The new master password is added only on the new file. This could allow the exposure of stored password data outside of user expectations.

##### References

* [Bug 1606619](https://bugzilla.mozilla.org/show_bug.cgi?id=1606619)

#### [#CVE-2020-6795: Crash processing S/MIME messages with multiple signatures](#CVE-2020-6795)

Reporter
Stephan Lauffer
Impact
moderate
##### Description

When processing a message that contains multiple S/MIME signatures, a bug in the MIME processing code caused a null pointer dereference, leading to an unexploitable crash.

##### References

* [Bug 1611105](https://bugzilla.mozilla.org/show_bug.cgi?id=1611105)

#### [#CVE-2020-6797: Extensions granted downloads.open permission could open arbitrary applications on Mac OSX](#CVE-2020-6797)

Reporter
Vladimir Metnew
Impact
moderate
##### Description

By downloading a file with the .fileloc extension, a semi-privileged extension could launch an arbitrary application on the user's computer. The attacker is restricted as they are unable to download non-quarantined files or supply command line arguments to the application, limiting the impact.
*Note: this issue only occurs on Mac OSX. Other operating systems are unaffected.*

##### References

* [Bug 1596668](https://bugzilla.mozilla.org/show_bug.cgi?id=1596668)

#### [#CVE-2020-6798: Incorrect parsing of template tag could result in JavaScript injection](#CVE-2020-6798)

Reporter
terjanq
Impact
moderate
##### Description

If a `<template>` tag was used in a `<select%gt;` tag, the parser could be confused and allow JavaScript parsing and execution when it should not be allowed. A site that relied on the browser behaving correctly could suffer a cross-site scripting vulnerability as a result.
*In general, this flaw cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but is potentially a risk in browser or browser-like contexts.*

##### References

* [Bug 1602944](https://bugzilla.mozilla.org/show_bug.cgi?id=1602944)

#### [#CVE-2020-6792: Message ID calculcation was based on uninitialized data](#CVE-2020-6792)

Reporter
Chiaki ISHIKAWA
Impact
low
##### Description

When deriving an identifier for an email message, uninitialized memory was used in addition to the message contents.

##### References

* [Bug 1609607](https://bugzilla.mozilla.org/show_bug.cgi?id=1609607)

#### [#CVE-2020-6800: Memory safety bugs fixed in Thunderbird 68.5](#CVE-2020-6800)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers and community members Raul Gurzau, Tyson Smith, Bob Clary, Liz Henry, and Christian Holler reported memory safety bugs present in Firefox 72 and Firefox ESR 68.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.
*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

##### References

* [Memory safety bugs fixed in Firefox 73, Firefox ESR 68.5, and Thunderbird 68.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1595786%2C1596706%2C1598543%2C1604851%2C1608580%2C1608785%2C1605777)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from usn.ubuntu.com_65cb1c48_20250119_120025.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-4335-1: Thunderbird vulnerabilities

21 April 2020

Several security issues were fixed in Thunderbird.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 16.04 ESM](/security/notices?release=xenial)

## Packages

* [thunderbird](/security/cves?package=thunderbird) - Mozilla Open Source mail and newsgroup client

## Details

Multiple security issues were discovered in Thunderbird. If a user were

tricked in to opening a specially crafted website in a browsing context,

an attacker could potentially exploit these to cause a denial of service,

obtain sensitive information, bypass security restrictions, bypass

same-origin restrictions, conduct cross-site scripting (XSS) attacks, or

execute arbitrary code. ([CVE-2019-11757](/security/CVE-2019-11757), [CVE-2019-11758](/security/CVE-2019-11758), [CVE-2019-11759](/security/CVE-2019-11759),

[CVE-2019-11760](/security/CVE-2019-11760), [CVE-2019-11761](/security/CVE-2019-11761), [CVE-2019-11762](/security/CVE-2019-11762), [CVE-2019-11763](/security/CVE-2019-11763),

[CVE-2019-11764](/security/CVE-2019-11764), [CVE-2019-17005](/security/CVE-2019-17005), [CVE-2019-17008](/security/CVE-2019-17008), [CVE-2019-17010](/security/CVE-2019-17010),

[CVE-2019-17011](/security/CVE-2019-17011), [CVE-2019-17012](/security/CVE-2019-17012), [CVE-2019-17016](/security/CVE-2019-17016), [CVE-2019-17017](/security/CVE-2019-17017),

[CVE-2019-17022](/security/CVE-2019-17022), [CVE-2019-17024](/security/CVE-2019-17024), [CVE-2019-17026](/security/CVE-2019-17026), [CVE-2019-20503](/security/CVE-2019-20503),

[CVE-2020-6798](/security/CVE-2020-6798), [CVE-2020-6800](/security/CVE-2020-6800), [CVE-2020-6805](/security/CVE-2020-6805), [CVE-2020-6806](/security/CVE-2020-6806), [CVE-2020-6807](/security/CVE-2020-6807),

[CVE-2020-6812](/security/CVE-2020-6812), [CVE-2020-6814](/security/CVE-2020-6814), [CVE-2020-6819](/security/CVE-2020-6819), [CVE-2020-6820](/security/CVE-2020-6820), [CVE-2020-6821](/security/CVE-2020-6821),

[CVE-2020-6825](/security/CVE-2020-6825))

It was discovered that NSS incorrectly handled certain memory operations.

A remote attacker could potentially exploit this to cause a denial of

service, or execute arbitrary code. ([CVE-2019-11745](/security/CVE-2019-11745))

It was discovered that a specially crafted S/MIME message with an inner

encryption layer could be displayed as having a valid signature in some

circumstances, even if the signer had no access to the encrypted message.

An attacker could potentially exploit this to spoof the message author.

([CVE-2019-11755](/security/CVE-2019-11755))

A heap overflow was discovered in the expat library in Thunderbird. If a

user were tricked in to opening a specially crafted message, an attacker

could potentially exploit this to cause a denial of service, or execute

arbitrary code. ([CVE-2019-15903](/security/CVE-2019-15903))

It was discovered that Message ID calculation was based on uninitialized

data. An attacker could potentially exploit this to obtain sensitive

information. ([CVE-2020-6792](/security/CVE-2020-6792))

Mutiple security issues were discovered in Thunderbird. If a user were

tricked in to opening a specially crafted message, an attacker could

potentially exploit these to cause a denial of service, obtain sensitive

information, or execute arbitrary code. ([CVE-2020-6793](/security/CVE-2020-6793), [CVE-2020-6795](/security/CVE-2020-6795),

[CVE-2020-6822](/security/CVE-2020-6822))

It was discovered that if a user saved passwords before Thunderbird 60 and

then later set a primary password, an unencrypted copy of these passwords

would still be accessible. A local user could exploit this to obtain

sensitive information. ([CVE-2020-6794](/security/CVE-2020-6794))

It was discovered that the Devtools’ ‘Copy as cURL’ feature did not

fully escape website-controlled data. If a user were tricked in to using

the ‘Copy as cURL’ feature to copy and paste a command with specially

crafted data in to a terminal, an attacker could potentially exploit this

to execute arbitrary commands via command injection. ([CVE-2020-6811](/security/CVE-2020-6811))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 16.04

* [thunderbird](https://launchpad.net/ubuntu/%2Bsource/thunderbird)
  -
  [1:68.7.0+build1-0ubuntu0.16.04.2](https://launchpad.net/ubuntu/%2Bsource/thunderbird/1%3A68.7.0%2Bbuild1-0ubuntu0.16.04.2)

After a standard system update you need to restart Thunderbird to make

all the necessary changes.

## References

* [CVE-2019-11745](/security/CVE-2019-11745)
* [CVE-2019-11755](/security/CVE-2019-11755)
* [CVE-2019-11757](/security/CVE-2019-11757)
* [CVE-2019-11758](/security/CVE-2019-11758)
* [CVE-2019-11759](/security/CVE-2019-11759)
* [CVE-2019-11760](/security/CVE-2019-11760)
* [CVE-2019-11761](/security/CVE-2019-11761)
* [CVE-2019-11762](/security/CVE-2019-11762)
* [CVE-2019-11763](/security/CVE-2019-11763)
* [CVE-2019-11764](/security/CVE-2019-11764)
* [CVE-2019-15903](/security/CVE-2019-15903)
* [CVE-2019-17005](/security/CVE-2019-17005)
* [CVE-2019-17008](/security/CVE-2019-17008)
* [CVE-2019-17010](/security/CVE-2019-17010)
* [CVE-2019-17011](/security/CVE-2019-17011)
* [CVE-2019-17012](/security/CVE-2019-17012)
* [CVE-2019-17016](/security/CVE-2019-17016)
* [CVE-2019-17017](/security/CVE-2019-17017)
* [CVE-2019-17022](/security/CVE-2019-17022)
* [CVE-2019-17024](/security/CVE-2019-17024)
* [CVE-2019-17026](/security/CVE-2019-17026)
* [CVE-2019-20503](/security/CVE-2019-20503)
* [CVE-2020-6792](/security/CVE-2020-6792)
* [CVE-2020-6793](/security/CVE-2020-6793)
* [CVE-2020-6794](/security/CVE-2020-6794)
* [CVE-2020-6795](/security/CVE-2020-6795)
* [CVE-2020-6798](/security/CVE-2020-6798)
* [CVE-2020-6800](/security/CVE-2020-6800)
* [CVE-2020-6805](/security/CVE-2020-6805)
* [CVE-2020-6806](/security/CVE-2020-6806)
* [CVE-2020-6807](/security/CVE-2020-6807)
* [CVE-2020-6811](/security/CVE-2020-6811)
* [CVE-2020-6812](/security/CVE-2020-6812)
* [CVE-2020-6814](/security/CVE-2020-6814)
* [CVE-2020-6819](/security/CVE-2020-6819)
* [CVE-2020-6820](/security/CVE-2020-6820)
* [CVE-2020-6821](/security/CVE-2020-6821)
* [CVE-2020-6822](/security/CVE-2020-6822)
* [CVE-2020-6825](/security/CVE-2020-6825)

## Related notices

* [USN-4216-2](/security/notices/USN-4216-2)
* [USN-4216-1](/security/notices/USN-4216-1)
* [USN-4241-1](/security/notices/USN-4241-1)
* [USN-4203-1](/security/notices/USN-4203-1)
* [USN-4203-2](/security/notices/USN-4203-2)
* [USN-4202-1](/security/notices/USN-4202-1)
* [USN-4165-1](/security/notices/USN-4165-1)
* [USN-4132-2](/security/notices/USN-4132-2)
* [USN-4132-1](/security/notices/USN-4132-1)
* [USN-4852-1](/security/notices/USN-4852-1)
* [USN-5455-1](/security/notices/USN-5455-1)
* [USN-7199-1](/security/notices/USN-7199-1)
* [USN-4234-1](/security/notices/USN-4234-1)
* [USN-4328-1](/security/notices/USN-4328-1)
* [USN-4299-1](/security/notices/USN-4299-1)
* [USN-4278-1](/security/notices/USN-4278-1)
* [USN-4278-2](/security/notices/USN-4278-2)
* [USN-4317-1](/security/notices/USN-4317-1)
* [USN-4323-1](/security/notices/USN-4323-1)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from bugzilla.mozilla.org_d031a228_20250119_134447.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1596668)
* [XML](/show_bug.cgi?ctype=xml&id=1596668)

Closed
[Bug 1596668](/show_bug.cgi?id=1596668)
(CVE-2020-6797)

Opened 5 years ago
Closed 5 years ago

# Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files

## Categories

### (Firefox :: File Handling, defect, P1)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
▾

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=File%20Handling#File%20Handling)

File Handling
▾

Firefox :: File Handling
For issues dealing with helper applications, and guessing Content Types when they aren't specified/known (ftp:, file:, jar:, but generally not http:). This component does not cover: backend networking issues, such as those covered by Networking: FTP or Networking: File, nor does it cover the Download Manager which has its own component in the Toolkit product.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=File%20Handling&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=File%20Handling)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

Firefox 74

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified) |
| firefox72 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix) |
| firefox73 | [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=verified) |
| firefox74 | [+](/buglist.cgi?f1=cf_tracking_firefox74&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr68 | 73+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox72 |  | wontfix |
| firefox73 | + | verified |
| firefox74 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: vladimirmetnew, Assigned: Gijs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/c735e81990ce93d78a069c5fbc5ab37d?d=mm&size=40)  [vladimirmetnew](/user_profile?user_id=570698)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/66445733c06687eafa2978764675104f?d=mm&size=40)  [Gijs](/user_profile?user_id=159069)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-priv-escalation, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main73+] [adv-esr68.5+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-6797

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?][adv-main73+] [adv-esr68.5+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c31 "5 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [firefox-extension-fileloc.zip](/attachment.cgi?id=9108939)  [5 years ago](#c0)  [Vladimir Metnew](/user_profile?user_id=570698)   3.86 KB, application/zip |  | [Details](/attachment.cgi?id=9108939&action=edit) |
| --- | --- | --- |
| [Bug 1596668, r?spohl](/attachment.cgi?id=9117703)  [5 years ago](#c20)  [:Gijs (he/him)](/user_profile?user_id=159069)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c32 "5 years ago")  RyanVM : [approval-mozilla-esr68+](#c41 "5 years ago") | [Details](/attachment.cgi?id=9117703&action=edit) | [Review](/attachment.cgi?id=9117703) |
| [advisory.txt](/attachment.cgi?id=9122662)  [5 years ago](#c44)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   490 bytes, text/plain |  | [Details](/attachment.cgi?id=9122662&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1596668#c0)• 5 years ago |
|  | |

Attached file
[firefox-extension-fileloc.zip](attachment.cgi?id=9108939)
— [Details](attachment.cgi?id=9108939&action=edit)

FF Version: 70.0.1

macOS: 10.15.1 (19B88)

1. .fileloc files behave on macOS similarly to .url files on Windows - as shortcuts that can execute local apps.
2. A malicious extension with `downloads/downloads.open` permissions can download a .fileloc file + execute it to launch arbitrary local apps.
3. It looks like a non-secure feature of macOS(that I'm going to report), so it's not clear what'd be your opinion. I guess you'd like to add this file to your file handling mechanism as well.

PoC opens Calculator.app on Catalina.

Flags: sec-bounty?

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1596668#c1)• 5 years ago |
|  | |

Shane, under what circumstances are webextensions *supposed* to be able to execute arbitrary local executables? I assume that addons with native messaging can already do this, and maybe others?

Component: Security → File HandlingFlags: needinfo?(mixedpuppy)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1596668#c2)• 5 years ago |
|  | |

In fact, let's move this to webextensions for now. I imagine this issue doesn't just affect fileloc files, and/or if it does, that whatever lists other "dangerous" things should be what's listing this, not core Firefox code. We can always move it back if there's shared code being used that I'm not aware of.

Component: File Handling → UntriagedProduct: Firefox → WebExtensions

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1596668#c3)• 5 years ago |
|  | |

I'm unable to reproduce this on osx 10.14 with release or nightly. We need to find someone with 10.15 to verify.

After fixing the app path in the popup js file, when I use the extension to download then click the "run" button, the file is opened in textedit.

I am able to use the downloaded x.fileloc from Finder and the command line to open an application.

*The downloads.open API merely calls launch on the download, so if this were to work, it should work without an extension involved at all.* Just download a fileloc file somewhere and open it from the downloads panel.

Vladimir, does opening the downloaded file from the downloads panel also work for opening the app?

[1] <https://searchfox.org/mozilla-central/rev/131338e5017bc0283d86fb73844407b9a2155c98/toolkit/components/extensions/parent/ext-downloads.js#951>

[2] <https://searchfox.org/mozilla-central/rev/131338e5017bc0283d86fb73844407b9a2155c98/toolkit/components/downloads/DownloadCore.jsm#734>

[3] <https://searchfox.org/mozilla-central/rev/131338e5017bc0283d86fb73844407b9a2155c98/toolkit/components/downloads/DownloadIntegration.jsm#721>

Flags: needinfo?(vladimirmetnew)

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1596668#c4)• 5 years ago |
|  | |

Alexandru, could you verify this bug?

Assignee: nobody → acornestean

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1596668#c5)• 5 years ago |
|  | |

(In reply to Shane Caraveo (:mixedpuppy) from [comment #3](/show_bug.cgi?id=1596668#c3 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> Just download a fileloc file somewhere and open it from the downloads panel.

As a note, doing this on 10.14 resulted in the same behavior, from the downloads panel it opened the file in textedit, but I could use the downloaded file via Finder to open the app.

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a306826_372685)• 5 years ago |

Flags: needinfo?(mixedpuppy)

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a306879_372685)• 5 years ago |

Flags: needinfo?(mixedpuppy)

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1596668#c6)• 5 years ago |
|  | |

> Vladimir, does opening the downloaded file from the downloads panel also work for opening the app?

Yeah, it's a macOS shortcut file and FF basically calls `open` on this file. It works for opening the app.

Default handler for .fileloc is Finder.app. Try to rebuild launchservices database, if .fileloc gets opened in TextEdit.app on your device. (might damage your macOS setup preferences) Or run macOS VM.

I setup a macOS in VM and tried to repro this again: it works. Screencast - <https://drive.google.com/open?id=103he_74WHflyVLv9IxydOwGY9ewyhxJ1>

Flags: needinfo?(vladimirmetnew)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a563593_1689)• 5 years ago |

Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1596668#c7)• 5 years ago |
|  | |

Given the extension api uses the underlying libraries, and that this happens as well from the downloads panel, I'm moving back in to file handling component.

Component: Untriaged → File HandlingFlags: needinfo?(mixedpuppy)Product: WebExtensions → Firefox

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a1145208_159069)• 5 years ago |

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1596668#c8)• 5 years ago |
|  | |

Talked to Marco about this. It seems we should:

1. add fileloc to the list of executable extensions (and make sure those get checked on mac, as we use the executable bit at the moment) and/or hardcode a check in nsLocalFileUnix that returns true only for this type of file
2. ensure we show the executable warning based on that, and require user interaction (that last part should already be happening)

Note that at least on my 10.14 machine, the `file:///System/Applications` path does not exist, which might be why the testcase doesn't work. Though the extension also fails to install for me ("extension does not contain a valid manifest").

Shane, can you confirm this seems right to you? (Also, any idea why the add-on is not installing?)

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(mixedpuppy)

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1596668#c9)• 5 years ago |
|  | |

file:///System/Applications exists only on Catalina. (different partition, additional security measure)

You can change /System to / and it will work on Mojave as well.

> (Also, any idea why the add-on is not installing?)
>
> Probably, an issue in my code? I ctrl+c'ed the addon from FF examples on github, it may miss somethings

|  | [Rob Wu [:robwu]](/user_profile?user_id=447061) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1596668#c10)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #8](/show_bug.cgi?id=1596668#c8 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> Though the extension also fails to install for me ("extension does not contain a valid manifest").

How are you trying to install the add-on? A zip file can only be loaded directly via `about:debugging` if manifest.json is a top-level file in the zip file.

In the attached test case, it is inside a subdirectory. So to test the add-on, you need to extract the zip file and load the directory via `about:debugging`.

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1596668#c11)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #8](/show_bug.cgi?id=1596668#c8 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> Talked to Marco about this. It seems we should:
>
> 1. add fileloc to the list of executable extensions (and make sure those get checked on mac, as we use the executable bit at the moment) and/or hardcode a check in nsLocalFileUnix that returns true only for this type of file
> 2. ensure we show the executable warning based on that, and require user interaction (that last part should already be happening)
>
> Note that at least on my 10.14 machine, the `file:///System/Applications` path does not exist, which might be why the testcase doesn't work. Though the extension also fails to install for me ("extension does not contain a valid manifest").

I changed that in my testing to point at a valid location for an application.

> Shane, can you confirm this seems right to you? (Also, any idea why the add-on is not installing?)

Yeah, that seems like a good approach.

Flags: needinfo?(mixedpuppy)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1596668#c12)• 5 years ago |
|  | |

I'm going to steal this to implement [comment #8](/show_bug.cgi?id=1596668#c8 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files").

Assignee: acornestean → gijskruitbosch+bugsStatus: NEW → ASSIGNEDType: task → defect

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1596668#c13)• 5 years ago |
|  | |

JFYI I’ve heard Chrome is going to deprecate downloads.open and make it an alias to downloads.show

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1596668#c14)• 5 years ago |
|  | |

(In reply to Vladimir Metnew from [comment #13](/show_bug.cgi?id=1596668#c13 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> JFYI I’ve heard Chrome is going to deprecate downloads.open and make it an alias to downloads.show

Thanks for the heads-up. Is there a public reference for this plan?

This feels like something in Shane's wheelhouse again... :-)

Flags: needinfo?(vladimirmetnew)Flags: needinfo?(mixedpuppy)

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1596668#c15)• 5 years ago |
|  | |

> Thanks for the heads-up. Is there a public reference for this plan?

No, I submitted the same bug to Chrome, and I've just accidentally recalled they had been discussing this option to deprecate `downloads.open` behavior.

Completely not an official reference :)

Flags: needinfo?(vladimirmetnew)

|  | [Shane Caraveo (:mixedpuppy)](/user_profile?user_id=372685) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1596668#c16)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #14](/show_bug.cgi?id=1596668#c14 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> This feels like something in Shane's wheelhouse again... :-)

Bouncing that hot potato back to you. This can be done via the downloads panel itself, so it should be fixed (per [comment 8](/show_bug.cgi?id=1596668#c8 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files")). As well, we don't deprecate APIs overnight, and if this is being deprecated it's likely part of manifest v3.

Flags: needinfo?(mixedpuppy)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1596668#c17)• 5 years ago |
|  | |

(In reply to Shane Caraveo (:mixedpuppy) from [comment #16](/show_bug.cgi?id=1596668#c16 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> (In reply to :Gijs (he/him) from [comment #14](/show_bug.cgi?id=1596668#c14 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
>
> > This feels like something in Shane's wheelhouse again... :-)
>
> Bouncing that hot potato back to you. This can be done via the downloads panel itself, so it should be fixed (per [comment 8](/show_bug.cgi?id=1596668#c8 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files")). As well, we don't deprecate APIs overnight, and if this is being deprecated it's likely part of manifest v3.

To be clear, I'm still going to fix this as discussed. I was just pinging you about the deprecation stuff. Sorry for the brevity-induced lack of clarity.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1596668#c18)• 5 years ago |
|  | |

The priority flag is not set for this bug.

:Gijs, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_priority.py).

Flags: needinfo?(gijskruitbosch+bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a1835661_159069)• 5 years ago |

Flags: needinfo?(gijskruitbosch+bugs)Priority: -- → P1

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1596668#c19)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1596668&comment_id=14564014 "1 revision") |
|  | |

After adding `fileloc` to the list of dangerous extensions, I get the expected prompt when using the downloads panel.

However, either way Calculator does not open (testing on Mojave) - instead, the file gets opened by textedit... I see the same thing on older Firefoxes (ie it's using textedit rather than opening the app). Unsure why I'm seeing different behaviour - OP, did you actually test on Mojave with Firefox? Perhaps something got changed wrt fileloc files on Catalina? Because when I open the file "manually" from Finder, Calculator.app appears in the dock but bounces forever. Opening calculator normally (via spotlight) works fine...

Flags: needinfo?(vladimirmetnew)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1596668#c20)• 5 years ago |
|  | |

Attached file
[Bug 1596668, r?spohl](attachment.cgi?id=9117703)
— [Details](attachment.cgi?id=9117703&action=edit)

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1596668#c21)• 5 years ago |
|  | |

See PoC screencast I've recorded before I've submitted this bug : <https://drive.google.com/open?id=103he_74WHflyVLv9IxydOwGY9ewyhxJ1>

It worked fine on macOS 10.15.1 for me

Flags: needinfo?(vladimirmetnew)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1596668#c22)• 5 years ago |
|  | |

(In reply to Vladimir Metnew from [comment #21](/show_bug.cgi?id=1596668#c21 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> See PoC screencast I've recorded before I've submitted this bug : <https://drive.google.com/open?id=103he_74WHflyVLv9IxydOwGY9ewyhxJ1>
>
> It worked fine on macOS 10.15.1 for me

Sure, I'm not doubting that it works for you in 10.15. But I don't have 10.15 available right now, and you asserted in [comment #9](/show_bug.cgi?id=1596668#c9 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files") that it works on Mojave. I'm just asking, have you actually tested Mojave? The bug is valid either way, and it's fine if you don't have access to 10.14 - but for my sanity it'd be nice to understand if I'm doing something wrong, or if there's some difference between 10.14 and 10.15 here. I tried rebuilding the launch services database, that didn't make any difference.

Flags: needinfo?(vladimirmetnew)

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1596668#c23)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #22](/show_bug.cgi?id=1596668#c22 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> (In reply to Vladimir Metnew from [comment #21](/show_bug.cgi?id=1596668#c21 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
>
> > See PoC screencast I've recorded before I've submitted this bug : <https://drive.google.com/open?id=103he_74WHflyVLv9IxydOwGY9ewyhxJ1>
> >
> > It worked fine on macOS 10.15.1 for me
>
> Sure, I'm not doubting that it works for you in 10.15. But I don't have 10.15 available right now, and you asserted in [comment #9](/show_bug.cgi?id=1596668#c9 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files") that it works on Mojave. I'm just asking, have you actually tested Mojave? The bug is valid either way, and it's fine if you don't have access to 10.14 - but for my sanity it'd be nice to understand if I'm doing something wrong, or if there's some difference between 10.14 and 10.15 here. I tried rebuilding the launch services database, that didn't make any difference.

I observed a few cases when Calculator spins infinitely. But in this case, the binary is still mapped and executed in memory properly.

Try to change shortcut's URL to `file:///usr/bin/sudo` and launch via downloads.open -> Terminal.app popups and sudo outputs its help page. seems like a valid proof of the file execution

So yeah, there is no difference in OS version, because the binary is actually executed. but tbf I don't know why Calculator sometimes spins and grabs only 8K memory. Might be related to some macOS features

Flags: needinfo?(vladimirmetnew)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1596668#c24)• 5 years ago |
|  | |

(In reply to Vladimir Metnew from [comment #23](/show_bug.cgi?id=1596668#c23 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> (In reply to :Gijs (he/him) from [comment #22](/show_bug.cgi?id=1596668#c22 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
>
> > (In reply to Vladimir Metnew from [comment #21](/show_bug.cgi?id=1596668#c21 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
> >
> > > See PoC screencast I've recorded before I've submitted this bug : <https://drive.google.com/open?id=103he_74WHflyVLv9IxydOwGY9ewyhxJ1>
> > >
> > > It worked fine on macOS 10.15.1 for me
> >
> > Sure, I'm not doubting that it works for you in 10.15. But I don't have 10.15 available right now, and you asserted in [comment #9](/show_bug.cgi?id=1596668#c9 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files") that it works on Mojave. I'm just asking, have you actually tested Mojave? The bug is valid either way, and it's fine if you don't have access to 10.14 - but for my sanity it'd be nice to understand if I'm doing something wrong, or if there's some difference between 10.14 and 10.15 here. I tried rebuilding the launch services database, that didn't make any difference.
>
> I observed a few cases when Calculator spins infinitely.

To be clear, this is what I see if I open the file from Finder. From Firefox, all I can see is it opening in textedit.

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1596668#c25)• 5 years ago |
|  | |

(In reply to :Gijs (back Jan 2; he/him) from [comment #24](/show_bug.cgi?id=1596668#c24 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> (In reply to Vladimir Metnew from [comment #23](/show_bug.cgi?id=1596668#c23 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
>
> > (In reply to :Gijs (he/him) from [comment #22](/show_bug.cgi?id=1596668#c22 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
> >
> > > (In reply to Vladimir Metnew from [comment #21](/show_bug.cgi?id=1596668#c21 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
> > >
> > > > See PoC screencast I've recorded before I've submitted this bug : <https://drive.google.com/open?id=103he_74WHflyVLv9IxydOwGY9ewyhxJ1>
> > > >
> > > > It worked fine on macOS 10.15.1 for me
> > >
> > > Sure, I'm not doubting that it works for you in 10.15. But I don't have 10.15 available right now, and you asserted in [comment #9](/show_bug.cgi?id=1596668#c9 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files") that it works on Mojave. I'm just asking, have you actually tested Mojave? The bug is valid either way, and it's fine if you don't have access to 10.14 - but for my sanity it'd be nice to understand if I'm doing something wrong, or if there's some difference between 10.14 and 10.15 here. I tried rebuilding the launch services database, that didn't make any difference.
> >
> > I observed a few cases when Calculator spins infinitely.
>
> To be clear, this is what I see if I open the file from Finder. From Firefox, all I can see is it opening in textedit.

not sure why it happens to you now

I guess it might be an additional patch from Apple

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1596668#c26)• 5 years ago |
|  | |

:spohl, unsure if this is review request is showing up in your queue, so just checking! :-)

Flags: needinfo?(spohl.mozilla.bugs)

|  | [Stephen A Pohl [:spohl]](/user_profile?user_id=456485) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1596668#c27)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #26](/show_bug.cgi?id=1596668#c26 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> :spohl, unsure if this is review request is showing up in your queue, so just checking! :-)

It was in my queue but I didn't get a notification and I would probably have missed it. Thank you for pinging me!

Flags: needinfo?(spohl.mozilla.bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1596668#c28)• 5 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/bee05acc3ce7b56e5840e27a178262ff9a87a637>

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1596668#c29)• 5 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/bee05acc3ce7>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 5 years ago
[status-firefox74](/buglist.cgi?f1=cf_status_firefox74&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → Firefox 74

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1596668#c30)• 5 years ago |
|  | |

Comment on [attachment 9117703](/attachment.cgi?id=9117703 "Bug 1596668, r?spohl") [[details]](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl")

[Bug 1596668](/show_bug.cgi?id=1596668 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), r?spohl

### Beta/Release Uplift Approval Request

* **User impact if declined**: Security issue
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: On a macOS 10.15 machine:

1. download the add-on attached to the bug
2. unzip it
3. open the build you're testing
4. navigate to about:debugging
5. install a temporary add-on from there
6. find the manifest.json file and pick that
7. using the add-on's toolbar button, first download and then open the file

ER:

a warning dialog about it being a dangerous file

pre patch:

No warning dialog

* **List of other uplifts needed**: n/a
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: trivial patch to a hardcoded list of file extensions that only affects macOS
* **String changes made/needed**: nope
[Attachment #9117703](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl") -
Flags: approval-mozilla-beta?

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a5128919_159069)• 5 years ago |

Flags: qe-verify+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1596668#c31)• 5 years ago |
|  | |

Do .fileloc files support arguments? I was thinking like windows .lnk files, but .url files don't. Launching existing programs without arguments isn't likely too dangerous. On the other hand if you have downloads.open permission could you download two files? One an executable .app that we won't let you open, and then a .fileloc to launch it? You'd have to guess the user's download directory, though. Maybe WebExtensions can figure that out already in other ways (would have to investigate).

Flags: sec-bounty? → sec-bounty+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1596668#c32)• 5 years ago |
|  | |

Comment on [attachment 9117703](/attachment.cgi?id=9117703 "Bug 1596668, r?spohl") [[details]](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl")

[Bug 1596668](/show_bug.cgi?id=1596668 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), r?spohl

Approved for 73.0b5. Should we take this on ESR too?

Flags: needinfo?(gijskruitbosch+bugs)
[Attachment #9117703](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1596668#c33)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/ebdbfe7bcbbd>

[status-firefox72](/buglist.cgi?f1=cf_status_firefox72&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox72&o1=equals&v1=wontfix)
[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=%3F)
[tracking-firefox73](/buglist.cgi?f1=cf_tracking_firefox73&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox73&o1=equals&v1=%2B)
[tracking-firefox74](/buglist.cgi?f1=cf_tracking_firefox74&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox74&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1596668#c34)• 5 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #32](/show_bug.cgi?id=1596668#c32 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> Comment on [attachment 9117703](/attachment.cgi?id=9117703 "Bug 1596668, r?spohl") [[details]](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl")
>
> [Bug 1596668](/show_bug.cgi?id=1596668 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), r?spohl
>
> Approved for 73.0b5. Should we take this on ESR too?

We could, I think. Stephen, does that sound right to you? I don't see any issue with it (that'd suggest e.g. waiting a cycle to make sure there's no breakage) but wanted to doublecheck.

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(spohl.mozilla.bugs)

|  | [Stephen A Pohl [:spohl]](/user_profile?user_id=456485) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1596668#c35)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #34](/show_bug.cgi?id=1596668#c34 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> (In reply to Ryan VanderMeulen [:RyanVM] from [comment #32](/show_bug.cgi?id=1596668#c32 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))
>
> > Comment on [attachment 9117703](/attachment.cgi?id=9117703 "Bug 1596668, r?spohl") [[details]](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl")
> >
> > [Bug 1596668](/show_bug.cgi?id=1596668 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), r?spohl
> >
> > Approved for 73.0b5. Should we take this on ESR too?
>
> We could, I think. Stephen, does that sound right to you? I don't see any issue with it (that'd suggest e.g. waiting a cycle to make sure there's no breakage) but wanted to doublecheck.

This seems like a good ESR candidate due to the low risk of breakage.

Flags: needinfo?(spohl.mozilla.bugs)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1596668#c36)• 5 years ago |
|  | |

Comment on [attachment 9117703](/attachment.cgi?id=9117703 "Bug 1596668, r?spohl") [[details]](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl")

[Bug 1596668](/show_bug.cgi?id=1596668 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), r?spohl

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: sec-moderate
* **User impact if declined**: see above
* **Fix Landed on Version**: 74
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: tiny patch just adding an extension to a list
* **String or UUID changes made by this patch**: nope
[Attachment #9117703](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl") -
Flags: approval-mozilla-esr68?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a5168922_75935)• 5 years ago |

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=%3F) → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=%3F) → [73+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=73%2B)

|  | [Bogdan Maris, Desktop Test Engineering](/user_profile?user_id=458188) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a5180454_458188)• 5 years ago |

QA Whiteboard: [qa-triaged]

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1596668#c37)• 5 years ago |
|  | |

I've managed to reproduce the issue using the steps from [comment 30](/show_bug.cgi?id=1596668#c30 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), on Firefox 72.0.

The issue is not reproducing anymore on Beta 73.0b5 and Nightly 74.0a1 under macOS 10.13.6. Ni? myself as a reminder to verify this on esr68 too, once it lands.

[status-firefox73](/buglist.cgi?f1=cf_status_firefox73&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox73&o1=equals&v1=verified)
[status-firefox74](/buglist.cgi?f1=cf_status_firefox74&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox74&o1=equals&v1=verified)Flags: needinfo?(ciprian.georgiu)

|  | [:Gijs (he/him)](/user_profile?user_id=159069)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1596668#c38)• 5 years ago |
|  | |

(In reply to Ciprian Georgiu [:ciprian\_georgiu], Release Desktop QA from [comment #37](/show_bug.cgi?id=1596668#c37 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> I've managed to reproduce the issue using the steps from [comment 30](/show_bug.cgi?id=1596668#c30 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), on Firefox 72.0.
>
> The issue is not reproducing anymore on Beta 73.0b5 and Nightly 74.0a1 under macOS 10.13.6.

I'm a bit surprised; I specifically asked to check macOS 10.15. Where did you reproduce the issue with 72, and can you doublecheck you see the expected results on 10.15 as well?

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1596668#c39)• 5 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #38](/show_bug.cgi?id=1596668#c38 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> I'm a bit surprised; I specifically asked to check macOS 10.15. Where did you reproduce the issue with 72, and can you doublecheck you see the expected results on 10.15 as well?

I was able to reproduce it on macOS 10.13.6 (I did not realize that this required a specific OS X version to be verified, since I've managed to see the issue on older versions).

I got the same results on macOS 10.15.1 as well, the warning dialog is correctly displayed using the same Firefox builds as per my previous comment.

|  | [Vladimir Metnew](/user_profile?user_id=570698)  Reporter |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1596668#c40)• 5 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #31](/show_bug.cgi?id=1596668#c31 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"))

> Do .fileloc files support arguments? I was thinking like windows .lnk files, but .url files don't. Launching existing programs without arguments isn't likely too dangerous. On the other hand if you have downloads.open permission could you download two files? One an executable .app that we won't let you open, and then a .fileloc to launch it? You'd have to guess the user's download directory, though. Maybe WebExtensions can figure that out already in other ways (would have to investigate).

No, .fileloc files don't support arguments :(

See my slides for a detailed impact description and additional research of macOS file quarantine issues - <https://docs.google.com/presentation/d/19WeQbqc_OKnrSv1I3Z4sm-oNAf6IVzHwRyQP4i9Bv_Y/edit?usp=sharing>

> you have downloads.open permission
>
> (Un)Luckily, to execute arbitrary code attacker needs:

* either to somehow plant a "launchable" file (`open` of which triggers code execution) with a quarantine meta attribute. This scenario is possible by sharing a file via Dropbox/OneDrive/<other\_cloud\_storage>. see my slides for a full list of these files and similar vulnerabilities (e.g., Keybase vuln)
* or to download + downloads.open `.app` + downloads.open it again + user needs to confirm GateKeeper dialog -> unrealistic scenario

I don't consider cases when File Quarantine is intentionally disabled, because in this case a single downloads.open on .terminal files leads to code execution.

Also, all utils except web browsers and sandboxed apps don't apply file quarantine at all. Files from brew/git aren't quarantined.

*In theory*, attacker can start some macOS-native binary which (for example) starts a local server and increase attack surface (or even exploit some OS vuln right from the web). But that's probably not a FF issue

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1596668#c41)• 5 years ago |
|  | |

Comment on [attachment 9117703](/attachment.cgi?id=9117703 "Bug 1596668, r?spohl") [[details]](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl")

[Bug 1596668](/show_bug.cgi?id=1596668 "VERIFIED FIXED - Firefox for macOS: extensions with downloads.open permission can execute code on the device using .fileloc files"), r?spohl

Approved for 68.5esr also.

[Attachment #9117703](/attachment.cgi?id=9117703&action=edit "Bug 1596668, r?spohl") -
Flags: approval-mozilla-esr68? → approval-mozilla-esr68+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1596668#c42)• 5 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr68/rev/27f71a0b7aa2>

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1596668#c43)• 5 years ago |
|  | |

Verified fixed as well on 68.5.0esr under macOS 10.15.1 and 10.13.6.

Status: RESOLVED → VERIFIED
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified)Flags: qe-verify+Flags: needinfo?(ciprian.georgiu)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a5991429_578488)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?][adv-main73+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a5991822_578488)• 5 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?][adv-main73+] → [reporter-external] [client-bounty-form] [verif?][adv-main73+] [adv-esr68.5+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1596668#c44)• 5 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9122662)
— [Details](attachment.cgi?id=9122662&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a7546932_578488)• 5 years ago |

Alias: CVE-2020-6798

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a7547060_578488)• 5 years ago |

Alias: CVE-2020-6798 → CVE-2020-6797

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a17540616_1689)• 5 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1596668#a143286795_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1596668&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Vladimir Metnew](/user_profile?user_id=570698)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_2210cd17_20250119_134445.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)


