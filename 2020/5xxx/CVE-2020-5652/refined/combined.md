=== Content from www.mitsubishielectric.com_2e71e656_20250119_122217.html ===
Denial-of-Service Vulnerability
in Ethernet Port on CPU Module of MELSEC iQ-R, Q and L Series

Release  date:  October  29,  2020
Last update date: September 5, 2024
Mitsubishi Electric Corporation

Overview

Mitsubishi  Electric  is  aware  of  a  denial-of-service  (DoS)  vulnerability  in  MELSEC  iQ-R,  Q  and  L  series  CPU  modules  due  to
uncontrolled resource consumption. When the CPU module receives a specially crafted packet from a malicious attacker, Ethernet
communication may enter a DoS condition. (CVE-2020-5652)
The product models, firmware versions, operating system versions and serial number affected by this vulnerability are listed below.

CVSS1

CVE-2020-5652  CVSS:3.0/AV: N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

Base Score:7.5

Affected products

The following MELSEC iQ-R, Q and L series CPU modules are affected:

Series
iQ-R Series

Q Series

L Series

Model name
R00/01/02CPU
R04/08/16/32/120(EN) CPU
R08/16/32/120SFCPU
R08/16/32/120PCPU
R08/16/32/120PSFCPU
R16/32/64MTCPU
Q03UDECPU, Q04/06/10/13/20/26/50/100UDEHCPU
Q03/04/06/13/26UDVCPU
Q04/06/13/26UDPVCPU
Q172/173DCPU-S1
Q172/173DSCPU
Q170MCPU
Q170MSCPU(-S1)
MR-MQ100 (*)
L02/06/26CPU(-P), L26CPU-(P)BT

Version
firmware versions "20" and prior
firmware versions "52" and prior
firmware versions "22" and prior
firmware versions "24" and prior
firmware versions "06" and prior
operating system software versions "21" and prior
The first 5 digits of serial number "22081" and prior
The first 5 digits of serial number "22031" and prior
The first 5 digits of serial number "22031" and prior
operating system software versions "V" and prior
operating system software versions "W" and prior
operating system software versions "V" and prior
operating system software versions "W" and prior
operating system software versions "E" and prior
The first 5 digits of serial number "23121" and prior

(*) This product is sold in limited regions.

For information on checking the firmware version, the operating system software version or the serial number, please refer to the
manual for the affected product.
Please download the manual from the following URL.

https://www.mitsubishielectric.com/fa/download/index.html

Description

A denial-of-service (DoS) vulnerability due to uncontrolled resource consumption (CWE-400)2  exists in MELSEC iQ-R, Q and L
series CPU modules.

Impact

When the CPU module receives a specially crafted packet from a malicious attacker, Ethernet communication function may enter a
DoS condition, and a reset is required to recover it.

1  https://www.first.org/cvss/v3.1/specification-document
2  https://cwe.mitre.org/data/definitions/400.html

  1  /  3

Countermeasures for Customers

Refer to the table below to check if the version of your product is updatable.

Series
iQ-R Series

Q Series

L Series

Model name
R00/01/02CPU
R04/08/16/32/120(EN)CPU
R08/16/32/120SFCPU
R08/16/32/120PCPU
R08/16/32/120PSFCPU
R16/32/64MTCPU
Q03UDECPU, Q04/06/10/13/20/26/50/100UDEHCPU
Q03/04/06/13/26UDVCPU
Q04/06/13/26UDPVCPU
Q172/173DCPU-S1
Q172/173DSCPU
Q170MCPU
Q170MSCPU(-S1)
MR-MQ100
L02/06/26CPU(-P), L26CPU-(P)BT

Update availability
Refer to “Appendix 2 Firmware Update Function”
in  the  MELSEC  iQ-R  Module  Configuration
Manual.

Updatable in all versions.
Not updatable in any version.

Updatable in all versions.

Not updatable in any version.

<In case your product is updatable>
Download a fixed update file from the following site and update the firmware or operating system software.

https://www.mitsubishielectric.com/fa/download/index.html

Refer to below for detail on updating.
-
-
-
-
-
-

“Appendix 2 Firmware Update Function” in the MELSEC iQ-R Module Configuration Manual
“8.4 Installing the Operating System Software” in the MELSEC iQ-R Motion Controller Programing Manual (Common)
“5.3 Operating System Software Installation Procedure” in the Q173D(S)/Q172(S)CPU Motion Controller User’s Manual
“5.3 Operating System Software Installation Procedure” in the Q170MCPU Motion Controller User’s Manual
“5.3 Operating System Software Installation Procedure” in the Q170MSCPU Motion Controller User’s Manual
“5.3 Operating System Software Installation Procedure” in the MR-MQ100 Motion Controller User’s Manual (Details)

<In case your product is not updatable>
Take the following Mitigations / Workarounds.
We have released the fixed version as shown in “Countermeasures for Products”, but updating the product to the fixed version is not
available.
If you are using the affected MELSEC Q and L series products, please consider switching to the succeeding MELSEC iQ-R series.

Countermeasures for Products
The following modules have been fixed.

Series
iQ-R Series

Q Series

L Series

Model name
R00/01/02CPU
R04/08/16/32/120(EN)CPU
R08/16/32/120SFCPU
R08/16/32/120PCPU
R08/16/32/120PSFCPU
R16/32/64MTCPU
Q03UDECPU, Q04/06/10/13/20/26/50/100UDEHCPU
Q03/04/06/13/26UDVCPU
Q04/06/13/26UDPVCPU
Q172/173DCPU-S1
Q172/173DSCPU
Q170MCPU
Q170MSCPU(-S1)
MR-MQ100
L02/06/26CPU(-P), L26CPU-(P)BT

Version
firmware versions "21" or later
firmware versions "53" or later
firmware versions "23" or later
firmware versions "25" or later
firmware versions "07" or later
operating system software versions "22" or later
The first 5 digits of serial number "22082" or later
The first 5 digits of serial number "22032" or later
The first 5 digits of serial number "22032" or later
operating system software versions "W" or later
operating system software versions "X" or later
operating system software versions "W" or later
operating system software versions "X" or later
operating system software versions "F" or later
The first 5 digits of serial number "23122" or later

Mitigations / Workarounds

Mitsubishi  Electric  recommends  that  customers  take  the  following  mitigation  measures  to  minimize  the  risk  of  exploiting  this
vulnerability:
-  Use a firewall or virtual private network (VPN), etc. to prevent unauthorized access when Internet access is required.
-  Use within a LAN and block access from untrusted networks and hosts through firewalls.

  2  /  3

Acknowledgement

Mitsubishi Electric would like to thank joker63 of ZheJiangQiAnTechnology who reported this vulnerability.

Contact information

Please contact your local Mitsubishi Electric representative.

Update history
September 5, 2024

Added Operating system version and serial number in “Overview”.
“Countermeasures” divided into “Countermeasures for Customers“ and "Countermeasures for Products".
Corrected the firmware version of R 08/16/32/120 PCPU in “Affected products” and “Countermeasures for Products”.
Added R08/16/32/10 PSFCPU in “Affected products” and “Countermeasures for Products”.
Added annotation for MR-MQ100 in “Affected products”.

December 19, 2023

Added the Acknowledgement.

March 29, 2022

Added the information of modules that have been fixed to “Affected products” and “Countermeasures”.

January 13, 2022

Added modules that have been fixed to “Countermeasures”.

May 18, 2021

Added R 08/16/32/120 PCPU that has been fixed to “Countermeasures”.
R 08/16/32/120 PSFCPU has been deleted from “Affected products”.

  3  /  3



=== Content from jvn.jp_50396e02_20250119_122213.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

å¬éæ¥ï¼2020/10/29ãæçµæ´æ°æ¥ï¼2024/09/05
# JVNVU#96558207 ä¸è±é»æ©è£½ MELSEC iQ-RãQ ããã³ L ã·ãªã¼ãºã«ããããªã½ã¼ã¹æ¯æ¸ã®èå¼±æ§

## æ¦è¦

ä¸è±é»æ©æ ªå¼ä¼ç¤¾ãæä¾ãã MELSEC iQ-RãQ ããã³ L ã·ãªã¼ãºã® CPU ã¦ãããã«ã¯ããªã½ã¼ã¹æ¯æ¸ã®èå¼±æ§ãå­å¨ãã¾ãã

## å½±é¿ãåããã·ã¹ãã

MELSEC iQ-RãQ ããã³ L ã·ãªã¼ãºã® CPU ã¦ãããã®ãã¡ãæ¬¡ã®è£½åå½¢åã¨ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ãæ¬ä½ OS ã½ããã¦ã§ã¢ãã¼ã¸ã§ã³ããã³ã·ãªã¢ã« No. ã®ãã®ãå½±é¿ãåãã¾ãã

* iQ-Rã·ãªã¼ãº
  + R00/01/02CPU ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "20" ããã³ããä»¥å
  + R04/08/16/32/120(EN)CPU ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "52" ããã³ããä»¥å
  + R08/16/32/120SFCPU ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "22" ããã³ããä»¥å
  + R08/16/32/120PCPU ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "24" ããã³ããä»¥å
  + R08/16/32/120PSFCPU ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "06" ããã³ããä»¥å
  + R16/32/64MTCPU æ¬ä½ OS ã½ããã¦ã§ã¢ãã¼ã¸ã§ã³ "21" ããã³ããä»¥å
* Qã·ãªã¼ãº
  + Q03UDECPU ããã³ Q04/06/10/13/20/26/50/100UDEHCPU ã·ãªã¢ã« No. ã®ä¸ 5æ¡ã "22081" ããã³ããä»¥å
  + Q03/04/06/13/26UDVCPU ã·ãªã¢ã« No. ã®ä¸ 5æ¡ã "22031" ããã³ããä»¥å
  + Q04/06/13/26UDPVCPU ã·ãªã¢ã« No. ã®ä¸ 5æ¡ã "22031" ããã³ããä»¥å
  + Q172/173DCPU-S1 æ¬ä½ OS ã½ããã¦ã§ã¢ãã¼ã¸ã§ã³ "V" ããã³ããä»¥å
  + Q172/173DSCPU æ¬ä½ OS ã½ããã¦ã§ã¢ãã¼ã¸ã§ã³ "W" ããã³ããä»¥å
  + Q170MCPU æ¬ä½ OS ã½ããã¦ã§ã¢ãã¼ã¸ã§ã³ "V" ããã³ããä»¥å
  + Q170MSCPU(-S1) æ¬ä½ OS ã½ããã¦ã§ã¢ãã¼ã¸ã§ã³ "W" ããã³ããä»¥å
  + MR-MQ100 æ¬ä½OSã½ããã¦ã§ã¢ãã¼ã¸ã§ã³ "E" ããã³ããä»¥å (\*æµ·å¤ä¸é¨å°åå°ç¨å)
* Lã·ãªã¼ãº
  + L02/06/26CPU(-P) ããã³ L26CPU-(P)BT ã·ãªã¢ã« No. ã®ä¸ 5æ¡ã "23121" ããã³ããä»¥å

ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ãæ¬ä½ OS ã½ããã¦ã§ã¢ãã¼ã¸ã§ã³ãã·ãªã¢ã« No. ç­ã®ç¢ºèªæ¹æ³ã«ã¤ãã¦ã¯ãéçºèãæä¾ããåè£½åã®ããã¥ã¢ã«ãç¢ºèªãã¦ãã ãããããã¥ã¢ã«ã¯ã[ãã¦ã³ã­ã¼ã | ä¸è±é»æ©FA](https://www.mitsubishielectric.co.jp/fa/download/index.html)ããå¥æã§ãã¾ãã

## è©³ç´°æå ±

ä¸è±é»æ©æ ªå¼ä¼ç¤¾ãæä¾ãã MELSEC iQ-RãQ ããã³ L ã·ãªã¼ãºã® CPU ã¦ãããã«ã¯ããªã½ã¼ã¹æ¯æ¸ã®èå¼±æ§ ([CWE-400](https://cwe.mitre.org/data/definitions/400.html)) ãå­å¨ãã¾ãã

## æ³å®ãããå½±é¿

é éã®ç¬¬ä¸èã«ãã£ã¦ç´°å·¥ããããã±ãããåä¿¡ããã¨ãEthernet éä¿¡ããµã¼ãã¹éç¨å¦¨å®³ (DoS) ç¶æã¨ãªãå¯è½æ§ãããã¾ãã

ãªããå¾©æ§ã«ã¯ãªã»ãããå¿è¦ã§ãã

## å¯¾ç­æ¹æ³

**ã¢ãããã¼ããã**

éçºèãæä¾ããæå ±ããã¨ã«ãã¢ãããã¼ããå¯è½ãå¦ããç¢ºèªãã¦ãã ããã

ã¢ãããã¼ããå¯è½ãªå ´åã¯ã[ãã¦ã³ã­ã¼ã | ä¸è±é»æ©FA](https://www.mitsubishielectric.co.jp/fa/download/index.html)ããå¯¾ç­æ¸ã¿ãã¼ã¸ã§ã³ã®ã¢ãããã¼ããã¡ã¤ã«ããã¦ã³ã­ã¼ãããã¢ãããã¼ããã¦ãã ããã

ã¢ãããã¼ãæ¹æ³ã®è©³ç´°ã¯ãéçºèãæä¾ããæ¬¡ã®ããã¥ã¢ã«ãåç§ãã¦ãã ããã

* MELSEC iQ-R ã¦ãããæ§æããã¥ã¢ã« ãä» 2 ãã¡ã¼ã ã¦ã§ã¢ã¢ãããã¼ãæ©è½ã
* MELSEC iQ-R ã¢ã¼ã·ã§ã³ã³ã³ãã­ã¼ã© ãã­ã°ã©ãã³ã°ããã¥ã¢ã«(å±éç·¨) ã8.4 æ¬ä½OSã½ããã¦ã§ã¢ã®ã¤ã³ã¹ãã¼ã«ã
* Q173D(S)CPU/Q172D(S)CPU ã¢ã¼ã·ã§ã³ã³ã³ãã­ã¼ã© ã¦ã¼ã¶ã¼ãºããã¥ã¢ã« ã5.3 æ¬ä½OSã½ããã¦ã§ã¢ã®ã¤ã³ã¹ãã¼ã«æé ã
* Q170MCPU ã¢ã¼ã·ã§ã³ã³ã³ãã­ã¼ã© ã¦ã¼ã¶ã¼ãºããã¥ã¢ã« ã5.3 æ¬ä½OSã½ããã¦ã§ã¢ã®ã¤ã³ã¹ãã¼ã«æé ã
* Q170MSCPU(-S1) ã¢ã¼ã·ã§ã³ã³ã³ãã­ã¼ã© ã¦ã¼ã¶ã¼ãºããã¥ã¢ã« ã5.3 æ¬ä½OSã½ããã¦ã§ã¢ã®ã¤ã³ã¹ãã¼ã«æé ã
* MR-MQ100 Motion Controller User’s Manual (Details) ã5.3 Operating System Software Installation Procedureã

**ã¯ã¼ã¯ã¢ã©ã¦ã³ããå®æ½ãã**

ã¢ãããã¼ããé©ç¨ã§ããªãå ´åã«ã¯ãæ¬¡ã®åé¿ç­ãé©ç¨ãããã¨ã§ãæ¬èå¼±æ§ã®å½±é¿ãè»½æ¸ãããã¨ãå¯è½ã§ãã

* å½è©²è£½åãã¤ã³ã¿ã¼ãããã«æ¥ç¶ããå ´åã«ã¯ããã¡ã¤ã¢ã¦ã©ã¼ã«ãä»®æ³ãã©ã¤ãã¼ããããã¯ã¼ã¯ (VPN) ãªã©ãä½¿ç¨ãã
* å½è©²è£½åã LAN åã§ã®ä½¿ç¨ã«éå®ããä¿¡é ¼ã§ããªããããã¯ã¼ã¯ããã¹ãããã®ã¢ã¯ã»ã¹ãå¶éãã

**å¾ç¶è£½åã¸ã®ç§»è¡ãæ¤è¨ãã**

MELSEC Q ã·ãªã¼ãºããã³ L ã·ãªã¼ãºã§ã¢ãããã¼ãå¯¾è±¡å¤ã®å ´åãæ¬èå¼±æ§ã®å¯¾ç­ãããã¦ãã MELSEC iQ-R ã·ãªã¼ãºã¸ã®ç§»è¡ãããã¨ãæ¬èå¼±æ§ã®å½±é¿ã¯åãã¾ããã

è©³ããã¯ã[éçºèãæä¾ããæå ±](https://www.mitsubishielectric.co.jp/psirt/vulnerability/pdf/2020-013.pdf)ãåç§ãã¦ãã ããã

## ãã³ãæå ±

| ãã³ã | ãªã³ã¯ |
| --- | --- |
| ä¸è±é»æ©æ ªå¼ä¼ç¤¾ | [MELSEC iQ-RãQããã³Lã·ãªã¼ãºCPUã¦ãããã® Ethernetãã¼ãã«ããããµã¼ãã¹æå¦(DoS)ã®èå¼±æ§](https://www.mitsubishielectric.co.jp/psirt/vulnerability/pdf/2020-013.pdf) |

## åèæå ±

1. [ICS Advisory (ICSA-20-303-01)](https://us-cert.cisa.gov/ics/advisories/icsa-20-303-01)
   Mitsubishi Electric MELSEC iQ-R, Q and L Series

## JPCERT/CCããã®è£è¶³æå ±

## JPCERT/CCã«ããèå¼±æ§åæçµæ

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
åºæ¬å¤:
7.5

| æ»æååºå(AV) | ç©ç (P) | ã­ã¼ã«ã« (L) | é£æ¥ (A) | ãããã¯ã¼ã¯ (N) |
| --- | --- | --- | --- | --- |
| æ»ææ¡ä»¶ã®è¤éã(AC) | é« (H) | ä½ (L) |
| å¿è¦ãªç¹æ¨©ã¬ãã«(PR) | é« (H) | ä½ (L) | ä¸è¦ (N) |
| ã¦ã¼ã¶é¢ä¸ã¬ãã«(UI) | è¦ (R) | ä¸è¦ (N) |
| ã¹ã³ã¼ã(S) | å¤æ´ãªã (U) | å¤æ´ãã (C) |
| æ©å¯æ§ã¸ã®å½±é¿(C) | ãªã (N) | ä½ (L) | é« (H) |
| å®å¨æ§ã¸ã®å½±é¿(I) | ãªã (N) | ä½ (L) | é« (H) |
| å¯ç¨æ§ã¸ã®å½±é¿(A) | ãªã (N) | ä½ (L) | é« (H) |

## è¬è¾

ãã®èå¼±æ§æå ±ã¯ãè£½åå©ç¨èã¸ã®å¨ç¥ãç®çã«ãéçºèã JPCERT/CC ã«å ±åããJPCERT/CC ãéçºèã¨ã®èª¿æ´ãè¡ãã¾ããã

## é¢é£ææ¸

| JPCERT ç·æ¥å ±å |  |
| --- | --- |
| JPCERT REPORT |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2020-5652](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5652) |
| JVN iPedia |  |

## æ´æ°å±¥æ­´

2020/10/30
ï¼»åèæå ±ï¼½ã« ICS Advisory ã®ãªã³ã¯ãè¿½å ãã¾ãã
2021/05/18
ï¼»å½±é¿ãåããã·ã¹ãã ï¼½ã¨ï¼»å¯¾ç­æ¹æ³ï¼½ãæ´æ°ãã¾ãã
2022/01/13
ï¼»å½±é¿ãåããã·ã¹ãã ï¼½ã¨ï¼»å¯¾ç­æ¹æ³ï¼½ãæ´æ°ãã¾ãã
2022/03/29
ï¼»å½±é¿ãåããã·ã¹ãã ï¼½ã¨ï¼»å¯¾ç­æ¹æ³ï¼½ãæ´æ°ãã¾ãã
2024/09/05
ï¼»å½±é¿ãåããã·ã¹ãã ï¼½ã¨ï¼»å¯¾ç­æ¹æ³ï¼½ãæ´æ°ãã¾ãã

* ![JVN](/common/img/t_rnav_jvn.gif)
* [![HOME](/common/img/r_nav_1.gif)](/index.html)
* [![JVNã¨ã¯](/common/img/r_nav_2.gif)](/nav/jvn.html)
* [![èå¼±æ§ã¬ãã¼ãã®èª­ã¿æ¹](/common/img/r_nav_3.gif)](/nav/jvnhelp.html)
* [![èå¼±æ§ã¬ãã¼ãä¸è¦§](/common/img/r_nav_4.gif)](/report/index.html)
* [![VN_JP](/common/img/r_nav_4_1.gif)](/jp/index.html)
* [![VN_JPï¼é£çµ¡ä¸è½ï¼](/common/img/r_nav_4_4.gif)](/adj/index.html)
* [![VN_VU](/common/img/r_nav_4_2.gif)](/vu/index.html)
* [![VN_TA](/common/img/r_nav_4_3.gif)](/ta/index.html)
* [![TRnotes](/common/img/r_nav_5.gif)](/tr/index.html)
* [![JVN iPedia](/common/img/r_nav_10.gif)](http://jvndb.jvn.jp/)
* [![MyJVN](/common/img/r_nav_10_4.gif)](http://jvndb.jvn.jp/apis/myjvn/index.html)
* [![JVNJS/RSS](/common/img/r_nav_6.gif)](/rss/index.html)
* [![ãã³ãæå ±ä¸è¦§](/common/img/r_nav_7.gif)](/nav/index.html)
* [![é£çµ¡ä¸è½éçºèä¸è¦§](/common/img/r_nav_11.gif)](/reply/index.html)
* [![èå¼±æ§æå ±ã®å±åº](/common/img/r_nav_8.gif)](http://www.ipa.go.jp/security/vuln/report/)
* [![ãååãå](/common/img/r_nav_9.gif)](/contact/index.html)

Copyright (c) 2000-2024 JPCERT/CC and IPA. All rights reserved.


