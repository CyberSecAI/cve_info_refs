=== Content from portswigger.net_4ebaf4bd_20250119_133548.html ===


[Login](/users)

Products

Solutions

[Research](/research)
[Academy](/web-security)
Support

Company

[Customers](/customers)
[About](/about)
[Blog](/blog)
[Careers](/careers)
[Legal](/legal)
[Contact](/contact)
[Resellers](/support/reseller-faqs)

[My account](/users/youraccount)
[Customers](/customers)
[About](/about)
[Blog](/blog)
[Careers](/careers)
[Legal](/legal)
[Contact](/contact)
[Resellers](/support/reseller-faqs)
[![Burp Suite Enterprise Edition](/content/images/svg/icons/enterprise.svg)
**Burp Suite Enterprise Edition**
The enterprise-enabled dynamic web vulnerability scanner.](/burp/enterprise)
[![Burp Suite Professional](/content/images/svg/icons/professional.svg)
**Burp Suite Professional**
The world's #1 web penetration testing toolkit.](/burp/pro)
[![Burp Suite Community Edition](/content/images/svg/icons/community.svg)
**Burp Suite Community Edition**
The best manual tools to start web security testing.](/burp/communitydownload)
[![Dastardly, from Burp Suite](/mega-nav/images/dastardly.svg)
**Dastardly, from Burp Suite**
Free, lightweight web application security scanning for CI/CD.](/burp/dastardly)
[View all product editions](/burp)

[**Burp Scanner**

Burp Suite's web vulnerability scanner

![Burp Suite's web vulnerability scanner'](/mega-nav/images/burp-suite-scanner.jpg)](/burp/vulnerability-scanner)

[**Attack surface visibility**
Improve security posture, prioritize manual testing, free up time.](/solutions/attack-surface-visibility)
[**CI-driven scanning**
More proactive security - find and fix vulnerabilities earlier.](/solutions/ci-driven-scanning)
[**Application security testing**
See how our software enables the world to secure the web.](/solutions)
[**DevSecOps**
Catch critical bugs; ship more secure software, more quickly.](/solutions/devsecops)
[**Penetration testing**
Accelerate penetration testing - find more bugs, more quickly.](/solutions/penetration-testing)
[**Automated scanning**
Scale dynamic scanning. Reduce risk. Save time/money.](/solutions/automated-security-testing)
[**Bug bounty hunting**
Level up your hacking and earn more bug bounties.](/solutions/bug-bounty-hunting)
[**Compliance**
Enhance security monitoring to comply with confidence.](/solutions/compliance)

[View all solutions](/solutions)

[**Product comparison**

What's the difference between Pro and Enterprise Edition?

![Burp Suite Professional vs Burp Suite Enterprise Edition](/mega-nav/images/burp-suite.jpg)](/burp/enterprise/resources/enterprise-edition-vs-professional)

[**Support Center**
Get help and advice from our experts on all things Burp.](/support)
[**Documentation**
Tutorials and guides for Burp Suite.](/burp/documentation)
[**Get Started - Professional**
Get started with Burp Suite Professional.](/burp/documentation/desktop/getting-started)
[**Get Started - Enterprise**
Get started with Burp Suite Enterprise Edition.](/burp/documentation/enterprise/getting-started)
[**User Forum**
Get your questions answered in the User Forum.](https://forum.portswigger.net/)
[**Downloads**
Download the latest version of Burp Suite.](/burp/releases)

[Visit the Support Center](/support)

[**Downloads**

Download the latest version of Burp Suite.

![The latest version of Burp Suite software for download](/mega-nav/images/latest-burp-suite-software-download.jpg)](/burp/releases)

Academy home

* [Dashboard](https://portswigger.net/web-security/index.html)
* [Learning paths](https://portswigger.net/web-security/learning-paths)
* Latest topics

  [Web cache deception](/web-security/web-cache-deception)
  [Web LLM attacks](/web-security/llm-attacks)
  [API testing](/web-security/api-testing)
  [NoSQL injection](/web-security/nosql-injection)
  [Race conditions](/web-security/race-conditions)
  [View all topics](/web-security/all-topics)
* All content

  [All labs](/web-security/all-labs)
  [All topics](/web-security/all-topics)
  [Mystery labs](/web-security/mystery-lab-challenge)
* Hall of Fame

  [Leaderboard](https://portswigger.net/web-security/hall-of-fame)
  [Interview - Kamil Vavra](https://portswigger.net/web-security/getting-started/kamil-vavra/index.html)
  [Interview - Johnny Villarreal](https://portswigger.net/web-security/getting-started/johnny-villarreal/index.html)
  [Interview - Andres Rauschecker](https://portswigger.net/web-security/getting-started/andres-rauschecker/index.html)
* [Get started](https://portswigger.net/web-security/getting-started/index.html)
* Get certified

  [Get certified](https://portswigger.net/web-security/certification/index.html)
  [How to prepare](https://portswigger.net/web-security/certification/how-to-prepare/index.html)
  [How it works](https://portswigger.net/web-security/certification/how-it-works/index.html)
  [Practice exam](https://portswigger.net/web-security/certification/practice-exam/index.html)
  [Exam hints and guidance](https://portswigger.net/web-security/certification/exam-hints-and-guidance/index.html)
  [What the exam involves](https://portswigger.net/web-security/certification/how-it-works/index.html#what-the-exam-involves)
  [FAQs](https://portswigger.net/web-security/certification/frequently-asked-questions/index.html)
  [Validate your certification](https://portswigger.net/web-security/certification#validate-your-certification)

[Back to all topics](/web-security/all-topics)

### Cross-site request forgery (CSRF)

* [What is CSRF?](/web-security/csrf#what-is-csrf)
* [Impact](/web-security/csrf#what-is-the-impact-of-a-csrf-attack)
* [How does CSRF work?](/web-security/csrf#how-does-csrf-work)
* [XSS vs CSRF](/web-security/csrf/xss-vs-csrf)

  + [Can CSRF tokens prevent XSS attacks?](/web-security/csrf/xss-vs-csrf#can-csrf-tokens-prevent-xss-attacks)
* [Constructing an attack](/web-security/csrf#how-to-construct-a-csrf-attack)
* [Delivering an exploit](/web-security/csrf#how-to-deliver-a-csrf-exploit)
* [Defences](/web-security/csrf#common-defences-against-csrf)
* [Bypassing CSRF token validation](/web-security/csrf/bypassing-token-validation)

  + [What is a CSRF token?](/web-security/csrf/bypassing-token-validation#what-is-a-csrf-token)
  + [Flaws in CSRF token validation](/web-security/csrf/bypassing-token-validation#common-flaws-in-csrf-token-validation)

    - [Validation depends on request method](/web-security/csrf/bypassing-token-validation#validation-of-csrf-token-depends-on-request-method)
    - [Validation depends on token being present](/web-security/csrf/bypassing-token-validation#validation-of-csrf-token-depends-on-token-being-present)
    - [Token isn't tied to user session](/web-security/csrf/bypassing-token-validation#csrf-token-is-not-tied-to-the-user-session)
    - [Token is tied to a non-session cookie](/web-security/csrf/bypassing-token-validation#csrf-token-is-tied-to-a-non-session-cookie)
    - [Token is duplicated in a cookie](/web-security/csrf/bypassing-token-validation#csrf-token-is-simply-duplicated-in-a-cookie)
* [Bypassing SameSite cookie restrictions](/web-security/csrf/bypassing-samesite-restrictions)

  + [What is a site?](/web-security/csrf/bypassing-samesite-restrictions#what-is-a-site-in-the-context-of-samesite-cookies)
  + [Site vs origin](/web-security/csrf/bypassing-samesite-restrictions#what-s-the-difference-between-a-site-and-an-origin)
  + [How does SameSite work?](/web-security/csrf/bypassing-samesite-restrictions#how-does-samesite-work)

    - [Strict restriction level](/web-security/csrf/bypassing-samesite-restrictions#strict)
    - [Lax restriction level](/web-security/csrf/bypassing-samesite-restrictions#lax)
    - [No SameSite restrictions](/web-security/csrf/bypassing-samesite-restrictions#none)
  + [Bypassing Lax restrictions using GET requests](/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-lax-restrictions-using-get-requests)
  + [Bypassing restrictions using on-site gadgets](/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-restrictions-using-on-site-gadgets)
  + [Bypassing restrictions via vulnerable sibling domains](/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-restrictions-via-vulnerable-sibling-domains)
  + [Bypassing Lax restrictions with newly issued cookies](/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-lax-restrictions-with-newly-issued-cookies)
* [Bypassing Referer-based CSRF defenses](/web-security/csrf/bypassing-referer-based-defenses)

  + [Validation of Referer depends on header being present](/web-security/csrf/bypassing-referer-based-defenses#validation-of-referer-depends-on-header-being-present)
  + [Validation of Referer can be circumvented](/web-security/csrf/bypassing-referer-based-defenses#validation-of-referer-can-be-circumvented)
* [Preventing CSRF vulnerabilities](/web-security/csrf/preventing)

  + [CSRF tokens](/web-security/csrf/preventing#use-csrf-tokens)

    - [Generating](/web-security/csrf/preventing#how-should-csrf-tokens-be-generated)
    - [Transmitting](/web-security/csrf/preventing#how-should-csrf-tokens-be-transmitted)
    - [Validating](/web-security/csrf/preventing#how-should-csrf-tokens-be-validated)
  + [Strict SameSite cookie restrictions](/web-security/csrf/preventing#use-strict-samesite-cookie-restrictions)
  + [Be wary of cross-origin, same-site attacks](/web-security/csrf/preventing#be-wary-of-cross-origin-same-site-attacks)
* [View all CSRF labs](/web-security/all-labs#cross-site-request-forgery-csrf)

* [Web Security Academy](/web-security)
* [CSRF](/web-security/csrf)

# Cross-site request forgery (CSRF)

In this section, we'll explain what cross-site request forgery is, describe some examples of common CSRF vulnerabilities, and explain how to prevent CSRF attacks.

## What is CSRF?

Cross-site request forgery (also known as CSRF) is a web security vulnerability that allows an attacker to induce users to perform actions that they do not intend to perform. It allows an attacker to partly circumvent the same origin policy, which is designed to prevent different websites from interfering with each other.

![CSRF](/web-security/images/cross-site%20request%20forgery.svg)
#### Labs

If you're already familiar with the basic concepts behind CSRF vulnerabilities and just want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access all of the labs in this topic from the link below.

* [View all CSRF labs](/web-security/all-labs#cross-site-request-forgery-csrf)
## What is the impact of a CSRF attack?

In a successful CSRF attack, the attacker causes the victim user to carry out an action unintentionally. For example, this might be to change the email address on their account, to change their password, or to make a funds transfer. Depending on the nature of the action, the attacker might be able to gain full control over the user's account. If the compromised user has a privileged role within the application, then the attacker might be able to take full control of all the application's data and functionality.

## How does CSRF work?

For a CSRF attack to be possible, three key conditions must be in place:

* **A relevant action.** There is an action within the application that the attacker has a reason to induce. This might be a privileged action (such as modifying permissions for other users) or any action on user-specific data (such as changing the user's own password).
* **Cookie-based session handling.** Performing the action involves issuing one or more HTTP requests, and the application relies solely on session cookies to identify the user who has made the requests. There is no other mechanism in place for tracking sessions or validating user requests.
* **No unpredictable request parameters.** The requests that perform the action do not contain any parameters whose values the attacker cannot determine or guess. For example, when causing a user to change their password, the function is not vulnerable if an attacker needs to know the value of the existing password.

For example, suppose an application contains a function that lets the user change the email address on their account. When a user performs this action, they make an HTTP request like the following:

`POST /email/change HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 30
Cookie: session=yvthwsztyeQkAPzeQ5gHgTvlyxHfsAfE
email=wiener@normal-user.com`

This meets the conditions required for CSRF:

* The action of changing the email address on a user's account is of interest to an attacker. Following this action, the attacker will typically be able to trigger a password reset and take full control of the user's account.
* The application uses a session cookie to identify which user issued the request. There are no other tokens or mechanisms in place to track user sessions.
* The attacker can easily determine the values of the request parameters that are needed to perform the action.

With these conditions in place, the attacker can construct a web page containing the following HTML:

`<html>
<body>
<form action="https://vulnerable-website.com/email/change" method="POST">
<input type="hidden" name="email" value="pwned@evil-user.net" />
</form>
<script>
document.forms[0].submit();
</script>
</body>
</html>`

If a victim user visits the attacker's web page, the following will happen:

* The attacker's page will trigger an HTTP request to the vulnerable website.
* If the user is logged in to the vulnerable website, their browser will automatically include their session cookie in the request (assuming [SameSite cookies](/web-security/csrf#common-defences-against-csrf) are not being used).
* The vulnerable website will process the request in the normal way, treat it as having been made by the victim user, and change their email address.

#### Note

Although CSRF is normally described in relation to cookie-based session handling, it also arises in other contexts where the application automatically adds some user credentials to requests, such as HTTP Basic authentication and certificate-based authentication.

## How to construct a CSRF attack

Manually creating the HTML needed for a CSRF exploit can be cumbersome, particularly where the desired request contains a large number of parameters, or there are other quirks in the request. The easiest way to construct a CSRF exploit is using the [CSRF PoC generator](/burp/documentation/desktop/tools/engagement-tools/generate-csrf-poc) that is built in to Burp Suite Professional:

* Select a request anywhere in Burp Suite Professional that you want to test or exploit.
* From the right-click context menu, select Engagement tools / Generate CSRF PoC.
* Burp Suite will generate some HTML that will trigger the selected request (minus cookies, which will be added automatically by the victim's browser).
* You can tweak various options in the CSRF PoC generator to fine-tune aspects of the attack. You might need to do this in some unusual situations to deal with quirky features of requests.
* Copy the generated HTML into a web page, view it in a browser that is logged in to the vulnerable website, and test whether the intended request is issued successfully and the desired action occurs.

LAB
APPRENTICE
[CSRF vulnerability with no defenses](/web-security/csrf/lab-no-defenses)

## How to deliver a CSRF exploit

The delivery mechanisms for cross-site request forgery attacks are essentially the same as for reflected XSS. Typically, the attacker will place the malicious HTML onto a website that they control, and then induce victims to visit that website. This might be done by feeding the user a link to the website, via an email or social media message. Or if the attack is placed into a popular website (for example, in a user comment), they might just wait for users to visit the website.

Note that some simple CSRF exploits employ the GET method and can be fully self-contained with a single URL on the vulnerable website. In this situation, the attacker may not need to employ an external site, and can directly feed victims a malicious URL on the vulnerable domain. In the preceding example, if the request to change email address can be performed with the GET method, then a self-contained attack would look like this:

`<img src="https://vulnerable-website.com/email/change?email=pwned@evil-user.net">`
#### Read more

* [XSS vs CSRF](/web-security/csrf/xss-vs-csrf)
## Common defences against CSRF

Nowadays, successfully finding and exploiting CSRF vulnerabilities often involves bypassing anti-CSRF measures deployed by the target website, the victim's browser, or both. The most common defenses you'll encounter are as follows:

* **CSRF tokens** - A CSRF token is a unique, secret, and unpredictable value that is generated by the server-side application and shared with the client. When attempting to perform a sensitive action, such as submitting a form, the client must include the correct CSRF token in the request. This makes it very difficult for an attacker to construct a valid request on behalf of the victim.
* **SameSite cookies** - SameSite is a browser security mechanism that determines when a website's cookies are included in requests originating from other websites. As requests to perform sensitive actions typically require an authenticated session cookie, the appropriate SameSite restrictions may prevent an attacker from triggering these actions cross-site. Since 2021, Chrome enforces `Lax` SameSite restrictions by default. As this is the proposed standard, we expect other major browsers to adopt this behavior in future.
* **Referer-based validation** - Some applications make use of the HTTP Referer header to attempt to defend against CSRF attacks, normally by verifying that the request originated from the application's own domain. This is generally less effective than CSRF token validation.

For a more detailed description of each of these defenses, as well as how they can potentially be bypassed, check out the following materials. These include interactive labs that let you practice what you've learned on realistic, deliberately vulnerable targets.

#### Read more

* [LABS Bypassing CSRF token validation](/web-security/csrf/bypassing-token-validation)
* [LABS Bypassing SameSite cookie restrictions](/web-security/csrf/bypassing-samesite-restrictions)
* [LABS Bypassing Referer-based CSRF defenses](/web-security/csrf/bypassing-referer-based-defenses)

For details on how to properly implement these defenses in order to prevent some of these issues on your own websites, see [How to prevent CSRF vulnerabilities](/web-security/csrf/preventing)

## Register for free to track your learning progress

![The benefits of working through PortSwigger's Web Security Academy](/content/images/vulnerabilities/web-security-academy-footer.png)

* Practise exploiting vulnerabilities on realistic targets.
* Record your progression from Apprentice to Expert.
* See where you rank in our Hall of Fame.

REGISTER

As we use reCAPTCHA, you need to be able to access Google's servers to use this function.

Already got an account?
[Login here](https://portswigger.net/users)

Want to track your progress and have a more personalized learning experience? (It's free!)

[Sign up](/users/register)
[Login](/users?returnurl=%2fweb-security%2fcsrf)

![Try Burp Suite for Free](/content/images/logos/burp-suite-icon.svg)
#### Find CSRF vulnerabilities using Burp Suite

[Try for free](https://portswigger.net/burp)

Burp Suite

[Web vulnerability scanner](/burp/vulnerability-scanner)
[Burp Suite Editions](/burp)
[Release Notes](/burp/releases)

Vulnerabilities

[Cross-site scripting (XSS)](/web-security/cross-site-scripting)
[SQL injection](/web-security/sql-injection)
[Cross-site request forgery](/web-security/csrf)
[XML external entity injection](/web-security/xxe)
[Directory traversal](/web-security/file-path-traversal)
[Server-side request forgery](/web-security/ssrf)

Customers

[Organizations](/organizations)
[Testers](/testers)
[Developers](/developers)

Company

[About](/about)
[Careers](/careers)
[Contact](/about/contact)
[Legal](/legal)
[Privacy Notice](/privacy)

Insights

[Web Security Academy](/web-security)
[Blog](/blog)
[Research](/research)

[![PortSwigger Logo](/content/images/logos/portswigger-logo.svg)](/)
 [Follow us](https://twitter.com/Burp_Suite)

© 2025 PortSwigger Ltd.



=== Content from devel.blueonyx.it_62072abe_20250119_114904.html ===


[![BlueOnyx](/BlueOnyxLogo.gif)](/trac)

Search:

* [Login](/trac/login)
* [Preferences](/trac/prefs)
* [Help/Guide](/trac/wiki/TracGuide)
* [About Trac](/trac/about)

* [Wiki](/trac/wiki)
* [Timeline](/trac/timeline)
* [Browse Source](/trac/browser)
* [Search](/trac/search)

## Context Navigation

* ← [Previous Changeset](/trac/changeset/4033 "Changeset 4033")
* [Next Changeset](/trac/changeset/4035 "Changeset 4035") →

---

# Changeset 4034

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
Nov 9, 2020, 8:46:06 AM
([4 years](/trac/timeline?from=2020-11-09T08%3A46%3A06Z&precision=second "See timeline at Nov 9, 2020, 8:46:06 AM") ago)
Author:
mstauber
Message:

Provisions for CSRF protection added.

Location:
[BlueOnyx/5209R](/trac/browser/BlueOnyx/5209R?rev=4034)
Files:

2 added
33 edited

* [platform/alpine.mod/Makefile](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/Makefile?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [platform/alpine.mod/ci/application/config/config.php](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/config/config.php?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [platform/alpine.mod/ci/application/libraries/uifc/PagedBlock.php](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/libraries/uifc/PagedBlock.php?rev=4034 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))
* [platform/alpine.mod/ci/application/modules/base/login/controllers/login.php](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/controllers/login.php?rev=4034 "Show entry in browser")
  (modified)
  ([4 diffs](#file3 "Show differences"))
* [platform/alpine.mod/ci/application/modules/base/login/views/login\_view.php](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/views/login_view.php?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [platform/alpine.mod/ci/application/modules/base/login/views/login\_view\_solo.php](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/views/login_view_solo.php?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))
* [platform/alpine.mod/ci/system/core/Security.php](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php?rev=4034 "Show entry in browser")
  (modified)
  ([7 diffs](#file6 "Show differences"))
* [platform/alpine.mod/templates/rpmdefs.tmpl](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/templates/rpmdefs.tmpl?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file7 "Show differences"))
* [ui/base-backupcontrol.mod/Makefile](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/Makefile?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file8 "Show differences"))
* [ui/base-backupcontrol.mod/locale/da\_DK/backupcontrol.po](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/da_DK/backupcontrol.po?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file9 "Show differences"))
* [ui/base-backupcontrol.mod/locale/de\_DE/backupcontrol.po](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/de_DE/backupcontrol.po?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file10 "Show differences"))
* [ui/base-backupcontrol.mod/locale/en\_US/backupcontrol.po](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/en_US/backupcontrol.po?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file11 "Show differences"))
* [ui/base-backupcontrol.mod/locale/es\_ES/backupcontrol.po](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/es_ES/backupcontrol.po?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file12 "Show differences"))
* [ui/base-backupcontrol.mod/locale/fr\_FR/backupcontrol.po](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/fr_FR/backupcontrol.po?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file13 "Show differences"))
* [ui/base-backupcontrol.mod/locale/it\_IT/backupcontrol.po](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/it_IT/backupcontrol.po?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file14 "Show differences"))
* [ui/base-backupcontrol.mod/locale/ja\_JP/backupcontrol.po](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/ja_JP/backupcontrol.po?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file15 "Show differences"))
* [ui/base-backupcontrol.mod/locale/nl\_NL/backupcontrol.po](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/nl_NL/backupcontrol.po?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file16 "Show differences"))
* [ui/base-backupcontrol.mod/locale/pt\_PT/backupcontrol.po](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/pt_PT/backupcontrol.po?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file17 "Show differences"))
* [ui/base-backupcontrol.mod/templates/rpmdefs.tmpl](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/templates/rpmdefs.tmpl?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file18 "Show differences"))
* [ui/base-backupcontrol.mod/ui/chorizo/web/controllers/desktopcontrol.php](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/ui/chorizo/web/controllers/desktopcontrol.php?rev=4034 "Show entry in browser")
  (modified)
  ([2 diffs](#file19 "Show differences"))
* [ui/base-phpmyadmin.mod/Makefile](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/Makefile?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file20 "Show differences"))
* [ui/base-phpmyadmin.mod/templates/rpmdefs.tmpl](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/templates/rpmdefs.tmpl?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file21 "Show differences"))
* [ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/pusher.php](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/pusher.php?rev=4034 "Show entry in browser")
  (modified)
  ([3 diffs](#file22 "Show differences"))
* [ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/signon.php](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/signon.php?rev=4034 "Show entry in browser")
  (modified)
  ([3 diffs](#file23 "Show differences"))
* [ui/base-system.mod/Makefile](/trac/browser/BlueOnyx/5209R/ui/base-system.mod/Makefile?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file24 "Show differences"))
* [ui/base-system.mod/constructor/csrf\_initially\_off.pl](/trac/browser/BlueOnyx/5209R/ui/base-system.mod/constructor/csrf_initially_off.pl?rev=4034 "Show entry in browser")
  (added)
* [ui/base-system.mod/glue/conf/base-system.conf](/trac/browser/BlueOnyx/5209R/ui/base-system.mod/glue/conf/base-system.conf?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file26 "Show differences"))
* [ui/base-system.mod/glue/handlers/csrf.pl](/trac/browser/BlueOnyx/5209R/ui/base-system.mod/glue/handlers/csrf.pl?rev=4034 "Show entry in browser")
  (added)
* [ui/base-system.mod/glue/schemas/system.schema](/trac/browser/BlueOnyx/5209R/ui/base-system.mod/glue/schemas/system.schema?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file28 "Show differences"))
* [ui/base-system.mod/templates/rpmdefs.tmpl](/trac/browser/BlueOnyx/5209R/ui/base-system.mod/templates/rpmdefs.tmpl?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file29 "Show differences"))
* [ui/base-time.mod/base-time-src.tar.gz](/trac/browser/BlueOnyx/5209R/ui/base-time.mod/base-time-src.tar.gz?rev=4034 "Show entry in browser")
  (modified)
  ([previous](/trac/browser/BlueOnyx/5209R/ui/base-time.mod/base-time-src.tar.gz?rev=3804 "Show previous version in browser"))
* [ui/base-wizard.mod/Makefile](/trac/browser/BlueOnyx/5209R/ui/base-wizard.mod/Makefile?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file31 "Show differences"))
* [ui/base-wizard.mod/templates/rpmdefs.tmpl](/trac/browser/BlueOnyx/5209R/ui/base-wizard.mod/templates/rpmdefs.tmpl?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file32 "Show differences"))
* [ui/base-wizard.mod/ui/chorizo/web/controllers/wizard.php](/trac/browser/BlueOnyx/5209R/ui/base-wizard.mod/ui/chorizo/web/controllers/wizard.php?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file33 "Show differences"))
* [ui/base-wizard.mod/ui/chorizo/web/controllers/wizard\_with\_ethStuff.php](/trac/browser/BlueOnyx/5209R/ui/base-wizard.mod/ui/chorizo/web/controllers/wizard_with_ethStuff.php?rev=4034 "Show entry in browser")
  (modified)
  ([1 diff](#file34 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [BlueOnyx/5209R/platform/alpine.mod/Makefile](/trac/changeset/4034/BlueOnyx/5209R/platform/alpine.mod/Makefile "Show the changeset 4034 restricted to BlueOnyx/5209R/platform/alpine.mod/Makefile")

  | [r3831](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/Makefile?rev=3831#L8 "Show revision 3831 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/Makefile?rev=4034#L8 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 |  |
  | 9 | 9 | VERSION=2.0 |
  | 10 |  | RELEASE=1BX9~~7~~ |
  |  | 10 | RELEASE=1BX99 |
  | 11 | 11 |  |
  | 12 | 12 | # add a buildarch if desired |
* ## [BlueOnyx/5209R/platform/alpine.mod/ci/application/config/config.php](/trac/changeset/4034/BlueOnyx/5209R/platform/alpine.mod/ci/application/config/config.php "Show the changeset 4034 restricted to BlueOnyx/5209R/platform/alpine.mod/ci/application/config/config.php")

  | [r1749](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/config/config.php?rev=1749#L322 "Show revision 1749 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/config/config.php?rev=4034#L322 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 322 | 322 | | 'csrf\_expire' = The number in seconds the token should expire. |
  | 323 | 323 | \*/ |
  | 324 |  | $config['csrf\_protection'] = FALSE; |
  |  | 324 |  |
  |  | 325 | $config['csrf\_protection'] = TRUE; |
  | 325 | 326 | $config['csrf\_token\_name'] = 'BlueOnyx\_CSRF\_token'; |
  | 326 | 327 | $config['csrf\_cookie\_name'] = 'BlueOnyx\_CSRF\_cookie'; |
  | 327 | 328 | $config['csrf\_expire'] = 7200; |
  |  | 329 | $config['csrf\_regenerate'] = FALSE; |
  |  | 330 | $config['csrf\_exclude\_uris'] = array( |
  |  | 331 | 'api/', |
  |  | 332 | 'api/index', |
  |  | 333 | 'api/index/.\*', |
  |  | 334 | 'api/.\*' |
  |  | 335 | ); |
  | 328 | 336 |  |
  | 329 | 337 | /\* |
* ## [BlueOnyx/5209R/platform/alpine.mod/ci/application/libraries/uifc/PagedBlock.php](/trac/changeset/4034/BlueOnyx/5209R/platform/alpine.mod/ci/application/libraries/uifc/PagedBlock.php "Show the changeset 4034 restricted to BlueOnyx/5209R/platform/alpine.mod/ci/application/libraries/uifc/PagedBlock.php")

  | [r2329](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/libraries/uifc/PagedBlock.php?rev=2329#L509 "Show revision 2329 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/libraries/uifc/PagedBlock.php?rev=4034#L509 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 509 | 509 |  |
  | 510 | 510 | public function toHtml($style = "") { |
  |  | 511 | $CI = get\_instance(); |
  | 511 | 512 | $page = $this->getPage(); |
  | 512 | 513 | $i18n = $page->getI18n(); |
  | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/libraries/uifc/PagedBlock.php?rev=2329#L873) | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/libraries/uifc/PagedBlock.php?rev=4034#L874) |  |
  | 873 | 874 | } |
  | 874 | 875 |  |
  |  | 876 | // Set up CSRF: |
  |  | 877 | $csrf = array( |
  |  | 878 | 'name' => $CI->security->get\_csrf\_token\_name(), |
  |  | 879 | 'hash' => $CI->security->get\_csrf\_hash() |
  |  | 880 | ); |
  |  | 881 |  |
  | 875 | 882 | // It's possible to set a 'form\_action', which is an URL that form data is posted to. Let us see if it is set: |
  | 876 | 883 | $form = get\_object\_vars($page->getForm()); |
  | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/libraries/uifc/PagedBlock.php?rev=2329#L882) | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/libraries/uifc/PagedBlock.php?rev=4034#L889) |  |
  | 882 | 889 | $result\_head .= '                <form class="validate\_form" method="post" ENCTYPE="multipart/form-data" id="waiting\_overlay">' . "\n"; |
  | 883 | 890 | } |
  |  | 891 | $result\_head .= "                  <input type=\"hidden\" name=\"" . $csrf['name'] . "\" value=\"" . $csrf['hash'] . "\" />\n"; |
  | 884 | 892 | } |
  | 885 | 893 |  |
* ## [BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/controllers/login.php](/trac/changeset/4034/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/controllers/login.php "Show the changeset 4034 restricted to BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/controllers/login.php")

  | [r3177](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/controllers/login.php?rev=3177#L109 "Show revision 3177 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/controllers/login.php?rev=4034#L109 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 109 | 109 | exit; |
  | 110 | 110 | } |
  |  | 111 |  |
  |  | 112 | // Set up CSRF: |
  |  | 113 | $csrf = array( |
  |  | 114 | 'name' => $this->security->get\_csrf\_token\_name(), |
  |  | 115 | 'hash' => $this->security->get\_csrf\_hash() |
  |  | 116 | ); |
  | 111 | 117 |  |
  | 112 | 118 | // Check to see if the user is already logged in as another user: |
  | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/controllers/login.php?rev=3177#L445) | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/controllers/login.php?rev=4034#L451) |  |
  | 445 | 451 | 'Username' => $Username, |
  | 446 | 452 | 'Password' => $Password, |
  |  | 453 | 'csrf\_name' => $csrf['name'], |
  |  | 454 | 'csrf\_hash' => $csrf['hash'], |
  | 447 | 455 | 'SecureConnect' => $SecureConnect, |
  | 448 | 456 | 'redirect\_target' => $redirect\_target, |
  | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/controllers/login.php?rev=3177#L488) | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/controllers/login.php?rev=4034#L496) |  |
  | 488 | 496 | 'Username' => $Username, |
  | 489 | 497 | 'Password' => $Password, |
  |  | 498 | 'csrf\_name' => $csrf['name'], |
  |  | 499 | 'csrf\_hash' => $csrf['hash'], |
  | 490 | 500 | 'SecureConnect' => $SecureConnect, |
  | 491 | 501 | 'redirect\_target' => $redirect\_target, |
  | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/controllers/login.php?rev=3177#L576) | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/controllers/login.php?rev=4034#L586) |  |
  | 576 | 586 | 'Username' => $Username, |
  | 577 | 587 | 'Password' => $Password, |
  |  | 588 | 'csrf\_name' => $csrf['name'], |
  |  | 589 | 'csrf\_hash' => $csrf['hash'], |
  | 578 | 590 | 'SecureConnect' => $SecureConnect, |
  | 579 | 591 | 'redirect\_target' => $redirect\_target, |
* ## [BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/views/login\_view.php](/trac/changeset/4034/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/views/login_view.php "Show the changeset 4034 restricted to BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/views/login_view.php")

  | [r2297](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/views/login_view.php?rev=2297#L137 "Show revision 2297 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/views/login_view.php?rev=4034#L137 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 137 | 137 | </div> |
  | 138 | 138 | <input type="hidden" id="redirect\_target" name="redirect\_target" value="<?php echo $redirect\_target;?>"> |
  |  | 139 | <input type="hidden" name="<?php echo $csrf\_name; ?>" value="<?php echo $csrf\_hash; ?>" /> |
  | 139 | 140 | </form> |
  | 140 | 141 | </div> |
* ## [BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/views/login\_view\_solo.php](/trac/changeset/4034/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/views/login_view_solo.php "Show the changeset 4034 restricted to BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/views/login_view_solo.php")

  | [r2297](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/views/login_view_solo.php?rev=2297#L127 "Show revision 2297 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/application/modules/base/login/views/login_view_solo.php?rev=4034#L127 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 127 | 127 | </div> |
  | 128 | 128 | <input type="hidden" id="redirect\_target" name="redirect\_target" value="<?php echo $redirect\_target;?>"> |
  |  | 129 | <input type="hidden" name="<?php echo $csrf\_name; ?>" value="<?php echo $csrf\_hash; ?>" /> |
  | 129 | 130 | </form> |
  | 130 | 131 | </div> |
* ## [BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php](/trac/changeset/4034/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php "Show the changeset 4034 restricted to BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php")

  | [r3125](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php?rev=3125#L102 "Show revision 3125 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php?rev=4034#L102 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 102 | 102 |  |
  | 103 | 103 | /\*\* |
  |  | 104 | \* hash\_equals() |
  |  | 105 | \* |
  |  | 106 | \* @link        http://php.net/hash\_equals |
  |  | 107 | \* @param       string  $known\_string |
  |  | 108 | \* @param       string  $user\_string |
  |  | 109 | \* @return      bool |
  |  | 110 | \*/ |
  |  | 111 | public function hash\_equals($known\_string, $user\_string) |
  |  | 112 | { |
  |  | 113 | if ( ! is\_string($known\_string)) |
  |  | 114 | { |
  |  | 115 | trigger\_error('hash\_equals(): Expected known\_string to be a string, '.strtolower(gettype($known\_string)).' given', E\_USER\_WARNING); |
  |  | 116 | return FALSE; |
  |  | 117 | } |
  |  | 118 | elseif ( ! is\_string($user\_string)) |
  |  | 119 | { |
  |  | 120 | trigger\_error('hash\_equals(): Expected user\_string to be a string, '.strtolower(gettype($user\_string)).' given', E\_USER\_WARNING); |
  |  | 121 | return FALSE; |
  |  | 122 | } |
  |  | 123 | elseif (($length = strlen($known\_string)) !== strlen($user\_string)) |
  |  | 124 | { |
  |  | 125 | return FALSE; |
  |  | 126 | } |
  |  | 127 |  |
  |  | 128 | $diff = 0; |
  |  | 129 | for ($i = 0; $i < $length; $i++) |
  |  | 130 | { |
  |  | 131 | $diff |= ord($known\_string[$i]) ^ ord($user\_string[$i]); |
  |  | 132 | } |
  |  | 133 |  |
  |  | 134 | return ($diff === 0); |
  |  | 135 | } |
  |  | 136 |  |
  |  | 137 | /\*\* |
  | 104 | 138 | \* Constructor |
  | 105 | 139 | \* |
  | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php?rev=3125#L109) | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php?rev=4034#L143) |  |
  | 109 | 143 | { |
  | 110 | 144 | // Is CSRF protection enabled? |
  | 111 |  | if (config\_item('csrf\_protection')~~=== TRUE~~) |
  |  | 145 | if (config\_item('csrf\_protection')) |
  | 112 | 146 | { |
  | 113 | 147 | // CSRF config |
  | 114 | 148 | foreach (array('csrf\_expire', 'csrf\_token\_name', 'csrf\_cookie\_name') as $key) |
  | 115 | 149 | { |
  | 116 |  | if (~~FALSE~~ !== ($val = config\_item($key))) |
  |  | 150 | if (NULL !== ($val = config\_item($key))) |
  | 117 | 151 | { |
  | 118 | 152 | $this->{'\_'.$key} = $val; |
  | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php?rev=3125#L121) | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php?rev=4034#L155) |  |
  | 121 | 155 |  |
  | 122 | 156 | // Append application specific cookie prefix |
  | 123 |  | if (config\_item('cookie\_prefix')) |
  | 124 |  | { |
  | 125 |  | $this->\_csrf\_cookie\_name = ~~config\_item('cookie\_prefix')~~.$this->\_csrf\_cookie\_name; |
  |  | 157 | if ($cookie\_prefix = config\_item('cookie\_prefix')) |
  |  | 158 | { |
  |  | 159 | $this->\_csrf\_cookie\_name = $cookie\_prefix.$this->\_csrf\_cookie\_name; |
  | 126 | 160 | } |
  | 127 | 161 |  |
  | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php?rev=3125#L130) | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php?rev=4034#L164) |  |
  | 130 | 164 | } |
  | 131 | 165 |  |
  | 132 |  | log\_message('debug', "Security Class Initialized"); |
  |  | 166 | $this->charset = strtoupper(config\_item('charset')); |
  |  | 167 |  |
  |  | 168 | log\_message('info', 'Security Class Initialized'); |
  | 133 | 169 | } |
  | 134 | 170 |  |
  | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php?rev=3125#L148) | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php?rev=4034#L184) |  |
  | 148 | 184 | } |
  | 149 | 185 |  |
  | 150 |  | // Do the tokens exist in both the \_POST and \_COOKIE arrays? |
  | 151 |  | if ( ! isset($\_POST[$this->\_csrf\_token\_name], $\_COOKIE[$this->\_csrf\_cookie\_name])) |
  | 152 |  | { |
  | 153 |  | $this->csrf\_show\_error(); |
  | 154 |  | } |
  | 155 |  |  |
  | 156 |  | // Do the tokens match? |
  | 157 |  | if ($\_POST[$this->\_csrf\_token\_name] != $\_COOKIE[$this->\_csrf\_cookie\_name]) |
  | 158 |  | { |
  | 159 |  | $this->csrf\_show\_error(); |
  | 160 |  | } |
  | 161 |  |  |
  | 162 |  | // We kill this since we're done and we don't want to |
  | 163 |  | // polute the \_POST array |
  |  | 186 | // Check if URI has been whitelisted from CSRF checks |
  |  | 187 | if ($exclude\_uris = config\_item('csrf\_exclude\_uris')) |
  |  | 188 | { |
  |  | 189 | $uri = load\_class('URI', 'core'); |
  |  | 190 | foreach ($exclude\_uris as $excluded) |
  |  | 191 | { |
  |  | 192 | if (preg\_match('#^'.$excluded.'$#i'.(UTF8\_ENABLED ? 'u' : ''), $uri->uri\_string())) |
  |  | 193 | { |
  |  | 194 | return $this; |
  |  | 195 | } |
  |  | 196 | } |
  |  | 197 | } |
  |  | 198 |  |
  |  | 199 | // Check CSRF token validity, but don't error on mismatch just yet - we'll want to regenerate |
  |  | 200 | $valid = isset($\_POST[$this->\_csrf\_token\_name], $\_COOKIE[$this->\_csrf\_cookie\_name]) |
  |  | 201 | && CI\_Security::hash\_equals($\_POST[$this->\_csrf\_token\_name], $\_COOKIE[$this->\_csrf\_cookie\_name]); |
  |  | 202 |  |
  |  | 203 | // We kill this since we're done and we don't want to pollute the \_POST array |
  | 164 | 204 | unset($\_POST[$this->\_csrf\_token\_name]); |
  | 165 | 205 |  |
  | 166 |  | // Nothing should last forever |
  | 167 |  | unset($\_COOKIE[$this->\_csrf\_cookie\_name]); |
  |  | 206 | // Regenerate on every submission? |
  |  | 207 | if (config\_item('csrf\_regenerate')) |
  |  | 208 | { |
  |  | 209 | // Nothing should last forever |
  |  | 210 | unset($\_COOKIE[$this->\_csrf\_cookie\_name]); |
  |  | 211 | $this->\_csrf\_hash = NULL; |
  |  | 212 | } |
  |  | 213 |  |
  | 168 | 214 | $this->\_csrf\_set\_hash(); |
  | 169 | 215 | $this->csrf\_set\_cookie(); |
  | 170 | 216 |  |
  | 171 |  | log\_message('debug', 'CSRF token verified'); |
  | 172 |  |  |
  |  | 217 | if ($valid !== TRUE) |
  |  | 218 | { |
  |  | 219 | $this->csrf\_show\_error(); |
  |  | 220 | } |
  |  | 221 |  |
  |  | 222 | log\_message('info', 'CSRF token verified'); |
  | 173 | 223 | return $this; |
  | 174 | 224 | } |
  | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php?rev=3125#L184) | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php?rev=4034#L234) |  |
  | 184 | 234 | { |
  | 185 | 235 | $expire = time() + $this->\_csrf\_expire; |
  | 186 |  | $secure\_cookie = (~~config\_item('cookie\_secure') === TRUE) ? 1 : 0~~; |
  | 187 |  |  |
  | 188 |  | if ($secure\_cookie && ~~(empty($\_SERVER['HTTPS']) OR strtolower($\_SERVER['HTTPS']) === 'off'~~)) |
  |  | 236 | $secure\_cookie = (bool) config\_item('cookie\_secure'); |
  |  | 237 |  |
  |  | 238 | if ($secure\_cookie && ! is\_https()) |
  | 189 | 239 | { |
  | 190 | 240 | return FALSE; |
  | 191 | 241 | } |
  | 192 | 242 |  |
  | 193 |  | setcookie($this->\_csrf\_cookie\_name, $this->\_csrf\_hash, $expire, config\_item('cookie\_path'), config\_item('cookie\_domain'), $secure\_cookie); |
  | 194 |  |  |
  | 195 |  | log\_message('debug', "CRSF cookie Set"); |
  |  | 243 | setcookie( |
  |  | 244 | $this->\_csrf\_cookie\_name, |
  |  | 245 | $this->\_csrf\_hash, |
  |  | 246 | $expire, |
  |  | 247 | config\_item('cookie\_path'), |
  |  | 248 | config\_item('cookie\_domain'), |
  |  | 249 | $secure\_cookie, |
  |  | 250 | config\_item('cookie\_httponly') |
  |  | 251 | ); |
  |  | 252 | log\_message('info', 'CSRF cookie sent'); |
  | 196 | 253 |  |
  | 197 | 254 | return $this; |
  | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php?rev=3125#L207) | […](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/ci/system/core/Security.php?rev=4034#L264) |  |
  | 207 | 264 | public function csrf\_show\_error() |
  | 208 | 265 | { |
  | 209 |  | show\_error('The action you have requested is not allowed.'); |
  |  | 266 | show\_error('CSRF mismatch: The action you have requested is not allowed.'); |
  | 210 | 267 | } |
  | 211 | 268 |  |
* ## [BlueOnyx/5209R/platform/alpine.mod/templates/rpmdefs.tmpl](/trac/changeset/4034/BlueOnyx/5209R/platform/alpine.mod/templates/rpmdefs.tmpl "Show the changeset 4034 restricted to BlueOnyx/5209R/platform/alpine.mod/templates/rpmdefs.tmpl")

  | [r3831](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/templates/rpmdefs.tmpl?rev=3831#L147 "Show revision 3831 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/platform/alpine.mod/templates/rpmdefs.tmpl?rev=4034#L147 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 147 | 147 |  |
  | 148 | 148 | <begin $CHANGELOG> |
  |  | 149 |  |
  |  | 150 | \* Mon Nov 09 2020 Michael Stauber <mstauber@solarspeed.net> 2.0-1BX099 |
  |  | 151 | - The CI version in 5209R doesn't have provisions for 'csrf\_regenerate' |
  |  | 152 | or 'csrf\_exclude\_uris'. Backported the relevant functions from 5210R |
  |  | 153 | and added them into ci/system/core/Security.php |
  |  | 154 |  |
  |  | 155 | \* Sun Nov 08 2020 Michael Stauber <mstauber@solarspeed.net> 2.0-1BX098 |
  |  | 156 | - Modified ci/application/config/config.php for CSRF |
  |  | 157 | - Modified ci/application/libraries/uifc/PagedBlock.php for CSRF |
  |  | 158 | - Modified ci/application/modules/base/login/controllers/Login.php for CSRF |
  |  | 159 | - Modified ci/application/modules/base/login/views/login\_view.php for CSRF |
  |  | 160 | - Modified ci/application/modules/base/login/views/login\_view\_solo.php for CSRF |
  |  | 161 | - Modified error message in ci/system/core/Security.php to tell that the error |
  |  | 162 | is actually CSRF related in order to provide some clarity as of why this |
  |  | 163 | popped up in first place. |
  | 149 | 164 |  |
  | 150 | 165 | \* Wed May 27 2020 Michael Stauber <mstauber@solarspeed.net> 2.0-1BX097 |
* ## [BlueOnyx/5209R/ui/base-backupcontrol.mod/Makefile](/trac/changeset/4034/BlueOnyx/5209R/ui/base-backupcontrol.mod/Makefile "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-backupcontrol.mod/Makefile")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/Makefile?rev=2983#L8 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/Makefile?rev=4034#L8 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 |  |
  | 9 | 9 | VERSION=1.1.0 |
  | 10 |  | RELEASE=0BX0~~7~~ |
  |  | 10 | RELEASE=0BX08 |
  | 11 | 11 |  |
  | 12 | 12 | # add a buildarch if desired |
* ## [BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/da\_DK/backupcontrol.po](/trac/changeset/4034/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/da_DK/backupcontrol.po "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/da_DK/backupcontrol.po")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/da_DK/backupcontrol.po?rev=2983#L68 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/da_DK/backupcontrol.po?rev=4034#L68 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 68 | 68 | msgstr "HTTPS kun" |
  | 69 | 69 |  |
  |  | 70 | ## CSRF: |
  |  | 71 |  |
  |  | 72 | msgid "csrf\_protection" |
  |  | 73 | msgstr "CSRF-beskyttelse" |
  |  | 74 |  |
  |  | 75 | msgid "csrf\_protection\_help" |
  |  | 76 | msgstr "Cross-Site Request Forgery (CSRF) er et angreb, der tvinger en slutbruger til at udføre uønskede handlinger på en webapplikation, hvor de i øjeblikket er godkendt. Med lidt hjælp fra social engineering (såsom at sende et link via e-mail eller chat), kan en hacker muligvis narre brugerne af en webapplikation til at udføre handlinger, som angriberen vælger. Hvis offeret er en normal bruger, kan et vellykket CSRF-angreb tvinge brugeren til at udføre tilstandsændrende anmodninger som at ændre indstillinger, udføre transaktioner inden for den godkendte session osv. Hvis offeret er en administrativ konto, kan CSRF potentielt kompromittere hele webapplikationen. Når CSRF-beskyttelse er aktiveret i GUI, er yderligere beskyttelsesforanstaltninger aktiveret, som er designet til at forhindre eller begrænse omfanget af sådanne angreb. Dette gøres ved at indsætte et skjult CSRF-felt på alle GUI-sider, der indeholder et ekstra token med fast udløbstid. Ved alle transaktioner kontrolleres dette skjulte CSRF-token for gyldighed. Hvis der forsøges en transaktion med et ugyldigt CSRF-token, udføres transaktionen ikke, og der vises en fejlmeddelelse i stedet." |
  |  | 77 |  |
  |  | 78 | msgid "csrf\_expire" |
  |  | 79 | msgstr "Udløb af CSRF-token" |
  |  | 80 |  |
  |  | 81 | msgid "csrf\_expire\_help" |
  |  | 82 | msgstr "Dette er den maksimale tid i sekunder, som et CSRF-token er gyldigt. Standard: 7200 (120 minutter). En kortere gyldighedsperiode er mere sikker." |
  |  | 83 |  |
  |  | 84 | msgid "csrf\_regenerate" |
  |  | 85 | msgstr "CSRF til engangsbrug" |
  |  | 86 |  |
  |  | 87 | msgid "csrf\_regenerate\_help" |
  |  | 88 | msgstr "Hvis du aktiverer denne funktion, ændres CSRF-token hver gang du åbner en ny GUI-side. Selv om dette er den mest sikre metode, har den også ulemper: At have forskellige GUI-sider åbne i flere faner eller browservinduer anbefales ikke længere. Fordi hvert GUI-sidebesøg i en fane eller browser automatisk annullerer CSRF-tokenet i alle andre browserfaner eller -vinduer. For maksimal sikkerhed skal du aktivere denne funktion." |
  |  | 89 |  |
* ## [BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/de\_DE/backupcontrol.po](/trac/changeset/4034/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/de_DE/backupcontrol.po "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/de_DE/backupcontrol.po")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/de_DE/backupcontrol.po?rev=2983#L68 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/de_DE/backupcontrol.po?rev=4034#L68 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 68 | 68 | msgstr "nur HTTPS" |
  | 69 | 69 |  |
  |  | 70 | ## CSRF: |
  |  | 71 |  |
  |  | 72 | msgid "csrf\_protection" |
  |  | 73 | msgstr "CSRF-Schutz" |
  |  | 74 |  |
  |  | 75 | msgid "csrf\_protection\_help" |
  |  | 76 | msgstr "Cross-Site Request Forgery (CSRF) ist ein Angriff, der einen Endbenutzer dazu zwingt, unerwünschte Aktionen auf einer Webanwendung auszuführen, in der er sich gerade authentifiziert hat. Mit ein wenig Hilfe von Social Engineering (z.B. Versenden eines Links per E-Mail oder Chat) kann ein Angreifer die Benutzer einer Webanwendung dazu bringen, Aktionen nach Wahl des Angreifers auszuführen. Wenn es sich bei dem Opfer um einen normalen Benutzer handelt, kann ein erfolgreicher CSRF-Angriff den Benutzer zwingen, zustandsändernde Anforderungen wie die Änderung von Einstellungen, die Durchführung von Transaktionen innerhalb der authentifizierten Sitzung usw. durchzuführen. Handelt es sich bei dem Opfer um ein Verwaltungskonto, kann CSRF potenziell die gesamte Webanwendung gefährden. Wenn der CSRF-Schutz in der GUI aktiviert ist, werden zusätzliche Schutzmaßnahmen aktiviert, die dazu dienen, solche Angriffe zu verhindern oder ihren Umfang zu begrenzen. Dies geschieht durch Einfügen eines verborgenen CSRF-Feldes in alle GUI-Seiten, das ein zusätzliches Token mit fester Ablaufzeit enthält. Bei allen Transaktionen wird dieses versteckte CSRF-Token auf seine Gültigkeit überprüft. Wird eine Transaktion mit einem ungültigen CSRF-Token versucht, so wird die Transaktion nicht ausgeführt und stattdessen eine Fehlermeldung angezeigt." |
  |  | 77 |  |
  |  | 78 | msgid "csrf\_expire" |
  |  | 79 | msgstr "Gültigkeit des CSRF-Tokens" |
  |  | 80 |  |
  |  | 81 | msgid "csrf\_expire\_help" |
  |  | 82 | msgstr "Dies ist die maximale Zeit in Sekunden, die ein CSRF-Token gültig ist. Voreinstellung: 7200 (120 Minuten). Eine kürzere Gültigkeitsdauer ist sicherer." |
  |  | 83 |  |
  |  | 84 | msgid "csrf\_regenerate" |
  |  | 85 | msgstr "Einweg-CSRF" |
  |  | 86 |  |
  |  | 87 | msgid "csrf\_regenerate\_help" |
  |  | 88 | msgstr "Wenn Sie diese Funktion aktivieren, dann ändert sich das CSRF-Token jedes Mal, wenn Sie eine neue GUI-Seite öffnen. Obwohl dies die sicherste Methode ist, hat sie auch Nachteile: Es wird nicht mehr empfohlen, verschiedene GUI-Seiten in mehreren Registern oder Browser-Fenstern geöffnet zu haben. Denn jeder Besuch einer GUI-Seite in einem Register oder Browser führt automatisch zur Ungültigkeit des CSRF-Tokens in allen anderen Browser-Registern oder Browser-Fenstern. Für maximale Sicherheit sollten Sie diese Funktion aktivieren." |
  |  | 89 |  |
* ## [BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/en\_US/backupcontrol.po](/trac/changeset/4034/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/en_US/backupcontrol.po "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/en_US/backupcontrol.po")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/en_US/backupcontrol.po?rev=2983#L53 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/en_US/backupcontrol.po?rev=4034#L53 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 53 | 53 | msgid "HTTPS" |
  | 54 | 54 | msgstr "HTTPS only" |
  |  | 55 |  |
  |  | 56 | ## CSRF: |
  |  | 57 |  |
  |  | 58 | msgid "csrf\_protection" |
  |  | 59 | msgstr "CSRF Protection" |
  |  | 60 |  |
  |  | 61 | msgid "csrf\_protection\_help" |
  |  | 62 | msgstr "Cross-Site Request Forgery (CSRF) is an attack that forces an end user to execute unwanted actions on a web application in which they’re currently authenticated. With a little help of social engineering (such as sending a link via email or chat), an attacker may trick the users of a web application into executing actions of the attacker’s choosing. If the victim is a normal user, a successful CSRF attack can force the user to perform state changing requests like modifying settings, performing transactions within the authenticated session, and so forth. If the victim is an administrative account, CSRF can potentially compromise the entire web application. When CSRF protection is enabled in the GUI, additional protective measures are enabled which are designed to prevent or limit the scope of such attacks. This is done by inserting a hidden CSRF field into all GUI pages that contains an additional token with fixed expiry time. Upon all transactions this hidden CSRF token is checked for validity. If a transaction with an invalid CSRF token is attempted, then the transaction will not be performed and an error message is shown instead." |
  |  | 63 |  |
  |  | 64 | msgid "csrf\_expire" |
  |  | 65 | msgstr "CSRF Token Expiry" |
  |  | 66 |  |
  |  | 67 | msgid "csrf\_expire\_help" |
  |  | 68 | msgstr "This is the maximum time in seconds that a CSRF token is valid. Default: 7200 (120 Minutes). A shorter validity period is more secure." |
  |  | 69 |  |
  |  | 70 | msgid "csrf\_regenerate" |
  |  | 71 | msgstr "Single Use CSRF" |
  |  | 72 |  |
  |  | 73 | msgid "csrf\_regenerate\_help" |
  |  | 74 | msgstr "If you enable this feature, then the CSRF token changes every time you open a new GUI page. While this is the most secure method, it also has downsides: Having different GUI pages open in multiple tabs or browser windows is no longer recommended. Because each GUI page visit in one tab or browser automatically invalidates the CSRF token in all other browser tabs or windows. For maximum security you should enable this feature." |
  |  | 75 |  |
* ## [BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/es\_ES/backupcontrol.po](/trac/changeset/4034/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/es_ES/backupcontrol.po "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/es_ES/backupcontrol.po")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/es_ES/backupcontrol.po?rev=2983#L62 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/es_ES/backupcontrol.po?rev=4034#L62 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 62 | 62 | msgstr "Sólo HTTPS" |
  | 63 | 63 |  |
  |  | 64 | ## CSRF: |
  |  | 65 |  |
  |  | 66 | msgid "csrf\_protection" |
  |  | 67 | msgstr "Protección del CSRF" |
  |  | 68 |  |
  |  | 69 | msgid "csrf\_protection\_help" |
  |  | 70 | msgstr "Cross-Site Request Forgery (CSRF) es un ataque que obliga a un usuario final a ejecutar acciones no deseadas en una aplicación web en la que está actualmente autenticado. Con un poco de ayuda de ingeniería social (como el envío de un enlace por correo electrónico o chat), un atacante puede engañar a los usuarios de una aplicación web para que ejecuten las acciones que el atacante elija. Si la víctima es un usuario normal, un ataque CSRF exitoso puede forzar al usuario a realizar peticiones de cambio de estado como modificar la configuración, realizar transacciones dentro de la sesión autenticada, y así sucesivamente. Si la víctima es una cuenta administrativa, el CSRF puede comprometer potencialmente toda la aplicación web. Cuando se habilita la protección CSRF en la interfaz gráfica de usuario, se habilitan medidas de protección adicionales que están diseñadas para prevenir o limitar el alcance de tales ataques. Esto se hace insertando un campo CSRF oculto en todas las páginas de la GUI que contiene un token adicional con un tiempo de caducidad fijo. En todas las transacciones se comprueba la validez de este token CSRF oculto. Si se intenta realizar una transacción con un token CSRF no válido, entonces la transacción no se realizará y en su lugar se mostrará un mensaje de error." |
  |  | 71 |  |
  |  | 72 | msgid "csrf\_expire" |
  |  | 73 | msgstr "Expiración del token CSRF" |
  |  | 74 |  |
  |  | 75 | msgid "csrf\_expire\_help" |
  |  | 76 | msgstr "Este es el tiempo máximo en segundos que un token CSRF es válido. Por defecto: 7200 (120 minutos). Un período de validez más corto es más seguro." |
  |  | 77 |  |
  |  | 78 | msgid "csrf\_regenerate" |
  |  | 79 | msgstr "CSRF de un solo uso" |
  |  | 80 |  |
  |  | 81 | msgid "csrf\_regenerate\_help" |
  |  | 82 | msgstr "Si habilita esta función, el token CSRF cambia cada vez que abre una nueva página GUI. Aunque es el método más seguro, también tiene sus desventajas: Ya no se recomienda tener diferentes páginas GUI abiertas en múltiples pestañas o ventanas del navegador. Debido a que cada visita de una página GUI en una pestaña o navegador invalida automáticamente el token CSRF en todas las demás pestañas o ventanas del navegador. Para una máxima seguridad, debería habilitar esta función." |
  |  | 83 |  |
* ## [BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/fr\_FR/backupcontrol.po](/trac/changeset/4034/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/fr_FR/backupcontrol.po "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/fr_FR/backupcontrol.po")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/fr_FR/backupcontrol.po?rev=2983#L64 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/fr_FR/backupcontrol.po?rev=4034#L64 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 64 | 64 | msgstr "HTTPS uniquement" |
  | 65 | 65 |  |
  |  | 66 | ## CSRF: |
  |  | 67 |  |
  |  | 68 | msgid "csrf\_protection" |
  |  | 69 | msgstr "Protection de la CSRF" |
  |  | 70 |  |
  |  | 71 | msgid "csrf\_protection\_help" |
  |  | 72 | msgstr "La Cross-Site Request Forgery (CSRF) est une attaque qui force un utilisateur final à exécuter des actions non désirées sur une application web dans laquelle il est actuellement authentifié. Avec un peu d'aide de l'ingénierie sociale (comme l'envoi d'un lien par e-mail ou par chat), un attaquant peut tromper les utilisateurs d'une application web en leur faisant exécuter des actions de son choix. Si la victime est un utilisateur normal, une attaque CSRF réussie peut forcer l'utilisateur à effectuer des requêtes de changement d'état comme la modification de paramètres, l'exécution de transactions au sein de la session authentifiée, etc. Si la victime est un compte administratif, CSRF peut potentiellement compromettre l'ensemble de l'application web. Lorsque la protection CSRF est activée dans l'interface utilisateur graphique, des mesures de protection supplémentaires sont activées afin de prévenir ou de limiter la portée de ces attaques. Cela se fait en insérant un champ CSRF caché dans toutes les pages de l'interface graphique qui contient un jeton supplémentaire avec un délai d'expiration fixe. La validité de ce jeton CSRF caché est vérifiée lors de toutes les transactions. Si une transaction avec un jeton CSRF non valide est tentée, la transaction ne sera pas effectuée et un message d'erreur sera affiché à la place." |
  |  | 73 |  |
  |  | 74 | msgid "csrf\_expire" |
  |  | 75 | msgstr "Expiration du jeton CSRF" |
  |  | 76 |  |
  |  | 77 | msgid "csrf\_expire\_help" |
  |  | 78 | msgstr "C'est le temps maximum en secondes pendant lequel un jeton CSRF est valide. Par défaut : 7200 (120 minutes). Une période de validité plus courte est plus sûre." |
  |  | 79 |  |
  |  | 80 | msgid "csrf\_regenerate" |
  |  | 81 | msgstr "CSRF à usage unique" |
  |  | 82 |  |
  |  | 83 | msgid "csrf\_regenerate\_help" |
  |  | 84 | msgstr "Si vous activez cette fonction, le jeton CSRF change chaque fois que vous ouvrez une nouvelle page d'interface graphique. Bien que cette méthode soit la plus sûre, elle présente également des inconvénients : Il n'est plus recommandé d'ouvrir différentes pages d'interface graphique dans plusieurs onglets ou fenêtres de navigateur. En effet, chaque visite d'une page dans un onglet ou un navigateur invalide automatiquement le jeton CSRF dans tous les autres onglets ou fenêtres du navigateur. Pour une sécurité maximale, vous devez activer cette fonction." |
  |  | 85 |  |
* ## [BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/it\_IT/backupcontrol.po](/trac/changeset/4034/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/it_IT/backupcontrol.po "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/it_IT/backupcontrol.po")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/it_IT/backupcontrol.po?rev=2983#L76 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/it_IT/backupcontrol.po?rev=4034#L76 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 76 | 76 | msgid "unlock\_failed" |
  | 77 | 77 | msgstr "Lo Sbloccaggio del [[base-backupcontrol.desktop\_control]] e' fallito." |
  |  | 78 |  |
  |  | 79 | ## CSRF: |
  |  | 80 |  |
  |  | 81 | msgid "csrf\_protection" |
  |  | 82 | msgstr "Protezione CSRF" |
  |  | 83 |  |
  |  | 84 | msgid "csrf\_protection\_help" |
  |  | 85 | msgstr "Cross-Site Request Forgery (CSRF) è un attacco che costringe un utente finale ad eseguire azioni indesiderate su un'applicazione web in cui è attualmente autenticato. Con un piccolo aiuto di social engineering (come l'invio di un link via e-mail o chat), un aggressore può ingannare gli utenti di un'applicazione web per fargli eseguire azioni a scelta dell'aggressore. Se la vittima è un utente normale, un attacco CSRF riuscito può costringere l'utente a eseguire richieste di modifica dello stato come la modifica delle impostazioni, l'esecuzione di transazioni all'interno della sessione autenticata e così via. Se la vittima è un conto amministrativo, il CSRF può potenzialmente compromettere l'intera applicazione web. Quando la protezione CSRF è attivata nell'interfaccia grafica, vengono attivate misure di protezione aggiuntive che hanno lo scopo di prevenire o limitare la portata di tali attacchi. Ciò avviene inserendo un campo CSRF nascosto in tutte le pagine dell'interfaccia grafica che contiene un token aggiuntivo con scadenza fissa. Su tutte le transazioni questo token CSRF nascosto viene controllato per verificarne la validità. Se si tenta di effettuare una transazione con un token CSRF non valido, la transazione non viene eseguita e viene mostrato un messaggio di errore." |
  |  | 86 |  |
  |  | 87 | msgid "csrf\_expire" |
  |  | 88 | msgstr "Scadenza del token CSRF" |
  |  | 89 |  |
  |  | 90 | msgid "csrf\_expire\_help" |
  |  | 91 | msgstr "Questo è il tempo massimo in secondi in cui un token CSRF è valido. Predefinito: 7200 (120 minuti). Un periodo di validità più breve è più sicuro." |
  |  | 92 |  |
  |  | 93 | msgid "csrf\_regenerate" |
  |  | 94 | msgstr "CSRF monouso" |
  |  | 95 |  |
  |  | 96 | msgid "csrf\_regenerate\_help" |
  |  | 97 | msgstr "Se si attiva questa funzione, il token CSRF cambia ogni volta che si apre una nuova pagina GUI. Anche se questo è il metodo più sicuro, ha anche dei lati negativi: Non è più consigliato avere diverse pagine GUI aperte in più schede o finestre del browser. Poiché ogni pagina GUI visitata in una scheda o browser invalida automaticamente il token CSRF in tutte le altre schede o finestre del browser. Per la massima sicurezza si dovrebbe abilitare questa funzione." |
  |  | 98 |  |
* ## [BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/ja\_JP/backupcontrol.po](/trac/changeset/4034/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/ja_JP/backupcontrol.po "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/ja_JP/backupcontrol.po")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/ja_JP/backupcontrol.po?rev=2983#L64 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/ja_JP/backupcontrol.po?rev=4034#L64 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 64 | 64 | msgstr "HTTPSのみ" |
  | 65 | 65 |  |
  |  | 66 | ## CSRF: |
  |  | 67 |  |
  |  | 68 | msgid "csrf\_protection" |
  |  | 69 | msgstr "CSRF保護" |
  |  | 70 |  |
  |  | 71 | msgid "csrf\_protection\_help" |
  |  | 72 | msgstr "クロスサイトリクエストフォージェリ（CSRF）は、エンドユーザーに、現在認証されているWebアプリケーションで不要なアクションを実行させる攻撃です。ソーシャルエンジニアリング（電子メールやチャットを介したリンクの送信など）の少しの助けを借りて、攻撃者はWebアプリケーションのユーザーをだまして攻撃者が選択したアクションを実行させる可能性があります。被害者が通常のユーザーである場合、CSRF攻撃が成功すると、ユーザーは設定の変更、認証されたセッション内でのトランザクションの実行など、状態変更要求を実行する必要があります。被害者が管理者アカウントである場合、CSRFはWebアプリケーション全体を危険にさらす可能性があります。 GUIでCSRF保護が有効になっている場合、そのような攻撃の範囲を防止または制限するように設計された追加の保護手段が有効になります。これは、有効期限が固定された追加のトークンを含むすべてのGUIページに非表示のCSRFフィールドを挿入することによって行われます。すべてのトランザクションで、この非表示のCSRFトークンの有効性がチェックされます。無効なCSRFトークンを使用したトランザクションが試行された場合、トランザクションは実行されず、代わりにエラーメッセージが表示されます。" |
  |  | 73 |  |
  |  | 74 | msgid "csrf\_expire" |
  |  | 75 | msgstr "CSRFトークンの有効期限" |
  |  | 76 |  |
  |  | 77 | msgid "csrf\_expire\_help" |
  |  | 78 | msgstr "これは、CSRFトークンが有効である秒単位の最大時間です。デフォルト：7200（120分）。有効期間が短いほど安全です。" |
  |  | 79 |  |
  |  | 80 | msgid "csrf\_regenerate" |
  |  | 81 | msgstr "シングルユースCSRF" |
  |  | 82 |  |
  |  | 83 | msgid "csrf\_regenerate\_help" |
  |  | 84 | msgstr "この機能を有効にすると、新しいGUIページを開くたびにCSRFトークンが変更されます。これは最も安全な方法ですが、欠点もあります。異なるGUIページを複数のタブまたはブラウザウィンドウで開くことは推奨されなくなりました。 1つのタブまたはブラウザで各GUIページにアクセスすると、他のすべてのブラウザタブまたはウィンドウでCSRFトークンが自動的に無効になるためです。最大限のセキュリティを確保するには、この機能を有効にする必要があります。" |
  |  | 85 |  |
* ## [BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/nl\_NL/backupcontrol.po](/trac/changeset/4034/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/nl_NL/backupcontrol.po "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/nl_NL/backupcontrol.po")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/nl_NL/backupcontrol.po?rev=2983#L62 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/nl_NL/backupcontrol.po?rev=4034#L62 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 62 | 62 | msgstr "HTTPS alleen" |
  | 63 | 63 |  |
  |  | 64 | ## CSRF: |
  |  | 65 |  |
  |  | 66 | msgid "csrf\_protection" |
  |  | 67 | msgstr "CSRF Bescherming" |
  |  | 68 |  |
  |  | 69 | msgid "csrf\_protection\_help" |
  |  | 70 | msgstr "Cross-Site Request Forgery (CSRF) is een aanval die een eindgebruiker dwingt om ongewenste acties uit te voeren op een webapplicatie waarin hij of zij momenteel is geauthenticeerd. Met een beetje hulp van social engineering (zoals het sturen van een link via e-mail of chat) kan een aanvaller de gebruikers van een webapplicatie verleiden tot het uitvoeren van acties van de keuze van de aanvaller. Als het slachtoffer een normale gebruiker is, kan een succesvolle CSRF-aanval de gebruiker dwingen om toestandsveranderingsverzoeken uit te voeren, zoals het wijzigen van instellingen, het uitvoeren van transacties binnen de geauthenticeerde sessie, enzovoort. Als het slachtoffer een administratief account is, kan CSRF de hele webapplicatie in gevaar brengen. Wanneer CSRF-beveiliging is ingeschakeld in de GUI, worden extra beschermingsmaatregelen ingeschakeld die bedoeld zijn om dergelijke aanvallen te voorkomen of de reikwijdte ervan te beperken. Dit gebeurt door een verborgen CSRF-veld in te voegen in alle GUI-pagina's die een extra token met een vaste vervaltijd bevatten. Bij alle transacties wordt dit verborgen CSRF-token op geldigheid gecontroleerd. Als een transactie met een ongeldig CSRF-token wordt geprobeerd, dan wordt de transactie niet uitgevoerd en wordt in plaats daarvan een foutmelding getoond." |
  |  | 71 |  |
  |  | 72 | msgid "csrf\_expire" |
  |  | 73 | msgstr "Vervaldatum CSRF-token" |
  |  | 74 |  |
  |  | 75 | msgid "csrf\_expire\_help" |
  |  | 76 | msgstr "Dit is de maximale tijd in seconden dat een CSRF-munt geldig is. Standaard: 7200 (120 minuten). Een kortere geldigheidsduur is veiliger." |
  |  | 77 |  |
  |  | 78 | msgid "csrf\_regenerate" |
  |  | 79 | msgstr "CSRF voor eenmalig gebruik" |
  |  | 80 |  |
  |  | 81 | msgid "csrf\_regenerate\_help" |
  |  | 82 | msgstr "Als u deze functie inschakelt, verandert het CSRF-token elke keer dat u een nieuwe GUI-pagina opent. Hoewel dit de meest veilige methode is, heeft het ook nadelen: Het is niet langer aan te raden om verschillende GUI-pagina's in meerdere tabbladen of browservensters te openen. Omdat elk bezoek aan een GUI-pagina in één tabblad of browser automatisch het CSRF-merkteken in alle andere browsertabbladen of -vensters ongeldig maakt. Voor maximale veiligheid moet u deze functie inschakelen." |
  |  | 83 |  |
* ## [BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/pt\_PT/backupcontrol.po](/trac/changeset/4034/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/pt_PT/backupcontrol.po "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/pt_PT/backupcontrol.po")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/pt_PT/backupcontrol.po?rev=2983#L61 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/locale/pt_PT/backupcontrol.po?rev=4034#L61 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 61 | 61 | msgid "HTTPS" |
  | 62 | 62 | msgstr "HTTPS única" |
  |  | 63 |  |
  |  | 64 | ## CSRF: |
  |  | 65 |  |
  |  | 66 | msgid "csrf\_protection" |
  |  | 67 | msgstr "Protecção CSRF" |
  |  | 68 |  |
  |  | 69 | msgid "csrf\_protection\_help" |
  |  | 70 | msgstr "Cross-Site Request Forgery (CSRF) é um ataque que força um utilizador final a executar acções indesejadas numa aplicação web na qual estão actualmente autenticados. Com uma pequena ajuda de engenharia social (como o envio de um link via correio electrónico ou chat), um atacante pode enganar os utilizadores de uma aplicação web para que executem acções à escolha do atacante. Se a vítima for um utilizador normal, um ataque CSRF bem sucedido pode forçar o utilizador a executar pedidos de alteração de estado como modificação de definições, realização de transacções dentro da sessão autenticada, e assim por diante. Se a vítima for uma conta administrativa, o CSRF pode potencialmente comprometer toda a aplicação web. Quando a protecção do CSRF é activada na GUI, são activadas medidas de protecção adicionais que são concebidas para prevenir ou limitar o alcance de tais ataques. Isto é feito através da inserção de um campo CSRF oculto em todas as páginas do GUI que contém um token adicional com tempo de expiração fixo. Em todas as transacções, este token CSRF oculto é verificado quanto à sua validade. Se for tentada uma transacção com um símbolo CSRF inválido, então a transacção não será executada e, em vez disso, é mostrada uma mensagem de erro." |
  |  | 71 |  |
  |  | 72 | msgid "csrf\_expire" |
  |  | 73 | msgstr "Prazo de validade do token CSRF" |
  |  | 74 |  |
  |  | 75 | msgid "csrf\_expire\_help" |
  |  | 76 | msgstr "Este é o tempo máximo em segundos em que um símbolo CSRF é válido. Por defeito: 7200 (120 Minutos). Um período de validade mais curto é mais seguro." |
  |  | 77 |  |
  |  | 78 | msgid "csrf\_regenerate" |
  |  | 79 | msgstr "CSRF de uso único" |
  |  | 80 |  |
  |  | 81 | msgid "csrf\_regenerate\_help" |
  |  | 82 | msgstr "Se activar esta funcionalidade, então a ficha CSRF muda cada vez que se abre uma nova página GUI. Embora este seja o método mais seguro, também tem desvantagens: Ter diferentes páginas GUI abertas em múltiplos separadores ou janelas de navegador já não é recomendado. Porque cada página GUI visitada num separador ou navegador invalida automaticamente o token CSRF em todos os outros separadores ou janelas do navegador. Para máxima segurança, deve activar esta funcionalidade." |
  |  | 83 |  |
* ## [BlueOnyx/5209R/ui/base-backupcontrol.mod/templates/rpmdefs.tmpl](/trac/changeset/4034/BlueOnyx/5209R/ui/base-backupcontrol.mod/templates/rpmdefs.tmpl "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-backupcontrol.mod/templates/rpmdefs.tmpl")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/templates/rpmdefs.tmpl?rev=2983#L103 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/templates/rpmdefs.tmpl?rev=4034#L103 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 103 | 103 | <begin $CHANGELOG> |
  | 104 | 104 |  |
  |  | 105 | \* Sun Nov 08 2020 Michael Stauber <mstauber@solarspeed.net> 1.1.0-0BX08 |
  |  | 106 | - Modified ui/chorizo/web/controllers/Desktopcontrol.php for CSRF |
  |  | 107 |  |
  | 105 | 108 | \* Mon Feb 20 2017 Michael Stauber <mstauber@solarspeed.net> 1.1.0-0BX07 |
  | 106 | 109 | - Adjusted Controller for base-alpine 2.0 |
* ## [BlueOnyx/5209R/ui/base-backupcontrol.mod/ui/chorizo/web/controllers/desktopcontrol.php](/trac/changeset/4034/BlueOnyx/5209R/ui/base-backupcontrol.mod/ui/chorizo/web/controllers/desktopcontrol.php "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-backupcontrol.mod/ui/chorizo/web/controllers/desktopcontrol.php")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/ui/chorizo/web/controllers/desktopcontrol.php?rev=2983#L126 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/ui/chorizo/web/controllers/desktopcontrol.php?rev=4034#L126 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 126 | 126 | // We have no errors. We submit to CODB. |
  | 127 | 127 |  |
  |  | 128 | if ((isset($attributes['csrf\_protection'])) || (isset($attributes['csrf\_expire'])) || (isset($attributes['csrf\_regenerate']))) { |
  |  | 129 | // Set CSRF settings to CODB: |
  |  | 130 | $CI->cceClient->set($system['OID'], '',  array('csrf\_protection' => $attributes['csrf\_protection'], 'csrf\_expire' => $attributes['csrf\_expire'], 'csrf\_regenerate' => $attributes['csrf\_regenerate'],)); |
  |  | 131 | array\_merge($errors, $CI->cceClient->errors()); |
  |  | 132 | } |
  |  | 133 |  |
  |  | 134 | if (isset($attributes['csrf\_protection'])) { |
  |  | 135 | unset($attributes['csrf\_protection']); |
  |  | 136 | } |
  |  | 137 | if (isset($attributes['csrf\_expire'])) { |
  |  | 138 | unset($attributes['csrf\_expire']); |
  |  | 139 | } |
  |  | 140 | if (isset($attributes['csrf\_regenerate'])) { |
  |  | 141 | unset($attributes['csrf\_regenerate']); |
  |  | 142 | } |
  |  | 143 |  |
  | 128 | 144 | if ((isset($attributes['GUIaccessType'])) || (isset($attributes['GUIredirects']))) { |
  | 129 | 145 | $access\_attribs['GUIaccessType'] = $attributes['GUIaccessType']; |
  | […](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/ui/chorizo/web/controllers/desktopcontrol.php?rev=2983#L206) | […](/trac/browser/BlueOnyx/5209R/ui/base-backupcontrol.mod/ui/chorizo/web/controllers/desktopcontrol.php?rev=4034#L222) |  |
  | 206 | 222 | $factory->getLabel("GUIredirects") |
  | 207 | 223 | ); |
  |  | 224 |  |
  |  | 225 | // |
  |  | 226 | //-- CSRF: |
  |  | 227 | // |
  |  | 228 |  |
  |  | 229 | // csrf\_protection: |
  |  | 230 | $csrf\_protection = $factory->getMultiChoice('csrf\_protection'); |
  |  | 231 | $enable = $factory->getOption('csrf\_protection', $system['csrf\_protection'], 'rw'); |
  |  | 232 | $xxx = $factory->getLabel('csrf\_protection', false); |
  |  | 233 | $enable->setLabel($xxx); |
  |  | 234 | $csrf\_protection->addOption($enable); |
  |  | 235 |  |
  |  | 236 | // csrf\_expire: |
  |  | 237 | $csrf\_expire = $factory->getInteger('csrf\_expire', $system['csrf\_expire'], "300", "10800", 'rw'); |
  |  | 238 | $csrf\_expire->setWidth(7); |
  |  | 239 | $csrf\_expire->showBounds(1); |
  |  | 240 | $enable->addFormField($csrf\_expire, $factory->getLabel('csrf\_expire')); |
  |  | 241 |  |
  |  | 242 | // csrf\_regenerate: |
  |  | 243 | $csrf\_regenerate = $factory->getBoolean('csrf\_regenerate', $system['csrf\_regenerate'], 'rw'); |
  |  | 244 | $enable->addFormField($csrf\_regenerate, $factory->getLabel('csrf\_regenerate')); |
  |  | 245 |  |
  |  | 246 | // Out with the enabler: |
  |  | 247 | $block->addFormField($csrf\_protection, $factory->getLabel('csrf\_protection')); |
  |  | 248 |  |
  |  | 249 | // |
  |  | 250 | //-- Lock Desktop |
  |  | 251 | // |
  | 208 | 252 |  |
  | 209 | 253 | $block->addFormField( |
* ## [BlueOnyx/5209R/ui/base-phpmyadmin.mod/Makefile](/trac/changeset/4034/BlueOnyx/5209R/ui/base-phpmyadmin.mod/Makefile "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-phpmyadmin.mod/Makefile")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/Makefile?rev=2983#L8 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/Makefile?rev=4034#L8 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 |  |
  | 9 | 9 | VERSION=2.0.0 |
  | 10 |  | RELEASE=0BX0~~8~~ |
  |  | 10 | RELEASE=0BX09 |
  | 11 | 11 |  |
  | 12 | 12 | # add a buildarch if desired |
* ## [BlueOnyx/5209R/ui/base-phpmyadmin.mod/templates/rpmdefs.tmpl](/trac/changeset/4034/BlueOnyx/5209R/ui/base-phpmyadmin.mod/templates/rpmdefs.tmpl "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-phpmyadmin.mod/templates/rpmdefs.tmpl")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/templates/rpmdefs.tmpl?rev=2983#L117 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/templates/rpmdefs.tmpl?rev=4034#L117 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 117 | 117 | <begin $CHANGELOG> |
  | 118 | 118 |  |
  |  | 119 | \* Sun Nov 08 2020 Michael Stauber <mstauber@solarspeed.net> 2.0.0-0BX09 |
  |  | 120 | - Modified ui/chorizo/web/controllers/Pusher.php for CSRF |
  |  | 121 | - Modified ui/chorizo/web/controllers/Signon.php for CSRF |
  |  | 122 |  |
  | 119 | 123 | \* Wed Feb 22 2017 Michael Stauber <mstauber@solarspeed.net> 2.0.0-0BX08 |
  | 120 | 124 | - Adjusted Controllers for base-alpine 2.0 |
* ## [BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/pusher.php](/trac/changeset/4034/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/pusher.php "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/pusher.php")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/pusher.php?rev=2983#L124 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/pusher.php?rev=4034#L124 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 124 | 124 | $BxPage->setOutOfStyle('yes'); |
  | 125 | 125 |  |
  |  | 126 | // CSRF: |
  |  | 127 | $csrf = array( |
  |  | 128 | 'name' => $CI->security->get\_csrf\_token\_name(), |
  |  | 129 | 'hash' => $CI->security->get\_csrf\_hash() |
  |  | 130 | ); |
  |  | 131 |  |
  | 126 | 132 | // Page body for auto-logins |
  | 127 | 133 | $page\_body[] = ' |
  | […](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/pusher.php?rev=2983#L131) | […](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/pusher.php?rev=4034#L137) |  |
  | 131 | 137 | <input type="hidden" name="hostname" value="' . $db\_host . '"> |
  | 132 | 138 | <input type="image" name="" value=""> |
  |  | 139 | <input type="hidden" name="' . $csrf['name'] . '" value="' . $csrf['hash'] . '" /> |
  | 133 | 140 | </form> |
  | 134 | 141 | <script language="JavaScript"> |
  | […](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/pusher.php?rev=2983#L143) | […](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/pusher.php?rev=4034#L150) |  |
  | 143 | 150 | } |
  | 144 | 151 | /\* |
  | 145 |  | Copyright (c) 20~~14~~ Michael Stauber, SOLARSPEED.NET |
  | 146 |  | Copyright (c) 20~~14~~ Team BlueOnyx, BLUEONYX.IT |
  |  | 152 | Copyright (c) 2008-2020 Michael Stauber, SOLARSPEED.NET |
  |  | 153 | Copyright (c) 2008-2020 Team BlueOnyx, BLUEONYX.IT |
  | 147 | 154 | All Rights Reserved. |
  | 148 | 155 |  |
* ## [BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/signon.php](/trac/changeset/4034/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/signon.php "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/signon.php")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/signon.php?rev=2983#L88 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/signon.php?rev=4034#L88 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 88 | 88 | $BxPage->setOutOfStyle('yes'); |
  | 89 | 89 |  |
  |  | 90 | $csrf = array( |
  |  | 91 | 'name' => $CI->security->get\_csrf\_token\_name(), |
  |  | 92 | 'hash' => $CI->security->get\_csrf\_hash() |
  |  | 93 | ); |
  |  | 94 |  |
  | 90 | 95 | $page\_body[] = "<br><br>" . addInputForm( |
  | 91 | 96 | $i18n->get("[[base-phpmyadmin.PMA\_logon]]"), |
  | […](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/signon.php?rev=2983#L95) | […](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/signon.php?rev=4034#L100) |  |
  | 95 | 100 | addTextField("PMA\_password", "password", $db\_pass, "base-phpmyadmin", "required", "rw", $i18n) . |
  | 96 | 101 | addTextField("hostname", "text", $db\_host, "base-phpmyadmin", "required", "hidden", $i18n), |
  |  | 102 | "<input type=\"hidden\" name=\"" . $csrf['name'] . "\" value=\"" . $csrf['hash'] . "\" />\n", |
  | 97 | 103 | addSaveButton($i18n), |
  | 98 | 104 | $i18n, |
  | […](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/signon.php?rev=2983#L107) | […](/trac/browser/BlueOnyx/5209R/ui/base-phpmyadmin.mod/ui/chorizo/web/controllers/signon.php?rev=4034#L113) |  |
  | 107 | 113 | } |
  | 108 | 114 | /\* |
  | 109 |  | Copyright (c) 20~~14~~ Michael Stauber, SOLARSPEED.NET |
  | 110 |  | Copyright (c) 20~~14~~ Team BlueOnyx, BLUEONYX.IT |
  |  | 115 | Copyright (c) 2008-2020 Michael Stauber, SOLARSPEED.NET |
  |  | 116 | Copyright (c) 2008-2020 Team BlueOnyx, BLUEONYX.IT |
  | 111 | 117 | All Rights Reserved. |
  | 112 | 118 |  |
* ## [BlueOnyx/5209R/ui/base-system.mod/Makefile](/trac/changeset/4034/BlueOnyx/5209R/ui/base-system.mod/Makefile "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-system.mod/Makefile")

  | [r3973](/trac/browser/BlueOnyx/5209R/ui/base-system.mod/Makefile?rev=3973#L8 "Show revision 3973 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-system.mod/Makefile?rev=4034#L8 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 |  |
  | 9 | 9 | VERSION=1.2.0 |
  | 10 |  | RELEASE=0BX2~~0~~ |
  |  | 10 | RELEASE=0BX21 |
  | 11 | 11 |  |
  | 12 | 12 | # add a buildarch if desired |
* ## [BlueOnyx/5209R/ui/base-system.mod/glue/conf/base-system.conf](/trac/changeset/4034/BlueOnyx/5209R/ui/base-system.mod/glue/conf/base-system.conf "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-system.mod/glue/conf/base-system.conf")

  | [r2986](/trac/browser/BlueOnyx/5209R/ui/base-system.mod/glue/conf/base-system.conf?rev=2986#L24 "Show revision 2986 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-system.mod/glue/conf/base-system.conf?rev=4034#L24 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | System.console  perl:base/system/console.pl EXECUTE |
  | 25 | 25 | System.\_CREATE  perl:base/system/console.pl EXECUTE |
  |  | 26 |  |
  |  | 27 | # CSRF handling: |
  |  | 28 | System.\_CREATE                  perl:base/system/csrf.pl                        EXECUTE |
  |  | 29 | System.isLicenseAccepted        perl:base/system/csrf.pl                        EXECUTE |
  |  | 30 | System.csrf\_protection          perl:base/system/csrf.pl                        EXECUTE |
  |  | 31 | System.csrf\_expire              perl:base/system/csrf.pl                        EXECUTE |
  |  | 32 | System.csrf\_regenerate          perl:base/system/csrf.pl                        EXECUTE |
* ## [BlueOnyx/5209R/ui/base-system.mod/glue/schemas/system.schema](/trac/changeset/4034/BlueOnyx/5209R/ui/base-system.mod/glue/schemas/system.schema "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-system.mod/glue/schemas/system.schema")

  | [r2986](/trac/browser/BlueOnyx/5209R/ui/base-system.mod/glue/schemas/system.schema?rev=2986#L134 "Show revision 2986 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-system.mod/glue/schemas/system.schema?rev=4034#L134 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 134 | 134 | <property name="GUIredirects" type="boolean" default="0" writeacl="ruleCapable(adminUser)" readacl="ruleAll" /> |
  | 135 | 135 |  |
  |  | 136 | <!-- CSRF related configs: --> |
  |  | 137 | <property name="csrf\_protection" type="boolean" default="1" writeacl="ruleCapable(adminUser)" readacl="ruleAll" /> |
  |  | 138 | <property name="csrf\_expire" type="int" default="7200" writeacl="ruleCapable(adminUser)" readacl="ruleAll" /> |
  |  | 139 | <property name="csrf\_regenerate" type="boolean" default="0" writeacl="ruleCapable(adminUser)" readacl="ruleAll" /> |
  |  | 140 |  |
  | 136 | 141 | </class> |
  | 137 | 142 |  |
* ## [BlueOnyx/5209R/ui/base-system.mod/templates/rpmdefs.tmpl](/trac/changeset/4034/BlueOnyx/5209R/ui/base-system.mod/templates/rpmdefs.tmpl "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-system.mod/templates/rpmdefs.tmpl")

  | [r3973](/trac/browser/BlueOnyx/5209R/ui/base-system.mod/templates/rpmdefs.tmpl?rev=3973#L126 "Show revision 3973 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-system.mod/templates/rpmdefs.tmpl?rev=4034#L126 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 126 | 126 | <begin $CHANGELOG> |
  | 127 | 127 |  |
  |  | 128 | \* Sun Nov 08 2020 Michael Stauber <mstauber@solarspeed.net> 1.2.0-0BX21 |
  |  | 129 | - Modified glue/conf/base-system.conf for CSRF handling |
  |  | 130 | - Added glue/handlers/csrf.pl for CSRF handling |
  |  | 131 | - Modified glue/schemas/system.schema for CSRF handling |
  |  | 132 | - Added constructor/csrf\_initially\_off.pl for CSRF handling |
  |  | 133 |  |
  | 128 | 134 | \* Sat Oct 31 2020 Michael Stauber <mstauber@solarspeed.net> 1.2.0-0BX20 |
  | 129 | 135 | - Modified glue/handlers/modsystem.pl to set full FQDN into /etc/hostname |
* ## [BlueOnyx/5209R/ui/base-wizard.mod/Makefile](/trac/changeset/4034/BlueOnyx/5209R/ui/base-wizard.mod/Makefile "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-wizard.mod/Makefile")

  | [r3827](/trac/browser/BlueOnyx/5209R/ui/base-wizard.mod/Makefile?rev=3827#L8 "Show revision 3827 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-wizard.mod/Makefile?rev=4034#L8 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 |  |
  | 9 | 9 | VERSION=2.0.0 |
  | 10 |  | RELEASE=0BX2~~5~~ |
  |  | 10 | RELEASE=0BX26 |
  | 11 | 11 |  |
  | 12 | 12 | # add a buildarch if desired |
* ## [BlueOnyx/5209R/ui/base-wizard.mod/templates/rpmdefs.tmpl](/trac/changeset/4034/BlueOnyx/5209R/ui/base-wizard.mod/templates/rpmdefs.tmpl "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-wizard.mod/templates/rpmdefs.tmpl")

  | [r3827](/trac/browser/BlueOnyx/5209R/ui/base-wizard.mod/templates/rpmdefs.tmpl?rev=3827#L103 "Show revision 3827 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-wizard.mod/templates/rpmdefs.tmpl?rev=4034#L103 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 103 | 103 |  |
  | 104 | 104 | <begin $CHANGELOG> |
  |  | 105 |  |
  |  | 106 | \* Sun Nov 08 2020 Michael Stauber <mstauber@solarspeed.net> 2.0.0-0BX26 |
  |  | 107 | - Modified ui/chorizo/web/controllers/Wizard.php for CSRF |
  |  | 108 | - Modified ui/chorizo/web/controllers/Wizard\_with\_ethStuff.php for CSRF |
  | 105 | 109 |  |
  | 106 | 110 | \* Fri May 22 2020 Michael Stauber <mstauber@solarspeed.net> 2.0.0-0BX25 |
* ## [BlueOnyx/5209R/ui/base-wizard.mod/ui/chorizo/web/controllers/wizard.php](/trac/changeset/4034/BlueOnyx/5209R/ui/base-wizard.mod/ui/chorizo/web/controllers/wizard.php "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-wizard.mod/ui/chorizo/web/controllers/wizard.php")

  | [r3827](/trac/browser/BlueOnyx/5209R/ui/base-wizard.mod/ui/chorizo/web/controllers/wizard.php?rev=3827#L399 "Show revision 3827 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-wizard.mod/ui/chorizo/web/controllers/wizard.php?rev=4034#L399 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 399 | 399 |  |
  | 400 | 400 | // |
  |  | 401 | //-- Activate CSRF: |
  |  | 402 | // |
  |  | 403 |  |
  |  | 404 | $CI->cceClient->setObject('System', array( |
  |  | 405 | 'csrf\_protection' => '1', |
  |  | 406 | 'csrf\_regenerate' => '0' |
  |  | 407 | ), ''); |
  |  | 408 | $errors = array\_merge($errors, $CI->cceClient->errors()); |
  |  | 409 |  |
  |  | 410 | // |
  | 401 | 411 | //-- Set TimeZone: |
  | 402 | 412 | // |
* ## [BlueOnyx/5209R/ui/base-wizard.mod/ui/chorizo/web/controllers/wizard\_with\_ethStuff.php](/trac/changeset/4034/BlueOnyx/5209R/ui/base-wizard.mod/ui/chorizo/web/controllers/wizard_with_ethStuff.php "Show the changeset 4034 restricted to BlueOnyx/5209R/ui/base-wizard.mod/ui/chorizo/web/controllers/wizard_with_ethStuff.php")

  | [r2983](/trac/browser/BlueOnyx/5209R/ui/base-wizard.mod/ui/chorizo/web/controllers/wizard_with_ethStuff.php?rev=2983#L346 "Show revision 2983 of this file in browser") | [r4034](/trac/browser/BlueOnyx/5209R/ui/base-wizard.mod/ui/chorizo/web/controllers/wizard_with_ethStuff.php?rev=4034#L346 "Show revision 4034 of this file in browser") |  |
  | --- | --- | --- |
  | 346 | 346 | } |
  | 347 | 347 |  |
  |  | 348 | // |
  |  | 349 | //-- Activate CSRF: |
  |  | 350 | // |
  |  | 351 |  |
  |  | 352 | $CI->cceClient->setObject('System', array( |
  |  | 353 | 'csrf\_protection' => '1', |
  |  | 354 | 'csrf\_regenerate' => '0' |
  |  | 355 | ), ''); |
  |  | 356 | $errors = array\_merge($errors, $CI->cceClient->errors()); |
  |  | 357 |  |
  | 348 | 358 | // |
  | 349 | 359 | //-- Set TimeZone: |
**Note:**
See [TracChangeset](/trac/wiki/TracChangeset)
for help on using the changeset viewer.

### Download in other formats:

* [Unified Diff](?format=diff&new=4034)
* [Zip Archive](?format=zip&new=4034)

---

[![Trac Powered](/trac/chrome/common/trac_logo_mini.png)](https://trac.edgewall.org/)

Powered by [**Trac 1.6**](/trac/about)

By [Edgewall Software](http://www.edgewall.org/)
.

Visit the Trac open source project at
<https://trac.edgewall.org/>



=== Content from www.blueonyx.it_bfa5aef0_20250119_114907.html ===


* [Skip to navigation](https://www.blueonyx.it/#nav "Skip to navigation")
* [Skip to content](https://www.blueonyx.it/#main "Skip to content")

[![BlueOnyx](https://www.blueonyx.it/uploads/images/BlueOnyx-CMS.png)](https://www.blueonyx.it "BlueOnyx")

Open Source Web Hosting Solution
 - Powerful and Easy to Use
  Search:

You are here: Welcome to BlueOnyx

# 5209R/5210R: YUM Updates

 09
 Nov 2020

 Posted by: mstauber
 Category: General

Cross-Site Request Forgery (CSRF) protection is now enabled by default in BlueOnyx 5209R and 5210R.

We just published YUM updates for BlueOnyx 5209R and BlueOnyx 5210R which enable Cross-Site Request Forgery (CSRF) protection by default.

[![](uploads/images/5210R/bx-csrf.png)](uploads/images/5210R/bx-csrf.png)

# General Information:

Cross-Site Request Forgery (CSRF) is an attack that forces an end user to execute unwanted actions on a web application in which they’re currently authenticated. With a little help of social engineering (such as sending a link via email or chat), an attacker may trick the users of a web application into executing actions of the attacker’s choosing.

If the victim is a normal user, a successful CSRF attack can force the user to perform state changing requests like modifying settings, performing transactions within the authenticated session, and so forth. If the victim is an administrative account, CSRF can potentially compromise the entire web application. When CSRF protection is enabled in the GUI, additional protective measures are enabled which are designed to prevent or limit the scope of such attacks.

This is done by inserting a hidden CSRF field into all GUI pages that contains an additional token with fixed expiry time. Upon all transactions this hidden CSRF token is checked for validity. If a transaction with an invalid CSRF token is attempted, then the transaction will not be performed and an error message is shown instead.

# CSRF Implementation in BlueOnyx:

After the installation of these YUM updates the CSRF implementation will be enabled automatically with the defaults shown above. All GUI pages such as the login page and all others will have a CSRF token automatically inserted. On form submit transactions (like when you save a page) the CSRF token is checked and if it's absent or doesn't match the expected CSRF token, then an error message is shown and the initiated submit transaction is not executed.

CSRF tokens by default have a validity of 7200 seconds (120 minutes), but you can adjust this value to your own liking.

Alternatively you can tick the checkbox for "Single Use CSRF" instead. In that case each page load or refresh uses a different CSRF token for maximum security. However, this might impact your normal workflow if you usually work with the GUI open in different browser windows or browser tabs. In that case returning to a previously used browser window or browser tab without refresh will result in a CSRF token mismatch, as the token in that GUI page is no longer valid.

# CSRF situation before this YUM update:

Before this YUM update only the GUI page "Personal Profile" (where password changes are possible) had a proper CSRF token protection, which prevented maliciously initiated password changes of the logged in user that still had an ongoing session.

The way the Sausalito driven GUI works CSRF attacks were already partially mitigated due to the way how the cookie based authentication works in conjunction with our Session-ID checks against CCEd on each GUI related transaction.

This implementation offers a more complete protection against CSRF attacks - especially if "Single Use CSRF" is activated.

# Updated ISO Images are available:

ISO images that include the CSRF related updates have just been released:

* BlueOnyx-5209R-CentOS-7.8-20201109.iso
* BlueOnyx-5210R-CentOS-8.2.2004-20201108.iso

These ISO images can be downloaded [here](downloads).

← [Return](https://www.blueonyx.it/)
General

Nov 9, 2020
**Category:** General
**Posted by:** mstauber

* [Welcome to BlueOnyx](https://www.blueonyx.it/)
* [Features](https://www.blueonyx.it/features)
* [News](https://www.blueonyx.it/bxnews)
* [Downloads](https://www.blueonyx.it/downloads)
* [BlueOnyx Shop](http://shop.blueonyx.it/)
* [Development](https://www.blueonyx.it/development)
* [Mailing List](https://www.blueonyx.it/mailing-list)
* [FAQ](https://www.blueonyx.it/faq)
* [User Guide](http://wiki.blueonyx.it/userguide/start)
* [Donations](https://www.blueonyx.it/donations)
* [Imprint](https://www.blueonyx.it/impressum)

News

* [General](https://www.blueonyx.it/index.php?mact=News,cntnt01,default,0&cntnt01summarytemplate=Simplex%20News%20Summary&cntnt01number=4&cntnt01detailtemplate=Simplex%20News%20Detail&cntnt01category_id=1&cntnt01returnid=15)
* [Development](https://www.blueonyx.it/index.php?mact=News,cntnt01,default,0&cntnt01summarytemplate=Simplex%20News%20Summary&cntnt01number=4&cntnt01detailtemplate=Simplex%20News%20Detail&cntnt01category_id=3&cntnt01returnid=15)

## [5210R/5211R: ISO images updated](https://www.blueonyx.it/news/349/15/5210R5211R-ISO-images-updated/d%2CSimplex%20News%20Detail "5210R/5211R: ISO images updated")

 15  Dec 2024 Posted by: mstauber  Category: General

Updated ISO and disk images for BlueOnyx 5210R and 5211R have been published. BlueOnyx 5212R development has started.

[More](https://www.blueonyx.it/news/349/15/5210R5211R-ISO-images-updated/d%2CSimplex%20News%20Detail) →
## [5210R: ISO image updated](https://www.blueonyx.it/news/348/15/5210R-ISO-image-updated/d%2CSimplex%20News%20Detail "5210R: ISO image updated")

 25  Nov 2024 Posted by: mstauber  Category: General

The BlueOnyx 5210R ISO image is now based on AlmaLinux 8.10

[More](https://www.blueonyx.it/news/348/15/5210R-ISO-image-updated/d%2CSimplex%20News%20Detail) →
## [BlueOnyx 5210R/5211R: YUM updates released](https://www.blueonyx.it/news/347/15/BlueOnyx-5210R5211R-YUM-updates-released/d%2CSimplex%20News%20Detail "BlueOnyx 5210R/5211R: YUM updates released")

 24  Nov 2024 Posted by: mstauber  Category: General

YUM updates that change the handling of PHP-FPM have been released.

[More](https://www.blueonyx.it/news/347/15/BlueOnyx-5210R5211R-YUM-updates-released/d%2CSimplex%20News%20Detail) →
## [5211R: ISO image updated](https://www.blueonyx.it/news/346/15/5211R-ISO-image-updated/d%2CSimplex%20News%20Detail "5211R: ISO image updated")

 21  Nov 2024 Posted by: mstauber  Category: General

The BlueOnyx 5211R ISO image is now based on AlmaLinux 9.5

[More](https://www.blueonyx.it/news/346/15/5211R-ISO-image-updated/d%2CSimplex%20News%20Detail) →Page 1 of 70[>](https://www.blueonyx.it/index.php?mact=News,m9c115,default,1&m9c115summarytemplate=Simplex%20News%20Summary&m9c115number=4&m9c115detailtemplate=Simplex%20News%20Detail&m9c115pagenumber=2&m9c115returnid=15&page=15) [>>](https://www.blueonyx.it/index.php?mact=News,m9c115,default,1&m9c115summarytemplate=Simplex%20News%20Summary&m9c115number=4&m9c115detailtemplate=Simplex%20News%20Detail&m9c115pagenumber=70&m9c115returnid=15&page=15)

Next page: [Features](https://www.blueonyx.it/features "Features")

© Copyright 2008 - 2025 - [SOLARSPEED.NET](https://www.solarspeed.net) and [Compass Networks](https://www.compassnetworks.com.au)

![](https://stats.blueonyx.it/piwik.php?idsite=1)

![](https://stats.blueonyx.it/matomo.php?idsite=1&rec=1)



=== Content from gist.github.com_c5533912_20250119_114905.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FCyberSecurityUP%2F26c5b032897630fe8407da4a8ef216d4)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FCyberSecurityUP%2F26c5b032897630fe8407da4a8ef216d4&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FCyberSecurityUP%2F26c5b032897630fe8407da4a8ef216d4) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FCyberSecurityUP%2F26c5b032897630fe8407da4a8ef216d4&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@CyberSecurityUP](https://avatars.githubusercontent.com/u/34966120?s=64&v=4)](/CyberSecurityUP)

# [CyberSecurityUP](/CyberSecurityUP)/**[Public CVEs (Joas Antonio)](/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4)**

Last active
May 8, 2020 08:03

Show Gist options

* [Download ZIP](/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4/archive/0b6fa9f4170a60b4d040486786722758294c85f2.zip)

* [Star
  (1)
  1](/login?return_to=https%3A%2F%2Fgist.github.com%2FCyberSecurityUP%2F26c5b032897630fe8407da4a8ef216d4)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FCyberSecurityUP%2F26c5b032897630fe8407da4a8ef216d4)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4.js&quot;&gt;&lt;/script&gt;
* Save CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4 to your computer and use it in GitHub Desktop.

[Code](/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4)
[Revisions
3](/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4/revisions)
[Stars
1](/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4/stargazers)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4.js&quot;&gt;&lt;/script&gt;

Save CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4 to your computer and use it in GitHub Desktop.

[Download ZIP](/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4/archive/0b6fa9f4170a60b4d040486786722758294c85f2.zip)

 [Raw](/CyberSecurityUP/26c5b032897630fe8407da4a8ef216d4/raw/0b6fa9f4170a60b4d040486786722758294c85f2/Public%2520CVEs%2520%28Joas%2520Antonio%29)

[**Public CVEs (Joas Antonio)**](#file-public-cves-joas-antonio)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | CVE -2018-18405: |
| --- | --- |
|  | O jQuery v2.2.2 permite o XSS por meio de um atributo onerror criado de um elemento IMG. |
|  | Reference: https://owasp.org/www-community/attacks/xss/ - |
|  | https://www.imperva.com/learn/application-security/cross-site-scripting-xss-attacks/ - |
|  | https://github.com/EdOverflow/bugbounty-cheatsheet/blob/master/cheatsheets/xss.md - |
|  |  |
|  |  |
|  | CVE-2019-19517: |
|  | Os dispositivos Intelbras RF1200 1.1.3 permitem que o CSRF faça a autenticação no |
|  | login.html sem a necessidade de acessar a interface de login, possibilitando força bruta e |
|  | até raspagem, conforme demonstrado pelo lançamento de um processo obsoleto. |
|  | Reference: https://www.youtube.com/watch?v=5ZQ9yIomSWA / |
|  | https://portswigger.net/web-security/csrf / |
|  | https://www.youtube.com/watch?v=13QPmRuhbhU |
|  |  |
|  | CVE-2019-19514: Os dispositivos |
|  | Ayision Ays-WR01 v28K.RPT.20161224 permitem o XSS armazenado nas configurações |
|  | básicas do repetidor por meio de um SSID. |
|  | Reference: https://www.youtube.com/watch?v=mKE0-Zij2lc - |
|  | https://www.rapid7.com/resources/ssid-xss-vulnerabilities-explained/ |
|  |  |
|  | CVE-2019-19515: Os dispositivos |
|  | Ayision Ays-WR01 v28K.RPT.20161224 permitem XSS armazenado nas configurações |
|  | sem fio. |
|  | Reference: https://www.youtube.com/watch?v=mKE0-Zij2lc / |
|  | https://www.rapid7.com/resources/ssid-xss-vulnerabilities-explained/ |
|  | Foi utilizado a mesma prova do conceito, só muda o campo de formulário aonde foi |
|  | injetado |
|  |  |
|  | CVE-2020-5517: |
|  | O CSRF no URI / login no BlueOnyx 5209R permite que um invasor acesse o painel e |
|  | execute raspagem ou outra análise. |
|  | Reference: https://portswigger.net/web-security/csrf / |
|  | https://www.youtube.com/watch?v=13QPmRuhbhU / |
|  | https://www.youtube.com/watch?v=I0W45zfnlWo / |
|  | https://www.youtube.com/watch?v=ArBndCZWwEs |
|  |  |
|  | CVE-2020-7983: |
|  | um problema de CSRF no login.asp nos dispositivos Ruckus R500 3.4.2.0.384 permite que |
|  | atacantes remotos acessem o painel de login |
|  | Reference: https://portswigger.net/web-security/csrf // |
|  | https://www.youtube.com/watch?v=4573oXpG4u4&amp;t=28s |
|  |  |
|  | CVE-2020-8033: |
|  | Os dispositivos Ruckus R500 3.4.2.0.384 permitem XSS através do campo index.asp |
|  | Device Name. |
|  | Reference: https://www.youtube.com/watch?v=myycj3nhLZ4 |
|  |  |
|  | CVE-2020-8829: O |
|  | CSRF nos dispositivos Intelbras CIP 92200 permite que um invasor acesse o painel e |
|  | execute raspagem ou outra análise. |
|  | Reference: https://www.youtube.com/watch?v=8tlOpzAZLlo / |
|  | https://portswigger.net/web-security/csrf |
|  |  |
|  | CVE-2020-8830: O CSRF no login.asp nos dispositivos Ruckus R500 permite que um invasor acesse o painel |
|  | e use scripts para executar raspagem ou outra análise através do campo SUBCA-1 na tela |
|  | Wireless Admin. |
|  | Reference: https://www.youtube.com/watch?v=zZxnOYhpmSA |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FCyberSecurityUP%2F26c5b032897630fe8407da4a8ef216d4)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


