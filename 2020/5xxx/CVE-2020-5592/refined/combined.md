=== Content from jvndb.jvn.jp_c27b7b83_20250119_132221.html ===


![JVN iPedia](/en/common/img/en_logo.gif)
Last Updated:2020/06/11

| [[Japanese]](/ja/contents/2020/JVNDB-2020-000038.html) | |
| --- | --- |
| JVNDB-2020-000038 | |
| Multiple vulnerabilities in Zenphoto | |
| Overview | |
| Zenphoto is a content management system (CMS). Zenphoto contains multiple vulnerabilities listed below. | |
| CVSS Severity ([What is CVSS?](/en/nav/jvndbhelp.html#jvndb3)) | |
| **CVSS V3 Severity:Base Metrics [8.8](/cvss/en/v3.html#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H) (High) [IPA Score]**  * Attack Vector: Network * Attack Complexity: Low * Privileges Required: Low * User Interaction: None * Scope: Unchanged * Confidentiality Impact: High * Integrity Impact: High * Availability Impact: High  **CVSS V2 Severity:Base Metrics [6.5](/cvss/en/v2.html#AV:N/AC:L/Au:S/C:P/I:P/A:P) (Medium) [IPA Score]**  * Access Vector: Network * Access Complexity: Low * Authentication: Single Instance * Confidentiality Impact: Partial * Integrity Impact: Partial * Availability Impact: Partial   The above CVSS base scores have been assigned for CVE-2020-5593 | |
| ---   **CVSS V3 Severity: Base Metrics: [6.1](/cvss/ja/v3.html#3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N) (Medium) [IPA Score]**  * Attack Vector: Network * Attack Complexity: Low * Privileges Required: None * User Interaction: Required * Scope: Changed * Confidentiality Impact: Low * Integrity Impact: Low * Availability Impact: None **CVSS V2 Severity:****Base Metrics: [4.3](/cvss/ja/v2.html#AV:N/AC:M/Au:N/C:N/I:P/A:N) (Medium) [IPA Score]**  * Access Vector: Network * Access Complexity: Medium * Authentication: None * Confidentiality Impact: None * Integrity Impact: Partial * Availability Impact: None The above CVSS base scores have been assigned for CVE-2020-5592 | |
| Affected Products | |
|  | |
| Zenphoto  * Zenphoto versions prior to 1.5.7 | |
|  | |
| Impact | |
| \* Arbitrary JavaScript may be executed on the user's web browser - CVE-2020-5592 | |
| Solution | |
| [Update the software] | |
| Vendor Information | |
| Zenphoto  * Zenphoto : [Zenphoto 1.5.7 (Jun 04, 2020)](https://www.zenphoto.org/news/zenphoto-1.5.7/) | |
| CWE ([What is CWE?](http://www.ipa.go.jp/security/english/vuln/CWE_en.html)) | |
| 1. [Cross-site Scripting(CWE-79)](https://www.ipa.go.jp/en/security/vulnerabilities/cwe.html) [IPA Evaluation] 2. [Code Injection(CWE-94)](https://www.ipa.go.jp/en/security/vulnerabilities/cwe.html) [IPA Evaluation] | |
| CVE ([What is CVE?](http://www.ipa.go.jp/security/english/vuln/CVE_en.html)) | |
| 1. [CVE-2020-5592](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5592) 2. [CVE-2020-5593](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5593) | |
| References | |
| 1. JVN : [JVN#32252648](http://jvn.jp/en/jp/JVN32252648/index.html) 2. National Vulnerability Database (NVD) : [CVE-2020-5592](https://nvd.nist.gov/vuln/detail/CVE-2020-5592) 3. National Vulnerability Database (NVD) : [CVE-2020-5593](https://nvd.nist.gov/vuln/detail/CVE-2020-5593) | |
| Revision History | |
| * [2020/06/11] | |

| --- | |
| --- | --- |
| Date Public | 2020/06/11 |
| Date First Published | 2020/06/11 |
| Date Last Updated | 2020/06/11 |
| --- | |

* JVN
* [HOME](https://jvn.jp/en/)
* [What is JVN ?](https://jvn.jp/en/nav/jvn.html)
* [Instructions](https://jvn.jp/en/nav/jvnhelp.html)
* [List of Vulnerability Report](https://jvn.jp/en/report/index.html)
* [VN\_JP](https://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](https://jvn.jp/en/adj/index.html)
* [VN\_VU](https://jvn.jp/en/vu/index.html)
* [TA](https://jvn.jp/en/ta/index.html)
* [TRnotes](https://jvn.jp/en/tr/index.html)
* [JVN iPedia](/en/)
* [Search](/search/index.php?mode=_vulnerability_search_IA_VulnSearch&lang=en)
* [What is JVN iPedia?](/en/nav/jvndb.html)
* [How to Use?](/en/nav/jvndbhelp.html)
* [MyJVN](/en/apis/myjvn/index.html)
* [JVNJS/RSS](https://jvn.jp/en/rss/index.html)
* [Vendor List](https://jvn.jp/en/nav/index.html)
* [List of unreachable developers](https://jvn.jp/en/reply/index.html)
* [Contact](https://jvn.jp/en/contact/index.html)

![Copyright © 2007- IPA. All rights reserved.](/common/img/copyright.png)



=== Content from www.zenphoto.org_bd11a466_20250119_113053.html ===


* [Bugtracker (GitHub)](https://github.com/zenphoto/zenphoto/issues?state=open "Bugtracker (GitHub)")
* [Get involved](/pages/get-involved/ "Get involved")
* [Stay tuned!](#footer "Get involved!")
* [Paid support](/pages/paid-support/ "Paid support")
* [Sponsors](/sponsors/ "Sponsors")

![fields](/zp-core/images/searchfields_icon.png "search options")

* \* Check/uncheck all \*
* Content
* Tags
* Title

[![ZenphotoCMS](/themes/zenphoto-theme/images/logo-new.png)ZenphotoCMS](/)

The *simpler* media website CMS

* [Home](/)
* [News](/news)
* [Demo](http://demo.zenphoto.org)
* [Screenshots](/screenshots/)
* [User Guide](/news/category/user-guide)
* [Forum](http://forum.zenphoto.org "Zenphoto forum")
* [Themes](/theme/)
* [Extensions](/news/category/extensions)
* [Showcase](/showcase/)

---

## Categories

* [All news](/news/ "All news")
* [News (325)](/news/category/news/ "News")
  + [Security (25)](/news/category/security/ "Security")
  + [Announcements (165)](/news/category/announcements/ "Announcements")
  + [Changelog (113)](/news/category/changelog/ "Changelog")
  + [Release (138)](/news/category/release/ "Release")
* [User guide (56)](/news/category/user-guide/ "User guide")
* [Extensions (282)](/news/category/extensions/ "Extensions")

---

Advertisements

[![ALL-INKL.COM - Webhosting Server Hosting Domain Provider](https://all-inkl.com/banner/all-inkl_banner_185x35_white.gif)](https://all-inkl.com/PA48F18DCC89C8D)

[![Advertise](/albums/storage/sponsor-placeholders/sponsorpalladium-placeholder-ad.gif)](/pages/advertise/ "Advertise")

---

![](/themes/zenphoto-theme/images/icon-forum.png)
### Like using Zenphoto? Donate!

Your support helps pay for this server, and helps development of zenphoto. Thank you!

Visit the [donations page](/pages/donations/ "donations page")

News
# Zenphoto 1.5.7 June 04, 2020

Categories:

* [Changelog](/news/category/changelog/ "Changelog"),
* [News](/news/category/news/ "News"),
* [Release](/news/category/release/ "Release"),
* [Security](/news/category/security/ "Security")

## Content

1. [Developer note](#--developer-note)
2. [Security](#--security)
3. [General](#--general)
4. [Plugins](#--plugins)
5. [Translations](#--translations)

## Contributors:

* adrav
* ballinette
* [Vincent Bourganel *(vincent3569)*![Zenphoto former team member](/themes/zenphoto-theme/images/authoricon_former-small.png)](/pages/vincent3569/)
* [JPCERT Coordination Center *(jpcert)*](/pages/jpcert/)
* [Gwendal Le Coguic *(gwen001)*](/pages/gwen001/)
* [Jakub Meisner *(tangorn)*![Zenphoto team member](/themes/zenphoto-theme/images/authoricon_developer-small.png)](/pages/tangorn/)
* [Malte Müller *(acrylian)*![Zenphoto team member](/themes/zenphoto-theme/images/authoricon_developer-small.png)](/pages/acrylian/)
* [Antonio Ranesi *(bic)*![Zenphoto team member](/themes/zenphoto-theme/images/authoricon_developer-small.png)](/pages/bic/)
* sec-consult
* [Fred Sondaar *(fretzl)*![Zenphoto team member](/themes/zenphoto-theme/images/authoricon_developer-small.png)](/pages/fretzl/)

This is a bugfix and security release.

## Developer note

This will be possibly the last 1.5.x release. We will only try to fix serious bugs. The 1.5.x release stream is therefore frozen now. The next release will hopefully be the planned "major release" we already mentioned several times. Due to serious time issues we can't afford to work on two release streams simultaneously anymore. That's why, from now on, we will concentrate our efforts on the next major release only. Note that almost everything we wrote on [https://www.zenphoto.org/news/developer-note-the-mysterious-next-major-release/](/news/developer-note-the-mysterious-next-major-release/) still applies. Thanks for understanding.

## Security

* Fixes XSS issue in /page/search/ parameters [acrylian – Thanks to gwen001]
* Fixes local file disclosure related to log files on backend pages [acrylian – Thanks to gwen001]
* Fixes setup process code injection [acrylian – Thanks to gwen001]
* Fixes authenticated SQL injection in postAlbumSort() on backend pages [acrylian – Thanks to gwen001]
* Editing executional theme files via the basic theme editor now requires full admin rights. Theme rights are not sufficient anymore. This is only suitable for quick simple edits so you should use a proper editor on a local test server anyway [acrylian – Thanks to the SEC Consult Vulnerability Lab]
* Fixes upload of arbitrary files in *elFinder* plugin. Details below.
* Fixes possible XSS issue in the html\_encodeTagged() function used e.g. for printing album, image descriptions or page and news article content. [acrylian – Thanks to JPCERT/CC]
* Removes very old third PCLZIP fallback library not being able to filter supported file formats contained wiithin archives, which would potentially allow to sneak in unwanted and executional files.This library had no updates since 2009. Therefore the native PHP ZipArchive extension now required for extracting zips. Setup now checks for this [acrylian – Thanks to JPCERT/CC]

## General

* Fix placeholder page not loading properly if the site\_upgrade plugin is used to close the site. Also add default placeholder page within the root index.php in case the site\_updated placeholder files are not generated properly or the site is closed via the config file directly [acrylian]
* Fixes broken sortdirection for images in dynamic albums/search if sorted by title [acrylian]
* Fix unnecessary exceeding of the server side max\_input\_vars limit if saving image sortorder for large albums. Add a form post truncation warning if using a bulk action and exceeding its limit. Consolidate messages and update post truncation message to tell about the actual issue [acrylian - Thanks to adrav]
* New function printLangAttribute() function that prints a "lang" attribute with a locale. It for example can (and should) be added to your theme as <html<?php printLangAttribute(); ?>>. Locales like en\_US get the underscores replaced by hyphens (en-US) using the new getLangAttributeLocale() function to be vaild [acrylian]
* Fixes a bug that unpublished albums and their images were shown as search results even if the logged in user did not have appropiate rights to this. [acrylian]
* Fix MySQL issue with getNotViewableImages() affecting e.g. tag\_suggest plugin in check tag access mode and there are no non-viewable albums [acrylian]
* Several user interface changes regarding scheduled publishing (= future publishing and expiration) for singe edit pages and also list display. [acrylian, fretzl]
  + There are now new icons indicating the publish status regarding future publishing or expiration. If you have set both future publishing and expiration lists will indicate future publishing by specific icons.
  + The album list now display the future publishing and/or the expire date if set.
  + Also there are now better visual notes regarding the status. Since future published items need to be already published (in order to be "ready to be published"), the checkbox now actually reflects that status.
* The publish status icon on the image thumbnail tab has been relocated below the thumbnail with some re-ordering of the existing icons, e.g. the checkbox for bulk actions is now on the right as on all other content lists for consistency. It also reflects any future publishing or expiration schedule active. The icon is now also a button/link so you can directly change the pubish status of an image.
* Setup now lists the server software found and throws a warning if it is/seems to be neither Apache or Nginx as we primarily test on Apache. Also the admin main page lists this info now.
* The MySQL handler is deprecated now and will throw a constant debug log notice if you are still on older PHP versions than 7. Setup also will throw a warning. The PHP MySQL handler has been removed in PHP 7 already. Use MySQLi or PDO\_MySQL instead. [acrylian]
* Safe mode checks have been removed as it has been removed since PHP 5.4. already [acrylian]
* Several deprecations for PHP 7.4+ compatibility fixed [acrylian, fretzl]:
  + Removes any usages of magic\_quotes since its functionality is already gone since PHP 5.4 anyway
  + Fixes deprecated array and string offset access syntax with curly braces
  + Fixes deprecated unparenthesized ternary operators
* You can now set the MySQL port via the config file if you need to. Add $conf['mysql\_port'] = "<port>"; to /zp-data/zenphoto.cfg.php. Setup willl add the default port 3306 if not present yet which is sufficient for most web servers. Note that the port will be ignored if you use "localhost" as the database server name, use the IP address instead. On a new install you can add it via the form to enter your credentials [acrylian]
* The Content-Security-Policy header on the Zenphoto backend now allows browsers to look for images in the server root. This way browsers can check if a favicon.ico file is present without being blocked [fretzl]
* secureServer function: consider https requests behind reverse proxies <https://www.nginx.com/resources/wiki/start/topics/examples/forwarded/> [ballinette]

## Plugins

* **auto\_backup/backup\_restore:** Change wording that this actualy does not backup the database itself but the content of it. For a real database backup you need to use tools like phpMyAdmin [acrylian]
* **class-video:** Update getID3 to 1.9.19. [fretzl]
* **class-textobject:** The wrapper generated is now a <div> instead a <span> to allow a wider array of HTML elements to be used within it [acrylian]
* **defaultCodeblocks**: Fix option class method declared static incorrectly [acrylian]
* **downloadList:**
  + Adds printFullImageDownloadURL() for easier image download usage [acrylian]
  + Fixes support for external albums folder [fretzl|
  + Fixes zips from cache. Note that this uses default sized images and will fail if these are not already generated (not every theme uses these sizes) [acrylian]
* **elFinder:**
  + Uploading abritary like php files, any application/\* mime type files and html files that may be directly executed is now forbidden for users with only theme rights or files rights. You need full admin rights for this now. This was submitted as a general security issue to us. We did agree that lower rank possibly should not have this ability but didn't agree that the full admin shouldn't as at least the site owner is full admin always. If he grants anyone else such high rights it is his responsibility to do so. [acrylian - Thanks to the SEC Consult Vulnerability Lab]
  + Update elFinder to 2.1.53 [fretzl]
* **html\_meta\_tags:** Removes htmlmeta\_pragma options as it offers invalid selections "cache" and "no-cache" but this attribute [actually only allows "no-cache"](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Pragma) or should not be set at all. So if you enable the http-equiv='pragma' option in the HTML meta tags checkbox list option it is automatically set to "no-cache". Check your settings also with other cache related meta tags  to avoid issues! [acrylian]
* **jquery-uploader:** Lost support for uploading and extraction zip archives with supported file formats has been restored (native PHP extension ZipArchive required) [acrylian]
* **menu\_manager** [acrylian, fretzl]
  + Changes behaviour of function getCurrentMenuItem() which neither did what the function name suggested (the full item array) nor the sort\_order as the doc block told. In fact it returned the key of the item within the items array. There is now a new second parameter $field that allows to either get the full item array, a certain field of the item or the key to cover all use cases. The sort\_order field is the default as that was the general use case. If you used this in custom code you need to update accordingly.
    - Fixes also getMenuItemChilds() and getParentMenuItems() to actually get those items.
  + Fixes parent menu items not being assigned an active class if a child item is active; correctly assigns top active class to top level items and active class to sub items only. Also the sub active class now has the correct level of the item added as the order was reversed somehow.
    - Fixes the related issue with "invented menu items". Generally the menu\_manager is for custom structures outside the actual site structure, so parents only get active if there is a menu sub item to them. There are two exceptions from this: Images within an album and news articles in relation of the newsindex. Images and news articles have no menu item type and therefore are "invented" to trigger their album respectively the newsindex.
  + Fixes unwantedly active menu entry if selectiing a Zenpage category
  + Fix minor bug with updating menulabel type menu entries
  + Fix menu\_manager issue that using the show/hide menu entry button didn't return to the selected menuset
  + Fix album/image or category count appearing on other menu entry types.
  + Support for using static class methods as menu function
* **openstreetmap:** Upgrade leafleat 1.6 + leaflet-providers 1.9.1 [vincent3569]
* **PHPMailer** [fretzl]
  + Update the PHPMailer to 6.1.3.
  + Override behaviour where encryption is automatically enabled when advertised by the server, even if you have set the plugin option "Secure mail" to "no".
* **Zenpage:** Several user interface changes regarding scheduled publishing. See General above for detals [acylian, fretzl]

## Translations

* Dutch [fretzl]
* French [vincent3569]
* German [acrylian]
* Italian [bic-ed]
* Slovak [tangorn]

*For questions and comments please use the [forum](http://www.zenphoto.org/support "Zenphoto forums") or discuss on the [social networks](#stay-tuned).*

## Related items

* ### [Zenphoto 1.6.5](/news/zenphoto-1.6.5/ "Zenphoto 1.6.5") (News)
* ### [Secure submitting of forms](/news/secure-submitting-of-forms/ "Secure submitting of forms") (User guide)
* ### [tinymce](/news/tinymce/ "tinymce") (Extensions)
* ### [Zenphoto 1.6.4](/news/zenphoto-1.6.4/ "Zenphoto 1.6.4") (News)
* ### [Zenphoto 1.6.3](/news/zenphoto-1.6.3/ "Zenphoto 1.6.3") (News)

### RSS feeds!

* [All news](/index.php?mergedrss "RSS all news") (incl. all below except forum)
* [All general news](/index.php?rss=news "RSS all general news") (except themes, showcase, screenshots)
* [New releases and announcements](/index.php?rss=news&category=news "RSS New releases and announcements")
* [User guide](/index.php?rss=news&category=user-guide "RSS User guide")
* [Extensions](/index.php?rss=news&category=extensions "RSS Extensions")
* [Screenshots and screencasts](/index.php?rss=gallery&folder=screenshots "RSS Screenshots	and screencasts")
* [Themes](/index.php?rss=gallery&folder=theme&albumsmode&sortorder=latest "RSS Themes")
* [Showcase](/index.php?rss=gallery&albumname=showcase "RSS Showcase")
* [Forum](http://forum.zenphoto.org/discussions/feed.rss)

### Social networks

* [Twitter](http://twitter.com/zenphotocms "Zenphoto on Twitter")
* [GitHub](https://github.com/zenphoto/zenphoto "Zenphoto on GitHub")
* [Facebook](https://www.facebook.com/zenphotocms "Zenphoto on Facebook")
* [Youtube](http://www.youtube.com/zenphotocms "Zenphoto on Youtube")

### Join the Google Group!

* [zenphoto-announce](https://groups.google.com/group/zenphoto-announce)
  Release announcements and security alerts only (no support)

  **Subscribe right here:**

  Email:

Website powered by Zenphoto

Forum powered by [Vanilla](https://open.vanillaforums.com)

### Information

* [About us](/pages/about-us/ "About us")
* [Contact](/pages/contact/ "Contact")
* [Get involved](/pages/get-involved/ "Get involved")
* [Paid support](/pages/paid-support/ "Paid support")
* [Advertise](/pages/advertise/ "Advertise")
* [Bugtracker (GitHub)](https://github.com/zenphoto/zenphoto/issues?state=open "Bugtracker (GitHub)")

### Legal stuff

* [Legal](/pages/legal/ "Legal")
* [Forum Terms Of Service](/pages/forum-terms-of-service/ "Forum Terms Of Service ")
* [Data Privacy Policy](/pages/data-privacy-policy/ "Data Privacy Policy")

![](https://stats.zenphoto.org/matomo.php?idsite=1&rec=1)



=== Content from jvn.jp_55ca3b8a_20250119_113051.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2020/06/11  Last Updated:2020/06/11
# JVN#32252648 Multiple vulnerabilities in Zenphoto

## Overview

Zenphoto contains multiple vulnerabilities.

## Products Affected

* Zenphoto versions prior to 1.5.7

## Description

Zenphoto is a content management system (CMS).  Zenphoto contains multiple vulnerabilities listed below.

* **Cross-site Scripting ([CWE-79](https://cwe.mitre.org/data/definitions/79.html))** - CVE-2020-5592

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N | **Base Score: 6.1** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:M/Au:N/C:N/I:P/A:N | **Base Score: 4.3** |
* **Code Injection ([CWE-94](https://cwe.mitre.org/data/definitions/94.html))** - CVE-2020-5593

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H | **Base Score: 8.8** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:S/C:P/I:P/A:P | **Base Score: 6.5** |

## Impact

* Arbitrary JavaScript may be executed on the user's web browser - CVE-2020-5592
* Arbitrary PHP code may be executed on the server where the product is running if a specialy crafted .zip file by an attacker is uploaded - CVE-2020-5593

## Solution

**Update the software**

Update the software to the latest version according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| Zenphoto | [Zenphoto 1.5.7 (Jun 04, 2020)](https://www.zenphoto.org/news/zenphoto-1.5.7/) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

## Credit

Tomohisa Maeda of Panasonic Corporation, Product Security Center reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2020-5592](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5592) |
|  | [CVE-2020-5593](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5593) |
| JVN iPedia | [JVNDB-2020-000038](https://jvndb.jvn.jp/jvndb/JVNDB-2020-000038) |

## Update History

2020/06/11
Fixed the typo under the section [Description] and [Impact]

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2020 JPCERT/CC and IPA. All rights reserved.


