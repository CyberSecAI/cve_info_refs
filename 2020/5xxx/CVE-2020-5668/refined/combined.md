=== Content from www.mitsubishielectric.com_7fad153f_20250119_121636.html ===
Denial-of-Service Vulnerability in MELSEC iQ-R Series Ethernet Port

Release date: November 19, 2020
Last update date: December 16, 2021
Mitsubishi Electric Corporation

■Overview

Mitsubishi  Electric  is  aware  of  a  denial-of-service  (DoS)  vulnerability  in  MELSEC  iQ-R  series  modules  due  to  uncontrolled
resource  consumption.  When  a  module  receives  a  specially  crafted  SLMP  packet  from  a  malicious  attacker,  the  program
execution and communication may enter a DoS condition (CVE-2020-5668).
The product models and firmware versions affected by this vulnerability are listed below.

■CVSS
    CVE-2020-5668    CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H    Base Score:7.5

■Affected products

The following MELSEC iQ-R series modules are affected:

Series
iQ-R series

Model name
R00/01/02CPU
R04/08/16/32/120(EN)CPU
R08/16/32/120SFCPU
R08/16/32/120PCPU
R08/16/32/120PSFCPU
RJ71EN71
RJ71GF11-T2
RJ72GF15-T2
RJ71GP21-SX
RJ71GP21S-SX
RJ71GN11-T2

Version
firmware versions "19" and earlier
firmware versions "51" and earlier
firmware versions "22" and earlier
firmware versions "25" and earlier
firmware versions "06" and earlier
firmware versions "47" and earlier
firmware versions "47" and earlier
firmware versions "07" and earlier
firmware versions "47" and earlier
firmware versions "47" and earlier
firmware versions "11" and earlier

The firmware version of the module can be checked on the following "Product Information List(Fig 1)" window of system monitor
in GX Works3.
Please check the manual of the affected product for how to check.

Fig 1 Product Information List

■Description

A denial-of-service (DoS) vulnerability due to uncontrolled resource consumption (CWE-400) exists in MELSEC iQ-R series
modules.

■Impact

When a module receives a specially crafted SLMP packet from a malicious attacker, the module may enter the following condition.
To recover it, a reset is required.

①  CPU module

An error may occur on the CPU module then the program execution and communication may enter a DoS condition.

②  Other than CPU module

Communication via the module may enter a DoS condition.

■Countermeasures

Series
iQ-R Series

The following modules have been fixed.
Model name
R00/01/02CPU
R04/08/16/32/120（EN）CPU
R08/16/32/120SFCPU
R08/16/32/120PCPU
R08/16/32/120PSFCPU
RJ71EN71
RJ71GF11-T2
RJ72GF15-T2
RJ71GP21-SX
RJ71GP21S-SX

RJ71GN11-T2

■Mitigations

Version
firmware versions "20" or later
firmware versions "52" or later
firmware versions "23" or later
firmware versions "26" or later
firmware versions "07" or later
firmware versions "48" or later
firmware versions "48" or later
firmware versions "08" or later
firmware versions "48" or later
firmware versions "48" or later

firmware versions "12" or later

Mitsubishi Electric recommends that customers take the following mitigation measures to minimize the risk of exploiting this
vulnerability:
- Use a firewall or virtual private network (VPN), etc. to prevent unauthorized access when Internet access is required.
- Use within a LAN and block access from untrusted networks and hosts through firewalls.

■Acknowledgement

Mitsubishi Electric would like to thank Xiaofei.Zhang of China Industrial Control Systems Cyber Emergency Response Team who
reported this vulnerability.

■Contact information

Please contact your local Mitsubishi Electric representative.

■Update history

December 16, 2021

RJ71C24  (-R2/R4)  has  been  removed  from  “Affected  products”  as  it  has  been  found  not  to  be  affected  by  this
vulnerability.

September 14, 2021

Added RJ71GN11-T2 that has been fixed to “Countermeasures".

May 18, 2021

Added R08/16/32/120 PCPU and R08/16/32/120PSFCPU that have been fixed to “Countermeasures".



=== Content from jvn.jp_1e2a08b8_20250119_121601.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

å¬éæ¥ï¼2020/11/19ãæçµæ´æ°æ¥ï¼2021/12/16
# JVNVU#95980140 ä¸è±é»æ©è£½ MELSEC iQ-R ã·ãªã¼ãºã«ããããªã½ã¼ã¹æ¯æ¸ã®èå¼±æ§

## æ¦è¦

ä¸è±é»æ©æ ªå¼ä¼ç¤¾ãæä¾ãã MELSEC iQ-R ã·ãªã¼ãºã«ã¯ããªã½ã¼ã¹æ¯æ¸ã®èå¼±æ§ãå­å¨ãã¾ãã

## å½±é¿ãåããã·ã¹ãã

MELSEC iQ-R ã·ãªã¼ãºã®ã¦ãããã®ãã¡ãæ¬¡ã®è£½åå½¢åã¨ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ã®ãã®ãå½±é¿ãåãã¾ãã

* R00/01/02CPU ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "19" ããã³ããä»¥å
* R04/08/16/32/120 (EN) CPU ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "51" ããã³ããä»¥å
* R08/16/32/120SFCPU ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "22" ããã³ããä»¥å
* R08/16/32/120PCPU ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "25" ããã³ããä»¥å
* R08/16/32/120PSFCPU ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "06" ããã³ããä»¥å
* RJ71EN71 ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "47" ããã³ããä»¥å
* RJ71GF11-T2 ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "47" ããã³ããä»¥å
* RJ72GF15-T2 ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "07" ããã³ããä»¥å
* RJ71GP21-SX ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "47" ããã³ããä»¥å
* RJ71GP21S-SX ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "47" ããã³ããä»¥å
* RJ71GN11-T2 ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "11" ããã³ããä»¥å

## è©³ç´°æå ±

ä¸è±é»æ©æ ªå¼ä¼ç¤¾ãæä¾ãã MELSEC iQ-R ã·ãªã¼ãºã®ã¦ãããã«ã¯ããªã½ã¼ã¹æ¯æ¸ã®èå¼±æ§ ([CWE-400](https://cwe.mitre.org/data/definitions/400.html)) ãå­å¨ãã¾ãã

## æ³å®ãããå½±é¿

é éã®ç¬¬ä¸èã«ãã£ã¦ç´°å·¥ããã SLMP ãã±ãããåä¿¡ãããã¨ã§æ¬¡ã®ãããªå½±é¿ãåããå¯è½æ§ãããã¾ãã

* CPU ã¦ãããã®å ´åãã¨ã©ã¼ãçºçãããã­ã°ã©ã ã®å®è¡ããã³éä¿¡ããµã¼ãã¹éç¨å¦¨å®³ (DoS) ç¶æã¨ãªã
* CPU ã¦ãããä»¥å¤ã®å ´åãã¦ãããçµç±ã®éä¿¡ããµã¼ãã¹éç¨å¦¨å®³ (DoS) ç¶æã¨ãªã

ãªããå¾©æ§ã«ã¯ãªã»ãããå¿è¦ã§ãã

## å¯¾ç­æ¹æ³

**ã¢ãããã¼ããã**

éçºèãæä¾ããæå ±ããã¨ã«ã¢ãããã¼ããã¦ãã ããã

* R00/01/02CPU ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "20" ããã³ããä»¥é
* R04/08/16/32/120 (EN) CPU ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "52" ããã³ããä»¥é
* R08/16/32/120SFCPU ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "23" ããã³ããä»¥é
* R08/16/32/120PCPU ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "26" ããã³ããä»¥é
* R08/16/32/120PSFCPU ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "07" ããã³ããä»¥é
* RJ71EN71 ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "48" ããã³ããä»¥é
* RJ71GF11-T2 ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "48" ããã³ããä»¥é
* RJ72GF15-T2 ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "08" ããã³ããä»¥é
* RJ71GP21-SX ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "48" ããã³ããä»¥é
* RJ71GP21S-SX ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "48" ããã³ããä»¥é
* RJ71GN11-T2 ãã¡ã¼ã ã¦ã§ã¢ãã¼ã¸ã§ã³ "12" ããã³ããä»¥é

**ã¯ã¼ã¯ã¢ã©ã¦ã³ããå®æ½ãã**

éçºèã«ããã¨ãã¢ãããã¼ããé©ç¨ã§ããªãå ´åã«ã¯ãæ¬¡ã®åé¿ç­ãé©ç¨ãããã¨ã§ãæ¬èå¼±æ§ã®å½±é¿ãè»½æ¸ãããã¨ãå¯è½ã¨ã®ãã¨ã§ãã

* å½è©²è£½åãã¤ã³ã¿ã¼ãããã«æ¥ç¶ããå ´åã«ã¯ããã¡ã¤ã¢ã¦ã©ã¼ã«ãä»®æ³ãã©ã¤ãã¼ããããã¯ã¼ã¯ (VPN) ãªã©ãä½¿ç¨ãã
* å½è©²è£½åã LAN åã§ã®ä½¿ç¨ã«éå®ããä¿¡é ¼ã§ããªããããã¯ã¼ã¯ããã¹ãããã®ã¢ã¯ã»ã¹ãå¶éãã

è©³ããã¯ãéçºèãæä¾ããæå ±ãåç§ãã¦ãã ããã

## ãã³ãæå ±

| ãã³ã | ãªã³ã¯ |
| --- | --- |
| ä¸è±é»æ©æ ªå¼ä¼ç¤¾ | [MELSEC iQ-Rã·ãªã¼ãºã®Ethernetãã¼ãã«ããã ãµã¼ãã¹æå¦(DoS)ã®èå¼±æ§](https://www.mitsubishielectric.co.jp/psirt/vulnerability/pdf/2020-016.pdf) |

## åèæå ±

1. [ICS Advisory (ICSA-20-324-05)](https://us-cert.cisa.gov/ics/advisories/icsa-20-324-05)
   Mitsubishi Electric MELSEC iQ-R Series

## JPCERT/CCããã®è£è¶³æå ±

## JPCERT/CCã«ããèå¼±æ§åæçµæ

CVSS v3
CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
åºæ¬å¤:
7.5

| æ»æååºå(AV) | ç©ç (P) | ã­ã¼ã«ã« (L) | é£æ¥ (A) | ãããã¯ã¼ã¯ (N) |
| --- | --- | --- | --- | --- |
| æ»ææ¡ä»¶ã®è¤éã(AC) | é« (H) | ä½ (L) |
| å¿è¦ãªç¹æ¨©ã¬ãã«(PR) | é« (H) | ä½ (L) | ä¸è¦ (N) |
| ã¦ã¼ã¶é¢ä¸ã¬ãã«(UI) | è¦ (R) | ä¸è¦ (N) |
| ã¹ã³ã¼ã(S) | å¤æ´ãªã (U) | å¤æ´ãã (C) |
| æ©å¯æ§ã¸ã®å½±é¿(C) | ãªã (N) | ä½ (L) | é« (H) |
| å®å¨æ§ã¸ã®å½±é¿(I) | ãªã (N) | ä½ (L) | é« (H) |
| å¯ç¨æ§ã¸ã®å½±é¿(A) | ãªã (N) | ä½ (L) | é« (H) |

## è¬è¾

ãã®èå¼±æ§æå ±ã¯ãè£½åå©ç¨èã¸ã®å¨ç¥ãç®çã«ãéçºèã JPCERT/CC ã«å ±åããJPCERT/CC ãéçºèã¨ã®èª¿æ´ãè¡ãã¾ããã

## é¢é£ææ¸

| JPCERT ç·æ¥å ±å |  |
| --- | --- |
| JPCERT REPORT |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2020-5668](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5668) |
| JVN iPedia |  |

## æ´æ°å±¥æ­´

2020/11/20
ãåèæå ±ãã« ICS Advisory ã®ãªã³ã¯ãè¿½å ãã¾ããã
2021/05/18
ãå½±é¿ãåããã·ã¹ãã ãã¨ãå¯¾ç­æ¹æ³ããæ´æ°ãã¾ããã
2021/09/14
ãå½±é¿ãåããã·ã¹ãã ãã¨ãå¯¾ç­æ¹æ³ããæ´æ°ãã¾ããã
2021/12/16
ãå½±é¿ãåããã·ã¹ãã ãã¨ãå¯¾ç­æ¹æ³ããæ´æ°ãã¾ããã

* ![JVN](/common/img/t_rnav_jvn.gif)
* [![HOME](/common/img/r_nav_1.gif)](/index.html)
* [![JVNã¨ã¯](/common/img/r_nav_2.gif)](/nav/jvn.html)
* [![èå¼±æ§ã¬ãã¼ãã®èª­ã¿æ¹](/common/img/r_nav_3.gif)](/nav/jvnhelp.html)
* [![èå¼±æ§ã¬ãã¼ãä¸è¦§](/common/img/r_nav_4.gif)](/report/index.html)
* [![VN_JP](/common/img/r_nav_4_1.gif)](/jp/index.html)
* [![VN_JPï¼é£çµ¡ä¸è½ï¼](/common/img/r_nav_4_4.gif)](/adj/index.html)
* [![VN_VU](/common/img/r_nav_4_2.gif)](/vu/index.html)
* [![VN_TA](/common/img/r_nav_4_3.gif)](/ta/index.html)
* [![TRnotes](/common/img/r_nav_5.gif)](/tr/index.html)
* [![JVN iPedia](/common/img/r_nav_10.gif)](http://jvndb.jvn.jp/)
* [![MyJVN](/common/img/r_nav_10_4.gif)](http://jvndb.jvn.jp/apis/myjvn/index.html)
* [![JVNJS/RSS](/common/img/r_nav_6.gif)](/rss/index.html)
* [![ãã³ãæå ±ä¸è¦§](/common/img/r_nav_7.gif)](/nav/index.html)
* [![é£çµ¡ä¸è½éçºèä¸è¦§](/common/img/r_nav_11.gif)](/reply/index.html)
* [![èå¼±æ§æå ±ã®å±åº](/common/img/r_nav_8.gif)](http://www.ipa.go.jp/security/vuln/report/)
* [![ãååãå](/common/img/r_nav_9.gif)](/contact/index.html)

Copyright (c) 2000-2021 JPCERT/CC and IPA. All rights reserved.



=== Content from www.mitsubishielectric.co.jp_08114df8_20250119_121634.html ===
MELSEC iQ-R シリーズの Ethernet ポートにおける
サービス拒否(DoS)の脆弱性

公開日  2020 年  11 月  19 日
最終更新日  2021 年  12 月 16 日
三菱電機株式会社

■概要

MELSEC  iQ-R シリーズのユニットには、リソース枯渇によるサービス拒否(DoS)の脆弱性が存在することが判明しました。ユニ
ットが攻撃者からの不正な SLMP パケットを受信すると、プログラム実行や通信が DoS 状態に陥る可能性があります。(CVE-
2020-5668)
  この脆弱性の影響を受ける製品形名およびファームウェアバージョンを以下に示します。

■CVSS スコア
    CVE-2020-5668    CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H    基本値：7.5

■該当製品の確認方法

  MELSEC iQ-R シリーズのユニットのうち、次の製品形名とファームウェアバージョンのものが影響を受けます。

シリーズ
iQ-R シリーズ

形名
R00/01/02CPU
R04/08/16/32/120（EN）CPU
R08/16/32/120SFCPU
R08/16/32/120PCPU
R08/16/32/120PSFCPU
RJ71EN71
RJ71GF11-T2
RJ72GF15-T2
RJ71GP21-SX
RJ71GP21S-SX
RJ71GN11-T2

バージョン
ファームウェアバージョン"19"以前
ファームウェアバージョン"51"以前
ファームウェアバージョン"22"以前
ファームウェアバージョン"25"以前
ファームウェアバージョン"06"以前
ファームウェアバージョン"47"以前
ファームウェアバージョン"47"以前
ファームウェアバージョン"07"以前
ファームウェアバージョン"47"以前
ファームウェアバージョン"47"以前
ファームウェアバージョン"11"以前

ユニットのファームウェアバージョンは GX Works3 のシステムモニタにある、下記の製品情報一覧（図 1）より確認できます。
確認方法は、各製品のマニュアルをご参照ください。

図 1  製品情報一覧

■脆弱性の説明

MELSEC iQ-R シリーズのユニットには、リソース枯渇（CWE-400）によるサービス拒否(DoS)の脆弱性が存在します。

■脆弱性がもたらす脅威

ユニットが攻撃者から不正な SLMP パケットを受信すると、それぞれ以下の状態となる可能性があります。なお，復旧にはユニ
ットのリセットが必要になります。

①  CPU ユニットの場合
    エラーが発生し、プログラム実行および通信が DoS 状態に陥る可能性があります。

②  CPU ユニット以外の場合
    ユニット経由の通信が DoS 状態に陥る可能性があります。

■対策方法

下記ユニットにおいては対策を実施済みです。
シリーズ
iQ-R シリーズ

形名
R00/01/02CPU
R04/08/16/32/120（EN）CPU
R08/16/32/120SFCPU
R08/16/32/120PCPU
R08/16/32/120PSFCPU
RJ71EN71
RJ71GF11-T2
RJ72GF15-T2
RJ71GP21-SX
RJ71GP21S-SX

RJ71GN11-T2

■回避策

バージョン
ファームウェアバージョン"20"以降
ファームウェアバージョン"52"以降
ファームウェアバージョン"23"以降
ファームウェアバージョン"26"以降
ファームウェアバージョン"07"以降
ファームウェアバージョン"48"以降
ファームウェアバージョン"48"以降
ファームウェアバージョン"08"以降
ファームウェアバージョン"48"以降
ファームウェアバージョン"48"以降

ファームウェアバージョン"12"以降

  本脆弱性が悪用されることによるリスクを最小限に抑えるため、三菱電機は以下に示す軽減策を講じることを推奨します。
・当該製品をインターネットに接続する場合には、ファイアウォールや仮想プライベートネットワーク(VPN)等を使用し、不正アクセ
スを防止してください。
・当該製品を LAN 内で使用し、信頼できないネットワークやホストからのアクセスをファイアウォールでブロックしてください。

■謝辞

この問題をご報告いただいた国家工業信息安全発展研究中心  張暁菲様に感謝いたします。

■お客様からのお問い合わせ先

お客様からのお問い合わせ先につきましては、製品をご購入いただいた当社の支社、代理店にご相談ください。

〈お問い合わせ｜三菱電機 FA〉
https://www.mitsubishielectric.co.jp/fa/support/purchase/index.html

■更新履歴

2021 年 12 月 16 日

RJ71C24(-R2/R4)は本脆弱性に該当しないことが判明したため、該当製品から削除しました。

2021 年 9 月 14 日

RJ71GN11-T2 の対策方法の情報を追加しました。

2021 年 5 月 18 日

R08/16/32/120PCPU および R08/16/32/120PSFCPU の対策方法の情報を追加しました。


