=== Content from infosecdb.wordpress.com_35851255_20250119_113316.html ===

[Skip to content](#content)

[InfoSecDB](https://infosecdb.wordpress.com/)

Menu and widgets

## Recent Posts

* [GilaCMS 1.11.8 – ‘/cm/delete?t=’ LFI (Local File Inclusion) and RCE](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/)
* [GilaCMS 1.11.8 – Remote Code Execution](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/)
* [GilaCMS 1.11.8 – ‘/admin/sql?query=’ SQL Injection](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-sqlquery-sql-injection/)
* [GilaCMS 1.11.8 – ‘/admin/media?path=’ Directory Traversal](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-mediapath-directory-traversal/)
## Categories

* [Uncategorized](https://infosecdb.wordpress.com/category/uncategorized/)

# GilaCMS 1.11.8 – ‘/cm/delete?t=’ LFI (Local File Inclusion) and RCE

**Product Owner:** GilaCMS

**Application Name:** GilaCMS 1.11.8

**CVE ID:** CVE-2020-5513

**Type:** Installable/Customer-Controlled Application

**Application Release Date:** 4th December,2019

**Severity:** Critical

**Authentication:** Required

**Complexity:** Easy

**Vulnerability Name:** Local File Inclusion in ‘/cm/delete?t=’

**Vulnerability Explanation:** The File Inclusion vulnerability allows an attacker to include a file, usually exploiting a “dynamic file inclusion” mechanisms implemented in the target application.

**Request:**

`POST /gilacms/cm/delete?t={INJECTION_POINT} HTTP/1.1

Host: localhost

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0

Accept: */*

Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate

Content-Type: multipart/form-data; boundary=---------------------------191691572411478

Content-Length: 258

Origin: http://localhost

Connection: close

Referer: http://localhost/gilacms/admin/content/post

Cookie: GSESSIONID=1lnubi23gip8tg9ue4gt6xtjatdgf7crevfwb8ovpl2g7dzau6; media_tab=assets; media_path=assets; asset_path=src%2Fcore%2Fassets`

**Verified In:**

Firefox 71.0 (64-bit)

Windows 10

Hosted using XAMPP v3.2.4

**Steps to Reproduce:**

1. Login to the GilaCMS application as admin.

2. Create a new post and save it (<http://localhost/gilacms/admin/content/post>)

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/1.-create-post.png?w=660&h=340)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/1-create-post/)

3. Now click on the delete icon for any of the post created and intercept the request sent to the web server using a proxy such as Burp Suite

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/2.-delete-post.png?w=660&h=241)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/2-delete-post/)

4. The request sent to web server for deleting the post:

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/3.-delete-post-burp.png?w=660&h=209)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/3-delete-post-burp/)

5. On changing the value of ‘t’ parameter to ‘../../../../../../../../WINDOWS/win.ini’ and forwarding the request, we get the contents of the win.ini file in the response.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/4.-lfi-windows_win_ini.png?w=660&h=200)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/4-lfi-windows_win_ini/)

**Video POC for LFI:**

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/1.1-lfi.gif?w=660&h=340)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/1-1-lfi/)

**Using LFI to perform Remote Code Execution:**

1. Go to <http://localhost/gilacms/admin/media> and upload an image file.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/1.-media-upload.png?w=660&h=199)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/1-media-upload/)

2. Intercept the request using a proxy and change the image content to the following PHP code.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/2.-image-upload-burp.png?w=660&h=236)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/2-image-upload-burp/)

3. The image gets uploaded successfully and the images are stored in the assets folder.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/3.-image-uploaded-successfully.png?w=660&h=187)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/3-image-uploaded-successfully/)

4. Now using the already found LFI vulnerability, change the ‘t’ parameter to the path where the image (test.jpg) we uploaded is stored.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/4.-php-code-executed.png?w=660&h=192)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/4-php-code-executed/)

5. The PHP code gets executed and ‘It works’ gets echoed and printed in the response. Now adding another parameter (‘c’) to the request, we can perform command execution

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/5.-rce.png?w=660&h=306)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/5-rce/)

**Video POC on exploiting LFI & RCE to get a reverse shell:**

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/1.2-lfi-to-rce.gif?w=660&h=340)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/1-2-lfi-to-rce/)

**Vulnerable Code:**

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/6.-source-code-deleteaction-function.png?w=660&h=184)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/6-source-code-deleteaction-function/)

**Reference:**

**Website:** <https://gilacms.com/>

**GitHub Repository:** <https://github.com/GilaCMS/gila>

**Download Version:** <https://github.com/GilaCMS/gila/releases/tag/1.11.8>

### Share this:

* [Twitter](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/?share=twitter "Click to share on Twitter")
* [Facebook](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

Posted on [January 5, 2020January 6, 2020](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/)Author [lokeshkumarv](https://infosecdb.wordpress.com/author/lokeshkumarv/)

### Leave a comment [Cancel reply](/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/#respond)

Δ

## Post navigation

[Previous Previous post: GilaCMS 1.11.8 – Remote Code Execution](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/)

[Create a free website or blog at WordPress.com.](https://wordpress.com/?ref=footer_website)

* [Comment](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/#respond)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) InfoSecDB](https://infosecdb.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Finfosecdb.wordpress.com%2F2020%2F01%2F05%2Fgilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) InfoSecDB](https://infosecdb.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Finfosecdb.wordpress.com%2F2020%2F01%2F05%2Fgilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/p71xVw-1i)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/)
  + [View post in Reader](https://wordpress.com/read/blogs/103803098/posts/80)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)



=== Content from gilacms.com_f996780a_20250119_113315.html ===

[Skip to main content](https://gilacms.com/blog#main)
☰

[![](https://gilacms.com/tmp/300/assets-umedia2f08f8630876da502d16b24ff9ab05.png)](https://gilacms.com/)

⨯

* Inicio

[Hecho con PYME One](https://pyme.one)


