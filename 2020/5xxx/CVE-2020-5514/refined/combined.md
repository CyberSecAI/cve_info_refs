=== Content from infosecdb.wordpress.com_e7a80f3a_20250119_133102.html ===

[Skip to content](#content)

[InfoSecDB](https://infosecdb.wordpress.com/)

Menu and widgets

## Recent Posts

* [GilaCMS 1.11.8 – ‘/cm/delete?t=’ LFI (Local File Inclusion) and RCE](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/)
* [GilaCMS 1.11.8 – Remote Code Execution](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/)
* [GilaCMS 1.11.8 – ‘/admin/sql?query=’ SQL Injection](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-sqlquery-sql-injection/)
* [GilaCMS 1.11.8 – ‘/admin/media?path=’ Directory Traversal](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-mediapath-directory-traversal/)
## Categories

* [Uncategorized](https://infosecdb.wordpress.com/category/uncategorized/)

# Category: Uncategorized

## [GilaCMS 1.11.8 – ‘/cm/delete?t=’ LFI (Local File Inclusion) and RCE](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/)

**Product Owner:** GilaCMS

**Application Name:** GilaCMS 1.11.8

**CVE ID:** CVE-2020-5513

**Type:** Installable/Customer-Controlled Application

**Application Release Date:** 4th December,2019

**Severity:** Critical

**Authentication:** Required

**Complexity:** Easy

**Vulnerability Name:** Local File Inclusion in ‘/cm/delete?t=’

**Vulnerability Explanation:** The File Inclusion vulnerability allows an attacker to include a file, usually exploiting a “dynamic file inclusion” mechanisms implemented in the target application.

**Request:**

`POST /gilacms/cm/delete?t={INJECTION_POINT} HTTP/1.1

Host: localhost

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0

Accept: */*

Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate

Content-Type: multipart/form-data; boundary=---------------------------191691572411478

Content-Length: 258

Origin: http://localhost

Connection: close

Referer: http://localhost/gilacms/admin/content/post

Cookie: GSESSIONID=1lnubi23gip8tg9ue4gt6xtjatdgf7crevfwb8ovpl2g7dzau6; media_tab=assets; media_path=assets; asset_path=src%2Fcore%2Fassets`

**Verified In:**

Firefox 71.0 (64-bit)

Windows 10

Hosted using XAMPP v3.2.4

**Steps to Reproduce:**

1. Login to the GilaCMS application as admin.

2. Create a new post and save it (<http://localhost/gilacms/admin/content/post>)

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/1.-create-post.png?w=660&h=340)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/1-create-post/)

3. Now click on the delete icon for any of the post created and intercept the request sent to the web server using a proxy such as Burp Suite

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/2.-delete-post.png?w=660&h=241)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/2-delete-post/)

4. The request sent to web server for deleting the post:

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/3.-delete-post-burp.png?w=660&h=209)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/3-delete-post-burp/)

5. On changing the value of ‘t’ parameter to ‘../../../../../../../../WINDOWS/win.ini’ and forwarding the request, we get the contents of the win.ini file in the response.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/4.-lfi-windows_win_ini.png?w=660&h=200)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/4-lfi-windows_win_ini/)

**Video POC for LFI:**

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/1.1-lfi.gif?w=660&h=340)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/1-1-lfi/)

**Using LFI to perform Remote Code Execution:**

1. Go to <http://localhost/gilacms/admin/media> and upload an image file.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/1.-media-upload.png?w=660&h=199)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/1-media-upload/)

2. Intercept the request using a proxy and change the image content to the following PHP code.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/2.-image-upload-burp.png?w=660&h=236)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/2-image-upload-burp/)

3. The image gets uploaded successfully and the images are stored in the assets folder.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/3.-image-uploaded-successfully.png?w=660&h=187)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/3-image-uploaded-successfully/)

4. Now using the already found LFI vulnerability, change the ‘t’ parameter to the path where the image (test.jpg) we uploaded is stored.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/4.-php-code-executed.png?w=660&h=192)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/4-php-code-executed/)

5. The PHP code gets executed and ‘It works’ gets echoed and printed in the response. Now adding another parameter (‘c’) to the request, we can perform command execution

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/5.-rce.png?w=660&h=306)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/5-rce/)

**Video POC on exploiting LFI & RCE to get a reverse shell:**

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/1.2-lfi-to-rce.gif?w=660&h=340)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/1-2-lfi-to-rce/)

**Vulnerable Code:**

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/6.-source-code-deleteaction-function.png?w=660&h=184)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/6-source-code-deleteaction-function/)

**Reference:**

**Website:** <https://gilacms.com/>

**GitHub Repository:** <https://github.com/GilaCMS/gila>

**Download Version:** <https://github.com/GilaCMS/gila/releases/tag/1.11.8>

Posted on [January 5, 2020January 6, 2020](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/)[Leave a comment on GilaCMS 1.11.8 – ‘/cm/delete?t=’ LFI (Local File Inclusion) and RCE](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/#respond)

## [GilaCMS 1.11.8 – Remote Code Execution](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/)

**Product Owner:** GilaCMS

**Application Name:** GilaCMS 1.11.8

**CVE ID:** CVE-2020-5514

**Type:** Installable/Customer-Controlled Application

**Application Release Date:** 4th December,2019

**Severity:** Critical

**Authentication:** Required

**Complexity:** Easy

**Vulnerability Name:** Remote Code Execution

**Vulnerability Explanation:** Remote Code Evaluation is a vulnerability that can be exploited if user input is injected into a File or a String and executed (evaluated) by the programming language’s parser.

**Verified In:**

Mozilla Firefox 68.2.0esr (64-bit)

Kali Linux 2019.4

Hosted using Apache/2.4.41 (Debian)

**Request:**

`GET /gilacms/lzld/thumb?src={URL_OF_PHP_FILE_TO_UPLOAD}&media_thumb=80 HTTP/1.1

Host: localhost

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate

Referer: http://localhost/gilacms/admin/content/post

Connection: close

Cookie: GSESSIONID=1pz8sgcaj9w4btmw1lrs07sjpw0tv772n9rf6jkd0wlod37sra; media_tab=assets; media_path=assets; asset_path=src%2Fcore%2Fassets

Upgrade-Insecure-Requests: 1

Cache-Control: max-age=0`

**Steps to Reproduce:**

1. Login to the GilaCMS application as admin.

2. Go to <http://localhost/gila/admin/content/post>.

3. Right Click on the thumbnail image and click ‘View Image’

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/1.-post-page.png?w=660&h=222)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/1-post-page/)

4. From the Image URL we can see that the image path given in ‘src’ parameter is displayed to us.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/2.-image-thumbnail.png?w=660&h=200)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/2-image-thumbnail/)

5. Host an image file in another machine using xampp web server (<http://192.168.1.108/poc/>)

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/3.-web-server.png?w=660&h=177)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/3-web-server/)

6. When the ‘src’ parameter is set a remote image URL, the image is displayed to us. Additionally, the same image is downloaded and stored in the /tmp/ and then moved to /tmp/media\_thumb/ folder

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/4.-remote-image-include.png?w=660&h=318)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/4-remote-image-include/)

7. Trying to access the image file directly from the web browser using the absolute path from the webroot, we can see that the image is present and gets displayed.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/4.1-image-stored-in-tmp-directory.png?w=660&h=306)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/4-1-image-stored-in-tmp-directory/)

8. Now setting the ‘src’ parameter to a remote PHP file, the PHP file is downloaded and stored in the /tmp/ but not moved to /tmp/media\_thumb/ folder.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/5.-php-file-include.png?w=660&h=317)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/5-php-file-include/)

9. Trying to access the PHP file directly from the web browser, we get a ‘Forbidden’ error. That is because of the .htaccess file present in the directory which blocks \*.php file.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/6.-htaccess-blocks-php-files.png?w=660&h=163)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/6-htaccess-blocks-php-files/)

10. In order to bypass that we can instead upload .phar or .phtml file.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/7.-phar-file-upload.png?w=660&h=164)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/7-phar-file-upload/)

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/7.1-phar-file-upload.png?w=660&h=123)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/7-1-phar-file-upload/)

11. On accessing the upload .phar file in a web browser, the PHP code gets executed

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/8.-php-code-executed.png?w=660&h=96)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/8-php-code-executed/)

12. By passing an additional ‘c’ parameter with the command to execute, we can run system commands.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/9.-rce.png?w=660&h=123)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/9-rce/)

**Note:**

The web server configuration should support other extensions such as .phar, .phtml in order for this to be exploited.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/9.-php-conf-file.png?w=660&h=177)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/9-php-conf-file/)

**Video POC:**

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/2.-rce-2.gif?w=660&h=340)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/2-rce-2/)

**Vulnerable Code:**

The user input (remote url to the php file) sent in ‘src’ parameter is stored in a variable named ‘file’ (Line No: 31) and passed to a function ‘thumb’ of class ‘view’ (Line No: 35).

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/10.1-source-code-thumbaction.png?w=660&h=527)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/10-1-source-code-thumbaction/)

The ‘src’ variable which stores the user input is passed to ‘make\_thumb’ function of class ‘image’ (Line No: 407) since the check for if the file already exists return false.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/10.2-source-code-thumb.png?w=660&h=417)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/10-2-source-code-thumb/)

The ‘src’ variable is again passed to another function ‘local\_path’ (Line No: 15).

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/10.2.1-source-code-make_thumb.png?w=660&h=491)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/10-2-1-source-code-make_thumb/)

The ‘\_src’ variable stores the destination location where the file is to be stored (Line No: 171). The output filename is generated from ‘src’ variable replacing certain characters with an ‘\_’. The built-in PHP function ‘copy’ is used to copy the contents of the remote file location stored in variable ‘src’ to the local file location stored in ‘\_src’ (Line No: 176). No validation/checks are performed on the file being saved to the tmp/ directory.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/10.3-source-code-local_path-copy.png?w=660&h=318)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/10-3-source-code-local_path-copy/)

**Reference:**

**Website:** <https://gilacms.com/>

**GitHub Repository:** <https://github.com/GilaCMS/gila>

**Download Version:** <https://github.com/GilaCMS/gila/releases/tag/1.11.8>

Posted on [January 5, 2020January 6, 2020](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/)[Leave a comment on GilaCMS 1.11.8 – Remote Code Execution](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/#respond)

## [GilaCMS 1.11.8 – ‘/admin/sql?query=’ SQL Injection](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-sqlquery-sql-injection/)

**Product Owner:** GilaCMS

**Application Name:** GilaCMS 1.11.8

**CVE ID:** CVE-2020-5515

**Type:** Installable/Customer-Controlled Application

**Application Release Date:** 4th December,2019

**Severity:** High

**Authentication:** Required

**Complexity:** Easy

**Vulnerability Name:** SQL Injection in ‘/admin/sql?query=’

**Vulnerability Explanation:** SQL injection is a web security vulnerability that allows an attacker to interfere with the queries that an application makes to its database.

**Verified In:**

Firefox 71.0 (64-bit)

Windows 10

Hosted using XAMPP v3.2.4

**Request:**

`GET /gilacms/admin/sql?query={INJECTION_POINT} HTTP/1.1

Host: localhost

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate

Connection: close

Cookie: GSESSIONID=1za7iusvgawzjs936iegtmmtwfghbbp6ectnugwb0clvc0z37u

Upgrade-Insecure-Requests: 1`

**Steps to Reproduce:**

1. Login to the GilaCMS application as admin.

2. Visit the following page: <http://localhost/gilacms/admin/sql>

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/sql-injection.png?w=660&h=337)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-sqlquery-sql-injection/sql-injection/)

3. Click on ‘Show Tables’. It takes us to <http://localhost/gilacms/admin/sql?query=SHOW%20TABLES>

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/sql-injection-1.png?w=660&h=339)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-sqlquery-sql-injection/sql-injection-1/)

4. The ‘query’ parameter is vulnerable to SQL injection (Inline Queries)

<http://localhost/gilacms/admin/sql?query=SELECT> VERSION(),USER()

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/sql-injection-2.png?w=660&h=229)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-sqlquery-sql-injection/sql-injection-2/)

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/sql-injection-4.png?w=660&h=186)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-sqlquery-sql-injection/sql-injection-4/)

<http://localhost/gilacms/admin/sql?query=SELECT> \* FROM user

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/sql-injection-3.png?w=660&h=234)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-sqlquery-sql-injection/sql-injection-3/)

**Vulnerable Code:**

The ‘query’ parameter sent in the GET request (<http://localhost/gilacms/admin/sql>) is vulnerable to SQL Injection.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/sqli-source-code.png?w=660&h=341)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-sqlquery-sql-injection/sqli-source-code/)

**Reference:**

**Website:** <https://gilacms.com/>

**GitHub Repository:** <https://github.com/GilaCMS/gila>

**Download Version:** <https://github.com/GilaCMS/gila/releases/tag/1.11.8>

Posted on [January 5, 2020January 6, 2020](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-sqlquery-sql-injection/)[Leave a comment on GilaCMS 1.11.8 – ‘/admin/sql?query=’ SQL Injection](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-sqlquery-sql-injection/#respond)

## [GilaCMS 1.11.8 – ‘/admin/media?path=’ Directory Traversal](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-mediapath-directory-traversal/)

**Product Owner:** GilaCMS

**Application Name:** GilaCMS 1.11.8

**CVE ID:** CVE-2020-5512

**Type:** Installable/Customer-Controlled Application

**Application Release Date:** 4th December,2019

**Severity:** Medium

**Authentication:** Required

**Complexity:** Easy

**Vulnerability Name:** Directory Traversal in ‘/admin/media?path=’

**Vulnerability Explanation:** Directory traversal is a web security vulnerability that allows an attacker to read arbitrary files on the server that is running an application.

**Verified In:**

Firefox 71.0 (64-bit)

Windows 10

Hosted using XAMPP v3.2.4

**Request:**

`POST /gilacms/admin/media HTTP/1.1

Host: localhost

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0

Accept: */*

Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate

Content-type: application/x-www-form-urlencoded

Content-Length: 39

Origin: http://localhost

Connection: close

Referer: http://localhost/gilacms/admin/content/post

Cookie: GSESSIONID=1atvstbcjvlrv6gsdkk4lr3392otw7x4ovt70cs1fli29xkup9; media_tab=assets; media_path=assets; asset_path=src`

g\_response=content&path={INJECTION\_POINT}

**Steps to Reproduce:**

1. Login to the GilaCMS application as admin.

2. Visit the following page: <http://localhost/gilacms/admin/content/post>

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/1.-new-post.png?w=660&h=341)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-mediapath-directory-traversal/1-new-post/)

3. Click on thumbnail option where you can upload a new image or select an image from the media gallery.

4. Click on Media Gallery option on the left side menu.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/2.-media-gallery-e1578216488323.png?w=660&h=216)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-mediapath-directory-traversal/2-media-gallery/)

5. Click on either of the folder and intercept the request that is being sent to the web server using a proxy such as Burp Suite and change the ‘path’ parameter value to ‘/../../../../../’ ( path=/../../../../../ ) and forward the request

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/4.-directory-traversal-burp.png?w=660&h=290)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-mediapath-directory-traversal/4-directory-traversal-burp/)

6. Now in the web application you can see the directories present in the root directory of the file system (C:\ drive in my case as I have hosted the application in Windows using xampp)

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/3.-directory-traversal-webapp.png?w=660&h=342)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-mediapath-directory-traversal/3-directory-traversal-webapp/)

**Vulnerable Code:**

The ‘path’ parameter sent in the POST request (<http://localhost/gilacms/admin/media>) is vulnerable to Directory traversal.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/5.-directory-traversal-source-code.png?w=660&h=325)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-mediapath-directory-traversal/5-directory-traversal-source-code/)

**Reference:**

**Website:** <https://gilacms.com/>

**GitHub Repository:** <https://github.com/GilaCMS/gila>

**Download Version:** <https://github.com/GilaCMS/gila/releases/tag/1.11.8>

Posted on [January 5, 2020January 6, 2020](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-mediapath-directory-traversal/)[Leave a comment on GilaCMS 1.11.8 – ‘/admin/media?path=’ Directory Traversal](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-mediapath-directory-traversal/#respond)

[Create a free website or blog at WordPress.com.](https://wordpress.com/?ref=footer_website)

* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) InfoSecDB](https://infosecdb.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Finfosecdb.wordpress.com%2F2020%2F01%2F05%2Fgilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) InfoSecDB](https://infosecdb.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Finfosecdb.wordpress.com%2F2020%2F01%2F05%2Fgilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce%2F&signup_flow=account)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://infosecdb.wordpress.com)
  + [View site in Reader](https://wordpress.com/read/feeds/102570375)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)


=== Content from infosecdb.wordpress.com_9df40ef1_20250119_114348.html ===

[Skip to content](#content)

[InfoSecDB](https://infosecdb.wordpress.com/)

Menu and widgets

## Recent Posts

* [GilaCMS 1.11.8 – ‘/cm/delete?t=’ LFI (Local File Inclusion) and RCE](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/)
* [GilaCMS 1.11.8 – Remote Code Execution](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/)
* [GilaCMS 1.11.8 – ‘/admin/sql?query=’ SQL Injection](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-sqlquery-sql-injection/)
* [GilaCMS 1.11.8 – ‘/admin/media?path=’ Directory Traversal](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-mediapath-directory-traversal/)
## Categories

* [Uncategorized](https://infosecdb.wordpress.com/category/uncategorized/)

# GilaCMS 1.11.8 – Remote Code Execution

**Product Owner:** GilaCMS

**Application Name:** GilaCMS 1.11.8

**CVE ID:** CVE-2020-5514

**Type:** Installable/Customer-Controlled Application

**Application Release Date:** 4th December,2019

**Severity:** Critical

**Authentication:** Required

**Complexity:** Easy

**Vulnerability Name:** Remote Code Execution

**Vulnerability Explanation:** Remote Code Evaluation is a vulnerability that can be exploited if user input is injected into a File or a String and executed (evaluated) by the programming language’s parser.

**Verified In:**

Mozilla Firefox 68.2.0esr (64-bit)

Kali Linux 2019.4

Hosted using Apache/2.4.41 (Debian)

**Request:**

`GET /gilacms/lzld/thumb?src={URL_OF_PHP_FILE_TO_UPLOAD}&media_thumb=80 HTTP/1.1

Host: localhost

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate

Referer: http://localhost/gilacms/admin/content/post

Connection: close

Cookie: GSESSIONID=1pz8sgcaj9w4btmw1lrs07sjpw0tv772n9rf6jkd0wlod37sra; media_tab=assets; media_path=assets; asset_path=src%2Fcore%2Fassets

Upgrade-Insecure-Requests: 1

Cache-Control: max-age=0`

**Steps to Reproduce:**

1. Login to the GilaCMS application as admin.

2. Go to <http://localhost/gila/admin/content/post>.

3. Right Click on the thumbnail image and click ‘View Image’

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/1.-post-page.png?w=660&h=222)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/1-post-page/)

4. From the Image URL we can see that the image path given in ‘src’ parameter is displayed to us.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/2.-image-thumbnail.png?w=660&h=200)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/2-image-thumbnail/)

5. Host an image file in another machine using xampp web server (<http://192.168.1.108/poc/>)

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/3.-web-server.png?w=660&h=177)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/3-web-server/)

6. When the ‘src’ parameter is set a remote image URL, the image is displayed to us. Additionally, the same image is downloaded and stored in the /tmp/ and then moved to /tmp/media\_thumb/ folder

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/4.-remote-image-include.png?w=660&h=318)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/4-remote-image-include/)

7. Trying to access the image file directly from the web browser using the absolute path from the webroot, we can see that the image is present and gets displayed.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/4.1-image-stored-in-tmp-directory.png?w=660&h=306)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/4-1-image-stored-in-tmp-directory/)

8. Now setting the ‘src’ parameter to a remote PHP file, the PHP file is downloaded and stored in the /tmp/ but not moved to /tmp/media\_thumb/ folder.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/5.-php-file-include.png?w=660&h=317)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/5-php-file-include/)

9. Trying to access the PHP file directly from the web browser, we get a ‘Forbidden’ error. That is because of the .htaccess file present in the directory which blocks \*.php file.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/6.-htaccess-blocks-php-files.png?w=660&h=163)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/6-htaccess-blocks-php-files/)

10. In order to bypass that we can instead upload .phar or .phtml file.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/7.-phar-file-upload.png?w=660&h=164)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/7-phar-file-upload/)

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/7.1-phar-file-upload.png?w=660&h=123)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/7-1-phar-file-upload/)

11. On accessing the upload .phar file in a web browser, the PHP code gets executed

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/8.-php-code-executed.png?w=660&h=96)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/8-php-code-executed/)

12. By passing an additional ‘c’ parameter with the command to execute, we can run system commands.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/9.-rce.png?w=660&h=123)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/9-rce/)

**Note:**

The web server configuration should support other extensions such as .phar, .phtml in order for this to be exploited.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/9.-php-conf-file.png?w=660&h=177)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/9-php-conf-file/)

**Video POC:**

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/2.-rce-2.gif?w=660&h=340)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/2-rce-2/)

**Vulnerable Code:**

The user input (remote url to the php file) sent in ‘src’ parameter is stored in a variable named ‘file’ (Line No: 31) and passed to a function ‘thumb’ of class ‘view’ (Line No: 35).

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/10.1-source-code-thumbaction.png?w=660&h=527)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/10-1-source-code-thumbaction/)

The ‘src’ variable which stores the user input is passed to ‘make\_thumb’ function of class ‘image’ (Line No: 407) since the check for if the file already exists return false.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/10.2-source-code-thumb.png?w=660&h=417)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/10-2-source-code-thumb/)

The ‘src’ variable is again passed to another function ‘local\_path’ (Line No: 15).

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/10.2.1-source-code-make_thumb.png?w=660&h=491)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/10-2-1-source-code-make_thumb/)

The ‘\_src’ variable stores the destination location where the file is to be stored (Line No: 171). The output filename is generated from ‘src’ variable replacing certain characters with an ‘\_’. The built-in PHP function ‘copy’ is used to copy the contents of the remote file location stored in variable ‘src’ to the local file location stored in ‘\_src’ (Line No: 176). No validation/checks are performed on the file being saved to the tmp/ directory.

[![](https://infosecdb.wordpress.com/wp-content/uploads/2020/01/10.3-source-code-local_path-copy.png?w=660&h=318)](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/10-3-source-code-local_path-copy/)

**Reference:**

**Website:** <https://gilacms.com/>

**GitHub Repository:** <https://github.com/GilaCMS/gila>

**Download Version:** <https://github.com/GilaCMS/gila/releases/tag/1.11.8>

### Share this:

* [Twitter](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/?share=twitter "Click to share on Twitter")
* [Facebook](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/?share=facebook "Click to share on Facebook")
Like Loading...
### *Related*

Posted on [January 5, 2020January 6, 2020](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/)Author [lokeshkumarv](https://infosecdb.wordpress.com/author/lokeshkumarv/)

### Leave a comment [Cancel reply](/2020/01/05/gilacms-1-11-8-remote-code-execution/#respond)

Δ

## Post navigation

[Previous Previous post: GilaCMS 1.11.8 – ‘/admin/sql?query=’ SQL Injection](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-admin-sqlquery-sql-injection/)[Next Next post: GilaCMS 1.11.8 – ‘/cm/delete?t=’ LFI (Local File Inclusion) and RCE](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-cm-deletet-lfi-local-file-inclusion-and-rce/)

[Blog at WordPress.com.](https://wordpress.com/?ref=footer_blog)

* [Comment](https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/#respond)
* Reblog
* Subscribe
  Subscribed

  + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) InfoSecDB](https://infosecdb.wordpress.com)

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Finfosecdb.wordpress.com%2F2020%2F01%2F05%2Fgilacms-1-11-8-remote-code-execution%2F&signup_flow=account)
* Privacy
* + [![](https://s2.wp.com/i/logo/wpcom-gray-white.png) InfoSecDB](https://infosecdb.wordpress.com)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Finfosecdb.wordpress.com%2F2020%2F01%2F05%2Fgilacms-1-11-8-remote-code-execution%2F&signup_flow=account)
  + [Copy shortlink](https://wp.me/p71xVw-P)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://infosecdb.wordpress.com/2020/01/05/gilacms-1-11-8-remote-code-execution/)
  + [View post in Reader](https://wordpress.com/read/blogs/103803098/posts/51)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

##

##

Loading Comments...

Write a Comment...

Email (Required)

Name (Required)

Website

###

%d

![](https://pixel.wp.com/b.gif?v=noscript)
Design a site like this with WordPress.com[Get started](https://wordpress.com/start/?ref=marketing_bar)


