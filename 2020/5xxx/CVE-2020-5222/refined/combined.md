=== Content from github.com_e9f75435_20250119_114831.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopencast%2Fopencast%2Fcommit%2F1a7172c95af8d542a77ae5b153e4c834dd4788a6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopencast%2Fopencast%2Fcommit%2F1a7172c95af8d542a77ae5b153e4c834dd4788a6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=opencast%2Fopencast)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[opencast](/opencast)
/
**[opencast](/opencast/opencast)**
Public

* [Notifications](/login?return_to=%2Fopencast%2Fopencast) You must be signed in to change notification settings
* [Fork
  238](/login?return_to=%2Fopencast%2Fopencast)
* [Star
   410](/login?return_to=%2Fopencast%2Fopencast)

* [Code](/opencast/opencast)
* [Issues
  229](/opencast/opencast/issues)
* [Pull requests
  67](/opencast/opencast/pulls)
* [Discussions](/opencast/opencast/discussions)
* [Actions](/opencast/opencast/actions)
* [Security](/opencast/opencast/security)
* [Insights](/opencast/opencast/pulse)

Additional navigation options

* [Code](/opencast/opencast)
* [Issues](/opencast/opencast/issues)
* [Pull requests](/opencast/opencast/pulls)
* [Discussions](/opencast/opencast/discussions)
* [Actions](/opencast/opencast/actions)
* [Security](/opencast/opencast/security)
* [Insights](/opencast/opencast/pulse)

## Commit

[Permalink](/opencast/opencast/commit/1a7172c95af8d542a77ae5b153e4c834dd4788a6)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix Remember-Me Cookie

[Browse files](/opencast/opencast/tree/1a7172c95af8d542a77ae5b153e4c834dd4788a6)
Browse the repository at this point in the history

```
The security configuration in etc/security/mh_default_org.xml enables a
remember-me cookie based on a hash created from the username, password,
and an additional system key. Opencast has hard-coded this system key in
the large XML file and never mentions to change this, basically ensuring
that all systems use the same key:

    <sec:remember-me key="opencast" user-service-ref="userDetailsService" />

This means that an attacker getting access to a remember-me token for
one server can get access to all servers which allow log-in using the
same credentials without ever needing the credentials. For example, a
remember-me token obtained from develop.opencast.org can be used on
stable.opencast.org without actually knowing the log-in credentials.

Such an attack will usually not work on different installations ‚Äì
assuming that safe, unique passwords are used ‚Äì but it is basically
guaranteed to work to get access to all machines of one cluster if a
token from one machine is compromised.

This patch now makes Opencast automatically generate a safe key based on
unique system properties, creating a safe, zero-configuration variant of
the remember-me token.

This patch additionally switches from using MD5 for the tokens to using
SHA-512 instead to also be more resilient against brute-force attacks in
case an attacker gets access to such a token.
```

* Loading branch information

[![@lkiesow](https://avatars.githubusercontent.com/u/1008395?s=40&v=4)](/lkiesow)

[lkiesow](/opencast/opencast/commits?author=lkiesow "View all commits by lkiesow")
committed
Jan 29, 2020

1 parent
[bbb473f](/opencast/opencast/commit/bbb473f34ab95497d6c432c81285efb0c739f317)

commit 1a7172c

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**146 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* etc/security

  + etc/security/mh\_default\_org.xml
    [mh\_default\_org.xml](#diff-386888ac0459d92236a4635ca5a00b9588b535e8bdfb082293aa85659cb7604a)
* modules/kernel/src/main/java/org/opencastproject/kernel/security

  + modules/kernel/src/main/java/org/opencastproject/kernel/security/SystemTokenBasedRememberMeService.java
    [SystemTokenBasedRememberMeService.java](#diff-2d509674173f92148780595f86cb484a4deaa71b3e186349d3c3692031d071e3)

## There are no files selected for viewing

11 changes: 10 additions & 1 deletion

11
[etc/security/mh\_default\_org.xml](#diff-386888ac0459d92236a4635ca5a00b9588b535e8bdfb082293aa85659cb7604a "etc/security/mh_default_org.xml")

Show comments

[View file](/opencast/opencast/blob/1a7172c95af8d542a77ae5b153e4c834dd4788a6/etc/security/mh_default_org.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -326,7 +326,7 @@ |
|  |  | --> |
|  |  |  |
|  |  | <!-- Enables "remember me" functionality --> |
|  |  | <sec:remember-me key="opencast" user-service-ref="userDetailsService" /> |
|  |  | <sec:remember-me services-ref="rememberMeServices" /> |
|  |  |  |
|  |  | <!-- Set the request cache --> |
|  |  | <sec:request-cache ref="requestCache" /> |
| Expand All | | @@ -344,6 +344,15 @@ |
|  |  |  |
|  |  | </sec:http> |
|  |  |  |
|  |  | <bean id="rememberMeServices" class="org.opencastproject.kernel.security.SystemTokenBasedRememberMeService"> |
|  |  | <property name="userDetailsService" ref="userDetailsService"/> |
|  |  | <!-- All following settings are optional --> |
|  |  | <property name="tokenValiditySeconds" value="1209600"/> |
|  |  | <property name="cookieName" value="oc-remember-me"/> |
|  |  | <!-- The following key will be augmented by system properties. Thus, leaving this untouched is okay --> |
|  |  | <property name="key" value="opencast"/> |
|  |  | </bean> |
|  |  |  |
|  |  | <!-- ############################# --> |
|  |  | <!-- # Authentication Filters # --> |
|  |  | <!-- ############################# --> |
| Expand Down | |  |

136 changes: 136 additions & 0 deletions

136
[.../src/main/java/org/opencastproject/kernel/security/SystemTokenBasedRememberMeService.java](#diff-2d509674173f92148780595f86cb484a4deaa71b3e186349d3c3692031d071e3 "modules/kernel/src/main/java/org/opencastproject/kernel/security/SystemTokenBasedRememberMeService.java")

Show comments

[View file](/opencast/opencast/blob/1a7172c95af8d542a77ae5b153e4c834dd4788a6/modules/kernel/src/main/java/org/opencastproject/kernel/security/SystemTokenBasedRememberMeService.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,136 @@ |
|  |  | /\*\* |
|  |  | \* Licensed to The Apereo Foundation under one or more contributor license |
|  |  | \* agreements. See the NOTICE file distributed with this work for additional |
|  |  | \* information regarding copyright ownership. |
|  |  | \* |
|  |  | \* |
|  |  | \* The Apereo Foundation licenses this file to you under the Educational |
|  |  | \* Community License, Version 2.0 (the "License"); you may not use this file |
|  |  | \* except in compliance with the License. You may obtain a copy of the License |
|  |  | \* at: |
|  |  | \* |
|  |  | \* http://opensource.org/licenses/ecl2.txt |
|  |  | \* |
|  |  | \* Unless required by applicable law or agreed to in writing, software |
|  |  | \* distributed under the License is distributed on an "AS IS" BASIS, WITHOUT |
|  |  | \* WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the |
|  |  | \* License for the specific language governing permissions and limitations under |
|  |  | \* the License. |
|  |  | \* |
|  |  | \*/ |
|  |  |  |
|  |  | package org.opencastproject.kernel.security; |
|  |  |  |
|  |  | import org.apache.commons.io.IOUtils; |
|  |  | import org.slf4j.Logger; |
|  |  | import org.slf4j.LoggerFactory; |
|  |  | import org.springframework.security.core.userdetails.UserDetailsService; |
|  |  | import org.springframework.security.crypto.codec.Hex; |
|  |  | import org.springframework.security.web.authentication.rememberme.TokenBasedRememberMeServices; |
|  |  |  |
|  |  | import java.io.File; |
|  |  | import java.io.FileInputStream; |
|  |  | import java.io.IOException; |
|  |  | import java.net.InetAddress; |
|  |  | import java.net.UnknownHostException; |
|  |  | import java.nio.charset.StandardCharsets; |
|  |  | import java.security.MessageDigest; |
|  |  | import java.security.NoSuchAlgorithmException; |
|  |  | import java.util.Arrays; |
|  |  | import java.util.Objects; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* This implements a zero-configuration version Spring Security's token based remember-me service. While the key can |
|  |  | \* still be augmented by configuration, it is generally generated based on seldom changing but unique system |
|  |  | \* properties like hostname, IP address, file system information and Linux kernel. |
|  |  | \*/ |
|  |  | public class SystemTokenBasedRememberMeService extends TokenBasedRememberMeServices { |
|  |  | private Logger logger = LoggerFactory.getLogger(SystemTokenBasedRememberMeService.class); |
|  |  | private String key; |
|  |  |  |
|  |  | @Deprecated |
|  |  | public SystemTokenBasedRememberMeService() { |
|  |  | super(); |
|  |  | setKey(null); |
|  |  | } |
|  |  |  |
|  |  | public SystemTokenBasedRememberMeService(String key, UserDetailsService userDetailsService) { |
|  |  | super(key, userDetailsService); |
|  |  | setKey(key); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Set a new key to be used when generating remember-me tokens. |
|  |  | \* |
|  |  | \* Note that the key passed to this method will be augmented by seldom changing but generally unique system |
|  |  | \* properties like hostname, IP address, file system information and Linux kernel. Hence, even setting no custom |
|  |  | \* key should be save. |
|  |  | \*/ |
|  |  | @Override |
|  |  | public void setKey(String key) { |
|  |  | // Start with a user key if provided |
|  |  | StringBuilder keyBuilder = new StringBuilder(Objects.toString(key, "")); |
|  |  |  |
|  |  | // This will give us the hostname and IP address as something which should be unique per system. |
|  |  | // For example: lk.elan-ev.de/10.10.10.31 |
|  |  | try { |
|  |  | keyBuilder.append(InetAddress.getLocalHost()); |
|  |  | } catch (UnknownHostException e) { |
|  |  | // silently ignore this |
|  |  | } |
|  |  |  |
|  |  | // Gather additional system properties as key |
|  |  | // This requires a proc-fs which should generally be available under Linux. |
|  |  | // But even without, we have fallbacks above and below. |
|  |  | for (String procFile: Arrays.asList("/proc/version", "/proc/partitions")) { |
|  |  | try (FileInputStream fileInputStream = new FileInputStream(new File(procFile))) { |
|  |  | keyBuilder.append(IOUtils.toString(fileInputStream, StandardCharsets.UTF\_8)); |
|  |  | } catch (IOException e) { |
|  |  | // ignore this |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // If we still have no proper key, just generate a random one. |
|  |  | // This will work just fine with the single drawback that restarting Opencast invalidates all remember-me tokens. |
|  |  | // But it should be a sufficiently good fallback. |
|  |  | key = keyBuilder.toString(); |
|  |  | if (key.isEmpty()) { |
|  |  | logger.warn("Could not generate semi-persistent remember-me key. Will generate a non-persistent random one."); |
|  |  | key = Double.toString(Math.random()); |
|  |  | } |
|  |  | logger.debug("Remember me key before hashing: {}", key); |
|  |  |  |
|  |  | // Use a SHA-512 hash as key to have a more sane key. |
|  |  | try { |
|  |  | MessageDigest digest = MessageDigest.getInstance("SHA-512"); |
|  |  | key = new String(Hex.encode(digest.digest(key.getBytes()))); |
|  |  | } catch (NoSuchAlgorithmException e) { |
|  |  | logger.warn("No SHA-512 algorithm available!"); |
|  |  | } |
|  |  | logger.debug("Calculated remember me key: {}", key); |
|  |  | this.key = key; |
|  |  | super.setKey(key); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public String getKey() { |
|  |  | return this.key; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Calculates the digital signature to be put in the cookie. Default value is |
|  |  | \* SHA-512 ("username:tokenExpiryTime:password:key") |
|  |  | \*/ |
|  |  | @Override |
|  |  | protected String makeTokenSignature(long tokenExpiryTime, String username, String password) { |
|  |  | String data = username + ":" + tokenExpiryTime + ":" + password + ":" + getKey(); |
|  |  | MessageDigest digest; |
|  |  | try { |
|  |  | digest = MessageDigest.getInstance("SHA-512"); |
|  |  | } catch (NoSuchAlgorithmException e) { |
|  |  | throw new IllegalStateException("No SHA-512 algorithm available!"); |
|  |  | } |
|  |  |  |
|  |  | return new String(Hex.encode(digest.digest(data.getBytes()))); |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1a7172c`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopencast%2Fopencast%2Fcommit%2F1a7172c95af8d542a77ae5b153e4c834dd4788a6) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_15b91dfe_20250119_133531.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLukasKalbertodt)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLukasKalbertodt)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@LukasKalbertodt](https://avatars.githubusercontent.com/u/7419664?s=64&v=4)

**LukasKalbertodt**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2FLukasKalbertodt)

[Overview](/LukasKalbertodt)
[Repositories
87](/LukasKalbertodt?tab=repositories)
[Projects
0](/LukasKalbertodt?tab=projects)
[Packages
0](/LukasKalbertodt?tab=packages)
[Stars
175](/LukasKalbertodt?tab=stars)
[Sponsoring
2](/LukasKalbertodt?tab=sponsoring)

More

* [Overview](/LukasKalbertodt)
* [Repositories](/LukasKalbertodt?tab=repositories)
* [Projects](/LukasKalbertodt?tab=projects)
* [Packages](/LukasKalbertodt?tab=packages)
* [Stars](/LukasKalbertodt?tab=stars)
* [Sponsoring](/LukasKalbertodt?tab=sponsoring)

![@LukasKalbertodt](https://avatars.githubusercontent.com/u/7419664?s=64&v=4)

**LukasKalbertodt**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2FLukasKalbertodt)

[![View LukasKalbertodt's full-sized avatar](https://avatars.githubusercontent.com/u/7419664?v=4)](https://avatars.githubusercontent.com/u/7419664?v=4)
ü¶ä

# Lukas Kalbertodt LukasKalbertodt

ü¶ä

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2FLukasKalbertodt)

 [Sponsor](/sponsors/LukasKalbertodt)

I like teaching and coding.
[338
followers](https://github.com/LukasKalbertodt?tab=followers) ¬∑ [40
following](https://github.com/LukasKalbertodt?tab=following)

* [@elan-ev](https://github.com/elan-ev)
* Heidelberg, Germany
* 14:35
  (UTC +01:00)
* <http://lukaskalbertodt.github.io/>
* Mastodon

  [@LukasKalbertodt@mastodon.world](https://mastodon.world/%40LukasKalbertodt)

## Sponsoring

[![@cwfitzgerald](https://avatars.githubusercontent.com/u/7861353?s=70&v=4)](/cwfitzgerald)

[![@GraphiteEditor](https://avatars.githubusercontent.com/u/68179154?s=70&v=4)](/GraphiteEditor)

## [Achievements](/LukasKalbertodt?tab=achievements)

[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x4](/LukasKalbertodt?achievement=pull-shark&tab=achievements)[![Achievement: Pair Extraordinaire](https://github.githubassets.com/assets/pair-extraordinaire-default-579438a20e01.png)x2](/LukasKalbertodt?achievement=pair-extraordinaire&tab=achievements)[![Achievement: Public Sponsor](https://github.githubassets.com/assets/public-sponsor-default-9fa68986b057.png)](/LukasKalbertodt?achievement=public-sponsor&tab=achievements)[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/LukasKalbertodt?achievement=quickdraw&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/LukasKalbertodt?achievement=yolo&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)x3](/LukasKalbertodt?achievement=starstruck&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/LukasKalbertodt?achievement=arctic-code-vault-contributor&tab=achievements)
## [Achievements](/LukasKalbertodt?tab=achievements)

[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x4](/LukasKalbertodt?achievement=pull-shark&tab=achievements)[![Achievement: Pair Extraordinaire](https://github.githubassets.com/assets/pair-extraordinaire-default-579438a20e01.png)x2](/LukasKalbertodt?achievement=pair-extraordinaire&tab=achievements)[![Achievement: Public Sponsor](https://github.githubassets.com/assets/public-sponsor-default-9fa68986b057.png)](/LukasKalbertodt?achievement=public-sponsor&tab=achievements)[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/LukasKalbertodt?achievement=quickdraw&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/LukasKalbertodt?achievement=yolo&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)x3](/LukasKalbertodt?achievement=starstruck&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/LukasKalbertodt?achievement=arctic-code-vault-contributor&tab=achievements)
## Highlights

* [1

  security advisory credit](/advisories?query=credit%3ALukasKalbertodt)

## Organizations

[![@virtUOS](https://avatars.githubusercontent.com/u/37844?s=64&v=4)](/virtUOS) [![@elan-ev](https://avatars.githubusercontent.com/u/1064602?s=64&v=4)](/elan-ev) [![@rust-lang](https://avatars.githubusercontent.com/u/5430905?s=64&v=4)](/rust-lang) [![@opencast](https://avatars.githubusercontent.com/u/5639632?s=64&v=4)](/opencast) [![@OsnaCS](https://avatars.githubusercontent.com/u/8659522?s=64&v=4)](/OsnaCS) [![@rust-lang-nursery](https://avatars.githubusercontent.com/u/14631425?s=64&v=4)](/rust-lang-nursery) [![@auto-impl-rs](https://avatars.githubusercontent.com/u/42949497?s=64&v=4)](/auto-impl-rs)

Block or Report

# Block or report LukasKalbertodt

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user‚Äôs behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=LukasKalbertodt+%28user%29)

[Overview](/LukasKalbertodt)
[Repositories
87](/LukasKalbertodt?tab=repositories)
[Projects
0](/LukasKalbertodt?tab=projects)
[Packages
0](/LukasKalbertodt?tab=packages)
[Stars
175](/LukasKalbertodt?tab=stars)
[Sponsoring
2](/LukasKalbertodt?tab=sponsoring)

More

* [Overview](/LukasKalbertodt)
* [Repositories](/LukasKalbertodt?tab=repositories)
* [Projects](/LukasKalbertodt?tab=projects)
* [Packages](/LukasKalbertodt?tab=packages)
* [Stars](/LukasKalbertodt?tab=stars)
* [Sponsoring](/LukasKalbertodt?tab=sponsoring)

## Pinned Loading

1. [bunt](/LukasKalbertodt/bunt) bunt Public

   Simple macros to write colored and formatted text to a terminal. Based on `termcolor`, thus also cross-platform.

   Rust

   [225](/LukasKalbertodt/bunt/stargazers)
   [7](/LukasKalbertodt/bunt/forks)
2. [penguin](/LukasKalbertodt/penguin) penguin Public

   Dev server with live-reloading, a file server, proxy support, and more. Language and framework agnostic. üêß

   Rust

   [40](/LukasKalbertodt/penguin/stargazers)
   [4](/LukasKalbertodt/penguin/forks)
3. [confique](/LukasKalbertodt/confique) confique Public

   Type-safe, layered, light-weight, `serde`-based configuration library

   Rust

   [178](/LukasKalbertodt/confique/stargazers)
   [11](/LukasKalbertodt/confique/forks)
4. [litrs](/LukasKalbertodt/litrs) litrs Public

   Parsing and inspecting Rust literals (particularly useful for proc macros)

   Rust

   [42](/LukasKalbertodt/litrs/stargazers)
   [5](/LukasKalbertodt/litrs/forks)
5. [mahboi](/LukasKalbertodt/mahboi) mahboi Public

   Yet another Game Boy emulator

   Rust

   [22](/LukasKalbertodt/mahboi/stargazers)
   [2](/LukasKalbertodt/mahboi/forks)
6. [programmieren-in-rust](/LukasKalbertodt/programmieren-in-rust) programmieren-in-rust Public archive

   Course page ‚ÄûProgrammieren in Rust‚Äú, University Osnabr√ºck (German!)

   Rust

   [270](/LukasKalbertodt/programmieren-in-rust/stargazers)
   [49](/LukasKalbertodt/programmieren-in-rust/forks)

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from avatars.githubusercontent.com_5e76da42_20250119_133531.html ===
ÔøΩÔøΩÔøΩÔøΩ ÔøΩ  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222ÔøΩÔøΩ  ( (" ÔøΩÔøΩÔøΩ          
   } !1AQa"q2ÔøΩÔøΩÔøΩ#BÔøΩÔøΩRÔøΩÔøΩ$3brÔøΩ
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ       
  w !1AQaq"2ÔøΩBÔøΩÔøΩÔøΩÔøΩ #3RÔøΩbrÔøΩ
$4ÔøΩ%ÔøΩ&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ   ? ¬ûÔøΩkx ÔøΩF|\*ÔøΩEÔøΩÔøΩÔøΩNÔøΩKÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩFÔøΩ?\*ÔøΩÔøΩÔøΩÔøΩBÔøΩÔøΩÔøΩGÔøΩÔøΩÔøΩÔøΩÔøΩDNG88ÔøΩWCÔøΩÔøΩ6ÔøΩQÔøΩÔøΩÔøΩvbÔøΩÔøΩ ÔøΩÔøΩÔøΩ9ÔøΩ?JÔøΩ`ÔøΩÔøΩ=:ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩr\K(PÔøΩÔøΩ\* 1ÔøΩSÔøΩ}B-ÔøΩÔøΩ6ÔøΩÔøΩÔøΩÔøΩjÔøΩÔøΩÔøΩqjHa^7ÔøΩ?ÔøΩqwÔøΩuÔøΩÔøΩyk4ÔøΩÔøΩNÔøΩrÔøΩ=ÔøΩW\_ÔøΩ’¨q‘ÑÔøΩÔøΩÔøΩIyÔøΩÔøΩ#ÔøΩÔøΩhÿû÷†ÔøΩ6ÔøΩÔøΩ ?ÔøΩÔøΩFÔøΩukÔøΩ0ÔøΩÔøΩ$LÔøΩÔøΩbÔøΩx5ÔøΩÔøΩÔøΩÔøΩ ÔøΩ|ÔøΩÔøΩ(ÔøΩdÔøΩÔøΩÔøΩÔøΩVKbÔøΩ1ÔøΩÔøΩ0ÔøΩÔøΩLW\_ÔøΩ√§^ÔøΩÔøΩÔøΩ&ySÔøΩÔøΩÔøΩÔøΩpHÔøΩÔøΩW2ÔøΩ}ÔøΩÔøΩyhUÔøΩ`\*0ÔøΩiÔøΩ]ÔøΩ^$ÔøΩ2\ÔøΩÔøΩÔøΩ~ÔøΩ7ÔøΩÔøΩÔøΩAÔøΩÔøΩ+œ£%Õ¢=zÔøΩÔøΩ÷¶ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩiÔøΩEk\*E$ÔøΩlÔøΩg5ÔøΩÔøΩÔøΩÔøΩDv ÔøΩQ;ÔøΩcÔøΩÔøΩÔøΩÔøΩ]/ÔøΩÔøΩÔøΩ`ÔøΩG7ÔøΩÔøΩÔøΩÔøΩ UÔøΩÔøΩ~ÔøΩÔøΩÔøΩœ•ÔøΩÔøΩÔøΩWgFœîÔøΩÔøΩÔøΩjÔøΩMÔøΩCÔøΩÔøΩRKÔøΩ+ÔøΩÔøΩjÔøΩ<ÔøΩ'ÔøΩpÔøΩÔøΩ ;ÔøΩKÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÔøΩÔøΩÔøΩÔøΩÔøΩ<ÔøΩ€•¬õfÔøΩNÔøΩhÔøΩD^ÔøΩ ≤\ÔøΩLÔøΩJvÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩVÔøΩB[;ÔøΩvsÔøΩaÔøΩTÔøΩ›¥2ÔøΩQ‘≠ÔøΩÔøΩQÔøΩÔøΩÔøΩgÔøΩ@ÈëëÔøΩÔøΩSÔøΩÔøΩ ÔøΩÔøΩOÔøΩÔøΩ ZÔøΩNÔøΩ ÔøΩÔøΩ\_C]ÔøΩÔøΩÔøΩÔøΩG=ZÔøΩÔøΩﬂ©ÔøΩ(ÔøΩÔøΩÔøΩbÔøΩK{ÔøΩÔøΩÔøΩÔøΩ@\*?EpÔøΩÔøΩÔøΩWOdÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩrÔøΩ÷¥'ÔøΩ'“∞WÔøΩIÔøΩ5tÈ®≤\*UrV0,u ÔøΩ7CG,g 8ÔøΩUÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ?ÔøΩYÔøΩÔøΩÔøΩÔøΩ\_÷µ)IE=ÔøΩÔøΩÔøΩ%kÔøΩÔøΩÔøΩ

=== Content from github.com_3c7dc309_20250119_114832.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopencast%2Fopencast%2Fsecurity%2Fadvisories%2FGHSA-mh8g-hprg-8363)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopencast%2Fopencast%2Fsecurity%2Fadvisories%2FGHSA-mh8g-hprg-8363)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=opencast%2Fopencast)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[opencast](/opencast)
/
**[opencast](/opencast/opencast)**
Public

* [Notifications](/login?return_to=%2Fopencast%2Fopencast) You must be signed in to change notification settings
* [Fork
  238](/login?return_to=%2Fopencast%2Fopencast)
* [Star
   410](/login?return_to=%2Fopencast%2Fopencast)

* [Code](/opencast/opencast)
* [Issues
  229](/opencast/opencast/issues)
* [Pull requests
  67](/opencast/opencast/pulls)
* [Discussions](/opencast/opencast/discussions)
* [Actions](/opencast/opencast/actions)
* [Security](/opencast/opencast/security)
* [Insights](/opencast/opencast/pulse)

Additional navigation options

* [Code](/opencast/opencast)
* [Issues](/opencast/opencast/issues)
* [Pull requests](/opencast/opencast/pulls)
* [Discussions](/opencast/opencast/discussions)
* [Actions](/opencast/opencast/actions)
* [Security](/opencast/opencast/security)
* [Insights](/opencast/opencast/pulse)

# Hard-Coded Key Used For Remember-me Token

Moderate

[lkiesow](/lkiesow)
published
GHSA-mh8g-hprg-8363
Jan 29, 2020

## Package

maven

opencast-kernel
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

< 7.6, 8.0

## Patched versions

7.6, 8.1

## Description

### Impact

The security configuration in `etc/security/mh_default_org.xml` enables a remember-me cookie based on a hash created from the [username, password, and an additional system key](https://docs.spring.io/spring-security/site/docs/3.0.x/reference/remember-me.html). Opencast has hard-coded this system key in the large XML file and never mentions to change this, basically ensuring that all systems use the same key:

```
<sec:remember-me key="opencast" user-service-ref="userDetailsService" />
```

This means that an attacker getting access to a remember-me token for one server can get access to all servers which allow log-in using the same credentials without ever needing the credentials. For example, a remember-me token obtained from develop.opencast.org can be used on stable.opencast.org without actually knowing the log-in credentials.

Such an attack will usually not work on different installations ‚Äì assuming that safe, unique passwords are used ‚Äì but it is basically guaranteed to work to get access to all machines of one cluster if a token from one machine is compromised.

### Patches

This problem is fixed in Opencast 7.6 and Opencast 8.1

### Workarounds

We strongly recommend updating to the patched version. Still, as a workaround for older versions, in `etc/security/mh_default_org.xml`, set a custom key for each server:

```
<sec:remember-me key="CUSTOM_RANDOM_KEY" user-service-ref="userDetailsService" />
```
### References

* [Relevant lines in the security configuration](https://github.com/opencast/opencast/blob/161ee619382f144dc35eea211fc6b556025b98e1/etc/security/mh_default_org.xml#L335-L336)
* [Spring Security Remember-Me Authentication Documentation](https://docs.spring.io/spring-security/site/docs/3.0.x/reference/remember-me.html#remember-me-hash-token)

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [opencast/opencast](https://github.com/opencast/opencast/issues)
* For security-relevant information, email us at security@opencast.org

### Thanks

Thanks to [@LukasKalbertodt](https://github.com/LukasKalbertodt) for reporting the issue.

### Severity

Moderate

### CVE ID

CVE-2020-5222

### Weaknesses

No CWEs

### Credits

* [![@LukasKalbertodt](https://avatars.githubusercontent.com/u/7419664?s=40&v=4)](/LukasKalbertodt)
  [LukasKalbertodt](/LukasKalbertodt)
  Analyst

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


