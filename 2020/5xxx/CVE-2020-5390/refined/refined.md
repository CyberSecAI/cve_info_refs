Based on the provided documents, here's a breakdown of the vulnerability associated with CVE-2020-5390:

**1. Root Cause of Vulnerability:**

*   The root cause is the improper handling of XML signatures in the `pysaml2` library. Specifically, it fails to enforce the SAML specification's constraint that signatures must be enveloped.
*   `pysaml2` does not verify that the signature's reference URI points to the signed element within the same document. It only validates the signature, trusting the URI resolution done by the underlying library (`xmlsec1`), which can be tricked by an attacker.

**2. Weaknesses/Vulnerabilities Present:**

*   **XML Signature Wrapping (XSW):** The primary vulnerability is an XML Signature Wrapping (XSW) attack. This occurs when the signature refers to a different part of the XML document than the one that is intended to be signed.
*   **Lack of Enforced Constraints:** The library doesn't enforce the SAML specification's requirements regarding enveloped signatures. It fails to verify that the signature reference targets the ID of the element in which the signature is included.
*   **Trust in Underlying Library's URI Resolution:** It relies on `xmlsec1` to resolve the URI and does not validate the result, allowing an attacker to substitute the signed data.

**3. Impact of Exploitation:**

*   **Bypassed Signature Verification:** An attacker can bypass the signature verification process, allowing them to modify SAML assertions without detection.
*   **Arbitrary Data Injection:** The attacker can inject arbitrary data into the SAML assertion, potentially leading to privilege escalation or other unauthorized access.
*   **Loss of Integrity:** The integrity of the SAML data is compromised, as it can be tampered with.

**4. Attack Vectors:**

*   The vulnerability can be exploited by crafting a malicious SAML response where the signature refers to a different element than what is intended to be signed. This malformed response could be sent to a service provider which uses `pysaml2`.

**5. Required Attacker Capabilities/Position:**

*   The attacker needs to be able to manipulate or craft SAML messages before they are processed by `pysaml2`.
*   The attacker could be positioned as a malicious Identity Provider (IdP) or an attacker-in-the-middle between a legitimate IdP and a service provider.

**Technical Details and Descriptions:**

*   **SAML Core Constraints:** The SAML core specification requires that signatures be enveloped. The signed content and the signature must be within the same XML element.
*   **Reference Element URI:** The `Reference` element within an XML Signature has a `URI` attribute. This URI should point to the signed element.
*   **XML Signature Wrapping:** By changing the URI attribute, the signature can be made to apply to the wrong element. The signature verification will still pass, because `xmlsec1` will check that the signature is valid for whatever data it is pointed to. However, it may not be the data that the application thinks is signed.
*   **Fix**: The fix involves checking the URI attribute to ensure it references the same XML element that contains the signature. This prevents the wrapping attack.

**Additional Notes:**

*   The fix involved adding a check in `src/saml2/sigver.py` to validate the `Reference` element's `URI`.
*   A test case (`tests/test_xsw.py`) and a sample XML response (`tests/saml2_response_xsw.xml`) were added to verify the fix.
*   The vulnerability was fixed in `pysaml2` version 5.0.0.
*   Ubuntu Security Notice (USN-4245-1) was issued to address the vulnerability.
*   Debian also issued a security advisory (DSA-4630-1) and a fix for their LTS version (DLA 2119-1).
*   The vulnerability is also tracked as GHSA-qf7v-8hj3-4xw7.

This vulnerability allows an attacker to potentially bypass signature verification and inject arbitrary data, leading to a complete loss of integrity in the system.