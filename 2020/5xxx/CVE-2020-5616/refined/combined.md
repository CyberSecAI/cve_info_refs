=== Content from www.php-factory.net_e97487ba_20250119_115048.html ===


![PHP工房](../common/img/header.png)

[![このエントリーをはてなブックマークに追加](//b.st-hatena.com/images/entry-button/button-only@2x.png)](http://b.hatena.ne.jp/entry/http%3A//www.php-factory.net/ "このエントリーをはてなブックマークに追加")
[Tweet](https://twitter.com/share)

[HOME](../) > 【Link01】PHPリンクページCMS フリー（無料）版

## 【Link01】PHPリンク集ページCMS フリー（無料）版

![リンク集ページCMS　管理画面サンプル](../common/img/sub/link01.png)

サイト内のリンク集ページをWeb上でブログ感覚で更新、管理できるCMSプログラムです。

ブラウザ上ですべて完結しますので更新効率アップが期待できます。

また直感的で簡単な操作なのでクライアント自身での更新も可能です。

詳細は以下サンプルデモにてご確認下さい。

### 主な機能と特徴

1. フリー（無料）プログラムです。もちろん商用サイトでもどんなサイトでも設置可能です。
2. 管理画面から登録、編集できるのでCMSとして運用可能です。
3. ページング機能も付いていますので、リンク先が増えてもすべて自動でページング（ページ送り）が生成されます。あなたは設定ファイルにて1ページあたりの表示数を指定するだけです。
4. 設置が容易。任意のページに直接コピペで埋め込むことが可能です。コピペ箇所はコメントにて指示がありますのでご参考下さい。もちろんファイルに直接リンクしてもOKです。
5. Javascriptは使用していませんので、ブラウザ間の問題も基本的にはありません。
6. 万が一のデータファイルの上書きに備えて自動バックアップオプションがあります。
7. パーミッションの自己診断も行います。データ保存ファイルのパーミッションの値が正常でない場合には管理画面で警告文が出ます。
8. その他設定ファイルにて詳細設定が可能です。ファイル内のコメントを参考に設定下さい。

### サンプルデモ

[管理画面サンプルデモ](../demo/link/link01/link_cms/admin/)

ユーザ名：admin

パスワード：13971397

※自由に登録、編集してみて下さい。

[表示サンプルデモ　デフォルト](../demo/link/link01/link.php)

任意のページに埋め込むことを想定しております。コピペ箇所はファイル内にコメントにて指示があります。
こういった運用を想定しておりますので出来る限りこの設置法をオススメします。もちろんこのページに直接リンクしてもOKです。

iframeタグ（インラインフレーム）での表示も可能です。ただ、高さが内容に応じて変わるため、スクロールバーが出る可能性があります。（スクロールバーを非表示にもできますが、その場合内容の一部が切れてしまう可能性があります）

携帯、スマホページにももちろん設置可能です。必要に応じてタグ、CSS等を変更下さい。

### ダウンロード

事前に[ご利用規約](#ruleArea)をご確認下さい。

クリックで自分のPCに保存して下さい。または右クリック⇒「対象をファイルに保存」

[【Link01】ダウンロード](../download_count/download.php?download=17)

### 設置方法

ファイルの文字コードはUTF-8です。必ず対応したエディタで開いてください。

メモ帳（UTF-8非対応）は使用禁止です。ファイルが壊れます。エディタソフトは特になんでもかまいませんが、[TeraPad（無料）](http://www5f.biglobe.ne.jp/~t-susumu/library/tpad.html)やDreamWeaver等で開いてください。必ずUTF-8のBOM無し（UTF-8N）で保存して下さい（いずれもデフォルトではBOM無しで保存されます）。

[BOMについて詳しく知りたい方はこちら](../trivia/03.php)

※PHPではスラッシュ2回「//」の後からその行の末尾までがコメント扱いとなります。「#」、「/\*\*/」もです。

#### 1.ファイル構成を確認し、表示側の設定を行う

ダウンロードしたzipファイルを解凍するとlink01フォルダがあります。

赤字のファイルが触るファイルです。その他は基本的には触らずOKです。

青字はパーミッション変更が必要になるものです。（サーバによっては不要な場合もあります）

| link.php | リンク集ページです。実際には任意のページの任意の箇所にコピペで埋め込むことになると思います。ただし、埋め込み先のページは拡張子が.phpでかつ文字コードがUTF-8である必要があります。見た目等はCSSで自由に調整して下さい。コピペ箇所はコメントにて指示があります。 もちろんこのファイルに直接リンクする形、またはiframeで運用してもOKです。 |
| --- | --- |
| link\_cms/ | アップの際にはこのフォルダごとアップください。 |
| ┗ admin/ |  |
| ┗ index.php | 管理画面です。登録や変更を行います。クライアントにはこのURLだけを教えることになるかと思います。 |
| ┗ inc/config.php | 設定ファイル。管理画面ログイン情報の設定やその他設定。 エディタで開きコメントを参考に設定下さい。 |
| ┗ その他ファイル | すべて必要なファイルになりますが意識する機会はないと思います。特に触らずそのままアップ下さい。特に「copy.inc」は触らないで下さい。システム不具合が発生する可能性があります。 |
| ┗ data/ | データ保存用ディレクトリ（パーミッションを777等書き込み可能なものに） |
| ┗ data.dat | データを保存するファイル（パーミッション666等書き込み可能なものに） |
| ┗ backup/ | バックアップデータを保存するディレクトリ バックアップはオプションです。デフォルトはOFF。 （パーミッションを777等書き込み可能なものに） バックアップをONにすると新規投稿時にだけbackupディレクトリ内に「Backup\_年月日時分秒\_○○.dat」のファイル名で保存されます。古いものは自動で削除されます。保存期間は指定可能です。このあたりは設定ファイル内にも詳しく記述しています。 |
| ┗css/ | 管理画面用のCSSです。 |
| ┗ js/ | 管理画面用のJavascriptファイルです。 |
| ┗ tmp/ | アップ画像の確認画面用の一時保存用ディレクトリです。 （パーミッションを777等書き込み可能なものに） |
| ┗ upload/ | アップ画像の保存先ディレクトリです。 （パーミッションを777等書き込み可能なものに） |

##### ページに反映する

link.phpをエディタで開き、コメントを参考に既存ページにコピペして下さい。

既存のページの拡張子が.htmlの場合には、.phpに変更して下さい。（拡張子が変わっても特に影響しません）

1サイト内で.html、.phpが混在していても問題ありません。必要に応じて他ページのリンク先変更など行って下さい。

また既存ページの文字コードがUTF-8以外の場合にはUTF-8として保存して下さい。

#### **2. 必須設定、オプション設定を設定する**

link\_cms/admin/inc/config.phpをエディタソフトで開き、「必須設定」の箇所を設定してください。

※メモ帳は使用禁止です。ファイルが壊れます。

特にログインID、パスワードの初期値は

ID：admin

パスワード：13971397

になっています。**必ず変更してください。**

その他必要に応じてコメントを参考に設定してください。

#### **3. FTPでアップ**

link01フォルダの中の「link\_cms」フォルダごとサーバーにアップし、**上記でパーミッション変更が必要なファイル、ディレクトリのパーミッションを変更下さい。**

また「link\_cms」と同じ階層にリンクページもアップして下さい。

これで設置は完了です。

各パーミッションの適切な値はサーバーのマニュアル等を参考に変更下さい。

サーバーによっては値が違う、または変更の必要自体無いこともあります。

もしパーミッションの設定が間違っていた場合ですが、管理画面にてその旨警告が表示されるよう設定しています。逆にそのようなことがない場合は適切なパーミッションになっていると考えてOKです。

ちなみにエックスサーバーの場合、今のところパーミッション変更は不要です。

#### **4.登録テストとブラウザで結果確認**

**ブラウザで「あなたのサイトのURL」/link\_cms/admin/** を表示し、管理画面にログインし、登録を行ってみてください。正常に登録、編集できればOKです。

埋め込んだページもブラウザで確認してみて下さい。

登録データが反映されていればOKです。

#### **5. ページの調整**

設置するページやその他必要に応じてスタイルシート、HTML等で見た目の調整を行ってください。じゆ～です！

充分な検証は行っておりますが、配布直後は未知の不具合等が無いとも限りませんので、気になる点などがあれば遠慮なくお問い合わせ下さい。

また使用感などもいただけますとものすごくありがたいです！

### **著作権表示削除について**（2,000円+消費税/1サイト）

デフォルトでは全ページ下部に著作権表示リンクがあります。

これらの著作権表示の削除には1サイトあたり2000円+消費税の使用料金が必要になります。

お支払いいただいた場合、この表示が削除されます。
2サイト目以降は都度料金が必要になります。

※すでに導入済みの場合でも問題ありません。システムと無関係のファイルをアップいただくだけです。

[著作権リンク削除依頼はこちらです（銀行振込）](../license.php?script=Link01)

[クレジットカードでのお支払いはこちら![](../common/img/icon/card_logo.png)](../payment/?script=Link01)

（完全自動化によりクレジットカード払いの場合、決済完了後即ダウンロード可能です。手数料無し）

### よくある質問

##### 管理画面で投稿するとログイン画面が表示される（特にYahooのサーバー使用時）

ログインにはPHPの「セッション（session）」機能を使用しています。

設置サーバーでPHPの「セッション（session）」機能が有効で無い場合、本プログラムは使用不可になります。

ただ、一般的なレンタルサーバーであればまず問題とはなりません。

Yahoo（ジオシティーズ）サーバーの場合にはそのままでは使用できません。

以下ページに説明がありますのでご参考の上作業ください。

[ログイン（セッション）機能使用について](http://www.php-factory.net/trivia/07.php)

##### ぷららホームページサーバーで「Fatal error」 が出る（ぷららは設置不可です）

結論から申しますとぷららホームページサーバーでは動作しません。以下のようなエラーが出るはずです。Fatal error: Call to undefined function mb\_convert\_encoding() in ○○○

これは「mb\_convert\_encoding」関数がないよーというエラーで、

及び

Warning: date() [function.date]: It is not safe to rely on the system's timezone settings.

も出ます。これはタイムゾーンが設定されてませんよーのエラーになります。タイムゾーンは解決可能ですが、上記mb\_convert\_encoding関 数はどうしようもありません。そのため、ぷららでは使用不可です。ぷららにも問い合わせましたが、正式に回答をいただいてますのでご参考まで

--------------------------------------------------------

恐れながら、弊社ユーザーCGIサーバーは「mb\_convert\_encoding」の関数に対応をしておりません。

また、現時点で今後対応の予定はございません。

ご要望に沿えず申し訳ございませんが、ご利用可能な範囲にてユーザー

CGIをご利用くださいますよう、お願い申し上げます。

--------------------------------------------------------

mb\_convert\_encoding関数は文字コードを変換する関数ですが、メールフォームにかぎらずPHPプログラムでは非常に良く使われるメジャーな関数です。

Yahoo、ぷららに限らずプロバイダ系全般に言えますが、制限や特別な設定が必要だったりとトラブルが非常に多いです。

本職では無いのでしょうがない部分もありますが、プロバイダ系は基本的には動作しないものとお考えください。

なのでホームページサーバーとしては極力使うべきではありません。（と断言できます（笑）もう、ちょっと怒ってますｗ）

たくさんの不具合報告をいただいています。

### 不具合、バグ等について

十分な検証は行っておりますが、リリース直後は未知の不具合が無いとも限りません。もし不具合などを発見されましたら遠慮なくお問い合わせ下さい。不具合かどうか分からないようなものでも遠慮なくお問い合わせ下さい。

[お問い合わせはこちら](../contact.php)

### 運用上の注意点

不特定多数（たとえばサイト訪問者）の人間が登録できるような運用は想定しておりません。

関係者のみがログインを行って登録下さい。※管理画面は決して公開しないで下さい。

### 動作確認済PHPバージョン

**PHP4.3.9～PHP8.1**

### 動作確認済レンタルサーバー

* [エックスサーバー](https://px.a8.net/svt/ejp?a8mat=1I6N7F+64AKS2+CO4+609HU) [PR]
  ![](https://www13.a8.net/0.gif?a8mat=1I6N7F+64AKS2+CO4+609HU)

  ※個人的にはここが好きで、もうずっとここです。このサーバーで困ることはまずないでしょう。
* [ロリポップ！](https://px.a8.net/svt/ejp?a8mat=16EM8C+87WMLU+348+65MEA) [PR]
  ![](https://www18.a8.net/0.gif?a8mat=16EM8C+87WMLU+348+65MEA)

  ※ただしここはWAF機能がONの場合、CMSプログラムで問題が発生する可能性が高いです。[詳細はこちら](https://www.php-factory.net/cms/detail.php?id=17)

  またサーバーがブラックリストに登録されてしまいメール系のプログラムで受信できない大問題も多々確認されています。[詳細はこちら](https://www.php-factory.net/cms/detail.php?id=4) 　ただコスパ的には有りだと思います。
* [カゴヤのレンタルサーバー](https://px.a8.net/svt/ejp?a8mat=1ZZHAF+G6A4KY+7YE+I1NCI) [PR]
  ![](https://www13.a8.net/0.gif?a8mat=1ZZHAF+G6A4KY+7YE+I1NCI)

  ここは高機能、高スペック、良心的な価格でありながら風俗系のサイトがOKという非常に貴重なサーバーです。個人的には風俗系のサイトであればこのサーバー以外の選択肢はないと思ってます。
* [さくらのレンタルサーバ](https://px.a8.net/svt/ejp?a8mat=1ZZYHJ+FGOHKI+D8Y+67RK2) [PR]
  ![](https://www13.a8.net/0.gif?a8mat=1ZZYHJ+FGOHKI+D8Y+67RK2)

その他一般的なレンタルサーバーであれば問題なく動作するはずですが、

すべての環境（サーバー）での動作を保証するものではありませんのでご了承下さい。

問題が出る可能性が高い、またはそのままでは必ず問題が出ることが分かっているサーバー

※現状私自身が把握している範囲です。（実際に確認していますのでちゃんと根拠もあります）

1，Yahoo系（ジオプラス、ウェブホスティングとも）※Softbankも含む

2，KDDI系（CPI含む）

3，NTT系（WebArena（suiteX）、NTTビズリンク（BizLink））

※プロバイダー系は特に問題が多いです。（個人的には絶対に借りてはいけないと考えています）

4，スマイルサーバー

5，ファーストサーバ

[特にCPI、NTT系、スマイルサーバー、ファーストサーバで問題がある場合はこちらも参照下さい](https://www.php-factory.net/cms/detail.php?id=6)

経験上、結局は「餅は餅屋です」。プロバイダー系はプラン、金額に関係なく特に問題が多いです。サーバーの問題で時間を取られるのは非常に無駄ですし、その先ずっと影響しますのでサーバー選びは慎重にされることをオススメします。
特に理由がなければあえてこれらのサーバーは借りないほうが得策でしょう。高いから良い、安いからダメという安易なものでもありませんので難しいところですね。（まぁ安いには安いなりの理由があるのですが・・）

### サポートについて

HTMLやCSSなどをある程度理解されている方を対象としています。

カスタマイズ方法などのサポートは行っておりませんのでご了承ください。

修正方法などに関するサポートは有料にて承ります。

管理人1人で運営していますので。。。

[有料サポートはこちら](../support.php)

設置の際の不明点や気になった点、不具合等があれば遠慮なくなんでもご連絡ください。

[お問い合わせはこちら](../contact.php)

### カスタマイズ、設置代行について

カスタマイズ（改造等）方法などのサポートは行っておりません。

カスタマイズや仕様変更、設置代行などは2,000円～の有料にて承ります。

[ご依頼・お見積もりはこちらです](../contact.php)

### ご利用規約

・無料版プログラムはフリーウェアです。ただし、著作権は放棄するものではありません。

・プログラムの著作権表示リンク（ページ下部にある当サイトへのリンク）を無断で削除することはできません。
（一律2,000円+消費税の削除依頼をいただいた場合を除く）

・プログラムの再配布、再販売は禁止です。

　※ただしクライアントへの納品などでシステム費用、設置費用として請求されるのは問題ありません。

・プログラムによって何らかの不利益、損害が生じても一切の責任を負いません。

　あらかじめご了承の上ご使用ください。

　もし何らかのトラブルがあった場合には、ご相談いただければ解決策が見つかるかもしれません。

　（クライアントへの原因の説明など）

・プログラムは全ての環境（サーバー）での動作を保証するものではありません。

・改変等は自由ですが、自己責任でお願いします。

・有料版をご購入いただいた場合、初期不良を除き、ご使用後の返金には応じ兼ねます。

・有料版（著作権リンク削除含む）は1サイト（同一ドメイン）内であれば複製の上で複数利用可能です。
　2サイト目以降は都度サイトより購入申込みが必要になります。
　※サブドメインはその性質上、別サイト（別ドメイン）とみなします。

　ダウンロードいただいた時点で利用規約に同意したものとみなされます。

### 更新履歴

2020.07.30 v1.0.1リリース
認証不備の脆弱性の指摘と修正方法について

-- 脆弱性に該当する製品名およびバージョン

※ver1.0.0

（バージョンはconfig.php内に記載しています）

確認済対象ブラウザ：（Firefox/Chromeで確認）

-- 脆弱性の内容

特定の条件下において、遠隔の第三者に管理者権限で当該製品にログインされる問題。

この条件が成立するには第三者があなたのサイトのサーバー上に無断でファイルを設置する必要があることから、この問題が実際に発生する可能性は限りなく低いと思われます。これまでに実害の報告などは届いておりません。

ユーザーにとって利便性が良いため、あえてそうしていたということもありますので、
非常に判断が難しいものでしたが、今回の指摘を真摯に受け止め、また利便性よりも安全性を優先するという判断としました。

-- 脆弱性への対応方法と適用方法

以下手順で修正を行なってください。

1，admin/内直下にある7つのPHPファイル（index.phpやregist.php）をエディタソフトで開いていただき、

「session\_start();」を見つけて下さい。（ファイル内に1箇所しかないため検索すればすぐに見つかります）

2，この「session\_start();」の上に以下1行をコピペして下さい。

session\_name('PHPSystem');
※「PHPSystem」部分の文字は変更して下さい。英数字のみとして下さい。

例

**session\_name('PHPSystem123');

session\_start();**

※順番に注意して下さい。必ずsession\_start();の上に追加下さい。

以上、これだけです。

もしすでに「session\_name()」がある場合はすでに対策済のバージョンですので変更不要です。

尚、当サイトの管理画面があるプログラムを複数設置している場合で一度のログイン認証で相互に行き来出来たほうが良い場合はsession\_nameの文字列を同じものとして下さい。

-- 謝辞

ご報告いただきました「三井物産セキュアディレクション株式会社　東内様」、

並びに情報処理推進機構 IPA様、JPCERT/CC 脆弱性ハンドリングチーム様にはこの場を借りて感謝申し上げます。

2015/5/1　画像をアップしない場合に純粋なテキストだけのリンクではなく、imgタグも挿入されてしまう不具合を修正しました。 ご迷惑をおかけし申し訳ございません。

配布版はすでに修正済ですが、すでに導入済の方は最新版をダウンロードの上で、以下の場所にある1ファイル

link\_cms/admin/inc/function.php のみを差替えて（上書き）下さい。

2014/6/10　Beta版としてフリー版のプログラム配布を開始

## PHPメールフォーム（無料版）

* [【MailForm01】メールフォーム　フリー](../mail/01.php)
* [【MultiLangForm01】多言語対応版](../mail/multi01.php) ![](../common/img/icon/new.gif)

## PHPメールフォーム（有料版）

* [【MailForm02】アドレス2重チェック付き](../mail/02.php)
* [【MailForm03】CSV保存付き](../mail/03.php)
* [【MailForm04】禁止ワード、禁止IP](../mail/04.php)
* [【MailForm05】ファイル添付機能](../mail/06.php)
* [【MailForm07】送信先振り分け機能付き](../mail/07.php)
* [**【MailFormFull】全機能搭載版（購入はこちら）**](../mail/05.php)
* [フォームのカスタマイズ](../mailform_order.php)
* [フォーム作成依頼](../contact.php#form_sakusei)

## 新着情報・更新履歴CMS（無料版）

* [【PKOBO-News01】](../news/pkobo-news01.php) ![](../common/img/icon/new.gif)

## 投票・アンケートシステム（無料版）

* [【PKOBO-vote01】投票・アンケート](../vote/01.php) ![](../common/img/icon/new.gif)

## テロップCMS（無料版）

* [【Telop01】テロップ・ニュースティッカー](../telop/01.php)

## 写真ギャラリーCMS（無料版）

* [【Gallery01】写真ギャラリー](../gallery/01.php)

## 営業日カレンダーCMS（無料版）

* [【Calendar01】シンプル版](../calendar/01.php)
* [【Calendar02】テキスト入力付き](../calendar/02.php)

## 営業日カレンダーCMS（有料版）

* [【Calendar03】プルダウン・テキスト入力付き](../calendar/03.php)

## カレンダー予約フォーム（無料版）

* [【CalendarForm01】カレンダー予約フォーム](../calendar_form/01.php)

## カレンダー予約フォーム（有料版）

* [【CalendarForm02】カレンダー予約フォーム

  　　CSV保存機能付き](../calendar_form/02.php) ![](../common/img/icon/new.gif)

## リンク集ページCMS（無料版）

* [【Link01】リンク集ページCMS](../link/01.php)

## アクセスカウンター（無料版）

* [テキスト版、画像版](../counter/01.php)

## ダウンロードカウンター（無料版）

* [ダウンロードカウンター01](../download_count/01.php)

## その他

* [【PKOBO-CS-API】API連携中古車情報システム](../product/cs-api.php)

[![メールフォームの各種カスタマイズならお任せ下さい](../common/img/side_ban02.png)](https://www.php-factory.net/mailform_order.php)
[![業務効率化が可能なPHPオリジナルCMS制作します](../common/img/side_ban01.png)](https://www.php-factory.net/cms_order.php)
## 役立つかも？なもの

* [指定URLページのファイルサイズ計測](../trivia/13.php)
* [パチスロ当たりシミュレーター](../trivia/08.php)

## 豆知識や役立ち事など

* [PHPが使えるレンタルサーバー比較](../server.php)
* [htaccessでBasic認証](../trivia/01.php)
* [Yahooジオプラスへの導入について（重要）](../trivia/02.php)
* [Yahooジオプラスでログイン不具合について](../trivia/07.php)
* [UTF-8使用時の注意点（BOMあり、なし）](../trivia/03.php)
* [JSでコピー＆ペースト禁止処理](../trivia/04.php)
* [サーバーのphp.iniによるアップロードファイルの最大容量の確認と容量制限の変更](../trivia/05.php)
* [迷惑メール、スパムメール対策](../trivia/09.php)
* [フォームの基礎知識](../trivia/17.php)
* [送信ボタン連打による多重送信防止](../trivia/18.php)
* [迷惑メール扱いされる場合の対策](../trivia/21.php)

## PHPについて

* [PHP基礎の基礎](../aboutphp/01.php)
* [PHPマニュアル（外部サイト）](http://php.net/manual/ja/index.php)
* [XAMPP（外部サイト）](http://www.apachefriends.org/jp/xampp-windows.html)

## 各種情報

* [よくある質問](../faq.php)
* [有料サポート](https://www.php-factory.net/support.php)
* [カスタマイズ・設置代行・お問い合わせ](https://www.php-factory.net/contact.php)
* [事業概要](../company.php)
* [ご利用規約](../convention.php)
* [運営者プロフィール](../profile.php)
* [プライバシーポリシー](../privacy.php)
* [特定商取引法に基づく表示](../policy.php)
* [リンクについて](../about_link.php)
* [Ken'sWEB](http://www.kens-web.com/)（外部ブログ）

![](../common/img/contents_bottom.png)

[PAGE TOP](#outline)

｜[HOME](../)｜[事業概要](../company.php)｜[ご利用規約](../convention.php)｜[運営者プロフィール](../profile.php)｜[カスタマイズ・設置代行・お問い合わせ](https://www.php-factory.net/contact.php)｜[有料サポート](https://www.php-factory.net/support.php)｜[プライバシーポリシー](../privacy.php)｜

Copyright [PHP工房](../). All Rights Reserved



=== Content from jvn.jp_860d83eb_20250119_115041.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2020/07/31  Last Updated:2020/07/31
# JVN#73169744 Multiple vulnerabilities in multiple PHP Factory products

## Overview

Multiple products provided by PHP Factory contain multiple vulnerabilities.

## Products Affected

**CVE-2020-5615**

* [Calendar01] free edition ver1.0.0
* [Calendar02] free edition ver1.0.0

**CVE-2020-5616**

* [Calendar01] free edition ver1.0.0
* [Calendar02] free edition ver1.0.0
* [PKOBO-News01] free edition ver1.0.3 and earlier
* [PKOBO-vote01] free edition ver1.0.1 and earlier
* [Telop01] free edition ver1.0.0
* [Gallery01] free edition ver1.0.3 and earlier
* [CalendarForm01] free edition ver1.0.3 and earlier
* [Link01] free edition ver1.0.0

## Description

Multiple products provided by PHP Factory contain multiple vulnerabilities listed below.

* **Cross-site Request Forgery ([CWE-352](https://cwe.mitre.org/data/definitions/352.html))** - CVE-2020-5615

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N | **Base Score: 4.3** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:H/Au:N/C:N/I:P/A:N | **Base Score: 2.6** |
* **Authentication bypass ([CWE-287](https://cwe.mitre.org/data/definitions/287.html))** - CVE-2020-5616

  | CVSS v3 | CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N | **Base Score: 4.8** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:H/Au:N/C:P/I:P/A:N | **Base Score: 4.0** |

## Impact

* If a user views a malicious page while logged in, unintended operations may be performed - CVE-2020-5615
* A remote attacker under certain conditions may log in to the product with administrative privileges - CVE-2020-5616

## Solution

**Update the software** - CVE-2020-5615

Update the software to the latest version according to the information provided by the developer.

**Add code to the affected file** - CVE-2020-5616

Add code to the affected file according to the information provided by the developer.

## Vendor Status

| Vendor | Link |
| --- | --- |
| PHP Factory | [[Calendar01] free edition](https://www.php-factory.net/calendar/01.php) |
|  | [[Calendar02] free edition](https://www.php-factory.net/calendar/02.php) |
|  | [[PKOBO-News01] free edition](https://www.php-factory.net/news/pkobo-news01.php) |
|  | [[PKOBO-vote01] free edition](https://www.php-factory.net/vote/01.php) |
|  | [[Telop01] free edition](https://www.php-factory.net/telop/01.php) |
|  | [[Gallery01] free edition](https://www.php-factory.net/gallery/01.php) |
|  | [[CalendarForm01] free edition](https://www.php-factory.net/calendar_form/01.php) |
|  | [[Link01] free edition](https://www.php-factory.net/link/01.php) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

## Credit

Yuji Tounai of Mitsui Bussan Secure Directions, Inc. reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2020-5615](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5615) |
|  | [CVE-2020-5616](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5616) |
| JVN iPedia | [JVNDB-2020-000051](https://jvndb.jvn.jp/jvndb/JVNDB-2020-000051) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2020 JPCERT/CC and IPA. All rights reserved.



=== Content from www.php-factory.net_7410fa06_20250119_115043.html ===


![PHP工房](../common/img/header.png)

[![このエントリーをはてなブックマークに追加](//b.st-hatena.com/images/entry-button/button-only@2x.png)](http://b.hatena.ne.jp/entry/http%3A//www.php-factory.net/ "このエントリーをはてなブックマークに追加")
[Tweet](https://twitter.com/share)

[HOME](../) > 【Calendar01】PHP営業日・スケジュールカレンダーフリー（無料）版

## 【Calendar01】（3デバイス対応）PHP営業日・スケジュールカレンダーフリー（無料）版

![PHP営業日カレンダー　フリー（無料）Beta版デモ](../common/img/sub/sche01.png)

PC、スマホ（スマートフォン）、携帯（ガラケー）3デバイスに対応したフリー（無料）のシンプルスケジュールカレンダー・営業日カレンダーCMSプログラムです。管理画面で営業日、休業日、定休日を設定、更新可能です。

お店や会社、スポーツクラブ、学校（スクール）などの営業日スケジュールカレンダーに最適です。

クライアントが更新することを想定しているので、シンプルで直感的な更新が可能です。

【2024/05/09　重要なお知らせ】
祝日の自動取得機能が正常に動作しない問題。

対象バージョン：ver1.0.2以下。ver1.0.3以降は問題ありません。

※バージョンはconfig.phpの上部に記載されています。

症状：祝日の自動取得が行えない。

原因：GoogleカレンダーAPIの仕様が変わったためと思われます。

対象者：祝日の自動取得機能をONにしている方のみ。（config.phpでON、OFF可能。デフォルト値はOFF）

修正方法：以下をご参考の上で修正してください。

設定ファイルconfig.phpを開き、以下の記述をファイル内検索してください。

//$holidays\_id = 'japanese\_\_ja@holiday.calendar.google.com'; // Google 公式版日本語

この先頭のスラッシュ2つ「//」を削除してコメントアウトを解除（有効化）してください。

これだけです。

### 主な機能と特徴

1. 無料（フリー）の営業日・スケジュールカレンダープログラムです。もちろん商用サイトでもどんなサイトでも設置可能です。
2. 管理画面から登録、編集できるので完全自動化（CMS）として運用可能です。
3. スマホ（スマートフォン）、携帯（ガラケー）用に最適化したファイルも同梱していますので、3デバイス同時更新が可能です。スマホ、ガラケーは表形式ではなく縦長のリスト形式で表示されます。

   PCは表形式、リスト形式を選択可能です。デフォルトは表形式
4. デフォルトデザインはシンプルですが、CSSを編集すればオリジナルデザインも可能。

   （変更にはHTMLやCSSの基本知識が必要です）
5. 設置が容易。ページ内でカレンダーを表示させたい場所にiframeタグ1行を記述すれば表示側の設置は完了します。iframeタグなので既存のページが.htmlでもOKです。
6. 定休日設定（たとえば毎週月曜日）が可能で、設定すれば全期間で有効になります。

   ※ただし隔週は不可なので隔週の場合は通常通りチェックにて反映してください。
7. カレンダーを何ヶ月後まで表示させるかなどの設定が可能です。（過去を表示するかも設定可）
8. 祝日は赤字で表示され、GoogleAPIから自動で取得されます。こちらの詳細が以下「運用上の注意点」にありますのでご一読ください。 （※2015/11/25からオプションとなりました。デフォルトはOFF）

   ただし、この機能はPHP5.2以上のみ可能です。
9. Javascriptは使用していませんので、ブラウザ間の問題もありません。
10. パーミッションの自己診断も行います。データ保存ファイルのパーミッションの値が正常でない場合には管理画面で警告文が出ます。
11. その他設定ファイルにて詳細設定が可能です。ファイル内のコメントを参考に設定下さい。

### サンプルデモ

[管理画面サンプルデモ](../demo/calendar/calendar01/admin.php)

ユーザ名：admin

パスワード：1397

※自由に登録、編集して下さい。

PCのみ表示形式を表（テーブル）形式、リスト形式から選択可能です。（スマホ、ガラケーはリスト形式）

デフォルトは表（テーブル）形式です。設定ファイルにて変更可能です。

[表示サンプルデモ（PC用 表形式）](../demo/calendar/calendar01/)

[表示サンプルデモ（PC用 リスト形式）](../demo/calendar/calendar01/index_list.php)

iframeタグ（インラインフレーム）で表示しています。実際は既存サイトなどに埋め込むことになるかと思います。

カレンダーの幅は自由に変更可能です。（デフォルトは100％）カレンダーはシンプルなHTMLのタグです。CSSにて自由に設定下さい。（ソースを表示して各タグ、class等を確認しつつ設定下さい）

携帯、スマホはQRコードを読めば実機でも確認できます。スマホ、携帯は既存ページ内に表示させるよりもリンクさせる方法が良いでしょう。

| スマホ用QR [QRコード](../demo/calendar/calendar01/sp.php) | 携帯用QR [携帯版QRコード](../demo/calendar/calendar01/i.php) |
| --- | --- |

### ダウンロード

事前に[ご利用規約](#ruleArea)をご確認下さい。

クリックで自分のPCに保存して下さい。または右クリック⇒「対象をファイルに保存」

[【Calendar01】ダウンロード](../download_count/download.php?download=9)

#### 関連プログラム（その他の機能搭載版）

* [【Calendar02】PHP営業日・スケジュールカレンダー(テキスト入力付)](02.php)
* [【Calendar03】PHP営業日・スケジュールカレンダー(プルダウン選択・テキスト入力付)](03.php)

### 設置方法

ファイルの文字コードはUTF-8です。必ず対応したエディタで開いてください。

メモ帳（UTF-8非対応）は使用禁止です。ファイルが壊れます。[TeraPad（無料）](http://www5f.biglobe.ne.jp/~t-susumu/library/tpad.html)やDreamWeaver等で開いてください。必ずUTF-8のBOM無し（UTF-8N）で保存して下さい（いずれもデフォルトではBOM無しで保存されます）。

[BOMについて詳しく知りたい方はこちら](../trivia/03.php)

※PHPではスラッシュ2回「//」の後からその行の末尾までがコメント扱いとなります。「#」、「/\*\*/」もです。

#### 1.ファイル構成を確認し、表示側の設定を行う（iframeタグを埋め込む等）

ダウンロードしたzipファイルを解凍するとcalendar01フォルダがあります。

赤字のファイルが触るファイルです。その他は基本的には触らずOKです。

| ・index.php | PC用のカレンダーを表示するファイルです。実際にはこれをトップページ、または任意のページの任意の箇所にiframeタグで読み込むことになると思います。見た目等はCSSで自由に調整して下さい。 |
| --- | --- |
| インラインフレーム使用時のiframeタグ以下のタグを表示させたい場所に貼り付ければOKです。必要に応じて幅、高さ、パス等を調整してください。 スクロールバーを出したくない場合は高さは多めに指定すると良いです。  <iframe src="calendar01/" width="210" height="310" frameborder="0" scrolling="auto"></iframe> | |
| ・Readme.txt | 設置法、利用規約など。 |
| ・admin.php | 管理画面です。登録や変更を行います。クライアントにはこのURLだけを教えることになるかと思います。 |
| ・complete.php | 「更新」による2重登録防止用のリダイレクトファイルです。そのまま置いておきましょう。 |
| ・config.php | 設定ファイル。管理画面ログイン情報の設定やその他設定、関数記述など |
| ・style.css | admin.php、index.php、sp.phpのスタイルを記述してます(もちろん独自のCSSでもOKです)必要に応じて自由に変更して下さい。 |
| ・data/ | データ保存用ディレクトリ（パーミッションを書き込み可能なものに） |
| ┗ holiday\_set.dat | 休業日データを保存するファイル （パーミッション666等書き込み可能なものに） |
| ┗closed.dat | 定休日データを保存するファイル （パーミッション666等書き込み可能なものに） |
| ┗西暦\_holiday.dat | ダウンロード直後は存在しません。サーバーにアップロード後、初回アクセス時に自動生成されます。 祝日データを保存するファイルです。年が切り替わるタイミングでGoogleAPIより当年、翌年、前年分の祝日データを自動で取得、保存します。Googleの仕様により祝日データが正確では無い場合は直接編集も可能です。登録データを参考に変更下さい。 |
| sp.php | スマホ用のカレンダーです。このファイルにリンクさせる形になるかと思いますが、iframeで読み込んでもOKかもしれません。（ただし、スマホ全機種でのiframeタグ対応は保証できませんのでリンクさせるのが無難です） |
| i.php | 携帯（ガラケー）用のカレンダーです。携帯はiframeに対応していな機種がほとんどかと思うので、このファイルにリンクさせる形になるかと思います。 |

#### **2. ユーザID、パスワードを設定する**

config.phpをエディタソフトで開き、ログインのためのID、パスワードを変更してください。

初期値は

ID：admin

パスワード：1397

になっています。**必ず変更してください。**その他必要に応じてコメントを参考に設定してください。

#### **3. FTPでアップ**

「calendar01」フォルダごと全ファイルをアップし、 **「data」ディレクトリのパーミッションを書き込み可能な755 or 777等に設定（サーバーによる）**

**data/holiday\_set.datのパーミッションを書き込み可能な666等に設定（サーバーによる）

data/closed.dat.datのパーミッションを書き込み可能な666等に設定（サーバーによる）**にしてください。

もちろんカレンダーを埋め込んだページもアップして下さい。これで完了です。

各パーミッションの適切な値はサーバーのマニュアル等を参考に変更下さい。

サーバーによっては値が違う、または変更の必要自体無いこともあります。

もしパーミッションの設定が間違っていた場合ですが、すべての環境での保証はありませんが管理画面にてその旨警告が表示されるよう設定しています。またもしパーミッションが間違いの場合には「data」ディレクトリの場合、祝日データが取得できない、また、holiday\_set.dat、closed.datの場合、新規登録時にエラーで登録自体ができません。要するにまともに動かないのでテスト段階ですぐに気付けます。

逆にそのようなことがない場合は適切なパーミッションになっていると考えてOKです。

ちなみにエックスサーバーの場合、今のところパーミッション変更は不要です。

#### **4.登録テストとブラウザで結果確認**

**ブラウザで「あなたのサイトのURL」/calendar01/admin.php**を表示し、管理画面にログインし、登録を行ってみてください。正常に登録、編集できればOKです。定休日設定も確認下さい。

ifirameなどで埋め込んだページもブラウザで確認してみて下さい。

登録データが反映されていればOKです。

#### **5. ページの調整**

設置するページやその他必要に応じてスタイルシート、HTML等で見た目の調整を行ってください。じゆ～です！

その他htmlソースを見ると分かりますが、タグや各セル、各曜日にはそれぞれclassを振っていますので、

style.cssのCSSを変更して自由にデザイン下さい

また、class="youbi\_0"が日曜日でそのまま曜日ごとに連番が振られclass="youbi\_6"が土曜日となっています。

カレンダー部分のhtmlを変更したい場合はconfig.php内下部に各デバイス（PC用、スマホ用、携帯用）ごとに記述しています。カレンダーのタグや「日」、「月」などのテキストを変更したい場合直接変更してください。

これら設置法などはダウンロードファイル内のReadme.txtにも記述しています。

充分な検証は行っておりますが、配布直後は未知の不具合等が無いとも限りませんので、気になる点などがあれば遠慮なくお問い合わせ下さい。

また使用感などもいただけますとものすごーくありがたいです＾＾

### **著作権表示削除について**（2,000円+消費税/1サイト）

デフォルトではページ下部に著作権表示リンクがあります。

これらの著作権表示の削除には1サイトあたり2000円+消費税の使用料金が必要になります。

お支払いいただいた場合、この表示が削除されます。
2サイト目以降は都度料金が必要になります。

[著作権リンク削除依頼はこちらです（銀行振込）](../license.php?script=Calendar01)

[クレジットカードでのお支払いはこちら![](../common/img/icon/card_logo.png)](../payment/?script=Calendar01)

（完全自動化によりクレジットカード払いの場合、決済完了後即ダウンロード可能です。手数料無し）

### 既存のサイトの任意のページに直接埋め込みたい場合

calendar01フォルダ内のindex.phpの必要な箇所（2箇所）をコピペすればOKです。コメントも書いておりますので参考下さい。
ただし、埋め込み先のページは拡張子が.phpでかつ文字コードがUTF-8である必要があります。

また

require\_once('config.php');

の箇所は設置場所によって変更下さい。単純にconfig.phpへの相対パスを書けばいいだけです。（絶対パス不可）

例　require\_once('calendar01/config.php');

CSSファイルへのリンク部分も必要に応じて変更下さい。もちろんオリジナルでもOKです。

### GoogleAPIの仕様変更に伴う既存ファイルの修正方法

2014/11/25以前にダウンロードされた方は以下のページにまとめしたのでご参照下さい。

[GoogleAPIの仕様変更に伴う既存ファイルの修正方法](../calendar_form/holiday_update.php)

### 運用上の注意点

2014/11/17からのGoogleAPIの仕様変更に伴い、GoogleAPIキーが必要になりました。お手数ですが、事前にAPIキーの取得が必要になります。取得方法は以下ページにまとめておりますのでご参考下さい。

[GoogleカレンダーAPIキーの取得手順](../calendar_form/google_api.php)

祝日設定は不要、またはGoogleAPIキーの取り方が分からない、または面倒な方はそのままでも運用は問題ありません。デフォルトはOFFです。（祝日が赤字にならないだけです）または祝日用のデータファイルをこのページからダウンロードいただいて手動でdataディレクトリにアップしても反映可能です。

### 動作確認済PHPバージョン

**PHP4.3.9～PHP8.1**

### 動作確認済レンタルサーバー

* [エックスサーバー](https://px.a8.net/svt/ejp?a8mat=1I6N7F+64AKS2+CO4+609HU) [PR]
  ![](https://www13.a8.net/0.gif?a8mat=1I6N7F+64AKS2+CO4+609HU)

  ※個人的にはここが好きで、もうずっとここです。このサーバーで困ることはまずないでしょう。
* [ロリポップ！](https://px.a8.net/svt/ejp?a8mat=16EM8C+87WMLU+348+65MEA) [PR]
  ![](https://www18.a8.net/0.gif?a8mat=16EM8C+87WMLU+348+65MEA)

  ※ただしここはWAF機能がONの場合、CMSプログラムで問題が発生する可能性が高いです。[詳細はこちら](https://www.php-factory.net/cms/detail.php?id=17)

  またサーバーがブラックリストに登録されてしまいメール系のプログラムで受信できない大問題も多々確認されています。[詳細はこちら](https://www.php-factory.net/cms/detail.php?id=4) 　ただコスパ的には有りだと思います。
* [カゴヤのレンタルサーバー](https://px.a8.net/svt/ejp?a8mat=1ZZHAF+G6A4KY+7YE+I1NCI) [PR]
  ![](https://www13.a8.net/0.gif?a8mat=1ZZHAF+G6A4KY+7YE+I1NCI)

  ここは高機能、高スペック、良心的な価格でありながら風俗系のサイトがOKという非常に貴重なサーバーです。個人的には風俗系のサイトであればこのサーバー以外の選択肢はないと思ってます。
* [さくらのレンタルサーバ](https://px.a8.net/svt/ejp?a8mat=1ZZYHJ+FGOHKI+D8Y+67RK2) [PR]
  ![](https://www13.a8.net/0.gif?a8mat=1ZZYHJ+FGOHKI+D8Y+67RK2)

その他一般的なレンタルサーバーであれば問題なく動作するはずですが、

すべての環境（サーバー）での動作を保証するものではありませんのでご了承下さい。

問題が出る可能性が高い、またはそのままでは必ず問題が出ることが分かっているサーバー

※現状私自身が把握している範囲です。（実際に確認していますのでちゃんと根拠もあります）

1，Yahoo系（ジオプラス、ウェブホスティングとも）※Softbankも含む

2，KDDI系（CPI含む）

3，NTT系（WebArena（suiteX）、NTTビズリンク（BizLink））

※プロバイダー系は特に問題が多いです。（個人的には絶対に借りてはいけないと考えています）

4，スマイルサーバー

5，ファーストサーバ

[特にCPI、NTT系、スマイルサーバー、ファーストサーバで問題がある場合はこちらも参照下さい](https://www.php-factory.net/cms/detail.php?id=6)

経験上、結局は「餅は餅屋です」。プロバイダー系はプラン、金額に関係なく特に問題が多いです。サーバーの問題で時間を取られるのは非常に無駄ですし、その先ずっと影響しますのでサーバー選びは慎重にされることをオススメします。
特に理由がなければあえてこれらのサーバーは借りないほうが得策でしょう。高いから良い、安いからダメという安易なものでもありませんので難しいところですね。（まぁ安いには安いなりの理由があるのですが・・）

### よくある質問

##### カレンダー表示スペースの高さを内容に応じて調整したい（iframeのスクロールバーを出さない）

iframeの場合には、高さが自動で調整されるようなものではないため、微妙な高さ調整は難しいのが現状です。

その場合、ファイルにPHPのソースコードを直接埋め込むことで解決可能です。詳細は上記「既存のサイトの任意のページに直接埋め込みたい場合」を参考下さい。

記憶が定かではありませんが、たしかiframeの高さを内容に応じて調整してくれるJavascriptがあった気がします。

##### 当月と翌月を表示したい

営業日カレンダー（Calendar01、Calendar02、Calendar03）の場合

表示するファイル内の

「▼▼▼ 任意のページに埋め込んで表示させたい場合（iframeを使わない）はここからコピペ ▼▼▼」

から

「 ▲▲▲コピペここまで▲▲▲」

までをまるっとコピーし、そのまま「 ▲▲▲コピペここまで▲▲▲」の下にまるっと貼り付けし、

1，貼り付けた側の「require\_once('config.php');」の1行を削除下さい。（2重で読み込むとエラーとなります）

2，貼り付けた側の「scheduleCalendarPc($ym,$timeStamp,$copyright);」という記述を以下のように修正下さい。（コピペでOKです）※作業は一字一句間違わないよう慎重に行って下さい。

scheduleCalendarPc(date('Y-m',strtotime(date('Y-m-1').' +1 month')),strtotime(date('Y-m-1',strtotime(date('Y-m-1').' +1 month'))),$copyright);

これでこれは当月と翌月が表示されるようになります。レイアウトや見た目は自由に調整下さい。

カレンダーフォームの場合（【CalendarForm01】）

まず表示用のファイル内（pc.phpなど）の以下の箇所をまるっとコピペ下さい。

<!--　▼以下休業日、定休日テキスト箇所。すべて削除してしまってオリジナルでももちろんOKです▼　-->

から

<?php Uqa4h78r();}//著作権表記リンク無断削除禁止（削除すると全機能、または一部機能が失われます）?>

ここまでをコピーし、そのままその下にコピペ下さい。

その上で貼り付けた方の「scheduleCalenderPc($ym,$timeStamp,$copyright);」を以下にまるっと書き換えて下さい。（コピペでOKです）

scheduleCalenderPc(date('Y-m',strtotime(date('Y-m-1').' +1 month')),strtotime(date('Y-m-1',strtotime(date('Y-m-1').' +1 month'))),$copyright);

翌々月（2ヶ月後）を表示したい場合には、「+1」とある2箇所を+2にすればOKです。3ヶ月後などそれ以降は同じルールでOKです。

翌月、前月のリンクをCSSで非表示にする（必要に応じて）

必要に応じてカレンダー内に表示されている翌月、前月のリンクをCSSで非表示に。

.calendarHeader a{
display:none;
}

##### 祝日自動取得ができない。（エラー表示や画面真っ白など）

2014/11/25以降にプログラムをダウンロードされた方でこの症状が出る場合には、PHPのバージョンの問題が考えられます。祝日自動取得はPHP5.2以上である必要があります。PHP5.2以上にバージョンアップされるか、設定ファイルで自動取得をOFFにして下さい。

##### レスポンシブのためPCでは表形式、スマホ版ではリスト形式が表示されるようにしたい

レスポンシブ化されているページの場合、基本的には表形式、またはリスト形式のどちらかを固定で選ぶ必要がありますが、
メディアクエリを利用することでそういったことが可能ではあります。

考え方としては、
iframeタグを2つ記述して、PC用、スマホ用を読み込んでおいて、
それぞれのiframeタグにid属性を付けておいて、
CSSで表示、非表示を切り替えるだけですね。

例

<iframe src="calendar/" width="100%" height="450" frameborder="0" scrolling="auto" id="pc"></iframe>

<iframe src="calendar/sp.php" width="100%" height="450" frameborder="0" scrolling="auto" id="sp"></iframe>

あとはCSSでdisplay:noneで制御すればOKですね。

メディアクエリについてご存知ない場合はご自身で調べてみて下さい。

```

/* CSS例 */

#pc{
	display:block;
}
#sp{
	display:none;
}

@media screen and (max-width:572px) {
/*　画面サイズが572px以下はここを読み込む　*/

#pc{
	display:none;
}
#sp{
	display:block;
}

}

```

以上です。

##### 管理画面での更新が反映されない（管理画面側の表示月数の問題）

設定ファイルで管理画面側の表示月数を設定可能となっていますが、複数月を一括で更新する仕様上、管理画面側の表示月数を増やすほど、1ページあたりのPOST数（項目数）も増えていきます。

ここで問題となるのがPHP5.3以降で導入されたphp.iniの「max\_input\_vars」で、これはPOST数の上限値です。

この「max\_input\_vars」はデフォルトで1000に設定されています。

そのため管理画面側の表示月数を増やしていくとこの上限値1000を超えてしまうため、
更新が反映されない状況になります。

プログラムごとに異なりますが、表示月数をおおよそ以下の値に設定すると上限値を上回ってしまう可能性が高いです。

【Calendar01】＝ 基本的には問題となりません。（少なくとも2～3年程度まではOKです）

【Calendar02】＝ おおよそ14ヶ月以上

【Calendar03】＝ おおよそ7ヶ月以上

そのためこの表示月数以下としていただく必要がございます。

どうしてもこの表示月数以上に設定されたい場合はサーバーのphp.iniの設定値を変更する必要があります。

サーバーのphp.iniの設定値を変更する方法については以下ページで説明しておりますのでご参考下さい。

[PHP5.3以降で一度にPOSTできる上限数（max\_input\_vars）を変更する](../trivia/14.php)

##### 祝日自動取得での祝日が実際の祝日と異なる（間違っている）

残念ながら祝日自動取得はGoogleのサービスを利用する性質上、100％正確ではありません。

また2020年は特にイレギュラーな年であり、天皇誕生日の追加やオリンピックに合わせて祝日が多数変更されていますが、自動取得では反映されないようです。

そのため祝日用のデータファイルを直接編集することで対応いただくしか手がありません。

2020年の祝日データファイルは以下の場所にあります。

data/2020\_holiday.dat

※「2020」の箇所がその年の祝日データファイルということです。（2021＝2021年の祝日データファイル）

「2020\_holiday.dat」をエディタソフトなどで開いていただき、
1行ごとに祝日が記述されていますので、
実際の祝日などを参考に日付を直接修正して下さい。

### サポートについて

HTMLやCSSなどをある程度理解されている方を対象としています。

カスタマイズ方法などのサポートは行っておりませんのでご了承ください。

修正方法などに関するサポートは有料にて承ります。

管理人1人で運営していますので。。。

[有料サポートはこちら](../support.php)

設置の際の不明点や気になった点、不具合等があれば遠慮なくなんでもご連絡ください。

[お問い合わせはこちら](../contact.php)

### カスタマイズ、設置代行について

カスタマイズ（改造等）方法などのサポートは行っておりません。

カスタマイズや仕様変更、設置代行などは2,000円～の有料にて承ります。

[ご依頼・お見積もりはこちらです](../contact.php)

### ご利用規約

・無料版プログラムはフリーウェアです。ただし、著作権は放棄するものではありません。

・プログラムの著作権表示リンク（ページ下部にある当サイトへのリンク）を無断で削除することはできません。
（一律2,000円+消費税の削除依頼をいただいた場合を除く）

・プログラムの再配布、再販売は禁止です。

　※ただしクライアントへの納品などでシステム費用、設置費用として請求されるのは問題ありません。

・プログラムによって何らかの不利益、損害が生じても一切の責任を負いません。

　あらかじめご了承の上ご使用ください。

　もし何らかのトラブルがあった場合には、ご相談いただければ解決策が見つかるかもしれません。

　（クライアントへの原因の説明など）

・プログラムは全ての環境（サーバー）での動作を保証するものではありません。

・改変等は自由ですが、自己責任でお願いします。

・有料版をご購入いただいた場合、初期不良を除き、ご使用後の返金には応じ兼ねます。

・有料版（著作権リンク削除含む）は1サイト（同一ドメイン）内であれば複製の上で複数利用可能です。
　2サイト目以降は都度サイトより購入申込みが必要になります。
　※サブドメインはその性質上、別サイト（別ドメイン）とみなします。

　ダウンロードいただいた時点で利用規約に同意したものとみなされます。

### 更新履歴

2024.05.09　ver1.0.3リリース
祝日の自動取得機能が正常に動作しない問題の改善。

ver1.0.2以下の場合で祝日の自動取得機能をONにしている場合は修正が必要です。

ページ上部に記載しておりますのでご確認いただければと思います。

2021.05.20 v1.0.2リリース
管理画面における反射型クロスサイトスクリプティングの指摘と修正方法について

-- 脆弱性に該当する製品名およびバージョン

※ver.1.0.0～ver.1.0.1

（バージョンはadmin/include/config.php内の上部に記載しています）

確認済対象ブラウザ：（Firefox/Chromeで確認）

-- 脆弱性の内容

管理画面にアクセスしたユーザーを悪意のあるページに誘導することで、ウェブブラウザ上で任意のスクリプトが実行される可能性。

この条件が成立するには管理画面にログインしている管理者を特定のページに誘導する必要があることから、実際に発生する可能性は限りなく低いと思われます。これまでに実害の報告などは届いておりません。

ただ念の為、下記手順にて修正を行なっていただければと思います。

-- 脆弱性への対応方法と適用方法

最新版をダウンロードの上で設定ファイルconfig.phpのみを差し替えていただくか（設定が初期化されます）、

または以下手順で修正を行なってください。

config.phpの723行目付近の以下の箇所。

※ファイル内で1箇所しかありませんので間違うことはありません。

$scheduleCalendar = '<form action="?ym='.$getYm.'" method="post">';

↓以下のように修正いただくか、そのままコピペください。

$scheduleCalendar = '<form action="?ym='.h($getYm).'" method="post">';

※「$getYm」をh()で囲むだけです。

以上、これだけです。念の為、管理画面で更新などの操作を行なってください。

特に問題がなければ完了です。もし万が一問題が発生した場合は戻していただくか、お問い合わせください。

-- 謝辞

apple502j様並びに情報処理推進機構 IPA様、JPCERT/CC 脆弱性コーディネーショングループ様にはこの場を借りて感謝申し上げます。

2020.07.30 1.0.1 リリース
脆弱性対策に伴うコード修正

クロスサイト・リクエスト・フォージェリ（CSRF）対策及びセキュリティ強化のためセッション名の変更。

-- 脆弱性に該当する製品名およびバージョン

[【Calendar01】（3デバイス対応）PHP営業日・スケジュールカレンダーフリー（無料）版](../calendar/01.php)

[【Calendar02】PHP営業日・スケジュールカレンダー(テキスト入力付)　フリー・無料版](../calendar/02.php)

※ver.1.0.0（2020/07/30以降にダウンロードされた方は該当しません。）

（バージョンはReadmeまたはconfig.php内に記載しています）

確認済対象ブラウザ：（Firefox/Chromeで確認）

-- 脆弱性の内容

1，クロスサイト・リクエスト・フォージェリ（CSRF）

管理画面へログイン中の管理者が悪意のある第三者が作成した罠ページへ誘導された場合に、特定のリンクをクリックさせることによって任意のスクリプトを含む文字列が投稿され、閲覧者側で任意のスクリプトが実行される可能性。

2，特定の条件下において、遠隔の第三者に管理者権限で当該製品にログインされる問題。

この条件が成立するには第三者があなたのサイトのサーバー上に無断でファイルを設置する必要があることから、この問題が実際に発生する可能性は限りなく低いと思われます。これまでに実害の報告などは届いておりません。

ユーザーにとって利便性が良いため、あえてそうしていたということもありますので、
非常に判断が難しいものでしたが、今回の指摘を真摯に受け止め、また利便性よりも安全性を優先するという判断としました。

-- 脆弱性への対応方法と適用方法

1，クロスサイト・リクエスト・フォージェリ（CSRF）

最新版をダウンロードいただき、既存のadmin.phpのみを差し替えて（上書き）下さい。

複数の複雑な条件が重ならない限り本脆弱性は発生しないため、設置中のものがすぐに攻撃対象となる可能性は低いと考えていますが、大変お手数おかけしますが出来る限りご対応頂きますようお願い申し上げます。

問題が出た場合にはお気軽にお問い合わせよりご連絡下さい。

2，特定の条件下において、遠隔の第三者に管理者権限で当該製品にログインされる問題。

以下手順で修正を行なってください。

1，admin.phpをエディタソフトで開いていただき、

「session\_start();」を見つけて下さい。（ファイル内に1箇所しかないため検索すればすぐに見つかります）

2，この「session\_start();」の上に以下1行をコピペして下さい。

session\_name('PHPSystem');
※「PHPSystem」部分の文字は変更して下さい。英数字のみとして下さい。

例

**session\_name('PHPSystem123');

session\_start();**

※順番に注意して下さい。必ずsession\_start();の上に追加下さい。

以上、これだけです。

もしすでに「session\_name()」がある場合はすでに対策済のバージョンですので変更不要です。

尚、当サイトの管理画面があるプログラムを複数設置している場合で一度のログイン認証で相互に行き来出来たほうが良い場合はsession\_nameの文字列を同じものとして下さい。

-- 謝辞

ご報告いただきました「三井物産セキュアディレクション株式会社　東内様」、

並びに情報処理推進機構 IPA様、JPCERT/CC 脆弱性ハンドリングチーム様にはこの場を借りて感謝申し上げます。

2015.06.19
サーバーのPHPのバージョンがPHP4.○○の場合に管理画面で翌月、前月が「1月」と表示されてしまう。及び表示側で前月に戻れない不具合を修正しました。PHP5以上であれば問題はありませんでしたので、今現在設置中の方は特に問題はございません。
（今現在大多数のサーバーではPHP5以上のため基本的には問題ありません）

ご連絡いただきましたI様にはこの場を借りて感謝申し上げます。

2014.11.25

2014.11.17からのGoogleカレンダーAPIの仕様変更に伴い、祝日データが自動で取得されない不具合を修正しました。2014.11.25以前にダウンロードされた方は大変お手数ですが、現在配布中の最新版をダウンロードいただくか、修正をお願い致します 。

[GoogleAPIの仕様変更に伴う既存ファイルの修正方法](holiday_update.php)

今後は祝日自動取得にGooglAPIキーが必要になります。→googleにて無料で取得できます。

または最新版に限りますが、設定ファイルでこの機能をOFFにし、このサイトから祝日用のデータファイルをダウンロードの上、手動でアップする方法もあります。またはそもそも祝日設定が不要であればOFFのままで運用可能です。

2014.02.28　Calenderのスペルが間違っていたものを修正しました。ソースコード内のスペルも変更しています。（Calender→Calendar）

2014.02.01　インラインフレーム（iframe）での設置のみを考慮していましたが、既存のページにも直接埋め込めるよう修正しました。但し埋め込み先のページの文字コードがUTF-8である必要があります。

2014.01.19　スマホ、携帯版は表形式ではなく、縦長のリスト形式で表示するよう修正。PCは表形式、リスト形式選択可能に（デフォルトは表形式）

2013/9/4　Beta版としてプログラムの配布を開始

## PHPメールフォーム（無料版）

* [【MailForm01】メールフォーム　フリー](../mail/01.php)
* [【MultiLangForm01】多言語対応版](../mail/multi01.php) ![](../common/img/icon/new.gif)

## PHPメールフォーム（有料版）

* [【MailForm02】アドレス2重チェック付き](../mail/02.php)
* [【MailForm03】CSV保存付き](../mail/03.php)
* [【MailForm04】禁止ワード、禁止IP](../mail/04.php)
* [【MailForm05】ファイル添付機能](../mail/06.php)
* [【MailForm07】送信先振り分け機能付き](../mail/07.php)
* [**【MailFormFull】全機能搭載版（購入はこちら）**](../mail/05.php)
* [フォームのカスタマイズ](../mailform_order.php)
* [フォーム作成依頼](../contact.php#form_sakusei)

## 新着情報・更新履歴CMS（無料版）

* [【PKOBO-News01】](../news/pkobo-news01.php) ![](../common/img/icon/new.gif)

## 投票・アンケートシステム（無料版）

* [【PKOBO-vote01】投票・アンケート](../vote/01.php) ![](../common/img/icon/new.gif)

## テロップCMS（無料版）

* [【Telop01】テロップ・ニュースティッカー](../telop/01.php)

## 写真ギャラリーCMS（無料版）

* [【Gallery01】写真ギャラリー](../gallery/01.php)

## 営業日カレンダーCMS（無料版）

* [【Calendar01】シンプル版](../calendar/01.php)
* [【Calendar02】テキスト入力付き](../calendar/02.php)

## 営業日カレンダーCMS（有料版）

* [【Calendar03】プルダウン・テキスト入力付き](../calendar/03.php)

## カレンダー予約フォーム（無料版）

* [【CalendarForm01】カレンダー予約フォーム](../calendar_form/01.php)

## カレンダー予約フォーム（有料版）

* [【CalendarForm02】カレンダー予約フォーム

  　　CSV保存機能付き](../calendar_form/02.php) ![](../common/img/icon/new.gif)

## リンク集ページCMS（無料版）

* [【Link01】リンク集ページCMS](../link/01.php)

## アクセスカウンター（無料版）

* [テキスト版、画像版](../counter/01.php)

## ダウンロードカウンター（無料版）

* [ダウンロードカウンター01](../download_count/01.php)

## その他

* [【PKOBO-CS-API】API連携中古車情報システム](../product/cs-api.php)

[![メールフォームの各種カスタマイズならお任せ下さい](../common/img/side_ban02.png)](https://www.php-factory.net/mailform_order.php)
[![業務効率化が可能なPHPオリジナルCMS制作します](../common/img/side_ban01.png)](https://www.php-factory.net/cms_order.php)
## 役立つかも？なもの

* [指定URLページのファイルサイズ計測](../trivia/13.php)
* [パチスロ当たりシミュレーター](../trivia/08.php)

## 豆知識や役立ち事など

* [PHPが使えるレンタルサーバー比較](../server.php)
* [htaccessでBasic認証](../trivia/01.php)
* [Yahooジオプラスへの導入について（重要）](../trivia/02.php)
* [Yahooジオプラスでログイン不具合について](../trivia/07.php)
* [UTF-8使用時の注意点（BOMあり、なし）](../trivia/03.php)
* [JSでコピー＆ペースト禁止処理](../trivia/04.php)
* [サーバーのphp.iniによるアップロードファイルの最大容量の確認と容量制限の変更](../trivia/05.php)
* [迷惑メール、スパムメール対策](../trivia/09.php)
* [フォームの基礎知識](../trivia/17.php)
* [送信ボタン連打による多重送信防止](../trivia/18.php)
* [迷惑メール扱いされる場合の対策](../trivia/21.php)

## PHPについて

* [PHP基礎の基礎](../aboutphp/01.php)
* [PHPマニュアル（外部サイト）](http://php.net/manual/ja/index.php)
* [XAMPP（外部サイト）](http://www.apachefriends.org/jp/xampp-windows.html)

## 各種情報

* [よくある質問](../faq.php)
* [有料サポート](https://www.php-factory.net/support.php)
* [カスタマイズ・設置代行・お問い合わせ](https://www.php-factory.net/contact.php)
* [事業概要](../company.php)
* [ご利用規約](../convention.php)
* [運営者プロフィール](../profile.php)
* [プライバシーポリシー](../privacy.php)
* [特定商取引法に基づく表示](../policy.php)
* [リンクについて](../about_link.php)
* [Ken'sWEB](http://www.kens-web.com/)（外部ブログ）

![](../common/img/contents_bottom.png)

[PAGE TOP](#outline)

｜[HOME](../)｜[事業概要](../company.php)｜[ご利用規約](../convention.php)｜[運営者プロフィール](../profile.php)｜[カスタマイズ・設置代行・お問い合わせ](https://www.php-factory.net/contact.php)｜[有料サポート](https://www.php-factory.net/support.php)｜[プライバシーポリシー](../privacy.php)｜

Copyright [PHP工房](../). All Rights Reserved



=== Content from jvndb.jvn.jp_f31b0e9b_20250119_133711.html ===


![JVN iPedia](/en/common/img/en_logo.gif)
Last Updated:2020/07/31

| [[Japanese]](/ja/contents/2020/JVNDB-2020-000051.html) | |
| --- | --- |
| JVNDB-2020-000051 | |
| Multiple vulnerabilities in multiple PHP Factory products | |
| Overview | |
| Multiple products provided by PHP Factory contain multiple vulnerabilities listed below. | |
| CVSS Severity ([What is CVSS?](/en/nav/jvndbhelp.html#jvndb3)) | |
| **CVSS V3 Severity:Base Metrics [4.8](/cvss/en/v3.html#CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N) (Medium) [IPA Score]**  * Attack Vector: Network * Attack Complexity: High * Privileges Required: None * User Interaction: None * Scope: Unchanged * Confidentiality Impact: Low * Integrity Impact: Low * Availability Impact: None  **CVSS V2 Severity:Base Metrics [4.0](/cvss/en/v2.html#AV:N/AC:H/Au:N/C:P/I:P/A:N) (Medium) [IPA Score]**  * Access Vector: Network * Access Complexity: High * Authentication: None * Confidentiality Impact: Partial * Integrity Impact: Partial * Availability Impact: None   The above CVSS base scores have been assigned for CVE-2020-5616 | |
| ---   **CVSS V3 Severity: Base Metrics: [4.3](/cvss/ja/v3.html#/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N) (Medium) [IPA Score]**  * Attack Vector: Network * Attack Complexity: Low * Privileges Required: None * User Interaction: Required * Scope: Unchanged * Confidentiality Impact: None * Integrity Impact: Low * Availability Impact: None **CVSS V2 Severity:****Base Metrics: [2.6](/cvss/ja/v2.html#AV:N/AC:H/Au:N/C:N/I:P/A:N) (Low) [IPA Score]**  * Access Vector: Network * Access Complexity: High * Authentication: None * Confidentiality Impact: None * Integrity Impact: Partial * Availability Impact: None The above CVSS base scores have been assigned for CVE-2020-5615 | |
| Affected Products | |
|  | |
| PHP Kobo  * [Calendar01] (for 3 Devices) PHP Business Days, Schedule Calendar free edition * PHP Business Days, Schedule Calendar Free (Text input) * (Acceptance Limit)Appoinment, Application Form, Business Calendar Free * Photo Gallery CMS for PC, smartphone and feature phone (Free) * PHP Link CMS Free * PHP New Information, Notice, News CMS Program Free * PHP Vote, Questionnaire System (Preventing Countinuous Voting), CMS Free * [Telop01] PHP Telop, News Sticker, Headline CMS free edition | |
| **CVE-2020-5615** \* [Calendar01] free edition ver1.0.0 \* [Calendar02] free edition ver1.0.0 **CVE-2020-5616** \* [Calendar01] free edition ver1.0.0 \* [Calendar02] free edition ver1.0.0 \* [PKOBO-News01] free edition ver1.0.3 and earlier \* [PKOBO-vote01] free edition ver1.0.1 and earlier \* [Telop01] free edition ver1.0.0 \* [Gallery01] free edition ver1.0.3 and earlier \* [CalendarForm01] free edition ver1.0.3 and earlier \* [Link01] free edition ver1.0.0 | |
| Impact | |
| \* If a user views a malicious page while logged in, unintended operations may be performed - CVE-2020-5615 | |
| Solution | |
| [Update the software] - CVE-2020-5615 | |
| Vendor Information | |
| PHP Kobo  * PHP Kobo : [[Calendar01] free edition](https://www.php-factory.net/calendar/01.php) (in Japanese) * PHP Kobo : [[Calendar02] free edition](https://www.php-factory.net/calendar/02.php) (in Japanese) * PHP Kobo :  [[PKOBO-News01] free edition](https://www.php-factory.net/news/pkobo-news01.php) (in Japanese) * PHP Kobo : [[PKOBO-vote01] free edition](https://www.php-factory.net/vote/01.php) (in Japanese) * PHP Kobo : [[Telop01] free edition](https://www.php-factory.net/telop/01.php) (in Japanese) * PHP Kobo : [[Gallery01] free edition](https://www.php-factory.net/gallery/01.php) (in Japanese) * PHP Kobo : [[CalendarForm01] free edition](https://www.php-factory.net/calendar_form/01.php) (in Japanese) * PHP Kobo : [[Link01] free edition](https://www.php-factory.net/link/01.php) (in Japanese) | |
| CWE ([What is CWE?](http://www.ipa.go.jp/security/english/vuln/CWE_en.html)) | |
| 1. [Permissions(CWE-264)](https://www.ipa.go.jp/en/security/vulnerabilities/cwe.html) [IPA Evaluation] 2. [Cross-Site Request Forgery(CWE-352)](https://www.ipa.go.jp/en/security/vulnerabilities/cwe.html) [IPA Evaluation] | |
| CVE ([What is CVE?](http://www.ipa.go.jp/security/english/vuln/CVE_en.html)) | |
| 1. [CVE-2020-5615](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5615) 2. [CVE-2020-5616](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-5616) | |
| References | |
| 1. JVN : [JVN#73169744](https://jvn.jp/en/jp/JVN73169744/index.html) 2. National Vulnerability Database (NVD) : [CVE-2020-5615](https://nvd.nist.gov/vuln/detail/CVE-2020-5615) 3. National Vulnerability Database (NVD) : [CVE-2020-5616](https://nvd.nist.gov/vuln/detail/CVE-2020-5616) | |
| Revision History | |
| * [2020/07/31] | |

| --- | |
| --- | --- |
| Date Public | 2020/07/31 |
| Date First Published | 2020/07/31 |
| Date Last Updated | 2020/07/31 |
| --- | |

* JVN
* [HOME](https://jvn.jp/en/)
* [What is JVN ?](https://jvn.jp/en/nav/jvn.html)
* [Instructions](https://jvn.jp/en/nav/jvnhelp.html)
* [List of Vulnerability Report](https://jvn.jp/en/report/index.html)
* [VN\_JP](https://jvn.jp/en/jp/index.html)
* [VN\_JP(Unreachable)](https://jvn.jp/en/adj/index.html)
* [VN\_VU](https://jvn.jp/en/vu/index.html)
* [TA](https://jvn.jp/en/ta/index.html)
* [TRnotes](https://jvn.jp/en/tr/index.html)
* [JVN iPedia](/en/)
* [Search](/search/index.php?mode=_vulnerability_search_IA_VulnSearch&lang=en)
* [What is JVN iPedia?](/en/nav/jvndb.html)
* [How to Use?](/en/nav/jvndbhelp.html)
* [MyJVN](/en/apis/myjvn/index.html)
* [JVNJS/RSS](https://jvn.jp/en/rss/index.html)
* [Vendor List](https://jvn.jp/en/nav/index.html)
* [List of unreachable developers](https://jvn.jp/en/reply/index.html)
* [Contact](https://jvn.jp/en/contact/index.html)

![Copyright © 2007- IPA. All rights reserved.](/common/img/copyright.png)



=== Content from www.php-factory.net_089bdc37_20250119_115052.html ===


![PHP工房](../common/img/header.png)

[![このエントリーをはてなブックマークに追加](//b.st-hatena.com/images/entry-button/button-only@2x.png)](http://b.hatena.ne.jp/entry/http%3A//www.php-factory.net/ "このエントリーをはてなブックマークに追加")
[Tweet](https://twitter.com/share)

[HOME](../) > 【PKOBO-vote01】PHP投票・アンケートシステム（連続投票防止付き）CMS フリー（無料）版

## 【PKOBO-vote01】PHP投票・アンケートシステム（連続投票防止付き）CMS フリー（無料）版

![【PKOBO-vote01】PHP投票・アンケートシステム（連続投票防止付き）CMS フリー（無料）版](../common/img/sub/pvote01_01.png)
##### MENU

1. [まえがき](#section00)
2. [主な特徴](#section01)
3. [サンプルデモ](#section03)
4. [プログラムダウンロード](#section04)
5. [設置方法](#section05)
6. [インラインフレーム使用時のタグ例](#section06)
7. [投票制限用クッキーの初期化方法について](#section_cookie)
8. [著作権表示リンク削除について](#section09)
9. [動作確認済PHPバージョン](#section10)
10. [動作確認済レンタルサーバー](#section11)
11. [よくある質問](#section12)
12. [ご利用について](#section13)
13. [ご利用規約](#section14)
14. [カスタマイズ、設置代行について](#section15)
15. [2重投票を完全に防止できるものではありません](#section16)
16. [実施しているセキュリティ対策について](#section17)
17. [更新履歴](#section_last)

### **まえがき**

管理画面から登録、管理できる投票、アンケートなどに最適なシステムです。テキストのほか、画像もアップできますので様々な要件に対応可能です。たとえば、一般的なテキストのみのアンケート「このページは役に立ちましたか？」や、デザイン画や写真の投票システムとしても使用可能です。

ただし、このシステムは重複投票をクッキーによって制御していますが、完全な1人1票ということはできませんので予めご了承下さい。詳細は以下をご確認下さい。

[2重投票を完全に防止できるものではありません](#section16)

こちらでも十分に検証を行なっておりますが、配布直後は未知のバグが無いとも限りません。不具合やお気づきの点がございましたら遠慮なくご連絡いただけますと幸いです。また使用感やこのページでの間違い、分かりにくい点等ありましたらお知らせいただけたら大変ありがたいです。いずれも[お問い合わせ](../contact.php)よりご連絡いただければと存じます。

### **主な特徴**

* 個人・商用問わずどんなサイトでも無料でご使用いただけます。

  クライアントへの納品などでももちろんOKです。

  ただ実際に導入してみてもし気に入っていただけましたら「

  」していただけるとさらにより良いものへと進化する可能性があります（笑）

  デフォルトでは全ページ下部に著作権リンク（クレジット）が表示されます。著作権リンク（クレジット）の削除申請については[こちら](#section09)をご参照下さい。
* データベースは不要です。PHPが動作する環境であればほとんどのサーバーで動作し、また軽量なため軽快に動作します。

  （基本的にPHPのバージョンは問いません。PHP4.3.9～5.5まで動作確認済）※5.3以上推奨。
* 管理画面からブログ感覚で更新できます。商用サイトへの導入を前提に、クライアントが投稿することを想定しシンプル＆分かり易さを追求しています。

  複数のアンケート、投票を登録できますので、たとえばページごとに別々のアンケートを設置することも可能です。（表示するアンケートを指定できます　※設置法参照下さい）

  また管理画面にはページング機能が付いていますのでどんなに投稿が増えても問題ありません。（デフォルトは100件/1ページあたり）

  ※投稿数に上限はありません。
* テキストのみ、または画像のみ、または両方を表示することが可能なため様々な要件に対応できるでしょう。画像（jpg、gif、png）はサイズも自動縮小します（サイズ、画質とも設定ファイルにて設定可）。デフォルトは横写真の場合は幅、縦写真の場合は高さでいずれも600pxで画質は90。サーバーにもよりますが、デジカメ写真のような大きいファイルサイズでもそのまま登録OKです。クライアントにいちいち縮小してから登録してねーとか面倒ですよね＾＾；

  ※サーバーのphp.iniの設定によりアップロード容量の制限値が異なります。デフォルトは2MBとしています。

  [変更方法や詳細はこちらを参考下さい](../trivia/05.php)

  ※iPhoneで縦で撮った写真が横写真として認識されてしまう問題も対策しています。

  ※透明pngにも対応しています。

  ※管理画面内に現在のサーバーの設定値を確認できるページを用意してますのでそちらで現在の容量の制限値等をご確認下さい。
* 投票、アンケート項目の上限は1投稿あたりデフォルトでは「20」としています。（設定ファイルで設定可）これは一度にアップできる画像（ファイル）の数がphp.iniのデフォルトの上限値では「20」に設定されているためです。画像もアップする場合でかつ項目が20を超えるアンケートを作成したい場合は設定ファイルの変更だけでなくphp.iniの設定変更も必要です。 （php.iniのmax\_file\_uploadsの値（デフォルト20）を任意の数値に変更下さい。　※PHP 5.2.12 以降で利用可能。php.iniの変更方法はサーバーによっても異なりますので割愛いたします）

  逆に画像はアップせずテキストのみであればphp.iniの変更は不要で上限もありません。設定ファイルでデフォルトの上限20を任意の値に変更するだけでOKです。（無制限です）
* 表示期間の設定も可能。
* 投稿データの表示・非表示が可能。
* 投票数のカウントを管理画面からリセットできます。
* 新規投稿時にのみデータファイルをバックアップ用ディレクトリ（backup/）にコピー保存します。（デフォルトはOFF）万が一のデータファイルの上書きや何らかの不具合によるデータ消失を防ぎます。テキストデータのため容量は大きくありませんのでONにしておくことをオススメします。（設定ファイルで可）
* その他オプション等の設定はすべて設定ファイル（config.php）で行えますのでファイル内のコメントを参考に設定ください。
* 動作確認済ブラウザ：Firefox、Chrome、IE9～IE11、iPhone（Safari）、Android

  特殊な処理は特に行なっていないため基本的にはブラウザ間の問題は非常に出にくい仕様としています。

  ただし、投票時のメッセージ表示にのみJS（ライブラリ不要のいたってシンプルなもの）を使っているため、ガラケーのJS非対応機種はメッセージが表示されません。（まぁ今の時代あまり問題にならないと思いますが念のためです）
* 項目ごとにリンク設定が可能です。（バージョン1.0.1（2016/2/5公開）～より追加しました）

### サンプルデモ

[管理画面サンプルデモ](../demo/vote/PKOBO_vote01/pkobo_vote/admin/)

ユーザID：admin

パスワード：13971397

テスト投稿してみてください。下記のページに反映されます。削除も可能です。

#### 表示側サンプル

※この一覧部分はvote\_list.phpをiframeで表示しています。実際にはこの一覧ページを使う機会はあまり無いでしょう。実際には「投票する」を押した後のページを表示することがほとんどかと思います。

※またサンプルでは再投票可能までの期間を10秒に設定しています。

### **プログラムダウンロード**

事前に[ご利用規約](#section14)をご確認、ご同意下さい。

クリックで自分のPCにダウンロード保存して下さい。または右クリック⇒「対象をファイルに保存」

[PKOBO\_vote01.zip(約55KB)](../download_count/download.php?download=22)

表示側はUTF-8、Shift-JIS、EUC-JPに対応。デフォルトはUTF-8。

直接埋め込む場合で埋め込みページがUTF-8以外の場合、埋め込み用ファイル(vote.php)内で文字コードを設定可能です。

※PCはUTF-8、携帯はShist\_JISのように別々の文字コードでも問題ありません。

### **設置方法**

ファイルの文字コードはUTF-8です。必ず対応したエディタで開いてください。

メモ帳（UTF-8非対応）は使用禁止です。TeraPad（無料）やDreamWeaver等で開いてください。

（そこまで意識する機会はありませんが、必ずBOM無しで保存して下さい。※多くのエディタのデフォルトはBOM無しのはずです。[BOMについて詳しく知りたい方はこちら](../trivia/03.php)）

※ PHPでは、スラッシュ2回「//」の後からその行の末尾までがコメント扱いとなります。「#」、「/\*\*/」もです。

#### **1.  ダウンロードファイルを解凍する**

**zipファイルになっていますので解凍下さい。解凍ソフトは何でも構いません。Windowsであれば標準で付いている「展開」などでもOKです。**

#### **2.**ファイル構成と各ファイルの説明

一般的なサイトの階層構造を意識して配置しています。要するに**vote.php**がある階層がサイトのトップページの階層と同じということですね。

■色のものはパーミッション変更が必要なものです。

| vote.php、 vote\_radio.php | 投票、アンケートデータの表示ページです。登録した投票、アンケート項目が表示され、実際に投票も行うページです。これを一般ユーザーに公開することになります。 表示する投票、アンケートデータのID番号をファイル内、またはパラメータにより指定下さい。これで該当のアンケートのみを表示できます。 指定方法はファイル内にも記載しています。 [iframeでの指定方法はこちらもご参考下さい。](#section06)   vote.phpは各項目ごとに投票ボタンが付きワンクリックで投票出来ます。 vote\_radio.phpはラジオボタンを選択してからの投票となります。 お好きな方を使用下さい。逆に違いはこれだけですので使わないほうは無視して下さい。  既存のページ（既存ページを複製したものなど）に直接埋め込みでもOKですし、iframeでもOKです。 直接埋め込みの場合は埋め込み先のファイルの拡張子が.phpである必要があります。 また直接埋め込みの場合にはコピペ箇所がコメントにて指示してありますので参考下さい。 投票、アンケートという性質上SEO的な意味あいはあまり無いのでiframeで表示してしまうのが最も手っ取り早いかと思います。 |
| --- | --- |
| vote\_list.php | ページング機能が付いた一覧ページです。このページはほとんどの場合、使用することは無いでしょう。必要に応じて使用下さい。 |
| iframe.html | iframeで埋め込む場合用のHTMLタグです。あくまでコピペ用ですので削除いただいて構いません。 |
| ┗ pkobo\_vote/ | システム全体のディレクトリです。リネームは可能ですが、変更した場合、各表示側ファイルのパス部分も変更が必要です。検索、置換などで対応下さい。 自信が無い場合、特に理由が無い場合は変更しないことをオススメします。 |
| ┗ admin/index.php | 管理画面です。登録や変更、削除を行います。クライアントにはこのURLだけを教えることになるかと思います。 |
| ┗ include/config.php | 設定ファイル。管理画面ログイン情報の設定やその他設定が可能です。 エディタで開きコメントを参考に必要に応じて設定下さい。 特にログイン情報は必ず変更下さい。 セキュリティ上の観点から念のためパーミッションを「444」に設定下さい。 （ただし、444だとFTPソフトでも上書きできなくなることがあるので、その場合は一時的に666等に変更する必要があります） |
| ┗ その他ファイル | すべて必要なファイルになりますが意識する機会はないと思います。特に触らずそのままアップ下さい。特に「copy.inc」は触らないで下さい。システムエラーが発生します。 |
| ┗ data/ | データ保存用ディレクトリ（パーミッションを777等書き込み可能なものに） |
| ┗ data.dat | データを保存するファイル（パーミッション666等書き込み可能なものに） |
| ┗ backup/ | データファイルのバックアップを保存するディレクトリです。 （パーミッションを777等書き込み可能なものに） バックアップはオプションです。デフォルトはOFF。 バックアップをONにすると新規投稿時にだけbackupディレクトリ内に「backup年月日時分秒\_○○.dat」のファイル名で最新のdata.datが複製されて保存されます。古いものは自動で削除されます。保存期間は指定可能です（デフォルトは3ヶ月　※本日から3ヶ月前までのデータを保存します）。このあたりは設定ファイル内にも詳しく記述しています。 |
| ┗ upload/ | アップロードファイル保存用ディレクトリです。 （パーミッションを777等書き込み可能なものに） |

#### **3， ユーザID、パスワードを設定する**

admin/include/config.phpをエディタソフトで開き、ログインのためのID、パスワードを変更してください。

初期値は

ID：admin

パスワード：13971397

になっています。**必ず変更してください。**（半角の英数字、記号が設定可能です）

※パスワードはできるだけ13文字以上かつ大文字、小文字のローマ字、数字、記号（+\_?\*等）などを含めて下さい。

その他必要に応じてコメントを参考に設定してください。

#### **4， FTPでアップ**

pkobo\_voteフォルダ、及び表示先のページなどすべてアップしてください。

上記の■色のファイル、ディレクトリのパーミッションを変更下さい。

（ただし、config.phpは444だとFTPソフトでも上書きできなくなることがあるので、その場合は一時的に666等に変更する必要があります。ってことで戸惑われる方もいると思うので本当はややこしいので「444」にして下さいとかあまり言いたくは無いのですが、WPの改ざん問題とかもありましたので、念のため変更しておいたほうがいいでしょうっていう程度のことです）

サーバーによっては変更自体が不要な場合があります。また値もサーバーにより異なることがあります。

パーミッションが異常の場合には、管理画面で警告メッセージが表示されますので、すぐに気づくことができます。
逆に正常に管理画面にアクセできて、登録もできていれば、正常なパーミッションになっていると考えてOKです。ちなみにエックスサーバーの場合、今のところパーミッション変更は不要です。

極々稀にPHPファイル自体のパーミッション変更が必要なサーバーもあります。

#### **5，ブラウザで確認**

**「あなたのサイトのURL（設置した階層）」/pkobo\_vote/admin/**を表示し、管理画面にログイン後、登録、変更、削除を行ってみてください。正常に登録、編集、削除ができればOKです。

表示側のページも確認下さい。
登録データが反映されていればOKです。

#### **6， ページの調整**

必要に応じてスタイルシート、HTML等で見た目の調整を行ってください。じゆ～です！

特にvote.phpのデフォルトは画像での投票を考慮したCSSとしています。実際の要件に合わせて自由に編集下さい。

こちらでも十分に検証を行なっておりますが、配布直後は未知のバグが無いとも限りません。お気づきの点がございましたら遠慮なくご連絡下さい。大変ありがたいです。

### **インラインフレーム（iframe）使用時のタグ例**

同梱のiframe.htmlにも書いていますが、以下のタグをページの表示させたい場所に貼り付ければOKです。必要に応じて幅、高さ、パス等を調整してください。
ただ、実際には表示するアンケート、投票を指定することがほとんどかと思います。
（パラメータを省略した場合にはID番号「1」のアンケートを表示します）

<iframe src="vote.php" width="700" height="300" frameborder="0" scrolling="auto"></iframe>
通常は以下のようにパラメータを設定することがほとんどでしょう。

パラメータを設定することで指定のデータを表示可能です。例 「vote.php?id=2」とすればID番号「2」のデータが表示されます。ID番号は管理画面で確認可能です。（管理画面トップの「ID」欄）
たとえば以下の様にですね。
（この場合、ID番号が「2」のアンケートが表示されます）

<iframe src="vote.php?id=2" width="700" height="300" frameborder="0" scrolling="auto"></iframe>

### **投票制限用クッキーの初期化方法について**

テスト時などにはカウント用のクッキーを削除したい場合もあると思います。

ブラウザにより方法は異なりますが削除は可能です。

##### Firefoxの場合

ツール → オプション → プライバシー → Cookie を個別に削除

にて検索ボックスに「pvote\_」と入力して検索して下さい。

該当のクッキーが表示されますので、
それを選択し、下部の「選択されたcookieを削除」を押すことで削除できます。

### **著作権表示リンク削除について**（2,000円+消費税/1サイト）

デフォルトでは全ページの下部に著作権**表示**リンク（クレジット）表示があります。

無断での削除は禁止となります。

クライアントへの納品やリンクが煩わしい、または寄付の意味でなどクレジットを削除されたい場合には、

1サイトあたり2,000円+消費税のライセンス料金が必要になります。申請いただければ開発の励みにもなります。

お支払いいただければ場合、すべてのページでクレジットが削除されます。

2サイト目以降は都度料金が必要になります。

尚、プログラム自体に変更を要するものではございませんので、すでに導入済みであればそのままお使いいただけます。まだ導入されていない場合でも、導入作業を行なっていただいて問題ございません。

※システムには無関係の1ファイルを差替えしていただくだけになります。

※差替えするファイルはご入金確認後にメールにてお送りいたします。

[著作権リンク削除申込はこちらです（銀行振込）](../license.php?script=PKOBO-vote01)

[クレジットカードでのお支払いはこちら![](../common/img/icon/card_logo.png)](../payment/?script=PKOBO-vote01)

（完全自動化によりクレジットカード払いの場合、決済完了後即ダウンロード可能です。手数料無し）

### 動作確認済PHPバージョン

**PHP4.3.9～PHP8.1**

### 動作確認済レンタルサーバー

* [エックスサーバー](https://px.a8.net/svt/ejp?a8mat=1I6N7F+64AKS2+CO4+609HU) [PR]
  ![](https://www13.a8.net/0.gif?a8mat=1I6N7F+64AKS2+CO4+609HU)

  ※個人的にはここが好きで、もうずっとここです。このサーバーで困ることはまずないでしょう。
* [ロリポップ！](https://px.a8.net/svt/ejp?a8mat=16EM8C+87WMLU+348+65MEA) [PR]
  ![](https://www18.a8.net/0.gif?a8mat=16EM8C+87WMLU+348+65MEA)

  ※ただしここはWAF機能がONの場合、CMSプログラムで問題が発生する可能性が高いです。[詳細はこちら](https://www.php-factory.net/cms/detail.php?id=17)

  またサーバーがブラックリストに登録されてしまいメール系のプログラムで受信できない大問題も多々確認されています。[詳細はこちら](https://www.php-factory.net/cms/detail.php?id=4) 　ただコスパ的には有りだと思います。
* [カゴヤのレンタルサーバー](https://px.a8.net/svt/ejp?a8mat=1ZZHAF+G6A4KY+7YE+I1NCI) [PR]
  ![](https://www13.a8.net/0.gif?a8mat=1ZZHAF+G6A4KY+7YE+I1NCI)

  ここは高機能、高スペック、良心的な価格でありながら風俗系のサイトがOKという非常に貴重なサーバーです。個人的には風俗系のサイトであればこのサーバー以外の選択肢はないと思ってます。
* [さくらのレンタルサーバ](https://px.a8.net/svt/ejp?a8mat=1ZZYHJ+FGOHKI+D8Y+67RK2) [PR]
  ![](https://www13.a8.net/0.gif?a8mat=1ZZYHJ+FGOHKI+D8Y+67RK2)

その他一般的なレンタルサーバーであれば問題なく動作するはずですが、

すべての環境（サーバー）での動作を保証するものではありませんのでご了承下さい。

問題が出る可能性が高い、またはそのままでは必ず問題が出ることが分かっているサーバー

※現状私自身が把握している範囲です。（実際に確認していますのでちゃんと根拠もあります）

1，Yahoo系（ジオプラス、ウェブホスティングとも）※Softbankも含む

2，KDDI系（CPI含む）

3，NTT系（WebArena（suiteX）、NTTビズリンク（BizLink））

※プロバイダー系は特に問題が多いです。（個人的には絶対に借りてはいけないと考えています）

4，スマイルサーバー

5，ファーストサーバ

[特にCPI、NTT系、スマイルサーバー、ファーストサーバで問題がある場合はこちらも参照下さい](https://www.php-factory.net/cms/detail.php?id=6)

経験上、結局は「餅は餅屋です」。プロバイダー系はプラン、金額に関係なく特に問題が多いです。サーバーの問題で時間を取られるのは非常に無駄ですし、その先ずっと影響しますのでサーバー選びは慎重にされることをオススメします。
特に理由がなければあえてこれらのサーバーは借りないほうが得策でしょう。高いから良い、安いからダメという安易なものでもありませんので難しいところですね。（まぁ安いには安いなりの理由があるのですが・・）

### よくある質問

##### 管理画面で投稿するとログイン画面が表示される（特にYahooのサーバー使用時）

ログインにはPHPの「セッション（session）」機能を使用しています。

設置サーバーでPHPの「セッション（session）」機能が有効で無い場合、本プログラムは使用不可になります。

ただ、一般的なレンタルサーバーであればまず問題とはなりません。

Yahoo（ジオシティーズ）サーバーの場合にはそのままでは使用できません。

以下ページに説明がありますのでご参考の上作業ください。

[ログイン（セッション）機能使用について](../trivia/07.php)

※2015/6/2追記

ソフトバンクサーバーでも同様の現象が確認されました。

<https://www.php-factory.net/cms/detail.php?id=18>

##### 画像をアップしても反映されない

まず、サーバー上のuploadフォルダを開いて見て下さい。そこでFTPソフトの「更新」を押してみて、デフォルトでindx.htmlがありますが、それ以外に.jpgなどの画像ファイルがあるかどうか確認下さい。

ある場合には単純に表示側のimgタグのパスが間違っていることが考えられます。設置によって階層構造を変えている場合に発生しやすいです。できれば配布している階層そのままで設置してみて下さい。

そこに画像ファイルが無い場合は画像がアップされていないということです。考えられることはuploadフォルダのパーミッションが間違っている（基本的にはその場合管理画面で警告が出ます）、または、サーバーのphp.iniの設定でアップロードファイルの容量制限に引っかかっている、GDライブラリがインストールされていないなどが考えられます。プログラム側で5MBに設定しても、サーバー側の設定が2MBの場合はサーバー側の設定が優先されます。特にさくらサーバーのデフォルトは2MBだったと思います。

サーバーの容量制限については以下ページで解説してますのでご確認、必要に応じて設定変更してください。

[サーバーのphp.iniによるアップロードファイルの最大容量の確認と容量制限の変更](../trivia/05.php)

PHPのGDライブラリですが、これはPHP4.3以降標準でインストールされていますので、ほとんどのサーバーでは問題無いはずです。

ただ、サーバーによっては、デフォルトで「Off」になっている可能性もあります。

以下ページを参考に現在のphp.iniの設定を表示させ、

[サーバーのphp.iniの設定確認方法](../trivia/05.php)

「gd」でページ内を検索してみてください。「GD Support」などがあれば動いていることになります。

逆に「gd」自体見つからない場合には「有効」にする必要があります。

php.iniの設定で

;extension=php\_gd2.dll
部分の先頭のセミコロンを削除してapacheを再起動すればOKです。

php.iniの設定、変更手順などはサーバーによって違います。詳しくはマニュアル、または無いような意地悪なサーバーなら直接サーバーに問い合わせてみて下さい。

「GD」を有効にしたいのですが・・・と質問すれば回答してくれるかと思います。

##### データファイル（data/data.dat）を間違ってローカルのファイルで上書きしてしまった

バックアップ機能をオンにしていれば（デフォルトはOFF）、data/backup/内に保存されているバックアップファイルで復旧が可能です。このファイルはdata/data.datを単純にコピーしたものです。

ファイル名はバックアップ時の「年月日時分秒」となっています。

「例　backup20131002024103\_data.dat（この場合2013年10月2日2時41分3秒ということ」

これをリネームしdata/data.datを上書きすればOKです。その場合、念のためパーミッションを確認下さい。666等書き込み可能である必要があります。ただし、バックアップは新規投稿時のみ作成されます。もし新規投稿後にクライアント等が「編集」、「削除」などを行っていると、その変更内容は反映されていませんので先祖返り（デグる）する可能性があります。必要に応じてクライアントに説明、確認等を行うのが良いかもしれません。

バックアップを行っていなかった場合には申し訳ありませんがデータの復旧は不可能となります。

念のためサーバー会社に問い合わせてみてもいいかもしれません。バックアップを取っている可能性があるかもしれません。

サーバー障害によるデータ全損失の場合には復旧は不可となります。

この場合も念のためサーバー会社にお問い合わせください。

可能であれば念のため定期的にデータファイルをダウンロードされることをおすすめします。

##### ぷららホームページサーバーで「Fatal error」 が出る（ぷららは設置不可です）

結論から申しますとぷららホームページサーバーでは動作しません。以下のようなエラーが出るはずです。Fatal error: Call to undefined function mb\_convert\_encoding() in ○○○

これは「mb\_convert\_encoding」関数がないよーというエラーで、

及び

Warning: date() [function.date]: It is not safe to rely on the system's timezone settings.

も出ます。これはタイムゾーンが設定されてませんよーのエラーになります。タイムゾーンは解決可能ですが、上記mb\_convert\_encoding関数はどうしようもありません。そのため、ぷららでは使用不可です。ぷららにも問い合わせましたが、正式に回答をいただいてますのでご参考まで

--------------------------------------------------------

恐れながら、弊社ユーザーCGIサーバーは「mb\_convert\_encoding」の関数に対応をしておりません。

また、現時点で今後対応の予定はございません。

ご要望に沿えず申し訳ございませんが、ご利用可能な範囲にてユーザー

CGIをご利用くださいますよう、お願い申し上げます。

--------------------------------------------------------

mb\_convert\_encoding関数は文字コードを変換する関数ですが、メールフォームにかぎらずPHPプログラムでは非常に良く使われるメジャーな関数です。

Yahoo、ぷららに限らずプロバイダ系全般に言えますが、制限や特別な設定が必要だったりとトラブルが非常に多いです。
本職では無いのでしょうがない部分もありますが、プロバイダ系は基本的には動作しないものとお考えください。

なのでホームページサーバーとしては極力使うべきではありません。（と断言できます（笑）もう、ちょっと怒ってますｗ）

たくさんの不具合報告をいただいています。

##### ロリポップで記事登録時に「403 Error - Forbidden ※指定されたページ（ＵＲＬ）へのアクセスは禁止されています。」とエラーが表示されてしまう。

管理画面で登録ボタンを押すとエラー表示される場合があります。これは主にロリポップの新機能「WAF機能」による可能性が高いです。以下ページを参考にこの機能をOFFにしてみてください。

[ロリポップの新機能「WAF機能」をOFFにする](https://www.php-factory.net/cms/detail.php?id=17)

##### 投稿したものが文字化けする（主にファーストサーバ、CPI、WebArena（suiteX）など）

以下ページに掲載されているサーバーの場合にはそのままでは問題があります。内容は若干異なりますが、対応方法はおなじになりますので、ご参考の上でご対応下さい。

<https://www.php-factory.net/cms/detail.php?id=6>

##### 管理画面内の「サーバー情報確認」のナビを非表示にしたい

設定ファイルでOFFにできます。

config.php内の「管理画面ヘッダ部の「サーバー情報確認」のナビを表示する（0=しない、1=する）」となっている箇所です。

##### デフォルトのレイアウトを変更したい

vote.php（またはvote\_radio.php）のソースを見ていただくわかりますが、あくまでも見た目はHTML＆CSSで調整されているに過ぎません。そのため基本的にはどのような見た目にもできます。

デフォルトでは画像をアップすることを前提としているため、幅、高さを指定してfloatさせています。また罫線も表示しています。ただ実際にはこういった用途とは限らないでしょう。たとえば、テキストだけの場合も多いと思います。

以下の様な感じですね。

![](../common/img/sub/pvote01_02.png)

##### 項目の上限20を変更したい（21以上に引き上げたい）

まずデフォルトで20に設定している理由はPHPのデフォルト（※PHP 5.2.12 以降で利用可能）では一度にアップできるファイル数がMAX20に設定されているためです。

そのためこの上限を上げるにはサーバーのphp.iniの設定が必要です。（php.ini または httpd.confで設定可能）

ただし、ファイル（画像など）のアップは行わずテキストのみの投票の場合には、この制限は無関係になりますので設定ファイル（config.php）でいくつにでも設定可能です。（無制限）※この場合php.iniの変更も不要です。

画像アップも含む場合で上限を20以上に上げるにはphp.iniの変更も必要になります。
php.iniの変更方法はサーバーにより異なりますが、
主にサーバー管理画面上で変更できたり、php.iniというファイルを該当ディレクトリに設置することが多いと思います。（この設定変更はhtaccessでは基本的に不可）
その際の記述は主に以下です。
※例　100に設定する場合。

max\_file\_uploads = 100

※またこの場合、当然設定ファイル（config.php）のほうも上限を変更して下さい。

ただし、これはあくまでもサーバー側で設定変更が許可されている場合のみ有効です。このあたりはサーバーマニュアルやサーバー会社にご確認下さい。

また上限を上げたとしても今度は一度にアップできるファイル容量の問題も絡みます。

複数回に分けてアップするなどが必要になります。

またはこれの上限を上げる場合には詳細は以下を参照下さい。

<http://www.php-factory.net/trivia/05.php>

##### 投票数制限用のブラウザのクッキーを初期化（クリア）したい

詳細は[投票制限用クッキーの初期化方法について](#section_cookie)をご参考下さい。

### ご利用について

HTMLやCSSなどをある程度理解されている方を対象としています。

設置、カスタマイズ方法などのサポートは行っておりませんのでご了承ください。

設置法、HTMLタグ、CSS等に関するサポートは申し訳ありませんが有料にて承ります。

カスタマイズについてもすべてお見積りの上で有償対応となります。

もちろん不具合などがありましたら遠慮なく何でもご相談ください。

[不具合などのお問い合せはこちら](../contact.php)

[有料サポートはこちら](../support.php)

### ご利用規約

・無料版プログラムはフリーウェアです。ただし、著作権は放棄するものではありません。

・プログラムの著作権表示リンク（ページ下部にある当サイトへのリンク）を無断で削除することはできません。
（一律2,000円+消費税の削除依頼をいただいた場合を除く）

・プログラムの再配布、再販売は禁止です。

　※ただしクライアントへの納品などでシステム費用、設置費用として請求されるのは問題ありません。

・プログラムによって何らかの不利益、損害が生じても一切の責任を負いません。

　あらかじめご了承の上ご使用ください。

　もし何らかのトラブルがあった場合には、ご相談いただければ解決策が見つかるかもしれません。

　（クライアントへの原因の説明など）

・プログラムは全ての環境（サーバー）での動作を保証するものではありません。

・改変等は自由ですが、自己責任でお願いします。

・有料版をご購入いただいた場合、初期不良を除き、ご使用後の返金には応じ兼ねます。

・有料版（著作権リンク削除含む）は1サイト（同一ドメイン）内であれば複製の上で複数利用可能です。
　2サイト目以降は都度サイトより購入申込みが必要になります。
　※サブドメインはその性質上、別サイト（別ドメイン）とみなします。

　ダウンロードいただいた時点で利用規約に同意したものとみなされます。

### **カスタマイズ、設置代行について**

どのようなカスタマイズでもまずはお気軽にご相談下さい。お見積りをお出しします。

[設置のご依頼・カスタマイズお見積もりの詳細はこちらです](../contact.php)

### 2重投票を完全に防止できるものではありません

PHPのクッキーによりユーザーを判別し連続送信防止を制御しています。クッキーはブラウザの機能を利用しています。そのため簡単に言ってしまうとブラウザを変えてしまえば同じ人間が2回も3回も投票できてしまいます。（またはブラウザのクッキーを削除しても同じことになります。）

要するに完全に1人1票というのは非常に難しいのが現状です。現実的には「不可」と言ってしまって差し支え無いと思います。逆にこれができればすべての投票がネットで行えることになりますね。

（個人的には選挙もこれにしてしまえば莫大なお金を節約できてすごく良いことだと思うんですけどね）

このシステムはあくまでもそういった厳密な投票には対応できませんのでご了承下さい。

IPアドレスも基本的には定期的に変わるため（スマホの場合は特に頻繁に）、実装しても意味が無い上に可能性は低いですが、正規のユーザーを弾いてしまうリスクがあるため、あえて実装していません。

その他より厳密にする方法としては、メールアドレスを登録してもらう、携帯番号を登録してもらう、Facebookのアカウントを申請してもらうなども考えられますが、
いずれも完全ではありませんし、そもそも手間がかかってしまうデメリットも有りますのであまり現実的ではありません。

最近出てきたマイナンバーを利用すれば多少は良くなるかもしれませんが、なりすましもあるだろうし、名前、住所なども申請してもらったところでその情報とマイナンバーが一致するかどうかも個人では判断できないでしょう。

こういった理由から厳密に1人1票のシステムは非常に難しいのが現状です。

### 実施しているセキュリティ対策について

当プログラムで行なっている対策をご紹介します。

一般的に考えうるリスクには対策を施しています。無料版だからこのぐらいでいいだろうというような妥協は一切していません。

##### 注意事項（大前提としまして）

このシステムは管理者が更新を行うCMSシステムです。管理画面での更新は特定の人間（社内や管理者のみなど）のみが行うことを前提としています。不特定多数の人間が管理画面に入って投稿できるような一般公開型の掲示板のような使用は絶対に行わないで下さい。（第三者が投票を行うことはもちろん問題ありません）

具体的な対策（この下に展開されます）

##### クロスサイト・スクリプティング対策（XSS）

表示側ではすべての表示要素に対してhtmlspecialcharsにて適切にエスケープ（サニタイズ）していますので、ページ上でHTMLタグ類が有効になることはありません。

唯一このシステムの都合上、本文入力欄のみHTMLを有効にする必要がありますので、この部分については、サニタイズを実施していません。

ただ、これはCMSの仕様上、管理者しか更新しないことを想定していますので、それが即問題となることではありませんし（管理者があえて閲覧者に危害を加えるようなものを記述することは無いと思いますので）、また下記「CSRF対策」も行なっていますので、問題ないと考えています。

##### クロスサイトリクエストフォージェリ対策（**CSRF**またはXSRF）

投稿時、変更時、削除時ともワンタイムトークンにより、外部サイト経由でのCSRFを防止しています。

もちろん管理画面はそもそもログイン認証が必要なため、基本的にはそのようなことは発生しませんが、ログイン中のユーザーを悪意のある第三者が作成したページに誘導されてしまい任意のスクリプトを実行させることでデータ改ざんされてしまうというCSRFに対する対策になります。

またアップファイルは設定ファイルで指定したもののみ可能となっていますので、PHPファイルやhtaccessなどがアップされてしまうこともありません。（逆に必要なファイル以外は許可しないで下さい）

またアップファイルは拡張子も含め強制的にリネームされますので、ファイル名による攻撃は完全に防ぎます。

##### **ディレクトリトラバーサル**対策

大前提としてアップファイルの元ファイル名は一切利用せず、すべて完全に一意のファイル名にリネームされ、ディレクトリを表すような文字列「/」や「..」などが有効になることはありません。また保存先も固定値としておりますので、意図しないディレクトリへのアップロードは出来ない設計になっています。（保存時は元ファイル名$\_FILE[]['name']は使用していません「tmp\_name」を使用しています）

またアップされるファイルの拡張子についても制限を設けています。（設定ファイルで設定可）また拡張子はシステム側で付与していますので、ファイル名で拡張子「.」が2つ以上になることもありません。（○○.php.jpgとされた場合にPHPコードが実行される脆弱性への対策など）

まぁそもそもCSRF（対策済）や管理画面がハックされない限り管理者が意図しないファイルをアップされるリスクはほぼありませんが、念には念の対策を行なっています。まぁ仮にハックされたとしても危ないファイルはアップできないためそもそもこの脆弱性自体は存在しないことになります。（管理画面がハックされた場合、当然記事を改ざんされるなどはあるかもしれませんが）

##### ログイン認証クラックの対策

ログインにはユーザーID、パスワードの入力が必要ですが、総当りされてしまうと現実的にはいつかは突破されるリスクがあります。そのためパスワードは出来る限り推測困難かつ長い文字列で設定することが最も重要な対策となりますが、ID、パスワードの入力ミスが特定回数連続で起こった場合には強制終了し、詳しい仕様はお伝えできませんが、総当りを連続で行えないような実装を行っています。

もしクライアントなど正規のユーザーが忘れてしまったなどでそういった事態に陥った場合には、設定ファイルでの正確なログイン情報を伝えて下さい。

またデータベースは使用していませんのでログイン情報はPHPファイル内にしか存在しないため漏洩のリスクは限りなく低いです。

（上記でも述べましたが、よりセキュリティを上げるため設定ファイルconfig.phpのパーミッションを444に設定下さい）

##### インジェクション対策

データベースは使用していないため基本的には問題ありませんが、セキュリティ上具体的には言えませんがパラメータは厳密にチェックしています。イレギュラーがあれば即強制終了します。まぁ個人情報を含むようなシステムではありませんのであえてこれを行うほど暇な人がいるとは思えませんが、念には念の対策を行なっています。

セキュリティには十分に配慮していますが、問題点などがございましたら遠慮なくご指摘いただけたらと思います。

### **更新履歴**

2020.07.30 v1.0.2リリース
認証不備の脆弱性の指摘と修正方法について

-- 脆弱性に該当する製品名およびバージョン

※ver.1.0.1及びそれ以前

（バージョンはReadmeまたはconfig.php内に記載しています）

確認済対象ブラウザ：（Firefox/Chromeで確認）

-- 脆弱性の内容

特定の条件下において、遠隔の第三者に管理者権限で当該製品にログインされる問題。

この条件が成立するには第三者があなたのサイトのサーバー上に無断でファイルを設置する必要があることから、この問題が実際に発生する可能性は限りなく低いと思われます。これまでに実害の報告などは届いておりません。

ユーザーにとって利便性が良いため、あえてそうしていたということもありますので、
非常に判断が難しいものでしたが、今回の指摘を真摯に受け止め、また利便性よりも安全性を優先するという判断としました。

-- 脆弱性への対応方法と適用方法

以下手順で修正を行なってください。

1，pkobo\_vote/admin/内直下にある7つのPHPファイル（index.phpやregist.php）をエディタソフトで開いていただき、

「session\_start();」を見つけて下さい。（ファイル内に1箇所しかないため検索すればすぐに見つかります）

2，この「session\_start();」の上に以下1行をコピペして下さい。

session\_name('PHPSystem');
※「PHPSystem」部分の文字は変更して下さい。英数字のみとして下さい。

例

**session\_name('PHPSystem123');

session\_start();**

※順番に注意して下さい。必ずsession\_start();の上に追加下さい。

以上、これだけです。

もしすでに「session\_name()」がある場合はすでに対策済のバージョンですので変更不要です。

尚、当サイトの管理画面があるプログラムを複数設置している場合で一度のログイン認証で相互に行き来出来たほうが良い場合はsession\_nameの文字列を同じものとして下さい。

-- 謝辞

ご報告いただきました「三井物産セキュアディレクション株式会社　東内様」、

並びに情報処理推進機構 IPA様、JPCERT/CC 脆弱性ハンドリングチーム様にはこの場を借りて感謝申し上げます。

2016.02.06 v1.0.1　定期アップデート実施　データファイルの区切り文字をタブに変更。項目ごとにリンク設定可能に。

2015.10.05 v1.0.0　配布開始

## PHPメールフォーム（無料版）

* [【MailForm01】メールフォーム　フリー](../mail/01.php)
* [【MultiLangForm01】多言語対応版](../mail/multi01.php) ![](../common/img/icon/new.gif)

## PHPメールフォーム（有料版）

* [【MailForm02】アドレス2重チェック付き](../mail/02.php)
* [【MailForm03】CSV保存付き](../mail/03.php)
* [【MailForm04】禁止ワード、禁止IP](../mail/04.php)
* [【MailForm05】ファイル添付機能](../mail/06.php)
* [【MailForm07】送信先振り分け機能付き](../mail/07.php)
* [**【MailFormFull】全機能搭載版（購入はこちら）**](../mail/05.php)
* [フォームのカスタマイズ](../mailform_order.php)
* [フォーム作成依頼](../contact.php#form_sakusei)

## 新着情報・更新履歴CMS（無料版）

* [【PKOBO-News01】](../news/pkobo-news01.php) ![](../common/img/icon/new.gif)

## 投票・アンケートシステム（無料版）

* [【PKOBO-vote01】投票・アンケート](../vote/01.php) ![](../common/img/icon/new.gif)

## テロップCMS（無料版）

* [【Telop01】テロップ・ニュースティッカー](../telop/01.php)

## 写真ギャラリーCMS（無料版）

* [【Gallery01】写真ギャラリー](../gallery/01.php)

## 営業日カレンダーCMS（無料版）

* [【Calendar01】シンプル版](../calendar/01.php)
* [【Calendar02】テキスト入力付き](../calendar/02.php)

## 営業日カレンダーCMS（有料版）

* [【Calendar03】プルダウン・テキスト入力付き](../calendar/03.php)

## カレンダー予約フォーム（無料版）

* [【CalendarForm01】カレンダー予約フォーム](../calendar_form/01.php)

## カレンダー予約フォーム（有料版）

* [【CalendarForm02】カレンダー予約フォーム

  　　CSV保存機能付き](../calendar_form/02.php) ![](../common/img/icon/new.gif)

## リンク集ページCMS（無料版）

* [【Link01】リンク集ページCMS](../link/01.php)

## アクセスカウンター（無料版）

* [テキスト版、画像版](../counter/01.php)

## ダウンロードカウンター（無料版）

* [ダウンロードカウンター01](../download_count/01.php)

## その他

* [【PKOBO-CS-API】API連携中古車情報システム](../product/cs-api.php)

[![メールフォームの各種カスタマイズならお任せ下さい](../common/img/side_ban02.png)](https://www.php-factory.net/mailform_order.php)
[![業務効率化が可能なPHPオリジナルCMS制作します](../common/img/side_ban01.png)](https://www.php-factory.net/cms_order.php)
## 役立つかも？なもの

* [指定URLページのファイルサイズ計測](../trivia/13.php)
* [パチスロ当たりシミュレーター](../trivia/08.php)

## 豆知識や役立ち事など

* [PHPが使えるレンタルサーバー比較](../server.php)
* [htaccessでBasic認証](../trivia/01.php)
* [Yahooジオプラスへの導入について（重要）](../trivia/02.php)
* [Yahooジオプラスでログイン不具合について](../trivia/07.php)
* [UTF-8使用時の注意点（BOMあり、なし）](../trivia/03.php)
* [JSでコピー＆ペースト禁止処理](../trivia/04.php)
* [サーバーのphp.iniによるアップロードファイルの最大容量の確認と容量制限の変更](../trivia/05.php)
* [迷惑メール、スパムメール対策](../trivia/09.php)
* [フォームの基礎知識](../trivia/17.php)
* [送信ボタン連打による多重送信防止](../trivia/18.php)
* [迷惑メール扱いされる場合の対策](../trivia/21.php)

## PHPについて

* [PHP基礎の基礎](../aboutphp/01.php)
* [PHPマニュアル（外部サイト）](http://php.net/manual/ja/index.php)
* [XAMPP（外部サイト）](http://www.apachefriends.org/jp/xampp-windows.html)

## 各種情報

* [よくある質問](../faq.php)
* [有料サポート](https://www.php-factory.net/support.php)
* [カスタマイズ・設置代行・お問い合わせ](https://www.php-factory.net/contact.php)
* [事業概要](../company.php)
* [ご利用規約](../convention.php)
* [運営者プロフィール](../profile.php)
* [プライバシーポリシー](../privacy.php)
* [特定商取引法に基づく表示](../policy.php)
* [リンクについて](../about_link.php)
* [Ken'sWEB](http://www.kens-web.com/)（外部ブログ）

![](../common/img/contents_bottom.png)

[PAGE TOP](#outline)

｜[HOME](../)｜[事業概要](../company.php)｜[ご利用規約](../convention.php)｜[運営者プロフィール](../profile.php)｜[カスタマイズ・設置代行・お問い合わせ](https://www.php-factory.net/contact.php)｜[有料サポート](https://www.php-factory.net/support.php)｜[プライバシーポリシー](../privacy.php)｜

Copyright [PHP工房](../). All Rights Reserved


