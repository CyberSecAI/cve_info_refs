```
{
  "vulnerability": {
    "root_cause": "The vulnerability occurs in the `decode_pointer_field` function when handling repeated `string`, `bytes` or `message` fields. When `realloc()` fails to allocate more memory to expand the array, the code attempts to free a pointer that was not properly initialized, leading to a double-free or use-after-free condition.",
    "weaknesses": [
      "Use of uninitialized memory",
      "Invalid free"
    ],
    "impact": "A crash or memory corruption, which may be exploitable, can occur due to the invalid free.",
    "attack_vectors": "The vulnerability is triggered by providing a specially crafted protobuf message that contains a large number of repeated fields which can cause a memory allocation failure.",
    "required_capabilities": "An attacker needs the ability to send arbitrary protobuf messages to an application using a vulnerable version of nanopb, compiled with `PB_ENABLE_MALLOC`."
  },
  "affected_versions": [
    "<0.4.1",
  ],
  "patched_versions": [
    "0.4.1",
    "0.3.9.5",
    "0.2.9.4"
  ],
    "references": [
        "https://github.com/nanopb/nanopb/security/advisories/GHSA-gcx3-7m76-287p",
        "https://github.com/nanopb/nanopb/commit/45582f1f97f49e2abfdba1463d1e1027682d9856",
        "https://github.com/nanopb/nanopb/commit/aa9d0d1ca78d6adec3adfeecf3a706c7f9df81f2",
        "https://github.com/nanopb/nanopb/commit/7b396821ddd06df8e39143f16e1dc0a4645b89a3"
    ]
}
```