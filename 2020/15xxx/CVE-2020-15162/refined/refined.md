Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2020-15162

**Root Cause:**
The vulnerability stems from the ability of users to upload files containing malicious JavaScript code. These files, when accessed, execute the embedded JavaScript, leading to a stored Cross-Site Scripting (XSS) vulnerability.

**Weaknesses/Vulnerabilities:**
- **Stored XSS:** The primary vulnerability is a stored XSS, where the malicious script is embedded within a file and persisted on the server. This allows the attacker to potentially target other users accessing the same file.
- **Lack of proper file handling:** The application failed to properly handle uploaded files, specifically, it did not set the `Content-Disposition` header to `Attachment` or use the `X-Content-Type-Options` header to prevent browsers from trying to interpret the file content. This causes browsers to execute the injected scripts when accessing certain types of files (e.g. PDF).

**Impact of Exploitation:**
- **XSS Payload Execution:** Successful exploitation allows the attacker to execute arbitrary JavaScript code within the context of a user's browser.
- **Malicious Actions:** This could be used for various malicious actions such as:
    - Session hijacking
    - Defacement of the website
    - Data theft
    - Redirection to malicious websites

**Attack Vectors:**
- **File Upload:** The primary attack vector is through the file upload functionality of the PrestaShop application.
- **Malicious File:** An attacker uploads a file (e.g., a PDF) that contains embedded malicious JavaScript.
- **User Access:** When other users access the compromised file, their browsers execute the malicious script, triggering the XSS vulnerability.

**Required Attacker Capabilities/Position:**
- **User Access:** The attacker needs to have the ability to upload files within the PrestaShop application.
- **Malicious Script Creation:** The attacker needs to be able to create files with embedded malicious JavaScript payloads.

**Additional Details:**
- The vulnerability was found in PrestaShop versions prior to 1.7.6.8.
- The fix involves adding `Content-Disposition: Attachment` and `X-Content-Type-Options: nosniff` headers in the `.htaccess` files to prevent browsers from interpreting files, and triggering the XSS.
- The provided content includes mitigation steps for both Apache and Nginx webservers.