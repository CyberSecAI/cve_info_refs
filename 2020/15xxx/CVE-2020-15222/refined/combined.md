=== Content from docs.github.com_d782ce82_20250119_131729.html ===
[Skip to main content](#main-content)[GitHub Docs](/en)Version: Free, Pro, & TeamSearch GitHub DocsSearchSelect language: current language is EnglishOpen Search BarClose Search BarOpen MenuOpen Sidebar

* [Site policy](/en/site-policy "Site policy")/
* [GitHub Terms](/en/site-policy/github-terms "GitHub Terms")/
* [GitHub Terms of Service](/en/site-policy/github-terms/github-terms-of-service "GitHub Terms of Service")
[Home](/en)[Site policy](/en/site-policy)

* GitHub Terms
  + [GitHub Terms of Service](/en/site-policy/github-terms/github-terms-of-service)
  + [GitHub Corporate Terms of Service](/en/site-policy/github-terms/github-corporate-terms-of-service)
  + [GitHub Terms for Additional Products and Features](/en/site-policy/github-terms/github-terms-for-additional-products-and-features)
  + [GitHub Community Guidelines](/en/site-policy/github-terms/github-community-guidelines)
  + [GitHub Community Code of Conduct](/en/site-policy/github-terms/github-community-code-of-conduct)
  + [GitHub Pre-release License Terms](/en/site-policy/github-terms/github-pre-release-license-terms)
  + [GitHub Sponsors Additional Terms](/en/site-policy/github-terms/github-sponsors-additional-terms)
  + [GitHub Registered Developer Agreement](/en/site-policy/github-terms/github-registered-developer-agreement)
  + [GitHub Marketplace Terms of Service](/en/site-policy/github-terms/github-marketplace-terms-of-service)
  + [GitHub Marketplace Developer Agreement](/en/site-policy/github-terms/github-marketplace-developer-agreement)
  + [GitHub Research Program Terms](/en/site-policy/github-terms/github-research-program-terms)
  + [GitHub Open Source Applications Terms and Conditions](/en/site-policy/github-terms/github-open-source-applications-terms-and-conditions)
  + [GitHub Event Terms](/en/site-policy/github-terms/github-event-terms)
  + [GitHub Event Code of Conduct](/en/site-policy/github-terms/github-event-code-of-conduct)
  + [GitHub Educational Use Agreement](/en/site-policy/github-terms/github-educational-use-agreement)
  + [GitHub Copilot Extension Developer Policy](/en/site-policy/github-terms/github-copilot-extension-developer-policy)
* Acceptable Use Policies
  + [GitHub Acceptable Use Policies](/en/site-policy/acceptable-use-policies/github-acceptable-use-policies)
  + [Active Malware or Exploits](/en/site-policy/acceptable-use-policies/github-active-malware-or-exploits)
  + [Bullying and Harassment](/en/site-policy/acceptable-use-policies/github-bullying-and-harassment)
  + [Disrupting the Experience of Other Users](/en/site-policy/acceptable-use-policies/github-disrupting-the-experience-of-other-users)
  + [Doxxing and Invasion of Privacy](/en/site-policy/acceptable-use-policies/github-doxxing-and-invasion-of-privacy)
  + [Hate Speech and Discrimination](/en/site-policy/acceptable-use-policies/github-hate-speech-and-discrimination)
  + [Impersonation](/en/site-policy/acceptable-use-policies/github-impersonation)
  + [Misinformation and Disinformation](/en/site-policy/acceptable-use-policies/github-misinformation-and-disinformation)
  + [Sexually Obscene Content](/en/site-policy/acceptable-use-policies/github-sexually-obscene-content)
  + [Threats of Violence and Gratuitously Violent Content](/en/site-policy/acceptable-use-policies/github-threats-of-violence-and-gratuitously-violent-content)
  + [GitHub Appeal and Reinstatement](/en/site-policy/acceptable-use-policies/github-appeal-and-reinstatement)
* Privacy Policies
  + [GitHub General Privacy Statement](/en/site-policy/privacy-policies/github-general-privacy-statement)
  + [GitHub Subprocessors](/en/site-policy/privacy-policies/github-subprocessors)
  + [GitHub Cookies](/en/site-policy/privacy-policies/github-cookies)
  + [GitHub Codespaces Privacy Statement](/en/site-policy/privacy-policies/github-codespaces-privacy-statement)
  + [GitHub Candidate Privacy Policy](/en/site-policy/privacy-policies/github-candidate-privacy-policy)
* Other Site Policies
  + [GitHub and Trade Controls](/en/site-policy/other-site-policies/github-and-trade-controls)
  + [GitHub Deceased User Policy](/en/site-policy/other-site-policies/github-deceased-user-policy)
  + [GitHub Logo Policy](/en/site-policy/other-site-policies/github-logo-policy)
  + [GitHub Government Takedown Policy](/en/site-policy/other-site-policies/github-government-takedown-policy)
  + [GitHub Username Policy](/en/site-policy/other-site-policies/github-username-policy)
  + [Guidelines for Legal Requests of User Data](/en/site-policy/other-site-policies/guidelines-for-legal-requests-of-user-data)
  + [GitHub Account Recovery Policy](/en/site-policy/other-site-policies/github-account-recovery-policy)
* Content Removal Policies
  + [Submitting content removal requests](/en/site-policy/content-removal-policies/submitting-content-removal-requests)
  + [DMCA Takedown Policy](/en/site-policy/content-removal-policies/dmca-takedown-policy)
  + [GitHub Private Information Removal Policy](/en/site-policy/content-removal-policies/github-private-information-removal-policy)
  + [GitHub Trademark Policy](/en/site-policy/content-removal-policies/github-trademark-policy)
  + [Guide to Submitting a DMCA Counter Notice](/en/site-policy/content-removal-policies/guide-to-submitting-a-dmca-counter-notice)
  + [Guide to Submitting a DMCA Takedown Notice](/en/site-policy/content-removal-policies/guide-to-submitting-a-dmca-takedown-notice)
* Security Policies
  + [Coordinated Disclosure of Security Vulnerabilities](/en/site-policy/security-policies/coordinated-disclosure-of-security-vulnerabilities)
  + [GitHub Bug Bounty Program Legal Safe Harbor](/en/site-policy/security-policies/github-bug-bounty-program-legal-safe-harbor)
  + [GitHub SIRT description RFC 2350](/en/site-policy/security-policies/github-sirt-description-rfc-2350)
* GitHub Company Policies
  + [GitHub Statement Against Modern Slavery and Child Labor](/en/site-policy/github-company-policies/github-statement-against-modern-slavery-and-child-labor)
  + [GitHub Anti-Bribery Statement](/en/site-policy/github-company-policies/github-anti-bribery-statement)
  + [GitHub GPL Cooperation Commitment](/en/site-policy/github-company-policies/github-gpl-cooperation-commitment)
  + [GitHub Gifts and Entertainment Policy](/en/site-policy/github-company-policies/github-gifts-and-entertainment-policy)

* [Site policy](/en/site-policy "Site policy")/
* [GitHub Terms](/en/site-policy/github-terms "GitHub Terms")/
* [GitHub Terms of Service](/en/site-policy/github-terms/github-terms-of-service "GitHub Terms of Service")
# GitHub Terms of Service

## In this article

* [Summary](#summary)
* [The GitHub Terms of Service](#the-github-terms-of-service)
* [A. Definitions](#a-definitions)
* [B. Account Terms](#b-account-terms)
* [C. Acceptable Use](#c-acceptable-use)
* [D. User-Generated Content](#d-user-generated-content)
* [E. Private Repositories](#e-private-repositories)
* [F. Copyright Infringement and DMCA Policy](#f-copyright-infringement-and-dmca-policy)
* [G. Intellectual Property Notice](#g-intellectual-property-notice)
* [H. API Terms](#h-api-terms)
* [I. GitHub Additional Product Terms](#i-github-additional-product-terms)
* [J. Beta Previews](#j-beta-previews)
* [K. Payment](#k-payment)
* [L. Cancellation and Termination](#l-cancellation-and-termination)
* [M. Communications with GitHub](#m-communications-with-github)
* [N. Disclaimer of Warranties](#n-disclaimer-of-warranties)
* [O. Limitation of Liability](#o-limitation-of-liability)
* [P. Release and Indemnification](#p-release-and-indemnification)
* [Q. Changes to These Terms](#q-changes-to-these-terms)
* [R. Miscellaneous](#r-miscellaneous)

Thank you for using GitHub! We're happy you're here. Please read this Terms of Service agreement carefully before accessing or using GitHub. Because it is such an important contract between us and our users, we have tried to make it as clear as possible. For your convenience, we have presented these terms in a short non-binding summary followed by the full legal terms.

## [Summary](#summary)

| Section | What can you find there? |
| --- | --- |
| [A. Definitions](#a-definitions) | Some basic terms, defined in a way that will help you understand this agreement. Refer back up to this section for clarification. |
| [B. Account Terms](#b-account-terms) | These are the basic requirements of having an Account on GitHub. |
| [C. Acceptable Use](#c-acceptable-use) | These are the basic rules you must follow when using your GitHub Account. |
| [D. User-Generated Content](#d-user-generated-content) | You own the content you post on GitHub. However, you have some responsibilities regarding it, and we ask you to grant us some rights so we can provide services to you. |
| [E. Private Repositories](#e-private-repositories) | This section talks about how GitHub will treat content you post in private repositories. |
| [F. Copyright & DMCA Policy](#f-copyright-infringement-and-dmca-policy) | This section talks about how GitHub will respond if you believe someone is infringing your copyrights on GitHub. |
| [G. Intellectual Property Notice](#g-intellectual-property-notice) | This describes GitHub's rights in the website and service. |
| [H. API Terms](#h-api-terms) | These are the rules for using GitHub's APIs, whether you are using the API for development or data collection. |
| [I. Additional Product Terms](#i-github-additional-product-terms) | We have a few specific rules for GitHub's features and products. |
| [J. Beta Previews](#j-beta-previews) | These are some of the additional terms that apply to GitHub's features that are still in development. |
| [K. Payment](#k-payment) | You are responsible for payment. We are responsible for billing you accurately. |
| [L. Cancellation and Termination](#l-cancellation-and-termination) | You may cancel this agreement and close your Account at any time. |
| [M. Communications with GitHub](#m-communications-with-github) | We only use email and other electronic means to stay in touch with our users. We do not provide phone support. |
| [N. Disclaimer of Warranties](#n-disclaimer-of-warranties) | We provide our service as is, and we make no promises or guarantees about this service. **Please read this section carefully; you should understand what to expect.** |
| [O. Limitation of Liability](#o-limitation-of-liability) | We will not be liable for damages or losses arising from your use or inability to use the service or otherwise arising under this agreement. **Please read this section carefully; it limits our obligations to you.** |
| [P. Release and Indemnification](#p-release-and-indemnification) | You are fully responsible for your use of the service. |
| [Q. Changes to these Terms of Service](#q-changes-to-these-terms) | We may modify this agreement, but we will give you 30 days' notice of material changes. |
| [R. Miscellaneous](#r-miscellaneous) | Please see this section for legal details including our choice of law. |

## [The GitHub Terms of Service](#the-github-terms-of-service)

Effective date: November 16, 2020

## [A. Definitions](#a-definitions)

**Short version:** *We use these basic terms throughout the agreement, and they have specific meanings. You should know what we mean when we use each of the terms. There's not going to be a test on it, but it's still useful information.*

1. An "Account" represents your legal relationship with GitHub. A “Personal Account” represents an individual User’s authorization to log in to and use the Service and serves as a User’s identity on GitHub. “Organizations” are shared workspaces that may be associated with a single entity or with one or more Users where multiple Users can collaborate across many projects at once. A Personal Account can be a member of any number of Organizations.
2. The “Agreement” refers, collectively, to all the terms, conditions, notices contained or referenced in this document (the “Terms of Service” or the "Terms") and all other operating rules, policies (including the GitHub Privacy Statement, available at [github.com/site/privacy](https://github.com/site/privacy)) and procedures that we may publish from time to time on the Website. Most of our site policies are available at [docs.github.com/categories/site-policy](/en/site-policy).
3. "Beta Previews" mean software, services, or features identified as alpha, beta, preview, early access, or evaluation, or words or phrases with similar meanings.
4. “Content” refers to content featured or displayed through the Website, including without limitation code, text, data, articles, images, photographs, graphics, software, applications, packages, designs, features, and other materials that are available on the Website or otherwise available through the Service. "Content" also includes Services. “User-Generated Content” is Content, written or otherwise, created or uploaded by our Users. "Your Content" is Content that you create or own.
5. “GitHub,” “We,” and “Us” refer to GitHub, Inc., as well as our affiliates, directors, subsidiaries, contractors, licensors, officers, agents, and employees.
6. The “Service” refers to the applications, software, products, and services provided by GitHub, including any Beta Previews.
7. “The User,” “You,” and “Your” refer to the individual person, company, or organization that has visited or is using the Website or Service; that accesses or uses any part of the Account; or that directs the use of the Account in the performance of its functions. A User must be at least 13 years of age. Special terms may apply for business or government Accounts (See [Section B(5): Additional Terms](#5-additional-terms)).
8. The “Website” refers to GitHub’s website located at [github.com](https://github.com/), and all content, services, and products provided by GitHub at or through the Website. It also refers to GitHub-owned subdomains of github.com, such as [education.github.com](https://education.github.com/) and [pages.github.com](https://pages.github.com/). These Terms also govern GitHub’s conference websites, such as [githubuniverse.com](https://githubuniverse.com/), and product websites, such as [electronjs.org](https://www.electronjs.org/). Occasionally, websites owned by GitHub may provide different or additional terms of service. If those additional terms conflict with this Agreement, the more specific terms apply to the relevant page or service.

## [B. Account Terms](#b-account-terms)

**Short version:** *Personal Accounts and Organizations have different administrative controls; a human must create your Account; you must be 13 or over; you must provide a valid email address; and you may not have more than one free Account. You alone are responsible for your Account and anything that happens while you are signed in to or using your Account. You are responsible for keeping your Account secure.*

### [1. Account Controls](#1-account-controls)

* Users. Subject to these Terms, you retain ultimate administrative control over your Personal Account and the Content within it.
* Organizations. The "owner" of an Organization that was created under these Terms has ultimate administrative control over that Organization and the Content within it. Within the Service, an owner can manage User access to the Organization’s data and projects. An Organization may have multiple owners, but there must be at least one Personal Account designated as an owner of an Organization. If you are the owner of an Organization under these Terms, we consider you responsible for the actions that are performed on or through that Organization.

### [2. Required Information](#2-required-information)

You must provide a valid email address in order to complete the signup process. Any other information requested, such as your real name, is optional, unless you are accepting these terms on behalf of a legal entity (in which case we need more information about the legal entity) or if you opt for a [paid Account](#k-payment), in which case additional information will be necessary for billing purposes.

### [3. Account Requirements](#3-account-requirements)

We have a few simple rules for Personal Accounts on GitHub's Service.

* You must be a human to create an Account. Accounts registered by "bots" or other automated methods are not permitted. We do permit machine accounts:
* A machine account is an Account set up by an individual human who accepts the Terms on behalf of the Account, provides a valid email address, and is responsible for its actions. A machine account is used exclusively for performing automated tasks. Multiple users may direct the actions of a machine account, but the owner of the Account is ultimately responsible for the machine's actions. You may maintain no more than one free machine account in addition to your free Personal Account.
* One person or legal entity may maintain no more than one free Account (if you choose to control a machine account as well, that's fine, but it can only be used for running a machine).
* You must be age 13 or older. While we are thrilled to see brilliant young coders get excited by learning to program, we must comply with United States law. GitHub does not target our Service to children under 13, and we do not permit any Users under 13 on our Service. If we learn of any User under the age of 13, we will [terminate that User’s Account immediately](#l-cancellation-and-termination). If you are a resident of a country outside the United States, your country’s minimum age may be older; in such a case, you are responsible for complying with your country’s laws.
* Your login may only be used by one person — i.e., a single login may not be shared by multiple people. A paid Organization may only provide access to as many Personal Accounts as your subscription allows.
* You may not use GitHub in violation of export control or sanctions laws of the United States or any other applicable jurisdiction. You may not use GitHub if you are or are working on behalf of a [Specially Designated National (SDN)](https://www.treasury.gov/resource-center/sanctions/SDN-List/Pages/default.aspx) or a person subject to similar blocking or denied party prohibitions administered by a U.S. government agency. GitHub may allow persons in certain sanctioned countries or territories to access certain GitHub services pursuant to U.S. government authorizations. For more information, please see our [Export Controls policy](/en/site-policy/other-site-policies/github-and-trade-controls).

### [4. Account Security](#4-account-security)

You are responsible for keeping your Account secure while you use our Service. We offer tools such as two-factor authentication to help you maintain your Account's security, but the content of your Account and its security are up to you.

* You are responsible for all content posted and activity that occurs under your Account (even when content is posted by others who have Accounts under your Account).
* You are responsible for maintaining the security of your Account and password. GitHub cannot and will not be liable for any loss or damage from your failure to comply with this security obligation.
* You will promptly notify GitHub by contacting us through the [GitHub Support portal](https://support.github.com/) if you become aware of any unauthorized use of, or access to, our Service through your Account, including any unauthorized use of your password or Account.

### [5. Additional Terms](#5-additional-terms)

In some situations, third parties' terms may apply to your use of GitHub. For example, you may be a member of an organization on GitHub with its own terms or license agreements; you may download an application that integrates with GitHub; or you may use GitHub to authenticate to another service. Please be aware that while these Terms are our full agreement with you, other parties' terms govern their relationships with you.

If you are a government User or otherwise accessing or using any GitHub Service in a government capacity, this [Government Amendment to GitHub Terms of Service](/en/site-policy/site-policy-deprecated/amendment-to-github-terms-of-service-applicable-to-us-federal-government-users) applies to you, and you agree to its provisions.

If you have signed up for GitHub Enterprise Cloud, the [Enterprise Cloud Addendum](/en/site-policy/site-policy-deprecated/github-enterprise-service-level-agreement) applies to you, and you agree to its provisions.

## [C. Acceptable Use](#c-acceptable-use)

**Short version:** *GitHub hosts a wide variety of collaborative projects from all over the world, and that collaboration only works when our users are able to work together in good faith. While using the service, you must follow the terms of this section, which include some restrictions on content you can post, conduct on the service, and other limitations. In short, be excellent to each other.*

Your use of the Website and Service must not violate any applicable laws, including copyright or trademark laws, export control or sanctions laws, or other laws in your jurisdiction. You are responsible for making sure that your use of the Service is in compliance with laws and any applicable regulations.

You agree that you will not under any circumstances violate our [Acceptable Use Policies](/en/site-policy/acceptable-use-policies/github-acceptable-use-policies) or [Community Guidelines](/en/site-policy/github-terms/github-community-guidelines).

## [D. User-Generated Content](#d-user-generated-content)

**Short version:** *You own content you create, but you allow us certain rights to it, so that we can display and share the content you post. You still have control over your content, and responsibility for it, and the rights you grant us are limited to those we need to provide the service. We have the right to remove content or close Accounts if we need to.*

### [1. Responsibility for User-Generated Content](#1-responsibility-for-user-generated-content)

You may create or upload User-Generated Content while using the Service. You are solely responsible for the content of, and for any harm resulting from, any User-Generated Content that you post, upload, link to or otherwise make available via the Service, regardless of the form of that Content. We are not responsible for any public display or misuse of your User-Generated Content.

### [2. GitHub May Remove Content](#2-github-may-remove-content)

We have the right to refuse or remove any User-Generated Content that, in our sole discretion, violates any laws or [GitHub terms or policies](/en/site-policy). User-Generated Content displayed on GitHub Mobile may be subject to mobile app stores' additional terms.

### [3. Ownership of Content, Right to Post, and License Grants](#3-ownership-of-content-right-to-post-and-license-grants)

You retain ownership of and responsibility for Your Content. If you're posting anything you did not create yourself or do not own the rights to, you agree that you are responsible for any Content you post; that you will only submit Content that you have the right to post; and that you will fully comply with any third party licenses relating to Content you post.

Because you retain ownership of and responsibility for Your Content, we need you to grant us — and other GitHub Users — certain legal permissions, listed in Sections D.4 — D.7. These license grants apply to Your Content. If you upload Content that already comes with a license granting GitHub the permissions we need to run our Service, no additional license is required. You understand that you will not receive any payment for any of the rights granted in Sections D.4 — D.7. The licenses you grant to us will end when you remove Your Content from our servers, unless other Users have forked it.

### [4. License Grant to Us](#4-license-grant-to-us)

We need the legal right to do things like host Your Content, publish it, and share it. You grant us and our legal successors the right to store, archive, parse, and display Your Content, and make incidental copies, as necessary to provide the Service, including improving the Service over time. This license includes the right to do things like copy it to our database and make backups; show it to you and other users; parse it into a search index or otherwise analyze it on our servers; share it with other users; and perform it, in case Your Content is something like music or video.

This license does not grant GitHub the right to sell Your Content. It also does not grant GitHub the right to otherwise distribute or use Your Content outside of our provision of the Service, except that as part of the right to archive Your Content, GitHub may permit our partners to store and archive Your Content in public repositories in connection with the [GitHub Arctic Code Vault and GitHub Archive Program](https://archiveprogram.github.com/).

### [5. License Grant to Other Users](#5-license-grant-to-other-users)

Any User-Generated Content you post publicly, including issues, comments, and contributions to other Users' repositories, may be viewed by others. By setting your repositories to be viewed publicly, you agree to allow others to view and "fork" your repositories (this means that others may make their own copies of Content from your repositories in repositories they control).

If you set your pages and repositories to be viewed publicly, you grant each User of GitHub a nonexclusive, worldwide license to use, display, and perform Your Content through the GitHub Service and to reproduce Your Content solely on GitHub as permitted through GitHub's functionality (for example, through forking). You may grant further rights if you [adopt a license](/en/communities/setting-up-your-project-for-healthy-contributions/adding-a-license-to-a-repository#including-an-open-source-license-in-your-repository). If you are uploading Content you did not create or own, you are responsible for ensuring that the Content you upload is licensed under terms that grant these permissions to other GitHub Users.

### [6. Contributions Under Repository License](#6-contributions-under-repository-license)

Whenever you add Content to a repository containing notice of a license, you license that Content under the same terms, and you agree that you have the right to license that Content under those terms. If you have a separate agreement to license that Content under different terms, such as a contributor license agreement, that agreement will supersede.

Isn't this just how it works already? Yep. This is widely accepted as the norm in the open-source community; it's commonly referred to by the shorthand "inbound=outbound". We're just making it explicit.

### [7. Moral Rights](#7-moral-rights)

You retain all moral rights to Your Content that you upload, publish, or submit to any part of the Service, including the rights of integrity and attribution. However, you waive these rights and agree not to assert them against us, to enable us to reasonably exercise the rights granted in Section D.4, but not otherwise.

To the extent this agreement is not enforceable by applicable law, you grant GitHub the rights we need to use Your Content without attribution and to make reasonable adaptations of Your Content as necessary to render the Website and provide the Service.

## [E. Private Repositories](#e-private-repositories)

**Short version:** *We treat the content of private repositories as confidential, and we only access it as described in our Privacy Statement—for security purposes, to assist the repository owner with a support matter, to maintain the integrity of the Service, to comply with our legal obligations, if we have reason to believe the contents are in violation of the law, or with your consent.*

### [1. Control of Private Repositories](#1-control-of-private-repositories)

Some Accounts may have private repositories, which allow the User to control access to Content.

### [2. Confidentiality of Private Repositories](#2-confidentiality-of-private-repositories)

GitHub considers the contents of private repositories to be confidential to you. GitHub will protect the contents of private repositories from unauthorized use, access, or disclosure in the same manner that we would use to protect our own confidential information of a similar nature and in no event with less than a reasonable degree of care.

### [3. Access](#3-access)

GitHub personnel may only access the content of your private repositories in the situations described in our [Privacy Statement](/en/site-policy/privacy-policies/github-privacy-statement#repository-contents).

You may choose to enable additional access to your private repositories. For example:

* You may enable various GitHub services or features that require additional rights to Your Content in private repositories. These rights may vary depending on the service or feature, but GitHub will continue to treat your private repository Content as confidential. If those services or features require rights in addition to those we need to provide the GitHub Service, we will provide an explanation of those rights.

Additionally, we may be [compelled by law](/en/site-policy/privacy-policies/github-privacy-statement#for-legal-disclosure) to disclose the contents of your private repositories.

GitHub will provide notice regarding our access to private repository content, unless [for legal disclosure](/en/site-policy/privacy-policies/github-privacy-statement#for-legal-disclosure), to comply with our legal obligations, or where otherwise bound by requirements under law, for automated scanning, or if in response to a security threat or other risk to security.

## [F. Copyright Infringement and DMCA Policy](#f-copyright-infringement-and-dmca-policy)

If you believe that content on our website violates your copyright, please contact us in accordance with our [Digital Millennium Copyright Act Policy](/en/site-policy/content-removal-policies/dmca-takedown-policy). If you are a copyright owner and you believe that content on GitHub violates your rights, please contact us via [our convenient DMCA form](https://github.com/contact/dmca) or by emailing copyright@github.com. There may be legal consequences for sending a false or frivolous takedown notice. Before sending a takedown request, you must consider legal uses such as fair use and licensed uses.

We will terminate the Accounts of [repeat infringers](/en/site-policy/content-removal-policies/dmca-takedown-policy#e-repeated-infringement) of this policy.

## [G. Intellectual Property Notice](#g-intellectual-property-notice)

**Short version:** *We own the service and all of our content. In order for you to use our content, we give you certain rights to it, but you may only use our content in the way we have allowed.*

### [1. GitHub's Rights to Content](#1-githubs-rights-to-content)

GitHub and our licensors, vendors, agents, and/or our content providers retain ownership of all intellectual property rights of any kind related to the Website and Service. We reserve all rights that are not expressly granted to you under this Agreement or by law. The look and feel of the Website and Service is copyright © GitHub, Inc. All rights reserved. You may not duplicate, copy, or reuse any portion of the HTML/CSS, JavaScript, or visual design elements or concepts without express written permission from GitHub.

### [2. GitHub Trademarks and Logos](#2-github-trademarks-and-logos)

If you’d like to use GitHub’s trademarks, you must follow all of our trademark guidelines, including those on our logos page: <https://github.com/logos>.

### [3. License to GitHub Policies](#3-license-to-github-policies)

This Agreement is licensed under this [Creative Commons Zero license](https://creativecommons.org/publicdomain/zero/1.0/). For details, see our [site-policy repository](https://github.com/github/site-policy#license).

## [H. API Terms](#h-api-terms)

**Short version:** *You agree to these Terms of Service, plus this Section H, when using any of GitHub's APIs (Application Provider Interface), including use of the API through a third party product that accesses GitHub.*

Abuse or excessively frequent requests to GitHub via the API may result in the temporary or permanent suspension of your Account's access to the API. GitHub, in our sole discretion, will determine abuse or excessive usage of the API. We will make a reasonable attempt to warn you via email prior to suspension.

You may not share API tokens to exceed GitHub's rate limitations.

You may not use the API to download data or Content from GitHub for spamming purposes, including for the purposes of selling GitHub users' personal information, such as to recruiters, headhunters, and job boards.

All use of the GitHub API is subject to these Terms of Service and the [GitHub Privacy Statement](https://github.com/site/privacy).

GitHub may offer subscription-based access to our API for those Users who require high-throughput access or access that would result in resale of GitHub's Service.

## [I. GitHub Additional Product Terms](#i-github-additional-product-terms)

**Short version:** *You need to follow certain specific terms and conditions for GitHub's various features and products, and you agree to the Supplemental Terms and Conditions when you agree to this Agreement.*

Some Service features may be subject to additional terms specific to that feature or product as set forth in the GitHub Additional Product Terms. By accessing or using the Services, you also agree to the [GitHub Additional Product Terms](/en/site-policy/github-terms/github-terms-for-additional-products-and-features).

## [J. Beta Previews](#j-beta-previews)

**Short version:** *Beta Previews may not be supported or may change at any time. You may receive confidential information through those programs that must remain confidential while the program is private. We'd love your feedback to make our Beta Previews better.*

### [1. Subject to Change](#1-subject-to-change)

Beta Previews may not be supported and may be changed at any time without notice. In addition, Beta Previews are not subject to the same security measures and auditing to which the Service has been and is subject. **By using a Beta Preview, you use it at your own risk.**

### [2. Confidentiality](#2-confidentiality)

As a user of Beta Previews, you may get access to special information that isn’t available to the rest of the world. Due to the sensitive nature of this information, it’s important for us to make sure that you keep that information secret.

**Confidentiality Obligations.** You agree that any non-public Beta Preview information we give you, such as information about a private Beta Preview, will be considered GitHub’s confidential information (collectively, “Confidential Information”), regardless of whether it is marked or identified as such. You agree to only use such Confidential Information for the express purpose of testing and evaluating the Beta Preview (the “Purpose”), and not for any other purpose. You should use the same degree of care as you would with your own confidential information, but no less than reasonable precautions to prevent any unauthorized use, disclosure, publication, or dissemination of our Confidential Information. You promise not to disclose, publish, or disseminate any Confidential Information to any third party, unless we don’t otherwise prohibit or restrict such disclosure (for example, you might be part of a GitHub-organized group discussion about a private Beta Preview feature).

**Exceptions.** Confidential Information will not include information that is: (a) or becomes publicly available without breach of this Agreement through no act or inaction on your part (such as when a private Beta Preview becomes a public Beta Preview); (b) known to you before we disclose it to you; (c) independently developed by you without breach of any confidentiality obligation to us or any third party; or (d) disclosed with permission from GitHub. You will not violate the terms of this Agreement if you are required to disclose Confidential Information pursuant to operation of law, provided GitHub has been given reasonable advance written notice to object, unless prohibited by law.

### [3. Feedback](#3-feedback)

We’re always trying to improve of products and services, and your feedback as a Beta Preview user will help us do that. If you choose to give us any ideas, know-how, algorithms, code contributions, suggestions, enhancement requests, recommendations or any other feedback for our products or services (collectively, “Feedback”), you acknowledge and agree that GitHub will have a royalty-free, fully paid-up, worldwide, transferable, sub-licensable, irrevocable and perpetual license to implement, use, modify, commercially exploit and/or incorporate the Feedback into our products, services, and documentation.

## [K. Payment](#k-payment)

**Short version:** *You are responsible for any fees associated with your use of GitHub. We are responsible for communicating those fees to you clearly and accurately, and letting you know well in advance if those prices change.*

### [1. Pricing](#1-pricing)

Our pricing and payment terms are available at [github.com/pricing](https://github.com/pricing). If you agree to a subscription price, that will remain your price for the duration of the payment term; however, prices are subject to change at the end of a payment term.

### [2. Upgrades, Downgrades, and Changes](#2-upgrades-downgrades-and-changes)

* We will immediately bill you when you upgrade from the free plan to any paying plan.
* If you change from a monthly billing plan to a yearly billing plan, GitHub will bill you for a full year at the next monthly billing date.
* If you upgrade to a higher level of service, we will bill you for the upgraded plan immediately.
* You may change your level of service at any time by [choosing a plan option](https://github.com/pricing) or going into your [Billing settings](https://github.com/settings/billing). If you choose to downgrade your Account, you may lose access to Content, features, or capacity of your Account. Please see our section on [Cancellation](#l-cancellation-and-termination) for information on getting a copy of that Content.

### [3. Billing Schedule; No Refunds](#3-billing-schedule-no-refunds)

**Payment Based on Plan** For monthly or yearly payment plans, the Service is billed in advance on a monthly or yearly basis respectively and is non-refundable. There will be no refunds or credits for partial months of service, downgrade refunds, or refunds for months unused with an open Account; however, the service will remain active for the length of the paid billing period. In order to treat everyone equally, no exceptions will be made.

**Payment Based on Usage** Some Service features are billed based on your usage. A limited quantity of these Service features may be included in your plan for a limited term without additional charge. If you choose to use paid Service features beyond the quantity included in your plan, you pay for those Service features based on your actual usage in the preceding month. Monthly payment for these purchases will be charged on a periodic basis in arrears. See [GitHub Additional Product Terms for Details](/en/site-policy/github-terms/github-terms-for-additional-products-and-features).

**Invoicing** For invoiced Users, User agrees to pay the fees in full, up front without deduction or setoff of any kind, in U.S. Dollars. User must pay the fees within thirty (30) days of the GitHub invoice date. Amounts payable under this Agreement are non-refundable, except as otherwise provided in this Agreement. If User fails to pay any fees on time, GitHub reserves the right, in addition to taking any other action at law or equity, to (i) charge interest on past due amounts at 1.0% per month or the highest interest rate allowed by law, whichever is less, and to charge all expenses of recovery, and (ii) terminate the applicable order form. User is solely responsible for all taxes, fees, duties and governmental assessments (except for taxes based on GitHub's net income) that are imposed or become due in connection with this Agreement.

### [4. Authorization](#4-authorization)

By agreeing to these Terms, you are giving us permission to charge your on-file credit card, PayPal account, or other approved methods of payment for fees that you authorize for GitHub.

### [5. Responsibility for Payment](#5-responsibility-for-payment)

You are responsible for all fees, including taxes, associated with your use of the Service. By using the Service, you agree to pay GitHub any charge incurred in connection with your use of the Service. If you dispute the matter, contact us through the [GitHub Support portal](https://support.github.com/). You are responsible for providing us with a valid means of payment for paid Accounts. Free Accounts are not required to provide payment information.

## [L. Cancellation and Termination](#l-cancellation-and-termination)

**Short version:** *You may close your Account at any time. If you do, we'll treat your information responsibly.*

### [1. Account Cancellation](#1-account-cancellation)

It is your responsibility to properly cancel your Account with GitHub. You can [cancel your Account at any time](/en/billing/managing-the-plan-for-your-github-account/downgrading-your-accounts-plan) by going into your Settings in the global navigation bar at the top of the screen. The Account screen provides a simple, no questions asked cancellation link. We are not able to cancel Accounts in response to an email or phone request.

### [2. Upon Cancellation](#2-upon-cancellation)

We will retain and use your information as necessary to comply with our legal obligations, resolve disputes, and enforce our agreements, but barring legal requirements, we will delete your full profile and the Content of your repositories within 90 days of cancellation or termination (though some information may remain in encrypted backups). This information cannot be recovered once your Account is canceled.

We will not delete Content that you have contributed to other Users' repositories or that other Users have forked.

Upon request, we will make a reasonable effort to provide an Account owner with a copy of your lawful, non-infringing Account contents after Account cancellation, termination, or downgrade. You must make this request within 90 days of cancellation, termination, or downgrade.

### [3. GitHub May Terminate](#3-github-may-terminate)

GitHub has the right to suspend or terminate your access to all or any part of the Website at any time, with or without cause, with or without notice, effective immediately. GitHub reserves the right to refuse service to anyone for any reason at any time.

### [4. Survival](#4-survival)

All provisions of this Agreement which, by their nature, should survive termination *will* survive termination — including, without limitation: ownership provisions, warranty disclaimers, indemnity, and limitations of liability.

## [M. Communications with GitHub](#m-communications-with-github)

**Short version:** *We use email and other electronic means to stay in touch with our users.*

### [1. Electronic Communication Required](#1-electronic-communication-required)

For contractual purposes, you (1) consent to receive communications from us in an electronic form via the email address you have submitted or via the Service; and (2) agree that all Terms of Service, agreements, notices, disclosures, and other communications that we provide to you electronically satisfy any legal requirement that those communications would satisfy if they were on paper. This section does not affect your non-waivable rights.

### [2. Legal Notice to GitHub Must Be in Writing](#2-legal-notice-to-github-must-be-in-writing)

Communications made through email or GitHub Support's messaging system will not constitute legal notice to GitHub or any of its officers, employees, agents or representatives in any situation where notice to GitHub is required by contract or any law or regulation. Legal notice to GitHub must be in writing and [served on GitHub's legal agent](/en/site-policy/other-site-policies/guidelines-for-legal-requests-of-user-data#submitting-requests).

### [3. No Phone Support](#3-no-phone-support)

GitHub only offers support via email, in-Service communications, and electronic messages. We do not offer telephone support.

## [N. Disclaimer of Warranties](#n-disclaimer-of-warranties)

**Short version:** *We provide our service as is, and we make no promises or guarantees about this service. Please read this section carefully; you should understand what to expect.*

GitHub provides the Website and the Service “as is” and “as available,” without warranty of any kind. Without limiting this, we expressly disclaim all warranties, whether express, implied or statutory, regarding the Website and the Service including without limitation any warranty of merchantability, fitness for a particular purpose, title, security, accuracy and non-infringement.

GitHub does not warrant that the Service will meet your requirements; that the Service will be uninterrupted, timely, secure, or error-free; that the information provided through the Service is accurate, reliable or correct; that any defects or errors will be corrected; that the Service will be available at any particular time or location; or that the Service is free of viruses or other harmful components. You assume full responsibility and risk of loss resulting from your downloading and/or use of files, information, content or other material obtained from the Service.

## [O. Limitation of Liability](#o-limitation-of-liability)

**Short version:** *We will not be liable for damages or losses arising from your use or inability to use the service or otherwise arising under this agreement. Please read this section carefully; it limits our obligations to you.*

You understand and agree that we will not be liable to you or any third party for any loss of profits, use, goodwill, or data, or for any incidental, indirect, special, consequential or exemplary damages, however arising, that result from

* the use, disclosure, or display of your User-Generated Content;
* your use or inability to use the Service;
* any modification, price change, suspension or discontinuance of the Service;
* the Service generally or the software or systems that make the Service available;
* unauthorized access to or alterations of your transmissions or data;
* statements or conduct of any third party on the Service;
* any other user interactions that you input or receive through your use of the Service; or
* any other matter relating to the Service.

Our liability is limited whether or not we have been informed of the possibility of such damages, and even if a remedy set forth in this Agreement is found to have failed of its essential purpose. We will have no liability for any failure or delay due to matters beyond our reasonable control.

## [P. Release and Indemnification](#p-release-and-indemnification)

**Short version:** *You are responsible for your use of the service. If you harm someone else or get into a dispute with someone else, we will not be involved.*

If you have a dispute with one or more Users, you agree to release GitHub from any and all claims, demands and damages (actual and consequential) of every kind and nature, known and unknown, arising out of or in any way connected with such disputes.

You agree to indemnify us, defend us, and hold us harmless from and against any and all claims, liabilities, and expenses, including attorneys’ fees, arising out of your use of the Website and the Service, including but not limited to your violation of this Agreement, provided that GitHub (1) promptly gives you written notice of the claim, demand, suit or proceeding; (2) gives you sole control of the defense and settlement of the claim, demand, suit or proceeding (provided that you may not settle any claim, demand, suit or proceeding unless the settlement unconditionally releases GitHub of all liability); and (3) provides to you all reasonable assistance, at your expense.

## [Q. Changes to These Terms](#q-changes-to-these-terms)

**Short version:** *We want our users to be informed of important changes to our terms, but some changes aren't that important — we don't want to bother you every time we fix a typo. So while we may modify this agreement at any time, we will notify users of any material changes and give you time to adjust to them.*

We reserve the right, at our sole discretion, to amend these Terms of Service at any time and will update these Terms of Service in the event of any such amendments. We will notify our Users of material changes to this Agreement, such as price increases, at least 30 days prior to the change taking effect by posting a notice on our Website or sending email to the primary email address specified in your GitHub account. Customer's continued use of the Service after those 30 days constitutes agreement to those revisions of this Agreement. For any other modifications, your continued use of the Website constitutes agreement to our revisions of these Terms of Service. You can view all changes to these Terms in our [Site Policy](https://github.com/github/site-policy) repository.

We reserve the right at any time and from time to time to modify or discontinue, temporarily or permanently, the Website (or any part of it) with or without notice.

## [R. Miscellaneous](#r-miscellaneous)

### [1. Governing Law](#1-governing-law)

Except to the extent applicable law provides otherwise, this Agreement between you and GitHub and any access to or use of the Website or the Service are governed by the federal laws of the United States of America and the laws of the State of California, without regard to conflict of law provisions. You and GitHub agree to submit to the exclusive jurisdiction and venue of the courts located in the City and County of San Francisco, California.

### [2. Non-Assignability](#2-non-assignability)

GitHub may assign or delegate these Terms of Service and/or the [GitHub Privacy Statement](https://github.com/site/privacy), in whole or in part, to any person or entity at any time with or without your consent, including the license grant in Section D.4. You may not assign or delegate any rights or obligations under the Terms of Service or Privacy Statement without our prior written consent, and any unauthorized assignment and delegation by you is void.

### [3. Section Headings and Summaries](#3-section-headings-and-summaries)

Throughout this Agreement, each section includes titles and brief summaries of the following terms and conditions. These section titles and brief summaries are not legally binding.

### [4. Severability, No Waiver, and Survival](#4-severability-no-waiver-and-survival)

If any part of this Agreement is held invalid or unenforceable, that portion of the Agreement will be construed to reflect the parties’ original intent. The remaining portions will remain in full force and effect. Any failure on the part of GitHub to enforce any provision of this Agreement will not be considered a waiver of our right to enforce such provision. Our rights under this Agreement will survive any termination of this Agreement.

### [5. Amendments; Complete Agreement](#5-amendments-complete-agreement)

This Agreement may only be modified by a written amendment signed by an authorized representative of GitHub, or by the posting by GitHub of a revised version in accordance with [Section Q. Changes to These Terms](#q-changes-to-these-terms). These Terms of Service, together with the GitHub Privacy Statement, represent the complete and exclusive statement of the agreement between you and us. This Agreement supersedes any proposal or prior agreement oral or written, and any other communications between you and GitHub relating to the subject matter of these terms including any confidentiality or nondisclosure agreements.

### [6. Questions](#6-questions)

Questions about the Terms of Service? Contact us through the [GitHub Support portal](https://support.github.com/).

## Help and support

### Help us make these docs great!

All GitHub docs are open source. See something that's wrong or unclear? Submit a pull request.

[Make a contribution](https://github.com/github/docs/blob/main/content/site-policy/github-terms/github-terms-of-service.md)

[Learn how to contribute](/contributing)

### Still need help?

[Ask the GitHub community](https://github.com/orgs/community/discussions)[Contact support](https://support.github.com)
## Legal

* © 2025 GitHub, Inc.
* [Terms](/en/site-policy/github-terms/github-terms-of-service)
* [Privacy](/en/site-policy/privacy-policies/github-privacy-statement)
* [Status](https://www.githubstatus.com/)
* [Pricing](https://github.com/pricing)
* [Expert services](https://services.github.com)
* [Blog](https://github.blog)


=== Content from github.com_40e241bf_20250119_112505.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fory%2Ffosite%2Fcommit%2F0c9e0f6d654913ad57c507dd9a36631e1858a3e9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fory%2Ffosite%2Fcommit%2F0c9e0f6d654913ad57c507dd9a36631e1858a3e9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=ory%2Ffosite)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ory](/ory)
/
**[fosite](/ory/fosite)**
Public

* [Notifications](/login?return_to=%2Fory%2Ffosite) You must be signed in to change notification settings
* [Fork
  368](/login?return_to=%2Fory%2Ffosite)
* [Star
   2.3k](/login?return_to=%2Fory%2Ffosite)

* [Code](/ory/fosite)
* [Issues
  25](/ory/fosite/issues)
* [Pull requests
  19](/ory/fosite/pulls)
* [Actions](/ory/fosite/actions)
* [Security](/ory/fosite/security)
* [Insights](/ory/fosite/pulse)

Additional navigation options

* [Code](/ory/fosite)
* [Issues](/ory/fosite/issues)
* [Pull requests](/ory/fosite/pulls)
* [Actions](/ory/fosite/actions)
* [Security](/ory/fosite/security)
* [Insights](/ory/fosite/pulse)

## Commit

[Permalink](/ory/fosite/commit/0c9e0f6d654913ad57c507dd9a36631e1858a3e9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-v3q9-2p3m-7g43](https://github.com/advisories/GHSA-v3q9-2p3m-7g43 "GHSA-v3q9-2p3m-7g43")

[Browse files](/ory/fosite/tree/0c9e0f6d654913ad57c507dd9a36631e1858a3e9)
Browse the repository at this point in the history

```
* u

* u
```

* Loading branch information

[![@zepatrik](https://avatars.githubusercontent.com/u/5354445?s=40&v=4)](/zepatrik)

[zepatrik](/ory/fosite/commits?author=zepatrik "View all commits by zepatrik")
authored
Mar 29, 2020

1 parent
[35a1558](/ory/fosite/commit/35a1558d8d845ac15bc6ec99fb4be062716b231a)

commit 0c9e0f6

 Show file tree

 Hide file tree

Showing
**34 changed files**
with
**494 additions**
and
**27 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* client\_authentication.go
  [client\_authentication.go](#diff-b0f5ad5632ad632f17fcb2ad2d3b6d2b75c9f3dc58d080d4439b83b8f3f90150)
* client\_authentication\_test.go
  [client\_authentication\_test.go](#diff-60ff344a0fd89bd840facfb2fc5d79e0414b2694d7bfc8dd6654444f9172e4f0)
* client\_manager.go
  [client\_manager.go](#diff-348af2b9e971d244ff67a5fb53a27b52ded2eab8e4728ed87c8df9b2fe9f6cae)
* errors.go
  [errors.go](#diff-76a7e0e299c7417bae32d3098e71370980157fe29e68a366671491d147d40572)
* go.mod
  [go.mod](#diff-33ef32bf6c23acb95f5902d7097b7a1d5128ca061167ec0716715b0b9eeaa5f6)
* go.sum
  [go.sum](#diff-3295df7234525439d778f1b282d146a4f1ff6b415248aaac074e8042d9f42d63)
* handler/oauth2

  + handler/oauth2/flow\_refresh.go
    [flow\_refresh.go](#diff-e733adcae5e1fe83d4192fc112318cfd1d77b5ad76b6d71d383ae705ea29e3f2)
* internal

  + internal/access\_request.go
    [access\_request.go](#diff-5b48fb5db95a0f61c974e0827e192ac823938937fc3632be9f1f20638d560398)
  + internal/access\_response.go
    [access\_response.go](#diff-e844611fd2bb28a3f140e00f84fa5ac434139546982c77d8838f18e01405de4b)
  + internal/access\_token\_storage.go
    [access\_token\_storage.go](#diff-a764b44be924971108f9013596fc667be9360714c1f73e5799847ec187e67c24)
  + internal/access\_token\_strategy.go
    [access\_token\_strategy.go](#diff-7dc20e3ffb0cd372342358eb072d09f6c9cff501fe4bf5cd6ee8a729e9ceb69e)
  + internal/authorize\_code\_storage.go
    [authorize\_code\_storage.go](#diff-c4b13b7fe34f40a6659bc59ae86206c57916dcda37a7e9b640a2c954c9bce88e)
  + internal/authorize\_code\_strategy.go
    [authorize\_code\_strategy.go](#diff-9f6daf195e92accac6f11a87e02a2119223db4aa20a8a6dcfc815e0cf9c213c0)
  + internal/authorize\_handler.go
    [authorize\_handler.go](#diff-174f729b9e83bc4121f6de32202f0d2c1bc3fb2883543e9bd7c2453df0991209)
  + internal/authorize\_request.go
    [authorize\_request.go](#diff-77cfd60777183ca8d22e5c23e5e126af028ca60b2abc07c9ffb5e7876bffa1c8)
  + internal/authorize\_response.go
    [authorize\_response.go](#diff-97f1a1391e37715350b2f250a5016f3ed693656fc8d1b4be8cce84a82706e74d)
  + internal/client.go
    [client.go](#diff-1936beeebc5541ea03b5fd0abdb15dac2ece8a4e8ea24b1ec29ac8b24fd6e4d2)
  + internal/hash.go
    [hash.go](#diff-6bbe876b46aea417c9c08eacb041542ede6513869631075337347daa16180e32)
  + internal/id\_token\_strategy.go
    [id\_token\_strategy.go](#diff-f3ed6c87f0810ebfabeb86e0a0cfb271a4a1e8d26c382343c107f0a0a872466d)
  + internal/introspector.go
    [introspector.go](#diff-7cb5da9308fed356b2930c9ac111d93cd1e8247e292cd44f0b4f3ac34386eca9)
  + internal/oauth2\_client\_storage.go
    [oauth2\_client\_storage.go](#diff-5799e293f218d7952abcb9215c2f1fd96ddf9b4174dc74d40fd29e96fb2c2094)
  + internal/oauth2\_owner\_storage.go
    [oauth2\_owner\_storage.go](#diff-d13eca84411ca9cbf6eb6e17b221c423bc29af5d477833223f09f2b202f9fb51)
  + internal/oauth2\_revoke\_storage.go
    [oauth2\_revoke\_storage.go](#diff-b6f9a1a5c671d72534bf70420d224f545c8b9389bd1e53b913b5578ed7450445)
  + internal/oauth2\_storage.go
    [oauth2\_storage.go](#diff-a1fe255ae1488c20502ea3c5cca602c7e691de63a919d320372fe7084b676a4c)
  + internal/oauth2\_strategy.go
    [oauth2\_strategy.go](#diff-b396b8375d4f51c63545c37d9d934582092cebb9e33c214152add7413979c9d1)
  + internal/openid\_id\_token\_storage.go
    [openid\_id\_token\_storage.go](#diff-b8c9b303c86051569337ce9adfb88c28555d990c01a957b8b1da1e9df5c4a71f)
  + internal/pkce\_storage\_strategy.go
    [pkce\_storage\_strategy.go](#diff-e7495b8ca66c261aae9a123ee58d29420fc9dc8646f9f0e31d224ac11bc8fb53)
  + internal/refresh\_token\_strategy.go
    [refresh\_token\_strategy.go](#diff-0199439ffedffa053e8e92d94f9645763463c69f30af44d1f5f2aafba1ca7761)
  + internal/request.go
    [request.go](#diff-e35a5ea3187bc191cf5121d3b5ef493eccd90d872edcea3a428368cc18a1ea8c)
  + internal/revoke\_handler.go
    [revoke\_handler.go](#diff-a247bd92d4e9077f14d37ad74aaf38f7c340f8239cbd8532e6e5b70f40b10021)
  + internal/storage.go
    [storage.go](#diff-c0090d5a11ac63f548ac55ed4e0f2b804931356f733357016c3d66b80a7daed1)
  + internal/token\_handler.go
    [token\_handler.go](#diff-65bcab0b487fc3c60b023271bfaaad3110adf8fb580c3a3dacb343b6c9c00aff)
  + internal/transactional.go
    [transactional.go](#diff-edc65f91a9181d3b69ec18d34a0774bdcc324be196c3029ea9988049329e3db3)
* storage

  + storage/memory.go
    [memory.go](#diff-7606108993f0e2ff7d906263a1e3df3b1e33611145002b9859fdc609d24046fd)

## There are no files selected for viewing

26 changes: 25 additions & 1 deletion

26
[client\_authentication.go](#diff-b0f5ad5632ad632f17fcb2ad2d3b6d2b75c9f3dc58d080d4439b83b8f3f90150 "client_authentication.go")

Show comments

[View file](/ory/fosite/blob/0c9e0f6d654913ad57c507dd9a36631e1858a3e9/client_authentication.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -24,9 +24,11 @@ package fosite |
|  |  | import ( |
|  |  | "context" |
|  |  | "crypto/rsa" |
|  |  | "encoding/json" |
|  |  | "fmt" |
|  |  | "net/http" |
|  |  | "net/url" |
|  |  | "time" |
|  |  |  |
|  |  | jwt "github.com/dgrijalva/jwt-go" |
|  |  | "github.com/pkg/errors" |
| Expand Down  Expand Up | | @@ -142,14 +144,36 @@ func (f \*Fosite) AuthenticateClient(ctx context.Context, r \*http.Request, form u |
|  |  | return nil, errors.WithStack(ErrInvalidClient.WithHint("Unable to type assert claims from request parameter \"client\_assertion\".").WithDebugf(`Got claims of type %T but expected type "\*jwt.MapClaims".`, token.Claims)) |
|  |  | } |
|  |  |  |
|  |  | var jti string |
|  |  | if !claims.VerifyIssuer(clientID, true) { |
|  |  | return nil, errors.WithStack(ErrInvalidClient.WithHint("Claim \"iss\" from \"client\_assertion\" must match the \"client\_id\" of the OAuth 2.0 Client.")) |
|  |  | } else if f.TokenURL == "" { |
|  |  | return nil, errors.WithStack(ErrMisconfiguration.WithHint("The authorization server's token endpoint URL has not been set.")) |
|  |  | } else if sub, ok := (\*claims)["sub"].(string); !ok || sub != clientID { |
|  |  | return nil, errors.WithStack(ErrInvalidClient.WithHint("Claim \"sub\" from \"client\_assertion\" must match the \"client\_id\" of the OAuth 2.0 Client.")) |
|  |  | } else if jti, ok := (\*claims)["jti"].(string); !ok || len(jti) == 0 { |
|  |  | } else if jti, ok = (\*claims)["jti"].(string); !ok || len(jti) == 0 { |
|  |  | return nil, errors.WithStack(ErrInvalidClient.WithHint("Claim \"jti\" from \"client\_assertion\" must be set but is not.")) |
|  |  | } else if f.Store.ClientAssertionJWTValid(context.Background(), jti) != nil { |
|  |  | return nil, errors.WithStack(ErrJTIKnown.WithHint("Claim \"jti\" from \"client\_assertion\" MUST only be used once.")) |
|  |  | } |
|  |  |  |
|  |  | // type conversion according to jwt.MapClaims.VerifyExpiresAt |
|  |  | var expiry int64 |
|  |  | err = nil |
|  |  | switch exp := (\*claims)["exp"].(type) { |
|  |  | case float64: |
|  |  | expiry = int64(exp) |
|  |  | case json.Number: |
|  |  | expiry, err = exp.Int64() |
|  |  | default: |
|  |  | err = ErrInvalidClient.WithHint("Unable to type assert the expiry time from claims. This should not happen as we validate the expiry time already earlier with token.Claims.Valid()") |
|  |  | } |
|  |  |  |
|  |  | if err != nil { |
|  |  | return nil, errors.WithStack(err) |
|  |  | } |
|  |  | if err := f.Store.SetClientAssertionJWT(context.Background(), jti, time.Unix(expiry, 0)); err != nil { |
|  |  | return nil, err |
|  |  | } |
|  |  |  |
|  |  | if auds, ok := (\*claims)["aud"].([]interface{}); !ok { |
| Expand Down | |  |

74 changes: 62 additions & 12 deletions

74
[client\_authentication\_test.go](#diff-60ff344a0fd89bd840facfb2fc5d79e0414b2694d7bfc8dd6654444f9172e4f0 "client_authentication_test.go")

Show comments

[View file](/ory/fosite/blob/0c9e0f6d654913ad57c507dd9a36631e1858a3e9/client_authentication_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -214,7 +214,7 @@ func TestAuthenticateClient(t \*testing.T) { |
|  |  | client: &DefaultOpenIDConnectClient{DefaultClient: &DefaultClient{ID: "bar", Secret: barSecret}, JSONWebKeys: jwks, TokenEndpointAuthMethod: "private\_key\_jwt"}, |
|  |  | form: url.Values{"client\_assertion": {mustGenerateAssertion(t, jwt.MapClaims{ |
|  |  | "sub": "bar", |
|  |  | "exp": time.Now().Add(time.Hour), |
|  |  | "exp": time.Now().Add(time.Hour).Unix(), |
|  |  | "iss": "bar", |
|  |  | "jti": "12345", |
|  |  | "aud": "token-url", |
| Expand All | | @@ -226,7 +226,7 @@ func TestAuthenticateClient(t \*testing.T) { |
|  |  | client: &DefaultOpenIDConnectClient{DefaultClient: &DefaultClient{ID: "bar", Secret: barSecret}, JSONWebKeys: jwks, TokenEndpointAuthMethod: "client\_secret\_jwt"}, |
|  |  | form: url.Values{"client\_assertion": {mustGenerateAssertion(t, jwt.MapClaims{ |
|  |  | "sub": "bar", |
|  |  | "exp": time.Now().Add(time.Hour), |
|  |  | "exp": time.Now().Add(time.Hour).Unix(), |
|  |  | "iss": "bar", |
|  |  | "jti": "12345", |
|  |  | "aud": "token-url", |
| Expand All | | @@ -239,7 +239,7 @@ func TestAuthenticateClient(t \*testing.T) { |
|  |  | client: &DefaultOpenIDConnectClient{DefaultClient: &DefaultClient{ID: "bar", Secret: barSecret}, JSONWebKeys: jwks, TokenEndpointAuthMethod: "private\_key\_jwt"}, |
|  |  | form: url.Values{"client\_assertion": {mustGenerateAssertion(t, jwt.MapClaims{ |
|  |  | "sub": "bar", |
|  |  | "exp": time.Now().Add(time.Hour), |
|  |  | "exp": time.Now().Add(time.Hour).Unix(), |
|  |  | "iss": "bar", |
|  |  | "jti": "12345", |
|  |  | "aud": []string{"token-url-2", "token-url"}, |
| Expand All | | @@ -251,7 +251,7 @@ func TestAuthenticateClient(t \*testing.T) { |
|  |  | client: &DefaultOpenIDConnectClient{DefaultClient: &DefaultClient{ID: "bar", Secret: barSecret}, JSONWebKeys: jwks, TokenEndpointAuthMethod: "private\_key\_jwt"}, |
|  |  | form: url.Values{"client\_assertion": {mustGenerateAssertion(t, jwt.MapClaims{ |
|  |  | "sub": "bar", |
|  |  | "exp": time.Now().Add(time.Hour), |
|  |  | "exp": time.Now().Add(time.Hour).Unix(), |
|  |  | "iss": "bar", |
|  |  | "jti": "12345", |
|  |  | "aud": []string{"token-url-1", "token-url-2"}, |
| Expand All | | @@ -264,7 +264,7 @@ func TestAuthenticateClient(t \*testing.T) { |
|  |  | client: &DefaultOpenIDConnectClient{DefaultClient: &DefaultClient{ID: "bar", Secret: barSecret}, JSONWebKeys: jwks, TokenEndpointAuthMethod: "private\_key\_jwt"}, |
|  |  | form: url.Values{"client\_id": []string{"bar"}, "client\_assertion": {mustGenerateAssertion(t, jwt.MapClaims{ |
|  |  | "sub": "bar", |
|  |  | "exp": time.Now().Add(time.Hour), |
|  |  | "exp": time.Now().Add(time.Hour).Unix(), |
|  |  | "iss": "bar", |
|  |  | "jti": "12345", |
|  |  | "aud": "token-url", |
| Expand All | | @@ -276,7 +276,7 @@ func TestAuthenticateClient(t \*testing.T) { |
|  |  | client: &DefaultOpenIDConnectClient{DefaultClient: &DefaultClient{ID: "bar", Secret: barSecret}, JSONWebKeys: jwks, TokenEndpointAuthMethod: "private\_key\_jwt"}, |
|  |  | form: url.Values{"client\_id": []string{"bar"}, "client\_assertion": {mustGenerateHSAssertion(t, jwt.MapClaims{ |
|  |  | "sub": "bar", |
|  |  | "exp": time.Now().Add(time.Hour), |
|  |  | "exp": time.Now().Add(time.Hour).Unix(), |
|  |  | "iss": "bar", |
|  |  | "jti": "12345", |
|  |  | "aud": "token-url", |
| Expand All | | @@ -289,7 +289,7 @@ func TestAuthenticateClient(t \*testing.T) { |
|  |  | client: &DefaultOpenIDConnectClient{DefaultClient: &DefaultClient{ID: "bar", Secret: barSecret}, JSONWebKeys: jwks, TokenEndpointAuthMethod: "private\_key\_jwt"}, |
|  |  | form: url.Values{"client\_id": []string{"bar"}, "client\_assertion": {mustGenerateNoneAssertion(t, jwt.MapClaims{ |
|  |  | "sub": "bar", |
|  |  | "exp": time.Now().Add(time.Hour), |
|  |  | "exp": time.Now().Add(time.Hour).Unix(), |
|  |  | "iss": "bar", |
|  |  | "jti": "12345", |
|  |  | "aud": "token-url", |
| Expand All | | @@ -302,7 +302,7 @@ func TestAuthenticateClient(t \*testing.T) { |
|  |  | client: &DefaultOpenIDConnectClient{DefaultClient: &DefaultClient{ID: "bar", Secret: barSecret}, JSONWebKeysURI: ts.URL, TokenEndpointAuthMethod: "private\_key\_jwt"}, |
|  |  | form: url.Values{"client\_id": []string{"bar"}, "client\_assertion": {mustGenerateAssertion(t, jwt.MapClaims{ |
|  |  | "sub": "bar", |
|  |  | "exp": time.Now().Add(time.Hour), |
|  |  | "exp": time.Now().Add(time.Hour).Unix(), |
|  |  | "iss": "bar", |
|  |  | "jti": "12345", |
|  |  | "aud": "token-url", |
| Expand All | | @@ -314,7 +314,7 @@ func TestAuthenticateClient(t \*testing.T) { |
|  |  | client: &DefaultOpenIDConnectClient{DefaultClient: &DefaultClient{ID: "bar", Secret: barSecret}, JSONWebKeys: jwks, TokenEndpointAuthMethod: "private\_key\_jwt"}, |
|  |  | form: url.Values{"client\_id": []string{"bar"}, "client\_assertion": {mustGenerateAssertion(t, jwt.MapClaims{ |
|  |  | "sub": "not-bar", |
|  |  | "exp": time.Now().Add(time.Hour), |
|  |  | "exp": time.Now().Add(time.Hour).Unix(), |
|  |  | "iss": "bar", |
|  |  | "jti": "12345", |
|  |  | "aud": "token-url", |
| Expand All | | @@ -327,7 +327,7 @@ func TestAuthenticateClient(t \*testing.T) { |
|  |  | client: &DefaultOpenIDConnectClient{DefaultClient: &DefaultClient{ID: "bar", Secret: barSecret}, JSONWebKeys: jwks, TokenEndpointAuthMethod: "private\_key\_jwt"}, |
|  |  | form: url.Values{"client\_id": []string{"bar"}, "client\_assertion": {mustGenerateAssertion(t, jwt.MapClaims{ |
|  |  | "sub": "bar", |
|  |  | "exp": time.Now().Add(time.Hour), |
|  |  | "exp": time.Now().Add(time.Hour).Unix(), |
|  |  | "iss": "not-bar", |
|  |  | "jti": "12345", |
|  |  | "aud": "token-url", |
| Expand All | | @@ -340,7 +340,7 @@ func TestAuthenticateClient(t \*testing.T) { |
|  |  | client: &DefaultOpenIDConnectClient{DefaultClient: &DefaultClient{ID: "bar", Secret: barSecret}, JSONWebKeys: jwks, TokenEndpointAuthMethod: "private\_key\_jwt"}, |
|  |  | form: url.Values{"client\_id": []string{"bar"}, "client\_assertion": {mustGenerateAssertion(t, jwt.MapClaims{ |
|  |  | "sub": "bar", |
|  |  | "exp": time.Now().Add(time.Hour), |
|  |  | "exp": time.Now().Add(time.Hour).Unix(), |
|  |  | "iss": "bar", |
|  |  | "aud": "token-url", |
|  |  | }, key, "kid-foo")}, "client\_assertion\_type": []string{at}}, |
| Expand All | | @@ -352,7 +352,7 @@ func TestAuthenticateClient(t \*testing.T) { |
|  |  | client: &DefaultOpenIDConnectClient{DefaultClient: &DefaultClient{ID: "bar", Secret: barSecret}, JSONWebKeys: jwks, TokenEndpointAuthMethod: "private\_key\_jwt"}, |
|  |  | form: url.Values{"client\_id": []string{"bar"}, "client\_assertion": {mustGenerateAssertion(t, jwt.MapClaims{ |
|  |  | "sub": "bar", |
|  |  | "exp": time.Now().Add(time.Hour), |
|  |  | "exp": time.Now().Add(time.Hour).Unix(), |
|  |  | "iss": "bar", |
|  |  | "jti": "12345", |
|  |  | "aud": "not-token-url", |
| Expand Down  Expand Up | | @@ -385,3 +385,53 @@ func TestAuthenticateClient(t \*testing.T) { |
|  |  | }) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func TestAuthenticateClientTwice(t \*testing.T) { |
|  |  | const at = "urn:ietf:params:oauth:client-assertion-type:jwt-bearer" |
|  |  |  |
|  |  | key := internal.MustRSAKey() |
|  |  | client := &DefaultOpenIDConnectClient{ |
|  |  | DefaultClient: &DefaultClient{ |
|  |  | ID: "bar", |
|  |  | Secret: []byte("secret"), |
|  |  | }, |
|  |  | JSONWebKeys: &jose.JSONWebKeySet{ |
|  |  | Keys: []jose.JSONWebKey{ |
|  |  | { |
|  |  | KeyID: "kid-foo", |
|  |  | Use: "sig", |
|  |  | Key: &key.PublicKey, |
|  |  | }, |
|  |  | }, |
|  |  | }, |
|  |  | TokenEndpointAuthMethod: "private\_key\_jwt", |
|  |  | } |
|  |  | store := storage.NewMemoryStore() |
|  |  | store.Clients[client.ID] = client |
|  |  |  |
|  |  | hasher := &BCrypt{WorkFactor: 6} |
|  |  | f := &Fosite{ |
|  |  | JWKSFetcherStrategy: NewDefaultJWKSFetcherStrategy(), |
|  |  | Store: store, |
|  |  | Hasher: hasher, |
|  |  | TokenURL: "token-url", |
|  |  | } |
|  |  |  |
|  |  | formValues := url.Values{"client\_id": []string{"bar"}, "client\_assertion": {mustGenerateAssertion(t, jwt.MapClaims{ |
|  |  | "sub": "bar", |
|  |  | "exp": time.Now().Add(time.Hour).Unix(), |
|  |  | "iss": "bar", |
|  |  | "jti": "12345", |
|  |  | "aud": "token-url", |
|  |  | }, key, "kid-foo")}, "client\_assertion\_type": []string{at}} |
|  |  |  |
|  |  | c, err := f.AuthenticateClient(nil, new(http.Request), formValues) |
|  |  | require.NoError(t, err, "%#v", err) |
|  |  | assert.Equal(t, client, c) |
|  |  |  |
|  |  | // replay the request and expect it to fail |
|  |  | c, err = f.AuthenticateClient(nil, new(http.Request), formValues) |
|  |  | require.Error(t, err) |
|  |  | assert.EqualError(t, err, ErrJTIKnown.Error()) |
|  |  | assert.Nil(t, c) |
|  |  | } |

13 changes: 12 additions & 1 deletion

13
[client\_manager.go](#diff-348af2b9e971d244ff67a5fb53a27b52ded2eab8e4728ed87c8df9b2fe9f6cae "client_manager.go")

Show comments

[View file](/ory/fosite/blob/0c9e0f6d654913ad57c507dd9a36631e1858a3e9/client_manager.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -21,11 +21,22 @@ |
|  |  |  |
|  |  | package fosite |
|  |  |  |
|  |  | import "context" |
|  |  | import ( |
|  |  | "context" |
|  |  | "time" |
|  |  | ) |
|  |  |  |
|  |  | // ClientManager defines the (persistent) manager interface for clients. |
|  |  | type ClientManager interface { |
|  |  | // GetClient loads the client by its ID or returns an error |
|  |  | // if the client does not exist or another error occurred. |
|  |  | GetClient(ctx context.Context, id string) (Client, error) |
|  |  | // ClientAssertionJWTValid returns an error if the JTI is |
|  |  | // known or the DB check failed and nil if the JTI is not known. |
|  |  | ClientAssertionJWTValid(ctx context.Context, jti string) error |
|  |  | // SetClientAssertionJWT marks a JTI as known for the given |
|  |  | // expiry time. Before inserting the new JTI, it will clean |
|  |  | // up any existing JTIs that have expired as those tokens can |
|  |  | // not be replayed due to the expiry. |
|  |  | SetClientAssertionJWT(ctx context.Context, jti string, exp time.Time) error |
|  |  | } |

6 changes: 6 additions & 0 deletions

6
[errors.go](#diff-76a7e0e299c7417bae32d3098e71370980157fe29e68a366671491d147d40572 "errors.go")

Show comments

[View file](/ory/fosite/blob/0c9e0f6d654913ad57c507dd9a36631e1858a3e9/errors.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -206,6 +206,11 @@ var ( |
|  |  | Name: errInvalidRequestObject, |
|  |  | Code: http.StatusBadRequest, |
|  |  | } |
|  |  | ErrJTIKnown = &RFC6749Error{ |
|  |  | Description: "The jti was already used.", |
|  |  | Name: errJTIKnownName, |
|  |  | Code: http.StatusBadRequest, |
|  |  | } |
|  |  | ) |
|  |  |  |
|  |  | const ( |
| Expand Down  Expand Up | | @@ -242,6 +247,7 @@ const ( |
|  |  | errRequestNotSupportedName = "request\_not\_supported" |
|  |  | errRequestURINotSupportedName = "request\_uri\_not\_supported" |
|  |  | errRegistrationNotSupportedName = "registration\_not\_supported" |
|  |  | errJTIKnownName = "jti\_known" |
|  |  | ) |
|  |  |  |
|  |  | func ErrorToRFC6749Error(err error) \*RFC6749Error { |
| Expand Down | |  |

6 changes: 2 additions & 4 deletions

6
[go.mod](#diff-33ef32bf6c23acb95f5902d7097b7a1d5128ca061167ec0716715b0b9eeaa5f6 "go.mod")

Show comments

[View file](/ory/fosite/blob/0c9e0f6d654913ad57c507dd9a36631e1858a3e9/go.mod)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,7 +5,7 @@ require ( |
|  |  | github.com/davecgh/go-spew v1.1.1 // indirect |
|  |  | github.com/dgrijalva/jwt-go v3.2.0+incompatible |
|  |  | github.com/elazarl/goproxy v0.0.0-20181003060214-f58a169a71a5 // indirect |
|  |  | github.com/golang/mock v1.1.1 |
|  |  | github.com/golang/mock v1.4.3 |
|  |  | github.com/gopherjs/gopherjs v0.0.0-20181004151105-1babbf986f6f // indirect |
|  |  | github.com/gorilla/context v1.1.1 // indirect |
|  |  | github.com/gorilla/mux v1.6.2 |
| Expand All | | @@ -22,10 +22,8 @@ require ( |
|  |  | github.com/smartystreets/assertions v0.0.0-20180927180507-b2de0cb4f26d // indirect |
|  |  | github.com/smartystreets/goconvey v0.0.0-20180222194500-ef6db91d284a // indirect |
|  |  | github.com/stretchr/testify v1.2.2 |
|  |  | golang.org/x/crypto v0.0.0-20181001203147-e3636079e1a4 |
|  |  | golang.org/x/net v0.0.0-20181005035420-146acd28ed58 // indirect |
|  |  | golang.org/x/crypto v0.0.0-20190308221718-c2843e01d9a2 |
|  |  | golang.org/x/oauth2 v0.0.0-20181003184128-c57b0facaced |
|  |  | golang.org/x/sync v0.0.0-20180314180146-1d60e4601c6f // indirect |
|  |  | google.golang.org/appengine v1.2.0 // indirect |
|  |  | gopkg.in/square/go-jose.v2 v2.1.9 |
|  |  | ) |
| Expand Down | |  |

13 changes: 13 additions & 0 deletions

13
[go.sum](#diff-3295df7234525439d778f1b282d146a4f1ff6b415248aaac074e8042d9f42d63 "go.sum")

Show comments

[View file](/ory/fosite/blob/0c9e0f6d654913ad57c507dd9a36631e1858a3e9/go.sum)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,6 +8,8 @@ github.com/elazarl/goproxy v0.0.0-20181003060214-f58a169a71a5 h1:LCoguo7Zd0MByKM |
|  |  | github.com/elazarl/goproxy v0.0.0-20181003060214-f58a169a71a5/go.mod h1:/Zj4wYkgs4iZTTu3o/KG3Itv/qCCa8VVMlb3i9OVuzc= |
|  |  | github.com/golang/mock v1.1.1 h1:G5FRp8JnTd7RQH5kemVNlMeyXQAztQ3mOWV95KxsXH8= |
|  |  | github.com/golang/mock v1.1.1/go.mod h1:oTYuIxOrZwtPieC+H1uAHpcLFnEyAGVDL/k47Jfbm0A= |
|  |  | github.com/golang/mock v1.4.3 h1:GV+pQPG/EUUbkh47niozDcADz6go/dUwhVzdUQHIVRw= |
|  |  | github.com/golang/mock v1.4.3/go.mod h1:UOMv5ysSaYNkG+OFQykRIcU/QvvxJf3p21QfJ2Bt3cw= |
|  |  | github.com/golang/protobuf v1.2.0 h1:P3YflyNX/ehuJFLhxviNdFxQPkGK5cDcApsge1SqnvM= |
|  |  | github.com/golang/protobuf v1.2.0/go.mod h1:6lQm79b+lXiMfvg/cZm0SGofjICqVBUtrP5yJMmIC1U= |
|  |  | github.com/google/uuid v1.0.0 h1:b4Gk+7WdP/d3HZH8EJsZpvV7EtDOgaZLtnaNGIu1adA= |
| Expand Down  Expand Up | | @@ -46,15 +48,26 @@ github.com/stretchr/testify v1.2.2 h1:bSDNvY7ZPG5RlJ8otE/7V6gMiyenm9RtJ7IUVIAoJ1 |
|  |  | github.com/stretchr/testify v1.2.2/go.mod h1:a8OnRcib4nhh0OaRAV+Yts87kKdq0PP7pXfy6kDkUVs= |
|  |  | golang.org/x/crypto v0.0.0-20181001203147-e3636079e1a4 h1:Vk3wNqEZwyGyei9yq5ekj7frek2u7HUfffJ1/opblzc= |
|  |  | golang.org/x/crypto v0.0.0-20181001203147-e3636079e1a4/go.mod h1:6SG95UA2DQfeDnfUPMdvaQW0Q7yPrPDi9nlGo2tz2b4= |
|  |  | golang.org/x/crypto v0.0.0-20190308221718-c2843e01d9a2 h1:VklqNMn3ovrHsnt90PveolxSbWFaJdECFbxSq0Mqo2M= |
|  |  | golang.org/x/crypto v0.0.0-20190308221718-c2843e01d9a2/go.mod h1:djNgcEr1/C05ACkg1iLfiJU5Ep61QUkGW8qpdssI0+w= |
|  |  | golang.org/x/net v0.0.0-20180724234803-3673e40ba225/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4= |
|  |  | golang.org/x/net v0.0.0-20181005035420-146acd28ed58 h1:otZG8yDCO4LVps5+9bxOeNiCvgmOyt96J3roHTYs7oE= |
|  |  | golang.org/x/net v0.0.0-20181005035420-146acd28ed58/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4= |
|  |  | golang.org/x/net v0.0.0-20190311183353-d8887717615a h1:oWX7TPOiFAMXLq8o0ikBYfCJVlRHBcsciT5bXOrH628= |
|  |  | golang.org/x/net v0.0.0-20190311183353-d8887717615a/go.mod h1:t9HGtf8HONx5eT2rtn7q6eTqICYqUVnKs3thJo3Qplg= |
|  |  | golang.org/x/oauth2 v0.0.0-20181003184128-c57b0facaced h1:4oqSq7eft7MdPKBGQK11X9WYUxmj6ZLgGTqYIbY1kyw= |
|  |  | golang.org/x/oauth2 v0.0.0-20181003184128-c57b0facaced/go.mod h1:N/0e6XlmueqKjAGxoOufVs8QHGRruUQn6yWY3a++T0U= |
|  |  | golang.org/x/sync v0.0.0-20180314180146-1d60e4601c6f h1:wMNYb4v58l5UBM7MYRLPG6ZhfOqbKu7X5eyFl8ZhKvA= |
|  |  | golang.org/x/sync v0.0.0-20180314180146-1d60e4601c6f/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM= |
|  |  | golang.org/x/sync v0.0.0-20190423024810-112230192c58/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM= |
|  |  | golang.org/x/sys v0.0.0-20190215142949-d0b11bdaac8a/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY= |
|  |  | golang.org/x/text v0.0.0-20170915032832-14c0d48ead0c/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ= |
|  |  | golang.org/x/text v0.3.0/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ= |
|  |  | golang.org/x/tools v0.0.0-20190425150028-36563e24a262 h1:qsl9y/CJx34tuA7QCPNp86JNJe4spst6Ff8MjvPUdPg= |
|  |  | golang.org/x/tools v0.0.0-20190425150028-36563e24a262/go.mod h1:RgjU9mgBXZiqYHBnxXauZ1Gv1EHHAz9KjViQ78xBX0Q= |
|  |  | google.golang.org/appengine v1.2.0 h1:S0iUepdCWODXRvtE+gcRDd15L+k+k1AiHlMiMjefH24= |
|  |  | google.golang.org/appengine v1.2.0/go.mod h1:xpcJRLb0r/rnEns0DIKYYv+WjYCduHsrkT7/EB5XEv4= |
|  |  | gopkg.in/square/go-jose.v2 v2.1.9 h1:YCFbL5T2gbmC2sMG12s1x2PAlTK5TZNte3hjZEIcCAg= |
|  |  | gopkg.in/square/go-jose.v2 v2.1.9/go.mod h1:M9dMgbHiYLoDGQrXy7OpJDJWiKiU//h+vD76mk0e1AI= |
|  |  | rsc.io/quote/v3 v3.1.0/go.mod h1:yEA65RcK8LyAZtP9Kv3t0HmxON59tX3rD+tICJqUlj0= |
|  |  | rsc.io/sampler v1.3.0/go.mod h1:T1hPZKmBbMNahiBKFy5HrXp6adAjACjK9JXDnKaTXpA= |

3 changes: 2 additions & 1 deletion

3
[handler/oauth2/flow\_refresh.go](#diff-e733adcae5e1fe83d4192fc112318cfd1d77b5ad76b6d71d383ae705ea29e3f2 "handler/oauth2/flow_refresh.go")

Show comments

[View file](/ory/fosite/blob/0c9e0f6d654913ad57c507dd9a36631e1858a3e9/handler/oauth2/flow_refresh.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -27,9 +27,10 @@ import ( |
|  |  | "strings" |
|  |  | "time" |
|  |  |  |
|  |  | "github.com/pkg/errors" |
|  |  |  |
|  |  | "github.com/ory/fosite" |
|  |  | "github.com/ory/fosite/storage" |
|  |  | "github.com/pkg/errors" |
|  |  | ) |
|  |  |  |
|  |  | type RefreshTokenGrantHandler struct { |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0c9e0f6`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fory%2Ffosite%2Fcommit%2F0c9e0f6d654913ad57c507dd9a36631e1858a3e9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from openid.net_067096a8_20250119_131731.html ===


| [TOC](#toc) |
| --- |

| | Final | N. Sakimura | | --- | --- | |  | NAT.Consulting (was at NRI) | |  | J. Bradley | |  | Yubico (was at Ping Identity) | |  | M. Jones | |  | Self-Issued Consulting (was at | |  | Microsoft) | |  | B. de Medeiros | |  | Google | |  | C. Mortimore | |  | Disney (was at Salesforce) | |  | December 15, 2023 | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

# OpenID Connect Core 1.0 incorporating errata set 2

### Abstract

OpenID Connect 1.0 is a simple identity layer on top of the OAuth 2.0
protocol. It enables Clients to verify the identity of the End-User based
on the authentication performed by an Authorization Server, as well as to
obtain basic profile information about the End-User in an interoperable and
REST-like manner.

This specification defines
the core OpenID Connect functionality:
authentication built on top of OAuth 2.0 and
the use of Claims to communicate information about the End-User.
It also describes the security and privacy considerations for using OpenID Connect.

---

### Table of Contents

[1.](#Introduction)
Introduction

    [1.1.](#rnc)
Requirements Notation and Conventions

    [1.2.](#Terminology)
Terminology

    [1.3.](#Overview)
Overview

[2.](#IDToken)
ID Token

[3.](#Authentication)
Authentication

    [3.1.](#CodeFlowAuth)
Authentication using the Authorization Code Flow

        [3.1.1.](#CodeFlowSteps)
Authorization Code Flow Steps

        [3.1.2.](#AuthorizationEndpoint)
Authorization Endpoint

            [3.1.2.1.](#AuthRequest)
Authentication Request

            [3.1.2.2.](#AuthRequestValidation)
Authentication Request Validation

            [3.1.2.3.](#Authenticates)
Authorization Server Authenticates End-User

            [3.1.2.4.](#Consent)
Authorization Server Obtains End-User Consent/Authorization

            [3.1.2.5.](#AuthResponse)
Successful Authentication Response

            [3.1.2.6.](#AuthError)
Authentication Error Response

            [3.1.2.7.](#AuthResponseValidation)
Authentication Response Validation

        [3.1.3.](#TokenEndpoint)
Token Endpoint

            [3.1.3.1.](#TokenRequest)
Token Request

            [3.1.3.2.](#TokenRequestValidation)
Token Request Validation

            [3.1.3.3.](#TokenResponse)
Successful Token Response

            [3.1.3.4.](#TokenErrorResponse)
Token Error Response

            [3.1.3.5.](#TokenResponseValidation)
Token Response Validation

            [3.1.3.6.](#CodeIDToken)
ID Token

            [3.1.3.7.](#IDTokenValidation)
ID Token Validation

            [3.1.3.8.](#CodeFlowTokenValidation)
Access Token Validation

    [3.2.](#ImplicitFlowAuth)
Authentication using the Implicit Flow

        [3.2.1.](#ImplicitFlowSteps)
Implicit Flow Steps

        [3.2.2.](#ImplicitAuthorizationEndpoint)
Authorization Endpoint

            [3.2.2.1.](#ImplicitAuthRequest)
Authentication Request

            [3.2.2.2.](#ImplicitValidation)
Authentication Request Validation

            [3.2.2.3.](#ImplicitAuthenticates)
Authorization Server Authenticates End-User

            [3.2.2.4.](#ImplicitConsent)
Authorization Server Obtains End-User Consent/Authorization

            [3.2.2.5.](#ImplicitAuthResponse)
Successful Authentication Response

            [3.2.2.6.](#ImplicitAuthError)
Authentication Error Response

            [3.2.2.7.](#ImplicitCallback)
Redirect URI Fragment Handling

            [3.2.2.8.](#ImplicitAuthResponseValidation)
Authentication Response Validation

            [3.2.2.9.](#ImplicitTokenValidation)
Access Token Validation

            [3.2.2.10.](#ImplicitIDToken)
ID Token

            [3.2.2.11.](#ImplicitIDTValidation)
ID Token Validation

    [3.3.](#HybridFlowAuth)
Authentication using the Hybrid Flow

        [3.3.1.](#HybridFlowSteps)
Hybrid Flow Steps

        [3.3.2.](#HybridAuthorizationEndpoint)
Authorization Endpoint

            [3.3.2.1.](#HybridAuthRequest)
Authentication Request

            [3.3.2.2.](#HybridValidation)
Authentication Request Validation

            [3.3.2.3.](#HybridAuthenticates)
Authorization Server Authenticates End-User

            [3.3.2.4.](#HybridConsent)
Authorization Server Obtains End-User Consent/Authorization

            [3.3.2.5.](#HybridAuthResponse)
Successful Authentication Response

            [3.3.2.6.](#HybridAuthError)
Authentication Error Response

            [3.3.2.7.](#HybridCallback)
Redirect URI Fragment Handling

            [3.3.2.8.](#HybridAuthResponseValidation)
Authentication Response Validation

            [3.3.2.9.](#HybridTokenValidation)
Access Token Validation

            [3.3.2.10.](#CodeValidation)
Authorization Code Validation

            [3.3.2.11.](#HybridIDToken)
ID Token

            [3.3.2.12.](#HybridIDTValidation)
ID Token Validation

        [3.3.3.](#HybridTokenEndpoint)
Token Endpoint

            [3.3.3.1.](#HybridTokenRequest)
Token Request

            [3.3.3.2.](#HybridTokenRequestValidation)
Token Request Validation

            [3.3.3.3.](#HybridTokenResponse)
Successful Token Response

            [3.3.3.4.](#HybridTokenErrorResponse)
Token Error Response

            [3.3.3.5.](#HybridTokenResponseValidation)
Token Response Validation

            [3.3.3.6.](#HybridIDToken2)
ID Token

            [3.3.3.7.](#HybridIDTValidation2)
ID Token Validation

            [3.3.3.8.](#HybridAccessToken2)
Access Token

            [3.3.3.9.](#HybridTokenValidation2)
Access Token Validation

[4.](#ThirdPartyInitiatedLogin)
Initiating Login from a Third Party

[5.](#Claims)
Claims

    [5.1.](#StandardClaims)
Standard Claims

        [5.1.1.](#AddressClaim)
Address Claim

        [5.1.2.](#AdditionalClaims)
Additional Claims

    [5.2.](#ClaimsLanguagesAndScripts)
Claims Languages and Scripts

    [5.3.](#UserInfo)
UserInfo Endpoint

        [5.3.1.](#UserInfoRequest)
UserInfo Request

        [5.3.2.](#UserInfoResponse)
Successful UserInfo Response

        [5.3.3.](#UserInfoError)
UserInfo Error Response

        [5.3.4.](#UserInfoResponseValidation)
UserInfo Response Validation

    [5.4.](#ScopeClaims)
Requesting Claims using Scope Values

    [5.5.](#ClaimsParameter)
Requesting Claims using the "claims" Request Parameter

        [5.5.1.](#IndividualClaimsRequests)
Individual Claims Requests

            [5.5.1.1.](#acrSemantics)
Requesting the "acr" Claim

        [5.5.2.](#IndividualClaimsLanguages)
Languages and Scripts for Individual Claims

    [5.6.](#ClaimTypes)
Claim Types

        [5.6.1.](#NormalClaims)
Normal Claims

        [5.6.2.](#AggregatedDistributedClaims)
Aggregated and Distributed Claims

            [5.6.2.1.](#AggregatedExample)
Example of Aggregated Claims

            [5.6.2.2.](#DistributedExample)
Example of Distributed Claims

    [5.7.](#ClaimStability)
Claim Stability and Uniqueness

[6.](#JWTRequests)
Passing Request Parameters as JWTs

    [6.1.](#RequestObject)
Passing a Request Object by Value

        [6.1.1.](#RequestParameter)
Request using the "request" Request Parameter

    [6.2.](#RequestUriParameter)
Passing a Request Object by Reference

        [6.2.1.](#CreateRequestUri)
URI Referencing the Request Object

        [6.2.2.](#UseRequestUri)
Request using the "request\_uri" Request Parameter

        [6.2.3.](#GetRequestUri)
Authorization Server Fetches Request Object

        [6.2.4.](#RequestUriRationale)
"request\_uri" Rationale

    [6.3.](#JWTRequestValidation)
Validating JWT-Based Requests

        [6.3.1.](#EncryptedRequestObject)
Encrypted Request Object

        [6.3.2.](#SignedRequestObject)
Signed Request Object

        [6.3.3.](#RequestParameterValidation)
Request Parameter Assembly and Validation

[7.](#SelfIssued)
Self-Issued OpenID Provider

    [7.1.](#SelfIssuedDiscovery)
Self-Issued OpenID Provider Discovery

    [7.2.](#SelfIssuedRegistration)
Self-Issued OpenID Provider Registration

        [7.2.1.](#RegistrationParameter)
Providing Information with the "registration" Request Parameter

    [7.3.](#SelfIssuedRequest)
Self-Issued OpenID Provider Request

    [7.4.](#SelfIssuedResponse)
Self-Issued OpenID Provider Response

    [7.5.](#SelfIssuedValidation)
Self-Issued ID Token Validation

[8.](#SubjectIDTypes)
Subject Identifier Types

    [8.1.](#PairwiseAlg)
Pairwise Identifier Algorithm

[9.](#ClientAuthentication)
Client Authentication

[10.](#SigEnc)
Signatures and Encryption

    [10.1.](#Signing)
Signing

        [10.1.1.](#RotateSigKeys)
Rotation of Asymmetric Signing Keys

    [10.2.](#Encryption)
Encryption

        [10.2.1.](#RotateEncKeys)
Rotation of Asymmetric Encryption Keys

[11.](#OfflineAccess)
Offline Access

[12.](#RefreshTokens)
Using Refresh Tokens

    [12.1.](#RefreshingAccessToken)
Refresh Request

    [12.2.](#RefreshTokenResponse)
Successful Refresh Response

    [12.3.](#RefreshErrorResponse)
Refresh Error Response

[13.](#Serializations)
Serializations

    [13.1.](#QuerySerialization)
Query String Serialization

    [13.2.](#FormSerialization)
Form Serialization

    [13.3.](#JSONSerialization)
JSON Serialization

[14.](#StringOps)
String Operations

[15.](#ImplementationConsiderations)
Implementation Considerations

    [15.1.](#ServerMTI)
Mandatory to Implement Features for All OpenID Providers

    [15.2.](#DynamicMTI)
Mandatory to Implement Features for Dynamic OpenID Providers

    [15.3.](#DiscoReg)
Discovery and Registration

    [15.4.](#RPMTI)
Mandatory to Implement Features for Relying Parties

    [15.5.](#ImplementationNotes)
Implementation Notes

        [15.5.1.](#CodeNotes)
Authorization Code Implementation Notes

        [15.5.2.](#NonceNotes)
Nonce Implementation Notes

        [15.5.3.](#FragmentNotes)
Redirect URI Fragment Handling Implementation Notes

    [15.6.](#CompatibilityNotes)
Compatibility Notes

    [15.7.](#RelatedSpecs)
Related Specifications and Implementer's Guides

[16.](#Security)
Security Considerations

    [16.1.](#RequestDisclosure)
Request Disclosure

    [16.2.](#ServerMasquerading)
Server Masquerading

    [16.3.](#TokenManufacture)
Token Manufacture/Modification

    [16.4.](#AccessTokenDisclosure)
Access Token Disclosure

    [16.5.](#ResponseDisclosure)
Server Response Disclosure

    [16.6.](#ServerResponseRepudiation)
Server Response Repudiation

    [16.7.](#RequestRepudation)
Request Repudiation

    [16.8.](#AccessTokenRedirect)
Access Token Redirect

    [16.9.](#TokenReuse)
Token Reuse

    [16.10.](#AuthCodeCapture)
Eavesdropping or Leaking Authorization Codes (Secondary Authenticator Capture)

    [16.11.](#TokenSubstitution)
Token Substitution

    [16.12.](#TimingAttack)
Timing Attack

    [16.13.](#OtherCryptoAttacks)
Other Crypto Related Attacks

    [16.14.](#SigningOrder)
Signing and Encryption Order

    [16.15.](#IssuerIdentifier)
Issuer Identifier

    [16.16.](#ImplicitFlowThreats)
Implicit Flow Threats

    [16.17.](#TLSRequirements)
TLS Requirements

    [16.18.](#TokenLifetime)
Lifetimes of Access Tokens and Refresh Tokens

    [16.19.](#SymmetricKeyEntropy)
Symmetric Key Entropy

    [16.20.](#NeedForSignedRequests)
Need for Signed Requests

    [16.21.](#NeedForEncryptedRequests)
Need for Encrypted Requests

    [16.22.](#HTTP307Redirects)
HTTP 307 Redirects

    [16.23.](#iOSCustomSchemes)
Custom URI Schemes on iOS

[17.](#Privacy)
Privacy Considerations

    [17.1.](#PII)
Personally Identifiable Information

    [17.2.](#AccessMonitoring)
Data Access Monitoring

    [17.3.](#Correlation)
Correlation

    [17.4.](#OfflineAccessPrivacy)
Offline Access

[18.](#IANA)
IANA Considerations

    [18.1.](#ClaimsRegistry)
JSON Web Token Claims Registration

        [18.1.1.](#ClaimsContents)
Registry Contents

    [18.2.](#OAuthParametersRegistry)
OAuth Parameters Registration

        [18.2.1.](#ParametersContents)
Registry Contents

    [18.3.](#OAuthErrorRegistry)
OAuth Extensions Error Registration

        [18.3.1.](#ErrorContents)
Registry Contents

    [18.4.](#URISchemeRegistry)
URI Scheme Registration

        [18.4.1.](#URISchemeContents)
Registry Contents

[19.](#rfc.references1)
References

    [19.1.](#rfc.references1)
Normative References

    [19.2.](#rfc.references2)
Informative References

[Appendix A.](#AuthorizationExamples)
Authorization Examples

    [A.1.](#codeExample)
Example using response\_type=code

    [A.2.](#id_tokenExample)
Example using response\_type=id\_token

    [A.3.](#id_token-tokenExample)
Example using response\_type=id\_token token

    [A.4.](#code-id_tokenExample)
Example using response\_type=code id\_token

    [A.5.](#code-tokenExample)
Example using response\_type=code token

    [A.6.](#code-id_token-tokenExample)
Example using response\_type=code id\_token token

    [A.7.](#ExampleRSAKey)
RSA Key Used in Examples

[Appendix B.](#Acknowledgements)
Acknowledgements

[Appendix C.](#Notices)
Notices

[§](#rfc.authors)
Authors' Addresses

---

| [TOC](#toc) |
| --- |

### 1.  Introduction

OpenID Connect 1.0 is a simple identity layer on top of the OAuth 2.0
[[RFC6749] (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749)
protocol. It enables Clients to verify the identity of the End-User based
on the authentication performed by an Authorization Server, as well as to
obtain basic profile information about the End-User in an interoperable and
REST-like manner.

The OpenID Connect Core 1.0 specification defines
the core OpenID Connect functionality:
authentication built on top of OAuth 2.0 and
the use of Claims to communicate information about the End-User.
It also describes the security and privacy considerations for using OpenID Connect.

As background,
the [OAuth 2.0 Authorization Framework (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749]
and [OAuth 2.0 Bearer Token Usage (Jones, M. and D. Hardt, “The OAuth 2.0 Authorization Framework: Bearer Token Usage,” October 2012.)](#RFC6750) [RFC6750]
specifications provide a general framework for third-party applications
to obtain and use limited access to HTTP resources. They define
mechanisms to obtain and use Access Tokens to access resources but
do not define standard methods to provide identity information.
Notably, without profiling OAuth 2.0, it is incapable of
providing information about the authentication of an End-User.
Readers are expected to be familiar with these specifications.

OpenID Connect implements authentication as an extension to the
OAuth 2.0 authorization process.
Use of this extension is requested by Clients by including
the openid scope value
in the Authorization Request.
Information about the authentication performed is returned
in a [JSON Web Token (JWT) (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Token (JWT),” May 2015.)](#JWT) [JWT]
called an ID Token (see [Section 2 (ID Token)](#IDToken)).
OAuth 2.0 Authentication Servers implementing OpenID Connect
are also referred to as OpenID Providers (OPs).
OAuth 2.0 Clients using OpenID Connect
are also referred to as Relying Parties (RPs).

This specification assumes that the Relying Party has already obtained
configuration information about the OpenID Provider, including its
Authorization Endpoint and Token Endpoint locations.
This information is normally obtained via Discovery,
as described in [OpenID Connect Discovery 1.0 (Sakimura, N., Bradley, J., Jones, M., and E. Jay, “OpenID Connect Discovery 1.0,” December 2023.)](#OpenID.Discovery) [OpenID.Discovery],
or may be obtained via other mechanisms.

Likewise, this specification assumes that the Relying Party has already obtained
sufficient credentials and provided information needed to use the OpenID Provider.
This is normally done via Dynamic Registration,
as described in
[OpenID Connect Dynamic Client Registration 1.0 (Sakimura, N., Bradley, J., and M. Jones, “OpenID Connect Dynamic Client Registration 1.0,” December 2023.)](#OpenID.Registration) [OpenID.Registration],
or may be obtained via other mechanisms.

The previous versions of this specification are:

* [OpenID Connect Core 1.0 incorporating errata set 1 (Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore, “OpenID Connect Core 1.0 incorporating errata set 1,” November 2014.)](#OpenID.Core.Errata1) [OpenID.Core.Errata1]
* [OpenID Connect Core 1.0 (final) (Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore, “OpenID Connect Core 1.0 (final),” February 2014.)](#OpenID.Core.Final) [OpenID.Core.Final]

---

| [TOC](#toc) |
| --- |

### 1.1.  Requirements Notation and Conventions

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in [RFC 2119 (Bradner, S., “Key words for use in RFCs to Indicate Requirement Levels,” March 1997.)](#RFC2119) [RFC2119].

In the .txt version of this specification,
values are quoted to indicate that they are to be taken literally.
When using these values in protocol messages,
the quotes MUST NOT be used as part of the value.
In the HTML version of this specification,
values to be taken literally are indicated by
the use of this fixed-width font.

All uses of [JSON Web Signature (JWS) (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Signature (JWS),” May 2015.)](#JWS) [JWS]
and [JSON Web Encryption (JWE) (Jones, M. and J. Hildebrand, “JSON Web Encryption (JWE),” May 2015.)](#JWE) [JWE]
data structures in this specification utilize
the JWS Compact Serialization or the JWE Compact Serialization;
the JWS JSON Serialization and the JWE JSON Serialization are not used.

---

| [TOC](#toc) |
| --- |

### 1.2.  Terminology

This specification uses the terms "Access Token", "Authorization Code",
"Authorization Endpoint", "Authorization Grant", "Authorization Server",
"Client", "Client Authentication", "Client Identifier", "Client Secret",
"Grant Type", "Protected Resource", "Redirection URI", "Refresh Token",
"Resource Server", "Response Type", and "Token Endpoint"
defined by [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749],
the terms "Claim Name", "Claim Value", "JSON Web Token (JWT)",
"JWT Claims Set", and "Nested JWT"
defined by [JSON Web Token (JWT) (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Token (JWT),” May 2015.)](#JWT) [JWT],
the terms "Base64url Encoding", "Header Parameter", and "JOSE Header"
defined by [JSON Web Signature (JWS) (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Signature (JWS),” May 2015.)](#JWS) [JWS],
the term "User Agent" defined by [RFC 7230 (Fielding, R., Ed. and J. Reschke, Ed., “Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing,” June 2014.)](#RFC7230) [RFC7230],
and the term "Response Mode" defined by
[OAuth 2.0 Multiple Response Type Encoding Practices (de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, “OAuth 2.0 Multiple Response Type Encoding Practices,” February 2014.)](#OAuth.Responses) [OAuth.Responses].

This specification also defines the following terms:

> Authentication
> Process used to achieve sufficient confidence in the binding
> between the Entity and the presented Identity.
>
> Authentication Request
> OAuth 2.0 Authorization Request using extension parameters and scopes
> defined by OpenID Connect to request that the End-User be authenticated
> by the Authorization Server, which is an OpenID Connect Provider,
> to the Client, which is an OpenID Connect Relying Party.
>
> Authentication Context
> Information that the Relying Party can require before it makes an
> entitlement decision with respect to an authentication response.
> Such context can include, but is not limited to, the actual
> authentication method used or level of assurance such as
> [ISO/IEC 29115 (International Organization for Standardization, “ISO/IEC 29115:2013. Information technology - Security techniques - Entity authentication assurance framework,” April 2013.)](#ISO29115) [ISO29115]
> entity authentication assurance level.
>
> Authentication Context Class
> Set of authentication methods or procedures that are considered
> to be equivalent to each other in a particular context.
>
> Authentication Context Class Reference
> Identifier for an Authentication Context Class.
>
> Authorization Code Flow
> OAuth 2.0 flow in which
> an Authorization Code is returned from the Authorization Endpoint and
> all tokens are returned from the Token Endpoint.
>
> Authorization Request
> OAuth 2.0 Authorization Request as defined by [[RFC6749] (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749).
>
> Claim
> Piece of information asserted about an Entity.
>
> Claim Type
> Syntax used for representing a Claim Value.
> This specification defines Normal, Aggregated, and Distributed Claim Types.
>
> Claims Provider
> Server that can return Claims about an Entity.
>
> Credential
> Data presented as evidence of the right to use an identity
> or other resources.
>
> End-User
> Human participant.
>
> Entity
> Something that has a separate and distinct existence and that can be
> identified in a context. An End-User is one example of an Entity.
>
> Essential Claim
> Claim specified by the Client as being necessary to ensure a smooth
> authorization experience for the specific task requested by the End-User.
>
> Hybrid Flow
> OAuth 2.0 flow in which
> an Authorization Code is returned from the Authorization Endpoint,
> some tokens are returned from the Authorization Endpoint,
> and others are returned from the Token Endpoint.
>
> ID Token
> [JSON Web Token (JWT) (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Token (JWT),” May 2015.)](#JWT) [JWT] that contains Claims about the Authentication event.
> It MAY contain other Claims.
>
> Identifier
> Value that uniquely characterizes an Entity in a specific context.
>
> Identity
> Set of attributes related to an Entity.
>
> Implicit Flow
> OAuth 2.0 flow in which all tokens are returned from the Authorization Endpoint
> and neither the Token Endpoint nor an Authorization Code are used.
>
> Issuer
> Entity that issues a set of Claims.
>
> Issuer Identifier
> Verifiable Identifier for an Issuer.
> An Issuer Identifier is a case-sensitive URL
> using the https scheme that
> contains scheme, host, and optionally, port number and path
> components and no query or fragment components.
>
> Message
> Request or a response between an OpenID
> Relying Party and an OpenID Provider.
>
> OpenID Provider (OP)
> OAuth 2.0 Authorization Server that is capable of
> Authenticating the End-User and
> providing Claims to a Relying Party
> about the Authentication event and the End-User.
>
> Request Object
> JWT that contains a set of request parameters as its Claims.
>
> Request URI
> URL that references a resource containing a Request Object.
> The Request URI contents MUST be retrievable by the
> Authorization Server.
>
> Pairwise Pseudonymous Identifier (PPID)
> Identifier that identifies the Entity to a Relying Party that cannot be correlated
> with the Entity's PPID at another Relying Party.
>
> Personally Identifiable Information (PII)
> Information that (a) can be used to identify the natural person
> to whom such information relates, or
> (b) is or might be directly or indirectly linked to a
> natural person to whom such information relates.
>
> Relying Party (RP)
> OAuth 2.0 Client application requiring End-User Authentication
> and Claims from an OpenID Provider.
>
> Sector Identifier
> Host component of a URL used by the Relying Party's organization
> that is an input to the computation of pairwise Subject Identifiers
> for that Relying Party.
>
> Self-Issued OpenID Provider
> Personal, self-hosted OpenID Provider that issues self-signed ID Tokens.
>
> Subject Identifier
> Locally unique and never
> reassigned identifier within the Issuer for the End-User,
> which is intended to be consumed by the Client.
>
> UserInfo Endpoint
> Protected Resource that, when presented with an Access Token by the Client,
> returns authorized information about the End-User represented by the corresponding
> Authorization Grant.
> The UserInfo Endpoint
> URL MUST use the https scheme and MAY contain
> port, path, and query parameter components.
>
> Validation
> Process intended to establish the soundness or correctness of a construct.
>
> Verification
> Process intended to test or prove the truth or accuracy of a fact or value.
>
> Voluntary Claim
> Claim specified by the Client as being useful but not Essential
> for the specific task requested by the End-User.

IMPORTANT NOTE TO READERS: The terminology definitions in
this section are a normative portion of this specification,
imposing requirements upon implementations. All the
capitalized words in the text of this specification, such as
"Issuer Identifier", reference these defined terms.
Whenever the reader encounters them, their definitions
found in this section must be followed.

For more background on some of the terminology used,
see [Internet Security Glossary, Version 2 (Shirey, R., “Internet Security Glossary, Version 2,” August 2007.)](#RFC4949) [RFC4949],
[ISO/IEC 29115 Entity Authentication Assurance (International Organization for Standardization, “ISO/IEC 29115:2013. Information technology - Security techniques - Entity authentication assurance framework,” April 2013.)](#ISO29115) [ISO29115],
and [ITU-T X.1252 (International Telecommunication Union, “ITU-T Recommendation X.1252 - Cyberspace security - Identity management - Baseline identity management terms and definitions,” April 2010.)](#X.1252) [X.1252].

---

| [TOC](#toc) |
| --- |

### 1.3.  Overview

The OpenID Connect protocol, in abstract, follows the following
steps.

1. The RP (Client) sends a request to the OpenID Provider (OP).
2. The OP authenticates the End-User and obtains authorization.
3. The OP responds with an ID Token and usually an Access Token.
4. The RP can send a request with the Access Token to the UserInfo Endpoint.
5. The UserInfo Endpoint returns Claims about the End-User.

These steps are illustrated in the following diagram:

```

+--------+                                   +--------+
|        |                                   |        |
|        |---------(1) AuthN Request-------->|        |
|        |                                   |        |
|        |  +--------+                       |        |
|        |  |        |                       |        |
|        |  |  End-  |<--(2) AuthN & AuthZ-->|        |
|        |  |  User  |                       |        |
|   RP   |  |        |                       |   OP   |
|        |  +--------+                       |        |
|        |                                   |        |
|        |<--------(3) AuthN Response--------|        |
|        |                                   |        |
|        |---------(4) UserInfo Request----->|        |
|        |                                   |        |
|        |<--------(5) UserInfo Response-----|        |
|        |                                   |        |
+--------+                                   +--------+

```

---

| [TOC](#toc) |
| --- |

### 2.  ID Token

The primary extension that OpenID Connect makes to OAuth 2.0
to enable End-Users to be Authenticated
is the ID Token data structure.
The ID Token is a security token that contains Claims about the
Authentication of an End-User by an Authorization Server when using a Client,
and potentially other requested Claims.
The ID Token is represented as a
[JSON Web Token (JWT) (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Token (JWT),” May 2015.)](#JWT) [JWT].

The following Claims are used within the ID Token
for all OAuth 2.0 flows used by OpenID Connect:

> iss
> REQUIRED.
> Issuer Identifier for the Issuer of the response.
> The iss value is a case-sensitive URL
> using the https scheme that
> contains scheme, host, and optionally, port number and path
> components and no query or fragment components.
>
> sub
> REQUIRED.
> Subject Identifier. A locally unique and never
> reassigned identifier within the Issuer for the End-User,
> which is intended to be consumed by the Client,
> e.g., 24400320
> or AItOawmwtWwcT0k51BayewNvutrJUqsvl6qs7A4.
> It MUST NOT exceed 255 ASCII [[RFC20] (Cerf, V., “ASCII format for Network Interchange,” October 1969.)](#RFC20) characters in length.
> The sub value is a case-sensitive string.
>
> aud
> REQUIRED.
> Audience(s) that this ID Token is intended for.
> It MUST contain the OAuth 2.0 client\_id
> of the Relying Party as an audience value.
> It MAY also contain identifiers for other audiences.
> In the general case,
> the aud value is an array of
> case-sensitive strings.
> In the common special case when there is one audience,
> the aud value MAY be a single
> case-sensitive string.
>
> exp
> REQUIRED.
> Expiration time on or after which the ID Token MUST NOT be
> accepted by the RP when performing authentication with the OP.
> The processing of this parameter
> requires that the current date/time MUST be before the
> expiration date/time listed in the value. Implementers MAY
> provide for some small leeway, usually no more than a few
> minutes, to account for clock skew.
> Its value is a JSON [[RFC8259] (Bray, T., Ed., “The JavaScript Object Notation (JSON) Data Interchange Format,” December 2017.)](#RFC8259) number representing the number of seconds from
> 1970-01-01T00:00:00Z as measured in UTC until the date/time.
> See [RFC 3339 (Klyne, G. and C. Newman, “Date and Time on the Internet: Timestamps,” July 2002.)](#RFC3339) [RFC3339]
> for details regarding date/times in general and UTC in
> particular.
> NOTE: The ID Token expiration time is unrelated the lifetime of
> the authenticated session between the RP and the OP.
>
> iat
> REQUIRED.
> Time at which the JWT was issued.
> Its value is a JSON number representing the number of seconds from
> 1970-01-01T00:00:00Z as measured in UTC until the date/time.
>
> auth\_time
> Time when the End-User authentication occurred.
> Its value is a JSON number representing the number of seconds from
> 1970-01-01T00:00:00Z as measured in UTC until the date/time.
> When a max\_age request is made
> or when auth\_time is requested
> as an Essential Claim,
> then this Claim is REQUIRED; otherwise, its inclusion is OPTIONAL.
> (The auth\_time Claim semantically
> corresponds to the OpenID 2.0 [PAPE (Recordon, D., Jones, M., Bufu, J., Ed., Daugherty, J., Ed., and N. Sakimura, “OpenID Provider Authentication Policy Extension 1.0,” December 2008.)](#OpenID.PAPE) [OpenID.PAPE]
> auth\_time response parameter.)
>
> nonce
> String value used to associate a Client session
> with an ID Token, and to mitigate replay attacks.
> The value is passed through unmodified from the Authentication Request to the ID Token.
> If present in the ID Token,
> Clients MUST verify that
> the nonce Claim Value is equal to
> the value of the nonce
> parameter sent in the Authentication Request.
> If present in the Authentication Request, Authorization Servers
> MUST include a nonce Claim in the
> ID Token with the Claim Value
> being the nonce value sent in the Authentication Request.
> Authorization Servers SHOULD perform no other processing
> on nonce values used.
> The nonce value is a case-sensitive string.
>
> acr
> OPTIONAL.
> Authentication Context Class Reference.
> String specifying an Authentication Context Class Reference value
> that identifies the Authentication Context Class that the
> authentication performed satisfied.
> The value "0" indicates the End-User authentication
> did not meet the requirements of
> [ISO/IEC 29115 (International Organization for Standardization, “ISO/IEC 29115:2013. Information technology - Security techniques - Entity authentication assurance framework,” April 2013.)](#ISO29115) [ISO29115] level 1.
> For historic reasons, the value "0" is used to indicate that
> there is no confidence that the same person is actually there.
> Authentications with
> level 0 SHOULD NOT be used to authorize access to any resource of any
> monetary value.
> (This corresponds to the OpenID 2.0
> [PAPE (Recordon, D., Jones, M., Bufu, J., Ed., Daugherty, J., Ed., and N. Sakimura, “OpenID Provider Authentication Policy Extension 1.0,” December 2008.)](#OpenID.PAPE) [OpenID.PAPE]
> nist\_auth\_level 0.)
> An absolute URI or an [RFC 6711 (Johansson, L., “An IANA Registry for Level of Assurance (LoA) Profiles,” August 2012.)](#RFC6711) [RFC6711]
> registered name
> SHOULD be used as the acr value;
> registered names MUST NOT be used with a different meaning than
> that which is registered.
> Parties using this claim will need to agree upon the meanings of
> the values used, which may be context specific.
> The acr value is a case-sensitive string.
>
> amr
> OPTIONAL.
> Authentication Methods References.
> JSON array of strings that are identifiers for authentication methods
> used in the authentication.
> For instance, values might indicate that both password and OTP
> authentication methods were used.
> The amr value is an array of
> case-sensitive strings.
> Values used in the
> amr Claim
> SHOULD be from those registered in the
> IANA Authentication Method Reference Values registry [[IANA.AMR] (IANA, “Authentication Method Reference Values,” .)](#IANA.AMR)
> established by [[RFC8176] (Jones, M., Hunt, P., and A. Nadalin, “Authentication Method Reference Values,” June 2017.)](#RFC8176);
> parties using this claim will need to agree upon the meanings of
> any unregistered values used, which may be context specific.
>
> azp
> OPTIONAL.
> Authorized party - the party to which the ID Token was issued.
> If present, it MUST contain the OAuth 2.0
> Client ID of this party.
> The azp value is a case-sensitive string
> containing a StringOrURI value.
> Note that in practice, the azp Claim only occurs
> when extensions beyond the scope of this specification are used;
> therefore, implementations not using such extensions
> are encouraged to not use azp
> and to ignore it when it does occur.

ID Tokens MAY contain other Claims.
Any Claims used that are not understood MUST be ignored.
See Sections
[3.1.3.6 (ID Token)](#CodeIDToken),
[3.3.2.11 (ID Token)](#HybridIDToken),
[5.1 (Standard Claims)](#StandardClaims), and
[7.4 (Self-Issued OpenID Provider Response)](#SelfIssuedResponse)
for additional Claims defined by this specification.

ID Tokens MUST be signed using [JWS (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Signature (JWS),” May 2015.)](#JWS) [JWS] and optionally both signed and then
encrypted using [JWS (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Signature (JWS),” May 2015.)](#JWS) [JWS] and [JWE (Jones, M. and J. Hildebrand, “JSON Web Encryption (JWE),” May 2015.)](#JWE) [JWE] respectively, thereby providing
authentication, integrity,
non-repudiation, and optionally, confidentiality,
per [Section 16.14 (Signing and Encryption Order)](#SigningOrder).
If the ID Token is encrypted, it MUST be signed then encrypted,
with the result being a Nested JWT, as defined in [[JWT] (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Token (JWT),” May 2015.)](#JWT).
ID Tokens MUST NOT use none
as the alg value
unless the Response Type used returns no ID Token from the
Authorization Endpoint
(such as when using the Authorization Code Flow)
and the Client explicitly requested the use of
none at Registration time.

ID Tokens SHOULD NOT use the JWS or JWE
x5u,
x5c,
jku, or
jwk
Header Parameter fields.
Instead, references to keys used are
communicated in advance using Discovery and Registration parameters,
per [Section 10 (Signatures and Encryption)](#SigEnc).

The following is a non-normative example of
the set of Claims (the JWT Claims Set) in an ID Token:

```

  {
   "iss": "https://server.example.com",
   "sub": "24400320",
   "aud": "s6BhdRkqt3",
   "nonce": "n-0S6_WzA2Mj",
   "exp": 1311281970,
   "iat": 1311280970,
   "auth_time": 1311280969,
   "acr": "urn:mace:incommon:iap:silver"
  }

```

---

| [TOC](#toc) |
| --- |

### 3.  Authentication

OpenID Connect performs authentication to log in the End-User
or to determine that the End-User is already logged in.
OpenID Connect returns the result of the Authentication
performed by the Server to the Client in a secure manner
so that the Client can rely on it.
For this reason, the Client is called Relying Party (RP) in this case.

The Authentication result is returned in an
ID Token, as defined in [Section 2 (ID Token)](#IDToken).
It has Claims expressing such information as the Issuer,
the Subject Identifier, when the authentication was performed, etc.

Authentication can follow one of three paths:
the Authorization Code Flow (response\_type=code),
the Implicit Flow (response\_type=id\_token token
or response\_type=id\_token), or
the Hybrid Flow (using other Response Type values defined in
[OAuth 2.0 Multiple Response Type Encoding Practices (de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, “OAuth 2.0 Multiple Response Type Encoding Practices,” February 2014.)](#OAuth.Responses) [OAuth.Responses]).
The flows determine how the ID Token and Access Token
are returned to the Client.

The characteristics of the three flows are summarized
in the following non-normative table.
The table is intended to provide some guidance on which flow to choose
in particular contexts.

---

| Property | Authorization Code Flow | Implicit Flow | Hybrid Flow |
| All tokens returned from Authorization Endpoint | no | yes | no |
| All tokens returned from Token Endpoint | yes | no | no |
| Tokens not revealed to User Agent | yes | no | no |
| Client can be authenticated | yes | no | yes |
| Refresh Token possible | yes | no | yes |
| Communication in one round trip | no | yes | no |
| Most communication server-to-server | yes | no | varies |

| **OpenID Connect Authentication Flows** |
| --- |

---

The flow used is determined by the response\_type
value contained in the Authorization Request.
These response\_type values select
these flows:

---

| "response\_type" value | Flow |
| code | Authorization Code Flow |
| id\_token | Implicit Flow |
| id\_token token | Implicit Flow |
| code id\_token | Hybrid Flow |
| code token | Hybrid Flow |
| code id\_token token | Hybrid Flow |

| **OpenID Connect "response\_type" Values** |
| --- |

---

All but the code Response Type value,
which is defined by [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749],
are defined in the
[OAuth 2.0 Multiple Response Type Encoding Practices (de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, “OAuth 2.0 Multiple Response Type Encoding Practices,” February 2014.)](#OAuth.Responses) [OAuth.Responses]
specification.
NOTE: While OAuth 2.0 also defines the
token Response Type value
for the Implicit Flow, OpenID Connect does not use this Response Type,
since no ID Token would be returned.

---

| [TOC](#toc) |
| --- |

### 3.1.  Authentication using the Authorization Code Flow

This section describes how to perform authentication using the Authorization Code Flow.
When using the Authorization Code Flow,
all tokens are returned from the Token Endpoint.

The Authorization Code Flow returns an Authorization Code to the
Client, which can then exchange it for an ID Token and an Access Token directly.
This provides the benefit of not exposing any tokens to the
User Agent and possibly other malicious applications with access
to the User Agent.
The Authorization Server can also
authenticate the Client before exchanging the Authorization Code for an
Access Token. The Authorization Code flow is suitable for Clients that
can securely maintain a Client Secret between themselves and the
Authorization Server.

---

| [TOC](#toc) |
| --- |

### 3.1.1.  Authorization Code Flow Steps

The Authorization Code Flow goes through the following
steps.

1. Client prepares an Authentication Request containing the desired
   request parameters.
2. Client sends the request to the Authorization Server.
3. Authorization Server Authenticates the End-User.
4. Authorization Server obtains End-User Consent/Authorization.
5. Authorization Server sends the End-User back to the Client with
   an Authorization Code.
6. Client requests a response using the Authorization Code at the
   Token Endpoint.
7. Client receives a response that contains an ID Token
   and Access Token in the response body.
8. Client validates the ID token and retrieves the End-User's
   Subject Identifier.

---

| [TOC](#toc) |
| --- |

### 3.1.2.  Authorization Endpoint

The Authorization Endpoint performs Authentication of the
End-User.
This is done by sending the User Agent to
the Authorization Server's Authorization Endpoint for Authentication and
Authorization, using request parameters defined by OAuth 2.0 and
additional parameters and parameter values defined by OpenID Connect.

Communication with the Authorization Endpoint MUST utilize TLS.
See [Section 16.17 (TLS Requirements)](#TLSRequirements) for more information on using TLS.

---

| [TOC](#toc) |
| --- |

### 3.1.2.1.  Authentication Request

An Authentication Request is
an OAuth 2.0 Authorization Request that requests that the End-User
be authenticated by the Authorization Server.

Authorization Servers MUST support the use of the HTTP GET and
POST methods defined in [RFC 7231 (Fielding, R., Ed. and J. Reschke, Ed., “Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content,” June 2014.)](#RFC7231) [RFC7231] at the
Authorization Endpoint.
Clients MAY use the HTTP GET or
POST methods to send the
Authorization Request to the Authorization Server. If using the HTTP
GET method, the request parameters are serialized using
URI Query String Serialization, per [Section 13.1 (Query String Serialization)](#QuerySerialization).
If using the HTTP POST
method, the request parameters are serialized using
Form Serialization, per [Section 13.2 (Form Serialization)](#FormSerialization).

OpenID Connect uses the following OAuth 2.0 request parameters with
the Authorization Code Flow:

> scope
> REQUIRED.
> OpenID Connect requests MUST contain the openid scope value.
> If the openid scope value is not present,
> the behavior is entirely unspecified.
> Other scope values MAY be present.
> Scope values used that are not understood by an implementation SHOULD be ignored.
> See Sections [5.4 (Requesting Claims using Scope Values)](#ScopeClaims)
> and [11 (Offline Access)](#OfflineAccess)
> for additional scope values defined by this specification.
>
> response\_type
> REQUIRED.
> OAuth 2.0 Response Type value that determines
> the authorization processing flow to be used,
> including what parameters are returned from the endpoints used.
> When using the Authorization Code Flow, this value is
> code.
>
> client\_id
> REQUIRED.
> OAuth 2.0 Client Identifier
> valid at the Authorization Server.
>
> redirect\_uri
> REQUIRED.
> Redirection URI to which the response will be sent.
> This URI MUST exactly match one of the Redirection URI values
> for the Client pre-registered at the OpenID Provider,
> with the matching performed as described in
> Section 6.2.1 of [[RFC3986] (Berners-Lee, T., Fielding, R., and L. Masinter, “Uniform Resource Identifier (URI): Generic Syntax,” January 2005.)](#RFC3986) (Simple String Comparison).
> When using this flow, the Redirection URI
> SHOULD use the https scheme;
> however, it MAY use the http scheme,
> provided that the Client Type is
> confidential,
> as defined in Section 2.1 of OAuth 2.0, and
> provided the OP allows the use of
> http Redirection URIs in this case.
> Also, if the Client is a native application,
> it MAY use the http scheme with
> localhost or the IP loopback literals
> 127.0.0.1 or [::1]
> as the hostname.
> The Redirection URI MAY use an alternate scheme,
> such as one that is intended to identify a callback into a native application.
>
> state
> RECOMMENDED.
> Opaque value used
> to maintain state between the request and the callback.
> Typically, Cross-Site Request Forgery (CSRF, XSRF)
> mitigation is done by cryptographically binding the value of
> this parameter with a browser cookie.

OpenID Connect also uses the following OAuth 2.0 request parameter,
which is defined in
[OAuth 2.0 Multiple Response Type Encoding Practices (de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, “OAuth 2.0 Multiple Response Type Encoding Practices,” February 2014.)](#OAuth.Responses) [OAuth.Responses]:

> response\_mode
> OPTIONAL.
> Informs the Authorization Server of the mechanism to be used
> for returning parameters from the Authorization Endpoint.
> This use of this parameter is NOT RECOMMENDED when the Response Mode
> that would be requested is the default mode specified for the Response Type.

This specification also defines the following request parameters:

> nonce
> OPTIONAL.
> String value used to associate a Client session
> with an ID Token, and to mitigate replay attacks.
> The value is passed through unmodified from the Authentication Request to the ID Token.
> Sufficient entropy MUST be present in the
> nonce values used to prevent
> attackers from guessing values.
> For implementation notes, see [Section 15.5.2 (Nonce Implementation Notes)](#NonceNotes).
>
> display
> OPTIONAL.
> ASCII string value that specifies
> how the Authorization Server displays the authentication and
> consent user interface pages to the End-User.
> The defined values are:
> > page
> > The Authorization Server SHOULD display the
> > authentication and consent UI consistent with a full User Agent page
> > view. If the display parameter is not specified, this is the
> > default display mode.
> >
> > popup
> > The Authorization Server SHOULD display the
> > authentication and consent UI consistent with a popup User Agent
> > window.
> > The popup User Agent window should be of an appropriate size
> > for a login-focused dialog and should not obscure
> > the entire window that it is popping up over.
> >
> > touch
> > The Authorization Server SHOULD display the
> > authentication and consent UI consistent with a device that
> > leverages a touch interface.
> >
> > wap
> > The Authorization Server SHOULD display the
> > authentication and consent UI consistent with a "feature phone"
> > type display.
>
>
>
> The Authorization Server MAY also attempt to detect the capabilities
> of the User Agent and present an appropriate display.
>
>
> If an OP receives a display value
> outside the set defined above that it does not understand,
> it MAY return an error or it MAY ignore it;
> in practice, not returning errors for not-understood values
> will help facilitate phasing in extensions using new
> display values.
>
> prompt
> OPTIONAL.
> Space-delimited, case-sensitive list of ASCII string values
> that specifies whether the Authorization Server prompts
> the End-User for reauthentication and consent.
> The defined values are:
> > none
> > The Authorization Server
> > MUST NOT display any authentication or consent
> > user interface pages.
> > An error is returned
> > if an End-User
> > is not already authenticated or the Client does not have
> > pre-configured consent for the requested
> > Claims or does not fulfill other conditions for processing the request.
> > The error code will typically be
> > login\_required,
> > interaction\_required,
> > or another code defined in [Section 3.1.2.6 (Authentication Error Response)](#AuthError).
> > This can be used as a
> > method to check for existing authentication and/or consent.
> >
> > login
> > The Authorization Server SHOULD prompt the
> > End-User for reauthentication.
> > If it cannot reauthenticate the End-User, it MUST return an error,
> > typically login\_required.
> >
> > consent
> > The Authorization Server SHOULD prompt the End-User for consent
> > before returning information to the Client.
> > If it cannot obtain consent, it MUST return an error,
> > typically consent\_required.
> >
> > select\_account
> > The Authorization Server SHOULD
> > prompt the End-User to select a user account. This enables
> > an End-User who has multiple accounts at the Authorization Server
> > to select amongst the multiple accounts that they might have
> > current sessions for.
> > If it cannot obtain an account selection choice made by the End-User,
> > it MUST return an error,
> > typically account\_selection\_required.
>
>
>
> The prompt parameter
> can be used by the Client to make sure that the End-User is
> still present for the current session or to bring attention to the
> request. If this parameter contains none
> with any other value, an
> error is returned.
>
>
> If an OP receives a prompt value
> outside the set defined above that it does not understand,
> it MAY return an error or it MAY ignore it;
> in practice, not returning errors for not-understood values
> will help facilitate phasing in extensions using new
> prompt values.
>
> max\_age
> OPTIONAL.
> Maximum Authentication Age.
> Specifies the allowable elapsed time in seconds
> since the last time the End-User was actively
> authenticated by the OP. If the elapsed time is greater than
> this value, the OP MUST attempt to actively
> re-authenticate the End-User.
> (The max\_age request parameter corresponds to
> the OpenID 2.0 [PAPE (Recordon, D., Jones, M., Bufu, J., Ed., Daugherty, J., Ed., and N. Sakimura, “OpenID Provider Authentication Policy Extension 1.0,” December 2008.)](#OpenID.PAPE) [OpenID.PAPE]
> max\_auth\_age request parameter.)
> When max\_age is used, the ID Token returned
> MUST include an auth\_time Claim Value.
> Note that max\_age=0 is equivalent
> to prompt=login.
>
> ui\_locales
> OPTIONAL.
> End-User's preferred languages and scripts for the user interface,
> represented as a space-separated list of
> [BCP47 (Phillips, A., Ed. and M. Davis, Ed., “Tags for Identifying Languages,” September 2009.)](#RFC5646) [RFC5646] language tag values,
> ordered by preference.
> For instance, the value "fr-CA fr en" represents a preference
> for French as spoken in Canada,
> then French (without a region designation),
> followed by English (without a region designation).
> An error SHOULD NOT result if some or all of the requested locales
> are not supported by the OpenID Provider.
>
> id\_token\_hint
> OPTIONAL.
> ID Token previously issued by the Authorization Server
> being passed as a hint about the End-User's current or past
> authenticated session with the Client.
> If the End-User identified by the ID Token is already logged in
> or is logged in as a result of the request
> (with the OP possibly evaluating other information beyond the ID Token in this decision),
> then the Authorization Server returns a positive response;
> otherwise, it MUST return
> an error, such as login\_required.
> When possible, an id\_token\_hint
> SHOULD be present when prompt=none is used
> and an invalid\_request error
> MAY be returned if it is not;
> however, the server SHOULD respond successfully when possible,
> even if it is not present.
> The Authorization Server need not be listed as an
> audience of the ID Token when it is used as an
> id\_token\_hint value.
>
>
> If the ID Token received by the RP from the OP is encrypted,
> to use it as an id\_token\_hint, the Client MUST
> decrypt the signed ID Token contained within the encrypted ID Token.
> The Client MAY re-encrypt the signed ID token to the Authentication Server
> using a key that enables the server to decrypt the ID Token
> and use the re-encrypted ID token as the
> id\_token\_hint value.
>
> login\_hint
> OPTIONAL.
> Hint to the Authorization Server
> about the login identifier the End-User might use to log in (if necessary).
> This hint can be used by an RP if it first asks the End-User for their e-mail
> address (or other identifier) and then wants to pass that value as a hint
> to the discovered authorization service.
> It is RECOMMENDED that the hint value match the value used for discovery.
> This value MAY also be a phone number in the format specified for the
> phone\_number Claim.
> The use of this parameter is left to the OP's discretion.
>
> acr\_values
> OPTIONAL.
> Requested Authentication Context Class Reference values.
> Space-separated string that specifies the acr
> values that the Authorization Server is being requested to use
> for processing this Authentication Request,
> with the values appearing in order of preference.
> The Authentication Context Class satisfied by the authentication
> performed is returned as the acr Claim Value,
> as specified in [Section 2 (ID Token)](#IDToken).
> The acr Claim is requested as
> a Voluntary Claim by this parameter.

Other parameters MAY be sent.
See Sections [3.2.2 (Authorization Endpoint)](#ImplicitAuthorizationEndpoint),
[3.3.2 (Authorization Endpoint)](#HybridAuthorizationEndpoint),
[5.2 (Claims Languages and Scripts)](#ClaimsLanguagesAndScripts),
[5.5 (Requesting Claims using the "claims" Request Parameter)](#ClaimsParameter),
[6 (Passing Request Parameters as JWTs)](#JWTRequests), and
[7.2.1 (Providing Information with the "registration" Request Parameter)](#RegistrationParameter)
for additional Authorization Request parameters and parameter values
defined by this specification.

The following is a non-normative example
HTTP 302 redirect response by the Client, which triggers
the User Agent to make an Authentication Request
to the Authorization Endpoint
(with line wraps within values for display purposes only):

```

  HTTP/1.1 302 Found
  Location: https://server.example.com/authorize?
    response_type=code
    &scope=openid%20profile%20email
    &client_id=s6BhdRkqt3
    &state=af0ifjsldkj
    &redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb

```

The following is the non-normative example request
that would be sent by the User Agent to the Authorization Server
in response to the HTTP 302 redirect response by the Client above
(with line wraps within values for display purposes only):

```

  GET /authorize?
    response_type=code
    &scope=openid%20profile%20email
    &client_id=s6BhdRkqt3
    &state=af0ifjsldkj
    &redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb HTTP/1.1
  Host: server.example.com

```

---

| [TOC](#toc) |
| --- |

### 3.1.2.2.  Authentication Request Validation

The Authorization Server MUST validate the request received as follows:

1. The Authorization Server MUST validate all the
   OAuth 2.0 parameters according to the OAuth 2.0 specification.
2. Verify that a scope parameter is present
   and contains the openid scope value.
   (If no openid scope value is present,
   the request may still be a valid OAuth 2.0 request
   but is not an OpenID Connect request.)
3. The Authorization Server MUST verify that all the REQUIRED parameters
   are present
   and their usage conforms to this specification.
4. If the sub (subject) Claim
   is requested with a specific value for the ID Token,
   the Authorization Server MUST only send a positive response
   if the End-User identified by that sub value
   has an active session with the Authorization Server
   or has been Authenticated as a result of the request.
   The Authorization Server MUST NOT reply with an ID Token or
   Access Token for a different user,
   even if they have an active session with the Authorization Server.
   Such a request can be made either using an
   id\_token\_hint parameter
   or by requesting a specific Claim Value
   as described in [Section 5.5.1 (Individual Claims Requests)](#IndividualClaimsRequests),
   if the claims parameter
   is supported by the implementation.
5. When an id\_token\_hint is present,
   the OP MUST validate that it was the issuer of the ID Token.
   The OP SHOULD accept ID Tokens when the RP identified by the ID Token
   has a current session or had a recent session at the OP,
   even when the exp time has passed.

As specified in [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749],
Authorization Servers SHOULD ignore unrecognized request parameters.

If the Authorization Server encounters any error,
it MUST return an error response, per [Section 3.1.2.6 (Authentication Error Response)](#AuthError).

---

| [TOC](#toc) |
| --- |

### 3.1.2.3.  Authorization Server Authenticates End-User

If the request is valid, the Authorization Server attempts
to Authenticate the End-User or determines whether the End-User is Authenticated,
depending upon the request parameter values used.
The methods used by the Authorization Server to Authenticate the End-User
(e.g., username and password, session cookies, etc.)
are beyond the scope of this specification.
An Authentication user interface MAY be displayed by
the Authorization Server, depending upon the request parameter values used
and the authentication methods used.

The Authorization Server MUST attempt to Authenticate the
End-User in the following cases:

* The End-User is not already Authenticated.
* The Authentication Request contains the prompt parameter with the value
  login. In this case, the
  Authorization Server MUST reauthenticate the End-User
  even if the End-User is already authenticated.

The Authorization Server MUST NOT interact with the End-User
in the following case:

* The Authentication Request contains the prompt parameter with the value
  none. In this case,
  the Authorization Server MUST return
  an error if an End-User
  is not already Authenticated or could not be silently Authenticated.

When interacting with the End-User,
the Authorization Server MUST employ appropriate measures against
Cross-Site Request Forgery and Clickjacking as, described in
Sections 10.12 and 10.13 of [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749].

---

| [TOC](#toc) |
| --- |

### 3.1.2.4.  Authorization Server Obtains End-User Consent/Authorization

Once the End-User is authenticated, the Authorization Server MUST
obtain an authorization decision before releasing information
to the Relying Party.
When permitted by the request parameters used,
this MAY be done through an interactive dialogue with the End-User
that makes it clear what is being consented to
or by establishing consent via conditions for processing the request or
other means (for example, via previous administrative consent).
Sections [2 (ID Token)](#IDToken) and
[5.3 (UserInfo Endpoint)](#UserInfo) describe
information release mechanisms.

---

| [TOC](#toc) |
| --- |

### 3.1.2.5.  Successful Authentication Response

An Authentication Response is an OAuth 2.0 Authorization Response
message returned from the
OP's Authorization Endpoint in response to the Authorization Request
message sent by the RP.

When using the Authorization Code Flow, the Authorization Response
MUST return the parameters defined in Section 4.1.2 of
[OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749]
by adding them as query parameters to the
redirect\_uri specified in the Authorization Request
using the application/x-www-form-urlencoded format,
unless a different Response Mode was specified.

The following is a non-normative example
successful response using this flow
(with line wraps within values for display purposes only):

```

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb?
    code=SplxlOBeZQQYbYS6WxSbIA
    &state=af0ifjsldkj

```

For implementation notes on the contents of
the Authorization Code, see [Section 15.5.1 (Authorization Code Implementation Notes)](#CodeNotes).

---

| [TOC](#toc) |
| --- |

### 3.1.2.6.  Authentication Error Response

An Authentication Error Response is an OAuth 2.0 Authorization Error Response
message returned from the
OP's Authorization Endpoint in response to the Authorization Request
message sent by the RP.

If the End-User denies the request or the End-User authentication
fails, the OP (Authorization Server) informs the RP (Client)
by using the Error Response parameters defined in
Section 4.1.2.1 of [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749].
(HTTP errors unrelated to RFC 6749 are returned to the User Agent using the
appropriate HTTP status code.)

Unless the Redirection URI is invalid,
the Authorization Server returns the Client to
the Redirection URI specified in the Authorization Request
with the appropriate error and state parameters.
Other parameters SHOULD NOT be returned.
If the Redirection URI is invalid,
the Authorization Server MUST NOT redirect
the User Agent to the invalid Redirection URI.

If the Response Mode value is not supported,
the Authorization Server returns
an HTTP response code of 400 (Bad Request)
without Error Response parameters,
since understanding the Response Mode is necessary
to know how to return those parameters.

In addition to the error codes defined in Section 4.1.2.1 of
OAuth 2.0, this specification also defines the following error codes:

> interaction\_required
> The Authorization Server
> requires End-User interaction of some form to proceed.
> This error MAY be returned when the
> prompt parameter value in the
> Authentication Request is none,
> but the Authentication Request cannot be completed
> without displaying a user interface for End-User interaction.
>
> login\_required
> The Authorization Server requires
> End-User authentication. This error MAY be returned when the
> prompt parameter value in the
> Authentication Request is none,
> but the Authentication Request cannot be completed
> without displaying a user interface for End-User authentication.
>
> account\_selection\_required
> The End-User is REQUIRED
> to select a session at the Authorization Server. The End-User MAY
> be authenticated at the Authorization Server with different
> associated accounts, but the End-User did not select a session.
> This error MAY be returned
> when the prompt parameter value in the
> Authentication Request is none,
> but the Authentication Request cannot be completed
> without displaying a user interface to prompt for a session to use.
>
> consent\_required
> The Authorization Server
> requires End-User consent. This error MAY be returned when the
> prompt parameter value in the
> Authentication Request is none,
> but the Authentication Request cannot be completed
> without displaying a user interface for End-User consent.
>
> invalid\_request\_uri
> The
> request\_uri in
> the Authorization Request returns an error or contains invalid data.
>
> invalid\_request\_object
> The
> request parameter contains an invalid
> Request Object.
>
> request\_not\_supported
> The OP does not support use of the
> request parameter
> defined in [Section 6 (Passing Request Parameters as JWTs)](#JWTRequests).
>
> request\_uri\_not\_supported
> The OP does not support use of the
> request\_uri parameter
> defined in [Section 6 (Passing Request Parameters as JWTs)](#JWTRequests).
>
> registration\_not\_supported
> The OP does not support use of the
> registration parameter
> defined in [Section 7.2.1 (Providing Information with the "registration" Request Parameter)](#RegistrationParameter).

The error response parameters are the following:

> error
> REQUIRED. Error code.
>
> error\_description
> OPTIONAL. Human-readable ASCII
> encoded text description of the error.
>
> error\_uri
> OPTIONAL. URI of a web page that
> includes additional information about the error.
>
> state
> OAuth 2.0 state value.
> REQUIRED if the Authorization Request
> included the state parameter. Set
> to the value received from the Client.

When using the Authorization Code Flow, the error response
parameters are added to the query component of the Redirection URI,
unless a different Response Mode was specified.

The following is a non-normative example
error response using this flow
(with line wraps within values for display purposes only):

```

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb?
    error=invalid_request
    &error_description=
      Unsupported%20response_type%20value
    &state=af0ifjsldkj

```

---

| [TOC](#toc) |
| --- |

### 3.1.2.7.  Authentication Response Validation

When using the Authorization Code Flow,
the Client MUST validate the response according to RFC 6749,
especially Sections 4.1.2 and 10.12.

---

| [TOC](#toc) |
| --- |

### 3.1.3.  Token Endpoint

To obtain an Access Token, an ID Token, and optionally a Refresh Token,
the RP (Client) sends a Token Request to the Token Endpoint
to obtain a Token Response, as described in
Section 3.2 of [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749],
when using the Authorization Code Flow.

Communication with the Token Endpoint MUST utilize TLS.
See [Section 16.17 (TLS Requirements)](#TLSRequirements) for more information on using TLS.

---

| [TOC](#toc) |
| --- |

### 3.1.3.1.  Token Request

A Client makes a Token Request by
presenting its Authorization Grant (in the form of
an Authorization Code) to the Token Endpoint
using the grant\_type value
authorization\_code, as described in
Section 4.1.3 of [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749].
If the Client is a Confidential Client, then it MUST
authenticate to the Token Endpoint using the authentication method
registered for its client\_id,
as described in [Section 9 (Client Authentication)](#ClientAuthentication).

The Client sends the parameters to the Token Endpoint
using the HTTP POST method and the
Form Serialization, per [Section 13.2 (Form Serialization)](#FormSerialization),
as described in Section 4.1.3 of
[OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749].

The following is a non-normative example of a Token Request
(with line wraps within values for display purposes only):

```

  POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

  grant_type=authorization_code&code=SplxlOBeZQQYbYS6WxSbIA
    &redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb

```

---

| [TOC](#toc) |
| --- |

### 3.1.3.2.  Token Request Validation

The Authorization Server MUST validate the Token Request as follows:

* Authenticate the Client if it was issued Client Credentials
  or if it uses another Client Authentication method,
  per [Section 9 (Client Authentication)](#ClientAuthentication).
* Ensure the
  Authorization Code was issued to the authenticated Client.
* Verify that the Authorization Code is valid.
* If possible,
  verify that the Authorization Code has not been previously used.
* Ensure that the
  redirect\_uri parameter value
  is identical to the redirect\_uri
  parameter value that was included in the initial Authorization Request.
  If the redirect\_uri parameter value
  is not present when there is only one registered
  redirect\_uri value,
  the Authorization Server MAY return an error
  (since the Client should have included the parameter)
  or MAY proceed without an error
  (since OAuth 2.0 permits the parameter to be omitted in this case).
* Verify that the Authorization Code used was issued
  in response to an OpenID Connect Authentication Request
  (so that an ID Token will be returned from the Token Endpoint).

---

| [TOC](#toc) |
| --- |

### 3.1.3.3.  Successful Token Response

After receiving and validating a valid and authorized Token Request
from the Client, the Authorization Server returns a successful
response that includes an ID Token and an Access Token. The
parameters in the successful response are defined in Section 4.1.4
of [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749].
The response uses the application/json
media type.

The OAuth 2.0 token\_type response parameter
value MUST be Bearer,
as specified in [OAuth 2.0 Bearer Token Usage (Jones, M. and D. Hardt, “The OAuth 2.0 Authorization Framework: Bearer Token Usage,” October 2012.)](#RFC6750) [RFC6750],
unless another Token Type has been negotiated with the Client.
Servers SHOULD support the Bearer Token Type;
use of other Token Types is outside the scope of this specification.
Note that the token\_type value is case insensitive.

In addition to the response parameters specified by OAuth 2.0, the following
parameters MUST be included in the response:

> id\_token
> ID Token value associated with the
> authenticated session.

All Token Responses that contain tokens, secrets, or other
sensitive information MUST include the following HTTP response header
fields and values:

---

| Header Name | Header Value |
| Cache-Control | no-store |

| **HTTP Response Headers and Values** |
| --- |

---

The following is a non-normative example of a successful Token Response.
The ID Token signature in the example can be verified with the key at
[Appendix A.7 (RSA Key Used in Examples)](#ExampleRSAKey).

```

  HTTP/1.1 200 OK
  Content-Type: application/json
  Cache-Control: no-store

  {
   "access_token": "SlAV32hkKG",
   "token_type": "Bearer",
   "refresh_token": "8xLOxBtZp8",
   "expires_in": 3600,
   "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWdkazcifQ.ewogImlzc
     yI6ICJodHRwOi8vc2VydmVyLmV4YW1wbGUuY29tIiwKICJzdWIiOiAiMjQ4Mjg5
     NzYxMDAxIiwKICJhdWQiOiAiczZCaGRSa3F0MyIsCiAibm9uY2UiOiAibi0wUzZ
     fV3pBMk1qIiwKICJleHAiOiAxMzExMjgxOTcwLAogImlhdCI6IDEzMTEyODA5Nz
     AKfQ.ggW8hZ1EuVLuxNuuIJKX_V8a_OMXzR0EHR9R6jgdqrOOF4daGU96Sr_P6q
     Jp6IcmD3HP99Obi1PRs-cwh3LO-p146waJ8IhehcwL7F09JdijmBqkvPeB2T9CJ
     NqeGpe-gccMg4vfKjkM8FcGvnzZUN4_KSP0aAp1tOJ1zZwgjxqGByKHiOtX7Tpd
     QyHE5lcMiKPXfEIQILVq0pc_E2DzL7emopWoaoZTF_m0_N0YzFC6g6EJbOEoRoS
     K5hoDalrcvRYLSrQAZZKflyuVCyixEoV9GfNQC3_osjzw2PAithfubEEBLuVVk4
     XUVrWOLrLl0nx7RkKU8NXNHq-rvKMzqg"
  }

```

As specified in [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749], Clients
SHOULD ignore unrecognized response parameters.

---

| [TOC](#toc) |
| --- |

### 3.1.3.4.  Token Error Response

If the Token Request is invalid or unauthorized, the
Authorization Server constructs the error response. The parameters
of the Token Error Response are defined as in Section 5.2 of [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749].
The HTTP response body uses the application/json
media type with HTTP response code of 400.

The following is a non-normative example Token Error Response:

```

  HTTP/1.1 400 Bad Request
  Content-Type: application/json
  Cache-Control: no-store

  {
   "error": "invalid_request"
  }

```

---

| [TOC](#toc) |
| --- |

### 3.1.3.5.  Token Response Validation

The Client MUST validate the Token Response as follows:

1. Follow the validation rules in RFC 6749,
   especially those in Sections 5.1 and 10.12.
2. Follow the ID Token validation rules in [Section 3.1.3.7 (ID Token Validation)](#IDTokenValidation).
3. Follow the Access Token validation rules in [Section 3.1.3.8 (Access Token Validation)](#CodeFlowTokenValidation).

---

| [TOC](#toc) |
| --- |

### 3.1.3.6.  ID Token

The contents of the ID Token are as described in [Section 2 (ID Token)](#IDToken).
When using the Authorization Code Flow,
these additional requirements for the following ID Token Claims apply:

> at\_hash
> OPTIONAL.
> Access Token hash value.
> Its value is the base64url encoding of the left-most half of the
> hash of the octets of the ASCII representation of the
> access\_token value,
> where the hash algorithm used is the hash algorithm
> used in the alg Header Parameter
> of the ID Token's JOSE Header.
> For instance, if the alg is
> RS256, hash the
> access\_token value
> with SHA-256, then take the left-most 128 bits and base64url-encode them.
> The at\_hash value is a case-sensitive string.

---

| [TOC](#toc) |
| --- |

### 3.1.3.7.  ID Token Validation

Clients MUST validate the ID Token in the Token Response
in the following manner:

1. If the ID Token is encrypted, decrypt it using the
   keys and algorithms that the Client specified during Registration
   that the OP was to use to encrypt the ID Token.
   If encryption was negotiated with the OP at Registration time
   and the ID Token is not encrypted, the RP SHOULD reject it.
2. The Issuer Identifier for the OpenID Provider
   (which is typically obtained during Discovery)
   MUST exactly match the value of the
   iss (issuer) Claim.
3. The Client MUST validate that the
   aud (audience) Claim
   contains its client\_id value
   registered at the Issuer identified by the
   iss (issuer) Claim
   as an audience.
   The aud (audience) Claim
   MAY contain an array with more than one element.
   The ID Token MUST be rejected if the ID Token does not list
   the Client as a valid audience, or if it contains additional audiences not trusted by the Client.
4. If the implementation is using extensions
   (which are beyond the scope of this specification)
   that result in
   the azp (authorized party) Claim being present,
   it SHOULD validate the azp value
   as specified by those extensions.
5. This validation MAY include that
   when an azp (authorized party) Claim is present,
   the Client SHOULD verify that its client\_id
   is the Claim Value.
6. If the ID Token is received via direct
   communication between the Client and the Token Endpoint
   (which it is in this flow), the TLS server
   validation MAY be used to validate the issuer in place of
   checking the token signature.
   The Client MUST validate the signature of all other ID Tokens according to
   [JWS (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Signature (JWS),” May 2015.)](#JWS) [JWS] using the algorithm specified in the
   JWT alg Header Parameter.
   The Client MUST use the keys provided by the Issuer.
7. The alg value SHOULD be the default of
   RS256
   or the algorithm sent by the Client
   in the id\_token\_signed\_response\_alg parameter
   during Registration.
8. If the JWT alg Header Parameter
   uses a MAC based algorithm such as
   HS256, HS384,
   or HS512,
   the octets of the UTF-8 [[RFC3629] (Yergeau, F., “UTF-8, a transformation format of ISO 10646,” November 2003.)](#RFC3629) representation of
   the client\_secret corresponding to the
   client\_id contained in the
   aud (audience) Claim are used as the key
   to validate the signature.
   For MAC based algorithms, the behavior is unspecified
   if the aud is multi-valued.
9. The current time MUST be before the time represented by the
   exp Claim.
10. The iat Claim can be used to reject tokens that
    were issued too far away from the current time, limiting the amount of
    time that nonces need to be stored to prevent attacks.
    The acceptable range is Client specific.
11. If a nonce value was sent in the Authentication Request,
    a nonce Claim MUST be present
    and its value checked to verify that
    it is the same value as the one that was sent in the Authentication Request.
    The Client SHOULD check the nonce value
    for replay attacks.
    The precise method for detecting replay attacks is Client specific.
12. If the acr Claim was requested, the
    Client SHOULD check that the asserted Claim Value is appropriate.
    The meaning and processing of
    acr Claim Values is out of scope for this specification.
13. If the auth\_time Claim was requested,
    either through a specific request for this Claim
    or by using the max\_age parameter,
    the Client SHOULD check the auth\_time Claim
    value and request re-authentication if it determines too much time
    has elapsed since the last End-User authentication.

---

| [TOC](#toc) |
| --- |

### 3.1.3.8.  Access Token Validation

When using the Authorization Code Flow,
if the ID Token contains an at\_hash Claim,
the Client MAY use it to validate the Access Token
in the same manner as for the Implicit Flow,
as defined in [Section 3.2.2.9 (Access Token Validation)](#ImplicitTokenValidation),
but using the ID Token and Access Token returned from the Token Endpoint.

---

| [TOC](#toc) |
| --- |

### 3.2.  Authentication using the Implicit Flow

This section describes how to perform authentication using the Implicit Flow.
When using the Implicit Flow,
all tokens are returned from the Authorization Endpoint;
the Token Endpoint is not used.

The Implicit Flow is mainly used by Clients implemented in a browser
using a scripting language. The Access Token and ID Token are returned
directly to the Client, which may expose them to the End-User and
applications that have access to the End-User's User Agent.
The Authorization Server does not perform Client Authentication.

---

| [TOC](#toc) |
| --- |

### 3.2.1.  Implicit Flow Steps

The Implicit Flow follows the following steps:

1. Client prepares an Authentication Request containing the desired
   request parameters.
2. Client sends the request to the Authorization Server.
3. Authorization Server Authenticates the End-User.
4. Authorization Server obtains End-User Consent/Authorization.
5. Authorization Server sends the End-User back to the Client with
   an ID Token and, if requested, an Access Token.
6. Client validates the ID token and retrieves the End-User's
   Subject Identifier.

---

| [TOC](#toc) |
| --- |

### 3.2.2.  Authorization Endpoint

When using the Implicit Flow, the Authorization Endpoint is used
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint),
with the exception of the differences specified in this section.

---

| [TOC](#toc) |
| --- |

### 3.2.2.1.  Authentication Request

Authentication Requests are made
as defined in [Section 3.1.2.1 (Authentication Request)](#AuthRequest),
except that these Authentication Request parameters
are used as follows:

> response\_type
> REQUIRED.
> OAuth 2.0 Response Type value that determines
> the authorization processing flow to be used,
> including what parameters are returned from the endpoints used.
> When using the Implicit Flow, this value is
> id\_token token or
> id\_token.
> The meanings of both of these values are defined in
> [OAuth 2.0 Multiple Response Type Encoding Practices (de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, “OAuth 2.0 Multiple Response Type Encoding Practices,” February 2014.)](#OAuth.Responses) [OAuth.Responses].
> No Access Token is returned when the value is
> id\_token.
>
>
> NOTE: While OAuth 2.0 also defines the
> token Response Type value
> for the Implicit Flow, OpenID Connect does not use this Response Type,
> since no ID Token would be returned.
>
> redirect\_uri
> REQUIRED.
> Redirection URI to which the response will be sent.
> This URI MUST exactly match one of the Redirection URI values
> for the Client pre-registered at the OpenID Provider,
> with the matching performed as described in
> Section 6.2.1 of [[RFC3986] (Berners-Lee, T., Fielding, R., and L. Masinter, “Uniform Resource Identifier (URI): Generic Syntax,” January 2005.)](#RFC3986) (Simple String Comparison).
> When using this flow, the Redirection URI
> MUST NOT use the http scheme
> unless the Client is a native application, in which case it MAY
> use the http scheme with
> localhost or the IP loopback literals
> 127.0.0.1 or [::1]
> as the hostname.
>
> nonce
> REQUIRED.
> String value used to associate a Client session
> with an ID Token, and to mitigate replay attacks.
> The value is passed through unmodified from the Authentication Request to the ID Token.
> Sufficient entropy MUST be present in the
> nonce values used to prevent
> attackers from guessing values.
> For implementation notes, see [Section 15.5.2 (Nonce Implementation Notes)](#NonceNotes).

The following is a non-normative example request using the Implicit Flow
that would be sent by the User Agent to the Authorization Server
in response to a corresponding HTTP 302 redirect response by the Client
(with line wraps within values for display purposes only):

```

  GET /authorize?
    response_type=id_token%20token
    &client_id=s6BhdRkqt3
    &redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &scope=openid%20profile
    &state=af0ifjsldkj
    &nonce=n-0S6_WzA2Mj HTTP/1.1
  Host: server.example.com

```

---

| [TOC](#toc) |
| --- |

### 3.2.2.2.  Authentication Request Validation

When using the Implicit Flow, the Authentication Request is validated
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.2.2 (Authentication Request Validation)](#AuthRequestValidation).

---

| [TOC](#toc) |
| --- |

### 3.2.2.3.  Authorization Server Authenticates End-User

When using the Implicit Flow, End-User Authentication is performed
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.2.3 (Authorization Server Authenticates End-User)](#Authenticates).

---

| [TOC](#toc) |
| --- |

### 3.2.2.4.  Authorization Server Obtains End-User Consent/Authorization

When using the Implicit Flow, End-User Consent is obtained
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.2.4 (Authorization Server Obtains End-User Consent/Authorization)](#Consent).

---

| [TOC](#toc) |
| --- |

### 3.2.2.5.  Successful Authentication Response

When using the Implicit Flow, Authentication Responses are made
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.2.5 (Successful Authentication Response)](#AuthResponse),
with the exception of the differences specified in this section.

When using the Implicit Flow,
all response parameters are added to the fragment component
of the Redirection URI, as specified in
[OAuth 2.0 Multiple Response Type Encoding Practices (de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, “OAuth 2.0 Multiple Response Type Encoding Practices,” February 2014.)](#OAuth.Responses) [OAuth.Responses],
unless a different Response Mode was specified.

These parameters are returned from the Authorization Endpoint:

> access\_token
> OAuth 2.0 Access Token.
> This is returned
> unless the response\_type value used is
> id\_token.
>
> token\_type
> OAuth 2.0 Token Type value.
> The value MUST be Bearer or
> another token\_type value that the Client
> has negotiated with the Authorization Server.
> Clients implementing this profile MUST support the [OAuth 2.0 Bearer Token Usage (Jones, M. and D. Hardt, “The OAuth 2.0 Authorization Framework: Bearer Token Usage,” October 2012.)](#RFC6750) [RFC6750] specification.
> This profile only describes the use of bearer tokens.
> This is returned in the same cases as
> access\_token is.
>
> id\_token
> REQUIRED.
> ID Token.
>
> state
> OAuth 2.0 state value.
> REQUIRED if the
> state parameter is present in the
> Authorization Request. Clients MUST verify that the
> state value is equal to the
> value of state parameter in the
> Authorization Request.
>
> expires\_in
> OPTIONAL.
> Expiration time of the Access Token in seconds
> since the response was generated.

Per Section 4.2.2 of [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749],
no code result is returned
when using the Implicit Flow.

The following is a non-normative example
of a successful response using the Implicit Flow
(with line wraps for the display purposes only):

```

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb#
    access_token=SlAV32hkKG
    &token_type=bearer
    &id_token=eyJ0 ... NiJ9.eyJ1c ... I6IjIifX0.DeWt4Qu ... ZXso
    &expires_in=3600
    &state=af0ifjsldkj

```

---

| [TOC](#toc) |
| --- |

### 3.2.2.6.  Authentication Error Response

When using the Implicit Flow, Authorization Error Responses are made
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.2.6 (Authentication Error Response)](#AuthError),
with the exception of the differences specified in this section.

Whenever Error Response parameters are returned,
such as when End-User denies the authorization or the End-User authentication fails,
the Authorization Server MUST return the error
Authorization Response in the
fragment component of the Redirection URI,
as defined in Section 4.2.2.1 of
[OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749] and
[OAuth 2.0 Multiple Response Type Encoding Practices (de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, “OAuth 2.0 Multiple Response Type Encoding Practices,” February 2014.)](#OAuth.Responses) [OAuth.Responses],
unless a different Response Mode was specified.

---

| [TOC](#toc) |
| --- |

### 3.2.2.7.  Redirect URI Fragment Handling

Since response parameters are returned in the Redirection URI fragment value,
the Client needs to have the User Agent parse the fragment encoded values
and pass them to on to the Client's processing logic for consumption.
See [Section 15.5.3 (Redirect URI Fragment Handling Implementation Notes)](#FragmentNotes) for implementation notes
on URI fragment handling.

---

| [TOC](#toc) |
| --- |

### 3.2.2.8.  Authentication Response Validation

When using the Implicit Flow,
the Client MUST validate the response as follows:

1. Verify that the response conforms to Section 5 of
   [[OAuth.Responses] (de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, “OAuth 2.0 Multiple Response Type Encoding Practices,” February 2014.)](#OAuth.Responses).
2. Follow the validation rules in RFC 6749,
   especially those in Sections 4.2.2 and 10.12.
3. Follow the ID Token validation rules in [Section 3.2.2.11 (ID Token Validation)](#ImplicitIDTValidation).
4. Follow the Access Token validation rules in [Section 3.2.2.9 (Access Token Validation)](#ImplicitTokenValidation),
   unless the response\_type value used is
   id\_token.

---

| [TOC](#toc) |
| --- |

### 3.2.2.9.  Access Token Validation

To validate an Access Token issued from the Authorization Endpoint with an ID Token,
the Client SHOULD do the following:

1. Hash the octets of the ASCII representation of
   the access\_token
   with the hash algorithm specified in [JWA (Jones, M., “JSON Web Algorithms (JWA),” May 2015.)](#JWA) [JWA] for the
   alg Header Parameter
   of the ID Token's JOSE Header.
   For instance, if the alg is
   RS256,
   the hash algorithm used is SHA-256.
2. Take the left-most half of the hash and base64url-encode it.
3. The value of at\_hash in the ID Token MUST
   match the value produced in the previous step.

---

| [TOC](#toc) |
| --- |

### 3.2.2.10.  ID Token

The contents of the ID Token are as described in [Section 2 (ID Token)](#IDToken).
When using the Implicit Flow,
these additional requirements for the following ID Token Claims apply:

> nonce
> Use of the nonce Claim is REQUIRED
> for this flow.
>
> at\_hash
> Access Token hash value.
> Its value is the base64url encoding of the left-most half of the
> hash of the octets of the ASCII representation of the
> access\_token value,
> where the hash algorithm used is the hash algorithm
> used in the alg Header Parameter
> of the ID Token's JOSE Header.
> For instance, if the alg is
> RS256, hash the
> access\_token value
> with SHA-256, then take the left-most 128 bits and base64url-encode them.
> The at\_hash value is a case-sensitive string.
>
>
> If the ID Token is issued from the Authorization Endpoint with an
> access\_token value,
> which is the case for the response\_type value
> id\_token token,
> this is REQUIRED;
> it MAY NOT be used when no Access Token is issued,
> which is the case for the response\_type value
> id\_token.

---

| [TOC](#toc) |
| --- |

### 3.2.2.11.  ID Token Validation

When using the Implicit Flow, the contents of the ID Token MUST be validated
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.3.7 (ID Token Validation)](#IDTokenValidation),
with the exception of the differences specified in this section.

1. The Client MUST validate the signature of the ID Token according to
   [JWS (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Signature (JWS),” May 2015.)](#JWS) [JWS] using the algorithm specified in the
   alg Header Parameter of the JOSE Header.
2. The value of the nonce
   Claim MUST be checked to verify that
   it is the same value as the one that was sent in the Authentication Request.
   The Client SHOULD check the nonce value
   for replay attacks.
   The precise method for detecting replay attacks is Client specific.

---

| [TOC](#toc) |
| --- |

### 3.3.  Authentication using the Hybrid Flow

This section describes how to perform authentication using the Hybrid Flow.
When using the Hybrid Flow,
some tokens are returned from the Authorization Endpoint
and others are returned from the Token Endpoint.
The mechanisms for returning tokens in the Hybrid Flow are specified in
[OAuth 2.0 Multiple Response Type Encoding Practices (de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, “OAuth 2.0 Multiple Response Type Encoding Practices,” February 2014.)](#OAuth.Responses) [OAuth.Responses].

---

| [TOC](#toc) |
| --- |

### 3.3.1.  Hybrid Flow Steps

The Hybrid Flow follows the following steps:

1. Client prepares an Authentication Request containing the desired
   request parameters.
2. Client sends the request to the Authorization Server.
3. Authorization Server Authenticates the End-User.
4. Authorization Server obtains End-User Consent/Authorization.
5. Authorization Server sends the End-User back to the Client with
   an Authorization Code and, depending on the Response Type,
   one or more additional parameters.
6. Client requests a response using the Authorization Code at the
   Token Endpoint.
7. Client receives a response that contains an ID Token
   and Access Token in the response body.
8. Client validates the ID Token and retrieves the End-User's
   Subject Identifier.

---

| [TOC](#toc) |
| --- |

### 3.3.2.  Authorization Endpoint

When using the Hybrid Flow, the Authorization Endpoint is used
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint),
with the exception of the differences specified in this section.

---

| [TOC](#toc) |
| --- |

### 3.3.2.1.  Authentication Request

Authentication Requests are made
as defined in [Section 3.1.2.1 (Authentication Request)](#AuthRequest),
except that these Authentication Request parameters
are used as follows:

> response\_type
> REQUIRED.
> OAuth 2.0 Response Type value that determines
> the authorization processing flow to be used,
> including what parameters are returned from the endpoints used.
> When using the Hybrid Flow, this value is
> code id\_token,
> code token, or
> code id\_token token.
> The meanings of these values are defined in
> [OAuth 2.0 Multiple Response Type Encoding Practices (de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, “OAuth 2.0 Multiple Response Type Encoding Practices,” February 2014.)](#OAuth.Responses) [OAuth.Responses].
>
> nonce
> REQUIRED if the Response Type of the request is code id\_token
> or code id\_token token and OPTIONAL when the Response Type of
> the request is code token.
> It is a string value used to associate a Client session
> with an ID Token, and to mitigate replay attacks.
> The value is passed through unmodified from the Authentication Request to the ID Token.
> Sufficient entropy MUST be present in the
> nonce values used to prevent
> attackers from guessing values.
> For implementation notes, see [Section 15.5.2 (Nonce Implementation Notes)](#NonceNotes).

The following is a non-normative example request using the Hybrid Flow
that would be sent by the User Agent to the Authorization Server
in response to a corresponding HTTP 302 redirect response by the Client
(with line wraps within values for display purposes only):

```

  GET /authorize?
    response_type=code%20id_token
    &client_id=s6BhdRkqt3
    &redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &scope=openid%20profile%20email
    &nonce=n-0S6_WzA2Mj
    &state=af0ifjsldkj HTTP/1.1
  Host: server.example.com

```

---

| [TOC](#toc) |
| --- |

### 3.3.2.2.  Authentication Request Validation

When using the Hybrid Flow, the Authentication Request is validated
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.2.2 (Authentication Request Validation)](#AuthRequestValidation).

---

| [TOC](#toc) |
| --- |

### 3.3.2.3.  Authorization Server Authenticates End-User

When using the Hybrid Flow, End-User Authentication is performed
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.2.3 (Authorization Server Authenticates End-User)](#Authenticates).

---

| [TOC](#toc) |
| --- |

### 3.3.2.4.  Authorization Server Obtains End-User Consent/Authorization

When using the Hybrid Flow, End-User Consent is obtained
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.2.4 (Authorization Server Obtains End-User Consent/Authorization)](#Consent).

---

| [TOC](#toc) |
| --- |

### 3.3.2.5.  Successful Authentication Response

When using the Hybrid Flow, Authentication Responses are made
in the same manner as for the Implicit Flow,
as defined in [Section 3.2.2.5 (Successful Authentication Response)](#ImplicitAuthResponse),
with the exception of the differences specified in this section.

These Authorization Endpoint results are used in the following manner:

> access\_token
> OAuth 2.0 Access Token.
> This is returned
> when the response\_type value used is
> code token,
> or code id\_token token.
> (A token\_type value is also returned in the same cases.)
>
> id\_token
> ID Token.
> This is returned
> when the response\_type value used is
> code id\_token or
> code id\_token token.
>
> code
> Authorization Code.
> This is always returned when using the Hybrid Flow.

The following is a non-normative example
of a successful response using the Hybrid Flow
(with line wraps for the display purposes only):

```

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb#
    code=SplxlOBeZQQYbYS6WxSbIA
    &id_token=eyJ0 ... NiJ9.eyJ1c ... I6IjIifX0.DeWt4Qu ... ZXso
    &state=af0ifjsldkj

```

---

| [TOC](#toc) |
| --- |

### 3.3.2.6.  Authentication Error Response

When using the Hybrid Flow, Authorization Error Responses are made
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.2.6 (Authentication Error Response)](#AuthError),
with the exception of the differences specified in this section.

Whenever Error Response parameters are returned,
such as when End-User denies the authorization or the End-User authentication fails,
the Authorization Server MUST return the error
Authorization Response in the
fragment component of the Redirection URI,
as defined in Section 4.2.2.1 of
[OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749] and
[OAuth 2.0 Multiple Response Type Encoding Practices (de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, “OAuth 2.0 Multiple Response Type Encoding Practices,” February 2014.)](#OAuth.Responses) [OAuth.Responses],
unless a different Response Mode was specified.

---

| [TOC](#toc) |
| --- |

### 3.3.2.7.  Redirect URI Fragment Handling

When using the Hybrid Flow, the same requirements for
Redirection URI fragment parameter handling apply as do for
the Implicit Flow, as defined in [Section 3.2.2.7 (Redirect URI Fragment Handling)](#ImplicitCallback).
Also see [Section 15.5.3 (Redirect URI Fragment Handling Implementation Notes)](#FragmentNotes) for implementation notes
on URI fragment handling.

---

| [TOC](#toc) |
| --- |

### 3.3.2.8.  Authentication Response Validation

When using the Hybrid Flow,
the Client MUST validate the response as follows:

1. Verify that the response conforms to Section 5 of
   [[OAuth.Responses] (de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, “OAuth 2.0 Multiple Response Type Encoding Practices,” February 2014.)](#OAuth.Responses).
2. Follow the validation rules in RFC 6749,
   especially those in Sections 4.2.2 and 10.12.
3. Follow the ID Token validation rules in [Section 3.3.2.12 (ID Token Validation)](#HybridIDTValidation)
   when the response\_type value used is
   code id\_token or
   code id\_token token.
4. Follow the Access Token validation rules in [Section 3.3.2.9 (Access Token Validation)](#HybridTokenValidation)
   when the response\_type value used is
   code token or
   code id\_token token.
5. Follow the Authorization Code validation rules in [Section 3.3.2.10 (Authorization Code Validation)](#CodeValidation)
   when the response\_type value used is
   code id\_token or
   code id\_token token.

---

| [TOC](#toc) |
| --- |

### 3.3.2.9.  Access Token Validation

When using the Hybrid Flow, Access Tokens
returned from the Authorization Endpoint are validated
in the same manner as for the Implicit Flow,
as defined in [Section 3.2.2.9 (Access Token Validation)](#ImplicitTokenValidation).

---

| [TOC](#toc) |
| --- |

### 3.3.2.10.  Authorization Code Validation

To validate an Authorization Code issued from the Authorization Endpoint with an ID Token,
the Client SHOULD do the following:

1. Hash the octets of the ASCII representation of
   the code
   with the hash algorithm specified in [JWA (Jones, M., “JSON Web Algorithms (JWA),” May 2015.)](#JWA) [JWA] for the
   alg Header Parameter
   of the ID Token's JOSE Header.
   For instance, if the alg is
   RS256,
   the hash algorithm used is SHA-256.
2. Take the left-most half of the hash and base64url-encode it.
3. The value of c\_hash in the ID Token MUST
   match the value produced in the previous step if c\_hash
   is present in the ID Token.

---

| [TOC](#toc) |
| --- |

### 3.3.2.11.  ID Token

The contents of the ID Token are as described in [Section 2 (ID Token)](#IDToken).
When using the Hybrid Flow,
these additional requirements for the following ID Token Claims apply
to an ID Token returned from the Authorization Endpoint:

> nonce
> If a nonce parameter is present in the Authentication Request,
> Authorization Servers MUST include a nonce Claim in the ID Token.
>
> at\_hash
> Access Token hash value.
> Its value is the base64url encoding of the left-most half of the
> hash of the octets of the ASCII representation of the
> access\_token value,
> where the hash algorithm used is the hash algorithm
> used in the alg Header Parameter
> of the ID Token's JOSE Header.
> For instance, if the alg is
> RS256, hash the
> access\_token value
> with SHA-256, then take the left-most 128 bits and base64url-encode them.
> The at\_hash value is a case-sensitive string.
>
>
> If the ID Token is issued from the Authorization Endpoint with an
> access\_token value,
> which is the case for the response\_type value
> code id\_token token,
> this is REQUIRED; otherwise, its inclusion is OPTIONAL.
>
> c\_hash
> Code hash value.
> Its value is the base64url encoding of the left-most half of the
> hash of the octets of the ASCII representation of the
> code value,
> where the hash algorithm used is the hash algorithm
> used in the alg Header Parameter
> of the ID Token's JOSE Header.
> For instance, if the alg is
> HS512, hash the
> code value
> with SHA-512, then take the left-most 256 bits and base64url-encode them.
> The c\_hash value is a case-sensitive string.
>
>
> If the ID Token is issued from the Authorization Endpoint with a
> code,
> which is the case for the response\_type values
> code id\_token and
> code id\_token token,
> this is REQUIRED; otherwise, its inclusion is OPTIONAL.

---

| [TOC](#toc) |
| --- |

### 3.3.2.12.  ID Token Validation

When using the Hybrid Flow, the contents of an ID Token
returned from the Authorization Endpoint MUST be validated
in the same manner as for the Implicit Flow,
as defined in [Section 3.2.2.11 (ID Token Validation)](#ImplicitIDTValidation).

---

| [TOC](#toc) |
| --- |

### 3.3.3.  Token Endpoint

When using the Hybrid Flow, the Token Endpoint is used
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.3 (Token Endpoint)](#TokenEndpoint),
with the exception of the differences specified in this section.

---

| [TOC](#toc) |
| --- |

### 3.3.3.1.  Token Request

When using the Hybrid Flow, Token Requests are made
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.3.1 (Token Request)](#TokenRequest).

---

| [TOC](#toc) |
| --- |

### 3.3.3.2.  Token Request Validation

When using the Hybrid Flow, Token Requests are validated
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.3.2 (Token Request Validation)](#TokenRequestValidation).

---

| [TOC](#toc) |
| --- |

### 3.3.3.3.  Successful Token Response

When using the Hybrid Flow, Token Responses are made
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.3.3 (Successful Token Response)](#TokenResponse).

---

| [TOC](#toc) |
| --- |

### 3.3.3.4.  Token Error Response

When using the Hybrid Flow, Token Error Responses are made
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.3.4 (Token Error Response)](#TokenErrorResponse).

---

| [TOC](#toc) |
| --- |

### 3.3.3.5.  Token Response Validation

When using the Hybrid Flow, Token Responses are validated
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.3.5 (Token Response Validation)](#TokenResponseValidation).

---

| [TOC](#toc) |
| --- |

### 3.3.3.6.  ID Token

When using the Hybrid Flow, the contents of an ID Token
returned from the Token Endpoint are
the same as for an ID Token returned from the Authorization Endpoint,
as defined in [Section 3.3.2.11 (ID Token)](#HybridIDToken),
with the exception of the differences specified in this section.

If an ID Token is returned from both the Authorization Endpoint
and from the Token Endpoint,
which is the case for the response\_type values
code id\_token and
code id\_token token,
the iss and sub
Claim Values MUST be identical in both ID Tokens.
All Claims about the Authentication event present in either
SHOULD be present in both.
If either ID Token contains Claims about the End-User,
any that are present in both SHOULD have the same values in both.
Note that the OP MAY choose to return fewer Claims about the End-User
from the Authorization Endpoint, for instance, for privacy reasons.
The at\_hash
and c\_hash Claims
MAY be omitted from the ID Token returned from the Token Endpoint
even when these Claims are
present in the ID Token returned from the Authorization Endpoint,
because the ID Token and Access Token values returned from
the Token Endpoint are already cryptographically bound together
by the TLS encryption performed by the Token Endpoint.

---

| [TOC](#toc) |
| --- |

### 3.3.3.7.  ID Token Validation

When using the Hybrid Flow, the contents of an ID Token
returned from the Token Endpoint MUST be validated
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.3.7 (ID Token Validation)](#IDTokenValidation).

---

| [TOC](#toc) |
| --- |

### 3.3.3.8.  Access Token

If an Access Token is returned from both the Authorization Endpoint
and from the Token Endpoint,
which is the case for the response\_type values
code token and
code id\_token token,
their values MAY be the same
or they MAY be different.
Note that different Access Tokens might be returned
be due to the different security characteristics
of the two endpoints and the lifetimes and
the access to resources granted by them might also be different.

---

| [TOC](#toc) |
| --- |

### 3.3.3.9.  Access Token Validation

When using the Hybrid Flow, the Access Token
returned from the Token Endpoint
is validated
in the same manner as for the Authorization Code Flow,
as defined in [Section 3.1.3.8 (Access Token Validation)](#CodeFlowTokenValidation).

---

| [TOC](#toc) |
| --- |

### 4.  Initiating Login from a Third Party

In some cases, the login flow is initiated by an OpenID Provider
or another party, rather than the Relying Party.
In this case, the initiator redirects to the RP at its login initiation endpoint,
which requests that the RP send an Authentication Request to a specified OP.
Note that this login initiation endpoint can be a different page at the RP
than the RP's default landing page.
RPs supporting
[OpenID Connect Dynamic Client Registration 1.0 (Sakimura, N., Bradley, J., and M. Jones, “OpenID Connect Dynamic Client Registration 1.0,” December 2023.)](#OpenID.Registration) [OpenID.Registration]
register this endpoint value using the
initiate\_login\_uri Registration parameter.

The party initiating the login request does so by redirecting
to the login initiation endpoint at the RP, passing the following parameters:

> iss
> REQUIRED.
> Issuer Identifier for the OP that the RP is to send
> the Authentication Request to.
> Its value MUST be a URL using the https scheme.
>
> login\_hint
> OPTIONAL.
> Hint to the Authorization Server about the End-User to be authenticated.
> The meaning of this string-valued parameter is left to the OP's discretion.
> In common use cases, the value will contain an e-mail address, phone number, or username
> collected by the RP before requesting authentication at the OP.
> For example, this hint can be used by an RP after it asks the End-User
> for their e-mail address (or other identifier),
> passing that identifier as a hint to the OpenID Provider.
> It is RECOMMENDED that the hint value match the value provided for discovery.
> Other uses MAY include
> using the sub claim from the ID Token as the hint value
> or potentially other kinds of information about the requested authentication.
>
> target\_link\_uri
> OPTIONAL.
> URL that the RP is requested to redirect to after authentication.
> RPs MUST verify the value of the
> target\_link\_uri to prevent being used as
> an open redirector to external sites.

The parameters can either be passed as query parameters using
the HTTP GET method
or be passed as HTML form values that are auto-submitted in the User Agent,
and thus are transmitted via the HTTP POST method.

Other parameters MAY be sent, if defined by extensions.
Any parameters used that are not understood MUST be ignored by the Client.

Clients SHOULD employ frame busting and other techniques to prevent
End-Users from being logged in by third party sites without their knowledge
through attacks such as Clickjacking.
Refer to Section 4.4.1.9 of [[RFC6819] (Lodderstedt, T., Ed., McGloin, M., and P. Hunt, “OAuth 2.0 Threat Model and Security Considerations,” January 2013.)](#RFC6819) for more details.

---

| [TOC](#toc) |
| --- |

### 5.  Claims

This section specifies how the Client can obtain Claims about the End-User
and the Authentication event.
It also defines a standard set of basic profile Claims.
Pre-defined sets of Claims can be requested using specific scope values
or individual Claims can be requested using the
claims request parameter.
The Claims can come directly from the OpenID Provider
or from distributed sources as well.

---

| [TOC](#toc) |
| --- |

### 5.1.  Standard Claims

This specification defines a set of standard Claims.
They can be requested to be returned either in the
UserInfo Response, per [Section 5.3.2 (Successful UserInfo Response)](#UserInfoResponse),
or in the ID Token, per [Section 2 (ID Token)](#IDToken).

---

| Member | Type | Description |
| sub | string | Subject - Identifier for the End-User at the Issuer. |
| name | string | End-User's full name in displayable form including all name parts, possibly including titles and suffixes, ordered according to the End-User's locale and preferences. |
| given\_name | string | Given name(s) or first name(s) of the End-User. Note that in some cultures, people can have multiple given names; all can be present, with the names being separated by space characters. |
| family\_name | string | Surname(s) or last name(s) of the End-User. Note that in some cultures, people can have multiple family names or no family name; all can be present, with the names being separated by space characters. |
| middle\_name | string | Middle name(s) of the End-User. Note that in some cultures, people can have multiple middle names; all can be present, with the names being separated by space characters. Also note that in some cultures, middle names are not used. |
| nickname | string | Casual name of the End-User that may or may not be the same as the given\_name. For instance, a nickname value of Mike might be returned alongside a given\_name value of Michael. |
| preferred\_username | string | Shorthand name by which the End-User wishes to be referred to at the RP, such as janedoe or j.doe. This value MAY be any valid JSON string including special characters such as @, /, or whitespace. The RP MUST NOT rely upon this value being unique, as discussed in [Section 5.7 (Claim Stability and Uniqueness)](#ClaimStability). |
| profile | string | URL of the End-User's profile page. The contents of this Web page SHOULD be about the End-User. |
| picture | string | URL of the End-User's profile picture. This URL MUST refer to an image file (for example, a PNG, JPEG, or GIF image file), rather than to a Web page containing an image. Note that this URL SHOULD specifically reference a profile photo of the End-User suitable for displaying when describing the End-User, rather than an arbitrary photo taken by the End-User. |
| website | string | URL of the End-User's Web page or blog. This Web page SHOULD contain information published by the End-User or an organization that the End-User is affiliated with. |
| email | string | End-User's preferred e-mail address. Its value MUST conform to the [RFC 5322 (Resnick, P., Ed., “Internet Message Format,” October 2008.)](#RFC5322) [RFC5322] addr-spec syntax. The RP MUST NOT rely upon this value being unique, as discussed in [Section 5.7 (Claim Stability and Uniqueness)](#ClaimStability). |
| email\_verified | boolean | True if the End-User's e-mail address has been verified; otherwise false. When this Claim Value is true, this means that the OP took affirmative steps to ensure that this e-mail address was controlled by the End-User at the time the verification was performed. The means by which an e-mail address is verified is context specific, and dependent upon the trust framework or contractual agreements within which the parties are operating. |
| gender | string | End-User's gender. Values defined by this specification are female and male. Other values MAY be used when neither of the defined values are applicable. |
| birthdate | string | End-User's birthday, represented as an [ISO 8601-1 (International Organization for Standardization, “ISO 8601-1:2019/Amd 1:2022. Date and time - Representations for information interchange - Part 1: Basic rules,” October 2022.)](#ISO8601-1) [ISO8601‑1] YYYY-MM-DD format. The year MAY be 0000, indicating that it is omitted. To represent only the year, YYYY format is allowed. Note that depending on the underlying platform's date related function, providing just year can result in varying month and day, so the implementers need to take this factor into account to correctly process the dates. |
| zoneinfo | string | String from IANA Time Zone Database [[IANA.time‑zones] (IANA, “Time Zone Database,” .)](#IANA.time-zones) representing the End-User's time zone. For example, Europe/Paris or America/Los\_Angeles. |
| locale | string | End-User's locale, represented as a [BCP47 (Phillips, A., Ed. and M. Davis, Ed., “Tags for Identifying Languages,” September 2009.)](#RFC5646) [RFC5646] language tag. This is typically an [ISO 639 Alpha-2 (International Organization for Standardization, “ISO 639:2023. Code for individual languages and language groups,” November 2023.)](#ISO639) [ISO639] language code in lowercase and an [ISO 3166-1 Alpha-2 (International Organization for Standardization, “ISO 3166-1:2020. Codes for the representation of names of countries and their subdivisions - Part 1: Country codes,” August 2020.)](#ISO3166-1) [ISO3166‑1] country code in uppercase, separated by a dash. For example, en-US or fr-CA. As a compatibility note, some implementations have used an underscore as the separator rather than a dash, for example, en\_US; Relying Parties MAY choose to accept this locale syntax as well. |
| phone\_number | string | End-User's preferred telephone number. [E.164 (International Telecommunication Union, “E.164: The international public telecommunication numbering plan,” 2010.)](#E.164) [E.164] is RECOMMENDED as the format of this Claim, for example, +1 (425) 555-1212 or +56 (2) 687 2400. If the phone number contains an extension, it is RECOMMENDED that the extension be represented using the [RFC 3966 (Schulzrinne, H., “The tel URI for Telephone Numbers,” December 2004.)](#RFC3966) [RFC3966] extension syntax, for example, +1 (604) 555-1234;ext=5678. |
| phone\_number\_verified | boolean | True if the End-User's phone number has been verified; otherwise false. When this Claim Value is true, this means that the OP took affirmative steps to ensure that this phone number was controlled by the End-User at the time the verification was performed. The means by which a phone number is verified is context specific, and dependent upon the trust framework or contractual agreements within which the parties are operating. When true, the phone\_number Claim MUST be in E.164 format and any extensions MUST be represented in RFC 3966 format. |
| address | JSON object | End-User's preferred postal address. The value of the address member is a JSON [[RFC8259] (Bray, T., Ed., “The JavaScript Object Notation (JSON) Data Interchange Format,” December 2017.)](#RFC8259) structure containing some or all of the members defined in [Section 5.1.1 (Address Claim)](#AddressClaim). |
| updated\_at | number | Time the End-User's information was last updated. Its value is a JSON number representing the number of seconds from 1970-01-01T00:00:00Z as measured in UTC until the date/time. |

| **Table 1: Registered Member Definitions** |
| --- |

---

---

| [TOC](#toc) |
| --- |

### 5.1.1.  Address Claim

The Address Claim represents a physical mailing address.
Implementations MAY return only a subset of the
fields of an address, depending upon
the information available and the End-User's privacy
preferences. For
example, the country and region might be returned without returning
more fine-grained address information.

Implementations MAY return just the full address
as a single string in the formatted sub-field,
or they MAY return just the individual component
fields using the other sub-fields,
or they MAY return both.
If both variants are returned,
they SHOULD represent the same address,
with the formatted address indicating how the
component fields are combined.

All the address values defined below are represented as JSON strings.

> formatted
> Full mailing address,
> formatted for display or use on a mailing label.
> This field MAY contain multiple lines, separated by newlines.
> Newlines can be represented either as
> a carriage return/line feed pair ("\r\n") or as
> a single line feed character ("\n").
>
> street\_address
> Full street address component,
> which MAY include house number, street name,
> Post Office Box, and multi-line extended street
> address information.
> This field MAY contain multiple lines, separated by newlines.
> Newlines can be represented either as
> a carriage return/line feed pair ("\r\n") or as
> a single line feed character ("\n").
>
> locality
> City or locality component.
>
> region
> State, province,
> prefecture, or region component.
>
> postal\_code
> Zip code or
> postal code component.
>
> country
> Country name component.

---

| [TOC](#toc) |
| --- |

### 5.1.2.  Additional Claims

While this specification defines only a small set of Claims as
standard Claims, other Claims MAY be used in conjunction
with the standard Claims.
When using such Claims, it is RECOMMENDED that
collision-resistant names be used for the Claim Names,
as described in the
[JSON Web Token (JWT) (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Token (JWT),” May 2015.)](#JWT) [JWT] specification.
Alternatively, Private Claim Names can be safely used
when naming conflicts are unlikely to arise,
as described in the JWT specification.
Or, if specific additional Claims will have broad and general applicability,
they can be registered with Registered Claim Names,
per the JWT specification.

---

| [TOC](#toc) |
| --- |

### 5.2.  Claims Languages and Scripts

Human-readable Claim Values and Claim Values that reference human-readable values
MAY be represented in multiple languages and scripts.
To specify the languages and scripts, [BCP47 (Phillips, A., Ed. and M. Davis, Ed., “Tags for Identifying Languages,” September 2009.)](#RFC5646) [RFC5646] language tags are added to member names,
delimited by a # character. For example,
family\_name#ja-Kana-JP expresses the
Family Name in Katakana in Japanese, which is commonly used to index
and represent the phonetics of the Kanji representation of the same name
represented as family\_name#ja-Hani-JP.
As another example, both website and
website#de Claim Values might be returned,
referencing a Web site in an unspecified language and a Web site
in German.

Since Claim Names are case sensitive, it is strongly RECOMMENDED
that language tag values used in Claim Names be spelled using the
character case with which they are registered in the
IANA "Language Subtag Registry" [[IANA.Language] (IANA, “Language Subtag Registry,” .)](#IANA.Language).
In particular, normally language names are spelled with lowercase characters,
region names are spelled with uppercase characters, and
scripts are spelled with mixed case characters.
However, since BCP47 language tag values are case insensitive,
implementations SHOULD interpret the language tag values supplied
in a case-insensitive manner.

Per the recommendations in BCP47, language tag values for Claims
SHOULD only be as specific as necessary.
For instance, using fr might be sufficient
in many contexts, rather than fr-CA or
fr-FR.
Where possible, OPs SHOULD try to match requested Claim locales with
Claims it has. For instance, if the Client asks for a Claim with
a de (German) language tag and the OP
has a value tagged with de-CH (Swiss German)
and no generic German value, it would be appropriate for the OP
to return the Swiss German value to the Client.
(This intentionally moves as much of the complexity of language tag
matching to the OP as possible, to simplify Clients.)

OpenID Connect defines the following Authorization Request parameter
to enable specify the preferred languages and scripts to be used
for the returned Claims:

> claims\_locales
> OPTIONAL.
> End-User's preferred languages and scripts for Claims being returned,
> represented as a space-separated list of
> [BCP47 (Phillips, A., Ed. and M. Davis, Ed., “Tags for Identifying Languages,” September 2009.)](#RFC5646) [RFC5646] language tag values,
> ordered by preference.
> An error SHOULD NOT result if some or all of the requested locales
> are not supported by the OpenID Provider.

When the OP determines, either through the
claims\_locales parameter,
or by other means, that the End-User and Client are
requesting Claims in only one set of languages and scripts,
it is RECOMMENDED that OPs return Claims without language tags
when they employ this language and script.
It is also RECOMMENDED that Clients be written in a manner
that they can handle and utilize Claims using language tags.

---

| [TOC](#toc) |
| --- |

### 5.3.  UserInfo Endpoint

The UserInfo Endpoint is an OAuth 2.0 Protected Resource that
returns Claims about the authenticated End-User.
To obtain the requested Claims about the End-User, the Client
makes a request to the UserInfo Endpoint
using an Access Token obtained through OpenID Connect Authentication.
These Claims are normally represented by a JSON object that contains
a collection of name and value pairs for the Claims.

Communication with the UserInfo Endpoint MUST utilize TLS.
See [Section 16.17 (TLS Requirements)](#TLSRequirements) for more information on using TLS.

The UserInfo Endpoint MUST support the use of the
HTTP GET and
HTTP POST methods
defined in [RFC 7231 (Fielding, R., Ed. and J. Reschke, Ed., “Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content,” June 2014.)](#RFC7231) [RFC7231].

The UserInfo Endpoint MUST accept Access Tokens as
[OAuth 2.0 Bearer Token Usage (Jones, M. and D. Hardt, “The OAuth 2.0 Authorization Framework: Bearer Token Usage,” October 2012.)](#RFC6750) [RFC6750].

The UserInfo Endpoint SHOULD support the use of
[Cross-Origin Resource Sharing (CORS) (Opera Software ASA, “Cross-Origin Resource Sharing,” July 2010.)](#CORS) [CORS]
and/or other methods as appropriate
to enable JavaScript Clients and other Browser-Based Clients to access it.

---

| [TOC](#toc) |
| --- |

### 5.3.1.  UserInfo Request

The Client sends the UserInfo Request using either
HTTP GET or HTTP POST.
The Access Token obtained
from an OpenID Connect Authentication Request MUST be sent as a Bearer Token,
per Section 2 of [OAuth 2.0 Bearer Token Usage (Jones, M. and D. Hardt, “The OAuth 2.0 Authorization Framework: Bearer Token Usage,” October 2012.)](#RFC6750) [RFC6750].

It is RECOMMENDED that the request use the
HTTP GET method and
the Access Token be sent using the
Authorization header field.

The following is a non-normative example of a UserInfo Request:

```

  GET /userinfo HTTP/1.1
  Host: server.example.com
  Authorization: Bearer SlAV32hkKG

```

---

| [TOC](#toc) |
| --- |

### 5.3.2.  Successful UserInfo Response

The UserInfo Claims MUST be returned as the members of a JSON object
unless a signed or encrypted response was requested during Client Registration.
The Claims defined in [Section 5.1 (Standard Claims)](#StandardClaims) can be returned,
as can additional Claims not specified there.

For privacy reasons, OpenID Providers MAY elect to not return
values for some requested Claims.
It is not an error condition to not return a requested Claim.

If a Claim is not returned, that Claim Name SHOULD be
omitted from the JSON object representing the Claims; it
SHOULD NOT be present with a null or empty string value.

The sub (subject) Claim
MUST always be returned in the UserInfo Response.

NOTE: Due to the possibility of token substitution attacks
(see [Section 16.11 (Token Substitution)](#TokenSubstitution)),
the UserInfo Response is not guaranteed to be about the
End-User identified by the sub (subject)
element of the ID Token.
The sub Claim in the UserInfo Response
MUST be verified to exactly match the
sub Claim in the ID Token;
if they do not match, the UserInfo Response values MUST NOT be used.

Upon receipt of the UserInfo Request, the UserInfo Endpoint MUST
return the JSON Serialization of the UserInfo Response as in
[Section 13.3 (JSON Serialization)](#JSONSerialization) in the HTTP response
body unless a
different format was specified during Registration
[[OpenID.Registration] (Sakimura, N., Bradley, J., and M. Jones, “OpenID Connect Dynamic Client Registration 1.0,” December 2023.)](#OpenID.Registration).
The UserInfo Endpoint MUST return a content-type header to indicate
which format is being returned.
The content-type of the HTTP response MUST be application/json if the response body is a text
JSON object;
the response body SHOULD be encoded using UTF-8.

If the UserInfo Response is
signed and/or encrypted, then the Claims are returned in a JWT and the
content-type MUST be application/jwt.
The response MAY be encrypted without also being signed.
If both signing and encryption are requested,
the response MUST be signed then encrypted,
with the result being a Nested JWT, as defined in [[JWT] (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Token (JWT),” May 2015.)](#JWT).

If signed, the UserInfo Response
MUST contain the Claims
iss (issuer)
and aud (audience) as members.
The iss value MUST be the OP's Issuer Identifier URL.
The aud value MUST be or include the RP's Client ID value.

The following is a non-normative example
of a UserInfo Response:

```

  HTTP/1.1 200 OK
  Content-Type: application/json

  {
   "sub": "248289761001",
   "name": "Jane Doe",
   "given_name": "Jane",
   "family_name": "Doe",
   "preferred_username": "j.doe",
   "email": "janedoe@example.com",
   "picture": "http://example.com/janedoe/me.jpg"
  }

```

---

| [TOC](#toc) |
| --- |

### 5.3.3.  UserInfo Error Response

When an error condition occurs, the UserInfo Endpoint returns
an Error Response as defined in Section 3 of
[OAuth 2.0 Bearer Token Usage (Jones, M. and D. Hardt, “The OAuth 2.0 Authorization Framework: Bearer Token Usage,” October 2012.)](#RFC6750) [RFC6750].
(HTTP errors unrelated to RFC 6750 are returned to the User Agent using the
appropriate HTTP status code.)

The following is a non-normative example
of a UserInfo Error Response:

```

  HTTP/1.1 401 Unauthorized
  WWW-Authenticate: Bearer error="invalid_token",
    error_description="The Access Token expired"

```

---

| [TOC](#toc) |
| --- |

### 5.3.4.  UserInfo Response Validation

The Client MUST validate the UserInfo Response as follows:

1. Verify that the OP that responded was the intended OP
   through a TLS server certificate check, per
   [RFC 6125 (Saint-Andre, P. and J. Hodges, “Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS),” March 2011.)](#RFC6125) [RFC6125].
2. If the Client has provided a
   userinfo\_encrypted\_response\_alg
   parameter during Registration, decrypt the UserInfo Response
   using the keys specified during Registration.
3. If the response was signed, the Client SHOULD validate the
   signature according to [JWS (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Signature (JWS),” May 2015.)](#JWS) [JWS].

---

| [TOC](#toc) |
| --- |

### 5.4.  Requesting Claims using Scope Values

OpenID Connect Clients use scope values,
as defined in Section 3.3 of [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749],
to specify what
access privileges are being requested for Access Tokens. The scopes associated
with Access Tokens determine what resources will be available when they are
used to access OAuth 2.0 protected endpoints.
Protected Resource endpoints MAY perform different actions and
return different information based on the scope values and other parameters
used when requesting the presented Access Token.

For OpenID Connect, scopes
can be used to request that specific sets of information
be made available as Claim Values.

Claims requested by the following scopes are treated by Authorization Servers
as Voluntary Claims.

OpenID Connect defines the following scope values
that are used to request Claims:

> profile
> OPTIONAL. This scope value
> requests access to the End-User's default profile Claims,
> which are:
> name,
> family\_name,
> given\_name,
> middle\_name,
> nickname,
> preferred\_username,
> profile,
> picture,
> website,
> gender,
> birthdate,
> zoneinfo,
> locale, and
> updated\_at.
>
> email
> OPTIONAL. This scope value requests access to
> the email and
> email\_verified Claims.
>
> address
> OPTIONAL. This scope value requests access to
> the address Claim.
>
> phone
> OPTIONAL. This scope value requests access to
> the phone\_number and
> phone\_number\_verified Claims.

Multiple scope values MAY be used by creating a space-delimited,
case-sensitive list of ASCII scope values.

The Claims requested by the
profile,
email,
address, and
phone scope values
are returned from the UserInfo Endpoint,
as described in [Section 5.3.2 (Successful UserInfo Response)](#UserInfoResponse),
when a response\_type value is used
that results in an Access Token being issued.
However, when no Access Token is issued
(which is the case for the response\_type
value id\_token),
the resulting Claims are returned in the ID Token.

In some cases, the End-User will be given the option to
have the OpenID Provider decline to provide some or all
information requested by RPs.
To minimize the amount of information that the End-User is being asked
to disclose, an RP can elect to
only request a subset of the information available from the
UserInfo Endpoint.

The following is a non-normative example of an unencoded
scope request:

```

  scope=openid profile email phone

```

---

| [TOC](#toc) |
| --- |

### 5.5.  Requesting Claims using the "claims" Request Parameter

OpenID Connect defines the following Authorization Request parameter
to enable requesting individual Claims
and specifying parameters that apply to the requested Claims:

> claims
> OPTIONAL.
> This parameter is used to request that specific Claims be returned.
> The value is a JSON object listing the requested Claims.

The claims Authentication Request
parameter requests that specific Claims
be returned from the UserInfo Endpoint and/or in the ID Token.
It is represented as a JSON object containing lists of Claims being requested
from these locations.
Properties of the Claims being requested MAY also be specified.

Support for the claims parameter is OPTIONAL.
Should an OP not support this parameter and an RP uses it,
the OP SHOULD return a set of Claims to the RP that it believes would
be useful to the RP and the End-User using whatever heuristics it
believes are appropriate.
The claims\_parameter\_supported
Discovery result indicates whether the OP supports this parameter.

The claims parameter value is represented
in an OAuth 2.0 request as UTF-8 encoded JSON
(which ends up being form-urlencoded when passed as an OAuth parameter).
When used in a Request Object value, per [Section 6.1 (Passing a Request Object by Value)](#RequestObject),
the JSON is used as the value of the
claims member.

The top-level members of the Claims request JSON object are:

> userinfo
> OPTIONAL.
> Requests that the listed individual Claims be returned
> from the UserInfo Endpoint.
> If present, the listed Claims are being requested to be added to
> any Claims that are being requested using
> scope values.
> If not present, the Claims being requested from the UserInfo Endpoint
> are only those requested using scope values.
>
>
> When the userinfo member is used,
> the request MUST also use a response\_type
> value that results in an Access Token being issued to the Client
> for use at the UserInfo Endpoint.
>
> id\_token
> OPTIONAL.
> Requests that the listed individual Claims be returned
> in the ID Token.
> If present, the listed Claims are being requested to be added to
> the default Claims in the ID Token.
> If not present, the default ID Token Claims are requested,
> as per the ID Token definition in [Section 2 (ID Token)](#IDToken)
> and per the additional per-flow ID Token requirements in Sections
> [3.1.3.6 (ID Token)](#CodeIDToken),
> [3.2.2.10 (ID Token)](#ImplicitIDToken),
> [3.3.2.11 (ID Token)](#HybridIDToken),
> and [3.3.3.6 (ID Token)](#HybridIDToken2).

Other members MAY be present.
Any members used that are not understood MUST be ignored.

An example Claims request is as follows:

```

  {
   "userinfo":
    {
     "given_name": {"essential": true},
     "nickname": null,
     "email": {"essential": true},
     "email_verified": {"essential": true},
     "picture": null,
     "http://example.info/claims/groups": null
    },
   "id_token":
    {
     "auth_time": {"essential": true},
     "acr": {"values": ["urn:mace:incommon:iap:silver"] }
    }
  }

```

Note that a Claim that is not in the standard set defined in
[Section 5.1 (Standard Claims)](#StandardClaims), the (example)
http://example.info/claims/groups Claim,
is being requested.
Using the claims parameter
is the only way to request specific combinations of
Claims that cannot be specified using scope values.

---

| [TOC](#toc) |
| --- |

### 5.5.1.  Individual Claims Requests

The userinfo and
id\_token members of the
claims request both are JSON objects
with the names of the individual Claims being requested as the member names.
The member values MUST be one of the following:

> null
> Indicates that this Claim is being requested in the default manner.
> In particular, this is a Voluntary Claim.
> For instance, the Claim request:
> ```
>
>   "given_name": null
>
> ```
>
> requests the given\_name Claim
> in the default manner.
>
> JSON Object
> Used to provide additional information about the Claim being
> requested. This specification defines the following members:
> > essential
> > OPTIONAL.
> > Indicates whether the Claim being requested is an Essential Claim.
> > If the value is true,
> > this indicates that the Claim is an Essential Claim.
> > For instance, the Claim request:
> > ```
> >
> >   "auth_time": {"essential": true}
> >
> > ```
> >
> > can be used to specify that it is Essential to return an
> > auth\_time Claim Value.
> >
> >
> > If the value is false,
> > it indicates that it is a Voluntary Claim.
> > The default is false.
> >
> >
> > By requesting Claims as Essential Claims,
> > the RP indicates to the End-User
> > that releasing these Claims will ensure a smooth authorization
> > for the specific task requested by the End-User.
> > Note that even if the Claims are not available because
> > the End-User did not authorize their release or they are not present,
> > the Authorization Server MUST NOT generate an error when
> > Claims are not returned, whether they are Essential or Voluntary,
> > unless otherwise specified in the description of the specific claim.
> >
> > value
> > OPTIONAL.
> > Requests that the Claim be returned with a particular value.
> > For instance, the Claim request:
> > ```
> >
> >   "sub": {"value": "248289761001"}
> >
> > ```
> >
> > can be used to specify that the request apply to the End-User
> > with Subject Identifier 248289761001.
> >
> >
> > The value of the value member
> > MUST be a valid value for the Claim being requested.
> > Definitions of individual Claims can include requirements on
> > how and whether the value
> > qualifier is to be used when requesting that Claim.
> > An equality comparison is used to determine whether the requested Claim value matches.
> >
> >
> > When the Claim value does not match the requested value,
> > the Claim is not included in the response.
> > If the Claim was sub,
> > a mismatch MUST cause the authentication to fail,
> > as described in [Section 3.1.2.2 (Authentication Request Validation)](#AuthRequestValidation).
> >
> > values
> > OPTIONAL.
> > Requests that the Claim be returned with one of a set of values,
> > with the values appearing in order of preference.
> > This is processed equivalently to a value request,
> > except that a choice of acceptable Claim values is provided.
> >
> >
> > For instance, the Claim request:
> > ```
> >
> >   "acr": {"essential": true,
> >           "values": ["urn:mace:incommon:iap:silver",
> >                      "urn:mace:incommon:iap:bronze"]}
> >
> > ```
> >
> > specifies that it is Essential that the acr
> > Claim be returned with either the value
> > urn:mace:incommon:iap:silver or
> > urn:mace:incommon:iap:bronze.
> >
> >
> > The values in the values member array
> > MUST be valid values for the Claim being requested.
> > Definitions of individual Claims can include requirements on
> > how and whether the values
> > qualifier is to be used when requesting that Claim.
> > An equality comparison is used to determine whether the requested Claim values match.
> >
> >
> > When the Claim value does not match any of the requested values,
> > the Claim is not included in the response.
>
>
>
> Other members MAY be defined to provide additional
> information about the requested Claims.
> Any members used that are not understood MUST be ignored.

Note that when the claims request parameter
is supported, the scope values that request Claims, as defined in
[Section 5.4 (Requesting Claims using Scope Values)](#ScopeClaims), are effectively shorthand methods for
requesting sets of individual Claims.
For example, using the scope value openid email
and a response\_type that returns an Access Token
is equivalent to using the scope value openid
and the following request for individual Claims.

Equivalent of using the email scope value:

```

  {
   "userinfo":
    {
     "email": null,
     "email_verified": null
    }
  }

```

---

| [TOC](#toc) |
| --- |

### 5.5.1.1.  Requesting the "acr" Claim

If the acr Claim is requested
as an Essential Claim for the ID Token
with a value or values parameter requesting
specific Authentication Context Class Reference values and
the implementation supports the claims parameter,
the Authorization Server MUST return an acr
Claim Value that matches one of the requested values.
The Authorization Server MAY ask the End-User to re-authenticate
with additional factors
to meet this requirement. If this is an Essential Claim and the
requirement cannot be met, then the Authorization Server MUST
treat that outcome as a failed authentication attempt.

Note that the RP MAY request the acr
Claim as a Voluntary Claim
by using the acr\_values request parameter
or by not including "essential": true in an individual
acr Claim request.
If the Claim is not Essential and a requested value
cannot be provided, the Authorization Server SHOULD return
the session's current acr as
the value of the acr Claim.
If the Claim is not Essential, the Authorization Server is not required to
provide this Claim in its response.

If the client requests the acr Claim using
both the acr\_values request parameter and
an individual acr Claim request for the ID Token
listing specific requested values,
the resulting behavior is unspecified.

---

| [TOC](#toc) |
| --- |

### 5.5.2.  Languages and Scripts for Individual Claims

As described in [Section 5.2 (Claims Languages and Scripts)](#ClaimsLanguagesAndScripts),
human-readable Claim Values and Claim Values that reference human-readable values
MAY be represented in multiple languages and scripts.
Within a request for individual Claims, requested languages and scripts
for particular Claims MAY be requested by including Claim Names
that contain #-separated
[BCP47 (Phillips, A., Ed. and M. Davis, Ed., “Tags for Identifying Languages,” September 2009.)](#RFC5646) [RFC5646] language tags
in the Claims request, using the Claim Name syntax specified in
[Section 5.2 (Claims Languages and Scripts)](#ClaimsLanguagesAndScripts).
For example, a Family Name in Katakana in Japanese
can be requested using the Claim Name
family\_name#ja-Kana-JP
and a Kanji representation of the Family Name in Japanese
can be requested using the Claim Name
family\_name#ja-Hani-JP.
A German-language Web site can be requested with the Claim Name
website#de.

If an OP receives a request for human-readable Claims in a language and script
that it does not have, any versions of those Claims returned that do not use
the requested language and script SHOULD use a language tag in the Claim Name.

---

| [TOC](#toc) |
| --- |

### 5.6.  Claim Types

Three representations of Claim Values are defined by this specification:

> Normal Claims
> Claims that are directly asserted by
> the OpenID Provider.
>
> Aggregated Claims
> Claims that are asserted by a
> Claims Provider other than the OpenID Provider but are returned
> by OpenID Provider.
>
> Distributed Claims
> Claims that are asserted by a
> Claims Provider other than the OpenID Provider but are returned
> as references by the OpenID Provider.

Normal Claims MUST be supported.
Support for Aggregated Claims and Distributed Claims is OPTIONAL.

---

| [TOC](#toc) |
| --- |

### 5.6.1.  Normal Claims

Normal Claims are represented as members in a JSON object. The
Claim Name is the member name and the Claim Value is the member
value.

The following is a non-normative response containing Normal Claims:

```

  {
   "sub": "248289761001",
   "name": "Jane Doe",
   "given_name": "Jane",
   "family_name": "Doe",
   "email": "janedoe@example.com",
   "picture": "http://example.com/janedoe/me.jpg"
  }

```

---

| [TOC](#toc) |
| --- |

### 5.6.2.  Aggregated and Distributed Claims

Aggregated and distributed Claims are represented by
using special \_claim\_names and
\_claim\_sources members
of the JSON object containing the Claims.

> \_claim\_names
> JSON object whose member
> names are the Claim Names for the Aggregated and Distributed
> Claims. The member values are references to the member names
> in the \_claim\_sources member from which
> the actual Claim Values can be retrieved.
> The OP MAY omit some Claims available from referenced Claims Providers
> from the set of Claim Names.
>
> \_claim\_sources
> JSON object whose
> member names are referenced by the member values of the
> \_claim\_names member. The member values
> contain sets of Aggregated Claims or reference locations for
> Distributed Claims. The member values can have one of the
> following formats depending on whether it is providing
> Aggregated or Distributed Claims:
> > Aggregated Claims
> > JSON object that MUST
> > contain the JWT member whose value is a [JWT (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Token (JWT),” May 2015.)](#JWT) [JWT] that MUST contain all the Claims
> > in the \_claim\_names object that references the
> > corresponding \_claim\_sources member.
> > Other members MAY be present.
> > Any members used that are not understood MUST be ignored.
> > > JWT
> > > REQUIRED.
> > > JWT containing Claim Values.
> >
> >
> >
> > The JWT SHOULD NOT contain a sub (subject)
> > Claim unless its value is an identifier for the End-User at
> > the Claims Provider (and not for the OpenID Provider or another party);
> > this typically means that a sub Claim
> > SHOULD NOT be provided.
> >
> > Distributed Claims
> > JSON object that
> > contains the following members and values:
> > > endpoint
> > > REQUIRED.
> > > OAuth 2.0 resource endpoint from which the associated
> > > Claim can be retrieved. The endpoint URL MUST return
> > > the Claim as a JWT.
> > >
> > > access\_token
> > > OPTIONAL.
> > > Access Token
> > > enabling retrieval of the Claims from the endpoint URL
> > > by using the [OAuth 2.0 Bearer Token Usage (Jones, M. and D. Hardt, “The OAuth 2.0 Authorization Framework: Bearer Token Usage,” October 2012.)](#RFC6750) [RFC6750]
> > > protocol. Claims SHOULD be requested using
> > > the Authorization Request header field and Claims Providers
> > > MUST support this method. If the Access Token
> > > is not available, RPs MAY need to retrieve the
> > > Access Token out of band or use an Access Token
> > > that was pre-negotiated between the Claims Provider and
> > > RP, or the Claims Provider MAY reauthenticate the
> > > End-User and/or reauthorize the RP.
> >
> >
> >
> > Since it is not an error condition to not return a requested Claim,
> > RPs MUST be prepared to handle the condition that some Claims listed in
> > \_claim\_sources are not returned from the Claims Provider.
> > They SHOULD treat this the same as when any other requested Claim is not returned.
> >
> >
> > A sub (subject) Claim SHOULD NOT
> > be returned from the Claims Provider
> > unless its value is an identifier for the End-User at
> > the Claims Provider (and not for the OpenID Provider or another party);
> > this typically means that a sub Claim
> > SHOULD NOT be provided.

An iss (issuer) Claim SHOULD be included
in any JWT issued by a Claims Provider so that the Claims Provider's
keys can be retrieved for signature validation of the JWT.
The value of the Claim is the Claims Provider's Issuer Identifier URL.

In general, it is up to the OP when it is appropriate to use
Aggregated Claims and Distributed Claims.
In some cases, information about when to use what Claim Types
might be negotiated out of band between RPs and OPs.

---

| [TOC](#toc) |
| --- |

### 5.6.2.1.  Example of Aggregated Claims

In this non-normative example, Claims from Claims Provider A
are combined with other Claims held by the OpenID provider, with the
Claims from Claims Provider A being returned as Aggregated Claims.

In this example, these Claims about Jane Doe have been issued by
Claims Provider A.
(The example also includes the Claims Provider's Issuer Identifier URL.)

```

  {
   "iss": "https://a.example.com",
   "address": {
     "street_address": "1234 Hollywood Blvd.",
     "locality": "Los Angeles",
     "region": "CA",
     "postal_code": "90210",
     "country": "United States of America"},
   "phone_number": "+1 (310) 123-4567"
  }

```

Claims Provider A signs the JSON Claims, representing them in a signed JWT:
jwt\_header.jwt\_part2.jwt\_part3.
It is this JWT that is used by the OpenID Provider.

In this example, this JWT containing Jane Doe's Aggregated Claims
from Claims Provider A is combined with other Normal Claims,
and returned as the following set of Claims:

```

  {
   "sub": "248289761001",
   "name": "Jane Doe",
   "given_name": "Jane",
   "family_name": "Doe",
   "birthdate": "0000-03-22",
   "eye_color": "blue",
   "email": "janedoe@example.com",
   "_claim_names": {
     "address": "src1",
     "phone_number": "src1"
   },
   "_claim_sources": {
     "src1": {"JWT": "jwt_header.jwt_part2.jwt_part3"}
   }
  }

```

---

| [TOC](#toc) |
| --- |

### 5.6.2.2.  Example of Distributed Claims

In this non-normative example, the OpenID Provider combines
Normal Claims that it holds with references to Claims held by
two different Claims Providers, B and C, incorporating references
to some of the Claims held by B and C as Distributed Claims.

In this example, these Claims about Jane Doe are held by
Claims Provider B (Jane Doe's bank).
(The example also includes the Claims Provider's Issuer Identifier URL.)

```

  {
   "iss": "https://bank.example.com",
   "shipping_address": {
     "street_address": "1234 Hollywood Blvd.",
     "locality": "Los Angeles",
     "region": "CA",
     "postal_code": "90210",
     "country": "United States of America"},
   "payment_info": "Some_Card 1234 5678 9012 3456",
   "phone_number": "+1 (310) 123-4567"
  }

```

Also in this example, this Claim about Jane Doe is held by
Claims Provider C (a credit agency).
(The example also includes the Claims Provider's Issuer Identifier URL.)

```

  {
   "iss": "https://creditagency.example.com",
   "credit_score": 650
  }

```

The OpenID Provider returns Jane Doe's Claims along with references
to the Distributed Claims from Claims Provider B and Claims Provider C
by sending the Access Tokens and URLs of locations from which the
Distributed Claims can be retrieved:

```

  {
   "sub": "248289761001",
   "name": "Jane Doe",
   "given_name": "Jane",
   "family_name": "Doe",
   "email": "janedoe@example.com",
   "birthdate": "0000-03-22",
   "eye_color": "blue",
   "_claim_names": {
     "payment_info": "src1",
     "shipping_address": "src1",
     "credit_score": "src2"
    },
   "_claim_sources": {
     "src1": {"endpoint":
                "https://bank.example.com/claim_source"},
     "src2": {"endpoint":
                "https://creditagency.example.com/claims_here",
              "access_token": "ksj3n283dke"}
   }
  }

```

Note that not returning phone\_number, which is held by Claims Provider B,
demonstrates that not all Claims held by a utilized Claims Provider need be included.

---

| [TOC](#toc) |
| --- |

### 5.7.  Claim Stability and Uniqueness

The sub (subject) and
iss (issuer) Claims from the ID Token, used together,
are the only Claims that an RP
can rely upon as a stable identifier for the End-User,
since the sub
Claim MUST be locally unique and never reassigned within the Issuer
for a particular End-User, as described in [Section 2 (ID Token)](#IDToken).
Therefore, the only guaranteed unique identifier for a given End-User is the
combination of the iss Claim
and the sub Claim.

All other Claims carry no such guarantees across different issuers in terms of
stability over time or uniqueness across users, and Issuers are permitted to
apply local restrictions and policies. For instance, an Issuer MAY re-use an
email Claim Value across different
End-Users at different points in time, and the claimed
email address for a given End-User MAY change
over time.
Therefore, other Claims such as email,
phone\_number,
preferred\_username,
and name
MUST NOT be used as unique identifiers for the End-User,
whether obtained from the ID Token or the UserInfo Endpoint.

---

| [TOC](#toc) |
| --- |

### 6.  Passing Request Parameters as JWTs

OpenID Connect defines the following Authorization Request parameters
to enable Authentication Requests to be signed and optionally encrypted:

> request
> OPTIONAL.
> This parameter enables
> OpenID Connect requests to be passed in a single,
> self-contained parameter and to be optionally signed and/or encrypted.
> The parameter value is a Request Object value,
> as specified in [Section 6.1 (Passing a Request Object by Value)](#RequestObject).
> It represents the request as a JWT whose Claims
> are the request parameters.
>
> request\_uri
> OPTIONAL.
> This parameter enables
> OpenID Connect requests to be passed by reference, rather than by value.
> The request\_uri value is a URL
> referencing a resource containing a Request Object value,
> which is a JWT containing the request parameters.
> This URL MUST use the https scheme
> unless the target Request Object is signed in a way that is verifiable by the OP.

Requests using these parameters are represented as JWTs, which are respectively
passed by value or by reference.
The ability to pass requests by reference is particularly useful for large requests.
If one of these parameters is used,
the other MUST NOT be used in the same request.

Note that the Request Objects defined here are compatible with those specified by
[The OAuth 2.0 Authorization Framework: JWT-Secured Authorization Request (JAR) (Sakimura, N., Bradley, J., and M. Jones, “The OAuth 2.0 Authorization Framework: JWT-Secured Authorization Request (JAR),” August 2021.)](#RFC9101) [RFC9101].

---

| [TOC](#toc) |
| --- |

### 6.1.  Passing a Request Object by Value

The request Authorization Request parameter
enables OpenID Connect requests to be passed in a single,
self-contained parameter and to be optionally signed and/or encrypted.
It represents the request as a JWT whose Claims are the request parameters
specified in [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint).
This JWT is called a Request Object.

Support for the request parameter is OPTIONAL.
The request\_parameter\_supported
Discovery result indicates whether the OP supports this parameter.
Should an OP not support this parameter and an RP uses it,
the OP MUST return the request\_not\_supported
error.

When the request parameter is used,
the OpenID Connect request parameter values contained in the JWT
supersede those passed using the OAuth 2.0 request syntax.
However, parameters MAY also be passed using the OAuth 2.0 request syntax
even when a Request Object is used;
this would typically be done to enable a cached,
pre-signed (and possibly pre-encrypted) Request Object value
to be used containing the fixed request parameters, while parameters that
can vary with each request, such as state and
nonce, are passed as OAuth 2.0 parameters.

So that the request is a valid OAuth 2.0 Authorization Request,
values for the response\_type and
client\_id parameters MUST be included
using the OAuth 2.0 request syntax, since they are REQUIRED by OAuth 2.0.
The values for these parameters MUST match those in the Request Object,
if present.

Even if a scope parameter
is present in the Request Object value,
a scope parameter MUST always be passed using
the OAuth 2.0 request syntax containing the
openid scope value to indicate to the
underlying OAuth 2.0 logic that this is an OpenID Connect request.

The Request Object MAY be signed or unsigned (unsecured).
When it is unsecured, this is indicated by use of the
none algorithm [[JWA] (Jones, M., “JSON Web Algorithms (JWA),” May 2015.)](#JWA)
in the JOSE Header. If signed, the Request Object
SHOULD contain the Claims
iss (issuer)
and aud (audience) as members.
The iss value SHOULD be the Client ID of the RP,
unless it was signed by a different party than the RP.
The aud value SHOULD be or include
the OP's Issuer Identifier URL.

The Request Object MAY also be encrypted using [JWE (Jones, M. and J. Hildebrand, “JSON Web Encryption (JWE),” May 2015.)](#JWE) [JWE]
and MAY be encrypted without also being signed.
If both signing and encryption are performed, it MUST be signed then encrypted,
with the result being a Nested JWT, as defined in [[JWT] (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Token (JWT),” May 2015.)](#JWT).

request and
request\_uri parameters
MUST NOT be included in Request Objects.

The following is a non-normative example of the Claims in
a Request Object before base64url-encoding and signing:

```

  {
   "iss": "s6BhdRkqt3",
   "aud": "https://server.example.com",
   "response_type": "code id_token",
   "client_id": "s6BhdRkqt3",
   "redirect_uri": "https://client.example.org/cb",
   "scope": "openid",
   "state": "af0ifjsldkj",
   "nonce": "n-0S6_WzA2Mj",
   "max_age": 86400,
   "claims":
    {
     "userinfo":
      {
       "given_name": {"essential": true},
       "nickname": null,
       "email": {"essential": true},
       "email_verified": {"essential": true},
       "picture": null
      },
     "id_token":
      {
       "gender": null,
       "birthdate": {"essential": true},
       "acr": {"values": ["urn:mace:incommon:iap:silver"]}
      }
    }
  }

```

Signing it with the RS256 algorithm
results in this Request Object value
(with line wraps within values for display purposes only):

```

  eyJhbGciOiJSUzI1NiIsImtpZCI6ImsyYmRjIn0.ew0KICJpc3MiOiAiczZCaGRSa3
  F0MyIsDQogImF1ZCI6ICJodHRwczovL3NlcnZlci5leGFtcGxlLmNvbSIsDQogInJl
  c3BvbnNlX3R5cGUiOiAiY29kZSBpZF90b2tlbiIsDQogImNsaWVudF9pZCI6ICJzNk
  JoZFJrcXQzIiwNCiAicmVkaXJlY3RfdXJpIjogImh0dHBzOi8vY2xpZW50LmV4YW1w
  bGUub3JnL2NiIiwNCiAic2NvcGUiOiAib3BlbmlkIiwNCiAic3RhdGUiOiAiYWYwaW
  Zqc2xka2oiLA0KICJub25jZSI6ICJuLTBTNl9XekEyTWoiLA0KICJtYXhfYWdlIjog
  ODY0MDAsDQogImNsYWltcyI6IA0KICB7DQogICAidXNlcmluZm8iOiANCiAgICB7DQ
  ogICAgICJnaXZlbl9uYW1lIjogeyJlc3NlbnRpYWwiOiB0cnVlfSwNCiAgICAgIm5p
  Y2tuYW1lIjogbnVsbCwNCiAgICAgImVtYWlsIjogeyJlc3NlbnRpYWwiOiB0cnVlfS
  wNCiAgICAgImVtYWlsX3ZlcmlmaWVkIjogeyJlc3NlbnRpYWwiOiB0cnVlfSwNCiAg
  ICAgInBpY3R1cmUiOiBudWxsDQogICAgfSwNCiAgICJpZF90b2tlbiI6IA0KICAgIH
  sNCiAgICAgImdlbmRlciI6IG51bGwsDQogICAgICJiaXJ0aGRhdGUiOiB7ImVzc2Vu
  dGlhbCI6IHRydWV9LA0KICAgICAiYWNyIjogeyJ2YWx1ZXMiOiBbInVybjptYWNlOm
  luY29tbW9uOmlhcDpzaWx2ZXIiXX0NCiAgICB9DQogIH0NCn0.nwwnNsk1-Zkbmnvs
  F6zTHm8CHERFMGQPhos-EJcaH4Hh-sMgk8ePrGhw_trPYs8KQxsn6R9Emo_wHwajyF
  KzuMXZFSZ3p6Mb8dkxtVyjoy2GIzvuJT_u7PkY2t8QU9hjBcHs68PkgjDVTrG1uRTx
  0GxFbuPbj96tVuj11pTnmFCUR6IEOXKYr7iGOCRB3btfJhM0_AKQUfqKnRlrRscc8K
  ol-cSLWoYE9l5QqholImzjT_cMnNIznW9E7CDyWXTsO70xnB4SkG6pXfLSjLLlxmPG
  iyon_-Te111V8uE83IlzCYIb_NMXvtTIVc1jpspnTSD7xMbpL-2QgwUsAlMGzw

```

The following RSA public key, represented in JWK format, can be used to
validate the Request Object signature in this
and subsequent Request Object examples
(with line wraps within values for display purposes only):

```

  {
   "kty":"RSA",
   "kid":"k2bdc",
   "n":"y9Lqv4fCp6Ei-u2-ZCKq83YvbFEk6JMs_pSj76eMkddWRuWX2aBKGHAtKlE5P
        7_vn__PCKZWePt3vGkB6ePgzAFu08NmKemwE5bQI0e6kIChtt_6KzT5OaaXDF
        I6qCLJmk51Cc4VYFaxgqevMncYrzaW_50mZ1yGSFIQzLYP8bijAHGVjdEFgZa
        ZEN9lsn_GdWLaJpHrB3ROlS50E45wxrlg9xMncVb8qDPuXZarvghLL0HzOuYR
        adBJVoWZowDNTpKpk2RklZ7QaBO7XDv3uR7s_sf2g-bAjSYxYUGsqkNA9b3xV
        W53am_UZZ3tZbFTIh557JICWKHlWj5uzeJXaw",
   "e":"AQAB"
  }

```

---

| [TOC](#toc) |
| --- |

### 6.1.1.  Request using the "request" Request Parameter

The Client sends the Authorization Request to the
Authorization Endpoint.

The following is a non-normative example of an
Authorization Request using the request
parameter
(with line wraps within values for display purposes only):

```

  https://server.example.com/authorize?
    response_type=code%20id_token
    &client_id=s6BhdRkqt3
    &redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &scope=openid
    &state=af0ifjsldkj
    &nonce=n-0S6_WzA2Mj
    &request=eyJhbGciOiJSUzI1NiIsImtpZCI6ImsyYmRjIn0.ew0KICJpc3MiOiA
    iczZCaGRSa3F0MyIsDQogImF1ZCI6ICJodHRwczovL3NlcnZlci5leGFtcGxlLmN
    vbSIsDQogInJlc3BvbnNlX3R5cGUiOiAiY29kZSBpZF90b2tlbiIsDQogImNsaWV
    udF9pZCI6ICJzNkJoZFJrcXQzIiwNCiAicmVkaXJlY3RfdXJpIjogImh0dHBzOi8
    vY2xpZW50LmV4YW1wbGUub3JnL2NiIiwNCiAic2NvcGUiOiAib3BlbmlkIiwNCiA
    ic3RhdGUiOiAiYWYwaWZqc2xka2oiLA0KICJub25jZSI6ICJuLTBTNl9XekEyTWo
    iLA0KICJtYXhfYWdlIjogODY0MDAsDQogImNsYWltcyI6IA0KICB7DQogICAidXN
    lcmluZm8iOiANCiAgICB7DQogICAgICJnaXZlbl9uYW1lIjogeyJlc3NlbnRpYWw
    iOiB0cnVlfSwNCiAgICAgIm5pY2tuYW1lIjogbnVsbCwNCiAgICAgImVtYWlsIjo
    geyJlc3NlbnRpYWwiOiB0cnVlfSwNCiAgICAgImVtYWlsX3ZlcmlmaWVkIjogeyJ
    lc3NlbnRpYWwiOiB0cnVlfSwNCiAgICAgInBpY3R1cmUiOiBudWxsDQogICAgfSw
    NCiAgICJpZF90b2tlbiI6IA0KICAgIHsNCiAgICAgImdlbmRlciI6IG51bGwsDQo
    gICAgICJiaXJ0aGRhdGUiOiB7ImVzc2VudGlhbCI6IHRydWV9LA0KICAgICAiYWN
    yIjogeyJ2YWx1ZXMiOiBbInVybjptYWNlOmluY29tbW9uOmlhcDpzaWx2ZXIiXX0
    NCiAgICB9DQogIH0NCn0.nwwnNsk1-ZkbmnvsF6zTHm8CHERFMGQPhos-EJcaH4H
    h-sMgk8ePrGhw_trPYs8KQxsn6R9Emo_wHwajyFKzuMXZFSZ3p6Mb8dkxtVyjoy2
    GIzvuJT_u7PkY2t8QU9hjBcHs68PkgjDVTrG1uRTx0GxFbuPbj96tVuj11pTnmFC
    UR6IEOXKYr7iGOCRB3btfJhM0_AKQUfqKnRlrRscc8Kol-cSLWoYE9l5QqholImz
    jT_cMnNIznW9E7CDyWXTsO70xnB4SkG6pXfLSjLLlxmPGiyon_-Te111V8uE83Il
    zCYIb_NMXvtTIVc1jpspnTSD7xMbpL-2QgwUsAlMGzw

```

---

| [TOC](#toc) |
| --- |

### 6.2.  Passing a Request Object by Reference

The request\_uri Authorization Request parameter enables
OpenID Connect requests to be passed by reference, rather than by value.
This parameter is used identically to the
request parameter, other than that
the Request Object value is retrieved from the resource at the specified URL,
rather than passed by value.

The request\_uri\_parameter\_supported
Discovery result indicates whether the OP supports this parameter.
Should an OP not support this parameter and an RP uses it,
the OP MUST return the request\_uri\_not\_supported
error.

When the request\_uri parameter is used,
the OpenID Connect request parameter values contained in the referenced JWT
supersede those passed using the OAuth 2.0 request syntax.
However, parameters MAY also be passed using the OAuth 2.0 request syntax
even when a request\_uri is used;
this would typically be done to enable a cached,
pre-signed (and possibly pre-encrypted) Request Object value
to be used containing the fixed request parameters, while parameters that
can vary with each request, such as state and
nonce, are passed as OAuth 2.0 parameters.

So that the request is a valid OAuth 2.0 Authorization Request,
values for the response\_type and
client\_id parameters MUST be included
using the OAuth 2.0 request syntax, since they are REQUIRED by OAuth 2.0.
The values for these parameters MUST match those in the Request Object,
if present.

Even if a scope parameter
is present in the referenced Request Object,
a scope parameter MUST always be passed using
the OAuth 2.0 request syntax containing the
openid scope value to indicate to the
underlying OAuth 2.0 logic that this is an OpenID Connect request.

Servers MAY cache the contents of the resources referenced by Request URIs.
If the contents of the referenced resource could ever change,
the URI SHOULD include the base64url-encoded SHA-256 hash of the
referenced resource contents as the fragment component of the URI.
If the fragment value used for a URI changes, that signals the server
that any cached value for that URI with the old fragment value
is no longer valid.

Note that Clients MAY pre-register
request\_uri values using the
request\_uris parameter defined in
Section 2.1 of the
[OpenID Connect Dynamic Client Registration 1.0 (Sakimura, N., Bradley, J., and M. Jones, “OpenID Connect Dynamic Client Registration 1.0,” December 2023.)](#OpenID.Registration) [OpenID.Registration]
specification.
OPs can require that request\_uri values used
be pre-registered with the require\_request\_uri\_registration
discovery parameter.

The entire Request URI SHOULD NOT exceed 512 ASCII characters.

The contents of the resource referenced by the URL MUST be a Request Object.
The scheme used in the
request\_uri value MUST be https,
unless the target Request Object is signed in a way that is verifiable by the
Authorization Server.
The request\_uri value MUST be reachable by the
Authorization Server and SHOULD be reachable by the Client.

The following is a non-normative example of
the contents of a Request Object resource that can be
referenced by a request\_uri
(with line wraps within values for display purposes only):

```

  eyJhbGciOiJSUzI1NiIsImtpZCI6ImsyYmRjIn0.ew0KICJpc3MiOiAiczZCaGRSa3
  F0MyIsDQogImF1ZCI6ICJodHRwczovL3NlcnZlci5leGFtcGxlLmNvbSIsDQogInJl
  c3BvbnNlX3R5cGUiOiAiY29kZSBpZF90b2tlbiIsDQogImNsaWVudF9pZCI6ICJzNk
  JoZFJrcXQzIiwNCiAicmVkaXJlY3RfdXJpIjogImh0dHBzOi8vY2xpZW50LmV4YW1w
  bGUub3JnL2NiIiwNCiAic2NvcGUiOiAib3BlbmlkIiwNCiAic3RhdGUiOiAiYWYwaW
  Zqc2xka2oiLA0KICJub25jZSI6ICJuLTBTNl9XekEyTWoiLA0KICJtYXhfYWdlIjog
  ODY0MDAsDQogImNsYWltcyI6IA0KICB7DQogICAidXNlcmluZm8iOiANCiAgICB7DQ
  ogICAgICJnaXZlbl9uYW1lIjogeyJlc3NlbnRpYWwiOiB0cnVlfSwNCiAgICAgIm5p
  Y2tuYW1lIjogbnVsbCwNCiAgICAgImVtYWlsIjogeyJlc3NlbnRpYWwiOiB0cnVlfS
  wNCiAgICAgImVtYWlsX3ZlcmlmaWVkIjogeyJlc3NlbnRpYWwiOiB0cnVlfSwNCiAg
  ICAgInBpY3R1cmUiOiBudWxsDQogICAgfSwNCiAgICJpZF90b2tlbiI6IA0KICAgIH
  sNCiAgICAgImdlbmRlciI6IG51bGwsDQogICAgICJiaXJ0aGRhdGUiOiB7ImVzc2Vu
  dGlhbCI6IHRydWV9LA0KICAgICAiYWNyIjogeyJ2YWx1ZXMiOiBbInVybjptYWNlOm
  luY29tbW9uOmlhcDpzaWx2ZXIiXX0NCiAgICB9DQogIH0NCn0.nwwnNsk1-Zkbmnvs
  F6zTHm8CHERFMGQPhos-EJcaH4Hh-sMgk8ePrGhw_trPYs8KQxsn6R9Emo_wHwajyF
  KzuMXZFSZ3p6Mb8dkxtVyjoy2GIzvuJT_u7PkY2t8QU9hjBcHs68PkgjDVTrG1uRTx
  0GxFbuPbj96tVuj11pTnmFCUR6IEOXKYr7iGOCRB3btfJhM0_AKQUfqKnRlrRscc8K
  ol-cSLWoYE9l5QqholImzjT_cMnNIznW9E7CDyWXTsO70xnB4SkG6pXfLSjLLlxmPG
  iyon_-Te111V8uE83IlzCYIb_NMXvtTIVc1jpspnTSD7xMbpL-2QgwUsAlMGzw

```

---

| [TOC](#toc) |
| --- |

### 6.2.1.  URI Referencing the Request Object

The Client stores the Request Object resource either
locally or remotely at a URL the Server can access.
This URL is the Request URI, request\_uri.

If the Request Object includes requested values for Claims,
it MUST NOT be revealed to anybody but the Authorization Server.
As such, the request\_uri MUST have
appropriate entropy for its lifetime.
It is RECOMMENDED that it be removed
if it is known that it will not be used again
or after a reasonable timeout
unless access control measures are taken.

The following is a non-normative example
of a Request URI value
(with line wraps within values for display purposes only):

```

  https://client.example.org/request.jwt#
    GkurKxf5T0Y-mnPFCHqWOMiZi4VS138cQO_V7PZHAdM

```

---

| [TOC](#toc) |
| --- |

### 6.2.2.  Request using the "request\_uri" Request Parameter

The Client sends the Authorization Request to the
Authorization Endpoint.

The following is a non-normative example
of an Authorization Request using the request\_uri parameter
(with line wraps within values for display purposes only):

```

  https://server.example.com/authorize?
    response_type=code%20id_token
    &client_id=s6BhdRkqt3
    &request_uri=https%3A%2F%2Fclient.example.org%2Frequest.jwt
    %23GkurKxf5T0Y-mnPFCHqWOMiZi4VS138cQO_V7PZHAdM
    &state=af0ifjsldkj&nonce=n-0S6_WzA2Mj
    &scope=openid

```

---

| [TOC](#toc) |
| --- |

### 6.2.3.  Authorization Server Fetches Request Object

Upon receipt of the Request, the Authorization Server MUST
send an HTTP GET request to the request\_uri
to retrieve the referenced Request Object, unless it is already cached, and parse it
to recreate the Authorization Request parameters.

Note that the RP SHOULD use a unique URI for each
request utilizing distinct parameters, or otherwise
prevent the Authorization Server from caching the request\_uri.

The following is a non-normative example of this fetch
process:

```

  GET /request.jwt HTTP/1.1
  Host: client.example.org

```

---

| [TOC](#toc) |
| --- |

### 6.2.4.  "request\_uri" Rationale

There are several reasons that one might choose to use the
request\_uri parameter:

1. The set of request parameters can become large and can exceed browser
   URI size limitations. Passing the request parameters by reference
   can solve this problem.
2. Passing a request\_uri value, rather than
   a complete request by value, can reduce request latency.
3. Most requests for Claims from an RP are constant.
   The request\_uri is a way of creating
   and sometimes also signing and encrypting a constant set of
   request parameters in advance.
   (The request\_uri value becomes an "artifact"
   representing a particular fixed set of request parameters.)
4. Pre-registering a fixed set of request parameters at Registration time
   enables OPs to cache and pre-validate the request parameters at
   Registration time, meaning they need not be retrieved at request time.
5. Pre-registering a fixed set of request parameters at
   Registration time enables OPs to vet the contents of
   the request from consumer protection and other points
   of views, either itself or by utilizing a third party.

---

| [TOC](#toc) |
| --- |

### 6.3.  Validating JWT-Based Requests

When the request or
request\_uri Authorization Request parameters
are used, additional steps must be performed to validate the
Authentication Request beyond those specified in
Sections [3.1.2.2 (Authentication Request Validation)](#AuthRequestValidation),
[3.2.2.2 (Authentication Request Validation)](#ImplicitValidation), or
[3.3.2.2 (Authentication Request Validation)](#HybridValidation).
These steps are to validate the JWT containing the Request Object
and to validate the Request Object itself.

---

| [TOC](#toc) |
| --- |

### 6.3.1.  Encrypted Request Object

If the Authorization Server has advertised JWE encryption algorithms
in the request\_object\_encryption\_alg\_values\_supported and
request\_object\_encryption\_enc\_values\_supported elements of its
Discovery document [[OpenID.Discovery] (Sakimura, N., Bradley, J., Jones, M., and E. Jay, “OpenID Connect Discovery 1.0,” December 2023.)](#OpenID.Discovery),
or has supplied encryption algorithms by other means,
these are used by the Client to encrypt the JWT.

The Authorization Server MUST decrypt the JWT in accordance with
the [JSON Web Encryption (Jones, M. and J. Hildebrand, “JSON Web Encryption (JWE),” May 2015.)](#JWE) [JWE] specification.
The result MAY be either a signed or unsigned (unsecured) Request Object.
In the former case, signature validation MUST be performed
as defined in [Section 6.3.2 (Signed Request Object)](#SignedRequestObject).

The Authorization Server MUST return an error if decryption fails.

---

| [TOC](#toc) |
| --- |

### 6.3.2.  Signed Request Object

To perform Signature Validation,
the alg Header Parameter in the JOSE Header MUST match the value
of the request\_object\_signing\_alg set during
Client Registration [[OpenID.Registration] (Sakimura, N., Bradley, J., and M. Jones, “OpenID Connect Dynamic Client Registration 1.0,” December 2023.)](#OpenID.Registration) or a value that was
pre-registered by other means.
The signature MUST be validated against the appropriate key
for that client\_id
and algorithm.

The Authorization Server MUST return an error if signature validation fails.

---

| [TOC](#toc) |
| --- |

### 6.3.3.  Request Parameter Assembly and Validation

The Authorization Server MUST assemble
the set of Authorization Request parameters to be used
from the Request Object value
and the OAuth 2.0 Authorization Request parameters
(minus the request or
request\_uri parameters).
If the same parameter exists both in
the Request Object and the OAuth Authorization Request parameters,
the parameter in the Request Object is used.
Using the assembled set of Authorization Request parameters,
the Authorization Server then validates the request
the normal manner for the flow being used, as specified in
Sections [3.1.2.2 (Authentication Request Validation)](#AuthRequestValidation),
[3.2.2.2 (Authentication Request Validation)](#ImplicitValidation), or
[3.3.2.2 (Authentication Request Validation)](#HybridValidation).

---

| [TOC](#toc) |
| --- |

### 7.  Self-Issued OpenID Provider

OpenID Connect supports Self-Issued OpenID Providers -
personal, self-hosted OPs that issue self-signed ID Tokens.
Self-Issued OPs use the special Issuer Identifier
https://self-issued.me.

The messages used to communicate with Self-Issued OPs are
mostly the same as those used to communicate with other OPs.
Specifications for the few additional parameters used and
for the values of some parameters in the Self-Issued case
are defined in this section.

---

| [TOC](#toc) |
| --- |

### 7.1.  Self-Issued OpenID Provider Discovery

If the input identifier for the discovery process
contains the domain self-issued.me, dynamic discovery is not performed.
Instead, then the following static configuration values are used:

```

  {
   "authorization_endpoint":
     "openid:",
   "issuer":
     "https://self-issued.me",
   "scopes_supported":
     ["openid", "profile", "email", "address", "phone"],
   "response_types_supported":
     ["id_token"],
   "subject_types_supported":
     ["pairwise"],
   "id_token_signing_alg_values_supported":
     ["RS256"],
   "request_object_signing_alg_values_supported":
     ["none", "RS256"]
  }

```

NOTE: The OpenID Foundation plans to host the OpenID Provider site
https://self-issued.me/,
including its WebFinger service, so that performing discovery on it
returns the above static discovery information, enabling RPs
to not need any special processing for discovery of the Self-Issued OP.
This site will be hosted on an experimental basis.
Production implementations should not take a dependency upon it
without a subsequent commitment by the OpenID Foundation
to host the site in a manner intended for production use.

---

| [TOC](#toc) |
| --- |

### 7.2.  Self-Issued OpenID Provider Registration

When using a Self-Issued OP, registration is not required.
The Client can proceed without registration as if it had
registered with the OP and obtained the following
Client Registration Response:

> client\_id
> redirect\_uri value of the Client.
>
> client\_secret\_expires\_at
> 0

NOTE: The OpenID Foundation plans to host the (stateless) endpoint
https://self-issued.me/registration/1.0/
that returns the response above, enabling RPs to not need
any special processing for registration with the Self-Issued OP.
This site will be hosted on an experimental basis.
Production implementations should not take a dependency upon it
without a subsequent commitment by the OpenID Foundation
to host the site in a manner intended for production use.

---

| [TOC](#toc) |
| --- |

### 7.2.1.  Providing Information with the "registration" Request Parameter

OpenID Connect defines the following Authorization Request parameter
to enable Clients to provide additional registration information to
Self-Issued OpenID Providers:

> registration
> OPTIONAL.
> This parameter is used by the Client to provide information about itself
> to a Self-Issued OP that would normally be provided to an OP during
> Dynamic Client Registration.
> The value is a JSON object containing Client metadata values,
> as defined in Section 2.1 of the
> [OpenID Connect Dynamic Client Registration 1.0 (Sakimura, N., Bradley, J., and M. Jones, “OpenID Connect Dynamic Client Registration 1.0,” December 2023.)](#OpenID.Registration) [OpenID.Registration]
> specification.
> The registration parameter SHOULD NOT be used
> when the OP is not a Self-Issued OP.

None of this information is REQUIRED by Self-Issued OPs,
so the use of this parameter is OPTIONAL.

The registration parameter value is represented
in an OAuth 2.0 request as a UTF-8 encoded JSON object
(which ends up being form-urlencoded when passed as an OAuth parameter).
When used in a Request Object value, per [Section 6.1 (Passing a Request Object by Value)](#RequestObject),
the JSON object is used as the value of the
registration member.

The Registration parameters that would typically be used in requests
to Self-Issued OPs are
policy\_uri,
tos\_uri, and
logo\_uri.
If the Client uses more than one Redirection URI, the
redirect\_uris
parameter would be used to register them.
Finally, if the Client is requesting encrypted responses, it would typically use the
jwks\_uri,
id\_token\_encrypted\_response\_alg and
id\_token\_encrypted\_response\_enc parameters.

---

| [TOC](#toc) |
| --- |

### 7.3.  Self-Issued OpenID Provider Request

The self-issued OP's Authorization Endpoint is the URI openid:.

The Client sends the Authentication Request to the Authorization Endpoint
with the following parameters:

> scope
> REQUIRED.
> scope parameter value,
> as specified in [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint).
>
> response\_type
> REQUIRED. Constant string value id\_token.
>
> client\_id
> REQUIRED.
> Client ID value for the Client, which in this case contains the
> redirect\_uri value of the Client.
> Since the Client's
> redirect\_uri URI value is communicated
> as the Client ID,
> a redirect\_uri parameter
> is NOT REQUIRED to also be included in the request.
>
> id\_token\_hint
> OPTIONAL.
> id\_token\_hint parameter value,
> as specified in [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint).
> Encrypting content to Self-Issued OPs is not supported.
>
> claims
> OPTIONAL.
> claims parameter value,
> as specified in [Section 5.5 (Requesting Claims using the "claims" Request Parameter)](#ClaimsParameter).
>
> registration
> OPTIONAL.
> This parameter is used by the Client to provide information about itself
> to a Self-Issued OP that would normally be provided to an OP during
> Dynamic Client Registration,
> as specified in [Section 7.2.1 (Providing Information with the "registration" Request Parameter)](#RegistrationParameter).
>
> request
> OPTIONAL.
> Request Object value, as specified in [Section 6.1 (Passing a Request Object by Value)](#RequestObject).
> Encrypting content to Self-Issued OPs is not supported.

Other parameters MAY be sent.
Note that all Claims are returned in the ID Token.

The entire URL MUST NOT exceed 2048 ASCII characters.

The following is a non-normative example
HTTP 302 redirect response by the Client, which triggers
the User Agent to make an Authentication Request
to the Self-Issued OpenID Provider
(with line wraps within values for display purposes only):

```

  HTTP/1.1 302 Found
  Location: openid://?
    response_type=id_token
    &client_id=https%3A%2F%2Fclient.example.org%2Fcb
    &scope=openid%20profile
    &state=af0ifjsldkj
    &nonce=n-0S6_WzA2Mj
    &registration=%7B%22logo_uri%22%3A%22https%3A%2F%2F
      client.example.org%2Flogo.png%22%7D

```

---

| [TOC](#toc) |
| --- |

### 7.4.  Self-Issued OpenID Provider Response

OpenID Connect defines the following Claim
for use in Self-Issued OpenID Provider Responses:

> sub\_jwk
> REQUIRED.
> Public key used to check the signature of an ID Token
> issued by a Self-Issued OpenID Provider,
> as specified in [Section 7 (Self-Issued OpenID Provider)](#SelfIssued).
> The key is a bare key in JWK [[JWK] (Jones, M., “JSON Web Key (JWK),” May 2015.)](#JWK) format
> (not an X.509 certificate value).
> The sub\_jwk value is a JSON object.
> Use of the sub\_jwk Claim
> is NOT RECOMMENDED when the OP is not Self-Issued.

The Self-Issued OpenID Provider response is the same as the normal Implicit Flow
response with the following refinements. Since it is an Implicit Flow
response, the response parameters will be returned in the URL fragment component,
unless a different Response Mode was specified.

1. The iss (issuer) Claim Value is
   https://self-issued.me.
2. A sub\_jwk Claim is present, with its value being
   the public key used to check the signature of the ID Token.
3. The sub (subject) Claim
   value is the base64url-encoded representation of
   the thumbprint of
   the key in the sub\_jwk Claim.
   This thumbprint value is computed as
   the SHA-256 hash of
   the octets of the UTF-8 representation of
   a JWK constructed containing only the REQUIRED members to represent the key,
   with the member names sorted into lexicographic order,
   and with no whitespace or line breaks.
   For instance,
   when the kty value is
   RSA, the member names
   e,
   kty, and
   n
   are the ones present in the constructed JWK used
   in the thumbprint computation and appear in that order;
   when the kty value is
   EC, the member names
   crv,
   kty,
   x, and
   y
   are present in that order.
   Note that this thumbprint calculation is the same as that defined in
   the JWK Thumbprint [[JWK.Thumbprint] (Jones, M. and N. Sakimura, “JSON Web Key (JWK) Thumbprint,” September 2015.)](#JWK.Thumbprint) specification.
4. No Access Token is returned for accessing a UserInfo Endpoint,
   so all Claims returned MUST be in the ID Token.

---

| [TOC](#toc) |
| --- |

### 7.5.  Self-Issued ID Token Validation

To validate the ID Token received, the Client MUST do the following:

1. The Client MUST validate that the value of the iss (issuer) Claim is https://self-issued.me.
   If iss contains a different value,
   the ID Token is not Self-Issued, and instead
   it MUST be validated according to
   [Section 3.1.3.7 (ID Token Validation)](#IDTokenValidation).
2. The Client MUST validate that the
   aud (audience) Claim
   contains the value of the redirect\_uri
   that the Client sent in the Authentication Request as an audience.
3. The Client MUST validate the signature of the ID Token according to
   [JWS (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Signature (JWS),” May 2015.)](#JWS) [JWS] using the algorithm specified in the
   alg Header Parameter of the JOSE Header,
   using the key in the sub\_jwk Claim;
   the key is a bare key in JWK format
   (not an X.509 certificate value).
4. The alg value SHOULD be the default of
   RS256.
   It MAY also be ES256.
5. The Client MUST validate that the sub Claim
   value is the base64url-encoded representation of
   the thumbprint of
   the key in the sub\_jwk Claim,
   as specified in [Section 7.4 (Self-Issued OpenID Provider Response)](#SelfIssuedResponse).
6. The current time MUST be before the time represented by the
   exp Claim
   (possibly allowing for some small leeway to account for clock skew).
7. The iat Claim can be used to reject tokens that
   were issued too far away from the current time, limiting the amount of
   time that nonces need to be stored to prevent attacks.
   The acceptable range is Client specific.
8. A nonce Claim MUST be present
   and its value checked to verify that
   it is the same value as the one that was sent in the Authentication Request.
   The Client SHOULD check the nonce value
   for replay attacks.
   The precise method for detecting replay attacks is Client specific.

The following is a non-normative example of a base64url-decoded
Self-Issued ID Token
(with line wraps within values for display purposes only):

```

  {
   "iss": "https://self-issued.me",
   "sub": "NzbLsXh8uDCcd-6MNwXF4W_7noWXFZAfHkxZsRGC9Xs",
   "aud": "https://client.example.org/cb",
   "nonce": "n-0S6_WzA2Mj",
   "exp": 1311281970,
   "iat": 1311280970,
   "sub_jwk": {
     "kty":"RSA",
     "n": "0vx7agoebGcQSuuPiLJXZptN9nndrQmbXEps2aiAFbWhM78LhWx
     4cbbfAAtVT86zwu1RK7aPFFxuhDR1L6tSoc_BJECPebWKRXjBZCiFV4n3oknjhMs
     tn64tZ_2W-5JsGY4Hc5n9yBXArwl93lqt7_RN5w6Cf0h4QyQ5v-65YGjQR0_FDW2
     QvzqY368QQMicAtaSqzs8KJZgnYb9c7d0zgdAZHzu6qMQvRL5hajrn1n91CbOpbI
     SD08qNLyrdkt-bFTWhAI4vMQFh6WeZu0fM4lFd2NcRwr3XPksINHaQ-G_xBniIqb
     w0Ls1jF44-csFCur-kEgU8awapJzKnqDKgw",
     "e":"AQAB"
    }
  }

```

---

| [TOC](#toc) |
| --- |

### 8.  Subject Identifier Types

A Subject Identifier is a locally unique and never
reassigned identifier within the Issuer for the End-User,
which is intended to be consumed by the Client.
Two Subject Identifier types are defined by this specification:

> public
> This provides the same sub (subject) value to all Clients.
> It is the default if the provider has no subject\_types\_supported
> element in its discovery document.
>
> pairwise
> This provides a different sub
> value to each Client, so as not to enable Clients to correlate
> the End-User's activities without permission.

The OpenID Provider's Discovery document MUST list
its supported Subject Identifier types in the
subject\_types\_supported element.
If there is more than one type listed in the array, the Client MAY elect to
provide its preferred identifier type using the
subject\_type parameter during Registration.

---

| [TOC](#toc) |
| --- |

### 8.1.  Pairwise Identifier Algorithm

When pairwise Subject Identifiers are used,
the OpenID Provider MUST calculate a unique
sub (subject) value for each
Sector Identifier. The Subject Identifier value MUST NOT be reversible
by any party other than the OpenID Provider.

Providers that use pairwise sub values
and support
[Dynamic Client Registration (Sakimura, N., Bradley, J., and M. Jones, “OpenID Connect Dynamic Client Registration 1.0,” December 2023.)](#OpenID.Registration) [OpenID.Registration]
SHOULD use the sector\_identifier\_uri parameter.
It provides a way for a group of websites under common administrative
control to have consistent pairwise sub
values independent of the individual domain names.
It also provides a way for Clients to change
redirect\_uri domains without having to
re-register all of their users.

If the Client has not provided a value for
sector\_identifier\_uri in
[Dynamic Client Registration (Sakimura, N., Bradley, J., and M. Jones, “OpenID Connect Dynamic Client Registration 1.0,” December 2023.)](#OpenID.Registration) [OpenID.Registration],
the Sector Identifier
used for pairwise identifier calculation is the host component
of the registered redirect\_uri.
If there are multiple hostnames in the registered
redirect\_uris, the Client MUST register a
sector\_identifier\_uri.

When a sector\_identifier\_uri
is provided, the host component of that URL is used as
the Sector Identifier for the pairwise identifier calculation.
The value of the sector\_identifier\_uri
MUST be a URL using the https scheme that points to
a JSON file containing an array of
redirect\_uri values.
The values of the registered redirect\_uris
MUST be included in the elements of the array.

Any algorithm with the following properties
can be used by OpenID Providers to
calculate pairwise Subject Identifiers:

* The Subject Identifier value MUST NOT be reversible
  by any party other than the OpenID Provider.
* Distinct Sector Identifier values MUST result in
  distinct Subject Identifier values.
* The algorithm MUST be deterministic.

Three example methods are:

1. The Sector Identifier can be concatenated with a local account ID and a salt
   value that is kept secret by the Provider. The concatenated string is then
   hashed using an appropriate algorithm.

   Calculate sub = SHA-256 ( sector\_identifier || local\_account\_id || salt ).
2. The Sector Identifier can be concatenated with a local account ID and a salt
   value that is kept secret by the Provider. The concatenated string is then
   encrypted using an appropriate algorithm.

   Calculate sub = AES-128 ( sector\_identifier || local\_account\_id || salt ).
3. The Issuer creates a Globally Unique Identifier (GUID) for the pair of
   Sector Identifier and local account ID and stores this value.

---

| [TOC](#toc) |
| --- |

### 9.  Client Authentication

This section defines a set of Client Authentication methods
that are used by Clients to authenticate to the Authorization Server
when using the Token Endpoint.
During Client Registration, the RP (Client) MAY register a Client Authentication method.
If no method is registered, the default method is client\_secret\_basic.

These Client Authentication methods are:

> client\_secret\_basic
> Clients that have received a client\_secret value
> from the Authorization Server authenticate with the Authorization Server
> in accordance with Section 2.3.1 of [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749] using the HTTP Basic authentication scheme.
>
> client\_secret\_post
> Clients that have received a client\_secret value
> from the Authorization Server, authenticate with the Authorization Server
> in accordance with Section 2.3.1 of [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749] by including the Client Credentials in the request body.
>
> client\_secret\_jwt
> Clients that have received a client\_secret value
> from the Authorization Server create a JWT using an
> HMAC SHA algorithm, such as HMAC SHA-256.
> The HMAC (Hash-based Message Authentication Code) is calculated using
> the octets of the UTF-8 representation of
> the client\_secret as the shared key.
>
>
> The Client authenticates in accordance with [JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants (Jones, M., Campbell, B., and C. Mortimore, “JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants,” May 2015.)](#OAuth.JWT) [OAuth.JWT] and
> [Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants (Campbell, B., Mortimore, C., Jones, M., and Y. Goland, “Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants,” May 2015.)](#OAuth.Assertions) [OAuth.Assertions].
> The JWT MUST contain the following REQUIRED Claim Values and
> MAY contain the following OPTIONAL Claim Values:
>
>
> > iss
> > REQUIRED.
> > Issuer.
> > This MUST contain the client\_id of the OAuth Client.
> >
> > sub
> > REQUIRED.
> > Subject.
> > This MUST contain the client\_id of the OAuth Client.
> >
> > aud
> > REQUIRED.
> > Audience.
> > The aud (audience) Claim.
> > Value that identifies the Authorization Server as an intended audience.
> > The Authorization Server MUST verify that it is an intended audience
> > for the token.
> > The Audience SHOULD be the URL of the
> > Authorization Server's Token Endpoint.
> >
> > jti
> > REQUIRED.
> > JWT ID.
> > A unique identifier for the token,
> > which can be used to prevent reuse of the token.
> > These tokens MUST only be used once,
> > unless conditions for reuse were negotiated between the parties;
> > any such negotiation is beyond the scope of this specification.
> >
> > exp
> > REQUIRED.
> > Expiration time on or after which the JWT MUST NOT be
> > accepted for processing.
> >
> > iat
> > OPTIONAL.
> > Time at which the JWT was issued.
>
>
>
> The JWT MAY contain other Claims.
> Any Claims used that are not understood MUST be ignored.
>
>
> The authentication token MUST be sent as the value of the
> [[OAuth.Assertions] (Campbell, B., Mortimore, C., Jones, M., and Y. Goland, “Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants,” May 2015.)](#OAuth.Assertions)
> client\_assertion parameter.
>
>
> The value of the
> [[OAuth.Assertions] (Campbell, B., Mortimore, C., Jones, M., and Y. Goland, “Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants,” May 2015.)](#OAuth.Assertions)
> client\_assertion\_type parameter
> MUST be "urn:ietf:params:oauth:client-assertion-type:jwt-bearer",
> per [[OAuth.JWT] (Jones, M., Campbell, B., and C. Mortimore, “JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants,” May 2015.)](#OAuth.JWT).
>
> private\_key\_jwt
> Clients that have registered a public key sign a JWT using
> that key.
> The Client authenticates in accordance with [JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants (Jones, M., Campbell, B., and C. Mortimore, “JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants,” May 2015.)](#OAuth.JWT) [OAuth.JWT] and
> [Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants (Campbell, B., Mortimore, C., Jones, M., and Y. Goland, “Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants,” May 2015.)](#OAuth.Assertions) [OAuth.Assertions].
> The JWT MUST contain the following REQUIRED Claim Values and
> MAY contain the following OPTIONAL Claim Values:
>
>
> > iss
> > REQUIRED.
> > Issuer.
> > This MUST contain the client\_id of the OAuth Client.
> >
> > sub
> > REQUIRED.
> > Subject.
> > This MUST contain the client\_id of the OAuth Client.
> >
> > aud
> > REQUIRED.
> > Audience.
> > The aud (audience) Claim.
> > Value that identifies the Authorization Server as an intended audience.
> > The Authorization Server MUST verify that it is an intended audience
> > for the token.
> > The Audience SHOULD be the URL of the
> > Authorization Server's Token Endpoint.
> >
> > jti
> > REQUIRED.
> > JWT ID.
> > A unique identifier for the token,
> > which can be used to prevent reuse of the token.
> > These tokens MUST only be used once,
> > unless conditions for reuse were negotiated between the parties;
> > any such negotiation is beyond the scope of this specification.
> >
> > exp
> > REQUIRED.
> > Expiration time on or after which the JWT MUST NOT be
> > accepted for processing.
> >
> > iat
> > OPTIONAL.
> > Time at which the JWT was issued.
>
>
>
> The JWT MAY contain other Claims.
> Any Claims used that are not understood MUST be ignored.
>
>
> The authentication token MUST be sent as the value of the
> [[OAuth.Assertions] (Campbell, B., Mortimore, C., Jones, M., and Y. Goland, “Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants,” May 2015.)](#OAuth.Assertions)
> client\_assertion parameter.
>
>
> The value of the
> [[OAuth.Assertions] (Campbell, B., Mortimore, C., Jones, M., and Y. Goland, “Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants,” May 2015.)](#OAuth.Assertions)
> client\_assertion\_type parameter
> MUST be "urn:ietf:params:oauth:client-assertion-type:jwt-bearer",
> per [[OAuth.JWT] (Jones, M., Campbell, B., and C. Mortimore, “JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants,” May 2015.)](#OAuth.JWT).
>
>
> For example
> (with line wraps within values for display purposes only):
>
> ```
>
>   POST /token HTTP/1.1
>   Host: server.example.com
>   Content-Type: application/x-www-form-urlencoded
>
>   grant_type=authorization_code&
>     code=i1WsRn1uB1&
>     client_id=s6BhdRkqt3&
>     client_assertion_type=
>     urn%3Aietf%3Aparams%3Aoauth%3Aclient-assertion-type%3Ajwt-bearer&
>     client_assertion=PHNhbWxwOl ... ZT
>
> ```
>
>
> none
> The Client does not authenticate itself at the Token Endpoint,
> either because it uses only the Implicit Flow (and so does not use the Token Endpoint)
> or because it is a Public Client with no Client Secret or other authentication mechanism.

---

| [TOC](#toc) |
| --- |

### 10.  Signatures and Encryption

Depending on the transport through which the messages are sent, the
integrity of the message might not be guaranteed and the originator of the
message might not be authenticated. To mitigate these risks,
ID Token, UserInfo Response, Request Object,
and Client Authentication JWT values can utilize
[JSON Web Signature (JWS) (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Signature (JWS),” May 2015.)](#JWS) [JWS] to sign their contents.
To achieve message confidentiality, these values can also use
[JSON Web Encryption (JWE) (Jones, M. and J. Hildebrand, “JSON Web Encryption (JWE),” May 2015.)](#JWE) [JWE] to encrypt their contents.

When the message is both signed and encrypted, it MUST be
signed first and then encrypted, per [Section 16.14 (Signing and Encryption Order)](#SigningOrder),
with the result being a Nested JWT, as specified in [[JWT] (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Token (JWT),” May 2015.)](#JWT).
Note that all JWE encryption methods perform integrity checking.

The OP advertises its supported signing and encryption algorithms
in its Discovery document
or may supply this information by other means.
The RP declares its required signing and encryption algorithms
in its Dynamic Registration request
or may communicate this information by other means.

The OP advertises its public keys
via its Discovery document
or may supply this information by other means.
The RP declares its public keys
via its Dynamic Registration request
or may communicate this information by other means.

---

| [TOC](#toc) |
| --- |

### 10.1.  Signing

The signing party MUST select a signature algorithm
based on the algorithms supported by the recipient.

> Asymmetric Signatures
> When using RSA or ECDSA Signatures,
> the alg Header Parameter value
> of the JOSE Header MUST be set to an appropriate algorithm
> as defined in [JSON Web Algorithms (Jones, M., “JSON Web Algorithms (JWA),” May 2015.)](#JWA) [JWA].
> The private key used to sign the content MUST be associated with
> a public key used for signature verification published by the sender
> in its JWK Set document.
> If there are multiple keys in the referenced JWK Set document, a
> kid value MUST be provided in the JOSE Header.
> The key usage of the respective keys MUST support signing.
>
> Symmetric Signatures
> When using MAC-based signatures,
> the alg Header Parameter value
> of the JOSE Header MUST be set to a MAC algorithm,
> as defined in [JSON Web Algorithms (Jones, M., “JSON Web Algorithms (JWA),” May 2015.)](#JWA) [JWA].
> The MAC key used is
> the octets of the UTF-8 representation of
> the client\_secret value.
> See [Section 16.19 (Symmetric Key Entropy)](#SymmetricKeyEntropy) for a discussion of
> entropy requirements for client\_secret values.
> Symmetric signatures MUST NOT be used by public (non-confidential) Clients
> because of their inability to keep secrets.

See [Section 16.20 (Need for Signed Requests)](#NeedForSignedRequests) for Security Considerations
about the need for signed requests.

---

| [TOC](#toc) |
| --- |

### 10.1.1.  Rotation of Asymmetric Signing Keys

Rotation of signing keys can be accomplished with the following approach. The signer publishes
its keys in a JWK Set at its jwks\_uri location
and includes the kid of the
signing key in the JOSE Header of each message
to indicate to the verifier which key is to be used to validate the signature. Keys can be rolled over
by periodically adding new keys to the JWK Set at the jwks\_uri location.
The signer can begin using a new key at its
discretion and signals the change to the verifier using the kid value.
The verifier knows to go back to the jwks\_uri location
to re-retrieve the keys when it sees an unfamiliar
kid value. The JWK Set document at the jwks\_uri
SHOULD retain recently decommissioned signing keys for a reasonable period of time to facilitate a
smooth transition.

---

| [TOC](#toc) |
| --- |

### 10.2.  Encryption

The encrypting party MUST select an encryption algorithm
based on the algorithms supported by the recipient.

> Asymmetric Encryption: RSA
> The public key to which the content was encrypted MUST be
> a public key used for encryption published by the recipient
> in its JWK Set document.
> If there are multiple keys in the referenced JWK Set document, a
> kid value MUST be provided in the JOSE Header.
> Use the supported RSA encryption algorithm to encrypt a random
> Content Encryption Key to be used for encrypting
> the signed JWT.
> The key usage of the respective keys MUST include encryption.
>
> Asymmetric Encryption: Elliptic Curve
> Create an ephemeral Elliptic Curve public key for the epk
> element of the JOSE Header.
> The other public key used for the key agreement computation MUST be
> a public key published by the recipient
> in its JWK Set document.
> If there are multiple keys in the referenced JWK Set document, a
> kid value MUST be provided in the JOSE Header.
> Use the ECDH-ES algorithm to agree upon a
> Content Encryption Key to be used for encrypting
> the signed JWT.
> The key usage of the respective keys MUST support encryption.
>
> Symmetric Encryption
> The symmetric encryption key is derived from the
> client\_secret value by
> using the left-most bits of a truncated SHA-2 hash of
> the octets of the UTF-8 representation of
> the client\_secret.
> For keys of 256 or fewer bits, SHA-256 is used;
> for keys of 257-384 bits, SHA-384 is used;
> for keys of 385-512 bits, SHA-512 is used.
> The hash value MUST be truncated retaining the left-most bits to the appropriate bit length
> for the AES key wrapping or direct encryption algorithm used,
> for instance, truncating the SHA-256 hash
> to 128 bits for A128KW.
> If a symmetric key with greater than 512 bits is needed, a different method
> of deriving the key from the client\_secret
> would have to be defined by an extension.
> Symmetric encryption MUST NOT be used by public (non-confidential) Clients
> because of their inability to keep secrets.

See [Section 16.21 (Need for Encrypted Requests)](#NeedForEncryptedRequests) for Security Considerations
about the need for encrypted requests.

---

| [TOC](#toc) |
| --- |

### 10.2.1.  Rotation of Asymmetric Encryption Keys

Rotating encryption keys necessarily uses a different process than the one for signing keys because
the encrypting party starts the process and thus cannot rely on
a change in kid as a signal
that keys need to change. The encrypting party
still uses the kid Header Parameter in the JWE
to tell the decrypting party which private key to use to decrypt, however, the encrypting party
needs to first select the most appropriate key from those provided in the JWK Set at
the recipient's jwks\_uri location.

To rotate keys, the decrypting party can publish new keys
at its jwks\_uri location
and remove from the JWK Set those that are being decommissioned.
The jwks\_uri SHOULD include a Cache-Control
header in the response that contains a max-age directive,
as defined in [RFC 7234 (Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke, Ed., “Hypertext Transfer Protocol (HTTP/1.1): Caching,” June 2014.)](#RFC7234) [RFC7234],
which enables the encrypting party to safely cache the JWK Set and not have to re-retrieve
the document for every encryption event. The decrypting party SHOULD remove decommissioned keys
from the JWK Set referenced by jwks\_uri
but retain them internally for some reasonable
period of time, coordinated with the cache duration, to facilitate a smooth transition between keys
by allowing the encrypting party some time to obtain the new keys. The cache duration SHOULD also
be coordinated with the issuance of new signing keys, as described in [Section 10.1.1 (Rotation of Asymmetric Signing Keys)](#RotateSigKeys).

---

| [TOC](#toc) |
| --- |

### 11.  Offline Access

OpenID Connect defines the following scope value
to request offline access:

> offline\_access
> OPTIONAL. This scope value requests
> that an OAuth 2.0 Refresh Token be issued that can be used to
> obtain an Access Token that grants access to the End-User's
> UserInfo Endpoint even when the End-User is not present (not logged in).

When offline access is requested, a prompt
parameter value of consent MUST be used
unless other conditions for processing the request permitting offline access
to the requested resources are in place.
The OP MUST always obtain consent to returning a Refresh Token
that enables offline access to the requested resources.
A previously saved user consent is not always sufficient to grant offline access.

Upon receipt of a scope parameter containing the
offline\_access value, the Authorization Server:

* MUST ensure that the prompt parameter contains
  consent
  unless other conditions for processing the request permitting offline access
  to the requested resources are in place;
  unless one or both of these conditions are fulfilled, then
  it MUST ignore the offline\_access request,
* MUST ignore the offline\_access request
  unless the Client is using a response\_type
  value that would result in an Authorization Code being returned,
* MUST explicitly receive or have consent for offline access when
  the registered application\_type
  is web,
* SHOULD explicitly receive or have consent for offline access when
  the registered application\_type
  is native.

The use of Refresh Tokens is not exclusive to the
offline\_access use case.
The Authorization Server MAY grant Refresh Tokens
in other contexts that are beyond the scope of this specification.

---

| [TOC](#toc) |
| --- |

### 12.  Using Refresh Tokens

A request to the Token Endpoint can also use a Refresh Token
by using the grant\_type value
refresh\_token,
as described in Section 6 of
[OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749].
This section defines the behaviors for OpenID Connect
Authorization Servers when Refresh Tokens are used.

---

| [TOC](#toc) |
| --- |

### 12.1.  Refresh Request

To refresh an Access Token, the Client MUST
authenticate to the Token Endpoint using the authentication method registered
for its client\_id, as documented in
[Section 9 (Client Authentication)](#ClientAuthentication).
The Client sends the parameters via HTTP POST
to the Token Endpoint using
Form Serialization, per [Section 13.2 (Form Serialization)](#FormSerialization).

The following is a non-normative example of a
Refresh Request
(with line wraps within values for display purposes only):

```

  POST /token HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded

  client_id=s6BhdRkqt3
    &client_secret=some_secret12345
    &grant_type=refresh_token
    &refresh_token=8xLOxBtZp8
    &scope=openid%20profile

```

The Authorization Server MUST validate the Refresh Token,
MUST verify that it was issued to the Client,
and must verify that the Client successfully authenticated
it has a Client Authentication method.

---

| [TOC](#toc) |
| --- |

### 12.2.  Successful Refresh Response

Upon successful validation of the Refresh Token,
the response body is the Token Response of [Section 3.1.3.3 (Successful Token Response)](#TokenResponse)
except that it might not contain an id\_token.

If an ID Token is returned as a result of a token refresh request,
the following requirements apply:

* its iss Claim Value MUST be the same as
  in the ID Token issued when the original authentication occurred,
* its sub Claim Value MUST be the same as
  in the ID Token issued when the original authentication occurred,
* its iat Claim MUST represent
  the time that the new ID Token is issued,
* its aud Claim Value MUST be the same as
  in the ID Token issued when the original authentication occurred,
* if the ID Token contains an auth\_time Claim,
  its value MUST represent the time of the original authentication - not
  the time that the new ID token is issued,
* if the implementation is using extensions
  (which are beyond the scope of this specification)
  that result in
  the azp (authorized party) Claim being present,
  those extensions might specify that
  its azp Claim Value MUST be the same as
  in the ID Token issued when the original authentication occurred;
  likewise, they might specify that
  if no azp Claim was present in the original
  ID Token, one MUST NOT be present in the new ID Token,
* it SHOULD NOT have a nonce Claim,
  even when the ID Token issued
  at the time of the original authentication
  contained nonce;
  however, if it is present,
  its value MUST be the same as in the ID Token issued
  at the time of the original authentication,
  and
* otherwise, the same rules apply as apply when issuing an ID Token
  at the time of the original authentication.

The following is a non-normative example of a
Refresh Response:

```

  HTTP/1.1 200 OK
  Content-Type: application/json
  Cache-Control: no-store

  {
   "access_token": "TlBN45jURg",
   "token_type": "Bearer",
   "refresh_token": "9yNOxJtZa5",
   "expires_in": 3600
  }

```

---

| [TOC](#toc) |
| --- |

### 12.3.  Refresh Error Response

If the Refresh Request is invalid or unauthorized, the
Authorization Server returns the
Token Error Response as defined in Section 5.2 of [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749].

---

| [TOC](#toc) |
| --- |

### 13.  Serializations

Messages are serialized using one of the following methods:

1. Query String Serialization
2. Form Serialization
3. JSON Serialization

This section describes the syntax of these serialization methods;
other sections describe when they can and must be used.
Note that not all methods can be used for all messages.

---

| [TOC](#toc) |
| --- |

### 13.1.  Query String Serialization

In order to serialize the parameters using the Query String
Serialization, the Client constructs the string by adding the
parameters and values to the query component of a URL using the application/x-www-form-urlencoded format as
defined by [[W3C.SPSD‑html401‑20180327] (, “HTML 4.01 Specification,” March 2018.)](#W3C.SPSD-html401-20180327).
Query String Serialization is typically used in
HTTP GET requests.
The same serialization method is also used when adding
parameters to the fragment component of a URL.

The following is a non-normative example of this serialization
(with line wraps within values for display purposes only):

```

  GET /authorize?
    response_type=code
    &scope=openid
    &client_id=s6BhdRkqt3
    &redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb HTTP/1.1
  Host: server.example.com

```

---

| [TOC](#toc) |
| --- |

### 13.2.  Form Serialization

Parameters and their values are Form Serialized by adding the
parameter names and values to the entity body of the HTTP request using
the application/x-www-form-urlencoded format
as defined by [[W3C.SPSD‑html401‑20180327] (, “HTML 4.01 Specification,” March 2018.)](#W3C.SPSD-html401-20180327).
Form Serialization is typically used in HTTP POST requests.

The following is a non-normative example of this serialization
(with line wraps within values for display purposes only):

```

  POST /authorize HTTP/1.1
  Host: server.example.com
  Content-Type: application/x-www-form-urlencoded

  response_type=code
    &scope=openid
    &client_id=s6BhdRkqt3
    &redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb

```

---

| [TOC](#toc) |
| --- |

### 13.3.  JSON Serialization

The parameters are serialized into a JSON object structure by adding each
parameter at the highest structure level. Parameter names and string
values are represented as JSON strings.
Numerical values are represented as JSON numbers.
Boolean values are represented as JSON booleans.
Omitted parameters and parameters with no value SHOULD be omitted
from the object and not represented by
a JSON null value, unless otherwise specified.
A parameter MAY have a JSON object or a JSON array as its value.

The following is a non-normative example of this serialization:

```

  {
   "access_token": "SlAV32hkKG",
   "token_type": "Bearer",
   "expires_in": 3600,
   "refresh_token": "8xLOxBtZp8"
  }

```

---

| [TOC](#toc) |
| --- |

### 14.  String Operations

Processing some OpenID Connect messages requires comparing
values in the messages to known values. For example, the Claim
Names returned by the UserInfo Endpoint might be compared to
specific Claim Names such as sub. Comparing Unicode [[UNICODE] (The Unicode Consortium, “The Unicode Standard,” .)](#UNICODE) strings,
however, has significant security implications.

Therefore, comparisons between JSON strings and other Unicode
strings MUST be performed as specified below:

1. Remove any JSON applied escaping to produce an array of
   Unicode code points.
2. Unicode Normalization [[USA15] (Whistler, K., “Unicode Normalization Forms,” August 2023.)](#USA15) MUST NOT
   be applied at any point to either the JSON string or to
   the string it is to be compared against.
3. Comparisons between the two strings MUST be performed as a
   Unicode code point to code point equality comparison.

In several places, this specification uses space-delimited
lists of strings. In all such cases, a single ASCII space
character (0x20) MUST be used as the delimiter.

---

| [TOC](#toc) |
| --- |

### 15.  Implementation Considerations

This specification defines features used by both Relying Parties and
OpenID Providers.
It is expected that some OpenID Providers will require
static, out-of-band configuration of RPs using them,
whereas others will support dynamic usage by RPs without
a pre-established relationship between them.
For that reason, the mandatory-to-implement features for OPs
are listed below in two groups:
the first for all OPs and the second for "Dynamic" OpenID Providers.

---

| [TOC](#toc) |
| --- |

### 15.1.  Mandatory to Implement Features for All OpenID Providers

All OpenID Providers MUST implement the following features defined in this specification.
This list augments the set of features that are already listed elsewhere
as being "REQUIRED" or are described with a "MUST",
and so is not, by itself, a comprehensive set of implementation requirements for OPs.

> Signing ID Tokens with RSA SHA-256
> OPs MUST support signing ID Tokens with the RSA SHA-256 algorithm
> (an alg value of
> RS256),
> unless the OP only supports returning ID Tokens from the Token Endpoint
> (as is the case for the Authorization Code Flow)
> and only allows Clients to register specifying
> none as the requested ID Token signing algorithm.
>
> Prompt Parameter
> OPs MUST support the prompt parameter,
> as defined in [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint), including the specified
> user interface behaviors such as none
> and login.
>
> Display Parameter
> OPs MUST support the display parameter,
> as defined in [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint).
> (Note that the minimum level of support required for this parameter is
> simply that its use must not result in an error.)
>
> Preferred Locales
> OPs MUST support requests for preferred languages and scripts
> for the user interface and for Claims via the
> ui\_locales and
> claims\_locales request parameters,
> as defined in [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint).
> (Note that the minimum level of support required for these parameters is
> simply to have their use not result in errors.)
>
> Authentication Time
> OPs MUST support returning the time at which the End-User authenticated
> via the auth\_time Claim, when requested,
> as defined in [Section 2 (ID Token)](#IDToken).
>
> Maximum Authentication Age
> OPs MUST support enforcing a maximum authentication age
> via the max\_age parameter,
> as defined in [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint).
>
> Authentication Context Class Reference
> OPs MUST support requests for specific
> Authentication Context Class Reference values
> via the acr\_values parameter,
> as defined in [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint).
> (Note that the minimum level of support required for this parameter is
> simply to have its use not result in an error.)

---

| [TOC](#toc) |
| --- |

### 15.2.  Mandatory to Implement Features for Dynamic OpenID Providers

In addition to the features listed above,
OpenID Providers supporting dynamic establishment of relationships with RPs
that they do not have a pre-configured relationship with
MUST also implement the following features defined in this and related specifications.

> Response Types
> These OpenID Providers MUST support the
> id\_token Response Type and
> all that are not Self-Issued OPs MUST also support the
> code and
> id\_token token Response Types.
>
> Discovery
> These OPs MUST support Discovery,
> as defined in
> [OpenID Connect Discovery 1.0 (Sakimura, N., Bradley, J., Jones, M., and E. Jay, “OpenID Connect Discovery 1.0,” December 2023.)](#OpenID.Discovery) [OpenID.Discovery].
>
> Dynamic Registration
> These OPs MUST support Dynamic Client Registration,
> as defined in
> [OpenID Connect Dynamic Client Registration 1.0 (Sakimura, N., Bradley, J., and M. Jones, “OpenID Connect Dynamic Client Registration 1.0,” December 2023.)](#OpenID.Registration) [OpenID.Registration].
>
> UserInfo Endpoint
> All dynamic OPs that issue Access Tokens MUST support the UserInfo Endpoint,
> as defined in [Section 5.3 (UserInfo Endpoint)](#UserInfo).
> (Self-Issued OPs do not issue Access Tokens.)
>
> Public Keys Published as Bare Keys
> These OPs MUST publish their public keys as bare JWK keys
> (which MAY also be accompanied by X.509 representations of those keys).
>
> Request URI
> These OPs MUST support requests made using a Request Object value
> that is retrieved from a Request URI that is provided
> with the request\_uri parameter,
> as defined in [Section 6.2 (Passing a Request Object by Reference)](#RequestUriParameter).

---

| [TOC](#toc) |
| --- |

### 15.3.  Discovery and Registration

Some OpenID Connect installations can use a pre-configured set of
OpenID Providers and/or Relying Parties. In those cases, it might not be
necessary to support dynamic discovery of information about identities
or services or dynamic registration of Clients.

However, if installations choose to support unanticipated
interactions between Relying Parties and OpenID Providers that do not
have pre-configured relationships, they SHOULD accomplish this by
implementing the facilities defined in the [OpenID Connect Discovery 1.0 (Sakimura, N., Bradley, J., Jones, M., and E. Jay, “OpenID Connect Discovery 1.0,” December 2023.)](#OpenID.Discovery) [OpenID.Discovery] and [OpenID Connect Dynamic Client Registration 1.0 (Sakimura, N., Bradley, J., and M. Jones, “OpenID Connect Dynamic Client Registration 1.0,” December 2023.)](#OpenID.Registration) [OpenID.Registration]
specifications.

---

| [TOC](#toc) |
| --- |

### 15.4.  Mandatory to Implement Features for Relying Parties

In general, it is up to Relying Parties which features they use
when interacting with OpenID Providers.
However, some choices are dictated by the nature of their OAuth Client,
such as whether it is a Confidential Client, capable of keeping secrets,
in which case the Authorization Code Flow may be appropriate,
or whether it is a Public Client, for instance, a
User Agent Based Application or a statically registered Native Application,
in which case the Implicit Flow may be appropriate.

When using OpenID Connect features, those listed as being
"REQUIRED" or are described with a "MUST" are
mandatory to implement, when used by a Relying Party.
Likewise, those features that are described as "OPTIONAL"
need not be used or supported unless they provide value
in the particular application context.
Finally, when interacting with OpenID Providers that support Discovery,
the OP's Discovery document can be used to dynamically determine
which OP features are available for use by the RP.

---

| [TOC](#toc) |
| --- |

### 15.5.  Implementation Notes

---

| [TOC](#toc) |
| --- |

### 15.5.1.  Authorization Code Implementation Notes

When using the Authorization Code or Hybrid flows,
an ID Token is returned from the Token Endpoint
in response to a Token Request using an Authorization Code.
Some implementations may choose to encode state about
the ID Token to be returned in the Authorization Code value.
Others may use the Authorization Code value
as an index into a database storing this state.

---

| [TOC](#toc) |
| --- |

### 15.5.2.  Nonce Implementation Notes

The nonce parameter value needs to include
per-session state and be unguessable to attackers.
One method to achieve this for Web Server Clients is to store a cryptographically random value
as an HttpOnly session cookie and use a cryptographic hash of the value
as the nonce parameter.
In that case, the nonce in the returned
ID Token is compared to the hash of the session cookie
to detect ID Token replay by third parties.
A related method applicable to JavaScript Clients and other Browser-Based Clients is to store the cryptographically random value
in HTML5 local storage and use a cryptographic hash of this value.

---

| [TOC](#toc) |
| --- |

### 15.5.3.  Redirect URI Fragment Handling Implementation Notes

When response parameters are returned in the Redirection URI fragment value,
the Client needs to have the User Agent parse the fragment encoded values
and pass them to on to the Client's processing logic for consumption.
User Agents that have direct access to cryptographic APIs may be able to be
self-contained, for instance, with all Client code being written in JavaScript.

However, if the Client does not run entirely in the User Agent,
one way to achieve this
is to post them to a Web Server Client for validation.

The following is an example of a JavaScript file that a Client might host at its
redirect\_uri. This is loaded by the redirect from
the Authorization Server. The fragment component is parsed and then sent by POST to a URI
that will validate and use the information received.

Following is a non-normative example of a
Redirect URI response:

```

  GET /cb HTTP/1.1
  Host: client.example.org

  HTTP/1.1 200 OK
  Content-Type: text/html

  <script type="text/javascript">

  // First, parse the query string
  var params = {}, postBody = location.hash.substring(1),
      regex = /([^&=]+)=([^&]*)/g, m;
  while (m = regex.exec(postBody)) {
    params[decodeURIComponent(m[1])] = decodeURIComponent(m[2]);
  }

  // And send the token over to the server
  var req = new XMLHttpRequest();
  // using POST so query isn't logged
  req.open('POST', 'https://' + window.location.host +
                   '/catch_response', true);
  req.setRequestHeader('Content-Type',
                       'application/x-www-form-urlencoded');

  req.onreadystatechange = function (e) {
    if (req.readyState == 4) {
      if (req.status == 200) {
  // If the response from the POST is 200 OK, perform a redirect
        window.location = 'https://'
          + window.location.host + '/redirect_after_login'
      }
  // if the OAuth response is invalid, generate an error message
      else if (req.status == 400) {
        alert('There was an error processing the token')
      } else {
        alert('Something other than 200 was returned')
      }
    }
  };
  req.send(postBody);

```

---

| [TOC](#toc) |
| --- |

### 15.6.  Compatibility Notes

NOTE: Potential compatibility issues that were previously described in
the original version of this specification have since been addressed.

---

| [TOC](#toc) |
| --- |

### 15.7.  Related Specifications and Implementer's Guides

These related OPTIONAL specifications MAY be used in
combination with this specification to provide additional functionality:

* [OpenID Connect Discovery 1.0 (Sakimura, N., Bradley, J., Jones, M., and E. Jay, “OpenID Connect Discovery 1.0,” December 2023.)](#OpenID.Discovery) [OpenID.Discovery] -
  Defines how Relying Parties dynamically discover information about OpenID Providers
* [OpenID Connect Dynamic Client Registration 1.0 (Sakimura, N., Bradley, J., and M. Jones, “OpenID Connect Dynamic Client Registration 1.0,” December 2023.)](#OpenID.Registration) [OpenID.Registration] -
  Defines how Relying Parties dynamically register with OpenID Providers
* [OAuth 2.0 Form Post Response Mode (Jones, M. and B. Campbell, “OAuth 2.0 Form Post Response Mode,” April 2015.)](#OAuth.Post) [OAuth.Post] -
  Defines how to return OAuth 2.0 Authorization Response parameters
  (including OpenID Connect Authentication Response parameters)
  using HTML form values that are auto-submitted by the User Agent
  using HTTP POST
* [OpenID Connect RP-Initiated Logout 1.0 (Jones, M., de Medeiros, B., Agarwal, N., Sakimura, N., and J. Bradley, “OpenID Connect RP-Initiated Logout 1.0,” September 2022.)](#OpenID.RPInitiated) [OpenID.RPInitiated] -
  Defines how a Relying Party
  requests that an OpenID Provider log out the End-User
* [OpenID Connect Session Management 1.0 (de Medeiros, B., Agarwal, N., Sakimura, N., Bradley, J., and M. Jones, “OpenID Connect Session Management 1.0,” September 2022.)](#OpenID.Session) [OpenID.Session] -
  Defines how to manage OpenID Connect sessions, including postMessage-based logout and RP-initiated logout functionality
* [OpenID Connect Front-Channel Logout 1.0 (Jones, M., “OpenID Connect Front-Channel Logout 1.0,” September 2022.)](#OpenID.FrontChannel) [OpenID.FrontChannel] -
  Defines a front-channel logout mechanism that does not use an OP iframe on RP pages
* [OpenID Connect Back-Channel Logout 1.0 (Jones, M. and J. Bradley, “OpenID Connect Back-Channel Logout 1.0,” December 2023.)](#OpenID.BackChannel) [OpenID.BackChannel] -
  Defines a logout mechanism that uses direct back-channel communication between the OP and RPs being logged out

These implementer's guides are intended to serve as self-contained references
for implementers of basic Web-based Relying Parties:

* [OpenID Connect Basic Client Implementer's Guide 1.0 (Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore, “OpenID Connect Basic Client Implementer's Guide 1.0,” December 2023.)](#OpenID.Basic) [OpenID.Basic] -
  Implementer's guide containing a subset of this specification
  that is intended for use by basic
  Web-based Relying Parties using the
  OAuth Authorization Code Flow
* [OpenID Connect Implicit Client Implementer's Guide 1.0 (Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore, “OpenID Connect Implicit Client Implementer's Guide 1.0,” December 2023.)](#OpenID.Implicit) [OpenID.Implicit] -
  Implementer's guide containing a subset of this specification
  that is intended for use by basic
  Web-based Relying Parties using the
  OAuth Implicit Flow

---

| [TOC](#toc) |
| --- |

### 16.  Security Considerations

This specification references the security considerations defined in
Section 10 of [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749], and
Section 5 of [OAuth 2.0 Bearer Token Usage (Jones, M. and D. Hardt, “The OAuth 2.0 Authorization Framework: Bearer Token Usage,” October 2012.)](#RFC6750) [RFC6750].
Furthermore, the [OAuth 2.0 Threat Model and Security
Considerations (Lodderstedt, T., Ed., McGloin, M., and P. Hunt, “OAuth 2.0 Threat Model and Security Considerations,” January 2013.)](#RFC6819) [RFC6819] specification provides an extensive list of threats and controls
that apply to this specification as well,
given that it is based upon OAuth 2.0.
[ISO/IEC 29115 (International Organization for Standardization, “ISO/IEC 29115:2013. Information technology - Security techniques - Entity authentication assurance framework,” April 2013.)](#ISO29115) [ISO29115]
also provides threats and controls that
implementers need to take into account.
Implementers are highly advised to
read these references in detail and apply the countermeasures described therein.

In addition, the following list of attack vectors and remedies are
also considered.

---

| [TOC](#toc) |
| --- |

### 16.1.  Request Disclosure

If appropriate measures are not taken, a request might be disclosed to
an attacker, posing security and privacy threats.

In addition to what is stated in Section 5.1.1 of [[RFC6819] (Lodderstedt, T., Ed., McGloin, M., and P. Hunt, “OAuth 2.0 Threat Model and Security Considerations,” January 2013.)](#RFC6819),
this standard provides a way to provide the confidentiality of the request
end to end through the
use of request or request\_uri
parameters, where the content of the request
is an encrypted JWT with the appropriate key and cipher.
This protects even against a compromised User Agent
in the case of indirect request.

---

| [TOC](#toc) |
| --- |

### 16.2.  Server Masquerading

A malicious Server might masquerade as the legitimate server
using various means. To detect such an attack, the Client needs to authenticate
the server.

In addition to what is stated in Section 5.1.2 of [[RFC6819] (Lodderstedt, T., Ed., McGloin, M., and P. Hunt, “OAuth 2.0 Threat Model and Security Considerations,” January 2013.)](#RFC6819),
this standard provides a way to authenticate the Server through either the
use of Signed or Encrypted JWTs
with an appropriate key and cipher.

---

| [TOC](#toc) |
| --- |

### 16.3.  Token Manufacture/Modification

An Attacker might generate a bogus token or modify the token contents
(such as Claims values or the signature)
of an existing parseable token, causing the RP to grant
inappropriate access to the Client. For example, an Attacker might modify
the parseable token to extend the validity period; a Client might modify the
parseable token to have access to information that they should not be able to view.

There are two ways to mitigate this attack:

1. The token can be digitally signed by the OP. The Relying
   Party SHOULD validate the digital signature to verify that it was
   issued by a legitimate OP.
2. The token can be sent over a protected channel such as TLS.
   See [Section 16.17 (TLS Requirements)](#TLSRequirements) for more information on using TLS.
   In this specification, the token is always sent over a TLS protected channel.
   Note however, that this measure is only a defense against third party attackers
   and is not applicable to the case where the Client is the attacker.

---

| [TOC](#toc) |
| --- |

### 16.4.  Access Token Disclosure

Access Tokens are credentials used to access Protected
Resources, as defined in Section 1.4 of
[OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749]. Access Tokens represent
an End-User's authorization and MUST NOT be exposed to
unauthorized parties.

---

| [TOC](#toc) |
| --- |

### 16.5.  Server Response Disclosure

The server response might contain authentication data and Claims
that include sensitive Client information. Disclosure of the
response contents can make the Client vulnerable to other types of
attacks.

The server response disclosure can be mitigated in the following two
ways:

1. Using the code Response Type.
   The response is sent over a TLS protected
   channel, where the Client is authenticated by the
   client\_id and
   client\_secret.
2. For other Response Types,
   the signed response can be encrypted with the Client's
   public key or a shared secret as an encrypted JWT
   with an appropriate key and cipher.

---

| [TOC](#toc) |
| --- |

### 16.6.  Server Response Repudiation

A response might be repudiated by the server if the proper mechanisms are not in place.
For example, if a Server does not digitally sign a response, the Server can claim that it was not
generated through the services of the Server.

To mitigate this threat, the response MAY be digitally signed by
the Server using a key that supports non-repudiation. The Client SHOULD validate
the digital signature to verify that it was issued by a legitimate
Server and its integrity is intact.

---

| [TOC](#toc) |
| --- |

### 16.7.  Request Repudiation

Since it is possible for a
compromised or malicious Client to send a request to the wrong party,
a Client that was authenticated
using only a bearer token can repudiate any transaction.

To mitigate this threat, the Server MAY require that the
request be digitally signed by
the Client using a key that supports non-repudiation.
The Server SHOULD validate
the digital signature to verify that it was issued by a legitimate
Client and its integrity is intact.

---

| [TOC](#toc) |
| --- |

### 16.8.  Access Token Redirect

An Attacker uses the Access Token generated for one resource to
obtain access to a second resource.

To mitigate this threat, the Access Token SHOULD be audience
and scope restricted. One way of implementing it is to include
the identifier of the resource for whom it was generated as audience.
The resource verifies that
incoming tokens include its identifier as the audience of the
token.

---

| [TOC](#toc) |
| --- |

### 16.9.  Token Reuse

An Attacker attempts to use a one-time use token such as
an Authorization Code that has already
been used once with the intended Resource.
To mitigate this threat, the token SHOULD include a timestamp
and a short validity lifetime.
The Relying Party then checks the timestamp and lifetime values
to ensure that the token is currently valid.

Alternatively, the server MAY record the state of the use of
the token and check the status for each request.

---

| [TOC](#toc) |
| --- |

### 16.10.  Eavesdropping or Leaking Authorization Codes (Secondary Authenticator Capture)

In addition to the attack patterns described in
Section 4.4.1.1 of [[RFC6819] (Lodderstedt, T., Ed., McGloin, M., and P. Hunt, “OAuth 2.0 Threat Model and Security Considerations,” January 2013.)](#RFC6819),
an Authorization Code can be captured in the User Agent where the TLS
session is terminated if the User Agent is infected by malware.
However, capturing it is not useful as long as either
Client Authentication or an encrypted response is used.

---

| [TOC](#toc) |
| --- |

### 16.11.  Token Substitution

Token Substitution is a class of attacks in which a malicious user
swaps various tokens, including swapping an Authorization Code for
a legitimate user with another token that the attacker has.
One means of accomplishing this is for the attacker to copy
a token out one session and use it in an HTTP message for
a different session, which is easy to do when the token is
available to the browser; this is known as the "cut and paste" attack.

The Implicit Flow of [OAuth 2.0 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749]
is not designed to mitigate this risk. In Section 10.16,
it normatively requires that any use of the authorization
process as a form of delegated End-User authentication to the
Client MUST NOT use the Implicit Flow without employing
additional security mechanisms that enable the Client to
determine whether the ID Token and Access Token were issued for its use.

In OpenID Connect, this is mitigated through mechanisms
provided through the ID Token. The ID Token is a signed
security token that provides Claims such as
iss (issuer),
sub (subject),
aud (audience),
at\_hash (access token hash), and
c\_hash (code hash). Using the ID Token,
the Client is capable of detecting the Token Substitution Attack.

The c\_hash in the ID Token enables
Clients to prevent Authorization Code substitution.
The at\_hash in the ID Token enables
Clients to prevent Access Token substitution.

Also, a malicious user may attempt to impersonate a more
privileged user by subverting the communication channel
between the Authorization Endpoint and Client, or the Token Endpoint
and Client, for example by swapping the Authorization Code
or reordering the messages, to convince the Token Endpoint
that the attacker's authorization grant corresponds to a grant
sent on behalf of a more privileged user.

For the HTTP binding defined by this specification, the
responses to Token Requests are bound to the corresponding
requests by message order in HTTP, as both the response
containing the token and requests are protected by TLS, which
will detect and prevent packet reordering.

When designing another binding of this specification to a
protocol incapable of strongly binding Token Endpoint
requests to responses, additional mechanisms to
address this issue MUST be utilized. One such mechanism could
be to include an ID Token with a c\_hash
Claim in the token request and response.

---

| [TOC](#toc) |
| --- |

### 16.12.  Timing Attack

A timing attack enables the attacker to
obtain an unnecessary large amount of information through the elapsed time
differences in the code paths taken by successful and unsuccessful decryption operations or
successful and unsuccessful signature validation of a message.
It can be used to reduce the effective key length of the
cipher used.

Implementations SHOULD NOT terminate the validation process
at the instant of the finding an error but SHOULD continue
running until all the octets have been processed to avoid this attack.

---

| [TOC](#toc) |
| --- |

### 16.13.  Other Crypto Related Attacks

There are various crypto related attacks possible depending on the
method used for encryption and signature / integrity checking.
Implementers need to consult the Security Considerations
for the [JWT (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Token (JWT),” May 2015.)](#JWT) [JWT] specification and
specifications that it references
to avoid the vulnerabilities
identified in these specifications.

---

| [TOC](#toc) |
| --- |

### 16.14.  Signing and Encryption Order

Signatures over encrypted text are not considered valid
in many jurisdictions.
Therefore, for integrity and non-repudiation,
this specification requires signing
the plain text JSON Claims, when signing is performed.
If both signing and encryption are desired, it is performed on
the JWS containing the signed Claims,
with the result being a Nested JWT, as specified in [[JWT] (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Token (JWT),” May 2015.)](#JWT).
Note that since all JWE encryption algorithms provide integrity protection,
there is no need to separately sign the encrypted content.

---

| [TOC](#toc) |
| --- |

### 16.15.  Issuer Identifier

OpenID Connect supports multiple Issuers per Host and Port combination.
The issuer returned by discovery MUST exactly match the value of
iss in the ID Token.

OpenID Connect treats the path component of any Issuer URI as
being part of the Issuer Identifier. For instance, the subject
"1234" with an Issuer Identifier of "https://example.com" is not
equivalent to the subject "1234" with an Issuer Identifier of
"https://example.com/sales".

It is RECOMMENDED that only a single Issuer per host be used.
However, if a host supports multiple tenants,
multiple Issuers for that host may be needed.

---

| [TOC](#toc) |
| --- |

### 16.16.  Implicit Flow Threats

In the Implicit Flow, the Access Token is returned in the
fragment component of the Client's redirect\_uri through HTTPS, thus it is
protected between the OP and the User Agent, and between the User Agent and the
RP. The only place it can be captured is the User Agent where the
TLS session is terminated, which is possible if the User Agent is
infected by malware or under the control of a malicious party.

---

| [TOC](#toc) |
| --- |

### 16.17.  TLS Requirements

Implementations MUST support TLS.
Which version(s) ought to be implemented will vary over
time and depend on the widespread deployment and known
security vulnerabilities at the time of implementation.
Implementations SHOULD follow the guidance in
BCP 195 [[RFC8996] (Moriarty, K. and S. Farrell, “Deprecating TLS 1.0 and TLS 1.1,” March 2021.)](#RFC8996) [[RFC9325] (Sheffer, Y., Saint-Andre, P., and T. Fossati, “Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS),” November 2022.)](#RFC9325),
which provides recommendations and requirements
for improving the security of deployed services that use TLS.

To protect against information disclosure and tampering,
confidentiality protection MUST be applied using TLS
with a ciphersuite that provides confidentiality and
integrity protection.

Whenever TLS is used, a TLS server certificate check
MUST be performed, per [RFC 6125 (Saint-Andre, P. and J. Hodges, “Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS),” March 2011.)](#RFC6125) [RFC6125].

---

| [TOC](#toc) |
| --- |

### 16.18.  Lifetimes of Access Tokens and Refresh Tokens

Access Tokens might not be revocable by the Authorization Server.
Access Token lifetimes SHOULD therefore be kept to single use or
very short lifetimes.

If ongoing access to the UserInfo Endpoint or other Protected Resources is required,
a Refresh Token can be used. The Client can then exchange the Refresh Token at
the Token Endpoint for a fresh short-lived Access Token that can be used to
access the resource.

The Authorization Server SHOULD clearly identify long-term grants to the User
during Authorization.
The Authorization Server SHOULD provide a mechanism for the End-User to revoke
Access Tokens and Refresh Tokens granted to a Client.

---

| [TOC](#toc) |
| --- |

### 16.19.  Symmetric Key Entropy

In [Section 10.1 (Signing)](#Signing) and [Section 10.2 (Encryption)](#Encryption), keys are derived
from the client\_secret value.
Thus, when used with symmetric signing or encryption operations,
client\_secret values MUST contain
sufficient entropy to generate cryptographically strong keys.
Also, client\_secret values MUST also contain
at least the minimum of number of octets required for MAC keys for the
particular algorithm used.
So for instance, for HS256, the
client\_secret value MUST contain
at least 32 octets (and almost certainly SHOULD contain more,
since client\_secret values are
likely to use a restricted alphabet).

---

| [TOC](#toc) |
| --- |

### 16.20.  Need for Signed Requests

In some situations, Clients might need to use signed requests to ensure that
the desired request parameters are delivered to the OP without having
been tampered with. For instance, the max\_age
and acr\_values provide more assurance about
the nature of the authentication performed when delivered in signed requests.

---

| [TOC](#toc) |
| --- |

### 16.21.  Need for Encrypted Requests

In some situations, knowing the contents of an OpenID Connect request can,
in and of itself, reveal sensitive information about the End-User.
For instance, knowing that the Client is requesting a particular Claim or
that it is requesting that a particular authentication method be used
can reveal sensitive information about the End-User.
OpenID Connect enables requests to be encrypted to the OpenID Provider
to prevent such potentially sensitive information from being revealed.

---

| [TOC](#toc) |
| --- |

### 16.22.  HTTP 307 Redirects

HTTP 307 redirects send a POST request to the party being redirected to
that contains all the form data from the previous request.
This can leak credentials intended for the OpenID Provider to the Relying Party.
Therefore, HTTP 307 redirects MUST NOT be used when redirecting to the Redirection URI.
Likewise, while HTTP 302 redirects are typically implemented in a way that does not do this,
the use of HTTP 303 redirect is preferable, as it is defined not to do this.

---

| [TOC](#toc) |
| --- |

### 16.23.  Custom URI Schemes on iOS

Note that on iOS, multiple applications can register as handlers for a custom URI scheme,
therefore it is not deterministic that the calling application will receive the Authentication Reply
from the Self-Issued OpenID Provider.
Use of a claimed URI is an alternative to using the openid: custom URI scheme.

While it is possible to assign handlers to custom URI schemes
and it is possible that the operating system could help the End-User select the correct handler,
it is not possible to guarantee that the handler for a given custom URI scheme has not been replaced
by a subsequently installed native application.
At the time of this writing, there appears to be no fool-proof mitigation for this vulnerability.

---

| [TOC](#toc) |
| --- |

### 17.  Privacy Considerations

---

| [TOC](#toc) |
| --- |

### 17.1.  Personally Identifiable Information

The UserInfo Response typically contains Personally Identifiable
Information (PII). As such, End-User consent for the release of the information
for the specified purpose should be obtained at or prior to the
authorization time in accordance with relevant regulations. The purpose
of use is typically registered in association with the redirect\_uris.

Only necessary UserInfo data should be stored at the Client and the
Client SHOULD associate the received data with the purpose of use
statement.

---

| [TOC](#toc) |
| --- |

### 17.2.  Data Access Monitoring

The Resource Server SHOULD make End-Users' UserInfo access logs
available to them so that they can monitor who accessed their data.

---

| [TOC](#toc) |
| --- |

### 17.3.  Correlation

To protect the End-User from possible correlation among Clients, the
use of a Pairwise Pseudonymous Identifier (PPID) as the
sub (subject) SHOULD be considered.

---

| [TOC](#toc) |
| --- |

### 17.4.  Offline Access

Offline access enables access to Claims when the user is not present,
posing greater privacy risk than the Claims transfer when the user is present.
Therefore, it is prudent to obtain explicit consent for
offline access to resources.
This specification mandates the use of the prompt
parameter to obtain consent unless it is already known that the
request complies with the conditions for processing the request in each jurisdiction.

When an Access Token is returned via the User Agent
using the Implicit Flow or Hybrid Flow, there is
a greater risk of it being exposed to an attacker, who could
later use it to access the UserInfo endpoint.
If the Access Token does not enable offline access and the server
can differentiate whether the Client request has been made
offline or online, the risk will be substantially reduced.
Therefore, this specification mandates ignoring
the offline access request when the Access Token is
transmitted through the User Agent.
Note that differentiating between online and offline access
from the server can be difficult especially for native clients.
The server may well have to rely on heuristics.
Also, the risk of exposure for the Access Token delivered
through the User Agent for the Response Types of
code token and
token is the same.
Thus, the implementations should be prepared to detect
whether the Access Token was issued through the User Agent
or directly from the Token Endpoint and deny offline access
if the token was issued through the User Agent.

Note that although these provisions require an explicit
consent dialogue through the prompt parameter,
the mere fact that the user pressed an "accept" button etc.,
might not constitute a valid consent.
Developers should be aware that for the act of consent to
be valid, typically, the impact of the terms have to be
understood by the End-User, the consent must be freely given
and not forced (i.e., other options have to be available),
and the terms must fair and equitable.
In general, it is advisable for the service to follow the
required privacy principles in each jurisdiction and rely on
other conditions for processing the request than simply explicit consent,
as online self-service "explicit consent" often does not
form a valid consent in some jurisdictions.

---

| [TOC](#toc) |
| --- |

### 18.  IANA Considerations

---

| [TOC](#toc) |
| --- |

### 18.1.  JSON Web Token Claims Registration

This specification registers the following Claims
in the IANA
"JSON Web Token Claims" registry [[IANA.JWT.Claims] (IANA, “JSON Web Token Claims,” .)](#IANA.JWT.Claims)
established by [[JWT] (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Token (JWT),” May 2015.)](#JWT).

---

| [TOC](#toc) |
| --- |

### 18.1.1.  Registry Contents

* Claim Name: name
* Claim Description: Full name
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: given\_name
* Claim Description: Given name(s) or first name(s)
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: family\_name
* Claim Description: Surname(s) or last name(s)
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: middle\_name
* Claim Description: Middle name(s)
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: nickname
* Claim Description: Casual name
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: preferred\_username
* Claim Description: Shorthand name by which the End-User wishes to be referred to
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: profile
* Claim Description: Profile page URL
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: picture
* Claim Description: Profile picture URL
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: website
* Claim Description: Web page or blog URL
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: email
* Claim Description: Preferred e-mail address
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: email\_verified
* Claim Description: True if the e-mail address has been verified; otherwise false
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: gender
* Claim Description: Gender
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: birthdate
* Claim Description: Birthday
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: zoneinfo
* Claim Description: Time zone
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: locale
* Claim Description: Locale
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: phone\_number
* Claim Description: Preferred telephone number
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: phone\_number\_verified
* Claim Description: True if the phone number has been verified; otherwise false
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: address
* Claim Description: Preferred postal address
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: updated\_at
* Claim Description: Time the information was last updated
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.1 (Standard Claims)](#StandardClaims) of this specification

* Claim Name: azp
* Claim Description: Authorized party - the party to which the ID Token was issued
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 2 (ID Token)](#IDToken) of this specification

* Claim Name: nonce
* Claim Description: Value used to associate a Client session with an ID Token
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 2 (ID Token)](#IDToken) of this specification

* Claim Name: auth\_time
* Claim Description: Time when the authentication occurred
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 2 (ID Token)](#IDToken) of this specification

* Claim Name: at\_hash
* Claim Description: Access Token hash value
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 2 (ID Token)](#IDToken) of this specification

* Claim Name: c\_hash
* Claim Description: Code hash value
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 3.3.2.11 (ID Token)](#HybridIDToken) of this specification

* Claim Name: acr
* Claim Description: Authentication Context Class Reference
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 2 (ID Token)](#IDToken) of this specification

* Claim Name: amr
* Claim Description: Authentication Methods References
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 2 (ID Token)](#IDToken) of this specification

* Claim Name: sub\_jwk
* Claim Description: Public key used to check the signature of an ID Token
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 7.4 (Self-Issued OpenID Provider Response)](#SelfIssuedResponse) of this specification

* Claim Name: \_claim\_names
* Claim Description: JSON object whose member names are the Claim Names for the Aggregated and Distributed Claims
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.6.2 (Aggregated and Distributed Claims)](#AggregatedDistributedClaims) of this specification

* Claim Name: \_claim\_sources
* Claim Description: JSON object whose member names are referenced by the member values of the \_claim\_names member
* Change Controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification Document(s): [Section 5.6.2 (Aggregated and Distributed Claims)](#AggregatedDistributedClaims) of this specification

---

| [TOC](#toc) |
| --- |

### 18.2.  OAuth Parameters Registration

This specification registers the following parameters
in the IANA
"OAuth Parameters" registry [[IANA.OAuth.Parameters] (IANA, “OAuth Parameters,” .)](#IANA.OAuth.Parameters)
established by [RFC 6749 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749].

---

| [TOC](#toc) |
| --- |

### 18.2.1.  Registry Contents

* Parameter name: nonce
* Parameter usage location: Authorization Request
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint) of this specification
* Related information: None

* Parameter name: display
* Parameter usage location: Authorization Request
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint) of this specification
* Related information: None

* Parameter name: prompt
* Parameter usage location: Authorization Request
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint) of this specification
* Related information: None

* Parameter name: max\_age
* Parameter usage location: Authorization Request
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint) of this specification
* Related information: None

* Parameter name: ui\_locales
* Parameter usage location: Authorization Request
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint) of this specification
* Related information: None

* Parameter name: claims\_locales
* Parameter usage location: Authorization Request
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 5.2 (Claims Languages and Scripts)](#ClaimsLanguagesAndScripts) of this specification
* Related information: None

* Parameter name: id\_token\_hint
* Parameter usage location: Authorization Request
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint) of this specification
* Related information: None

* Parameter name: login\_hint
* Parameter usage location: Authorization Request
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint) of this specification
* Related information: None

* Parameter name: acr\_values
* Parameter usage location: Authorization Request
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2 (Authorization Endpoint)](#AuthorizationEndpoint) of this specification
* Related information: None

* Parameter name: claims
* Parameter usage location: Authorization Request
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 5.5 (Requesting Claims using the "claims" Request Parameter)](#ClaimsParameter) of this specification
* Related information: None

* Parameter name: registration
* Parameter usage location: Authorization Request
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 7.2.1 (Providing Information with the "registration" Request Parameter)](#RegistrationParameter) of this specification
* Related information: None

* Parameter name: request
* Parameter usage location: Authorization Request
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 6 (Passing Request Parameters as JWTs)](#JWTRequests) of this specification
* Related information: None

* Parameter name: request\_uri
* Parameter usage location: Authorization Request
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 6 (Passing Request Parameters as JWTs)](#JWTRequests) of this specification
* Related information: None

* Parameter name: id\_token
* Parameter usage location: Authorization Response,
  Access Token Response
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.3.3 (Successful Token Response)](#TokenResponse) of this specification
* Related information: None

---

| [TOC](#toc) |
| --- |

### 18.3.  OAuth Extensions Error Registration

This specification registers the following errors
in the IANA
"OAuth Extensions Error" registry [[IANA.OAuth.Parameters] (IANA, “OAuth Parameters,” .)](#IANA.OAuth.Parameters)
established by [RFC 6749 (Hardt, D., Ed., “The OAuth 2.0 Authorization Framework,” October 2012.)](#RFC6749) [RFC6749].

---

| [TOC](#toc) |
| --- |

### 18.3.1.  Registry Contents

* Error name: interaction\_required
* Error usage location: Authorization Endpoint
* Related protocol extension: OpenID Connect
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2.6 (Authentication Error Response)](#AuthError) of this specification

* Error name: login\_required
* Error usage location: Authorization Endpoint
* Related protocol extension: OpenID Connect
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2.6 (Authentication Error Response)](#AuthError) of this specification

* Error name: account\_selection\_required
* Error usage location: Authorization Endpoint
* Related protocol extension: OpenID Connect
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2.6 (Authentication Error Response)](#AuthError) of this specification

* Error name: consent\_required
* Error usage location: Authorization Endpoint
* Related protocol extension: OpenID Connect
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2.6 (Authentication Error Response)](#AuthError) of this specification

* Error name: invalid\_request\_uri
* Error usage location: Authorization Endpoint
* Related protocol extension: OpenID Connect
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2.6 (Authentication Error Response)](#AuthError) of this specification

* Error name: invalid\_request\_object
* Error usage location: Authorization Endpoint
* Related protocol extension: OpenID Connect
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2.6 (Authentication Error Response)](#AuthError) of this specification

* Error name: request\_not\_supported
* Error usage location: Authorization Endpoint
* Related protocol extension: OpenID Connect
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2.6 (Authentication Error Response)](#AuthError) of this specification

* Error name: request\_uri\_not\_supported
* Error usage location: Authorization Endpoint
* Related protocol extension: OpenID Connect
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2.6 (Authentication Error Response)](#AuthError) of this specification

* Error name: registration\_not\_supported
* Error usage location: Authorization Endpoint
* Related protocol extension: OpenID Connect
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* Specification document(s): [Section 3.1.2.6 (Authentication Error Response)](#AuthError) of this specification

---

| [TOC](#toc) |
| --- |

### 18.4.  URI Scheme Registration

This specification registers the following URI scheme
in the IANA
"Uniform Resource Identifier (URI) Schemes" registry [[IANA.URISchemes] (IANA, “Uniform Resource Identifier (URI) Schemes,” .)](#IANA.URISchemes)
established by [RFC 7595 (Thaler, D., Ed., Hansen, T., and T. Hardie, “Guidelines and Registration Procedures for URI Schemes,” June 2015.)](#RFC7595) [RFC7595].

---

| [TOC](#toc) |
| --- |

### 18.4.1.  Registry Contents

* Scheme name: openid
* Status: Permanent
* Applications/protocols that use this scheme name: OpenID Connect
* Contact: Michael B. Jones - michael\_b\_jones@hotmail.com
* Change controller: OpenID Foundation Artifact Binding Working Group - openid-specs-ab@lists.openid.net
* References: [Section 7.3 (Self-Issued OpenID Provider Request)](#SelfIssuedRequest) of this specification

---

| [TOC](#toc) |
| --- |

### 19.  References

---

| [TOC](#toc) |
| --- |

### 19.1. Normative References

| [CORS] | Opera Software ASA, “[Cross-Origin Resource Sharing](http://www.w3.org/TR/access-control/),” July 2010. |
| --- | --- |
| [E.164] | International Telecommunication Union, “[E.164: The international public telecommunication numbering plan](https://www.itu.int/rec/T-REC-E.164-201011-I/en),” 2010. |
| [IANA.AMR] | IANA, “[Authentication Method Reference Values](https://www.iana.org/assignments/authentication-method-reference-values).” |
| [IANA.JWT.Claims] | IANA, “[JSON Web Token Claims](https://www.iana.org/assignments/jwt).” |
| [IANA.Language] | IANA, “[Language Subtag Registry](https://www.iana.org/assignments/language-subtag-registry).” |
| [IANA.OAuth.Parameters] | IANA, “[OAuth Parameters](https://www.iana.org/assignments/oauth-parameters).” |
| [IANA.URISchemes] | IANA, “[Uniform Resource Identifier (URI) Schemes](https://www.iana.org/assignments/uri-schemes).” |
| [IANA.time-zones] | IANA, “[Time Zone Database](https://www.iana.org/time-zones).” |
| [ISO29115] | International Organization for Standardization, “[ISO/IEC 29115:2013. Information technology - Security techniques - Entity authentication assurance framework](https://www.iso.org/standard/45138.html),” ISO/IEC 29115:2013, April 2013. |
| [ISO3166-1] | International Organization for Standardization, “[ISO 3166-1:2020. Codes for the representation of names of countries and their subdivisions - Part 1: Country codes](https://www.iso.org/standard/72482.html),” August 2020. |
| [ISO639] | International Organization for Standardization, “[ISO 639:2023. Code for individual languages and language groups](https://www.iso.org/standard/74575.html),” November 2023. |
| [ISO8601-1] | International Organization for Standardization, “[ISO 8601-1:2019/Amd 1:2022. Date and time - Representations for information interchange - Part 1: Basic rules](https://www.iso.org/standard/81801.html),” October 2022. |
| [JWA] | Jones, M., “[JSON Web Algorithms (JWA)](https://www.rfc-editor.org/info/rfc7518),” RFC 7518, DOI 10.17487/RFC7518, May 2015. |
| [JWE] | Jones, M. and J. Hildebrand, “[JSON Web Encryption (JWE)](https://www.rfc-editor.org/info/rfc7516),” RFC 7516, DOI 10.17487/RFC7516, May 2015. |
| [JWK] | Jones, M., “[JSON Web Key (JWK)](https://www.rfc-editor.org/info/rfc7517),” RFC 7517, DOI 10.17487/RFC7517, May 2015. |
| [JWS] | Jones, M., Bradley, J., and N. Sakimura, “[JSON Web Signature (JWS)](https://www.rfc-editor.org/info/rfc7515),” RFC 7515, DOI 10.17487/RFC7515, May 2015. |
| [JWT] | Jones, M., Bradley, J., and N. Sakimura, “[JSON Web Token (JWT)](https://www.rfc-editor.org/info/rfc7519),” RFC 7519, DOI 10.17487/RFC7519, May 2015. |
| [OAuth.Assertions] | Campbell, B., Mortimore, C., Jones, M., and Y. Goland, “[Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants](https://www.rfc-editor.org/info/rfc7521),” RFC 7521, DOI 10.17487/RFC7521, May 2015. |
| [OAuth.JWT] | Jones, M., Campbell, B., and C. Mortimore, “[JSON Web Token (JWT) Profile for OAuth 2.0 Client Authentication and Authorization Grants](https://www.rfc-editor.org/info/rfc7523),” RFC 7523, DOI 10.17487/RFC7523, May 2015. |
| [OAuth.Responses] | de Medeiros, B., Ed., Scurtescu, M., Tarjan, P., and M. Jones, “[OAuth 2.0 Multiple Response Type Encoding Practices](https://openid.net/specs/oauth-v2-multiple-response-types-1_0.html),” February 2014. |
| [OpenID.Discovery] | Sakimura, N., Bradley, J., Jones, M., and E. Jay, “[OpenID Connect Discovery 1.0](https://openid.net/specs/openid-connect-discovery-1_0.html),” December 2023. |
| [OpenID.Registration] | Sakimura, N., Bradley, J., and M. Jones, “[OpenID Connect Dynamic Client Registration 1.0](https://openid.net/specs/openid-connect-registration-1_0.html),” December 2023. |
| [RFC20] | Cerf, V., “[ASCII format for Network Interchange](https://www.rfc-editor.org/info/rfc20),” STD 80, RFC 20, DOI 10.17487/RFC0020, October 1969. |
| [RFC2119] | Bradner, S., “[Key words for use in RFCs to Indicate Requirement Levels](https://www.rfc-editor.org/info/rfc2119),” BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997. |
| [RFC3339] | Klyne, G. and C. Newman, “[Date and Time on the Internet: Timestamps](https://www.rfc-editor.org/info/rfc3339),” RFC 3339, DOI 10.17487/RFC3339, July 2002. |
| [RFC3629] | Yergeau, F., “[UTF-8, a transformation format of ISO 10646](https://www.rfc-editor.org/info/rfc3629),” STD 63, RFC 3629, DOI 10.17487/RFC3629, November 2003. |
| [RFC3966] | Schulzrinne, H., “[The tel URI for Telephone Numbers](https://www.rfc-editor.org/info/rfc3966),” RFC 3966, DOI 10.17487/RFC3966, December 2004. |
| [RFC3986] | Berners-Lee, T., Fielding, R., and L. Masinter, “[Uniform Resource Identifier (URI): Generic Syntax](https://www.rfc-editor.org/info/rfc3986),” STD 66, RFC 3986, DOI 10.17487/RFC3986, January 2005. |
| [RFC5322] | Resnick, P., Ed., “[Internet Message Format](https://www.rfc-editor.org/info/rfc5322),” RFC 5322, DOI 10.17487/RFC5322, October 2008. |
| [RFC5646] | Phillips, A., Ed. and M. Davis, Ed., “[Tags for Identifying Languages](https://www.rfc-editor.org/info/rfc5646),” BCP 47, RFC 5646, DOI 10.17487/RFC5646, September 2009. |
| [RFC6125] | Saint-Andre, P. and J. Hodges, “[Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)](https://www.rfc-editor.org/info/rfc6125),” RFC 6125, DOI 10.17487/RFC6125, March 2011. |
| [RFC6711] | Johansson, L., “[An IANA Registry for Level of Assurance (LoA) Profiles](https://www.rfc-editor.org/info/rfc6711),” RFC 6711, DOI 10.17487/RFC6711, August 2012. |
| [RFC6749] | Hardt, D., Ed., “[The OAuth 2.0 Authorization Framework](https://www.rfc-editor.org/info/rfc6749),” RFC 6749, DOI 10.17487/RFC6749, October 2012. |
| [RFC6750] | Jones, M. and D. Hardt, “[The OAuth 2.0 Authorization Framework: Bearer Token Usage](https://www.rfc-editor.org/info/rfc6750),” RFC 6750, DOI 10.17487/RFC6750, October 2012. |
| [RFC6819] | Lodderstedt, T., Ed., McGloin, M., and P. Hunt, “[OAuth 2.0 Threat Model and Security Considerations](https://www.rfc-editor.org/info/rfc6819),” RFC 6819, DOI 10.17487/RFC6819, January 2013. |
| [RFC7230] | Fielding, R., Ed. and J. Reschke, Ed., “[Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing](https://www.rfc-editor.org/info/rfc7230),” RFC 7230, DOI 10.17487/RFC7230, June 2014. |
| [RFC7231] | Fielding, R., Ed. and J. Reschke, Ed., “[Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content](https://www.rfc-editor.org/info/rfc7231),” RFC 7231, DOI 10.17487/RFC7231, June 2014. |
| [RFC7234] | Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke, Ed., “[Hypertext Transfer Protocol (HTTP/1.1): Caching](https://www.rfc-editor.org/info/rfc7234),” RFC 7234, DOI 10.17487/RFC7234, June 2014. |
| [RFC8176] | Jones, M., Hunt, P., and A. Nadalin, “[Authentication Method Reference Values](https://www.rfc-editor.org/info/rfc8176),” RFC 8176, DOI 10.17487/RFC8176, June 2017. |
| [RFC8259] | Bray, T., Ed., “[The JavaScript Object Notation (JSON) Data Interchange Format](https://www.rfc-editor.org/info/rfc8259),” STD 90, RFC 8259, DOI 10.17487/RFC8259, December 2017. |
| [RFC8996] | Moriarty, K. and S. Farrell, “[Deprecating TLS 1.0 and TLS 1.1](https://www.rfc-editor.org/info/rfc8996),” BCP 195, RFC 8996, DOI 10.17487/RFC8996, March 2021. |
| [RFC9325] | Sheffer, Y., Saint-Andre, P., and T. Fossati, “[Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)](https://www.rfc-editor.org/info/rfc9325),” BCP 195, RFC 9325, DOI 10.17487/RFC9325, November 2022. |
| [UNICODE] | The Unicode Consortium, “[The Unicode Standard](http://www.unicode.org/versions/latest/).” |
| [USA15] | Whistler, K., “[Unicode Normalization Forms](https://www.unicode.org/reports/tr15/),” Unicode Standard Annex 15, August 2023. |
| [W3C.SPSD-html401-20180327] | “[HTML 4.01 Specification](https://www.w3.org/TR/2018/SPSD-html401-20180327/),” W3C REC SPSD-html401-20180327, W3C SPSD-html401-20180327, March 2018. |

---

| [TOC](#toc) |
| --- |

### 19.2. Informative References

| [JWK.Thumbprint] | Jones, M. and N. Sakimura, “[JSON Web Key (JWK) Thumbprint](https://www.rfc-editor.org/info/rfc7638),” RFC 7638, DOI 10.17487/RFC7638, September 2015. |
| --- | --- |
| [OAuth.Post] | Jones, M. and B. Campbell, “[OAuth 2.0 Form Post Response Mode](https://openid.net/specs/oauth-v2-form-post-response-mode-1_0.html),” April 2015. |
| [OpenID.2.0] | OpenID Foundation, “[OpenID Authentication 2.0](https://openid.net/specs/openid-authentication-2_0.html),” December 2007. |
| [OpenID.BackChannel] | Jones, M. and J. Bradley, “[OpenID Connect Back-Channel Logout 1.0](https://openid.net/specs/openid-connect-backchannel-1_0.html),” December 2023. |
| [OpenID.Basic] | Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore, “[OpenID Connect Basic Client Implementer's Guide 1.0](https://openid.net/specs/openid-connect-basic-1_0.html),” December 2023. |
| [OpenID.Core.Errata1] | Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore, “[OpenID Connect Core 1.0 incorporating errata set 1](https://openid.net/specs/openid-connect-core-1_0-errata1.html),” November 2014. |
| [OpenID.Core.Final] | Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore, “[OpenID Connect Core 1.0 (final)](https://openid.net/specs/openid-connect-core-1_0-final.html),” February 2014. |
| [OpenID.FrontChannel] | Jones, M., “[OpenID Connect Front-Channel Logout 1.0](https://openid.net/specs/openid-connect-frontchannel-1_0.html),” September 2022. |
| [OpenID.Implicit] | Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore, “[OpenID Connect Implicit Client Implementer's Guide 1.0](https://openid.net/specs/openid-connect-implicit-1_0.html),” December 2023. |
| [OpenID.PAPE] | Recordon, D., Jones, M., Bufu, J., Ed., Daugherty, J., Ed., and N. Sakimura, “[OpenID Provider Authentication Policy Extension 1.0](https://openid.net/specs/openid-provider-authentication-policy-extension-1_0.html),” December 2008. |
| [OpenID.RPInitiated] | Jones, M., de Medeiros, B., Agarwal, N., Sakimura, N., and J. Bradley, “[OpenID Connect RP-Initiated Logout 1.0](https://openid.net/specs/openid-connect-rpinitiated-1_0.html),” September 2022. |
| [OpenID.Session] | de Medeiros, B., Agarwal, N., Sakimura, N., Bradley, J., and M. Jones, “[OpenID Connect Session Management 1.0](https://openid.net/specs/openid-connect-session-1_0.html),” September 2022. |
| [RFC4949] | Shirey, R., “[Internet Security Glossary, Version 2](https://www.rfc-editor.org/info/rfc4949),” FYI 36, RFC 4949, DOI 10.17487/RFC4949, August 2007. |
| [RFC7595] | Thaler, D., Ed., Hansen, T., and T. Hardie, “[Guidelines and Registration Procedures for URI Schemes](https://www.rfc-editor.org/info/rfc7595),” BCP 35, RFC 7595, DOI 10.17487/RFC7595, June 2015. |
| [RFC9101] | Sakimura, N., Bradley, J., and M. Jones, “[The OAuth 2.0 Authorization Framework: JWT-Secured Authorization Request (JAR)](https://www.rfc-editor.org/info/rfc9101),” RFC 9101, DOI 10.17487/RFC9101, August 2021. |
| [X.1252] | International Telecommunication Union, “[ITU-T Recommendation X.1252 - Cyberspace security - Identity management - Baseline identity management terms and definitions](https://www.itu.int/SG-CP/example_docs/ITU-T-REC/ITU-T-REC_E.pdf),” ITU-T X.1252, April 2010. |

---

| [TOC](#toc) |
| --- |

### Appendix A.  Authorization Examples

The following are non-normative examples of Authorization Requests with
different response\_type values and their responses
(with line wraps within values for display purposes only):

---

| [TOC](#toc) |
| --- |

### A.1.  Example using response\_type=code

```

  GET /authorize?
    response_type=code
    &client_id=s6BhdRkqt3
    &redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &scope=openid%20profile%20email
    &nonce=n-0S6_WzA2Mj
    &state=af0ifjsldkj HTTP/1.1
  Host: server.example.com

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb?
    code=Qcb0Orv1zh30vL1MPRsbm-diHiMwcLyZvn1arpZv-Jxf_11jnpEX3Tgfvk
    &state=af0ifjsldkj

```

---

| [TOC](#toc) |
| --- |

### A.2.  Example using response\_type=id\_token

```

  GET /authorize?
    response_type=id_token
    &client_id=s6BhdRkqt3
    &redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &scope=openid%20profile%20email
    &nonce=n-0S6_WzA2Mj
    &state=af0ifjsldkj HTTP/1.1
  Host: server.example.com

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb#
    id_token=eyJraWQiOiIxZTlnZGs3IiwiYWxnIjoiUlMyNTYifQ.
    ewogImlzcyI6ICJodHRwczovL3NlcnZlci5leGFtcGxlLmNvbSIsCiAic3ViIjog
    IjI0ODI4OTc2MTAwMSIsCiAiYXVkIjogInM2QmhkUmtxdDMiLAogIm5vbmNlIjog
    Im4tMFM2X1d6QTJNaiIsCiAiZXhwIjogMTMxMTI4MTk3MCwKICJpYXQiOiAxMzEx
    MjgwOTcwLAogIm5hbWUiOiAiSmFuZSBEb2UiLAogImdpdmVuX25hbWUiOiAiSmFu
    ZSIsCiAiZmFtaWx5X25hbWUiOiAiRG9lIiwKICJnZW5kZXIiOiAiZmVtYWxlIiwK
    ICJiaXJ0aGRhdGUiOiAiMDAwMC0xMC0zMSIsCiAiZW1haWwiOiAiamFuZWRvZUBl
    eGFtcGxlLmNvbSIsCiAicGljdHVyZSI6ICJodHRwOi8vZXhhbXBsZS5jb20vamFu
    ZWRvZS9tZS5qcGciCn0.
    NTibBYW_ZoNHGm4ZrWCqYA9oJaxr1AVrJCze6FEcac4t_EOQiJFbD2nVEPkUXPuM
    shKjjTn7ESLIFUnfHq8UKTGibIC8uqrBgQAcUQFMeWeg-PkLvDTHk43Dn4_aNrxh
    mWwMNQfkjqx3wd2Fvta9j8yG2Qn790Gwb5psGcmBhqMJUUnFrGpyxQDhFIzzodmP
    okM7tnUxBNj-JuES_4CE-BvZICH4jKLp0TMu-WQsVst0ss-vY2RPdU1MzL59mq_e
    Kk8Rv9XhxIr3WteA2ZlrgVyT0cwH3hlCnRUsLfHtIEb8k1Y_WaqKUu3DaKPxqRi6
    u0rN7RO2uZYPzC454xe-mg
    &state=af0ifjsldkj

```

The value of the id\_token parameter is the ID Token,
which is a signed JWT,
containing three base64url-encoded segments separated by period ('.') characters.
The first segment represents the JOSE Header.
Base64url decoding it will result in the following set of Header Parameters:

```

  {"kid":"1e9gdk7","alg":"RS256"}

```

The alg value represents the algorithm
that was used to sign the JWT, in this case
RS256, representing RSASSA-PKCS1-v1\_5 using SHA-256.
The kid value is a key identifier used
in identifying the key to be used to verify the signature.
If the kid value is unknown to the RP,
it needs to retrieve the contents of the OP's JWK Set again
to obtain the OP's current set of keys.

The second segment represents the Claims in the ID Token.
Verifying and decoding the ID Token will yield the following Claims:

```

  {
   "iss": "https://server.example.com",
   "sub": "248289761001",
   "aud": "s6BhdRkqt3",
   "nonce": "n-0S6_WzA2Mj",
   "exp": 1311281970,
   "iat": 1311280970,
   "name": "Jane Doe",
   "given_name": "Jane",
   "family_name": "Doe",
   "gender": "female",
   "birthdate": "0000-10-31",
   "email": "janedoe@example.com",
   "picture": "http://example.com/janedoe/me.jpg"
  }

```

The third segment represents the ID Token signature,
which is verified as described in [[JWS] (Jones, M., Bradley, J., and N. Sakimura, “JSON Web Signature (JWS),” May 2015.)](#JWS).

---

| [TOC](#toc) |
| --- |

### A.3.  Example using response\_type=id\_token token

```

  GET /authorize?
    response_type=id_token%20token
    &client_id=s6BhdRkqt3
    &redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &scope=openid%20profile%20email
    &nonce=n-0S6_WzA2Mj
    &state=af0ifjsldkj HTTP/1.1
  Host: server.example.com

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb#
    access_token=jHkWEdUXMU1BwAsC4vtUsZwnNvTIxEl0z9K3vx5KF0Y
    &token_type=Bearer
    &id_token=eyJraWQiOiIxZTlnZGs3IiwiYWxnIjoiUlMyNTYifQ.
    ewogImlzcyI6ICJodHRwczovL3NlcnZlci5leGFtcGxlLmNvbSIsCiAic3ViIjog
    IjI0ODI4OTc2MTAwMSIsCiAiYXVkIjogInM2QmhkUmtxdDMiLAogIm5vbmNlIjog
    Im4tMFM2X1d6QTJNaiIsCiAiZXhwIjogMTMxMTI4MTk3MCwKICJpYXQiOiAxMzEx
    MjgwOTcwLAogImF0X2hhc2giOiAiNzdRbVVQdGpQZnpXdEYyQW5wSzlSUSIKfQ.
    kdqTmftlaXg5WBYBr1wkxhkqCGZPc0k8vTiV5g2jj67jQ7XkrDamYx2bOkZLdZrp
    MPIzkdYB1nZI_G8vQGQuamRhJcEIt21kblGPZ-yhEhdkAiZIZLu38rChalDS2Mh0
    glE_rke5XXRhmqqoEFFdziFdnO3p61-7y51co84OEAZvARSINQaOWIzvioRfs4zw
    IFOaT33Vpxfqr8HDyh31zo9eBW2dSQuCa071z0ENWChWoPliK1JCo_Bk9eDg2uwo
    2ZwhsvHzj6TMQ0lYOTzufSlSmXIKfjlOsb3nftQeR697_hA-nMZyAdL8_NRfaC37
    XnAbW8WB9wCfECp7cuNuOg
    &state=af0ifjsldkj

```

Verifying and decoding the ID Token will yield the following Claims:

```

  {
   "iss": "https://server.example.com",
   "sub": "248289761001",
   "aud": "s6BhdRkqt3",
   "nonce": "n-0S6_WzA2Mj",
   "exp": 1311281970,
   "iat": 1311280970,
   "at_hash": "77QmUPtjPfzWtF2AnpK9RQ"
  }

```

---

| [TOC](#toc) |
| --- |

### A.4.  Example using response\_type=code id\_token

```

  GET /authorize?
    response_type=code%20id_token
    &client_id=s6BhdRkqt3
    &redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &scope=openid%20profile%20email
    &nonce=n-0S6_WzA2Mj
    &state=af0ifjsldkj HTTP/1.1
  Host: server.example.com

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb#
    code=Qcb0Orv1zh30vL1MPRsbm-diHiMwcLyZvn1arpZv-Jxf_11jnpEX3Tgfvk
    &id_token=eyJraWQiOiIxZTlnZGs3IiwiYWxnIjoiUlMyNTYifQ.
    ewogImlzcyI6ICJodHRwczovL3NlcnZlci5leGFtcGxlLmNvbSIsCiAic3ViIjog
    IjI0ODI4OTc2MTAwMSIsCiAiYXVkIjogInM2QmhkUmtxdDMiLAogIm5vbmNlIjog
    Im4tMFM2X1d6QTJNaiIsCiAiZXhwIjogMTMxMTI4MTk3MCwKICJpYXQiOiAxMzEx
    MjgwOTcwLAogImNfaGFzaCI6ICJMRGt0S2RvUWFrM1BrMGNuWHhDbHRBIgp9.
    MRPihYtNIcwKTZ_mcMSPfreVytGR4jfl1Tzbv4tH5Jr4WqONs2lUWrIEpZ2joKbZ
    fAGlouAqwqSYpfR3FQYKYvdgnZ3kjIJ_5M4fAARXHVSciGyhfqB-OhDUMXSHzFHi
    GKNY9TKSgRfiXf_314WRujpqaDtj2uoXbppobYXvAZIxWtsOein0-t91LDS39EW4
    frNWAopKTBBi_XJPlpLVynWTDvNleEBP6UxIMgYJBKlqsP7RGfHTGk3ReXDacR7R
    GZlIVGa-0qRyDzvNqD7xfu9aYufUP0oBGqdBGgFVNmwJ7rmB0gdPtC2eJsXq9svC
    gBBfhRQZxhx1iLJjNc9nSw
    &state=af0ifjsldkj

```

Verifying and decoding the ID Token will yield the following Claims:

```

  {
   "iss": "https://server.example.com",
   "sub": "248289761001",
   "aud": "s6BhdRkqt3",
   "nonce": "n-0S6_WzA2Mj",
   "exp": 1311281970,
   "iat": 1311280970,
   "c_hash": "LDktKdoQak3Pk0cnXxCltA"
  }

```

---

| [TOC](#toc) |
| --- |

### A.5.  Example using response\_type=code token

```

  GET /authorize?
    response_type=code%20token
    &client_id=s6BhdRkqt3
    &redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &scope=openid%20profile%20email
    &nonce=n-0S6_WzA2Mj
    &state=af0ifjsldkj HTTP/1.1
  Host: server.example.com

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb#
    code=Qcb0Orv1zh30vL1MPRsbm-diHiMwcLyZvn1arpZv-Jxf_11jnpEX3Tgfvk
    &access_token=jHkWEdUXMU1BwAsC4vtUsZwnNvTIxEl0z9K3vx5KF0Y
    &token_type=Bearer
    &state=af0ifjsldkj

```

---

| [TOC](#toc) |
| --- |

### A.6.  Example using response\_type=code id\_token token

```

  GET /authorize?
    response_type=code%20id_token%20token
    &client_id=s6BhdRkqt3
    &redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
    &scope=openid%20profile%20email
    &nonce=n-0S6_WzA2Mj
    &state=af0ifjsldkj HTTP/1.1
  Host: server.example.com

  HTTP/1.1 302 Found
  Location: https://client.example.org/cb#
    code=Qcb0Orv1zh30vL1MPRsbm-diHiMwcLyZvn1arpZv-Jxf_11jnpEX3Tgfvk
    &access_token=jHkWEdUXMU1BwAsC4vtUsZwnNvTIxEl0z9K3vx5KF0Y
    &token_type=Bearer
    &id_token=eyJraWQiOiIxZTlnZGs3IiwiYWxnIjoiUlMyNTYifQ.
    ewogImlzcyI6ICJodHRwczovL3NlcnZlci5leGFtcGxlLmNvbSIsCiAic3ViIjog
    IjI0ODI4OTc2MTAwMSIsCiAiYXVkIjogInM2QmhkUmtxdDMiLAogIm5vbmNlIjog
    Im4tMFM2X1d6QTJNaiIsCiAiZXhwIjogMTMxMTI4MTk3MCwKICJpYXQiOiAxMzEx
    MjgwOTcwLAogImF0X2hhc2giOiAiNzdRbVVQdGpQZnpXdEYyQW5wSzlSUSIsCiAi
    Y19oYXNoIjogIkxEa3RLZG9RYWszUGswY25YeENsdEEiCn0.
    A2OhhJzbUNaCbNLqNaqetGLJoxB3ujVbq_HLYSOWgWCJ3-B__YxlqIg8gpeL0Vhv
    rWX0mwz7w_pGTRN4JdgsI0xAlT5fob1ZPnrazgonSyzaXcg2bgD896SsBSlG_8JX
    6JKaztXifn8k2gy65Me-sMyQrRF8xv_q1CeC871sZpMjJzy5nx65BTI17vcXjntZ
    HADv6o2CrHrEdHp8xSlnTLiiIqgDOmKlpkeqqOBK6dqa4rXZlSqMAUm1LYZmtb2D
    8sHvQsxTbWlBkX7VZaTSqMJ487s4ZIEea8Bw4KGVOntQue4VhBjBnQ4bQKhB_47D
    xlWpSyOWdy3cer_zxKrfvw
    &state=af0ifjsldkj

```

Verifying and decoding the ID Token will yield the following Claims:

```

  {
   "iss": "https://server.example.com",
   "sub": "248289761001",
   "aud": "s6BhdRkqt3",
   "nonce": "n-0S6_WzA2Mj",
   "exp": 1311281970,
   "iat": 1311280970,
   "at_hash": "77QmUPtjPfzWtF2AnpK9RQ",
   "c_hash": "LDktKdoQak3Pk0cnXxCltA"
  }

```

---

| [TOC](#toc) |
| --- |

### A.7.  RSA Key Used in Examples

The following RSA public key, represented in JWK format, can be used to
validate the ID Token signatures in the above examples
(with line wraps within values for display purposes only):

```

  {
   "kty":"RSA",
   "kid":"1e9gdk7",
   "n":"w7Zdfmece8iaB0kiTY8pCtiBtzbptJmP28nSWwtdjRu0f2GFpajvWE4VhfJA
        jEsOcwYzay7XGN0b-X84BfC8hmCTOj2b2eHT7NsZegFPKRUQzJ9wW8ipn_aD
        JWMGDuB1XyqT1E7DYqjUCEOD1b4FLpy_xPn6oV_TYOfQ9fZdbE5HGxJUzeku
        GcOKqOQ8M7wfYHhHHLxGpQVgL0apWuP2gDDOdTtpuld4D2LK1MZK99s9gaSj
        RHE8JDb1Z4IGhEcEyzkxswVdPndUWzfvWBBWXWxtSUvQGBRkuy1BHOa4sP6F
        KjWEeeF7gm7UMs2Nm2QUgNZw6xvEDGaLk4KASdIxRQ",
   "e":"AQAB"
  }

```

---

| [TOC](#toc) |
| --- |

### Appendix B.  Acknowledgements

As a successor version of OpenID, this specification heavily relies
on ideas explored in [OpenID Authentication 2.0 (OpenID Foundation, “OpenID Authentication 2.0,” December 2007.)](#OpenID.2.0) [OpenID.2.0]. Please
refer to Appendix C of OpenID Authentication 2.0 for the full list of
the contributors for that specification.

In addition, the OpenID Community would like to thank the following people for
their contributions to this specification:

> Naveen Agarwal (Naveen.Agarwal@microsoft.com), Microsoft (was at Google)
>
> Amanda Anganes (aanganes@mitre.org), MITRE
>
> Casper Biering (cb@peercraft.com), Peercraft
>
> John Bradley (ve7jtb@ve7jtb.com), Yubico (was at Ping Identity)
>
> Tim Bray (tbray@textuality.com), independent (was at Google)
>
> Johnny Bufu (johnny.bufu@gmail.com), independent (was at Janrain)
>
> Brian Campbell (bcampbell@pingidentity.com), Ping Identity
>
> Blaine Cook (romeda@gmail.com), independent
>
> Breno de Medeiros (breno@google.com), Google
>
> Pamela Dingle (Pamela.Dingle@microsoft.com), Microsoft (was at Ping Identity)
>
> Vladimir Dzhuvinov (vladimir@connect2id.com), Connect2id (was at Nimbus Directory Services)
>
> George Fletcher (gffletch@aol.com), Capital One (was at AOL)
>
> Roland Hedberg (roland@catalogix.se), independent (was at University of Umeå)
>
> Ryo Ito (ryo.ito@mixi.co.jp), mixi, Inc.
>
> Edmund Jay (ejay@mgi1.com), Illumila
>
> Michael B. Jones (michael\_b\_jones@hotmail.com), Self-Issued Consulting (was at Microsoft)
>
> Torsten Lodderstedt (torsten@lodderstedt.net), independent (was at Deutsche Telekom)
>
> James Manger (James.H.Manger@team.telstra.com), Telstra
>
> Nov Matake (nov@matake.jp), independent
>
> Chuck Mortimore (charliemortimore@gmail.com), Disney (was at Salesforce)
>
> Anthony Nadalin (nadalin@prodigy.net), independent (was at Microsoft)
>
> Hideki Nara (hdknr@ic-tact.co.jp), Tact Communications
>
> Axel Nennker (axel.nennker@telekom.de), Deutsche Telekom
>
> David Recordon (recordond@gmail.com), independent (was at Facebook)
>
> Justin Richer (justin@bspk.io), Bespoke Engineering (was at MITRE)
>
> Nat Sakimura (nat@nat.consulting), NAT.Consulting (was at NRI)
>
> Luke Shepard (luke@lukeshepard.com), Facebook
>
> Andreas Åkre Solberg (Andreas.Solberg@sikt.no), Sikt (was at UNINET)
>
> Paul Tarjan (paul@paultarjan.com), Facebook

---

| [TOC](#toc) |
| --- |

### Appendix C.  Notices

Copyright (c) 2023 The OpenID Foundation.

The OpenID Foundation (OIDF) grants to any Contributor, developer,
implementer, or other interested party a non-exclusive, royalty free,
worldwide copyright license to reproduce, prepare derivative works from,
distribute, perform and display, this Implementers Draft or
Final Specification solely for the purposes of (i) developing
specifications, and (ii) implementing Implementers Drafts and
Final Specifications based on such documents, provided that attribution
be made to the OIDF as the source of the material, but that such attribution
does not indicate an endorsement by the OIDF.

The technology described in this specification was
made available from contributions from various sources,
including members of the OpenID Foundation and others.
Although the OpenID Foundation has taken steps to help ensure
that the technology is available for distribution, it takes
no position regarding the validity or scope of any intellectual
property or other rights that might be claimed to pertain to
the implementation or use of the technology described in
this specification or the extent to which any license under
such rights might or might not be available; neither does it
represent that it has made any independent effort to identify
any such rights. The OpenID Foundation and the contributors
to this specification make no (and hereby expressly disclaim any)
warranties (express, implied, or otherwise), including implied
warranties of merchantability, non-infringement, fitness for
a particular purpose, or title, related to this specification,
and the entire risk as to implementing this specification is
assumed by the implementer. The OpenID Intellectual
Property Rights policy requires contributors to offer
a patent promise not to assert certain patent claims against
other contributors and against implementers. The OpenID Foundation invites
any interested party to bring to its attention any copyrights,
patents, patent applications, or other proprietary rights
that may cover technology that may be required to practice
this specification.

---

| [TOC](#toc) |
| --- |

### Authors' Addresses

|  | Nat Sakimura |
| --- | --- |
|  | NAT.Consulting |
| Email: | nat@nat.consulting |
| URI: | <https://nat.sakimura.org/> |
|  |  |
|  | John Bradley |
|  | Yubico |
| Email: | ve7jtb@ve7jtb.com |
| URI: | <http://www.thread-safe.com/> |
|  |  |
|  | Michael B. Jones |
|  | Self-Issued Consulting |
| Email: | michael\_b\_jones@hotmail.com |
| URI: | <https://self-issued.info/> |
|  |  |
|  | Breno de Medeiros |
|  | Google |
| Email: | breno@google.com |
| URI: | <https://stackoverflow.com/users/311376/breno> |
|  |  |
|  | Chuck Mortimore |
|  | Disney |
| Email: | charliemortimore@gmail.com |
| URI: | <https://twitter.com/cmort> |



=== Content from github.com_bb5799bd_20250119_112505.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fory%2Ffosite%2Fsecurity%2Fadvisories%2FGHSA-v3q9-2p3m-7g43)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fory%2Ffosite%2Fsecurity%2Fadvisories%2FGHSA-v3q9-2p3m-7g43)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=ory%2Ffosite)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ory](/ory)
/
**[fosite](/ory/fosite)**
Public

* [Notifications](/login?return_to=%2Fory%2Ffosite) You must be signed in to change notification settings
* [Fork
  368](/login?return_to=%2Fory%2Ffosite)
* [Star
   2.3k](/login?return_to=%2Fory%2Ffosite)

* [Code](/ory/fosite)
* [Issues
  25](/ory/fosite/issues)
* [Pull requests
  19](/ory/fosite/pulls)
* [Actions](/ory/fosite/actions)
* [Security](/ory/fosite/security)
* [Insights](/ory/fosite/pulse)

Additional navigation options

* [Code](/ory/fosite)
* [Issues](/ory/fosite/issues)
* [Pull requests](/ory/fosite/pulls)
* [Actions](/ory/fosite/actions)
* [Security](/ory/fosite/security)
* [Insights](/ory/fosite/pulse)

# Disallow replay of `private\_key\_jwt` by blacklisting JTIs

Moderate

[aeneasr](/aeneasr)
published
GHSA-v3q9-2p3m-7g43
Sep 24, 2020

## Package

No package listed

## Affected versions

v0.30.5

## Patched versions

None

## Description

### Impact

When using client authentication method "private\_key\_jwt" [1], OpenId specification says the following about assertion `jti`:

> A unique identifier for the token, which can be used to prevent reuse of the token. These tokens MUST only be used once, unless conditions for reuse were negotiated between the parties

Hydra does not seem to check the uniqueness of this `jti` value. Here is me sending the same token request twice, hence with the same `jti` assertion, and getting two access tokens:

```
$ curl --insecure --location --request POST 'https://localhost/_/oauth2/token' \
   --header 'Content-Type: application/x-www-form-urlencoded' \
   --data-urlencode 'grant_type=client_credentials' \
   --data-urlencode 'client_id=c001d00d-5ecc-beef-ca4e-b00b1e54a111' \
   --data-urlencode 'scope=application openid' \
   --data-urlencode 'client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer' \
   --data-urlencode 'client_assertion=eyJhb [...] jTw'
{"access_token":"zeG0NoqOtlACl8q5J6A-TIsNegQRRUzqLZaYrQtoBZQ.VR6iUcJQYp3u_j7pwvL7YtPqGhtyQe5OhnBE2KCp5pM","expires_in":3599,"scope":"application openid","token_type":"bearer"}⏎
$ curl --insecure --location --request POST 'https://localhost/_/oauth2/token' \
   --header 'Content-Type: application/x-www-form-urlencoded' \
   --data-urlencode 'grant_type=client_credentials' \
   --data-urlencode 'client_id=c001d00d-5ecc-beef-ca4e-b00b1e54a111' \
   --data-urlencode 'scope=application openid' \
   --data-urlencode 'client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer' \
   --data-urlencode 'client_assertion=eyJhb [...] jTw'
{"access_token":"wOYtgCLxLXlELORrwZlmeiqqMQ4kRzV-STU2_Sollas.mwlQGCZWXN7G2IoegUe1P0Vw5iGoKrkOzOaplhMSjm4","expires_in":3599,"scope":"application openid","token_type":"bearer"}

```
### Patches

*Has the problem been patched? What versions should users upgrade to?*

### Workarounds

Do not allow clients to use `private_key_jwt`.

### References

<https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication>

### Severity

Moderate

### CVE ID

CVE-2020-15222

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


