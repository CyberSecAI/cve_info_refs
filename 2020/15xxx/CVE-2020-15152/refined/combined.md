=== Content from github.com_51ed378b_20250119_125645.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fsecurity%2Fadvisories%2FGHSA-jw37-5gqr-cf9j)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fsecurity%2Fadvisories%2FGHSA-jw37-5gqr-cf9j)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=QuorumDMS%2Fftp-srv)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[QuorumDMS](/QuorumDMS)
/
**[ftp-srv](/QuorumDMS/ftp-srv)**
Public

* [Notifications](/login?return_to=%2FQuorumDMS%2Fftp-srv) You must be signed in to change notification settings
* [Fork
  117](/login?return_to=%2FQuorumDMS%2Fftp-srv)
* [Star
   390](/login?return_to=%2FQuorumDMS%2Fftp-srv)

* [Code](/QuorumDMS/ftp-srv)
* [Issues
  37](/QuorumDMS/ftp-srv/issues)
* [Pull requests
  16](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects
  0](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

Additional navigation options

* [Code](/QuorumDMS/ftp-srv)
* [Issues](/QuorumDMS/ftp-srv/issues)
* [Pull requests](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

# Server-Side Request Forgery

Critical

[matt-forster](/matt-forster)
published
GHSA-jw37-5gqr-cf9j
Aug 17, 2020

## Package

npm

ftp-srv
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

<2.19.6, <3.1.2, <4.3.4

## Patched versions

^2.19.6, ^3.1.2, ^4.3.4

## Description

### Impact

`ftp-srv` from **v1.0.0** onward to **v4.3.3**.

### Background

The FTP protocol creates two connections, one for commands and one for transferring data.

This second data connection can be created in two ways, on the server by sending the PASV command, or on the client by sending the PORT command.

The PORT command sends the IP and port for the server to connect to the client with.

### Issue

Since the client can send an arbitrary IP with the PORT command, this can be used to cause the server to make a connection elsewhere.

### Patches

* *fix: disallow PORT connections to alternate hosts*: [e449e75](https://github.com/QuorumDMS/ftp-srv/commit/e449e75219d918c400dec65b4b0759f60476abca)

Deprecation notices have been published for older versions.

### Workarounds

Blacklisting the FTP Command `PORT` will prevent the server from exposing this behaviour through active connections until a fix is applied.

```
const ftp = new FtpSrv({
  blacklist: ['PORT']
});
```
### References

<https://www.npmjs.com/advisories/1445>

### Credits

Thank you to;

[@trs](https://github.com/trs) for fixing it

[@andreeleuterio](https://github.com/andreeleuterio) for reporting it to us for an anonymous user (Vincent) through the NPM platform

[@quiquelhappy](https://github.com/quiquelhappy) for bringing it to our attention after it slipped through the cracks during Christmas

### For more information

If you have any questions or comments about this advisory:

* Open an issue at <https://github.com/autovance/ftp-srv>
* Email us directly; security@autovance.com

### Severity

Critical

### CVE ID

CVE-2020-15152

### Weaknesses

No CWEs

### Credits

* [![@andreeleuterio](https://avatars.githubusercontent.com/u/11207474?s=40&v=4)](/andreeleuterio)
  [andreeleuterio](/andreeleuterio)
  Analyst
* [![@trs](https://avatars.githubusercontent.com/u/15315657?s=40&v=4)](/trs)
  [trs](/trs)
  Analyst
* [![@quiquelhappy](https://avatars.githubusercontent.com/u/12534357?s=40&v=4)](/quiquelhappy)
  [quiquelhappy](/quiquelhappy)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e4a41f40_20250119_142433.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=QuorumDMS%2Fftp-srv)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[QuorumDMS](/QuorumDMS)
/
**[ftp-srv](/QuorumDMS/ftp-srv)**
Public

* [Notifications](/login?return_to=%2FQuorumDMS%2Fftp-srv) You must be signed in to change notification settings
* [Fork
  117](/login?return_to=%2FQuorumDMS%2Fftp-srv)
* [Star
   390](/login?return_to=%2FQuorumDMS%2Fftp-srv)

📮 Modern FTP Server

### License

[MIT license](/QuorumDMS/ftp-srv/blob/main/LICENSE)

[390
stars](/QuorumDMS/ftp-srv/stargazers) [117
forks](/QuorumDMS/ftp-srv/forks) [Branches](/QuorumDMS/ftp-srv/branches) [Tags](/QuorumDMS/ftp-srv/tags) [Activity](/QuorumDMS/ftp-srv/activity)
 [Star](/login?return_to=%2FQuorumDMS%2Fftp-srv)

 [Notifications](/login?return_to=%2FQuorumDMS%2Fftp-srv) You must be signed in to change notification settings

* [Code](/QuorumDMS/ftp-srv)
* [Issues
  37](/QuorumDMS/ftp-srv/issues)
* [Pull requests
  16](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects
  0](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

Additional navigation options

* [Code](/QuorumDMS/ftp-srv)
* [Issues](/QuorumDMS/ftp-srv/issues)
* [Pull requests](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

# QuorumDMS/ftp-srv

    main[Branches](/QuorumDMS/ftp-srv/branches)[Tags](/QuorumDMS/ftp-srv/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[352 Commits](/QuorumDMS/ftp-srv/commits/main/) | | |
| [.circleci](/QuorumDMS/ftp-srv/tree/main/.circleci ".circleci") | | [.circleci](/QuorumDMS/ftp-srv/tree/main/.circleci ".circleci") |  |  |
| [.github](/QuorumDMS/ftp-srv/tree/main/.github ".github") | | [.github](/QuorumDMS/ftp-srv/tree/main/.github ".github") |  |  |
| [bin](/QuorumDMS/ftp-srv/tree/main/bin "bin") | | [bin](/QuorumDMS/ftp-srv/tree/main/bin "bin") |  |  |
| [changelog](/QuorumDMS/ftp-srv/tree/main/changelog "changelog") | | [changelog](/QuorumDMS/ftp-srv/tree/main/changelog "changelog") |  |  |
| [meta](/QuorumDMS/ftp-srv/tree/main/meta "meta") | | [meta](/QuorumDMS/ftp-srv/tree/main/meta "meta") |  |  |
| [src](/QuorumDMS/ftp-srv/tree/main/src "src") | | [src](/QuorumDMS/ftp-srv/tree/main/src "src") |  |  |
| [test](/QuorumDMS/ftp-srv/tree/main/test "test") | | [test](/QuorumDMS/ftp-srv/tree/main/test "test") |  |  |
| [.editorconfig](/QuorumDMS/ftp-srv/blob/main/.editorconfig ".editorconfig") | | [.editorconfig](/QuorumDMS/ftp-srv/blob/main/.editorconfig ".editorconfig") |  |  |
| [.eslintignore](/QuorumDMS/ftp-srv/blob/main/.eslintignore ".eslintignore") | | [.eslintignore](/QuorumDMS/ftp-srv/blob/main/.eslintignore ".eslintignore") |  |  |
| [.gitattributes](/QuorumDMS/ftp-srv/blob/main/.gitattributes ".gitattributes") | | [.gitattributes](/QuorumDMS/ftp-srv/blob/main/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/QuorumDMS/ftp-srv/blob/main/.gitignore ".gitignore") | | [.gitignore](/QuorumDMS/ftp-srv/blob/main/.gitignore ".gitignore") |  |  |
| [CODEOWNERS](/QuorumDMS/ftp-srv/blob/main/CODEOWNERS "CODEOWNERS") | | [CODEOWNERS](/QuorumDMS/ftp-srv/blob/main/CODEOWNERS "CODEOWNERS") |  |  |
| [CONTRIBUTING.md](/QuorumDMS/ftp-srv/blob/main/CONTRIBUTING.md "CONTRIBUTING.md") | | [CONTRIBUTING.md](/QuorumDMS/ftp-srv/blob/main/CONTRIBUTING.md "CONTRIBUTING.md") |  |  |
| [LICENSE](/QuorumDMS/ftp-srv/blob/main/LICENSE "LICENSE") | | [LICENSE](/QuorumDMS/ftp-srv/blob/main/LICENSE "LICENSE") |  |  |
| [README.md](/QuorumDMS/ftp-srv/blob/main/README.md "README.md") | | [README.md](/QuorumDMS/ftp-srv/blob/main/README.md "README.md") |  |  |
| [SECURITY.md](/QuorumDMS/ftp-srv/blob/main/SECURITY.md "SECURITY.md") | | [SECURITY.md](/QuorumDMS/ftp-srv/blob/main/SECURITY.md "SECURITY.md") |  |  |
| [ftp-srv.d.ts](/QuorumDMS/ftp-srv/blob/main/ftp-srv.d.ts "ftp-srv.d.ts") | | [ftp-srv.d.ts](/QuorumDMS/ftp-srv/blob/main/ftp-srv.d.ts "ftp-srv.d.ts") |  |  |
| [ftp-srv.js](/QuorumDMS/ftp-srv/blob/main/ftp-srv.js "ftp-srv.js") | | [ftp-srv.js](/QuorumDMS/ftp-srv/blob/main/ftp-srv.js "ftp-srv.js") |  |  |
| [logo.png](/QuorumDMS/ftp-srv/blob/main/logo.png "logo.png") | | [logo.png](/QuorumDMS/ftp-srv/blob/main/logo.png "logo.png") |  |  |
| [package-lock.json](/QuorumDMS/ftp-srv/blob/main/package-lock.json "package-lock.json") | | [package-lock.json](/QuorumDMS/ftp-srv/blob/main/package-lock.json "package-lock.json") |  |  |
| [package.json](/QuorumDMS/ftp-srv/blob/main/package.json "package.json") | | [package.json](/QuorumDMS/ftp-srv/blob/main/package.json "package.json") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
* Security

[![ftp-srv](/QuorumDMS/ftp-srv/raw/main/logo.png)](https://github.com/autovance/ftp-srv)

Modern, extensible FTP Server

[![npm](https://camo.githubusercontent.com/b7710aa140ced9c5be449eb0e57aa346ee89b8e5cc884509fd6f842675829557/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f646d2f6674702d7372762e7376673f7374796c653d666f722d7468652d6261646765)](https://www.npmjs.com/package/ftp-srv)
[![circleci](https://camo.githubusercontent.com/84c59ad2a52d504c0550ef4044aa22237161a13af2907cd68a0d0a78dfd1aec3/68747470733a2f2f696d672e736869656c64732e696f2f636972636c6563692f70726f6a6563742f6769746875622f6175746f76616e63652f6674702d7372762f6d61737465722e7376673f7374796c653d666f722d7468652d6261646765)](https://circleci.com/gh/autovance/workflows/ftp-srv/tree/master)

---

## Overview

`ftp-srv` is a modern and extensible FTP server designed to be simple yet configurable.

## Features

* Extensible [file systems](#file-system) per connection
* Passive and active transfers
* [Explicit](https://en.wikipedia.org/wiki/FTPS#Explicit) & [Implicit](https://en.wikipedia.org/wiki/FTPS#Implicit) TLS connections
* Promise based API

## Install

`npm install ftp-srv --save`

## Usage

```
// Quick start, create an active ftp server.
const FtpSrv = require('ftp-srv');

const port=21;
const ftpServer = new FtpSrv({
    url: "ftp://0.0.0.0:" + port,
    anonymous: true
});

ftpServer.on('login', ({ connection, username, password }, resolve, reject) => {
    if(username === 'anonymous' && password === 'anonymous'){
        return resolve({ root:"/" });
    }
    return reject(new errors.GeneralError('Invalid username or password', 401));
});

ftpServer.listen().then(() => {
    console.log('Ftp server is starting...')
});
```

## API

### `new FtpSrv({options})`

#### url

[URL string](https://nodejs.org/api/url.html#url_url_strings_and_url_objects) indicating the protocol, hostname, and port to listen on for connections.
Supported protocols:

* `ftp` Plain FTP
* `ftps` Implicit FTP over TLS

*Note:* The hostname must be the external IP address to accept external connections. `0.0.0.0` will listen on any available hosts for server and passive connections.

**Default:** `"ftp://127.0.0.1:21"`

#### `pasv_url`

`FTP-srv` provides an IP address to the client when a `PASV` command is received in the handshake for a passive connection. Reference [PASV verb](https://cr.yp.to/ftp/retr.html#pasv). This can be one of two options:

* A function which takes one parameter containing the remote IP address of the FTP client. This can be useful when the user wants to return a different IP address depending if the user is connecting from Internet or from an LAN address.
  Example:

```
const { networkInterfaces } = require('os');
const { Netmask } = require('netmask');

const nets = networkInterfaces();
function getNetworks() {
   let networks = {};
   for (const name of Object.keys(nets)) {
       for (const net of nets[name]) {
           if (net.family === 'IPv4' && !net.internal) {
               networks[net.address + "/24"] = net.address
           }
       }
   }
   return networks;
}

const resolverFunction = (address) => {
   // const networks = {
   //     '$GATEWAY_IP/32': `${public_ip}`,
   //     '10.0.0.0/8'    : `${lan_ip}`
   // }
   const networks = getNetworks();
   for (const network in networks) {
       if (new Netmask(network).contains(address)) {
           return networks[network];
       }
   }
   return "127.0.0.1";
}

new FtpSrv({pasv_url: resolverFunction});
```

* A static IP address (ie. an external WAN **IP address** that the FTP server is bound to). In this case, only connections from localhost are handled differently returning `127.0.0.1` to the client.

If not provided, clients can only connect using an `Active` connection.

#### `pasv_min`

The starting port to accept passive connections.

**Default:** `1024`

#### `pasv_max`

The ending port to accept passive connections.

The range is then queried for an available port to use when required.

**Default:** `65535`

#### `greeting`

A human readable array of lines or string to send when a client connects.

**Default:** `null`

#### `tls`

Node [TLS secure context object](https://nodejs.org/api/tls.html#tls_tls_createsecurecontext_options) used for implicit (`ftps` protocol) or explicit (`AUTH TLS`) connections.

**Default:** `false`

#### `anonymous`

If true, will allow clients to authenticate using the username `anonymous`, not requiring a password from the user.

Can also set as a string which allows users to authenticate using the username provided.

The `login` event is then sent with the provided username and `@anonymous` as the password.

**Default:** `false`

#### `blacklist`

Array of commands that are not allowed.

Response code `502` is sent to clients sending one of these commands.

**Example:** `['RMD', 'RNFR', 'RNTO']` will not allow users to delete directories or rename any files.

**Default:** `[]`

#### `whitelist`

Array of commands that are only allowed.

Response code `502` is sent to clients sending any other command.

**Default:** `[]`

#### `file_format`

Sets the format to use for file stat queries such as `LIST`.

**Default:** `"ls"`

**Allowable values:**

* `ls` [bin/ls format](https://cr.yp.to/ftp/list/binls.html)
* `ep` [Easily Parsed LIST format](https://cr.yp.to/ftp/list/eplf.html)
* `function () {}` A custom function returning a format or promise for one.
  + Only one argument is passed in: a node [file stat](https://nodejs.org/api/fs.html#fs_class_fs_stats) object with additional file `name` parameter

#### `log`

A [bunyan logger](https://github.com/trentm/node-bunyan) instance. Created by default.

#### `timeout`

Sets the timeout (in ms) after that an idle connection is closed by the server

**Default:** `0`

## CLI

`ftp-srv` also comes with a builtin CLI.

```
$ ftp-srv [url] [options]
```

```
$ ftp-srv ftp://0.0.0.0:9876 --root ~/Documents
```

#### `url`

Set the listening URL.

Defaults to `ftp://127.0.0.1:21`

#### `--pasv_url`

The hostname to provide a client when attempting a passive connection (`PASV`).

If not provided, clients can only connect using an `Active` connection.

#### `--pasv_min`

The starting port to accept passive connections.

**Default:** `1024`

#### `--pasv_max`

The ending port to accept passive connections.

The range is then queried for an available port to use when required.

**Default:** `65535`

#### `--root` / `-r`

Set the default root directory for users.

Defaults to the current directory.

#### `--credentials` / `-c`

Set the path to a json credentials file.

Format:

```
[
  {
    "username": "...",
    "password": "...",
    "root": "..." // Root directory
  },
  ...
]
```

#### `--username`

Set the username for the only user. Do not provide an argument to allow anonymous login.

#### `--password`

Set the password for the given `username`.

#### `--read-only`

Disable write actions such as upload, delete, etc.

## Events

The `FtpSrv` class extends the [node net.Server](https://nodejs.org/api/net.html#net_class_net_server). Some custom events can be resolved or rejected, such as `login`.

### `client-error`

```
ftpServer.on('client-error', ({connection, context, error}) => { ... });
```

Occurs when an error arises in the client connection.

`connection` [client class object](/QuorumDMS/ftp-srv/blob/main/src/connection.js)

`context` string of where the error occurred

`error` error object

### `disconnect`

```
ftpServer.on('disconnect', ({connection, id, newConnectionCount}) => { ... });
```

Occurs when a client has disconnected.

`connection` [client class object](/QuorumDMS/ftp-srv/blob/main/src/connection.js)

`id` string of the disconnected connection id

`id` number of the new connection count (exclusive the disconnected client connection)

### `closed`

```
ftpServer.on('closed', ({}) => { ... });
```

Occurs when the FTP server has been closed.

### `closing`

```
ftpServer.on('closing', ({}) => { ... });
```

Occurs when the FTP server has started closing.

### `login`

```
ftpServer.on('login', ({connection, username, password}, resolve, reject) => { ... });
```

Occurs when a client is attempting to login. Here you can resolve the login request by username and password.

`connection` [client class object](/QuorumDMS/ftp-srv/blob/main/src/connection.js)

`username` string of username from `USER` command

`password` string of password from `PASS` command

`resolve` takes an object of arguments:

* `fs`
  + Set a custom file system class for this connection to use.
  + See [File System](#file-system) for implementation details.
* `root`
  + If `fs` is not provided, this will set the root directory for the connection.
  + The user cannot traverse lower than this directory.
* `cwd`
  + If `fs` is not provided, will set the starting directory for the connection
  + This is relative to the `root` directory.
* `blacklist`
  + Commands that are forbidden for only this connection
* `whitelist`
  + If set, this connection will only be able to use the provided commands

`reject` takes an error object

### `server-error`

```
ftpServer.on('server-error', ({error}) => { ... });
```

Occurs when an error arises in the FTP server.

`error` error object

### `RETR`

```
connection.on('RETR', (error, filePath) => { ... });
```

Occurs when a file is downloaded.

`error` if successful, will be `null`

`filePath` location to which file was downloaded

### `STOR`

```
connection.on('STOR', (error, fileName) => { ... });
```

Occurs when a file is uploaded.

`error` if successful, will be `null`

`fileName` name of the file that was uploaded

### `RNTO`

```
connection.on('RNTO', (error, fileName) => { ... });
```

Occurs when a file is renamed.

`error` if successful, will be `null`

`fileName` name of the file that was renamed

## Supported Commands

See the [command registry](/QuorumDMS/ftp-srv/blob/main/src/commands/registration) for a list of all implemented FTP commands.

## File System

The default [file system](/QuorumDMS/ftp-srv/blob/main/src/fs.js) can be overwritten to use your own implementation.

This can allow for virtual file systems, and more.

Each connection can set it's own file system based on the user.

The default file system is exported and can be extended as needed:

```
const {FtpSrv, FileSystem} = require('ftp-srv');

class MyFileSystem extends FileSystem {
  constructor() {
    super(...arguments);
  }

  get(fileName) {
    ...
  }
}
```

Custom file systems can implement the following variables depending on the developers needs:

### Methods

#### [`currentDirectory()`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L40)

Returns a string of the current working directory

**Used in:** `PWD`

#### [`get(fileName)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L44)

Returns a file stat object of file or directory

**Used in:** `LIST`, `NLST`, `STAT`, `SIZE`, `RNFR`, `MDTM`

#### [`list(path)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L50)

Returns array of file and directory stat objects

**Used in:** `LIST`, `NLST`, `STAT`

#### [`chdir(path)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L67)

Returns new directory relative to current directory

**Used in:** `CWD`, `CDUP`

#### [`mkdir(path)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L114)

Returns a path to a newly created directory

**Used in:** `MKD`

#### [`write(fileName, {append, start})`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L79)

Returns a writable stream

Options:

`append` if true, append to existing file

`start` if set, specifies the byte offset to write to

**Used in:** `STOR`, `APPE`

#### [`read(fileName, {start})`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L90)

Returns a readable stream

Options:

`start` if set, specifies the byte offset to read from

**Used in:** `RETR`

#### [`delete(path)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L105)

Delete a file or directory

**Used in:** `DELE`

#### [`rename(from, to)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L120)

Renames a file or directory

**Used in:** `RNFR`, `RNTO`

#### [`chmod(path)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L126)

Modifies a file or directory's permissions

**Used in:** `SITE CHMOD`

#### [`getUniqueName(fileName)`](/QuorumDMS/ftp-srv/blob/main/src/fs.js#L131)

Returns a unique file name to write to. Client requested filename available if you want to base your function on it.
**Used in:** `STOU`

## Contributing

See [CONTRIBUTING.md](/QuorumDMS/ftp-srv/blob/main/CONTRIBUTING.md).

## License

This software is licensed under the MIT Licence. See [LICENSE](/QuorumDMS/ftp-srv/blob/main/LICENSE).

## References

* <https://cr.yp.to/ftp.html>

## About

📮 Modern FTP Server

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/QuorumDMS/ftp-srv/activity)
[Custom properties](/QuorumDMS/ftp-srv/custom-properties)
### Stars

[**390**
stars](/QuorumDMS/ftp-srv/stargazers)
### Watchers

[**16**
watching](/QuorumDMS/ftp-srv/watchers)
### Forks

[**117**
forks](/QuorumDMS/ftp-srv/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv&report=QuorumDMS+%28user%29)

## [Releases 69](/QuorumDMS/ftp-srv/releases)

[v4.6.3
Latest

Oct 9, 2023](/QuorumDMS/ftp-srv/releases/tag/v4.6.3)
[+ 68 releases](/QuorumDMS/ftp-srv/releases)

## [Packages 0](/orgs/QuorumDMS/packages?repo_name=ftp-srv)

No packages published

## [Contributors 39](/QuorumDMS/ftp-srv/graphs/contributors)

[+ 25 contributors](/QuorumDMS/ftp-srv/graphs/contributors)

## Languages

* [JavaScript
  99.1%](/QuorumDMS/ftp-srv/search?l=javascript)
* [HTML
  0.9%](/QuorumDMS/ftp-srv/search?l=html)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c97ec90a_20250119_125644.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fcommit%2Fe449e75219d918c400dec65b4b0759f60476abca)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fcommit%2Fe449e75219d918c400dec65b4b0759f60476abca)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=QuorumDMS%2Fftp-srv)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[QuorumDMS](/QuorumDMS)
/
**[ftp-srv](/QuorumDMS/ftp-srv)**
Public

* [Notifications](/login?return_to=%2FQuorumDMS%2Fftp-srv) You must be signed in to change notification settings
* [Fork
  117](/login?return_to=%2FQuorumDMS%2Fftp-srv)
* [Star
   390](/login?return_to=%2FQuorumDMS%2Fftp-srv)

* [Code](/QuorumDMS/ftp-srv)
* [Issues
  37](/QuorumDMS/ftp-srv/issues)
* [Pull requests
  16](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects
  0](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

Additional navigation options

* [Code](/QuorumDMS/ftp-srv)
* [Issues](/QuorumDMS/ftp-srv/issues)
* [Pull requests](/QuorumDMS/ftp-srv/pulls)
* [Discussions](/QuorumDMS/ftp-srv/discussions)
* [Actions](/QuorumDMS/ftp-srv/actions)
* [Projects](/QuorumDMS/ftp-srv/projects)
* [Security](/QuorumDMS/ftp-srv/security)
* [Insights](/QuorumDMS/ftp-srv/pulse)

## Commit

[Permalink](/QuorumDMS/ftp-srv/commit/e449e75219d918c400dec65b4b0759f60476abca)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: disallow PORT connections to alternate hosts

[Browse files](/QuorumDMS/ftp-srv/tree/e449e75219d918c400dec65b4b0759f60476abca)
Browse the repository at this point in the history

```
Ensure the data socket that the server connects to from the PORT command is the same IP as the current command socket.

* fix: add error handling to additional connection commands
```

* Loading branch information

Tyler Stewart
committed
Aug 17, 2020

1 parent
[296573a](/QuorumDMS/ftp-srv/commit/296573ae017d137a0b4268a96ea45b753bd66305)

commit e449e75

 Show file tree

 Hide file tree

Showing
**10 changed files**
with
**52 additions**
and
**19 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + commands/registration

    - src/commands/registration/eprt.js
      [eprt.js](#diff-2e1339167b450338020ac55eb5d94a5f047ea11b0385e05425d9d68227d0a87c)
    - src/commands/registration/epsv.js
      [epsv.js](#diff-349cb1f31d59918f158fae25bbe3e740fec2708457bd8b8017f680547d9ba3e7)
    - src/commands/registration/pasv.js
      [pasv.js](#diff-3608f227b06b6d0ec33df9aea36b1316c367b1d527021c4a0e7f8c79bef3db19)
    - src/commands/registration/port.js
      [port.js](#diff-e512c1ace9c277de45fa212e60682e19f90385ca084b357ef1b48c79c3541b07)
  + connector

    - src/connector/active.js
      [active.js](#diff-c325f0588f2b7127eff074f656eabd8313819955772b5958a1b188e4e39a481a)
    - src/connector/base.js
      [base.js](#diff-8440719fe70d6fcb057adea415e31edd987ebb4d70f05758e5f489808a354a4f)
* test

  + commands/registration

    - test/commands/registration/eprt.spec.js
      [eprt.spec.js](#diff-95f4c8071eac7a80f2850c2234e861e351912af915ceee46fd25099f31617c9d)
    - test/commands/registration/epsv.spec.js
      [epsv.spec.js](#diff-ad19077298b221a54cf0ffea542e6448fbf0bc0e0a011deb5df9671dbb62e75f)
    - test/commands/registration/opts.spec.js
      [opts.spec.js](#diff-5f2885d471403dbadd4cb15d3253211e724c9f5b4b4fbf00b857d8ff29e4c537)
  + connector

    - test/connector/active.spec.js
      [active.spec.js](#diff-667d3b7fe158c80770db92f3b259f0da9c9f9573eaf50f601400f7de9b325e28)

## There are no files selected for viewing

8 changes: 6 additions & 2 deletions

8
[src/commands/registration/eprt.js](#diff-2e1339167b450338020ac55eb5d94a5f047ea11b0385e05425d9d68227d0a87c "src/commands/registration/eprt.js")

Show comments

[View file](/QuorumDMS/ftp-srv/blob/e449e75219d918c400dec65b4b0759f60476abca/src/commands/registration/eprt.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,14 +8,18 @@ const FAMILY = { |
|  |  |  |
|  |  | module.exports = { |
|  |  | directive: 'EPRT', |
|  |  | handler: function ({command} = {}) { |
|  |  | handler: function ({log, command} = {}) { |
|  |  | const [, protocol, ip, port] = \_.chain(command).get('arg', '').split('|').value(); |
|  |  | const family = FAMILY[protocol]; |
|  |  | if (!family) return this.reply(504, 'Unknown network protocol'); |
|  |  |  |
|  |  | this.connector = new ActiveConnector(this); |
|  |  | return this.connector.setupConnection(ip, port, family) |
|  |  | .then(() => this.reply(200)); |
|  |  | .then(() => this.reply(200)) |
|  |  | .catch((err) => { |
|  |  | log.error(err); |
|  |  | return this.reply(err.code || 425, err.message); |
|  |  | }); |
|  |  | }, |
|  |  | syntax: '{{cmd}} |<protocol>|<address>|<port>|', |
|  |  | description: 'Specifies an address and port to which the server should connect' |
| Expand Down | |  |

6 changes: 5 additions & 1 deletion

6
[src/commands/registration/epsv.js](#diff-349cb1f31d59918f158fae25bbe3e740fec2708457bd8b8017f680547d9ba3e7 "src/commands/registration/epsv.js")

Show comments

[View file](/QuorumDMS/ftp-srv/blob/e449e75219d918c400dec65b4b0759f60476abca/src/commands/registration/epsv.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,13 +2,17 @@ const PassiveConnector = require('../../connector/passive'); |
|  |  |  |
|  |  | module.exports = { |
|  |  | directive: 'EPSV', |
|  |  | handler: function () { |
|  |  | handler: function ({log}) { |
|  |  | this.connector = new PassiveConnector(this); |
|  |  | return this.connector.setupServer() |
|  |  | .then((server) => { |
|  |  | const {port} = server.address(); |
|  |  |  |
|  |  | return this.reply(229, `EPSV OK (|||${port}|)`); |
|  |  | }) |
|  |  | .catch((err) => { |
|  |  | log.error(err); |
|  |  | return this.reply(err.code || 425, err.message); |
|  |  | }); |
|  |  | }, |
|  |  | syntax: '{{cmd}} [<protocol>]', |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/commands/registration/pasv.js](#diff-3608f227b06b6d0ec33df9aea36b1316c367b1d527021c4a0e7f8c79bef3db19 "src/commands/registration/pasv.js")

Show comments

[View file](/QuorumDMS/ftp-srv/blob/e449e75219d918c400dec65b4b0759f60476abca/src/commands/registration/pasv.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,7 +25,7 @@ module.exports = { |
|  |  | }) |
|  |  | .catch((err) => { |
|  |  | log.error(err); |
|  |  | return this.reply(425); |
|  |  | return this.reply(err.code || 425, err.message); |
|  |  | }); |
|  |  | }, |
|  |  | syntax: '{{cmd}}', |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/commands/registration/port.js](#diff-e512c1ace9c277de45fa212e60682e19f90385ca084b357ef1b48c79c3541b07 "src/commands/registration/port.js")

Show comments

[View file](/QuorumDMS/ftp-srv/blob/e449e75219d918c400dec65b4b0759f60476abca/src/commands/registration/port.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,7 +17,7 @@ module.exports = { |
|  |  | .then(() => this.reply(200)) |
|  |  | .catch((err) => { |
|  |  | log.error(err); |
|  |  | return this.reply(425); |
|  |  | return this.reply(err.code || 425, err.message); |
|  |  | }); |
|  |  | }, |
|  |  | syntax: '{{cmd}} <x>,<x>,<x>,<x>,<y>,<y>', |
| Expand Down | |  |

6 changes: 6 additions & 0 deletions

6
[src/connector/active.js](#diff-c325f0588f2b7127eff074f656eabd8313819955772b5958a1b188e4e39a481a "src/connector/active.js")

Show comments

[View file](/QuorumDMS/ftp-srv/blob/e449e75219d918c400dec65b4b0759f60476abca/src/connector/active.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,7 +1,9 @@ |
|  |  | const {Socket} = require('net'); |
|  |  | const tls = require('tls'); |
|  |  | const ip = require('ip'); |
|  |  | const Promise = require('bluebird'); |
|  |  | const Connector = require('./base'); |
|  |  | const {SocketError} = require('../errors'); |
|  |  |  |
|  |  | class Active extends Connector { |
|  |  | constructor(connection) { |
| Expand All | | @@ -27,6 +29,10 @@ class Active extends Connector { |
|  |  |  |
|  |  | return closeExistingServer() |
|  |  | .then(() => { |
|  |  | if (!ip.isEqual(this.connection.commandSocket.remoteAddress, host)) { |
|  |  | throw new SocketError('The given address is not yours', 500); |
|  |  | } |
|  |  |  |
|  |  | this.dataSocket = new Socket(); |
|  |  | this.dataSocket.on('error', (err) => this.server && this.server.emit('client-error', {connection: this.connection, context: 'dataSocket', error: err})); |
|  |  | this.dataSocket.connect({host, port, family}, () => { |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/connector/base.js](#diff-8440719fe70d6fcb057adea415e31edd987ebb4d70f05758e5f489808a354a4f "src/connector/base.js")

Show comments

[View file](/QuorumDMS/ftp-srv/blob/e449e75219d918c400dec65b4b0759f60476abca/src/connector/base.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -29,7 +29,7 @@ class Connector { |
|  |  | closeSocket() { |
|  |  | if (this.dataSocket) { |
|  |  | const socket = this.dataSocket; |
|  |  | this.dataSocket.end(() => socket.destroy()); |
|  |  | this.dataSocket.end(() => socket && socket.destroy()); |
| This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fcommit%2Fe449e75219d918c400dec65b4b0759f60476abca)       Sorry, something went wrong.           Copy link    Quote reply     @Jl14Salvador **[Jl14Salvador](/Jl14Salvador)** [Aug 17, 2020](#r41534801)  do we care about this return value? This returns a [net.socket](https://nodejs.org/api/net.html#net_socket_destroy_error) object. But this change will now just return back a `boolean`. Something like this retains the current behaviour.  ``` ... this.dataSocket.end(() => socket ? socket.destroy() : null );  //return null  and do nothing or throw error?  ```      All reactions          This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fcommit%2Fe449e75219d918c400dec65b4b0759f60476abca)       Sorry, something went wrong.           Copy link    Quote reply     @trs **[trs](/trs)** [Aug 17, 2020](#r41534854) Contributor   Nope, return type doesn't matter for this callback.      All reactions          This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fcommit%2Fe449e75219d918c400dec65b4b0759f60476abca)       Sorry, something went wrong.           Copy link    Quote reply     @matt-forster **[matt-forster](/matt-forster)** [Aug 17, 2020](#r41534970) Contributor   The return value gets dropped, because its a callback that gets hooked into the finish event;  If provided, the optional callback function is attached as a listener for the 'finish' and the 'error' event.  <https://nodejs.org/api/stream.html#stream_writable_end_chunk_encoding_callback>      All reactions          This comment has been minimized. [Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fcommit%2Fe449e75219d918c400dec65b4b0759f60476abca)       Sorry, something went wrong.           Copy link    Quote reply     @Jl14Salvador **[Jl14Salvador](/Jl14Salvador)** [Aug 17, 2020](#r41535070)  👍      All reactions | | |
|  |  | this.dataSocket = null; |
|  |  | } |
|  |  | } |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[test/commands/registration/eprt.spec.js](#diff-95f4c8071eac7a80f2850c2234e861e351912af915ceee46fd25099f31617c9d "test/commands/registration/eprt.spec.js")

Show comments

[View file](/QuorumDMS/ftp-srv/blob/e449e75219d918c400dec65b4b0759f60476abca/test/commands/registration/eprt.spec.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,7 +23,7 @@ describe(CMD, function () { |
|  |  | }); |
|  |  |  |
|  |  | it('// unsuccessful | no argument', () => { |
|  |  | return cmdFn() |
|  |  | return cmdFn({}) |
|  |  | .then(() => { |
|  |  | expect(mockClient.reply.args[0][0]).to.equal(504); |
|  |  | }); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[test/commands/registration/epsv.spec.js](#diff-ad19077298b221a54cf0ffea542e6448fbf0bc0e0a011deb5df9671dbb62e75f "test/commands/registration/epsv.spec.js")

Show comments

[View file](/QuorumDMS/ftp-srv/blob/e449e75219d918c400dec65b4b0759f60476abca/test/commands/registration/epsv.spec.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,7 +25,7 @@ describe(CMD, function () { |
|  |  | }); |
|  |  |  |
|  |  | it('// successful IPv4', () => { |
|  |  | return cmdFn() |
|  |  | return cmdFn({}) |
|  |  | .then(() => { |
|  |  | const [code, message] = mockClient.reply.args[0]; |
|  |  | expect(code).to.equal(229); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[test/commands/registration/opts.spec.js](#diff-5f2885d471403dbadd4cb15d3253211e724c9f5b4b4fbf00b857d8ff29e4c537 "test/commands/registration/opts.spec.js")

Show comments

[View file](/QuorumDMS/ftp-srv/blob/e449e75219d918c400dec65b4b0759f60476abca/test/commands/registration/opts.spec.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -29,7 +29,7 @@ describe(CMD, function () { |
|  |  | it('BAD // unsuccessful', () => { |
|  |  | return cmdFn({command: {arg: 'BAD', directive: CMD}}) |
|  |  | .then(() => { |
|  |  | expect(mockClient.reply.args[0][0]).to.equal(500); |
|  |  | expect(mockClient.reply.args[0][0]).to.equal(501); |
|  |  | }); |
|  |  | }); |
|  |  |  |
| Expand Down | |  |

39 changes: 29 additions & 10 deletions

39
[test/connector/active.spec.js](#diff-667d3b7fe158c80770db92f3b259f0da9c9f9573eaf50f601400f7de9b325e28 "test/connector/active.spec.js")

Show comments

[View file](/QuorumDMS/ftp-srv/blob/e449e75219d918c400dec65b4b0759f60476abca/test/connector/active.spec.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,14 +13,16 @@ describe('Connector - Active //', function () { |
|  |  | let getNextPort = getNextPortFactory(host, 1024); |
|  |  | let PORT; |
|  |  | let active; |
|  |  | let mockConnection = {}; |
|  |  | let mockConnection = { |
|  |  | commandSocket: { |
|  |  | remoteAddress: '::ffff:127.0.0.1' |
|  |  | } |
|  |  | }; |
|  |  | let sandbox; |
|  |  | let server; |
|  |  |  |
|  |  | before(() => { |
|  |  | active = new ActiveConnector(mockConnection); |
|  |  | }); |
|  |  | beforeEach((done) => { |
|  |  | active = new ActiveConnector(mockConnection); |
|  |  | sandbox = sinon.sandbox.create().usingPromise(Promise); |
|  |  |  |
|  |  | getNextPort() |
| Expand All | | @@ -31,9 +33,12 @@ describe('Connector - Active //', function () { |
|  |  | .listen(PORT, () => done()); |
|  |  | }); |
|  |  | }); |
|  |  | afterEach((done) => { |
|  |  |  |
|  |  | afterEach(() => { |
|  |  | sandbox.restore(); |
|  |  | server.close(done); |
|  |  | server.close(); |
|  |  | active.end(); |
|  |  |  |
|  |  | }); |
|  |  |  |
|  |  | it('sets up a connection', function () { |
| Expand All | | @@ -43,13 +48,27 @@ describe('Connector - Active //', function () { |
|  |  | }); |
|  |  | }); |
|  |  |  |
|  |  | it('destroys existing connection, then sets up a connection', function () { |
|  |  | const destroyFnSpy = sandbox.spy(active.dataSocket, 'destroy'); |
|  |  | it('rejects alternative host', function () { |
|  |  | return active.setupConnection('123.45.67.89', PORT) |
|  |  | .catch((err) => { |
|  |  | expect(err.code).to.equal(500); |
|  |  | expect(err.message).to.equal('The given address is not yours'); |
|  |  | }) |
|  |  | .finally(() => { |
|  |  | expect(active.dataSocket).not.to.exist; |
|  |  | }); |
|  |  | }); |
|  |  |  |
|  |  | it('destroys existing connection, then sets up a connection', function () { |
|  |  | return active.setupConnection(host, PORT) |
|  |  | .then(() => { |
|  |  | expect(destroyFnSpy.callCount).to.equal(1); |
|  |  | expect(active.dataSocket).to.exist; |
|  |  | const destroyFnSpy = sandbox.spy(active.dataSocket, 'destroy'); |
|  |  |  |
|  |  | return active.setupConnection(host, PORT) |
|  |  | .then(() => { |
|  |  | expect(destroyFnSpy.callCount).to.equal(1); |
|  |  | expect(active.dataSocket).to.exist; |
|  |  | }); |
|  |  | }); |
|  |  | }); |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e449e75`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FQuorumDMS%2Fftp-srv%2Fcommit%2Fe449e75219d918c400dec65b4b0759f60476abca) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.npmjs.com_bb064ddd_20250119_125645.html ===

skip to:[content](#main)[package search](#search)[sign in](#signin)â¤

* [Pro](/products/pro)
* [Teams](/products/teams)
* [Pricing](/products)
* [Documentation](https://docs.npmjs.com)
npmSearch[Sign Up](/signup)[Sign In](/login)
## ftp-srvTypeScript icon, indicating that this package has built-in type declarations

4.6.3Â â¢Â PublicÂ â¢Â Published a year ago

* [Readme](?activeTab=readme)
* [Code Beta](?activeTab=code)
* [7 Dependencies](?activeTab=dependencies)
* [28 Dependents](?activeTab=dependents)
* [72 Versions](?activeTab=versions)

[![ftp-srv](https://raw.githubusercontent.com/autovance/ftp-srv/HEAD/logo.png)](https://github.com/autovance/ftp-srv)

Modern, extensible FTP Server

[![npm](https://camo.githubusercontent.com/1e27e7f3c91d0148c90d2a0d09a4fff447b50f91accf551c712292acb9430f8e/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f646d2f6674702d7372762e7376673f7374796c653d666f722d7468652d6261646765)](https://www.npmjs.com/package/ftp-srv)
[![circleci](https://camo.githubusercontent.com/ee7b85ac8d4e10f4b164a5e013f4ed74647e72ec9cce2d8ecc83a8cff4ba9222/68747470733a2f2f696d672e736869656c64732e696f2f636972636c6563692f70726f6a6563742f6769746875622f6175746f76616e63652f6674702d7372762f6d61737465722e7376673f7374796c653d666f722d7468652d6261646765)](https://circleci.com/gh/autovance/workflows/ftp-srv/tree/master)

---

## [Overview](#overview)

`ftp-srv` is a modern and extensible FTP server designed to be simple yet configurable.

## [Features](#features)

* Extensible [file systems](#file-system) per connection
* Passive and active transfers
* [Explicit](https://en.wikipedia.org/wiki/FTPS#Explicit) & [Implicit](https://en.wikipedia.org/wiki/FTPS#Implicit) TLS connections
* Promise based API

## [Install](#install)

`npm install ftp-srv --save`

## [Usage](#usage)

```
// Quick start, create an active ftp server.
const FtpSrv = require('ftp-srv');

const port=21;
const ftpServer = new FtpSrv({
    url: "ftp://0.0.0.0:" + port,
    anonymous: true
});

ftpServer.on('login', ({ connection, username, password }, resolve, reject) => {
    if(username === 'anonymous' && password === 'anonymous'){
        return resolve({ root:"/" });
    }
    return reject(new errors.GeneralError('Invalid username or password', 401));
});

ftpServer.listen().then(() => {
    console.log('Ftp server is starting...')
});
```
## [API](#api)

### [`new FtpSrv({options})`](#new-ftpsrvoptions)

#### [url](#url)

[URL string](https://nodejs.org/api/url.html#url_url_strings_and_url_objects) indicating the protocol, hostname, and port to listen on for connections.
Supported protocols:

* `ftp` Plain FTP
* `ftps` Implicit FTP over TLS

*Note:* The hostname must be the external IP address to accept external connections. `0.0.0.0` will listen on any available hosts for server and passive connections.

**Default:** `"ftp://127.0.0.1:21"`

#### [`pasv_url`](#pasv_url)

`FTP-srv` provides an IP address to the client when a `PASV` command is received in the handshake for a passive connection. Reference [PASV verb](https://cr.yp.to/ftp/retr.html#pasv). This can be one of two options:

* A function which takes one parameter containing the remote IP address of the FTP client. This can be useful when the user wants to return a different IP address depending if the user is connecting from Internet or from an LAN address.
  Example:

```
const { networkInterfaces } = require('os');
const { Netmask } = require('netmask');

const nets = networkInterfaces();
function getNetworks() {
   let networks = {};
   for (const name of Object.keys(nets)) {
       for (const net of nets[name]) {
           if (net.family === 'IPv4' && !net.internal) {
               networks[net.address + "/24"] = net.address
           }
       }
   }
   return networks;
}

const resolverFunction = (address) => {
   // const networks = {
   //     '$GATEWAY_IP/32': `${public_ip}`,
   //     '10.0.0.0/8'    : `${lan_ip}`
   // }
   const networks = getNetworks();
   for (const network in networks) {
       if (new Netmask(network).contains(address)) {
           return networks[network];
       }
   }
   return "127.0.0.1";
}

new FtpSrv({pasv_url: resolverFunction});
```

* A static IP address (ie. an external WAN **IP address** that the FTP server is bound to). In this case, only connections from localhost are handled differently returning `127.0.0.1` to the client.

If not provided, clients can only connect using an `Active` connection.

#### [`pasv_min`](#pasv_min)

The starting port to accept passive connections.

**Default:** `1024`

#### [`pasv_max`](#pasv_max)

The ending port to accept passive connections.

The range is then queried for an available port to use when required.

**Default:** `65535`

#### [`greeting`](#greeting)

A human readable array of lines or string to send when a client connects.

**Default:** `null`

#### [`tls`](#tls)

Node [TLS secure context object](https://nodejs.org/api/tls.html#tls_tls_createsecurecontext_options) used for implicit (`ftps` protocol) or explicit (`AUTH TLS`) connections.

**Default:** `false`

#### [`anonymous`](#anonymous)

If true, will allow clients to authenticate using the username `anonymous`, not requiring a password from the user.

Can also set as a string which allows users to authenticate using the username provided.

The `login` event is then sent with the provided username and `@anonymous` as the password.

**Default:** `false`

#### [`blacklist`](#blacklist)

Array of commands that are not allowed.

Response code `502` is sent to clients sending one of these commands.

**Example:** `['RMD', 'RNFR', 'RNTO']` will not allow users to delete directories or rename any files.

**Default:** `[]`

#### [`whitelist`](#whitelist)

Array of commands that are only allowed.

Response code `502` is sent to clients sending any other command.

**Default:** `[]`

#### [`file_format`](#file_format)

Sets the format to use for file stat queries such as `LIST`.

**Default:** `"ls"`

**Allowable values:**

* `ls` [bin/ls format](https://cr.yp.to/ftp/list/binls.html)
* `ep` [Easily Parsed LIST format](https://cr.yp.to/ftp/list/eplf.html)
* `function () {}` A custom function returning a format or promise for one.
  + Only one argument is passed in: a node [file stat](https://nodejs.org/api/fs.html#fs_class_fs_stats) object with additional file `name` parameter

#### [`log`](#log)

A [bunyan logger](https://github.com/trentm/node-bunyan) instance. Created by default.

#### [`timeout`](#timeout)

Sets the timeout (in ms) after that an idle connection is closed by the server

**Default:** `0`

## [CLI](#cli)

`ftp-srv` also comes with a builtin CLI.

```
$ ftp-srv [url] [options]
```

```
$ ftp-srv ftp://0.0.0.0:9876 --root ~/Documents
```
#### [`url`](#url-1)

Set the listening URL.

Defaults to `ftp://127.0.0.1:21`

#### [`--pasv_url`](#--pasv_url)

The hostname to provide a client when attempting a passive connection (`PASV`).

If not provided, clients can only connect using an `Active` connection.

#### [`--pasv_min`](#--pasv_min)

The starting port to accept passive connections.

**Default:** `1024`

#### [`--pasv_max`](#--pasv_max)

The ending port to accept passive connections.

The range is then queried for an available port to use when required.

**Default:** `65535`

#### [`--root` / `-r`](#--root---r)

Set the default root directory for users.

Defaults to the current directory.

#### [`--credentials` / `-c`](#--credentials---c)

Set the path to a json credentials file.

Format:

```
[
  {
    "username": "...",
    "password": "...",
    "root": "..." // Root directory
  },
  ...
]
```
#### [`--username`](#--username)

Set the username for the only user. Do not provide an argument to allow anonymous login.

#### [`--password`](#--password)

Set the password for the given `username`.

#### [`--read-only`](#--read-only)

Disable write actions such as upload, delete, etc.

## [Events](#events)

The `FtpSrv` class extends the [node net.Server](https://nodejs.org/api/net.html#net_class_net_server). Some custom events can be resolved or rejected, such as `login`.

### [`client-error`](#client-error)

```
ftpServer.on('client-error', ({connection, context, error}) => { ... });
```

Occurs when an error arises in the client connection.

`connection` [client class object](https://github.com/autovance/ftp-srv/blob/HEAD/src/connection.js)

`context` string of where the error occurred

`error` error object

### [`disconnect`](#disconnect)

```
ftpServer.on('disconnect', ({connection, id, newConnectionCount}) => { ... });
```

Occurs when a client has disconnected.

`connection` [client class object](https://github.com/autovance/ftp-srv/blob/HEAD/src/connection.js)

`id` string of the disconnected connection id

`id` number of the new connection count (exclusive the disconnected client connection)

### [`closed`](#closed)

```
ftpServer.on('closed', ({}) => { ... });
```

Occurs when the FTP server has been closed.

### [`closing`](#closing)

```
ftpServer.on('closing', ({}) => { ... });
```

Occurs when the FTP server has started closing.

### [`login`](#login)

```
ftpServer.on('login', ({connection, username, password}, resolve, reject) => { ... });
```

Occurs when a client is attempting to login. Here you can resolve the login request by username and password.

`connection` [client class object](https://github.com/autovance/ftp-srv/blob/HEAD/src/connection.js)

`username` string of username from `USER` command

`password` string of password from `PASS` command

`resolve` takes an object of arguments:

* `fs`
  + Set a custom file system class for this connection to use.
  + See [File System](#file-system) for implementation details.
* `root`
  + If `fs` is not provided, this will set the root directory for the connection.
  + The user cannot traverse lower than this directory.
* `cwd`
  + If `fs` is not provided, will set the starting directory for the connection
  + This is relative to the `root` directory.
* `blacklist`
  + Commands that are forbidden for only this connection
* `whitelist`
  + If set, this connection will only be able to use the provided commands

`reject` takes an error object

### [`server-error`](#server-error)

```
ftpServer.on('server-error', ({error}) => { ... });
```

Occurs when an error arises in the FTP server.

`error` error object

### [`RETR`](#retr)

```
connection.on('RETR', (error, filePath) => { ... });
```

Occurs when a file is downloaded.

`error` if successful, will be `null`

`filePath` location to which file was downloaded

### [`STOR`](#stor)

```
connection.on('STOR', (error, fileName) => { ... });
```

Occurs when a file is uploaded.

`error` if successful, will be `null`

`fileName` name of the file that was uploaded

### [`RNTO`](#rnto)

```
connection.on('RNTO', (error, fileName) => { ... });
```

Occurs when a file is renamed.

`error` if successful, will be `null`

`fileName` name of the file that was renamed

## [Supported Commands](#supported-commands)

See the [command registry](https://github.com/autovance/ftp-srv/blob/HEAD/src/commands/registration) for a list of all implemented FTP commands.

## [File System](#file-system)

The default [file system](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js) can be overwritten to use your own implementation.

This can allow for virtual file systems, and more.

Each connection can set it's own file system based on the user.

The default file system is exported and can be extended as needed:

```
const {FtpSrv, FileSystem} = require('ftp-srv');

class MyFileSystem extends FileSystem {
  constructor() {
    super(...arguments);
  }

  get(fileName) {
    ...
  }
}
```

Custom file systems can implement the following variables depending on the developers needs:

### [Methods](#methods)

#### [`currentDirectory()`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L40)

Returns a string of the current working directory

**Used in:** `PWD`

#### [`get(fileName)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L44)

Returns a file stat object of file or directory

**Used in:** `LIST`, `NLST`, `STAT`, `SIZE`, `RNFR`, `MDTM`

#### [`list(path)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L50)

Returns array of file and directory stat objects

**Used in:** `LIST`, `NLST`, `STAT`

#### [`chdir(path)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L67)

Returns new directory relative to current directory

**Used in:** `CWD`, `CDUP`

#### [`mkdir(path)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L114)

Returns a path to a newly created directory

**Used in:** `MKD`

#### [`write(fileName, {append, start})`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L79)

Returns a writable stream

Options:

`append` if true, append to existing file

`start` if set, specifies the byte offset to write to

**Used in:** `STOR`, `APPE`

#### [`read(fileName, {start})`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L90)

Returns a readable stream

Options:

`start` if set, specifies the byte offset to read from

**Used in:** `RETR`

#### [`delete(path)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L105)

Delete a file or directory

**Used in:** `DELE`

#### [`rename(from, to)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L120)

Renames a file or directory

**Used in:** `RNFR`, `RNTO`

#### [`chmod(path)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L126)

Modifies a file or directory's permissions

**Used in:** `SITE CHMOD`

#### [`getUniqueName(fileName)`](https://github.com/autovance/ftp-srv/blob/HEAD/src/fs.js#L131)

Returns a unique file name to write to. Client requested filename available if you want to base your function on it.
**Used in:** `STOU`

## [Contributing](#contributing)

See [CONTRIBUTING.md](https://github.com/autovance/ftp-srv/blob/HEAD/CONTRIBUTING.md).

## [License](#license)

This software is licensed under the MIT Licence. See [LICENSE](https://github.com/autovance/ftp-srv/blob/HEAD/LICENSE).

## [References](#references)

* <https://cr.yp.to/ftp.html>
## Readme

### Keywords

* [ftp](/search?q=keywords:ftp)
* [ftp-server](/search?q=keywords:ftp-server)
* [ftp-srv](/search?q=keywords:ftp-srv)
* [ftp-svr](/search?q=keywords:ftp-svr)
* [ftpd](/search?q=keywords:ftpd)
* [ftpserver](/search?q=keywords:ftpserver)
* [server](/search?q=keywords:server)
## Package Sidebar

### Install

`npm i ftp-srv`

### Repository

[Gitgithub.com/autovance/ftp-srv](https://github.com/autovance/ftp-srv)

### Homepage

[github.com/autovance/ftp-srv#readme](https://github.com/autovance/ftp-srv#readme)

### DownloadsWeekly Downloads

6,497

### Version

4.6.3

### License

MIT

### Unpacked Size

84 kB

### Total Files

62

### Last publish

a year ago

### Collaborators

* [![trs](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci85MDg3NTY5ZWE1NGEyMzQ2MjE2ZDFjOTVhNGZhNTg4ZT9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.m-eKiehX8b7kWni0kfkZnW6GzNCCUwnQWfVBFCNOxto "trs")](/~trs)
* [![botovance](/npm-avatar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdmF0YXJVUkwiOiJodHRwczovL3MuZ3JhdmF0YXIuY29tL2F2YXRhci85Mjc1YTE5YThiZTFiODA5NGQ2MjdmZTIzZDVmYzEyND9zaXplPTEwMCZkZWZhdWx0PXJldHJvIn0.FqRQeW_jZbYZxmAaeGEgt0BziexXS03tXYEh0no5dKc "botovance")](/~botovance)
[**Try** on RunKit](https://runkit.com/npm/ftp-srv)[**Report** malware](/support?inquire=security&security-inquire=malware&package=ftp-srv&version=4.6.3)
## Footer

### Support

* [Help](https://docs.npmjs.com)
* [Advisories](https://github.com/advisories)
* [Status](http://status.npmjs.org/)
* [Contact npm](/support)
### Company

* [About](/about)
* [Blog](https://github.blog/tag/npm/)
* [Press](/press)
### Terms & Policies

* [Policies](/policies/)
* [Terms of Use](/policies/terms)
* [Code of Conduct](/policies/conduct)
* [Privacy](/policies/privacy)



=== Content from avatars.githubusercontent.com_fe5bc790_20250119_142432.html ===
���� �  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222��  ( (" ���          
   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz�������������������������������������������������������������������������       
  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? �f^qB�{U�"�W9⛋���O��,�%�N%@�=�7�u�+ǭ�?�-/W�Է�a��ecv$K��dװG)��� ���� @�fڑ�3"�6�^��x�٥`���Ǽg �.GЅ�8��]��� qf$�I�x�d�zdv�?J �k�=-���(u2HX0��w���V�!��o�i.WӁ^o��r��@`��,��==�vzo��=CT�K�P���p��v�@x�^��@���1V\Tx��T���c�t��eM�N9e�\_C��+�t���&�����}���/�l����������%�2?q� �o�@����wPFEKKV<!���7��D�����v��f�w\�։>�
 �?�~:�5���=Z��K^e��������ֽgi���>� �BO����W����
