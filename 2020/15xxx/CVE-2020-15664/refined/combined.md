=== Content from bugzilla.mozilla.org_01fd70df_20250119_135617.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1643199)
* [XML](/show_bug.cgi?ctype=xml&id=1643199)

Closed
[Bug 1643199](/show_bug.cgi?id=1643199)
(CVE-2020-15663)

Opened 5 years ago
Closed 5 years ago

# Mozilla Maintenance Service Privilege Escalation via updater.exe if Firefox is installed in non-default location

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Mozilla Maintenance Service Privilege Escalation via updater.exe if Firefox is installed in non-default location

## Categories

### (Toolkit :: Application Update, defect, P2)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Application%20Update#Application%20Update)

Application Update
▾

Toolkit :: Application Update
Application update for Firefox and Thunderbird.
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Application%20Update&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Application%20Update&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Application%20Update)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Windows

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla80

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| Install Update Workflow | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [80+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=80%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified) |
| firefox-esr78 | [80+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=80%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=verified) |
| firefox78 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=wontfix) |
| firefox79 | [+](/buglist.cgi?f1=cf_tracking_firefox79&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix) |
| firefox80 | [+](/buglist.cgi?f1=cf_tracking_firefox80&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr68 | 80+ | verified |
| firefox-esr78 | 80+ | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox78 |  | wontfix |
| firefox79 | + | wontfix |
| firefox80 | + | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: xiaoyin.l, Assigned: molly)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/59fd68692a3013b8c8fa55f0d27bb43c?d=mm&size=40)  [molly](/user_profile?user_id=550257)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d0cc82d247cc192c0071439458b0e7e8?d=mm&size=40)  [xiaoyin.l](/user_profile?user_id=549738)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/22a9d29be79d978dd156fae057543c68?d=mm&size=40)  [mpohle](/user_profile?user_id=711194)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

### (Regressed 1 open bug, [URL](https://blog.mozilla.org/attack-and-defense/2020/10/12/guest-blog-post-rollback-attack/ "https://blog.mozilla.org/attack-and-defense/2020/10/12/guest-blog-post-rollback-attack/") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1676840](/show_bug.cgi?id=1676840 "NEW - Can no longer bypass UAC prompt if Firefox is installed in non-default location"), [1653685](/show_bug.cgi?id=1653685 "RESOLVED FIXED - Windows is giving a permissions prompt for each upgrade.")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1588884](/show_bug.cgi?id=1588884 "RESOLVED DUPLICATE - Possibility of tricking the maintenance service into updating a non-secure location")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[blog.mozilla.org/attack-and-defense/2...](https://blog.mozilla.org/attack-and-defense/2020/10/12/guest-blog-post-rollback-attack/ "https://blog.mozilla.org/attack-and-defense/2020/10/12/guest-blog-post-rollback-attack/")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-priv-escalation, reporter-external, sec-high, Whiteboard: [sec-survey][post-critsmash-triage][adv-main80+][adv-esr68.12+][adv-esr78.2+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-15663

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[sec-survey][post-critsmash-triage][adv-main80+][adv-esr68.12+][adv-esr78.2+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a4732194_1689 "5 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files)

| [poc.zip](/attachment.cgi?id=9154016)  [5 years ago](#c0)  [Xiaoyin Liu](/user_profile?user_id=549738)   1.60 MB, application/x-zip-compressed |  | [Details](/attachment.cgi?id=9154016&action=edit) |
| --- | --- | --- |
| [Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized](/attachment.cgi?id=9162642)  [5 years ago](#c6)  [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr78+](#c30 "4 years ago")  dveditz : [sec-approval+](#c8 "5 years ago") | [Details](/attachment.cgi?id=9162642&action=edit) | [Review](/attachment.cgi?id=9162642) |
| [ESR68 Patch](/attachment.cgi?id=9163828)  [5 years ago](#c17)  [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)   18.38 KB, patch | RyanVM : [approval-mozilla-esr68+](#a5600394_75935 "4 years ago") | [Details](/attachment.cgi?id=9163828&action=edit) | [Diff](/attachment.cgi?id=9163828&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1643199&attachment=9163828) |
| [Bug 1643199 Followup - Properly account for registry data length. r=agashlin,bytesized](/attachment.cgi?id=9164131)  [5 years ago](#c21)  [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr68+](#a5600397_75935 "4 years ago")  RyanVM : [approval-mozilla-esr78+](#a5600397_75935 "4 years ago") | [Details](/attachment.cgi?id=9164131&action=edit) | [Review](/attachment.cgi?id=9164131) |
| [advisory.txt](/attachment.cgi?id=9170787)  [4 years ago](#c38)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   640 bytes, text/plain |  | [Details](/attachment.cgi?id=9170787&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Xiaoyin Liu](/user_profile?user_id=549738)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1643199#c0)• 5 years ago |
|  | |

Attached file
[poc.zip](attachment.cgi?id=9154016)
— [Details](attachment.cgi?id=9154016&action=edit)

This report is inspired by [CVE-2019-11753](https://www.cve.org/CVERecord?id=CVE-2019-11753) ([Bug 1574980](/show_bug.cgi?id=1574980 "VERIFIED FIXED - Privilege Escalation via Mozilla Maintenance Service if Firefox is Installed to a Writable Location")) and [CVE-2017-7766](https://www.cve.org/CVERecord?id=CVE-2017-7766) ([Bug 1342742](/show_bug.cgi?id=1342742 "RESOLVED FIXED - Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini")).

Summary: If a user has installed Firefox to a standard-user-writable location, then a local attacker who already has non-admin privilege can escalate his privilege to SYSTEM.

Detail: Since the Firefox installation path is user-writable, a local attacker can replace any files in the installation path. What we need to replace are `updater.exe` and `updater.ini`. Although the Maintenance Service checks if `updater.exe` contains an identity string and is signed by Mozilla, it doesn't check its file version. Thus, we can replace the currently installed `updater.exe` with an old and vulnerable version of `updater.exe`, and, from what I observed, the Maintenance Service copies the old `updater.exe` and `updater.ini` to `C:\Program Files (x86)\Mozilla Maintenance Service\update`, and then runs the old `updater.exe` with SYSTEM privilege.

The old `updater.exe` I choose to use is version 51.0.1, so that I can exploit [Bug 1342742](/show_bug.cgi?id=1342742 "RESOLVED FIXED - Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini") again. (Actually exploiting the first part of [Bug 1342742](/show_bug.cgi?id=1342742 "RESOLVED FIXED - Arbitrary code execution as SYSTEM using Updater to overwrite updater.ini") is all we need, because we can edit `updater.ini` directly.)

After `updater.exe` finishes applying `update.mar`, it runs the program specified in [PostUpdateWin] section in `updater.ini`. We specify a full path for `ExeRelPath`. It has to be Mozilla-signed, but since the attacker has total control of the directory, we can use DLL injection to run attacker's code. For example, we can place a malicious `version.dll` in the same directory as `ExeRelPath`. The code in `version.dll` will run with SYSTEM privilege.

Reproduce: (Test environment: OS: Windows 10 x64 Build 19041.264. Firefox version: 76.0.1)

1. Uninstall your current Firefox, and then install it to `C:\Common\Mozilla Firefox`
2. Log in a standard Windows user account
3. Create folder C:\test\poc
4. Unzip the attachment to C:\test\poc
5. Download <https://archive.mozilla.org/pub/firefox/releases/51.0.1/update/win32/en-US/firefox-51.0.1.complete.mar>, and save it to `C:\test\poc\123\updates\0\update.mar`
6. There are two files under `C:\test\poc\copy to Firefox install dir`: `updater.exe` and `updater.ini`. Copy them to your Firefox installation directory, overwriting the existing ones.
7. Open cmd.exe . Run `sc start MozillaMaintenance MozillaMaintenance software-update unused C:\test\poc\123\updates\0 "C:\Common\Mozilla Firefox" "C:\Common\Mozilla Firefox\updated" -1 . C:\test\poc\uninstall.update`
8. After a few seconds, you can see the poc creates a file "C:\DLLPlanting\dll\_output.txt", whose content is: `Filename=C:\test\poc\fakesetup.exe Integrity level=System`, which proves the PoC is run with SYSTEM privilege.

|  | [Xiaoyin Liu](/user_profile?user_id=549738)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1643199#c1)• 5 years ago |
|  | |

A simple fix would be to compare the version of updater.exe and maintenanceservice.exe before running it. `updater.exe` must be no older than `maintenanceservice.exe`.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a12771_578488)• 5 years ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a62016_1689)• 5 years ago |

Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Adam Gashlin (he/him) [:agashlin] (ex-moco)](/user_profile?user_id=583776) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1643199#c2)• 5 years ago |
|  | |

I believe this is the second scenario I described in [bug 1588884 comment 3](/show_bug.cgi?id=1588884#c3 "RESOLVED DUPLICATE - Possibility of tricking the maintenance service into updating a non-secure location"), a version check won't help with the first scenario there.

|  | [Rachel Tublitz [:rachel]](/user_profile?user_id=646733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a494063_646733)• 5 years ago |

Assignee: nobody → mhowellStatus: NEW → ASSIGNEDPriority: -- → P2

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1643199#c3)• 5 years ago |
|  | |

The severity field is not set for this bug.

:nalexander, could you have a look please?

For more information, please visit [auto\_nag documentation](https://wiki.mozilla.org/Release_Management/autonag#workflow.2Fno_severity.py).

Flags: needinfo?(nalexander)

|  | [Nick Alexander :nalexander [he/him]](/user_profile?user_id=432887) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1643199#c4)• 5 years ago |
|  | |

I think this feels like an S3: it's not critical but we should continue to lock down the Maintenance Service.

mhowell, this was assigned to you. Did you decide on an approach? Is it reasonable to follow rstrong's [suggested first mitigation](https://bugzilla.mozilla.org/show_bug.cgi?id=1588884#c4), namely to restrict the MS and/or updater to only updating files in ProgramFiles-like locations?

Flags: needinfo?(nalexander) → needinfo?(mhowell)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1643199#c5)• 5 years ago |
|  | |

I've been working on implementing that mitigation, and it does seem to work, but making the tests happy about that change has taken some effort, that's the reason for the delay. It is possible though, just working through some last details.

Flags: needinfo?(mhowell)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1643199#c6)• 5 years ago |
|  | |

Attached file
[Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized](attachment.cgi?id=9162642)
— [Details](attachment.cgi?id=9162642&action=edit)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1643199#c7)• 5 years ago |
|  | |

Comment on [attachment 9162642](/attachment.cgi?id=9162642 "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized") [[details]](/attachment.cgi?id=9162642&action=edit "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized")

[Bug 1643199](/show_bug.cgi?id=1643199 "VERIFIED FIXED - Mozilla Maintenance Service Privilege Escalation via updater.exe if Firefox is installed in non-default location") - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Certainly not directly, it's a pretty general mitigation against a whole class of Maintenance Service file privilege escalations (several of which have been patched before).
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: all
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: There is a small conflict with [bug 1588549](/show_bug.cgi?id=1588549 "RESOLVED FIXED - --disable-maintenance-service should exclude all maintenance service-related code") that prevents the merges from being trivial, but it isn't difficult to resolve.
* **How likely is this patch to cause regressions; how much testing does it need?**: It's certain to cause *some* regressions because we're intentionally removing support for running the Maintenance Service outside of Program Files, so installations in that kind of configuration will start seeing UAC prompts when they didn't before, but should still be able to update.

  As for more widespread regressions, we have good test coverage, and I've been running the patched service myself while developing the patch without seeing any issues, so I'm confident. We should still give this patch two or three days on Nightly to see if issues do crop up before executing any uplifts.
[Attachment #9162642](/attachment.cgi?id=9162642&action=edit "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized") -
Flags: sec-approval?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1643199#c8)• 5 years ago |
|  | |

Comment on [attachment 9162642](/attachment.cgi?id=9162642 "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized") [[details]](/attachment.cgi?id=9162642&action=edit "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized")

[Bug 1643199](/show_bug.cgi?id=1643199 "VERIFIED FIXED - Mozilla Maintenance Service Privilege Escalation via updater.exe if Firefox is installed in non-default location") - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized

sec-approval+

[Attachment #9162642](/attachment.cgi?id=9162642&action=edit "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a3463217_1689)• 5 years ago |

[status-firefox78](/buglist.cgi?f1=cf_status_firefox78&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=wontfix)
[status-firefox79](/buglist.cgi?f1=cf_status_firefox79&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=affected)
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)
[tracking-firefox79](/buglist.cgi?f1=cf_tracking_firefox79&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox79&o1=equals&v1=%2B)
[tracking-firefox80](/buglist.cgi?f1=cf_tracking_firefox80&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox80&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [79+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=79%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [79+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=79%2B)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1643199#c9)• 5 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/6a541f963216b68b88f16164bf11f93fdc7c9bd7>

<https://hg.mozilla.org/mozilla-central/rev/6a541f963216>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 5 years ago
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla80

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1643199#c10)• 5 years ago |
|  | |

Please nominate this for uplift to Beta/ESR78 when you get a chance. It grafts cleanly to both. It's going to need a rebased patch for ESR68 and approval request when ready as well.

Flags: needinfo?(mhowell)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1643199#c11)• 5 years ago |
|  | |

As I said in the sec-approval form, I want this to sit on Nightly for a few days to make sure that it at least doesn't cause anyone there any problems before it starts getting uplifts. So unless you disagree with that, I'd rather wait a couple of days before filing any uplift requests.

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1643199#c12)• 5 years ago |
|  | |

The final scheduled Fx79 beta build is scheduled for tomorrow night PDT before RC week next week, so I guess that depends on how worried you are about that timeline.

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1643199#c13)• 5 years ago |
|  | |

I'll make the requests then (and then post the ESR68 patch), but I think this might be my first time using the "high" risk level in that form.

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1643199#c14)• 5 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1643199) to reply.

Flags: needinfo?(mhowell)Whiteboard: [sec-survey]

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1643199#c15)• 5 years ago |
|  | |

Comment on [attachment 9162642](/attachment.cgi?id=9162642 "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized") [[details]](/attachment.cgi?id=9162642&action=edit "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized")

[Bug 1643199](/show_bug.cgi?id=1643199 "VERIFIED FIXED - Mozilla Maintenance Service Privilege Escalation via updater.exe if Firefox is installed in non-default location") - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized

### Beta/Release Uplift Approval Request

* **User impact if declined**: sec-high local privilege escalation bug
* **Is this code covered by automated tests?**: Yes
* **Has the fix been verified in Nightly?**: No
* **Needs manual test from QE?**: No
* **If yes, steps to reproduce**:
* **List of other uplifts needed**: None
* **Risk to taking this patch**: Medium
* **Why is the change risky/not risky? (and alternatives if risky)**: We do have automated test coverage around the maintenance service to the extent possible, and I've verified that my local build of the patch did not interfere with Nightly updates on my machine, but "works on my machine" isn't a very high bar.

  Fortunately since this patch is really only to the maintenance service, the risk is that the service refuses to run, which isn't fatal to installing updates; the user would see a UAC prompt, which would be confusing and a bit scary, but the update should succeed if they accept the prompt. That's the reason the risk isn't "high".
* **String changes made/needed**:

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This is a sec-high bug
* **User impact if declined**:
* **Fix Landed on Version**: 80
* **Risk to taking this patch**: Medium
* **Why is the change risky/not risky? (and alternatives if risky)**: See above
* **String or UUID changes made by this patch**:
Flags: needinfo?(mhowell)
[Attachment #9162642](/attachment.cgi?id=9162642&action=edit "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized") -
Flags: approval-mozilla-esr78?
[Attachment #9162642](/attachment.cgi?id=9162642&action=edit "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized") -
Flags: approval-mozilla-beta?

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1643199#c16)• 5 years ago |
|  | |

(In reply to Release mgmt bot [:sylvestre / :calixte / :marco for bugbug] from [comment #14](/show_bug.cgi?id=1643199#c14 "VERIFIED FIXED - Mozilla Maintenance Service Privilege Escalation via updater.exe if Firefox is installed in non-default location"))

> As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.
>
> Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1643199) to reply.

I've filled out the linked form. It doesn't say whether the whiteboard tag should be left or cleared, so to be safe I'm leaving it.

Flags: needinfo?(mhowell)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1643199#c17)• 5 years ago |
|  | |

Attached patch

[ESR68 Patch](attachment.cgi?id=9163828&action=diff)
— [Details](attachment.cgi?id=9163828&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1643199&attachment=9163828)

Same as the existing approved patch, rebased to esr68 and with the one merge conflict in `updater.cpp` resolved.

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1643199#c18)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1643199&comment_id=14938965 "1 revision") |
|  | |

Comment on [attachment 9163828](/attachment.cgi?id=9163828 "ESR68 Patch") [[details]](/attachment.cgi?id=9163828&action=edit "ESR68 Patch") [[diff]](/attachment.cgi?id=9163828&action=diff "ESR68 Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1643199&attachment=9163828)

ESR68 Patch

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: See the beta and ESR78 requests in [comment 15](/show_bug.cgi?id=1643199#c15 "VERIFIED FIXED - Mozilla Maintenance Service Privilege Escalation via updater.exe if Firefox is installed in non-default location"); this patch is identical except for a rebase and a small manual merge, so all responses there apply the same to this patch.
* **User impact if declined**:
* **Fix Landed on Version**:
* **Risk to taking this patch**: Medium
* **Why is the change risky/not risky? (and alternatives if risky)**:
* **String or UUID changes made by this patch**:
[Attachment #9163828](/attachment.cgi?id=9163828&action=edit "ESR68 Patch") -
Flags: approval-mozilla-esr68?

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1643199#c19)• 5 years ago |
|  | |

This patch is broken, my Windows installations are all getting UAC prompts today. I'm investigating but in the meantime I'm cancelling the uplift requests.

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a3685823_550257)• 5 years ago |

[Attachment #9162642](/attachment.cgi?id=9162642&action=edit "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized") -
Flags: approval-mozilla-esr78?
[Attachment #9162642](/attachment.cgi?id=9162642&action=edit "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized") -
Flags: approval-mozilla-beta?

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a3685828_550257)• 5 years ago |

[Attachment #9163828](/attachment.cgi?id=9163828&action=edit "ESR68 Patch") -
Flags: approval-mozilla-esr68?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1643199#c20)• 5 years ago |
|  | |

Given where we are in this cycle, I think we should just aim to have this fix ride with Fx80/78.2esr/68.12esr at this point. This is sounding really risky to take so close to RC week.

Status: RESOLVED → REOPENED
[status-firefox79](/buglist.cgi?f1=cf_status_firefox79&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix)
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
[79+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=79%2B) → [80+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=80%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
[79+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=79%2B) → [80+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=80%2B)Resolution: FIXED → ---Target Milestone: mozilla80 → ---

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1643199#c21)• 5 years ago |
|  | |

Attached file
[Bug 1643199 Followup - Properly account for registry data length. r=agashlin,bytesized](attachment.cgi?id=9164131)
— [Details](attachment.cgi?id=9164131&action=edit)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1643199#c22)• 5 years ago |
|  | |

I'm almost done editing the followup patch. It doesn't contain any changes to the security-relevant content, so in the interest of getting this fixed quickly, I intend to push it once it has r+ without waiting for sec approval.

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1643199#c23)• 5 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/be2431f1b1b925badbde8bcd5c6a38b902a2bae9>

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a3792642_550257)• 5 years ago |

Regressions: [1653685](/show_bug.cgi?id=1653685 "RESOLVED FIXED - Windows is giving a permissions prompt for each upgrade.")

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1643199#c24)• 5 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/be2431f1b1b9>

Status: REOPENED → RESOLVEDClosed: 5 years ago → 5 years ago
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla80

|  | [Adam Gashlin (he/him) [:agashlin] (ex-moco)](/user_profile?user_id=583776) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1643199#c25)• 5 years ago |
|  | |

I ran across an issue at the intersection of twice-daily Nightly and our limited staging fallback logic, which caused the manual install prompt to show up today when updating a system that had previously been updated from 2020-07-17-09-39-07 to 2020-07-17-21-28-41.

Before the fix on Friday we would show the UAC prompt on startup, because the updater would refuse to use the maintenance service for staging due to the failed `IsProgramFilesPath()` check; that check is duplicated, along with several others, in both the [updater](https://searchfox.org/mozilla-central/rev/9b282b34b5aa0f836beb735656c55efb2cc4c617/toolkit/mozapps/update/updater/updater.cpp#3188) and the [service](https://searchfox.org/mozilla-central/rev/9b282b34b5aa0f836beb735656c55efb2cc4c617/toolkit/components/maintenanceservice/workmonitor.cpp#640). If the updater expects the service will reject the command line, it sets the status to [UNEXPECTED\_STAGING\_ERROR](https://searchfox.org/mozilla-central/rev/9b282b34b5aa0f836beb735656c55efb2cc4c617/toolkit/mozapps/update/updater/updater.cpp#3315) and Firefox [falls back](https://searchfox.org/mozilla-central/rev/9b282b34b5aa0f836beb735656c55efb2cc4c617/toolkit/mozapps/update/UpdateService.jsm#3696) to trying a non-staged, non-service update on the next startup.

Because of [bug 1654072](/show_bug.cgi?id=1654072 "NEW - Maintenance service does not update multiple times per day"), the maintenance service wasn't updated from 2020-07-17-09-39-07 to 2020-07-17-21-28-41, though the updater was. This meant that the updater thought that the `IsProgramFilesPath()` check would pass, so it tried to run the maintenance service, which still had the bug so it failed. The fallback is not done in this case, so the whole update process failed, causing the manual download prompt. I proposed to fix this part in [bug 1654079](/show_bug.cgi?id=1654079 "NEW - Fall back from more cases of maintenance service staging failure").

I don't think this should require any more action here, it isn't going to be an issue at a slower build cadence, but it would be good to fix the linked bugs for more robust fallback and to prevent issues with updating the service in Nightly.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a4732194_1689)• 4 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a4861709_553429)• 4 years ago |

Flags: qe-verify+Whiteboard: [sec-survey] → [sec-survey][post-critsmash-triage]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1643199#c26)• 4 years ago |
|  | |

Is this ready for ESR uplift requests?

Flags: needinfo?(mhowell)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1643199#c27)• 4 years ago |
|  | |

I believe so, I've seen no more reports of issues. I'll enter the request.

Flags: needinfo?(mhowell)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1643199#c28)• 4 years ago |
|  | |

Comment on [attachment 9162642](/attachment.cgi?id=9162642 "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized") [[details]](/attachment.cgi?id=9162642&action=edit "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized")

[Bug 1643199](/show_bug.cgi?id=1643199 "VERIFIED FIXED - Mozilla Maintenance Service Privilege Escalation via updater.exe if Firefox is installed in non-default location") - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This is a sec-high bug.
* **User impact if declined**: Exposure to local privilege escalation under certain (likely uncommon) install configurations.
* **Fix Landed on Version**: 80
* **Risk to taking this patch**: Medium
* **Why is the change risky/not risky? (and alternatives if risky)**: This change originally caused one major issue, which the followup patch addresses. Since then no more reports of other issues have been received, from nightly or beta.
* **String or UUID changes made by this patch**:
[Attachment #9162642](/attachment.cgi?id=9162642&action=edit "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized") -
Flags: approval-mozilla-esr78?

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a5590425_550257)• 4 years ago |

[Attachment #9164131](/attachment.cgi?id=9164131&action=edit "Bug 1643199 Followup - Properly account for registry data length. r=agashlin,bytesized") -
Flags: approval-mozilla-esr78?

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1643199#c29)• 4 years ago |
|  | |

Comment on [attachment 9163828](/attachment.cgi?id=9163828 "ESR68 Patch") [[details]](/attachment.cgi?id=9163828&action=edit "ESR68 Patch") [[diff]](/attachment.cgi?id=9163828&action=diff "ESR68 Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1643199&attachment=9163828)

ESR68 Patch

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: See the ESR 78 request in [comment 28](/show_bug.cgi?id=1643199#c28 "VERIFIED FIXED - Mozilla Maintenance Service Privilege Escalation via updater.exe if Firefox is installed in non-default location").
* **User impact if declined**:
* **Fix Landed on Version**:
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**:
* **String or UUID changes made by this patch**:
[Attachment #9163828](/attachment.cgi?id=9163828&action=edit "ESR68 Patch") -
Flags: approval-mozilla-esr68?

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a5590497_550257)• 4 years ago |

[Attachment #9164131](/attachment.cgi?id=9164131&action=edit "Bug 1643199 Followup - Properly account for registry data length. r=agashlin,bytesized") -
Flags: approval-mozilla-esr68?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1643199#c30)• 4 years ago |
|  | |

Comment on [attachment 9162642](/attachment.cgi?id=9162642 "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized") [[details]](/attachment.cgi?id=9162642&action=edit "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized")

[Bug 1643199](/show_bug.cgi?id=1643199 "VERIFIED FIXED - Mozilla Maintenance Service Privilege Escalation via updater.exe if Firefox is installed in non-default location") - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized

Approved for 78.2esr and 68.12esr.

[Attachment #9162642](/attachment.cgi?id=9162642&action=edit "Bug 1643199 - Limit the install locations on which the maintenance service may be invoked. r=agashlin,bytesized") -
Flags: approval-mozilla-esr78? → approval-mozilla-esr78+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a5600394_75935)• 4 years ago |

[Attachment #9163828](/attachment.cgi?id=9163828&action=edit "ESR68 Patch") -
Flags: approval-mozilla-esr68? → approval-mozilla-esr68+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a5600397_75935)• 4 years ago |

[Attachment #9164131](/attachment.cgi?id=9164131&action=edit "Bug 1643199 Followup - Properly account for registry data length. r=agashlin,bytesized") -
Flags: approval-mozilla-esr78?
[Attachment #9164131](/attachment.cgi?id=9164131&action=edit "Bug 1643199 Followup - Properly account for registry data length. r=agashlin,bytesized") -
Flags: approval-mozilla-esr78+
[Attachment #9164131](/attachment.cgi?id=9164131&action=edit "Bug 1643199 Followup - Properly account for registry data length. r=agashlin,bytesized") -
Flags: approval-mozilla-esr68?
[Attachment #9164131](/attachment.cgi?id=9164131&action=edit "Bug 1643199 Followup - Properly account for registry data length. r=agashlin,bytesized") -
Flags: approval-mozilla-esr68+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1643199#c31)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr78/rev/0e88d553e30c>

<https://hg.mozilla.org/releases/mozilla-esr78/rev/c757b6525567>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/2e1e3cb4769c>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/26fd82275fa5>

[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a5809867_553429)• 4 years ago |

QA Whiteboard: [qa-triaged]

|  | [Rares Doghi, Desktop QA](/user_profile?user_id=615351) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1643199#c32)• 4 years ago |
|  | |

I tried to reproduce this issue on our end but I was unable to reproduce it using the reporters steps, Step 8 from the description does not occur.

Maybe someone can help us confirm that this issue is Verified as Fixed in our latest builds Nightly 81 as well as ESR 68 and 78 builds, and we can update the flags accordingly.

Flags: needinfo?(mhowell)Flags: needinfo?(agashlin)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1643199#c34)• 4 years ago |
|  | |

I did get the POC to work and create its file using an unpatched Nightly, build 20200601093812 [1]. After that, I rebooted, installed the current Nightly (20200812034418) instead, and reran the steps; this time the file was not created and the maintenance service log ended with the error message that the patch is expected to produce, which is "The install directory path is not valid for this application." Based on that, I believe the fix can be considered verified.

[1] It did take me a couple of attempts because I didn't initially notice that, since I used Nightly, the installation directory name was not the same as the one in the command in step 7. After correcting those paths, the POC ran as expected.

Flags: needinfo?(mhowell)Flags: needinfo?(agashlin)

|  | [Rares Doghi, Desktop QA](/user_profile?user_id=615351) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1643199#c35)• 4 years ago |
|  | |

Thank you for taking the time to Verify this fix in our latest Nightly build, can you please also verify this fix in our latest Beta and ESR builds and we will update the tracking flags accordingly.

Flags: needinfo?(mhowell)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1643199#c36)• 4 years ago |
|  | |

I've now verified the fix on beta using 80.0b7 against 79.0b9. ESR is harder because releases with the patch aren't made yet, so I had to test the unpatched 68.11.0 and 78.1.0 against CI builds for [68](https://treeherder.mozilla.org/#/jobs?repo=mozilla-esr68&revision=41e9950c1010f13601f22e7381f22e10dd608da3) and [78](https://treeherder.mozilla.org/#/jobs?repo=mozilla-esr78&revision=8ac708cf124839d3d4d4ff13f2a034b560fd73d6), but I did also verify the fix using those. Results were the same as in [comment 34](/show_bug.cgi?id=1643199#c34 "VERIFIED FIXED - Mozilla Maintenance Service Privilege Escalation via updater.exe if Firefox is installed in non-default location") in all cases.

Flags: needinfo?(mhowell) → needinfo?(rares.doghi)

|  | [Rares Doghi, Desktop QA](/user_profile?user_id=615351) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1643199#c37)• 4 years ago |
|  | |

Thank you for all the help, I will update the flags accordingly.

Status: RESOLVED → VERIFIEDQA Whiteboard: [qa-triaged]
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=verified)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=verified)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=verified)Flags: qe-verify+Flags: needinfo?(rares.doghi)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a6550630_578488)• 4 years ago |

Whiteboard: [sec-survey][post-critsmash-triage] → [sec-survey][post-critsmash-triage][adv-main80+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a6551066_578488)• 4 years ago |

Whiteboard: [sec-survey][post-critsmash-triage][adv-main80+] → [sec-survey][post-critsmash-triage][adv-main80+][adv-esr68.12+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a6551105_578488)• 4 years ago |

Whiteboard: [sec-survey][post-critsmash-triage][adv-main80+][adv-esr68.12+] → [sec-survey][post-critsmash-triage][adv-main80+][adv-esr68.12+][adv-esr78.2+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1643199#c38)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9170787)
— [Details](attachment.cgi?id=9170787&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a7057779_578488)• 4 years ago |

Alias: CVE-2020-15663

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a11289738_406194)• 4 years ago |

URL: [https://blog.mozilla.org/attack-and-d...](https://blog.mozilla.org/attack-and-defense/2020/10/12/guest-blog-post-rollback-attack/)

|  | [Masatoshi Kimura [:emk]](/user_profile?user_id=5842) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a13955586_5842)• 4 years ago |

Regressions: [1676840](/show_bug.cgi?id=1676840 "NEW - Can no longer bypass UAC prompt if Firefox is installed in non-default location")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a17112526_1689)• 4 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1643199#a125861013_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1643199&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Xiaoyin Liu](/user_profile?user_id=549738)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_3373b3b6_20250119_121619.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-41

## Security Vulnerabilities fixed in Thunderbird 78.2

Announced
August 25, 2020
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 78.2

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2020-15663: Downgrade attack on the Mozilla Maintenance Service could have resulted in escalation of privilege](#CVE-2020-15663)

Reporter
Xiaoyin Liu
Impact
high
##### Description

If Thunderbird is installed to a user-writable directory, the Mozilla Maintenance Service would execute updater.exe from the install location with system privileges. Although the Mozilla Maintenance Service does ensure that updater.exe is signed by Mozilla, the version could have been rolled back to a previous version which would have allowed exploitation of an older bug and arbitrary code execution with System Privileges.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1643199](https://bugzilla.mozilla.org/show_bug.cgi?id=1643199)

#### [#CVE-2020-15664: Attacker-induced prompt for extension installation](#CVE-2020-15664)

Reporter
Kaizer Soze
Impact
high
##### Description

By holding a reference to the `eval()` function from an about:blank window, a malicious webpage could have gained access to the InstallTrigger object which would allow them to prompt the user to install an extension. Combined with user confusion, this could result in an unintended or malicious extension being installed.

##### References

* [Bug 1658214](https://bugzilla.mozilla.org/show_bug.cgi?id=1658214)

#### [#CVE-2020-15670: Memory safety bugs fixed in Thunderbird 78.2](#CVE-2020-15670)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Jason Kratzer, Christian Holler, Byron Campen, Tyson Smith reported memory safety bugs present in Thunderbird 78.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 78.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1651001%2C1651449%2C1653626%2C1656957)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_16daccdb_20250119_121618.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-38

## Security Vulnerabilities fixed in Firefox ESR 78.2

Announced
August 25, 2020
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 78.2

#### [#CVE-2020-15663: Downgrade attack on the Mozilla Maintenance Service could have resulted in escalation of privilege](#CVE-2020-15663)

Reporter
Xiaoyin Liu
Impact
high
##### Description

If Firefox is installed to a user-writable directory, the Mozilla Maintenance Service would execute updater.exe from the install location with system privileges. Although the Mozilla Maintenance Service does ensure that updater.exe is signed by Mozilla, the version could have been rolled back to a previous version which would have allowed exploitation of an older bug and arbitrary code execution with System Privileges.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1643199](https://bugzilla.mozilla.org/show_bug.cgi?id=1643199)

#### [#CVE-2020-15664: Attacker-induced prompt for extension installation](#CVE-2020-15664)

Reporter
Kaizer Soze
Impact
high
##### Description

By holding a reference to the `eval()` function from an about:blank window, a malicious webpage could have gained access to the InstallTrigger object which would allow them to prompt the user to install an extension. Combined with user confusion, this could result in an unintended or malicious extension being installed.

##### References

* [Bug 1658214](https://bugzilla.mozilla.org/show_bug.cgi?id=1658214)

#### [#CVE-2020-15670: Memory safety bugs fixed in Firefox 80 and Firefox ESR 78.2](#CVE-2020-15670)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Jason Kratzer, Christian Holler, and Byron Campen reported memory safety bugs present in Firefox 79 and Firefox ESR 78.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 80 and Firefox ESR 78.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1651001%2C1653626%2C1656957)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_5a19a554_20250119_135611.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_0373e2f6_20250119_121617.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1658214)
* [XML](/show_bug.cgi?ctype=xml&id=1658214)

Closed
[Bug 1658214](/show_bug.cgi?id=1658214)
(CVE-2020-15664)

Opened 4 years ago
Closed 4 years ago

# InstallTrigger can take the principal from the wrong inner window when initialized

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

InstallTrigger can take the principal from the wrong inner window when initialized

## Categories

### (Toolkit :: Add-ons Manager, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Add-ons%20Manager#Add-ons%20Manager)

Add-ons Manager
▾

Toolkit :: Add-ons Manager
The management and update windows for extensions and themes (add-ons).
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Add-ons%20Manager&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Add-ons%20Manager&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Add-ons%20Manager)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 81

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

81 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [80+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=80%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) |
| firefox-esr78 | [80+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=80%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) |
| firefox79 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix) |
| firefox80 | [+](/buglist.cgi?f1=cf_tracking_firefox80&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed) |
| firefox81 | [+](/buglist.cgi?f1=cf_tracking_firefox81&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr68 | 80+ | fixed |
| firefox-esr78 | 80+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox79 |  | wontfix |
| firefox80 | + | fixed |
| firefox81 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: kaizersoze915, Assigned: kmag)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=40)  [kmag](/user_profile?user_id=106098)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/7ff58cc3c5d778b476fb1b5f6a2dd923?d=mm&size=40)  [kaizersoze915](/user_profile?user_id=668173)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=40)  [zombie](/user_profile?user_id=445095)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [adv-main80+][adv-esr68.12+][adv-esr78.2+][sec-survey])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-15664

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main80+][adv-esr68.12+][adv-esr78.2+][sec-survey]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1550263_1689 "4 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [inheritPermissions-testcase-new.html](/attachment.cgi?id=9169064)  [4 years ago](#c0)  [Kaizer Soze](/user_profile?user_id=668173)   983 bytes, text/html |  | [Details](/attachment.cgi?id=9169064&action=edit) |
| --- | --- | --- |
| [Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley](/attachment.cgi?id=9169274)  [4 years ago](#c7)  [Kris Maglione [:kmag]](/user_profile?user_id=106098)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c16 "4 years ago")  RyanVM : [approval-mozilla-esr68+](#c16 "4 years ago")  RyanVM : [approval-mozilla-esr78+](#c16 "4 years ago")  tjr : [sec-approval+](#c14 "4 years ago") | [Details](/attachment.cgi?id=9169274&action=edit) | [Review](/attachment.cgi?id=9169274) |
| [advisory.txt](/attachment.cgi?id=9171197)  [4 years ago](#c20)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   392 bytes, text/plain |  | [Details](/attachment.cgi?id=9171197&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Kaizer Soze](/user_profile?user_id=668173)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1658214#c0)• 4 years ago |
|  | |

Attached file
[inheritPermissions-testcase-new.html](attachment.cgi?id=9169064)
— [Details](attachment.cgi?id=9169064&action=edit)

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko/20100101 Firefox/79.0

Steps to reproduce:

I created a form, that first loads about:blank into a full new window. I then used the onsubmit handler to load <https://fpn.firefox.com/> into this window which has the extension install permission, while holding a reference to the eval function for that window. Upon submitting the form I have scripted an install of ghostery.

Actual results:

The secondary prompt still displays, which asks a user for permissions to be allowed. Currently this stops a full install of a webextension, but allows for one to attempt more exploitation by manipulating input into Extensions.jsm.

Expected results:

Holding a reference to the eval function of a window should not allow one to inherit permissions of the window that is loaded. This allows all permissions to be inherited but proper defense in depth stops things like accessing video/microphone streams.

Storage APIs may still be able to be manipulated, as I have not had time to fully test this. This could allow one to pollute the local storage of extensions, and persistent webworker pages.

|  | [Kaizer Soze](/user_profile?user_id=668173)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1658214#c1)• 4 years ago |
|  | |

Hey guys, I haven't had time to fully follow up on the storage API permissions and such yet. I will continue to work on this as a fix is put in place. For any additional info please NI me.

Also, can I get this nominated for a sec-bounty? I know back in the day we would have made this a moderate but things have been changing. The potential for exploiting code in Extensions.jsm is high but my time is low.

I happened to mention a bug to Bobby a couple of days ago, I'll link him here.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a18155_1689)• 4 years ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a74139_1689)• 4 years ago |

Group: firefox-core-security → dom-core-securityComponent: Untriaged → DOM: Core & HTMLProduct: Firefox → Core

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1658214#c2)• 4 years ago |
|  | |

Kris, do you have cycles to have a look here?

Flags: needinfo?(kmaglione+bmo)

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1658214#c3)• 4 years ago |
|  | |

I haven't actually debugged the testcase. But the way this is supposed to work is: Synchronously-created windows (iframes, and the return value of window.open) have an initial about:blank document that is same-origin with the creator. Upon navigation, we reuse/persist the global of that about:blank document (and thus globals like eval) of the initial about:blank window if the navigated-to document is same-origin.

So in general, the holdEval trick used in the testcase should just be acquiring the eval of the initial about:blank window, which should be different from fpn.firefox.com, and thus safe from a same-origin-policy perspective. But it could be the case that the permission handling here is out-of-band somehow, and that the inactive inner window is doing permission checks via the active one (via the outer/docshell). If that were the case, that would be bad.

|  | [Kaizer Soze](/user_profile?user_id=668173)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1658214#c4)• 4 years ago |
|  | |

I'll try to save you *some* time with the debugging. InstallTrigger is still only created upon request. Eval allows access to it as if it is the InstallTrigger Object of the about:blank page. InstallTrigger gets the principal it is working with from the window it is created for as it is accessed (lazy initialization). This makes the extension installation case a primary way to show this off.

As for further debugging, other permissions are inherited but only possibly useful case by case. Most seem to have proper defense in depth to prevent similar abuse. This eval trick was only to show off that permissions can get inherited and not meant to be a major point here. I know with so much attention being on webextensions right now, this was a good place to start.

As for further exploitation, I assume all the code in Extensions.jsm isn't supposed to be web facing. I have done practically no work on the storage issues this could lead to, as there's just no time for me to right now.

If I'm interrupting here and you guys want to just roll with this, that's fine with me. My debugging skills definitely aren't as sharp as most.

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1658214#c5)• 4 years ago |
|  | |

Looks like InstallTrigger is JS-implemented WebIDL [1]. Implementing in JS makes it much easier to succumb to inner/outer window confusion, wonder if that's what's happening here.

(To be clear I'm just speculating here since I don't have cycles to actually dig in. Hopefully Kris does.)

[1] <https://searchfox.org/mozilla-central/rev/ab81b8552f4aa9696a2524f97fdfeb59d4dc31c1/dom/webidl/InstallTrigger.webidl#23>

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1658214#c6)• 4 years ago |
|  | |

Yeah, it's a case of inner window confusion. The InstallTrigger's init method takes a window object, and saves the principal from its current document, when it's first initialized. If that happens after the window has navigated, then it winds up taking it from whatever the current document is.

We should probably just forbid initializing any JS-implemented WebIDL globals when their inner window isn't active.

Assignee: nobody → kmaglione+bmoGroup: dom-core-security → firefox-core-securityStatus: UNCONFIRMED → ASSIGNEDComponent: DOM: Core & HTML → Add-ons ManagerEver confirmed: trueFlags: needinfo?(kmaglione+bmo)Product: Core → ToolkitSummary: It's possible to inherit permissions cross domain including the webextension install permission. → InstallTrigger can take the principal from the wrong inner window when initialized

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1658214#c7)• 4 years ago |
|  | |

Attached file
[Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley](attachment.cgi?id=9169274)
— [Details](attachment.cgi?id=9169274&action=edit)

|  | [Kaizer Soze](/user_profile?user_id=668173)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1658214#c8)• 4 years ago |
|  | |

Hey guys, could we get a sec-rating here? Thanks

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1658214#c9)• 4 years ago |
|  | |

This should get a rating before it lands, as that will affect sec-approval. Maybe Dan has some thoughts on a rating.

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1658214#c10)• 4 years ago |
|  | |

As-is the testcase is a super bad spoof: wouldn't be too hard to imagine a "click here to get uBlock Origin from addons.mozilla.org" link, that when clicked opens AMO to the legit uBlock Origin page, and then uses this trick to prompt to install something else with a similar name. Or same name even? not sure the automatic scans require names to be unique. That's not quite sec-high because that powerful spoofing scenario is limited to a single site and action -- but it's a super powerful action!

There are two other objects created using the function that's being patched (that I found -- are there more?). One was the sidebar/add search provider function, but that's a deprecated stub and not useful. The other was the AddonManager. Looking at the IsValidHost logic it ought to be available on AMO but I couldn't get it to work. If you can it would be super powerful. AddonManager.getAddonByID() alone is fantastically useful. You could fingerprint people based on what they have installed. It looks like the "SyncGUID" is a per-install generated thing, if the victim has Sync. If the addon has an icon the URL gives me the full file path to the extension in my profile -- so that gets leaked if someone has a "load known local file" exploit. And if you could make this work and you didn't like adblockers you could have fun with this:

1. Install uBlock Origin if you don't have it already
2. open about:preferences (need it privileged since I couldn't get AMO to work)
3. open the DevTools console
4. execute `(await AddonManager.getAddonByID("uBlock0@raymondhill.net")).disable()`

If you want to play and see what other data is available do `await AddonManager.getAddonByID("uBlock0@raymondhill.net")`

.uninstall() also works (more realistic attack) but harder to undo as a test! change disable() to enable() to get your addon back (or manually in about:addons).

Like I said, I couldn't make that actually work on AMO, but maybe I'm missing something. It's certainly a juicy enough target to be worth playing with.

Testcase works on Firefox ESR-68 (as expected) so we'll need a patch for that, too. The "fpn" site wasn't in the whitelist back then so you have to either manually add the site as an ALLOW exception first, or modify the testcase to use AMO which *was* in the built-in exception list.

[status-firefox79](/buglist.cgi?f1=cf_status_firefox79&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix)
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected)
[status-firefox81](/buglist.cgi?f1=cf_status_firefox81&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=affected)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)
[tracking-firefox80](/buglist.cgi?f1=cf_tracking_firefox80&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox80&o1=equals&v1=%2B)
[tracking-firefox81](/buglist.cgi?f1=cf_tracking_firefox81&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox81&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [80+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=80%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [80+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=80%2B)Flags: needinfo?(dveditz)Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1658214#c11)• 4 years ago |
|  | |

The AddonManager API isn't vulnerable to this issue. The decision on whether or not to make that available happens in C++ via `AddonManagerWebAPI::IsAPIEnabled`, which isn't susceptible to inner window confusion.

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1658214#c12)• 4 years ago |
|  | |

We should land this soon to make 80. Kris, can you request sec-approval?

Flags: needinfo?(kmaglione+bmo)

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1658214#c13)• 4 years ago |
|  | |

Comment on [attachment 9169274](/attachment.cgi?id=9169274 "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") [[details]](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley")

[Bug 1658214](/show_bug.cgi?id=1658214 "RESOLVED FIXED - InstallTrigger can take the principal from the wrong inner window when initialized"): Only construct JS-implemented objects if inner window is current. r=bholley

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Fairly easily, given the small number of APIs constructed this way, but the actual risk of the exploit is relatively low.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: It should already apply cleanly to all branches.
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely. It only affects constructing objects for 3 rarely-used APIs when a window has been navigated away from, which no valid code should be relying on.
Flags: needinfo?(kmaglione+bmo)
[Attachment #9169274](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1658214#c14)• 4 years ago |
|  | |

Comment on [attachment 9169274](/attachment.cgi?id=9169274 "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") [[details]](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley")

[Bug 1658214](/show_bug.cgi?id=1658214 "RESOLVED FIXED - InstallTrigger can take the principal from the wrong inner window when initialized"): Only construct JS-implemented objects if inner window is current. r=bholley

Land it and let's get it uplifted too.

[Attachment #9169274](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") -
Flags: sec-approval? → sec-approval+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1658214#c15)• 4 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/1edd9346c110b011ed87e50eb3d417202ea445fb>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1658214#c16)• 4 years ago |
|  | |

Comment on [attachment 9169274](/attachment.cgi?id=9169274 "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") [[details]](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley")

[Bug 1658214](/show_bug.cgi?id=1658214 "RESOLVED FIXED - InstallTrigger can take the principal from the wrong inner window when initialized"): Only construct JS-implemented objects if inner window is current. r=bholley

Also approved for 80.0rc1, 78.2esr, and 68.12esr.

[Attachment #9169274](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") -
Flags: approval-mozilla-esr78+
[Attachment #9169274](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") -
Flags: approval-mozilla-esr68+
[Attachment #9169274](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") -
Flags: approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1658214#c17)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/6fa858e9b31d>

<https://hg.mozilla.org/releases/mozilla-esr78/rev/bbbd6d1ea0f5>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/4bdb757c65b2>

[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1658214#c18)• 4 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/1edd9346c110>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-firefox81](/buglist.cgi?f1=cf_status_firefox81&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 81 Branch

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a776039_578488)• 4 years ago |

Whiteboard: [adv-main80+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a776242_578488)• 4 years ago |

Whiteboard: [adv-main80+] → [adv-main80+][adv-esr68.12+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a776315_578488)• 4 years ago |

Whiteboard: [adv-main80+][adv-esr68.12+] → [adv-main80+][adv-esr68.12+][adv-esr78.2+]

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1658214#c19)• 4 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1658214) to reply.

Flags: needinfo?(kmaglione+bmo)Whiteboard: [adv-main80+][adv-esr68.12+][adv-esr78.2+] → [adv-main80+][adv-esr68.12+][adv-esr78.2+][sec-survey]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1658214#c20)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9171197)
— [Details](attachment.cgi?id=9171197&action=edit)

Here's an attempt at an advisory, LMK if anyone thinks it can be worded better.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a1282993_578488)• 4 years ago |

Alias: CVE-2020-15664

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a1550263_1689)• 4 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a4494174_106098)• 4 years ago |

Flags: needinfo?(kmaglione+bmo)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a11337674_1689)• 4 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a120086326_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1658214&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Kaizer Soze](/user_profile?user_id=668173)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_d1883d95_20250119_121618.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-37

## Security Vulnerabilities fixed in Firefox ESR 68.12

Announced
August 25, 2020
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 68.12

#### [#CVE-2020-15663: Downgrade attack on the Mozilla Maintenance Service could have resulted in escalation of privilege](#CVE-2020-15663)

Reporter
Xiaoyin Liu
Impact
high
##### Description

If Firefox is installed to a user-writable directory, the Mozilla Maintenance Service would execute updater.exe from the install location with system privileges. Although the Mozilla Maintenance Service does ensure that updater.exe is signed by Mozilla, the version could have been rolled back to a previous version which would have allowed exploitation of an older bug and arbitrary code execution with System Privileges.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1643199](https://bugzilla.mozilla.org/show_bug.cgi?id=1643199)

#### [#CVE-2020-15664: Attacker-induced prompt for extension installation](#CVE-2020-15664)

Reporter
Kaizer Soze
Impact
high
##### Description

By holding a reference to the `eval()` function from an about:blank window, a malicious webpage could have gained access to the InstallTrigger object which would allow them to prompt the user to install an extension. Combined with user confusion, this could result in an unintended or malicious extension being installed.

##### References

* [Bug 1658214](https://bugzilla.mozilla.org/show_bug.cgi?id=1658214)

#### [#CVE-2020-15669: Use-After-Free when aborting an operation](#CVE-2020-15669)

Reporter
Jason Kratzer
Impact
high
##### Description

When aborting an operation, such as a fetch, an abort signal may be deleted while alerting the objects to be notified. This results in a use-after-free and we presume that with enough effort it could have been exploited to run arbitrary code.

##### References

* [Bug 1656957](https://bugzilla.mozilla.org/show_bug.cgi?id=1656957)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_73f8d6fa_20250119_135612.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from www.mozilla.org_6b20703f_20250119_121619.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-40

## Security Vulnerabilities fixed in Thunderbird 68.12

Announced
August 25, 2020
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 68.12

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2020-15663: Downgrade attack on the Mozilla Maintenance Service could have resulted in escalation of privilege](#CVE-2020-15663)

Reporter
Xiaoyin Liu
Impact
high
##### Description

If Thunderbird is installed to a user-writable directory, the Mozilla Maintenance Service would execute updater.exe from the install location with system privileges. Although the Mozilla Maintenance Service does ensure that updater.exe is signed by Mozilla, the version could have been rolled back to a previous version which would have allowed exploitation of an older bug and arbitrary code execution with System Privileges.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1643199](https://bugzilla.mozilla.org/show_bug.cgi?id=1643199)

#### [#CVE-2020-15664: Attacker-induced prompt for extension installation](#CVE-2020-15664)

Reporter
Kaizer Soze
Impact
high
##### Description

By holding a reference to the `eval()` function from an about:blank window, a malicious webpage could have gained access to the InstallTrigger object which would allow them to prompt the user to install an extension. Combined with user confusion, this could result in an unintended or malicious extension being installed.

##### References

* [Bug 1658214](https://bugzilla.mozilla.org/show_bug.cgi?id=1658214)

#### [#CVE-2020-15669: Use-After-Free when aborting an operation](#CVE-2020-15669)

Reporter
Jason Kratzer
Impact
high
##### Description

When aborting an operation, such as a fetch, an abort signal may be deleted while alerting the objects to be notified. This results in a use-after-free and we presume that with enough effort it could have been exploited to run arbitrary code.

##### References

* [Bug 1656957](https://bugzilla.mozilla.org/show_bug.cgi?id=1656957)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_a2a6133f_20250119_121619.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-39

## Security Vulnerabilities fixed in Firefox for Android 80

Announced
September 2, 2020
Impact
high
Products
Firefox for Android
Fixed in

* Firefox for Android 80

#### [#CVE-2020-15664: Attacker-induced prompt for extension installation](#CVE-2020-15664)

Reporter
Kaizer Soze
Impact
high
##### Description

By holding a reference to the `eval()` function from an about:blank window, a malicious webpage could have gained access to the InstallTrigger object which would allow them to prompt the user to install an extension. Combined with user confusion, this could result in an unintended or malicious extension being installed.

##### References

* [Bug 1658214](https://bugzilla.mozilla.org/show_bug.cgi?id=1658214)

#### [#CVE-2020-12401: Timing-attack on ECDSA signature generation](#CVE-2020-12401)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida García, Jesús-Javier Chi-Domínguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

During ECDSA signature generation, padding applied in the nonce designed to ensure constant-time scalar multiplication was removed, resulting in variable-time execution dependent on secret data.

##### References

* [Bug 1631573](https://bugzilla.mozilla.org/show_bug.cgi?id=1631573)

#### [#CVE-2020-6829: P-384 and P-521 vulnerable to an electro-magnetic side channel attack on signature generation](#CVE-2020-6829)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida García, Jesús-Javier Chi-Domínguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

When performing EC scalar point multiplication, the wNAF point multiplication algorithm was used; which leaked partial information about the nonce used during signature generation. Given an electro-magnetic trace of a few signature generations, the private key could have been computed.

##### References

* [Bug 1631583](https://bugzilla.mozilla.org/show_bug.cgi?id=1631583)

#### [#CVE-2020-12400: P-384 and P-521 vulnerable to a side channel attack on modular inversion](#CVE-2020-12400)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida García, Jesús-Javier Chi-Domínguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

When converting coordinates from projective to affine, the modular inversion was not performed in constant time, resulting in a possible timing-based side channel attack.

##### References

* [Bug 1623116](https://bugzilla.mozilla.org/show_bug.cgi?id=1623116)

#### [#CVE-2020-15666: MediaError message property leaks cross-origin response status](#CVE-2020-15666)

Reporter
Gunes Acar
Impact
low
##### Description

When trying to load a non-video in an audio/video context the exact status code (200, 302, 404, 500, 412, 403, etc.) was disclosed via the MediaError Message. This level of information leakage is inconsistent with the standardized onerror/onsuccess disclosure and can lead to inferring login status to services or device discovery on a local network among other attacks.

##### References

* [Bug 1450853](https://bugzilla.mozilla.org/show_bug.cgi?id=1450853)

#### [#CVE-2020-15668: Data Race when reading certificate information](#CVE-2020-15668)

Reporter
Tyson Smith
Impact
low
##### Description

A lock was missing when accessing a data structure and importing certificate information into the trust database.

##### References

* [Bug 1651520](https://bugzilla.mozilla.org/show_bug.cgi?id=1651520)

#### [#CVE-2020-15671: Passwords could be saved to phone keyboard dictionary](#CVE-2020-15671)

Reporter
Karol Frejlich
Impact
low
##### Description

When typing in a password under certain conditions, a race may have occured where the InputContext was not being correctly set for the input field, resulting in the typed passwod being saved to the keyboard dictionary.

##### References

* [Bug 1653862](https://bugzilla.mozilla.org/show_bug.cgi?id=1653862)

#### [#CVE-2020-15670: Memory safety bugs fixed in Firefox for Android 80](#CVE-2020-15670)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Jason Kratzer, Christian Holler, and Byron Campen reported memory safety bugs present in Firefox for Android 79. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox for Android 80](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1651001%2C1653626%2C1656957)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_19945826_20250119_121618.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-36

## Security Vulnerabilities fixed in Firefox 80

Announced
August 25, 2020
Impact
high
Products
Firefox
Fixed in

* Firefox 80

#### [#CVE-2020-15663: Downgrade attack on the Mozilla Maintenance Service could have resulted in escalation of privilege](#CVE-2020-15663)

Reporter
Xiaoyin Liu
Impact
high
##### Description

If Firefox is installed to a user-writable directory, the Mozilla Maintenance Service would execute updater.exe from the install location with administrative privileges. Although the Mozilla Maintenance Service does ensure that updater.exe is signed by Mozilla, the version could have been rolled back to a previous version which would have allowed exploitation of an older bug and arbitrary code execution with system privileges.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1643199](https://bugzilla.mozilla.org/show_bug.cgi?id=1643199)

#### [#CVE-2020-15664: Attacker-induced prompt for extension installation](#CVE-2020-15664)

Reporter
Kaizer Soze
Impact
high
##### Description

By holding a reference to the `eval()` function from an about:blank window, a malicious webpage could have gained access to the InstallTrigger object which would allow them to prompt the user to install an extension. Combined with user confusion, this could result in an unintended or malicious extension being installed.

##### References

* [Bug 1658214](https://bugzilla.mozilla.org/show_bug.cgi?id=1658214)

#### [#CVE-2020-12401: Timing-attack on ECDSA signature generation](#CVE-2020-12401)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida García, Jesús-Javier Chi-Domínguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

During ECDSA signature generation, padding applied in the nonce designed to ensure constant-time scalar multiplication was removed, resulting in variable-time execution dependent on secret data.

##### References

* [Bug 1631573](https://bugzilla.mozilla.org/show_bug.cgi?id=1631573)

#### [#CVE-2020-6829: P-384 and P-521 vulnerable to an electro-magnetic side channel attack on signature generation](#CVE-2020-6829)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida García, Jesús-Javier Chi-Domínguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

When performing EC scalar point multiplication, the wNAF point multiplication algorithm was used; which leaked partial information about the nonce used during signature generation. Given an electro-magnetic trace of a few signature generations, the private key could have been computed.

##### References

* [Bug 1631583](https://bugzilla.mozilla.org/show_bug.cgi?id=1631583)

#### [#CVE-2020-12400: P-384 and P-521 vulnerable to a side channel attack on modular inversion](#CVE-2020-12400)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida García, Jesús-Javier Chi-Domínguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

When converting coordinates from projective to affine, the modular inversion was not performed in constant time, resulting in a possible timing-based side channel attack.

##### References

* [Bug 1623116](https://bugzilla.mozilla.org/show_bug.cgi?id=1623116)

#### [#CVE-2020-15665: Address bar not reset when choosing to stay on a page after the beforeunload dialog is shown](#CVE-2020-15665)

Reporter
Luan Herrera
Impact
moderate
##### Description

Firefox did not reset the address bar after the beforeunload dialog was shown if the user chose to remain on the page. This could have resulted in an incorrect URL being shown when used in conjunction with other unexpected browser behaviors.

##### References

* [Bug 1651636](https://bugzilla.mozilla.org/show_bug.cgi?id=1651636)

#### [#CVE-2020-15666: MediaError message property leaks cross-origin response status](#CVE-2020-15666)

Reporter
Gunes Acar
Impact
low
##### Description

When trying to load a non-video in an audio/video context the exact status code (200, 302, 404, 500, 412, 403, etc.) was disclosed via the MediaError Message. This level of information leakage is inconsistent with the standardized onerror/onsuccess disclosure and can lead to inferring login status to services or device discovery on a local network among other attacks.

##### References

* [Bug 1450853](https://bugzilla.mozilla.org/show_bug.cgi?id=1450853)

#### [#CVE-2020-15667: Heap overflow when processing an update file](#CVE-2020-15667)

Reporter
crixer
Impact
low
##### Description

When processing a MAR update file, after the signature has been validated, an invalid name length could result in a heap overflow, leading to memory corruption and potentially arbitrary code execution. Within Firefox as released by Mozilla, this issue is only exploitable with the Mozilla-controlled signing key.

##### References

* [Bug 1653371](https://bugzilla.mozilla.org/show_bug.cgi?id=1653371)

#### [#CVE-2020-15668: Data Race when reading certificate information](#CVE-2020-15668)

Reporter
Tyson Smith
Impact
low
##### Description

A lock was missing when accessing a data structure and importing certificate information into the trust database.

##### References

* [Bug 1651520](https://bugzilla.mozilla.org/show_bug.cgi?id=1651520)

#### [#CVE-2020-15670: Memory safety bugs fixed in Firefox 80 and Firefox ESR 78.2](#CVE-2020-15670)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Jason Kratzer, Christian Holler, and Byron Campen reported memory safety bugs present in Firefox 79 and Firefox ESR 78.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 80 and Firefox ESR 78.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1651001%2C1653626%2C1656957)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


