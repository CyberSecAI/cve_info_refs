=== Content from www.openwall.com_435e5182_20250119_122753.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2021/02/03/4) [[next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <BF1D4D4E-FE1B-424C-ADBB-C53FF0B5054E@consensys.net>
Date: Thu, 4 Feb 2021 11:33:26 +0100
From: Martin Ortner <martin.ortner@...sensys.net>
To: oss-security@...ts.openwall.com
Subject: [CVE-2020-15692] Nim - stdlib Browsers - `open` Argument Injection

title: "Nim - stdlib Browsers - `open` Argument Injection"
date: 2020-07-30T19:32:09+01:00

cve: ["CVE-2020-15692"]
vendor: nim-lang
vendorUrl: <https://nim-lang.org/>
authors: tintinweb
affectedVersions: [ "<= 1.2.6" ]
vulnClass: CWE-88

Vulnerability Note: <https://consensys.net/diligence/vulnerabilities/nim-browsers-argument-injection/> <<https://consensys.net/diligence/vulnerabilities/nim-browsers-argument-injection/>>
Vulnerability Note: <https://github.com/tintinweb/pub/tree/master/pocs/cve-2020-15692> <<https://github.com/tintinweb/pub/tree/master/pocs/cve-2020-15692>>
Group: <https://consensys.net/diligence/research/>

## Summary

The nim-lang stdlib `browsers` provides a convenient interface to open an URL with the system default browser. The library, however, fails to validated that the provided input is actually an URL. An attacker in control of an unfiltered URL passed to `browsers.openDefaultBrowser(URL)` can, therefore, provide a local file path that will be opened in the default explorer or pass one argument to the underlying `open` command to execute arbitrary registered system commands.

## Details

### Description

`browsers.openDefaultBrowser()` internally calls `shellExecuteW` passing in the URL as an arg to `open` for Windows and `execShellCmd` with the OS's open command (`xdg-open` on linux, `open` on MacOs) and the shell quoted `url` as an argument on nix systems.

The implementation is as follows:

```nim
template openDefaultBrowserImpl(url: string) =
  when defined(windows):
    var o = newWideCString(osOpenCmd)
    var u = newWideCString(url)
    discard shellExecuteW(0'i32, o, u, nil, nil, SW_SHOWNORMAL)
  elif defined(macosx):
    discard execShellCmd(osOpenCmd & " " & quoteShell(url))
  else:
    var u = quoteShell(url)
    if execShellCmd(osOpenCmd & " " & u) == 0: return
    for b in getEnv("BROWSER").string.split(PathSep):
      try:
        # we use ``startProcess`` here because we don't want to block!
        discard startProcess(command = b, args = [url], options = {poUsePath})
        return
      except OSError:
        discard
```

On windows, the attacker controls the `lpFile` argument to `shellExecuteW` which may allow opening arbitrary local files.
On MacOs, the attacker controls the first argument to the `open` command which takes the following command line switches:

```
Options:
      -a                Opens with the specified application.
      -b                Opens with the specified application bundle identifier.
      -e                Opens with TextEdit.
      -t                Opens with default text editor.
      -f                Reads input from standard input and opens with TextEdit.
      -F  --fresh       Launches the app fresh, that is, without restoring windows. Saved persistent state is lost, excluding Untitled documents.
      -R, --reveal      Selects in the Finder instead of opening.
      -W, --wait-apps   Blocks until the used applications are closed (even if they were already running).
          --args        All remaining arguments are passed in argv to the application's main() function instead of opened.
      -n, --new         Open a new instance of the application even if one is already running.
      -j, --hide        Launches the app hidden.
      -g, --background  Does not bring the application to the foreground.
      -h, --header      Searches header file locations for headers matching the given filenames, and opens them.
      -s                For -h, the SDK to use; if supplied, only SDKs whose names contain the argument value are searched.
                        Otherwise the highest versioned SDK in each platform is used.
```

If an attacker manages to pass in an URL that is actually a commandline switche to open, they may be able to launch arbitrary commands (or do whatever open allows them to do with one argument). For example, `openDefaultBrowser(".")` will open Finder in the current working dir, `openDefaultBrowser("-aCalculator")` and `openDefaultBrowser("-bcom.apple.calculator")` launches the calculator.

### Proof of Concept

launch calculator:

```nim
import browsers
openDefaultBrowser("-bcom.apple.calculator")
```

terminate the shell quoting causing an error:

```nim
import browsers
var vector = "-bcom.apple.calculator\x00"
openDefaultBrowser(vector)

```

```
⇒  nim c -r -d:ssl test.nim
sh: -c: line 0: unexpected EOF while looking for matching `''
sh: -c: line 1: syntax error: unexpected end of file
```

## Vendor Response

Vendor response: fixed in [v1.2.6](<https://nim-lang.org/blog/2020/07/30/versions-126-and-108-released.html>)

### Timeline

```
JUL/09/2020 - contact the development team @telegram; provided details, PoC
JUL/30/2020 - fixed in new release
```

## References

* [1] <https://nim-lang.org/>
* [2] <https://nim-lang.org/install.html>
* [3] [https://en.wikipedia.org/wiki/Nim_(programming_language](https://en.wikipedia.org/wiki/Nim_%28programming_language))
* [4] <https://nim-lang.org/blog/2020/07/30/versions-126-and-108-released.html>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from nim-lang.org_88341cf2_20250119_140606.html ===

[![Nim](/assets/img/logo.svg)](/)

* [Blog](/blog.html)
* [Features](/features.html)
* [Download](/install.html)
* [Documentation](/documentation.html)
* [Forum](https://forum.nim-lang.org)
* [Donate](/donate.html)
* [Source](https://github.com/nim-lang/Nim)

# Efficient, expressive, elegant

## Nim is a statically typed compiled systems programming language. It combines successful concepts from mature languages like Python, Ada and Modula.

[Install Nim 2.2.0](/install.html)
[Try it online](https://play.nim-lang.org/#ix=2lK1)
### Efficient

* Nim generates native dependency-free executables, not dependent on a virtual machine,
  which are small and allow easy redistribution.
* The Nim compiler and the generated executables support all major platforms like
  Windows, Linux, BSD and macOS.
* Nim's memory management is deterministic and customizable with destructors and move
  semantics, inspired by C++ and Rust.
  It is well-suited for embedded, hard-realtime systems.
* Modern concepts like zero-overhead iterators and compile-time evaluation
  of user-defined functions, in combination with the preference of value-based
  datatypes allocated on the stack, lead to extremely performant code.
* Support for various backends: it compiles to C, C++ or JavaScript so that Nim
  can be used for all backend and frontend needs.

### Expressive

* Nim is self-contained: the compiler and the standard library are implemented in Nim.
* Nim has a powerful macro system which allows direct manipulation of the AST,
  offering nearly unlimited opportunities.

### Elegant

* Macros cannot change Nim's syntax because there is no need for it â
  the syntax is flexible enough.
* Modern type system with local type inference, tuples, generics and sum types.
* Statements are grouped by indentation but can span multiple lines.

Simple example
Ifâ¦else, Case switch
Basic math
String operations
Comprehensions

````
import std/strformat

type
  Person = object
    name: string
    age: Natural # Ensures the age is positive

let people = [
  Person(name: "John", age: 45),
  Person(name: "Kate", age: 30)
]

for person in people:
  # Type-safe string interpolation,
  # evaluated at compile time.
  echo(fmt"{person.name} is {person.age} years old")

# Thanks to Nim's 'iterator' and 'yield' constructs,
# iterators are as easy to write as ordinary
# functions. They are compiled to inline loops.
iterator oddNumbers[Idx, T](a: array[Idx, T]): T =
  for x in a:
    if x mod 2 == 1:
      yield x

for odd in oddNumbers([3, 6, 9, 12, 15, 18]):
  echo odd

# Use Nim's macro system to transform a dense
# data-centric description of x86 instructions
# into lookup tables that are used by
# assemblers and JITs.
import macros, strutils

macro toLookupTable(data: static[string]): untyped =
  result = newTree(nnkBracket)
  for w in data.split(';'):
    result.add newLit(w)

const
  data = "mov;btc;cli;xor"
  opcodes = toLookupTable(data)

for o in opcodes:
  echo o
````
````
var conditional = 42

if conditional < 0:
  echo "conditional < 0"
elif conditional > 0:
  echo "conditional > 0"
else:
  echo "conditional == 0"

var ternary = if conditional == 42: true else: false

var another =
  if conditional == 0:
    "zero"
  elif conditional mod 2 == 0:
    "even"
  else:
    "odd"

# Case switch.
var letter = 'c'

case letter
of 'a':
  echo "letter is 'a'"
of 'b', 'c':
  echo "letter is 'b' or 'c'"
of 'd'..'h':
  echo "letter is between 'd' and 'h'"
else:
  echo "letter is another character"
````
````
import std/math

# Basic math.
assert 1 + 2 == 3        # Sum
assert 4 - 1 == 3        # Subtraction
assert 2 * 2 == 4        # Multiplication
assert 4 / 2 == 2.0      # Division
assert 4 div 2 == 2      # Integer Division
assert 2 ^ 3 == 8        # Power
assert 4 mod 2 == 0      # Modulo
assert (2 xor 4) == 6    # XOR
assert (4 shr 2) == 1    # Shift Right
assert PI * 2 == TAU     # PI and TAU
assert sqrt(4.0) == 2.0  # Square Root
assert round(3.5) == 4.0 # Round
assert isPowerOfTwo(16)  # Powers of Two
assert floor(2.9) == 2.0 # Floor
assert ceil(2.9) == 3.0  # Ceil
assert cos(TAU) == 1.0   # Cosine
assert gcd(12, 8) == 4   # Greatest common divisor
assert trunc(1.75) == 1.0     # Truncate
assert floorMod(8, 3) == 2    # Floor Modulo
assert floorDiv(8, 3) == 2    # Floor Division
assert hypot(4.0, 3.0) == 5.0 # Hypotenuse
assert gamma(4.0) == 6.0      # Gamma function
assert radToDeg(TAU) == 360.0 # Radians to Degrees
assert clamp(1.4, 0.0 .. 1.0) == 1.0 # Clamp
assert almostEqual(PI, 3.14159265358979)
assert euclDiv(-13, -3) == 5  # Euclidean Division
assert euclMod(-13, 3) == 2   # Euclidean Modulo
````
````
import std/[strutils, strscans]

assert "con" & "cat" == "concat"
assert "    a    ".strip == "a"
assert "42".parseInt == 42
assert "3.14".parseFloat == 3.14
assert "0x666".parseHexInt == 1638
assert "TrUe".parseBool == true
assert "0o777".parseOctInt == 511
assert "a".repeat(9) == "aaaaaaaaa"
assert "abc".startsWith("ab")
assert "abc".endsWith("bc")
assert ["a", "b", "c"].join == "abc"
assert "abcd".find("c") == 2
assert "a x a y a z".count("a") == 3
assert "A__B__C".normalize == "abc"
assert "a,b".split(",") == @["a", "b"]
assert "a".center(5) == "  a  "
assert "a".indent(4) == "    a"
assert "    a".unindent(4) == "a"

for word in tokenize("This is an example"):
  echo word

let (ok, year, month, day) = scanTuple("1000-01-01", "$i-$i-$i")
if ok:
  assert year == 1000
  assert month == 1
  assert day == 1
````
````
import std/[sugar, tables, sets, sequtils, strutils]

let variable0 = collect(newSeq):
  for item in @[-9, 1, 42, 0, -1, 9]:
    item * 2

assert variable0 == @[-18, 2, 84, 0, -2, 18]

let variable1 = collect(initTable):
  for key, value in @[0, 5, 9]:
    {key: value div 2}

assert variable1 == {0: 0, 1: 2, 2: 4}.toTable

let variable2 = collect(initHashSet):
  for item in @[-9, 1, 42, 0, -1, 9]:
    {item + item}

assert variable2 == [2, 18, 84, 0, -18, -2].toHashSet

assert toSeq(1..15).mapIt(
    if it mod 15 == 0:  "FizzBuzz"
    elif it mod 5 == 0: "Buzz"
    elif it mod 3 == 0: "Fizz"
    else: $it
  ).join(" ").strip == "1 2 Fizz 4 Buzz Fizz 7 8 Fizz Buzz 11 Fizz 13 14 FizzBuzz"
````

[More examples at RosettaCodeâ¦](http://rosettacode.org/wiki/Category%3ANim)

# Recent articles

24 December 2024

## [Nim version 2.0.14 released](/blog/2024/12/24/nim-2014-released.html)

The Nim team is happy to announce Nim version 2.0.14, our seventh patch release for Nim 2.0,
for our users who havenât switched yet to [Nim 2.2](https://nim-lang.org/blog/2024/10/02/nim-220-2010.html).

09 December 2024

## [Launching the 2024 Nim Community Survey](/blog/2024/12/09/community-survey-2024.html)

We are proud to announce the launch of the official
[2024 Nim Community Survey](https://forms.gle/s6WomUFyUANijhrL6)!

[All articles](/blog.html)

![](/assets/img/mastering_nim.jpg)
# Mastering Nim

### The definite guide on Nim!

### Written by the inventor himself.

### Now with updated content for version 2.0 which solves the biggest pain point of Nim 1.0, shared memory in a multi-threaded setting.

[Buy it on amazon.com](https://www.amazon.com/dp/B0B4R7B9YX)
[Buy it on amazon.de](https://www.amazon.de/dp/B0B4R7B9YX)

# Support Nim

## Join the 100+ companies and individuals that support Nim

### The Nim project is developed globally by a group of volunteers. We welcome recurring donations, which enable us to spend more time working on Nim.

[Donate](/donate.html)

# Community

## Real-time chat

*#*Libera.chat#nim

[Discord/Nim](https://discord.gg/nim)

[Gitter/Nim](https://gitter.im/nim-lang/Nim)

[*m*#nim:envs.net](https://matrix.to/#/#nim:envs.net)

[*#*IRC Logs](https://irclogs.nim-lang.org)

[Telegram/nim\_lang](https://t.me/nim_lang)

## Forum

[forum.nim-lang.org](https://forum.nim-lang.org)

[r/nim](https://reddit.com/r/nim)

[StackOverflow](https://stackoverflow.com/questions/tagged/nim-lang)

## Bug reports

[nim-lang/Nim](https://github.com/nim-lang/Nim/issues)

## Twitter

[@nim\_lang](https://twitter.com/nim_lang)

[Join the community](/community.html)

# Looking for the GitHub repository?

### The Nim compiler and tools are all written in Nim and licensed under the MIT license, with most development taking place on GitHub. Be sure to watch the repository to get updates on Nim's development, or star it to give us some brownie points.

[Source code](https://github.com/nim-lang/Nim)

Unless otherwise stated, the content of this page is
licensed under the
[Creative Commons Attribution 3.0](https://creativecommons.org/licenses/by/3.0/)
license.
Code displayed on this website is MIT licensed.

This website is available on
[GitHub](https://github.com/nim-lang/website)
and contributions are welcome.
Original website design by
[Dominik Picheta](https://github.com/dom96) and
[Hugo Locurcio](https://github.com/Calinou).
Logo by [Joseph Wecker](https://github.com/josephwecker).

[![](/assets/img/do.png)](https://m.do.co/c/637ab907c7f4)



=== Content from nim-lang.org_b502afb0_20250119_122755.html ===

[![Nim](/assets/img/logo.svg)](/)

* [Blog](/blog.html)
* [Features](/features.html)
* [Download](/install.html)
* [Documentation](/documentation.html)
* [Forum](https://forum.nim-lang.org)
* [Donate](/donate.html)
* [Source](https://github.com/nim-lang/Nim)

# Versions 1.2.6 and 1.0.8 released

### 30 July 2020 The Nim Team

The Nim team is happy to announce this double release of versions 1.2.6 and 1.0.8.

# Version 1.2.6

Version 1.2.6 is our third patch release for Nim 1.2 and it brings several new
fixes since versions 1.2.2 and 1.2.4 (the latter was just a hotfix release,
because 1.2.2 was mistakenly shipped without `nim-gdb`).

## Installing Nim 1.2.6

### New users

Check out if the package manager of your OS already ships version 1.2.6 or
install it as described [here](https://nim-lang.org/install.html).

### Existing users

If you have installed a previous version of Nim using `choosenim`,
getting Nim 1.2.6 is as easy as:

```
$ choosenim update stable

```

Alternatively, you can download Nim 1.0.8 from
[our nightlies builds](https://github.com/nim-lang/nightlies/releases/tag/2020-07-29-version-1-2-bf320ed).

## Bugfixes since 1.2.2

* Fixed âThe pegs module doesnât work with generics!â
  ([#14718](https://github.com/nim-lang/Nim/issues/14718))
* Fixed â[goto exceptions] {.noReturn.} pragma is not detected in a case expressionâ
  ([#14458](https://github.com/nim-lang/Nim/issues/14458))
* Fixed â[exceptions:goto] C compiler error with dynlib pragma calling a procâ
  ([#14240](https://github.com/nim-lang/Nim/issues/14240))
* Fixed âNim source archive install: âinstall.shâ fails with error: cp: cannot stat âbin/nim-gdbâ: No such file or directoryâ
  ([#14748](https://github.com/nim-lang/Nim/issues/14748))
* Fixed âStropped identifiers donât work as field names in tuple literalsâ
  ([#14911](https://github.com/nim-lang/Nim/issues/14911))
* Fixed âuri.decodeUrl crashes on incorrectly formatted inputâ
  ([#14082](https://github.com/nim-lang/Nim/issues/14082))
* Fixed âodbcsql module has some wrong integer typesâ
  ([#9771](https://github.com/nim-lang/Nim/issues/9771))
* Fixed â[ARC] Compiler crash declaring a finalizer proc directly in ânewââ
  ([#15044](https://github.com/nim-lang/Nim/issues/15044))
* Fixed âcode with named arguments in proc of winim/com can not been compiledâ
  ([#15056](https://github.com/nim-lang/Nim/issues/15056))
* Fixed âjavascript backend produces javascript code with syntax error in object syntaxâ
  ([#14534](https://github.com/nim-lang/Nim/issues/14534))
* Fixed â[ARC] SIGSEGV when calling a closure as a tuple field in a seqâ
  ([#15038](https://github.com/nim-lang/Nim/issues/15038))
* Fixed âCompiler crashes when using string as object variant selector with else branchâ
  ([#14189](https://github.com/nim-lang/Nim/issues/14189))
* Fixed âConstructing a uint64 range on a 32-bit machine leads to incorrect codegenâ
  ([#14616](https://github.com/nim-lang/Nim/issues/14616))

Full changelog since v1.2.2 contains [30 commits](https://github.com/nim-lang/Nim/compare/v1.2.2...v1.2.6).

# Verson 1.0.8

Version 1.0.8 is our fourth patch release for Nim 1.0 for those users who havenât
yet switched to Nim 1.2, coming 5 months after the release of Nim 1.0.6.

If you are still on Nim 1.0.x, and would like to know about new features
available in Nim 1.2.x, check out our
[version 1.2.0 release article](https://nim-lang.org/blog/2020/04/03/version-120-released.html).

## Installing Nim 1.0.8

### New users

We recommend you to install Nim 1.2, see the instructions above.

### Existing users

If you have installed a previous version of Nim using `choosenim`,
getting Nim 1.0.8 is as easy as:

```
$ choosenim 1.0.8

```

Alternatively, you can download Nim 1.0.8 from
[our nightlies builds](https://github.com/nim-lang/nightlies/releases/tag/2020-07-29-version-1-0-b5ec602).

## Bugfixes since 1.0.6

* Fixed âwrite requires conversion to stringâ
  ([#13182](https://github.com/nim-lang/Nim/issues/13182))
* Fixed âSome remarks to stdlib documentationâ
  ([#13352](https://github.com/nim-lang/Nim/issues/13352))
* Fixed â[Macro] Crash on malformed case statement with multiple elseâ
  ([#13255](https://github.com/nim-lang/Nim/issues/13255))
* Fixed âregression: `echo 'discard' | nim c -r -` generates a file â-â ; `-` should be treated speciallyâ
  ([#13374](https://github.com/nim-lang/Nim/issues/13374))
* Fixed âInternal error in getTypeDescAuxâ
  ([#13378](https://github.com/nim-lang/Nim/issues/13378))
* Fixed âInternal error in getTypeDescAuxâ
  ([#13378](https://github.com/nim-lang/Nim/issues/13378))
* Fixed âjoinPath(ââ, ââ) is â/â ; should be âââ
  ([#13455](https://github.com/nim-lang/Nim/issues/13455))
* Fixed âtables.values is brokenâ
  ([#13496](https://github.com/nim-lang/Nim/issues/13496))
* Fixed âArrays are passed by copy to iterators, causing crashes, unnecessary allocations and slowdownsâ
  ([#12747](https://github.com/nim-lang/Nim/issues/12747))
* Fixed â[regression] VM: Error: cannot convert -1 to uint64â
  ([#13661](https://github.com/nim-lang/Nim/issues/13661))
* Fixed âError: cannot convert -1 to uint (inside tuples)â
  ([#13671](https://github.com/nim-lang/Nim/issues/13671))
* Fixed âCritical: 1 completed Future, multiple await: Only 1 await will be awakened (the last one)â
  ([#13889](https://github.com/nim-lang/Nim/issues/13889))
* Fixed âopenssl wrapper corrupts stack on OpenSSL 1.1.1f + Androidâ
  ([#13903](https://github.com/nim-lang/Nim/issues/13903))
* Fixed âCant use expressions with `when` in `type` sections.â
  ([#14007](https://github.com/nim-lang/Nim/issues/14007))
* Fixed âIncorrect escape sequence for example in jsffi library documentationâ
  ([#14110](https://github.com/nim-lang/Nim/issues/14110))
* Fixed âcas is wrong for tccâ
  ([#14151](https://github.com/nim-lang/Nim/issues/14151))
* Fixed âInvalid return value of openProcess is NULL rather than `INVALID_HANDLE_VALUE(-1)` in windowsâ
  ([#14289](https://github.com/nim-lang/Nim/issues/14289))
* Fixed ânim-gdb is missing from all released packagesâ
  ([#13104](https://github.com/nim-lang/Nim/issues/13104))
* Fixed âThe pegs module doesnât work with generics!â
  ([#14718](https://github.com/nim-lang/Nim/issues/14718))
* Fixed âNim source archive install: âinstall.shâ fails with error: cp: cannot stat âbin/nim-gdbâ: No such file or directoryâ
  ([#14748](https://github.com/nim-lang/Nim/issues/14748))
* Fixed âStropped identifiers donât work as field names in tuple literalsâ
  ([#14911](https://github.com/nim-lang/Nim/issues/14911))
* Fixed âuri.decodeUrl crashes on incorrectly formatted inputâ
  ([#14082](https://github.com/nim-lang/Nim/issues/14082))
* Fixed âodbcsql module has some wrong integer typesâ
  ([#9771](https://github.com/nim-lang/Nim/issues/9771))
* Fixed âcode with named arguments in proc of winim/com can not been compiledâ
  ([#15056](https://github.com/nim-lang/Nim/issues/15056))
* Fixed âjavascript backend produces javascript code with syntax error in object syntaxâ
  ([#14534](https://github.com/nim-lang/Nim/issues/14534))
* Fixed âCompiler crashes when using string as object variant selector with else branchâ
  ([#14189](https://github.com/nim-lang/Nim/issues/14189))

Full changelog since v1.0.6 contains [82 commits](https://github.com/nim-lang/Nim/compare/v1.0.6...v1.0.8).

Unless otherwise stated, the content of this page is
licensed under the
[Creative Commons Attribution 3.0](https://creativecommons.org/licenses/by/3.0/)
license.
Code displayed on this website is MIT licensed.

This website is available on
[GitHub](https://github.com/nim-lang/website)
and contributions are welcome.
Original website design by
[Dominik Picheta](https://github.com/dom96) and
[Hugo Locurcio](https://github.com/Calinou).
Logo by [Joseph Wecker](https://github.com/josephwecker).

[![](/assets/img/do.png)](https://m.do.co/c/637ab907c7f4)



=== Content from consensys.net_2f342841_20250119_122754.html ===

[![Consensys Diligence](/images/logo/logo.svg)](/ "Home")

[Audits](/audits/ "Audits")
[Fuzzing](/fuzzing/ "Fuzzing")
[Scribble](/scribble/ "Scribble")
[Blog](/blog/ "Blog")
[Tools](/tools/ "Tools")
[Research](/research/ "Research")
[About](/about/ "About")
[Contact](/contact/ "Contact")

# Nim - stdlib Browsers - `open` Argument Injection

* [1 Summary](#summary)
* [2 Details](#details)
  + [2.1 Description](#description)
  + [2.2 Proof of Concept](#proof-of-concept)
  + [2.3 Proposed Fix](#proposed-fix)
* [3 Vendor Response](#vendor-response)
  + [3.1 Timeline](#timeline)
* [4 References](#references)

Request access to Fuzzing

[Book Now](https://consensys.io/diligence/fuzzing/)

| CVE | [CVE-2020-15692](https://nvd.nist.gov/vuln/detail/CVE-2020-15692) |
| --- | --- |
| Vendor | [nim-lang](https://nim-lang.org/) |
| Affected Versions | <= 1.2.6 |
| Vulnerability Class | CWE-88 |
| Author(s) | tintinweb |
| Date | Jul 30, 2020 |

**Vulnerability Note**

## 1 Summary

The nim-lang stdlib `browsers` provides a convenient interface to open an URL with the system default browser. The library, however, fails to validated that the provided input is actually an URL. An attacker in control of an unfiltered URL passed to `browsers.openDefaultBrowser(URL)` can, therefore, provide a local file path that will be opened in the default explorer or pass one argument to the underlying `open` command to execute arbitrary registered system commands.

## 2 Details

### 2.1 Description

`browsers.openDefaultBrowser()` internally calls `shellExecuteW` passing in the URL as an arg to `open` for Windows and `execShellCmd` with the OS’s open command (`xdg-open` on linux, `open` on MacOs) and the shell quoted `url` as an argument on nix systems.

The implementation is as follows:

```
template openDefaultBrowserImpl(url: string) =
  when defined(windows):
    var o = newWideCString(osOpenCmd)
    var u = newWideCString(url)
    discard shellExecuteW(0'i32, o, u, nil, nil, SW_SHOWNORMAL)
  elif defined(macosx):
    discard execShellCmd(osOpenCmd & " " & quoteShell(url))
  else:
    var u = quoteShell(url)
    if execShellCmd(osOpenCmd & " " & u) == 0: return
    for b in getEnv("BROWSER").string.split(PathSep):
      try:
        # we use ``startProcess`` here because we don't want to block!
        discard startProcess(command = b, args = [url], options = {poUsePath})
        return
      except OSError:
        discard

```

On windows, the attacker controls the `lpFile` argument to `shellExecuteW` which may allow opening arbitrary local files.
On MacOs, the attacker controls the first argument to the `open` command which takes the following command line switches:

```
Options:
      -a                Opens with the specified application.
      -b                Opens with the specified application bundle identifier.
      -e                Opens with TextEdit.
      -t                Opens with default text editor.
      -f                Reads input from standard input and opens with TextEdit.
      -F  --fresh       Launches the app fresh, that is, without restoring windows. Saved persistent state is lost, excluding Untitled documents.
      -R, --reveal      Selects in the Finder instead of opening.
      -W, --wait-apps   Blocks until the used applications are closed (even if they were already running).
          --args        All remaining arguments are passed in argv to the application's main() function instead of opened.
      -n, --new         Open a new instance of the application even if one is already running.
      -j, --hide        Launches the app hidden.
      -g, --background  Does not bring the application to the foreground.
      -h, --header      Searches header file locations for headers matching the given filenames, and opens them.
      -s                For -h, the SDK to use; if supplied, only SDKs whose names contain the argument value are searched.
                        Otherwise the highest versioned SDK in each platform is used.

```

If an attacker manages to pass in an URL that is actually a commandline switche to open, they may be able to launch arbitrary commands (or do whatever open allows them to do with one argument). For example, `openDefaultBrowser(".")` will open Finder in the current working dir, `openDefaultBrowser("-aCalculator")` and `openDefaultBrowser("-bcom.apple.calculator")` launches the calculator.

### 2.2 Proof of Concept

launch calculator:

```
import browsers
openDefaultBrowser("-bcom.apple.calculator")

```

terminate the shell quoting causing an error:

```
import browsers
var vector = "-bcom.apple.calculator\x00"
openDefaultBrowser(vector)

```
```
⇒  nim c -r -d:ssl test.nim
sh: -c: line 0: unexpected EOF while looking for matching `''
sh: -c: line 1: syntax error: unexpected end of file

```
### 2.3 Proposed Fix

* validate that URL is actually an URL and filter non printable chars or urlencode them

## 3 Vendor Response

Vendor response: fixed in [v1.2.6](https://nim-lang.org/blog/2020/07/30/versions-126-and-108-released.html) ([Official Security Advisory](https://github.com/nim-lang/security/security/advisories/GHSA-p35j-xv9v-7gfg))

### 3.1 Timeline

```
JUL/09/2020 - contact nim developers @telegram; provided details, PoC
JUL/30/2020 - fixed in new release
MAR/26/2021 - vendor advisory (https://github.com/nim-lang/security/security/advisories/GHSA-p35j-xv9v-7gfg), public disclosure

```
## 4 References

* [1] <https://nim-lang.org/>
* [2] <https://nim-lang.org/install.html>
* [3] [https://en.wikipedia.org/wiki/Nim\_(programming\_language)](https://en.wikipedia.org/wiki/Nim_%28programming_language%29)
* [4] <https://nim-lang.org/blog/2020/07/30/versions-126-and-108-released.html>

![](/images/home/icon-ili-xs.png)

Request a Security Review Today

Get in touch with our team to request a quote for a smart contract audit.

[Contact Us](/contact/)

![](/images/home/icon-ili-outline-white.svg)

[Audits](/audits/ "Audits")
[Fuzzing](/fuzzing/ "Fuzzing")
[Scribble](/scribble/ "Scribble")
[Blog](/blog/ "Blog")
[Tools](/tools/ "Tools")
[Research](/research/ "Research")
[About](/about/ "About")
[Contact](/contact/ "Contact")
[Careers](https://consensys.io/open-roles/?discipline=32525 "Careers")
[Privacy Policy](/privacy-policy/ "Privacy Policy")

Subscribe to Our Newsletter

Stay up-to-date on our latest offerings, tools, and the world of blockchain security.

[![](/images/home/powered-by.svg)](https://consensys.io)



=== Content from consensys.io_03fb8ddc_20250119_140606.html ===

[![Consensys Diligence](/images/logo/fuzzing-logo.svg)](/ "Home")

[Audits](/audits/ "Audits")
[Fuzzing](/fuzzing/ "Fuzzing")
[Scribble](/scribble/ "Scribble")
[Blog](/blog/ "Blog")
[Tools](/tools/ "Tools")
[Research](/research/ "Research")
[About](/about/ "About")
[Contact](/contact/ "Contact")

# Fuzz it.

##### Let's go next level smart contract security with Diligence Fuzzing.

The most powerful fuzzer to find bugs and vulnerabilities before they are exploited by bad actors on mainnet. Combine with Scribble to set a target and unleash the fuzzer with millions of transactions to stress test your smart contract.

[Start Fuzzing](https://fuzzing.diligence.tools/login)
[Explore Scribble](https://consensys.io/diligence/scribble/)

![Fuzzing](https://diligence.consensys.io/fuzzing/fuzzing-hero-side-image.png)

## What the Fuzz?

#### Diligence Fuzzing gray-box property-based Fuzzing

Diligence Fuzzing is the smartest Fuzzer we know. Powered by cutting-edge research, this tool pioneered smart heuristics
to push the boundaries of gray-box fuzzing.
Save some time. We create unit tests AND system tests for you. All
you need to do is deploy your smart contract and unleash the fuzzer. It will
generate sequences of transactions (just like a user or an attacker
would) to cover your code.

[Read Docs](https://fuzzing-docs.diligence.tools/)

Coverage-guided

i.e., greybox fuzzing to build corpus of inputs that increases coverage.

Input Prediction

Our unique input prediction allows to systematically find inputs that will cover new code instead of random mutations.

[Learn more](https://consensys.io/diligence/blog/2018/12/fuzzing-smart-contracts-using-input-prediction/)

Transaction Sequence Simulation

We simulate multiple transaction sequences to test “deeper” interactions between functions.

Time Machine

Time machine to test functionality that may break in the future by simulating different time intervals between transactions

Incremental Fuzzing

Enables quick feedback when starting campaigns on code that was already fuzzed.

Fuzzing Lessons

Allows users to provide specific transaction sequences to increase coverage of critical parts of your code.

![](https://diligence.consensys.io/fuzzing/background-features.jpg)
#### Reporting Features

Comprehensive reporting about your fuzzing campaign.

Campaign Monitoring

Observe the Fuzzer covering more and more of your code while thousands of tests are executed per second. Indications like "Residual Risk" help to determine when to stop a campaign.

![](https://diligence.consensys.io/fuzzing/CoverageScreenshot.png)

Full Control

Whether a short test or extensive campaign, public or private report, single or multiple, parallel campaigns, you have full control over the platform.

![](https://diligence.consensys.io/fuzzing/PropertyViolationScreenshot.png)

Full Report

Find out immediately when a property has been violated. Details about the transaction that triggered a vulnerability help you to fix your code.

![](https://diligence.consensys.io/fuzzing/ReportControlScreenshot.png)

Observe the Fuzzer covering more and more of your code while thousands of tests are executed per second. Indications like "Residual Risk" help to determine when to stop a campaign.

![](https://diligence.consensys.io/fuzzing/CoverageScreenshot.png)

Whether a short test or extensive campaign, public or private report, single or multiple, parallel campaigns, you have full control over the platform.

![](https://diligence.consensys.io/fuzzing/PropertyViolationScreenshot.png)

Find out immediately when a property has been violated. Details about the transaction that triggered a vulnerability help you to fix your code.

![](https://diligence.consensys.io/fuzzing/ReportControlScreenshot.png)

Create a faster, more efficient and secure SDLC

With millions of transactions flowing daily, blockchain
companies need reliable tools to secure the growing internet
of value on the blockchain. Diligence Fuzzing provides:

Fuzzing at scale

Diligence Fuzzing is the only fuzzing solution to cover complex systems of one or more contracts to explore all possible user interactions and vulnerabilities, without the need for harnesses.

Comprehensive Security

Fuzzing minimizes risk and checks performance through the execution of millions of intelligently selected inputs, exploring all possible interactions with users and potential attackers.

Business Logic Integrity

Test business logic at the outset, check for correctness, and find security problems before they steer the ship astray.

Productivity

Code reviews and consecutive bug fixes are time-consuming, with long feedback loops. With Diligence Fuzzing, developers get swift, actionable feedback.

Readability

Scribble annotations of your specs improve an auditor’s ability to find flaws in your smart contracts.

## Start Diligence Fuzzing in 3 steps

Specify properties, submit code, inspect the report.

### Step 1

Define Scribble specifications

To use Diligence Fuzzing you first need to define specifications for your smart contract using Scribble, describing how your smart contracts should work. The fuzzer will use these Scribble properties to check for inconsistencies.

[Read Docs](https://docs.scribble.codes/)

![](https://diligence.consensys.io/fuzzing/Step1ScribbleScreenshot.png)

### Step 2

Submit code

Submit your code to the Diligence Platform to run fuzzing campaigns. We’ll analyze all complex systems of one or more contracts provided to detect violations of custom properties.

[Read Docs](https://fuzzing-docs.diligence.tools/)

![](https://diligence.consensys.io/fuzzing/Step2CliScreenshot.png)

### Step 3

Review the results

Receive campaign results and fix the violations in your code.

![](https://diligence.consensys.io/fuzzing/Step3ViewReportScreenshot.png)

![](https://diligence.consensys.io/fuzzing/Step1ScribbleScreenshot.png)

![](https://diligence.consensys.io/fuzzing/Step2CliScreenshot.png)

![](https://diligence.consensys.io/fuzzing/Step3ViewReportScreenshot.png)

#### Trusted by businesses worldwide.

Our early adopters use Diligence Fuzzing to help secure their projects.

* + > With Diligence Fuzzing, Consensys gave us an amazing framework and capability to seamlessly develop, test and launch our smart contracts that are serving as the foundation for the new space economy.

    Grant Blaisdell

    CEO & Co-Founder of Copernic Space

    ![](https://diligence.consensys.io/fuzzing/TestemonialAvatar1.png)
  + > We deal with multiple clients who often require a fast, trusted and easy to understand service to conduct security audits on their Smart Contracts before they go live. We offer a service that includes the use of Diligence Fuzz tool to facilitate this and it is perfect for the job. Not only is it simple and easy to use, but it provides clear results for action along with quantifiable security guarantees from the Fuzzing process. We really enjoy using Diligence fuzz tool to provide this robust security check as part of our service!

    Tak Fung

    CEO & Founder of Smart Contract Security Limited

    ![](https://diligence.consensys.io/fuzzing/TestemonialAvatar2.png)

#### Simple pricing, for every need.

Get started with a free explorer plan or opt for our professional plans for builders. All plans billed monthly.

### Explorer

For users who want to explore fuzzing as an additional security layer.

#### $0

* 1x Core Performance
* Up to 100 5 min campaigns
* Run 1 Campaign at a time
* Supports Foundry projects

[Get Started](https://fuzzing.diligence.tools/login)

### Builder

For users who are ready to level up their security practices and stress test longer.

#### $250

* 1x Core Performance
* Unlimited 1 hour campaigns
* Run 1 Campaign at a time
* Supports Foundry projects

[Get Started](https://fuzzing.diligence.tools/login)

### Pro Builder

For power users who require serious security, in-depth analysis and no time constraints.

#### $1,999

* 2x Core Performance
* Unlimited Hours and campaigns
* Run 1 Campaign at a time
* Supports Foundry projects

[Get Started](https://fuzzing.diligence.tools/login)

### Enterprise

For larger teams needing multiple licenses, simultaneous campaigns and maximum performance.

#### Custom

* 4x Core Performance
* Unlimited Hours and campaigns
* Run 2 Campaigns at a time
* Supports Foundry projects

[Contact Us](https://share.hsforms.com/1TvCKjmAMTC2gCezqiexVTw2urwb)

![](/images/home/icon-ili-xs.png)

Request a Security Review Today

Get in touch with our team to request a quote for a smart contract audit.

[Contact Us](/contact/)

![](/images/home/icon-ili-outline-white.svg)

[Audits](/audits/ "Audits")
[Fuzzing](/fuzzing/ "Fuzzing")
[Scribble](/scribble/ "Scribble")
[Blog](/blog/ "Blog")
[Tools](/tools/ "Tools")
[Research](/research/ "Research")
[About](/about/ "About")
[Contact](/contact/ "Contact")
[Careers](https://consensys.io/open-roles/?discipline=32525 "Careers")
[Privacy Policy](/privacy-policy/ "Privacy Policy")

Subscribe to Our Newsletter

Stay up-to-date on our latest offerings, tools, and the world of blockchain security.

[![](/images/home/powered-by.svg)](https://consensys.io)



=== Content from github.com_bf7c668e_20250119_122755.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2FNim%2Fblob%2Fdc5a40f3f39c6ea672e6dc6aca7f8118a69dda99%2Flib%2Fpure%2Fbrowsers.nim)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnim-lang%2FNim%2Fblob%2Fdc5a40f3f39c6ea672e6dc6aca7f8118a69dda99%2Flib%2Fpure%2Fbrowsers.nim)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=nim-lang%2FNim)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nim-lang](/nim-lang)
/
**[Nim](/nim-lang/Nim)**
Public

* [Notifications](/login?return_to=%2Fnim-lang%2FNim) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Fnim-lang%2FNim)
* [Star
   16.8k](/login?return_to=%2Fnim-lang%2FNim)

* [Code](/nim-lang/Nim)
* [Issues
  2k](/nim-lang/Nim/issues)
* [Pull requests
  86](/nim-lang/Nim/pulls)
* [Actions](/nim-lang/Nim/actions)
* [Projects
  2](/nim-lang/Nim/projects)
* [Wiki](/nim-lang/Nim/wiki)
* [Security](/nim-lang/Nim/security)
* [Insights](/nim-lang/Nim/pulse)

Additional navigation options

* [Code](/nim-lang/Nim)
* [Issues](/nim-lang/Nim/issues)
* [Pull requests](/nim-lang/Nim/pulls)
* [Actions](/nim-lang/Nim/actions)
* [Projects](/nim-lang/Nim/projects)
* [Wiki](/nim-lang/Nim/wiki)
* [Security](/nim-lang/Nim/security)
* [Insights](/nim-lang/Nim/pulse)

## Files

 dc5a40f
## Breadcrumbs

1. [Nim](/nim-lang/Nim/tree/dc5a40f3f39c6ea672e6dc6aca7f8118a69dda99)
2. /[lib](/nim-lang/Nim/tree/dc5a40f3f39c6ea672e6dc6aca7f8118a69dda99/lib)
3. /[pure](/nim-lang/Nim/tree/dc5a40f3f39c6ea672e6dc6aca7f8118a69dda99/lib/pure)
/
# browsers.nim

Copy path Blame  Blame
## Latest commit

## History

[History](/nim-lang/Nim/commits/dc5a40f3f39c6ea672e6dc6aca7f8118a69dda99/lib/pure/browsers.nim)81 lines (72 loc) · 2.76 KB dc5a40f
## Breadcrumbs

1. [Nim](/nim-lang/Nim/tree/dc5a40f3f39c6ea672e6dc6aca7f8118a69dda99)
2. /[lib](/nim-lang/Nim/tree/dc5a40f3f39c6ea672e6dc6aca7f8118a69dda99/lib)
3. /[pure](/nim-lang/Nim/tree/dc5a40f3f39c6ea672e6dc6aca7f8118a69dda99/lib/pure)
/
# browsers.nim

Top
## File metadata and controls

* Code
* Blame

81 lines (72 loc) · 2.76 KB[Raw](https://github.com/nim-lang/Nim/raw/dc5a40f3f39c6ea672e6dc6aca7f8118a69dda99/lib/pure/browsers.nim)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081### Nim's Runtime Library# (c) Copyright 2012 Andreas Rumpf## See the file "copying.txt", included in this# distribution, for details about the copyright.#
## This module implements a simple proc for opening URLs with the user's## default browser.#### Unstable API.
import std/private/since
import strutils
when defined(windows): import winleanelse: import os, osproc
const osOpenCmd\* = when defined(macos) or defined(macosx) or defined(windows): "open" else: "xdg-open" ## \ ## Alias for the operating system specific \*"open"\* command, ## ``"open"`` on OSX, MacOS and Windows, ``"xdg-open"`` on Linux, BSD, etc.
template openDefaultBrowserImpl(url: string) = when defined(windows): var o = newWideCString(osOpenCmd) var u = newWideCString(url) discard shellExecuteW(0'i32, o, u, nil, nil, SW\_SHOWNORMAL) elif defined(macosx): discard execShellCmd(osOpenCmd & " " & quoteShell(url)) else: var u = quoteShell(url) if execShellCmd(osOpenCmd & " " & u) == 0: return for b in getEnv("BROWSER").string.split(PathSep): try: # we use ``startProcess`` here because we don't want to block! discard startProcess(command = b, args = [url], options = {poUsePath}) return except OSError: discard
proc openDefaultBrowser\*(url: string) = ## Opens `url` with the user's default browser. This does not block. ## The URL must not be empty string, to open on a blank page see `openDefaultBrowser()`. ## ## Under Windows, ``ShellExecute`` is used. Under Mac OS X the ``open`` ## command is used. Under Unix, it is checked if ``xdg-open`` exists and ## used if it does. Otherwise the environment variable ``BROWSER`` is ## used to determine the default browser to use. ## ## This proc doesn't raise an exception on error, beware. ## ## .. code-block:: nim ## block: openDefaultBrowser("https://nim-lang.org") doAssert url.len > 0, "URL must not be empty string" openDefaultBrowserImpl(url)
proc openDefaultBrowser\*() {.since: (1, 1).} = ## Opens the user's default browser without any `url` (blank page). This does not block. ## Implements IETF RFC-6694 Section 3, "about:blank" must be reserved for a blank page. ## ## Under Windows, ``ShellExecute`` is used. Under Mac OS X the ``open`` ## command is used. Under Unix, it is checked if ``xdg-open`` exists and ## used if it does. Otherwise the environment variable ``BROWSER`` is ## used to determine the default browser to use. ## ## This proc doesn't raise an exception on error, beware. ## ## \*\*See also:\*\* ## ## \* https://tools.ietf.org/html/rfc6694#section-3 ## ## .. code-block:: nim ## block: openDefaultBrowser() openDefaultBrowserImpl("http:about:blank") # See IETF RFC-6694 Section 3.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


