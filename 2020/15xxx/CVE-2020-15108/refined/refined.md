```
{
  "CVE-2020-15108": {
    "related": true,
    "summary": "The vulnerability is a SQL injection present in the clone feature of GLPI. The vulnerability exists because the fields are not properly escaped before being used in the SQL query for cloning objects.",
    "details": {
      "root_cause": "The root cause is the lack of proper escaping of input data when cloning items. Specifically, the 'clone' function in `commondbtm.class.php` and `calendar.class.php` was not properly sanitizing input fields before using them in SQL queries during the cloning process.",
      "vulnerabilities": [
        "SQL Injection"
      ],
       "impact": "Successful exploitation allows an attacker to inject arbitrary SQL queries, potentially leading to data exfiltration, modification, or other unauthorized actions. In the given example, the attacker was able to inject a SQL query to extract the password of the 'glpi' user from the database into the comment field of the cloned rule.",
      "attack_vectors": [
        "The attack vector is the 'clone' feature available for various objects within the GLPI application. This feature is accessible to authenticated users and can be triggered via the massive actions functionality.",
        "Specifically, the vulnerability is triggered by providing a malicious string in any field that's cloned using the vulnerable functions."
      ],
      "attacker_capabilities": "The attacker needs to be an authenticated user of the GLPI application with the ability to use the clone feature (through massive actions). They would also need to be able to create or modify objects that have fields vulnerable to this SQL injection when cloned.",
      "patches": [
        "The patch involves adding `Toolbox::addslashes_deep()` to sanitize the input fields in the clone function of `calendar.class.php` and `commondbtm.class.php` before using them in the SQL query."
         , "The commit a4baa64114eb92fd2adf6056a36e0582324414ba fixes this vulnerability by sanitizing data using `Toolbox::addslashes_deep` before performing a clone operation."
      ]
    }
  }
}
```