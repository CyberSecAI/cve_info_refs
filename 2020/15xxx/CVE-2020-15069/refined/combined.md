=== Content from community.sophos.com_0cd64975_20250119_125811.html ===


[![Sophos Community](https://community.sophos.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/widgetcontainerfiles-3fc3f82483d14ec485ef92e206116d49-s-AAAAAAAAAAAAAAAAAAAAAA-header-header-Z_2D00_IDKephE0KP_2D00_tiVeHl0_5F00_w-logo/Sophos-Community-Logo-April-2021-White-_2D00_-250x52.png_2D00_125x44.png?_=638693588173209557)](https://community.sophos.com/ "Home")

Sophos Community

* [User](/login?ReturnUrl=%2Fb%2Fsecurity-blog%2Fposts%2Fadvisory-buffer-overflow-vulnerability-in-user-portal "Join or sign in")

* Site
* Search
* [User](/login?ReturnUrl=%2Fb%2Fsecurity-blog%2Fposts%2Fadvisory-buffer-overflow-vulnerability-in-user-portal)
* Toggle Mobile menu

* Community & Product Forums
* Blogs
* Partners
* Events & Webinars
* Getting Started
* [Support Portal](https://support.sophos.com/support/s/)

* Community Blogs
  + [Application Control](/sophos-labs/b/application-control)
  + [Community](/b/community-blog)
  + [Product documentation](/product-documentation/b/blog)
  + [Security](/b/security-blog)
* Feedback
  + [Support Portal](/support-portal/)
  + [Product documentation](/product-documentation/)

* Products
  + Endpoint security
    - [Sophos Endpoint](/intercept-x-endpoint/)
    - [Sophos XDR](/sophos-xdr/)
    - [Sophos Mobile](/sophos-mobile/)
  + Network Security
    - [Sophos Firewall](/sophos-xg-firewall/)
    - [ZTNA](/zero-trust-network-access/)
    - [Sophos Switch](/sophos-switch/)
    - [UTM Firewall](/utm-firewall/)
    - [Sophos Wireless](/sophoswireless/)
    - [NDR](/ndr-community-channel/)
  + Email Security
    - [Sophos
      Email](/sophos-email/)
    - [Phish
      Threat](/phish-threat/)
  + Cloud Security
    - [Sophos Central](/sophos-central/)
    - [Sophos Cloud Optix](/sophos-cloud-optix/)
  + Support Tools
    - [Sophos integrations](/sophos-integrations/)
    - [Free tools](/free-tools/)
* Services
  + Management platform
    - [Sophos Central](https://central.sophos.com/manage/login)
    - [Support Portal](https://support.sophos.com)
    - [Sophos Community log in](/login?ReturnUrl=%2F)

* Sophos Partners
  + [Partners blog](/sophos-partners/b)
  + [Local Partner community](/sophos-partners/subgrouplist)
  + [Partner news](https://partnernews.sophos.com/en-us/)
* Resources
  + [MSP guides](/sophos-partners/b)
  + [Partner Care](https://www.sophos.com/en-us/partners/partner-care)
  + [Sophos Central](https://central.sophos.com/manage/login)
* Webinars & Events
  + [Webinars & Events](/sophos-partners/b/webinars-and-events)
  + [Calendar](/sophos-partners/c/14#pifragment-3086=1)
* Become a partner
  + [Join our
    program](/login?ReturnUrl=%2F)

* Events & Webinars
  + [Events & Webinars](/b/events-and-webinars)
  + [Calendar](/c/19#pifragment-3262=1)

* Getting started in the Community
  + [How to get started](/w/getting-started)
  + [SophosID registration](/w/getting-started/90/sophosid-registration)
  + [How to set up your profile](/w/getting-started/88/sophos-community-how-to-set-up-your-profile)
  + [How to contribute and participate](/w/getting-started/86/sophos-community-how-to-contribute-and-participate)
  + [How to manage private messages](/w/getting-started/89/sophos-community-how-to-manage-private-messages)
* Member recognition
  + [Rewards program](/w/member-recognition)
  + [Leaderboard](/leaders)

* Products and Services
  + Products
    - Endpoint security
      * [Sophos Endpoint](/intercept-x-endpoint/)
      * [Sophos XDR](/sophos-xdr/)
      * [Sophos Mobile](/sophos-mobile/)
    - Network Security
      * [Sophos Firewall](/sophos-xg-firewall/)
      * [ZTNA](/zero-trust-network-access/)
      * [Sophos Switch](/sophos-switch/)
      * [UTM Firewall](/utm-firewall/)
      * [Sophos Wireless](/sophoswireless/)
      * [NDR](/ndr-community-channel/)
    - Email Security
      * [Sophos
        Email](/sophos-email/)
      * [Phish
        Threat](/phish-threat/)
    - Cloud Security
      * [Sophos Central](/sophos-central/)
      * [Sophos Cloud Optix](/sophos-cloud-optix/)
    - Support Tools
      * [Sophos integrations](/sophos-integrations/)
      * [Free tools](/free-tools/)
  + Services
    - Management platform
      * [Sophos Central](https://central.sophos.com/manage/login)
      * [Support Portal](https://support.sophos.com)
      * [Sophos Community log in](/login?ReturnUrl=%2F)
* Blogs
  + Community Blogs
    - [Application Control](/sophos-labs/b/application-control)
    - [Community](/b/community-blog)
    - [Product documentation](/product-documentation/b/blog)
    - [Security](/b/security-blog)
  + Feedback
    - [Support Portal](/support-portal/)
    - [Product documentation](/product-documentation/)
* Partners
  + Sophos Partners
    - [Partners blog](/sophos-partners/b)
    - [Local Partner community](/sophos-partners/subgrouplist)
    - [Partner news](https://partnernews.sophos.com/en-us/)
  + Resources
    - [MSP guides](/sophos-partners/b)
    - [Partner Care](https://www.sophos.com/en-us/partners/partner-care)
    - [Sophos Central](https://central.sophos.com/manage/login)
  + Webinars & Events
    - [Webinars & Events](/sophos-partners/b/webinars-and-events)
    - [Calendar](/sophos-partners/c/14#pifragment-3086=1)
  + Become a partner
    - [Join our
      program](/login?ReturnUrl=%2F)
* Events & Webinars
  + Events & Webinars
    - [Events & Webinars](/b/events-and-webinars)
    - [Calendar](/c/19#pifragment-3262=1)
* Getting Started
  + Getting started in the Community
    - [How to get started](/w/getting-started)
    - [SophosID registration](/w/getting-started/90/sophosid-registration)
    - [How to set up your profile](/w/getting-started/88/sophos-community-how-to-set-up-your-profile)
    - [How to contribute and participate](/w/getting-started/86/sophos-community-how-to-contribute-and-participate)
    - [How to manage private messages](/w/getting-started/89/sophos-community-how-to-manage-private-messages)
  + Member recognition
    - [Rewards program](/w/member-recognition)
    - [Leaderboard](/leaders)
* [Support Portal](https://support.sophos.com/support/s/)

* [Community Blog](/b)
* [Member Recognition](/w/member-recognition)
* More
* Cancel

[![Sophos Community](https://community.sophos.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/communityserver-components-groupavatars-00-00-00-00-01/general_2D00_136x136.png.png_2D00_68x68x2.png?_=636112569604607682)](https://community.sophos.com/)

[Sophos Community](https://community.sophos.com/)

[Community Security Blog](https://community.sophos.com/b/security-blog)

[Advisory: Buffer overflow in XG Firewall v17.x User Portal](https://community.sophos.com/b/security-blog/posts/advisory-buffer-overflow-vulnerability-in-user-portal)

* [Blogs](/b)
* [Calendars](/c/19)
* More
* Cancel

* [New](/login?ReturnUrl=%2Fb%2Fsecurity-blog%2Fposts%2Fadvisory-buffer-overflow-vulnerability-in-user-portal)

# [Advisory: Buffer overflow in XG Firewall v17.x User Portal](https://community.sophos.com/b/security-blog/posts/advisory-buffer-overflow-vulnerability-in-user-portal)

* Subscribe by email
* More
* Cancel

Options

* Subscribe by email
* More
* Cancel

* Share
* Subscribe by email
* More
* Cancel

Related

[![Craig Paradis](https://community.sophos.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/system-images/anonymous.gif_2D00_80x80x2.png?_=638032664833258022)](/members/craig-paradis)

[Craig Paradis](/members/craig-paradis)

25 Jun 2020

## Overview

Sophos discovered an XG Firewall v17.x vulnerability regarding access to physical and virtual units configured with the user portal exposed on the WAN. This was a previously unknown buffer overflow vulnerability in the user portal HTTP/S bookmark feature.

Sophos quickly responded and remediated with a hotfix that removes the HTTP/S bookmark functionality for all XG Firewalls running SFOS v17.x. XG Firewall v18 was not impacted.

## Applies to the following Sophos product(s) and version(s)

* Sophos XG Firewall v17.5 MR12 and earlier
* You will receive an email from Sophos if any action is required

## Remediation

* Ensure you are running a supported version of XG Firewall
* Hotfix HF062020.1 was published for all firewalls running v17.x
* Additionally, Sophos recommends that XG Firewall customers [upgrade to SFOS v18](http://docs.sophos.com/nsg/sophos-firewall/18.0/Help/en-us/webhelp/onlinehelp/nsg/sfos/concepts/AvailableFirmware.html)

Sophos strongly recommends following industry best practices and the additional steps below to fully remediate the issue:

1. Reset device administrator accounts
   * See: [https://community.sophos.com/kb/en-us/123732](/kb/en-us/123732)
2. Reset passwords for all local user accounts
   * How to identify Local, AD, and Guest users: [https://community.sophos.com/kb/en-us/135419](/kb/en-us/135419)
   * Local user password reset: [https://community.sophos.com/kb/en-us/135493](/kb/en-us/135493)
   * How to change the password for local users from the User Portal: [https://community.sophos.com/kb/en-us/135495](/kb/en-us/135495)
3. Disable User Portal access on the WAN unless necessary
   * How to disable User Portal access on WAN: [https://community.sophos.com/kb/en-us/135414](/kb/en-us/135414)

## Related information

* CVE-2020-15069: <https://nvd.nist.gov/vuln/detail/CVE-2020-15069>
* Ensure that you have enabled the automatic installation of hotfixes: [https://community.sophos.com/kb/en-us/135415](/kb/en-us/135415)
* Related Community post: [https://community.sophos.com/products/xg-firewall/f/network-and-routing/121486/user-portal-disabled-across-multiple-xg-firewalls-by-cli-user/#pi2151filter=answers&pi2151scroll=false](/products/xg-firewall/f/network-and-routing/121486/user-portal-disabled-across-multiple-xg-firewalls-by-cli-user/#pi2151filter=answers&pi2151scroll=false)

* [![Karim Amin](https://community.sophos.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/system-images/anonymous.gif_2D00_44x44x2.png?_=638032713588932675)](/members/karim-amin)

  [Karim Amin](/members/karim-amin)

  [over 4 years ago](https://community.sophos.com/b/security-blog/posts/advisory-buffer-overflow-vulnerability-in-user-portal?CommentId=76f8f189-6eef-48cd-8d29-e16cfea80456)

  Is this issue can affect on SSL vpn remote connection ?

  + Cancel

  + Vote Up
    0
    Vote Down
  + More
  + Cancel
* [![Jakob P](https://community.sophos.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/system-images/anonymous.gif_2D00_44x44x2.png?_=638032713588932675)](/members/jakob-p)

  [Jakob P](/members/jakob-p)

  [over 4 years ago](https://community.sophos.com/b/security-blog/posts/advisory-buffer-overflow-vulnerability-in-user-portal?CommentId=8e8d8bc8-2c43-47f9-9f2b-508bc4fadf2e)

  @Michael Pasqualone what if you create it as local ACL. Im pretty sure, it would stay active.

  + Cancel

  + Vote Up
    0
    Vote Down
  + More
  + Cancel
* [![Michael Pasqualone](https://community.sophos.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/system-images/anonymous.gif_2D00_44x44x2.png?_=638032713588932675)](/members/michael-pasqualone)

  [Michael Pasqualone](/members/michael-pasqualone)

  [over 4 years ago](https://community.sophos.com/b/security-blog/posts/advisory-buffer-overflow-vulnerability-in-user-portal?CommentId=0bd8d9fa-75cd-408e-b9f0-e383075bbb38)

  [Jakob P](/members/jakob-p) Even after re-enabling it, which we've done on 2 XGs, it's automatically disabling itself sometime later. We're constantly having to re-enable it.

  + Cancel

  + Vote Up
    0
    Vote Down
  + More
  + Cancel
* [![alozzy](https://community.sophos.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/system-images/anonymous.gif_2D00_44x44x2.png?_=638032713588932675)](/members/alozzy)

  [alozzy](/members/alozzy)

  [over 4 years ago](https://community.sophos.com/b/security-blog/posts/advisory-buffer-overflow-vulnerability-in-user-portal?CommentId=d9d0f81b-1a79-4354-9b50-001f23fbab4c)

  Sophos' communication on this has been very poor...

  This article:

  [community.sophos.com/.../advisory-buffer-overflow-vulnerability-in-user-portal](https://community.sophos.com/b/security-blog/posts/advisory-buffer-overflow-vulnerability-in-user-portal)

  Advises:

  Applies to the following Sophos product(s) and version(s): Sophos XG Firewall v17.5 MR12 and earlier

  You will receive an email from Sophos if any action is required

  Which implies, for instance, that MR-10.HF062020.1 (ie MR-10 with the HF602020.1 hotfix applied) is not sufficient to mitigate the vulnerability and that a firmware version >17.5 MR12 is required.

  In direct contrast, this article:

  [community.sophos.com/.../sophos-xg-firewall-http-s-bookmarks-feature-retirement](https://community.sophos.com/products/xg-firewall/b/blog/posts/sophos-xg-firewall-http-s-bookmarks-feature-retirement)

  Advises that the HTTP/S bookmarks feature has been retired in Sophos XG v17.x, via hotfix HF062020.1.

  Furthermore, the CVE ([nvd.nist.gov/.../CVE-2020-15069)](https://nvd.nist.gov/vuln/detail/CVE-2020-15069%29) states:

  "allows a Buffer Overflow and remote code execution via the HTTP/S Bookmarks feature for clientless access. Hotfix HF062020.1 was published for all firewalls running v17.x"

  So, those two references imply that only the hotfix HF062020.1 needs to be installed for any 17.x firmware version, in order to mitigate the vulnerability.

  So which is accurate? If the former, then there doesn't appear to be a firmware version for 17.x that's newer than 17.5 MR12, so everyone has to upgrade to v18?

  + Cancel

  + Vote Up
    0
    Vote Down
  + More
  + Cancel
* [![Jakob P](https://community.sophos.com/cfs-filesystemfile/__key/communityserver-components-imagefileviewer/system-images/anonymous.gif_2D00_44x44x2.png?_=638032713588932675)](/members/jakob-p)

  [Jakob P](/members/jakob-p)

  [over 4 years ago](https://community.sophos.com/b/security-blog/posts/advisory-buffer-overflow-vulnerability-in-user-portal?CommentId=d5a0bbf3-5287-40a9-ac5a-87faa24a5a1d)

  [Michael Pasqualone](/members/michael-pasqualone)

  They disabled the UserPortal, you would have to reenable it...

  + Cancel

  + Vote Up
    0
    Vote Down
  + More
  + Cancel

[>](/b/security-blog/posts/advisory-buffer-overflow-vulnerability-in-user-portal?pifragment-3489=2)

Unfiltered HTML

* [Getting started](https://community.sophos.com/w/getting-started)
* [Legal](https://www.sophos.com/en-us/legal.aspx)
* [Privacy](https://www.sophos.com/en-us/legal/sophos-group-privacy-notice.aspx)
* [Cookies](https://www.sophos.com/en-us/legal/cookie-information.aspx)

Â© 1997 - 2025 Sophos Ltd. All rights reserved.


