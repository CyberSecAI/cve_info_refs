=== Content from github.com_80e8af79_20250119_124010.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjazzband%2Fdjango-two-factor-auth%2Fblob%2Fmaster%2FCHANGELOG.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjazzband%2Fdjango-two-factor-auth%2Fblob%2Fmaster%2FCHANGELOG.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=jazzband%2Fdjango-two-factor-auth)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jazzband](/jazzband)
/
**[django-two-factor-auth](/jazzband/django-two-factor-auth)**
Public

* [Notifications](/login?return_to=%2Fjazzband%2Fdjango-two-factor-auth) You must be signed in to change notification settings
* [Fork
  448](/login?return_to=%2Fjazzband%2Fdjango-two-factor-auth)
* [Star
   1.7k](/login?return_to=%2Fjazzband%2Fdjango-two-factor-auth)

* [Code](/jazzband/django-two-factor-auth)
* [Issues
  86](/jazzband/django-two-factor-auth/issues)
* [Pull requests
  23](/jazzband/django-two-factor-auth/pulls)
* [Actions](/jazzband/django-two-factor-auth/actions)
* [Projects
  0](/jazzband/django-two-factor-auth/projects)
* [Security](/jazzband/django-two-factor-auth/security)
* [Insights](/jazzband/django-two-factor-auth/pulse)

Additional navigation options

* [Code](/jazzband/django-two-factor-auth)
* [Issues](/jazzband/django-two-factor-auth/issues)
* [Pull requests](/jazzband/django-two-factor-auth/pulls)
* [Actions](/jazzband/django-two-factor-auth/actions)
* [Projects](/jazzband/django-two-factor-auth/projects)
* [Security](/jazzband/django-two-factor-auth/security)
* [Insights](/jazzband/django-two-factor-auth/pulse)

## Files

 master
## Breadcrumbs

1. [django-two-factor-auth](/jazzband/django-two-factor-auth/tree/master)
/
# CHANGELOG.md

Copy path Blame  Blame
## Latest commit

## History

[History](/jazzband/django-two-factor-auth/commits/master/CHANGELOG.md)305 lines (238 loc) · 8.77 KB master
## Breadcrumbs

1. [django-two-factor-auth](/jazzband/django-two-factor-auth/tree/master)
/
# CHANGELOG.md

Top
## File metadata and controls

* Preview
* Code
* Blame

305 lines (238 loc) · 8.77 KB[Raw](https://github.com/jazzband/django-two-factor-auth/raw/refs/heads/master/CHANGELOG.md)
# Changelog

## 1.17.0

### Fixed

* Fixed the XML syntax of the Twilio token.xml file.
* The Yubikey token field is now receiving autofocus.
* Avoid crashes for devices with no `throttle_*` methods (#699).
* Fixed format of the hash for the OTP device cookie key.

### Changed

* Allow django-phonenumber-field 8.x.x.
* Project build is now using a more modern toolbox based on `pyproject.toml` (no
  more setup.\*).
* The plugins method registry can now return a new `MethodNotFoundError`
  exception when some method is not found in the plugins registry.

### Added

* Support confirmation for Django 5.1.
* The login view is also decorated with the `login_not_required` decorator for
  projects using the new `LoginRequiredMiddleware` available with Django 5.1+.

### Removed

* Dropped support for Django <4.2.
* Removed custom `utils.class_view_decorator()` in favor of Django's
  `method_decorator()`.

## 1.16.0

### Fixed

* Avoid potentially empty `<ul>` on the profile page.

### Changed

* Upgraded minimal webauthn dependency to 2.0 (which also removes a deprecation
  warning) (#634, #701). Note the `pydantic` dependency was removed in
  webauthn 2.
* Checking phone method availability uses now the method registry (#665).
* Logout example uses POST method to match recent Django behavior.
* Updated translations.

### Added

* Support confirmation for Django 5.0 and Python 3.12.
* A new `main_form_content` template block on login template allows for easier
  overridability.

## 1.15.5

### Fixed

* Include transitively replaced migrations in phonenumber migration.
* Avoid importing PhoneDevice when not enabled.
* Simplified URLs for phone\_create/phone\_delete paths.
* Implement strict PhoneDevice identification (#661).
* Avoid multiple registrations of the same method (#657).
* Get all phonedevices of the user (#659).

### Changed

* Allow django-phonenumber-field 7.
* Updated Dutch, German, and Spanish translations.

### Removed

* Python 3.7 support (EOL).

## 1.15.4

### Fixed

* Corrected migration dependency (introduced in 6150a782b6e6).
* Fixed throttling for PhoneDevice (#418).

## 1.15.3

### Added

* Added Turkish translation.

### Fixed

* Fixed a PhoneDevice migration generated even when the phonenumber plugin was
  not installed (#587).
* Created a custom phonenumber migration to allow migration for both when the
  model already exists (legacy installs) and for new installs (#611).

## 1.15.2

### Added

* Confirmed Django 4.2 support

### Fixed

* Set `default_auto_field` to `AutoField` in apps config that have models,
  so no migrations are generated for projects defaulting to `BigAutoField` (#436).
* [webauthn] Drop unneeded unique index on `public_key`, which was unsupported
  on MySQL (#594).

## 1.15.1

### Fixed

* Missing plugin templates (#583).
* Migrations of `two_factor` app are squashed to avoid requiring `phonenumber_field`
  optional dependency for new projects.

### Changed

* Updated Finish and French translations.

## 1.15.0

### Added

* Enforcing a redirect to setup of otp device when none available for user (#499)
* Confirmed Django 4.1 support
* WebAuthn support (thanks to Javier Paniagua)
* Confirmed Python 3.11 support

### Changed

* Display the TOTP secret key alongside the QR code to streamline setup for
  password managers without QR support.
* Moved phonenumber migrations under the plugins directory.
* Avoid crash with email devices without email (#530).

### Removed

* Django 2.2, 3.0, and 3.1 support
* `two_factor.utils.get_available_methods()` is replaced by
  `MethodRegistry.get_methods()`.

## 1.14.0

### Added

* Python 3.10 support
* The setup view got a new `secret_key` context variable to be able to display
  that key elsewhere than in the QR code.
* The token/device forms have now an `idempotent` class variable to tell if the
  form can validate more than once with the same input data.
* A new email plugin (based on django\_otp `EmailDevice`) can now be activated
  and used to communicate the second factor token by email.

### Changed

* BREAKING: The phone capability moved to a plugins folder, so if you use that
  capability and want to keep it, you should add `two_factor.plugins.phonenumber`
  line in your `INSTALLED_APPS` setting. Additionally, as the `two_factor`
  templatetags library was only containing phone-related filters, the library
  was renamed to `phonenumber`.
* default\_device utility function now caches the found device on the given user
  object.
* The `otp_token` form field for `AuthenticationTokenForm` is now a Django
  `RegexField` instead of an `IntegerField`.
* The Twilio gateway content for phone interaction is now template-based, and
  the pause between digits is now using the `<Pause>` tag.
* The QR code now always uses a white background to support pages displayed
  with a dark theme.

### Removed

* Python 3.5 and 3.6 support

## 1.13.2

### Added

* Translations for new languages: Hausa, Japanese, Vietnamese
* Django 4.0 support

### Changed

* Suppressed default\_app\_config warning on Django 3.2+
* qrcode dependency limit upped to 7.99 and django-phonenumber-field to 7
* When validating a TOTP after scanning the QR code, allow a time drift of +/-1 instead of just -1

## 1.13.1

### Add

* Support Twilio Messaging Service SID
* Add autofocus, autocomplete one-time-code and inputmode numeric to token input fields

### Changed

* Change "Back to Profile" to "Back to Account Security"

## 1.13.0

### Added

* User can request that two-factor authentication be skipped the next time they
  log in on that particular device
* Django 3.1 support
* SMS message can now be customised by using a template

### Changed

* Simplified `re_path()` to `path()` in URLConf
* Templates are now based on Bootstrap 4.
* `DisableView` now checks user has verified before disabling two-factor on
  their account
* Inline CSS has been replaced to allow stricter Content Security Policies.

### Removed

* Upper limit on django-otp dependency
* Obsolete IE<9 workarounds
* Workarounds for older versions of django-otp

## 1.12.1 - 2020-07-08

*No code changes for this version*

## 1.12 - 2020-07-08

### Added

* It is possible to set a timeout between a user authenticiating in the
  `LoginView` and them needing to re-authenticate. By default this is 10
  minutes.

### Removed

* The final step in the `LoginView` no longer re-validates a user's credentials.
* Django 1.11 support.

### Changed

* Security Fix: `LoginView` no longer stores credentials in plaintext in the
  session store.

## 1.11.0 - 2020-03-13

### Added

*Nothing has been added for this version*

### Removed

* MiddlewareMixin
* Python 3.4 support
* Django 2.1 support
* `mock` dependency

### Changed

* `extra_requires` are now listed in lowercase. This is to workaround a bug in `pip`.
* Use `trimmed` option on `blocktrans` to avoid garbage newlines in translations.
* `random_hex` from `django_otp` 0.8.0 will always return a `str`, don't try to decode it.

## 1.10.0 - 2019-12-13

### Added

* Support for Django 3.0.
* Optionally install full or light phonenumbers library.

### Removed

* Python 2 support.

### Changed

* Updated translations.

## 1.9.1 - 2019-07-07

### Changed

* 1.9.0 got pushed with incorrect changelog, no other changes.

## 1.9.0 - 2019-07-07

### Added

* Support for Django 2.2.
* Ability to create `PhoneDevice` from Django admin.
* Support for Python 3.7.

## 1.8.0 - 2018-08-03

### Added

* Support for Django 2.1.
* Support for QRcode library up to 6.
* Translation: Romanian.

### Changed

* Replace `ValidationError` with `SuspiciousOperation` in views.
* Change the wording in 2FA disable template.
* Updated translations.

## 1.7.0 - 2017-12-19

### Added

* Support for Django 2.0.

### Removed

* Django <1.11 support.

### Changed

* Do not list phone method if it is not supported (#225).
* Pass request kwarg to authentication form (#227).

## 1.6.2 - 2017-07-29

### Fixed

* Twilio client 6.0 usage (#211).

### Changed

* Updated translation: Russian.

## 1.6.1 - 2017-05-11

### Added

* Support Twilio client 6.0 (#203).

### Fixed

* `redirect_to` after successful login (#204)

### Changed

* Updated translation: Norwegian Bokmål

## 1.6.0 - 2017-04-08

### Added

* Support for Django 1.11 (#188).

### Removed

* Django 1.9 support.

### Fixed

* Allow setting `LOGIN_REDIRECT_URL` to a URL (#192).
* `DisableView` should also take `success_url` parameter (#187).

## 1.5.0 - 2017-01-04

### Added

* Django 1.10’s MIDDLEWARE support.
* Allow `success_url` overrides from `urls.py`.
* Autofocus token input during authentication.
* Translations: Polish, Italian, Hungarian, Finnish and Danish.

### Removed

* Dropped Python 3.2 and 3.3 support.

### Changed

* Renamed `redirect_url` properties to `success_url` to be consistent with Django.

### Fixed

* Allow Firefox users to enter backup tokens (#177).
* Allow multiple requests for QR code (#99).
* Don't add phone number without gateway (#92).
* Redirect to 2FA profile page after removing a phone (#159).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_1f3b5531_20250119_124012.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjazzband%2Fdjango-two-factor-auth%2Fcommit%2F454fd9842fa6e8bb772dbf0943976bc8e3335359)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjazzband%2Fdjango-two-factor-auth%2Fcommit%2F454fd9842fa6e8bb772dbf0943976bc8e3335359)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=jazzband%2Fdjango-two-factor-auth)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jazzband](/jazzband)
/
**[django-two-factor-auth](/jazzband/django-two-factor-auth)**
Public

* [Notifications](/login?return_to=%2Fjazzband%2Fdjango-two-factor-auth) You must be signed in to change notification settings
* [Fork
  448](/login?return_to=%2Fjazzband%2Fdjango-two-factor-auth)
* [Star
   1.7k](/login?return_to=%2Fjazzband%2Fdjango-two-factor-auth)

* [Code](/jazzband/django-two-factor-auth)
* [Issues
  86](/jazzband/django-two-factor-auth/issues)
* [Pull requests
  23](/jazzband/django-two-factor-auth/pulls)
* [Actions](/jazzband/django-two-factor-auth/actions)
* [Projects
  0](/jazzband/django-two-factor-auth/projects)
* [Security](/jazzband/django-two-factor-auth/security)
* [Insights](/jazzband/django-two-factor-auth/pulse)

Additional navigation options

* [Code](/jazzband/django-two-factor-auth)
* [Issues](/jazzband/django-two-factor-auth/issues)
* [Pull requests](/jazzband/django-two-factor-auth/pulls)
* [Actions](/jazzband/django-two-factor-auth/actions)
* [Projects](/jazzband/django-two-factor-auth/projects)
* [Security](/jazzband/django-two-factor-auth/security)
* [Insights](/jazzband/django-two-factor-auth/pulse)

## Commit

[Permalink](/jazzband/django-two-factor-auth/commit/454fd9842fa6e8bb772dbf0943976bc8e3335359)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-vhr6-pvjm-9qwf](https://github.com/advisories/GHSA-vhr6-pvjm-9qwf "GHSA-vhr6-pvjm-9qwf")

[Browse files](/jazzband/django-two-factor-auth/tree/454fd9842fa6e8bb772dbf0943976bc8e3335359)
Browse the repository at this point in the history

```
Discontinue storing credentials in the session store
```

* Loading branch information

[![@Bouke](https://avatars.githubusercontent.com/u/235882?s=40&v=4)](/Bouke)

[Bouke](/jazzband/django-two-factor-auth/commits?author=Bouke "View all commits by Bouke")
authored
Jul 8, 2020

2 parents
[a5b588a](/jazzband/django-two-factor-auth/commit/a5b588a4bc62f22bcc08d09abc418417298084a2)
+
[fb9ee19](/jazzband/django-two-factor-auth/commit/fb9ee1962e07bb07546ee4155e0aee5892638b9d)

commit 454fd98

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**230 additions**
and
**34 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* docs

  + docs/configuration.rst
    [configuration.rst](#diff-68a31565c7f34fbe6ac80bbc0b4287ee3711fa615ce5b973c1f83f285d0d28fa)
* tests

  + tests/test\_views\_login.py
    [test\_views\_login.py](#diff-b86f7e3dd2271bb79454bf88ea4bfcfff331aae80413fd2c91099b169e02b370)
* two\_factor/views

  + two\_factor/views/core.py
    [core.py](#diff-47e9cf2bbbe1952606db449365a94f378e479389cc4c53d52310ceed0605646d)
  + two\_factor/views/utils.py
    [utils.py](#diff-7a6d275f31a62df689436975d137fe0c42cb681dd901e9594d9b844f5e46a60f)

## There are no files selected for viewing

8 changes: 8 additions & 0 deletions

8
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/jazzband/django-two-factor-auth/blob/454fd9842fa6e8bb772dbf0943976bc8e3335359/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,4 +1,12 @@ |
|  |  | ## [Unreleased] |
|  |  | ### Added |
|  |  | - It is possible to set a timeout between a user authenticiating in the LoginView and them needing to re-authenticate. By default this is 10 minutes. |
|  |  |  |
|  |  | ### Removed |
|  |  | - The final step in the LoginView no longer re-validates a user's credentials |
|  |  |  |
|  |  | ### Changed |
|  |  | - Security Fix: LoginView no longer stores credentials in plaintext in the session store |
|  |  |  |
|  |  | ## 1.11.0 - 2020-03-13 |
|  |  | ### Added |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[docs/configuration.rst](#diff-68a31565c7f34fbe6ac80bbc0b4287ee3711fa615ce5b973c1f83f285d0d28fa "docs/configuration.rst")

Show comments

[View file](/jazzband/django-two-factor-auth/blob/454fd9842fa6e8bb772dbf0943976bc8e3335359/docs/configuration.rst)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -73,6 +73,13 @@ General Settings |
|  |  | `the upstream ticket`\_). Don't set this option to 8 unless all of your |
|  |  | users use a 8 digit compatible token generator app. |
|  |  |  |
|  |  | ``TWO\_FACTOR\_LOGIN\_TIMEOUT`` (default ``600``) |
|  |  | The number of seconds between a user successfully passing the "authentication" |
|  |  | step (usually by entering a valid username and password) and them having to |
|  |  | restart the login flow and re-authenticate. This ensures that users can't sit |
|  |  | indefinately in a state of having entered their password successfully but not |
|  |  | having passed two factor authentication. Set to ``0`` to disable. |
|  |  |  |
|  |  | ``PHONENUMBER\_DEFAULT\_REGION`` (default: ``None``) |
|  |  | The default region for parsing phone numbers. If your application's primary |
|  |  | audience is a certain country, setting the region to that country allows |
| Expand Down | |  |

137 changes: 108 additions & 29 deletions

137
[tests/test\_views\_login.py](#diff-b86f7e3dd2271bb79454bf88ea4bfcfff331aae80413fd2c91099b169e02b370 "tests/test_views_login.py")

Show comments

[View file](/jazzband/django-two-factor-auth/blob/454fd9842fa6e8bb772dbf0943976bc8e3335359/tests/test_views_login.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,3 +1,4 @@ |
|  |  | import json |
|  |  | from unittest import mock |
|  |  |  |
|  |  | from django.conf import settings |
| Expand Down  Expand Up | | @@ -88,6 +89,100 @@ def test\_valid\_login\_with\_disallowed\_external\_redirect(self): |
|  |  | 'login\_view-current\_step': 'auth'}) |
|  |  | self.assertRedirects(response, reverse('two\_factor:profile'), fetch\_redirect\_response=False) |
|  |  |  |
|  |  | @mock.patch('two\_factor.views.core.time') |
|  |  | def test\_valid\_login\_primary\_key\_stored(self, mock\_time): |
|  |  | mock\_time.time.return\_value = 12345.12 |
|  |  | user = self.create\_user() |
|  |  | user.totpdevice\_set.create(name='default', |
|  |  | key=random\_hex\_str()) |
|  |  |  |
|  |  | response = self.\_post({'auth-username': 'bouke@example.com', |
|  |  | 'auth-password': 'secret', |
|  |  | 'login\_view-current\_step': 'auth'}) |
|  |  | self.assertContains(response, 'Token:') |
|  |  |  |
|  |  | self.assertEqual(self.client.session['wizard\_login\_view']['user\_pk'], str(user.pk)) |
|  |  | self.assertEqual( |
|  |  | self.client.session['wizard\_login\_view']['user\_backend'], |
|  |  | 'django.contrib.auth.backends.ModelBackend') |
|  |  | self.assertEqual(self.client.session['wizard\_login\_view']['authentication\_time'], 12345) |
|  |  |  |
|  |  | @mock.patch('two\_factor.views.core.time') |
|  |  | def test\_valid\_login\_post\_auth\_session\_clear\_of\_form\_data(self, mock\_time): |
|  |  | mock\_time.time.return\_value = 12345.12 |
|  |  | user = self.create\_user() |
|  |  | user.totpdevice\_set.create(name='default', |
|  |  | key=random\_hex\_str()) |
|  |  |  |
|  |  | response = self.\_post({'auth-username': 'bouke@example.com', |
|  |  | 'auth-password': 'secret', |
|  |  | 'login\_view-current\_step': 'auth'}) |
|  |  | self.assertContains(response, 'Token:') |
|  |  |  |
|  |  | self.assertEqual(self.client.session['wizard\_login\_view']['user\_pk'], str(user.pk)) |
|  |  | self.assertEqual(self.client.session['wizard\_login\_view']['step'], 'token') |
|  |  | self.assertEqual(self.client.session['wizard\_login\_view']['step\_data'], {'auth': None}) |
|  |  | self.assertEqual(self.client.session['wizard\_login\_view']['step\_files'], {'auth': {}}) |
|  |  | self.assertEqual(self.client.session['wizard\_login\_view']['validated\_step\_data'], {}) |
|  |  |  |
|  |  | @mock.patch('two\_factor.views.core.logger') |
|  |  | @mock.patch('two\_factor.views.core.time') |
|  |  | def test\_valid\_login\_expired(self, mock\_time, mock\_logger): |
|  |  | mock\_time.time.return\_value = 12345.12 |
|  |  | user = self.create\_user() |
|  |  | device = user.totpdevice\_set.create(name='default', |
|  |  | key=random\_hex\_str()) |
|  |  |  |
|  |  | response = self.\_post({'auth-username': 'bouke@example.com', |
|  |  | 'auth-password': 'secret', |
|  |  | 'login\_view-current\_step': 'auth'}) |
|  |  | self.assertContains(response, 'Token:') |
|  |  |  |
|  |  | self.assertEqual(self.client.session['wizard\_login\_view']['user\_pk'], str(user.pk)) |
|  |  | self.assertEqual( |
|  |  | self.client.session['wizard\_login\_view']['user\_backend'], |
|  |  | 'django.contrib.auth.backends.ModelBackend') |
|  |  | self.assertEqual(self.client.session['wizard\_login\_view']['authentication\_time'], 12345) |
|  |  |  |
|  |  | mock\_time.time.return\_value = 20345.12 |
|  |  |  |
|  |  | response = self.\_post({'token-otp\_token': totp(device.bin\_key), |
|  |  | 'login\_view-current\_step': 'token'}) |
|  |  | self.assertEqual(response.status\_code, 200) |
|  |  | self.assertNotContains(response, 'Token:') |
|  |  | self.assertContains(response, 'Password:') |
|  |  | self.assertContains(response, 'Your session has timed out. Please login again.') |
|  |  |  |
|  |  | # Check that a message was logged. |
|  |  | mock\_logger.info.assert\_called\_with( |
|  |  | "User's authentication flow has timed out. The user " |
|  |  | "has been redirected to the initial auth form.") |
|  |  |  |
|  |  | @override\_settings(TWO\_FACTOR\_LOGIN\_TIMEOUT=0) |
|  |  | @mock.patch('two\_factor.views.core.time') |
|  |  | def test\_valid\_login\_no\_timeout(self, mock\_time): |
|  |  | mock\_time.time.return\_value = 12345.12 |
|  |  | user = self.create\_user() |
|  |  | device = user.totpdevice\_set.create(name='default', |
|  |  | key=random\_hex\_str()) |
|  |  |  |
|  |  | response = self.\_post({'auth-username': 'bouke@example.com', |
|  |  | 'auth-password': 'secret', |
|  |  | 'login\_view-current\_step': 'auth'}) |
|  |  | self.assertContains(response, 'Token:') |
|  |  |  |
|  |  | self.assertEqual(self.client.session['wizard\_login\_view']['user\_pk'], str(user.pk)) |
|  |  | self.assertEqual( |
|  |  | self.client.session['wizard\_login\_view']['user\_backend'], |
|  |  | 'django.contrib.auth.backends.ModelBackend') |
|  |  | self.assertEqual(self.client.session['wizard\_login\_view']['authentication\_time'], 12345) |
|  |  |  |
|  |  | mock\_time.time.return\_value = 20345.12 |
|  |  |  |
|  |  | response = self.\_post({'token-otp\_token': totp(device.bin\_key), |
|  |  | 'login\_view-current\_step': 'token'}) |
|  |  | self.assertRedirects(response, resolve\_url(settings.LOGIN\_REDIRECT\_URL)) |
|  |  | self.assertEqual(self.client.session['\_auth\_user\_id'], str(user.pk)) |
|  |  |  |
|  |  | def test\_valid\_login\_with\_redirect\_authenticated\_user(self): |
|  |  | user = self.create\_user() |
| Expand Down  Expand Up | | @@ -251,35 +346,6 @@ def test\_with\_backup\_token(self, mock\_signal): |
|  |  | # Check that the signal was fired. |
|  |  | mock\_signal.assert\_called\_with(sender=mock.ANY, request=mock.ANY, user=user, device=device) |
|  |  |  |
|  |  | @mock.patch('two\_factor.views.utils.logger') |
|  |  | def test\_change\_password\_in\_between(self, mock\_logger): |
|  |  | """ |
|  |  | When the password of the user is changed while trying to login, should |
|  |  | not result in errors. Refs #63. |
|  |  | """ |
|  |  | user = self.create\_user() |
|  |  | self.enable\_otp() |
|  |  |  |
|  |  | response = self.\_post({'auth-username': 'bouke@example.com', |
|  |  | 'auth-password': 'secret', |
|  |  | 'login\_view-current\_step': 'auth'}) |
|  |  | self.assertContains(response, 'Token:') |
|  |  |  |
|  |  | # Now, the password is changed. When the form is submitted, the |
|  |  | # credentials should be checked again. If that's the case, the |
|  |  | # login form should note that the credentials are invalid. |
|  |  | user.set\_password('secret2') |
|  |  | user.save() |
|  |  | response = self.\_post({'login\_view-current\_step': 'token'}) |
|  |  | self.assertContains(response, 'Please enter a correct') |
|  |  | self.assertContains(response, 'and password.') |
|  |  |  |
|  |  | # Check that a message was logged. |
|  |  | mock\_logger.warning.assert\_called\_with( |
|  |  | "Current step '%s' is no longer valid, returning to last valid " |
|  |  | "step in the wizard.", |
|  |  | 'token') |
|  |  |  |
|  |  | @mock.patch('two\_factor.views.utils.logger') |
|  |  | def test\_reset\_wizard\_state(self, mock\_logger): |
|  |  | self.create\_user() |
| Expand Down  Expand Up | | @@ -332,6 +398,19 @@ def test\_missing\_management\_data(self): |
|  |  | # view should return HTTP 400 Bad Request |
|  |  | self.assertEqual(response.status\_code, 400) |
|  |  |  |
|  |  | def test\_no\_password\_in\_session(self): |
|  |  | self.create\_user() |
|  |  | self.enable\_otp() |
|  |  |  |
|  |  | response = self.\_post({'auth-username': 'bouke@example.com', |
|  |  | 'auth-password': 'secret', |
|  |  | 'login\_view-current\_step': 'auth'}) |
|  |  | self.assertContains(response, 'Token:') |
|  |  |  |
|  |  | session\_contents = json.dumps(list(self.client.session.items())) |
|  |  |  |
|  |  | self.assertNotIn('secret', session\_contents) |
|  |  |  |
|  |  |  |
|  |  | class BackupTokensTest(UserMixin, TestCase): |
|  |  | def setUp(self): |
| Expand Down | |  |

79 changes: 75 additions & 4 deletions

79
[two\_factor/views/core.py](#diff-47e9cf2bbbe1952606db449365a94f378e479389cc4c53d52310ceed0605646d "two_factor/views/core.py")

Show comments

[View file](/jazzband/django-two-factor-auth/blob/454fd9842fa6e8bb772dbf0943976bc8e3335359/two_factor/views/core.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,6 +2,7 @@ |
|  |  | import warnings |
|  |  | from base64 import b32encode |
|  |  | from binascii import unhexlify |
|  |  | import time |
|  |  |  |
|  |  | import django\_otp |
|  |  | import qrcode |
| Expand All | | @@ -12,13 +13,15 @@ |
|  |  | from django.contrib.auth.forms import AuthenticationForm |
|  |  | from django.contrib.auth.views import SuccessURLAllowedHostsMixin |
|  |  | from django.contrib.sites.shortcuts import get\_current\_site |
|  |  | from django.forms import Form |
|  |  | from django.forms import Form, ValidationError |
|  |  | from django.http import Http404, HttpResponse, HttpResponseRedirect |
|  |  | from django.shortcuts import redirect, resolve\_url |
|  |  | from django.urls import reverse |
|  |  | from django.utils.decorators import method\_decorator |
|  |  | from django.utils.functional import cached\_property |
|  |  | from django.utils.http import is\_safe\_url |
|  |  | from django.utils.module\_loading import import\_string |
|  |  | from django.utils.translation import gettext as \_ |
|  |  | from django.views.decorators.cache import never\_cache |
|  |  | from django.views.decorators.csrf import csrf\_protect |
|  |  | from django.views.decorators.debug import sensitive\_post\_parameters |
| Expand Down  Expand Up | | @@ -72,6 +75,7 @@ class LoginView(SuccessURLAllowedHostsMixin, IdempotentSessionWizardView): |
|  |  | 'backup': False, |
|  |  | } |
|  |  | redirect\_authenticated\_user = False |
|  |  | storage\_name = 'two\_factor.views.utils.LoginStorage' |
|  |  |  |
|  |  | def has\_token\_step(self): |
|  |  | return default\_device(self.get\_user()) |
| Expand All | | @@ -80,6 +84,14 @@ def has\_backup\_step(self): |
|  |  | return default\_device(self.get\_user()) and \ |
|  |  | 'token' not in self.storage.validated\_step\_data |
|  |  |  |
|  |  | @cached\_property |
|  |  | def expired(self): |
|  |  | login\_timeout = getattr(settings, 'TWO\_FACTOR\_LOGIN\_TIMEOUT', 600) |
|  |  | if login\_timeout == 0: |
|  |  | return False |
|  |  | expiration\_time = self.storage.data.get("authentication\_time", 0) + login\_timeout |
|  |  | return int(time.time()) > expiration\_time |
|  |  |  |
|  |  | condition\_dict = { |
|  |  | 'token': has\_token\_step, |
|  |  | 'backup': has\_backup\_step, |
| Expand All | | @@ -90,12 +102,25 @@ def \_\_init\_\_(self, \*\*kwargs): |
|  |  | super().\_\_init\_\_(\*\*kwargs) |
|  |  | self.user\_cache = None |
|  |  | self.device\_cache = None |
|  |  | self.show\_timeout\_error = False |
|  |  |  |
|  |  | def post(self, \*args, \*\*kwargs): |
|  |  | """ |
|  |  | The user can select a particular device to challenge, being the backup |
|  |  | devices added to the account. |
|  |  | """ |
|  |  | wizard\_goto\_step = self.request.POST.get('wizard\_goto\_step', None) |
|  |  |  |
|  |  | if wizard\_goto\_step == 'auth': |
|  |  | self.storage.reset() |
|  |  |  |
|  |  | if self.expired and self.steps.current != 'auth': |
|  |  | logger.info("User's authentication flow has timed out. The user " |
|  |  | "has been redirected to the initial auth form.") |
|  |  | self.storage.reset() |
|  |  | self.show\_timeout\_error = True |
|  |  | return self.render\_goto\_step('auth') |
|  |  |  |
|  |  | # Generating a challenge doesn't require to validate the form. |
|  |  | if 'challenge\_device' in self.request.POST: |
|  |  | return self.render\_goto\_step('token') |
| Expand Down  Expand Up | | @@ -152,6 +177,54 @@ def get\_form\_kwargs(self, step=None): |
|  |  | } |
|  |  | return {} |
|  |  |  |
|  |  | def get\_done\_form\_list(self): |
|  |  | """ |
|  |  | Return the forms that should be processed during the final step |
|  |  | """ |
|  |  | # Intentionally do not process the auth form on the final step. We |
|  |  | # haven't stored this data, and it isn't required to login the user |
|  |  | form\_list = self.get\_form\_list() |
|  |  | form\_list.pop('auth') |
|  |  | return form\_list |
|  |  |  |
|  |  | def process\_step(self, form): |
|  |  | """ |
|  |  | Process an individual step in the flow |
|  |  | """ |
|  |  | # To prevent saving any private auth data to the session store, we |
|  |  | # validate the authentication form, determine the resulting user, then |
|  |  | # only store the minimum needed to login that user (the user's primary |
|  |  | # key and the backend used) |
|  |  | if self.steps.current == 'auth': |
|  |  | user = form.is\_valid() and form.user\_cache |
|  |  | self.storage.reset() |
|  |  | self.storage.authenticated\_user = user |
|  |  | self.storage.data["authentication\_time"] = int(time.time()) |
|  |  |  |
|  |  | # By returning None when the user clicks the "back" button to the |
|  |  | # auth step the form will be blank with validation warnings |
|  |  | return None |
|  |  |  |
|  |  | return super().process\_step(form) |
|  |  |  |
|  |  | def process\_step\_files(self, form): |
|  |  | """ |
|  |  | Process the files submitted from a specific test |
|  |  | """ |
|  |  | if self.steps.current == 'auth': |
|  |  | return {} |
|  |  | return super().process\_step\_files(form) |
|  |  |  |
|  |  | def get\_form(self, \*args, \*\*kwargs): |
|  |  | """ |
|  |  | Returns the form for the step |
|  |  | """ |
|  |  | form = super().get\_form(\*args, \*\*kwargs) |
|  |  | if self.show\_timeout\_error: |
|  |  | form.cleaned\_data = getattr(form, 'cleaned\_data', {}) |
|  |  | form.add\_error(None, ValidationError(\_('Your session has timed out. Please login again.'))) |
|  |  | return form |
|  |  |  |
|  |  | def get\_device(self, step=None): |
|  |  | """ |
|  |  | Returns the OTP device selected by the user, or his default device. |
| Expand Down  Expand Up | | @@ -187,9 +260,7 @@ def get\_user(self): |
|  |  | if not a valid user; see also issue #65. |
|  |  | """ |
|  |  | if not self.user\_cache: |
|  |  | form\_obj = self.get\_form(step='auth', |
|  |  | data=self.storage.get\_step\_data('auth')) |
|  |  | self.user\_cache = form\_obj.is\_valid() and form\_obj.user\_cache |
|  |  | self.user\_cache = self.storage.authenticated\_user |
|  |  | return self.user\_cache |
|  |  |  |
|  |  | def get\_context\_data(self, form, \*\*kwargs): |
| Expand Down | |  |

33 changes: 32 additions & 1 deletion

33
[two\_factor/views/utils.py](#diff-7a6d275f31a62df689436975d137fe0c42cb681dd901e9594d9b844f5e46a60f "two_factor/views/utils.py")

Show comments

[View file](/jazzband/django-two-factor-auth/blob/454fd9842fa6e8bb772dbf0943976bc8e3335359/two_factor/views/utils.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,5 +1,6 @@ |
|  |  | import logging |
|  |  |  |
|  |  | from django.contrib.auth import load\_backend |
|  |  | from django.core.exceptions import SuspiciousOperation |
|  |  | from django.utils.decorators import method\_decorator |
|  |  | from django.utils.translation import gettext as \_ |
| Expand Down  Expand Up | | @@ -37,6 +38,33 @@ def \_set\_validated\_step\_data(self, validated\_step\_data): |
|  |  | \_set\_validated\_step\_data) |
|  |  |  |
|  |  |  |
|  |  | class LoginStorage(ExtraSessionStorage): |
|  |  | """ |
|  |  | SessionStorage that includes the property 'authenticated\_user' for storing |
|  |  | backend authenticated users while logging in. |
|  |  | """ |
|  |  | def \_get\_authenticated\_user(self): |
|  |  | # Ensure that both user\_pk and user\_backend exist in the session |
|  |  | if not all([self.data.get("user\_pk"), self.data.get("user\_backend")]): |
|  |  | return False |
|  |  | # Acquire the user the same way django.contrib.auth.get\_user does |
|  |  | backend = load\_backend(self.data["user\_backend"]) |
|  |  | user = backend.get\_user(self.data["user\_pk"]) |
|  |  | if not user: |
|  |  | return False |
|  |  | # Set user.backend to the dotted path version of the backend for login() |
|  |  | user.backend = self.data["user\_backend"] |
|  |  | return user |
|  |  |  |
|  |  | def \_set\_authenticated\_user(self, user): |
|  |  | # Acquire the PK the same way django's auth middleware does |
|  |  | self.data["user\_pk"] = user.\_meta.pk.value\_to\_string(user) |
|  |  | self.data["user\_backend"] = user.backend |
|  |  |  |
|  |  | authenticated\_user = property(\_get\_authenticated\_user, |
|  |  | \_set\_authenticated\_user) |
|  |  |  |
|  |  |  |
|  |  | class IdempotentSessionWizardView(SessionWizardView): |
|  |  | """ |
|  |  | WizardView that allows certain steps to be marked non-idempotent, in which |
| Expand Down  Expand Up | | @@ -153,6 +181,9 @@ def process\_step(self, form): |
|  |  |  |
|  |  | return super().process\_step(form) |
|  |  |  |
|  |  | def get\_done\_form\_list(self): |
|  |  | return self.get\_form\_list() |
|  |  |  |
|  |  | def render\_done(self, form, \*\*kwargs): |
|  |  | """ |
|  |  | This method gets called when all forms passed. The method should also |
| Expand All | | @@ -162,7 +193,7 @@ def render\_done(self, form, \*\*kwargs): |
|  |  | """ |
|  |  | final\_form\_list = [] |
|  |  | # walk through the form list and try to validate the data again. |
|  |  | for form\_key in self.get\_form\_list(): |
|  |  | for form\_key in self.get\_done\_form\_list(): |
|  |  | form\_obj = self.get\_form(step=form\_key, |
|  |  | data=self.storage.get\_step\_data(form\_key), |
|  |  | files=self.storage.get\_step\_files( |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 2 comments on commit `454fd98`

[![@niloct](https://avatars.githubusercontent.com/u/1529383?s=80&v=4)](/niloct)

Copy link

### @niloct **[niloct](/niloct)** commented on `[454fd98](/jazzband/django-two-factor-auth/commit/454fd9842fa6e8bb772dbf0943976bc8e3335359)` [Jul 28, 2020](#commitcomment-40979161)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Why did you define a `get_done_form_list()` which doest the exact job of a `get_form_list()` ?

Same reason for the very last diff of this patch.

Sorry, something went wrong.

All reactions

[![@moggers87](https://avatars.githubusercontent.com/u/1490673?s=80&v=4)](/moggers87)

Copy link

Collaborator

### @moggers87 **[moggers87](/moggers87)** commented on `[454fd98](/jazzband/django-two-factor-auth/commit/454fd9842fa6e8bb772dbf0943976bc8e3335359)` [Jul 28, 2020](#commitcomment-40980880)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

It's so it can be overridden in subclasses, e.g. `LoginView.get_done_form_list` pops off the auth form

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjazzband%2Fdjango-two-factor-auth%2Fcommit%2F454fd9842fa6e8bb772dbf0943976bc8e3335359) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_38f9aca1_20250119_141342.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjazzband%2Fdjango-two-factor-auth)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjazzband%2Fdjango-two-factor-auth)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=jazzband%2Fdjango-two-factor-auth)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jazzband](/jazzband)
/
**[django-two-factor-auth](/jazzband/django-two-factor-auth)**
Public

* [Notifications](/login?return_to=%2Fjazzband%2Fdjango-two-factor-auth) You must be signed in to change notification settings
* [Fork
  448](/login?return_to=%2Fjazzband%2Fdjango-two-factor-auth)
* [Star
   1.7k](/login?return_to=%2Fjazzband%2Fdjango-two-factor-auth)

Complete Two-Factor Authentication for Django providing the easiest integration into most Django projects.

### License

[MIT license](/jazzband/django-two-factor-auth/blob/master/LICENSE)

[1.7k
stars](/jazzband/django-two-factor-auth/stargazers) [448
forks](/jazzband/django-two-factor-auth/forks) [Branches](/jazzband/django-two-factor-auth/branches) [Tags](/jazzband/django-two-factor-auth/tags) [Activity](/jazzband/django-two-factor-auth/activity)
 [Star](/login?return_to=%2Fjazzband%2Fdjango-two-factor-auth)

 [Notifications](/login?return_to=%2Fjazzband%2Fdjango-two-factor-auth) You must be signed in to change notification settings

* [Code](/jazzband/django-two-factor-auth)
* [Issues
  86](/jazzband/django-two-factor-auth/issues)
* [Pull requests
  23](/jazzband/django-two-factor-auth/pulls)
* [Actions](/jazzband/django-two-factor-auth/actions)
* [Projects
  0](/jazzband/django-two-factor-auth/projects)
* [Security](/jazzband/django-two-factor-auth/security)
* [Insights](/jazzband/django-two-factor-auth/pulse)

Additional navigation options

* [Code](/jazzband/django-two-factor-auth)
* [Issues](/jazzband/django-two-factor-auth/issues)
* [Pull requests](/jazzband/django-two-factor-auth/pulls)
* [Actions](/jazzband/django-two-factor-auth/actions)
* [Projects](/jazzband/django-two-factor-auth/projects)
* [Security](/jazzband/django-two-factor-auth/security)
* [Insights](/jazzband/django-two-factor-auth/pulse)

# jazzband/django-two-factor-auth

    master[Branches](/jazzband/django-two-factor-auth/branches)[Tags](/jazzband/django-two-factor-auth/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[825 Commits](/jazzband/django-two-factor-auth/commits/master/) | | |
| [.github](/jazzband/django-two-factor-auth/tree/master/.github ".github") | | [.github](/jazzband/django-two-factor-auth/tree/master/.github ".github") |  |  |
| [.tx](/jazzband/django-two-factor-auth/tree/master/.tx ".tx") | | [.tx](/jazzband/django-two-factor-auth/tree/master/.tx ".tx") |  |  |
| [docs](/jazzband/django-two-factor-auth/tree/master/docs "docs") | | [docs](/jazzband/django-two-factor-auth/tree/master/docs "docs") |  |  |
| [example](/jazzband/django-two-factor-auth/tree/master/example "example") | | [example](/jazzband/django-two-factor-auth/tree/master/example "example") |  |  |
| [tests](/jazzband/django-two-factor-auth/tree/master/tests "tests") | | [tests](/jazzband/django-two-factor-auth/tree/master/tests "tests") |  |  |
| [two\_factor](/jazzband/django-two-factor-auth/tree/master/two_factor "two_factor") | | [two\_factor](/jazzband/django-two-factor-auth/tree/master/two_factor "two_factor") |  |  |
| [.codecov.yml](/jazzband/django-two-factor-auth/blob/master/.codecov.yml ".codecov.yml") | | [.codecov.yml](/jazzband/django-two-factor-auth/blob/master/.codecov.yml ".codecov.yml") |  |  |
| [.gitignore](/jazzband/django-two-factor-auth/blob/master/.gitignore ".gitignore") | | [.gitignore](/jazzband/django-two-factor-auth/blob/master/.gitignore ".gitignore") |  |  |
| [.pre-commit-config.yaml](/jazzband/django-two-factor-auth/blob/master/.pre-commit-config.yaml ".pre-commit-config.yaml") | | [.pre-commit-config.yaml](/jazzband/django-two-factor-auth/blob/master/.pre-commit-config.yaml ".pre-commit-config.yaml") |  |  |
| [CHANGELOG.md](/jazzband/django-two-factor-auth/blob/master/CHANGELOG.md "CHANGELOG.md") | | [CHANGELOG.md](/jazzband/django-two-factor-auth/blob/master/CHANGELOG.md "CHANGELOG.md") |  |  |
| [CONTRIBUTING.rst](/jazzband/django-two-factor-auth/blob/master/CONTRIBUTING.rst "CONTRIBUTING.rst") | | [CONTRIBUTING.rst](/jazzband/django-two-factor-auth/blob/master/CONTRIBUTING.rst "CONTRIBUTING.rst") |  |  |
| [LICENSE](/jazzband/django-two-factor-auth/blob/master/LICENSE "LICENSE") | | [LICENSE](/jazzband/django-two-factor-auth/blob/master/LICENSE "LICENSE") |  |  |
| [MANIFEST.in](/jazzband/django-two-factor-auth/blob/master/MANIFEST.in "MANIFEST.in") | | [MANIFEST.in](/jazzband/django-two-factor-auth/blob/master/MANIFEST.in "MANIFEST.in") |  |  |
| [Makefile](/jazzband/django-two-factor-auth/blob/master/Makefile "Makefile") | | [Makefile](/jazzband/django-two-factor-auth/blob/master/Makefile "Makefile") |  |  |
| [README.rst](/jazzband/django-two-factor-auth/blob/master/README.rst "README.rst") | | [README.rst](/jazzband/django-two-factor-auth/blob/master/README.rst "README.rst") |  |  |
| [pyproject.toml](/jazzband/django-two-factor-auth/blob/master/pyproject.toml "pyproject.toml") | | [pyproject.toml](/jazzband/django-two-factor-auth/blob/master/pyproject.toml "pyproject.toml") |  |  |
| [requirements\_dev.txt](/jazzband/django-two-factor-auth/blob/master/requirements_dev.txt "requirements_dev.txt") | | [requirements\_dev.txt](/jazzband/django-two-factor-auth/blob/master/requirements_dev.txt "requirements_dev.txt") |  |  |
| [requirements\_e2e.txt](/jazzband/django-two-factor-auth/blob/master/requirements_e2e.txt "requirements_e2e.txt") | | [requirements\_e2e.txt](/jazzband/django-two-factor-auth/blob/master/requirements_e2e.txt "requirements_e2e.txt") |  |  |
| [tox.ini](/jazzband/django-two-factor-auth/blob/master/tox.ini "tox.ini") | | [tox.ini](/jazzband/django-two-factor-auth/blob/master/tox.ini "tox.ini") |  |  |
| View all files | | |

## Repository files navigation

* README
* Code of conduct
* MIT license
* Security
# Django Two-Factor Authentication

[![Jazzband](https://camo.githubusercontent.com/a0208a83c400354d910075a93b45afcaa3fba710246df87f2dab0c8debae2635/68747470733a2f2f6a617a7a62616e642e636f2f7374617469632f696d672f62616467652e737667)](https://jazzband.co/)
[![Build Status](https://github.com/jazzband/django-two-factor-auth/workflows/build/badge.svg?branch=master)](https://github.com/jazzband/django-two-factor-auth/actions)
[![Test Coverage](https://camo.githubusercontent.com/95931c5b5c4d126c7e6fb95eda62945907054e591119633cef559938bbfd5938/68747470733a2f2f636f6465636f762e696f2f67682f6a617a7a62616e642f646a616e676f2d74776f2d666163746f722d617574682f6272616e63682f6d61737465722f67726170682f62616467652e737667)](https://codecov.io/gh/jazzband/django-two-factor-auth)
[![PyPI](https://camo.githubusercontent.com/f820756bcd2206ebe89299a7f1b292922bd6232ec733bf4c6bc88723ab0d4d58/68747470733a2f2f62616467652e667572792e696f2f70792f646a616e676f2d74776f2d666163746f722d617574682e737667)](https://pypi.python.org/pypi/django-two-factor-auth)

Complete Two-Factor Authentication for Django. Built on top of the one-time
password framework [django-otp](https://pypi.org/project/django-otp/) and Django's built-in authentication framework
`django.contrib.auth` for providing the easiest integration into most Django
projects. Inspired by the user experience of Google's Two-Step Authentication,
allowing users to authenticate through call, text messages (SMS), by using a
token generator app like Google Authenticator or a [YubiKey](https://www.yubico.com/products/yubikey-hardware/) hardware token
generator (optional).

If you run into problems, please file an issue on GitHub, or contribute to the
project by forking the repository and sending some pull requests. The package
is translated into English, Dutch and other languages. Please contribute your
own language using [Transifex](https://explore.transifex.com/Bouke/django-two-factor-auth/).

Test drive this app through the [example app](https://github.com/jazzband/django-two-factor-auth/tree/master/example). It demos most features except
the Twilio integration. The example also includes [django-user-sessions](https://pypi.org/project/django-user-sessions/) for
providing Django sessions with a foreign key to the user. Although the package
is optional, it improves account security control over
`django.contrib.sessions`.

Compatible with supported Django and Python versions. At the moment of writing
that includes 4.2, 5.0, and 5.1 on Python 3.8 to 3.12.
Documentation is available at [readthedocs.io](https://django-two-factor-auth.readthedocs.io/en/stable/index.html).

## Installation

Refer to the [installation instructions](https://django-two-factor-auth.readthedocs.io/en/stable/installation.html) in the documentation.

## Getting help

For general questions regarding this package, please hop over to [Stack Overflow](https://stackoverflow.com/questions/tagged/django-two-factor-auth).
If you think there is an issue with this package; check if the
issue is already listed (either open or closed), and file an issue if
it's not.

## Contribute

Read the [contribution guidelines](https://github.com/jazzband/django-two-factor-auth/blob/master/CONTRIBUTING.rst).

## See Also

Have a look at [django-user-sessions](https://pypi.org/project/django-user-sessions/) for Django sessions with a foreign key to
the user. This package is also included in the [example app](https://github.com/jazzband/django-two-factor-auth/tree/master/example).

## License

The project is licensed under the MIT license.

## About

Complete Two-Factor Authentication for Django providing the easiest integration into most Django projects.

### Topics

[django](/topics/django "Topic: django")
[authentication](/topics/authentication "Topic: authentication")
[two-factor-authentication](/topics/two-factor-authentication "Topic: two-factor-authentication")

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)
### Code of conduct

[Code of conduct](#coc-ov-file)
### Security policy

[Security policy](#security-ov-file)

[Activity](/jazzband/django-two-factor-auth/activity)
[Custom properties](/jazzband/django-two-factor-auth/custom-properties)
### Stars

[**1.7k**
stars](/jazzband/django-two-factor-auth/stargazers)
### Watchers

[**38**
watching](/jazzband/django-two-factor-auth/watchers)
### Forks

[**448**
forks](/jazzband/django-two-factor-auth/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fjazzband%2Fdjango-two-factor-auth&report=jazzband+%28user%29)

## [Releases 34](/jazzband/django-two-factor-auth/releases)

[1.15.1
Latest

Apr 5, 2023](/jazzband/django-two-factor-auth/releases/tag/1.15.1)
[+ 33 releases](/jazzband/django-two-factor-auth/releases)

## Sponsor this project

* <https://jazzband.co/donate>

## [Used by 1.8k](/jazzband/django-two-factor-auth/network/dependents)

[* ![@khalidbouychou](https://avatars.githubusercontent.com/u/41027645?s=64&v=4)
* ![@Rohanrn9882](https://avatars.githubusercontent.com/u/105193321?s=64&v=4)
* ![@nuyheat](https://avatars.githubusercontent.com/u/127810263?s=64&v=4)
* ![@KAIVA-AI](https://avatars.githubusercontent.com/u/180902544?s=64&v=4)
* ![@sunekochhansen](https://avatars.githubusercontent.com/u/34162776?s=64&v=4)
* ![@s194050](https://avatars.githubusercontent.com/u/60744645?s=64&v=4)
* ![@SWE-Gym-Raw](https://avatars.githubusercontent.com/u/194694957?s=64&v=4)
* ![@JossueJativa](https://avatars.githubusercontent.com/u/120510651?s=64&v=4)

+ 1,797](/jazzband/django-two-factor-auth/network/dependents)

## [Contributors 105](/jazzband/django-two-factor-auth/graphs/contributors)

[+ 91 contributors](/jazzband/django-two-factor-auth/graphs/contributors)

## Languages

* [Python
  91.5%](/jazzband/django-two-factor-auth/search?l=python)
* [HTML
  6.9%](/jazzband/django-two-factor-auth/search?l=html)
* [JavaScript
  1.2%](/jazzband/django-two-factor-auth/search?l=javascript)
* [Makefile
  0.4%](/jazzband/django-two-factor-auth/search?l=makefile)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avatars.githubusercontent.com_9a4ea885_20250119_141341.html ===
���� �  

 $.' ",#(7),01444'9=82<.342 
2!!22222222222222222222222222222222222222222222222222��  ( (" ���          
   } !1AQa"q2���#B��R��$3br�
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz�������������������������������������������������������������������������       
  w !1AQaq"2�B���� #3R�br�
$4�%�&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz��������������������������������������������������������������������������   ? x��q����:�^QH���خk��c�Gw:3+D���� ��K9B�q<8Ԭ�=��%�m�mt`"02PF��Z�F���h$O.�Yq���t�^Kh�dw��n��q�� �3hOi��^�`E�8� cۥqa���&�=ln���c�E&)Ɗ�����8�[��p ��U����K�C��L��F��c������X֊�6�Ӆ��h�+�����H�����G~�֮�0
{T�ww?�oҹ\_�PYZ����C����Y����o|C$����a��rA'~?~��4W��=��rtZ�\_雴b������Km2J��٩s^��
5�8����Pm:�\_)Q���d���b���n's,��7�|���5���������?�7�W�oSܡ�
ˡn����ʈ�Q!2���h{�d�B�\*9\���� ]'�� \*g������Z#IJ�R�\_�e<mo7�(��W��'տ�&ߝb�� ��?�W��8�]���

=== Content from github.com_26cdd9b7_20250119_124013.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjazzband%2Fdjango-two-factor-auth%2Fsecurity%2Fadvisories%2FGHSA-vhr6-pvjm-9qwf)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fjazzband%2Fdjango-two-factor-auth%2Fsecurity%2Fadvisories%2FGHSA-vhr6-pvjm-9qwf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=jazzband%2Fdjango-two-factor-auth)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[jazzband](/jazzband)
/
**[django-two-factor-auth](/jazzband/django-two-factor-auth)**
Public

* [Notifications](/login?return_to=%2Fjazzband%2Fdjango-two-factor-auth) You must be signed in to change notification settings
* [Fork
  448](/login?return_to=%2Fjazzband%2Fdjango-two-factor-auth)
* [Star
   1.7k](/login?return_to=%2Fjazzband%2Fdjango-two-factor-auth)

* [Code](/jazzband/django-two-factor-auth)
* [Issues
  86](/jazzband/django-two-factor-auth/issues)
* [Pull requests
  23](/jazzband/django-two-factor-auth/pulls)
* [Actions](/jazzband/django-two-factor-auth/actions)
* [Projects
  0](/jazzband/django-two-factor-auth/projects)
* [Security](/jazzband/django-two-factor-auth/security)
* [Insights](/jazzband/django-two-factor-auth/pulse)

Additional navigation options

* [Code](/jazzband/django-two-factor-auth)
* [Issues](/jazzband/django-two-factor-auth/issues)
* [Pull requests](/jazzband/django-two-factor-auth/pulls)
* [Actions](/jazzband/django-two-factor-auth/actions)
* [Projects](/jazzband/django-two-factor-auth/projects)
* [Security](/jazzband/django-two-factor-auth/security)
* [Insights](/jazzband/django-two-factor-auth/pulse)

# User passwords are stored in clear text in the Django session

High

[Bouke](/Bouke)
published
GHSA-vhr6-pvjm-9qwf
Jul 8, 2020

## Package

django-two-factor-auth
(python)

## Affected versions

<=1.11

## Patched versions

1.12

## Description

### Impact

django-two-factor-auth versions 1.11 and before store the user's password in clear text in the user session (base64-encoded). The password is stored in the session when the user submits their username and password, and is removed once they complete authentication by entering a two-factor authentication code. This means that the password is stored in clear text in the session for an arbitrary amount of time, and potentially forever if the user begins the login process by entering their username and password, and then leaves before entering their two-factor authentication code.

The severity of this issue depends on which type of session storage you have configured: in the worst case, if you're using Django's default database session storage, then users' password are stored in clear text in your database. In the best case, if you're using Django's signed cookie session, then users' passwords are only stored in clear text within their browser's cookie store. In the common case of using Django's cache session store, the users' password are stored in clear text in whatever cache storage you have configured (typically Memcached or Redis).

### Patches

Upgrade to version 1.12 to resolve this issue.

After upgrading, users should be sure to delete any clear text passwords that have been stored. For example, if you're using the database session backend, you'll likely want to delete any session record from the database and purge that data from any database backups or replicas.

In addition, affected organizations who have suffered a database breach while using an affected version should inform their users that their clear text passwords have been compromised. All organizations should encourage users whose passwords were insecurely stored to change these passwords on any sites where they were used.

### Workarounds

Switching Django's session storage to use signed cookies instead of the database or cache lessens the impact of this issue, but should not be done without a thorough understanding of the security tradeoffs of using signed cookies rather than a server-side session storage. There is no way to fully mitigate the issue without upgrading.

### References

For an explanation of why storing cleartext password is a substantial vulnerability: [Hashing Passwords: One-Way Road to Security](https://auth0.com/blog/hashing-passwords-one-way-road-to-security/).

For documentation on configuring the Django session storage engine: [Django session documentation](https://docs.djangoproject.com/en/3.0/topics/http/sessions/).

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [the repo](https://github.com/Bouke/django-two-factor-auth)

### Severity

High

### CVE ID

CVE-2020-15105

### Weaknesses

No CWEs

### Credits

* [![@nickcatal](https://avatars.githubusercontent.com/u/474748?s=40&v=4)](/nickcatal)
  [nickcatal](/nickcatal)
  Analyst
* [![@liewegas](https://avatars.githubusercontent.com/u/433031?s=40&v=4)](/liewegas)
  [liewegas](/liewegas)
  Analyst
* [![@benweissmann](https://avatars.githubusercontent.com/u/207390?s=40&v=4)](/benweissmann)
  [benweissmann](/benweissmann)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


