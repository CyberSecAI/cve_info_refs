```
{
  "cveId": "CVE-2020-15257",
  "description": "Access controls for the shimâ€™s API socket verified that the connecting process had an effective UID of 0, but did not otherwise restrict access to the abstract Unix domain socket. This would allow malicious containers running in the same network namespace as the shim, with an effective UID of 0 but otherwise reduced privileges, to cause new processes to be run with elevated privileges.",
  "vulnerabilityDetails": {
    "rootCause": "The containerd-shim API socket did not properly restrict access to the abstract Unix domain socket, only verifying the connecting process had an effective UID of 0.",
    "weaknesses": [
      "Insufficient access control on the abstract Unix domain socket exposed by containerd-shim."
    ],
    "impact": "Malicious containers with effective UID 0 in the same network namespace as the shim can execute new processes with elevated privileges.",
    "attackVectors": [
      "A malicious container must be running in the same network namespace as the containerd-shim.",
       "The malicious container must have an effective UID of 0."
    ],
    "requiredCapabilities": "The attacker needs to be able to run a container with an effective UID of 0 in the same network namespace as the containerd-shim. Typically, this would involve using `docker run --net=host` or `hostNetwork: true` in Kubernetes."
  },
  "affectedVersions": [
    "<=1.3.7",
    "1.4.0",
    "1.4.1"
  ],
  "patchedVersions": [
    "1.3.9",
    "1.4.3"
  ],
  "workarounds": [
      "Avoid running containers with the same network namespace as the shim (typically the host network) and with an effective UID of 0.",
      "Deny access to all abstract sockets with AppArmor by adding a line similar to `deny unix addr=@**,` to your policy."
    ],
  "additionalNotes": "It is best practice to run containers with a reduced set of privileges, with a non-zero UID, and with isolated namespaces. The containerd maintainers strongly advise against sharing namespaces with the host. Reducing the set of isolation mechanisms used for a container necessarily increases that container's privilege, regardless of what container runtime is used for running that container."
}
```