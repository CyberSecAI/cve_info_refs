```
{
  "vulnerability": {
    "root_cause": "The default containerd resolver, when encountering a URL in a container image manifest, would follow that URL to download a layer. However, in versions prior to 1.3.0 (specifically 1.2.x), it would provide its authentication credentials to the server hosting the URL if that server responded with a 401 status code and specific registry headers.",
    "weaknesses": [
      "The vulnerability lies in the insecure handling of authentication credentials by the containerd resolver when downloading image layers from URLs specified in manifests."
    ],
    "impact": "A malicious actor could create a public container image with a manifest containing a URL pointing to a server they control. When a user or system attempts to pull this image, the containerd resolver would follow the URL, potentially sending registry credentials (including usernames, passwords, or cloud instance credentials) to the attacker's server. This could lead to unauthorized access to the user's registry account or other cloud resources.",
    "attack_vectors": [
      "The attack vector is through a crafted container image manifest which contains a URL pointing to a malicious server."
    ],
    "required_attacker_capabilities": "The attacker needs to be able to create and publish a container image with a malicious manifest. They also need control over a web server to receive the credentials sent by vulnerable containerd clients. The attacker must also trick a user or system into pulling the malicious image.",
    "additional_info": "This vulnerability was rated as 'medium' by containerd maintainers. The vulnerability is present in containerd versions 1.2.x and is fixed in version 1.2.14 and later. Versions 1.3 and later are not affected. Other container runtimes that use containerd, but not the default resolver, such as Docker are not affected. The vulnerability is present in the default resolver used by `cri-containerd` and `ctr`."
  }
}
```