=== Content from bugzilla.mozilla.org_3de437e6_20250119_125552.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Sun Jan 19 2025 04:55:52 PST

* **Bug ID:**
  1651001,
  1653626,
  1656957

---

| [ID](/buglist.cgi?bug_id=1651001%2C1653626%2C1656957&query_format=advanced&order=bug_id%20DESC&query_based_on=) | [Type](/buglist.cgi?bug_id=1651001%2C1653626%2C1656957&query_format=advanced&order=bug_type%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Summary](/buglist.cgi?bug_id=1651001%2C1653626%2C1656957&query_format=advanced&order=short_desc%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Product](/buglist.cgi?bug_id=1651001%2C1653626%2C1656957&query_format=advanced&order=product%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Comp](/buglist.cgi?bug_id=1651001%2C1653626%2C1656957&query_format=advanced&order=component%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Assignee▲](/buglist.cgi?bug_id=1651001%2C1653626%2C1656957&query_format=advanced&order=assigned_to%20DESC%2Cbug_status%2Cpriority%2Cbug_id&query_based_on=) | [Status▲](/buglist.cgi?bug_id=1651001%2C1653626%2C1656957&query_format=advanced&order=bug_status%20DESC%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Resolution](/buglist.cgi?bug_id=1651001%2C1653626%2C1656957&query_format=advanced&order=resolution%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Updated](/buglist.cgi?bug_id=1651001%2C1653626%2C1656957&query_format=advanced&order=changeddate%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [1653626](/show_bug.cgi?id=1653626 "RESOLVED FIXED - ThreadSanitizer: data race in webrtc.org [@ webrtc::RTCPReceiver::HandleSenderReport] vs [@ webrtc::RTCPReceiver::RemoteRTCPSenderInfo]") |  | [ThreadSanitizer: data race in webrtc.org [@ webrtc::RTCPReceiver::HandleSenderReport] vs [@ webrtc::RTCPReceiver::RemoteRTCPSenderInfo]](/show_bug.cgi?id=1653626) | Core | WebRTC: Audio/Video | docfaraday | RESO | FIXE | 2020-12-18 |
| [1651001](/show_bug.cgi?id=1651001 "VERIFIED FIXED - Assertion failure: !mEntered, at mozilla/Vector.h:470 or Assertion failure: WeakMapBase::checkMarkingForZone(zone), at gc/GC.cpp:4844 or Crash [@ MaybeCheckWeakMapMarking] with recomputeWrappers") |  | [Assertion failure: !mEntered, at mozilla/Vector.h:470 or Assertion failure: WeakMapBase::checkMarkingForZone(zone), at gc/GC.cpp:4844 or Crash [@ MaybeCheckWeakMapMarking] with recomputeWrappers](/show_bug.cgi?id=1651001) | Core | JavaScript Engine | sphink | VERI | FIXE | 2024-04-09 |
| [1656957](/show_bug.cgi?id=1656957 "VERIFIED FIXED - AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length") |  | [AddressSanitizer: heap-use-after-free /builds/worker/workspace/obj-build/dist/include/nsTArray.h:413:37 in Length](/show_bug.cgi?id=1656957) | Core | DOM: Core & HTML | simon.giesecke | VERI | FIXE | 2021-04-06 |

3 bugs found.

|  |  | [REST](/rest/bug?include_fields=id,summary,status&bug_id=1651001%2C1653626%2C1656957 "Query as a REST API request") | [CSV](/buglist.cgi?bug_id=1651001%2C1653626%2C1656957&query_format=advanced&ctype=csv&human=1) | [Feed](/buglist.cgi?bug_id=1651001%2C1653626%2C1656957&query_format=advanced&title=Bug%20List&ctype=atom) | [iCalendar](/buglist.cgi?bug_id=1651001%2C1653626%2C1656957&query_format=advanced&ctype=ics)  [Change Columns](/colchange.cgi?bug_id=1651001%2C1653626%2C1656957&query_format=advanced&query_based_on=) | [Edit Search](/query.cgi?bug_id=1651001%2C1653626%2C1656957&query_format=advanced) |  | as |
| --- | --- | --- | --- | --- | --- |

[File
a new bug
in the "Core" product](/enter_bug.cgi?product=Core)



=== Content from bugzilla.mozilla.org_e53d3fa0_20250119_142358.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1651520)
* [XML](/show_bug.cgi?ctype=xml&id=1651520)

Closed
[Bug 1651520](/show_bug.cgi?id=1651520)
(CVE-2020-15668)

Opened 5 years ago
Closed 5 years ago

# ThreadSanitizer: data race [@ NSC\_GetTokenInfo] vs. [@ NSC\_CloseSession]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

ThreadSanitizer: data race [@ NSC\_GetTokenInfo] vs. [@ NSC\_CloseSession]

## Categories

### (NSS :: Libraries, defect, P1)

[Product:](/describecomponents.cgi?product=NSS)

NSS
▾

NSS
Network Security Services - a cross-platform
security library ([more info](http://www.mozilla.org/projects/security/pki/nss/))
[See Open Bugs in This Product](/buglist.cgi?product=NSS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=NSS)
Watch This Product

[Component:](/describecomponents.cgi?product=NSS&component=Libraries#Libraries)

Libraries
▾

NSS :: Libraries
Libraries for client support of SSL v2 and v3, TLS, PKCS #5,
PKCS #7, PKCS #11, PKCS #12, S/MIME, X.509 v3 certificates,
and other security standards
[See Open Bugs in This Component](/buglist.cgi?product=NSS&component=Libraries&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=NSS&component=Libraries&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=NSS&component=Libraries)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

other

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

## Tracking

### (firefox-esr68 wontfix, firefox-esr78 wontfix, firefox78 wontfix, firefox79 wontfix, firefox80 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

3.55

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix) |
| firefox-esr78 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix) |
| firefox78 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=wontfix) |
| firefox79 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix) |
| firefox80 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr68 |  | wontfix |
| firefox-esr78 |  | wontfix |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox78 |  | wontfix |
| firefox79 |  | wontfix |
| firefox80 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: tsmith, Assigned: jcj)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=40)  [jcj](/user_profile?user_id=520206)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/078db09f952a32d7a60ed0a6d149c40d?d=mm&size=40)  [jcj](/user_profile?user_id=520206)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/a2837b951fa7dc639a2568203478ff0a?d=mm&size=40)  [tsmith](/user_profile?user_id=486634)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=40)  [beurdouche](/user_profile?user_id=622637)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[tsan](/show_bug.cgi?id=929478 "NEW - [meta] Make TSan (ThreadSanitizer) usable with Firefox")

Dependency [tree](/showdependencytree.cgi?id=1651520&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1651520)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-low, Whiteboard: [adv-main80+r])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-15668

[Keywords:](/describekeywords.cgi)

[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main80+r]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [mboldan](/user_profile?user_id=551058) | [qe-verify](#a1932379_551058 "4 years ago") | - |
| --- | --- | --- |
| [mboldan](/user_profile?user_id=551058) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [Detailed Crash Information](/attachment.cgi?id=9162318)  [5 years ago](#c0)  [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)   43.39 KB, text/plain |  | [Details](/attachment.cgi?id=9162318&action=edit) |
| --- | --- | --- |
| [Bug 1651520 - slotLock race in NSC\_GetTokenInfo r?kjacobs](/attachment.cgi?id=9162558)  [5 years ago](#c5)  [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206)   47 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9162558&action=edit) | [Review](/attachment.cgi?id=9162558) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1651520#c0)• 5 years ago |
|  | |

Attached file
[Detailed Crash Information](attachment.cgi?id=9162318)
— [Details](attachment.cgi?id=9162318&action=edit)

The attached crash information was detected by ThreadSanitizer during normal web browsing on mozilla-central 20200708-34fb169ef962. Marking as s-s to be safe.

### General information about TSan reports

#### Why fix races?

Data races are undefined behavior and can cause crashes as well as correctness issues. Compiler optimizations can cause racy code to have unpredictable and hard-to-reproduce behavior.

#### Rating

If you think this race can cause crashes or correctness issues, it would be great to rate the bug appropriately as P1/P2 and/or indicating this in the bug. This makes it a lot easier for us to assess the actual impact that these reports make and if they are helpful to you.

#### False Positives / Benign Races

Typically, races reported by TSan are not false positives [1], but it is possible that the race is benign. Even in this case it would be nice to come up with a fix if it is easily doable and does not regress performance. Every race that we cannot fix will have to remain on the suppression list and slows down the overall TSan performance. Also note that seemingly benign races can possibly be harmful (also depending on the compiler, optimizations and the architecture) [2][3].

[1] One major exception is the involvement of uninstrumented code from third-party libraries.

[2] <http://software.intel.com/en-us/blogs/2013/01/06/benign-data-races-what-could-possibly-go-wrong>

[3] How to miscompile programs with "benign" data races: <https://www.usenix.org/legacy/events/hotpar11/tech/final_files/Boehm.pdf>

#### Suppressing unfixable races

If the bug cannot be fixed, then a runtime suppression needs to be added in `mozglue/build/TsanOptions.cpp`. The suppressions match on the full stack, so it should be picked such that it is unique to this particular race. The bug number of this bug should also be included so we have some documentation on why this suppression was added.

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1651520#a320_349244)• 5 years ago |

Assignee: nobody → nobodyComponent: Security: PSM → LibrariesProduct: Core → NSSQA Contact: jjonesVersion: unspecified → other

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1651520#c1)• 5 years ago |
|  | |

I see "ImportCert" in one of the conflicting threads, but Tyson says this was during normal browsing in a single tab. Why would we be calling that?

Is this really NSS rather than PSM? I thought the threading here was set up in the browser.

Flags: needinfo?(jjones)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1651520#c2)• 5 years ago |
|  | |

It's NSS.

The NSS needs the certificates imported into the DB for trust calculations.

Basically, [`NSC_GetTokenInfo` doesn't lock `slot->slotLock` before accessing `slot` after obtaining it](https://searchfox.org/nss/rev/a412e70e55218aaf670f1f10322fa734d8a9fbde/lib/softoken/pkcs11.c#3656), even though [`slotLock` is defined as its lock](https://searchfox.org/nss/source/lib/softoken/pkcs11i.h#320-321).

Assignee: nobody → jjonesSeverity: -- → S2Status: NEW → ASSIGNEDFlags: needinfo?(jjones)Priority: -- → P1

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1651520#c3)• 5 years ago |
|  | |

This is hot-path for connecting TLS, so it's going to be interesting seeing what happens to performance, adding this lock. Anyway, patch coming!

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1651520#c4)• 5 years ago |
|  | |

I'm not sure this is actually exploitable. Marking sec-low as a stopgap, but probably we can just open this up.

Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [J.C. Jones [:jcj] (he/they)](/user_profile?user_id=520206)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1651520#c5)• 5 years ago |
|  | |

Attached file
[Bug 1651520 - slotLock race in NSC\_GetTokenInfo r?kjacobs](attachment.cgi?id=9162558)
— [Details](attachment.cgi?id=9162558&action=edit)

Basically, NSC\_GetTokenInfo doesn't lock slot->slotLock before accessing slot after obtaining it,

even though slotLock is defined as its lock. [0]

[0] <https://searchfox.org/nss/rev/a412e70e55218aaf670f1f10322fa734d8a9fbde/lib/softoken/pkcs11i.h#320-321>

|  | [Kevin Jacobs [:kjacobs]](/user_profile?user_id=636914) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1651520#c6)• 5 years ago |
|  | |

<https://hg.mozilla.org/projects/nss/rev/58c2abd7404eee86503e53be6d401297150f2ce3>

Status: ASSIGNED → RESOLVEDClosed: 5 years agoResolution: --- → FIXEDTarget Milestone: --- → 3.55

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1651520#a161339_75935)• 5 years ago |

Group: crypto-core-security → core-security-release
[status-firefox78](/buglist.cgi?f1=cf_status_firefox78&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox78&o1=equals&v1=wontfix)
[status-firefox79](/buglist.cgi?f1=cf_status_firefox79&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix)
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=wontfix)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=wontfix)

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1651520#a1932379_551058)• 4 years ago |

Flags: qe-verify-

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1651520#a3531843_578488)• 4 years ago |

Whiteboard: [adv-main80+r]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1651520#a4039023_578488)• 4 years ago |

Alias: CVE-2020-15668

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1651520#a43405272_1689)• 3 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1651520&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_a2a6133f_20250119_125554.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-39

## Security Vulnerabilities fixed in Firefox for Android 80

Announced
September 2, 2020
Impact
high
Products
Firefox for Android
Fixed in

* Firefox for Android 80

#### [#CVE-2020-15664: Attacker-induced prompt for extension installation](#CVE-2020-15664)

Reporter
Kaizer Soze
Impact
high
##### Description

By holding a reference to the `eval()` function from an about:blank window, a malicious webpage could have gained access to the InstallTrigger object which would allow them to prompt the user to install an extension. Combined with user confusion, this could result in an unintended or malicious extension being installed.

##### References

* [Bug 1658214](https://bugzilla.mozilla.org/show_bug.cgi?id=1658214)

#### [#CVE-2020-12401: Timing-attack on ECDSA signature generation](#CVE-2020-12401)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida García, Jesús-Javier Chi-Domínguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

During ECDSA signature generation, padding applied in the nonce designed to ensure constant-time scalar multiplication was removed, resulting in variable-time execution dependent on secret data.

##### References

* [Bug 1631573](https://bugzilla.mozilla.org/show_bug.cgi?id=1631573)

#### [#CVE-2020-6829: P-384 and P-521 vulnerable to an electro-magnetic side channel attack on signature generation](#CVE-2020-6829)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida García, Jesús-Javier Chi-Domínguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

When performing EC scalar point multiplication, the wNAF point multiplication algorithm was used; which leaked partial information about the nonce used during signature generation. Given an electro-magnetic trace of a few signature generations, the private key could have been computed.

##### References

* [Bug 1631583](https://bugzilla.mozilla.org/show_bug.cgi?id=1631583)

#### [#CVE-2020-12400: P-384 and P-521 vulnerable to a side channel attack on modular inversion](#CVE-2020-12400)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida García, Jesús-Javier Chi-Domínguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

When converting coordinates from projective to affine, the modular inversion was not performed in constant time, resulting in a possible timing-based side channel attack.

##### References

* [Bug 1623116](https://bugzilla.mozilla.org/show_bug.cgi?id=1623116)

#### [#CVE-2020-15666: MediaError message property leaks cross-origin response status](#CVE-2020-15666)

Reporter
Gunes Acar
Impact
low
##### Description

When trying to load a non-video in an audio/video context the exact status code (200, 302, 404, 500, 412, 403, etc.) was disclosed via the MediaError Message. This level of information leakage is inconsistent with the standardized onerror/onsuccess disclosure and can lead to inferring login status to services or device discovery on a local network among other attacks.

##### References

* [Bug 1450853](https://bugzilla.mozilla.org/show_bug.cgi?id=1450853)

#### [#CVE-2020-15668: Data Race when reading certificate information](#CVE-2020-15668)

Reporter
Tyson Smith
Impact
low
##### Description

A lock was missing when accessing a data structure and importing certificate information into the trust database.

##### References

* [Bug 1651520](https://bugzilla.mozilla.org/show_bug.cgi?id=1651520)

#### [#CVE-2020-15671: Passwords could be saved to phone keyboard dictionary](#CVE-2020-15671)

Reporter
Karol Frejlich
Impact
low
##### Description

When typing in a password under certain conditions, a race may have occured where the InputContext was not being correctly set for the input field, resulting in the typed passwod being saved to the keyboard dictionary.

##### References

* [Bug 1653862](https://bugzilla.mozilla.org/show_bug.cgi?id=1653862)

#### [#CVE-2020-15670: Memory safety bugs fixed in Firefox for Android 80](#CVE-2020-15670)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Jason Kratzer, Christian Holler, and Byron Campen reported memory safety bugs present in Firefox for Android 79. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox for Android 80](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1651001%2C1653626%2C1656957)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_19945826_20250119_125552.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-36

## Security Vulnerabilities fixed in Firefox 80

Announced
August 25, 2020
Impact
high
Products
Firefox
Fixed in

* Firefox 80

#### [#CVE-2020-15663: Downgrade attack on the Mozilla Maintenance Service could have resulted in escalation of privilege](#CVE-2020-15663)

Reporter
Xiaoyin Liu
Impact
high
##### Description

If Firefox is installed to a user-writable directory, the Mozilla Maintenance Service would execute updater.exe from the install location with administrative privileges. Although the Mozilla Maintenance Service does ensure that updater.exe is signed by Mozilla, the version could have been rolled back to a previous version which would have allowed exploitation of an older bug and arbitrary code execution with system privileges.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1643199](https://bugzilla.mozilla.org/show_bug.cgi?id=1643199)

#### [#CVE-2020-15664: Attacker-induced prompt for extension installation](#CVE-2020-15664)

Reporter
Kaizer Soze
Impact
high
##### Description

By holding a reference to the `eval()` function from an about:blank window, a malicious webpage could have gained access to the InstallTrigger object which would allow them to prompt the user to install an extension. Combined with user confusion, this could result in an unintended or malicious extension being installed.

##### References

* [Bug 1658214](https://bugzilla.mozilla.org/show_bug.cgi?id=1658214)

#### [#CVE-2020-12401: Timing-attack on ECDSA signature generation](#CVE-2020-12401)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida García, Jesús-Javier Chi-Domínguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

During ECDSA signature generation, padding applied in the nonce designed to ensure constant-time scalar multiplication was removed, resulting in variable-time execution dependent on secret data.

##### References

* [Bug 1631573](https://bugzilla.mozilla.org/show_bug.cgi?id=1631573)

#### [#CVE-2020-6829: P-384 and P-521 vulnerable to an electro-magnetic side channel attack on signature generation](#CVE-2020-6829)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida García, Jesús-Javier Chi-Domínguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

When performing EC scalar point multiplication, the wNAF point multiplication algorithm was used; which leaked partial information about the nonce used during signature generation. Given an electro-magnetic trace of a few signature generations, the private key could have been computed.

##### References

* [Bug 1631583](https://bugzilla.mozilla.org/show_bug.cgi?id=1631583)

#### [#CVE-2020-12400: P-384 and P-521 vulnerable to a side channel attack on modular inversion](#CVE-2020-12400)

Reporter
Sohaib ul Hassan, Iaroslav Gridin, Ignacio M. Delgado-Lozano, Cesar Pereida García, Jesús-Javier Chi-Domínguez, Alejandro Cabrera Aldaya, and Billy Bob Brumley, Network and Information Security (NISEC) Group, Tampere University, Finland
Impact
moderate
##### Description

When converting coordinates from projective to affine, the modular inversion was not performed in constant time, resulting in a possible timing-based side channel attack.

##### References

* [Bug 1623116](https://bugzilla.mozilla.org/show_bug.cgi?id=1623116)

#### [#CVE-2020-15665: Address bar not reset when choosing to stay on a page after the beforeunload dialog is shown](#CVE-2020-15665)

Reporter
Luan Herrera
Impact
moderate
##### Description

Firefox did not reset the address bar after the beforeunload dialog was shown if the user chose to remain on the page. This could have resulted in an incorrect URL being shown when used in conjunction with other unexpected browser behaviors.

##### References

* [Bug 1651636](https://bugzilla.mozilla.org/show_bug.cgi?id=1651636)

#### [#CVE-2020-15666: MediaError message property leaks cross-origin response status](#CVE-2020-15666)

Reporter
Gunes Acar
Impact
low
##### Description

When trying to load a non-video in an audio/video context the exact status code (200, 302, 404, 500, 412, 403, etc.) was disclosed via the MediaError Message. This level of information leakage is inconsistent with the standardized onerror/onsuccess disclosure and can lead to inferring login status to services or device discovery on a local network among other attacks.

##### References

* [Bug 1450853](https://bugzilla.mozilla.org/show_bug.cgi?id=1450853)

#### [#CVE-2020-15667: Heap overflow when processing an update file](#CVE-2020-15667)

Reporter
crixer
Impact
low
##### Description

When processing a MAR update file, after the signature has been validated, an invalid name length could result in a heap overflow, leading to memory corruption and potentially arbitrary code execution. Within Firefox as released by Mozilla, this issue is only exploitable with the Mozilla-controlled signing key.

##### References

* [Bug 1653371](https://bugzilla.mozilla.org/show_bug.cgi?id=1653371)

#### [#CVE-2020-15668: Data Race when reading certificate information](#CVE-2020-15668)

Reporter
Tyson Smith
Impact
low
##### Description

A lock was missing when accessing a data structure and importing certificate information into the trust database.

##### References

* [Bug 1651520](https://bugzilla.mozilla.org/show_bug.cgi?id=1651520)

#### [#CVE-2020-15670: Memory safety bugs fixed in Firefox 80 and Firefox ESR 78.2](#CVE-2020-15670)

Reporter
Mozilla developers
Impact
high
##### Description

Mozilla developers Jason Kratzer, Christian Holler, and Byron Campen reported memory safety bugs present in Firefox 79 and Firefox ESR 78.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 80 and Firefox ESR 78.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1651001%2C1653626%2C1656957)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_0373e2f6_20250119_142401.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1658214)
* [XML](/show_bug.cgi?ctype=xml&id=1658214)

Closed
[Bug 1658214](/show_bug.cgi?id=1658214)
(CVE-2020-15664)

Opened 4 years ago
Closed 4 years ago

# InstallTrigger can take the principal from the wrong inner window when initialized

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

InstallTrigger can take the principal from the wrong inner window when initialized

## Categories

### (Toolkit :: Add-ons Manager, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Add-ons%20Manager#Add-ons%20Manager)

Add-ons Manager
▾

Toolkit :: Add-ons Manager
The management and update windows for extensions and themes (add-ons).
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Add-ons%20Manager&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Add-ons%20Manager&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Add-ons%20Manager)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 81

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

81 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | [80+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=80%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed) |
| firefox-esr78 | [80+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=80%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed) |
| firefox79 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix) |
| firefox80 | [+](/buglist.cgi?f1=cf_tracking_firefox80&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed) |
| firefox81 | [+](/buglist.cgi?f1=cf_tracking_firefox81&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr68 | 80+ | fixed |
| firefox-esr78 | 80+ | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox79 |  | wontfix |
| firefox80 | + | fixed |
| firefox81 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: kaizersoze915, Assigned: kmag)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/06a624a82dd4430f86e9a67b300eecb3?d=mm&size=40)  [kmag](/user_profile?user_id=106098)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/7ff58cc3c5d778b476fb1b5f6a2dd923?d=mm&size=40)  [kaizersoze915](/user_profile?user_id=668173)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/2132cf6e7db0fa0e604b86d120c813ee?d=mm&size=40)  [zombie](/user_profile?user_id=445095)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [adv-main80+][adv-esr68.12+][adv-esr78.2+][sec-survey])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-15664

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main80+][adv-esr68.12+][adv-esr78.2+][sec-survey]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a1550263_1689 "4 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [inheritPermissions-testcase-new.html](/attachment.cgi?id=9169064)  [4 years ago](#c0)  [Kaizer Soze](/user_profile?user_id=668173)   983 bytes, text/html |  | [Details](/attachment.cgi?id=9169064&action=edit) |
| --- | --- | --- |
| [Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley](/attachment.cgi?id=9169274)  [4 years ago](#c7)  [Kris Maglione [:kmag]](/user_profile?user_id=106098)   47 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-beta+](#c16 "4 years ago")  RyanVM : [approval-mozilla-esr68+](#c16 "4 years ago")  RyanVM : [approval-mozilla-esr78+](#c16 "4 years ago")  tjr : [sec-approval+](#c14 "4 years ago") | [Details](/attachment.cgi?id=9169274&action=edit) | [Review](/attachment.cgi?id=9169274) |
| [advisory.txt](/attachment.cgi?id=9171197)  [4 years ago](#c20)  [Tom Ritter [:tjr]](/user_profile?user_id=578488)   392 bytes, text/plain |  | [Details](/attachment.cgi?id=9171197&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Kaizer Soze](/user_profile?user_id=668173)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1658214#c0)• 4 years ago |
|  | |

Attached file
[inheritPermissions-testcase-new.html](attachment.cgi?id=9169064)
— [Details](attachment.cgi?id=9169064&action=edit)

User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko/20100101 Firefox/79.0

Steps to reproduce:

I created a form, that first loads about:blank into a full new window. I then used the onsubmit handler to load <https://fpn.firefox.com/> into this window which has the extension install permission, while holding a reference to the eval function for that window. Upon submitting the form I have scripted an install of ghostery.

Actual results:

The secondary prompt still displays, which asks a user for permissions to be allowed. Currently this stops a full install of a webextension, but allows for one to attempt more exploitation by manipulating input into Extensions.jsm.

Expected results:

Holding a reference to the eval function of a window should not allow one to inherit permissions of the window that is loaded. This allows all permissions to be inherited but proper defense in depth stops things like accessing video/microphone streams.

Storage APIs may still be able to be manipulated, as I have not had time to fully test this. This could allow one to pollute the local storage of extensions, and persistent webworker pages.

|  | [Kaizer Soze](/user_profile?user_id=668173)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1658214#c1)• 4 years ago |
|  | |

Hey guys, I haven't had time to fully follow up on the storage API permissions and such yet. I will continue to work on this as a fix is put in place. For any additional info please NI me.

Also, can I get this nominated for a sec-bounty? I know back in the day we would have made this a moderate but things have been changing. The potential for exploiting code in Extensions.jsm is high but my time is low.

I happened to mention a bug to Bobby a couple of days ago, I'll link him here.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a18155_1689)• 4 years ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a74139_1689)• 4 years ago |

Group: firefox-core-security → dom-core-securityComponent: Untriaged → DOM: Core & HTMLProduct: Firefox → Core

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1658214#c2)• 4 years ago |
|  | |

Kris, do you have cycles to have a look here?

Flags: needinfo?(kmaglione+bmo)

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1658214#c3)• 4 years ago |
|  | |

I haven't actually debugged the testcase. But the way this is supposed to work is: Synchronously-created windows (iframes, and the return value of window.open) have an initial about:blank document that is same-origin with the creator. Upon navigation, we reuse/persist the global of that about:blank document (and thus globals like eval) of the initial about:blank window if the navigated-to document is same-origin.

So in general, the holdEval trick used in the testcase should just be acquiring the eval of the initial about:blank window, which should be different from fpn.firefox.com, and thus safe from a same-origin-policy perspective. But it could be the case that the permission handling here is out-of-band somehow, and that the inactive inner window is doing permission checks via the active one (via the outer/docshell). If that were the case, that would be bad.

|  | [Kaizer Soze](/user_profile?user_id=668173)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1658214#c4)• 4 years ago |
|  | |

I'll try to save you *some* time with the debugging. InstallTrigger is still only created upon request. Eval allows access to it as if it is the InstallTrigger Object of the about:blank page. InstallTrigger gets the principal it is working with from the window it is created for as it is accessed (lazy initialization). This makes the extension installation case a primary way to show this off.

As for further debugging, other permissions are inherited but only possibly useful case by case. Most seem to have proper defense in depth to prevent similar abuse. This eval trick was only to show off that permissions can get inherited and not meant to be a major point here. I know with so much attention being on webextensions right now, this was a good place to start.

As for further exploitation, I assume all the code in Extensions.jsm isn't supposed to be web facing. I have done practically no work on the storage issues this could lead to, as there's just no time for me to right now.

If I'm interrupting here and you guys want to just roll with this, that's fine with me. My debugging skills definitely aren't as sharp as most.

|  | [Bobby Holley (:bholley)](/user_profile?user_id=313730) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1658214#c5)• 4 years ago |
|  | |

Looks like InstallTrigger is JS-implemented WebIDL [1]. Implementing in JS makes it much easier to succumb to inner/outer window confusion, wonder if that's what's happening here.

(To be clear I'm just speculating here since I don't have cycles to actually dig in. Hopefully Kris does.)

[1] <https://searchfox.org/mozilla-central/rev/ab81b8552f4aa9696a2524f97fdfeb59d4dc31c1/dom/webidl/InstallTrigger.webidl#23>

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1658214#c6)• 4 years ago |
|  | |

Yeah, it's a case of inner window confusion. The InstallTrigger's init method takes a window object, and saves the principal from its current document, when it's first initialized. If that happens after the window has navigated, then it winds up taking it from whatever the current document is.

We should probably just forbid initializing any JS-implemented WebIDL globals when their inner window isn't active.

Assignee: nobody → kmaglione+bmoGroup: dom-core-security → firefox-core-securityStatus: UNCONFIRMED → ASSIGNEDComponent: DOM: Core & HTML → Add-ons ManagerEver confirmed: trueFlags: needinfo?(kmaglione+bmo)Product: Core → ToolkitSummary: It's possible to inherit permissions cross domain including the webextension install permission. → InstallTrigger can take the principal from the wrong inner window when initialized

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1658214#c7)• 4 years ago |
|  | |

Attached file
[Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley](attachment.cgi?id=9169274)
— [Details](attachment.cgi?id=9169274&action=edit)

|  | [Kaizer Soze](/user_profile?user_id=668173)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1658214#c8)• 4 years ago |
|  | |

Hey guys, could we get a sec-rating here? Thanks

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1658214#c9)• 4 years ago |
|  | |

This should get a rating before it lands, as that will affect sec-approval. Maybe Dan has some thoughts on a rating.

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1658214#c10)• 4 years ago |
|  | |

As-is the testcase is a super bad spoof: wouldn't be too hard to imagine a "click here to get uBlock Origin from addons.mozilla.org" link, that when clicked opens AMO to the legit uBlock Origin page, and then uses this trick to prompt to install something else with a similar name. Or same name even? not sure the automatic scans require names to be unique. That's not quite sec-high because that powerful spoofing scenario is limited to a single site and action -- but it's a super powerful action!

There are two other objects created using the function that's being patched (that I found -- are there more?). One was the sidebar/add search provider function, but that's a deprecated stub and not useful. The other was the AddonManager. Looking at the IsValidHost logic it ought to be available on AMO but I couldn't get it to work. If you can it would be super powerful. AddonManager.getAddonByID() alone is fantastically useful. You could fingerprint people based on what they have installed. It looks like the "SyncGUID" is a per-install generated thing, if the victim has Sync. If the addon has an icon the URL gives me the full file path to the extension in my profile -- so that gets leaked if someone has a "load known local file" exploit. And if you could make this work and you didn't like adblockers you could have fun with this:

1. Install uBlock Origin if you don't have it already
2. open about:preferences (need it privileged since I couldn't get AMO to work)
3. open the DevTools console
4. execute `(await AddonManager.getAddonByID("uBlock0@raymondhill.net")).disable()`

If you want to play and see what other data is available do `await AddonManager.getAddonByID("uBlock0@raymondhill.net")`

.uninstall() also works (more realistic attack) but harder to undo as a test! change disable() to enable() to get your addon back (or manually in about:addons).

Like I said, I couldn't make that actually work on AMO, but maybe I'm missing something. It's certainly a juicy enough target to be worth playing with.

Testcase works on Firefox ESR-68 (as expected) so we'll need a patch for that, too. The "fpn" site wasn't in the whitelist back then so you have to either manually add the site as an ALLOW exception first, or modify the testcase to use AMO which *was* in the built-in exception list.

[status-firefox79](/buglist.cgi?f1=cf_status_firefox79&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix)
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected)
[status-firefox81](/buglist.cgi?f1=cf_status_firefox81&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=affected)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected)
[tracking-firefox80](/buglist.cgi?f1=cf_tracking_firefox80&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox80&o1=equals&v1=%2B)
[tracking-firefox81](/buglist.cgi?f1=cf_tracking_firefox81&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox81&o1=equals&v1=%2B)
[tracking-firefox-esr68](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=isnotempty):
--- → [80+](/buglist.cgi?f1=cf_tracking_firefox_esr68&o1=equals&v1=80%2B)
[tracking-firefox-esr78](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=isnotempty):
--- → [80+](/buglist.cgi?f1=cf_tracking_firefox_esr78&o1=equals&v1=80%2B)Flags: needinfo?(dveditz)Keywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1658214#c11)• 4 years ago |
|  | |

The AddonManager API isn't vulnerable to this issue. The decision on whether or not to make that available happens in C++ via `AddonManagerWebAPI::IsAPIEnabled`, which isn't susceptible to inner window confusion.

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1658214#c12)• 4 years ago |
|  | |

We should land this soon to make 80. Kris, can you request sec-approval?

Flags: needinfo?(kmaglione+bmo)

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1658214#c13)• 4 years ago |
|  | |

Comment on [attachment 9169274](/attachment.cgi?id=9169274 "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") [[details]](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley")

[Bug 1658214](/show_bug.cgi?id=1658214 "RESOLVED FIXED - InstallTrigger can take the principal from the wrong inner window when initialized"): Only construct JS-implemented objects if inner window is current. r=bholley

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Fairly easily, given the small number of APIs constructed this way, but the actual risk of the exploit is relatively low.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: All
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: No
* **If not, how different, hard to create, and risky will they be?**: It should already apply cleanly to all branches.
* **How likely is this patch to cause regressions; how much testing does it need?**: Unlikely. It only affects constructing objects for 3 rarely-used APIs when a window has been navigated away from, which no valid code should be relying on.
Flags: needinfo?(kmaglione+bmo)
[Attachment #9169274](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1658214#c14)• 4 years ago |
|  | |

Comment on [attachment 9169274](/attachment.cgi?id=9169274 "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") [[details]](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley")

[Bug 1658214](/show_bug.cgi?id=1658214 "RESOLVED FIXED - InstallTrigger can take the principal from the wrong inner window when initialized"): Only construct JS-implemented objects if inner window is current. r=bholley

Land it and let's get it uplifted too.

[Attachment #9169274](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") -
Flags: sec-approval? → sec-approval+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1658214#c15)• 4 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/1edd9346c110b011ed87e50eb3d417202ea445fb>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1658214#c16)• 4 years ago |
|  | |

Comment on [attachment 9169274](/attachment.cgi?id=9169274 "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") [[details]](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley")

[Bug 1658214](/show_bug.cgi?id=1658214 "RESOLVED FIXED - InstallTrigger can take the principal from the wrong inner window when initialized"): Only construct JS-implemented objects if inner window is current. r=bholley

Also approved for 80.0rc1, 78.2esr, and 68.12esr.

[Attachment #9169274](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") -
Flags: approval-mozilla-esr78+
[Attachment #9169274](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") -
Flags: approval-mozilla-esr68+
[Attachment #9169274](/attachment.cgi?id=9169274&action=edit "Bug 1658214: Only construct JS-implemented objects if inner window is current. r=bholley") -
Flags: approval-mozilla-beta+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1658214#c17)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/6fa858e9b31d>

<https://hg.mozilla.org/releases/mozilla-esr78/rev/bbbd6d1ea0f5>

<https://hg.mozilla.org/releases/mozilla-esr68/rev/4bdb757c65b2>

[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=fixed)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=fixed)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1658214#c18)• 4 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/1edd9346c110>

Group: firefox-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 4 years ago
[status-firefox81](/buglist.cgi?f1=cf_status_firefox81&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 81 Branch

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a776039_578488)• 4 years ago |

Whiteboard: [adv-main80+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a776242_578488)• 4 years ago |

Whiteboard: [adv-main80+] → [adv-main80+][adv-esr68.12+]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a776315_578488)• 4 years ago |

Whiteboard: [adv-main80+][adv-esr68.12+] → [adv-main80+][adv-esr68.12+][adv-esr78.2+]

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1658214#c19)• 4 years ago |
|  | |

As part of a security bug pattern analysis, we are requesting your help with a high level analysis of this bug. It is our hope to develop static analysis (or potentially runtime/dynamic analysis) in the future to identify classes of bugs.

Please visit [this google form](https://docs.google.com/forms/d/e/1FAIpQLSe9uRXuoMK6tRglbNL5fpXbun_oEb6_xC2zpuE_CKA_GUjrvA/viewform?usp=pp_url&entry.2124261401=https%3A%2F%2Fbugzilla.mozilla.org%2Fshow_bug.cgi%3Fid%3D1658214) to reply.

Flags: needinfo?(kmaglione+bmo)Whiteboard: [adv-main80+][adv-esr68.12+][adv-esr78.2+] → [adv-main80+][adv-esr68.12+][adv-esr78.2+][sec-survey]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1658214#c20)• 4 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9171197)
— [Details](attachment.cgi?id=9171197&action=edit)

Here's an attempt at an advisory, LMK if anyone thinks it can be worded better.

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a1282993_578488)• 4 years ago |

Alias: CVE-2020-15664

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a1550263_1689)• 4 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Kris Maglione [:kmag]](/user_profile?user_id=106098)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a4494174_106098)• 4 years ago |

Flags: needinfo?(kmaglione+bmo)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a11337674_1689)• 4 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1658214#a120086326_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1658214&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Kaizer Soze](/user_profile?user_id=668173)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_16daccdb_20250119_125553.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-38

## Security Vulnerabilities fixed in Firefox ESR 78.2

Announced
August 25, 2020
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 78.2

#### [#CVE-2020-15663: Downgrade attack on the Mozilla Maintenance Service could have resulted in escalation of privilege](#CVE-2020-15663)

Reporter
Xiaoyin Liu
Impact
high
##### Description

If Firefox is installed to a user-writable directory, the Mozilla Maintenance Service would execute updater.exe from the install location with system privileges. Although the Mozilla Maintenance Service does ensure that updater.exe is signed by Mozilla, the version could have been rolled back to a previous version which would have allowed exploitation of an older bug and arbitrary code execution with System Privileges.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1643199](https://bugzilla.mozilla.org/show_bug.cgi?id=1643199)

#### [#CVE-2020-15664: Attacker-induced prompt for extension installation](#CVE-2020-15664)

Reporter
Kaizer Soze
Impact
high
##### Description

By holding a reference to the `eval()` function from an about:blank window, a malicious webpage could have gained access to the InstallTrigger object which would allow them to prompt the user to install an extension. Combined with user confusion, this could result in an unintended or malicious extension being installed.

##### References

* [Bug 1658214](https://bugzilla.mozilla.org/show_bug.cgi?id=1658214)

#### [#CVE-2020-15670: Memory safety bugs fixed in Firefox 80 and Firefox ESR 78.2](#CVE-2020-15670)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Jason Kratzer, Christian Holler, and Byron Campen reported memory safety bugs present in Firefox 79 and Firefox ESR 78.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 80 and Firefox ESR 78.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1651001%2C1653626%2C1656957)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_327a62eb_20250119_142356.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1653862)
* [XML](/show_bug.cgi?ctype=xml&id=1653862)

Closed
[Bug 1653862](/show_bug.cgi?id=1653862)
(CVE-2020-15671)

Opened 5 years ago
Closed 4 years ago

# Firefox save gmail password into phone dicrtionarty

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox save gmail password into phone dicrtionarty

## Categories

### (GeckoView :: General, defect)

[Product:](/describecomponents.cgi?product=GeckoView)

GeckoView
▾

GeckoView
The GeckoView components for Android
[See Open Bugs in This Product](/buglist.cgi?product=GeckoView&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=GeckoView)
Watch This Product

[Component:](/describecomponents.cgi?product=GeckoView&component=General#General)

General
▾

GeckoView :: General
The GeckoView embedding widget for Android
[See Open Bugs in This Component](/buglist.cgi?product=GeckoView&component=General&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=GeckoView&component=General&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=GeckoView&component=General)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### (firefox-esr68 unaffected, firefox-esr78 unaffected, firefox79 wontfix, firefox80 verified, firefox81 verified)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

81 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr68 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=unaffected) |
| firefox-esr78 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected) |
| firefox79 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix) |
| firefox80 | --- | [verified](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=verified) |
| firefox81 | --- | [verified](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr68 |  | unaffected |
| firefox-esr78 |  | unaffected |
| firefox79 |  | wontfix |
| firefox80 |  | verified |
| firefox81 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: karol.fredo, Assigned: m\_kato)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/1875645d5594d36bca29657d51d24ed6?d=mm&size=40)  [m\_kato](/user_profile?user_id=8636)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/e04fb5e6a50d6df543ae3ce29a3dbb9e?d=mm&size=40)  [karol.fredo](/user_profile?user_id=666968)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/418efed494240195b86667307fe63d5c?d=mm&size=40)  [owlish](/user_profile?user_id=579431)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

17 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-disclosure, sec-low, Whiteboard: [adv-main80+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2020-15671

[Keywords:](/describekeywords.cgi)

[csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main80+]

QA Whiteboard:

[qa-triaged]

Has STR:

---

Change Request:

---

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [example](/attachment.cgi?id=9165113)  [4 years ago](#c4)  [Karol Frejlich](/user_profile?user_id=666968)   181.04 KB, image/png |  | [Details](/attachment.cgi?id=9165113&action=edit) |
| --- | --- | --- |
| [Bug 1653862 - Set InputContext after getting focus.](/attachment.cgi?id=9167814)  [4 years ago](#c11)  [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)   47 bytes, text/x-phabricator-request | jcristau : [approval-mozilla-release+](#c20 "4 years ago") | [Details](/attachment.cgi?id=9167814&action=edit) | [Review](/attachment.cgi?id=9167814) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Karol Frejlich](/user_profile?user_id=666968)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1653862#c0)• 5 years ago |
|  | |

User Agent: Mozilla/5.0 (Android 8.0.0; Mobile; rv:79.0) Gecko/79.0 Firefox/79.0

Steps to reproduce:

Firefox version: 79.0.0-beta.9 Build #2015752523

Phone HW: Sony XPERIA XZ F8331

Android version: 8.0.0

Steps:

1. Open Gmail lagin page on Firefox Beta.
2. Enter login to Gmail (email)
3. Enter password to Gmail account

Actual results:

3.A. Entered password is shown above the virtual keyboard

3.B. Password was saved into Phone keyboard dictionary (it is available to see, ald it is proposed when writing On other pages/application)

IMPORTANT!

This issue does not occur on Firefox 68.10.1 (release on Google Play), that is why I think it is problem with Firefox Beta 79.0.0-beta.9

Expected results:

3.A Password should not be displayed when it is entering

3.B Password should not be saved into Phone keyboard dictionary

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1653862#c1)• 5 years ago |
|  | |

Chenxia would you forward this to the correct person to investigate this?

Component: Logins, Passwords and Form Fill → Security: AndroidFlags: needinfo?(liuche)Product: Firefox for Android → FenixVersion: Firefox 79 → unspecified

|  | [Stefan Arentz | :st3fan | ⏰ EST | he/him](/user_profile?user_id=388264) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1653862#c2)• 5 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1653862&comment_id=14947025 "1 revision") |
|  | |

What keyboard is being used? Can we verify this on a stock android phone?

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1653862#c3)• 5 years ago |
|  | |

I can't reproduce this with the Google Keyboard. This might depend on the Xperia keyboard.

|  | [Chenxia Liu [:liuche]](/user_profile?user_id=420448) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1653862#a119759_420448)• 4 years ago |

Flags: needinfo?(liuche)

|  | [Karol Frejlich](/user_profile?user_id=666968)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1653862#c4)• 4 years ago |
|  | |

Attached image
[example](attachment.cgi?id=9165113)
— [Details](attachment.cgi?id=9165113&action=edit)

|  | [Emily Kager [:ekager]](/user_profile?user_id=597050) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1653862#c5)• 4 years ago |
|  | |

We are already setting the flag `IME_FLAG_NO_PERSONALIZED_LEARNING` on all fields [in GV `GeckoEditable`](https://searchfox.org/mozilla-central/search?q=IME_FLAG_NO_PERSONALIZED_LEARNING&path=), [which according to the docs](https://developer.android.com/reference/android/view/inputmethod/EditorInfo.html#IME_FLAG_NO_PERSONALIZED_LEARNING) is "used to request that the IME should not update any personalized data such as typing history and personalized language model based on what the user typed on this text editing object. Typical use cases are:

* When the application is in a special mode, where user's activities are expected to be not recorded in the application's history. Some web browsers and chat applications may have this kind of modes.
* When storing typing history does not make much sense. Specifying this flag in typing games may help to avoid typing history from being filled up with words that the user is less likely to type in their daily life. Another example is that when the application already knows that the expected input is not a valid word (e.g. a promotion code that is not a valid word in any natural language)."

One possibly relevant piece of info from the docs - "Applications need to be aware that the flag is not a guarantee, and some IMEs may not respect it."

The second thing I looked into is where we are [setting the text flags by field hint in `GeckoEditable`](https://searchfox.org/mozilla-central/rev/3b6958c26049c1e27b2790a43154caaba9f6dd4a/mobile/android/geckoview/src/main/java/org/mozilla/geckoview/GeckoEditable.java#1624). Password types get `TYPE_TEXT_VARIATION_PASSWORD` set on the inputType when it's a password field.

One thing we could try is adding `TYPE_TEXT_FLAG_NO_SUGGESTIONS` to the password fields as well, which according to the docs - "Flag for TYPE\_CLASS\_TEXT: the input method does not need to display any dictionary-based candidates."

There might be a valid reason we don't already add this flag, so NI-ing m\_kato from GV team here.

Flags: needinfo?(m\_kato)

|  | [Karol Frejlich](/user_profile?user_id=666968)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1653862#c6)• 4 years ago |
|  | |

(In reply to Stefan Arentz | :st3fan | ⏰ EST | he/him from [comment #2](/show_bug.cgi?id=1653862#c2 "VERIFIED FIXED - Firefox save gmail password into phone dicrtionarty"))

> What keyboard is being used? Can we verify this on a stock android phone?

Used keyboard: Microsoft SwiftKey 7.5.9.3

I have attached screenshot that presents the problem. I have used example (not real :D) password "examplepasswod". As described in description, it was displayed and saved in phone dictionary.

I was thinking, that it could be issue on gmail page or keyboard, but on Firefox 68.10.1 it works fine.

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1653862#c7)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1653862&comment_id=14949444 "1 revision") |
|  | |

Using Firefox Nightly with the latest SwiftKey from GPlay. I am not seeing the information persist in the dictionary or suggested words. I am seeing the text that is being typed in the password field in some cases displayed in the suggestion area. Submitting the password results in the password field being treated as expected with `IME_FLAG_NO_PERSONALIZED_LEARNING` and subsequent typing does not trigger the suggestions.

* first run
* if the user taps the eye icon in the password field
* clearing private data

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1653862#c8)• 4 years ago |
|  | |

I can reproduce the same behavior in Reference Browser and Focus. I cannot reproduce what I see in [comment 7](/show_bug.cgi?id=1653862#c7 "VERIFIED FIXED - Firefox save gmail password into phone dicrtionarty") in Chrome.

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1653862#c9)• 4 years ago |
|  | |

`IME_FLAG_NO_PERSONALIZED_LEARNING` means that IME doesn't record input history for suggestion. This is for guest session, or private mode. So this isn't related.

When looking this screen shot, keyboard layout on Swift Key isn't for password style. (Password layout style of Swift Key has number keys.)

When I test this, this sometimes occur, but not always. When this issue occurs, focus already is gotten on password field, but when this doesn't occur, no focus when showing password field on this site.

After that, when re-focus to password field, it can change to valid keyboard correctly. I think `InputContext` doesn't pass valid input type from `IMEStateManager`, or `GeckoEditable` doesn't initialize keyboard layout per `EditorInfo` for this situation.

But this issue depends on web content and I need analyze gmail's user name and password navigation.

Assignee: nobody → m\_katoStatus: UNCONFIRMED → NEWEver confirmed: trueFlags: needinfo?(m\_kato)

|  | [Kevin Brosnan [Ex-Mozilla]](/user_profile?user_id=406670) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1653862#c10)• 4 years ago |
|  | |

Should we open this up? I'm not seeing any great harm to users in this issue currently.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1653862#a347982_1689)• 4 years ago |

[status-firefox79](/buglist.cgi?f1=cf_status_firefox79&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=affected)
[status-firefox-esr68](/buglist.cgi?f1=cf_status_firefox_esr68&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr68&o1=equals&v1=unaffected)Keywords: [csectype-disclosure](/buglist.cgi?keywords=csectype-disclosure&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---)

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1653862#c11)• 4 years ago |
|  | |

Attached file
[Bug 1653862 - Set InputContext after getting focus.](attachment.cgi?id=9167814)
— [Details](attachment.cgi?id=9167814&action=edit)

This is timing issue to set `InputContext` that is used by setting keyboard

layout.

`InputContext` is set by chrome process only. Since we want to use it on

child process, we store cached value by `NOTIFY_IME_OF_FOCUS`. But before

setting it, we may use old cached value unfortunately.

So we have to wait until valid cached `InputContext` is set.

Also, I add some assertions for this check.

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1653862#c12)• 4 years ago |
|  | |

Comment on [attachment 9167814](/attachment.cgi?id=9167814 "Bug 1653862 - Set InputContext after getting focus.") [[details]](/attachment.cgi?id=9167814&action=edit "Bug 1653862 - Set InputContext after getting focus.")

[Bug 1653862](/show_bug.cgi?id=1653862 "VERIFIED FIXED - Firefox save gmail password into phone dicrtionarty") - Set InputContext after getting focus.

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: It isn't easy since this is timing issue, but this can reproduce on account.google.com.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which older supported branches are affected by this flaw?**: all (this issue occurs on GV only)
* **If not all supported branches, which bug introduced the flaw?**: None
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: Low risk. When setting focus by user operation, this issue doesn't occurs and we don't use this code path of this bug.

  If we need manual test, we should test on login form of google.com, facebook.com, microsoft.com and major sites.
[Attachment #9167814](/attachment.cgi?id=9167814&action=edit "Bug 1653862 - Set InputContext after getting focus.") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1653862#c13)• 4 years ago |
|  | |

Comment on [attachment 9167814](/attachment.cgi?id=9167814 "Bug 1653862 - Set InputContext after getting focus.") [[details]](/attachment.cgi?id=9167814&action=edit "Bug 1653862 - Set InputContext after getting focus.")

[Bug 1653862](/show_bug.cgi?id=1653862 "VERIFIED FIXED - Firefox save gmail password into phone dicrtionarty") - Set InputContext after getting focus.

sec-low does not require sec-approval to land :)

[Attachment #9167814](/attachment.cgi?id=9167814&action=edit "Bug 1653862 - Set InputContext after getting focus.") -
Flags: sec-approval?

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1653862#c14)• 4 years ago |
|  | |

<https://hg.mozilla.org/integration/autoland/rev/b4ed6e66a889ef0772ed635eb0af737fd6f4ee85>

<https://hg.mozilla.org/mozilla-central/rev/b4ed6e66a889>

Group: mobile-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 4 years ago
[status-firefox81](/buglist.cgi?f1=cf_status_firefox81&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=fixed)Resolution: --- → FIXED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1653862#c15)• 4 years ago |
|  | |

Please nominate this for Beta approval.

[status-firefox79](/buglist.cgi?f1=cf_status_firefox79&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox79&o1=equals&v1=wontfix)
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected)
[status-firefox-esr78](/buglist.cgi?f1=cf_status_firefox_esr78&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr78&o1=equals&v1=unaffected)Flags: needinfo?(m\_kato)

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1653862#c16)• 4 years ago |
|  | |

Ryan, doesn't "Product: Fenix" has approval-mozillla-beta? (Or should I move product to GeckoView since this fix is GV?)

Flags: needinfo?(m\_kato) → needinfo?(ryanvm)

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1653862#c17)• 4 years ago |
|  | |

(I cannot find approval-mozilla-beta flag in attachment. My env issue?)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1653862#c18)• 4 years ago |
|  | |

Moving it into GeckoView makes sense IMO. Try now :-)

Component: Security: Android → GeneralFlags: needinfo?(ryanvm) → needinfo?(m\_kato)Product: Fenix → GeckoViewTarget Milestone: --- → 81 Branch

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1653862#c19)• 4 years ago |
|  | |

Comment on [attachment 9167814](/attachment.cgi?id=9167814 "Bug 1653862 - Set InputContext after getting focus.") [[details]](/attachment.cgi?id=9167814&action=edit "Bug 1653862 - Set InputContext after getting focus.")

[Bug 1653862](/show_bug.cgi?id=1653862 "VERIFIED FIXED - Firefox save gmail password into phone dicrtionarty") - Set InputContext after getting focus.

### Beta/Release Uplift Approval Request

* **User impact if declined**: When setting focus to password field by web site script automatically, software keyboard may not change to password field style. Most software keyboard learns input history if not password field, so it may be that your password is stored in software keyboard's input history.
* **Is this code covered by automated tests?**: No
* **Has the fix been verified in Nightly?**: Yes
* **Needs manual test from QE?**: Yes
* **If yes, steps to reproduce**: 1. Open Gmail login page.

2. Enter login to Gmail (email)
3. Enter password to Gmail account

* **List of other uplifts needed**: None
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: When user sets focus by user operation, this issue isn't related to this code path. When setting focus to password field by web site script automatically, we don't set software keyboard immediately at this situation. It is set after getting current text control style.
* **String changes made/needed**: no
Flags: needinfo?(m\_kato)
[Attachment #9167814](/attachment.cgi?id=9167814&action=edit "Bug 1653862 - Set InputContext after getting focus.") -
Flags: approval-mozilla-beta?

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1653862#a2448427_8636)• 4 years ago |

Flags: qe-verify+

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1653862#a2468629_551058)• 4 years ago |

QA Whiteboard: [qa-triaged]

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1653862#c20)• 4 years ago |
|  | |

Comment on [attachment 9167814](/attachment.cgi?id=9167814 "Bug 1653862 - Set InputContext after getting focus.") [[details]](/attachment.cgi?id=9167814&action=edit "Bug 1653862 - Set InputContext after getting focus.")

[Bug 1653862](/show_bug.cgi?id=1653862 "VERIFIED FIXED - Firefox save gmail password into phone dicrtionarty") - Set InputContext after getting focus.

gv fix, approved for 80 rc1

[Attachment #9167814](/attachment.cgi?id=9167814&action=edit "Bug 1653862 - Set InputContext after getting focus.") -
Flags: approval-mozilla-beta? → approval-mozilla-release+

|  | [Julien Cristau [:jcristau]](/user_profile?user_id=580382) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1653862#c21)• 4 years ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-release/rev/d198d17488a6>

[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1653862#a2601910_578488)• 4 years ago |

Whiteboard: [adv-main80+]

|  | [Diana Rus](/user_profile?user_id=636695) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1653862#c22)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1653862&comment_id=15002912 "1 revision") |
|  | |

Hi,reproduced the issue partially and only when the password is visible in the field with Sony Xperia Z5 (Android 7) and Google Pixel 3 XL (Android 9) with the latest Microsoft SwiftKey keyboard from playstore (version 7.6.0.9) on Firefox Beta 79.0.0-beta.9

* I encountered the display of the password while being inserted in the field, in the suggestion area, also suggestion area could be enabled when tapping on the (eye) symbol from password field for gmail domain so that the password is visible. (Point 3.A from actual result-description)
* Didn't encounter point 3B from actual result-description.

On Firefox Preview Release 80.0.1 RC.1 - I can still see what is inserted in the field in case the user let's the password visible to UI - please check [video](https://drive.google.com/file/d/15UU6sOwabZMH1eXcR0awl5UQbMKPONO1/view?usp=sharing), otherwise the suggestion area for the password field is hidden but it's the same case as for Firefox Beta 79.0.0-beta.9

@ Makoto - should this be happening - the suggestion area be available when the password is visible to UI?

Flags: needinfo?(m\_kato)

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1653862#c23)• 4 years ago |
|  | |

(In reply to Diana Rus from [comment #22](/show_bug.cgi?id=1653862#c22 "VERIFIED FIXED - Firefox save gmail password into phone dicrtionarty"))

> @ Makoto - should this be happening - the suggestion area be available when the password is visible to UI?

What version of GeckoView of Firefox Preview Release 80.0.1 RC.1? I have verified by the latest Nightly.

Flags: needinfo?(m\_kato) → needinfo?(diana.rus)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1653862#c24)• 4 years ago |
|  | |

Given that this is an issue in a beta product, I'm going to exclude it from the advisories.

Whiteboard: [adv-main80+] → [adv-main80-]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1653862#c25)• 4 years ago |
|  | |

We had begun rolling out Fenix 79.

Alias: CVE-2020-15671Whiteboard: [adv-main80-] → [adv-main80+]

|  | [Diana Rus](/user_profile?user_id=636695) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1653862#c26)• 4 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1653862&comment_id=15004217 "2 revisions") |
|  | |

Hi Makoto, for Firefox Preview Release 80.0.1 RC.1 has the following **GV: 80.0-20200818235255, the AC: 54.0.3, c91a47caa and AS: 61.0.10**.

In the meantime a new build has arrived 80.1.0 (Build #2015759937) **that has the same GV as Build 80.0.1 RC1 and with AC: 54.0.4, 60a32c926, AS: 61.0.10** for which the same outcome is present as the one mentioned in **[Comment22](https://bugzilla.mozilla.org/show_bug.cgi?id=1653862#c22)**. Checked with same devices Google Pixel 3 XL (Android 9) and Sony Xperia Z5 (Android 7).

Did a check on Nightly 8/25 with GV: 81.0a1-20200820093209 and encountered the same outcome as for Firefox Preview 80.1.0, created a new issue here: <https://github.com/mozilla-mobile/fenix/issues/14162>

I'll mark this as verified as when for gmail when the the "eye symbol" is uncut (password not visible in UI)

Flags: needinfo?(diana.rus) → needinfo?(m\_kato)

|  | [Diana Rus](/user_profile?user_id=636695) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1653862#a3185370_636695)• 4 years ago |

Status: RESOLVED → VERIFIED
[status-firefox80](/buglist.cgi?f1=cf_status_firefox80&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox80&o1=equals&v1=verified)
[status-firefox81](/buglist.cgi?f1=cf_status_firefox81&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox81&o1=equals&v1=verified)

|  | [Diana Rus](/user_profile?user_id=636695) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1653862#a3190144_636695)• 4 years ago |

Flags: qe-verify+

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1653862#c27)• 4 years ago |
|  | |

(In reply to Diana Rus from [comment #26](/show_bug.cgi?id=1653862#c26 "VERIFIED FIXED - Firefox save gmail password into phone dicrtionarty"))

> Hi Makoto, for Firefox Preview Release 80.0.1 RC.1 has the following **GV: 80.0-20200818235255, the AC: 54.0.3, c91a47caa and AS: 61.0.10**.
>
> In the meantime a new build has arrived 80.1.0 (Build #2015759937) **that has the same GV as Build 80.0.1 RC1 and with AC: 54.0.4, 60a32c926, AS: 61.0.10** for which the same outcome is present as the one mentioned in **[Comment22](https://bugzilla.mozilla.org/show_bug.cgi?id=1653862#c22)**. Checked with same devices Google Pixel 3 XL (Android 9) and Sony Xperia Z5 (Android 7).
>
> Did a check on Nightly 8/25 with GV: 81.0a1-20200820093209 and encountered the same outcome as for Firefox Preview 80.1.0, created a new issue here: <https://github.com/mozilla-mobile/fenix/issues/14162>
>
> I'll mark this as verified as when for gmail when the the "eye symbol" is uncut (password not visible in UI)

Wait. This issue is hidden due to security issue. Why do you file the bug to public space?

Flags: needinfo?(m\_kato) → needinfo?(diana.rus)

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1653862#c28)• 4 years ago |
|  | |

And Where Build 80.0.1 RC1 to check this?

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1653862#c29)• 4 years ago |
|  | |

Diana, although you click "show password" icon, why do you click this? If clicking it, password is show and keyboard layout isn't password layout type. It is correct behavior now. And I don't write this step on [comment #19](/show_bug.cgi?id=1653862#c19 "VERIFIED FIXED - Firefox save gmail password into phone dicrtionarty").

### step

1. Access [www.google.com](http://www.google.com)
2. Click [Sign in]
3. Enter google account address and then [Enter]
4. Password field is shown, so tap Android's back key (to close software keyborad) and tap Android's back key (to navigate to previous page)
5. Enter google account address and then [Enter]

|  | [Chenxia Liu [:liuche]](/user_profile?user_id=420448) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1653862#c30)• 4 years ago |
|  | |

Hi Diana, I got a request to delete the version of this security issue filed in Github because it might create a security risk - please file security issues in bugzilla in the future! That way we can discuss and fix and not worry about exploits built off of filed bugs.

|  | [Diana Rus](/user_profile?user_id=636695) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1653862#c31)• 4 years ago |
|  | |

Hi,

@ Chenxia - sure, thank you

@ Makoto - you can take the Firefox Preview builds from here:

* <https://github.com/mozilla-mobile/fenix/tags>
* <https://firefox-ci-tc.services.mozilla.com/tasks/index/mobile.v2.fenix.nightly.latest> - Firefox Preview Nightly
* <https://firefox-ci-tc.services.mozilla.com/tasks/index/mobile.v2.fenix.beta.latest> - Firefox Preview Beta
* <https://firefox-ci-tc.services.mozilla.com/tasks/index/mobile.v2.fenix.release> - Firefox Preview RC

(In reply to Makoto Kato [:m\_kato] from [comment #29](/show_bug.cgi?id=1653862#c29 "VERIFIED FIXED - Firefox save gmail password into phone dicrtionarty"))

> Diana, although you click "show password" icon, why do you click this? If clicking it, password is show and keyboard layout isn't password layout type. It is correct behavior now. And I don't write this step on [comment #19](/show_bug.cgi?id=1653862#c19 "VERIFIED FIXED - Firefox save gmail password into phone dicrtionarty").
>
> ### step
>
> 1. Access [www.google.com](http://www.google.com)
> 2. Click [Sign in]
> 3. Enter google account address and then [Enter]
> 4. Password field is shown, so tap Android's back key (to close software keyborad) and tap Android's back key (to navigate to previous page)
> 5. Enter google account address and then [Enter]

Thank you for creating issue [1661617](https://bugzilla.mozilla.org/show_bug.cgi?id=1661617)(i don't have access at the moment for it). I know that it is a different scenario, that is why i've asked about it in [Comment22](/show_bug.cgi?id=1653862#c22 "VERIFIED FIXED - Firefox save gmail password into phone dicrtionarty") and created a new issue to have track of it.

(In reply to Diana Rus from [comment #22](/show_bug.cgi?id=1653862#c22 "VERIFIED FIXED - Firefox save gmail password into phone dicrtionarty"))

> @ Makoto - should this be happening - the suggestion area be available when the password is visible to UI?

I think that issue can be closed, based on your response.

The original STR's (can be seen in the starting of the video from [Comment22](/show_bug.cgi?id=1653862#c22 "VERIFIED FIXED - Firefox save gmail password into phone dicrtionarty")) and the one you mentioned in [Comment29](/show_bug.cgi?id=1653862#c29 "VERIFIED FIXED - Firefox save gmail password into phone dicrtionarty"), alongside a couple of other domains, have been checked and it's all good.

Hope this clarifies a bit the situation. Thank you

Flags: needinfo?(diana.rus)

|  | [Diana Rus](/user_profile?user_id=636695) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1653862#a3423658_636695)• 4 years ago |

Flags: needinfo?(m\_kato)

|  | [Makoto Kato [:m\_kato]](/user_profile?user_id=8636)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1653862#c32)• 4 years ago |
|  | |

> @ Makoto - you can take the Firefox Preview builds from here:

I verified the fix by Firefox Preview RC (80.1.1 Build #2015760555) and Firefox Nightly.

Flags: needinfo?(m\_kato)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1653862#a13163589_1689)• 4 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1653862&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Karol Frejlich](/user_profile?user_id=666968)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_3373b3b6_20250119_125555.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2020-41

## Security Vulnerabilities fixed in Thunderbird 78.2

Announced
August 25, 2020
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 78.2

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2020-15663: Downgrade attack on the Mozilla Maintenance Service could have resulted in escalation of privilege](#CVE-2020-15663)

Reporter
Xiaoyin Liu
Impact
high
##### Description

If Thunderbird is installed to a user-writable directory, the Mozilla Maintenance Service would execute updater.exe from the install location with system privileges. Although the Mozilla Maintenance Service does ensure that updater.exe is signed by Mozilla, the version could have been rolled back to a previous version which would have allowed exploitation of an older bug and arbitrary code execution with System Privileges.
*Note: This issue only affected Windows operating systems. Other operating systems are unaffected.*

##### References

* [Bug 1643199](https://bugzilla.mozilla.org/show_bug.cgi?id=1643199)

#### [#CVE-2020-15664: Attacker-induced prompt for extension installation](#CVE-2020-15664)

Reporter
Kaizer Soze
Impact
high
##### Description

By holding a reference to the `eval()` function from an about:blank window, a malicious webpage could have gained access to the InstallTrigger object which would allow them to prompt the user to install an extension. Combined with user confusion, this could result in an unintended or malicious extension being installed.

##### References

* [Bug 1658214](https://bugzilla.mozilla.org/show_bug.cgi?id=1658214)

#### [#CVE-2020-15670: Memory safety bugs fixed in Thunderbird 78.2](#CVE-2020-15670)

Reporter
Mozilla developers and community
Impact
high
##### Description

Mozilla developers Jason Kratzer, Christian Holler, Byron Campen, Tyson Smith reported memory safety bugs present in Thunderbird 78.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 78.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1651001%2C1651449%2C1653626%2C1656957)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


