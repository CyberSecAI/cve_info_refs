```
{
  "vulnerability": {
    "CVE": "CVE-2020-15134",
    "description": "Faye uses em-http-request and faye-websocket in the Ruby version of its client. Those libraries both use the `EM::Connection#start_tls` method in EventMachine to implement the TLS handshake whenever a `wss:` URL is used for the connection. This method does not implement certificate verification by default, meaning that it does not check that the server presents a valid and trusted TLS certificate for the expected hostname. That means that any `https:` or `wss:` connection made using these libraries is vulnerable to a man-in-the-middle attack, since it does not confirm the identity of the server it is connected to.",
    "root_cause": "The `EM::Connection#start_tls` method in EventMachine, used by `em-http-request` and `faye-websocket`, does not perform certificate verification by default.",
    "weaknesses": [
      "Missing TLS certificate verification"
    ],
    "impact": "Man-in-the-middle attack. An attacker can intercept and modify communications between the client and the server without the client being able to detect it.",
    "attack_vectors": "Network-based man-in-the-middle attack.",
    "required_capabilities": "Attacker must be positioned on the network path between the client and the server to intercept and modify communications."
  },
  "affected_versions": "< 1.4.0",
  "patched_versions": "1.4.0",
  "references": [
        "https://securitylab.github.com/advisories/GHSL-2020-094-igrigorik-em-http-request",
        "https://github.com/eventmachine/eventmachine/issues/275",
        "https://github.com/eventmachine/eventmachine/pull/378",
        "https://github.com/eventmachine/eventmachine/issues/814",
        "https://github.com/igrigorik/em-http-request/pull/340",
        "https://www.rubydoc.info/github/eventmachine/eventmachine/EventMachine/Connection%3Assl_verify_peer",
        "https://github.com/faye/faye/issues/524",
        "https://github.com/faye/faye-websocket-ruby/pull/129"

  ],
    "remediation": "Faye v1.4.0 enables TLS certificate verification by default. Users can opt out using `tls: { verify_peer: false }` option during client initialization.  `faye-websocket` allows setting root cert file with `tls.root_cert_file`. Node.js version of Faye also supports a `tls` option which passes values to the `https` and `tls` modules"
}
```